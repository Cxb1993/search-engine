行政院國家科學委員會專題研究計畫成果報告 
網路威脅搜捕分析與追蹤技術研究－ 
子計畫三:惡意網域變動威脅追蹤技術 
(Malicious Web Content and Fast-Flux Domain Detection) 
計畫編號：NSC98-2218-E-006-254 
執行期限：2009/10/01 ~ 2010/07/31 
主持人：林輝堂 副教授 國立成功大學電機工程學系 
計畫參與人員：賴家齡 國立成功大學電通所、康宏榮 國立成
功大學電通所、陳文益國立成功大學電通所、江瑞偉 國立成功大
學電通所 
 
1. 中文摘要 
近年來，全球殭屍網路活動盛行，駭客
利用遠端操控各個受感染的電腦，並且針對
特定網路區域或電腦主機進行阻斷式攻擊、
竊取私密資料等不法行為。由於殭屍網路具
有自我複製、主動散播、與隱匿性等特性，
因此殭屍網路擴散性極強並且不易發覺主機
受到感染。如今，網路犯罪者為了進一步的
提升殭屍網路控制中心(Botmaster)的存活率，
避免被執法單位所查獲，使用一套快速變動
網域(Fast-Flux)技術在殭屍網路中來隱藏其
行蹤。藉此將大幅增加殭屍網路偵測與追蹤
之困難度。 
快速變動網域服務是一種網域名稱系統
的技術，能夠讓單一網域名稱對應到多重的
IP 位址(數百個至數千個)。而殭屍網路的犯
罪者則利用已遭受病毒程式感染的電腦主機
成為變動代理人，使得使用者每次查詢惡意
網域名稱時，將被導向不同的變動代理人主
機中。由於殭屍網路利用此種分散式變動代
理人架構，當其中一個變動代理人受查獲、
隔離、停止其作用時，仍可確保此犯罪網路
的功能性，此種犯罪手法將導致以基於IP 黑
名單封鎖之防禦方式無法發揮其作用，並且
會對現代資訊化社會造成重大的威脅與財產
的損失。 
本子計畫預期將發展惡意快速變動網域
偵測技術，辨識惡意網域名稱以及所對應之
IP 位址。收集資料後將建立威脅知識庫與資
料分享平台為後續追蹤關聯技術之用，以建
立資安聯合防禦網。本子計畫利用偵測網域
名稱以建立網域名稱黑名單以改善傳統IP黑
名單防禦方式之缺點。此技術將可協助釣魚
網站與殭屍網路之判別，以及提供惡意網域
名稱黑名單，進行國際惡意網域名稱通報之
用。 
 
關鍵詞:  
惡意變動網域、殭屍網路、快速變動網域、
網域名稱系統 
 
Abstract 
Fast-flex domain Detection Subsystem (FDS)
系 統 主 要 由 Actor Interface(client) 與
FDS(Server) 兩 部 分 所 組 成 。 其 中 Actor 
Interface 部 分 ， 主 要 由 系 統 管 理 者
(Administrator)或一般使用者(User)在本子系
統所提供之Web介面輸入欲查詢之網域。再 
  
 
圖二、惡意中繼站識別系統流程圖 
經由子系統FDS系統中PHP及系統內建
的指令(i.e.,whois, dig)去得到此網域之相關
資訊，收集完後利用FDS系統所提供的兩階
段判斷機制查詢的此網域是否為惡意快速變
動 
網域。最後將判斷的結果資訊顯示給系統管
理者(Administrator)或一般使用者(User)。 
此系統主要提供惡意中繼站識別
(Identify Malicious Command & Control 
Server) 及 快 速 變 動 網 域 偵 測 (Fast-Flux 
Domain Detection)二種模組。 
 
 
圖一、惡意網域變動威脅追蹤技術系統架構 
3.1 Identify Malicious Command & Control 
Server 
本模組由子計畫一之威脅搜捕技術子系
統(CWS)探測惡意網站，以收集惡意程式樣
本提供給子計畫二之網路威脅行為分析子系
統(MAT)進行惡意程式行為分析，分析鑑定
出惡意之網域，在將網域交由本系統去辨識
是否為惡意快速變動網域，透過DNS查詢的
資料與本系統建立的偵測條件比對，建立惡
意快速變動網域黑名單(如圖二所示)。 
 
3.2 Fast-Flux Domain Detection 
IP Exactor
ASN Query Agent Flux-Score Detecton
Fast-Flux Service 
Networks Domain
Domain name DNS Packet Montor
 
圖三、快速變動網域偵測流程圖 
本模組為一般使用者用來測試欲所使用
之網域是否為惡意快速變動網域。經由系統
測試，其判別的條件及偵測的結果將藉由web
介面展示給使用者，並且，也將其判別結果
存入偵測系統之資料庫。這將使其他使用者
若查詢同網域，能即時的把之前判斷結果提
供給使用者，且提供該網域之註冊資訊(如圖
三所示)。 
