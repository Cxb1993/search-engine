 i
目錄 
目錄 ................................................................................................................................ i 
摘要 ............................................................................................................................. iii 
Abstract ........................................................................................................................ iv 
I. Introduction .............................................................................................................. 1 
II. System Model .......................................................................................................... 4 
A. Power Allocation Problem ................................................................................ 5 
B. Joint Subcarrier and Power Allocation Problem ............................................... 6 
C. Power Allocation under Primary User Activity ................................................. 7 
 
III. Power Allocation for Multiuser OFDM-Based CR Systems.............................. 9 
A. Optimal Power Allocation Algorithm for OFDM-Based CR systems .............. 9 
B. The Update of the Common Water Level ........................................................ 10 
C. The Proposed Suboptimal Power Allocation Algorithm for OFDM-Based CR   
Systems ........................................................................................................... 13 
D. Complexity Analysis of Power Allocation Algorithms ................................... 15 
E. Simulation Results of Power Allocation Algorithms....................................... 17 
 
IV. Subcarrier and Power Allocation for MU-OFDM CR Systems ....................... 18 
A. A Rule for Subcarrier Allocation ..................................................................... 18 
B. Joint Subcarrier and Power Allocation with the IPWF Algorithms ................ 20 
C. Approximation of Water Level ........................................................................ 20 
D. A Suboptimal Joint Subcarrier and Power Allocation Algorithm ................... 21 
E. Complexity Analysis of Joint Subcarrier and Power Allocation Algorithms .. 24 
F. Simulation Results of Joint Subcarrier and Power Allocation Algorithms ...... 25 
 
V. Power Allocation for OFDM-Based CR Systems under Primary User Activity
...................................................................................................................................... 26 
 iii
摘要 
在本計畫中，我們針對多用戶正交分頻多工之感知無線電系統發展高效率資
源分配技術，其中功率峰值將被適當限制以保護主要使用者。在功率峰值限制情
況下，現有作法通常會使用一套具有高複雜度的最佳功率分配演算法（即迭代式
分區注水演算法）來反覆執行注水演算，以決定每個子載波上的功率是否比功率
峰值還大，而這樣會讓功率分配變得沒有效率。為了改善功率分配效率，我們技
巧地利用一些要達成最佳功率分配時所必須滿足的條件，設計出一個具有低複雜
度的演算法，來滿足每個子載波上的功率峰值限制，並持續更新子載波上的功率
分配值以最大化通訊容量總和（Sum Capacity）。電腦模擬結果顯示，我們所提
出之高效率功率分配演算法的效能可逼近最佳通訊容量總和。 
為了進一步改善系統效能，我們首先在功率分配已知的前提下，推導出一個
使通訊容量總和最大化的子載波分配規則。根據這個規則，我們接著發展出一聯
合子載波與功率分配演算法，使得通訊容量總和最大化可經由子載波分配與功率
分配之交互執行而達成；此一聯合子載波與功率分配演算法可採用我們所提出之
高效率功率分配演算法，以同時達到良好效能與降低複雜度的目標。 
為了因應主要使用者在子載波上的活動，我們也發展了對應的高效率功率分
配演算法。我們首先將肇因於主要使用者活動的通訊容量期望值損失轉換成等效
的功率峰值限制，再配合我們所提出之高效率功率分配演算法來達成通訊容量期
望值總和（Sum Expected Capacity）最大化的目標。電腦模擬結果顯示，我們所
提作法的效能可逼近最佳通訊容量期望值總和。 
除了針對多用戶正交分頻多工之感知無線電系統發展高效率資源分配技術
之外，我們亦就正交分頻多工系統以及多輸入多輸出系統發展了一些前瞻基頻處
理演算法，包括功率峰均比降低技術、載波間干擾消除技術、聯合同步與通道估
測技術等，這些作法兼具高效能與低複雜度的特點，相當具有應用潛力。 
 
關鍵詞：通道估測、感知無線電、載波間干擾消除、聯合子載波與功率分配、多
輸入多輸出、多用戶正交分頻多工、正交分頻多工、功率峰均比降低、資源分配、
同步。 
 
 
 
 v
In addition to the resource allocation schemes for MU-OFDM CR systems, we 
have also developed some new baseband algorithms for OFDM and multiple-input 
multiple-output systems, including peak-to-average power ratio reduction, intercarrier 
interference cancellation, as well as joint synchronization and channel estimation. 
These algorithms have both good-performance and low-complexity features, and are 
useful for practical applications. 
 
Keywords: channel estimation, cognitive radio (CR), intercarrier interference (ICI) 
cancellation, joint subcarrier and power allocation, multiple-input multiple-output 
(MIMO), multiuser orthogonal frequency division multiplexing (MU-OFDM), OFDM, 
peak-to-average power ratio (PAPR) reduction, resource allocation, synchronization. 
 
 2
the power constraint on each subchannel (a group of subcarriers), the optimal power 
allocation algorithm in single-user OFDM-based CR systems was studied in [8], 
where the iterative partitioned water-filling (IPWF) algorithm was proposed to realize 
the optimal power allocation. Although the complexity of the IPWF is less than that of 
the exhaustive search algorithm, it may need to perform the water-filling (WF) 
algorithm many times for a fixed number of subcarriers. Moreover, when the IPWF 
algorithm is used to support the subcarrier assignment (i.e., joint subcarrier and power 
allocation), it must recalculate the water level to determine the power for each 
subcarrier, which would cause joint subcarrier and power allocation to have very high 
complexity. In [9], a low-complexity joint subcarrier and power allocation algorithm 
for MU-OFDM CR systems was proposed. However, its power allocation part does 
not consider the peak power constraint of CR systems in the optimization process, and 
this makes the algorithm less than optimal. 
In addition to the peak power constraint, the availability of the subcarriers also has 
a great impact on the transmitted power of SUs because some PUs use some 
subcarriers frequently. In [11], the power allocation algorithm based on PU activity 
was studied. The concept of PU activity or the reliability of the subcarriers is 
formulated by using a risk-return model or a rate loss function. Using a linear rate loss 
function, the original power allocation problem for maximizing the sum capacity 
becomes increasing the sum expected capacity (subtracting the expected rate loss 
from the sum capacity) to its maximum value. Since numerical methods must be used 
to obtain the optimal power distribution based on the linear rate loss, two suboptimal 
algorithms were also proposed in [11], but first it is necessary to predetermine some 
design parameters on the basis of the environment. 
In this report, we present the proposed resource allocation schemes for 
 4
Considering the PU activity, we use the conditions for promising the expected 
capacity to be a positive and increasing function [11]. Specifically, we transform the 
factor of the expected rate loss into a peak power constraint on each subcarrier to 
eliminate the need to execute some numerical methods. Moreover, this transformation 
also excludes the need to calculate some design parameters that are used to avoid a 
negative expected capacity. Using this conversion, the power allocation problem for 
maximizing the sum expected capacity becomes maximizing the sum capacity under 
the peak power constraint in [8], [9], [12]. It means that the optimal IPWF algorithm 
can be used to allocate power and thus the proposed efficient algorithm simplifying 
the IPWF algorithm can support practical implementation of the power allocation 
under PU activity. Simulation results show that the proposed algorithm decreases the 
transmitted power dramatically as the probability that a PU will reoccupy the 
subcarrier increases, and ensures that the expected capacity is not negative despite the 
change in the probability. Furthermore, the proposed suboptimal algorithm with lower 
complexity achieves an expected capacity close to that of the optimal one. 
The rest of this report is organized as follows. Section II introduces the 
MU-OFDM CR system model and formulates the resource allocation problem. In 
Section III, the optimal power allocation and the proposed efficient power allocation 
algorithms are presented. In Section IV, the rule for the subcarrier allocation and the 
proposed joint subcarrier and power allocation algorithm are developed. In Section V, 
we reformulate the excepted capacity loss under PU activity as an equivalent peak 
power constraint and propose a low-complexity suboptimal power allocation 
algorithm. Finally, conclusions are drawn in Section VI. 
II. System Model 
Consider a multiuser OFDM CR uplink system with M PUs and K SUs in Fig. 1, 
 6
,
2 , , 1
,1
, ,max
,
1 2
max  log (1 )
subject to:  
                  , 
                 0 , 
                  are disjoint for all .
                 {1
k n
k
K
k n k np k n
N
k n kn
k n k
k n
k
K
B p H
N
p P k
p P k n
p k n
k
= ∈Ω
=
+
≤ ∀
≤ ∀
≥ ∀
Ω
Ω ∪Ω ∪ ∪Ω ⊆
∑ ∑
∑
… ,2,..., }N
    (3) 
where Pk is the overall available power of SU k; Hk,n = |hk,n|2/(N0BN−1) is the CNR for 
SU k in subcarrier n; hk,n is the channel gain for SU k in subcarrier n; Ωk is the set of 
subcarriers for SU k and Ω1, Ω2, …, ΩK are mutually exclusive. When the subcarrier 
allocation is jointly considered with the power allocation, we can define the 
optimization problem in next subsection. 
B. Joint Subcarrier and Power Allocation Problem 
Using the peak power constraint in (2), the optimization problem of subcarrier and 
power allocation considered in this report is formulated as 
, ,
1
, 2 , ,1 1,  
,1
,1
, ,max
,
,
max  log (1 )
subject to:  
                 1 
                  , 
                 0 , 
                {0,  1} ,
k n k n
K N
k n k n k nk np
N
k n kn
K
k nk
k n k
k n
k n
BN p H
p P k
n
p P k n
p k n
k
α α
α
α
−
= =
=
=
+
≤ ∀
= ∀
≤ ∀
≥ ∀
= ∀
∑ ∑
∑
∑
 n
   (4) 
where αk,n indicates whether or not the subcarrier n is used by SU k. To make it easier 
to solve the problem, (4) can be transformed into a convex optimization problem, as 
follows [13] 
 8
subchannels is available. 
3) A slow fading channel is assumed; that is, a channel gain remains constant for 
several time frames. 
Suppose that αj is the probability that the jth PU reoccupies the subchannel during 
the current time period and that the subchannel was available for an SU in the 
previous time period. A mapping function ϕ: +Z  → +Z  is used to indicate that a 
subcarrier belongs to a specific PU, where +Z  is the set of positive integers. That is, 
( )i jϕ =  if the ith subcarrier is licensed to the PU j.   (6) 
Therefore, the expected rate loss function for the ith subcarrier is given by ( ) ( )i ipϕα L , 
where pi is the assigned power in subcarrier i, and the expected capacity of the ith 
subcarrier is expressed as 
( ){ } ln(1 ) ( )i i i i iE R p H pϕα= + − L      (7) 
where Hi is the CNR in subcarrier i. 
With the above results, our objective is to optimize the power allocation for 
achieving the maximum sum error-free expected capacity under the total power 
constraint. The optimization problem is formulated as 
( )1 
1
max  [ln(1 ) ( )]
subject to: 
                  0
i
N
i i i iip
N
i totali
i
p H p
p P
p i
ϕα=
=
+ −
≤
≥ ∀ ∈Ω
∑
∑
L
    (8) 
where Ptotal denotes the total available power and Ω = {1, 2, …, N}. Because the 
optimization problem contains the rate loss function, the conditions on L  must be 
given to make the expected capacity E{Ri} not only satisfy the concave property, but 
also be a positive and increasing function of power within the total available power. 
That is [11], 
 10
1) Initialization 
(a) Some parameters are defined first: 
{1,2,..., }k kA N= ; kB φ= ; {1}kD = ; 1ˆ kP P= ; 1m = . 
2) while |Dk| ≠ 0 
(a) Perform the traditional water-filling on the subcarriers in Ak with power mˆP  
and obtain all the power pk,n, n∈ Ak. The resulting water level is ˆmw . 
(b) Dk = {n| pk,n ≥ Pk,max, n∈Ak}. 
(c) 1 ,maxˆ ˆ\ ,  ,  | |k k k k k k m m k kA A D B B D P P D P+= = ∪ = − . 
(d) m = m + 1. 
3) pk,n = Pk,max, n∈Bk. 
The \ in Step 2(c) denotes the set subtraction. 
The IPWF algorithm determines each subcarrier’s assigned power by classifying 
the subcarriers according to the definitions of Ak and Bk. These steps are repeated 
iteratively until the assigned power of the subcarriers in Ak is less than the peak power, 
at which time the optimal power allocation with the peak power constraint is finished. 
Although the IPWF algorithm is simpler than the exhaustive search algorithm, it may 
need to execute the WF algorithm many times. Therefore, it is useful to apply an 
efficient power allocation algorithm to solve the resource allocation problem. 
B. The Update of the Common Water Level 
In the following, instead of using the WF algorithm to classify the two sets, we 
propose a method to update the common water level for determining the subcarriers in 
Ak and Bk. Before describing the steps for updating the common water level in Ak, we 
describe the lemma about the traditional WF algorithm. 
 12
water level of the set Ak = {i| pk,i < Pk,max, i∈Ψk}. Then, the jth subcarrier (j∉Ψk but 
j∈Ωk) will be assigned to Bk = {i| pk,i = Pk,max, i∈Ψk} if 
, ,maxˆ 1 .
| | 1 | |
k k j k
k k
k k
w H P
a b
A A
− ≥+       (14) 
Otherwise, the subcarrier will be in Ak. The new common water level of Ak is 
ˆ min(max( , 0), )k k kw a b− . In addition, when j∈Bk, |Bk| must satisfy Pk > (|Bk|+1)Pk,max 
to ensure the total power allocated to Ak is positive. 
Proof: If j∈Bk, the assigned power in the jth subcarrier is Pk,max and the common 
water level of Ak becomes ,maxˆ | |k k kw P A−  and the new common water level must 
be greater than or equal to the unique water level in the jth subcarrier; that is, 
,max
, ,max
,
1ˆ
| |
k
k k j k
k k j
P
w w P
A H
− ≥ = +  or 
, ,maxˆ 1 .
| | 1 | |
k k j k
k k
k k
w H P
a b
A A
− ≥+       (15) 
Otherwise, the jth subcarrier is assigned to Ak. Using the above-mentioned lemma, the 
new common water level becomes 
,ˆ 1ˆ ˆmax( , 0) max( , 0).
| | 1
k k j
k k k
k
w H
w w a
A
−− = −+     (16) 
With (15) and (16), the new common water level depends on the minimum between 
max( , 0)ka  and bk; that is, 
ˆ min(max( , 0), )k k kw a b−       (17) 
Moreover, when j∈Bk, the total power of Ak is 
1 1
, ,
,max ,max
ˆ ˆ( ) ( )
| | 0.
k k k
k k k i k k i ki A i A i A
k k k k
w b H w H b
P B P P
− −
∈ ∈ ∈− − = − −
= − − >
∑ ∑ ∑
   (18) 
That is, Pk > (|Bk| + 1)Pk,max.                      ■ 
 14
and 
0 0,1 , 0,1 0,| | 0,1 ,| |
[ ,..., ] [ , ..., , , ..., ].
k k kk k k N k k B k k A
v v b b a a= =v  
2) while n ≤ Nk 
(a) ,k nm v= . 
(b) if |Ak| = 0 
(1) Evaluate the water level with 1 1,max{( 1) ( ), 0}k k k k mw w n w H
− −= − + − , but 
1
,k k k mw P H
−= +  when n = 1. 
(2) if 1,max ,k k k mw P H
−≥ +  and ,max(| | 1)k k kP B P> +  
{ }k kB B m= ∪ . 
else 
{ }k kA A m= ∪ ; ,max| |Ak k k kP P B P= − ; 
1
,Ak Ak k mw P H
−= + . 
(c) else 
(1) 1, ,max( ) (| | 1); | |.k Ak k m k k k ka w H A b P A
−= − + =  
(2) if bk ≤ ak and Pk > (|Bk|+1)Pk,max 
wAk = wAk − bk;  
Bk = Bk ∪{m}. 
else 
wAk = wAk − max(ak, 0); 
Ak = Ak ∪ {m}. 
(d) 1n n= + . 
3)   
(a) 1,max ,{ | , }k Ak k k i kA i w P H i B
∗ −= < + ∈ ;  
1
,max ,{ | , }k Ak k k i kB i w P H i B
∗ −= ≥ + ∈ . 
 16
subcarrier; Step 2(c) requires 7 additions and 3 multiplications for each subcarrier. 
Step 2(d) requires 1 additions and the while loop needs 1 addition as well. Thus, there 
are in total 21Nk additions and 6Nk multiplications for all Nk subcarriers in Step 2. Step 
3 requires Nk+3|Ak|+1 additions and 2|Ak|+2 multiplications. Therefore, the proposed 
algorithm in total requires ( )kNO  additions and ( )kNO  multiplications for the kth 
SU because |Ak| < Nk. For all SUs, the proposed algorithm needs ( )NO  additions and 
( )NO  multiplications because 
1
K
kk
N N= =∑ . 
For the IPWF algorithm in Section III.A, Step 2(a) requires 
Nkilog2(Nki)+5Nki−3Mki additions and 2Nki−Mki multiplications when the WF algorithm 
in [14] is used, where Nki is the total number of subcarriers for the ith iteration and Mki 
is the number of subcarriers with positive power. Steps 2(b)−(d) require Nki+2 
additions. The IPWF algorithm requires 21( log 6 3 3)
kI
ki ki ki kii
N N N M= + − +∑   
additions and 
1
(2 )kI ki kii N M= −∑  multiplications in total, where Ik is the number of 
iterations for the kth user. When Ik = 1 for all k (i.e., the lower bound of the 
computational complexity), the IPWF algorithm needs 21( log )
K
k kk
N N=∑O  additions 
and ( )NO  multiplications. Using the log sum inequality [15], 
1
2 2 21 1
1
log ( )log log ( ),
1
K
K K kk
k k k Kk k
k
N
N N N N N K== =
=
≥ =∑∑ ∑ ∑    (19) 
the lower bound of the addition is 2( log ( ))N N KO . Table I summarizes the 
computational complexity of the proposed method and the IPWF algorithm. Fig. 3 
shows a comparison of the computational complexity of the proposed method and the 
IPWF algorithm for different values of N, where K = 8 and the lower bound of the 
IPWF algorithm’s complexity is regarded as 100%. 
 18
The noise enhances the effect of the peak power constraint so that the normalized sum 
capacity cannot saturate at a lower peak power constraint. Although the performance 
of the proposed algorithm degrades slighter more than that of the IPWF algorithm, 
they saturate at the same peak power. The performance gap in Fig. 4(b) results from 
the difference between the estimated water level and the true water level evaluated by 
the WF algorithm in the high noise environment. 
In Fig. 5, the normalized sum capacity is drawn for several different values of the 
number of users (i.e., K = 8, 12, 16, …, 32). It is clear that the capacity increases as 
the number of users increases, thus confirming the effect of the multiuser diversity. 
Fig. 6 illustrates the normalized sum capacity for various values of the path loss 
difference. The increase in the capacity also results from the multiuser diversity 
because some SUs’ channel gains are better than those of other SUs. This result 
indicates that the peak power constraint may not be fixed for all subcarriers because 
an SU with better channel gain may cause significant interference to the PU even 
though the transmitted power of the SU is small. 
IV. Subcarrier and Power Allocation for MU-OFDM CR 
Systems 
In the following, we first propose a rule for assigning the subcarriers and then 
introduce the optimal power allocation algorithm for MU-OFDM CR uplink systems. 
A. A Rule for Subcarrier Allocation 
The optimization problem in (5) is equivalent to finding the minimum of the 
Lagrangian function 
1
, 2 , , ,1 1
, , , ,max1 1
log (1 )
( ) ( 1) ( )
K N
k n k n k n k nk n
N K
k k n k n k n n k n kn k
L BN p H
p P u v p P
α α
λ α
−
= =
= =
= − +
+ − + − + −
∑ ∑
∑ ∑    (20) 
 20
designing the subcarrier allocation algorithm must decide pk,n or wk ∀k first. This 
means that the optimization is implemented by alternating between the subcarrier and 
power allocation; that is, joint subcarrier and power allocation. Therefore, an 
appropriate power allocation algorithm for MU-OFDM CR systems plays a crucial 
role in the joint subcarrier and power allocation algorithm.  
B. Joint Subcarrier and Power Allocation with the IPWF Algorithm 
In Sections III.A and IV.A, the joint subcarrier and power allocation algorithm 
with optimal power allocation is carried out using the rule in (24) to assign the 
subcarrier with the water level from the IPWF algorithm. When the number of 
subcarriers is changed, the IPWF algorithm must recalculate the water level for 
substituting into (24) to determine which user can use the additional subcarrier, which 
in turn increases the computational complexity of the joint subcarrier and power 
allocation algorithm. That is, the complexity of the joint subcarrier and power 
allocation algorithm depends on two factors: 1) for the power allocation, the IPWF 
algorithm may need to perform the water-filling algorithm many times, and 2) for the 
subcarrier allocation, the IPWF algorithm must recategorize all subcarriers into the 
two sets Ak and Bk. 
C. Approximation of Water Level 
To simplify the process for calculating the water level with a fixed number of 
subcarriers, we use a simple method to estimate its value. First, the initial water level 
for the kth user is given by 
1 ,( 1 )
k
k k k i ki
w P H N∈Ω= +∑       (25) 
where Pk and Ωk are the total power as well as the set of subcarriers assigned to user k, 
 22
Details of the proposed algorithm for a channel realization are described as 
follows (Note: the following numbers do not correspond exactly with the numbers 
above.): 
1) Initialization 
(a) The following parameters are defined first: A = {1, 2, …, N}; Ωk = φ,  
Ak = Bk = φ, wk = wtk = 0, wAk = wtAk = 0, 0kw = , Pk,max, and Pk, k = 1, …, K; 
n = 1. 
2)  while |A| ≠ 0 
for k = 1 to K 
(a) Ωk = Ωk ∪ {n}; Nk = |Ωk|. 
(b) if |Ak| = 0 
(1) Evaluate the water level with wk = wk − max{(Nk + 1)−1(wk − 1,k nH − ), 0}, but 
 1,k k k nw P H
−= +  when Nk = 1. 
(2) Perform the steps in Section IV.C and obtain the approximated water level 
 kw′ . k kw w′= . 
(3) 1,max ,{ | ,  }k k k k i kA i w P H i
−= < + ∈Ω ; k kB A= . 
(4) if n∈Ak 
(i) Find the approximated water level Akw′  with PAk = Pk − |Bk|Pk,max. 
Ak Akw w′= ; k Akw w′= . 
else 
(i) 1,max ,k k k nw P H
−= + . 
(c) elseif |Ak| ≠ 0 
(1) 1, ,max( ) (| | 1); | |k Ak k n k k k ka w H A b P A
−= − + = . 
 24
evaluated until Ak is not empty. Step 2(c) updates the common water level in Ak when 
Step 2(b) finds that Ak is not null. After all subcarriers are assigned, Step 3 allocates 
the power according to the common water level. Steps 3(a)−(b) move the subcarriers 
in Bk with unique water levels that are greater than the common water level to Ak. The 
power of each subcarrier in kB
∗  is Pk,max; Steps 3(d)−(f) determine the power of the 
subcarriers in Ak. Because the common water level is not from the water-filling 
algorithm, Step 3(f) is used to satisfy the total power constraint for all SUs. 
E. Complexity Analysis of Joint Subcarrier and Power Allocation Algorithms 
The complexity of the proposed algorithm results mainly from Step 2. Steps 
2(b)−(c) are used to calculate the water level and they are disjoint for each other, so 
the required additions and multiplications in Step 2 after all subcarriers are assigned 
are 2( )NO  because 
1 1 1
( 1) 2N K Nknn k nN n N N= = == = +∑ ∑ ∑ , where Nkn is the number 
of subcarriers for the kth SU when the nth subcarrier is assigned. 
The algorithm in [9] also is used to find the water level, so its complexity is 
2( )NO  rather than ( )NKO . On the other hand, when the water-filling algorithm in 
[14] is used, the IPWF algorithm in Section III.A requires 2( log )kni kniN NO  
additions and ( )kniNO  multiplications for the ith iteration, where Nkni is the total 
number of subcarriers for the ith iteration when the nth subcarrier is assigned to SU k. 
For all SUs and subcarriers, the joint subcarrier and power allocation algorithm with 
the IPWF algorithm needs 21 1( log )
N K
kn knn k
N N= =∑ ∑O  additions and 2( )NO  
multiplications, where we assume that the number of iterations when the nth 
subcarrier is assigned to the kth SU is one (i.e., the lower bound of the computational 
complexity). 
 26
proposed method increases as the peak power increases and saturates at Pk,max = −4 dB; 
moreover, the proposed algorithm alleviates the losses of capacity when ,max 4kP ≥ −  
dB with different PSDs of AWGN. This advantage is attributed to its better power 
allocation mechanism. 
V. Power Allocation for OFDM-Based CR Systems under 
Primary User Activity 
A. Optimal Power Allocation for OFDM-Based CR Systems with a Linear Rate Loss 
In [11], a simple linear rate loss function ( )p p=L C  was studied to show the 
impact of PU activity on a power allocation algorithm, where C  is the average rate 
loss per unit power (units bits/s/W). With this rate loss function, the solution to the 
optimization problem in (8) is given by 
( )
1 1( )i
i i
p i
Hϕλ α
+= − ∀ ∈Ω+ C      (27) 
where (x)+ ≡ max{x, 0} and λ is the Lagrangian multiplier for the total power 
constraint. Although the power in the ith subcarrier can be evaluated by the water 
level (λ + αϕ(i)C )−1, λ must be determined using numerical methods to satisfy the 
total power constraint because λ is coupled to αϕ(i) C . Therefore, suboptimal 
algorithms also were proposed in [11] to approximate the optimal solution. 
To avoid using numerical methods to find the power in (27), we exploit the 
condition in (9) to make the optimal power distribution with a linear rate loss function 
easier to solve. When ( )i ip p=L C , (9) is rewritten as 
1
( ) ( )
1 1 1or .
( ) ii i i i i
p i
p H Hϕ ϕα α−≤ ≤ − ∀ ∈Ω+C C    (28) 
Because this condition ensures that E{Ri} is positive and increases with pi, we can 
rewrite the optimization in (8) as 
 28
and n = 1. 
(b) 1( )total iiw P H N
−
∈Ω= +∑ ; 
A0 = {i| w < Pi,max + Hi−1, i∈Ω} = 
00,1 0,| |
{ , ..., }Aa a ; 
B0 = {i| w ≥ Pi,max + Hi−1, i∈Ω} = 
00,1 0,| |
{ , ..., }Bb b ; and 
v = [v1, …, vN] = [
0 00,1 0,| | 0,1 0,| |
, ..., , , ...,B Ab b a a ]. 
2) while n ≤ N 
(a)  m = vn. 
(b) if |A| = 0 
(1) Evaluate the water level with w = w − max{(n+1)−1 1( )mw H −− , 0}, but 
1
total mw P H
−= +  when n = 1. 
(2) if 1,maxm mw P H
−≥ +  and Ptotal > ∑i∈BPi,max + Pm,max 
B = B ∪ {m}. 
else  
A = A ∪ {m}; PA = Ptotal − ∑i∈BPi,max; 
1
A A mw P H
−= + . 
(c) else  
(1) 1 ,max( ) (| | 1); | |A m ma w H A b P A
−= − + = . 
(2) if b ≤ a and Ptotal > ∑i∈BPi,max + Pm,max 
wA = wA − b; B = B ∪ {m}. 
else 
wA = wA − max(a, 0); A = A ∪ {m}. 
(d) 1n n= + . 
3)   
 30
multiplication, respectively. Step 1 of the proposed method uses ( )NO  additions and 
( )NO  multiplications to roughly divide all subcarriers into A0 and B0. The processes 
in Steps 2(b)−(c) do not intersect with each other and are used to update the water 
level or the common water level; therefore, the required additions and multiplications 
in Step 2 after all subcarriers are assigned are ( )NO . Step 3 also needs ( )NO  
additions and ( )NO  multiplications because |A| < N. Therefore, the proposed 
algorithm altogether requires ( )NO  additions and ( )NO  multiplications. 
The complexity of the IPWF algorithm in Section III is mainly from the second 
step. When the WF algorithm in [14] is used, Step 2(a) requires 2( log )i iN NO  
additions and ( )iNO  multiplications, where Ni is the total number of subcarriers for 
the ith iteration. Steps 2(b)−(d) require ( )iNO  additions. Therefore, the IPWF 
algorithm requires 21( log )
I
i ii
N N=∑O  additions and 1( )I ii N=∑O  multiplications in 
total, where I is the number of iterations. When I = 1 (i.e., the lower bound of the 
computational complexity), the IPWF algorithm needs 2( log )N NO  additions and 
( )NO  multiplications. 
According the above analyses, the computational complexity of the proposed 
algorithm is less than the lower bound of the computational complexity of the IPWF 
algorithm. 
D. Simulation Results of Power Allocation Algorithms under PU Activity 
In this section, we demonstrate the proposed power allocation algorithm using 
simulation results. In all simulations, the channel gains hn ∀n were assumed to be i.i.d. 
with distribution (0, 1)CN  (i.e., E{|hn|2} = 1). The PSD of AWGN was −110 
dBW/Hz, B = 1 MHz, and N = 16 as in [11]. Subcarriers 1 through 8 belong to PU1 
 32
VI. Conclusions 
In this project, we have developed some resource allocation algorithms for 
MU-OFDM CR uplink systems, including a suboptimal power allocation algorithm, a 
suboptimal joint subcarrier and power allocation algorithm, as well as a suboptimal 
power allocation algorithm under PU activity. For power allocation, we have 
developed a method to simplify the procedure to determine whether the power in each 
assigned subcarrier satisfies the peak power constraint or not. Based on this method, 
we first develop a suboptimal power allocation algorithm for MU-OFDM CR uplink 
systems, which reduces the computational complexity of determining the water level 
to allocate the power for each subcarrier. Moreover, we have also proposed a rule to 
design a suboptimal joint subcarrier and power allocation algorithm under peak power 
constraint. Instead of applying the IPWF algorithm to aid the subcarrier assignment 
for joint subcarrier and power allocation, the proposed simple yet effective method is 
used to calculate the common water level when the number of subcarriers is changed. 
It not only reduces the complexity that arises from iteratively performing the WF 
algorithm, but also updates the common water level to satisfy the conditions of the 
optimal power distribution. Finally, we have reformulated a power allocation 
optimization problem to investigate the effects of PU activity on the system capacity. 
Based on this problem reformulation, we can obtain the optimal solution by using the 
IPWF algorithm rather than numerical methods. Without adjusting predetermined 
parameters, the solution ensures that the final power distribution leads to a positive 
expected capacity. Using the proposed method to evaluate the common water level, 
we have also developed a suboptimal algorithm whose performance approaches that 
of the optimal one. 
Simulation results have shown that the performance of the proposed power 
 34
References 
[1] Federal Communications Commission (FCC), “Spectrum policy task force,” ET 
Docket no. 02–135, Nov. 15, 2002. 
[2] J. Mitola III and G. Q. Maguire, Jr., “Cognitive radio: Making software radios 
more personal,” IEEE Pers. Commun., vol. 6, no. 4, pp. 13–18, Aug. 1999. 
[3] T. S. Rappaport, A. Annamalai, R. M. Buehrer, and W. H. Tranter, “Wireless 
communications: Past events and a future perspective,” IEEE Commun. Mag., 
vol. 40, no. 5, pp. 148–161, May 2002. 
[4] IEEE Standard for Local and metropolitan area networks Part 16: Air Interface 
for Broadband Wireless Access Systems, IEEE Standard 802.16, May 2009. 
[5] T. A. Weiss and F. K. Jondral, “Spectrum pooling: An innovative strategy for the 
enhancement of spectrum efficiency,” IEEE Commun. Mag., vol. 42, pp. S8–S14, 
Mar. 2004. 
[6] U. Berthold and J. K. Jondral, “Guidelines for designing OFDM overlay 
systems,” in Proc. 2005 IEEE 1st Int. Symposium on New Frontiers in Dynamic 
Spectrum Access Networks (DySPAN 2005), Baltimore, MD, Nov. 2005, pp. 
626–629. 
[7] Z. Han and K. J. R. Liu, Resource Allocation for Wireless Networks: Basics, 
Techniques, and Applications. Cambridge University Press, Cambridge, U.K., 
2008. 
[8] P. Wang, M. Zhao, L. Xiao, S. Zhou, and J. Wang, “Power allocation in 
OFDM-based cognitive radio systems,” in Proc. IEEE Global Telecommun. Conf. 
(Globecom 2007), Washington, DC, Nov. 2007, pp. 4061–4065. 
 36
圖表 
 
 
Fig. 1. A multiuser OFDM CR uplink system. 
 
 
 

 
Fig. 2. Opportunistic spectrum in an OFDM-based CR. 
 
 
 
 
 38
-20 -10 0 10 20
6
6.5
7
7.5
8
8.5
9
Peak Power (dB)
(a)
N
or
m
al
iz
ed
 S
um
 C
ap
ac
ity
 (b
its
/s
/H
z)
N0 = -60 dBW/Hz
-20 -10 0 10 20
0.1
0.15
0.2
0.25
0.3
0.35
0.4
0.45
0.5
0.55
0.6
Peak Power (dB)
(b)
N
or
m
al
iz
ed
 S
um
 C
ap
ac
ity
 (b
its
/s
/H
z)
N0 = -20 dBW/Hz
 
 
IPWF
Proposed
 
Fig. 4. Normalized sum capacity versus the peak power with different PSDs of 
AWGN. 
0 10 20 30 40
8.5
9
9.5
10
10.5
11
Number of Users, K
(a)
N
or
m
al
iz
ed
 S
um
 C
ap
ac
ity
 (b
its
/s
/H
z)
N0 = -60 dBW/Hz; Pk,max = -4 dB
0 10 20 30 40
0.5
0.6
0.7
0.8
0.9
1
1.1
1.2
Number of Users, K
(b)
N
or
m
al
iz
ed
 S
um
 C
ap
ac
ity
 (b
its
/s
/H
z)
N0 = -20 dBW/Hz; Pk,max = -4 dB
 
 
IPWF
Proposed
 
Fig. 5. Normalized sum capacity versus the number of users with different PSDs of 
AWGN. 
 40
0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
x 10-5
Probability (α1)
P
ow
er
 A
llo
ca
te
d
 
 
Proposed Optimal
Proposed Suboptimal
Proportional Water Level [11]
Traditional Water-filling
 
Fig. 8. Power allocated to the subcarriers of the 1st PU versus the probability that the 
PU will reoccupy these subcarriers (or PU activity). 
 
0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
-15
-10
-5
0
5
10
Probability (α1)
E
xp
ec
te
d 
N
or
m
al
iz
ed
 C
ap
ac
ity
 (b
its
/s
/H
z)
 
 
Proposed Optimal
Proposed Suboptimal
Proportional Water Level [11]
Traditional Water-filling
 
Fig. 9. Expected capacity of the 1st PU versus the probability of PU activity. 
 42
論文發表成果 
■ 國際期刊論文 
 
1. Chin-Liang Wang and Hung-Chin Wang, "Optimized joint fine timing 
synchronization and channel estimation for MIMO systems," accepted for 
publication in IEEE Transactions on Communications. 
2. Sheng-Ju Ku, Chin-Liang Wang, and Chiuan-Hsu Chen, "A reduced-complexity 
PTS-based PAPR reduction scheme for OFDM systems," IEEE Transactions on 
Wireless Communications, vol. 9, pp. 2455-2460, Aug. 2010. 
3. Chin-Liang Wang, Sheng-Ju Ku, and Chun-Ju Yang, "A low-complexity PAPR 
estimation scheme for OFDM signals and its application to SLM-based PAPR 
reduction," IEEE Journal of Selected Topics in Signal Processing, vol. 4, pp. 
637-645, June 2010. 
4. Chin-Liang Wang and Yu-Chih Huang, "Intercarrier interference cancellation 
using general phase rotated conjugate transmission for OFDM systems," IEEE 
Transactions on Communications, vol. 58, pp. 812-819, March 2010. 
5. Chin-Liang Wang and Hung-Chin Wang, "On joint fine time adjustment and 
channel estimation for OFDM systems," IEEE Transactions on Wireless 
Communications, vol. 8, pp. 4940-4944, Oct. 2009. 
 
 
 
■ 國際會議論文 
 
1. Chiuan-Hsu Chen and Chin-Liang Wang, "Joint subcarrier and power allocation 
in multiuser OFDM-based cognitive radio systems," in Proceedings of the 2010 
IEEE International Conference on Communications (ICC 2010), Cape Town, 
South Africa, May 2010. 
2. Chin-Liang Wang and Po-Chung Shen, "An energy-efficient cooperative 
SFBC-OFDM system using subcarrier permutation," in Proceedings of the 2010 
IEEE Vehicular Technology Conference - Spring (VTC 2010-Spring), Taipei, 
Taiwan, May 2010. 
3. Chiuan-Hsu Chen and Chin-Liang Wang, "Power allocation for OFDM-Based 
cognitive radio systems under primary user activity," in Proceedings of the 2010 
IEEE Vehicular Technology Conference - Spring (VTC 2010-Spring), Taipei, 
Taiwan, May 2010. 
4. Chin-Liang Wang, Ying-Chang Lin, and Po-Chung Shen, "Design of an adaptive 
receiver for OFDM systems using conjugate transmission," in Proceedings of the 
2010 IEEE Wireless Communications and Networking Conference (WCNC 2010), 
Sydney, Australia, April 2010. 
5. Chiuan-Hsu Chen and Chin-Liang Wang, "An efficient power allocation 
algorithm for multiuser OFDM-based cognitive radio systems," in Proceedings of 
the 2010 IEEE Wireless Communications and Networking Conference (WCNC 
2010), Sydney, Australia, April 2010. 
6. Han-Wei Chen, Xianbin Wang, Chin-Liang Wang, and Hai Lin, "Spectrum 
sensing of unsynchronized OFDM signals for cognitive radio communications," 
in Proceedings of the 2009 IEEE Vehicular Technology Conference - Fall (VTC 
2009-Fall), Anchorage, Alaska, Sept. 2009. 
國科會補助專題研究計畫項下赴國外(或大陸地區)出差或研習心得報告 
                                日期： 98 年 10 月 20 日 
一、經過 
繼本實驗室的一位博士班研究生前往加拿大 Dr. Xianbin Wang 之實驗室做短期研習之後，本人於
2009年6月15日至9月14日亦參與此計畫，展開為期三個月之短期研習。本人研究的重點，是針對正交
分頻多工（Orthogonal Frequency Division Multiplexing, OFDM）技術的性能做改善，此技術目前被廣泛
的應用在無線通訊領域，而其所衍生的相關應用包含有：OFDMA（Orthogonal Frequency Division 
Multiplexing Access），Multiple-Input Multiple-Output OFDM（MIMO OFDM），Cooperative OFDM…等。
在出國之前，本人已研讀過一些相關的參考文獻，並且著重於正交分頻多工技術中同步的研究。此技
術相對於傳統的單載波技術具有較高的頻寬使用效率，而且對於無線通訊環境中的多路徑衰減具有高
抵抗力；然而，它在接收端對於同步的準確度非常敏感。在相關的文獻[1]-[2]已經指出，接收端的時間
偏移會造成符元間干擾（Inter-Symbol Interference, ISI），接收端的頻率偏移會使得子載波間正交性的失
去而產生子載波間干擾（Inter-Carrier Interference, ICI）。如果系統中有多個用戶存在的話，上行端的基
地台還會面臨多用戶間干擾（Multiple Access Interference, MAI）的問題。 
在抵達加拿大西安大略大學後，首先和當地的指導教授（Dr. Xianbin Wang）見面，Dr. Wang 和另
一位教授共用一間大研究室，另外還有一間獨立的小研究室，他們的研究方向也是以無線通訊為主，
其中有些研究主題是跟本實驗室雷同的。在稍後和Dr. Wang討論後，我們決定朝著解決OFDMA上行端
中基地台同步的問題前進。在這次短期研習的前一個半月中，本人在大量搜尋的並研讀相關議題的文
獻後發現，在OFDMA上行端中基地台的同步存在著兩個問題：估測與補償(消除干擾)。相較於傳統的
OFDM系統，OFDMA上行端的接收訊號因為來自於分散在各地的不同使用者，其估測器的複雜度較高，
而準確度卻比較低；在補償的時候也因為所有使用者的訊號都疊加在一起而需要考慮多用戶間干擾的
消除。另外在大部分文獻中不會同時考慮這兩個問題，因為用來解決這兩個問題的方法，其效能彼此
間互相影響：估測器的準確度會因為多用戶間干擾而降低準確度，而消除干擾的效果又取決於估測器
的準確度。 
在與Dr. Wang討論過相關議題後，我們將目標定在提升干擾消除的效能，本人開始考慮干擾消除
的方式。傳統上消除多用戶間干擾的演算法多半是用連續干擾消除法（Successive Interference 
Cancellation, SIC）[3]-[4]或是平行干擾消除法（Parallel Interference Cancellation, PIC）[5]-[6]，然而，
這兩個方法在運算複雜度、運算速度和干擾消除的能力上各有優劣。在這次短期研習的後一個半月中，
本人試著將整個干擾消除的演算法分成兩個階段—第一階段使用速度較快的平行干擾消除法，第二階
段使用效能較高的連續干擾消除法—來取得速度與效能上的平衡點。經由數學推導與電腦模擬驗證後，
我們將其結果整理成論文格式並預計投稿到國際研討會。 
  
計畫編號 NSC96-2628-E-007-005-MY3 
計畫名稱 行動正交分頻多工系統之前瞻基頻處理技術研究 
出國人員
姓名 王順生 服務機構及職稱 
國立清華大學通訊工程研究所 
博士班研究生 
出國時間 99 年 6 月 15 日至 99 年 9 月 14 日 出國地點 
加拿大西安大略大學 
(The University of Western Ontario)
  
國科會補助專題研究計畫項下赴國外(或大陸地區)出差或研習心得報告 
                                  日期： 99 年 05 月 25 日 
一、經過 
繼本實驗室的兩位博士班研究生(陳翰緯、王順生)前往加拿大 Dr. Xianbin Wang 之實驗室做短期
研習之後，本人於2010年2月至4月亦參與此計畫，展開為期三個月之短期研習。 
本人研究的重點，是對合作式通訊的性能做改進。因此，在出國之前，本人已蒐集相關的參考文
獻，並且著重於雙路徑交互中繼站系統(Two-Path Successive Relay System, TPSRS)的研究，此系統的傳
輸過程是以兩個中繼站來交互放大訊號源傳送的訊號，然後再將此放大後的訊號傳送到目的端。相關
的文獻[1], [2]已經指出，此系統有中繼站間干擾(Inter-Relay Interference, IRI)的問題，簡單地說，某個
中繼站接收訊號源的訊號時，此中繼站也同時會收到另一個中繼站放大訊號源的訊號後所傳送的訊號，
由於此訊號是過去所有符元的線性組合，因此對於目的端的解調會造成干擾，這個干擾就被稱之為IRI。
故本人在這次的出國研習中將試圖解決此問題。 
在抵達加拿大西安大略大學後，首先和當地的指導教授(Dr. Xianbin Wang)會面，他向我介紹了該
實驗室的成員及各自的研究方向，其中的確有很多研究的重點是跟本實驗室互補，例如：用FPGA來驗
證研究的成果是否真的可行。在抵達後的第一個月，本人以文獻[2](Full Interference Cancellation, FIC)
的理論基礎做電腦模擬，在模擬中，也確實驗證了IRI會降低整個系統的性能。另一方面，本人也發現
文獻[2]的方法需要非常精準的通道資訊，若中繼站之間的通道估測有誤差(例如：通道係數的實部和虛
部分別有±5%的誤差)時，系統的性能會明顯地變差。因此，本人也嘗試研究一些方法，讓系統的性能
對此通道估測的誤差不敏感。 
在第二個月時，本人開始考慮中繼站選擇的問題，也就是說，從多個中繼站裡選兩個，藉以交互
放大訊號源的訊號到目的端。本人所提出的方法是，選出的兩個中繼站之間的通道增益必須是最小的。
如此一來，當某個中繼站在接收訊號源的訊號時，所受到另一個中繼站的干擾就會最小，也因為此干
擾相當小，目的端在做FIC時，就算通道資訊不精準，所遺留下的干擾也不大。此比較是跟完全沒有做
中繼站選擇時相比。 
第三個月時，本人將上述的理論基礎做電腦模擬。在模擬的結果裡，本人發現，FIC在使用所提出
的中繼站選擇法時，且當中繼站之間的通道係數的實部和虛部分別有±5%的誤差下，系統的性能也不
至於有太大的衰退；但若不做中繼站選擇且誤差跟上述相同時，系統的性能會明顯地衰退；另外，若
選擇的中繼站之間的通道增益為最大，且誤差跟上述相同時，整個系統的性能將變成非常差。由電腦
模擬中，可驗證此方法的確可以讓系統容忍些許中繼站之間的通道估測誤差。 
  
計畫編號 NSC96-2628-E-007-005-MY3 
計畫名稱 行動正交分頻多工系統之前瞻基頻處理技術研究 
出國人員
姓名 朱昌震 服務機構及職稱 
國立清華大學通訊工程研究所 
博士班研究生 
出國時間 99 年 2 月  1 日至 99 年 4 月 30 日 出國地點 
加拿大西安大略大學 
(The University of Western Ontario)
國科會補助專題研究計畫項下出席國際學術會議心得報告 
                               日期： 99 年 05 月 08 日 
                 
2010 IEEE 無線通訊與網路會議 (2010 IEEE Wireless Communications and Networking Conference；
簡稱 WCNC 2010) 在澳洲雪梨舉行，會議始於 2010 年 4 月 18 日，止於 4 月 21 日，歷時四日。WCNC
是 IEEE 通訊分會的年度盛會之一，議程內容涵蓋各類無線通訊、行動通訊的實體層、媒體接取控制層
與網路層之設計、分析及應用，是通訊領域相當重要、具指標性意義的大型學術會議，對新一代無線
通訊與網路技術之發展具有重要影響力。 
WCNC 2010 共有 1474 篇論文投稿，其中 1313 篇論文進入審查階段，且每篇論文至少有三位專家
學者進行審查；經過嚴謹審查後，總計有 548 篇論文被接受發表 (其中來自國內有 40 餘篇)，平均論文
接受率約為 37%；這些被接受的論文涵蓋 PHY、MAC、Networking、Services and Applications 等四個
主題類別 (Tracks)，且被分成 110 場技術議程 (Technical Sessions)，以口頭報告方式 (Oral Presentation) 
發表。除了正規性的論文發表之外，大會還安排了三場 Keynote Speeches、三場 Technology/Business 
Application Panels 及下列 8 個短期課程 (Tutorials)： 
z Biologically-inspired and Nano-scale Communication and Networking 
z Building Tomorrow’s Internet of Things: Latest Standardization Trends and Hands-on 
Programming 
z Aspects of Multiuser MIMO - Principles and Standardization in LTE-Advanced 
z Coalitional Game Theory in Wireless Networks 
z Cognitive Radios and Enabling Technologies: UWB for Cognitive Radios, Aspects of Spectrum 
Sensing and Detection, Co-existence and Interference Mitigation Techniques, and Localizing and 
Tracking Interferers 
z Congestion Control in Heterogeneous Networks 
z Localization and Tracking for Smart Devices and the Internet of Things 
z Towards 4G - Technical Overview of LTE and WiMAX 
整體而言，本次 WCNC 之議程內容豐富，吸引了數百人與會，然而會議期間適逢冰島火山劇烈噴發，
造成不少歐洲國家的專家學者因班機無法起飛而缺席，也形成多篇被接受論文無人到場發表情況，相
當可惜。 
本人與博士班學生在 WCNC 2010 會議中共發表三篇論文，分別是 An Efficient Power Allocation 
Algorithm for Multiuser OFDM-Based Cognitive Radio Systems、Design of an Adaptive Receiver for OFDM 
Systems Using Conjugate Transmission及 Design and Implementation of a Decentralized Positioning System 
for Wireless Sensor Networks。首篇論文針對多用戶 OFDM 感知無線電系統，提出一具有高效能的功率
分配演算法；此方法的複雜度低，但卻能逼近最佳演算法所能提供的系統容量，頗具實用價值。第二
計畫編號 NSC96-2628-E-007-005-MY3 
計畫名稱 行動正交分頻多工系統之前瞻基頻處理技術研究 
出國人員
姓名 王晉良 服務機構及職稱 
國立清華大學通訊工程研究所  
教授 
會議時間 2010 年 4 月 18 日至 2010 年 4 月 21 日 會議地點 澳洲、雪梨 
會議名稱 (中文) 2010 IEEE 無線通訊與網路會議 (英文) 2010 IEEE Wireless Communications and Networking Conference 
發表論文
題目 
1. An Efficient Power Allocation Algorithm for Multiuser OFDM-Based Cognitive Radio 
Systems 
2. Design of an Adaptive Receiver for OFDM Systems Using Conjugate Transmission 
3. Design and Implementation of a Decentralized Positioning System for Wireless Sensor 
Networks 
An Efficient Power Allocation Algorithm for 
Multiuser OFDM-Based Cognitive Radio Systems 
Chiuan-Hsu Chen 
Institute of Communications Engineering 
National Tsing Hua University 
Hsinchu, Taiwan 30013, Republic of China 
Chin-Liang Wang 
Department of Electrical Engineering and Institute of  
Communications Engineering 
National Tsing Hua University 
Hsinchu, Taiwan 30013, Republic of China 
E-mail: clwang@ee.nthu.edu.tw
 
 
Abstract—This paper aims to investigate an efficient power 
allocation algorithm for multiuser orthogonal frequency division 
multiplexing (MU-OFDM) cognitive radio (CR) systems that uses 
the peak power constraint to protect the primary users. Under 
this constraint, the high-complexity optimal power allocation 
algorithm for OFDM-based CR systems is not suited to 
determine the power distribution because the algorithm must 
iteratively perform the standard water-filling (WF) to determine 
whether or not the power in each assigned subcarrier is greater 
than the peak power. Instead of using the WF algorithm, we use 
the conditions that the optimal power distribution should be 
satisfied to design a simple method for fulfilling the peak power 
constraint in each assigned subcarrier and then updating the 
water level. Simulation results indicate that using the proposed 
efficient method to update the water level achieves a system 
capacity close to that of the optimal power allocation algorithm. 
Keywords-cognitive radio (CR); multiuser orthogonal frequency 
division multiplexing (MU-OFDM); peak power constraint; power 
allocation 
I.  INTRODUCTION 
In wireless networks, frequency spectrum is a limited 
resource and its efficient usage plays an important role in next-
generation wireless communication systems. From the report of 
the Federal Communications Commission (FCC) of the United 
States in 2002 [1], however, the efficiency of use of the 
licensed spectrums is less than 15%. Spectrum opportunities 
are generated that enable unlicensed users to access these 
spectrums temporally as well as spatially and thus to improve 
overall spectrum efficiency, under acceptable interference to 
the licensed users. Cognitive radio (CR) [2] is a suitable 
technology for achieving this goal because it is flexible and 
intelligent in spectrum use. 
Multiuser orthogonal frequency division multiplexing (MU-
OFDM) provides a scalable and adaptive technology for an air 
interface and has been used successfully in many wireless 
communication systems such as the IEEE 802.16 standard [3]; 
thus, MU-OFDM is a promising technique for next-generation 
wireless broadband networks [4]. Using this technique, 
different subcarriers of an OFDM symbol are able to 
simultaneously transmit different users’ data, so MU-OFDM is 
a candidate for multiple access scheme in CR systems [5], [6]. 
Recently, the resource allocation algorithm has been widely 
studied [7] because of the internal flexibility of OFDM in 
power loading across the subcarriers. An efficient resource 
algorithm for OFDM systems can dynamically assign limited 
resources (subcarriers and power) to maximize the 
performance. For MU-OFDM systems, exploiting the multiuser 
diversity, a dynamic resource allocation algorithm can assign 
the available resources to the user who has the best channel 
state information (CSI) for improving the spectrum efficiency. 
To protect the licensed users (or primary users [PUs]), the 
resource allocation problem in MU-OFDM CR systems usually 
includes a peak power constraint to limit the transmitted power 
of unlicensed users (or secondary users [SUs]) [8]-[10]. With 
the power constraint on each subchannel (a group of 
subcarriers), the optimal power allocation algorithm in single-
user OFDM-based CR systems was studied in [8], where the 
iterative partitioned water-filling (IPWF) algorithm was 
proposed to realize the optimal power allocation. Although the 
complexity of the IPWF is less than that of the exhaustive 
search algorithm, it may need to perform the water-filling (WF) 
algorithm many times for a fixed number of subcarriers. 
Moreover, when the IPWF algorithm is used to support the 
subcarrier assignment (i.e., joint subcarrier and power 
allocation), it must recalculate the water level to determine the 
power for each subcarrier, which would cause joint subcarrier 
and power allocation to have very high complexity. In [9], a 
low-complexity joint subcarrier and power allocation algorithm 
for MU-OFDM CR systems was proposed. However, its power 
allocation part does not consider the peak power constraint of 
CR systems in the optimization process, and this makes the 
algorithm less than optimal. 
In this paper, using a specified subcarrier allocation, we 
propose an efficient power allocation algorithm for MU-OFDM 
CR systems. We use the theorem in [8] to develop a simple 
method for determining whether or not the power in each 
assigned subcarrier is greater than the peak power constraint. 
Using this classification, the water level can be updated 
sequentially until all assigned subcarriers are checked. The 
proposed method not only reduces the complexity of executing 
the IPWF algorithm, but also achieves the results of the 
theorem in [8] for power allocation in MU-OFDM CR systems. 
Simulation results show that the proposed low-complexity 
algorithm achieves a system capacity close to that of the IPWF 
This work was supported by the National Science Council of the Republic 
of China under Grants NSC 96-2628-E-007-005-MY3. 
This full text paper was peer reviewed at the direction of IEEE Communications Society subject matter experts for publication in the WCNC 2010 proceedings.
978-1-4244-6398-5/10/$26.00 ©2010 IEEE
Authorized licensed use limited to: National Tsing Hua University. Downloaded on July 09,2010 at 04:48:07 UTC from IEEE Xplore.  Restrictions apply. 
IV. A SUBOPTIMAL POWER ALLOCATION ALGORITHM 
In the following, instead of using the WF algorithm to 
classify the two sets, we propose a method to update the 
common water level for determining the subcarriers in Ak and 
Bk. Before describing the steps for updating the common water 
level in Ak, we describe the lemma about the traditional WF 
algorithm. 
Lemma: Assume that the WF algorithm is performed on N 
subcarriers with power P and that the corresponding water 
level is w. If a new subcarrier with CNR, H, is added, the new 
water level becomes 
1max( ,0)
1
w Hw w
N
−
= −
+
    (4) 
when w  is also greater than or equal to the inversions of the 
CNRs of the original N subcarriers. 
Proof: When a new subcarrier with CNR, H, is added, the 
assigned power of the new subcarrier is 1w H −− , where w  is 
the new water level. This value is derived from the power that 
is allocated to the original N subcarriers; that is, 
1 ( )w w w N
H
− = −           (5) 
when 1w H −>  (or w w>  ). Eq. (5) can be rewritten as 
1 1
1 1
Nw H w Hw w
N N
+ −
= = −
+ +
 .  (6) 
If w < H−1, there is no additional power can be assigned; 
therefore, the power on H−1 is zero and the water level w is still 
the original value.                ■ 
A. The Update of the Common Water Level 
In Section III, the IPWF algorithm may need to perform the 
WF algorithm many times to categorize the assigned 
subcarriers into two different sets. To reduce the computational 
burden of this categorization, we use the results of the theorem 
in [8]—that is, the common water level in Ak is greater than or 
equal to the unique water levels in Bk (wk,n ≤ wˆ  ∀n∈Bk)—to 
design a method for updating the common water level. Using 
the common water level, the power of the subcarriers in Ak can 
be assigned immediately. The power of each subcarrier in Bk is 
Pk,max. 
Proposition: Assume that the sets Ωk = {1, 2, …, Nk} and 
Ψk = {1, 2, …, kN }, where Ψk ⊆ Ωk and kN  ≤ Nk. From 
Section III, suppose that ˆ kw  is the common water level of the 
set Ak = {i| pk,i < Pk,max, i∈Ψk}. Then, the jth subcarrier (j∉Ψk 
but j∈Ωk) will be assigned to Bk = {i| pk,i = Pk,max, i∈Ψk} if 
, ,maxˆ 1 .
| | 1 | |
k k j k
k k
k k
w H P
a b
A A
−
≥
+
        (7) 
Otherwise, the subcarrier will be in Ak. The new common water 
level of Ak is ˆ min(max( , 0), )k k kw a b− . In addition, when j∈Bk, 
|Bk| must satisfy Pk > (|Bk|+1)Pk,max to ensure the total power 
allocated to Ak is positive. 
Proof: If j∈Bk, the assigned power in the jth subcarrier is 
Pk,max and the common water level of Ak becomes 
,maxˆ | |k k kw P A−  and the new common water level must be 
greater than or equal to the unique water level in the jth 
subcarrier; that is, 
,max
, ,max
,
1ˆ
| |
k
k k j k
k k j
P
w w P
A H
− ≥ = +  or 
, ,maxˆ 1 .
| | 1 | |
k k j k
k k
k k
w H P
a b
A A
−
≥
+
     (8) 
Otherwise, the jth subcarrier is assigned to Ak. Using the above-
mentioned lemma, the new common water level becomes 
,ˆ 1ˆ ˆmax( , 0) max( , 0).
| | 1
k k j
k k k
k
w H
w w a
A
−
− = −
+
  (9) 
With (8) and (9), the new common water level depends on the 
minimum between max( , 0)ka  and bk; that is, 
ˆ min(max( , 0), )k k kw a b− .              (10) 
Moreover, when j∈Bk, the total power of Ak is 
1 1
, ,
,max ,max
ˆ ˆ( ) ( )
| | 0.
k k k
k k k i k k i ki A i A i A
k k k k
w b H w H b
P B P P
− −
∈ ∈ ∈
− − = − −
= − − >
∑ ∑ ∑  (11) 
That is, Pk > (|Bk| + 1)Pk,max.                ■ 
B. The Proposed Power Allocation Algorithm 
To determine the kth SU’s common water level of the 
assigned subcarriers, we sequentially classify each subcarrier 
into the set Ak or set Bk by comparing the water level with each 
subcarrier’s unique water level, determining whether or not the 
assigned power is greater than Pk,max. In the initialization step, 
we roughly divide the assigned subcarriers into Ak0 and Bk0, 
which are the initial divisions among all subcarriers to reduce 
the complexity for the following steps. With Ak0 and Bk0, vk is 
defined as a vector that contains Ak0’s elements, which follows 
the elements of Bk0. The power allocation is performed on the 
subcarriers according to the elements of vk in sequence. 
In the power assignment step, when the set Ak is null, the 
water level is updated by the rule of the lemma and the current 
subcarrier also is determined to assign it to either Ak or Bk. If 
Ak is not empty, the initial common water level is evaluated 
and then updated when the next assigned subcarrier is 
concerned. The proposition provides a method for renewing 
the common water level. Details of the proposed power 
allocation algorithm of the kth SU for a channel realization are 
summarized as follows: 
1) Initialization 
(a) The following parameters are defined first: 
{1,2,..., }k kNΩ = , k kA B φ= = , 0Akw = , 1n = , Pk,max, 
and Pk. 
(b) 1
,( )
k
k k k i ki
w P H N−
∈Ω
= +∑ ; 
0
1
0 ,max , 0,1 0,| |{ | , } { , ..., }kk k k k i k k k AA i w P H i a a
−
= < + ∈Ω = ; 
This full text paper was peer reviewed at the direction of IEEE Communications Society subject matter experts for publication in the WCNC 2010 proceedings.
Authorized licensed use limited to: National Tsing Hua University. Downloaded on July 09,2010 at 04:48:07 UTC from IEEE Xplore.  Restrictions apply. 
transmitted power for each SU was 0 dB. All simulation results 
shown in all figures are averaged over 10,000 channel 
realizations.  
For a multiuser OFDM CR system with N = 128 and K = 8, 
the subcarrier allocation is that SU k uses subcarriers 
16(k−1)+1 through 16k. That is, subcarriers 1 through 16 
belong to SU 1, subcarriers 17 through 32 belong to SU 2, and 
so on. The maximum path loss difference was 40 dB and the 
SU locations were assumed to be uniformly distributed. Fig. 3 
shows that the performance of the proposed algorithm is close 
to that of the IPWF algorithm for two different noise powers. In 
the low noise power case, the normalized sum capacity quickly 
saturates at Pk,max = −12 dB. That is, the capacity experiences 
no loss even though the peak power constraint is imposed on 
each subcarrier. In the high noise power case, the saturation 
point is at Pk,max = −8 dB. The noise enhances the effect of the 
peak power constraint so that the normalized sum capacity 
cannot saturate at a lower peak power constraint. Although the 
performance of the proposed algorithm degrades slighter more 
than that of the IPWF algorithm, they saturate at the same peak 
power. The performance gap in Fig. 3(b) results from the 
difference between the estimated water level and the true water 
level evaluated by the WF algorithm in the high noise 
environment. 
In Fig. 4, the normalized sum capacity is drawn for several 
different values of the number of users (i.e., K = 8, 12, 16, …, 
32). It is clear that the capacity increases as the number of users 
increases, thus confirming the effect of the multiuser diversity. 
Fig. 5 illustrates the normalized sum capacity for various 
values of the path loss difference. The increase in the capacity 
also results from the multiuser diversity because some SUs’ 
channel gains are better than those of other SUs. This result 
indicates that the peak power constraint may not be fixed for all 
subcarriers because an SU with better channel gain may cause 
significant interference to the PU even though the transmitted 
power of the SU is small. 
VI. CONCLUSION 
In this paper, we have proposed a suboptimal power 
allocation algorithm for MU-OFDM CR uplink systems that 
reduces the computational complexity of determining the water 
level to allocate the power for each subcarrier. The proposed 
method simplifies the procedure to determine whether or not 
the power in each assigned subcarrier is more than the peak 
power constraint. It not only involves lower complexity than 
the optimal power allocation algorithm in [8], but also can 
easily be combined with a subcarrier allocation algorithm for 
joint subcarrier and power allocation. Simulation results have 
shown that the performance of the proposed method is close to 
that of the optimal power allocation algorithm. The low-
complexity and excellent-performance feature makes it 
attractive for use in MU-OFDM CR systems. 
REFERENCES 
[1] Federal Communications Commission (FCC), “Spectrum policy task 
force,” ET Docket no. 02–135, Nov. 15, 2002. 
[2] J. Mitola III and G. Q. Maguire, Jr., “Cognitive radio: Making software 
radios more personal,” IEEE Pers. Commun., vol. 6, no. 4, pp. 13–18, 
Aug. 1999. 
[3] IEEE Standard for Local and metropolitan area networks Part 16: Air 
Interface for Broadband Wireless Access Systems, IEEE Standard 
802.16, May 2009. 
[4] T. S. Rappaport, A. Annamalai, R. M. Buehrer, and W. H. Tranter, 
“Wireless communications: Past events and a future perspective,” IEEE 
Commun. Mag., vol. 40, no. 5, pp. 148–161, May 2002. 
[5] T. A. Weiss and F. K. Jondral, “Spectrum pooling: An innovative 
strategy for the enhancement of spectrum efficiency,” IEEE Commun. 
Mag., vol. 42, pp. S8–S14, Mar. 2004. 
[6] U. Berthold and J. K. Jondral, “Guidelines for designing OFDM overlay 
systems,” in Proc. IEEE 1st Int. Symposium on New Frontiers in 
Dynamic Spectrum Access Networks (DySPAN ‘05), Baltimore, MD, 
Nov. 2005, pp. 626–629. 
[7] Z. Han and K. J. R. Liu, Resource Allocation for Wireless Networks: 
Basics, Techniques, and Applications. Cambridge University Press, 
Cambridge, U.K., 2008. 
[8] P. Wang, M. Zhao, L. Xiao, S. Zhou, and J. Wang, “Power allocation in 
OFDM-based cognitive radio systems,” in Proc. IEEE Global 
Telecommun. Conf. (Globecom 2007), Washington, DC, Nov. 2007, pp. 
4061–4065. 
[9] F. F. Digham, “Joint power and channel allocation for cognitive radios,” 
in Proc. IEEE Wireless Commun. and Networking Conf. (WCNC 2008), 
Las Vegas, NV, Mar. 2008, pp. 882–887. 
[10] X. Kang, Y.-C. Liang, and A. Nallanathan, “Optimal power allocation 
for fading channels in cognitive radio networks under transmit and 
interference power constraints,” in Proc. IEEE Int. Conf. Commun. (ICC 
2008), Beijing, China, May 2008, pp. 3568–3572. 
[11] J. M. Cioffi. (2008) EE379C Advanced Digital Communications 
[Online]. Available: http://www.stanford.edu/class/ee379c 
[12] T. M. Cover and J. A. Thomas, Elements of Information Theory. 2nd Ed. 
New York: Wiley, 2006. 
 
 
Figure 1.  A multiuser OFDM CR uplink system. 
 
TABLE I.  Comparison of Computational Complexity 
 
Proposed 
Algorithm IPWF Algorithm 
Multiplications O(N)  O(N) (Lower Bound) 
Additions O(N) O(Nlog2(N/K))  (Lower Bound) 
 
Method
Complexity
This full text paper was peer reviewed at the direction of IEEE Communications Society subject matter experts for publication in the WCNC 2010 proceedings.
Authorized licensed use limited to: National Tsing Hua University. Downloaded on July 09,2010 at 04:48:07 UTC from IEEE Xplore.  Restrictions apply. 
  Design of an Adaptive Receiver for OFDM     
Systems Using Conjugate Transmission 
 
Chin-Liang Wang†‡, Ying-Chang Lin‡, and Po-Chung Shen‡ 
†Department of Electrical Engineering, National Tsing Hua University 
‡Institute of Communications Engineering, National Tsing Hua University 
Hsinchu, Taiwan 30013, Republic of China 
E-mail: clwang@ee.nthu.edu.tw 
 
 
Abstract—In this paper, we first investigate two efficient inter-
carrier interference (ICI) self-cancellation schemes for 
orthogonal frequency division multiplexing (OFDM) systems, 
conjugate cancellation (CC) and phase-rotated conjugate 
cancellation (PRCC), by examining their system structures and 
performances. Then, we propose an adaptive receiver design 
based on conjugate transmission for ICI self-cancellation in 
OFDM systems. Compared to PRCC, the proposed receiver not 
only saves the signaling overhead by omitting the need to feed the 
frequency offset estimate back to the transmitter, but also has the 
frequency tracking capability by adopting the normalized block 
least mean-squared algorithm in the update process for the 
artificial phase rotation factor. Computer simulations show that 
the proposed scheme can provide better bit-error-rate 
performance over both CC and PRCC. Besides, even if the 
frequency offset estimation error is considered, the proposed 
scheme is shown to be more robust than the other methods. 
Keywords-block least mean-squared (BLMS) algorithm; 
frequency offset; inter-carrier interference (ICI); ICI self-
cancellation; orthogonal frequency division multiplexing (OFDM)  
I. INTRODUCTION 
Orthogonal frequency division multiplexing (OFDM) [1] is 
a wideband transmission technique suitable for high-rate 
multimedia services. The attractive properties such as high 
bandwidth efficiency and the immunity to multipath fading 
channels make OFDM become popular in modern wireless 
communication systems. Nevertheless, the performance of 
OFDM is highly sensitive to the carrier frequency offset which 
might arise from the Doppler effect in mobile environments or 
the mismatch between local oscillators at the transmitter and 
receiver.  
To solve the frequency offset problem, the most intuitive 
way is to synchronize the carrier frequency of the received 
signal to that of the transmitted signal. In this case, both 
frequency offset estimation and compensation need to be 
performed [2], [3]. In [4], an inter-carrier interference (ICI) 
self-cancellation scheme was proposed that typically uses 
polynomial coding on the transmitted symbols in the 
frequency domain such that the ICI induced from distinct 
subcarriers can be suppressed by one another. A notable 
expense of this approach is that the bandwidth efficiency 
would be halved. Moreover, the corresponding bit-error-rate 
(BER) performance may be limited due to the phase error 
generated in the coherent detection process. Although the 
method proposed in [5] can mitigate the phase error problem, 
it still cannot provide satisfactory performance under 
environments with high frequency offsets. Recently, two-path 
conjugate transmission was introduced and two ICI self-
cancellation alternatives, called conjugate cancellation (CC) 
[6] and phase-rotated conjugate cancellation (PRCC) [7], were 
proposed. In CC, an OFDM symbol is transmitted through the 
first path, while its conjugate replica is transmitted through the 
second path. After combining the received signals from the 
two paths, the ICI in one path could be suppressed by that in 
the other path. In PRCC, an artificial phase rotation factor is 
introduced to the transmitter in CC such that the ICI 
cancellation capability becomes more generic and flexible. 
Although CC and PRCC work well for time-invariant 
channels, they might not provide satisfactory performance for 
time-variant channels where the frequency offset changes with 
time. Besides, the receiver in PRCC needs to feed the 
frequency offset estimate back to the transmitter for 
determination of the optimal phase rotation factor, which 
induces an additional signaling overhead in OFDM systems.  
In this paper, we propose an ICI self-cancellation scheme 
which employs the concept of conjugate transmission at the 
receiver. In contrast to PRCC, an artificial phase rotation is 
introduced at the receiver instead of the transmitter for the 
proposed approach. Moreover, the phase rotation factor is 
tuned adaptively with frequency offset variations by means of 
the normalized block least mean-squared (BLMS) algorithm. 
It is shown that the proposed receiver structure can provide 
better ICI cancellation performance than CC and PRCC, 
especially under environments with time-variant frequency 
offsets. 
The rest of the paper is organized as follows. Section II 
describes the system model and derives the carrier-to-
interference ratios (CIR) of the original OFDM, CC, and PRCC 
schemes. In Section III, the proposed receiver structure for ICI 
cancellation is introduced. Section IV gives performance 
comparisons of the proposed scheme and other methods. 
Finally, conclusions are given in section V. 
This work was supported by the National Science Council of the Republic
of China under Grants NSC 96-2628-E-007-005-MY3 and NSC 97-2219-E-
007-007. 
This full text paper was peer reviewed at the direction of IEEE Communications Society subject matter experts for publication in the WCNC 2010 proceedings.
978-1-4244-6398-5/10/$26.00 ©2010 IEEE
the proposed scheme can work well in time-variant channels, 
where accurate frequency offset estimation is hardly provided. 
0 0.05 0.1 0.15 0.2 0.25 0.3 0.35
0
10
20
30
40
50
60
70
80
Normalized frequency offset ε
CI
R 
(dB
)
 
 
Standard OFDM
CC
PRCC φ = -0.1565
PRCC φ = -0.4694
PRCC φ = φopt
Fig. 2. CIR comparison of the original OFDM system, CC, and PRCC using 
different phase rotations.  
III. THE PROPOSED SCHEME 
In order to inherit the ICI cancellation capability of PRCC 
and omit feeding back the information of frequency offset 
estimate, we design a similar structure at the receiver, rather 
than at the transmitter. Therefore, the transmitter structure in 
the proposed scheme is the same as in CC, as shown in Fig. 1. 
A. Signal Model 
In the proposed scheme, the two-path transmission is 
carried out by sending the OFDM symbol and its conjugate 
replica in two consecutive time slots. Assuming a time-
invariant and uncorrelated-scattering (US) channel model, the 
time-domain received signals from the two transmission paths 
can be expressed as 
 
1
2 /
0
,  0,  1,  ,  1
L
j n N
n n l l n
l
y x h e w n Nπ ε
−
−
=
⎛ ⎞
= + = −⎜ ⎟⎝ ⎠∑ "         (9) 
and 
1
* 2 /
0
,  0,  1,  ,  1,
L
j n N
n n l l n
l
y x h e w n Nπ ε
−
−
=
⎛ ⎞
= + = −⎜ ⎟⎝ ⎠∑  "       (10) 
where L is the number of channel taps, and nw  and nw  are 
independent zero-mean additive noise samples. By applying 
FFT to (9) and (10), we obtain the demodulated symbols at the 
mth subcarrier 
1
0
( ) ,  0,  1,  ,  1,
N
m k k m
k
Y X H S m k W m Nε
−
=
= − − + = −∑ "      (11) 
 
1
0
( ) ,  0,  1,  ,  1,
N
m k k m
k
Y X H S m k W m Nε
−
=
= − + + = −∑   "      (12) 
 
where mW  and mW  are the discrete Fourier transform of nw  
and nw , respectively. It can be derived that the channel gains 
at the kth subcarrier in the two paths have the following 
relationship 
( )
*1 1
* 2 / 2 ( ) / *
0 0
,
L L
j kl N j k l N
k l l k
l l
H h e h e Hπ π
− −
− − −
−
= =
⎛ ⎞
= = =⎜ ⎟⎝ ⎠∑ ∑         (13) 
which means that due to conjugate transmission, the channel 
gains at the same subcarrier but in different paths would be 
made highly uncorrelated. Hence, maximum ratio combining 
(MRC) can be applied to the received symbols from both 
paths to take advantage of two-path diversity. To employ 
MRC in the proposed receiver scheme, the symbols in (11) 
and (12) would firstly be weighted by their individual channel 
gains, such as *m m mZ H Y=  and 
*
m m mZ H Y=   . Then, opposite 
phase rotations will be applied to the signals in different paths, 
i.e., multiplying the first path’s signal with nje φ  and the 
second path’s signal with nje φ− , where nφ  is the phase rotation 
factor applied at the OFDM symbols in the (2n-1)th and the 
2nth time slot. As a result, the final MRC output can be written 
as 
( )
1
* *
0
* *
   ( ) ( )
       ,  0,  1,  ,  1, (14)       
n n
n n
n n
j j
m m m
N
j j
k m k n m k n
k
j j
m m m m
R e Z e Z
X e H H S m k e H H S m k
e H W e H W m N
φ φ
φ φ
φ φ
ε ε
−
−
−
=
−
= +
⎡ ⎤= − − + − +⎣ ⎦
+ + = −
∑

 
  "
je φ
je φ−
Y
Y
*H
*H
2
H
Xˆ
*( )⋅
Z
Z
R
∇
Dˆ
2H
ˆ
1d
ˆ
2d
 
Fig. 3. Block diagram of the proposed adaptive receiver. 
Fig. 3 shows the block diagram of the proposed receiver, 
which comprises an upper branch and a lower branch. The 
upper branch consists of diversity combining, signal 
equalization and detection blocks; the lower branch involves 
signal reconstruction and adaptive phase rotation blocks. 
Assume that the symbol at the mth subcarrier has been 
detected and denoted by ˆ mX  in the decision-directed mode, it 
is utilized with the channel state information (CSI) to produce 
  21ˆ ˆm m md H X=                                    (15) 
and 
22ˆ ˆ .m m md H X=                                    (16) 
Then, we use 1ˆmd  and 
2ˆ
md  to reconstruct the first term in (14) 
with k m= ,  which is written as 
 
1 2
22
ˆ ˆ ˆˆ ˆ(- ) ( )
ˆˆ ˆ   (- ) ( ) .
n n
n n
j j
m n m n m
j j
n m n m m
d e S d e S d
e S H e S H X
φ φ
φ φ
ε ε
ε ε
−
−
= +
⎡ ⎤
= +⎢ ⎥⎣ ⎦
       (17) 
This full text paper was peer reviewed at the direction of IEEE Communications Society subject matter experts for publication in the WCNC 2010 proceedings.
degrades with the increase of estimation error, especially at 
large frequency offsets. However, the BER performance 
degradation of the proposed scheme is very slight 
comparatively. This is due to the correction of phase rotation 
factor in the proposed scheme, which makes it more robust 
against the frequency offset estimation error. Fig. 5 depicts 
another BER comparison in a time-variant channel, i.e. 
0Dε ≠ . Similarly, the BER curves of the proposed scheme 
still degrade more slightly than the PRCC scheme with the 
increase of frequency offset variation.  
0 5 10 15 20 25 30 35
10-6
10-5
10-4
10-3
10-2
10-1
100
Eb / N0 (dB)
BE
R
Multipath fading channel εD = 0.1 , ε = 0.05 , Perfect CSI
 
 
Compensation ( | ε| / ε =   0 % )
Compensation ( | ε| / ε = 20 % )
CC
PRCC            ( | ε| / ε =   0 % )
PRCC            ( | ε| / ε = 20 % )
Proposed       ( | ε| / ε =   0 % )
Proposed       ( | ε| / ε = 20 % )
Fig. 6. BER comparison of different schemes over a multipath fading channel 
with ε = 0.05 and εD = 0.1 under perfect and imperfect synchronization 
conditions. 
0 5 10 15 20 25 30 35
10-5
10-4
10-3
10-2
10-1
100
Eb / N0 (dB)
BE
R
Multipath fading channel εD = 0.1 , ε = 0.15 , Perfect CSI
 
 
Compensation ( | ε| / ε =   0 % )
Compensation ( | ε| / ε = 20 % )
CC
PRCC            ( | ε| / ε =   0 % )
PRCC            ( | ε| / ε = 20 % )
Proposed       ( | ε| / ε =   0 % )
Proposed       ( | ε| / ε = 20 % )
 
Fig. 7. BER comparison of different schemes over a multipath fading channel 
with ε = 0.15 and εD = 0.1 under perfect and imperfect synchronization 
conditions. 
Figs. 6 and 7 show the BER comparison of different 
schemes over a multipath fading channel with εD = 0.1 under 
different synchronization conditions for ε = 0.05 and ε= 0.15, 
respectively. Since CC doesn't need to know the frequency 
offset information, the frequency offset estimation errors would 
not affect its performance. We can observe that the two-path 
transmission schemes can offer better performance than the 
conventional frequency compensation scheme due to the two-
path diversity in Fig. 6. Moreover, the proposed scheme 
outperforms CC and PRCC while error floors can be seen in 
both the other schemes at high SNR. It implies that the 
proposed scheme can provide a wider range of tolerable 
frequency offsets than the others. By observing Fig. 7, we can 
see that error floors rise up in all two-path transmission 
schemes with a larger frequency offset. Nevertheless, the 
proposed scheme can still offer satisfactory performance than 
the other schemes. Besides, the BER performance of the 
proposed scheme almost stays fine even with frequency offset 
estimation errors. 
V. CONCLUSIONS 
In this paper, we have proposed an adaptive receiver design 
based on conjugate transmission for ICI cancellation in 
OFDM systems. We utilize the normalized BLMS algorithm 
to adjust the phase rotation factor at the receiver to maintain 
ICI self-cancellation effectiveness with the variation of 
frequency offset under time-varying channels. Compared to 
the PRCC scheme in [7], the proposed receiver does not need 
to feed the frequency offset estimate back to the transmitter, 
hence the signaling overhead in the PRCC scheme can be 
eliminated. Computer simulations have shown that the 
proposed scheme can provide better robustness against the 
frequency offset estimation error than the PRCC scheme. 
Under time-varying channels, the proposed adaptive receiver 
can also provide better CIR performance than existing ICI 
self-cancellation schemes. 
REFERENCES 
[1] R. van Nee and R. Prasad, OFDM for Wireless Multimedia 
Communications. Norwood, MA: Artech House, 2000. 
[2] J. J. van de Beek, M. Sandell, and P. O. Borjesson, “ML estimation of 
time and frequency offset in OFDM systems,” IEEE Trans. Signal 
Process., vol. 45, no. 7, pp. 1800-1805, July 1997. 
[3] U. Tureli, D. Kivanc, and H. Liu, “Experimental and analytical studies 
on a high-resolution OFDM carrier frequency offset estimator,” IEEE 
Trans. Veh. Technol., vol. 50, no. 2, pp. 629-643, Mar. 2001. 
[4] Y. Zhao and S.-G. Häggman, “Intercarrier interference self-cancellation 
scheme for OFDM mobile communication systems,” IEEE Trans. 
Commun., vol. 49, no. 7, pp. 1185-1191, July 2001. 
[5] K. Sathananthan, C. R. N. Athaudage, and B. Qiu, “A novel ICI 
cancellation scheme to reduce both frequency offset and IQ imbalabce 
effects in OFDM,” in Proc. IEEE 9th Int. Symp. Comput. Commun., July 
2004, pp. 708-713. 
[6] H.-G. Yeh, Y.-K. Chang, and B. Hassibi, “A scheme for cancelling 
intercarrier interference using conjugate transmission in multicarrier 
communication systems,” IEEE Trans. Wireless Commun., vol. 6, no. 1, 
pp. 3-7, Jan. 2007.  
[7] C.-L. Wang and Y.-C. Huang, “Intercarrier interference cancellation 
using general phase rotated conjugate transmission for OFDM systems,” 
IEEE Trans. Commun., vol. 58, no. 3, March 2010. 
[8] S. Haykin, Adaptive Filter Theory. 4th ed., Upper Saddle River, NJ: 
Prentice-Hall, 2002. 
[9] B. O’Hara and A. Petrick, The IEEE 802.11 Handbook: A Designer’s 
Companion. IEEE Press, 1999. 
 
This full text paper was peer reviewed at the direction of IEEE Communications Society subject matter experts for publication in the WCNC 2010 proceedings.
  
由於這次會議有許多篇論文發表，所以議程的主題分的很細，從議程的安排可以看出通訊系統除
了原本的正交分頻多工與多輸入多輸入(MIMO)技術仍然有許多篇論文發表之外，目前最熱門的研究題
目是感知無線電(cognitive radio)、合作式通訊(cooperative communications)、隨意網(Ad Hoc)與 mesh 
networks，因為這些主題的場次比其他題目多，到場聆聽的人數也比較多。在感知無線電部分，除了 
spectrum sensing 與 resource allocation 之外，還有加入了 MIMO 的技術、合作式通訊技術等方面的
論文，也讓與感知無線電相關的研究主題有更多不一樣的方向來討論了。另外，這次會議在每場報告
之前會有工作人員登記出席的報告者，報告之後也會有工作人員來要報告者簽名，算是管控會議報告
者出席率的一項措施。 
由於這次的國際通訊會議是第一次在非洲大陸舉辦，所以可以感受到當地主辦單位的用心，除了
在當地新建好不久的開普敦國際會議中心舉辦之外，歡迎會並安排帶有非洲風格的表演與規劃當地相
關旅遊行程，都是想讓與會學者體會到主辦單位的熱情。另外，可能開普敦是南非治安還算不錯的城
市，白天在當地活動並沒有像新聞所報導說南非治安很差的感覺，除了偶而會有人來要東西吃之外，
所接觸到的當地民眾都還蠻友善的。 
三、考察參觀活動(無是項活動者省略) 
無。 
四、建議 
目前每年所舉辦的大大小小國際會議有很多，建議研究生至少要參與像國際通訊會議這種大型會
議一次，雖然報告的場面各個會議大同小異，但看到會場這麼多參與人數的場面，多少會讓自己的眼
界更開闊，而且國際知名學者通常會參加這種大型國際會議，有機會互動的話也讓自己社交領域更擴
充。 
五、攜回資料名稱及內容 
會議光碟與議程紙本。 
六、其他 
無。 
 
joint scheme in [8], even though it sorts all of the SUs’ 
channels in each subcarrier. 
This paper is organized as follows. Section II introduces the 
MU-OFDM CR system model and formulates the resource 
allocation problem. In Section III, the rule for the subcarrier 
allocation and the optimal power allocation algorithm are given. 
In Section IV, the method to update the water level is 
developed. In Section V, the proposed joint subcarrier and 
power allocation algorithm is presented. Simulation results are 
shown in Section VI, and conclusions are drawn in Section VII. 
II. SYSTEM MODEL 
Consider a multiuser OFDM CR uplink system with M PUs 
and K SUs in Fig. 1, where all SUs are controlled by an SU 
base station (BS) [8]. Based on the spectrum sensing 
techniques, SUs are allowed to access the idle licensed 
spectrum where the PUs are absent. When the SU BS, PUs, and 
SUs have full knowledge of the CSI, the subcarrier and power 
(bit) data of each SU are given for forming an OFDM symbol 
at the transmitter by a resource allocation algorithm. 
In a CR system, the transmitted power of SUs may cause 
unexpected interference to the PUs, whether or not the PUs are 
starting to communicate on a channel that is currently being by 
some SUs. Thus, an additional mechanism is needed to ensure 
that on the communication links of PUs the received signal-to- 
interference-plus-noise ratio (SINR) on each PU is larger than a 
threshold [8]. The SINR constraint on the power allocated for 
user k in subcarrier n (i.e., pk,n) is given by [8] 
0 0
, ,max
,
1 ( )T uk n k
k u
P d N Bp P
d N
β
β ζ
−
−
≤ −    (1) 
where PT is the transmitted power of the PU, d0u is the distance 
between the PU (transmitter) and the uth PU (receiver), dk,u is 
the distance between the kth SU and the uth PU, β is the path-
loss exponent, N0 is the power spectrum density (PSD) of 
additive white Gaussian noise (AWGN), B is the overall 
available bandwidth, N is the total number of subcarriers, ζ is 
the minimum SINR required at each PU for correct decoding, 
and Pk,max is the maximum allocated power for all subcarriers of 
the kth SU. 
Using the peak power constraint in (1), the optimization 
problem considered in this paper is formulated as 
, ,
1
, 2 , ,1 1,  
,1
,1
, ,max
,
,
max  log (1 )
subject to:  
                 1 
                  , 
                 0 , 
                {0,  1} ,
k n k n
K N
k n k n k nk np
N
k n kn
K
k nk
k n k
k n
k n
BN p H
p P k
n
p P k n
p k n
k
α
α
α
α
−
= =
=
=
+
≤ ∀
= ∀
≤ ∀
≥ ∀
= ∀
∑ ∑
∑
∑
 n
  (2) 
where αk,n indicates whether or not the subcarrier n is used by 
SU k; Pk is the overall available power of SU k; Hk,n = 
|hk,n|2/(N0BN−1) is the CNR for SU k in subcarrier n; and hk,n is 
the channel gain for SU k in subcarrier n. To make it easier to 
solve the problem, (2) can be transformed into a convex 
optimization problem, as follows [10] 
, ,
1
, 2 , , ,1 1,  
,1
,1
, ,max
,
,
min  log (1 )
subject to:  
                 1 
                  , 
                 0 , 
                (0,  1
k n k n
K N
k n k n k n k nk np
N
k n kn
K
k nk
k n k
k n
k n
BN p H
p P k
n
p P k n
p k n
α
α α
α
α
−
= =
=
=
− +
≤ ∀
= ∀
≤ ∀
≥ ∀
∈
∑ ∑
∑
∑
] ,  k n∀
 (3) 
That is, the original maximization problem is transformed into 
a minimization problem. The last constraint in (2) is relaxed 
and its value is on the half-open interval of (0, 1]. 
III. SUBCARRIER AND POWER ALLOCATION FOR MU-
OFDM CR SYSTEMS 
In the following, we first propose a rule for assigning the 
subcarriers and then introduce the optimal power allocation 
algorithm for MU-OFDM CR uplink systems. 
A. A Rule for Subcarrier Allocation 
The optimization problem in (3) is equivalent to finding the 
minimum of the Lagrangian function 
1
, 2 , , ,1 1
, , , ,max1 1
log (1 )
( ) ( 1) ( )
K N
k n k n k n k nk n
N K
k k n k n k n n k n kn k
L BN p H
p P u v p P
α α
λ α
−
= =
= =
= − +
+ − + − + −
∑ ∑
∑ ∑
   (4) 
where λk, un, and vn are the Lagrangian multipliers for the first 
three constraints in (3), respectively. 
Proposition 1: For the optimization problem in (3), the 
subcarrier n is allocated to the user whose pi,nHi,n or wiHi,n is 
maximum, where wi is the water level for the ith user when the 
power allocation is performed by the water-filling algorithm. 
Proof: Differentiating (4) with respect to αk,n and setting the 
derivative to zero, we obtain 
, , , , ,
, , , , ,
, , , , ,
, , , ,
[ln(1 ) ] 0
ln 2 1
ln 2ln(1 ) .
1
k n k n k n k n k n
n
k n k n k n k n k n
k n k n k n k n k n n
k n k n k n k n
p H p HL B u
N p H
p H p H u N
p H B
α
α α α
α
α α
∂ −
= + − + =
∂ +
⇒ + = +
+
 (5) 
Let 1
, , ,1 k n k n k nx p H α
−
= +  and 1 ln 2nc u NB
−
= . Eq. (5) can be 
expressed as 1 11 1x c x cx e e e
− −
− + − +
= =  
11 (1 ).x cx e e
−
− − − +
− = −   (6) 
Because (6) is written in a form such as Y = XeX, where Y = 
−e−(1+c) and X = −x−1, its solution is −x−1 = W(−e−(1+c)), where 
W(⋅) is the Lambert W function [11]. Substituting this solution 
into (6), we find that x = exp{1+ W(−e−(1+c))+c} or 
(1 )
, , , exp{1 ( ) } 1.
c
k n k n k np H W e cα
− +
= + − + −    (7) 
That is, 1
, , ,k n k n k np H α
−  is a constant for all users. To maximize αk,n, 
the subcarrier n should be allocated to user k selected by 
k = arg maxk(pk,nHk,n) or k = arg maxk(wkHk,n)  (8) 
where wk is the water level for user k when the water-filling 
algorithm is performed; that is, pk,n = max(wk − 1/Hk,n, 0).        ■ 
Although the results of the subcarrier allocation in [8] 
arrive at the same conclusion as (8), uncertainties remain in the 
This full text paper was peer reviewed at the direction of IEEE Communications Society subject matter experts for publication in the IEEE ICC 2010 proceedings
Authorized licensed use limited to: National Tsing Hua University. Downloaded on July 02,2010 at 05:02:52 UTC from IEEE Xplore.  Restrictions apply. 
V. A SUBOPTIMAL JOINT SUBCARRIER AND POWER 
ALLOCATION ALGORITHM 
A. The Proposed Algorithm 
From Section IV and (8), the steps of the proposed joint 
subcarrier and power allocation algorithm are summarized as 
follows: 
1) When Ak is empty, calculate the water level to assign the 
subcarriers to the sets Ak and Bk.  
2) If Ak is not empty, evaluate the initial value of the 
common water level with power PAk = Pk − |Bk|Pk,max. The 
unique water levels in Bk are Pk,max + 1/Hk,n ∀n∈Bk.  
3) Update the common water level if Ak is not null. 
4) Assign the subcarrier with the rule in (8). Repeat 1)−4) 
for all subcarriers. 
5) Finally, for Bk, move the subcarriers to Ak if their unique 
water levels are greater than the common water level. 
Determine the power for all subcarriers with common or 
unique water levels. 
Details of the proposed algorithm for a channel realization 
are described as follows (Note: the following numbers do not 
correspond exactly with the numbers above.): 
1) Initialization 
(a) The following parameters are defined first: A = {1, 
2, …, N}; Ωk = φ, Ak = Bk = φ, wk = wtk = 0, wAk = wtAk = 
0, 0kw = , Pk,max, and Pk, k = 1, …, K; n = 1. 
2) while |A| ≠ 0 
for k = 1 to K 
(a) Ωk = Ωk ∪ {n}; Nk = |Ωk|. 
(b) if |Ak| = 0 
(1) Evaluate the water level with wk = wk − max{(Nk + 
1)−1(wk − 1,k nH
− ), 0}, but 1
,k k k nw P H
−
= +  when Nk = 1. 
(2) Perform the steps in Section IV.A and obtain the 
approximated water level kw′ . k kw w′= . 
(3) 1
,max ,{ | ,  }k k k k i kA i w P H i
−
= < + ∈ Ω ; k kB A= . 
(4) if n∈Ak 
(i) Find the approximated water level Akw′  with 
PAk = Pk − |Bk|Pk,max. Ak Akw w′= ; k Akw w′= . 
else 
(i) 1
,max ,k k k nw P H
−
= + . 
(c) elseif |Ak| ≠ 0 
(1) 1
, ,max( ) (| | 1); | |k Ak k n k k k ka w H A b P A
−
= − + = . 
(2) if bk ≤ ak and Pk > (|Bk|+1)Pk,max 
(i) 
tAk Akw w= ; Ak Ak kw w b= − ; 1,max ,k k k nw P H
−
= + . 
Obtain the approximated water level Akw′ . 
Ak Akw w′= ; { }k kB B n= ∪ . 
else 
(i) wtAk = wAk. wAk = wAk − max(ak, 0). Find the 
approximated water level Akw′ . Akw = Akw′ ; 
k Akw w= ; { }k kA A n= ∪ . 
(d) Ωk = Ωk \ {n}. 
,arg max ( ); { }; ;k k k n k k tk k tAk Akk w H n w w w w= Ω = Ω ∪ = = . 
Ai = Ai \ {n}, Bi = Bi \ {n} ∀i ≠ k; A = A \ {n}; n = n + 1. 
3) for k = 1 to K 
(a) 1
,max ,{ | , }k Ak k k i kA i w P H i B
∗ −
= < + ∈ ; k kB A
∗ ∗
= . 
(b) k k kA A A
∗
= ∪ .  
(c) 
, ,maxk i k kp P i B
∗
= ∀ ∈ ; ,max| |Ak k k kP P B P∗= − . 
(d) 1
,( ) | |
k
Ak Ak k i ki A
w P H A−
∈
= +∑ . 
(e) 1
, ,max( ,0) Ak i Ak k i kp w H i A
−
= − ∀ ∈ ; ,
k
Ak Ak ii A
P p
∈
=∑ . 
(f) if 0AkP ≠ , 1, , ,maxmin( , ) Ak i Ak i Ak Ak k kp p P P P i A
−
= ∀ ∈ . 
The first step of the algorithm is to initialize all the 
variables, where wk is the water level of user k and wtk is its 
temporary value; wAk is the common water level of user k and 
its temporary value is wtAk; and the water level or common 
water level is saved to kw  for assigning each subcarrier. The 
second step assigns the nth subcarrier to the user k. Step 2(b) 
calculates the water level used to categorize the subcarriers into 
sets Ak or Bk, where Bk = kA  is the complement of Ak. The 
common water level is also evaluated until Ak is not empty. 
Step 2(c) updates the common water level in Ak when Step 2(b) 
finds that Ak is not null. After all subcarriers are assigned, Step 
3 allocates the power according to the common water level. 
Steps 3(a)−(b) move the subcarriers in Bk with unique water 
levels that are greater than the common water level to Ak. The 
power of each subcarrier in kB
∗  is Pk,max; Steps 3(d)−(f) 
determine the power of the subcarriers in Ak. Because the 
common water level is not from the water-filling algorithm, 
Step 3(f) is used to satisfy the total power constraint for all SUs. 
B. Complexity Analysis 
The complexity of the proposed algorithm results mainly 
from Step 2. Steps 2(b)−(c) are used to calculate the water level 
and they are disjoint for each other, so the required additions 
and multiplications in Step 2 after all subcarriers are assigned 
are 2( )NO  because 
1 1 1
( 1) 2N K Nknn k nN n N N= = == = +∑ ∑ ∑ , 
where Nkn is the number of subcarriers for the kth SU when the 
nth subcarrier is assigned. 
The algorithm in [8] also is used to find the water level, so 
its complexity is 2( )NO  rather than ( )NKO . On the other hand, 
when the water-filling algorithm in [12] is used, the IPWF 
algorithm in Section III.B requires 
2( log )kni kniN NO  additions 
and ( )kniNO  multiplications for the ith iteration, where Nkni is 
the total number of subcarriers for the ith iteration when the nth 
subcarrier is assigned to SU k. For all SUs and subcarriers, the 
joint subcarrier and power allocation algorithm with the IPWF 
algorithm needs 
21 1
( log )N K kn knn k N N= =∑ ∑O  additions and O(N2) 
multiplications, where we assume that the number of iterations 
when the nth subcarrier is assigned to the kth SU is one (i.e., 
the lower bound of the computational complexity). 
From the above analyses, the complexity of the proposed 
algorithm is the same as that of the algorithm in [8] and less 
than that of the lower bound of the computational complexity 
of the joint subcarrier and power allocation with the IPWF 
algorithm. 
VI. SIMULATION RESULTS 
In this section, we demonstrate the proposed joint 
subcarrier and power allocation algorithm using simulation 
This full text paper was peer reviewed at the direction of IEEE Communications Society subject matter experts for publication in the IEEE ICC 2010 proceedings
Authorized licensed use limited to: National Tsing Hua University. Downloaded on July 02,2010 at 05:02:52 UTC from IEEE Xplore.  Restrictions apply. 
國科會補助計畫衍生研發成果推廣資料表
日期:2010/11/02
國科會補助計畫
計畫名稱: 行動正交分頻多工系統之前瞻基頻處理技術研究 
計畫主持人: 王晉良 
計畫編號: 96-2628-E-007-005-MY3 學門領域: 通訊
無研發成果推廣資料
其他成果 
(無法以量化表達之
成果如辦理學術活
動、獲得獎項、重要
國際合作、研究成果
國際影響力及其他協
助產業技術發展之具
體效益事項等，請以
文字敘述填列。) 
本計畫贊助三位博士班研究生赴加拿大西安大略大學 (The University of 
Western Ontario, London, Ontario)，與該校電機與電腦工程學系的 Prof. 
Xianbin Wang 進行為期三個月的研究。此一國際合作研究對這三位博士班研究
生國際視野之拓展及研究能力之提升，相當有助益。 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
