2 
 
體大小以 12 號為主。 
 
行政院國家科學委員會補助專題研究計畫 
V 成果報告   
□期中進度報告 
 
多核心嵌入式系統開發工具與軟體研發計畫-子計畫五：以 Android
為基礎之行動嵌入式系統的資安工具之設計 
 
 
計畫類別：□個別型計畫   V整合型計畫 
計畫編號：NSC 99－2220－E－008－001－ 
執行期間： 99 年 08 月 01 日至 100 年 07 月 31 日 
 
執行機構及系所：國立中央大學資訊工程系 
 
計畫主持人：許富皓 
共同主持人： 
計畫參與人員：陳立函, 左昌國, 許齊顯, 吳敏豪 
 
 
 
成果報告類型(依經費核定清單規定繳交)：□精簡報告  V完整報告 
 
本計畫除繳交成果報告外，另頇繳交以下出國心得報告： 
□赴國外出差或研習心得報告 
□赴大陸地區出差或研習心得報告 
■出席國際學術會議心得報告 
□國際合作研究計畫國外研究報告 
 
 
處理方式：除列管計畫及下列情形者外，得立即公開查詢 
附件一 
4 
 
3. 請依學術成就、技術創新、社會影響等方面，評估研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）（以
500 字為限） 
 
近年來智慧型手機的普及，加上行動裝置作業系統的漸漸統一，各式各樣的
應用程式與應用程式商城（如 Android Market、Appstore等）如雨後春筍般
發展，然而許多商城並無針對應用程式作審查，因此使用者很難分辨是否安
裝了惡意程式，此研究提供了一個測詴的帄台，讓使用者可以上傳程式，並
且測詴此程式可能為間諜程式的機會有多大。未來更可能發展為防毒軟體廠
商之雲端服務，像是提供使用者一個對應手機的模擬器，在這個雲端的模擬
器上安裝使用者安裝的軟體，藉此找出可能的間諜軟體威脅。除此之外也可
以推廣到手機製造商，讓他們手機出廠時即安裝此系統，以減少間諜軟體被
使用者安裝系統上的可能。 
 
 
國科會補助計畫衍生研發成果推廣資料表 
日期：   年  月  日 
國科會補助計畫 
計畫名稱： 
計畫主持人：         
計畫編號：             領域： 
研發成果名稱 
（中文） 
（英文） 
成果歸屬機構 
 發明人 
(創作人) 
 
技術說明 
（中文） 
 
 
 
（200-500字） 
（英文） 
附件三 
6 
 
一、參加會議經過 
1. 行程說明 
會議當天早上 08 月 29 日抵達金門，於會議結束隔天 09 月 01 日回程。但是出發當
天颱風暴風圈進入台灣上空導致於航空公司取消班次，以至於隔天 08 月 30 日才抵達金
門。The Fifth International Conference on Genetic and Evolutionary Computing (ICGEC) 是
一個針對基因計算和演化計算算領域的國際會議，討論議題相當廣泛，包括多媒體訊號
處理、資訊安全、軟體計算方法(類神經網路、模糊理論、基因演算法)、以及多媒體和
智慧型計算的應用。其領域非常的多元，大致議題如下： 
1. Genetic Computing 
- Genetic Algorithm & Programming 
- Generative and Developmental Systems 
- Genetics-Based Machine Learning and Learning Classifier Systems 
- Empirical studies of genetic programming performance and behavior 
- Hybrid architectures including genetic programming components 
2. Evolutionary Computing 
- Evolutionary Design & Application 
- Evolutionary of tree or graph structures 
- Evolutionary of various classes of automata or machine 
- Evolutionary Combinatorial & Multi-Objective Optimization 
- Evolutionary Strategies, Evolutionary Programming 
- Evolutionary Scheduling and Routing 
- Bioinformatics and Computational Biology 
3. Intelligent Computing 
- Swarm Intelligence and Optimization 
- Ant Colony Optimization and Swarm Intelligence 
- Artificial Immune Systems 
- Artificial Intelligence and Decision Support Systems 
8 
 
議程。 
第二天的議程中，ICGEC 2011 的議場，總共發表 15 篇論文，其中有關資訊隱藏的
論文，除了我所報告的論文外，還有"A New Scheme for Data Hiding on Halftone Images"、
"The First Robust Image Tamper Detection Scheme under Brightness"、"Reversible Data 
Hiding Based on VQ Compression Code"、"Hybrid Temporal Pattern Mining with Time Grain 
on Stock Index"、"Classification Method Incorporating Decision Tree with Particle Swarm 
Optimization"、"A Privacy Preserved Two-Party Equality Testing Protocol"六篇論文；其它包
括影像處理的論文"A New Scheme for Data Hiding on Halftone Images"、"The First Robust 
Image Tamper Detection Scheme under Brightness"、"Reversible Data Hiding Based on VQ 
Compression Code"；資訊安全的論文"Hybrid Temporal Pattern Mining with Time Grain on 
Stock Index"、"Classification Method Incorporating Decision Tree with Particle Swarm 
Optimization"、"A Privacy Preserved Two-Party Equality Testing Protocol"等。 
第三天的議程中，ICGEC2011 的議場是在廈門大學，議題為，包括分散式網路計算
與物聯網、計算方法的應用、智能控制與嵌入式系統、智慧型管理工程與應用等。會議
於下午結束後天色已晚，於是隔天搭船抵金門，再由金門搭機回台。 
 
二、與會心得 
這次出席 ICGEC-2011 會議，獲得下列心得： 
1. 出席會議期間，陸續發現國內也有很多學者出席，不管是在機場、飯店、或是會
場，大家互相經驗傳承和照應，非常受益。 
2. 認識一些國外學者，彼此在學術以及文化上交流，增加很多見文。外國學者，不
再是只出現在論文上的名字，而是出現在眼前。 
3. 這次發表論文，有一位上台發表的學生，被問問題時僵在那裡，不知如何回答問
題。事實上他知道答案，只是沒辦法以英文適當回答，當時有他的指導老師出面
說明此學生是第一次用英文報告，所有的問答皆由他的指老師當翻譯。事後，發
問者告知學生一些答覆技巧，我也從中學得一些經驗。 
10 
 
三、建議 
四、其他 
 
 
 
 
 
 
 
 
 
 
國科會補助專題研究計畫項下國際合作研究計畫國外研究報告 
                                     日期：   年   月   日 
                                 
一、國際合作研究過程 
計畫編號 NSC  －    －  －    －    － 
計畫名稱  
出國人員
姓名 
 
服務機構
及職稱 
 
合作國家 
 
合作機構  
出國時間 
 年 月 日至 
 年 月 日 
出國地點  
附件六 
12 
 
行政院國家科學委員會專題研究計畫成果報告 
多核心嵌入式系統開發工具與軟體研發計畫-子計畫五： 
以 Android為基礎之行動嵌入式系統的資安工具之設計 
 
計畫編號：NSC 99-2220-E-008-001- 
執行期限：99年 8月 1日至 100年 7月 31日 
主持人：許富皓 國立中央大學資訊工程研究所 
計畫參與人員：陳立函、左昌國、許齊顯、吳敏豪 
 
摘要 
行動電話的快速普及使得行動電話成為許多人不可缺少的日常用品，根據報導，台灣帄均每個人
擁有 1.59 隻行動電話，而隨著行動電話的廣泛使用，各式智慧型手機亦相繼地被發展出來以滿足使用
者更多的需求。智慧型手機結合了電話、網路和 PDA 的功能，因此可儲存更多的個人隱私資料，例如
行程、Email、GPS 地點，隨著系統功能的增強，各式的智慧型手機作業系統亦相繼地被發展出來以支
援相關的功能，Windows Phone、iOS、Android、Symbian、Tizen、WebOS、Blackberry 是其中最被廣
泛使用的作業系統，帶給人們生活方便的同時，也帶給攻擊者許多可能性，因此成為許多攻擊者的目
標，各式各樣針對這些作業系統的惡意軟體相繼出現在行動裝置上，用以偷取隱私資料、使用收費服
務、綁架裝置或是讓手機的電力快速流失等等。 
在本計畫中，我們針對 Google 公司發表的 Android 作業系統進行研究，以偵測惡意軟體可能造成
的間諜行為，防止隱私外洩。在行動通訊的時代，每個人都可以透過手機連上網路，觀看股市、使用
網路銀行、GPS 導航，在手機上保存的資料是相當隱私且有價值的，間諜軟體可以藉此監視受害者的
位置、通話內容、銀行帳號密碼，甚至利用手機的相機鏡頭即時監看畫面與環境監聽，行動裝置的安
全機制相較於個人電腦卻是相當貧乏的，就算是最新的 Android 3.2 與 iOS 5 都只能達到消極的防護，
像是利用權限列表或是繁瑣的原始碼檢查，但這些防護措施需要使用者對權限有基本瞭解或是必頇經
歷費時的檢查，因此發展有效的防禦機制便成為目前迫切且重要的議題。 
關鍵字：Android 作業系統、行動裝置、資訊安全、間諜軟體 
14 
 
1. 簡介 
隨著行動網路越來越普遍，價格也越來越親民，手機行動上網已經漸漸變成生活的一部分，
加上和雲端應用程式結合，Amazon S3(1)、Dropbox(2)這種雲端儲存服務，提供了手機先天不足的
儲存空間，Software as a Service（SaaS）(3)更讓動態網頁變成了手機上的應用程式，功能日益強
大，GPS 導航、收發 E-mail、遊戲等等特性，造成近年智慧型手機的熱賣，各大軟體公司也紛紛
推出產品應對，在作業系統方面就分別有 Microsoft 的 Windows Phone(4)、Google 的 Android(5)、
Apple 的 iOS(6)、HP 的 WebOS(7)、The Linux Foundation 的 Tizen(8)、RIM(9)的 Blackberry(10)、
QualComm 的 Brew MP(11)、Samsung 的 bada(12)和 Nokia 的 Symbian(13)，製造商則更為眾多，
如 HTC、Samsung、Apple、RIM、Sony、Motorola、LG 等等，百家爭鳴。 
Android 公司原先由 Andy Rubin 創辦，最初用於支援手機，在 2005 年 Android 公司被 Google
公司收購，並且組成了開放手機聯盟（Open Handset Alliance(14)），會員有 Google、HTC、Intel、
Motorola、QualComm、TI、Samsung、LG、T-Mobile、Nvidia 和 Wind River System 幾家國際大公
司，目的要利用開放原始碼的軟體來向封閉軟體的手機競爭，Google 在 2008 年底推出了 Android
作業系統，並在 2009 年二月釋出 Android 1.1 版，為一使用 Apache License 2.0(15)和 GPLv2(16)
的開放原始碼作業系統，以 Linux 作業系統核心為基礎，加入 middleware 和手機需要的的應用程
式，應用程式則可使用 Java(17)撰寫，Google 也提供了相對應的 Software Development Kits 給應用
程式開發者，而如同 Apple 為 iPhone 應用程式所提供的 App Store(18)，Google 也有 Android 
Market(19)，但和其他公司不同的地方在於，Google 的 Android Market 並不要求對應用程式的原始
碼作詳盡檢查，僅需要 25 美元的註冊費用，然後用申請的帳號對要發布的應用程式作簽署，即可
直接發表在 Market 上，Google 以使用者對應用程式的反應來決定該應用程式是否為惡意程式，再
予以下架，並刪除該帳號；另外在使用者端，僅僅可以透過權限列表（如圖 1）和說明來判斷應
用程式是否可能具有惡意行為，對於使用者來說相當不精確，而且就算都從 Android Market 上下
載應用程式，也可能下載到惡意軟體，在過去就曾經有惡意軟體上架的例子，Troy Vennon 的報告
(20)裡提到，在 2009 年底有一個稱為 DROID09 的間諜軟體上架 Android Market，會嘗詴偷取使用
者的銀行帳號等等隱私資料，因此就算用官方的安裝方式也不一定能避免惡意軟體。 
因此，這計畫 SPYDroid 的目標就是要以軟體的行為來判斷應用程式是否具有間諜行為，其中
16 
 
的作業系統，但是在 2010 年 2 月 3 日，因為 Google 對於 Android 的驅動程式缺乏維護和管理，又無
文件和註解說明，所以 Linux Device Driver 的核心開發者 Greg Kroah-Hartman 已經將 Android 的驅動程
式移出 Linux 核心樹，因此 Android Kernel 與 Linux Kernel 從此分開維護， 
 
表 1：Android 各版本 
版本號 開發代號 重大變更 
1.5 Cupcake 1. Linux 2.6.27 
2. 使用 Webkit 瀏覽器 
3. 支援藍牙耳機 
4. 支援螢幕虛擬鍵盤 
5. 支援 Android Market 
1.6 Donut 1. Linux 2.6.29 
2. 文字轉語音系統 
3. 手勢支援 
4. 多種螢幕解析度支援 
2.0/2.0.1/2.1 Eclair 1. 瀏覽器支援 HTML5 
2. 動態桌布應用程式 
3. UI 改良 
4. 支援 Bluetooth 2.1 
2.2/2.2.1 Froyo 1. Linux 2.6.32 
2. App-to-SD，應用程式可以安裝至 SD 卡上 
18 
 
處理進入 paused 狀態，onResume()用於由 paused 回到 active。 
 Broadcast Receiver： 
需要使用 android.content.BroadcastReceiver。用於接收 Intent，Intent 可能是某個應用程式
發出的需求，或是系統自發產生的事件，應用程式要接收某樣事件，必頇先於
AndroidManifest.xml 中宣告，如下圖 2，或是在程式中動態產生 Intent Filter，通常用於需要
Event-Driven 功能的程式。 
 
圖 2：AndroidManifest.xml 的一部分，此處為宣告 Broadcast Receiver 所要接受的事件，此例
為接收「開機完成」與「收到簡訊」兩件系統事件。 
 
 Service： 
需使用 android.app.Service。Service 本身並無介面，為一個背景執行的元件，但是可以提
供應用程式長時間執行的獨立工作，應用程式頇先呼叫 startService()來初始化 Service，再透
過 bindService()來向 Service 元件建立連結，若是呼叫 bindService()前，Service 尚未被執行，
那麼 bindService()也會先初始化 Service 元件，除此之外，Service基本上只有在呼叫 onDestroy()
的時候才會被關閉，但是若是系統處在 low memory 的情形下，Service 仍然可能被關閉。 
 Content Provider： 
需使用 android.content.ContentProvider。Content Provider 在 Android 中是個非常重要的介
面，它提供了資料庫的功能，而且 Content Provider 可以和其他應用程式分享，Content Provider
實際上是以 SQLite 資料庫(21)的方式存在磁碟當中，可以透過 Content Resolver 來存取，有著
類似 SQL 的存取介面，可以使用 query()、insert()、update()、delete()等方法，Content Observer
則是一個 callback 函式，在系統中註冊之後，一旦受到觀察的 Content Provider 有改變，就會
20 
 
 
圖 3：AndroidManifest.xml 的一部分，此圖所顯示部分為使用權限列表，此例由上往下為：「相機」、
「震動」、「大略位置」、「精確 GPS 位置」、「讀取電話狀態」、「網際網路」、「收簡訊」、「錄音」、「修
改音效設定」、「讀取聯絡人」、「寫入聯絡人資訊」、「寫入外部儲存媒體」 
 
 Android 應用程式基本上是跑在 Android 做的 Java 虛擬機器，但是不是 Oracle 的 JVM，而是 Android
本身開發的 Dalvik 虛擬機器（DVM），DVM 雖然也是 Java 的虛擬機器，但是與 JVM 有著相當的差距，
JVM 是一個 Stack-based 的虛擬機器，裡面所有 method（方法）都是以 Stack 中的位址來處理，且有著
跨帄台的特性，但DVM的特色是使用Register-based，method中的參數都是暫存器，處理速度高過 JVM，
而且針對 ARM 帄台優化，性能更好，這也引起來許多人將 DVM 移植到其他帄台上，以增加 Java 的
執行效率。 
2.2 程式行為偵測 
過去到現在最常使用於偵測惡意軟體的方式就是以程式行為判斷，但是這部份的研究大多過時，
討論的仍是過去較為常用的藍牙傳播方式(22, 23)，綜合惡意程式常見的行為，來偵測程式的行為是否
為惡意，像是統計惡意軟體向外傳送的次數等等，過去最著名的例子就是 Symbian 上的 Commwarrior
和 Cabir，這兩個惡意軟體都會透過藍牙向外傳播，此種惡意程式曾經大量散佈，原因是 Symbian 手機
當年預設開啟藍牙功能，因此惡意軟體就透過藍牙這個管道傳播。但此類的行為偵測法受限於藍牙傳
檔這種現今較少使用的途徑，必頇要更改部份的程式行為圖，所以 SPYDroid 使用網路當作間諜軟體嘗
詴向外傳送資料的判斷方式，加上手機特有的簡訊、通話紀錄、通話錄音、GPS 座標，符合越多行為
特徵的就越可能是間諜軟體，而且 Android 本身的 Sandbox 機制可以減少其他惡意軟體的影響，沒有
root 權限的惡意程式很難對整個系統有巨大的影響，因此我們特意專注於間諜軟體行為的研究，更可
22 
 
威脅分析做出惡意行為所需的權限組合。Kirin(29)便是其中代表，Kirin 利用威脅分析定義惡意的權限
集合，只要軟體安裝的時候宣告和惡意權限集合中的元素相同就會拒絕該軟體安裝，這樣的方法可以
避免掉許多惡意程式，而且達到手機需要的輕量級設計，但是卻造成許多誤判，可能把許多功能強大
的正常程式當作是惡意程式，權限列表方法在這種情形就非常難以論斷；而且有許多的程式作者，可
能會引入多餘的權限，實際上程式並未用到此功能，這樣的情況就更可能誤判。 
 
3. 結果與討論 
本年度中，我們研究了 Android 系統的細部架實驗，並嘗詴加入部份惡意行為的偵測（如：SMS
竊取），再使用一些自製的間諜軟體來作測詴，下面幾節將敘述研究成果。 
3.1 Android 系統架構 
Android 系統架構分為好幾層，Applications、Application Framework、Libraries/Android Runtime、
Linux Kernel，如圖 4 所示。大部分的應用軟體行為都侷限在 Applications 層，但在 Android 1.5 版之後
提供了Native Developer Kits，讓軟體開發者可以用C語言撰寫Native Library給Android應用程式使用，
加快應用軟體移植速度，但大部份惡意軟體能達到的行為都必頇依靠 Applications 層的 Java 來完成。 
除此之外，Android 也提供了許多服務讓 Application 使用，例如用 ActivityMangerService 來管理
Activity 的使用、PackageManagerService 負責管理應用程式的安裝和移除等等。 
Android的應用程式主要分為四個部份，每個應用程式都必需要有這四個部份之一，分別是：Activity、
Content Provider、Broadcast Receiver、Service。Activity 是負責和使用者互動的 User Interface，同時只
會有一個 Activity 在 Active 的狀態；Content Provider 則是一 SQLite 的資料庫，可以利用 ContentObserver
來觀察資料庫內是否有改變，並做相對應的工作；Broadcast Receiver 可以監聽系統或應用程式的廣播，
可用於達成Event-Driven的功用，甚至可以達成開機自動執行，讓惡意程式每次都常駐在系統內；Service
則是在背景執行的程式，可以動態使用 Intent 啟動。 
上面所提到的 Intent 則是 Android 一個非常特殊的設計，Intent 可以當作廣播訊息使用，也可以攜
帶資料在 Process 間傳送，是一種 Inter-process Communication 方式，例如 Phone State 改變、收到
24 
 
 使用錄音裝置 
 連上網路 
3.3 SPYDroid 間諜行為偵測 
我們修改 Android 的 Application Framework 和 Android 原生的 Services，對 Android 發送廣播的地
方觀察，並自製一個 Android Kernel Module，以這個 Kernel Module 儲存與判斷各應用程式為間諜軟體
的可疑程度，由 3.2 所討論的威脅分析，預先訂出可能的間諜軟體行為圖，如圖 5。 
 
 
 
 
 
間諜軟體對於個人隱私最有興趣的部份不外乎簡訊、通話紀錄、GPS 位置與通話錄音，目前計畫
的目標是要監視這四種資訊是否被軟體竊取，一旦被竊取之後，會先在 Kernel Module 裡面紀錄行為，
越多間諜行為特徵的應用程式被判斷為間諜軟體的機會越大，一旦應用程式嘗詴將資料向外送出，
SPYDroid 程式會在 Kernel 中將連線攔截，並阻止其向外送出，再通報使用者，如圖 6。 
以 Event-Driven SMS Logging 的間諜軟體為例，間諜軟體會利用 Broadcast Receiver 來監聽系統事
Socket Send 
Read 
SMS 
Read 
Call 
Log 
GPS 
Track 
Read 
Phone 
State 
Record 
Voice 
Call 
圖 5：間諜軟體行為圖 
26 
 
 
圖 7：sys_write、sys_sendmsg、sys_send 系統呼叫流程 
 
3.4 SPYDroid 應用程式 
由於並非每支手機都可以重新安裝更改過後的 SPYDroid，而且 SPYDroid 也無法針對每支手機製
造特製的 Android 系統，因此我們退而求其次，也開發了 SPYDroid 的應用程式，結合雲端服務，達成
可接受的間諜程式分析。 
SPYDroid 應用程式是提供一個介面，使用者介面如圖 8、圖 9、圖 10，列出手機上安裝的所有程
式與其使用的權限，讓使用者選擇可能有問題的程式，SPYDroid 就會把使用者選擇的程式傳到雲端伺
服器上，並啟動一個間諜程式分析用的模擬器，利用先前提到的方式，偵測是否為惡意的間諜程式，
如圖 11 所示。 
28 
 
 
圖 10：SPYDroid 應用程式：權限列表與分析按鍵 
 
 
 
 
 
Cloud Emulator Server 
Result Database 
Upload 
Check Result 
Cloud 
圖 11：SPYDroid 應用程式與雲端架構圖 
30 
 
4.2 PAC Duo 移植 
PAC Duo為工研院晶片中心開發之異質多核心處理器，圖 12為 PAC Duo執行Android 1.6的情形，
系統展示架構則於圖 13，由於 PAC Duo 並無 3G 與 GSM 模組，因此我們透過乙太網路將 PAC Duo 連
接至間諜程式模擬器的伺服器上。 
 
圖 12：PAC Duo 執行 Android 1.6 之畫面 
32 
 
 
圖 14：SPYDroid on PAC Duo 的起始畫面 
 
圖 15：SPYDroid on PAC Duo：應用程式列表 
34 
 
 
圖 18：雲端間諜程式模擬器 
 
5. 結論 
我們已經有關於 Linux 作業系統安全的研究論文發表在 JISE(31)與 JSAC(32)，在這幾年的研究裡，
我們針對在手機上可能的間諜程式行為做研究，並嘗詴將偵測機制實做於 Android 作業系統上，也對
Android 作業系統的細部設計和架構更為理解，並結合雲端系統，使之更適合於智慧型手機使用且更為
完整，並可能應用於手機 Honeypot 的實做。我們相信本研究的成果與經驗對於日後的行動資安研究有
著許多助益。 
 
6. Reference 
1. Amazon. Amazon Simple Storage Service (Amazon S3). Available from: http://aws.amazon.com/s3/. 
2. Dropbox. Dropbox - Simplify your life. Available from: http://www.dropbox.com/. 
3. Wikipedia. Software as a service. Available from: http://en.wikipedia.org/wiki/Software_as_a_service. 
4. Microsoft. Mobile Phones | Choose the Best Phone for You | Windows Mobile. Available from: 
36 
 
Control-Hijacking Buffer Overflow Attacks 
JOURNAL OF INFORMATION SCIENCE AND ENGINEERING. 2011;27(3):869-90. 
32. Hsu F-H, Tso C-K, Yeh Y-C, Wang W-J, Chen L-H. BrowserGuard: A Behavior-based Solution to 
Drive-by-Download Attacks. IEEE Journal on Selected Areas in Communications. 2011;29(7):1461-8. 
 
 
2. Evolutionary Computing 
- Evolutionary Design & Application 
- Evolutionary of tree or graph structures 
- Evolutionary of various classes of automata or machine 
- Evolutionary Combinatorial & Multi-Objective Optimization 
- Evolutionary Strategies, Evolutionary Programming 
- Evolutionary Scheduling and Routing 
- Bioinformatics and Computational Biology 
3. Intelligent Computing 
- Swarm Intelligence and Optimization 
- Ant Colony Optimization and Swarm Intelligence 
- Artificial Immune Systems 
- Artificial Intelligence and Decision Support Systems 
- Intelligent Information Fusion and Data Mining 
- Intelligent Database Systems 
- Knowledge Discovery and Management 
- Neural Networks and its Applications 
- Pattern Recognition and Self-Adaptation Techniques 
- Intelligent Computer Vision & Scientific Visualization 
4. Grid Computing 
- Grid Resource Management and Task Schedule 
- Grid Trust and Security 
- Distributed and Parallel Computing 
- Distributed Intelligent Processing 
- Peer-to-Peer Architecture 
 
此會議 ICGEC 2011 於 08 月 29 到 09 月 01 日於台灣金門的金門大學與大陸廈門的廈
門大學，計有 106 篇論文在本次會議中發表，共分 3~6 個議場同時舉行，ICGEC 2011 兩
 二、 與會心得 
這次出席 ICGEC-2011 會議，獲得下列心得： 
1. 出席會議期間，陸續發現國內也有很多學者出席，不管是在機場、飯店、或是會場，
大家互相經驗傳承和照應，非常受益。 
2. 認識一些國外學者，彼此在學術以及文化上交流，增加很多見文。外國學者，不再是
只出現在論文上的名字，而是出現在眼前。 
3. 這次發表論文，有一位上台發表的學生，被問問題時僵在那裡，不知如何回答問題。
事實上他知道答案，只是沒辦法以英文適當回答，當時有他的指導老師出面說明此學
生是第一次用英文報告，所有的問答皆由他的指老師當翻譯。事後，發問者告知學生
一些答覆技巧，我也從中學得一些經驗。 
4. 這次研討會，由楊政興教授和李金鳳教授細心安排，住宿和交通問題，都被妥善處理。
所以，國內一些熱情和經驗豐富的學者，會提攜和照顧後學，非常值得肯定。 
 
三、 其他(攜回資料項目) 
ICGEC 2011 會議論文集。 
 
四、 論文全文 
另附 (PDF format)。 
 
 
 
 
 
 
  
 
 
 
Paper ID.: ICGEC-2011-IS03-01 
Paper Title: Comments on a Secret-key-privacy-preserving Authentication 
and Key Agreement Scheme 
Author(s): Ya-Fen Chang, Jhih-Yi Lin, and Yuo-Ju Yen 
Paper ID.: ICGEC-2011-IS03-02 
Paper Title: A Novel Cluster-based Difference Expansion Transform for 
Lossless Data Hiding 
Author(s): Yuan-Yu Tsai and Chi-Shiang Chan 
Paper ID.: ICGEC-2011-IS03-03 
Paper Title: Intelligent Projector System based on Computer Vision 
Author(s): Chih-Yang Lin, Wei-Wen Chang, and Yi-Hui Chen 
Paper ID.: ICGEC-2011-IS03-04 
Paper Title: An Efficient V-Fairness (t, n) Threshold Secret Sharing 
Scheme 
Author(s): Jen-Ho Yang, Chin-Chen Chang, and Chih-Hung Wang 
Paper ID.: ICGEC-2011-IS03-05 
Paper Title: Detection System of Smoking Behavior based on Face 
Analysis 
Author(s): Wen-Chuan Wu and Chun-Yang Chen 
Paper ID.: ICGEC-2011-IS03-06 
Paper Title: Quantization- and Prediction-Based Image Authentication 
and Recovery 
Author(s): Wen-Chuan Wu and Yi-Pei Hsieh 
Paper ID.: ICGEC-2011-IS03-07 
Paper Title: A Verifiable Visual Cryptography Scheme 
Author(s): Yi-Hui Chen, Ci-Wei Lan and Chiao-Chih Huang 
Paper ID.: ICGEC-2011-IS05-01 
Paper Title: Bus Assisted Connectionless Routing Protocol for 
Metropolitan VANET 
Author(s): Wei Kuang Lai, Kai-Ting Yang, and Meng-Chong Li 
Paper ID.: ICGEC-2011-IS05-02 
Paper Title: A Study of E-document Access Control Techniques in Clouds 
Author(s): C. W. Tseng, F. J. Liu, and S. H. Huang 
Paper ID.: ICGEC-2011-IS05-03 
Paper Title: The Role of Experience in Using Channel in Enhancing 
Knowledge Transfer 
Author(s): Chiou-Mei Chen 
Paper ID.: ICGEC-2011-IS05-04 
Paper Title: A TDMA Medium Access Control Mechanism for IEEE 
802.11-based Wireless Networks 
Author(s): Guan-Hsiung Liaw and Yen-Tung Yeh 
Paper ID.: ICGEC-2011-IS05-05 
Paper Title: Load-balance Directed Diffusion in Wireless Sensor Networks 
Author(s): Wei Kuang Lai, Yuh-Chung Lin, Tsung-Han Chen, and 
Chin-Shiuh Shieh 
Paper ID.: ICGEC-2011-IS06-01 
Paper Title: Access Security on Cloud Computing Implemented in Hadoop 
System 
Author(s): Bao Rong Chang, Hsiu-Fen Tsai, Zih-Yao Lin, and Chi-Ming 
Chen 
Paper ID.: ICGEC-2011-IS06-01 
Paper Title: Access Security on Cloud Computing Implemented in Hadoop 
System 
Author(s): Bao Rong Chang, Hsiu-Fen Tsai, His-Chung Huang, and 
Chi-Ming Chen 
Paper ID.: ICGEC-2011-IS06-02 
Paper Title: The Estimation of Mixture Customer Interpurchase Length 
Author(s): Hui-Hsin Hunag 
Paper ID.: ICGEC-2011-IS06-03 
Paper Title: The Optimal Order and Payment Policies with Discount Cash 
Paper ID.: ICGEC-2011-IS11-01 
Paper Title: A Novel Cooperation Mechanism to Enforce Security in 
Wireless Sensor Networks 
Author(s): Fengyun Li, Guiran Chang, Fuxiang Gao, and Lan Yao 
Paper ID.: ICGEC-2011-IS11-02 
Paper Title: A Hybrid Algorithm to Select Optimal Path for Traveler Issue 
Author(s): Xiaofeng Chen 
 
Paper ID.: ICGEC-2011-IS12-01 
Paper Title: Construct an Online Contest Game-Based Learning System 
for Junior High School Students 
Author(s): Yuh-Ming Cheng 
Paper ID.: ICGEC-2011-IS12-02 
Paper Title: Object-based Error Concealment in 3D Video 
Author(s): Chuen-Ching Wang and Chien-Shiang Hong 
Paper ID.: ICGEC-2011-IS12-03 
Paper Title: Security on the Design of RFID Access Control Protocol using 
the Strategy of Indefinite-index and Challenge-response 
Author(s): Bae-Ling Chen, Wen Chung Kuo, and Lih-Chyau Wuu 
Paper ID.: ICGEC-2011-IS12-04 
Paper Title: The Implementation of Real-time On-line Vehicle Diagnostics 
and Early Fault Estimation System 
Author(s): Shi-Huang Chen, Jhing-Fa Wang, YuRu Wei, John Shang, and 
Shao-Yu Kao 
Paper ID.: ICGEC-2011-IS12-05 
Paper Title: A Fast Shape Context Matching Using Indexing 
Author(s): Chien-Chou Lin and Chun-Ting Chang 
Paper ID: ICGEC-2011-IS14-01 
Paper Title: Research on Architecture, Cross-layer MAC Protocol for 
Wireless Sensor Networks 
Author(s): Lizhong Jin, Jie Jia, Dong Chen, Fengyun Li, Zhicao Dong, and 
Xue Feng 
Paper ID: ICGEC-2011-IS14-02 
Paper Title: A Load Balanced Routing Protocol Based on Ant Colony 
Representation 
Author(s): Chun-Wei Chiu, Hung-Yu Wang, Hsieh-Wei Lee, and 
Yuan-Long Jeang  
Paper ID.: ICGEC-2011-IS17-01 
Paper Title: An Asymmetry Printed WLAN/WiMAX Dipole Antenna 
Author(s): Churng-Jou Tsai, Wei-Chih Chen, Chia-Hsun Lin, Jinn-Kwei 
Guo, and Chun-Lin Lu 
Paper ID.: ICGEC-2011-IS17-02 
Paper Title: The Feedback for User-centered Design from Consumer’s 
Perception of the Smart Kitchen – Using the Method of Focus Group 
Interview 
Author(s): Shu-Mei Chen, Shwuhuey Wang, Tzai-Zang Lee, I-Chien Lin, 
and Chun-Lin Lu 
Paper ID.: ICGEC-2011-IS17-03 
Paper Title: Design and Implementation of the Microcontroller Control 
System for Vertical-garden Applications 
Author(s): Tzu-Ching Chia and Chun-Lin Lu 
Paper ID.: ICGEC-2011-IS17-04 
Paper Title: A Study on the Technology Acceptance for Older Adults – A 
Case Study on Chiayi, Tainan, and Kaohsiung Area 
Author(s): Chau-Yau Chen, Shu-Mei Chen, Po-Wen Huang, and Jia-Hua Li 
Paper ID.: ICGEC-2011-IS17-05 
Paper Title: The Daily Activity Analysis of Patient with Cardiovascular 
Diseases at Home 
Author(s): Chun-Han Yang, Kuo-Sheng Cheng, Jue-Long Wang, and 
Ko-Long Lin 
Paper ID.: ICGEC-2011-IS18-01 
Paper Title: Evaluation of Intrusion Detection System Based on Evaluation 
Model 
Author(s): Xianghui Zhou, Wei Wan, and Hengqing Tong 
Paper ID.: ICGEC-2011-IS18-02 
Paper Title: A Multi-objective Evolution Algorithm Based Oil Field 
Stimulation Measure Programming 
Author(s): Hanyun Wen 
Paper ID.: ICGEC-2011-IS19-05 
Paper Title: Evacuation Model based on Ellipse Sound Wave Diffusion 
Author(s): Yanrong Cui 
Paper ID.: ICGEC-2011-IS19-06 
Paper Title: Design of Remote Video Monitoring System based on 
Arm-Linux Platform and HTTP Protocol 
Author(s): Jie Hu, Kai Wang, and Shengchao Wang  
 
Paper ID.: ICGEC-2011-IS19-07 
Paper Title: Evalutionary Interval Fingerprint for Wireless Network 
Kuo-Kun Tseng, Wei Wei, Jeng-Shyang Pan, Chih-Yu Hsu, Shuo-Tsung 
Chen and LingLing Tang  
 
Paper ID.: ICGEC-2011-IS19-08 
Paper Title: Design on Wireless Access Control System based on 
Electrocardiogram 
Author(s): FuFu Zeng, Kuo-Kun Tseng, Ming Zhao,Jeng-Shyang Pan, 
Huang-Nan Huang, Chih-Yu Hsu, and Shuo-Tsung Chen  
Paper ID.: ICGEC-2011-IS20-01 
Paper Title: A Mobile Phone Base Sensory Integration Training Software 
Author(s): Wen-Pinn Fang and Shun-Yi Pen 
Paper ID.: ICGEC-2011-IS20-02 
Paper Title: An Efficient Message Notification System Using Geographic 
Coordinate 
Author(s): Jen-Chu Liu and Kuo-Yu Chuang 
Paper ID.: ICGEC-2011-IS20-03 
Paper Title: A Preoperative 3D Computer-aided Diagnosis System for 
Lung Tumor 
Author(s): You-Wei Wang and Chii-Jen Chen 
Paper ID.: ICGEC-2011-IS20-04 
Paper Title: Enhance Core-based Tree Multicast by Relocation 
Author(s): Nai-Bin Hsu 
Paper ID.: ICGEC-2011-IS20-05 
Home-Care System Design with Video and Physiological Monitoring 
Machineries 
Author(s): Yen-Lin Chen, Chuan-Yen Chiang, Chao-Wei Yu, and 
Shyan-Ming Yuan 
Paper ID.: ICGEC-2011-IS22-05 
Paper Title: An Efficient Clustering Strategy for Wireless Sensor Networks 
Author(s): Jong-Shin Chen and Zong-Yi Lyu 
Paper ID.: ICGEC-2011-IS23-01 
Paper Title: The Design and Evaluation of GPU based Memory Database 
Author(s): Chia-Feng Lin and Shyan-Ming Yuan  
Paper ID.: ICGEC-2011-IS23-02 
Paper Title: Speeding up Subquadratic Finite Field Multiplier Over GF(2m) 
Generated by Trinomials using Toeplitz Matrix-vector with Inner Product 
Formula 
Author(s): Chiou-Yng Lee 
Paper ID.: ICGEC-2011-IS23-03 
Paper Title: Novel Mastrovito Multiplier Over GF(2m) using Trinomial 
Author(s): Che Wun Chiou, Chi Ting Ma, Jim-Min Lin, and Chiou-Yng Lee 
Paper ID.: ICGEC-2011-IS23-04 
Paper Title: A Framework for the RFID Information Security and Privacy 
Protection 
Author(s): Chih-yung Chen 
 
Paper ID.: ICGEC-2011-IS23-05 
Paper Title: Event Mining and Indexing in Basketball Video 
Author(s): Lawrence Y. Deng  
 
 
 
Reversible Watermarking Scheme with Visibility Using Randomize Distance 
 
Min-Hao Wu 
Department of Computer 
Science and Information 
Engineering 
National Central 
University 
Jhongli 320, Taiwan 
mhwu@csie.ncu.edu.tw  
 
Fu-Hau Hsu 
Department of Computer 
Science and Information 
Engineering 
National Central 
University 
Jhongli 320, Taiwan 
hsufh@csie.ncu.edu.tw 
 
Cheng-Hsing Yang 
Department of Computer 
Science 
National Pingtung 
University of Education 
Pingtung 900, Taiwan 
chyang@mail.npue.edu.t
w 
 
Shiuh-Jeng Wang 
Department of 
Information Management 
Central Police University 
Taoyuan 333, Taiwan 
sjwang@mail.cpu.edu.tw 
 
Abstract—Digital watermarking is widely used to protect 
the copyright of digital media. The watermarking 
approach is usually to embed a copyright mark into the 
target media to claim the ownership. Any ownership 
dispute can be judged by detecting the existence of the 
copyright mark. In the paper, we propose a reversible 
visible watermark method, which embeds binary-imaged 
watermark into gray-scale images to create a visible 
watermark. Not using complex calculations, this paper 
tries to simply change the pixel value to achieve the 
digital watermark. Besides, a reversible steganographic 
method is used to embed the watermark information into 
the watermarked images. The watermark information 
can be used to recover the original images.  
Keywords- Lossless Data Hiding, Reversible Data 
Hiding, Watermarking, Steganography, Copyright 
Protection. 
I.  Introduction 
The popularity of the Internet offers 
great convenience in transmitting large 
amounts of data via network. With the rapid 
development of network technologies and 
coming of the digital era, the Internet has 
become indispensable for many people. By 
the development of the Internet, a lot of new 
businesses are developed, such as 
e-commerce, e-learning, online games, and 
video-on-demand etc. Many enterprises have 
expanded their traditional business activities 
in the Internet. How to protect multi-media 
transmitted through the Internet is an 
important issue. Information hiding is one of 
solutions to this problem. Many approaches to 
information hiding have been proposed for 
different attributes, such as capacity, 
imperceptibility, undetectable, robustness, 
and reversibility. These attributes are used for 
various applications, such as secret 
communication, copyright protection, 
tampering detection, and other 
human-centered approaches. 
Recently, lossless or reversible data 
hiding has drawn many researchers’ attention. 
Reversibility allows original media to be 
completely recovered from stego-media after 
the embedded message is extracted. Many 
reversible data hiding approaches have been 
proposed [1-15]. According to where the data 
are embedded, these approaches can be 
classified into three categories: the spatial 
domain [1-10], the frequency domain [11], 
and other compression types, such as vector 
quantization (VQ) [12-15]. In those 
developed reversible data hiding methods, 
two main technologies have been widely 
applied: the difference-expansion-based 
technology [1-4] and the histogram-based 
technology [5-10]. For the histogram-based 
technology, in 2006, Ni et al. presented a 
reversible data hiding method based on the 
histogram [5]. Their method guarantees that 
the change of each pixel in the stego-image 
remains within ±1. Therefore, the PSNR 
value of the stego-image is at least 48 dB. 
However, their method used the pixel values 
in the original image to create the histogram. 
The peak points of the histogram are not high 
enough. Some methods used the predictive 
concepts to increase the peak height [6-10]. 
For example, the difference value between a 
pair of adjacent pixels has a high probability 
close to zero. Therefore, transforming the 
 20 
watermarked image X’’. The detailed embedding 
algorithm is as follows: 
Input: Original image X, binary watermark W, random 
seed K, maximum random value MR, and distance D. 
Output: Reversible watermarked image X
’’
. 
Step 1: Use random seed K to create an initial random 
number R,  
Step 2: Read the pixel value w(i, j) of digital watermark 
W. Let x(k, l) be the pixel which watermark bit 
w(i, j) will be embedded into. If w(i, j) = 1, 
preserve the original pixel x(k, l), i.e. x’(k, l) = 
x(k, l); if w(i, j) = 0, do the following 
instructions: 
{
,   ,(  ) ,( RDl kxlkx'
Rb  R  R


 )
 (1) 
where Rb is a new random value of {-1, 0, 1} 
each time such that R falls into [0, MR]. 
Step 3: If x’(k, l) > 255 – (D + MR) 
If x’(k, l) > 255 
x’(k, l) = x’(k, l) – (D + MR) 
Overflow-flag string F = F || 1 
Else 
Overflow-flag string F = F || 0 
End if 
End if 
Step 4: For W, F, and the beginning coordinate C of 
embedding, use a reversible steganographic 
method to embed them into the image X’ to 
construct image X’’. 
Step 5: Output image X’’. 
In the algorithm, distance D is used to control the 
depth or the visibility of the watermark. The random 
number R in  [0, MR] is for security. R is changed by a 
value Rb in Eq. (1). Rb values are small such that the 
difference between the watermark depths of two 
neighbor pixels is small. Binary string F is used to 
record the overflow conditions. A watermarked pixel 
x’(k, l) is overflow if x’(k, l) is larger than 255. If x’(k, l) 
is overflow, the pixel value is adjusted to x’(k, l) – (D + 
MR), where 255 – (D + MR) < x’(k, l) – (D + MR) < 
255. A bit of F is used to record whether x’(k, l) is 
overflow or not when x’(k, l) > 255 – (D + MR). 
 
Fig. 2. The flowchart of our embedding algorithm. 
 
B. Watermark removing and image reconstructing 
Fig. 3 shows the flowchart of our watermark 
removing algorithm. In Stage 1, the embedded 
information in image X
’’
 is extracted and image X’’ is 
recovered into image X’. Then, in Stage 2, the extracted 
information is used to recover image X from image X’. 
The detailed algorithm is as follows. 
Input: Image X’’, random seed K, maximum random 
value MR, and distance D. 
Output: Original image X and Watermark W. 
Step 1: Use random seed K to create a random number 
R, where 0 ≤ R ≤ MR. 
Step 2: Use the reversible steganographic method to 
extract digital watermark W, F, and the 
beginning coordinate C and recover image X’ 
from the image X’’. 
Step 3: Remove each watermark bit w(i, j) from image 
X’ to get image X as follows: 
Let x’(k, l) be the pixel which watermark bit 
w(i, j) has been embedded into. 
If w(i, j) = 1 
If x’(k, l) > 255 – (D + MR) 
Remove a bit b from the beginning of F. 
If b = 1 
x’(k, l) = x’(k, l) + (D + MR) 
End if 
End if 
x(k, l) = x’(k, l) – D – R 
R = R + Rb 
Else 
x(k, l) = x’(k, l) 
End if 
Step 4: Output watermark W and original image X. 
 22 
Distance D is used to control the depth or the 
visibility of the watermark. A larger D value will mark 
the watermark more distinct. Especially, embedding 
the watermark into a high frequency region needs a 
large D value for the visibility. Fig. 7 shows the 
watermarked images with different D values and a 
fixed MR value. The MR value can influence the 
security. Fig. 8 shows the attacked results for different 
MR values under the condition that only the random 
seed K is unknown to the attacker. A larger MR value 
will have a better security. 
 
  
(a) (b) 
Fig. 7. Watermarked images: (a) D = 48, MR = 16; (b) 
D = 24, MR = 16 
 
  
(a) (b) 
Fig. 8. Watermarked images: (a) MR = 36; (b) MR = 24 
V. Conclusions 
In this paper, a new visible watermarking 
technology is proposed to embed binary watermark 
images into gray-scale images. The embedding method 
is to simply increase (or decrease) a random value on a 
pixel. Parameters D and MR are used for visibility and 
security, respectively. In addition, embedding the 
information about the watermark into the watermarked 
image by a reversible steganographic method can 
successfully recover the original image. The image 
quality of the reversible watermarked image is similar 
to the watermarked image. Experimental results show 
that our method can clearly display a watermark and 
can completely recover the cover image. 
ACKNOWLEDGEMENT 
This research was partially supported by the 
National Science Council of the Republic of China 
under the Grants NSC 99-2221-E-153-003.  
References 
[1] J. Tian, “Reversible data embedding using a difference 
expansion,” Circuits and Systems for Video Technology, 
IEEE Transactions on, vol. 13, no. 8, pp. 890-896, 2003. 
[2] H. J. Kim, V. Sachnev, Y. Q. Shi et al., “A novel difference 
expansion transform for reversible data embedding,” 
Information Forensics and Security, IEEE Transactions on, 
vol. 3, no. 3, pp. 456-465, 2008. 
[3] D. M. Thodi, and J. J. Rodriguez, “Expansion embedding 
techniques for reversible watermarking,” Image Processing, 
IEEE Transactions on, vol. 16, no. 3, pp. 721-730, 2007. 
[4] A. M. Alattar, “Reversible watermark using the difference 
expansion of a generalized integer transform,” Image 
Processing, IEEE Transactions on, vol. 13, no. 8, pp. 
1147-1156, 2004. 
[5] Z. Ni, Y. Q. Shi, N. Ansari et al., “Reversible data hiding,” 
Circuits and Systems for Video Technology, IEEE 
Transactions on, vol. 16, no. 3, pp. 354-362, 2006. 
[6] Y. C. Li, C. M. Yeh, and C. C. Chang, “Data hiding based on 
the similarity between neighboring pixels with reversibility,” 
Digital Signal Processing, vol. 20, no. 4, pp. 1116-1128, 2010. 
Images 
Watermark 
sizes 
D MR 
PSNR 
X’ to X X’’ to X’ X’’ to X 
Lena 
64×128 
16 16 41.90 49.51 41.10 
24 
16 39.47 49.52 38.97 
24 38.33 49.51 37.92 
128×128 
16 16 38.91 49.51 38.44 
24 
16 36.48 49.51 36.17 
24 35.20 49.50 35.07 
Baboon 
64×128 
16 16 41.90 48.50 40.94 
24 
16 39.47 48.50 38.87 
24 38.33 48.49 37.85 
128×128 
16 16 38.91 48.49 38.35 
24 
16 36.48 48.49 36.12 
24 35.31 48.49 35.02 
 
國科會補助計畫衍生研發成果推廣資料表
日期:2011/10/25
國科會補助計畫
計畫名稱: 子計畫四:以Android為基礎之行動嵌入式系統的資安工具之設計(2/2)
計畫主持人: 許富皓
計畫編號: 99-2220-E-008-001- 學門領域: 自由軟體暨嵌入式系統
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
九十八年度國科會自由軟體暨嵌入式系統計畫榮獲群體計畫績優團隊
(9/1/2011 頒獎).  
 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
