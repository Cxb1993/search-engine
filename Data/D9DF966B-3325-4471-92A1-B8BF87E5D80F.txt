中文摘要
電腦鑑識科學為用來判定電子犯罪常使用的利器，然而，卻有著缺乏資料及可靠度
不足時，就無法有效使用的缺憾。而電腦鑑識所蒐集與分析的數位證據必須具備兩種要
件才可能在審判時所接受，一為所蒐集的證據必須是原始的，無人為介入產生或偽造的
可能；二為分析前後的數位證據與原始證據前後一致。本研究即是基於電腦鑑識之前提
下提供一個可靠的遠端 log 及時監測蒐集機制，將可提高所蒐集之 log 資訊的可靠度及
代表性，提供後續電腦鑑識分析上原始資料的可靠度，做到資料即可代表原始環境之特
性，以提供法院作為呈堂證據，並透過 SOC 之架構，可以達成蒐集廣範圍之 log 資訊，
將可簡易整合在企業組織之 SOC 架構，建構一個完整的企業安全防範體制，確保企業
資訊安全。
關鍵詞：電腦鑑識、SOC、Log、數位證據。
ABSTRACT
The science of computer forensics is often used to judge computer crime. However, if
the evidences are lack of reliability, these digital evidences will not be accepted by the court.
Therefore, Digital evidence must satisfy two cyber forensics requirements in order to be valid
in the court. First of all, evidence acquired must be original; avoid any human intervention
or fabrication. Secondly, the evidence should be coherent with its analyzed output.
This research proposes an advanced mechanism which enables remote log monitoring
and real-time evidence acquisition while ensuring data reliability, integrity and validity. This
mechanism can be integrated into SOC framework to further guarantee enterprise security
system.
Keywords: computer forensics, SOC, Log, digital evidences
1. 前言
目前網路安全的防護措施或系統，隨著犯罪手法的不斷翻新也持續地在改進，這儼
然已經變成了彼此雙方的攻防角力戰，面對如潮水般的網路攻擊，防守一方稍一疏忽，
可能就會造成無法挽回的後果。而防護系統需能夠有效地蒐集及監測這些網路資訊，若
有異常發生時，能夠即時地回報警訊並且採取相對應的應變措施。但要防堵所有的攻擊
做到滴水不漏，其實是非常困難的。也因此電腦鑑識學（Computer Forensics or Cyber
Forensics）也因運而生。
電腦鑑識學是近年來新興的一項研究領域，目的在於從電子媒體尋找入侵攻擊之證
據，作為法律定罪上的證據，其分為現場蒐證及實驗室分析兩步驟，因此，所蒐集到之
資訊，必須要絕對可以代表犯罪方之行為，否則所蒐集之證物將功虧一簣，然而，電子
資訊有著容易攜帶及修改之特性，因此如何有效取得最具代表性之資料，則是此一領域
裡蒐集資料的重點之一。雖有電腦鑑識科學輔助，從歷史資料及各案例中卻突顯出一個
事實，即是使用者端的歷史資料早已遭受破壞，甚至是沒有完整設定，造成所能使用的
資訊過少，無法進行分析，喪失定罪的最佳證據，這都是在鑑識上所遭遇的困難。
使用金鑰的單向雜湊函數又稱為訊息鑑別碼（Message Authentication Code，MAC）
[2]。MAC和一般的單向雜湊函數有許多相同的特性，但是卻多了一項鑑別金鑰的機制；
換句話說，只有擁有鑑別金鑰的人才人對MAC進行核驗。而這種植基於密碼理論雜湊函
數的MAC即稱作HMAC。
MAC通常用於不同使用者間的訊息核驗，或是用來檢視文件是否遭到修改。在檢視
文件是否遭到竄改時，使用者可對文件進行MAC計算，並儲存MAC的輸出值。當文件
遭竄改時，可經由從新計算MAC，並比對新舊MAC的不同來發覺。在這個情況，如只
使用一般單向雜湊函數，則竄改者可自行計算一個新的雜湊函數值，來取代原先的雜湊
函數值，此時文件所有人就無法經由雜湊函數值之比對來發現文件曾遭竄改。而在採用
HMAC的情況下，除非鑑別金鑰遭到瓦解，否則任何非經授權者皆無法製作出正確的
HMAC值。
一個簡單的 HMAC 可由一般的單向雜湊函數加上非對稱金鑰系統的加密實做完
成；目前已知的 HMAC 系統也多採用此一類似的方式。
3.3 數位證據
所謂「數位證據」（Digital Evidence）泛指任何在網路犯罪過程中，利用電腦或是
網路所產生亦能被儲存、傳輸或取得之具犯罪事實認定效力的二位元
（binary）型態資料。此外，數位證據具有不易取得、易複製、易消滅、易竄改的特性，
想要在資訊安全事件發生後取得相關的數位證據，則必須要有一完善的收集、擷取、分
析及保存數位證據的方法[1]。通常企業會藉由內部網路設備或防護性軟硬體設施如 網
路伺服器（network server）、代理伺服器（proxy server）、防火牆（firewall）或入侵偵
測系統（intrusion detection system）等來進行連線控管與稽核的動作。而最常見的稽核
方式即是將有意義的系統或網路事件，以各種形式的歷史稽核檔（log 檔）儲存在企業
所指定的儲存媒介上，作為網路管理者查核的依據。這些平時收集到的紀錄亦可做為輔
助認定網路犯罪的數位證據。
3.4 事件記錄分析機制
主機維護一直是系統管理者日常最重要之例行事務，然而，系統管理的複雜度、效
率和所管理範圍、主機數、主機型態息息相關，然而，主機為一封閉之系統，有許多案
例指出，系統發生錯誤，甚至嚴重影響到組織之運作，卻無法有效查出問題發生之癥結，
或是判讀事件發生來源，最大的原因在於沒有紀錄。
因此，事件記錄檔(LOGs)的概念被廣泛使用在系統管理上，透過事件記錄檔機制，
主機系統運作之軌跡能夠被有效的紀錄，也讓系統管理者能夠循跡找出問題癥結，對於
系統管理者而言，log 檔案的存在性是絕對必要。
3.4.1 log 分析遭遇問題
本研究將以 Web-Based 做為開發系統之基礎，以 Linux 做為系統工作之平台，建立
具電腦鑑識特性之即時遠端 log 監測蒐集機制，管理者可以透過 web 方式進行系統管理
與監測，而在電腦鑑識基礎下的建構方式，將可提供資料傳輸可靠度，及後續資料可用
度之功效，後續面臨電腦鑑識作業時，將可加速鑑識蒐集程序，除對檢調方可以節省時
間外，對於受影響之主機，亦可加速復原之時效，降低因為蒐證時需停機的困擾，而正
常情況下，Light-SOC 系統亦將持續監控且可透過自行設定之多種預警通知方式來通知
管理者。
4.1 即時 Log 蒐集機制
資料同步所使用之方法有相當多種，如在異地備援時常使用的 rsync 套件，透過同
步的方式可以取得遠地端主機的資料，防止資料遺漏，然而，log 的特性在於隨時都會
產生報告在原始 log 檔案（以 linux 為例，會產生於/var/log/message），因此，傳統使用
定期同步傳輸的方式將不適用於本架構內，所幸 syslogd 提供了遠端同步模式可提供使
用者利用遠端記錄模式來進行資料的蒐集，透過語法的設定（Syslogd–r–m 0 即是用來
啟動遠端記錄機之語法），可以達成以一部蒐集主機即時記錄多部監控主機 log 資料之功
能。
Log 遠端蒐集機制所使用之通訊協定為 UDP 方式傳輸，正常情況下 log 資料短少幾
筆，對於管理者而言是可以接受的正常遺漏，原因在於 UDP 方式並不確保資料的可靠
性。而在電腦鑑識的認定下，資料的短少，就可能造成在判決上遭受駁回的疑慮，因此，
如何有效做到即時同步且確保每筆資料皆可正確被接收端所接收，則是本研究的重點所
在。
我們預計設計使用 syslog-ng 取代原有的 syslog，syslog-ng 使得利用 syslog protocol
進行遠端紀錄傳送時可以確認傳輸的方式或以 TCP 進行，取代原有的 syslog 使用 UDP
傳送等問題。
圖 1 Syslog-ng 即時遠端同步示意圖
4.2 Light SOC 架構
SOC（安全作業中心，或是網路作業中心）最大的目的在於建立大範圍的網路節點
監控中心，其最大之目的在於廣泛蒐集來自受管理範圍內所有監測點所提供的資訊，其
中資訊包含了封包資訊、檢測主機之主機狀態（包含 cpu 狀態、記憶體狀態、病毒攻擊
hash 值，此資料庫一經存放後即不再進行更動，可以選擇的是利用第二存放設備來存放
此資料，此種設計方式目的在於提供後續進行電腦鑑識程序時，可以擁有監控主機完整
資訊，可以解決傳統電腦鑑識程序無法完整蒐集受害主機證據的窘境，搭配 hash 值將
可進一步驗證該資料的唯一性
4.2.4 推論分析引擎子系統
推論分析引擎子系統，本子系統主要提供系統推論異常狀態使用，Log 資訊會反應
出目前監測主機操作狀態，然而過多的 Log 資訊使用者是無法一一觀察並且進行除錯，
利用正向推論方式過濾出有問題的 Log 訊息，並利用反向推論方式減少假警報的產生。
困擾系統管理者，被判訂定假警報者會直接不予理會，而真正的錯誤狀態，會被丟入推
論結果資料庫中，留待中央控制中心進行預警狀態輸出。
4.2.5 中央控制中心
中央控制中心為 web-base 管理機制，整體設計概念承襲 SOC 之架構，透過中央進
行主機之監控，可以解決時間及空間上管理之問題，也提供系統管理員一個整合式管理
機制，提供事件處理效率，在中央控制中心分為四個子功能分別為：
 即時監控：即時監控系統內 log 狀態，而透過搜尋 log 資訊的方式，也可以達到尋
找 log 內可疑事件的目的，可以早先發覺事件的發生，儘早預防。
 安全風險分析：透過圖表方式表達受監測主機目前風險程度，圖形化介面可以表達
大量資訊之目的，也能讓管理者瞭解風險指數，判斷處理之時機。
 系統狀態：各受測主機之詳細狀態、包括警示、受攻擊資訊、目前狀態等，可針對
各主機進行更詳細資訊判讀。
 層級式預警：除即時監控系統資訊，事件通知也是監控中心設計上的一項重點，透
過預警通報可以通知管理者儘早發現問題之所在，達到快速解決問題，因此，此一
功能上除了可以郵件通知管理者事件外，亦設計可由管理者自行設定預警通知的等
級，彈性設計可讓管理者自行決定，減少不必要的資訊。
5. 系統實作
本研究以以 Linux 做為系統工作之平台，以 Apache 及 PHP 搭配 perl 以及 C 語言建
立具電腦鑑識特性之即時遠端 log 監測蒐集機制，管理者可以透過 web 方式進行系統管
理與監測，並且搭配圖形、統計圖表方式來展示遠端監測系統的狀態值，並適時地將異
常警報資訊通報給管理者。
5.1 使用者驗證
必須針對使用者身份進行認可，由於該系統並不隨意對外開放，因此也不設計由網
頁為基礎的身份認可方式，直接由系統中設定 web 存取權限。其介面如下。
新增與刪除動作，新增後的法則庫會以檔案型態存放在系統後端，即時產生過濾動作來
進行異常狀態過濾。
圖 7 預警資料法則庫管理頁面 圖 8 正面列表資訊
5.5 預警通知
預警狀態會隨著系統所判斷狀態進行不同階層的輸出，其介面即是透過預警通知模
組來通知。根據預警通知模組層級設定，第三層級透過郵件方式通知使用者，根據法則
庫設定之預警信箱，系統會自動發信至所設好之信箱，管理者可以透過郵件瞭解目前系
統所發出之預警，並直接點選其超連結，便可以進入到查詢頁面中，直接觀看問題。
圖 9 預警通知信 圖 10 進入預警歷史資訊查詢界面
6. 結果與討論
本研究提供經費及設備不足之中小型組織建立一具有電腦鑑識特性之遠端 log 監測
蒐集機制，透過此方式來達到監測管理範圍下之系統及網路節點，並且若不幸發生資安
事件，所記錄之資料可以較具有效率，且兼顧可用性之資料提供給予分析單位進行後續
鑑識判斷工作，大幅降低鑑識作業處理上所帶來的影響。
本研究著重在於 Linux 平台的 log message 資料，未來可將 Windows 平台的 log 資
料整合進來，將可使本系統的 log 資料類型更為完整，並且未來將可進一步發展本研究
的系統機制，使得在中央蒐集主機所蒐集的 log messages 能夠即時地驗證及比對異常與
錯誤，此外網路設備及其他的資通安全設備也是即時遠端 log 監測的標的之ㄧ，發展適
用於此類設備或網路流量的監控方式也是未來進一步需要進行的工作之ㄧ。
參考文獻
[1] 鄭進興，林敬皇，沈志昌，電腦鑑識方法與程序之研究，TANET 2003 研討會論文
集。
[2] 單向雜湊函數
http://dsns.csie.nctu.edu.tw/course/intro-secutity/2005/book/chap06.pdf.
[3] G. Kruse II and J. G. Heiser, Computer Forensic: Incident Response Essentials, Addison
Wesley, 2002, pp:2-8,163-174.
[4] Kruse, W. & Heiser, J. (2002). Computer forensics：Incident response essentials. Boston：
Addison Wesley.
[5] Renaud Bidou, “Security Operation Center Concepts & Implementation”
[6] Stefan Axelsson, Ulf Lindqvist, Ulf Gustafson, Erland Jonsson,”An Approach to UNIX 
Security Logging”Proc. 21st NIST-NCSC National Information Systems Security
Conference,1998
