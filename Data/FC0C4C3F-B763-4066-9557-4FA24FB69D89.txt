圖一 智慧型視訊監控系統結構 
安全監控系統，相信可大大減少人事成本
及提高生產競爭力。依物體形狀特徵為基
礎的影像分割技術是影像處理、圖樣分析
與機器視覺的應用中最基礎且最重要的前
置處理程序[9]，本計畫的研究重點是根據
電腦擷取數位影像空間域外形特徵經過邊
緣偵測、中值濾波與影像相減等處理過程
將所需影像資料萃取出來並利用模糊規則
描述方式建立模糊影像建模系統。 
Inversing learning 是由 Widrow 與 
Stearns [3] 首先提出 , 也可稱為是一種
general learning，Inversing learning 可針對
未知受控平台系統以時間序列方式學習並
架構出整體系統，Inverse learning 一般可
將它分成兩個主要的部份，一為 Training 
Phase 而另一方面為 applicationphase。在
Training Phase 階段其可利用離線(off-line) 
或線上  (on-line) 的學習方式求取受控
Plant 的逆動態方程式 (Inverse Dynamics 
of Plant)G，而模仿其建立出來的 fuzzy 
controller 逆動態方程式^G 可用來產生 
fuzzy control action 應用於 application 
phase。或是在學習階段可逐步利用輸入輸
出資料對 (input-output data pairs) 去近似
fuzzycontroller model 的逆動態方程式^G
並同時將完成的 fuzzy controller model 應
用在此受控平台 ，整體的響應在輸入輸出
資料對(input-output data pairs)無法取得時
會用類似一時間延遲系統方式逼進 fuzzy 
controller model 。 當 學 習 完 成 後 ， 
fuzzycontroller model 非常近似於受控
Plant 的 逆 動 態 方 程 式 則 此 fuzzy 
controller 將可經確的監控此系統，若未非
常近似此受控平台則必須調整系統內參數
^G 以產生好的控制效果。 
PSO 學習演算法由 Eberhart and 
Kennedy 於 1995 年提出 [6]，它是一種模
擬鳥群或著稱魚群特性的啟發式學習裝
置。此種演算式的 PSO 方法已被專門用
來有效解決許多不同的最佳化問題。PSO 
中最主要的學習策略是將各別粒子的位置
值解譯為問題解，而此解集合將受群體最
佳解與個別最佳解的影響修正與學習。在
學習空間中，粒子的速度解引導學習率而
每個粒子則由適應函數作為評量並據此發
展出 PSO 學習法。在龐大複雜空間中搜
尋最佳或近似最佳解。本計畫利用影像分
割後辨識出的影像特徵資料輸入模糊控制
器內並建立智慧型視訊監控系統，故利用
粒子群最佳化演算法調整以建立最佳化參
是灰階值影像，右圖為經過邊緣偵測完之
後的結果。 
圖四 邊緣偵測過程 
3.3. 中值化濾波與雜訊消除 
由圖四可發現得知，原始影像經過邊
緣處理之後，其邊緣資訊可完整的呈現，
但不可避免的是其雜訊也會隨著邊緣偵測
處理而被放大。所以針對此問題，本研究
再設計執行 3× 3 的中值濾波器，去除雜訊
[9]。定義如下： 
 ( ) ( ) ( ){ }wk,,x-k,y-fmedianx,yM ∈= 11  (3) 
其中 x,y 為影像索引值， ( )x,yf 為影像中的
像素灰階值， ( )x,yM 中值化後的像素灰階
值， 101 ,,-k,l = 。在圖五中，左圖是邊緣偵
測後結果，右圖為經過中值濾波後雜訊較
小的結果。 
 
圖五: 中值濾波之過程 
3.4. 影像相減 
連續取得兩張彩色影像之後，經由前
述的影像處理，可得到兩張中值化灰階邊
緣影像，在本計畫中使用這兩張影像處理
後的影像做影像相減，其相減的結果即為
影像變動偵測的結果。如圖所示，圖六
(a)、(b)為連續輸入之影像經由相減處理可
得到圖六(c)的結果。 
圖六 影像相減過程  
3.5. 二維移動偵測陣列 
相減之後的圖像基本上已可用於入侵
偵測之判斷，但是這些資料過於瑣碎且資
料量過大不易演算，即使已經使用前述影
像處理方式降低高頻雜訊對入侵偵測的影
響在本系統中所使用的 CCD 攝影機其影
像擷取大小為 320*240，此相減後的影像
資料也有相同的資料維度，如圖七(a)二維
直方圖所示，以此資料作為入侵判斷的依
據將會耗費許多運算的時間，且易受到雜
訊的干擾。本計畫所用方式為將相減之後
的影像分成多個區域，並將此區域內的
值，相加之後取其平均，透過此方法可得
到一個全新的二維變動區域向量陣列，此
陣列仍然保有偵測影像變動的特性，並大
大的降低資料的數量，以本計畫所使用的
方法而言，相減之後的影像將會被重新切
割為 16× 16 的陣列，換言之在此陣列中的
每個區域大小為 20× 15 像素，且每個區域
的數值分別為其相減後灰階值之累加，圖
七(b)二維直方圖為縮減過後之二維變動
累加值之陣列。 
圖七 二維移動偵測過程 
3.6. 入侵參數量化 
因此判斷此累加後之二維陣列即可
得知此連續影像是否有入侵情況發生。本
方法採用統計方法中所常用的平均值
(Mean)及標準差(Variance)的計算方式，藉
以觀察其資料集分布狀況以及變異的程
度，在本問題中此二維陣列變異程度大時
 
( ) ( )
( ) ( ) ( )( )
( ) ( ) ( )( )t-Ytgrandβ
t-Ytprandβ
tvτtv
jiibest
jijibest
jiji
∗∗+
∗∗+
⋅=+
2
1
                 
                 
1
 (4) 
其中 i 是系統的輸入維度索引， j 是模糊規
則的個數，τ 是慣性常數， t 表示現在狀
態、 1+t 為下一時間狀態， 1β 與 2β 是學習
率常數。當粒子的速度決定後，則下一時
間狀態的粒子解 jiY 可被修正為 
 ( ) ( ) ( )11 ++=+ tvtYtY jijiji  (5) 
由(3)與(4)式可知，粒子的學習路徑與移動
大小，將由 bestg 與 bestp 決定。PSO 演算法
建立模糊系統之設計步驟與流程說明如
下: 
Step1) 隨機產生初始群中所有個體的位
置向量Y 以及移動速度 v，其中位置向量的
解為模糊系統參數之解函數。 
Step2) 計算每一粒子個體之適應函數值
適應函數 pF 設計如下 
 
MSE
Fp
1=  (6) 
其中MSE 代表(Mean Square Error)， PSO 
的搜尋目的為找尋具有與受訓資料集間最
小之MSE 的模糊系統參數集合，其目標是 
 ( )pFMAX  (7) 
Step3)將每一個個體目前求得之適應函數
值與其所記憶之最佳適應函數值進行比
較，若目前之適應函數值較之前最佳結果
為佳，則以目前位置取代個體記憶之最佳
所在位置，以目前適應函數值取代個體記
憶之最佳值： 
 
 
( ) ( )
( ) ( )⎪⎩
⎪⎨
⎧
<
≥= +
++
+
t
pbest
t
p
t
pbest
t
pbest
t
p
t
pt
best
pFX F      p
pFX F        iX
p
1
11
1
if
f
 (8) 
Step4) 比較個體最佳解所求得的適應函
數是否優於群體所記憶的最佳值，若判斷
條件成立則將群體所記憶之最佳位置與最
佳值重設為目前的結果，反之群體最佳解
維持原先狀態： 
 
( ) ( )
( ) ( )⎪⎩
⎪⎨
⎧
<
≥= +
++
+
t
best
t
pbest
t
best
t
best
t
pbest
t
pbestt
best
gFpF          g
gFp F        p
g
1
11
1
 if
if
 (9) 
Step5) 根據 Equation (4) 和 Equation (5) 
調整所有個體移動的速度與位置。 
Step6) 重覆 Step2)-Step5) 直至達到預設
的迭代次數為止 
5.2. 模糊歸屬函數最佳化 
將所得到的訓練資料包含:背景畫面、有入
侵畫面資料集、無入侵畫面資料集，使用
PSO 演算法針對本模糊系統的輸入參數
1µ、 2µ 、 3µ 、 1σ 、 2σ 、 3σ 以及輸出參數 1e (如
圖九所示之模糊系統參數定義)，進行歸屬
函數參數最佳化。所得到最佳化參數結
果，即為該特定的攝影機在此場景下最佳
模糊推論系統參數。 
6. 系統展示與結論 
本計畫分別載入外物入侵重建影像集
(如圖十所示)，與非入侵之訓練資料有不
同程度雜訊干擾或聚焦不良的無入侵影像
集(如圖十一所示)，之後執行 PSO 演算法
去建立模糊影像建模系統，所建立的模糊
影像建模系統參數分別為  1µ =95 、
2µ =2530、 3µ =5651、 1σ =5425、 2σ =7144、
3σ =7915、e =0.5，此參數設定完成後即建
立了針對此場景的模糊影像監控系統，並
開始啟動模糊監控系統運作，當有外物入
侵時所設計的模糊決策系統可即時提出入
侵警告並將入侵影像儲存在硬碟，如圖十
二所示，所儲存的影像隨時可以方便查閱
可疑外物入侵，如圖十三所示。本計畫透
過影像處理技術與粒子群最佳化演算法建
立一模糊建模系統，依據建立的模糊決策
規則完成一智慧型視訊監控系統的軟體設
