 
 
z 研究摘要： 
本計劃提出應用微處理器於家庭用太陽能幫浦驅動器之研製。本系統以微
處理器 HT46 系列 (Microprocessor HT46 series) 為基礎，大幅縮小硬體電路
體積，達成可調式多脈波之控制訊號來進行數位控制及實現控制策略，使其具
有安靜省電的用水環境，使用壽命長、維修成本低及環保效益等優點，採用直
流無刷馬達，改善傳統有刷直流馬達使用一段時間之後需更換碳刷缺點。由於
太陽光電池之輸出功率受日照強度及溫度因素影響，為了讓太陽光電池發揮最
大的功能，因此本計劃提出最大功率點追蹤法 (Maximum Power Point Tracking, 
MPPT) 控制太陽能板的輸出功率，使其能在各種不同工作環境下，均可使太
陽光電池輸出最大功率。 
關鍵詞：太陽能電池、最大功率點追蹤法、幫浦驅動器。 
 
 
z 人才培育成果說明： 
(1). DC-DC 截波器電路設計與製作。 
(2).完成微處理器程式設計。 
(3). MPPT (最大功率追蹤) 技術之建立。 
(4).太陽能對電池組充電與放電技術控制。 
(5) 家庭用太陽能抽水幫浦驅動器研製。 
(6) 實驗數據紀錄、整理及分析。 
處理器 89S51，其有 128 位元的 RAM，以及 4K 位元的 ROM，內建時脈產生
電路，且外部電路擴充 64 位元程式記憶體的能力，因此，可減少硬體電路。
此外，還有 2 個 16 位元的計時/計數器，來提供本系統產生之 PWM。利用微
處理器周邊介面之類比對數位信號轉換器(A/D converter)，讀取太陽能光電池
及蓄電池之電壓、電流，經由微處理器運算及控制，最後產生太陽能光電池最
大功率追蹤控制的脈寬調變控制信號，送與閘極驅動電路以驅動 Sepic 轉換器。 
 
 
89S51
電壓偵測A / D
轉換電路
電流偵測A / D
轉換電路
Vpv
Vbt
Ipv
Ibt
脈寬調變訊號
PWM
Sepic 
轉換器
 
圖 1 微處理器介面電路規劃圖 
(2)電壓回授電路 
電壓回授電路是將回授電壓信號經由電阻 R1、R2 分壓後，經由 A/D 類
比轉數位訊號之轉換 IC，轉成數位訊號傳送至微處理器以作為電壓回授信
號，如圖 2 所示。 
於微處理器輸出電壓為 5V，因此需要利用光耦合器(TLP250)將電壓振幅提高
同時隔離輸出輸入訊號，以驅動功率開關。 
TLP250
1
2
3
4
8
7
6
5
5v 15v
 
圖 4 功率晶體驅動電路圖 
2. 軟體控制流程 
本文軟體控制是以最大功率追蹤法中的擾動觀察法為基礎，系統主程式流
程圖軟體規劃如圖 5 所示。首先設定系統之初值及參數，然後開始執行主程
式，透過類比/數位轉換讀取電壓及電流回授值。開始以 MPPT 演算法判別讀
取資料來進行比較，計算出控制信號，最後由微處理器內之脈波寬度調變電路
產生開關責任週期，經由功率電晶體驅動電路以驅動功率電晶體之導通或截
止。其 MPPT 演算法之程式流程圖如圖 5 所示。 
轉換器增載提高功率輸出，使輸出端點電壓維持在一值上；圖中所示為量測
MOSFET 之腳位電壓以顯示其結果，以下波形圖 CH1 為量側 VGS之波型，CH2
則是量測 VDS 之波形。根據實際量測之波形，可得知隨著脈波調變寬度的增
加、減少，波形也有明顯的變動使其工作週期改變，故輸出功率與脈寬調變 
(PWM) 也以成正比方式在改變。 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
  
 
圖 8  Sepic 轉換器電路 
 
 
 
圖 9 微處理器外觀 (包括 LCD) 
 
 
 
 
 
 VGS
VDS
輸出
電壓
 
圖 11 實際量測之 VGS、VDS及輸出電壓波形圖 
 
 
VGS
VDS
 
圖 12 實際量測之 VGS、VDS波形圖，CH1 Duty=17.50% 
 
 
 VGS
VDS
 
圖 15 實際量測之 VGS、VDS波形圖，CH1 Duty=48.93% 
 
 
 
VGS
VDS
 
圖 16 實際量測之 VGS、VDS波形圖，CH1 Duty=86.23% 
 
z 技術特點說明： 
充電控制器與 DC-DC Sepic轉換器電路之研製 
    由於本計劃之太陽能板輸出直流電壓需經充電控器並且對蓄電池充電，因
此除了須能將太陽能板輸出直流電 (17.4V DC) 轉換為所需之充電電壓外，也
需能將充電電壓轉換為幫浦驅動器必要之直流輸入電壓，因此部份之電路將包
括充電控制器及DC-DC Sepic轉換器電路。 
    雖然 Sepic轉換器電路可將直流低電壓提升為直流高電壓，但是其升壓也
有一定之上限。因此當太陽照度降低時，輸出的電壓會跟著下降，經升壓轉換
器所提升之電壓將可能無法供給交通號誌燈或是對蓄電池繼續充電，因此透過
SSR1作為升壓型轉換器電路連接太陽能板之控制開關，使轉換器電路可切離
太陽能板，直到太陽能板輸出電壓值達15V時，再使太陽能板與轉換器連接。
另外，蓄電池充電將近滿電位時約28V，為避免電池過充以確保蓄電池壽命，
因此亦可透過SSR1斷開太陽能板，使其電路不再對電池充電。   但若連續陰
天使得太陽能板無法對蓄電池作足夠之充電，甚至連台電公司也發生停電時，
將使得電池電壓位準降低，當蓄電池之電位低於21V時，為了避免蓄電池過
放，所以必須適時的將蓄電池切離，以延長蓄電池的壽命。因此設置了SSR2
開關，當SSR2切離後，電池因而停止放電，直到當台電電源之電力恢復或是
太陽能板提供之電源對蓄電池充電至24V以上，才再將SSR2導通恢復供電。此
系統之工作模式如圖17 所示。 
太陽能
光電板
充電
控制器 蓄電池 截波器
馬達 幫浦
A
B
微處理器
SSR1 SSR2
 
圖17、家庭用太陽能幫浦驅動器系統架構 
