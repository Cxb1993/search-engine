 
國科會補助專題研究計畫成果報告自評表 
請就研究內容與原計畫相符程度、達成預期目標情況、研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）、是否適
合在學術期刊發表或申請專利、主要發現或其他有關價值等，作一綜合評估。
1. 請就研究內容與原計畫相符程度、達成預期目標情況作一綜合評估 
▉  達成目標 
□ 未達成目標（請說明，以 100 字為限） 
□ 實驗失敗 
□ 因故實驗中斷 
□ 其他原因 
說明： 
 
 
2. 研究成果在學術期刊發表或申請專利等情形： 
論文：□已發表 □未發表之文稿 □撰寫中 □無 
專利：▉已獲得 □申請中 □無 （已經獲得四項發明專利） 
技轉：□已技轉 □洽談中 □無 
其他：（以 100 字為限） 
 
3. 請依學術成就、技術創新、社會影響等方面，評估研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）（以
500 字為限） 
本研究目前已經獲得四項專利，三項為中華民國專利，一項為大韓民國專利。
茲將所獲得之四項專利列述如下： 
[1] 巫木誠、盧威豪、吳佳恩「物料報廢架構及物料報廢準則產生方法」，中華
民國發明專利（證書號數：I323427）  
[2] 巫木誠、陳德珊：「基板排序派工之方法」，大韓民國專利，(證書號數：
10-0816624)  
[3] 巫木誠、陳德珊：「基板排序派工之方法」，中華民國專利，(證書號數：
I315476)  
[4] 巫木誠、吳政翰：「相依排程之派工方法」，中華民國發明專利（證書號數：
I313437） 
 
 
附件二 
  
國科會補助專題研究計畫項下出席國際學術會議心得報告 
                                  日期： 99 年 10 月 28 日 
一、參加會議經過：APIEMS（亞太工業工程與管理會議）是亞太地區最重要的工業工程會議，我
國是創始會員國，國內有多位教授擔任理事，我國工業工業工程界在此會議頗有影響力。此會議
到 2009 年已經舉辦 9屆，此此次會議約有 300 百人參加，最主要是我國、日本、韓國的學者，其
他還有大陸、香港、泰國、馬來西亞、菲律賓、印尼等國家，APIEMS 這個會議的重要性越來越大。
此次會議，本人除了發表學術論文之外，也同時參加 APIEMS 的理事會會議，也參加 IFPR-Asia 
Region 的理事會會議；在此會議中，本人也同時受邀擔任 IEMS Journal Special Issue 的
Co-editor。 
二、與會心得 
z 韓國的工業工程學術水準大幅提昇，許多研究都做得很好，產業和學術價值兼具，實在很
值得學習和肯定。 
三、考察參觀活動(無是項活動者略)：無 
四、建議 
z 國內學者宜加強與產業合作，研究的題材可以本土化(Local Impact)，期能對國內產業的
競爭力有幫助；但是研究成果要能國際化(Global Excellence)，亦即能在一流國際期刊發
表，以提升我國學術研究水準，也驗證本土化研究成果之水準。 
五、攜回資料名稱及內容： 
z 2009APIEMS 大會學術論文集光碟 
六、其他 
計畫編號 NSC 96 －2221－E－009－034－MY3 
計畫名稱 新產品/製程導入情境下 TFT-LCD 產業的製造管理 
出國人員
姓名 巫木誠 
服務機構
及職稱 國立交通大學工業工程與管理系 
會議時間 
 98年 12月 14日
至 
 98 年 12月 16日 
會議地點 
Kitakyushu, Japan 
（北九州、日本）－ 
會議名稱 
Proceedings of Asia Pacific Industrial Engineering & Management Systems 
Conference (APIEMS) 2009, Kitakyushu, Japan, Dec. 14-16, 2009. 
發表論文
題目 
(中文)大型半導體廠房之物料搬運系統分析 
(英文) An Analysis of Material-Handling Capacity for a Large Scale Semiconductor 
Fab 
附件四 
 
國科會補助專題研究計畫項下國際合作研究計畫國外研究報告 
                                    日期：99 年 10 月 28 日 
z 不適用：在本專題計畫下，本人未參加任何國際合作。 
 
一、國際合作研究過程 
二、研究成果 
三、建議 
四、其他 
 
  
 
計畫編號 NSC 96 －2221－E－009－034－MY3 
計畫名稱 新產品/製程導入情境下 TFT-LCD 產業的製造管理 
出國人員
姓名 巫木誠 
服務機構
及職稱 國立交通大學工業工程與管理系 
合作國家  合作機構  
出國時間  年 月 日至  年 月 日 出國地點  
附件六 
 II
Abstract 
TFT-LCD has become an important industry in Taiwan. In the new 
product/process introduction (NPI) stages, the process yield is usually low and 
behaves in a stochastic manner. Due to volatile market demand, NPI appear constantly. 
Developing manufacturing management techniques for NPI in TFT-LCD industry is 
thus very important. Yet, rare literature has addressed such research issues. We 
therefore carried out a 3-year research project to address the manufacturing 
management issues in a low-yield TFT-LCD scenario. We focused on three research 
topics in NPI scenarios: (1) TFT/CF plate rework decision, (2) TFT/CF plate 
mapping/sorting decision, and (3) product mix/releasing decisions. The research 
results yield four patents, three granted by Taiwan, ROC; and one granted by South 
Korea. These patented techniques would help enhancing the productivity of Taiwan 
TFT-LCD industry. 
Research problems and results of the first topic (TFT/CF plate rework decision) 
are briefly described below. For a TFT-LCD factory in a low-yield scenario, we need 
to determine whether a low-yield TFT-Plate/CF-plate should be reworked or proceed 
for further processing. We develop a mathematical model for computing the profit 
given a portfolio of rework decisions, and use a genetic algorithm to find an optimal 
portfolio rework decisions in order to maximize the total profit. The developed 
method has been granted a patent by Taiwan, ROC. 
 
Research problems and results of the second topic (plate matching and sorter 
scheduling) are briefly described below. TFT-Plates and CF-Plates are both 
manufactured in batches. Each batch may include various qualities of plates. To make 
an optimal pairing match among TFT-Plate and CF-Plate batches, the plates in the 
batches should be sorted (or plates are exchanged among batches). This leads two 
decisions: plate sorting, and scheduling of sorter. We develop a dynamic programming 
model to solve the two decisions, which has received two patents, one granted by 
Taiwan, ROC and the other by South Korea.  
 
Research problems and results of the third topic (product mix/releasing decisions) 
are briefly described below. Based on the developed methods of the first two issues, 
we can compute the profit for a particular product mix and releasing portfolio. Based 
on a meta-heuristic algorithm, we can find a near-optimal product mix and releasing 
portfolio. On examining this issue, we unexpectedly develop a meta-heuristic 
algorithm for solving the scheduling of a heterogeneous project, which has also 
received a patent granted by Taiwan, ROC.  
 
Keywords: Low yield scenario, TFT-LCD, rework, plate mapping/sorting, product 
mix, lot release 
 IV
表目錄 
 
表 3.1  基板重工決策案例一之績效比較------------------------- 13 
表 3.2  基板重工決策案例二之績效比較------------------------- 13  
表 3.3  基板重工決策案例三之績效比較------------------------- 14  
表 4.1   基板配對排序機各種排序方法的績效比較----------------- 22  
表 5.1  異質專案排程之染色體表達與解讀----------------------- 28  
 
 
 
  
 
 2
1.4 章節安排 
 本報告其餘章節安排如下：第二章是每個子題的文獻回顧。第三章說明子題
一的問題、解法、和成果。第四章說明子題二的問題、解法和成果。第五章說明
子題三的問題、解法、和成果。第六章是結論和建議。 
 
 4
差異，這也是本研究加以延伸探討的主要部分。 
半導體廠報廢決策往往是以批(lot)為單位，低於門檻值的晶圓批上的多片晶
圓皆報廢，而 TFT-LCD 廠則是以基板為單位，低於門檻值的基板，該基板上的
面板皆報廢(重工)，所以批相當於基板，晶圓相當於面板，這是兩種產業在報廢
(重工)決策的類比之處。 
2.2 基板配對與排序的相關文獻 
過去 TFT-LCD 製造管理的相關文獻，主要可分為兩大類，第一類為基板配
對決策方法之研究，而第二類則著重在排序機派工決策之研究。 
    在基板配對決策的研究中，主要有三篇主要的文獻，分別是楊毅臻 [22]、
楊佳翰[23]、]及張東華[24]，在這部分的研究已有最佳化配對良率的演算法，因
此不再進行探討。而在排序機派工決策方面，則有楊佳翰[23]、楊毅臻[22]及王
君豪[25]三篇文獻，分別在以下進行簡介。 
為縮短卡匣上下排序機的次數，楊佳翰[23]提出以基因演算法(Genetic 
algorithm, GA)及模擬退火法(Simulated Annealing, SA)發展良率配對的方法。該研
究假設排序機有 1 個輸出埠、k 個輸入埠，若有 N 組卡匣的基板需要配對，該研
究先將卡匣分群，一群包含有 k 個 TFT 卡匣和 k 個 CF 卡匣，然後以線性規劃法
(Linear Programming, LP)求解一群內基板配對的最佳解。該研究可有效縮短卡匣
上下排序機的次數，但是所規劃的基板配對良率未必是最佳解。 
為確保基板配對良率，進而縮短卡匣上下排序機的次數，楊毅臻[22]應用匈
牙利指派法求解良率配對，然後發展啟發式方法(Heuristic Methods)來決定目標卡
匣產出順序(簡稱產出順序)及會員卡匣上下排序機的順序(簡稱投入順序)，期以
最小化排序機的總作業時間。該研究雖然可確保最佳配對良率，然而，在求解良
率配對的線性規劃問題時，該研究假設該線性規劃問題只有一組最佳解，並據以
求解排序機派工問題。 
    為配合 TFT-LCD 連續型生產的特性，王君豪[25]發展基因啟發式演算法來
求解排序機派工問題，其研究方法利用啟發式解法進行求解投入順序問題(input 
sequencing problem)，下游組立壓合機台(assembly machine)利用率為績效衡量指
標，並以此作為基因演算法的適應函數，來進行規劃目標卡匣的產出順序(output 
sequencing problem)，此基因啟發式解法同時整合排序機作業及下游組立機台作
業，以整體性的觀點增進組立製程的生產效率。 
    針對上述文獻回顧，吾人可以發現王君豪雖以整體性的觀點來進行排序機派
工決策，但在投入順序問題上仍有改善之空間，因此本研究的重點在發展一動態
規劃法(Dynamic Programming, DP)以改善王君豪的研究中，使用啟發式解法求解
投入順序決策問題不足的部分。 
 
2.3 異質專案排程相關文獻 
 6
(mutation operator) 來產生新染色體。在 DHC 的排程指派問題，因為任務有順序
限制，交配因子和突變因子可能產生兩個問題：(1)很容易產生不合理解，(2) 產
生品質不佳的解。因此過去的方法在搜尋的效率上仍有改善的空間。 
 8
的思考，譬如業界目前大多採用的 1/2 重工決策，也就是經某一加工作業加工
後，若基板上所包含的良好面板個數大於總面板數的一半以上，就可投入下一加
工作業繼續加工；反之，則逕行重工。有鑑於過去研究的不足，以及工業界直覺
性的思考所訂定的重工決策，並未考量到整體績效，且並非站在整個生產系統的
觀點來訂定，所以本研究將針對此問題，發展出一較佳的重工決策。 
3.2 問題描述 
根據上述的研究動機，本研究將考量整個 TFT-LCD 廠生產流程中各階段主
要製程的特性，針對不同的產品，訂定個別產品在 Array 製程及 CF 製程階段中，
各檢測站的最佳重工決策，使 TFT-LCD 廠的獲利最佳化，  
 
 
 
 
 
由於 Module 製程只是將驅動晶體電路板、背光模組裝到 Cell 製程最後所切
割的 TFT-LCD 面板上，主要是進行附加工作，加上面板在 Cell 製程中已訂定出
品質等級，所以其實 Module 製程對於整體績效的問題影響程度不大，因此本研
究將不考慮此階段製程對於重工決策的影響。 
 
圖 3.1 為問題描述說明，其中 Cell 製程的主要特性有以下兩點：(1)基板配對
良率問題、(2)面板分級比率問題。基板配對良率問題為除了 TFT 基板與 CF 基
板本身良率(基板中包含良好面板個數的比率)，會影響 Cell 製程組立後 TFT-LCD
基板的配對良率(mapping yield)外， TFT 基板或是 CF 基板中良好面板的位置，
也會影響組立後的 TFT-LCD 基板的配對良率，如圖 3.2 所示，雖然 3.2(a)與 3.2(b)
在組立前兩者的 TFT 基板與 CF 基板的良率相同，但因為良好面板的位置不同，
導致經由組立製程後的基板配對良率不同。 
 
圖 3.1 基板重工問題描述 
Cell 
組立製程 
作業1 …
Array 
作業2 作業m 
作業1 …
CF 
作業2 作業k 
求得各產品在 
Array 及 CF 各檢測站 
的最佳重工決策 
考量 Cell 製程特性 
 基板配對良率 
 面板分級問題 
決策目標 
針對不同產品 
使 TFT-LCD 廠 
獲利最大化 
 表示檢測站 
 10
入 Cell 製程進行組立作業。 
 Cell 製程的產能大於 Array 製程及 CF 製程的產能，可確保 Array 製程
及 CF 製程所製作之基板，皆可進行組立製程作業。 
 假設 Cell 製程在進行組立作業的過程，是隨機自 Array 製程階段的最
終產出中取一片 TFT 基板，同時也隨機自 CF 製程階段的最終產出中取
一片 CF 基板進行組立作業，並無事先將 Array 製程與 CF 製程的基板最
終產出進行排序或是篩選配對的過程。 
 Cell 製程無良率問題，即進行組立製程時，必能確實完成作業。 
 
3.3 解題模式 
本研究的研究架構主要可分為兩大模組，模組一(Evaluator)為計算一重工門
檻值組合下的績效，利用建構一數學模式，在給定一些產品參數後，計算一組重
工門檻值組合下的績效；模組二(Searcher)為搜尋最佳重工組合，目的在於比較
眾多重工門檻值組合在績效評估模組中的績效，選取一最佳的重工門檻組合。 
 
3.3.1 模組一 
模組一如圖 3.3 所示可再細分為四個子運算模組，分別為：(1)Array/CF 製程
運算模組，(2)Cell 組立製程運算模組，(3)面板分級運算模組，(4)績效評估模組。 
 
Array/CF 製程運算模組的目的在於建構出 Array 及 CF 製程階段中，各作業
道次的加工及重工決策的運算模式，依據各檢測站所選擇的重工決策，求得在該
重工決策組合下，兩製程階段的最終基板期望產出(Array 製程階段產出的 TFT
面板以及 CF 製程階段產出的 CF 面板)，以及兩種基板的最終產出依據基板良率
(所包含良好面板個數的比例)的分佈狀態。 
 
Cell 組立製程運算模組建構出 Cell 製程階段中，進行組立製程的運算模式，
考量 Cell 製程中進行組立作業的特性建構一數學模式加以分析，將 Array/CF 製
程運算模組所求得的基板期望產出數據，經由運算後，求得合併而成的 TFT-LCD
基板的期望產出，以及依據基板配對良率的分佈情形。 
 
面板分級運算模組建構出最終面板成品的等級分級運算模式，利用 Cell 組
立製程運算模組所求得的各配對良率之 TFT-LCD 基板期望產出數據，經由本模
組運算後，求得各等級面板的產出分佈情形。 
 
績效評估模組是將前三個運算模組所求出的一些影響成本或收益的中間產
物及最終產物數據，套入所建構的目標函式中，求得目標函數值，本研究的目的
為針對不同產品，使產品利潤最大化。 
 
3.3.2 模組二 
模組二最佳重工決策選擇模組用於選取使產品利潤最大化的檢測站重工決
 12
 
 
 
3.4 實例驗證 
本研究將利用模擬一 TFT-LCD 廠的生產環境，來驗證本研究所提出的方法
是否可行，並與兩種決策方法比較，其一是不採用重工決策以，其二是目前工業
界大多數直覺性思考所訂定的 1/2 重工決策(包含良好面板個數大於總數一半以
上的基板，即可投至下一 stage 繼續進行加工)進行比較。我們用三個案例來比較
此三種方法的決策績效。 
 
在案例一，每片基板中所包含的面板數為 6 片，所以若採用 1/2 重工決策，
即為經由一 stage 加工後，若一基板包含 3 個以上的良好面板，則該基板可投入
下一 stage 繼續加工。比較結果如表 3.1，本研究所發展之方法，較其他兩種方法
獲利高約 9.30-11.61%。 
 
在案例二，每片基板中所包含的面板數為 10 片，所以若採用 1/2 重工決策，
即為經由一 stage 加工後，若一基板包含 5 個以上的良好面板，則該基板可投入
下一 Stage 繼續加工。比較結果如表 3.2，本研究所發展之方法，較其他兩種方
法獲利高約 6.48-7.63%。 
績效評估模組
一組重工門檻 
組合下的利潤 
Array/CF製程 
一重工門檻組合 
•  基板配對後產出量 
•  基板配對良率分布 
各等級面板
的產出分佈
Array/CF製程 
運算模組 
Cell組立製程
運算模組 
面板分級 
運算模組 
• TFT/CF基板產出量 
• 基板良率分布 
圖 3.4 模組一運算流程
 14
 
 
  Z(片) P(片) N(片) 目標函數值(元)
(1)無重工決策 86,071 4,922 3,698 $256,348,671 
(2) 1/2 重工決策(h=8) 86,049 4,911 3,689 $257,472,097 
(3) 本研究所求得之最佳重工決策 87,769 4,919 3,671 $266,128,646 
(4) 本研究改善無重工決策的比率  
=((3)-(1))/(1) 
1.97% -0.06% -0.73% 3.82% 
(5)本研究改善 1/2 重工決策的比率
=((3)-(2))/(2) 
2.00% 0.16% -0.49% 3.36% 
 
表 3.3 基板重工決策案例三之績效比較 
 16
s3從其原卡匣抽出，置放在新的 TFT 卡匣 Y 內，使卡匣 X 內的所有基板，其配
對基板均在卡匣 Y 內，抽換作業完成後的卡匣 Y 為目標卡匣。 
 
 
圖 4.2 基板抽換作業 
 
進行抽換作業的設備稱為排序機(sorter)。如圖 4.3 所示，一個典型排序機的
組成包括一個機器手臂(robot)，一個輸出埠(output port)，數個輸入埠(input port)。
進行抽換作業時，輸出埠置放一空卡匣，機器手臂的功能是從輸入埠所置放的卡
匣中抽出 TFT 基板，將其放在輸出埠的卡匣，以形成目標卡匣。 
 
 
圖 4.3 排序機設備 
 18
 
 
目標卡匣產出順序：C1  C2  C3  C4
目標卡匣產出順序：C3  C4  C2  C1 
決策一例： 決策二例：
T1
CF2會員卡匣為TFT1, TFT2, TFT3
會員卡匣上下排序機順序：
T2 T3
T1 T3 T2
 
圖 4.5 排序機派工決策 
 
4.2 解題方法 
    本研究主要的決策問題是規劃投入順序，因此本節重點在將投入順序決策建
構成動態規劃模型(Dynamic Programming Model)，其內容包含有二，分別是將投
入順序決策問題建構成完整的網路，再依動態規劃特有的系統化方法找尋最佳投
入順序。欲將投入順序決策過程描述成動態規劃網路，其過程主要可分為兩個部
分（參閱圖 4.6）。 
 
第一部分是基本的網路模型的建立，此基本架構包含了階段(stage), 狀態
(state), 批次(batch), 而基本架構的建立透過 Stage Modeling, State Modeling 和
Batch Modeling 三個模組來完成；第二部分為加強網路結構，利用 State 
Deployment 模組將原本不完整的狀態，重行部署成為一個或多個完整的狀態，
目的是為了使網路架構更加完整。 
 
 20
4.9。吾人繼而發展動態規劃法(dynamic programming)求解此基板重組與排序問
題。 
 
 
圖 4.7 基本網路架構 
  
     
圖 4.8 三種狀態組態 
 22
表 4.1  排序機各種排序方法的績效比較 
生產情境 輸入埠數 p 隨機解 王氏 本研究 改進績效 
1 89.9% 96.2% 100.0% 3.8% 
2 91.2% 95.9% 100.0% 4.1% 
3 90.0% 95.5% 100.0% 4.5% 
4 89.7% 95.1% 100.0% 4.9% 
N=10 
n=20 
panel=6 
5 88.7% 94.5% 100.0% 5.5% 
1 90.9% 94.5% 100.0% 5.5% 
2 91.2% 95.0% 100.0% 5.0% 
3 89.7% 94.6% 100.0% 5.4% 
4 89.5% 94.1% 100.0% 5.9% 
N=10 
n=20 
panel=12 
5 90.1% 93.6% 100.0% 6.4% 
1 88.5% 92.8% 100.0% 7.2% 
2 89.1% 92.6% 100.0% 7.4% 
3 88.6% 92.7% 100.0% 7.3% 
4 86.3% 92.7% 100.0% 7.3% 
N=10 
n=20 
panel=30 
5 85.6% 91.7% 100.0% 8.3% 
1 93.4% 98.3% 100.0% 1.7% 
2 92.6% 98.2% 100.0% 1.8% 
3 93.6% 98.1% 100.0% 1.9% 
4 94.0% 98.0% 100.0% 2.0% 
N=15 
n=20 
panel=6 
5 92.6% 97.9% 100.0% 2.1% 
1 92.6% 95.1% 100.0% 4.9% 
2 92.5% 95.3% 100.0% 4.7% 
3 92.7% 95.5% 100.0% 4.5% 
4 93.1% 95.8% 100.0% 4.2% 
N=15 
n=20 
panel=12 
5 92.9% 95.5% 100.0% 4.5% 
1 93.1% 94.4% 100.0% 5.6% 
2 92.5% 94.2% 100.0% 5.8% 
3 91.6% 94.2% 100.0% 5.8% 
4 90.9% 94.3% 100.0% 5.7% 
N=15 
n=20 
panel=30 
5 91.4% 94.4% 100.0% 5.6% 
1 94.9% 98.5% 100.0% 1.5% 
2 95.1% 98.5% 100.0% 1.5% 
3 95.7% 98.4% 100.0% 1.6% 
N=20 
n=20 
panel=6 
4 95.5% 98.3% 100.0% 1.7% 
 24
第五章 專案排程 
 
 產品組合和投料的決策問題，基本上是一個空間搜尋問題，只要基板重工決
策、基板配對決策可以求解，我們就可求出最佳的投料組合和數量決策。為發展
快速有效之搜尋演算法，本計畫在研究此問題，意外想到一個異質專案排程的解
法，並發展出一個特殊的搜尋演算法，本章特別介紹此專案排程問題和解法。 
 
5.1 研究問題 
有限資源的專案排程(project scheduling)問題可能會非常複雜，因為具有下列
二個特性。第一、任務(task)之間具有相依關（dependent relationship）， 此等相
依關係通常可用一個有向非循環圖來描述 (directed acyclic graph，簡稱 DAG)，
如圖 5.1 所示，該專案具有 6 個任務 (task)，任務間有執行順序上的限制，譬如
說，任務 t2需要任務 t1與任務 t6都執行完畢，才能執行。第二、任務的執行具有
共用資源的特性，如圖 5.2 所示，該專案所有的資源是 3 部機器，每個任務都可
用任一部機器加工。 
 
 
 
 
 
 
 
 
 
 
 
 
圖 5.2  3 個機器的異質系統 
 
此種排程問題可分成兩個子問題：排序(sequencing)問題、指派問題
(matching)。排序問題是決定任務執行的先後順序，指派問題是將任務指派給機
器。這類排程問題的複雜度(complexity)很高，因為 t 個任務排序最多有 t!組合，
圖 5.1  DAG 任務 
t1 
t2 t3 t4 
t5 t6 
機器 1
機器 2
機器 3
高速網路 
 26
 
上式中，H(i)為任務 i 被指派的機器，R[H(i),H(k)]為頻寬，Di,k為從任務 ti 到
任務 tk所需的傳輸資料量，當任兩任務 ti, tk 指派給同一個機器時，傳輸成本為
0，代表並不需要傳輸資料。為了簡化問題，我們假設任兩機器的頻寬皆為 1.0，
因此任兩任務之間的傳輸成本相等於其資料傳輸量，指派給不同機器不會影響傳
輸時間。 
因為是異質機器，同一任務在不同機器的期望執行時間(expected execution 
time)會不同。再者任務不能再拆解，亦即設每一個任務只能指派給一部機器執
行。 每一個任務根據其所執行機器可以精確的估計其期望執行時間，期望執行
時間可以一個 n×m 的矩陣 E 表達，其中 jiE 代表任務 i在機器 j 的期望執行時間 
本排程部問題績效指標是總完工時間(makespan of the program)，目標函數如
下所示：                    
                  T = max (F1,…..,Fm)                           
 
上式中，Fj為機器 j 的全部完成時間(makespan)，j=1,…,m。完成時間包括執行時
間(processing time)和因有優先關係而產生的等待時間(waiting time)，其中等待時
間包括了機器實際閒置時間(idle time)和資料傳輸時間(communication time)。 
 
5.2 指派的解法 
本研究求解 DHC 的排程與指派問題，也是採用逐步求解(serial methodology)
的解題架構。亦即先求解指派問題，再求解排序問題。如前所述，指派的決策是
一績效評估機制，排序問題是一最佳解的搜尋機制。本研究是採用 Boyer 所提出
的 DS 法則[30]當指派的決策，本章擬說明此 DS 法則，以下先說明符號和演算
法流程，其次舉例說明此演算法。 
 
指標與變數: 
任務指標: i  (1 ≤ i ≤ n) 
機器指標: j  (1 ≤ j ≤ m) 
Fj : 就目前已經指派在機器 j 上的任務，預估機器 j 的總完成時間 
Fij = Tj : 若將新任務 i 指派在機器 j 上，預估機器 j 的總完成時間 
T = max(F1,…..,Fm) ：指派新任務後，預估程式總完工時間 
∆ij : Fij- Fj，若新任務 i 指派給機器 j，機器 j 預估完成時間的增量 
 
茲將 Boyer 文獻中 DS 法則的演算法敘述於下。此演算法輸入參數包括一給
,( , )
[ ( ), ( )]
( ) ( ), ( , ) 0
i k
i k
i k
D
CommTime t t
R H i H k
if H i H k then CommTime t t
=
= =
 28
表 5.1 異質專案排程之染色體表達與解讀 
索引(index) 1 2 3 4 5 6 
基因(gene) t1 t6 t5 t2 t4 t3 
 
適應函數是用於表達各染色體解的品質，以決定其下一世代的存活率。解的
品質越好，染色體存活率越高。產生的染色體經由派工方法 DS 計算出的程式總
完工時間 T，作為適應值(fitness value)。最小化目標式，其適應函數如下： 
適應函數:   T = max (F1,…..,Fm) 
 
5.3.2 初始母體產生法 
因為任務之間有執行順序限制，染色體基因不可以隨機的指派。為了產生好
的染色體，我們採用 PSGA 的優點，根據問題特徵去求得 b-level 和 t-level 等數
值，以產生任務的優先值(task priority value)，敘述如下。 
 
(A)計算 b-level: 
b-level為任務ti到最後一個任務的最長關鍵路徑長度，因此每個任務ti的
b-level被DAG的所限制，因此越前面的任務所需的旅行路徑越長，其b-level通常
較高。每個任務ti的b-level計算為在各機器平均執行時間AvgE(ti)加上與最長
(longest)的子任務tj (child task)的b-level和傳輸時間CommTime(ti, tj )。根據DAG由
下往上計算每個任務ti的b-level，若任務ti沒有子任務tj其b-level為其平均執行時間
AvgE(ti)。b-level的計算流程如下: 
 
Procedure b-levels( ): 
Construct a reverse topological order list (RevTopOrdList) of tasks. 
for each task ti in the RevTopOrdList do begin 
max = 0; 
for each child task tj of task ti do begin 
if  ( CommTime (ti, tj ) + b-levels(tj) > max ) then 
max  CommTime (ti, tj) + b-levels (tj) 
endif; 
endfor; 
b-levels (ti )=ٛ AvgE(ti) + max 
endfor; 
 
(B)計算 t-level: 
另外我們還要計算每個任務的 t-level，t-leve(ti)為 entry node 到達任務 ti的最
長距離，因此可以判斷任務 ti的最早開始時間。t-level(ti)為父任務(parent task)的
t-level(tk)與父任務的傳輸時間 CommTime(tk, ti)加上父任務的執行時間 AvgE(tk)。
 30
5.3.3 產生新染色體的共識因子 
傳統的基因演算法對於產生新的染色體一般採用的演化技術(evolutionary 
techniques)例如:單點交配(one-cut crossover)，通常採用隨機兩個染色體區段交
配，在這有相依關係的問題中，有時反而會產生不好的解，甚至會有不合理解，
交配的過程中並不考慮上一代好的基因，而盲目搜尋(blind search)。我們主要提
出這共識因子(consensus operator)，希望可以根據上一代好的染色體中尋找資
訊，建立一個導引(guided)機制，根據這引導機制讓好基因順序保留，不好的基
因順序則自然淘汰，以產生好的染色體，敘述如下。 
 
(A)共識因子產生方式 
共識因子產生方式主要分為三個步驟: 
 
Step 1: 建立一個共識池(consensus pool) S 
為了讓取得的資訊不會陷入局部解(local trap)，我們從母體 p(t)隨機抽取一半
的染色體放進我們建立的共識池 S 裡。 
 
Step 2: 建立引導機制:對偶優先矩陣 PWP_matrix(pair-wise priority_matrix ) 
本研究提出這引導機制:對偶優先矩陣 PWP_matrix; M，初始為一個 0 矩陣(n × n 
matrix ，n 為任務的個數)，從共識池 S 中每條染色體，藉由 PWP_Chromosome
流程去計算任務之間的優先關係矩陣 A，形成新矩陣 M (M=M+A)，如圖 5.5 所示。
其中 PWP_Chromosome(Xk)流程，Xk代表輸入的染色體，我們初始一個任務優先
關係矩陣 A=[aij]，(1≤ i, j ≤ n)也為 0 矩陣(n × n matrix)只要染色體 Xi中，任兩任
務 ti,tj  任務 ti在任務 tj之前，aij就加 1，流程如下(其中 rank(ti)為染色體的 index，
也為任務的優先順序。 
 
Procedure PWP_Chromosome(X): 
Initialization: matrix A =[aij] = 0   (n × n matrix) 
For  
any two tasks ti and tj in chromosome X , ti ≠ tj  
If  rank(ti ) <  rank(tj ) , then   
aij = aij +1 
endif 
Endfor; 
 32
根據 PWP_matrix 的共識建議，我們可以很清楚任務 ti在任務 tj之前執行的
共識比率。然而機率 1 或 0 為必然任務 ti在任務 tj之前執行或之後執行的比例，
而在母體 p(t)不斷的演化之下，如圖 5.8，我們很清楚可以看出有些 1 或 0 的比
例，經過世代的演化，還是沒有影響，有些卻漸漸演化成 1 或 0。那些不會變化
的 1 或 0 其實就是問題本身的優先執行順序限制，因此為硬性限制(hard 
constraint)。而那些慢慢演化為 1 或 0，都是經過共識因子不斷演化，產生較好
的共識建議，而演化的柔性限制(soft constraint)。因此，我們把這兩種都當作限
制，不能去違背，之後共識因子產生的方式，在有 1 或 0 的限制下，要先判定沒
有 1 或 0 的限制下的合理區塊(feasible region)，在去選取其共識建議。 
 
圖 5.8  PWP_matrix 的硬性限制與柔性限制 
 
Step 3: 根據引導機制 PWP_matrix 產生一個新的染色體 Y 
首先建立一個空集合 Q=φ，與所有任務的集合 X={ti; 1≤i≤n}，Z 為一個很
大的數(例如:Z=100)，隨機抽取任務 qi 從 X 中，因此 X = X-{qi}，而根據
PWP_Matrix 去決定 qi的優先值 h(qi) (稱為 PWP 任務優先值)，把已經有 PWP 任
務優先值的 qi放進 Q 集合中，為 Q = Q ∪ {qi}，直到抽取到 X 為空集合才停止。
而新的染色體可以根據每個任務 qi的 PWP 任務優先值去排序產生，PWP 任務優
先值越小任務的順序越前面，如圖 5.9 所示的例子中，排序為 q2Æq3 Æq1 Æq4。 
 
 
 
 
圖 5.9  PWP 任務優先值去排序: q2Æq3 Æq1 Æq4 
演
化 
為 hard constraint 
機率演化
為 1，任務
5一定會在
任務 3之前 
0 
Z h(q1)=50h(q3)=30h(q2)=10 h(q4)=70 
 34
茲以一釋例說明如何決定 h(qi)，如圖 5.10 所示，在已知 Q={q1, q2 , q3, q4}，
Qh={qk| hs≤ h(qk) ≤ he, qk∈Q}下，若要插入任務 q5，決定 h(q5)。第一步驟:先決定
h(qi)合理區域為 hs= h(q1)，he= h(q4)。第二步驟:為了尋找參考任務 qr，根據(1)(2)(3)
式，可以求得 r=q2。第三步驟:根據 q2做伯努力(Bernoulli)試驗，如果失敗，h(q5) 
> h(q2)。第四步驟:合理區域更新為 hs = h(qr)= h(q2)。第五步驟: n(Qh) = 2，停止
搜尋，h(q5)=( h(q2)+ h(q4) )/2，q5插入在 q4和 q2之間。 
 
 
 
 
 
圖 5.10  選擇參考任務 qr 
 
(B)調整共識因子影響力 
   從實驗發現，由共識因子所產生的染色體，強烈的被 PWP_matrix 所主導，
導致所產生的染色體容易陷入局部解當中，為了改進這個缺點，我們希望任務順
序可插入的地方可以大幅跳躍，因此我們針對任務 qi對於參考任務 qr的共識比
例 p，乘以一個降級因子 r (degrading factor)，0 < r < 1，讓任務 qi比較不會照原
本抽取的染色體排列順序排列，因此我們在共識因子中設計了兩種方式去產生新
的染色體，ㄧ種是原本的共識因子 P1=p，產生母體 P(t)* C1條染色體;另一種為
降級的共識因子 P2=p*r，產生母體 P(t)* C2條染色體。 
 
5.3.4 選擇染色體形成新母體的方法 
母體 P(t)之染色體數目 Np 加上經由共識和降級共識所產生的新染色體數目
後，共有 f = P(t) *(1 + C1 + C2) 條染色體，此 f 條染色體放在一集合 Sp，選擇策
略就是從此集合 Sp選出 Np條的染色體放置於母體 P(t+1)中。本文將以 rank-space
演算法。求解，其步驟如下： 
 
步驟一：根據染色體之適應函數值遞減排序，依照排序結果給定一個 Zi 品質序
(quality-ranking)，表示為 Rq(Zi)。假設排序後結果為 Z1, Z2, … , Zf。 
步驟二：將品質序第一的染色體從 Sp移到 P(t+1) 
        Sp = Sp – {Z1}； 
        P(t+1) ←  {Z1}； 
        Y1 = Z1； /* 將放置在 P(t+1)的染色體命名 */ 
        N = 1； /*計算放置在 P(t+1)的染色體總數 */ 
0 Z 
Feasible region
h(q4) h(q2) 
0M(q5,qr) 
M(qk,q5) 
he hs 
h(q3) h(q1) 
1 0.8
1 0 
0.1
0.2 0.9
 36
產生 12 種模擬情境根據 100 任務 20 個機器，每個模擬情境根據 DAG 與 machine 
list 組成。DAG 分為不同相依關係程度；任務的異質度程度、機器的異質度程度
和機器是否有一致性(consistent)特性所產生的期望執行時間矩陣 E(machine list)。 
 
本研究把我們提出的演算法和最近幾年提出的演算法 RS、RSGA 和 PSGA
做實驗比較，在小 case 的題目中，幾乎所有方法都可以求解到最佳解，因此我
們把焦點放在大 case 的題目中，在十二個模擬情境，根據 20 個機器組成的 DHC
和 100 個任務的 DAG，其結果見圖 5.11 ，從結果中，共識因子為基礎的演算法
比其他兩者演算法有顯著差異。 
 圖 5.11  實驗結果 
以RSGA為基準，四種方法比較
-5.00%
0.00%
5.00%
10.00%
15.00%
20.00%
25.00%
30.00%
35.00%
1 2 3 4 5 6 7 8 9 10 11 12
情境
績
效
作者GA
PSGA
RS
 38
參考文獻 
 
[1] 巫木誠、盧威豪、吳佳恩「物料報廢架構及物料報廢準則產生方法」，中華
民國發明專利（證書號數：I323427）  
[2] 巫木誠、陳德珊：「基板排序派工之方法」，大韓民國專利，(證書號數：
10-0816624)  
[3] 巫木誠、陳德珊：「基板排序派工之方法」，中華民國專利，(證書號數：
I315476)  
[4] 巫木誠、吳政翰：「相依排程之派工方法」，中華民國發明專利（證書號數：
I313437） 
[5] S.D.P Flapper, J.C. Fransoo, R.A.C.M. Broekmeulen, K. Inderfurth, “Planning 
and control of rework in the process industries: A review,” Production Planning 
and Control 13 (1), pp. 26–34, 2002. 
[6] N. Geren and E. K. Lo, “Equipment selection, integration and interfacing of a 
robotic PCBA component rework cell,” Comput. Integr. Manufact. Syst., vol 11, 
no. 1-2, pp. 77-89, 1998. 
[7] N. Geren and A. Redford, “Automated rework of printed circuit board assemblies: 
Methods and procedures,” Int. J. Comput. Integr. Manufact., vol. 9, no. 1, pp. 
48–60, 1996. 
[8] N. Geren and A. Redford, “Cost and performance analysis of a robotic rework 
cell,” Int. J. Prod. Econ., vol. 58, pp. 159–172, 1999. 
[9] N. Geren, “Determination and Comparison of Surface Mount Component Rework 
Cycle Times of Manual and Fully Automated Robotic Rework Stations for 
Rework Technology Selection,” IEEE Transactions on Electronics Packaging 
Manufacturing, vol. 26, No.2, April, 2003. 
[10] M. R. Driels and J. S. Klegka., “Analysis of alternative rework strategies for 
printed wiring assembly manufacturing systems,” IEEE Trans. Comp., Hybrids, 
Manufact. Technol., vol. 14, pp. 637–644, Sept, 1991 
[11] S.D.P. Flapper, R. H. Teunter, “Logistic planning of rework with deteriorating 
work-in-process,” Int, J. Economics 88 pp. 51-59, 2004. 
[12] A. M. Zargar, “Effect of rework strategies on cycle times,” Computers and 
Industrial Engineering 29, pp. 239-243, 1995. 
[13] J. J. Liu, P. Yang, “Optimal lot sizing in an imperfect production system with 
homogeneous reworkable jobs,” European Journal Operational Research 91 (3), 
pp. 517–527, 1996 
[14] G. K. Tay, D. P. Ballou, “An integerated production-inventory model with 
reprocessing and inspection,” International Journal of Production Research 26 
(8), pp. 1299-1315, 1988. 
[15] C.-C. Chern, P. Yang, “Determining a threshold control policy for an imperfect 
production system with rework jobs,” Naval Research Logistics 46, pp. 273–301, 
1999. 
[16] K.C. So, C. S. Tang, “Optimal batch sizing and repair strategies for operations 
with repairable jobs,” Management Science 41 (5), pp. 894-908, 1995. 
[17] Daigle, P. Powell, “Manufacturing scrap reduction team,” IEEE/SEMI Advanced 
Manufacturing Conf., pp.230-231, 1996. 
[18] M. E. Kuhl, G. R. Laubisch, “A Simulation Study of Dispatching Rules and 
參加 APIEMS2009學術會議出國報告書 
巫木誠  
國立交通大學工業工程與管理系教授 
2009-12-17 
 
本人此次參加 2009年APIEMS(Asia Pacific Industrial Engineering & Manaagement 
Systems Conference)會議是在日本北九市(Kitakyushu)小倉區(Kokura)的國際會議
舉行，會期是從從 2009年 12月 14日-16日。 
 
這次 APIEMS會議是第 10屆會議，參加人數越來越多，此次會議約有 400人參
加，最主要是日本、韓國和我國，其他國家如泰國、菲律賓、香港、馬來西亞、
大陸都有學者參加，看起來，這個學術會議對工業工程領域的重要性越來越大。 
 
本人目前擔任 APIEMS Board Member(理事)以及 IFPR-Asia region Board Member 
(理事)，此兩個理事會亦在 2009APIEMS會議期間舉行。在此次 APIEMS理事會
中，通過我國台科大廖慶榮教授為 APIEMS的理事。在此次 IFPR-Asia理事會中，
江行全教授推薦我國東海大學黃清印教授擔任下屆 IFPR-Asia 的理事長 
(President-Elect)，此提案獲得多位教授支持，將於 2010年 10月於馬來西亞主辦
的 APIEMS會議期間正式確認。 
 
此次 APIEMS 會議有兩個主題演講(Keynote Speech)。第一個主題是 Lean 
Manufacturing，由工業界資深顧問 Mr. Michel Baudin 主講，他認為 Lean 
Manufacturing主要的核心概念是在 Shop Floor Design & Control。第二個主題是
Supply Chain Network & Advanced Planning Systems，由柏林工業大學(Technical 
University of Berlin) 的 Prof. Hans-Otto Günther主講，他提出一個相當令人省思
的觀點：目前 APS商用軟體的績效與工業界的期待，還頗有落差，可見 APS領
域尚有學術研究的空間。 
 
本人此次報告的論文是歸屬「半導體製造管理」領域，被分配在半導體製造（編
號 TA-H1）的場次報告，並受邀擔任主持人(Session Chair)。個人覺得半導體產
業的良率改善(yield improvement)問題頗為韓國工業工程學界所重視，他們產學
合作相當密切，所發表的論文通常都有真實案例，此點頗值得我們學習。我國半
導體、LCD、太陽能電池、LED 等產業，在新製程導入時都有良率問題，我國
學者在產學合作尚應該可很大的參與空間。 
 
另外，此次會議，讓本人印象較為深刻的其他學術論文研究主題有三 
(1) 利用賽局理論(Game Theory)訂定買賣雙方的交易合約(Trading Contract) 
(2) 利用 Data Mining協助醫學診斷或評估開刀風險 
(3) Supply Chain的 Risk Management 
96年度專題研究計畫研究成果彙整表 
計畫主持人：巫木誠 計畫編號：96-2221-E-009-034-MY3 
計畫名稱：新產品/製程導入情境下 TFT-LCD 產業的製造管理 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 3 3 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 0 4 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 1 1 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 11 0 100%  
博士生 1 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
 
