1 
行政院國家科學委員會專題研究計畫成果報告 
彩色印刷機隨線自動光學檢測系統之開發 
Development of In-line Automatic Optical Inspection System 
 for Color Printing Machines 
 
計 畫 編 號：NSC 96-2221-E-216-042 
執 行 期 限：96 年 08 月 01 日至 97 年 07 月 31 日 
主 持 人：邱奕契 副教授 中華大學機械工程學系 
共同 主持 人：無    
計畫參與人員：高祥恩、劉建宗  中華大學機械工程研究所 
 
一、中文摘要 
 消費者總是先被產品的標籤給吸引，因
此標籤的印刷品質影響公司的形象甚深。隨著
印刷速度的提升，快速印刷品質的確保益形重
要。本研究運用機器視覺技術對彩色標籤之印
刷品質進行檢測。檢測方式分兩階段進行：(1)
色彩檢測，(2)套色位置檢測。第一階段之色
彩檢測採用灰階平均值比對法檢查印刷之顏
色，目標是找出印刷顏色不正確的標籤。第二
階段之套色位置檢測採用正規化相關係數法
(Normalized correlation coefficient)，檢查金標
籤及待測標籤之相似度，目標是找出印刷圖樣
位置偏移之標籤。本研究以 231 張彩色樣本標
籤進行測試，結果顯示在光源變化不大的條件
下，瑕疵檢出率可達 90.19%。此結果驗證了
本研究所提出之檢測方法的可行性。 
關鍵詞：標籤檢測、瑕疵檢測、色彩比對、正
規化相關係數法。 
Abstract 
Customers are always attracted by a product’s 
label first. As a result, the printing quality of a label 
deeply affects a company’s image. As the printing 
speed increases, the importance of fast printing 
quality assurance increases. In the present study, we 
applied machine vision technique to inspect printing 
quality of color labels. The inspection was carried 
out in two stages: (1) Color Inspection and (2) 
Registration Inspection. The first stage applied 
grayscale mean comparison method to check 
printing colors. The object is to detect labels with 
incorrect printing colors. The second stage applied 
normalized correlation coefficient to check the 
similarity between golden label and test label. The 
objective is to detect labels with misplaced printed 
pattern. We used 231 samples to test the proposed 
methods. The experimental results show that under 
the certain circumstances that the variation of 
lighting is insignificant, the flaw detection rate can 
reach as high as 90.19%. The results prove the 
effectiveness of the proposed inspection methods. 
Keywords: Label Inspection, Flaw Detection, Color 
Comparison, Normalized Correlation Coefficient 
二、緣由與目的 
    傳統上，印刷業大多以人眼來判定顏色及
管理顏色，但是受到光源、工作環境及人眼彼
此間差異的影響，往往使得人眼辨色變得不可
靠，因而必須藉助儀器進行色樣的量測及顏色
的管理。目前市面上所用的濾鏡式色差計，已
逐漸被更先進的分光光度儀所取代，主要是因
為色差計無法克服機器彼此間的交換性以及
長時間下自身的穩定性等問題。然而分光光度
儀也只能對顏色進行量測，並無法對印刷位置
做檢測。因此有必要發展一種能夠同時對色彩
及印刷位置進行把關的檢測法。 
實地參觀標籤印刷生產線時發現，印刷品
質的檢測目前還是以人工目檢為主。在高頻閃
3 
像，並抽取其 R、G、B 三個色彩分量。接下
來將影像分割成 n×m 個子區域。完成分割後，
利用自行設計之灰階平均誤差度演算法進行
色彩的檢測，未通過即視為瑕疵品，否則進行
下一步的套色位置檢測。對於套色位置的檢
測，本研究採用正規化相關係數法。通過套色
位置檢測者為良品，反之為瑕疵品。色彩與套
色位置檢測所使用之方法及原理詳述如後。 
 
 
圖二、標籤檢測流程 
 
 
圖三、分割區域數量-誤判率之曲線圖 
 
3.2. 建立子區域 
為了提高檢測的精確度，先將影像分割
成一些較小面積的子區域[5]。分割的數目及
子區域的大小，使用者可自行設定。一般說
來，長寬尺寸差異不大的標籤，可分割成 4x4
個子區域，例如「維他露 P」、「益菌多」、及
「黑糖沙士」。至於長寬尺寸差異較大之標
籤，則分割成 5x4 個子區域，例如「御茶園」。
為了解那一種分割方式可得到最佳的結果，
本研究就 2×2、3×3、3×4、及 4×4 等四種分
割方式進行探討。圖三所示為分割方式與平
均檢測誤差率之關係圖。觀察圖三可知，誤
判率明顯地受分割區域數量的影響，其中以
3x4 分割法之曲線最為平滑，平均檢測誤差
約為 10%，屬於最理想的分割法。因此本研
究將以 3x4 的分割方式，分別對這 12 個子區
域進行檢測。 
 
3.3. 色彩檢測原理 
在色彩檢測上，Wilson 等人[6]利用 CIE 
Lab 色彩模型計算 Delta E，以檢查顏色是否
正確。 
222 baLE ∆+∆+∆=∆  (1) 
本研究檢測色彩的基本原理是比較待測影像
與金標籤影像 R、G、B 分量之相似程度，如
果色彩差異超過設定之門檻值代表待測標籤
具有色彩上的瑕疵。檢測前首先擷取金標籤
之 RGB 彩色影像；接著計算各子區域之 R、
G、B 灰階平均值，方式如下： 
∑∑
= =
×
=
m
i
n
j
gg jif
nm
f
1 1
),(1)(µ ; BGRf ,,=  (2) 
5 
亦即這兩張影像的相關係數不可能是 1（相
似程度不可能達到 100%）。為了避免過多的
假警報，有必要設定一個門檻值，當待測標
籤與金標籤的相似程度大於這個門檻值即可
視為無瑕疵。目前門檻值設為 70%；當相似
度大於 70%即為合格區（在該區以綠色顯示
其相似度）；相似度小於 70%即為不合格區
（在該區以紫紅色顯示其相似度）。統計結果
顯示，當紫紅色區域數大於綠色區域數即屬
套色不良的標籤。在此將套色位置的檢測分
成下列三個步驟來說明： 
I. 計算待測標籤與金標籤各子區域之相
關係數。 
II. 若相關係數之值小於 70%，則該子區
域套色異常區，以紫紅色標記；反之，
以綠色標記。 
III. 紫紅色標記區的總數大於綠色標記區
的總數，則該標籤視為不合格。 
 
3.5. 實驗設備與材料 
本研究採用 1394 介面之 Pixelink 彩色攝
影機，在大約 23 公分的工作距離（攝影機鏡
頭前端與標籤之距離）下，搭配 LED 環形光
源的照明進行取像，取像大小為 640×480 像
素。測試用之樣本標籤共 231 張，包括「維
他露 P」78 張，「御茶園」40 張，「益菌多」
70 張，及「黑糖沙士」43 張。 
 
四、結果與討論 
本研究利用 Borland C++ Builder 撰寫檢
測程式，程式畫面如圖七所示。檢測前所需
設定之檢測參數包括色彩之容許誤差度及相
似度。實際檢測時，利用攝影機擷取待檢測
標籤之彩色影像後，依據圖二所示之流程進
行檢測。本研究目前是以離線的方式進行檢
測，色彩比對之容許誤差度及相似度之容許
值分別設為 15%及 70%。實驗結果顯示，在
光源變化不大的環境下檢測率可達 90.19%。 
以下就上述四類標籤之檢測結果做說明。 
 
圖七、檢測程式畫面 
 
4.1. 益菌多檢測結果 
 
益菌多的檢測方式是將整張影像分割成
12（3×4）個子區域數。色彩檢測時 R、G、
B 之 GSME 容許值皆設為 15%，當顏色異常
區超過三個即視為瑕疵標籤；反之，繼續進
行套色位置檢測。套色位置檢測時之相關係
數門檻值設為 70%，大於等於 70%者視為合
格。請參考圖八，右圖中以綠色標示者，代
表該子區域之相關係數超過 70%；反之，以
紫紅色標示者，代表該子區域之相關係數值
低於 70%。由於紫紅色區域數（9 個）超過
綠色區域數（3 個），代表該標籤具有套色位
置不正確的情形，因此被判定成不合格
（NG）。表一所示為益菌多檢測結果之部份
列表。表中未列出 RGB 色彩檢測之數據，主
要是因為益菌多樣本只有套色位置瑕疵樣
本，並沒有色彩異常之瑕疵樣本。 
 
圖八、益菌多樣本檢測結果畫面：左圖為金
標籤影像；右圖為具有套色瑕疵之標籤影像。 
7 
時，綠色區域（正常）有 7 個，大於紫色區
域（異常）數，因此被判定為合格。 
 
表三、御茶園樣本檢測結果 
樣 
本 
綠色區域數/ 
相似度(%) 
R 
個數 
G 
個數 
B 
個數 
檢測 
結果 
1 2/79.83~80.56 1 0 1 NG 
2 3/75.27~89.31 1 0 1 NG 
3 3/73.78~88.05 1 0 1 NG 
4 3/73.84~88.54 1 0 1 NG 
5 3/73.99~82.48 1 0 1 NG 
6 7/79.79~96.48 0 0 0 GO 
 
4.4. 黑糖沙士影像檢測結果 
檢查黑糖沙士標籤的方式與前面幾種標
籤的檢查方式相同。相似度之容許值一樣是
設成 70%。然而，實驗發現出現在黑糖沙士
標籤上的色彩瑕疵其顏色與背景顏色之差異
不大，15%的 RGB 平均灰階誤差度並無法順
利偵測出色彩瑕疵。因此檢測黑糖沙士標籤
時，RGB 平均灰階誤差度設為 10%。檢測結
果如圖十一及表四所示。從圖十一之檢測結
果可以發現，未通過 RGB 色彩檢測者共有 5
區（2R3G），數目超過 3 個，因此被判定為
具有色彩上的缺陷。 
 
 
圖十一、黑糖沙士樣本檢測結果畫面：左圖
為金標籤影像；右圖為具有色彩瑕疵之標籤
影像。 
表四、黑糖沙士檢測結果 
樣
本 
綠色區域數/ 
相似度(%) 
R 
個數 
G 
個數 
B 
個數 
檢測 
結果 
1 3/72.55~91.64 3 1 0 NG 
2 5/70.33~88.76 2 0 0 NG 
3 4/77.31~97.25 3 2 0 NG 
4 4/77.63~97.26 2 4 0 NG 
5 4/71.29~97.04 2 5 0 NG 
6 8/71.89~98.94 0 0 0 GO 
 
4.5. 討論 
在程式中並不將這兩種瑕疵的檢測結果
做分類，只是在檢測程式流程中根據這兩種
瑕疵的先後做判讀步驟，一旦有一個判讀步
驟為瑕疵即不再進行判讀。觀察上述檢測結
果可以發現，將 GSME 及相似度之容許值分
別設為 15%及 70%，可順利對「維他露 P」、
「御茶園」、及「益菌多」這三類樣本進行檢
測。然而，由於出現在「黑糖沙士」上的色
彩瑕疵與標籤本身之顏色較為相近，檢測時
必需將 GSME 之最大容許值由 15%降至
10%，才不致於產生誤判。有鑑於以色彩為
基之相關係數法對色彩之敏感度不如預期，
本研究改採以灰階為基之相關係數法進行套
色位置的檢測。至於可能發生之色彩瑕疵則
以自行研發之 RGB 灰階平均誤差度檢測
法，進行色彩的檢查。 
圖十三所示為本研究所建構完成之捲動
式彩色印刷品自動光學檢測系統。系統採用
1394 介面之 Pixelink 彩色攝影機，實際測試
所得之取像速度每秒大約 16 張（擷取一張約
需60 ms）。印刷機的速度最高可達每分鐘120
公尺，或每秒 200 公分。以 12 cm 的標籤來
說，一秒大約可以檢查 192 公分。以現有之
設備要達成全檢是不可能的。幸運的是，當
印刷出現錯誤時，通常不會只是一張出現瑕
疵，而是一連串的標籤都會出問題，換言之
抽檢也是可以達到品質把關的目的。 
