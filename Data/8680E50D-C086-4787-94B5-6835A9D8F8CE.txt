 數位家庭助理之研究與實作(2/3) 
Research and Implementation of Digital Home Assistants 
計畫編號：NSC－94－2213－E－004－010 
執行期間：94 年 08 月 01 日至 97 年 07 月 31 日 
計畫主持人：陳良弼 
執行單位：國立政治大學資訊科學系 
 
Keyword: Multimedia, Stock analysis, 
Querying, Indexing, Adjustable Distance 
Function 
中文摘要 
為了達成實作數位家庭助理的目
的，本計劃致力增進兩大類的技術。一為
多媒體與跨媒體處理技術，另一為股票分
析技術。在多媒體與跨媒體處理技術方
面，不同於去年我們分別就音樂和影像做
處理，今年，我們開始發展在不同媒體環
境下都能使用的技術。主要有多媒體高維
索引(high dimensional index)技術和多媒
體 可 調 整 距 離 函 式 (adjustable distance 
function)查詢技術兩方面。由於我們第三
年想要完成的系統是橫跨影像與音樂兩
大媒體，而這兩項技術都與媒體種類無
關，因此都可以被使用在第三年所要做的
系統上。另外，在股票分析方面，我們利
用不同股票之間的關聯來預測股價未來
的走勢，以幫助使用者進行家庭理財。 
一、前言 
本子計劃的數位家庭助理希望能為使用
者提供兩方面的幫助，一個是在家庭娛樂
方面，一個是在家庭理財方面。在家庭娛
樂方面，由於計畫的主要目的是希望能在
第三年建立出家庭式 KTV 個人化背景影
片播放系統，而這個系統需要整合影像與
音樂兩個不同種類的媒體。因此，在今年
我們致力完成兩項可使用在各種媒體的
技術，一是多媒體高維索引技術，另一是
多媒體可調整距離函式查詢技術。由於多
媒體資料所對應的特徵空間其維度通常
很高，因此一個良好的多媒體高維索引技
術能加速對於多媒體資料的處理，以縮短
使用者的等待時間。再者，使用者可能會
想要下達不同語意(semantic)的查詢，而為
了表達不同的語義，每一次查詢所使用的
距離函式可能會不同。因此，我們發展了 
關鍵詞：多媒體、股票分析、查詢、索引、
可調整距離函式 
英文摘要 
To implement digital home assistants, 
our project makes efforts in two kinds of 
techniques. One is the multimedia and 
cross-media processing technique. The other 
is the stock analysis technique. For the 
multimedia and cross-media processing 
technique, we developed a high dimensional 
indexing technique and a search technique 
with an adjustable distance function, which 
can be used in various media. Since the two 
techniques are media independence, they 
can be used for implementing the system 
which combines two media: image and 
music in the third year. Moreover, for the 
stock analysis, we utilized the relationship 
between different stocks to predict the stock 
trends. 
多媒體可調整距離函式查詢技術來滿足
使用者的需求。由於這兩項技術都與媒體
種類無關，因此都可以被使用在第三年所
要做的系統上。而在家庭理財方面，我們
發展了股價關聯分析及未來走勢預測的
方法。透過分析不同股票之間的關聯，我
們找出在時序性上具有共同趨勢的股票
來幫助預測股票未來的走勢。這些資訊將
提供給使用者作為買賣股票的參考，進而
達到幫助家庭理財的目的。 
二、研究目的 
以下茲就多媒體高維索引、多媒體可調整
距離函式查詢與股價關聯分析及未來走
 1
 法，因此，距離導向索引方法的計算量是
跟維度無關 (dimensional independence)
的。但是，因為距離導向索引方法將距離
的資訊過度壓縮，因此維度一高的時候，
整個刪剪的效果會很差，甚至有可能無法
刪剪掉任何點。 
多媒體可調整距離函式查詢 
度量空間中的索引結構已經被廣泛
地探討過了，[8]中討論了許多有效的解決
方案。這些索引結構只需要知道任兩點之
間的距離，而不需要知道距離如何被計算
的細節。[6]提出了M-Tree這個索引結構，
並且提供了M-Tree上的範圍查詢 (range 
query)及k最近鄰點查詢。這個索引結構後
來被許多研究所引用。 
上述在度量空間的搜尋演算法，在建
立索引結構時都必需先指定一個距離函
式，而在查詢時必需使用相同的距離函式
查詢。[5]首次探討了每次查詢時都可以使
用不同距離函式的演算法，其中定義了兩
種不同的距離函式。用來建立索引的距離
函 式 ， 被 稱 為 索 引 距 離 函 式 (index 
distance)。而使用者查詢時所下達的距離
函 式 ， 稱 為 查 詢 距 離 函 式 (query 
distance)。並基於這樣的條件下發展了範
圍查詢與k最近鄰點查詢的演算法。[4]延
伸了這個方法，在索引結構中記錄了一些
額外的資訊以達到加速的目的，但距離函
式被線性組合(linear combination)所限制。 
近年來，反向最近鄰點查詢是一個相
當受
勢預測
關注的議題。大部份的演算法是為了
歐吉里德空間(Euclidean distance)上的查
詢所設計的[13][14]。然而最近，度量空間
上的反向最近鄰點查詢也開始受到重
視。[1]提出了基於預先計算的反向最近鄰
點查詢演算法。[15]整理了M-Tree的許多
特性，定義了一個不需預先計算的反向最
近鄰點查詢演算法。 
股價關聯分析及未來走  
在過去的
文獻
相組
）利用技術指標的數值變化搭配
人工
有群體效應，在[16]的
媒體高維索引、多媒體可
調整
合來作為買賣策略的依據，組合的指
標顯示為多頭時作買進，顯示為空頭時作
賣出。 
（二
智慧，如類神經網路演算法[7][10]，
算出最有效的數值變化當作買進與賣出
的訊號，也可視為動態的技術指標組合，
每日要使用的組合指標要經過人工智慧
的方法來求出。 
 考慮到股票會
研究中提到，股票之間會有互相影響的關
聯，例如聯電上漲時，台積電與矽品都上
漲的機率相當高，利用股價的同漲同跌來
作為兩兩之間的關聯度分析，並且延伸到
群體同漲同跌的機率關係。 
四、研究方法 
以下茲就多
距離函式查詢與股價關聯分析及未
來走勢預測等主題說明本計畫於今年度
所提出之研究方法： 
多媒體高維索引技術 
根據文獻探討中的分析，我們選擇以距離
le 
 
的資訊，來
導向索引方法為基礎，來設計我們的索引
方法，主要是因為距離導向索引方法的計
算量是跟維度無關的，因此較能克服高維
空間所引發的問題。我們希望設計出來的
索引方法能被使用在常用的查詢方式，
如：k 最近鄰點查詢或是範圍查詢等。 
 我們採用 [2]所提出的MRP(multip
reference points)方法。一開始，先從所有
點中選擇幾個點來當成參考點，並且將每
個點與這些參考點計算距離。以 
Table 1為例，我們選擇g和h兩個點當作參
考點，而所有其他點都與此兩點算距離，
並將結果記錄在如Figure 1的B+-tree中，以
加快存取的速度。 以下，當給定一個查詢
時，我們以最近鄰點查詢(nearest neighbor 
query)為例，來說明我們的索引方法。主
要可以分成下列兩步驟： 
步驟一：找尋近似最近鄰點對於股價變化之關聯法則，探討中，技術指標常被用來當作預測
未來股價變化的工具，方法可分為兩類。 
（一）利用多種技術指標[9][18]，互
 我們使用B+-tree中所記錄
快速的求取一個近似的最近鄰點。我們的
主要想法是，如果兩個點很近，那麼他們
 3
 之最大差距，而推導出r點在查詢距離下的
可能位置(即黃色環的範圍)。由此我們可
以得知dq(r,q)的最小可能值，若已找到k個
點比r更接近q，則r可以被刪剪。 
 
Figure 2. K 最近鄰點查詢範例 
使用者自訂距離函數之反向 k 最近鄰點查
詢 
此部分與 k 最近鄰點查詢的建立索引
引結構可以應用在這
兩種
算法能夠做到在
函數的反
向k最
方便，我們以一般
的歐
 
Figure  反向 K 鄰點查詢  
假設 p 為目前試圖刪剪節點
之
步驟一：建立索引 
方式相同，一樣的索
不同型態的查詢。 
步驟二：反向 k 最近鄰點查詢 
目前沒有其他的演
度量空間下，由使用者自訂距離
近鄰點查詢。我們的反向k最近鄰點
查詢演算法是基於[15]，並且對其六項刪
剪規則做出修正，使得我們的演算法可以
處理這一種查詢。 
我們的方法可以在度量空間中運
作，但是，為了舉例的
吉里德空間為例，如下圖： 
 3. 最近 範例
q 為查詢點，
中心。該節點在索引函數下的覆蓋半徑
(即實線圓內範圍)已被記錄在索引結構
中。根據索引函數及查詢函數間的關係，
我們可以算出該節點在查詢函數下最大
的覆蓋半徑 r(即黃色圓的範圍)。假設該節
點內的資料點數大於 k，該節點內所有資
料點在 2r的距離都會至少存在 k個其他資
料點。若 dq(p, q)>3r，根據三角不等式，
該節點中的任何資料點與 q 的距離皆大於
2r(如距離 q 最近的點 t，與 q 的距離大於
2r)，且已知有其他 k 個資料點比 q 更接近
該資料點，故該節點可以成功地被刪剪。 
股價關聯分析及未來走勢預測 
在文獻[16]中，是以同時間的關聯作r 
研究，而且是以一季作預測時間單位，所
以並
關聯度，並且考慮了時
間延
算方
式，考慮所有兩兩股
布，訂出高度關聯的
thres
oogle[3]在判斷網頁重要性的
推薦值的計算
無法達到預測的效果與買賣的動
作。因此，我們考慮分別使用技術指標與
股價變化來計算股票之間的關聯度，並且
以隔Ｎ天的股價走勢作為研究目標，利用
求出的關聯度來發展出個別股票的買進
與賣出推薦值。 
我們透過技術指標與股價變化來分
別計算股票之間的
遲問題，分別計算延遲一天、三天和
五天的關聯度。例如：A 股票顯示為多頭
時，B 股票在同一天、隔一天、隔三天和
隔五天也會顯示為多頭的個別關聯度,希
望藉由不同時間的延遲結果與不同類型
的關聯度，可以分析出最好的買賣策略. 
關聯度的求法是以條件機率的方法
來求得。Ａ股票對於Ｂ股票的關聯度的計
法是：當Ａ股票在一段時間間隔裡，
由技術指標顯示為多頭的總日數中，Ｂ股
票也顯示為多頭的機率。除此之外，為了
判斷某一股票對其他股票的影響力，我們
提出了兩種推薦值的計算方法，來作為買
進與賣出的依據。 
方法一:機率模式 
以條件機率的方
票之間的關聯度分
hold 值。依歷史資料裡，所有對 A 股
票具有高度多頭關聯性的股票總數作為
條件，以每日加總已成為多頭的高關聯度
股票總數，因而可以計算出 A 股票的當日
買進推薦值與每日賣出推薦值。例如對於
Ａ股票具高度關聯的總股票數有５０
檔，而當天這５０檔股票有３０檔股票顯
示為多頭時，則Ａ的買進推薦值為
30/50=0.6。 
方法二:PageRank 模式 
採取了g
方法而應用在股票之間
p 
q 
t r 
p q >3r 
 5
