 2
仿生四足機器人跨越河石地形的自適性模糊-類神經 
步態規劃與實驗 
 
主持人：鄭璧瑩 
國立交通大學機械工程學系 副教授 
國科會計畫編號：NSC-98-2221-E-009-185 
 
摘要 
 
本研究針對仿生四足機器人將河石地形的形貌辨識與步態規劃的軟硬體系統整合，進行四足機器
人自適性模糊-類神經隨機步態的演算與建立，使機器人在面對非連續式河石地形時可自主與平穩地跨
越。機器人在非連續河石地形的路徑規劃上，本研究採用影像處理等感測元件進行地形樣貌特徵的辨
識與描摹定位，結合類神經演算法、自適性模糊-類神經演算模式(ANFIS)等經由前置步態學習階段建
構的步態模型，即時計算驅動軸運動數據，進而透過控制介面驅動四足機器人跨步穿越河石地形。其
中，在前置步態學習模型的建立方面，應用特徵空間轉換觀念發展修正型的隨機型路徑演算法則的路
徑規劃等，建立一穩定且有效的路徑規劃模式，完成跨越河石地型的最佳步態，發展適合於一般河石
地形等非連續路面的快捷反應的適應控制法則，並以實作的四足機器人系統加以驗證。首先進行敏捷
型足部機構的改良設計，建立四足機器人自適性模糊-類神經隨機步態模型與驅動軸運動數據資料，採
用嵌入式微處理單晶片(如：DSP、BASIC Atom 系列與8051 單晶片組合等)組合而成機器人之控制系
統，將地面之隨機地形影像資料經影像辨識處理後取得行走的河石踏點，並自動轉換為具體實用之伺
服機運動控制路徑規劃，組成機器人之連續行走動作，控制機器人之動作進行實驗來驗證本研究所發
展的路徑規劃的可行性，證實本研究所開發的仿生四足機器人能穩定達成跨越隨機式河石地形的自主
式行走之目標。 
關鍵詞：仿生四足機器人、河石地形、路徑規劃、自適性模糊-類神經演算法 
 
1. 前言 
 
        相較於傳統控制，類神經網路與模糊系統可在不需知道一個系統的數學模式下，便能成功的
估測此一系統的能力。由於兩者均採用數值的方法來解決問題，可以用工程軟體來處理，例如：matlab、
visual c++。在面對多自由度的機械結構，要處理的計算公式相當冗長、複雜，而且幾乎都是非線性
函數，故通常要簡化公式或做些假設，但簡化或假設後的結果與理論值誤差變更大，甚至是不符合實
際狀況，因此簡化和假設是較不可行的。Y. L. FU 等人在[1]中藉由距離感測器測量末端手臂與障礙
物的距離，並和各關節角度變化量一起視為模糊控制的輸入，經過模糊控制規則庫推論(IF-THEN)後，
求得三個關節的扭力，使三連桿手臂在未知環境中成功達到立即(real-time)閃躲障礙物的功能。 K. C. 
Choi 等人在[2]中，將十二個自由度的兩足機器人底部各安裝四個力感測器，藉由感測器量測值，透
過類比數位轉換代入公式求解 ZMP 值，誤差值利用模糊理論補償至最佳，當 ZMP 值落在腳底支撐面上
時，即可順利讓雙足機器人走過斜坡。Ken Onozato and Yutaka Maeda 在[3]中將類神經網路架構應
用至二連桿 SCARA Robot，經過不斷學習架構中參數會慢慢收歛，學習結果成功取代逆向運動學與逆
向動力學的公式；因此，類神經理論可在不知控制的數學函數情況下，也能得到期望的輸出。Bojun Ma 
等人在 [4] 中將 5個自由度的操作手臂與 3個自由度的移動平台結合，在處理多自由度的系統時，必
須面對相當冗長的計算公式，Bojun Ma 等人針對具有冗餘(Redundant)自由度的移動操作臂提出一種
反向運動學求解策略，和兩個假設條件，有效解決冗餘自由度分配的問題，也簡化了複雜的計算公式。 
本研究採用適應性網路模糊推論系統(ANFIS)演算法，以學習和推論的方式近似原本複雜的運動學公
式，使模擬值更接近實際輸出值，並應用之於四足機器人跨越非平坦河石(River-stone)地形之路徑規
 4
將四個矩陣相乘 0A1*1A2*2A3*3A4可推導得末端位置 x、y、z座標的函數 
0A4=0A1*1A2*2A3*3A4                                    (1) 
ANFIS 為 Adaptive Neuro-Fuzzy Inference Systems 的簡稱，是由模糊與類神經網路的節點與特
定函數所構成。本範例首先設定原始學習樣本與學習後的輸出值之差為目標函數，以梯降法(Gradient 
Descent Method)和連鎖律(Chain Rule)為調整的依據，目的在於降低其目標函數之均方誤差，其中歸
屬函數和規則庫都可在學習中得到標準法則。 
步驟如后說明所示： 
1. 以隨機的方式產生 4000 組三個馬達的角度，代入(x,y,z)正向運動學函數，求得其對應的 4000 組
x、y、z 座標，其中 2000 組當作學習樣本，剩下 2000 組當作驗證樣本；馬達一角度範圍-35~110，
馬達二角度範圍-45~45，馬達三角度範圍-90~45。 
2. 建立 ANFIS 架構，本研究利用三個神經網路架構替代反向運動學函數，求解θ1與 z座標無關，
故 anfis1 的輸入只有兩個(x、y)，大量減少了 anfis1 的程式學習時間，而θ2、θ3與 x、y、z
相依，故 anfis2 和 anfis3 的輸入值有三個(x、y、z)。使用 ANFIS 法則運算反向運動學模神經網
路模式，所以架構輸入資料為三軸機械腳參考點的位置座標(x、y、z)，輸出為三軸機械腳三個馬
達的角度值(θ1、θ2、θ3)  (如圖三所示)。  
3. 設定反向運動學函數學習次數 300 次，選用高斯和鐘形為轉移函數(如圖四所示)。其中鐘形函數
a參數影響寬度、b參數影響兩側斜率、c參數影響 x方向偏移量；而對於高斯函數 d參數影響 x
方向偏移量、σ參數影響兩側斜率。                                                         
 
 
 
 
 
 
圖四 鐘形與高斯函數 
4. 若輸出誤差不理想，必須回到步驟 3，利用試誤法不斷嘗試修改參數(學習樣本數、轉移函數種類、
歸屬函數個數、學習次數⋯等等)，直到輸出誤差收斂至可接受時，此架構便能應用至實驗上。 
本節使用誤差公式： 
Error =Σ | ANFIS輸出-D-H理論值 | / 2000; 
 
模擬結果： 
E1=2.85度、E2=1.682度、E3=0.9404度 
驗證樣本總共有 2000 組，圖五僅列出前 20 組驗證樣本與 ANFIS 輸出比較。 
 
2.2 運算時間比較 
本節比較 ANFIS 與反向運動學應用於空間三軸機械腳的電腦程式 MATLAB 運算時間，比較流程如下： 
1. 挑選 2000 組驗證樣本其中 10 組θ1、θ2、θ3，代入正向運動學產生 10 組 x、y、z 座標視為「比
較樣本」。 
2. 使用 D-H理論求解反向運動學函數，給定馬達角度範圍，讓聯立方程式恰有一組解。 
3. 將 10 組 x、y、z 座標分別帶入反向運動學公式和 ANFIS，使用 MATLAB 程式計時指令「tic」和「toc」， 
       
 6
3. 模擬與實驗結果 
3.1 程式流程規劃與模擬結果 
1. 圖七為地形俯視圖，本研究踏步順序為右前腳Æ左後腳Æ左前腳Æ右後腳，搭配靜態 ZMP理論偏
移重心位置，配合踏步順序，偏移重心順序為左後偏移Æ右前偏移Æ右後偏移Æ左前偏移，目的
是將重心位置偏移至支撐腳所形成三角形的斜邊中點往內偏移一公分的位置。 
2. 如圖八所示，建立圖形使用者介面(GUI)，繪製模擬地形，只要使用者使用滑鼠左鍵點選欲前進路
徑，按下 OK 按鈕後可產生前進路徑之座標矩陣(xi、yi、zi)，給定座標後按下 calculate 按鈕，
便可產生相對應的馬達角度數據，如此一來，不需再一一輸入踏點座標，讓操作更方便。 
3. 在圖七地形 C5 的位置設立地面絕對座標(0，0，0)，藉由此固定座標可以推算所有踏點和機身上
移動點的絕對位置座標，將踏點與機身絕對座標相減，求得四足下一步踏點相對機身的相對座標。 
4. 將每個步態機身相對踏點的相對座標，加上實際與模擬之間的誤差修正，再代入學習完成的 ANFIS
求得每個步態所有馬達角度數據。 
5. 將每個循環馬達角度利用 MATLAB 程式匯出.csv 檔，讓馬達控制器讀取後去控制四足機器人，觀
察實驗結果是否如同模擬期望的隨機路徑前進，實驗結果於 3.2 節以圖片表示。 
               
圖七 地形俯視圖                   圖八  四足機器人以ANFIS為架構的自動步態建立 
系統的GUI介面 
3.2 實驗結果 
機器人行走路徑產生說明  
本研究所使用的動作產生程式源自於本實驗室開發之動作理論，但此動作產生程式可隨意鍵入各
踏點高度之矩陣數據的方式取得地形資料與各座標參數讀入 MATLAB 中，直接從讀入的參數轉換並合併
矩陣，這 2組矩陣代表左半側與右半側踏點座標。自動轉換為各足部接頭的動作驅動軌跡，免去人工
輸入的繁雜過程。茲以圖九之隨機河石地形為例，經辨識踏點圓盤位置，並導入 MATLAB 中轉換成矩陣
的結果如圖十所示。 
 
 
 
 
 
 
 
 
 
 
圖九 隨機河石地形範例        圖十 動作產生程式讀入座標轉換矩陣後結果 
 
 8
計畫成果自評 
 
本研究「仿生四足機器人在非連續河石地形的路徑規劃」上，採用影像處理等感測元件進行地形
樣貌特徵的辨識與描摹定位，結合類神經演算法、自適性模糊-類神經演算模式(ANFIS)等經由前置步
態學習階段建構的步態模型，即時計算驅動軸運動數據，進而透過控制介面驅動四足機器人跨步穿越
河石地形。其中，在前置步態學習模型的建立方面，應用自適性模糊-類神經演算模式(ANFIS)等的路
徑規劃對隨機路況進行前瞻式推導與規劃，建立一穩定且有效的路徑規劃模式，完成跨越河石地型的
「穩定步態」。同時，考慮起伏型與斜面型河石地形的步伐規劃，由於須考慮四足機器人傾斜時，機
體重心將嚴重影響機構姿態與動力學問題的求解，本研究結合力學平衡的法則推導與步伐規劃的控
制，發展適合於一般河石地形等非連續路面的控制法則，並以實作的四足機器人系統加以驗證。本研
究製作一套新型四足機器人NC-F4-2009，應用所發展的步態規劃理論，採用微處理器單晶片與I/O介面
板為執行自主行動的控制中心，順利完成仿生四足機器人軟硬體系統，達成機器人自主式跨越非連續
隨機式河石地形的操作控制過程等預期成果目標，符合計畫預期目標。 
 
5. 誌謝  
本研究承蒙 國科會編號NSC-98-2221-E-009-185之計畫經費支援，使本計畫得以順利完成，特此
申致謝忱。  
 
6. 參考文獻  
 
1. Y. L. FU, B. JIN, H. LI, S. G. WANG “A robot fuzzy motion planning approach in unknown 
environments＂. Front. Mech. Eng. China 2006 3: 336□340 
2. K. C. Choi , H. J. Lee and M. C. Lee“Fuzzy Posture Control for Biped Walking Robot Based 
on Force Sensor for ZMP＂. SICE-ICASE International Joint Conference 2006 Oct. 18-2 1,  
3. Ken. Onozato and Yutaka. Maeda “Learning of Inverse-dynamics and Inverse-kinematics for 
Two-link SCARA Robot Using Neural Networks＂. SICE Annual Conference 2007 Sept. 17-20,  
4. Bojun Ma, Yongchun Fang, and Xuebo Zhang  “Inverse Kinematics Analysis for a Mobile 
Manipulator with Redundant DOFs＂ .Proceedings of the 26th Chinese Control Conference 
July 26-31, 2007, Zhangjiajie, Hunan, China 
 
 
 
 
 
 
 10
國科會補助計畫衍生研發成果推廣資料表 
日期： 99年 7 月 29 日 
國科會補助計畫 
計畫名稱：仿生四足機器人跨越河石地形的自適性模糊-類神經
步態規劃與實驗 
計畫主持人：鄭璧瑩 
計畫編號：NSC 98－2221－E－009－185－ 領域：自動化學門
（中文）自主式四足機器人非連續路徑的規劃與控制 
研發成果名稱 （英文）Gait Planning and Control of a Single Chip Based 
Quadruped Robot Crossing a River-stone Terrain 
成果歸屬機構 國立交通大學 發明人 (創作人) 
鄭璧瑩 
（中文）本研究重點為建立一套具有影像式地形辨識與基本
步態規劃功能的自主式跨越非連續河石地形能力的四足機器人軟
硬體整合系統。所建造的四足機器人結合嵌入式單晶片微處理器
與伺服機控制板與12軸伺服馬達的機構模組，完成新型四足機器
人(NC-F4-2009)實作平台。此NC-F4-2009系統採用感測元件輔助進
行地形樣貌特徵的辨識與描摹定位，結合自適性模糊-類神經演算
模式(ANFIS)等經由前置步態學習階段建構的步態模型，即時計算
驅動軸運動數據，進而透過控制介面驅動四足機器人跨步穿越河
石地形。 
（200-500 字） 
技術說明 
（英文）In the study, the terrain recognition and path generating 
module based on ANFIS Inversed kinematics solver have been 
developed and integrated with motion control module on the 
developed quadruped robot system NC-F4-2009. The new robot 
system NC-F4-2009 has successfully demonstrated its autonomous 
motion ability crossing a so called River-stone discontinuous terrain. 
 
產業別 
服務型機器人產業、智慧型機器人產業業 
技術/產品應用範圍 
自動化設備機電整合、智慧型機器人自主式行動技術 
技術移轉可行性及預期
效益 
1.可建立影像為基礎的路徑辨識與行動控制的系統整合核心技
術，有效提升自動化設備機電整合、智慧型機器人自主式行動技
術的應用發展與具體功效。 
     註：本項研發成果若尚未申請專利，請勿揭露可申請專利之主要內容。 
98年度專題研究計畫研究成果彙整表 
計畫主持人：鄭璧瑩 計畫編號：98-2221-E-009-185- 
計畫名稱：仿生四足機器人跨越河石地形的自適性模糊-類神經步態規劃與實驗 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 1 1 100%  
研討會論文 1 1 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 2 2 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 1 1 50% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 2 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
 
