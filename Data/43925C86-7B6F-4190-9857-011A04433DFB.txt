 2
行政院國家科學委員會專題研究計畫成果報告 
單體法於磁浮控制系統參數最佳化之應用 
Integrating Simplex Method on Parameter Optimization 
Apply in the Magnetic Levitation System 
計畫編號：NSC 98-2221-E-019 -006- 
執行期限：98 年8 月1 日至99 年7 月31 日 
執行單位：國立海洋大學機械與機電工程學系 
國立屏東科技大學生物機電工程學系 
主持人：傅群超 教授 
共同主持人：蔡循恆 副教授 
E-mail: f0005@mail.ntou.edu.tw 
摘要 
   使 用 改 進 單 體 演 算 法 (Modified 
Nelder-Mead Simplex Method) 配合田口設計法
(Taguchi Methods)應用於 PID 控制器,類 PID 模糊
控制器還有可變結構控制器(VSC)來各別來控制
磁浮系統的導磁物體，以達成穩定定位的目標。
這三個控制器可以克服出現在實際磁浮系統的
不確定性以及控制住磁浮性統本身高度非線性
的表現行為。 
為了讓磁浮系統的響應擁有更佳的表現，如較
佳的響應速度，穩態誤差和穩態響應。我們使用
試誤法或單體法能找出的最佳值並不能保證每
次都為全域最佳值。又因為改進單體法初始值需
要範圍分割，因而產生許多區塊初始點,導致搜
尋時間過長容易造成磁浮機台過熱，甚至造成系
統產生不精確數據。於是利用田口設計法篩選出
初始值對系統影響最大之最佳解參數組合，再由
田口法所篩選出的組合範圍做搜尋，這樣對
Modified Nelder-Mead Simplex Method 所需要大
量的搜尋時間方面可獲得改善，且使能快速精準
使得局部解達到優化的全域解的機率大大提升。 
關鍵字：單體法、磁浮系統、最佳化控制、田口
法 
1.前言  
   磁浮系統屬於非線性且不穩定的系統，通常
此類非線性系統均在某一工作點附近操作，因此
我們可對此非線性系統於操作點附近作線性化。
一般而言，磁浮系統除可用傳統的比例-積分-微
分控制器外，亦可應用某些非線性控制控制法
則，如模糊邏輯控制(Fuzzy Logic Control, FLC)、
可變結構控制等理論來解決。本研究將改進單體
法初始值的設計方法這是為了達到全域最佳解
的方法。因此，加入了初始值的規劃和刻意設計
的變化。初始值的規劃是將搜尋邊界劃分成預先
設定的區域。每一個區域
有一組單體法的初始值。
初始值的決定是基於分割
區域邊界。當每組的單體
法執行到滿意的結果或設
定的程式迴圈數時，即展
開單體刻意設計的變化。
首先，選擇每一組單體的
最佳點。接著，所有最佳
點比較的大小，以獲得全
部區域最佳點中的最佳點。最後，將所得到的最
佳點取代每一區域單體內最差的點。這種方法使
單體在不同的區域收斂到全域最佳解。這種方法
的好處是不使用任何方程式，它可以用最簡單的
 4
尋該控制器之最佳化參數組合。 
 
 
4. 最優化法 
4.1 單體法 
Nelder-Mead 單形法是設計用來求解非約束性的
最佳化問題，其目的是搜尋參數向量 p，使得純
量函數 f(p) 能達到最小值。一開始，Nelder-Mead
單形法須先產生的多個單形，每一個單形由
0 np , , p 等 n +1個點所組成，其對應的函數值分別
為 0 nf , , f 。 
ep
0p
1p2p
rp0p
1p2p
rp0p
1p2p
rp 0p
1p2p
rp
cp
ccp
 
           圖(5)單體法搜尋動作 
其中( rp :反射動作， ep :擴展動作， cp :一維外收縮
動作， ccp :一維內收縮動作)。首先單體中各點經
過函數中性能指標的計算後，依據性能指標值所
對應的點排列大小順序。此後決定單體動作順序: 
反射、擴張、外收縮、內收縮。其值需滿足
0 < β < 1 , 0 < α < γ , 1 < γ 。 
np = p + α(p p )r                     (4) 
np = p + γ(p p )e                     (5) 
np = p + β(p p )c                     (6) 
np = p β(p p )cc                     (7) 
比較經過各別四種動作的值是否能替代在單體
中最差點。如果四個值的點都沒有一個可以取代
最差點 np ，就進行多維收縮動作。 
0p
1p2p
p
 
圖(6)多維收縮動作 
本文參數設定值為 α (反射系數)為 1，β (收縮系數)
為 0.5，γ (擴展系數)為 2.3。反射點 rp 、擴展點 ep 、
外收縮點 cp 和內收縮點 ccp ，其對應的性能指標值
為 rf 、 ef 、 cf 和 ccf 。 
將單體收縮產生新的單體。新單體的產生是使用
。 i 0 ip + 0.5(p - p ), i = 1, , n 將這些步驟一直循環迭代
達到設定的目標才結束。 
4.2 性能指標(Performance Index) 
    性能指標(performance index)為單體法找到
最佳點的依據。本研究採用絕對值乘上時間積分
(Integral of Time multiplied by Absolute Error, 
ITAE)。 
τ τ
0 0ITAE
J = t r(t) - y(t) dt = t e(t) dt      (8) 
 
 
4.3 單體法執行步驟 
Step1:設 j = 1，得到初始的單形，並計算它的函
數值。選擇上述單形法中之 α , β , σ , γ。 
Step2:排序目前單形的頂點 (j)p0 ,…, 
(j)pn ，使得它
們的函數值 (j)f0 ,…, 
(j)fn  為升冪排列。 
Step3:計算 (j)pr 與 (j)fr ，令 (j)pnew 為未被定義。 
 
Step4:視 fr 而定，執行四個下述實例的一例： 
(1)若 fr < f0，則首先計算 fe = f(p )e ；其次，
若 fe < fr ,則設 p = pnew e ；否則設 p = pnew r 。 
(2)若 f0≤ fr < fn-1 ，則設 p = pnew r 。 
(3)若 fn-1≤ fr  fn ，則首先計算 f = f(p )c c ；
其次，若 fc  fn ，則設 pnew   pc 。 
(4)若 fn ≤ fr ,則首先計算 ( )f f pcc cc ；其次，
若 f fcc n ，則設 p = pnew cc。 
Step5:若 (j)pnew 仍未被定義，則變小此單形；否則
針對 i  0,…, n -1  設令 (j+1) (j)p = pi i ，且
(j+1) (j)p = pn new
 6
數之品質性、實驗因子的定義與選擇、S/N 比、
回應表、田口直交表。其中回應表用來分析各因
子特性，進而決定出那些因子對系統影響較為明
顯，並篩選出最佳控制因素的組合。利用回應表
作分析，從大量數據參數組合可以觀察到影響系
統關係主要的因子，所以從回應表中可以對重要
因子作分析改變亦可作為減少時間降低成本最
好的分析，再依據我們實驗去求的特性與期望的
目標做更進一步改進。 
5.2 品質損失函數(Quality Loss Function) 
    田口實驗設計法以品質損失為基底，損失是
一種連續函數，而田口博士的二次損失函數 L(y)
，就具有這種不可缺少的性質。品質損失量化函
數大致可分三種: 
A. 望目型: 
越偏離目標值損失度越高，相對品質越低 
2L(y) = K(y - m)   
B.望小型: 
將目標值m =0 代入(9)可得(10) 
損失函數: 2L(y) = Ky            (10)　　　　  
C.望大型: 
望大特性為望小的倒數，即可得(11) 
損失函數: 2
1
L(y) = K      (11)
y
　　　　　  
5.3  S/N(Signal to Noise ratio) 
從最佳化的角度來看，S/N 比的意義是將目
標(望目、望小、望大)整合為單一比較目標(最大
化 S/N 比) 。 
而 Mean Square Deviation(MSD)為均方偏差 
  
 
望目型:                        (13) 
 
望小型:                        (14) 
                       
望大型:                        (15) 
5.4 改良式單體法與田口設計法結合實施策略 
步驟 1.定義完成系統目標及搜尋範圍 
步驟 2.辨認控制因子及其水準 
(a)辨認所有的控制因子。 
(b)選擇重要的控制因子及其水準。 
步驟 3.設計實驗  
 (a)選定直交表。 
 (b)指派控制因子至直交表中。 
步驟 4 準備及執行實驗，收集數據 
步驟 5 資料分析 
 (a)計算直交表中每一次實驗的 SN 比與
y 。 
  (b)完成並解釋各因子對於 SN 比與 y 。 
       (c)決定控制因子的最佳水準組合。 
  步驟 6 執行確認實驗 
       (a)如果確認實驗結果不吻合(或不滿意),
表示   實驗過程失敗必須重新實驗。 
步驟 7 執行結果 
(a)將篩選後的初始參數組合代入單體法
執行進一步搜尋疊代，試找出最佳參數值
組合。 
6. 數值函數模擬 
在將田口設計法應用於磁浮系統之前應先模擬
，而模擬方法之優點是可以補大型實驗試體數目
有限之限制，並可較深入地掌握各種機制之發生
過程和評估影響性。再透過和磁浮實驗數據比較
之後，可校正此類分析軟體的功能及正確性。 
 
x
y
 
 
-0.5 -0.1667 0.1667 0.5
-0.5
-0.1667
0.1667
0.5
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
 
             圖(10) B2 函數 2D 圖
Probability of  the global solution   
 
x
y
 
 
-5 -1.6667 1.6667 5
-5
-1.6666
1.6667
5
100
200
300
400
500
600
700
800
 
圖(11) Modified Himmenblau 函數 2D 圖 
Probability of  the global solution   
 
S/N = -10log MSD              (12)  
n
2
i=1
(y - m)
MSD = n

n
2
i=1
y
MSD = n

n
2
i=1
1/y
MSD = n

 8
Modified NM Simplex Method+Taguchi Method)
結果如下: 
0 0.5 1 1.5 2 2.5 33
4
5
6
7
8
9
Time(sec)
G
ap
(m
m
)
 
 
Typical NM
Modified NM
Modified NM+Taguchi
 
圖(18)實機使用 Typical NM,Modified 
NM,Taguchi Method 最佳化參數 VSC 控
制懸浮體位置圖 
0 0.5 1 1.5 2 2.5 3-4
-3
-2
-1
0
1
2
Time(sec)
er
ro
r(
m
m
)
 
 
Typical NM
Modified NM
Modified NM+Taguchi
 
圖(19)實機使用 Typical NM,Modified 
NM,Taguchi Method 最佳化參數 VSC
控制誤差輸出圖 
8. 結論 
在真實實驗運作中，常常會有許多已知或不
確定的擾動，或隨著感應線圈的溫度提高，參數
的不確定性也隨之增加，在這些狀況下，求得一
組能讓我們能讓磁浮體達到定為目的完成系統
穩定的控制器參數是非常重要的。 
由於改良式單體法的概念雖然大幅提升搜
尋到全域解的機率，但磁浮系統面對如此大量的
搜尋參數，會使導磁體產生不正常抖震和感驗線
圈磁力消退等現象，可行性相對降低許多，由第
五章，所應用田口法技術能輕易並確實找到一組
最佳初始參數組合，再進一步由單體法搜尋可確
實得到最佳控制參數組合，在外部的擾動下，依
然能使系統已穩定進行，故面對複雜之系統所需
從大量參數資料中篩選出最佳組合參數時田口
設計法的成效是不容置疑的。 
9. 參考文獻 
[1] C. C. Fuh, “Detecting unstable periodic orbits 
embedded in chaotic systems using the simplex 
method,” Communications in Nonlinear 
Science and Numerical Simulation, Vol. 14, 
No. 4, pp.1032-1037, 2009. 
[2] D. Sbarbaro, “Application of in integral 
variable structure controllers,” Proceedings of 
the 1996 IEEE International Conference on 
Control Applications, pp.673-678, 1996 
[3] J. Y. Hung, W. Gao and J. C. Hung, “Variable 
Structure Control - A Survey,”IEEE 
Transactions on industrial electronics, Vol. 40, 
No. 1, 1993. 
[4] Madu,I. E., and C. N. MADU, “Design 
Optimization Using Signal-to-Noise Ratio,” 
Simulation Practice and Theory, 7,1999 
[5] 蘇朝敦，品質工程，第二版，中華民國品質
學會，2003 
[6] 劉克琪，實驗設計與田口品質工程，台北市
華泰出版，1994 
 1
 
國科會補助專題研究計畫項下出席國際學術會議心得報告 
 日期： 99 年 9 月 30 日 
 
一、參加會議經過 
  IEEE（Institute of Electrical and Electronics Engineers，電氣與電子工程師協會）
是由 AIEE（American Institute of Electrical Engineers，美國電氣工程師協會）與 IRE
（Institute of Radio Engineers，無線電工程師協會）在 1963年時共同成立，為電機、
電子、通訊、計算機工程、科學相關等標準制定的專業機構。IEEE可說是全球最大
的專業學術組織，在電氣及電子工程、電腦及控制技術領域中，IEEE 發表的文獻占
了全球將近百分之三十。IEEE每年也會主辦或協辦三百多項技術會議。本人此次所
計畫編號  NSC 98-2221-E-019-006- 
計畫名稱 單體法於磁浮控制系統參數最佳化之應用 
出國人員
姓名 傅群超 
服務機構
及職稱 
國立臺灣海洋大學 
機械與機電工程學系 
教授 
會議時間 
98年 12月 15日
至 
98年 12月 18日 
會議地點 中國上海 
會議名稱 
(中文) 
(英文)  48th IEEE Conference on Decision and Control 
發表論文
題目 
(中文) 
(英文) A Fuzzy Cross-Coupled Linear Quadratic Regulator for Improving 
the Contour Accuracy of Bi-axis Machine Tools 
附件四 
 3
四、建議 
  口頭報告方式雖然能在較短的時間內將論文內容呈現給較多人知曉，但由於提
問或討論時間有限，通常只能了解論文的大概輪廓。而張貼方式雖然作者較辛苦，
須待在會場的時間也較長，但確能與其他學者專家能有更深入的交流。因此若國內
有較大型之研討會，應該盡可能由作者選擇其中一種模式呈現研究成果，惟作者本
人千萬不可缺席。 
 
五、攜回資料名稱及內容 
  論文光碟一片。 
 
六、其他 
  相片 
 
 
相片 1：上海磁浮列車。 
 
 
 
 5
 
相片 4：學術交流。 
 
 
 
相片 5：學術交流。 
 
 
 
無研發成果推廣資料 
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
無 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
