high reliable and safe IBT, which is the main goal of 
the integration project. The contributions of this 
second year＇s work are 1) to develop a new bus 
transportation traffic (BTT) model and 2) to develop 
a unified framework of estimators for nonlinear 
systems with unknown inputs, through which a 
dedicated derivative-free estimation implementation 
can be achieved to simultaneously estimate the bus 
flow, bus arrival time, passenger number, and unknown 
model parameters of the BTT model. 
英文關鍵詞： public transportation system, intelligent bus 
transportation system, real-time estimation system, 
unknown input filtering 
 
 2
二、前言 
    隨著民眾對於大眾運輸系統之可靠度與
安全性的要求日益提昇，及近年來能源危機
以及環保問題日益嚴重且受到重視，如何有
效提昇大眾運輸系統之服務品質、營運效能
與能源的利用率，進而有效降低能源的消耗
與減少環境污染，將是先進國家積極發展下
一世代大眾運輸系統之重要交通運輸政策，
藉以提昇整體大眾運輸之經營效率與服務水
準。近年來，由於全球衛星定位系統(GPS)
之普遍，廣受國內運輸業者採用，以隨時掌
握行駛中車輛位置及相關資訊，然而由於系
統建置、運作與維護等費用過於昂貴，同時
對於營運管理的效益提升有限，使得立意良
好的車輛行車動態資訊系統成效不彰，而陷
於存廢的困境。近年來，國際上車載資通訊
技術愈來愈受到高度的重視，並可提供更安
全與可靠的行車資訊與駕駛環境，以利建構
下一世代之智慧型行車預警與應變系統與智
慧型運輸系統。基於此，本子計畫所歸屬之
整合型計畫提出『智慧型公車運輸之即時監
控系統與協調機制』之整合應用，結合無線
通訊、資訊、控制、導航與晶片設計等前瞻
技術，應用無線射頻辨識、無線感測網路、
影像辨識、即時監控、估測理論與協調控制
以及車載專用短距離通訊等相關技術，並透
過車用環境無線存取技術、無線／有線通訊
技術與網際網路，建構一套『智慧型公車運
輸即時監控系統』，以研發下一世代之智慧
型大眾運輸系統。 
基於上述理由及大眾運輸系統必須滿足
高可靠度、高舒適性與高安全性之要求，整
合型計畫目的將發展『智慧型大眾運輸即時
監控系統』以及其相關的前瞻性應用技術，
諸如智慧型電子車票(TAG)設計、智慧型站牌
設計、乘客乘坐路線自動辨識系統、影像人
像辨識系統、候車人數估測理論與技術、智
慧型收費系統、車輛行車動態資訊系統以及
車輛調度決策機制與協調控制之專家系統等
技術。而整合型計畫整體目標在研發智慧型
公車站牌與行車動態車監控系統，有效收集
乘客與行車即時的動態資訊，經由後端結合
人像辨識、估測方法與協調控制機制所建構
出的專家決策系統，實現大眾運輸車輛即時
化與合理化的調度管理，以提昇客運業者之
競爭力，並有效降低營運成本。並可提供乘
客人性化及可靠度的行車資訊與運輸服務，
以降低乘客的候車時間與提昇行車的舒適
性，更可利用行車動態即時資訊系統，即時
掌握車輛行駛的狀況，進而提昇大眾運輸之
行車安全性、乘載率與準點性。進而改善大
眾運輸服務品質，刺激民眾搭乘大眾運輸之
意願，以增加業者營運收入，並可有效提昇
能源的使用效率。因此，以資通訊技術為基
礎，整合前瞻的無線辨識、感測網路技術與
訊號處理發展『智慧型大眾運輸系統』之應
用，以期有效提昇大眾運輸系統之服務品質
與營運效能，將是一個相當值得政府重視與
學術界研究的課題。 
本計畫為整合型計畫之子計畫二：「未
知信號估測技術應用在動態候車人數估測之
研究」，計畫目標即在利用未知信號估測理
論，來提升預估乘車人數之準確度。藉由進
行估測理論與技術之建模與研究，以彌補智
慧型電子車票（TAG）與影像辨識可能產生
之估算誤差，進而校正以獲得更準確的各路
線乘車人數與候車總人數，以達成整合型計
畫之關鍵績效指標 (KPI)：（一）研發下一代
智慧型大眾運輸載具之行車動態資訊系統及
（二）研發下一代智慧型大眾運輸系統行車
監控與調度中心之決策與協調機制。 
為達成上述整合型計畫之 KPI，本計畫針
對智慧型公車車流及動態候車人數估測，擬
發展之未知信號估測技術包括：(1) 智慧型公
車乘客搭車行為建模技術；(2)最佳智慧型公
車車流及到站時間估測技術；(3)最佳智慧型
公車系統之候車人數估測技術。本計畫期望
能發展出針對智慧型公車系統之最佳未知信
號估測理論及技術，以精準預估公車車流及
到站時間，並提昇預估公車乘客及候車人數
之精確度。最後，依據上述技術議題，我們
可規劃出本計畫之 KPI 如下：（一）應用在
智慧型公車乘客及候車動態人數與公車車流
及到站時間之最佳未知信號估測技術發展，
（二）針對具未知信號描述系統之最佳未知
信號估測技術發展，（三）針對具未知信號
非線性系統之最佳未知信號估測技術發展。 
 
三、文獻探討 
目前文獻中與本計畫相關之未知信號估
測技術研究為探討高速公路車流估測問題
 4
料之分析研究、決策邏輯與協調控制等智慧
機制之執行，以提昇車輛即時與緊急調度之
準確性與安全性。 
綜合上述所言，本計畫在整合型計畫中
扮演著關鍵性角色地位，關係著整體計畫是
否可順利達成，另外本計畫所欲發展之未知
信號估測技術仍是學術界熱門研究主題，因
此本計畫不論在實務應用與學術研究上皆有
其研究必要之價值。本計畫針對大眾運輸系
統動態候車人數估測研究議題及相關 KPI，請
參考（二）前言一節。在本計畫中，主持人
將應用多年來針對線性系統中未知信號估測
問題，所累積之理論研究基礎、經驗與成果
[26-32]，進一步發展出針對大眾運輸系統之
最佳非線性估測理論及技術，藉以預估車輛
車流及到站時間，進而提昇預估公車候車人
數之精準度，使得整合型計畫所祈求之「大
眾運輸系統必須滿足高可靠度與高安全性之
要求」能夠順利達成。另外，主持人將藉由
本計畫執行之同時，企圖將具未知輸入之描
述（或非線性）系統狀態估測技術所涉及更
廣泛理論（如穩定性探討）及其應用做一徹
底及完整之研究，冀望能對此一專題研究主
題做出重大學術貢獻。 
 
五、研究方法 
本計畫之研究重點主要是將智慧型公車
車流及乘客行為模型化為一標準之非線性未
知信號估測問題，然後利用計畫主持人所研
發之新型非線性未知信號估測技術，來求解
相關系統狀態估測問題。由於公車乘客與候
車人數模型與一般文獻所探討之高速公路車
流估測模型並不十分相同，而且相關整合型
研究報告相當缺乏，因此本計畫內容具有學
術或技術上之創新性。 
在第一年計畫裏，主持人基於車流估測問
題採用文獻（Boel and Mihaylova, 2006 [2]）
中所提出之組合式隨機巨觀運輸模型
(CSMTM: Compositional Stochastic 
Macroscopic Traffic Model)，做為本計畫所欲
探討之智慧型公車車流及乘客及候車人數之
主要動態模型描述（請參考第一年專題結案
報告及參考文獻[39,44]）。然而，如前所述，
本計畫為一整合型研究內容，不僅需考慮車
流估測，另亦必須同時考慮公車獨特操作模
式及乘客及候車人數之動態模型。因此，在
計畫第二年裏，主持人利用整合型計畫中子
計畫ㄧ研發人像影像辨識系統與子計畫五所
研製的智慧型車票來取得候車及乘客動態人
數量測資料，並利用子計畫三所研發之智慧
型站牌與車載專用短距離通訊技術，我們可
得到前述之 CSMTM 模型中，離開第 i 個公車
站而進入第 i+1 個公車路線區段之行駛公車
數目及車速量測資料。另外，考慮公車獨特
操作模式，主持人亦在模型中加入乘客交換
機制，適當改良原 CSMTM 模型為第二年計
畫所欲探討之公車運輸交通模型(BTTM: Bus  
Transportation Traffic Model) 。 此 一 新 型
BTTM 模 型 可 視 為 傳 統 CTM (Cell 
Transmission Model) 模型之延伸。我們將在
（六）結果與討論一節中簡述此一 BTTM 模
型之推導概念。 
由於所發展之 BTTM 模型為一複雜非線
性模型且包含未知參數，應用傳統線性化技
巧所產生之延伸卡門濾波器其估測效果非常
有限。為解決此一問題，在第一年計畫裏，
主持人研發一新型針對非線性複雜系統之最
佳未知信號估測器（NERTSF），並將其應用
在高速公路車流估測問題。NERTSF 未知信號
估測器之設計基本上是將非線性系統以一階
泰勒展開式近似成一線性系統，然後直接應
用 ERTSF。此一設計方法之概念如下所述。
我們可將 BTTM 模型改寫為一個具未知輸入
之非線性時變離散系統如下： 
,),,(1 kkkkk wudxfx +=+          (1) 
     ,),,( kkkkk vudxgy +=          (2) 
其中 nk Rx ∈ 為系統狀態， pk Rd ∈ 為未知系統
參數， qk Ru ∈ 為系統輸入， mk Ry ∈ 為系統
量測值，非線性函數 f 和 g 為已知， lk Rw ∈ 為
系統白雜訊而 kv 為量測白雜訊。然後，利用
一階泰勒展開式，我們可將(1)-(2)式近似如
下： 
,)(1 kkkkkkk wufdGxAx +++=+      (3) 
  ,)( kkkkkkk vugdHxCy +++=       (4) 
其中 
 
( ) ,|,,
||
ˆ,ˆ kkkkkk ddxx
k
kkk
k x
udxfA ==∂
∂=     ( 5 ) 
 6
六、結果與討論 
在本節中，我們將簡述第二年計畫主要
研究成果（詳細內容與推導過程請參考文獻
[45,47]）。 
6.1 BTTM 模型 
本計畫將公車路線依據站牌分成 n 個區
段(segment)。其次，我們定義系統狀態變數
如下： ( )Tkikikiki PvNx ,,,, ,,= ，其中 kiN , 表示在
取樣時間 kt 第 i個公車路線區段之行駛公車數
目， kiv , 表示在取樣時間 kt 第 i 個公車路線區
段之行駛公車平均速度， kiP , 表示在取樣時間
kt 第 i 個公車路線區段之乘客總數。其次，定
義其它系統參數如下： kiB , 表示在第 i 個公車
站中有多少公車停駐於此， kiD , 表示在時間區
間 ),[ 1+kk tt 中離開第 i 個路線區段而進入第 i
個公車站牌之行駛公車總數， kiQ , 表示在時間
區間 ),[ 1+kk tt 中離開第 i 個公車站而進入第
i+1 個公車路線區段之行駛公車總數，
iikiki lLN /,, =ρ 表示車流密度， iL 表示第 i 個
公車路線區段長度， il 代表道路上的線道總
數， kkk ttt −=Δ +1 ， max,kiN 表示在取樣時間 ktΔ
第 i 個公車路線區段中行駛公車之最大數
目， fv 表示公車在不塞車情況下之行車平均
速度， minv 表示公車之最低行車平均速度，
)(ρev 表示在車流密度ρ下之公車行車平均
速度。最後，我們描述 BTTM 模型如下： 
1) 順向波計算:( ni ,,2,1 K= ) 
).,,(
,,max
1,,,,
min
,
,
,
,, ,
ikikiikiki
i
kki
kiD
i
kki
kiki
CBDSQ
L
tv
N
L
tv
ND
ki
−==
⎟⎟⎠
⎞
⎜⎜⎝
⎛ Δ+Δ⋅=
φ
η
 
其中 )(, •kiφ 是一個非線性函數，代表公車離公
車站 i 的行駛狀態，而 iC 為公車站 i 最大可容
納的車輛總數。 
2) 逆向波計算:( 1,,1, K−= nni ) 
,,1,1
max
,1, kikikiki DNNR +++ +−=  
其中 
.0 ,1
,1
,11max
,1 ki
dkil
kii
ki NtvA
lL
N +
+
++
+ −+=  
而 0 ,1 kiN + 表示該路段中可容許非公車之一般車
輛的數目。如果 kiki RS ,, ≥ ，則修正 kiQ , 及 kiv , 如
下： 
kiki RQ ,, = ， .
,
,
,
kki
iki
ki tN
LQ
v Δ=  
3) 公車站 i 的遲滯車輛總數更新 
   ( ni ,,2,1 K= ) 
.,,1,, kikikiki QDBB −+= −  
4) 公車路線區段 i 的車輛總數更新 
   ( ni ,,2,1 K= ) 
.,,1,1, kikikiki DQNN −+= −+  
5) 公車路線區段 i 的車流密度更新 
   ( ni ,,2,1 K= ) 
1,
1,
1,
+
+
+ =
kii
ki
ki lL
Nρ ， ( ) ,1 1,11,1, ++++ −+= kikianticki ρααρρ  
其中 .01, =++ kinρ  
6) 公車路線 i 區段的車速更新( ni ,,2,1 K= ) 
( )
⎪⎩
⎪⎨
⎧
=
≠−+
=
+
+
+
−−
+
,0,
,0,
1,
1,
1,
,,,,1,1
int
1,
kif
ki
ki
kikikikiki
er
ki
Nforv
Nfor
N
QNvQv
v  
( ),,max min1,int 1,int 1, +++ = kierkierki vvv  ( ) ( ) ,1 ,1,1int 1,11, kvantickieikerkiikki ivvv ηρββ +−+= +++++  
其中 ( )ρev 計算如下： 
,1,1,11 ⎩⎨
⎧ ≥−= ++++ otherwise
th
antic
ki
antic
ki
II
I
i
k
ρρρ
β
ββ  
( ) .1exp
⎪⎭
⎪⎬
⎫
⎪⎩
⎪⎨
⎧
⎥⎦
⎤⎢⎣
⎡−×=
ma
critm
f
e
a
vv ρ
ρρ  
7) 公車路線區段 i 的乘客總數更新 
   ( ni ,,2,1 K= ) 
.),,(
)1(
1,,1,1,11
,1,
,
,
1,
+−−−−
−+
+×
+−=
kPkikikii
kiki
ki
ki
ki
i
NPW
QP
N
D
P
ηπ
 
 8
),ˆ(
,)(
,))((
,)()(
1||
1
1||
1
1||
1
1
1|1|
−
−
−
+−
−
−
−
−−
−=
=
=
=
kkk
d
kkk
y
kk
T
k
d
kk
d
k
k
X
kk
T
k
d
kk
k
X
kk
TXy
kkk
yyKd
PSPK
SPSP
UPPS
(
(
(
(
 
其中 
],|),([ˆ
],|)ˆ),((
)ˆ),([(][
],|)ˆ),((
)ˆ[(
1
1|
1
1|
1|1|
1
1|
1|1|
−
−
−
−
−−
−
−
−−
=
−×
−+=
−×
−=
k
kkkk
kT
kkkk
kkkk
T
kk
y
kk
kT
kkkk
kkk
Xy
kk
yuXgEy
yyuXg
yuXgEvvEP
yyuXg
XXEP
 
Step 2: 量測值更新（只有在 tk=ts時更新） 
,
),ˆ)((ˆ
,
,)()(
|1|1||
1|1||
1
1
1|1|
T
k
d
kkk
T
k
y
kkk
X
kk
X
kk
kkk
d
kkkkkkk
kkkk
X
kk
TXy
kkk
VPVKPKPP
yyKVKXX
SKUV
PPK
(
(
+−=
−++=
−=
=
−−
−−
−
−
−−
 
Step 3: 時間更新（所有 tk均更新） 
,)](|)),((
),),([(][(
,
],|),([
1|1
|11|1
|11|1
|1
T
k
kT
kkkk
kkkk
T
kkk
X
kk
kkkkk
k
kkkk
EyuXf
uXfEwwEEP
EX
yuXfE
+
++
+
+
++
+
+
++
+
−×
−+=
=
=
χ
χ
χ
χ
 
  利用前述之取樣技巧，上面之估測器架
構中之泛用式可求得如下： 
,)()(
)(][(
,
,ˆ
,)ˆ()ˆ(
][
,)ˆ()ˆ(
11|1|,
1|1|,
0
2
1|1
0
|1,|1
0
1|,1|
1|1|,
0
1|1|,
2
1|
1|1|,
0
1|1|,
2
1|
T
k
T
kkkki
kkkki
n
i
i
T
kkk
X
kk
n
i
kkiikk
n
i
kkiikk
T
kkkki
n
i
kkkkii
T
kk
y
kk
T
kkkki
n
i
kkkkii
Xy
kk
E
WwwEEP
W
yWy
yyyyW
vvEP
yyxxWP
+
+−−
−−
=
+
++
=
++
=
−−
−−
=
−−
−
−−
=
−−−
−×
−+=
=
=
−−+
=
−−=
∑
∑
∑
∑
∑
χχ
χχα
χχ
α
α
χ
χ
χ
χ
χ
 
其中 
,11ˆ
),,(
),,(
|||,
|,|1,
1|,11|,
i
X
kk
i
kkkki
kkkikki
kkkikkki
P
W
X
uf
uEgy
παχ
χχ
χ
×⋅+=
=
=
+
−
+
+−
 
.,0
0
0 Xn
n
i
T
ii I== ∑
=
χ πππ  
七、計畫成果自評 
本年度計畫已成功地推導出一適用大眾
運輸公車系統之車流與乘客及候車人數動態
模型，另外亦推導出一非線性泛用型估測器
（架構）。由於時間侷限，相關模型與估測器
之詳細驗證結果在本年度成果報告裡尚未完
成，我們將在第三年計畫中繼續此一研究，另
外我們也會繼續探討本計畫現階段成果之正
確性及延伸性。總結計畫成果，本計畫原規劃
之核心部分大致順利完成，在第一及第二年的
研究成果表現大致上已達成預期的工作目
標，所獲得之研究成果也發表於國際上具知名
度之研討會上及投稿至國際頂尖期刊審查中。 
本計畫研究成果請參考文獻 [32,39-45, 
47]。  
八、參考文獻 
[1] L. Mihaylova and R. Boel, “A particle filter 
for freeway traffic estimation,” in 43nd IEEE 
Conference on Decision and Control, pp. 
2106-2111, 2004. 
[2] L. Mihaylova, R. Boel, and A. Hegyi, 
“Freeway traffic estimation within particle 
filtering framework,” Automatica, vol. 43, 
no. 2, pp. 290-300, 2007. 
[3] X. Sun, L. Munoz, and R. Horowitz, 
“Highway traffic state estimation using 
improved mixture Kalman filters for 
effective ramp metering control,” in 42th 
IEEE Conference on Decision and Control, 
pp. 6333-6338, 2003. 
[4] D. B. Work and A. M. Bayen, “An ensemble 
Kalman filtering approach to highway traffic 
estimation using GPS enabled mobile 
devices,” in 47th IEEE Conference on 
Decision and Control, pp. 5062-5068, 2008. 
[5] C. Daganzo, “The cell transmission model: a 
dynamic representation of highway traffic 
 10
two-stage Kalman filtering for systems with 
unknown inputs,” Asian Journal of Control, 
vol. 12, no. 4, pp. 510-523, July, 2010. 
[29] C.-S. Hsieh, “Optimal filtering for systems 
with unknown inputs via the descriptor 
Kalman filtering method,” Automatica, 47, 
pp. 2313-2318, 2011. 
[30] C.-S. Hsieh, “A framework for globally 
optimal state estimation for systems with 
unknown inputs (I): transformation 
approach,” Asian Journal of Control, vol. 15, 
no. 1, pp. 1-13, January 2013. (DOI: 
10.1002/asjc.434) 
[31] C.-S. Hsieh, “A framework for globally 
optimal state estimation for systems with 
unknown inputs (II): untrammeled 
approach,” Asian Journal of Control, vol. 15, 
no. 2, pp. 1-10, March 2013. (DOI: 
10.1002/asjc.431) 
[32] C.-S. Hsieh, “Optimal linear filtering for 
stochastic descriptor systems with unknown 
inputs,” in Proceedings of the 13th IASTED 
International Conference on Control and 
Applications, pp. 52-59, 2011. (計畫成果) 
[33] M. Norgaard, N. K. Poulsen, and O. Ravn, 
“New developments in state estimation for 
nonlinear systems,” Automatica, vol. 36, pp. 
1627-1638, 2000. 
[34] S. Julier, J. Uhlmann, and H. 
Durrant-White, “A new method for nonlinear 
transformation of means and covariances in 
filters and estimators,” IEEE Trans. Automat. 
Contr., vol. 45, pp. 477-482, 2000. 
[35] B. M. Quine, “A derivative-free 
implementation of the extended Kalman 
filter,” Automatica, vol. 42, pp. 1927-1934, 
2006. 
[36] J. H. Kotecha and P. M. Djuric, “Gaussian 
particle filtering,” IEEE Trans. Signal 
Process., vol. 51, pp. 2592–2601, 2003. 
[37] I. Arasaratnam and S. Haykin, “Cubature 
Kalman filters,” IEEE Trans. Automat. 
Contr., vol. 54, pp. 1254-1269, 2009. 
[38] M. Simandl and J. Dunik, “Derivative-free 
estimation methods: new results and 
performance analysis,” Automatica, vol. 45, 
pp. 1749-1757, 2009. 
[39] Chien-Shu Hsieh and Der-Cherng Liaw, 
“Traffic state estimation within unknown 
input filtering framework,” in Proceedings 
of 2011 International Conference on Service 
and Interactive Robots, Taichung, Taiwan, 
Nov. 25-27, pp. 25-30, 2011. (計畫成果) 
[40] Chien-Shu Hsieh, “H∞ Kalman filtering 
for rectangular descriptor systems with 
unknown inputs,” in Proceedings of the 50th 
IEEE Conference on Decision and Control 
and European Control Conference, Orlando, 
FL, USA, December 12-15, pp. 2404-2409, 
2011. (計畫成果) 
[41] Chien-Shu Hsieh, “State estimation for 
descriptor systems via the unknown input 
filtering method,” Submitted to Automatica, 
2011. (計畫成果) 
[42] Chien-Shu Hsieh, “State estimation for 
nonlinear descriptor systems with unknown 
inputs,” in Proceedings of 2012 National 
Symposium on System Science and 
Engineering, Keelung, Taiwan, June 16-17, 
pp. 1302-1307, 2012. (計畫成果) 
[43] Chien-Shu Hsieh, “State estimation for 
nonlinear systems with unknown inputs,” in 
Proceedings of The 7th IEEE Conference on 
Industrial Electronics and Applications, 
Singapore, July 18-20, pp. 1530-1535, 2012. 
(計畫成果) 
[44] Chien-Shu Hsieh and Der-Cherng Liaw, 
“Unknown input filtering for nonlinear 
systems and its application to traffic state 
estimation,” in Proceedings of The 7th IEEE 
Conference on Industrial Electronics and 
Applications, Singapore, July 18-20, pp. 
1844-1849, 2012. (計畫成果) 
[45] Chien-Shu Hsieh, Chao-Wei Liu, and 
Der-Cherng Liaw, “Bus transportation traffic 
estimation within a unified unknown input 
filtering framework,” in Proceedings of 2012 
CACS International Automatic Control 
Conference, Yunlin, Taiwan, Nov. 30-Dec. 2, 
2012. (計畫成果) 
[46] Chien-Shu Hsieh, “Robust two-stage 
Kalman filters for systems with unknown 
inputs,” IEEE Trans. Automat. Contr., vol. 
45, pp. 2374-2378, 2000. 
[47] Chien-Shu Hsieh, “A unified framework 
for state estimation of nonlinear stochastic 
systems with unknown inputs,” Submitted to 
The 9th Asian Control Conference (ASCC 
2013), 2013. (計畫成果) 
 
表 Y04 
一、參加會議經過 
 
此次會議地點位於新加坡之 Holiday Inn Singapore Orchard City Centre。個人於民國 101
年 7 月 18 日早上由桃園國際機場搭乘中華航班直飛至新加坡樟宜國際機場，總計飛行時間
約 4 小時 40 分。在抵達住宿飯店後，旋即前往會議地點辦理報到事宜並領取會議資料，正
式參加由 IEEE 工業電子學會舉辦為期三天之第七屆 IEEE 工業電子與應用研討會。 
個人此次參與會議之住宿旅館為瑞士史丹佛酒店，與研討會會場約 20 分鐘路程（坐捷
運與走路）。在第三天會議結束後，個人於隔天中午搭乘巴士趕赴樟宜國際機場，在下午 2:15
搭乘華航航班，於 7 月 21 日晚上 7:00 返抵台灣。 
 
二、與會心得 
 
此會議屬新加坡 IEEE 工業電子分會一年一度所舉行有關工業電子與應用之國際型學術
研討會議，此次為第七屆舉行，論文發表審查甚嚴，總共有 51 個國家（地區）總計有 644
篇論文投稿，最後共接受有 270 篇論文口頭發表（45 oral sessions）及 140 篇壁報論文發表（6
interactive sessions）。此會議每天均安排有大會主要演講，總計有 3 場次，演講內容如下：
(1) High Efficiency Video Coding and its 3D Extension: A Research Perspective (Prof. Nam 
Ling, 7/18) 
(2) Smart Grids: An Industrial Electronics Perspectives (Prof. Xinghuo Yu, 7/19) 
(3) Extremum Seeking and Maximum Power Point Tracking for Photovoltaic Arrays 
   (Prof. Miroslav Krstic, 7/20) 
 
此次會議之安排內容豐富且多樣性，令人有不虛此行的感覺；論文內容涵蓋廣泛，且有
頗多新的觀念提出，品質與創新性都是有目共睹的，研究主題的廣泛與熱烈之討論，令人印
象深刻。此次研討會論文議題中，個人比較感興趣的有 Adaptive and Intelligent Control、Energy
Management and Control Systems、Hybrid Control、Nonlinear Control、Estimation and 
Identification、Biosignal Processing。藉由此次參與學術研討會，讓我能廣泛瞭解到目前國外
學者投入相關研究之最新成果，藉以了解到個人目前研究成果之創新性與價值性，以激勵未
來之研究方向。另外，藉由參與不同討論主題之研討，可以擴大個人在學術領域之視野，了
解到其它控制理論應用在未來研究領域之可行性。此外，對於個人研究之外的主題也積極參
與，參考別人的研究成果與發表技巧，對於其他領域也有更進一步的認識與體會。 
個人主要的研究領域在未知信號估測理論。值得一提的是，個人的研究成果獲得肯定，
表 Y04 
 
六、其他 
 
由於個人在台灣完成博士教育，且在求學階段無緣參與國際學術會議。藉由此次之出國
參與機會，除了進一步加強個人之英文表達能力，將視野擴大到國際學術領域外，也了解到
最新學術研究之方向，對於日後個人在學術研究上具有啟發及激勵作用。此次能參與國際學
術會議，個人實感受益匪淺，不但能與同好相互切磋討論以增強個人之學術研究能力，同時
能一睹國際級專家學者的風範。因此，非常感謝國科會在出國經費上之大力支持，在此致上
最高之謝意。 
 
 
七、論文發表會場與其他參與教授合影 
 
 
 
 
 
八、發表論文（如後所附） 
 
 
z 左上：與台北科技大學電機系李俊賢
教授在研討會場前合影 
z 右上：與交通大學電機系廖德誠教授
和文化大學機械系黃正自教授在研
討會場前合影 
z 左下：與交通大學電機系廖德誠教授
在壁報論文發表會場前合影 
in Section III for clarity. A general extension of the NERTSF
to derivative-free nonlinear systems with unknown inputs is
developed in Section IV. Simulation results are given in Section
V to illustrative the effectiveness of the proposed results.
Finally, conclusions are highlighted in the last section.
II. STATEMENT OF THE PROBLEM
Consider the general nonlinear system with unknown inputs
as follows:
𝑥𝑘+1 = 𝑓(𝑥𝑘, 𝑑𝑘, 𝑢𝑘, 𝑤𝑘), (1)
𝑦𝑘 = 𝑔(𝑥𝑘, 𝑑𝑘, 𝑢𝑘) + 𝑣𝑘, (2)
where 𝑥𝑘 ∈ 𝑅𝑛 is the state vector, 𝑑𝑘 ∈ 𝑅𝑝 the unknown input
vector, 𝑢𝑘 ∈ 𝑅𝑞 the known input vector, and 𝑦𝑘 ∈ 𝑅𝑚 the
measured output. The process noise 𝑤𝑘 and the measurement
noise 𝑣𝑘 are uncorrelated zero mean white sequences with
covariance matrices 𝑄𝑘 > 0 and 𝑅𝑘 > 0, respectively. The
initial state 𝑥0 is with unbiased mean ?¯?0 and covariance ¯𝑥0
and is independent of 𝑤𝑘 and 𝑣𝑘.
A well-known approach used for the state estimation of the
nonlinear system (1), (2) is to apply the celebrated EKF, where
a first-order Taylor approximation of nonlinear function is
used. Note that in applying the EKF, the following augmented
state vector:
𝑋𝑘 =
[
𝑥𝑇𝑘 𝑑
𝑇
𝑘
]𝑇
,
is formed and the assumption that the unknown input vector
𝑑𝑘 can be effectively modeled as a random-walk stochastic
process is usually employed. Thus, system (1)-(2) can be
rewritten as the following:
𝑋𝑘+1 = 𝑓
𝑎(𝑋𝑘, 𝑢𝑘, 𝑤
𝑎
𝑘), (3)
𝑦𝑘 = 𝑔(𝑋𝑘, 𝑢𝑘) + 𝑣𝑘, (4)
where 𝑤𝑎𝑘 =
[
𝑤𝑇𝑘 (𝑤
𝑑
𝑘)
𝑇
]𝑇
𝑓𝑎(𝑋𝑘, 𝑢𝑘, 𝑤
𝑎
𝑘) =
[
𝑓(𝑋𝑘, 𝑢𝑘, 𝑤𝑘)
𝑑𝑘 + 𝑤
𝑑
𝑘
]
. (5)
For easy reference, the EKF is list as follows:
?ˆ?𝑘∣𝑘−1 = 𝑓
𝑎(?ˆ?𝑘−1∣𝑘−1, 𝑢𝑘−1, 0), (6)
?ˆ?𝑘∣𝑘 = ?ˆ?𝑘∣𝑘−1 +𝐾
𝑋
𝑘 (𝑦𝑘 − 𝑔(?ˆ?𝑘∣𝑘−1, 𝑢𝑘)), (7)
𝑃𝑋𝑘∣𝑘−1 = 𝐴
𝑎
𝑘−1𝑃
𝑋
𝑘−1∣𝑘−1(𝐴
𝑎
𝑘−1)
𝑇
+𝑁𝑎𝑘−1𝑄
𝑋
𝑘−1(𝑁
𝑎
𝑘−1)
𝑇 , (8)
𝐾𝑋𝑘 = 𝑃
𝑋
𝑘∣𝑘−1(𝐶
𝑎
𝑘 )
𝑇
(
𝐶𝑎𝑘𝑃
𝑋
𝑘∣𝑘−1(𝐶
𝑎
𝑘 )
𝑇 +𝑅𝑘
)−1
, (9)
𝑃𝑋𝑘∣𝑘 = (𝐼 −𝐾𝑋𝑘 𝐶𝑎𝑘 )𝑃𝑋𝑘∣𝑘−1, (10)
where 𝑄𝑋𝑘 = 𝑑𝑖𝑎𝑔{𝑄𝑘, 𝐸[𝑤𝑑𝑘(𝑤𝑑𝑘)𝑇 ]},
𝐴𝑎𝑘 =
∂𝑓𝑎(𝑋𝑘, 𝑢𝑘, 0)
∂𝑋𝑘
∣𝑋𝑘=?ˆ?𝑘∣𝑘 , (11)
𝑁𝑎𝑘 =
∂𝑓𝑎(𝑋𝑘, 𝑢𝑘, 0)
∂𝑤𝑎𝑘
∣𝑋𝑘=?ˆ?𝑘∣𝑘 , (12)
𝐶𝑎𝑘 =
∂𝑔(𝑋𝑘, 𝑢𝑘)
∂𝑋𝑘
∣𝑋𝑘=?ˆ?𝑘∣𝑘−1 . (13)
Unfortunately, in practical applications the EKF may not
perform well due to the lack of the true dynamics of the
unknown input vector 𝑑𝑘; moreover, the EKF may also suffer
from significant biases or errors owing to its inherent first-
order linearization. Even worse, the EKF may counter imple-
mentation problem because it may be prohibitively difficult
or impossible to obtain all the Jacobians and Hessians of the
considered nonlinear system.
In an early attempt [14], we presented the NERTSF (which
is revisited in the next section) to obtain the optimal recursive
state estimator for system (1)-(2) regardless of the values of
the unknown input vector. Note that, in [14] we used numerical
method to approximate the derivatives of the system model, by
which the obtained filtering performance may not have the best
one. Thus, the main aim of this paper is further developing a
more accurate and derivative-free alternative to the NERTSF in
achieving state estimation of complex nonlinear systems with
unknown inputs.
III. THE NERTSF FILTER REVISITED
First, using first-order Taylor approximations of (1)-(2), we
obtain the approximated nonlinear system as follows:
𝑥𝑘+1 ≈ 𝑓(?ˆ?𝑘∣𝑘, ?ˆ?∣𝑘, 𝑢𝑘, 0) +𝐴𝑘?˜?𝑘∣𝑘 +𝐺𝑘 ?˜?∣𝑘
+𝑁𝑘𝑤𝑘, (14)
𝑦𝑘 ≈ 𝑔(?ˆ?𝑘∣𝑘−1, ?ˆ?−1∣𝑘−1, 𝑢𝑘) + 𝐶𝑘?˜?𝑘∣𝑘−1
+𝐻𝑘(𝑑𝑘 − ?ˆ?−1∣𝑘−1) + 𝑣𝑘, (15)
where ?˜?𝑘∣𝑘 = 𝑥𝑘 − ?ˆ?𝑘∣𝑘, ?˜?∣𝑘 = 𝑑𝑘 − ?ˆ?∣𝑘, ?˜?𝑘∣𝑘−1 = 𝑥𝑘 −
?ˆ?𝑘∣𝑘−1, and
𝐴𝑘 =
∂𝑓(𝑥𝑘, 𝑑𝑘, 𝑢𝑘, 0)
∂𝑥𝑘
∣𝑥𝑘=?ˆ?𝑘∣𝑘,𝑑𝑘=ˆ𝑘∣𝑘 , (16)
𝐺𝑘 =
∂𝑓(𝑥𝑘, 𝑑𝑘, 𝑢𝑘, 0)
∂𝑑𝑘
∣𝑥𝑘=?ˆ?𝑘∣𝑘,𝑑𝑘=ˆ𝑘∣𝑘 , (17)
𝑁𝑘 =
∂𝑓(𝑥𝑘, 𝑑𝑘, 𝑢𝑘, 0)
∂𝑤𝑘
∣𝑥𝑘=?ˆ?𝑘∣𝑘,𝑑𝑘=ˆ𝑘∣𝑘 , (18)
𝐶𝑘 =
∂𝑔(𝑥𝑘, 𝑑𝑘, 𝑢𝑘)
∂𝑥𝑘
∣𝑥𝑘=?ˆ?𝑘∣𝑘−1,𝑑𝑘=ˆ𝑘−1∣𝑘−1 , (19)
𝐻𝑘 =
∂𝑔(𝑥𝑘, 𝑑𝑘, 𝑢𝑘)
∂𝑑𝑘
∣𝑥𝑘=?ˆ?𝑘∣𝑘−1,𝑑𝑘=ˆ𝑘−1∣𝑘−1 . (20)
Second, to slightly simplify the filter algorithm the follow-
ing notation is defined:
˜(?ˆ?𝑘∣𝑘−1, ?ˆ?−1∣𝑘−1, 𝑢𝑘)
= 𝑔(?ˆ?𝑘∣𝑘−1, ?ˆ?−1∣𝑘−1, 𝑢𝑘)−𝐻𝑘 ?ˆ?−1∣𝑘−1, (21)
by which Eq. (15) can be represented as
𝑦𝑘 ≈ ˜(?ˆ?𝑘∣𝑘−1, ?ˆ?−1∣𝑘−1, 𝑢𝑘) + 𝐶𝑘?˜?𝑘∣𝑘−1
+𝐻𝑘𝑑𝑘 + 𝑣𝑘. (22)
Third, using the (unknown input estimation) error decou-
pling technique in [7] to (14) and (22), we can obtain the
existence condition of the optimal filter as follows:
𝑟𝑎𝑛𝑘[𝑆𝑘] = 𝑟𝑎𝑛𝑘[𝐻𝑘] + 𝑟𝑎𝑛𝑘[Π𝑘−1], (23)
2012 7th IEEE Conference on Industrial Electronics and Applications (ICIEA) 1531
where
√
𝑀 is the matrix square root of 𝑀 and 𝜋𝑖 is a specific
𝑛-dimensional sampling vector satisfying
𝑛𝑥∑
𝑖=1
𝜋𝑖𝜋
𝑇
𝑖 = 𝐼𝑛, (48)
where 𝐼𝑛 is the identity matrix with dimension 𝑛.
Finally, the 𝑛𝑥 + 1 sampled points can be obtained as
follows:
𝑥𝑖,𝑘 = ?ˆ?𝑘 +
1
𝛼
Δ𝑥𝑖, 0 ≤ 𝑖 ≤ 𝑛𝑥, (49)
where 𝛼 is a scaling constant, and hence the covariance 𝑃 𝑥𝑘
can be approximated as
𝑃 𝑥𝑘 ≈ 𝛼2
𝑛𝑥∑
𝑖=0
𝑊𝑖 (𝑥𝑖,𝑘 − ?ˆ?𝑘) (𝑥𝑖,𝑘 − ?ˆ?𝑘)𝑇 . (50)
Remark 2: If the design parameters 𝑛𝑥, 𝑊0, 𝑊𝑖, and 𝜋𝑖 are
chosen as follows:
𝑛𝑥 = 𝑛, 𝑊0 = 0, 𝑊𝑖 =𝑊 =
1
𝑛
, 𝜋𝑖 = (𝐼𝑛)𝑖,
where (𝑀)𝑖 is the 𝑖th column of the matrix 𝑀 , then (45)-(50)
gives the results in [13]. Notice that, if the scaling constant
𝛼 is chosen as 𝛼 → ∞ then the obtained state estimates are
equivalent to those given by the EKF.
Remark 3: If the design parameters 𝑛𝑥, 𝑊0, 𝑊𝑖, and 𝜋𝑖 are
chosen as follows:
𝑛𝑥 = 2𝑛, 𝑊0 =
𝜅
𝑛+ 𝜅
, 𝑊𝑖 =𝑊 =
1
2(𝑛+ 𝜅)
,
𝜋𝑖 =
⎧⎨
⎩
0 𝑖 = 0
1/
√
2× (𝐼𝑛)𝑖 1 ≤ 𝑖 ≤ 𝑛
−1/√2× (𝐼𝑛)𝑖−𝑛 𝑛+ 1 ≤ 𝑖 ≤ 2𝑛
,
then (45)-(50) gives the results in [11].
C. The Derivative-Free Filter Derivation
Based on the weighted samples concept presented in the
previous subsection, the procedure in deriving a derivative-free
version of the NERTSF is highlighted in a three-stage steps,
as described below.
0) Filter initialization. At the initial stage, we first choose a
suitable ensemble set number 𝑛𝒳 based on the augmented state
𝒳 = [ 𝑥𝑇 ?¯? 𝑤𝑇 ]𝑇 . Then, we determine the scaling
constant 𝛼, the weighting matrices 𝑊𝑖, and the sampling
vectors 𝜋𝑖, where 𝑖 = 0, . . . , 𝑛𝒳 .
1) Time update stage. At the first stage, we update the
predicted state ?ˆ?𝑘∣𝑘−1 and its error covariance matrix 𝑃 𝑥𝑘∣𝑘−1
based on previous estimates. Define an ensemble set of vectors
about the known augmented state estimate:
𝒳𝑖,𝑘−1∣𝑘−1 = ?ˆ?−1∣𝑘−1 +
1
𝛼
Δ𝒳𝑖,𝑘−1, (51)
where
?ˆ?∣𝑘 =
[
?ˆ?𝑇𝑘∣𝑘
ˆ¯𝑑
𝑇
𝑘∣𝑘 0
]𝑇
, (52)
Δ𝒳𝑖,𝑘 =
√√√√√⎷ 1𝑊
⎡
⎢⎣ 𝑃
𝑥
𝑘∣𝑘 𝑃
𝑥 ¯
𝑘∣𝑘 0
𝑃
¯
𝑘∣𝑘 𝑃
¯
𝑘∣𝑘 0
0 0 𝑄𝑘
⎤
⎥⎦× 𝜋𝑖. (53)
In Eq. (52), the relationship Φ𝑘 ˆ¯𝑑𝑘∣𝑘 = ˆ¯𝑑𝑘∣𝑘 is used. Using (51)
in (25) yields
𝑥𝑖,𝑘∣𝑘−1 = 𝑓(𝒳𝑖,𝑘−1∣𝑘−1, 𝑢𝑘−1), (54)
which may be used to approximate the distribution of the
random variable 𝑥𝑘. Then, the predicted state mean ?ˆ?𝑘∣𝑘−1
can be obtained as follows:
?ˆ?𝑘∣𝑘−1 =
𝑛𝒳∑
𝑖=0
𝑊𝑖𝑥𝑖,𝑘∣𝑘−1. (55)
At last, the predicted error covariance matrix can be obtained
as follows:
𝑃 𝑥𝑘∣𝑘−1 = 𝛼
2
𝑛𝒳∑
𝑖=0
𝑊𝑖
(
𝑥𝑖,𝑘∣𝑘−1 − ?ˆ?𝑘∣𝑘−1
)
× (𝑥𝑖,𝑘∣𝑘−1 − ?ˆ?𝑘∣𝑘−1)𝑇 . (56)
2) Constraint update stage. At this stage, we estimate the
constraint matrix 𝑆𝑘. First of all, we determine the covariance
of the innovation, i.e., ?˜?𝑘, as below. Define the predicted
ensemble set of measurement as follows:
𝑦𝑖,𝑘∣𝑘−1 = 𝑔
∗(𝑥𝑖,𝑘∣𝑘−1,
ˆ¯𝑑𝑘−1∣𝑘−1, 𝑢𝑘), (57)
by which the predicted mean is given as
?ˆ?∣𝑘−1 =
𝑛𝒳∑
𝑖=0
𝑊𝑖𝑦𝑖,𝑘∣𝑘−1. (58)
Thus, ?˜?𝑘 in (27) can be obtained as follows:
?˜?𝑘 = 𝛼
2
𝑛𝒳∑
𝑖=0
𝑊𝑖(𝑦𝑖,𝑘∣𝑘−1 − ?ˆ?∣𝑘−1)(𝑦𝑖,𝑘∣𝑘−1 − ?ˆ?∣𝑘−1)𝑇
+𝑅𝑘. (59)
Let ℛ ∈ 𝑅𝑚×𝑛 be an arbitrary matrix that satisfies the
relationship ℛℛ𝑇 = ?˜?𝑘 −𝑅𝑘. Comparing (59) with (27), it
is clear that the output matrix 𝐶𝑘 can be approximated as
follows:
ˆ
𝑘 = ℛ× (𝑃 𝑥𝑘∣𝑘−1)−1/2. (60)
Using (60), we can obtain the matrix 𝑆𝑘 in (24) as follows:
ˆ
𝑘 =
[
?ˆ?𝑘 ˆ𝑘Πˆ𝑘−1
]
. (61)
3) Measurement update stage. At the final stage, we esti-
mate the gain matrix 𝐾𝑘 in (32) as below. Rewriting (33) as
follows:
𝐿𝑘 = 𝐾𝑘(𝐼 − ˆ𝑘 ˆ∗𝑘) + ˜𝑘, ˜𝑘 =
[
0 Πˆ𝑘−1
]
ˆ∗
𝑘 ,
and substituting which into (35), we obtain
?ˆ?𝑘∣𝑘 = ?ˆ?𝑘∣𝑘−1 +
(
𝐾𝑘(𝐼 − ˆ𝑘 ˆ∗𝑘) + ˜𝑘
)
(𝑦𝑘 − ?ˆ?∣𝑘−1), (62)
which has the following covariance:
𝑃 𝑥𝑘∣𝑘 = 𝑃
𝑥
𝑘∣𝑘−1 +
˜
𝑘?˜?𝑘 ˜
𝑇
𝑘 − 𝑃 𝑥𝑦𝑘∣𝑘−1 ˜𝑇𝑘 − ˜𝑘(𝑃 𝑥𝑦𝑘∣𝑘−1)𝑇
+𝐾𝑘(𝐼 − ˆ𝑘 ˆ∗𝑘)?˜?𝑘(𝐼 − ˆ𝑘 ˆ∗𝑘)𝑇𝐾𝑇𝑘
−𝑃 𝑥𝑦𝑘∣𝑘−1(𝐼 − ˆ𝑘 ˆ∗𝑘)𝑇𝐾𝑇𝑘
−𝐾𝑘(𝐼 − ˆ𝑘 ˆ∗𝑘)(𝑃 𝑥𝑦𝑘∣𝑘−1)𝑇 , (63)
2012 7th IEEE Conference on Industrial Electronics and Applications (ICIEA) 1533
TABLE I
FILTERING PERFORMANCES OF EKF, NERTSF, AND DNERTSF.
Filter EKF NERTSF DNERTSF1 DNERTSF2
rmse 0.3387 0.2395 0.2388 0.2395
filter algorithms. Based on (89) and (90), the considered system
model can be rewritten as follows:
𝑥𝑘+1 = 0.5𝑥𝑘 + 25
𝑥𝑘
1 + 𝑥2𝑘
+
[
1 0
]
𝑑𝑘 + 𝑤𝑘,
𝑦𝑎𝑘 =
[
𝑥2
𝑘
20
𝑥𝑘
]
+
[
0 0
0 1
]
𝑑𝑘 + 𝑣
𝑎
𝑘 ,
where 𝑑𝑘 =
[
?˜? ?¯?
]𝑇
.
In the simulation, the EKF (6)-(13), the NERTSF (25)-(37),
and the DNERTSF (66)-(88) were considered. The simulation
has a length of 100 time steps with a Monte Carlo simulation of
50 runs. In this simulation case, we have the following system
matrices:
𝐴𝑎𝑘 =
⎡
⎣ 𝐴𝑘 1 00 1 0
0 0 1
⎤
⎦ , 𝑁𝑎𝑘 = 𝐼3, 𝐶𝑎𝑘 =
[ ?ˆ?𝑘∣𝑘−1
10
0 0
1 0 1
]
,
𝐴𝑘 =
25(1− ?ˆ?2𝑘∣𝑘)
(1 + ?ˆ?2𝑘∣𝑘)
2
+ 0.5, 𝑁𝑘 = 1, 𝐶𝑘 =
[ ?ˆ?𝑘∣𝑘−1
10
1
]
,
?ˆ?𝑘 = 𝐻𝑘 =
[
0 0
0 1
]
, ?ˆ?𝑘 = 𝐺𝑘 =
[
1 0
]
.
In implementing the proposed DNERTSF, the scaling param-
eter 𝛼 is chosen as 𝛼 = 1000 and two specific values of the
ensemble set number 𝑛𝒳 were considered: one is 𝑛𝒳 = 3 and
the other is 𝑛𝒳 = 6, which are highlighted in Remarks 1 and
2 and are referenced as the DNERTSF1 and the DNERTSF2,
respectively.
We list the root-mean-square-errors (rmse) in the state
estimates of the considered filters in Table 1. Furthermore,
we also illustrate in Figure 1 the absolute error in system state
estimate (50 run average) by using the EKF, the NERTSF, and
the DNERTSF. From the table and figure, we can obtain the
following results: 1) all four filters can effectively estimate
the system state; however, the filtering performances of the
proposed NERTSF and DNERTSF are slightly better than that
of the EKF, 2) the filtering performance of the DNERTSF1 is
slightly better (almost the same) than that of the NERTSF, and
3) the DNERTSF2 has the same performance as the NERTSF.
VI. CONCLUSION
In this paper, an alternative unknown input filtering algo-
rithm other than the EKF, named as the NERTSF, is introduced
as an effective mean for the state estimation problem of
nonlinear systems with unknown inputs. Moreover, a gen-
eral derivative-free version of the NERTSF, named as the
DNERTSF, is also developed for easy implementation and
more accurate state estimation. Simulation results show that
the filtering performance of the DNERTSF is comparable with
that of the NERTSF.
0 10 20 30 40 50 60 70 80 90 100
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
1.1
time
e(t
)
EKF
NERTSF
DNERTSF
Fig. 1. Absolute error in system state estimate (50 run average).
ACKNOWLEDGMENT
The author would like to thank the anonymous referees for
their insightful comments and suggestions.
REFERENCES
[1] P. K. Kitanidis, “Unbiased minimum-variance linear state estimation,”
Automatica, vol. 23, pp. 775-778, 1987.
[2] M. Darouach and M. Zasadzinski, “Unbiased minimum variance estima-
tion for systems with unknown exogenous inputs,” Automatica, vol. 33,
pp. 717-719, 1997.
[3] M. Hou and R. J. Patton, “Optimal filtering for systems with unknown
inputs,” IEEE Trans. Automat. Contr., vol. 43, pp. 445-449, 1998.
[4] C.-S. Hsieh, “Robust two-stage Kalman filters for systems with unknown
inputs,” IEEE Trans. Automat. Contr., vol. 45, pp. 2374-2378, 2000.
[5] M. Darouach, M. Zasadzinski, and M. Boutayeb, “Extension of minimum
variance estimation for systems with unknown inputs,” Automatica, vol.
39, pp. 867-876, 2003.
[6] S. Gillijns and B. De Moor, “Unbiased minimum-variance input and
state estimation for linear discrete-time systems with direct feedthrough,”
Automatica, vol. 43, pp. 934-937, 2007.
[7] C.-S. Hsieh, “On the global optimality of unbiased minimum-variance
state estimation for systems with unknown inputs,” Automatica, vol. 46,
pp. 708-715, 2010.
[8] Y. Cheng, H. Ye, Y. Wang, and D. Zhou, “Unbiased minimum-variance
state estimation for linear systems with unknown input,” Automatica, vol.
45, pp. 485-491, 2009.
[9] C.-S. Hsieh, “Extension of unbiased minimum-variance input and state
estimation for systems with unknown inputs,” Automatica, vol. 45, pp.
2149-2153, 2009.
[10] M. Norgaard, N. K. Poulsen, and O. Ravn, O. “New developments in
state estimation for nonlinear systems,” Automatica, vol. 36, pp. 1627-
1638, 2000.
[11] S. Julier, J. Uhlmann, and H. Durrant-White, “A new method for non-
linear transformation of means and covariances in filters and estimators,”
IEEE Trans. Automat. Contr., vol. 45, pp. 477-482, 2000.
[12] J. H. Kotecha and P. M. Djuric, “Gaussian particle filtering,” IEEE Trans.
Signal Processing, vol. 51, no. 10, pp. 2592-2601, 2003.
[13] B. M. Quine, “A derivative-free implementation of the extended Kalman
filter,” Automatica, vol. 42, pp. 1927-1934, 2006.
[14] C.-S. Hsieh and D.-C. Liaw, “Traffic state estimation within unknown
input filtering framework,” In Proceedings of 2011 International Confer-
ence on Service and Interactive Robots, pp. 25-30, 2011.
[15] L. Mihaylova, R. Boel, and A. Hegyi, “Freeway traffic estimation within
particle filtering framework,” Automatica, vol. 43, pp. 290-300, 2007.
2012 7th IEEE Conference on Industrial Electronics and Applications (ICIEA) 1535
this research is to evaluate the ﬁltering performance of the
DNERTSF for application to a complex nonlinear system, e.g.,
the aforementioned trafﬁc state estimation.
II. STATEMENT OF THE PROBLEM
Consider the general nonlinear system with unknown inputs
as follows:
xk+1 = f(xk, dk, wk, uk), (1)
yk = g(xk, dk, uk) + vk, (2)
where xk ∈ Rn is the state vector, dk ∈ Rp the unknown input
vector, uk ∈ Rq the known input vector, and yk ∈ Rm the
measured output. The process noise wk and the measurement
noise vk are uncorrelated white sequences of means w¯k and
v¯k and covariance matrices Qk > 0 and Rk > 0, respectively.
The initial state x0 is with unbiased mean x¯0 and covariance
P¯ x0 and is independent of wk and vk.
A well-known approach used for the state estimation of
nonlinear systems is to apply the EKF, where the dynamics of
the unknown inputs is pre-assumed and used. Unfortunately,
the EKF may not yield the optimal performance of system (1)-
(2) due to the lack of the dynamical model of the unknown
input vector dk (see [17] for an illustration). Thus, a prompt
need to the UIF problem for nonlinear systems is to develop an
optimal recursive state estimation for system (1)-(2) regardless
of the values of the unknown input vector.
To improve on the EKF, we have derived the NERTSF,
where the model partial derivatives or their numerical approx-
imations are needed. In order to avoid the need for the calcu-
lation of model partial derivatives, in a companion paper [17]
we have derived the DNERTSF for general nonlinear systems
with unknown inputs. As addressed in the Introduction, the
DNERTSF is in the form of the ERTSF and it may be more
preferable to represent the former as in the form of the RTSKF.
Hence, the main aims of this paper are two folds: one is to
derive an alternative form of the DNERTSF in the form of the
RTSKF and the other is to assess the ﬁltering performance of
the DNERTSF (in the form of the RTSKF) for application to
dual trafﬁc state and parameter estimation problem.
III. THE DNERTSF FILTER REVISITED
For easy reference, a speciﬁc implementation of the
DNERTSF [17] is listed as below.
Step 0: Initialization
(xˆ0|0,
ˆ¯d0|0, P
x
0|0, P
xd¯
0|0, P
d¯
0|0, Πˆ0) = (x¯0, 0, P¯
x
0 , 0, 0, 0), (3)
with nX = n, α = 1000, Wi = 1/n, and πi = (In)i.
Step 1: Time update
Xi,k−1|k−1 =
[
xˆTk−1|k−1
ˆ¯d
T
k−1|k−1 w¯
T
k−1
]T
+
1
α
ΔXi,k−1 (4)
xi,k|k−1 = f(Xi,k−1|k−1, uk−1), (5)
xˆk|k−1 =
nX∑
i=0
Wixi,k|k−1, (6)
P xk|k−1 = α
2
nX∑
i=0
Wi
(
xi,k|k−1 − xˆk|k−1
)
× (xi,k|k−1 − xˆk|k−1)T , (7)
where
ΔXi,k =
√√√√√√ 1Wi
⎡
⎢⎣ P
x
k|k P
xd¯
k|k 0
P d¯xk|k P
d¯
k|k 0
0 0 Qk
⎤
⎥⎦× πi. (8)
Step 2: Estimation of unknown input
yi,k|k−1 = g(xi,k|k−1,
ˆ¯dk−1|k−1, uk) + v¯k
−Hˆk ˆ¯dk−1|k−1, (9)
yˆk|k−1 =
nX∑
i=0
Wiyi,k|k−1, (10)
R˜k = Rk + α
2
nX∑
i=0
Wi(yi,k|k−1 − yˆk|k−1)
×(yi,k|k−1 − yˆk|k−1)T , (11)
Cˆk = R× (P xk|k−1)−1/2, (12)
Sˆk =
[
Hˆk CˆkΠˆk−1
]
, (13)
Sˆ∗k = (Sˆ
T
k R˜
−1
k Sˆk)
+SˆTk R˜
−1
k , (14)
Mk =
[
Φk 0
]
Sˆ∗k , Φk = Hˆ
+
k Hˆk, (15)
ˆ¯dk|k = Mk(yk − yˆk|k−1), (16)
P d¯k|k = MkR˜kM
T
k , (17)
where R satisﬁes the relationship RRT = R˜k−Rk and Hˆk =[
Hˆ1k · · · Hˆpk
]
, in which
Hˆjk = (g(xˆk|k−1,
ˆ¯dk−1|k−1 +Δj × ejp, uk)
−g(xˆk|k−1, ˆ¯dk−1|k−1, uk))/Δj , (18)
Step 3: Measurement update
Kk = α
2
nX∑
i=0
Wi(xi,k|k−1 − xˆk|k−1)
×(yi,k|k−1 − yˆk|k−1)T R˜−1k , (19)
Lk = Kk +
([
0 Πˆk−1
]−KkSˆk) Sˆ∗k , (20)
Ψk = R˜k(Lk −Kk)T , (21)
xˆk|k = xˆk|k−1 + Lk(yk − yˆk|k−1), (22)
P xk|k = P
x
k|k−1 − LkR˜kLTk + LkΨk + (LkΨk)T , (23)
2012 7th IEEE Conference on Industrial Electronics and Applications (ICIEA) 1845
R˜k = Rk + α
2
nX∑
i=0
Wi(yi,k|k−1 − yˆk|k−1)
×(yi,k|k−1 − yˆk|k−1)T , (53)
xˆk|k−1 =
nX∑
i=0
Wixi,k|k−1, (54)
P xk|k−1 = α
2
nX∑
i=0
Wi
(
xi,k|k−1 − xˆk|k−1
)
× (xi,k|k−1 − xˆk|k−1)T , (55)
Kk = α
2
nX∑
i=0
Wi(xi,k|k−1 − xˆk|k−1)
×(yi,k|k−1 − yˆk|k−1)T R˜−1k , (56)
x¯k|k = xˆk|k−1 +Kk(yk − yˆk|k−1), (57)
P x¯k|k = P
x
k|k−1 −KkR˜kKTk , (58)
dˆk|k is given as follows:
Cˆk = R× (P xk|k−1)−1/2, (59)
Hˆjk = (g(xˆk|k−1, Φ¯k−1dˆk−1|k−1 +Δj × ejp, uk)
−g(xˆk|k−1, Φ¯k−1dˆk−1|k−1, uk))/Δj , (60)
Sˆk =
[
Hˆ1k · · · Hˆpk CˆkΠˆk−1
]
, (61)
Sˆ∗k = (Sˆ
T
k R˜
−1
k Sˆk)
+SˆTk R˜
−1
k , (62)
dˆk|k = Sˆ
∗
k(yk − yˆk|k−1), (63)
P dk|k = Sˆ
∗
kR˜k(Sˆ
∗
k)
T , (64)
and
Vk =
[
0 Πˆk−1
]−KkSˆk, (65)
Gˆjk =
f(xˆk|k, Φ¯kdˆk|k +Δj × ejp)− f(xˆk|k, Φ¯kdˆk|k)
Δj
, (66)
Πˆk =
[
Gˆ1k · · · Gˆpk
]
(I − Φk). (67)
Remark 1: If the identiﬁed distribution matrix Hˆk is of full-
column rank, one has Φ¯k = Φk = I , Πˆk = 0, and Sˆk = Hˆk,
which yields the following simpliﬁed matrices:
Sˆ∗k = (Hˆ
T
k R˜
−1
k Hˆk)
−1HˆTk R˜
−1
k , Vk = −KkHˆk.
Thus, the additive calculation of the auxiliary matrices Cˆk and
Gˆk, given by (59) and (66), respectively, can be relaxed. More-
over, comparing (23) with (47), it is clear that the DNRTSKF
is more computationally attractive than the DNERTSF due to
the fact that m ≥ p.
Remark 2: Unlike the DNERTSF, the x¯k|k ﬁlter of the new
proposed DNRTSKF resembles the conventional UKF [10].
Thus, the DNRTSKF serves as an effective ﬁlter structure to
bridge the gap for state estimation of nonlinear systems with
or without unknown inputs, where it clearly shows how to
integrate the best unknown input estimate into the main state
estimate in order to obtain the optimal system state estimate.
VI. APPLICATION TO TRAFFIC STATE ESTIMATION
A. Stochastic Trafﬁc Model
The trafﬁc model considered in this paper is the composi-
tional stochastic macroscopic trafﬁc model [7], which can be
highlighted as below.
(1) Forward wave (i = 1, 2, . . . , n). The sending function
Si,k is given as follows:
Si,k = Qi,k
= max
(
Ni,k
vi,kΔtk
Li
+ ηSi,k, Ni,k
vminΔtk
Li
)
,(68)
where Qi,k is the number of vehicles leaving segment i and
entering segment i+1 during the interval [tk, tk+1), Ni,k is the
number of vehicles counted in segment i at time tk, vi,k is their
average speed, Li is the length of segment i, Δtk = tk+1− tk
is the sampling interval, vmin is the minimum vehicle speed,
and ηSi,k is a white noises sequence of zero-mean, reﬂecting
random ﬂuctuations in the trafﬁc states and modeling errors.
(2) Backward wave (i = n, n − 1, . . . , 1). The receiving
function Ri,k is given as follows:
Ri,k = N
max
i+1,k −Ni+1,k +Qi+1,k, (69)
where
Nmaxi+1,k =
Li+1li+1,k
Al + vi+1,ktd
, (70)
in which li+1,k is the number of lanes in segment i+1 at time
tk, Al is the average length of vehicles, and td is the safe time
distance between two vehicles. Then, update Qi,k and vi,k as
follows if Si,k ≥ Ri,k:
Qi,k = Ri,k, vi,k =
Qi,kLi
Ni,kΔtk
. (71)
(3) Update the number of vehicles inside segments (i =
1, 2, . . . , n):
Ni,k+1 = Ni,k +Qi−1,k −Qi,k. (72)
(4) Update the trafﬁc density (i = 1, 2, . . . , n):
ρi,k+1 =
Ni,k+1
Lili,k+1
, (73)
ρantici,k+1 = αρi,k+1 + (1− α)ρi+1,k+1, (74)
where the coefﬁcient α ∈ (0, 1] weighs how far ahead the
drivers are looking in order to adapt their speed.
(5) Update of the average speed (i = 1, 2, . . . , n):
vinteri,k+1 =
{
vi−1,kQi−1,k+vi,k(Ni,k−Qi,k)
Ni,k+1
Ni,k+1 = 0,
vf otherwise,
(75)
v¯interi,k+1 = max
(
vinteri,k+1, vmin
)
, (76)
vi,k+1 = β
i
k+1v¯
inter
i,k+1 + (1− βik+1)ve(ρantici,k+1)
+ηvi,k, (77)
where vf is the free-ﬂow speed, β
i
k+1 ∈ (0, 1] tunes the model
by weighting how aggressively drivers adjust their speed to
2012 7th IEEE Conference on Industrial Electronics and Applications (ICIEA) 1847
TABLE I
PERFORMANCE OF THE EKF, NRTSKF, AND DNRTSKF.
Filter N˜1 v˜1 N˜2 v˜2 N˜3 v˜3 N˜4 v˜4
EKF 7.01 5.46 1.42 7.55 1.02 4.23 0.84 3.78
NRTSKF 2.93 5.08 1.48 8.49 1.05 5.78 1.14 6.45
DNRTSKF NA NA NA NA NA NA NA NA
where Xk =
[
xTk ρcrit,k am,k
]T
is the augmented state
vector involving the original system state and the partial
unknown system parameters: ρcrit and am, and dk = vf is the
new unknown input. Note that, in (86) the sub-states ρcrit,k and
am,k are all modeled as random walk processes. Furthermore,
in reducing the noise effect, the obtained unknown input
estimate of the NRTSKF (16) is further processed by using
the following lowpass ﬁlter:
vˆf,k = 0.65× vˆf,k−1 + 0.35× ˆ¯dk|k,
where vˆf,0 = 0. Notice that, in implementing both the EKF
and the NRTSKF the numerical approximation method is used
to calculate the model partial derivatives.
We illustrate the root-mean-square-errors (rmse) in the state
estimates of the EKF and the NRTSKF in Table 1. To further
assess the ﬁltering performances of the EKF and the NRTSKF,
we use the root-mean-square-relative-errors (rmsre) [10], by
which we obtain
rmsre(EKF ) = 0.087, rmsre(NRTSKF ) = 0.073.
This suggests that the NRTSKF may have better ﬁltering
performance than the EKF although they have comparable
performances.
As shown in the companion paper [17], the DNERTSF may
have a comparable estimation performance with that of the
original NERTSF. This comparable performance might also
be true for the DNRTSKF and the NRTSKF in application to
the trafﬁc state estimation problem. Unfortunately, the ﬁltering
performance of the DNRTSKF is not available at the present
due to some implementation problems. In the near future, we
will continue to evaluate the performance of the DNRTSKF.
VII. CONCLUSION
In this paper, an alternative nonlinear estimation with un-
known input ﬁltering method other than the EKF and the
recently developed NERTSF is proposed as an effective mean
for the dual state and parameter estimation problem of a trafﬁc
state ﬂow model. It is noted that the new proposed nonlinear
ﬁlter, named as the NRTSKF, is more computationally attrac-
tive than the original NERTSF for some cases. Simulation
results showed that the NRTSKF may have better ﬁltering
performance than the EKF. A derivative-free implementation
of the NRTSKF, known as the DNRTSKF, is also proposed
for application to solve the state estimation problem of more
complex nonlinear systems with unknown inputs, where model
partial derivatives are difﬁcult or impossible to compute.
The evaluation of the ﬁltering performance of the DNRT-
SKF is under investigation.
ACKNOWLEDGMENT
The authors would like to thank the anonymous referees for
their insightful comments and suggestions.
REFERENCES
[1] R. Boel and L. Mihaylova, “Modelling freeway networks by hybrid
stochastic models,” In Proceedings of the IEEE intelligent vehicles
symposium, pp. 182-187, 2004.
[2] L. Mihaylova, R. Boel, and A. Hegyi, “Freeway trafﬁc estimation within
particle ﬁltering framework,” Automatica, 43, pp. 290-300, 2007.
[3] D. Helbing, “Trafﬁc and related self-driven many-particle systems,”
Reviews of Modern Physics, 73, pp. 1067-1141, 2002.
[4] A. Kotsialos, M. Papageorgiou, C. Diakaki, Y. Pavlis, and F. Middelham,
“Trafﬁc ﬂow modeling of large-scale motorway using the macroscopic
modeling tool METANET,” IEEE Transactions on Intelligent Transporta-
tion Systems, 3(4), pp. 282-292, 2002.
[5] C. Daganzo, “The cell transmission model: a dynamic representation of
highway trafﬁc consistent with the hydrodynamic theory,” Transportation
Research B, 28B(4), pp. 269-287, 1994.
[6] C. F. Daganzo, “A ﬁnite difference approximation of the kinematic wave
model of trafﬁc ﬂow,” Transportation Research B, 29B(4), pp. 261-276,
1995.
[7] R. Boel and L. Mihaylova, “A compositional stochastic model for real-
time freeway trafﬁc simulation,” Transportation Research B, 40(4), pp.
319-334, 2006.
[8] X. Sun, L. Munoz, and R. Horowitz, “Highway trafﬁc state estimation
using improved mixture Kalman ﬁlters for effective ramp metering
control,” In Proceedings of the 42nd IEEE conference on Decision and
Control, pp. 6333-6338, 2003.
[9] Y. Wang and M. Papageorgiou, “Real-time freeway trafﬁc state estima-
tion based on extended Kalman ﬁlter: A general approach,” Transporta-
tion Research B, 39(2), pp. 141-167, 2005.
[10] A. Hegyi, R. Girimonte, B. Babuska, and B. De Schutter, “A comparison
of ﬁlter conﬁgurations for freeway trafﬁc state estimation,” In Proceed-
ings of the IEEE ITSC conference on intelligent transportation systems,
pp. 1029-1034, 2006.
[11] D. B. Work and A. M. Bayen, “An ensemble Kalman ﬁltering approach
to highway trafﬁc estimation using GPS enabled mobile devices,” In
Proceedings of the 47th IEEE conference on Decision and Control, pp.
5062-5068, 2008.
[12] P. K. Kitanidis, “Unbiased minimum-variance linear state estimation,”
Automatica, 23, pp. 775-778, 1987.
[13] Y. Cheng, H. Ye, Y. Wang, and D. Zhou, “Unbiased minimum-variance
state estimation for linear systems with unknown input,” Automatica,
vol. 45, pp. 485-491, 2009.
[14] C.-S. Hsieh, “On the global optimality of unbiased minimum-variance
state estimation for systems with unknown inputs,” Automatica, 46, pp.
708-715, 2010.
[15] C.-S. Hsieh, “Extension of unbiased minimum-variance input and state
estimation for systems with unknown inputs,” Automatica, 45, pp. 2149-
2153, 2009.
[16] C.-S. Hsieh and D.-C. Liaw, “Trafﬁc state estimation within unknown
input ﬁltering framework,” In Proceedings of 2011 International Con-
ference on Service and Interactive Robots, pp. 25-30, 2011.
[17] C.-S. Hsieh, “State estimation for nonlinear systems with unknown
inputs,” In Proceedings of The 7th IEEE Conference on Industrial
Electronics and Applications, Singapore, 2012.
[18] S. Julier, J. Uhlmann, and H. Durrant-White, “A new method for nonlin-
ear transformation of means and covariances in ﬁlters and estimators,”
IEEE Transactions on Automatic Control, 45, pp. 477-482, 2000.
[19] B. M. Quine, “A derivative-free implementation of the extended Kalman
ﬁlter,” Automatica, 42, pp. 1927-1934, 2006.
[20] J. H. Kotecha and P. M. Djuric, “Gaussian particle ﬁltering,” IEEE
Transactions on Signal Processing, 51, no. 10, pp. 2592-2601, 2003.
[21] C.-S. Hsieh, “Robust two-stage Kalman ﬁlters for systems with unknown
inputs,” IEEE Transactions on Automatic Control, 45, pp. 2374-2378,
2000.
[22] M. Norgaard, N. K. Poulsen, and O. Ravn, O. “New developments in
state estimation for nonlinear systems,” Automatica, vol. 36, pp. 1627-
1638, 2000.
2012 7th IEEE Conference on Industrial Electronics and Applications (ICIEA) 1849
Technical Program Chair 
for ICIEA 2012 
 
 
 
Comments from Reviewer(s): 
This paper is concerned with the state estimation problem for nonlinear systems with unknown inputs. A 
nonlinear version of the previously proposed extended recursive threestep filter, named as the NERTSF, is 
further proposed to facilitate the design. A general derivative-free version of the NERTSF is also proposed 
for avoiding the need for the calculation of matrix partial derivatives. It is shown that this new filter may have 
better performance than that of the celebrated extended Kalman filter (EKF). An example is given to 
illustrate its effectiveness. By my evaluation, it is acceptable for a conference paper. On Line 6, Section IV, 
an unkown reference appears. Please correct it. 
The papers presents an method for unknown input filtering. It becomes not clear what extension are 
responsible for the better performance in comparison to the NERTSF Filter design. The authors refer mainly 
to their own papers. Please extend the litera! ture reference. In section IV. first paragraph: The DD1 filter .... 
the correct reference is missing  
Although the paper is a novel combination of existing techniques,but it is not clearly written.and it does not 
motivate the presented research. 
This research extended ERTSF to a more general version, and a calculational improvement was also 
developed to avoid the calculation of matrix partial derivatives. But the English writing is no so good, please 
touch up and correct some small mistakes if possible. 
100年度專題研究計畫研究成果彙整表 
計畫主持人：謝劍書 計畫編號：100-2221-E-233-002- 
計畫名稱：下世代智慧型公車運輸系統之研發--子計畫二：未知信號估測技術應用在動態候車人數估
測之研究(II) 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 2 2 100%  
研討會論文 3 3 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 2 2 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 1 1 100%  
研究報告/技術報告 0 0 100%  
研討會論文 5 5 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
