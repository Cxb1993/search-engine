在第三年中，我們利用無線通訊技術和全球定位系統的資
訊，繪製出使用者在不同時間點上的位置；導入其他感測元
件及各種感測系統的應用，改善個人定位系統，開發團隊導
航系統；實驗及分析感測模組在汽車運動時產生之數值變
化；開發道路坡度系統；利用感測模組記錄汽車行進過程中
的所有數值變化，並試圖復原汽車立體運動軌跡。 
中文關鍵詞： 感測器、加速度計、磁力計、電子陀螺儀、計步器、個人定
位系統、GPS、個人導航系統、G-constellation、軌跡復
原、道路坡度 
英 文 摘 要 ： The subproject is planned to be a three-year project. 
The main goal in research is to provide the perfect 
personal positioning, enabling application programs 
to utilize these locations when offering location-
based services. 
With the progress of the relevant technology of the 
semiconductor, the technology of Micro-Electro-
Mechanical Systems (MEMS) and sensors are improving 
in recent years. Though the volume of the electronic 
elements shrinks day by day, but the function is 
strengthened big. The degree of the accuracy reaches 
a suitable good level, so they get more and more 
attention from many research groups. Because wireless 
sensor network is with low cost, efficient power 
usage, small volume, easy deployment and dynamic 
composition, it is very suitable for practical 
application. Therefore, the industry and academia 
spend a lot of time to study and develop. Traditional 
localization method, the location of the sensing 
device is fixed, so it is easier to calibrate the 
accumulative errors. Also, the determination on the 
direction is comparatively simple and easy. The 
difficulty on dealing the data is proportional with 
the distance of the position of the sensor relative 
to the ground. Especially in the case of handheld 
devices, because there is no so-called resetting 
point, the degree of difficulty is high. 
So, the goal of this subproject tried improving the 
accuracy of mechanical components in handheld devices 
and integrating different positioning systems in 
order to provide a pervasive positioning service. 
This system is not limited to the specific areas or 
 行政院國家科學委員會補助專題研究計畫
■成果報告   
□期中進度報告 
 
異質網路環境之行動搜尋關鍵技術-子計畫四：以感測系統為
基礎之整合式室內及室外定位系統(3/3) 
 
計畫類別：□ 個別型計畫  ■ 整合型計畫 
計畫編號：NSC97-2221-E-009-052-MY3 
執行期間：99 年 08 月 01 日至 100 年 07 月 31 日 
 
計畫主持人：易志偉 教授 
共同主持人： 
計畫參與人員：蘇釗民、莊宜達、陳依廷、周家偉、楊凱全、邱柏鈞、
陳宗隆、鄭淵舟、黃怡葴、薛丞宏 
 
 
成果報告類型(依經費核定清單規定繳交)：□精簡報告  ■完整報告 
 
本成果報告包括以下應繳交之附件： 
□赴國外出差或研習心得報告一份 
□赴大陸地區出差或研習心得報告一份 
■出席國際學術會議心得報告及發表之論文各一份 
□國際合作研究計畫國外研究報告書一份 
 
處理方式：除產學合作研究計畫、提升產業技術及人才培育研究計畫、
列管計畫及下列情形者外，得立即公開查詢 
          ■涉及專利或其他智慧財產權，□一年■二年後可公開查詢 
          
執行單位：國立交通大學資訊工程學系(所) 
 
中   華   民   國 100 年 7 月 31 日
附件一 
 II 
英文摘要： 
The subproject is planned to be a three-year project. The main goal in research is to provide 
the perfect personal positioning, enabling application programs to utilize these locations when 
offering location-based services. 
With the progress of the relevant technology of the semiconductor, the technology of 
Micro-Electro-Mechanical Systems (MEMS) and sensors are improving in recent years. Though 
the volume of the electronic elements shrinks day by day, but the function is strengthened big. 
The degree of the accuracy reaches a suitable good level, so they get more and more attention 
from many research groups. Because wireless sensor network is with low cost, efficient power 
usage, small volume, easy deployment and dynamic composition, it is very suitable for practical 
application. Therefore, the industry and academia spend a lot of time to study and develop. 
Traditional localization method, the location of the sensing device is fixed, so it is easier to 
calibrate the accumulative errors. Also, the determination on the direction is comparatively 
simple and easy. The difficulty on dealing the data is proportional with the distance of the 
position of the sensor relative to the ground. Especially in the case of handheld devices, because 
there is no so-called resetting point, the degree of difficulty is high. 
So, the goal of this subproject tried improving the accuracy of mechanical components in 
handheld devices and integrating different positioning systems in order to provide a pervasive 
positioning service. This system is not limited to the specific areas or environments and is able to 
offer the basic and most important position information to location-based services. We can use 
the new navigation system in various kinds of application systems, for instance, in the travel 
guiding systems, automatic road detecting systems, athlete learning systems and amusements. 
As a consequence, the goal of this subproject is with three-fold: (1) Survey sensing devices 
systematically and completely; (2) Implement a personal navigation system; (3) Improve the 
personal navigation system and develop the navigation system for the group. It is planned to be 
finished within three years. 
In the first year, we have finished the analytic work on the functionality of the sensors. In the 
second year, we have implemented a personal navigation system. We extract three information, 
steps, strides and directions, from the raw readings of the sensors. It can be applied in handheld 
devices. The detail equations of distance, acceleration and angle velocity are derived. In the third 
year, we focus on improving personal navigation system and developing the navigation system 
for the group. Besides, experiments are conducted to analyze the variations of the reading during 
the movement. The detection on the upper and lower slopes will be integrated in the navigation 
systems. The records from the system can help to restore the automobile three-dimensional sport 
trajectory. 
Keywords: Sensor, Accelerometer, Magnetometer, Gyroscope, Pedometer, Personal 
Navigation System, GPS, G-constellation, Trajectory Recovery, Road Slope
 2 
系統的精準度，以提供一個無所不在的定位服務系統，這樣的一個準確性高且不受地域及
環境限制的定位系統，可提供各類網路系統及位置感知服務系統運作所需最基本且最重要
的位置資訊。我們可將新的定位系統使用在各種的應用系統，如：高準確性的導航系統、
旅遊導覽系統、自動路況偵測系統、運動員的學習輔助系統及創新的娛樂遊戲等。 
精確的定位系統在目前的網路環境中漸漸成為不可或缺的一環。在位置感知服務系統
中，位置資訊是最基本的核心資訊所在，不論資料的價值度或搜尋條件的設定，都少不了
定位系統的輔助。在無線隨意及感測網路中，位置資訊可用在路徑找尋、覆蓋率的計算、
網路系統能源的節省上，而且常是相關演算法決策中的重要參考。因此定位系統的準確性
自是不言而喻的。另外，學術界及產業界對無線感測網路的研究已進行了相當長的時間，
但卻一直苦無重要的殺手級應用出現，致使人們開始質疑無線感測網路系統的實用性。在
本計畫中，我們希望透過滲透率相當高的手持定位系統內建感測元件的方式，為無線感測
網路系統的未來開啟一種條可能的發展模式。 
第三年中，我們利用無線通訊技術和 GPS 的資訊，繪製出使用者在不同時間點上的位
置。導入其他感測元件及各種感測系統的應用，改善個人定位系統，開發團隊導航系統。
實驗及分析感測模組在汽車運動時產生之數值變化。開發道路坡度系統。利用感測模組記
錄汽車行進過程中的所有數值變化，並詴圖復原汽車立體運動軌跡。 
在未來，我們將持續提高個人定位的精確性，並開發個人定位系統在各方面的應用，
期望能對智慧化生活的理想有所貢獻。 
 
 
三、研究成果 
第一年 
在第一年的研究中，我們主要的研究方向在於 1. 針對各個感測元件提出有系統的研究
分析；2. 感測器數據分析。以下將對各階段研究做更詳細的說明。 
1. 針對各個感測元件提出有系統的研究分析 
在本計劃中，我們會使用到的感測元件有：加速度計、電子陀螺儀、角速度計、磁力
計等。由於市面上所售之感測元件的製造商及規格種類繁多，不同規格之元件用途也不同，
不同製造商之元件傳輸資料的格式亦不盡相同。因此首先我們要尋找合適的感測元件，舉
例來說：就加速度計而言，若主要用途為感測人類行走時加速度的變化，則所能感測的重
力值範圍不需太大；但為了能精確的做出定位，加速度計的誤差必頇越小越好。 
然而每個感測元件在出廠後，雖然硬體的規格都相同，但由於本身硬體會有些許誤差，
造成讀數有平移或縮放的現象，我們將使用各種可能的方法，比如線性方程式等，求出感
測元件的縮放比例，才能真正有效校正所得到的資料。 
感測元件的校正大致可分為兩大類型：「單一元件校正」以及「多元件校正」。以圖 1
為例，這是某家廠牌的三軸加速度感測元件在靜止狀態下所得到的原始讀數，根據規格，
一單位地心引力(1G)對應的感測元件讀數為 480 單位，然而經過 ADC (Analog to Digital 
Converter)的數位化過程，收到的讀數並未代表實際的物理量。經過初步的「單一元件校正」，
感測元件已經可反應出某種規模的真實物理量。然而在感測元件的應用中，為了達到較為
客觀且正確的數據，通常會使用多個感測元件，此時就需要「多元件校正」技術。「單一元
件校正」和「多元件校正」的目的，都是為了減少感測元件的誤差，以求達到高精度數據
的收集，有了正確的資料，便可以進行接下來的所有應用和實驗。 
 4 
 
圖 2 使用者步行 5 步的加速度資料 
 
先考慮步行距離，就理論而言，將前進方向加速度積分兩次，即可得到位移。欲得到
前進方向的加速度，首先必頇將重力向量自原始加速度向量中移除，再將水平方向加速度
與垂直方向加速度分離，最後再將水平方向加速度分解為前進分量與側向分量，如圖 3 所
示。為了得到重力向量，我們可以要求配戴者靜止一段時間(因靜止時僅受到重力作用)以取
得靜止時各軸方向的平均加速度當作重力向量，令其為 0G

，之後將讀取到的數據減掉 0G

即
可，我們令該向量為G

；接著將G

對 0G

做投影得到即為垂直分量；再利用G

- GG

0
Proj 可求
得水平分量。最後，我們將利用前進分量大於側向分量這個特性，藉著資料統計與主成分
分析(PCA: Principle Component Analysis)的方式，分離出前進方向的加速度。得到前進加速
度後，我們可以選擇用直接積分兩次的方法得到位移，或是透過實驗統計與記錄一個步行
週期的加速度變化量和步行速度，用迴歸分析的方式，如圖 4 所示，求出加速度變化量與
步距之間的轉換公式。 
 
 
圖 3 將加速度分解成前進分量與側向分量 
 
 6 
 
 
圖 5 感測器的累積誤差 
 
根據前述，累積誤差會因為配戴位置的不同而有所變化，故此一階段我們針對各配戴
方式做實驗，並分析出合適的配戴方式，以該配戴方式為基礎開發計步程式。由於手機逐
漸變成日常生活中的一部分，人們常會用手機打電話、傳簡訊、瀏覽網頁、收發信等。針
對手持式設備開發的應用愈來愈多，種類也五花八門，以各作業系統平台上熱絡的市集即
可看出端倪。所以我們想以手持式設備做為我們研究的平台。如前所述，我們遭遇到的挑
戰相當大，要處理累積誤差，此為慣性感測元件的天敵，及操作誤差，來自使用者造成的
影響。 
接下來，我們針對開發計步程式來加以說明。計步程式的開發主要方式為樣本比對。
首先觀察實驗數據的規律性，找出適合用於判斷步行週期的樣本，此樣本必頇能適用於大
部份人的步行週期；接著將此樣本輸入程式中，使用程式掃描從感測模組讀取到的資料，
可得到在該筆資料中共有幾個步行週期，即代表配戴者行走幾步。然而，斷步的工作會因
為掃瞄視窗大小的不同而影響正確率。如果掃瞄視窗的設定過大，會造成步數的低估。另
一方面，如果將掃瞄視窗設定過小，則會造成步數的高估。由於步行的狀態會隨環境或地
點而變化，要求得一個全部適用的視窗大小並不容易，故我們採取雙重掃瞄視窗的技術。 
然而，此偵測出來的步行週期是否代表真實的步伐？有否可能是由雜訊產生的？因此，
為了處理操作誤差，我們還需設計出過濾器，來將雜訊過濾掉。這邊我們提出了一些經驗
法則，來幫助我們判斷此步行週期是否為真實的步伐。我們的方法如下：設一特徵集合為
F = {T, ΔA1, ΔA2, RA, Ih, X1}，其中 T 為一步的時間、ΔA1 為前半部垂直加速度的差、ΔA2 為
後半部垂直加速度的差、RA 則為 ΔA1 與 ΔA2的比例、Ih 為一水平加速度大小的指標、X1為
FFT 中頻率為 1 的係數。我們發現正常的步伐中，這些特徵都具有一定的範圍，故我們可
以藉由此特性來分辨真實的步伐與雜訊。因此，我們判斷的條件為 Lf < f < Uf , ∀f ∈ F。而這
些特徵的範圍則可以由實驗中得到，如表 1 所示，為實驗過程中所用到的臨界值。實驗結
果說明，我們的經驗法則能夠有效地過濾雜訊，將準確率提升至大約 95%以上，如表 2 所
示。 
 
 8 
座標系統下的量測值，其數學式為 BEBE GTG  。 
最後，在地球座標系統下的量測值，還需減去地球的重力加速度，才能得到此物體真
正受到運動方面的加速值。詳細的流程請見圖 6。有了純加速度之後，就可以計算位移了。 
 
 
圖 6 處理原始讀值的詳細步驟 
 
3. 推導出利用磁力計與電子陀螺儀計算行走方向之公式 
利用磁力計，我們可以得知目前配戴者所面對的方向與地球磁力線之夾角；利用電子
陀螺儀，我們可以得知配戴者所面對的方向在短時間內的角度變化。將上述兩項資訊經過
整合、處理、以及互相校正，我們即可得知配戴者行進的方向。 
首先介紹利用磁力計來找出設備的方位。如前所述，我們討論中的有兩種坐標系統，
地球坐標系統可以用三個尤拉角來描述轉換到設備坐標的過程：繞著 z 軸旋轉 yaw ( )角，
繞著 y 軸旋轉 pitch ( )角，繞著 x 軸旋轉 roll ( )角，故其對應的旋轉矩陣為 
 











100
0cossin
0sincos


R 、  









 




cos0sin
010
sin0cos
R 、  














cossin0
sincos0
001
R  
整體的旋轉矩陣為 
     


















coscossincoscossinsinsinsincossincos
sincoscoscossinsinsincossinsinsincos
sincossincoscos
RRRR  
而 roll 與 pitch 角可以用此設備目前的加速度向量來求得，即 
 
與 
 
最後，可由地球磁場向量與設備磁場向量的關係
EB
MRM  來得到 yaw 角，此 yaw 角
 10 
 
    圖 7 室外的軌跡重建                          圖 8 室內的軌跡重建 
 
 
       圖 9 計步系統結合 GPS                      圖 10 位置感知服務的例子 
 
5. 個人定位系統之誤差統計數據 
步數的誤差已於前幾章節展示過，而關於步距的誤差則可以參考表 3，如表所示，步
距的估計準確度相當高。磁力計計算的準確度則請見表 4。另外，手持設備的夾角的準確
度請見表 5。 
 
表 3 步距的準確度 
 
 12 
擷取定位相關資訊。筆記型電腦在本系統中擔任處理單元的角色，負責處理定位資訊及與
後端伺服器的溝通。後端伺服器則負責紀錄使用者的位置資訊及提供一個使用者介面。 
 
 
圖 11 客戶端的設備 
 
系統內的模組如圖 12 所示，由兩個主要的部份構成：PTS 模組與卡爾曼過濾器模組。
其中，PTS 模組即是我們第二年的研究成果，內有三個子模組：斷步模組、步距模組與方
向模組。三個模組利用加速度計與磁力計的讀數來計算所需的資訊。斷步模組負責判斷使
用者是否有前進；步距模組則負責估算使用者每一步的步距；方向模組負責計算使用者前
進的方向。這些資訊傳遞至卡爾曼過濾器模組來做進一步的處理。GPS 接收器定時發送符
合 NMEA 0183 格式的字串，內含有經度、緯度、水平精準度(HDOP)等，此水平精準度是
一個用來評估 GPS 數值信賴度的數值。由 GPS 接收器得到的字串亦傳送至卡爾曼過濾器模
組。卡爾曼過濾器模組融合感測器及 GPS 接受器的數據，以得到使用者的定位資訊。 
 
 
圖 12 個人導航系統的模組 
 
我們最終實作出來的個人導航系統，準確度相當高。圖 13 顯示出系統從感測器得到的
原始數值，而利用這些原始數值計算出來的步距與行進方向，則顯示於圖 14 中。若將個人
導航系統結合圖資，對使用者來說更為便利與直觀。由於個人行走相對於汽車行進的距離
來說，尺度較小，故圖 15 顯示出微觀的結果。 
 
 14 
 
圖 16 多人定位的系統架構 
 
脫隊警示功能：由於導遊不可能無時無刻的注意個人定位系統的情況，因此我們必頇
開發出一些警告機制，來確保團員與導遊間的距離在一定的範圍內；我們可以以導遊為中
心，展開半徑為數十或數百公尺的圓，並依照距離遠近，由近至遠將此圓劃分為三部份：
安全、提示、警告。在安全範圍內，系統不會做出任何警告；到了提示範圍內，系統會以
文字和週期性的震動提醒團員及導遊；在警告範圍內，系統會以文字與警告聲響告知團員
及導遊。此項功能並不難實作，以圖 17 為例，由於伺服器端存有各個使用者的位置資訊，
所以，伺服器端可以藉由計算兩個使用者的距離來判斷系統該做出何種回應。此功能可以
應用的情境相當廣泛，如朋友相約開車出遊，使用此系統可以掌握朋友的位置；或者如老
年人的居家照顧，以保護老年人的安全；又如兒童遊樂園，可以設定孩童們的活動範圍，
以避免發生危隩或被不知名人士帶走的情形。 
 
 
圖 17 多人定位系統的介面 
 
3. 移植個人導航系統至智慧型手機上 
將個人導航系統移植至智慧型手機上，整個程式大抵分成三個部份同時進行。主要部
 16 
 
圖 20 預測與校正的過程 
 
在我們的實驗中，constellation 是由三個 WiTilt v3 感測器所構成。每個感測器配備有一
個三軸的加速度計及一個單軸的陀螺儀，我們這邊僅有使用加速度計而已。此感測器提供
可選擇性的敏感度：1.5g、2g、4g 及 6g，此加速度計的誤差為±2mg/◦C，我們設定取樣率
為 90 赫茲。三個感測器固定在一個塑膠板上，構成一個邊長為 0.3m 的正三角形。感測器
的資料藉由藍芽介面傳送至電腦。 
感測器本身帶有誤差，甚至在感測器靜止的狀態下，感測器的數值都會有輕微的波動，
這些誤差會累積而影響精確度。圖 21 為此 constellation 保持靜止 30 秒，未使用 LSM 校正
與有使用 LSM 校正的結果比較。我們計算每個感測器和 constellation(由其重心來代表)由累
積誤差產生的偏移量，三個感測器及 constellation 分別位移 31.5m、23.3m、21.3m 及 18.8m。
我們可以看出，constellation 的狀況最為穩定。 
 
 
圖 21 constellation 靜止測詴 
 
除了靜止測詴，我們也有實施動態的實驗。舉例來說，constellation 沿著一 S 形的曲線
結果繪製在圖 22 中。由此圖可以看出，LSM 可以有效地將 constellation 拉回它原本應該行
 18 
5. 開發出以感測元件輔助的道路坡度系統 
由於世界各地經濟的進步，連帶石油的使用率也愈來愈高，尤其是開發中國家，石油
的使用和需求量更是可觀，而且隨著社會進步，人們開始有自己的交通工具，汽油的使用
量愈來愈大，但因為石油出產國的供應策略和儲存地底下的石油存量愈來愈少，造成最近
幾年的石油的減產，減產的影響就是供給少於需求，造成市面上汽油的價格的節節上升，
石油成本上升也帶動汽油的價格直線上揚，同樣的汽油量，人們需要付出更多的金錢去購
買，對生活開銷造成了一個負擔。所以，為了減低這方面的金錢消耗，一是減低汽機車的
使用，使用大眾交通工具或使用綠色能源的交通工具；另外就需要想辦法減低汽機車行駛
時的汽油消耗，由文獻中，我們得知路面的坡度和汽油的能源消耗會有相對的關係，當坡
度愈傾斜，汽油的消耗愈高，當道路坡度愈平順，消耗的油量就相對減少了許多，這得到
一個結論，想要讓汽油的消耗量減少，就盡量開在平緩的道路上，但這是一個片面的想法，
當汽車行駛在道路上，道路的選擇以最平順的道路為第一選擇，卻不考慮行駛距離的增加，
雖然可以減少了單位長度的汽油消耗率，但由於行駛距離的增加，反而可能消耗了更多的
汽油，造成了適得其反的效果。 
我們想到拿路段長度和坡度計算最低耗能的方法，去找出駕駛人走哪一條路徑的汽油
消耗量是最低的，讓駕駛者可以選擇，達到低耗能的效果。為了實現這種想法，最重要的
是要先實作出道路高度的資料庫，有了高度資料就可以知道道路的坡度如何，進而算出最
低耗能的路徑。 
我們將實作部分實作於 Google 地圖介面上。實作在 Google 地圖上的最大理由是它的
便利性，而且這個服務是免費的，社會大眾都可以直接使用，不需要額外再支出使用的經
費，只需要有上網功能就好；另外，我們可以將實作部分結合 Google 地圖的其他服務，將
整體系統整合成一個功能眾多的資訊系統，提供使用者完善的服務。我們預計將這套系統
結合雲端科技，由不同汽車上的 GPS 和感測器所產生的各種感測資料，將藉由 3G 網路傳
送到架設在雲端平台上的系統資料庫，藉由雲端的特性，大量的蒐集感測器資料，再經由
系統的整合，彙整出一系列的高度資訊和路況資訊，系統服務平台再將這些資訊提供給使
用者使用。而且有了高度資訊，便可以開發健行和單車應用程式，提供登山者和單車族使
用，抓取高度資訊實作各種應用，另外也可以提供高度資訊給低解析度的勘測應用程式，
對地形高度做到勘測的效果。 
我們的主要目的是要建立一個高度資料庫，希望可以將不同地點的高度準確的表示出
來，而高度的值的求得有許多的方法，有些研究人員使用數位地圖資料來取得各地的高度
值，或是利用其他數位地圖的資料來計算各地高度值，但是算出的資料有缺乏即時性的問
題，無法有效的表示現在的高度資訊；另有些研究人員使用感測器測出位置的高度資料，
但是感測資料總是會有誤差，如果直接拿偵測到的數據當作高度資訊，會發現高度資料的
變動過大，高度資料的垂直方向精準度或大或小，無法準確的表示各地的代表高度；為了
要求出各地的高度資訊，在這裡我們使用的方法是利用大量資料的收集彙整，以及彙整時
資料的變動和誤差會漸漸變小的特性，希望可以得到一個代表性大以及誤差較小的值當作
是此地的高度資訊值，同時也可以做到高度資料的即時更新，改算舊有方法中高度資料無
法有效反映目前高度值的缺點。 
我們建置了一個可以提供高度資訊和使用者定位資訊的坡度資訊查詢系統，這個系統
藉由各架設在汽車上的 GPS 收集各處的 GPS 資訊，傳回給伺服器端，經由伺服器做彙整，
計算出不同地點的可能高度。系統架構圖如圖 24 所示。客戶端接受到 GPS 訊號後將處理
 20 
在資料過濾階段，行動裝置主要有兩個任務，一為篩選出我們要使用的資訊；另一個任務
為將精確度不足的資訊予以於剔除。過濾完精準度不夠的 GPS 資料，最後將過濾後和分析
完的 GPS 資料，一一傳給後端的伺服器。當伺服器接收到過濾後且分析完的資料，接下來
要進行高度資料的彙整。這邊我們使用大數法則的概念，當蒐集愈多的資訊來取樣和統計，
其結果會愈來愈趨近於理論上的平均值。資料彙整後，就將這些資訊存入後端伺服器中的
高度資料庫中，可讓使用者來查詢使用。 
使用者可透過手機、電腦、行車電腦存取資訊。而使用者可以分成駕駛人追蹤模式和
一般資訊顯示模式，駕駛人追蹤模式為接收/傳送 GPS 時同時對汽車進行追蹤，利用 Google
地圖介面顯示汽車目前位置，同時顯示汽車行經的道路高度變化和未來短路段的高度變化，
讓駕駛人可以知道道路的貣伏情況為何。一般資訊顯示模式為一般使用者的使用模式，在
這個模式中，一樣使用 Google 地圖介面，使用者可以在介面上選擇路徑的貣點和終點，之
後在網頁上顯示路徑的導航和沿路的路面高度變化。我們將整個流程再以圖 26 來展示。使
用者的介面請參見圖 27。 
 
 
圖 26 資料流 
 
 22 
k-connectivity in wireless ad hoc networks," IEEE Transactions on Information 
Theory, Vol. 56, No. 6, pp. 2867-2874, June 2010. (SCI, EI; NSC Grant No. 
NSC97-2221-E-009-052-MY3, NSC98-2218-E-009-023, MoEA Grant No. 
98-EC-17-A-02-S2-0048, ITRI Grant No. 99-EC-17-A-05-01-0626, MoE ATU 
plan) 
4 C.-W. Yi, P.-J. Wan*, C.-M. Su, K.-W. Lin, and S. Huang, "Asymptotic 
distribution of the number of isolated nodes in wireless ad hoc networks with 
unreliable nodes and links," Discrete Mathematics, Algorithms and Applications, 
Vol. 2, No. 1, pp. 107-124, March 2010. (NSC Grant No. 
NSC97-2221-E-009-052-MY3, NSC98-2218-E-009-023, MoEA Grant No. 
98-EC-17-A-02-S2-0048, ITRI Grant No. 99-EC-17-A-05-01-0626, MoE ATU 
plan) 
5 C.-W. Yi*, P.-J. Wan, L. Wang, and C.-M. Su, "Sharp thresholds for relative 
neighborhood graphs in wireless ad hoc networks," IEEE Transactions on 
Wireless Communications, Vol. 9, No. 2, pp. 614-623, February 2010. (SCI, EI; 
NSC Grant No. NSC97-2221-E-009-052-MY3, ITRI Grant No. 8352BA4124, 
MoEA Grant No. 98-EC-17-A-02-S2-0048, MoE ATU plan) 
6 C.-W. Yi*, "A unified analytic framework based on minimum scan statistics for 
wireless ad hoc and sensor networks," IEEE Transactions on Parallel and 
Distributed Systems, Vol. 20, No. 9, pp. 1233-1245, September 2009. (SCI, EI; 
NSC Grant No. NSC95-2221-E-009-059-MY3 and 
NSC97-2221-E-009-052-MY3, ITRI Grant No. 8352BA2N3A, MoE ATU plan) 
7 P.-J. Wan, C.-W. Yi*, L. Wang, F. Yao, and X. Jia, "Asymptotic critical 
transmission radius for greedy forward routing in wireless ad hoc networks," 
IEEE Transactions on Communications, Vol. 57, No. 5, pp. 1433-1443, May 
2009. (SCI, EI; NSC Grant No. NSC95-2221-E-009-059-MY3 and 
NSC97-2221-E-009-052-MY3, ITRI Grant No. 7352B12100, MoE ATU plan) 
8 C.-W. Yi*, "Maximum scan statistics and channel assignment problems in 
homogeneous wireless networks," Theoretical Computer Science, Vol. 410, No. 
21-23, pp. 2223-2233, 17 May 2009. (SCI, EI; NSC Grant No. 
NSC95-2221-E-009-059-MY3 and NSC97-2221-E-009-052-MY3, ITRI Grant 
No. 8352BA4124, MoE ATU plan) 
9 P.-J. Wan*, L. Wang, F. Yao, and C.-W. Yi, "On the longest RNG edge of 
wireless ad hoc networks," Discrete Mathematics, Algorithms and Applications, 
Vol. 1, No. 1, pp. 25-43, March 2009. (NSC Grant No. 
NSC95-2221-E-009-059-MY3 and NSC97-2221-E-009-052-MY3, ITRI Grant 
No. 83522N2000, MoE ATU plan) 
研討會論文 
1 Y.-C. Cheng, J.-Y. Lin, C.-W. Yi, Y.-C. Tseng, L.-C. Kuo, Y.-J. Yeh and C.-W. 
Lin, "AR-based positioning for mobile devices," to appear in Proceedings of the 
2011 International Conference on Parallel Processing Workshops (ICPPW 
 24 
8 P.-C. Liu, C.-W. Yi, Y.-T. Chuang, H.-H. Lu, J.-S. Leu, and W.-K. Shih, "On the 
capacity of tree-based P2P streaming systems," in the Sixth International 
Workshop on Mobile Peer-to-Peer Computing (MP2P 2010) in conjunction with 
the Eighth Annual IEEE International Conference on Pervasive Computing and 
Communications (PerCom 2010), pp. 117-122, Mannheim, Germany, 29 
March-2 April 2010. (NSC Grant No. NSC97-2221-E-009-052-MY3 and 
NSC98-2218-E-009-023, MoEA Grant No. 98-EC-17-A-02-S2-0048, ITRI, 
MoE ATU plan) 
9 H.-P. Wang, Y.-T. Chuang, C.-W. Yi, Y.-C. Tseng, and P.-C. Liu, 
"XOR-Forwarding for wireless networks," in the 2009 IEEE Global 
Communications Conference (IEEE Globecom 2009), Hawaii, USA, 30 
November-4 December 2009. (NSC Grant No. NSC97-2221-E-009-052-MY3, 
ITRI Grant No. 8352BA4124, MoEA Grant No. 98-EC-17-A-02-S2-0048, MoE 
ATU plan) 
專利 
1 Chao-Min Su, Tsun-Chieh Chiang, and Chih-Wei Yi, Wen-Tein Chai, Pin-Chuan 
Liu, Jiun-Long Huang, "Method and System for Motion Tracking (運動追蹤方
法與系統)," ROC Patent Pending, USA Patent Pending, POC Patent Pending. 
人才培育 
碩士 5 名 
博士 0 名 
 
 
五、附錄 
 
mixed to form a coded packet only if all plain packets can
be decoded by their corresponding next-hop receivers. Behind
COPE, there are two important tasks. One is how to collect
more packets for decoding received coded packets. The other
is how to exchange the lists of possessed packets with 1-
hop neighbors for making proper encoding decisions. COPE
can be improved if we can find other means to enrich the
contents of one’s packet pool. Besides the original heuristics
used in COPE, we propose to further encode packets that
can be decoded by non-next-hop nodes such that we can
let neighbors learn more packets. Meanwhile, if the space
for storing packts is limited, we need to consider a practical
management heuristic. We call this new feature opportunistic
information dissemination which further encodes as many
plain packets as possible in coded packets even if those packets
are not intended by their corresponding next-hops such that in
following transmissions, there is a possibility to encode more
plain packets, and therefore, network throughput can be further
improved. In addition, we also provide the details of packet
format for neighbors to exchange the list of possessed packets.
The rest of this paper is organized as follows. In Section
II, we introduce some related works. In Section III, the
proposed Opportunistic ASynchronous Information diSsemi-
nation (OASIS) protocl is presented. In Section IV, practical
implementation issues are discussed. In Section V, simulation
results and analyses are given. Finally, conclusions and future
works are given in Section VI.
II. RELATED WORKS
The concept of network coding was first presented in the
pioneering work by Ahlswede et al. (2000) [1] in which they
showed that multicast capacity can be increased by properly
mixing information from different sources at intermediate
nodes. Following this thought, many works on designing effi-
cient network coding algorithms to improve network capacity
were published. Li et al. (2003) [4] proposed a linear network
coding scheme for multicast in direct acyclic networks that
can provide a throughput for each individual destination like
in the case of unicast. [5]. In [6], Koetter and Me´dard proposed
polynomial time encoding and decoding algorithms that were
then extended to random coding by Ho et al. [7].
Gkantsidis and Rodriguez [8] proposed a randomized and
distributed large content distribution solution that adopted the
concept of network coding and utilized network broadcasting.
When a source node wants to share a large file to other
nodes, the source node divides the file into equal size seg-
ments and broadcasts enough number of linearly independent
combinations of these segments into the network. If one
node receives enough linearly independent combinations, it
can recover the original file. To increase the independence
among linear combinations, instead of purely relaying received
combinations, intermediate nodes may broadcast a new linear
combination from received combinations. Kumar et al. [9]
proposed a broadcasting scheme over erasure channels with
perfect replies. They classified the packet buffer management
mechanisms into two catogories: drop-when-decode and drop-
when-see. In the drop-when-decode scheme, for a specified
sender, a plain packet can be dropped if and only if every
receiver has decoded the packet. As for the drop-when-see
scheme, a packet is seen by a receiver if this packet is a leading
variable in the decoding matrix of the receiver. A plain packet
can be dropped if it has been seen by all receivers such that
every receiver can decode this packet in the near future. A
major issue is how to choose the coefficients for encoding.
Recently, researchers focus on the benefits of implementing
network coding in wireless networks. In the presence of omni-
directional antennae, the problem of minimizing communica-
tion costs was formulated as a linear programming problem
and solved in a distributed manner [10]. Yang and Chen [11]
[12] proved that the problem was NP-hard, gave a lower
bound of the optimal throughput, and also derived a throughput
upper bound of the algorithms proposed by them. Katti et al.
(2006) [3] proposed a network coding technique for wireless
mesh networks, named COPE, that was implemented as a
protocol layer inserted between the IP and MAC layers. COPE
introduced two features of wireless network coding:
• Opportunistic listening: Due to the broadcast nature of
wireless communications, nodes can overhear packets
sent by their neighbors. Nodes store overheard and re-
layed packets and use them to decode coded packets.
• Opportunistic coding: Nodes learn the information of
what packets their neighbors stored by means of, e.g.
periodical information exchanges. While sending packets,
nodes use this information to select plain packets for
encoding such that receivers can decode the coded packet.
In this paper, we adopt these two features from COPE and
further introduce a new one. We have two observations from
COPE. First, COPE always encodes packets for corresponding
next-hops. Second, each node maintains a packet pool to store
overheard or relayed packets and uses them to decode packets.
Based on the above observations, a plain packet will not be
encoded in a coded packet if there is no sufficient plain packets
in the corresponding next hop’s packet pool. However, if we
relief the limitation to let coded packets carry extra plain
packets for not corresponding negihbors, we can disseminate
packets to neighbors’ packet pools and then increase the
probability of encoding more packets in future transmissions.
Therefore, we introduce a new feature, named opportunistic
information dissemination, which tries to encode as many plain
packets as possible even if some plain packets are not intended
by the receivers.
III. THE OASIS ALGORITHM
OASIS is a two-phase greedy coding algorithm based on
COPE. In the first phase, the algorithm encodes as many plain
packets as possible into the coded packet which is similar to
COPE. In the second phase, we implement the opportunistic
information dissemination. Without affecting the decoding
possibility of the plain packets encoded in the previous phase,
this phase can enrich neighbors’ packet pools and therefore
This full text paper was peer reviewed at the direction of IEEE Communications Society subject matter experts for publication in the IEEE "GLOBECOM" 2009 proceedings.
978-1-4244-4148-8/09/$25.00 ©2009
B. Decoding Procedure
A node decodes one packet from codedPacket by the
procedure given in Procedure 2. The decoding procedure is
simple and similar to that in COPE. A node can decode a
plain packet from codedPacket composed of n plain packets
by using the XOR operation if it has all other n − 1 plain
packets in its pool. Then it checks whether this plain packet is
for itself. If so, the packet is stored in the pool and forwarded
to the upper layer for future processing; otherwise, the packet
is stored in the pool for future decoding purposes. Note that
the decoding procedure aggressively decodes coded packets
and stores them in the pools if possible.
The packet pool and information database are two key
components to realize either COPE or OASIS. For encoding,
nodes need the information of neighbors’ pools to make
encoding decisions. On the other hand, for decoding, nodes
need packets in their pools to decode coded packets. So we
may need efficient pool managements and packet information
exchanges.
PROCEDURE 1 XOR−Coding
(
queueR, neighbor
)
Require: queueR: the output queue of node R; neighbor: the
1-hop neighbor list.
dequeue p from queueR.
codedPacket = p
nextHop = {the next hop of p}
Phase 1:
for ∀w ∈ neighbor − nextHop do
let q denote the first packet in virtualQueueRw
if ∀v ∈ nextHop ∪ {w}, v can decode codedPacket =
codedPacket⊕ q then
codedPacket = codedPacket⊕ q
nextHop = nextHop ∪ {w}
remove q from queueR and also virtualQueueRw
end if
end for
Phase 2:
for ∀ packet r ∈ queueR do
if ∃w ∈ neighbor − nextHop such that w and ∀v ∈
nextHop can decode codedPacket⊕ r then
codedPacket = codedPacket⊕ r
nextHop = nextHop ∪ {w}
end if
end for
return codedPacket, nextHop
IV. PRACTICAL ISSUES
This section describes some implementation details, in-
cluding packet formats, packet acknowledgements and packet
information exchanges. OASIS adds a variable-length header
in each packet between IP and MAC headers as shown in Fig.
3. The header consists of three blocks:
• The encoded packet list: The first block records all plain
packets that are encoded in this packet. It starts with
PROCEDURE 2 XOR−decoding (v, codedPacket)
Require: node v that wants to decode the received coded
packet codedPacket
decode the packet q from coded packet codedPacket
if v is the next hop of q then
forward q to upper layer
else
store q in poolv
end if
ENCODED_NUM
…
REPORT_NUM
PKT_ID LOCAL_SEQ_NUM PKT_ID
…
SRC_IP LAST_PKT BIT_MAP
REPORT_NUM
NEIGHBOR OLDEST_ACK ACK_MAP
Fig. 3. OASIS’s header format
ENCODED NUM, the number of XORed plain packets,
followed by a list of the XORed plain packets. The list
records PKT ID, LOCAL SEQ NUM and NEXTHOP
for each plain packet. PKT ID is a 32-bit hash of the
packet’s source IP address and IP sequence number,
LOCAL SEQ NUM is a 16-bit counter used to identify
packets between neighbors. Whenever the node sends
a packet to neighbors, the counter is incremented by
one and its value is assigned to LOCAL SEQ NUM,
NEXTHOP is the MAC address of the plain packet’s next
hop.
• The packet pool report: The second block in the
header is a list about packets stored in sender’s pool.
REPORT NUM is the number of the report entries,
and each entry is composed of a source IP address
(SRC IP), a IP sequence number (LAST PKT) and a
bit-map (BIT MAP). The LAST PKT entry indicates the
last packet stored in the pool sent by SRC IP. BIT MAP
records the recently received packets from SRC IP. The
report information is important since a node in a wire-
less environment needs this information to make coding
decisions.
• Asynchronous acknowledgement: It is possible
for more than one packet being transmitted under
network coding paradigm. However, the traditional
RTS/CTS/DATA/ACK or DATA/ACK mechanism in
MAC can only protect one ongoing packet. The third
block in the header is therefore to acknowledge the
receiving of other encoded plain packets. ACK NUM is
the number of ack entries in this packet. Each entry is
composed of a neighbor MAC address (NEIGHBOR),
a packet local sequence number (OLDEST ACK) to
indicate where the ack begins and a cumulative ack
bit-map (ACK MAP) to indicate previously received
This full text paper was peer reviewed at the direction of IEEE Communications Society subject matter experts for publication in the IEEE "GLOBECOM" 2009 proceedings.
978-1-4244-4148-8/09/$25.00 ©2009
0 0.05 0.1 0.15 0.20
5
10
15
20
25
30
35
40
Traffic load (Mbps)
En
d−
to
−e
nd
 d
el
ay
 (s
ec
on
d)
 
 
OASIS
OASIS-nPM
COPE
Unicast
Fig. 7. Traffic load v.s. end-to-end delay in a 4× 4 grid.
The peak throughputs are at (0.07, 0.053), (0.16, 0.065),
(0.16, 0.071) and (0.16, 0.074) for Unicast, COPE, OASIS-
nPM, and OASIS, respectively. Both OASIS and OASIS-
nPM outperform COPE and Unicast. COPE, OASIS-nPM,
and OASIS respectively have improvements in the maximal
throughput about 122%, 133%, and 139% compared to Uni-
cast. In average, the improvements of COPE and OASIS are
about 120% and 138%, respectively. So, the improvements
achieved by OASIS are about 1.2 times of the improvements
achieved by COPE. OASIS has a superior performance result
as compared with OASIS-nPM. We can see packet pool
managements are necessary in network coding paradigm. In
addition, we also ran a simulation with a 4× 4 grid topology
and the result is shown in Fig. 5.
The result is reasonable. Unicast has the worst throughput
since it never utilizes broadcast property of wireless commu-
nications. In each transmission, there is at most one packet
can be delivered. However, network coding schemes have the
possibility to deliver more than one packet in each transmis-
sion. Moreover, OASIS and OASIS-nPM outperforms COPE
since they forward extra information that is not necessary but
may be helpful for future transmissions.
The end-to-end delay is defined as the total time experience
as the time a packet generated from the source to the time this
packet received by the destination. Figures. 6 and 7 illusrate
the packet generation rate v.s. end-to-end delay with 8 × 8
gird and 4 × 4 grid topologies. We can see that the network
coding schemes not only improve system capacity but also
reduce end-to-end delay.
VI. CONCLUSIONS
In this paper, we proposed a generic network coding pro-
tocol called OASIS based on COPE and introduce a new
future called opportunistic information dissemination. The
opportunistic information dissemination encodes as many plain
packets as possible in coded packets and enriches neighbors’
packet pools to increase the future encdoding possibility.
Meanwhile, a simple packet pool management is introduced
to deal with the limitation on the pool size. The simulation
results show that OASIS has the network throughput about
139% as compared to the classical unicast forwarding. The
improvement is 1.2 times than the improvement achieved by
COPE. Moreover, the simulation results also show that it takes
a few overhead on end-to-end delay to implement OASIS.
So, overall speaking, OASIS is an offerable localized network
coding heuristic for wireless networks.
In this work, we consider the implementation issues of
design a network coding protocol in a wireless environment.
However, there are still many things need to be considered
when implement network coding into network protocol suit,
such as more advance pool management mechanisms, ack
mechanisms, and so on. All are possible research topics for
future works.
ACKNOWLEDGMENT
We thank Prof. Chien-Chung Shen from the Department of
Computer Information Science, University of Delaware for his
helpful comments.
This work of C.-W. Yi was supported in part by NSC un-
der Grant No. NSC97-2221-E-009-052-MY3, by ITRI under
Grant No. 8352BA4124, by MoEA under Grant No. 98-EC-
17-A-02-S2-0048, and by the MoE ATU plan.
REFERENCES
[1] R. Ahlswede, N. Cai, S.-Y. R. Li, and R. W. Yeung, “Network infor-
mation flow,” IEEE Transactions on Information Theory, vol. 46, no. 4,
pp. 1204–1216, July 2000.
[2] P. Chou and Y. Wu, “Network coding for the internet and wireless
networks,” IEEE Signal Processing Magazine, vol. 24, no. 5, pp. 77–85,
September 2007.
[3] S. Katti, H. Rahul, W. Hu, D. Katabi, M. Me´dard, and J. Crowcroft,
“XORs in the air: Practical wireless network coding,” IEEE/ACM
Transactions on Networking, vol. 16, no. 3, pp. 497–510, June 2008,
first appeared in sigcomm 2006.
[4] S.-Y. R. Li, R. W. Yeung, and N. Cai, “Linear network coding,”
IEEE Transactions on Information Theory, vol. 49, no. 2, pp. 371–381,
February 2003.
[5] S. Fong and R. Yeung, “Variable-rate linear network coding,” in Infor-
mation Theory Workshop (ITW ’06), October 2006, pp. 409–412.
[6] R. Koetter and M. Me´dard, “An algebraic approach to network coding,”
IEEE/ACM Transactions on Networking, vol. 11, no. 5, pp. 782–795,
Octobor 2003.
[7] T. Ho, R. Koettert, M. Me´dard, D. R. Karger, and M. Effros, “The
benefits of coding over routing in a randomized setting,” in IEEE
International Symposium on Information Theory (ISIT 2003), 29 June-4
July 2003, p. 442.
[8] C. Gkantsidis and P. Rodriguez, “Network coding for large scale content
distribution,” in Proceedings of the 24th Annual Joint Conference of
the IEEE Computer and Communications Societies (IEEE INFOCOM
2005), vol. 4, March 2005, pp. 2235–2245.
[9] J. K. Sundararajan, D. Shah, and M. Me´dard, “ARQ for network coding,”
in IEEE International Symposium on Information Theory, 2008. ISIT
2008., July 2008, pp. 1651–1655.
[10] D. Lun, N. Ratnakar, R. Koetter, M. Me´dard, E. Ahmed, and H. Lee,
“Achieving minimum-cost multicast: a decentralized approach based on
network coding,” in Proceedings of the 24th Annual Joint Conference of
the IEEE Computer and Communications Societies (IEEE INFOCOM
2005), vol. 3, March 2005, pp. 1607–1617.
[11] D.-N. Yang and M.-S. Chen, “On bandwidth-efficient data broadcast,”
IEEE Transactions on Knowledge and Data Engineering, vol. 20, no. 8,
pp. 1130–1144, August 2008.
[12] ——, “Data broadcast with adaptive network coding in heterogeneous
wireless networks,” IEEE Transactions on Mobile Computing, vol. 8,
no. 1, pp. 109–125, January 2009.
[13] X. Zeng, R. Bagrodia, and M. Gerla, “GloMoSim: a library for parallel
simulation of large-scale wireless networks,” in Workshop on Parallel
and Distributed Simulation, 1998, pp. 154–161.
This full text paper was peer reviewed at the direction of IEEE Communications Society subject matter experts for publication in the IEEE "GLOBECOM" 2009 proceedings.
978-1-4244-4148-8/09/$25.00 ©2009
heuristics for maximizing system capacity are introduced. In
Section V, we present simulation results. Conclusions and
future works are given in Section VI.
II. RELATED WORKS
Single-tree multicast routing in which one overlay routing
tree rooted at the server is constructed and maintained is the
most natural approach to deliver streaming contents [1], [3]–
[6]. This approach provides a stable system with predictable
system performances, including the arrival time and trans-
mission delay. However, in such a single-tree scenario, leaf
nodes never contribute their uplink bandwidth. SplitStream
[7] proposed by Castro et al. is a multiple-tree content
distribution system based on Pastry [8] and Scribe [9], where
Pastry is a scalable routing algorithm for peer-to-peer over-
lay networks and Scribe is a decentralized publish/subscribe
system based on Pastry. In SplitStream, multiple overlay
multicast routing trees are constructed over the same set
of peers, and contents are split into several substreams each
of which is delivered by one multicast routing tree. The
leaf nodes of a routing tree can be internal nodes of other
multicast trees. Therefore, the upload bandwidth can have
better utilization.
Mesh-based routing [2], [10] is even more flexible than
multiple-tree routing. The uplink bandwidth of peers can be
utilized more effectively, but the arrival time and transmis-
sion delay of streaming contents are hard to predict due to
the randomness of connection and availability of streaming
data. In [11], Magharei and Rejaie proposed a two-phase
swarm-like content delivery method over a random mesh-
based overlay. To distribute a streaming segment from the
server, each data unit of the segment is diffused in a
multicast-tree-like manner first, so that each participant peer
has at least one data unit of the segment, then, these par-
ticipant peers start to swarm their own data units until each
peer gets all data units of the segment. In this approach, the
uplink bandwidth of most peers can be effectively utilized
with a small buffer requirement.
The performance of a P2P streaming system can be
evaluated from three aspects: (1) delay, (2) server cost, and
(3) scalability. In literature, there were some research works
on the capacity of P2P systems, including P2P file sharing
systems [12]–[14] and P2P streaming systems [15]–[17]. In
[15], Small et al. studied the system capacity by tuning
parameters such as the server bandwidth and the maximum
streaming hops. In [16], Hei et al. developed a crawler to
collect data from the PPLive network to investigate peer
characteristics among the real IPTV system. In [17], Tewari
et al. provided an analytical model on BitTorrent-based live
video streaming system to investigate the relation between
streaming bit rates, fragment size and P2P efficiency.
III. P2P STREAMING SYSTEMS
In this section, we are going to introduce a generic P2P
streaming system model. Although terminologies given in
this section are more than what we need in this paper, that
can give us a better understanding of P2P streaming systems
and is helpful for future studies.
A P2P streaming system is composed of one media server,
denoted by v0, and N clients, denoted by v1, · · · , vN ,
interconnected by the Internet. For 1 ≤ i ≤ N , the node
vi is called the i-th peer. The media server, or simply called
server, continuously generates and pushes a media stream
into the system. We assume contents are generated in a
constant bit rate of R, and the transmission is scheduled
in rounds, e.g. second by second. For simplicity, people
may assume the media stream is divided into segments
and each segment is for one second playback. The media
segments are further divided into equal-sized K substreams
denoted by p1, ..., pK . The clients can receive the media
stream directly from the server or from other clients by
relaying. The connection between a subscriber and its ISP
is logical split into an uplink and a downlink. The logical
connections from subscribers to ISPs are called uplinks
and the logical connections from ISPs to subscribers are
called downlinks. Due to physical limitations and/or the
contracts between subscribers and their ISPs, there are
constraints on the uplink bandwidth, downlink bandwidth,
and/or total bandwidth. The uplink bandwidth (respectively,
the downlink bandwidth, and the total bandwidth) of node
vi, if existing, is denoted by b
up
i (respectively, b
down
i and
btotali ). Especially, the uplink capacity of the server is b
up
0 .
To reflect the connection condition over the Internet
between two nodes, the peer-to-peer bandwidth from vi to
vj is denoted by b
p2p
ij . The peer-to-peer bandwidth could
be asymmetric. In addition, the queueing delay from vi to
vj , denoted by dij , is the time needed for packets to pass
through the network, and the peer-to-peer packet lost rate
for packets transmitted from vi to vj , denoted by pij , is the
probability of packets being successfully delivered.
The data flow from vi to vj that is the average amount of
data delivered from vi and vj over the network per second
and denoted by fij can’t exceed the peer-to-peer bandwidth
bp2pij . So,
fij ≤ bp2pij for all 0 ≤ i ≤ N and 1 ≤ j ≤ N .
At the same time, for any node vi, the total amount of its
outgoing flows can not exceed its uplink bandwidth, i.e.
N∑
j=1
fij ≤ bupi for all 0 ≤ i ≤ N.
In general, the store-and-forward method is used for P2P
content delivery. For any node vj being served by the system,
it must completely receive a media segment before playing
back this media segment. Of course, for a node to be served,
118
available even over the Internet. The proposed heuristic for
MRTP is described in Algorithm 1.
Algorithm 1 The Maximum Routing Tree Heuristic
V ′ = {v0} and E′ = ∅, C = N+ (v0)
while C ̸= ∅ do
Select vi ∈ C that can serve the most un-served peers
Select vj ∈ V ′ that can serve vi and is closest to v0
V ′ = V ′ ∪ {vi}
E′ = E′ ∪ {(vj , vi)}
Update C
end while
In a dynamic environment, besides the joining heuristic,
the heuristic to handle leaving is necessary, too. As one
node announces to be leaving or is detected absent, its
children must be taken over and the bandwidth consumed
by the leaving node will be return. Since we only consider
bandwidth and ignore routing here, the only problem that
needs to be worry about is that the residual bandwidth
becomes negative. In such a case, some nodes should be
removed from the system. This may happen only if there
are nodes without contributing upload bandwidth, and we
will remove some such nodes until the residual bandwidth
turns to non-negative.
B. Multiple-Tree Routing
Although the single-tree routing is simple, there are at
least two drawbacks in such a system. First, most upload
bandwidth is not exactly a multiple of the stream data
rate. The residual fractional bandwidth is a waste under the
unsplittable scenario. Moreover, leaf nodes never contribute
their upload bandwidth. Second, the end-to-end delay each
node experiencing is lower bounded by the product of the
hop distance from the root and the average transmission
delay per hops. Thus, leaf nodes usually experience high
end-to-end delay as well as playback delay. Multiple-tree
routing has the potential to make up the two drawback.
In the multiple-tree routing scenario, the media stream
will be split into K substreams. There will be K routing
trees and each of them is responsible for one substream. A
client is served if it can receive all substreams in time. For
simplicity, we assume that all substreams are with data rate
1. So, the stream data rate is K. This is a little bit different
from the single-tree model. The maximum multiple routing
tree problem is formally defined as follows.
Definition 3: Given a vertex-weighted directed graph
G (V,E, bup) where bup : V → N, a vertex v0 ∈ V
and a constant K, the maximum multiple routing tree
problem (MMRTP) is to find K subtrees Tk (V ′, E′k), for
k = 1, 2, · · ·K, all rooted at v0 to maximize |V ′| such that∑K
k=1 deg
+
Tk
(vi) ≤ bupi for all vi ∈ V ′.
Since MRTP is a special case of MMRTP, obviously
MMRTP is also NP-hard. So, we can have the following
theorem.
Theorem 4: The MMRTP is NP-hard.
We propose a greedy heuristic to select peers to join the
system. As nodes are selected, they needs to join all K
routing trees. In each iteration, the heuristic not only needs
to pick nodes with the largest upload bandwidth among un-
served nodes to join the system but also needs to make sure
the selected node can receive all K substreams. The selected
node will dedicate its upload bandwidth to the routing tree
with the smallest total upload bandwidth.
The proposed heuristic for MMRTP is described in Algo-
rithm 2.
Algorithm 2 The Maximum Multiple Routing Tree Heuris-
tic
Initialize the first layer of Ti for i = 1, 2, · · · ,K.
Let C be the set of nodes that can be served by all Ti.
while C! = ∅ do
Let Tk be the tree with the fewest upload bandwidth.
Select vi ∈ C that can serve the most un-served peers.
Select vj ∈ V ′ that can provide the k-th substream to
vi and is closest to {v0}.
E′k = E
′
k ∪ {(vj , vi)}
for l ∈ {1, 2, · · · ,K} − {k} do
Select vj ∈ V ′ that can provide the l-th substream
to vi
E′l = E
′
l ∪ {(vj , vi)}
end for
Mark vi served and contribute the upload bandwidth of
vi to Tk.
Update C, V ′.
end while
As a node leaves the system, the bandwidth consumed
by this node is returned to each routing tree and the upload
bandwidth contributed by this node needs to be deduct from
the residual bandwidth of each routing tree. If the residual
bandwidth becomes negative, it means some nodes can’t be
served by this system. In such cases, we need to remove
peers from the system. The node with the smallest upload
bandwidth will be removed from the system just like what
we do in the single-tree system.
V. SIMULATION RESULTS
In order to evaluate the performance of the algorithm
of MRTP and MMRTP, We use M/M/1 queueing model
to simulate users entrance in and leave out. We consider
the case where the server services a mix of various type of
clients and has arrival/departure rate as well as the system
load from 0.1 to 0.9. Table I lists that the server uplink
bandwidth is fixed on 4Mbps and clients are considered
as three popular types of broadband access network on the
Internet.
120
0 0.2 0.4 0.6 0.8 1
0
10
20
30
40
50
60
70
80
90
System load
Ca
pa
ci
ty
 (%
)
 
 
256kbps
512kbps
768kbps
1024kbps
Figure 3. Multiple-Tree System with multiple uploaded trees
ACKNOWLEDGMENT
This work of Dr. Yi described in this paper was partially
supported by NSC under Grant No. NSC97-2221-E-009-
052-MY3 and NSC98-2218-E-009-023, by MoEA under
Grant No. 98-EC-17-A-02-S2-0048, by ITRI, and by the
MoE ATU plan.
REFERENCES
[1] J. Jannotti, D. K. Gifford, K. L. Johnson, M. F. Kaashoek, and
J. James W. O’Toole, “Overcast: reliable multicasting with
an overlay network,” in Proceedings of the 4th conference on
Symposium on Operating System Design & Implementation
(OSDI’00), 22-25 October 2000, pp. 197–212.
[2] X. Zhang, J. Liu, B. Li, and T.-S. P. Yum, “CoolStream-
ing/DONet: A data-driven overlay network for peer-to-peer
live media streaming,” in Proceedings of the 24th Annual
Joint Conference of the IEEE Computer and Communications
Societies (IEEE INFOCOM 2005), 13-17 March 2005, pp.
2102–2111.
[3] Y. Chu, S. Rao, S. Seshan, and H. Zhang, “Enabling confer-
encing applications on the internet using an overlay muilticast
architecture,” ACM SIGCOMM Computer Communication
Review, vol. 31, no. 4, pp. 55–67, October 2001.
[4] S. Ratnasamy, M. Handley, R. M. Karp, and S. Shenker,
“Application-level multicast using content-addressable net-
works,” in Proceedings of the 3rd International COST264
Workshop on Networked Group Communication (NGC 2001),
7-9 November 2001, pp. 14–29.
[5] S. Banerjee, B. Bhattacharjee, and C. Kommareddy, “Scalable
application layer multicast,” in Proceedings of the 2002
conference on Applications, Technologies, Architectures, and
Protocols for Computer Communications (ACM SIGCOMM
’02), 19-23 August 2002, pp. 205–217.
[6] V. N. Padmanabhan, H. J. Wang, and P. A. Chou, “Resilient
peer-to-peer streaming,” in Proceedings of the 11th IEEE
International Conference on Network Protocols (ICNP 2003),
4-7 November 2003, pp. 16–27.
[7] M. Castro, P. Druschel, A.-M. Kermarrec, A. Nandi, A. Row-
stron, and A. Singh, “SplitStream: High-bandwidth content
distribution in a cooperative environment,” in The 2nd In-
ternational Workshop on Peer-to-Peer Systems (IPTPS ’03),
20-21 February 2003.
[8] A. Rowstron and P. Druschel, “Pastry: Scalable, decentral-
ized object location and routing for large-scale peer-to-peer
systems,” in Proceedings of the IFIP/ACM International
Conference on Distributed Systems Platforms (Middleware
2001), 12-16 November 2001, pp. 329–350.
[9] M. Castro, P. Druschel, A.-M. Kermarrec, and A. Rowstron,
“Scribe: A large-scale and decentralized application-level
multicast infrastructure,” IEEE Journal on Selected Areas in
Communication (IEEE JSAC), vol. 20, no. 8, pp. 1489–1499,
October 2002.
[10] M. Zhang, L. Zhao, Y. Tang, J.-G. Luo, and S.-Q. Yang,
“Large-scale live media streaming over peer-to-peer networks
through global Internet,” in Proceedings of the ACM Work-
shop on Advances in Peer-to-Peer Multimedia Streaming
(P2PMMS’05), 11 November 2005, pp. 21–28.
[11] N. Magharei and R. Rejaie, “Understanding mesh-based peer-
to-peer streaming,” in Proceedings of the 2006 International
Workshop on Network and Operating Systems Support for
Digital Audio and Video (NOSSDAV 2006), 22-23 May 2006,
pp. 1–6.
[12] S. Saroiu, K. P. Gummadi, and S. D. Gribble, “Measuring and
analyzing the characteristics of napster and gnutella hosts,”
Multimedia Systems, vol. 9, no. 2, pp. 170–184, 1 August
2003.
[13] X. Yang and G. de Veciana, “Service capacity of peer to peer
networks,” in Proceedings of the 23th AnnualJoint Conference
of the IEEE Computer and Communications Societies (IEEE
INFOCOM 2004), 7-11 March 2004, pp. 2242–2252.
[14] D. Qiu and R. Srikant, “Modeling and performance analysis
of bittorrent-like peer-to-peer networks,” in Proceedings of
the 2004 ACM SIGCOMM Computer Communication Review
(ACM SIGCOMM 2004), 30 August - 3 September 2004, pp.
367–378.
[15] T. Small, B. Liang, and B. Li, “Scaling laws and tradeoffs in
peer-to-peer live media streaming,” in Proceedings of the 14th
annual ACM international conference on Multimedia (ACM
MM 2006), 23-27 July 2006.
[16] X. Hei, C. Liang, J. Liang, Y. Liu, and K. W. Ross, “A
measurement study of a large-scale p2p iptv system,” IEEE
Transactions on Multimedia, vol. 9, no. 8, pp. 1672–1687,
December 2007.
[17] S. Tewari and L. Kleinrock, “Analytical model for bittorrent-
based live video,” in Proceedings of the 2007 4th IEEE Con-
sumer Communications and Networking Conference (CCNC
2007), 11-13 January 2007, pp. 976–980.
122
and then the topology information of the constellation is
utilized to calibrate the positions and orientation by the LSM.
Later, the LSM outcomes are applied to correct accumulation
errors of velocities and used in the next iteration. Besides the
displacement, the rotation information is also obtained.
The proposed solution can be applied to many fields,
such as vehicle accident reconstruction, personal or vehicle
monitoring, dead reckoning for navigation systems, transport
and consumer electronics. For example, we can deploy a g-
sensor constellation in a vehicle for the purpose of facilitating
the investigation of accidents. Information from this system
can be collected after an accident and analyzed to help to find
out the possible reason and determine the responsibility. In the
field of navigation systems, GPS is the most widely used one.
However, the GPS signal can be unavailable, such as when the
vehicle enters a tunnel or area with dense vegetation. With the
g-sensor constellation, it can provide continuous navigation
data no matter whether the GPS signal is lost or not and can
improve the accuracy.
The rest of this paper is organized as follows. In Section
II, we introduce the system architecture of g-sensor constella-
tions. In Section III, we give the object tracking algorithm on
g-sensor constellations. In Section IV, we give our experiment
results. Section V is our conclusions.
II. G-SENSOR CONSTELLATIONS
A g-sensor is an accelerometer based on MEMS tech-
nology. A g-sensor constellation (called g-constellations or
simply constellations) is a collection of at least three g-
sensors with rigid geometric topology for motion tracking. A
g-constellation is purely composed of g-sensors and with no
need of directional sensors in the system such as gyroscopes or
magnetic sensors. Intuitively, one g-sensor alone cannot detect
the rotation at the sensor, and even a two-sensor system cannot
detect the rotation by the axis along the two sensors. So, to
detect and measure the change in direction, a g-constellation
must consist of at least three g-sensors. In our experiments,
for example, a g-constellation consisting of three g-sensors,
denoted as S1, S2, S3, is built to verify our motion tracking
technique. The three sensors are adhered at the vertices of
an equilateral triangle with edges of 0.3m. The constellation
is depicted in Fig. 1 where Si =
[
xi yi zi
]T is the
coordinate of Si and li,j denotes the distance between Si and
Sj . However, in general cases, a g-constellation may consist
of more than three sensors and the topology does not need to
be a regular polygon.
Due to application scenarios and installation precision, the
coordinate systems of sensors may not be aligned to each
other. So, the first problem we face is to have a common
reference coordinate system for all sensors. Without loss of
generality, the coordinate system of S1 is preferred and called
as the body frame, and the coordinate systems of S2 and S3
are aligned to the body frame by using linear transformations
instead of being physically aligned. To compute the transfor-
mation matrix TSi→S1 (or sometimes denoted by TSi→B)
from the coordinate system of the i-th sensor to the body
S2S1
S3
l1,3 l2,3
l1,2
Fig. 1. A g-sensor constellation composed of three sensors.
frame, we sample the readings of sensors in a static state in
three independent directions. Let Gi,j =
[
gi1j g
i
2j g
i
3j
]T
denote the raw reading of the i-th sensor in direction j for
i = 1, 2, 3 and j = 1, 2, 3. Since the constellation is in a static
state, the reading is exactly equal to the gravity. So, we have
G1,j = TSi→S1Gi,j for i = 2, 3 and j = 1, 2, 3. Note that
TS1→B = TS1→S1 = I. Therefore, the transformation matrix
TSi→S1 can be obtained by solving the linear system⎡
⎣ g111 g112 g113g121 g122 g123
g131 g
1
32 g
1
33
⎤
⎦ = TSi→S1
⎡
⎣ gi11 gi12 gi13gi21 gi22 gi23
gi31 g
i
32 g
i
33
⎤
⎦ . (1)
If G˜i,j denotes the raw reading of the i-th sensor at time tj ,
and GBi,j denote the same reading but measured in the body
frame. Then,
GBi,j = T
Si→BG˜i,j . (2)
Applying the transformation technique introduced here, we
can simply assume the coordinate systems of sensors are all
aligned to the body frame.
As the constellation moves, besides displacement, the con-
stellation may rotate during the motion. The body frame is not
a proper reference to depict the motion. A global coordinate
system is needed to track the system. The global coordinate
system is called the earth frame, and we assume that the
x-axis, y-axis, and z-axis of the earth frame respectively
point to the geographic north, geographic east, and ground,
respectively. Without loss of generality and for simplicity, we
even may assume that the body frame is aligned to the earth
frame at time t0. Let TB→Ej be the linear transformation from
the body frame to the earth frame at time tj , and GEi,j denote
the reading of the i-th sensor measured in the earth frame at
time tj . Then,
GEi,j = T
B→E
j G
B
i,j . (3)
But the problem is how we can obtain the transformation
matrix TB→Ej . Let Si,j denote the position of the i-th sensor
at time tj in the earth frame. We observe that at time tj ,
{S2,j − S1,j ,S3,j − S1,j , (S2,j − S1,j)× (S3,j − S1,j)} is a
set of observations of the constellation in the earth frame,
To obtain S1,S2,S3, we solve the system{ ∇xi,yi,ziΛ = 0 for i = 1, 2, 3;
∇λ1,2,λ1,3,λ2,3Λ = 0.
For i = 1, 2, 3, from ∂∂xi Λ = 0,
∂
∂yi
Λ = 0, and ∂∂zi Λ = 0, we
have Si − S˜i =
∑
k =i λi,k (Sk − Si), or, more explicitly,⎛
⎝ xi − x˜iyi − y˜i
zi − z˜i
⎞
⎠ =
⎛
⎝ xj − xi xk − xiyj − yi yk − yi
zj − zi zk − zi
⎞
⎠( λj,i
λk,i
)
.
For 1 ≤ i < j ≤ 3, from ∂∂λi,j Λ = 0, we have ‖Si − Sj‖ =
li,j , or, more explicitly,
(xi − xj)2 + (yi − yj)2 + (yi − yj)2 = (li,j)2 .
Put all together, and then we have
x1 + x2 + x3 = x′1 + x
′
2 + x
′
3,
y1 + y2 + y3 = y′1 + y
′
2 + y
′
3,
z1 + z2 + z3 = z′1 + z
′
2 + z
′
3.
The system means that the barycenters of S1,S2,S3 and
S˜1, S˜2, S˜3 are overlapping, and we have the following the-
orem.
Theorem 1: For the LSP, the barycenters of S1,S2,S3 and
S˜1, S˜2, S˜3 are overlapping.
Start from a g-constellation whose barycenter is the same
as that of S˜1, S˜2, S˜3, and then applying Theorem 1, the LSP
can be solved by finding a best rotation to minimize Eq. (7).
In this work, we further assume that S1,S2,S3 and S˜1, S˜2, S˜3
are in the same plane, and therefore, the solution can be found
by a 2D rotation. A numerical method is used to find the best
rotation.
After applying the LSM, we get the positions Si,j+1. We
can further to adjust the velocities of sensors according to the
displacement. Let Di,j = Si,j+1 − Si,j be the displacement
of the i-th sensor in the period from time tj to time tj+1. In
addition, we also have
Di,j = Vi,jΔtj +
1
2
Ai,j (Δtj)
2
=
1
2
Δtj (Vi,j +Vi,j+1) .
So, the velocity Vi,j+1 can be given at by
Vi,j+1 =
2 (Si,j+1 − Si,j)
Δtj
−Vi,j . (8)
In our preliminary experiments, the movements of the
constellation always start from a still state. So, the initial
velocity Vi,0 for i = 1, 2, 3 is set to 0. Besides, the initial
position Si,0 for i = 1, 2, 3 is known. Then, we iteratively (1)
calculate the transformation matrix by Eq. (3); (2) sample the
reading of sensors and calculate accelerations w.r.t. the earth
frame; (3) estimate sensor positions by Eq. (6); (4) apply the
LSM to adjust sensor positions; and (5) use Eq. (8) to compute
the velocity used in the next iteration. To end this section, we
give the flow chart of the proposed heuristic in Fig. 3.
Calculate velocity
by Eq. (8)
Initiate
,            ,
,           ,
Calculate          and
by Eq. (4), (5)
EB
j
oT ji ,A
0 j 00,iV
0,iS 1
SSioT Bi 0,G
1, jiV
Extrapolate
by Eq. (6)
Use LSM to obtain
from
1,
~
jiS
1, jiS
1,
~
jiS
1 jj
Fig. 3. Flowchart of the object tracking algorithm.
IV. EXPERIMENTS
In our experiments, the constellation is composed of three
WiTilt v3 sensors.1 Each sensor has a three-axis accelerometer
and a one-axis gyroscope, but only the accelerometer is used.
The sensor provides selectable sensitivities: 1.5g, 2g, 4g, and
6g, and the accelerometer’s bias is ±2mg/◦C. The sampling
rate is set up to 90 Hz. Three sensors are fixed on a plastic
board at the vertices of an equilateral triangle. The edge of
the equilateral triangle is 0.3m. The data of WiTilt v3 sensors
is output via a Bluetooth interface.
The g-sensor is with a certain level of inaccuracy. Even
if sensors are in a static state, the reading of sensors slightly
vibrates. The inaccuracy will accumulate and cause significant
error on velocities and displacements. In the first experiment,
the constellation keeps static for 30s, and the drifting that
caused by accumulation error is calculated for three individual
sensor and the constellation. The constellation is represented
by its barycenter. Table I records the displacement of each
sensor and the constellation. S1, S2, S3, and the constellation
move 31.5m, 23.3m, 21.3m, and 18.8m, respectively. We can
see the constellation is the stablest.
Besides the static experiment, we also do some dynamic
experiments. For example, the constellation moves about 45m
along a straight line. The outcome of the straight line test is
depicted in Fig. 4. From the reconstructed tracks, the constel-
lation marked by the red curve moves almost in a straight
line. However, the tracks of three individual sensors are far
1The SparkFun WiTilt v3 employs a Freescale MMA7260Q triple-axis
accelerometer and a Melexis MLX90601 E2 gyroscope. In the experiments,
each sensor is set on the same output frequency, but the number of acquired
samples per second diverges. In addition, this number is easily influenced by
the battery condition.
Streetcast: An Urban Broadcast Protocol for
Vehicular Ad-Hoc Networks
Chih-Wei Yi∗, Yi-Ta Chuang∗, Hou-Heng Yeh∗, Yu-Chee Tseng∗ and Pin-Chuan Liu†
∗Department of Computer Science, National Chiao Tung University
1001 University Road, Hsinchu City 30010, Taiwan
Emails: yi@cs.nctu.edu.tw, {izeki.cs96g,hhyeh.cs96g}@nctu.edu.tw, yctseng@cs.nctu.edu.tw
†Industrial Technology Research Institute
195, Section 4, Chung Hsing Road, Chutung, Hsinchu 31040, Taiwan
Email: flash@itri.org.tw
Abstract—Vehicular Ad-hoc NETworks (VANETs) adopting
Dedicated Short-Range Communications (DSRCs) have emerged
as a preferred choice of network design for the Intelligent
Transportation System (ITS). A possible application of the ITS is
to disseminate emergency messages by multihop broadcast. Due
to the high density and high mobility of vehicles, it is difficult
to design an efficient broadcast protocol for VANETs in urban
areas. In this work, we propose a broadcast protocol, named
Streetcast, to provide efficient broadcast service. Street maps are
used to assist the selection of relay nodes, and multicast RTS
(Request-To-Send) is adopted to protect wireless communications
for providing high reliability. In addition, an adaptive beacon
control heuristic is proposed to reduce beacon overheads. At
last, we evaluate our broadcast protocol in a real roadmap
scenario with real traffic flows. The simulation results show that
the proposed broadcast protocol has a superior performance in
terms of packet delivery ratio and the number of collisions under
various traffic load patterns.
Index Terms—Localized broadcast, Streetcast, VANETs
I. INTRODUCTION
Vehicular Ad-hoc NETworks (VANETs) are a special form
of Mobile Ad-hoc NETworks (MANETs). VANETs are dif-
ferent from MANETs in several ways. First, vehicles are
in a large volume, and network topology changes rapidly.
Second, the mobility of vehicles is constrained by roads with
limitations on driving speed. Although vehicles can move
in high speeds, their directions and speeds are predictable.
Third, vehicles usually do not have tight energy budget.
Instead, bandwidth issues are more critical than energy ones
in VANETs.
VANETs adopting Dedicated Short-Range Communications
(DSRCs) have emerged as a preferred choice of network de-
sign for the Intelligent Transportation System (ITS). The Fed-
eral Communications Commission (FCC) recently allocated 75
MHz in 5.9 GHz band for the Vehicle-to-Vehicle (V2V) and
Vehicle-to-Roadside-unit (V2R) communications. Moreover, it
is predicted that the number of telematics subscribers in the
United States will reach more than 15 million in the future
[1]. The VANET will undoubtedly play an important role in
next-generation networks.
The main purposes of ITS include providing real-time
and comprehensive traffic information, and to give driving
directions. In general, the traffic information can be classified
into three categories: beforehand information, real-time infor-
mation and afterward information. One of the most important
services among them is emergency message dissemination.
Emergency messages are useful for drivers in hazardous
situations, e.g., dangerous road surface conditions, accidents
and unexpected fog banks. Such messages are usually time-
sensitive and localized. These messages can be disseminated
to intended locations through multi-hop broadcast.
Broadcast is a frequently used method for applications
running on wireless environments. However, uncontrolled
broadcasts will lead to broadcast storm problems [2], which
cause severe packet collisions and redundancy and hidden
terminal problems. Due to the high density and mobility of
vehicles, designing an efficient broadcast protocol for VANETs
in urban areas is a big challenge. Recently, there are many
researches working on multi-hop broadcast problems in the
VANETs. Khakbaz and Fathy [3] proposed a relay-point selec-
tion mechanism to reduce broadcast redundancy and collision.
The relay-point selection is an important issue for VANET
broadcast.
The two major challenges of broadcast are to ensure the
reliability of messages while disseminating messages over
the intended regions and keeping the delay time within the
requirements of the applications. The design of broadcast
protocols should exploit the peculiar features that differentiate
VANETs from MANETs. In this paper, we propose a MAC
broadcast protocol, named Streetcast, to meet the requirements
and to relieve the broadcast storm problems. The digital
street map information is used to assist the selection of relay
nodes, and Multicast Request-To-Send (MRTS) [4] [5] is used
to improve the reliability of messages between the sender
and selected relay nodes and to avoid collisions and hidden
terminal problems. In addition, an adaptive beacon control
heuristic is proposed to reduce excessive beacon broadcasts.
The rest of this paper is organized as follows. In Section
II, we introduce related works. In Section III, we present our
Streetcast algorithm. Section IV contains simulation results
and analyses. Conclusions are given in Section V.
978-1-4244-2519-8/10/$26.00 ©2010 IEEE
assume that each vehicle has a GPS to provide position
information. Each node in VANETs periodically broadcasts
a ”Hello” beacon, which includes the node’s ID, location and
time stamp. When a node receives a ”Hello” beacon, it checks
the digital street map and updates the neighbor information to
its neighbor list. A neighbor is deleted from the table if no
beacons are received from it for a period of time. If there is a
message needed to be broadcasted, the node with the optimal
distance [12] is picked from each neighbor list as the relay
node. If transmission fails, they woll not be selected as relay
nodes again.
B. Multicast Request to Send
In Streetcast, we use MRTS [4] [5] to protect message
from collisions. An MRTS is an one-to-many transmission
handshake. With the MRTS mechanism, senders can send
packets to multiple receivers simultaneously without worrying
about collisions and hidden-terminal problems. According to
the implementation described in [4], An MRTS packet may be
larger than a typical packet in 802.11, resulting in collisions
due to hidden-terminal problems. A sender transmits an MRTS
frame first and waits for CTSs from receivers. A source puts
the addresses of relay nodes in the MRTS frame and multicasts
it to the relay nodes. Nodes receiving the MRTS frame set their
NAVs (Network Allocation Vectors) if they are not the relay
nodes. Only relay nodes reply CTSs to the source following the
order specified in the MRTS frame. For example, in Fig. 2, the
node in Ra1 replies first, then Ra2, Ra3 and Ra4. Whenever
the source gets any CTSs, it broadcasts DATA. After receiving
the DATA, the relay nodes send ACKs to the source with the
same order as in the transmission of CTS. The data packet size
increases as there are more receivers. Jain et al. [5] modified
the MRTS frame to include at most four receivers to reduce
collisions and overheads. Fig. 2 illustrates the MRTS frame
format. We fix the number of receiver addresses in the MRTS
FC Duration Src Ra1 Ra2 Ra3 Ra4 FCS
0 2 4 10 16 22 28 34 40Octets:
FC: Frame Control
Duration: NAV Duration
Src: Source Address
Ra1, Ra2, Ra3, Ra4: Receiver Address 1, 2, 3, 4
FCS: Frame Check Sequence
Fig. 2. MRTS frame format.
frame to at most four as in [5]. The transmission may fail
due to loss of CTSs or ACKs. According to the number of
received ACKs, a source can decide whether the transmission
is successful or not, and re-initiate the MRTS procedure. If no
CTS is received, the source will directly re-initiate the MRTS
procedure. Fig. 3 illustrates the detail procedure.
C. Adaptive Beacon Control
In urban areas, there could be thousands of vehicles moving
across intersections in short period of time, according to the
statistics by the Department of Transportation, Taipei City.
If each vehicle keeps sending beacons, it will cause many
Fig. 3. MRTS procedure for VANETs.
collisions and failures. So, we propose a beacon control
mechanism to adjust beacon generation rate.
The main function of beacons in the proposed approach
is to find the farthest neighbor in each direction for greedy
forwarding. However, it is not necessary to let all nodes send
beacons. There should be a proper number of nodes sending
beacons. Consider a specified node, and assume that there
are α neighbors in a direction of this node. Let R denote
the transmission range, X1,X2, ...,Xα denote the distances
between this node and its neighbors, and l denote the farthest
neighbor distance, i.e. l = maxαi=1 Xi. Let F (l) and f (l) be
the CDF and PDF of l. Then,
F (l) = Pr [all neighbors are not l far apart]
= Pr [X1 ≤ l,X2 ≤ l, ...,Xα ≤ l]
=
α∏
i=1
Pr [Xi ≤ l] = ( l
R
)α, (1)
and
f(l) =
d
dl
F (l) = α(
l
R
)α−1
1
R
. (2)
The expected value of l, denoted by E (l), is
E(l) =
∫ R
0
lf (l) dl =
∫ R
0
ldF (l) (3)
= lF (l)|R0 −
∫ R
0
F (l) dl
=
α
α + 1
R.
Let Dopt denote the preferred forwarding progress. So,
the expected number of neighbors sending beacons can be
calculated from E(l) ≥ Dopt. Therefore,
α ≥ E (l)
R−E (l) .
high node density. Almost every one hop neighbor has the
same distance to the source, and broadcasts at the same time.
It will lead to more serious collisions than random backoff
flooding. As shown in Fig. 5, we can observe that MPRs
has the lowest packet delivery ratio among the protocols. It
is because that there is no mechanism to protect wireless
communications in the MPR. Finally, both Streetcast protocols
have high delivery ratio.
Fig. 6 illustrates the packet generation rate v.s. average
collision number. We can observe that both Streetcast versions
0 0.5 1 1.5 2 2.5 3 3.5
0
2
4
6
8
10
12
14
16
18
Packet generation rate (packets/s)
A
ve
ra
ge
 c
ol
lis
io
n 
(co
llis
ion
/s)
 
 
Streetcast
Streetcast−nB
RB
RBM
MPR
Fig. 6. Packet generating rate v.s. Collision
can reduce the collisions efficiently. Note that the most part
of collisions in the Streetcast is caused by beacon broadcasts.
Therefore, adaptive beacon control can effectively reduce the
collision numbers in the Streetcast. The collisions in the flood-
ing based protocols are caused by the excessive rebroadcasts
from receivers. The reason for the collision number in MPR
is comparable to Streetcast protocols is that the MPR does
not have mechanisms to protect wireless communications.
Therefore, the MPR has a higher collision number than both
Streetcast versions.
V. CONCLUSIONS
In this paper, we proposed a broadcast protocol for
VANETs, called Streetcast, which makes use of neighbor
information and digital street map information. The Streetcast
uses the MRTS mechanism to protect wireless communica-
tions, avoid collisions and hidden terminal problems, and
enhance the reliability. The digital street map information
combined with the neighbor information are used for the
relay-point selection. Meanwhile, an adaptive beacon control
mechanism is proposed to reduce the control redundancy. The
simulation results show that for the backoff-based flooding
protocols, they are useful for broadcasting data without know-
ing the network topology or neighbor information in a loose
network, but not suitable for a high density network such as
VANET. The broadcast storm problem is critical to affect the
performance of these protocols. In summary, the Streetcast has
superior performance than random backoff flooding, distance
based multicast and MPRs in terms of packet delivery ratio and
collisions under different traffic loads. In the future, we will try
to use other means of MPR selection methods, e.g., velocity
based grouping, instead of relying the geographic information
obtained by GPS.
ACKNOWLEDGMENT
This work is supported in part by NSC under Grant No.
NSC97-2221-E-009-052-MY3 and NSC98-2218-E-009-023,
by MoEA under Grant No. 98-EC-17-A-02-S2-0048, by ITRI
under Grant No. 99-EC-17-A-05-01-0626, and by the MoE
ATU plan.
REFERENCES
[1] T. Nadeem, P. Shankar, and L. Iftode, “A comparative study of data
dissemination models for VANETs,” in Proceedings of the 3rd Annual
International Conference on Mobile and Ubiquitous Systems: Network-
ing & Services, 17-21 July 2006.
[2] S.-Y. Ni, Y.-C. Tseng, Y.-S. Chen, and J.-P. Sheu, “The broadcast
storm problem in a mobile ad hoc network,” in Proceedings of the 5th
Annual ACM/IEEE International Conference on Mobile Computing and
Networking (MobiCom 1999), 15-19 August 1999, pp. 151–162.
[3] S. Khakbaz and M. Fathy, “Adding reliability of broadcast methods in
vehicular ad hoc networks,” in Proceedings of the Second International
Conference on Next Generation Mobile Applications, Services and
Technologies (NGMAST 2008), 16-19 September 2008, pp. 385–388.
[4] K.-H. Lee and D.-H. Cho, “A multiple access collision avoidance
protocol for multicast services in mobile ad hoc networks,” IEEE
Communications Letters, vol. 7, no. 10, pp. 508–510, Octobor 2003.
[5] S. Jain and S. R. Das, “Exploiting path diversity in the link layer in
wireless ad hoc networks,” in Proceedings of the 6th IEEE International
Symposium on a World of Wireless Mobile and Multimedia Networks
(WoWMoM 2005), 13-16 June 2005, pp. 22–30.
[6] B. Williams and T. Camp, “Comparison of broadcasting techniques for
mobile ad hoc networks,” in Proceedings of the 3rd ACM International
Symposium on Mobile Ad Hoc Networking & Computing (MobiHoc
2002), 9-11 June 2002, pp. 194–205.
[7] L. Briesemeister and G. Hommel, “Role-based multicast in highly
mobile but sparsely connected ad hoc networks,” in Proceedings of the
First Annual Workshop on Mobile Ad Hoc Networking and Computing
(MobiHoc 2000), 11 August 2000, pp. 45–50.
[8] M.-T. Sun, W.-C. Feng, T.-H. Lai, K. Yamada, H. Okada, and K. Fu-
jimura, “GPS-based message broadcasting for inter-vehicle communi-
cation,” in Proceedings of the International Conference on Parallel
Processing (ICPP 2000), 21-24 August 2000, pp. 279–286.
[9] G. Korkmaz, E. Ekici, F. ¨Ozgu¨ner, and ¨U. ¨Ozgu¨ner, “Urban multi-
hop broadcast protocol for inter-vehicle communication systems,” in
Proceedings of the 1st ACM International Workshop on Vehicular Ad
Hoc Networks (VANET 2004), 1 October 2004, pp. 76–85.
[10] K. Suriyapaibonwattana and C. Pomavalai, “An effective safety alert
broadcast algorithm for VANET,” in Proceedings of the International
Symposium on Communications and Information Technologies (ISCIT
2008), 21-23 Octobor 2008, pp. 247–250.
[11] T. H. Clausen, G. Hansen, L. Christensen, and G. Behrmann, “The
optimized link state routing protocol evaluation through experiments
and simulation,” in Proceedings of the Fourth International Symposium
on Wireless Personal Multimedia Communications (WPMC 2001), 9-12
September 2001.
[12] Y. Gao, D.-M. Chiu, and J. C. Lui, “The fundamental role of hop distance
in IEEE 802.11 multi-hop ad hoc networks,” in Proceedings of the 13th
IEEE International Conference on Network Protocols (ICNP 2005), 9
November 2005, pp. 75–84.
[13] X. Zeng, R. Bagrodia, and M. Gerla, “GloMoSim: a library for parallel
simulation of large-scale wireless networks,” in Proceedings of the 12th
Workshop on Parallel and Distributed Simulations (PADS 1998), 26-29
May 1998, pp. 154–161.
四、建議 
無。 
 
五、攜回資料名稱及內容 
無。 
 
六、其他 
 
附錄二：論文海報 
 
1A P2P HD Live Video Streaming System
Chi-Ray Lan, Hsiao-Heng Lu, Chih-Wei Yi and Chien-Chao Tseng
Department of Computer Science, National Chiao Tung University
1001 University Road, Hsinchu City 30010, Taiwan
{ray19861015.cs99g,bennylu.cs98g}@nctu.edu.tw, {yi,cctseng}@cs.nctu.edu.tw
Abstract—Recently, the majority share of Internet traffic is
contributed by video streaming services. Due to the growth of
Internet bandwidth, it is possible to provide HD live streaming
services on the Internet which will be a trend in the near
future. As the population increases, the bandwidth will become
a problem again. Centralized-based systems are not suitable
for such services any more, and P2P architectures will be a
possible solution. However, live services have strict constraints
on playback delay and upload bandwidth. Conventional P2P
architectures need to be modified to fit the situations. In this
paper, we give an analysis on live HD video streaming services
and point out some unique design principles for such systems.
Based on the principles, we proposed a system design for P2P HD
live video streaming. Also, a prototype is developed to meet our
design and be the platform of our future research. Meanwhile,
some implementation details are also introduced to facilitate and
inspire future research works in the community.
Keywords-Live video streaming, peer-to-peer, high-definition.
I. INTRODUCTION
Due to the dramatic increasing of Internet bandwidth, video
streaming becomes possible and is one of the most popular
services on the Internet. More and more people watch live
video on the Internet instead of traditional media. High-
Definition Live Video Streaming (HD-LVS) would be the most
popular Internet service in the future. Compared to Video-on-
Demand (VoD) services, Live Video Streaming (LVS) services
emphasize more on playback smooth and short playback delay.
In addition, ”HD” implies higher bandwidth requirements.
Especially, upload bandwidth will be the major constraint for
sharing HD-LVS in P2P manners. In this paper, we first spend
some space to figure out what are the major factors affecting
the QoS of a HD-LVS system. Then, based on our obser-
vations, we design a P2P-based system architecture for HD-
LVS services and propose algorithms to handle peer joining
and leaving in the system. At the end, we also introduce our
implementation of the proposed system design and algorithms
for future researches.
VoD and LVS are two kinds of streaming services. VoD
allows users to control the video playback absolutely. The
functionality of pausing, forwarding, and rewinding are en-
abled just like playing a local video file. LVS [1], [2], [3] is
fundamentally different from VoD. It provides users the video
content that is currently broadcasted by streaming servers.
The two major QoS metrics of HD-LVS is playback delay
and playback smooth. Video should be fluently played at user
agents and with a small or even negligible lag. Unlike VoD,
pause or playback stopping that will cause the increase of
playback delay are not an necessary option and sometimes
not allowed. Therefore, the download bandwidth at user agents
should be large enough to keep stable streaming throughput.
This is a hard constraint for live streaming.
Centralized architectures in which servers provide video
streams directly to all clients are not feasible for a large
scale HD-LVS system due to the possible huge amount of
bandwidth requirement will make servers the bottleneck. P2P
solutions that offload the loading to peers can efficiently
reduce the burdens on the servers should be the most possible
one. The P2P technique was applied to share files at the
beginning, e.g., BitTorent [4] and Gnutella [5]. Users in the
P2P network contributes their bandwidth to upload files stored
in their machines for sharing. Since the P2P technique can
fully utilize network bandwidth and speed up file sharing in
the community, P2P file sharing systems have achieved a big
success.
P2P video streaming systems can be categorized into
three categories, including mesh-based [6], single-tree-based
[7], and multiple-tree-based [8]. However, mesh-based so-
lutions are usually suffered for longer transmission delay,
and multiple-tree-based solutions usually have a complicated
formation and management plan. Both are not good for live
applications in a dynamic environment. In this paper, based
on our observations about HD-LVS, we propose a single-tree-
based P2P design for HD-LVS and also sketch algorithms for
handling dynamic peer joining and leaving that may happen
frequently in the system. We further develop a prototype to
verify our design and proposed algorithms and to be the
platform for further research works.
The rest of this paper is organized as follows. In Section II,
we point out some characteristics of HDLVS and explain why
we prefer a tree-based P2P design. In Section III, we introduce
the proposed system design and algorithms. Implementation-
related issues are given in Section IV. Section V is the
conclusion for this paper.
II. HD LIVE VIDEO STREAMING
Buffering is a mechanism in video streaming systems to
keep playback smooth and handle insufficiency of bandwidth.
The time needed for packets to travel from a server to a peer is
different from packets to packets. Before start playing video,
the user agent will wait for a while until the buffer has a
certain amount of content. Later on, if packets arrive late, the
user agent can keep playing the content remaining in the buffer
to wait the late packets before the video content in the buffer
is exhausted. So, the amount of content in the buffer reflects
how long the user agents can wait before playback stops.
3newly joining peer v, and sorts them by their playback delay
in increasing order. The PCL is a sub-list of the sorting result
S, which from the Max(K− l2 , 1) -th peer to the Min(K+ l2 ,
S.length)-th peer, where l is the length of the PCL and K
is the number of peers which have upload bandwidth larger
than v. This algorithm is based on this concept, peers with
higher upload bandwidth are deserve a lower playback delay.
So, they obtain PCLs which include candidates with lower
playback delay.
We also propose a distributed algorithm to lower the average
playback delay of the system. Each peer v executes this
algorithm periodically. Initially, there are two candidate sets:
a parent set which contains only v′s parent and a child set
which contains v and v′s children. The following three steps
are repeated until either the parent set or the child set become
empty. (1) Randomly pick two candidates p and q from the
parent set and child set, respectively. (2) Remove p from the
parent set if p does not have remaining upload bandwidth to
support additional children. (3) Move q from the child set to
the parent set if it has remaining upload bandwidth to support
additional children. The new schedules will be committed if
the average playback delay is better.
IV. SYSTEM IMPLEMENTATION
We use Java programming language to develop our system
which can be run on cross platforms. Xuggle that is a Java
wrapper of FFmpeg is the multimedia kernel. It helps to
extract video streams from video sources and de-compress the
extracted video streams. In the rest of this section, we describe
the implementation details of the proposed system design.
A. Tracker
The tracker is comprised of Channel Managers, a Request
Dispatcher, a Passive Socket. The tracker receives the requests
from peers and media servers, and dispatches requests to the
corresponding Channel Managers. The software design of the
tracker is illustrated in Fig. 1.
Passive
Socket
Request
Dispatcher
Channel
Manager
hannel
anager
Channel
Manager
hannel
anager
Channel
List
Tracker
Media Server & Peers Requests
Fig. 1. The software architecture of Tracker.
1) Passive Socket: The tracker opens a Passive Socket for
media servers and peers to establish connections.
2) Request Dispatcher: The request dispatcher receives
requests from the media server and peers and dispatches the
requests to the corresponding Channel Managers. The types
of requests include: requests from media servers to register
new channels, requests from peers to acquire a channel list,
requests from peers for login, requests from peers for joining
and leaving channels, requests from peers to ask changing the
parent, and reports of heart-beat signals.
3) Channel Managers: Each channel has a corresponding
Channel Manager. The Channel Manager is used to manage
the channel information. The design of Channel Managers is
illustrated in Fig. 2. Peer Map includes the network topology
PCL Generator
Topology
Monitor
Peer Churn
Handler
Peer Map
Heart-beat
Handler
Channel Manager
Fig. 2. The architecture of Channel Managers.
of the channel and the network status of peers. The tracker
superintendents can monitor the present network topology
through a Topology Monitor. Peers periodically report there
network status to the tracker, including their transmission de-
lay, upload bandwidth and parent, etc. The Heart-beat Handler
collects information and updates Peer Map. Whenever a peer
joins, the Peer Churn Handler sends a request to the PCL
Generator, and then the PCL Generator generates a PCL to the
new peer. In the other hands, the Peer Churn Handler refleshes
the network topology if some peers leave the channel.
4) Database: The database of the tracker is based on
SQLite to store the user and peer information.
B. Media Servers
The media servers can register several channels to the
tracker and provides video streams from media sources to
subscribers. There are five modules in our design, including
Stream Generator, Relay Buffer, Stream Relayer, Connection
Pool and Passive Socket. The software design of the Media
Servers is shown in Fig. 3.
1) Stream Generator & Relay Buffer: The Stream Genera-
tor captures video streams form video sources through Xuggle
API. Moreover, it wraps video stream data and related infor-
mation, e.g., sequence number, data type and timestamp, in a
DATAPACKET, and the control messages, e.g., end of stream,
in a CONTROLMESSAGE. Both of the CONTROLMESSAGE
and DATAPACKET are temporarily stored in Relay Buffer that
is a FIFO queue and then are forwarded to channel subscribers.
國科會補助計畫衍生研發成果推廣資料表
日期:2011/11/04
國科會補助計畫
計畫名稱: 子計畫四:以感測系統為基礎之整合式室內及室外定位系統
計畫主持人: 易志偉
計畫編號: 97-2221-E-009-052-MY3 學門領域: 計算機網路與網際網路
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
在研究期間獲得多項榮譽，如Young Scholar Best Paper Award, IEEE IT/COMSOC 
Taipei/Tainan Chapter, 2010. (IEEE ITSOC 台北支會暨 COMSOC 台北/台南支
會 2010 年「年輕學者最佳論文獎」)、經濟部 2010 年「車載資通訊 WAVE/DSRC
創新應用競賽」實作組優勝，參與學生：莊宜達、粘家盛及 Outstanding Research 
Award, National Chiao Tung University, 2010. (國立交通大學 99 年度「傑
出人士榮譽獎勵」) 
在學術服務方面，主持人擔任國際期刊的編輯（Ad Hoc & Sensor Wireless 
Networks, Editor, Old City Publishing, June 2010 - present 及 ISRN 
Communications, Editor, Hindawi Publishing Corporation, June 2010 -
present），並參與多項的組織委員會及技術委員會（如 ICPP 2011 Registration 
Chair、WASN 2011 Program Co-Chair、TAAI 2010 Local Chair、IEEE InVeNET 
2010 Program Co-Chair、WiOpt 2011 TPC、IEEE/IFIP EUC 2010 TPC、TAAI 2010 
TPC 等）。 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
