用的便是大型資料集，照常理來推論，本計畫應當
使用分割式分群演算法，以達到較佳的效率，但在
入侵偵測的研究中，有效的加強偵測率似乎才是一
般最關心的重點。而且分群機制目的只是為了在最
初時建構一完善特徵庫，因此本計畫認為使用階層
式分群演算法來替入侵偵測資料集進行群集分
析，是一可行且有意義的研究。 
 
2.2 關聯法則 
 
在入侵偵測方法之中，除了利用群集演算法分
出正、異常行為外，另外也有許多的研究是採用關
聯法則演算法，分析使用者行為，在各種行為特徵
中找出其間的關聯，以發掘出可疑事件的關聯性。
如 Lee [11]等學者利用關聯法則演算法從記錄系統
各個特徵的系統記錄檔中發掘出有用的樣式，這些
樣式包括了許多程式和使用者的各項行為，並計算
這 一 系 列 相 關 的 系 統 特 徵 以 產 生 分 類 器
(Classifier)，而這分類器所存的資料就是關聯法則
庫，其主要目的是辨別出各種異常和已知之入侵行
為。Hossain 學者是利用關聯法則的方式[5]，從資
料庫中找出多個特徵值之間的關聯性，之後將關聯
法則建構成決策樹型式的分類器，每個定義好的分
類器就是使用者的行為模式，用以判定是正常或異
常的行為。 
 
2.3 情境法則 
 
為了要找出更好的法則，資料探勘應用於入侵
偵測領域在 1997 年由 Mannila 等人[11]發展出頻繁
情境法則(Frequent Episode Rules)，頻繁出現的情境
可能來自於稽核網際網路的記錄，一段情境就是表
示一個網路的連接序列事件，而在網路傳輸的異常
行為記錄中去發掘一個情境(Episode)，目的是要發
現行為事件之間的關係，這些關係能用在行為資訊
流的分析，可降低多餘的行為分析，並預知事件的
發生，也就是透過情境法則可以瞭解事件與事件之
間的關聯性。入侵行為資料流可認為是一種時間序
列。情境法則便可從行為資料流的資料庫中搜索出
所有支援度大於最小支持度的情節，並輸出信賴度
大於最小信賴度的規則。 
情境法則一開始雖被發展於資料探勘，但因其
特長描述網路交通的封包，所以最常被應用在入侵
偵測系統中。在 Mannila 所提出之情境法則研究
中，會產生法則數量過多且法則過長等問題。因
此，在後續情境法則研究中，為解決在此之前的情
境法則常有無效及過長的法則產生的問題，Luo 等
人 [9]便以模糊理論來解決此問題。於 2003 年
Dobrowiecki [4]研究中應用情境法則來探勘警訊使
得能有效的建構出攻擊的警訊模組。Qin 與 Hwang 
在 2004 年 Qin [14]更提出了其改進的演算法，削減
大量多餘的情境法則的產生。然而此一演算法所產
出的法則對攻擊的偵測方面仍嫌不足，尤其是偵測
率不足 50%，因此本計畫於其演算法中導入模糊理
論原理，以提高所產出法則的偵測率。 
 
2.4 誘捕系統 
 
誘捕系統(Honeypot)[15][13]是在網路安全領
域有重大潛在性且是一項令人矚目的新技術，這個
觀念被介紹在電腦網路安全方面，首先是在西元
1990 和 1991 年，由 Cliff Stoll 和 Bill Cheswick 所
提出，自此以後，誘捕系統持續的被發展和研究
演，變成今日強而有力的安全工具。Honeynet 
Project 的主要成員 LanceSpitzner 是這樣定義誘捕
系統：「誘捕系統是一個策略性資源，它的價值是
在被攻擊和利用牽累。這意味著，Honeypot 期望得
到被探查，攻擊和可能地被利用，Honeypot 不會修
護任何東西，它是提供給我們額外且有價值的資
訊。」Honeypot 能偽裝成一個真正的目標，主要的
目的是分散攻擊者的注意力和得到有關攻擊者的
攻擊資訊，而使用誘捕系統有以下之優點[10]。 
一、誘捕系統收集少量且具有高價值的資料，
它除去了不必要的訊息，使它收集的資料都具有很
高的價值。在入侵偵測中最大的問題就是如何在大
量的資料當中，找到所需要的資料，誘捕系統能很
快地收集到資料，並迅速的瞭解攻擊者的一舉一
動。 
二、網路入侵偵測系統為了追蹤所有的網路行
為，而可能丟棄一些封包。集中化的日誌伺服器並
無法收集所有的系統日誌，而可能流失一些日誌記
錄。有些網路安全工具會受限於頻寬，而無法觀測
到特定的行為。而誘捕系統就沒有這個問題，因為
它只是去截取對於它所關心的動作。 
因此本計畫結合了誘捕系統的優點，希望能達
到較完善的無線區域網路入侵偵測系統。 
 
2.5 無線區域網路安全相關議題 
 
802.11 無線網路探討的範圍在於通訊用戶端
與存取點 (Access Point, AP) 端無線通訊過程中可
能發生的問題，或是因無線通訊的特性無法避免會
產生的一些安全議題, 還有通訊用戶與存取點本身
的安全問題，下列為針對現行無線區網的安全相關
議題[16]之探討: 
․ 以偽造存取點攻擊用戶端 
無線網路裡用戶端跟存取點之間的連線建立
靠的第一個條件是服務域名(SSID)。那麼如果今天
同時有兩個無線區域網路存取點同時使用同樣的
服務域名，那麼用戶端該跟哪一個建立連線?考慮預
設的情況下，用戶端會跟訊號比較強的存取點建立
連線。 
一個惡意攻擊者可利用上述之原理偽造存取
點騙取不知情的用戶端連線後從偽造存取端對用
戶端發動攻擊，因為很多用戶端的電腦保護可能不
若其他重要電腦的保護的保護來的完善，因此攻擊
2 
Time_slot 
這是一個類別屬性值，我們將這個數值
分為：{早上(morning)、白天(day)、晚上
(evening)}這三種值 
ShotRet 工作站收到 RST (Reset)封包的平均數量
LongRet 工作站收到資料封包的平均數量 
Quality 
這是一個介於 1~100 數值，主要是記錄
網路傳輸品質 
Strength 訊號波的長度 
SrcPkts 
這是一個類別數值，表示從某個工作站
獲得傳輸活動頻率數值，其數值可分
為：{高(high)、中(medium)、低(low)} 
SrcErrPkts 傳輸給來源工作站的錯誤封包數 
DstErrPkts 傳輸給目的工作站的錯誤封包數 
DstMaxRetryErr 
傳輸給目的工作站且封包屬性標記為重
送封包的錯誤封包 
 
 
 
3.3 整合誘捕系統 
 
本計畫整合無線誘捕系統，負責吸引、記錄與
分析欲對無線網域內從事探測、攻擊與控制的駭客
活動，並將分析結果傳至入侵偵測系統如圖 2 所示， 
並藉由誘捕系統的優點，希望能達到較完善的無線
區域網路入侵偵測系統。 
 
 
圖 2 整合誘捕系統與入侵偵測系統之架構 
   
3.4 分群 
 
分群演算法的功用是為原始的資料集做分
群，一個合適的分群演算法除了可以降低處理時間
外，也要能準確的分割正、異常群集。分群演算法
可分為階層式及分割式兩類[6]，兩者各有其優缺
點，故本計畫在研究分群演算法的第一階段中，將
選擇一個較合適的分群演算法，並將其修改，使之
能貼切地應用於對 Linux 系統記錄檔作分群。在第
二階段中，將利用統計方法[8]，使分群出來的群
集，能由系統自動來認定何者為正常群集或異常群
集，並標記之。 
本計畫所應用之高準確度階層式之記錄檔分
群，方法是基於 Tsaur and Yu [18]所提出之機制，其
概念可藉由圖 3 來說明。所有的樣本在初始階段
(Level 0)都被視為一個完整的群集 Cluster 0，而之
後每一階層的分群都是使用分離的概念來進行，並
使用代號來辨視群集，如 Cluster l,p,k 即代表該群
集位於 l 層，其父節點為(l-1)層的第 p 個群集，而
該群集是該階層的第 k 個群集。同時，在每一個階
層內所產出的 Outlier 集合都視為異常行為。 
 
 
圖 3 高準確度階層式記錄檔分群 
 
3.5 法則探勘技術 
 
本計畫所應用之模糊關聯與模糊情境法則機
制架構，如圖 4 所示，經由階層式分群演算法得出
各個群集後，各群集特徵樣式將會被記錄下來，以
做為新進資料被歸類為正、異常群集的依據。接著
便由模糊關聯法則探勘技術將先前分群過的正常
及異常群集，導出正常及異常行為之關聯法則。之
後同樣以正常及異常群集，藉由模糊情境法則探勘
技術導出具多重攻擊特徵的規則及一般使用者正
常行為的規則，建立出這些法則後，便將這些法則
再存入法則資料庫。這些法則是可以提供給系統管
理者，做為建構入侵偵測系統之依據。 
 
 
圖 4 模糊關聯與模糊情境法則機制架構 
 
在模糊關聯法則運算的部分採用 Tsaur and 
Shieh [17]提出改進的 FGBRMA(Fuzzy Grids Based 
Rules Mining Algorithm)演算法，此演算法是利用
Boolean(AND、OR 及 XOR)的方式獲得法則。此演
算法只需要對資料庫掃瞄一次，以降低系統從磁碟
讀取資料的時間，但此演算法原先在利用 XOR 運
算時，會產生一些無效的法則，如 ，
再經由 Tsaur 等人改進後，便減少產生無效的法則。 
1321 *X kkllk XX⇒
雖然以模糊關聯法則機制來提高關聯法則的
4 
 PosTruePositiveFals
PositiveFalseRatioPositive
__
___ + itiveeFalse =
Negative
oDetection
__ + FalsePositiveTrue
PositiTrueRati_ = ve_
圖 8 本 IDS 即時偵查到未知(unclear)記錄 
 
攻擊三: 遠端針對被攻擊節點進行掃描，並意圖對
有漏洞的程式進行緩衝區溢位攻擊，而
Snort_Inline 能即時阻檔已知的攻擊行為。 
攻擊主機: 192.168.254.77 
Snort_Inline: 192.168.254.1 
被攻擊節點: 192.168.254.1 
圖 9 顯示本機制針對攻擊三之偵測結果。 
 
 
圖 9 本 IDS 能偵測並沒有再顯示亂碼記錄 
 
攻擊四:無線區域網路下的阻絕服務攻擊(DoS)，攻
擊節點意圖癱瘓被攻擊節點與 AP之間的聯
繫，使被攻擊節點得不到 AP 的服務。 
攻擊節點: 192.168.254.77 
被攻擊節點: 192.168.254.1 
圖 10 顯示本機制針對攻擊四之偵測結果。 
 
 
 
 
 
 
圖 10 本 IDS 偵測到有人在進行 DoS 攻擊 
 
4.3 實驗分析 
 
本計畫之實驗取自 Balazinska and Castro [1]論
文資料，該論文從真實網路設備上收集了無線網路
設備記錄檔並對其記錄檔作了詳細的分析，且該論
文作者，設有專門網站下載點，供人下載他們研究
的實驗資料樣本。而本計畫實驗方法，學習自
Khoshgoftaar [7]學者所提文獻，收集到的實驗資料
共為三週，先以這三週為訓練資料，隨後再經由產
生出來的法則比對這三週內的資料來評估法則是
否有效，以下就實驗結果作一分析與評論。 
評估入侵偵測系統優劣的指標一般都採用偵
測率(Detection Rate)與誤報率(False Positive)，因此
本計畫也以這兩樣指標來對本系統作一分析評
估，首先根據第一到第三週的資料與法則庫內的法
則進行比對後可以得到四種比對結果，如圖 11 所
示。再依公式(1)與(2)分別進行計算以得到偵測率及
誤報率。 
                   
                      
                                         (1)    
 
                        
                                         (2) 
             
 
 
 
圖 11 偵測結果的四種可能性 
 
本系統經由三週測試資料的實驗結果如圖 12
所示，本計畫所提出之 IDS 的平均偵測率為
81.3% ，平均誤報率為 1.03% 。最後我們與
Khoshgoftaar 等人所得之結果作一比較，由圖 13 中
可知 Khoshgoftaar 等人所獲之偵測率平均為
75.03%、誤報率平均為 1.5%，由此得知本系統偵測
率與誤報率均優於 Khoshgoftaar 等人所提之機制，
究其原因主要為 Khoshgoftaar 等人使用 K-mean 分
群演算法，其群集數一開始就已經設定好，對入侵
偵測應用來說其演算法較不適用，也就是說本系統
所採用之階層式分群演算法確實有效提升入侵偵
測系統之偵測率。 
 
 
圖 12 實驗結果 
6 
