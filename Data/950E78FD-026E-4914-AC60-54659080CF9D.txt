 2
並無客觀決定群集組數的方法，端視研究者的需要及經驗決定。非階層群集分析法通常需在
進行分析之前決定群集的組數，然而不同的群集組數常會導致差異極大的分析結果。對於水
文屬性均一區的劃分來說，判定資料是否確實存在群集的關係及如何決定適當的群集組數乃
是一重要的課題。有鑑於此，本研究嘗試利用類神經網路中一種知名的網路模型—自組織映
射圖網路（Self-Organizing Map, SOM）來進行區域分析之均一性區域劃分。 
類神經網路（neural network）是目前廣受歡迎且知名的研究工具，其在解決大量且複雜
的資料探勘（data mining）、函數逼近（function approximation）以及樣式辨別（pattern 
recognition）等工作具有強大之潛力。本研究所使用的 SOM網路是由 Kohonen(1990)所提出，
屬於非監督式及競爭式學習的網路模型。其功能是將高維度的資料映射至低維度的圖形中，
並保存資料原本的拓樸結構及顯現資料內在的統計特徵，近來廣泛被應用於各種領域上
(Wang et al., 1996; Orwig et al., 1997; Tokutaka et al., 1999; Michaelides et al., 2001, Tennant and 
Hewitson, 2002)。Zhang and Li (1993) 提出了利用 SOM網路找出資料的群集關係及群集邊界
的方法，稱之為自組織映射圖網路分析(SOMA)。Chen et al. (1995) 以及Mangiameli et al. (1996) 
曾經比較 SOM 網路與傳統之群集分析法，結果均顯示 SOM 網路有較佳之群集分析結果。
Vesanto and Alhoniemi (2000) 利用 SOM網路進行了二步驟之群集分析。首先應用 SOM網路
分析原始資料，待原始資料被映射至低維度之圖形時，再以其他群集分析方法分析前一步驟
所得的特徵圖(feature map)，利用此二步驟分析所得之分群效果較傳統方法更佳，且可大幅減
低群集分析所需之計算時間。Kiang (2001) 則將 contiguity-constrained clustering method引入
了 SOM 網路來進行群集分析並與其他群集方法比較，說明引入了 contiguity-constrained 
clustering method的 SOM網路的強健性。Michaelides et al. (2001) 運用 SOM網路分析降雨之
變異性，並用以提供氣候模型使用，其結果亦顯示 SOM 網路較階層式群集分析法更能顯示
出降雨變異性的細節。 
本研究之目的為應用 SOM網路於區域頻率分析之均一性區域劃分上。首先，對於 SOM
網路之理論、架構以及如何應用於群集分析上作介紹。再者，本研究設計兩組二維資料，用
以測試 SOM 網路與傳統之 K 均值法以及華德法兩種群集分析方法對於群集分析之正確率。
最後，將 SOM網路應用於台灣雨量站之均一性區域劃分，並與傳統群集分析之結果作比較。 
 
二、SOM類神經網路 
 
SOM 網路的發展與人腦的特性具有相當大的關聯性。在人腦中，特定的行為是由某特定
區域的大腦皮質所負責控制。諸如觸覺、視覺與聽覺均是由腦中不同區域的皮質層所負責控
制，SOM 網路便是以此概念為基礎所形成的類神經網路模型。SOM 網路在類神經網路的領
域中是一種知名的網路模型，可用在資料探勘、樣式分類等用途。圖 1為 SOM網路架構圖。 
一個典型的 SOM網路由一個輸入層與一個計算層所組成。輸入層由一組的輸入節點所組
成，而計算層由一組的神經元（neuron）所構成。在計算層中，神經元的排列方式可為一維
的線狀（linear）排列、二維的網格式（lattice）排列或者是更高維度的排列方式，然以二維
的排列方式較為常用。以學習過程來分類 SOM網路的話，SOM網路是以競爭式學習為基礎
的網路模型。所謂的競爭式學習，顧名思義是指在每次的學習網路中的神經元彼此相互競爭
以得到被激發的權利。每一次的學習只有一個神經元會被激發，該被激發的神經元稱為優勝
的神經元（winning neuron），後文中將該神經元稱為優勝神經元。SOM 網路的每一個神經
元與輸入層中的每一個節點均是完全連接的（fully connected）。不僅神經元與輸入層的節點
相連接，各神經元中亦存在著橫向的相互作用，此種作用的目的在於抑制某神經元附近的神
經元被激發，而使得該神經元自己被激發。 
 4
其中， 0σ 為σ 在演算時的初始值，疊代次數， 1τ 為常數。因此拓樸鄰域可寫成 
( ) ( ) ( )⎟⎟⎠
⎞
⎜⎜⎝
⎛−=
nσ
d
nh ijij 2
2
,
x, 2
exp                                             (5) 
上式又稱為鄰域函數(neighborhood function)，其會隨著時間（疊代次數）改變而改變。 
2.3調整程序 
在神經元的鍵結調整過程中，神經元的鍵結被調整往靠近輸入樣式的方向。其調整的方式
以原始的 Hebbian(1949)假設為主，然此假設並未能完全滿足自組織映射圖網路的需求。因此
需引進一個失憶項(forgetting term)修正原始的 Hebbian假設，鍵結值的調整的方式如下所示： 
( )jjj WXhW −=∆ η                                             ( 6 ) 
神經元鍵結的差值由上式可得。所以新的神經元的鍵結值可由下式得到。 
( ) ( ) ( ) ( ) ( )( )tWXthttWtW jjjj −+=+ η1                                    (7 ) 
其中，η 為學習率。而只有被包含在拓樸鄰域內的神經元的鍵結才會被調整。在不斷將輸
入樣式輸入到網路時，拓樸鄰域在每一次輸入樣式輸入到網路中時就更新一次，因此自組織
映射圖網路逐漸能捕捉到輸入樣式的統計特性。在收斂的自組織映射圖網路中，相鄰的神經
元具有相似的鍵結，距離較遠的神經元的鍵結則相差較多。 
在鍵結值的調整的過程中有二個重要階段，分別是自組織(self-organizing)或稱排序階段及
收斂階段(Kohonen,1982,1997a)。 
1. 自組織階段 
這是鍵結值調整的過程中第一個階段。在這個階段中，神經元的鍵結向量開始進行其拓樸
排序。其學習率需保持在靠近 0.1 的數量級，但不得低於 0.01。拓樸鄰域在一開始需包含整
個網路中的神經元，再隨著疊代次數的增加而減少。這個階段可能需要 1000以上的疊代次數。 
2. 收斂階段 
在這個階段，網路開始進行微調的工作以提供更精確的有關輸入樣式的統計量化的描述。
為得到更好的結果，在這個階段中學習率應該保持在 0.01左右的數量級，而拓樸鄰域應該只
包含最靠近優勝神經元的神經元。而這個階段需要幾千次的疊代次數。 
 
三、網路於群集分析之應用 
 
當 SOM網路訓練結束且已收斂時，以網格表示網路中所有的神經元，再將原先的輸入樣
式輸入到 SOM 網路並將其對應激發的神經元及輸入樣式的編號或其名稱分別標示在網格
中，即得到特徵圖(feature map)。被標示的網格元素表示網路中的神經元被某特定的輸入樣式
所激發，該元素則稱為該特定輸入樣式的映像(image)。在特徵圖中，一個輸入樣式只會擁有
唯一的映像，但是一個映像卻可以同時是其他很多不同輸入樣式的映像。計算每個映像所對
應的輸入樣式數目並將其填入該網格中即可得到密度圖(density map)，從中可以得知輸入樣式
在密度圖散佈的情形。輸入樣式之間若具有相似的特性，其會有坐落在密度圖同一區域的傾
向；而輸入樣式之間的差異較大時，其在密度圖上的位置則會較為分散。換句話說，當輸入
樣式之間確實存在某些群集的情況時，其群集的情形會顯示在密度圖。在輸入樣式較密集的
區域，密度圖會顯示出高原(plateau)的存在，表示群集存在於此區域；在輸入樣式較稀疏的區
域，其密度圖會顯示出山谷(valley)，顯示出群集間的界線。此性質可被應用在高維度資料的
群集分析中。利用 SOM網路進行群集分析有二個優點： 
 6
      表 1 測站特徵值轉換型式 
測站特徵值 X 群集數值 Y 
UTM_x (m) 
minmax
min
XX
XXY −
−=  
UTM_y (m) 
minmax
min
XX
XXY −
−=  
測站高度 (m) 
maxX
XY =  
年雨量平均值 (mm) 
maxX
XY =  
年雨量標準偏差 (mm) 
maxX
XY =  
1月~12月之各月平均雨量 (mm) 
maxX
XY =  
 
圖 4 每個群集之測站位置分布圖 
5.3異質性測試 
異質性測試(heterogeneity test)常被用以測試經由群集分析所得之均一性區域，其水文量是
否具有均一性 (Hosking and Wallis, 1997)。異質性測試主要是測試均一性區域內之測站間，其
L動差間之分散度。Hosking and Wallis (1997) 建議使用 L-CV之標準偏差為分散度之簡單計
算。單站樣本 L-CV之權重標準偏差(weighted standard deviation)可經由下式求得： 
 8
      表 3 K均值法所得群集之異質性測試結果 
群集編號 測站數目 異質性測試統計參數 H 
1 27 1.68 
2 11 1.39 
3 22 1.36 
4 18 2.96 
5 29 2.41 
6 21 -0.99 
7 18 0.86 
8 8 -0.35 
 
      表 4 華德法所得群集之異質性測試結果 
群集編號 測站數目 異質性測試統計參數 H 
1 14 -0.66 
2 15 -1.81 
3 8 -0.35 
4 16 1.93 
5 29 1.44 
6 25 1.29 
7 15 1.50 
8 32 3.42 
 
五、結論與建議 
於本研究中，SOM 網路被應用於於區域頻率分析之均一性區域劃分上。首先，SOM 網
路之理論、架構及如何應用於群集分析上分別被介紹。再者本研究將 SOM 網路應用於台灣
154 個雨量測站之均一性區域劃分上。經由 12 × 12 之密度圖可發現這些雨量測站可被劃分
成八個群集。此外，經由異質性測試之結果顯示，由 SOM 網路所劃分之均一性區域均較其
他兩種傳統群集分析方法更為適合。由於經由 SOM 網路產生之密度圖，使用者可以目視得
到群集數目，且 SOM 網路於群集分析之正確率亦較傳統之方法為高，因此對於區域頻率分
析之均一性區域劃分將有相當大之幫助。 
 
六、參考文獻 
 
Burn, D.H., 1989. Cluster analysis as applied to regional flood frequency. Journal of Water 
Resources Planning and Management. 115, 567-582. 
Chen, S.K., Mangimeli, P., West, D., 1995. The comparative ability of Self-organizing neural 
networks to define cluster structure. Omega, International Journal of Management Science. 23(3), 
271-279. 
Fovell, R.G., Fovell, M.Y.C., 1993. Climate zones of the conterminous United States defined using 
cluster analysis. Journal of Climate. 6, 2103-2135. 
Guttman, N.B., 1993. The use of L-moments in the determination of regional precipitation climates. 
Journal of Climate. 6, 2309-2325. 
Guttman, N.B., Hosking, J.R.M., Wallis, J.R., 1993. Regional precipitation quantile values for the 
continental U.S. computed from L-moments. Journal of Climate. 6, 2326-2340. 
Haykin, S., 1994. Neural Networks: A Comprehensive Foundation. IEEE Press, New York. 
