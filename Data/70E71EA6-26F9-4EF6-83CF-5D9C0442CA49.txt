 2
行政院國家科學委員會專題研究計畫成果報告 
癌症化學治療腫瘤成長與用藥時程規劃之疾病系統生物模式與 
最佳化的研究 
Modeling and Optimization of Tumor Growth and Drug Scheduling for Cancer Chemotherapy 
計畫編號：NSC95-2221-E-153-002 
執行期限：自 95 年 8 月 1 日至 96 年 7 月 31 日止 
主持人：蔡進聰 助理教授 國立屏東教育大學資訊科學學系 
共同主持人：陳幼梅 博士候選人 高雄醫學大學護理學系 
計畫參與人員：洪國城 
中文摘要 
本計畫案之目的在於研究癌症化學治
療中腫瘤成長與用藥時程之疾病系統模式
，且使用穩健型之田口免疫最佳化演算法將
用藥時程加以最佳化，此研究成果將提供給
研究癌症化學治療理論與實務人員的參考
與依據。以往有多數的研究者針對癌症化學
治療中腫瘤成長與用藥時程之疾病系統模
式進行研究與探討，但其部份模式並不符合
臨床經驗與醫學知識，且在用藥時程的規劃
上常使用嘗試錯誤法、經驗法、或隨機產生
新解的最佳化演算法來搜尋解答，所以搜尋
出來的用藥時程並不知是否已經達到最佳
解。因此，建立合理之癌症化學治療中腫瘤
成長與用藥時程模式，並引進一套好的最佳
化演算法來解決以上問題，成為相當重要的
課題。本計畫之研究過程已搭配臨床醫學知
識，來改良目前存在的癌症化學治療中腫瘤
成長與用藥時程模式，並引進智慧型計算技
術中具有穩健性能與系統化推理能力的田
口實驗設計法，結合擁有全域搜尋能力的人
工免疫最佳化演算法，來找尋最佳之癌症化
學治療用藥時程模式。此研究成果已得到合
理之癌症化學治療中腫瘤成長、用藥時程模
式、與較佳之用藥時程規劃。 
關鍵詞：癌症化學治療、腫瘤成長模式、用
藥時程、免疫演算法、田口實驗設計法、最
佳化演算法 
Abstract 
The purpose of this project is to study 
modeling and optimization of tumor growth 
and drug scheduling for cancer chemotherapy 
and to develop a robust Taguchi-based 
immune algorithm for optimizing the drug 
scheduling. Many researchers have studied a 
model of tumor growth and drug scheduling in 
cancer chemotherapy, but the partial model of 
tumor growth is not consistent with the 
clinical experience and the medicine 
knowledge. In addition, the methods, which 
are trial and error, experience, and 
random-based approaches, are not efficient to 
find the optimal drug scheduling. Therefore, it 
is an important topic to build a reasonable 
model of tumor growth and drug scheduling 
for cancer chemotherapy and to develop a 
useful optimization method for the 
aforementioned problems. First, in the 
prospective research period, the existing 
model of tumor growth and drug scheduling 
for cancer chemotherapy have been improved 
with the medicine knowledge. Then, the 
robust evolutionary algorithm combined the 
Taguchi method, which has the capability of 
the robust design and the systematic reasoning, 
with the immune algorithm, which has a 
powerful global exploration capability, has 
been applied to find the optimal drug 
scheduling. 
Keywords: Tumor Growth, Drug Scheduling, 
Cancer Chemotherapy, Immune Algorithm, 
Taguchi Method, Evolutionary Algorithm. 
前  言 
癌症為現代人的文明疾病，近年來得到
癌症的人口比例逐年增加，根據衛生署公佈
民國九十三年國人十大死因，癌症連續 23
年高居首位，平均每 14 分 27 秒就有一人死
於癌症。因此，癌症的預防與治療成為當務
之急，本研究針對癌症化學治療中腫瘤成長
 4
以上方程式當 t → ∞時，N(t) → Θ。 
以上的模式中邏輯成長  (Logistic 
growth) 與 Gompertz 成 長  (Gompertz 
growth) 等模式，皆可合理的描述腫瘤的成
長模式，在腫瘤早期的成長過程中以指數的
特性來表示，而在腫瘤的成長後期則逐漸減
緩達到穩定的腫瘤大小，而且這兩種成長模
式皆擁有解析解的優點，可明確的描述腫瘤
的成長現象。然而，經由 Sullivan and Salmon 
(1972)的實驗驗證，顯示 Gompertz 成長模式
比邏輯成長 (Logistic growth) 模式要來的
好，雖然後來仍有許多的腫瘤成長數學模式
被提出 (Marusic et al., 1994)，但 Gompertz
的腫瘤成長模式，仍廣泛地被大多數的研究
者所接受。 
癌症的化學治療是相當的複雜，其中包
含治療不同的區域、不同治療條件、與使用
不同範圍和等級抗癌的藥、…等。如抗癌的
藥物就有成千上百種的藥可被用來治療，可
被分類為殺死癌細胞的藥或抑制癌細胞生
長的藥。為了因應治療癌細胞的藥物種類、
藥物的毒性、與治療條件、…等等，上述
Gompertz 的腫瘤成長模式需進一步的被強
化，同時也需建立癌症化學治療用藥時程之
系統模式，因此，值得再作更深入的探討。 
以上所述為說明為何需建立合理之癌
症化學治療腫瘤成長與用藥時程之疾病模
式的重要性，但為有效的達到治療的效果，
需找到最佳的治療用藥時程規劃，以往的研
究者在用藥時程的規劃上常使用嘗試錯誤
法、經驗法、或隨機產生新解的最佳化演算
法來搜尋解答，所以搜尋出來的用藥時程並
不知是否已經達到最佳解。因此，引進一套
好的最佳化演算法來解決以上問題，成為相
當重要的課題。本計畫案依據本計畫案主持
人過去幾年來在最佳化演算法的研究經驗
，使用一種強健型的最佳化演算法，稱為田
口免疫最佳化演算法（Tsai and Chou, 2006
），來找尋最佳的癌症治療用藥時程規劃，
以達到有效治療癌症的效果。 
 
研究目的 
癌症之化學治療是一種系統化的治療
，其模式的建立需考量多方面的因素，如治
療不同的區域、不同治療條件、使用不同範
圍和等級抗癌的藥、與藥物的毒性、…等等
。本研究計畫從上述 Gompertz 的腫瘤成長
模式為基礎，進一步的探討所需考量的因素
加以改進，來建立較合理的癌症化學治療中
腫瘤成長與用藥時程模式，並使用田口免疫
最佳化演算法將癌症化學治療用藥時程規
劃模式最佳化。首先考慮將殺死腫瘤細胞的
項目加入至 Gompertz 的腫瘤成長模式之方
程式(3)中，改良後的腫瘤成長模式之方程式
如下： 
0)0()),())(
ln(()()( NNtCk
tN
tN
dt
tdN =−Θ= α ,
                (4) 
其中 C(t)表示在時間 t 時，抗癌藥物集中量
，k 表示一個比例常數。以上的腫瘤成長模
式經由 Skipper et al. (1964)與 Sullivan and 
Salmon (1972)的實驗證明，是一個合理的腫
瘤成長模式。 
然而，抗癌藥物經由注射透過血液的流
動傳達至腫瘤處，其中經過許多的過程，藥
物的效果與毒性無法十分的了解。假設抗癌
藥物集中量 C(t)是時間的函數，與毒性的限
制互相關聯，因此，以下的限制條件將被採
用： 
瞬間的藥物集中量 C(t)應小於最大允許藥
物集中量 Cmax，也就是 0≤ C(t) ≤ Cmax, 0≤ t 
≤T, T 為治療的期間。此外，累積的藥物量
在治療期間應小於最大允許的藥物累積量
Ccum，也就是 ∫ ≤T cumCdttC0 )( 。 
後來經由多位研究者 (Crowther, 1974; 
Goldie and Coldman, 1978; Skipper, 1978; 
Murray, 1990a, 1990b; Martin, 1991, 1992; 
Petrovski et al., 1998; Tan et al., 2002; Floares 
et al., 2003) 的驗證與加入控制的理論觀點
，Gompertz 的腫瘤成長模式再度被強化為
以下之方程式： 
)()( 2211 ββλ −−+−= xHxkxdt
dx ,   (5) 
2
2 xu
dt
dx γ−= ,                   (6) 
2
3 x
dt
dx = ,                       (7) 
起始狀態 xT(0) = [ln(100) 0 0]與 
⎩⎨
⎧
≤
≥=− β
ββ
2
2
2 0
1
)(
xif
xif
xH ,        (8) 
其中 x1 是一個相反於腫瘤質量的變數；腫瘤
 6
 
研究方法 
本計畫以傳統之類免疫演算法與田口
實驗設計法為基礎，將強健設計的田口實驗
設計方法之系統性推理能力合併在具全域
搜尋能力的免疫演算法中，以系統性推理重
組機制取代類免疫演算法中之隨機產生子
代之重組機制，來增加免疫演算法的穩健搜
尋能力，並利用此強健的田口免疫最佳化演
算法來解決癌症化學治療的用藥規劃的最
佳化問題，以下將說明田口免疫最佳化演算
法的步驟： 
傳統類免疫演算法有搜尋多變數與多
模態空間之架構，除了利用田口實驗設計方
法來增加系統性的推理外，為再增加其全域
搜尋的能力與加快運算速度，乃利用實數編
碼與實數運算方式來加以改良。 
初始抗體的產生 (Initialization) 
本 研 究 以 實 數 編 碼  (Real Coding 
Representation) 的方法，來表示每一個抗體
值，進而產生一串抗體與初始抗體群體。實
數編碼的好處為所欲決定的參數總數與編
碼長度相同，在編碼長度比二進位編碼方式
短很多且執行速度上比二進位編碼方式來
得快；此外，更大的好處為編碼空間為連續
空間，較易搜尋到可能的解。以下為產生
ps 個初始抗體群體的步驟，其中一組向量 
(x1, x2, .., xi, .., xn) 代表一組 n 個待決定的參
數： 
產生步驟： 
步驟 1：任意產生一個亂數 β，其中 β ∈[0, 
1]。 
步驟 2：令 xi = li + β (ui－li),其中 li 與 ui 是
xi的範圍。 
步驟 3：重複執行以上步驟 n 次，則可產生
一組向量(x1, x2, xi,…, xn)。 
步驟 4：重複執行 ps次的步驟 1 至 3，則可
產生 ps 個初始抗體群體。 
選擇機制與複製 (Selection Mechanism and 
Replication) 
選擇較佳之抗體母代以進行後續之演
算，乃利用一般常用之輪盤法來選取，此基
本的觀念為選取在整個群體中擁有較高機
率之抗體。例如抗體 k 其適應值為 fk，其在
整體抗體群體中所佔的機率為 pk，則 
∑
=
= s
p
i
ikk ffp
1
/ ,       k = 1, 2, …, ps. 
因此在整體抗體群體中每一串抗體之累積
機率 qk 為 
∑
=
= k
i
ik pq
1
,           k = 1, 2, …, ps. 
其中 ps為抗體群體內抗體串的數目。選擇過
程中，轉動輪盤所需複製的次數，每次依據
所得之機率，選取一個母代的成員成為新的
抗體群體成員，以下為產生所需複製之新的
抗體群體成員步驟： 
產生步驟： 
步驟 1：從 [0, 1] 的範圍中，任意產生一個
亂數 r。 
步驟 2：如果 r ≤ q1，則第一串抗體被選出
；如果 qk-1< r ≤ qk，則第 k 串(2 ≤ k 
≤ ps)抗體被選出。 
步驟 3：重複執行以上步驟至所需複製的次
數，則可產生新的抗體群體成員。 
株 落 選 擇  (Clonal Proliferation within 
Hypermutation) 
利用選擇機制配合株落選擇率選出母
代之抗體來進行株落選擇的運算，在株落選
擇 過 程 中 會 使 用 較 大 的 突 變 率 
(Hypermutation) 來運算，進而產生多樣的抗
體族群，突變方式擬利用凸集合理論之線性
內插法 (Bazaraa et al., 1990; Gen and Cheng, 
1997)，也就是在同一串抗體中將每一個抗
體依據較高的突變率進行線性內插，以達到
產生多樣性之抗體族群的目的。例如：母代
為 x = (x1, x2, …, xi, xj, xk,…, xn)，其中 xi 抗體
被決定進行突變，然後再任意選擇 xk 抗體
來搭配線性內插，則此一抗體串突變後的新
子代 x' 如下所述： 
x' = (x1, x2, …, x'i, xj, xk,…, xn) 
其中 x'i = (1－β ) xi＋β xk與 β 是屬於[0, 1]
的亂數值。 
田 口 方 式 的 重 組 機 制  (Taghchi-Based 
Recombination) 
本研究擬利用田口實驗設計法的優點
，來建構系統化推理重組機制，以產生最優
良的子代來增加類免疫演算法穩健與快速
收斂的能力。田口實驗設計法之參數設計是
強健設計 (Robust Design) 的重要工具。強
健設計是工程上用來使產品與製程條件最
 8
yi 或望小特性是 ηi = 1/yi，其中 yi 表示實
驗 i 的適應值且 i = 1, 2, …, n，n 代表實驗
次數。然而每個因子中哪個水準的貢獻度較
大可依據下式來決定： 
Efl = sum of ηi for factor f at level l, 
其中 i 是實驗次數的編號，f 是因子的代號
，以及 l 是水準數。 
田口方式的組合運算，其說明如下：每
次任意選擇二串抗體當成每個因子有二個
水準來進行直交表實驗，目的在於決定哪個
因子應選擇哪個水準，主要的依據為找出每
個因子中貢獻度較大的水準。例如：Ef1 > Ef2
，則因子 f 的最佳水準為水準 1，也就是來
自第一串的抗體，如果 Ef1 < Ef2，則因子 f 的
最佳水準為水準 2。所有因子的最佳水準被
選定後，則產生一個新的子代。這個經由 n
次實驗所產生的新子代擁有相當好的適應
值，可與執行 2Q 次所獲得的結果相當，此
處之 2Q次為所有實驗的組合次數。 
突變方式 (Mutation) 
突變的基本觀念亦來自凸集合理論之
線性內插法 (Bazaraa et al., 1990; Gen and 
Cheng, 1997)，其操作方式如同株落選擇過
程中的突變運算方式，但所使用的突變率較
小。 
 
研究成果 
本計畫案已完成之研究成果為下列所
述： 
1. 探討出一個較合理的癌症腫瘤成長與化
學治療用藥規劃模式，提供給未來的研
究者進一步研究的基礎，並藉由此研究
提供醫界另一個思考方向與解決問題的
方法，共同為消滅癌症而努力。 
2. 研究癌症化學治療用藥規劃的限制條件
與找出最佳化的治療用藥規劃模式，並
與相關文獻做一比較，提供研究癌症用
藥治療與研究的參考。 
3. 研究並應用最佳化演算法，提供研究者
另一種高效率與高強健性的最佳化演算
法，來解決最佳化的問題。 
 
計畫成果自評 
本研究完全依照計畫所擬定之內容進
行，已經 100%完全達成原先計畫所預期完
成之工作項目和目標，而且還進一步研究與
應用於其他領域。研究成果之投稿和發表情
形如下： 
1. J. T. Tsai and J. H. Chou, “Design of 
Optimal Digital IIR Filters by Using an 
Improved Immune Algorithm,” IEEE 
Trans. on Signal Processing, Vol. 54, No. 
12, pp. 4582-4596, 2006. (SCI/EI) 
2. J. T. Tsai, W. H. Ho, J. H. Chou, and T. K. 
Liu, “Improved Immune Algorithm for 
Global Numerical Optimization and 
Job-Shop Scheduling Problems,” Applied 
Mathematics and Computation, 2007. 
(SCI/EI) (Accepted for publication) 
3. J. T. Tsai, T. K. Liu, W. H. Ho, and J. H. 
Chou, “An Improved Genetic Algorithm 
for Job-Shop Scheduling Problems Using 
Taguchi-Based Crossover,” International 
Journal of Advanced Manufacturing 
Technology, 2007. (SCI/EI) (Accepted for 
publication) 
4. J. T. Tsai, W. H. Ho, J. H. Chou, and T. K. 
Liu, “Circuit Tolerance Design Using an 
Improved Immune Algorithm,” Proc. of 
the Second International Conference on 
Innovative Computing, Information and 
Control (ICICIC 2007), (Paper Number: 
ICICIC-2007-IS46-008), Kumamoto, 
Japan, Sept. 2007. 
5. J. T. Tsai and J. H. Chou, “Circuit 
Tolerance Design Using an Improved 
Genetic Algorithm,” Proc. of the 2006 9th 
International Conference on Control, 
Automation, Robotics and Vision 
(ICARCV 2006), Singapore, pp. 
1883-1888, December 2006. (EI) 
6. J. T. Tsai and J. H. Chou, “Mixed H2/H∞ 
Optimal PIMD Controller Design Using 
an Improved Genetic Algorithm,” Proc. of 
2006 CACS Automatic Control 
Conference, Taipei, Taiwan, pp. 82-87, 
November 2006. 
 
參考文獻 
1. Bazaraa, M., J. Jarvis, and H. Sherali, 
1990, Linear Programming and Network 
Flows, John Wiley and Sons, New York. 
2. Bojkov, B., R. Hansel, and R. Luus, 1993, 
“Application of Direct Search 
Optimization to Optimal Control 
 10
26. Tsai, J. T. and J. H. Chou, 2006, “Design 
of Optimal Digital IIR Filters by Using an 
Improved Immune Algorithm,” IEEE 
Trans. on Signal Processing, Vol. 54, No. 
12, pp. 4582-4596. 
27. Wheldon, T. E., 1998, “Mathematical 
Models in Cancer Research,” Bristol. 
Adam Hilger. 
28. Wu, Y., 2000, Taguchi Methods for 
Robust Design, The American Society of 
Mechanical Engineers, New York. 
 
TSAI AND CHOU: DESIGN OF OPTIMAL DIGITAL IIR FILTERS 4583
lems [16]–[18], [22]. However, the characteristics of the IAs
similar to those of the traditional GA, which is largely based
on the stochastic search techniques, have larger standard devia-
tions. A result is more robust if the relevant fitness values have
a smaller standard deviation. In this spirit, a natural question to
ask is whether the Taguchi method may play a role in attaining
more robust results, as the method has been well known to be
a robust design approach. Therefore, in order to seek an effi-
cient evolutionary algorithm such that the solution efficiency
for optimization problems can be further promoted, the pur-
pose of this paper is to propose a novel robust approach by
integrating the IAs and the Taguchi method. It is named the
Taguchi-immune algorithm (TIA) and can be used to solve the
problem of designing the optimal digital IIR filters. The Taguchi
method, a robust design approach, uses many ideas from statis-
tical experimental design for evaluating and implementing im-
provements in products, processes and equipment. The funda-
mental principle is to improve the quality of a product by mini-
mizing the effect of the causes of variation without eliminating
the causes. The two major tools used in the Taguchi method
are: i) signal-to-noise ratio (SNR) which measures quality, and
ii) orthogonal arrays which are used to study many design pa-
rameters simultaneously [27]–[32]. Based on the biological im-
mune principles and the Taguchi method, the TIA is established.
In the TIA, the clonal proliferation [33], [34] within hypermuta-
tion [35] for several antibody diversifications and the recombi-
nation by using the Taguchi method for the local search are in-
tegrated to improve the capabilities of exploration and exploita-
tion. The systematic reasoning ability of the Taguchi method is
executed in the recombination operations to select the better an-
tibody genes to achieve the potential recombination, and con-
sequently enhance the TIA. Therefore, the integration of both
the clonal proliferation within hypermutation and the Taguchi
method for the recombination can improve the immune algo-
rithm, so that the TIA can be more robust, statistically sound,
and quickly convergent. Here, “more robust” means that the
standard deviation of the affinity values is relatively small by
using the proposed TIA approach.
The paper is organized as follows. Section II describes the
problem statement and the biological immune system. The
Taguchi-immune algorithm for designing the optimal digital
IIR filters is described in Section III. In Section IV, we first
evaluate the performance of the proposed TIA approach and
compare our results with those given by Leung and Wang [36]
and Tsai et al. [37] for some well-known test functions. Then,
we use the TIA approach to solve the design problems of the
digital IIR filters, and we also compare our results with those
given by Tang et al. [11] for the LP, HP, BP, and BS filters.
Finally, Section V offers some conclusions.
II. PROBLEM STATEMENT AND BIOLOGICAL IMMUNE SYSTEM
In this section, we state the problem and describe the biolog-
ical immune system.
A. Problem Statement
The traditional design of the IIR filter can be described by the
following recursive expression:
(2.1)
where and are the coefficients of the filter, and
are its input and output, and and are the number of
and filter coefficients, with . An equivalent transfer
function is described as follows:
(2.2)
The important task for the designer is to find values of and
which produce the desired response. A common way of real-
izing IIR filters is to cascade several first- and second-order sec-
tions together [10], [11]. Let denote the transfer func-
tion of a digital filter, where indicates the filter coefficients
(e.g., poles and zeros). The magnitude of is denoted as
. The fundamental structure of , regardless of
the filter type, can be given as [11]
(2.3)
where
denotes the filter parameters, and is a
positive normalizing constant such that the maximum value of
is 1.
Expression (2.3) considers the digital IIR filters with numera-
tors and denominators of the same degree. The discussion in this
paper can be also applied to the case of digital IIR filters with
numerators and denominators of different degree, if the obvious
changes are made.
The performances of the optimal digital IIR filter can be eval-
uated by using the -norm approximation error [2] and the
ripple magnitudes of both passband and stopband [6]. That is, to
proceed with the design optimally, the objective functions can be
specified in terms of the -norm approximation error and the
ripple magnitudes of both passband and stopband. The -norm
approximation error for the magnitude response is defined as [2]
(2.4)
where denotes the union of desired passband and stopband of
the desired filter, and denotes the magnitude target. In
general, the approximation criteria with 1 and 2 are more
popular for the filter design problems. They will be discussed in
more details as follows. In numerical work, it is convenient to
quantize the continuous problem by using fixed grid points [2].
The fixed grid approach is also adopted in this paper. The error
approximation function in (2.4) are rewritten as
and and (2.5)
TSAI AND CHOU: DESIGN OF OPTIMAL DIGITAL IIR FILTERS 4585
TABLE I
TEST FUNCTIONS
for the invading antigen [40]. The selection and mutation occur-
rences in B-cell clonal proliferation processes admit these lym-
phocytes to increase their receptor diversity and to better their
capability of recognizing the selective antigens (increasing its
affinities with selective antigens).
In the immune system, the antibodies are produced in order
to cope with the antigen. As well as, the immune system pro-
duces diverse antibodies by recognizing the affinities between
antigens and antibodies. Based on some patterns of the biolog-
ical immune principles, the TIA is the algorithm that mimics the
antigen-antibody reaction of the immune system in mammals.
The antigen and the antibody in the TIA correspond to the objec-
tive function and the feasible solution, respectively. The hyper-
mutation mechanism of the clonal proliferation used in the TIA
plays a critical role in creating diverse antibodies. The clonal se-
lection principle of the TIA facilitates the efficiency of solving
the numerical optimization problems [18], [22].
III. TIA APPROACH FOR DESIGN OF IIR FILTERS
This section describes how to solve the multiparameter and
multicriterion optimization problem of designing the digital IIR
filters by using the TIA approach. The details are as follows.
1) Generation of Antibody Population: In the real coding
representation, each antibody is encoded as a vector of floating-
point numbers, with the same length as the vector of decision
variables. The real coding representation is accurate and effi-
cient because it is closest to the real design space, and, more-
over, the string length is the number of design variables. How-
ever, binary substrings representing each variable with the de-
sired precision are concatenated to represent an individual, and
the resulting string encoding a large number of design variables
would wind up a huge string length. For example, for 100 vari-
ables with domains in the range [ 500, 500] where a precision
of six digits after the decimal point is required, the length of the
binary solution vector is 3000. The algorithm would perform
poorly for such design problems.
We use the following parameter vector of the digital IIR filter
in (2.3):
(3.1)
as an antibody to represent a solution to the optimization
problem, where is the number of total filter parameters with
. Initialization procedure produces
antibodies, where denotes the antibody population size, by
the following algorithm.
Algorithm:
Step 1:Generate a random value , where  2[0,
1].
Step 2:Let x
i
= l
i
+ (u
i
  l
i
), where x
i
denotes
the ith element of x
1
in (3.1); l
i
and
u
i
are the lower and upper bounds of
x
i
, respectively. Repeat  times and
produce a vector (x
1
; x
2
; x
i
; . . . ; x

).
Step 3:Repeat the above two steps p
s
times and
produce p
s
initial feasible solutions.
2) Clonal Proliferation Within Hypermutation: Based on the
biological immune principles, the selection and mutation events
in B-cell clonal proliferation processes allow these lymphocytes
to increase their receptor diversity and to improve their capa-
bility of recognizing the selective antigens (increasing its affini-
ties with selective antigens). The hypermutation mechanism in
this study is derived from the convex set theory [41], [42]. The
antibody depending on the clonal selection rate is chosen
TSAI AND CHOU: DESIGN OF OPTIMAL DIGITAL IIR FILTERS 4587
TABLE III
PRESCRIBED DESIGN CONDITIONS ON LP, HP, BP, AND BS FILTERS
In the recombination process, two antibodies at a time are
randomly chosen from the antibody pool generated by both the
replication and the clonal proliferation to execute the recombi-
nation by using the matrix experiments of the orthogonal array.
The primary goal in conducting this matrix experiment is to de-
termine the optimal level for each factor. The optimal level for
a factor is the level that gives the highest value of in the
experimental region. For a two-level problem, if ,
the optimal level is level 1 for factor . Otherwise, level 2 is
the optimum one. After the optimal level for each factor is se-
lected, the new antibody is also obtained by combining those
levels from each factor. Therefore, by using the systematic rea-
soning ability of the Taguchi method, this new antibody has the
best or close-to-best evaluation value of the objective function
among those of combinations of factor level, where is
the total number of experiments needed for all combinations of
factor levels.
4) Mutation Operation: Similar to the hypermutation mech-
anism, the normal mutation operation is also derived from the
convex set theory [41], [42]. Each gene, in a single antibody,
depending on the mutation rate , executes the mutation of
convex combination.
5) Taguchi-Immune Algorithm: Based on the biological im-
mune principles and the Taguchi method, the artificial Taguchi-
immune algorithm is established. The steps of the TIA are de-
scribed as follows.
Step 0: Parameter setting.
Input: antibody population size , replication rate ,
clonal selection rate , hypermutation rate , muta-
tion rate , and number of generations.
Output: the optimal antibody and affinity value.
Step 1: Initial antibody population is generated using the
aforementioned Algorithm. The affinity values of the
antibody population are then calculated.
Step 2: Selection mechanism using the roulette wheel ap-
proach [43].
Step 3: Clonal proliferation within the hypermutation. The an-
tibody, depending on the clonal selection rate , is
chosen from the antibody population pool to join the
clonal proliferation. Each gene, in a single antibody,
depending on the hypermutation rate , executes the
hypermutation of convex combination.
Step 4: The reproduced antibodies, depending on the replica-
tion rate , are generated. Then, the antibodies, gen-
erated by the replication and the clonal proliferation,
are included to execute the recombination by using the
Taguchi method. The steps for the Taguchi-based re-
combination are given below from Steps 5 through 11.
Step 5: Select a suitable two-level orthogonal array for matrix
experiments.
Step 6: Choose randomly two antibodies at a time to execute
matrix experiments.
Step 7: Calculate the affinity values and SNRs of experi-
ments in the orthogonal array .
Step 8: Calculate the effects of the various factors ( and
).
Step 9: One optimal antibody is generated based on the results
from Step 8.
Step 10: Repeat Steps 6 through 9 until the expected number
(e.g., ) has been met.
Step 11: The antibody population via the Taguchi method is
generated.
Step 12: Mutation operation. Each gene, in a single antibody,
depending on the mutation rate , executes the mu-
tation of convex combination.
Step 13: New antibody population is generated.
Step 14: Sort the affinity values in increasing order among the
antibody population of last generation and the new an-
tibody population of current generation.
Step 15: Select the better antibodies as the new antibody pop-
ulation of the next generation.
Step 16: Has the stopping criterion been met? If yes, then go
to Step 17. Otherwise, return to Step 2 and continue
through Step 16.
Step 17: Display the optimal antibody and affinity value.
IV. DESIGN EXAMPLES AND COMPARISONS
First, in this section, we use the proposed TIA approach to
solve the global numerical optimization problems, evaluate the
performance of the proposed TIA approach, and compare our
results with those given by Leung and Wang [36] and Tsai et al.
[37] for some well-known test functions in Table I.
TSAI AND CHOU: DESIGN OF OPTIMAL DIGITAL IIR FILTERS 4589
Fig. 3. Frequency responses of filters by using the TIA approach and the method given in [11], respectively, where the design criterion used by the TIA approach
is the same as that used by the method in [11]. It can be seen that, for the LP, HP, BP, and BS filters, the filters obtained by using the TIA approach can give the
smaller absolute errors of magnitude responses than those obtained by using the method by Tang et al. [11] in both passband and stopband. (a) LP. (b) HP. (c) BP.
(d) BS.
value given by the OGA/Q. In addition, each test function is per-
formed with 50 independent runs. The mean number of function
evaluations, the mean function value, and the standard deviation
of the function values are all recorded for each test function.
To identify any improvement on the TIA due to the Taguchi
method, we execute the IA to solve the test function, where the
computational procedures of the IA are the same as those of the
TIA, except that the Taguchi method is not used in the IA. For
the test function in Table I as an example, the mean numbers
of function evaluations using the TIA and the IA are, respec-
tively, 13267 and 249883, as the function value is equal to 0.
Fig. 2 shows the dynamic picture of the function value versus
function evaluations using the TIA and the IA for the test func-
tion . We can see that, from Fig. 2, the IA requires more func-
tion evaluations for the test function than the TIA, and hence
it has a larger time complexity. These results indicate that the
Taguchi method can effectively improve the IA.
Table II shows the performance comparisons the proposed
TIA, the HTGA, and the OGA/Q. From Table II, it can be seen
that
i) the proposed TIA and can find optimal or close-to-optimal
solutions;
ii) for , , and , the proposed TIA and the HTGA
can give better and closer-to-optimal solutions than the
OGA/Q, and for , , , and , the TIA, HTGA, and
OGA/Q all can give the same optimal solutions;
iii) the proposed TIA gives smaller standard deviations of
function values than the OGA/Q, and hence the proposed
TIA has a more stable solution quality;
iv) the proposed TIA requires fewer mean numbers of func-
tion evaluations than the HTGA and the OGA/Q, and
hence the proposed TIA has a lower computation time re-
quirement.
Furthermore, the execution of the proposed TIA can be
stopped for each run under the stopping criterion, so that the
standard deviation of function values for each function is 0. In
other words, these results in Table II indicate that the proposed
TIA can give better mean solution quality and more stable so-
lution quality than the OGA/Q, and the proposed TIA requires
fewer mean numbers of function evaluations than the HTGA
TSAI AND CHOU: DESIGN OF OPTIMAL DIGITAL IIR FILTERS 4591
Fig. 4. Frequency responses of filters by using the TIA approach and the method given in [11], respectively, where the TIA approach uses the minimization of
 (x) +  (x) as the design criterion. It can be seen that, for the LP, HP, BP, and BS filters, the filters obtained by using the TIA approach can give the smaller
ripple magnitudes than those obtained by using the method in [11] in both passband and stopband. (a) LP. (b) HP. (c) BP. (d) BS.
band correspond to higher performance [6], [14], the proposed
TIA approach can get better performances than the GA-based
method given in [11] for the digital IIR filters under the same
design criterion.
In the second case, the combination of two criteria, the ripple
magnitudes of passband and stopband is consid-
ered here. The two criteria are contrary generally. The computa-
tional results obtained by using the proposed TIA approach and
the GA-based method given by [11], respectively, are given in
Table V and shown in Fig. 4. The designed IIR filter models ob-
tained by the TIA approach are stated as shown in (4.9)–(4.12)
at the bottom of the previous page. From Table V and Fig. 4,
it can be seen that, for the LP, HP, BP, and BS filters, the pro-
posed TIA approach can give the smaller ripple magnitudes of
both passband and stopband than the GA-based method given
by Tang et al. [11]. That is, the proposed TIA approach under
(4.9)
(4.10)
(4.11)
(4.12)
TSAI AND CHOU: DESIGN OF OPTIMAL DIGITAL IIR FILTERS 4593
Fig. 5. Frequency responses of filters by using the TIA approach and the method given in [11], respectively, where the TIA approach uses the minimization of
v E (x) + v E (x) + v  (x) + v  (x) as the design criterion. It can be seen that, for the LP, HP, BP, and BS filters, the filters obtained by using the TIA
approach can give the smaller absolute and square errors of magnitude responses and the better ripple magnitude performances than those obtained by using the
method in [11] in both passband and stopband. (a) LP. (b) HP. (c) BP. (d) BS.
(4.18)
(4.19)
and
(4.20)
The comparison results for the proposed TIA approach and the
classic methods given by Lam [50] are given in Table VII.
In a word, from these aforementioned results, we could
conclude that: i) the proposed TIA approach is superior to
the GA-based method presented by Tang et al. [11]; ii) the
proposed TIA approach for the design of digital IIR filers
allows each filter, whether it is LP, HP, BP, or BS filter, to be
independently designed; and iii) the proposed TIA approach
are very feasible to design the digital IIR filters, particularly
when the complicated constraints, the design requirements, and
the multiple criteria are all involved.
V. CONCLUSION
In this paper, the TIA has been presented to solve the problem
of designing the optimal digital IIR filters. The clonal prolifer-
ation within hypermutation and the recombination by using the
Taguchi method are integrated to improve the capabilities of ex-
ploration and exploitation. The aforementioned hypermutation
of convex combination together with the high hypermutation
rate can give several antibody diversifications and is capable of
preventing the premature convergence. The Taguchi method is
a robust design approach, which draws on many ideas from sta-
tistical experimental design to plan experiments for obtaining
dependable information about variables, so it can achieve the
antibody population distribution closest to the target and make
the results robust. The two-level orthogonal array and SNR of
the Taguchi method are used for local exploitation. The sys-
tematic reasoning ability of the Taguchi method is executed in
TSAI AND CHOU: DESIGN OF OPTIMAL DIGITAL IIR FILTERS 4595
[4] M. Lang, “Optimal weighted phase equalization according to the
L -norm,” Signal Process., vol. 27, pp. 87–98, 1992.
[5] W. S. Kafri, “Phase and delay approximation for 1-D digital IIR filter
in the L norm,” Signal Process., vol. 57, pp. 163–175, 1997.
[6] C. Marven and G. Ewers, A Simple Approach to Digital Signal Pro-
cessing. New York: Wiley, 1997.
[7] A. Tarczynski, G. D. Cain, E. Hermanowicz, and M. Rojewski, “A
WISE method for designing IIR filters,” IEEE Trans. Signal Process.,
vol. 49, pp. 1421–1432, 2001.
[8] S. C. Ng, C. Y. Chung, S. H. Leung, and A. Luk, “Fast convergent ge-
netic search for adaptive IIR filtering,” in Proc. IEEE Int. Conf. Acoust.,
Speech Signal Process., Adelaide, 1994, pp. 105–108.
[9] J. H. Li and F. L. Yin, “Genetic optimization algorithm for designing
IIR digital filters,” J. China Inst. Commun., vol. 17, pp. 1–7, 1996.
[10] S. P. Harris and E. C. Ifeachor, “Automatic design of frequency
sampling filters by hybrid genetic algorithm techniques,” IEEE Trans.
Signal Process., vol. 46, pp. 3304–3314, 1998.
[11] K. S. Tang, K. F. Man, S. Kwong, and Z. F. Liu, “Design and optimiza-
tion of IIR filter structure using hierarchical genetic algorithms,” IEEE
Trans. Ind. Electron., vol. 45, pp. 481–487, 1998.
[12] K. Uesaka and M. Kawamata, “Synthesis of low-sensitivity second-
order digital filters using genetic programming with automatically de-
fined functions,” IEEE Signal Process. Lett., vol. 7, pp. 83–85, 2000.
[13] G. Vanuytsel, P. Boets, L. V. Biesen, and S. Temmerman, “Efficient
hybrid optimization of fixed-point cascaded IIR filter coefficients,” in
Proc. IEEE Instrum. Meas. Technol. Conf., Anchorage, AK, 2002, pp.
793–797.
[14] G. X. Zhang, W. D. Jin, and F. Jin, “Multi-criterion satisfactory opti-
mization method for designing IIR digital filters,” in Proc. Int. Conf.
Commun. Technol., Beijing, China, 2003, pp. 1484–1490.
[15] Y. Liu, S. Q. Shao, H. Zhao, X. F. Liao, and J. B. Yu, “An applica-
tion of genetic algorithms with guiding strategy in the design of digital
filters,” in Proc. 2004 Int. Conf. Commun., Circuits Syst., Chengdu,
China, 2004, pp. 1141–1145.
[16] G. Nicosia, S. Motta, and F. Castiglione, “Pattern recognition by pri-
mary and secondary response of an artificial immune system,” Theory
in Biosci., vol. 120, pp. 93–106, 2001.
[17] G. Nicosia and V. Cutello, “An immunological approach to combina-
torial optimization problems,” Lecture Notes Comput. Sci., vol. 2527,
pp. 361–370, 2002.
[18] L. N. de Castro and F. J. Von Zuben, “Learning and optimization using
the clonal selection principle,” IEEE Trans. Evol. Comput., vol. 6, pp.
239–251, 2002.
[19] L. N. de Castro and J. Timmis, “An artificial immune network for mul-
timodal function optimization,” in Proc. 2002 Congr. Evol. Comput.,
Honolulu, HI, 2002a, pp. 699–704.
[20] ——, Artificial Immune Systems: A New Computational Intelligence
Approach. London, U.K.: Springer-Verlag, 2002b.
[21] H. Ge and Z. Y. Mao, “Immune algorithm,” in Proc. 4th World
Congress on Intelligent Control and Automation, Shanghai, 2002, pp.
1784–1788.
[22] X. P. Chen, B. Qu, and G. Lu, “An application of immune algorithm in
FIR filter design,” in Proc. 2003 IEEE Int. Conf. Neural Netw. Signal
Process., Nanjing, China, 2003, pp. 473–477.
[23] G. C. Luh and C. H. Chueh, “Multi-objective optimal design of
truss structure with immune algorithm,” Comput. Struct., vol. 82, pp.
829–844, 2004.
[24] Y. Ishida, Immunity-Based Systems: a Design Perspective. London,
U.K.: Springer-Verlag, 2004.
[25] G. Nicosia, V. Cutello, P. J. Bentley, and J. Timmis, “Artificial immune
systems,” in Proc. 3rd Int. Conf. ICARIS 2004, Catania, Italy, 2004.
[26] G. Nicosia, G. Narzisi, M. Pavone, and V. Cutello, “An immunolog-
ical algorithm for global numerical optimization,” Proc. 7th Int. Conf.
Artificial Evolution Univ. Lille, France, (to appear), 2005.
[27] M. S. Phadke, Quality Engineering Using Robust Design. Englewood
Cliffs, NJ: Prentice-Hall, 1989.
[28] P. J. Ross, Taguchi Techniques for Quality Engineering. Singapore:
McGraw-Hill, 1989.
[29] D. C. Montgomery, Design and Analysis of Experiments. New York:
Wiley, 1991.
[30] S. H. Park, Robust Design and Analysis for Quality Engineering.
London, U.K.: Chapman and Hall, 1996.
[31] G. Taguchi, S. Chowdhury, and S. Taguchi, Robust Engineering.
New York: McGraw-Hill, 2000.
[32] Y. Wu, Taguchi Methods for Robust Design. New York: Amer. Soc.
Mech. Eng., 2000.
[33] F. M. Burnet, The Clonal Selection Theory of Acquired Immunity.
Cambridge, U.K.: Cambridge Univ. Press, 1959.
[34] N. K. Jerne, “The immune system,” Sci. Amer., vol. 229, pp. 52–60,
1973.
[35] R. S. Harris, Q. Kong, and N. Maizels, “Somatic hypermutation and
the three R’s: repair, replication and recombination,” Mutation Res.,
vol. 436, pp. 157–178, 1999.
[36] Y. W. Leung and Y. Wang, “An orthogonal genetic algorithm with
quantization for global numerical optimization,” IEEE Trans. Evol.
Comput., vol. 5, pp. 41–53, 2001.
[37] J. T. Tsai, T. K. Liu, and J. H. Chou, “Hybrid taguchi-genetic algorithm
for global numerical optimization,” IEEE Trans. Evol. Comput., vol. 8,
pp. 365–377, 2004.
[38] I. Jury, Theory and Application of the Z-Transform Method. New
York: Wiley, 1964.
[39] I. Roitt and J. Brostoff, Immunology. New York: Mosby Int. Ltd.,
1998.
[40] A. S. Perelson, M. Mirmirani, and G. F. Oster, “Optimal strategies in
immunology II: B memory cell production,” J. Math. Biol., vol. 3, pp.
325–367, 1978.
[41] M. Bazaraa, J. Jarvis, and H. Sherali, Linear Programming and Net-
work Flows. New York: Wiley , 1990.
[42] M. Gen and R. Cheng, Genetic Algorithms and Engineering Design.
New York: Wiley, 1997.
[43] D. E. Goldberg, Genetic Algorithms in Search, Optimization and Ma-
chine Learning. Norwood, MA: Addison-Wesley, 1989.
[44] P. Siarry, G. Berthiau, F. Durbin, and J. Haussy, “Enhanced simulated
annealing for globally minimizing functions of many-continuous vari-
ables,” ACM Trans. Math. Softw., vol. 23, pp. 209–228, 1997.
[45] X. Yao and Y. Liu, “Fast evolution strategies,” in Evolutionary Pro-
gramming VI, P. J. Angeline, R. Reynolds, J. McDonnell, and R. Eber-
hart, Eds. Berlin, Germany: Springer-Verlag, 1997, pp. 151–161.
[46] V. W. Porto, “Evolution optimzation versus particle swarm opti-
mization: Philosophy and performance differences,” in Evolutionary
Programming VII: Proceedings of the Seventh International Confer-
ence EP98, ser. Lecture Notes in Computer Science, N Saravanan, D.
Waagen, and A. E. Eiben, Eds. Berlin, Germany: Springer-Verlag,
1998, pp. 601–610.
[47] K. Chellapilla, “Combining mutation operators in evolutionary pro-
gramming,” IEEE Trans. Evol. Comput., vol. 2, pp. 91–96, 1998.
[48] Z. Tu and Y. Lu, “A robust stochastic genetic algorithm (StGA) for
global numerical optimization,” IEEE Trans. Evol. Comput., vol. 8, pp.
456–470, 2004.
[49] J. H. Chou, W. H. Liao, and J. J. Li, “Application of Taguchi-genetic
method to design optimal grey-fuzzy controller of a constant turning
force system,” in Proc. 15th CSME Annu. Conf., Taiwan, 1998, pp.
31–38.
[50] H. Y. F. Lam, Analog and Digital Filters: Design and Realization.
Englewood Cliffs, NJ: Prentice-Hall, 1979.
Jinn-Tsong Tsai received the B.S. and M.S. degrees
in mechanical and electromechanical engineering
from National Sun Yat-Sen University, Taiwan,
R.O.C., in 1986 and 1988, respectively, and the
Ph.D. degree in engineering science and technology
from National Kaohsiung First University of Science
and Technology, Taiwan, R.O.C., in 2004.
He is currently an Assistant Professor with the
Department of Computer Science, National Pingtung
University of Education, Pingtung, Taiwan. From
July 1988 to May 1990, he was a Lecturer with
the Vehicle Engineering Department, Chung Cheng Institute of Technology,
Taiwan. From July 1990 to August 2004, he was a Researcher and the Chief
of Automation Control Section of Metal Industries Research and Development
 1
行政院國家科學委員會補助國內專家學者出席國際學術會議報告 
計畫編號 NSC95-2221-E-153-002 
計畫名稱 癌症化學治療腫瘤成長與用藥時程規劃之疾病系統生物模式與最佳化的研究
報告人姓名 蔡進聰 
服務機構 
及職稱 
國立屏東教育大學資訊科學
學系/助理教授 
會議時間地點 12/5/2006 -12/8/2006 Singapore 
會議名稱 IEEE 2006 International Conference on Control, Automation, Robotics and Vision
發表論文題目 Circuit Tolerance Design Using an Improved Genetic Algorithm 
一、參加會議經過 
本屆 IEEE ICARCV 2006 國際控制、自動化技術、機器人學與電腦視覺研討會 (The IEEE 
2006 International Conference on Control, Automation, Robotics and Vision, ICARCV)，在新加坡
的君悅飯店 (Grand Hyatt) 舉行，自 2006 年 12 月 5 日至 12 月 8 日為期四天，由新加坡南洋
科技大學 (Nanyang Technological University) 負責主辦。本人、國立高雄第一科技大學系統控
制與資訊研究所周至宏教授和劉東官副教授、以及高雄醫學大學醫療資訊管理學系何文獻助
理教授共四人組成一個團隊，於 2006 年 12 月 5 日搭乘中華航空公司班機，由高雄小港國際
機場飛抵新加坡樟宜國際機場，再乘車至君悅飯店 (Grand Hyatt) 參加會議。 
今年會議約有 20 個國家的研究學者共同參與，發表之論文共有 432 篇。四天來共有 72
場研討會議進行口頭發表論文，另有 3 場以視訊方式進行的研討會。會議論文研討主題非常
廣泛，涵蓋控制、自動化技術、機器人學、電腦視覺之理論技術與應用等各個層面。內容包
含：生物統計技術、生物啟發機器人系統、生物系統控制、生物工程、生物系統之測量與建
模、生物控制應用、智慧型系統、智能計算與控制、人工智慧、類神經系統、無線網路、系
統識別、強健控制、健康照護輔具技術、醫學維持系統、人機系統、機器人學、機器人仿生
智慧、雙足機器人系統、資訊科技、網路系統整合、網路系統之分析與設計、聲音信號處理、
信號處理、圖像識別、影像處理與圖形識別、模型系統鑑別與估測、適應與最佳控制、先進
適應與學習控制及其應用、強健適應非線性控制、控制系統設計、虛擬實境系統、飛行器控
制、電腦輔助設計、製造系統、製程控制、程序自動化、運輸與製造系統、環境工程之設備
與控制、資料探勘、先進系統、…等等。除論文發表外，會議中亦有邀請演講，在主題演講
方面，主講者來自瑞典的 Dr. Lennart Ljung，其演講主題在於探討非線性系統識別技術的發
展，他所提出的估測方法有助於非線性系統識別，其演講內容精闢有趣，可提供未來研究方
1-4244-0342-1/06/$20.00 ©2006 IEEE                              ICARCV 2006 
Circuit Tolerance Design Using an Improved 
Genetic Algorithm 
 
Jinn-Tsong Tsai 
Department of Computer Science 
National Pingtung University of Education 
Pingtung, Taiwan, R.O.C. 
jttsai@kmu.edu.tw 
Jyh-Horng Chou 
Institute of System Information and Control 
National Kaohsiung First University of Science and Technology 
Kaohsiung, Taiwan, R.O.C. 
choujh@ccms.nkfust.edu.tw
 
 
Abstract—In this paper, we present an improved genetic 
algorithm to solve the worst-case circuit tolerance design 
problem, which has many design parameters and constraints. 
The evolutionary design approach, which is called a quality-
engineering-based genetic algorithm (QEGA), with a penalty 
function is proposed for solving the constrained optimization 
problem. The QEGA approach is able to explore a wide design 
parameter space without any prior knowledge about position and 
size of the region of acceptability. The QEGA approach is a 
method of combining the traditional genetic algorithm (TGA), 
which has a powerful global exploration capability, with the 
quality engineering method, which can exploit the optimum 
offspring. The quality engineering method is inserted between 
crossover and mutation operations of the TGA. Then, the 
systematic reasoning ability of the quality engineering method is 
incorporated in the crossover operations to select the better genes 
to achieve crossover, and consequently enhance the genetic 
algorithms. Therefore, the QEGA approach can be more robust 
and quickly convergent. In the worst-case circuit tolerance design 
problem, the vertex analysis has been used to check the feasibility 
of any candidate tolerance region. For this reason, if, as for a 
large part of cases, the region of acceptability is convex and 
simply connected, the QEGA approach ensures an optimal design 
with 100% yield. The proposed QEGA approach with a penalty 
function is effectively applied to solve the worst-case circuit 
tolerance design problem. The computational experiments also 
show that the presented QEGA approach can obtain better 
results than previous design methods. 
Keywords—Genetic Algorithm, Quality Engineering Method, 
Worst-Case, Circuit Tolerance Design 
I.  INTRODUCTION 
The tolerance design has become a crucial task in modern 
electronic circuit design because of the increasing demand of 
high-performances, long-life, and low-pollution electronic 
circuits. Electronic circuit tolerance design is generally very 
time-consuming because yield estimation and improvement 
require many circuit simulations. Circuit designers are 
required to find a point with the maximum tolerances in the 
parameter space that satisfies all design specifications and 
constraints to achieve a high yield at minimum cost [1]. The 
traditional method for yield estimation is to use Monte Carlo 
analysis [2] that requires a large number of time-consuming 
circuit simulations and many expensive analysis runs. As an 
alternative, it is possible to construct an approximation to the 
region of acceptability (RA) and apply some kind of polyhedral 
approximation [3]-[5], quadratic approximation [6]-[8], and 
ellipsoidal method [9]-[12]. Quadratic approximation 
presented in [6], [7] had proven to more effective than the 
polyhedral approximation. However, when the ranges of input 
variables are large and the performance surfaces are strongly 
nonlinear, these approximation techniques and a low-order 
polynomial model may not be sufficient for the tolerance 
design [1]. Therefore, in recent years, some researchers [1], 
[13]-[16] have proposed the genetic-algorithm-based (GA-
based) approaches to solve the circuit tolerance design 
problem. In the constrained optimization problem of the 
circuit tolerance design, the particular challenge is that the 
GA-based methods may be trapped in the local optima of the 
objective function when the number of the design parameters, 
specifications, and design constraints is large and there are 
numerous local optima. Therefore, it is worthy of further 
developing an efficient GA-based algorithm to solve the 
worst-case circuit tolerance design problem. 
The purpose of this paper is to propose a improved GA-
based design approach, which is motivated by the work of the 
second author [17] and is named the quality-engineering- 
based genetic algorithm (QEGA), to solve the worst-case 
circuit tolerance design problem. The quality engineering 
method, a robust design approach, uses many ideas from 
statistical experimental design for evaluating and 
implementing improvements in products, processes and 
equipment. The fundamental principle is to improve the 
quality of a product by minimizing the effect of the causes of 
variation without eliminating the causes [18]-[20]. The QEGA 
approach is a method of combining the traditional genetic 
algorithm (TGA) [21] with the quality engineering method. In 
the QEGA approach, the quality engineering method is 
inserted between crossover and mutation operations of the 
TGA. Then, the systematic reasoning ability of the quality 
engineering method is incorporated in the crossover operations 
to select the better genes to tailor the crossover operations in 
order to find the representative chromosomes to be the new 
potential offspring. Therefore, the quality engineering method 
can enhance the genetic algorithm so that the QEGA approach 
can be more robust and quickly convergent, where “more 
1883
2006 9th Int. Conf. Control, Automation, Robotics and Vision
Singapore, 5-8th December 2006
         
(ii) Generation of Diversity Offspring by Crossover Operation 
The crossover operators used here are one-cut-point 
operator integrated with arithmetical operator derived from 
convex set theory [21], [23], which randomly selects one cut-
point, exchanges the right parts of two parents, and calculates 
the linear combinations in the cut-point genes to generate new 
offspring. For example, let two parents be Θ1=(x1, x2, …, xk, 
…, xρ) and Θ2=(y1, y2, …, yk, …, yρ). If they are crossed after 
the kth position, the resulting offspring are 
),...,,,,'...,,,('
),...,,,,'...,,,('
21212
21211
ρ
ρ
xxxyyy
yyyxxx
kkk
kkk
++
++
=Θ
=Θ
         (3.1) 
where )(' kkkk xyxx −+= β , )(' kkkk luly −+= β , lk and uk 
are the domain of yk, and β is a random value, in which β ∈[0, 
1]. 
(iii) Generation of the Better Offspring by Quality Engineering 
Method 
A result is more robust if the relevant fitness member 
values have a smaller standard deviation and, for this reason, 
the TGA, which is largely based on the stochastic search 
techniques [21], is less robust due to that the TGA usually has 
larger standard deviations. In this spirit, a natural question to 
ask is whether the quality engineering method may play a role 
in attaining more robust results, as the method has been well 
known to be a robust design approach. Robust designs barrow 
many ideas from the statistical design of experiments for 
evaluating and implementing improvements in products, 
processes, or equipment. Its fundamental principle, largely 
speaking, is to improve the quality of concern by minimizing 
the effect of the causes of variation, but not eliminating the 
causes. To do so, two major mathematical tools are used: (i) 
the signal-to-noise ratio, which is a measurement of the 
quality, and (ii) the orthogonal array, which reduces a large 
number of design parameters into usually a much smaller 
number of experiments. 
A two-level orthogonal array is used in this study. In this 
section we briefly introduce the basic concept of the structure 
and use of the two-level orthogonal array. Additional details 
and the detailed description of other-level orthogonal arrays 
can be found in the books presented in [18]-[20]. There are Q 
factors, where Q is the number of designed factors (variables) 
and each factor has two levels. To establish an orthogonal 
array of Q factors with two levels, let Ln(2n-1) represent n−1 
columns and n individual experiments corresponding to the n 
rows, where n = 2k, k = a positive integer (k > 1), and Q ≤ n−1. 
If Q < n−1, only the first Q columns are used, while the other 
n−1−Q columns are ignored.  
The concept of the quality engineering method is based on 
maximizing performance measure called signal-to-noise ratio 
(η) by running a partial set of experiments using an orthogonal 
array. η refers to the mean-square-deviation of the objective 
function. In the quality engineering method, η is defined to be, 
for the cases of the larger-the-better characteristic and the 
smaller-the-better characteristic, respectively, 
)11(log10
1 2
∑−=
=
n
t tyn
η and ),1(log10
1
2∑−=
=
n
t
tyn
η  which is measured 
in decibels, where {y1, y2, …, yn} denotes a set of 
characteristics. Further details can be found in the books 
presented in [18]-[20]. We modify the aforesaid equations of 
the signal-to-noise ratio, for only describing the degree of 
value of η each other in the experiments of an orthogonal 
array, to be ηi = (yi)2 or (1/yi)2 if the objective function is to be 
maximized (larger-the-better) or minimized (smaller-the- 
better), respectively. Let yi denote the function evaluation 
value of experiment i, where i=1, 2, …, n, and n is the number 
of experiments. The effects of the various factors (variables) 
can be defined as following: 
Efl = sum of ηi for factor f at level l,                (3.2) 
where i is the experiment number, f is the factor number, and l 
is the level number. 
In the generation process of the better offspring by the 
quality engineering method, two chromosomes at a time are 
randomly chosen from the population pool generated by the 
crossover operations to execute matrix experiments of an 
orthogonal array. The detailed steps for each experiment of the 
matrix experiment are described as follows. 
Step 1: Set j = 1. Generate a set U = {1, 2, 3, …, Q}, where Q is 
the number of designed factors (variables) and each 
factor has two levels, and then take first Q columns of 
the orthogonal array Ln(2n-1) to allocate the Q designed 
factors, where n ≥  Q + 1. 
Step 2: Generate the set U to be two subsets U1 and U2, 
respectively, regarded as level 1 and level 2, by using 
the two chromosomes chosen randomly from the 
population pool generated by the crossover operations. 
Step 3: Assign the values of level 1 and level 2 to level cells of 
the j experiment in the orthogonal array. 
Step 4: Calculate the objective function value and signal-to-
noise ratio for the new chromosome. 
Step 5: If j > n, then go to Step 6. Otherwise, j = j + 1, return to 
Step 3, and continue through Step 5. 
Step 6: Calculate the effects of the various factors (Ef1 and Ef2), 
where f =1, 2, …, Q. 
The primary goal in conducting these matrix experiments 
is to choose the gene, at each locus (factor), from the two 
chromosomes to be a new chromosome. A gene, at each locus 
(factor), is chosen if the Efl has the highest value in the 
experimental region. That is, to determine the best or the 
optimal level for each factor. The optimal level for a factor is 
the level that gives the highest value of Efl in the experimental 
region. For the two-level problem, if Ei1 > Ei2, the optimal 
level is the level 1 for factor i ∈[1, Q]. Otherwise, level 2 is 
the optimal one. After the optimal level for each factor is 
selected, the new chromosome is also obtained by combining 
those levels from each factor. Therefore, by using the 
systematic reasoning ability of the quality engineering method, 
this new chromosome has the best or close-to-best evaluation 
value of the objective function among those of 2Q 
1885
         
In a constrained optimization problem, the evolutionary 
algorithm uses the fitness value, not the objective value, to 
evaluate good solutions because the penalty function is 
participated. The objective function returns the objective value 
and represents the raw performance evaluation of a 
chromosome. However, the fitness function returns the 
objective value and the penalty value for the evolutionary 
algorithm. 
V.  DESIGN EXAMPLE AND COMPARISONS 
In this section, we adopt the same example and conditions 
as those considered by Spagnuolo and Vitelli [15] to compare 
the result and the performance of the proposed QEGA 
approach with those of the GA-based approach given by 
Spagnuolo and Vitelli [15].  
A high pass LC ladder filter as shown in Figure 1 has been 
chosen as an example that has been widely used in the 
literature [15],[22] for the worst-case circuit tolerance design. 
The design specifications shown in Figure 2 are imposed on 
eleven frequency values of the gain function 
g(f)=Vout(f)/Vin(f), normalized with respect to its value at the 
frequency f =990Hz, i.e., G(f)=20log10(g(f)/g(990)). They are 
G(170)≤−45, G(350)≤ −49, G(440)≤ −42, –4≤G(630)≤0.05, 
and –1.75≤G(f)≤0.05 for f ={650, 720, 740, 760, 940, 1040, 
1800}Hz. 
The objective function described below has been defined 
referring to the circuit cost in (2.1). 
Minimize  ∑
=
+=
N
k kt
tC
1
15.2)( .                  (5.1) 
where N is the number of design parameters. Only four 
capacitances {C1, C3, C4, C5}, defined in Figure 1, have been 
designed, while the other parameters, also defined in Figure 1, 
has been fixed at their central values: R1=13.2kΩ, R2=10kΩ, 
R3=16.46Ω, R4=13.58Ω, L1=3.988H, L2=2.685H, C2=10.47nF. 
Then, for converting a constrained optimization problem into 
an unconstrained one, the fitness function F is defined as 
following: 
PtC
F
+
=
)(
1 ,                              (5.2) 
where C(t) is the objective function in (5.1) and P is the 
penalty function in (4.1). The objective is to maximize the 
fitness value of (5.2). It can be seen from (5.2) that a larger 
fitness value implies a larger tolerance for each capacitance. 
The QEGA approach is employed to solve the problem of 
the worst-case circuit tolerance design. The objective is to 
maximize the fitness function in (5.2). The parameter vector of 
the worst-case circuit tolerance design is described as 
θ8×1 = [ Cp1 , Cp2 , Cp3 , Cp4 , t1, t2, t3, t4]T,             (5.3) 
where Cp1 , 
Cp2 , 
Cp3 , and 
Cp4  denote the central values of C1, 
C3, C4, and C5, respectively; t1, t2, t3, and t4 denote, 
respectively, tolerances of C1, C3, C4, and C5. The search 
space, in the practical application, has been chosen by 
considering for all the four capacitances the range [1, 100]nF 
with resolution of 1nF, while all the corresponding tolerances 
has been left to span the interval [0.1, 20.0]% with resolution 
of 0.1%. In this example, there are eight parameters (factors) 
and we need eight columns to allocate these factors when the 
orthogonal array is selected to solve the problem. The 
orthogonal array L16(215) is used for this purpose because it 
has fifteen columns. The first eight columns are used, while 
the other seven columns are ignored. 
In the work of Chou et al. [17], Chou (the second author of 
this paper) and his associates have shown that the quality 
engineering method could be applied to find the optimal 
evolutionary parameters in the GA such that the performance 
of the GA can be improved. Therefore, in this study, we use 
the quality engineering method as the work of Chou et al. [17] 
to choose parameters. In the computational experiments, the 
following evolutionary environments are used by the proposed 
QEGA approach in this example: the population size is 100, 
the crossover rate is 0.8, the mutation rate is 0.5, and the 
number of generations is 1000. 
The values of the best, the average, and the standard 
deviation for 30 independent runs by using the QEGA 
approach are shown in Table 1. The computational results 
obtained by using the QEGA approach for the minimum cost 
and tolerances are shown in Table 2 and the results by using 
the previous method given by Spagnuolo and Vitelli [15] are 
also given in Table 2. 
From Table 1, it can be seen that the proposed QEGA 
approach gives a small standard deviation in 30 independent 
runs, and thus it has a robust and stable solution quality. From 
the computational results in Table 2, it can be seen that the 
QEGA approach can give smaller cost, due to having larger 
tolerance for each component, than the method given by 
Spagnuolo and Vitelli [15]. 
Hence, we could conclude that the QEGA approach is very 
feasible to solve the worst-case circuit tolerance design 
problem. 
VI. CONCLUSIONS 
In this paper, the QEGA approach with the penalty 
function has been used to solve the design problem of the 
worst-case circuit tolerance. The QEGA approach is a method 
of combining the TGA, which has the merit of powerful global 
exploration capability, with the quality engineering method, 
which can exploit the optimum offspring. The two-level 
orthogonal array and the signal-to-noise ratio of the quality 
engineering method are used for local exploitation. The 
quality engineering method is a robust design approach, which 
draws on many ideas from statistical experimental design to 
plan experiments for obtaining dependable information about 
variables, so it can achieve the population distribution closest 
to the target and make the results robust. We executed the 
proposed QEGA approach with the penalty function to solve 
the design problem of the worst-case circuit tolerance. The 
penalty function is employed to convert the constrained 
optimization problem of the worst-case circuit tolerance 
design into an unconstrained one by means of a penalization of 
the unfeasible individuals. The computational experiments 
1887
