摘要
我們提出一個新的三維動作資料檢索系統，使用手繪介面畫出人物肢體的動作路徑和關鍵姿勢做為輸
入，以類似卡通漫畫當中描述動作的方式來進行資料庫檢索，不需要使用鍵盤輸入文字或是產生一個
新的動作資料做為輸入，而只要繪畫簡單的二維線條，提供使用者以更方便且直覺的操作方法，快速
的從動作資料庫中將目標動作取出。系統會利用人物骨架的資訊，讓使用者在單一視角下以二維的筆
觸，產生出三維的曲線做為各關節點的動作軌跡。我們計算出動作資料每個關節點在時間軸上不同位
置所形成的軌跡，將資料庫當中的動作資料轉為以多個曲線來表示。藉由比對軌跡的方式，讓使用者
輸入的二維筆觸和資料庫當中的動作資料得以比較，此外可免去在傳統動作資料檢索系統當中費時的
時間對齊程序。比較軌跡時，我們利用球諧波函數(Spherical Harmonic Functions SHFs) 將曲線轉到頻
率域，以少數的係數來表示原先複雜的動作資料，大幅降低資料的維度，可以加快資料比較的速度。
我們的系統可以輸入數個代表不同動作的關鍵姿勢和筆觸，將搜尋到的各個動作做串連，可產生一個
有趣且內容豐富的三維動畫。
在此研究計畫內，我們計畫去發展一個手繪介面來完成 3D動作資料檢索，此系統包含底下的兩個關鍵
技術：
1. 與手繪畫版相仿的查詢介面：為了提供一個使用者友善介面，我們建構了一個手繪畫版介面，建構
各式各樣的筆觸相對應的曲線與含意的技術會是重點之一。
2. 即時檢索系統：為了即時回應使用查詢，我們提出一個新的 3D動作編碼方法，我們把在資料庫內
的 3D動作編碼成具有多解析力的數值字串，此技術也是此研究計畫重點之一。
關鍵字：手繪介面, 球諧波函示, 動作資料檢索, 動作擷取
一、 前言
本計畫我們完成了手繪人物動作介面，此介面主要技術在於三維曲線推測(3D Curve Inferring)演算法，
我們分析使用者繪畫的二維線條以及利用動作的關鍵姿態，推測出適當的三維曲線以做為關節點的動
作軌跡。本系統只需單一人物姿態，使用二維筆觸在平面上畫出人物關節點的動作軌跡，利用人物骨
架資訊、筆觸形狀及壓力大小不同，產生出適當的三維曲線，且可以利用多個分段的筆觸來產生曲線，
以各分段產生的多個不同曲率的曲線來組成更複雜的曲線，此曲線用以表示人物關節點的移動路徑。
本研究並不像其他研究[CCW*04, FF05, DRM*06]需要使用真實的動作資料來檢索資料庫，我們以手繪
人物動作的方式來做為動作資料檢索的輸入，不需使用複雜的按鍵操作或是調整其他參數。由於和文
字描述比起來，圖畫更容易讓人描述和理解動作，因此使用者可以更直覺的方表達搜尋的目標動作。
我們觀察移動軌跡通常是代表人體的某個部位相對於另一個部位的轉動，而這種用來表示移動軌跡的
二維線條其想要在三維空間中表達的三維曲線其實是受到人物的動作以及身體的條件所限制，而軌跡
在深度變化上也並非任何變化都有可能，所以在我們觀賞漫畫的時候，才有辦法從平面的圖像來理解
出其中所想要表達的動作，這個發現給了我們一些想法，我們認為要產生出適當的軌跡線必須要參考
到人物的一些資訊，因此我們在推測三維曲線的時候，將會利用到代表動作的關鍵姿態其人物骨架的
資訊來幫助我們產生適當的三維曲線。要從二維曲線變成三維曲線其中缺乏一個深度資訊，我們的主
要想法是希望在空間中產生出一個參考橢圓球，將二維曲線做垂直投影至橢圓球的表面，將橢圓球表
面的深度變化指定給二維曲線，藉此產生出一個落在橢圓球表面上的三維曲線，這樣產生出的三維曲
線將會是一個平滑、深度變化平緩、相對於橢圓球中心轉動的軌跡，符合我們在漫畫當中的觀察到的
限制，因此認為橢圓球是適合表示動作軌跡。
二、 相關研究
動作資料由一個人物的骨架和多個畫格組成，每一個畫格當中記錄著骨架的關節角度的變化。動作資
料庫內包含了許多由動作擷取器捕捉下來的人物動作，所有的動作資料都有著相同的人物骨架。動作
資料檢索通常以一個簡單的動作資料範例做為輸入，從資料庫當中找出與輸入相似的動作資料片段，
並且依照與輸入資料的相似度排序。如何正確且快速的檢索動作資料庫的內容是最重要的問題。一筆
動作資料的資料量相當的龐大，要比較兩個動作資料所需要的時間複雜度相當高，而為了讓時間扭曲
的資料之間能夠正確的計算其相似度，一個常用的時間對齊方法─動態時間扭曲法(Dynamic Time
Warping)，是其中最為費時且無可避免的程序。為了能夠加速資料檢索程序，通常需要對資料庫內的
動作資料進行前處理，分析出動作資料的特徵，透過資料的特徵進行檢索以達到高效率的搜尋。
Forbes and Fiume [FF05]提出一個有效率的動作資料檢索方式。其為了降低動作資料的維度，在前處理
階段先對整個動作資料庫每個畫格利用主值分析法(Principle Component Analysis)找出畫格分佈的主
軸，將畫格投影至主軸(Principle Axis)座標後，只取對於原始座標的畫格影響較大的基底其係數，則可
以只用較少的維度描述一個姿態。當使用者輸入一筆動作資料後，也將它投影至資料庫所計算出的主
軸座標以同樣的維度來描述。而在降低維度後的資料型態下，可以較快速的計算兩個姿態之間的差異。
在比對資料之前，會先分析輸入的資料片段，找出其中最具代表性的一個關鍵畫格，系統會找出資料
庫當中所有和此畫格相近的畫格，並以這些畫格為種子將資料庫作分群。分群的方式是計算時間軸上
的距離，將時間相近的畫格分為一群，則分群後每一群的畫格會形成一個動作資料片段。接著將輸入
的動作資料和分群後所產生的動作資料片段以動態時間扭曲法做比對。與傳統的方式不同之處在於，
每一個資料庫的片段都有一個畫格與輸入的動作資料其關鍵畫格已經相對應，則動態時間扭曲法就不
需要計算所有畫格對畫格之間的差異量，因此比對的時間複雜度可以降低。Kovar et al. [KG03]提出一
個產生逼真的人物動作的方法。使用者要先設計好動作的內容包含哪些動作，各個動作的發生的順序
圖 1局部動作與全域動作(根據動作的不同，需要不同的旋轉中心)。左圖：旋轉中心在臀部；右圖：圖
旋轉中心在根部。
當動作關節點的旋轉中心決定好之後，我們就將參考橢圓球的中心設在做為旋轉中心的關節點的位
置，接著我們將橢圓球三主軸中的 a 軸設定為從旋轉中心關節點到動作關節點中間經過的所有肢體其
長度總和。我們還需要三維空間中的兩個參考點來做為橢圓球的控制點，三維參考點我們同樣希望從
二維平面上的資訊來產生，這部份可以利用筆觸的壓力資訊來幫助我們達成。根據筆觸作用的關節點
不同，我們可以利用下列公式將筆觸在二維平面上的位置轉換成三維空間中的位置：
zpzz lengthVcenterV  )0.12( (1)
|)|( 2 xyxyz centerVhaAxisLengtsqrtlength  (2)
其中 centerz是參考橢圓球的中心 center的深度值，Vxy和 centerxy分別是 V和 center在二維座標上的位
置。因此當已知動作的關節點 V的 xy-座標時，Vz可以表示的深度值最深就是全關節向後伸直的深度，
而最淺就是全關節向前伸直的深度。
圖 2筆觸壓力與深度資訊的對應。
我們不會利用公式將整個二維的動作筆觸轉換成三維曲線，因為我們希望推測出的三維曲線是平滑的
曲線，但是使用者在手繪筆觸的時候，並沒有辦法精確的控制筆觸的壓力是個平滑的變化，而使得曲
線也會產生出不可預期的變化。我們只需要去找出筆觸的最大壓力點以及最小壓力點，將這兩點轉換
成三維空間的點，以這兩個點來做為橢圓球的控制點。
圖 3參考橢圓球產生示意圖。
在設定了橢圓球的中心位置、a軸長度和兩個控制點的資訊後，再加上動作筆觸的資訊，我們就可以開
始建立橢圓球。建立橢圓球的流程是先在空間中建立一個基準橢圓形，得到 b 軸的長度以及橢圓形的
圖 6筆觸壓力影響參考橢圓球的產生。左圖：繪畫視角；右圖：俯瞰視角。
尋找 c 軸長度的實作部分，我們會用一個由三角網格模型所構成的樣本圓球，改變其三軸長度來產生
出橢圓球。當一個橢圓球投影至二維平面會形成一個橢圓形的輪廓，我們實際上就是要找出能夠讓動
作筆觸落在該橢圓形內部的 c 軸長。由於橢圓球是一個實體的三角網格模型，因此我們可以在某一個
視角下找出構成輪廓的點和邊，將這些點和邊投影至二維平面，我們就可以在平面上面判斷動作筆觸
是否落在橢圓形內部，用來找到適當的 c 軸長。同樣我們利用二元搜尋法來實作。假設每次搜尋的 c
軸長度範圍是 ],[ ts CC ，則我們建立出當 c軸長度為 2/)( tsm CCC  時的橢圓球，將其投影至二維平面
判斷動作筆觸是否在橢圓形內部，若動作筆觸在橢圓形的內部，則將範圍縮小至 ],[ ms CC ；若有部分在
橢圓形外部，則將範圍縮小至 ],[ tm CC ，直到 ts CC  就表示找到動作筆觸在橢圓形內部，而且恰巧橢
圓形的邊界會和動作筆觸有一個切點的 c軸長。初始的搜尋範圍從 0 到 Cmax，漸漸縮小搜尋範圍，直
到找出適當的 c軸長度為止，如此就可以建立出參考橢圓球。
四、 實驗結果
在本節當中，我們展示利用二維曲線與關鍵姿態產生三維動作軌跡的結果。首先是肢體的局部動作的
實驗結果：
圖 7 曲線推測結果 1。左圖：為動作筆觸；右圖：推測出來的三維曲線。此實驗是以動作關節點為右
足，轉動中心在右臀，畫出類似踢足球的動作軌跡。
圖 8 曲線推測結果 2。左圖：為動作筆觸；右圖：推測出來的三維曲線。此實驗是以動作關節點為右
足，轉動中心在右臀，畫出踢腿的動作軌跡。
圖 14曲線推測結果 8(雙手畫出波浪狀的軌跡)。左圖：為動作筆觸；右圖：為推測出來的三維曲線。
圖 15曲線推測結果 9(雙手畫圓圈)。左圖：為動作筆觸；右圖：為推測出來的三維曲線。
五、受本計畫補助之期刊論文
1. Chao-Hung Lin, Min-Wen Chao, Chan-Yu Liang and Tong-Yee Lee: A Novel
Semi-blind-and-Semi-reversible Robust Watermarking Scheme for 3D Polygonal Models. Visual
Computer, Vol. 26, pp. 1101-1111, 2010. (SCI) (IF=0.786, Rank: 68/93=73% in COMPUTER
SCIENCE, SOFTWARE ENGINEERING)
2. Jyun-Yuan Chen, Hung-Jui Lai, and Chao-Hung Lin: Point Cloud Modeling Using Algebraic Template,
accepted to International Journal of Innovative Computing Information and Control 2010. (SCI)
(IF=2.932, Rank: 3/59 = 5% in AUTOMATION & CONTROL SYSTEMS, Rank:14/102=13% in
COMPUTER SCIENCE, ARTIFICIAL INTELLIGENCE)
參考資料
[CCW*04] Chiu, C.-Y., Chao, S.-P., Wu, M.-Y., Yang, S.-N. and Lin, H.-C.: Content-based retrieval
for human motion data. Journal of Visual Communication and Image Representation, 15,
3, pp. 446-466, 2004.
[DRM*06] Demuth, B., Roder, T., Müller, M. and Eberhardt, B.: An information retrieval system for
motion capture data, Advances in Information Retrieval, Lecture Notes In Computer
Science 3936, pp. 373-384, 2006.
[FF05] Forbes, K., and Fiume, E.: An efficient search algorithm for motion data using weighted
pca. In SCA '05: Proceedings of the 2005 ACM SIGGRAPH/Eurographics symposium on
Computer animation, 2005.
[KG03] Kovar, L. and Gleicher, M.: Flexible automatic motion blending with registration curves.
In SCA '03: Proceedings of the 2003 ACM SIGGRAPH/Eurographics symposium on
Computer animation, pp. 214-224, 2003.
2篇文章投稿，70 篇文章被接受，接受率約為 23%，由接受率可知競爭激烈，被接受文章品質高，在這
4 天的會議當中，除了學界研究人員發表各自的研究成果之外，還有業界的研發人員展出最新的科技
與產品，不論是論文發表或是科技產品的展出，內容都相當精彩且富有多樣化，在會議期間，從早上
9:00 到晚上 17:30，每個時段都有安排多場會議、課程或是討論會，讓與會者有多項內容可以選擇，大
會安排 20min 給每位報告者，因此我們可以聽到較完整的報告以及充分的討論，因此雖然只有短短的
4 天議程，但收穫卻十分的豐碩。
二、與會心得
本次會議議程十分緊湊，在每天的議程中去吸收每位發表者之研究並參與討論，有時累了也可以觀看
較輕鬆的廠商最新科技的發表，往往一天下來從7:30起床，9:00開始會議行程，一直到傍晚18:00才回
到旅館結束緊湊而豐富的一天。此次論文的發表，主要是來自全世界知名學校及研究單位，如：The
Chinese University of Hong Kong、University of Barcelona, Spain、University of Wisconsin-Madison, USA、
University of Koblenz, Germany等學校或學術機關，會中因為與各國學者互相研討請益，使得這次的行
程收穫頗為豐富，本人在會議中巧遇了Enhua Wu教授及Liu Dongquan博士，並與這兩位教授對近期的
研究做了意見交換，這兩位教授共對我近期的研究感到相當所興趣，在討論的過程中他們提出多個問
題與建議，此討論更激發了許多想像與有潛力的研究題目，對我未來的研究有不少助益，這是參加此
次會議最大意外收穫。當每年看到這些精采的研究的時候，總是覺得國際上在電腦圖學研究方面真的
是日新月異，每年的品質都不斷往上提升，不過台灣在近幾年因為五年五百億經費與國科會經費的挹
注下也正快速進步，相信不久的未來，可以跟上甚至超越國際的腳步。
三、建議事項與攜回資料名稱
這次會議舉辦非常成功，接受的論文品質高，吸引與會的學者自然就多，成功大學要提升國際上的
知名度，有效的辦法之一是常舉辦知名的國際研討會議，最後筆者參加此次會議帶回了論文光碟一
份，並由衷感謝補助筆者參加 CGI2010 國際研討會。
 
