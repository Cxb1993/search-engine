 I
中文摘要 
 
本計畫為二年期計畫，在第一年度計畫提出了多輸入多輸出正交分頻直接序列展頻分
碼多工(MIMO-OFDM DS/CDMA)的窄頻適應性陣列接收機架構。窄頻適應性陣列接收機架
構使用最小均方誤差(Least mean square, LMS)以及遞回最小均方誤差(Recursive least square, 
RLS)演算法來調整展頻碼係數。接收機架構的權重和展頻碼乃是每訊符間更新一次，此項
設計有效的降低了演算法運算上的複雜性。此接收機架構的特性與效能將會在模擬範例之
中被提出來以及詳細分析。 
 
在第二年度計畫中，主要研究多傳輸速率分碼多工(Multirate-CDMA)通訊系統，使用
智慧型天線可增加涵蓋的範圍、可靠度和系統容量。此外，適應性波束合成技術可以移除
接收到的訊號中不想要的雜訊及干擾。在本計畫中，提出三種多速率的方法：可變程序增
益、可變碼速率和多重碼系統應用於直接序列展頻分碼多工環境伴隨多重路徑衰減通道的
適應性天線接收架構。在此，同時考慮窄頻及寬頻適應性陣列接收架構。窄頻及寬頻適應
性陣列接收機架構均使用最小均方誤差演算法來調整展頻碼係數。三種多頻取樣系統應用
於我們提出的接收機架構可以在模擬範例比較其差異，同時考慮其系統分析。 
 
 III
Contents 
 
Chinese Abstract…………………………………………………………………………...............I 
English Abstract.………………………………………………………………………….............II 
Contents.…………………………………………………………………………………………III 
List of Figures………………………………………………………………………………...….IV 
 
1. Introduction…………………………………………………………….……………………..1 
2. Research…………………………………………………………..…………………………..2 
2-1 、The research in first year………………………………………………………………2 
2-1-1、OFDM……………………………………………………………………………2 
2-1-2、Adaptive Receiver in CDMA Systems………………………………………….3 
2-2 、The research in second year………………..…………………………………..………3 
2-2-1、Smart Antenna…………………………………………………………………...3 
2-2-2、Beamforming Schemes………………………………………………………….4 
2-2-3、Direction-of-Arrival (DOA) Estimation………………………………………...6 
2-2-4、Adaptive Beamforming Algorithm………………………………………………6 
3. References……………………………………...……………………………………………..8 
4. Research method…………………………….………………………………………………..9 
4-1、 The research method in first year………..………………………………………...9 
4-1-1、 System Model………………….……………………………………………..9 
4-1-2、 Narrowband Adaptive Receiver..………………………………………..…10 
4-1-2-1、LMS-Based Receiver……………………………………………….……10 
4-1-2-2、Narrowband Adaptive Receiver with Code Adjustment…………………11 
4-1-2-3、RLS-Based Receiver……………………………………………………..11 
4-2、 The research method in second year……………………………………………..13 
4-2-1、 System Model…….…………………………………………………………13 
4-2-1-1、Variable Processing Gain (VPG) Systems……………………………….13 
4-2-1-2、Variable Chip Rate (VCR) Systems……………………………………...15 
4-2-1-3、Multicode Systems……………………………………………………….16 
4-2-2、LMS-Based Algorithms…………………………………………………………17 
4-2-2-1、Narrowband Adaptive Array Antennas…………………………………..17 
  4-2-2-1-1、VPG Systems……………………………………………………17 
  4-2-2-1-2、VCR Systems……………………………………………………19 
  4-2-2-1-3、Multicode Systems………………………………………………19 
4-2-2-2、Narrowband Adaptive Antenna with Code Adjustment………………….21 
4-2-2-3、Wideband Adaptive Array Antenna with Code Adjustment……………..22 
5. Simulation Results and Conclusions……………………..…………………………………24 
 1
1、Introduction 
 
In the first year of this project, the MIMO-OFDM communications is a promising choice for 
future high data rate wireless systems. OFDM is a powerful technique employed in 
communications systems suffering from frequency selectivity. MIMO is a useful technology with 
significant data rate improvements of single-input-single output (SISO) systems. In this project, 
we apply smart antenna array in transmitter and receiver to represent the MIMO configuration. In 
time-varying multipath fading channels, both intersymbol interference (ISI) and multiple access 
interference (MAI) must be considered. Smart antenna provides the ability to mitigate the MAI 
effect by adaptive beamforming. 
Much research on spatial and temporal signal processing using an adaptive antenna array has 
been pursued in recent years. The LMS algorithm requires less computation and its significant 
feature is simplicity, while the RLS algorithm provides a much faster convergence, and is 
relatively independent of the eigenvalues spread compared to the LMS algorithm. Therefore, we 
will propose symbol-based adaptive antenna receiver structures without the need of calculation of 
the correlation matrix in this project. We consider an MIMO-OFDM-DS/CDMA communication 
system, which utilizes a transmit antenna array at the BS and a receive antenna array at the MS. 
In the second year of this project, it is a good idea to combine with multi-rate and dynamic 
allocation of bandwidth resources among the users. In the literatures, three access methodologies 
are provided for multi-rate CDMA; they are VPG, VCR and Multicode transmissions. The VPG 
systems use different length of spreading code at different data rate and lead to the fact that all the 
users have identical chip rate. But it needs to increase processing gain for the low rate data. On 
the other hand, the high data rate is based on small processing gain that results in the degradation 
of the system performance. For the VCR systems, data streams at different rates are spreaded by 
the codes with same length, i.e., different chip rates are used at different rate users and the 
available bandwidth is incomplete used by the low rate users. In Multicode systems, each data 
stream is converted to several basic rate streams by the serial-to-parallel device. These lower rate 
substreams are spreaded over the same bandwidth for transmissions.  
In this project, we propose and compare the receivers for the above-mentioned multirate 
CDMA systems. Smart antennas improve the system performance by increasing channel capacity 
and spectrum efficiency and extending range coverage. Delay spread and multipath fading can be 
mitigated by an antenna array that is capable of beamforming in certain direction and nulls in 
others. Adaptive antenna or smart antenna for CDMA systems can improve the performance of 
wireless radio systems. CDMA systems always accompany with time-varying multipath fading 
channels. The problem of ISI is easier overcome by wideband smart antenna. Obviously, 
combining smart antenna with CDMA system can improve the overall performance of the 
systems. Recently, the weight updated equations of the adaptive antennas are related to the 
spreading code vector. Wiener code filters not only have the ability against interference but also 
adjust the dispreading code in time domain. Therefore, we apply these schemes to the 
above-mentioned three multirate systems to improve system performance. Simulations 
demonstrate the comparison of the proposed receivers. 
 3
during the guard period. Specifically, this guard symbol is chosen to be a prefix extension to 
each block. The reason for this is to convert the linear convolution of the signal and channel 
to a circular convolution and there by causing the FFT of the circularly convolved signal and 
channel to simply be the product of their respectable FFT’s. However, in order for this 
technique to work, the guard interval should be greater than the channel delay spread. Thus, 
we see that the relative length of the cyclic prefix depends on the ratio of the channel delay 
spread to the OFDM symbol duration. 
 
2-1-2、 Adaptive Receiver in CDMA Systems 
In a CDMA system, several users access a multipoint channel by modulating reassigned 
signature waveforms. In mobile radio systems with time-varying multipath channels, both 
ISI and MAI arise. Conventional signal separation methods detect the signal of one user of 
interest and treat all signals of other users as noise. In cellular mobile radio systems, the 
nature of these interference signals that produce MAI is not noise-like because these signals 
of the own system with know user-specific CDMA code. CDMA receivers can be classified 
into two categories: multiuser detectors (MUD) and single-user detectors (SUD). Single-user 
receivers detect a single user’s signal and require only the knowledge of the desired user’s 
spreading code and timing. Minimum mean square and zero forcing equalizers for 
asynchronous CDMA systems are presented. These detectors combat MAI but do not take 
into account ISI. Minimum mean square error (MMSE) linear equalizers for continuous 
transmission are presented in which take into account both ISI and MAI. 
 
 
2-2 、The research in the second year 
2-2-1、 Smart Antenna 
Today, several terms are used to refer to the various aspects of smart-antenna system 
technology, including intelligent antennas, phased arrays, SDMA, spatial processing, digital 
beamforming, adaptive antenna systems, and others. Smart-antenna systems, however, are 
usually categorized as either switched-beam or adaptive-array systems. 
1. Switched beam systems: In terms of radiation patterns, switched beam is an 
extension of the cellular sectorization method of splitting a typical cell. The switched beam 
approach further subdivides macrosectors into several microsectors as a means of improving 
range and capacity. Each microsector contains a predetermined fixed beam pattern with the 
greatest sensitivity located in the center of the beam and less sensitivity elsewhere. The 
design of such systems involves high-gain, narrow azimuthally beamwidth antenna elements. 
The switched beam system selects one of several predetermined fixed-beam patterns (based 
on weighted combinations of antenna outputs) with the greatest output power in the remote 
user’s channel. These choices are driven by RF or baseband DSP hardware and software. 
The system switches its beam in different directions throughout space by changing the phase 
 5
interference, and could be repeated for multiple-interference cancellation. Although the 
beam pattern produced by this beamformer has nulls in the directions of interference, it is 
not designed to minimize the uncorrelated noise at the array output. When single 
interference is presented, this beamformer is easy to implement. But as the number of 
interferers grows, it becomes bulky.  
3. Optimum beamformer: The objective of the optimum beamformer is to estimate the 
signal waveform. We consider three models. First, the basic idea behind linearly constrained 
minimum variance (LCMV) beamforming is to constrain the response of the beamformer so 
signals from the direction of interest are passed with specified gain and phase. The weights 
are chosen to minimize output variance or power subject to the response constraint. This has 
the effect of preserving the desired signal while minimizing contributions to the output due 
to interfering signals and noise arriving from directions other than the direction of interest. 
The disadvantage of LCMV is that it must know direction-of-arrival of desired component 
First, the basic idea behind linearly constrained minimum variance (LCMV) beamforming is 
to constrain the response of the beamformer so signals from the direction of interest are 
passed with specified gain and phase. The weights are chosen to minimize output variance 
or power subject to the response constraint. This has the effect of preserving the desired 
signal while minimizing contributions to the output due to interfering signals and noise 
arriving from directions other than the direction of interest. The disadvantage of LCMV is 
that it must know direction-of-arrival of desired component. 
4. Element-space beamforming: the beamforming process, such as digital beamforming 
and analog beamforming, is referred to as element-space beamforming, where the digitized 
data signals which received from the array elements are multiplied by a set of weights in 
order to form a beam at the desired angle. By multiplying the received data signals with 
different sets of weights, it is possible to form beams steered in any direction. More 
explicitly, by multiplying the signal received at each antenna element by a given 
complex-valued weight, which may be different for each antenna element, the desired signal 
may be recovered.  
5. Beam-space beamforming: this is a two-stage scheme, where the first stage takes the 
array signals in input and produces a set of multiple outputs, which are then weighted and 
combined to produce the array output. The processing done at the first stage is by fixed 
weighting of the array signals, and amounts to producing multiple beams, steered in 
different directions. The weights applied to different beam outputs to produce the array 
outputs are optimized to meet specific optimization criteria, and are adjusted during the 
adaptation cycle. These arrays are useful in situations where the number of interferers is 
much less than the number of elements. 
6. Frequency-domain beamforming: in this scheme, the broadband signals from each 
element are converted from the time domain to the frequency domain, and each frequency 
beam is processed by a narrowband processor. The weighted signals from all elements are 
summed to produce an output at each beam. The weights required for each frequency beam 
are selected independently, and this selection may be performed in parallel, leading to a 
 7
gradient by a small amount in an attempt to minimize the Mean Square Error (MSE). 
2. Sample Matrix Inversion (SMI): The Sample Matrix Inversion (SMI) algorithm is a 
method of directly calculating the antenna array weights based on an estimate of the 
correlation matrix of the adaptive array output samples. As the number of samples grows, 
the matrix update approaches its true value, and thus the estimated weights approach the 
optimal weights. 
3. Recursive Least Squares (RLS): The RLS algorithm exploits the matrix inversion 
lemma for updating the antenna array element weights. As the RLS algorithm utilizes 
information contained in the array’s combiner output data extending back to the time when 
the algorithm was initiated, the rate of convergence is typically an order of magnitude higher 
than that of the LMS algorithm. This performance improvement, however, is achieved at the 
expense of substantial increase in computational complexity. 
 9
4、Research Method 
 
4-1 、The research method in the first year 
4-1-1 、System Model 
For MIMO-OFDM-DS/CDMA multiuser communication system including K users 
sharing a common frequency band, each user is assigned a unique spreading sequence kc  
composed of Q chips at chip interval cT which is equal to bT /Q. [ ] K,1,k ,)()(2)(1 LL == HkQkkk cccc                                          (1) 
where the superscript H represents the Hermitian transpose. In OFDM systems, a block of 
data of size Q where Q is a power of 2 is transmitted as an OFDM symbol. The baseband 
signal transmitted from the k-th user can be represented as 
( ) ( )
( )( ) ( )( ) ( )( )[ ]T
KK
H
t
nQsnQsnQs
nn
L
L
2111
N,1,  t,
+−+−=
== dcFs                                    (2) 
where F is the Fast Fourier transform (FFT) matrix. The IFFT matrix represents as HF . 
∈kd {±1 ± j} is the data bit transmitted by k-th user under QPSK modulation, t means the 
t-th transmitted antenna, and the superscript T means transpose. We consider a MIMO 
channel with N transmitted and M received antennas for a widely used discrete path physical 
model and can be written as 
( ) ( ) ( ) ( )NHTpMRpNHTP
p
pMRP θθθθ AHAaahH == ∑
=
,
1
,                                       (3) 
where H is the channel matrix, ( )NT θa , ( )MR θa  are array steering by transmitter and 
receiver, respectively. The transmitter and receiver are coupled via P propagation paths with 
{ }pN ,θ  and { }pM ,θ  as the spatial angles seen by the transmitter and receiver, respectively. The 
pH  represents the channel fading coefficient from p-th path. We suppose this channel 
model contains the effect of inter chip interference (ICI). L is the length of impulse response. 
So, we can construct a impulse response vector as [ ]Laaa L21 . The channel H(  can be 
rewritten as follows 
  
















=
L
L
L
H
HH
HH
H
HH
H
H
000
0
0
0
0
0
00
2
1
2
12
1
L
MOM
MOM
O
OM
OM
MO
L
(                                               (4) 
where HH ×= 11 a , Ll L,1= . H~  is normalized H
(
. Next, we represent the transmitted signal 
matrix S(n) as follows 
( ) ( ) ( ) ( )[ ]
( )( ) ( )( ) ( )( )
( )( ) ( )( ) ( )( )
( ) ( ) ( ) 









+−+−+−
+−+−+−
=
=
QnsQnsQns
nQsnQsnQs
nQsnQsnQs
nnnn
N
N
N
N
L
MOMM
L
L
L
21
21
21
21
212121
111111
sssS
   ( ) ( ) ( )[ ]TQ nnn zzz L21=  
( )nqz  is the q-th chip time signal of S(n). We rewrite transmitted signal matrix as 
 11
proposed receiver can be updated as follows, 
( ) ( )
kLMS
LMS
kLMSkLMS
J
nn
,
,, 1 w
ww ∂
∂−=+ µ              (11) 
where µ  is the step size. 
 
4-1-2-2、 Narrowband Adaptive Receiver with Code Adjustment  
In this section, we propose a new idea about adaptive receiver. It is to apply 
adaptive operation on spreading code. In traditional CDMA system, spreading code is an 
invariant sequence with fixed coefficients ±1 and has strong orthogonally. When 
spreading code sequence was transmitted through fading channel, it’s orthogonally 
would be ruined. So, we set up a new structure for code adjustment. The proposed 
receiver structure bases on LMS algorithm updates not only the weight vector of the 
MIMO-OFDM-DS/CDMA adaptive antenna receiver but also updates the despreading 
code coefficients. The elements of the despreading code are no longer ±1. According to 
the code update operation, the spreading code vector of the desired user should be 
defined as 
( ) ( ) ( ) ( ) ( ) ( ) ( )[ ]nnnn kQkkkLMS cccc L21, =              (12) 
The cost function can be represented like JLMSCA as following: 
( ) ( ) ( )
( ) ( ) ( ) ( )[
( ) ( ) ( )
( ) ( ) ( ) Qnnn
Qnnnd
QnnnnE
QnnndEJ
kkLMS
HH
kLMS
kLMS
HH
kLMSk
kLMS
H
kLMSkLMS
HH
kLMS
kLMS
HH
kLMSkLMSCA
dcFUw
wFUc
FcUwwFUc
wFUc
,,
,,
*
2
,,,,
2
,,
−
−
=


 −=
 
( ) ( )]ndnd kk *+                (13) 
Take gradient of the cost function by the code vector we obtain 
( ) ( ) ( ) QnnnJ kLMSCAkLMSH
kLMS
LMSCA *
,,
,
2 ewFU
c
−=∂
∂             (14) 
where kLMSCAe ,  denotes the error for the desired user. The update equation of the weight 
vector for this receiver is the same as 
( ) ( )
kLMS
LMS
wnkLMSkLMS
Jnn
,
_,, 21 w
ww ∂
∂−=+ µ             (15) 
The update equation of the despreader vector coefficients for this receiver is shown as 
follows 
( ) ( )
kLMS
LMSCA
cnkLMSkLMS
Jnn
,
_,, 21 c
cc ∂
∂−=+ µ              (16) 
 
4-1-2-3、 RLS-Based Receiver 
Generally, recursive least squares (RLS) filter is faster than LMS filter in aspect of 
convergence speed. However, it is a tradeoff between convergence speed and 
computational complexity. The computation complexity of recursive least squares filter 
are more than LMS filter. The update equation of weight vector and code vector 
coefficients for RLS algorithm will be derived in following paragraph. Just like what we 
 13
where ( ) ( ) ( ) Qnnn kRLSHHkkw 1, −−= wFUcdΩ  is the prior estimation error. 
 
4-2 、The research method in the second year 
4-2-1 、System Model 
In this section, we consider the multi-rate CDMA communication system consist of the 
total number of data rates N and the total number of users Ki at rate i. Three different 
multi-rate systems are introduced as below. 
 
4-2-1-1、 Variable Processing Gain (VPG) Systems 
 
channel
channel
 
Figure 4.1. The transmitter of variable processing gain systems 
 
The general VPG CDMA multiuser communication system is shown in Fig. 4.1. 
Each user is assigned a unique spreading code as follows, 
( ) ( ) ( ) ( )
, , , ,(1), (2), , ( ) ,  1 ,  1
Hk k k k
i vpg i vpg i vpg i vpg i ic c c Q i N k K = ≤ ≤ ≤ ≤ c L       (24) 
In VPG system, each user has the same chip duration, and the spreading code 
consists of Qi chips with duration Tc which is equal to i
i
T
Q , where Ti denote the symbol 
duration of the user at rate i. The transmitted signal of k-th user at rate i can be 
represented as 
( ) ( ) ( )( ) ( ) ( )k k ki i i i
n
s t b n p t nT
∞
=−∞
= −∑             (25) 
where ( ) ( )kib n  is the i.i.d. information-bearing sequence, 
( ) ( )kip t  is the spreading 
sequence defined by 
( ) ( )
,
1
( ) ( ) ( )
iQ
k k
i i vpg c
l
p t c l w t lT
=
= −∑              (26) 
where w(t) is chip pulse shape and Qi is the processing gain for rate i. All users use the 
same bandwidth and the chip duration Tc, which is defined as 
 15
be described as 
( )( ) ( )
1 1
( ) ( ) exp sin ( ),   0, , 1
iKN
k k
m i i
i k
x t G t j m x N t m Pβ θ
= =
= − ∆ + = −∑∑ L      (32) 
where { }( )kiθ  denotes the individual angle of each user in the antenna array. β=2π/λ is 
the phase propagation factor, the term λ denotes wavelength, given by c/f , where 
c=3×108 m/s is the speed of light, and f is the carrier frequency in Hz, then ∆x denotes 
the spacing between antenna element and equal to λ/2. N(t) is additive white Gaussian 
noise (AWGN) of variance 2wσ . 
 
4-2-1-2、 Variable Chip Rate (VCR) Systems 
In VCR systems, the spreading code at the lower chip rate can be regarded as a 
mi-chip repeating version of the code at the higher rate. We must consider frequency 
allocation owing to the different bandwidth required by different chip-rate users as 
shown in Fig. 4.3. Length-Q spreading codes with N chip rate groups are 
 
Group 1
Group 2
21 Q
21 Q
Group N21 Q
 
Figure 4.3. Length-Q spreading codes with N chip rate groups 
 
group 1: code family {c1} with chip rate g1 
group 2: code family {c2} with chip rate g2 
M  
group N: code family {cN} with chip rate gN 
For VCR communication systems, as shown in Fig. 4.4, the data rate of different 
users are spreading by the same processing gain, i.e., the chip duration of each user is 
different but the length of the spreading code is identical. The relation between the same 
processing gain and the chip duration for different data rate, as follows 
1 2
(1) (2) ( )
N br
N
c c c c
T TT TQ
T T T T
= = = = =L             (33) 
 
 17
processing gain of the spreading code of each virtual user is the same as Q. The 
spreading code of l-th virtual user in k-th active user at rate i is 
( , ) ( , ) ( , ) ( , )
, , , ,(1) (2) ( )
Hk l k l k l k l
i mc i mc i mc i mcc c c Q =  c L           (38) 
where 1, , il q= K . The other part of the transmitted process in Multicode systems is the 
same as (29) to (32). 
S/P channel
channel
 
Figure 4.5. The transmitter of multicode systems 
 
4-2-2、 LMS-Based Algorithms 
4-2-2-1、 Narrowband Adaptive Array Antennas 
4-2-2-1-1、VPG Systems 
Σ
Despreader DD ∑
-
+
Despreader DD ∑
-
+
LMS Algorithm
(1) ( )iy n
( ) ( )kiy n
(1)
,0 ( )iw n
(1)
,1 ( )iw n
(1)
, 1( )i Pw n−
Σ
( )
,1 ( )
k
iw n
( )
, 1( )
k
i Pw n−
Σ
( )
,0 ( )
k
iw n
0 ( )x n
1( )x n
1( )px n−
 
Figure 4.6. Narrowband adaptive antenna for VPG and VCR systems 
The section considers the weight update of the narrowband adaptive antennas 
through despreaded operation for CDMA communications. The block diagram of 
 19
we expand the above cost function (43) as follows 
(
2( ) ( ) ( )
, ,
1 1
( ) ( ) ( ) ( ) 2
, , , ,
1 1
( ) ( ) ( ) ( )
, , ,
( ) ( ) ( ) ( )
( ) ( ) ( ) ( ) ( ) ( )
( ) ( ) ( ) ( ) (
i
i
KN
k H k k
vpg i vpg i i vpg i i
i k
KN
k H k k H H k
i vpg i i vpg i vpg i i vpg i
i k
k k H H k k H
i i vpg i i vpg i i vpg
J E n n n Q d n
E n n n n n n Q
d n n n n Q n
= =
= =
 = −  
= 
− −
∑∑
∑∑
w U c
w U c c U w
c U w w ( ) ( )*,) ( ) ( ) ( )
k k
i i vpg i in n d n QU c
 
( ) ( )*( ) ( )k ki id n d n +               (44) 
where the superscript “*” represents complex conjugate. In optimal beamforming 
techniques of the adaptive antennas, a weight vector is determined which minimizes 
a cost function and then LMS algorithm is employed. In order to minimize a cost 
function, we need to compute the gradient of the cost function, is defined as 
( )
,
( ) ( ) ( ) 2 ( ) ( )*
, , , ,( )
2 ( ) ( ) ( ) ( ) ( ) 2 ( ) ( ) ( )vpgk
i vpg
J k k H H k k k
i i vpg i vpg i i vpg i i i vpg i in
n n n n n Q n n d n Q∂∂ = −w U c c U w U c  
( )* ( )
, ,2 ( ) ( )
k k
i vpg i i vpg ie n n Q= U c             (45) 
and the weight vector of the adaptive antenna of k-th user at rate i can be updated as 
follows 
( )
,
( ) ( )
, , ( )
( 1) ( ) vpgk
i vpg
Jk k k
i vpg i vpg i n
n n µ ∂∂+ = − ww w           (46) 
where kiµ  is the step size. Finally, the updated equation of weight vector of each 
user can be rewritten as  
( ) ( ) ( )* ( )
, , , ,( 1) ( ) 2 ( ) ( )
k k k k k
i vpg i vpg i i vpg i i vpg in n e n n Qµ+ = −w w U c         (47) 
 
4-2-2-1-2、VCR Systems 
The receiver structure of VCR system is similar to VPG system as shown in 
Fig. 4.1. The weight vector and received matrix have the same form as (39) and (41) 
respectively. The only difference of the antenna receiver between VCR and VPG 
systems is the initial value of the despreading code vector that is ( ) ( ), ,(1)
k k
i vcr i vcr=c c  as 
(36). The updated equation of weight vector is thus the same as (47). 
 
4-2-2-1-3、Multicode Systems 
In spite of the serial-to-parallel operation is performed in transmitter in 
Multicode systems, we replace parallel-to-serial operation by summation to 
accumulate “error signal” in receiver as shown in Fig 4.7. The reason of 
accumulation of error signal will be explained later. 
 
 21
can be described as 
( , ) ( ) ( , )
, , ,( ) ( ) ( ) ( )
k l k H k l
i mc i mc mc i mcy n n n n Q= w U c           (50) 
The cost function in Multicode systems must be considered by the condition 
that each active user regards as several virtual users and the desired signal also need 
to match the despreader output sequence ( , ), ( )
k l
i mcy n  at the same discrete time model. 
So the cost function of Multicode systems are represented as 
2( ) ( , ) ( , )
, ,
1 1 1
2( , )
,
1 1 1
( ) ( ) ( ) ( )
( )
i i
i i
K qN
k H k l k l
mc i mc mc i mc i
i k l
K qN
k l
i mc
i k l
J E n n n Q d n
E e n
= = =
= = =
 = −  
 =   
∑∑∑
∑∑∑
w U c
      (51) 
The gradient of the cost function in the Multicode systems, is defined as 
(
)
( )
,
( , ) ( , ) ( ) 2
, , ,( )
1
( , ) ( , )*
,
2 ( ) ( ) ( ) ( ) ( )
2 ( ) ( ) ( )
i
mc
k
i mc
q
J k l k l H H k
mc i mc i mc mc i mcn
l
k l k l
mc i mc i
n n n n n Q
n n d n Q
∂
∂ =
=
−
∑w U c c U w
U c
 
( , )* ( , )
, ,
1
2 ( ) ( )
iq
k l k l
i mc mc i mc
l
e n n Q
=
= ∑ U c            (52) 
The updated equation of weight vector of each user can be written as 
( ) ( ) ( , )* ( , )
, , , ,
1
( 1) ( ) 2 ( ) ( )
iq
k k k k l k l
i mc i mc i i mc mc i mc
l
n n e n n Qµ
=
+ = − ∑w w U c        (53) 
And the updated equation of weight vector is also similar to (47). 
 
4-2-2-2、 Narrowband Adaptive Antenna with Code Adjustment 
In this section, we propose a structure different from narrowband adaptive antenna 
without code adjustment. This structure mainly adjusts despreading operation with 
variant coefficients as shown in Fig. 4.6. The traditional despreading code’s elements 
are ±1 as the spreading vector in the transmitter, but the despreading elements in our 
proposed receivers are no longer fixed value. We employ LMS algorithm to update 
simultaneously the weight vector and the despreading code coefficients of the adaptive 
antenna. Then the update equations based on the code vector describe as follows. Recall 
that the cost function is given by 
(
2( ) ( ) ( )
1 1
( ) ( ) ( ) ( ) 2
1 1
( ) ( ) ( ) ( ) ( ) ( )*
( ) ( ) ( ) ( )
( ) ( ) ( ) ( ) ( ) ( )
( ) ( ) ( ) ( ) ( ) ( ) ( ) ( )
i
i
KN
k H k k
i i i i i
i k
KN
k H k k H H k
i i i i i i i
i k
k k H H k k H k k
i i i i i i i i i i
J E n n n Q d n
E n n n n n n Q
d n n n n Q n n n d n Q
= =
= =
 = −  
= 
− −
∑∑
∑∑
w U c
w U c c U w
c U w w U c
 
 23
where Z represents the length of the taped-delay-line. Therefore, the received signal 
matrix can then be described as 
( ) 1 21 1 1Qn  =  U L               (59) 
 
Σ Despreader DD ∑-+
Σ Despreader DD ∑-+
LMS AlgorithmWeight adjustment and 
code adjustment
0 ( )x n
1( )x n
1( )Px n−
(1)
0,0 ( )w n
(1)
0,1 ( )w n
(1)
0, 1( )Zw n−
(1)
1,0 ( )w n
(1)
1,1 ( )w n
(1)
1, 1( )Zw n−
(1)
1,0 ( )Pw n−
(1)
1,1( )Pw n−
(1)
1, 1( )P Zw n− −
( )
0,0 ( )
kw n ( )0,1 ( )
kw n ( )0, 1( )
k
Zw n−
( )
1,0 ( )
kw n ( )1,1 ( )
kw n ( )1, 1( )
k
Zw n−
( )
1,0 ( )
k
Pw n−
( )
1,1( )
k
Pw n−
( )
1, 1( )
k
P Zw n− −
(1) ( )y n
( ) ( )ky n
Σ
 
Figure 4.8. Wideband adaptive antenna in CDMA with code adjustment 
 
In wideband adaptive antenna structure, ( ) ( )k nw  and U(n) are rearranged to use 
for the derivation of antenna weight and code updated equations. However, these 
derivative forms are the same as the narrowband adaptive antenna structure and we will 
not reconsider this. The update equations for the wideband adaptive antenna can be 
summarized as follows. The despreader output sequence is 
( ) ( ) ( )( ) ( ) ( ) ( )k k H ky n n n n Q= w U c             (60) 
The cost function in wideband adaptive antenna structure is 
2( ) ( ) ( )
1
( ) ( ) ( ) ( )
K
k H k k
k
J E n n n Q d n
=
 = −  ∑ w U c          (61) 
The gradient for the weight vector and despreading code are 
( )
( )* ( )
( )
2 ( ) ( ) ( )k k kJ n e n n n Q
∂
∂ =w U c             (61) 
Finally, the updated equations for the weight vector and despreading code are 
( ) ( ) ( )* ( )( 1) ( ) 2 ( ) ( ) ( )k k k k kin n e n n n Qµ+ = −w w U c          (62) 
( ) ( ) ( )* ( )( 1) ( ) 2 ( ) ( ) ( )k k k k H kin n e n n n Qλ+ = −c c U w          (63) 
 25
 
Figure 5.3. BER performance of narrowband RLS-based adaptive receiver with different 
user number in each transmitted antenna branch. 
 
 
In the second year, it shows the simulation results of three multirate CDMA systems for 
adaptive LMS-based receiver structures. There are K=8 or 12 users, P=8 antenna array number 
and Z=8 tapped-delay-line number in all the following simulations. The transmitted signal is 
QPSK throughout the simulations. For simplicity, we only consider a dual-rate system in the 
project, assume 4 or 6 high-rate users with a symbol rate being twice times the basic rate and 4 or 
6 low-rate users with basic symbol rate. 
In order to show the result on various ISI and MAI environments, we categorize the channel 
impulse response (and multipath) of each user into two groups described as 
( ) ( )1 1 1 1 2 2 2 2( ) ( ) ( ) ( ) ( ) ( ) ( ) ( ),1 ,12 ,16 ,1 ,12 ,16, , , ,  , , ,k k k k k k k ki i i i i i i iH h h h H h h h= =L L , k=1,…,Ki. The length of 1( )kiH  and 2( )kiH  
are fixed on 16. ( )1
kH  has the same incident angle to each impulse response to emphasize the 
property of ISI. The second channel ( )2
kH , every impulse response is assigned a different incident 
angle on antenna array. When the incident angles of the received signal differ from the desired 
user’s angle, the interference will be suppressed by the space processing of smart antenna. 
In these simulations, we consider a severe fading environment to show the performance 
difference of our proposed receivers, i.e., we randomly assign 16 impulse responses in both 
1
( )k
iH  
and 
2
( )k
iH  for each user. So the systems in our simulations are regarded as asynchronous. First, 
we compare the proposed receivers for three multirate systems with different spreading code, e.g., 
PN code, Hadamard code and orthogonal codes generated by PN code sequences (orthogonal PN 
codes). If the spreading codes are orthogonal codes, we select the processing gain as 16 in high 
rate users and 32 in low rate users for each multirate system. Contrarily, when non-orthogonal 
codes are used as the spreading codes, the same processing gain in each multirate system is 
impossible. For fair comparison, the high rate users of VCR and VPG systems are assigned 15 
PN codes as the spreading codes in following simulations. The VCR systems use 15 PN code and 
 27
 
Figure 5.4. LMS learning curve comparisons for three multirate structures with Hadamard 
code 
 
 
Figure 5.5. LMS learning curve comparisons for three multirate structures with orthogonal 
codes generated by PN code sequences 
 
Figure 5.6. LMS learning curve comparisons for three multirate structures with PN code 
 29
 
Figure 5.10. The different length of spreading code for Multicode systems 
 
表 Y04 
二、與會心得 
智能信號處理與通訊系統國際會議(2006 International Symposium on Intelligent 
Signal Processing and Communication Systems, ISPACS 2006)是信號處理與通訊系
統相關領域的重要會議。此會議由 IEEE 所支持。ISPACS 2006 展示新的信息技術，
內容包括新的智能信號處理與通訊系統相關主題。本次會議涵蓋的研究主題相當
廣 泛 ， 如 : Image Processing, Communications Networks, Multi Carrier 
Communications, Ultra Wide Band, Channel Estimation and Equalization,  Pattern 
Recognition, MIMO, Motion Estimation, Circuits and Systems for Communications, 
Intelligent Image Processing, Radar Siginal Processing, Neural Networks and Fuzzy 
Processing, Multidimensional Signal Processing, Blind Signal Processing, Spread 
Spectrum Communications, Security Signal Processing, Optical Signal Processing, 
Adaptive Signal Processing, Estimation and Detection, Nonlinear Signal Processing, 
Image and Video Coding, Signal Processing for Communication, Coding for 
Communication Systems 等皆有許多論文發表。同時會議出席者眾多，與會者十分
熱烈參與。與會期間個人也與一些各國之學者專家交流討論，並從各 Technical 
Sessions 中了解各領域之研究現況及發展方向，實為本次參加會議之最大收穫。此
外，由於個人近期從事之 Multiuser Detection、Blind Equalization、OFDM、Multi 
Carrier Communications, MIMO 及 Smart Antenna 的相關研究，對於這些相關領域
之 Technical Session 之內容較能充分掌握，其他領域較無法全盤了解與吸收。因
此，今後應多方延伸研究觸角並多參加國內外之研討會，吸收相關背景知識以擴
展自己的研究領域。 
三、建議 
日後國內舉辦相關國際會議時，建議能準備代表台灣文化或特色的相關活動或是
演出，如此則能在會議主題的國際交流之外，相信對台灣文化介紹與國民外交的
推廣一定會有相當的助益。 
四、攜回資料名稱及內容 
論文集 CD 光碟片，內容包括所有與會論文之詳細內容。 
 
 
identically distributed (i. i d.) symbols. A single data symbol
is replicated into N parallel paths. Since the IFFT is a linear
operation, the characteristic of spreading code is preserved [1].
An OFDM-CDMA signal is the sum of the signals transmitted
by K users given by
sn =
1√
N
KX
k=1
NX
m=1
Ckma
k
i e
j 2πmnN
=
KX
k=1
aki c
k
n (1)
where K is the number of active users, aki is the i-th data
symbol of the k-th user and Ckm is a real-valued spreading
code of the k-th user consisting of N in general complex
chips. In Eq. (1), ckn =
1√
N
NX
m=1
Ckme
j 2πmnN is the spreading
code which is periodic with the period of N . Each of the
channel can be modeled as an FIR filter of length L whose
impulse response is
h(t) =
LX
l=1
hlδ(t− (l − 1)Tc) (2)
where hl is the propagation vector of the l-th path, Tc is
chip duration and the delay time of the l-th path is (l −
1)Tc. Interchip interference (ICI) and ISI arise for L greater
than one and MAI arises due to channel distortion or non-
orthogonal spreading code or both. For keeping the orthogonal
characterize of OFDM, we increase the cyclic prefix to avoid
ISI. Thus the received signal in the time domain en can be
described as
en =
LX
l=1
hls(n; l) + n (3)
where s(n; l) = [sN−(l−2),..., sN , s1, ..., sN−(l−1)]T and n
is the noise vector. The received sequence e is obtained at
the chip rate. The delayed path is the cyclic shift of the
direct path because the signal has the guard interval. For
simplicity the channels are assumed to be time invariant during
the transmission of the data symbol sequences s. First, we
combine the transformed code c and channel impulse response
defined as
bk =
LX
l=1
hkl c
k(n; l) (4)
where ck(n; l) = [ckN−(l−2), ..., c
k
1 , ..., c
k
N−(l−1)]
T . In the
transmission of a block of Q data bits, the length of received
signal vector is extended to (NQ) and the transmitted signals
is expressed as the vector d of length (KQ)
d = [d1,d2,..., dKQ]T . (5)
The system matrix A of size (QN)× (KQ) is given by
A = (Ai,j); i = 1, 2..,NQ , j = 1, 2, ...,KQ
AN ·(q−1)+l,Q·(k−1)+q =
½
bkl for q = 1, ..., Q
0 otherwise
¾
(6)
The received signal Ω is sum of K sequences that are
supposed to arrive synchronously, perturbed by an additive
stationary noise sequence n.
Ω = Ad+ n
The structure model of a block transmission OFDM-CDMA
is shown in Fig. 1. For example, N=3, Q=2, K=2 can be
expressed as


e1
e2
e3
e4
e5
e6


=


b11 0 b
2
1 0
b12 0 b
2
2 0
b13 0 b
2
3 0
0 b11 0 b
2
1
0 b12 0 b
2
2
0 b13 0 b
2
3




d11
d12
d21
d22

+


n1
n2
n3
n4
n5
n6


(7)
For the data estimator presented in the following, it is assumed
that the covariance matrix Rn of the noise sequence n is
known at the receiver. Let the data estimators determine
discrete-valued estimates d¯kof the transmitted data sequences
dk. The signal-to-noise ratio (SNR) is defined as
r(k, q) =
E(
¯¯¯
dˆkq
¯¯¯2
)
E(|ICI+MAI+ noise|2) . (8)
Eq. (8) is related to one data symbol at the output of the
estimator. Not only ICI but also MAI is also be taken into
account to evaluate the SNR r(k, q). An estimate P sb (r(k, q))
of the resulting symbol-error probability related to the q-th
symbol of the k-th user can be obtained by using Eq. (8)
An estimate P¯scal of the average symbol-error probability
resulting for different transmission conditions is defined as
P¯scal =
1
KQ
KX
k=1
QX
q=1
∞Z
0
P sb (r(k, q))p(r(k, q))d(r(k, q)) (9)
where P sb (·) is the well-known symbol-error probability for
signaling over an AWGN channel as a function of the SNR
per symbol for the chosen modulation scheme, p(r(k, q))
is the density function of the SNR r(k, q) per symbol of
the q-th symbol of the k-th user determined by the varying
transmission conditions.
III. DETECTION ALGORITHMS AND SPREADING
SEQUENCE
A. Joint Detection Algorithms
The current state of the art suggests that JD provides bet-
ter performance than parallel interference cancellation (PIC)
techniques. A number of specific methods that combine with
the JD approach are possible as listed as follow:
1) Zero Forcing Block Linear Equalizer (ZF-BLE),
2) Minimum Mean Square Error Block Linear Equalizer
(MMSE-BLE),
3) Zero Forcing Block Decision Feedback Equalizer (ZF-
BDFE),
506
The cross-correlation of orthogonal codes is better than non-
orthogonal ones. Besides, comparisons between Fig. 2 and Fig.
3, the BER performance will be degraded with the increment
of user numbers. Figs. 4-5 are also demonstrate the above-
mentioned issues. Examine these four figures, the performance
relation between proposed receivers can be obtained as fol-
lowing. For the time varying complex multipath channels, the
MMSE-BDFE performs best, followed by the MMSE-BLE,
the ZF-BDFE, and the ZF-BLE. Furthermore, in high signal
to noise ratio environment, we also find the decision-feedback
can reduce multiple access interference effectively.
TABLE I.
Simulation Parameter
Modulation MPSK M = 2
Number of User K = 16 K = 30
Channel Length L = 4 L = 8
Length of Transmission Block N = 25
Walsh-Hadamard Code Q = 32
Orthogonal Gold Code Q = 32
PN Code Q = 31
Gold Code Q = 31
V. CONCLUSIONS
Several detection techniques have been presented perform-
ing channel equalization in multiuser OFDM-CDMA block
transmission systems by combating both ICI and MAI. ZF
and MMSE equalizers both with and without DF have been
introduced and their performances have been analyzed. The
performance of the MMSE equalizers is better than that of
the corresponding ZF equalizers because the desired symbols
and the ICI, MAI, and noise terms are decorrelated by a
Wiener estimator. The performances of the equalizers with
DF is better than that of the corresponding equalizers without
DF. Furthermore, we can maintain the demodulation efficiency
although the hardware complexity decrease by time-domain
equalizer and make the whole system easier to realize.
REFERENCES
[1] S. Hara., R. Prasad., “Overview of multicarrier CDMA,” IEEE Commu-
nications Magazine, vol 35, p.p. 126-133, Dec. 1997.
[2] S. Nahm and W. Sung, “Time-domain equalization for the orthogonal
multi-carrier CDMA system,” IEEE Global Telecommunications Confer-
ence, vol. 3; p.p. 1583-1587, Nov. 1996.
[3] A. Klein., G. K. Kaleh, and P. W. Baier, “Zero forcing and minimum
mean-square-error equalization for multiuser detection in code-division
multiple-access channels,” IEEE Transactions on Vehicular Technology,
vol 45, p.p. 276-287, May. 1996.
[4] Di. V. Sarwate and M. B. Pursley, "Crosscorrelation Properties of Pseudo-
random and Related Sequences," Proceedings of the IEEE, vol. 68, May
1980.
[5] L. Hanzo,L-L. Young, E-L. Kuan and K. Yen, Single and Multi-Carrier
DS-CDMA: Multiuser Detection, Space-Time Spreading, Synchronization,
Networking and Standards, Wiley, 2004.
[6] E. H. Dinan and B. Jabbari, Spreading Codes for Direct Sequence
CDMA and Wideband CDMA Cellular Networks, IEEE Communications
Magazine,vol.36,no. 9, pp. 4854, Sep. 1998.
Fig. 1. Discrete-time baseband model of a block transmission OFDM-CDMA
system
Fig. 2. Hadamard and PN code with channel length = 4, user = 16
Fig. 3. Hadamard and PN code with channel length = 8, user = 30
508
