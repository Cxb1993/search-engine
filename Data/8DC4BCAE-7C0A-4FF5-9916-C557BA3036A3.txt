  2
摘要 
 
本計畫整合近年來以自有設備能量電子斑點干涉術 (ESPI) 系統及其衍生無論硬體或
軟體等相關題材，作一深入的分析與比對以發展相關技術並擴大應用的研究。本二年
期計畫第一年先以電子斑點干涉術取得各種不同型式(包括不同雜訊程度、不同形狀不
連續等)的相位圖，以進行各種相位展開技術之特性分析與交叉比較，包括如強健性 
(Robustness) 、耗費總時間、法則難易度、適用普遍性等，以建立完整之資料庫，並
進而提出最佳化之相位展開法則，供學術及相關產業之用。 
分析結果更於計畫第二年應用至動態振動模態振幅重建、合成孔徑雷達 (Synthetic 
Aperture Radar, SAR) 及 MRI (Magnetic Resonance Imaging) 等領域之相位圖展開應用
上，計畫所發展之相位展開法於不同的應用領域上都有很不錯的表現。 
 
關鍵字: 相位展開、相位圖、不連續體 
  4
目錄 
報告內容                                                                 6 
前言                                                                  6 
研究目的                                                              7 
文獻探討                                                              7 
研究方法                                                              8 
結果與討論                                                           81 
參考文獻                                                               109 
計畫成果自評                                                           112
  6
resonance imaging (MRI)16-18, the relationship between the object phase and its bispectrum 
phase in astronomical imaging19,20 等。 
 
二、研究目的 
本(實驗應力/全像光機)實驗室常年來以自有設備能量電子斑點干涉術 (ESPI) 系統及
其衍生所需無論硬體或軟體等相關題材為研究方向，對電子斑點干涉術之技術發展與應
用研究已略具成效。本二年期計畫第一年先以電子斑點干涉術取得各種不同型式的相位
圖，以進行各種相位展開技術之特性分析與交叉比較，包括如強健性 (Robustness) 、耗
費總時間、法則難易度、適用普遍性等，以建立完整之資料庫，並進而提出最佳化之相
位展開法則，供學術及相關產業之用。 
分析結果更於計畫第二年應用至合成孔徑雷達 (Synthetic Aperture Radar, SAR) 及 MRI 
(Magnetic Resonance Imaging) 等領域之相位圖展開應用上。 
 
三、文獻探討 
上述 (1-1) 式，一般在無 Phase inconsistencies or residues 時，可輕易以任何 Path 
dependent unwrapping algorithm (Itoh1 or Macy2) 完成；但當有 Phase inconsistencies or 
residues 時 (大部份之情況) ，則必須藉助於 Noise-immune or robust phase unwrapping 
algorithm21-24 為之，雖說強健，但一般而言，乃是針對不同問題設計不同之 algorithm 
以為因應，有名的幾個方法如： 
Kadono21 於 1997 提出利用不同之摭罩 (mask) 搭配均值 (average) 或中值 (median) 
濾波，可成功應用於斑點干涉 (speckle interferometry) 圖樣之分析處理上，然其缺點為
路徑相依、誤差向後纍積、計算量大、耗時、參考資訊只來自特定而非最佳方向。 
Cusack22 於 1995 年提出藉由 branch cut 之標示，以迴避任何橫越 branch cut 之積分，
但因成功之 branch cut 之標示，本身就是一件難且費事的事，尤其在本計劃所定義之
雜訊程度下，本方法將無法被利用。 
Marklund23 於 1998 年提出以 iterative computational procedure, which is derived with the 
use of a global cost function to minimize the phase discontinuities in the unwrapped phase 
map. 利用此法使 algorithm 本身變得強健，但計算及疊代卻相當耗時。 
Asundi24 於 1998 年提出以各點強度值之高低來定義該點之訊號雜訊比 (S/N) ，訊號
雜訊比高的先作，再依次作較低訊號雜訊比者，直到低於截止門檻 (cut off threshold) 
以下者不作，此法當 noise 不高時很好用，尤其是 moire 之應用，但像本計畫之斑點
干涉 (speckle interferometry) 圖，若利用此法會因被分割成一些零碎的小區域，無法
組合在一起而失效。 
有鑑於上述之種種，個人於 2002 年亦先後提出了四篇 Noise-immune 之相位展開法
25-28，其邏輯簡單而且應用性廣。 
申請人目前正進一步針對具形貌不連續的電子斑點干涉相位圖之相位展開，作深入之
分析與研究 (國科會執行中計畫) ，期能建立有效且高解析之相位展開技術。目前研究
顯示 Lp Norm Method 可解形貌不連續之相位圖，但由次其運算量大、速度很慢且不適
  8
( ) ( ) π21 00 +=+⇒ nPnP ，                                         (1-4) 
由上述之演算法可知，其優點為運算過程只往一個方向傳遞，因此不需判別週期性
重複，且速度也不遜色，但是利用(1-3)式或(1-4)式還是不能處理不連續點的問題。 
於 2002 年 為 了 提 高 演 算 法 對 雜 訊 免 疫 的 能 力 ， Huang and He25 更 以 提 出
region-referenced PhU 的方式，以解決前述之問題，然其中採用了兩個可調控的機制使
上述(1-3)與(1-4)式能夠處理不連續點的問題： 
 
4.1.1 可調控的變動門檻值 
把上述的數學式稍加改變，由門檻值 pt (π 的倍數)所控制；也就是說：不再只是相
位差為 π 的界線，有可能以 π 的倍數為界線，在這樣的情況下測試，確實已能處理不連
續點的問題，其數學式表示為： 
( ) ( )[ ] ptyxpjyixp −<−−−∃ ,, 0                       
其中 i=0，for j=1 or -1 
     j=0，for i=1 or -1 
     
2ptπ π< <  
( ) ( ) π21 00 −=+⇒ nPnP ，                                        (1-5) 
或 
( ) ( )[ ] ptyxpjyixp >−−−∃ ,, 0                     
其中 i=0，for j=1 or -1 
     j=0，for i=1 or –1 
    
ππ 2<< pt  
( ) ( ) π21 00 +=+⇒ nPnP ，                                         (1-6) 
4.1.2 由參考四點改為遮罩 
由原先只參考四點改為參考遮罩周圍點數來取代。 
其完整演算法步驟如下： 
 
  10
3.14
-3.14
0.00
80
0
20
40
60
800 10 20 30 40 50 60 70  
1
0
0
80
0
20
40
60
800 10 20 30 40 50 60 70  
(a)                               (b) 
29.11
1.50
9.01
20.86
80
0
20
40
60
800 10 20 30 40 50 60 70  
29.11
1.50
9.01
20.86
80
0
20
40
60
800 10 20 30 40 50 60 70  
(c)                           (d) 
圖 1-2 調控式平行相位展開法測試：(a)帶有高雜訊之相位圖；(b)相位圖中的不連續點分佈；(c)利用 π=1T
與 82 =T 以調控式平行相位展開法展開完成；(d)利用 π2.11 =T 與 72 =T 以調控式平行相位展開
法展開完成 
 
由圖 1-2 可以看出一個帶有高雜訊的相位圖，可以透過調整 1T 和 2T 的適當組合，將原本
被包裹在反正切函數的資訊，正確地展開出來，但要如何正確地調整且設定這些門檻值
和參考點數，便成為相當重要的課題。 
 
4.1.3 T1、T2 參數選擇之特性 
    為了解 1T (門檻值)和 2T (參考點數)兩參數配對之特性，在此利用圖 1-3(a)中理想無雜
訊和圖 1-3(b)中帶有高雜訊的兩張相位圖作測試：利用 55× 遮罩，門檻值 1T 從 0.6π 到
1.8π，每次變動 0.1π；參考點數 2T 從 14 點到 1 點，每次變動 1 點。其測試結果如表 1-1
與表 1-2 所示： 
 
2.89
-3.12
0.00
80
0
20
40
60
800 10 20 30 40 50 60 70
3.14
-3.14
-0.12
80
0
20
40
60
800 10 20 30 40 50 60 70  
(a)                            (b) 
  12
開完成與未完全三種，又可以將發散歸類為程式無法停止的不穩定，完成和展開結果較
差的未完全則歸類為程式能夠停止的穩定兩種，如圖 1-4 所示。而決定調整門檻值與參
考點數的關鍵在於不穩定的發散現象。 
 
 
圖 1-4 展開結果型態分類圖 
 
因此本章的主要目的即是利用不穩定的發散現象所呈現出來的特性，希望對於 T1
和 T2 兩個參數作自動化的調整修正；儘管給予的初始配對，並非正確的配對，依舊可
以自動地依循規則，收斂到正確的配對，並且將被包裹的資訊正確地展開出來。 
 
4.1.4 發散現象與其抑制方法 
發散現象如圖 1-5 所示，主要發生在低門檻值、低參考點數的組合，如表 1-2 的右
上部分，因為給予的條件過於鬆軟所造成，在某些不連續點的地方，會成為一個發散源
向四周擴散，造成圖面上的點隨著發散源出來的波前，不斷地被搬移而無法停止；其主
要抑制方法為調高門檻值或是提高參考點數，但重點在於如何去給予一個判斷機制來判
斷展開過程正處於一個發散狀況。 
 
3.14
-3.14
0.00
80
0
20
40
60
800 10 20 30 40 50 60 70
17.64
1.34
3.1480
0
20
40
60
800 10 20 30 40 50 60 70  
(a)                             (b) 
圖 1-5 相位圖與發散現象：(a)原始相位圖；(b)發散現象 
 
    判斷是不是發散的機制主要是利用平行性相位展開法的特性。在平行相位展開法的
展開演算法中，是計算相位圖內的每一點是否要被搬移，並且建立一對應表，之後再利
用此對應表，對整張相位圖作 πn2 的搬移。因此在一張相位圖中，每一個點在完整的相
  14
  
(a)                                (b) 
3
0
80
0
20
40
60
800 10 20 30 40 50 60 70  
(c)                               (d) 
圖 1-6 相位圖與搬移次數之關係：(a)無雜訊理想模擬平面相位圖；(b)Jump 圖；(c) 跳躍
線偵測圖；(d)展開完成後像素搬移次數圖 
 
4.1.5 正確展開結果之選擇 
調控式平行相位展開法加入上述針對發散現象的參數修正後，若給予 T2 任意的參
數值，程式便會找到與該 T2 值匹配的 T1 參數，如圖 1-7 藍色部分所示。但在這些解中
包含了展開完成與未完全的參數組合，所以如同發散現象一樣，需要一個機制來擷取出
正確的展開結果。 
 
 
圖 1-7 相位展開配對集合表 
 
為了尋找正確展開結果的特徵，我們使用所介紹的 Jump 圖來觀察模擬一次平面圖
與展開完成和未完全圖之間的差異。由於模擬出來的一次平面帶有高雜訊，因此當我們
使用 Jump 圖觀察時會看到零星散亂的跳躍點，如圖 1-8(c)所示。如果展開完成相位圖
  16
15.06
-3.14
0.00
11.85
80
0
20
40
60
800 10 20 30 40 50 60 70  
1
0
320
0
50
100
150
200
250
3200 50 100 150 200 250  
(h)                            (i) 
圖 1-8 模擬相位圖與展開未完成現象：(a)模擬一次平面相位圖；(b)模擬一次平面；(c)
模擬一次平面 Jump 圖(292 點)；(d)展開完成相位圖 8;1 21 == TT ；(e)展開完成 Jump 圖(292
點)；(f)展開完成圖 12;8.0 21 == TT ；(g)展開完成 Jump 圖(304 點)；(h)展開未完全相位圖
13;7.0 21 == TT ；(i)展開未完全 Jump 圖(745 點) 
 
    經由以上的觀察，我們發現在結果集合中以 Jump 圖點數最少的解為最理想的結
果，而 Jump 圖是將相鄰點間相位差的絕對值大於 π 時所做的標示。因此，我們即可利
用”各參數組合的相位展開結果，取其相鄰點間相位差絕對值總和最小的解為佳”的概
念，在搜尋到的集合中擷取出較佳的展開結果。 
 
4.1.6 參數自動搜尋流程說明 
  18
(2) 具有調整彈性 
由於各個子區塊的 1T 與 2T 參數組合不需相同，因此可視各個子區塊相位圖的特性來
採用合適的參數配對，互相搭配運用達到最佳的相位展開效果。 
(3) 區塊間互相獨立 
由於是經過分割後再個別做相位展開，所以各個區塊是獨立的，就算有某一區塊在
做相位展開時有錯誤的搬移或是展開不完全的情況，也只會侷限在該區塊內，不會影響
其他區塊的相位展開，因此能夠隔離問題區塊再做後序處理。 
當各個區塊都展開完畢之後的接合動作，一般是採用「路徑相依」的接合方式，主
要在選定一個積分路徑，在這路徑中每一個區塊與此路徑前一個區塊作比較，若相鄰兩
邊上「平均的相位差絕對值」大於 π，則此區塊就必須做搬移的動作（全區加或減 2nπ）。
如此一來當積分路徑佈滿整張原始的相位圖時，則完成了區塊接合的動作。但若所選擇
的積分路徑穿過有不連續現象存在的邊界，就會像「路徑相依型相位展開法」一樣發生
接合錯誤向後傳遞的情形。 
 
4.1.8 新式「路徑獨立型」區塊接合邏輯 
為改進「路徑相依型」區塊接合方法會發生接合錯誤向後傳遞的情形，提出的一種
新式「路徑獨立型」區塊接合邏輯。首先，在傳統區塊接合技術中比較區塊 2nπ 間的差
值是由相鄰區塊邊上相減而得，計算相鄰像素（Pixel）的差值等於在求兩點間的斜率（一
次微分），在有雜訊的情況下，微分的動作會使雜訊的影響放大；且因兩邊的相位是由
各自所屬的區塊所展開，又區塊間是互相獨立，所以兩邊的相位除了「相位展開結果為
連續面」的假設外是沒有相關性的。所以重新調整區塊分割的方式，將區塊和區塊間留
有一小部份重疊的區域，以下圖 1-10 說明 
 
圖 1-10 區塊分割的重疊區域示意圖 
 
假設一包裹相位圖的大小是 80×80，我們以 10×10 大小的單位區塊將其分割為 8×8
個區塊，但在做相位展開處理時，我們會將區塊的右邊和下邊各延伸一個圖元，形成
11×11 的區塊，這個延伸的部份（斜線區域）就是所謂重疊區域(Overlap)。 
這樣一來，在區塊各自相位展開之後，就可以從重疊區域處的資料比對得知相鄰區
  20
間可靠度權值（ RW ）。 
(3) 從最大可靠度的區塊進行接合 
選取區塊間可靠度權值（ RW ）最大的相鄰區塊作為本次所要接合的兩區塊；將此
相鄰的兩區塊依(8)式計算所得的區塊搬移量Δ進行搬移並接合。接合後視為同一區塊。 
(4) 判斷是否仍有未接合的區塊 
若尚有未接合的區塊，則回到步驟(3)進行下一次的接合，直到所有區塊均接合在一
起為止。 
 
圖 1-11 區塊接合流程圖 
 
從以下圖 1-12 可說明路徑獨立型接合過程，上述的區塊接合技術以區塊分割時所
預留的重疊處作為兩區塊間接合可靠度的判斷標準，如此一來可以避免路徑相依型區塊
接合技術所會造成的錯誤搬移沿著路徑向後傳遞的缺點，以此方法亦可將相位展開時出
現問題區塊的可靠度權值例如錯誤搬移沿路徑相後傳遞或相位展開不完全等，壓抑在較
低的值，這樣就可在區塊接合後得到較佳的整場相位展開結果。 
 
 
 
3.14
-3.11
-0.00
80
0
20
40
60
800 10 20 30 40 50 60 70  
6.08
-1.57
-0.00
3.14
80
0
20
40
60
800 10 20 30 40 50 60 70  
(a)                                 (b) 
  22
圖 1-12 的例子接合的很完整是由於剪切線剛好在區塊邊界上，但在實際的情況下
並非如此理想。我們試著將剪切線向下移動，讓剪切線落在區塊中，所得到的結果如圖
1-13 所示。含有剪切線的區塊在接合時會有的接合錯誤現象，這是因為在該區塊中剪切
線上下兩端的建議搬移量Δ不同，而最後只能依靠可靠度權值 RW 較大的一邊做接合所
造成。為了修正該現象所產生的錯誤，我們將利用擬合誤差的概念，找到形貌不連續線
的線索，以該線段為限制重新展開，來修正此類的問題。 
3.14
-3.11
0.00
80
0
20
40
60
800 10 20 30 40 50 60 70
6.08
-1.57
0.00
3.14
80
0
20
40
60
800 10 20 30 40 50 60 70  
(a)                                  (b) 
10.95
-18.85
-3.14
-0.00
3.14
80
0
20
40
60
800 10 20 30 40 50 60 70  
(c) 
圖 1-13 形貌不連續線在區塊中的接合結果：(a)模擬相位圖；(b)區塊個別展開結果；(c)
區塊接合後結果 
 
4.1.9 形貌不連續線段搜尋 
 
以圖 1-12 為例，我們對個別展開後的各個區塊做ㄧ次曲面擬合的動作，而曲面擬
合定義如下，假設擬合曲面 
cbyaxz ++= ，                                           (1-12) 
Normal Equation 
⎥⎥
⎥⎥
⎥⎥
⎦
⎤
⎢⎢
⎢⎢
⎢⎢
⎣
⎡
⋅
⋅
=
⎥⎥
⎥⎥
⎥⎥
⎦
⎤
⎢⎢
⎢⎢
⎢⎢
⎣
⎡
⋅
⋅
−
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢
⎣
⎡
⎥⎥
⎥⎥
⎥⎥
⎦
⎤
⎢⎢
⎢⎢
⎢⎢
⎣
⎡
⋅
⋅
n
i
n
i
nn
ii
z
z
z
c
b
a
yx
yx
yx
ε
ε
ε1111
1
1
1
，                               (1-13) 
即， EZXA =− ，                                         (1-14) 
  24
(a)                            (b) 
1.00
0.00
8
0
2
4
6
80 1 2 3 4 5 6 7
2.45
0.00
80
0
20
40
60
800 10 20 30 40 50 60 70  
(c)                           (d) 
圖 1-15 參考區塊的選取：(a)濾波後結果；(b)圖(a)的不連續點；(c)不連續點對應之區塊；
(d)各参考區塊對應的擬合誤差 
 
接下來對圖 1-15(d)的結果取門檻值，剔除低於門檻值的部份，此門檻值的定義方式
為誤差範圍的百分比，計算方式如下： 
( )[ ] minminmax EPEET +×−= ，                                (1-18) 
⎩⎨
⎧
<
>=
TjiE
TjiE
jiET ),(,0
),(,1
),( ，                                   (1-19) 
maxmin , EE 分別為誤差的最小值與最大值；P 為誤差範圍的百分比，在此為 70%。 
利用門檻值的方式取出擬合誤差值較大的地方，即剪切線周圍的點，可得到如圖 1-16
所示的結果，這些點便是我們用來尋找形貌不連續線的參考點。 
 
1.00
0.00
80
0
20
40
60
800 10 20 30 40 50 60 70  
圖 1-16 對擬合誤差取門檻值之結果 
 
 
  26
11
-19
-3
0
3
80
0
20
40
60
800 10 20 30 40 50 60 70  
圖 18 區塊接合後修正結果 
二、以 Minimum-norm methods ( pL 方法) 30 相位展開法結合次區域 (Sub region) 分割，以
提昇運算速度，再結合 Branch cut Method 取得形貌不連續處 (Physical Discontinuity) 
分叉點，最後再佐以 Minimum Cost Function 利用最佳化的方式，取得形貌不連續的
分佈，並標記為 Branch cut 之相位展開法的建立與提出 
 
相位展開問題可以變分法及最佳化之方式進行，將問題轉換成用 weighted or unweighted 
least-squares 的形式去計算，換句話說，也就是將相位梯度的平方誤差最小化之後去逼
近真實的相位。其實最小平方誤差的方法即是 pL 方法中的特例，一般藉調整 p的值來達
到相對較佳的結果。 
然而只依據相位圖中相鄰點間之相位差值平方之最小化，一般會求得並引致一平順曲面
之相位展開結果，然而對具形貌不連續之相位圖相位還原而言，其實在形貌不連續處的
變化是非常急遽而非平順的，可由相位圖相鄰像素間的差值引入權值的觀念，在疊代過
程中會自動修正權值，可改善在形貌不連續處相位展開結果平滑化的問題。但是隨著相
位圖尺寸的上升，其運算時間也大幅度的成長，且對於雜訊的容忍度不高，無法應用於
ESPI 之中，尤其當具形貌不連續之相位圖上的雜訊高(如 ESPI)時，即便藉由 DCT 及
weighted minimum norm 也無法解得正確的相位，因此本計畫中再對其作修正整合
Branch cut method 及 Sub block stitching 等方法，以克服形貌不連續的問題。 
假設展開前的包裹相位為 ,i jψ ，展開後的正確相位為 ,i jφ ，其關係式如下 
, , ,2i j i j i jkψ φ π= +  (2-1) 
其中 
,i jk 為整數矩陣 
,i jπ ψ π− < < ； 0,1, , 1i M= −L ； 0,1, , 1j N= −L  
為了使相位展開後像素間的相位變化量保持一樣，以下式目標函數描述此問題 
2 1 1 2
1, , , , 1 , ,
0 0 0 0
M N M Np pp x y
i j i j i j i j i j i j
i j i j
J ε φ φ φ φ− − − −+ +
= = = =
= = − − Δ + − − Δ∑∑ ∑∑  (2-2) 
  28
 
圖 2-1 預加條件式共軛梯度法演算流程圖 
 
此方法採用迭代的方式，其運作的方法是先給予一組初始向量（Initial guess），以進
行迭代。在每一次新的迭代中，都會比對包裹相位和迭代產生的展開相位來產生一組新
的殘餘向量（Residual vector），並用此殘餘向量來決定下一次迭代時的收斂方向，來得
到新的一組展開相位的近似解，而迭代將不斷地進行，直到達到我們所設定的收斂條件
或是迭代次數達到設定之上限為止。為了能夠更簡單的操控權值 ( , )U i j 、 ( , )V i j ，在此
將其正規化 
( )
0
2
,,,1
0,
εφφ
ε
+Δ−−
= −
+
px
jijiji
jiU  (2-8) 
  30
 
(c)相位展開結果               (d)比較(a)和(c)圖的 2π 差異量 
圖 2-2 形貌不連續線靠近邊界的相位圖展開 
 
接著若我們將圖 2-2 中的形貌不連續線的起始位置向左移，如圖 2-3(d)也可看出右
下角有一區沒有展開完全。 
 
(a)模擬的原始相位圖             (b)為(a)的包裹相位圖 
 
(c)相位展開結果                (d)比較(a)和(c)圖的 2π 差異量 
圖 2-3 岔開量較大的形貌不連續線相位圖展開 
40
0
5
10
15
20
25
30
35
400 5 10 15 20 25 30 35
2.00
1.00
40
0
5
10
15
20
25
30
35
400 5 10 15 20 25 30 35
40
0
5
10
15
20
25
30
35
400 5 10 15 20 25 30 35
40
0
5
10
15
20
25
30
35
400 5 10 15 20 25 30 35
40
0
5
10
15
20
25
30
35
400 5 10 15 20 25 30 35
2.00
1.00
40
0
5
10
15
20
25
30
35
400 5 10 15 20 25 30 35
  32
適的展開法，如此就可以充分利用各項演算法的優點，互相搭配運用達到最佳的相位展
開效果。 
(3)區塊間互相獨立 
由於是經過分割後再個別做相位展開，所以各個區塊是獨立的，就算有某一區塊在
做相位展開時有錯誤的搬移或是發散的情況，也只會侷限在該區塊內，不會影響其他區
塊的相位展開，因此能夠隔離問題區塊再做後序處理。 
當各個區塊都展開完畢之後的接合動作，一般是採用「路徑相依」的接合方式，主
要在選定一個積分路徑 C，在這路徑中每一個區塊與此路徑前一個區塊作比較，若相鄰
兩邊上「平均的相位差絕對值」大於 π，則此區塊就必須做搬移的動作（全區加或減
2nπ）。如此一來當積分路徑佈滿整張原始的相位圖時，則完成了區塊接合的動作。但
若所選擇的積分路徑穿過有不連續現象存在的邊界，就會像「路徑相依型相位展開法」
一樣發生接合錯誤向後傳遞的情形。 
 
4.2.3 新式「路徑獨立型」區塊接合邏輯 
為改進「路徑相依型」區塊接合方法會發生接合錯誤向後傳遞的情形，本實驗室提
出一個新式的「路徑獨立型」區塊接合邏輯。首先，在傳統區塊接合技術中比較區塊 2nπ
間的差值是由相鄰區塊邊上相減而得，計算相鄰像素（Pixel）的差值等於在求兩點間的
斜率（一次微分），在有雜訊的情況下，微分的動作會使雜訊的影響放大；且因兩邊的
相位是由各自所屬的區塊所展開，又區塊間是互相獨立，所以兩邊的相位除了「相位展
開結果為連續面」的假設外是沒有相關性的。 
所以我們重新調整區塊分割的方式，將區塊和區塊間留有一小部份重疊的區域，以
下圖 2-5 說明 
20
20
20
20 20 20
1
1
11  
圖 2-5 區塊分割的重疊區域示意圖 
 
假設一包裹相位圖的大小是 60×60，我們以 20×20 大小的單位區塊將其分割為 3*3
個區塊，但在做相位展開處理時，我們會將區塊的右邊和下邊各延伸一個圖元，形成 21
×21 的區塊，這個延伸的部份（斜線區域）就是所謂重疊區域(Overlap)。 
這樣一來，在區塊各自相位展開之後，就可以從重疊區域處的資料比對得知相鄰區
塊間的關係。因為是比對「同一位置」和「由不同包裹相位圖的展開結果」，如此一來
就解決了上述的雜訊影響和邊界相關性的問題。 
  34
利用(2-11)~(2-14)式，比對重疊區域區，計算區塊間最佳的 2π 搬移量（Δ）和區塊
間可靠度權值（ RW ）。 
(3)從最大可靠度的區塊進行接合 
選取區塊間可靠度權值（ RW ）最大的相鄰區塊作為本次所要接合的兩區塊；將此
相鄰的兩區塊依(2-11)式計算所得的區塊搬移量Δ進行搬移並接合。接合後視為同一區
塊。 
(4)判斷是否仍有未接合的區塊 
若尚有未接合的區塊，則回到步驟(3)進行下一次的接合，直到所有區塊均接合在一
起為止。 
從以下圖示可說明路徑獨立型接合過程，上述的區塊接合技術以區塊分割時所預留
的重疊處作為兩區塊間接合可靠度的判斷標準，如此一來可以避免路徑相依型區塊接合
技術所會造成的錯誤搬移沿著路徑相後傳遞的缺點，以此方法亦可將相位展開時出問題
區塊，例如錯誤搬移沿路徑相後傳遞、發散和 Minimum LP-Norm 相位展開不完全等問題
區塊的可靠度權值，壓抑在較低的值，這樣就可在區塊接合後得到較佳的整場相位展開
結果。 
 
 
80
0
10
20
30
40
50
60
70
800 10 20 30 40 50 60 70  
80
0
10
20
30
40
50
60
70
800 10 20 30 40 50 60 70  
(a) 有形貌不連續線之包裹相位圖  (b)分割區塊展開結果 
                 
    0   0  0     
0 0 0 0 
    0   0  0     
0 0 0.2 0.3 
    0   0  0     
0 0 0 0 
    0   0  0     
  36
80
0
10
20
30
40
50
60
70
800 10 20 30 40 50 60 70  
(f)區塊接合結果 
圖 2-6 區塊接合過程 
4.2.4 無雜訊與低雜訊形貌不連續線的搜尋方式 
當相位分佈圖上的某一點與其相鄰點之間，相位差的絕對值大於 π 時，我們稱這
一個像素點為跳躍點(Jump Point)；其所代表的意義為此像素點可能有產生包裹效應，因
此可能需要給予其適當 2π 倍數的移動。 
由跳躍點所連接而成的區域，會在相位圖中約略形成數條粗細不等的線段；而這些
線段稱之為跳躍線(Jump line)。正確的跳躍線必須與相位圖的邊界或是與自己本身形成
一個封閉的迴路，使得相位分佈圖被切割成若干個區域；而對區域型相位展開技術而
言，通常視這些單一區域內的所有像素具有相同的性質。 
    為了方便我們能清楚的用肉眼來判讀跳躍線。因此我們使用了一個稱為“水管圖＂
的介面。 
 
4.2.4.1 基本水管圖 
首先，我們在相位圖上找出相鄰兩點，其相位差差值等於 π 的點。然而實際應用
上，我們希望定位的是兩點間的邊界上，而不是在兩點上面。故在程式上，我們把原本
一個像素代表一個點，放大成 4×4 像素代表一個點，並且把每個 4×4 單位像素中，右邊
由上到下；下邊由左到右，分別獨立出垂直和水平三格像素，做為標記使用。 
若左邊像素點的值減去右邊像素點的值取絕對值後大於 π，則在垂直三格像素上標
記。上邊像素點的值減去下邊像素點的值取絕對值後大於 π，則在水平三格像素上標記。 
如圖 2-7 所示。 
  38
 
（a）左右水管圖                           (b)上下水管圖 
圖 2-8 水管方向標示說明 
 
圖 2-8(a)裡 1 號像素的值減 2 號像素的值大於 π，3 號像素的值減 2 號像素的值大
於 π，即 2 號像素是相對低點，1 號和 3 號像素是相對高點；圖 2-8 (b)裡 4 號像素的值
減 1 號像素的值大於 π，4 號像素的值減 7 號像素的值大於 π，即 4 號像素是相對高點，
1 號和 7 號像素是相對低點。 
 
 
(a)包裏相位圖 
  40
(a)原始相位圖                  (b)門檻值為 0.3 之水管圖 
圖 2-10 門檻值調整型水管圖說明 
 
其中值為 3 線段代表差值大於 1.3π 之跳躍線；而值為 2 線段代表差值為 π～1.3π
之跳躍線；值為 1 線段代表差值為 0.7π~1.0π 之跳躍線。將包含形貌不連續線的包裏
相位圖以門檻值調整型水管圖表現並只取 Fuzzy Zone 的部分時，形貌不連續線線段亦會
隨著門檻值變大而增加。形成斷斷續續的形貌不連續線線段。如圖 2-11 所示 
(a)含形貌不連續線包裏相位圖     (b)門檻值為 0.3 之水管圖 
  42
 
 
  (a)為圖 4-5(a)在座標 Y=39 的剖面上其值分佈 
 
     (b)為圖 4-5(a)在座標 Y=40 的剖面上值分佈 
 
 
  (c)為(b)減(a)圖的結果，即形貌不連續線上下區域間的差值分佈 
圖 2-12 形貌不連續線兩側區域間差值分佈 
  44
圖 2-14 可偵測 2π整數倍相位差值水管圖局部示意圖 
 
 
( )( , ) , 1
( , )
2 x
p i j p i j
round C i jπ
⎡ ⎤− + =⎢ ⎥⎢ ⎥⎣ ⎦
 (2-15) 
( )( , ) 1,
( , )
2 y
p i j p i j
round C i jπ
⎡ ⎤− + =⎢ ⎥⎢ ⎥⎣ ⎦
 (2-16) 
 
圖 2-15 可偵測 2π 整數倍相位差值水管圖 
因此我們可以由此觀察含有形貌不連續現象之相位圖在做區塊接合的動作時，會導
致在含有形貌不連續現象的區塊會有一半部分會產生錯誤搬移而產生的跳躍線之平
移，我們將從這個現象中，藉由四區塊環繞偵測不連續點和可偵測 2π 整數倍相位差值
之水管圖去找出形貌不連續的分岔點的分佈情形。 
 
 
4.2.5.1 四區塊環繞不連續點偵測 
這個想法是來自於四點環繞不連續點偵測，如圖 2-16 及式子(2-17)所示，其中 Round[ ]
為取最接近之整數。如果 ( ) 0, =jir 稱之連續點；反之 ( ) 1, =jir 或 ( ) 1, −=jir ，稱之不連
續點，亦可稱為正極或負極。一般在四點環繞檢測找到不連續點時，以標示四點中的左
上點為不連續點。現在將點對點環繞換成區塊對區塊環繞來偵測不連續點，如圖 2-17
及式子(2-18)所示，演算法如下 
(1)找出區塊與區塊相鄰邊界每點之符合不連續點偵測之法則，若多數點認定此兩區塊是
否有 2π 的整數倍之差值，若有的話以多少整數倍之值表示，至於正負號依照四點環繞
  46
 
圖 2-17 四區塊環繞偵測不連續點區域位置 
 
(1,3)
 
(1,5) 
 
(3,3)
 
(1,1) 
 
(3,1) 
 
(3,5) 
 
 
(3,4)
 
(1,4)(1,2) 
 
(2,5) 
 
(2,2) 
 
(2,3)
 
(2,4)
 
(2,1) 
 
(3,2) 
 
( 1 , 1 ) 
 
( 1 , 2 ) 
 
( 3 , 1 ) 
 
( 3 , 3 ) 
 
( 1 , 3 ) 
 
( 3 , 2 ) 
 
( 2 , 2 ) 
 
( 2 , 1 ) 
 
( 2 , 3 ) 
 
( 2 , 4 ) 
 
( 3 , 4 ) 
 
( 1 , 5 ) 
 
( 1 , 4 ) 
 
( 2 , 5 ) 
 
( 3 , 5 ) 
依矩陣位置來對照區塊不連續點 
  48
(2)假如掃瞄的像素值為 1 時，有以下四種情況 
a.假如像素值之左邊與上邊相鄰之像素值僅有一個有編號，則   
像素值取有編號的值。 
b.假如像素左邊與上邊都有相同的編號，則像素值則選擇兩者之一。 
c.假如像素左邊與上邊有不同之編號，則像素值選擇上邊之編號，且輸入上邊與左
邊之編號為等值，建立等值表。 
d.若不是以上三種情況的話，給予新的編號且輸入到等值表中。 
(3)假如還有更多像素值要考慮，再回到步驟(2)。 
(4)找出等值表中等值的編號裡的最小編號。 
(5)掃瞄影像，以每個等值的編號裡的最小編號取代等值編號的每個編號。 
依據面積大小和區塊不連續點濾除雜訊所產生之跳躍線，當對一張區塊個別相位展
開且接合的相位圖做不同差值之水管圖，可以觀察到雜訊所產生之跳躍線像素的面積與
因為區塊有形貌不連續線所造成區塊一邊接對，另一邊產生錯誤搬移所產生之不同差值
之跳躍線像素的面積來說小很多，因此可以濾除小面積的跳躍線像素而留下我們要觀察
之水管圖，另外我們也將區塊不連續點擬合之曲線通過之區塊的水管圖不做考慮的動
作，因此可以有效找出因形貌不連續線造成區塊有一邊搬對一邊搬錯的現象產生之可偵
測不同相位差值水管圖。 
 
4.2.5.3 路徑追蹤 
由於區塊接合的概念無論如何都會把所有區塊接起來，也就是無論整張圖區塊都接
對或部分接錯接錯，而整張圖都接對的情形主要是處理連續面之包裹相位圖，在做區塊
接合的時候也不會發生問題，除了雜訊量高到某個程度，這是任何一種方法都無法處理
的，所以也不予已討論。目前有困難的部分是本身有形貌不連續線的包裹相位圖的部
分，因為接合的過程沒辦法有一些依據去做辨視是否此區塊為含有不連續面的包裹相位
圖的情況，所以全部還是會接起來，只是路徑獨立型區塊接合的特性會把沒問題的部分
先接起來，所已有問題的部分都留在最後去接，所以最後接錯的部分也只會侷限在局部
區塊，一般來說，接錯的部分會沿著形貌不連續線有經過的區塊而產生一邊接對一邊多
做一個錯誤的搬移，所以從這裡可以發現一個現象就是就是水管圖的跳躍線會從相位圖
的邊界開始依據區塊大小的邊界延伸一條路徑到某一個頭的部分，而此頭的位置即為形
貌不連續的分岔點，而身體的部分中也有形貌不連續的分岔點的位置，即是由可偵測不
同相位差值水管圖交界的部分也是形貌不連續的分岔點。所以我們利用這個特性，訂出
一個搜尋路徑的法則，找出形貌不連續的分岔點的位置。 
路徑追蹤演算法分成幾個步驟 
(1)由可偵測不同相位差值水管圖先把編號為 1 的邊界起使位置找出，再去搜尋 
路徑終點，即為形貌不連續的分岔點。 
(2)由不同差值水管圖先把編號為 1 的去除，再搜尋邊界起使位置。 
(3)因為水管圖的跳躍線不是橫的就是直的，由起始點依序搜尋相鄰四點找出下一點，把
不同 2π整數倍相位差值的交接點找出直到沒有下一點停止。 
(4)把編號 1 的水管圖放進來，看交接點的部分是否還有與編號 1 相連，有的話從交接點
  50
( )
0
T
T T
E E
X XA X Y
A
∂ = ⇒ =∂  (2-21) 
1( )T TA X X X Y−=  (2-22) 
即可求得擬合之曲線方程式。因此可以將形貌不連續線的分佈情形訂出位置來，如圖
2-20。 
80
0
10
20
30
40
50
60
70
800 10 20 30 40 50 60 70  
圖 2-20 曲線擬合示意圖 
4.2.5.5 搬錯區域做搬移量修正 
將可偵測 2π 整數倍相位差值水管圖與與擬合之曲線所封阻的每個封閉區域作物件
編號的動作，如圖 2-21 所示，而小區域的部分即是要去比對大區域與小區域相接的邊界
水管圖的編號，依照編號做小區域搬移的動作，達到修正的目的，如圖 2-22 所示。 
82
0
10
20
30
40
50
60
70
820 10 20 30 40 50 60 70  
圖 2-21 分區物件編號 
  52
 
  54
 
3.2  面外位移量測 
  
圖 3-2 面外位移架設 
 
面外位移架設如圖 3-2 所示，雷射光經過分光鏡分成兩道光，一道經過空間濾波器打在
物體上反射回 CCD(物光)，一道經過空間濾波器後打在毛玻璃作參考光斑，在經由分光
鏡反射回 CCD。 
 
3.2.3 動態 ESPI 之干涉原理 
在待測物上利用函數產生器輸出穩態正弦訊號，透過功率放大器放大後提供給激振片適
當的激振訊號，並藉由激振片與待測物上的黏結，將振動訊號不斷的傳到待測物上，但
由於 CCD 在取像時間內會不斷累積物體在不同時刻之振動影像的電子訊號，因此可視為
直接對影像相加再取平均，即為採用均時法 (Time-average Method)。而檢測物體振動
模態分為兩種作法：（a）傳統相減（b）振幅變動法。分述如下： 
（a） 傳統相減法 
此法是在物面未受任何擾動時以相機取下一張參考影像，則可得成像面上某一點的光強
1I ，當物面達到共振時，於振動中再取下一張影像，則物光光程差會造成之相位變化量
為而成像面上某一點在 CCD 相機曝光時間內所得的光強積分值 2I 隨著振幅增加，亮度漸
漸增加至最亮，為第一級亮紋。振幅繼續增加亮度又漸漸減小到達第一級暗紋。依此類
CCD Camera
Mirror
Mirror
Object
Spatial
filter
1U
2U
Computer
Beam
splitter
Bitflow
Ground glass
He-Ne Laser
Spatial
filter
Beam
splitter
  56
 
圖 3-4  亮度分布所呈現的波包為 ( )AJ Γ0  
  
 
(a)                                    (b) 
圖 3-5 相減法與振幅變動法之實驗圖比較(a)相減法(b)振幅變動法 
 
3.2.4 相移干涉術應用於振動模態條紋及相位展開技術之簡介 
由於干涉條紋圖為一張光強圖，所需要變形之相位 ),( yxφΔ 隱藏於光強圖中，所以需要相
移干涉術（Phase-shifting interferometry，簡稱 PSI）將所須知相位求出。其基本之
原理為改變參考光之光程差，再配合公式之組合將所須相位求出。 
相移技術的表示式 
一般可以將干涉條紋的光強分佈表示如下： 
  58
圖 3-6 單張相移法消除直流項 ( )AJIII Ro Γ= 0cos4 φ  
圖 3-6 即為將兩張相位差為π 振動影像相減所得之模態條紋圖，直流項已被消除，但其
高頻雜訊 φcos 依舊存在，我們可以再進一步利用四步相移的方式消除高頻雜訊，藉以
得到對比更好的模態條紋 33。 
 
圖 3-7 四步相移法消除高頻雜訊 ( )AJIII Ro Γ= 04  
3.2.5 相位展開技術之簡介 
詳細介紹了經由相位移法求解相位值的過程，但是經由相位移法而求得的相位值都是以
反正切函數為基礎，而計算出來的相位會被侷限在
2
π− ～
2
π 之間 (以π 為週期)，這稱
為πmodulus。由於反正切函數之分子分母的正負號分別對應了 φsin 和 φcos 之正負
號，然而正弦，餘弦是以 2π為週期的連續函數。因此可藉由反正切函數的分子分母之
正負別來判別相位中的象限所在其相位分布於 π− ～π 之間 (以 2π 為週期，又稱為 2π
modulus)，所以用相位移法初步求得的相位是錯誤的，而必須將其轉到 2πmodulus，這
時就可藉由反正切函數中之分子和分母的正負關係來判斷相位值所在之象限而真實相
位判別表可以將πmodulus 的 wrapped 轉到 2πmodulus，接下來就需要相位重建技術
(phase unwrapping method)將這些落差移除而得到真實的相位圖。 
3.2.6 動態 ESPI 之模態重建技術 
實驗架設 
由上述振動光強的公式可以得知，跟一般靜態 ESPI 最大的不同就是，亮度分布所呈現
的波包是由 0J 所調變，所以並沒有辦法如同一般靜態 ESPI 利用相移求得其相位圖。所
以必須借用其他的方式來造成 0J 條紋的偏移，達成跟之前做靜態 ESPI 相移時同樣的效
果。在實驗架設上，在物光路徑上必須要有可以隨待測物當時同樣的頻率下同步振動的
裝置，在本論文中是在物光路徑上之反射鏡由 PZT 來驅動再由訊號產生器將振動訊號同
軸接 PZT 使其產生相同頻率的振動，其目的就是為了讓當時的模態條紋能夠像靜態 ESPI
相移時一樣產生條紋偏移的效果實驗架設如圖 3-8： 
 
  60
          
 
(a)                                    (b) 
 
 
(c) 
圖 3-10 (a)相位圖之 π2 modulus (b)相位重建結果(c)相位圖之剖面圖 
 
假設其振動模態為一平面，之後套用先前所說明之偏壓理論，經由相移跟相位還原得到
最後之整場模態，如圖 3-10 中(b)為相位重建的結果，由於是模擬一振動平面，所以可
以得知其當時其全場的振幅的理論值，如圖 3-11 中之 c線即為此一模擬振動平面，我
們可以由圖 3-10(c)看到相位圖其實並不為一完美的 π2  modulus，所以使的其重建結果
並不為一完好的平面如圖 3-11。圖中縱軸為其對應的振幅，b則為經相位還原的結果，
所以之後以此相位還原結果與理論值作比較，如下圖： 
 
  62
 
圖 3-12 Bessel 與 Cosine 之間的關係 
 
實驗圖之誤差修正 
此以實際所量測得到的懸臂樑鋁片的第一模態條紋來做說明，以下所呈現的模態條紋都
是選擇靈敏度較高的振幅變動法來量測懸臂板的振動模態。為驗證量測結果的可靠度，
所以先使用 ANSYS 來模擬出其模態的趨勢，只要目的是為了驗證實驗結果的正確性。 
 
 
 
圖 3-13 懸臂樑之第一模態圖 f=155Hz 
  64
表 3-1 未修正之暗紋處實驗值與理論值比較 
 理論值( mμ ) 實驗值( mμ ) 
第一暗紋 0.17 0.19 
第二暗紋 0.33 0.75 
第三暗紋         0.51 1.15 
第四暗紋 0.69 1.55 
第五暗紋 0.87 1.98 
 
 
表 3-2 修正過後暗紋處之理論值與實驗值比較 
 理論值( mμ ) 修正後之實驗值
( mμ ) 
誤差(%) 
第二暗紋 0.33       0.34      3.03 
第三暗紋       0.51       0.49      3.92 
第四暗紋       0.69       0.67      2.88 
第五暗紋       0.87       0.84      3.15 
 
  
圖 3-14 即為其第一模態條紋及其相位重建之後之全場振幅示意圖，而全場振幅的計算
是由經相位展開之後所得到的相位圖根據 ( )θλ
π cos12 +=Φ A 所換算而來，其中依實驗架
設 ο40=θ 。表 3-1 即為實驗所得之全場暗紋處振幅的實驗值，由圖中可以發現除了第一
暗紋處之實驗值振幅較為接近理論值之外，其餘暗紋處也約成一比例關係，此比例關係
就是由正確值與實驗值所求得。實驗值就是由 Bessel 近似於 Cosine 之後所造成不正確
的振幅分布。而正確值是已知的，所以之後只要求得正確值與實驗值之間的比例之後將
其還原回去就可以得到正確的振幅分布。修正完的結果如表 3-2，由於在第一暗紋處由
先前可以知道其理論值與實驗值振幅不會相差太多，所以在表 3-2 處只呈現第二暗紋處
之後修正的結果。表 3-1 跟 3-2 理論值是由數值法所求得其暗紋位置的振幅的理論數值，
之後比較其暗紋位置跟實驗所得之暗紋位置處的振幅比值，發現其各個暗紋位置的比值
都非常接近，所以之後只需將整場的振幅依此比例，即可修正為正確的分布。。圖 3-16
即為修正前跟修正後之曲線示意圖，其中 b 為修正之後的分布，由先前表 3-2 可以發現
其誤差大約都在百分之三附近。之後其餘各個模態都可以由這種方式找到各級亮暗紋的
振幅實驗值，之後再跟理論值去做比較，經由此方法最後就可以得到其正確的分布。 
圖 3-14 即為其第一模態條紋及其相位重建之後之全場振幅示意圖，而全場振幅的計算
是由經相位展開之後所得到的相位圖根據 ( )θλ
π cos12 +=Φ A 所換算而來。實驗值就是由
Bessel 近似於 Cosine 之後所造成不正確的振幅分布。而正確值是已知的，所以之後只
要求得正確值與實驗值之間的比例之後將其還原回去就可以得到正確的振幅分布。圖
3-16 即為修正前跟修正後之曲線示意圖，其中 b為修正之後的分布，由先前表 3-2 可以
發現其誤差大約都在百分之三附近。之後其餘各個模態都可以由這種方式找到各級亮暗
  66
              
(a)                                      (b) 
 
 
(c) 
圖 3-18 利用偏壓所得模態條紋之全場位移圖 (a)相位圖 (b)相位重建結 
果 (c)全場三維之位移圖 
 
 
圖 3-19 利用 ANSYS 模擬之三維模態示意圖 
 
圖 3-17 為懸臂樑之模態圖，其頻率為 613HZ，圖 3-18(a)(b)為經偏壓調制所得到
的相位圖和其相位重建結果，由 3-18(c)跟圖 3-19 去比對其趨勢，其實驗結果與軟
體模擬結果大致吻合。修正方式也如同上一個模態，由 Bessel 近似為 Cosine 所得
到的實驗值跟實際上的正確值之間會隨著偏壓的不同成一個固定的比例，一樣求得
其比例之後就可以得到最終的正確振幅分布。修正完的結果如圖 3-20。 
  68
                
 
(a)                                      (b) 
 
(c) 
圖 3-22 利用偏壓所得之模態條紋之全場位移示意圖 (a)相位圖 
(b) 相位重建結果 (c)全場位移圖 
 
 
 
圖 3-23 利用 ANSYS 所模擬之模態圖 
 
圖 3-21 為懸臂樑第三模態圖，其當時共振頻率為 1051Hz，利用偏壓所得到的相位圖及
其相位還原結果在圖 3-22，圖 3-24 為模態修正結果。但是由圖 3-21 可以發現在靠近自
由端附近其模態條紋有稍微扭曲的情形，可能是因為實驗所使用的皆為薄版結構試件，
所以比較容易受到外力的作用而產生變形，並且造成試件內出現殘留應力的情況，同時
也會使得系統內彎矩不平衡，還有這些結果可能也與激振片黏附在試件上的位置有關，
但由於激振片若黏附在固定端或者是太接近中心線附近都會造成不易激振的結果，所以
  70
4.1 SAR (Synthetic Aperture Radar)部份 
我們知道衛星雷達天線越長，對地物的觀測分辨率就越高。而合成孔徑雷達通常利
用雷達與目標間的相對運動，將雷達在每個不同位置上接收到的目標回波信號進行處
理，就相當於在空中安裝了一個“大個＂的雷達，這樣小孔徑天線就能獲得大孔徑天線
的探測效果，具有很高的目標方位分辨率，再加上應用脈衝壓縮技術又能獲得很高的距
離分辨率，因而能探測到隱匿目標。 
 
圖 4-1 ＳＡＲ示意圖（圖片來源：http://www.sandia.gov/radar/whatis.html） 
 
因為合成孔徑雷達的特點具有分辨率高，遠距離成像，能全天候全天時工作，能有
效地識別偽裝和穿透掩蔽物。所以在軍事上和民用領域都有廣泛應用，如戰場偵察、導
航、資源勘測、地圖測繪、海洋監視、環境遙感等。 
合成孔徑雷達經過４０多年來的發展，已經成了一種通用的偵察和目標瞄準方法。
目前，許多新的ＳＡＲ應用仍在研究之中。而近十年來，干涉式合成孔徑雷達技術
（Interferometric Synthetic Aperture Radar，ＩＮＳＡＲ）已成了一個新的研究焦點，這代
表了ＳＡＲ的一個新的發展方向。前面所提的ＳＡＲ得到的成像為二維圖像；而採用Ｉ
ＮＳＡＲ技術則可得到目標的三維測量圖像。獲得干涉式ＳＡＲ數據的方式有兩種：一
為使用同一載具同一天線做重複軌跡的運動來取得；二是同一載具同時使用兩個天線來
取得干涉的資料。 
隨著ＳＡＲ圖像的分辨率越高，包含在接收雷達信號中的信息量就越大。為了開發
從圖像中取得信息的必要技術，對圖像的認識和理解是很重要的。 
ＩＮＳＡＲ圖像經處理（圖 4-2）後，所得到的相位圖（圖 4-３a），會有所謂的Ｗ
ＲＡＰ現象。表現在相位圖上則形成一圈一圈的等相位曲線。而把這樣的相位圖還原成
正確的相位圖（圖 4-３b）的技術，即為相位還原技術（ＵＮＷＲＡＰ）。而還原相位的
難度在於如果有雜訊、地物變遷等破壞干涉的情形出現，則會有部份區域難以計算。 
  72
 
 
（圖 4-３a）Phase image computed from an ERS-1 interferometric image pair taken at Fort 
Irwin, California.      
 
（圖 4-３b）Unwrapped phase computed from Fig. 3.5-3a  
（來源：[4-1] Two-dimensional phase unwrapping with minimum weighted discontinuity） 
  74
 
（圖 4-４c）Unwrapped phase of the Sardegna ERS-1 interferogram using the cut line algorithm. 
 
（圖 4-４d）Difference between the unwrapped phase of the region-growing algorithm and cut line 
algorithm with a fit to the upper middle portion. （來源：[4-4] A Region-Growing Algorithm for 
InSAR Phase Unwrapping） 
 
  76
4.2 MRI (Magnetic Resonance Imaging)部份 
MRI 的 three-point Dixon reconstruction water and fat (lipid) 流程中的由於相位影像會被
侷限在π ~ π− 之間，被稱為 wrapped phase。 
 
(a) wrapped phase 
 
(b) Water 
 
(c) Lipid 
圖 4-6 (a) wrapped phase, (b) water, (c) lipid. 
 
  78
圖的完整切正確的分離圖 
以上資料來源：Dixon Reconstruction and Phase Unwrapping 
網址 http://www.stanford.edu/class/ee369c/dixon_recon.pdf 
 
 
Ⅰ             Ⅱ            Ⅲ             Ⅳ
(a)  
(b)  
圖 4-8 MRI 應用在血液速度的觀察 
 
上圖為 MRI 應用在血液速度的觀察上，我們可以看到上排(a)部分為 Wrapped phase，經
過 phase unwrap 後得到的相位還原圖 
以上資料來源：IEEE TRANSACTIONS ON MEDICAL 
IMAGING/VOL.21,NO.8,AUGUST 2002”Understanding Phase Maps in MRI: A New 
Cutline Phase Unwrapping Method” 
  80
AUGUST 2000“ A Fast Implementation of the Minimum Spanning TreeMethod for 
Phase Unwrapping” 
五、結果與討論 
5.1 模擬相位測試結果  
    在模擬相位進行參數的設定，雜訊 N 的單位為徑度(Rad)，若 N 設為「2」，則產生
的雜訊為均勻分佈於 -2～2 間的 Random 值。 
 
A. 模擬水平單邊切雜訊 N=2 
    此為模擬相位本身帶有單邊水平方向的形貌不連續，並且含有雜訊值為 2 的包裹相
位圖。使用本論文所提出的方式做相位展開，展開過程與結果如圖 5-1(a)至(j)所示。 
 
 
(a)                           (b) 
 
(c)                           (d) 
  
(e) (f) 
  82
(c)                         (d) 
 
(e) (f)  
    
(g)                           (h) 
 
(i)                           (j) 
圖 5-2 模擬斜切二次曲面測試：(a)模擬斜切二次曲面；(b)模擬斜切二次曲面相位圖；(c)
各區塊展開後結果；(d)各區塊展開後曲面擬合結果；(e)擬合誤差；(f)參考區塊(g)參考點；
(h)擬合曲線；(i)區塊接合後結果；(j)修正結果 
  
C. 模擬曲線切雜訊 N=2 
    此為模擬相位本身帶有左上至右的曲線形貌不連續，並且含有雜訊值為 2 的包裹相
位圖。使用本論文所提出的方式做相位展開，展開過程與結果如圖 5-3(a)至(j)所示。 
 
  84
圖 5-3 模擬曲線切測試：(a)模擬曲線切；(b)模擬曲線切相位圖；(c)各區塊展開後結果；
(d)各區塊展開後曲面擬合結果；(e)擬合誤差；(f)參考區塊；(g)參考點；(h)擬合曲線；
(i)區塊接合後結果；(j)修正結果 
 
D. 模擬弦波切雜訊 N=2 
    此為模擬相位本身帶有一類似正弦曲線的形貌不連續，並且含有雜訊值為 2 的包裹
相位圖。使用本論文所提出的方式做相位展開，展開過程與結果如圖 5-4(a)至(j)所示。 
 
(a)                          (b) 
 
(c)                          (d) 
  
(e) (f) 
    
(g)                           (h) 
  86
 
(d)                           (e) 
   
(f) (g) 
  
(h)                           (i) 
圖 5-5 ESPI 面外量測實驗圖：(a)斜切實驗圖；(b)各區塊展開後結果；(c)各區塊展開後
曲面擬合結果；(d)擬合誤差；(e)參考區塊；(f)參考點；(g)擬合曲線；(h)區塊接合後結
果；(i)修正結果 
 
F. 水平切實驗圖 
    此為待測物本身帶有由左至右的水平方向形貌不連續，使用本論文所提出的方式做
相位展開，展開過程與結果如圖 5-6(a)至(i)所示。 
 
(a) 
  88
 
(a) 
 
              (b)                               (c) 
  
             (d)                                (e) 
    
             (h)                                (g) 
 
(i)                                 (j) 
  90
A  模擬一（形貌不連續曲線）無雜訊 
80
0
10
20
30
40
50
60
70
800 10 20 30 40 50 60 70
(a)包裹相位圖                  (b)區塊環繞偵測區塊不連續點 
80
0
10
20
30
40
50
60
70
800 10 20 30 40 50 60 70
(c)不同編號水管圖              (d)曲線擬合 
  92
80
0
10
20
30
40
50
60
70
800 10 20 30 40 50 60 70
(a)包裹相位圖                  (b)區塊環繞偵測區塊不連續點 
80
0
10
20
30
40
50
60
70
800 10 20 30 40 50 60 70
(c)不同編號水管圖              (d)曲線擬合 
82
0
10
20
30
40
50
60
70
820 10 20 30 40 50 60 70
80
0
10
20
30
40
50
60
70
800 10 20 30 40 50 60 70
  94
 
80
0
10
20
30
40
50
60
70
800 10 20 30 40 50 60 70  
(c)不同編號水管圖               (d)曲線擬合 
 
82
0
10
20
30
40
50
60
70
820 10 20 30 40 50 60 70  
80
0
10
20
30
40
50
60
70
800 10 20 30 40 50 60 70  
(e)區域物件編號                 (f)未修正之相位展開圖 
80
0
10
20
30
40
50
60
70
800 10 20 30 40 50 60 70  
(g)修正後之相位展開圖 
  96
80
0
10
20
30
40
50
60
70
800 10 20 30 40 50 60 70
(c)不同編號水管圖              (d)曲線擬合 
82
0
10
20
30
40
50
60
70
820 10 20 30 40 50 60 70
80
0
10
20
30
40
50
60
70
800 10 20 30 40 50 60 70
(e)區域物件編號                (f)未修正之相位展開圖 
80
0
10
20
30
40
50
60
70
800 10 20 30 40 50 60 70  
(g)修正後之相位展開圖 
  98
82
0
10
20
30
40
50
60
70
820 10 20 30 40 50 60 70
80
0
10
20
30
40
50
60
70
800 10 20 30 40 50 60 70
(e)區域物件編號                (f)未修正之相位展開圖 
80
0
10
20
30
40
50
60
70
800 10 20 30 40 50 60 70  
(g)修正後之相位展開圖 
圖 5-12 相位展開處理過程圖(n=1.0) 
 
  100
80
0
10
20
30
40
50
60
70
800 10 20 30 40 50 60 70  
(g)修正後之相位展開圖 
圖 5-13 相位展開處理過程圖(n=2.0) 
圖 5-4、圖 5-5 與圖 5-6 三張圖可以發現圖在不連續線的部分變成鋸齒狀，這個原
因是因為寫程式的過程，在水管圖與擬合曲線轉換成相位圖造成部分相位值的流失，所
以會產生鋸齒狀的現象，這個部分是有改善的空間，邏輯判別需要再做修正。同樣的，
在雜訊 2.0 時，因為雜訊的影響會產生分岔點的偏移，所以曲線擬合的結果已經沒有這
麼直了，所以最後修正的結果效果也會比較差。 
C  模擬三（垂直形貌不連續線） 
80
0
10
20
30
40
50
60
70
800 10 20 30 40 50 60 70
80
0
10
20
30
40
50
60
70
800 10 20 30 40 50 60 70
(a)包裹相位圖                   (b)區塊環繞偵測區塊不連續點 
  102
(g)修正後之相位展開圖 
圖 5-14 相位展開處理過程圖(n=0) 
 
 
80
0
10
20
30
40
50
60
70
800 10 20 30 40 50 60 70
80
0
10
20
30
40
50
60
70
800 10 20 30 40 50 60 70
(a)包裹相位圖                   (b)區塊環繞偵測區塊不連續點 
80
0
10
20
30
40
50
60
70
800 10 20 30 40 50 60 70
(c)不同編號水管圖              (d)曲線擬合 
  104
80
0
10
20
30
40
50
60
70
800 10 20 30 40 50 60 70
80
0
10
20
30
40
50
60
70
800 10 20 30 40 50 60 70
(a)包裹相位圖                  (b)區塊環繞偵測區塊不連續點 
80
0
10
20
30
40
50
60
70
800 10 20 30 40 50 60 70
(c)不同編號水管圖              (d)曲線擬合 
82
0
10
20
30
40
50
60
70
820 10 20 30 40 50 60 70
80
0
10
20
30
40
50
60
70
800 10 20 30 40 50 60 70
  106
  
  (c)修正後之相位展開圖          (d)展開結果的三維視圖 
圖 5-17 相位展開修正之實驗圖 
E  問題與討論 
經過模擬分析，我們可以歸納出三點來討論 
(1) 分岔點的多寡是由形貌不連續線兩側的曲面斜度來決定，斜度差異愈大這個現象愈
明顯，當斜度差異不明顯時候，就會產生點數不足的問題，所以在無雜訊及低雜訊情況
下，可藉由門檻值調整型水管圖來增加點數，高雜訊的部分可由門檻值調整四點環繞搜
尋更多點的概念去突破，幫助擬合的結果更加正確。 
(2) 若分岔點受到雜訊太大影響會導致分岔點稍微偏移，所以曲線擬合的結果會有點偏
差。 
(3) 修正的過程因為程式的問題導致修正的區域有些像素值沒有一起搬移，所以會造成
形貌不連續線變形的原因，所以程式尚須要修改，改進修正的部分。 
雖然可以找到一些形貌不連續的分岔點，可以擬合出一個近似結果，不過缺點是點
數不夠多，擬合的結果未必是正確解，這部分應該可以再找一些方式去偵測出形貌不連
續的分岔點，例如水管圖調門檻值或是四點環繞調門檻值的概念，只是門檻值的設定似
乎沒有一個明確的規則性，而且還要克服高雜訊的問題，另外，修正水管圖與擬合曲線
所封阻區域，避免克服一些程式上的問題，所以這些部分還有改善的空間。其實一般處
理的圖形不會太小，因為模擬的關係沒有取太大張圖，所以實際可參考的點數也會比較
多，所以曲線擬合的結果也會比較精確。 
 
5.5 振動模態檢出 
在本計畫中，是利用具有非接觸式，以及可以做全場量測電子斑點干涉術(ESPI)，搭配
本實驗室發展的相位重建技術，來針對所量測到的振動模態條紋做分析，由於振動 ESPI
不同於靜態 ESPI 一樣只需經過相移公式即可求出其相位圖，所以必須搭配偏壓技術，
造成模態條紋偏移，之後才可以如同靜態 ESPI 做相移一般，得到其相位圖，之後經由
200
0
25
50
75
100
125
150
175
2000 50 100 150
  108
參考文獻 
References: 
1. K. Itoh, 1982, “Analysis of the phase unwrapping algorithm,” Applied Optics, 21, 14, pp. 
2470. 
2.  W.W. Macy, 1983, “Two-dimensional fringe-pattern analysis,” Applied Optics, 22, 23, 
pp. 3898-3901. 
3.  D.C. Ghiglia, G.A. Mastin, and L.A. Romero, 1987, “Cellular-automata method for 
phase unwrapping,” JOSA, 4, 1, pp. 267-280. 
4.  H.Y. Chang, C.W. Chen, C.K. Lee, and C.P. Hu, 1998, “The tapestry cellular automata 
phase unwrapping algorithm for interferogram analysis,” Optics and Lasers in 
Engineering, 30, pp. 487-502. 
5.  J.J. Gierloff, 1987, “Phase unwrapping by regions,” SPIE, 818, pp. 2-9. 
6.  J.N. Butters and J.A. Leendertz, 1971, “Holographic and video techniques applied to 
engineering measurement,” Journal of Measurement and Control, 4, pp. 349-354. 
7. H.A.Zebker and R.M.Goldstein, 1986, “Topographic mapping from interferometric 
synthetic aperture radar observations,” Journal of Geophysical Research, 91, 5, 
pp.4993-4999. 
8. F.K.Li and R.M.Goldstein, 1990, “Studies of multibaseline spaceborne interferometric 
synthetic aperture radars,” IEEE Transactions on Geoscience and Remote Sensing, 28, 1, 
pp.88-97.  
9. A.L.Gray and P.J. Farris-Manning, 1993, “Repeat-pass interferometry with airborne 
synthetic aperture radar,” IEEE Transactions on Geosience and Remote Sensing , 31, 1, 
pp.180- 191.  
10. P.H. Eichel , D.C.Ghiglia, C.V. Jakowatz , Jr. , P.A. Thompson , and D.E.Wahl, 1993, 
“Spotlight SAR interometry for terrain elevation mapping and interometric change 
detection ,” Sandia National Laboratories Report , SAND93-2072. 
11. D. Massonnet , M. Rossi , C. Carmona , F. Afragna , G. Peltzer , G. Peltzer , K. Feigl , and 
T. Rabaute, 1993, “The displacement field of the Landers earthquake mapped by radar 
interferometry,” Nature , 364, pp.138-142. 
12. D.C. Ghiglia and P. H. Eichel, 1994, “High-resolution synthetic aperture radar 
interferometry: Techonology for precise terrain elevation mapping,” DSP and Mutimedia 
Technology , 3, 10, October. 
13. 13. D. L. Fried, 1977, “Least-squares fitting a wave-front distortion estimate to an array 
of phase-difference measurements,” Journal of the Optical Society of America, 67, 3, 
pp.370-375.  
14. 14. R.H. Hudgin, 1977, “Wave-front reconstruction for compensated imaging ,” Journal 
of the Optical Society of America, 67, 3, pp.375-378. 
15. 15. R. J. Noll, 1978, “Phase estimates from slope-type wave-front sensors,” Journal of 
the Optical Society of America, 68, 1, pp. 139-140. 
16. 16. G. H. Glover and E. Schneider, 1991, “Three-point Dixon technique for true water/fat 
  110
33. C.Joenathan, “ Vibration fringes by phase stepping on an electronic speckle pattern 
interferometer: an analysis.” APPLIED OPTICS, Vol. 30, No. 32, pp. 4658-4665, 1991 
出席國際學術會議心得報告 
                                                             
計畫編號 95-2221-E-005-093- 
計畫名稱 相位展開技術之整合性最優化研究與應用 
出國人員姓名 
服務機關及職稱 
黃敏睿 中興大學機械系教授 
會議時間地點 2007, Sep., 12-14, 福岡,Japan 
會議名稱 
(中文)2007 年日本實驗力學學會實驗力學國際學術研討會 
( 英 文 )International Conference on Advanced Technology in 
Experimental Mechanics 2007 
發表論文題目 
(中文)具形貌不連續之高雜訊相位圖的相位展開研究 
 (英文)Phase Unwrapping Work for retrieving Noisy Map with Real 
Physical Discontinuity 
 
一、參加會議經過 
本人於 95 年 9月 11 日搭乘國泰航空公司 CX510 班機直飛日本福岡機場 (於當地時間 9月 11
日下午 2045 抵達)。 
9 月 12 日上午赴研討會會場註冊並參加為期三天的研討會。九月 12 日至 14 日，研討會除
Plenary Lecture 外，共分成 18 個 Sessions：(1)Whole-Field Distribution Analysis of 
Displacement and Strain, (2) Experimental Biomechanics at Nano-, Micro- and 
Macro-Scopic Levels (3) Nondestructive Testing and Evaluation (4) Fatigue Failure 
and Its Prevention (5) Micro- and Nano Mechanical Testing, (6) Interfaces and Coatings, 
(7) Trends in Dental, Orthopaedic, Sport and Image Biomechanics, (8) Fluid Mechanics 
and Fluid Engineering, (9) Strain Measurements by Digital Correlation Method, (10) 
Infrared Thermography Measurement Technique and Its Application, (11) Image 
Processing and Its Application to Various Fields, (12) Speckle Method, (13) Dynamic 
behavior of Material and Structures, (14) Modeling of Strength and Fracture of 
Composite Materials, (15) Testing and Evaluation of Mechanical Properties for 
Polymeric Materials, (16) Experimental Analysis of Mechanical Properties in Advanced 
Materials, (17) Sensors and Sensor Network for Adaptive and Smart Structures: 
Challenges and Approaches, and (18) Inverse Problems。共計 320 篇論文；內容包羅萬
象。每天從早上 9時至晚上 6時 (coffee break, lunch time 除外)，同時分別在七個研討
室，每隔二十分鐘一場共約 320 多場的學術論文發表內容最為豐富，因內容相關充實，同一
時間常常同時好幾個發表都與個人研究非常相關。為期三天的研討會，每天上午 9點都有一
場 60~80 分鐘的 Plenary Speech，9 月 12 日當天的專題演講者為 Dr. E. Patterson, 講題
為 Raising Standards in Experimental Mechanics 。個人之論文則於當天(9 月 12 日)上
午於 Session OS01-1 “Whole-Field Distribution Analysis of Displacement and Strain＂ 
中發表，發表時約有四十人在場聆聽，報告完並熱烈討論，結果對全場相位分析領域有一定
