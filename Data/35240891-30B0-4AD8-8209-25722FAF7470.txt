  
 
2
本結案報告書根據各年度之研究成果進行完整之成果報告，並且依各年度之
計畫進行撰寫與統整，詳細目次如下： 
 
一、 研究成果自評表……………………………………………………………… 3 
二、 第一年度研究成果完整報告………………………………………………… 4 
三、 第二年度研究成果完整報告………………………………………………… 17 
四、 第三年度研究成果完整報告………………………………………………… 25 
五、 附件一：本計畫已發表之期刊論文 
六、 附件二：高強健性輸電線保護電驛演算法理論模型論文(已投稿) 
七、 附件三：高強健性輸電線保護電驛演算法硬體平台實作論文(已投稿) 
八、 附件四：98 年度出國參加研討會報告 
  
 
4
 
行政院國家科學委員會補助專題研究計畫█ 成 果 報 告     □期中進度報告 
 
高強健性輸電線保護電驛演算法設計及實作 
 
 
計畫類別：▓ 個別型計畫  □ 整合型計畫 
計畫編號：NSC 96-2628-E-002-252-MY3 
執行期間：96 年 8 月 1 日至 97 年 7 月 31 日 
 
計畫主持人：江昭皚 教授        國立臺灣大學 生物產業機電工程學系  
協同主持人：蕭瑛東 教授        國立臺北教育大學 資訊科學系 
         王永鐘 副教授      國立臺北科技大學 電機工程學系 
 
成果報告類型(依經費核定清單規定繳交)：□精簡報告  ▓完整報告 
 
本成果報告包括以下應繳交之附件： 
□赴國外出差或研習心得報告一份 
□赴大陸地區出差或研習心得報告一份 
□出席國際學術會議心得報告及發表之論文各一份 
□國際合作研究計畫國外研究報告書一份 
 
處理方式：除產學合作研究計畫、提升產業技術及人才培育研究計畫、列管
計畫及下列情形者外，得立即公開查詢 
          ▓涉及專利或其他智慧財產權，□一年▓二年後可公開查詢 
          
執行單位：國立臺灣大學 生物產業機電工程學系暨研究所 
 
中   華   民   國  99  年  8  月  26  日 
 
  
 
6
uncertainties due to the variations of system 
parameters. Therefore, measurement and system 
noises are key factors that can affect the capabilities 
of these methods resulting in high false positives or 
false negatives [9]. For real-world applications, data-
driven approaches may be the most practical ones to 
make a protection system become more robust against 
noise due to their flexibility in implementation and 
adaptability in detecting and classifying faults in 
different systems. Therefore, the data-driven methods, 
such as artificial intelligence techniques, can be 
adapted to different systems with unknown levels of 
measurement and system noises, showing a possible 
solution when designing a protection system. 
Faults that occur in power transmission lines can 
cause interruption of power supply, which leads two 
primary indices of the continuity service of power, 
system average interruption frequency index and 
system average interrupt duration index, to increase 
[10]–[12]. To lower these indices, various methods 
have been proposed to detect, classify, or locate faults 
in power transmission lines in recent years. It is also 
essential to classify the faults and identify which 
phases involved. The features of faults have been 
extracted using various filters, such as fast Fourier 
transforms [13]–[17], Kalman filter [18], fractal [19], 
and wavelet transforms [20]. For example, wavelet 
transforms and artificial neural networks have been 
successfully used to detect and classify faults in 
transmission lines [21]–[23]. A hybrid of wavelet 
transforms and support vector machines have been 
proposed to inspect fault zones in a power system 
[24]. In addition, model-based structural analysis has 
been applied to fault detection and location in power 
systems [25]–[27]. 
Most of the aforementioned works were 
validated via simulation studies, and their actual 
performance tested in a real-world scenario still 
remains unknown. This is because hardware 
implementation of fault protection techniques is rare; 
only a handful of studies reported field testing with 
hardware implementation [28]–[33]. These studies, 
however, accomplished only partial functions of a 
protection system. Moreover, the automation of a 
protection system can be achieved by combining all 
of the functions proposed by these studies in a system, 
but it may run into the problem of time consuming. In 
order to efficiently enhance the automation level of a 
power protection system, the main focus of this study 
is to propose a framework that can be implemented 
using the field-programmable gate array (FPGA) 
technology for real-world scenarios. In this study, we 
present a hybrid framework that consists of a 
symmetrical component analysis for fault detection, a 
multi-level complex wavelet transformation, a 
principal component analysis, a set of support vector 
machines, and adaptive structure neural networks for 
fault classification and fault location. In this year, we 
focus on fault detection and classification. 
II. The Proposed System 
As shown in Fig. 1, the framework is composed 
of three different modules responsible for fault 
detection, classification, and location. In this year of 
the project, we developed the mathematical model for 
fault detection and classification using the toolbox in 
MATLAB/Simulink [34]. Detailed mathematical 
explanations of each module are successively 
presented as follows. 
In power transmission systems, the majority of 
voltage and current signal distortions are caused by 
faults. A fault may produce transient phenomena that 
cause unbalanced three-phase quantities in both 
voltage and current signals. Many previously 
proposed methods, such as [21], [31], and [33], detect 
transient phenomena in the frequency domain. 
However, such phenomena can be also easily detected 
by symmetrical component analysis. 
The method of symmetrical components [35] is a 
simple method which is widely utilized to analyze 
unbalanced three-phase power systems. According to 
the method, any three-phase voltage and current 
signals can be expressed as the sum of three 
symmetrical sets of balanced phasors. In a three-phase 
power system, three sets of independent components 
can be defined: positive, negative, and zero sequences 
for both voltage and current of a transmission line. It 
is known that negative sequence voltage and current 
are sensitive to signals from a fault or misconnection 
on a balanced three-phase system. Thus, they are 
widely used as an indicator of fault conditions in 
various applications [36]–[38]. 
Suppose that the three-phase voltages and currents 
are denoted by Vabc and Iabc, where Vabc = (Va, Vb, Vc) 
and Iabc = (Ia, Ib, Ic). The three symmetrical 
components for voltages and currents can be arranged 
into vectors as V012 = (V0, V1, V2) and I012 = (I0, I1, I2), 
where subscribes 0, 1, and 2 represent the zero, 
positive, and negative sequence components, 
respectively. The negative sequence voltages (V2,a, 
V2,b, V2,c) and currents (I2,a, I2,b, I2,c) can be calculated 
using the following equations 
2,
2,
2
2,
0
120
240
a a a
b a a
c a a
V V V
V V V
V V V


   
   
   
, and      (1) 
  
 
8
 
Fig. 2. The triangular wave defined in Eq. (6). It is 
used in the convolution operation in Eq. (5) to 
stabilize the output of the proposed joint fault 
indicator. 
 
0.98 0.99 1 1.01 1.02 1.03 1.04 1.05 1.06 1.07 1.08
-2
0
2
V
ol
ta
ge
 (p
.u
.)
0.98 0.99 1 1.01 1.02 1.03 1.04 1.05 1.06 1.07 1.08
0
0.02
0.04
N
eg
. s
eq
. v
ol
ta
ge
0.98 0.99 1 1.01 1.02 1.03 1.04 1.05 1.06 1.07 1.08
-2
0
2
C
ur
re
nt
 (p
.u
.)
0.98 0.99 1 1.01 1.02 1.03 1.04 1.05 1.06 1.07 1.08
0
50
100
N
eg
. s
eq
. c
ur
re
nt
0.98 0.99 1 1.01 1.02 1.03 1.04 1.05 1.06 1.07 1.08
0
2000
4000
Jo
in
t f
au
lt 
in
di
ca
to
r
time
(e)
time
(d)
time
(c)
time
(b)
time
(a)
 
Fig. 3. (a) The resulted voltage signals and (b) its 
corresponding negative sequence voltages. (c) The 
resulted current signals and (d) its corresponding 
negative sequence currents. (e) The time course 
record of the joint fault indicator. In (a) and (c), 
signals of different phases are depicted in different 
colors, i.e. phase-A in red, phase-B in blue and phase-
C in green. 
 
are not stable as faults exist, so they cannot be 
directly used as fault indicators. Furthermore, the 
joint fault indicator detects the fault when t = 1.0037 
seconds, as shown in Fig. 3(e). Such short response 
time (0.0003 seconds) and steady values of joint fault 
indicator make it an effective trigger to activate both 
fault classification and fault location modules. These 
modules will be explained in the following 
subsections. 
After a fault has been detected, the proposed 
hybrid framework starts to measure the three-phase 
voltages Vabc = (Va, Vb, Vc) and currents Iabc = (Ia, Ib, Ic) 
under the post-fault condition over one cycle. Vabc and 
Iabc are then analyzed using the wavelet analysis, PCA, 
and SVM in the fault classification module. Detailed 
operations are presented at below. 
A multi-resolution signal decomposition technique 
based on WT has been successfully applied to extract 
relevant information from signals in many fields, 
including transmission line protection. WT is a 
mathematical theory associated with building a model 
for non-stationary signals using wavelets. The 
wavelets can be scaled and shifted to form a family of 
wavelets. WT provides a good tool to divide non-
stationary and non-periodic wide-band signals in both 
the time and frequency domains for feature extraction. 
In this study, a multi-level continuous WT (CWT) 
[39] is used to analyze the signals of three-phase 
voltages Vabc and currents Iabc. For example, CWT of 
a continuous time series voltage signal Va is defined 
as 
   CWT 1, ,a a a t bV V a b V t dtaa 


     ,    (7) 
where function () is the mother wavelet, and a 
and b are real numbers that represent the scaling and 
translation parameters, respectively. The scale 
parameter a determines the oscillatory frequency and 
the length of the wavelet, whereas the translation 
parameter b controls the shifting position. The 
wavelet coefficients CWTaV  give a measure of 
similarity between scaled and shifted wavelets with 
the voltage signal Va. 
However, it is impossible to compute the wavelet 
coefficients using mother wavelets with all possible 
scaling and translation parameters. In order to solve 
this problem, CWT is discretized to a discrete WT 
(DWT), so that in which the scaling and translation 
parameters are also discrete, such as when 0
ma a , 
0 0
mb nb a , and m, n are both integers. In general, most 
of DWT-based applications set a0 equals to 2 and b0 
equals to 1. By discretizing the CWT in Eq. (7), the 
DWT of a voltage signal Va can be formulated by 
   DWT 0
00
1, ,      
m
a a a mm
l
k naV V m n V k
aa
,   (8) 
where Va(k) is a discrete version of Va(t). 
A multi-level DWT (ML-DWT) is used to 
recursively decompose the signals of three-phase 
  
 
10
 
 
 
 
 
DWT_d1
DWT_d2
DWT_d1
DWT_d2
a
a
a
a
a
V k
V k
C k
I k
I k
        
,        (9) 
 
 
 
 
 
DWT_d1
DWT_d2
DWT_d1
DWT_d2
b
b
b
b
b
V k
V k
C k
I k
I k
        
,  and     (10) 
 
 
 
 
 
DWT_d1
DWT_d2
DWT_d1
DWT_d2
c
c
c
c
c
V k
V k
C k
I k
I k
        
,       (11) 
where Ca, Cb and Cc denote features in the phase-A, -
B, and -C of the transmission line, respectively. Since 
we record the voltage and current signals for one-
cycle at 3840 Hz, then Ca, Cb and Cc contain 64 of 
these vectors (k = 1, …, 64). 
Ca, Cb and Cc are mean-centered by subtracting the 
mean value from each coefficient vector. Let DWT_yxV  
and DWT_yxI  represent the mean of y-th level wavelet 
coefficients of DWT_yxV  and 
DWT_y
xI  in the phase-x of the 
transmission line, respectively. 
 64DWT_ DWT_
1
1 ,
64
y y
x x
k
V V k

        (12) 
 64DWT_ DWT_
1
1 ,
64
y y
x x
k
I I k

        (13) 
where    , , , and d1,d2x a b c y  . Then, the mean-
centered wavelet coefficients can be defined 
      
DWT_d1
DWT_d2
DWT_d1
DWT_d2
,
          
x
x
x x
x
x
V
V
C C
I
I
       (14) 
where  , ,x a b c  and  xC  represents mean-centered 
wavelet detail coefficients of voltages and currents in 
the phase-A, -B, and -C of the transmission line, 
respectively. In order to find a vector e which has the 
largest possible projection onto each column of  xC , 
we need to find a set of orthonormal vectors ex(k) 
such that the quantity 
            64 2
1
1
64
T
xx x
k
k e k C k

       (15) 
is maximized with the orthonormality constraint that  
            ,Tx x xe l e k l k ,      (16) 
where  , ,x a b c , and δx(l, k) is an identity matrix of 
size l × k. 
ex(k) and λx(k) are given by the eigenvectors and 
eigenvalues of the covariance matrix 
         Tx xxCov C C .        (17) 
In order to obtain the vectors ex(k) and scalars λx(k), 
we can solve the eigenvectors and eigenvalues of 
 Tx xC C . Let dk and μk be the eigenvectors and 
eigenvalues of  Tx xC C , respectively, so 
         Tx x k k kC C d d .       (18) 
By multiplying both sides by  xC  
           Tx x x xk k kC C C d C d ,     (19) 
which means that the first M – 1 eigenvectors ex(k) 
and eigenvalues λx(k) of  Tx xC C  are given by  x kC d  and μk for the transmission line with phase x{a, b, c}, 
respectively. However,  x kC d  needs to be normalized 
in order to be equal to ex(k). 
The eigenvectors corresponding to nonzero 
eigenvalues of the covariance matrix Covx produce an 
orthonormal basis for the subspace within which most 
wavelet detail coefficients of voltages and currents in 
the phase-x of the transmission line can be 
represented with a small amount of error. The 
eigenvectors are sorted by their corresponding 
eigenvalues in a decreasing order. The eigenvector 
associated with the largest eigenvalue is the one that 
reflects the greatest variance in the wavelet detail 
coefficients. Since the sorted eigenvalues decrease in 
exponential fashion, roughly 90% of the total 
variance is contained in the first 5% to 10% of the 
dimensions.  
The wavelet detail coefficients can be projected 
onto M' ( 64) dimensions by computing 
      ,1 ,2 ,,  ,...,  x x x x M        ,     (20) 
where     , T xx k xe k C k    , and k' = 1, 2, …, M'. ,x k   
is the k'-th coordinate of the wavelet detail coefficient 
in the new space, which came to be the principal 
component of voltages and currents in the phase-x of 
the transmission line, and x{a, b, c}. 
In this study, the first two coordinates of the 
principal component scores give the projection of 
wavelet detail coefficients of voltages and currents in 
each phase of the transmission line ( a  = [υa,1, υa,2], 
b  = [υb,1, υb,2] and c  = [υc,1, υc,2]) onto a feature 
plane. SVM is then applied to the feature plane for 
fault classification. SVM is a universal learning 
algorithm which has one output and can deal with 
linear and nonlinear separable models based on 
theoretical results from the statistical theory [44]. 
SVM is used to classify two coordinates of the 
  
 
12
LIBSVM [46]. The computational complexity of 
training nonlinear SVMs with LIBSVM has been 
reported to be quadratic in a number of training 
samples [45]. Since the training of SVMs is in offline 
fashion, the quadratic complexity is acceptable as 
long as the number of training samples is lesser than, 
say, one million. Generally, in this study, it is not 
possible to use a training data set of size one million; 
thus, the training of SVMs can be completed in lesser 
than one minute. 
In the proposed framework, as shown in Fig. 8, 
each SVM is designed to identify a type of fault event. 
The classification functions and the output patterns of 
these SVMs are summarized in Table I. The output 
will be an output vector with six elements denoted by 
T, and T = [T1, T2, T3, T4, T5, T6]. Please note that the 
binary SVM classifiers in this module also provide 
relative strengths for comparison if a fault event 
belongs to more than one class. Elements of output 
patterns are displayed by using signal ‘1’ for faulty 
condition, and ‘–1’ for normal condition. 
III. Experimental Results 
Line voltages Vabc = (Va, Vb, Vc) and currents Iabc = 
(Ia, Ib, Ic) at a frequency of 60 Hz are measured at the 
end of the line near the generator in order to perform 
fault diagnosis. Daubechies-4 mother wavelet is well 
capable of capturing the time of the transient 
phenomenon and extracting high and low frequency 
components during power system faults. An extensive 
series of simulation studies are conducted using 
MATLAB/Simulink software in an Intel i7-720QM 
laptop computer with 4 GB RAM. The hardware 
implementation and its performances in real-world 
test scenarios are presented in the subsequent project. 
A simple three-phase power system network, as 
shown in Fig. 8, is simulated to evaluate the 
performance of the proposed framework. The power 
system consists of a three-phase power supply, a 
transmission line with two transformers and several 
linear and nonlinear loads, and a simplified 
synchronous machine (SSM). Faults are created at 
different places on the transmission line. The 
configurations of these elements are summarized in 
Table II. 
2,
10
0 
M
VA
 
Fig. 8. Schematic diagram of the two-end three-phase 
power system network.  
TABLE I 
CLASSIFICATION FUNCTION, DETAILED CLASSIFICATION, AND OUTPUT 
PATTERN OF THE SVMS IN THE FAULT CLASSIFICATION MODULE 
Classifi
er 
Classification 
function 
Detaile
d 
Info
Input vector with  
unique pattern 
hyperpl
anes Output
SVM
#1 
Phase to 
ground fault
A-G a  
3 T1 B-G b  
C-G c  
SVM
#2 
Double phase 
to ground 
fault 
AB-G { a , b } 
3 T2 BC-G { b , c } 
AC-G { a , c } 
SVM
#3 
Phase to 
phase fault
AB { a , b } 
3 T3 BC { b , c } 
AC { a , c } 
SVM
#4 
Three phase 
fault ABC
{
a , b , c } 3 T4 
SVM
#5 
Three phase 
to ground 
fault 
ABC-G { a , b , c } 3 T5 
SVM
#6 
High-
impedance 
fault 
HIF { a , b , c } 3 T6 
 
TABLE II 
PARAMETERS OF THE TWO-END POWER TRANSMISSION NETWORK 
Component Parameter 
Transmission line 
Total length 1000 km 
Positive and negative 
sequence resistance per 
unit length 
0.01273 Ω/km 
Zero sequence 
resistance per unit 
length 
0.3864 Ω/km 
Positive and negative 
sequence inductance per 
unit length 
0.9337 mH/km 
Zero sequence 
inductance per unit 
length 
0.41264 mH/km 
Positive and negative 
sequence capacitance 
per unit length 
12.7 pF/km 
Zero sequence 
capacitance per unit 
length 
7.75 pF/km 
Generator 
Phase-to-phase rms 
voltage 735 kV, 60 Hz 
3-phase short-circuit 
level 30000 MVA 
Total impedance of 
generator 0.2 + j4.49 Ω 
X/R ratio 10 
Transformers 
Magnetization 
resistance 500 p.u. 
Magnetization 
inductance 500 p.u. 
 
Line voltages Vabc = (Va, Vb, Vc) and currents Iabc = 
(Ia, Ib, Ic) at a frequency of 60 Hz are measured at the 
end of the line close to the generator in order to 
  
 
14
TABLE III 
SIMULATION RESULTS OF THE PROPOSED FRAMEWORK USING THE SIMPLE POWER NETWORK 
Fault type # of test samples 
Detection 
accuracy
Classification and location test 
TP FP TN FN Sensitivity Specificity 
Phase to 
ground fault 
A-G 10000 100.0% 4994 1 4999 6 99.88% 99.98% 
B-G 10000 100.0% 4992 0 5000 8 99.84% 100.00% 
C-G 10000 100.0% 4992 1 4999 8 99.84% 99.98% 
Double phase 
to ground fault 
AB-G 10000 100.0% 4993 1 4999 7 99.86% 99.98% 
BC-G 10000 100.0% 4990 2 4998 10 99.80% 99.96% 
AC-G 10000 100.0% 4989 2 4998 11 99.78% 99.96% 
Phase to phase 
fault 
AB 10000 99.9% 4995 5 4995 5 99.90% 99.90% 
BC 10000 99.9% 4996 6 4994 4 99.92% 99.88% 
AC 10000 99.9% 4995 4 4996 5 99.90% 99.92% 
Three phase 
fault ABC 10000 99.9% 4997 5 4995 3 99.94% 99.90% 
Three phase to 
ground fault ABC-G 10000 99.9% 4997 4 4996 3 99.94% 99.92% 
High-
impedance fault HIF 10000 99.9% 4975 29 4971 25 99.50% 99.42% 
      Overall 99.84% 99.90% 
  
 
16
[38] Q. Wu and S. Nandy. ”Fast single-turn sensitive 
stator inter-turn fault detection of induction motors 
based on positive and negative sequence third 
harmonic components of line currents,” Proc. IEEE 
Industry Applications Society Annual Meeting, Oct. 
2008. pp. 1–8. 
[39] Brémaud, P., Mathematical principles of signal 
processing, Fourier and wavelet analysis, Springer 
Verlag, 2002, pp. 171–187. 
[40] S.G. Mallat, “A theory for multiresolution signal 
decomposition: the wavelet representation”, IEEE 
Trans. Pattern Anal. Mach. Intell., vol. 11, no. 7, pp. 
674–693, 1989. 
[41] S.M. Brahma, “Use of wavelets for out of step 
blocking function of distance relays,” Proc. IEEE 
Power Engineering Society General Meeting, June 
2006, pp. 1–5. 
[42] A.H. Osman and O.P. Malik, “Protection of parallel 
transmission lines using wavelet transform,” IEEE 
Trans. Power Deliv., vol. 19, no, 1, pp.49–55, 2004. 
[43] M.J. Reddy and D.K. Mohanta, “Adaptive-neuro-
fuzzy inference system approach for transmission 
line fault classification and location incorporating 
effects of power swings,” IET Gener. Transm. 
Distrib., vol. 2, no. 2, pp. 235–244, 2008. 
[44] N. Cristianini and J. Shawe-Taylor, An Introduction 
to Support Vector Machines and Other Kernel-
Based Learning Methods. Cambridge, U.K.: 
Cambridge Univ. Press, 2000, pp. 31–112. 
[45] L. Bottou, O. Chapelle, D. DeCoste, and J. Weston, 
editors. Large Scale Kernel Machines. MIT Press, 
Cambridge, MA., 2007. 
[46] T. Joachims, “Training linear SVMs in linear time,” 
Proc. ACM SIGKDD International Conference On 
Knowledge Discovery and Data Mining, August 
2006, pp. 217–226. 
 
  
 
18
高強健性輸電線保護電驛演算法設計及實作 
第二年：新式強健型輸電線故障定位演算法設計與實現 
計畫編號:     NSC 96-2628-E-002-252-MY3 
計畫主持人：   江昭皚  教授    國立臺灣大學  生物產業機電工程學系 
計畫協同主持人： 蕭瑛東  教授    國立臺北教育大學 資訊科學系 
          王永鐘  副教授   國立臺北科技大學 電機工程學系 
計畫執行期間：  97. 8 ~ 98. 7 
計畫參與人員：  莊欽龍(博士生)  國立臺灣大學  生物產業機電工程學系 
歐陽丞修(博士生) 國立臺灣大學  生物產業機電工程學系 
林子翔(碩士生)   國立臺灣大學  生物產業機電工程學系 
洪志宏(碩士生)   國立臺灣大學  生物產業機電工程學系 
林詩翔(碩士生)   國立臺灣大學  生物產業機電工程學系 
吳勇成(碩士生)   國立臺灣大學  生物產業機電工程學系 
                                                               
 
摘要—將故障偵測、故障辨識與故障定位等理論演算
法實作成為適用於真實電網系統，一直以來都是相關
領域。本年度計畫，乃延續前一年度的故障偵測與辨
識演算法，並且加以故障定位演算法，使所有演算法
成為一套完整的輸電線網路保護系統。其中，故障偵
測演算法的主要使用方法為負序轉換。負序轉換可快
速且有效地偵測到三相輸電線上的任何因為故障造成
的不平衡狀態。在偵測到故障後，故障類別辨識演算
法與故障定位演算法則會馬上啟動，並且在一個週期
的時間後辨識出故障的類型，並且定出該故障在電網
中的實際發生位置。整體演算法是由多種數學模型所
構成，其中包含小波轉換，主成分分析法，支持向量
機與可適性類神經網路系統等。整體系統經模擬測
試，可有效且快速地進行故障偵測、辨識與定位工
作。 
關鍵詞—故障偵測、故障定位、主成分分析、支持向
量機、類神經網路。 
 
Abstract—Bridging the gap between the theoretical 
modeling and the practical implementation is always 
essential for fault detection, classification, and location 
methods in a power transmission line network. In this 
study, a novel hybrid framework able to rapidly detect and 
locate fault on power transmission lines is presented. The 
proposed algorithm presents a fault discrimination method 
based on the three-phase current and voltage waveforms 
measured when fault events occur in the power 
transmission line network. Negative sequence symmetric 
components of the three-phase current and voltage 
quantities are applied to achieve fast online fault detection. 
Subsequently, the fault detection method triggers the fault 
classification and fault location methods to become active. 
A variety of methods – including multi-level complex 
wavelet transform, principal component analysis, support 
vector machines, and adaptive structure neural networks – 
are incorporated into the framework to identify fault type 
and location at the same time. This paper lays out the 
fundamental concept of the proposed framework, and 
introduces the methodology of the analytical techniques, a 
pattern recognition approach via neural networks, and a 
joint decision making mechanism. Using this framework, 
the tasks of fault detection, classification, and location are 
accomplished in less than 16.7 ms. 
Keywords: Fault detection, fault location, principal 
component analysis, support vector machine, artificial 
neural networks. 
 
I. Introduction 
Following the fault detection and classification 
systems developed in the previous year, in this year, 
our goal is to design a evolvable fault location system. 
By integrating these subsystems, a protection system 
can be achieved. The overall architecture of the 
proposed protection system is illustrated in Fig. 1. In 
this study, we assume that the fundamental frequency 
of the power system is 60 Hz. A sampling rate of 
3,840 Hz (64 samples per cycle, measured by 
advanced power measurement units) is chosen to 
extract  signals from the transmission l ines. 
Measurement units are installed at buses to obtain 
three-phase voltage and current signals. The acquired 
data is then transmitted to regional fault analysis 
stations via a wide-area-network (WAN) for fault 
detection, classification, and location. The regional 
fault station center is made by a FPGA-based 
standalone server. The recorded fault signals are  
  
 
20
diagnosis procedures, if the fault location is within 
the protected section (as illustrated in Fig. 1), the 
protection system can take actions properly to reduce 
the damage caused by the fault. Otherwise, diagnosis 
results will be recorded for further analysis. 
II. The Proposed System 
The fault detection and location systems are 
developed and presented in the project report of the 
previous year. In this study, a set of adaptive 
structural neural networks (ASNNs) are used to 
estimate fault location. As shown in Fig. 8, after the 
SVMs determine the fault type, the proposed 
framework will activate an associated ASNN to 
precisely locate the position of the fault. ASNN was 
previously proposed to be an adaptive neural network 
with minimal predetermined parameters and a 
dynamic structuring mechanism [1]. Because of the 
dynamic structuring mechanism, we can continuously 
enhance the performance of the proposed framework 
via the runtime training technique. Such technique 
allows the engineers to train the ASNN when they 
collected new training samples. Any initialization 
process is not required. Detailed information 
regarding ASNN, please refer to [1] and 
http://bem.bime.ntu.edu.tw/clchuang/ASNN.pdf. 
The detailed input/output configuration of the fault 
location module is depicted in Fig. 3. Training 
samples tD

 and its corresponding fault location Lt are 
obtained previously through real-world measurements 
from power systems or computer-based simulations. 
Before the proposed framework is being applied to 
fault diagnosis, each network in the set of ASNNs 
needs to be properly trained using tD

 and Lt in order 
to allow the framework to become functional.  
When the proposed framework is monitoring the 
system, the principal component scores of fault 
voltages and currents in each phase of the 
transmission line  x  for x{a, b, c} (i.e. a  = [υa,1, υa,2], b  = [υb,1, υb,2] and c  = [υc,1, υc,2]) serve as the 
inputs of the ASNN activated by its associated SVM. 
After the ASNN completes the analysis, the estimated 
location of fault, denoted by L, will be presented at 
the output of the ASNN. 
It is worth to mention that the primary purpose of 
using ASNN in the fault location module is to 
increase the flexibility of the proposed framework. 
Training without re-initializing the neural network is 
an important feature since the power company cannot 
afford to shut down the monitoring system for the 
power grid too long. 
 
 , ,t ta tb tcD      
 
Fig. 3. Detailed diagram of the input/output 
configuration of ASNN for fault location. 
 
III. Experimental Results 
Line voltages Vabc = (Va, Vb, Vc) and currents Iabc = 
(Ia, Ib, Ic) at a frequency of 60 Hz are measured at the 
end of the line near the generator in order to perform 
fault diagnosis. Daubechies-4 mother wavelet is well 
capable of capturing the time of the transient 
phenomenon and extracting high and low frequency 
components during power system faults. An extensive 
series of simulation studies are conducted using 
MATLAB/Simulink software in an Intel i7-720QM 
laptop computer with 4 GB RAM. The hardware 
implementation and its performances in real-world 
test scenarios are presented in the subsequent year. 
A simple three-phase power system network, as 
shown in Fig. 4, is simulated to evaluate the 
performance of the proposed framework. The power 
system consists of a three-phase power supply, a 
transmission line with two transformers and several 
linear and nonlinear loads, and a simplified 
synchronous machine (SSM). Faults are created at 
different places on the transmission line. The 
configurations of these elements are summarized in 
Table I. 
 
 
Fig. 4. Schematic diagram of the two-end three-phase 
power system network.  
 
 
  
 
22
1st Principal Component
2n
d
P
rin
ci
pa
l C
om
po
ne
nt
0 1-1
0
-1
1
0.2 0.4 0.6 0.8-0.8 -0.6 -0.4 -0.2
0.8
0.6
0.4
0.2
-0.2
-0.4
-0.6
-0.8
A
B
C
0 pu
0.1 pu
0.2 pu
0.3 pu
0.4 pu
0.5 pu
0.6 pu
0.7 pu
0.8 pu
0.9 pu
1 pu
0 pu
0 pu
0.1 pu
0.1 pu
0.2 pu
0.3 pu
0.4 pu
0.5 pu
0.6 pu
0.7 pu
0.8 pu
0.9 pu
1 pu
0.2 pu
0.3 pu
0.4 pu 0.5 pu
0.6 pu
0.7 pu
0.8 pu
0.9 pu
1 pu
1st Principal Component
2n
d
P
rin
ci
pa
l C
om
po
ne
nt
0 1-1
0
-1
1
0.2 0.4 0.6 0.8-0.8 -0.6 -0.4 -0.2
0.8
0.6
0.4
0.2
-0.2
-0.4
-0.6
-0.8
0 pu
1 pu
0 pu
1 pu
0 pu
1 pu
A
B
C
(a) (b)  
Fig. 6. Data projection for (a) phase to ground fault 
and (b) high-impedance fault. The dashed lines show 
the hyperplanes of the trained SVM corresponding to 
the fault. The node descriptions denote the fault 
location in the transmission line estimated by ASNN 
corresponding to the fault, where 0 and 1 p.u. 
represent distance of 0 and 1000 km from the bus 
near the generator, respectively. 
 
phase show unique patterns in the feature space. The 
pattern also shows a clear trend associated with the 
position of the fault. 
After the proposed framework is properly tuned by 
the training dataset, we validate the framework by 
applying it to the test dataset. The simulation results 
are summarized in Table III. It shows that the 
proposed algorithm can accurately detect, classify, 
and locate faults, regardless of what type of faults 
they are. The performances of the proposed 
framework are demonstrated via sensitivity, 
specificity, and location error, and their definitions 
are 
  100%,Sensitivity TP TP FN         (1) 
  100%,Specificity TN TN FP         (2) 
 est real 1000 100%,Location Error L L     (3) 
where TP, FP, TN and FN represent number of true-
positives, false positives, true-negatives, and false-
negatives, respectively. Lest and Lreal denote the 
position estimated by the framework and the real 
position of the fault, respectively. Different from most 
of the related studies, we also evaluate the specificity 
of the proposed method, since false alarms could 
cause massive damage to end-users and the economy. 
As shown in Table II, the proposed framework 
learned well from the training dataset. This means 
that the WT and PCA are able to effectively capture 
the features of fault signals. The proposed framework 
also yields good performances when examined by the 
test dataset. The averaged sensitivity and specificity 
yielded by the proposed method are 99.8% and 99.9%, 
respectively. The largest location error is consistently 
lesser than 1%, which shows that the location error is 
not influenced by fault resistances, fault locations, 
and fault types. The second training dataset is then 
applied to train the ASNNs via the runtime training 
technique [1]. The averaged location error is 
improved to 0.41%. Thus, we can re-train the ASNNs 
once new faults or normal signals are available. 
Furthermore, since different fault resistances may 
cause the accuracy of fault location to drop, we also 
summarize the simulation results in Table III to show 
the relationship between fault resistance and location 
accuracy. The result shows that the averaged error of  
TABLE II 
SIMULATION RESULTS OF THE PROPOSED FRAMEWORK USING THE SIMPLE POWER NETWORK 
Fault type # of test samples 
Detection 
accuracy 
Classification and location test 
TP FP TN FN Sensitivity Specificity Avg. location error 
Avg. location 
error 
(re-trained) 
Phase to 
ground fault 
A-G 10000 100.0% 4994 1 4999 6 99.88% 99.98% 0.41% 0.31% 
B-G 10000 100.0% 4992 0 5000 8 99.84% 100.00% 0.42% 0.32% 
C-G 10000 100.0% 4992 1 4999 8 99.84% 99.98% 0.44% 0.32% 
Double phase 
to ground fault 
AB-G 10000 100.0% 4993 1 4999 7 99.86% 99.98% 0.57% 0.44% 
BC-G 10000 100.0% 4990 2 4998 10 99.80% 99.96% 0.60% 0.46% 
AC-G 10000 100.0% 4989 2 4998 11 99.78% 99.96% 0.61% 0.49% 
Phase to phase 
fault 
AB 10000 99.9% 4995 5 4995 5 99.90% 99.90% 0.41% 0.35% 
BC 10000 99.9% 4996 6 4994 4 99.92% 99.88% 0.40% 0.34% 
AC 10000 99.9% 4995 4 4996 5 99.90% 99.92% 0.43% 0.37% 
Three phase 
fault ABC 10000 99.9% 4997 5 4995 3 99.94% 99.90% 0.74% 0.51% 
Three phase to 
ground fault ABC-G 10000 99.9% 4997 4 4996 3 99.94% 99.92% 0.67% 0.45% 
High-
impedance fault HIF 10000 99.9% 4975 29 4971 25 99.50% 99.42% 0.79% 0.51% 
      Overall 99.84% 99.90% 0.54% 0.41% 
 
  
 
24
Measurement Science and Technology, vol. 19, 
075106, 2008. 
 
 
 
  
 
26
高強健性輸電線保護電驛演算法設計及實作 
第三年：輸電線故障定位與故障種類辨識晶片之設計與實現 
計畫編號:     NSC 96-2628-E-002-252-MY3 
計畫主持人：   江昭皚  教授    國立臺灣大學  生物產業機電工程學系 
計畫協同主持人： 蕭瑛東  教授    國立臺北教育大學 資訊科學系 
          王永鐘  副教授   國立臺北科技大學 電機工程學系 
計畫執行期間：  97. 8 ~ 98. 7 
計畫參與人員：  莊欽龍  博士    國立臺灣大學  生物產業機電工程學系 
歐陽丞修(博士生) 國立臺灣大學  生物產業機電工程學系 
林子翔(碩士生)   國立臺灣大學  生物產業機電工程學系 
洪志宏(碩士生)   國立臺灣大學  生物產業機電工程學系 
王景儀(碩士生)   國立臺灣大學  生物產業機電工程學系 
盧續承(碩士生)   國立臺灣大學  生物產業機電工程學系 
林祈弘(碩士生)   國立臺灣大學  生物產業機電工程學系 
賴達緯(碩士生)   國立臺灣大學  生物產業機電工程學系 
張延瑋(碩士生)   國立臺灣大學  生物產業機電工程學系 
                                                               
 
摘要—本年度之計畫目標在於開發一套完整之輸電線
保護系統之硬體平台，其功能包含有故障偵測、故障
類別辨識與故障定位等。本系統主要由多種演算法構
建而成，其中包含負序分析法、小波轉換分析法、主
成分分析法、支持向量機與可適性類神經網路系統
等。在本計畫前兩年度之結案報告中，吾人已經針對
此保護系統之理論基礎與架構進行完整之開發與說
明。在本年度計畫中，主要討論範疇在於如何將前述
之各種演算法進行硬體化設計，使其可以在全自動的
方式下進行運作，並適用於真實電力系統的保護工
作。本年度所開發之輸電線系統保護硬體平台的另一
個特點，在於此硬體平台具有演化的功能。定位系統
的準確度可經由即時訓練機制進行效能的增強。此項
特點將可使系統工程師在蒐集到新的訓練資料後，馬
上用於增強系統準確度，以避免重新訓練的困擾。 
關鍵詞—故障偵測、故障辨識、故障定位、可程式邏
輯閘陣列、可演化硬體。 
 
Abstract—This study addresses a hybrid framework for 
achieving fault detection, classification, and location, 
simultaneously. The proposed framework is formed by a 
variety of analysis techniques, including symmetrical 
component analysis, wavelet transforms, principal 
component analysis, support vector machine, and adaptive 
structure neural networks. In our previous report, the 
mathematical foundation of this framework with numerical 
results obtained by computer-based simulations has been 
presented. This report is devoted to discuss the FPGA 
implementation and experimental results acquired using 
real-world scenarios. The hardware implementation of the 
runtime training technique in the proposed framework is an 
evolvable hardware tested by the power signals used in a 
power company transmission network for performance 
evaluation. The runtime training technique allows the 
FPGA to have learning and re-training capabilities. The 
main purpose of this study is to show the applicability of 
the proposed framework on a hardware platform and test 
the framework’s robustness and evolvability against noises 
from the system and measurements. 
Keywords: Fault detection, fault classification, fault 
location, FPGA, evolvable hardware. 
 
I. Introduction 
The reliability of electrical energy is essential for 
economies and industrial users. Fault detection, 
classification, and location systems have played 
crucial roles to ensure the availability and continuity 
of power generation and transmission. However, the 
power transmission lines are vulnerable to the faults 
caused by typhoons, earthquakes, aging of insulation, 
and short circuits resulting from attacks of birds or 
other objects. Modern digital relay technologies have 
provided various solutions to prevent power grids 
from major blackouts. Due to the large geographical 
sizes and network complexities, modern power 
systems are still subject to threats of faults induced by 
natural and/or external interferences. In order to 
  
 
28
measurement module, fault diagnosis module, and 
graphical display module. The conceptual architecture 
of this system is depicted in Fig. 1. The signal 
measurement module is built using three integrated 
14-bit analog/digital converters (AD9248) [3] 
produced by Analog Devices, Inc. The fault diagnosis 
module is formed by three sub-modules presented in 
the previous reports, including fault detection, fault 
classification, and fault location sub-modules. The 
implementation of the fault diagnosis module can be 
achieved by completing the circuitry design of NSC, 
WT, PCA, SVM, and ASNN in a Stratix-III series 
FPGA (EP3SL150F1152C4) [4] produced by Altera, 
Inc. A graphical user interface (GUI) displayed on a 
digital touch LCD panel allows users to manipulate 
the system and shows the result of fault diagnosis. 
The detailed explanations regarding the 
implementation of these modules are given in the 
following subsections. 
 In the signal measurement module, three 14-bit 
ADCs are utilized to measure signals from external 
cables at a sampling rate of 150 million samples per 
second. The hardware configuration of the signal 
measurement module is shown in Fig. 2. The signal 
measurement module is responsible for accepting the 
three-phase voltage and current signals. However, the 
development board (DK-DSP-3SL150N) [5] that 
holds the Stratix-III series FPGA only provides two 
high-speed mezzanine card (HSMC) [6] interfaces. 
Because of this reason, we install two data conversion 
cards that provide four 14-bit ADCs in total. 
Furthermore, a switch index V/ I  is used to measure 
the three-phase voltage and current signals. First, V/ I  
is set at 1, and then the signal measurement module 
converts the one-cycle three-phase voltage signals. 
After that, V/ I  is set at 0 to measure the one-cycle 
three-phase current signals. 
 The analog signals are converted to digital signals 
using 14-bit representation as depicted in Fig. 3(a). 
Due to the limitation of the 14-bit representation, i.e., 
the limited dynamic range, such a representation is 
not useful in arithmetic computations. The IEEE 
standard for floating point number representation 
(IEEE-754) [7], however, is the most widely used 
standard for floating point computation, followed by 
many hardware and software implementation. In this 
module, a converter is designed to transform 14-bit 
representation values into IEEE-754 readings. The 
IEEE-754 standard defines various types of basic 
b ina ry  fo rma t s  fo r  f l oa t i ng  po in t  number  
AD9248
AD9248
AD9248
Stratix III
EP3SL150F1152C4
Touch LCD
Panel
4.3” 800×480
3-
ch
an
ne
l
An
al
og
 Si
gn
al
s
14
14
14
Signal Measurement 
Module Fault Diagnosis Module
Graphical Display
Module
a
b
c
 
Fig. 2. Conceptual diagram of the fault diagnosis 
system, which comprises a signal measurement 
module, a fault diagnosis module, and a graphical 
display module. 
 
AD9248
AD9248
AD9248
Va, Ia
Vb, Ib
Vc, Ic
ADCs
14
14
14
Altera Stratix-III FPGA
Sampling rate
controller
Memory
address
controller
Re
gi
st
er
s
16
1GB DDR2-800 DIM
M
 /w
 ECC
V / I
addr
clk
10 MHz
14-bit unsigned
value to floating
point number
converter
14
14
14
48
data
3
cmd
HSMC DIMM
64 Hz
 
Fig. 2. Configuration of the signal measurement 
module. The analog signals measured from external 
cables are converted to digital signals using the 14-bit 
unsigned representation. In this module, a floating 
number converter is developed to transform the 14-bit 
unsigned values to the standard double-precision 
floating number according to the definition given by 
the IEEE-754. 
 
00 0000 0000 0000
00 0000 0000 0001
10 0000 0000 0000
11 1111 1111 1111
11 1111 1111 1111
14-bit  representationInput (V/I)
-1
-0.9998
0
+0.9998
+1
16- bit floating point number
1 01111 00 0000 0000
1 01110 11 1111 1111
0 00000 00 0000 0000
0 01110 11 1111 1111
0 01111 00 0000 0000
sign exponent fraction
(a) (b)  
Fig. 3. Two simplified representations of unsigned 
floating numbers. (a) Fourteen-bit representation used 
in the HSMC interface. (b) Sixteen-bit half-precision 
floating point representation defined by the IEEE 
standard. 
 
representation. In order to make floating point units 
(FPUs) simple, the half-precision format is utilized as 
illustrated in Fig. 3(b). The FPUs for 16-bit half-
precision format have similar resolution to the 14-bit 
  
 
30
wavelet detail coefficients of voltages and currents 
( d1DWTabcV , d2
DWT
abcV , d1
DWT
abcI  and d2
DWT
abcI ) are used for further 
analysis, we present a fast and efficient method to 
perform ML-DWT based on Mallat’s recursive 
pyramid algorithm. In principle, in order to 
implement ML-DWT at a maximum speed, a serial-in 
parallel-out (SIPO) architecture, as illustrated in Fig. 
5, is used to compute the WT coefficients. 
A pipeline structure is used in this design. The new 
input data values Vabc(t) and Iabc(t) are loaded into the 
deepest place of the corresponding shift register at 
every time period. The length of the shift registers are 
4 words, which is the same as the length of the 
Daubechies-4 orthogonal wavelets. Data is fed to the 
wavelet high-pass filter according to a sequence as: 
 { d1DWT (1)abcV , d1DWT (1)abcI } = G * {Vabc(1), Iabc(1)};  { d2DWT (1)abcV , d2DWT (1)abcI } = G * { d1DWT (1)abcV , d1DWT (1)abcI };  { d1DWT (2)abcV , d1DWT (2)abcI } = G * {Vabc(3), Iabc(3)};  { d1DWT (3)abcV , d1DWT (3)abcI } = G * {Vabc(5), Iabc(5)};  { d2DWT (2)abcV , d2DWT (2)abcI } = G * { d1DWT (3)abcV , 
d1DWT (3)abcI };  { d1DWT (4)abcV , d1DWT (4)abcI } = G * {Vabc(7), Iabc(7)};  { d1DWT (5)abcV , d1DWT (5)abcI } = G * {Vabc(9), Iabc(9)};  etc. 
A multiplexer is utilized to control the sequence of 
taking input coefficients from the SIPO shift registers 
(Vabc, Iabc, d1DWTabcV , and d1
DWT
abcI ). The output of the 
wavelet high-pass filter is passed through a 
demultiplexer to the appropriate output channel for 
the corresponding SIPO shift register, and the wavelet 
coefficients in the SIPO shift register is shifted. The 
control signals of the multiplexer and the 
demultiplexer are generated by counters with discrete 
logic circuits to control the sequence of operations. 
Since the sampling rates of Vabc and Iabc are relatively 
lower than the operating frequency of the FPGA, the 
proposed system can perform ML-DWT in real-time. 
The FPUs are used in the filter block only; there are 
four ‘mult/div’ FPUs and three ‘add/sub’ FPUs used 
in this block. The filter has fixed coefficients; 
consequently, these coefficients can be easily 
implemented using fixed wires. 
 In the proposed framework, PCA is used to reduce 
the dimensionality of the wavelet coefficients 
produced by ML-DWT. For the hardware designs of 
PCA, the most computationally intensive part of PCA 
is to perform eigenvector calculations and sorting. In 
fact, the calculation of eigenvectors is sequential and 
hard to be parallelized. To implement PCA in the 
FPGA, a multistage pipeline structure is presented as  
M
UX G filter
DE
M
UX
Vabc
Iabc
Vabc(t)
Iabc(t)
d1DWT
abcV d2
DWT
abcV d2
DWT
abcId1
DWT
abcI
d2DWT ( )abcI i
d1DWT ( )abcI i
d2DWT ( )abcV i
d1DWT ( )abcV i
16 bit x 4
16 bit 
Shift
Timing 
control
 
Fig. 5. Architecture of the serial-in parallel-out ML-
DWT. 
 
d1DWT
abcV
d2DWT
abcV
d1DWT
abcI
d2DWT
abcI
aC
bC
cC

aC

bC

cC
Organizing Centering
M
UX
 2 24a c b   
Solve the system det(A-λI)
Determine eigenvectors e
Sort e and λ
DEMUX
bv

av

cv

Pipeline control
 
Fig. 6. Hardware architecture of implementing PCA. 
 
depicted in Fig. 6. 
 First, the wavelet coefficients { d1DWTabcV , d2
DWT
abcV , 
d1DWT
abcI , and d2
DWT
abcI } produced in the most recent cycle 
are used in the PCA. In order to compute eigenvalues 
and eigenvectors, the size of these wavelet 
coefficients are equalized to 64 samples using a 
simple linear interpolation technique. The wavelet 
coefficients are then organized into three matrices 
according to their phases, Ca, Cb, and Cc. The mean 
centered coefficient matrices,  aC ,  bC , and  cC , are 
fed to the computation module of PCA in a sequence 
controlled by a multiplexer. The module is designated 
to solve eigenvalues and eigenvectors by linear 
algebra. The most significant eigenvalue and its 
corresponding eigenvector is used to project the 
wavelet coefficients onto the vectors in a new feature 
space, i.e., 

av , 

bv , and 

cv . A demultiplexer is 
responsible for storing the results into the 
corresponding registers for further analysis. 
 The SVM [11] used in this study includes two 
stages: machine learning stage and feed forward 
classification stage. In the machine learning stage, 
  
 
32
III. Experimental Results 
The setup of the proposed systems is shown in Fig. 
10. The overall hardware resources used in the 
Stratix-III FPGA are 92.7% (105,403/113,600) 
ALUTs, 4576 registers, 48 memory blocks, and 618 
pins. The operation frequency of the Stratix-III FPGA 
is 72.46 MHz, benefited by the pipeline designs of the 
internal components. The entire analysis process of 
the proposed system completes in 0.0001 second after 
the ADC measures a new sample from the external 
cables. For each transmission line in the simulated 
power system, different faults are randomly given to 
produce training and test samples to evaluate the 
performance of the proposed diagnosis system. Each 
sample is generated for different type of fault at 
random fault location (from 0 to 1 p.u.) and random 
fault inception angles (0° to 359°). There are 240,000 
power waveforms generated (10,000 samples per type 
of fault and 120,000 samples for a normal condition) 
via MATLAB/Simulink. We train the parameters of 
SVMs and ASNNs on computer using half of the 
samples measured by the 14-bit ADC in order to take 
measurement errors into account. Each training 
dataset consists of 5,000 fault waveforms and 5,000 
normal waveforms. After the training process 
completes, all parameters are transmitted to the 
memory module of the FPGA board. For a validation 
purpose, half of the samples are used to test the 
performance of the proposed diagnosis system. 
In order to evaluate the performance of the 
proposed diagnosis system, three performance indices 
are defined 
  100%,Sensitivity TP TP FN        (5) 
  100%,Specificity TN TN FP        (6) 
 err,1 err,2 2 ,Location Error L L       (7) 
where TP, FP, TN, and FN represent the numbers 
of true-positives, false positives, true-negatives, and 
false-negatives, respectively. Lerr,1 and Lerr,2 are the 
location errors yielded by the two measurement units 
closest to the real fault location in the system. In 
addition, the proposed framework in both 
measurement units must simultaneously detect and 
correctly classify the fault; otherwise, the result 
would be treated as a false-negative. 
Before we evaluate the performance of the 
proposed system, it is necessary to ensure the 
consistency of the waveforms outputted and measured 
by the real-time power system simulator and the 
presented diagnosis system, respectively. Two fault 
waveforms that contain three-phase voltage and  
(a) (b)  
Fig. 10. (a) Setup of the proposed system by 
integrating a Stratix-III FPGA evaluation board (DK-
DSP-3SL150N) and a Cyclone-II FPGA development 
board (DE2-70) that is responsible for displaying 
diagnosis results. (b) Setup of the Stratix-III FPGA 
board. 
 
current signals are depicted in Fig. 11, where the blue 
solid lines represent the waveforms outputted by the 
real-time power system simulator, and the red dotted 
lines are waveforms measured by the 14-bit ADC. 
 To measure the similarity between the simulated 
and the measured waveforms, an index, named 
SSE/Var, is defined as below 
   
2
/ ,
  o m o
o
S S
SSE Var Var S
S
    (8) 
where So and Sm are the waveforms simulated and 
measured by the proposed systems, ||So|| is the size of 
the waveform, and Var(So) is the variance of the 
waveform. The mean values of SSE/Var in voltage 
and current signals are 0.000841 and 0.000165, 
respectively. With small values of SSE/Var in both 
voltage and current signals, we can guarantee that the 
proposed diagnosis system is able to retrieve correct 
waveforms outputted by the proposed power system 
simulator. 
 A real Taipower 345 kV power transmission 
network established by Taipower in Taiwan is 
adapted to model the simulated power system 
network. The topology of the power system is 
illustrated in Fig. 12. The proposed diagnosis system 
is initialized with 6 ASNNs that contains 50 neurons 
each (300 neurons in total). After the proposed 
diagnosis system is properly trained by the training 
dataset, we validate the proposed system by applying 
it to the test dataset. The experimental results over all 
transmission lines are summarized in Table I. The 
results show that the performance of the proposed 
d i a g n o s i s  s y s t e m i s  c o mp ar ab l e  w i t h  t h e 
computational results presented in the report of 
previous years. The proposed system is able to detect, 
classify, and locate faults under various types of fault 
conditions. The averaged detection accuracy of the  
  
 
34
 
 
TABLE I 
EVALUATION RESULTS OF THE PROPOSED DIAGNOSIS SYSTEM USING THE WAVEFORMS GENERATED BY THE REAL-TIME POWER SYSTEM SIMULATOR 
Fault type # of test samples 
Detection 
accuracy 
(averaged) 
classification and location test 
(averaged from 39 transmission lines) Avg. location error
TP FP TN FN Sensitivity Specificity 
First-
round 
test 
Retraine
d 
Phase to ground 
fault 
A-G 10000 × 39 100.0% 4989.08 1.15 4998.85 10.92 99.78% 99.98% 0.43% 0.37% 
B-G 10000 × 39 100.0% 4986.58 2.79 4997.21 13.42 99.73% 99.94% 0.40% 0.34% 
C-G 10000 × 39 100.0% 4987.22 2.38 4997.62 12.78 99.74% 99.95% 0.48% 0.38% 
Double phase to 
ground fault 
AB-G 10000 × 39 99.9% 4987.88 3.19 4996.81 12.12 99.76% 99.94% 0.63% 0.53% 
BC-G 10000 × 39 99.9% 4985.28 3.73 4996.27 14.72 99.71% 99.93% 0.61% 0.50% 
AC-G 10000 × 39 99.9% 4985.98 2.98 4997.02 14.02 99.72% 99.94% 0.67% 0.52% 
Phase to phase 
fault 
AB 10000 × 39 99.9% 4990.62 7.52 4992.48 9.38 99.81% 99.85% 0.40% 0.31% 
BC 10000 × 39 99.9% 4990.42 8.71 4991.29 9.58 99.81% 99.83% 0.45% 0.34% 
AC 10000 × 39 99.9% 4990.37 9.48 4990.52 9.63 99.81% 99.81% 0.41% 0.32% 
Three phase fault ABC 10000 × 39 99.9% 4994.10 3.95 4996.05 5.90 99.88% 99.92% 0.71% 0.57% 
Three phase to 
ground fault ABC-G 10000 × 39 99.9% 4995.18 3.64 4996.36 4.82 99.90% 99.93% 0.60% 0.46% 
High-impedance 
fault HIF 10000 × 39 99.9% 4968.84 35.2 4964.76 31.16 99.38% 99.30% 0.73% 0.56% 
      Overall 99.75% 99.86% 0.54% 0.43% 
 
results yielded by the presented. system. The 
proposed system consists of several algorithms, i.e., 
symmetrical component analysis, multi-level 
wavelet transforms, principal component analysis, 
support vector machine, and adaptive structure 
neural networks. The overall hardware resources 
used in the Stratix-III FPGA are 92.7% 
(105,403/113,600) ALUTs, 4576 registers, 48 
memory blocks, and 618 pins. 
 The performance of the proposed system is 
evaluated using the waveforms simulated based on a 
real 345 kV Taipower power system. The proposed 
system is able to directly measure external analog 
signals to perform fault diagnosis. The response 
time of detecting a fault is around 0.0005 seconds, 
and the proposed system requires one-cycle time 
period to identify and locate the fault. The detection 
accuracy, sensitivity, specificity and location error 
of the diagnosis system are 99.9%, 99.7%, 99.8%, 
and 0.5%, respectively. 
 The major contribution of this work is that a 
general solution to simultaneously detect, classify, 
and locate faults in transmission lines is presented. 
The evaluation results presented in Part I of the 
series show that the proposed system is suitable to 
both simple and complex power systems. In Part II, 
we have shown that the proposed system and its 
runtime training technique also work well in real-
world scenarios using the simulated power 
waveforms based on a real 345 kV Taipower power 
system. 
V. Self-Evaluation 
7. 本研究之執行成果符合計畫目標，研究成果
之頗具學術價值，相關研究成果應可在學術
期刊發表。 
 
8. 本年度計畫之成果已與第一年、第二年計畫
之研究成果合併，並且擴充內容後撰寫成兩
篇電網保護系統之理論性論文，已投稿
IEEE Trans. Power Delivery，詳見附件二、
三。 
 
9. 本年度研究計畫之相關成果將彙整成論文分
別投稿於中華民國電力工程研討會及本年國
科會成果發表會。 
 
參考文獻 
[1] J.A. Jiang, C.L. Chuang, Y.C. Wang, C.H. Hung, 
J.Y. Wang, and Y.T. Hsiao, “A hybrid framework 
for fault detection, classification and location – Part 
I: concept, structure and methodology,” submitted to 
IEEE Trans. Power Delivery, 2010. 
[2] J. Rose, “Architecture of field-programmable gate 
arrays,” Proc. IEEE, vol. 81, no. 7, pp. 1013–1029, 
Jul. 1993. 
[3] 14-bit, Dual A/D Converter AD9248 Datasheet. 
Analog Devices. Available: 
http://www.analog.com/static/imported-
files/data_sheets/AD9248.pdf. 
[4] Stratix® III Device Family FPGA Datasheet. Altera 
Corporation. Available: 
http://www.altera.com/literature/hb/stx3/stx3_siii520
01.pdf. 
 
 
 
 
 
 
附件一 
 
已發表之期刊論文 
 
C.-L. Chuang, Y.-C. Wang, C.-H. Lee, M.-Y. Liu, Y.-T. Hsiao, and J.-A. Jiang, “An 
Adaptive Routing Algorithm over Packet Switching Networks for Operation 
Monitoring of Power Transmission Systems,” IEEE Transactions on Power Delivery, 
Vol. 25 (2), pp. 882-890, 2010. (SCI / EI) (NSC 94-2213-E-002-120, 95-2221-E- 
002-398, NSC 96-2628-E-002-252-MY3) 
CHUANG et al.: AN ADAPTIVE ROUTING ALGORITHM OVER PACKET SWITCHING NETWORKS 883
the maximal utility of the link capacity available in a telecom-
munication network. It has proved very successful in wide-area
network cores. By taking advantage of packet switching tech-
nology, we propose a new adaptive routing algorithm to enhance
system fault tolerance and priority control, and to reduce system
delay. The algorithm provides redundant links adjoined to the
communication network without increasing the complexity of
the network topology. With the proposed routing algorithm, the
network can transmit essential and general information about
the condition of power transmission lines with higher QoS. Fi-
nally, we conducted a computer simulation based on the archi-
tecture of the Taipower EHV/UHV transmission system.
This paper is organized into six sections, the first of which is
the introduction. In the Section II, we introduce the traffic model
incorporated with PMU, Global Positioning System (GPS), and
digital video cameras. Section III presents the packet-switching
based communication model and the proposed adaptive routing
algorithm. In the Section IV, we introduce the Taipower 345
kV power transmission network for performance evaluation.
Section V presents the test results of the proposed communica-
tion model and routing algorithm. Finally, we give conclusions
and a short discussion in the last section.
II. NETWORK TRAFFIC MODELS
A. Transmission Line Parameters at Power Transformer
Substations
In recent years, many previous studies have proved the
effectiveness of PMU in power protection systems [7]–[13].
The distinct feature of PMU is that it is able to provide phasor
measurement of voltages and currents from widely dispersed
locations in a power transmission network. PMU measures the
three-phase voltages and currents, simultaneously. To avoid
the effect of delay in communication links, PMU requires
an external sampling synchronization device to become fully
functional [9]. There are two approaches to synchronize the
time on each PMU, GPS, and Synchronous Optical Networking
(SONET). The GPS uses a constellation of Medium Earth
Orbit synchronous satellites that transmit microwave signals to
allow GPS receivers to determine their time. SONET uses two
closely related multiplexing protocols that transfer multiple
digital bit streams using laser diodes over the same optical fiber.
GPS receiver is a portable device so it can be easily moved or
reoriented. The accuracy of GPS time is 340 nanoseconds
relative to Coordinated Universal Time (UTC) on a single
time. SONET requires Ethernet links to operate. It is suitable
for power protection system if it starts with a highly accurate
Primary Reference Source (PRS) clock of Stratum-1 quality.
However, installing a Stratum-1 PRS to the system is highly
expansive and unsuitable for this study. In this study, since
the pulse per second (PPS) signal in GPS has an accuracy
ranging from a few nanoseconds to a few microseconds, we
integrate a commercial GPS receiver with PMU to provide for
the sampling synchronization. Previous studies have verified
the validity and performance of sampling synchronization
of GPS-PMU configuration via field tests in substations of
Taipower 161-kV power transmission networks [8], [9]. Fig. 1
Fig. 1. One-line two-side simulated power transmission system that is
equipped with GPS-PMU devices.
depicts a one-line two-side simulated power transmission
system that was equipped with GPS-PMU devices.
To measure the three phase voltages and three phase currents
with higher phase angle precision in a power system that has a
fundamental frequency of 60 Hz, we suppose that the sampling
rate of GPS-PMU is samples per second. We
use MATLAB/Simulink to simulate the power system, and then
take the simulated voltage and current waveforms as the syn-
chronized sampled data (three phase voltages and currents) from
power transformer substations. GPS-PMU organizes the mea-
sured transmission line parameters into a single packet. The ar-
rangement of the payload of the packet is as follows: 1) sequence
number ( , 2 bytes); 2) time stamp ( , 7 bytes); 3)
GPS time ( , 8 bytes); 4) GPS status ( , 1 byte);
and 5) measured transmission line parameters ( , 48 bytes).
Since the total size of measured data is 66 bytes per sample, ac-
cording to the specification of packet-switching techniques [14],
we need to split each packet into two smaller cells. The packets
have a 53-byte fixed-size format (including 5 bytes of header
information). Thus, the network traffic generated by each GPS-
PMU is (106 cells) per second.
Fig. 2 shows the format of cells generated by GPS-PMU.
B. Weather Monitoring and Video Surveillance on Pylons
In recent years, wireless sensor networks have became an ac-
tive topic in the fields of wireless communication and measure-
ment instrumentation. A network of compact surveillance sen-
sors is now available on the commercial market. Each sensor
module is equipped with a tri-axial accelerometer, temperature
sensor, and humidity sensor. We can integrate a digital camera
and a wind speed meter with the sensor module to make wire-
less video surveillance and wind speed monitoring possible.
In the simulation part of this study, we suppose that every
electricity pylon has a sensor module attached to it. The sensor
modules can spot potential threats such as bad weather or
earthquake. Digital cameras on the sensor modules provide
visual observation of the status of power transmission lines. The
sensor modules feed information on what is happening around
the pylon back to the monitoring center for further analysis.
Since the average distance between two pylons is about 300
m, the wireless sensor module needs an external high-gain an-
tenna for connectivity. The sensor module constantly measures
Authorized licensed use limited to: National Taiwan University. Downloaded on May 28,2010 at 04:25:12 UTC from IEEE Xplore.  Restrictions apply. 
CHUANG et al.: AN ADAPTIVE ROUTING ALGORITHM OVER PACKET SWITCHING NETWORKS 885
Fig. 4. Architecture of the shared memory ATM switches.
network. Thus, no hot spot (i.e., the switch that works with max-
imal capacity) is created. In order to attain these functions, net-
work administrators need to constantly update the routing table
on every switch. In this section, we present an adaptive routing
algorithm that enables the switches to automatically update its
routing table to attain an optimal path for packets. The routing
algorithm is a standalone algorithm that allows the switches to
work independently without any assistance from network ad-
ministrators or control computers in the monitoring center.
We suppose that we constructed a packet-switching commu-
nication network , where is a set of ATM switches,
and is a set of links. Let be a power transformer substation,
and let be the monitoring center. The communication network
in fact is a graphic model as depicted in Fig. 5. The substation
is equipped with a GPS-PMU. The GPS-PMU puts the values
of transmission line parameters in a packet and sends the packet
to the monitoring center via the packet-switching network. In
addition, the substation also relays packets received from other
substations (e.g., , , etc.) and wireless sensor modules (e.g.,
, , etc.) to the monitoring center. We classify connections
into two categories, constant bit rate (CBR) connections and un-
specified bit rate (UBR) connections.
The proposed routing algorithm consists of two stages, an ex-
ploration stage, and an evolutionary stage. First, we connect all
switches in according to the predetermined links in . The first
task for the switch at substation is to identify its neighboring
switches (forexample, at , , etc.) andconstructaprivatecon-
nection matrix to register all possible outgoing links. It also
initializes a goodness of links matrix to register the goodness
of outgoing links for forwarding a cell to the destination . Then,
the switch enters the first stage of the routing algorithm.
In this study, the mission of the packet-switching communica-
tion network is to monitor and transfer the operation status of the
Fig. 5. Packet switching communication network for monitoring and trans-
ferring the operational status of power transmission systems. The dashed blue
lines are wireless links, and solid blue lines are hardwired links in the packet
switching network.
power transmission system. Thus, the final destination of all in-
formation is the computers in the monitoring center. Under this
assumption, Fig. 6 shows the flow diagram of the first stage (ex-
ploration stage) in the proposed routing algorithm. The switch
that connected to the network sends out a number of set-up re-
quest cells to the switch in the monitoring center . When
receives these cells, it sends back ACK cells to , and then
sends an empty packet switching cell with timestamp to . Fi-
nally, sends ACK cells back to , again, to report transmission
delay times of the cells. The switch uses the average transmis-
sion delay on each outgoing link to calculate goodness of links
matrix by
(1)
Authorized licensed use limited to: National Taiwan University. Downloaded on May 28,2010 at 04:25:12 UTC from IEEE Xplore.  Restrictions apply. 
CHUANG et al.: AN ADAPTIVE ROUTING ALGORITHM OVER PACKET SWITCHING NETWORKS 887
Fig. 8. Topology of a real 345-kV power transmission network system encoun-
tered in Taiwan.
the wireless sensor networks to the packet switching network as
branches connected to ATM switches.
To verify the performance of the proposed adaptive routing al-
gorithm over the packet switching network, we have conducted
extensive simulation studies for various network failures and
network traffic conditions. We discuss the simulation scenarios
in the next section.
V. PERFORMANCE EVALUATION
In this section, we evaluate the performance of the pro-
posed routing algorithm based on the traffic model and packet
switching network model described in previous sections. The
transmission traffic consists of three types of data, transmission
line parameters, environmental conditions, and video surveil-
lance streams. The GPS-PMU installed at each substation
measure the three-phase voltages and currents on the bus,
and sends the measurement results to the monitoring center
via a packet switching network. This type of data is essential
for the protection system of power transmission network and
requires the highest priority traffic without excessive delay
time. The goal of this study is to test the robustness of the pro-
posed routing algorithm when the network traffic encompasses
packets from different kinds of networks.
To set up the simulation conditions, we refer to the specifica-
tions of the ‘Cisco Catalyst 8540’ ATM switch. We assume that
the ATM switch is equipped with one route processor and two
switch processors, and the bandwidth of the shared memory is
40 Gbps. The function of the two deployed switch processors
TABLE I
PROFILE OF THE TESTING POWER SYSTEM
is to enhance the throughput. The maximum throughput of the
ATM switch is 24 million cells per second.
In order to reduce the cost of constructing the telecommuni-
cation network, we build 22 short distance ATM transmission
links between 17 power transformer substations in the tested
sample network. Each substation has no more than three
transmission links connected with other substations. Thus, the
network topology is simply a mesh network. The transmission
delay time for transmitting a cell depends heavily on the speed
of the ATM fabric and is calculated by
(7)
where the maximum delay time on the ATM fabric is 41.6 ns
(switching 24 000 000 cells per second). The routing delay de-
pends on the operating frequency of the route processor. In this
simulation, we assume that the routing delay is 10 ns. For a
shared memory switch with 155 Mbps transmission speed, the
queueing delay is 2.83 s times the number of cells in the queue
of the output port controller. The miscellaneous delay time is
extra delay time caused by other factors, e.g., speed of electric
signals (speed of light). The channel release time is set to 1 min.
Each switch can maintain a maximum of 65 535 channels.
Authorized licensed use limited to: National Taiwan University. Downloaded on May 28,2010 at 04:25:12 UTC from IEEE Xplore.  Restrictions apply. 
CHUANG et al.: AN ADAPTIVE ROUTING ALGORITHM OVER PACKET SWITCHING NETWORKS 889
Fig. 10. Box-plot of average delay time versus number of activated cameras obtained in 1000 repeats of simulations. In this figure, thin red lines represent the
samples that fall in the inter-quartile range, and thin black lines represent the samples that fall in the range of non-outlier observations. Red crosses represent outlier
observations, mostly caused by cameras at some distance from substations.
We suppose that all communication links connected with the
8th substation are entirely failed during the simulation. The sub-
stations that depend on the 8th substation to relay network traffic
(6th, 9th, 11th, 12th, 14th, and 15th substations) send out 250
setup request cells to find out an alternative path to transmit cells
to monitoring center. The experimental results are
where “ ” represents a modification of the connection path. We
can see that the network failure occurring at the 8th substa-
tion slightly affected the QoS of other communication channels.
However, the time needed for the network to recover stability
is lesser than 2 ms. Fig. 11 shows the delay time variances of
each communication channel before and after the 8th substa-
tion failed.
VI. CONCLUSIONS
In this study, we proposed a communication model for a
power transmission protection system and an adaptive routing
algorithm for packet switching networks. By cooperating
with ATM switches, the communication model encompasses
a complete monitoring configuration for power transmission
switching networks and wireless sensor networks to form a
system. In order to produce precise simulation results, the
Fig. 11. Delay time variances of each communication channel before and after
the 8th substation failed.
detailed traffic model and network architectures are given to
define the entire system.
A real Taipower 345-kV transmission network was modeled
for the simulation. The simulation results have shown that the
proposed algorithm is able to automatically discover the best
path to transmit data to the desired destination, to collect data
from different platforms, and is robust against network failure.
Also, the priority control helps the ATM switches guarantee the
QoS of essential transmission line parameters. Finally, the pro-
posed algorithm and communication model have shown their
effectiveness for adaptive and priority controls.
ACKNOWLEDGMENT
The authors would also like to thank Prof. R. R. Bailey for his
proofreading of the manuscript and making a number of helpful
suggestions.
REFERENCES
[1] B. Lian and M. M. A. Salama, “An overview of digital fault loca-
tion algorithm for power transmission lines using transient waveforms,”
Elect. Power Syst. Res., vol. 29, pp. 17–25, 1994.
Authorized licensed use limited to: National Taiwan University. Downloaded on May 28,2010 at 04:25:12 UTC from IEEE Xplore.  Restrictions apply. 
 
 
 
 
 
 
附件二 
 
已投稿之期刊論文 
 
J.A. Jiang, C.L. Chuang, Y.C. Wang, C.H. Hung, J.Y. Wang, C.H. Lee, and Y.T. Hsiao, 
“A Hybrid Framework for Fault Detection, Classification, and Location—Part I: 
Concept, Structure and Methodology,” submitted to IEEE Transactions on Power 
Delivery, 2010. 
附件二 2
index, to increase [10]–[12]. To lower these indices, various 
methods have been proposed to detect, classify, or locate 
faults in power transmission lines in recent years. It is also 
essential to classify the faults and identify which phases in-
volved. The features of faults have been extracted using vari-
ous filters, such as fast Fourier transforms [13]–[17], Kalman 
filter [18], fractal [19], and wavelet transforms [20]. For ex-
ample, wavelet transforms and artificial neural networks have 
been successfully used to detect and classify faults in trans-
mission lines [21]–[23]. A hybrid of wavelet transforms and 
support vector machines have been proposed to inspect fault 
zones in a power system [24]. In addition, model-based struc-
tural analysis has been applied to fault detection and location 
in power systems [25]–[27].  
Most of the aforementioned works were validated via 
simulation studies, and their actual performance tested in a 
real-world scenario still remains unknown. This is because 
hardware implementation of fault protection techniques is rare; 
only a handful of studies reported field testing with hardware 
implementation [28]–[33]. These studies, however, accom-
plished only partial functions of a protection system. Moreo-
ver, the automation of a protection system can be achieved by 
combining all of the functions proposed by these studies in a 
system, but it may run into the problem of time consuming. In 
order to efficiently enhance the automation level of a power 
protection system, the main focus of this study is to propose a 
framework that can be implemented using the field-
programmable gate array (FPGA) technology for real-world 
scenarios. In this paper, we present a hybrid framework that 
consists of a symmetrical component analysis for fault detec-
tion, a multi-level complex wavelet transformation, a principal 
component analysis, a set of support vector machines, and 
adaptive structure neural networks for fault classification and 
fault location. 
The main contributions of this series of two papers are 
summarized as follows. 
1) A new framework is developed in this paper to detect 
the presence of fault in the transmission line. 
2) The proposed framework calculates the fault location 
based on the measurement of post-fault three-phase 
voltages and currents. 
3) Since the impedance and load model may vary accord-
ing to the actual condition of the transmission lines, 
the proposed framework uses an online trainable neu-
ral network to estimate the fault location. 
4) The proposed algorithm not only detects and classifies 
the fault type in the power system, but also estimates 
the fault zone and location between two buses. 
5) This study provides the details of implementing the 
proposed hybrid framework using the FPGA technolo-
gy, and the performance of the system is validated via 
hardware-based experiments. The framework enters 
power efficient mode when there are no faults in the 
power system. 
The fundamental theories and mathematical principles of 
the proposed framework are presented in Section II where the 
system architecture of the proposed framework is introduced. 
Section III is devoted to a throughout explanation of the pro-
posed fault detection, classification, and location algorithms. 
The system configuration for collecting pre-fault and during-
fault data from bus terminal is described in Section IV. Sec-
tion IV also shows the results of software analysis using the 
toolbox in MATLAB/Simulink [34]. Simulation results are 
discussed in Section V. In addition, the details of implement-
ing the proposed framework using the FPGA technology and 
the performance of the framework tested in real-world scenar-
ios will be presented in the subsequent paper. 
II.  THE PROPOSED HYBRID FRAMEWORK 
In this section, the proposed hybrid framework for fault de-
tection, classification, and location is introduced from a sys-
tematic view. The overall architecture of the proposed protec-
tion system is illustrated in Fig. 1. The voltage and current 
signals obtained from the power system are analog signals. 
The first step of any digital/numerical relay is to convert ana-
log signals into digital signals. Given that, the focus of this 
paper is on the numerical and mathematical models used in the 
proposed framework, detailed information regarding analog-
to-digital conversion will be introduced in the subsequent pa-
per. In this paper, we assume that the fundamental frequency 
of the power system is 60 Hz. A sampling rate of 3,840 Hz 
(64 samples per cycle, measured by advanced power meas-
urement units) is chosen to extract signals from the transmis-
sion lines. Measurement units are installed at buses to obtain 
three-phase voltage and current signals. The acquired data is 
then transmitted to regional fault analysis stations via a wide-
area-network (WAN) for fault detection, classification, and 
location. The regional fault station center is made by a FPGA-
based standalone server. The recorded fault signals are orga-
nized into oscillographic records, and diagnosis engineers at 
the utility company can have access to the records from the  
 
Bus #1 Bus #2
Bus #3
Bus #4
Protected section between 
buses #1 and #3
Protected section 
between buses #1 and #5
Bus #5
SA
SB
SC
Measurement unit
Load
WAN
Regional fault 
analysis station
(Standalone server)
WAN
Oscillographic
server
Analysis
Online
tuning
Diagnosis engineers  
Fig. 1. Simplified physical model of the proposed hybrid framework. 
附件二 4
noted by Vabc and Iabc, where Vabc = (Va, Vb, Vc) and Iabc = (Ia, 
Ib, Ic). The three symmetrical components for voltages and 
currents can be arranged into vectors as V012 = (V0, V1, V2) and 
I012 = (I0, I1, I2), where subscribes 0, 1, and 2 represent the 
zero, positive, and negative sequence components, respective-
ly. The negative sequence voltages (V2,a, V2,b, V2,c) and cur-
rents (I2,a, I2,b, I2,c) can be calculated using the following equa-
tions 
2,
2,
2
2,
0
120
240
a a a
b a a
c a a
V V V
V V V
V V V


   
   
   
, and      (1) 
2,
2,
2
2,
0
120
240
a a a
b a a
c a a
I I I
I I I
I I I


   
   
   
,        (2) 
where α = 2 31 2 3 2 jj e    , representing a phase rota-
tion operator with unit magnitude that rotates a phasor vector 
counter-clockwise by 120 degrees or 2π/3 radians. Using a 
matrix inversion method, we can obtain the negative sequence 
components for both voltages and currents by the following 
formulas: 
 22 13 a b cV V V V    , and     (3) 
 22 13 a b cI I I I    .       (4) 
According to the theory of symmetrical analysis, the calcula-
tion of symmetrical components in a balanced three-phase 
system results in positive sequence voltages (V1 = 1 p.u.) and 
currents (I1 = 1 p.u.) but no negative or zero sequence voltages 
and currents. 
In the proposed approach, the negative sequence compo-
nents of voltages and currents are used as fault indicators. 
However, negative sequence voltages or currents require a 
simple convolution operation in order to lower the possibility 
of issuing false alarms. A joint fault indicator is thus designed 
to perform a more stable detection of fault occurrences, which 
can be formulated as below 
     
      
2 2
2 2    ,   
D t V I R t
V t I t R d   
  
    
    (5) 
where D(t) is the value of the joint fault indicator measured at 
time t. R(τ) is a triangular function that can be presented by 
        1 20 0.05R t t H t H t     ,    (6) 
where H(t) is the Heaviside step function. The results of R(t) 
as a triangular function are depicted in Fig. 3. By using Eqs. 
(5) and (6), the joint fault indicator is not only sensitive when 
a fault occurs, it also produces a stable fault alarm after a fault 
occurs. If D(t) reaches a value larger than 1 (obtained by pa-
rameters in Eq. (6), i.e. 0.05 × 20), it indicates that the fault 
detection module discovers the existence of a fault that occurs 
in the power system at time t. 
A 735 kV overhead transmission line with a 2,100 MVA 
simplified synchronous machine, a total length of 1000 km,  
M
ag
ni
tu
de
 
Fig. 3. The triangular wave defined in Eq. (6). It is used in the convolution 
operation in Eq. (5) to stabilize the output of the proposed joint fault indicator. 
 
0.98 0.99 1 1.01 1.02 1.03 1.04 1.05 1.06 1.07 1.08
-2
0
2
0.98 0.99 1 1.01 1.02 1.03 1.04 1.05 1.06 1.07 1.08
0
0.02
0.04
0.98 0.99 1 1.01 1.02 1.03 1.04 1.05 1.06 1.07 1.08
-2
0
2
0.98 0.99 1 1.01 1.02 1.03 1.04 1.05 1.06 1.07 1.08
0
50
100
0.98 0.99 1 1.01 1.02 1.03 1.04 1.05 1.06 1.07 1.08
0
2000
4000
time
(e)
time
(d)
time
(c)
time
(b)
time
(a)
 
Fig. 4. (a) The resulted voltage signals and (b) its corresponding negative 
sequence voltages. (c) The resulted current signals and (d) its corresponding 
negative sequence currents. (e) The time course record of the joint fault indi-
cator. In (a) and (c), signals of different phases are depicted in different colors, 
i.e. phase-A in red, phase-B in blue and phase-C in green. 
 
has been simulated using MATLAB/Simulink software. When 
t = 1 second, three-phase power transmission lines to ground 
fault (ABC-G) is triggered at a location distanced 0.95 p.u. 
from the bus equipped with a PMU. The resulted voltage and 
current waveforms are depicted in Fig. 4, showing the patterns 
of fault signals, negative sequence voltages and currents. In 
Fig. 4(a) and Fig. 4(c), the fault signals reach the bus at t = 
1.0034 seconds, and the values of negative sequence voltages 
and currents begin increasing at the same time, which are de-
picted in Fig. 4(b) and Fig. 4(d). These values are not stable as 
faults exist, so they cannot be directly used as fault indicators. 
Furthermore, the joint fault indicator detects the fault when t = 
1.0037 seconds, as shown in Fig. 4(e). Such short response 
time (0.0003 seconds) and steady values of joint fault indica-
tor make it an effective trigger to activate both fault classifica-
tion and fault location modules. These modules will be ex-
附件二 6
1 1.005 1.01 1.015
-2
0
2
time (sec)
(p
.u
.)
1 1.005 1.01 1.015
-2
0
2
time (sec)
(p
.u
.)
1 1.005 1.01 1.015
-1
0
1
time (sec)
(p
.u
.)
1 1.005 1.01 1.015
-2
0
2
time (sec)
(p
.u
.)
1 1.005 1.01 1.015
-0.5
0
0.5
time (sec)
(p
.u
.)
a1
D
W
T
ab
c
V
d1
D
W
T
ab
c
V
a1
D
W
T
ab
c
V
d1
D
W
T
ab
c
V
ab
c
V
(a)
(b) (c)
(d) (e)  
Fig. 6. Sample fault signals simulated using MATLAB. (a) Three-phase volt-
age waveform. (b) and (c) show the 1st level wavelet approximation and detail 
coefficients of the voltage signals, respectively. (d) and (e) show the 2nd level 
wavelet approximation and detail coefficients of the voltage signals, respec-
tively. Signals of different phases are depicted in different colors, i.e. phase-A 
in red, phase-B in blue and phase-C in green. 
 
(p
.u
.)
(p
.u
.)
(p
.u
.)
(p
.u
.)
(p
.u
.)
a1
D
W
T
ab
c
I
d1
D
W
T
ab
c
I
a1
D
W
T
ab
c
I
d1
D
W
T
ab
c
I
ab
c
I
 
Fig. 7. Sample fault signals simulated using MATLAB. (a) Three-phase cur-
rent waveform. (b) and (c) show the 1st level wavelet approximation and detail 
coefficients of the current signals, respectively. (d) and (e) show the 2nd level 
wavelet approximation and detail coefficients of the current signals, respec-
tively. Signals of different phases are depicted in different colors, i.e. phase-A 
in red, phase-B in blue and phase-C in green. 
 
Cb and Cc contain 64 of these vectors (k = 1, …, 64). 
Ca, Cb and Cc are mean-centered by subtracting the mean 
value from each coefficient vector. Let 
DWT_y
xV  and 
DWT_y
xI  
represent the mean of y-th level wavelet coefficients of 
DWT_y
xV  and 
DWT_y
xI  in the phase-x of the transmission line, 
respectively. 
 64DWT_ DWT_
1
1 ,
64
y y
x x
k
V V k

         (12) 
 64DWT_ DWT_
1
1 ,
64
y y
x x
k
I I k

       (13) 
where    , , , and d1,d2x a b c y  . Then, the mean-centered 
wavelet coefficients can be defined 
       
DWT_d1
DWT_d2
DWT_d1
DWT_d2
,
          
x
x
x x
x
x
V
V
C C
I
I
        (14) 
where  , ,x a b c  and  xC  represents mean-centered wavelet 
detail coefficients of voltages and currents in the phase-A, -B, 
and -C of the transmission line, respectively. In order to find a 
vector e which has the largest possible projection onto each 
column of  xC , we need to find a set of orthonormal vectors 
ex(k) such that the quantity 
             64 2
1
1
64
T
xx x
k
k e k C k

       (15) 
is maximized with the orthonormality constraint that  
             ,Tx x xe l e k l k ,      (16) 
where  , ,x a b c , and δx(l, k) is an identity matrix of size l × 
k. 
ex(k) and λx(k) are given by the eigenvectors and eigenval-
ues of the covariance matrix 
          Tx xxCov C C .        (17) 
In order to obtain the vectors ex(k) and scalars λx(k), we can 
solve the eigenvectors and eigenvalues of  Tx xC C . Let dk and 
μk be the eigenvectors and eigenvalues of  Tx xC C , respectively, 
so 
          Tx x k k kC C d d .        (18) 
By multiplying both sides by  xC  
            Tx x x xk k kC C C d C d ,     (19) 
which means that the first M – 1 eigenvectors ex(k) and eigen-
values λx(k) of  Tx xC C  are given by  x kC d  and μk for the trans-
mission line with phase x{a, b, c}, respectively. However, 
 x kC d  needs to be normalized in order to be equal to ex(k). 
The eigenvectors corresponding to nonzero eigenvalues of 
the covariance matrix Covx produce an orthonormal basis for 
the subspace within which most wavelet detail coefficients of 
voltages and currents in the phase-x of the transmission line 
can be represented with a small amount of error. The eigen-
vectors are sorted by their corresponding eigenvalues in a de-
creasing order. The eigenvector associated with the largest 
eigenvalue is the one that reflects the greatest variance in the 
wavelet detail coefficients. Since the sorted eigenvalues de-
crease in exponential fashion, roughly 90% of the total vari-
ance is contained in the first 5% to 10% of the dimensions.  
The wavelet detail coefficients can be projected onto M' 
( 64) dimensions by computing 
       ,1 ,2 ,,  ,...,  x x x x M        ,     (20) 
附件二 8
training samples [45]. Since the training of SVMs is in offline 
fashion, the quadratic complexity is acceptable as long as the 
number of training samples is lesser than, say, one million. 
Generally, in this study, it is not possible to use a training data 
set of size one million; thus, the training of SVMs can be 
completed in lesser than one minute. 
In the proposed framework, as shown in Fig. 8, each SVM 
is designed to identify a type of fault event. The classification 
functions and the output patterns of these SVMs are summa-
rized in Table I. The output will be an output vector with six 
elements denoted by T, and T = [T1, T2, T3, T4, T5, T6]. Please 
note that the binary SVM classifiers in this module also pro-
vide relative strengths for comparison if a fault event belongs 
to more than one class. Elements of output patterns are dis-
played by using signal ‘1’ for faulty condition, and ‘–1’ for 
normal condition. 
C.  Fault Location Module 
In this study, a set of adaptive structural neural networks 
(ASNNs) are used to estimate fault location. As shown in Fig. 
8, after the SVMs determine the fault type, the proposed 
framework will activate an associated ASNN to precisely lo-
cate the position of the fault. ASNN was previously proposed 
to be an adaptive neural network with minimal predetermined 
parameters and a dynamic structuring mechanism [47]. Be-
cause of the dynamic structuring mechanism, we can continu-
ously enhance the performance of the proposed framework via 
the runtime training technique. Such technique allows the en-
gineers to train the ASNN when they collected new training 
samples. Any initialization process is not required. Detailed 
information regarding ASNN, please refer to [47] and 
http://bem.bime.ntu.edu.tw/clchuang/ASNN.pdf. 
The detailed input/output configuration of the fault location 
module is depicted in Fig. 9. Training samples tD

 and its cor-
responding fault location Lt are obtained previously through 
real-world measurements from power systems or computer-
based simulations. Before the proposed framework is being 
applied to fault diagnosis, each network in the set of ASNNs 
needs to be properly trained using tD

 and Lt in order to allow 
the framework to become functional.  
When the proposed framework is monitoring the system, 
the principal component scores of fault voltages and currents 
in each phase of the transmission line  x  for x{a, b, c} (i.e. 
a  = [υa,1, υa,2], b  = [υb,1, υb,2] and c  = [υc,1, υc,2]) serve as 
the inputs of the ASNN activated by its associated SVM. Af-
ter the ASNN completes the analysis, the estimated location of 
fault, denoted by L, will be presented at the output of the 
ASNN. 
It is worth to mention that the primary purpose of using 
ASNN in the fault location module is to increase the flexibil-
ity of the proposed framework. Training without re-initializing 
the neural network is an important feature since the power 
company cannot afford to shut down the monitoring system 
for the power grid too long. 
IV.  EXPERIMENTAL RESULTS 
Line voltages Vabc = (Va, Vb, Vc) and currents Iabc = (Ia, Ib, Ic) 
at a frequency of 60 Hz are measured at the end of the line 
near the generator in order to perform fault diagnosis. 
Daubechies-4 mother wavelet is well capable of capturing the 
time of the transient phenomenon and extracting high and low 
frequency components during power system faults. An exten-
sive series of simulation studies are conducted using 
MATLAB/Simulink software in an Intel i7-720QM laptop 
computer with 4 GB RAM. The hardware implementation and 
its performances in real-world test scenarios are presented in 
the subsequent paper. 
 
TABLE I 
CLASSIFICATION FUNCTION, DETAILED CLASSIFICATION, AND OUTPUT 
PATTERN OF THE SVMS IN THE FAULT CLASSIFICATION MODULE 
Classi-
fier 
Classification 
function 
Detailed
Info
Input vector with  
unique pattern 
hyper-
planes Output
SVM
#1 
Phase to 
ground fault
A-G a  
3 T1 B-G b  
C-G c  
SVM
#2 
Double phase 
to ground fault
AB-G { a , b } 
3 T2 BC-G { b , c } 
AC-G { a , c } 
SVM
#3 
Phase to phase 
fault 
AB { a , b } 
3 T3 BC { b , c } 
AC { a , c } 
SVM
#4 
Three phase 
fault ABC
{
a , b , c } 3 T4 
SVM
#5 
Three phase to 
ground fault ABC-G
{
a , b , c } 3 T5 
SVM
#6 
High-
impedance 
fault 
HIF { a , b , c } 3 T6 
 
PCA
SVM
[υa,1, υa,2]
[υb,1, υb,2]
[υc,1, υc,2]
Trigger
Fault 
Location
L
ASNN
Dynamic structuring 
mechanism
Neuron creation and 
deletion
Link searching and 
pruning
Runtime training
Training samples
Diagnosis engineers
 , ,t ta tb tcD       and Lt
 
Fig. 9. Detailed diagram of the input/output configuration of ASNN for fault 
location. 
附件二 10
2n
d
P
rin
ci
pa
l C
om
po
ne
nt
2n
d
P
rin
ci
pa
l C
om
po
ne
nt
 
Fig. 12. Data projection for (a) phase to ground fault and (b) high-impedance 
fault. The dashed lines show the hyperplanes of the trained SVM correspond-
ing to the fault. The node descriptions denote the fault location in the trans-
mission line estimated by ASNN corresponding to the fault, where 0 and 1 p.u. 
represent distance of 0 and 1000 km from the bus near the generator, respec-
tively. 
 
simulation case of high-impedance fault. The principal com-
ponent scores of signals in each phase show unique patterns in 
the feature space. The pattern also shows a clear trend associ-
ated with the position of the fault. 
    3)  Simulation Results 
After the proposed framework is properly tuned by the 
training dataset, we validate the framework by applying it to 
the test dataset. The simulation results are summarized in Ta-
ble III. It shows that the proposed algorithm can accurately 
detect, classify, and locate faults, regardless of what type of 
faults they are. The performances of the proposed framework 
are demonstrated via sensitivity, specificity, and location error, 
and their definitions are 
  100%,Sensitivity TP TP FN        (30) 
  100%,Specificity TN TN FP       (31) 
 est real 1000 100%,Location Error L L     (32) 
where TP, FP, TN and FN represent number of true-positives, 
false positives, true-negatives, and false-negatives, respective-
ly. Lest and Lreal denote the position estimated by the frame-
work and the real position of the fault, respectively. Different 
from most of the related studies, we also evaluate the specific-
ity of the proposed method, since false alarms could cause 
massive damage to end-users and the economy. 
As shown in Table III, the proposed framework learned 
well from the training dataset. This means that the WT and 
PCA are able to effectively capture the features of fault sig-
nals. The proposed framework also yields good performances 
when examined by the test dataset. The averaged sensitivity 
and specificity yielded by the proposed method are 99.8% and 
99.9%, respectively. The largest location error is consistently 
lesser than 1%, which shows that the location error is not in-
fluenced by fault resistances, fault locations, and fault types. 
The second training dataset is then applied to train the ASNNs 
via the runtime training technique [47]. The averaged location 
error is improved to 0.41%. Thus, we can re-train the ASNNs 
once new faults or normal signals are available. Furthermore, 
since different fault resistances may cause the accuracy of 
fault location to drop, we also summarize the simulation re-
sults in Table IV to show the relationship between fault re-
sistance and location accuracy. The result shows that the aver-
aged error of fault location yielded by the proposed frame-
work is also lesser than 1%, regardless of the actual fault loca-
tions over the whole length of the line. 
B.  Performance evaluation using the IEEE 14-bus Test Sys-
tem 
    1)  Power System Model, Training, and Test Datasets 
An IEEE 14-bus power system is used to evaluate the per-
formance of the proposed framework. The schematic diagram 
of the power system is depicted in Fig. 13. The parameters of 
the network include five generators, 14 buses, loads totaling 
259 MW and 81.3 Mvar. Detailed information and parameters 
are available in [48]. The line length can be calculated using 
the resistance per unit length mentioned in Table II. Assume  
 
TABLE III 
SIMULATION RESULTS OF THE PROPOSED FRAMEWORK USING THE SIMPLE POWER NETWORK 
Fault type # of test samples 
Detection 
accuracy 
Classification and location test 
TP FP TN FN Sensitivity Specificity Avg. location error 
Avg. location 
error 
(re-trained) 
Phase to 
ground fault 
A-G 10000 100.0% 4994 1 4999 6 99.88% 99.98% 0.41% 0.31% 
B-G 10000 100.0% 4992 0 5000 8 99.84% 100.00% 0.42% 0.32% 
C-G 10000 100.0% 4992 1 4999 8 99.84% 99.98% 0.44% 0.32% 
Double phase 
to ground fault 
AB-G 10000 100.0% 4993 1 4999 7 99.86% 99.98% 0.57% 0.44% 
BC-G 10000 100.0% 4990 2 4998 10 99.80% 99.96% 0.60% 0.46% 
AC-G 10000 100.0% 4989 2 4998 11 99.78% 99.96% 0.61% 0.49% 
Phase to phase 
fault 
AB 10000 99.9% 4995 5 4995 5 99.90% 99.90% 0.41% 0.35% 
BC 10000 99.9% 4996 6 4994 4 99.92% 99.88% 0.40% 0.34% 
AC 10000 99.9% 4995 4 4996 5 99.90% 99.92% 0.43% 0.37% 
Three phase 
fault ABC 10000 99.9% 4997 5 4995 3 99.94% 99.90% 0.74% 0.51% 
Three phase to 
ground fault ABC-G 10000 99.9% 4997 4 4996 3 99.94% 99.92% 0.67% 0.45% 
High-
impedance fault HIF 10000 99.9% 4975 29 4971 25 99.50% 99.42% 0.79% 0.51% 
      Overall 99.84% 99.90% 0.54% 0.41% 
附件二 12
TABLE V 
SIMULATION RESULTS OF THE PROPOSED FRAMEWORK USING IEEE 14-BUS POWER SYSTEM 
# Line 
Connecting 
buses Responsible Measurement 
units 
# of test  
samples 
Detection
accuracy
Classification and location test 
From To TP FP TN FN Sensitivity Specificity Avg. location Error 
1 1 2 1 2 120,000 99.9% 59861 59 59941 139 99.77% 99.90% 0.59% 
2 1 5 1 5 120,000 99.9% 59869 60 59940 131 99.78% 99.90% 0.55% 
3 2 3 2 3 120,000 99.9% 59871 62 59938 129 99.79% 99.90% 0.51% 
4 2 4 2 4 120,000 99.9% 59836 62 59938 164 99.73% 99.90% 0.61% 
5 2 5 2 5 120,000 99.9% 59839 62 59938 161 99.73% 99.90% 0.62% 
6 3 4 3 4 120,000 99.9% 59831 56 59944 169 99.72% 99.91% 0.45% 
7 6 11 6 11 120,000 99.9% 59842 55 59945 158 99.74% 99.91% 0.51% 
8 6 12 6 12 120,000 99.9% 59839 55 59945 161 99.73% 99.91% 0.49% 
9 6 13 6 13 120,000 99.9% 59837 55 59945 163 99.73% 99.91% 0.45% 
10 9 10 9 11 120,000 99.8% 59815 54 59946 185 99.69% 99.91% 0.89% 
11 9 14 9 13 120,000 99.9% 59823 57 59943 177 99.71% 99.91% 0.77% 
12 10 11 9 11 120,000 99.9% 59816 68 59932 184 99.69% 99.89% 0.85% 
13 12 13 12 13 120,000 99.9% 59849 62 59938 151 99.75% 99.90% 0.50% 
14 13 14 9 13 120,000 99.8% 59823 67 59933 177 99.71% 99.89% 0.69% 
         Overall 99.73% 99.90% 0.61% 
 
feature may allow the proposed framework to adapt to the 
changing conditions and architecture of a power system. 
The performance of the proposed framework is evaluated 
through the computer-based simulation studies. In a simple 
two-end power network, the proposed algorithm yielded 
99.9% fault detection accuracy, and 99.84% and 99.9% fault 
classification sensitivity and specificity, respectively. The 
averaged fault location error is 0.54%. We further enhance the 
performance of the proposed framework via the runtime train-
ing technique, and successfully improve the averaged location 
error to 0.41%. In the second simulation case, we used the 
IEEE 14-bus power system to evaluate the performance of the 
proposed framework. The proposed framework is deployed 
with 10 measurement units in the power systems. The pro-
posed method is able to detect, classify, and locate the fault in 
the power system; its averaged detection accuracy is 99.9%, 
and sensitivity and specificity of fault classification are 
99.73% and 99.9%, respectively. The averaged fault location 
error is around 0.61%. These results show that the proposed 
framework is useful in both simple and complex power system. 
In order to show the applicability of the proposed method 
in real-world scenarios, we have implemented the proposed 
framework using the FPGA technology. We are able to evalu-
ate whether the hardware implementation of the proposed 
method is robustness and efficient enough against noise sig-
nals from analog-to-digital converters and computational de-
lays. The results will be presented in the subsequent paper. 
VI.  ACKNOWLEDGMENT 
The authors gratefully acknowledge the National Science 
Council of Republic of China for financially supporting this 
research under contract number NSC 96-2628-E-002-252-
MY3. 
VII.  REFERENCES 
[1] P.M. Anderson, Power System Protection. New York: Wiley-IEEE Press, 
1998. 
[2] D. Düstegör, S.V. Poroseva, M.Y. Hussaini, and S. Woodruff, “Auto-
mated Graph-Based Methodology for Fault Detection and Location in 
Power Systems,” IEEE Trans. Power Del., vol. 25, no. 2, pp. 638–646, 
Apr. 2010. 
[3] IEEE Guide for Protection, Interlocking, and Control of Fossil-Fueled 
Unit-Connected Steam Stations, IEEE Std. 502-1985. 
[4] IEEE Recommended Practice for Protection and Coordination of Indus-
trial and Commercial Power Systems, IEEE Std. 242-1986. 
[5] IEEE Guide for the Protection of Network Transformers, ANSI/IEEE 
C37.108-1989. 
[6] V. Venkatasubramanian, R. Rengaswamy, K. Yin, and S.N. Kavuri, “A 
review of process fault detection and diagnosis Part I: Quantitative mod-
el-based methods”, Computers and Chemical Engineering, vol. 27, pp. 
293–311, 2003. 
[7] V. Venkatasubramanian, R. Rengaswamy, K. Yin, and S.N. Kavuri, “A 
review of process fault detection and diagnosis Part II: Qualitative mod-
els and search strategies”, Computers and Chemical Engineering, vol. 
27, pp. 313–326, 2003.  
[8] V. Venkatasubramanian, R. Rengaswamy, K. Yin, and S.N. Kavuri, “A 
review of process fault detection and diagnosis Part III: Process history 
based methods”, Computers and Chemical Engineering, vol. 27, pp. 
327–346, 2003. 
[9] A. Maghsooloo, A. Khosravi, H.S. Anvar, and R. Barzamini, “ANFIS 
and PCA Capability Assessment for Fault Detection in Unknown Non-
linear Systems,” Proceedings of the 3rd International Symposium on 
Communications, Control and Signal Processing, pp. 47–52, St. Julians, 
UK, March 2008. 
[10] T. Short, Electric power distribution handbook, CRC Press, 2003. 
[11] J. Mora-Flórez, V. Barrera-Núñez, and G. Carrillo-Caicedo, “Fault loca-
tion in power distribution system using a learning algorithm for multi-
variable data analysis,” IEEE Trans. Power Del., vol. 22, no. 3, pp. 
1715–1721, July 2007. 
[12] J. Mora-Flórez, G. Morales-España, and S. Pérez-Londoño, “Learning-
based strategy for reducing the multiple estimation problem of fault zone 
location in radial power systems,” IET Gener. Transm. Distrib., vol. 3, 
no. 4, pp. 346–356, April 2009. 
[13] B. D. Russell and R. P. Chinchali, “A digital signal processing algorithm 
for detecting arcing fault on power distribution feeders,” IEEE Trans. 
Power Del., vol. 4, no. 1, pp. 132–140, Jan. 1989. 
[14] B. M. Aucoin and B. D. Russell, “Distribution high impedance fault 
detection using high frequency current components,” IEEE Trans. Pow-
er App. Syst., vol. PAS-101, no. 6, pp. 1596–1606, Jun. 1982. 
[15] Y. Sheng and S. M. Rovnyak, “Decision tree-based methodology for 
high impedance fault detection,” IEEE Trans. Power Del., vol. 19, no. 2, 
pp. 533–536, Apr. 2004. 
[16] A. Lazkano, J. Ruiz, L. A. Leturiondo, and E. Aramendi, “High imped-
ance arcing fault detector for three-wire power distribution networks,” in 
Proc. 10th. Mediterranean Electrotechnical Conf., vol. 3, May 29–31, 
2000, pp. 899–902. 
 
 
 
 
 
 
附件三 
 
已投稿之期刊論文 
 
J.A. Jiang, C.L. Chuang, Y.C. Wang, C.H. Hung, J.Y. Wang, C.H. Lee, and Y.T. Hsiao, 
“A Hybrid Framework for Fault Detection, Classification, and Location—Part II: 
Implementation and Test Results by Simulation,” submitted to IEEE Transactions on 
Power Delivery, 2010. 
附件三 2
FPGA-based experimental platform is constructed with two 
independent systems:  
1) Real-time power system simulator: In order to evaluate 
the performance of the implementation of the proposed 
framework, an FPGA-based real-time power system 
simulator is developed to produce analog three-phase 
voltage and current signals obtained from 
MATLAB/Simulink. The analog signals outputted by the 
simulator may contain an uncertain level of noises 
caused by the system and signal transmission cables. 
With these features, we may examine the robustness of 
the proposed method against the noises. 
2) Real-time fault diagnosis system: The real-time fault di-
agnosis system is designed for implementing the hybrid 
framework presented in the previous paper.  To analyze 
the fault signals in real-time fashion, the system is based 
on paralleled hardware architecture with simultaneous 
computation capabilities. The system accepts the analog 
signal inputs – including three-phase voltage and current 
signals generated from the aforementioned real-time 
power system simulator – using analog/digital converter 
(ADC). Along with a runtime training technique, the 
ASNNs make this system an evolvable hardware. Such a 
feature can progressively improve the fault location ac-
curacy of the system. A digital touch liquid crystal dis-
play (LCD) panel is dedicated to display the diagnosis 
results (i.e., fault occurrence, fault types, and fault loca-
tion) after the proposed framework completes the analy-
sis. 
The real-time power system simulator and the real-time fault 
diagnosis system are implemented using Altera’s Cyclone-II 
and Stratix-III FPGAs. The computations of both systems are 
based on fixed point number representation with the purpose 
of simplifying the implementations of the systems. The volt-
age and current signals of a Taipower transmission network 
are simulated in real-time to evaluate the performance of the 
proposed framework.  
The rest of this paper is organized as follows. Section II 
gives the preliminaries on the FPGA architecture. Section III 
explains the skeletal hardware structure of the FPGA-based 
real-time fault diagnosis system. Section IV describes the im-
plementation and operation details of the real-time power sys-
tem simulator by integrating software-based 
MATLAB/Simulink with an external evolvable FPGA. Sec-
tion V provides simulation results of the two systems. The 
real-time simulated signals are captured by an oscilloscope to 
compare with the simulation results produced by 
MATLAB/Simulink. The fault-diagnosis system is also evalu-
ated using the signals obtained by the aforementioned simula-
tor. Conclusions and possible future works are given in Sec-
tion VI.  
II.  FPGA PRELIMINARIES 
FPGA is an integrated circuit and a development platform 
for prototype design. The logical function can be constructed 
using three types of components in FPGA: configurable logic  
CLB CLB
CLB CLB
LE LE
LE LE
IOBIOBIOBIOBIOBIOB
IOB
IOB
IOB
IOB
IOB
IOB
IOB
IOB
Programmable
six‐way switch Slice
…
… CLB
4‐input
Lookup
Table
DFF
M
U
X
LEClock
Inputs
Output
 
Fig. 1. Overall architecture of FPGA. The programmable interconnections are 
implemented by programmable six-way switch. CLB contains several slices, 
and each slice contains four or more LE, including a 4-input lookup table 
(LUT), a D-type flip-flop (DFF), and a multiplexer. 
 
blocks (CLBs), configurable input/output blocks (IOBs), and 
programmable interconnections [2]. The detailed architecture 
of FPGA and a logic element are depicted in Fig. 1. These 
components can be programmed to execute any logical func-
tion according to the prototype design.  
The primary purpose of FPGA is sprouted by integrating 
programmable read-only memory (PROM) and programmable 
logic devices (PLDs). Logic blocks and memories in FPGA 
can be configured to perform parallel and complex functions, 
so FPGA is perfectly suitable for applications that require 
massively parallel and distributed processors. These special 
features allow higher speedups than the equivalent software 
implementations do using computer or standalone digital sig-
nal processor (DSP). In recently years, FPGA has been pro-
vided with DSP blocks dedicated to perform mathematical 
functions, e.g. multiply, accumulate, add and subtract opera-
tions. The prototype development process using FPGA begins 
with coding the application using a hardware description lan-
guage (HDL), e.g. Verilog-HDL or VHDL. After the coding 
process is completed, the logics in the code will be synthe-
sized into circuits at logic gate level, and then these logic 
gates and their interconnections are placed and routed using 
compilation tools. Finally, FPGA can be programmed using a 
binary configuration file to carry out all customized functions 
in the application. 
In this study, FPGAs are used to implement complex ma-
附件三 4
memory module (DIMM) interface. According to ADCs’ 
specification, the sampling rate of the ADCs is set to 10 mil-
lion samples per second in order to maintain the dynamic of 
the ADCs. Since the proposed framework requires only 64 
samples per cycle, the memory address controller obtains the 
magnitudes of Vabc = (Va, Vb, Vc) and Iabc = (Ia, Ib, Ic) with a 
sampling rate of 3840 samples per second. Following the 
completion of these measurement processes, three-phase volt-
ages and currents are stored in DRAM. These waveforms are 
then analyzed by the fault diagnosis module presented in the 
following subsection. 
B.  Fault Diagnosis Module 
    1)  Floating Point Unit (FPU) 
With the increases in the capacity and the performance of 
FPGAs, engineers are allowed to implement more complex 
designs using FPGAs. However, FPGAs are good only at bit 
operations and fixed point arithmetic. Due to the lack of pipe-
line architecture used in the design of computers, it is still a 
hard time for FPGAs to cope with floating point arithmetic. In 
order to implement high performance floating point computa-
tions and parallel computing of neural networks on FPGAs, it 
is necessary to design a small circuitry and a high speed FPU 
module. 
Major arithmetic used in the proposed framework consists 
of a massive number of parallel operators, i.e., addition, sub-
traction, multiplication, and division. In order to speed up the 
computation, most of the operators in the proposed framework 
are physically implemented using FPUs. On the other hand, 
not all arithmetic operations require full functional FPUs. 
With the purpose of reducing unnecessary circuitry, two types 
of FPUs are designed to handle addition/subtraction and mul-
tiplication/division operations, respectively.  
The schematics of both types of FPUs are depicted in Figs. 
5 and 6. Apparently, the floating point adder/subtractor is 
more complicated than the floating point multiplier/divider. 
For the floating point adder/subtractor, as depicted in Fig. 5, 
the first step is to compare the operands, and the smaller one 
between two operands is aligned so that the exponent compo-
nents of both operands are identical. The additions or subtrac-
tions of two floating numbers are then performed by adding or 
subtracting the mantissa components of both operands. Finally, 
the normalization step is to ensure the first bit of the mantissa 
component of the resulting value is one. If such a requirement 
is not satisfied, the correction of the exponent component is 
required.  
Modern FPGAs provide high speed multipliers and divid-
ers along with a number of DSP blocks, so binary multiplica-
tion and division operations can be implemented with less 
effort. Given the benefit offered by Stratix-III FPGAs, the 
floating point multiplier/divider can be constructed using a 
simpler architecture as illustrated in Fig. 6. If the FPU is in-
structed to perform multiplication operation, the exponent 
components of the operands are summed together. The multi-
plication of the mantissa components is carried out by a 12 × 
12 high speed multiplier block. If the FPU is instructed to 
perform division operation, on the other hand, the exponent  
ALU (+,–)
s exp mantissa s exp mantissa
Cmpz
ALU (–)
Shifter
MUX
1 bit 5 bit 10 bit
5‐bit
2’s compliment
subtractor
MUX
10‐bit
ALU
MUX
ALU (+)
Abs
5‐bit
2’s compliment
adder
ShifterALU (+,–)
Check for normalization
s exp mantissa
5‐bit
2’s compliment
ALU
 
Fig. 5. Schematic of the 16-bit half-precision floating point adder/subtractor, 
where ‘ALU’ represents the arithmetic logic unit, ‘MUX’ means the multi-
plexer, ‘Abs’ denotes to the absolute value, and ‘Cmpz’ expresses the compar-
ison with zero. 
 
s exp mantissa s exp mantissa
1 bit 5 bit 10 bit
ALU (+,–) 5‐bit
2’s compliment
ALU
12x12‐bit high speed 
multiplier/
Megafunction multiplier or 
divider
ALU (*,/)
Shifter
ALU (+,–)
Check for normalization
s exp mantissa
5‐bit
2’s compliment
ALU
XOR
 
Fig. 6. Schematic of the 16-bit half-precision floating point multiplier/divider 
that integrates a high speed 12 × 12 multiplier or a megafunction multipli-
er/divider provided by the DSP blocks in Stratrix-III FPGAs. 
 
component of the dividend is subtracted by the exponent 
component of the divisor. The division of the mantissa com-
ponents of both operands is performed by a divider megafunc-
tion given by Altera. Subsequently, the FPU normalizes the 
result, and the final sign-bit is determined by implementing an 
‘exclusive OR’ (XOR) for the sign-bits of both operands. 
The use of adaptive lookup tables (ALUTs), registers, DSP 
blocks, and maximum frequency of operation for both types of 
FPUs are summarized in Table I. Both DSP block-enabled and 
DSP block-disabled designs are reported. Obviously, the 
number of ALUTs used in the non-DSP block implemented 
FPUs is larger and slower in the circuitry size and the operat-
ing frequency than that in DSP block-enabled ones, respec-
tively. Since the DSP block is a high speed but limited  
附件三 6
M
U
X G filter
DE
M
U
X
Vabc
Iabc
Vabc(t)
Iabc(t)
d1DWT
abcV d2
DWT
abcV d2
DWT
abcId1
DWT
abcI
d2DWT ( )abcI i
d1DWT ( )abcI i
d2DWT ( )abcV i
d1DWT ( )abcV i
16 bit x 4
16 bit 
Shift
Timing 
control
 
Fig. 8. Architecture of the serial-in parallel-out ML-DWT. 
 
A multiplexer is utilized to control the sequence of taking in-
put coefficients from the SIPO shift registers (Vabc, Iabc, 
d1DWT
abcV , and d1
DWT
abcI ). The output of the wavelet high-pass fil-
ter is passed through a demultiplexer to the appropriate output 
channel for the corresponding SIPO shift register, and the 
wavelet coefficients in the SIPO shift register is shifted. The 
control signals of the multiplexer and the demultiplexer are 
generated by counters with discrete logic circuits to control 
the sequence of operations. Since the sampling rates of Vabc 
and Iabc are relatively lower than the operating frequency of 
the FPGA, the proposed system can perform ML-DWT in 
real-time. The FPUs are used in the filter block only; there are 
four ‘mult/div’ FPUs and three ‘add/sub’ FPUs used in this 
block. The filter has fixed coefficients; consequently, these 
coefficients can be easily implemented using fixed wires. 
    4)  Principal Component Analysis 
In the proposed framework, PCA is used to reduce the di-
mensionality of the wavelet coefficients produced by ML-
DWT. For the hardware designs of PCA, the most computa-
tionally intensive part of PCA is to perform eigenvector calcu-
lations and sorting. In fact, the calculation of eigenvectors is 
sequential and hard to be parallelized. To implement PCA in 
the FPGA, a multistage pipeline structure is presented as de-
picted in Fig. 9. 
First, the wavelet coefficients { d1DWTabcV , d2
DWT
abcV , d1
DWT
abcI , and 
d2DWT
abcI } produced in the most recent cycle are used in the 
PCA. In order to compute eigenvalues and eigenvectors, the 
size of these wavelet coefficients are equalized to 64 samples 
using a simple linear interpolation technique. The wavelet 
coefficients are then organized into three matrices according 
to their phases, Ca, Cb, and Cc. The mean centered coefficient 
matrices,  aC ,  bC , and  cC , are fed to the computation module 
of PCA in a sequence controlled by a multiplexer. The module 
is designated to solve eigenvalues and eigenvectors by linear 
algebra. The most significant eigenvalue and its corresponding 
eigenvector is used to project the wavelet coefficients onto the 
vectors in a new feature space, i.e., 

av , 

bv , and 

cv . A demul-
tiplexer is responsible for storing the results into the  
 
d1DWT
abcV
d2DWT
abcV
d1DWT
abcI
d2DWT
abcI
aC
bC
cC

aC

bC

cC
Organizing Centering
M
U
X
 2 24a c b   
Solve the system det(A‐λI)
Determine eigenvectors e
Sort e and λ
DEMUX
bv

av

cv

Pipeline control
 
Fig. 9. Hardware architecture of implementing PCA. 
 
TABLE II 
PIPELINE STAGES BREAKDOWN IN THE PROCESS OF PCA 
Operation Number of pipeline stages 
Organizing Ca, Cb, and Cc 1 
Calculate mean values  
DWT_y
xV  and  
DWT_y
xI  
7 
Compute  aC ,  bC , and  cC  1 
Compute eigenvectors dk 
and eigenvalues μk 648 
Sort eigenvalues μk 
in decreasing order 384 
Project wavelet coefficients 
onto the new space Ωx 3 
 
corresponding registers for further analysis. 
The computation of PCA is implemented via a series of 
complex and iterative processes. Although there are many 
levels of parallelism used to exploit the process of PCA, but a 
multi-stage pipeline structures is still required to reduce the 
size of the circuit. The parallelism used in PCA can be found 
at many steps in Fig. 9. For example, the calculation of the 
mean value of a vector of size 1 × p, e.g. 
DWT_y
xV  and  
DWT_y
xI  
can be accomplished with an adder tree that scales with the 
depth of the adder tree log2(p) + 1. Subtracting the mean value 
of a vector from itself in the centering process is done in par-
allel. Furthermore, if the vector has a size of 4 × p, e.g. Cx, 
then 4p subtracting operations are performed in parallel to 
generate  xC . In this study, the value of p is 64, the sampling 
rate per cycle. The number of the pipeline stages for each op-
eration in PCA is summarized in Table II. 
From a hardware perspective, the implementation of PCA 
requires a large number of pipeline stages to reduce the laten-
cy of the analysis. Additionally, the PCA module used 48,982 
logic elements in the Stratix-III FPGA. The maximum opera-
tional frequency is 76 MHz, which benefits from the large 
number of pipeline stages.  
    5)  Support Vector Machine 
The SVM [11] used in this study includes two stages: ma-
chine learning stage and feed forward classification stage. In 
the machine learning stage, support vectors are determined 
with a nonzero value αx and a bias term bi using the method 
described in our previous paper, where x and i represents the 
phase indicator and the index of the support vector,  
附件三 8
 
TriMatrix Blocks
…
Parameters
ASNN
a
b
c
Tn
Controller
Fault
Location
Parameters
Compute adjustment values U
pd
at
es
Prior
knowledge
 
Fig. 11. Overall flowchart of the scheduling-based computing mechanism for 
ASNNs. Only one ASNN hardware circuit is implemented in the FPGA. 
 
Fig. 12. GUI interface of the proposed system on a touch LCD panel. The 
LCD panel is mounted on an Altera development board (DE2-70) that is re-
sponsible for displaying the output screen on the LCD panel. The GUI inter-
face is also used to detect the touch signals from the LCD panel and transmit 
the signals to the Stratix-III FPGA board for further use.  
 
transmission lines are summarized in Table III. The total 
length of the power transmission lines is 939.61 km, and the 
measurement units are deployed to all buses in the power sys-
tem. 
The schematic of the real-time power system simulator is 
depicted in Fig. 14. The three-phase power waveforms are 
digitally simulated by MATLAB/Simulink. The power wave-
forms are then sent to the memory module of the real-time 
power system simulator via the universal serial bus connector 
and the JTAG port on the development board (DK-DSP-
3SL150N). The samples of the digital waveforms are consecu-
tively transmitted to the 14-bit DAC via the HSMC interface 
to simulate analog power waveforms. The analog signals are 
sampled using a 14-bit ADC, and the sampled power wave-
form is stored in the memory module. In this way, noises in-
troduced by the analog-to-digital measurement and the quanti-
zation process are taken into account while evaluating the 
performance of the fault diagnosis system presented in the 
previous section. 
10.7 km
NG
NG
14.5 km
Siehe
Shenme
Sijhih23.5 km
13.8 km
29.9 km
24 km
41.9 km
Nuclear 2
Nuclear 1
Dinghu
Longtan
39.5 km
29
.5
 km
23.8 km
Panchiao
Emei 123.2 km
87.9 km
10
0.
8 k
m
Jhongliao
Mingtan
Daguan
11.6 km
Tianlun
Nantou
13.8 km
38.4 km
Chungkang
46.7 km
11.2 km
32.9 km
FG
Chunghuo
13 km
Longci
13
0.
4 k
m
WG
WG
WG
NG
FG
WG
Nuclear Power Plant
Fossil Fuelled Power Plant
Hydro Power Plant
Bus
To local substation
34
.1
 km
18.6 km
13 km
 
Fig. 13. Topology of a real 345 kV Taipower power transmission network 
system encountered in Taiwan. 
 
V.  EXPERIMENTAL RESULTS 
The setup of the proposed systems is shown in Fig. 15. The 
overall hardware resources used in the Stratix-III FPGA are 
92.7% (105,403/113,600) ALUTs, 4576 registers, 48 memory 
blocks, and 618 pins. The operation frequency of the Stratix-
III FPGA is 72.46 MHz, benefited by the pipeline designs of 
the internal components. The entire analysis process of the 
proposed system completes in 0.0001 second after the ADC 
measures a new sample from the external cables. For each 
transmission line in the simulated power system, different 
faults are randomly given to produce training and test samples 
to evaluate the performance of the proposed diagnosis system. 
Each sample is generated for different type of fault at random 
fault location (from 0 to 1 p.u.) and random fault inception 
angles (0° to 359°). There are 240,000 power waveforms gen-
erated (10,000 samples per type of fault and 120,000 samples 
for a normal condition) via MATLAB/Simulink. We train the 
parameters of SVMs and ASNNs on computer using half of 
the samples measured by the 14-bit ADC in order to take 
measurement errors into account. Each training dataset con-
sists of 5,000 fault waveforms and 5,000 normal waveforms. 
After the training process completes, all parameters are trans-
mitted to the memory module of the FPGA board. For a vali-
dation purpose, half of the samples are used to test the per-
formance of the proposed diagnosis system. 
附件三 10
 
 
Fig. 15. (a) Setup of the proposed system by integrating a Stratix-III FPGA 
evaluation board (DK-DSP-3SL150N) and a Cyclone-II FPGA development 
board (DE2-70) that is responsible for displaying diagnosis results. (b) Setup 
of the Stratix-III FPGA board. 
 
(a)
(b)
0.99 1 1.01 1.02 1.03 1.04 1.05
-1
0
1
Sampling time (sec)
V
ol
ta
ge
 (p
.u
.)
0.99 1 1.01 1.02 1.03 1.04 1.05
-500
0
500
Sampling time (sec)
C
ur
re
nt
 (p
.u
.)
0.99 1 1.01 1.02 1.03 1.04 1.05
-1
-0.5
0
0.5
1
Sampling time (sec)
V
ol
ta
ge
 (p
.u
.)
0.99 1 1.01 1.02 1.03 1.04 1.05
-500
0
500
Sampling time (sec)
C
ur
re
nt
 (p
.u
.)
Simulator outputs
Measured waveforms
Simulator outputs
Measured waveforms
Simulator outputs
Measured waveforms
Simulator outputs
Measured waveforms
 
Fig. 16. Sample fault waveforms simulated by the proposed real-time power 
system simulator (the blue solid lines) and the waveforms measured by the 
proposed diagnosis system (the red dotted lines). (a) Fault voltages and cur-
rents of a three-phase to ground fault and (b) a phase-A to ground fault. 
 
is given in the transmission line between Longtan and 
Jhongliao stations at simulation time t, and t = 1 sec. In Fig. 
16(b), a phase-A to ground fault is given in the same line at 
the same simulation time. To measure the similarity between 
the simulated and the measured waveforms, an index, named 
SSE/Var, is defined as below 
   
2
/ ,
  o m o
o
S S
SSE Var Var S
S
    (8) 
where So and Sm are the waveforms simulated and measured 
by the proposed systems, ||So|| is the size of the waveform, and 
Var(So) is the variance of the waveform. The mean values of 
SSE/Var in voltage and current signals are 0.000841 and 
0.000165, respectively. With small values of SSE/Var in both 
voltage and current signals, we can guarantee that the pro-
posed diagnosis system is able to retrieve correct waveforms 
outputted by the proposed power system simulator. 
The proposed diagnosis system is initialized with 6 ASNNs 
that contains 50 neurons each (300 neurons in total). After the 
proposed diagnosis system is properly trained by the training 
dataset, we validate the proposed system by applying it to the 
test dataset. The experimental results over all transmission 
lines are summarized in Table IV. The results show that the 
performance of the proposed diagnosis system is comparable 
with the computational results presented in Part I of the two 
paper series [1]. The proposed system is able to detect, classi-
fy, and locate faults under various types of fault conditions. 
The averaged detection accuracy of the proposed system is 
99.9%. The averaged sensitivity and specificity of the pro-
posed diagnosis system are 99.75% and 99.86%, respectively. 
The averaged location error is close to 0.6%. Furthermore, 
10,000 power waveforms are generated after giving random 
types of faults to each transmission line in the power system; 
of 50% among all samples are fault waveforms, and the rest 
are waveforms in the normal condition. Furthermore, addi-
tional training dataset with 5,000 fault waveforms and 5,000 
normal waveforms is generated for retraining of the proposed 
diagnosis system via the runtime training technique in ASNN. 
The averaged location errors are further reduced to 0.43%. 
The performances of the proposed diagnosis system in all 
transmission lines in the power system are summarized in Ta-
ble V. The proposed system performs well in fault detection; 
the averaged detection accuracy is 99.9%. Regarding the fault 
classification, the averaged sensitivity and specificity of the 
proposed system over the entire power system are 99.78% and 
99.87%, respectively. The averaged fault location error is 
around 0.47%. The response time of detecting a fault is 
around 0.0005 seconds, and the proposed system requires one-
cycle time period to identify and locate the fault. The hard-
ware implementation of the proposed fault diagnosis system 
thus provides a promising performance in fault detection, 
classification, and location. 
VI.  CONCLUSIONS 
This paper is the second part of the two paper series. The 
major contribution of this paper is to present a hardware im-
plementation of the methodologies proposed in the first part of 
the series. A fault diagnosis system and a real-time power 
system simulator are designed and implemented using a tratix-
III FPGA evaluation board. A Cyclone-II development board 
is also incorporated to provide a GUI on a touch LCD panel 
that shows the diagnosis results yielded by the presented. 
附件三 12
 
system. The proposed system consists of several algorithms, 
i.e., symmetrical component analysis, multi-level wavelet 
transforms, principal component analysis, support vector ma-
chine, and adaptive structure neural networks. The overall 
hardware resources used in the Stratix-III FPGA are 92.7% 
(105,403/113,600) ALUTs, 4576 registers, 48 memory blocks, 
and 618 pins. 
The performance of the proposed system is evaluated using 
the waveforms simulated based on a real 345 kV Taipower 
power system. The proposed system is able to directly meas-
ure external analog signals to perform fault diagnosis. The 
response time of detecting a fault is around 0.0005 seconds, 
and the proposed system requires one-cycle time period to 
identify and locate the fault. The detection accuracy, sensitivi-
ty, specificity and location error of the diagnosis system are 
99.9%, 99.7%, 99.8%, and 0.5%, respectively. 
The major contribution of this work is that a general solu-
tion to simultaneously detect, classify, and locate faults in 
transmission lines is presented. The evaluation results present-
ed in Part I of the series show that the proposed system is suit-
able to both simple and complex power systems. In Part II, we 
have shown that the proposed system and its runtime training 
technique also work well in real-world scenarios using the 
simulated power waveforms based on a real 345 kV Taipower 
power system. 
VII.  ACKNOWLEDGMENT 
The authors gratefully acknowledge the National Science 
Council of Taiwan for financially supporting this research 
under contract number NSC 96-2628-E-002-252-MY3. 
 
VIII.  REFERENCES 
[1] J.A. Jiang, C.L. Chuang, Y.C. Wang, C.H. Hung, J.Y. Wang, and Y.T. 
Hsiao, “A hybrid framework for fault detection, classification and loca-
tion – Part I: concept, structure and methodology,” submitted to IEEE 
Trans. Power Delivery, 2010. 
[2] J. Rose, “Architecture of field-programmable gate arrays,” Proc. IEEE, 
vol. 81, no. 7, pp. 1013–1029, Jul. 1993. 
[3] 14-bit, Dual A/D Converter AD9248 Datasheet. Analog Devices. 
Available: http://www.analog.com/static/imported-
files/data_sheets/AD9248.pdf. 
[4] Stratix® III Device Family FPGA Datasheet. Altera Corporation. 
Available: http://www.altera.com/literature/hb/stx3/stx3_siii52001.pdf. 
[5] Stratix® III DSP Development Kit Datasheet. Altera Corporation. 
Available: http://www.altera.com/products/devkits/altera/kit-st3-
dsp.html. 
[6] HSMC Specification. Altera Corporation. Available: 
http://www.altera.com/literature/ds/hsmc_spec.pdf. 
[7] IEEE Standard for Floating-Point Arithmetic, IEEE Std. 754-1008. 
[8] J.L. Blackburn, Symmetrical Components for Power Systems Engineer-
ing, Marcel Dekker, New York, 1993. 
[9] Brémaud, P., Mathematical principles of signal processing, Fourier and 
wavelet analysis, Springer Verlag, 2002, pp. 171–187. 
[10] S. Mallat, “A theory for multiresolution signal decomposition: the wave-
let representation,” IEEE Trans. Pattern Analysis and Machine Intelli-
gence, vol. 11, no. 7, pp. 674–693. 
[11] N. Cristianini and J. Shawe-Taylor, An Introduction to Support Vector 
Machines and Other Kernel-Based Learning Methods. Cambridge, U.K.: 
Cambridge Univ. Press, 2000, pp. 31–112. 
[12] Y.L. Lu, C.L. Chuang, C.S. Fahn and J.A. Jiang, "Multiple disturbance 
classifier for electric signals using adaptive structuring neural networks," 
Measurement Science and Technology, vol. 19, 075106, 2008. 
 
The 5th International Symposium on Machinery and Mechatronics for 
Agricultural and Biosystems Engineering (ISMAB2010) 
參與研討會心得報告 
 
1. 報告人中文姓名/所屬系所  
江昭皚 
生物產業機電工程研究所 
2. 會議期間及地點  
日本、九州、福岡 
自 2010 年 4 月 5 日 至 2010 年 4 月 7 日 
3. 會議(中/英文)名稱 
第五屆農業與生物系統工程機械與機電國際研討會 
The 5th International Symposium on Machinery and Mechatronics for 
Agricultural and Biosystems Engineering (ISMAB2010) 
4. 會議主辦單位  
日本農業機械協會與日本九州大學 
The Japanese Society of Agricultural Machinery and Centennial Hall Kyushu 
University School of Medicine 
5. 發表論文(中/英文)之題目   
The Application and Performance Improvement for Photovoltaic Arrays in Plant 
Factory via the Renewable Energy-assisted System 
6. 參加會議經過  
此行本人帶領實驗室團隊，與臺灣大學生機系參訪團前往參與由日本農業機
械協會與日本九州大學主辦的 ISMAB2010研討會，除了本人研究團隊的論文外，
本人的報告被安排在研討會的第二天早上(四月六號早上)，屬於綜合分類項目。
本人是搭乘四月四號抵達福岡的飛機，四月五號到研討會會場報到後，從大會所
提供的所有發表論文摘要報告中挑選出有興趣的主題前去聆聽，包括生物產業機
械、機電整合、精準農業及系統工程等相關議題，希望透過聆聽他人的研究，其
後進行師生間的討論過程中，可以獲取更多相關的知識藉以激起未來可能延伸的
研究方向。 
此次出國參與研討會，本人被分配在第二天早上進行簡報，總共進行十二分 
新知識的汲取更能激發出一些想法，以及未來可能拓展應用的發展面向。 
此次承蒙國科會提供的出席國際會議經費補助，得以出國參與國際會議，一
方面可以出國參訪外國先進的研究經驗，也獲得了與其他研究人員交流討論的機
會更獲得了許多相關寶貴的建議。 
8. 建議 
希望此會議未來可以更進一步擴大規模，可以找尋更多國家的研究人員加入
此研討會，讓研討會可發揮更大的交流效益。也希望國內可以多爭取辦理這類型
的研討會，這樣可以讓國內增進相關技術發展與專業素養，讓以農立國的臺灣可
以在生物產業技術發展持續的占有一席之地。 
9. 攜回資料名稱及內容     
此次攜回一套研討會完整的 Proceeding 光碟、研討會贈送之紀念環保購物袋、
研討會贈送之多功能原子筆與九州當地的旅遊介紹。 
 
 
Proceedings of the 5
th
 International Symposium on Machinery and Mechatronics for 
Agriculture and Biosystems Engineering 
(ISMAB) 
5-7 April 2010, Fukuoka, Japan 
 
 
THE APPLICATION AND PERFORMANCE IMPROVEMENT FOR 
PHOTOVOLTAIC ARRAYS IN PLANT FACTORY VIA THE 
RENEWABLE ENERGY-ASSISTED SYSTEM 
 
Jyh-Cherng Shieh, Yu-Li Su, Jen-Cheng Wang, and Joe-Air Jiang* 
 
Department of Bio-Industrial Mechatronics Engineering, National Taiwan University  
No. 1, Sec.4, Roosevelt Road, Taipei 10617, Taiwan 
*Corresponding Author, Tel +886-2-3366-5341, Email: jajiang@ntu.edu.tw 
 
Abstract: In recent years, a critical issue has been emerged: how to reduce negative effects 
brought by global warming and climate change. In most cases the use of renewable energy such 
as photovoltaic (PV) array is able to considerably reduce certain carbon dioxide emissions. This 
merit makes PV array a reliable energy source and an efficient mitigation lever against global 
warming. In agriculture, PV arrays have also played a promising role. In plant factory, plants 
are cultivated under a completely artificial climate. For saving energy, PV arrays are usually 
adopted as the auxiliary power supply of plant factory. Many studies of plant factory have 
focused on optimizing the usage of both PV arrays and conventional energy sources. In order to 
achieve maximum utilization efficiency, the maximum power point tracking (MPPT) control 
technique is essential in plant factories powered by the PV arrays. In this work, we have 
developed the simplified control model to directly estimate the maximum power point and keep 
power tracking by using p-n junction semiconductor theory. The irradiation intensity dependent 
maximum power point for the PV arrays is discussed in detail as well. 
 
Key Words: Photovoltaic (PV) array, plant factory, p-n junction semiconductor, maximum 
power point tracking (MPPT). 
 
INTRODUCTION 
 
Many countries have initiated energy policies and programs to deal with energy diversification, 
security of supply, economic efficiency, and environmental protection. For example, some 
governments have introduced policies to achieve the goal of energy saving and carbon 
reduction using different approaches including encouraging low-energy building designs, 
installing renewable energy sources, promoting power management, etc. PV arrays directly 
convert light energy into electric power through semiconductors. PV arrays generate electricity 
from sunlight instead of using fossil fuels, so they emit no gases and require no turbines and 
cooling water during operation. In addition, they are highly reliable and easy to use.  
 
PV energy has attracted intensive research effort in recent years, due to its unique properties 
and versatile applications. However, the energy-conversion efficiency of the PV arrays is still 
( ) ( )
1  exp 1 exp
pv pv
pv pv
pv pv
pvpv pv s pv pv ssat
sg sat pv
pv
dP dI
I V
dV dV
dIq V I R q V I RqI
RI I V
dVnkT nkT nkT
    
       
         
      
      (7) 
When PV array achieves the maximum utilization efficiency and maximum power, the power 
slope 0  , and Eq. (7) is further simplified to  
( )
1exp
pv pm
pm pm s pvpm pm s
V Vg sat sat
pv
qV qV R dIq V I R
I I I
nkT nkT dVnkT

  
     
  
      (8) 
or     
( )
1exp
pv pm
pm pm s pvg sat pm pm s
V V
pvsat
qV qV R dII I q V I R
nkT nkT dVI nkT

   
    
  
           (9) 
On the other hand, when the output current I is zero, the open-circuit voltage Voc is calculated as  
exp
g sat oc
sat
I I qV
I nkT
  
  
 
      (10) 
or         ln
g sat
oc
sat
I InkT
V
q I
 
  
 
      (11) 
From Eqs. (9) and (10), we can get the characteristic equation for the maximum power point of 
PV arrays and it can be expressed by 
1 exp ( )
pv pm
pm pm s pv
V V oc pm pm s
pv
qV qV R dI q
V V I R
nkT nkT dV nkT

 
       
      (12) 
For the parallel-connected PV power conditioning system with line connection, the effective 
line power can be written as  
coss S S S TP V I V I          (13) 
where VS  is the root-mean-square (rms) value of the line voltage (V), IS is the root-mean-square 
(rms) value of the line current (A), θ  is the angle of the line current (radius), and IT is the value 
of the line current (A). On the other hand, the dc power Ppv generated from the PV array is 
calculated as 
pv pv pvP I V        (14) 
From the law of power conservation, the generated dc power Ppv, considering the power 
efficiency, should be equal to the effective line power such that 
pv sP P        (15) 
where η is the power efficiency of the PV arrays. From Eqs. (13)–(15), the dc current Ipv of the 
PV array can be estimated as 
S T
pv
pv
V I
I
V
       (16) 
Thus, the estimated current Ipv of the PV array can be obtained without directly using a dc 
current sensor. Combining Eq. (12) with Eq. (16) gives 
RESULTS AND DISCUSSION 
 
Fig. 2 shows the I-V-P (current-voltage-power) curve of the PV arrays with different irradiation 
intensity at 25 

C. The labeled symbols shown in Fig. 2 indicate the maximum power point of 
the PV arrays with different irradiation intensity. It has found that this increase of the output 
power is primarily due to the increase of open-circuit voltage Voc, while the photocurrent is 
increased linearly with the irradiation intensity. On the other hand, the short-circuit current Isc 
increases linearly with minority carrier concentration with increasing different irradiation 
intensity. The optimal current is proportional to the maximum power when the temperature of 
the solar panels is kept constant. Fig. 3 shows the experimental P-I characteristics and the 
maximum power of the PV arrays calculated by using values from Fig. 1 and Eq. (18), where 
the temperature is kept at 25 C. The labeled symbols in Fig. 3 indicate the maximum power 
point of the PV arrays with different irradiation intensity. We have directly estimated the 
maximum power point of the PV arrays and the value of m which defined the ratio of Voc to Vpm. 
Further, by substituting the values of Vpm and Voc into Eq. (20), we also have directly estimated 
the ratio of Ipm to Isc. 
 
The values of characteristic parameters Vpm/Voc and Ipm/Isc were shown in Fig. 4 (a) and (b). The 
dash lines in Fig. 4 (a) and (b) are the liner least square fitting for the PV arrays with different  
 
 
Figure 2 The output characteristic of the PV 
arrays with different irradiation intensity at 25 C. 
 
Figure 3 The experimental P-I curve and the 
maximum power of the PV arrays with different 
irradiation intensity at 25 C. 
 
 
 (a)  (b)
Figure 4 Measured parameters (a) Vpm/Voc characteristic and (b) Ipm/Isc characteristic needed for the 
calculation of P-I characteristics with different irradiation intensity at 25 C. 
The 5th International Symposium on Machinery and Mechatronics for 
Agricultural and Biosystems Engineering (ISMAB2010) 
參與研討會心得報告 
 
1. 報告人中文姓名/所屬系所  
江昭皚 
生物產業機電工程研究所 
2. 會議期間及地點  
日本、九州、福岡 
自 2010年 4月 5 日 至 2010年 4月 7 日 
3. 會議(中/英文)名稱 
第五屆農業與生物系統工程機械與機電國際研討會 
The 5th International Symposium on Machinery and Mechatronics for 
Agricultural and Biosystems Engineering (ISMAB2010) 
4. 會議主辦單位  
日本農業機械協會與日本九州大學 
The Japanese Society of Agricultural Machinery and Centennial Hall Kyushu 
University School of Medicine 
5. 發表論文(中/英文)之題目   
The Application and Performance Improvement for Photovoltaic Arrays in Plant 
Factory via the Renewable Energy-assisted System 
6. 參加會議經過  
此行本人帶領實驗室團隊，與臺灣大學生機系參訪團前往參與由日本農業機
械協會與日本九州大學主辦的 ISMAB2010研討會，除了本人研究團隊的論文外，
本人的報告被安排在研討會的第二天早上(四月六號早上)，屬於綜合分類項目。
本人是搭乘四月四號抵達福岡的飛機，四月五號到研討會會場報到後，從大會所
提供的所有發表論文摘要報告中挑選出有興趣的主題前去聆聽，包括生物產業機
械、機電整合、精準農業及系統工程等相關議題，希望透過聆聽他人的研究，其
後進行師生間的討論過程中，可以獲取更多相關的知識藉以激起未來可能延伸的
研究方向。 
此次出國參與研討會，本人被分配在第二天早上進行簡報，總共進行十二分 
新知識的汲取更能激發出一些想法，以及未來可能拓展應用的發展面向。 
此次承蒙國科會提供的出席國際會議經費補助，得以出國參與國際會議，一
方面可以出國參訪外國先進的研究經驗，也獲得了與其他研究人員交流討論的機
會更獲得了許多相關寶貴的建議。 
8. 建議 
希望此會議未來可以更進一步擴大規模，可以找尋更多國家的研究人員加入
此研討會，讓研討會可發揮更大的交流效益。也希望國內可以多爭取辦理這類型
的研討會，這樣可以讓國內增進相關技術發展與專業素養，讓以農立國的臺灣可
以在生物產業技術發展持續的占有一席之地。 
9. 攜回資料名稱及內容     
此次攜回一套研討會完整的 Proceeding 光碟、研討會贈送之紀念環保購物袋、
研討會贈送之多功能原子筆與九州當地的旅遊介紹。 
96年度專題研究計畫研究成果彙整表 
計畫主持人：江昭皚 計畫編號：96-2628-E-002-252-MY3 
計畫名稱：高強健性輸電線保護電驛演算法設計及實作 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 3 3 100%  
博士生 2 2 100%  
博士後研究員 1 1 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 1 1 100% 
人次 
 
期刊論文 1 3 100%  
研究報告/技術報告 0 0 100%  
研討會論文 1 2 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
 
