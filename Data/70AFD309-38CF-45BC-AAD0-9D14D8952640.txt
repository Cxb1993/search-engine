 2
 
壹. 整合型總計畫前言 
  
    本整合型總計畫報告旨在探討永磁交流電動機的設計、製作、驅動、控制及應用。計畫中有系統
地針對永磁交流電動機的電動機設計、驅動、控制及應用加以深入探討，為了充分地整合永磁交流電
動機的設計及其驅動與應用技術，本總計畫中共涵蓋五個子計畫。 
    子計畫一主要研究微型永磁同步電動機的設計、研製及應用，計畫中將完成利用新光阻半導體厚
膜光阻製程與電鑄技術製作電動機元件，組裝具有感測元件的微型永磁同步電動機及其控制。並以雷
射測微儀量測微型永磁同步電動機的位移及震動特性。子計畫二為永磁同步電動機高性能控制器及轉
軸角度估測，計畫中將完成轉軸角/速度估測器的實現及相關的 sensorless 驅動系統，最後並實際應用
在洗衣機驅動系統。子計畫三主要探討永磁同步電動機的徑向力分析、控制及自軸承應用，主要達成
目標有：研製一套自軸承的永磁同步電動機的磁浮主軸系統。轉子的徑向利用永磁同步電動機自軸承
控制及一被動式磁力軸承平衡；轉子的軸向則利用主動式磁力軸承平衡。計畫中將探討相關的驅動器
設計，控制法則探討，偵測器研製，及系統整合。子計畫四探討永磁同步電動機驅動系統及其在電動
機車之應用，將完成 DSP 控制永磁同步電動機，並以電動機車為負載，實際測試電動機車在行駛、
煞車的行為，並達成煞車能量回收。子計畫五為高效率永磁交流電機之最佳化設計與實現，計畫中將
達成研製 3 相，1 馬力，效率高於 90%的內藏式永磁電動機，並建立相關的設計資料及設計經驗。  
    本計畫的執行，可有效整合國內永磁交流電動機設計，製作，驅動，控制，及應用的技術人力，
達到技術交流，資源共享的目的。所研發的成果，將有機會進一步技術移轉至工業界，有助於提升國
內電動機控制的研究水平。相關的成果說明如後: 
 
 
貳. 整合型各子計畫說明 
 
子計畫一 微型永磁同步電動機設計、研製及應用 
 
主持人：龐大成 國立高雄應用科技大學機械工程系 副教授 
計畫參與人員：黃銘彥、楊善淵、林耿弘、黃啟純  
1-1 摘要 
本子計畫一提出ㄧ創新微型永磁同步馬達之微機電加工方法，藉由馬達設計、分析、製作、組裝、
控制及測試來驗證其可行性。馬達外徑 3mm、長度 6mm，其轉子為燒結釹鐵硼的永久磁鐵，外徑為
2mm、長度 3mm、輸出軸直徑 0.6mm。使用高磁能積釹鐵硼永久磁鐵材料作為轉子，線圈採用可撓線
圈之軟性印刷電路板並設計集中繞組，藉可撓線圈高撓曲度特性固定於塞規上，呈現圓筒狀馬達線圈，
再將線圈與導磁定子外殼配合微電鑄技術整合加工製作，則可減少馬達零件數以提高馬達整體組裝精
度，進而達到簡單製作及降低成本之目的。搭配自製驅動器完成兩型馬達驅動測試，藉 JMAG 電磁分
析軟體以了解馬達輸出特性，將理論分析與實驗測試相互比較，以建立較為準確之分析模型。 
 
 4
 
圖 1-3 模型三磁通密度圖(左)扭矩圖(中)反電動勢圖(右) 
 
(2) 馬達設計 
本子計畫利用可撓線圈及其結合導磁外殼的製造方法，提出一微型永磁同步馬達簡化零件設計，
微型永磁同步馬達定子線圈採用三組集中繞組，轉子為兩極的高磁能積永久磁鐵材料釹鐵硼，馬達驅
動電路使用單相激磁與步進角度為 120 度驅動。馬達設計外徑為 3mm 及長度為 6mm，轉子外徑為
2mm、內徑 0.6mm 及長度 3mm。馬達規格設計如表 1-1 所示，馬達元件設計圖如圖 1-4 所示，幾何設
計圖如圖 1-5 所示。 
表 1-1 外徑 3mm 永磁同步馬達設計規格表 
馬達機械規格 
外徑 3mm 外徑 2mm 
內徑 2.4mm 內徑 0.6mm 
長度 6mm 長度 3mm 
定 
子 
氣隙 0.28mm 
轉 
子 
極數 2 極 
馬達電氣規格  
相數 3 相 線圈匝數 8 匝 
線圈線寬 0.06mm 線圈線距 0.06mm 
激磁方式 單相 激磁電流 0.3A  
 
圖 1-4 外徑 3mm 永磁同步馬達元件設計圖 
 6
 
圖 1-7 外徑 3mm 馬達軟性線圈印刷電路版 
 
(4) 馬達磁鐵設計 
 永久磁鐵採用高磁能積材料釹鐵硼製作，藉此提高馬達氣隙磁通密度，以配合軟性電路板線圈，
來達到馬達高效能之設計目的。外徑 7mm 馬達原先採用型號 N50 釹鐵硼永久磁鐵材料最大磁能積
(BH)max 為 374~406 kJ/m3 及剩磁 Br為 1.40~1.46 T，外徑 3mm 馬達考量操作溫度及第一型馬達發生磁
飽和現象，故採用比先前較低的型號 N38UH 釹鐵硼永久磁鐵材料最大磁能積(BH)max 為 286~318 kJ/m3
及剩磁 Br 為 1.22~1.29 T，其磁鐵型號 N50 與 N38UH 之 B-H 特性曲線如圖 1-8 及圖 1-9 所示，特性規
格表如表 1-2 所示。 
 
    
          圖 1-8 型號 N50 之 B-H 曲線             圖 1-9 型號 N38UH 之 B-H 曲線 
表 1-2 磁鐵特性規格表 
 剩磁 
Br (T) 
矯頑力 
bHc (kA/m) 
內禀矯頑力 
iHc (kA/m) 
最大磁能積 
(BH)max (kJ/m3) 
最高工作 
溫度 ℃ 
N38UH 1.22~1.29 907 1989 286~318 180 
N50 1.40~1.46 836 875 374~406 80 
 
性 能 型 號 
 8
 
圖 1-11 外徑 3mm 鎳外殼永磁同步馬達零件照片 
 
 
圖 1-12 外徑 3mm 鎳外殼永磁同步馬達組裝實體圖 
 
(7) 馬達測試及特性量測 
本子計畫進行外徑 3mm 銅與鎳外殼永磁同步馬達最高轉速及最大額定電流測試，馬達激磁方式採
用每相 120 度單相激磁。經過測試最大輸入電為 0.45A，確保馬達運轉中不燒毀考量下，最大額定電流
採用 0.3A，及測試出最大馬達激磁頻率為 300Hz 換算出最高轉速 6,000RPM。測試馬達線圈兩端電壓
訊號，並於線圈後上 1Ω量測電流訊號，馬達單相線圈激磁訊號、定子線圈電壓訊號、電流訊號如圖
1-13 所示。  
 10
           
 圖 1-16 馬達轉速 5,000 rpm 反電動勢電壓示波器量測（左）及頻譜分析儀量測（右） 
表 1-3 外徑 3mm 馬達扭矩實測值 
負重(g) 實測扭力(μN-m)  
電流(A) 
Test 1 Test 2 Test 1 Test 2 
平均扭力
(μN-m) 
0.10 0.18 0.16 0.52 0.48 0.50 
0.15 0.36 0.35 1.06 1.03 1.05 
0.20 0.59 0.55 1.73 1.62 1.68 
0.25 0.79 0.75 2.34 2.19 2.27 
非導磁外殼 
(銅殼) 
0.30 0.98 0.97 2.89 2.85 2.87 
0.10 0.29 0.26 0.85 0.75 0.8 
0.15 0.52 0.51 1.54 1.50 1.52 
0.20 0.73 0.73 2.16 2.15 2.15 
0.25 0.99 0.95 2.90 2.81 2.86 
導磁外殼 
(鎳殼) 
0.30 1.20 1.15 3.54 3.39 3.47 
 
表 1-4 外徑 3mm 馬達反電動勢電壓值 
峰值(mV)  
轉速(RPM)
Test 1 Test 2 Test 3 
峰值平均
(mV) 
1,000 2.6 2.4 2.4 2.47 
2,000 4.7 4.6 4.3 4.53 
3,000 7.1 6.6 6.4 6.70 
4,000 9.5 8.7 8.7 8.97 
非導磁外殼
(銅殼) 
5,000 11.9 10.4 11.2 11.17 
1,000 3.0 2.9 3.0 2.97 
2,000 5.1 4.9 4.9 4.97 
3,000 7.9 7.3 7.7 7.63 
4,000 10.0 9.7 10.3 10.00 
導磁外殼  
(鎳殼) 
5,000 12.3 11.5 12.0 11.93 
 12
1-5 子計畫成果自評 
本子計畫完成外徑 3mm 之永磁同步馬達設計、分析、製作、組裝、控制及測試。未來將針對進行
高深寬比線圈及可撓基材製程研發，尋找更佳的導磁材料以改善導磁外殼特性，並可進一步提升馬達
之扭矩與提高效率。本計畫開發的微型永磁同步馬達製作方法「可撓線圈及其結合導磁外殼的製造方
法」已申請中華民國發明專利，並發表國內研討會論文四篇、培訓四位碩士研究生及四位大學生熟悉
微小馬達設計製作人才。 
 
1-6 致謝 
本子計畫在高雄應用科技大學微機電精密機械技術研發中心的人力設備支援下得以順利完成，對
此深表感謝。 
 
1-7 參考文獻 
[1] B. Wanger, M. Kreutzer, and W. Benecke, “Permanent Magnet Micromotors on Silicon Substrates,” 
Journal of Microelectromechanical System, 1993, pp. 23-29. 
[2] H. Ota, T. Araki, H. Narumiya, T. Oda, M. Kobayashi, “Coil Winding Process for Radial Gap Type 
Electromagnetic Devices with Cylindrical Stator,” Proceedings of MEMS, 1996, pp. 325-330. 
[3] S. Biweris, L. Billet, P. Gandel, D. Prudham, “Low Cost – High Speed Small Size Disk Magnet 
Synchronous Motor,” Proceedings of Actuator 2002, Bremen, Germany, June 2002, pp. 196-200. 
[4] J. H. Kim, J. K. Chung, H. K. Sung, and S. H. Rhyu, “Development of an Integrated Type Slotless BLDC 
Motor with a 15-mm-Outer Diameter,” Korea Electronics Technology Institute (KETI), 2005, pp. 2329-2332. 
[5] I. S. Jung, J. H. Kim, J. H. Choi, H. G. Sung, “A Study on Design and Manufacturing of a Micro Brushless 
DC Motor,” IEEE Electrical Machines and Systems, 2005, pp. 2320-2323. 
[6] P.-A. Gilles, J. Delamare, O. Cugat, “Rotor for a Brushless Micromotor,” Journal of Magnetism and 
Magnetic Materials, Volume 242-245, Part 2, April, 2002, pp. 1186-1189. 
[7] J. H. Kim, I. S. Jung, and H. G. Sung, “Design and Manufacturing of Ultra Small actuator,” IEEE 
International Conference on Mechatronics, July 3-5, 2006, pp. 23-26. 
[8] M. C. Tsai, and L. Y. Hsu, “Winding Design and Fabrication of a Miniature Axial-Flux Motor by 
Micro-Electroforming,”IEEE Transactions on Magnetics, Vol. 43, 2007, pp. 3223-3228. 
[9] A. Waldschik, M. Feldmann, and S. Büttgenbach, “Novel Synchronous Linear and Rotatory Micro Motors 
based on Polymer Magnets with Organic and Inorganic Insulation Layers,” Journal of Sensors & Transducers, 
Special Issue on Microsystems: Technology and Applications, Vol. 3, 2008, pp. 3-13. 
[10] T. Speliotis, D. Niarchos, P. Meneroud, G. Magnac, F. Claeyssen, J. Pepin, C. Fermon, M. Pannetier, and 
N. Biziere, “Micro-motor with Screen-printed Rotor Magnets,” Journal of Magnetism and Magnetic Materials, 
 14
本總計畫辦理『永磁同步及無刷電動機設計、製造與應用產學論壇』，地點:國立高雄應用科技大
學，高雄市，時間: 2009 年 11 月 27 日。 
 
 
 
 
 
 16
外，為了避免轉子表面磁性材料在高速時產生飛脫，此種電動機只能應用於中、低速範圍。而內藏式
永磁同步電動機的永久磁鐵是埋入於轉子內部，構造堅固，可以承受高轉速所產生的離心力，應用於
高轉速的場合。此外，內藏式 d 軸電感不等於 q 軸電感，具有凸極效果，因此可產生磁阻轉矩，使得
輸出轉矩增加。目前工業界最常使用的控制方法是比例積分控制器。比例積分控制器是一個架構簡單
的控制器，容易實現。但是比例積分控制器，其控制器參數值均為固定，無法同時兼具良好的暫態響
應及干擾斥拒能力；對於時變命令之追蹤亦常產生相位落後，導致穩態誤差。為了改善此問題，近代
學者提出許多高性能控制器設計方法。這些控制方法，主要可分為線性控制器及非線性控制器設計。
在線性控制器方面主要有：強健控制器，最佳控制器[1]-[2]等。在非線性控制器方面則有：適應性控制
器，滑動模式控制器，及模糊控制器[3]-[10]等。 
在磁性元件及驅動技術持續發展下，使得永磁同步電動機的性能更佳，功率密度更高。伴隨數位
信號處理器的快速發展，工業界已能將複雜但性能較好的控制理論應用於工業產品上。本子計畫即針
對內藏式永磁同步電動機的控制及實際應用加以研究，並探討其應用於洗衣機的可行性。 
 
2-2 背景及目的 
近代工業的不斷進步，使得永磁同步電動機之控制技術與數位信號處理器的迅速發展，加上效率佳、
精密度高，永磁同步電動機驅動系統已被大量運用在需要精密及快速響應的驅動控制場合，高性能同步驅
動系統需具有對抗參數變化及負載干擾之能力。 
一般傳統永磁同步電動機的控制器有相當多種型式，工業應用上常見的為比例積分控制，此控制法則
簡單，由直覺及經驗就能代替繁複的數學演算，廣泛的被使用於工業應用中。但比例積分控制器僅有兩個
參數可調整，所以很難在寬廣的範圍內同時擁有良好的動態響應及加載特性。且實際應用上，外在環境經
常改變，原有的比例積分控制器無法滿足其需求。適應性輸入-輸出回授線性化控制可以根據環境的變化，
自我調適出適合的控制器參數，且目前的數位信號處理器執行速度，已能夠滿足相關控制器快速地自我調
適的時間。 
本子計畫主要探討無轉軸偵測元件內藏式永磁同步電動機應用於洗衣機驅動系統的研製，並提出一個
新型的三相延伸型磁通模型。此一延伸型模型不需要進行任何假設，經由適當的數學推導，即可求出電動
機的轉軸角度，進一步求出電動機的轉軸速度。與過去文獻比較[11]-[20]，本計畫並未使用線性的磁通估
測器來進來磁通估測，而係使用電動機的數學模型直接推導出電動機的延伸型磁通模型，進一步由該模型
直接計算轉軸的角度及速度，最後成功地結合於洗衣機上。本計畫最主要的貢獻是針對洗衣機，提出並研
製高性能的內藏式永磁同步電動機驅動系統，並以實驗佐證。 
最後，本計畫成功將所提具無轉軸偵測元件之內藏式永磁同步電動機驅動方法應用在洗衣機，並完成
洗衣機閉迴路系統的研製。為了實際驗證所提方法的可行性，本計畫將所提方法實際在洗衣機上進行測
試，且模仿市售洗衣機設計一洗衣流程軌跡，此軌跡之設計能有效的將衣物洗滌乾淨，藉此用以說明本計
畫所研製之洗衣機驅動系統能有效的將衣物洗滌乾淨；就筆者所知，此為首次將具無轉軸偵測元件內藏式
永磁同步電動機應用在洗衣機。過去的文獻並未討論此一應用，本計畫的研究成果可供相關人員的參考。 
 
2-3 轉軸角度估測方法探討 
永磁同步電動機的轉子採用永久磁鐵取代了激磁場繞組，主要係避免產生激磁銅損，提高功率密
度，降低轉子慣性以及增強轉子結構的堅固性。但缺點則是捨棄了激磁場磁通控制的自由度和所使用
的永久磁鐵可能會出現的去磁效應。目前，釹硼鐵(Nd-B-Fe)為普遍使用的磁性材料，具有甚高的能量
密度，高剩磁(remanence)和非常好的頑性(coercivity)，此種高性能的永久磁鐵被普遍地安裝在永磁同步
電動機的轉子上。由於轉子不需激磁場繞組，亦不需碳刷及滑環，因此永磁同步電動機相較於直流機
 18
( ) 3 1 3 2
2 2 2
1 2 1 22 2
2 3 2 3
as s a m re ls A B A B B re a
A B re b A B re c
d dv r i cos L ( L L ) L L L cos( ) i
dt dt
d dL L cos( ) i L L cos( ) i
dt dt
λ θ θ
θ π θ π
⎛ ⎞⎛ ⎞= + + + + − − −⎜ ⎟⎜ ⎟⎝ ⎠⎝ ⎠
⎛ ⎞ ⎛ ⎞⎛ ⎞ ⎛ ⎞+ − − − + − − +⎜ ⎟ ⎜ ⎟⎜ ⎟ ⎜ ⎟⎝ ⎠ ⎝ ⎠⎝ ⎠ ⎝ ⎠
 (2-2) 
接著，同理可得到 bsv 的定子電壓方程式如下： 
2 1 22
3 2 3
2 12 2
3 2
bs s b m re A B re a
ls A B re b A B re c
d dv r i cos( ) L L cos( ) i
dt dt
d dL L L cos( ) i L L cos( ) i
dt dt
λ θ π θ π
θ π θ
⎛ ⎞⎛ ⎞ ⎛ ⎞= + − + − − −⎜ ⎟ ⎜ ⎟⎜ ⎟⎝ ⎠ ⎝ ⎠⎝ ⎠
⎛ ⎞ ⎛ ⎞⎛ ⎞ ⎛ ⎞+ + − + + − −⎜ ⎟ ⎜ ⎟⎜ ⎟ ⎜ ⎟⎝ ⎠ ⎝ ⎠⎝ ⎠ ⎝ ⎠
 (2-3) 
假設三相電流為平衡，即 0a b ci i i+ + = 代入(2-3)式，並經由三角函數的展開，可將(2-3)式重新整理如下： 
2 1 2 2
3 2
3 1 3 2 2 3 2
2 2 2
1 22
2 3
bs s b m re A B re a
ls A B A B B re B re b
A B re c
d dv r i cos( ) L L cos( ) i
dt dt
d L ( L L ) L L L cos( ) L sin( ) i
dt
d L L cos( ) i
dt
λ θ π θ
θ θ
θ π
⎛ ⎞⎛ ⎞ ⎛ ⎞= + − + − +⎜ ⎟ ⎜ ⎟⎜ ⎟⎝ ⎠ ⎝ ⎠⎝ ⎠
⎛ ⎞⎛ ⎞+ + + − − + +⎜ ⎟⎜ ⎟⎝ ⎠⎝ ⎠
⎛ ⎞⎛ ⎞+ − − +⎜ ⎟⎜ ⎟⎝ ⎠⎝ ⎠
 (2-4) 
然後，同理可得到 csv 的定子電壓方程式如下： 
2 1 22
3 2 3
1 22 2
2 3
cs s c m re A B re a
A B re b ls A B re c
d dv r i cos( ) L L cos( ) i
dt dt
d dL L cos( ) i L L L cos( ) i
dt dt
λ θ π θ π
πθ θ
⎛ ⎞⎛ ⎞ ⎛ ⎞= + + + − − +⎜ ⎟ ⎜ ⎟⎜ ⎟⎝ ⎠ ⎝ ⎠⎝ ⎠
⎛ ⎞ ⎛ ⎞⎛ ⎞ ⎛ ⎞+ − − + + − −⎜ ⎟ ⎜ ⎟⎜ ⎟ ⎜ ⎟⎝ ⎠ ⎝ ⎠⎝ ⎠ ⎝ ⎠
 (2-5) 
同理，可將(2-5)式重新整理如下： 
2 1 2 2
3 2
1 22
2 3
3 1 3 2 2 3 2
2 2 2
cs s c m re A B re a
A B re b
ls A B A B B re B re c
d dv r i cos( ) L L cos( ) i
dt dt
d L L cos( ) i
dt
d L ( L L ) L L L cos( ) L sin( ) i
dt
λ θ π θ
θ π
θ θ
⎛ ⎞⎛ ⎞ ⎛ ⎞= + + + − +⎜ ⎟ ⎜ ⎟⎜ ⎟⎝ ⎠ ⎝ ⎠⎝ ⎠
⎛ ⎞⎛ ⎞+ − − −⎜ ⎟⎜ ⎟⎝ ⎠⎝ ⎠
⎛ ⎞⎛ ⎞+ + + − − + −⎜ ⎟⎜ ⎟⎝ ⎠⎝ ⎠
 (2-6) 
由(2-2)、(2-4)和(2-6)三式，可整理出等效於內藏式永磁同步電動機之三相定子電壓方程式： 
( )
( )
( )
3 0 0 cos20 0
3 20 0 0 0 cos
2 3
0 0 3 20 0 cos2 3
ls A B
re
as s a a
bs s b ls A B b m re
cs s c c
ls A B re
L L L
v r i i
d dv r i L L L i
dt dt
v r i i
L L L
d
d
θ
πλ θ
πθ
⎡ ⎤⎡ ⎤+ + ⎢ ⎥⎢ ⎥ ⎢ ⎥⎡ ⎤ ⎡ ⎤ ⎡ ⎤ ⎡ ⎤⎢ ⎥ ⎢ ⎥⎛ ⎞⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥⎢ ⎥= + + + + −⎢ ⎥⎜ ⎟⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎝ ⎠⎢ ⎥⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥⎢ ⎥⎣ ⎦ ⎣ ⎦ ⎣ ⎦ ⎣ ⎦ ⎢ ⎥⎛ ⎞⎢ ⎥+ + +⎢ ⎥⎜ ⎟⎢ ⎥⎣ ⎦ ⎝ ⎠⎣ ⎦
+
1 3 1 2 1 2cos(2 ) cos(2 ) cos(2 )
2 2 2 3 2 3
1 3 2 cos(2 )1 1 22 22 cos(2 ) cos(2 )
2 2 3
3 sin(2 )
1 3 2 cos(21 1 2 2 22 cos(2 ) cos(2 )
2 2 3
A B B re A B re A B re
A B B re
A B re A B re
B re
A B B r
A B re A B re
L L L L L L L
L L L
L L L L
t L
L L L
L L L L
π πθ θ θ
θ πθ θ
θ
θπθ θ
− − − − − − − − +
− − +− + − − +
+
− − +− + − − − )
3 sin(2 )
a
b
c
e
B re
i
i
i
L θ
⎡ ⎤⎢ ⎥⎢ ⎥⎢ ⎥⎢ ⎥ ⎡ ⎤⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥⎣ ⎦⎢ ⎥⎢ ⎥⎢ ⎥⎢ ⎥⎢ ⎥−⎣ ⎦
 (2-7) 
上式為等效轉換，且不需任何的假設條件，但轉軸角度 reθ 仍然不易由上式單獨擷取出來。故將(2-7)式
 20
1 1 22 cos(2 ) cos(2 )
2 2 3
1 3 22 cos(2 ) 3 sin(2 ) cos
2 2 3
A B re a A B re b
ce
A B B re B re c m re
L L i L L i
L L L L i
πθ θ
λ
θ θ λ θ π
⎧ ⎫⎛ ⎞ ⎛ ⎞− + + − − −⎜ ⎟ ⎜ ⎟⎪ ⎪⎪⎝ ⎠ ⎝ ⎠ ⎪= ⎨ ⎬⎛ ⎞ ⎛ ⎞⎪ ⎪+ − − + − + +⎜ ⎟ ⎜ ⎟⎪ ⎪⎝ ⎠ ⎝ ⎠⎩ ⎭
 (2-15) 
結合(2-8)和(2-12)式，可得到以三相延伸型磁通鏈所表示之內藏式內磁同步電動機三相定子電壓等效方
程式為： 
0 0 0 0
0 0 0 0
0 0 0 0
as s a q a ae
bs s b q b be
cs s c q c ce
v r i L i
d dv r i L i
dt dt
v r i L i
λ
λ
λ
⎡ ⎤⎡ ⎤ ⎡ ⎤ ⎡ ⎤ ⎡ ⎤ ⎡ ⎤⎢ ⎥⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥= + +⎢ ⎥⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥⎢ ⎥⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥⎣ ⎦ ⎣ ⎦ ⎣ ⎦ ⎣ ⎦ ⎣ ⎦⎣ ⎦
 (2-16) 
上述說明了(2-16)式為內藏式永磁同步電動機的等效轉換模型，此數學模型不需要額外的假設條
件，且適用於所有同步電動機。當 d 軸電感等於 q 軸電感時，與轉軸角度2 reθ 有關之函數將不會出現
在三相延伸型磁通鏈中，則(2-16)式可化簡並等效於表面附著式永磁同步電動機。當(2-13)-(2-15)式中
的 0mλ = ，與永久磁鐵相關的參數將不會出現在三相延伸型磁通鏈中，則(2-16)式可化簡，並等效於同
步磁阻電動機。 
在現實世界中，三相延伸型磁通鏈無法經由(2-16)式直接地量測，事實上，透過下列的程序可計算
出三相延伸型磁通鏈： 
0 0 0 0
0 0 0 0
0 0 0 0
ae a s a q a
be b s b q b
ce c s c q c
v r i L i
v r i dt L i
v r i L i
λ
λ
λ
⎡ ⎤⎛ ⎞⎡ ⎤ ⎡ ⎤ ⎡ ⎤ ⎡ ⎤ ⎡ ⎤⎢ ⎥⎜ ⎟⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥= − − ⎢ ⎥⎜ ⎟⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥⎜ ⎟ ⎢ ⎥⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥⎣ ⎦ ⎣ ⎦ ⎣ ⎦ ⎣ ⎦ ⎣ ⎦⎝ ⎠ ⎣ ⎦
∫  (2-17) 
由(2-17)可知，在實際運用中，經由定子電流、定子電壓、定子電阻和 q 軸電感，便可透過積分運
算計算出三相延伸型磁通鏈，然而為了簡化問題，本計畫並未考慮 q 軸電感隨著負載變化的情形，並
留作未來探討的研究方向之一，而 aeλ 、 beλ 及 ceλ 係在三相定子座標下完成計算，經由三軸轉二軸之座
標轉換可得α β− 軸延伸型磁通鏈，與三相延伸型磁通鏈的關係如圖 2-2 所示，並可看出 eαλ 等於 aeλ ，
而 eβλ 與 eαλ 相差 90 度電機角。此時 eαλ 、 eβλ 與 aeλ 、 beλ 、 ceλ 的座標轉換關係式為： 
2 1 1
3 3 3
3 30
3 3
ae
e
be
e
ce
α
β
λλ λλ λ
⎡ ⎤ ⎡ ⎤− −⎢ ⎥⎡ ⎤ ⎢ ⎥⎢ ⎥=⎢ ⎥ ⎢ ⎥⎢ ⎥⎣ ⎦ ⎢ ⎥− ⎣ ⎦⎢ ⎥⎣ ⎦
 (2-18) 
式中： 
  eαλ 、 eβλ ：α - β 軸延伸型磁通鏈 
將(2-13)、(2-14)及(2-15)三式，透過(2-18)式座標轉換後，可得到α β− 軸延伸型磁通鏈為： 
 22
ˆ
ˆ rere
d
dt
θω =  (2-22) 
上述說明了三相延伸型磁通鏈與轉軸角度之間的數學關係，詳細的流程如圖 2-4 所示。定子磁通
估測法，一般由於無法直接估測出轉子磁通 mλ 和轉軸角度 reθ ，故改採估測定子磁通 sˆλ ，然而定子磁通
角度與轉軸角度的關係如下： 
re sθ θ δ= −  (2-23) 
式中： 
  δ ：轉矩角 
  sθ ：定子磁通角度 
由上式可知，傳統定子磁通估測法，需補償轉矩角才可得到轉軸角度，而轉矩角與電動機轉矩的
關係為： 
3 1sin ( ) sin 2
2 2
o s
e m q s q d
d q
PT L L L
L L
λ λ δ λ δ⎡ ⎤= − −⎢ ⎥⎣ ⎦  (2-24) 
式中： 
  sλ ：定子磁通 
故定子磁通與轉軸角度在α β− 軸上之空間關係如圖 2-5(a)所示。然而由(2-19)-(2-20)式可得到在
α β− 軸上之轉子延伸型磁通鏈為： 
( )
2 2 1ˆ tan ( / )
3 cos( ) 3 sin( )( )
e e e e
re a re b c B m rei i i L
α β β αλ λ λ λ λ
θ θ λ θ
−= + ∠
= − + − + + ∠  (2-25) 
式中： λˆ ：轉子延伸型磁通鏈 
由(2-25)式可知，當內藏式永磁同步電動機於同步運轉時，轉軸角度等於轉子延伸型磁通鏈旋轉角
度，如圖 2-5(b)所示為轉子延伸型磁通鏈與轉軸角度在α β− 軸上之空間關係。由上述說明知本計畫提
出一極為簡便的無轉軸角/速度元件之實現，即不需計算轉矩角，只需估算延伸型磁通鏈，便可得到轉
軸角度及轉軸速度，取代原本由編碼器回授的轉軸速度，完成無轉軸角/速度偵測元件之驅動系統的實
現。 
 
 24
於比例-積分控制器的參數為固定，而交流電動機的參數與負載則會隨著運轉狀態而變動，且交流電動機
的數學模式為非線性模式，因此，使用固定的控制器參數無法同時獲得良好的暫態、穩態與加載特性。因
此為了有效提升系統的性能，並具有快速的暫態響應與良好的干擾拒斥能力，非線性控制提供一個很好的
解決方法。由於非線性控制法則具有較佳的設計彈性及更多的控制變數，可依照系統的非線性特性，設計
合適的控制器，提升電動機控速系統的性能，近來已有各種非線性控制理論應用於內藏式永磁同步電動機
[3]-[10]。其中狀態回授線性化及輸入-輸出回授線性化，已成功地應用於永磁同步電動機的控制，改善系
統的暫態響應及穩態特性。但必需以電動機參數或負載估測值將系統之非線性項除去，而使系統線性化。
若參數或負載估測值不夠精確，則無法得到預期的效果[21]-[23]。 
上述之不確定性因素，包括參數變化及外加干擾，在設計控制器時需納入考慮。為改善上述缺失，本
計畫利用適應性控制理論來設計控制器如圖 2-6 所示，針對上述不確定因素，修正控制器的參數，使輸出
的控制量對系統達到最佳的效果。本計畫根據輸入-輸出回授線性化之參數不確定性，對其不確定因素設
計適應性步階回歸控制器作補償，並將轉速、轉矩和 d 軸電流一並納入控制器設計裡，以調適出內藏式永
磁同步電動機所需的 d-q 軸電壓命令，並以李阿普諾夫定理證明系統穩定，再由巴巴勒特定理(Barbalat’s 
lemma)進一步證明整個系統為全域漸近穩定。 
*
bv
*
av
*
cv
U
V
W
rˆeθ
ai
bi
ai
bi
bv
av
rˆeθ
ˆrmω
di
qi
ˆrmω
*
qv
*
dv
ˆrmωdiqidˆT
*
di
*
rmω
 
圖 2-6 非線性控制設計示意圖。 
 
A. 內藏式永磁同步電動機動態方程式 
首先重新整理電動機數學方程式，將內藏式永磁同步電動機的 d-q 軸電流方程式及轉速動態方程
式合併整理，可得系統的動態方程式並以矩陣型式表示如下： 
1/   0
 0 1/
 0  0
3 3 ( )
2
q q rms d
d d
d d
s qrm d d rm m
q d q q
q q q
rm
q m d q
o
o o
o o d q rm m L
m m m
L ir i
L L
i L
r iL ii v L v
L L L
i L
P
L i i B T
J J
P P
J
P P
ω
ω ω λ
ω λ ω
⎡ ⎤− +⎢ ⎥⎢ ⎥⎡ ⎤ ⎡ ⎤⎡ ⎤⎢ ⎥⎢ ⎥ ⎢ ⎥⎢ ⎥⎢ ⎥= − − − + +⎢ ⎥ ⎢ ⎥⎢ ⎥⎢ ⎥⎢ ⎥ ⎢ ⎥⎢ ⎥⎣ ⎦⎢ ⎥ ⎣ ⎦⎣ ⎦ + −⎢ ⎥− −⎢ ⎥⎣ ⎦



 (2-26) 
上式可改寫為： 
1 2( ) ( ) ( )d qx f x g x v g x v= + +  (2-27) 
式中： 
 26
dT ：為外加干擾(disturbance torque) 
    由於本計畫所使用的干擾量估測器屬於線性估測器的一種，為了方便設計，假設未知干擾量 dT 在
每個取樣時間內的變化量為零，可表示為： 
0dT =  (2-34) 
(2-34)式可表示為 dT 的動態方程式，接著將(2-32)-(2-33)式代入速度方程式可得： 
3 3 ( )
2
o q m o d q d q rm mo d
mo mo
r
m
m
o
P i P L L i i B T
J J J
ω λ ω+ − − −=  (2-35) 
由(2-34)和(2-35)式，可整理為二階的動態方程式： 
x Fx Gu d= + +  (2-36) 
y Cx=  (2-37) 
式中： 
[ ] [ ]T Ta b rm dx x x Tω= = ，    0 Tqu i⎡ ⎤= ⎣ ⎦ ， rmy ω=  
11 12
21 22
1
0 0
mo
mo mo
B
F F
J JF
F F
⎡ ⎤− −⎡ ⎤ ⎢ ⎥= =⎢ ⎥ ⎢ ⎥⎣ ⎦ ⎢ ⎥⎣ ⎦
，
3
2
   0
o m
a
mo
b
P
G
JG
G
λ⎡ ⎤⎡ ⎤ ⎢ ⎥= =⎢ ⎥ ⎢ ⎥⎣ ⎦ ⎢ ⎥⎣ ⎦
 
1
2
3 ( )
2
            0
o d q d q
mo
P L L i i
d
d J
d
−⎡ ⎤⎡ ⎤ ⎢ ⎥= =⎢ ⎥ ⎢ ⎥⎣ ⎦ ⎢ ⎥⎣ ⎦
， [ ]1 0C =   
其中： 
moJ ：轉軸慣量已知固定值。 
moB ：摩擦係數已知固定值。 
由於(2-36)及(2-37)式系統的可觀測矩陣為： 
T T TW C F C⎡ ⎤= ⎣ ⎦  (2-38) 
其秩(rank) dim( ) 2W = ，所以所有的狀態向量皆可以被估測。其中狀態 dT 為待量測狀態，故設計降階
估測器用以估測狀態 dT ，其量測狀態的動態可表示為： 
.
22 21 2b b a bx F x F x G u d= + + +  (2-39) 
其中 21 2a bF x G u d+ + 為已知且可視為 bx 動態的輸入。因為 ax y= ，量測的動態為下列純量方程式： 
11 12 1a b ax y F y F x G u d= = + + +   (2-40) 
若將(2-40)式的已知項集中，則可改寫為： 
11 1 12a by F y G u d F x− − − =  (2-41) 
可得知 11 1ay F y G u d− − − 為量測的已知量，和 12 bF x 未知狀態的關係，適當的推導，可得 bx 的降階估
 28
將(2-35)式代入(2-26)式重新整理可得考慮外加干擾負載之系統動態方程式為： 
1/   0 0
 0 1/ 0
 0 1/ 0
ˆ3 3 ( )
2
q q rms d
d d
d d
s qrm d d rm m
q d q q d
q q q
morm
q m d q d q rm mo d
mo mo mo
o
o o
o o
L ir i
L L
i L
r iL i
i v
P
P P
P P
L v T
L L L
J
i L L i i B T
J J J
ω
ω ω λ
ω λ ω
⎡ ⎤− +⎢ ⎥⎢ ⎥⎡ ⎤ ⎡ ⎤⎡ ⎤ ⎡ ⎤⎢ ⎥⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥⎢ ⎥= − − − + + + Δ⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥⎢ ⎥⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥−⎢ ⎥ ⎣ ⎦⎣ ⎦ ⎣ ⎦⎣ ⎦ + −⎢ ⎥− −⎢ ⎥⎣ ⎦



 (2-48) 
上式可改寫為： 
1 2 3
ˆ ( ) ( ) ( ) ( )d q dx f x g x v g x v g x T= + + + Δ  (2-49) 
其中： 
ˆ
d d dT T TΔ = − ， [ ]3 0 0 1/ Tmog J= −  
ˆ ( )
ˆ3 3 ( )
2
q q rms d
d d
s qrm d d rm m
q q q
q m d q d q rm mo d
mo
o
o o
m
o o
o mo
L ir i
L L
r iL if x
L L L
i L L i i B T
J J
P
J
P P
P P
ω
ω ω λ
λ ω
⎡ ⎤− +⎢ ⎥⎢ ⎥⎢ ⎥⎢ ⎥= − − −⎢ ⎥⎢ ⎥+ −⎢ ⎥− −⎢ ⎥⎣ ⎦
 
  
C. 輸入-輸出回授線性化 
使用輸入-輸出回授線性化的技巧，將非線性模型(2-49)式線性化。其基本觀念為對輸出變數作微分直
到輸入控制量出現，找出輸入控制量跟輸出變數之間的關係，並適當選擇輸入控制量，使系統達到想要的
輸出追踨性能，藉由李導數完成座標轉換及狀態回授，完成輸入-輸出回授線性化。 
如需將系統的輸出微分 r 次才能得到輸出-輸入變數之間的關係，則可稱該系統的相對階數(relative 
degree)為r ，任何n階可控系統，n為系統階數，對任一輸出，最多只需微分n次就一定能使控制輸入在
表達式中出現，亦即r n≤ ，而由(2-49)式可知非線性方程式為 3 階系統。 
我們可以知道一個線性系統其相對階數(relative degree) r 可以解釋為轉移函數極點減零點階數之差，
如r n= ，則系統沒有零點，而當r n< ，則系統有零點產生，需分析零點對系統的作用。所謂零動態類
似線性系統的極零點觀念，當輸出 y 微分n次找不到與輸入u 的關係，亦即輸入控制量無法控制所希望的
輸出值時，得另外分析零動態對系統的影響，故為了避免零動態及得到全部地輸入-輸出線性化，選擇 d
軸電流和電動機轉速做為輸出變數，因此為了控制多輸出變數 di 、 rmω ，需找出輸入控制量 dv 、 qv 與輸入
變數之間的關係[21]。 
此時輸入-輸出回授線性化其新的狀態變數定義如下[21]： 
1 1( ) rZ h x ω= =  (2-50) 
ˆ2 1
ˆ3 3 ( )
(
2
) o q m o d q d q r mo d
f
mo mo mo
P i P L L i i B TZ L h
J J
x
J
λ ω+ −= = − −  (2-51) 
3 2 ( ) dZ h x i= =  (2-52) 
 30
2
ˆ 1
3 ( )
( )
2
3 3 ( )
( )
2
ˆ3 3 (
2
( )
)
( )
o d q q o q q rms d
mo d d
o m o d q d s qo rm d d o rm m
mo q q q
q m o d q d qmo rm mo d
mo mo mo o
f
m
P L L i P L ir i
J L L
P P L L i r iP L i P
J L L L
Pi P L L i iB B T
J
h
J J J
L x
ω
λ ω ω λ
λ ω
− − +
+ −+ − − −
− −
=
+ − −
 (2-60) 
ˆ1 1
3 (
)
)
2
( o d qg
q
mo d
f
L L
P L L i
J L
h x = −  (2-61) 
ˆ2 1
3 3
)
)
2
(
(o m o d
g
q d
mo q
f
P P L L i
L x
L
L h
J
λ + −=  (2-62) 
ˆ3 1 2( )
mo
mo
g f
L L h x B
J
=  (2-63) 
由(2-59)式可知，對 rmω 微分二次可得到輸入控制量 dv 和 qv 的出現，故 1( ) rmh x ω= 對系統的相對階數為
1 2r = ，同理，對 3 2 ( )Z h x= 微分直到輸入控制量出現，找出輸入控制量跟輸出變數之間的關係：  
3 2ˆ 1 2 2 2 3 2( ) ( ) ( ) ( )d g g gf dd qv vZ i L h x L h x L h x L h x T= = + + + Δ   (2-64) 
式中： 
ˆ 2 ( )
o q q rms d
f
d d
P L ir iL h x
L L
ω= − +  (2-65) 
1 2
1( )g
d
L h x
L
=  (2-66) 
2 2 ( ) 0gL h x =  (2-67) 
3 2 ( ) 0gL h x =  (2-68) 
由(2-64)式可知，對 di 微分一次可得到輸入控制量 dv 的出現，故 2 ( ) dh x i= 對系統的相對階數為 2 1r = ，
由於 1 2 3r r n+ = = ，因此不需考慮零動態對系統的影響，重新整理(2-59)、(2-64)式可得新的控制量 1u 、
2u 與 d-q 軸電壓命令 *dv 、
*
qv 的關係，為如圖 2-8 所示： 
( )* 1 1*
2
d
q
V u
D x
V u
−⎡ ⎤ ⎡ ⎤=⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎣ ⎦⎣ ⎦
 (2-69) 
其中， 1u 和 2u 是利用適應性步階回歸控制理論所設計之輸入控制量，只要 ( ) 1D x − 為非奇異值
(nonsingular)，及如下所示，則 d-q 軸的電壓命令可經由(2-69)式求得： 
( )
1
ˆ ˆ1 1 2 11
1 2
( ) ( )
( ) 0
g gf f
g
L L h x L L h x
D x
L h x
−
− ⎡ ⎤= ⎢ ⎥⎢ ⎥⎣ ⎦
 (2-70) 
 32
其控制目的就是期望誤差儘快趨近於零。因此針對上述所提到之輸入-輸出回授線性化狀態做設
計，首先定義誤差方程式為： 
*
1 1rme zω= −  (2-78) 
*
2 2 2ˆe z z= −  (2-79) 
*
3 3de i z= −  (2-80) 
其中： 
1e ：速度追隨誤差。 
2e ：虛擬控制量誤差。 
3e ：d 軸電流誤差。 
*
rmω ：轉速命令。 
2
*Zˆ ：穩定函數。                     
*
di ：d 軸電流命令。        
然而，上述所提到之虛擬控制量誤差是為了滿足李阿普諾夫穩定度定理，即 0V ≤ ，所提出來的，但
在現實中誤差 2e 即表示為加速度誤差，我們不能真實的控制它，所以定義一虛擬控制量 2*Zˆ 用以滿足穩
定度定理，即表示如下： 
2
* *
1 1 3 1 1ˆ
ˆ ( )rm gZ k e L h x dω −= +   (2-81) 
其中 1ˆd 為所需估測之不確定因素，用以取代原本的 1d 參數。 1 0k > 為閉迴路之迴授常數。所定義之誤
差動態方程式表示為： 
* *
1 1 2 3 1 1 1 1 3 1 1 2( ) ( )rm rm g ge z z L h x d k e L h x d eω ω= − = − − = − + +    (2-82) 
13 1
*
2 2 1 2
* 2
2 1 1 1 1 3 1ˆ ˆ
ˆ( )ˆ ( ) ( )grm gf fdL h xz d de z k e L h x u L L h xω −−= = + − − − −    (2-83) 
3 2 2 3ˆ
* *
3 ( )fd dz L h x u de i i− − −= = −   (2-84) 
式中 1 1 1ˆd d d= − ，接著選定李阿普諾夫函數，用以求得參數適應律及證明滿足李阿普諾夫穩定度定理，
其選定之李阿普諾夫函數V 為： 
 34
其中， 1d 、 2d 及 3d 的收斂速度取決於 1γ 、 2γ 、 3γ 的選取，另外假設電動機的參數 1d 、 2d 、 3d 在每
個取樣時間內的變化量為零，即 1 1ˆd d=  、 2 2ˆd d=  、 3 3ˆd d=  ，因此在實作中，對(2-90)-(2-92)式作積分運
算可得 1ˆd 、 2dˆ 、 3dˆ 的計算公式： 
1 1 1 1 3 1 1 2 3 1 2 3 1ˆ
ˆ ( ) ( ) ( )g g g fd d e L h x k e L h x e dtL L h xγ ⎛ ⎞⎜ ⎟⎝ ⎠= = − − −∫  (2-93) 
( )2 2 2 2dˆ d e dtγ= = −∫  (2-94) 
( )3 3 3 3dˆ d e dtγ= = −∫  (2-95) 
將(2-90)-(2-92)式代入(2-89)式中可得李阿普諾夫函數V 的微分V為負半定，如下所示： 
 2 2 21 1 2 2 3 3 0V k e k e k e= − − − ≤  (2-96) 
由上式可知 0V ≤ ，知系統滿足李阿普諾夫穩定法則，且知V 為有界函數，因此 1e 、 2e 、 3e 、 1d、 2d 、
3d 皆為有界函數，但只能證明系統誤差量為穩定，無法判斷系統的穩態誤差是否趨近於零。為了探討此
問題，尚須引用巴巴勒特定理來說明，首先需證明 1e 、 2e 、 3e 平方再積分之後仍為有界函數，故對(2-96)
式積分，可得： 
( )2 2 21 1 2 2 3 30 0( ) ( ) ( ) ( ) (0) ( )k e k e k e d V d V Vτ τ τ τ τ τ∞ ∞+ + = − = − ∞ <∞∫ ∫   (2-97) 
    上式證明 1e 、 2e 、 3e 平方再積分之後仍為有界函數，假設控制輸入量 1u 、 2u 為有界函數，則
(2-82)-(2-84)式中的所有參數皆為有界函數，因此 1e 、 2e 、 3e 也為有界函數，最後根據巴巴勒特定理可
推導出： 
1lim ( ) 0t e t→∞ =  (2-98) 
2lim ( ) 0t e t→∞ =  (2-99) 
3lim ( ) 0t e t→∞ =  (2-100) 
如此證明了閉迴路系統為全域漸近穩定，即當時間趨近於無窮大時， 1e 、 2e 、 3e 皆會收斂至零，故
在穩態時，不論是電動機的系統參數，或者外加負載干擾等不確定因素，所設計的適應率(2-90)- (2-92)式，
能即時的修正控制器的參數，使電動機的速度將等於速度命令 *rmω ，並能確保整個系統為全域漸進穩定。 
 36
器(Texas Instruments)公司所生產，晶片型號為 TMS320LF2407 的評估模組控制板(evaluation module 
board， EVM board)，相關的軟體程式包含：系統初始規劃、記憶體空間配置、延伸型磁通鏈計算、
轉軸角/速度估測法則運算、速度及電流控制法則運算、d-q 軸與 a-b-c 軸之座標轉換計算、空間向量脈
波寬度調變等程式。 
ai bia
v bv cv
,ab bcv v ,a bi i
*
rmω
cT − cT + bT − bT + aT − aT +
dcV
*
di
diqi
*
qv *dv
ˆrmω
rˆeθ
,ab bcv v ,a bi i
,a bi i
rˆeθ
rˆeθ
+
−
 
圖 2-10 內藏式永磁同步電動機閉迴路驅動系統。 
 
本子計畫所探討的無轉軸偵測元件永磁同步電動機的驅動系統實體圖，如圖 2-11 所示。此驅動系統
主要可分為硬體與軟體兩大部份，圖中(A)為德州儀器公司所生產 16 位元定點式數位訊號處理器，型號為
TMS320LF2407。硬體電路包含：過電流保護電路，驅動電路、變頻器、回授及偵測電路、電源電路等。
本章主要分為硬體及軟體兩部分來做說明，首先介紹硬體電路，最後則說明數位訊號處理器及軟體程式設
計。 
 38
(1)  洗衣機結構 
本子計畫所控制的洗衣機結構如圖 2-13 所示。主要說明內藏式永磁同步電動機與洗衣槽之耦合關係，
由從圖 2-13，知內藏式永磁同步電動機與洗衣槽之間使用一皮帶作為傳動。而電動機與洗衣槽之間的速度
比，經過實際量測後得到 15:1 的關係式，意即電動機轉動十五圈則帶動洗衣槽旋轉一圈。從 15:1 的關係
式可轉換電動機與洗衣槽的轉速。在實作方面，本子計畫中將洗衣機內原控制板拆除，並以自己所製作的
驅動系統及所撰寫的軟體程式來進行控制。 
滾筒
(洗衣槽)
凸助
內藏式永磁同步電動機
皮帶
 
圖 2-13 洗衣機結構圖。 
 
所採用的內藏式永磁同步電動機為台灣鑫鼎公司所生產，型號為 MEIWA130-750MS-ZK-L2，容量為
1 馬力，由廠商資料可得其規格表如表 2-1 所示，而實體圖如圖 2-14 所示。 
 
 
表 2-1 內藏式永磁同步電動機規格表 
名稱 數值 
額定輸出功率 750 W 
額定轉矩 2.7 Nm 
額定轉速 2000 r/min 
額定電流 4.2 A 
輸入電壓 220 V~230 V  
最大轉矩 8.1 Nm 
最大轉速 3000 r/min 
最大電流 12.6 A 
 
 
 
 40
 
圖 2-15 主程式流程圖。 
 
中斷服務程式 
中斷服務程式主要執行：轉軸角/速度估測、速度估測濾波、速度控制器及空間向量脈波寬度調變
切換控制，如圖 2-16 所示。關於轉軸角/速度估測程式方面，為先讀取電動機定子電流 ai 、 bi 及線對線
電壓 abv 、 bcv 、 cav ，利用(2-20)-(2-22)式計算出線對線延伸型磁通鏈 abλ 、 bcλ 、 caλ ，接著執行(2-23)式，
可得到α β− 軸延伸型磁通鏈 eαλ 與 eβλ ，再執行(2-24)、(2-25)式計算出轉軸電機角 rˆeθ 及轉軸機械角速
度 ˆrmω 。速度控制器方面計算為，將回授的狀態值，代入(2-46)式得到干擾負載估測值 dˆT ，且透過適應
性輸入-輸出回授線性化控制理論所設計之適應律(2-93)-(2-96)式後，再代入(2-101)、(2-102)式計算出
*
qv 、 *dv 值。空間向量脈波寬度調變切換策略：為決定 IGBT 切換狀態的部分，主要功能為根據角度、
區間判斷及 *qv 、 *dv 作計算，以決定 IGBT 的切換狀態後，由數位訊號處理器的 PWM 輸出腳送出至 IGBT
驅動電路以驅動 IGBT，本計畫設定空間向量脈波寬度調變切換的計算週期為 108 微秒，因此中斷服務
程式每 108 微秒即執行一次。 
 42
± 500rpm 正反轉時之實測圖，由圖中知在正反轉下，本計畫所提的估測方法及非線性控制器，能有效
地進行電動機轉速估測及速度追隨；在轉速由正值變為負值時可看出，此時由圖 2-19(b)仍可估測出
正確的電動機轉軸位置，且估測值與實際值相當接近。 圖2-20(a)為速度命令由500rpm加速至1000rpm
之暫態響應實測圖，本文所提出的非線性控制器有較比例積分器更佳的響應。圖 2-20(b)為轉速命令
500 rpm 穩態條件下，瞬間放入 3 公斤衣物的暫態響應圖，由圖中得知洗衣機驅動系統具有良好的干
擾拒斥能力。其中適應性輸入-輸出回授線性化控制器轉速降低約 30 rpm，而比例積分控制器轉速降
了約 60 rpm。圖 2-21 為速度在 500 rpm 時。此時非線性速度控制器參數選定為 1 7.5k = ， 2 15.625k = ，
3 0.05k = ； 1 0.0001525γ = ， 2 0.0001525γ = ， 3 0.000305γ = 時的負載估測響應。 圖 2-22 為速度命令 500 
rpm 時 相關參數 1d
∧
, 2d
∧
, 3d
∧
的暫態響應. 圖 2-22 為速度命令 500 rpm 下，負載估測響應圖。本文中考
慮參數不確定性之參數適應值，分別為 1ˆd 、 2dˆ 、 3dˆ ，用以補償電動機慣量、外加負載及摩擦量變動時
之控制量。圖 2-23(a)(b)(c)為洗衣機驅動系統下洗衣流程命令之電動機轉速實測圖，執行時間為 550 秒，
一般洗衣機標準流程為執行 2 次洗衣流程命令。圖 2-23(b)為圖 2-23(a) I 部分的展開圖，其目的為洗衣
機下速度命令進行溶解洗衣粉及攪拌之實測圖，圖 2-23(c)為圖 2-23(a) II 部分的展開圖，為後續洗衣機
進行攪拌再脫水之電動機轉速實測圖；在劇烈的轉速變化下，本計畫所提出之轉軸角度估測法則與非
線性控制器仍能具有良好的動態估測能力及速度追蹤性能，此說明洗衣機驅動系統之正確性及可行性。 
 44
βαλ λ
αλ βλ
 
(a) 
αλ
βλ
 
(b) 
 
 
 46
 
 
 
rmω
 
(a) 
  
reθ
 
(b) 
 
圖 2-19 洗衣機正反轉 500 r/min 的響應:  
(a) 速度; (b) 轉軸角度 
 
 48
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0 1 2 3 4 5
Time
dˆT (N.m)
dˆT
( sec)  
圖 2-21 速度命令 500 rpm 時，負載估測暫態響應。 
1ˆd
2dˆ
3dˆ
 
圖 2-22 速度命令 500 rpm 時，參數響應： 
(a) 1ˆd ；(b) 2dˆ ；(c) 3dˆ 。 
 50
   
rmω
 
(c) 
圖 2-23 洗衣機進行洗衣流程時： 
(a)轉速實測；(b)溶解洗衣粉及攪拌時轉速實測； 
(c)攪拌再脫水時轉速實測。 
 
 
 52
[8] Y. A. R. I. Mohamed and T. K. Lee, “Adaptive self-tuning MTPA vector controller for IPMSM drive 
system,” IEEE Transaction on Energy Conversion, vol. 21, no. 3, pp. 636-644, Sep. 2006. 
[9] M. A. Rahman, D. M. Vilathgamuwa, M. N. Uddin, and K. J. Tseng, “Nonlinear control of interior 
permanent-magnet synchronous motor,” IEEE Transactions on Industrial Applications, vol. 39, no. 2, pp. 
408-416, Mar./ Apr. 2003. 
[10] J. L. Shi, T. H. Liu, and Y. C. Chang, “Adaptive controller design for a sensorless IPMSM drive system 
with a maximum torque control,” IEE Proceeding-Electric Power Applications, vol. 153, no. 6, pp. 
823-833, Nov. 2006. 
[11] C. G. Chen, T. H. Liu, M. T. Lin, and C. A. Tai, “Position control of a sensorless synchronous reluctance 
motor,” IEEE Transactions on Industrial Electronics, vol. 51, no. 1, pp. 15-25, Feb. 2004. 
[12] J. L. Shi, T. H. Liu, and Y. C. Chang, “Position control of an interior permanent-magnet synchronous 
motor without using a shaft position sensor,” IEEE Transactions on Industrial Electronics, vol. 54, no. 4, 
pp. 1989-2000, Aug. 2007. 
[13] T. H. Liu, S. H. Chen, and D. F. Chen, “Desigh and implementation of a matrix converter PMSM Drive 
without a shaft sensor,” IEEE Transactions on Aerospace And Electronic Systems, vol. 39, no. 1, pp. 
228-243, Jan. 2003. 
[14] J. K. Seok, J. K. Lee, and D. C. Lee, “Sensorless speed control of nonsalient permanent-magnet 
synchronous motor using rotor-position-tracking PI controller,” IEEE Transactions on Industrial 
Electronics, vol. 53, no. 2, pp. 399-405, Apr. 2006. 
[15] Z. Chen, M. Tomita, S. Doki, and S. Okuma, “An extended electromotive force model for sensorless 
control of interior permanent-magnet synchronous motors,” IEEE Transactions on Industrial Electronics, 
vol. 50, no. 2, pp. 288-295, Apr. 2003. 
[16] V. Petrovic, A. M. Stankovic, and V. Blasko, “Position estimation in salient PM synchronous motors 
based on PWM excitation transients,” IEEE Transactions on Industrial Applications, vol. 39, no. 3, pp. 
835-843, May/June 2003. 
[17] O. Wallmark, L. Harnefors, and O. Carlson, “An improved speed and position estimator for salient 
permanent-magnet synchronous motors,” IEEE Transactions on Industrial Electronics, vol. 52, no. 1, pp. 
255-262, Feb. 2005. 
[18] M. Tursini, R. Petrella, and F. Parasiliti, “Initial rotor position estimation method for PM motors,” IEEE 
Transactions on Industrial Applications, vol. 39, no. 6, pp. 1630-1640, Nov./ Dec. 2003. 
[19] L. Ying and N. Ertugrul, “A novel, robust DSP-based indirect rotor position estimation for permanent 
magnet AC motors without rotor saliency,” IEEE Transactions on Power Electronics, vol. 18, no. 2, pp. 
539-546, Mar. 2003. 
[20] S. Morimoto, K. Kawamoto, M. Sanada, and Y. Takeda, “Sensorless control strategy for salient-pole 
PMSM based on extended EMF in rotating reference frame,” IEEE Transactions on Industrial 
Applications, vol. 38, no. 4, pp. 1054-1061, Jul./ Aug. 2002. 
[21] J. J. E. Slotine and W. Li, Applied Nonlinear Control. Englewood Cliffs, NJ.: Prentice-Hall, 1991. 
[22] A. Isidori, Nonlinear Control Systems. Springer, 1995. 
[23] M. Krstić, I. Kanellakopoulos, and P. V. Kokotović, Nonlinear and Adaptive Control Design, NY.: John 
Wiley & Sons, 1995. 
  
 54
 
子計畫三：永磁同步電動機之徑向力分析、控制及自軸承應用研究 
 
執行期限：97 年 8 月 1 日至 99 年 7 月 31 日 
主持人：楊勝明 教授  國立臺北科技大學 電機系 
 
3-1 前言 
自軸承馬達的運作原理是將馬達與磁力軸承結合，使馬達具有軸承的功能，就如同裝有機械軸承
之馬達一般。轉子的懸浮力可以利用馬達線圈或外加的懸浮線圈產生，因為產生懸浮力的線圈都在定
子槽內，因此在體積上比傳統馬達與磁力軸承分開的結構小很多。又因為旋轉時無磨擦力，此技術適
合用在各種高速主軸，如研磨拋光機、切割機、壓縮機、泵等。本子計畫為二年期的計畫，主要的目
的是研究、分析、設計及製作一表面磁鐵型永磁同步自軸承馬達。各年度的主要研究項目如下：第 1
年：永磁同步自軸承馬達設計及製作，自馬達徑向力控制法則設計及實驗驗證，徑向被動式磁力軸承
以及軸向主動式磁力軸承及其驅動控制系統設計製作。第 2 年：轉子之徑向及軸向位移感測器研究，
整合自軸承 PMSM 控制系統，測試整個系統的性能。 
 
3-2 研究目的 
本子計畫的目的是研究、分析、設計及製作一個可以應用在高速主軸的SPM-PMSM自軸承馬達之雛
型機，此馬達可能的應用如研磨拋光機、切割機、壓縮機、泵等。雛型機的機構圖如圖3-1所示，主要
規格如表3-1所示。為了減少控制系統與驅動器的數目馬達選用6槽4極，輸出功率約100W，可以產生
約20N的徑向力。如圖3-1所示，在徑向使用一被動式徑向磁力軸承與自軸承馬達搭配以穩定轉子，軸
向則使用一雙極式電磁鐵提供軸向之平衡力。因為被動式徑向磁力軸承亦會產生向上的軸向力，此力
量若工作點設計恰當正好可以抵消轉子之重力，因此電磁鐵所需之平衡力可以大幅降低。馬達轉角利
用光盤與光學模組分離之編碼器量測。轉子的徑向及軸向位移量測對懸浮控制而言相當重要，通常可
使用現有的渦電流或電容式感測器等，但這些感測器的體積與成本皆較高，因此本計畫亦發展一體積
小、低成本、高準確性的位移感測系統，此系統利用線性霍爾感測器(Linear Hall-Effect Sensor)量測轉
子的線性位移。以下就上述的研究內容分別說明研究方法及成果。 
 
              
圖 3-1 自軸承馬達系統示意圖 
 
表 3-1 
 56
久磁鐵的磁通連結至懸浮繞組之磁通鏈對轉子徑向位移的變化量，單位為Wb/m。因為懸浮線圈只有2
極，故當轉子在氣隙之正中心時與4極的轉子磁場並無磁通連結；但當轉子不在氣隙中心時，耦合磁通
會與位移成正比關係。 
將式(3-1)-(3-4)線圈之共能(Co-energy)求出後，再分別對徑向位移xr及yr進行偏微分，整理後可得X及
Y軸方向的徑向力如下： 
( ) rxrsdrmd43rsqrmq1rsdpqrx xiiMM2
1iiMi
2
1F βλ +⋅⋅++⋅⋅+=  (3-5) 
( ) ryrsqrmd42rsdrmq1rsqpdry yiiMM2
1iiMi
2
1F βλ +⋅⋅+−⋅⋅+⋅−=  (3-6) 
其中 xβ 、 yβ 為轉子磁鐵力量常數。因為M2 大約等於M3 ，故重新定義 ( ) =+= 42d MM2
1M  
( )43 MM2
1 + ，及 1q MM = ，則式(3-5)-(3-6)可改寫為 
⎥⎥⎦
⎤
⎢⎢⎣
⎡+⎥⎦
⎤⎢⎣
⎡
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢
⎣
⎡
−−
+
=
⎥⎥⎦
⎤
⎢⎢⎣
⎡
r
y
r
x
r
sd
r
sq
r
mqq
r
mddpd
r
mddpq
r
mqq
r
y
r
x
y
x
i
i
iMiM
2
1
iM
2
1iM
F
F
β
β
λ
λ
 (3-7) 
因為馬達向量控制的關係，轉子座標d軸電流設為零，即 0irmd = ，故式(3-7)可進一步簡化，並將電流表
為力量的函數可得 
⎟⎟⎠
⎞
⎜⎜⎝
⎛
⎥⎥⎦
⎤
⎢⎢⎣
⎡−
⎥⎥⎦
⎤
⎢⎢⎣
⎡
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢
⎣
⎡ −
=⎥⎦
⎤⎢⎣
⎡
r
y
r
x
r
y
r
x
r
mqqpd
pq
r
mqd
r
sd
r
sq
y
x
F
F
iM
2
1
2
1iM1
i
i
β
β
λ
λ
Δ  (3-8) 
其中 pdpqrmq2q 4
1iM λλΔ +⋅= 2  。 
利用上式可由需求的徑向力命令計算所需的懸浮電流，計算時必須用到的參數：Md、Mq、 xβ 、 yβ 、
λpd及λpq可以利用有限元素分析或用實驗量測求得。又懸浮繞組電流並不產生轉矩，但懸浮繞組電流與
轉矩繞組電流都會產生徑向力，因此轉矩繞組的控制與傳統PMSM向量控制方法完全相同，但懸浮繞
組的控制必須利用式(3-8)將 rmqi 之影響解耦才能正確地控制徑向力。 
 
B. 單一線圈控制 
上述的方法馬達具有轉矩及懸浮兩種繞組，接下來說明將此二繞組之功能結合，只需一個繞組即可
同時控制馬達的轉矩與徑向力的方法。觀察圖3-2所示的複合及單一線圈式PMSM馬達結構圖，若讓圖
3-2(b)之線圈電流(i1 ~i6)與圖3-2(a)之線圈電流(ima、imb、imc，isa、isb、isc)在每ㄧ個槽所產生的磁動勢完
全相同，則馬達雖有不同的線圈結構，但產生的磁場、轉矩及徑向力完全相同。因此可以得到以下的
電流關係： 
sbsmbmmam21 iN2iNiNNiNi −−=−   (3-9) 
sasmcmmbm32 iN2iNiNNiNi +−=−   (3-10) 
scsmammcm43 iN2iNiNNiNi −−=−   (3-11) 
sbsmbsmam54 iN2iNiNNiNi +−=−   (3-12) 
 58
波形，皆含有ima~imc與isa~isc的頻率，但電流之間相差60度電子角。 
 
3. 3 徑向力控制實驗結果 
因為第一年度設計製作的馬達的輸出轉矩及力量皆不足，且頓轉轉矩(Cogging Torque)相當大使得徑
向力控制相當困難。因此第二年度重新以ANSOFT-EM2D軟體分析設計一改良的馬達，此馬達之定子
與轉子如圖3-4所示。除了改良轉子設計使能產生足夠的轉矩及徑向力外，新的轉子亦具有3層步階式
排列的永久磁鐵以降低頓轉矩。 
馬達徑向力的實驗機構包括以下部分：實驗平台、自軸承馬達、馬達驅動器、及4個可以量測馬達
產生之徑向力之力矩規(Load Cell)與其固定機構。實驗機構如圖3-5所示，轉子上端以萬向接頭與負載
馬達聯接。量測馬達的徑向力時，轉子下端以兩個力矩規固定，力矩規的擺放位置相差90度，可以量
測壓縮力及伸張力。做自軸承控制實驗時，將力矩規移除使馬達的下端可以在徑向自由移動。 
 
 
(a)                          (b) 
圖3-4 自軸承馬達：(a)定子，(b)轉子 
 
 
(a)                       (b) 
圖3-5 徑向力實驗系統：(a)實驗平台，(b) Load Cell固定機構 
 
圖3-6顯示馬達靜止不動並產生20N、0.8Hz頻率旋轉之徑向力時的實驗結果，此圖顯示徑向力相當準
確且為圓形，徑向力漣波相當小。圖3-7顯示馬達以500rpm旋轉並產生20N、0.8Hz頻率旋轉之徑向力時
的實驗結果，其中圖3-7(a)顯示馬達的轉速命令及實際轉速、imq、imd及ima~imc，圖3-7(b)顯示徑向力命
令、isq、isd及isa~isc，圖3-7(c)顯示i1 ~ i6，圖3-7(d)顯示量測的徑向力對時間圖，圖3-7(e)顯示量測的徑向
力Fx-Fy圖。圖3-8顯示與圖3-7相同的信號但馬達以1000rpm旋轉。觀察圖3-7及圖3-8的結果可以發現馬
達產生的徑向力大致正確，但當轉子旋轉時徑向力會有一些漣波出現，導致漣波的主因是量測機構的
 60
 
圖3-8 馬達旋轉1000rpm，徑向力20N並且以0.8Hz的頻率旋轉，(a)馬達運轉參數，(b)徑向懸浮參數(c)
單一繞組之馬達、懸浮電流，(d)徑向力F-t圖，(e)徑向力Fx-Fy圖 
 
3.4 軸向電磁鐵設計、製作與控制 
軸向電磁鐵主要的功能是控制轉子的軸向平衡，包含三個部份：上、下環型電磁鐵、及轉子圓盤鐵
心，圖3-9為結構的示意圖。上、下環型電磁鐵各包含一組線圈及一個環形鐵心；圓盤鐵心則固定在轉
子上且與轉子同軸。此電磁鐵利用有限元素方法設計，圖3-10顯示後上環型電磁鐵及轉子鐵心的實體
圖。 
軸向電磁鐵控制轉子的軸向位置，電磁鐵產生的力量與電流平方成比率且與氣隙長度成反比。假設
上、下電磁鐵的電流分別為iz1及iz2且氣隙長度大約維持在定值，則電磁鐵產生的吸引力可以下式表示: 
2
1zi1z iKF ⋅=    (3-22) 
2
2zi2z iKF ⋅=  (3-23)  
上式之 iK 為常數。因為電磁鐵只能產生吸引力，為了使電磁鐵在線性區運作，令 iz1 及 iz2 為以下形式： 
ΔiIi b1z +=  (3-24) 
ΔiIi b2z -=  (3-25) 
其中 bI 為平均電流，運作時調整為正好可以抵消轉子之重力； iΔ 為控制量。將式(3-24)-(3-25)帶入
(3-22)-(3-23)，整理後電磁鐵之合力為 
ΔiIK4-FFF bi2z1z ⋅⋅≈=  (3-26) 
因為 iK 與 bI 為常數，故總電磁鐵力 F 與 iΔ 成正比。 
圖3-11顯示軸向電磁鐵控制系統的方塊圖，線圈電流以PI控制，轉子軸向位置則以PID型控制器控
制。軸向位置使用4個Hall Sensor量測，其結構及運作原理可參考[1]。 
在實驗驗證的過程中，我們發現此電磁鐵機構設計有一些問題使其不易正常運作，由於轉子鐵心之
半徑過大，在加入電流後只要轉子有些微的傾斜即會導致鐵心邊緣撞及定子鐵心。在發現此問題後我
們已經開始探討可以避免此問題的新型機構。 
 62
zKΑBB
B
BB
BAZ
4x3x
4x
2x1x
2x ⋅⎟⎟⎠
⎞
⎜⎜⎝
⎛
−+−+=Δ  (3-27) 
上式之A及Kz為與感測器幾何位置相關的常數。上述的感測系統設計最大的優點在於計算磁力線進入感
測器的角度變化，故可有效的降低因磁路不均所造成的量測誤差。 
 
B. 徑向位移量測 
徑向位移量測方法與軸向位移的量測方法類似，但利用感測器S1、S3量測X軸方向位移，以及S5、
S6量測Y軸方向位移。以X軸方向為例，若位移為ΔX，則由感測器幾何關係可以求得 
x
1x3x
1x KC
BB
BCX ⋅−≅ )2-(Δ  (3-28) 
其中 C 和 Kx 為常數。Y 軸方面位移量測原理相同。 
圖3-13顯示轉子在氣隙的正中心位置且以500rpm旋轉時，(a)Hall Sensor量測之6個磁通密度信號，(b)
則為使用上述方法計算得到的轉子位置。觀察此圖可以發現量測的磁通密度信號會隨著轉子在不同位
置有很大的變化，但計算的轉子位置誤差則相當小，尤其是Z軸幾乎沒有誤差。轉子的徑向運作範圍為
+-1.0mm，最大誤差約為0.023mm；軸向運作範圍為+-0.5mm，最大誤差約為0.008mm。誤差產生最大
的原因是安裝於轉子的環形永久磁鐵充磁不均勻所導致。 
轉子徑向及軸向位移量測系統的研究已完成，詳細的研究方法及實驗結果可參考發表的論文[2]。此
外，由於計畫人力不足的關係，我們並未將此感測機構與自軸承馬達整合，但為了方便進行實驗，自
軸承馬達測試時使用渦電流位置感測器以量測轉子之徑向位移。 
 
 
圖3-13 轉子在氣隙之正中心位置且以500rpm旋轉，(a) Hall Sensor量測之信號，(b)計算得到的轉子位置 
 
3-6 結果與討論 
本子計畫主要的結果及討論如下： 
(1) 完成分析、設計及製作一永磁同步自軸承馬達，此馬達為4極6槽，輸出功率約100W，轉子使用3層
步階式排列的銣鐵硼磁鐵以降低馬達的頓轉轉矩。 
(2) 使用ANSOFT-EM2D分析自軸承馬達的力量模式，完成設計徑向力控制法則，並建立驅動控制系統。 
(3) 完成馬達徑向力量測系統的實驗機構之設計製作，徑向力的實驗驗證也已完成，可以產生約20N的
徑向力。這些結果已發表在國際研討會，整理後亦將投稿到期刊。 
(4) 完成軸向電磁鐵的分析、設計及製作，但實驗驗證時發現轉子鐵心邊緣經常會撞到定子鐵心。目前
已經開始重新設計可以避免此問題的新型電磁鐵機構。 
(5) 完成轉子徑向及軸向位移量測系統之分析、設計、製作及實驗驗證。實驗驗證的結果顯示提出的轉
子位置感測方法可以同時量測徑向及軸向位置。轉子在轉動時，量測之軸向位置最大誤差約為
0.008mm，徑向位置最大誤差約0.023mm。此研究成果已在相關的期刊發表。 
(6) 由於軸向電磁鐵的設計有一些問題，必須重新設計電磁鐵機構，來不及在計畫結束前與自軸承馬達
結合，因此我們將整合系統做一些簡化，軸向不使用電磁鐵控制，只使用由環形磁鐵組成的被動式
 64
[6] Sheng-Ming Yang and Chun-Cheng Lin, “Performance of a Single-Axis Controlled Magnetic Bearing 
for Axial Blood Pump”, IEEE- IAS 2007 Annual Meeting, New Olean, USA, Sep. 2007. 
[7] Sheng-Ming Yang and Chien-Lung Huang, “A Low Cost Linear Position Sensor System for 
Magnetically Levitated Rotor in Axial Flow Pump”, IEEE-IAS 2008 Annual Meeting, Canada. 
[8] 黃見龍、楊勝明，“An Axial and Radial Displacement Measurement System for Magnetically 
Levitated Rotors”，第七屆台灣電力電子研討會，崑山科技大學，2008年9月。 
[9] Sheng-Ming Yang, Chien-Lung Huang, “Design of A New Electromagnetic Actuator Which Can 
Produce Three-Dimensional Forces”, INTERMAG 2009, USA, May 2009. 
[10] Sheng-Ming Yang, Chien-Lung Huang, Jun. 18-19, 2009, “Control of a Electromagnetic Actuator for 
Miniature Magnetically Levitated Rotating Machine”, the 7th International Mini-Workshop on Power 
Electronics and Motion Control, Nagoya, Japan. 
[11] Sheng-Ming Yang, Chien-Lung Huang, “Implementation and Control of a Electromagnetic Actuator for 
Miniature Magnetically Levitated Rotating Machines”, ECCE2009, San Jose CA. USA, Sep. 2009. 
[12] Sheng-Ming Yang, Chih-Chun Chen, “Improvements of Radial Force Control for a SPM Type PMSM 
Self-Bearing Motor Drive”, ECCE2009, San Jose CA. USA, Sep. 2009. 
[13] Sheng-Ming Yang, Chien-Lung Huang, “A Electromagnetic Actuator Which Can Produce 
Three-Dimensional Forces for Miniature Magnetically Levitated Axial Flow Pump”, IEEE PEDS, 
2009. 
[14] 陳佳斌、楊勝明，2009年11月28日，“表面磁鐵形式的永磁交流自軸承馬達徑向力控制策略改進”，
第三十屆電力工程研討會，龍華科技大學. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 66
式時之馬達電流的漣波，並加快馬達電流之上升速度及改善追隨命令電流之響應速度；當電動機車運
轉於煞車模式時，則使用另外一組降壓截波器，使馬達定子繞組之儲能與反流器並接電容上之電量，
能夠將能量回送到電源端，即對電池回充，其電路圖如圖 4-4 所示。在圖 4-4 中所使用的升壓截波器是
使開關元件 AQ 永遠保持 OFF，首先在觸發信號 BS 送導通責任週期時間 D至開關元件 BQ 後， BQ 保持
為 ON，此時電池端之電流 Ldc ii = 開始流經儲能電感 L，即電感 L 開始儲能，然後在觸發信號 BS 送截
止責任週期時間 D−1 至開關元件 BQ 後， BQ 截止為 OFF，此時在電池及電感 L 上之儲能電流開始流經
AD ，並流經反流器端，使得反流器端之電容電壓為電池及電感 L 上之電壓。在穩態時之反流器端之電
容電壓 scV 為 
dcsc VD
V −= 1
1  (4-1) 
Ldcsc IDIDI )1()1( −=−=  (4-2) 
其中 10 << D ，且 dcsc VV > 。 
其次在圖 4-4 中所使用的降壓截波器是使開關元件 BQ 永遠保持 OFF，在觸發信號 AS 送導通責任週期時
間D至開關元件 AQ 後， AQ 保持為 ON，馬達定子繞組之自感儲能及反流器端之電容電能開始流回電池
電源，同時亦流經儲能電感 L，即電感開始作反相儲能， 此時對電池回充電能，然後在觸發信號 AS 送
截止信號至開關元件 AQ 後， AQ 截止為 OFF，此時在電感 L 上之儲能電流開始流經 BD ，並再一次的對
電池回充電能。在穩態時電池端之電壓 dcV 為 
scdc DVV =  (4-3) 
scdc ID
I 1=  (4-4) 
其中 10 << D ，且 dcsc VV > 。 
其次發展再生煞車回充之模糊類神經網路控制之操作模式，為了實現再生煞車回充控制，實驗架構採
以煞車裝置代替車體負載，如圖 4-5 所示。以煞車裝置代替車體負載之具能量回充控制系統方塊圖如
圖 4-6 所示，在圖 4-6 中，首先由駕駛者下達行駛命令，馬達於靜止中是不容易估測轉軸角度，故使用
偵測馬達各相電流之斜率變化值來得知馬達各相之自感值，然後再決定下達哪一相電流之激磁命令，
而使馬達可以順利啟動。在電動機車於行駛區時，控制器會依據行駛命令之下達，而以命令轉矩之方
式使永磁同步電動機運轉，並以轉子角度，提供給換相電路，另一方面經由數位差分器轉換為角速度
ω，提供給比較速度命令 ∗ω 及角速度ω之間差值之遞迴式模糊類神經網路控制及可變結構控制之智慧
型速度控制器，決定出電流命令，並提供給速度/電壓轉換器將速度經由函數之轉換及比例因子之換算
後，轉換為馬達反電動勢 ∗dcV ，然後將反流器輸入端之電容電壓 dcV 經由電壓感測電路後，再送至電壓
比較電路與估測馬達反電動勢 ∗dcV 比較，將比較後所得到的電壓差值 )(NVΔ 及其電壓差值變化率
)1()( −Δ−Δ NVNV 送進模糊類神經網路控制器之輸入端，經由模糊類神經網路之訓練計算後，送出調
整信號至脈寬調變電路以產生提供給截波器開關元件之導通責任週期，另外將由電池端所感測到的電
流 dci 與經由速度/電流轉換器將速度以函數及比例因子換算後所得到之馬達電流 ∗sci 相比較，將比較後所
得到之電流差值 )(NIΔ 及其電流差值變化率 )1()( −Δ−Δ NINI 送進另一組模糊類神經網路控制器之輸
入端，經由模糊類神經網路之訓練計算後，送出調整信號至脈寬調變電路以產生提供給截波器開關元
件之導通責任週期，此皆依據電動機車之行駛模式或煞車模式，使升壓截波器之功率開關元件或降壓
截波器功率開關元件導通或截止。在行駛模式中，使用升壓截波器，以增壓反流器之端電壓值來加快
 68
 
 
 
 
 
 
圖 4-1  電動機車控制系統方塊圖  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
圖 4-2 無轉軸偵測元件偵測方法應用於智慧型控制器之控制架構圖 
 
 
 
 
 
 
 
ai bi ci bv
永磁
同步
馬達C
功率模組
反流器
+
−
av cv
脈寬調變
及電流控制
TM S320C 32 D SP 控制板
隔離驅動
電路
電流感測
電路及
類比/數位
轉換電路
電壓感測
電路及
類比/數位
轉換電路
三相/兩相
座標轉換
滑動模式
電流觀測器
實際系統
之轉換
電壓估測
切換增益
+
-
-
+
磁通位置及
轉速估測
eθˆ rωˆ
+
_
智慧型速度
控制器
0* =di
*
qie
*
ai *bi
*
ci
限制器 座標轉換及
正弦及餘弦
產生
∗ω
eθˆ
rωˆ
Σ
Σ
Σ
s
qs
s
ds vv ,
qd vv ,
qd vv ˆ,ˆ
s
qs
s
ds ii ˆ,ˆ
α
α
α
s
qs
s
ds ii ,
qd vv ˆ,ˆ
直流
V dc=48V
機械控制
無段式
變速系統
(C V T)
車輪
智慧型速度
控制器
行駛模式
轉矩命令
滑動模式
之磁通位置及
轉速估測器
IGBT功率
模組反流器
永磁同步
電動機
機械控制
無段式
變速系統
(CVT)
車輪轉矩/轉速轉換器 Σ
+
-
 70
 
 
 
 
 
 
 
 
  
(a)                              (b) 
圖 4-5 採以煞車裝置代替車體負載之再生煞車回充控制實驗架構圖 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
圖 4-6  以煞車裝置代替車體負載之具有能量回充系統控制方塊圖 
 
 
控制電腦
+
-
直流電源
Vdc=48V
電流比較及
電流控制器
類比/數位
轉換電路
智慧型控制器
及速度估測器
*
ai
*
bi
*
ci
轉軸角
度估測
器
差分器
速度/電壓及
速度/電流
比例轉換器
類比/數位轉換
電路以及電壓
和電流比較器
∗
scv∗sci
ω
脈寬調變電路及
步階回歸控制器
永磁同步
電動機
功率模組
反流器
ia ib
電流感測
電路
隔離驅動
電路
ia ib
脈寬調變電路
及互鎖電路
ic
ic
θ
DSP 控制板
C
儲能電感
AQ
BQ +
-
隔離驅動
電路
電壓及電流
感測電路
行駛指令
煞車指令
具能量回充之升壓/降壓截波器
Cd
scvdciBSAS
AD
BD
L
ia
ib
ic
座標轉換
aT bT cT
+
aT −aT +bT
−
bT +cT
−
cT
+
aT −aT +bT
−
bT +cT
−
cT
交流伺
服馬達
聯軸器
具有能量回充之
升壓/降壓截波器電路永磁同步電動機
交流伺服馬達
(煞車裝置) 
VS-ECD 2812 
DSP控制器 電流感測電路智慧型功率模組反流器
脈寬調變電路
及互鎖電路隔離驅動電路
 72
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
圖 4-8 在命令轉速為 2400rpm 時的實測結果:(a)轉子轉速及估測轉速，(b) 轉子實際角度及轉子估測角
度，(c) a 相命令電流及 a 相實際電流波形圖，(d) b 相命令電流及 b 相實際電流波形圖，(e) c 相命令電
流及 c 相實際電流波形圖，(f) d 軸估測電壓及 q 軸估測電壓波形圖及 Lissajous 圖，(g) a 相實際電流及
b 相實際電流波形圖  
 
 
 
 
 
 
 
 
圖 4-9 施加 1.5Nm 制動轉矩於永磁同步電動機轉軸端時之轉子轉速及估測轉速及 a 相實際電流:(a)命
令轉速為 1200rpm，(b)命令轉速為 2400rpm  
(b)
(c)
0.02s
5rad
0rpm
30A
0A
0.05s
命令
轉速
0.2s
估測
轉速
實際
轉速
2400rpm
0rad
6.28rad實際角度
估測
角度
起動
起動
a相命令電流
a相
實際
電流
起動
(a)
0.05s
30A
0 A
(d)
b相命令電流
b相
實際
電流
起動
(e)
0.02s
0A
0.05s
d軸
估測
電壓
起動
c相命令電流
c相
實際
電流
30A
q軸
估測
電壓
d
軸
估
測
電
壓
q軸估測電壓
(f)
0.01s
20A
(g)
a相實際電流 b相實際電流
0rpm
命令轉速
0.5s
估測
轉速
實際
轉速 1200rpm
加載
a相實際電流
514rpm
30A
(a)
0rpm
命令轉速
0.5s
估測
轉速
實際
轉速 2400rpm
加載
a相實際電流
960rpm
30A
(b)
 74
範圍及不同負載來訓練遞迴式模糊類神經網之輸出電流，達到各種不同控速範圍之輸出轉矩。最後所
提出之控制系統由實測結果來加以驗證。 
第二年計畫係將智慧型控制及永磁同步電動機驅動系統應用於電動機車，並發展永磁同步電動機之無
轉軸偵測元件之智慧型控制方法。首先建立無段變速電動機車之動態數學模式及行駛狀況，然後架構
出永磁同步電動機之運轉模式。其次發展無轉軸感測元件偵測技術，並應用在以遞迴式模糊類神經網
路及可變結構控制之智慧型控制的永磁同步電動機驅動系統上。此智慧型控制系統根據各種控速範圍
及不同負載來訓練遞迴式模糊類神經網路，以調整速度控制器之輸出電流，達到各種不同控速範圍之
輸出轉矩。最後所提出之控制系統由實測結果來加以驗證 
4-5 子計畫成果自評 
本子計畫已發表與本計畫相關之國際性研討會論文如下: 
[1]  Chih-Hong Lin, and Chih-Peng Lin, “Adaptive backstepping FNN control for a permanent magnet 
synchronous motor drive,” in Proceedings IEEE 4th Conference on Industrial Electronics and 
Applications (ICIEA’09), May 25-27, Xian China, pp. 2712-2717, 2009. (EI)  
[2]  Chih-Hong Lin, and Chih-Peng Lin, “Fuzzy neural network control for a permanent magnet synchronous 
motor drive system,” in Proceedings IEEE 4th Conference on Industrial Electronics and Applications 
(ICIEA’09), May 25-27, Xian China, pp. 2718-2723, 2009. (EI)  
[3]   Chih-Hong Lin, and Chih-Peng Lin, “The hybrid RFNN control for a PMSM drive system using rotor 
flux estimator,” in Proceedings IEEE 8h Conference on Power Electronics and Drive Systems 
(PEDS’09), Nov.2-5, Taipei, Taiwan, pp. 1394-1399, 2009. (EI)  
[4]  Chih-Hong Lin, Po-Hwa Chiang and Chi-Shin Tseng, “Adaptive Backstepping Control for a Permanent 
Magnet Synchronous Motor Drive Using RNN Uncertainty Observer,” in Proceedings IEEE 4th 
Conference on Industrial Electronics and Applications (ICIEA’10), June 17-20, Taichung, Taiwan, 
R.O.C. 2010. (EI)  
[5]  Chih-Hong Lin, Po-Hwa Chiang and Chi-Shin Tseng, “Hybrid Recurrent Fuzzy Neural Network Control 
for Permanent Magnet Synchronous Motor Applied in Electric Scooter,” in Proceedings IEEE 4th 
Conference on Industrial Electronics and Applications (ICIEA’10), June 17-20, Taichung, Taiwan, R.O.C. 
2010. (EI)  
本發表與本計畫相關之國內性研討會論文如下: 
[6]  Chih-Hong Lin, and Yu-Hong Hwang, “Hybrid RFNN control of a PMSM drive system in electric 
motorcycle,” in 8th Taiwan Power Electronic Conference, paper no. 57, 2009. 
[7]  Chih-Hong Lin, Po-Hwa Chiang  Chi-Shin Tseng and Chih-Peng Lin, “The estimated technology of 
PMSM rotor speed with sliding-mode observer,” in 30th Symposium on Electrical Power Engineering, 
paper no. 1145, 2009. 
 
 
 
 
 76
間橋部下方之漏磁磁阻。假設鐵心無飽和現象發生，則可忽略 sR 和 rR 。故圖 5-2 可簡化為圖 5-3，再簡
化成圖 5-4。由圖 5-4 氣隙磁通 gφ 與磁石的剩磁通 rφ 關係如下： 
rg φληβφ )421(1
1
+++=                       (5-1) 
其中 mog RR /=β 是磁阻比，而 
ml
mo
R
R=η      
mm
mo
R
R=λ                          (5-2) 
4Rmo
ψ r /2 Rmm 4Rg
ψm /2
ψ l /2
ψ g /2
             
4Rm
ψr /2 4Rg
ψg /2
 
      圖 5-3 化簡圖 5-2 磁路模型                     圖 5-4 化簡圖 5-3 磁路模型 
 
    式(5-1)表示磁石之剩磁因磁阻比和漏磁比而減少成氣隙磁通。平均氣隙磁通密度 gB 為： 
   rg B
C
B
)421(1 ληβ
φ
+++=                           (5-3) 
其中 rB 是剩磁，  Ag 及 Am 分別是每極氣隙和磁石的截面積。Cφ=Am/Ag 是磁通集中因數 (Flux 
concentration factor)。磁石的磁通密度 mB 為: 
rm BB )421(1
)42(1
ληβ
ληβ
+++
++=                           (5-4) 
 從磁石的去磁曲線方程式可以決定磁石的操作點(Bm，Hm) 
rmorecm BHB += μμ                    (5-5) 
其中 μrec是磁石的回歸磁導。由上面的方程式決定磁導係數(Permeance coefficient, PC)的值如下: 
 )
R
1
R
1
R
1(R  )421(
mlg
mo
mm
recrecPC ++=++= μληβμ
               (5-6) 
 由馬達結構可以計算以下參數： 
go
c
g A
gkR μ=                (5-7) 
mreco
m
mo A
R μμ
A=                       (5-8) 
其中 prAg /1 πα A= 、 Amm wA = ，wm磁石的寬度，p 為對極數 r1 是定子內徑，α是極弧寬與磁極距之比，
A是積厚。使用圓弧和直線的磁導模型，橋部的磁阻可寫成: 
]4/)(1ln[
1
21 dhh
R
o
ml ++×= πμ
π
A                      (5-9) 
因此 
]
4
)(1ln[ 21
d
hh
wmrec
m ++= ππμη
A                   (5-10) 
φ
μβ cgk
R
R
m
crec
mo
g
A==                  (5-11) 
其中 kc 是卡特係數(Carter coefficient)。 
    由磁石在氣隙產生之磁通密度 Bg 可得其基波成份之大小為: 
rgM B
C
kBkB
)41(1111 λβ
φ
++==                  (5-12) 
其中 
 78
                   ⎟⎠
⎞⎜⎝
⎛=
2
sin βpK                               (5-24) 
β為線圈跨距(°E)。 
所以為了提高反電勢，線圈跨距應儘可能選擇接近 180 度電機角度。但有時為了抑制反電勢及磁交
鏈中的部份諧波含量，則可選擇短節距繞組(short pitched coil) ，第 n 階諧波的節距因數 Kpn 可寫成為 
                   ⎟⎠
⎞⎜⎝
⎛=
2
sin βnK pn                              (5-25) 
當 nβ = Kπ，K = 0、1、2、3…時，Kpn=0，即可使反電勢中某一階諧波為零，例如可採用 2/3 線圈跨距
(120°E)來消除第三次諧波，採用 4/5 線圈跨距(144°E)來消除第五次諧波，另外選用短節距繞組，可使
線圈的末端繞組(end winding)長度減少，可降低電機之銅損。所以電機繞組之線圈跨距很少選擇超過
180°E，避免末端繞組長度增加，造成銅線用量增加，且使電機因銅損增加，而效率降低。 
    當電機的極數 Np 與槽數 Ns 選定後，則每一個槽所跨的電機角度 θs就已確定，θs可以表示為 
                 
s
p
s N
EN D180×=θ                             (5-26) 
亦即線圈跨距必然是 θs的整數倍，任意選擇線圈跨距的電機角度，在實際繞線時並無法實現，所以線
圈跨距採用槽數 S*來描述較恰當，可以避免所設計的繞組無法實際繞製的情況，線圈跨距 S*通常以下
式來選擇 
                ⎥⎦
⎤⎢⎣
⎡
⎟⎟⎠
⎞
⎜⎜⎝
⎛=∗ 1,180maxS
s
fix θ                           (5-27) 
其 θs 是每槽所跨的電機角度， fix(.)是取整數部分，max［x，y］是取兩數之最大值，如果欲採用短節
距之繞組，則可選擇(S*-1)槽作為線圈之跨距槽數。 
如前所述，三相馬達中的每一相線圈的反電勢大小及波形必須相同，但是其相位必須相差 120 度
電機角度，亦即當 A 相線圈設計完成後，順著電機旋轉方向，偏移 120 度電機角度，即是 B 相線圈所
應放置位置，所偏移的 120 度電機角度稱之為相位偏移(phase offset) K0，相位偏移 K0 通常是以槽數來
表示 
                 
s
qK θ
DD 360120
0
×+= ，q = 0、1、2、3…,((Np/2)-1)            (5-28) 
    繞組設計時，若每槽放置兩個線圈邊，則稱之為雙層式繞組，若每槽只放置一個線圈邊，則稱之
為單層式繞組。採用雙層式繞組，每槽放置了兩個線圈邊，若無空槽，則馬達線圈數目恰等於槽數，
由於線圈必須平均分配於三相繞組之中，所以線圈數目自然必須為 3 的倍數，亦即平衡繞組之三相電
機的槽數必須是 3 的倍數，亦即是 3 槽、6 槽、9 槽…等。但若採用單層式繞組，由於每槽只放置一個
線圈邊，換言之，每個線圈均佔用了兩個槽，由於線圈數目仍必須是 3 的倍數(三相)，而槽的數目又必
須是線圈數目的兩倍，因此，若平衡繞組之三相馬達欲採用單層式繞組，則定子槽的數目必須是 6 的
倍數，亦即是 6 槽、12 槽、18 槽…等。 
在討論繞組設計之前先定義電機每極每相之槽數 Nspp，定義如下： 
mN
NN
m
s
spp ×=                          (5-29) 
上式中 Ns 為定子槽數目，Nm為磁極數，m 為相數。當 Nspp 為整數時，稱之為整數槽馬達，當 Nspp 為分
數時稱之為分數槽馬達。 
    本子計畫介紹的繞組設計方式有別於傳統繞組設計方式，改以線圈為設計元件取代以線圈邊為設
 80
      
圖 5-5 馬達的雛型結構圖          圖 5-6 馬達變數結構圖 
 
表 5-1 初始結構設計參數 
馬達積厚(mm) 80 極數 4 磁石寬度(mm) 4 矽鋼片材料 50CS600
定子直徑(mm) 82 槽數 9 磁橋(mm) 1.0 繞線方式 集中繞
轉子直徑(mm) 50 轉速(rpm) 3600 磁距(mm) 1.0 匝數 21 
氣隙(mm) 0.5 NeFeB 磁石 N-38 槽開口(mm) 3 驅動電壓(V) 110 
 
表 5-2 各參數之階數 
 Ai (lbri) Bi (lnar) Ci (lmag) Di (lso)
1 0.5 mm 0.5 mm 4.5 mm 2 mm 
2 1 mm 1 mm 5 mm 3 mm 
3 1.5 mm 1.5 mm 5.5 mm 4 mm 
 
表 5-3 效率、凸極比模擬結果 
L9 Eff (%) Lq/Ld L9 Eff (%) Lq/Ld 
1 93.284 2.308 6 93.117 1.59 
2 93.324 2.339 7 93.248 1.261 
3 93.392 2.255 8 93.108 1.203 
4 93.446 1.49 9 92.854 1.307 
5 93.188 1.652    
    變異性分析主要用來評估各參數對最佳化目標的影響程度，在變異性分析是使用平方和的觀念，
計算公式如下： 
( )23
1
3∑
=
=
i
all AAA -mmSSF i             (5-35) 
    在此針對效率與凸極比做變異性分析結果如表 4，可發現 A 與 D 參數對效率有很大的影響；而 A
參數對凸極比具有決定性的影響。 
 
 
 
 
 
 
 
 
 82
 
圖 5-8 dq 軸電感變化圖 
 
    從分析中可發現磁橋的寬度設計是最重要的一環，其對於效率與凸極比都有很大的影響，縮短磁
橋寬度有助於提升凸極比並且減少漏磁，能夠有效提升馬達輸出轉矩與效率，但是同時間又必須考量
馬達的機械結構強度問題，所以必須視馬達轉速與整體結構進行磁橋寬度的調整與權衡，圖 5-9 為馬
達實際製作完成之照片。 
 
圖 5-9 定子鐵芯及繞線完成圖 
B. 內藏型永磁同步電動機程式設計 
    在此將馬達基本尺寸分為數個不同之參數如圖 5-10 所示，Wtb 為齒寬，Wb 為靴部寬，Wbi 為軛鐵
寬，Wsi為槽寬，Wsd 為底寬，Wso 為槽開口，Ts為槽距，hri為轉子軛鐵寬，lm為磁石長度，Din為定子
內徑，Dout 為定子外徑，Dro 為轉子外徑，Dshaft 為軸內徑。根據在前節所述之公式以及經驗公式，由
VB 程式計算出這些參數值，再將此馬達之結構圖繪出。 
    首先在程式輸入方面有馬達功率、電壓、極數、槽數、轉速、積厚，以及最大剩磁(Br)，而鐵心通
常飽和磁通密度介於 1.5~1.7 Tesla 左右，在此假設為 1.5 Tesla，根據上述之公式，依序將馬達基本尺寸
算出來。 
 
圖 5-10 馬達基本尺寸圖 
 
    此為內藏型永磁同步電動機設計程式，可直接由程式所計算出之尺寸來繪圖，也可重新輸入參數
來繪製馬達圖形，而其程式主畫面如圖 5-11 所示。在程式的第一頁為初始設計。左上方輸入所須計算
之參數，在右下方點選按鈕 “計算”，此時便可得到結果。並且在第二頁“繪圖結果＂顯示圖形，點選
按鈕 “列印”，就可以列印視窗內的圖形。  
 84
C. 分數槽繞組程式設計 
    根據以上的推導與步驟，利用 VB 撰寫程式可快速將繞線計算出來。在程式中利用許多馬達的繞
線條件，其條件為馬達為三相平衡繞組、槽數與極數分別為 3 與 2 的倍數、及 K0 必須存在且為整數。
說明如下： 
(1) 首先輸入資料為槽數(Ns)、極數(Nm)。 
(2) 判斷此槽數與極數組合是否符合繞線條件。 
(3) 尋找所有可行之繞線組合。 
(4) 選擇一種繞線組合。 
(5) 產生 A、B、C 三相繞線表。 
(6) 連結至 FEA 軟體且計算馬達特性。 
    在輸入參數區塊中輸入槽數(Ns)、極數(Nm)與相數，然後勾選單層繞或雙層繞之選項，此時會判斷
輸入的槽極數是否合理，如圖 5-14 所示。 
 
圖 5-14 開啟程式之主畫面 
 
若槽極數為合理，可選擇計算馬達參數或是直接線圈角度與繞組結果，選擇計算馬達參數，必須在“輸
入參數”中間區塊，輸入馬達槽寬、匝數、槽面積、線徑、並聯路徑數等參數，如圖 5-15 所示。 
 
圖 5-15 主畫面之馬達參數 
點選左上方的“線圈角度計算表”，並按照以下順序點選運算、排列與繞線，可得繞線結果如圖 5-16 所
示；程式會計算出輸入參數中之參數、馬達繞線角度表與繞線因數。點選左上方的“繞組結果”，選定
繞組後，會再右下方分別產生 A、B、C 三相的繞線表，如圖 5-17 所示。 
 
 86
Power Engineering, pp. 693-697, Tainan, Taiwan, December 5-6, 2008, 
3. Chang-Chou Hwang, Chi-Wei Chiang, and Cien-Ting Cho, “Design Considerations for Three Barrier 
Configurations in Interior Permanent Magnet Machines, “Proceedings of the 30th Symposium on Electrical 
Power Engineering, N004, Taoyuan, Taiwan, Nov. 27-28, 2009. 
4. Chang-Chou Hwang, Ming-Hung Jian, and Jia-Ming Chang, “Cogging Torque Reduction and 
Demagnetization Assessment of an IPMSM, “Proceedings of the 30th Symposium on Electrical Power 
Engineering, N003, Taoyuan, Taiwan, Nov. 27-28, 2009. 
 
國際研討會論文(5篇) 
1. Chang-Chou Hwang, Shih-Ping Cheng, and Cheng-Tsung Liu, “A System for Interactive Design of the 
Winding Layout in PM Machines, “Proceedings of the International Magnetics Conference(Intermag 2009), 
pp. 1154, Sacramento, CA, USA, May 4-8, 2009. 
2. Chang-Chou Hwang, Hsing-Cheng Chang , and Cheng-Tsung Liu, “Design comparison of fractional-slot 
IPM machine types for an electric power steering application, “Proceedings of the 6th 
Japanese-Mediterranean Workshop on Applied Electromagnetic for Magnetic, Superconducting and 
Nano-Materials (Japmed’9), pp.183-184, Bucharest, Romania, July 27-29, 2009. 
3. Chang-Chou Hwang, Cheng-Tsung Liu, and Hsing-Cheng Chang, “An interactive design of the winding 
layout in PM machines, “Proceedings of the 6th Japanese-Mediterranean Workshop on Applied 
Electromagnetic for Magnetic, Superconducting and Nano-Materials (Japmed’9), pp.185-186, Bucharest, 
Romania, July 27-29, 2009. 
4. Chang-Chou Hwang, Chia-Ming Chang, and Ping-Lun Li, “Design Optimization for Cogging Torque 
Minimization and Efficiency Maximization of a High-speed PM Motor, “Proceedings of the Eighth 
International Conference on Power Electronics and Drive Systems (PEDS09), Taipei, Taiwan, R.O.C, Nov. 
2-5, 2009. 
5. Chang-Chou Hwang, Chia-Ming Chang, Cheng-Tsung Liu, and Ji-Wei, Jiang, “Design Optimization for 
Cogging Torque Minimization and Average Torque Maximization in an IPM Motor, “Proceedings of 11th 
MMM-INTERMAG Conference, pp. 119, Washington, DC, USA, Jan. 18-22, 2010. 
 
 人才培育 
1. 張志清與何明特同學執行第一期計畫，分別以「搭配有限元素分析進行田口法最佳化設計」及「分
數槽永磁同步馬達之設計考量」為論文完成碩士學位。張志清同學為在職專班，目前繼續矽品精密
工業公司服務。何明特同學目前在東元電機服替代役，從事馬達設計與分析等相關工作。 
2. 簡銘宏同學執行第二期計畫，目前正撰寫碩士學位論文中，論文內容是將第一年研發的內藏應用於
工具機主軸馬達上。 
3. 李秉倫同學執行第二期計畫，目前正在逢甲大學電通所博士班進修中。 
 
可供推廣之研發成果 
 第一期計畫中所提出的內藏型永磁同步馬達可用在汽車之動力方向盤，及工具機主軸馬達等產業之產品
上。第二期計畫之設計程式對馬達設計等相關研發有相當的幫助。 
 
 
