 
 
 
 
1
行政院國家科學委員會專題研究計畫成果報告 
具空間週期不確定性旋轉運動系統之空間領域控制法則開發與實
驗驗證 (I) 
Research and development of spatial-based controls for spatially periodic 
uncertain rotary motion systems with application (I) 
 
計畫編號：NSC 97-2221-E-005-060 
執行期限：97 年 08 月 01 日至 98 年 07 月 31 日 
主持人：陳正倫  國立中興大學電機工程學系(所) 
計畫參與人員: 邱正育 李昌霖 翁宏志 國立中興大學電機工程學系 
 
中文摘要—旋轉運動控制系統已經被廣泛用於
包裝、列印、組裝、製造、半導體等工業。雖
然相關硬體技術已趨成熟，但其市場仍然持續
與穩健成長，而學術領域相關之研究仍持續蓬
勃發展。鑑於旋轉運動系統所具備之非線性與
不確定性通常會隨角位置呈週期性變化，本計
畫之目的即在研究如何充分利用此特性直接在
角位置領域發展相關控制法則。基本假設為設
計者對系統之模式架構不完全了解，換言之實
際系統之參數與階數存在某種程度之不確定
性。我們將考慮系統之參數未知但為有界常數
或隨角位置周期變化，另外也考慮系統受到隨
角位置周期變化與非週期性但有界之外來干擾
影響。欲控制之旋轉運動系統可運作於不同轉
速，即其轉速可以做步階式切換或更複雜之情
況為可任意變化。系統之輸出 (位置、轉速等) 
則必須追蹤一預先設計好之參考命令。本研究
希望發展適用於一般系統之控制法則設計架
構，控制法則將在角位置領域進行設計、分析
與穩定性證明。所發展之設計架構將兼具重複/
遞迴學習控制、線性強健控制與一般非線性控
制之優點，即能對抗模式不準、參數未知與外
來干擾，並可在系統穩定/效能與不確定性間作
彈性調整，且使用最佳化演算法協助估測參數
之更新。透過引入不確定性隨角位置週期變化
之資訊至控制法則設計，我們預期所發展之控
制系統相較使用傳統設計方法之系統將具備更
多功能與較佳效能。所發展之演算法則除了理
論上之推導、分析與證明收斂與穩定特性外，
將使用數值模擬確認其可行性，並也將建立一
旋轉運動系統平台進行實驗驗證。 
 
Abstract—Rotary motion control systems have been widely 
used in the packaging, printing, assembly, manufacturing, and 
semiconductor industries. Although hardware technology is 
maturing, the market for motion control is still increasing. The 
nonlinearity and uncertainty affecting rotary motion systems 
are often spatially periodic. This project will study how to 
utilize this characteristic and develop control algorithms in the 
angular displacement domain. A fundamental assumption is 
that the designer does not fully understand the structure of the 
system. In other words, the order and parameters of the actual 
system have certain degree of uncertainty. We will consider the 
scenario that the system has unknown but bounded constant 
parameters or parameters which vary spatially periodically. 
We will also consider the system is affected by both spatially 
periodic and non-periodic disturbances. The system to be 
controlled will operate at varying speeds. That is, its speed can 
conducting step change or can vary at will in the more 
complicated case. The output of the system has to track a 
pre-specified reference command. We plan to develop design 
frameworks which are applicable to generic rotary motion 
systems. Synthesis of the control algorithm, analysis and 
stability proof of the overall system will be performed in the 
angular displacement domain. The proposed design framework 
will possess the advantages of repetitive/iterative learning 
control, linear robust control and nonlinear control. It will be 
able to cope with modeling uncertainty, parametric uncertainty, 
and disturbances and is capable of doing tradeoff between 
system performance/stability and robustness. Optimization 
algorithm is incorporated to help with parametric update. We 
expect that the proposed design will have better functions and 
performance than traditional design. Besides theoretical 
 
 
3 
 
unstructured/bounded modeling uncertainties, actuator 
saturation and spatially periodic disturbances. The proposed 
approach, however, still devoted to linear time-invariant 
systems and could lead to conservative design if the number 
of varying parameters increases, the varying parameter space 
is nonconvex, or the size of the modeling uncertainties 
becomes significant. 
In this paper, we propose a new design of 
spatial-based repetitive control for rotary motion systems 
subject to position-dependent disturbances. The system is 
allowed to operate at varying speed and the open-loop 
nonlinear time-invariant (NTI) plant model identified for 
controller design is assumed to have both unknown 
parameters and unmodeled dynamics. We reformulate the 
open-loop NTI plant model with respect to angular 
displacement, similar to the transformation stated in [7], and 
arrive at a nonlinear position-invariant (NPI) model. To 
attain robust stabilization and high-performance tracking, we 
propose a two-degree-of-freedom control configuration for 
the reformulated NPI model. Namely, the controller is 
separated into two modules, one focusing on robustly 
stabilizing the system and the other on improving the 
tracking performance. For one control module, we utilize 
adaptive feedback linearization with projected parametric 
adaptation [11-13] to stabilize the system and take into 
account structured (or parametric) uncertainty. Here adaptive 
control plays a role to adapt the estimated parameters of the 
system, which differs from those in previous literature (e.g., 
[5, 6]) where adaptive control was used to adapt the period 
of the repetitive controller. For the other control module, a 
spatial-based low-order and attenuated repetitive controller 
(aiming at periodic disturbances) cascaded with a 
loop-shaping filter (aiming at non-periodic disturbances) is 
augmented with the adaptively controlled system. The 
overall adaptive feedback linearization repetitive control 
(AFLRC) system is thus robust to model uncertainties and 
capable of rejecting spatially periodic and non-periodic 
disturbances under variable speeds. The proposed AFLRC 
system can be proved to be stable under bounded 
disturbance and system uncertainties. A typical brushless dc 
motor of second-order is used as a design example for 
demonstration and derivation of the control algorithm. 
Simulation is performed to verify the feasibility and 
effectiveness of the proposed scheme. 
This paper is organized as follows. Reformulation of a 
generic nth-order NTI rotary motion system with respect to 
angular displacement will be presented in Section 2. Section 
3 will cover derivation and stability analysis of the proposed 
AFLRC scheme. Simulation verification for the proposed 
scheme will be presented in Section 4. Conclusion and 
discussion are given in Section 5. 
 
II. PROBLEM STATMENT 
In this section, we show how a generic NTI model can 
be transformed into an NPI model by choosing an alternate 
independent variable (angular displacement instead of time) 
and defining a new set of states (or coordinates) with respect 
to the angular displacement. Note that the transformation 
described here is equivalent to a nonlinear coordinate 
transformation or a diffeomorphism. The NPI model will be 
used for the subsequent design and discussion. 
Consider the mathematical model of a single-input 
single-output (SISO) nth-order NTI system with model 
uncertainties, and subject to output disturbance, i.e., 
 
       
       
       
, ,
, ,
t f t f
t g t g
n y
x t f x t f x t
g x t g x t u t
y x t d t x t d t
 
 
    
    
    

 (1) 
where      1 Tnx t x t x t    ,  0 0 1   , 
 u t  and  y t  correspond to control input and measured 
output angular velocity of the system, respectively. ( )yd t  
represents a class of  position-dependent disturbances 
which constitutes bounded spatially periodic and 
non-periodic components. Here we refer non-periodic 
disturbances to signals whose Fourier transform or power 
spectral density is zero above a certain finite frequency. The 
only available information of the disturbances is the number 
of distinctive spatial frequencies and the spectrum 
distribution for non-periodic disturbance components. 
  ,t ff x t   and   ,t gg x t   are known vector-valued 
functions with unknown but bounded system parameters, i.e., 
1f f fk       and 1g g gl      ; 
  ,t ff x t   and   ,t gg x t   represent unstructured 
modeling inaccuracy, which are also assumed to be bounded. 
Instead of using time t  as the independent variable, 
consider an alternate independent variable ( )t  , i.e., the 
angular displacement. Since by definition 
 
0
( ) ( ) (0),
t
t d       
where ( )t  is the angular velocity, the following condition 
 ( ) 0,   t >0dt
dt
     (2) 
will guarantee that ( )t  is strictly monotonic such that 
1( )t    exists. Thus all the variables in the time domain 
can be transformed into their counterparts in the  -domain, 
i.e. 
 
1 1
1 1
1
ˆ ˆ( ) ( ( )),  ( ) ( ( )),
ˆˆ( ) ( ( )),  ( ) ( ( )),
ˆ ( ) ( ( )),
x x y y
u u d d
     
     
    
 
 

 
 

 
where we denote ˆ  as the  -domain representation of  . 
Note that, in practice, (2) can usually be satisfied for most 
rotational motion system where the rotary component rotates 
only in one direction. Since 
 
 
5 
 
 
1
1
1
2 1 2ˆ ˆ( )
1
1 1 ˆ ˆ( )
1
ˆ ˆ( )
1
ˆˆˆ ˆ ˆ( ) ( , )
ˆˆ ˆ ( )
ˆ( ) ˆˆ
ˆ( )
ˆˆ ˆ
f sox T z
r
c c g f x T z
r
f
sir
g f x T z
c y
z L x d z z
z A z B L L h x
L h x
u d
L L h x
y C z d
 







  
     
     
 
 

 (5) 
where ˆsod  and 1 si
ˆ ˆ ˆ
r
T
si sid d d     come from ˆsd  
going through the indicated coordinate transformation. 
1ˆ
rz  , 2ˆ n rz  , and ( , , )c c cA B C  is a canonical form 
representation of a chain of r  integrators. The first 
equation of (5) describes the internal dynamics which is not 
affected by the control uˆ . By setting 1ˆ 0z   in that 
equation, we obtain 
 2 2ˆ ˆ(0, )z z  , (6) 
which is the zero dynamics of (4) or (5). The system is 
called minimum-phase if (6) has an asymptotically stable 
equilibrium point in the domain of interest. To allow us to 
present the proposed algorithm and stability analysis in a 
simpler context, we will make the following assumptions for 
the subsequent derivation: 
1) Measurements of all the states of (4) are available in 
real-time; 
2)   ˆ , ff x    and   ˆ , gg x    are linearly related to 
those unknown system parameters, i.e., 
 
        
        
1 1
1 1
ˆ ˆ ˆ, ... ,
ˆ ˆ ˆ, ... ;
f f fk k
g g gl l
f x f x f x
g x g x g x
     
     
  
    (7) 
3)    
1 2 1
1 2ˆ ˆ ˆ, , ,
r
r r
si si sid d d 
    exist, i.e., the transformed 
unstructured uncertainty is sufficiently smooth. 
4) (4) is exponentially minimum-phase, i.e., the zero 
dynamics (6) is exponentially stable. 
5)    1ˆ ˆ ˆ, , ,r ry y yd d d
   exist, i.e., the output disturbance is 
sufficiently smooth. 
Suppose that (4) has relative degree r . To perform 
input/output feedback linearization, either differentiate the 
output yˆ  until the control input uˆ  appears in the equation 
or refer to (5) and use the special structure of ( , , )c c cA B C  
to obtain 
    
1 1
1( ) 1 ˆ ˆ ˆ ˆˆ ˆ
r r
r rr r r
f g f si si si yy L h L L hu d d d d
       . (8) 
Thus, the input may be specified as 
  11ˆ ˆrf dr
g f
u L h v
L L h
   , 
where ˆdv  is a designable input to cancel the nonlinear 
terms and linearize the input/output relationship of (4). 
Feedback linearization is based on exact cancellation of the 
nonlinear terms in the system. In practical situation, if there 
is any uncertainty in the system parameters, the cancellation 
will not be exact and the resulting system will not be linear. 
However, parametric adaptive control can be used to 
compensate for this disadvantage. For adaptively adjusting 
the parameters of (4) online, rewrite the two nonlinear 
functions with uncertain parameters as shown in (7). Define 
the corresponding estimates of the two functions 
 1 1 2 2
1 1 2 2
ˆ( , ) ,
ˆ( , ) ,
f f f fk k
g g g gl l
f x f f f
g x g g g
   
   
   
   
    
    
 
where fi ’s or gi ’s are estimates of fi ’s or gi ’s. 
Furthermore, define the estimations of 1rfL h
  and  1rf gL L h
  
as follows 
 


1 1
1 1
,
,
r r
f f
r r
f g gf
L h L h
L L h L L h
 
 

 


 
where we denote   the estimate of  . The control law 
using the estimated parameters is 
 
 1 ˆ11ˆ ˆ ˆ ,rf d Rr
f g
u L h v u
L L h

     (9) 
where we introduce another designable input ˆˆRu . Specify 
ˆdv , the estimate of ˆdv , as 
( ) ( 1) ( 1)
1 1ˆ ˆ ˆ ˆ ˆ ˆ ˆ ˆ( ) ( ) ( ),
r r r
d m m r m r mv y y y y y y y              
 (10) 
where ˆmy  is a pre-specified reference trajectory and 
( )ˆ , 1, , 1k kfy L h k r     denotes the estimate of ( )ˆ ky  and 
i ’s are adjustable parameters. Substituting (9) back into (8) 
and defining the tracking error ˆ ˆ ˆme y y , we arrive at the 
following error equation 
 
 
   
1
1
1( ) ( 1)
ˆ1 1
1
si si 1 1
ˆˆ ˆ ˆ ˆ ˆ
ˆ ˆ ˆ ˆ ˆ ,
r r
rr r T
r r siR
r r
y y r y
e e e e W u d
d d d d d
  
 




        
     
 
 
 
 (11) 
where 
 1 1
1 1
,
,
T
f fk g gl
T
f fk g gl
   
   
  
    
    

  
      
, 
and W  is a function of xˆ  and  . Note that   is the 
‘true’ parameter vector while   is the estimated parameter 
vector. If we denote 11( ) 1 ( )
r r
rM s s s        , (11) 
implies that 
 
 
1
1
1
ˆ
1
1 1
1 ˆˆ ˆ( ) ( )
( )
ˆ ˆ ˆ .
r r
T r
siR
r r
si si r y
E s W U s s d
M s
sd d s s s d 



    
     
   
   
 (12) 
Neglecting the details of TW , we can view (11) or (12) as 
a linear system (with the output eˆ ) subject to four types of 
 
 
7 
 
We say that ˆ pu L  if ˆ pLu  exists or ˆ pLu   . If 
uˆ L , we can simply say that uˆ  is bounded. 
Definition 3.3 (Truncated function) 
Consider a vector-valued function ˆ : nu    . The 
truncated function is defined as 
 
ˆ( ),  
ˆ ( )
0,  T
u T
u
T
  
   for ,T
 . 
Definition 3.4 (Extended pL  space and truncated norm) 
The extended pL  space is defined by 
 ˆ ˆ: ( )  npe T pL u u L T        , and 
ˆ ˆsup ( )T L
T
u u


 
 . 
Definition 3.5 (Regular signals) 
Let ˆ : nu     such that ˆ ˆ,  eu u L . uˆ  is regular if 
1 22
ˆ ˆ( ) TLu k u k    for some 1 2, 0k k   and all 0  . 
Symbols 
‧ : n     and 2L L    and 0   as 
   . 
‧ : n     and 2L L   . 
‧ K is a (large) constant bound. 
‧
TL
z

 will denote T Lz  . 
‧
2 or TL TL
z z 
 
   will denote 
1 22 or TL TL
z z 
 
  , where  , 1  and 2  are 
same type of constants or pL functions. 
‧ A  will denote the induced norm of a matrix A . 
‧  max A  will denote the maximum eigenvalue of a 
square matrix A . 
Theorem 3.1 The error equation (19) with the parametric 
update law (20) leads to L , 2L L   and 
2
( ) (1 )T
TL
   

    for all  . 
Proof:  
If 
01
ˆˆ Me d , the proof is trivial since 0  . In the 
following, we will assume that 
01
ˆˆ Me d . 
Step 1 Show that only 0w  needs to be considered 
Denote by perp  the component of   perpendicular to 
the tangent plane at   so that ( )R perpP        . Since 
w  and w is convex, we have   0T perp    . 
Choose Lyapunov function ( ) TV      and use the 
parametric update law as defined in (20). When 0w , we 
have TV     . When w , we have 
 
( ) ( )T TR perp
T T T
perp
V P     
      
     
     , 
where we use the fact that 
 ( ) ( ) 0T T Tperp perp perp                . 
Thus, we only have to consider the scenario corresponding 
to 0w  in the sequel. 
Step 2 Show that L  
Consider a Lyapunov function ( ) (1 2) TV     , we have 
 
1 11 1
( )
ˆˆ ˆ( )ˆ ˆ
.
1 1 1
T
T
T M
T T T
V
e d ee e    
     
   
        
 
 
Since 
01
ˆ ˆˆ M Me d d  , either 1ˆ 0e   implying that 
1 1
ˆˆ ˆMe d e    or  1ˆ 0e   implying that 1 1ˆˆ ˆMe d e   . For 
both cases, we can establish that 1 1ˆˆ ˆ( ) 0Me d e  . Therefore, 
( ) 0V    and we conclude that  is bounded, i.e., 
L .  
Step 3 Show that L  
Note that 
1
ˆ ˆ( )ˆ
1 1 1 1
T T
M M
T T T T
d de              
           
 . 
Thus we have 
 
022
2
ˆ
1 1
T
MT T d
           . 
Using the fact that 
       max1 1 1 1T T T T T T                 
,  
22
1 1T T        , and L , we conclude 
that L . 
Step 4 Show that 2L  
Note that 
2 2 2
2 2
22
ˆ ˆ( ) ( )
(1 ) 1 1
T T TT
T M M
T T T
d d          
          
  
. 
Define  
01
ˆˆ| Me d   . From 0V   which implies 
that ( )V   is finite, we have 
0
0
ˆ( )
( ) ( ) ( )
1
T T
M
T
d
V V V d d
      


          .
 (21) 
 
 
9 
 
 2ˆ TL TLz K W K   . (31) 
Since xˆ  can be related to 1ˆz  and 2zˆ  through a 
diffeomorphism, i.e., ˆˆ ( )z T x , we see that 
 
ˆ
ˆ
TL TL
TLTL
x W
x W
 

  
    (32) 
Next, note that W  is a function of xˆ  and   and 
ˆ
ˆ
W dx W dW
x d d 
    
  . Since ˆW x   and W   
are bounded by assumption, L  implies that d d  
is bounded,  using (32) we arrive at  
 
TLTL
W W

   . (33) 
Thus W  is regular and ( )M s W   is regular as well 
according to Lemma A.4. 
Note that 
 ( )T T Td W W W
d      . (34)  
Using (33) and , L   are bounded, we obtain 
 ( )T
TL
TL
d W W
d 
    . (35) 
Go back to (29) and follows the same steps from (30) to (32), 
we arrive at 
 ˆ T
TL TL
x W
 
    , (36) 
which, along with the fact that ˆˆ( , )W W x  and ˆ  is 
bounded (because L ), implies that 
 T
TL TL
W W
 
    . (37) 
Combining (35) and (37) yields 
 ( )T T
TL
TL
d W W
d 
     , 
which establishes the regularity of TW . 
Step 5 Show bounds on eˆ , W , and xˆ  
From Theorem 3.1, we have 
2
(1 )T TL       which 
implies that   22 1T TL L L       . From the 
regularity of   and TW , one can establish that 
(1 )T
TL
 

   has bounded derivative. Thus by Lemma 
A.5, we have 
2
(1 )T
TL
  

    which implies that 
 
02
ˆ ˆ(1 )T M MTLd d        . (38) 
From definition of augmented error, i.e., 
1ˆ ˆ
T Te e MW M W    , we obtain 
12 2 2
ˆ ˆ T Te e MW M W     . Using (28), we have 
12 2
ˆ ˆ
TL
e e W 

   . Using (37), we have 
 12 2ˆ ˆ
T
TL
e e W 

    . (39) 
Apply Lemma A.1 to (17) along with the established 
regularity of TW , we obtain 
 ˆT
TLTL
W e

    . (40) 
Substituting (40) into (39) yields 12 2ˆ ˆ ˆ TLe e e     
which becomes 
 
02
ˆˆ ˆ MTL TLe e d        . (41) 
after using (19) in (38). Since ( )M s W    and ( )M s  is a 
stable filter, we have 
 
TL TL
W
 
   . (42) 
Using (41), and substituting (40) into (37) which gives  
 ˆ
TL TL
W e
 
   , (43) 
we have 
 
02
ˆˆ ˆ MTLe e d    . (44) 
Since 0   as    , we conclude that 
02
ˆˆ Me d  
as   . This in turn implies the boundedness of W  and 
xˆ , i.e., from (43) and (32).
Remark 3.1 The control law given by (9) is valid 
under the condition that  1 ˆ 0rg fL L h x  . Therefore, it 
is imperative to preserve this condition when implementing 
the proposed control system design. Recall that 
 
   1
1 1 1 1
ˆ ˆ
... ...
r T
g f
f f fk fk g g gl gl
L L h x W x
w w w w   
  
         
, (45) 
where fi ’s and gi ’s are the estimated system parameters. 
Thus, (45) implies that we may maintain the condition of 
 1 ˆ 0rg fL L h x   by restricting fi ’s and gi ’s in (45). This 
can be achieved by properly setting up the parametric 
variation set w  in the projected parametric update law (20). 
For low-order systems (e.g., the design example given in 
Section 4), it is usually not difficult to identify a feasible 
variation set for the estimated parameters. Alternative 
solutions which modify the control law to address the issue 
of singularity can be found in [17-20]. In the following, we 
use an example to explicitly address this issue. Consider a 
2nd order nonlinear system in   domain and has been 
transformed into the normal form as 
 
1 2
2
02 2 2
2 0 1 0 1 1
1 1 1 1
1
ˆ ˆ ,
ˆ ˆ ˆ ˆˆ ˆ ,
ˆ ˆ ˆ ˆ
ˆ ˆ .
z z
bz z zz a a a z a u
z z z z
y z

       


  (46) 
The linearizing control law for (46) may be specified as 
 
 
11 
 
where  1 2( ) ( ) ( ) Tx t x t x t , and 1 2( ) ( ) ( )s si sid t d t d t    . 
Reformulating this system with respect to , i.e., the angular 
displacement, we obtain 
 
ˆˆ ˆ ˆ ˆ( ) ( ) ,
ˆˆ ˆ( )
s
y
x f x g x u d
y h x d
  
 

 (52) 
where 
 
0
1
1
2
ˆ( ) ˆ
ˆ
a
f x xa
x
       
, 
0
2ˆˆ( )
0
b
xg x
      
, and 2ˆ ˆ( )h x x . 
Since (52) has a relative degree of two, we differentiate the 
output twice and arrive at 
 
1 2
2
si
ˆ ˆ ˆˆ ˆf g f si yy L h L L h u d d d      . (53) 
For adaptively adjusting the parameters of (52) online, we 
rewrite the two functions with uncertain parameters as 
 
0 1 1
2
1 1 2 2 3
20 3 1
0
1 0
ˆ( ) ˆ
0 1
ˆ
,
1
ˆˆ( ) ,
0
f x a a x
x
f f f
xg x b g
 

                   
  
      
 
where 1 0a  , 2 1a  , and 3 0b  . Define the 
corresponding estimates 
 1 1 2 2 3 3
1 1
ˆ( ) ,
ˆ( ) .
f x f f f
g x g
  

  

   
  
Note that the estimates of 0a , 1a , and 0b , i.e., 0a , 1a , 
and 0b , can be determined from 1 , 2 , and 3 , 
respectively. The control law using the estimated parameters 
becomes 

  2 22 02 1 1ˆ ˆ1 2 3
2 2 20
ˆ ˆ ˆ
ˆ ˆ ˆ ˆ ˆ
ˆ ˆ ˆf d dR R
g f
ax x x
u L h v u a v u
x x xbL L h
           
  
1 .
 (54) 
Substituting (54) into(53), we obtain 
 

 
     
1 2
1 2
2 2
ˆ si
2
ˆ
2 2
ˆ si
ˆ ˆ ˆˆ ˆ ˆ
ˆ ˆ
ˆ ˆ ˆˆ ˆ .
f g f f d si yR
g f
f d R
f f g f g f
g f
d si yR
y L h L L h L h v u d d d
L L h
L h v u
L h L h L L h L L h
L L h
v u d d d
       
  
   
    
  

 
1
 (55) 
Using the definition of ˆ ˆ ˆme y y  and ˆdv  in (10) with 
2r  , we can rearrange (55) as 
 
1 2ˆ1 2 si 1
ˆ ˆ ˆ ˆˆ ˆ ˆ ˆT si y yRe e e W u d d d d              , 
where 
 
 
 

1 2 3 1 2 3
2
ˆ
1
12 2
2 2 2
, , ,
ˆ ˆˆ1 1
ˆ ˆ ˆ
TT
T
f d R
g f
L h v uxW
x x x L L h
     

         
         
   
  
In this case, the parametric update law defined by (20) 
becomes 
 0
0
1
1
1
ˆ ˆˆif ,
1
ˆˆ0 if .
R MT
M
eP e d
e d
 
 
           
   (56) 
where 
 
1
3
1 1
3
1
ˆ
0 if 0 and 0,
1
ˆ ˆ
( ) 0 if  and 0,
1 1
ˆ
otherwise.
1
T
R T T
T
e
e eP
e
   
      
 
 
        

  
The adaptation rate   is set to 20. To concentrate on 
studying the effect of the output disturbance, ( )sd t  is set to 
0 so that the system performance is not affected by the 
unstructured uncertainty. The output disturbance ˆyd  is 
assumed to be a periodic rectangular signal (with amplitude 
switching between -0.1 and 0.1) plus some white noise (see 
Figure 3), i.e., 
 
        03 2
0.1 10ˆ ( ) 1 0.5 ,
0.05 1 0.004 1
l
y
l
d l N
s s
 

          
 
where  
 
1 0.5,
( ) 0.5 0.5,
0 otherwise,

 
   
 
and 0N  is white nose with zero mean and variance equal to 
710 . Note that both disturbance components have been 
low-pass filtered in order to satisfy the aforementioned 
smoothness assumption. Parameters of the repetitive 
controller are specified to target the fundamental frequency 
(equal to 1 cycles/rev) and the first three harmonics of the 
periodic disturbance, i.e., 
 
2 24
2 2
1
2ˆ( )
2
i ni ni
i i ni ni
s s
R s
s s
  
  
        , 
where  
 
1 2 3 4
0.2,  0.0002,
2 , 3 2 , 5 2 , 7 2 .
i i
n n n n
 
       
 
        
For this example, a simple lead compensator 
   ˆ ( ) 50000 /5+1 /1000+1 C s s s    is sufficient to stabilize 
the feedback system in Figure 2. Suppose that a motion 
 
 
13 
 
ˆ : ng    . If ˆˆ ,  gg L  and ˆ pg L  for some 
[1, )p  , then ˆ( ) 0g    as    . 
VI. 研究成果自評 
本計畫已完成第一年所規劃之工作大項，即參
數/模式階數不確定與且受週期/非週期性干擾
影響之運動控制系統設計。研究成果除了在國
際研討會[22][23]口頭報告外，已經發表一篇
SCI期刊論文[24]，另外一篇期刊論文即將投
稿。本計畫所規劃之第二年工作項目已獲國科
會肯定通過，目前實驗平台之建立已經完成(設
計圖與實體如Figure 9與Figure 10所示)，而我們也
正著手進行第二年之工作大項，即參數週期性
變化之運動控制系統設計。 
REFERENCES 
1. C.-L. Chen, G. T.-C. Chiu , Jan P. Allebach. Banding 
reduction in EP processes using human contrast 
sensitivity function shaped photoconductor velocity 
control. J. Imaging Science and Technology2003; 47(3): 
209-223. 
2. S. Hara, Y. Yamamoto, T. Omata, M. Nakano. Repetitive 
control system: A new type servo system for periodic 
exogenous signals. IEEE Transactions on Automatic 
Control1988; 33(7): 659-668. 
3. Y. Onuki, H. Ishioka. Compensation for repeatable 
tracking errors in hard drives using discrete-time 
repetitive controllers. IEEE/ASME Transactions on 
Mechatronics2001; 6(2): 132-136. 
4. G. Hillerstrom. Adaptive suppression of vibrations – A 
repetitive control approach. IEEE Transactions on 
Control Systems Technology, vol. 4, no. 1, pp. 72-78, 
January 1996. 
5. T. J. Manayathara, T.-C. Tsao, J. Bentsman, D. Ross. 
Rejection of unknown periodic load disturbances in 
continuous steel casting process using learning repetitive 
control approach. IEEE Transactions on Control Systems 
Technology1996; 4(3): 259-265. 
6. C. C. Wit, L. Praly. Adaptive eccentricity compensation. 
IEEE Transactions on Control Systems Technology2000; 
8(5): 757-766. 
7. M. Nakano, J.-H. She, Y. Mastuo, T. Hino. Elimination of 
position-dependent disturbances in 
constant-speed-rotation control systems. Control 
Engineering Practice1996; 4: 1241-1248. 
8. C.-L. Chen, G. T.-C. Chiu, Jan P. Allebach. Robust 
spatial-sampling controller design for banding reduction 
in electrophotographic process. Journal of Imaging 
Science and Technology2006; 50(6): 530-536. 
9. B. Mahawan, Z.-H. Luo.  Repetitive control of tracking 
systems with time-varying periodic references. 
International Journal of Control2000; 73(1): 1-10. 
10. C.-L. Chen, G. T.-C. Chiu. Spatially periodic disturbance 
rejection with spatially sampled robust repetitive control. 
ASME Journal of Dynamic Systems, Measurement and 
Control 2008; 130(2): 11-21. 
11. S. Sastry, A. Isidori. Adaptive control of linearizable 
systems. IEEE Transactions on Automatic Control1989; 
34(11): 1123-1131. 
12. M. French, E. Rogers. Approximate models for adaptive 
feedback linearization. Int. J. Control2000; 68(5): 
1305-1321. 
13. S. Sastry, M. Bodson. Adaptive Control: Stability, 
Convergence, and Robustness. Prentice Hall: Egnlewood, 
1989. 
14. R. C.-H. Lee, M.-C. Smith. Repetitive control 
experiments for a CD player.  Proc. American Control 
Conference (ACC)1998; 2682-2684. 
15. B. B. Peterson, K. S. Narendra. Bounded error adaptive 
control. IEEE Transactions on Automatic Control1982, 
AC-27(6). 
16. H. K. Khalil. Nonlinear Systems (3rd edition). Prentice 
Hall: Upper Saddle River, 2002. 
17. J. Hauser, S. Sastry, P. Kokotovic. Nonlinear control via 
approximate input-output linearization: the ball and 
beam example. IEEE Transactions on Automatic 
Control1992; 37(3): 392-398. 
18. C.J. Tomlin, S. Sastry. Switching through singularities. 
System and Control Letters1998; 35(3): 145-154. 
19. R. Hirschron, J. Davis. Output tracking for nonlinear 
system with singular points. SIAM Journal on Control 
and Optimization 1987; 25(3): 547-557. 
20. R. Ghanadan, G.L. Blankenship. On output tracking for 
nonlinear system with singular points. Proceedings of 
American Control Conference1994; 3: 2710-2711. 
21. F. D. Priscoli, L. Marconi, A. Isidori. A new approach to 
adaptive nonlinear regulation. Journal on Control and 
Optimization 2006; 45(3): 829-855. 
22. C.-L. Chen and Y.-S. Yang, “Spatial-based output 
feedback adaptive feedback linearization repetitive 
control of uncertain rotational motion systems subject to 
spatially periodic disturbances,” 17th IFAC World 
Congress on Automatic Control (IFAC; oral), Seoul, 
Korea, pp.13151-13156, 2008.  
23. Y.-H. Yang and C.-L. Chen, “Spatially periodic 
disturbance rejection using spatial-based output feedback 
adaptive backstepping repetitive control,” 2008 
American Control Conference (ACC; oral) , Seattle, WA, 
pp.4117-4122, 2008. 
24. C.-L. Chen, Y.-S. Yang. Position-dependent disturbance 
rejection using spatial-based adaptive feedback 
linearization repetitive control. International Journal of 
Robust and Nonlinear Control 2009, 19: 1337-1363. 
(SCI ranking: 17/175) 
 
 
 
 
 
15 
 
0 20 40 60 80 100 120
0
2
4
w/o RC#1
0 20 40 60 80 100 120
-20
0
20
w/o RC#2
co
n
tr
o
l i
n
p
u
t (
vo
lta
g
e)
0 20 40 60 80 100 120
0
2
4
with RC
angular displacement (revolutioin)
 
Figure 8: Comparison of control input for the different designs. 
 
 
 
Figure 9: 旋轉運動控制系統控制實驗平台設計圖 
 
 
Figure 10: 旋轉運動控制系統控制實驗平台實體圖 
 
 
會人士多侷限於大陸本土學校之學生，其口頭報告之能力與水準仍有待加強，另外可能吾人
所主持之兩個 session 與下午安排之演講時間衝突，導致台下之聽眾數量相較於上午之 session
少了許多。其他如 session 的主席應該儘量由教授擔任而不應安排學生擔任。但綜觀來說，相
較於吾人先前參加過之國際大型研討會(如 ACC 與 IFAC)，該研討會絕對已經具備國際級之
水準 (只差參與人士之水準有待提升)。 
 
三、考察參觀活動： 
利用參加會議之空檔時間，吾人有幸參觀了西安市諸多聞名景點中之三個：兵馬俑博物
館、鼓樓/鐘樓與大雁塔/慈恩寺。這三個景點均能搭乘計程車前往，交通實屬便利。秦始皇兵
馬俑博物館，是建立在兵馬俑坑原址上的遺址性博物館。自 1979 年 10 月開館以來，沐浴著
國家改革開放的春風，經過艱苦創業，取得了輝煌的成就，成為舉世聞名的大型遺址性博物
館。兵馬俑已被譽為”世界第八大奇跡”以及”二十世紀考古史上的偉大發現之一”。1987 年 12
月，聯合國教科文組織已將秦始皇陵（包括兵馬俑坑）列入”世界文化遺產名錄”。它不僅是
中國人民、也是全人類的一份珍貴文化財富。兵馬俑博物館規模宏偉，館區佔地面積 20 餘公
頃，展覽建築的總面積達 42000 餘平方米。各種配套設施齊全，環境優雅、舒適。博物館位
於西安市西北郊區，為一國際聞名之景點，每年吸引不少國外觀光客前來，該景點距離研討
會飯店約 50 分鐘車程，沿途也會經過驪山、華清池、秦始皇陵寢等景點。兵馬俑博物館佔地
面積廣大，除了已開挖兵馬俑之一二三號坑展館外，整體規劃媲美一國家公園。要完整遍遊
整個博物館地區一般可能需花上半天時間，但吾人由導遊帶領參觀，僅花約兩個小時。鼓樓/
鐘樓位於西安市區中心，距離研討會飯店約 20 分鐘車程。鐘樓始建於明太祖朱元璋洪武十七
年(西元 1384 年)因樓上懸掛鐵鐘一口而得名，建於方形基座之上，為磚目結構，鐘樓三層簷，
四角攢頂的形式總高 36 米，基座高 8.6 米，每邊長 35.5 米，面積約 1377.4 平方米，內有樓
梯可盤旋而上。在簷上覆蓋有深綠色琉璃瓦，樓內貼金彩繪，畫棟雕樑，頂部有鎏金寶頂，
金碧輝煌。以它為中心輻射出東、南、西、北四條大街並分別與明城牆東、南、西、北四門
相接，這是西安人引以為自豪的鐘樓，它是中國古代遺留下來許多鐘樓中型制最大保存最完
整得一座。鼓樓與鐘樓遙遙相望，也是中國重點文物保護單位。鼓樓建於明洪武 13 年(西元
1380 年)，比鐘樓大四歲迄今已有 611 年歷史，為重簷三滴水與歇山頂的木結構高大雄偉。清
代曾 2 次修葺。樓上原有巨鼓一面，傍晚擊鼓報時，故名鼓樓。昔日樓簷下懸掛有巨匾，南
為”文武盛地”北為”聲聞於天”。鼓樓斗拱彩繪，外觀莊重絢麗，與鐘樓為姊妹樓亦有”晨鐘暮
鼓”之說。鼓樓系古典建築，基座為長方形用青磚砌成，樓高 33 米，面積 1924 平方米。樓基
正中闢有南北劵門洞連通北院門和西大街。與鐘樓相輝映樓內有梯可上，登至二樓，憑欄可
眺望終南山與全城景觀。吾人進入西安市區可深刻感受到其氣氛與台灣之都會區相差無幾，
交通繁雜，商店種類令人眼花撩亂，且來往遊客眾多。鼓樓與鐘樓均值得買票入內參觀，登
上鼓/鐘樓瞭望市區之東西南北方向，傍晚時分景觀十分漂亮。大雁塔/慈恩寺位於研討會飯店
北邊約 10 分鐘車程，該景點實為一大型之廣場，可再分為東西南北四個廣場，其規模之龐大
為其特色之一，也令吾人感嘆土地廣大國家之優勢。大雁塔矗立西安城南大慈恩寺院內。大
慈恩寺創建於唐太宗貞觀二十二年（西元 648 年）。寺院新建落成時，唐代高僧玄奘受朝廷聖
命，為首任上座住持，並在大慈恩寺翻譯佛經。現在的塔名是據《慈恩寺三藏法師傳》中記
載：摩揭陀國有一僧寺，一日有一隻大雁離群落羽，摔死在地上。僧眾認為這只大雁是菩薩
的化身，決定為大雁建造一座塔，因而又名雁塔，也稱大雁塔。寺院依次有山門、鐘鼓樓、
大雄寶殿、法堂、大雁塔、玄奘三藏院等建築。鐘樓內懸挂明代鐵鐘一口，嘉靖二十七年十
978-1-4244-2800-7/09/$25.00 ©2009 IEEE                              ICIEA 2009 
A Fuzzy Multi-objective Genetic Algorithm 
Approach to Optimal Parameter Design for Laser 
Electrophotographic Systems 
Cheng-Lun Chen 
Department of Electrical Engineering 
National Chung Hsing University 
Taichung 40225, Taiwan 
chenc@dragon.nchu.edu.tw 
Ching-Pang Weng 
Department of Electrical Engineering 
National Chung Hsing University 
Taichung 40225, Taiwan 
g9564215@mail.nchu.edu.tw
 
 
Abstract—This paper proposes a systematic approach to 
conduct system-level optimal parameter design for laser 
electrophotographic systems. Besides system performance, we 
incorporate two other practical indices, i.e., cost and energy 
consumption, into design objectives and formulate a multi-
objective optimization problem. Fuzzy logics are employed to 
provide the nonlinear or linguistic mapping between the decision 
variables and the design objectives. For comparison purpose, the 
problem is solved using both single-objective and multi-objective 
optimization algorithms. A conventional monochrome laser 
printer serves as the platform for verification of the proposed 
optimal design approach. 
Index Terms—fuzzy system, genetic algorithm, laser 
electrophotographic system, multi-objective constrained 
optimization. 
I.  INTRODUCTION 
Electrophotography was first incorporated into a 
commercial product in 1959. At that time, Xerox Corporation 
launched the sale of their first automatic copier machine 
(known as Xerox 915). In recent years, electronic document 
quickly gained popularity and people tends to think that the 
market of printing products will gradually decline. Emergence 
of electronic document defines a new form of portable 
document, and also changes the reading habits of people. Many 
publishers or vendors now provide electronic copies of books 
or product manuals so that customers can read directly from 
their computer monitors. However, the need for people to print 
the electronic documents eventually drives and stimulates the 
sale of printing products. Furthermore, as the cost of hardware 
continues to drop off, a printing machine has slowly but surely 
become an indispensable electronic appliance in every home. 
After decades of progression, on-demand printing, i.e., printers 
or copiers used in the office or in the house, has recently 
become a competitive worldwide industry. For high-speed 
printing, EP is the technology of choice, and laser 
(electrophotographic) printer is one of the well-known 
consumer products having EP as its kernel technology.  
The life cycle of laser printers is becoming shorter, and the 
price is also dropping every year. Companies who are able to 
release new models of printers earlier to the market get more 
profits. The main challenge is to maintain/hold the 
quality/budget whereas push the release date as early as 
possible. Several key issues that consumers and manufacturers 
of laser printers care most about are cost, power or energy 
consumption, performance, etc. Conducting tradeoff among 
these three indices is definitely a multi-objective optimization 
problem. Researchers have been working on parameter design 
for laser printing systems. For the laser scanning subsystem, 
Ishii et al. [1] examined the relationship between the focusing 
and the power of the laser beam in the laser scanning unit. For 
the organic photoconductor subsystem, a few researchers 
studied the relationship among  the sensitivity, the residual 
potential, the charge acceptance, the decay characteristic, and 
the spectral response of the photoconductor [2, 3]. For the 
exposure step, Toyoshima et al. [4] showed that the image 
profile is related to parameters such as the exposure condition, 
photo-induced discharge characteristics. They obtained a set of 
parameters for equalizing the dot pitch and spot size through an 
(single-objective) optimization process. For the development 
step, researchers have explored the correlation among the 
powder size, the powder coating, the powder surface charge 
density, and the powder shape of housing cavity [5, 6]. Paxton 
[7] developed a mathematical model to predict the solid area 
image response of a conventional electrophotographic system. 
A set of requirements for the system response based on 
electrostatic window was then used to determine the optimal 
process set point. Rai [8] obtained desired color images on the 
final substrate by solving a multi-objective optimization 
problem using the method of goal programming. Most of the 
previous work studied only a specific subsystem of a laser 
printing system. Also, most did not study how to specify the 
parameters in order to maximize or minimize the design 
objective. Furthermore, former research resorting to 
optimization methods focused solely on image quality of a 
printing system. As pointed out earlier, designing or making 
selection of a laser printer is fundamentally a multi-objective 
optimization problem. To identify all the decision variables and 
the corresponding constraints for a printing system is a 
formidable task. To derive a useful set of quantitative indices 
representing the aforementioned key issues poses another 
challenge. 
In this paper, we make an attempt to formulate a multi-
objective optimization problem for a laser printing system, 
2786
          
decision variables, i.e., [ ]1 12 Tx xL . 1C  to 5C  are the 
outputs of the fuzzy logics relating to cost. For example, 1C  
may be expressed by  
 
 ( )
( )
( )
1
1
1
C
r
i i i
i
r
i i
i
mσ
σ
=
=
Φ
=
Φ
∑
∑
x
x
x
 (5) 
 
where im  and iσ  are the mean and the standard variation, 
respectively, of the consequent part of the i th rule with 
Gaussian membership function, r  is the number of rules, and 
( )iΦ x  is the firing strength of the i th rule, i.e., 
 
 ( )
2
1
n
j ij
i
j ij
x m
σ=
⎧ ⎫⎛ ⎞−⎪ ⎪Φ = − ⎜ ⎟⎨ ⎬⎜ ⎟⎪ ⎪⎝ ⎠⎩ ⎭
∑x exp  (6) 
 
where jx  is the j th decision variable, ijm  and ijσ  are the 
mean and standard variation, respectively, of the precondition 
part of the i th rule with Gaussian membership function, and n  
is the number of variables. 1Pw  to 4Pw  are the outputs of the 
fuzzy logics relating to power, which may be defined as shown 
previously. 1Pf  to 5Pf  are the outputs of the fuzzy logics 
relating to performance, which may also be defined as shown 
previously. Note that the proposed objective functions use 
simple summation to integrate those outputs.  
Our goal is to minimum the cost and the power 
consumption, and to maximum the performance, which may be 
formally described by the following multi-objective 
optimization problem: 
 
 
( )
( ) ( )
1
2
3
minmize     ( )
minmize     ( )
maximize   ( )
subject to
                  0                  1,...,
                            1,...,
k
lb ub
i i i
f
f
f
g k j
x x x i n
≤ =
≤ ≤ =
x
x
x
x
 (7) 
 
The functions for the inequality constraints and the allowable 
interval for the decision variables will be defined and explained 
in next subsection. 
C. Constraints 
For the formulated multi-objective optimization problem 
given by (7), we identify the functional inequality constraints 
as given below: 
 
 
( ) ( )( )
( )
( )
( ) ( )
5
1 '
6
5
6
5
2
2
1 exp
        600 0
2
1 exp
2
c c
c
c c
c c
f V x h
g
f B
hx C
f V x h
hx C
f V x h
− += ×−
⎛ ⎞⎜ ⎟− −⎜ ⎟ + ≤⎜ ⎟− +− −⎜ ⎟⎜ ⎟− −⎝ ⎠
x
 (8) 
 
 
( ) ( )( )
( )
( )
( ) ( )
0
2 '
6
5
6
5
2
2
1 exp
        800 0
2
1 exp
2
c c
c
c c
c c
f V V h
g
f B
hx C
f V x h
hx C
f V x h
− += − ×−
⎛ ⎞⎜ ⎟− −⎜ ⎟ − ≤⎜ ⎟− +− −⎜ ⎟⎜ ⎟− −⎝ ⎠
x
 (9) 
 
with ( )2 2 '5 54c c c ch f x f BV V x= + − . 
 
 ( ) ( )( )
3
4
3 3 3
11
0 05 0t
c
x
g x
x
ρ
ρ= − ≤x .  (10) 
 
 ( ) ( )( )
3
4
4 3 3
11
0t
c
x
g x
x
ρ
ρ
⎛ ⎞⎜ ⎟= − ≤⎜ ⎟⎝ ⎠
x  (11) 
( ) ( ) ( ) ( )
( ) ( )1
2
0 2
5 0 2
, 0
2
2
28
9 8
0
10
2
2
,  exp
2
4.9 10 0
2
off
i
i j x
j i t
x
y
x x x x
g E x y I
dxy x t x t dt
d
d
ττ σ
θ
τσ
∞
+ ×
−
⎧ − − Δ −⎡ ⎤⎪ ⎣ ⎦= = −⎨⎪⎩
⎫⎛ ⎞ ⎪⎜ ⎟⎛ ⎞ ⎪− +⎜ ⎟⎜ ⎟⎝ ⎠ ⎪⎜ ⎟ ⎪⎝ ⎠− − × ≤⎬⎪⎪⎪⎪⎭
∑∫
∫
x
 
 (12) 
 
( ) ( ) ( ) ( )
( ) ( )1
2
0 2
6 0 2
, 0
2
2
28
9 8
0
11
2
2
,  exp
2
4.9 10 0
2
off
i
i j x
j i t
x
y
x x x x
g E x y I
dxy x t x t dt
d
d
ττ σ
θ
τσ
∞
+ ×
−
⎧ − − Δ −⎡ ⎤⎪ ⎣ ⎦= = − −⎨⎪⎩
⎫⎛ ⎞ ⎪⎜ ⎟⎛ ⎞ ⎪− +⎜ ⎟⎜ ⎟⎝ ⎠ ⎪⎜ ⎟ ⎪⎝ ⎠− + × ≤⎬⎪⎪⎪⎪⎭
∑∫
∫
x
2788
          
software environment including Windows XP operating system, 
MATLAB 7.1, and DEV C++ 5.0. 
IV. CONCLUSION 
In this study, we formulate a multi-objective optimization 
problem for parameter design of a laser electrophotographic 
system. Fuzzy logics are utilized to describe the links between 
the decision variables and the design objectives. We compare 
the performance of two optimization algorithms, i.e., SQP and 
NSGA-II, in solving the problem. With the kernel (Fuzzy 
mechanism) of all experiment procedure, we only state the 
relationship between the variables and objective function for 
constructing the objective function. To the best of our 
knowledge, this is the first attempt to perform a system level 
design optimization and take into account practical design 
objectives, i.e., cost and power consumption (in addition to 
performance), for printing systems. 
REFERENCES 
[1] K. Ishii, M. Takahashi, H. Nagato, K. Higuchi, M. Hosoya and K. 
Komata, “2540 dpi Full Color Image Creation with a Liquid 
Electrophotography System,” IS&T's NIP19: International Conference 
on Digital Printing Technologies, pp. 9-12, 2003. 
[2] M. Sasahara, H. Fukunaga and A. Ikeda, “Resolution Improvement on a-
Si Photoreceptor Drums,” IS&T's NIP14: International Conference on 
Digital Printing Technologies, pp. 535-538, 1998. 
[3] S. Tsuchiya, A. Omote, M. Murakami and S. Yoshimura, “Positively 
Charged Monolayer Photoreceptor with H2-phthalocyanine,” J. Image 
Science and Technology, vol. 39, no. 4, pp. 294-298, 1995. 
[4] T. Toyoshima, T. Iwamatsu, N. Azuma, S. Nishio and Y. Mutoh, 
“Optimization of the Image Profile Transform in High Resolution 
Electrophotography,” IS&T's NIP16: International Conference on 
Digital Printing Technologies, pp. 303-306, 2000. 
[5] S. Ahuja, “Flow of Particulates, Toners and Carriers in a Housing 
Cavity,” IS&T's NIP23: International Conference on Digital Printing 
Technologies, pp. 53-55, 2007. 
[6] R. Kohler, D. Giglberger and F. Bestenreiner, “Studies on 
Electorphoretic Developers for Pictorial Electrophotography,” 
Photographic Science and Engineering, vol. 22, no. 4, pp. 218-227, 
1978. 
[7] K. B. Paxton, “Electrophotographic Systems Solid Area Response 
Model,” Photographic Science and Engineering, vol. 22, no. 3, pp. 159-
164, 1978. 
[8] S. Rai and R. Rockwell, “Setpoint Determination of Printing Systems 
Using Multiobjective Optimizaiton,” IS&T's NIP16: International 
Conference on Digital Printing Technologies, pp. 164-166, 2000. 
[9] C.-L. Chen, G. T.-C. Chiu and J. P. Allebach, “Banding Reduction in EP 
Processes Using Human Contrast Sensitivity Function Shaped 
Photoconductor Velocity Control,” J. Imaging Science and Technology, 
vol. 47, no. 3, pp. 209-223, 2003. 
[10] C.-L. Chen, G. Chiu, and J. P. Allebach, “Halftone Banding Reduction 
for a Class of Electrophotographic Systems -- Part I: Characterization 
and Modeling,” IFAC J. Mechatronics, to be published. 
[11] C.-L. Chen and C.-P. Weng, “On Modeling and Simulation of Digital 
Laser Printing: An Integrated Model From Binary Image to Toner 
Image,” J. the Chinese Institute of Engineers, to be published. 
[12] K. Deb, Multi-objective Optimization using Evolutionary Algorithms. 
New York: John Wiley & Sons, 2002. 
[13] L. Zadeh, “Optimality and Non-Scalar-Valued Performance Criteria,” 
IEEE Trans. Automatic Control, vol. 8,  no. 1, pp. 59-60, 1963. 
[14] L. B. Schein, Electrophotography and Development Physics, California: 
Laplacian Press, 1996. 
[15] R. M. Schaffert, Electrophotography, New York: Focal Press, 1975. 
[16] Epson Corp., Epson EPL-5xxx Service Manual, 2005.  
[17] L. B. Schein, K. J. Fowler, G. Marshall and V. Ting, “Microscopic 
Theory of Magnetic Brush Development with Sponge Carrier,” J. 
Imaging Technology, vol. 13, no. 2, pp. 60-67, 1987. 
[18] C. Yamaguchi and M. Takeuchi, “Influence of Toner Particle Shape and 
Size on Electrophotographic Image Quality,” J. Imaging Science and 
Technology, vol. 40, no. 5, pp. 436-440, 1996. 
[19] D. Kacker, T. Camis and Jan P. Allebach, “Electrophotographic Process 
Embedded in Direct Binary Search,” IEEE Trans. Image Processing, vol. 
11, no. 3, pp. 243-257, 2002. 
[20] K. Deb, A. Pratap, S. Agarwal and T. Meyarivan, “A Fast and Elitist 
Multiobjective Genetic Algorithm: NSGA-II,” IEEE Trans. 
Evolutionary Computation, vol. 6, no. 2, pp. 182-197, 2002. 
[21] User’ Guide for Optimization Toolbox. The MathWorks. 
 
 
 
 
 
 
 
 
 
TABLE V.  ORIGIN OF THE CONSTRAINTS 
Constraint Source 
Voltage on the OPC after 
charging step ( 1 2and g g ) 
Schaffert 1975 
Page 243 
Toner concentration 
( 3 4and g g ) 
Schein 1996 
Page 144 
Exposure energy 
constraints after exposure 
step ( 5 6and g g ) 
Service manual 
TABLE IV.  DECISION VARIABLES RELATED TO PERFORMANCE 
 Performance 
Type of 
system 
Optical 
system 
Develop 
system 
Charging 
system 
OPC 
system
OPC-
Develop 
system 
Decision 
variables s
f , sv
0n , 
tR , 
cR , 
Q M  
0V , ct  
sE , ω , 
pR  
v  
TABLE III.  DECISION VARIABLES RELATED TO POWER CONSUMPTION 
 Power 
Type of 
system 
Optical 
system 
Develop 
system 
Charging 
system 
OPC 
system
OPC-
Develop 
system 
Decision 
variables s
f , sv  0V , ct  
sE , ω , 
pR  
v  
TABLE II.  DECISION VARIABLES RELATED TO COST 
 Cost 
Type of 
system 
Optical 
system 
Develop 
system 
Charging 
system 
OPC 
system
OPC-
Develop 
system 
Decision 
variables sf , sv 0n , tR  0V , ct  
sE , ω , 
pR  
v  
TABLE I. DECISION VARIABLES ASSIGNED TO EACH SUBSYSTEM 
 Optical system 
Develop 
system 
Charging 
system 
OPC 
system 
OPC-
Develop 
system 
Decision 
variables sf , sv
0n , tR , 
cR , 
Q M  
0V , ct  
sE , ω , 
pR  
v  
2790
978-1-4244-2800-7/09/$25.00 ©2009 IEEE                              ICIEA 2009 
 Automatic White Balance Based on Estimation of 
Light Source Using Fuzzy Neural Network 
Cheng-Lun Chen 
Department of Electrical Engineering 
National Chung Hsing University 
Taichung 40225, Taiwan 
chenc@dragon.nchu.edu.tw 
Shao-Hua Lin 
Department of Electrical Engineering 
National Chung Hsing University 
Taichung 40225, Taiwan 
g9564201@mail.nchu.edu.tw
 
 
Abstract—In this paper, we propose an image processing 
pipeline to estimate the color temperature and white balance an 
image. The method comprises a pre-processing stage to generate 
training samples for the fuzzy neural network (FNN), which plays 
the role of predicting pixel-level color temperatures, and two 
post-processing stages to integrate the outputs of the FNN into an 
overall color temperature of and white balance the image. 
Experimental results and comparison study verify that the 
proposed method performs better than most existing methods. 
Index Terms—fuzzy neural network, white balance, color 
temperature estimation 
I.  INTRODUCTION 
It is known that the human eye can compensate for the 
color temperature of light falling on an object automatically. 
When a person moves from outdoor with bright and blue-tinted 
sunlight into indoor with dim and yellow-tinted lighting, his 
eye will adapt to the different light condition and alter the 
perception formed in the brain accordingly. Unfortunately, 
even the most sophisticated digital or video camera cannot 
automatically perform this seemingly simple task done by the 
human eye. Digital or video cameras need to be ‘told’ what to 
‘read’ as ‘white’ in any captured image. Thus, white balance 
has become one of the indispensable signal processing 
pipelines in most image capturing or rendering devices. 
Existing white balance methods fall into the following three 
categories: gray world method [1, 2], perfect reflector method 
[3] and light or color temperature estimate. Gray world method 
is based on gray world assumption: Suppose that an image has 
abundant colors, the average value of its red (R), green (G), and 
blue (B) separates would be gray, i.e., R=G=B. Gray world 
method with image partition divides an image into several 
regions and assigns weight to each region based on how well a 
region satisfies gray world assumption [4-10]. Perfect reflector 
method is based on the fact that if the surface of an object is 
shiny enough, it reflects the actual color of the light source, 
independently of the color of the surface. Therefore, the R, G, 
and B components of the brightest or most reflective spot in an 
image can be used to scale the RGB values of the other image 
area. Color temperature or illumination estimation attempts to 
identify the current lighting condition. Color temperature 
estimation is normally performed by gathering statistics of 
color characteristics [11-16]. In addition, they often use scoring 
approach to score each color temperature, and choose the color 
temperature with the maximum score as the estimated color 
temperature for the image (e.g., the methods by Kehtarnavaz 
[13] and Wang [11]). Kehtarnavaz et al. obtained a number of 
reference color curves by placing the color checker under 
standard light sources. A set of prototype or representative 
colors from the image was then acquired using multi-scale 
clustering method, and a color matching procedure was then 
performed between the reference and the prototype colors. 
Wang and Fuh proposed a method detecting the gray points 
from the image, using the information of these gray points to 
determine the score in each predefined color temperature 
domain, and calculating the estimated color temperature. Huo 
et al. constructed the criteria to extract the gray points and 
performed automatic white balance. The color temperature was 
estimated using the deviation of gray points under different 
light sources. 
In this paper, we propose a new method for estimating the 
color temperature of an image. A fuzzy neural network (FNN) 
is introduced and trained to associate an input coordinates of a 
color, e.g. R, G, and B, with the correct color temperature under 
which the color is measured or captured. The training samples 
for the FNN came from the uniform color patches on a color 
checker under different light sources. A procedure is proposed 
to select the representative samples within each color patch. 
During the training stage, the FNN gradually learns the 
nonlinear mapping between each color and the corresponding 
illumination. An image with unknown light source may then be 
fed to the FNN and the R/G/B component for each pixel of the 
image is mapped to a color temperature. Another procedure is 
proposed to determine the color temperature for the overall 
image based on the estimated temperature values from the 
image pixels. Finally, to perform white balancing, the R, G, and 
B values of the white color under D65 and the estimated color 
temperature are used to determine the required amount of 
adjustment for each color plane of the image. An experiment is 
set up to verify the proposed method. Comparison with other 
existing methods is also made. Both quantitative and 
qualitative results indicate that the proposed approach is 
superior to most existing methods. 
II. COLOR TEMPERATURE ESTIMATION USING FUZZY 
NEURAL NETWORK 
In this section, we briefly describe the structure of the FNN. 
With the proposed methods to generate the training samples 
and process the outputs, the FNN will be capable of predicting 
the color temperature for a test image. The predicted 
1905
         
where . .E T  is the estimated color temperature. The idea behind 
the proposed method is to shift the red/blue color plane (add a 
positive constant) under high/low color temperature, adjust the 
pixel values, and then shift the color plane back (add a negative 
constant). The overall methods/procedures are illustrated in Fig. 
2 and Fig. 3. 
III. EXPERIMENTAL RESULTS 
Fig. 4 illustrates the experimental setup and procedure. A 
color checker with various color patches serves as the training 
image. A high end digital camera with a native resolution of 
3888 2592×  pixels is utilized to acquire the raw image data. A 
light booth is used to provide various standard light sources (A: 
incandescent, U30: warm white fluorescent, CWF: cool white 
fluorescent, and D65: daylight) inside which the color checker 
can be placed. The image captured under D65 illumination can 
be regarded as the reference image (with desired white balance), 
and the other images captured under A, U30 and CWF are test 
images (to be white balanced). The mean square errors (MSE) 
between the reference image and the test image before and after 
being white balanced may be calculated and compared. The 
MSE is defined as 
( ) ( )( )
( ) ( )( ) ( ) ( )( )
2
1 2
1 1
2 2
1 2 1 2
1 , ,
3
, , , ,
n m
i j
MSE R i j R i j
mn
G i j G i j B i j B i j
= =
⎡= −⎣
⎤+ − + − ⎦
∑∑
 (3) 
where ( ),R i j , ( ),G i j , and ( ),B i j  are the red, green and 
blue pixel values at location ( ),i j  and n  and m  are the 
dimensions of the images.  
For each standard light source, we collect six images with 
each taken 20 seconds apart (see Fig. 5). For each color patch, 
we crop an area of 370 370×  pixels used as candidates for 
training samples. Patches with overly saturated colors are 
discarded. Histograms of the candidate pixels for two of the 
color patches under D65 are shown in Fig. 6. For color 
component values lying within one standard deviation, we 
select 20 pixels per value as training samples. For training of 
the FNN, the desired output is set to the normalized 
temperature 1 [2856,3000,4150,6500]
6500
, the learning rate 
η  is set to 0.005, and the number of training cycles is set to 
1000. The root mean square error (RMSE) versus iterations is 
shown in Fig. 7. Note that the RMSE is 0.151036 at the end of 
the first iteration and reduces to 0.005041 after 1000 iterations. 
A test image, see Fig. 8(a), with unknown light condition is 
used to demonstrate the proposed methodology. After feeding 
the image into the FNN, the histogram for the outputs is shown 
in Fig. 8(b) and Fig. 8(c) with normalization. Using the method 
described previously with a threshold of 0.5, we may calculate 
the estimated color temperature for this test image, which is 
4151K. The R, G, and B values of the white color patch under 
standard light sources are listed in TABLE I. The data is curve 
fitted using polynomials of degree two as shown in Fig. 9. 
Using the proposed method, i.e., (2), we obtain the white 
balanced image as shown in Fig. 13(h). 
A study is made which compares our method with other 
methods in existing literature, i.e., gray world method (GWM) 
[1], perfect reflector method (PRM) [3], Lam’s method [6], 
Chikane's method [17], Huo's method [12], and Wang's method 
[11]. In the study, the taken photo of the color checker under 
D65 is the reference image. The test images are taken under 
other light sources, i.e., 4150K, 3000K, and 2856K, which go 
through each individual algorithm and produce the white 
balanced images. The MSE (in either RGB or YCbCr space) 
between the reference image and the white balanced test image 
is then calculated for each algorithm. Another commonly used 
performance index, i.e., the average chromaticity 2 2b rC C+  is 
also calculated. The quantitative results are summarized in 
TABLE II-TABLE IV and Fig. 10-Fig. 12. The algorithms are 
also applied to the test image from Fig. 8 and the results are 
shown in Fig. 13. It is seen that the method/procedure proposed 
in this paper performs better in white balancing an image than 
most others did in the literature. 
IV. CONCLUSION 
In this paper, we propose a novel method/procedure which 
incorporates a fuzzy neural network to predict the illuminant 
condition of an image. A qualitative comparison of our method 
with existing ones, based on the quantitative data obtained 
previously, are made. The results are given in TABLE V, 
where execution time, complexity, and performance of the 
algorithms are compared. We see that perfect reflector method 
(PRM) and gray world method (GWM) provide short execution 
time and low complexity but result in poor performance. Lam’s 
and Huo’s methods consume more execution time, have 
median complexity, and give mediocre performance. Note that 
the method having long execution time does not necessarily 
offer good performance, e.g., Wang’s method. On the other 
hand, the method executing fast could also possess good 
performance, e.g., Chikane’s method. Due to the incorporation 
of the FNN, the methods proposed in this paper demand more 
execution time and have relatively high complexity. 
Nevertheless, the proposed methods provide better 
performance than others. 
TABLE I. THE R, G, B COMPONENTS OF WHITE BLOCK OF COLOR 
CHECKER AFTER FNN TRAINING. 
 2856K 3000K 4150K 6500K 
Red 255 244 237 212 
Green 179 182 196 208 
Blue 88 106 138 207 
TABLE II. THE MSE BETWEEN RAW DATA AND REFERENCE IMAGE (IN 
RGB COLOR SPACE). 
Compare test image 
and D65 4150K 3000K 2856K 
Raw data and D65 855.79 1849.67 2836.34 
PRM 449.08 1249.71 2076.18 
GWM 463.75 995.06 1686.37 
Lam’s method 390.37 806.87 1252.19 
1907
         
 
Figure 6.  Histogram of block 1 and block 2 in 6500K. 
 
Figure 7.  The iterations of root mean square error. 
 
Figure 8.  (a) Test image. (b) Light estimation result. (c) Normalize Figure 
8(b). 
 
Figure 9.  Curve fitting line. 
 
Figure 10.  (a) Reference image. (b) Test image under 4150K and after auto 
white balance processing results by applying (c) PRM, (d) GWM, (e) Lam’s 
method, (f) Chikane's method, (g) Huo's method, (h) Wang’s method, and (i) 
our method. 
 
Figure 11.  (a) Reference image. (b) Test image under 3000K and after auto 
white balance processing results by applying (c) PRM, (d) GWM, (e) Lam’s 
method, (f) Chikane's method, (g) Huo's method, (h) Wang’s method, and (i) 
our method. 
 
     
(a)                                (b)                                 (c) 
     
(d)                                (e)                                 (f) 
     
(g)                                 (h)                                 (i)
     
(a)                                (b)                                 (c) 
     
(d)                                (e)                                 (f) 
     
(g)                                 (h)                                 (i) 
     
(a)                                (b)                                 (c) 
     
(d)                                (e)                                 (f) 
     
(g)                                 (h)                                 (i) 
2500 3000 3500 4000 4500 5000 5500 6000 6500
80
100
120
140
160
180
200
220
240
260
Color temperature (K)
P
ix
el
 v
al
ue
s
Curve fitting
 
 
Red
Green
Blue
 
(a) 
   
(b)                                                   (c) 
0 100 200 300 400 500 600 700 800 900 1000
0
0.02
0.04
0.06
0.08
0.1
0.12
0.14
0.16
0.18
0.2
Iterations
R
oo
t m
ea
n 
sq
ua
re
 e
rro
r (
R
M
S
E
)
Learning rate=0.005
X: 1000
Y: 0.0002486
1909
