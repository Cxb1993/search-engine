行政院國家科學委員會補助專題研究計畫  成 果 報 告期中進度報告
以螞蟻演算法產生植基於試題反應理論之平行測驗卷
Ant Colony Optimization for IRT Based Parallel Test-sheet Composition
計畫類別： 個別型計畫  整合型計畫
計畫編號：NSC 100－2221－E－130－025－
執行期間：100 年 8 月 1日至 101 年 7 月 31 日
計畫主持人：何祖鳳 副教授 (資訊工程學系)
共同主持人：徐熊健 教授 (資訊工程學系)
計畫參與人員：吳怡菱 博士班研究生
朱炫吉 碩士班研究生
成果報告類型(依經費核定清單規定繳交)：精簡報告 完整報告
本成果報告包括以下應繳交之附件：
赴國外出差或研習心得報告一份
赴大陸地區出差或研習心得報告一份
出席國際學術會議心得報告及發表之論文各一份
國際合作研究計畫國外研究報告書一份
處理方式：除產學合作研究計畫、提升產業技術及人才培育研究計畫、
列管計畫及下列情形者外，得立即公開查詢
涉及專利或其他智慧財產權，一年二年後可公開查詢
執行單位：銘傳大學資訊工程學系
中 華 民 國 101 年 10 月 31 日
1第一章 緒論
1.1 研究背景與動機
為了瞭解受測者的能力或程度，大多數的機構都採用測驗的方式對受測者進
行測試，並根據受測者的成績是否達到一定的標準，作為授予證書或證照的依據。
因此，教育、心理學等領域的學者為了確保測驗本身能確實地判斷出受測者本身
的能力或程度，針對測驗的各個面向進行了諸多的研究。而在這些研究之中，近
期以試題反應理論(Item Response Theory)受到較大的矚目。
試題反應理論將受測者對於測驗所造成的影響納入測驗編製的考量，並利用
數學模型衡量受測者的能力及各受測者之間的差距，以取得較精確的衡量效果。
隨著試題反應理論相關的研究逐漸地深入，部分學者開始質疑試題反應理論中單
向度的假設，並於實務上透過實驗檢證多向度的存在。
在較為正式的測驗中會設置數份測驗內容、難度、訊息含量等數值相近的平
行試卷，以因應各種意外情況或維持歷年測試的水準。再加上測驗本身在時間、
數量上各式真實環境中的需求、題庫中所儲備的試題數量持續地增長、所採用的
數學模型為求公平真實而日趨複雜等諸多因素的影響之下，編制出符合施測者需
求的平行試卷便有一定程度的困難。
1.2 研究目的
為因應較為正式的測驗需要編製多份試卷的需求，施測者需從題庫中挑選適
合的試題編製數份符合限制且彼此訊息含量相近的平行試卷[5]，若題庫中試題
數量不足，則試卷間訊息含量不易接近，而題庫擁有大量的試題時，則從中挑選
試題會花費大量的時間。此外多向度的特性雖能更細緻地反應受測者的，卻也大
量地增添了計算的繁瑣程度。再加上考量平行試卷的情況，各試卷之間挑選之試
題不能完全相同，但單一試卷中試題總和之訊息含量需與其他試卷相近的考量之
下，除挑選試題所需的運算量會大幅度增加之外，試題的選擇上顯然更為受限。
透過問題轉化的方式，此種編製試卷類型的問題可以以混和整數模型的方式
加以表述，本質上屬於 NP-Hard問題。此類型的問題隨著前述參數在數量及複
雜度上的影響，一般常見之求解方式很難有效地在短時間內取得滿足限制的可行
解。因此，本研究除應用多向度試題反應理論進行平行試卷的編製之外，另將嘗
試透過窗格的概念改善螞蟻族群演算法求解的效能。
第二章 文獻探討
本章首先將介紹試卷編製問題與該問題相關應用所需考慮的面向，並對關於
試題反應理論此種測驗理論在試卷編卷過程所代表的意義作簡要的描述，最後將
介紹螞蟻族群演算法(Ant Colony Optimization)用以求解此一類型問題所運用到
的概念與相關的優點。
2.1 試卷編製問題
無論是在學習的過程中或基於實驗的目的，只要我們想要去了解參與者在此
一過程中的進度或是狀況，就必須依賴測驗、問卷、面試等方式或制度來與參與
者進行互動，進而取得所需要的資料以進行後續的處理或分析。而在教育領域中，
3Pi(θ)表示能力為 θ的受測者答對試題 i的機率，ai是試題 i的鑑別度，bi是
試題 i的難易度，ci是試題 i的猜測度，e常被稱作歐拉數，是數值約為 2.71828
的數學常數。
施測者可藉由這些試題特徵函數觀察受測者在測驗中的答題狀況，以及受測
者本身潛在特質或能力與作答情況之間的關係。為了能夠更加精確地評估受測者
的能力，與試題本身相關的難易度、鑑別度、猜測度參數通常會透過一定數量且
適合的受測者進行施測之後，藉由回收的樣本資料進行試題參數的估算。
為了滿足一定程度以上的評估可靠度，試題反應理論估算試題參數時所需的
樣本數量會比古典測驗理論所需的樣本數量更多，且樣本數量會因試題反應理論
的模型不同或其他因素而有所差異，在大多數的情況下都會需要 500以上的樣本
數。
試題反應理論應用於試卷編製問題時，可以運用試題訊息函數作為建立、分
析，以及診斷測驗的依據。以三個參數對數型模型為例，試題訊息函數的公式如
(2)所示：
        niθQθP θPθI ii ii ,,3,2,1,
2'
 (2)
Ii(θ)表示試題 i在能力 θ所提供的訊息含量，訊息含量越高則代表該試題對
於該能力受測者進行測驗所取得的結果越精確。Pi'(θ)是能力 θ上Pi(θ)值的導數，
Qi(θ)則等於 1-Pi(θ)。以三個參數對數型模型為例，將公式(1)代入試題訊息函數
的公式 (2)，計算後的試題訊息函數公式可以展開如(3)所示：
         nieeC CaθI iiii bθabθai iii ,,3,2,1,1
1
2
2

  (3)
依照試題反應理論對應到的試題訊息函數進行計算之後，可得到該試題的訊
息含量，而整份試卷的試卷訊息函數 I(θ)則為 θ值上加總的試題訊息含量總和，
公式如(4)所示：
   


n
i
i θIθI
1
(4)
在施測者需要對受測者的多種能力進行衡量，或測驗本身需要數種能力的配
合等情況下，會考慮使用多向度試題反應理論的數學模型來進行試卷的編製，以
求更為精確地衡量受測者的能力。以多向度三個參數模式(multidimensional
extension of the three parameters logistic model, M3PL)為例[10]，公式如(5)所示：
   11 '
'
ii
ii
dθa
dθa
iii e
eccθP 

 (5)
將M3PL的公式(5)代入訊息函數的公式(2)，則計算訊息函數的公式可以展
開如(6)所示：
       iidθadθai
dθa
i
i aaeec
ecθI
iiii
ii 
 

2''
2'
1
1 (6)
其中是 aiai一個長寬皆為 N的矩陣，N為向度數量，矩陣中第 s行第 t列
的元素數值為 as與 at的乘積。在向度為 1的情況下，公式(6)跟公式(3)是一致的。
5比較對象，最後將說明處理問題所採用之螞蟻族群演算法實作方式。
3.1 問題定義
在高嘉陽的研究中[2]，為了補足 Hwang等人[6-8]所定義模型的瑕疵，在編
製測驗卷的問題中引入了試題反應理論的概念，但是並未考量到多向度的情況。
而後的研究中則引入多向度試題反應理論的模型，以求更加完善編製測驗卷的問
題上所能對應的情況[1]。而在考量到平行試卷製作上的需求，於本次研究中添
加了相關的重複度概念，以便於滿足相應測驗所需之組卷要求。
假設題庫中試題數量為 n，分別為 Q1, Q2, ..., Qn，而題庫涵蓋了 m種學習概
念，分別為 C1, C2, ..., Cm，能力點在多向度上的總數量為 s，分別為 θ1, θ2, ..., θs，
施測者期望的試卷訊息含量則分別為 D1, D2, …, Ds，試卷的數量為 p，編製所得
之試卷訊息含量則分別為 O11, O21, …, Os1,O12, …, Osp。並考量到教師在進行測驗
卷編製時，可調整測驗卷的內容所需涵蓋的學習概念、整份測驗卷作答所需的時
間等其他因素，將此測驗卷編製問題轉化為組合最佳化問題，表示如下：
目標函式：
Minimize  
 

p
l
s
k
klk OD
1 1
2 (8)
  skIO n
i
klkl ,,2,1,det
1


 

 (9)
       



n
i
iidada
i
da
iil
kl aaeec
ecxI
iiii
ii
1
2''
2'
1
1


 (10)
限制式：



n
i
jilij hxr
1
, j = 1, 2, …, m (11)
LxtU n
i
ili 
1
, (12)
Txn
i
il 
1
, (13)
IRx
p
l
il 
1
, (14)
TRxxn
i
izil 
1
, zl  , z = 1, 2, …, p (15)
},1,0{ilx i = 1, 2, …, n, l = 1, 2, …, p (16)
Il(θk)代表在試卷 l於能力點 k的訊息矩陣，Okl代表試卷 l於能力點 k的試卷
訊息含量，Dk代表施測者於能力點 k所期望的試卷訊息含量。
ai代表試題 Qi的鑑別度，其值越大代表越能區分能力相近受測者之間的差
距。bi代表試題 Qi的難易度，其值越大代表試題越困難，相同能力的受測者答
錯的機率越大。ci代表試題 Qi的猜測度，其值越大代表隨機猜對該試題的機率
越大。di代表代換-ab的變數。
rij代表試題 Qi與學習概念 Cj之間的關連度，hj代表該份試卷對學習概念的
7況發生，則用當回合最佳解取代全域最佳解，最後再更新費洛蒙，以上步驟稱為
一個回合。
3.3.2 狀態轉移法則
螞蟻在移動的時候，會根據費洛蒙和啟發值去挑選下一步，題目被挑選的情
況則反應在費洛蒙的濃度上，費洛蒙越高者表示該題目較常被螞蟻選到，顯示出
所有螞蟻對於此題目的經驗累積。當螞蟻在進行挑選時，會考慮一個適當的搜尋
範圍大小為w，假設螞蟻已選擇測驗項目 i，則下一步螞蟻挑選的範圍將由 1i 至
wi  ，這樣的範圍稱為一個窗格W。
而根據每個題目上的鑑別度、難易度、猜測度等相關訊息，透過訊息函數的
公式 (6) 計算出每個能力值θ訊息函數的貢獻量，將這些訊息透過公式為這個測
驗題目求出一個值， iη 表示第 i題的啟發值，公式如(17)所示：
niIDs
k
kiki ...,,2,1,))((
1
2 

 (17)
而螞蟻需要挑選試題時所遵循的狀態轉移規則如(18)所示：
 







 a
ii
ai listiWi
qq
qqq
qq
if
if
if
wp ,,
max,
0
/1
1
1
10
0

(18)
q0, q1表示螞蟻在挑選最好的試題、隨機挑選窗格區間範圍內試題以及不挑
選窗格區間內試題這幾種可能性所佔的比例，表示費洛蒙與啟發值之間何者比
較重要。螞蟻 a挑選第 i題時，首先會隨機產生一個介於 0到 1之間的數字 q，
若 q小於等於 q0，螞蟻 a會挑選視窗中 βiiητ 值最大的測驗題目，挑選過的題目則
會放入螞蟻本身紀錄的已選名單 lista；若 q大於 q0但小於等於 q1，螞蟻 a則會
在視窗區間範圍內隨機挑選一題放入 lista；若 q大於 q1，則表示不挑選這個視窗
範圍中的任何一題，視窗會再往下移動w個距離，重新產生 q並重複進行上述的
動作。
3.3.3 修復運算
當每隻螞蟻完成了初步的挑選，會檢查已選名單 list是否有滿足所有的限制
式，若全部限制式都滿足的情況則稱該解答為可行解，並跳過此一步驟。若有任
一限制式未達到需求，則使用修復運算將目前不可行解修改至可行解為止；首先
從挑選已選名單 list中測驗試題與題庫未被挑選到的試題各選一個進行比較，如
果兩者交換可使超出限制式的情況改善，則做交換的動作。修復的動作會執行到
所有的已選名單 list都成為可行解即停止。
3.3.4 修復運算
當螞蟻族群演算法的回合執行數已達預設的最大執行次數或超過一定的時
間，當發生以上任何一個情形時，程式就會停止動作並回報目前已取得最好的已
選名單 list。
第四章 實驗結果
本研究的實驗是以 C#程式語言撰寫，實驗時題庫所採用的試題數量分別為
1000題與 10000題兩種，測驗題庫中鑑別度、難易度與猜測度的分布狀態為常
態分配，向度的數量則為 2維，概念數量為 10種，各試題都會涉及一至數個概
念不等，概念關聯度的數值為 0到 1之間的實數且為常態分佈，試題的作答時間
9所求得之解答反而有變差的傾向。
表三 題庫為 1000題時之實驗時間
試卷
份數
試題
重複量
試卷
重複量
Greedy
ACOw
100回合 1000回合
5 Ant 10 Ant 5 Ant 10 Ant
3 1 0 0.02 3.33 6.55 34.49 67.99
3 2 6 0.01 3.35 6.78 34.63 69.07
5 1 0 0.04 6.71 13.13 67.82 135.53
5 3 6 0.04 6.54 12.20 64.15 128.58
表三為題庫 1000題時實驗所花費的時間，即使是在挑選過程中使用了窗格
的觀念減少遴選的試題，但是後續在修復的處理上仍舊花費了不少的時間。隨著
螞蟻數量及回合數的增加，運算時間也會之增長。
表四 題庫為 10000題時之實驗時間
試卷
份數
試題
重複量
試卷
重複量
Greedy
ACOw
100回合 1000回合
5 Ant 10 Ant 5 Ant 10 Ant
3 1 0 0.16 9.55 19.41 175.30 361.57
3 2 6 0.18 8.77 17.17 160.04 320.55
5 1 0 0.47 18.51 37.37 293.64 *600.70
5 3 6 0.48 18.67 39.34 294.57 *600.47
表四為題庫 10000題時實驗所花費的時間，其中 10隻螞蟻花費 1000回合組
合五份試卷的情況中，因達到 10分鐘的中止條件，所以螞蟻族群演算法有因此
提早結束。
整體而言，本研究將以多向度試題反應理論為基礎考量試題與試卷重複情況
的平行試卷編製問題，並轉化成可使用螞蟻演算法進行處理的組合最佳化問題。
表一與表二中可以觀察到在大多數的實驗結果中，螞蟻族群演算法明顯較貪婪演
算法具有更好的品質，且依據表三與表四執行時間數據，可以認為在實驗中的大
多數情況下，螞蟻族群演算法都可以在一定時間內取得較為優質的解答。
參考文獻
中文部分
[1] 李昂樺，以螞蟻族群演算法產生植基於試題反應理論之測驗卷，銘傳大學
資訊工程研究所碩士論文，民國 98年。
[2] 高嘉陽，針對大型題庫進行測驗卷編製之研究，銘傳大學資訊工程研究所
碩士論文，民國 96年。
英文部分
1國科會補助出席國際會議報告
101 年 6 月 10 日
報告人姓名 吳怡菱
服務機關名稱及
職稱
交通大學資管所
博士生
會議期間及地點
2012年 6月 10~15日
澳洲布里斯本
國科會核定
補助文號
NSC 100-2221-E-130-025-
會議名稱
（ 中文 ）IEEE世界計算智慧大會
（ 英文 ）IEEE World Congress On Computational Intelligence (WCCI 2012)
發表論文題目
（ 中文 ）以離散族群最佳化進行圖書經費分配之研究
（ 英文 ）Discrete particle swarm optimization for materials acquisition in
multi-unit libraries
報告內容應包括下列各項：
一、參加會議經過
詳見次頁起。
二、與會心得
詳見次頁起。
三、建議
詳見次頁起。
四、攜回資料名稱及內容
詳見次頁起。
五、其它
詳見次頁起。
3三、與會心得
這次研討會期間，有許多國際學者發表有關粒子群體最佳化演算法的文
章，例如：A Fast Particle Swarm Optimization Algorithm for the Multidimensional
Knapsack Problem、Particle Swarm Optimization with Adaptive Bounds、Binary
Particle Swarm Optimization for Feature Selection A Filter Based Approach。同時，
在聽取許多其他學者的研究分享後，發現在各種最佳化演算法當中，目前以粒子
群體最佳化演算法較廣為採用，相關研究議題十分廣泛，包含改善粒子群體最佳
化演算法效能的機制或方法、應用粒子群體最佳化演算於各種問題的探討、多目
標決策與粒子群體最佳化演算。此外，研討會所舉辦的晚宴中，也很榮幸地認識
許多外國學者並且交換心得，。
我在此研討會所發表的論文是探討如何應用族群演算法（PSO）解決圖書館
經費分配的最佳化問題，屬於 Meta-Heuristic的研究領域。由於某些最佳化問題
無法在有效時間內求得最佳解答，因此，透過 Meta-heuristic 可嘗試在有效時間
內尋求接近最佳解的答案。如果下一代電腦的運算效能大幅提昇，則以同樣的有
效時間，所獲得的解答應該可以更接近最佳解，這確實是此研究領域的一大福音。
此次出國參與研討會，除了要感謝國科會對於博士生在出席國際會議費用
上的協助，更要感謝何祖鳳老師、徐熊健老師、林妙聰老師在研究上的指導，還
有在參與國外研討會上的協助。參與此會議後，對於在未來的研究上有相當的助
益，並且期許未來能持續將相關研究成果發表於國際期刊中。
四、建議
再次感謝國科會補助相關經費讓我出席國際會議，並獲得許多寶貴經驗。
相關單位經費的提供的確是助益良多，但是由於國外物價跟國外大相逕庭，不論
從參加會議的交通、會議的註冊會都是筆龐大的開銷，更遑論在當地食宿費用。
建議相關部會能繼續支持補助國內教師及研究生參與國際學術研討會，並且放寬
經費運用限制以及增加補助額度。
5研討會海報論文討論區
研討會贊助期刊討論區
100年度專題研究計畫研究成果彙整表 
計畫主持人：何祖鳳 計畫編號：100-2221-E-130-025- 
計畫名稱：以螞蟻演算法產生植基於試題反應理論之測驗卷 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 1 80% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 1 0 20%  
博士生 1 0 30%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 0 1 80%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
