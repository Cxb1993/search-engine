 1 
行政院國家科學委員會補助專題研究計畫 █ 成 果 報 告   □期中進度報告 
 
網路異常攻擊流量收集與評估系統之研製 
 
計畫類別：▇個別型計畫   □整合型計畫 
計畫編號：NSC 99-2220-E-151-001 
執行期間： 99  年 8 月 1 日至 100  年 7 月 31 日 
 
執行機構及系所：國立高雄應用科技大學資訊工程系 
 
計畫主持人：羅孟彥 
共同主持人： 
計畫參與人員：王聖爵、董耀文、林尚蔚、范揚健 
 
 
 
成果報告類型(依經費核定清單規定繳交)：█精簡報告  □完整報告 
 
本計畫除繳交成果報告外，另須繳交以下出國心得報告： 
□赴國外出差或研習心得報告 
□赴大陸地區或研習心得報告 
□出席國際學術會議心得報告 
□國際合作研究計畫國外研究報告 
 
 
處理方式：除列管計畫及下列情形者外，得立即公開查詢 
            █涉及專利或其他智慧財產權，□一年□二年後可公開查
詢 
 
中   華   民   國  100  年  8  月  15  日 
 
 
 3 
式運作時產生的網路行為來作為判斷之依據，換言
之，是利用惡意程式攻擊時的連線特性的來辨別出
可能是惡意程式的流量。具體目標是在Linux kernel
中上完成一個以軟體實作為主的系統，並進行系統
測試與所設計機制的效能評估，具體的成果將是一
個基於自由軟體的系統，讓中小學或是大專院校網
路能夠下載用於校園網路流量監控。 
目前雖然有許多商業產品可以做到流量辨識，而
且效能可以比我們的系統好，但是其價格均動輒上
百萬，如此價格並非一般企業網路、小型校園或是
家庭網路所能負荷，因此我們希望能以自由軟體的
形式來建構這整個系統，如此一來，即便是中小學
網路也能有類似的系統得以使用。此外，由於我們
將研究並建立一個能在真實網路收集攻擊流量資料
的平台，以求對不同網路攻擊的真實特性以及對網
路的實質影響有更深入的了解，這樣的數據與結果
相信能具有高度的學術價值。 
3.文獻探討 
我們對於文獻的探討分三個方向進行:  
(1) 針對網路流量
的各式辨識方法，根據我們研讀相關文獻的結
果，以下的兩類研究策略或方法較為符合本計畫
的目的，第一類是: 基於行為特徵的異常流量偵
測方法，Karagiannis 於 2005 年 Sigcom 時提出
BLNIC 提出不同於以往使用 Well-known 的
Port-based 比對應用的方法，也不同於以特徵
字串(Signature-based)來比對網路封包內容是
否為某一種網路應用的方法，Blinc 改以研究主
機在網路上所扮演角色與其連線行為，將一個主
機的所有連線集合在一起來做判斷。這個做法主
要是從三個面向來做為分類依據將主機的連結
行為分為三個層級(level)來探討，分別是： 
social level、functional level、application 
level。我們從 BLINC 以及後續很多相關論文中
歸納出以網路行為模式偵測流量的做法確實是
一個可行的研究方向。第二類是 Machine 
Learning 的方法，針對用加密過的封包以及使
用隨機變換埠號的方式來進行資料傳輸的網路
應用，目前許多研究嘗試將 machine learning
領域的相關技術應用到網路流量辨識上，我們研
讀大量相關論文後認為，由於大部分 machine 
learning 方法需要事先建立 training set，而
training 的時間又與物件的多寡有關，物件越
多所需的時間也越長，另外誤判率也過高，因此
我們並不考慮在此計畫中實做相關做法。 
(2) 由於本計畫希望能建立一個異常網路攻
擊的資料蒐集平台，因此我們也對於目前常見的
網路攻擊如 Botnet(僵屍網路)、惡意程式 
(malware)進行文獻分析，由於相關網路攻擊以
及躲避偵測技術越來越進步，眾多的加殼及加密
方法幾乎已經成為惡意程式的必備功能，導致
NIDS (Network Intrusion Detection Systems) 
的誤判率也因而提高，使得 NIDS 已無法正確準
確的辨別惡意程式，相關研究開始轉向以誘捕系
統 (Honeypot)來誘捕網路攻擊，雖然 Honeypot
可以模擬特定的服務、系統弱點以及特定的功
能，以誘發駭客的攻擊，並具備資料搜捕機制，
可收集攻擊資料並提供分析，但是 Honeypot 最
大的問題在於部署涵蓋性，雖然許多研究開始研
究 Honeynet 技術，但仍有涵蓋率問題。 
(3) 我們也分析與研究許多工業界相關系統，目
前的網路設備對於異常流量的處理不外乎三種
方式: 發出警示通知管理者、可協同部份外部的
網路設備協助阻擋產生攻擊的流量、或使用 
protocol 本身機制進行阻擋。警示只能很單純
的盡到告知之義務，無法因應短暫且快速的攻擊
行為，而透過 protocol 本身機制進行阻擋僅能
發揮部份功能，本計畫所實作的系統則可互補於
目前的這些做法。 
4. 研究方法 
根據文獻分析後我們提出的研究方法與架構如
圖一所示，我們將上述各項目標轉換成本系統的各
項需求子系統： 
 有效的封包攔截機制 
 連線行為特徵擷取 
 網路行為分析 
 資料匯出及管理 
結合上述四個子系統，以達成本系統之網路封包
擷取、網路行為分析及攻擊資料記錄與評估之目
 5 
Destination Port、IP Protocol)當作 Key，利用
一個有效率的資料結構將其記錄下來，然後當每一
個封包進入系統時則根據相同的欄位來搜尋該資料
結 構， 判斷是 否屬 於一 個已 被判定 成功的
session，如果是的話則無須再進行 content-based
的分析。並且記錄每筆流量的重要網路行為與流量
相關資訊。 
4.3 網路行為分析模組 
為方便研究者或網管人員根據前述機制所儲存
的資料來研究網路行為特性，因此我們設計相關機
制能夠依據使用者所給定的範圍與參數，將網路行
為以連線發起者(IP與 Port)以及連線對象的方式表
現，例如圖四即是我們系統動態畫出的圖。 
 
圖四 
從這個圖，管理者可以得知可以發現該主機正對
4662/tcp 進行”掃描式”的連線嘗試，而多台遠端
主機也正在嘗試對該主機的 4662/tcp 進行連線，
其中有一台遠端主機不但接受該主機之 4662/tcp連
線，也同時對該主機的 4662/tcp 進行連線，配合上
流量辨識演算法的結果，網管者因而可以確認這是
一個 P2P 的軟體所造成的網路行為。 
4.4 系統整合與管理系統實作 
 我們透過Linux Kernel的 Netlink機制來實作
一個子系統，以做為 User-Space 應用程式和核心交
換訊息的機制，得以取得 Connection Tracking 所
儲存的連線特徵資訊，以及流量辨識演算法辨識的
結果，並將資料儲存於資料庫內，以利長期儲存並
分析是否含有不當流量的情形發生。除此之外，我
們還撰寫相關的管理程式與一個 Web-based 管理介
面，來呈現本系統所擷取及分析的流量資訊，使網
管人員自行輸入欲查詢的條件，輕易的掌握各種網
路流量的資訊。使用者並不需要在電腦上安裝額外
的軟體，只要有內建瀏覽器即可隨時上線了解其網
路的狀況。這個界面的實作上本系統大量的使用
Ajax 技術，能讓使用者在不需要安裝額外 plug-in
的狀態下，能夠享受到便利且具高度互動性的使用
介面。 
所有資料存進資料庫後，管理者或研究人員可以
隨時查詢某一天或某一時段的流量資料與網路行為
統計，舉例來說，網管人員想了解每天在網路中有
使用什麼流量、比例如何，可以進入流量辨識結果
分析來查詢單日辨識結果、細項分析，如圖五所示。
本系統提供不同層次的查詢: 
1.單日辨識結果：每小時的網路應用分析。 
2.細項分析：針對某日某小時的網路流量所屬
應用做更細部的分析(如圖六)。 
3.網路行為分析 
 
圖五 
 
圖六 
5.成果自評 
本計畫的成果可分為三個方面: 
一、 系統實作方面: 本計畫的具體成果是完成一個
以軟體實作為主的網路即時攻擊資料收集與評
國科會補助計畫衍生研發成果推廣資料表
日期:2011/12/21
國科會補助計畫
計畫名稱: 網路異常攻擊流量收集與評估系統之研製
計畫主持人: 羅孟彥
計畫編號: 99-2220-E-151-001- 學門領域: 自由軟體暨嵌入式系統
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
實際運用於南區區域教學資源中心流量管理 
參與專題生 獲得「100 年度全國微電腦應用系統設計製作競賽」佳作！，以及
「2011 第 16 屆全國大專校院/社會人士 資訊服務創新競賽 資訊技術應用組」
榮獲 第一名！ 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
