        
 
 2
?????????????????
????? 
7. ?????????????????
? 
 
Currently most flow algorithms and grid 
generators of computational fluid dynamics are 
based on the frame of work of body-fitted grids.  
The generation of suitable body-fitted grids 
around complex geometries has always been 
one of the major difficulties encountered in 
computational fluid dynamics.  Recently the 
immersed boundary methods based on 
non-body-fitted grids are becoming popular 
because they greatly reduced the complexities 
of grid generation.  The main focus of the 
development of such methods is the modeling 
of the effects of an arbitrary immersed body on 
the flow field using a fixed non-body-fitted 
grid. 
In a previous work the author has 
developed a new immersed boundary method 
that solves the incompressible Navier-Stokes 
equations on unstructured Cartesian grids.  
The main idea is to view the interior of the solid 
as being occupied by the same fluid as outside, 
except that the velocity field inside the body is 
determined by a prescribed motion or by some 
appropriate structural equations.  In the cells 
containing the solid-fluid interface, the volume 
of body function is used to obtain an average 
velocity base on the fluid and the body velocity.  
The pressure inside the body obeys the same 
pressure Poisson equations as the pressure 
outside.   
This project intends to combine the method 
of dynamic adaptive local mesh refinement and 
the immersed boundary method to establish the 
simulation tool for 2D and 3D flapping wing 
aerodynamic computations.  The immersed 
boundary method is capable of handling 
complex geometry using Cartesian mesh, hence 
has eluded the difficulty of grid generation in 
traditional CFD.  The method of dynamic 
adaptive mesh refinement efficiently distribute 
the mesh cells to where they are needed, 
effectively reducing the required mesh size and 
computation time.  This project also intends to 
improve the forcing source term using the 
Ghost Cell Method, in an attempt to improve 
the accuracy of the representation of the 
immersed boundary.  The flapping wing 
undergoing the Figure-8 motion will be treated 
as the validation examples.  The effects of the 
relevant parameters of the flapping wing 
motions to the flapping wing aerodynamics will 
be examined. 
Keywords: Immersed Boundary Method, 
Implicit Pressure Correction Method,  Parallel 
Computing, Dynamic Local Refinement, 3D 
Flapping Wing Flow Field. 
 
Introduction 
?????????????????
???(Cartesian Meshes)????????
?[1-9]????????????????
???????????????????
??????????????????
???????????????????
???????????????????
???????????????????
??(Non-Body Fitted)??????????
???????????????????
???????????????????
???????????????????
???????? (Immersed Boundary 
        
 
 4
Poisson Eq.? 
0
*
2 =∆
⋅∇−∇
t
vn
vv
φ              (4) 
????? Poisson Eq.??????? nφ
??????(3)????????????
????? 1+nvv ??? 1+nP ??? 1+nvv ? 1+nP
?????(2)????????? 1+nθ ??
?????(2)?(3)?(4)???? 1+nθ ???
???????????????????
? ? (Implicit Fractional Step Pressure 
Correction Method)? 
 
Finite Volume Discretization 
??????????????
(Cell-Centered Finite Volume Method)???
????????? (3D Locally Refined 
Cartesian Meshes)????????????
???????????????????
??????????????????
(Vertex)????????????????
???????????????????
???????????????????
????????? 
    ???(2)?????????????
????????????? (Surface 
Integral)???????????????
???????????????????
???????????????????
(Differencing)?????????????
???????????????????
???????????????????
??????????? 
( )RfLfMf QQQ += 5.0         (5) 
(5)????  ’ f ’????? (Face)??
? ’ M ’? ’ L ’ ? ’ R ’ ?????????
????(Mean)????????(Left State)
?????????(Right State)? 
    ???(2)?????????????
????????????? 
∑ ∆⋅








∆= CS
M
f
RL
inv Snvw
v
u
V
R ˆ1
/
v
θ
     (6) 
???? nˆ??????????? (Unit 
Surface Outward Normal)? RL / ??????
?(Upwind)??????????? 
( ) ( )( )


≤⋅•
>⋅•=•
0ˆ
0ˆ
/ nvif
nvif
M
f
R
M
f
L
RL v
v
    (7) 
??????????????????? 
∑ ∆








⋅
⋅
⋅
∆= CS
M
fP SPkn
jn
in
V
R
0
ˆˆ
ˆˆ
ˆˆ
1     (8) 
iˆ? jˆ? kˆ? x?y?z????????? 
???????????????????
???????????????????
????????? 
∑ ∆










⋅∇
⋅∇
⋅∇
⋅∇
∆= CSvis S
n
nw
nv
nu
V
R
ˆ
Pr
1
ˆ
ˆ
ˆ
Re
1
θv
v
vv
vv
          (9)  
???? 








=
0
Re
1
2 θ
θ
θ
z
y
x
Gr
Gr
Gr
H              (10) 
xGr ? yGr ? zGr ???? x?y?z?????
? Grashof Number???????????
???????????(2)???????
        
 
 6
????????????????
(MomentumForcing)[3]??????????
??????????????? 1* += nBvv vv
? 1* += nBθθ ??? 10 << Bφ ????????
???????????????????
???????????????????
???????????????????
???[7,8 ] 
( )
0
1
1
1
*
1
***
1
32
*
1
=



∆
−∆+



 ++−+∆
+−∆−
+
−
t
QcQcV
RHRR
t
QcQcQcV
n
B
B
n
Pvisinv
nn
B
φ
φ
                                  (14) 
???????????????????
???????????????????
???????????????????
????????(14)??????????
???????????????????
???????????????????
??? Poisson?????????????
? Divergence-free ???????(Source 
Term)?????????????????
???????????????????
???????????????????
???????????? 
?????????????????
???????????????????
(Gauss ‘s Theorem)???????????
??????????????????
???????????????????
????? 
∑  ∇+∇−∆= cell BBody vPVf
vvv 2
Re
1φ     
∑  ∇∆= cell BBody VH θφ 2RePr
1        
??????????????????
?? 
 
Parallel Computing 
    ?????????????????
???????????????????
???????????????????
??????????????(Sub-domain)
???????????????????
???????????????????
???? processor??????? processor
???????????????????
???????????????????
??? processor ????????????
???????????????????
???????? processor ???????
??????????????????? 
    ???? processor ?????????
???????????????????
???????????????????
??????? processor ????????
??????????????MPI(Message 
Passing Interface, MPI)?????????
processor ???????????????
???????????? (Compact 
Scheme)????????????????
???????????????????
???????????????????
???????????????????
??????? 
    ?????????????????
???????????????????
???????????????????
???????????????????
???????????????????
???????????????????
???????????????????
???????????????????
???????????????????
???????????????????
?? 
(15) 
        
 
 8
??????????? CR ? FiR ?(2)??
??????????????????
??  
 
Results  
1????????? 
??????????????????
???????????????????
???????????????????
???????????????????
??? DzyxD 15,,15 ≤≤− ?D??????
???????????????(Upwind 
difference) 0=

 ∂∂+∂∂ xQUtQ n ? nU ????
?????(Normal)???????????
?(Free Stream)??????? νDU∞=Re ?
?? 100? 
    ? 1 ???????????????
???? 4 ???????? 1 ?????
? ? ? ? ? ? ? ? ? ? ? ? ? ? ?
4
22
2
1 DU
DCD πρ ∞
= ?Average Nusselt Number 
dANuANu ∫= 1 ??????? Terminal cells
???????????????????
????????? 8 ?????????
????????? 8 ?????????
???????????????????
??????????? 8 ???????
??????? 3 ???? 4 ??????
???????????????????
??????????????????
( 10 << Bφ )???????????????
???? 4????????? VOB???
?????(r = 0.5)???????????
???????????????????
???????????????????
? 0.02%??? CD? Nu?????????
????? 
2????????? 
    ?????? 4 ??????????
??????????????????
??????????????? 
(1) 2 processors: ?? y=0????? 
(2) 4 processors: ???? y=0?z=0???
?? 
(3) 8 processors: ???? y=0?z=0?x=0
????????????? x???? 
????? 
Hardware:  AMD 4600 Dual Core CPU 
          2G RAM/CPU 
          Network : 1Gbps 
          MPI : LAM MPI-7.1.2 
          Linux OS : Fedora 5.0/6.0 
 No. of Processors : 8 processors (4CPU) 
???????????????????
???????????????????
?????????? processor ?????
???????????????????
??????????? 
dataflowelapsed TTT +=               (18) 
??????????????????
?????????(Speed-Up)????? 
         
parallelelapsed
serialelapsed
T
T
UpSpeed
_
_=−    (19) 
serialelapsedT _ ???? processor ?????
?? parallelelapsedT _ ???? processor????
??? 
? 2 ???? processor ???????
????????? processor ??????
        
 
 10
???????????????????
??????????? 6 ???????
???Re????Nu???? 
 
(3) Unsteady flow 
?? Re=300????????????
??????????(Vortex Shedding)??
?????????????????(y=0)
???????? 10??????????
???????????????????
???????????????????
???????????????????
??????????? 11???????
???????????????????
???????????????????
????????????? z??????
?????????????? Strouhal 
Number 
∞
= UfDSt ?f??????????
?????????Nu?? 7??????
??? 
 
4?Oscillating Sphere in a quiescent fluid 
    ?????????????????
??????(Harmonic Oscillation)????
???????????????????
? ? ? ? ? ? ? ? ? ? ? ? ? ? ?
( ) tUtU ωsin0= ? 0U ??????????
?? Tπω 2= ??????T ???????
????? νDU 0Re = ??? Re=40?
2.3=ω ?????? DzyxD 8,,8 ≤≤− ???
??????????????? 2nd-order 
backward?????? 80??????(Time 
Step)? 
    ?????????????????
???????????????????
????????? 12?????????
???????????????? 13 ?
???????????????????
???????????????????
???????????????????
???? 8??????????? Uniform 
Refinement? AMR-1??????????
???????????????????
????????(Interface cell)?????
????? Terminal cell??????? 2?
?????? AMR-2??????????
??????????????? 4 ???
???? Terminal cell ?????????
Uniform Refinement ??? Terminal cell ?
???????????????????
???????????????????
??????? 14??? 6???????
???????????????????
????Mei[20]????????????
???????????????????
?? Uniform Refinement? AMR-1????
???????????????????
???? AMR-2????????????
????????????? 
 
5?Flapping Wing 
    ????????????????
Wang et al.[21]?????????????
???????????????????
???????????????????
???????????????????
???????????????????
15??????????? Stroke Plane??
???????????????????
????????????????(Wing 
Axis)???????????????? 15
???? Stroke Plane??????? β ??
??(Inclination Angle)?ϕ ??? Stroke Plane
        
 
 12
2.155Re == vLU refref ?????????
secT 4= ?????? 214cm???????
????????? 16??? yz-plane??
?????????(Symmetry Plane)???
???????????????????
?????(Wing Root)?????????
c21 ?????????????????
???????????????????
??????????????????? 
 
(1) ??????????????? 
    ?????????????????
?????????????????? Stoke 
Plane ??????? o0=β ???????
???????????????????
????????????(Hovering)???
???????????????????
???????????(Advanced Rotation) 
4πφ = ????? (Symmetrical Rotation) 
0=φ ?????(Delayed Rotation) 4πφ −= ? 
    ? Birch et al.[23]?????????
65%?? (Wing Span)?????????
???????????????????
???????????? (Circulation)?
??????????(Trailing Edge Vortex)
???????????????????
??????????????????
??????????? 65%??????
????????????? 
    ? 17(a)? 4πφ = ??65%??????
???????????????????
???????????????????
????????????????(Leading 
Edge)?? 17(b)??????(20)?????
??????????(21)????????
???????????????????
???????????????????
???????? 17(a)?????????
?(Left Stroke)?????????? o58 ??
??????????????????
o45 ??????????????????
???????????? o122 ?????
???? (Right Stroke) ????????
?????? o135 ???????????
???????????????????
???? 17(b)?????????????
???? 
    ? 18(a)??????????????
????(Lift Coefficient)?????(Drag 
Coefficient) ? ? ? ? ? ? (Radial Force 
Coefficient)???????????????
???????????????????
???????????????????
???????????????????
???????????????????
?????????????(??)????
???????????????????
???????????????????
???????????? (Order of 
Magnitude)???????????????
???????????????????
???????????????????
???? 0.20???????? 41021.4 −× ?
???????????????????
??????????????????
???????????????????
??????????????????
???????????????????
???????????????????
        
 
 14
???????????????????
???????????????????
???????????????????
???????????????????
???????????????????
???????????????? 
    ? o0=β ??????????????
??????? 4πφ −= ?? 22(a)? 65%?
???????????????????
???????????(Left Stroke)???
?????????????? o122 ?
o58 ??????????????????
???????????????????
??? 22(b)??????????????
???????????????????
???????????????????
?????(??)????????????
???????????????????
????????????? 31057.9 −× ?
41027.4 −× ???????????????
????????? 23 ????????
??? 65%??????????????
???????????????????
???????????????????
???????????????????
???????????????????
??????????????? 
 
(2) ??????????????? 
    ??????( φ )?????????
???????????????????
?????( β )????????????
????????????????????
??????????????? o0=β ?
o30 ? o45 ? o60 ???????? 24(a)??
???? 4πφ = ?????? o60=β ??65%
???????????????????
??????????????? 18(b) 
o0=β ?????????????? o60 ?
Stroke Plane??????? 24(b)? o0=β ?
o30 ? o45 ? o60 ?????????????
???????????????????
???????????????????
o60=β ??????????????? β ?
???????????????????
???????????????????
???????????????????
???????????????????
???????????????????
???????????????????
??????????????????
???????????????????
???????????????????
???????????????????
???????????????????
???????????????????
???????????? 9 ??????
????????? β ?????????
??????(?? 24(b)???)?????
???????????????????
?????(?? 24(b)???)??????
???????????????????
???????????? β ??????
???????????(?????)??
        
 
 16
351-370. 
[10] M. J. Berger and J. Oliger, “Adaptive Mesh 
Refinement for Hyperbolic Partial Differential 
Equations”, J. Comput. Phys., Vol. 53(1984), pp. 
484-512. 
[11] M. J. Berger and P. Colella, “Local 
Adaptive Mesh Refinement for Shock 
Hydrodynamics”, J. Comput. Phys., Vol. 
82(1989), pp. 64-84. 
[12] D. M. Greaves and A. G. L. Borthwick, 
“On the Use of Adaptive Hierarchical Meshes 
for Numerical Simulation of Separated Flows”, 
Int. J. Numer. Methods Fluids, Vol. 26(1998), 
pp. 303-322. 
[13] T. A. Johnson and V. C. Patel, “Flow past a 
Sphere up to a Reynolds Number of 300’’, J. 
Fluid Mech., Vol. 378(1999), pp. 19-70.  
[14] E. Achenbach, “Vortex Shedding From 
Spheres”, J. Fluid Mech., Vol. 62(1974), part2, 
pp. 209-221. 
[15] H. Sakamoto and H. Haniu, “A Study on 
Vortex Shedding From Spheres in a Uniform 
Flow”, Trans. ASME: J. Fluid Engng., Vol. 
112(1990), pp. 386-392. 
[16] P. Bagchi, M. Y. Ha and S. Balachandar, 
“Direct Numerical Simulation of Flow and Heat 
Transfer From a Sphere in a Uniform 
Cross-Flow”, J. Fluids Eng., Vol. 123(2001), pp. 
347-358. 
[17] S. Marella, S. Krishnan, H.Liu and H.S. 
Hdaykumar, “Sharp Interface Cartesian Grid 
Method I: An Easily Implemented Technique for 
3D Moving Boundary Computations”, J. 
Comput. Phys., Vol. 210(2005), pp.1-31. 
[18] B. Fornberg, “Steady Viscous Flow Past a 
Sphere at High Reynolds Numbers”, J. Fluid 
Mech., Vol. 192(1988), pp. 471-489. 
[19] S.D. Dhole, R.P. Chhabra and V. Eswaran, 
“A Numerical Study on the Forced Convection 
Heat Transfer From an Isothermal and Isoflux 
Sphere in the Steady Symmetric Flow Regime”, 
Int. J. Heat Mass Transfer, Vol. 49(2006), pp. 
984-994. 
[20] R. Mei, “Flow due to an Oscillating Sphere 
and an Expression for Unsteady Drag on the 
Sphere at Finite Reynolds Number”, J. Fluid 
Mech., Vol. 270(1994), pp. 133-174. 
[21] Z. J. Wang, J. M. Birch and M. H. Dikinson, 
“Unsteady Forces and Flow in Low Reynolds 
Number Hovering Flight: Two-Dimensional 
Computations vs Robotic Wing Experiments”, J. 
Exp. Biol., Vol. 207(2004), pp. 449-460. 
[22] S. P. Sane and M. H. Dikinson, “The 
Control of Flight by a Flapping Wing: Lift and 
Drag Production”, J. Exp. Biol., Vol. 204(2001), 
pp. 2607-2626. 
[23] J. M. Birch and M. H. Dikinson, “The 
Influence of Wing-Wake Interactions on the 
Production of Aerodynamics Forces in Flapping 
Flight”, J. Exp. Biol., Vol. 206(2003), pp. 
2257-2272.
        
 
 18
 
? 4???????? Re=150??????? 
Reynolds No.                              150 
                                         CD        LS/D       uN        
Clift et al.[17]                   0.89                            
Johnson & Patel[13]             0.90       1.20         
Marella et al.[17]                0.85       1.19        
4.0
1
624 +++= DDD RR
C [5]        1.013                                             
Present               0.871      1.15       7.812 
 
 
 
? 5???????? Re=200??????? 
Reynolds No.                              200 
                                        CD        LS/D       uN        
Johnson & Patel[13]             0.771      1.439         
Bagchi et al.[16]                0.77       1.43       9.12 
4.0
1
624 +++= DDD RR
C [5]        0.916 
Whitaker[16] 9.53 
Ranz[16]  8.68 
Dhole[19]                     0.7442   1.43             
Fornberg[18]                   0.768      1.436 
Present                      0.755      1.389      8.759 
 
 
? 6???????? Re=250??????? 
Reynolds No.                              250 
                                         CD        CL       uN                           
Kim[6]                        0.701        0.059 
Bagchi et al.[16]                 0.70                 9.95 
4.0
1
624 +++= DDD RR
C [5]       0.853 
Whitaker[16]                                          10.42 
Ranz[16]                                         9.55 
Present                             0.683       0.0615     9.351 
 
        
 
 20
? 9??????????????????????????????????? 
 
Flapping Motion       LC           DC           RC    
                   4
πφ =        
                   o0=β            0.20        41021.4 −×     21039.3 −×  
                   o30=β            0.17       21074.9 −×−   21035.3 −×           
                   o45=β            0.14      13.0−          21023.3 −×  
                   o60=β            0.10        15.0−         21098.2 −×  
                   0=φ         
                   o0=β             0.14        31044.1 −×     21052.3 −×  
                   o30=β            0.12        21072.6 −×−   21044.3 −×         
                   o45=β            0.10        21024.9 −×−    21029.3 −×        
                   o60=β           21023.7 −×   11.0−         21000.3 −×      
                   4
πφ −=          
                   o0=β             31057.9 −×    41027.4 −×     21072.5 −×     
                   o30=β            31010.9 −×   31099.9 −×−   21078.7 −×                  
                   o45=β            31026.8 −×    21033.1 −×−    21038.5 −×       
                   o60=β            31095.6 −×    21097.1 −×−   21087.4 −×    
        
 
 22
X
Y
Z
Re=250, Streamlines
X
Y
Z
Re=250, Cp-Contour
X
Y
Z
Re=100, Temperature Contours
 
 
 
 
                                            
 
    
 
 
 
 
 
 
 
? 5???????? Re=100??? z=0??????????? 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
? 6???????? Re=250??? z=0???     ? 7???????? Re=250??? z=0? 
?????                                       ???? Cp???? 
                                     
 
 
 
 
 
        
 
 24
X
Y
ZX
Y
Z
 
 
? 12???????????????              ? 13??????????????? 
                                                      ???????????? 
 
 
 
time
D
ra
g
26 28 30 32 34 36-12
-10
-8
-6
-4
-2
0
2
4
6
8
10
12
Mei
Uniform Refinement
AMR-1
AMR-2
 
            ? 14??????????????????????? 
        
 
 26
t/T
R
ot
at
io
n
S
pe
ed
(r
ad
/s
ec
)
0 0.25 0.5 0.75 1-4
-2
0
2
4
t/T
An
gl
e
of
at
ta
ck
(r
ad
.)
0 0.25 0.5 0.75 10
1
2
3
t/T
(r
ad
/s
ec
)
0 0.25 0.5 0.75 1-6
-4
-2
0
2
4
6
αd
dt

(a) 
 
 
 
  
 
 
 
(b) 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
? 17? (a) 65%??????????????????( 4πφ = ? o0=β )??? 
(?????????) 
 (b) ?????????????????????????? 
Left Stroke Right Stroke 
Left Stroke 
Right Stroke 
t=0 t= 4T  t= 2T  
t= 2T  t= 43T t=T  
        
 
 28
 
                                                                                          
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
? 19? 65%??????????????( 4πφ = ? o0=β )???(Vorticity)????? 
 (?????????????????) 
        
 
 30
 
                                                                                          
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
? 21? 65%??????????????( 0=φ ? o0=β )???(Vorticity)????? 
     (?????????????????) 
        
 
 32
 
                                                                                         
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
? 23? 65%??????????????( 4πφ −= ? o0=β )???(Vorticity)????? 
  (?????????????????) 
        
 
 34
 
                                                                                          
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
? 25? 65%??????????????( 4πφ = ? o60=β )???(Vorticity)????? 
   (?????????????????) 
        
 
 36
t/T
D
ra
g
C
oe
ffi
ci
en
t
0 1 2 3 4-1.5
-1
-0.5
0
0.5
1
1.5
t/T
R
ad
ia
lF
or
ce
C
oe
ffi
ci
en
t
0 1 2 3 4-0.5
0
0.5
t/T
Li
ft
C
oe
ffi
ci
en
t
0 1 2 3 4-1.5
-1
-0.5
0
0.5
1
1.5
(a)  
 
 
 
 
 
 
 
 
(b) 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
? 27?(a) 65%????????????????????( 4πφ −= ? o60=β )????????
????? (b) ?????????????????????????????(???
o0=β ???? o30=β ????? o45=β ???? o60=β )       
Down Stroke Up Stroke 
???????????? 
                                                             
???? NSC96-2221-E006-179-My2 
???? ??????????????????????????????? 
?????? 
??????? 
??? ????????? 
?????? Aug 20-22, 2007, Rhodes, Greece 
???? The 6
th IASME/WSEAS International Conference on Fluid Mechanics 
and Aerodynamics (FMA’08) 
?????? A Ghost Cell Method for the Computation of Incompressible Flows with Immersed Bodies 
 
(?) ?????? 
FMA’08 ???????IASME/WSEAS???????????????
(The 6th IASME/WSEAS International Conference on Fluid Mechanics and 
Aerodynamics)??World Scientific and Engineering Academy and Society(WSEAS)?
????????????????????????????????????
???????FMA08????????????????The 6th IASME/WSEAS 
International Conference on Heat Transfer, Thermal Engineering and Environment 
(HTE08)??????????FMA08???????????????????
????????????????? 
8?16?-8?19? 
???????22:10????????????????????????
??????????24?????????????????????????
?8/20??????Rhodes Island, Rhodes, ?????  
 8?20? 
?????????? 
???8:00AM???17:00??????Plenary Lechture?????????
????????????: 
???CFD?????????????????????????????
?????????????????? 
“Simulation of vortex breakdown in an enclosed cylinder as a preliminary study of the 
draft tube vortex rope creation” by Pavel Rudolf 
????Brno University of Technology?????CFD???????????
??????????? 
??????” A Ghost Cell Method for the Computation of Incompressible Flows 
with Immersed Bodies”?????Ghost Cell Methd (?????)?????????
????????????????????????????????????
????????????????CalTech?????Paul E. Dimotakis????
???????????Ghost Fluid Method?????????????????
????????????????????????????????: “very 
clever”?Ghost Cell Method????Ghost Fluid Method???????Prof. 
Dimotakis?????? 
?????? 
8?22? 
?????: 
“Computational Validation of Experimental Aerodynamic Predictions of a Car” by 
Manan Desai, Salim Channiwala, Hemant Nagarsheth 
???CFD???????????????????????????CFD
?????????? 
 “Contribution to the study of a free-surface supercritical flow above an obstacle: theory 
and laboratory work” by Karima Bouzelha-Hammoum, Malek Bouhadef, Tahar Zitoun 
and Taous Guendouzen-Dabouz 
????????????????????????? 
“A method to predict the flapping wing MAV global aerodynamic performances” by 
A Ghost Cell Method for the Computation of Incompressible Flows with 
Immersed Bodies 
 
DARTZI PAN and TZUNG-TZA SHEN 
Department of Aeronautics and Astronautics 
National Cheng Kung University 
Tainan, Taiwan ROC 
dpan@mail.ncku.edu.tw 
 
 
Abstract: - The incompressible Navier-Stokes equations are solved by an implicit pressure correction method on 
Cartesian meshes with local refinement.  A simple and stable Ghost Cell method is developed to treat the 
boundary condition necessary for the immersed bodies in the flow field.  Multigrid methods are developed for 
both velocity and pressure correction to enhance the stability and convergence of the solution process.  The 
spatial accuracy of the method is second order in 2L  and ∞L  norms for both velocity components.  Various 
steady and unsteady flows over a 2D circular cylinder and a 3D sphere are computed to validate the present 
method.  
 
Key-Words: -  Ghost cell method, Cartesian mesh, Local refinement, Incompressible flow, Immersed boundary. 
 
1   Introduction 
Recently numerical methods for solving 
incompressible flows on fixed Cartesian meshes have 
gained much popularity for their relative ease in 
treating complex immersed bodies [1-6].  In these 
methods the body surface is not aligned with any grid 
line or surface, and various treatments are developed 
to simulate the effects of the boundary conditions 
required on the body surface.  The immersed 
boundary method [1] introduces a momentum forcing 
term to the Navier-Stokes equations using Dirac delta 
function.   This momentum forcing term represents 
the surface forces exerted on the fluid flow by the 
immersed elastic or solid bodies.  In virtual boundary 
method [2,3], the momentum forcing term is obtained 
using a feedback control loop to asymptotically 
enforce the no-slip boundary condition at the 
immersed boundary surface.  The direct forcing 
immersed boundary method [4, 5] constructs the 
momentum forcing term in the frame work of 
discretized equations such that the appropriate 
boundary conditions are enforced at the immersed 
boundary in the discretized system.  In the original 
direct forcing method, the forcing is introduced to the 
first grid cells or nodes external to the immersed body.  
In some later development [6], the variable values of 
the first cells or nodes inside the immersed body are 
being extrapolated from the flow domain external to 
the body.  The latter approach is sometimes called the 
Ghost Cell method. 
In this paper the concept of ghost cell is adopted 
to treat the immersed boundary on Cartesian meshes.  
To enhance the accuracy around the immersed 
boundary, the local refinement capability on a 
Cartesian mesh is also developed.  As mentioned in 
Ref. [6], both linear and higher order reconstruction 
schemes for ghost cells can yield overall second 
order accurate solution.  But high order 
reconstruction schemes require more stencil points 
and are more likely to introduce spurious oscillations.  
Thus, at least for low and moderate Reynolds number 
flows, a stable first order reconstruction is preferred 
when the flow solution can be spatially second order 
accurate.  The scheme developed in this work has no 
ambiguity in choosing the stencil point and the 
extrapolation to the ghost cell will not introduce 
numerical instability.  The present scheme is second 
order accurate in space.  As validation examples, 
various steady and unsteady flows over a 2D circular 
cylinder and a 3D sphere are computed and compared 
with the published data.   
 
 
2 Implicit Pressure Correction Method 
The integral form of incompressible 
Navier-Stoked equations can be written as  
01
0
=+⋅∇−⋅+∂
∂
=⋅
∫∫∫∫
∫
CSCSCSCV
CS
SPdSdv
Re
SdvvdVv
t
Sdv
vvvvvvvv
vv
    (1) 
where vv  and P are Cartesian velocity and pressure, 
Re is Reynolds number, CV is the control volume 
under consideration, CS is the boundary surface of 
CV, Sd  is a differential surface area vector of CS 
pointing outward.  All variables in Eq. (1) are 
The ghost cell velocity ghostv
v  determined by Eq. (6) 
will implicitly enforce the no-slip boundary condition 
at the projection point. 
The linear reconstruction model described above 
is quite simple, and can be extended to 3D problems 
in a straightforward manner, with a choice of 
minxΔ= 3δ  in 3D.  The simplicity of the model is 
attributed to the choice of an appropriate constant δ  
for all image points.  If we choose a shorter δ , the 
number of fluid centers enclosing  the image point 
may be less than four in 2D or less than eight in 3D, 
and the stencil points for the reconstruction of imagev
v  
will vary.  On the other hand, if we choose a longerδ , 
the estimated velocity gradient will not be a good 
representation of the true velocity gradient in the 
vicinity of the boundary surface.  Furthermore, the 
current choice of δ  ensures that projghost rr vv −>δ  in 
Eqs. (5) and (6), and thus avoids the unstable 
situation when some stencil point is too close to the 
boundary surface. 
 
 
5 AERODYNAMIC FORCES 
To compute the aerodynamic forces acting on the 
immersed body, the surface integral of pressure and 
viscous stress is needed: 
)Sv
Re
SP(f
surface
Body
vvrvv Δ⋅∇+Δ−= ∑ 1                   (7) 
where the summation is performed on all boundary 
surface segments of the body.   
 
 
6 Spatial Accuracy 
To verify the order spatial accuracy of the current 
scheme, a driven cavity flow with an immersed 
cylinder at the center is computed.  The upper wall of 
the cavity moves toward right at uniform velocity, 
which in turn drives the flow inside the cavity.  The 
Reynolds number based on the cavity length, wall 
velocity and the viscosity of the fluid is 1000.  The 
cylinder diameter is 0.25.  The boundary condition on 
the cylinder wall is handled by the ghost cell method 
described above.  A sequence of regular Cartesian 
grids, with mesh size ranging from 3232 ×  to 
512512×  is used in the computation.  The finest grid 
solution is used as the reference solution to be 
compared with.    The flow solutions at cell vertices 
inside a square of length 0.75 enclosing the cylinder 
are compared.  In Fig. 2, 2L  and ∞L  norms of the 
error of velocity on various grids are plotted.  Two 
curves showing first order and second order 
convergence are also displayed for references.  It is 
obvious that the spatial accuracy of the current 
scheme is second order in both norms for both 
velocity components. 
 
 
7 Flows over a Circular Cylinder 
The steady and unsteady flows over a circular 
cylinder of unit diameter at Re=40 and 200 are 
computed a Cartesian grid.  The grid shown in Fig. 3 
is locally refined around the cylinder to have about 
384 cells cut by the cylinder surface.  The outer 
boundaries are 30 diameters away from the cylinder, 
either in parallel or perpendicular to the free stream.  
The uniform flow condition is set to the inflow and 
the two side boundaries.  The downstream boundary 
follows the upwind differenced equation of 
0=∂∂+∂∂ )x/v(U)t/v( n vv , where nU  is the normal 
outflow velocity at the boundary.   
For the steady cases of Re=40, the Euler implicit 
method is used with a 50.t =Δ , which amounts to a 
maximum CFL number around 20 in the steady state.    
For convenience, one multigrid V cycle going 
through the coarse grids is counted as equivalent to 
one implicit relaxation step on the finest grid.  The 
infinity norm of the steady state residual for fluid 
cells dropped 4 orders of magnitude in less than 500 
steps.   The computed streamlines for Re=40 case are 
plotted in Fig. 4.  A separation bubble behind the 
cylinder is clear.  The streamlines around the cylinder 
are smooth, indicating that the ghost cell treatment 
has captured the immersed boundary on the refined 
Cartesian grid.  Figure 5 shows the computed 
pressure contours.  Note that the pressure inside the 
cylinder adjusts itself automatically to the pressure 
field outside.  The pressure contours intersect the 
cylinder wall in a nearly orthogonal manner.  The 
pressure coefficient on the immersed boundary 
segment center is interpolated using the surrounding 
cell vertex values and plotted in Fig. 6.  The data from 
Fornberg [9] are also included for comparison.  The 
two results generally agree with each other very well.    
For the unsteady cases of Re=200, the second 
order backward difference scheme is used for time 
integration with a time step 10.t =Δ .  The time step 
is chosen such that the expected vortex shedding 
cycle takes about 50 steps to complete.  The vorticity 
contours are shown in Fig. 7.  The unsteady vortex 
shedding behind the cylinder is clearly seen.  Table 1 
and 2 list for Re=40 and 200 the computed lift 
coefficient (Cl), drag coefficient (Cd), the bubble 
length (Lw) normalized by the diameter (d), and the 
Strauhal number (St).  The comparisons between the 
a Fractional-Step Approach, Comp. & Flu., 
2001; 30: 829-851. 
 
Table 1.  Re=40 flow over a 2D Circular Cylinder 
Method Re Cd Lw/d 
Present 40 1.517 2.258 
Fornberg (1980) 40 1.50 2.24 
Ye et al.(1999) 40 1.52 2.27 
 
Table 2.  Re=200 flow over a 2D Circular Cylinder 
Method Re Cd Cl St 
Present 200 1.313 ± 0.325 0.164
Liu et al. 
(1998) 
200 1.310 ± 0.339 0.165
Kiris and 
Kwak (2001)   
200 1.270 ± 0.32 0.165
 
Table 3. Re=100 Flow over a 3D Sphere  
Method Re Cd Lw/D 
Present 100   1.061   0.856 
Fornberg (1988) 100   1.085   0.874 
Kim, Kim and 
Choi (2001) 
100   1.087  
Marella et al. 
(2005) 
100 1.06 0.88 
 
 
 
 
Fig. 1.  Various cell and node types, including ghost 
cell, projection point and image point, δ : 
distance from projection point to image point. 
dx
Er
ro
r
10-3 10-2 10-1 100
10-6
10-5
10-4
10-3
10-2
10-1
100
1st-order
2nd-order
u, L2
u, Maximum
v, L2
v, Maximum
 
Fig. 2.  Norms of errors of velocity components 
compared with the results on the finest grid, 
unfilled symbols: L2 norms, solid symbols: 
maximum norms 
-1 0 1
x
-1
0
1
y
 
Fig. 3. Locally refined Cartesian mesh for flow 
over a 2D stationary cylinder 
-1 0 1 2 3
x
-2
-1
0
1
2
y
Steady Flow Over Cylinder, Re=40
 
Fig. 4.  Streamlines showing separation bubble 
behind a 2D cylinder, Re=40 
