中   華   民   國   95  年   10  月  13    日 
附件二 可供推廣之研發成果資料表 
□ 可申請專利  ■ 可技術移轉                                      日期：95 年 10 月 13 日 
國科會補助計畫 
計畫名稱：開放式 Web-Base 線上即時影音教學系統 II 
計畫主持人：  黃文楨       
計畫編號：NSC 94-2218-E-327-001 學門領域：資訊工程 
技術/創作名稱 開放式 Web-Base 線上即時影音教學系統 
發明人/創作人 黃文楨 陳瑞泰 
中文： 
即時傳輸協(Real Time Transmition Protocol)無穿過 NAT 是眾
所皆知的難題，然而現實環境中許多的使用者都躲在 NAT 內部，
若將 RTP 運用在線上即時影音教學方面，此因難必需加以解決，
雖然目前有些相關的套裝軟體已經可以穿過 NAT，不過除此之外
錄製完成後的教材無法提供內容的搜尋，可能導致使用者在二次學
習時浪費時間，且為如果每次的教材都要從頭播放或使用快轉來微
調那對於資料的搜找會顯得非常沒有效率。因此我們認為一套開放
式的 Web based 的系統是最合乎目前使用者所需要的。除了 Web 
Based 外，它也必須具有穿越 NAT、教學情境錄製與重現，教學內
容檢索等特色，本論文之創新也在於此。基於以上目的本論文將加
以研究與實作，期望利用本系統能達到更好的學習效果。 
（100~500 字） 
技術說明 
英文： 
可利用之產業 
及 
可開發之產品 
E-learning 
技術特點 
即時影音教學系統的錄製與線上相關教材之搜尋 
推廣及運用的價值 
累積線上教材，可以即時搜尋到相關的教材，增進學習成效。 
 
 
 2
 4
統，將 Video 與 Audio 串流合併成單一的
Video Bitstream 與 Audio Bitstream，再經
由 Mixer 將資料送至目的地的 RTP 接收
端，RTP 與 Mixer 之發送端可以依據 RTCP 
Packets 所傳回之頻寬(Bandwidth)資訊判
斷網路之狀況，並可以調整影音之傳輸資
料量，在這樣的狀況下達到動態地控制影
音資料流量的理想目標。上述方法雖然不
是以接收端的緩衝區做為控制協調，但是
同步即時影音的資料也無法應用，關鍵問
題在於無法事先預估未來所要產生的資料
內容，而且一但決定了影音傳送品質後便
無法再變更，不過控制與改變傳送品質在
本研究中可以提早到決定影音品質時來決
定，在下一個章節中本研究將詳述如何預
估所需的影音品質。 
另外，國外學者 I. Busse 等[5]提出一個使
用 RTP 的回饋的控制方法，接收端傳回報
告給傳送端，其中包含可以計算封包遺失
和封包 delay jitter 的資訊，可以找出真正
的原因和合適的解決方式。Yoma[11]等人
使用 Least Mean Square(LMS)的方法來減
少封包遺失與期望反應間的誤差。
Kasera[12]在傳送或接收端調整 window 
size 來控制壅塞程度，如果沒有壅塞就增
加 window-size，若有壅塞就減少
window-size。 
(二)教材內容擷取的相關研究 
一般來說，多媒體資料庫的管理系統
可分為以下幾個主要的擷取機制：單一影
像的擷取，一連串影像的擷取，聲音擷取，
視訊擷取，文法或語意的分析等。 
在國內相關研究方面，較常見的多媒
體搜尋的技術中，用圖形的辦識的方法，
將文字從影像中擷取出來[20]。再以取得
的文字來當索引，加以判讀。另外一種處
理多媒體視訊存取的技術是用動態貝氏網
路(Dynamic Bayesiam Network)的方法來
推演出視訊高階特性來做為類別資訊的語
意認知[23]。何宥萱[17]提出以 key-frame
的方式來做為視訊摘要和檢索的依據。在
E-learning 的平台上，許恒嘉[18]建構一個
符合 SCORM 標準的虛擬解剖教學系統，
加入三維空間平面影像擷取的功能。 
在國外相關研究方面，Naphade 和
Huang[10]對於多媒體的語意擷取提出許
多不同的解決的方法，並對於現有的各種
多媒體擷取技術加以深入探討，他們主要
是以圖形識別的技術，來解決多媒體擷取
的問題。Westerveld 等[13]用貝式決策理論
(Bayesian decision theory)來擷取多媒體文
件，而他們的多媒體文件包括文字及視覺
的資訊，經由他們評估的結果，以文字為
主的搜尋效果遠好於視覺資訊的擷取。
Xu[15]提出一個在WWW上的視訊擷取系
統，該系統收集 WWW 上的視訊影片
(video)並建立其關鍵畫面(key frame)之資
料庫，之後再根據這些畫面加以分類，並
加入使用者的互動來訓練其擷取畫面的正
確性。 
綜觀國內外學者的方法發現，幾個目
前多媒體搜尋技術的瓶頸，首先是資訊搜
尋正確率仍然比文字來的低，而大部分的
方法都需事後在多媒體資料中加入描述性
資料(Mete Data)，因此本研究將設法利用
文字來做為搜尋的資料庫，以增加實用性。 
 
研究方法 
(一) 線上學習流程 
本系統除了仿照一般傳統教室的教學
方式外，也提供了教材錄製功能，它可以
將即時教學的內容全部錄製下來成為日後
的教材檔案，並且檔案內容可以提供搜尋
功能，方便使用者快速找到相關的教材片
段，本系統詳細的線上學習流程如下頁圖
1 所示。首先進入系統後可以選擇登入教
室來進行即時同步學習，選用即時同步學
習時不論是白板中的投影片、桌面與筆跡
等，或是即時語音及影像都是同步傳送與
傳統的教室所獲得的資訊差異不大，並且
在課程進行的同時將課堂中的互動情境全
部錄製下來。若選擇非即時同步學習，可
8. User 端欲接收【RTP】的範例如下圖 3
所示，此步驟與上一步驟之 source 及
destination 相反，由於傳回時 source 
port及 IP己不重要故以＂?＂表示，【轉
送伺服器】若欲將【RTP】封包傳給
User 只要指定 NAT 的 IP 及 23556 的
port，則 NAT 就依先前記錄的 Routing 
Table 將【RTP】packet 改為 packet C，
如此就可以使【RTP】packet 正確無誤
的送達 User。 
 
圖 3 傳回 RTP 流程圖 
本系統除了能自動穿過 NAT 之外，也
提供虛擬伺服器的概念來節省伺服頻寬，
這個設計主要考量使用者有可能同時多個
人處於同一個 NAT 環境之內，若以 P2P
或其它 Client-Server 產品的方法，將會消
耗大量的伺服器上傳頻寬，因此若可以由
在相同子網路遮罩中的某一個使用者做內
部的廣播那麼，伺服器就只需將 RTP 封包
傳送給他即可，他會自動廣播給其它在相
同子網路遮罩中的使用者，那麼就會大量
減少伺服器的上傳頻寬消耗。如下圖 4 所
示，伺服器會選出一部 NAT 內部電腦做為
虛擬伺服器(Virtual Server)，並將 RTP 封
包傳送給它，由它做區域網路內的
Broadcasting，如此一來伺服器便只要一次
的 RTP 封包即可而大幅降低流量。 
圖 4 虛擬伺服器廣播示意圖  
 
(三) 教材儲存設計 
目前即時影像與語音檔案的儲存己經
有許多種格式，較著名的有 Real Play 的
RM、MicroSoft 的 WMV、QuickTime 的
MOV 與一般公用格式 MPEG-2 或
MPEG-4 等。然而這些格式不符合本研究
之需求，因此本研究將另外設計屬於本系
統專屬的檔案格式，在本系統中即時影像
與語音除了內容與編碼不同之外，其它傳
送與運作方式階相同，因此我們探討檔案
的儲存格式均適用影像與語音。 
本研究採用串流封包堆疊(raw data stack)
的方式來儲存資料，採用串流封包堆疊的
原因有二： 
1. 減少再一次的編碼的時間與損失 
不論是採用哪一種現有的檔案儲存格
式，均需將 RTP 封包另外編碼成為另一種
檔案格式，而這些檔案格式本身為了提高
壓縮率通常都會做破壞性壓縮，但是 RTP
串流本來就己經執行過一次的破壞性壓，
若再執行第二次破壞性壓縮，將會導致即
時影像與語音的品質降低，再者也會浪費
CPU 資源，因此為增加儲存速度與節省
CPU 資源本系統不再進行檔案格式的轉
換。 
2. 符合系統搜尋需求 
目前一般線上即時視訊系統儲存完成
後，只能允許播放而無法進行內容的搜
尋，而本系統提供內容的搜尋，搜尋的單
位以每一張投影片為基礎，將來播放時的
最小單位也以投影片做為切割的基礎，因
此使用者每換一張投影片，都必需中止儲
存檔案再重新錄製下段內容，如此頻繁的
中止與重製一般的檔案格式也無法達成。 
(1) RTP 與教材儲存與播放概念 
本系統將所有的資料流依產生的時間
順序以 Java Object 方式儲存起來，要播放
時再依順序取出來播放，而為了呈現動畫
必需計算每一個 Object 的等待時間，所以
當系統執行播放時，必需事先將每一個動
畫工作讀出來，並計算每一個工作的等待
時間，等待時間完成後就開始播放，概念
 6
播放，而本研究主要是利用 metadata 來提
供搜尋的索引，以下本節將分為搜尋概念
與搜尋方法來介紹。 
(1)搜尋概念 
教學內容包括 Power Point、電子白板
內容、虛擬教室中所有人的聲音與影像，
本研究為保留教學過程，因此所有的資訊
都必需被記錄下來，而記錄的資料結構必
需能提供內容搜尋，並可以從被搜尋到的
目標處播放。 
因為內容包含影像及聲音，雖然目前
有影像及聲音辨識方法，但限制太多與辨
識正確率不佳，故本研究不以影音檔為搜
尋之標的，而採用投影片內容與文字對談
內容為標的。 
目標錄製影片之播放是利用電子白板
或投影片換頁為段落，因此被搜尋到的影
片段落會與當時所放映的投影片內容相
符。例如圖 10 所示，最下方是所有的投影
片，當我們輸入關鍵字「NAT」時，會找
出上方被放大的投影片，因為而該片段中
的投影片文字含有「NAT」，且每一張投影
片都是一個影片片段，所以影像與聲音也
是從這裡開始播放。 
圖 10 搜尋概念 
 
(2)搜尋方法 
目前數位學習教材產品大部分都宣稱
可以搜尋內容，而搜尋的標的物就是符合
SCROM 標準的 XML 檔或是 HTML 檔，
然而要進行搜尋前必需先進行錄製線上教
材檔，現在較著名且宣稱符合 SCROM 標
準的工作有旭聯科技的 AniCam、友立科
技的串流大師及 Microsoft 的 Producer
等。不論是哪一種都需要 Microsoft 
PowerPoint 的配合，這些軟體所發佈的數
位教材檔內容包含的資訊大致相同，若用
Microsoft PowerPoint另存新檔的新檔方式
也可以得到我們所需的資訊，以為
Microsoft PowerPoint 另存成*.html 格式為
例，另存檔案後檢視檔案中可以找到一個
名為 outline.htm 的檔案，以下為
outline.htm 的 html 語法片段，而藉由判讀
「id=PPTL1」將可得知關鍵字存在於投影
片中的第一頁，若「id=PPTL2」表示存在
於第二頁。 
<table width="100%" style='font-family:新細明
體;font-size:9pt'> 
 <tr onmouseover="Over(this)" onmouseout="Out(this)" 
onclick="Follow(this)" 
  style='cursor:hand'> 
  <td align=right valign=top> 
  <div class=sldNum><font size=2>1</font></div> 
  </td> 
  <td width="100%"> 
  <div id=PPTP1 class=PTxt><font size=2><a 
  href="javascript:GoToSld('slide0001.htm');" 
id=PPTL1>遠距教學系統之<br> 
    即時影音教學與典藏技術研發</a></font></div> 
  <div id=PPTC1 class=CTxt style='display:none'><font 
size=2> 
  <ul> 
   <li>學<span 
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>
生：陳瑞泰</li> 
   <li>學<span 
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>
號：9324802</li> 
   <li>日<span 
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>
期：2006/04/20</li> 
  </ul> 
  </font></div> 
  </td> 
 </tr> 
 <tr onmouseover="Over(this)" onmouseout="Out(this)" 
onclick="Follow(this)" 
  style='cursor:hand'> 
  <td align=right valign=top> 
  <div class=sldNum><font size=2>2</font></div> 
  </td> 
  <td> 
  <div id=PPTP2 class=PTxt><font size=2><a 
  href="javascript:GoToSld('slide0002.htm');" 
id=PPTL2>前言</a></font></div> 
  <div id=PPTC2 class=CTxt style='display:none'><font 
size=2> 
  <ul> 
   <li>背景</li> 
   <li>動機與創新</li> 
   <li>研究範圍與限制</li> 
   <li>論文貢獻</li> 
 8
 
圖 5- 1 搜尋概念 
 
當我們選擇要搜尋內容時，播放程式
會要求使用者輸入關鍵字，畫面如下所示。 
 
圖 5- 2 搜尋概念 
 
輸入完關鍵字後，播放程式將只會播
放內容含有「系統」這個關鍵字的投影片
片段，畫面如下所示。 
 
圖 5- 3 搜尋概念 
 
結論 
隨著 Internet 的蓬勃發展，現有多數
RTP 技術已不能滿足多樣化的通訊方式，
在高速網路及無線網路的普及化，網路的
安全問題也愈來愈複雜，站在即時遠距教
學的角度來看，本研究期許 RTP 技術不再
只剩下免費的網路電話或即時通訊等功
能，而是能應用此技術結合創意產生許多
新的殺手級服務，因此本研究利用自行設
計之侵入式 RTP 元件，實作了一套即時遠
距教學系統，並結合線性即時播放及非線
性即時播放的優點，以提升此系統在輔助
教學上的品質。本系統架構分別考慮了三
種的角色分別為一般使用者、企業及網管
人員，首先，一般使用者因為上傳頻寬不
論有多少人同時交談，他所佔用的頻寬均
是相同的，代表使用者不需有很大的上傳
頻寬就可以多人一起線上語音交談，而
Web-Based 設計讓使用者免安裝，情境記
錄可以省去事先錄製教材的時間，隨著正
常的上課教學加入情境記錄後就相當於課
後複習的教材，還可提供搜尋教材內容，
節省許多學習成本。其次，企業因系統的
可跨平台設計及分散式傳輸，可以降低網
路專線及作業系統成本。最後，因為
Web-Based 設計，所以可以嵌入任何網頁
中方便系統整合。侵入式 RTP 設計使網管
人員工作量降低，因為不需教使用者如何
設定 NAT。 
經過本研究實際實驗測試過後，證實
以分散式傳輸的轉送伺服器在一對多上傳
頻寬方面優於任何 P2P 軟體，而播放延遲
方面因為經過轉送所以比 P2P 軟體略慢了
一些，在 CPU 使用方面若是壓縮比率愈高
則愈需要 CPU 時間，而且因為壓縮率過大
導致在傳輸過程中若有遺失封包，則還原
的機率愈小，本系統則是界於 MSN 與
Skype 之間，另外值得一提的是基因演算
法所分配的伺服器頻寬因為都以不超過網
路實際上傳頻寬為主，因此網路實際頻寬
是可以制控保證不擁塞，所以 RTP 封包遺
失率都不會大嚴重，除了一些不可預期的
封包遺失外，例如客戶端頻寬不足，或是
路由器的封包遺失，由實驗結果即可驗證
基因演算法確實發揮了頻寬分配的作用。
整體來看，本論文提出之侵入式 RTP 方法
在 Web-Base 與一對多的運用則是遠優於
P2P 軟體。另外非線輔性助教學檔案也有
別於一般的軟體，本研究提供檔案內容的
搜尋，方便使用者快速找到相關的教材片
段。 
 
誌謝 
本研究接受國科會編號：NSC 
94-2218-E-327-001 研究計畫之補助。 
 
參考文獻 
[1] “RTP: A Transport Protocol for Real-Time 
Application,” RFC1889, January 1996. 
 10
