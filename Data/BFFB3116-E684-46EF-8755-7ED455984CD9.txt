-1-
中文摘要
本研究利用 NETSTARS 模式計算不同參數值的物理量變化，提供倒傳遞類神經網路及
導引模擬退火法訓練及求得最佳參數解。所用參數為河道曼寧 n 值及可沖刷厚度參數 Alt
值，使用單一河道朴子溪民國 78 年至 85 年間颱風暴雨及大斷面測量資料作為資料訓練檢
驗的依據，在上游牛稠溪橋及中游灣內橋有實測水位歷線提供輸入及檢驗，以測站為中心
參考河道初始 n 值同步增減 n 值進行水理計算得到測站的水位值，牛稠溪橋 n 值計算範圍
為 0.017-0.068；灣內橋 n 值計算範圍為 0.015-0.060。整個河道斷面只有一個 Alt 參數須要
檢定，模擬參數值的範圍為 0-1.2，以 78 年斷面起算，求得各斷面河床最低點高程與 85 年
實測大斷面作比較。以上參數範圍均採用線性內插產生 201 組成果資料，求得各資料的 MSE
值，繪圖比較得到 MSE 最小值得該組參數值為最佳解，以民國 83 年暴雨 37 小時的資料和
民國 85 年賀伯颱風 53 小時資料作水位模擬，37 小時事件牛稠溪橋曼寧 n 值為 0.0394，灣
內橋曼寧 n 值為 0.0232；53 小時事件牛稠溪橋曼寧 n 值為 0.0507，灣內橋曼寧 n 值為 0.0198，
與手動調整值也有差異，且不同事件所得之各站參數值並不一樣，代表 n 值應該會隨水位
高低作調整，因此檢定曼寧 n 值成果仍帶有不確定性的因素存在。以民國 78 年至 85 年間
的颱風暴雨 792 小時進行河床變動模擬，最佳 Alt 值為 0.062，與手動調整值 0.2 有比較大
的差異。以 BPN 類神經網路及導引 SA 法進行參數最佳化，得到的最佳參數值也與模擬最
佳值有一些差異，BPN 類神經網路法會去調整各個權重去符合輸出值，實測值非計算求得，
存在的差異性使得輸出的參數值有一些不確定存在。導引 SA 法會去調整各個參數值使目
標函數最小化，這個調整過程的結果參數值可能無法使用模擬程式產生，可能造成一些推
估成果的誤差。因此先做一個參數值範圍的成果計算，再分析 MSE 最小值得到的參數值會
是比較可靠的作法。
關鍵詞：倒傳遞類神經網路，模擬退火法，NETSTARS 模式，參數最佳化
-3-
一、前言
NETSTARS 模式是計畫主持人在博士班期間(民國 81-85 年)完成的複雜河系沖淤模
式，在民國 91-93 年度主持人獲得國科會計畫補助，完成「複雜河系沖淤模式 NETSTARS
之功能強化及視窗化研發」三年計畫，開發了模式專用的視窗化界面，可以展示一維、二
維甚至到三維成果的繪圖，並開發兩個 ARCVIEW 模組，讓二維成果可以進行加值計算並
套圖，也使用 XOOPS 完成教學網站建置。到目前為止，此模式仍被廣泛使用來做河川整
治規劃、河床變動模擬及預測等工作。每當進行參數檢定的工作時，可能因河系複雜度的
不同而有所差異，許多參數檢定的成果有可能是局部最佳解，而非全域最佳解，人工經驗
調整參數的局部解也可能不是局部最佳解，因此本計劃採用倒傳遞類神經網路及導引模擬
退火法，利用模擬資料與水文測站實測水位、大斷面實測河床最低點作為網路輸入及輸出
資料或成為目標函式裡的計算項目，來求解 NETSTARS 模式參數最佳化的問題，一方面可
降低人為經驗不足的不確定誤差，一方面又可以提高模擬結果的精度，自然也節省了試誤
所花的時間。本研究試著去找出一個模式參數最佳化的作法，提供 NETSTARS 使用者快速
找到最佳參數。文中利用朴子溪民國 78 到 85 年間的水位站資料及大斷面測量資料，進行
參數最佳化成果的比對，除了利用 NETSTARS 模式計算各參數改變的 201 組數據提供分
析 MSE 以外，也整理這些數據輸入倒傳遞類神經網路及導引模擬退火法，尋找各水文站曼
寧 n 值及河道可沖刷後度參數 Alt 值的最佳值，並分析比較之。
二、研究目的
因 NETSTARS 視窗化開發已告一段落，根據使用者回饋的結果，需要進一步對初始值
及參數自動化做一番研究，因此我們從許多類神經網路及相關演算法挑選了倒傳遞網路、
導引模擬退火法作為 NETSTARS 模式分階段參數檢定自動化的演算方法，並使用
FORTRAN、Neurosolution 等工具開發這些附加功能，以一個單一河道案例分析這些附加功
能執行成果的特性，希望未來透過參數最佳化的篩選功能讓檢定工作更為輕鬆。
三、文獻探討
由蒐集的文獻了解求解最佳化問題，在空間上如原子叢集[1]、影像邊緣偵測[2]、旅行
商問題[3]、揀貨批次[4]、車輛派遣及運輸成本[5]、通路商分群、計算圓面積、多場區訂單
分配等，使用了導引模擬退火法（Guided Simulated Annealing）、螞蟻群最佳演算法(Ant
colony optimization，ACO)、遺傳基因演算法(Genetic Algorithm)、禁忌搜尋法(Tabu search)、
啟發式演算法(heuristic algorithm)、粒子群演算法(Particle Swarm Optimization, PSO)、蒙
地卡羅法(Monte Carlo Simulation)、自我組織特徵映射圖網路(Self- Organizing Map, SOM)
等。圖形判釋分類有用放射狀基底網路(Radial basis function network,RBFN)、支持向量機網
路(Support vector machine network,SVM)等演算法來分類。在水利方面也不少研究成果，也
是使用類神經網路及相關的演算法進行，並獲得良好成果，如颱風降雨量推估用倒傳遞網
路、風浪推算用 WTA 類神經網路[6]、河川水理模式阻力參數自動率定用模擬退火實數編
碼利基遺傳演算法[7]、核包模式使用最陡坡降法獲得最佳的模式參數、非拘限含水層的參
數檢定使用傅立葉頻譜分析、集水區暴雨產砂量使用倒傳遞類神經網路學習模擬[8]等。
目前著名的類神經網路模式有數十種，而依照類神經網路的學習方式，大致上可分監
督式學習、非監督式學習網路、聯想式學習網路、最佳化應用網路這四大類[9]。(1).監督
式學習網路：必須從問題相關條件取得訓練範例，包括輸入值與輸出值。首先訓練網路，
依據期望輸出值與實際計算值差來調整整個網路權重，網路從中學習兩者間的映射規則以
應用新的案例。應用這樣的學習方式主要有感知機網路 (Perceptron) 、倒傳遞網路
(Back-Propagation Network ，BPN) 、機率神經網路(Probabilistic Neural Network，PNN)、
廣義迴歸類神經網路(General RegressionNeural Network，GRNN)、學習向量量化網路
-5-
圖 4.1 倒傳遞類神經網路架構圖
處理單元其輸出值及輸入值的關係式，一般可用輸入值的加權乘積和之函數來表
示：
 jj netfY  .............................................................................................(式 4.1)
  jiijj XWnet  ................................................................................(式 4.2)
其中
jY = 輸出變數，模仿生物神經元的模型的輸出訊號。
f = 轉換函數，一個用以模仿生物神經模型的非線性處理機能，從其他處理單元輸
入的輸入值加權乘積和，轉換成處理單元輸出的數學公式。使用函數通常如式 4.3 所
示：
 xexf 1
1
..........................................................................................(式 4.3)
此函數在自變數趨近正負無限大時，函數值趨近 (0, 1)，如圖 4.2 所示。
圖 4.2 函數值示意圖
ijW = 連結加權值，模仿生物神經元的模型的突觸強度。
iX = 輸入變數，模仿生物神經元的模型的輸入訊號。
Xi
X6
X1
X2
X3
X4
X5
X7
Yj
Y2
Y1
連結權重植
神經
1.0
0.8
0.6
0.4
0.2
-6 -5 -4 -3 -2 -1 0 1 2 3 4 5 6
f(
x)
x
-7-
透過動態連結程式庫(DLLs)客製化元件、neuro-fuzzy 結構，並且能運用 OLE Automation
的功能，由 VB 撰寫程式語來控制 NeuroSolutions。
本研究因自行撰寫修改 BPN 類神經網路 FORTRAN 程式 Neural_Simulator (原作者：
Phil Brierley)收斂效率不佳，因而採用 NeuroSolutions 的 NeuroSolutions for Excel 建立類神
經網路， NeuroSolutions for Excel 是外掛模組，在微軟 Excel 中可以直接執行
NeuroSolutions，只要在 Excel 內做一些重要資料設定，例如 Training、Testing、Production
資料等。然後做一些架構選定，便能建立有效的類神經網路。此模組也能進行批次化執行，
把結果以圖形化方式顯示，這一強大功能可以讓使用者進行參數最佳化。
NeuroSolutions for Excel 分別組織成下列 7 個模組，而每個模組可以讓使用者運用
VBA(Visual Basic for Applications)來自定的輸入批量，分別為前處理資料模組（preprocess
data）、分析資料模組（Analyze data or results）、標示資料模組（Tag data）、建立/打開網路
模組（Create/open network）、資料檔案建製模組（Create data files）、訓練網路模組（Train
Network）、測試網路模組（Test network）。
本研究試跑鴻海股價走勢預測，以了解各網路的差異性及可用性，表 5-1 中為鴻海股
價之預測，以 time-lag nueron network 方法建造類神經網路，當訓練樣本數同為 229 時，輸
入數據為日期、開盤價、前五日平均、前十日平均、最高價、最低價、收盤價、成交量，
輸出為明日的收盤價，預設不同隱藏層結點數，呈現的不同結果。
參考周柏清(2007)之論文中找尋隱藏層結點數之預設方法找出三個節點數，分別設為 7
（輸入層神經元個數+輸出層神經元個數*0.5）、8（輸入層神經元個數+輸出層神經元個
數）、9（輸入層神經元個數+輸出層神經元個數*2）三種假設狀態[10]。還有參考楊錦洲(2005)
論文中的拇指法則  nm
s
h


5
找出預設為 5 的節點數[11]。
由表 4-2 可看出，隱藏節點數為 9 的時候為最佳結果，隱藏節點數為 5 的時候，結果
不好，由此可判斷拇指法則並不適用在此。
表 4-2 不同隱藏層節點數鴻海股價預測誤差平方和排序表
從圖 4-3 看來，雖然隱藏節點數為 9 時，有較佳結果，但 time-lag nueron network 所建
造出的類神經網路成果並不如預期的好，所以我們使用 NeuroSolutions for excel 中的 new
function approximation network 建造類神經網路，來呈現更好的結果。
經驗上誤差平均值大致以訓練樣本數多時所得的誤差會較小，常理而言，股價加入 5
日或 10 日平均線誤差也應該會比沒有加入小，但是由訓練的結果發現並非完全吻合，我們
以鴻海 96 年 1 月 23 日到 97 年 3 月 3 日大約一年的股價走勢為訓練(training)及測試驗證
(testing & production)的基本資料，如圖 4-4 所示。以鴻海股價使用 NeuroSolutions for excel
中的 new function approximation network 建造的類神經網路來看，其網路是由 1 層隱藏層、
10 個神經元所構成，表 4-3 為類神經網路架構所模擬的股價預測誤差平方平均值的成果。
使用類神經網路訓練的 MSE 如圖 4-5 所示，預測及實際股價比較成果如圖 4-6 所示。由表
4-2 顯示在樣本數最多時只加入 5 日平均線反而比較差，其他都與常識符合，所以在樣本數
多時加入平均線不見得都有比較小的誤差值，以鴻海股價來說訓練樣本數為總數的 4/5 為
隱藏層
結點數
=5
隱藏層
結點數
=7
隱藏層結
點數=8
隱藏層結
點數=9
隱藏層
結點數
=10
備註
加入 5 日及 10
日平均線 1165.51 511.68 468.30 192.87 313.08
排序 5 4 3 1 2
總
樣
本
數
=273 ，
訓
練
樣
本
數
為
229
-9-
MSE versus Epoch
0
0.05
0.1
0.15
0.2
0.25
1 100 199 298 397 496 595 694 793 892 991
Epoch
M
SE
Training MSE
圖 4-5 類神經網路訓練誤差 MSE 值收斂的情況
Desired Output and Actual Network Output
0
50
100
150
200
250
1 4 7 10 13 16 19 22 25 28 31 34 37 40
Exemplar
O
ut
pu
t
預測收盤
預測收盤 Output
圖 4-6 鴻海實際股價(實線)與預測股價(虛線)比較圖
圖 4-7 中是當隱藏層都為 10 時，將兩個類神經網路模組所預測出的股價結果和原始資
料做比較，紅色虛線為 time-lag nueron network、橘色虛線為 new function approximation
network、原始股價為藍色實線。從圖 4-7 可看出，time-lag nueron network 明顯的比 new
function approximation network 差，所以以鴻海股價來說，new function approximation network
是較為適當的預測模組。
-11-
為評鑑指標。此新演算法的關鍵就在於如何用上一代有用的資訊去導引下一代的搜尋過
程，如圖 4-8(2002 年 4 月物理雙月刊，文章作者：李世炳、鄒忠毅)。設定的能量函式越
小，結果越好，所以 E 為(流量差異比平方+水位差異比平方+河床差異比平方)，推估值反
覆修正 E 直到最小，就會得到最佳解。
圖 4-8 導引模擬退火法的概念
如考慮一個簡單的能量函數，   


N
i
ii
N
i
i xCBxAEE
1
22
1
，
其中， xi 的範圍在 –1 到 1 之間。A=10，B=0.49，C=1.0E-5。圖 4-9 表示 xi 與 Ei 的
關係。我們可以看出，對於 Ei 有兩個差距非常小的極小值（約 1.4E-5 ），落在 xi 約等
於 –0.7 與 0.7 處。而整個能量函數 E 的整體最小能量也就落在所有的 x 都約等於 –0.7
處，並且能量函數 E 的所有的極小值一共有 2 的 N 次方個，其中 N 代表輸入層的參數數
量。
圖 4-9 簡單的能量函數
如以 100 個變數為例(N=100，能量函數 E 一共有 2100 個極小值)。決定每一代群體大
小為 20，退火過程每個溫度有效移動 100 次，降溫率 0.85。然後導引模擬退火法的操作步
驟如下：
第一步：利用傳統模擬退火法得到第一組親代。由於我們用了很快速的退火策略，所
以第一組親代群體，沒有找到整體極小值。
第二步：分析第一組群體的變數分布圖作為導引函數。對於這個簡單的問題，我們可
以直接用個別變數位置的 histogram 來作為導引函數(以(x)表示)。
第三步：利用加入導引函數的退火過程得到子代。有了導引函數後，我們就可以用它
來幫助下一代群體的產生。
-13-
位歷線比較如圖 5-11，53 小時灣內橋水位歷線比較如圖 5-12，與手動調整值牛稠溪橋
n=0.034、灣內橋 n=0.03 也有差異，但是曼寧 n 值上游比下游高是很明確的，成果顯示灣內
橋最佳參數呈現的結果仍然不佳，顯見此站仍有其他未考慮因素造成此一誤差。且不同事
件所得之各站參數值並不一致，代表 n 值應該會隨水位高低作調整，因此檢定曼寧 n 值成
果仍帶有不確定性的因素存在。
圖 5-1 朴子溪模擬範圍及斷面分布圖
-15-
圖 5-4 朴子溪全河段人工檢定河床變動比較圖
牛稠溪橋(37小時延時)
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
1 21 41 61 81 101 121 141 161 181 201
Run Case
MSE
0
0.01
0.02
0.03
0.04
0.05
0.06
0.07
0.08
Manning n
MSE
Manning n
圖 5-5 811 暴雨 37 小時牛稠溪橋曼寧 n值及 MSE 比較圖
-17-
表 5-1 模擬成果各測站模擬水位歷線 MSE 及最佳曼寧 n 值列表
試跑資料繪圖最佳值 牛稠溪橋曼寧 n值灣內橋曼寧 n值 朴子溪 Alt 值
37 小時水位 0.0394 0.0232 ---
53 小時水位 0.0507 0.0198 ---
792 小時河床變動 --- --- 0.062
牛稠溪橋(37小時)
15
16
17
18
19
20
21
22
23
24
1 6 11 16 21 26 31 36
時間(小時)
水位(M)
計算水位
實測水位
圖 5-9 811 暴雨 37 小時牛稠溪橋水位歷線比較圖
灣內橋(37小時)
0
2
4
6
8
10
12
14
1 6 11 16 21 26 31 36
時間(小時)
水位(M)
計算水位
實測水位
圖 5-10 811 暴雨 37 小時灣內橋水位歷線比較圖
-19-
朴子溪民國78-85年河床變動
0
0.5
1
1.5
2
2.5
3
3.5
4
1 21 41 61 81 101 121 141 161 181 201
Run Case
MSE
0
0.2
0.4
0.6
0.8
1
1.2
1.4
Alt Value
MSE
Alt Value
圖 5-13 朴子溪全河段不同 Alt 值 MSE 比較圖
以民國 78 年至 85 年間的颱風暴雨 792 小時進行河床變動模擬，以 MSE 最小值求得最
佳 Alt 值為 0.062，與手動調整值 0.2 有比較大的差異，請參考表 5-1。最佳 Alt 值模擬的朴
子溪河床變動比較如圖 5-14 所示，由圖看出最佳 Alt 值模擬成果並不是很好，這與輸砂模
式其他參數搭配計算誤差有關，或是一些採砂造成的計算失真也都有可能影響到成果的精
度。
朴子溪民國78-85年河床變動
-15
-10
-5
0
5
10
15
20
1 21 41 61 81
斷面編號
底高程(M)
計算河床
85年實測河床
78年起始河床
圖 5-14 朴子溪最佳 Alt 值河床最低點高程變動比較圖
六、BPN 及導引 SA 參數優選成果討論
6.1 倒傳遞類神經網路
倒傳遞網路從輸入層節點接收資訊，經過網路各層節點權值多次的計算後輸出至輸出
層，得到輸出資訊。針對倒傳遞網路而言，輸出資訊內容為重要關鍵，以期望輸出值不斷
修正網路內之權值及閥值使計算輸出值更接近期望輸出值，而計算輸出值乃經由輸入資訊
決定。
主要分為輸入層、隱藏層、輸出層，並有學習評鑑指標提供檢驗學習效率，其中輸入
層規劃為測站邊界條件的逐時水位、流量、輸砂量、及對應的斷面河床最低點(由實測斷面
推估)，隱藏層考慮模式的資料數量多寡與模式效率問題，避免過多的隱藏層處理單元會參
-21-
基礎探討不同神經元節點數所計算出來的成果差異，據以決定最佳的神經元節點數為何。
本研究訓練樣本數同為 160，測試樣本數同為 41，驗證樣本均為 1。當使用同樣的計
算階段個數資料，設定不同隱藏層節點數，將會預測出不同的結果。參考周柏清(2007)”運
用倒傳遞類神經網路建立國防預算預測模式”之論文中隱藏層結點數預設方法找出三個節
點數，分別設為以下三種假設狀態
1. （輸入層神經元個數+輸出層神經元個數）*0.5
2. （輸入層神經元個數+輸出層神經元個數）
3. （輸入層神經元個數+輸出層神經元個數）*2。
假設出三種隱藏節點數後，另外自行假設隱藏節點數為 5、10。表 7-1 與表 7-2 分別為
不同資料預測之結果，MSE 是測試(Testing)的均方誤差值，表 6-1 為暴雨時所預測之結果，
結果中顯示牛稠溪橋在隱藏節點數為 10 時有最佳的曼寧 n 值 0.00397，灣內橋在隱藏節點
數為 76 時有最佳曼寧 n 值 0.0292。表 6-2 為賀伯颱風時預測之結果，結果中顯示牛稠溪橋
在隱藏節點數為 10 時有最佳的曼寧 n 值 0.0541，灣內橋在隱藏節點數為 27 時有最佳曼寧
n 值 0.0361。不同事件所得之各站參數值並不一致，代表 n 值應該會隨水位高低作調整，
因此檢定曼寧 n 值成果仍帶有不確定性的因素存在。從表中可清楚看出牛稠溪橋之預測結
果較為灣內橋之預測結果好。由結果得知在牛稠溪橋的模型以節點數為 10 最佳，在灣內橋
的模型以節點數為 27 最佳。上述測試之最佳結果將分別顯示在圖 6-3、圖 6-4、圖 6-5 及圖
6-6 中。
表 6-1 民國 83 年 8 月 11 日暴雨 37 小時優選之結果
表 6-2 1996 年賀伯颱風 53 小時優選之結果
隱藏節點數
5 10 19 38 76
production 最佳 n
牛稠溪橋 MSE 1.18E-06 6.14E-07 1.22E-06 2.63E-06 2.77E-06
牛稠溪橋 n value 0.0368 0.0397 0.0348 0.0310 0.0497
0.0397
灣內橋 MSE 7.86E-06 8.53E-06 3.81E-06 6.69E-06 3.51E-06
灣內橋 n value 0.0280 0.0326 0.0275 0.0196 0.0292
0.0292
隱藏節點數
5 10 27 54 108
production
最佳 n
牛稠溪橋MSE 9.18E-07 2.93E-07 1.40E-06 1.37E-06 2.74E-06
牛稠溪橋n value 0.0594 0.0541 0.0613 0.0444 0.0313
0.0541
灣內橋MSE 3.72E-06 2.13E-06 1.56E-06 1.89E-06 2.82E-06
灣內橋n value 0.0282 0.0548 0.0361 0.0540 0.0474
0.0361
-23-
Manning n值的Testing成果比較
0
0.01
0.02
0.03
0.04
0.05
0.06
0.07
1 4 7 10 13 16 19 22 25 28 31 34 37 40
樣本順序
M
an
ni
ng
n值
manningvalue
manningvalue Output
圖 6-6 賀伯颱風灣內橋在隱藏節點數為 27 之最佳測試結果
Alt 的部份，使用民國 78 年至 85 年間 792 小時的颱風暴雨水文資料進行模擬計算，
同樣產生 201 組模擬數據作 training 及 testing，實測做為 production 推估出 Alt 參數值，使
用不同隱藏神經元數模擬的結果比較如表 6-3 所示，最佳的 Alt 值為 0.50334，河段最佳的
測試結果如圖 6-7 所示，將曼寧 n 值及 Alt 參數最佳化成果整理如表 6-4 所示，其中只有牛
稠溪橋 37 小時水位推估的曼寧 n 值與試跑最佳值相近，其餘則有較大的差異。BPN 類神
經網路法會去調整各個權重去符合輸出值，實測值非計算求得，存在的差異性使得輸出的
參數值有一些不確定存在。
表 6-3 朴子溪河床變化不同隱藏數神經元模擬的結果比較
編號 隱藏節點數
training
MSE 值
Alt 值 MSE 曲線收斂 testing MSE
1 10 0.00020238 0.045517 穩 0.087544042
2 15 4.6138E-05 0.092083 穩 0.113058606
3 20 8.7613E-05 0.462579 穩 0.093656328
4 25 6.9675E-05 0.715737 穩 0.101266925
5 30 4.4378E-05 0.138787 穩 0.107807416
6 40 4.5237E-05 0.169169 穩 0.093399815
7 45 3.0811E-05 0.801583 穩 0.137011784
8 49 2.7411E-05 0.020131 穩 0.116798392
9 50 1.956E-05 0.50334 穩 0.10613636
10 51 7.5253E-05 0.102336 不穩 0.087790066
11 55 2.5504E-05 -0.00854 不穩 0.108795932
12 60 2.9853E-05 0.042949 不穩 0.096335975
13 80 4.1125E-05 -0.00666 不穩 0.109403027
14 99 2.687E-05 0.034169 不穩 0.089551127
15 198 0.04044195 -0.00858 非常不穩 0.188362084
-25-
溪橋 37 小時水位推估的曼寧 n 值與試跑最佳值相近，其餘則有較大的差異。不同事件所得
之各站參數值並不一致，代表 n 值應該會隨水位高低作調整，因此檢定曼寧 n 值成果仍帶
有不確定性的因素存在。導引 SA 法會去調整各個參數值使目標函數最小化，這個調整過
程的結果參數值可能無法使用模擬程式產生，會造成一些推估成果的誤差。
表 6-5 導引 SA 法各測站模擬水位歷線 MSE 及最佳曼寧 n 值列表
導引 SA 成果 牛稠溪橋曼寧 n值灣內橋曼寧 n值 朴子溪 Alt 值
37 小時水位 0.0395 0.0251 ---
53 小時水位 0.0523 0.0361 ---
792 小時河床變動 --- --- 0.102
七、結論
本研究以朴子溪完研究案例，以 NETSTARS 模式模擬的牛稠溪橋及灣內橋水位資料為
背景進行倒傳遞類神經網路的訓練、測試及產生接近實測資料的曼寧 n 值參數，以全河段
的河床模擬成果進行上述的過程，並得到最佳的 Alt 值。另以導引模擬退火法設定目標函
數，退火過程參數逼近實測資料，求得曼寧 n 值及 Alt 值，由模擬成果做 MSE 分析與兩種
最佳化方法比較，主要成果如下：
1. 颱風事件模擬成果分析 MSE 最小值，得到的 Manning n 值並不相同，可見這個參數會
隨不同水位高低有差異性。
2. 倒傳遞類神經網路與導引模擬退火法求得的37小時延時牛稠溪橋曼寧n值均相近大約
為 0.039，其他不同延時及灣內橋則差異較大，因此推論在不確定因素高的下游測站
優選的曼寧 n值可能差異甚大，上游測站曼寧 n值的可靠性較佳，但不同事件造成優
選成果的不同是檢定使用固定曼寧 n值的一大問題。
3. 倒傳遞類神經網路與導引模擬退火法求得的最佳 Alt 值與模擬成果分析 MSE 最小值，
得到的 Alt 值差異頗大，原因是河床變動的誤差很大，能抓住趨勢已經算很好，要算
得準恐怕很難，這比水位測站的優選成果差更多，因此不適用於此參數值的優選。
4. 基於優選成果並不符合預期，較保險作法即使用模式直接跑出 201 組資料進行 MSE 分
析，挑選最小值對應之參數即可完成檢定工作，如果是多場颱風暴雨，則建議做幾合
平均參數即可，不需再以這些優選方法計算，本研究已完成曼寧 n 值變動計算程式及
Alt 值變動計算程式，可以提供使用者試算及分析所需，也比人工調整成果更佳。
5. 優選的方法非常多，許多數據因為許多不確定因素存在，優選成果常有可能是局部解，
有規則的資料可能會較為適用。
八、參考文獻
1. 李世炳、鄒忠毅，2002，”簡介導引模擬退火法及其應用”，物理雙月刊（廿四卷二
期）。
2. 盧德賢、陳建彰，2006，”應用螞蟻群最佳化演算法於影像邊緣之偵測”，2006 電
子商務與數位生活研討會。
3. 陳宜欣 陳稼興、許芳誠，”遺傳演算法於 Job Shop 排程問題上的研究”， 技術學
刊 第十六卷 第一期 民國九十年。
4. 邱瑞弘，2006，最佳化揀貨批次決定之啟發式演算法，國立高雄第一科技大學運籌管
理系碩士論文。
5. 莊英群，2003，應用禁忌搜尋法於混合送收貨之車輛途程問題，逢 甲大學工業工程
研究所碩士論文。
6. 吳南靖、廖哲樞、朱志誠，2005，”WTA 類神經網路在風浪推算之應用”，2005 中
華技術季刊，七月號第 67 期。
-27-
九、計畫成果自評
(1) 與原計畫相符程度，達成預期目標狀況
本年度執行成果與原計畫相符，請參考結論及各章節內容，此外自行製作詳細成果報
告一本，共 50 頁；作為致遠管理學院資訊管理學系的研究報告，報告編號為 9701。
(2) 研究成果之學術或應用價值
本研究以朴子溪完研究案例，以 NETSTARS 模式模擬的牛稠溪橋及灣內橋水位資料為
背景進行倒傳遞類神經網路的訓練、測試及產生接近實測資料的曼寧 n 值參數，以全河段
的河床模擬成果進行上述的過程，並得到最佳的 Alt 值。另以導引模擬退火法設定目標函
數，退火過程參數逼近實測資料，求得曼寧 n 值及 Alt 值，由模擬成果做 MSE 分析與兩種
最佳化方法比較，成果顯示，BPN 類神經網路優選模式對上游水位站曼寧 n 值優選成果較
佳，但對其他下游測站參數優選成果不佳，對河床變動的參數優選結果也不佳。導引模擬
退火法的成果與 BPN 情形一樣，但參數成果較接近模擬成果分析 MSE 的最佳值。
(3) 是否適合在學術期刊發表或申請專利
本計畫的研究成果適合在學術期刊發表。
