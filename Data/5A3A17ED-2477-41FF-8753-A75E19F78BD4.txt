 I 
 
中文摘要 
關鍵詞：IEEE 802.11e、允入控制、排程策略、變動位元速率、常數位元速率 
3G與WiMAX/WLAN 的結合，是必然的趨勢，而 IEEE 802.11 MAC Protocol，早已成
為研發WLAN的重要標準。IEEE std 802.11e標準的訂定，將使得下一代高速率的無線區
域網路，能同時提供即時性(Real-Time)及非即時性(Non Real-Time)的多媒體傳輸服務，此
將影響未來WLAN的發展，以及市場的走向。在本二年期計畫裡，我們以「變動位元速率
與常數位元速率訊務流在 IEEE 802.11e 無線區域網路上的允入控制及排程策略研究」為
題，對 802.11e/a QoS-Capable MAC效能的最佳化，以及同時能支援 CBR/VBR Voice/Video，
具即時性之訊務流服務品質保證的允入控制與排程策略，包括本計畫書中所討論的諸多研
究項目等，作有系統的探討與模擬分析。因此本計畫將有助於 IEEE 802.11e/a 的實現，以
及即時影音訊務流在 QoS-Capable Wireless LAN上傳送的效能評估。 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 III 
 
 
目 錄 
 
一、 前言                 1 
二、 研究目的              2 
三、 文獻探討                3-4 
四、 研究方法 
4.1 H.264的跨層機制設計           4-5 
4.2 VBR H.264/AVC Video Streams的研究       6-10 
4.3 IEEE 802.11e存取機制研究          11-18 
4.4 IEEE 802.11a 實體層傳輸          18-20 
4.5 BRAN A通道環境各雜訊比傳輸速率選定      20-21 
4.6 VBR H.264/AVC的 SBA參數設定        22-28 
4.7 允入控制及排程策略初探          28-39 
4.8 為 Handoff calls做頻寬保留的允入及排程策略     39-47 
4.9 考量重傳機制的系統模擬與數據分析       47-50 
五、 結果與討論（含結論與建議） 
5.1 允入控制與排程的模擬分析         50-57 
5.2 結論               58-59 
5.3 未來研究方向              59 
5.4 計畫成果發表             59  
 2 
二. 研究目的 
 
無線通訊技術的發展日漸成熟，帶動多樣化的多媒體應用及龐大商機，人們的生活習
慣因此有了改變，即時訊息及即時性視訊帶著走，不再受限於有線網路，只能於定點獲得
網路資訊的缺點。但是無線訊號極易受到干擾，通訊品質難以保證，因此如何提供最佳的
服務品質保證，多年來一直是研究人員努力的方向。即時性較強的多媒體視訊對延遲以及
封包遺失皆非常敏感，而且其資料流具有變動位元率(Variable Bit Rate，VBR)的特性，又
具有高變動的資料叢集(burst)現象，造成欲在無線網路上傳送多媒體資料並維持良好的視訊
品質是具有相當的挑戰性。為了滿足不同多媒體應用服務品質保證的需求，因此本論文的
研究目的之一，就是分析視訊畫面內所產生不同重要性的資料，對於錯誤影響進行評估，
提供不同等級的保護，並使用重送機制來降低訊框錯誤率(Frame Error Rate，FER)。以提供
一個良好的即時性資料流服務品質保證，讓影像在解壓縮時，不會因為封包的錯誤造成解
壓失敗，進而讓使用者不能夠忍受視訊上的模糊與延遲。 
    一般來說，基地台（Basic Station，BS）可由擷取點（Access Point，AP）來擔任，以
基地台的觀點來看，為了不讓等待傳送的站台漫長等待，基地台會希望盡可能地同時為多
部工作站台服務，但前提是對每一部站台皆能做到服務品質保證，為了達到兩者兼顧，必
須要設計一套完善的允入控制系統與排程策略。然而，移動中的站台有超出基地台覆蓋範
圍的疑慮，一旦該站台從一基地台覆蓋範圍移動至另一基地台的覆蓋範圍內，此時會進行
換手（Handoff）機制，以確保傳送中的訊務流不會因此而發生斷訊或收訊不良。換手行為
執行成功與否，與當時通道是否有足夠頻寬相關，尤其在通道壅塞時更有此疑慮，如何讓
handoff calls隨時都能順利被基地台允入，是值得探討的議題，上述皆是本論文研究的主要
目的。 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 4 
但我們覺得[8]著重在 HCCA scheduling更甚於 admission，因此在本計畫第二年的排程研究
方法中，我們有詳細介紹[8]的方法。文獻[9]覺得 TSPECs 之間的 Scheduling，必須達到
Fairness，因此提出了 Deficit-based Modified Self-Clocked Fair Queuing 的演算法，來作
802.11e的 Call Admission & Scheduling。但[9]並未論及如何才算 TSPECs間達到 Fairness，
本計畫預期可將 Channel Quality相近的 QSTAs視為一大群，再根據 Application Profile相近
的 TSPECs分為小群，如此整體性的來作群與群之間的 Fair Scheduling。 
 
[1] N. Ramos, D. Panigrahi, and S. Dey, “Quality of Service Provisioning in 802.11e Networks: 
Challenges, Approaches, and Future Directions,” IEEE Network, Vol. 19, No. 4, pp.14-20, 
July-Aug 2005. 
[2] P. Ansel, Q. Ni, and T. Turletti, “An Efficient Scheduling Scheme for IEEE 802.11e,” Proc. 
Modeling and Optimization in Mobile, Ad Hoc and Wireless Networks, 2004. 
[3] N. Ramos, D. Panigrahi, and S. Dey, “Dynamic Adaptation Policies to Improve Quality of 
Service of Multimedia Applications in WLAN Networks,” Proc. Int’l. Wksp. Broadband 
Wireless Multimedia, San Jose, CA, 2004. 
[4] A. Grilo, M. Macedo, and M. Nunes, “A Scheduling Algorithm for QoS Support in IEEE 
802.11E Networks,” IEEE Wireless Commun., June 2003, pp. 36–43. 
[5] C. Casetti, C.F. Chiasserini, L. Merello and G. Olmo, “Supporting Multimedia Traffic in 
802.11e WLANs,” in Proc. of IEEE VTC-Spring, 2005, pp.2340-2344. 
[6] A. Ksentini, M. Naimi and A. Gueroui, “Toward an Improvement of H.264 Video 
Transmission over IEEE 802.11e through a Cross-Layer Architecture,” IEEE 
Communications Magazine, Jan. 2006, pp. 107-114.  
[7] P. Bucciol, et al., “Cross-Layer Perceptual ARQ for H.264 Video Streams over 802.11 
Wireless Networks,” in Proc. of IEEE Globecom’04, 2004, pp. 3027-3031. 
[8] Pierre Ansel, Qiang Ni and Thierry Turletti. " An Efficient Scheduling Scheme for IEEE 
802.11e". in ACM/Kluwer Journal on Mobile Networks and Applications (MONET), Special 
Issue on Modeling and Optimization in Wireless and Mobile Networks, 2005. 
[9] J. R. Ga;;ardo, P. Medina and W. Zhuang, “QoS Mechanisms for the MAC Protocol of IEEE 
802.11 WLANs,” in Proc. of QShine’05, 2005. 
 
四. 研究方法 
**********兩年期計畫的第一年********** 
4.1 H.264 的跨層機制設計 
隨著無線網路的發展，帶給我們生活上莫大的便利，但鑒於多媒體傳送於無線網路上
的需求日益增加，如何保證即時性（real-time）較強的多媒體應用（例如隨選視訊、線上會
議以及Voice on IP 等等）的服務品質（Quality of Service，QoS）問題變得日益突出。本節
提出一套跨層（Cross Layer）服務品質對應機制，如圖4.1簡易所示，而跨層的設計則是希
望能打破傳統分層的侷限，各協定層希望能互相溝通，不再只侷限在其上下兩層，而更廣
 6 
4.2 VBR H.264/AVC Video Streams 的研究 
在無線傳輸的環境下，由於無線訊號極易受到干擾，通訊品質難以保證，因此改善傳
送影像的品質是十分重要的課題。近年來有許多研究學者發現，跨層機制的對應設計可以
明顯改善傳統機制的缺點，進而提升傳送效率及改善影像傳送的品質，因此VBR H.264/AVC 
video streams的研究，對於專門於IEEE 802.11e MAC層設計傳送機制的設計者而言，成為重
要的研究重點。本章節會分為二部分的討論，首先研究VCL依據參數重要性將資料分成數
個部分的資料分割技術，再來研究NAL針對下層網路的特性對資料進行封包封裝。 
H.264/AVC標準考慮抗錯能力要強的行動視訊應用，提供一套錯誤恢復工具（error 
resilience tools）[1][2]可將錯誤帶來的影響降低，像是靈活巨集區塊排序（FMO）、任意畫
面片段排序（ASO）和資料分割（DP）等抗錯功能。在本計畫中，我們針對Extended Profile
編碼規模所提供資料分割技術來運用，來區分視訊資料的不同重要性，進行不等權的保護，
即對重要資料進行等級較高的保護。 
在H.264/AVC中有三種不同的資料分割: 
 標頭資訊（Header information）稱為  Partition A：包含切片中巨集區塊的類型
（Macroblock Type），量化參數（Quantization Parameter）和移動向量（Motion Vector）
等重要的資訊。 
 內部分割（Intra Partition）資訊稱為Partition B：主要則是攜帶內部塊編碼模式（Intra 
CBP）以及內部係數（Intra Coefficient），intra資訊可以阻止錯誤的蔓延，必須要在
Partition A有效的情況下才可使用。 
 互相分割（Inter Partition）資訊稱為Partition C：此種分割是片段裡面最大的分割區塊，
包含 Inter 的CBP和Inter係數，也需要在Partition A可用的情況下才可使用，但Partition 
C使用不因Partition B存在與否而受限制。 
    Partition B結合Partition A訊息解出Intra巨集區塊；Partition C結合Partition A訊息解出
inter巨集區塊，所以Partition B與Partition C兩者都需靠Partition A才可解出巨集區塊，由上
述得知三者中的Partition A所佔其重要性最高，然而因為Partition B可以阻止錯誤的蔓延，
所以重要性比Partition C來的高，而Partition C的重要性最低。從解碼端（Decoder）的觀點
來看，若接收到所有的分割，就可以完整重建切片；解碼端若發現Partition B或Partition C
遺失，其Partition A可被用來做為錯誤回復改善的依據，並利用巨集區塊型態與移動向量資
訊來協助較高品質之重建。 
 本計畫的做法在於資料分割正常的情況下，視訊影像在VCL經過編碼之後，每個I 
picture與P picture可分割一到數個的片段（slice），再將每個slice分為具有不同重要性的
Partition A、Partition B、以及Partition C，讓視訊影像更適應網路的傳輸環境。另外，要先
特別聲明，每個壓縮視訊序列，第一張畫面為Instantaneous Decoding Refresh（IDR）picture，
採用intra-prediction編碼，所以IDR picture可自行完全解碼，不需參考其他畫面來做預測編
碼，IDR picture本身也提供給後續的P picture做參考，所以IDR picture會影響後續的畫面，
其重要性可見一般。事實上IDR picture不做資料分割，在本計畫機制裡是把IDR整張畫面資
料的重要性，歸類為與Partition A一樣，具有最高重要性。 
 8 
Partition。以下為Forman視訊影像採用Intra-frame coding的I picture所區分的Partition A、
Partition B、Partition C 大小分佈圖。 
 
圖4.5 I picture的Partition A大小分佈圖 
 由於我們對Forman視訊影像壓縮編碼長度為100張，畫面群設定為1I9P，所以由圖4.5可
看出有10張I picture的bits大小，因為視訊第一張畫面是IDR不區分Data Partition，且本論文
把IDR全部設為Patition A，所以圖4.5中第一張I畫面的資料量為最大，其它的I picture的資料
大小大概為15000 bits左右。由圖4.5與圖4.6可看出，Partition B資料量特別大而Partition C資
料量特別小，是由於I picture的編碼方式為Intra-frame coding，也就是僅利用本身的資料編
碼，並未參考其他畫面，然而規範所制定的Partition B主要是攜帶內部編碼模式（Intra CBP）
以及內部係數；Partition C主要是攜帶相互塊編碼模式（Inter CBP）以及相互係數，所以會
有Partition B資料量特別大而Partition C資料量特別小特性。圖4.7與圖4.8為Foreman視訊影
像採用Inter-frame coding的P picture所區分的Partition A、Partition B、Partition C 大小分佈圖。 
 
圖 4.6 I picture的Partition B大小分佈圖 
 10
 
圖4.10 P picture的Partition C大小分佈圖 
由於P picture的編碼方式為Inter-frame coding，在編解碼時需參考之前的畫面之資料，
然而規範所制定的Partition B主要是攜帶內部編碼模式(Intra CBP)以及內部係數；Partition C
主要是攜帶相互塊編碼模式(Inter CBP)以及相互係數，所以從圖4.9與4.10可看出Partition B
資料量較小而Partition C資料量較大的特性。 
所有視訊影像經過VCL編碼過後皆是以bitstream的型式，大多現今被用來傳送視訊影
像的網路結構皆不適用於直接傳送bitstream，在許多的網路結構下，bitstream被分拆解成數
個封包來傳輸，所以H.264/AVC標準的特色是將網路提取層的概念涵蓋進來，可以將NAL
當成是一個專作封裝的模組，用來將VCL壓縮過的bitstream封裝成適當大小的封包單位
(NAL-unit)，提供VCL編碼資料與實際網路之間的介接，提高了對行動通訊和IP網路的適應
性。 
 由於VCL是以NAL封包為單位來做編解碼的運算單位，所以前面所介紹的視訊影像經
由VCL所區分的Partition A、Partition B、Partition C是以NAL封包為單位(NAL-unit)的方式
來封裝成封包，並在NAL-unit header中的NAL-unit type欄位記載此封包的類型，如表4.1所
示，每種類型分別對應到VCL中不同的編解碼工具。我們利用Data Partition特性，得知I 
picture的Partition C以P picture的Partition B資料量較小，若是將Partition A、Partition B、
Partition C封裝成NAL-unit的封包，再交由下層網路傳輸，會增加網路上傳輸的overhead，
降低視訊影像傳輸的效率，對接收品質也會造成影響。所以我們提出一套在Network 
Adaptation Layer將Partition B封包與Partition C封包合併為一個RTP封包（稱Partition 
B&C），交由下層網路來傳輸，有助於增進H.264/AVC 在傳輸層上的能力以及提高系統傳
輸的容量。 
表4.1 NAL-unit Type 表格 
Nal_unit_type Content of NAL uint Class 
1 VCL Coded slice VCL 
2 VCL Coded slice data partition A VCL 
 12
種存取機制的比例，都是由系統設計者根據系統需求所自行設計的。在我們的系統中，我
們設定 SI為 25ms，對免競爭週期與競爭週期的時間分配為 3:2，也就是說在 25ms的 SI裡，
免競爭週期為 15ms，競爭週期則為 10ms，會將比例分配這樣，是因為本計畫主要是作即
時性資料在免競爭週期中的分析，但又避免把所有的時間都設計成免競爭週期使用，所以
為了公平性，也就規劃出 10ms的時間當成是給競爭週期所使用。 
 
4.3.2 MAC Layer 訊框資料 
在本計畫中，主要研究 VBR H.264/AVC 即時訊務流在 HCCA存取機制之下，使用重
送方式的效能分析，所以在這裡對我們使用的MAC層 Video訊框格式與其相關特性來做介
紹。這裡我們採用的是 H.264/AVC 的視訊解碼標準，當 H.264 video 訊框要從 AP 下載至
STA，要經過 Internet時所需的 compressed IP/UDP/RTP訊框與 PPP（Point-to-Point Protocol） 
multiplexing 的檔頭總共 8Bytes，再上自己 H.264 video 訊框的長度 188Bytes，總共就會形
成一個 196 Bytes的 Video訊框，之後再進入 IEEE 802.11 MAC層，加上MAC層所需要的
訊框檔頭及同步資訊共 36Bytes，如圖 4.12 所示。 
 
圖 4.12 MAC Video frame format 
 所以當 NAL-unit 封包要傳至 IEEE802.11 MAC層時，先將 NAL-uint 封包切割成數個
188Bytes 大小的 H.264 video 訊框，加上經過 Internet 所需的 8Bytes 訊框檔頭，進入 MAC
層在加上 36Bytes 訊框檔頭及同步資訊，最後將 NAL-unit 封包分割為數個 232 Bytes 的 
MAC 訊框，如下圖 4.13所示。 
 
圖 4.13 MAC frame fragmentation 
 以下為Forman視訊影像I picture所區分的Partition A封包、Partition B&C封包，以
188Bytes大小切割為MAC frame的訊框數分佈圖（K代表MAC訊框個數）。 
 14
 
圖 4.17 P picture的 Partition B&C MAC訊框分佈圖 
圖 4.16與圖 4.17為 Foreman視訊影像 P picture所區分的 Partition A封包、Partition B&C封
包，以 188Bytes大小切割為MAC frame的訊框數分佈圖（K代表MAC訊框個數）。 
 
4.3.3 Np與 SBA參數分析 
當無線網路環境的不穩定與訊號隨著距離而衰減，使得 MAC 訊框在傳送時較容易發
生錯誤，為了有效改善訊框錯誤率（FER），目前最常被使用的解法方案就是MAC層中的
重送機制，然而本計畫主要針對 H.264/AVC VBR 即時性訊務流 TSPEC 中 SBA 參數的設
定，所謂的 SBA 代表給予訊務流超額頻寬的量，使得訊務流可以根據 SBA 值發起重送機
會來降低 FER，本計畫主要是引用[8]從機率數學的角度來分析出參數 SBA 與 FER 之間關
係，找出滿足訊務流所需超額寬的量，另外也會利用數值的方法來算出無法用公式表示的
部分。所以 SBA值是決定每 K個訊框額外給予的重送機會，如公式（1）所示，藉由 SBA
值可以找出額外給予的重送機會 N值，對於由公式（1）所求出的 N值，代表每個 SI裡，
所有資料訊框共用的重送機會，這必須視網路環境的不同由設計者決定的一個參數。 
N = (SBA-1)×K                                                     （1） 
 再來介紹另一個參數 Pdrop，Pdrop這個參數所代表的意思，就是訊框經通道傳輸之後遺
失的機率，然而 Pe是代表通道錯誤機率，經由公式（2）[9]所示，可從公式發現 Pdrop值的
大小完全決定於 Np，然而 Np 所代表的意義為每個傳送的訊框能夠重送的次數，所以假如
Np值越高的話，訊框所能重送的次數就越多，代表訊框遺失率就可降低，特別是對於即時
性的資料而言，即性的資料有時間上的延遲限制(Delay Bound，DB)，所以如何讓 Np值提
升每個訊框重送的次數，也是很值得探討的問題。 
1
( ) P
N
drop eP P
+=                                                     （2） 
 16
( )
2
= 1
K
X K-X y
1 2 e e
X
y X
K y
f X = x +x p ( - p )
y X y
+
 ≤ ≤  
   
⋅ ⋅ ⋅   −   
∑                     （8） 
 如下圖 4.22 所示，利用所推導的公式（5）以及公式（7）可以得到，當 K=100，也就
是傳送 100個訊框，通道錯誤率 Pe = 0.3的時候，Np=1以及 Np=2的機率質量函數，從公式
（6）得到期望值分別為 100×0.3 = 30與 100×(0.3+0.32 ) = 39。 
( 1)pN =
( 2)pN =
1x
1 2x x+
ep
 
圖 4.22 Np=1以及 Np=2的 pmf 
 
4.3.5 Ri(n)與 FER 
在本節將延續前一節更深入的探討，有了上一節所得到的機率質量函數之後，首先介
紹另一個參數 N，N是代表著傳送 K個訊框MAC controller所給予發起重傳機會的個數，N
值的大小決定於 SBA，例如，當 K=100、SBA=1.2、N=(SBA-1)×K = 20，傳送端傳送 100
個訊框後，錯了 22個訊框，這時候將有 20個訊框可以發起重傳。又例如，當 Np = 2、K=100、
SBA=1.2、N = (SBA-1)×K = 20，傳送端傳送 100個訊框後，錯了 15個訊框，這時候傳送
端將可以有 15個訊框可以發起重傳，又因為 Np=2的關係，若是這 15個重傳的訊框又發生
錯誤，傳送端尚有 5個機會可以在下個 SI發起重傳。 
 接著介紹 Ri(n)，所謂 Ri(n)是一個期望值，一個當 Np = i 且 N = n 的時候，系統使用
重傳個數的期望值，Ri(n)可以藉由下列公式（9）求出，如圖 4.23 所示，Ri(n)隨 N變大而
變大，最大值趨近於期望值 E[X]，從圖 4.23 可以觀察到，Np =1 的時候 R1(n)最大趨近於
30，當 Np =2 的時候 R2(n)最大趨近於 39。 
 
 18
 
 到目前為止我們利用公式所推導出了Ri(n)，如圖4.23 所示，再藉由Ri(n)代入上述所介
紹的公式（10）推出了FERi(n)，如圖4.25所示，為Np = 1及Np = 2各別的FER。 
100K =
0.3ep =
1
p
N =
2
p
N =
N
F
E
R
 
圖 4.25 FER與N的對應圖 
 以上所導出的公式適用於 Np = 1與 Np = 2，Np大於等於三的公式過於複雜，也相當的
冗長，所以當 Np大於等於三的時候，改用數值的方法來找到答案，利用程式來進行計算，
使用多層的 for loop來完成，下列所示是以 Np = 3為例，三層的 for loop可以求出 Np = 3的
機率質量函數。 
 
int 1x , 2x 3x ; float [] 0Xf =  
for ( 1 0x = ; 1 100x <= ; 1x + + ) 
  {( 2 0x = ; 2 100x <= ; 2x + + ) 
    {( 3 0x = ; 3 100x <= ; 3x + + ) 
     1 2 3;X x x x= + +  
      1 2 1 3 2[] [] ( ;100, ) ( ; , ) ( ; , )}};X X e e ef f f x p f x x p f x x p= ⋅ ⋅ ⋅  
其中 ( )( ; , ) 1 b aae e e
b
f a b p p p
a
− 
= ⋅ − 
 
為一個 Binominal distribution的機率質量函數 
    當 pN 大於等於三的時候，可以利用上述的方法求得
i
1
i i
j=
f X = x
 
 
 
∑ ，再利用先前提供的
公式（9），就可以求得Ri(n)，有了Ri(n)之後FER也就可以利用公式（10）求得。在本章節
利用了Pe、Np和N求得了Ri(n)，再利用Ri(n)求得FER，有了這些方法，就可以從求得的FER
理論值找尋可以達到滿足使用者的N值，設計者就可以利用這些資訊反推所要設定的SBA
參數，進而達到品質保證的目的。 
 
4.4 IEEE 802.11a 實體層傳輸 
本計畫主要目的在於準確模擬出 HCCA存取機制的效能及重送機制的影響，所以除了
 20
                       
註：LENGTH＝（36＋n）Bytes，NDBPS＝24、36、48、72、96、144、192、216。 
 
在 IEEE 802.11a標準中，使用了 OFDM作為調變技術，在此調變技術上，使用者有八
種速率可選擇使用，分別為 6 Mb/s、9 Mb/s、12 Mb/s、18 Mb/s、24 Mb/s、36 Mb/s、48 Mb/s
以及 54Mb/s。為能準確計算出即時性資料和控制訊框在各速率上所需時的間，所以本計畫
使用上述的計算公式來進行計算，即可完成如下表 4.2。 
 
表 4.2 即時性資料和控制訊框使用各速率傳送所需時間 
Rate（bps） 6M 9M 12M 18M 24M 36M 48M 54M 
Video 336µs 232µs 180µs 128µs 100µs 76µs 60µs 56µs 
Poll 72µs 56µs 48µs 40µs 36µs 32µs 28µs 28µs 
Ack 44µs 36µs 32µs 28µs 28µs 24µs 24µs 24µs 
Null 72µs 56µs 48µs 40µs 36µs 32µs 28µs 28µs 
BlockAckReq 56µs 44µs 40µs 32µs 32µs 28µs 28µs 24µs 
BlockAck 228µs 160µs 124µs 92µs 72µs 56µs 48µs 44µs 
 
4.5 BRAN A 通道環境各雜訊比傳輸速率選定 
 本計畫將利用CommAccess Technologies公司所製作的WLAN Toolbox for MATLAB
（mWLAN）for IEEE Std. 802.11a的模擬工具進行BRAN Model，Channel A各訊雜比的傳輸
速率選定。但在這裡必須先說明一個重點，本計畫各訊雜比所選定的傳輸速率是自行依照
考慮系統需要所選定的，本系統的考慮重點是依照視訊影像所區分Partition A的FER需降至
10
-3，以及Partition B&C的FER需降至0.03為考量，利用重送機制把FER降至所定的目標。 
表 4.3 BRAN Model，Channel A FER 
Data rate 
(Mbits/s) 
Modulation Coding rate 
（R） 
SNR 
=5 
SNR 
=6 
SNR 
=7 
SNR 
=8 
SNR 
=9 
SNR 
=10 
SNR 
=11 
SNR 
=12 
SNR 
=13 
6 BPSK 1/2 0.822 0.747 0.659 0.560 0.467 0.376 0.287 0.209 0.152 
9 BPSK 3/4 0.896 0.840 0.781 0.712 0.645 0.555 0.473 0.391 0.317 
12 QPSK 1/2 0.815 0.736 0.635 0.541 0.443 0.343 0.261 0.193 0.134 
18 QPSK 3/4 0.899 0.849 0.789 0.716 0.636 0.564 0.486 0.400 0.327 
24 16-QAM 1/2 0.944 0.901 0.843 0.767 0.679 0.576 0.475 0.379 0.290 
36 16-QAM 3/4 0.985 0.967 0.941 0.898 0.853 0.789 0.719 0.646 0.553 
48 64-QAM 2/3 1.000 0.998 0.993 0.979 0.960 0.925 0.884 0.819 0.746 
54 64-QAM 3/4 1.000 0.999 0.998 0.992 0.983 0.962 0.931 0.886 0.834 
 
SNR 
=14 
SNR 
=15 
SNR 
=16 
SNR 
=17 
SNR 
=18 
SNR 
=19 
SNR 
=20 
SNR 
=21 
SNR 
=22 
SNR 
=23 
SNR 
=24 
SNR 
=25 
0.104 0.073 0.047 0.032 0.021 0.016 0.011 0.006 0.005 0.004 0.004 0.002 
0.253 0.201 0.151 0.109 0.077 0.056 0.038 0.025 0.016 0.009 0.006 0.004 
0.091 0.058 0.039 0.027 0.017 0.011 0.006 0.005 0.003 0.002 0.001 0.001 
 22
4.6 VBR H.264/AVC 的 SBA 參數設定 
本計畫所討論的視訊訊務流，是具有資料分割特性的 extend profile，I picture與 P picture
其每張畫面皆可分割為 Partition A、B、C三種重要性不同的資料，在封裝成MAC 訊框時，
本論文又將 Partition B和 Partition C合併為 Partition B&C，因此在傳送MAC訊框時，因此
MAC訊框傳送資料依照重要性的不同，由重要性的不同依序為 I picture的 Partition A（簡
稱 I_A）、I picture的 Partition B&C（簡稱 I_BC）、P picture的 Partition A（簡稱 P_A）、以
及 P picture的 Partition B&C（簡稱 P_BC）。 
 相同類型的MAC訊框，其 TSPEC的 SBA欄位應具備相同的參數設定，然而 VBR訊
務流在每一 SI所傳送的訊框個數（K值）不盡相同，對於不同 K值應該視情況給予不同的
重傳機會，因此適當 SBA參數設定以及靈活運用 SBA參數變的十分重要。本論文運用 4.2
節訊框分配的方法，可統計各 TSPEC類型訊框在各 SI的分佈，再引用[11]SBA參數選定的
方法做為系統架構的一部份，其估計四個 TSPEC中 SBA值的選定步驟如下： 
1. 以各 TSPEC類型訊框的分佈，取 K值的平均(稱 mean_K)，並且利用 4.3.5節所推導
的公式及公式(1)來估計 SBA值。 
2. 以 mean_K的 SBA值套用到其它的 K值： 
 若訊框分佈的 K值小於 mean_K，則利用 mean_K估計的 SBA值套入公式(1)所算
出來的值，以無件進位來求得所需的 N值。 
 若訊框分佈的 K值大於 mean_K的話，則利用 mean_K估計的 SBA值套入公式(1)
所算出來的值，以四捨五入來求得所需的 N值。 
本計畫用了三種影片類型做為視訊訊務流來源，本論文將以播放 300 張 Akiyo 影片為
例，說明 SBA參數選定過程。 
0 1 2 3 4 5 6 7 8
0
10
20
30
40
50
60
K
N
u
m
b
e
r
 o
f 
S
I
 
圖 4.28 I picture的 Partition A 訊框分佈圖 
圖 4.28是對 Akiyo視訊 I picture Partition A訊框分佈圖的 mean_K=8，利用 4.3.4節與
4.3.5 節所推導的公式及數值方法，來求出在不同 SNR 通道環境下，FER 降至 10-3以下所
需的 N值，如表 4.3所示。在不同 SNR通道環境下，可由表 4.3得知 FER降至 10-3以下各
所需的 N值，因此就利用 N值這項資訊，反推以 I picture Partition A所建立的 TSPEC欄位
中的 SBA參數值，如表 4.4所示。 
 
 24
0 1 2 3 4 5 6 7 8
0
10
20
30
40
50
60
K
N
u
m
b
e
r
 o
f 
S
I
 
圖 4.29 I picture的 Partition B&C 訊框分佈圖 
 
表 4.6 I picture Partition B&C K=8 FER表 
N 
SNR 
0 1 2 3 4 5 6 7 8 
SNR_12 0.193 0.11027 0.055558 0.025178 0.010452 0.004083 0.001588 0.000693 0.000396 
SNR_13 0.134 0.059993 0.022694 0.007531 0.002255 0.000635 0.000188 7.62E-05 5.02E-05 
SNR_14 0.091 0.03034 0.008237 0.001924 0.000401 7.94E-05 1.86E-05 8.17E-06 6.52E-06 
SNR_15 0.155 0.07683 0.032704 0.012324 0.004212 0.001354 0.000446 0.000183 0.000112 
SNR_16 0.103 0.037869 0.011461 0.003001 0.000703 0.000156 3.91E-05 1.64E-05 1.24E-05 
SNR_17 0.07 0.018801 0.004032 0.000737 0.00012 1.86E-05 3.89E-06 1.95E-06 1.71E-06 
SNR_18 0.194 0.11119 0.056238 0.025594 0.010673 0.004188 0.001636 0.000715 0.000408 
SNR_19 0.151 0.073522 0.03065 0.011292 0.003769 0.001183 0.000382 0.000156 9.69E-05 
SNR_20 0.163 0.083577 0.037018 0.014565 0.005209 0.001751 0.000599 0.000248 0.000149 
SNR_21 0.119 0.048841 0.01673 0.004994 0.00134 0.000339 9.28E-05 3.78E-05 2.65E-05 
SNR_22 0.178 0.096667 0.045831 0.019425 0.007512 0.002732 0.000998 0.000423 0.000247 
SNR_23 0.135 0.060764 0.023127 0.007725 0.002329 0.00066 0.000197 7.96E-05 5.22E-05 
SNR_24 0.098 0.034655 0.010043 0.002512 0.000562 0.000119 2.90E-05 1.24E-05 9.56E-06 
SNR_25 0.076 0.02187 0.005054 0.000998 0.000175 2.94E-05 6.35E-06 3.04E-06 2.60E-06 
在不同 SNR 通道環境下，可由表 4.6 得知 FER 降至 10-3以下各所需的 N 值，因此就
利用 N值這項資訊，反推以 I picture Partition B&C所建立的 TSPEC欄位中的 SBA參數值，
如表 4.7所示。 
表 4.7 I picture Partition B&C K=8的 N與 SBA對應表 
SNR SNR_12 SNR_13 SNR_14 SNR_15 SNR_16 SNR_17 SNR_18 
N 3 2 2 3 2 1 3 
SBA 1.4 1.3 1.3 1.4 1.3 1.1 1.4 
SNR SNR_19 SNR_20 SNR_21 SNR_22 SNR_23 SNR_24 SNR_25 
N 3 3 4 3 2 2 1 
SBA 1.4 1.4 1.5 1.4 1.3 1.3 1.1 
利用上表 4.7 I picture Partition B&C所建立的 TSPEC欄位中的 SBA參數值，來給予其
 26
SNR_22 0.178 0.044706 0.010276 0.002242 0.000472 0.000218 
SNR_23 0.135 0.026107 0.004589 0.000763 1.22E-04 5.27E-05 
SNR_24 0.098 0.013935 0.00179 2.17E-04 2.53E-05 1.02E-05 
SNR_25 0.076 0.008445 0.000845 7.96E-05 7.22E-06 2.81E-06 
在不同 SNR 通道環境下，可由表 4.9 得知 FER 降至 10-3以下各所需的 N 值，因此本
計畫就利用 N值這項資訊，反推以 P picture Partition A所建立的 TSPEC欄位中的 SBA參
數值，如表 4.10所示。 
表 4.10 P picture Partition A K=2的 N與 SBA 對應表 
SNR SNR_12 SNR_13 SNR_14 SNR_15 SNR_16 SNR_17 SNR_18 
N 4 3 3 4 3 2 4 
SBA 3 2.5 2.5 3 2.5 2 3 
SNR SNR_19 SNR_20 SNR_21 SNR_22 SNR_23 SNR_24 SNR_25 
N 4 4 3 4 3 3 2 
SBA 3 3 2.5 3 2.5 2.5 2 
利用上表 4.10 P picture Partition A所建立的 TSPEC欄位中的 SBA參數值，來給予其它
K 值，計算出在各 SNR 的重傳機會 N 值，使得可以發起重送以降低 FER，由表 4.11 可看
出本計畫所訂定的 SBA值無法使 K=1在各 SNR的 FER皆可降至 10-3以下的目標，甚至大
部分的 SNR環境皆超出 10-3，由此現象本計畫推測[11]提出的 SBA參數設定方法，在 K值
較小的情況下可能無法分配適量的額外頻寬以提供重傳。 
表 4.11 P picture Partition A K=1的 N與 FER對應表 
SNR SNR_12 SNR_13 SNR_14 SNR_15 SNR_16 SNR_17 SNR_18 
SBA 3 2.5 2.5 3 2.5 2 3 
N 2 2 2 2 2 1 2 
SNR SNR_19 SNR_20 SNR_21 SNR_22 SNR_23 SNR_24 SNR_25 
SBA 3 3 2.5 3 2.5 2.5 2 
N 2 2 2 2 2 2 1 
圖 4.31是對 Akiyo視訊 P picture Partition B&C訊框分佈圖的 mean_K=1，利用前述所
推導的公式及數值方法，來求出在不同 SNR通道環境下，FER降至 0.03以下所需的 N值，
如表 4.12所示。 
 28
N 1 1 1 2 1 1 1 
SBA 2 2 2 3 2 2 2 
利用上表 4.13 P picture Partition B&C所建立的 TSPEC欄位中的 SBA參數值，來給予
其它 K值，計算出在各 SNR的重傳機會 N值，使得可以發起重送以降低 FER，由下表 4.14
可看出本計畫所訂定的 SBA 值皆可使 K=2 在各 SNR 的 FER 皆可降至 0.03 以下的目標，
甚至遠低於 0.03。此現象表示所分配的額外頻寬非常充裕甚至有分配過多的可能性。 
表 4.14 P picture Partition B&C K=2的 N與 FER對應表 
SNR SNR_12 SNR_13 SNR_14 SNR_15 SNR_16 SNR_17 SNR_18 
SBA 3 2 2 2 2 2 3 
N 4 2 2 2 2 2 4 
SNR SNR_19 SNR_20 SNR_21 SNR_22 SNR_23 SNR_24 SNR_25 
SBA 2 2 2 3 2 2 2 
N 2 2 2 4 2 2 2 
 
 
**********兩年期計畫的第二年********** 
 
4.7 允入控制及排程策略初探 
本計畫研究目的是針對多個 VBR視訊訊務流，在 IEEE 802.11e無線區域網路上的允入
與排程做設計，期望能達到同時服務多部站台，並且皆達到服務品質保證的目的。Admission 
algorithm 可說是負責管理被輪詢站台數；scheduling algorithm 則負責妥善分配頻寬給所有
被輪詢的站台，因此 MAC 層的允入控制必須有一套完善的機制做決策，一旦任何站台成
功地被允入後，緊接著便是 scheduling algorithm對所有等待輪詢的站台做頻寬分配的排程
工作了。本章節將考慮多台站台同時傳輸 H.264/AVC視訊訊務流的情況時，基於訊務流的
特性，I picture的資料量比 P picture的資料量大許多，所以 scheduling algorithm必須有一套
排程策略以避免因頻寬分配不平均所造成的通道壅塞現象。 
真實環境下的通道，會有雜訊的干擾、建築物的遮蔽、以及訊號的衰減而造成訊框傳
送失敗的情形發生，訊框傳送失敗可視為不確定因素，為了簡化系統設計必須考慮的因素，
因此本計畫暫不考慮訊框由於傳送失敗必須重傳的情形，如此一來便能準確的估算出各站
台訊務流所需 TXOP時間，以下將針對 error-free的視訊訊務流傳輸情形做研究。 
 
4.7.1 Error-free 排程研究 
本計畫將一個 SI 的時間長度訂為 25ms，其中競爭週期佔 10ms；免競爭週期則是佔
15ms，而本計畫主要是針對免競爭週期下的 HCCA存取機制做研究。本計畫僅針對 HCCA
做允入控制研究。關於本章的討論重點，是在 error-free的環境下，初步的探討排程策略的
擬定，本節將以訊務流為播放畫面率每秒 10張的站台為例，畫面群皆為 1I9P，每台皆傳送
100張畫面進行模擬。由[11]可得知視訊訊務流的排程，每張 I picture的訊框數均分到所佔
四個 SI裡，由於 I picture的資料量甚大，所以均分完的每個 SI的訊框數也較大，因此對於
多個視訊訊務流在 IEEE 802.11e無線區域網路傳輸的排程上，初步做法是儘量避免有兩台
以上的站台，同時在傳送視訊訊務流為 I picture的資料，否則會造成部分 SI已用於傳輸的
 30
 
圖 4.32 各站台的訊務流在各 SI之 HCCA使用時間分布 
    觀察一段時間後可以發現，當所有站台的畫面群皆設定為相同的 1I9P時，在統計特性
上具有週期性，也就是每次的Window內會有相同的趨勢。然而在每段 picture interval 內，
第一、第二 SI的 HCCA使用時間都較高，而第三、第四 SI的 HCCA使用時間都很低，而
且幾乎都為 I picture 所耗費的時間，這是因為每一個 SI 內都會有某一台站台正在傳送 I 
picture，其餘 9台則正在傳送 P picture，由於 P picture的資料量較小，只需用到第一、第二
SI傳送訊框，第三、第四 SI則不傳送任何資料，所以才會使得 10台站台的 HCCA時間使
用情形，在通道上每段 picture interval的第三、第四 SI，其 HCCA使用時間明顯小很多而
且幾乎都為 I picture所耗費的時間。為了使每段 picture interval內 HCCA使用時間已經偏
高的第一、第二 SI，其壅塞情形不因允入第 11台站台後而再加劇，本計畫的初步概念是，
對Window內的 10個 picture interval觀察，找出各個 picture interval 中的第一個 SI做比較，
比較該 SI中 HCCA的時間使用情形，並找出最小使用時間為哪一個 picture interval的第一
個 SI。 
為了方便表達上述找尋相對低點的特性，本計畫定義了一個參數如(13)式，方程式(14)
則表示所找的第(n-1)th Window的第 l個 picture interval內，第一個 SI之 HCCA所使用的時
間為所有 THCCA(n-1, l, j=1)的最小值。 
THCCA(n,i,j)：第 nth Window的第 i個 picture interval內，第 j個 SI之 HCCA所使 
           用的時間，其中 i = 1, 2, …, GOP=10; j = 1, 2, 3, 4 ………………(13) 
THCCA(n-1, l, j=1)=min{THCCA(n-1, i, j =1), i=1,2,…, GOP=10}…………………..(14) 
這關係著允入控制時，必須以 THCCA(n-1, l, 1)加上新加入的站台所需時間的總和，來判
斷是否超出 HCCA時間門檻值，做為決定允入與否的依據。如此一來可以使得原本 HCCA
時間使用情形已經偏高的 SI 不再增加負荷。假設在 scheduling 中已存在 10 台站台，並且
有第 11台站台要求加入輪詢，若是現在暫不考慮允入問題（即假設所有站台皆可被允入），
只單純討論排程機制的話，由圖 4.32的例子可以看出，在時間 1~2 sec 的Window中，其
 32
 
 
圖 4.34 「方法一」各站台的訊務流在各 SI之 HCCA使用時間分布 
 
     圖 4.35 「方法二」各站台的訊務流在各 SI之 HCCA使用時間分布 
 
4.7.2 允入控制初探 
 34
個 picture interval的第一個 SI，也就是找出 THCCA(n-1, l, j=1)。接下來 admission algorithm
必須判斷新的 connection是屬於 handoff call還是 newly generated call。以下將這兩部份分別
做討論，首先來探討 newly generated call的部份，由於 newly generated call一旦被允入，該
站台必定從第一張畫面，也就是從 IDR畫面開始傳輸，然而本計畫基於一張畫面佔四個 SI
的時間為由，將 IDR的資料量均分至四個 SI，所以平均每個 SI所花費的時間，為傳送 IDR
畫面所需 TXOP的四分之ㄧ（以 TXOP(IDR/4)表示）。因此若欲得知允入 newly generated call
是否會超出 HCCA 的時間上限，必須判斷 THCCA(n-1, l, 1)加上新加入的站台所需時間
TXOP(IDR/4)之時間總和，是否有超過時間門檻值。若是時間總和在門檻值之內，則允許
newly generated call 加入並且進入排程機制。反之，若時間總和超出門檻值，則 newly 
generated call將會被拒絕允入。 
    由於免競爭週期佔每個 SI的 15ms，因此本計畫希望加上新連線站台（可能是 handoff 
call或是 newly generated call）的時間總和不超過 15.5ms，表示在免競爭週期時間使用的最
大限度，除了用盡本身原有的 15ms之外，最多只能向競爭週期借取 0.5ms。然而本計畫考
慮到一旦在WLAN通道壅塞的時候，為避免此時有 handoff calls欲新增連線，而 AP卻沒
有多餘的頻寬可提供給 handoff calls的情形，因此 admission algorithm必須特地預留頻寬以
保護通道壅塞時 handoff calls 仍有允入的機會。因為 GOP 的特性（假設為 1I9P），所以無
須每個 SI都保留 3ms 給 handoff call，只需選擇數個（2~3個）picture intervals的第一個 SI，
特地在 HCCA時間內要（根據 Handoff Blocking的 QoS）保留 3ms 給 handoff call。假設現
在有一 newly generated call要求加入輪詢，若是該Window內的 l th不屬於保留給 handoff call
的 picture interval，則時間總和的門檻值為 15.5ms；若是該 Window 內的 l th屬於保留給
handoff call的 picture interval，則時間總和的門檻值為 12.5ms。以上便是 newly generated call
的允入法則。 
    Handoff call是指在BSS內一個正在連線的站台換至另一個BSS與其它AP建立連線的
動作，因此一旦允許該 handoff call加入，該站台並非從第一張 IDR畫面開始傳送，handoff 
call過來是新的畫面開始，本計畫假設直接從 I picture開始，從一個新的 GOP開始。在本
論文的排程機制中，對於站台數前 10 台與第 11 台之後的排程策略並不相同，因此由允入
方塊圖可看到，若是 new connection為 handoff call，則必須先判斷已經被允入的站台數是
否超過 10台，若是站台數低於 10台，則必須判斷 THCCA(n-1, l, 1)加上新加入的站台所需時
間 TXOP(I_DP(A))之時間總和，是否有超過時間門檻值 15.5ms。若是時間總和在門檻值之
內，則允許 handoff call加入並且進入排程機制；反之，若時間總和超出門檻值，則 handoff 
call將會被拒絕允入。若是已允入的站台數為 10台以上，則必須判斷 THCCA(n-1, l, 1)加上新
加入的站台所需時間 TXOP(1/3*I_DP(B&C))之時間總和，是否有超過時間門檻值 15.5ms。 
    值得一提的是，對於站台數前 10台與第 11台之後的排程策略並不相同，不管是 newly 
generated calls或是 handoff calls皆是如此。既然如此，為何 newly generated calls的部份不
需判斷已經被允入的站台數是否超過 10 台呢？這是因為一旦 newly generated calls 被允入
後，所傳送的第一張畫面必為 IDR picture，依照本計畫的排程策略，會將資料訊框平均分
配至畫面時間內的四個 SI，所以每個 SI傳送資料量的所需時間皆為 TXOP(IDR/4)，所以不
論因站台數不同而導致排程策略為何，增加的訊框類型皆相同。如此一來，在一個Window
內完整的允入控制已經完成，接下來便是結束此 Window 並開始下一個 Window 的允入控
制。 
 
 36
 
圖 4.38 加入第 12台站台後各 SI之 HCCA使用時間分布 
    本計畫採用的視訊訊務流類型可分為 Akiyo、Dancer、和 Foreman 三類，比較三者的
P_BC 資料量，其中以 Dancer 的所佔的訊框數為最多（K 值分佈為 4~10），為了平均使用
畫面時間並且考慮到 4個訊框以上才使用 Block AcK回應機制，使得 P_BC的資料量經常
需要使用兩個 SI 去傳送，因此為了避免圖 4.38 所提及的問題發生，本計畫調整了畫面時
間內的訊務流分配。已知一張畫面時間為 100ms，相當於佔了四個 SI，scheduling algorithm
將 P_A的訊框依舊在 SI 1傳送，P_BC則從原本在 SI 2、SI 3傳送改為在 SI 2、SI 4 傳送。
如此一來會使增加的 TXOP加至通道上每段 picture interval內的第二 SI，但是一旦持續允
入多台站台之後，看到每段 picture interval內的第二 SI因此而使 TXOP大於第一 SI，這將
破壞 4.7.1節提及每段 picture interval內的第一 SI均偏高的現象，也影響 4.7.2節提出的允
入控制流程，更何況若只觀察Window內每段 picture interval的第一 SI使用情形，就可判
斷 new connection 是否可以允入，以及何時被允入，這樣的立論基礎明顯薄弱。因此本計
畫認為，admission controller要觀察在(n-1)th Window內的所有 picture interval，找出平均使
用最少 THCCA的 picture interval為何，並且讓新允入站台在 nth Window在此 picture interval
才允許進入排程。 
到目前為止，本計畫尚未整理出一套完整的排程策略，只是以頭痛醫頭，腳痛醫腳的
處理方式，粗略地解決目前碰到的問題，卻也因此使本計畫對排程的核心更有概念，一來
是希望通道使用情形盡可能平均，二來則希望每個 Window 的使用情形具有週期性，如此
一來將有利於 admission controller 根據當時通道使用情形，盡可能地允入多部站台，。就
目前排程的經驗，本計畫將在下節提出三種簡易的排程策略，希望藉此找出一套理想的排
程機制。 
 
4.7.4 簡易的排程策略 
本計畫研究排程機制時，為了避免多部站台的訊務流同時傳送 I picture 而造成部份
 38
實體層速率模式 12 Mb/s 12 Mb/s 12 Mb/s 12 Mb/s 12 Mb/s 12 Mb/s 
站台編號 13 14 15 16 17 18 
影片類型 Dancer Foreman Akiyo Dancer Foreman Akiyo 
實體層速率模式 12 Mb/s 12 Mb/s 12 Mb/s 12 Mb/s 12 Mb/s 12 Mb/s 
 
 
圖 4.40 「方法三」加入第 18台站台後各 SI之 HCCA使用時間分布 
 
圖 4.41 各 picture interval內的變異數情形 
但是此種方法其實還存在缺點，在通道高度壅塞時，代表允入最後一台站台後使頻寬
 40
資料量被排程在「保留的 picture interval」，這將是無法避免的累加現象，也是在允入控制
時無法查知的。因此本計畫認為若想達到預期的保留效果，那麼應該向下修正在「保留的
picture interval」允入的門檻值，目的是為了減少站台的 I picture在「保留的 picture interval」
允入的數量，如此一來才有足夠的頻寬分配給後來各站台的 P picture資料量，並且使「保
留的 picture interval」還是控制在保留的門檻值以下。也就是說，不能將允入的門檻值與保
留的門檻值混為一談。在「保留的 picture interval」必須透過較嚴謹的允入條件限制壓低在
此允入的站台數，預留足夠的頻寬給所有站台 P picture資料量，使得「保留的 picture interval」
其 HCCA使用時間可以順利控制在保留的門檻值以下。 
 
4.8.1 對壅塞的定義 
訊務流傳送過程中，本計畫觀察前一個 Window 的傳輸情形並且計算其通道使用率，
若通道使用率達到設計者要求的上限，則 admission algorithm 將目前的通道情形視為壅塞
（Congestion），因此之後的Window不再允入新站台，直到 BSS內有站台結束傳輸使得整
體通道使用率下降至非壅塞狀態，此時 admission algorithm才能在允許新站台加入輪詢。 
 
4.8.2 通道使用率的計算方式 
由於本計畫針對 GOP設定為 5的訊務流做排程，因此本計畫令每個Window內的第五
picture interval 保留 3ms 給 handoff calls 使用。直觀上本計畫認為，刻意保留的 picture 
interval，其頻寬使用率必然會低於其他一般 picture interval，為了準確計算通道使用率，因
此本論文取每次 Window 的 1st~4th 各 picture interval 平均使用時間的總和，也就是「不保
留的 picture interval」平均使用時間的總和，佔全部 HCCA時間的比例為何，即定義為通道
使用率。其計算公式如算式(15) 
4
1
( 1, )
100%
15 4
HCCA
i
T n i
=
−
×
×
∑
                                              （15） 
註： ( 1, )HCCAT n i− 表示在(n-1)th Window中第 i個 picture interval的 HCCA平均使用時間(ms) 
 
4.8.3 三種允入及排程策略 
由 4.8節得知，目前的首要工作是提出在「保留的 picture interval」允入站台數有效降
低的方法。有鑒於此，本計畫提出了三種允入及排程策略，分別如下： 
 
4.8.4 策略一：保留的 picture interval 門檻值為 5ms 
Admission algorithm依舊以找尋Window內通道時間使用最低的 picture interval，讓新
站台在低點允入為目的，一旦遇到 newly generated calls要求加入輪詢時，這時候若是要讓
newly generated calls在「保留的 picture interval」被允入，則必須符合以下情況： 
1. 「保留的 picture interval」是當時該Window內所有 picture interval的通道使用率最低
的。 
2. 「保留的 picture interval」其通道使用率未達到允入門檻值 5ms。 
在兩條件皆成立時 newly generated calls 才會在「保留的 picture interval」被允入，否則
 42
     
圖 4.42  通道使用率分佈 
本計畫假設目前要求加入輪詢的站台皆為 newly generated calls，暫不考慮 handoff calls
的情形。被允入的所有站台訊務流類型如表 4.18。本次模擬假設通道是在完全空閒狀態下
開始服務，並且平均每 2.5sec會有一台新站台要求加入輪詢。另外，當通道使用率達到 80%
時，本論文視為壅塞。由圖 4.42三種方法模擬結果得知，從 1st Window開始有第一台站台
進行輪詢，因此通道使用率開始隨著被允入的站台數增加而增加。由於每一個 Window 長
度為 0.5sec（因為 GOP=5），因此在未達壅塞狀態前，每經過 5 個 Window（2.5sec）增加
一站台的模式，會使通道使用率的增加曲線呈現類階梯狀。從圖 4.42通道使用率分佈看到，
三種方法間的通道使用率大小分佈，與前次模擬有相同趨勢，只是各方法再每個 Window
間的通道使用率差距更小了。由模擬結果表 4.19得知，本次模擬方法「保留的 picture interval 
門檻值為 5ms」可允入 22台站台才進入壅塞狀態，而方法「保留的 picture interval不允入
站台」與方法「保留的 picture interval最多允入一台站台」，卻在允入第 21台時通道就進入
壅塞狀態，為了方便觀察，我們刻意地讓後兩種方法再允入第 22台站台，讓三種方法皆允
入相同的站台數。 
    圖 4.43 各 picture interval 與門檻值的差值分佈，不同前次模擬的地方是，方法「保留
的 picture interval不允入站台」在本次模擬出現了部份 picture interval超載的情形，不再是
全部 picture interval皆控制在門檻值以下，甚至在取樣區間所估算出的超載率與方法「保留
的 picture interval最多允入一台站台」一樣偏高的 11%，如表 4.19。在通道使用率的表現上，
由表 4.19可看出三種方法依舊能有效的保留特定 picture interval使得超載率維持在 0%，這
顯示保留效果顯著。然而其他 picture interval 的超載率表現，以方法「保留的 picture interval 
門檻值為 5ms」為最低，大不同於前次模擬結果。另外，雖然本次模擬設定通道使用率一
旦超過 80%即視為壅塞，但實際模擬結果卻讓通道使用率接近 90%，這與預期相差甚多。 
 
 44
的站台被允入，本計畫認為該 picture interval 是容易產生超載的。為了了解造成部份 picture 
interval發生超載的原因為何，因此本計畫從探討被允入的各站台其訊務流類型及被允入的
時間點著手，並且特別針對播放 Foreman影片的站台做觀察。 
表 4.20  方法「保留的 picture interval 門檻值為 5ms」各站台允入情形 
方法：保留的 picture interval 門檻值為 5ms 
站台 1 2 3 4 5 6 7 8 
Cycle 1 3 2 4 5 3 5 4 
Video Foreman Dancer Akiyo Akiyo Dancer Foreman Foreman Dancer 
PHY Rate 12 Mb/s 54 Mb/s 36 Mb/s 48 Mb/s 24 Mb/s 12 Mb/s 54 Mb/s 36 Mb/s 
站台 9 10 11 12 13 14 15 16 
Cycle 2 4 2 3 4 1 1 1 
Video Akiyo Foreman Foreman Akiyo Foreman Dancer Dancer Akiyo 
PHY Rate 48 Mb/s 24 Mb/s 12 Mb/s 54 Mb/s 36 Mb/s 48 Mb/s 24 Mb/s 24 Mb/s 
站台 17 18 19 20 21 22 
Cycle 4 2 3 3 3 1 
Video Foreman Akiyo Dancer Dancer Foreman Dancer 
PHY Rate 54 Mb/s 36 Mb/s 48 Mb/s 12 Mb/s 12 Mb/s 12 Mb/s 
 
接下來針對模擬做分析，從圖 4.43各方法的超載情形看到，三種方法均有超載的情形
發生，由表 4.20方法「保留的 picture interval 門檻值為 5ms」各站台允入情形可發現，第
三 picture interval 出現兩部以低速率 12 Mb/s 傳輸訊務量容易暴增的站台，因此在圖 4.43
看到方法「保留的 picture interval 門檻值為 5ms」在部分Window的第三 picture interval發
生超載。而每個Window的第四 picture interval即使有三部傳輸訊務量容易暴增的站台，但
是較高的實體層傳輸速率並不會造成明顯的影響。 
    表 4.21 為方法「保留的 picture interval 不允入站台」各站台允入情形，從中可看出每
個Window內的第二 picture interval有兩部以低速率 12 Mb/s傳輸訊務量容易暴增的站台，
因此在圖 4.43看到方法「保留的 picture interval不允入站台」在部分Window的第二 picture 
interval發生超載；反觀第三 picture interval，即使也有三台傳送 Foreman影片的站台皆被排
程在同一 picture interval，但是均是較高的實體層速率模式，因此不造成影響。 
 
表 4.21  方法「保留的 picture interval不允入站台」各站台允入情形 
方法：保留的 picture interval不允入站台 
站台 1 2 3 4 5 6 7 8 
Cycle 1 3 2 4 3 2 3 4 
Video Foreman Dancer Akiyo Akiyo Dancer Foreman Foreman Dancer 
PHY Rate 12 Mb/s 54 Mb/s 36 Mb/s 48 Mb/s 24 Mb/s 12 Mb/s 54 Mb/s 36 Mb/s 
站台 9 10 11 12 13 14 15 16 
Cycle 4 3 4 3 1 2 1 1 
Video Akiyo Foreman Foreman Akiyo Foreman Dancer Dancer Akiyo 
PHY Rate 48 Mb/s 24 Mb/s 12 Mb/s 54 Mb/s 36 Mb/s 48 Mb/s 24 Mb/s 24 Mb/s 
站台 17 18 19 20 21 22  
 46
表 4.23 加入 handoff call之通道使用模擬結果 
 保留的 
picture interval
通道使用率 
不保留的 picture 
interval通道使用率 
允入 
總台數 
保留的
overload rate 
不保留的
overload rate 
策略一 71.65% 92.20% 23 0% 10.3% 
策略二 63.91% 94.13% 23 0% 14% 
策略三 66.58% 93.47% 23 0% 14% 
註：策略二與策略三在允入 21台站台時已達到壅塞狀態。 
現在假設有一 handoff calls在 150th Window發生，該站台為 12 Mb/s的 Dancer影片，
在壅塞狀態下，一般來說理所當然會在保留的 picture interval將 handoff call允入。延續目
前的模擬，再加入一台 handoff call站台為第 23台，三種方法的允入模擬結果如表 4.23所
示。比較表 4.19 與表 4.23 可以發現，三種方法在「保留的 picture interval」其通道使用率
分別增加了 8.51%、8.51%、以及 8.52%；在「不保留的 picture interval」其通道使用率分別
增加了4.45%、4.44%、及4.44%。至於通道壅塞程度已接近飽和，其「不保留的picture interval」
已經偏高的超載率，也因為再加入一台 handoff call站台，使得三種方法的超載率分別增加
了 1.15%、3%、及 3%。在這次的模擬結果中，「保留的 picture interval」其超載率還是不會
因為 handoff call 的加入導致任何超載，再次可以確定三種方法皆保留了充足的頻寬給
handoff call。 
經由本章節一連串的模擬結果以及數據分析，本計畫歸納出下列幾點見解： 
1. 從模擬結果看到三種方法在「不保留的 picture interval」，其超載率表現均不算理想，
但是超載率的表現好壞，除了受設計者設定的壅塞門檻值影響之外，其主要原因是
因為訊務量發生叢集現象，而發生叢集的原因，是因為同時有兩部站台以上，同時
以低速率傳送容易發生叢集的訊務流所導致，因此本計畫認為可從錯開低速率訊務
流在同一 picture interval傳送著手。假設能夠從視訊訊務流特性得知該訊務流會有叢
集現象的資訊，設計者便可以從 admission algorithm增加判別條件，去避免讓具有叢
集特性的訊務流同時被傳送，如此一來整體排程發生超載情形便可獲得改善。 
2. 關於本計畫欲達到保留頻寬的目的，從模擬結果可明顯看出皆能成功保留足夠的頻
寬，當通道壅塞時，這時若允入一部以低速率傳輸的 handoff call站台，由模擬結果
得知能成功地藉由保留頻寬順利的被允入。 
3. 就通道使用率看來，「保留的 picture interval」其保留的程度足夠兩台 handoff calls使
用，但經由模擬證實保留的頻寬僅足夠允入一部 handoff call 站台，若允入第二部
handoff call站台將造成嚴重的超載情形發生。 
4. 本計畫用保留頻寬來解決壅塞時允入 handoff call的問題，為了解決這個問題本計畫
提出三種方法做為建議，然而三種方法均是假設自訂參數在固定值之下做模擬，因
此不強調方法之間的優劣。值得一提的是，自訂參數是取某些固定值之下做模擬，
這些參數的變動均可能影響到允入及排程策略的效能。 
5. 本計畫提出的方法，其保留頻寬僅足夠一台 handoff call在通道壅塞時被允入。很顯
然地，在通道壅塞時一旦遇上同時產生兩台以上的 handoff calls，此時保留的頻寬必
然不足，因此本計畫認為可以從視訊壓縮時的 GOP設定著手，假設 GOP=10（代表
Window size包含 10 picture intervals）並且令其中兩段 picture interval保留頻寬，則
通道壅塞時將可以允入不只一台 handoff call。此外，若是降低通道壅塞門檻值，則
 48
圖 4.44排程策略系統架構 
1. 具備五組緩衝暫存器，其中四組負責預先載入各站台四個 SI時間的訊務流，再由
一組緩衝器週期性的載入四組緩衝器的其中一組訊務流，經由實體層封裝成封包
後便進行傳送。 
 50
(7) 進入通道模擬。 
(8) 記錄發生錯誤的訊框，以及因為超載必須延遲至下一 SI再傳的訊框。 
 後續MAC algorithm運作情形皆有此週期循環，也就是說，，在 T=n*(4∆)+1時,MAC 
algorithm才做每個 picture interval內的排程，方法為 local balance。 
 
4.9.2 模擬環境及參數設定 
本計畫是利用 CommAccess Technologies公司所製作的WLAN Toolbox for MATLAB
（mWLAN）for IEEE Std. 802.11a模擬工具提供的 BRAN A channel model做為模擬環境。
本次模擬僅考慮 newly generated calls，並不考慮 handoff calls的允入情形，因此不為 handoff 
calls做頻寬保留，本次模擬相關參數設定如下。 
 影片來源：H.264/AVC extend profile。 
 影片類型：Akiyo、Dancer、Foreman。 
 畫面率：10 張/秒。 
 GOP：1I4P。 
 影片長度：180秒（1800張畫面）。 
 SI：25 ms（分配為 HCCA佔 15 ms；EDCA佔 10 ms）。 
 MSDU size：188 Bytes。 
 Delay bound：150 ms。 
 壅塞門檻值：依照 4.8.1節壅塞的定義，通道使用率達 80%便不再允入站台。 
 超載門檻值：HCCA使用時間 15.5 ms。 
 Window size：500 ms。 
 假設每 2.5秒有一 newly generated call要求加入輪詢。 
 
五. 結果與討論（含結論與建議） 
5.1 允入控制與排程的模擬分析 
表 4.24 被允入之各站台訊務流類型 
GOP=5 站台 1 站台 2 站台 3 站台 4 站台 5 站台 6 
畫面類型 Foreman Dancer Akiyo Akiyo Dancer Foreman 
實體層速率 12 Mb/s 54 Mb/s 36 Mb/s 48 Mb/s 24 Mb/s 12 Mb/s 
GOP=5 站台 7 站台 8 站台 9 站台 10 站台 11 站台 12 
畫面類型 Foreman Dancer Akiyo Foreman Foreman Akiyo 
實體層速率 54 Mb/s 36 Mb/s 48 Mb/s 24 Mb/s 12 Mb/s 54 Mb/s 
GOP=5 站台 13 站台 14 站台 15 站台 16 站台 17 站台 18 
畫面類型 Foreman Dancer Dancer Akiyo Foreman Akiyo 
PHY mode 36 Mb/s 48 Mb/s 24 Mb/s 12 Mb/s 54 Mb/s 36 Mb/s 
GOP=5 站台 19 站台 20 站台 21 站台 22 站台 23 
畫面類型 Dancer Dancer Foreman Dancer Akiyo 
實體層速率 48 Mb/s 12 Mb/s 12 Mb/s 12 Mb/s 12 Mb/s 
 
由上述的系統架構及參數設定，本計畫希望達到的服務品質保證，是將傳送 I picture 
Partition A訊框的 FER控制在 10-3以下；傳送 I picture Partition B&C訊框的 FER控制在 0.03
 52
表 4.26 各站台傳送 I picture Partition B&C訊框的 FER 
站台編
號 
傳送的訊
框數 
N不夠用造
成的錯誤
訊框數 
N不夠用造
成的 FER 
NP不夠造
成的錯誤
訊框數 
NP不夠用
造成的FER 
Total 
FER 
1 16775 121 0.00721 3 0.00018 0.00739 
2 7313 56 0.00766 0 0 0.00766 
3 8346 82 0.00983 0 0 0.00983 
4 8346 116 0.01390 0 0 0.01390 
5 7313 86 0.01176 0 0 0.01176 
6 16775 337 0.02009 0 0 0.02009 
7 16775 223 0.01329 1 6.00E-05 0.01335 
8 7313 138 0.01887 0 0 0.01887 
9 8346 118 0.01414 0 0 0.01414 
10 16775 413 0.02462 0 0 0.02462 
11 16775 331 0.01973 0 0 0.01973 
12 8346 70 0.00839 0 0 0.00839 
13 16775 394 0.02349 0 0 0.02349 
14 7313 184 0.02516 0 0 0.02516 
15 7313 148 0.02024 0 0 0.02024 
16 8346 132 0.01582 0 0 0.01582 
17 16775 304 0.01812 0 0 0.01812 
18 8346 90 0.01078 0 0 0.01078 
19 7313 190 0.02598 0 0 0.02598 
20 7313 85 0.01162 0 0 0.01162 
21 16775 333 0.01985 0 0 0.01985 
22 7313 57 0.00779 0 0 0.00779 
23 8346 234 0.02804 0 0 0.02804 
Total 0.01691 
QoS 0.03 
表 4.25為各站台 TSPEC I_A的訊框錯誤率，表 4.26為各站台 TSPEC I_BC的訊框錯
誤率，表 4.27為各站台 TSPEC P_A的訊框錯誤率，表 4.28為各站台 TSPEC I_A的訊框錯
誤率。 
 
 
 
 
 
 
 
 
 
 54
 
 
表 4.28 各站台傳送 P picture Partition B&C訊框的 FER 
站台編
號 
傳送的訊
框數 
N不夠用造
成的錯誤
訊框數 
N不夠用造
成的 FER 
NP不夠造
成的錯誤
訊框數 
NP不夠用
造成的FER 
Total 
FER 
1 6260 131 0.02093 53 0.00847 0.02939 
2 11181 318 0.02844 154 0.01377 0.04221 
3 1593 27 0.01695 2 0.00126 0.01821 
4 1593 29 0.01821 63 0.03955 0.05775 
5 11181 146 0.01306 312 0.02790 0.04096 
6 6260 55 0.00879 28 0.00447 0.01326 
7 6260 100 0.01597 91 0.01454 0.03051 
8 11181 183 0.01637 166 0.01485 0.03121 
9 1593 36 0.02260 20 0.01256 0.03515 
10 6260 79 0.01262 38 0.00607 0.01869 
11 6260 48 0.00767 120 0.01917 0.02684 
12 1593 8 0.00502 20 0.01256 0.01758 
13 6260 61 0.00974 53 0.00847 0.01821 
14 11181 194 0.01735 138 0.01234 0.02969 
15 11181 178 0.01592 121 0.01082 0.02674 
16 1593 3 0.00188 8 0.00502 0.00691 
17 6260 41 0.00655 192 0.03067 0.03722 
18 1593 16 0.01004 14 0.00879 0.01883 
19 11181 215 0.01923 242 0.02164 0.04087 
20 11181 110 0.00984 106 0.00948 0.01932 
21 6260 65 0.01038 42 0.00671 0.01709 
22 11181 95 0.00850 132 0.01181 0.02030 
23 1593 5 0.00314 15 0.00942 0.01256 
Total 0.02836 
QoS 0.03 
 
由表 4.27可明顯看到，所有站台發生訊框錯誤的主因，大部分都是因為訊框超過延遲
限制所造成，很少有錯誤訊框是因為重傳的機會 N 值不夠用所造成。這是因為 P picture 
Partition A資料的重要性較低，也就是優先權較低，所以通道壅塞的情況下，依照重要性較
高的訊框先傳送的原則，裝有 P picture Partition A資料的訊框經常需要延遲傳送。由表 4.27
可明顯看到大部分站台的 FER皆未能達到服務品質保證，只有一站台符合QoS，就整體 FER
效能表現而言，遠高於 QoS 所要求的訊框錯誤率 0.001 以下，並未達到本論文所預期。由
表 4.28可以看到，所有站台發生訊框錯誤的原因，是由於重傳的機會 N值不夠用與訊框超
過延遲限制所造成。P picture Partition B&C 資料的重要性最低，也就是優先權最低，所以
通道壅塞的情況下，依照重要性較高的訊框先傳送的原則，裝有 P picture Partition B&C資
 56
表 4.30 各站台傳送 I picture Partition B&C訊框的 FER 
站台編
號 
傳送的訊
框數 
N不夠用造
成的錯誤
訊框數 
N不夠用造
成的 FER 
NP不夠造
成的錯誤
訊框數 
NP不夠用
造成的FER 
Total 
FER 
1 16775 353 0.021043 0 0 0.02104 
2 7313 115 0.015725 0 0 0.01573 
3 8346 199 0.02384 0 0 0.02384 
4 8346 15 0.00180 0 0 0.00180 
5 7313 45 0.00615 0 0 0.00615 
6 16775 284 0.01693 0 0 0.01693 
7 16775 389 0.02319 0 0 0.02319 
8 7313 89 0.01217 1 0.00014 0.01231 
9 8346 4 0.00048 0 0 0.00048 
10 16775 108 0.00644 0 0 0.00644 
11 16775 114 0.00680 1 5.96E-05 0.00686 
12 8346 152 0.01821 0 0 0.01821 
13 16775 448 0.02671 0 0 0.02671 
14 7313 203 0.02776 0 0 0.02776 
15 7313 90 0.01231 0 0 0.01231 
16 8346 76 0.00911 0 0 0.00911 
17 16775 219 0.01306 1 5.96E-05 0.01312 
18 8346 245 0.02936 0 0 0.02936 
19 7313 95 0.01299 0 0 0.01299 
20 7313 134 0.01832 0 0 0.01832 
21 16775 372 0.02218 0 0 0.02218 
Total 0.01593 
QoS 0.03 
 
圖 4.31 各站台傳送 P picture Partition A訊框的 FER 
站台編
號 
傳送的訊
框數 
N不夠用造
成的錯誤
訊框數 
N不夠用造
成的 FER 
NP不夠造
成的錯誤
訊框數 
NP不夠用
造成的FER 
Total 
FER 
1 7167 4 0.000558 7 0.00098 0.00154 
2 7058 1 0.000142 0 0 0.00014 
3 2136 7 0.00328 3 0.00140 0.00468 
4 2136 0 0 1 0.00047 0.00047 
5 7058 3 0.00043 2 0.00028 0.00071 
6 7167 0 0 0 0 0 
7 7167 3 0.00042 4 0.00056 0.00098 
8 7058 2 0.00028 8 0.00113 0.00142 
 58
21 6260 67 0.01070 0 0 0.01070 
Total 0.015315 
QoS 0.03 
就最理想的訊務流傳輸結果而言，當然希望所有站台皆能達到服務品質保證。很顯然
的，本計畫系統尚還無法讓所有站台的四種訊務流在每次的傳輸效能上，都能達到服務品
質保證。因此本系統仍有改善的空間。 
5.2 結論 
本計畫針對 VBR H.264/AVC視訊在 IEEE 802.11e/a具品質保證無線區域網路下，提出
了一種跨層機制，對於不同重要性的視訊訊框給予不同的保護，能因應不同網路的狀況，
做適當的允入及排程演算法，希望 VBR H.264/AVC視訊訊務流在不同網路狀況下，皆能達
到本論文要求的傳輸服務品質。應用層中，當視訊資料經過壓縮編碼後，可發現 I picture
的 Partition C與 P picture的 Partition B資料量較小，本論文提出將 Partition B封包與 Partition 
C封包合併(稱 Partition B&C)為一個 RTP封包，再交由下層網路去傳輸，這樣可有效地減
少傳輸的額外負擔，來提高系統傳輸的容量。以畫面率每秒 10張來說，每張畫面佔了本計
畫所設定的四個 SI時間，為了盡可能平均使用四個 SI並且適時的採用 Block AcK回應機
制以達到降低 overhead 的目的。本計畫引用[11]做為畫面時間內的訊框分配模式，並且提
出Window與 picture interval的概念，其中Window size會根據壓縮影片的 GOP參數而定。 
在初探允入及排程演算法之際，本計畫排程策略，在 error-free環境下做模擬分析，從
該方法在每段 picture interval內四個 SI的變異數表現可以發現，本計畫提出的排程策略變
異數控制在 0.6 以內，表示畫面時間內四個 SI的使用情形平均，並且具可調性，不受站台
的實體層傳輸速率及連線站台數限制，因此該方法為本計畫排程演算法的核心。另外，允
入演算法則是由前一 Window 找出 HCCA 平均使用時間最低的 picture interval，做為當時
Window內新站台的允入時間點。本計畫認為，允入控制把關的是各段 picture interval之間
的平均；排程機制則是負責使每段 picture interval內的所有 SI之間頻寬使用的平均。 
Connection可分為 newly generated calls和 handoff calls，而傳輸中的 handoff calls其重
要理所當然比 newly generated calls來的高。為了避免通道壅塞時沒有足夠的頻寬供 handoff 
calls 使用，必須藉由頻寬保留才能保證。本計畫提出三種頻寬保留的方法，每個方法的在
通道使用率上有不同程度的取捨，皆是使不保留的 picture interval通道使用率升高，降低保
留的 picture interval通道使用率。既然能夠成功的保留頻寬，本計畫也嘗試模擬在通道壅塞
狀態下允入一台 handoff call，模擬結果證實本計畫提出的三種保留頻寬方法，均能保留足
夠的頻寬。 
最後本計畫將排程演算法，加入重傳機制及訊框的四種 TSPEC依重要性做優先權排序
的概念，並且以 BRAN A channel model做模擬。在重傳次數受延遲限制和 SBA值限制的情
況下，統計各站台四種 TSPEC類型的訊框發生錯誤的情形，模擬結果顯示，當壅塞門檻值
設為通道使用率達 80%即不再允入站台時，裝有 I picture Partition A資料的訊框，能達到整
體 FER在 10-3以下的服務品質保證；裝有 I picture Partition B&C資料的訊框，能達到整體
FER在 0.03以下的服務品質保證。這是因為兩者的優先權較高，大部份時間均優先傳送，
因此訊框錯誤的情形大部分僅由重傳次數不足時造成。 
反觀裝有 P picture Partition A資料的訊框，未能達到整體 FER在 10-3以下的服務品質
保證，以本計畫提供的數據為例，僅能達到整體 FER為 0.00374；裝有 P picture Partition B&C
 60
Communications (WOC), May 30 – June 1, Montreal, Canada. 
5. 碩士論文二篇。 
 
已投稿論文： 
1. Chie Dou and Li-Shin Wang, 2009, Fading Effects on the Lower Shifting of Mode 
Switching Thresholds in the Rate Adaptive IEEE 802.11a/g WLANs, submitted to 
IEEE Trans. on Mobile Computing. 
2. 竇奇、鐘晏銘、林定佑, 2009, H.264視訊訊務流在具重傳機制下之 802.11e/a的
允入及排程策略做研究, submitted to NST 2009.  
3. Chie Dou and Li-Shin Wang, 2009, Performance Analysis of Fading Effects in 
OFDM Systems – From Per Target Eb/N0 Perspective, submitted to WCNC 2010. 
 
 
 
 
參考文獻 
 
[1] Y. Wang, G. Wen, S. Wender, and A. K. Katsaggelos, “Review of error resilient techniques 
for video communications,” IEEE Signal Processing Mag., vol. 17, pp. 61-82 July 2000. 
[2] T. Stockhammer, M. Hannuksela, and T. Wiegand, “H.264/AVC in wireless environments,” 
IEEE Trans. Circuits Syst. Video Technol., vol. 13, pp 657-673, July 2003. 
[3] M. Schwartz, “Telecommunication Networks: Protocols, Modelingand Analysis,” 
Addision-Wesley, pp. 119-135, Mar. 1987. 
[4] S. Lin, D. Costello, and M. Miller, “Automatic-repeat-requesterror-control schemes,” IEEE 
Communications Magazine, Dec.1984. 
[5] IEEE Standard 802.11e/D4.0 November 2002, Draft Supplement to IEEE Standard for 
Telecommunications and Information exchange between systems – LANMAN specific 
requirements. Part 11: Wireless LAN Medium Access Control (MAC) and Physical Layer 
(PHY). 
[6] IEEE Standard 802.11e/D5.0 July 2003, Draft Supplement to IEEE standard for 
Telecommunications and Information exchange between systems – LANMAN specific 
requirements. Part 11: Wireless LAN Medium Access Control (MAC) and Physical Layer 
(PHY). 
[7] IEEE Standard 802.11e/D13.0 January 2005, Draft Supplement to IEEE standard for 
Telecommunications and Information exchange between systems – LANMAN specific 
行政院國家科學委員會補助國內專家學者出席國際學術會議報告 
                                                       98 年  8  月  28  日 
報告人姓名  
竇 奇 
 
服務機構 
及職稱 
 
國立雲林科技大學電機工程系 職稱 
副教授 
 
時間會議 
 
地點 
97 年 10 月 12 日 至 97 年 12 
月 14 日 
中國大陸  大連市 
本會核定 
補助文號 
NSC 96-2221-E-224-002-MY2 
會議 
名稱 
 (中文) 2008 IEEE 第四屆國際無線通訊網路及行動計算研討會 
 ( 英 文 ) The 4th IEEE International Conference on Wireless 
Communications, Networking and Mobile Computing 
發表 
論文 
題目 
 (中文) 在頻率選擇衰減通道下 802.11a 實體層速率模式選擇門檻值下移研究 
(英文) The Lower Shifting of the Thresholds between 802.11a PHY Rate Modes 
Selection over Frequency Selective Fading Channels 
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
附
件
三
 
星期天下午，大會開始的前一天，帶著太太從住宿旅館，搭計程車到大會旅館辦理註冊手
續。當我報了自己 Paper number 後，過了不到半分鐘，承辦小姐（應是武漢大學的研究生）對
我說，竇老師你的文章經大會選為 Best paper，大會在晚宴上將頒發 Best Paper Award。因為
參加過不知多少次的國內外研討會，從來沒想到會得到最佳論文獎，況且此次是 IEEE 的國際研
討會，當下總覺得這是真的嗎？我請承辦小姐再次幫忙確定一下，我的得獎是否有搞錯，結果承
辦小姐很肯定的回答，沒有錯，而且你一定要參加晚宴領獎。我望著旁邊看著一愣一愣的太太，
我說我也不知此次怎麼會得到最佳論文獎，而且若我一定要參加晚宴，那我太座怎麼辦，結果只
好花錢再買一張 Banquet Ticket，夫婦二人一起參加晚宴，太太還可以為我的領獎照相，留下
我的歷史記錄，最重要的是在旁為我打氣。到了晚宴當天，我和太太並一些參與大會的學者們共
坐一桌，尚未上菜之際，突然大會辦事小姐又找到我，對我說今晚得獎者只有三人，大會委員會
決定，只有竇老師你要發表得獎感言，霎時間我又愣住了，這是國際研討會，下面坐了近千人，
還要我用英文發表得獎感言，我拜託大會辦事小姐回覆大會委員會，就說我英文不太好，換其他
二位外國籍的得獎人發表得獎感言，是否更好？小姐去了又回，告訴我說大會委員會已作的決
定，不會更改，竇老師你還是預備著吧。此時我只好接受事實，腦袋空空不知從何預備起，心裡
開始向主耶穌我的救主禱告，求祂賜我當說的話，賜我心中平安，除去緊張壓力。到了大會介紹
貴賓，及來自 IEEE 協會的重量級人物，等他們都致詞完畢，開始頒發 Best Paper Award，得獎
的只有三人，我是唯一的中國人。果真大會邀請來頒獎的 IEEE 協會的重量級人物，在頒給我獎
狀後，就把麥克風遞給我，對我說下面幾分鐘是我發表感言，我靠著主耶穌給我的力量，也不知
說了些什麼，下面坐著的近千人，倒是踴躍鼓掌了好多回，到今天回想起來，也記不得我當時到
底說了些什麼，那真像作了一場夢。 
此次 WiCOM2008 共接受Oral paper 181篇，Poster paper 691篇。大會共安排了七場
Keynote Speeches，16場 oral Sessions，及五場 Poster Sessions。大致在以下逐一介紹： 
able to create adaptable, on-the-fly wireless networks, based on the needs of the user without a 
centralized infrastructure support.  
Keynote Address V– “Design of High Efficiency Planar Antennas for Micro and Millimeter Waves 
and Their Application to Communication Systems ” 
Speaker: Prof. Makoto Ando (Japan), Tokyo Institute of Technology 
Keynote Address VI– “Making Wireless Communications Sustainable” 
Speaker: Prof. Laurie Cuthbert (UK), Queen Mary, University of London 
According to the ITU, wireless communications account for arround 10% of the emission making up 
global greenhouse gases so as the world moves to ener-increasing use of wireless this issue is becoming 
more critical. This talk considers the problem and potential directions for solutions to make 
communications technology sustainable in the long term. 
Keynote Address VII– “4G Activities in China” 
Speaker: Prof. Ping Zhang (CHINA), Beijing University of Posts and Telecommunications 
   
大會除了提供以上精彩的演講之外，Technical Sessions 的內容亦相當豐富，以下作一概略介紹： 
Volume 1: Wireless Communications (1) 
❑B3G and 4G Technologies  
❑MIMO and OFDM  
❑UWB 
Volume 2: Wireless Communications (2) 
❑Cognitive Radio  
❑Coding, Detection and Modulation  
❑Signal Processing and Channel Model  
❑Antenna and Circuit 
❑National Infrastructure Management  
❑E-Commerce and E-Government 
Volume 9: WiCOM Management Track: Financial Management 
❑Financial Innovation  
❑Financial Engineering  
❑Investment and Financing  
❑Risk Management 
Volume 10: WiCOM Management Track: 
Knowledge Management 
❑Knowledge Management, Semantic Web and Data Mining  
❑Decision Support System 
Volume 11: WiCOM Management Track: 
Information System and Management 
❑Management of Information System (MIS) 
❑Information System Development and Application  
❑Information and System Security  
❑Software Engineering Management  
❑Spatial Information and Digital City  
❑Application of Grid Technology  
❑Technological Innovation 
 
 
 
三、考察參觀活動(無是項活動者省略) 
 無 
四、建議 
    此次大會邀集了許多相關領域的 Keynote Speeches，倒為大會增色不少，以後國內舉辦大型
國際研討會亦可仿傚，以增加大會的吸引力，只是我想這可能要花費不少財力和人力，才能達
到。 
五、攜回資料名稱及內容 
1. WiCOM 2008 大會論文集（CD-ROM） 
 
六、其他 
    由衷的感謝國科會核定專題計畫時，給予此次出國的補助，希望爾後能再有機會獲得這樣的
補助。 
 
以上就是本人此次出國參加會議的心得報告。再次說聲謝謝。 
 
Peace be with you all.                    
 
報告人：竇 奇 
                                                         于雲科電機系 
 
 
發表文章之全文如下 
（Paper - 全選 – 複製 – Control V 貼上 – 本文改雙欄 – 微調）
the subcarriers, given that the target SNR is fixed. In 
subsection II.A, this paper analyzes the PER performance for 
OFDM-based systems that combine with FEC and Viterbi 
decoder over frequency-selective fading channels. This 
analysis is per packet based; that is, the fading realization 
(channel transfer function) that is experienced by an 
individual packet is used to calculate an upper bound of the 
PER of that packet. Furthermore, in subsection II.B this paper 
develops a semi-analytical method that derives an upper 
bound of the average PER of individual received SNR, given 
that the target SNR is fixed. In this method, a sufficiently 
large number of simulating packets and the fading realization 
experienced by individual simulating packets are generated 
via simulation, and an upper bound of the PER of each 
individual receiving packet is calculated using the analytical 
result obtained in subsection II.A. Thus, the method is semi-
analytical. In section 3, both of the results obtained by the 
semi-analytical method and the full simulation display 
remarkably that lower target SNRs give better PER 
performance under the same received SNR. This observation 
has a very important impact on the determination of optimal 
SNR thresholds for the 802.11a link adaptation. In our study, 
throughput-based link adaptation is adopted [1], [5]. PHY link 
is adapted to the rate mode that gives higher throughput. 
Numerical results have shown that the link adaptation 
threshold between two comparative rate modes should 
decrease when the target SNR is lower. Finally, the lower 
shifting of the thresholds between PHY rate modes selection 
of 802.11a link adaptation for different target SNR values 
over ETSI/BRAN channel–A model is presented.  
II.  Fading Effects in OFDM-based Systems 
At the receiver after taking an N point DFT on the nth 
OFDM symbol, we have the received signal for subcarrier i 
over a slowly time-varying time-dispersive channel given by 
              
niinini ZHdY ,,, += ,                   (1) 
where 
nid ,  is the modulation symbol of the ith subcarrier for 
the nth OFDM symbol, 
iH  is the channel transfer function of 
subcarrier i, and 
niZ ,  is the noise term of the ith subcarrier due 
to the Additive White Gaussian Noise (AWGN) with the two-
side power spectral density 2/0N . In IEEE 802.11a, there are 
two long training symbols for each packet that can be used for 
coherent detection. In this study, we assume perfect 
synchronization with no timing and frequency offsets. For the 
two long training symbols, they have the same form 
               
niiini ZLHY ,, += , n=0, 1.            (2) 
Here { iL } is a training sequence defined in 802.11a standard 
and is both known by the transmitter and the receiver. In [5], 
the likelihood function of 
iH  was derived for the channel 
estimation, and it has been shown that the optimal estimator 
of 
iH  is expressed as 
           
iiii LYYH 2/)(
ˆ
1,0, += ,              (3) 
where 
0,iY  and 1,iY  are both complex Gaussian random 
variables with the same mean 
iiLH . The estimation of the 
received SNR of the ith subcarrier can be expressed as    
)/(ˆ 0
2
NEH bii =γ ,                  (4) 
where 
bE  is the transmitted signal energy per bit. In 802.11a, 
a long OFDM training symbol consists of 53 subcarriers 
including a zero value at dc. By using channel gains of all 52 
subcarriers (excluding the dc component), we can calculate 
the estimated SNR of the receiving packet. Let {}LTSi  be the set 
of indices correspond to these 52 subcarriers in a long training 
symbol of 802.11a. The estimated received SNR of the packet 
is given by 
{ }
TH
N
E
H
R b
ii
i
LTS ⋅=⋅=
∑
2
0
in  all
2
52
ˆ
,             (5) 
where )/( 0NET b≡ , is defined as the target SNR (or initial 
SNR) of the packet, and 2H  is the mean square value of all 
52 estimated channel gains obtained from two long training 
symbols. From (5), it has been shown that the relationship 
between the target SNR and the received SNR is determined 
solely by the fading effects which are represented by the 2H  
that is experienced by the packet. For example, if 2H =0.5 
and T=22 dB, then it gives R=19 dB. Note that different 
fading realizations with the same 2H  will result in the same 
received SNR given that the target SNR is fixed; however, 
they may cause different packet error probabilities. 
2.1 PER Calculation for a receiving Packet  
   For a particular fading realization, an upper bound of the 
PER of the receiving packet can be derived analytically by 
first calculating the probability of symbol error over all data 
subcarriers individually. The symbol error probability for M-
ary QAM is given by [6]: 
     
2
0
av
,
)12(
3
erfc 
1
111
















−






−−−≅−
NM
E
M
p QAMMe
,   (6) 
where 
0av / NE  is the average signal to noise ratio per symbol. 
Let MK 2log= , then we have bKEE =av . In this paper, we 
introduce a new notation, iSC
QAMMep
−
−,
, to denote the estimated 
estimation of every received PPDU (PHY protocol data unit). 
As a result the probability distribution of the received SNR 
shown in Fig. 1 is statistically the same for all data rates. Here 
we assume the slight differences between the AWGN noise 
terms, i.e., 
niZ , ’s in (2), of different data rates under the same 
target SNR have negligible effect to the estimation of 
iHˆ . 
Here we assume that the size of the PHY service data unit 
(PSDU) is 196 bytes. During transmission, the PSDU is 
provided with a PLCP preamble and header to create the 
PPDU. The fading realizations experienced by different 
transmitted PPDUs are generated independently by the 
mWLAN simulation toolbox. Note that the probability 
distribution shown in Fig. 1 is represented in discrete form, so 
the estimated received SNR is rounded off to its nearest 
integer. Furthermore, from (5), we can see that the probability 
distribution of the received SNR can also be viewed as the 
probability distribution of the fading realization, represented 
by 2H . Hence, the horizontal axis in Fig. 1 has two rows. The 
first row is used to represent the received SNR, R [dB], and 
the second row is used to represent the corresponding 2H . 
Since T=16 dB in Fig. 1, if 2H =1 then R =16 dB and 
2
H =1/2 then R=13 dB, etc. In general, larger 
2
H  implies 
better fading realization and will result in a higher received 
SNR. 
2H
  
Figure 1.    The probability distribution of the received 
SNR given that the target SNR is 16 dB. 
Fig. 2 shows the average PER versus received SNR, for 
three-fixed target SNR values: 16, 19, and 22 dB. The PHY 
mode adopted is 48 Mb/s. Both results obtained by the semi-
analytical method and the full simulations were presented in 
the figure. In the semi-analytical method, we assume ε =0.25 
in the calculation of (11). Hence, the upper bound of the 
average PER of individual received SNR values, 
dB 
dB |) Mb/s48 ,196(
rR
tTPER
=
=
, is calculated for every 0.5 dB 
interval. The simulation result for each 
dB 
dB |) Mb/s48 ,196(
rR
tTPER
=
=
 was obtained by first counting the 
number of packets whose received SNRs fell within the range 
] ,( εε +− rr  but that could not be decoded correctly, and then 
dividing that value by the number ] ,( Mb/s48
196 , |
εε +− rr
tpktN . Clearly 
the average PER calculated by the semi-analytical method 
provides an upper bound of its corresponding simulation 
result. Both results remarkably display that lower target SNR 
values give better PER performance under the same received 
SNR. For example, both results show that 
dB 19
dB 19|
=
=
R
TPER <
dB 19
dB 22|
=
=
R
TPER . 
 
Figure 2.  Average PER versus received SNR by semi-analytical method and 
full simulation for three different target SNRs under 48 Mb/s PHY mode. 
3.1 Link Adaptation between 54 Mb/s and 48 Mb/s Rate 
Modes 
We see that lower target SNRs give better PER 
performance under the same received SNR in Fig. 2. This 
observation has a significant impact on the determination of 
optimal SNR thresholds for the 802.11a link adaptation. In 
our study, we adopted a throughput-based link adaptation. 
This throughput is calculated by the average PER obtained by 
the full simulation for accuracy. Fig. 3 presents the simulation 
results of average PERs of different received SNR values for 
three different target SNRs: 16, 19, and 22 dB, respectively, 
by considering two adjacent rate modes: 54 Mb/s and 48 Mb/s. 
In 802.11a, the relationship between the achievable 
throughput and the associated average PER of different rate 
modes can be obtained as follows. The transmission time of a 
PPDU frame (in us) can be calculated as 
SYMDATA_SYMSIGNALPREAMBLEPPDU TNus) (4 Tus) (16 TT ×++= , (12) 
where 
SYMT  is the OFDM symbol interval (=4 us), and 
DATA_SYMN  is the number of OFDM symbols in the DATA 
