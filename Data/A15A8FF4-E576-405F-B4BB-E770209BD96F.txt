 II
中、英文摘要 
中文摘要 
關鍵詞：展跳頻封包同步、干擾偵測、抗干擾迴避、正交分頻多工、
分碼多工。 
本研究計畫之目的為設計一具跳展頻抗干擾之隨意通之協力通信系統之實體
層收發機演算法。此收發機法則可使用於軍用之前瞻無線通訊系統。本計畫研究
內容包含有下列功能，首先，制定用戶台實體層規格，此規格具有快速跳頻(FH)、
分碼多工(CDMA)與正交分頻多工(OFDM)等重要技術。其次，已建立不同之干
擾模型驗證收發機性能。接續，已開發用戶台接收機技術，含有展跳頻封包同步
法則、干擾偵測、抗干擾迴避法則等演算法設計。該法則可結合本計畫所提出之
跳展頻系統適用於不同干擾環境。最後，經由電腦模擬分析已証實本論文所提出
之收發機法則可具有優異之性能。 
 IV
目錄 
目錄 ……………………………………………………………………………..IV 
圖目錄 ……………………………………………………………………………..V 
表目錄 ……………………………………………………………………………..I 
第一章 前言………………………………………………………………………..1 
1.1 研究動機  
1.2 研究報告的組織  
第二章 跳展頻系統架構與載波頻率偏移及通道估計…………………………..3 
2.1 跳展頻收發機系統架構  
2.2 載波頻率補償(CFO)與通道估計法則  
2.3 跳頻系統架構  
第三章 干擾信號偵測與參數估計方法…………………………………………..16 
3.1 固定頻帶的干擾  
3.1.1 干擾信號偵測演算法  
3.1.2 消除干擾與參數估計方法  
3.2 隨機跳頻的干擾  
3.2.1 干擾信號偵測演算法  
3.2.2 消除干擾與參數估計方法  
第四章 封包同步與時間同步技術………………………………………………..34 
4.1 封包同步粗估  
4.1.1 封包粗估演算法  
4.1.2 粗估模擬結果  
4.1.3 改進粗估法則  
4.2 封包同步細估 ……………………………………………………………46 
4.2.1 封包細估演算法  
4.2.2 細估模擬結果  
4.3 符元的時序同步  
4.3.1 符元時序演算法  
4.3.2 符元時序模擬結果  
第五章 結論…………………………………………………………………………56 
參考文獻……………………………………………………………………………..1 
 VI
圖 3.9  信號跳頻位置................................................................................................ 26 
圖 3.10 信號與干擾示意圖........................................................................................ 26 
圖 3.11 干擾消除步驟 ................................................................................................ 27 
圖 3.12 功率門檻值界定............................................................................................ 28 
圖 3.13 主動式門檻值追蹤示意圖............................................................................ 29 
圖 3.14  CFO 估計、通道估計與干擾偵測錯誤率 ................................................. 32 
圖 3.15 位元錯誤率模擬............................................................................................ 33 
圖 4.1  PN 碼示意圖-時域 ........................................................................................ 34 
圖 4.2  封包同步粗估方塊圖.................................................................................... 35 
圖 4.3  粗估成功機率模擬圖 CFO=100ppm，ISR=-10dB ..................................... 39 
圖 4.4  粗估 RMSE 模擬圖 CFO=100ppm，ISR=-10dB ........................................ 39 
圖 4.5  粗估成功機率模擬圖 CFO=10ppm，ISR=-10dB ....................................... 40 
圖 4.6  粗估 RMSE 模擬圖 CFO=10ppm，ISR=-10dB .......................................... 41 
圖 4.7  粗估成功機率模擬圖 CFO=0.1ppm，ISR=-10dB ...................................... 41 
圖 4.8  粗估 RMSE 模擬圖 CFO=0.1ppm，ISR=-10dB ......................................... 42 
圖 4.9  粗估成功機率模擬圖 CFO=10ppm ............................................................. 43 
圖 4.10 粗估 RMSE 模擬圖 CFO=10ppm ................................................................ 43 
圖 4.11 改進粗估法則方塊圖 .................................................................................... 44 
圖 4.12 去除干擾之粗估成功機率模擬圖 CFO=10ppm ......................................... 45 
圖 4.13 去除干擾之粗估 RMSE 模擬圖 CFO=10ppm ............................................ 45 
圖 4.14 封包同步細估方塊圖.................................................................................... 46 
圖 4.15 細估成功機率模擬圖 CFO=100ppm ........................................................... 48 
圖 4.16 細估 RMSE 模擬圖 CFO=100ppm .............................................................. 49 
圖 4.17 時序同步方塊圖............................................................................................ 50 
圖 4.18 時序成功機率模擬圖 CFO=100ppm ........................................................... 52 
圖 4.19 時序 RMSE 模擬圖 CFO=100ppm .............................................................. 53 
 I
表目錄 
 
表 2.1  系統參數設定 ................................................................................................. 5 
表 2.2  ITU 通道模型 Vehicular-A ............................................................................ 5 
表 2.3  模擬場景參數 ............................................................................................... 12 
表 3.1  模擬場景參數-固定干擾 .............................................................................. 22 
表 3.2  模擬場景參數-跳頻干擾 .............................................................................. 31 
表 4.1  同步模擬參數 ............................................................................................... 38 
 
 2
WiMAX 模型架構，多路徑通道對信號模型的影響、ITU 通道模型下 CFO 的同
步問題以及跳展頻系統(Frequency hopping spread spectrum，FHSS)[12]-[15]架構
建立。在第三章，敵方干擾對傳送信號之影響，使用跳頻系統避開干擾威脅，
CDMA 展頻避免信號完全遭受干擾，以及建立干擾偵測機制，並以此機制去除
干擾得到正確信號。在估測 CFO 與通道估計時，皆會受干擾環境影響，且探討
固定頻帶式干擾與跳頻式干擾對系統之影響與性能。在第四章，許多同步[16]-[21]
議題探討，包括封包(Packet)同步與符元的時序(Timming)同步，在有敵方干擾的
影響下，如何正確抓取同步位置是很重要的議題，所有的方案都是建立在有敵方
干擾的環境下，如何使用 PN 碼尋找同步位置；時序同步部分，在找到封包起始
頭後，PN 信號接續就是信號，如何辨識信號何時進入，是很重要的，辨識錯誤，
則在估計與解調就會錯誤，所以必須準確辨識，找到信號起始頭，完成時序同步。
最後，結合以上成果，展現跳展頻系統使用干擾偵測機制結合同步技術之性能曲
線。
 4
首先要先做封包同步點位置檢測，檢測出同步點之後再做時間封包尾端位置的辨
識，找到真正的信號起始位置。做完同步部分並確認信號起始位置後，須先解決
載波頻率偏移(CFO，Carrier Frequency Offset)的問題，然後再做通道估計，其中
因為信號有受到敵方干擾，所以必須先偵測干擾信號，並去除干擾信號後，才能
使補償與估計值正確，之後再解調與解碼，解出接收到的信號。 
本系統詳細傳輸方式如下所述，首先，對時域上發射信號做取樣，公式如下： 
 
2 1
2
2
1 , , , 1
N
j nk N
n k g
k N
X e n N N
N



   x  (2.1) 
其中 kX 是頻域上的信號表示式，並且該信號可利用 FFT 完成。 
 ng 為一多路徑通道模型，其脈衝響應表示式為： 
      n g n n

  g  (2.2) 
發射信號傳送出去，在傳送過程中，經過一通道衰減與載波頻率偏移，以及在接
收時產生之熱雜訊，其接收信號表示式為 
 
       
     
2
2
j fn
j fn
n n e n
n n e n



  

      
  
z g x v
= g x v
 (2.3) 
其中  nx 為信號。  ng 為通道衰減值， 2j fne  為載波頻率偏移，以及  nv 為高
斯熱雜訊。 
表 2.1 為本系統參數之設定。其中每個載波為 20Mcps，每 CDMA symbols 為 2 
chips，CDMA 相對於 OFDM 為 96 個 CDMA symbols 為 1 個 OFDM symbols，每
一個 OFDM symbol 子載波長度為 256 子載波，預計使用的調變系統為 QPSK、
16QAM 與 64QAM，其相對應之保護區間(CP)時間長度為 64 cT 與 32 cT 與 16 cT 。
Code rate 為 0.5，總頻寬為 60MHz，分成三段頻寬，單一頻寬為 20MHz，即信
號所佔頻寬大小為 20MHz，跳頻的頻帶同樣也為 3 個。 
 6
P/2 個，後半安插後 P/2 個，如：pilot 數 p=16，分別安插 8 個在前頭，8 個在後
頭；信號總數為 X 個，同樣前 X/2 個安插在前頭，後 X/2 個安插在後頭，總段長
度為 N，高頻補零為 N-P-X 個。 
 
圖 2.3 信號位置與 pilot 位置 
 
傳送的信號設計如圖 2.4。為了對抗敵方干擾，使用一 CDMA 展頻碼方式，使用
兩段重複信號，配成 X 點，再將信號與 pilot 安插在 N 點裡面，此為使用 code=2
的展頻碼。 
 
圖 2.4 信號結構 
 
 
 
 8
RMSE)方法比較，可得到圖 2.6 的一個準確的結果，公式如下： 
  2
1
1 ˆ
N
RMSE
n
CFO f f
N 
     (2.5) 
5 10 15 20 25
10
-4
10
-3
10
-2
Eb/N0 (dB)
R
M
S
E
RMSE performance of frequency offset estimation
 
 
1ppm CFO
 
圖 2.6 1ppm CFO 之 RMSE 結果圖 
取得之 fˆ 與信號做補償 
     ˆ2j fnn n e   z z  (2.6) 
去除載波頻率偏移的信號，因為補償完畢後不再帶有一弦波，開始做通道估計，
首先將接收補償後信號的 cyclic prefix (CP)移除，移除如下式： 
  1 2
0
, 0,1, , 1
N
j nk N
k
n
n e k N
 

  Z  z  (2.7) 
通道估計是使用時域下最小平方法則(Time-domain least-square，TD-LS)，使用已
知 pilot 做估計，已知 pilot 是安插在信號之間的 P 點，如圖 2.7 所示。 
 
圖 2.7 Pilot 位置 
用已知 pilot 與接收信號的 pilot 比對，求出通道衰減值。 
 
 10
LPF 為對應 pilot 的傅立葉轉換矩陣，式子為 
 
0 0 0 1 0 1
1 0 1 1 1 1
1 0 1 1 1 1
2 2 2
2 2 2
2 2 2
L
L
p p P L
t t tj j j
N N N
t t tj j j
N N N
LP
t t tj j j
N N N
e e e
e e e
e e e
    
    
    


   
    
    
    
          
F


   

 (2.12) 
使用 TD-LS 對於無線通道響應的估測方法即為找出    HZ - XF Z - XF g g 的最小
值，即是找尋 ˆLSg ，如下式 
     1ˆ H H H HLS p LP p LP p p LP LP p p  X F Z F X X F F X Z g  (2.13) 
得到 ˆLSg 且知 ˆ ˆLS LSH Fg ，可得 ˆ LSH 為 
   1ˆ H H H HLS LP LP p p LP LP p p H F F X X F F X Z  (2.14) 
將得到的通道衰減值轉換到時域，得到  ˆ ˆ= IFFTLS LSHh ，做強制歸零法則
(Zero-forcing)通道等化 
         2ˆ ˆZF LS LSn n n n  z h z h  (2.15) 
將(2.15)式加入一 SNR 檢測方式為最小均方誤差法則(Minimum mean square 
error，MMSE) 
           2 22ˆ ˆMMSE MMSE MMSE nn n n n E n      Xz h z h  (2.16) 
 
圖 2.8 為 TD-LS 取得之  ˆLSh n 與實際通道值比較之結果，可以看到有良好的估測
到 正 確 通 道 值 ， Eb/N0 越 高 效 果 越 準 確 。  ˆLSh n 之 均 方 根 誤 差
(root-mean-square-error，RMSE)表示為 
  2
1
1 ˆ
N
RMSE LS ideal
nN 
 h h h  (2.17) 
 12
表 2.3 為模擬場景參數，模擬總次數為 1000，為一跳展頻 OFDM 且調變為 QPSK
之系統架構，信號點數為 N=256 點，FFT 點數為 3N=768 點，展頻碼為 2，通道
模型為 ITU 標準之 6path 通道模型。 
 
表 2.3 模擬場景參數 
圖 2.10 為位元錯誤率模擬圖，綠色線為使用強制歸零法則(Zero Forcing)通道等
化後之 BER，黑色線為最小均方誤差法則(Minimun mean square error，MMSE)
通道等化後之 BER，藍色線為理論之 BER，紅色線為使用頻域下最小平方法則
(Frequency-domain least-square，FD-LS)通道估計之結果，可以發現使用穿插在信
號間已知 pilots 並使用 TD-LS 估測值較精準。 
 
5 10 15 20 25
10
-4
10
-3
10
-2
10
-1
10
0
Eb/N0 (dB)
B
E
R
BER Performance of QPSK under Rayleigh fading channel or SISO OFDM-CDMA system
 
 
QPSK 6 Path Rayleigh (Frequency-Domian LS)
QPSK 6 Path Rayleigh (Simulation)
QPSK 1 Path Rayleigh (Theory)
QPSK 6 Path Rayleigh (Simulation MMSE)
 
圖 2.10 位元錯誤率 
 14
如此可在數位上確定三個頻帶，以 0je  、
2
3
nj
e

與
4
3
nj
e

區隔，但僅有三個頻帶較易
被敵方偵測鎖定，無法有效避開干擾，依此結構設計一隨機跳頻方式，讓信號以
完整一頻帶 N 在整個頻帶 3N 間做隨機跳頻，如圖 2.12。 
 
圖 2.12 頻域-新的跳頻結構 
 
圖 2.12 為新跳頻結構，採用隨機跳頻方式，讓敵方無法準確抓到信號跳頻模式，
藉以避免直接的干擾，如下式： 
   2 21 3 3kn nh N j jN Nhop k
k h
n X e e
  

 X  (2.21) 
其中 kX 為信號，h 為跳頻位置， 0,1, 1, , 1, , 2 1,2h N N N N N     ，信號長度
仍為 N 點，跳頻在 3N 頻帶上。 
圖 2.13 所示，為擷取信號六個符元的頻域信號顯示，Eb/N0 為 25dB，可以清楚
看到信號位置，且為隨機跳頻的形式，以此跳頻方式避免干擾命中，且隨機跳頻
可避免敵方找到我方跳頻模式，藉以避免干擾，詳細對抗干擾方式在第三章作介
紹。 
 
 16
三、干擾信號偵測與參數估計方法 
3.1 固定頻帶的干擾 
3.1.1 干擾信號偵測演算法 
  從第二章的介紹，在傳送信號時，每一符元內是以跳頻的方式在傳送，以保
護干擾進來時，可以躲過干擾的影響，保護信號不被破壞。在本小節我們假設干
擾是固定干擾每一符元固定頻帶，破壞有干擾頻帶的信號，本研究報告將對此提
出偵測干擾信號的方法。 
  首先，接收端方面，開始接收信號時，只有雜訊段之信號，隨後因為是 fixed
型態的固定點干擾，所以每一次 frame 干擾頻帶皆相同。本節以前面信號尚未到
達之區段，做干擾信號估測，以便作干擾消除，頻域表示如圖 3.1。 
 
圖 3.1 雜訊與干擾示意圖 
假設雜訊長度為 3N，干擾長度 J，如：N=256、J=8，如圖 3.1 所示，symbol1~symbol3
為純雜訊，symbol4~symbol6 為干擾加雜訊。圖中為轉換到頻域的雜訊段及干擾
段 3D 頻譜，符元長度為 3N，前三段單純含有雜訊，後三段為干擾與雜訊混合，
 18
其中  j n 是干擾通道，  nI 是干擾，  nv 是雜訊。且  nI 為 J 點干擾公式 
     21 3 , 0,1, ,3 1mni J j N
m i
n I m e n N
 

  I   (3.3) 
其中 i為跳頻點，本節為固定干擾，故跳頻 i位置皆相同。 
 awgn nz 為雜訊段，為接收機開始接收僅有雜訊，如下式： 
     1 2 3[ , , , ]Tawgn Nn n v v v  z v  (3.4) 
轉換到頻域 
         FFT [  ]jam awgnn n n n Z Z Zz  (3.5) 
之後取干擾各點功率 
     2J n nZ Z  (3.6) 
得到的  J nZ ，在圖 3.3-b 頻譜上可清楚看到干擾位置。圖 3.3-a 為雜訊功率頻譜，
圖 3.3-b 為含雜訊與干擾之功率頻譜，各取前端 K 點部分區塊表示(例：K=50)，
其中干擾設置在前面 J 點之連續頻帶干擾。如圖 3.3-b，其干擾點數 J=8。 
 
 
(a) 
圖 3.3 雜訊與干擾功率頻譜 
0 10 20 30 40 50
0
1
2
3
4
FFT length/symbol
po
w
er
Frequency spectrum of noise(Eb/N0=10dB)
 20
如圖 3.4 所示，得到的 iˆ ，即為固定點干擾所在位置，將干擾消除後，將可使信
號正確解調估測。 
Jamming
average
Comparator2   nz
Noise
average
 nZ
 awgn nZ
Threshold 1
MAX
 nZFFT Jamming points
iˆ
,v nT
,J nT
nT
W
W
 J nZ
 
圖 3.4 功率門檻值界定 
圖 3.5 為一在固定干擾下，擷取一含有干擾之區段之功率門檻值示意圖。紅色線
是  JZ n ，藍色線是 ,J nT ，綠色線是 , 1v nT  。干擾門檻值 ,J nT 有效估測出干擾位置，
雜訊門檻值 , 1v nT  將純雜訊過濾掉，則取 ,J nT 與 , 1v nT  兩者之最大，可估測出實
際干擾位置。 
 
300 350 400 450 500
0
5
10
15
20
25
FFT length/symbol
P
ow
er
ZJ(n) & TJ,n & Tv,n*1 (Eb/N0=10dB)
 
 
ZJ(n)
TJ,n
Tv,n*1
 
圖 3.5 功率門檻值模擬 
 
 22
在通道估計方面，由 2.2 節所提之 TD-LS，為使用安插在信號間已知 pilot 做通
道估測，偵測出干擾位置後，判斷干擾信號是否有干擾到 pilot tone，如有則捨棄
受干擾之 pilot tone，使用剩餘 pilot 做通道估測。 
表 3.1 為模擬場景參數，我們使用 OFDM-CDMA 系統，且信號本身具有跳頻機
制，以用於對抗干擾，信號點數為 256 點，總頻寬點數與 FFT 點數為 768 點，
干擾為固定 8 點干擾，干擾比信號強度高 10dB。 
N=256信號點數
J=8干擾個數
FH OFDM-CDMA QPSK 調變系統
(J/S)=10dB干擾與信號比(J/S)
固定干擾干擾模式
nloop=1000模擬次數
3N=768FFT點數
 
表 3.1 模擬場景參數-固定干擾 
圖 3.6-a 為 CFO 一標準化載波頻率補償之(RMSE)根均方誤差模擬圖，當 SNR 越
高越準確。一去除干擾後標準化載波頻率補償之根均方誤差公式如下： 
  2
1
1 ˆ
N
RMSE n n
n
CFO f f
N 
      (3.12) 
圖 3.6-b 中為頻域下最小平方通道估計法則(TD-LS)，去除干擾信號而仍夠準確。
一去除干擾後標準化載波頻率補償之根均方誤差公式如下： 
  2, ,
1
1 ˆ
N
RMSE LS n ideal n
nN 
 h h h   (3.13) 
圖 3.6-c 為干擾偵測錯誤率模擬圖，偵測出之干擾不等於實際干擾則為偵測錯
誤，總共執行模擬次數為 K 次。圖中可以看到 0bE N 不同時，干擾偵測的錯誤
機率(Probability of jamming detection error)隨著 0bE N 增加而降低。公式如下： 
 
 
1
JDE
ˆ
P
K
k
k
i i
K




   (3.14) 
 24
圖 3.7 為位元錯誤率模擬結果，藍色線表示沒干擾信號之 BER；紅色線是去除干
擾與使用強制歸零法則(zero-forcing)通道等化後之 BER；綠色線是去除干擾與使
用最小均方誤差法則(Minimum Mean Square Error)通道等化後，BER 仍能維持精
確度。強制歸零與最小均方誤差兩法則公式如下： 
         2ˆ ˆZF LS LSn h n n h n      z z  (3.15) 
         2ˆ ˆ 1MMSE MMSE MMSEn h n n h n SNR      z z  (3.16) 
其中   2 2nSNR E n    x 。 
 
5 10 15 20 25
10
-4
10
-3
10
-2
10
-1
10
0
Eb/N0 (dB)
B
E
R
BER Performance of QPSK Rayleigh fading channel for OFDM-CDMA system
 
 
QPSK Rayleigh (Remove Jamming & ZF)
QPSK Rayleigh (No Jamming)
QPSK Rayleigh (Remove Jamming & MMSE)
 
圖 3.7 位元錯誤率模擬 
 
 
 26
續排在 N+1~2N 點，再下一個則排列在 2N+1~3N 點，目的為避免干擾連續干擾
多個符元，且為隨機跳頻，故起始跳頻點為任一位置。高頻部份不傳資料，故屬
於雜訊區，其他頻段將會傳資料，故屬於信號區。 
 
圖 3.9 信號跳頻位置 
 
圖 3.10 信號與干擾示意圖 
 
 28
且同 3.1.1 小節，     21 3I , 0,1, ,3 1mni J j N
m i
n m e n N
 

  I  ，其中 i為跳頻點，本節
為一以 3 符元做跳頻之隨機跳頻干擾。 
 
含干擾之接收端，轉換到頻域 
               FFT x j fn n n n n n n     Z X I Vz    (3.18) 
取一段符元各點功率 
     2J n nZ Z  (3.19) 
功率門檻值公式相似於(3.7)式，表示為 
  
2
,
=1
Z
M
J n m
m
T w n m M    (3.20) 
(3.20)式為信號段含干擾之功率門檻值，使用此主動式門檻值做比較。由於信號
與干擾強度遠大於雜訊，檢測時，可以發現雜訊段之調整因子 1 範圍過大，所以
改為以主動式信號段門檻值之最高點作為判斷點，精簡化之干擾偵測的式子： 
  ˆ arg  J
n
i Z n T   (3.21) 
其中  ,max , 0,1,...,3 1J nT T n N   。如圖 3.12 所示，得到的 iˆ ，即為干擾所在位
置，將干擾消除後，將可使信號正確解調估測。 
Jamming
average
Comparator1
2   nz
 nZ MAX
 nZFFT iˆ
Jamming points
,J nT
W
T
 J nZ
 
圖 3.12 功率門檻值界定 
 
圖 3.13 為擷取某段信號之含干擾的功率響應圖。可以看到藍色是功率門檻值，
紅色是信號功率，圖 3.13-a 為表示完整一段符元之頻域信號，圖 3.13-b 為擷取
干擾位置左右一區塊範圍，以其最高點為門檻，threshold 可精準抓住干擾，避免
雜訊與信號被當作干擾而造成信號解調錯誤。 
 30
3.2.2 消除干擾與參數估計方法 
首先，頻域下含有干擾之接收端信號為 
         +q q q q q qn diag n n nZ X F I Vg +  (3.22) 
同 3.1.2 小節，信號為   qdiag nX ， qF 為傅立葉矩陣， qg 為通道響應值，  q nV
為高斯白雜訊，其中q表示為接收信號第q 個符元信號段，， 1,2, ,q Q  ，如
16q  。因本節探討之干擾為隨機跳頻干擾，且為一以 3 符元做一次隨機跳頻，
需各別估測各個符元之干擾位置。 
頻域下干擾表示為     3 10,0, , ,0, ,0 Tq i Nn I  I ，其中    = , , 1i I i I i J   I
為從跳頻點 i開始連續 J 點之干擾，  q nI 總長為 3N。 
由式(3.20)得到跳頻干擾位置 iˆ ，一去除干擾信號之新的接收信號為 
      q q qˆ ˆ n n nZ Z I-  (3.23) 
 qˆ nI 為偵測之跳頻干擾信號，表示為   ˆq 3 1ˆ 0,0, , ,0, ,0 Ti Nn    I  I ，其中
         ˆ ˆ ˆ ˆ ˆ ˆ= , , 1 , , 1 , ,i I i J I i I i I i I i J      I 為偵測之連續跳頻干擾位
置，從 iˆ 左右連續各 J 點之干擾，確保含括干擾段。干擾消除後，再使用第二章
所提之「Delay-and-correlation」與「TD-LS」做載波頻率補償與通道估計，取得
正確信號。 
在 CFO 方面，由 3.2.2 節所提之 preamble 架構，做為避免用以估測偏移角度之
preamble，遭受干擾命中，偵測出干擾位置後，選擇使用未受干擾信號命中影響
之 preamble 段做 CFO 補償。其中可能場景如圖 3.8 所示，隨機跳頻干擾到兩頻
帶之 preamble，使用此方法仍可保有一段 preamble 信號，免於遭受干擾影響。 
在通道估計方面，由 2.2 節所提之 TD-LS，為使用安插在信號間已知 pilot 做通
道估測。偵測出干擾位置後，判斷干擾信號是否有干擾到 pilot tone，如有則捨棄
 32
5 10 15 20 25
10
-4
10
-3
10
-2
Eb/N0 (dB)
R
M
S
E
RMSE performance of frequency offset estimation
 
 
1ppm CFO
 
(a) 
5 10 15 20 25
10
-2
10
-1
10
0 Time-domain least-square (TD-LS) estimation T
Eb/N0 (dB)
R
M
S
E
 
(b) 
-30 -20 -10 0 10 20
0
0.2
0.4
0.6
0.8
1
ISR (dB)
P
JD
E
Probability of jamming detection error (JDE)
 
(c) 
圖 3.14 CFO 估計、通道估計與干擾偵測錯誤率 
 34
四、封包同步與時間同步技術 
4.1 封包同步粗估 
4.1.1 封包粗估演算法 
  接收端啟動接收訊息，當資料開始接收時，使信號同步相當重要。開始接收
信號時若沒有精確對上時刻，在載波頻率補償與通道估測將取得錯誤的估計值，
導致信號解調錯誤。在接收信號時，同步時刻必須精準，使信號能夠按照發送時
的排序，準確的接收每一符元，使信號正確。本報告使用時域下正交金氏序列
(Orthogonal Gold sequence)組成之 PN 做為 PN 碼，此 PN 為已知，用以尋找粗估
之同步位置。從訊息接收後開始檢測同步位置，因為 ITU 通道模型建置之通道
環境，粗估到的同步位置會有所偏差。設計一 PN 碼為信號封包同步點估測，設
計方式如圖 4.1，為一串 PN 碼組成，用以估測同步信號。而每一 PN 碼長度設計
為 3N 長，因使用為長度 N/2 時域下之 PN 信號，一 PN 碼擺放 6 組相同之 PN 信
號，做為估測使用。 
PN1
N/2 points
PN2 PN3 PN4 PN5 PN6
PNPNPN PN  
3N points
 
圖 4.1 PN 碼示意圖-時域 
傳送端設計之 PN 信號公式為 
    1 2 / 2, , ,p Nn x x x x  (4.1) 
採用重複 6 段 PN 的 PN 碼發射信號 
              [      ]PN p p p p p pn n n n n n nx x x x x x x  (4.2) 
 
 36
強峰值。在強峰值附近因多路徑通道關係，會有與多路徑通道對應之較小振幅。
為了找出信號同步點，將匹配後得到之  p nz 取其振幅，並以 L 次延遲之振幅方
式相加，在多路徑通道響應可合成最大峰值，如下式 
    1 2
0
L
p p
l
n n l


  z z  (4.6) 
從  pz n 中找出最大值即為粗估同步位置，如下式  
   arg  max pnn z n   (4.7) 
其中粗估位置 n，因本節為粗估同步位置，故估測點n有一範圍。 
 38
  首先，表 4.1 為模擬參數，其中之 CFO 與 ISR 將會因模擬情況而有所不同。
本報告使用連續 6 點之多路徑通道衰減環境，比 ITU 之通道環境更為嚴謹。干
擾個數為連續 8 個 tone 的跳頻干擾，操作在訊雜比-30~20dB 之間，Pd 為同步成
功機率，為估測點 n與實際點n 相差 k之範圍表示估測成功，粗估之 k=8。Chip time
為 50ns，載波頻率為 93.5 10 Hz ，模擬在不同 CFO 與干信比(ISR)下，估計同步
位置的精準度。 
 
Pd(同步成功機率)
載波頻率
50nsChip time
L=6，延遲時間 [0 1 2 3 4 5]通道Multipath數與延遲時間
[0 -1 -9 -10 -15 -20] (dB)Multipath能量強度
-15 ~ 20 (dB)訊雜比 (Es/N0)
[0.1 10 100] (ppm)，依據模擬而有
所不同
載波頻率偏移 (CFO)
[-10 0 10] (dB)，依據模擬而有所不
同
干擾與信號比 (ISR)
J=8干擾點數
nloop=10000模擬次數
 9cf = 3.5 10 Hz
 -p n n k
 
表 4.1 同步模擬參數 
 
 
首先模擬一 CFO=100ppm 與 ISR=-10dB，比較本報告方法與 MFB[19]及傳統方
法[18]之成功估測到粗估同步位置 n之模擬圖，如圖 4.3。從圖中可以看到本文所
提出方法因具有抗強 CFO 之能力，比對 MFB 可得到一更好性能，在成功率 0.9
左右，；傳統方法則無法在有干擾與強 CFO 環境下估測，其成功估測機率甚至
不到 0.2。 
 
 40
接續，模擬一 CFO=10ppm 與 ISR=-10dB，比較本報告方法與 MFB[19]及傳統方
法[18]之成功估測到粗估同步位置 n之模擬圖，如圖 4.5。由於此時 CFO 強度較
低，MFB 因 CFO 影響小而得到較佳性能，約 Es/N0=-5dB 即達到 1 之性能，但
本文所提出方法因具有抗強 CFO 之能力，Es/N0=10dB 左右仍有 0.9 成成功率，
且實際情況常探討強健 CFO，故本文提出之方法相當適用於實際情況。與傳統
方法比較，傳統方法之成功率無法超過 0.2，本報告方法則擁有相當好性能。 
 
-15 -10 -5 0 5 10 15 20
0
0.2
0.4
0.6
0.8
1
Es/N0
P
d 
(s
uc
ce
ss
 d
et
ec
tio
n)
 
 
Proposed Matched Filter
Matched Filter Bound
Schmidl & Cox
 
圖 4.5 粗估成功機率模擬圖 CFO=10ppm，ISR=-10dB 
 
同圖 4.5 模擬一 CFO=100ppm 與 ISR=-10dB，比較本報告方法與 MFB[19]及傳統
方法[18]之均方根誤差(RMSE)模擬圖，如圖 4.6。從圖中可以看到 CFO 影響小，
MFB 性能有著大幅提升，但本文所提出方法仍可得到一不錯性能，且比起傳統
方法 RMSE 仍還要好，可見在 CFO 與干擾影響下，本報告方法有一穩定性能。 
 42
同圖 4.7 模擬一 CFO=0.1ppm 與 ISR=-10dB，比較本報告方法與 MFB[19]及傳統
方法[18]之均方根誤差(RMSE)模擬圖，如圖 4.8。此時之 CFO 強度低，MFB 獲
得較佳 RMSE 性能，但本文所提出方法，雖此時之 CFO 強度低，無法獲得較多
性能，但比起傳統方法之 RMSE 仍好數倍。 
 
-15 -10 -5 0 5 10 15 20
10
-1
10
0
10
1
10
2
Es/N0
R
M
S
E
 
 
Schmidl & Cox
Match filter bound
Proposed Matched Filter
 
圖 4.8 粗估 RMSE 模擬圖 CFO=0.1ppm，ISR=-10dB 
 
模擬 CFO=10ppm，比較本報告方法在不同 ISR 下之成功估測到粗估同步位置之
模擬圖，如圖 4.9。從圖中可以看到在強干擾 ISR=10dB 以及干擾與信號強度相
同之 ISR=0dB，二者估測效果差，在接續之 4.1.3 將提出方法解決強干擾性能不
佳問題。在弱干擾 ISR=-10dB，在 Es/N0=5dB 之後擁有 0.9 成以上成功率，擁有
良好性能。 
 44
4.1.3 改進粗估法則 
  為了改進上述在強干擾環境下，無法估測之性能，我們可進一步加入干擾消
除之技術，將可提升性能，其方塊圖如下： 
 p nz Demux
Off
JammingFFT
Off
JammingFFT
IFFT
IFFT
Mux
 p nz
 
圖 4.11 改進粗估法則方塊圖 
使用一多工器，將信號  p nz 之 1~N 點從上路做干擾消除，接續之 N-1~2N 點則
切換至下路做干擾消除，依此切換消除干擾，符合實際操作情況，再將信號結合
回  p nz 。其中干擾消除位置已經於第三章可偵測得知，故可利用於此封包估測
架構，提升 Pd 與 RMSE 能力。此架構結合圖 4.2 可完整的模擬封包估測之性能。 
首先，模擬 CFO=10ppm，比較本報告方法在消除干擾與干擾存在下，不同 ISR
下之成功估測到粗估同步位置模擬圖，如圖 4.12。改進圖 4.9 中含干擾情況與強
干擾情況無法估測問題。在干擾去除下，即使強干擾 ISR=10dB 仍可準確估測粗
估位置，圖中可發現 ISR=10 與 0 與-10dB 彼此性能接近，可見改進方法有效提
升在強干擾環境之性能。 
 46
4.2 封包同步細估 
4.2.1 封包細估演算法 
由粗估所得到之封包同步位置 n，因為粗略估測其位置在一可接受之範圍，故本
節則取其附近 ~d d  做細估。其中包含干擾偵測與干擾消除，以得到正確細估
位置，如圖 4.14。接收信號經由緩衝器擷取，轉到頻域下偵測干擾並消除干擾，
轉回時域後如同(4.5)式方式消除接收信號之弦波效應，再與已知新型信號做匹配
並取其振幅，在細估範圍內找最大峰值，即為細估同步位置n 。 
 p nz Buffer
D

MFOffJamming
n n 
FFT
Jamming
Detector
n
kˆ
IFFT  p nz p kZ p nz  p kZ
Find
Max
2  
 p nz  p nz
 
圖 4.14 封包同步細估方塊圖 
粗估同步位置 n後，在n左右範圍 ~d d  做細調，其細估接收信號公式為 
 
     
     
1
2
0
1
0
L
j fn
p p p
L
j
n n e
n n



 
 




      
      

 I
z x
v


  (4.13) 
其中 n n n   ， n為粗調估計時間， n 為細調之調整範圍， ~n d d    。 
將信號轉到頻域進行干擾偵測，公式如下 
     FFTp pk nZ z ， 0,1, , 12Nk     (4.14) 
偵測方式同第三章，取接收信號能量可得 
     2p pk kZ Z   (4.15) 
將信號以 M 次相加取其平均能量，可得到一門檻值  Tp k ，以此做為檢測干擾位
置門檻，如下式 
    
2
1
T
M
p p
m
k k m M

 Z   (4.16) 
 48
4.2.2 細估模擬結果 
  細估之模擬，本報告方法將與傳統 WLAN 同步估測法則[2]做比較。均方根
誤差(RMSE)同(4.12)式，但為細估點與實際點之比對。模擬參數同表 4.1，其中
估測點n 與實際點 n相差 k 之範圍，因估測細估同步位置，以更嚴謹之範圍估測，
k=1。 
  首先，模擬 CFO=100ppm，比較本報告方法與傳統 WLAN[2]在不同 ISR 下
之成功估測到細估同步位置之模擬圖，如圖 4.15。從圖中可以看到本文所提出方
法在干擾去除，且具有抗強 CFO 特性，即使強干擾 ISR=10dB 仍有良好性能，
在 Es/N0=10dB 擁有約 0.9 成功率。傳統 WLAN[2]方法則在干擾存在情境下，不
論干擾強弱，仍完全無法估測。 
-15 -10 -5 0 5 10 15 20
0
0.2
0.4
0.6
0.8
1
Es/N0
P
d 
(s
uc
ce
ss
 d
et
ec
tio
n)
 
 
Proposed Method ISR=-10dB
Proposed Method ISR=0dB
Proposed Method ISR=10dB
Traditional Method [2] ISR=-10dB
Traditional Method [2] ISR=0dB
Traditional Method [2] ISR=10dB
 
圖 4.15 細估成功機率模擬圖 CFO=100ppm 
同圖 4.15 為 CFO=100ppm，比較本報告方法及傳統 WLAN [2]在不同 ISR 下之均
方根誤差(RMSE)模擬圖，如圖 4.16。從圖中可以看到本文所提出方法在干擾去
除，且具抗強 CFO 特性，在 RMSE 約 02 10 可看出即使強干擾 ISR=10dB，也僅
損失約 4dB 左右性能，而本文方法比起傳統 WLAN [2]之 RMSE 性能好數倍。 
 50
4.3 符元的時序同步 
4.3.1 符元時序演算法 
  經由細估得到信號封包同步位置n 後，在 PN 碼與信號間之時序同步，如何
辨識 PN 碼尾端，使接收信號之時序準確，本節研究使用一辨識碼在干擾偵測並
消除干擾後，與已知 PN 信號匹配得到時序同步位置，流程方塊如圖 4.17。得到
封包同步位置 n ，偵測干擾並消除干擾信號。再經過一匹配濾波器與信號
symbol-based 取樣，得到含有辨識碼之接收信號，將之與已知辨識碼信號做匹
配，找出時序位置。 
 
圖 4.17 時序同步方塊圖 
此時接收後段之 PN 信號如下(含 Cover sequence，覆蓋序列) 
 
       
     
1
2
0
1
0
p
p
L
j fn
p p p p
L
j
n n n e
n n



 
 




         
        

 I
z c x
v


 (4.23) 
因方塊圖中取樣與去除干擾方式相同於細調方法，故本單元即接續說明反傅立葉
轉換後，時域下信號為 
     IFFTp pn k Zz  (4.24) 
將干擾偵測並消除干擾後之時域信號  p nz 與已知信號  p nx 做迴旋匹配，如下
式 
      
1
2
1
N
p p p
m
n m n m



   z x z  (4.25) 
 52
4.3.2 符元時序模擬結果 
  符元時序之模擬，分成為有無將干擾消除之情況做比較。均方根誤差(RMSE)
同(4.12)式，但為時序估測點與實際點之比對。模擬參數同表 4.1，其中估測點n
與實際點 n相差 k 之範圍，因時序為完全正確估測信號起始頭，否則之後信號將
會解調錯誤，此時 k=0。 
  首先，模擬 CFO=100ppm，比較本報告方法在不同 ISR 下以及消除干擾或未
消除干擾之成功估測時序同步位置之模擬圖，如圖 4.18。圖中可看出在未消除干
擾且強 CFO 環境下，因 ISR=-10dB 為弱干擾環境，可得到 0.9 成功率性能，可
見本方法抗 CFO 效果佳。在 Es/N0=15dB，有消除干擾且為強 CFO 環境下，強
干擾 ISR=10dB 便可得到 0.8 成功率。而在干擾存在且為強干擾 ISR=0dB 與 10dB
成功率低於 0.2。 
-15 -10 -5 0 5 10 15 20
0
0.2
0.4
0.6
0.8
1
Es/N0
P
d 
(s
uc
ce
ss
 d
et
ec
tio
n)
 
 
Proposed Method Jamming-off ISR=-10dB
Proposed Method Jamming-off ISR=0dB
Proposed Method Jamming-off ISR=10dB
Proposed Method Jamming-on ISR=-10dB
Proposed Method Jamming-on ISR=0dB
Proposed Method Jamming-on ISR=10dB
 
圖 4.18 時序成功機率模擬圖 CFO=100ppm 
同圖 4.18 為 CFO=100ppm，比較本報告方法在不同 ISR 下以及消除干擾或未消
除干擾之均方根誤差(RMSE)模擬圖，如圖 4.19。圖中可看出在 Es/N0=15dB 之
比較，有消除干擾之 RMSE 比未消除干擾好 2 倍之性能，且在 RMSE 為 01 10 時，
弱干擾 ISR=-10dB 情況下，消除干擾比未消除干擾好約 4dB 性能。 
 54
同圖 4.20 為 CFO=10ppm，比較本報告方法在不同 ISR 下以及消除干擾或未消除
干擾之均方根誤差(RMSE)模擬圖，如圖 4.21。圖中可看出當 Es/N0=15dB 之比
較，有消除干擾之 RMSE 比未消除干擾在強干擾 ISR=10dB 好 2 倍之性能，且在
RMSE 為 13 10 時，弱干擾 ISR=-10dB 情況下，消除干擾比未消除干擾好約 5dB
性能。 
 
-15 -10 -5 0 5 10 15 20
10
-1
10
0
10
1
Es/N0
R
M
S
E
 
 
Proposed Method Jamming-on ISR=10dB
Proposed Method Jamming-on ISR=0dB
Proposed Method Jamming-on ISR=-10dB
Proposed Method Jamming-off ISR=10dB
Proposed Method Jamming-off ISR=0dB
Proposed Method Jamming-off ISR=-10dB
 
圖 4.21 時序 RMSE 模擬圖 CFO=10ppm 
 
接續模擬 CFO=0.1ppm，比較本報告方法在不同 ISR 下以及消除干擾或未消除干
擾之成功估測時序同步位置之模擬圖，如圖 4.22。圖中可看出因 CFO 影響小，
其模擬結果相似於 CFO=10 ppm 之圖 4.20 結果，在 Es/N0=-5dB 即擁有將近 0.8
成功率，只有未消除干擾且強干擾 ISR=10dB 僅擁有 0.5 左右成功率，可見本方
法之抗 CFO 性能與干擾環境之能力。 
 
 56
五、結論 
  本計畫結構採用 OFDM-CDMA 的架構組成信號模型，探討信號在頻域上的
數位跳頻迴避干擾，且使用一干擾偵測機制去除敵方干擾源影響信號。在第二章
使用近年常用的「Delay-and-correlation」CFO 補償方式解決頻率偏移問題，並使
用頻域上的「最小平方法則」(Time-domain least-square)尋找通道估計值，解決多
路徑通道衰減問題，並使用 ITU 通道模型，模擬真實的通道環境，確實得到一
不錯之結果。在第三章，對於敵方的窄頻干擾，包含固定點式與跳頻方式兩大主
題的干擾，用一 CFAR 干擾偵測機制，準確檢測出干擾位置，並計算干擾偵測錯
誤機率，隨著 Eb/N0 越高而降低，且在 CDMA 展頻下，如信號遭受干擾其中一
塊,仍確保至少一段信號未受干擾直接影響，維持一定之性能。在第四章，信號
同步方面，有干擾情況下之封包同步與符元的時間同步，使用時域下之已知 PN
碼，估測封包同步位置，在干擾消除前後同步點之精準度均有一定性能；時序同
步情況，使用覆蓋序列辨識碼匹配含覆蓋序列之接收信號，估測實際信號起始位
置，可得到一匹配結果，且本報告提出之方法具有抗強 CFO 之能力，在強 CFO
環境下仍可準確估測封包與時序同步位置。 
  最後，運用電腦的模擬結果，結合以上三章，顯示出載波頻率補償與通道估
計精準度，位元錯誤率比對與同步檢測比對模擬，運用以上方法得到一個高性能
結果，並在迴避干擾與偵測干擾，使用展頻機制，確實保全信號不受干擾影響。
未來在使用跳展頻系統，抗干擾也可用於軍方的敵方偵測，在無線通訊產業的發
展上，也可藉由消除他台干擾信號，達到正確傳送信號效果，且可使用硬體做實
現，研究實際收發機之情況，並可考慮多用戶情況，彼此間如何在互相可能有干
擾的情況下互傳。 
 
 
 
 2
[11] Y. T. Su, Y.-S. Shen, and C.-Y. Hsiao, “A study of frequency-hopping multiple access mobile 
satellite systems,” National Chiao Tung Univ., Final Report, NSC84-2612-E009-003, Aug. 
1995. 
[12] S. H. Kim and S. W. Kim , “Frequency-Hopped Multiple-Access Commun- ications with 
Multicarrier On–Off Keying in Rayleigh Fading Channels,” IEEE Trans. Commun., vol. 48, pp. 
1692 – 1701, Oct. 2000. 
[13] Torrieri, D.J,“Mobile frequency-hopping CDMA systems”, IEEE Trans. Commun., Trans., vol. 
48, pp. 1318 – 1327, Aug. 2000. 
[14] K. H. Halford and M. Brandt-Pearce,, “Multistage multiuser detection for FHMA,” IEEE Trans. 
Commun., vol. 48, pp. 1550 – 1562, Sept. 2000. 
[15] Yu. T. Su and Y. S. Shen and C. Y. Hsiao, “On the detection of a class of fast frequency-hopped 
multiple access signals,” IEEE Trans. Commun., vol. 19, pp. 2151 – 2164, Nov. 2001. 
[16] M. Sandell, J. J. van se Beek and P. O. Borjesson, “Timing and frequency synchronization in 
OFDM systems using the cyclic prefix,” in Proc. of the Int. Symp. on Synchronization , Essen, 
Germany, pp. 16-19, 1995. 
[17] S. H. Muller-Weinfurtner, “On the optimality of metrics for coarse frame synchronization in 
OFDM :A comparison,” in Proc. IEEE Int. Symp. on Personal, Indoor, and Mobile 
Communication, Boston, MA, pp. 533-537, Sept. 1998. 
[18] Schmidl, T.M., Cox, D.C., “Robust frequency and timing synchronization for OFDM”, IEEE 
Trans. Commun., vol. 45, pp. 1613-1621, Dec. 1997. 
[19] 第十四屆海峽兩岸無線電技術研討會「適用於多路徑無線通道環境之犛耙式匹配濾波器封
包同步技術」 
[20] Tufvesson, Fredrik, Edfors, Ove, Faulkner, Mike, “Time and frequency synchronization for 
OFDM using PN-sequence preambles”, IEEE Vehicular Technology., vol. 4, pp. 2203 – 2207, 
1999. 
[21] Minn, H., Bhargava, V.K., Letaief, K.B., “A Robust Timing and Frequency Synchronization for 
OFDM Systems”, IEEE Trans. Commun., vol. 2, pp. 822 – 839, Jul. 2003. 
99年度專題研究計畫研究成果彙整表 
計畫主持人：鄧俊宏 計畫編號：99-2623-E-155-007-D 
計畫名稱：前瞻通信技術研究(II)--子計畫二：適用於具跳展頻抗干擾之隨意通之協力通信系統之實
體層收發機設計 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 1 1 100% 結案研究報告一份 
研討會論文 1 1 100% 
篇 
發表至 2010 全國
電信研討會 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 3 3 100%  
博士生 1 1 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
 
