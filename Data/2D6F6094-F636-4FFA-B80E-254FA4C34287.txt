線的所需參數(如SPI、Ports辨識碼)提出保護，以防止有心人的竊取，並擬對換
手時網路安全進入的程序提出最佳化的修改。再者，基於網絡的移動性管理研究
部份，是為了能解決一些在基於主機移動管理上存在的弱點，例如減少換手所需
的信令花費(cost)和換手的時間延遲，設計加入Fast Handover 機制改進換手的效
能。最後，研究在於一般家用基地台(Femtocell或Femto ABS)後端家用網路連線
(Backhaul Link，如ADSL)不穩定的問題。當家用基地台失去後端網路連線的狀
況時，須藉由穩定換手機制到換手其它基地台，達到減少使用者連線中斷的情
況。 
文獻探討 
IMS 的 Access Security 安全機制 
許多 SIP執行異質網路 (例如Universal Mobile Telecommunications System, UMTS 
和 WirelessLocal Area Network, WLAN)之間的換手。然而，基於安全考量，任何
服務應該在使用者裝置  (User Equipment, UE)與 IMS 網路之間的 Security 
Association (SA) 建立後才可進行。SA 包含了建立安全連線的所需參數。當一個
具有 UMTS 和 WLAN 介面的雙模 UE 從 UMTS 網路移動至 WLAN 網路時，應
重新建立 SA 以便設置安全連線，反之亦然。在本計劃希望利用更新 SA 取代重
新建立 SA 的機制，藉此減少 UE 由 WLAN 介面重新註冊至 IMS 網路時所造成
的延遲。在成功由 WLAN 介面註冊至 IMS 網路後，UE 應當發起 re-INVITE 程
序來遷移之前正在進行的通話或服務。此程序需傳送大量的 SIP 信息。然而這會
消耗無線網路有限的頻寬並增加換手的延遲時間。為了改善換手效率，希望提出
UE 在重新註冊時，將 re-INVITE 程序所需的 Session Description Protocol (SDP)
資訊傳送給 IMS 網路中的 Call Session Control Function (CSCF)。如此 CSCF 便可
直接代替 UE 發起 re-INVITE 程序，藉此減少無線網路傳輸所造成的延遲。 
基於網絡的移動性管理研究 
代理行動 IPv6 (Proxy Mobile IPv6，簡稱 PMIPv6)被定義在 RFC 5213，基於網路
行動管理可以讓行動台透過 IP 移動時不需要傳送任何的換手所需的相關訊息，
例如連結更新(Binding Update)。行動台移動時的 IP 位址的轉變，是由網路所負
UE 無法連線到核心網路和網際網路。為了解決此問題，本計畫透過服務可靠性
的概念與網路管理系統(Network Management System)提出備援連線機制，來處理
當 HeNB 失去後端網路連線時，達到降低使用者連線的中斷時間(Interrupt 
Time)。  
研究方法 
 分析欲探討的安全機制或換手機制 
 分析比較相關 Proxy Mobile IPv6 (PMIPv6) 與 Fast Handover for 
PMIPV6 (F-PMIPv6)的換手機制。 
 分析探討三種機制BROADCASTING THE AAI-SON-ADV MESSAGE、
USING HO PROCEDURE 與 UNICASTING THE AAI-SON-ADV 
MESSAGE 來處理後端網路故障之問題 
 探討使用 IMS 的 Access Security 安全機制與 Fast SA Update 機制 
 提出與原來機制的進化機制 
 提出一個混合模式快速換手於代理式移動 IPv6 機制(Hybrid-mode 
F-PMIPv6，簡稱 HF-PMIPv6) 
 應重新建立SA以便設置安全連線並提出利用更新SA取代重新建立SA
的機制 
 對這些探討的安全機制或換手機制與新提出的機制做進一步的效能分析或
比較 
 建立分析模型依序比較PMIPv6、F-PMIPv6及HF-PMIPv6的換手延遲、
信令花費(cost)，與封包傳送花費。 
 建立分析模型對三種處理後端網路故障之機制作定性及定量的比較，並
評估三個機制 
 設計一套效能分析模式比較 Fast SA Update 與原始 SIP 之 handoff 延遲 
 分別整理其研究成果並發表論文 
 
行動台 AMSs 連結到其他 ABS。如果 Femto ABS 有 R8 介面連接到 Macro 
ABS，Femto ABS 會與 Macro ABS 利用 HO 訊息先溝通相關參數後，利用換
手程序將行動台 AMSs 轉移到 Macro ABS。論文發表於 ICPP 2011。此一技
術已納入 IEEE 802.16m 提案中，目前正在研究改善沒有 R8 介面的機制，
完成後應可提出專利。 
 本論文介紹網路電話號碼的規劃原則，及展示兩個 IPv6 的話機與 IPv4 話機
相互通訊的機制。論文中利用三個訊息流的範例，展示 IPv4 與 IPv6 間的
VoIP 撥號呼叫情況。論文發表於 IEEE AINA 2011。本論文後續設計出不需
要伺服器協助轉換之機制，正在寫作論文，擬於國際期刊中發表。 
目前 LTE/LTE-A 仍在初期開發階段，在無線存取網路(Radio Access Network，
簡稱 RAN)，核心網路技術(Core Network Technology)，以及 IP 多媒體子系統(IP 
Multimedia Subsystem，簡稱 IMS)有許多可以研究與實作的議題，且在規格尚有
許多可以改進之處，投入研究能量應可產出不錯的成果。本子計畫原規劃配合總
計畫在 OPNET 上開發相關模組，但總計畫因核定經費不足未能採購 OPNET，
故本子計畫改以 ns2 做為研究模擬驗證所需的平台。 
 
establishes a tunnel between the P-MAG and the N-MAG to 
prevent packet loss. If the mobility mode is reactive, HF-
PMIPv6 performs handover directly without setting up a 
tunnel to reduce the extra handover latency, the signaling cost 
and the tunnel transmission cost. 
In this paper, we introduce the message flows of PMIPv6 and 
F-PMIPv6 in section 2. In section 3, we elaborate the 
proposed mechanism and utilize an example to describe the 
message flow. We conduct the analytical models to evaluate 
the performance of F-PMIPv6 and HF-PMIPv6 in terms of 
handover latency, signaling cost and packet delivery cost in 
section 4. We evaluate the numerical results in section 5 and 
give the conclusion in the last section. 
2 Overview PMIPv6 and F-PMIPv6 
2.1 Proxy Mobile IPv6 (PMIPv6) 
When the MN changes its point of attachment from the access 
link of the serving MAG (i.e., P-MAG) to that of the target 
MAG (i.e., N-MAG), the MN performs the PMIPv6 handover 
procedure and the message flow is shown in Figure 1. The 
details of the message flow are described as follows: 
MN LMA
5. RA
(HNP)
2. PBU
(MN-ID)
3. PBA
(HNP)
4. Bi-Dir Tunnel
6. Deliver Packets
N-MAG
1. L2 Handover
(MN-ID)H
an
d
o
v
er L
aten
cy
 
Figure 1: The message flow of PMIPv6 
Step 1. An MN moves to the N-MAG’s access link and the 
N-MAG obtains the MN-ID through Layer-2 
procedure. 
Step 2. After obtaining the MN-ID, the N-MAG sends a 
Proxy Binding Update (PBU) message containing 
the MN-ID to the LMA. The PBU message is used to 
update the MN’s current location. 
Step 3. Upon receipt of the PBU message, the LMA replies a 
Proxy Binding Acknowledgement (PBA) message 
containing the MN’s Home Network Prefix (HNP) to 
the N-MAG. The LMA also updates its binding cache 
entry and sets up a tunnel to the N-MAG. 
Step 4. When the N-MAG receives the PBA message, it also 
sets up a tunnel to the LMA. At this point, the bi-
directional between the LMA and the N-MAG is 
established. 
Step 5. Then the N-MAG sends the Router Advertisement 
(RA) message to the MN containing MN’s HNP. 
Note that since the HNP is the same, the MN detects 
that the IP address is not changed in this handover 
procedure. 
Step 6. The LMA forwards the packets sent from the 
Correspondent Nodes (CNs) to the N-MAG through 
the bi-directional tunnel established in Steps 3 and 4. 
After the N-MAG receives these packets, it forwards 
these packets to the MN through the access link. 
2.2 Fast Handovers for Proxy Mobile IPv6 (F-PMIPv6) 
F-PMIPv6 combines PMIPv6 and the fast handover 
mechanism to reduce packet loss. There are the predictive 
mode and the reactive mode in F-PMIPv6. In the predictive 
mode, the tunnel is established between the P-MAG and the 
N-MAG before an MN moves to the N-MAG. The P-MAG 
utilizes this tunnel to transfer the packets to the N-MAG when 
the MN performs the handover procedure. The N-MAG 
buffers the received packets until the MN attaches to its 
access link, and then forwards the buffered packets to the MN. 
There is no packet loss during the MN performs handover in 
the predictive mode. Figure 2 demonstrates the message flow 
of F-PMIPv6 predictive mode and the details of the message 
flow are described as follows: 
MN LMAP-MAG N-MAG
Buffering
1. Report
(MN-ID, NAP-ID) 2. HI
(MN-ID,“P”flag, HNP)
3. Hack
(“P”flag)
5. Hack
(“F”flag)
10. PBU
(MN-ID)
11. PBA
(HNP)
9. Deliver Packets
7. Forward Packets
4. HI
(MN-ID,“F”flag)
14. Deliver Packets
12. Bi-Dir tunnel
6. tunneling
8. L2 Handover
(MN-ID)
H
an
d
o
v
er L
aten
cy
13. RA
(HNP)
 
Figure 2: The message flow of F-PMIPv6 predictive mode 
Step 1. The MN reports its MN-ID and the information of 
the new AP (i.e., NAP-ID) to the P-MAG. 
Step 2. Assume that the P-MAG receives the report message 
and decides to perform the handover procedure. The 
P-MAG retrieves the N-MAG’s information from the 
NAP-ID and sends a Handover Initiate (HI) message 
which contains an MN-ID, a "P" flag and the MN’s 
the P-MAG and the N-MAG in advance, and thus it results in 
packet loss during the MN performs handover. 
In the F-PMIPv6 reactive mode, the MN performs Layer-2 
handover procedures before setting up a tunnel between the 
P-MAG and the N-MAG. The P-MAG cannot send these 
packets to the N-MAG’s buffer during that the MN performs 
handover. Thus, these packets may be lost during the 
handover processes. Moreover, the N-MAG exchanges the 
signaling messages with the P-MAG to establish a tunnel 
before sending the PBU message to the LMA. This process 
cannot prevent packet loss but increases the signaling cost 
and handover latency. In the F-PMIPv6 reactive mode, during 
handover, these packets from a CN to the MN follows the 
transmission path CN→LMA→P-MAG→N-MAG→MN. 
The packet transmission path increases the tunnel 
transmission cost. 
In order to take advantage of the F-PMIPv6 predictive mode 
and solve the issues of the F-PMIPv6 reactive mode, we 
propose a HF-PMIPv6 mechanism. HF-PMIPv6 utilizes a 
decision table to detect the mobility mode (i.e., predictive or 
reactive mode). If the mobility mode is predictive, HF-
PMIPv6 establishes a tunnel like F-PMIPv6 between the P-
MAG and the N-MAG to prevent packet loss. If the mobility 
mode is reactive, HF-PMIPv6 performs handover directly 
without setting up a tunnel to reduce the extra handover 
latency, the signaling cost and the tunnel transmission cost. 
Figure 4 and Figure 5 illustrate the detail message flows of 
the HF-PMIPv6 predictive and reactive modes. In Figure 4, 
HF-PMIPv6 is in the predictive mode. The message flow in 
Figure 4 is the same as that of F-PMIPv6 predictive mode 
except Steps 3, 10 and 12. Assume that the MN-ID of the MN 
is MN-1, the details are described as follows: 
MN LMAP-MAG N-MAG
Buffering
1. Report
(MN-1, NAP-ID) 2. HI
(MN-1,“P”flag, HNP)
4. Hack
(“P”flag)
6. Hack
(“F”flag )
13. PBU
(MN-1)
14. PBA
(HNP)
11. Deliver Packets
8. Forward Packets
5. HI
(MN-ID,“F”flag)
17. Deliver Packets
15. Bi-Dir tunnel
7. tunneling
9. L2 Handover
(MN-1)
3. 
Recording
10. Querying
12. 
Removing
H
an
d
o
v
er L
aten
cy
 
MN-1
empty
empty
Decision Table
empty
empty
empty
Decision Table
16. RA
(HNP)
 
Figure 4: The message flow of HF-PMIPv6 predictive mode 
Step 1. The MN reports its MN-ID (i.e., MN-1) and the 
information of the new AP (i.e., NAP-ID) to the P-
MAG. 
Step 2. Assume that the P-MAG receives the report message 
and decides to perform the handover procedure. The 
P-MAG retrieves the N-MAG’s information from the 
NAP-ID and sends a Handover Initiate (HI) message 
which contains an MN-ID (i.e., MN-1), a "P" flag 
and the MN’s HNP to the N-MAG. Note that the "P" 
flag represents that the MN uses F-PMIPv6 
mechanism. 
Step 3. Upon receipt of the HI message which contains the 
MN-ID (i.e., MN-1), the N-MAG stores the MN-ID 
into the decision table. 
Step 4. The N-MAG replies a Handover Acknowledge 
(HAck) message which contains a "P" flag to the P-
MAG. 
Step 5. The N-MAG prepares the buffer space for the 
upcoming packets and sends another HI message 
which contains MN-ID (MN-1) and an “F” flag to 
the P-MAG. The “F” flag represents the 
“Forwarding” flag. This message informs the P-
MAG to start transferring these packets that is 
destined to the MN to the N-MAG. 
Step 6. Upon receipt of the HI message, the P-MAG replies 
a HAck message with "F" flag and establishes the 
tunnel to the N-MAG. 
Step 7. Upon receipt of the HAck message, the N-MAG 
establishes the tunnel to the P-MAG. At this point, a 
bidirectional tunnel established between the P-MAG 
and the N-MAG. 
Step 8. When the P-MAG receives the packet sent to the 
MN, it modifies the outer IP header of the packet and 
then forwards the packet to the N-MAG. The N-
MAG stores this packet in the buffer until the MN 
connects to the N-MAG. 
Step 9. The MN performs the Layer-2 handover procedures 
to change the access link from the P-MAG to the N-
MAG. From this procedure, the N-MAG obtains the 
MN’s information including MN-ID (MN-1). 
Step 10. The N-MAG uses the MN-ID (MN-1) to query the 
decision table. Since the MN-ID (MN-1) is found in 
the decision table, the N-MAG forwards the buffered 
packets to the MN. 
Step 11. The N-MAG transfers the buffered packets to the 
MN. The packet transmission path from the CN to 
the MN is CN→LMA→P-MAG→N-MAG→MN. 
Step 12. After the N-MAG starts to transfer the buffered 
packets to the MN, it deletes the MN-ID (i.e., MN-1) 
entry from the decision table. 
Step 13. The N-MAG sends a PBU message to the LMA to 
update the MN’s binding. 
Step 14. Upon receipt of the PBU message, the LMA updates 
the binding and changes the tunnel from the P-MAG 
to the N-MAG and replies a PBA message. 
Step 15. Upon receipt of the PBA message, the N-MAG sets 
up a tunnel to the LMA. At this point, the bi-
directional tunnel has been set up. 
HF-PMIPv6 reactive mode includes the signaling cost of the 
PBU and PBA messages, the signaling cost of the RA 
message and the processing cost of the N-MAG and the LMA. 
The signaling cost can be expressed as the follows. 
6
, ,
2HF PMIPv
BU N MAG LMA MN N MAG
C C C
 
 
 
2
N MAG LMA
PC PC

 
.                   (4) 
The signaling cost of the F-PMIPv6 reactive mode includes 
the signaling cost of the HI and HAck messages, the signaling 
cost of the PBU and PBA messages, the signaling cost of the 
RA message and the processing cost of the P-MAG, the N-
MAG and the LMA. The signaling cost can be expressed as 
the follows. 
6
, , ,
2 2  F PMIPv
BU P MAG N MAG N MAG LMA MN N MAG
C C C C
   
  
 
3
P MAG N MAG LMA
PC PC PC
 
  
.                (5) 
4.3 Packet delivery cost 
Assume that the tunnel effect and the dropping effect are the 
same. The packet delivery cost (
PD
C ) combines the tunneling 
cost (
tunnel
C )
 
with the packet loss cost (
loss
C ) [12], and can be 
expressed as the follows. 
PD tunnel loss
C C C 
.                             (6) 
Let 
d
S  be the average size of data packets and 
c
S  be the 
average size of signaling packets. Assume that the rate 
/
d c
S S   and   is the packet arrival rate in unit of packet 
per time. 
In reactive mode, HF-PMIPv6 does not establish the tunnel 
between the P-MAG and the N-MAG. Therefore, the 
tunneling cost is zero 
6 0HF PMIPv
tunnel
C   . The data packet 
delivery cost between the CN and the MN is 
, , ,
( )
CN LMA LMA P MAG P MAG MN
C C C
 
   . The packet loss cost 
can be expressed as follows. 
6
2 , ,
( 2 )HF PMIPv
loss L MN N MAG N MAG LMA
C T T T
 
   
 
, , ,
( )
CN LMA LMA P MAG P MAG MN
C C C
 
   
.    (7) 
In the reactive mode, F-PMIPv6 established the tunnel 
between the P-MAG and the N-MAG after the MN performs 
Layer-2 handover. Therefore, the F-PMIPv6 reactive mode 
not only caused the tunneling cost, but also caused the packet 
loss cost. The packet loss cost between the CN and the MN is 
, , ,
( )
CN LMA LMA P MAG P MAG MN
C C C
 
   . The packet loss cost 
can be expressed as follows. 
6
2 ,
( 2 )F PMIPv
loss L P MAG N MAG
C T T
 
  
 
, , ,
( )
CN LMA LMA P MAG P MAG MN
C C C
 
   
.   (8) 
The tunnel transmission cost between the CN and the MN is 
, , , ,
( )
CN LMA LMA P MAG P MAG N MAG N MAG MN
C C C C
   
    . The 
tunneling cost can be expressed as follows. 
6
, ,
(2 )F PMIPv
tunnel N MAG LMA MN N MAG
C T T
 
  
 
, , , ,
( )
CN LMA LMA P MAG P MAG N MAG N MAG MN
C C C C
   
    
. (9) 
5 Numerical results 
This section presents the numerical results based on the 
analytical models developed in the last section. Assume that 
the total wire-line delay 
, ,X Y X Y w
T d L  and the wireless 
delay 
, ,MN P MAG MN N MAG wl
T T L
 
  , where 
w
L  and 
wl
L  are the 
wire-line and the wireless link delay and 
,X Y
d  is the number 
of hops between the node X and Y. The node X and Y can be 
the P-MAG, the N-MAG, the LMA, or the CN. Based on [12], 
we set 200 bytes,
d
S  96 bytes,
c
S  10 ,
wl
L ms
 
2 ,
w
L ms
 
2
50 ,
L
T ms 12,
LMA
PC  and
 
8
P MAG N MAG
PC PC
 
   In 
addition, we set 
, , ,
: : :1:1
P MAG N MAG P MAG LMA N MAG LMA
d d d v
   
 , 
where the variable v  expresses the ratio of the distance 
,P MAG N MAG
d
   and ,MAG LMAd . When v is larger than 1, the N-
MAG connects to the P-MAG through the core network. On 
the contrary, the N-MAG and the P-MAG communicate 
directly to each other. 
100
110
120
130
140
150
160
170
180
190
200
0.5 0.75 1 1.25 1.5 1.75 2
H
an
d
o
v
er
 L
at
en
cy
 (
m
s)
ν
HF-PMIPv6
F-PMIPv6
 
Figure 6: Impact of variable v on handover latency 
Figure 6 demonstrates the impact of the variable v on the 
handover latency. Since HF-PMIPv6 does not establish the 
tunnel between the P-MAG and the N-MAG, thus the v value 
does not affect the handover latency. F-PMIPv6 transmits two 
messages (i.e., one HI and one HAck messages) to set up the 
tunnel, and thus the handover latency of F-PMIPv6 is higher 
than that of HF-PMIPv6. 
Handling the Backhaul Link Failure for IEEE 802.16m Femto ABSs 
 
Yu-Chan Lin, Whai-En Chen*, Meng-Hsuan Lin 
Institute of Computer Science and Information Engineering 
National Ilan University I-Lan, Taiwan, R.O.C 
e-mail: wechen@niu.edu.tw 
  
Abstract—A Femto Advanced Base Station (ABS) is a low-
power base station and used to extend Worldwide 
Interoperability for Microwave Access (WiMAX) coverage to 
the indoor areas. The Femto ABS utilizes broadband 
connection (e.g., cable or DSL) as its backhaul link to 
connect to the mobile operator’s network and Internet. 
However, the broadband connection is less reliable than the 
dedicate line. In other words, the Femto ABS has more 
backhaul failure probability than the Macro ABS which uses 
the dedicate line. In order to reduce the impact of backhaul 
link failure, this paper proposes two mechanisms to handle 
the backhaul link failure based on different interfaces 
defined in IEEE 802.16m. This paper then compares these 
mechanisms in terms of the additional interface 
requirement, the notification method, the authentication/key 
exchange and the re-registration requirement. This paper 
also develops an analytic model to study the disruption time 
and packet loss of the proposed mechanisms. 
Keywords-WiMAX; IEEE802.16m;  Femto;  
I.  INTRODUCTION 
D
SL
 / 
ca
bl
e
D
SL
 / 
ca
bl
e
DSL / cable
DSL / cable
 
Figure 1.  The Network Architecture of the Femto ABS Deployment 
IEEE 802.16 referred to as Worldwide Interoperability 
for Microwave Access (WiMAX) system is approved as an 
International Mobile Telecommunications Advanced 
(IMT-Advanced) Technology [1]. However, high 
frequency deployment of WiMAX systems causes the 
poor indoor coverage [2]. A Femto Advanced Base Station 
(ABS) is a low-power base station and used to extend 
WiMAX coverage to the indoor areas. 
Figure 1 shows the network architecture of the Femto 
ABS deployment. The Advanced Mobile Station (AMS) 
connects to the Femto ABS through the R1 interface. The 
Femto ABSs are typically deployed within the coverage of 
a Macro ABS and installed at home or in the Small 
Office/Home Office (SOHO) environments. The Femto 
ABS operates in the licensed spectrum and may use the 
same frequency as the overlaid Macro ABS. The Femto 
ABS utilizes the broadband connection (e.g., cable or 
DSL) as its backhaul link and connects to the mobile 
operator’s network through Internet. Based on IEEE 
802.16m [3], the Femto ABS communicates with the 
Macro ABS either through its broadband connection (i.e., 
Internet) or through the R8 wireless interface.  
The cost of a broadband connection is cheaper than 
that of a dedicate line. However, the dedicate line is more 
reliable than the broadband connection. In other words, the 
Femto ABS has more backhaul failure probability than the 
Macro ABS. The AMS cannot access Internet or the 
operator’s network when the Femto ABS’s backhaul link 
is failure. However, the AMS attached to the failure Femto 
ABS does not aware the backhaul link failure since the 
radio link is not affected by the backhaul failure. 
In order to reduce the impact of the backhaul link 
failure, the Femto ABS can inform the AMS about the 
backhaul link failure by broadcasting the AAI-SON-ADV 
messages. When the AMS receives the AAI-SON-ADV 
message, the AMS should detach from the Femto ABS and 
tries to attach to another ABS (e.g., the Macro ABS) by 
itself. On the other hand, the Femto ABS can perform 
handover (HO) procedure instead of entire network entry 
procedure to reduce delay if there is the R8 interface 
between the Femto ABS and the Macro ABS. In this case, 
the Femto ABS exchanges HO information with the Macro 
ABS by using the HO-REQ and the HO-RSP messages 
through the R8 interface. Then the Femto ABS unicasts 
the AAI-HO-CMD messages to inform all AMSs which 
attach to the failure Femto ABS to perform HO procedure. 
IEEE 802.16m specifies the interface and the message 
format, but does not specify the detail mechanisms to 
handle the backhaul link failure. This paper focuses on the 
radio access network and proposes two mechanisms to 
handle the backhaul link failure based on different 
interfaces. The rest of this paper is organized as follows. 
We elaborate the detail message flows of the proposed 
mechanisms where the Femto ABS communicates with the 
overlaid Macro ABS through the backhaul link only or 
both the backhaul link and the air interface R8 in sections 
II and III respectively. In section IV, we compare these 
two mechanisms in terms of additional interface, 
notification method, contention ranging, authentication / 
key exchange and re-registration. We conduct an analytic 
model to evaluate the performance and evaluate the 
numerical results in section V. The conclusion and future 
work are given in in the last section. 
2011 International Conference on Parallel Processing Workshops
1530-2016/11 $26.00 © 2011 IEEE
DOI 10.1109/ICPPW.2011.21
11008
capabilities requested by the AMS. If yes, the Macro 
ABS then replies an AAI-SBC-RSP message that 
contains the capability parameters supported by the 
Macro ABS. 
Step 11. After the basic capability negotiation, the AMS 
performs the authentication procedure with the 
authentication server in the mobile operator’s core 
network. This paper utilizes Extensible 
Authentication Protocol (EAP) and Message Digest 
Algorithm 5 (MD-5) as an example. The AMS first 
sends an EAPOL-start message to initialize the 
authentication procedure. 
Steps 12-13. The Macro ABS sends an EAP-Request 
message to get the AMS’s identity. The AMS replies 
its identity through an EAP-Response message. 
Steps 14-16. Upon receipt of the AMS’s identity, the 
Macro ABS uses this identity to retrieve the 
password from the authentication server, and 
challenges the AMS by using an EAP-Request 
message. Based on the information retrieved from the 
EAP-Request message, the AMS utilizes MD5 to 
generate the hashed password and then responses the 
hashed password to the Macro ABS through an EAP-
Response message. The Macro ABS verifies that the 
response is valid and replies an EAP-success 
message to the AMS. 
Steps 17-19. After the authentication procedure, the Macro 
ABS initializes a three-way handshake key 
agreement procedure. In the key agreement 
procedure, the Macro ABS and the AMS exchange 
the AAI-PKM-RSP and the AAI-PKM-REQ 
messages to derive the Traffic Encryption Key 
(TEK). After the key agreement procedure, all 
message transmitted between the Macro ABS and the 
AMS are protected by using the TEK. 
Step 20. The AMS uses an AAI-REG-REQ message to 
register into the network. The AAI-REG-REQ 
message contains the AMS’s MAC address and the 
convergence Sublayer type (e.g., IPv4 or IPv6). 
Step 21. Upon receipt of the AAI-REG-REQ message, 
the Macro ABS replies an AAI-REG-RSP message 
that contains the assigned STID and the related 
parameters. After this step, the AMS uses the STID 
instead of the TSTID to communicate with the Macro 
ABS. 
After Step 21, the AMS moves out from the failure 
Femto ABS, attaches to the Macro ABS, and starts its 
communication. 
III. MECHANISM 2: USING HO PROCEDURE 
In this section, we introduce the case where the Femto 
ABS has the R8 interface. With the R8 interface, the 
Femto ABS exchanges HO information with the Macro 
ABS and initializes the HO procedure to transfer the 
AMSs to the Macro ABS. Figure 3 shows the message 
flow where the Femto ABS unicasts the AAI-HO-CMD 
message to perform the HO procedure. The steps are 
elaborated as follows. 
 
Figure 3.  The Femto ABS unicasts AAI-HO-CMD 
 
Step 1. The Femto ABS detects the backhaul link failure 
and starts to perform the HO procedure. 
Step 2. The Femto ABS sends an HO-REQ message to 
notify the Macro ABS with the AMS’s information 
through the R8 air interface. The information 
contains Anchor Access Service Network (ASN) 
gateway ID, Authenticator ID, Anchor Mobility 
Management (MM) Context, Security Association 
(SA) Descriptor and Service Flow Information. 
Step 3. The Macro ABS obtains the AMS’s information 
from the HO-REQ message. The Macro ABS then 
registers to the core network by using the information 
retrieved from the HO-REQ message [4]. If the 
Macro ABS successfully registers to the core 
network, then it replies an HO-RSP message that 
contains the Macro ABS’s information to the Femto 
ABS. The Macro ABS’s information includes a 
Temporary Station ID (TSTID), a Cipher-based 
Message Authentication Code (CMAC), a dedicated 
ranging code and a dedicated ranging opportunity. 
The CMAC is used to protect the AAI-RNG-REQ 
message transmitted by the AMS. 
Step 4. Upon receipt of the HO-RSP message, the Femto 
ABS sends an AAI-HO-CMD message to command 
the AMS to perform handover to the Macro ABS. 
The AAI-HO-CMD message contains a target BSID 
(i.e., the Macro ABS’s BSID), the ranging code, the 
ranging opportunity and the TSTID. The ranging 
code, the ranging opportunity and the TSTID are 
retrieved from the HO-RSP message. 
Step 5. The AMS scans the Macro ABS’s DL channels 
according to the target BSID (i.e., the Macro ABS’s 
BSID) carried in the AAI-HO-CMD message. Then 
the AMS tries to establish the DL synchronization 
with the Macro ABS. 
 
1120
AMS through the AAI-HO-CMD message. Therefore, 
the mechanism 2 does not require performing the 
authentication and key exchange procedures again after 
the AMS performs HO procedure. In the mechanism 1, 
the AMSs coming from the Femto ABS acts as newly 
attached AMSs. The Macro ABS will request these AMSs 
to authenticate and exchange the security keys. 
e) Re-registration 
Like authentication and key exchange, in the 
mechanism 1, the AMSs moving from the Femto ABS to 
the Macro ABS should perform the registration procedure 
to core network. After registration, the core network 
assigns new resources to the AMS through the Macro 
ABS and terminates the resources allocated between the 
core network and the Femto ABS. In the mechanism 2, 
the core network switches the reserved resources from the 
Femto ABS to the Macro ABS after the HO procedure. 
V. ANALYTIC MODEL 
In this sub-section, we evaluate the performance of the 
proposed mechanisms in terms of the disruption time and 
packet loss. We define the following parameters for the 
performance analysis. ,x yT  represents the transmission 
delay between nodes x and y. The x and y can be AMS, 
Femto ABS or Macro ABS. Note that ,Femto MacroT  is the 
transmission delay between the Femto ABS and the Macro 
ABS through the R8 interface. λ  is the packet arrival rate 
in unit of packet per second. mscan synT +  represents the latency 
of the DL channel scan and the DL synchronization, where 
m is 1 or 2 and represents the mechanism 1 or 2. The 
disruption time mD  and the total packet loss mP  are 
derived as follows. 
A. Disruption Time 
The disruption time mD  is calculated from the 
backhaul link failure to the registration procedure 
complete. In Figure 2, the disruption time of the 
mechanism 1 includes the transmission delay of notifying 
the backhaul failure ( ,AMS FemtoT ), the latency of processing 
DL channel scan and synchronization ( 1scan synT + ), and the 
latency of performing, the ranging procedure 
( ,3 AMS MacroT ), the capability negotiation procedure 
( ,2 AMS MacroT ), the authentication procedure ( ,6 AMS MacroT ), 
the key exchange procedure ( ,2 AMS MacroT ) and the 
registration procedure ( ,2 AMS MacroT ). Note that the Steps 5 
and 6 of ranging procedure and Steps 16 and 17 of 
authentication and key exchange procedure are transmitted 
at the same time. Therefore, only Step 5 and Step 16 are 
counted into the transmission delay. 1D  can be expressed 
as the follows: 
 
 
1
1 , , ,
, , ,
3 2
       6 2 2
AMS Femto scan syn AMS Macro AMS Macro
AMS Macro AMS Macro AMS Macro
D T T T T
T T T
+= + + +
+ + +
      
1
, ,= 15AMS Femto scan syn AMS MacroT T T++ +  (1) 
The disruption time of the mechanism 2 shown in 
Figure 3 includes the transmission delay of notifying the 
backhaul failure ( ,AMS FemtoT ), the latency of processing 
DL channel scan and synchronization ( 2scan synT + ), the 
latency of exchanging the HO-REQ and HO-RSP 
messages ( ,2 Femto MacroT ) and the latency of performing 
ranging procedure ( ,3 AMS MacroT ).Not that Steps 6 and 7 of 
ranging procedure and Steps 8 and 9 of ranging procedure 
are transmitted at the same time. Therefore, only Step 6 
and Step 8 are counted into the transmission delay. 2D  
can be expressed as the follows: 
 
2
2 , , ,2 3AMS Femto scan syn Femto Macro AMS MacroD T T T T+= + + +  (2) 
B. Packet Loss 
The AMS cannot receive packets during the disruption 
time. The packet loss is conducted by multiplying with the 
packet arrival rate the disruption time. The packet loss of 
the mechanisms 1 and 2 can be expressed as the follows: 
1 1*P Dλ=  
 
1
, ,* ( 15 )scan syn AMS Femto AMS MacroT T Tλ += + +  (3) 
2 2*P Dλ=  
 
2
, , ,* ( 2 3 )scan syn AMS Femto Femto Macro AMS MacroT T T Tλ += + + +  
 (4) 
C. Numerical Results 
This section presents the numerical results generated 
from the analytical model. According to [4-5], we set 
1
scan synT +  to 75 ms, 
2
scan synT +  to 10 ms and the maximum 
wireless link delay to 10ms. The wireless link delay and 
the packet arrival rate are considered as the input variables. 
Since all messages transmitted among the AMS, the Femto 
ABS and the Macro ABS are over the wireless link. We 
assume the value of ,AMS FemtoT  , ,AMS MacroT  and 
,Femto MacroT  are the same. Based on the transmission rate 
specified in 802.16m [7], the value of variable λ  is 
ranging from 0 to 20000 packets per second. 
Since this paper focuses on the procedures of the radio 
access network, the procedures of the core network are out 
of scope of the paper and could be further studied. All 
messages proposed in the mechanisms 1 and 2 are 
exchanged over the wireless link, and thus the wireless 
link delay dominates the disruption time. Figure 4 shows 
the impact of the wireless link delay on the disruption time. 
We observe that the mechanism 2 has less disruption time 
than the mechanism 1 since the AMS performs the 
1142
IPv6 VoIP Deployment on Taiwan Academic Network (TANet) 
 
Whai-En Chen 
Institute of Computer Science and Information Engineering 
National Ilan University 
I-Lan, Taiwan, R.O.C 
e-mail: wechen@niu.edu.tw 
Tzu-Hsuan Wu 
Institute of Computer Science and Information Engineering 
National Ilan University 
I-Lan, Taiwan, R.O.C 
e-mail: r9843004@ms.niu.edu.tw 
 
 
Abstract—We deploy a large-scale trial for Voice over IP (VoIP) 
by using Internet Protocol version 6 (IPv6) on Taiwan 
Academic Network (referred to as TANet). To reduce the 
overhead of the inter-connection among the schools using 
TANet, the computer center of Ministry of Education (MoE) 
establishes a VoIP exchange center referred to as TANet VoIP 
Platform and assign National Ilan University (NIU) to operate 
this platform. In this paper, we introduce the architecture of 
TANet VoIP Platform and the numbering plan. We introduce 
two solutions to solve the problem that a new deployed IPv6 
phone cannot communicate with an IPv4 phone. Specifically, 
we present the modifications of the IPv6 phones and SIP 
servers, and show three message flow examples that cover all 
VoIP call scenarios in TANet VoIP Platform. 
Keywords- ENUM, IPv6, Translation, SIP, VoIP 
I.  INTRODUCTION 
In the past few years, with the growth of bandwidth and 
stability of Taiwan Academic Network (referred to as 
TANet), various Internet services are deployed in the schools 
using TANet. Voice over IP (VoIP), one of the most 
important services, changes the communication ways from 
delay-able text (e.g., Email) to real-time communication. 
Based on successful deployment of VoIP, teachers and 
students not only reduce the communication cost but also 
develop various VoIP applications. For example, in Tainan 
County, by integrating the VoIP services, some teachers 
request the students to upload their language-learning 
homework to the voicemail systems, and the teachers will 
receive email notice and then check these voice files. 
Ministry of Education
(MoE) Offices
TANet VoIP Platform
IPOX
(070)
International VoIP 
Exchange Centers
County Network 
Centers
Elementary
Schools
Junior and Senior
High Schools
Regional Network 
Centers
Colleges/Universities
SIP Proxy ENUM Server
 
Figure 1.  The architecture of TANet VoIP Platform. 
There are about 4000 schools including elementary 
schools, high schools, colleges and universities connecting to 
TANet. In order to reduce the overhead of the inter-
connection among these schools, the computer center of 
Ministry of Education (MoE) establishes a VoIP exchange 
center referred to as TANet VoIP Platform. Each school only 
needs to connect to TANet VoIP Platform and then reaches 
all schools that connect to this platform. Therefore, the 
school can reduce huge inter-connection overhead. The 
architecture of TANet VoIP Platform is shown in Fig. 1. 
TANet VoIP Platform exchanges VoIP routes with 
county network centers (CNCs), regional network centers 
(RCs), MoE offices and other VoIP centers such as 
international VoIP exchange centers and IPOX (IP Phone 
Open Exchange). TANet VoIP Platform follows similar 
architecture of TANet backbone connections. A CNC 
manages the VoIP services of elementary schools and junior 
high schools in the same county or city, and there are total 25 
CNCs in TANet. An RC manages the colleges and 
universities within the same area (e.g., Ilan area and Chu-
Miao area), where Chu-Miao area includes Hsinchu and 
Miaoli counties. There are total 13 RCs in TANet. Senior 
high schools usually connect to CNCs, but some of them 
may connect to RCs due to the distance issue. 
TABLE I.  THE NUMBERING PLAN FOR TANET VOIP PLATFORM 
Manager Prefix-1 Prefix-2 Manager Prefix-1 Prefix-2 
Taipei County 901 951 Tainan City 921 971 
Yilan County 902 952 Taipei City 922 972 
Taoyuan County 903 953 Kaohsiung City 923 973 
Hsinchu County 904 954 Kinmen County 924 974 
Miaoli County 905 955 Lianjiang County 925 975 
Taichung County 906 956 Taipei RC (I) 926 976 
Changhua County 907 957 Taipei RC (II) 927 977 
Nantou County 908 958 Taoyuan RC 928 978 
Yunlin County 909 959 Chu-Miao RC 929 979 
Chiayi County 910 960 Hsinchu RC 930 980 
Tainan County 911 961 Taichung RC 931 981 
Kaohsiung County 912 962 Yun-Chi RC 932 982 
Pingtung County 913 963 Tainan RC 933 983 
Taitung County 914 964 Kao-Ping-Peng RC 934 984 
Hualien County 915 965 Eastern RC 936 986 
Penghu County 916 966 Taitung RC 937 987 
Keelung city 917 967 Ilan RC 942 992 
Hsinchu City 918 968 Nantou RC 943 993 
Taichung city 919 969 Loxa Education NET 988 N/A 
Chiayi City 920 970 MOE 900 N/A 
 
 
the called party. Otherwise, the SIP server will send 302 
Moved Temporarily to the calling party to redirect the 
INVITE message to the correct version. If the called party 
does not register to this SIP server, the SIP server will 
forward the INVITE message based on the pre-configured 
route. Note that the SIP server performs IPv6-IPv4 
translation when the IP version of the route is different from 
that of the INVITE message. 
IPv6-IPv4 translation includes SIP message and Real-
time Transport Protocol (RTP) [2] packet translations. There 
are two mechanisms to translate SIP messages. The 
mechanisms are Back-to-Back User Agent (B2BUA) and SIP 
message modification. In the first mechanism, the SIP server 
plays a role as a B2BUA. That is the SIP server acts as a 
User Agent Server (UAS) to receive the INVITE message 
and acts as a User Agent Client (UAC) to send the INVITE 
message by using different IP version. For the SIP message 
modification mechanism, the SIP server revises the SIP 
header fields (e.g., Via, Contact and Request URI) and 
Session Description Protocol (SDP) [3] fields c and m. 
Take an IPv4-to-IPv6 RTP translation for instance, based 
on a mapping table, RTP packets are translated by an RTP 
proxy [9], which receives IPv4 RTP packet from the source, 
translates the packet to IPv6 and then sends IPv6 RTP packet 
to the destination and vice versa. The mapping table is 
established by the SIP server. The SIP server retrieves the IP 
information of the calling and called parties from the SDP c 
and m fields of INVITE and 200 OK messages. Then the 
SIP server maps the IP information of the calling party to 
that of the called party and stores them into the mapping 
table. 
With the above modifications, the IPv6 phones can 
correctly communicate with the phone that only supports 
IPv4. In the next section, we demonstrate the call examples 
in TANet VoIP platform. 
III. VOIP CALL EXAMPLES 
There are four VoIP communication scenarios such as 
IPv4-to-IPv4, IPv6-to-IPv6, IPv4-to-IPv6 and IPv6-to-IPv4 
in TANet VoIP platform. For the former three scenarios, the 
SIP server forwards the SIP messages without translation. 
On the contrary, the last scenario requires IPv6-IPv4 
translation. If the IPv6 and IPv4 phones register to the same 
SIP server, the SIP server has the IP information of both 
phones and can use redirect mechanism instead of IPv6-IPv4 
translation. Otherwise, since the SIP server does not have IP 
information of both phones, the SIP server can only forward 
and/or translate the SIP message according to the pre-defined 
route. In this section, we use three examples to demonstrate 
the scenarios. The examples are 1. An IPv6 phone calls 
another IPv6 phone; 2. An IPv6 phone calls an IPv4 phone 
that resides in the same SIP server; 3. An IPv6 phone calls an 
IPv4 phone that resides in the different SIP server. 
Fig. 3 shows the message flow where an IPv6 phone 
(Phone-1) communicates with another IPv6 phone (Phone-2). 
Assume that Phone-1 and Phone-2 have registered their IP 
information to the SIP server. The procedures are described 
as follows. 
Phone-1
(IPv6)
SIP Server
Phone-2
(IPv6)
1. IPv6 INVITE
2. IPv6 180 Ringing
3. IPv6 200 OK
4. IPv6 ACK
5. IPv6 RTP
1. IPv6 INVITE
2. IPv6 180 Ringing
3. IPv6 200 OK
4. IPv6 ACK
 
Figure 3.  An IPv6 Phone communicates with another IPv6 Phone. 
Step 1. Phone-1 sends an IPv6 INVITE message to the 
called party (Phone-2) through the SIP server. Upon 
receipt of this message, the SIP server retrieves the IP 
information of Phone-2 by using the Request URI of 
the INVITE message and then forwards the message 
to Phone-2 based on the IP information retrieved from 
its database (i.e., IPv6 table). 
Step 2. Upon receipt of the INVITE message, Phone-2 plays 
the ringing tone and replies a 180 Ringing message to 
Phone-1. The 180 Ringing message is sent to Phone-
1 based on the Via field copied from the INVITE 
message. Upon receipt of the 180 Ringing message, 
Phone-1 plays the ring-back tone to the user. 
Step 3. When the user of Phone-2 accetps the call, Phone-2 
reponses a 200 OK message. The 200 OK message 
follows the same path as the 180 Ringing message to 
Phone-1. 
Step 4. Upon receipt of the 200 OK message, Phone-1 
replies an ACK message and starts to send the RTP 
packets to Phone-2. 
Step 5. After Phone-2 receives the ACK message, it starts to 
send RTP packets to Phone-1. At this point, the RTP 
sessions between Phone-1 and Phone-2 are 
established. 
Note that an IPv4 phone will follow the same procedure 
to call another IPv4 phone except using IPv4 instead of IPv6 
for all messages. Similarly, an IPv4 phone also uses the same 
procedures to communicate with an IPv6 phone by using 
IPv4 messages. 
Assume that an IPv6 phone (Phone-1) and an IPv4 phone 
(Phone-2) register their IP information to the same SIP 
server. Phone-1 registers IPv6 and IPv4 information, and 
Phone-2 registers IPv4 information to the SIP Server. The 
message flow that Phone-1 calls Phone-2 is shown in Fig. 4 
and described as follows. 
Step 1. Phone-1 first sends an IPv6 INVITE message to the 
called party (Phone-2) through the SIP server. At this 
point, Phone-1 does not know that Phone-2 supports 
IPv4 or IPv6. 
 
 
IV. CONCLUSIONS 
This paper presents a large-scale VoIP deployment by 
using the next-generation Internet protocol IPv6 on TANet. 
To reduce of the inter-connection overhead among the 
schools, the computer center of Ministry of Education (MoE) 
establishes a VoIP exchange center referred to as TANet 
VoIP Platform. In this paper, we introduce the architecture of 
TANet VoIP Platform and the numbering plan. Moreover, 
this paper introduces the modifications to the IPv6 phones 
and SIP servers for solving the problem that a new deployed 
IPv6 phone cannot communicate with an IPv4 phone. Finally, 
this paper gives three message flow examples that cover all 
IPv4-IPv6 VoIP call scenarios in TANet VoIP Platform. The 
results can be easily applied to other VoIP platforms. 
ACKNOWLEDGMENT 
This study was sponsored by NSC 99-2628-E-197-001, 
the computer center of Ministry of Education and “Wireless 
Broadband Communications Technology and Application 
Project” of the Institute for Information Industry which is 
subsidized by the Ministry of Economy Affairs of the 
Republic of China. 
We also like to thank the engineers in the computer 
center of Ministry of Education and Mr. Ming-Hsin Tsai for 
their technical support. 
 
REFERENCES 
[1] J. Rosenberg, H. Schulzrinne, G. Camarillo, A. Johnston, J. 
Peterson, R. Sparks, M. Handley, and E. Schooler, “SIP: 
Session Initiation Protocol,” RFC 3261, IETF, June 2002. 
[2] H. Schulzrinne, S. Casner, R. Frederick, and V. Jacobson, 
“RTP: A Transport Protocol for Real-Time Applications,” 
RFC 3550, IETF, July 2003. 
[3] M. Handley, V. Jacobson, C. Perkins, “SDP: Session 
Description Protocol,” RFC 4566, IETF, July 2006. 
[4] D. Sisalem, J. Fiedler, and R. Ruppelt, “SIP and IPv6: Why 
and How,” SAINT2003, Orlando (Florida, USA), pages 27-31, 
January 2003. 
[5] M.-K. Shin, Y.-G. Hong, J. Hagino, P. Savola, and E. M. 
Castro, “Application Aspects of IPv6 Transition,” RFC 4038, 
IETF, March 2005. 
[6] E. M. Castro, T. Miguel, and S. Pavon, “Transition of 
Applications to IPv6,” Upgrade Journal, 6(2):15-18, April 
2005. 
[7] W.-E. Chen, Y.-B. Lin and A.-C. Pang, “An IPv4-IPv6 
Translation Mechanism for SIP Overlay Network in UMTS 
All-IP Environment,” IEEE Journal of Selected Areas in 
Communications (J-SAC), 23(11): 2152-2160, Nov. 2005. 
[8] W.-E. Chen, Q. Wu, and Y.-B. Lin, “Design of SIP 
Application Level Gateway for IPv6 Translation,” Journal of 
Internet Technology (JIT) Special Issue on IPv6, 5(2), 2004. 
[9] “RTPProxy- RTP (Real-time Transport Protocol) Proxy 
Server,” http://ftp.iptel.org/pub/rtpproxy/. 
[10] S. Deering, R. Hinden, “Internet Protocol, Version 6 (IPv6) 
Specification,” RFC2460, December 1998. 
 
2 
 
March 22, 2011 
 
MR-1 MR-2 MR-3 MR-4 MR-5 MR-6 MR-7 
10:30-11:00 Networking Break 
11:00-12:30 DMWPC CCS PAEWN  QuEST WAMIS-1  HWISE 
 
12:30-14:00 Lunch 
14:00-15:30 MAW-1  iSeRIM-1 TeNAS-1  PAMS-1 WAMIS-2  BLSMC-1  SMPE-1 
15:30-16:00 Networking Break 
16:00-17:30 MAW-2  iSeRIM-2 TeNAS-2  PAMS-2 WAMIS-3  BLSMC-2  SMPE-2 
 
與會心得 
 
IEEE 國際研討會 The International Conference on Advanced Information 
Networking and Applications ( 簡稱 IEEE AINA-2011)會議於 3月 22 日至 25 日
在新加坡舉行。由於台灣直飛新加坡的航班天天都有，因此本次可以完整的參
與研討會亦不會為了安排行程而多花上住宿及膳食費用。 
IEEE AINA是大型的 IEEE國際會議，至今已經舉辦 25 屆，主要發表先進資訊
網路與應用領域的設計與應用。除了論文發表與專題演講外，此次與 ACM 合
作舉辦 17 個專題討論會 (Workshop)，與會人員來自學術界、工業界和政府單
位。 
會議在新加坡 Biopolis St. 的Matrix Building (4th floor)舉辦，該區域(Biopolis 
St.)內的大樓都是近幾年新建的，會議場所的軟硬體設施相當不錯。 
 
 
 
 
 
 
 
 
 
 
 
   
4 
 
International Conference On Advanced Infocomm Technology 2011
出國心得報告 
100年 07月 14日 
姓名 林孟玄 
會議正式名稱 
International Conference On Advanced Infocomm 
Technology (ICAIT) 2011 
會議時間 2011年 7月 11-14日 
會議地點 中國武漢 
報告形式 Oral 
會議議程 
Programme At-A-Glance 
Tuesday, 12th July 2011 
09.00—09.30 Opening Ceremony (Room A101) 
09.30—10.10 Keynote Speaker 
Moshe Zukerman - City University of Hong Kong 
A Green Light for Internet Traffic 
10.10—10.50 Morning Tea Break 
10.50—11.20 Keynote Speaker 
Zhang Chengliang - Beijing Research Institute of China Telecom 
100G WDM Communication System and Beyond Technologies 
11.30—14.00 Lunch Session 
14.00—15.30 Session 1-1 
15.30—16.00 Afternoon Tea Break 
16.00—17.30 Session 1-2 
Wednesday, 13th July 2011 
09.00—10.25 Session 2-1 
& YOFC Workshop (Room A101) 
10.25—11.00 Morning Tea Break 
11.00—12.25 Session 2-2 
12.25—14.00 Lunch Session 
14.00—15.25 Session 2-3 
15.25—16.00 Afternoon Tea Break 
16.00—17.25 Session 2-4 
19.00— 21.00 Conference Banquet 
Thursday, 14th July 2011 
09.00—10.25 Session 3-1 
10.25—10.45 Morning Tea Break 
10.45, 14th July — 18.00, 16th July Post Conference Workshop 
 
  
IPv6 VoIP Deployment on Taiwan Academic Network (TANet) 
 
Whai-En Chen 
Institute of Computer Science and Information Engineering 
National Ilan University 
I-Lan, Taiwan, R.O.C 
e-mail: wechen@niu.edu.tw 
Tzu-Hsuan Wu 
Institute of Computer Science and Information Engineering 
National Ilan University 
I-Lan, Taiwan, R.O.C 
e-mail: r9843004@ms.niu.edu.tw 
 
 
Abstract—We deploy a large-scale trial for Voice over IP (VoIP) 
by using Internet Protocol version 6 (IPv6) on Taiwan 
Academic Network (referred to as TANet). To reduce the 
overhead of the inter-connection among the schools using 
TANet, the computer center of Ministry of Education (MoE) 
establishes a VoIP exchange center referred to as TANet VoIP 
Platform and assign National Ilan University (NIU) to operate 
this platform. In this paper, we introduce the architecture of 
TANet VoIP Platform and the numbering plan. We introduce 
two solutions to solve the problem that a new deployed IPv6 
phone cannot communicate with an IPv4 phone. Specifically, 
we present the modifications of the IPv6 phones and SIP 
servers, and show three message flow examples that cover all 
VoIP call scenarios in TANet VoIP Platform. 
Keywords- ENUM, IPv6, Translation, SIP, VoIP 
I.  INTRODUCTION 
In the past few years, with the growth of bandwidth and 
stability of Taiwan Academic Network (referred to as 
TANet), various Internet services are deployed in the schools 
using TANet. Voice over IP (VoIP), one of the most 
important services, changes the communication ways from 
delay-able text (e.g., Email) to real-time communication. 
Based on successful deployment of VoIP, teachers and 
students not only reduce the communication cost but also 
develop various VoIP applications. For example, in Tainan 
County, by integrating the VoIP services, some teachers 
request the students to upload their language-learning 
homework to the voicemail systems, and the teachers will 
receive email notice and then check these voice files. 
Ministry of Education
(MoE) Offices
TANet VoIP Platform
IPOX
(070)
International VoIP 
Exchange Centers
County Network 
Centers
Elementary
Schools
Junior and Senior
High Schools
Regional Network 
Centers
Colleges/Universities
SIP Proxy ENUM Server
 
Figure 1.  The architecture of TANet VoIP Platform. 
There are about 4000 schools including elementary 
schools, high schools, colleges and universities connecting to 
TANet. In order to reduce the overhead of the inter-
connection among these schools, the computer center of 
Ministry of Education (MoE) establishes a VoIP exchange 
center referred to as TANet VoIP Platform. Each school only 
needs to connect to TANet VoIP Platform and then reaches 
all schools that connect to this platform. Therefore, the 
school can reduce huge inter-connection overhead. The 
architecture of TANet VoIP Platform is shown in Fig. 1. 
TANet VoIP Platform exchanges VoIP routes with 
county network centers (CNCs), regional network centers 
(RCs), MoE offices and other VoIP centers such as 
international VoIP exchange centers and IPOX (IP Phone 
Open Exchange). TANet VoIP Platform follows similar 
architecture of TANet backbone connections. A CNC 
manages the VoIP services of elementary schools and junior 
high schools in the same county or city, and there are total 25 
CNCs in TANet. An RC manages the colleges and 
universities within the same area (e.g., Ilan area and Chu-
Miao area), where Chu-Miao area includes Hsinchu and 
Miaoli counties. There are total 13 RCs in TANet. Senior 
high schools usually connect to CNCs, but some of them 
may connect to RCs due to the distance issue. 
TABLE I.  THE NUMBERING PLAN FOR TANET VOIP PLATFORM 
Manager Prefix-1 Prefix-2 Manager Prefix-1 Prefix-2 
Taipei County 901 951 Tainan City 921 971 
Yilan County 902 952 Taipei City 922 972 
Taoyuan County 903 953 Kaohsiung City 923 973 
Hsinchu County 904 954 Kinmen County 924 974 
Miaoli County 905 955 Lianjiang County 925 975 
Taichung County 906 956 Taipei RC (I) 926 976 
Changhua County 907 957 Taipei RC (II) 927 977 
Nantou County 908 958 Taoyuan RC 928 978 
Yunlin County 909 959 Chu-Miao RC 929 979 
Chiayi County 910 960 Hsinchu RC 930 980 
Tainan County 911 961 Taichung RC 931 981 
Kaohsiung County 912 962 Yun-Chi RC 932 982 
Pingtung County 913 963 Tainan RC 933 983 
Taitung County 914 964 Kao-Ping-Peng RC 934 984 
Hualien County 915 965 Eastern RC 936 986 
Penghu County 916 966 Taitung RC 937 987 
Keelung city 917 967 Ilan RC 942 992 
Hsinchu City 918 968 Nantou RC 943 993 
Taichung city 919 969 Loxa Education NET 988 N/A 
Chiayi City 920 970 MOE 900 N/A 
 
 
the called party. Otherwise, the SIP server will send 302 
Moved Temporarily to the calling party to redirect the 
INVITE message to the correct version. If the called party 
does not register to this SIP server, the SIP server will 
forward the INVITE message based on the pre-configured 
route. Note that the SIP server performs IPv6-IPv4 
translation when the IP version of the route is different from 
that of the INVITE message. 
IPv6-IPv4 translation includes SIP message and Real-
time Transport Protocol (RTP) [2] packet translations. There 
are two mechanisms to translate SIP messages. The 
mechanisms are Back-to-Back User Agent (B2BUA) and SIP 
message modification. In the first mechanism, the SIP server 
plays a role as a B2BUA. That is the SIP server acts as a 
User Agent Server (UAS) to receive the INVITE message 
and acts as a User Agent Client (UAC) to send the INVITE 
message by using different IP version. For the SIP message 
modification mechanism, the SIP server revises the SIP 
header fields (e.g., Via, Contact and Request URI) and 
Session Description Protocol (SDP) [3] fields c and m. 
Take an IPv4-to-IPv6 RTP translation for instance, based 
on a mapping table, RTP packets are translated by an RTP 
proxy [9], which receives IPv4 RTP packet from the source, 
translates the packet to IPv6 and then sends IPv6 RTP packet 
to the destination and vice versa. The mapping table is 
established by the SIP server. The SIP server retrieves the IP 
information of the calling and called parties from the SDP c 
and m fields of INVITE and 200 OK messages. Then the 
SIP server maps the IP information of the calling party to 
that of the called party and stores them into the mapping 
table. 
With the above modifications, the IPv6 phones can 
correctly communicate with the phone that only supports 
IPv4. In the next section, we demonstrate the call examples 
in TANet VoIP platform. 
III. VOIP CALL EXAMPLES 
There are four VoIP communication scenarios such as 
IPv4-to-IPv4, IPv6-to-IPv6, IPv4-to-IPv6 and IPv6-to-IPv4 
in TANet VoIP platform. For the former three scenarios, the 
SIP server forwards the SIP messages without translation. 
On the contrary, the last scenario requires IPv6-IPv4 
translation. If the IPv6 and IPv4 phones register to the same 
SIP server, the SIP server has the IP information of both 
phones and can use redirect mechanism instead of IPv6-IPv4 
translation. Otherwise, since the SIP server does not have IP 
information of both phones, the SIP server can only forward 
and/or translate the SIP message according to the pre-defined 
route. In this section, we use three examples to demonstrate 
the scenarios. The examples are 1. An IPv6 phone calls 
another IPv6 phone; 2. An IPv6 phone calls an IPv4 phone 
that resides in the same SIP server; 3. An IPv6 phone calls an 
IPv4 phone that resides in the different SIP server. 
Fig. 3 shows the message flow where an IPv6 phone 
(Phone-1) communicates with another IPv6 phone (Phone-2). 
Assume that Phone-1 and Phone-2 have registered their IP 
information to the SIP server. The procedures are described 
as follows. 
Phone-1
(IPv6)
SIP Server
Phone-2
(IPv6)
1. IPv6 INVITE
2. IPv6 180 Ringing
3. IPv6 200 OK
4. IPv6 ACK
5. IPv6 RTP
1. IPv6 INVITE
2. IPv6 180 Ringing
3. IPv6 200 OK
4. IPv6 ACK
 
Figure 3.  An IPv6 Phone communicates with another IPv6 Phone. 
Step 1. Phone-1 sends an IPv6 INVITE message to the 
called party (Phone-2) through the SIP server. Upon 
receipt of this message, the SIP server retrieves the IP 
information of Phone-2 by using the Request URI of 
the INVITE message and then forwards the message 
to Phone-2 based on the IP information retrieved from 
its database (i.e., IPv6 table). 
Step 2. Upon receipt of the INVITE message, Phone-2 plays 
the ringing tone and replies a 180 Ringing message to 
Phone-1. The 180 Ringing message is sent to Phone-
1 based on the Via field copied from the INVITE 
message. Upon receipt of the 180 Ringing message, 
Phone-1 plays the ring-back tone to the user. 
Step 3. When the user of Phone-2 accetps the call, Phone-2 
reponses a 200 OK message. The 200 OK message 
follows the same path as the 180 Ringing message to 
Phone-1. 
Step 4. Upon receipt of the 200 OK message, Phone-1 
replies an ACK message and starts to send the RTP 
packets to Phone-2. 
Step 5. After Phone-2 receives the ACK message, it starts to 
send RTP packets to Phone-1. At this point, the RTP 
sessions between Phone-1 and Phone-2 are 
established. 
Note that an IPv4 phone will follow the same procedure 
to call another IPv4 phone except using IPv4 instead of IPv6 
for all messages. Similarly, an IPv4 phone also uses the same 
procedures to communicate with an IPv6 phone by using 
IPv4 messages. 
Assume that an IPv6 phone (Phone-1) and an IPv4 phone 
(Phone-2) register their IP information to the same SIP 
server. Phone-1 registers IPv6 and IPv4 information, and 
Phone-2 registers IPv4 information to the SIP Server. The 
message flow that Phone-1 calls Phone-2 is shown in Fig. 4 
and described as follows. 
Step 1. Phone-1 first sends an IPv6 INVITE message to the 
called party (Phone-2) through the SIP server. At this 
point, Phone-1 does not know that Phone-2 supports 
IPv4 or IPv6. 
 
 
IV. CONCLUSIONS 
This paper presents a large-scale VoIP deployment by 
using the next-generation Internet protocol IPv6 on TANet. 
To reduce of the inter-connection overhead among the 
schools, the computer center of Ministry of Education (MoE) 
establishes a VoIP exchange center referred to as TANet 
VoIP Platform. In this paper, we introduce the architecture of 
TANet VoIP Platform and the numbering plan. Moreover, 
this paper introduces the modifications to the IPv6 phones 
and SIP servers for solving the problem that a new deployed 
IPv6 phone cannot communicate with an IPv4 phone. Finally, 
this paper gives three message flow examples that cover all 
IPv4-IPv6 VoIP call scenarios in TANet VoIP Platform. The 
results can be easily applied to other VoIP platforms. 
ACKNOWLEDGMENT 
This study was sponsored by NSC 99-2628-E-197-001, 
the computer center of Ministry of Education and “Wireless 
Broadband Communications Technology and Application 
Project” of the Institute for Information Industry which is 
subsidized by the Ministry of Economy Affairs of the 
Republic of China. 
We also like to thank the engineers in the computer 
center of Ministry of Education and Mr. Ming-Hsin Tsai for 
their technical support. 
 
REFERENCES 
[1] J. Rosenberg, H. Schulzrinne, G. Camarillo, A. Johnston, J. 
Peterson, R. Sparks, M. Handley, and E. Schooler, “SIP: 
Session Initiation Protocol,” RFC 3261, IETF, June 2002. 
[2] H. Schulzrinne, S. Casner, R. Frederick, and V. Jacobson, 
“RTP: A Transport Protocol for Real-Time Applications,” 
RFC 3550, IETF, July 2003. 
[3] M. Handley, V. Jacobson, C. Perkins, “SDP: Session 
Description Protocol,” RFC 4566, IETF, July 2006. 
[4] D. Sisalem, J. Fiedler, and R. Ruppelt, “SIP and IPv6: Why 
and How,” SAINT2003, Orlando (Florida, USA), pages 27-31, 
January 2003. 
[5] M.-K. Shin, Y.-G. Hong, J. Hagino, P. Savola, and E. M. 
Castro, “Application Aspects of IPv6 Transition,” RFC 4038, 
IETF, March 2005. 
[6] E. M. Castro, T. Miguel, and S. Pavon, “Transition of 
Applications to IPv6,” Upgrade Journal, 6(2):15-18, April 
2005. 
[7] W.-E. Chen, Y.-B. Lin and A.-C. Pang, “An IPv4-IPv6 
Translation Mechanism for SIP Overlay Network in UMTS 
All-IP Environment,” IEEE Journal of Selected Areas in 
Communications (J-SAC), 23(11): 2152-2160, Nov. 2005. 
[8] W.-E. Chen, Q. Wu, and Y.-B. Lin, “Design of SIP 
Application Level Gateway for IPv6 Translation,” Journal of 
Internet Technology (JIT) Special Issue on IPv6, 5(2), 2004. 
[9] “RTPProxy- RTP (Real-time Transport Protocol) Proxy 
Server,” http://ftp.iptel.org/pub/rtpproxy/. 
[10] S. Deering, R. Hinden, “Internet Protocol, Version 6 (IPv6) 
Specification,” RFC2460, December 1998. 
 








establishes a tunnel between the P-MAG and the N-MAG to 
prevent packet loss. If the mobility mode is reactive, HF-
PMIPv6 performs handover directly without setting up a 
tunnel to reduce the extra handover latency, the signaling cost 
and the tunnel transmission cost. 
In this paper, we introduce the message flows of PMIPv6 and 
F-PMIPv6 in section 2. In section 3, we elaborate the 
proposed mechanism and utilize an example to describe the 
message flow. We conduct the analytical models to evaluate 
the performance of F-PMIPv6 and HF-PMIPv6 in terms of 
handover latency, signaling cost and packet delivery cost in 
section 4. We evaluate the numerical results in section 5 and 
give the conclusion in the last section. 
2 Overview PMIPv6 and F-PMIPv6 
2.1 Proxy Mobile IPv6 (PMIPv6) 
When the MN changes its point of attachment from the access 
link of the serving MAG (i.e., P-MAG) to that of the target 
MAG (i.e., N-MAG), the MN performs the PMIPv6 handover 
procedure and the message flow is shown in Figure 1. The 
details of the message flow are described as follows: 
MN LMA
5. RA
(HNP)
2. PBU
(MN-ID)
3. PBA
(HNP)
4. Bi-Dir Tunnel
6. Deliver Packets
N-MAG
1. L2 Handover
(MN-ID)H
an
d
o
v
er L
aten
cy
 
Figure 1: The message flow of PMIPv6 
Step 1. An MN moves to the N-MAG’s access link and the 
N-MAG obtains the MN-ID through Layer-2 
procedure. 
Step 2. After obtaining the MN-ID, the N-MAG sends a 
Proxy Binding Update (PBU) message containing 
the MN-ID to the LMA. The PBU message is used to 
update the MN’s current location. 
Step 3. Upon receipt of the PBU message, the LMA replies a 
Proxy Binding Acknowledgement (PBA) message 
containing the MN’s Home Network Prefix (HNP) to 
the N-MAG. The LMA also updates its binding cache 
entry and sets up a tunnel to the N-MAG. 
Step 4. When the N-MAG receives the PBA message, it also 
sets up a tunnel to the LMA. At this point, the bi-
directional between the LMA and the N-MAG is 
established. 
Step 5. Then the N-MAG sends the Router Advertisement 
(RA) message to the MN containing MN’s HNP. 
Note that since the HNP is the same, the MN detects 
that the IP address is not changed in this handover 
procedure. 
Step 6. The LMA forwards the packets sent from the 
Correspondent Nodes (CNs) to the N-MAG through 
the bi-directional tunnel established in Steps 3 and 4. 
After the N-MAG receives these packets, it forwards 
these packets to the MN through the access link. 
2.2 Fast Handovers for Proxy Mobile IPv6 (F-PMIPv6) 
F-PMIPv6 combines PMIPv6 and the fast handover 
mechanism to reduce packet loss. There are the predictive 
mode and the reactive mode in F-PMIPv6. In the predictive 
mode, the tunnel is established between the P-MAG and the 
N-MAG before an MN moves to the N-MAG. The P-MAG 
utilizes this tunnel to transfer the packets to the N-MAG when 
the MN performs the handover procedure. The N-MAG 
buffers the received packets until the MN attaches to its 
access link, and then forwards the buffered packets to the MN. 
There is no packet loss during the MN performs handover in 
the predictive mode. Figure 2 demonstrates the message flow 
of F-PMIPv6 predictive mode and the details of the message 
flow are described as follows: 
MN LMAP-MAG N-MAG
Buffering
1. Report
(MN-ID, NAP-ID) 2. HI
(MN-ID,“P”flag, HNP)
3. Hack
(“P”flag)
5. Hack
(“F”flag)
10. PBU
(MN-ID)
11. PBA
(HNP)
9. Deliver Packets
7. Forward Packets
4. HI
(MN-ID,“F”flag)
14. Deliver Packets
12. Bi-Dir tunnel
6. tunneling
8. L2 Handover
(MN-ID)
H
an
d
o
v
er L
aten
cy
13. RA
(HNP)
 
Figure 2: The message flow of F-PMIPv6 predictive mode 
Step 1. The MN reports its MN-ID and the information of 
the new AP (i.e., NAP-ID) to the P-MAG. 
Step 2. Assume that the P-MAG receives the report message 
and decides to perform the handover procedure. The 
P-MAG retrieves the N-MAG’s information from the 
NAP-ID and sends a Handover Initiate (HI) message 
which contains an MN-ID, a "P" flag and the MN’s 
the P-MAG and the N-MAG in advance, and thus it results in 
packet loss during the MN performs handover. 
In the F-PMIPv6 reactive mode, the MN performs Layer-2 
handover procedures before setting up a tunnel between the 
P-MAG and the N-MAG. The P-MAG cannot send these 
packets to the N-MAG’s buffer during that the MN performs 
handover. Thus, these packets may be lost during the 
handover processes. Moreover, the N-MAG exchanges the 
signaling messages with the P-MAG to establish a tunnel 
before sending the PBU message to the LMA. This process 
cannot prevent packet loss but increases the signaling cost 
and handover latency. In the F-PMIPv6 reactive mode, during 
handover, these packets from a CN to the MN follows the 
transmission path CN→LMA→P-MAG→N-MAG→MN. 
The packet transmission path increases the tunnel 
transmission cost. 
In order to take advantage of the F-PMIPv6 predictive mode 
and solve the issues of the F-PMIPv6 reactive mode, we 
propose a HF-PMIPv6 mechanism. HF-PMIPv6 utilizes a 
decision table to detect the mobility mode (i.e., predictive or 
reactive mode). If the mobility mode is predictive, HF-
PMIPv6 establishes a tunnel like F-PMIPv6 between the P-
MAG and the N-MAG to prevent packet loss. If the mobility 
mode is reactive, HF-PMIPv6 performs handover directly 
without setting up a tunnel to reduce the extra handover 
latency, the signaling cost and the tunnel transmission cost. 
Figure 4 and Figure 5 illustrate the detail message flows of 
the HF-PMIPv6 predictive and reactive modes. In Figure 4, 
HF-PMIPv6 is in the predictive mode. The message flow in 
Figure 4 is the same as that of F-PMIPv6 predictive mode 
except Steps 3, 10 and 12. Assume that the MN-ID of the MN 
is MN-1, the details are described as follows: 
MN LMAP-MAG N-MAG
Buffering
1. Report
(MN-1, NAP-ID) 2. HI
(MN-1,“P”flag, HNP)
4. Hack
(“P”flag)
6. Hack
(“F”flag )
13. PBU
(MN-1)
14. PBA
(HNP)
11. Deliver Packets
8. Forward Packets
5. HI
(MN-ID,“F”flag)
17. Deliver Packets
15. Bi-Dir tunnel
7. tunneling
9. L2 Handover
(MN-1)
3. 
Recording
10. Querying
12. 
Removing
H
an
d
o
v
er L
aten
cy
 
MN-1
empty
empty
Decision Table
empty
empty
empty
Decision Table
16. RA
(HNP)
 
Figure 4: The message flow of HF-PMIPv6 predictive mode 
Step 1. The MN reports its MN-ID (i.e., MN-1) and the 
information of the new AP (i.e., NAP-ID) to the P-
MAG. 
Step 2. Assume that the P-MAG receives the report message 
and decides to perform the handover procedure. The 
P-MAG retrieves the N-MAG’s information from the 
NAP-ID and sends a Handover Initiate (HI) message 
which contains an MN-ID (i.e., MN-1), a "P" flag 
and the MN’s HNP to the N-MAG. Note that the "P" 
flag represents that the MN uses F-PMIPv6 
mechanism. 
Step 3. Upon receipt of the HI message which contains the 
MN-ID (i.e., MN-1), the N-MAG stores the MN-ID 
into the decision table. 
Step 4. The N-MAG replies a Handover Acknowledge 
(HAck) message which contains a "P" flag to the P-
MAG. 
Step 5. The N-MAG prepares the buffer space for the 
upcoming packets and sends another HI message 
which contains MN-ID (MN-1) and an “F” flag to 
the P-MAG. The “F” flag represents the 
“Forwarding” flag. This message informs the P-
MAG to start transferring these packets that is 
destined to the MN to the N-MAG. 
Step 6. Upon receipt of the HI message, the P-MAG replies 
a HAck message with "F" flag and establishes the 
tunnel to the N-MAG. 
Step 7. Upon receipt of the HAck message, the N-MAG 
establishes the tunnel to the P-MAG. At this point, a 
bidirectional tunnel established between the P-MAG 
and the N-MAG. 
Step 8. When the P-MAG receives the packet sent to the 
MN, it modifies the outer IP header of the packet and 
then forwards the packet to the N-MAG. The N-
MAG stores this packet in the buffer until the MN 
connects to the N-MAG. 
Step 9. The MN performs the Layer-2 handover procedures 
to change the access link from the P-MAG to the N-
MAG. From this procedure, the N-MAG obtains the 
MN’s information including MN-ID (MN-1). 
Step 10. The N-MAG uses the MN-ID (MN-1) to query the 
decision table. Since the MN-ID (MN-1) is found in 
the decision table, the N-MAG forwards the buffered 
packets to the MN. 
Step 11. The N-MAG transfers the buffered packets to the 
MN. The packet transmission path from the CN to 
the MN is CN→LMA→P-MAG→N-MAG→MN. 
Step 12. After the N-MAG starts to transfer the buffered 
packets to the MN, it deletes the MN-ID (i.e., MN-1) 
entry from the decision table. 
Step 13. The N-MAG sends a PBU message to the LMA to 
update the MN’s binding. 
Step 14. Upon receipt of the PBU message, the LMA updates 
the binding and changes the tunnel from the P-MAG 
to the N-MAG and replies a PBA message. 
Step 15. Upon receipt of the PBA message, the N-MAG sets 
up a tunnel to the LMA. At this point, the bi-
directional tunnel has been set up. 
HF-PMIPv6 reactive mode includes the signaling cost of the 
PBU and PBA messages, the signaling cost of the RA 
message and the processing cost of the N-MAG and the LMA. 
The signaling cost can be expressed as the follows. 
6
, ,
2HF PMIPv
BU N MAG LMA MN N MAG
C C C
 
 
 
2
N MAG LMA
PC PC

 
.                   (4) 
The signaling cost of the F-PMIPv6 reactive mode includes 
the signaling cost of the HI and HAck messages, the signaling 
cost of the PBU and PBA messages, the signaling cost of the 
RA message and the processing cost of the P-MAG, the N-
MAG and the LMA. The signaling cost can be expressed as 
the follows. 
6
, , ,
2 2  F PMIPv
BU P MAG N MAG N MAG LMA MN N MAG
C C C C
   
  
 
3
P MAG N MAG LMA
PC PC PC
 
  
.                (5) 
4.3 Packet delivery cost 
Assume that the tunnel effect and the dropping effect are the 
same. The packet delivery cost (
PD
C ) combines the tunneling 
cost (
tunnel
C )
 
with the packet loss cost (
loss
C ) [12], and can be 
expressed as the follows. 
PD tunnel loss
C C C 
.                             (6) 
Let 
d
S  be the average size of data packets and 
c
S  be the 
average size of signaling packets. Assume that the rate 
/
d c
S S   and   is the packet arrival rate in unit of packet 
per time. 
In reactive mode, HF-PMIPv6 does not establish the tunnel 
between the P-MAG and the N-MAG. Therefore, the 
tunneling cost is zero 
6 0HF PMIPv
tunnel
C   . The data packet 
delivery cost between the CN and the MN is 
, , ,
( )
CN LMA LMA P MAG P MAG MN
C C C
 
   . The packet loss cost 
can be expressed as follows. 
6
2 , ,
( 2 )HF PMIPv
loss L MN N MAG N MAG LMA
C T T T
 
   
 
, , ,
( )
CN LMA LMA P MAG P MAG MN
C C C
 
   
.    (7) 
In the reactive mode, F-PMIPv6 established the tunnel 
between the P-MAG and the N-MAG after the MN performs 
Layer-2 handover. Therefore, the F-PMIPv6 reactive mode 
not only caused the tunneling cost, but also caused the packet 
loss cost. The packet loss cost between the CN and the MN is 
, , ,
( )
CN LMA LMA P MAG P MAG MN
C C C
 
   . The packet loss cost 
can be expressed as follows. 
6
2 ,
( 2 )F PMIPv
loss L P MAG N MAG
C T T
 
  
 
, , ,
( )
CN LMA LMA P MAG P MAG MN
C C C
 
   
.   (8) 
The tunnel transmission cost between the CN and the MN is 
, , , ,
( )
CN LMA LMA P MAG P MAG N MAG N MAG MN
C C C C
   
    . The 
tunneling cost can be expressed as follows. 
6
, ,
(2 )F PMIPv
tunnel N MAG LMA MN N MAG
C T T
 
  
 
, , , ,
( )
CN LMA LMA P MAG P MAG N MAG N MAG MN
C C C C
   
    
. (9) 
5 Numerical results 
This section presents the numerical results based on the 
analytical models developed in the last section. Assume that 
the total wire-line delay 
, ,X Y X Y w
T d L  and the wireless 
delay 
, ,MN P MAG MN N MAG wl
T T L
 
  , where 
w
L  and 
wl
L  are the 
wire-line and the wireless link delay and 
,X Y
d  is the number 
of hops between the node X and Y. The node X and Y can be 
the P-MAG, the N-MAG, the LMA, or the CN. Based on [12], 
we set 200 bytes,
d
S  96 bytes,
c
S  10 ,
wl
L ms
 
2 ,
w
L ms
 
2
50 ,
L
T ms 12,
LMA
PC  and
 
8
P MAG N MAG
PC PC
 
   In 
addition, we set 
, , ,
: : :1:1
P MAG N MAG P MAG LMA N MAG LMA
d d d v
   
 , 
where the variable v  expresses the ratio of the distance 
,P MAG N MAG
d
   and ,MAG LMAd . When v is larger than 1, the N-
MAG connects to the P-MAG through the core network. On 
the contrary, the N-MAG and the P-MAG communicate 
directly to each other. 
100
110
120
130
140
150
160
170
180
190
200
0.5 0.75 1 1.25 1.5 1.75 2
H
an
d
o
v
er
 L
at
en
cy
 (
m
s)
ν
HF-PMIPv6
F-PMIPv6
 
Figure 6: Impact of variable v on handover latency 
Figure 6 demonstrates the impact of the variable v on the 
handover latency. Since HF-PMIPv6 does not establish the 
tunnel between the P-MAG and the N-MAG, thus the v value 
does not affect the handover latency. F-PMIPv6 transmits two 
messages (i.e., one HI and one HAck messages) to set up the 
tunnel, and thus the handover latency of F-PMIPv6 is higher 
than that of HF-PMIPv6. 
Handling the Backhaul Link Failure for IEEE 802.16m Femto ABSs 
 
Yu-Chan Lin, Whai-En Chen*, Meng-Hsuan Lin 
Institute of Computer Science and Information Engineering 
National Ilan University I-Lan, Taiwan, R.O.C 
e-mail: wechen@niu.edu.tw 
  
Abstract—A Femto Advanced Base Station (ABS) is a low-
power base station and used to extend Worldwide 
Interoperability for Microwave Access (WiMAX) coverage to 
the indoor areas. The Femto ABS utilizes broadband 
connection (e.g., cable or DSL) as its backhaul link to 
connect to the mobile operator’s network and Internet. 
However, the broadband connection is less reliable than the 
dedicate line. In other words, the Femto ABS has more 
backhaul failure probability than the Macro ABS which uses 
the dedicate line. In order to reduce the impact of backhaul 
link failure, this paper proposes two mechanisms to handle 
the backhaul link failure based on different interfaces 
defined in IEEE 802.16m. This paper then compares these 
mechanisms in terms of the additional interface 
requirement, the notification method, the authentication/key 
exchange and the re-registration requirement. This paper 
also develops an analytic model to study the disruption time 
and packet loss of the proposed mechanisms. 
Keywords-WiMAX; IEEE802.16m;  Femto;  
I.  INTRODUCTION 
D
SL
 / 
ca
bl
e
D
SL
 / 
ca
bl
e
DSL / cable
DSL / cable
 
Figure 1.  The Network Architecture of the Femto ABS Deployment 
IEEE 802.16 referred to as Worldwide Interoperability 
for Microwave Access (WiMAX) system is approved as an 
International Mobile Telecommunications Advanced 
(IMT-Advanced) Technology [1]. However, high 
frequency deployment of WiMAX systems causes the 
poor indoor coverage [2]. A Femto Advanced Base Station 
(ABS) is a low-power base station and used to extend 
WiMAX coverage to the indoor areas. 
Figure 1 shows the network architecture of the Femto 
ABS deployment. The Advanced Mobile Station (AMS) 
connects to the Femto ABS through the R1 interface. The 
Femto ABSs are typically deployed within the coverage of 
a Macro ABS and installed at home or in the Small 
Office/Home Office (SOHO) environments. The Femto 
ABS operates in the licensed spectrum and may use the 
same frequency as the overlaid Macro ABS. The Femto 
ABS utilizes the broadband connection (e.g., cable or 
DSL) as its backhaul link and connects to the mobile 
operator’s network through Internet. Based on IEEE 
802.16m [3], the Femto ABS communicates with the 
Macro ABS either through its broadband connection (i.e., 
Internet) or through the R8 wireless interface.  
The cost of a broadband connection is cheaper than 
that of a dedicate line. However, the dedicate line is more 
reliable than the broadband connection. In other words, the 
Femto ABS has more backhaul failure probability than the 
Macro ABS. The AMS cannot access Internet or the 
operator’s network when the Femto ABS’s backhaul link 
is failure. However, the AMS attached to the failure Femto 
ABS does not aware the backhaul link failure since the 
radio link is not affected by the backhaul failure. 
In order to reduce the impact of the backhaul link 
failure, the Femto ABS can inform the AMS about the 
backhaul link failure by broadcasting the AAI-SON-ADV 
messages. When the AMS receives the AAI-SON-ADV 
message, the AMS should detach from the Femto ABS and 
tries to attach to another ABS (e.g., the Macro ABS) by 
itself. On the other hand, the Femto ABS can perform 
handover (HO) procedure instead of entire network entry 
procedure to reduce delay if there is the R8 interface 
between the Femto ABS and the Macro ABS. In this case, 
the Femto ABS exchanges HO information with the Macro 
ABS by using the HO-REQ and the HO-RSP messages 
through the R8 interface. Then the Femto ABS unicasts 
the AAI-HO-CMD messages to inform all AMSs which 
attach to the failure Femto ABS to perform HO procedure. 
IEEE 802.16m specifies the interface and the message 
format, but does not specify the detail mechanisms to 
handle the backhaul link failure. This paper focuses on the 
radio access network and proposes two mechanisms to 
handle the backhaul link failure based on different 
interfaces. The rest of this paper is organized as follows. 
We elaborate the detail message flows of the proposed 
mechanisms where the Femto ABS communicates with the 
overlaid Macro ABS through the backhaul link only or 
both the backhaul link and the air interface R8 in sections 
II and III respectively. In section IV, we compare these 
two mechanisms in terms of additional interface, 
notification method, contention ranging, authentication / 
key exchange and re-registration. We conduct an analytic 
model to evaluate the performance and evaluate the 
numerical results in section V. The conclusion and future 
work are given in in the last section. 
2011 International Conference on Parallel Processing Workshops
1530-2016/11 $26.00 © 2011 IEEE
DOI 10.1109/ICPPW.2011.21
11008
capabilities requested by the AMS. If yes, the Macro 
ABS then replies an AAI-SBC-RSP message that 
contains the capability parameters supported by the 
Macro ABS. 
Step 11. After the basic capability negotiation, the AMS 
performs the authentication procedure with the 
authentication server in the mobile operator’s core 
network. This paper utilizes Extensible 
Authentication Protocol (EAP) and Message Digest 
Algorithm 5 (MD-5) as an example. The AMS first 
sends an EAPOL-start message to initialize the 
authentication procedure. 
Steps 12-13. The Macro ABS sends an EAP-Request 
message to get the AMS’s identity. The AMS replies 
its identity through an EAP-Response message. 
Steps 14-16. Upon receipt of the AMS’s identity, the 
Macro ABS uses this identity to retrieve the 
password from the authentication server, and 
challenges the AMS by using an EAP-Request 
message. Based on the information retrieved from the 
EAP-Request message, the AMS utilizes MD5 to 
generate the hashed password and then responses the 
hashed password to the Macro ABS through an EAP-
Response message. The Macro ABS verifies that the 
response is valid and replies an EAP-success 
message to the AMS. 
Steps 17-19. After the authentication procedure, the Macro 
ABS initializes a three-way handshake key 
agreement procedure. In the key agreement 
procedure, the Macro ABS and the AMS exchange 
the AAI-PKM-RSP and the AAI-PKM-REQ 
messages to derive the Traffic Encryption Key 
(TEK). After the key agreement procedure, all 
message transmitted between the Macro ABS and the 
AMS are protected by using the TEK. 
Step 20. The AMS uses an AAI-REG-REQ message to 
register into the network. The AAI-REG-REQ 
message contains the AMS’s MAC address and the 
convergence Sublayer type (e.g., IPv4 or IPv6). 
Step 21. Upon receipt of the AAI-REG-REQ message, 
the Macro ABS replies an AAI-REG-RSP message 
that contains the assigned STID and the related 
parameters. After this step, the AMS uses the STID 
instead of the TSTID to communicate with the Macro 
ABS. 
After Step 21, the AMS moves out from the failure 
Femto ABS, attaches to the Macro ABS, and starts its 
communication. 
III. MECHANISM 2: USING HO PROCEDURE 
In this section, we introduce the case where the Femto 
ABS has the R8 interface. With the R8 interface, the 
Femto ABS exchanges HO information with the Macro 
ABS and initializes the HO procedure to transfer the 
AMSs to the Macro ABS. Figure 3 shows the message 
flow where the Femto ABS unicasts the AAI-HO-CMD 
message to perform the HO procedure. The steps are 
elaborated as follows. 
 
Figure 3.  The Femto ABS unicasts AAI-HO-CMD 
 
Step 1. The Femto ABS detects the backhaul link failure 
and starts to perform the HO procedure. 
Step 2. The Femto ABS sends an HO-REQ message to 
notify the Macro ABS with the AMS’s information 
through the R8 air interface. The information 
contains Anchor Access Service Network (ASN) 
gateway ID, Authenticator ID, Anchor Mobility 
Management (MM) Context, Security Association 
(SA) Descriptor and Service Flow Information. 
Step 3. The Macro ABS obtains the AMS’s information 
from the HO-REQ message. The Macro ABS then 
registers to the core network by using the information 
retrieved from the HO-REQ message [4]. If the 
Macro ABS successfully registers to the core 
network, then it replies an HO-RSP message that 
contains the Macro ABS’s information to the Femto 
ABS. The Macro ABS’s information includes a 
Temporary Station ID (TSTID), a Cipher-based 
Message Authentication Code (CMAC), a dedicated 
ranging code and a dedicated ranging opportunity. 
The CMAC is used to protect the AAI-RNG-REQ 
message transmitted by the AMS. 
Step 4. Upon receipt of the HO-RSP message, the Femto 
ABS sends an AAI-HO-CMD message to command 
the AMS to perform handover to the Macro ABS. 
The AAI-HO-CMD message contains a target BSID 
(i.e., the Macro ABS’s BSID), the ranging code, the 
ranging opportunity and the TSTID. The ranging 
code, the ranging opportunity and the TSTID are 
retrieved from the HO-RSP message. 
Step 5. The AMS scans the Macro ABS’s DL channels 
according to the target BSID (i.e., the Macro ABS’s 
BSID) carried in the AAI-HO-CMD message. Then 
the AMS tries to establish the DL synchronization 
with the Macro ABS. 
 
1120
AMS through the AAI-HO-CMD message. Therefore, 
the mechanism 2 does not require performing the 
authentication and key exchange procedures again after 
the AMS performs HO procedure. In the mechanism 1, 
the AMSs coming from the Femto ABS acts as newly 
attached AMSs. The Macro ABS will request these AMSs 
to authenticate and exchange the security keys. 
e) Re-registration 
Like authentication and key exchange, in the 
mechanism 1, the AMSs moving from the Femto ABS to 
the Macro ABS should perform the registration procedure 
to core network. After registration, the core network 
assigns new resources to the AMS through the Macro 
ABS and terminates the resources allocated between the 
core network and the Femto ABS. In the mechanism 2, 
the core network switches the reserved resources from the 
Femto ABS to the Macro ABS after the HO procedure. 
V. ANALYTIC MODEL 
In this sub-section, we evaluate the performance of the 
proposed mechanisms in terms of the disruption time and 
packet loss. We define the following parameters for the 
performance analysis. ,x yT  represents the transmission 
delay between nodes x and y. The x and y can be AMS, 
Femto ABS or Macro ABS. Note that ,Femto MacroT  is the 
transmission delay between the Femto ABS and the Macro 
ABS through the R8 interface. λ  is the packet arrival rate 
in unit of packet per second. mscan synT +  represents the latency 
of the DL channel scan and the DL synchronization, where 
m is 1 or 2 and represents the mechanism 1 or 2. The 
disruption time mD  and the total packet loss mP  are 
derived as follows. 
A. Disruption Time 
The disruption time mD  is calculated from the 
backhaul link failure to the registration procedure 
complete. In Figure 2, the disruption time of the 
mechanism 1 includes the transmission delay of notifying 
the backhaul failure ( ,AMS FemtoT ), the latency of processing 
DL channel scan and synchronization ( 1scan synT + ), and the 
latency of performing, the ranging procedure 
( ,3 AMS MacroT ), the capability negotiation procedure 
( ,2 AMS MacroT ), the authentication procedure ( ,6 AMS MacroT ), 
the key exchange procedure ( ,2 AMS MacroT ) and the 
registration procedure ( ,2 AMS MacroT ). Note that the Steps 5 
and 6 of ranging procedure and Steps 16 and 17 of 
authentication and key exchange procedure are transmitted 
at the same time. Therefore, only Step 5 and Step 16 are 
counted into the transmission delay. 1D  can be expressed 
as the follows: 
 
 
1
1 , , ,
, , ,
3 2
       6 2 2
AMS Femto scan syn AMS Macro AMS Macro
AMS Macro AMS Macro AMS Macro
D T T T T
T T T
+= + + +
+ + +
      
1
, ,= 15AMS Femto scan syn AMS MacroT T T++ +  (1) 
The disruption time of the mechanism 2 shown in 
Figure 3 includes the transmission delay of notifying the 
backhaul failure ( ,AMS FemtoT ), the latency of processing 
DL channel scan and synchronization ( 2scan synT + ), the 
latency of exchanging the HO-REQ and HO-RSP 
messages ( ,2 Femto MacroT ) and the latency of performing 
ranging procedure ( ,3 AMS MacroT ).Not that Steps 6 and 7 of 
ranging procedure and Steps 8 and 9 of ranging procedure 
are transmitted at the same time. Therefore, only Step 6 
and Step 8 are counted into the transmission delay. 2D  
can be expressed as the follows: 
 
2
2 , , ,2 3AMS Femto scan syn Femto Macro AMS MacroD T T T T+= + + +  (2) 
B. Packet Loss 
The AMS cannot receive packets during the disruption 
time. The packet loss is conducted by multiplying with the 
packet arrival rate the disruption time. The packet loss of 
the mechanisms 1 and 2 can be expressed as the follows: 
1 1*P Dλ=  
 
1
, ,* ( 15 )scan syn AMS Femto AMS MacroT T Tλ += + +  (3) 
2 2*P Dλ=  
 
2
, , ,* ( 2 3 )scan syn AMS Femto Femto Macro AMS MacroT T T Tλ += + + +  
 (4) 
C. Numerical Results 
This section presents the numerical results generated 
from the analytical model. According to [4-5], we set 
1
scan synT +  to 75 ms, 
2
scan synT +  to 10 ms and the maximum 
wireless link delay to 10ms. The wireless link delay and 
the packet arrival rate are considered as the input variables. 
Since all messages transmitted among the AMS, the Femto 
ABS and the Macro ABS are over the wireless link. We 
assume the value of ,AMS FemtoT  , ,AMS MacroT  and 
,Femto MacroT  are the same. Based on the transmission rate 
specified in 802.16m [7], the value of variable λ  is 
ranging from 0 to 20000 packets per second. 
Since this paper focuses on the procedures of the radio 
access network, the procedures of the core network are out 
of scope of the paper and could be further studied. All 
messages proposed in the mechanisms 1 and 2 are 
exchanged over the wireless link, and thus the wireless 
link delay dominates the disruption time. Figure 4 shows 
the impact of the wireless link delay on the disruption time. 
We observe that the mechanism 2 has less disruption time 
than the mechanism 1 since the AMS performs the 
1142
國科會補助計畫衍生研發成果推廣資料表
日期:2011/10/26
國科會補助計畫
計畫名稱: 子計畫二：LTE/LTE-A識別碼保密與行動管理機制之研究(I)
計畫主持人: 陳懷恩
計畫編號: 99-2628-E-197-001- 學門領域: 網路
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
1. 在 IMS 研究部分受邀與 InterDigital 公司合作在 3GPP 提案。目前利用學界
參與標準的機制，先與資策會討論申請專利，保護國內研發成果後，再與
InterDigital 合作。 
2. 研究成果受到肯定，獲得學校推薦 99 年度補助大專校院獎勵特殊優秀人才。
3. 將研究成果製作成教材，獲選為優良教學教師 
4. 參與「雲端運算」教材製作獲得優等。 
5. 帶領團隊製作「Symbian 手機開發平台」教材獲得佳作。 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
