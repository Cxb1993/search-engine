(ICI) due to Doppler effect for the new generation 
wireless systems, such as WiMAX. Not liking the usual 
interference cancellation mechanisms which  are 
performed in the physical layer, this study propose 
an ICI cancellation scheme by using a hybrid MAC-PHY 
technique. Based on the basic principle of spread 
spectrum systems, the proposed hybrid MAC-PHY design 
orthogonally spreads signals in transmission-domain 
to separate the desired signals from interferences. 
It not only improves SNR but also suppresses ICI and 
IAI swithout increasing complexity. 
 In the second-year study, a link adaptation scheme 
for MIMO-OFDM systems over high speed rail 
environment is addressed in this study. In this 
study, a selection method of MIMO transmission mode 
and the modulation and coding scheme (MCS) according 
to the Rician channel K-factor from our previous work 
is considered. A hidden Markov model of time-varying 
Rician channel K-factor is constructed by using the 
real measured channel data on the high speed rail 
train. With the constructed hidden Markov model, the 
time correlation of Rician channel K-factor can be 
obtained and the time-varying K-factor value can be 
generated. By using the hidden Markov model, the K-
factor value can be predicted to facilitate link 
adaptation since the K-factor may vary during 
feedback, especially in high mobility scenario. 
 In the third-year study, considering the line-of-
sight (LoS) channel, the rank of channel matrix 
restricts the achievable multiple-input multiple-
output (MIMO) channel capacity. In the high-speed 
rail (HSR) radio communications, it is likely to have 
a strong LoS path for the deployment of antenna 
elements of base station (BS) along the railway. For 
a regular MIMO system, the strong LoS path leads a 
low rank channel matrix and results a poor channel 
capacity. Under the condition of the lack of 
scattering, this study propose a distributed MIMO 
system deployment criterion for HSR radio 
communications by fulfilling the requirement of 
maximizing channel capacity. The result shows that 
the proposed MIMO system deployment strategy can 
 
 
 
1 
行政院國家科學委員會補助專題研究計畫 ■成果報告   
□期中進度報告 
 
 
高鐵上 WiMAX 系統通道特性分析與效能提昇技術研究 (第 3年) 
 
計畫類別：■個別型計畫   □整合型計畫 
計畫編號：NSC   98－2221－E－027－036－MY3 
執行期間：  98 年 8 月 1 日至 101 年 7 月 31 日 
 
執行機構及系所： 國立台北科技大學電腦與通訊研究所 
 
計畫主持人：林信標 
共同主持人： 
計畫參與人員：林坤毅、李啟綸、黃嘉倫 
 
 
 
成果報告類型(依經費核定清單規定繳交)：□精簡報告  ■完整報告 
 
本計畫除繳交成果報告外，另須繳交以下出國心得報告： 
□赴國外出差或研習心得報告 
□赴大陸地區出差或研習心得報告 
■出席國際學術會議心得報告 
□國際合作研究計畫國外研究報告 
 
 
處理方式：除列管計畫及下列情形者外，得立即公開查詢 
            □涉及專利或其他智慧財產權，□一年■二年後可公開查詢 
 
 
中   華   民   國  101  年  9  月  30  日 
 
 
 
3 
第四章 提升高鐵無線傳輸系統通道容量的分散式天線佈建方法 
  4.1 Introduction ………………………………………………………………..33 
  4.2 MIMO capacity and LoS channel model ………………………………….34 
  4.3 MIMO systems for HSR scenarios ………………………………………...35 
   4.3.1 Regular MIMO systems ……………………………………………35 
   4.3.2 RoF distributed MIMO systems  ………………………………….36 
  4.4 Distributed MIMO system deployments for HSR radio communications ...36 
   4.4.1 Capacity maximizing criterion for MIMO system …………………36 
   4.4.2 Simulation results …………………………………………………..37 
  4.5 Seamlessly maximizing MIMO capacity ………………………………….40 
  4.6 Conclusions ………………………………………………………………..42 
  4.7 References …………………………………………………………………42 
 
第五章 結論 ……………………...…………………………………………………42 
    
附錄 
  國科會補助專題研究計畫成果報告自評表 ………………………...………45 
  國科會補助計畫衍生研發成果推廣資料表 …………………………..…….46 
 
 
 
5 
Abstract 
 In high-speed rail environments, there are two characteristics for the radio propagation. One is the 
Doppler effect, the other is the strong line-of-sight (LoS) path. 
 This project studies the inter-carrier interference (ICI) due to Doppler effect for the new generation 
wireless systems, such as WiMAX. Not liking the usual interference cancellation mechanisms which  
are performed in the physical layer, this study propose an ICI cancellation scheme by using a hybrid 
MAC-PHY technique. Based on the basic principle of spread spectrum systems, the proposed hybrid 
MAC-PHY design orthogonally spreads signals in transmission-domain to separate the desired signals 
from interferences. It not only improves SNR but also suppresses ICI and IAI swithout increasing 
complexity. 
 In the second-year study, a link adaptation scheme for MIMO-OFDM systems over high speed rail 
environment is addressed in this study. In this study, a selection method of MIMO transmission mode 
and the modulation and coding scheme (MCS) according to the Rician channel K-factor from our 
previous work is considered. A hidden Markov model of time-varying Rician channel K-factor is 
constructed by using the real measured channel data on the high speed rail train. With the constructed 
hidden Markov model, the time correlation of Rician channel K-factor can be obtained and the 
time-varying K-factor value can be generated. By using the hidden Markov model, the K-factor value can 
be predicted to facilitate link adaptation since the K-factor may vary during feedback, especially in high 
mobility scenario. 
 In the third-year study, considering the line-of-sight (LoS) channel, the rank of channel matrix 
restricts the achievable multiple-input multiple-output (MIMO) channel capacity. In the high-speed rail 
(HSR) radio communications, it is likely to have a strong LoS path for the deployment of antenna 
elements of base station (BS) along the railway. For a regular MIMO system, the strong LoS path leads a 
low rank channel matrix and results a poor channel capacity. Under the condition of the lack of scattering, 
this study propose a distributed MIMO system deployment criterion for HSR radio communications by 
fulfilling the requirement of maximizing channel capacity. The result shows that the proposed MIMO 
system deployment strategy can provide a continuously maximized channel capacity.
 
 
 
7 
在進行切換後，可能已不適合當下的通道情況，為改善改善通道回傳的延遲問題，我們嘗試
提出利用在高鐵上所量測的通道特徵，利用隱藏馬可夫模型訓練出一個類似的通道模型，再
由此一建立的通道模型，進行預測式的適應性切換，來提高適應性切換的準確性。 
(3) 高 K值萊斯通道環境下的多輸入多輸出架構佈建問題。 
由於空間多工模式下的多輸入多輸出架構，是發展在通道假設為獨立的雷利衰弱
(Rayleigh fading)下，此時的通道矩陣會是滿秩的情況，因此可有效獲得空間多工增益，然而
在強烈的直視波通道環境下，多輸入多輸出架構的通道矩陣卻是一低秩矩陣，造成空間多工
增益下降，使得傳統多輸入多輸出架構無法用來提升資料傳輸量，在此研究中，我們先分析
了傳統多輸入多輸出架構，在高鐵幾何架構下的空間通道容量效能，分析結果顯示使用傳送
端天線距離拉長的分散式多天線架構可獲得較佳的空間通道容量效能，在此架構下，我們再
進一步推導出一可滿足文獻上最佳空間通道矩陣的天線配置準則，但僅用單一對分散式多天
線無法滿足高鐵列車在各位置上的最佳空間通道容量效能，我們最後提出一分散式多天線佈
建方法，來達到高鐵沿線直視波通道環境下最佳的空間通道容量效能。 
 
 
1.2 章節介紹 
本計畫針對高鐵上新一代無線寬頻行動網路系統效能提升的研究成果，共可分為下列三大部
份，(1)用以消除多輸入多輸出正交分頻多工系統的子載波間與天線間干擾之混合式自動重傳機
制；(2)利用隱藏式馬可夫模型在高鐵環境下進行多輸入多輸出正交分頻多工系統適應性傳輸切換
機制；(3)提升高鐵無線傳輸系統通道容量的分散式天線佈建方法，並分別簡介如下: 
 
第二章的研究主要藉由展頻通訊系統的概念，提出一混合式自動重傳機制來消除多輸入多輸
出正交分頻多工系統下的干擾，藉由結合多媒體存取層與實體層的方式，在傳送端設計出一正交
的擴展信號，用以分離真正的信號與干擾信號，所提出的方式不僅可提升信號訊雜比，還可抑制
載波間干擾與天線間干擾，所提出的方法並不會增加系統複雜度，並且由理論分析與模擬結果顯
示，本研究提出之方法比傳統的追蹤結合方法有更好的系統效能。 
 
 
 
9 
第二章  用以消除多輸入多輸出正交分頻多工系統的子載波間與天線間干擾
之混合式自動重傳機制 
 
2.1 Introduction 
For high data rate transmission, modern wireless communication system uses wider channel bandwidth, 
which results in frequency-selective fading due to multipath propagation. Orthogonal frequency division 
multiplexing (OFDM) overcomes this fading by dividing a wider bandwidth into subcarriers such that the 
bandwidth of each subcarrier is sufficiently narrow to experience relatively flat fading. Nevertheless, OFDM 
is sensitive to carrier frequency offset causing inter-carrier-interference (ICI). 
Many ICI cancellation mechanisms have been proposed in literature. A frequency-domain equalizer 
compensating ICI was proposed in [1]. An ICI self-cancellation scheme was presented [2] by encoding the 
same data on a group of several subcarriers. It was further generalized in [3], where the approximately optimal 
designs can be obtained in constraints of signal-to-interference ratio (CIR) or bit error rate (BER). A 
time-domain windowing of OFDM signal to reduce the sensitivity to carrier frequency offset was described in 
[4], where the Nyquist window was used to suppress the side lobes of subcarriers. A second order polynomial 
Nyquist window function was presented in [5] to improve the windowing-based interference cancellation. An 
ICI self-cancellation scheme with pre-filtering and post-filtering inserted at the transmitter and receiver was 
presented in [6], which gains frequency-domain diversity by periodically extending the time-domain signal. 
Besides interference cancellation for signal recovery, automatic-repeat-request (ARQ) protocol [7] is 
widely used to offer a reliable data transmission. Hybrid ARQ (HARQ) [8] combines both the currently copy 
and previously received copies of a packet to increase the probability of successful packet transmission. By 
retransmitting and combining, conventional HARQs are effective to increase signal-to-noise ratio (SNR) but 
not capable of reducing interference. To the best of our knowledge, no interference cancellation in 
transmission-domain had been presented. Therefore, based on the basic principle of spread spectrum 
technique [9], this study presents an enhanced HARQ, which achieves interference suppression in addition to 
SNR improvement for MIMO-OFDM systems. 
 
 
 
11 
Frequency offset may result in unsuccessful data transmission. Modern communication systems 
retransmit any packet with uncorrectable error. The conventional Chase Combining HARQ [10] appends each 
packet with a CRC (cyclic redundancy check) code [7] used for error detection. If decoding the packet 
successfully, the receiver sends an acknowledgement (ACK) to the transmitter as a confirmation of successful 
transmission, otherwise the transmitter makes an additional retransmission with the identical format. 
According to the assumptions in (5), the received signal at the i-th retransmission (the zeroth retransmission is 
the initial transmission) is given as 
 
)(
33
)(
333
)(
322
)(
2
22
)(
211
)(
111
)(
10
)()(
i
mm
i
mm
i
mm
i
m
m
i
mm
i
mm
i
mm
i
m
i
m
ZXHXHXH
XHXHXHXHY
++++
+++≈
+−+−−+−+
−−+−+−−
ααα
αααα
.            (6) 
 
The conventional HARQ combines the multiple copies of each packet by using maximal-ratio combining, and 
the combined signal can be expressed as 
 
(
) ∑
∑
∑
=
∗
−−−+−
−+−−
=
=
∗
++++
+++≈
=
i
j
j
m
j
mmmm
mmmm
i
j
j
m
i
j
j
m
j
m
i
m
ZHXXX
XXXXH
YHY
0
)()(
333322
2211110
0
2)(
0
)()()(~
ααα
αααα .                     (7) 
 
Compared to the initial transmission, packet combining enhances the SNR but has no improvement in 
terms of interference reduction. Therefore this study presents an enhance HARQ with interference mitigation 
in addition to SNR improvement. 
 
2.3 Proposed HARQ scheme 
2.3.1 Proposed HARQ scheme in SISO case 
Figure 1 depicts the proposed scheme, which is much similar to the conventional one except the coding 
of retransmitted signals. Assume R retransmissions ( 1+R  transmissions in total) for each packet, the encoded 
 
 
 
13 
retransmission are updated respectively as 
 
( ) ( ) 222)1( 0,3311)1( 1,
2
0
)1(
0,)1(
−−− +++++
≈
αααααα
α
mm
m
GG
G
CIR  and                 (11) 
 
( ) ( ) ( ) 213)2( 3,22)2( 2,31)2( 1,
2
0
)2(
0,)2(
−−− +++++
≈
αααααα
α
mmm
m
GGG
G
CIR ,                  (12) 
 
where 2)1(2)0()1( 0, mmm HHG += , 
2)1(2)0()1(
1, mmm HHG −= , 
2)2(2)1(2)0()2(
0, mmmm HHHG ++= , 
2)2(2)1(2)0()2(
1, mmmm HHHG −−= , 
2)2(2)1(2)0()2(
2, mmmm HHHG −+= , 
2)2(2)1(2)0()2(
3, mmmm HHHG +−= . The proposed scheme suppresses the ICI compared to 
the conventional one. 
From (10), the level of ICI cancellation strongly depends on the orthogonality of received signals, which 
is defined as ( )221 mkmmTm Tr HCHC +−  with unit indicating complete cancellation of interference from 
subcarrier kmf + . To evaluate the signal orthogonality in time-varying scenario, the channel was modeled as a 
complex Gaussian random variable and expressed as )()()( rmrmrm jvuH +=  where u  and v  are uncorrelated 
zero-mean, unit-variance Gaussian random variables. The channel correlation was assumed to follow the 
Gauss-Markov process in time-domain such that Wuu rmrm 2)1()( 1 rr −+= −  and Wvv rmrm 2)1()( 1 rr −+= − , where r  
represents channel correlation and W is a zero-mean, unit-variance Gaussian random variable. Using the 
transmission format in Table I, Fig. 2 plots the orthogonality between mf  and kmf +  after R retransmissions. 
The orthogonality remains above 0.5 except the case of 2+mf  and 1=R , which has the same transmission 
format to the conventional HARQ. Additionally, although the assumption of ignoring ICI terms for 3|| >− km  
in (5) may not be sufficient to suppress all the interferences, the proposed scheme may mitigate the ICI from 
up to 43N  subcarriers because the transmission format repeats every four subcarriers. 
 
 
 
 
15 
 
Fig. 2.  Signal orthogonality in time-varying channel 
 
2.3.2 Proposed HARQ scheme in MIMO case 
This section extends the discussion to MIMO-OFDM systems with Q antennas at both the transmitter 
and receiver. For simplicity, the following derivation is about the received signal after 3=R  retransmissions. 
Let mi,Y  denote the received signal on the m-th subcarrier at the i-th receive antenna, mij ,H  be the channel 
gain mH  between the i-th receive and j-th transmit antenna, and mj ,S  and mj ,Φ  represent the transmitted 
signal mS  and its associated coding matrix mΦ  on the j-th transmit antenna, respectively, the received signal 
has the form 
 
[ ] mmmmTmQmmm WSΦHYYY +≈=ℜ − ,1,1,0  ,                 (13) 
 
where mH  is a QQ×  channel matrix with elements mij ,H , ),,,( ,1,1,0 mQmmm diag −= ΦΦΦΦ  , 
[ ]TmQmmm ,1,1,0       −= SSSS  , and mW  is a 1×Q  noise vector. To extract the desired signal, the received signal is 
multiplied by ∗mTmi HΦ ,  with ( )TmiTmiTmi diag ,,, ,, ΦΦΦ =  being a QQ ×  diagonal matrix, resulting in the 
combined signal vector mmTmimmmmTmimi WHΦSΦHHΦ ∗∗ +=ℜ ,,,
~  with the i-th element being the received signal 
from the i-th transmit antenna. 
To let readers capture the proposed idea easier, Table I shows the transmission formats for a case with 
 
 
 
17 
a frame-by-frame basis. Each frame was partitioned into downlink and uplink sub-frames, and the frame 
duration was five mini-seconds with 47 OFDM symbols. Only downlink transmissions were considered in the 
simulations. The time-frequency resource of downlink sub-frame was divided into resource blocks, each of 
whom consisted of two sub-channels by two OFDM symbols and conveyed a FEC (forward error correction) 
coding block. Any erroneous block was retransmitted with one-frame delay. 
In the simulations, information bits were randomly generated and fed into an encoder including a 2-byte 
CRC encoder and a convolutional encoder with code rate of 1/2. The coded bits were then mapped onto 
modulation symbols chosen from a 64QAM constellation. The frequency-domain signals were encoded 
according to Table I and II. Then, the signals were transformed from frequency-domain to time-domain by 
using inverse fast Fourier transform. Before being transmitted over the time-varying channels, the signals 
were inserted with a cyclic prefix of length 128. The ITU Vehicular channel model, corresponding to a 
multipath profile with six paths of delay [0 310 710 1090 1730 2510] nanoseconds and power profile [0 -1 -9 
-10 -15 -20] dBs was applied in the simulations and perfect channel estimation was assumed. With mobility of 
120 km/hr and normalized carrier frequency offset of 0.05, Fig. 3 presents the BER in SISO case, where 
“CvtHARQ” represents the conventional HARQ, “ProHARQ” stands for the proposed HARQ, and “RTX” is 
the number of retransmissions. The performance of the conventional HARQ is bounded by ICI, while the 
proposed scheme suppresses the interference. Using spatial multiplexing with zero-forcing detector, Fig. 4 
shows the performance with a lower mobility of 10 km/hr in 4x4 MIMO channels with the absence of carrier 
frequency offset. The performance improvement is mostly due to IAI suppression because ICI can be ignored 
owing to the low mobility. Figure 5 displays the FEC BLER (block error rate) with a mobility of 30 km/hr and 
a normalized carrier frequency offset of 0.05 in 4x4 MIMO channels. The proposed scheme reveals an 
encouraging improvement over the conventional one by effectively mitigating ICI and IAI. 
Although many interference cancellation algorithms at PHY layer had been proposed in literature, most 
of their complexity are high and there still remains some ICI residuals because of estimation error. Especially 
in multi-antenna systems, multiple frequency offsets are usually considered and it requires higher computing 
power to estimate all the offsets. Besides, those PHY layer designs usually did not consider power saving 
even in the absence of interference. However, the proposed hybrid MAC-PHY design demonstrates the 
 
 
 
19 
 
 
Fig. 5.  Comparison of BLER in 4x4 time-varying MIMO channel 
 
2.5 Conclusions 
This study has presented an enhanced scheme, which realizes ICI and IAI mitigation by encoding the 
retransmitted signals based on the Hadamard-Walsh code for MIMO-OFDM systems. it orthogonally spreads 
the frequency-domain signal in transmission-domain to separate the desired signal from interferences, 
resulting in interference suppression in addition to SNR improvement. Although many interference 
cancellation algorithms at PHY layer had been proposed, this study has demonstrated the possibility of 
interference cancellation using a hybrid MAC-PHY technique. By mathematical analyses and numerical 
simulations, this study has shown an encouraging performance improvement compared to the conventional 
HARQ in multipath time-varying Rayleigh fading channels. 
 
2.5 Reference 
[1] W. G. Jeon, K H. Chuang, and Y. S. Cho, “An equalization technique for orthogonal frequency division multiplexing 
systems in time-variant multipath channels,” IEEE Trans. Commun., vol. 49, pp. 1185–1191, Jan. 1999. 
[2] Y. Zhao and S. G. Haggman, “Intercarrier interference self-cancellation scheme for OFDM mobile communication 
systems,” IEEE Trans. Commn., vol. 49, no. 7, pp. 1185-1191, July 2001. 
 
 
 
21 
第三章  利用隱藏式馬可夫模型在高鐵環境下進行多輸入多輸出正交分頻多
工系統適應性傳輸切換機制 
 
3.1 Introduction 
The link adaptation scheme is a useful way to improve spectral efficiency for wireless communication 
systems over fading channel. When the channel quality is good, high modulation order and coding rate can be 
chosen to provide higher throughput. If the channel quality is bad, modulation order and coding rate can be 
switched to lower case for the error rate consideration. In the 4th-generation (4G) communication systems, the 
multiple-input multiple-output (MIMO) scheme is the most important technology which can be used to 
improve spectral efficiency for spatial multiplexing (SM) or increase the signal quality for transmission 
diversity (TD).  
Several studies on the selection of MIMO transmission mode and modulation and coding scheme (MCS) 
have been presented [1-7]. However, they are all assumed the channel is static during the feedback time. It is 
not practical to ignore the feedback delay latency. Some papers [8-10] may address this part. In [9], the author 
derives a MCS determination rule by considering the channel time correlation from Jake’s model. The MCS 
can be selected to guarantee the required error rate in Doppler channel. In [10], a first-order finite-state 
Markov model was used for representing the time variations in the average channel SIR. The optimized 
threshold of MCS selection can be therefore deduced.  
In this study, we evaluate the throughput performance of a link adaptation system [11] for the high speed 
rail environment. The Rician K-factor value measured on the high speed rail train is used and further extended 
to the MIMO channel for throughput performance evaluation. To improve the throughput performance by 
against the feedback delay, we proposed a hidden Markov model to predict the K-factor value of Rician 
channel for the selection of link adaptation. 
 
3.2 Link adaptation by exploiting Rician k-factor 
3.2.1 MIMO Rician channel model 
 
 
 
23 
allowed for modulation. The FFT size is 1024, and the OFDM symbol duration with 1/8 CP ratio is 102.86μs. 
The number of transmission and receiving antenna is fixed to 4. 
 
TABLE I.  LOOK-UP TABLE FOR LINK ADAPTATION OF THE 4X4 MIMO-OFDM SYSTEM 
SNR(dB) K(dB) STBC G2+2 V-BLAST 
0 
K = 3.3 QPSK(1/2)   
K = 13.7 QPSK(1/2)   
K = 24 QPSK(1/2)   
3 
K = 3.3 QPSK(1/2)   
K = 13.7 QPSK(2/3)   
K = 24 QPSK(2/3)   
6 
K = 3.3 QPSK(2/3)   
K = 13.7 QPSK(2/3)   
K = 24 QPSK(2/3)   
9 
K = 3.3 16QAM(1/2)   
K = 13.7 16QAM(1/2)   
K = 24 16QAM(1/2)   
12 
K = 3.3 16QAM(2/3)   
K = 13.7 16QAM(2/3)   
K = 24 16QAM(2/3)   
15 
K = 3.3 64QAM(1/2)   
K = 13.7 64QAM(1/2)   
K = 24 64QAM(1/2)   
18 
K = 3.3  QPSK(1/2)  
K = 13.7 64QAM(2/3)   
K = 24 64QAM(2/3)   
21 
K = 3.3   QPSK(1/2) 
K = 13.7  QPSK(1/2)  
K = 24 64QAM(2/3)   
24 
K = 3.3  16QAM(1/2)  
K = 13.7   QPSK(1/2) 
K = 24  QPSK(1/2)  
27 
K = 3.3  16QAM(1/2)  
K = 13.7  16QAM(1/2)  
K = 24  QPSK(1/2)  
30 
K = 3.3  64QAM(1/2)  
K = 13.7  16QAM(1/2)  
K = 24  16QAM(1/2)  
 
The look-up table as shown in Table I that we built in our previous work was applied for link adaptation 
of the described 4x4 MIMO-OFDM system. The look-up table is constructed in the constraint of BER = 10-4. 
The MIMO transmission mode can be switched from STBC to G2+2 or V-BLAST as SNR increased. To 
achieve higher spectral efficiency for high SNR, higher modulation order can be adopted while the K-factor 
value of Rician channel is low. In the low K-factor Rician channel, the G2+2 transmission mode can be 
adopted with 64QAM when SNR achieves 30 dB. Nevertheless, in the high K-factor Rician channel, the 
 
 
 
25 
1) { }NsssS 21=  is a set of all states, where N is the number of the states. 
2) { }MvvvV 21=  is a set of observation output, where M is number of symbols. 
3) { }TqqqQ 21=  is the state sequence of unobservation, where T is the length of the state sequence, 
and qT represents the corresponding state at time t. 
4) { }ToooO 21=  is the observation sequence, where ot represents the observed symbol at time t. 
5) { }Npppp 21=  is initial probability vector of states, where ),sq(P ii == 1p Ni ≤≤1 represents the 
probability of the state of the 1st sample time is si and 1
1
=∑
=
N
i
ip  
6) The transition probability matrix of N states is 
 
NNNNNN
N
N
aaa
aaa
aaa
A
×












=




21
22221
11211
                           (3) 
 
where aij is the probability of state i to state j for time t to time t+1. 
7) The observation output matrix is 
 
MNNNN Mbbb
Mbbb
Mbbb
B
×












=
)()2()1(
)()2()1(
)()2()1(
222
111




                        (4) 
 
where the dimension of B is N×M, N denotes the number of states and M is the observation output points. 
Furthermore, )|()( jtkj sqvPkb ==  is the probability of vk occurs in state j and 1)(
1
=∑
=
M
k
j kb .  
Note that the (4) is used for discrete-time hidden Markov model. For a continue-time hidden Markov model, 
the element of matrix B can be generated by using below equation. 
 
 
 
 
27 
 
Fig. 2  Real measured and simulated time-varying Rician K-factor by using hidden Markov model 
 
Fig. 3  CDF of real measured and simulated Rician K-factor 
 
 
 
 
29 
The “real data” shown in the below of Fig. 2 is the realistic Rician K-factor value acquired from the real 
measured channel data on the high speed rail train. The “simulation data” shown in the above of figure 2 
shows the simulated Rician K-factor value generated by the constructed hidden Markov model. From figure 2, 
it can be seen that the constructed hidden Markov model is quite fit to the realistic channel for the high speed 
railway in Rician K-factor value, since the duration time of a particular K-factor value are quite similar. Fig. 3 
and Fig. 4 shows the cumulative distribution function (CDF) and the level crossing number of the real 
measured and simulated Rician K-factor value, respectively. It confirms that the distribution of the simulated 
K-factor value generated by hidden Markov model is matched to the realistic K-factor value for the high speed 
railway. Based on this, we can use the hidden Markov model to recognize which part of the channel is 
experienced. Furthermore, the prediction of K-factor value can be achieved by using the hidden Markov 
model. The usage of hidden Markov model for Rician K-factor value prediction and the performance 
improvement of link adaptation will be investigated in next section. 
 
3.4 Simulation setup and numerical results 
A MIMO-OFDM system described in section II is simulated. The MIMO Rician channel are generated 
by firstly generating the Rician K-factor value, then extend the SISO channel to the MIMO channel using 
equation (1). Figure 5 shows the throughput performance of link adaptation assuming the Rician K-factor 
value is uniformly random between 3.3dB, 13.7dB, and 24dB. The modulation order, coding rate, and the 
MIMO transmission mode is selected using table I.  
From Fig. 5, it can be seen that the throughput performance of link adaptation in MIMO systems can be 
achieved by exploiting Rician K-factor. Though the throughput performance can be achieved up to 75 Mbps in 
figure 5, it is assumed that the Rician K-factor value is static during the feedback time. To evaluate the 
throughput performance of link adaptation for the high speed rail environment, the real measured Rician 
K-factor value is used and further extended to the MIMO channel for throughput performance evaluation. The 
channel state feedback time in our simulation is set as 0.5 seconds, that is the link adaptation is selected 
according to the Rician K-factor value of 0.5 seconds ago for non-prediction case. Perfect channel state 
feedback is assumed here. For the prediction method, the link adaptation is selected according to the predicted 
 
 
 
31 
 
3.5 Conclusions 
A link adaptation scheme by exploiting the Rician channel K-factor for MIMO-OFDM systems is 
considered in this paper. A hidden Markov model of generating Rician K-factor value for high speed railway 
is constructed by using real measured channel data on the high speed rail train. By using the hidden Markov 
model, the Rician K-factor value can be predicted to facilitate link adaptation. Simulation result shows that the 
average throughput of link adaptation can be improved 5Mbps. Throughput of 10Mbps can be improved for 
the maximum throughput of the hidden Markov model based prediction method compares to none prediction 
case. 
 
3.6 Reference 
[1] D. N. C. Tse and L. Zheng, “Diversity and multiplexing: a fundamental tradeoff in multiple-antenna channels,” 
IEEE Trans. Info. Th., Vol. 49, pp.1073-1096, May 2003. 
[2] S. Catreux, V. Erceg, D. Gesbert, and R. W. Heath Jr.,“Adaptive modulation and MIMO coding for broadband 
wireless data networks,” IEEE Comm. Mag., Vol. 2, pp. 108-115, June 2002. 
[3] A. Forenza, A. Pandharipande, H. Kim and R. W. Heath, “Adaptive MIMO transmission scheme: exploiting the 
spatial selectivity of wireless channels,” in Proc. IEEE Veh.Technol. Conf., Vol. 5, pp. 3188-3192, May 2005. 
[4] M. Gidlund and P. Ahag, "A CRC-based link adaptation algorithm for IEEE 802.11a Wireless LAN," in Proc. 
Asia-Pacific Conference on Communication, Penang, Malaysia, Sept. 2003. 
[5] Gabriel Martorell1, Felip Riera-Palou and Guillem Femenias, "Cross-Layer Fast Link Adaptation for 
MIMO-OFDM Based WLANs," Wireless Personal Communications, Springer Verlag 
[6] Jia Tang and Xi Zhang, "Link-Adaptation-Enhanced Dynamic Channel Allocation for MIMO-OFDM Wireless 
Networks," WCNC 2005. 
[7] M. gidlund, "A sub-optimal eigenvalue-based adaptive modulations scheme for broadband MIMO-OFDM systems, 
in CNSR,08, Canada. 
[8] Kwan, R. and Leung, C., “Performance of a CDMA system employing AMC and multicodes in the presence of 
channel estimation errors,” IEEE Trans. on Comm., Vol. 56, pp. 189-1963, Feb. 2008. 
[9] Y. Wang, Q. Cui, X. Tao and M. Zhou, “Robust AMC Scheme Against Feedback Delay in Vehicular 
Environment,” IEEE International Conference on Communications, ICC ’09, June 2009, pp. 1-5. 
[10] Feng Huaping, et al., “A Threshold Optimizing Method Based on Markov in AMC Combined with HARQ,” IEEE 
WiCOM 2006.  
 
 
 
33 
第四章 提升高鐵無線傳輸系統通道容量的分散式天線佈建方法 
 
4.1 Introduction 
MIMO is an attractive technique for increasing channel capacity. However, it relays on spatially 
independent channels for simultaneous data transmission. Therefore, the spatial channel correlation will 
degrade the MIMO capacity [1-2]. For an isotropic channel environments, the spatial multiplexing gain can be 
achieved by assuming independent and identically distributed (i.i.d) Rayleigh fading channel [3]. Nevertheless, 
in the LoS channel, the channel correlation is increased as increasing Ricean K-factor [4-5]. As a result, the 
MIMO capacity is reduced while in a high Ricean K-factor channel [6] and it also occurs for the HSR radio 
communications. 
The MIMO channel capacity over the LoS channel has been investigated in several literatures [7-10]. To 
improve the MIMO channel capacity over the LoS channel, there are two basic methods. The first class is 
straightforward by using repeaters as scatters to create some artificial paths to increase spatial multiplexing 
gain [11-13]. Some analysis on the effect of the placement of repeaters for the channel capacity has been 
presented in [14-16]. Although the repeater-aided capacity enhancement scheme can improve the capacity 
gain for the LoS channel and provide a higher coverage, it requires extra cost for deploying repeaters and 
backhauls. Moreover, the delay spreads will be another issue to take into account. 
The second class for the MIMO channel capacity improvement over the LoS channel is by designing a 
suitable antenna spacing to achieve a full rank channel matrix [17-21]. An optimal channel matrix form for 
achieving maximum channel capacity in a MIMO LoS channel was investigated in [8]. Furthermore, a 
capacity maximizing criterion in terms of MIMO geometric architecture was proposed in [19]. The optimal 
antenna spacing for the deployment of MIMO system can be derived through the criterion. However, the 
above mentioned criterion is derived for the scenario of indoor fixed transmission. Based on [19], the author 
extends the capacity maximizing criterion to an outdoor environment. It reveals that a large spacing of 
antenna elements is required for the small element spacing of mobile devices and the long propagation 
distance of outdoor scenario. Therefore, a distributed MIMO system was proposed to maximize channel 
 
 
 
35 
where LoSH  denotes the LoS component, ScatH  denotes the scattered waves and K denotes the Ricean 
K-factor. The LoS component is modeled by a free-space response given with the following form 














=
⋅⋅−⋅−
⋅−
⋅−⋅−⋅−
tNrNrN
tN
djkdjk
djk
djkdjkdjk
LoS
ee
e
eee




1
21
11211
H                       (4) 
where mnd  represents the propagation distance of the m
th transmitting element to the nth receiving element, 
and k denotes the wave number with λp2=k , λ  represents the wave length. Note that the path loss difference 
between antenna elements is assumed negligible in (4) and the scattered waves are modeled by 
tr NN
Scat C
×∈ H with its elements )10(~ ,CNhij . 
 
4.3 MIMO systems for HSR scenarios 
4.3.1 Regular MIMO systems 
Fig. 1 illustrates the configuration of a regular 2x2 MIMO system in HSR environment. According to the 
structure of Taiwan HSR trains, there are two spaces on the roof of HSR trains for antenna placement with the 
spacing of 14.5 meters. For the regular MIMO systems, it is assumed that the transmitting antennas are both 
located at the base station (BS).  The free-space response of LoS channel for the regular 2x2 MIMO systems 
can be evaluated through (4) given with the corresponding configuration of Fig. 1. 
 
Fig. 1.  A regular 2x2 MIMO system for HSR radio communications. 
 
 
 
 
37 


















++⋅+⋅
⋅+⋅++
=  
)(1)(
)()(1
  log 2
22
2
21
*
1222
*
1121
*
2212
*
2111
2
12
2
11
2
hhhhhh
hhhhhh
C
tt
tt
NN
NN
rr
rr
                (6) 
for 





=
2221
1211
hh
hh
H . Considering the free-space channel response, ijdjkij eh
⋅−= , and substituting it into (6), the 
channel capacity of 2x2 MIMO system can be simplified and to be reformulated as the following form 
.  ) )()cos1(241 (log 22
tt NN
C rr q ⋅−⋅+⋅+=                      (7) 
where )( 21122211 ddddk −−+⋅=q . According to (7), it can be observed that the channel capacity of a 2x2 
MIMO system is maximized when 1cos −=q . So, the maximum capacity is achieved when 
pq ⋅+=−−+⋅= )12()( 21122211 qddddk , where q belongs to an integer. Referring to the distributed MIMO system 
configuration of Fig. 2, the LoS distance can be approximated to , 11 dd ≈ , 22 rxdPd ∆−−≈  , 12 　dPd −≈  and 
rxdd ∆+≈21  while hd >> . It results in rxdddd ∆−≈−−+ 2)( 21122211  and yields the capacity maximization 
criterion as .  )12()2( p⋅+=∆−⋅ qk rx  Therefore, the criterion for maximization channel capacity of the 
distributed 2x2 MIMO system for HSR train is derived as 
.  
4
)12( ' λ⋅+
=∆
q
rx                               (8) 
where 'q  is an integer. 
 
4.4.2 Simulation results 
The channel capacity of the proposed distributed MIMO system is evaluated by applying the following 
parameters with the proposed capacity maximizing criterion. Assuming the carrier frequency is set to 
GHz 5.2=cf ( m12.0=λ ) and the signal-to-noise ratio (SNR) is at dB 20=r . The transmitting antenna height is 
considers as mh 5=  and the distributed antenna element spacing is mP 1000= . Based on the physical 
configuration of Taiwan HSR train and the capacity maximization criterion of (8), the optimized receiving 
antenna element spacing is obtained as . 49.14 mrx =∆  
  Figure 3 presents the channel capacity applying the optimized receiving antenna element spacing. The 
ergodic capacity evaluated by Monte-Carlo simulation is also provided in Fig. 3 to verify the derived capacity 
 
 
 
39 
the transmitting antenna element spacing for the regular 2x2 MIMO system is mtx  1=∆ . The result shows that 
the regular MIMO system suffers low channel capacity over the LoS channel for the HSR radio 
communications. In the figure, the maximum 2x2 MIMO capacity can achieve 13.32 bps/Hz for dB 20=r  
while the capacity of the regular MIMO system is only 8.15 bps/Hz. For the proposed distributed MIMO 
system, there is a 80% of the range that the channel capacity can get more than 13 bps/Hz. 
0 100 200 300 400 500 600 700 800 900 1000
7
8
9
10
11
12
13
14
d  (m)
C
  (
bp
s/
H
z)
 
 
Regular 2x2 MIMO
Distributed 2x2 MIMO
Idealy maximized
 
Fig. 4.  Channel capacity comparison of the regular and the distributed MIMO system. 
 
Figure 5 further shows the channel condition number of the channel matrix corresponding to the regular 
and the distributed MIMO system. The channel condition number is defined as 
                       )(
)(
*
min
*
max
HH
HH
λ
λ
κ =                                 (9) 
where λmax and λmin represents the maximum and minimum eigenvalues of the channel matrix H. The 
higher value of channel condition number corresponds to a higher channel correlation. This explains why the 
regular MIMO system experiences a low channel capacity for the HSR radio communications. For the 
proposed distributed MIMO system, the channel condition number can be preserved at low values during 
 
 
 
41 
deployment strategy is given in Fig. 7. The blue line depicts the capacity of the distributed MIMO system of 
BS#1 and the red line represents the case of BS#2. As shown in the figure, for each distributed MIMO system 
they all suffer an unstable channel capacity region. However, making them overlap together, the 
communications of the HSR train can handover to next BS to maintain a stable data transmission with a 
continuously maximized channel capacity. 
 
 
Fig. 6.  Deployment of distributed MIMO system for HSR radio communications 
   
 
Fig. 7.  Channel capacity with 2 overlapping distributed MIMO system. 
 
 
 
43 
Environment,” in Proc. of the 2007 IEEE Global Telecommunications Conference (GLOBECOM 2007), pp. 
3623-3628, 26-30 Nov. 2007. 
[9]  K. Sakaguchi, H. Y. E. Chua, and K. Araki, “MIMO channel capacity in an indoor Line-Of-Sight (LOS) 
environment,” IEICE Trans. Commun., vol. E88-B, no. 7, pp. 3010-3019, Jul. 2005. 
[10] M. Matthaiou, P. de Kerret, G. K. Karagiannidis, and J. A. Nossek, “Mutual information statistics and 
beamforming performance analysis of optimized LoS MIMO Systems,” IEEE Tran. Commun., vol. 58, no. 11, 
pp. 3316-3329, Nov. 2010. 
[11] B. Wang, J. Zhang, and A. Host-Madsen, “On the capacity of MIMO relay channels,” IEEE Trans. Inf. Theory, 
vol. 51 nol. 1, pp. 29–43, Jan. 2005. 
[12] M. Matthaiou, Y. Kopsinis, D. I. Laurenson, and A. M. Sayeed, “Ergodic capacity upper bound for dual MIMO 
Ricean systems: simplified derivation and asymptotic tightness,” IEEE Trans. Commun., vol. 57, no. 12, pp. 
3589-3596, Dec. 2009. 
[13] C. Zhong, M. Matthaiou, G. K. Karagiannidis, and T. Ratnarajah, “Generic ergodic capacity bounds for 
fixed-gain AF dual-hop relaying systems,” IEEE Trans. Veh. Technol., vol. 60, no. 8, pp. 3814-3824, Oct. 2011. 
[14] L.-S. Tsai and D.-S. Shiu, “Capacity scaling and coverage for repeater-aided MIMO systems in line-of-sight 
environments,” IEEE Trans. Wireless Commun., vol. 9, no. 5, pp. 1617-1627, May 2010. 
[15] Y. Zhao, L. Huang, T.-Y. Chi, S.-Y. Kuo, and Y. Yao, “Capacity analysis for multiple-input multiple-output 
relay system in a low-rank line-of-sight environment,” IET  Communications, vol. 6, no. 6, pp. 668-675, Apr. 
2012. 
[16] B. T. Walkenhorst, and M. A. Ingram, “Repeater-assisted capacity enhancement (RACE) for MIMO links in a 
Line-of-Sight environment,” IEEE International Conference on Communications (ICC), pp. 1-6, 14-18 June 
2009. 
[17] I. Sarris and A. Nix, “Design and performance assessment of high capacity MIMO architectures in the presence 
of a line-of-sight component,” IEEE Trans. Veh. Technol., vol. 56, no. 4, pp. 2194–2202, Jul. 2007. 
[18] F. Bohagen, P. Orten, and G. E. Oien, “Design of capacity-optimal high-rank line-of-sight MIMO channels,” 
IEEE Trans. Wireless Commun., vol. 6, no. 4, pp. 1420–1425, Apr. 2007. 
[19] I. Sarris and A. Nix, “Design and performance assessment of maximum capacity MIMO architectures in 
line-of-sight,” IET  Communications, vol. 153, no. 4, pp. 482- 488, Aug. 2006. 
[20] K. Nishimori, N. Honma, T. Seki, and K. Hiraga, “On the transmission method for short-range MIMO 
Communication,” IEEE Trans. Veh. Technol., vol. 60, no. 3, pp. 1247-1251, Mar. 2011. 
[21] M. Matthaiou, A. Pitarokoilis, and J. A. Nossek, “Mutual information statistics of optimized LoS MIMO 
systems,” IEEE International Conference on Communications (ICC), pp.1-5, 23-27 May 2010. 
[22] I. Sarris and A. R. Nix, “A Line-of-Sight Optimised MIMO Architecture for Outdoor Environments,” in Proc. 
IEEE Veh. Technol. Conf, pp. 1-5, 25-28 Sept. 2006. 
[23] B. Chow, M.-L. Yee, M. Sauer, A. Ng'Oma, M.-C. Tseng, and C.-H. Yeh, "Radio-over-Fiber distributed antenna 
system for WiMAX bullet train field trial," in Proc. IEEE Mobile WiMAX Symposium, 2009, pp.98-101, 9-10 July 
2009. 
 
 
 
45 
國科會補助專題研究計畫成果報告自評表 
請就研究內容與原計畫相符程度、達成預期目標情況、研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）、是否適
合在學術期刊發表或申請專利、主要發現或其他有關價值等，作一綜合評估。 
1. 請就研究內容與原計畫相符程度、達成預期目標情況作一綜合評估 
  達成目標 
□ 未達成目標（請說明，以 100字為限） 
□ 實驗失敗 
□ 因故實驗中斷 
□ 其他原因 
說明： 
 
 
 
2. 研究成果在學術期刊發表或申請專利等情形： 
論文：■已發表 □未發表之文稿□撰寫中 □無 
專利：□已獲得 ■申請中 □無 
技轉：□已技轉 □洽談中 ■無 
其他：（以 100字為限） 
 
 
 
3. 請依學術成就、技術創新、社會影響等方面，評估研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）（以
500字為限） 
 
現代人的生活對於傳輸速率與傳輸品質要求甚高，但是由於無線通訊環境的複雜性，
不同環境對於傳輸的品質與傳輸的速率有不同影響，所以要在不同的環境維持一定的傳輸
速率與品質為未來無線通訊發展的重要議題。本研究成果考慮多種多輸入多輸出架構在不
同的通道環境下，探討在可能造成傳輸效能損失的情況下，提出一種以萊斯通道K參數來
代表通道品質指標，並利用此K參數的大小對傳輸的調變、通道編碼還有多輸入多輸出架
構進行適應性的切換，使得傳輸時可以在能接受的錯誤率範圍內達到最高的資料吞吐量。 
    
 
 
 
 
47 
產業別 電子業、電信業 
技術/產品應用範圍 高鐵列車無線數位通訊系統 
技術移轉可行性及預期
效益 
 
  在強烈的直視波無線通道環境中，並不適合多輸入多輸出架構
進行空間多工的資料傳送，使得在空間多工模式下的多輸入多輸
出架構，無法真正達到提升資料傳輸量的目的，利用本研究成果，
可隨著不同通道環境選擇適當的多輸入多輸出架構模式、調變與
通道編碼碼率有效提升訊號的傳輸速率，並在各種不同訊號與雜
訊比例情況下保持一定的傳輸品質。 
 
     註：本項研發成果若尚未申請專利，請勿揭露可申請專利之主要內容。 
表 Y04 
間干擾，藉由封包傳送失敗進行重傳時，對重傳的封包進行編碼，藉以消除載波間的干
擾，在發表結束後的 Q&A 時間，在場學者提問說: 在我們的模擬環境中提到了車速移
動通道模型，但是卻未給定移動車速是多少? 我回答說:因為我們考慮的是固定頻率偏
移引起的載波間干擾效應，因此只採用了車速移動通道模型的路徑延遲功率表。另外會
場主席提問說: 本干擾消除方法是否假設在相同的通道衰減下? 我回答說: 在相同的通
道衰減下，載波間干擾可以完全消除，但是在模擬上我們採用具有多重路徑延遲的通道
模型，所呈現的實際效能，並非在平坦通道的假設下。 
 
2. Decentralized Multiuser Beamforming for Cellular Communication Systems 
本論文提出一非中央管理式之多用戶波束合成系統，本方法最大特點為各用戶計算
本身之波束合成權重係數再回傳給基地台，不需要像傳統方法各自回傳通道資訊給基地
站台，再由基地站台計算各用戶之波束合成權重係數，在給定的條件下，本方法可降低
50%的回傳資訊量。在提問時間中，在場學者專家針對我們的分散式分法提出了意見，
由於我們的方法需要透過基站交換不同使用者間的通道資訊，因此，他對於我們的分散
式方法不認為是完全的分散式，但是我們的方法能降低回傳資訊量，並且可由用戶自行
計算波束合成權重係數，因此仍可說是某種程度上的分散式方法。 
 
藉由參加本次會議，讓我了解到各地學者的研究情況與研究態度，此外，藉由發表
論文後的提問討論，讓我能有不同的角度去思考問題，激盪出不同的想法。 
 
 
三、考察參觀活動(無是項活動者省略) 
無。 
 
 
四、建議 
無。 
 
 
五、攜回資料名稱及內容 
 
會議議程表與論文電子檔一份。 
 
 
六、其他 
 
國科會補助計畫衍生研發成果推廣資料表
日期:2012/10/16
國科會補助計畫
計畫名稱: 高鐵上WiMAX系統通道特性分析與效能提昇技術研究
計畫主持人: 林信標
計畫編號: 98-2221-E-027-036-MY3 學門領域: 通訊
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
無 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
