 2 
中文摘要 
本計畫旨在針對 4G 系統實體層之通道編解碼、MIMO 調變/解調器作最佳化設計以達到
最高的品質，研究的議題包括新型映射法則(mapping rule)，最佳 MIMO RF 參數估計/補
償，新型低複雜度 MIMO 偵測器設計等。研究成果已發表成 2 篇 IEEE 期刊論文[1][2]， 6
篇會議論文[4]-[9]及另有一篇投稿中論文 [3]。 
關鍵詞: 4G 系統、MIMO, 射頻參數補償、低複雜度偵測器 
1. Chih-Cheng Kuo, Sheen W-H and Chang-Lung Hsiao, “New Factorization Algorithms for 
Channel-Factorization Aided MMSE Receiver in MIMO Systems,” IEICE Trans. 
Communications, accepted, October 2010. 
2. Chen Jiu Hsu, Racy Cheng and Sheen W-H, “Joint Least-Squares Estimation of Frequency, 
DC-offset, I-Q Imbalance and Channel in MIMO Receivers,” IEEE Trans. Vehicular 
Technology, vol. 58, issue 5, pp. 2201–2213, June 2009.  
3. Chen Jiu Hsu and Sheen W-H “Estimation and Cancellation of Transmitter and Receiver 
Radio Impairments in MIMO-OFDM Systems with Direct-Conversion Architecture,” IEEE 
Trans. Wireless Communications, December, 2010. (in revision) 
4. Chen Jiu Hsu, and Sheen W-H, “Compensation of Cascaded Radio Impairments in 
MIMO-OFDM Systems with Direct-Conversion Architecture,”  in Proc.  Global Mobile 
Congress, Shanghai, China, October 2010. 
5. Chen Jiu Hsu, and Sheen W-H, “A New Self-Calibration Method for Transmitter and 
Receiver Radio Impairments in Direct-Conversion Architecture,” in Proc. IEEE Globecom, 
Miami USA, December 2010. 
6. Tsang-Wei Yu, Chung-Hsuan Wang, and Sheen W-H, “A Pragmatic Labeling Design of 
MIMO BICM-ID Systems Based on EXIT Chart,” in Proc. IEEE PIMRC'09, Tokyo, Japan, 
September 2009. 
7. Chen Jiu Hsu, and Sheen W-H, “Joint Estimation and Compensation of Transmitter and 
Receiver Radio Impairments in MIMO-OFDM Receivers,” in Proc. IEEE PIMRC'09 ,Tokyo, 
Japan, September 2009. 
8. Chen Jiu Hsu, Sheen W-H, and Racy Cheng, “Joint Estimation and Compensation of 
Frequency, DC-offset, I-Q Imbalance and Channel in MIMO Receivers”, in Proc. IEEE 
ICASSP’09, pp. 2533-2536, Taipei Taiwan, April 2009.  
 4 
6. Tsang-Wei Yu, Chung-Hsuan Wang, and Sheen W-H, “A Pragmatic Labeling Design of 
MIMO BICM-ID Systems Based on EXIT Chart,” in Proc. IEEE PIMRC'09, Tokyo, Japan, 
September 2009. 
7. Chen Jiu Hsu, and Sheen W-H, “Joint Estimation and Compensation of Transmitter and 
Receiver Radio Impairments in MIMO-OFDM Receivers,” in Proc. IEEE PIMRC'09 ,Tokyo, 
Japan, September 2009. 
8. Chen Jiu Hsu, Sheen W-H, and Racy Cheng, “Joint Estimation and Compensation of 
Frequency, DC-offset, I-Q Imbalance and Channel in MIMO Receivers”, in Proc. IEEE 
ICASSP’09, pp. 2533-2536, Taipei Taiwan, April 2009.  
9. Chih-Cheng Kuo, Sheen W-H and Chang Lung Hsiao, “MMSE Channel Factorization for 
Near Maximum-Likelihood Detection of MIMO Signals,” in Proc. 2008 IEEE International 
Symposium on Information Theory, pp. 579-583, Toronto, Canada, July 2008. 
 
 6 
significantly inferior to that of the ML detector.
 
1. Throughout this paper, bold capital letters denote matrices and small letters denote vectors. 
( )H  and  ( )T  represent the 
operations of conjugate transpose and transpose of a matrix or vector, respectively, and ( )
  denotes the complex conjugate of a 
complex value. 
 
Recently, channel-factorization aided detectors (CFAD) have been proposed to narrow the 
performance gap between the ML and traditional reduced-complexity detectors [10-19], where 
channel factorization is done with lattice-reduction algorithms such as the 
Lenstra–Lenstra–Lovász (LLL) [20,21] and Seysen’s algorithms [22,23]. Thus, the method is 
also called the lattice-reduction aided detector, LRAD. (In this paper, we prefer to use the term 
CFAD because the channel factorization is not necessarily done with a lattice-reduction 
algorithm.) In particular, in [10-13], the LLL-based LRAD was proposed to improve performance 
over the conventional zero-forcing (ZF) MIMO detector. The authors of [14-16] proposed the 
MMSE-based LRAD to further improve its ZF counterpart. Later on, the LLL algorithm was 
proposed to operate on the dual lattice rather than the original lattice to reduce effective noise 
power [17,18]. In addition, the Seysen’s algorithm [23] which simultaneously reduces lattice 
basis and its dual was proposed to improve the performance of the LLL algorithm. Lastly the 
authors of [19] conducted a comprehensive performance comparison on the reduction algorithms 
mentioned above.  
Traditionally, the channel factorization algorithms in a lattice-reduction aided detector 
(LRAD) are designed somewhat intuitively; neither a specific detector nor a cost function is 
involved in search of good factorization algorithms. The LLL and Seysen’s algorithms were 
employed in previous works to obtain a relatively short (orthogonal) basis with no consideration 
of the low-complexity detector used. In this work, a new approach is proposed: the factorization 
algorithm is designed specifically for the MMSE detector with the aim to minimize the cost 
function of sum mean-squared-error (MSE). Two new types of factorization algorithms are 
proposed. Type-I is LLL-based, where the best-performed factorization algorithm found in the 
literature, i.e., the DLLL-extended algorithm, is a member of this type but with a higher 
 8 
2
2
4 ( 1)
4 4
( 1) 4
1
1
1
1
n
R
n
  
 
  

  


 
 
 
 
 
 
 
 
J

 

   

,                                   (3) 
with 0 1  . Note that 0.0   gives the uncorrelated channel and 1.0   gives the fully 
correlated one.  
The signal vector mx  has independent and identical distributed (i.i.d.) entries with the 
power constraint 
2 2
xE m   
x , where 
2
 denotes the squared Euclidean norm, and 
 1
T
nw w w  is a circularly symmetric complex Gaussian vector with the correlation matrix 
2E H w n   ww I . x  and w  are independent of each other, and nI  denotes the n n  identity 
matrix. 
Basically, a linear detector is to find an ˆ mx  that is closest to the filtered vector HB y , 
i.e.,  
 2arg min  
m
H HQ

     x
x B y x B y ,                                     (4) 
where 
H
B  is the receive filter, and  Q   is the operation of rounding its argument to the 
nearest ˆ mx . For the MMSE linear detector, 
1
2
2
H
H Hw
m
x


  
  
   
B = H H I H [6-9]. Without 
considering the effect of noise, i.e., 
2
2
0w
x


 , the detector degenerates to ZF linear detector, where 
inter-symbol interference in y  is cancelled completely. It is well known that linear detectors 
suffer from severe noise enhancement in an ill-conditioned channel and have diversity order of 
1n m   which is less than the full diversity order n  [6-9].  
 
III. CHANNEL-FACTORIZATION AIDED DETECTION 
In the literature, LRAD has been proposed to improve the performance of the traditional 
 10 
The LLL algorithm is well-known for searching a good factorization H HD . Through size 
reduction and reordering of the sequence of basis vectors, a relatively short (orthogonal) basis 
can be found with a polynomial time complexity [20,21]. The complex version of the LLL 
algorithm in [24] is summarized in Table 1. The LLL algorithm can be applied to the primal 
lattice [10-16] generated by the generator matrix H , the dual lattice [17,18] generated by the 
generator matrix  
1
#
H
H H
 
  
H H H H , and the extended lattice generated by 
w
m
x


 
 
 
  
H
H
I
  
[14]. Seysen’s algorithm (SA) is another popular lattice-reduction algorithm for the channel 
factorization [22,23]. Since SA reduces the primal and dual lattices simultaneously, it has a 
similar performance as that of LLL applied to the dual lattice, as to be shown in Section V. Very 
recently, it was reported in [19] that the LLL algorithm applying on the dual lattice 
#
H  and the 
SA algorithm on H  give the best performance if the MMSE detector is used as the 
low-complexity in Figure 2 to obtain the initial estimate z . In Figure 2, the slicer is used to 
lower the detection complexity [16], which is perfectly fine for an infinite constellation because 
m z Dx  for mx . For a finite constellation, however, there is boundary error effect; that is, 
-1
D z  may not belong to m . This explains why (6) is needed for the final detection.  
 
IV. THE PROPOSED FACTORIZATION ALGORITHMS FOR CFAD-MMSE DETECTOR 
Traditionally, the LLL and Seysen’s algorithms are used in CFAD for the channel factorization 
H HD  with no consideration of which type of low-complexity detector is used in the z-domain 
detection. In this section, we propose a different approach: channel factorization is designed 
specifically for the CFAD-MMSE detector, and thus improve the detector performance of the 
detector either in bit error rate or detector complexity over other channel factorization methods in 
the literature.  
 12 
    
  
H   
 
H U V
0

,                                                    (11) 
where U and V  are unitary matrices with dimension of n n  and m m , respectively, and 
 1 2diag , , , m      is an m m  diagonal matrix with the singular values 
0,  1,...,k k m   . Using (11), the matrix A  becomes  
HA   ,                                                          (12) 
where 1/ 2 H V   is an m m  nonsingular matrix, and 
 
2 2 2 2 2 2
2 2 2 2 2 2 2 2 2
1 2
diag , , ,w x w x w x
x w x w m x w
     
     
 
  
      
 .                         (13) 
More generally, we have the following lemma. 
Lemma 1:  With   in (12), HA C C  if and only if C = P , where H mP P = I  is an l m  
matrix with l m .  
Proof: For the if part,  
HH HC C = P P      . For the only if part, using (12), one gets 
H H
C C =   . Since   is nonsingular, 1H H m
  C C I  . Identify 1P = C , the proof is done.  
In addition, C = P  is full column-ranked due to that   is nonsingular and P  is full 
column-ranked.  
Define 1 2
H
m
    D d d d , that is kd  is k-th column vector of matrix 
H
D . Using 
HA C C , the sum MSE becomes 
 
1
2
1
                 =
        
m
H H
MMSE k k
k
m
k
k
tr




Φ d C Cd
Cd ,                                            (14)                                         
where , 1, ,k k m  Cd  are lattice points of the lattice 
1
= ,
m
k k k
k
x x

 
  
 
C v  v = c , generated 
by the generator matrix  1 m  C c c . Furthermore, , 1, ,k k m  Cd  are linearly independent 
since 
H
D  is unimodular and C  is full column-ranked, and therefore  
1
m
k k
Cd  is a basis of the 
 14 
C. Type-II Algorithms (greedy-search based) 
A greedy-search algorithm is proposed here as an alternative to Type-I to obtain an 
approximate solution of (10). As to be shown in Section V, this algorithm performs better than 
Type-I and has a fixed computational complexity which is considered to be advantageous in 
hardware implementation.  
Using 1 2
H
m
    D d d d , the sum MSE can be rewritten as 
 
1 1
m m
H
MMSE k k k
k k
tr mse
 
  Φ d Ad ,                                      (16) 
where 
H
k k kmse d Ad . In this algorithm, firstly we observe that 
H
k k kmse d Ad  depending only 
on kd , 1,...,k m . Therefore, the updating of the matrix 
H
D  can be done one column at a time 
to minimize kmse , from the first to the last column. This iteration can be repeated again and 
again until no improvement is possible, starting from H mD = I .  
Without loss of generality, consider that the kth-column of HD  is to be updated. A new 
column vector ,newkd  is proposed as 
,new 1 1 1 1 1 1k k k k k k m m            d d d d d d  ,                     (17) 
where  m m k   are parameters to be optimized to lower kmse . It is shown in Appendix C that 
new 1 1 ,new 1,..., , , ,...,
H
k k k m 
   D d d d d d is unimodular provided that
H
D is unimodular, and 
 m m k   are complex integers. With this new ,newkd , ,newkmse  is given by  
,new ,new ,new
1
1 2
2
  
           1   1
H
k k k
H H
mse 
 
 
     
 
 
d A d
α
α α R
α
 ,                                           (18) 
where 1 1 1
T
k     α ,  2 1
T
k m    α , and 
HR DAD . Define 
1
1
H
H
k
 
 
  
 
 
1
d
D
d
  and 
 16 
and  
1,opt
,new
2,opt
1Hk
 
 
  
 
 
α
d D
α
.                                                   (24) 
Generally, the elements of , optk  are not complex integers and thus need to be rounded to ones 
in order to keep HnewD  a unimodular matrix (see Appendix C). Denote  opt,k jα  be the rounding 
operation on the jth element of the vector opt,kα , where more than one rounded values can be 
retained in order to improve performance,  ψ
k j
 
 α
 be the set of retained complex integers in the 
rounding  opt,k jα , and   1 1 1 ,  ψk k j
T
k k k m j        
       
α
=  . Then, the final α  to 
be used in updating can be obtained by 
1
upd
1 2
Ψ
2
arg min  1   1
k k
H H

 
 
    
 
 
αα
α
α α α R
α
                                     (25) 
In our experience with extensive simulations, ψ 2
k
j
 
 

α
 provides very little improvement, 
where ψ
k
j
 
 α
 is the cardinality of the set ψ
k
j
 
 α
. Therefore, ψ 2,   
k
j
j
 
 
 
α
 will be used in all 
discussions regarding Type-II algorithms. Consider the example of 4m n  . If  
 ,opt 0.3 0.6 ,  0.4 0.1 ,  0.7 0.9
T
k i i i    α , where 1i   , then  
1
ψ ,  0
k
i
  

α
, and 
 
2
ψ 0,  1
k  

α
, and  
3
ψ 1 ,  
k
i i
  
 
α
, and it leads to  
0 0 0 0
0 , 0 , 1 , 1 , 0 , 0 , 1 , 1
1 1 1 1
k
i i i i
i i i i i i i i
                
                                  
                                   
 .                     (26) 
Finally, the new update of kd  is given by    
H
upd upd
,upd 1 2 1 
H
H
H
k
 
  
d D α α , and 
,upd ,upd ,upd  
H
k k kmse  d A d , if ,updk kmse mse . Otherwise, no update is performed and kd  remains 
no change. The complete algorithm is summarized in Table 3, where the algorithm is terminated 
 18 
is, H  remains unchanged over a frame and changes independently from frame to frame. Signal 
to noise power ratio (SNR) is defined as 2 2x wm   . A total of five factorization algorithms are 
considered, including the LLL (LLL-extended [14]) and Syesen’s algorithms (SA-extended 
[19,23]) working on H , the LLL algorithm working on the dual matrix of H  (DLLL-extended 
[18,19]), and the proposed Type-I and Type-II algorithms. It has been shown in [19] that 
reduction working on H  outperforms that on H . Therefore, only those algorithms working on 
H  are compared here. The complex version of the LLL algorithm in Table 1 (with 0.999  ) is 
used in all channel factorization methods that use LLL, where    stands for the operation of 
rounding its element to the nearest complex integer. The Cholesky decomposition is used to 
obtain 
H
A = C C  in Type-I algorithm, and ψ 2
k
j

 
 
 
α
 in Type-II algorithm.  
The bit-error-rate (BER) for uncorrelated MIMO channels ( 0.0  ) are compared first. Figure 3 
shows the effect of iteration number IN  on the BER performance of Type-II Algorithm for the 
case of 6m n  . As can be seen, there is almost no performance improvement with 3IN  . 
As a result, we use 3IN   for the subsequent comparisons. Figures 4, 5, 6 and 7 show the 
comparisons between different channel factorizations for the cases of 2m n  , 4m n  , 
6m n  , and 8m n   respectively. In these figures, the performance of conventional 
(non-factorized) MMSE detector and optimum maximum-likelihood (ML) is also provided for 
reference. With smaller numbers of antennas, e.g., 2,  4m n  , all the considered channel 
factorization algorithms perform similarly especially for 2m n  ; the CFAD, however, 
provides significant improvement over the conventional MMSE detector. As expected, 
DLLL-extended and Type-I have the same performance because DLLL-extended is a member of 
the Type-I algorithms, as discussed in Section IV. SA-extended performs closely to Type-I and 
outperforms LLL-extended by about 1.5-2.5 dB at 
4BER 10  for 6,  8m n  . Type-II has 
the best performance with a 0.5 dB gain margin over Type-I (DLLL-extended) and SA-extended. 
In addition, it is evidently that CFAD detectors are capable of attaining the same diversity order, 
 20 
detection) is compared specifically when Type-I, SA-extended and DLLL-extended are employed 
as the factorization algorithm. Recall that these algorithms have a similar BER performance as 
shown in Figures 4-8. The comparison is made from two aspects: hardware complexity and 
computational complexity per data vector. For data vectors where pilots are located, both channel 
factorization and MMSE detection are required to be performed, and, therefore, for a fixed 
hardware clock rate, extra circuitry is needed for the computation of the factorization algorithm, 
and that increases hardware complexity. Table 7 shows the hardware complexity ratio of channel 
factorization to overall MIMO receiver for the considered factorization algorithms. As is seen, 
the ratio ranges from 44% to 74%. Therefore, how to reduce the complexity of channel 
factorization algorithm is an important issue. In addition, from Table 7, it can be shown that the 
saving of hardware complexity of overall MIMO receiver offered by Type-I ranges from 21% to 
43 %. For example, the saving for SA-extended for the case of  P Q q 0.5   is 
(5804 2904) (2772 2904)
34%
5804 2904
  


.   
The computational complexity per data vector, evaluated by the number of real 
multiplications per data vector cf
MIMO
N
N
p
 , is also employed for comparisons, where p  is the 
number of data vectors in a frame. Figure 11 is such a comparison for  P Q q 0.9  . Similar 
results are observed for 10 and 50 percentiles although they are not shown here for brevity. As is 
shown, the complexity saving by Type-I is quite significant for small p. For example, for 6p   
the savings are 
4307 3479
19%
4307

  and 
3887 3479
11%
3887

  for SA-extended, and 
DLLL-extended respectively. As expected, the complexity saving becomes smaller for larger p. 
In practical mobile cellular systems, channel estimation is usually done for every 0.5 to 1 ms 
in order to cover mobility up to 350 km/hour [30]-[31]. For example, in the 3GPP-LTE 
specification, there are 7 (OFDM) symbols in a slot (0.5 ms) where time-frequency multiplexed 
pilots are used for the cell-specific channel estimation [30]. Also, in the IEEE 802.16m 
 22 
APPENDIX A 
By definition,   
H
MMSE MMSE MMSEE
   
  
Φ G y z G y z , where 
 
1
2
2
H Hw
MMSE m
x



 
  
 
G D H H I H .  
Using 2H x mE    xΦ xx I , and 
2H
w nE    wΦ ww I , we have 
 2 2 2 2 2H H H H H HMMSE MMSE x w n MMSE x MMSE x MMSE x        Φ G HH I G G HD DH G DD  .     (A.1) 
Clearly,
2 2
2 2
H H H Hw w
n m
x x
 
 
   
     
   
H HH I H H I H . Since 
2
2
H w
n
x


 
 
 
HH I  and 
2
2
H w
m
x


 
 
 
H H I  are invertible, it leads to 
1 1
2 2
2 2
H H H Hw w
m n
x x
 
 
 
   
     
   
H H I H H HH I .                           (A.2) 
According to (A.2),  MMSEG  can be rewritten as: 
 
1 1
2 2
2 2
1
2 2 2      
H H H Hw w
MMSE m n
x x
H H
x x w n
 
 
  
 

   
      
   
 
G D H H I H DH HH I
DH HH I
 .                    (A.3) 
Therefore,  2 2 2 H H H HMMSE x w n MMSE x MMSE   G HH I G DH G , and (A.1) becomes 
2 2
1
2
2 2
2
      
H H
MMSE x x MMSE
H H H Hw
x x n
x
 

 


 
 
   
 
Φ DD G HD
DD DH HH I HD
                           (A.4) 
By applying the Matrix Inversion Lemma    
1 11 1 1 1 1
        K K L NK L M NK K LMN  
[27] to (A.4) with 
1 2 H
x
 K DD ,  1 
H
HL D H , 
2
1
2
 w n
x


 M I , and 1
2
1
x
N HD , 
 24 
2 2
, ,i i cq q  and 
2 2
, , 1 1, , , 1 1,μ μi i i i i i i i       c cq q q q  in Operation 2, it concludes that 
 C P  and  CT T . 
 
APPENDIX C 
In this Appendix, we prove that new 1 1 ,new 1,..., , , ,...,
H
k k k m 
   D d d d d d  is unimodular provided 
that HD  is unimodular, where  
,new 1 1 1 1 1 1k k k k k k m m            d d d d d d  .                    (C.1) 
and  m m k   are complex integers.  
Proof:  Recall that 1 1 1,..., , , ,...,
H
k k k m 
   D d d d d d . Using (C.1), 
H H k
new mD D I , where 
k
mI  is 
obtained by replacing the kth-column of mI  with 1 1 1, , ,1, ,
T
k k m           . It is clear 
that  det 1km I . Therefore,      det det det 1H k Hnew m  D I D , and HnewD  is a unimodular 
matrix.  
 
APPENDIX D 
In this appendix, it is proved that the matrix 
H
OAO  is positive definite provided the l m  
matrix O  has full row rank, where l m , and 
1
2
2
2
H w
w m
x




 
  
 
A H H I  .  
Proof: Firstly, 
1
2
2
2
H w
w m
x




 
  
 
A H H I  is positive definite. This can be shown as follows. Let 
2
2
H w
m
x


 X H H I . It is clear that X  is Hermitian and semi-positive definite, i.e., 0H u X u , 
for all 1m  vector u . Suppose 0H u X u , we have 
2
2
0H H Hw
x


 u H Hu u u , and that implies 
mu 0 . Hence, X  is positive definite, and so is  
12
w

A X . Secondly, since A  is positive 
 26 
[10] H. Yao and G. Wornell, “Lattice-Reduction-Aided Detectors for MIMO Communication 
Systems,” in Proc. IEEE Globecom, pp. 424-428, November 2002. 
[11] C. Windpasseinger and R. F. H. Fischer, “Low-Complexity Near-Maximum-Likelihood 
Detection and Precoding for MIMO Systems Using Lattice Reduction,” in IEEE Proc. ITW, 
pp. 345-348, March 2003. 
[12] W. H. Mow, “Universal Lattice Decoding: Principle and Recent Advances,” Wireless 
Commun. Mobile Comput., vol. 3, pp. 553-569, August 2003. 
[13] I. Berengure and X. Wang, “MIMO Antenna Selection with Lattice-Reduction-Aided Linear 
Receivers,” IEEE Trans. Vehicular Technology, vol. 53, pp. 1289-1302, September 2004. 
[14] D. Wübben, R. Böhnke, V. Kühn and K. D. Kammeyer, “Near-Maximum-Likelihood 
Detection of MIMO Systems Using MMSE-based Lattice Reduction,” in Proc. IEEE ICC, 
pp. 798-802, June 2004. 
[15] D. Wübben, V. Kühn and K. D. Kammeyer, “On the Robustness of Lattice-Reduction Aided 
Detectors in Correlated MIMO Systems,” in Proc. IEEE VTC, pp. 3639-3643, September 
2004. 
[16] D. Wübben, R. Böhnke, V. Kühn and K. D. Kammeyer, “MMSE-based Lattice-Reduction 
for Near-ML Detection of MIMO Systems,” in Proc. ITG Workshop on Smart Antennas, pp. 
106-113, March 2004. 
[17] C. Ling, “Approximate Lattice Decoding: Primal Versus Dual Basis Reduction,” in Proc. 
IEEE ISIT, pp. 1-5, July 2006. 
[18] M. Taherzadeh, A. Mobasher and A. K. Khandani, “LLL Reduction Achieves the Receiver 
Diversity in MIMO Decoding,” IEEE Trans. Inform. Theory, vol. 53, pp. 4801-4805, 
December 2007. 
[19] D. Wübben and D. Seethaler, “On the Performance of Lattice Reduction Schemes for MIMO 
Data Detection,” in Proc. IEEE ACSSC, pp. 1543-1538, November 2007. 
[20] A. K. Lenstra, H. W. Lenstra, Jr. and L. Lovász, “Factoring Polynomials with Rational 
Coefficients,” Math. Ann., no. 261, pp. 513-534, 1983. 
[21] C.P. Schnorr and M. Euchner, “Lattice Basis Reduction: Improved Practical Algorithms and 
Solving Subset Sum Problem,” Mathematical Programming, vol. 66, pp.181-191, 1994. 
[22] M. Seysen, “Simultaneous Reduction of a Lattice Basis and Its Reciprocal Basis,” 
Combinatorica, vol. 13, pp. 363-376, 1993. 
[23] D. Seethaler, G. Matz and F. Hlawatsch, “Reduced-complexity MIMO Data Detection Using 
Seysen’s Lattice Reduction Algorithm,” in Proc. IEEE ICASSP, pp. 53-56, April 2007. 
[24] Y. H. Gan and W. H. Mow, “Complex Lattice Reduction Algorithm for Reduced-complexity 
 28 
   
 
2,1
GSO
1 2 1 2 3,1 3,2
,1 ,2 ,3
1
μ 1 0
Input: lattice matrix = .μ μ 1
μ μ μ 1
Output:  and unimodular matrix  such that .
T
T
m m
m m m
 
 
 
         
 
 
  

H h h h QU q q q
H T H HT
   

──────────────────────────────────────
───────────
   
1
, -1 -1 -1 -1 , -1
1.     2,  and 
2.    while ( ) do
3.         μ ,  μ   
4.         update GSO of  based on effective procedures in [20]
5.  
m
m
i i i i i i i i i i
i
i m
 
   
 
  

   
t
T I
t
h h h t t t
H

───────────────────────────
 
 
2 2
, -1 -1 -1
-1 -1
       if μ ,  then
6.              swap  and , swap  and   
7.              update GSO of  based on effective procedures in [20]
8.              max 2, -1  
9.         else
i i i i i
i i i i
i i
 

q q q
h h t t
H
   , ,
10.            for - 2 to 1 do
11.                 μ ,  μ  
12.                 update GSO of  based on effective procedures in [20]
13.            end for
14.            1
15.
i i i j j j j i j i
j i
i i

     
 
h h h t t t
H

       end if
16.  end while
17.  H H
 
 
 
 
 
 
Table 2: The Proposed Type-I Algorithm  
 30 
 
Algorithms 
Computational Complexity 
Initialization Main-body of the Algorithm 
LLL- 
extended 
Operation
s 
Number of real 
multiplications 
Number of real 
additions 
Operations 
Number of real 
multiplications 
Number of real 
additions 
GSO for 
H  
2 3
2
4 4
2 6
n m m
m m
 
 
 
2 3
2
4 4
3
n m m
m m
 
 
 LLL variable variable 
SA- 
extended 
Calculation 
of 
H
H H  
and 
 
1
H

H H  
2
3 2
2 2
2 2
n m n m
m m
  

 
2
3 2
2 2
2 2
n m n m
m m
  

 SA variable variable 
DLLL- 
extended 
Calculation 
of 
#
H  
2
3 2
6 2
2 2
n m n m
m m
  

 
2
3 2
6 2
2 2
n m n m
m m
  

 LLL variable variable 
GSO for 
#
H  
2 3
2
4 4
2 6
n m m
m m
 
 
 
2 3
2
4 4
3
n m m
m m
 
 
 
Calculation 
of  1
H
T  
3 22 2m m  3 22 2m m  
Type-I 
Algorithms 
Calculation 
of A  
2
3 2
2 2
2 2
n m n m
m m
  

 
2
3 2
2 2
2 2
n m n m
m m
  

 
LLL variable variable 
Calculation 
of C  
32
3
m
 
32
3
m
 
GSO for 
C  
22 6m m  2 3m m  
Calculation 
of  1
H

T  
3 22 2m m  3 22 2m m  
Type-II 
Algorithms 
Calculation 
of A  
2
3 2
2 2
2 2
n m n m
m m
  

 
2
3 2
2 2
2 2
n m n m
m m
  

 
IN  and 
ψ
k
j

 
 

α
 
4 3
2
2 6
3 6 14
I
m mN
m m
  
 
 
 
 
4 3 2
1
2 18 6
3 14 18 1
I
m
m m mN
m m  
   
 
    
 
 
 
 
 
Table 5: Computational complexity for obtaining ,updkd  in Type-II algorithms with ψ
k
j

 
 

α
 
 
Algorithm Computational complexity of ,updkd  
Type-II Operations Number of real Number of real 
 32 
points 
 P Q q 0.1   
3686
56%
3686 2904


 
4735
62%
4735 2904


 
2287
44%
2287 2904


 
 P Q q 0.5   
5804
67%
5804 2904


 
5220
64%
5220 2904


 
2772
49%
2772 2904


 
 P Q q 0.9   
8415
74%
8415 2904


 
5897
67%
5897 2904


 
3449
54%
3449 2904


 
 
 
 
1x 1y
mx
nw
1w
ny
11h
nmh
1nh
1mh
 
 
Figure 1 The considered MIMO channel with m  transmit and n  receive antennas. 
 
 
 
 
Factorization on H
x
D
y
w
 1H HD
z z
1
D
MMSE
Detector
Slicer
Equivalent system model
   x
Decision
 
Figure 2 A simplified diagram for the CFAD-MMSE detector. 
 
 34 
16 20 24 28 32
1E-4
1E-3
0.01
0.1
B
E
R
SNR(dB)
m=2, n=2, 16QAM, MMSE-LD,  =0.0
 Conventional
 LLL-extended
 SA-extended
 DLLL-extended
 Type-I
 Type-II
 ML
 
Figure 4 BER comparisons of different channel factorizations for CFAD-MMSE in the case of 
2, 2,  16QAM, =0.0m n   . 
 
 36 
16 18 20 22 24 26 28
1E-4
1E-3
0.01
0.1
B
E
R
SNR(dB)
m=6, n=6, 16QAM, MMSE-LD,  =0.0
 Conventional
 Precoding in [25]
 LLL-extended
 SA-extended
 DLLL-extended
 Type-I
 Type-II
 ML
 
Figure 6 BER comparisons of different channel factorizations for CFAD-MMSE in the case of 
6, 6,  16QAM, =0.0m n   . 
 
 
 
 
 
 
 
 
 
 38 
24 26 28 30 32 34
1E-4
1E-3
0.01
0.1
B
E
R
SNR(dB)
m=8, n=8, 16QAM, MMSE-LD,  =0.6
 Conventional
 LLL-extended
 SA-extended
 DLLL-extended
 Type-I
 Type-II
 ML
 
Figure 8 BER comparisons of different channel factorizations for CFAD-MMSE in the case of 
8, 8,  16QAM, =0.6m n   . 
 
 
 
 
 
 
 
 
 
 
 40 
2000 4000 6000 8000 10000 12000
0.0
0.2
0.4
0.6
0.8
1.0
P
{
Q
 <
 q
}
q (number of real multiplications)
m=6, n=6, SNR=28dB,  =0.0
 LLL-extended
 SA-extended
 DLLL-extended
 Type-I
 Type-II
 
Figure 10 Complexity comparisons of different channel factorization algorithms.   
 
 
 
 
 
 
 
 
 42 
研究成果詳細報告(2) 
 
I. INTRODUCTION 
Using multiple transmit and receive antennas in a wireless communication system, a.k.a. the 
multiple-input multiple-output (MIMO) system, is capable of providing diversity gain, array gain 
(power gain), and/or degree-of-freedom gain over the single-input single-output (SISO) systems 
[1]-[3]. Space-time coding, beam-forming and spatial multiplexing are modes of operations to 
exploit the diversity gain, array gain, and degree-of-freedom gain, respectively. MIMO has been 
one of the key technologies to enable high data-rate, high spectral-efficiency transmission in 
wireless communications.  
Using direct-conversion RF architecture, on the other hand, is a low-cost design that requires 
fewer external components in chip implementation [4][5]. Direct-conversion RF architecture, 
nevertheless, introduces extra RF impairments such as I-Q imbalance and DC-offset in addition 
to frequency-offset that is commonly encountered in all types of RF architectures [4][5]. 
Generally, at the receiver, RF parameters (impairments) need to be estimated and compensated 
from the received signal before it can be forwarded to the next step of signal processing for 
symbol detection and decoding.  
Receiver design with direct-conversion RF has been an important research topic [6]-[19]: first 
for SISO systems [6]-[15] and then extended to MIMO systems [16]-[19]. In [6], 
frequency-independent I-Q imbalance from both transmitter and receiver was investigated along 
with DC-offset. Performance degradation was evaluated, and adaptive compensation schemes 
were proposed by using gradient-type of adaptive algorithms. No frequency-offset was 
considered in the work, though. In [7]-[9], statistical signal processing-based (blind) techniques 
were proposed to adaptively canceling the self-image interference due to frequency-dependent 
[8]-[9] and frequency-independent I-Q imbalance [7], respectively, without considering 
frequency-offset and DC-offset. No training data is needed in these schemes at the expense of 
slow convergence rate.  In [10]-[12], frequency-dependent and independent I-Q imbalances 
were investigated for OFDM (orthogonal frequency division multiplexing) systems at the absence 
of frequency-offset and DC-offset. In [10], I-Q imbalance was compensated by using a simple 
two-tap adaptive frequency-domain equalizer, while in [11] [12], pre- and post-FFT schemes 
were proposed with the former for frequency-independent and the latter for both 
frequency-dependent and independent I-Q imbalances at the receiver; in addition, a pre-distortion 
scheme at the transmitter was proposed in [12] for compensating the transmitter I-Q imbalance. 
In [13], I-Q imbalance was investigated jointly with frequency-offset, where an FIR filter was 
used for compensating frequency-dependent I-Q imbalance and an asymmetric phase 
compensator for frequency-independent one. Gil et al. in [14] developed a joint estimation of 
frequency offset, channel, (frequency-independent) I-Q imbalance and DC-offset in the time 
domain. Under the assumption of white Gaussian noise at the output of sampler, the ML 
(maximum likelihood) criterion was used to derive the solution. Finally, in [15], a joint adaptive 
 44 
where cf  is the carrier frequency, -1j = ,  ,i ks n  is the transmitted k–th block symbols with 
the transmit power  
1
22
,
1
1 t
g
n N
s i k
i n Ng
s n
N N


 


  , gN  is the length of prefix, N  is the length 
of useful data,  Tg t  is the transmit filter with unit power, and sT  is the symbol time. For a 
data-aided estimation as considered here,  ,i ks n  is known perfectly to the receiver. A total of 
1P   training blocks will be assumed in this paper, starting from the zero-th block  0k  .   
Let    2, ,( ) Re cf tj i j ih t h t e  j  denote the channel response from i-th transmit to j-th receive 
antenna, and  ,j ih t  be its base-band equivalent. The band-pass signal received from j-th 
antenna is 
  2( ) Re ( ) ( )cf f tj j jy t y t e w t   j ,  
where    ,
1
( )
tn
j i j i
i
y t s t h t

  ,  20,( ) Re ( ) cf tj jw t w t e  j  is the band-pass additive white 
Gaussian noise and 0, ( )jw t  is its base-band equivalent, f  is the frequency-offset which is 
same for all receive branches, and   denotes the operation of convolution.  
Taking into account the frequency-independent I-Q imbalance at the RF front-end, the 
complex sinusoidal signal coming into the mixer of j-th branch is  
2 2
( ) 2cos(2 ) 2 sin(2 ) c c
f t f t
j c j c j j jc t f t f t e e
          j jj , 
where j  and j  are  the gain and phase imbalance, respectively,  1 jj je     j , and 
 1 jj je    j . Note that j  and j  are different from one branch to another. After down 
conversion, ( )
I
jh t  and ( )
Q
jh t  are the base-band filters used to remove out-of-band noise and 
high-frequency components. If ( ) ( )
I Q
j jh t h t , we say that there exists frequency-dependent I-Q 
imbalance. Frequency-dependent I-Q imbalance is mostly encountered in a wide-band RF 
receiver because it is generally difficult to maintain base-band filters to have the same response 
over a wide frequency range [8][13].   
After a simple manipulation, the base-band signal ( )jr t  is  
 46 
Motivated by (2), one way to process the received signal is to cancel out firstly the self-image 
interference due to I-Q imbalance. By introducing the filter  j n , we have   
     
        
           
*
* 2
, , 0,
*
* 2 *
, , 0, 0, 0,
0
    ( )
     ( )
    
j j j
n
j j j j j
n
j j j j j j j j
r n n r n
h n n h n y n e w n
h n n h n y n e w n d n d




 
 
 

 
      
         
j
j
.    
(4) 
To completely cancel out the self-image interference,       
1
*
, ,j j jn h n h n

   , where 
  
1
*
, jh n

  is the inverse filter of  
*
, jh n . (For the case of no frequency-dependent I-Q 
imbalance,   */j j jn    as is given in [14].)  Thus, (4) becomes 
     
     
 
    
     
*
* 2 *
, , 0, 0, 0,
2
,
1
   ( )
   
j
t
j j j
n
j j j j j j j j
g n
n
n
i j i j j
i
r n n r n
h n n h n y n e w n d n d
e s n g n d w n



  


 
             
 
    
 


j
j
 ,   
(5) 
where        *, ,j j j jg n h n n h n   ,       2, , nj i j i jg n h n g n e  j , 
  *0, 0,j j j jd d n d   ,  and      0,j j jw n g n w n  .  ,j ig n  is the overall impulse 
response from i-th transmit to j-th receive antenna after canceling out the self-image interference, 
jd  is the DC-offset, and  jw n  is an additive Gaussian noise but generally not white. In (5), 
 j n ,  ,j ig n ,  , and jd  are the deterministic, unknown parameters to be estimated. In what 
follows,  j n and  ,j ig n  will be approximated as FIR filters with large enough taps, 
although they are generally IIR ones, as can be seen in (4) and (5). 
Following (5), we propose the receiver architecture as in Figure 2; after cancelling the 
self-image interference, DC-offset is compensated next, and then compensation for 
frequency-offset follows. The parameters  j n ,  ,j ig n ,  , and jd  will be estimated jointly 
in the least-squares sense, as to be discussed in the next section, and the MIMO detection is done 
with the MMSE detector, based on the estimated channel responses   ,ˆ j ig n  along with the 
 48 
The total useful received signal for training is  
1. Throughout this paper, bold uppercase letters denote matrices and bold lowercase letters denote vectors. ( )
H , and  ( )T  represent the 
operations of conjugate transpose and transpose of a matrix or vector, respectively. In addition, I  and 1  denote N PI  and N P1 , 
respectively. 
 
         *j j j j j jd    r R S g 1 w ,                                           
(7) 
where      0  1  1
T
T T T
P 
 
S S S S  , and          0 1 1diag , , ,  P        . From 
(7),  
the joint least-squares estimates of all parameters are obtained by minimizing the cost function
2 
   1 1 1
1
, , , , , , , , , , , ,
r
r r r
n
n n n j j j j
j
d d d 

  g g g                                     
(8) 
with  
   
2
*, , ,j j j j j j j j jd d     g r R 1 Sg
        .                              
(9) 
Recall that each branch of receiver has its own I-Q imbalance, DC-offset and channel response, 
but the frequency-offset is the same for all branches. Therefore, given a fixed trial frequency 
offset  , j , jd , and jg  can be estimated by simply minimizing the cost function 
 , , ,j j j jd g   . In other words, j , jd , and jg  can be estimated independently form one 
branch to another. On the other hand, (8) can be used to estimate jointly the frequency offset to 
increase performance by exploiting the diversity and power gain inherent in MIMO systems.  
The LS solution of (8) or (9) can be obtained successively as follows [14]. Firstly, under a 
fixed trial  , ,j jd   , the LS-estimate of channel ˆ jg  is given by [21] 
      *ˆ , ,j j j j j j jg d d    
†
S r R 1      ,                                   
(10) 
where  
†
X denotes the pseudo-inverse of X . Using the singular-value de-composition 
H   
 
0
X U V
0 0

, we have   H
 
  
 
† 0
X V U
0 0

, where  1 2diag , , r    , r  and  k  
are the rank and singular values of X , respectively, and U  and V  are some unitary matrices. 
If X  has full column rank, then    
1
H H


†
X X X X . 
 50 
where         *Hj j      
†
P I C I 1f R   . Finally, substituting ˆ jρ  in (15) and using (8), we 
have    
   
1
rn
j
j
 

                                                           
(17) 
with           
2
* ˆH
j j j j       I C I 1f r R   ρ , and the LS-estimate ˆ  is given by 
  
  ˆ arg min

  

 .                                                     
(18) 
Generally, no close-form is available for ˆ ; an exhaustive search has to be performed for the 
solution.  
From Appendix A, it is shown that  
          
1
*   
H
H T T T
j j j j j j j j j    

     r Q r R Q r R Q R R Q r     ,                 
(19) 
where           
H
H H      Q I 1f I C I 1f    . Coincidentally, in (19), the relevant 
elements to be calculated are in the form of  H v Q u , where  0 1 1 
T
N Pv v v  v   and 
 0 1 1
T
N Pu u u  u   are 1N P   vectors. In addition, also from Appendix A, 
   
     
  
               
H H H H
H H H
H
 
 

 
 

v 1 v C 1 1 u 1 C u
v Q u = v u v C u
1 I C 1
 
 
  .              
(20) 
Define 1 2 
T T T T
P
   v v v v , 1 2 
T T T T
P
   u u u u , and 
11 12 1
21 22 2
1 2
  
  
                
 
P
P
P P PP
 
 
 
 
 
 
B  B B
B  B B
B =
B  B B


  

, where rv  and su  
are 1N   vectors, and rsB  is an N N  matrix with 1 ,r s P  . It can be shown that 
          
1
2 ( ) 2 2
, , ,
1 1 0
 0g
P P N
s r N NH m m
r s r s r s
r s m
e m e m e
        

   
  
 
    
 
 v C u
   j j j ,   
(21) 
where    
1
*
, , ,,
N
r s rs r k m s kk m k
k m
m v u



 B ,    
1
*
, , ,,
N
r s rs r k s k mk k m
k m
m v u



 B , and  ,r k r kx  x , 
 52 
with  
t t t
t t t
t t t
n L n L n L
n L n L n L
n L n L n L
N N
 
 
 
  
 
 
 
g g g
g g g
g g g
I I I
I I I
F
I I I


  

, which contains 2K  matrices of 
tn Lg
I . Recall that A  is 
a full-rank square matrix, and therefore its projection matrix  
1
H H

A A A A  is equal to 
tn Lg
I . 
Since B  is a sparse matrix now,      H    C B    can be calculated much easily. In 
particular, using (26),  H v C u  in (20) becomes 
              
1
2 ( ) 2 2
, , ,
1 1 0
 0g t t
P P K
s r N N m n L m n LH
r s r s r s
r s m
e m e m e
     
   

   
  
 
    
 
  g gv C u
  
 j j j ,  
(27) 
with 
   
 
 
 
1 1
1 1
1 1
* *
, , , , ,, ,
1
*
, ,           
r s
t tt t
t t
r s
t
t
N N
r s rs r k mn L s k r k mn L s kk mn L k k mn L k
k mn L k mn L
N
r k mn L s k
k mn L
e
m v u v u
K P
e
v u
K P
 
 

 
 
 
  
 
 


 



 

g gg g
g g
g
g
B F
j
j
,  
and  
 
 1 1 1
*
, , ,
r s
t
t
N
r s r k s k mn L
k mn L
e
m v u
K P
 

  




 g
g
j
, 0 1m K   .  
Hence, the complexity of CFO estimation is reduced by about tn Lg  times. However, the 
frequency range that can be estimated is also reduced by the same factor with this design. For 
SISO systems ( 1t rn n  ) with 1P  , (25) degenerates to the one in [23]. Furthermore, for the 
undesirable case of 0 1 1P      ,   
2
0
0



 I C 1

  in (13). In other words, with this 
design of training sequence, it is not able to estimate DC-offset when frequency-offset is zero 
because jd 1  is now located in the space spanned by the column vectors of S , and its effect is 
included in the estimate ˆ jg . During the real data transmission, however, the receiver needs the 
estimate ˆ jd  for DC-offset compensation.  
In addition, from the simulation results in Section VI, frequency-dependent I-Q imbalance has 
little effect on the estimation of   and jd , and can be neglected with almost no loss in 
performance. With this observation, we propose the simplified estimators for frequency and 
 54 
neglected here, i.e., j  0ρ , and 0jd  . By setting  j  P 0 , and   f 0 , (17) becomes, 
            2 2 2
1 1 1
 
r r rn n n
H H H
j j j j j j j
j j j
    
  
          I C r r r C r r r B r     .    
(33) 
It will be shown in Section VI by computer simulations that the simplified analysis is very 
accurate for the ranges of jρ  and jd  of practical interest. From Appendix B, it is shown that 
  ˆE 0v v   (an unbiased estimator), and  
  
 
2 2
1
1
ˆE
2  
r
w n
H
j j
j
v v 

 
z I B z
 ,  
where 2j jz ΦSgj ,       1 , 2 ,diag P  Φ   and 
               1 , 2 , ,g g gp N N p N N p N N p N          . 
Next we analyze the estimators ˆ jρ , 
ˆ
jd , and ˆ jg  with no influence of frequency offset; that 
is, ˆ   is assumed in the analysis. It will be shown in Section VI by computer simulations that 
the analysis predicts the MSE performance very well even when ˆ  . For the estimator jρ , 
from (16) and (7), it is easy to show that 
         *ˆ Hj j j j j j jd       P I 1f R Sg 1 wρ ρ .                       
(34) 
In addition, by using (A.3) and the identities,  
     *Hj j j j  P I 1f R ρ ρ  ,    
    Hj jd 

 
0
P I 1f 1 0

 , 
            
1
*H T T
j j j j j j     


      
0
P I 1f Sg R Q R R Q Sg 0 

,  
one has, 
      ˆ Hj j j j   P I 1f wρ ρ .                                           
(35) 
Following the notation in (3), jR  can be rewritten as , ,j j d j r R R R , where ,j dR  and ,j rR  
 56 
 
        
    ,
ˆE E
                           
j
H H H
j j j j j j
H
j d
 
 
  
 
w
w P I 1f w w
P I 1f K
ρ ρ
. 
Finally, for the estimator ˆ jg ,   
 
      
     
         
*
* *
*
ˆ ˆˆ ˆ ˆ, ,
ˆˆ                 
ˆˆ                 
j j j j j j j
j j j j j j j j
H H H
j j j j j j j
d d
d d
d d
 
 
  
   
      
        
†
†
† † †
g S r R 1
S R Sg 1 w R 1
g S R S 1 S w
ρ ρ
ρ ρ
ρ ρ
           
(40) 
Similarly,  ˆE | 0j j  g g , and MSE is given by 
           
               
         
         
2
*
, ,
2
*
,
*
,
ˆ ˆ ˆE | E
ˆ    E E
ˆˆ    2Re E
ˆ    2Re E
    2Re
HH
H T
j j j d j j j j j d
H H
H H H H
j j j j
H H
H H
j d j j j j
H
H H
j d j j j
tr
tr d d tr
tr d d
tr
tr
  
   
 
 
       
         
 
       
 
    

† †
† † † †
† †
† †
†
g g S R R S
S 1 1 S S w w S
S R 1 S
S R w S
S
 ρ ρ ρ ρ
ρ ρ
ρ ρ
         ˆE HH Hj j jd d     †1 w S
 ,     
(41) 
In deriving (41), we have used the following approximations   
             
          
*
,
,
ˆˆ ˆ ˆE E
ˆ ˆ ˆ             E E
H H
H H
j j j j j j j d j j j
H
T H
j j j j j d j j j
d d  
 
     
    
f R f w
R f w f
ρ ρ ρ ρ ρ ρ
ρ ρ ρ ρ ρ ρ
, 
and   
         * ,ˆ ˆE E jH H H Hj j j j d j j jd d      ww f R w f Kρ ρ . 
 
VI. NUMERICAL RESULTS 
The performance of the proposed estimators is evaluated for an un-coded MIMO OFDM system. 
Table 1 gives the system parameters. The transmission is done on a packet-by-packet basis with 
the training portion consisting of two OFDM symbols at the beginning of each packet. A 
wide-sense stationary uncorrelated scattering (WSSUS) discrete channel is considered, with the 
impulse response      , ,
0
 
L
j i j i s
l
h h l lT  

  , where  1L  is the length of the channel, and 
  ,j ih l  are tap gains which are mutually independent complex Gaussian random variables with 
 58 
proposed in (28) and (30). 
Figure 7 shows the impact of Lρ  on BER performance in the Rayleigh fading channel.  
64-QAM is the modulation scheme. The receiver is the one given in Figure 2; after compensating 
I-Q imbalance, DC and frequency-offset, MMSE MIMO detection is performed based on the 
channel estimation coming out of joint LS estimators. Clearly, the modeling error due to using a 
small Lρ  incurs error floor in BER performance, as predicted in Figure 6, where a small Lρ  
results in large MSE for estimating the channel and I-Q imbalance. On the other hand, too large a 
Lρ , e.g., 15L ρ  degrades slightly the BER performance as can be seen in the figure due to the 
extra noise induced by using a large filter length. In the figure, ideal receiver is the one with 
perfect RF compensation.  Finally, in Figure 8, we show the BER performance by using 
low-complexity training sequence and/or simplified frequency and DC-offset estimators. The 
low-complexity training works very well and almost no performance loss is observed with the 
low-complexity implementations. In fact, the low-complexity training performs a little better than 
the training used in [25] for 3L ρ . 
 
VII. CONCLUSIONS 
The theory of joint least-squares estimation of frequency, I-Q imbalance, DC-offset and channel 
is developed for MIMO receivers with direct-conversion RF architecture. Both 
frequency-independent and dependent I-Q imbalances are included. Previously, RF parameters 
were estimated separately and that leads an inferior performance. The estimators are shown 
through analysis to be unbiased and approach to Cramer-Rao lower bound for the signal-to-noise 
ratios of interest.  Special attention is paid to the implementation complexity issue; several 
measures are proposed including a special training-sequence design and low-complexity 
estimators for frequency and DC-offset. Simulation results show that the performance 
degradation is negligible when using the low-complexity designs.    
 
 
 
APPENDIX A 
Derivation of (19) 
From (16) and a simple manipulation,  
              
1
* *ˆ H H T T
j j j j j j j     

          
†
I C I 1f R I 1f r R Q R R Q r     ρ ,         
 60 
  2
1
4
rn
H H H H H H
j j j j j j j j
j
 

     g S ESg g S Ew w ESg w Ew     ,                    
(B.4) 
where  Hj j w w  with   2Hj j wE w w  I  . In addition, 
       2
1 1 1
2 2 2 0
r r rn n n
H H
j j j j w
j j j
E E w w tr E w w tr   
  
 
         
 
  D D D    j j j ,         
(B.5) 
and  
      
 
2 2 2
1 1
2
1 1
E 4 E 4
              4  2  
r r
r r
n n
H H H H H
j j j j j j w
j j
n n
H H H
j j j j
j j
tr   

 
 
       
    
 
 
g S ESg w Ew g S ESg E
g S ESg z B I z
  
,            
(B.6) 
where 2j jz ΦSgj ,       1 , 2 ,diag P  Φ   and 
        1, 2, ,g g gp N N p N N p N N p N          .  
On the other hand,  
  
   
2
2
2
1
2 2
1 1
E 4 E
                    4 2 2  ,   
r
r r
n
H H H H
j j j j j j
j
n n
H H H H H
j j j j w j j
j j
E
 
 

 
                 
        

 
g S Dw w DSg w Dw
g S D w w DSg z I B z
    
 
            
(B.7) 
The approximation in (B.7) is justifiable for  SNR 1 , and the last equality is obtained by using  
   H H  S ΦB BΦ S ΦB Φ ,      ΦB BΦ S Φ BΦ S , and the fact that  I B  is a 
projection matrix. Therefore, from (31), (32), (B.5)-(B.7), we have   ˆE 0v v   and  
  
 
2 2
1
1
ˆE
2  
r
w n
H
j j
j
v v 

 
z I B z
. 
APPENDIX C 
Derivation of CRLB 
In Section V, it is shown that ˆ , ˆ jρ , 
ˆ
jd , and ˆ jg  are unbiased estimators provided that 
SNR 1  and 1N  . In this appendix, we derive the CRLB for those estimators under the same 
 62 
    1
11
ˆvar  v    M ,  
 
 
 1 1
2
1
1 1 1
ˆ
j L L
j j kk
k j L
E
  

   
    
λ
λ
M
ρ
ρ ρ ,  
 
 
1
1 1 1
ˆvar j kk k j L L
d 
    
   
λ
M
ρ
,  
and  
 
 
 1 1 1
2
1
1 1 2
ˆ
j L L L
j j kk
k j L L
E
    

    
    
λ g
λ
g g M
ρ
ρ
.  
By definition,  
       
1
ln ln ln ln
   
r
T T T
n
f f f f
v
    
  
     
ω ω ω ω
ω λ λ
 ,  
and  
             
*
ln ln  ln ln ln ln ln
     
T T T H H
j j j j j j j
f f f f f f f
d d
       
          
ω ω ω ω ω ω ω
λ g gρ ρ
.     
After a lengthy derivation, the partial derivative of  ln f ω  with respect to each parameter is 
shown to be  
 
 
    1 1
1
ln r
j j
n
H H H
j j j j
j
f
v
  


   

 w w
ω
w K z z K w ,                            
(C.2) 
   
*
1 *
ln ln
 
j
H
j jT H
j j
f f        
w
ω ω
w K R
ρ ρ
,                                    
(C.3) 
   
*
1
*
ln ln
j
H
j
j j
f f
d d

  
     
w
ω ω
w K 1 ,                                      
(C.4) 
and      
   
 
*
1
ln ln
j
H
jT H
j j
f f

  
      
w
ω ω
w K S
g g
.                                 
(C.5) 
From (C.2)-(C.5), the matrix M  can be evaluated. 
 64 
1415–1417, November 2001. 
[41] A. Schuchert, R. Hasholzner, and P. Antoine, “A novel IQ imbalance compensation scheme 
for the reception of OFDM signals,” IEEE Trans. Consumer Electron., vol. 47, no. 3, pp. 
313–318, August 2001. 
[42] A. Tarighat, R. Bagheri, and A. H. Sayed, “Compensation schemes and performance 
analysis of IQ inbalance in OFDM receivers,” IEEE Trans. Signal Process., vol. 53, no. 8, 
pp. 3257–3268, August 2005. 
[43] A. Tarighat and A. H. Sayed, “Joint compensation of transmitter and receiver impairments 
in OFDM systems,” IEEE Trans. Wireless Commun, vol. 6, pp. 240-246, January 2007.  
[44] G. Xing, M. Shen, and H. Liu, “Frequency offset and I/Q Imbalance Compensation for 
Direct Conversion Receivers,” IEEE Trans. Wireless Commun., vol. 4, no. 2, pp. 673–680, 
March 2005. 
[45] G. T. Gil, I. H. Sohn, J. K. Park, and Y. H. Lee, “Joint ML estimation of carrier frequency, 
channel, I/Q mismatch, and DC offset in communication receivers,” IEEE Trans. Veh. 
Technol., vol. 54, no. 1, pp. 338–349, January 2005. 
[46] D. Tandur and M. Moonen, “Joint Adaptive Compensation of Transmitter and Receiver IQ 
Imbalance Under Carrier Frequency Offset in OFDM-Based Systems,” IEEE Trans. Signal 
Process., vol. 55, no. 11, pp. 5246 – 5252, November 2007 
[47] A. Tarighat and A. H. Sayed, “MIMO OFDM receivers for systems with IQ imbalances,” 
IEEE Trans. Signal Process., vol. 53, no. 9, pp. 3583 - 3596, September 2005. 
[48] R. M. Rao and B. Daneshrad, "I/Q mismatch cancellation for MIMO OFDM systems," in 
Proc. IEEE Int. Symp. Pers., Indoor, Mobile Radio Commun., Barcelona, Spain, pp. 
2710-2714, September 2004. 
[49] H. Kamata, K. Sakaguchi, and K. Araki, "An effective IQ imbalance compensation scheme 
for MIMO-OFDM communication system," in Proc. IEEE Int. Symp. Pers., Indoor, Mobile 
Radio Commun., Berlin, Germany, pp. 181-185, September 2005. 
[50] T. C. W. Schenk, P. F. M. Smulders, and E. R. Fledderus, "Estimation and compensation of 
frequency selective TX/RX IQ imbalance in MIMO OFDM systems," in Proc. ICC 2006, pp. 
251-256, June 2006. 
[51] T. Kailath, H. Vikalo, and B. Hassibi, MIMO receiver algorithms, in Space-Time Wireless 
Systems, Edited by H. Bolcskei, D. Gesbert, C, Papadias, and A. van der Veen, Cambridge, 
2006. 
[52] J. Mendel, Lessons in Estimation Theory for Signal Processing, Communications and 
Control, Prentice-Hall, 1995. 
[53] M. H. Meyers and L. E. Franks, “Joint carrier and timing recovery for PAM systems,” IEEE 
Trans. Commun., vol. 28, pp. 1121–1128, August 1980. 
[54] M. Morelli and U. Mengali, “Carrier-frequency estimation for transmissions over selective 
channels,” IEEE Trans. Commun., vol. 48, pp. 1580–1589, Sep. 2000. 
[55] A. van den Bos, “A Cramer-Rao lower bound for complex parameters,” IEEE Trans. Signal 
Process., vol.42, p. 2859, October 1994. 
 66 
 
Figure 1. MIMO signal model with direct-conversion RF architecture 
 
Joint 
LS 
Estimation
ˆ ( )
j
n
ˆ
j
d
( )
j
r n
(  )*

ˆ2j vn
e


ˆ ( )
j
n
,
ˆ ( )  ,  1
j i t
g n i n 
ˆ
j
d
vˆ
From other branches 
(for frequency 
estimation)
MMSE
MIMO
Detection
From other 
branches
*
( )
j
r n

,
ˆ ( )  ,  1
              1
j i t
r
g n i n
j n





1
( )r n

 
 
Figure 2. MIMO receiver with joint LS estimation/compensation of RF parameters 
 
 
 
 
 
 
 
 68 
 
Figure 4. MSE performance of the joint estimators in Rayleigh fading channels 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 70 
 
Figure 6. The effects of Lρ  on MSE in Rayleigh fading channels 
 
 
 
 
 
 
 
 
 
 
 
 72 
 
  Figure 8.  BER performance with low-complexity and/or simplified estimators in Rayleigh 
fading channels 
 
 
國科會補助計畫衍生研發成果推廣資料表
日期:2011/02/14
國科會補助計畫
計畫名稱: 應用於4G具迭代解碼之多天線位元交錯調變-編碼系統之新型設計
計畫主持人: 沈文和
計畫編號: 97-2221-E-324-050-MY2 學門領域: 通訊
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
擔任工研院資通所顧問。 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
