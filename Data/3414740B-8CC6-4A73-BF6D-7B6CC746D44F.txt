 2 
中文摘要 
本子計畫為多功能智慧型看護系統之研究之第四子計畫看護系統整合控制，主要為整合
並控制其餘三個子計畫包含腦波辨識人機介面系統之建立、智慧型多功能病床-居家看護以及
看護系統之監控與辨識功能建立。本計畫是以單晶片微電腦為訊號處理核心，負責接收來至
子計畫一和子計畫三的病床姿態控制的動作控制指令以及按摩墊控制命令等，經過命令查表
後判斷對應控制馬達為何後，再以馬達驅動電路加以控制。其中，被控制馬達為安裝在子計
畫二所建構的電動病床中。藉由拉線式譯碼器與微動開關做為病床相關可動機構的動作角度
和位置狀態的回授。除了病床可動機構位置和角度的判定外，微動開關另負責偵測病床可動
機構是否已達到極限作動角度，用以保護機構和使用者的安全。最後經由實測可知，本子計
畫可成功的接收病床控制指令並進行病床的躺臥角度的調整，實現病人可用意念或手指影像
即可作病床姿態的調整。 
 
關鍵詞：看護系統，居家照護，病床。 
 4 
研究動機 
家庭看護 (Home care) 之意為看護者直接到病患或有需要的老弱殘疾的家裡進行醫療或
非醫療的之照護，包含日常生和起居的協助。主要照護對象為老人、有肢體殘障的人亦或有
長期疾病需要長期臥病在床的人，如漸凍人 (Amyotrophic Lateral Sclerosis, ALS)、小腦萎縮
症患者或四肢癱瘓的人。台灣人口年齡分佈結構正朝著老齡化發展，老年人和成年人的比重
開始增加。並非只有台灣有此現象，全世界各國亦皆有此情況，只是老齡化社會形成的速度
快或慢。探究其原因，除了是由於醫學進步所造成的低死亡率外，另一個主要原因則為夫妻
生育兒女的意願較以前低落。老齡化社會的結構會產生一個最直接也是最主要的問題：老年
人的醫療照護需求急遽增加。有鑑於此，護理照護技術和居家看護系統將會越來越顯重要。
然而，目前的居家照顧大多仍是以聘用專門的照顧或看護人員，以一對一方式，專責照顧。
但是並非所有的人皆能負擔起聘請專門看護人員所需的費用，而且如此亦會增加所謂的社會
成本。 
因此本子計畫主要目標為發展出一個全新的多功能智慧型看護系統。依照使用者（患者）
的需求，利用使用者本身的腦波或者手勢來完成控制病床的姿態調整動。並能完成控制按摩
墊和撥打電話等控制動作，或者是透過有線或是無線的方式將病人的需求傳達給護理人員。
本子計畫為看護系統整合控制，主要研究目的為將多功能智慧型看護系統之研究此整合型計
畫中的各子計畫加以連結。接收來自子計畫一和子計畫三的病床等控制命令後，再驅動子計
畫二病床上馬達，達到以腦波或手勢控制病床等邊裝置。此即為以腦波控制週邊設備的大腦
人機介面 (Brain computer interface, BCI)。此系統對於漸凍人或四肢癱瘓的病人特別有幫助。
因為這些病患雖然無法自主地控制四肢活動，但是他們的意識和思考仍是清楚的。所以還是
可以藉由偵測並辨識其腦電波訊號 (Electroencephalography, EEG) 來送出病床或其相他相關
的控制訊號。一套大腦人機介面系統腦波訊號擷取、濾波和放大電路，以及訊號的辨識轉換
電路。本計畫預期所研發的多功能智慧型看護系統除了能減少看護人員的需求和負擔外，還
能增加病患或是老人家的生活自主能力，進而提升其自尊心和生活品質。 
 
智慧型居家照護系統之設計與控制技術：居家照護系統之目的在增加居家（或非醫療院
所）療養者或年長者之生活機能，提升其生活品質，及降低照護人員之負擔等。具體的方向
如智慧型病床，生理訊號感測與即時分析及監控，智慧型人機介面，智慧型視覺及聽覺裝置，
各型家用機器人，看護服務機器人，遠距監控及緊急事件偵測及告知及回饋系統，及其相關
 6 
單晶片微電腦 
本子計畫所使用的單晶片微電腦 PIC16F877 屬於八位元並且以精簡指令 (Reduced 
Instruction Set Computer, RISC) 架構為運算核心，RISC 表示此單晶片僅使用少量指令即可完
成韌體程式的設計和開發，故單晶片可將指令執行過程改以管線式 (Pipeline) 架構作設計，
提高程式執行效率。以 PIC16F877 為例，一個指令僅需耗時 4 個時脈週期即可完成。亦即若
使用4 MHz的石英震盪器做為單晶片的外部震盪時脈，此時，此單晶片只需1微秒 (1 / [4 MHz 
/ 4]) 即可完成一個指令動作。PIC16F877 程式記憶體 (Program Memory) 容量為 8K × 14 
words，程式記憶體型態為非揮發式記憶體 (Flash Memory)。資料記憶體 (Program Memory) 
容量為 368 × 8 bytes，資料記憶體型態為揮發式 RAM。除了揮發式的資料記憶體外，
PIC16F877 還內建有非揮發式的資料記憶體 (EEPROM)，其容量為 256 × 8 bytes。外接時脈
最高為 20 MHz。下圖二為 PIC16F877 的接腳功能圖。 
    
圖二、PIC16F877 接腳圖 
 
PIC16F877 特殊功能簡述： 
Timer0：八位元計時/計數器，含八位元預除器 
Timer1：十六位元計時/計數器，含預除器 
Timer2：八位元計時/計數器，含預除器和後除器 
 8 
+5V，而邏輯 0 的電壓為 0V。但是由於單晶片的電源供應僅為+5V 和 0V，所以單晶片無法
產生或接收 RS-232 的邏輯電壓，若要真正由單晶片接收或傳送 RS-232 邏輯，則必須在單晶
片外再接一個電壓轉換 IC。 
 
圖四、RS-232 邏輯電壓 
一般常見的 RS-232 電壓轉換 IC 型號為 MAX-232 [2] 或 HIN-232，由於此類 IC 的需求
很多，所已以有多家 IC 設計公司出產此種 IC，並且皆是 pin-to-pin，也就是說接腳功能位置
完全一樣，可以相互替換使用。MAX-232 內部是採用 ChargePump 的方式將電壓由 0V-5V
升壓轉換至+12V-12V。圖五為 MAX-232 的接腳圖與接線圖。其中，TIN 代表由單晶片所送
出的 TTL 邏輯 RS-232 訊號，TOUT 代表標準的 RS-232 邏輯準位輸出端 (TXD)，RIN 代表由
RS-232 邏輯準位輸入的 RS-232 訊號 (RXD)，ROUT 代表輸入至單晶片的 TTL 邏輯 RS-232
訊號。 
 10 
 
(a)                                                (b) 
圖七、(a)拉線式譯碼器實體照片。(b)拉線式譯碼器規格圖。 
HLS-S 系列的拉線式譯碼器基本規格如下： 
偵測系統：增量型 
輸出波形：方波 
量測行程：1000 mm 
最大解析度：0.04 mm/pulse 
精度：±1 count 
供應電源：DC 5V 
消耗電流：≦ 60 mA 
最大響應頻率：50 KHz 
 
微動開關動作偵測器 
微動開關 (Microswitch) 是用來限制病床的最大動作或姿態角度，以避免病床可動機構
轉動或移動超過最大可容忍角度或位置，進而保護使用者的安全。本計畫共使用六個微動開
關並可被分成三組，分別用來偵測上半身上升/下降、腳上升/下降以及整體病床上升/下降的
最大角度和位置，並可做為上止點和下止點的偵測。當機構運作到上止點或下止點時，就會
送出訊號通知單晶片自動停止馬達的運轉。 
圖八為微動開關的實體圖和等效電路圖，微動開關屬於機械式作動，其原理為利用東西
直接壓觸其上方的開關連桿來做為開關的打開與關閉動作。假設微動開關下方的三隻腳分別
為腳 1(COM)、腳 2(NO)與腳 3(NC)，當平時開關連桿未壓下時，第 1 腳與第 2 腳處於斷路的
 12 
 
圖十、多功能病床之完整結構 
由於在本子計畫中，多功能病床主要是透過 3 顆 24V 的直流馬達來帶動機構。直流達控
制由來已久，已經具有成熟且穩定的控制方式。但是在本子計畫中，直流馬達將被應用在病
床姿態的控制，直接驅動以人和機械裝置加總起來的負載。在固定負荷下，直流馬達的旋轉
速度和轉子的扭矩成正比，扭矩愈大，轉速愈大。對永磁式直流馬達而言，定子的磁場強度
固定不變，所以轉子的扭矩完全由線圈的感應磁場強度決定，因而扭矩 Te 就正比於電樞電流
Ia: 
  (1) 
其中 Kv 為扭矩常數。由動力學的 Euler 公式可以得出轉速 的動態方程式為 
  (2) 
其中 J 為轉子的慣性矩，Bm 為動摩擦係數，TL 為負荷力矩。 
由以上的式子，可以看出直流馬達的速度控制可由控制電樞電流來達成，而電流的控制
也可以改為控制輸入電壓，因為線圈的電阻是固定的。因此直流馬達的控制有所謂的穩定電
流和穩定電壓。前者為輸入電流命令，控制輸出電流值等於輸入命令。後者則是控制輸出電
壓值等於輸入電壓命令。實現這二種控制方法的最簡單方式為使用脈寬調變 PWM 輸出。在
 14 
馬達過電流時自動斷電 
我們設計一馬達堵住感測電路來達到馬達過電流時自動斷電。為避免智慧型多功能病
床，在升降過程中被異物卡住傳動機構，使得馬達過載導致燒毀，所以將設計如圖十三所示
之電路保護裝置。其基本架構由電流感測器、整流器與類比轉數位(A/D)電路所組成，在上述
情形發生時，將立即啟動停止馬達運轉。圖十四為保護裝置的實體圖。 
 
圖十三、馬達堵住感測電路方塊圖 
 
圖十四、馬達堵住感測電路實體圖 
按摩墊驅動電路 
由於癱瘓或漸凍人等病患必須長時間躺臥在病床上，為了增加病人的舒適度並且幫助病
人按摩和減少壓瘡，我們在病床上增加電動按摩墊裝置。但是由於原本的按摩墊驅動電路操
作上過於複雜，故我們重新設計按摩墊驅動電路取代原先按摩墊的原廠控制電路，以增加病
患操控時的便利性。按摩墊實體圖如圖十五所示。該按摩床墊主要電源供給為 DC12V，其內
部裝置了三顆微型振動馬達，透過馬達的振動帶給病人有如專人按摩般的享受，並且按摩可
以幫助病人提昇臥床時其背部的血流量，減少壓瘡產生的機會。在按摩的力量控制方面，是
採用類似直流馬達控制的方法。其按摩功能主要有:背部按摩、腰部按摩、腿部按摩等多項按
摩功能可供選擇。因此我們透過按摩床墊模組可以針對病患人體各部位做各種不同的方式按
摩，並可依病患需求透過病患手勢的辨識，自動的調整做局部按摩或強弱做調整。使病人可
 16 
表一、電話中數位或功能鍵對應之複頻頻率表 
 
高頻群 (Hz) 
 1209 1336 1477 1633 
697 1 2 3 A 
770 4 5 6 B 
852 7 8 9 C 
低頻群 
(Hz) 
941 * 0 # D 
 
計畫中自動撥號電路所採用的複頻訊號產生 IC：HT-9200A 其基本特性如下： 
操作電壓：2.5V ~ 5.5V 
串列控制模式 
低待命電流消耗 
低總諧波失真 (Total Harmonic Distortion, THD) 
可使用 3.58 MHz 外接石英震盪器或陶瓷震盪器 (Ceramic resonator) 
8-pin DIP/SOP 包裝 
 
圖十六為 HT-9200A 的接腳圖與內部方塊圖。 
  
(a)                                         (b) 
圖十六、(a)HT9200A 接腳圖。(b)HT9200A 內部方塊圖。 
HT-9200A 的控制時序圖如圖十七所示。控制方式為首先必須將晶片致能 (/CE) 拉到低
電位，由資料串入腳 (DATA) 串入欲產生的複頻訊號數值，例如欲產生“1”的複頻撥號音，則
在資料串入腳串入“00001”，欲產生“2”的複頻撥號音，則在資料串入腳串入“00010”，依此類
推。在每一筆的串入資料中，每個位元是在當時脈腳 (CLK) 負緣 (falling edge) 的時才會被
HT-9200A 所讀入。每當一筆完整資料（五個位元）被串入後，DTMF 接腳即會輸出對應的類
比複頻訊號。 
 18 
單晶片周邊相關電路 
單晶片周邊相關電路包含石英震盪電路、單晶片重置電路和線上串列燒錄電路 
(In-Circuit Serial Programming, ICSP™) 等。線上串列燒錄電路可允許對已經焊接在電路印刷
板上面的單晶片做程式燒錄或抹除等的動作。如此即可實現遠端韌體程式碼更新或修改。 
圖十九為單晶片周邊相關電路的實體圖。 
 
圖十九、單晶片周邊相關電路的實體圖 
 
單晶片韌體設計 
雙組 RS-232 訊號接收 
由於會有兩個子計畫（子計畫一和子計畫三）藉由 RS-232 介面傳送病床等控制命令至本
子計畫四。但是單晶片 PIC16F877 僅有一個 RS-232 訊號接收/發送模組，所以我們必須自行
以韌體設計的方式實現兩組 RS-232 接收功能。 
標準的 RS-232 訊號格式如圖二十所示，其中通道 1 (CH1) 為直接量測單晶片的 I/O 接
腳。通道 2 (CH2) 為量測 RS-232 Comm. Port 上的訊號，亦即已經由 MAX-232 進行電壓轉換
後的輸出訊號。我們可以根據 RS-232 訊號傳輸格式的特性，也就是當一筆八位元的資料要被
送出前，會先產生一個位元 0 的訊號作為起始位元 (Start bit)。故吾人可以利用韌體程式去先
找到這一個起始位元，即可以接連將後面的八位元資料接收進來。為了能夠穩定的接收
RS-232 串列資料，我們必須設計讓程式盡量在每一個位元的中心點去判定該位元資料為邏輯
1 還是邏輯 0。平時當 RS-232 沒有資料作傳輸時，其會保持在高電壓準位（邏輯 1），所以程
 20 
U
p
p
e
r B
o
d
y
 D
o
w
n
 C
o
n
tro
l
F
o
o
t U
p
 C
o
n
tro
l
F
o
o
t D
o
w
n
 C
o
n
tro
l
B
e
d
 U
p
 C
o
n
tro
l
B
e
d
 D
o
w
n
 C
o
n
tro
l
M
a
s
s
a
g
in
g
 C
u
s
h
io
n
 O
n
M
a
s
s
a
g
in
g
 C
u
s
h
io
n
 O
ff
D
ia
l fo
r E
m
e
rg
e
n
c
y
 S
e
rv
ic
e
s
 
圖二十一、韌體程式整體流程圖 
 
以接收到控制病床姿態的命令為例，控制馬達改變病床姿態時必須同時偵測拉線式譯碼
器的方波輸出量與微動開關是否被致能，以決定是否繼續驅動對應馬達做動。 
 
控制中心系統整合 
圖二十二為子計畫四最後完成的控制中心實體照片。其中，控制電路板以及馬達驅動電
路板皆被安裝到鋁質機箱內，並且各模組或子板間的電源與訊號線都以蛇管將其分別整理。
拉線式譯碼器和微動開關的迴授訊號皆是由圖中機箱左側進入。由子計畫一和子計畫三所連
接過來的 RS-232 訊號線則是由圖中的機箱右側輸入。用以進行單晶片程式碼更新或重新燒錄
的線上串列燒錄輸入端子亦被置於機箱的右側。馬達驅動電路板的馬達驅動訊號是由機箱下
板的上方連接至病床上的各馬達。 
最後控制中心系統的整合測試環境如圖二十三所示。圖中右方為子計畫一的腦波訊號處
理端，處理結果即會以 RS-232 送出控制命令至圖中正下方的控制中心。圖中左上方為子計畫
三的影像辨識 CCD。同樣的，影像辨識處理後的結果亦會透過另一個 RS-232 訊號線傳送至
控制中心。最後控制中心在分別依照命令控制對應的病床馬達作動。 
 
 22 
結論 
本子計畫為多功能智慧型看護系統之研究之第四子計畫看護系統整合控制，主要為整合
並控制其餘三個子計畫包含腦波辨識人機介面系統之建立、智慧型多功能病床-居家看護以及
看護系統之監控與辨識功能建立。本計畫是以單晶片微電腦為訊號處理核心，負責接收來至
子計畫一和子計畫三的病床姿態控制的動作控制指令以及按摩墊控制命令等，經過命令查表
後判斷對應控制馬達為何後，再以馬達驅動電路加以控制。藉由拉線式譯碼器與微動開關做
為病床相關可動機構的動作角度和位置狀態的回授，以保護機構和使用者的安全。由於本子
計畫為全體子計畫之整合中心，因此必須先將各子計畫相關介面明確定義。最後才有辦法在
整合過程中順利結合各子計畫，完成整體多功能智慧型看護系統。最後經由實測可知，本子
計畫可成功的接收病床控制指令並進行病床的躺臥角度的調整，實現病人可用意念或手指影
像即可作病床姿態的調整。 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
