 2
 
E化趨勢之數位網路鑑識研發與數位證據管理機制整體研究--
數位鑑識e化平台規劃與建置 
 
計畫編號：NSC 97-2221-E-015-001- 
執行期限：97 年8 月1 日至98 年7 月31 日 
主持人：王旭正 中央警察大學 資訊管理系 
計畫參與人員：翁麒耀、陳崇葦、張晃瑜、黃嘉宏、蔡維宸、黃信培、吳憲政 
E-mail: sjwang@mail.cpu.edu.tw  
 
 
ㄧ、中文摘要 
本報告中，網路數位鑑識蒐證架
構，蒐集、分析系統所儲存的證據。在
高速運算的網路環境中，各種電子設備
裡均紀錄許多資訊，這些存在於電子設
備裡的資訊非常容易被變造或因系統人
員不當操作而消失，而無法證明其證據
之完整性或來源可靠性，因此在蒐證時
最重要的步驟是找出存在於電子設備裡
的數位證據，並利用本計畫所提出的高
效率視覺化分析模組來分析數位證據，
快速找出隱藏在資料中的關聯，所以在
分散式的網路環境中，我們需要一個有
效率且即時的網路數位鑑識蒐證架構。
在本計畫中，我們提出網路數位鑑識蒐
證架構，蒐集、分析系統所儲存的證據，
並依據我們提出的視覺化電腦犯罪資料
分析模組(視覺化即互動圖形的邏輯表
示)分析資料，經由視覺化的分析可快速
將整個案件的關聯，利用圖形化的方式
來呈現，將提高數位證據的可讀性，經
由本架構蒐集的資料可提高數位證據的
完整性及可驗證性，因此依本架構所蒐
集的數位證據並做成的數位鑑識報告，
在法庭上將更具有證據證明的能力。 
 
關鍵詞: 數位鑑識、數位證據、證據證
明力 
 
 
二、緣起與目的 
在瞬息萬變的電腦環境中，系統記
錄許多易消失的資料如：系統日誌檔、
快取記錄及網路訊息，而這些分散於各
種設備裡的資料很難即時蒐集，且非常
容易被修改或是因為人為不當的存取而
消失。因此，在分散式的網路環境下即
時蒐集系統及設備資訊，對數位鑑識蒐
證系統來說是一個非常重要的步驟。在
本計畫中，我們提出一個網路數位鑑識
log 資訊蒐集分析架構，主要是針對電腦
及網路設備做數位證據即時蒐集，此
外，我們所提出的架構可以確保數位證
據的完整性及可驗證性，因此，所蒐集
的資訊在法庭上更增加其公信力的。 
所謂『凡走過必留下痕跡』，當電
腦犯罪事件發生時，一般數位證據會從
記錄在電腦中的日常事務、行程、電子
郵件往來以及系統、網路設備記錄檔 
(log)或是一些合法監聽設備中的記錄來
搜集資料，並進行數位鑑識。而各種系
統或網路設備的 log 資料忠實記錄了系
統所有的活動如：系統的「日期、時間、
IP、動作、連結、來源」。但是由於系統
日常資料非常的龐大及繁雜，所以 log
資料如果未經分析處理並轉換成有效的
資訊，則無法發揮證明犯罪行為及追蹤
攻擊來源的功能。 
在本計畫中，我們對數位化環境提
出一個網路數位鑑識 log 資訊蒐集分析
 4
侵或有可疑攻擊行為時，相關的 IP 位置
及有關的時間資訊將會直接與系統記錄
檔產生直接的關連。相對的系統記錄檔
是非常容易被駭客利用工具做變造，所
以在本研究中，各種 log 資料被傳送到
證據管理模組前，都會先經過 hash 處
理，來確保數位證據來源是未經過變造
的，而這個問題亦將成為維護系統記錄
資訊的一個重要的步驟。 
 
網路設備 log 記錄蒐證 
我們蒐集各種網路設備中所儲存的 log
資料(如:proxy、防火牆、IDS、IPS、Router
等網路設備)，並利用過濾機制來過濾重
覆的 log 記錄檔，並將所有的資料透過
MD5 來做 Hash 處理，進而將分散在網
路上的各種網路設備及系統記錄檔中的
資料傳送到遠端主機，並做到資料保全
的目的。 
 
 
網路流量 log 記錄蒐證 
網路記錄的蒐集主要是利用 Tcpflow 工
具來蒐集網路流量資訊，主要功能是蒐
集網路連線對話內容並將對話資訊寫入
檔案。Tcpflow 程式可以擷取 TCP 連線
及提供分析封包及編釋所傳送封包資料
的內容，Tcpflow 所提供的資訊是跟據傳
送各種不同協定的資料來做記錄。 
Tcpflow並沒有提供MD5 hash的功能，而
MD5 hash對電腦犯罪偵察來說是非常
重要的一個關鍵，因此我們將hash的功
能加入Tcpflow裡，主要著重在對
Tcpflow蒐集的資料加上時間記錄，這樣
數位鑑識人員可確定入侵攻擊行為發生
的時間，並且可快速的找出相關的系統
記錄，例如：當我們在分析相關的系統
記錄檔時，電腦設備所記錄的時間通常
最常被拿來當索引檔來使用，以加快電
腦犯罪偵查的速度。 
 
(二) 討論與分析比較 
我們提出的設計和傳統 log 資訊蒐
集分析方法及現有的資訊蒐集鑑識系
統，Oh 所提出之架構[3]比較，如表一
所示，可明顯的看出本研究所提出之網
路數位鑑識 log 資訊蒐集分析架構，在
人力、設備、時間及成本上，均節省許
多時間並提高了分析的效率，亦是本篇
研究與其他研究最大不同的地方。 
由此可見，數位證據的處理首要步
驟為證據的蒐集，依次為證據的保存、
證據檢驗及分析及證據之呈現，而本研
究提出以網路數位鑑識蒐證模組為架構
協助系統及網路設備數位證據的蒐集與
保存，安全且即時回傳證據管理模組統
一保全數位證據，並透過視覺化電腦犯
罪資料分析模組，將第一時間所掌握的
電腦犯罪案件數位證據作視覺化的處
理，藉以大幅度提升處理網路中大量數
位證據的時間，透過圖形化快速呈現以
利完成後續檢驗、分析與呈現的步驟。
本研究提出以網路數位鑑識蒐證模組架
構的解決方案，在處理電腦犯罪案件時
可作為參考之依據，並可支援不同類型
的網路犯罪進行數位證據蒐集及分析，
最後透過視覺化的呈現讓不同單位的偵
察人員可以共同參與討論，不需再花太
多時間來解釋整個案件發生的經過，在
法庭上亦可提供簡單並明確的鑑識報
告，以利法官更容易瞭解數位證據的內
容，所以我們不只提高了偵辦案件的便
利性，也大幅提升數位證據鑑識與保存
的效率。 
 
 
 
四、自評 
 
本計畫中所提出的網路數位鑑識蒐
證架構利用了各種不同的模組來蒐集資
訊，將網路中所有的數位證據透過有效
率、即時且安全的方法儲存，以確保系
 6
 
 
 
圖一、網路數位鑑識 log 資訊蒐集分析架構 
 
 8
 
表一、 傳統 log 資訊蒐集分析、現有資訊蒐集鑑識系統與本計畫所提出的 
架構比較表 
 
 
 
傳統 log 資 
訊蒐集分析 
現有的資訊蒐
集 
鑑識系統[3] 
本研究提出之網路數位鑑識 log
資訊蒐集分析架構 
數位證據 
保存方式 
在資訊安全事件發
生時，由系統管理人
員登入可能存有證
據之系統主機或網
路設備伺服器並蒐
集其數位證據。 
集中保管資
料。 
當安全事件發生時，系統管理人
員只須登入 log 資訊管理系統中
即可蒐集所有相關之證據。 
數位證據 
蒐證方式 
數位證據均保存於
各種系統伺服器或
網路伺服器中。針對
不同資安事件再到
不同系統及設備中
找尋相關資料。 
將資料集透過
傳輸軟體傳送
至證據管理模
組中。 
利用本研究所提出的架構來集中
保存數位證據，並加上 hash 的功
能保證其完整性，由於集中式的
管理讓管理者可以不用花費太多
的時間在各種設備中找尋數位證
據。 
Log 蒐集 
分析方式 
在傳統 log 蒐集工作
是由管理者操作，並
且在龐大的 log 資料
中找尋相關犯罪跡
證及分析 log 資料，
皆是由系統管理者
來完成。 
此架構並未提
出資料之分析
方式。 
本架構中 log 蒐集的工作是由系
統自動完成，並將各種設備中的
log 記錄自動傳送至管理模組中
集中保存，系統管理者於資安事
件發生時，從 log 管理模組中找
出系統 log 記錄匯入本研究所提
出之視覺化電腦犯罪資料分析模
組，即可快速完成 log 分析工作。
數位證據 
之呈現方
式 
由系統管理者分析
log 資料後，經由人
工繪圖方式來呈現
整個犯罪架構。 
數位證據需由
系統管理者利
用人力來做分
析的工作，並
將結果呈現。
利用本研究所提出之視覺化電腦
犯罪資料分析模組來分析 log 資
料，並利用圖形化的方式呈現出
log 資料中的關聯性，減少犯罪偵
查所需花費在資料分析上的時
間。 
 
 2
 
參加 The Third International Symposium 
on Smart Home (SH-08) 
報告 
活動時間與地點: 2008 年 12 月 13 日至 12 月 15 日 ， 
中國 海南島三亞市 
 
一、 參加會議經過 
1. 行程說明 
會議前一天抵達海南島，於會議結束隔天下午回程。The Third 
International Symposium on Smart Home 2008 (SH-08) 與 The 2008 
International Conference on Future Generation Communication and 
Networking 2008 (FGCN-08) 聯合舉行，為一領域廣泛的國際會議。
為針對下一世代的通訊系統與網路可能的發展，讓對於此議題有興趣
的研究學者們有一個可以發揮創意的空間。而另一個目的，藉此提供
一個學術及產業界共同討論最新的議題及發展的機會。其領域非常的
多元，大致議題如下： 
1. Wireless Ad Hoc, Mesh, and Sensor Networks 
2. Sensor Networks and Applications 
3. Wireless Communications for Intelligent Transportation Systems 
 4
圓密碼學及雙線性對應函數，完成更多元的門檻值秘密分享設計。國
際會場裡，看到許多亞洲人面孔，皆以流利的英文來報告。同一session
的報告中，也有一位來自台灣的學者，報告的題目是   “A 
Density-Based Algorithm for Redundant Reader Elimination in a RFID 
Network” 。其主要的內容是在敘述在Radio Frequency Identification 
(RFID)，射頻辨識系統中，利用Density-based Redundant Reader 
Elimination Algorithm (DRRE)來解決Redundant Reader Eliminating 
Problem (RREP)。其問題敘述是說，在射頻辨識系統中，如果過多的
使用者，同時在同一區域內使用其系統時，因為訊號會互相干擾的緣
故，使得系統功能不能完備進行，因此，如何在保持訊號覆蓋面積相
同的情況下，消除一些多餘的系統使用者，便是此篇文章中的主要貢
獻。文章中最主要的概念就是利用文式圖 (Venn Diagram)的方式，
將交疊區域內的使用者給去除，如此一來，便能在相同的訊號覆蓋區
域下，去除多餘的使用者，使系統效能達到最佳。 
此外，同一session的報告者中，有一位來自於愛爾蘭高威大學的
中國學生學者，報告題目是 “Geographic Routing in Wireless 
Multimedia Sensor Networks”，其主要的內容是敘述，提出一個稱為
Two-Phase geographic Greedy Forwarding (TPGF)的路由演算法，讓傳
輸多媒體訊息的效率，能有效的提昇。其中指出，目前的一些相關研
