摘要 
在這篇論文中，我們在近似即時之中繼站分碼多工存取系統上，提出了一個兩級
式的多使用者偵測器。中繼站通訊在近年持續受到關注，是因為它的空間多樣
性。然而現階段的研究上仍有幾個嚴重的問題存在，特別是傳輸速率降低的缺
點，為了解決這個問題，我們使用一個近似即時的符元傳送機制於中繼站分碼多
工存取系統上。並且在中繼站的偵測器和目的節點上使用一個兩級式多使用者偵
測器的方法來確保這種傳送方法的可行性。這個兩級式多使用者偵測器方法是於
第一級使用零強制偵測器方法來抑制多重存取干擾，再於第二級用最大相似法則
來估測傳送符元。特別的是這兩級式多使用者偵測器只需要少量的運算複雜度執
行最大相似法則。最後，模擬結果和複雜度分析顯示本計劃所提出的方法不只可
提供多樣性的增益，也使中繼站分碼多工存取的傳送能夠接近即時。 
 
關鍵詞:多使用者偵測器、中繼站分碼多工存取、零強制偵測器、最大相似法則 
 
 
Abstract 
In this paper, we present a two-stage multiuser detection (MUD) scheme for 
near-real-time relay CDMA systems. Relay communications have received intensive 
research attention recently because of their benefit of spatial diversity. However, 
existing works generally have serious latency problems, which will reduce 
transmission rates. To solve the problems, we consider a near-real-time transmission 
strategy for relay CDMA systems. Also, a two-stage MUD scheme is proposed for the 
detectors at the relays and the destination node to ensure the feasibility of the 
transmission strategy. The proposed MUD scheme first conducts the zero forcing (ZF) 
method to suppress the multiple access interfere and then uses the maximum 
likelihood (ML) mechanism to estimate the transmitted symbols. Specially, the 
two-stage MUD scheme only requires few computations to conduct the ML 
mechanism. Simulation results and complexity analysis show that the proposed 
scheme can not only provide significant diversity gain with a modest computational 
complexity but also assist relay CDMAs to facilitate the near-real-time transmission. 
 
Keywords: Multiuser Detection、Relay CDMA、Zero Forcing、Maximum Likelihood  
relays is more serious than those in the existing works. This                  III. 提出的方法 
is because the MAI in (1) is incurred by the source nodes’              
transmitted signal as well as the L − 1 relays’ regenerated       
 
 
 In this section, we proposed a two-stage MUD scheme              
for the detectors at the relays and the destination node to 
ensure near-real-time transmission of the considered relay 
CDMA system. The proposed scheme is detailed as the 
following subsections. 
signal. For brevity, we further rewrite (1) as   
 
 A. The symbol detection at the lth relay: 
where we let S = [s1 ,  s2 , · · ·  sK ] be the N × K spread- ing  
code  matrix;  b(m)   = [b1 (m),   b2 (m), · · ·,  bK (m)]T is  the  
transmitted  symbol  vector  at  the  th  time  period, where  
  First, the received signal rl  in (2) is passed through the 
matched filter bank S. Then, the corresponding result can be m
·)( T is the transpose operation [14]; jb
~
( m - 1) = [ ( m - 1),  jb1
~ expressed as  
 
n
jb2
~
( m - 1), ··· jkb
~
( m – 1 )] T is relay j’s estimate for b(m − 1); 
Wj  = diag{wj,1 , wj,2 , · · ·, wj,K } is the transmit 
beamforming matrix of relay j; and Hl = diag{hl,1 ,  
hl,2 ,   · · ·· , hl,K } is  the  K × K channel matrix between the 
K source nodes and the lth relay. 
 
where R  = ST S is the K × K spreading code correlation 
matrix; and ul (m) = ST nl (m) is the corresponding AWGN 
vector output with N (0, σ2 R). Furthermore, the key objective 
of the lth relay is to estimate the transmitted symbol vector b(m) 
from yl (m) in (4). Therefore, at relay l, the proposed two-
stage  MUD  scheme  first  conducts  the  ZF  method  to 
suppress the MAI effect and the output of the ZF mechanism 
is expressed as 
 
 
 
where (m) = [ ,· · · ,  ] T is the corresponding   
noise output vector. Furthermore, due to Hl and Wj both being 
K × K diagonal matrices, (5) can be re-expressed as 
lv )(1, mvl )(, mv kl
   (6) 
     Fig. 1.    Block Diagram Of The Near-Real-Time Relay CDMA System            
 Note that, at the mth symbol period, the lth relay has already 
obtained the estimates, lb1
~
(m - 1), · · · , lKb
~
(m - 1) for the K 
transmitted symbols b1(m - 1), · · · , bK(m - 1). We assume the 
estimates are all correct and substitute them into (6) to replace 
(m - 1), · · · , (m - 1) , j l. As a result, each element in 
(6) only contains a unknown symbol, e. g. (m) in (m). 
jb1
~ j
Kb
~ 
1b 1,lz
 Next, we assume the destination node is far from the source 
nodes and hence the received signal at the destination node is 
mainly contributed by the regenerated signals transmitted from 
the L relays. Then, similar to (2), the received signal of the 
destination node at the mth time period is expressed as 
 
    Next, the proposed scheme uses (6) and conducts the ML 
method to estimate bk(m), which is formulated as,       
 
  where nd (m) is the corresponding AWGN noise vector with 
N (0, σ2 IN )The destination node can use (3) and conduct 
the symbol detection mechanism at the mth time period to 
estimate the (m − 1)th time slot’s symbols, which are 
regenerated from the  L  relays.  In  such  a  detection  manner,  
only  a  symbol period delay will occur in a data frame. 
Therefore, the relay CDMA system we proposed can achieve 
the near-real-time transmission. 
                
 where  k  =  1, · · · , K and l  =  1, · · ·  , L  ;  || ·  ||   denotes 
 the Euclidean norm [14]; and we let )(,, mbh kklkl  + 
)1(~~ ,1 ,   mbwh lkkjj jl  for  notation  brevity.  As  a  result,   
the  lth  relay uses (7)  and  attains the  estimates for  the  K  
                                        
                                      
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
                                                        V. 結論 
 
In this paper, we address a two-stage multiuser detection    
scheme for near-real-time relay CDMA systems. To 
facilitate the near-real-time transmission strategy, a two-stage 
mult- iuser detection scheme is proposed for the detectors 
at the relays and the destination node. The proposed scheme 
first conducts the zero forcing mechanism to suppress the  
multipleaccess interference and then carries out the 
maximum like- lihood mechanism to estimate the transmitted 
symbols. Simulation results and complexity analysis show 
that at such a near-real- time transmission strategy, the 
proposed scheme can not only provide significant diversity 
gain with a modest computational complexity but also assist 
relay CDMAs to facilitate the near- real-time transmission 
 
 
國科會補助專題研究計畫成果報告自評表 附件二 
請就研究內容與原計畫相符程度、達成預期目標情況、研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）、是否適
合在學術期刊發表或申請專利、主要發現或其他有關價值等，作一綜合評估。
1. 請就研究內容與原計畫相符程度、達成預期目標情況作一綜合評估 
■達成目標 
□ 未達成目標（請說明，以 100 字為限） 
□ 實驗失敗 
□ 因故實驗中斷 
□ 其他原因 
說明： 
2. 研究成果在學術期刊發表或申請專利等情形： 
論文：■已發表 □未發表之文稿 □撰寫中 □無 
專利：□已獲得 □申請中 ■無 
技轉：□已技轉 □洽談中 ■無 
其他：（以 100 字為限） 
    已有兩篇論文發表於 IEICE Trans. Fundamentals 和 IEEE Transactions on  
Vehicular Technology (附件一和附件二) 
    且有一篇論文已被接受，將發表於 Applied Soft Computing(附件三) 
    並有兩篇論文發表於 2010 IEEE International Conference on Communication Technology  
    (附件四和附件五) 
    另有一篇論文於 IEEE 75th Vehicular Technology Conference 審查中(附件六) 
3. 請依學術成就、技術創新、社會影響等方面，評估研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）（以
500 字為限） 
目前多天線的研究已有相當的發展，藉由天線數增加可使空間多樣性增益隨之提高，進而
強化通訊品質。但手持式設備未來的發展趨勢必是輕巧和低成本。於是合作式通訊的作法
被提出。但以往的研究作法是訊號源與中繼站大多在不同的時槽傳送訊號，在大量傳輸
下，將產生嚴重的傳輸延遲問題。 
為了解決這個問題，我們使用一個接近即時的符元傳送機制於中繼分碼多工系統上。並且
在中繼站的偵測器和目的節點上，使用一個兩級多使用著偵測器的方法來確保傳送方法的
可行性。這個兩級多使用者偵測器方法是於第一級使用零強制偵測器方法來抑制多重存取
干擾，再於第二級用最大相似法則來估測傳送符元。這兩級式多使用者偵測器只需要少量
的運算複雜度處理最大相似法則。最後，模擬結果和複雜度分析顯示本計劃所提出的方法
不只可提供多樣性的增益，也使中繼分碼多工系統的符元傳送能夠接近即時。 
 
 3
附件三 
1892
IEICE TRANS. FUNDAMENTALS, VOL.E94–A, NO.9 SEPTEMBER 2011
LETTER
Reliable Decision-Aided Multiuser Detection for Cooperative
CDMAs∗
Hoang-Yang LU†a), Member and Yen-Yu CHEN†, Nonmember
SUMMARY In this paper, we propose a simple, yet effective, multiuser
detection scheme for a two-hop cooperative CDMAs. In phase 1, the min-
imum mean square error (MMSE) detector at the destination is used to
identify reliable decisions of direct transmissions from the sources and re-
turn them to the relays. Then, in phase 2, based on the reliable decisions,
the relays and the destination successively utilize the maximum likelihood
(ML) detectors to estimate the residual symbols. Due to the destination
estimating the symbols separately from direct transmissions and the relay-
ing signals, as a result the destination does not need the information about
the relays’ decision performance for the construction of the ML detector.
Hence, the proposed scheme is more feasible than existing approaches for
practical implementation. In addition, due to the ML detectors in phase
2 only estimating the residual symbols, the number of computations per-
formed by the ML detectors can be reduced significantly. The results of
simulations and complexity analysis demonstrate the efficiency and effec-
tiveness of the proposed scheme.
key words: multiuser detection, cooperative communication, code division
multiple access
1. Introduction
It has been shown that cooperative communications have the
potential to enhance the capacity and coverage of code di-
vision multiple access schemes (CDMAs) [1]. Numerous
feasible methods have been developed to guarantee the sys-
tem performance [1]. Among them, several multiuser detec-
tors (MUDs) with decode-and-forward (D&F) relay mecha-
nisms have been developed to alleviate multiple access inter-
ference (MAI) in cooperative CDMAs [2]–[5]. However, as
they are linear approaches (e.g., the minimum mean square
error (MMSE) method [6]), their performance degrades sig-
nificantly when the number of transmission sources is high.
Despite this drawback, some decisions of the linear detec-
tors are more reliable than others, as shown in [7]. That is,
the other decisions are unreliable and dominate the perfor-
mance of the detectors. Although the maximum likelihood
(ML) method [6] is the optimum approach and more robust
under heavy transmission loads, the computational com-
plexity is prohibitive. Moreover, in the cooperative schemes
[2]–[5], detectors at the destination stack two received sig-
nal components together for symbol estimation; one is the
direct transmission signal from the sources; and the other is
Manuscript received April 26, 2011.
Manuscript revised May 24, 2011.
†The authors are with the Department of Electrical Engineer-
ing, National Taiwan Ocean University, Keelung, Taiwan, R.O.C.
∗This work was supported by National Science Council of
R.O.C. under contract NSC 99-2221-E-019-026.
a) E-mail: hylu@mail.ntou.edu.tw
DOI: 10.1587/transfun.E94.A.1892
the regenerated signal from the relays. In addition, to build
the detectors at the destination, the relays’ decision infor-
mation, such as in Eq. (23) in [5], must be forwarded to the
destination. Generally, the value of the decision information
is real, which usually makes the relays’ works difficult.
To address the above-mentioned problems, we pro-
pose a reliable decision-aided multiuser detection scheme
for cooperative CDMAs. First, based on the findings in
[7], in phase 1 the scheme exploits the MMSE detector
at the destination to obtain reliable outputs from the di-
rect transmissions sent by sources to the destination. Then,
the derived outputs are passed through the sigmoid func-
tion to find reliable decisions. After that, the reliable deci-
sions are decoded as BPSK symbols and the residual sym-
bols are set to zeros. Next, the destination returns the reli-
able BPSK decision symbols and residual symbols to the
relays via the low-rate feedback channel to help the re-
lays regenerate the estimated signal of the residual symbols
which were unreliable in the direct transmission. As the
proposed scheme returns three discrete values (i.e., +1, −1,
and 0), it only needs low-rate channels, which are more ef-
ficient for practical implementation than those in conven-
tional schemes [2]–[5]. Note that because the returned val-
ues are zeros and binary numbers, such as {−1, 1} for BPSK
and {(−1,−1), (−1, 1), (1,−1), (1, 1)} for QPSK modulated
symbols, the proposed scheme in turn can be directly ap-
plied in BPSK methods and easily extended to other modu-
lation schemes. In addition, with the help of the reliable de-
cisions, the relays and the destination only need to estimate
the residual symbols in the next phase. Therefore, in phase
2, the relays and the destination can successively exploit the
ML method to enhance the performance because its compu-
tational complexity is reasonable in this case. Moreover, due
to the destination estimating the symbols separately from di-
rect transmissions and the relaying signals, as a result the
destination does not need the information about the relays’
decision performance for the construction of the ML detec-
tor. Hence, the proposed scheme is more feasible than ex-
isting approaches for practical implementation. To further
improve the performance, the relays use the beamforming
approach proposed in [5] to forward the regenerated signals
for the residual symbols to the destination. The results of
computer simulations and complexity analysis demonstrate
that our scheme achieves a substantial performance gain
over existing approaches; and the computational overhead
is acceptable, especially under a heavy transmission load.
Copyright c© 2011 The Institute of Electronics, Information and Communication Engineers
1894
IEICE TRANS. FUNDAMENTALS, VOL.E94–A, NO.9 SEPTEMBER 2011
where C1 = ST1 S1; S1 = [s1 · · · sK1] is the spreading ma-
trix for the reliable decision vector uˆ1; and H js1 and P1 are
the corresponding K1 × K1 diagonal channel and transmis-
sion power matrices respectively. In addition, the relays use
the locations of the zeros on the vector ˜d to determine the
sources that need to be regenerated. To enhance the relia-
bility of the relay mechanism, we utilize the ML detector
at relay j, j = 1 · · · L to estimate the residual symbols, ex-
pressed as
u˜⊥j = arg min
u⊥
||r⊥j − C⊥H⊥jsP⊥
1
2
u⊥||, (7)
where j = 1 · · · L; C⊥ = ST2 S2; S2 = [sK1+1 · · · sK] is the
spreading matrix for the residual symbols u⊥; and H⊥js and
P⊥ are the corresponding (K−K1)× (K−K1) diagonal chan-
nel and transmission power matrices respectively. Note that,
by carefully selecting a reliable threshold η in (3) to guar-
antee that K1 ≤ 0.5K, the amount of computation needed
for (7) to find u⊥ is substantially lower than that carrying
the ML detector for (2) to find u. We also adopt the trans-
mit beamforming mechanism proposed in [5] to forward the
regenerated signal of the residual symbols to the destina-
tion. Then, in phase 2, the received signal in (3) can be
re-expressed as
b⊥2 =
L∑
j=1
hd j p¯
1
2
j C
⊥W⊥j u˜⊥j + n⊥2 , (8)
where W⊥j , and u˜⊥j are the transmit beamforming matrix,
and the estimate of the residual symbols for relay j respec-
tively. Finally, as in (7), the destination applies the ML de-
tector to b⊥2 to obtain the estimates of u⊥, denoted as uˆ⊥2 .
Then, the final solution is ˆd = [uˆT1 uˆ⊥
T
2 ]T . Note that, simi-
lar to the ML detectors at the relays, the ML detector at the
destination only needs to estimate the residual symbols u⊥;
hence, it also requires less computation than that carrying
the ML detector in (1) to find u.
4. Experimental Results and Discussions
Let the simulation profile of the cooperative CDMA system
be K = 14, L = 8, and N = 16. In addition, we assume
that the channels Hds, H js, and Hd j, j = 1 · · · L are all flat
Rayleigh fading channnels. To achieve a balance between
the computational complexity and the performance [7], we
choose reliable thresholds, η, for different SNR scenarios
such that (K − K1) = ⌊0.4K⌋ or ⌊0.45K⌋, where ⌊x⌋ de-
notes that the largest integer does not exceed x. To evalu-
ate the proposed scheme’s performance in terms of the av-
erage bit error rate (BER), we compare it with the following
schemes: the MMSE MUD [6], the ML MUD [6], the relay-
assisted decorrelating (RAD) MUD with relay-destination
(RD) beamforming (RAD-RD-BF) [5], and the RAD MUD
with source-relay-destination (SRD) beamforming (RAD-
SRD-BF) [5]. We also analyze the computational complex-
ity of the five schemes in terms of complex multiplications
and additions (CMAs) for the five schemes. In addition,
Fig. 2 Comparison of BER versus SNR.
Table 1 Comparison of the computational complexity of the proposed
schemes with that of existing schemes.
MUDs Computational Complexity
K = 14, L = 8, N = 16
MMSE MUD 4K3 + K2
ML MUD NK2 + 2K (NK + N)
RAD-RD-BF L(5K3 + 2K2 + 2K + 3L + 4)+
3
25 K
3 + 2K2 + 14K
RAD-SRD-BF L( 325 K3 + +2K2 + 2K + 3L2 + 5L + 5)+3
13 K
3 + 2K2 + 14K + 1
Proposed ⌊0.4K⌋ 4K3 + K2 + L(N(⌊0.4K⌋)2+
N⌊0.4K⌋ + N) × 2⌊0.4K⌋)+
2⌊0.4K⌋[(N(⌊0.4K⌋) + L⌊0.4K⌋)]+
⌊0.4K⌋)2 + N]
Proposed ⌊0.45K⌋ 4K3 + K2 + L(N(⌊0.45K⌋)2+
N⌊0.45K⌋ + N) × 2⌊0.45K⌋)+
2⌊0.45K⌋[(N(⌊0.45K⌋) + L⌊0.45K⌋)+
⌊0.45K⌋)2 + N]
to ensure that the comparison is fair, the total transmission
power of the MMSE MUD and the ML MUD schemes is
2Ps. The results of computer simulations and complexity
analysis are shown in Fig. 2 and Table 1, respectively; and
the corresponding results derived by substituting the practi-
cal values for the system parameters are shown in Table 2.
From the figure, we observe that MMSE MUD and ML
MUD do not perform as well as the other three schemes.
This is because they do not have a relay mechanism, which
provides cooperative diversity to enhance the performance.
We also observe from the tables that ML MUD requires
the largest number of computations since the complexity in-
creases exponentially with the number of sources. With re-
gard to the RAD-RD-BF and the RAD-SRD-BF schemes,
although their computational complexity is acceptable, they
both use linear approaches to estimate the transmitted sym-
bols. Hence, their performance degrades significantly when
the number of sources is high. By contrast, the proposed
scheme returns the reliable decisions derived by the MMSE
detector in phase 1 to find the sources that need the relays’
 
 
 
附件二 
LU: MUDs FOR SFT-DOMAIN SPREAD MC DS-CDMA SYSTEMS 1641
antenna arrays. It has been shown that receivers equipped with
antenna arrays provide spatial diversity [26], [28], which in-
creases the signal space and thereby reduces the effects of MAI.
Because the direction of arrival of each user’s transmitted signal
to receive antenna arrays is usually different, the corresponding
antenna response is usually referred to as the spatial-domain
(S-domain) signature code. This implies that an FT-domain
spread MC DS-CDMA system with multiple antennas can be
regarded as a spatial–frequency–time-domain (SFT-domain)
spread MC DS-CDMA system. Therefore, developing feasible,
yet low-complexity, MUDs for the three-domain (3D) spread
MC DS-CDMAs is an important issue; however, there is a
dearth of literature on such uplink systems. 1
In this paper, we propose three low-complexity MMSE
MUDs for the uplink of SFT-domain spread MC DS-CDMA
systems. Each MUD is composed of a one-domain (1D)
MMSE detector and a corresponding 2D MMSE detector,
which are iteratively updated to estimate the transmitted sym-
bols. The proposed schemes are called the S- and FT-domain
(S–FT-domain) MMSE MUD, the F- and spatial–time-domain
(F–ST-domain) MMSE MUD, and the T- and spatial–fre-
quency-domain (T–SF-domain) MMSE MUD. Each MUD
scheme converts a received signal into a specific format and
then employs the alternating method proposed in [27], [30],
and [31 ] to estimate the transmitted symbols iteratively.
Specifically, the 1D detector of each MUD is fixed when the
corresponding 2D detector is being updated, and vice versa.
The update mechanism ensures that the weight of each MMSE
detector is refined each time because the other detector derived
a better weight in the previous iteration. The proposed schemes
are hard-decision MUDs, which are different from the iterative
approaches in [27] and [32]. This is because [27] uses the
information about soft decisions to update two 1D MMSE
detectors alternately, whereas [32] exchanges the information
about soft decisions between the MUD and the forward-error
correction decoder iteratively. Using soft information enables
these two iterative approaches to enhance the performance but
at the expense of increased hardware costs and computational
complexity. We analyze the performance of the proposed
schemes in terms of the bit-error-rate (BER) bound, conver-
gence, and computational complexity. Note that, although the
joint SFT-domain MMSE MUD can achieve an optimum MSE
result, the computational overhead is excessive. In contrast, the
computational complexity of the proposed MMSE schemes
with separate detectors is much lower because the 1D and
2D MMSE detectors are utilized effectively. The results of
simulations demonstrate that the schemes can converge in a
few iterations and achieve a performance close to that of the
joint SFT-domain MMSE MUD in most scenarios.
The remainder of this paper is organized as follows: In Sec-
tion II, we describe our system model. We discuss the proposed
schemes and the performance analysis in Sections III and IV,
respectively. In Section V, we detail the simulation results to
demonstrate the effectiveness of the proposed schemes. Sec-
tion VI contains some concluding remarks.
1For downlink SFT-domain MC DS-CDMA systems, a scheme to design fea-
sible system parameters, such as the chip duration, to achieve transmission di-
versity was proposed in [29].
Fig. 1. Transmitter model of the SFT-domain spread MC DS-CDMA.
Fig. 2. Receiver model of the SFT-domain spread MC DS-CDMA.
II. SYSTEM MODEL
Consider the uplink of a synchronous2 MC DS-CDMA
system, as shown in Figs. 1 and 2, with antennas deployed
at the base-station receiver. For simplicity, we assume that,
after removing the cyclic prefix and performing the fast
Fourier transform operation at the base station, the channel
information and all signature codes are fully available at the
receiver. In addition, there are users simultaneously trans-
mitting binary phase-shift keying (BPSK)-modulated symbols
over the frequency-selective Rayleigh fading channels [11]
to the base station. Before transmission, the BPSK symbols
are spread by their own unique T-domain signature codes.
Then, they are copied to each subcarrier and multiplied by
the corresponding element of each user’s unique F-domain
signature code. Let and
be the T- and F-domain
signature codes of the th user, respectively, where and
are the lengths of the associated signature codes, and
denotes the transpose operation. Then, the baseband discrete
2We only consider the synchronous MC DS-CDMA in this paper, as it has
been shown in [33 ] that an asynchronous -user system can be equivalent to a
synchronous    -user system. Therefore, for ease of presentation, we only
consider synchronous systems. The proposed algorithms can be easily extended
to asynchronous scenarios.
LU: MUDs FOR SFT-DOMAIN SPREAD MC DS-CDMA SYSTEMS 1643
where
denotes the effective F-domain signature vector of the th re-
ceive antenna for the th user. is the associated AWGN
matrix. In addition, for simplicity, we denote
.
.
.
.
.
.
.
.
.
.
.
.
as the effective F-domain signature matrix and the
ST-domain signature matrix, respectively, for user
. Then, the expression for the received signal in (6)
can be rewritten as
(7)
As shown in (4) and (6), as well as in (1), we collect all the chip-
time received signals of a prescribed symbol time at the th sub-
carrier and th antenna, and stack them to form the T-domain
received signal vectors ,
, . Then, we combine the vec-
tors to obtain the complete received signal , as follows:
(8)
where denotes
the effective SF-domain signature vector for user ,
and is the corresponding AWGN matrix.
III. PROPOSED SCHEMES
Here, we describe the proposed low-complexity MMSE
MUDs, each of which estimates the transmitted symbols it-
eratively by utilizing the corresponding 1D and 2D MMSE
detectors alternately. We also use the joint SFT-domain MMSE
MUD, which requires a prohibitive number of computations to
invert a large matrix, as a benchmark to compare the perfor-
mance of the proposed schemes.
A. Joint SFT-Domain MMSE MUD
First, we invoke the joint SFT-domain MMSE MUD
for user by minimizing the following cost function:
(9)
where ; indicates the Hermitian operation [35]
and is the SFT-domain complete received
signal, which is expressed as
(10)
where , , , and
is the received signal defined in (1); is the
SFT-domain effective signature vector for user ; and de-
notes the associated AWGN vector. Then, after some manipu-
lations, the solution to (9) is derived as follows:
(11)
From (11), it is clear that, to find the joint SFT-domain MMSE
MUD, incurs a large computational overhead because
of the number of operations required to compute the inversion
of a large matrix; hence, implementing
the joint SFT-domain MMSE scheme is not feasible. To address
this problem, we propose three low-complexity MMSE MUDs,
which we discuss in the following sections.
B. Proposed Low-Complexity MMSE MUDs
Using the three formats for received signals defined in (5),
(7), and (8), respectively, we develop the corresponding low-
complexity MMSE MUDs as follows.
S–FT-Domain MMSE MUD : Based on the structure of the
received signal matrix defined in (5), we use the
S-domain MMSE detector and the FT-domain
MMSE detector to construct the S–FT-domain MMSE
MUD for a user . The objective is to minimize the error be-
tween the transmitted bit and the output of the S–FT-domain
MMSE MUD. The problem can be formulated as follows [30]:
(12)
where , and is the complex conjugate operation.
It has been shown that computing a minimization like that in
(12) to jointly determine and does not have a closed-
form solution expression [27], [30], [31]. Hence, we utilize the
alternating method proposed in [27] and [31 ] to determine the
detectors and iteratively as follows.
For ease of presentation, we assume that the S- and FT-do-
main MMSE detectors of the previous iterations of the
proposed S–FT-domain MMSE MUD were determined by the
alternating method. Then, at the th iteration, we first fix the
FT-domain detectors , to ,
, which are found at the th iteration. Then,
substituting (5) into (12), the solution to (12) can be easily de-
rived as follows:
LU: MUDs FOR SFT-DOMAIN SPREAD MC DS-CDMA SYSTEMS 1645
(20)
respectively, where ; and and are
the T- and SF-domain MMSE detectors at the th iteration for
user , respectively. Furthermore, in each iteration, we need to
compute the inversions of the and
matrices.
IV. PERFORMANCE AND COMPLEXITY ANALYSIS
A. BER Performance
Here, we derive the BER of the joint SFT-domain MMSE
MUD as the benchmark to compare the performances of the
three proposed low-complexity MMSE MUDs. First, for ease
of derivation, the joint SFT-domain received signal in (10) is
reexpressed as
(21)
where and
diag are the effective SFT-domain signa-
ture and the transmission power matrices, respectively; and
is the transmitted symbol vector.
The estimated symbol for the joint SFT-domain MMSE
MUD of user , i.e., , , in (11) is
sgn ; sgn is the signum function [1],
and is the real part of . Then, the BER of user can
be derived as follows [1], [6]:
BER
(22)
where , and .
Verdú and Poor showed that the MAI of the MMSE detector’s
output signal can be assumed to be approximately Gaussian
when the number of users is large [1]. As a result, the BER in
(22) can be further approximated as follows [1], [6] :
BER
(23)
where is the th element of
vector , and
. In Section V,
we use (23) to compute the theoretical BER of the joint
SFT-domain MMSE MUD as the performance benchmark
for the three proposed schemes.
B. Convergence Performance
To evaluate the convergence performance of the proposed
schemes, we focus on the S–FT-domain MUD and generalize
the result to the F–ST- and T–SF-domain MUDs. Following [36
], the MSE function in (12) for user can be written as
MSE
(24)
where . From (24), we can observe that the
MSE function used to jointly determine and is not
a convex function. However, when one of the two MMSE
detectors is fixed, the MSE function in the other MMSE
detector is convex and can be uniquely determined. Therefore,
the resulting detector is the MMSE solution to (24), although
it may only be suboptimal. Using the alternating method [27],
[30], [31], we first implement the S–FT-domain MUD shown in
(13) and (14) with the initial and . Then, we fix
and find MMSE by (13).
Because in (13) is equal to , is the MMSE
solution to the convex function MSE in (24), which means that
MSE MSE . Next, we
fix and compute MMSE
by (14). Likewise, that leads to MSE
MSE . By using a procedure similar to that
described earlier and because the MSE results in (12) are
bounded below by zeros, the MSE of the S–FT-domain MUD
monotonically decreases and finally converges at the optimum
MMSE detectors and , where the optimum MMSE is
obtained.
C. Computational Complexity
We evaluate the computational complexity of the proposed
MMSE MUDs based on the number of complex multiplica-
tions/divisions (CMD) and complex additions/subtractions
(CAS) required. First, for the joint SFT-domain MMSE
MUD discussed in Section III-A, the main computational
load involves computing the inversion of the
matrix, which needs CMDs and
CASs [37]. For
the S–FT-domain MMSE MUD, based on (13) and (14),
we need to compute the inversions of the and
matrices, respectively, for the S- and FT-do-
main detectors of each user. This implies that they require
CMDs and
CASs, respectively, for each user
in each iteration. Therefore, to construct the S–FT-domain
MMSE MUD, we need CMDs and
LU: MUDs FOR SFT-DOMAIN SPREAD MC DS-CDMA SYSTEMS 1647
Fig. 4. Convergence of BER versus SNR for the F–ST-domain MMSE MUD at
    ,    ,   , and    . (a) Random vectors with unit norm
and their coefficients uniformly distributed in (  1, 1). (b) F-domain signature
codes.
Fig. 5. Convergence of BER versus SNR for the S–FT-domain MMSE MUD at
   ,    ,   , and    . (a) Random vectors with unit norm
and their coefficients uniformly distributed in (  1, 1). (b) S-domain signature
codes.
we observe that the proposed T–SF-domain scheme, which ran-
domly chooses initials, converges at about the fourth iteration;
however, the T–SF-domain scheme with the T-domain signa-
ture codes as the initials converges at about the third iteration.
At this point, the BER performances of the two kinds of initials
are almost the same. Furthermore, using the same system pa-
rameters defined earlier, we carry out the F–ST- and S–FT-do-
main MMSE MUDs. The results are listed in Figs. 4(a) and
(b) and 5(a) and (b), respectively. From the figures, we draw
similar conclusions to those derived from Fig. 3. That is the
proposed schemes that choose initials at random converge at
about the third or the fourth iteration, whereas the proposed
schemes that use the corresponding signature codes as the ini-
tials converge at about the third iteration. If we change
Fig. 6. Convergence of BER versus SNR for the T–SF-domain MMSE MUD
at    ,    ,    , and    . (a) Random vectors with
unit norm and their coefficients uniformly distributed in ( 1, 1). (b) T-domain
signature codes.
Fig. 7. Convergence of BER versus SNR for the F–ST-domain MMSE MUD
at    ,    ,    , and    . (a) Random vectors with
unit norm and their coefficients uniformly distributed in ( 1, 1). (b) F-domain
signature codes.
to and leave the other parameter settings un-
changed, the corresponding performance results of the proposed
schemes, as shown in Figs. 6 –8, all degrade compared with
those in Figs. 3–5. Nevertheless, the proposed schemes still con-
verge at about the third or the fourth iteration. Note that the
proposed schemes with the corresponding 1D signature codes
as initials generally converge at the third iteration and usually
yield slightly better BER results than the schemes that choose
initials in a random manner. Based on the aforementioned re-
sults and because of the assumption that the 1D signature codes
are fully known at the receiver, we use the 1D signature code as
the initials for the three proposed schemes and set the number
of iterations for the schemes at 3 in the following simulations.
From the results, we observe that we can set the number of the
LU: MUDs FOR SFT-DOMAIN SPREAD MC DS-CDMA SYSTEMS 1649
Fig. 12. Comparison of BER versus SNR at      and     . (a)
   , and    . (b)    , and     .   Single-user bound.
 Theoretical result of the SFT-domain MMSE.  Simulation result of the
SFT-domain MMSE.   S–FT-domain MMSE.   F–ST-domain MMSE.
 T–SF-domain MMSE.
proposed MUDs are constructed by the corresponding signa-
ture codes; hence, the performances of the proposed schemes
are inevitably affected by the signature codes used. Moreover,
because the dimensions of the 1D detectors are lower than those
of the corresponding 2D detectors, in terms of performance,
the corresponding signature codes used in the 1D detectors
are more important than those used in the 2D detectors. In the
proposed schemes, the entries of the S-domain signature codes
are complex numbers, whereas those of the F- and T-domain
signature codes are real numbers. This means the S-domain
detectors of the S–FT MUD provide a wider signal space than
the F-domain detectors of the F–ST and the T-domain detectors
of the T–SF schemes. As a result, S–FT MUD outperforms the
other two proposed schemes.
The system parameters in Fig. 10(a) and (b) are the same as
those in Fig. 9(a) and (b), respectively, except that .
From the figures, we observe that the performances of the pro-
posed schemes and the joint SFT-domain MMSE MUD all de-
grade. However, the conclusions drawn from Fig. 9(a) and (b)
are still validated by the results in Fig. 10(a) and (b) , which are
given as follows: 1) The performances of the proposed schemes,
particularly for the S–FT-domain MUD, are close to those of
the joint SFT-domain MMSE MUD; and 2) the S–FT-domain
MUD outperforms the other two proposed schemes.
Finally, we change the number of receive antennas in
Figs. 9 and 10 to and leave the other parameters un-
changed. The results are shown in Figs. 11 and 12, respectively.
We observe from Figs. 9 –12 that the three proposed schemes
and the joint SFT-domain MMSE MUD perform better when
we change to . This is because more antennas
provide higher spatial diversity.
VI. CONCLUSION
In this paper, we have presented three low-complexity, yet
effective, MUDs for SFT-domain spread MC DS-CDMA sys-
tems. First, to develop the proposed MUDs, we employed three
formats of the complete received signal. Then, each MUD esti-
mated the transmitted symbols iteratively by using the 1D and
2D detectors alternately. We analyzed the performance of the
proposed schemes in terms of the BER bound, convergence,
and computational complexity. The results of simulations show
that the performance of the proposed MUDs is close to that of
the joint SFT-domain MMSE MUD in most scenarios but with
lower computational overheads.
ACKNOWLEDGMENT
The authors would like to thank the reviewers for many
thoughtful comments and suggestions, which have enhanced
the quality and readability of this paper.
REFERENCES
[1] S. Verdú, Multiuser Detection. Cambridge, U.K.: Cambridge Univ.
Press, 1998.
[2] H. Holma and A. Toskala, WCDMA for UMTS-Radio Access for Third
Generation Mobile Communications. New York: Wiley, 2002.
[3] E. Alsusa and C. Masouros, “Adaptive code allocation for interference
management on the downlink of DS-CDMA systems ,” IEEE Trans.
Wireless Commun., vol. 7, no. 7, pp. 2420–2424, Jul. 2008.
[4] G. W. K. Colman and T. J. Willink, “Overloaded array processing using
genetic algorithms with soft-biased initialization ,” IEEE Trans. Veh.
Technol., vol. 57, no. 4, pp. 2123–2131, Jul. 2008.
[5] Y. J. Zhang and K. B. Letaief, “An efficient resource-allocation scheme
for spatial multiuser access in MIMO/OFDM systems ,” IEEE Trans.
Commun., vol. 53, no. 1, pp. 107–116, Jan. 2005.
[6] W.-J. Huang, Y.-W. P. Hong, and C.-C. J. Kuo, “Relay-assisted decor-
relating multiuser detector (RAD-MUD) for cooperative CDMA net-
works ,” IEEE J. Sel. Areas Commun., vol. 26, no. 3, pp. 550–560, Apr.
2008.
[7] S. Hara and R. Prasad, “Overview of multicarrier CDMA,” IEEE
Commun. Mag., vol. 35, no. 12, pp. 126–133, Dec. 1997.
[8] L. Hanzo, L.-L. Yang, E.-L. Kuan, and K. Yen, Single- and Multi-Car-
rier DS-CDMA: Multi-User Detection, Space–Time Spreading,
Synchronisation, Standards and Networking. Piscataway, NJ: IEEE
Press, 2003.
[9] P. Xiao and R. Liu, “Multi-user detector for multi-carrier CDMA sys-
tems,” Electron. Lett., vol. 44, no. 23, pp. 1366–1368, Nov. 2008.
[10] M. Guenach and H. Steendam, “Performance evaluation and parameter
optimization of MC-CDMA,” IEEE Trans. Veh. Technol., vol. 56, no.
3, pp. 1165–1175, Mar. 2007.
[11] J. G. Proakis and M. Salehi, Digital Communications, 5th ed. New
York: McGraw-Hill, 2008.
[12] C. W. You and D. S. Hong, “Multicarrier CDMA systems using
time-domain and frequency-domain spreading codes,” IEEE Trans.
Commun., vol. 51, no. 1, pp. 17–21, Jan. 2003.
[13] L.-L. Yang, W. Hua, and D. S. Hong, “Multiuser detection assisted
time- and frequency-domain spread multicarrier code-division mul-
tiple-access,” IEEE Trans. Veh. Technol., vol. 55, no. 1, pp. 397–404,
Jan. 2006.
[14] L.-L. Yang and L.-C. Wang, “Zero-forcing and minimum mean-square
error multiuser detection in generalized multicarrier DS-CDMA sys-
tems for cognitive radio,” EURASIP J. Wireless Commun. Netw., vol.
2008, no. 5, pp. 1–13, 2008, Article ID 541410, DOI:10.1155/2008/
541410.
[15] K. Yuan, W. Liu, and L.-L. Yang, “Reliability-aided multiuser de-
tection in time–frequency-domain spread multicarrier DS-CDMA
systems,” in Proc. IEEE Veh. Technol. Conf., 2009, pp. 1–5.
[16] P. Pan, Y. Zhang, and L.-L. Yang, “Asymptotic performance analysis
of time–frequency-domain spread MC DS-CDMA systems employing
MMSE multiuser detection,” in Proc. IEEE Veh. Technol. Conf., 2010,
pp. 1–5.
[17] P.-H. Chang, L.-K. Ye, and J.-R. Chen, “Genetic algorithm based mul-
tiuser detection in multi-carrier DS-CDMA system,” in Proc. IEEE
Radio Wireless Symp., 2008, pp. 271–274.
[18] P. Pan, L.-L. Yang, and Y. Zhang, “Time-frequency iterative multiuser
detection in time–frequency-domain spread multicarrier DS-CDMA
systems over Nakagami- fading channels,” Eur. Trans. Telecommun.,
vol. 22, no. 1, pp. 2–13, Jan. 2011.
 
 
 
附件三 
 
 
 
 
 
Please cite this article in press as: H.-Y. Lu, Particle swarm optimization assisted joint transmit/receive antenna combining for multiple
relays in cooperative MIMO systems Appl. Soft Comput. J. (2011), doi:10.1016/j.asoc.2011.03.017
ARTICLE IN PRESSG ModelASOC-1149; No.of Pages10
2 H.-Y. Lu / Applied Soft Computing xxx (2011) xxx–xxx
Fig. 1. Block diagram of a two-hop cooperative MIMO system.
In thispaper,weuse theparticle swarmoptimization (PSO)algo-
rithm[23,24] toaddress theproblemof combining transmit/receive
antennas in cooperative MIMO systems. The PSO algorithm, an
evolutionary approach, has been used to solve many complex opti-
mization problems in various ﬁelds. Similar to the GA, the PSO
algorithm searches for solutions iteratively and usually achieves
optimal or near-optimal results. In fact, a number of studies in var-
ious ﬁelds have shown that the performance of PSO algorithms is
generally better than that of GAs [25–27]. Furthermore, because
computing the AC matrices for the transmit/receive antennas of
multiple relays jointly is prohibitively complex, we adopt the PSO
algorithm to resolve the problem. Under the proposed scheme,
the relays use the AC matrices found by the PSO algorithm to
weight the signals transmitted by the source node and then for-
ward the weighted signals to the destination node. As a result, the
relays can reduce the number of RF chains so that there are less
RF chains than the number of transmit/receive antenna elements.
This in turn reduces the hardware costs involved in deploying RF
chains. Moreover, as fewer RF chains are used, the relays require
less power than the relays in schemes that use all the RF chains.
The results of computer simulation demonstrate that the proposed
PSO scheme outperforms the full RF-chain relaying method and
existing approaches in some situations.
The remainder of this paper is organized as follows. Section 2
describes a two-hop cooperative communication model for corre-
lated MIMO channels. In Section 3, we introduce the proposed PSO
scheme, which is used to address the problem of combining trans-
mit/receive antennas. In Section 4, we analyze the convergence of
thePSOscheme; and inSection5,wepresent the simulation results.
Section 6 contains some concluding remarks.
2. Signal model
We consider a two-hop cooperative MIMO system in which the
transmission is divided into two phases, as shown in Fig. 1. In the
ﬁrst phase, the source node uses antennas to transmit the sig-
nals over the correlated fading channels to the receive antennas
at the destination node. Because of radio propagation, the trans-
mitted signals also affect the receive antennas of the relays at the
same time. Without loss of generality, we assume that the num-
bers of transmit/receive antennas of each relay are both N. In the
second phase, the relays use the AF relaying method to forward
the signals received in phase 1 to the destination node. In this
paper, we adopt the Kronecker correlation channel model [28],
which is widely used in correlated MIMO systems. For simplicity,
we assume that the source anddestination nodes are near rich scat-
tering environments; hence, the channels’ correlations only exist
at the transmit/receive sides of the relays. The channel between
the source node and the lth relay as well as the channel between
the lth relay and the destination node are denoted, respectively, by
Sl = R1/2l HSl and Dl = HDlT
1/2
l
, 1≤ l≤ L, where HSl and HDl are the
corresponding N×N uncorrelated channel matrices; the entries of
HSl and HDl are assumed to be complex Gaussian random variables
withN(0, 1); L is the number of relays; Tl andRl are the correspond-
ing statistical correlation matrices for the transmit/receive sides of
the lth relay. The elements of the statistical correlation matrices Tl
and Rl can be approximated as follows [28]:
[Tl]m,n ≈ e−j2(m−n)dD cos(¯D,l)e
−1
2 [2(m−n)dD sin(¯D,l)D,l], (1)
and
[Rl]m,n ≈ e−j2(m−n)dS cos(¯S,l)e
−1
2 [2(m−n)dS sin(¯S,l)S,l], (2)
respectively, where [X]m,n denotes the (m, n) th entry of matrix X;
dD and dS are the distances between the adjacent transmit/receive
antenna elements of the relays; S,l and D,l are the correspond-
ing angles of arrival (AOA) and angles of departure (AOD), which
are assumed to be Gaussian distributed with S,l∼N(¯S,l, 2S,l)
and D,l∼N(¯D,l, 2D,l); then, the received signal at relay l can be
expressed as
rl = Slb + nl, 1 ≤ l ≤ L, (3)
where b is theN×1 symbol vector transmitted by the source node;
nl is the corresponding additivewhite Gaussian noise (AWGN) vec-
tor with N(0, 2
l
IN); IN is the N×N identity matrix. Furthermore,
after receiving the signal transmitted by the source node, the relays
use the AF relaying method to forward it to the destination node.
For simplicity, we assume that the distance between the source
and the destination nodes is far enough so that a direct transmis-
sion from the source node to the destination node is ignored. Then,
the signal y transmitted by the relays in phase 2 and received by
the destination node can be expressed as
y =
L∑
l=1
alDlrl + u =
L∑
l=1
alDl{Slb + nl} + u, (4)
where u is the corresponding AWGN vector with N(0, 2u IN)
and al is the forward gain of the lth relay. We assume that
the Vertical Bell Laboratories Layered Space-Time (VBLAST) min-
imum mean square error (MMSE) detector [29] is applied at
the destination node. In addition, to simplify the derivation, we
let S,1 = · · ·=S,L =D,1 = · · ·=D,L =1 = · · ·=L =u =. Therefore,
according to (3) and (4), the ergodic capacity of a cooperativeMIMO
system can be formulated as follows:
C = 1
2
E
⎧⎨
⎩log2
∣∣∣∣∣∣IN +
Ps
N2
(
L∑
l=1
alDlSl
)(
L∑
l=1
alDlSl
)H
×
(
IN +
L∑
l=1
a2l DlD
H
l
)−1∣∣∣∣∣∣
⎫⎬
⎭ , (5)
where (·)H denotes theHermitian operation; E {·} is the expectation
operation; and Ps is the total transmission power of the source node
in phase 1. The factor 1/2 in (5) is because the signal vector b is
transmitted in two time slots.
3. The proposed scheme
3.1. Preliminary
The objective of AC methods for MIMO systems [21] is to lin-
early combine N receive antenna gains with Q RF chains, under the
Please cite this article in press as: H.-Y. Lu, Particle swarm optimization assisted joint transmit/receive antenna combining for multiple
relays in cooperative MIMO systems Appl. Soft Comput. J. (2011), doi:10.1016/j.asoc.2011.03.017
ARTICLE IN PRESSG ModelASOC-1149; No.of Pages10
4 H.-Y. Lu / Applied Soft Computing xxx (2011) xxx–xxx
0 5 10 15 20
100
101
SNR (dB)
Ca
pa
cit
y 
(bi
ts/
s/H
z)
(a)
P=20, G=10
P=25, G=20
P=30, G=30
P=35, G=30
0 5 10 15 20
100
101
SNR (dB)
Ca
pa
cit
y 
(bi
ts/
s/H
z)
(b)
P=20, G=10
P=25, G=20
P=30, G=30
P=35, G=30
Fig. 4. Convergence of the proposed PSO scheme with N=4, L=4, (a) Q=1 and (b) Q=2.
generation can be updated by
Vj+1Tl (i) = ˛1V
j
Tl
(i) + ˇ1Z1  (LjTl (i) − C
j
Tl
(i)) + 1Z2  (GjTl − C
j
Tl
(i)),
(10)
and
Vj+1Rl (i) = ˛2V
j
Rl
(i) + ˇ2F1  (LjRl (i) − C
j
Rl
(i)) + 2F2  (GjRl − C
j
Rl
(i)),
(11)
respectively,where i=1 . . .P and l=1 . . . L;˛1 and˛2 are the inertial
weights; ˇ1, ˇ2 and 1, 2 are the movements’ weights of the local
and global optimum positions, respectively;  is the Hadamard
product operator [30]; and Zi and Fi, i=1, 2 are N×Q and Q×N
matrices,whoseentries are randomvariablesuniformlydistributed
between 0 and 1.
3.2.4. Position update
After updating the velocities of the particles for the next gener-
ation, the corresponding particles’ positions can be updated by
Cj+1Tl (i) = C
j
Tl
(i) + Vj+1Tl (i)t, 1 ≤ i ≤ P, 1 ≤ l ≤ L, (12)
and
Cj+1Rl (i) = C
j
Rl
(i) + Vj+1Rl (i)t, 1 ≤ i ≤ P, 1 ≤ l ≤ L, (13)
respectively, where t is the time duration, which is usually set
at 1. Note that after using (12) and (13) to determine the Cj+1Tl (i)
and Cj+1Rl (i), their corresponding vectors must also be normalized to
avoid amplifying the received signal.
3.2.5. Repeat/end
The above three evolutionary steps are repeated until the num-
ber of iterations is G, i.e. j=G. Finally, the particle whose position
has the largest capacity value is selected as the desired esti-
mate, and the corresponding AC matrices of the relays are the
solutions.
4. Convergence analysis
To investigate the convergence behavior of the proposed PSO
scheme, we consider different system settings for a cooperative
MIMO system. The parameters of the proposed PSO scheme are
shown in Table 1. First, we set N=4, and L=4, and consider two RF-
chain cases, Q=1 and Q=2. The corresponding simulation results
are shown in Fig. 4(a) and (b), respectively. From the ﬁgures,
we observe that the proposed PSO scheme converges at about
P×G=30×30=900 trails. That means the scheme computes Eq.
(8) 900 times before converging and obtaining the ﬁnal solution
of the relays’ AC matrices. In addition, the corresponding capacity
values in Fig. 4(b) are higher than those in Fig. 4(a). This is because a
larger number of RF chains providemore diversity,which enhances
the capacity performance of the proposed scheme.
Next, to provide more insight into the convergence behav-
ior of the proposed scheme, we consider the following six
system settings: (N=6, L=6, Q=2) and (N=6, L=6, Q=4),
(N=8, L=8, Q=2) and (N=8, L=8, Q=4), and (N=10, L=10,
Q=2) and (N=10, L=10, Q=4). The results are shown in
Figs. 5(a) and (b), 6(a) and (b), and 7(a) and (b), respectively. The
conclusions drawn from the ﬁgures are similar to those for Fig. 4(a)
Table 1
Parameters of the proposed PSO scheme.
Parameter Value
˛1, ˛2 0.9
ˇ1, ˇ2 1.0
1, 2 1.0
t 1.0
Minimum velocity −3.0
Maximum velocity 3.0
Please cite this article in press as: H.-Y. Lu, Particle swarm optimization assisted joint transmit/receive antenna combining for multiple
relays in cooperative MIMO systems Appl. Soft Comput. J. (2011), doi:10.1016/j.asoc.2011.03.017
ARTICLE IN PRESSG ModelASOC-1149; No.of Pages10
6 H.-Y. Lu / Applied Soft Computing xxx (2011) xxx–xxx
0 5 10 15 20
100
101
SNR (dB)
Ca
pa
cit
y 
(bi
ts/
s/H
z)
(a)
P=20, G=10
P=25, G=20
P=30, G=30
P=35, G=30
0 5 10 15 20
100
101
SNR (dB)
Ca
pa
cit
y 
(bi
ts/
s/H
z)
(b)
P=20, G=10
P=25, G=20
P=30, G=30
P=35, G=30
Fig. 7. Convergence of the proposed PSO scheme with N=10, L=10, (a) Q=2 and (b) Q=4.
is Ps, which is distributed equally over the transmit antennas. In
each simulation, 10,000 independent channels are considered, and
each source node antenna transmits an independent data frame
with 128 BPSK symbols to the destination node. We assume the
channels’ coefﬁcients remain unchanged during a transmission of
a symbol frame and vary independently frame by frame. To gain
more insight into the proposed PSO scheme, the simulations were
designed to evaluate its performance capacity and bit error rate
(BER). The corresponding results are shown in Figs. 8–15, respec-
tively.Wealso discuss the computational complexity of the scheme
and compare it with those of some existing approaches to assess
its practical implementation.
0 5 10 15 20 25 3010
0
101
SNR (dB)
Ca
pa
cit
y 
(bi
ts/
s/H
z)
Capacity in (5), with full RF chains (Q=4)
proposed PSO, Q=1
proposed PSO, Q=2
proposed PSO, Q=3
proposed PSO, Q=4
Fig. 8. Capacity versa SNR, N=4, L=4, P=30, G=30.
5.1. Capacity
We use the same system settings as those in Fig. 4 (i.e. N=4 and
L=4) and consider different numbers of RF chains, Q. The results
(see Fig. 8) show that the proposed scheme with Q≥2 RF chains
provides more capacity than the full RF-chain relay method in (5).
This implies that our schememakes proper use of the antenna gains
of all the relays by combining the gains of the transmit/receive sides
of the relays efﬁciently. Note that, in the case where Q<N(= 4), the
number of RF chains is less than the number of transmit/receive
antennas of each relay. In other words, the proposed scheme needs
fewer RF chains for the relays; hence, it reduces the hardware
0 5 10 15 20 25 30
100
101
SNR (dB)
Ca
pa
cit
y 
(bi
ts/
s/H
z)
Capacity in (5), with full RF chains (Q=6)
proposed PSO, Q=1
proposed PSO, Q=2
proposed PSO, Q=4
proposed PSO, Q=6
Fig. 9. Capacity versa SNR, N=6, L=6, P=30, G=30.
Please cite this article in press as: H.-Y. Lu, Particle swarm optimization assisted joint transmit/receive antenna combining for multiple
relays in cooperative MIMO systems Appl. Soft Comput. J. (2011), doi:10.1016/j.asoc.2011.03.017
ARTICLE IN PRESSG ModelASOC-1149; No.of Pages10
8 H.-Y. Lu / Applied Soft Computing xxx (2011) xxx–xxx
0 5 10 15
10−7
10−6
10−5
10−4
10−3
10−2
10−1
100
SNR (dB)
Av
er
ge
 B
ER
(a)
MMSE−GAS [20]
GA−AC [21]
Proposed
0 5 10 15
10−7
10−6
10−5
10−4
10−3
10−2
10−1
100
SNR (dB)
Av
er
ge
 B
ER
(b)
MMSE−GAS [20]
GA−AC [21]
Proposed
Fig. 13. BER versa SNR, N=6, L=6, P=30, G=30, (a) Q=2 and (b) Q=4.
based greedy antenna selection scheme (MMSE-GAS) [20] and the
genetic algorithm-based antenna combining (GA-AC) scheme [21].
To ensure the comparison is fair, we use the same parameter set-
tings for the population size and the generation in the GA-AC
scheme and the proposed scheme, i.e. P=30, and G=30. The sim-
ulation results for BER versus SNR, shown in Fig. 12(a) and (b),
demonstrate that the proposed PSO scheme outperforms the com-
pared schemes in terms of the BER performance. This is because
it uses the AC matrices to combine the relays’ transmit/receive
antennas to alleviate the performance degradation incurred by
0 5 10 15
10−7
10−6
10−5
10−4
10−3
10−2
10−1
100
SNR (dB)
Av
er
ge
 B
ER
(a)
MMSE−GAS [20]
GA−AC [21]
Proposed
0 5 10 15
10−7
10−6
10−5
10−4
10−3
10−2
10−1
100
SNR (dB)
Av
er
ge
 B
ER
(b)
MMSE−GAS [20]
GA−AC [21]
Proposed
Fig. 14. BER versa SNR, N=8, L=8, P=30, G=30, (a) Q=2 and (b) Q=4.
Please cite this article in press as: H.-Y. Lu, Particle swarm optimization assisted joint transmit/receive antenna combining for multiple
relays in cooperative MIMO systems Appl. Soft Comput. J. (2011), doi:10.1016/j.asoc.2011.03.017
ARTICLE IN PRESSG ModelASOC-1149; No.of Pages10
10 H.-Y. Lu / Applied Soft Computing xxx (2011) xxx–xxx
Table 3
Complexity comparisons of some speciﬁc N, L, Q, P, and G.
Scheme N=4 N=6 N=8 N=10
L=4 L=6 L=8 L=10
Q=2 Q=2 Q=2 Q=2
P=30 P=30 P=30 P=30
G=30 G=30 G=30 G=30
Proposed PSO 633,600 CMAs 2,138,400 CMAs 5,068,800 CMAs 9,900,000 CMAs
GA-AC [21] 633,600 CMAs 2,138,400 CMAs 5,068,800 CMAs 9,900,000 CMAs
MMSE-GAS [20] 1,536 CMAs 7,776 CMAs 24,576 CMAs 60,000 CMAs
6. Conclusion
In this paper, we have proposed a scheme that uses the
particle swarm optimization (PSO) algorithm to jointly search
the transmit/receive antenna combining matrices in cooperative
MIMO systems. Because the proposed scheme determines the
antenna combiningmatrices for the relays’ transmit/receive anten-
nas jointly, it reduces the hardware cost of deploying RF chains. The
scheme also yields a signiﬁcant performance gain over schemes
thatuseall theRF chains. Another advantage is that the schemeuses
the amplify-to-forward relaying method to forward weighted sig-
nals to the destination node without requiring extra power. Hence,
it solves the power consumption problem. Given the above advan-
tages and the feasible complexity for practical implementation, the
proposed PSO scheme provides an viable alternative to existing
approaches.
Acknowledgments
This work is supported in part by National Science Council of
ROC under Contract Number NSC 99-2221-E-019-026. The author
would like to thank the reviewers for many thoughtful comments
and suggestions which have enhanced the quality and readability
of this paper.
References
[1] G.J. Foschini, M.J. Gans, On limits of wireless communication in a fading envi-
ronment when using multiple antennas, Wireless Personal Commun. 6 (March
(3)) (1998) 311–355.
[2] A. Goldsmith, S.A. Jafar, N. Jindal, S. Vishwanath, Capacity limits of MIMO chan-
nels, IEEE J. Sel. Areas Commun. 21 (June (5)) (2003) 684–702.
[3] A.F. Molisch, M.Z. Win, MIMO systems with antenna selection, IEEE Micro 24
(March–April (2)) (2004) 46–56.
[4] H. Lee, B. Lee, I. Lee, Iterative detection and decoding with an improved V-
BLAST for MIMO-OFDM, IEEE J. Sel. Areas Commun. 24 (March (3)) (2006)
504–513.
[5] K. Lee, J. Chun, Symbol detection in V-BLAST architectures under channel esti-
mation errors, IEEE Trans. Wire. Commun. 6 (February (2)) (2007) 593–597.
[6] A. Soysal, S. Ulukus, Joint channel estimation and resource allocation for MIMO
systems – part II: multi-user and numerical analysis, IEEE Trans. Wire. Com-
mun. 9 (February (2)) (2010) 624–663.
[7] Y. Fan, J. Thompson, MIMO conﬁgurations for relay channels: theory and prac-
tice, IEEE Trans. Wire. Commun. 6 (May (5)) (2007) 1774–1786.
[8] M. Ei-Hajjar, O. Alamri, R.G. Maunder, L. Hanzo, Layered steered space-
time-spreading-aided generalized MC DS-CDMA, IEEE Trans. Veh. Technol. 59
(February (2)) (2010) 999–1005.
[9] W.-J. Huang, Y.-W.P. Hoang, C.-C.J. Kuo, Relay-assisted decorrelating multiuser
detector (RAD-MUD) for cooperative CDMA networks, IEEE J. Sel. Areas Com-
mun. 26 (April (3)) (2008) 550–560.
[10] O.Mun˜oz-Medina, J. Vidal, A. Agustin, Linear transceiver design in nonregener-
ative relayswith channel state information, IEEE Trans. Signal Process. 55 (June
(6)) (2007) 2593–2604.
[11] A. Adinoyi, H. Yanikomeroglu, Cooperative relaying inmultiantenna ﬁxed relay
networks, IEEE Trans. Wire. Commun. 6 (February (2)) (2007) 533–544.
[12] L. Dai, S. Sfar, K. Letaief, Optimal antenna selection based on capacity maxi-
mization for MIMO systems in correlated channels, IEEE Trans. Commun. 54
(March (3)) (2006) 567–573.
[13] H.-Y. Lu,W.-H. Fang, Joint transmit/receive antenna selection inMIMO systems
based on the priority-based genetic algorithm, IEEE Ant. Wire. Prop. Lett. 6
(2007) 588–591.
[14] A. Nosratinia, T.E. Hunter, A. Hedayat, Cooperative communication in wireless
networks, IEEE Commun. Mag. 42 (October (10)) (2004) 74–84.
[15] Y.-W. Hong, W.-J. Huang, F.-H. Chiu, C.-C.J. Kuo, Cooperative communications
in resource-constrained wireless networks, IEEE Signal Proc. Mag. 24 (May (3))
(2007) 47–57.
[16] A. Sendonaris, E. Erkip, B. Aazhang, User cooperation diversity-part I:
system description, IEEE Trans. Commun. 51 (November (11)) (2003)
1927–1938.
[17] J.N. Laneman, D.N.C. Tse, G.W. Wornell, Cooperative diversity in wireless net-
works: efﬁcient protocols and outage behavior, IEEE Trans. Inform. Theory 50
(December (12)) (2004) 3062–3080.
[18] A.F. Molisch, M.Z. Win, J.H. Winters, Capacity of MIMO systems with antenna
selection, in: Proc. IEEE Int. Conf. Commun., 2001, pp. 570–574.
[19] Y. Zhang, G. Zheng, C. Ji, K.-K. Wong, D.J. Edwards, T.C. David, J. Edwards, T. Cui,
Near-optimal joint antenna selection for amplify-and-forward relay networks,
IEEE Trans. Wire. Commun. 9 (August (8)) (2010) 2401–2407.
[20] M. Ding, S. Liu, H. Luo, W. Chen, MMSE based greedy antenna selection scheme
for AFMIMO relay systems, IEEE Signal Proc. Lett. 17 (May (5)) (2010) 433–436.
[21] P.D. Karamalis, N.D. Skentos, A.G. Kanatas, Adaptive antenna subarray forma-
tion for MIMO systems, IEEE Trans. Wire. Commun. 5 (November (11)) (2006)
2977–2982.
[22] M. Mitchell, A Introduction to Genetic Algorithms, MIT Press, Cambridge, MA,
1996.
[23] J. Kennedy, R.C. Eberhart, Particle swarm optimization, in: Proc. IEEE Int. Conf.
Neural Net., 1995, pp. 1942–1948.
[24] Y.H. Shi, R.C. Eberhart, A modiﬁed particle swarm optimizer, in: Proc. IEEE Int.
Conf. Evol. Comp., 1998, pp. 4–9.
[25] K.K. Soo, Y.M. Siu, W.S. Chan, L. Yang, R.S. Chen, Particle-swarm-optimization-
based multiuser detector for CDMA commmunicaitons, IEEE Trans. Veh.
Technol. 56 (September (5)) (2007) 3006–3013.
[26] M. Zubair, M.A.S. Choudhry, A. Naveed, I.M. Qureshi, Joint channel and data
estimation using particle swarm optimization, IEICE Trans. Commun. E91-B
(September (9)) (2008) 3033–3036.
[27] M. Khodier, G. Saleh, Beamforming and power control for interference reduc-
tion in wireless communications using particle swarm optimization, Int. J.
Electron. Commun. (AEÜ) 64 (2009) 489–502.
[28] R. Narasimhan, Spatial multiplexing with transmit antenna and constellation
selection for correlated MIMO fading channels, IEEE Trans. Signal Process. 51
(November (11)) (2003) 2829–2838.
[29] Y. Fan, J.S. Thompson, On the outage capacity of MIMO multihop networks, in:
Proc. IEEE GrobeCom, 2005, pp. 2204–2208.
[30] G.H. Golub, C.F. Van Loan, Matrix Computations, 3rd ed., Johns Hopkins Uni-
versity Press, 1996.
[31] http://www.ti.com, January 2011.
[32] J.W. Wallace, M.A. Jensen, A.L. Swindlehurst, B.D. Jeffs, Experimental charac-
terization of the MIMO wireless channel: data acquisition and analysis, IEEE
Trans. Wire. Commun. 2 (March (2)) (2003) 335–343.
Low-Complexity Spatial-Frequency-Time-Domain 
MMSE Multiuser Detectors for MC DS-CDMA 
Hoang-Yang Lu*, Hsien-Sen Hung, Chin-Feng Lin, Ching-Hsiang Tseng, and Yen-Yu Chen 
Department of Electrical Engineering 
National Taiwan Ocean University, Keelung, Taiwan, R.O.C. 
Email: hylu@mail.ntou.edu.tw* 
Ahstract- T his paper presents three multiuser detectors 
(MUDs) for the uplinks of spatial-frequency-time-domain (SFT­
domain) spread multi-carrier (MC) direct sequence code division 
multiple access (DS-CDMA) systems. First, aiming at achieving 
significant performance gain, we propose a joint optimum SFT­
domain MUD based on minimum mean square error (MMSE) 
decision rules. Further, to reduce the computational complexity, 
we decompose the SFT-domain received signal to low-dimension 
signal components and propose the corresponding separate 
MMSE MUDs. Complexity analysis and computer simulations 
show that the joint optimum SFT-domain MMSE MUD performs 
the best among the proposed schemes. Meanwhile, the separate 
MMSE MUDs can provide effective performance close to that of 
the joint optimum SFT-domain MMSE MUD but with a modest 
computational overhead. 
1. INTRODUCTION 
Recently, to increase the system capacity of multi-carrier 
(MC) direct sequence code division multiple access (DS­
CDMA), You et al. [1] proposed a frequency-time-domain 
(FT-domain) spread scheme, in which the transmitted signals 
are spread in both frequency-domain (F-domain) and time­
domain (T-domain). In addition to the enhancement of the 
system capacity, this two-domain (2D) spread MC DS-CDMA 
scheme also provides several merits for practical implementa­
tion, including high flexibility for variable rate services, and 
short signature codes and low-chip-rate to facilitate low-rate 
signal processing [2]-[3]. It has been shown that multiple 
antenna techniques provide significant benefits for wireless 
communications due to the advantages of spatial diversity and 
antenna array gain [4]. Therefore, to further enhance QoS 
in wireless communications, it is vital that multiple antenna 
mechanisms are incorporated into FT-domain spread MC DS­
CDMAs and that relevant advanced techniques like channel 
estimation and symbol detection are developed. To date, these 
areas have attracted comparatively little research attention. 
However, as CDMA systems, the performance of FT-domain 
spread MC DS-CDMA systems is limited by multiple access 
interference (MAl) which is caused by the non-orthogonality 
of signature codes of users or the impairment of multipath 
fading channels [1]-[3]. To address the MAl in FT-domain 
spread MC DS-CDMA systems, a joint FT-domain MMSE 
MUD and several separate schemes are presented in [2]. 
In addition, similar to the separate detection approaches in 
[2], three types of separate MUDs, based on the MMSE, 
the decorrelating detector, and the interference cancellation 
978-1-4244-6871-3/10/$26.00 ©2010 IEEE 
(IC) methods, respectively, have been proposed in [3] for the 
implementation in modular structures for dynamic commu­
nications environments. The aforementioned separate MUDs 
indeed reduce the computational complexity owing to avoiding 
to compute an inversion of a huge matrix. However, the above 
separate approaches are all based on the consideration of the 
base station with single receive antenna and can not be directly 
applied to the multiple receive antenna systems. 
In this paper, we present the joint optimum MMSE MUD 
and two low-complexity separate schemes for the FT-domain 
spread MC DS-CDMA with multiple receive antennas at the 
base station. It is worthy to note that due to the direction of 
arrival (DOA) of the received signal from each user being 
generally different, hence the correspondingly different an­
tenna response can be used to form the unique spatial-domain 
(S-domain) signature code for each user. So, the FT-domain 
spread MC DS-CDMA with multiple receive antennas can 
be referred to as spatial-frequency-time-domain (SFT-domain) 
spread MC DS-CDMA due to the transmitted signal of each 
user being spread by F -domain and T-domain signature codes 
and the assistance of the multiple antennas at the base station. 
For such a three-domain (3D) spread MC DS-CDMA, we 
first stack the all antenna received signal of the T-domain 
chip times and F-domain subcarriers, and then propose a 
joint optimum SFT-domain MMSE MUD to estimate the 
transmitted symbols. To further reduce the computational load, 
we also present two separate MMSE MUDs, which include 
the T-domain and spatial-frequency-domain (T-SF-domain), 
and the FT-domain and the S-domain (FT-S-domain) separate 
MMSE schemes. In these separate schemes, we first re­
combine the total received signal as 2D (one-domain, 1D) 
signal components and then pass them into the corresponding 
2D (lD) MMSE detectors. Thereafter, stack the outputs of 
these 2D (lD) MMSE detectors to construct the other 1D 
(2D) tentative signal for the inputs of the corresponding 1D 
(2D) MMSE detectors. Finally, complexity analysis and com­
puter simulations show that the joint optimum SFT-domain 
MMSE MUD can achieve the best performance in the all 
proposed schemes but at the expense of the largest amount of 
computational overhead. As for the proposed separate MUDs, 
they indeed reduce computational complexity and also provide 
feasible performance close to the optimum scheme. 
508 
where fj is the M Nf x 1 tentative vector for the input of 
the SF-domain MMSE detector. Also, for notation simplic-
. 
d -SF 1ty, we enote Skj 
r tkj,llhk,llik,lak,l 1 
tkj,12hk,12ik,2ak,1 
and 
tkj,MNj hk,M�j ik,Nfak,M 
llj [nj,1l, nj,12, ···, nj,MNjJ' as the tentative SF-domain 
signature vector and the noise vector. Thereafter, like (6) and 
using the tentative signal, f j, the corresponding SF -domain 
MMSE detector for estimating the transmitted symbol, can be 
shown as 
(9) 
where 
Finally, the estimated symbol for user j is found as bj 
sgn(wyFII fj), where sgn(·) is the sigmoid function [7]. Note 
that to construct the overall T-SF-domain MMSE MUD, we 
need to compute the inversion of the M Nf Nt x Nt matrixes 
and the K M Nf x M Nf matrixes. 
C. Separate FT-S-domain MMSE MUD 
The construction of the FT-S-domain MMSE MUD is to 
conduct the FT-domain MMSE detectors first and then carry 
out the S-domain MMSE detectors. Due to the first detectors 
of this scheme being the FT-domain MMSE detectors, we 
hence use the FT-domain received signal rm in (2) as the input 
signal for this proposed FT-S-domain MMSE MUD and the 
corresponding FT-domain MMSE detectors, wf,;;', 1 <::: j <::: 
K, 1 <::: m <::: M, for the mth antenna is shown as 
Then, the associated outputs of the FT-domain MMSE detec­
tors, fj,m, 1 <::: j <::: K, 1 <::: m <::: Mare 
(11) 
where c[Tm = Wf,;;.H c[,;". Again as (8)-(9), stack the M 
outputs of the FT-domain MMSE detectors, fj,m, 1 <::: m <::: 
M, to form the tentative signal, rj = [fj,1 fj,1 ... fj,M]', as 
the input signal for the S-domain MMSE detectors. Further, 
the corresponding S-domain MMSE detector can be shown as 
where 
DFT d' { FT
H FT FTH FT FTH FT} = lag Wj,l wj,l ' wj,2 Wj,2"" , Wj,M wj,M 
(12) 
510 
r uFT 1 :'Jj,i ak,l 
Ckj,2ak,2 
Also, we define sfj = , 1  <::: k, j <::: M, for 
uFT Ckj,Mak,M 
notation simplicity. At last, the estimated symbol for user j is 
bj = sgn(wyllrj). As for the construction of the overall FT­
S MMSE MUD, we require to invert the M NfNt x NfNt 
matrixes and the K M x M matrixes, respectively. 
IV. COMPLEXIT Y  ANALYSIS 
In this section, we evaluate the proposed MUDs in terms 
of the computational complexity based on the number of 
complex multiplications/additins (CMAs) required. In general, 
due to the main computational complexity of the MUD being 
at conducting the inversion of a matrix, in the follows we 
hence focus on the inversion of the matrixes of the pro­
posed MUDs needed. As shown in the above section, to 
construct the overall receiver of the proposed MUDs, each 
of the proposed MUDs has some matrixes with different sizes 
needed to compute their inversion. Note that the computational 
load for an inversion of a N x N matrix calls for about 
N3 CMAs. Hence, the joint optimum SFT-domain MMSE 
MUD in (5) needs (MNfNt)3 CMAs. As for the T-SF­
domain and the FT-S-domain MMSE MUDs, they require 
MNfNl +K(MNf)3 and M(NtNf)3 +KM3, respectively. 
For example, K = 20, M = 6, Nf = 8, Nt = 16, the 
CMAs required for the joint optimum SFT-domain, the T-SF­
domain, and the FT-S-domain MMSE MUDs are 452984832, 
2408448, and 12587232, respectively. Therefore, we can ob­
serve that the joint SFT-domain MMSE MUD calls for the 
largest amount of computations. Furthermore, the other two 
separate MMSE MUDs significantly reduce the computational 
complexity thanks to separating the receiving signal to reduce 
the corresponding matrix sizes. 
V. SIMULATIONS AND DISCUSSIONS 
Some simulations are conducted in this section to verify 
the proposed new schemes. Assume that the channels for all 
users are frequency selective slow Rayleigh fading and all 
the channel information and signature codes are available at 
the base station. The receiver of the base station is deployed 
with M = 6 antennas. For simplicity, all users simultaneously 
transmit BPSK modulated symbols, which are spread in both 
T-domain and F -domain, through the channels to the base 
station. Also, the lSI effect is assumed too small to be ignored. 
Two different numbers of users, K = 20 and K = 80, are 
considered for investigating the performance of the proposed 
schemes in different scenarios. Further, in each scenario, two 
kinds of combinations for the lengths of the T-domain and F­
domain signature codes of each user, (Nt = 16, Nf = 8) 
and (Nt = 8, Nf = 16), are used. The results for BER 
performance versus signal to noise ratio (SNR) of the proposed 
schemes are shown in Figs. 1-4. 
From Fig. 1, in which the system profile is K = 20, M = 
6, Nf = 16, Nt = 8, we can observe that the proposed joint 
optimum SFT-domain MMSE MUD outperforms the other two 
 
 
 
 
附件五 
 
 
 
 
 
step in the second stage in order to avoid the CTBF updates of 
the PSO to trap into the local solutions. Finally, some computer 
simulations are conducted to verifY the proposed scheme. 
The rest of this paper is organized as follows. Section II 
describes the data model of the cooperative transmit beam­
forming systems and reviews the previous works. The pro­
posed two-stage PSO scheme is presented in Section III and 
some simulation results are provided to compare the proposed 
scheme with the previous works in Section IV. Finally, Section 
V concludes this paper. 
II. PRELIMINARY 
A. Data Model 
Consider the uplink of a multiuser MIMO system with a 
base station deployed N received antennas. Also, there are K 
active users and each of them is equipped with M antennas for 
the transmit beamforming mechanism. Hence, with the help of 
transmit beamforming mechanisms, the K users transmit their 
own signal through Rayleigh flat fading channels to the base 
station simultaneously. Then, the discrete baseband received 
signal can be expressed as 
K 
r= LHktkbk+n=Hb+n, 
k=l 
(1) 
where r is the N x 1 received signal vector. bk is the 
transmitted quadrature phase shift keying (QPSK) symbol of 
the kth user and tk is the corresponding M x 1 transmit beam­
former. Hk is the N x M complex channel matrix between 
user k and the base station and we assume the elements of 
Hk are complex Gaussian distributed with zero mean and 
unit variance. H=[Hl t1, H2t2 ... ,HKtK] is referred to as 
totally effective channel matrix. n is the N x 1 complex 
additive white Gaussian noise (AWGN) vector with zero mean 
and variance No. 
B. Capacity 
Assume that the CSI of all users is perfectly known at 
all transmitters, which can be found in feedback channels. 
Also, the elements of the transmitted symbol vector bare 
statistically independent, i. e. E {b bH} = 1M, where 1M 
denotes the M x M identity matrix and E {.} is the expectation 
operator. Then, the capacity of the multiuser MIMO channel 
considered is given by [8], [9] 
Eb H C = log2 det(IK + MNo 
H H) (2) 
where Eb=E(lbkI
2), k = 1··· K, is the symbol energy. Let 
Fk be the maximum permissible transmission power for user 
k and the power constrain for the corresponding transmit 
beamformer can be expressed as 
(3) 
r--I 
U*""I. , 
b, j . 
I j : NT I I User 21 t> I 
b, t I: 
E . NT 
Feedback 
Channel 
-----� --- -' 
Receiver 
Fig. 1. CTBF of a multiuser MIMO system. 
III. PROPOSED TW O-STAGE PSO SCHEME 
A. Review of the previous works 
In the CTBF communications, the full CSI of all users is as­
sumed to be perfectly available at each transmitter, which can 
be realized by the feedback channel. Based on this assumption, 
several previous works [4], [5] are carried out to develop the 
CTBF schemes. For example, S. Xi and M. D. Zoltowski [4] 
used an i.i.d. statistical model and proposed a quasi-SINR­
Max CTBF (q-CTBF) scheme to find the cooperative transmit 
beamformers, given as 
t%-CTBF = M x max e.v).( H�[ t ::� HmH�+I]-lHk) V If;, m=l,m# 0 
(4) 
where t%-CT BF, k = 1··· K, is the cooperative trans­
mit beamformer for user k and max e.v).(·) indicates the 
eigenvector corresponding to the maximum eigenvalue of (.). 
Further, to reduce the performance loss, the successive and the 
parallel algorithms are proposed in [5]. Inevitably, the above­
mentioned approaches indeed achieve sub-optimum solutions 
only. In order to further enhance the system performance, 
we propose a near optimum algorithm based on the particle 
swarm optimization (PSO) scheme to evaluate the CTBF in 
the sequel. 
B. Proposed Two-Stage PSG Scheme 
PSO is a population based stochastic optimization algorithm 
combining the social psychology principles and evolutionary 
computation. Due to easy implementation and fast conver­
gence, PSO has been applied to various applications in differ­
ent fields. Therefore, in this paper the PSO scheme is utilized 
to develop the optimum joint CTBF scheme. First, for the 
CTBF of multiuser MIMO systems, the dth particle position 
of the ith iteration is expressed as td = [t�/l' t�;, ... , t��]T, 
where t�k = [t�k,l' t�k,2' ... t�k,M]T indicates the coop­
erative transmit beamformer for user k and ( -) T indicates 
the transpose operation .
. 
Also, She c8rrespondinp particle's 
velocity of the PSO is vd = [vdl' vd2' ... , VdK]T, where 
556 
TABLE I 
PARAMETERS EMPLOYED BY THE PROPOSED TWO-STAGE PSO IN THE 
EXPERIMENTS 
Parameter Description Value 
a Inertia weight 0.9 
(3; , i = 1,2 Acceleration coefficient 2 
S Number of population size 10 
Nil i = 1,2 Number of iterations of the ith stage 12 
Vmax Particle's maximum velocity 3.0 
10-1r-----�------�------�----�------�----__, 
---e--- N1=N2=6 
________ N1=N2=8 
----+-- N1=N2=10 
- + - N1=N2=12 
o N1=N2=14 
1 0-7 O
l.':====:=i:
2
===:"�4------�6 ------�8
-------
1
�
0
-----.--J
12 
SNR(d8) 
Fig. 3. BER versus SNR for convergence of the proposed scheme. 
To assess the convergence of the proposed scheme, we 
consider the different iterations for the proposed PSO. Also, let 
the population size, S, of each stage of the proposed PSO be 
10. Then, conduct the proposed scheme and show the average 
BER performance versus the signal-to-noise ratio (SNR) in 
Fig. 3. From Fig. 3, we can observe that the proposed scheme 
approximately converges in S(Nl + N2) = 240 iterations. 
Therefore, we choose the settings of the proposed PSO as 
S = 10 and Nl = N2 = 12 for the following simulations. 
To investigate the performance of the proposed scheme, we 
show the BER results versus the signal-to-noise ratio (SNR) 
in Fig. 4. For comparisons, four CTBF schemes: the q-CTBF 
[4], the successive [5], the parallel [5], the conventional PSO 
[6], and the proposed two-stage PSO scheme, are carried out 
in terms of the average BER performance. To use the same 
computational complexity as those in the proposed PSO for 
fair comparisons, the conventional PSO adopts 10 and 24 as 
the population size and the the number of iterations, respec­
tively. Also, the V-BLAST symbol detection method [10] is 
adopted at the base station for the above five schemes. We can 
observe from Fig. 4 that the five schemes perform almost the 
same at SNR :s; 0 dB. However, as the SNR increases, the 
proposed two-stage PSO scheme can outperforms the other 
four schemes, especially at SNR > 12 dB. 
558 
a: 
w 
'" 
10° 
10-1 
10-2 
10-3 
10-4 
10-5 
10-6 
10-7 
10-8 -10 
--a-- q-CT8F[4I 
----...-- parallel[5] 
----+-- successive[5] 
---e--- conventional PSO[6] 
--+-- proposed 
----+-- single user bound 
-5 o 5 
SNR(d8) 
10 15 
Fig. 4. BER versus SNR for performance comparisons. 
V. CONCLUSION 
20 
In this paper, we present a simple, yet effective two-stage 
PSO based cooperative transmit beamforming for multiuser 
MIMO systems. The proposed new scheme estimates beam­
formers of all users simultaneously. Especially, the proposed 
scheme uses a two-stage PSO mechanism to avoid the PSO 
to achieve the local solution but without increasing extra 
computational load. Finally, computer simulations results show 
the proposed new scheme can provide better performance than 
the pervious works, especially at SNR > 12 dB. 
Acknowledgement 
This work was supported by National Science Council of 
R.O.C. under contract NSC 99-2221-E-019-026 and NSC 99-
2S15-C-019-033-E. 
REFERENCES 
[I] W. C. Chung, N. J. Aug., and D. S. Ha, "Signaling and multiple access 
techniques for ultra wideband 4G wireless communication systems," 
IEEE Wire. Commun.. vol. 12, no.2, pp. 46-55, Apr. 2005. 
[2] R. W. Heath, and A. J. Paulraj, "Switching between diversity and 
multiplexing in MIMO systems," IEEE Trans. on Commun., vol. 53, 
no. 6, pp. 962-968, June 2005. 
[3] S. Serbetli and A. Yener, "MIMO-CDMA systems: Signature and 
beamformer design with various levels of feedback," IEEE Trans. on 
Signal. Proc., vol. 54, no. 7, pp. 2758-2772, July 2006. 
[4] Songnan Xi and M. D. Zoltowski, "Uplink transmit beamforming design 
for SINR maximization with full multiuser channel state informa­
tion,"Proc. SPIE Int. Soc. Opt. Eng., 2008. 
[5] Songnan Xi and M. D. Zoltowski, "Iterative SINR-MAX cooperative 
beamforming in multiuser MIMO systems," in IEEE Sarnoff Symposium, 
pp. 1-6, 2008. 
[6] Y. Shi and R. C. Eberhart, "A modified particle swarm optimizer," in 
Proc. IEEE Congr. Evol. Compt., pp.69-73, 1998. 
[7] H.-Y. Lu, W.-H. Fang and K.-C. Huang,"Joint generalized antenna 
combination and symbol detection based on minimum bit error rate: A 
particle swarm optimization approach," IEICE Trans. Communications, 
vol. E91-B no. 9, pp. 3009-3012, Sep. 2008. 
[8] A. F. Molisch and M. Z. Win, "MIMO systems with antenna selection," 
IEEE Microwave Mag., vol. 5, no. I, pp. 46-56, 2004. 
[9] A. Gorokhov, M. Collados, D. Gore, and A. Paulraj, "Transmit / receive 
MIMO antenna subset selection," in Proc. IEEE Int. Con! Acoust. 
Speech Signal Proc., pp. 13-16,2004. 
[10] P. W. Wolniansky, G. J. Foschini, G. D. Golden, and R. A. Valenzuela, 
"V-BLAST: An architecture for realizing very high data rates over 
the rich-scattering wireless channel," in Proc. Int. Symp. Signals, Syst., 
Electron., pp. 295-300, Sep.-Oct. 1998. 
Multiuser Detection Assisted Near-Real-Time
Symbol Transmission for Relay CDMA Systems
Hoang-Yang Lu
Department of Electrical Engineering
National Taiwan Ocean University
Keelung, Taiwan, R.O.C.
Email: hylu@mail.ntou.edu.tw
Abstract— In this paper, we present a two-stage multiuser
detection (MUD) scheme for near-real-time relay CDMA systems.
Relay communications have received intensive research attention
recently because of their benefit of spatial diversity. However,
existing works generally have serious latency problems, which
will reduce transmission rates. To solve the problems, we consider
a near-real-time transmission strategy for relay CDMA systems.
Also, a two-stage MUD scheme is proposed for the detectors at
the relays and the destination node to ensure the feasibility of the
transmission strategy. The proposed MUD scheme first conducts
the zero forcing (ZF) method to suppress the multiple access
interfere and then uses the maximum likelihood (ML) mechanism
to estimate the transmitted symbols. Specially, the two-stage
MUD scheme only requires few computations to conduct the ML
mechanism. Simulation results and complexity analysis show that
the proposed scheme can not only provide significant diversity
gain with a modest computational complexity but also assist relay
CDMAs to facilitate the near-real-time transmission.
I. INTRODUCTION
Relay communications have inspired considerable research
attention recently because of their benefit of spatial diversity
[1], [2]. Actually, The objective for developing multiple an-
tenna approaches is to receive antenna array gains and spatial
diversity [3], [4] to enhance system performance. One of
these important approaches is multiple input multiple output
(MIMO) [5]. In particular, studies have shown that MIMOs are
capable of providing significant spatial diversity but without
increasing the consumption of frequency resource [6]. How-
ever, deploying multiple antennas in future wireless systems,
especially in handset equipments, will become difficult for
practical implementation [1]. This is because the trend of wire-
less equipments will be lighter and smaller than before. Hence,
future wireless equipments will inevitably meet the issue of
space limitation. To address the issue, relay communications,
in which source nodes transmit their message to relays and
then relays regenerate the transmitted signal to a destination
node, have been proved that they are capable of providing
virtual spatial diversity for performance enhancement [7].
However, in existing works, the time for facilitating a symbol
transmission generally requires two or more symbol periods.
As a result, serious latency problems appear in existing works.
Furthermore, code division multiple access (CDMA) has
been one of the multiple access candidates for current and
future wireless communication systems due to its high spec-
tral efficiency and robustness to multipath fading effect [8].
However, in CDMA-like systems, due to the non-orthogonality
among users’ spreading codes [9], the transmission will ex-
perience the disturbance of the multiple access interference
(MAI). As a result, the MAI effect seriously degrades the
system performance. To improve the performance, a great
deal of studies have shown multiuser detection (MUD) [9] is
one of the most effective approaches to facilitate interference
mitigation. The conventional approaches include the optimal
MUD, say maximum likelihood (ML), and the suboptimal
MUDs, such as zero forcing (ZF), minimum mean square
error (MMSE), successive interference cancellation (SIC),
and parallel interference cancellation (PIC) [9]. Furthermore,
thanks to the feasibility of the MUDs to alleviate the MAI,
considerable researchers have applied the above MUDs to
relay CDMA systems recently [10]-[13]. For example, Cao
et al. [10] proposed the MMSE MUD for the detectors at
relays and at a destination node to estimate the transmitted
symbols. In [11], based on the knowledge assumption of
perfect or partial channel information at the relays and the
destination node, several variants of the MMSE MUDs have
also been proposed for relay CDMA systems. In addition,
a simple but effective method has also presented in [11]
for partner relay selection . To receive full advantages of
relays, Huang et al. proposed a relaying assisted ZF MUD
by using precoders at relays and pre-whiting filters at the
destination node [12]. In [13], MMSE MUDs with different
partner selection strategies have been studied to improve the
system performance. However, the above-mentioned existing
works all have the transmission latency problems.
To solve the latency problems of the existing works, we con-
sider a near-real-time relay CDMA system and propose a two-
stage MUD scheme to ensure the feasibility of the systems.
In contrast to existing works, the key of the considered relay
CDMA system is to allow relays concurrently to receive the
transmitted signal and to transmit the regenerated signal. As
a result, each of the relays will receive the transmitted signal
from the source nodes as well as the regenerated signal from
the other relays at the same time. Hence, the MAI effect at
the relays will become more serious than those of the above-
mentioned works. To alleviate the annoying MAI effect to
ensure the feasibility of the near-real-time transmission, in
this paper we propose a new two-stage MUD scheme for the
detectors at the relays and the destination node. The proposed
where R = STS is the K × K spreading code correlation
matrix; and ul(m) = STnl(m) is the corresponding AWGN
vector output with N (0, σ2nR). Furthermore, the key objective
of the lth relay is to estimate the transmitted symbol vector
b(m) from yl(m) in (4). Therefore, at relay l, the proposed
two-stage MUD scheme first conducts the ZF method to
suppress the MAI effect and the output of the ZF mechanism
is expressed as
zl(m) = R−1yl(m)
= Hlb(m) +
L∑
j=1,j 6=l
h˜l,jWjb˜j(m− 1) + vl(m), (5)
where vl(m) = [vl,1(m), · · · , vl,K(m)]T is the correspond-
ing noise output vector. Furthermore, due to Hl and Wj both
being K ×K diagonal matrices, (5) can be re-expressed as
zl(m) = [zl,1(m) zl,2(m) · · · zl,K(m)]T , 1 ≤ l ≤ L (6)
=

hl,1b1(m) +
∑
j 6=l h˜l,jwj,1b˜
j
1(m− 1) + vl,1(m)
hl,2b2(m) +
∑
j 6=l h˜l,jwj,2b˜
j
2(m− 1) + vl,2(m)
.
.
.
hl,KbK(m) +
∑
j 6=l h˜l,jwj,K b˜
j
K(m− 1) + vl,K(m)
 ,
Note that, at the mth symbol period, the lth relay has already
obtained the estimates, b˜l1(m− 1), · · · , b˜lK(m− 1) for the K
transmitted symbols b1(m− 1), · · · , bK(m− 1). We assume
the estimates are all correct and substitute them into (6) to
replace b˜j1(m − 1), · · · , b˜jK(m − 1), j 6= l. As a result, each
element in (6) only contains a unknown symbol, e. g. b1(m)
in zl,1(m).
Next, the proposed scheme uses (6) and conducts the ML
method to estimate bk(m), which is formulated as,
b˜lk(m) =
arg min
bk(m) = {1,−1} ||zl,k(m)− βl,k|| (7)
where k = 1, · · · ,K and l = 1, · · · , L; || · || denotes
the Euclidean norm [14]; and we let βl,k = hl,kbk(m) +∑
j 6=l h˜l,jwj,k b˜
l
k(m − 1) for notation brevity. As a result,
the lth relay uses (7) and attains the estimates for the K
transmitted symbols b1(m), · · · , bK(m). Also, it is clear that
only a unknown symbol needs to be estimated in (7). This
implies that the relays use a small amount of computations to
conduct the ML method.
B. The symbol detection at the destination node:
Similar to the above relays, the proposed scheme passes the
received signal of the destination node, d(m) in (3) through
the matched filter bank S and the ZF mechanism R−1. As a
result, we have the output of the ZF mechanism is expressed
as,
x(m) =
L∑
j=1,j 6=l
h˜d,jWjb˜j(m− 1) + p(m),
=

∑
j 6=l h˜d,jwj,1b˜
j
1(m− 1) + p1(m)∑
j 6=l h˜d,jwj,2b˜
j
2(m− 1) + p2(m)
.
.
.∑
j 6=l h˜d,jwj,K b˜
j
K(m− 1) + pK(m)
 , (8)
where p(m) = [p1(m), · · · , pK(m)]T is the corresponding
noise vector at the ZF mechanism’s output.
Furthermore, we assume the estimates at the relays are all
correct. This implies the estimates of the relays are all the
same. So, we let b˜k(m − 1) = b˜1k(m − 1) =, · · · ,= b˜Lk (m −
1), k = 1, · · · ,K in (8). Then, we use (8) and conduct the
ML method to estimate the kth transmitted symbol, which is
formulated as,
bˆk(m− 1) = arg min
bk(m− 1) = {1,−1} ||xk(m)− γk||, (9)
where k = 1, · · · ,K and γk =
∑
j 6=l h˜d,jwj,k b˜k(m− 1). The
same reason as (7), we also only needs to estimate the symbol
b˜k(m − 1) in (9). Therefore, the amount of computations
required by the ML method at the destination node is still
small. At last, let bˆk(m − 1) be the final estimate for the
transmitted symbol bk(m− 1).
IV. SIMULATION RESULTS AND DISCUSSION
To assess the performance of the proposed scheme, we
carried out computer simulations and complexity analysis in
this section. For simplicity, we assume the K source nodes
concurrently transmit BPSK modulated symbols over Rayleigh
flat fading channels to the destination node and the L relays.
In addition, the destination node and the relays all have perfect
knowledge of the source nodes’ spreading codes. The length
of the spreading codes is N . For ease of description, the
channel coefficients, hl,k, h˜d,j , and h˜l,j , are all assumed to
be complex Gaussian random variables, respectively, with
N (0, σ2), N (0, σ˜2), and N (0, σ2). In addition, the channel
coefficients between the source nodes and the destination node
are complex Gaussian random variables with N (0, σ˜2). For
performance comparison, we also carry out the ZF and the ML
methods in the following simulations. The results of average
bit error rate (BER) versus total transmit power are shown in
Figs. 2-5.
First, we consider the system settings, K = 4, N =
16, σ2 = 1, σ˜2 = 116 and the corresponding simulation results
of the above-mentioned three methods are shown in Fig. 2.
From Fig. 2, we observe that the proposed scheme with two
relays (i.e. L = 2) outperforms the ZF and the ML methods.
For example, the proposed scheme with two relays yields
above about 4 dB transmit power gains compared to the other
two methods, when the average BER value is 0.01. In addition,
as changing the amount of relays from 2 to 6, the proposed
scheme can further attain extra about 1 dB transmit power
gain. Intuitively, this is because six relays are capable of
providing more spatial diversity than two relays.
To further test the loading problem for the proposed scheme,
we increase the number of users from K = 4 to 7 and 10
respectively. The other settings are all the same as those in
0 5 10 15 20 25 30
10−3
10−2
10−1
100
Total Transmit Power (dB)
Av
er
ag
e B
ER
 
 
ZF
ML
Proposed, L=2
Proposed, L=6
Fig. 6. Comparison of BER versus SNR, K = 7, σ2 = 1, and σ˜2 = 1
20
.
the near-real-time transmission strategy, a two-stage multiuser
detection scheme is proposed for the detectors at the relays
and the destination node. The proposed scheme first conducts
the zero forcing mechanism to suppress the multiple access
interference and then carries out the maximum likelihood
mechanism to estimate the transmitted symbols. Simulation
results and complexity analysis show that at such a near-real-
time transmission strategy, the proposed scheme can not only
provide significant diversity gain with a modest computational
complexity but also assist relay CDMAs to facilitate the near-
real-time transmission.
ACKNOWLEDGMENT
This work was supported by National Science Council of
R.O.C. under contract NSC 99-2221-E-019-026.
REFERENCES
[1] L.-W. Hong, W.-J. Huang, F.-H. Chiu, and C.-C. Jay, Kuo, “Cooperative
communications in resource-constrained wireless networks,” IEEE Signal
Process. Mag., vol. 24, no. 3, pp. 47-57, May 2007.
[2] H. Bo¨lcskei, R. U. Nabar, ¨O Oyman, and A. J. Paulraj, “Capacity scaling
laws in MIMO relay networks,” IEEE Trans. Wireless Commun., vol. 5,
no. 6, pp. 1433-1444, June 2006.
[3] S. A. Jafar and A. Goldsmith, “Transmitter optimization and optimality
of beamforming for multiple antenna systems,” IEEE Trans. Wireless
Commun., vol. 13, no. 7, pp. 1165-1175, July 2004.
[4] J. Liu, J.-K. Zhang, and K. M. Wong, “On the design of minimum BER
linear space-time block codes for MIMO systems equipped with MMSE
receivers,” IEEE Trans. Signal Process., vol. 54, no. 8, pp. 3147-3158,
Aug. 2006.
[5] M. Jiang, and L. Hanzo, “Multiuser MIMO-OFDM for next-generation
wireless systems,” Proc. of IEEE, vol. 95, no.7, pp. 1430-1469, July 2007.
[6] L. Zheng, and D. N. C. Tse “Diversity and multiplexing: a fundamental
tradeoff in multiple-antenna channels,” IEEE Trans. Inform. Theory., vol.
49, no. 5, pp. 1073-1096, May 2003.
[7] J. N. Laneman, D. N. C. Tse, and G. W. Wornell, “Cooperative diversity in
wireless networks: efficient protocols and outage behavior,” IEEE Trans.
Inform. Theory, vol. 50, no. 12, pp. 3062-3080, Dec. 2004.
[8] X. Wang and H. V. Poor, Wireless Communication Systems. Pearson Edu.,
Inc., NJ, 2004.
[9] S. Verdu´, Multiuser Detection, Cambridge University Press, 1998.
[10] Y. Cao, and B. Vojcic, “MMSE multiuser detection for cooperative
diversity CDMA systems,” in Proc. IEEE Wireless Commun. and Network
Conf., pp. 42-47, 2004.
[11] L. Venturino, X. Wang, and M. Lops, “Multiuser detection for cooper-
ative networks and performance analysis,” IEEE Trans. Signal Process.,
vol. 54, no. 9, pp. 3315-3329, Sep. 2006.
[12] W.-J. Huang, Y.-W. Peter, Hong, and C.-C. Jay, Kuo, “Relay-assisted
decorrelating multiuser detector (RAD-MUD) for cooperattive CDMA
networks,”, IEEE J. Select. Areas Commun., vol. 26, no. 3, pp. 550-560,
Apr. 2008.
[13] X. Zhang, Y. Gong, and G. Xiao, “Multiuser detection for decode-
and-forward cooperative relaying in DS-CDMA systems,” in Proc. IEEE
Vehicular Tech. Conf., pp. 1-5, 2009.
[14] G. H. Golub and C. F. Van Loan, Matrix Computations. 3rd ed. Johns
Hopkins University Press, 1996.
一、參加會議經過 
IEEE ICCT 在 2010 年於南京舉辦之國際研討會，時間為 2010 年 11 月 11 日
至 14 日，為期 3天。本次會議匯集了各國大學、學術機構、政府從事通訊
暨訊號處理之專家學者發表最新的研究成果 
二、與會心得 
很榮幸筆者與學生陳彥佑參與此次的國際研討會，透過此次會議與國際間的
學者教授進行學術互動及交流，獲益良多。藉由此次會議也了解到國外對於
無線通訊及網路技術的主要探討議題。在此篇研究中我們提出了一種更進階
的技術以利偵測器運作，以提供更好的系統效能，此外藉由所提出的演算法
可同時降低運算複雜度，論文獲得審查委員的接受與同意發表。筆者在此特
別感謝國科會計畫(NSC 99－2221－E－019－026)的經費補助。 
三、考察參觀活動(無是項活動者略) 
無 
四、建議 
無 
五、攜回資料名稱及內容 
 資料名稱: 會議論文目錄暨論文光碟一片  
資料內容: 本次研討會之論文，論文內容涵蓋下列主題 
 多媒體系統、計算機系統、訊號處理、通訊、網路  
六、其他 
 
 
 
Cooperative Transmit Beamforming for Multiuser MIMO 
System 
II. DATA MODEL 
Consider the uplink of a synchronous MC DS-CDMA 
with K users concurrently transmitting binary phase shift 
keying (BPSK) modulated symbols through frequency selec­
tive Rayleigh fading channels [5] to a base station. Also, 
before the transmission, each BPSK modulated symbol is 
first spread by the user's unique T-domain signature code and 
then copied to each subcarrier to multiply the corresponding 
element of their own unique F -domain signature code. Denote 
the T-domain and the F -domain signature codes of user k 
as tk = [tk,1 tk,2'" tk,NJ' and fk = [h,1 fk,2'" h,Nj]" 
respectively, where Nt and Nf are the lengths of the corre­
sponding signature codes and 0' is the transpose operation. 
Assume that M antennas are deployed at the receiver of the 
base station. Then, in a prescribed symbol time duration, 
the equivalent T-domain discrete received signal of the ith 
subcarrier and the mth receive antenna, rmi, 1 ::::: i ::::: Nf, 1 ::::: 
m ::::: M, can be expressed as [2], [3] 
K 
rmi = l: tkhk,mih,iak,my'Pkbk + llmi (1) 
k=1 
where ak,m, Pk, and bk, are the mth antenna response, 
transmitted power, and BPSK modulated symbol, respectively, 
for user k. hk,mi is the associated channel coefficient. llmi is 
the Nt x 1 T-domain additive white gaussian noise (AWGN) 
vector of the ith subcarrier and the mth receive antenna, with 
zero mean and covariance matrix (J2IN, where IN/ denotes 
the Nt x Nt identity matrix. Furthermore, stack the Nf T­
domain received signal vectors of the mth receive antenna, 
rmi, in (1), to form the corresponding FT-domain received 
signal rm = [r�1 r�2 ... r�NJ, shown as 
K 
rm = l:(fk,m 0 tk)ak,my'Pkbk + llm (2) 
k=1 
where fk,m = [hk,mdk,1 hk,m2h,2 ... hk,mNjfk,N,l' is the 
effective F-domain signature vector at the mth receive antenna 
for the kth user and 0 denotes Kronecker product operator [6]. 
llm is the corresponding NjNt x 1 AWGN vector. For brevity, 
we further denote c[,� = fk,m 0tk as the effective NfNt x 1 
FT-domain signature vector of the mth receive antenna for user 
k. In the same manner as (2), the total MNfNt x 1 received 
signal, r, can be obtained by using (2) and stacking the M 
FT-domain received signal vectors, r m, m = 1 . . .  M as 
K " " '"""" SFT r= [rl r2,, ·rMl = �ck y'Pkbk+ll 
k=1 
C}j, ak,1 
(3) 
ck,2ak,2 
r 
FT 
1 
where c�FT = is the effective MNfNt x 1 
cf,Lak,M 
SFT-domain signature vector for user k. II is the associated 
AWGN vector. Note that ak,m, 1 ::::: m ::::: Min (3), is the mth 
antenna response for user k. Therefore, the S-domain signature 
vector for user k can be denoted as ak = [ak,1 ak,2 ... ak,M]'. 
III. THE PROPOSED SCHEMES 
In this section, we present the joint optimum MMSE MUD 
and two separate MMSE schemes for the SFT-domain spread 
MC DS-CDMA. For easy description and without loss of the 
generality, we label user j as the desired user and the following 
derivations of the proposed schemes are for user j. 
A. Joint Optimum SFT-domain MMSE MUD 
According to (3) and based on the MMSE decision criterion, 
the joint optimum SFT-domain MMSE MUD for the jth user 
can be formulated as 
wSFT = arg min E [ l b , - wSFTII r 1 2] 1::::: j ::::: K (4) J wSFT J , 
where ( . ) H is the Hermititian operation. After some manipu­
lations, the joint optimum SFT-domain MMSE MUD can be 
readily shown as 
K 
(l: c�FT c�FTH Pk + (J21x ) -lcjFT 51(5) 
k=1 
where X = M x Nf x Nt. From (5), we can observe 
that achieving the joint optimum SFT-domain MMSE MUD, 
wjFT, requires to compute the inversion of a MNfNt x 
M N f Nt huge matrix, which generally needs huge compu­
tations. For this, in the sequel, we will propose two separate 
MMSE MUDs to alleviate the computational loads. 
B. Separate T-SF-domain MMSE MUD 
This scheme adopts the T-domain MMSE detectors and the 
SF-domain MMSE detectors to construct the overall T-SF­
domain MMSE MUD. First, use the T-domain signal rmi in 
(1) as the input of the MUD considered and then find the 
corresponding T-domain MMSE detectors, WImi' 1 ::::: j ::::: 
509 
K, 1 ::::: m ::::: M, 1::::: i ::::: Nf, as 
arg ��n E [I bj - wTII rmi n (6) 
K hj,mdj,iaj,my'Pj ("' t t'lh .12 + 21 )-It· M N � k k k,m2 Pk (J Nt J f k=1 
Thereafter, for the T-domain MMSE detector, WImi' the 
corresponding output Tj,mi of the mth receive antenna and 
the ith subcarrier, is expressed as 
TH . wj,mirmi, 1::::: J ::::: K, 1 ::::: m ::::: M, 1 ::::: i ::::: Nf 
K 
l: fkj,mihk,mih,iak,my'Pkbk + nj,mi (7) 
k=1 
h d fi - TH d - T
H w ere we e ne tkj,mi = wj,mitk an nj,mi = wj,millmi. 
Next, we invoke the following SF-domain MMSE detector, by 
stacking the M Nf outputs of the T-domain MMSE detectors, 
Tj,mi, 1 ::::: m ::::: M, and 1 ::::: i ::::: Nf, as 
(8) 
'" 
w 
., 
f 
1O • .---_r----�--_r----,_--_r----,_--_r----,_--, 
SNR SNR 
Fig. 1. Comparison ofBER versus SNR, Nt=16, Nj=8, M=6, and K=20. Fig. 3. Comparison ofBER versus SNR, Nt=16, Nj=8, M=6, and K=80. 
SNR 
Fig. 2. Comparisons ofBER versus SNR, Nt=8, Nj=16, M=6, and K=20. 
proposed separate MMSE MUDs. However, The performance 
of the proposed two separate MMSE MUDs is still close to that 
of the joint optimum SFT-domain MMSE MUD. Especially, 
the FT-S-domain MMSE MUD performs almost the same as 
the joint optimum scheme. That is because the degree of signal 
space of the FT-domain MMSE detectors in the proposed FT­
S-domain MUD is Nf x Nt = 128 and larger than that of 
the SF MMSE detector of the T-SF-domain MMSE MUD. 
Furthermore, the simulation setting in Fig. 2 is K = 20, M = 
6, Nf = 16, Nt = 8 and almost the above conclusion from 
Fig. 1 can be received from Fig. 2 again. 
Change the number of users K = 20 to 80, remain the 
other parametter settings as those of Fig. 1 and Fig. 2, 
and the corresponding results are shown in Figs. 3 and 4, 
respectively. From the results of Figs. 3-4, we can observe 
that all the performance of the proposed MUDs deteriorate 
but the above conclusions for Figs. 1-2 are still similar, 
including the proposed STF-domain MMSE MUD yields the 
most superior performance, and the performance of the T-SF­
domain separate MMSE MUDs is inferior to that of the FT­
S-domain separate MMSE MUDs. 
In brief, the joint optimum SFT-domain MMSE MUD 
outperforms the T-SF-domain and the FT-S-domain separate 
511 
SNR 
Fig. 4. Comparisons ofBER versus SNR, Nt=8, Nj=16, M=6, and K=80. 
MMSE MUDs. However, the two separate MMSE MUDs offer 
effective performance close to that of the SFT-domain MMSE 
MUD but with a modest computational overhead. 
ACKNOW LEDGMENT 
This work was supported by National Science Council of 
R.O.C. under contract NSC 99-222l-E-019-026. 
REFERENCES 
[I] c. w. You and D. S. Hong, "Multicarrier CDMA systems using time­
domain and frequency-domain spreading codes," IEEE Trans. Commun., 
vol. 51, no. I, pp. 17-21, Jan. 2003. 
[2] L.-L Yang, W. Hua, and D. S. Hong, "Multiuser detection assisted 
time- and frequency-domain spread multicarrier code-division multiple­
access," IEEE Trans. Vehi. Tech., vol. 55, no. I, pp. 397-404, Jan. 2006. 
[3] L.-L Yang and L.-C. Wang, "Zero-forcing and minimum mean-square 
error multiuser detection in generalized multicarrier DS-CDMA sys­
tems for cognitive radio," EURASIP Journal on Wireless Commu­
nications and Networking., vol. 2008, no. 5, Article 1D 541410, 
doi:10.1155/2008/541410,2008. 
[4] Y. Cai and R. C. de Lamare, "Space-time adaptive MMSE multiuser 
decision feedback detectors with multiple-feedback interference cancel­
lation for CDMA systems," IEEE Trans. Vehi. Tech., vol. 58, no.8, pp. 
4129-4139, Oct. 2009. 
[5] J. G. Proakis and M. Salehi, Digital Communications. 5th ed. McGraw­
Hill, 2008. 
[6] G. H. Golub and C. F. Van Loan, Matrix Computations. 3rd ed. Johns 
Hopkins University Press, 1996. 
[7] S.Verdu, Multiuser Detection. Cambridge University Press, 1998. 
step in the second stage in order to avoid the CTBF updates of 
the PSO to trap into the local solutions. Finally, some computer 
simulations are conducted to verifY the proposed scheme. 
The rest of this paper is organized as follows. Section II 
describes the data model of the cooperative transmit beam­
forming systems and reviews the previous works. The pro­
posed two-stage PSO scheme is presented in Section III and 
some simulation results are provided to compare the proposed 
scheme with the previous works in Section IV. Finally, Section 
V concludes this paper. 
II. PRELIMINARY 
A. Data Model 
Consider the uplink of a multiuser MIMO system with a 
base station deployed N received antennas. Also, there are K 
active users and each of them is equipped with M antennas for 
the transmit beamforming mechanism. Hence, with the help of 
transmit beamforming mechanisms, the K users transmit their 
own signal through Rayleigh flat fading channels to the base 
station simultaneously. Then, the discrete baseband received 
signal can be expressed as 
K 
r= LHktkbk+n=Hb+n, 
k=l 
(1) 
where r is the N x 1 received signal vector. bk is the 
transmitted quadrature phase shift keying (QPSK) symbol of 
the kth user and tk is the corresponding M x 1 transmit beam­
former. Hk is the N x M complex channel matrix between 
user k and the base station and we assume the elements of 
Hk are complex Gaussian distributed with zero mean and 
unit variance. H=[Hl t1, H2t2 ... ,HKtK] is referred to as 
totally effective channel matrix. n is the N x 1 complex 
additive white Gaussian noise (AWGN) vector with zero mean 
and variance No. 
B. Capacity 
Assume that the CSI of all users is perfectly known at 
all transmitters, which can be found in feedback channels. 
Also, the elements of the transmitted symbol vector bare 
statistically independent, i. e. E {b bH} = 1M, where 1M 
denotes the M x M identity matrix and E {.} is the expectation 
operator. Then, the capacity of the multiuser MIMO channel 
considered is given by [8], [9] 
Eb H C = log2 det(IK + MNo 
H H) (2) 
where Eb=E(lbkI
2), k = 1··· K, is the symbol energy. Let 
Fk be the maximum permissible transmission power for user 
k and the power constrain for the corresponding transmit 
beamformer can be expressed as 
(3) 
r--I 
U*""I. , 
b, j . 
I j : NT I I User 21 t> I 
b, t I: 
E . NT 
Feedback 
Channel 
-----� --- -' 
Receiver 
Fig. 1. CTBF of a multiuser MIMO system. 
III. PROPOSED TW O-STAGE PSO SCHEME 
A. Review of the previous works 
In the CTBF communications, the full CSI of all users is as­
sumed to be perfectly available at each transmitter, which can 
be realized by the feedback channel. Based on this assumption, 
several previous works [4], [5] are carried out to develop the 
CTBF schemes. For example, S. Xi and M. D. Zoltowski [4] 
used an i.i.d. statistical model and proposed a quasi-SINR­
Max CTBF (q-CTBF) scheme to find the cooperative transmit 
beamformers, given as 
t%-CTBF = M x max e.v).( H�[ t ::� HmH�+I]-lHk) V If;, m=l,m# 0 
(4) 
where t%-CT BF, k = 1··· K, is the cooperative trans­
mit beamformer for user k and max e.v).(·) indicates the 
eigenvector corresponding to the maximum eigenvalue of (.). 
Further, to reduce the performance loss, the successive and the 
parallel algorithms are proposed in [5]. Inevitably, the above­
mentioned approaches indeed achieve sub-optimum solutions 
only. In order to further enhance the system performance, 
we propose a near optimum algorithm based on the particle 
swarm optimization (PSO) scheme to evaluate the CTBF in 
the sequel. 
B. Proposed Two-Stage PSG Scheme 
PSO is a population based stochastic optimization algorithm 
combining the social psychology principles and evolutionary 
computation. Due to easy implementation and fast conver­
gence, PSO has been applied to various applications in differ­
ent fields. Therefore, in this paper the PSO scheme is utilized 
to develop the optimum joint CTBF scheme. First, for the 
CTBF of multiuser MIMO systems, the dth particle position 
of the ith iteration is expressed as td = [t�/l' t�;, ... , t��]T, 
where t�k = [t�k,l' t�k,2' ... t�k,M]T indicates the coop­
erative transmit beamformer for user k and ( -) T indicates 
the transpose operation .
. 
Also, She c8rrespondinp particle's 
velocity of the PSO is vd = [vdl' vd2' ... , VdK]T, where 
556 
TABLE I 
PARAMETERS EMPLOYED BY THE PROPOSED TWO-STAGE PSO IN THE 
EXPERIMENTS 
Parameter Description Value 
a Inertia weight 0.9 
(3; , i = 1,2 Acceleration coefficient 2 
S Number of population size 10 
Nil i = 1,2 Number of iterations of the ith stage 12 
Vmax Particle's maximum velocity 3.0 
10-1r-----�------�------�----�------�----__, 
---e--- N1=N2=6 
________ N1=N2=8 
----+-- N1=N2=10 
- + - N1=N2=12 
o N1=N2=14 
1 0-7 O
l.':====:=i:
2
===:"�4------�6 ------�8
-------
1
�
0
-----.--J
12 
SNR(d8) 
Fig. 3. BER versus SNR for convergence of the proposed scheme. 
To assess the convergence of the proposed scheme, we 
consider the different iterations for the proposed PSO. Also, let 
the population size, S, of each stage of the proposed PSO be 
10. Then, conduct the proposed scheme and show the average 
BER performance versus the signal-to-noise ratio (SNR) in 
Fig. 3. From Fig. 3, we can observe that the proposed scheme 
approximately converges in S(Nl + N2) = 240 iterations. 
Therefore, we choose the settings of the proposed PSO as 
S = 10 and Nl = N2 = 12 for the following simulations. 
To investigate the performance of the proposed scheme, we 
show the BER results versus the signal-to-noise ratio (SNR) 
in Fig. 4. For comparisons, four CTBF schemes: the q-CTBF 
[4], the successive [5], the parallel [5], the conventional PSO 
[6], and the proposed two-stage PSO scheme, are carried out 
in terms of the average BER performance. To use the same 
computational complexity as those in the proposed PSO for 
fair comparisons, the conventional PSO adopts 10 and 24 as 
the population size and the the number of iterations, respec­
tively. Also, the V-BLAST symbol detection method [10] is 
adopted at the base station for the above five schemes. We can 
observe from Fig. 4 that the five schemes perform almost the 
same at SNR :s; 0 dB. However, as the SNR increases, the 
proposed two-stage PSO scheme can outperforms the other 
four schemes, especially at SNR > 12 dB. 
558 
a: 
w 
'" 
10° 
10-1 
10-2 
10-3 
10-4 
10-5 
10-6 
10-7 
10-8 -10 
--a-- q-CT8F[4I 
----...-- parallel[5] 
----+-- successive[5] 
---e--- conventional PSO[6] 
--+-- proposed 
----+-- single user bound 
-5 o 5 
SNR(d8) 
10 15 
Fig. 4. BER versus SNR for performance comparisons. 
V. CONCLUSION 
20 
In this paper, we present a simple, yet effective two-stage 
PSO based cooperative transmit beamforming for multiuser 
MIMO systems. The proposed new scheme estimates beam­
formers of all users simultaneously. Especially, the proposed 
scheme uses a two-stage PSO mechanism to avoid the PSO 
to achieve the local solution but without increasing extra 
computational load. Finally, computer simulations results show 
the proposed new scheme can provide better performance than 
the pervious works, especially at SNR > 12 dB. 
Acknowledgement 
This work was supported by National Science Council of 
R.O.C. under contract NSC 99-2221-E-019-026 and NSC 99-
2S15-C-019-033-E. 
REFERENCES 
[I] W. C. Chung, N. J. Aug., and D. S. Ha, "Signaling and multiple access 
techniques for ultra wideband 4G wireless communication systems," 
IEEE Wire. Commun.. vol. 12, no.2, pp. 46-55, Apr. 2005. 
[2] R. W. Heath, and A. J. Paulraj, "Switching between diversity and 
multiplexing in MIMO systems," IEEE Trans. on Commun., vol. 53, 
no. 6, pp. 962-968, June 2005. 
[3] S. Serbetli and A. Yener, "MIMO-CDMA systems: Signature and 
beamformer design with various levels of feedback," IEEE Trans. on 
Signal. Proc., vol. 54, no. 7, pp. 2758-2772, July 2006. 
[4] Songnan Xi and M. D. Zoltowski, "Uplink transmit beamforming design 
for SINR maximization with full multiuser channel state informa­
tion,"Proc. SPIE Int. Soc. Opt. Eng., 2008. 
[5] Songnan Xi and M. D. Zoltowski, "Iterative SINR-MAX cooperative 
beamforming in multiuser MIMO systems," in IEEE Sarnoff Symposium, 
pp. 1-6, 2008. 
[6] Y. Shi and R. C. Eberhart, "A modified particle swarm optimizer," in 
Proc. IEEE Congr. Evol. Compt., pp.69-73, 1998. 
[7] H.-Y. Lu, W.-H. Fang and K.-C. Huang,"Joint generalized antenna 
combination and symbol detection based on minimum bit error rate: A 
particle swarm optimization approach," IEICE Trans. Communications, 
vol. E91-B no. 9, pp. 3009-3012, Sep. 2008. 
[8] A. F. Molisch and M. Z. Win, "MIMO systems with antenna selection," 
IEEE Microwave Mag., vol. 5, no. I, pp. 46-56, 2004. 
[9] A. Gorokhov, M. Collados, D. Gore, and A. Paulraj, "Transmit / receive 
MIMO antenna subset selection," in Proc. IEEE Int. Con! Acoust. 
Speech Signal Proc., pp. 13-16,2004. 
[10] P. W. Wolniansky, G. J. Foschini, G. D. Golden, and R. A. Valenzuela, 
"V-BLAST: An architecture for realizing very high data rates over 
the rich-scattering wireless channel," in Proc. Int. Symp. Signals, Syst., 
Electron., pp. 295-300, Sep.-Oct. 1998. 
99 年度專題研究計畫研究成果彙整表 
計畫主持人：盧晃瑩 計畫編號：99-2221-E-019-026- 
計畫名稱：多使用者偵測技術輔助近似即時之中繼分碼多工系統研究 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 3 3 100%  
研究報告/技術報告 0 0 100%  
研討會論文 2 3 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 3 3 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
