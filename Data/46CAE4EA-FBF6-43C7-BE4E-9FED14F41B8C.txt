 ?   ? II
?????????????????????  
Design and Implementation of Efficient Multicast Protocols for Bluetooth Wireless Networks 
?? ???NSC 95-2221-E-164-005 
?? ???95/08/01 ~ 96/07/31 
? ? ?????  ??????????? 
E-mail: cctas@tcts.seed.net.tw 
    
?? ????? 
???? 
Bluetooth(??)????????????
?????????????????????
??? Bluetooth ?????????????
?????????????????????
(Multicast)????????????????
?????????????????????
?????????????????????
?????????????????????
???????????(Multicast Tree)???
?????????????????????
?? MANET ????????? Multicast 
Protocol ?????????????????
MANET ?????????????????
MANET ?????????????????
??????? 
???????????????????
??????(Wireless Personal Network)???
????????????????? Multicast 
Tree???????? Multicast ??????
?????????????????????
Multicast Tree???????? Role Switch ?
???Multicast Tree?Topology???????
?Tree????????????? Piconet??
?? Tree ?????????(Broadcast)???
??(Multicast) ???????????? Role 
Switch ??????????(Internal Node)?
????????? Slave/Master ??????
????????????????? 
????????????? Linux ?
Windows ?????????? HCI Driver??
????????? Tree ??????
End-to-End transmission delay ? ? ? Traffic 
bottleneck?????????????????
??? 
????Bluetooth? Piconet? Scatternet?
Relay?Multicast?Multicast Tree 
 
 
???? 
Bluetooth radio network is a wireless 
technology which supports low power, low cost and 
short range communication services. Multicast is one 
of the most important services which delivers 
multimedia data from a single source to a set of 
predefined multicast members. In the last decade, a 
large number of multicast protocols have been 
proposed for MANET. However, the differences 
between MANET and Bluetooth networks in radio 
characteristics result that applying the existing 
multicast protocols on a given Bluetooth scatternet 
will create an inefficient multicast tree.  
This project aims at developing an efficient 
multicast protocol for a given Bluetooth scatternet. 
Firstly, we develop an efficient tree construction 
protocol to construct a multicast tree that contains all 
multicast members in the tree. After that, the role 
switch techniques are applied to the constructed tree 
for improving the tree topology and changing the 
role of each device that participates in the multicast 
tree. The resultant tree has characteristics including 
lower tree height and exploiting broadcast 
advantages from multicast service.  
In addition to theoretical study, we also 
implement the developed multicast protocols on both 
Linux and Windows systems based on the existing 
Bluetooth driver. The designed and implemented 
multicast protocols have advantages including low 
power consumption, high degree of path sharing, 
small tree height, low end-to-end delay and few 
forwarding nodes.    
Keywords: Bluetooth? Piconet? Scatternet?
Relay?Multicast?Multicast Tree 
 
?? ??????? 
Bluetooth ???????????????
?? 2.4GHz?????? ACL? SCO Link??
????????????????Bluetooth ?
???????????Frequency Hopping??
?????????????????????
?????????????????????
???????????????????
 ?   ? 4
???????????????????
Unicast?Broadcast?Multicast ????????
?Multicast Tree??? Sender ????? Sender
?Multicast Group????????????    
? Shared Tree[1][2][3][4][5]???????
????????????? Network ??
Device ????? Tree?? Source ?? Source 
node ?????????? Destinations???
Shared Tree ????????????????
?????? Flooding packets??? Ad-Hoc 
Network ??Device ? Mobility ?? Shared Tree
?????????????????????
?????? Shared Tree ??Source ? Source 
Node?????????? 
DBMRP(Degree-Based Multicast Routing 
Protocol) [14]???????????????
??????????????????
Multicast Tree??Multicast Tree???????
??????? Device??? Agent ?????
???????????????? Device ??
? Device ???? Agent ??????????
?????????????????????
?????????? Multicast Tree?????
????????????????????
?????? Tree??????? 
? CAMP(Source-Assisted Mesh Protocol)[15] 
????????????? Mesh ?? Tree ?
?????????????(Robustness)???
????? Multicast Group ?????????
Mesh,???? Group????????? Source
??????? Source Device???? Group?
????? Group ????? Source ?????
??? Source??Group Mesh????????
??????? Source-Assisted ???????
Device-Failure ?????? break??????
?? Mesh????????????????
Mobility?????????? 
FGMP(Forwarding Group Multicast Protocol)[2] 
????????????? Forwarding Group
??? Multicast Tree?? Forwarding group??
???? Reverse Shortest Path Forwarding ??
Reverse Path ??Device?? Forwarding Group?
? Sender??????Multicast Group????
????(Broadcast)? Forwarding Group???
Forwarding Group??? Receiver??Multicast?
???? Reverse Shortest Path Forwarding???
?????????????????????
???????????? Flooding packet ??
? Forwarding Group??????? Overhead ?
?? 
¾ Location aware ?Multicast routing 
??????????? GPS ?????
Multicast Protocol?? Location Aware ?Multicast
????? Device ???? GPS ??[16]???
?? Device ????????????????
?????Multicast Protocol?????Multicast 
Tree??????????ODMRP(On-Demand 
Multicast Routing Protocol)[17][18] ? ? ? ?
FGMP??????????Multicast Group??
Multicast ???? Flooding???? Join Data?
??????????? Group ??????
Join Data???????? Routing Table???
Join Table?????????????????
?????????? On-Demand ??????
???????? Overhead?????????
?? Mobility ???????????????
??????????? Flooding??????
? Group ?????????????????
????????????????? 
????802.11??????Ad-Hoc???
Bluetooth Scatternet????????Bluetooth?
?????????????? 802.11 ????
?????? Device ????????????
?? Devices ??????? Piconet?? 802.11 
Tier ?????? Device ??????????
??????????????? Device???
???????????????? Device ??
????????? Bluetooth ?? FHSS ???
?????? Devices ???????? Piconet
????????????????? Bluetooth 
Device ???? 10 ????????? Piconet
???????????? Bluetooth Radio 
Network ???? Multicast ????? Ad Hoc 
Network ?????????????????
???????? Bluetooth Network ?????
????Multicast Tree?????? Role Switch
??? Multicast Tree ??????? Tree ??
Member Device???????????????
???? Tree ???????????
End-to-end Delay?????????????
Piconet ????????(Broadcast) ????
?? Multicast ???????Tree ????
Device ??????????? Delay Time??
????Multicast???????????? 
 
?? ??????? 
4.1 ?????? 
????????????? Scatternet ??
??????? Scatternet ?????????
Multicast protocol???????Multicast Tree?
???????????? 
 ?   ? 6
A (Source)
m1
m3
m2
m4
m5
A (Source)
m1
m3m2
m4
m5
(a)    (b)
(d)    (c) 
A (Source)
m1
m3
m4
m5m2
A (Source)
m1
m3
m4 m5m2
Level 1
Level 2
A (Source)
m1
m3m2
m4
m5
??Max hop ?????????? Multicast 
Packet ? Delay time??? Multicast tree ??
Piconet ??Member Master ????????
Device?? Internal node Member(? Role?M/S 
Relay)??????? Multicast packet?? Core
??? Multicast Tree ??? Piconet ? Member 
Master??????????? Piconet?Device
????????? Device?????????
???Multicast Tree??????? Life time? 
    ?Phase II???????Member??Core
????????? Multicast tree ?????
Core??Multicast tree???????????
Multicast tree??????????? Core??
???Multicast tree??????? Core???
???????????????? Device? 
?? Core???Multicast tree????????
?????????????? 
(1) ??? Tree???????????? 
(2) ??Link?Device?Leaf?????Internal 
Node??? 
(3) ?????? Device??? Internal Node?
??? 
(4) ????? Device??? Leaf???? 
(5) ????Master??????Core????
??? Internal node?? Piconet?????
? Leaf????? 
?? (? )?????????? Multicast 
Tree??? Tree???????? Tree????
?? Tree ??? 3????????????
2??????? Multicast Tree ???????
Max Hop????Delay Time????????
????????? Member ????????
?????? Tree????????? 
 
  
?(?): ???Multicast Tree????  
???????Multicast Tree??????
? Role Switch Operation ????????
Multicast Member ????????????
Multicast Tree?? Multicast Tree ??????
Path?Delay time??Forwarding node?????
???? Tree? Leaf????????????
?????? Device ???????????
Leaf ?? Internal node ??????? Multicast 
Tree?????????????Multicasting?
?? 
(2) TMCP: Two-Layer Multicast Communication 
Protocol for Bluetooth Radio Networks 
??????? Scatternet????????
??? Multicast Tree??????????
Phases??? Phase I ?????? Flooding ?
Location Information ????????????
? Multicast Tree??? Tree ??????
Member?Phase II??? Role Switch?????
Piconet???? Tree????? Phase III???
???? Role Switch ?????? Sub-Tree ?
Sub-Tree?????????Multicast Tree??
?????? 
Phase I?Multicast Tree Construction 
? Phase I???????????????
?? Multicast Tree?? Tree ???? Multicast 
Member??? (? )(a)???Scatternet ???
Devices ????????????????
Device A ??????????? Multicast ?
??Device m1~m5 ???????????
Phase ? ? ? ? ? ? Flooding ? ? ? ?
BD_ADDR?Clock?Source Location ? Member 
Location Information ????????????
? Page State??? Member ???????
(? )(b)?????? Flooding ??????
Device A??? Master??????? Multicast 
Tree ?????????????? Page State
????? Role Switch????”??”????
???? Slave/Master(??? Slave ????
Scatternet???????Master???Multicast 
Tree ???)?? Role Switch ????????
? Page State????(?)(c)??? Device A??
Role Switch ??? Device m3 ?????
Scatternet ?? Work Load ?????(forward) 
Flooding????????”??”??? 
 
?(?): ?????Multicast Tree? 
????????? Flooding ??????
Member M/S Relay 
Member Master 
Member Slave 
 ?   ? 8
???????????????????
?Multicast Tree???????? Tree????
??? Location Information ????????
Role Switch ???????????? Multicast 
Tree??????????????????
???? Piconet????? Delay time????
???????? 
4.2 ???? 
???????????????????
?????? Multicast Protocols???????
???????? Linux ???? Bluetooth ??
????????? HCI (Host Controller Interface)
?????????? Multicast ???????
???? Multicast Protocol ?????????
? Linux ???? Bluetooth ?????????
???????????? Linux ? Bluetooth 
Driver ???????????????
Multicast Protocol???? 
1. Linux ?????Bluetooth Driver ? HCI(Host 
Controller Interface)?????? 
?? Linux ??????????????
?????????????????????
?????????????????????
?????????????????????
????????????? Linux ?????
?? Bluetooth Driver?????? Bluetooth 
Driver???? HCI ?????? Bluetooth ??
?????????????? Scatternet???
?? Multicast Protocol???? Role Switch??
????????Multicast Protocol? 
?? Host ?????????????(?)
??????Bluetooth Chip??USB Port???
?? Host?????Host??????? Linux 
????????????? Bluetooth Chip??
?????Host?Bluetooth????HCI Packets
?????????????? Host A ???
Host B? 
Linux Operating System
Physical Bus Driver
HCI Driver
ControlL2CAPAudio
Higher layer
Bluetooth Chip
Link Controller
Link Manager
HCI Driver
Physical Bus Driver
Linux Operating System
Physical Bus Driver
HCI Driver
ControlL2CAPAudio
Higher layer
Bluetooth Chip
Link Controller
Link Manager
HCI Driver
Physical Bus Driver
H
C
I Packets
H
C
I Packets
Host A Host B
USB Port USB Port
 
?(?)??????? 
??? Windows ?????? Bluetooth 
SDK???????? License????????
?????????????????????
?? SDK?????????????????
??? API???? Bluetooth device?????
???????????? API ???????
???????? SDK???????????
??????????????????? Open 
Source ??????????????????
Linux?????kernel 2.4.x?Bluetooth????
Affix Bluetooth Protocol Stack for Linux?????
???? C++?? QT ????????? C++
?Windows??? HCI driver???Windows?
???? Bluetooth ????????????
?? 
 Linux????? Kernel?? 
    ? ? RedHat ? Mandrake ? SuSE ?
Slackware?Debian ?????????
GNU/Linux???Kernel???2.4.x??? 
 Affix Bluetooth Protocol Stack 
    Affix ????????? protocols ?
?HCI?L2CAP? RFCOMM?SDP ???
?? Bluetooth Profiles? 
¾ Affix ?? 
 ??? 
 ??L2CAP and RFCOMM protocols
?Socket interface 
 ???????????? 
 SMP safe 
 ????Bluetooth devices 
¾ Affix ????????  
 i386 
 ARM (e.g. Compaq iPaq) 
 PowerPC (e.g. Imac) 
 ??????????????? 
¾ Affix ? ? ? ? ? ? ?  Bluetooth 
Profiles 
 General Access Profie 
 Service Discovery Profile 
 Serial Port Profile 
 DialUp Networking Profile 
 LAN Access Profile 
 OBEX Object Push Profile 
 OBEX File Transfer Profile 
 PAN Profile 
 QT???? 
    Linux?? Xwindow????????
???? KDE ????????????
???QT???QT??? 3.0???Linux
?Windows??????????????
PDA?????????????????
???????????QT????QT?
 ?   ? 10
?(?): ?? Bluetooth??? HCI??? 
???? Blurtooth Device????????
??????? Blurtooth Device ??????
Socket?????????? OBEX ?????
???Bluetooth Device???????????
??????????????????? 
 ?? Socket????? 
¾ BTPROTO_HCIACL  
Creates HCI ACL socket. Valid type: 
SOCK_SEQPACKET. 
¾ BTPROTO_HCISCO  
Creates HCI SCO socket. Valid type: 
SOCK_SEQPACKET. 
¾ BTPROTO_L2CAP 
Creates L2CAP socket. Valid type: 
SOCK_STREAM, SOCK_SEQPACKET. 
¾ BTPROTO_RFCOMM 
Creates RFCOMM socket. Valid type: 
SOCK_STREAM. 
 HCI Driver???? 
¾ CSRCommandInquiry??? master inquiry
??? 
¾ CSRCommandCreateConnection ? ? ?
master page??? 
¾ CSRCommandDisconnect???????
??? 
¾ CSRCommandAcceptConnectionRequest ?
?? slave????????? 
¾ CSRCommandRejectConnectionRequest ?
?? slave????????? 
¾ CSRCommandSwitchRole???????
????? 
???????? Multicast Tree?????
??? Scaternet??Multicast Tree??????
Scatternet??????? Multicast Tree????
Role Switch HCI ??????????????
??Piconet ???? Role Switch ??????
Create Connection?Disconnect? Switch Role??
?? HCI ?????????????????
???? HCI Command?HCI Event?ACL 
Data??? SOC Data??(?)???? Piconet?
Role switch???? HCI??????????
Inquiry ? Create Connection ? Data Transfer ?
Switch Role?Data Transfer ? Disconnection ??
?????????????????????
???????????????????? 
¾ Write Scan Enable: Slave ?? Inquiry Scan 
Status????? Inquiry ??? Page Scan 
Status? 
¾ Inquiry: Master?? Inquiry Status? 
¾ Create Connection: Master?? Page Status? 
¾ Accept Connection: Master ? Slave ????
Connection Status? 
¾ Switch Role: Master? Slave?? Role Switch
???? 
¾ Disconnection: Master ?? Standby Status?
Slave?? Inquiry Scan Status? 
 ?   ? 12
Connect Button??? Bluetooth Device????
????????????? Device ????
Bluetooth ?????????????????
? Socket????????????Multi-thread
????????Device????piconet???
????? 
???: 
???????????? Link Establish 
Module?Link Disconnect Module?Role Switch 
Module ? Traffic Monitor ??????????
? Link ???????? Link??????
Device ??????????????????
?????????? Topology Control????
???????? Topology Control ?????
Scatternet??????Multicast Tree? 
???:  
???????????? Share-Tree 
Protocol ? Two-Layer Protocol ? Shortest Path 
Maintenance? Routing Maintenance??????
?????????????Multicast Tree??
? Tree ??????????????????
?? Multicast Protocol ???????????
???Multicast??? 
????????????????????
??????????? Multicast Protocol ??
???????????????????
Performance ????????????????
?????????????????????
?????????????????????
?????????? Multicast Protocol? 
 
???????? 
? SCI ?????(?????) 
[1]. C. Y. Chang, C. T. Chang, and S. C. Tu, 
“Obstacle-Free Geocasting Routing Protocol for 
Ad-Hoc Wireless Networks,” ACM/Baltzer 
Journal of Wireless Networks, Vol. 9, pp. 
143-155, 2003. (SCI) 
[2]. C. Y. Chang, P. C. Huang, C. T. Chang, and Y. 
S. Chen, “Dynamic Channel Assignment and 
Reassignment for Exploiting Channel Reuse 
Opportunities in Ad Hoc Wireless Networks,” 
The IEICE Transactions on Communications, 
Vol E86-B, No. 4, pp. 1234-1246, 2003. (SCI) 
[3]. C. T. Chang, C. Y. Chang and J. P. Sheu, 
“BlueCube: Constructing a Hypercube Parallel 
Mobile Computing and Communication 
Environment over Bluetooth Radio 
Systems,” Journal of Parallel and Distributed 
Computing, Vol. 66, pp. 1243-1256, 2006. (SCI) 
[4]. C. Y. Chang, C. T. Chang, Tzung-Shi Chen and 
Hsu-Ruey Chang, “Hierarchical Management 
Protocol for Constructing a QoS 
Communication Path in Wireless Ad Hoc 
Networks,” Information Sciences, Vol. 177, 
pp.2621-2641, 2007. (SCI) 
[5]. C. Y. Chang and C. T. Chang, “TARP: A 
Traffic-Aware Restructuring Protocol for 
Bluetooth Radio Networks,” Computer 
Networks, Vol. 51, pp.4070-4091, 2007. (SCI) 
 
??????(?????) 
[1]. C. Y. Chang, C. T. Chang, and P. C. Huang, 
“Dynamic Channel Assignment and 
Reassignment for Exploiting Channel Reuse 
Opportunities in Ad Hoc Wireless Networks,” in 
Proceedings of the 8th IEEE International 
Conference on Communication Systems 
(ICCS'2002), Singapore, Nov., 2002. 
[2]. C. Y. Chang, C. T. Chang, and S.C. Tu, 
“Obstacle-free geocasting protocol for ad hoc 
wireless networks,” The IEEE Wireless 
Communications and Networking Conference 
(WCNC), New Orleans, USA, March 2003. 
[3]. C. T. Chang, C. Y. Chang, J. P. Sheu, 
“BlueCube:Constructing a Hypercube Parallel 
Computing and Communication Environment 
over Bluetooth Radio System, ” in Proceedings 
of the International Conference on Parallel 
Processing (ICPP2003), pp. 447-454, 
Kaohsiung, Taiwan, Oct., 2003. 
[4]. C. T. Chang, C. Y. Chang and J. P. Sheu, 
“TARP: A Traffic-Aware Restructing Protocol 
for Bluetooth Radio Networks,” in Proceedings 
of the 16th Annual IEEE International 
Symposium on Personal Indoor and Mobile 
Radio Communications (PIMRC 2005), Berlin, 
Germany, September, 2005. 
[5]. C. Y. Chang, H. R. Chang, C. C. Hsieh, and C. 
T. Chang, “OFRD: Obstacle-Free Robot 
Deployment Algorithms for Wireless Sensor 
Networks,” IEEE WCNC, Hongkong, March 
2007. 
 
?? ????? 
???? Scatternet ??????????
Multicast tree???????Member?Device?
????????????? Device?????
? Delay Time ???? ??????????
? Scatternet ????????? BlueMtree ?
????? Connected Scatternet??? Role 
Switch Operation ????? Piconet ?????
???????????Multicast Tree????
?? Multicast Tree ??????? Inquiry ?
Inquiry Scan ??????? Role Switch 
Operation?????Multicast Tree??????
???Tree????????Multicast Tree??
 ?   ? 14
 
 
 
 
 
 
 
 
 
? Y04 
????????????????????????? 
                                                           96?  3? 21?
????? ???  
 
????
??? 
????????? 
?????? 
 
     ?? 
?? 
     ?? 
96?3?11?  ?   96?3?15? 
 
Hong Kong?? 
?? 
?? 
 (??) IEEE???????????? 
 (??) IEEE Wireless Communication & Networking Conference          
(WCNC2007) 
?? 
?? 
?? 
 (??) ????????????????????????????
 (??) On Providing Temporal Full-Coverage by Applying Energy-Efficient 
Hole-Movement Strategies for Mobile WSNs 
???????????? 
???????? 
??????? ” IEEE Wireless Communication & Networking Conference”????
??????????????????????????????????????
?(Ad-Hoc Networks)?WiMAX?????(Network Protocol)?MIMO?????(WLAN)?
??????(Sensor)????????????????????????????
????????????????????(Ad-Hoc Networks) ?????(WLAN)?
??????(Sensor)?WiMAX?????????????WiMAX???????
??????????????????????????????????????
????????? WiMAX?????????????????????????
????????????????????????????????????? 
 
?????? 
?????????????????????????? Sensor Network???
??????????????????????????????????????
??????????????? sensor network? ad-hoc network?WiMAX????
???????????????????????? 
 
???? 
????????????????????????????????????
????????? 
 
??????????? 
??????? 
Call for paper ??? 
 
 
