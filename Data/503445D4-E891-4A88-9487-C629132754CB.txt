2 
 
中文摘要 
 
    隨著醫療發展的演進，藥物之改良釋放劑型開始蓬勃發展，其目的無非是因為這些改
良釋放劑型在控制藥物釋放時間以及決定最佳的釋放時間上，我們可以較容易的掌握。且
改良釋放劑型(modified release dosage form)在降低毒性、增加療效以及減少投藥次數
上有顯著的效果，所以可以預期的是藥物改良劑型(modified - release dosage form)仍
然將是未來醫藥發展的趨勢。醫用超音波具有使用便利、安全性高、成本較低以及診斷可
信度高等許多優點，在疾病的診斷與治療上，已經佔有舉足輕重的角色；我們在本計劃中
將使用自製以及商用的微氣泡來做研究的材料，他們可以被用來當作藥物載體或是用來探
究超音波藥物傳輸系統載體特性的探討，我們期望結合超音波兼具觀察與釋放的優點以及
自製的藥物載體以及商用對比劑的特點，建立了一套超音波藥物傳輸系統，並期望它能適
用於腫瘤治療或是其他的臨床醫療上。 
    在本計畫中，我們將整個研究分為四個部份來進行研究:一、對比劑的超音波信號特性
分析。二、微氣泡對超音波訊號的響應模擬。三、載體破裂控制。四、載體殼層參數探討
與掌握。 
 
 
英文摘要 
With the progress of biomedical engineering, the modified-release dosage mechanism has 
started to develop prosperously in recent years. It is easier to handle modified-release dosage for 
controlling and determining the optimal time of releasing medicine, and the modified-release 
dosage has obvious effects on diminishing toxicity, raising curative effect and decreasing the 
times of medication. Hence, we could expect that modified-release dosage form will still be the 
tendency of the medical development. Ultrasound has several advantages, such as convenience to 
use, safety of non-invasive, lower cost , and reliable diagnosis . Consequently it has become to 
play a significant role both on the diagnosis and therapy .  
 
In this project, we will use self-made and commercial contrast agents for our research . It can 
be used for drug carrier and we will also survey their acoustic characterization. We attempted to 
set up an ultrasound drug delivery system(UDDS) by combining the excellent acoustic properties 
of self-made contrast agents and the advantages of ultrasound for monitoring and releasing the 
drug and expect to utilize it in cancer therapy or other clinical medicine. Therefore, this project 
will aims at the following issues :  
- Analyzing the acoustic characteristics of contrast agents  
- Stimulating the nonlinear microbubble response  
- Controlling the destruction of drug carrier by ultrasound 
- Research on the shell effect and mechanic parameter  
 
 
 
4 
 
已導致現今超音波對肝臟疾病診斷常被定位在用於輔助抽血檢驗的結
果。 
 
    一般而言，我們利用超音波訊號經由物質所產生的信號衰減、背散射
係數、信號漂移、聲速等參數以辨別肝臟的病變（如：纖維化、肝硬化、
脂肪肝等）。而由於近年來超音波對比劑技術的蓬勃發展，應用其高度非
線性的行為，使得利用高次諧波成分達到穿透式的硬化診斷成為一項可
能的技術。雖然，衰減係數對於診斷大範圍的組織病變可以得到相當準
確的估測。但是卻無法診斷隨機分布於肝臟內的小病變。因此，本論文
的基礎為藉由使用多組頻率激發組織之後的對比劑，我們可應用其所產
生的諧波訊號達到應用穿透訊號估測組織衰減係數。最終利用所得到的
衰減係數以診斷局部病變的所在位置以及肝臟整體的健康狀況。 
 
理論背景 
   
應用對比劑的諧波信號估測肝組織衰減係數必須假設待測組織包覆
一條大血管使其中存在著隨機散佈的微氣泡。在此，我們將利用功率放
大器激發微氣泡，並將其所產生的諧波信號是為隨機信號原，用以估測
肝組織所造成的衰減。 
 
圖一為上述環境的簡化模型，我們可看到肝組織及其包覆的血管。
微氣泡隨機分佈於血管當中。在此所定義的待測組織位於血管與探頭之
6 
 
是可以忽略的。（2）由於微氣泡為極端非線性的物理特性，因此，與其
相比較軟組織所產生的諧波成份會遠小於微氣泡所產生的部份。因此，
我們在此可假設軟組織為隨頻率有α倍的指數衰減。我們可得訊號 b為
訊號 a通過組織而得到血管前訊號： 
 
     ( ) ( )1 1exp exp 2b A f j f tα π= −  
 
在液體當中的微氣泡，經歷外壓時所產生的震盪行為可以（RPNNP）
方程式所描述： 
 
其中 R為瞬時微氣泡半徑、Ro 為微氣泡平衡時半徑、ρ和μ為液體
的密度及黏滯度、σ為表面張力、Γ為 polytropic exponent、Po 為液
體靜壓。由於我們必須得到微氣泡振盪函數。因此我們假設其隨時間所
產生振盪半徑 R為與平衡半徑 Ro 上一個線性組合的振盪成分 Rox： 
 
        ( )0 1R R x= +  
 
在此，我們有興趣的成份為信號的基本頻率 f1 以及其二次諧振項
2f1。因此，我們可將 R4 代入（7）以及將 RPNNP 方程式簡化至二次向並
加入輸入信號 b而得： 
 
8 
 
空間當中，微氣泡所產生振盪信號的總和。在此我們假設（1）使用一般
微氣泡（free gas）時，氣泡半徑對於系統所發射的頻率範圍內都是均
勻分布的函數（2）在探頭取樣空間中，氣泡本身是不會交互影響的。因
此，在模型上可是為互不相關（3）在取樣空間中，因為微氣泡隨機位置
所產生的隨機相位。假設為均勻分布在［0 ,2π］範圍當中。由於以上
假設，我們可認定接收信號的功率頻譜密度可視為一個以發射訊號為振
盪頻率的解 
 
( )
0 1
2 2 2
0 1 1| exp 2f fE x A A j f tπ=⎡ ⎤ = +⎣ ⎦ ( )0 122 1| exp 2 2f fA j f tπ=+  
 
其中： 
    
( )2
0 1
3 3 11 3
2 2
A A
γ γγ +⎡ ⎤= −⎢ ⎥⎣ ⎦ / 00 0
2 23 P
R R
σ σγ⎡ ⎤⎛ ⎞− + +⎢ ⎥⎜ ⎟⎝ ⎠⎣ ⎦  
    ( )1 11 exp4A A fαµ= −  
      
2
2 1 2
1
2
A A Yχ=  
以及： 
      ( ) 12 22 9 4χ δ −= +  
      
( )
1
2 2
0
0 0 2
2 2
0 0
2 43 3 1
5
2 2
P
R R
Y
R
σ σγ γ
δρω
⎡ ⎤⎛ ⎞⎛ ⎞⎢ ⎥+ + −⎜ ⎟⎜ ⎟⎢ ⎥⎝ ⎠⎜ ⎟= + +⎢ ⎥⎜ ⎟⎢ ⎥⎜ ⎟⎜ ⎟⎢ ⎥⎝ ⎠⎣ ⎦
 
 
10 
 
z 衰減係數的估測方法 
   基於以上理論分析的部分我們可以了解接收信號 d包含組織背散
射成份、基頻訊號、以及二次諧振訊號。我們發覺利用二次諧振訊號
以估測衰減係數可迴避組織所帶來的干擾。因此，以下將解說使用窄
頻訊號所產生的二次諧振估測組織衰減係數的實驗方法。 
    假設發射一頻率為 f1 的窄頻訊號。並經由衰減係數為α的軟組
織衰減過後，並將接收訊號的二次諧振成份利用帶通濾波器取出。我
們可得如下的訊號成份，令其為 S overlay  
      ( ) ( )
42
1 2 1 1
1( ) exp 8 exp 2 2
2 4overly
As f Y f j f tχ α πµ
⎛ ⎞⎛ ⎞= −⎜ ⎟ ⎜ ⎟⎝ ⎠ ⎝ ⎠
 
倘若我們利用相同的發射訊號，但發射到另一個系統為無待測軟組
織，但仍然存在相同環境的微氣泡。則應用同樣的接收方式並利用相同
的帶通濾波器時，我們應該可得到類似無衰減成份的二次諧振訊號： 
       ( )
42
1 2 1
1( ) exp 2 2
2 4
As f Y j f tχ πµ
⎛ ⎞⎛ ⎞= ⎜ ⎟ ⎜ ⎟⎝ ⎠ ⎝ ⎠  
若我們可分別得到以上兩種訊號，則我們可以利用相除之後取對數
的方式得到在頻率 f1 之下的局部衰減係數： 
        11
1
( )8
( )overly
s ff ln
s f
α ⎛ ⎞= ⎜ ⎟⎜ ⎟⎝ ⎠  
當我們想要估測大範圍的頻帶時，我們仍可應用窄頻訊號做估測。
我們可藉由求出各個不同頻率所對應的衰減功率所得到的斜率。因此，
假設傳輸另一個窄頻訊號 f2 其中（f2>f1）時，應用之前方式，我們亦
可得到一相對於頻率 f2 之上的局部衰減係數 
12 
 
超音波實驗系統架構圖 
 
 
 
 
 
 
 
 
 
14 
 
研究結果與討論 
 
   我們使用五個不同中心頻率，在頻帶範圍[2.25MHz 2.5MHz]之間發射
訊號，以激發在循環系統當中的微氣泡。並接收二次諧振成份。其頻率
範圍在[4.5MHz 5MHz]當中的二次諧振回波。 
 
 
   實驗訊號的量測分成兩個部份，第一部分為在放入組織之前，先行量
測在循環系統內微氣泡二次諧振的統計特性。由於微氣泡的散射訊號本
身為一個隨機程序，因此，我們必須求得在二次諧振頻率上的功率頻譜
密度。利用 150 筆接收樣本對其作傅利葉轉換後取絕對值、對數、程已
20 之後作算術平均得到週期譜。第二部份則是重複第一次的量測方式，
但此時在循環系統與探頭之間加入了覆蓋在管線上的肝組織樣本，加上
了肝組織的影響後，我們發覺取樣所得的功率頻譜密度相較於覆蓋之前
較為隨機。而我們可以圖示的方式比較利用五個頻率所得到包含肝臟及
不包含肝臟時所求得的二次諧振項功率頻譜密度比。其中，藍色的頻譜
為不包含肝臟組織的二次諧振項，而黑色成分則為包含肝組織的二次諧
振項 
 
 
 
16 
 
 
 
    因此，經由上圖當中所呈現的結果得到，在此頻率範圍之間的衰減
確實呈現近似於線性的變化方式。因此，我們可以利用所得到的資料估
測大頻率範圍的衰減係數，所得到的結果為 0.0994dB/cmMHz。 
 
    為了驗證在基頻訊號時，肝組織的背散射成分確實會影響微氣泡的
回波訊號，進而使得利用基頻成分估測衰減係數變的困難。在此將上圖
中基頻訊號的衰減估測圖型求出，如下圖 
 
 
18 
 
生物體的應用 
    相較於傳統使用背散射訊號成分以估測衰減係數的方法，應用於二
次諧振的方法可以視為穿透訊號的估測的方式。因此，應用二次諧振迴
避不同組織所帶來的干擾成為一個可能的作法。在生物體當中，藉由注
入商用對比劑而達到更準確的組織衰減估測，則是未來必須努力的目標。 
 
 
解析度的提高 
    對於組織病變的診斷，除了估測的精準度以外，估測的解析度也同
時是個重要的課題。當發射的訊號為窄頻訊號時，相對的，其發射脈波
的長度就相較於寬頻訊號為長。因此，這使得對於組織估測的解析度因
此受到了限制，並不利於在生物體當中的應用。如何在提高解析度並保
持二次諧振成份的穩定間得到平衡亦為未來重要的課題。 
 
 
 
發表論文 
S.J. Lu, C.Y. Chuang and J. Tsao, “Dosage Prediction via Estimation of Shell Thickness and 
Concentration of Drug Carrier with Microbubbles,” 29th IEEE EMBS Annual Int.Conf. 
(EMBC07), Aug. 23-26, 2007, Lyon, France, pp. 1090-1093. (NSC 95-2221-E002-442) 
 
 
 20 
 
 
 
 
B. Simulation 
 
Although the behavior of a bubble in an acoustic field 
has been studied for a long time, few theoretical describe 
the simulation of a real population of variably sized 
microbubbles in a finite beam. As the first step in our 
simulation, we will select the trilling model to simulate our 
microbubbles (liposomes) and summation all the radiation 
signals from large number of such bubbles. The bubblesim 
[4] is the main software to simulate the single bubble 
response, and we will modify the software to fit this study. 
The simulations include both the simulation of the 
concentration of liposomes and the simulation of the layers 
of liposome shell.  
 
The concentration simulation 
We started the process of simulation by deciding on a 
sample volume with N microbubbles whose size 
distribution is Gaussian distribution after the shell 
parameters of liposomes; Moreover, in order to fit the probe 
response , we use randomly different focal pressures in the 
simulation. The cycles of pulse are given 15, 20,and 25 
cycles. The selection of concentrations will fit the 
experimental concentration. 
 
The shell thickness simulation 
We started the process of simulation by deciding on a 
sample volume with N microbubbles whose size 
distribution is Gaussian distribution after the shell 
parameters of liposomes; we adopted transmitted 
narrow-band pulse ( fc =2MHz, cycles = 15 , PRF=1KHz) 
to simulate 3 different thicknesses of liposomes. We 
simulated the drug carrier (liposomes) consisting of gas, 
with mean diameter being 1. 4 micron meter and shell 
thickness being 1 ,3 ,and 5 layers.(3.5, 10.5, and 17.5 nm). 
Using several numerical analysis methods, we can get the 
frequency response of all bubbles.  
The equations and parameters used in our simulations are 
summarized below. 
Equation of motion: Rayleigh-Plesset with radiation 
damping 
 
23 0
2
L O i
L
p p p a
aa a p
cρ ρ
− −+ − − =&& & &  
Boundary condition: Pressure PL at the bubble wall, 
using the exponential shell model  
0 // 3
0 04 12 ( (1 ) ) ( )
x xx xSe e
L L S S
e
i
d aa
p G x e e x p
a a a
κη η −−= − + − + +& &  
where 0 1
1 1, ,  and 
8 4
e
e e
a a ax x x x
a a
−= = = =&& , 
Shell parameters 
4.0
Se
d nm= , 50SG MPa= , 20.8 /S Ns mη =  
 
The Trilling model 
 
The Trilling model [4] is derived from the acoustic 
approximation, the speed of sound is modeled as constant. 
It is only meaningful to the first order in the acoustic 
Mach-number M a c= & . The order term of 21 c are removed 
from the ODE for the bubble surface, reducing it to  
23 4(1 2 ) (1 ) 0
2 3
L
p pa a a
aa a pL
c c cρ ρ
∞ −− + − − + =& &&& & &  
This equation of motion for a gas bubble was published 
by Trilling in 1952. 
 
With a driving pressure ( )ip t , the Trilling equation is 
modified to  
2 ( )3 4(1 2 ) (1 ) ( ) 0
2 3
i L
i
p p t pa a a a
aa a pL p t
c c c cρ ρ ρ
∞ + −− + − − + + =& &&& & & &   
The parameters used in simulations are Density of water = 
998 kg/m3, Shear Modulus = 50MPa, Polytropic exponent 
of gas = 1.4, External pressure Range from 0.5 to 1.5Mpa, 
hydrostatic pressure = 1.01×105 N/m2, Distance = 2cm, 
Acoustic speed = 1540 m/s and Shear viscosity of liposome 
= 0.8Pa·s. 
 
C. Experiments of concentration estimation  
 
In the experimental setting (as shown in figure2), we use 
the ultrasound RF signals to measure the acoustic reflection. 
In this study, pulse trains (PRF=1KHz, cycles=15, 20,and 
25 cycles) are transmitted with the 2.25MHz center 
frequencies, then backscattered signals are received and 
digitized for processing. We record the second-harmonic 
signal strength in several concentrations to findt the relation 
between concentrations and strength. In addition, we like to 
find the optimal method for the prediction of 
concentrations. 
 
Figure1.The size disturbition of original lipsomes in 
N4PLUS Coulter 
 22 
 
strength making the concentration prediction confused. It is 
useful for us to understand the liposome shell affecting drug 
packaged.  
Therefore, we could realize the drug carrier structure and 
predict the drug dosage by simple volume calculation and 
drug binding estimation. In the future work, we would build 
a model to build a set of dosage prediction system. 
 
 
REFERENCES 
 
[1] Chin, Chien Ting; Burns, Peter N. “Predicting the acoustic 
response of a microbubble population for contrast imaging in 
medical ultrasound” Ultrasound in Medicine and Biology 
Volume: 26, Issue: 8, October, 2000, pp. 1293-1300 
[2] Shih-Jen Lu, Chung-Yuo Wu, and Yi-Hong Chou, 
“Bandwidth-Dependent Subharmonic Response of 
Microbubbles for Pressure Estimation,” 6th International 
Symposium on Ultrasound Contrast Imaging 2004. 
[3] Roger R. C. Liposomes: a practical approach, New York: 
Oxford University Press, 1990. 
[4] L. Hoff. Acoustic Characterization of Contrast Agents for 
Medical Ultrasound Imaging, Kluwer Academic 
Publisher2001. 
[5] E. Stride and N. Saffari, “Investigating the Significance of 
Multiple Scattering in Ultrasound Contrast Agent Particle 
Populations,” IEEE Trans. Ultrason., Ferroelect., Freq. Contr., 
vol. 52, pp. 2332- 2345, 2005 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Figure3.The results of simulation and experiments in 15cycles 
pulse. circle: the experimental data, line: the simulation data. 
Figure5.The results of simulation and experiments in 25 cycles 
pulse. circle: the experimental data, line: the simulation data. 
Figure6 .The spectrum of simulation of thickness
Figure4.The results of simulation and experiments in 20 
cycles pulse. circle: experimental data, line: simulation data.
Figure7 .The spectrum of simulation of thickness  
Dosage Prediction via Estimation of  
Shell Thickness and Concentration of Drug Carrier with 
Microbubbles 
S.J. Lu, C.Y. Chuang and Jenho Tsao 
Dept. of EE. and Inst. of Comm., National Taiwan University, Taipei, Taiwan, ROC 
 
Abstract- For drug delivery applications, dosage prediction 
before release and estimation after release are required 
functions. In this study, we attempted to establish a method to 
evaluate liposome concentrations and liposome shell thickness 
for dosage prediction. We use the Trilling model with 
parameter of phospholipids bilayers to simulate the frequency 
responses under the different acoustic pressure and establish 
an experimental protocol to evaluate the liposome 
concentrations and the liposome shell thickness. 
Our results illustrate the changes on the signal strength for 
different concentrations and show that it is relatively stable to 
estimate the concentrations when the cycles are lower 
(15cycles). Besides, it is verified that the second harmonic 
signal is more sensitive in analyzing different concentrations. 
On the other hand, it is proved that the liposome shell 
thickness affect signal strength and thinner thickness will 
increase the second harmonic response. 
Therefore, in accordance with the theoretical and 
experimental results, we would be able to estimate the 
concentration and the shell thickness of the liposomes. By 
numerical analysis methods, dosage prediction would be built. 
 
I. INTRODUCTION 
 
  In medical ultrasound applications, microbubbles are 
closely tied to the diagnostic and therapeutic uses. In 
diagnostic applications, their sound scattering properties 
yield improved imaging, when the microbubbles are used as 
contrast agents [1]. The harmonics, subharmonics, and 
second harmonic responses from the bubbles assist in 
distinguishing the acoustic scattering of blood flow from 
that of the surrounding tissue[2]. The therapeutic use of 
microbubbles has recently become a subject of much 
interest, one of which is to serve as modified-release dosage 
forms. 
  The modified-release dosage forms start to develop 
prosperously recently. It is the purpose that we can properly 
handle modified-release dosage forms for controlling the 
time of medicine release and determining the perfect timing 
to release. However, the modified-release dosage forms 
have obvious effect on diminishing toxicity, raising curative 
effect and decreasing the times of medication. Hence, we 
could expect that modified-release dosage forms will still 
be a prospect of the medical development . 
  For drug delivery system , the drug must be preserved for  
 
This work is supported by the National Science Council, 
Taiwan, ROC. (NSC95-2221-E002-442). 
E-mail: tsaor215@cc.ee.ntu.edu.tw 
a period of time in order to utilize bubble characteristics for 
targeting and control the release at the best time. Dosage 
prediction before release and estimation after release is 
considerably significant. 
  The difference of harmonic responses generated from 
multi-lamellar vesicles with different numbers of layers and 
the number of bubbles can be used to estimate the shell 
thickness related to numbers of layers and predict the 
concentration of vesicles. However, there is no appropriate 
mathematical model and experimental protocol to 
determine the shell thickness of multi-lamellar vesicles and 
the concentration of vesicles. 
  In this study, we tried to adopt the Trilling model with 
parameter of phospholipids bilayers to simulate the 
frequency responses and establish an experimental protocol 
to evaluate the effect of shell thickness of liposomes to the 
estimation of its concentration. And we also attempted to 
get the optimal condition for measuring the concentration of 
liposomes. Further, we might use the study to predict the 
dosage via concentration. 
 
 
 
II. MATERIALS AND METHODS  
In this section, we will describe our liposomes as drug 
carrier first and then the simulations and experiments on the 
liposome concentration. Besides, the liposome shell 
thickness has a deep connection with signal strength, so we 
do simulation and experiments to evaluate the effect of shell 
thickness.  
 
A. Materials 
 
In this study, we have manufactured our own 
microbubble with lipid-shell (a kind of liposomes) for the 
ultrasound drug carrier, whose diameter is about 1.4µm 
(figure.1). The lipid-shelled microbubble is composed of a 
multi-lamellar lipid shells, a little nitrogen and some normal 
saline. The shell thickness can be expressed in terms of 
number of layers also, which is known to range from 1 to 5 
layers [3]. The lipid shell comprises DSPC, Cholesterol and 
DSPE-PEG-Ome. The shell thickness of liposome is 
controlled by sonicator which controls the numbers of 
layers. In the size analysis, the optical measurement of 
N4-PLUS COULTER was used to analyze size distribution 
of the lipid-shell microbubble. ( as shown in figure 1.) 
Proceedings of the 29th Annual International
Conference of the IEEE EMBS
Cité Internationale, Lyon, France
August 23-26, 2007.
ThP2D1.3
1-4244-0788-5/07/$20.00 ©2007 IEEE 1090
 
 
 
 
 
D. Experiments for shell thickness effect 
 
In the experimental setting (as shown in figure2), we use 
the ultrasound RF signals to measure the acoustic reflection. 
In this study, pulse trains (PRF=1KHz, BW=5%) are 
transmitted with the 2MHz center frequencies, then 
backscattered signals are received and digitized for 
processing. We attempted to get whether different layers 
have difference in the frequency domain to develop the 
forecast of layers of liposomes.  
 
 
 
III. RESULTS 
 
A. simulation and experimental evaluation of concentrations 
   
  Results for the second harmonic signals of simulation 
and experiments for several concentration are plotted in the 
figure 3, 4, and 5. These results illustrate the changes on the 
signal strength for different concentrations (circle: the 
experimental data, line: the simulation data). We compare 
the results of simulation with the results of experiments 
under three kinds of cycles.( 15, 20,and 25 cycles). When 
the concentration of liposomes is below around 40% of the 
concentration ( PS: when 100% of the concentration, DSPC 
is 410− mole, cholesterol is 55 10−× mole, and DSPE- 
PEG-OMe is 62.5 10−× mole in 30 ml.), the ultrasound 
strength is sensitive for the concentration of liposomes. As 
shown in [5], the linear scattering assumed in the simulation 
may no longer be valid, multiple scattering would happen 
and causes apparent discrepency. In three kinds of 
conditions, we could observe that in the thiner 
concentrations there are precise relations between the 
simulations and the experimental results.  In the condition 
of 15cycles, the relation is better than others in the all 
concentrations. And what is more, it is obvious that when 
the cycles are higher, it excites the nonlinear response of 
microbubbles more easily, but it is relatively unstable to 
detect the concentrations. On the contrary, when the cycles 
are lower, it is relatively stable to detect the concentrations. 
It is verified that the second harmonic signal is sensitive in 
different concentrations; Therefore, it is sufficient to prove 
the possibility of prediction of concentrations by second 
harmonic signals. 
 
B. The simulation and experimental evaluation of thickness 
of shell 
 
In the study, we adopted transmitted narrow-band pulse 
( fc =2MHz, cycles = 15 , PRF=1KHz) to simulate 3 
different thicknesses of shell. In this study, the thickness of 
a layer of liposomes is about 3.5 nm under room 
temperature, the original liposomes generally have 3-5 layer 
( the thicknesses of shells are 10.5 - 17.5nm), and the 
handled liposomes generally have 1 layer (the thickness of 
shell is 3.5nm), so we simulated three kinds of shells (3.5, 
10.5, and 17.5nm by thickness). 
 
As a result of the simulation, we could clearly see that 
the thicker the shells of liposomes, the lower the strength of 
non-linear response. Therefore, in the figure 6, it is shown 
that the difference of strength of second-harmonic response 
between three and five layers of liposomes was 12dB and 
the difference of strength of fundamental response between 
three and five layers of liposomes was about 4dB in our 
experiments. 
In the experiments, we reduce the layers of liposomes 
with the help of a sonicator. Utilizing microscope, it is 
verified that the layers of shells of liposomes could be 
reduced to about 1 layer from 3-5 layers. 
 
According to the experiments in the figure 7, we would 
discover that the second- harmonic response had larger 
difference than fundamental response whether the center 
frequency is 2MHz. The difference of strength of 
second-harmonic response was about 6dB. Similarly, in the 
actual experiments, it was obviously observed that the 
thicker the shells of liposomes, the lower the strength of 
non-linear response. In Figure 7, we could find stronger 
nonlinear response. 
 
 
IV. CONCLUSION  
 
To sum up, it is demonstrated that we could get the 
concentration of liposomes by second harmonic signals 
under different focal pressures. In the meanwhile, it is 
obvious that the shell thickness would affect the signal 
Figure2. The setup of the ultrasound 
1092
Ultrasonic Renal-Stone Tracking with  
Mesh Regularization 
Jenho Tsao and Jia-Hong He 
Dept. of EE. And Inst. of Comm., National Taiwan University, Taipei, Taiwan, ROC 
 
Abstract- The efficacy of Extracorporeal Shock Wave 
Lithotripsy (ESWL) depends greatly on the capability to focus 
shock waves on renal stone. To achieve automatic focusing on 
moving target, the target must be under tracking. A 
mesh-based block matching algorithm is proposed for renal 
stone tracking using ultrasound image sequence. Since 
multiple targets are tracked together, the mesh-based tracking 
algorithm can provide a function of contextual regularization 
for solving the target missing and image degradation problems 
in renal stone tracking. Recorded ultrasound images of kidney 
during ESWL treatment are modified for demonstrating the 
capability of this algorithm. 
 
I. INTRODUCTION 
 
Extracorporeal Shock Wave Lithotripsy (ESWL) is the 
clinical procedure for disintegrating renal stones by shock 
waves from the outside of body [1]. The shock waves must 
be focused onto the stones. However, stones may move 
around during the course of treatment due to respiration, 
patient movement and shock-wave pressure. This will cause 
miss-hit of shock waves on surrounding tissues and cause 
trauma to tissues [2]. Respiratory triggering, general 
anesthesia, and real-time stone tracking [3] are means 
proposed to keep the stones inside the focal zone of shock 
wave. The real-time stone tracking approach was proven to 
be quite effective in reducing miss-hits and thus reduces 
tissue injury and treatment time [3, 4]. 
 
In the renal stone tracking system developed by Orkisz et 
al. [3], ultrasound image sequence are processed to provide 
positions of renal stones for real-time automatic 
shock-wave focusing. A simple block matching algorithm 
[5] is employed for image tracking. Each track is initialized 
manually by the physician and terminated when the cross 
correlation between successive image blocks is lower than a 
threshold. Tracking ultrasound images is difficult due to 
tissue deformation, noisy images, motion ambiguities, 
spatial aliasing, speckle decorrelation, out-of-plane motion, 
speckle motion artifacts and quantization error[6]. These 
artifacts make the target trajectory fluctuate fast, since the 
simple block matching is essentially a speckle tracking 
technique. The out-of-plane motion happens regularly due 
to respiration, which makes target disappear temporarily.  
In addition to these problems,  tracking stone under 
 
This work is supported by the National Science Council, 
Taiwan, ROC. (NSC95-2221-E002-442). 
E-mail: tsaor215@cc.ee.ntu.edu.tw 
fragmentation by ESWL is more challenging. Since after 
fragmentation, stone breaks to be small ones, which makes 
the stone image change all the time and its contrast 
degraded. 
 
A mesh-based algorithm was proposed in [6] to cope with 
the speckle problems in tracking ultrasound image 
sequences. Unlike the simple block matching used in [3], 
which uses a single target block to track the stone, 
mesh-based algorithm uses more blocks to track the motion 
field over entire image plane. The embedded mesh puts a 
systematic control on the displacement estimations of the 
independent image blocks, which is known as mesh 
regularization. 
 
For renal stone tracking problem, the scenario viewed by 
the ultrasound scanner is quite stationary over frames 
separated by 1/30 sec. The pressure caused by respiration 
makes the stone and its surrounding tissues move 
coherently to similar directions. Therefore, if more trackers 
were employed to track the stone and its surrounding tissues 
simultaneously, the mesh regularization scheme, which 
enforces the stone and tissues to move consistently, will 
improves the stability of the trajectory of stone. 
 
It is found in this study that the mesh regularization 
scheme may provide more than motion regularization, it can 
provide contextual regularization also. When stone and 
tissues are tracked simultaneously, the existence of tissues 
(or background targets) will provide contextual information 
to infer the existence of stone (target). It is almost 
impossible that all background targets can disappear 
simultaneously, therefore, if most of the background targets 
were tracked properly, the mesh tracker will work properly, 
even the target disappears for a few frames. That is, the 
target tracker can be regularized by tissue trackers to 
tolerate the nonstationary degradation of target images. This 
helps in the relief of the out-of-plane motion problem and 
the target fragmentation problem. For the same situation, if 
there is only a single target tracker, there would be no way 
to prevent the tracker to switch its track to nearby tissue 
sites. Once a miss tracking happens, the tracker may keep 
wrong forever, even the target comes back latter. 
 
The mesh-based tracking algorithm is given in section II. 
Performances of this algorithm are given in section III. The 
contextual regularization capability is demonstrated by 
simulation studies in section III. 
 
Proceedings of the 29th Annual International
Conference of the IEEE EMBS
Cité Internationale, Lyon, France
August 23-26, 2007.
FrP1B7.3
1-4244-0788-5/07/$20.00 ©2007 IEEE 2187
  
 
 
 
 
 
 
  
 
 
 
 
 
 
 
III. RESULTS 
 
A. Experimental Test 
 
An image sequence recorded during ESWL treatment is 
used for testing the proposed tracking algorithm. It contains 
sixty thousand frames of ultrasound images of a renal stone 
inside pelvis. The size of the stone is about 10 by 30 pixels 
(= 3.75 by 11.25 mm) as shown in Fig.1. This makes the 
choice of element size of mesh to be 11 by 11 pixels, then 
the target will have 3 nodes. To make the target nodes be 
surrounded by a ring of tissue nodes, the mesh must have at 
least 3 by 5 nodes. The image blocks used for displacement 
estimation is given in fig.1 and the mesh model of 15 nodes 
is given in fig.2. The nodes-7, 8 and 9 are target nodes. All 
15 nodes are tracked simultaneously using the proposed 
mesh-based block matching algorithm. The stiffness matrix 
of the mesh is computed by the finite element method. The 
elasticity properties of the mesh model are set with 
Poisson’s ratio = 0.5 and Young’s modulus = 40kPa. The 
search range of block matching is 4± pixels. 
 
The (x,y) positions of node-8 estimated by the mesh- 
based block matching algorithm are recorded as the 
trajectories of the stone, which are shown in Fig. 4 and 6. 
For comparison, the (x,y) trajectories of tracking using the 
simple block matching are shown in fig. 3 and 5. As 
expected, the mesh regulation scheme makes the 
trajectories stable. For example, the marked fast movement 
at frame# 610 in fig.3 has been supressed, which is 
erroneous since it has a speed of 9cm/sec. The two 
x-trajectories has larger difference than the difference of the 
y-trajectories. This is because that the x-axis resolution is 
lower than the y-axis resolution, and the interference from 
the ESWL system is much serious in x direction. 
0 200 400 600 800 1000
160
170
180
190
pi
xe
l
 
 
 
0 200 400 600 800 1000
160
170
180
190
pi
xe
l
 
 
 
0 200 400 600 800 1000
110
115
120
125
130
pi
xe
l
 
 
 
0 200 400 600 800 1000
110
115
120
125
130
pi
xe
l
 
 
 
 
 
 
B. Simulation Study 
 
To test the capability of the mesh regularization scheme, 
the displacement estimator at node 8 is interfered artificially 
by adding zero-mean Gaussian noise to the observed 
displacement
8yd . The artificial interference has a standard 
deviation of 2 pixels and the modified observation is 
truncated to be within the search range of 4±  pixels, when 
the interference is too large. The artificial interference starts 
from frame-300 and ends at frame-500. The interfered 
displacement vector D  is then used for solving the 
regularized displacement estimate CLSU . The modified 
observation 
8yd  is shown in Fig.7. The mesh-regularized 
14 
8 
1 
9 7 
3 4 5 
6 
13 12 11 
10 
15 
2 
Fig. 2 The mesh model used for displacement regularization 
Fig. 1 The image blocks used for displacement estimation, 
the block size is 11 by 11 pixels 
Fig. 3. The x-trajectory of renal stone using simple block matching.
Fig. 4 The x-trajectory of renal stone using mesh regularization. 
Fig. 5 The y-trajectory of renal stone using simple block matching.
Fig. 6 The y-trajectory of renal stone using mesh regularization. 
2189
