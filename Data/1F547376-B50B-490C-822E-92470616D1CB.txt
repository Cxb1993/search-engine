 2
函數轉換為由各方向平面波所疊加的型式。但我們
要注意的是，以這樣展開式，會在 ( )ˆt c′= −k r - ri 時
產生一鬼影訊號（ ghostu ），所以當場源訊號的長度
大於 ( )ˆ c′k r - ri 時，其鬼影訊號就在我們模擬的時
間區間內出現，而造成干擾。為了避免這種現象的
發生，我們將場源訊號分成若干段其長度小於
( )ˆ c′k r - ri 的分段訊號[8]。除此之外我們還可將(2)
式改寫成如下三個階段的形式： 
( ) ( )( )
( )( )
 ( )( ) ( )
2
o oc0 0
oc sc2
scs
ˆr , sin  r r /
ˆ                                 r r /
8
                                    r r / ,
l
t
l
u t d d t c
t c
c
ds t c q t
π πθ θ φ δ
δπ
δ
= − − ∗
−∂ − − ∗
′ ′ ′+ − ∗
∫ ∫
∫
k
k
k r
 i
i
i
      (3) 
而這三階段所代表的意義我們可從圖 1 中瞭
解，我們將場源球的資訊匯集到球的中心點，再將
匯集的資訊傳送到觀察球的球心，最後再把接收到
的訊號發送給觀察球上的每一點。 
 
 
 
圖 1   三階段時域平面波展開法 
 
再者考慮我們所模擬的場源訊號，首先我們假
設其為有限頻寬，如此原本(3)式中的方向積分將可
以用有限個方向數來代替，其計算方向數的公式如
下所示：[9] 
(2 )s s sRK
c
χ ω⎡ ⎤= ⎢ ⎥⎢ ⎥          (4) 
我們由這個公式可以發現，如果我們將場源區
分成若干個場源球，則球半徑 sR 就相對的變小，而
我們所需要的方向數 K 也就隨之變少，以這樣的概
念，如果我們選擇了適當的分組個數，那麼在計算
速度上將可以比使用「柯西荷夫積分公式」直接計
算快速許多。如此，當我們在進行「多區域時域有
限差分法」的計算時，將可以節省許多的計算時間。 
 
4 「多區域時域有限差分法」 
在本篇論文中，其「多區域時域有限差分法」
的計算架構如 圖 2 所示，我們將激發源、散射體
等物體用兩層封閉面包住。並且我們將「時域有限
差分法」的模擬區域劃分為兩部分，內層封閉面以
內所計算的是「總場」，外層封閉面以外所計算的
是「散射場」。當我們要更新「總場」區域時，必
須要知道的總場邊界條件，我們可以由外層封閉面
上的「散射場」加上「入射場」（由「柯西荷夫積
分公式」直接計算或由 「時域平面波展開法」得
知）求得。同樣的，當要更新「散射場」區域時，
必須要知道的散射場邊界條件，我們可以由內層封
閉面上的「總場」扣掉「入射場」求得。如此，我
們就可以計算出外來貢獻與自身激發源其交互影
響的結果。 
 
 
 
 
 
 
 
 
 
 
 
 
圖 2 外層封閉面以外為「總場區域」內層封閉面以
內為「散射場區域」。 
 
對於每個子區域而言為擁有各個獨立的參
數，可以是任意的形狀和擺放角度，並可以選擇各
自適合的網格分割方式與細密程度(如圖 3)，以符
合散射體的細微結構或在 FDTD 的色散條件內。 
 
場源球 觀察球 
內層封閉面 
外層封閉面 
PML 
Source
Scatterers
S1
S2
S3
x
y
z
r-r '
r '
r
旋轉座標 
子區域 1 子區域 2
子區域 3
吸收邊界 
細微構造 
 4
使用單一區域「時域有限差分法」，當網格切
割越細，區域網格數和觀察時間點使得花費的記憶
體和計算時間上呈現巨幅的上升。而旋轉座標下的
「多區域時域有限差分法」，在使用「時域平面波
展開法」的確能夠有效的改善「柯西荷夫積分公式」
在計算上的增加量，且避免掉單一區域「時域有限
差分法」縮小網格時，必須計算大量空白區域。 
 
表 1 計算時間比較 
B.不同網格密度之模擬結果 
我們嘗試在相同環境下，使用單一區域「時域
有限差分法」和「多區域時域有限差分法」兩種方
法模擬激發源與介電物質在
rε =20、30、50 的交互
影響(圖 8)。當模擬的散射體為一介電物質，則網
格尺寸以波源在介電物質中傳遞的最小波長來制
定。當散射體介電常數越大時，相對網格尺寸越
小。介電物質在
rε =20、30、50 下，相對於場源區
網格密度比為 1:2、1:3、1:4(見表二)。 
 
激發源區
sΔ (m)、 tΔ (s) 
激發源區網格數&封閉
面每一分量的計算點數
 
相對介 
電常數 介質區  
sΔ (m)、 tΔ (s) 
介質區網格數&封閉面
上每一分量的計算點數
0.15 、 102.5 10−× 23 23 23× ×  294 rε =20 
0.075、 101.25 10−×  46 46 46× ×  1872 
0.15 、 102.5 10−×  23 23 23× ×  294 rε =30 
0.05、 118.333 10−× 49 49 49× ×  2124 
0.15 、 102.5 10−×  23 23 23× ×  294 rε =50 
0.0375、 116.25 10−× 62 62 62× ×  2976 
表 2 「多區域時域有限差分法」參數設定 
 
 
 
 
 
 
圖 8 不同網格密度下「多區域時域有限差分法」 
 
我們將觀察點置於介電物質內，其
rε 在 20、
30、50 時模擬出的場值，展示於圖 9、圖 10、圖
11 中。電磁波在介電物質中多重反射而有震盪的產
生，此一現象有助於我們觀察在單一區域「時域有
限差分法」，及使用「柯西荷夫積分公式」和「時
域平面波展開法」在「多區域時域有限差分法」下，     
準確度的比較。 
 
圖 9 介電物質
rε =20 時，兩區域網格比為 1:2
情況下的模擬結果。 
 
 
圖 10 介電物質
rε =30 時，兩區域網格比為 1:3
情況下的模擬結果。 
 
  
觀 察 時
間點 
計 算 時
間(秒) 
記 憶 體
(MB) 
KIF 605 12781 54 「多區域時域
有限差分法」 PWTD 605 4081 136 
FDTD(1:1) 605 1098 53 
FDTD(1:2) 1210 8945 190 
單一區域「時
域 有 限 差 分
法」 FDTD(1:3) 1815 34591 455 
KIF 
PWTD 
Ez 
(V/m)
Ez 
(V/m)
Time Steps 
Time Steps 
