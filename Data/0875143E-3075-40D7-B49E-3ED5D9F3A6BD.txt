圖一： ToA 演算法測距計算示意圖 線調整，或者是對使用者所在位置做適當的溫
度調整。  
 2
( ) ( )( )3 2 1 0 *Distance * RF ultrasonic
RF ultrasonic
V VT T T T
V V
⎛ ⎞= − − − ⎜ ⎟−⎝ ⎠
Transmiter
Receiver
T0
T3
T1
T2
RF Ultrasonic Distance
本研究建構了一個以無線感測器為主的室
內定位系統，利用所接收的使用者身上配戴的
無 線 感 測 器 所 發 出 的 訊 號 接 收 強 度 值
(Received Signal Strength)，透過所設計的演算
法，估算使用者所在的位置。 
 
4. 相關研究 
 
本節將介紹幾個常用於定位技術的距離量
測方法，包含 Time of Arrival(TOA)[4]、Time 
Difference of Arrival(TDOA)[5] 、 Angle of 
Arrival(AOA)[6]、RSSI[7]以及與本研究相關的
RADAR[1]、Probability(Bayesian Classification) 
[2][3]定位技術。 
 
4.1 Time of Arrival （TOA） 
4.2 TDOA 
 
TDOA 與 TOA 是十分相似的測距技術，不
同之處在於，TDOA[7]主要是依據兩種不同的
傳輸媒介，如無線電訊號與超音波訊號，以兩
個訊號由發送端到接收端，利用其不同的傳輸
速度所造成的時間差，來計算兩端點的距離，
如圖二所示。知名的 Cricket [5]定位系統即是
利用 TDOA 測距技術。 
 
TOA 是個常見的距離量測方法，主要是
在已知訊號傳播速度時，可以利用兩個端點之
間訊號的傳遞時間來估計端點之間的距離，如
圖ㄧ。  圖二： TDoA 演算法測距計算示意圖 
著名的 GPS 定位系統即是屬於運用 TOA
技術的定位方法，GPS 訊號接收器接收人造衛
星的訊號，並且以訊號傳送時間與訊號傳播速
度的乘積來計算 GPS 接收器與人造衛星的距
離，當 GPS 訊號接收器同時收到三個以上不同
位置的人造衛星訊號時，則可以透過每顆衛星
的所在位置及每顆衛星至接收器之間的距
離，來計算 GPS 接收器的所在位置。但是由
於：（1）GPS 需滿足視距(Line-of-Sight)要求，
所以必須在室外使用；(2) GPS 需要精確的時
間同步機制加以輔助來達到高的定位精確
度，所以接收器必須與人造衛星時間同步，行
動裝置（例如感測器）通常不易達成此條件；
(3) GPS 訊號接收器耗費電力且較昂貴。基於
上述原因，所以 GPS 定位的方式不適用於感測
器網路。 
 
4.3 RSSI  
 
RSSI[7]定位技術主要是利用無線電波訊
號傳播隨著距離而減弱的特性，計算兩端點之
間的距離。接收端利用如下的訊號衰減模型
[15]，計算距離。 
( ) ( )0
0
10 dPL d PL d log X
d ρ
⎛ ⎞= + α +⎜ ⎟⎝ ⎠  
PL( ) 代表與距離相關的訊號衰減函式；d
代表傳送端與接收端之間的距離；d0 為一個相
當接近傳送端的參考距離；α 代表一個衰減係
數，通常介於 2 到 6 之間；Xρ 代表一個以 ρ
為標準差，0 為平均值高斯分佈隨機變數
（Zero-mean Gaussian random variable ），用來
表示訊號強度隨著距離而衰減的速度；因此在
知道傳送端用來傳送訊號的強度下，可以估算
出訊號的衰減程度，因為衰減程度與訊號所經
過的距離有關，所以藉由方程式，可以估算出
傳送端與接收端的距離。但是因為訊號強度易
受干擾而不穩定，所估算的距離與實際距離，
會有誤差。 
 
Transmitter
Receiver
T0 T3
T1 T2
RF RF
Distance
 
4.4 RADAR 
 
RADAR[1] 是 Microsoft 研究人員所發展
出一套定位技術，此技術是利用訊號強度比對
來達到定位目的方法，屬於樣本比對 (pattern 
matching)定位方式[8]的代表性方法，通常應用
( ) ( )( )3 0 2 1 *Distance
2
RFT T T T V− − −=  
圖四：訊號強度分佈圖 由於訊號強度的收集需要耗費一定的時
間，所以我們從中觀察，隨著時間的改變，訊
號強度可能產生的改變[9][12][14]。研究使用
的 感 測 器 是 由 Crossbow 生 產 的
MPR2400CA ，是 IEEE802.15.4/ZigBee 協定的
Mote 模組，使用 2.4 - 2.4835 GHz 全球通用的
ISM 波段，容易與 IEEE 802.11b WLAN，藍牙
裝置，室內無線電話機及其它使用相同頻率的
裝置產生干擾，並且容易受反射、折射、衍射，
以及被建築物或人體所吸收而影響訊號強
度，另外訊號強度在不同的時段也可能由於一
些時間相關的現象而產生變化[12]，這些現象
包括環境中人們的移動，開門與關門的動作，
該時段裡建築物中的人口密度，其他電子設備
傳送訊號的干擾…等情況。這些情境的改變都
可能對導致訊號強度的分佈，隨著時間而產生
偏移，使得非即時收集訊號強度作成的 Radio 
Map 在定位時產生失效的情況。 
（3:00 p.m. 至 7：00 p.m.） 
 
5.2  Region Point 定位方法 
 
在這部份，我們將介紹 Region Point 定位
系統架構，及如何建立訊號強度的傳播範圍距
離表，還有為了因應不同時段，環境產生訊號
強度分佈的改變，所設計的 Index Point 的選擇
機制。 
 
5.2.1 Region Point 定位方法架構 
 
圖五為 Region Point 定位系統架構，主要分為
離線訓練階段及定位階段兩大部分。 
 
離線訓練階段主要的工作有： 
 
1.依不同時段，在選定的位置上做訊號強
度資料的收集。 圖三與圖四是一個因為環境改變而導致
的訊號強度偏移的例子，為了可以看出訊號強
度隨著不同時段而產生的變化，我們選定了一
個特定的位置，對於固定感測器收集在不同時
段的訊號強度畫成直條圖，為了建立此直條
圖，我們在 4 小時內收集了 500 個 RSS 樣本，
我們可以清楚地觀察到這些分佈，發現訊號強
度隨著時段的不同而有明顯的變化。這個觀察
結果的重要性是，在離線階段所收集的訊號強
度分佈圖（Radio Map），可能與在預測階段的
真正 Radio Map 不同，因此造成嚴重的預測誤
差，如何解決此一問題，是一個極富挑戰性的
工作[14]。 
2.以訊號強度樣本資料庫建立所需的
Radio Map。 
3. 建立訊號強度的傳播範圍距離表
（Min-Max-dist）。 
4.選擇最受時間變異影響的位置作為
Index Point。 
 
定位階段主要的工作有： 
 
1.在 Index Point 位置做短時間的訊號強度
收集。 
2.依照 Index Point 收集的訊號強度選擇合
適的 Radio Map。 
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
0.45
-30 -18 -17 -15 -14 -13 -12 -11 -10 -9
訊號強度 (dBm)
機
率
 4
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
0.45
0.5
-15 -14 -13 -12 -11 -10 -9 -8 -7
訊號強度 (dBm)
機
率
圖三：訊號強度分佈圖 
（10:00 a.m. 至 2：00 p.m.） 
圖五： Region Point 定位方法架構圖 
1.Radio Map
2.Min-Max-Dist
3.Index Point 
Fingerprint
Localization
Algorithm
Location
Define the range of 
Localization
Training Data
T*
Real Time DataReal Time Data
Off-Line Training Phase On-line Positioning Phase
Wireless Sensor Network
Index Point
 T1
T2
O = (ss1,ss2,…,ssk)
Tx
 在離線訓練階段時，首先會選定不同的時
段進行訊號強度資料收集。收集方法為，在無
線感測網路所在的區域內選定數個位置作為
訓練點 L = { l1 ,l2 ,… ,ln }，其中每個位置 li
皆包含 x 及 y 軸的座標 li = ( xi，yi )。其訊號
傳播如圖七所示，讓無線感測器( u )在各個訓
練點持續的傳送封包給其它無線感測器( m )，
當其它無線感測器(m)收到由 u 所發送的封包
之後，取出此封包的接收訊號強度(RSS)值。並
且將此訊號強度資訊加入到封包之中，然後等
待一固定時間間隔，將封包轉送出去；而連接
電腦的無線感測器( c )收到這些封包後，會將
該訓練點的座標及收到的訊號強度組 o = 
(ss1 ,ss2 , … ,ssk ) (每個訊號強度組 o 皆包含有
k個來自不同無線感測器所接收到的訊號強度)
存入樣本資料庫內，如圖六所示，以利後續估
計使用者位置的依據。接著再依定位演算法所
需，建立 Radio Map。 
li 第 i 個訓練點位置 
ssi,r 在 li位置出現的訊號強度 ssi,r 
fr(ssi,r ) ssi,r在位置 li出現的頻率 
mi 位置 li收集的樣本數 
n 訓練點的個數 
 
 
 
 
 
 
 
 
 
 
 
 
公式一：計算訊號強度值在某位置的權重值 
 
從公式一可以看出，假設某訊號強度在某
位置的出現機率越高，並且此訊號強度在各位
置的分佈越不平均，則此訊號強度在此位置的
權重值會相對較高，表示此訊號強度值為此位
置所特有的（別的位置比較不會有），即為此
位置的特徵訊號強度值。所以由公式我們可以
得到每個位置代表的特徵訊號強度向量 Vi 以
及其向量元素的權重值。 
 6
 
M
C
M
M
M
M
M
M
M
M
M
P
Legend:
P: Electronic Podium
M: Mica Mote
C: Localization Computer
      :     Door
U
接下來，我們針對每一個感測器所收過不
同的訊號強度（例如，ss1= -33），藉由曾經在
哪些訓練位置記錄到此訊號強度的資訊，計算
得到該訊號強度傳播的範圍，即此感測器以這
個訊號強度，所傳過的最近及最遠的傳播半
徑，如圖八所示， 
圖七：本研究所處環境的訊號傳播示意圖 
 
依本研究的權重特徵比對(Fingerprint)演
算法，我們需要建立各訓練點位置 li 的特徵訊
號強度向量 Vi = ( f1 ,f2 ,… ,fk )來完成後續定
位階段所需的 Radio Map。作法為：首先以權
重值計算公式，如公式一所示，算出每個位置
所收到的各個訊號強度 ssr ,r = 1…k 的權重值
w(li,ssi,r)，並取權重值最高者為該位置特徵訊
號強度向量的元素 fr ,r = 1,…,k 
 
圖八：紀錄某一電波強度被收集過的最近及最
遠距離點示意圖 
  
( ) ( )
( ) ( ) ( )( )
( )
,
, ,
, ,
1
,
,
,
1
( )
, *
11 * log
log
( )
( )
i r
i i r i r
i
n
i r j r j r
j
j r
j r n
z r
z
fr ss
w l ss f ss
m
f ss p ss p ss
k
fr ss
p ss
fr ss
=
=
=
−= −
=
∑
∑
,
 
圖中表示 Mote 1 曾經收集到訊號強度-33dbm
的各個訓練點的位置如紅色點所示；則由這些
點，可以算出該訊號強度（-33dbm），所傳播
的最近及最遠距離(min-max)。依此，可以將每
個 Mote 所收過的訊號強度，建立訊號強度傳
播範圍距離表（圖六）。 
最後，利用不同時段 T= { t1,t2,…,tn }收集
的訊號強度的樣本資料庫(Radio Map)，建立 
為：首先，以隨機選取 320 個位置擷取其訊號
強度值，利用權重特徵比對定位方法，估計目
標位置，藉由實驗結果分析使用不同特徵訊號
強度向量的元素個數作計算，對於定位準確率
的影響，如下圖十一所示，為使用權重值排序
後，前 5、7、9、10 個元素作權重特徵比對的
實驗結果， 
 8
比
 
圖十一可以看出，隨著使用比對元素的個數
們將以實驗分析 Index Point 的
選擇
資
 在定位階段的測試開始前，先在 Index 
oint
圖十一：特徵訊號強度向量比對的元素個數
較 
從
增加，累計距離誤差能夠有效的減少，當元素
比對個數超過 9 個時，所能提昇的定位準確度
就相當有限了，所以在接下來的實驗，在進行
權重特徵比對演算法時，我們將使用權重排序
前 9 個訊號強度向量的元素，來計算與定位目
標的訊號強度之間平方距離，達到準確的目標
位置估計。 
接下來我
機制是否能夠有效的幫助定位階段選擇
一個合適的 Radio Map？實驗的設計為：首
先，我們先在三個不同的時間收集訊號強度
料並建成三份 Radio Map，R1、R2、R3 然後
以 Index Point 的離線階段處理機制，分析這三
份 Radio Map 的訊號強度差異最大的位置 li 
[座標（14,13）訊號強度差異值約 129.308]，如
圖十二所示， 
圖十二： Index Point 的選擇機制實作圖 
 
P 位置 li 上收集五筆訊號強度資料，取其平
均當作測試樣本，分析 R1、R2、R3 何者為接
下來定位測試最適合的 Radio Map，以實驗測
試，Index Point 的選擇機制選擇了 R3（訊號強
度差異值最小，值 50.236）為最佳的 Radio 
Map，接下來圖十三、圖十四與圖十五實驗以
隨機選取 320 個位置擷取其訊號強度值以這三
份 Radio Map 分別利用以機率為基礎的定位方
法、RADAR( 3 Nearest Neighbors )以及套用訊
號強度傳播範圍距離表改進的 ReRADAR 及
ReProbability 還有本研究所使用的權重特徵比
對方法（取權重值排序前 9 個做比對）的實驗
結果。 
600
0
100
200
300
400
500
1 32 64 96 128 160 192 224 256 288 320
次數
累
計
距
離
誤
差
 （
m）
0
100
200
300
400
500
600
700
800
900
1 32 64 96 128 160 192 224 256 288 320
次數
累
計
距
離
誤
差
 （
m）
Probability
ReProbability
RADAR (3)
ReRADAR
RegionPoint (9)
RegionPoint (5)
RegionPoint (7)
RegionPoint (9)
RegionPoint (10)
 
圖十三： 各定位演算使用 Radio Map  R1 的
累計距離誤差 
0
100
200
300
400
500
600
700
800
900
1 32 64 96 128 160 192 224 256 288 320
次數
累
計
距
離
誤
差
 （
m）
Probability
ReProbability
RADAR (3)
ReRADAR
RegionPoint (9)
 
圖十四：各定位演算使用 Radio Map  R2 的累
計距離誤差 
0
100
200
300
400
500
600
700
800
1 32 64 96 128 160 192 224 256 288 320
次數
累
計
距
離
誤
差
 （
m）
Probability
ReProbability
RADAR (3)
ReRADAR
RegionPoint (9)
 
圖十五：各定位演算使用 Radio Map  R3 的累
 
實驗結果看出，本研究的權重特徵比對方
計距離誤差 
從
法，利用 Radio Map R1 的定位平均誤差距離為
0.681 公尺，利用 Radio Map R2 的定位平均誤
差距離為 0.958 公尺，利用 Radio Map R3 的定
位平均誤差距離為 0.556 公尺，表示 Index Point
的選擇機制選擇的 Radio Map R3 確實能提供
系統良好的定位準確度。 
 10
計達成目標狀況 
標，都能有效地達
成
究成果的學術或應用價值 
(4 合在期刊上發表 
於好的期刊
(5 ，可以推廣使
符。 
(2) 預
本計畫所提之研究目
。 
(3) 研
本研究初步結果，發表在 WASN 2008 
[16]。 
) 是否適
本研究的成果有希望發表
上，正在努力整理中。 
) 本研究成果具有實用性
用。 
 
