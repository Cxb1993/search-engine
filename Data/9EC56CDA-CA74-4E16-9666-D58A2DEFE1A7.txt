2mathematical programming tools and experiment their efficiency. It is expected that the research will provide the
industry with an effective MO planning solution.
Keywords：TFT-LCD Optronics industry, manufacture orders planning, sequencing, mathematical programming,
synchronized output
1. 研究背景與目的
台灣 TFT-LCD 產業由於在半導體製造技術、人才的優勢，以及與上下游綿密的整合，近年快速成長，
成為繼半導體後的關鍵產業。TFT-LCD 產業屬於高度技術與資本密集的產業，因此需要提高產能利用以
有效攤銷成本，但是面對快速變動的需求，存貨的組合控制也格外重要，圖 1 為台灣液晶顯示器產業的
供應鏈：由上游玻璃基板、彩色濾光片、偏光板、導電玻璃、驅動 IC、背光模組、配向膜等廠商生產供
應原物料組件[26]，TFT-LCD 主要製造廠商如：華映、友達、奇美、瀚宇、廣輝、與群創等，將組件加
工和組裝成液晶面板，最後供給下游筆記型電腦廠商或 LCD 監視器廠商。
玻璃基板
康寧、 鉅晶、中晶、
碧悠、發殷、
台灣科技玻璃
華邦、聯詠、
凌陽、茂矽、
漢磊 …….
驅動IC
彩色濾光片
南亞、奇美、和鑫、
劍度、展茂、勝華、
世界巔峰、昌益、
宏東洋、 華新
力特、協臻、
汎納克、日東電工
偏光板
默克光電、劍度、
錸德、勝華 …….
ITO 玻璃
大立高分子
配向膜
中強光電、大億、
瑞儀、輔祥、福華
、大安、慧炬、康峻
、和立聯合、興隆發
背光模組
冷陰極螢光燈管
威立盟
TFT-LCD 華映、友達、奇美、瀚宇、廣輝、群創
筆記型電腦
廣達、仁寶、
緯創(宏電)、英業達、
華宇、大眾
LCD監視器
瑞軒、中光電、源興、
美齊、仁寶、明碁、
新寶、光威
圖 1 台灣液晶顯示器產業上下游供應鏈
液晶顯示器產業整個供應鏈錯綜複雜，其中 TFT-LCD 面板的生產集中在五家主要製造廠商，隨著五
代廠的量產，高資本的投資不外希望儘早達成規模經濟，加速量產攤銷固定成本，降低售價提升市佔率，
因此滿足顧客需求的同時，產能利用率是各廠商追求的目標。TFT-LCD 廠因為建廠時間與製造技術不同，
各世代廠分散其中，整個產業的多廠區環境和製程如圖 2 所示，製程可分為三段：前段為生產薄膜電晶
體（Thin Film Transistor；TFT）的陣列（Array）製程，與自製或採購所得之彩色濾光片（Color Filter）
經過中段組立（Cell）製程完成液晶面板（Liquid Crystal Display；LCD），最後由後段模組（Module）組
立製程將 LCD 面板與其它零組件（偏光板、驅動 IC、背光模組）組合成成品。
TFT
Manufacturer
LCD
Manufacturer
LCM
Manufacturer Distributor
Retailer
Supplier Retailer
Retailer
DistributorLCMManufacturer
TFT
Manufacturer
LCD
Manufacturer
TFT
Manufacturer
LCD
Manufacturer
Supplier Supplier
Business EntityLegend： Inventory Stockpile Material Flow
Array Process Cell Process Module Process
TFT-LCD Multiple Site
圖 2 TFT-LCD上下游供應鏈
4前段製程主要解決 TFT 與 CF 的貼合問題，為避免兩半成品缺一而同時造成存貨與缺貨成本；因此，其
目標函數定義為尋求完工時間與閒置時間最小化。
謝[32]將 TFT-LCD 產業的生產規劃流程分為四個階段：(1)需求規劃；(2)供給規劃；(3)產能平衡規
劃；(4)績效分析階段。需求規劃是由業務部門根據訂單及銷售預測等資料提出最終產品的淨需求，生產
規劃則依據需求規劃的結果及各製程的在製品和庫存，計算各製程的淨投入量。此時求得的淨投入量並
未考量現場的產能，因此需要修正衡量現場所有資源的產能負荷及相關限制，同時平衡 TFT-LCD 廠內各
製程的供給與需求，以產生可行的生產計劃。謝[32]探討 I 型(不包含彩色濾光片製程)與 Y 型(包含彩色濾
光片製程)兩種生產模式的規畫：I 型生產將彩色濾光片視為採購件，設定為軟性限制(soft constraint)，Array
則設定為必要物料(hard constraint)，規劃時由最終 LCM 的需求、規劃期間各月份變動的良率、與「標準
製造週期時間」倒推(pull) Array 與 Cell 的淨需求，並建議 release 時間，根據所建議之投料時間再以前推
方式(push)規劃 Array 與 Cell 生產時程，其中 Cell 開工的時間即為 CF 需購入的「進料時程」。
黃[27]指出物料需求規劃乃以主生產排程為主要輸入，考量產品結構、存貨狀態及產能情況，規劃
出為完成某成品之主生產排程(Master Production Scheduling，MPS)所需各需組件之預定生產排程或採購計
劃。一般 APS 系統均於存貨配置後將不足的需求開立製令，但由於其製令規劃僅在滿足供需關係下，算
出適當的投料時間，為避免延遲，其投入時間往往需要提早，其主要困難在於無法在考慮產能限制下決
定適當的訂單投料時間與數量。TFT-LCD 面板製程中，陣列(Array)製程類似半導體產業，組立(Cell)製程
具光電產業特性，模組(Module)組裝製程與一般組裝產業特性相近，各製程的生產目標皆不相同，規劃時
必須同時滿足各段不同的目標，為達成各製程的生產目標，在供給規劃階段，必需各自開立各製程的製
令，再以存貨滿足下游的需求。
黃[27]針對 TFT-LCD 產業多廠區訂單規劃與排程，不使用傳統集中式數學劃的訂單分配，而是讓
各廠在考量限制產能下，主動選擇訂單以爭取績效最佳化，但未將 CF 與 TFT 產出的同步化納入考量。
Lin[11]針對 IC 設計公司需求規劃中以線性規劃模式來處理 IC 產品分級的特性；在供給規劃中應用
Hackman 的一般化模式，結合 IC 設計的生產排程展開特性，建構混合型整數規劃模型(Mixed-Integer Linear
Programming，MILP)以處理多代工廠的整合生產分派與排程。
賴與黃[31]以規劃中心代理人作為供應鏈網路中的企業實體，以區域廠區代理人作為企業內的生產單
位，並結合 i2 Technologies Inc.之 Factory Planner 構成一個整合性多階多廠區生產規劃系統，設計出整合
性訂單確認機制，並應用於 TFT-LCD 產業，藉此驗證系統於多階多廠區生產環境之可行性。
林與陳[21]利用多廠概念模式、產品結構、生產策略、生產製程與能力、考量限制以及績效指標六個
維度，將多廠規劃與排程問題進行分析與分類。並以 TFT-LCD 面板產業前段列陣廠與組立廠組成之多廠
生產環境為例，探討推式多廠規劃與排程(Push-Based Multi-Site Planning and Scheduling)問題，針對存貨
式生產(MTS)環境下，提出一套結合參數化訂單分配法則以及 CBS(Constraint-based Simulation)之排程方
法，並進行模擬分析，由分析結果得知所提出的方法優於 TFT-LCD 面板產業常用的規劃與排程。
鄭與吳[30]探討 TFT-LCD 製程中模組組裝作業的生產排程問題，提出一以限制為基礎之基因演算法
(CBGA)，同時考慮客戶指定用料及產能限制，藉由基因演算法的多點平行搜尋能力進行產能與物料的同
步規劃。並以實驗方式，與前推/最早到期先排程(FS/EDD)及後推/最晚到期先排程(BS/LDD)兩種派工法
則比較，評估績效指標包含最小提前完工、最小延遲、最大完工時間最小化與最小平均流程時間。實驗
結果顯現本文所提之以限制為基礎之基因演算法所得之排程績效，明顯優於以 EDD 或 LDD 之啟發式求
解法。
王與吳[17]針對製令規劃、生產排程規劃、訂單需求滿足規劃及績效分析指標四個階段，提出適合於
6與限制為現場 PC 人員規劃機台派工。本研究的主要重點在(A)與(B)階段— 為 Array、CF、與 Cell 三廠
平衡供給與需求，開立製令，建議製令開始與完成時間，並僅可能相互配合同步化；同時亦將探討製令
規劃與排程系統的銜接。
3.1.2 Cell與 Array製令規劃數學模式之建構
為說明 Cell 製令之數學規劃，以下我們將使用供給與
需求矩陣，如圖 5 所示。圖中各矩陣的首列為需求或供給
日期，第一欄為 Cell 各尺寸品項，矩陣中間的方格為特定
品項在該日期的需求或供給量，各矩陣最右欄著色的小方
格則為各品項在規劃期間的總需求或總供給量。在「Cell
Demand」階段，需求矩陣來自實際訂單數量、預測需求量
及產能填補單的彙整。在扣除期初存貨(Inventory)及在製品
數量(WIP)預計產出計算出「Cell Net Demand」矩陣。右圖
中，「Cell Net Demand」矩方格中的數字 1000 表示當日的
Cell 段組立面板需求為 1000 單位，因此當日應有 1000 單位的產出以滿足此需求，在製造週期時間及產
能等限制下，我們將以數學規劃求解「Cell Supply」矩陣，規劃後 supply 矩陣中有兩個投入量均為 500
單位，表示該品項 1000 單位的品項需求，經製造週期時間及投片限制考量，需在交期三天及四天前各投
入 500 單位生產。
Cell製令之數學規劃模型如圖6所示，以下定義所使用的係數與決策變數：
1. 下標定義：
i ：第 i 種尺寸或品項
t ：日期
2. 係數與常數定義：
,i tD ：品項 i 在第 t 日的確認訂單需求量，單位：片（panel）。
,i tS ：累積可用量，若為正數表示 t 日品項 i 的可用數量，若為負數則表示品項 i 到該日為止累計缺少
的數量，單位：片（panel）。
,i tC ：第 t 日品項 i 的投片上限，單位：片（panel）。
CT ：每日各品項的總投片上限，單位：片（panel）。
tU ：第 t 日可生產品項種類數限制。
WE ：單位 panel 每提早一日完工的懲罰權重。
WD ：單位 panel 每延遲一日完工的懲罰權重。
,i tR ：設定各品項在各工作月份或日期的良率（Yield Rate），品項在各製程作業的良率，依照量產階
段而不同，因此是隨時間變動的。 ,i tR 為品項 i 第 t 日的良率，0≦ ,i tR ≦1。
iL ：製造週期時間，品項 i 在「不超出產能」限制下的平均製造週期時間，各品項根據此時間從投入
往後推估算完成日期。雖然製造週期會隨著現場實際作業時間的長短而變動，但在不超出負荷
限制下可從投入到產出的平均時間估計合理的製造週期，單位為天。
,i tP ：品項 i 在第 t 日的預測需求量。需求預測包含品項、數量與預測需求日等資訊，單位：片（panel）。
iIS ：期初存貨，品項 i 期初的 bank 庫存數量，單位：片（panel）。
,i jWIP ：期初品項 i 的在製品數量預計在第 t 日產出數量，單位：片（panel）。
圖 5 Cell 製令規劃
8,i t
i
X CT t  (3)
式(3)限制「每天」各品項數的總投入量不可超過日產能限制CT ，確保各品項的組合投入不超出總
產能，此限制可避免現場 WIP 堆積造成週期時間拉長，一方面也確保投料計畫在現場執行的可行性。使
用 MRP 或改良式 MRP 為基礎之製令規劃由於無限產能的假設，導致無論使用標準或理想製造週期時間
都將無法準確推估產出時間，式(13)的納入可解決此困擾。
, , , , , 1 , , ,i i i i ii t L i t i t i t L i t L i t L i t LS X R WIP S D P i t            (4)
式(4)計算每日各品項累積可用量，為當日預計產出量，加上期初在製品預計在「當日」之產出及前
一日的累積可用量 S ，減去當日訂單需求量及預測需求量。當日預計產出量為製造週期 L 天前之投入量
乘上良率 R ，因模型已限制投入不可超過產能負荷，因此可以使用製造週期推估合理產出時間。
,
,
,
1 if 0
,
0 if 0
i t
i t
i t
X
V i t
X
  
(5)
式(5)中之布林變數表示品項 i 在 t 日是否投片，若投入量 X 大於 0 則V 為 1，若投入數量為 0，則V
為 0。
, , , ,i t i t i tX C V i t   (6)
式(6)表示品項 i 在 t 日若投片，則其投片量不可超過該品項單日投片上限，此限制目的在控制各品項
日投入不超出產能或工具負荷，有助於品項組合之初步控制。
,i t t
i
V U t  (7)
式(7)限制每日投片品項種類的上限，此為現場作業一項重要限制，品項種類數若過多則勢必頻繁換
線，不僅損失產能，也加重作業人員的負荷，光電廠業之現場 PC 人員甚至以此評估排程的「品質」或可
行性。
, , , , ,, , , , , , , , , 0;i t i t i t i t t i t i tX S D P L WIP IS U WE WD (8)
式(8)為非負限制式。
 , , , , , 0 0, , , , , , , | 0i t i i t i t i t i t tWIP IS S D P CT C U x x       (9)
式(9)限制各決策變數為正整數。
以上數學規劃模型將用以求解 Cell 每日建議投片種類與數量，亦即求解 Cell 之供給計畫(supply
plan)，此供給計畫將轉換為上游 Array 與 CF 的需求，如圖 7 所示：
圖 7 Array 與 CF 製令規劃
Array 之製令規劃需彙整來自 Cell 的需求、預測需求及產能填補以計算需求矩陣，扣除期初存貨及
10
最後加上懲罰值對費洛蒙的影響，其中 Zbest 為目前最小的懲罰值，QA 為每隻螞蟻所擁有的費洛蒙量。
jjs ),( = jjs ),( + )( bestZ
QA
, nj ...1
式中 s(j)表在這次迭代的解集合中 j 的下一生產製令。QA 值為可用於調整新路徑的懲罰值對原始費
洛蒙的影響。如果 QA 值偏大，每隻螞蟻所走過的路都會有明顯的影響，QA 值太小螞蟻走過的路徑影響
也就相對減弱。
圖 8 啟發式蟻群演算法 [29]
4. 實驗設計
4.1 實驗因子
1 規劃週期：規劃週期為規劃時程之長短，本研究考慮三種的規劃週期，分別為：30 天、60 天、及
90 天，以便比較在短、中、長規劃週期的求解速度與品質。
2. 產能緊縮率：光電產業具有明顯的景氣與季節循環，因此本研究考慮在不同市場需求強度下的求
解敏感性，我們分別實驗以下三種產能緊縮率：需求為產能的90%(代表淡季或供過於求)、需求與
產能相同(代表供需平衡)、及需求為產能的105%(代表旺季)。
12
4.3 Array製令規劃實驗結果 [22]
表二 三種最佳化工具求解達交率比較
4.3彩色濾光片製令規劃實驗結果 [29]
表三 三種最佳化工具求解達交率比較
