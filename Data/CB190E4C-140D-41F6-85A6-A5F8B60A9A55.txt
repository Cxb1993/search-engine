供電的品質。 
     但是往往因為經濟的考量，無法將配
電自動化系統涵蓋整個用電區域，因此，
往往家裡突然停電需要用戶打電話告知電
力公司，電力公司才會派人員來處理。但
是如果遇到一些天然災害如雷擊、水災、
颱風等，造成電力設備斷電，如果有線電
話系統故障時，將無法通知電力公司的人
員來修復，若用戶為 IC 製造廠，則損失更
加嚴重。 
 
II. 研究方法 
本研究採用 GSM 行動通訊數據回報
系統，首先在用戶低壓分歧點上裝設供電
故障偵測器，此裝置偵測到供電事故訊號
後，利用 GSM 行動通訊數據回報系統，自
動將供電事故訊息回報監控中心，即時的
將供電事故訊息收集，使電力公司監控中
心的調度人員，在用戶發生事故的時候，
在最短的時間內能獲得最新且最詳實的資
料，對於停電區域與復電調度的進行有幫
助，能縮短停電時間，減輕停電所造成的
損失。為滿足用戶的需求，減少停電損失、
未來自動化、資訊化與環境保護是社會發
展趨勢，供電事故資訊的回報收集必需是
即時的，本研究研製一套擁有偵測供電事
故、通訊及故障顯示的雛型系統，可作為
電力公司進行供電事故自動回報設備之參
考。GSM 即時監控系統架構如圖 1。 
 
 
圖 1 GSM 即時監控系統架構。 
 
III. 硬體規劃與軟體設計 
用戶端事故偵測電路於啟動後需完成
以下的工作：將 89C52 的 I/O 埠作設定、
對中斷暫存器設定、計時器的啟動、及類
比數位轉換器的啟動，然後用戶端偵測電
路將進入以下的偵測狀態：「停電」、「復
電」、「過電壓」、「低電壓」、「頻率
過高」、「頻率過低」及「用電度數」。
監控端系統在啟動時會對 GSM 模組進行鮑
率的設定、並讀取簡訊的設定，使 PC 可以
對週邊設備做控制或資料存取。用戶端及
監控端程序簡單說明如下： 
 
1.用戶端程序 
(1).停電情況 
利用電壓轉數位的電路將電壓轉換成
數位值，利用 89C52 微處理器判斷是否「電
壓少於 10V」，如果發生停電會利用微處
理器產生傳簡訊的字串，在監控端會收到
一封『power outage』內容的簡訊，透過簡
訊的電話號碼利用 VB 程式建構畫面及資
料庫，並在監控端顯示復電資訊、電話號
碼，並顯示在地圖上，並且同時將此筆資
料存放在停電用戶資料庫裡，以便監控人
員查詢。 
(2).復電情況 
若微處理器接收到的數位值，判斷為
一般市電的「電壓 110V」時，將傳送『power 
repair』的簡訊到監控端，監控端收到簡訊
時將相關資訊顯示在監控端的電腦螢幕
上，得知復電位置所在。 
(3).過電壓或低電壓情況 
過電壓或低電壓的偵測程序與停電和
復電情況大致相同。當微處理器接受到電
壓的數位資料時，判斷是過電壓或低電壓
狀況。當「電壓超過 120V」時，如果當時
電壓為 128V，將傳送『high voltage 128V』
的簡訊告知監控端，讓監控端得知當時的
電壓狀況。當「電壓低於 100V」時如 98V，
將傳送『low voltage 98V』的簡訊給監控
端，監控人員透過 VB 的監視系統得知事
故狀況。 
 
(4).頻率過高或頻率過低情況 
利用運算放大器(Operational Amplifier)
 2
 
 (3).類比轉數位電路 
如圖2 C所示，主要由ADC0804和
89C52所構成的，我們是利用軟體詢問的方
式來當作工作模式，ADC的數位資料送至
89C52的埠1，由89C52讓WR接腳產生低電
位的脈波告訴ADC開始進行電壓訊號的轉
換，並等待INTR降為低電位即電壓訊號轉
換完畢，再由89C52讓RD接腳送出低電位
訊號以讀取數位資料，再等RD訊號回升高
電壓時，將INTR訊號設定回高電壓狀態，
再繼續讀取電壓和電流值。 
 (4). RS232傳輸介面電路 
此電路如圖2 D所示，是由89C52和
RS232公接頭所組成，我們所利用的MC35 
GSM模組是用RS-232作為傳輸介面，因為
RS-232的電壓準位是+12V代表邏輯1，
-12V代表邏輯0。89C52主要是透過TXD、
RXD這兩支接腳來與模組溝通，89C52的
UART是透過TXD腳將串列資料送到外
面，透過RXD腳接收外面送進來的串列訊
號，TXD跟RXD的電壓訊號是TTL準位訊
號，即輸出0時為GND電位，輸出1時為
+5V。因此89C52的UART要與RS-232傳輸
端溝通時，必須將UART的TTL電壓準位轉
換成RS-232電壓準位才能互相連接。 
 
 
圖 2 用戶端偵測用電事故電路圖。 
 
3.軟體架構及功能 
整個系統的軟體架構包括89C52組合
語言，和GSM模組AT Command指令應
用，在電路偵測到停電、復電、過電壓/低
電壓、頻率過高 /頻率過低時，利用AT 
Command指令傳送字串，來控制GSM模組
傳送相對應的簡訊內容。 
圖 3 為用戶端事故偵測流程圖，首先
設定傳送的鮑率，使 89C52 與 GSM 模組
順利溝通，MCS-51 系列的單晶片提供串列
通訊埠功能，串列通訊埠的優點是使用較
少傳輸線就可傳送資料，通訊時可大量節
省材料。 
AT89C52 的串列埠是全雙工通訊埠，
所以擁有同時發射與接收的能力。而且，
AT89C52 的串列埠具有緩衝器，所以欲發
射資料或接受資料只要對特殊功能暫存器
SBUF 進行存取即可，使用上甚為方便。這
裡配合傳送鮑率 9600bps，選擇串列埠工作
於模式 1，並將 SMOD 設定為 0。接著設
定一些字串，當電路偵測到用電事故的時
候，便將相對應的字串經由 RS232 傳送到
GSM 模組，GSM 模組接收到字串時，就
會將簡訊發送出去。 
把 Timer 2 設計為每秒發生一次的計
時器，用來控制 RTC 讀取時間，讓每兩個
月的 1 日，會自動將用電度數傳送到監控
端。還有警報時間的計算，假設電路偵測
到 125V 的過電壓，過了幾分鐘過後電路會
再發出一封過電壓的簡訊告知監控端，讓
監控人員知道用戶端的電壓過高。 
將 Timer 1 設定為計算電源頻率，每當
電源有觸發時，前面所介紹的產生方波讓
INT0 外部中斷。程式就會跳到中斷的副程
式，把 Timer 1 算出來的值經過程式換算成
實際的 Hz 數。這裡 Timer 1 是 89C52 所提
供的 16 位元的計時器，利用計時器來產生
程式的中斷。Timer 1 觸發訊號也會把這個
週期內的電壓值電流值紀錄下來，存在
MaxVm、MinVm、MaxIm、MinIm 這四個
變數裡面。每過一秒時，會把這幾個數字
進行運算，算出真正的功率值。在副程式
Detect_Warning()一直判斷這幾個偵測到的
值有沒有超出範圍，如電壓值超過 120V 或
低於 100V，頻率值是否超過或低於 60Hz。 
當這些數值超出許可範圍時，會用
89C52 的 UART 送到 GSM 模組的 RS232
傳輸端，告知要傳送的簡訊內容。同時會
計算出消耗的功率並且累計，當 RTC 過了
 4
 
圖 6 用戶姓名查詢。 
 
 
圖 7 戶資訊。 
 
 
圖 8 用戶編號查詢。 
 
 
圖 9 查詢停電用戶。 
 
圖 10 查詢過電壓用戶。 
 
 
圖 11 查詢用電度數值用戶。 
 
 
圖 12 停電展示結果。 
 
 
圖 13 復電展示結果。 
 6
 
圖 17 用戶供電情況偵測電路。 
 
2.系統整體測試結果 
當把用戶端的電源關掉即是『停電』
情況、電源開啟即是『復電』情況、將自
耦變壓器調到大於 120V 即是『過電壓』或
是小於100V即是『低電壓』、利用AC Power 
Source 來調整電源頻率、將開關按下即是
用電度數值傳送，則會傳送簡訊到行動通
訊用戶(監控端)。本文實際進行測試用戶
供電自動回報系統之結果，如圖 18~21 所
示。 
 
 
 
 
圖 18 停電與復電情況之回報。 
 
 
圖 19 過電壓與低電壓情況之回報。 
 
 
圖 20 頻率過高與過低情況之回報。 
 
 
圖 21 用戶用電度數之回報。 
 
VI. 結果與討論 
本研究設計電力用戶電力品質自動回
報系統，主要的目的是提供無線回報供電
事故的方式，讓電力公司監控中心調度人
員在用戶發生用電事故的時候，能夠即時
獲得資訊。除了提高對用戶的服務，同時
使事故發生端能夠盡快的將事故解決。改
善以有線方式回報用電事故的不足，減少
許多的成本。本系統除了檢測停電、復電、
過電壓、低電壓、頻率過高、頻率過低，
也可以回報用戶端用電度數，可以省去電
力公司派專人，抄取電表讀數的人力編制。 
 
VII. 計畫成果自評 
    本研究內容與原計畫完全相符、已達
成預期目標、研究成果的學術或應用價值
高、適合在學術期刊發表、主要發現或其
他有關價值等，綜合評估如下： 
硬體電路設計與製作： 內容包括；供電事
故偵測電路、GSM 通訊模組、供電事故包
括：停電、復電、過電壓、低電壓、頻率
過高、頻率過低、以及用戶在正常情況下
的用電度數值。 
軟體系統實現：建立一套用戶供電事故回
報系統，自動將故障訊息傳回監控中心，
而控制中心利用資料庫搭配監控系統，接
收故障訊息，並自動將訊息存入資料庫。 
 
 8
