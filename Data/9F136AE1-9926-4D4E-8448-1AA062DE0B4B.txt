 
3. 研究方法 
3.1 速度曲線模擬數學模型 
依據列車特性、負載量、軌道路線幾何特性及營運
策略等資料，計算出列車牽引力與各種影響列車的行駛
阻力，再利用運動方程式，求出列車於線上耗電量（或
再生發電量）、速度和時間的關係。 
 
3.1.1 列車運動方程式 
列車運動方程式可由牛頓第二運動定律推導出列
車行駛所需之牽引動力。圖 2.為列車行駛所需之牽引動
力。圖中F為列車動輪之輪周處的淨牽引力，亦即，列
車之總牽引力FA在克服列車行駛阻力FR之餘，用以推動
列車而產生行駛加速度的淨力[1]，如(1)式所示 
F = FA - FR (1) 
 
 
 2
 
 
圖2. 列車行駛所需之牽引動力 
 
將列車加速度，經由尤拉法（Euler’s Method）計算
[1-4]，可求得列車速度。如(2)式所示 
             Vn+1=Vn+3.6aΔT （km/h）                (2) 
其中，ΔT為模擬時間間距（s），Vn為前一模擬時刻之車
速。 
    求得列車速度後，根據前一模擬時刻之列車位置
Sn，再利用梯形法則（Trapezoidal Rule）求出新的列車
位置Sn+1 [1-4]，如(3)式所示 
            
1 1( )n n n n
1 TS S V V
2 3+
Δ= + +
.6+
)
 （m）          (3) 
感應馬達的輸出機械功率可由(4)式求得： 
Pout = FA*V （kW）              (4) 
(5)式為列車集電靴直流功率需求，亦是 VVVF 變流器的
輸入功率。 
(outinv motor gearPP η η= ∗  （kW）         (5) 
其中 ηmotor，ηgear ：分別是馬達及齒輪組效率 
 
3.1.2 列車行駛阻力計算 
引發列車基本阻力的因素極為複雜，包括滾動阻力
（Rolling Resistance, RR）與空氣阻力（Aerodynamic 
Resistance, RA）兩項，因此，本計畫根據Davis Formula
公式計算列車阻力，如(6)式所示[2,5]。 
 
FR = k0 + k1*V + k2*mtot + k3*mtot*V + k4*ktun*(V+Vw)2 + 
k5*mtot*ktun*(V+Vw)2                        (6) 
 
其中 FR    列車阻力 [kN]（train resistance） 
   mtot  以W4 載重總列車組重量 [kg]（total trainset 
weight） 
   V    瞬間暫態速度 [m/s]（instantaneous trainset 
speed） 
  ktun    隧道因素（隧道中為 2, 隧道外 1）（tunnel 
factor） 
      Vw    車頭風速：0 [m/s]（head wind） 
    k0~k5    阻力係數 
 
3.1.3 列車牽引動力計算 
依據列車行駛於各速度的阻力後，利用(7)式求出列
車的牽引動力。 
FA =（mtot + mtare．prot）．amax + FR          (7) 
其中 FA：牽引動力（kN） 
    mtot：列車總重（W4）（ton） 
mtare：列車空車重（ton） 
prot：空車重之轉動質量 
amax：最大加速度 
FR：列車阻力（kN） 
 
3.1.4 列車電能消耗計算 
當列車煞車時，此時感應馬達會變成感應發電機，
將再生發電電能回送至第三軌，以供給同一供電區其它
加速列車所需用電，為了精確的模擬列車電能消耗量，
本計畫之列車電能消耗模擬將考慮再生發電模式，依據
列車行駛模擬出每個運行速度所消耗的電能。其再生發
電電能及消耗電能如下所示： 
 
1. 當列車煞車再生發電時（負功率的部分），如果速度
大於 60 km/h，其再生功率為牽引動力FA乘上 60 
km/h；如速度小於 60 km/h，再生功率為牽引動力FA乘
上列車的速度V，隨著速度減少，回收功率亦跟著減
少，其回收的電能為 ，其中T為列車行
進於站間的總時間。 
∫−= T0 dt)t(PE
2. 列 車 加 速 消 耗 之 電 能 （ 正 功 率 的 部 分 ） 為
。 ∫= T0 dt)t(PE
 
3.2 速度曲線模擬結果 
本計畫是經由前推及後推計算推導出速度曲線，並
將此計算法則應用於模擬程式中。首先輸入列車、軌道
路線、載客量、速限等系統營運參數資料，並利用前、
後推計算法則之運動方程式可完成速度曲線的模擬。高
雄捷運橘線因軌道線形而導致速度曲線有最高速度的
限制，因此本計畫在考慮有速限行駛速度之模擬，以高
雄捷運橘線 O13-O14 為模擬對象，其站距為 1035 m，
在 337 m 至 525 m 間的速限為 64 km/h，其餘以時速 80 
km/h 全速行駛，並使用列車乘載等級為 W4，模擬出不
同旅運量之能量消耗及旅客完成站間旅行時間，以建立
供給類神經網路學習的資料集。 
圖 3.為O13-O14 兩站間列車運行牽引動力及速度曲
線，圖中列車起站速度從 0 km/h加速到 40 km/h之間，
牽引動力輸出為定值；40 km/h到 60 km/h之間，牽引動
力輸出隨著 1/V比例減少；60 km/h到 80 km/h之間，牽
引動力輸出隨著 1/V2比例減少。在 236m時，列車速度
從 80 km/h降至 64 km/h速限，此時馬達以負轉矩行駛。
在 337 m至 525 m間，列車以 64 km/h速限滑行。525 m
至 603 m間，列車行駛速度從 64 km/h加速至 80 km/h。
603 m至 796m間，列車以 80 km/h滑行。最後於 796 m
至 1035m間，列車以再生煞車發電模式減速靠站。 
 
 
FR=滾動阻力+空氣阻力+坡度阻力+曲線阻力 牽引力FA
 4
-12
0
-8
-6
-4
-2
0
65 70 75 80
滑行速度(km/h)
旅
客
路
段
旅
行
節
省
時
間
成
本
 (元
/小
時
)
0
2
4
6
8
10
12
14
16
節
省
電
費
(元
)
-1
25元/小時 30元/小時 35元/小時 40元/小時 45元/小時
50元/小時 55元/小時 60元/小時 電費乘客時間價值
0
5
10
15
65 70 75 80
滑行速度(km/h)
節
省
社
會
成
本
(元
/小
時
)
旅行節省時間成本及節省電費與滑行速度的曲線圖，其
旅客乘載等級為W2，而列車消耗功率是牽引動力及速度
的乘積，當列車行駛之滑行速度增加時，所需消耗功率
跟著增加，使得電能消耗隨之增加；另一方面，其完成
站間旅程所費的時間越少，因此旅客路段旅行節省時間
成本隨滑行速度的增加而節省越多。圖中在旅客路段旅
行節省時間成本方面，分別考慮乘客時間價值的範圍由 
25 元/小時、30 元/小時、35 元/小時、40 元/小時、45
元/小時、50 元/小時、55 元/小時、60 元/小時[1]，其節
省時間成本可由(9)式求得，所以圖中在相同的滑行速
度下，乘客時間價值越大節省的時間成本越多；另外，
在電費支出方面，隨著滑行速度增加至最大滑行速度
(80 km/h)，其電能消耗會隨之增加，因此節省之電費變
少。 
25元/小時 30元/小時 35元/小時 40元/小時 45元/小時
50元/小時 55元/小時 60元/小時
乘客時間價值
 
 
 
 
 
 
 
 
 
 
 
 
圖5. 旅客路段旅行節省時間成本及節省電費與滑行速
度的曲線圖 
 
圖 6.為節省社會成本曲線圖。圖中模擬出在不同乘客時
間價值及滑行速度下，所節省之社會成本，其節省之社
會成本可由(10)式求得。當旅客路段旅行節省時間成本
增加的量比節省電費所減少的量大時，節省社會成本曲
線是隨著旅客路段旅行節省時間成本的增加隨之增
加；反之，當節省電費所減少的量比旅客路段旅行節省
時間成本增加的量多時，節省社會成本曲線是隨著節省
電費的減少隨之減少。所以，當曲線於某個乘客時間價
值最高點時，即社會成本的最大值，對應的滑行速度為
最佳滑行速度。 
 
 
 
 
 
 
 
 
 
 
 
 
圖6. 節省社會成本曲線圖 
 
圖 7.為橘線O13-O14 兩站於不同載客量之最佳滑行速
度的學習資料。圖中模擬出不同乘客時間價值及載客量
下之最佳滑行速度，即是在同一載客量及不同乘客時間
價值，會對應不同的最佳滑行速度。當載客量增加，乘
客時間價值越高，其最佳滑行速度上升率就越快，例如
乘客時間價值為 60 元/小時及載客量為 423 人時，其最
佳滑行速度就達到 80 km/h。另外，圖中以乘客時間價
值為 40 元/小時，其載客量在 335 人與 364 人為例，雖
然有相同的最佳滑行速度，但兩者的節省社會成本值是
不同。 
 
 
335人 364 人
60
65
70
75
80
85
0 200 400 600 800 1000
逐年增加載客量(人)
最
佳
滑
行
速
度
(k
m
/h
)
25元/小時 30元/小時 35元/小時 40元/小時
45元/小時 50元/小時 55元/小時 60元/小時
乘客時間價值
 
 
 
 
 
 
 
 
 
 
 
圖7.不同載客量之最佳滑行速度的學習資料 
 
3.5 類神經網路規劃捷運系統最佳滑行速度 
類神經網路（Neural Network），或譯為人工神經網
路，係模仿生物神經網路的資訊處理系統，進行神經元
間的複雜運算，產生神經元與神經元之間的訊號加權
值，使類神經網路具有人工智慧的雛型。類神經網路模
擬人腦架構，應用上大致可分為兩大類，一為型態鑑別
（Pattern Recognition）問題的神經網路，一為函數模擬
（Function Approximation）問題的神經網路，分別應用
在分類與數值預測問題上。 
本計畫設計之類神經網路架構說明如下： 
◇ 類神經網路架構：前饋式，倒傳遞網路。 
◇ 輸入層變數數目：輸入變數為 4 個。 
◇ 隱藏層數目及神經元數目： 
第一層使用 50 個神經元數目。 
第二層使用 50 個神經元數目。 
輸出層使用 5 個神經元數目。 
◇ 隱藏之轉移函數：皆選用正切雙彎曲線轉移函數。 
◇ 輸出層之轉移函數：選用線性轉移函數。 
◇ 學習法則：LM BP（Levenberg Marquardt BP）。 
◇ 學習資料筆數：約 1488 筆。 
◇ 目標誤差：0.0005。 
 
3.6 實例模擬分析 
為了有效規劃高雄捷運紅橘兩線的電聯車隨逐年
客運量成長之最佳滑行速度，本計畫以類神經網路建構
最佳滑行速度的學習模型，根據捷運各路線之站距、旅
運量及旅客乘客時間價值，快速規劃高雄捷運紅橘線各
站間之電聯車最佳滑行速度。 
3.6.1 應用類神經網路求解有速限行駛之最佳滑行速度
規劃 
根據高雄捷運紅、橘兩線各路段定線資料，可知電
聯車運行於路線上，有些路段是沒有速限，可加速至時
速 80 km/h 行駛；另外，有些路段是有速限，必須將速
度降至速限速度，才能確保電聯車運行安全性與到站準
確性。本計畫在有速限行駛之最佳滑行速度規劃，以橘
