I 
 
一、中文摘要 
地球表面有70%為水所覆蓋，經由水下感測網路(Underwater Sensor Network, UWAN)可蒐
集海中生物資訊、監測海洋環境。採用聲波傳輸訊息的水下感測網路有許多特性與使用無線電
傳輸的陸地無線感測網路有很大不同，如較大的傳遞延遲、較小的有用頻寬、多路徑衰減…等
問題。 
由於Sink廣播及蒐集節點的訊息都是定期要執行，但是現存適用於水下感測網路的MAC
協定中，均未能依據不同性質的資料(如廣播封包、突發事件回報或是定期回報感測到的資訊)
設計不同的媒體存取控制協定。 
本論文針對水下環境提出混合定期排程和隨機存取-SRH-MAC(Scheduling and Random 
Access Hybrid MAC)的跨層式(Cross-layer)媒體存取控制協定。在SRH-MAC中頻道被分割為數
個固定長度的Superframe，以適應不同類型的資料傳輸，每個Superframe包含廣播時段、定期
回報時段和事件回報時段。經由本論文所提出之Heuristic演算法，SRH-MAC可找出資料傳送
路徑並計算出Collision-free排程；且依據不同時段提出不同傳輸策略，包含廣播樹、資料蒐集
樹、獨立傳輸集合(Independent transmission set)和Handshake機制。 
最後本論文透過C語言進行排程並使用NS-2+AquaSim進行實驗模擬。經由模擬結果可知
本論文提出之SRH-MAC能依據不同傳輸特性而有較好的傳輸率、較高且穩定的網路
Throughput以及於廣播和定期回報排程中的網路延遲時間也能有效降低。 
  
1 
 
四、報告內容 
1 簡介 
由於地球人口急遽增加，陸地資源開發過度導致能源危機爆發而地球表面有超過70%面積
為水所覆蓋，加上海底環境惡劣因此在海洋中尚有豐富資源未被探勘到；為了有效率地開發與
保護海洋生態資源，人們開始將感測節點放入水中，就如同陸地感測網路般，用以觀測海底環
境:火山爆發、污染檢測、生物研究或蒐集海洋相關資訊及探勘海中資源，如:油井、天然氣等。 
一般陸地無線感測網路(Terrestrial WSN)是使用電磁波(Radio wave)或光為媒介來傳遞訊
息，但是在水下電磁波能量容易被水吸收或因散射導致訊號衰減，所以在水下感測網路中會採
用聲波(Acoustic wave)當作傳輸介質，使得水下感測網路有許多特性與陸地無線感測網路不同，
面臨了許多挑戰:[1] 
 頻寬較小: 在陸地感測網路中，IEEE802.15.4 所訂定之「低資料率-無線個人區域網路(Low 
Rate-Wireless Personal Area Netowrk, LR-WPAN)」中，每個頻道理論上最高可達 250kbps
的傳輸速率。但是，在水下感測網路中受到雜訊(Noise)、多重路徑(Multipath)、傳輸損耗
(Transmission loss)…等影響，使得可用頻寬相對較 WSNs 少。 
 長時間傳遞延遲(Propagation Delays): 一般陸地上無線電傳輸以光速(3×108m/s)在空氣中
前進，因此傳遞延遲是可以被忽略不計的。但是UWAN的傳輸速度為1.5×103m/s，加上聲
波調變器(Acoustic modem)傳輸距離比陸地上來得遠，在傳輸速率慢且距離較遠的情況下，
節點間資料傳遞延遲動輒數秒鐘將影響整體網路效能。也使得某些陸地網路上的技術不適
合直接應用於UWAN中，如:Carrier sensing和Handshake。 
 硬體成本及節點配置: 陸地感測節點的硬體成本大約幾百元美金且隨著數量增加而減少，
但是在水下感測節點因為調變方式的不同、抵抗水中高壓…等因素，所以造價成本則要數
百至數千元美金。[1]另外在UWAN中，節點會隨著洋流而有3-6km/h的移動速率，因此在
節點佈署及協定設計時成本、節點的移動皆須加入考量。 
 水下感測節點消耗較高電量：水下感測節點傳輸聲波所消耗的電量高於傳輸無線電波的電
量，且傳送資料消耗的電量也遠大於接收資料的電量。一般水下節點傳送資料所消耗的電
量為50W，接收資料所消耗的電量只有3W，其傳送資料所消耗的電量是接收所消耗電量
約17倍。 
2007年 Syed 等學者 [2]針對水下長時間傳遞延遲，提出並定義了時空不確定性
(Spatial-Temporary Uncertainty)問題在UWAN中。因為在UWAN中，由於時空不確定性問題，
若給予和陸地感測網路同樣排程則節點封包可能會有相同的到達時間點而發生碰撞，但在考量
不同傳遞延遲時間單位，錯開封包接收時間即使節點在相同時間點送出封包，也能有效避免封
包碰撞。本協定也將利用此特性，加以設計適用於水下之媒體存取控制協定。 
水下MAC協定則是來防止節點的封包發生碰撞，因為它們會浪費有限的電量和可用通訊
節點的資源。雖然已有許多學者針對UWAN提出媒體存取控制協定，然而有些問題仍有待解
決：  
1. 未能依據不同性質的資料(如廣播封包、突發事件回報或是定期回報感測到的資訊)設
計不同的媒體存取控制協定。在UWAN的環境中，因為傳遞延遲時間長，所以採用
Handshake機制的協定，會因為交換過多RTS/CTS以及DATA/ACK而於傳送端造成較
3 
 
在模擬分析中 STUMP 雖然在 Throughput 優於傳統 TDMA 和 Aloha 協定，但是由於
STUMP 在分散式排程中尚無法找到最佳節點順序，因此在 Uplink 傳輸中表現比傳統
TDMA 差。也受限於排程中需要預先取得節點的傳遞延遲時間，因此當傳遞延遲時間或
時間同步評估誤差較大時，對整體網路效能就會有所影響。 
2.2 ETFRS (Earliest Transmission First with Random Start Scheduler) 
Guan[4]等學者於 2011 年透過混合線性規畫模型(Mixed Integer Linear Programming Model)，
來定義 TX-TX、TX-RX、RX-RX、RX-Interference 四種衝突情況。並根據免衝突延遲 CFD 
(Conflict Free Delay)傳送任務時間提出 ETFRS 和 ETFBS (Earliest Transmission First with Best 
Start Scheduler)排程演算法用於解決上述衝突情形。 
在 ETFRS 演算法中，一開始將隨機選擇一個尚未被排程的傳送任務並將該任務的傳送時
間設為 0，再根據衝突情況來調整其他未排程傳送任務的開始時間。之後，再選擇未排程傳送
任務中開始時間最小的作為下一個排程的任務。當所有傳送任務之開始傳送時間決定後，再計
算出訊框大小(Frame size)以避免節點的封包發生碰撞。 
而ETFBS和ETFRS不同的地方在於ETFBS會給予所有的傳送任務不同的開始傳送時間，
藉以找出最小的 Frame size 並取得最佳的排程。透過縮短 Frame size 及給予不同的傳送時間避
免碰撞發生的方式來提升網路的 Throughput。ETFRS 和 STUMP 均為解決上述四種衝突情況而
加以設計或找出接近理想解的排程演算法，但同樣皆未能依據傳送之特性加以設計排程時間和
路徑。 
 
3 系統模型 
3.1 系統假設 
本計畫是運行在 Multi-hop 的水下網路環境，且是運行在一個節點靜止或有限移動下的網
路拓樸之中。每個感測節點均裝置一個半雙工的收發器(Transceiver)，使用一個 Sink 來蒐集
Sensor nodes 相關資訊及感測到的事件。每個感測節點，且透過浮標或重物固定可佈署在海平
面到海底各層中。於初始化階段中透過[28][8]可使每個節點時間達到同步化，此外每個節點
皆會廣播 Beacon 封包給位於 One-hop 鄰居節點，透過 Beacon 封包中的 Time-stamp 可計算出
與傳送節點間的 Propagation delays。藉由[5]可找出感測節點的位置與深度，因此每個節點能
建立節點表格(Nodes table)，內容包含 One-hop 相鄰節點的 ID、Propagation delays 及定期回報
排程時間。 
於本計畫中將建立網路拓撲圖 G = ( V , E )，其中 V 代表感測節點而 E 為有權重的路徑長
度即為節點間的 Propagation delays。 
3.2 系統架構 
網路架構以樹狀(Tree-Based)為基礎，在 Single-Parent Tree 環境設定下，感測節點依照距
離 Sink 的 Hop 數可分為數階層(Layer)。經由樹狀的建立，每個 Sensor node 將以固定且唯一的
路徑將資料採上行(Uplink)或下行(Downlink)的方式傳遞。進而提出結合集中式和分散式排程，
主要達到以下兩個目的:  
1. 效率性：減少 Time slots 的數量，縮短整個排程長度，並使每個時槽能同時進行多條
連結傳送以提升效能。 
5 
 
將導致事件回報時段之時間縮短或沒有該獨立時段而是分散在定期排程時所產生的時槽空隙
之中。 
4.1 廣播樹之建立 
由於目前較少有針對水下環境提出廣播傳送協定，且 Sink 傳送的廣播封包，在感測網路
中是一個很重要的訊息，它能夠被用來作時間同步或公告排程訊息…等。由於水下感測網路的
限制，使得一般陸地網路中常見的廣播協定到了水下環境會變得很沒效率。因此本計畫將針對
水下感測網路傳播特性設計出一個有效率的廣播網路-廣播樹(Broadcast tree)。 
透過浮標或重物固定，可使感測節點平均分佈在海平面到海底各層中，每個節點間透過無
線傳輸一開始會先形成網狀(Mesh)網路。在本計畫所設計的廣播樹中，將以海平面上的 Sink
當作根節點(Root node)，且根據節點與 Sink node 的 Hop 數來分 Layer，距離 Sink 第 k Hop 的
節點就位在 Layer k，並由上往下依據 Layer 1, 2, 3,…, Maxhop 的順序建立廣播樹及安排廣播
排程，Maxhop 為網路最底層。 
由於集中式排程以找出最低延遲之路徑為一 NP-Complete 問題[27]，因此本計畫提出一個
Heuristic 演算法以解決水下環境中排程問題。首先本計畫會先讓 Sink 蒐集網路中所有節點
Nodes table 中相關資訊，並採 Floyd-Warshal 演算法找出每個感測節點到 Sink 的最短路徑，並
將該路徑中所經過之節點標識為中繼節點(Relay node)。而於 Sink 端會針對 Relay nodes 維護
Sink-node table，在Sink-node table會記錄由Sink到父節點 p的路徑長度加上父節點 p經由Relay 
node i 到其各個子節點及 Sibling 節點 j 所須分支路徑長度: 
Ls-i-j=Ls-p+ Lp-i-j          (1) 
其中 i=1,2,…,r 代表網路中所有 Relay node，j=1,2,…,m 代表第 i 個 Relay node 的子節點及
其Sibling節點。再由上層至下層依序判斷每個Relay node間是否有共同子節點或Sibling節點，
若有則再經由 Sink-node table 判斷是否起始碰撞處理規則，最後進行節點時槽分配。 
在碰撞處理規則中，本計畫會判斷該組有共同節點的 Relay node，出現何種碰撞情況: 
 碰撞情況 1:參考圖 2，節點 A 和節點 E 有共同子節點 D 且 Sink 經由 A 及 B、E 到節
點 D 的路徑長度相同，因此若節點 A 和節點 E 同時轉送廣播封包則會發生碰撞，使
得節點 D 無法接收該封包。 
 碰撞情況 2:如圖 2 所示，Sink 到節點 I 的路徑中，路徑長度 LS-B+LB-E-I = LS-B+ LB-F-I，
將會導致節點 I 無法接收到廣播封包。 
若發生上述可能之碰撞情況，如碰撞情況 1 例子中，將先判斷中繼節點 A 的子節點 D 可
否為其他 Relay node 覆蓋，如圖 2。根據 Nodes table 可知節點 A 的子節點為{D}、節點 E 的子
節點為{D,H,I}透過集合關係可得{D} ∋ {D,H,I}，故節點 D 可為 E 所覆蓋，因此節點 A 將被標
識為一般節點，其原本的子節點 D 將改變資料接收路徑而成為節點 E 的子節點；若無法有效
覆蓋如碰撞情況 2 例子中，則挑選與子節點路徑較短的或 ID 較大 Relay node 如 F 延遲 Txmit + 
Tguard 時間後再傳送廣播封包，這樣可縮短因延遲傳送時間而導致整個排程時間延長。並且當
傳送時間改變，須再重新進行碰撞判斷。 
圖 2 中為 Maxhop = 3 的最短路徑樹，其中虛線為干擾連結而實線為傳遞連結。在形成最
短路徑樹後，節點 A、B、C、E、F 節點於路徑中有子節點故被標識為 Relay node。此時 Sink
依序由 Layer 1 到 Layer 3 計算經由所有 Relay node 到其子節點和 Sibling 節點的路徑長度以製
7 
 
收不受干擾，以及不影響同層 Sibling 節點接收。於本計畫中透過 Sink 由底層往上層依序找出
位於第 Hop 層節點傳送範圍內的所有 Hop−1 層節點，並計算到達該節點的路徑長以製成
Node-sink table。而所有位於第 k 層的節點將兩兩判斷是否有共同 Hop−1 層節點且路徑長度是
否相同，以決定資料是否會發生碰撞；同時須再考慮當某一節點進行資料傳遞時，其 Sibling
節點是否正處於接收狀態以避免干擾其接收。若有某組節點的資料可能發生碰撞，則須調整該
組節點中其中一個節點的資料傳送時間。調整步驟如下，首先會判斷該組可能發生碰撞的感測
節點中是否有節點的傳送時間已被調整，若有則將另外一點的傳送時間提前 (當 Tx  ≥
 Txmit+Tguard)；若都未被調整過，則挑選其子節點路徑長度較短或節點 ID 較大者延遲 Txmit+Tguard
後傳送。決定好傳送時間後，節點將會選擇距離 Sink 路徑長度最短的 Hop−1 層節點為接收節
點。 
如圖 2，Layer 3 有三個節點，依序找出這三個節點中傳送範圍內位於 Layer 2 的所有節點
並記錄路徑長，製成 Node-sink table 如表 2 中所示。於表 2 中可得知 Layer 4 節點 I 和節點 J
有共同 Layer 2 節點 F，且 LI-E= LI-F=4 故有碰撞會產生。此時再判斷節點 I 或 J 的傳送開始時
間Tx是否已被調整過，若無則調整節點 ID編號較大者(節點 J)的傳送開始時間T = T + T +
T
；反之則判斷節點 I 和 J 中，傳送時間未被調整之節點的 Tx是否大於T + T
，若
是則T = T − T + T
，若否則T = T + T + T
。解決碰撞問題後，節點會選擇
距離 Sink 路徑長度最短的 Layer 3 節點連接。 
表2 Layer 3節點之Node-sink table內容 
Layer4 節點 至 Layer3 節點 1 路徑長 至 Layer3 節點 2 路徑長 
H LH-D = 6 LH-E = 8 
I LI-E = 7 LI-F = 4 
J LJ-F = 4 LJ-G = 7 
資料蒐集樹在安排時槽中，將由最底層往上層依序排程，此時可將不會發生碰撞的節點
如:H、I 視為一組，於時槽 0 時傳送資料，而節點 j 則視為另一組於時槽 0 + T + T
後
開始傳送資料。這時須再判斷其中一組節點如 np 的 Prop-s 即當節點 P 的資料傳送到 Sibling 節點
是否正處於接收狀態?若是，則節點 P 的傳送時間須再延遲T + T
時間後才能傳輸以避
免干擾 Sibling 節點接收資料。     
經由資料蒐集樹建立如圖 4，本計畫將對節點進行分組把不會發生碰撞的節點安排在相同
時間傳送以提高資料傳送率。此外，資料由底層往上層傳輸，感測節點於收到資料後將採用[31]
進行資料融合(Data Fusion)的處理，如此可降低過多重覆性資料以縮短 Frame 長度而增進網路
效能。 
4.3 事件回報時段 
每個節點在定期排程時進行事件傳送後，此時若網路中有少數節點臨時偵測到事件發生時，
為了資料傳輸的即時性及運用閒置時槽進行資料傳輸以提升網路效能，所以本計畫加入了事件
回報時段。在事件回報時段中，除了使用原先定義好的事件回報時段進行資料傳送外，還能利
用前面廣播時段和定期回報時段的時槽空隙進行資料傳送。本計畫將定期排程後剩餘的時間可
9 
 
廣播封包後，即可進行定期事件回報給父節點。假設節點 G 固定於 Time slot 13 接收廣播封包
而於時槽 16 時進行定期事件回報給節點 C 而節點 C 則固定於時槽 25 定期回報給 Sink(S)。於
非定期回報之傳送與接收時槽中即為節點可進行事件回報之時槽(方格框處)。例如節點 B 於
Time slot 15 接收子節點 H 的事件回報，則節點 B 可於 Time slot 20 即時將資訊傳給 Sink。根
據圖 6 可得知藉由定期排程和隨機存取模式動態地使用空閒時槽，可充份利用時槽進行資料傳
送和接收以降低閒置時槽。 
由於每個節點於排程後剩餘的 Time slots 數不盡相同，故當節點的資料量大於 Lthrsehold 時，
為了更有彈性地傳送感測事件，節點會於 RTS 封包中加入此次欲傳送的資料量，以確保父節
點所剩餘的 Time slots 空隙能滿足此次資料接收所需時間。如節點 B 於接收子節點 H 的事件回
報後，並與 Sink 進行 RTS/CTS 交換，並在 RTS 封包中告知 Sink 此次傳送資料量需要 2 個 Time 
slots，當 Sink 接收到 RTS，除了要確保節點 B 所傳送的資料不會與其他節點發生碰撞，還必
須確保預計接收時間(Time slot 26)之後至少有 2 個 Time slots 時間的空隙以利後續資料接收。 
為了有效利用能源節點於非傳送或接收時槽中若沒有感測事件欲進行回報，則可進入微弱
電等待狀態直到排程時間到來或傾聽到 RTS 封包感測節點才會再度醒來。 
於 SRH-MAC 中當 Sink 根據 Sink-node table 和 Node-sink table計算出每個節點的傳送路徑
後，將透過廣播的方式讓每個節點知道。由於每個節點維護了 Nodes table 得知距離 one-hop
鄰居節點的 ID，故當一節點接收到封包後，將可依據封包 Header 之 ID 編號與封包性質判斷
出封包應往何處傳送。因此雖然 SRH-MAC 於 Superframe 中定義了三個時段，但其各時段出
現之週期時間將可依據實際應用環境加以調整。 
4.4 樹狀架構的維護 
在廣播樹或資料蒐集樹中，若因節點電量耗盡導致樹的連結斷裂時，即父(子)節點一段時
間未收到子(父)節點所傳送之訊號時，未收到訊號的節點 n 會先傳送 Beacon 等待對方回應，
但若還是未收到回應時則啟動連結修復程序。首先節點n會先送出訊問訊息(Request message)，
其他節點收到後會回覆應答訊息(Response message)。節點 n 可根據該訊息找出是否有其他
Relay node 在傳送範圍內，若有則將該節點設為接收節點；若沒有則找出其他距離最近的節點
作為目的節點，並由該節點採最短路徑至其他 Relay node 以建立新路徑。並發送訊息告知 Sink
以重新計算排程，同時將該電量耗盡的節點於 Nodes table 中移除。 
 
5 實驗模擬 
於本章節中將針對 SRH-MAC、ETFRS 和 STUMP 協定之 Network throughput、Energy cost
和 End-to-end delay 進行分析比較，其單位分別為 kbps、joule/packet 和 s。 
5.1 實驗方法 
本計畫使用 C 計算出排程時間，再利用 NS-2+Aqua-Sim[7]模擬感測節點的資料傳送，
Energy Model 是採用 WHOI Modem[8]電量消耗功率所設定的。本計畫將隨機佈署 10-50 個靜
態感測節點於平面海底中進行資料傳送，外加一個 Sink 置於浮標上。事件回報時段中本計畫
將採用R-MAC[9]協定進行控制封包交換以預訂時槽，並結合本計畫於4.3節中所提及的機制。
本實驗執行 10 次並取其平均數據結果，其他相關模擬參數設定如表 3 所示。 
11 
 
所需的總 Frame 數量也能有效提升網路 Throughput。 
5.3 節點電量消耗 
從圖 7(b)中可得知 SRH-MAC 在電量消耗的部份和 ETFRS 和 STUMP 差不多，但隨著節
點數量增加，將使得整體電量消耗略高於其它兩個協定。這是由於 SRH-MAC 有別於其它協定
完全採用定期排程的方式，使每個節點於排程時間到時才進行資料傳送。 
由於在 SRH-MAC 中節點將可於定期排程之餘，透過閒置時槽進行資料傳送。因此在事件
回報時段中，感測節點有一定機率需先透過 RTS/CTS 交換，才得以進行資料傳送。但是在高
傳遞延遲時間的水下環境之中，將會消耗較多的電力在等待控制封包的交換，因此會使得
SRH-MAC 在電量消耗的部份會比較高。因此雖然 SRH-MAC 將使得節點消耗較多電量，但是
經由 5.2 節中的實驗結果可得知，藉由本計畫所加入的事件回報時段 SRH-MAC 將可大幅增加
網路 Throughput。 
5.4 資料傳遞延遲時間 
5.4.1 整體網路傳遞延遲時間 
在平均延遲時間中隨著節點數增加將使得網路變大 Hop 數增多，因而延長了傳遞延遲時
間。經由圖 7(c)，可看出 SRH-MAC 在整體延遲表現的部份和其它兩個協定差不多，這是由於
節點於事件回報時段中節點的資料傳送，延長了整體網路的延遲時間。但是節點也得已透過該
時段，即時地將所感測到的資訊往父節點傳送，所以即使 SRH-MAC 有採用隨機存取的方式進
行資料傳送，但是與 ETFRS 和 STUMP 單純採用排程的協定比起來，並不會導致整體網路延
遲時間過長。 
5.4.2 定期廣播與蒐集回報傳遞延遲時間 
在本節中將針對定期排程中的廣播時段和資料蒐集時段的延遲時間進行比較。從圖 8 中在
固定傳輸速率下網路密度保持不變，隨著網路規模的增加本計畫所提出的 SRH-MAC 的廣播排
程的延遲時間只採平緩速度上升，故可得知 Sink 在傳送廣播訊息的效率中會比 ETFRS 和
STUMP 來的較佳。此外 SRH-MAC 藉由少數幾個 Relay nodes 進行轉送可降低碰撞機率因而減
少資料傳送的等待時間，並讓所有節點接收到 Sink 所傳送的封包。 
經由圖9中可得知由於SRH-MAC的定期排程傳送，已針對傳送特性事先安排好傳送路徑，
並藉由路徑的建置讓不會發生碰撞的節點於相同時槽進行傳送因而縮短節點傳送時間，使得傳
遞延遲可比 ETFRS 和 STUMP 降低。由此可證得，本計畫提出之 Heuristic 演算法所建置之廣
播和資料蒐集樹確實可達到其傳送效率。但是，在 Sink 蒐集資料過程中由於每個節點均須傳
輸資料，在 SRH-MAC 中為了避免封包發生碰撞而加入了額外的延遲時間，故使得在傳遞延遲
時間中將比廣播段時來得長。 
 
6 結論 
本計畫針對水下感測網路設計一個混合定期排程和隨機存取的跨層式 MAC 協定
SRH-MAC。首先經由 Sink 蒐集整個網路的節點資訊，結合本計畫所設計的廣播樹和資料蒐集
樹演算法進行集中式的 Collision-free 排程，能將不同性質的資料採重疊傳輸的方式將資料傳達
到目的地；再藉由本計畫於事件回報時段中所加入的動態隨機存取模式及 MAC level pipelining，
13 
 
國科會補助專題研究計畫成果報告自評表 
請就研究內容與原計畫相符程度、達成預期目標情況、研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）、是否適
合在學術期刊發表或申請專利、主要發現或其他有關價值等，作一綜合評估。 
1. 請就研究內容與原計畫相符程度、達成預期目標情況作一綜合評估 
▉達成目標 
□未達成目標（請說明，以 100 字為限） 
□ 實驗失敗 
□ 因故實驗中斷 
□ 其他原因 
說明： 
2. 研究成果在學術期刊發表或申請專利等情形： 
論文：▉已發表 □未發表之文稿 □撰寫中 □無 
專利：□已獲得 □申請中 ▉無 
技轉：□已技轉 □洽談中 ▉無 
其他：（以 100 字為限） 
本計畫之部分研究成果已發表於 The 16th Mobile Computing Workshop (MC2011) 
3. 請依學術成就、技術創新、社會影響等方面，評估研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）（以
500 字為限） 
 完成之工作項目：提出混合定期排程和隨機存取的跨層式水下感測網路中媒體存取控制
協定之設計，藉此改善目前現存之 MAC 協定，有利於掌握海洋資訊。  
 學術研究成果：本計畫之部分研究成果已發表於 The 16th Mobile Computing Workshop 
(MC2011)，發表之論文請參閱附件，完整之研究成果則打算投稿至國際知名之期刊。  
 其他應用成果：我們所設計的有效率的排程和預訂式水下感測網路媒體存取控制協定可
提升整體網路之 Throughput 及頻道使用率並降低於定期排程中資料傳送和回報之傳遞延
遲時間。   
 教育訓練之成果：使參與人員瞭解水下感測網路之運作方式、使參與人員瞭解水下感測
網路上媒體存取控制協定之重要議題與設計策略、增強參與人員之水下感測網路上設計
與分析通訊協定之能力、參與人員學會撰寫模擬程式並分析媒體存取控制協定之效能、
參與計劃人員增強了彼此間的溝通與協調能力、提高參與人員之系統整合與團隊合作開
發系統的能力。 
  
 2007年A. Syed等學者[18]提出並定義了時空不確
定性(spatial-temporary uncertainty)問題。由於 UWAN
傳遞延遲時間長使得封包到達各接收者的時間點均不
同，因而考慮碰撞問題時，須將接收者和潛在干擾者
的位置距離及開始傳送時間加入考量。不同於陸地感
測網路[8]在 UWAN 中，藉由適當排程即使每條連結在
相同時間點傳送封包，加上不同傳遞延遲反而能錯開
封包接收時間避免碰撞。 
基於上述原因，本論文針對 UWAN 的特性提出一
個有效率的跨層式(Network 與 MAC layer) MAC 協定，
以解決時空不確定性問題。並透過適當排程來降低資
料發生碰撞的機率，因為重傳封包會浪費有限的電量
而影響網路存活時間(life time)和通訊節點的資源。 
藉由水下網路靜態拓樸的特性及節點間傳遞延遲
時間和相關路由資訊，我們會建立有效率的資料廣播
樹及蒐集樹。再依據定期回報的頻率，將時間軸分為
固定長度的 superframe，每個 superframe 的長度與回報
事件所需時間相同。其中每個 superframe 包含廣播時
段(broa- dcast period)、定期回報時段(routine report pe- 
riod)、感測事件回報時段(event report period)，以設計
出適用於不同時段的免競爭(contention free)排程及隨
機存取式的 MAC 協定。能使不同性質資料傳送在
multi-hop 的網路中運作。透過實驗模擬，可證明我們
所提出之協定能有效降低資料延遲(delay)時間並提升
整體網路產出量(Throughput)。 
本論文後續各節安排如下，第二節將探討相關文
獻，並討論其作法可改進之處；第三節為本論文研究
系統假設；第四節將介紹本論文研究方法;第五節將實
驗模擬本論文提出之協定相較於以往研究的效能及改
善程度；最後是結論及未來工作。 
二、文獻探討 
一般而言 MAC 協定可分為二類:免競爭式和競爭
式。有些研究期望達到公平性與提升效率而提出不同
的排程機制，其中又可分為集中式(centralize)與分散式
(distribute)排程。 
在免競爭式的排程協定中，[15]和[9]利用節點位
置的差異性各自提出不同的排程演算法，以解決節點
於傳送、接收時可能會發生的衝突情況 :Rx-Rx、
Tx-Rx-Tx、Tx-Tx、Tx-Rx。 
由於每個節點與鄰居節點間有不同開始時槽
(Starting slot)，STUMP[15]依據上述四種衝突情況來排
程，以確保每個傳送節點都有一個不會碰撞的開始時
槽且滿足 ∆個連續時槽。不需精準時間同步，STUMP
只需確保每組節點間封包抵達接收端時不會被干擾，
因此就算兩條連結位在彼此的干擾範圍內，也可排程
節點重疊傳送。根據不同的需求有集中和分散式兩種，
在集中式透過具有足夠運算能力的節點給予網路狀態、
負載資訊，再依據排程限制給予節點排程時間；在分
散式中作者先給予每組傳遞連結一個優先順序，決定
好順序後再透過 T. H.等學者提出之 Bellman-Ford 進行
排程。 
在[9]中作者首先將隨機挑選某組傳送任務中的節
點作為排程啟始節點，之後將根據該組節點之資料開
始傳送時間，來調整後續節點的傳送時間，以找出一
個擁有最短 Framesize 的最佳排程。另外，在
ST-MAC[13]中透過 sink節點蒐集網路中所有節點間的
路由資訊，並將節點間可能會發生碰撞的情況，建立
出時空衝突關係圖 ST-CG (Spatial-Temporal Conflict 
Graph)。透過 ST-CG 進行 TDMA 排程，可有效避免節
點傳輸發生碰撞。另外為了解決時空關係圖排程問題，
作者還提出了一個 heuristic 演算法 TOTA(Traffic-based 
+ One-step Trial Approach)，以找出分支度(degree)最多
的節點讓該節點優先排程傳送資料。 
雖然[15]和[9]在 throughput 優於 TDMA 和 Aloha
協定，但是在分散式排程中尚無法找到最佳排程，使
得在 uplink 傳輸中表現比 TDMA 差；也受限於排程中
需要預先取得節點的傳遞延遲時間，因此當傳遞延遲
時間或同步誤差較大時，對整體網路效能就會有所影
響。 
在競爭式的協定中[19]是採頻道預定(reservation)，
藉由每個節點皆配有的頻道外 tone 裝置來預定資料傳
送時間。在 T-Lohi[19]中每個訊框(frame)包含一系列競
爭回合(Cont- ention Rounds, CRs)和免競爭資料傳輸週
期。當節點要預定頻道時將傳送 tone 訊號在 CRs 中，
並傾聽是否有預定成功。T-Lohi 還加入 Contender 
Detection (CTD)和 Contender Coun- ting(CTC)機制，當
有多於一個 tones 訊號在 CRs 中，透過 CTD 和 CTC
節點彼此間可偵測並計數有多少個競爭節點在爭取頻
道存取，以瞭解目前頻道負載情況。當有多於一個競
爭節點時，每個節點皆會隨機選擇 Backoff 時間，以便
在下一個 CRs 中再次傳送 tone 訊號。T-Lohi 還針對不
同環境提出三種機制: Synch- ronized T-Lohi (ST-Lohi)、
Conservative Unsyn- chronized T-Lohi (cUTLohi) 、
Aggressive Unsyn- chronized T-Lohi (aUTLohi)。有別於
一般其他協定，T-Lohi 省下控制封包的交換並能解決
時空不確性問題提升水下頻道效能。         
[10][16][6]為隨機存取式的協定，改良了傳統
handshake 機制使其適合應用於水下環境中。在
APCAP[10]中，為了有效利用傳送控制封包後所產生
的等待時間，作者使用了 MAC level pipelining (MLP)
技術讓 source 節點在等待時間中，可對佇列(queue)中
之 MAC 服務資料單元(MAC service data units, MSDU)
進行處理。透過 Compulsory maximum latency (CML)
的設立，可讓傳送範圍內的節點接收控制封包，避免
可能的碰撞發生進而節省電源消耗，也能有效運用閒
置時間進行傳輸以提升網路效能。由於 APCAP 會刻意
地延遲 CTS 和資料的傳送，使得作者本身也提到將導
 本協定分有二個階段:廣播時期(broadcast phase)
和資料傳送時期(data transmission phase)。在廣播時期，
sink node 會定期廣播 beacon，內容包含時間同步、排
程資訊等其他重要之訊息；在資料傳送時期中又可分
為排程式與預訂時槽式的資料傳送，讓節點向 sink 回
報目前的狀態或將感測到的事件回傳。 
圖 2 本
協定 Superframe 架構 
有別於其他排程式的 MAC 協定，會將 time slots
長度設為最大的 propagation delays ，因而造成
throughput 減少。所以我們將每個 superframe 切割為數
個微小 time slots，讓每個被排程節點的資料傳送可在
任意時間點開始，進而改善頻道使用率並提升網路
throughput。 
首先我們將 superframe 分成三個時段，包含廣播
時段(broadcast period)、定期回報時段(routine report 
period)以及事件回報時段(event report period)，如圖 2
所示。在廣播時段中，我們會建立一顆有效率的廣播
樹，當 sink 有訊息要廣播時，只要沿著所建立的免碰
撞傳送路徑，將可在最少 time slots 數量使網路中所有
節點均可收到該訊息；在定期回報時段會額外建立一
顆資料蒐集樹，我們會讓多個在傳送資料時不會發生
封包碰撞的節點形成一個群組，透過排程讓這些節點
在被指定的 time slot 中進行定期回報之資料傳送。藉
由此種方式可重疊多個節點的資料在一個 time slot 傳
送完成，增加資料傳輸量，也可避免傳輸過程中發生
碰撞的可能性；由於事件發生的頻率以及所需回報的
資料量並不固定。因此我們將加入事件回報時段，當
sensor node 臨時偵測到事件發生時，若定期回報時段
尚未到來，則可利用定期排程後產生之空隙時槽，即
時將偵測到的事件往父節點傳送。為方便說明，於本
協定中使用到的相關符號定義如表 1 所示。 
表 1 符號定義 
符 號 定        義 
Li-r-j 
節點 i 經由中繼點 r 至節點 j 路徑
長度 
Tguard guard time 的時間長度 
Txmit 資料傳輸時間(transmission time) 
Ttmax 
聲波傳送到通訊半徑最遠處所需
之 propagation delays 時間 
Tx 節點的傳送開始時間 
Trts 送出 RTS 封包所要花的時間 
Tcts 送出 CTS 封包所要花的時間 
Tack 送出 ACK 封包所要花的時間 
Ti-j 
聲 波 從 節 點 i 到 節 點 j 的
propagation delays 時間 
Vi 節點 i 的聲波傳送速率 
Prts 為 RTS 控制封包資料量大小 
Proi-s 
為 ni的 Tx加上到其 sibling 節點間
的 propagation delays 
2. 有效率之廣播樹建立 
sink 傳送的廣播封包，在感測網路中是一個很重
要的訊息，它能夠被用來作時間同步或公告排程訊
息…等。由於水下感測網路的限制，使得一般陸地網
路中常見的廣播協定到了水下環境會變得很沒效率。
因此我們針對水下感測網路傳播特性設計出一個有效
率的廣播網路-廣播樹(Broadcast tree)。 
在廣播樹中將以海面上的 sink 作為根節點(root 
node)，且根據節點與 sink 的 hop 數來分 layer，距離
sink第 k hop的節點就位於第 k層，由上往下依據 layer 
1, 2, 3, …, maxhop 的順序建立，maxhop 為網路中最底
層。 
由於TDMA週期排程是個 NP-Complete問題[17]，
因此我們將提出一個 heuristic 演算法以解決水下環境
中排程問題。首先我們會先讓 sink 蒐集網路中所有節
點 node table 中相關資訊，並採 Floyd-Warshal 演算法
找出每個感測節點到 sink 的最短路徑，並將該路徑中
所經過之節點標識為中繼節點(relay node)。而每個
relay node 會維護一個 path table 1，在 path table 1 會記
錄由父節點 p 透過 relay node i 到其各個子節點及
sibling 節點 j 所須分支路徑長度 
 
Lp-i-j=Lp-i + Li-j  (1) 
 
其中 i=1,2,…,r 代表網路中所有 relay node，
j=1,2,…,m 代表第 i 個 relay node 的子節點及其兄弟節
點，符號定義參考表 3。再由上層至下層依序判斷每個
relay node 間是否有共同子節點或兄弟節點，若有則再
經由 path table 1 判斷是否起始碰撞處理規則，最後進
行感測節點時槽分配，詳細運作如 Algorithm 1 所示。 
 
Algorithm 1- Broadcast Tree  
Input: G=(V,E)、parent = sink、hop = 1、i=1、
網路中總共有 maxhop 層、n 為 maxhop × r 的
二維陣列，存放每一 hop 的 relay node i 的 ID。 
Lp-i-j為父節點 p 經 relay node i 到 one-hop 節點 j
的路徑長、Tx為節點傳送資料開始時間。 
首先由 sink 計算所有感測節點連至 sink 的最短
路徑，並計算每一階層中 relay node i 個數且將
relay node 的 ID 放入陣列 n[hop][i]中。 
 propagation delays。節點接收到廣播封包後將提取封包
內容，將得知本身是否為 relay node，以及是於收到封
包後立即轉送或是延遲 Txmit +Tguard 後再轉送。在廣播
樹中節點的排程是由上層依序至下層，直到所有 relay 
node 都已安排傳送廣播封包的時槽。 
透過廣播樹的建立，每個節點將可在最短時間內
接收到 sink 由所傳送的訊息，並且可有效避免節點於
轉送廣播封包時發生碰撞，因此在相同時槽中整體網
路節點可同時有多個感測節點進行資料傳送的動作。 
3. 資料蒐集樹 
Algorithm 2- Aggregation Tree  
Input: G=(V,E)、parent = sink、hop = maxhop(網
路中總共有 maxhop 層)、j=1、n 為 maxhop × s
的二維陣列，存放由 sink 記錄每一 hop 的 sensor 
node j 的 ID、s 為每一 hop 的感測節點個數。 
Lj-p 為感測節點 j 到其父節點 p 的路徑長、Tx為
節點傳送資料開始時間。 
while  hop ≧ 1 do 
while 第 hop 層還有 sensor node 未檢查到 do 
由 sink 找出節點 n[hop][j]傳送範圍內所有
hop−1 層節點 p，並記錄路徑長 Lj-p 
    if 節點 n[hop][j]和 n[hop][j+1]有共同 hop−1 
節點 then 
      if  Lj-p和 L j+1-p 路徑長度相同 then 
   n[hop][j]或 n[hop][j+1]的 Tx已被 
調整 then 
if  n[hop][j]或 n[hop][j+1]中，未被 
調整之節點的 T ≧ T + 
T
 then 
該節點的T = T − T + T
 
else T = T + T + T
 
       
    
end if 
         n[hop][j+1]的T = T + T + T
 
        end if  
      end if 
    end if 
    n[hop][j]選擇路徑最短的 hop−1 層節點為接 
收者 
  i+1 
  end while 
hop = hop−1 
end while 
由第 maxhop 層節點至第 1 層依序安排節點時槽 
由於廣播樹資料採 downlink 傳遞而節點在回報資
料時是採 uplink 傳輸。為因應不同傳輸特性，使 sink
能更有效率地蒐集資料，我們在定期回報時期中，將
額外建立一顆資料蒐集樹。在資料蒐集樹中資料是沿
著廣播樹相反的方向傳遞由樹葉彙整到樹根。因此我
們將從最外層的節點開始安排時槽，排程時將由距離
sink 最遠的節點開始向上收斂。並且相同層級的感測
節點將會在同一時期進行排程，如第 hop 層的節點連
結將會在第 hop 個時期安排行程，因此當網路中有
maxhop 層級時則需要 maxhop 個時期才能完成所有排
程。 
在資料蒐集樹中我們將只考慮第 k 層感測節點傳
送資料時可被第 k-1 層之接收者完整接收不受干擾，
以及不影響同層 sibling 節點接收。因此我們將由底層
往上層依序找出位於第 hop 層節點傳送範圍內的所有
hop−1層節點，並記錄到達該節點的路徑長並製成 path 
table 2。而所有位於第 k 層的節點將兩兩判斷是否有共
同 hop−1 層節點且路徑長度是否相同，以決定資料是
否會發生碰撞；同時須再考慮當某一節點進行資料傳
遞時，其 sibling 節點是否正處於接收狀態以避免干擾
其接收。若有某組節點的資料可能發生碰撞，則須調
整該組節點中其中一個節點的資料傳送時間。調整步
驟如下，首先會判斷該組可能發生碰撞的感測節點中
是否有節點的傳送時間已被調整，若有則將另外一點
的傳送時間提前(當 Tx ≥ Txmit+Tguard)；若都未被調整過，
則挑選節點 id 較大者延遲 Txmit+Tguard 後傳送。決定好
傳送時間後該節點會選擇路徑長度最短的 hop−1 層節
點為接收節點，詳細流程如 Algorithm 2。 
如圖 3 中 Layer 4 中有五個節點，將依序找出這五
個節點中傳送範圍內位於 Layer 3 的所有節點並記錄
路徑長，製成 path table 2 如表 3 中所示。於表中可得
知 Layer 4 節點 O 和節點 P 有共同 Layer 3 節點 K，且
Lo-k= Lp-k=9，故有碰撞會產生。此時判斷節點 O 或 P
之傳送開始時間 Tx是否已被調整過，若無則挑選節點
ID 編號較大者 (節點 P)的傳送開始時間T = T +
T + T
；反之則判斷節點 O 和 P 中，傳送時間
未被調整之節點的 Tx 是否大於T + T
，若是則
T = T − T + T
 ， 若 否 則 T = T + T +
T
。在解決碰撞問題後，每個節點會採 greedy 的方
式選擇路徑長度最短的 Layer 3 節點進行連接。 
表 3 Layer 4 節點之 path table 2 內容 
Layer4 
節點 
至 Layer3 節點
1 路徑長 
至 Layer3 節
點 2 路徑長 
O Lo-j = 5 Lo-k = 9 
P Lp-k = 9 Lp-l = 11 
Q Lq-l = 7 Lq-m = 8 
if 
 為了有效利用能源，節點於非傳送或接收時槽中
若沒有感測事件欲進行回報，則可進入微弱電等待狀
態，直到排程時間到來或傾聽到 RTS 封包，感測節點
才會再度醒來。 
5. 樹狀架構的維護 
在廣播樹或資料蒐集樹中，若因節點電量耗盡導
致樹的連結斷裂時，即父(子)節點一段時間未收到子
(父)節點所傳送之訊號時，未收到訊號的節點 n 會先傳
送 Beacon 等待對方回應，但若還是未收到回應時則啟
動連結修復程序。首先節點 n 會先送出訊問訊息
(request message)，其他節點收到後會回覆應答訊息
(response message)。節點 n 可根據該訊息找出是否有
其他 relay node 在傳送範圍內，若有則將該節點設為接
收節點；若沒有則找出其他距離最近的節點作為目的
節點，並由該節點採最短路徑至其他 relay node 以建立
新路徑。並發送訊息告知 sink 以重新計算排程，同時
將該電量耗盡的節點於 node table 中移除。 
五、實驗模擬 
我們隨機佈署 40個靜態感測節點於平面海底中外
加一個 sink 置於浮標上，每個回合隨機挑選 10-40 個
節點進行資料傳送，時槽長度設為 10 秒。使用單一頻
道且頻寬為 1 kbps，聲波傳送速率為 1500 m/s。我們
設定感測節點放置密度(density)平均為 1 node/km2，網
路範圍隨著節點數量作改變。每個節點的傳送範圍為
1.5 km，干擾範圍為 1.8 km。感測節點傳送資料封包
為 512 bytes，控制封包為 14 bytes，感測事件資料大小
設為 20-35 bytes。 
由於目前尚未有一水下網路的 MAC 協定，有同時
結合廣播訊息傳送、定期事件回報加上隨機存取模式
於單一 superframe 中。故在此處我們將挑選以下行
(downlink)為主的 T-MAC 
 
圖 6 平均延遲時間 
和上行(uplink)為主 RAS 協定進行比較。我們將設定
SRH-MAC、T-MAC 和 RAS 有相同 superframe 長度且
同樣具有廣播、資料蒐集 (uplink)定期排程，其中
SRH-MAC 則加入隨機存取模式利用時槽空隙進行資
料傳送。之後我們將分別對廣播排程、資料蒐集排程
延遲和 throughput 的效率性進行比較。 
1. 資料傳送延遲時間 
在平均延遲時間中隨著節點數增加使得網路變大
hop 數增加，因此延長了傳送延遲時間。由於在
T-MAC[12]中節點會維護一個 token 時間結合傳統
TDMA 排程，使網路中只有一個節點得以傳送資料避
免碰撞發生。而在廣播排程中，透過少數 relay node
轉送資料可有效降低碰撞發生的可能性，且藉由免碰
撞重疊傳送使得每個節點可在最短時槽內接收到 sink
的資訊。經由圖 6，得知在固定傳輸速率下，網路密度
保持不變但是隨著網路規模的增加，我們所提出的廣
播排程其延遲時間只採平緩速度上升，故在傳送廣播
訊息的效率比 T-MAC 來的較佳。 
此外，我們還和同樣為集中式排程的 RAS[21]進
行分析比較。由於我們提出的資料蒐集排程一次須考
慮每一層節點的延遲傳送時間，因此排程時間會較廣
播排程長。而在 RAS 排程中僅讓節點的資料接收時間
不會和資料傳送、干擾資料接收和資料傳送時間重疊，
並且 RAS 的時槽分配是由上層至下層依序進行。因此
於圖 6 中可看出當網路規模較小的時候，資料蒐集排
程和 RAS 傳送延遲時間差不多。但是隨著節點數量增
加排程時間也增加時，我們藉由蒐集樹的建置讓不會
發生碰撞的節點於相同時槽進行傳送，因而縮短節點
傳送時間使得傳送延遲可比 RAS 降低約 29%。 
2. 整體網路 Throughput 
在此小節中我們針對 T-MAC和 RAS協定作廣播、
回報、事件的 traffic 的 throughput 比較。也就是於
SRH-MAC 中除了節點定期回報外我們還隨機挑選
5-15 個節點進行感測事件 
 
圖 7 整體網路 throughput 
回傳。由於事件資料量不同所以節點有一定機率於感
測到事件後須先透過 RTS/CTS 交換，才能將訊息回報
給父節點。而由於 RAS 協定在一個 Frame 中僅能進行
節點的排程資料傳送，因此雖然我們只挑選少數節點
作事件回報，但是藉由額外加入的事件回報時期充份
利用時槽空隙的特性，從圖 7 中可得知我們提出的
SRH-MAC 可使 sink 平均接收到的資料量遠高於
T-MAC 和 RAS 協定，使整體網路 throughput 能有效提
升。 
 Temporal Uncertainty in Medium Access with 
ALOHA Protocols," ACM the Second Workshop on 
Underwa- ter Networks, pp. 41- 48, 2007. 
[19]  Affan Syed, Wei Ye, John Heidemann, "T-Lohi: A 
New Class of MAC Protocols for Underwater 
Acoustic Sensor Network," IEEE International 
Conference on Comp- uter Communications, pp. 
231-235, 2008. 
[20]  Affan Syed and John Heidemann, "Time 
Synchronization for High Latency Acou- stic 
Networks," Proceedings of IEEE International 
Conference on Computer Communications, pp. 
1-12, 2006.  
[21]  Junjie Xiong, Michael R. Lyu, and Kam- Wing Ng, 
“Mitigate the Bottleneck of Un- derwater Acoustic 
Sensor Networks via Pr- iority Scheduling,” Sixth 
international Co- nference on Mobile Ad-hoc and 
Sensor N- etworks, pp. 53-60, 2010. 
一、 參加會議經過 
 主辦學校韓國聖經大學 
 
為了不影響學校的教學，且不造成經費結報的延誤，所以決定選擇參加六月底七月初
舉辦的研討會。今年 The International Conference on Innovative Mobile and Internet Services in 
Ubiquitous Computing (IMIS 2011)將於六月三十日至七月二日在韓國首爾舉行，且其接受的論文篇幅
較長(八頁兩欄)，所以便將論文投稿至該研討會。根據大會的資料，IMIS 2011 只接受 39
篇論文(接受率只有 26%)，很幸運的，我的論文被接受了。等到六月初研討會的議程確定後，
我便開始規劃自己的首爾之旅。 
由於研討會舉辦日期是從六月三十日至七月二日，因此，我打算於六月二十九日搭機前
往首爾，並於七月三日，搭機返回台北。研討會是在韓國聖經大學，韓國聖經大學(Korean 
Bible University, KBU)位於首爾是郊區的東北方，而banquet則是在市中心明洞站附近的世
宗飯店舉行，為了交通的方便我選擇位於南大門市場附近(在明洞的附近)，且價格合理的
Hill House Hotel，行程決定後便開始預定機票與住宿的飯店。個人於六月二十九日下午一
點半，搭乘華航的直航班機(實際上是韓航的飛機)前往仁川國際機場，之後再搭乘巴士前
往首爾市中心住宿的飯店，六月三十日搭乘地鐵前往中溪地鐵站，之後步行前往KBU，完
成報到手續後，先前往大廳參加由Dr. David Taniar所給的keynote speech。Coffee break後則前
往Room IMIS 2，參加有關cloud computing的session，了解cloud computing的研究現況。 
Keynote Speech by Dr. David Taniar 
  
Reception party is held at Grand Convention Wedding Hall 
 
 
Banquet is held at Sejong Hotel 
最後一天由Hee-Kyong Song女士主講”Energy Efficient Systems: Present Situation, Solutions and 
Future”，下午利用空閒時間前往昌德宮以及德壽宮參觀朝鮮王朝的王宮，使個人對於朝鮮王朝的歷史文
物有更多的認識。會議結束後，個人於次日(七月三日)，搭乘地鐵至仁川國際機場，之後搭乘上午十點
半的班機返回台北。 
二、 與會心得 
本次研討會除IMIS 2011外，同時也舉辦The Fifth International Conference on Complex, Intelligent, and 
Software Intensive Systems (CISIS 2011)與數個相關的workshops，同一時間共有8個sessions同時
進行，CISIS 2011的accept rate為31%，IMIS 2011的accept rate則為26%，因此，就規模與accept 
rate而言，應該還算是個不錯的學術研討會，然而，由於主辦單位的經費與經驗不足，造成
了部分的缺失，茲將個人之心得歸納如下： 
1. KBU在韓國並非知名的大學，然而由於該校教師積極參與此研討會的組織，因而爭取到主辦會議的
機會，大幅的提升了該校的國際知名度。 
2. 為了節省經費，主辦單位選擇在自己學校舉辦會議，然而，由KBU知名度不足，且地處郊區，造成
許多與會者，無法很方便的到達會議場地，如果能夠在市中心區的飯店租界場地來舉辦此會議，則
應可讓與會者更方便到達會議場地，進而提昇參與會議之意願。 
 
An IP Passing Protocol for Vehicular Ad Hoc
Networks with Network Fragmentations
Yuh-Shyan Chen
Department of Computer Science
and Information Engineering
National Taipei University
Taipei, Taiwan
Email: yschen@mail.ntpu.edu.tw
Chih-Shun Hsu
Department of
Information Management
Shih Hsin University
Taipei, Taiwan
Email: cshsu@cc.shu.edu.tw
Wei-Han Yi
Graduate Institute of
Communication Engineering
National Taipei University
Taipei, Taiwan
Email: weihan.yi@gmail.com
Abstract—When a vehicle is moving fast in a highway, how to
effectively reduce the handoff delay and maintain the connectivity
of the vehicle to the Internet is an important issue. The existing
IP passing protocol may be able to reduce the handoff delay and
maintain the connectivity of the vehicle to the Internet when all
the vehicles are connected. However, when the vehicle density
is low or the speeds of vehicles are varied, the vehicle may not
be able to communicate with the intended vehicle either directly
or through multi-hop relays because of network fragmentation.
Hence, when network fragmentation occurs, a vehicle cannot pass
its IP address to the intended vehicle through existing IP passing
protocols and thus incurs longer handoff latency and higher
packet loss rate, and these would lower down the throughput of
the network. To improve existing IP passing protocols, we propose
an IP passing protocol for VANETs with network fragmentations.
The proposed protocol can postpone the time to release IP
addresses to the DHCP server (extend IP lifetime) and select
a faster way to get the vehicle’s new IP address. During the
extended IP lifetime, the vehicle can acquire an IP address
through multi-hop relays from the vehicles on the lanes of the
same or opposite direction, and thus reduces handoff delay and
maintain the connectivity to the Internet. Simulation results have
shown that the proposed scheme is able to reduce IP acquisition
time, handoff latency, packet loss rate, and extend IP lifetime.
Index Terms—Vehicular Ad Hoc Network (VANET), IP pass-
ing, Mobility Management, Wireless Network, Network Frag-
mentation.
I. INTRODUCTION
Due to the advancement of wireless communication technol-
ogy, users may enjoy many kinds of services through Internet
ubiquitously. As the wireless transmission rate increases, users
can make a VoIP call, browse website, download data, watch
TV, and get road traffic information or real-time weather report
from Internet through wireless communications.
Since every vehicle can be equipped with a short or
medium-range wireless transceiver, vehicles may commu-
nicate with each other. Vehicles may acquire information
and services through the V2V (Vehicle-to-Vehicle) or I2V
(Infrastructure-to-Vehicle) communications. The V2V commu-
nication is based on the dedicated short range communications
(DSRC) technology; while the V2I communication is based on
GPRS/3G, Wi-Fi or WiMAX. In VANETs, since the moving
speed of a vehicle is so high that it is hard to maintain a
seamless handoff and stable connectivity to the Internet. To
achieve a seamless handoff for an IP-based communication,
the IP of the mobile device must be assigned and reassigned
efficiently.
The Mobile Internet Protocol version 4 (MIPv4) [1] has
been proposed by the Internet Engineering Task Force (IETF).
Since Mobile Internet Protocol version 4 (MIPv4) may face
problems like the shortage of IP address and the weak security
mechanism, MIPv6 [2] is proposed to alleviate the above prob-
lems. To improve the efficiency of MIPv6, several schemes
have been proposed, namely Fast Mobile IPv6 (FMIPv6) [3],
Proxy Mobile IPv6 (PMIPv6) [4] and Hierarchical Mobile
IPv6 (HMIPv6) [5].
Mobile IP has an important characteristic that it configures
the IP address by neighbor discovery or auto-configuration.
There are two auto-configuration mechanisms: the stateful and
stateless mechanisms. Dynamic Host Configuration Protocol
(DHCP) [6] which has been adopted in both IPv4 and IPv6,
is a stateful auto-configured mechanism that each IP address
is auto-configured and managed by a DHCP server [7].
The stateless auto-configured mechanism is adopted by IPv6,
which creates link-local IPv6 address. Addressing in vehicular
networks could be achieved by using DHCP, which has been
extensively used in computer networks. The DHCP process
often requires a lot of time to complete the association and it
may consume too much time to achieve a seamless handoff.
Hence how to reduce the time for acquiring a new IP address
is an important issue.
Several schemes for VANETs have been proposed [8] [9]
[10] [11] [12] [13] [14] so as to keep the mobile devices
connected to the Internet and reduce the complexity of hand-
off procedure. However, they do not consider the impacts
of network fragmentations. When a vehicle is leaving the
communication region of its serving Base Station (BS) and
is moving to the boundary of the target BS’s communication
region, it may acquire a new IP address through IP passing [8]
[12] from the vehicles on the lanes of the same or opposite
direction so as to reduce handoff delay. However, when the
vehicle density is low or the speeds of vehicles are varied, the
vehicle may not be able to communicate with the intended
vehicle either directly or through multi-hop relays because of
network fragmentation. Hence, when network fragmentation
occurs, a vehicle cannot pass its IP to the intended vehicle
through existing IP passing protocols and thus incurs longer
handoff latency and higher packet loss rate.
To improve existing IP passing protocols [8] [12], we
propose an IP passing protocol for VANETs with network
fragmentations. In the proposed protocol, when a vehicle is
going to leave the target BS and network fragmentation occurs,
although the vehicle can not pass its IP address to the intended
vehicle, it still will pass its IP address to the vehicle that
remains in the target BS and thus postpones the time to release
its IP address to the DHCP server (extend IP lifetime). During
2011 Fifth International Conference on Innovative Mobile and Internet Services in Ubiquitous Computing
978-0-7695-4372-7/11 $26.00 © 2011 IEEE
DOI 10.1109/IMIS.2011.67
49
The vehicle (mobile node) receives and keeps the passed IP.
LMN
The vehicle (mobile node) leaves target BS's communication region.
The vehicle (KMN) moves from time T1 to T2.
KMN
EMN
T1 T2
KMN
T3T4
KMN
The vehicle (mobile node) enters target BS's communication region.
The vehicle (KMN) moves from time T3 to T4.
EMN
T1T2 The vehicle (EMN) moves from time T1 to T2.
KMN’
KMN’
EMN’
before break phase, and the route redirection phase. In the
information collecting phase, each mobile node (vehicle) will
broadcast its own and its neighboring vehicles’ locations,
moving speeds, and directions periodically. Besides, it should
also rebroadcast the messages it received according to the TTL
(time to live) of the messages to determine the IP passing
direction. If the TTL of message is greater than 0, then the
message should be rebroadcast. The TTL is set according to
the intended size of the virtual bus and the communication
range of the base station. After collecting the information
of the nearby vehicle, a vehicle can realize the neighboring
vehicle’ locations, moving speeds, and directions and thus can
group proper vehicles to form a virtual bus and can select
proper cooperative vehicles to assist it to pass IP address at
the proper moment.
Fig. 4 shows the flowchart of the proposed IP passing
protocol, which contains two phases, the extension of IP
lifetime phase and the IP acquisition phase.
A. Extension of IP lifetime
As shown in Fig. 4, when LMN is going to leave the target
BS’s communication region, if LMN can communicate with
EMN, it follows the existing IP passing protocol to pass its IP
address to EMN. However, if LMN cannot pass its IP address
to EMN due to network fragmentation, LMN will pass its IP
address to KMN through the virtual bus as shown in Fig. 5,
such that LMN does not need to release its IP address to the
DHCP server. Instead, its IP address is kept in KMN so that
the IP address will have more chances to be passed to EMN.
If there is no vehicle behind LMN that is on the lanes of the
same direction, LMN will try to pass its IP address to the
vehicle that is on the lanes of the opposite direction, as shown
in Fig. 6. The IP address can also be passed to the vehicle on
lanes of both directions through the cooperation of vehicles on
the lanes of different directions as shown in Fig. 7. If LMN
cannot find any proper KMN, it will release its IP address via
the DHCP server.
Note that, when KMN receives the IP passing packet from
LMN, it will reply a keep IP ACK packet to LMN and keep
LMN’s IP address. After LMN receives the keep IP ACK
packet, it will break the connection with the target BS. As
time goes by, KMN may approach the border of target BS’s
communication region, it will become LMN and try to pass
the IP address to EMN or other KMN.
B. IP acquisition and handoff procedure
In VANETs, how to reduce the IP acquisition time is a very
important issue. As EMN enters the target BS’s communica-
tion region, EMN still connects to Internet via IEEE 802.16
(WiMAX) with previous access router (pAR) and performs the
following IP acquisition procedure as shown in Fig. 8.
EMN configures interface.
LMN sends an IP pass packet to EMN.
LMN has received an IP passing 
ACK packet from EMN 
LMN disconnects with the target BS.
KMN receives and keeps the passed IP.
LMN can form a virtual bus?
KMN replies a keep IP ACK packet to LMN.
LMN releases IP 
via DHCP server.
Yes
Yes
No
Yes No
No
 
KMN moves to the target BS's region boundary 
No
Yes
LMN is going to leave the target 
BS's communication region. 
EMN sends a DHCP Abort packet to DHCP server.
E
x
te
n
si
o
n
 o
f 
IP
 l
if
et
im
e
IP
 a
cq
u
is
it
io
n
According to the TTL of the messages
to determine the IP passing direction.
EMN sends IP request to DHCP server and sets T               =Timer = 0.
EMN replies an IP passing ACK packet to KMN.
No
EMN has received the passed IP from KMN?
EMN receives a new IP address from the DHCP server.
Yes
LMN disconnects with the target BS.
EMN broadcasts IP request message to KMN.
IP acquisition
TIP acquisition T th+ < TDHCP
 T thTimer >=
TIP acquisition = + TimerTIP acquisition
Set Timer = 0
Yes
No
Fig. 4. The flowchart of our scheme.
CNHA
pAR
DHCP Server
nAR
DHCP Server
nAR
DHCP Server
Internet
LMN KMN
WiMAX/3G/4G BS WiMAX/3G/4G BS WiMAX/3G/4G BS
Fig. 5. LMN passes its IP address to KMN which is on the lanes of the
same direction.
CNHA
pAR
DHCP Server
nAR
DHCP Server
nAR
DHCP Server
Internet
LMN
T1 T2
KMN



KMN
WiMAX/3G/4G BS WiMAX/3G/4G BS WiMAX/3G/4G BS
Fig. 6. LMN passes its IP address to KMN which is on the lanes of the
opposite direction.
51
Virtual Bus
LMN KMN
CNHADHCP Server
nAR
 Target-BS Serving-BS
pAR
 DHCP Server

 
IP Request_DHCP
ﬀﬁ
IP Request_KMN
Acquire unique IP
DHCP Reply
Acquire unique IP
Binding Update
Binding ACK
Packet tunnel (Bitunnel)
Disconnects
Binding Update
Binding Update ACK
Packet tunnel forwarding
ﬂ
ﬂﬃ

Packet forwarding
 (Fail)
Link layer handoff procedure
IP passing
Reply IP passing ACK
Reply
Reply
 
!
"
 IP acquisition th DHCPT T T+ <
 IP acquisition th DHCPT T T+ ≥
ﬀﬁ
IP passing
Reply keep IP ACK
"
"
IP passing
Extension of IP 
lifetime
Request IP
Acquire IP from 
KMN
Acquire IP from 
DHCP
# $%% %&%%&'
# $%% &%&%%&'
EMN
DHCP Abort
Fig. 12. The message flow diagram of IP passing protocol and handoff
procedure.
1
1 SRP−
EMRP
1
SR
P
2
SR
P S
iR
P S
mR
P
1
SR 2
SR SmR
S
iR 1
S
iR +1
S
iR −
1
S
iR
P
−
1
S
iR
P
+
EMN DHCPKMN
2
1 SRP−
1 S
iR
P−
1
1 S
iR
P
+
−
1 S
EMNR
P−
Fig. 13. Markov chains of the scenario that there are vehicles on the lanes
of same direction.
• PRS
i
: is the probability that the IP address kept in KMN
can be passed from vehicle KMN to RSi successfully if
i = 1, or the probability that the IP address kept in KMN
can be passed from RSi−1 to RSi successfully if 2 ≤ i ≤ m(e.g. the distance between two adjacent vehicles is smaller
than their communication range).
• PEMN : is the probability that the IP address kept in KMN
can be passed from RSm to EMN successfully.
• TS average: is the average IP acquisition time for EMN.
The probability that the IP address can be passed from KMN
to the i-th vehicle is
i∏
a=1
PRSa
The probability that the IP address can be passed from KMN
through i vehicles to EMN successfully (denoted as PS pass)
is derived as Equation 1:
PS pass = PEMN
i∏
a=1
PRSa (1)
KMN DHCPEMN
1
SR 2
SR SmR
1
OR 2
OR O
n
ROjR
S
iR
1
O
jR +1
O
jR −
1
S
iR +1
S
iR −
1
OR
P
1
SR
P
2
OSR
P
2
SOR
P
OS
iR
P
SO
jR
P
1
OS
iR
P
+
1
SO
jR
P
+
OS
mR
P
SO
nR
P
2
SR
P
1
S
iR
P
−
S
iR
P
1
S
iR
P
+
S
mR
P
_O EMRP
_S EMRP
2
OR
P
1
O
jR
P
−
O
jR
P
1
O
jR
P
+
O
nR
P
1 1
1 S OR RP P− −
2 2
1 S SOR RP P− −
2
2
1
O
OS
R
R
P
P
−
−
1
S
SO
i
j
R
R
P
P
−
−
1 1
1 S SO
i jR R
P P
+ +
− −
_
1 S EMRP−
1 O OS
j iR R
P P− −
1 1
1 O OS
j iR R
P P
+ +
− −
_
1 O EMRP−
Fig. 14. Markov chains of the scenario that there are vehicles on the lanes
of both directions.
EMN may acquire an IP address either from KMN or from
the DHCP server. Therefore, the average IP acquisition time
for EMN TS average is derived as Equation 2:
TS average = TS pass · PS pass + TDHCP · (1 − PS pass) (2)
, where TS pass is the time required for passing an IP
address from KMN to EMN through the vehicles on the same
direction.
The additional notations used in the second scenario are
defined as follows:
• n: the maximum possible number of vehicles which are
on the lanes of the opposite direction and between KMN
and EMN.
• ROj : is the ID of the j-th vehicle which is on the lanes of
the opposite direction with KMN and is between KMN
and EMN, where 1 ≤ j ≤ n.
• PROS
i
: is the probability that the IP address kept in
KMN can be passed from vehicle ROj−1 to vehicle RSi
successfully, where 2 ≤ i ≤ m.
• PRO
j
: is the probability that the IP address kept in
KMN can be passed from vehicle ROj−1 to vehicle ROj
successfully, where 2 ≤ j ≤ n.
• PRSO
j
: is the probability that the IP address kept in
KMN can be passed from vehicle RSi−1 to vehicle ROj
successfully, where 2 ≤ j ≤ n.
• 1−P
RS
i+1
−PRSO
j+1
: is the probability that the IP address
kept in KMN cannot be passed either from vehicle RSi
to vehicle RSi+1 or from vehicle RSi to vehicle ROj+1
successfully, where 1 ≤ i ≤ m− 1 and 1 ≤ j ≤ n− 1.
• 1−P
RO
j+1
−PROS
i+1
: is the probability that the IP address
kept in KMN cannot be passed either from vehicle ROj
to vehicle ROj+1 or from vehicle ROj to vehicle RSi+1
successfully, where 1 ≤ i ≤ m− 1 and 1 ≤ j ≤ n− 1.
• PS EMN : is the probability that the IP address kept in
KMN can be passed from vehicle RSm to EMN success-
fully.
53
analysis results of our scheme are quite close to the simulation
results, which indicates that our analysis is proper.
B. IP lifetime
0 10 20 30 40 50 60 70 80 90 100
500
1000
1500
2000
2500
3000
3500
4000
 IP passing
 Our scheme
 (a)
 
 
I
P
 
l
i
f
e
t
i
m
e
 
(
m
s
)
Vehicle speed (km/h)
0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0
500
1000
1500
2000
2500
3000
3500
4000
 (b)
I
P
 
l
i
f
e
t
i
m
e
 
(
m
s
)
Vehicle density (vehicles/m)
 IP passing
 Our scheme
0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0
500
1000
1500
2000
2500
3000
3500
4000
 (c)
 
 
 IP passing
 Our scheme
I
P
 
l
i
f
e
t
i
m
e
 
(
m
s
)
Network fragmentation ratio
0 2 4 6 8 10 12 14 16 18 20
600
800
1000
1200
1400
1600
1800
2000
 (d)
 
 
I
P
 
l
i
f
e
t
i
m
e
 
(
m
s
)
Length of IP passing (hops)
 IP passing (80km/h)
 Our scheme (80km/h)
Fig. 16. (a) IP lifetime vs. vehicle speed, (b)IP lifetime vs. vehicle density,
(c) IP lifetime vs. network fragmentation ratio, (d) IP lifetime vs. length of
IP passing (hops).
Fig. 16 shows the impacts of vehicle speed, vehicle density,
network fragmentation ratio and length of IP passing to IP life-
time. As the vehicle density, network fragmentation ratio and
length of IP passing increases, the IP lifetime also increases.
As the vehicle speed increases, the IP lifetime decreases. The
IP lifetime of our scheme is longer than that of the IP passing
scheme because in our scheme, even LMN cannot pass its IP
address to EMN, it will still pass its IP address to the vehicle
that remains in the target BS and thus postpones the time to
release its IP to the DHCP server and extends IP lifetime.
However, in the IP passing scheme, if LMN cannot pass its
IP address to EMN, it will release its IP address to the DHCP
server.
C. Handoff latency
Fig. 17 shows the impacts of vehicle speed, vehicle density,
network fragmentation ratio and length of IP passing to
handoff latency. Since the handoff latency is proportional to
the IP acquisition time, the result is similar to that of the
IP acquisition time. As the vehicle speed, vehicle density,
network fragmentation ratio and length of IP passing increase,
the handoff latency also increases. Among the three schemes,
the handoff latency of our scheme is the lowest, follows by the
IP passing scheme and MIPv6 scheme. Our scheme performs
the best because our scheme has the lowest IP acquisition time;
while MIPv6 has the highest IP acquisition time.
D. Packet loss rate
Fig. 18 shows the impacts of vehicle speed, vehicle density,
network fragmentation ratio and length of IP passing to packet
loss rate. As the vehicle speed, vehicle density, network
fragmentation ratio and length of IP passing increases, the
packet loss rate also increases. Among the three schemes, the
packet loss rate of our scheme is the lowest, follows by the
IP passing scheme and MIPv6 scheme. Our scheme performs
the best because the handoff latency of our scheme is the
0 10 20 30 40 50 60 70 80 90 100
500
1000
1500
2000
2500
3000
3500
4000
 (a)
 
 
 MIPv6
 IP passing
 Our scheme
H
a
n
d
o
f
f
 
l
a
t
e
n
c
y
 
(
m
s
)
Vehicle speed (km/h)
0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0
500
1000
1500
2000
2500
3000
3500
4000
 (b)
H
a
n
d
o
f
f
 
l
a
t
e
n
c
y
 
(
m
s
)
Vehicle density (vehicles/m)
 MIPv6
 IP passing
 Our scheme
0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0
500
1000
1500
2000
2500
3000
3500
4000
 (c)
 
 
 MIPv6
 IP passing
 Our scheme
H
a
n
d
o
f
f
 
l
a
t
e
n
c
y
 
(
m
s
)
Network fragmentation ratio
0 2 4 6 8 10 12 14 16 18 20
600
800
1000
1200
1400
1600
1800
2000
 (d)
 
 
H
a
n
d
o
f
f
 
l
a
t
e
n
c
y
 
(
m
s
)
Length of IP passing (hops)
 IP passing (80km/h)
 Our scheme (80km/h)
Fig. 17. (a) Handoff latency vs. vehicle speed, (b) Handoff latency vs. vehicle
density, (c) Handoff latency vs. network fragmentation ratio, (d) Handoff
latency vs. length of IP passing (hops).
0 10 20 30 40 50 60 70 80 90 100
0
10
20
30
40
50
60
70
80
90
100
 (a)
 
 
 MIPv6
 IP passing
 Our scheme
P
a
c
k
e
t
 
l
o
s
s
 
r
a
t
e
Vehicle speed (km/h)
0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0
10
20
30
40
50
60
70
80
90
100
 (b)
P
a
c
k
e
t
 
l
o
s
s
 
r
a
t
e
Vehicle density (vehicles/m)
 MIPv6
 IP passing
 Our scheme
0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0
0
10
20
30
40
50
60
70
80
90
100
 (c)
 
 
 MIPv6
 IP passing
 Our scheme
P
a
c
k
e
t
 
l
o
s
s
 
r
a
t
e
Network fragmentation ratio
0 2 4 6 8 10 12 14 16 18 20
0
10
20
30
40
50
60
70
80
90
100
 (d)
 
 
P
a
c
k
e
t
 
l
o
s
s
 
r
a
t
e
Length of IP passing (hops)
 IP passing (80km/h)
 Our scheme (80km/h)
Fig. 18. (a) Packet loss rate vs. vehicle speed, (b) Packet loss rate vs. vehicle
density, (c) Packet loss rate vs. network fragmentation ratio, (d) Packet loss
rate vs. length of IP passing (hops).
shortest and thus its connection to Internet is the most stable
and can achieve the lowest packet loss rate. The MIPv6 scheme
performs the worst because its handoff latency is the longest
and thus its connection to Internet is more likely to be broken
and causes higher packet loss rate.
E. Throughput
Fig. 19 shows the impacts of vehicle speed, vehicle density,
network fragmentation ratio and length of IP passing to
throughput. As the vehicle speed, vehicle density, network
fragmentation ratio and length of IP passing increases, the
throughput decreases. Among the three schemes, the through-
put of our scheme is the highest, follows by the IP passing
scheme and MIPv6 scheme. As the handoff latency and packet
loss rate increase, the throughput decreases. Our scheme
performs the best because the handoff latency and packet loss
55
國科會補助計畫衍生研發成果推廣資料表
日期:2011/09/29
國科會補助計畫
計畫名稱: 有效率的水下感測網路媒體存取控制協定之設計
計畫主持人: 許智舜
計畫編號: 99-2221-E-128-002- 學門領域: 計算機網路與網際網路
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
無 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
