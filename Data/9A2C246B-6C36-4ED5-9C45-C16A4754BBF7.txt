2元件間彼此耦合的因素，已不能用傳統元
件的電腦模型來準確地模擬，目前大都是
採用有限元素軟體來模擬這些新一代的電
磁元件。積極尋找新的模型或模擬方法來
模擬新一代的電磁元件已是目前學術界的
一個研究重點。
將磁滯現象加入有限元素的模擬中
也是目前學術界相當熱門的研究題目
[12~19]，因為考慮磁滯現象才能真正捕捉
到電磁元件對電力電子線路所造成的磁場
效應。在目前的研究中，大部分的研究只
是使用簡單的磁滯模型，但卻常常會面臨
無法收斂的問題，而且研究者幾乎都是自
己撰寫程式來求解有限元素的解答。為了
執行電力電子線路之磁場和線路的耦合模
擬，發展有限元素電路模型並在線路模擬
器中模擬似乎是較好的方法，因為電力電
子線路中的半導體元件模型往往相當複
雜，並不容易放入個人撰寫的程式中或放
入一般商業用的有限元素軟體中，所以利
用有限元素之電磁電路模型，在線路模擬
器中執行電力電子之耦合模擬是一個較佳
的選擇。
隨著高頻交換式電源供應器的發
展，電磁元件的尺寸已逐漸縮小，電磁元
件中的熱傳效應在電磁設計中也逐漸成為
重要的考量因素[20~25]。雖然低頻電磁元
件的設計只受限於電磁因素的考量，高頻
電磁元件的設計卻受限於熱傳因素，其中
一個重要的因素為鐵心(core)之溫度不能
超過物理上的 Curie 溫度，而且磁滯也會
因溫度變化而改變其特性，進而造成磁場
的變化。為了降低設計時所花費的時間和
代價，需要發展一個電腦輔助設計模型來
模擬動態的電磁和熱傳之耦合系統，而且
這個電腦模型也應同時考量磁滯、元件結
構、頻率和輸入波形的效果。
本研究發展以有限元素方法為基礎
的電磁/熱傳電路模型，並在OrCAD PSpice
中模擬電磁和熱傳的耦合效應。在參考文
獻[1]中所研發的以有限元素方法為基礎
的熱傳電路模型、考量頻率效應和溫度效
應的磁滯模型[4]、以及在參考文獻[5, 6, 8]
中以有限元素方法推導的電磁元件之電路
模型，被結合起來建構耦合的電磁/熱傳電
路模型。
本研究使用 ABM 類比行為式的模擬
方法[3, 7]將 J-A 磁滯模型融入以有限元素
為基礎的電磁模型中，並安裝於 OrCAD
PSpice 中，再與電磁元件中的熱傳系統耦
合，進而模擬耦合的電磁/熱傳系統之特
性，以便應用於高頻電磁元件的設計過程。
三、理論推導
1. FEM-based 電磁電路模型推導 [5, 6]：
含磁滯的電磁元件之有限元素電路
模型是由以下三個 Maxwell 方程式開始推
導：
0 B (1)
t
BE 
 (2)
DJJH cond  (3)
其中 B 為 magnetic flux density，H 為
magnetic field intensity，E 為 electric field
intensity，D 為 electric flux density，J 為
current density；所使用的材料特性如下：
)(,, 0 MHBEDEJ cond   (4)
其中為 conductivity，為 permittivity，0
為 permeability of free space ， M 為
magnetization。
使用上述公式及有限元素方法，可以
推導出一組常微分矩陣方程式[5]：
mmmm FpKpBpM   (5)
其中未知的系統變數 p 包含所有的有限元
素(finite element)中的未知變數 pe，即元素
中的節點變數(nodal variables)；而系統矩
陣 Mm、Bm、Km 及 Fm 是由每一個有限元素
之常微分矩陣方程式( fkppbpm eee   )
中的元素矩陣m、b、k及 f所組合(assembled)
而成的。在推導過程中，只需推導出 m、b、
k 及 f 等元素矩陣，再由這些元素矩陣推導
出有限元素之等效電路模型，在參考文獻
[5]中，已經證明 m、b、k 及 f 等矩陣可以
分別由電容、電阻、電感及電流源所組成
的等效電路來模擬，而且將所有的有限元
素之等效電路連接起來後，由線路模擬器
所組成的系統矩陣也將是 Mm、Bm、Km 及
Fm，亦即與有限元素方法所推導出的系統
矩陣相同。
2. FEM-based 熱傳電路模型推導 [1]
在電磁元件中的熱傳系統之有限元
4insulating 元素之數量將盡量予以簡化。
(a)
(b)
(c)
圖 2. 2D triangular element 電磁電路模型：(a) ferrite
element；(b) copper element；(c) insulating
element
(B) 1D axisymmetric element 電磁電路模型
(a)
(b)
(c)
圖 3. 1D axisymmetric element 電磁電路模型：(a)
ferrite element ； (b)copper element ； (c)
insulating element
圖 3 所示為以 1D axisymmetric
element 所推導的電磁電路模型，圖 3(a)為
ferrite元素之模型; 圖3(b)為copper元素之
模型；圖 3(c)為 insulating 元素之模型。此
種 1D電磁電路模型可以用來模擬 2D的環
形電磁元件，以加快模擬速度。同樣地，
因為本研究之重點在研究鐵心內部的電磁
/熱傳耦合效應，所以線圈之 copper 元素和
絕緣體或空氣之 insulating 元素之數量將
盡量予以簡化。
2. FEM-based 熱傳電路模型建構
(A) 2D triangular element 熱傳電路模型
圖 4 所示為以 2D triangular element
所推導的熱傳電路模型，圖 4(a)為 ferrite
元素之模型; 圖 4(b)為碰觸空氣邊界的 2D
convective 熱傳電路模型。為了簡化熱傳電
路模型，本研究只考慮在鐵心的傳熱效
果，忽略線圈的銅損(copper loss)和絕緣體
的傳熱效果，所以在熱傳方程式中，熱源
來自於鐵心本身的內部熱生成密度 g，而
由邊界輸入的 input power P 並不考慮，如
果以後要研究銅損對鐵心溫度的影響，則
應加以考慮。
6磁滯模型中的參數：Ms、a、c、k 及α，
並利用在不同的溫度所測量得到的動態
(高頻)磁滯曲線數據來粹取頻率響應參
數：Ldyn、Rdyn及 Cdyn，這些參數以片段線
性模擬方式組合成溫度的函數，以便應用
於耦合的電磁/熱傳系統之模擬。在耦合的
電磁/熱傳系統中，每一個有限元素同時包
括電磁模型和熱傳模型。
4.模擬測試與討論
為了簡化繁複的模擬過程，並考量收
斂問題，我們先嘗試使用 1D axisymmetric
element 去模擬電磁/熱傳耦合的 2D 環形
電磁元件(toroid)，此元件之結構如圖 7 所
示，初級和次級線圈在模型推導時只以一
圈表示，最後可以在初級和次級線圈模型
中各加一個不同圈數比的理想變壓器來改
變初級和次級的圈數比。
r
primary winding conduc tor
secondary winding conductor
fe rrite
air
infini te e lem ent
0

圖 7. 一個利用 1D 軸心對稱有限元素方法模擬的
toroid 電磁元件
本 研 究 使 用 的 電 磁 元 件 為
768T188-3C85 toroid，初級及次級線圈各
18圏，在模擬中使用的材料特性如下：(a)
在 ferrite element 中，ε= 1.9x105ε0，σ
=0.625/(Ω-m)， thermal conductivity κ =
4W/(m-K)，specific heat cp = 1.1J/(g-K)，
mass density ρ = 4.7x106g/m3，convective
參數 h = 11.2W/(m2-K) ； (b) 在 copper
element 中，ε=ε0，σ= 5.8x107/(Ω-m)，
ν=ν0；(c)在 insulating element 中，ε =
ε0，σ= 0，ν=ν0。
本實驗所使用的測試電路如圖 8 所
示，其中弦波訊號之 Vm = 20V， f =
10kHz。
圖 8. 用於電磁/熱傳系統耦合模擬的測試電路
為了驗證所發展的電磁/熱傳耦合電
路，我們比較了圖 7 中的五個 ferrite 元素
中的 H 和 B 之模擬值與實驗值，圖 9(a)所
示為 H 之模擬值與實驗值之比較，圖 9(b)
所示為 B 之模擬值與實驗值之比較，其中
的虛線為模擬值，實線為實驗值，而實驗
值是由測量的電壓和電流與電磁元件之有
效磁通路徑和截面積計算而得，所以如預
期的，實驗值接近中間 (第三個)有限元素
之模擬值，而且越靠近外圍的元素，所得
到的 H 和 B 之值越小。
(a)
(b)
圖 9. (a) H；(b) B 之模擬值與實驗值之比較：虛線
為模擬值，實線為實驗值
因為熱傳系統的時間常數遠大於電
磁系統的時間常數，為了讓溫度上升至穩
