 II
Abstract 
 
As the 3G systems have been deployed and commercialized, research institutes, 
major equipment providers as well as operators from all over the world had joined 
forces to look into future generations (beyond the third generation, B3G) of wireless 
communications, creating the Wireless World Research Forum (WWRF). 
It is expected that the air interface will be playing the central role of the B3G 
wireless network. In this report, we propose a new broadband wireless mobile access 
architecture that is suitable for high-speed multimedia wireless transmission, predict 
its overall performance, and validate its feasibility. We produce simulation programs 
so that future users can emulate the performance of our joint design. This joint effort 
consists of tree sub-projects, namely, 
1. Multi-channel multi-rate spreading sequences technologies. 
3. Space-time signals processing and multi-user detection. 
4. Synchronization, channel estimation and inner receiver design. 
It is clear that each sub-project studies a vital part of a broadband wireless 
mobile transmission system and all of them are closely coupled. For detailed 
description of each sub-project please refer to the sub-project reports. 
 
Keywords: Wireless Communications, Mobile Radio Access Technologies, B3G. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 IV
3.2.2.2.3 Wideband Adaptive Array Antenna with Code Adjustment.27 
3.3 Simulation results and Conclusion………………………………………...29 
4. 下一世代無線行動接取技術-子計劃四:同步、通道估計與內接收機設計…35 
4.1 Introduction………………………………………………………………..36 
4.2 Modelling of Correlated MIMO Channels………………………………...37 
4.2.1 System Setup…………………………………………………………37 
4.2.2 Wideband MIMO Channels………………………………………….37 
4.2.3 Modelling spatial correlations……………………………………….38 
4.3 Model-Based Space-Time Channel Estimation…………………………...42 
4.3.1 Space-Time Channel Estimation for Correlated Block-Fading 
Channels.……………………………………………………………………..43 
4.3.1.1 Phase I - Coefficient Estimation………………………………..43 
4.3.1.2 Phase II - Direction Estimation…………………………………44 
4.3.2 Channel Estimation for Frequency-Selective Time-Varying Fading 
Channels……………………………………………………………………...46 
4.3.2.1 Phase I - Coefficient Estimation………………………………..48 
4.3.2.2 Phase II - Direction Estimation…………………………………48 
4.4 Performance Analysis……………………………………………………..50 
4.4.1 Channel Estimation Error for Correlated Fading Channels………….50 
4.4.2 Coefficient Estimation Error with Estimated Directional Matrix…....50 
4.4.3 Directional Estimation Error with Near Optimal Coefficient Matrix..53 
4.5 Numerical Results and Discussion………………………………………...54 
4.6 Conclusion…………………………………………………………………56 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 VI
Fig. 3-18 The different length of spreading code for Multicode systems……………34 
Fig. 4-1 “One-ring” model with M transmit antennas at BS and N receive antennas at 
MS. D: distance from BS to MS. R: radius of the scatterer ring. φ: angle of departure. 
Δ: angle spread at BS. dT: antenna spacing at BS. dR: antenna spacing at MS………57 
Fig. 4-2 Mean square identification errors for different modelling orders. Solid 
curves: angle spread Δ=2°. Dotted curves: angle spread Δ=15°……………………...58 
Fig. 4-3 AOD estimation based on the directional matrix W at SNR = 10 dB; AOD 
φ=45° and angle spread Δ=2°. The upper bound and lower bound are determined by 
the angle spread………………………………………………………………………58 
Fig. 4-4 Channel Estimation with different modelling order at SNR=10dB and 
Δ=15°…………………………………………………………………………………59 
Fig. 4-5 Performance comparison of Algorithm B (--) and Algorithm C (-)……….59 
Fig. 4-6 MSE performance of Algorithm C under channel model in [3] with 
difference angle spread……………………………………………………………….60 
Fig. 4-7 MSE performance of Algorithm C under SCM model with difference angle 
spread………………………………………………………………………………...60 
 
 2
2. 下一世代無線行動接取技術-子計劃一:多通道多速率展頻技術 
2.1 Introduction 
There have been recent interests in applying multi-carrier modulation techniques 
for providing frequency diversity in wireless communication systems. One of the 
famous techniques is multi-carrier direct-sequence code-division multiple access 
(MC/DS-CDMA) [1], [2]. In general, a given frequency spectrum is divided into M 
frequency bands (or carriers), and each carrier is used to convey a time-spreading 
code sequence. This kind of MC/DS-CDMA schemes has several advantages over 
single-carrier DS-CDMA systems, including narrowband interference suppression, 
multi- path fading robustness, and lower chip rate [3]. Therefore, multi-carrier 
systems requires lower-speed parallelized signal processing in contrast to faster-speed 
serialized signal processing required in single-carrier systems. 
In the third-generation (3G) mobile standards, such as UMTS/IMT-2000 [4], 
there are two major approaches to serve variable-rate requirements for different users: 
multi-code wideband-CDMA (W-CDMA) [5] and W-CDMA with orthogonal 
variable spreading factors (OVSF) codes [6]. Nevertheless, these two multi-rate 
schemes were proposed for single-carrier CDMA systems only. To support 
variable-rate services in multi-carrier systems (i.e., to bridge the gap created by [1], 
[2], [5], and [6]), we present a multi-rate MC/DS- CDMA scheme in this project and 
focus on the OVSF approach in order to illustrate the orthogonality of our 
two-dimensional (2-D) OVSF codes in different layers of a code tree. The proposed 
2D OVSF codes offer code and frequency diversities and, hence, is appropriate to the 
multi-carrier scheme to flexibly offer multimedia services. 
 
2.2 Constructions of the 2D OVSF Codes 
Our 2-D OVSF codes can be conveniently generated in a tree structure and 
maintain orthogonality in the code tree. Thus, these 2-D OVSF codes can eliminate 
multiple access interference (MAI) and improve the capacity and throughput of 
multi-rate, multimedia MC/DS-CDMA systems. Here, mutual orthogonality is defined 
as having i) autocorrelation side- lobes of zero for all time shifts, except the zero shift, 
for every code matrices in the code tree and ii) cross-correlation functions of zero for 
all time shifts between any two code matrices with the same spreading factor in the 
code tree. 
Fig. 2-1 shows an example of the 2-D OVSF code tree, in which the numbers of 
rows and columns increase with the layer number h. Layer 1 (i.e., h = 1) involves two 
orthogonal matrices ⎥⎦
⎤⎢⎣
⎡
++−+
−+++=×)1( 42C  
 4
Fig. 2-2, in which )1( 3216×C  and
)7(
168×C  of Fig. 2-1 are assigned to the transmitters of users 
1 and 2, respectively.  
)cos(2 1tP ω
)cos(2 2tP ω
82 cos( )P tω
2,1( )C t
2,2 ( )C t
2,8 ( )C t
2 ( )b t
×0
×
××
×
×
●
●
●
●
●
●
●
●
∑
User 2
2 times data rate
8X16 spreading 
code matrix, 
C(7)8X16
)cos(2 1tP ω
)cos(2 2tP ω
162 cos( )P tω
1,1( )C t
1,2 ( )C t
1,16 ( )C t
1( )b t
×
×
××
×
×
●
●
●
●
●
●
●
●
∑
User 1
Basic data rate
16X32 spreading 
code matrix, 
C(1)16X32
 
Fig. 2-2 Transmitters of two users with matrices from different code tree layers for 
multi-rate transmission. 
Since user 1 has a matrix size of 16 × 32 and user 2 has a matrix size of 8 × 16, 
user 2 can transmit twice the number of data bits with half the number of carriers of 
user 1. Thus, the data rate of user 2 is doubled and the code matrix assigned to user 2 
can also be assigned to another same rate user by utilizing the other half of the carriers. 
From the code tree in Fig. 2-1, twelve code matrices can be used without destroying 
orthogonality in different layers if four 8×16 code matrices are assigned for 
double-rate transmissions and eight 16×32 code matrices are assigned for basic-rate 
transmissions. In fact, the system can support four more double-rate users by sharing 
the four 8 × 16 code matrices with different carriers, supporting a total of sixteen 
users. Let us consider a multi-carrier DS-CDMA system with Q different data rates. 
The data-bit streams at different rates are modulated by the spreading code matrices 
of different lengths extracted from our OVSF code tree. For example, in the code tree 
of Fig. 2-1, we have =cT  ===== LL qq NTNTNT bbb 222211 11 22 −− QQ NTb , 
where qbT 2  and qN 2  are the bit duration and corresponding matrix length (or 
so-called processing gain) of the rate-2q users, respectively. 1N  is the basic-rate 
processing gain and .2
2121
q
bb qq
TTNN ==  All rates are assumed to be integral 
multiples of the basic rate. As the number of carriers reduces with the matrix length, 
the rate-2 users use only half of the carriers of the basic-rate users, the rate-4 users use 
 6
][][][ IVARVARZVAR += η            (2.4) 
The signal-to-noise ratio (SNR) can be written as  
][][
][
][
][SNR
22
IVARVAR
ZE
ZVAR
ZE
+== η        (2.5) 
In an AWGN channel, the amplitude and phase distributions are given by =)(ααp  
)1( −αδ and ),()( θδθθ =p  respectively, corresponding to a non-fading amplitude 
and zero carrier phase. In this case, we have the Rician parameter )2( 22 σvR =  
means the power ratio between the line-of-sight and the scattered signals and that 
,12 =v  ,02 2 =σ ,∞→R  and .0'
,2
=
mk q
θ  The bit error probability (BEP) of user 
'
2q
k of rate '2 q is then given by  
)SNR(QPe =                 (2.6) 
where ∫ ∞ −= x dzzQ )2exp()21( 2π is the Q-function. 
2.4.2 Error probability under a Rician fading channel 
In a Rician channel, the average bit error probability can be written as 
⎟⎟⎠
⎞
⎜⎜⎝
⎛
++⋅
⎟⎟⎠
⎞
⎜⎜⎝
⎛
++Γ
+Γ=
×= ∫ ∞
γ
γπ
γγγ γ
m
mmmF
m
m
m
m
dfQP
m
e
;1;,
2
1
)1(
)21(
2
1
)()2(
12
0
     (2.7) 
where ),(SNR u=γ ∑
+×−
+×−=
= ''
'
2
'
'
2
2
22
)2,1'mod(
1
2
)2,1'mod(
,'
qq
q
q
q
q
q
q
MMk
Mkm
mku α   
and ( ) ∑∞= ⋅⋅= 012 ]!)[(])()([;;, n nnnn nczbazcbaF  is the Gauss hypergeometric series 
where .)()()( xnxx n Γ+Γ= The random variable γ  with the probability density 
function (p.d.f.) )exp())(()( 1 γγγγγ ⋅−⋅⋅⋅Γ= −Γ mmmf mmm  is said to have a 
Gamma distribution function with parameters ][/(][ 22 ηγ ESE=  
])[ 2IE+ and )12()1( 2 ++= RRm . 
2.4.3 Error probability under a Rayleigh fading channel 
In a Rayleigh fading channel, the amplitude and phase distributions are Rayleigh 
and uniform, respectively. In this case, we have ,0=R  ,02 =v  ,12 2 =σ  and 
.21'
,2
πθ =
mk q
 If we assume the flat Rayleigh fading model and fixed noise level, the 
 8
the code orthogonality cannot be destroyed by a non-fading channel. The argument of 
longer code length adding more diversities is not applicable in this case because of no 
MAI created by the 2-D OVSF codes.  
Figs. 2-4 and 2-5 show the average BEP Pe versus the 
input-energy-per-bit-to-noise- energy ratio 0ηbE  under a Rician fading channel 
with R = 10 dB and with the equal gain combining (EGC) reception method. The 
symbols in Figs. 2-4 and 2-5 (i.e., circles and pluses) represent the results from 
computer simulations and the curves come from the corresponding Pe equations 
derived in Section 2.4.2. The 2-D OVSF codes are effective in the Rician channel 
because the fading effect is weak and the code ortho- gonality is mostly preserved. As 
seen from both figures, the difference for the HR users is larger than the difference for 
the LR users. It is because the LR users use longer code matrices than the HR users. 
In general, from both figures, the performance of the LR users is always better than 
the HR users because the LR users have longer code length and, thus, larger spreading 
gain. We also note that the performance improves with the number of HR users when 
the total number of users is fixed. It is because each HR user employs only half of the 
total bandwidth and the other half can be used by another HR user. For example, the 
case of HR=10 and LR=6 is equivalent to 11 LR users, and the case of HR=6 and 
LR=10 corresponds to 13 LR users. In other words, the MAI gets stronger when there 
are more LR users.  
0 2 4 6 8 10 12
10-4
10-3
10-2
10-1
E
b
/η0(dB) 
B
it 
E
rr
or
 P
ro
ba
bi
lit
y 
P e
HR=10,LR=6,HR
HR=10,LR=6,LR
HR=10,LR=6,HR(theoretical)
HR=10,LR=6,LR(theoretical)
 
Fig. 2-4. Bit error probability eP  versus 0ηbE  under a Rician fading channel with 
R=10 dB and with the EGC reception method. (HR=10, LR=6) 
 
 10
2.5 Conclusions 
In this project, we have studied an MC/DS-CDMA system with our 2-D OVSF 
codes for supporting multi-rate, multimedia services. By using a tree structure, we 
could easily generate the 2-D OVSF code matrices recursively, without the restriction 
on the relationship between the number of carriers and code length. Moreover, the 
performance of the proposed scheme using EGC reception method was analyzed. Our 
results showed that our proposed scheme was suitable for supporting multi-rate, 
multi- media services in an AWGN channel or a Rician fading channel. In such 
channels, the MAI level could be significantly reduced in the proposed system 
because the orthogonality of the 2-D OVSF codes was preserved and, thus, MAI 
caused by the specular terms could be eliminated. Moreover, the data rate could be 
effectively increased and the system could support more simultaneous users for a 
given BEP. 
 
Reference: 
 
[1] S. Kondo and L.B. Milstein, “Performance of multicarrier DS CDMA systems,” 
IEEE Trans. Commun., vol. 44, no. 2, pp. 238-246, Feb. 1996. 
[2] S.-M. Tseng and M.R. Bell, “Asynchronous multicarrier DS- CDMA using 
mutually orthogonal complementary sets of sequences,” IEEE Trans. Commun., 
vol. 48, no. 1, pp. 53-59, Jan. 2000. 
[3] L.B. Milstein, “Wideband code division multiple access,” IEEE J. Select. Areas 
Commun., vol. 18, no. 8, pp. 1344-1354, Aug. 2000. 
[4] E. Dahlman, B. Gudmundson, M. Nilsson, and J.Skold, “UMTS/IMT- 2000 
based on wideband CDMA,” IEEE Commun. Mag., vol. 36, no. 9, pp. 70-80, 
Sep. 1998. 
[5] C.-L. I, C.A. Webb III, H.C. Huang, S. T. Brink, S. Nanda, and R.D. Gitlin, 
“IS-95 enhancements for multimedia services,” Bell Labs Technol. J., pp. 60-87, 
Autumn 1996. 
[6] T. Minn and K.-Y. Siu, “Dynamic assignment of orthogonal variable spreading 
factor codes in W-CDMA,” IEEE J. Select. Areas Commun., vol. 18, no. 8, pp. 
1429-1440, Aug. 2000. 
[7] C.-M. Yang, G.-C. Yang, P.-H. Lin, and W. C. Kwong, “2-D orthogonal 
spreading codes for multicarrier DS-CDMA systems,” in Proc., IEEE Int. Conf. 
Commun., May 2003, vol. 5, pp. 3277-3281. 
[8] E. Sourour and M. Nakagawa, “Performance of orthogonal multi- carrier 
CDMA in a multipath fading channel,” IEEE Trans. Commun., vol. 44, no. 3, 
pp. 356-367, Mar. 1996. 
[9] S.G. Glisic, Advanced Wireless Communications: 4G Technologies. Chichester, 
England: John Wiley & Sons, 2004. 
[10] Y. Huang and T.-S. Ng, “DS-CDMA with power control error using weighted 
despreading sequences over a multipath Rayleigh fading channel,” IEEE Trans. 
Veh. Technol., vol. 48, no. 4, pp. 1067-1079, July 1999. 
[11] M.-S. Alouini and M.K. Simon, “Performance analysis of coherent equal gain 
combining over Nakagami- m fading channels,” IEEE Trans. Veh. Technol., vol. 
 12
3. 下一世代無線行動接取技術-子計畫三:時空信號處理及多用戶檢測 
3.1 Introduction 
The MIMO-OFDM communications is a promising choice for future high data 
rate wireless systems. OFDM is a powerful technique employed in communications 
systems suffering from frequency selectivity. MIMO is a useful technology with 
significant data rate improvements of single-input-single output (SISO) systems. In 
this project, we apply smart antenna array in transmitter and receiver to represent the 
MIMO configuration. In time-varying multipath fading channels, both intersymbol 
interference (ISI) and multiple access interference (MAI) must be considered. Smart 
antenna provides the ability to mitigate the MAI effect by adaptive beamforming. 
Much research on spatial and temporal signal processing using an adaptive 
antenna array has been pursued in recent years. The LMS algorithm requires less 
computation and its significant feature is simplicity, while the RLS algorithm 
provides a much faster convergence, and is relatively independent of the eigenvalues 
spread compared to the LMS algorithm. Therefore, we will propose symbol-based 
adaptive antenna receiver structures without the need of calculation of the correlation 
matrix in this project. We consider an MIMO-OFDM-DS/CDMA communication 
system, which utilizes a transmit antenna array at the BS and a receive antenna array 
at the MS. 
It is a good idea to combine with multi-rate and dynamic allocation of bandwidth 
resources among the users. In the literatures, three access methodologies are provided 
for multi-rate CDMA; they are VPG, VCR and Multicode transmissions. The VPG 
systems use different length of spreading code at different data rate and lead to the 
fact that all the users have identical chip rate. But it needs to increase processing gain 
for the low rate data. On the other hand, the high data rate is based on small 
processing gain that results in the degradation of the system performance. For the 
VCR systems, data streams at different rates are spread by the codes with same length, 
i.e., different chip rates are used at different rate users and the available bandwidth is 
incomplete used by the low rate users. In Multicode systems, each data stream is 
converted to several basic rate streams by the serial-to-parallel device. These lower 
rate substreams are spread over the same bandwidth for transmissions.  
In this project, we propose and compare the receivers for the above-mentioned 
multirate CDMA systems. Smart antennas improve the system performance by 
increasing channel capacity and spectrum efficiency and extending range coverage. 
Delay spread and multipath fading can be mitigated by an antenna array that is 
capable of beamforming in certain direction and nulls in others. Adaptive antenna or 
smart antenna for CDMA systems can improve the performance of wireless radio 
systems. CDMA systems always accompany with time-varying multipath fading 
 14
  
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢
⎣
⎡
=
L
L
L
H
HH
HH
H
HH
H
H
000
0
0
0
0
0
00
2
1
2
12
1
L
MOM
MOM
O
OM
OM
MO
L
(                                    (3.4) 
where HH ×= 11 a , Ll L,1= . H~  is normalized H
(
. Next, we represent the transmitted 
signal matrix S(n) as follows 
( ) ( ) ( ) ( )[ ]
( )( ) ( )( ) ( )( )
( )( ) ( )( ) ( )( )
( ) ( ) ( ) ⎥⎥
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢⎢
⎢
⎣
⎡
+−+−+−
+−+−+−
=
=
QnsQnsQns
nQsnQsnQs
nQsnQsnQs
nnnn
N
N
N
N
L
MOMM
L
L
L
21
21
21
21
212121
111111
sssS
   ( ) ( ) ( )[ ]TQ nnn zzz L21=  
( )nqz  is the q-th chip time signal of S(n). We rewrite transmitted signal matrix as 
( ) ( )
( ) ( ) ( )
( ) ( ) ( ) ( )
Q,1,q  ,
122
122
L
L
MMMM
L
=
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢
⎣
⎡
=
−−−
−−−
nnn
nnn
n
qqLq
qqLq
q
zzz
zzz
S  
we make ( )nqS  multiplied by H~  
  ( ) ( ) ( )nnn qq VSHR += ~  
where V(n) is the zero mean and white Gaussian noise. The sum of elements on the 
diagonal of ( )nqR  is what we want. Make ( )nqx  represent the sum of elements on the 
diagonal of ( )nqR . The baseband signal transmitted through channel can be 
represented as ( )nqx . 
3.2.1.2 Narrowband Adaptive Receiver 
3.2.1.2.1 LMS-Based Receiver 
We propose a MIMO-OFDM-DS/CDMA adaptive antenna receiver. As we 
mentioned before, antenna array is a appropriate description to MIMO channel model. 
The weight vector of the adaptive antenna is denoted as 
( ) ( ) ( ) ( )[ ]HkMkkkLMS wwwn 110, −= Lw          (3.5) 
The received signal matrix as 
( ) ( ) ( ) ( )[ ]nnnn QxxxU L21=           (3.6) 
Obviously, each element in the received signal matrix U(n) is QPSK signal. We get 
the despreader output sequence ( )nd kLMSe ,,  and can be described as 
( ) ( ) ( ) Qnnnd kLMSHHkkLMSe /,,, wFUc=          (3.7) 
where ( )nd kLMSe ,,  is the received signal sequence of the desired user. The cost function 
of adaptive algorithm known as the complex LMS algorithm is the expected value of 
signal error. So, the cost function can be represented as follows: 
 16
( ) ( ) ( )
( ) ( ) ( ) ( )[
( ) ( ) ( )
( ) ( ) ( ) Qnnn
Qnnnd
QnnnnE
QnnndEJ
kkLMS
HH
kLMS
kLMS
HH
kLMSk
kLMS
H
kLMSkLMS
HH
kLMS
kLMS
HH
kLMSkLMSCA
dcFUw
wFUc
FcUwwFUc
wFUc
,,
,,
*
2
,,,,
2
,,
−
−
=
⎥⎦
⎤⎢⎣
⎡ −=
 
( ) ( )]ndnd kk *+            (3.13) 
Take gradient of the cost function by the code vector we obtain 
( ) ( ) ( ) QnnnJ kLMSCAkLMSH
kLMS
LMSCA *
,,
,
2 ewFU
c
−=∂
∂         (3.14) 
where kLMSCAe ,  denotes the error for the desired user. The update equation of the 
weight vector for this receiver is the same as 
( ) ( )
kLMS
LMS
wnkLMSkLMS
Jnn
,
_,, 21 w
ww ∂
∂−=+ μ         (3.15) 
The update equation of the despreader vector coefficients for this receiver is shown as 
follows 
( ) ( )
kLMS
LMSCA
cnkLMSkLMS
Jnn
,
_,, 21 c
cc ∂
∂−=+ μ          (3.16) 
3.2.1.2.3 RLS-Based Receiver 
Generally, recursive least squares (RLS) filter is faster than LMS filter in aspect 
of convergence speed. However, it is a tradeoff between convergence speed and 
computational complexity. The computation complexity of recursive least squares 
filter are more than LMS filter. The update equation of weight vector and code vector 
coefficients for RLS algorithm will be derived in following paragraph. Just like what 
we define in the above section, the weight vector for RLS algorithm is denoted as 
( )nkRLS ,w  as follow 
( ) ( ) ( ) ( ) ( ) ( ) ( )[ ]HkMkkkRMS nnnn 110, −= wwww L  
We get the despreader output sequence ( )nd kRLSe ,,  and can be described as 
( ) ( ) ( ) Qnnnd kRLSHHkkRLSe ,,, wFUc=  
Define the least squares cost function as the following, 
( ) ( ) ( )
( ) 2,
1
1
2
,
ie
QnnidJ
kRLS
in
n
i
n
i
kRLS
HH
kk
in
RLS
−
=
=
−
∑
∑
=
−=
λ
λ wFUc
        (3.17) 
where λ is the forgetting factor, and ( )ne kRLS ,  denotes the error vector for the desired 
user. In order to derive the weight update equation for RLS algorithm, it is necessary 
to compute 0
,
JRLS
RLS k
∂ =∂w . Then, compute the gradient of the above cost function and then 
obtain 
( ) ( ) ( )[
( ) ( ) ]Qidi
QniiJ
kk
H
kRLS
HH
kk
n
i
in
kRLS
RLS
cFU
wFUcFcU
w
2
2 2,
1,
−
=∂
∂ ∑
=
−λ
 
 18
channel
channel
 
Figure 3-1. The transmitter of variable processing gain systems 
 
In VPG system, each user has the same chip duration, and the spreading code 
consists of Qi chips with duration Tc which is equal to i
i
T
Q , where Ti denote the 
symbol duration of the user at rate i. The transmitted signal of k-th user at rate i can be 
represented as 
( ) ( ) ( )( ) ( ) ( )k k ki i i i
n
s t b n p t nT
∞
=−∞
= −∑         (3.25) 
where ( ) ( )kib n  is the i.i.d. information-bearing sequence, 
( ) ( )kip t  is the spreading 
sequence defined by 
( ) ( )
,
1
( ) ( ) ( )
iQ
k k
i i vpg c
l
p t c l w t lT
=
= −∑          (3.26) 
where w(t) is chip pulse shape and Qi is the processing gain for rate i. All users use the 
same bandwidth and the chip duration Tc, which is defined as 
1 2
1 2
N
c
N
TT TT
Q Q Q
= = = =L           (3.27) 
The relation between the symbol duration of each user and Tbr shows as following 
1 2
1 2
N br
N
T TT T
m m m M
= = = =L           (3.28) 
where m1,m2,…,mn are co-prime integers which indicate the rate ratio, 1
N
i iM m== ∏  
is the least common multiple of mi. 1/Tbr is regarded as basic rate. Define Q as the 
greatest common divisor of Q1…QN, it is defined as Qi=Qmi. Introduce a new 
parameter 
i
M
i mq =  for future use, then rate i is qi times the basic rate. Then, we have 
 20
3.2.2.1.2 Variable Chip Rate (VCR) Systems 
In VCR systems, the spreading code at the lower chip rate can be regarded as a 
mi-chip repeating version of the code at the higher rate. We must consider frequency 
allocation owing to the different bandwidth required by different chip-rate users as 
shown in Fig. 3-3. Length-Q spreading codes with N chip rate groups are 
Group 1
Group 2
21 Q
21 Q
Group N21 Q
 
Figure 3-3. Length-Q spreading codes with N chip rate groups 
Group 1: code family {c1} with chip rate g1 
Group 2: code family {c2} with chip rate g2 
M  
Group N: code family {cN} with chip rate gN 
 
For VCR communication systems, as shown in Fig. 3-4, the data rate of different 
users are spreading by the same processing gain, i.e., the chip duration of each user is 
different but the length of the spreading code is identical. The relation between the 
same processing gain and the chip duration for different data rate, as follows 
1 2
(1) (2) ( )
N br
N
c c c c
T TT TQ
T T T T
= = = = =L         (3.33) 
channel
channel
 
Figure 3-4. The transmitter of variable chip rate systems 
 
 22
S/P channel
channel
 
Figure 3-5. The transmitter of multicode systems 
3.2.2.2 LMS-Based Algorithms 
3.2.2.2.1 Narrowband Adaptive Array Antennas 
3.2.2.2.1.1 VPG Systems 
Σ
Despreader DD ∑
-
+
Despreader DD ∑
-
+
LMS Algorithm
(1) ( )iy n
( ) ( )kiy n
(1)
,0 ( )iw n
(1)
,1 ( )iw n
(1)
, 1( )i Pw n−
Σ
( )
,1 ( )
k
iw n
( )
, 1( )
k
i Pw n−
Σ
( )
,0 ( )
k
iw n
0 ( )x n
1( )x n
1( )px n−
 
Figure 3-6. Narrowband adaptive antenna for VPG and VCR systems 
We consider the weight update of the narrowband adaptive antennas through 
despreaded operation for CDMA communications. The block diagram of our 
proposed narrowband adaptive antenna receiver is shown as Fig. 3-6 but without the 
update of despreading code. The antenna receiver with despreading code update will 
be introduced later. Clearly, we must realize the property of multi-rate systems and 
attempt to compare desired signal with despreader output sequence for all users. The 
 24
(
2( ) ( ) ( )
, ,
1 1
( ) ( ) ( ) ( ) 2
, , , ,
1 1
( ) ( ) ( ) ( )
, , ,
( ) ( ) ( ) ( )
( ) ( ) ( ) ( ) ( ) ( )
( ) ( ) ( ) ( ) (
i
i
KN
k H k k
vpg i vpg i i vpg i i
i k
KN
k H k k H H k
i vpg i i vpg i vpg i i vpg i
i k
k k H H k k H
i i vpg i i vpg i i vpg
J E n n n Q d n
E n n n n n n Q
d n n n n Q n
= =
= =
⎡ ⎤= −⎢ ⎥⎣ ⎦
⎡= ⎢⎣
− −
∑∑
∑∑
w U c
w U c c U w
c U w w ( ) ( )*,) ( ) ( ) ( )
k k
i i vpg i in n d n QU c
   ( ) ( )*( ) ( )k ki id n d n ⎤+ ⎦          (3.44) 
where the superscript “*” represents complex conjugate. In optimal beamforming 
techniques of the adaptive antennas, a weight vector is determined which minimizes a 
cost function and then LMS algorithm is employed. In order to minimize a cost 
function, we need to compute the gradient of the cost function, is defined as 
( )
,
( ) ( ) ( ) 2 ( ) ( )*
, , , ,( )
2 ( ) ( ) ( ) ( ) ( ) 2 ( ) ( ) ( )vpgk
i vpg
J k k H H k k k
i i vpg i vpg i i vpg i i i vpg i in
n n n n n Q n n d n Q∂∂ = −w U c c U w U c
  ( )* ( ), ,2 ( ) ( )
k k
i vpg i i vpg ie n n Q= U c        (3.45) 
and the weight vector of the adaptive antenna of k-th user at rate i can be updated as 
follows 
( )
,
( ) ( )
, , ( )
( 1) ( ) vpgk
i vpg
Jk k k
i vpg i vpg i n
n n μ ∂∂+ = − ww w       (3.46) 
where kiμ  is the step size. Finally, the updated equation of weight vector of each user 
can be rewritten as  
( ) ( ) ( )* ( )
, , , ,( 1) ( ) 2 ( ) ( )
k k k k k
i vpg i vpg i i vpg i i vpg in n e n n Qμ+ = −w w U c     (3.47) 
3.2.2.2.1.2 VCR Systems 
The receiver structure of VCR system is similar to VPG system as shown in Fig. 
3-1. The weight vector and received matrix have the same form as (3.39) and (3.41) 
respectively. The only difference of the antenna receiver between VCR and VPG 
systems is the initial value of the despreading code vector that is ( ) ( ), ,(1)
k k
i vcr i vcr=c c  as 
(3.36). The updated equation of weight vector is thus the same as (3.47). 
3.2.2.2.1.3 Multicode Systems 
In spite of the serial-to-parallel operation is performed in transmitter in 
Multicode systems, we replace parallel-to-serial operation by summation to 
accumulate “error signal” in receiver as shown in Fig 3-7. The reason of accumulation 
of error signal will be explained later. 
 26
Umc(n) is similar to Ui(n) as (3.41). The received matrix Umc(n) in Multicode systems 
has the same length for all virtual users. The despreader output sequence ( , ), ( )
k l
i mcy n  
can be described as 
( , ) ( ) ( , )
, , ,( ) ( ) ( ) ( )
k l k H k l
i mc i mc mc i mcy n n n n Q= w U c        (3.50) 
The cost function in Multicode systems must be considered by the condition that each 
active user regards as several virtual users and the desired signal also need to match 
the despreader output sequence ( , ), ( )
k l
i mcy n  at the same discrete time model. So the cost 
function of Multicode systems are represented as 
2( ) ( , ) ( , )
, ,
1 1 1
2( , )
,
1 1 1
( ) ( ) ( ) ( )
( )
i i
i i
K qN
k H k l k l
mc i mc mc i mc i
i k l
K qN
k l
i mc
i k l
J E n n n Q d n
E e n
= = =
= = =
⎡ ⎤= −⎢ ⎥⎣ ⎦
⎡ ⎤= ⎢ ⎥⎣ ⎦
∑∑∑
∑∑∑
w U c
  (3.51) 
The gradient of the cost function in the Multicode systems, is defined as 
(
)
( )
,
( , ) ( , ) ( ) 2
, , ,( )
1
( , ) ( , )*
,
2 ( ) ( ) ( ) ( ) ( )
2 ( ) ( ) ( )
i
mc
k
i mc
q
J k l k l H H k
mc i mc i mc mc i mcn
l
k l k l
mc i mc i
n n n n n Q
n n d n Q
∂
∂ =
=
−
∑w U c c U w
U c
 
( , )* ( , )
, ,
1
2 ( ) ( )
iq
k l k l
i mc mc i mc
l
e n n Q
=
= ∑ U c        (3.52) 
The updated equation of weight vector of each user can be written as 
( ) ( ) ( , )* ( , )
, , , ,
1
( 1) ( ) 2 ( ) ( )
iq
k k k k l k l
i mc i mc i i mc mc i mc
l
n n e n n Qμ
=
+ = − ∑w w U c     (3.53) 
And the updated equation of weight vector is also similar to (3.47). 
3.2.2.2.2 Narrowband Adaptive Antenna with Code Adjustment 
We propose a structure different from narrowband adaptive antenna without code 
adjustment. This structure mainly adjusts despreading operation with variant 
coefficients as shown in Fig. 3-6. The traditional despreading code’s elements are ±1 
as the spreading vector in the transmitter, but the despreading elements in our 
proposed receivers are no longer fixed value. We employ LMS algorithm to update 
simultaneously the weight vector and the despreading code coefficients of the 
adaptive antenna. Then the update equations based on the code vector describe as 
follows. Recall that the cost function is given by 
 28
And the received signal vector as 
( )( ) ( ) ( )( )
( ) ( )( ) ( )( )
( ) ( )( ) ( )( )
0 0
0 1
1 1
1 1 1 1
1 1 1
1 1 1
f
P
x Q n f x Q n f
x Q n f Z x Q n f
x Q n f Z x Q n f−
⎡= − + − + −⎣
− + − + − +
− + − + − +
L
L
L
 
( ) ( )( )1 1 1 TPx Q n f Z− ⎤− + − + ⎦L            (3.58) 
where Z represents the length of the taped-delay-line. Therefore, the received signal 
matrix can then be described as 
( ) 1 21 1 1Qn ⎡ ⎤= ⎣ ⎦U L           (3.59) 
Σ Despreader DD ∑-+
Σ Despreader DD ∑-+
LMS AlgorithmWeight adjustment and 
code adjustment
0 ( )x n
1( )x n
1( )Px n−
(1)
0,0 ( )w n
(1)
0,1 ( )w n
(1)
0, 1( )Zw n−
(1)
1,0 ( )w n
(1)
1,1 ( )w n
(1)
1, 1( )Zw n−
(1)
1,0 ( )Pw n−
(1)
1,1( )Pw n−
(1)
1, 1( )P Zw n− −
( )
0,0 ( )
kw n ( )0,1 ( )
kw n ( )0, 1( )
k
Zw n−
( )
1,0 ( )
kw n ( )1,1 ( )
kw n ( )1, 1( )
k
Zw n−
( )
1,0 ( )
k
Pw n−
( )
1,1( )
k
Pw n−
( )
1, 1( )
k
P Zw n− −
(1) ( )y n
( ) ( )ky n
Σ
 
Figure 3-8. Wideband adaptive antenna in CDMA with code adjustment 
 
In wideband adaptive antenna structure, ( ) ( )k nw  and U(n) are rearranged to use for 
the derivation of antenna weight and code updated equations. However, these 
derivative forms are the same as the narrowband adaptive antenna structure and we 
will not reconsider this. The update equations for the wideband adaptive antenna can 
be summarized as follows. The despreader output sequence is 
( ) ( ) ( )( ) ( ) ( ) ( )k k H ky n n n n Q= w U c         (3.60) 
The cost function in wideband adaptive antenna structure is 
2( ) ( ) ( )
1
( ) ( ) ( ) ( )
K
k H k k
k
J E n n n Q d n
=
⎡ ⎤= −⎢ ⎥⎣ ⎦∑ w U c      (3.61) 
 30
 
Figure 3-10. BER performance of narrowband LMS-based adaptive receiver with 
different user number in each transmitted antenna branch. 
 
Figure 3-11. BER performance of narrowband RLS-based adaptive receiver with 
different user number in each transmitted antenna branch. 
 
In the second year, it shows the simulation results of three multirate CDMA 
systems for adaptive LMS-based receiver structures. There are K=8 or 12 users, P=8 
antenna array number and Z=8 tapped-delay-line number in all the following 
simulations. The transmitted signal is QPSK throughout the simulations. For 
simplicity, we only consider a dual-rate system in the project, assume 4 or 6 high-rate 
users with a symbol rate being twice times the basic rate and 4 or 6 low-rate users 
with basic symbol rate. 
In order to show the result on various ISI and MAI environments, we categorize 
the channel impulse response (and multipath) of each user into two groups described 
as ( ) ( )1 1 1 1 2 2 2 2( ) ( ) ( ) ( ) ( ) ( ) ( ) ( ),1 ,12 ,16 ,1 ,12 ,16, , , ,  , , ,k k k k k k k ki i i i i i i iH h h h H h h h= =L L , k=1,…,Ki. The length of 
1
( )k
iH  and 2
( )k
iH  are fixed on 16. 
( )
1
kH  has the same incident angle to each impulse 
response to emphasize the property of ISI. The second channel ( )2
kH , every impulse 
response is assigned a different incident angle on antenna array. When the incident 
 32
better than VCR and VPG systems. Besides, in these two figures, we can see that 
when the number of users and the length of spreading code length are increased at the 
same time, the performance of Multicode systems is not influenced by the number of 
users. Therefore, we use a set of 31 PN codes to Multicode systems in Fig. 3-17 to 
achieve better performance. In Fig. 3-17, we compare the performances of wideband 
antenna with and without code adjustment for three multirate systems. Obviously, the 
BER performances of wideband antenna with code adjustment are also better than 
without code adjustment in both high rate and low rate users. In Fig. 3-17 the BER 
performances of Multicode systems are better than VCR in high rate users, and it is 
contrary to the low rate users. In Fig. 3-18, comparing three kinds of length of 
multicode system, e.g., a set of 15 PN sequence, a set of 31 PN sequence and a set of 
63 PN sequence. We clearly find that longer length of the spreading code to result in 
better performance.  
It is worth to claim that because different data rate match different length of the 
spreading code to result in the signal power per chip is different chip interval is 
disparity, we consider the SNR as Eb/N0 not Ec/N0. 
 
 
Figure 3-12. LMS learning curve comparisons for three multirate structures with 
Hadamard code 
 
 34
randomly in 
1
( )k
iH and 16 impulse responses randomly in 2
( )k
iH  
 
Figure 3-16. BER performance for 12 users and with 16impulse responses 
randomly in 
1
( )k
iH  and 16impulse responses randomly in 2
( )k
iH  
 
Figure 3-17. BER performance of wideband receiver for 12 users and with 
16impulse responses randomly in 
1
( )k
iH  and 16impulse responses randomly in 2
( )k
iH  
 
4.1 Introduction
Increasing demand for higher wireless system capacity has catalyzed sev-
eral ground-breaking transmission techniques among which the multiple-
input/multiple-output (MIMO) technologies have attracted most of the re-
cent attention. It has been shown that, in comparison with the conventional
single antenna systems, signiﬁcant capacity gains are achievable when multi-
element antennas (MEA) are used at both the transmit and receive sides [1].
Spatial multiplexing techniques, for example, the BLAST (Bell-labs Layered
Space-Time) system, were developed to attain very high spectral eﬃciencies
in rich scattering environments.
Ideal rich-scattering environments decorrelate channels between diﬀerent
pairs of transmit and receive antennas so that maximum number of orthog-
onal subchannels is available. In practice, however, spatial correlations do
exist and should be considered in designing an MIMO receiver and evaluat-
ing the corresponding system performance [2]. Spatial correlation depends
on physical parameters such as antenna spacing, antenna arrangement, and
scatters’ distributions. Antenna correlations reduce the number of equivalent
orthogonal subchannels, decrease the spectral eﬃciency, and make it more
diﬃcult to detect the transmit data [1].
A coherent MIMO receiver needs an accurate channel estimate to carry
out some critical operations and to provide satisfactory performance. Having
a reliable channel estimator that takes into account the channel correlation
is thus a critical part of the MIMO receiver design. Most estimators require
information of channel statistics such as covariance functions and signal-to-
noise ratio which are to be obtained by on-line measurement whence is sus-
ceptible to environment variation and measurement error. We propose novel
model-based channel estimation schemes that can do without the knowledge
of second-order channel statistics. Spatial and/or time covariance or correla-
tion functions are described by nonparametric regression and the inﬂuence of
spatial angle is related to other channel parameters via a regression model.
Numerical comparison with established channel models indicates that realis-
tic correlated MIMO channels can be accurately described by the proposed
analytic model with negligible modelling error. Moreover, the directional
information can be extracted for further post-channel-estimation space-time
processing.
The following section gives a brief review of the typical space-time antenna
setup and then propose a channel modelling scheme based on orthogonal ex-
36
where L is the maximum number of paths associated with any subchannel
between a transmit and receive antenna pair, τl is the delay of the lth path,
and δ denotes the Dirac delta function. The complex channel gain matrix
Hl associated with the lth path is given by
Hl =
⎡
⎢⎢⎢⎣
hl11 h
l
12 · · · hl1M
hl21 h
l
22 · · · hl2M
...
...
. . .
...
hlN1 h
l
N2 · · · hlNM
⎤
⎥⎥⎥⎦
N×M
, (4.2)
where hlij is the complex subchannel gain between the jth transmit and ith
receive antennas. For each l, {hlij} are joint complex zero-mean Gaussian
random variables (r.v.) with the same variance. The received waveform,
y(t), at an MS can be expressed as
y(t) =
∫
H(τ)x(t− τ)dτ + n(t). (4.3)
n(t) represents zero mean additive white Gaussian noise (AWGN) with co-
variance matrix E{nnH} = N0IN .
For a narrowband block fading channel, (4.1) is reduced to a single-tape
fading matrix and (4.3) becomes
y(t) = H(t)s(t) + n(t), (4.4)
where H(t) is an N ×M complex channel matrix. To simplify the notation,
parameter t is ignored in the following discussion.
4.2.3 Modelling spatial correlations
Recently, many analytic models for spatially correlated MIMO channels have
been proposed and veriﬁed, such as the popular Kronecker model [2], and
the more general Weichselberger models [11]. We present a new modelling
scheme that encompasses both Kronecker and Weichselberger models as spe-
cial cases. The proposed model imposes fewer constraints and involves much
less parameters than other models based on the system setting described in
Section II.A. These features make it possible to devise simple and accurate
model-based channel estimators.
38
angles over [0, 2π] and leaves no mean arriving direction being modelled at
the mobile side. It models separate power azimuthal spectra (PAS) of AOA
and AOD with a common direction being described by the mean AOD at
the base station [5]. (4.9) resembles the channel model proposed in [3] and
has been veriﬁed via measurements [7].
Let Φ¯
1
2
BS
def
= [φBS(i, j)], where φBS(i, j) represents the root power correla-
tion between ith and jth transmit antennas. The power correlation across
transmit antennas is high if the angle spread Δ is small [12], which is often the
case when the radius of the scatterer ring is much smaller than the distance
between BS and MS (d/R  1). In this case, the associated power corre-
lation function is relatively smooth [8] and the Weierstrass approximation
theorem tells us that φBS(i, j) can be approximated by the expansion
φBS(i, j) =
∞∑
k=1
λjkqk(i) ≈
KBS∑
k=1
λjkqk(i) (4.11)
where qk(i) is the ith element of the kth (polynomial) basis vector, λ
j
k is
the projection of the jth column on qk, and KBS denotes the number of
approximation basis vectors. Expressing the above approximation in matrix
form, we have
Φ
1/2
BS = WΦ¯
1/2
BS ≈WQBSΛBS, (4.12)
where QBS =
[
q1,q2, · · · ,qKBS
]
M×KBS
, qk = (qk(1),qk(2), · · · ,qk(M))T
and
ΛBS =
⎡
⎢⎢⎢⎣
λ11 λ
2
1 · · · λM1
λ12 λ
2
2 · · · λM2
...
...
. . .
...
λ1KBS λ
2
KBS
· · · λMKBS
⎤
⎥⎥⎥⎦
KBS×M
. (4.13)
Using a similar approximation for Φ
1/2
MS and the canonical representation,
vec(H) = Φ
1
2vec(Hw), we have
vec(H) ≈ (WQBS ⊗QMS) (ΛBS ⊗ΛMS) vec(Hw)
def
= (WQBS ⊗QMS) vec(Ccoef). (4.14)
The identity
vec (ABD) =
(
DT ⊗A) vec (B) (4.15)
40
equal. When we use lower rank QBS and/or QMS then the equalities become
approximations only.
Since the Kronecker model assumes separable spectra at the transmitter
and receiver, the coeﬃcient matrix C in (4.18) is required to have the special
structure (ΛBS ⊗ΛMS) vec(Hw) = vec(C). The Weichselberger model, on
the other hand, demands that C satisfy (4.21) and its entries be Gaussian
random variables. We shall not impose either constraints onC in using (4.18)
as our channel model. (4.20) indicates that the eigenbases of the one-sided
correlation matrices in the Weichselberger model can also be transformed into
some predetermined orthonormal bases. When the angle spread  becomes
large, the rank of C increases and there is no dominant spatial angle. The
steering matrix W becomes an identity matrix which carries no information
about spatial angle any more, and we have Ω˜  V = C,UBS = QBS and
UMS = QMS.
Since QMS and QBS are given and ﬁxed, identiﬁcation of the unknown
channel H is equivalent to the estimation of W and C, which usually has a
lower rank and much smaller number of entries than those of H for the link
environment of interest. Thus, using the model (4.18) reduces the channel
estimator’s complexity and enhance its performance.
4.3 Model-Based Space-Time Channel Esti-
mation
To estimate both the coeﬃcient matrix C and the directional information
W in (4.18), we adopt an iterative scheme in which each iteration consists of
two phases: the ﬁrst phase is responsible for the estimation of the coeﬃcient
matrix while the directional matrix is estimated in the second phase. Both
tentative estimates are updated as one proceeds with each new iteration
until the stopping criterion is met. Two typical MIMO channels–correlated
block fading channels and frequency-selective time-varying fading channels–
are discussed in order. Our algorithms provide estimates for both channel
and AOD.
42
Substituting the deﬁnition
Z
def
= ((WoptX)
TQM,KT )⊗QN,KR (4.28)
into (4.27) we have the LS solution
vec(Ĉ) = (ZHZ)−1ZHvec(Y)
def
= F (Wopt). (4.29)
While the optimal directional matrix estimate is not available, we can replace
it by the tentative estimation from the previous iteration, Wi−1. vec(Ĉ) is
then obtained by computing F (Wi−1) instead and the corresponding tenta-
tive estimate is denoted by Ĉi. Initially, we can arbitrarily set W0 to be an
identity matrix.
4.3.1.2 Phase II - Direction Estimation
Similar to Phase I, we start with the assumption that the coeﬃcient matrix
in this estimation phase is optimum. Since the directional information is ap-
proximated by a diagonal matrix W in (4.10), the best way to estimate W
is to reconstruct it in a diagonal form. But, due to some computational con-
siderations, we can also relax the diagonal constraint of W and approximate
it by an arbitrary M ×M matrix during the iterations. In the followings, we
propose three schemes to estimate W in both diagonal and full dimensional
formats.
Algorithm A - Least Squared Approximation SettingG
def
= QN,KRCopt
QTM,KT and ΔŴi−1
def
= Wopt−Ŵi−1 and invoking (4.18) and (4.24), we have
Ĥi−1 = GŴi−1, and ΔĤi−1 = GΔŴi−1. (4.30)
By ignoring the noise term N′ in (4.26), we obtain
ΔĤi−1X = GΔŴi−1X
≈ Y − Ĥi−1X = Y −GŴi−1X. (4.31)
Assuming that Wopt is an arbitrary M×M matrix, and applying the identity
(4.15) on both sides of the above equation, we ﬁnd that the residual error
matrix ΔŴi−1 can be obtained from the LS projection
vec(ΔŴi−1) = (XT ⊗G)†
×
[
vec(Y)− (XT ⊗G)vec(Ŵi−1)
]
(4.32)
44
where v(θ) = exp
[−j2π d
λ
sin(θ)
]
. The AOD information φ̂ is retrieved by
maximizing the matching output
φ̂ = arg max
−π≤θ≤π
Re
{
ŵHLSv(θ)
}
. (4.36)
Once the estimate φ̂ is available, it is straightforward to obtain Ŵ = diag(v(φ̂)).
Algorithm C - Root Finding Method Solving (4.36) by exhaustive
search over [0, 2π) is computational intensive. Note that the elements of wopt
is of geometric progression, i.e., they form a row vector of a Vandermonde
matrix. Hence if we deﬁne the correlation polynomial
P (z)
def
= ŵHLSz−M (4.37)
where z = [1, z, . . . , zM−1] and let Z be the set of its zeros in the complex
plane, then solving (4.36) is equivalent to
φ̂ = sin−1
(−Arg{ẑ}λ
2πd
)
ẑ = argmin
z∈Z
|(|z| − 1)| (4.38)
The directional matrix is then reconstructed by Ŵ = diag(ẑ), where ẑ =
[1, ẑ, · · · , ẑM−1].
4.3.2 Channel Estimation for Frequency-Selective Time-
Varying Fading Channels
For estimating a correlated frequency-selective time-varying fading channel,
we extend our approach used in the previous section to accommodate the
time-varying characteristics, using a set of smooth base functions, e.g., the
the polynomial functions used by [16], to describe the time domain behavior
of a fading channel. Assume that the power delay proﬁles for the sub-channels
between transmit and receive pairs are independent but of the same form.
With a sampling interval of t = T the receive signals at time nT can be
written as
Yn =
L−1∑
l=0
H(l)n X
(l)
n +Nn (4.39)
46
By using (23), (24), (4.41) and the approximation (4.44), we have
vec(Y¯n,B) ≈
(
((W′Xn,B)T Q˜BS)⊗QMS
)
c˜coef (4.45)
whereW′
def
= (IBL⊗W), Q˜BS def= QB,KB⊗IL⊗QBS, c˜coef = (IKBL ⊗PBS ⊗PMS) ccoef.
W is the steering matrix deﬁned in (4.10). Since the mean AOD usually
varies slowly with respect to a subchannel’s coherent time, we assume that
the steering matrix W is the same during a period of B data blocks. Simi-
lar to the narrowband model (21), we do not impose the implicit Kronecker
structure and Gaussian assumption on c˜coef.
As (4.45) can be obtained by replacing X, Y, W, vec(C), QM,KT , and
QN,KR in (4.27) by Xn,B, Yn,B, W
′, c˜coef, Q˜BS, and QMS, we conclude that
both block fading and time variant frequency selective fading channels can
be described by similar models. Hence, the two-phase iterative estimation
scheme developed in Section III-A can be extended to estimate the coeﬃcient
vector c˜coef, and the directional matrix W
′ in (4.45). In the following, we
describe our two-phase channel estimation approach for frequency-selective
time-variant fading channels.
4.3.2.1 Phase I - Coeﬃcient Estimation
With an argument similar to that used in Section III-A, we assume that
the directional matrix W′ is optimal in the coeﬃcient estimation phase and
deﬁne
Z˜
def
=
(
(W′optXn,B)
T Q˜BS
)
⊗QMS. (4.46)
The LS estimate of c˜coef is
̂˜ccoef = (Z˜HZ˜)−1Z˜Hvec (Yn,B) def= F˜ (W′opt), (4.47)
which is a function of the optimal directional matrix W′opt. At the ith itera-
tion, since the optimal directional matrix is not available, we substitute the
tentative estimation W′i−1 for W
′
opt.
4.3.2.2 Phase II - Direction Estimation
Based on the results derived in Section III-A, we propose here three AOD
estimation algorithms for wide-band MIMO channels. The ﬁrst algorithm
relaxes the directional matrix W inside W′ as an arbitrary M ×M complex
48
Algorithm C - Root-Finding Method The root-ﬁnding approach for
the block fading case can be used as well. It is easy to see that (4.51) is
equivalent to searching for the root of the correlation polynomial P (z) which
is the closest to the unit circle, i.e.,
ẑ = argminz ||z| − 1|
subject to: P (z)
def
= Θ
(
ŵHLSz
)−M = 0 (4.52)
and then retrieving the AOD information from ẑ = exp
[
−j2π d
λ
sin(φ̂)
]
. The
directional matrix is to be reconstructed by Ŵ′ = I ⊗ diag(ẑ), where ẑ =
[1, ẑ, . . . , ẑM−1].
4.4 Performance Analysis
4.4.1 Channel Estimation Error for Correlated Fading
Channels
To assess the mean squared identiﬁcation error (MSIE) performance
	
def
= E
[
‖H− Ĥ‖2F
]
= E
[
‖vec(H)− vec(Ĥ)‖22
]
. (4.53)
of the proposed iterative projection method, we consider the following two
steps. One is the estimation of the modelling coeﬃcient matrix C given
the previous projected directional matrix, Ŵ, where C represents either the
coeﬃcient matrix of (4.27) or C˜coef in (4.45). The other is the estimation
of directional matrix W given the previous estimated coeﬃcient matrix, Ĉ.
Similarly, W represents either the direction matrix of block fading channel
in (4.27) or the compound directional matrix W˜ in (4.45). We will discuss
these two estimation errors respectively.
4.4.2 Coeﬃcient Estimation Error with Estimated Di-
rectional Matrix
Assume we have the estimated directional matrix Ŵ from the previous pro-
jection, and deﬁne a perturbation matrix, ΔW, representing the error asso-
ciated with the least squared estimation, Ŵ = W + ΔW. Let the training
50
If the modelling bases QBS and QMS span the dominant signal subspace of
Rh, we have ‖(I − P˜̂W)fk‖22
def
= ‖P˜⊥
̂W
fk‖22  1 for k ≥ K whenever Ŵ
converges to the W. If there is a perturbation matrix, ΔW, induced by the
estimation error from the previous iteration, the coeﬃcient vector estimation
vec(Ĉ) can be approximated up to the ﬁrst order of ΔZ as [19]
vec(Ĉ)  vec(C)− Z†ΔZvec(C) + Z†vec(N)
+(ZHZ)−1ΔZHP⊥Z vec(N)− Z†ΔZZ†vec(N),
(4.59)
where P⊥Z = I − Z(ZHZ)−1Z. The above equation indicates that, besides
the terms that have to do with the noise N, the coeﬃcient vector estimation
error is determined by the projection error ΔZ. Hence, when the projection
error ΔW is small (and thus ΔZ is small), vec(Ĉ) is a good approximation
of vec(C) at high SNR region.
Let the compound modelling order Ks be equal to (KT +1)(KR +1) and
(KT +1)(KR +1)(KB +1)L for block fading channel and frequency selective
fading channel, respectively. Considering the case that K < k ≤ Ks < χ,
eigenvalues {λk}KsK+1 are negligible, and the remainder mean squared error is
Ks∑
k=K+1
λk‖(I− P˜̂W)fk‖22 <
Ks∑
k=K+1
λk  1. (4.60)
Thus when the modelling order is chosen larger than the rank of Rh, the
modelling error, 	h, is negligible. In contrast, if the modelling order is not
enough to span the signal space of the channel covariance matrix there will
be a underorder modelling error
K∑
k=Ks+1
λk‖(I− P˜̂W)fk‖22 (4.61)
which will dominate the MS error performance when the AWGN is small
enough (high SNR region).
Next, consider the second term in (4.56), and assume the training signal
Xp and the noise matrix N are statistically independent. The error term
contributed by the thermal noise can be easily calculated as
	n(Xp,Ŵ) = E
[‖ΨPzvec(N)‖22]  tr
(
N0
B
P˜
̂W
)
, (4.62)
52
where we have deﬁned
P
̂C
def
=
{
I− (XpX†p)T ⊗
([
QMSĈQ
H
BS
] [
QMSĈQ
H
BS
]†)}
(4.67)
The corresponding MS errors are obtained by following the scheme (4.57)-
(4.61), replacing the projection matrix P˜
̂W by (4.67).
The MS error contributed by AWGN is
	n(Xp, Ĉ) = tr
(
E
[
ΓHΓ
]
Rn
)
(4.68)
where
Γ =
(
X†p
)T ⊗{QMSĈQHBS [QBSĈHĈQHBS]−1 QBSĈHQHMS
}
.
The approximation X∗pX
T
p  BIM leads to
	n(Xp, Ĉ)  tr
{
N0
B
IM
⊗
(
QMS ĈQ
H
BS
[
QBSĈ
HĈQHBS
]−1
QBSĈ
HQHMS
)}
(4.69)
The analysis shown in (4.63)- (4.65) says that the MS error contributed by
AWGN is also a decreasing function of the modelling order used.
4.5 Numerical Results and Discussion
Simulation results reported here use the reference MIMO channel model
of [6], [8] or the SCM model [9]. The former is a Kronecker-based stochas-
tic models (KBSM) whose spatial correlation matrices are generated by the
power azimuth spectrum (PAS) at the BS and MS respectively according to
the speciﬁc physical settings. The SCM model generates the channel coeﬃ-
cients according to a set of selected parameters (e.g., angle spreads, AOD,
AOA, etc.). It is a popular parametric stochastic model (PSM) whose spatial
cross correlations are functions of the joint distribution of the AOD at the
transmit side and AOA at the receive side. To comply with the one-ring
54
rate of Algorithms A is faster than that of Algorithm A or B, the latter two
algorithms give direct estimate of the AOD without extra post processing.
The MSE performance of Algorithm C in a frequency-selective time-
variant fading channel similar to that of [3] is illustrated in Fig. 4-7. The
power delay proﬁle of the independent six delay pathes is given by [0, −1, −
9, −10, −15, −20] dB with relative delays at [0, 310, 710, 1090, 1730, 2510]
nanoseconds, KB = 2, the vehicle speed is 60 km/hr. Similar to the case of
block fading channels, the proposed estimators oﬀer excellent MSE perfor-
mance while reduce the size of processing dimension dramatically provided
that either the spatial or time domain correlation is high enough. However,
there will be performance degradation when the modelling order is not ca-
pable of capturing the channel characteristics.
Fig. 4-8 provides the MSE performance in an SCM channel [9]. KB is set
to 2. Similar to what we have observed in Fig. 4-7, performance improves
with increase of modelling order at the high SNR region. In the low SNR
region, the reduced-order estimators beneﬁt from the noise reduction and
thus give better performance. The performance in SCM channels with angle
spread equals to 8◦ or 15◦ is about the same. This implies that the correlation
between the transmit antennas does not change too much for these two cases.
4.6 Conclusion
This report presents novel model-based schemes to estimate spatial correlated
MIMO fading channels. We use orthogonal bases to expand the correlation
functions at BS and MS respectively. We also incorporate the directional
information into our channel model. Numerical results show that excellent
performance is attainable. Proper modelling order can be chosen to obtain
the optimal trade-oﬀ between performance and complexity. We further ex-
tend our approach to deal with time variant frequency-selective fading and
space-time correlated channels and obtain similar results.
56
0 5 10 15 20 25
10−4
10−3
10−2
10−1
100
SNR (dB)
MS
IE
modelling order=0, AS=2
modelling order=1, AS=2
modelling order=2, AS=2
modelling order=1, AS=15
modelling order=2, AS=15
modelling order=3, AS=15
Figure 4-2: Mean square identiﬁcation errors for diﬀerent modelling orders.
Solid curves: angle spread  = 2◦. Dotted curves: angle spread  = 15◦.
1 2 3 4 5 6 7 8
−18
−16
−14
−12
−10
−8
−6
−4
−2
0
Index of Transmit Antenna
Ph
as
e D
ela
y (R
adi
an)
AOD
AOD+AS
AOD−AS
AOD Estimate
Figure 4-3: AOD estimation based on the directional matrix W at SNR =
10 dB; AOD φ = 45◦ and angle spread Δ = 2◦. The upper bound and lower
bound are determined by the angle spread.
[2] D. S. Shiu, G. J. Foschini, M. J. Gans, and J. M. Kahn, “Fading Corre-
lation and Its Eﬀect on the Capacity of Multielement Antenna Systems,”
IEEE Trans. Commun., vol. 48, no. 3, pp. 502-513, March 2000.
[3] K. I. Pedersen, J. B. Andersen, J. P. Kermoal, and P. E. Mogensen, “A
stochastic multiple-input multiple-output radio channel model for eval-
uation of space-time coding algorithms,” in Proc. Vehicular Technology
Conf., Boston, MA, Sept. 2000, pp. 893-897.
[4] A. Abdi and M. Kaveh, “A space-time correlation model for multiele-
ment antenna systems in mobile fading channels,” IEEE J. Select. Areas
Commun., pp. 550-560, vol. 20, no. 3, Apr. 2002.
58
0 5 10 15 20 25 30 35 40 45
1E-4
1E-3
0.01
0.1
1
MS
E
SNR (dB)
 KT=3 (AS=15)
 KT=4 (AS=15)
 KT=5 (AS=15)
 KT=6 (AS=15)
 KT=7 (AS=15)
 KT=3 (AS=2)
 KT=4 (AS=2)
 KT=5 (AS=2)
 KT=6 (AS=2)
 KT=7 (AS=2)
Figure 4-6: MSE performance of Algorithm C under channel model in [3]
with diﬀerence angle spread.
Figure 4-7: MSE performance of Algorithm C under SCM model with dif-
ference angle spread.
[8] J. P. Kermoal, L. Schumacher, and P. Mogensen, “MIMO Channel Char-
acterisation,” IST Project IST-2000-30148 I-METRA Deliverable D2,
Oct. 2002.
[9] 3GPP, TR 25.996, “Spatial channel model for multiple input multiple
output (MIMO) simulations (Rel. 6),” 2003.
[10] M. Debbah and R. R. Mu¨ller, “MIMO Channel Modeling and the Prin-
ciple of Maximum Entropy,” IEEE Trans. Inf. Theory, vol. 51, no. 5, pp.
1667-1690, MAY 2005.
[11] W. Weichselberger, M. Herdin, H. O¨zcelik, and E. Bonek, “A Stochastic
Channel Model With Joint Correlation of Both Link Ends,” IEEE Trans.
60
