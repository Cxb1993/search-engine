   I
中文摘要 
本計畫旨在探討微型永磁同步電動機應用於 X-Y 平台的位置控制系統，計畫中首先針對
微型永磁同步電動機之特性、應用及數學模式進行說明，隨後探討並解決微型電動機內部微
型編碼器，每圈僅有 100 個位置訊號，造成解析度不夠的問題。為了有效提升位置控制的性
能，計畫中設計一個位置/速度狀態估測器，估測微型電動機的狀態，達到增加微型編碼器解
析度的目的。此外，由於微型永磁同步電動機之轉矩過小，無法直接驅動 X-Y 定位平台，因
此搭配減速齒輪來驅動 X-Y 定位平台。此時，系統所包含的慣量及摩擦力將過於複雜，造成
不確定量增大。本計畫考慮當電動機慣量、摩擦力及外界干擾等參數不確定性存在時，重新
建構電動機的數學模型，並且設計一個位置的最佳控制器，來以改善閉迴路系統的暫態及加
載性能。  
本計畫使用德州儀器公司所生產的 TMS320F28335 數位訊號處理器，執行定位控制系統
的位置/速度狀態估測器、電動機座標軸轉換及位置最佳控制器等相關法則，因此硬體電路甚
為簡單。由相關實驗結果顯示，本文所提的系統具有快速的暫態響應及良好的追蹤能力，本
計畫結果說明本計畫所提方法的正確性及可行性。 
 
 
關鍵詞：微型永磁同步電動機、位置/速度狀態估測器、最佳控制器、數位訊號處理器、X-Y
平台。 
   III
目錄 
中文摘要 ........................................................................................................................I 
英文摘要 ...................................................................................................................... II 
目錄 III 
一、前言 ....................................................................................................................... 1 
二、研究目的 ............................................................................................................... 3 
三、文獻回顧 ............................................................................................................... 5 
四、研究方法 ............................................................................................................... 7 
4.1 微型永磁同步電動機簡介 ...........................................................................................7 
4.1.1 結構及特性 ............................................................................................................8 
4.1.2 相關應用 ...............................................................................................................12 
4.1.3 X-Y 定位平台 ......................................................................................................14 
4.1.4 數學模式 ...............................................................................................................15 
4.2 驅動系統介紹.................................................................................................................21 
4.2.1 簡介 ........................................................................................................................21 
4.2.2 功率級電路 ...........................................................................................................22 
4.2.3 轉矩控制 ................................................................................................................24 
4.2.4 四象限控制 ...........................................................................................................27 
4.3 控制器設計 .....................................................................................................................28 
4.3.1 簡介 ........................................................................................................................28 
4.3.2 比例-積分控制器設計 ......................................................................................29 
4.3.3 最佳控制器設計 .................................................................................................36 
4.4 狀態估測器設計 ............................................................................................................43 
4.4.1 簡介 .........................................................................................................................43 
4.4.2 狀態估測器設計原理.........................................................................................45 
  1
一、前言 
微機電系統(micro electro-mechanical systems，MEMS)，為一個智慧型微小化的系統，包含
感測、信號處理及致動的功能，將電子、機械、光學、化學、生物、磁學或其他性質整合到晶
片上，而利用微機電系統技術，使物體擁有高運算功能、高性能且能大量製造等優點[1]-[2]。隨
著科技的蓬勃發展，許多複雜的微機電系統應用得以實現，尤其是現今市場產品微小化的趨勢，
使得電子商品不斷朝著輕、薄、短、小並具高附加價值的目標邁進。電動機在機電整合產業中，
扮演舉足輕重的角色，隨著製造技術的演進以及各種應用場合的需求，「微型電動機」因應而生，
而微機電系統成為將電動機推向微型化的關鍵技術[3]。目前有許多微機電相關製程應用在微型
馬達的製造上，如「矽基製程技術」(silicon-based technology)[4]或「微光刻電鑄模造」(Lithographie 
Gavanoformung Abformung，LIGA)[5]。一般微系統技術(micro system technoloy，MST)所製造出
的微型電動機，無法產生如同傳統電動機般大的轉矩及輸出功率，但是具有體積小、結構精緻、
低耗能等優點，適合應用在某些特殊的場合，諸如 3C 產品、微型機器人、交通運輸、微型醫療
電子產業[3]。 
微型電動機依驅動方式區分為兩大類，一是電磁致動方式，如微型永磁同步電動機、微型
磁阻電動機、微型感應電動機[6]-[21]，二是以使用壓電、靜電效應致動，如微型靜電電動機、
微型超音波電動機、微型壓電電動機[21]-[24]，一般而言微型電動機尺寸約為 2-10mm。雖然微
型電動機種類眾多，但以微型永磁同步電動機最為普及。微型電動機具有體積小之優點，但是
受限於編碼器的製造技術，相對無法提供較佳之解析度的編碼器，而一般以弦式驅動的電動機
磁場導向控制(field-oriented control，FOC)[25]，需仰賴精確約為 2000 脈波/轉的編碼器，以達到
良好的控制性能。以本計畫中所使用之微型永磁同步電動機為例，其編碼器於每轉僅能提供 100
個脈波，使得相關控制性能受到了影響。 
目前已有所多針對微型電動機之相關研究，如對於微型電動機之設計， Aguero 等利用有限
元素分析法進行微型永磁同步電動機轉子及定子結構設計[6]，而 Feldmann 等則實現微型磁阻電
動機之製造 [7]。此外有關於微型電動機之控制方面的研究，Neugebauer 等提出應用於微型電動
機之六相多層結構變頻器[8]，Scott 等將無轉軸偵測偵測元件速度控制系統應用於微型無刷直流
電動機[9]，Chang 等提出強健控制器及轉軸位置估測器應用於微型永磁同步電動機之控制系統
  3
二、研究目的 
微型永磁同步電動機的伺服控制系統，係由微型電動機、感測元件、驅動器及控制器組成。
雖然微型電動機具有體積小、轉速高及可應用於特定場合之優點，但是由於其體積相較於一般
傳統之交流電動機小上甚多，因此無法將一般驅動及控制於傳統交流電機之方式直接套用在微
型電動機上，微型電動機相較於傳統尺寸之交流電動機存在許多差異，例如︰微型電動機定子
電流過小，導致電流偵測上的困難；微型電動機大多具有高電阻與低電感之特性，因此其線圈
的銅損較傳統交流電動機高，造成微型電動機的效率不佳，ㄧ般介於 20%至 50%間；此外，微
型編碼器由於受限於微型電動機的體積，編碼器製作需使用新的製程技術，除了成本提高外，
編碼器的解析度亦受到相當的限制，使得電動機無法有效操作於低轉速下。由以上的敘述可以
得知，若能開發出微型電動機新型的驅動技術及使用高性能控制器於微型電動機上，將可以有
效改善目前微型電動機發展的困境。 
對於高性能的電動機閉迴路伺服控制系統而言，ㄧ般需要透過編碼器來使用差分方式估測
電動機之轉速，因此轉軸角度偵測器的使用是必須的，但一般微型電動機的微型編碼器由於體
積過小，導致編碼器無法提供需要的解析度，造成控制器的性能下降，限制了電動機的低速性
能。針對電動機低轉速下的缺失，對於傳統電動機有關編碼器低解析度問題，已有些許研究成
果[26]-[29]，而對於微型電動機的改善策略目前還未被提出，因此，本計畫將針對微型永磁同步
電動機編碼器解析度提升部分來探討，計畫中提出位置/速度狀態估測器，解決編碼器解析度不
足問題，達到良好的低速控制性能。 
另一方面，微型永磁同步電動機需搭配減速齒輪及螺桿，才能有效的驅動 X-Y 定位平台，
由於本計畫使用的減速齒輪的減速比為 854 比1，且其內部機械架構為以5級串接耦合達成，齒
輪間存在的許多背隙，因此，在此複雜的機械架構下，系統所包含的慣量和摩擦力將變的十分
地複雜，以致無法建立精確的數學模型。此外，X-Y 定位平台依使用場合承載不同大小之物件
做位置軌跡之追蹤，有快速響應及承受不同負載之需求，傳統的比例積分控制器無法同時滿足
暫態響應及加載時的高性能控制，為了使 X-Y 定位平台位置控制具有快速暫態響應，且具有一
定程度的強健性，本計畫設計位置最佳控制器來滿足電動機高性能控制之需求，雖然，傳統上
電動機應用常見的最佳控制器已經可以提供滿意的性能表現[26]-[29]，但是直至目前為止，仍無
  5
三、文獻回顧 
近來微型電動機驅動系統的研究，大致上可分為下列四大類： 
 
(1) 電動機本體的結構設計與特性分析： 
微型電動機之設計主要建立在微機電系統的發展上，微型電動機依文獻所述大致上區分
為：微型永磁同步電動機、微型磁阻電動機、微型感應電動機、微型靜電電動機、微型壓電
電動機[6]-[24]，但是目前「微型永磁同步電動機」的相關本體研究仍甚少，主要有 Wagner
等藉由 IC 製程技術實現以矽為基礎的微型永磁電動機 [12]。Fernandez 等探討微型永磁軸承
使用厚膜(thick-film)永久磁鐵結構的分析[13]。Gilles 等針對定子線圈結構作改良，並利用深
刻微影(deep lithography)技術及X射線微光刻電鑄模造(LIGA-X)成功實現 8mm的三相微型薄
型永磁同步電動機[14]。Chau 等分析金屬粉末射出(metal injection molding，MIM)技術在微型
無刷直流電動機的定子鐵心製作上可取代傳統積層(lamination)技術，使鐵心成本降低，並達
到可接受的鐵心損失範圍[15]。Komori 等設計轉子為電磁懸浮式的微型永磁同步電動機，並
改良軸承上不同形狀的電磁體，進而提升電動機的運轉速度[16]。Chen 等利用薄板模型(thin 
sheet model)及影像分析反推磁漂浮式軸承之渦流損失[17]。 
 
(2) 驅動系統及功率轉換器設計： 
一般電動機驅動係由電磁感應作用產生轉矩，本文中微型永磁同步電動機亦與傳統永磁
交流電動機驅動方式相同。然而傳統永磁交流電動機驅動的研究甚多，但就目前而言，針對
微型電動機領域中，僅有 Lee 等則針對三相微型無刷直流電動機之轉矩漣波的降低，提出一
種瞬時電壓控制來驅動三相變頻器[18]。Neugebauer 等設計一個六相五階的變頻器來驅動微
型感應電動機[8]。 
 
(3) 控制器法則： 
近年來由於微機電技術的演進，在微型電動機的結構設計上已有許多的研究發展，但在
微型電動機的驅動控制方面則較缺乏，相關研究僅有如 Jabbar 等利用共振方式來作為電壓調
  7
四、研究方法 
 
4.1 微型永磁同步電動機簡介 
一般微型永磁式同步電動機係使用高性能的永久磁石安置於轉子表面，而取代了激磁場
繞組，避免了激磁場的銅損。亦可省掉使用碳刷、滑環等設備，體積大幅降低。同時，達到
小型化及高功率密度的需求。永磁同步電動機相較於直流機或感應電動機，具有較佳的散熱
能力，較高的功率/重量比，以及較大的轉矩/慣量比等優點。 
微型永磁同步電動機之結構，如圖 1 所示，主要包括：轉子、定子及外殼，其中三相線
圈繞組是利用導體環氧化物(conductive epoxies)，將線圈繞組嵌入在定子側表面，其轉子沒有
線圈，所以無激磁場的銅損。該電動機的尺寸大小，如圖 2 所示。由於定子結構為無槽式，
且三相繞組採用菱形分佈繞線繞製成圓筒形狀，均勻配置於氣隙中，定子與轉子間有較大氣
隙，使得磁路不易飽和，所產生的三相反電勢波形近似正弦波，故運轉中無頓轉效應(cogging 
torque effect)。 
 
線圈繞組
定子
線圈繞組
轉子(永久磁鐵)
轉軸
外殼
 
圖 1 微型永磁同步電動機之結構圖[30]。 
  9
性： 
(1) 轉子構造 
微型永磁同步電動機將固有的轉子線圈移除，採用永久磁鐵產生轉子磁通鏈，利用高能量
的磁性材料提升電動機的效率及電磁力。釹硼鐵(Nd-B-Fe)具有很高的頑磁性、矯頑力、能量密
度大及較佳的機械特性等優點[32]。因此，被廣泛採納為永磁電動機的轉子磁性材料。微型永磁
同步電動機之轉子為圓筒型構造，由於幾何結構完全對稱，氣隙分佈均勻，且對應的磁動勢也
呈現均勻的正弦波分佈，無磁阻轉矩，使得電動機特性的分析簡單，且具有較佳的動態性能。 
 
(2) 定子繞組構造 
微型永磁同步電動機定子繞組為無槽式結構，不同於有槽式永磁同步電動機，無槽式電動
機之定子鐵心材料不具齒槽，並利用導體環氧化物(conductive epoxies)將線圈繞組嵌入在定子側
表面。無槽式定子線圈繞組因捨棄定子齒槽，線圈繞組曝露在空氣隙中，單位繞組產生之磁通
量減少，因此，繞組形狀將影響單位面積所能輸出的電磁力大小，目前文獻及專利的記載
[33]-[34]，一般無槽式微型永磁同步電動機的三相線圈繞組以軸向來區分，可設計為菱形及六角
形，如圖 4(a)及(b)所示，此兩種繞組形狀，可避免傳統方形繞線之線圈端部無效激磁線緣，並
且使單位體積匝所能容納的繞線匝數提升，進而維持因空氣隙增大而損失的磁通量。 
採用無槽式定子結構，即藉由捨棄微型永磁同步電動機的鐵心齒部，可使電動機達到無頓
轉扭矩，具有運轉平順、無噪音等優點，常用於高速微型電動機。此外，由於無槽式的定子結
構，提供較大的磁場空間，磁通相對分佈於較大的氣隙中，定子側的線圈繞組也因較大的氣隙
產生較大的磁阻及較小的電感值，其電感值通常約為傳統交流電動機的 1%至 10%。而微型永磁
同步電動機由於結構特殊，其線圈繞組的電感只有幾微亨利，電阻則為 10 歐姆以上。電機時間
常數為幾微秒，機械時間常數與電機時間常數比例約為 10000:1。機械時間常數約 10 毫秒範圍，
由於反電勢常數甚低，所以一般無槽式微型永磁同步電動機其速度可高達數萬轉，此為微型永
磁同步電動機的特色之ㄧ。 
  11
 
 
(a) 
 
 
(b) 
圖 5 微型永磁式同步電動機反電勢及激磁電流波形： 
(a)方波；(b)正弦波。 
  13
 
圖 7 尺寸 1 英吋之管狀 CCD 照相機實體圖[37]。 
 
微型機器人亦以微型電動機為核心達成致動。圖 8 為 Wood 等完成的微型飛行昆蟲的實體
圖[38]。日本學者成功研製了 2.4 mm電動機的微型機器人，靈活地深入到人體內，做一些人類
先前無法完成的工作，甚至利用 1 mm的微型電動機製造出來的血管機器人，置入人類的血管
裏，治療血栓類疾病[39]。此外，美國史坦福大學金傑明博士預測微型電動機將推向奈米大小，
他們集微型電腦，驅動器，傳動器，感測器，電源等為一體，並可廣泛應用於醫療上，例如，
利用微螞蟻可以注入人類血管清除毒物，脂肪，膽固醇，並吞噬病毒，殺死癌細胞等[40]。 
 
 
圖 8 微型昆蟲實體圖[38]。 
  15
及螺桿，驅動方式係利用微型永磁同步電動機轉動，並藉由 854:1 的微型減速齒輪降低微型永
磁同步電動機的外部等效負載，使得微型永磁同步電動機之轉矩，足夠帶動 X-Y 定位平台。最
後，由螺桿將電動機的旋轉運動轉換為直線運動，帶動位於線性滑軌上的 X-Y 定位平台，執行
位置軌跡之追蹤。 
 
微型編碼器
微型永磁同步電動機及微型減速機
螺桿
 
圖 10  X-Y 定位平台。 
 
4.1.4 數學模式 
微型永磁同步電動機可依三相靜止座標軸(a-b-c 軸)及同步旋轉座標軸(d-q 軸)分別建立不同
的數學模式，本計畫所使用的微型永磁同步電動機為三相平衡、2 極，轉子為圓筒型構造，線圈
繞組為無槽分佈式結構，且反電勢為正弦波。其數學模式說明如下： 
 
(一) 三相靜止座標軸數學模式 
若忽略磁飽和現象、渦流及磁滯損失。圖 11 為永磁同步電動機等效電路，其三相定子側電
壓方程式為[44]-[45]: 
  17
2 1cos( )
3 2ab bc ca ba cb ac s s
L L L L L L L Lπ= = = = = = = −  (4) 
s a b cr r r r= = =  (5) 
 
式中 
sL ：電樞電感 
假設微型永磁同步電動機三相平衡，其三相電流可表示為： 
 
0a b ci i i+ + =  (6) 
 
將(2)至(6)代入(1)中，並令 sLL 2
3= 重新整理可得： 
sin
2sin ( )
3
2sin ( )
3
e
an a a
bn s b b m e e
cn c c
e
v i i
dv r i L i
dt
v i i
θ
πλ ω θ
πθ
⎡ ⎤⎢ ⎥⎡ ⎤ ⎡ ⎤ ⎡ ⎤ ⎢ ⎥⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥′= + − −⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥⎣ ⎦ ⎣ ⎦ ⎣ ⎦ ⎢ ⎥+⎣ ⎦
 (7) 
式中 
eω ：同步旋轉磁場之電機速度 
由(7)式中，定義三相反電勢與轉軸角度的關係，並重新整理後，得到三相反電勢方程式為： 
 
sin
2sin( )
3
2sin( )
3
a
an s a
e
a
b
b m e e bn s b
c
c
e cn s c
div r i L
dte
die v r i L
dt
e div r i L
dt
θ
πλ ω θ
πθ
⎡ ⎤⎡ ⎤ − −⎢ ⎥⎢ ⎥⎡ ⎤ ⎢ ⎥⎢ ⎥⎢ ⎥ ⎢ ⎥⎢ ⎥′= − − = − −⎢ ⎥ ⎢ ⎥⎢ ⎥⎢ ⎥ ⎢ ⎥⎢ ⎥⎣ ⎦ ⎢ ⎥⎢ ⎥+ − −⎢ ⎥⎣ ⎦ ⎣ ⎦
 (8) 
式中 
ae 、 be 、 ce ：a、b、c 相之反電勢 
此時，電動機電磁轉矩可以表示為： 
  19
0
2 2cos cos( ) cos( )
3 3
2 2 2-sin -sin( ) -sin( )
3 3 3
1 1 1
2 2 2
e e e
d a
q e e e b
c
f f
f f
f f
π πθ θ θ
π πθ θ θ
⎡ ⎤− +⎢ ⎥⎡ ⎤ ⎡ ⎤⎢ ⎥⎢ ⎥ ⎢ ⎥⎢ ⎥= − +⎢ ⎥ ⎢ ⎥⎢ ⎥⎢ ⎥ ⎢ ⎥⎢ ⎥⎣ ⎦ ⎣ ⎦⎢ ⎥⎢ ⎥⎣ ⎦
 (13) 
式中 
af 、 bf 、 cf ：靜止參考座標上 a-b-c 軸電壓、電流或磁通鏈 
qf 、 df 、 0f ：同步旋轉參考座標上 q-d-0 軸電壓、電流或磁通鏈 
 
將(1)及(2)式利用(13)式座標轉換後，可得微型永磁同步電動機在同步旋轉座標軸之電壓方
程式為： 
 
0
0
d d d d q q
s e
q q q q d d m
v i L i L idr
v i L i L idt
ω λ
⎛ ⎞ −⎡ ⎤ ⎡ ⎤ ⎡ ⎤ ⎡ ⎤ ⎡ ⎤= + +⎜ ⎟⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥⎜ ⎟ ′+⎣ ⎦⎣ ⎦ ⎣ ⎦ ⎣ ⎦ ⎣ ⎦⎝ ⎠
 (14) 
 
式中 
dv ：d 軸之定子電壓 
qv ：q 軸之定子電壓 
di ：d 軸之定子電流 
qi ：q 軸之定子電流 
dL ：d 軸之定子電感 
qL ：q 軸之定子電感 
 
由於微型永磁同步電動機轉子為表面附著型，故 qL 與 dL 相等。此時，電動機電磁轉矩可簡
化為： 
 
3
2 2e m q t q
PT i K iλ′= =  (15) 
  21
 
圖 12 三相座標 a-b-c 軸與 d-q 軸關係。 
 
 
4.2 驅動系統介紹 
 
4.2.1 簡介 
永磁同步電動機是利用轉子所產生的磁場與定子線圈電流交互作用而產生電磁轉矩，伴
隨著轉子的角度變化，適當的改變線圈激磁電流，可使電動機能維持相同方向的轉速。一般
而言，電動機是以磁極位置感測器如霍爾元件或編碼器以及功率元件適當的切換來取代電刷
及整流子，藉由感測轉軸角度，進而切換變頻器的狀態。本計畫中的微型永磁同步電動機的
驅動系統，主要包括硬體電路和數位訊號處理器軟體程式兩部份。硬體電路包含：微型永磁
同步電動機、數位/類比轉換電路、電流偵測及回授電路、類比/數位轉換電路及編碼器。軟
體程式包含：限制器、位置最佳控制器、位置/速度狀態估測器、d-q 軸/a-b-c 軸轉換以及 a-b-c
軸/d-q 軸轉換等運算。 
 
  23
 
 
 
  圖 14 微型永磁同步電動機不同取樣頻率下的電流波形： 
(a)5kHz；(b)10kHz；(c) 20kHz。 
 
  25
式中 
dV ：穩態條件下，d 軸電壓 
qV ：穩態條件下，q 軸電壓 
 
利用(17)式，每相的電壓峰值可以表示為： 
 
2 2
s d qV V V= +  
2 ' 2( ) ( ( ))
2 2
m m
s d r r q s q r r d m
P Pr i L i r i L iω ω λ= − + + +  (18) 
 
式中 
sV ：每相電壓峯值 
 
若將額定電流 mI 全部施加於 q 軸上，令 d 軸電流為零，及每相電壓峰值 sV 已達到每相最
大端電壓峯值 mV ，故可依據(18)式改寫為： 
 
2 ' 2( ) ( )
2 2
m m
m r r m s q r m
P PV L I r iω ω λ= − + +  (19) 
 
式中 
mV ：每相最大端電壓峰值 
mI ：額定電流，亦即每相最大電流峰值 
 
此時，對應的轉速即為額定轉速 bω ，由(19)式可推導出如下關係式： 
 
  27
bω cω
bT
bP
P
T
maxT
maxP
 
圖 15 微型永磁同步電動機轉矩對轉速特性曲線。 
 
4.2.4 四象限控制 
依據(9)及(15)式輸出電磁轉矩方程式可知，激磁相定子線圈注入正的 q 軸電流時，可產生正
轉矩；若激磁相注入負的 q 軸電流時，可產生負轉矩。所以，配合實際轉軸角度，適當的控制
微型永磁同步電動機的換相時機，可獲得所需的正負電磁轉矩及轉速，達到圖 16 所示的四象限
控制。表 1 綜合微型永磁同步電動機在各象限運轉的情況下，可明確獲得在正轉或反轉時，電
動機的轉速與轉矩正負符號一致；在正轉或反轉煞車時，則電動機的轉速與轉矩正負符號相反。 
 
表 1 電動機的四象限運轉 
運轉模式 正轉 正轉煞車 反轉 反轉煞車 
馬達轉速 + + - - 
馬達轉矩 + -       -       + 
 
  29
4.3.2 比例-積分控制器設計 
 
本節將針對圖 17 所示之控制架構做位置控制器的設計。比例、積分、微分控制器具有結構
簡單，強健性佳，調整方便等優點，工業界應用相當廣泛，其計算上無複雜的數學式，一般皆
以簡單的響應特性設計並經過實驗值來調整控制的迴路增益。當待控體也就是電動機的參數無
法掌握，或無法獲知精確的數學模型時，利用簡單調整即可使系統在特定情況下達到穩定響應。
以下介紹比例-積分控制器作為位置、速度及電流迴路控制器的設計，並根據響應特性做各控制
器增益值的規劃，由於 X-Y 定位平台之驅動為各自獨立，因此控制器亦可單獨設計，故本節將
以「 j 軸」的標示來表示單軸設計流程。 
+
*
rjω rjωΔ *qji
*
ajv
*
bjv
*
cjv+
−
+
−
*
dji
qji
dji
aji
bjibji
qji
ˆrjω
*
djv
*
qjv
−
ˆrjω
aji
rjθ
rˆjθ
rˆjθ
*
rjθ
rˆjθ
+
−
rjθΔ
 
圖 17 具狀態估測器微型永磁同步電動機之閉迴控速系統。 
 
(一) d q− 軸電流控制器設計： 
X-Y 定位平台的位置控制器設計，由於 X-Y 定位平台的位置控制為各軸獨立控制，因此控
制器可分別獨立設計，其中下標「 j 」可為 x 或是 y ，分別表示 x 軸及 y 軸之系統微型永磁同步
電動機，其中q軸及d 軸之電壓方程式可表示如下： 
 
qj s qj q qj ej d dj ej m
dv r i L i L i
dt
ω ω λ′= + + +  (23) 
  31
dG ：d 軸之電流比例-積分控制器 
pdk ：d 軸之電流比例控制器之增益 
idk ：d 軸之電流積分控制器之增益 
 
此時，電流閉迴控制設計如圖 18(a)及(b)，可得q軸及d 軸的電流閉迴路轉移函數為： 
 
* 2
( )
( ) ( )
qj pq iq
qj q pq s iq
i s k s k
i s L s k r s k
+= + + +  (31) 
* 2
( )
( ) ( )
qj pd id
qj d pd s id
i s k s k
i s L s k r s k
+= + + +  (32) 
 
選擇 /iq pq s qk k r L= 及 /id pd s dk k r L= ，則式(32)可簡化為： 
 
*
( )
( )
pq
qj q cq
pqqj cq
q
k
i s L
ki s ss
L
ω
ω= = ++
 (33) 
*
( )
( )
pd
qj d cd
pdqj cd
d
k
i s L
ki s ss
L
ω
ω= = ++
 (34) 
 
式中 cqω 及 cdω 分別為q 軸及d 軸電流控制器的頻寬，由式(34)可知，q 軸及d 軸電流響應與 pqk 及
pdk 有關，亦即比例控制器的增益愈大其電流響應越快，依照轉移函數式(34)即可設計各響應速
率下，電流控制器的增益值。 
 
  33
pq
cq
q
k
L
ω =  (35) 
 
假設所設計的q軸電流控制迴路系統的頻寬夠寬，則在速度頻帶範圍內，q軸電流控制迴路的
轉移函數約為 1，亦即式(34)中 *( ) / ( ) 1qj qji s i s = 。此時考慮圖 19 中之速度控制器在頻域中之表示
為 sG 如下： 
 
is
s ps
kG k
s
= +  (36) 
式中 
sG ：轉速之比例-積分控制器 
psk ：轉速比例控制器之增益 
isk ：轉速積分控制器之增益 
 
故在q 軸電流控制迴路系統的頻寬遠大於機械頻寬時，即可忽略q 軸電流響應延遲。若在 j
軸上的外加負載轉矩 0LjT = ，則圖 19 中之速度閉迴轉移函數為： 
 
* 2
( )
( ) ( )
rj ps is
rj m ps m is
s k s k
s J s k B s k
ω
ω
+= + + +  (37) 
 
假設選擇 /is ps m mk k B J= ，則可將(37)式化簡為一階系統，則速度閉迴轉移函數可改寫為： 
 
*
( )
( )
ps
rj m cs
psrj cs
m
k
s J
ks ss
J
ω ω
ω ω= = ++
 (38) 
 
若速度指令 * ( )rj sω 為步階訊號輸入 * /o sω 時，代入(38)式可求得輸出頻域響應 ( )rj sω 為： 
  35
    同理根據速度控制器相同之步驟，假設所設計的速度控制迴路系統的頻寬夠寬，則在位置
頻帶範圍內，速度控制迴路的轉移函數約為 1，亦即式(38)中 *( ) / ( ) 1rj rjs sω ω = 。此時考慮圖 21
中之位置控制器在頻域中之表示為 1sG 如下： 
 
1
1 1
is
s ps
kG k
s
= +  (42) 
式中 
1sG ：位置之比例-積分控制器 
1psk ：位置比例控制器之增益 
1isk ：位置積分控制器之增益 
 
+
−
+ −cq
cqs
ω
ω+
1
tK t
KsG
1
m mJ s B+
* ( )rj sω ( )rj sω
LjT
ejTqji
*
qji*ejT
1sG
1
s
+
−
*
( )
1
( )
rj
rj
s
s
ω
ω ≈
* ( )rj sθ ( )rj sθ
 
圖 21 速度控制系統的步階響應圖。 
 
理想上，如果在速度控制迴路系統的頻寬遠大於位置頻寬時，即可忽略速度響應的延遲。
則圖 21 中之位置閉迴轉移函數為： 
 
1 1
* 2
1 1
( )
( )
rj ps is
rj ps is
s k s k
s s k s k
θ
θ
+= + +  (43) 
 
假設選擇 1 0isk = ，則可將(43)式化簡為一階系統，則位置閉迴轉移函數可改寫為： 
 
  37
    此外，由於本計畫所使用之微型永磁同步電動機極數為 2，由式(11)可定義 j 軸上的電
機角等效於 j 軸上的機械角如下︰ 
 
rj ejθ θ=  (49) 
 
為了簡化上的需要，本文中重新定義 j 軸上的交直軸電流方程式如下︰ 
 
s
dj dj dj
d
ri u i
L
= −   (50) 
'1s
qj qj qj rj m
q q
ri u i
L L
ω λ= − −   (51) 
 
式中 dju 及 qju 分別定義如下︰ 
 
1
dj rj qj dj
d
u i v
L
ω= +  (52) 
rj dj d qj
qj
q q
i L v
u
L L
ω= − +  (53) 
 
式中 djv 及 qjv 分別為 j 軸上驅動微型永磁同步電動機之交直軸電壓，觀察式(52)及(53)可知，
如能計算出控制量 dju 及 qju ，則可得到實際驅動電動機之交直軸電壓 djv 及 qjv 。此外，為了確
保穩態時之穩態誤差可收斂，可定義 j 軸上位置誤差之積分和直軸電流誤差之積分如下︰ 
 
*
0
( )
t
rj rj rj dtθ θ θΔ = −∫  (54) 
*
0
( )
t
dj dj dji i i dtΔ = −∫  (55) 
  39
0 0
0 0
0 0
1 0
0 0
0 1
cB
⎡ ⎤⎢ ⎥⎢ ⎥⎢ ⎥= ⎢ ⎥⎢ ⎥⎢ ⎥⎢ ⎥⎣ ⎦
, 
*
*
0
0
0
0
rj
j
dj
f
i
θ
⎡ ⎤⎢ ⎥⎢ ⎥⎢ ⎥= ⎢ ⎥⎢ ⎥⎢ ⎥⎢ ⎥⎣ ⎦
 (59) 
 
由式(59)可以將式(58)之狀態方程式重新整理如下︰ 
 
cj c cj c cj jX A X B u f= + +  (60) 
 
同理可定義理想之狀態變數 djX 及理想之控制輸入 dju ，此時，理想的狀態方程式可以表
示如下︰ 
 
1dj c dj c d j jX A X B u f= + +  (61) 
 
接著定義狀態誤差及控制輸入誤差 
 
ej cj djX X X= −  (62) 
1ej cj d ju u u= −  (63) 
 
則可由式(60)和(61)得到系統的誤差動態方程式如下︰ 
 
  41
 
接著整理矩陣 1( )cA d 部份，提出與控制輸入項 eu 共同項 cB D  
 
1 1 1( ) ( )( ) ( ( ) ) ( ( )( ) )( ( ) )c c c c c c c c c cA d A B D B D A d A I B D B D A d A
+ +− = − + − −  (69) 
     
由上式則可將 1( )cA d 拆解為三部分，包含原先系統額定值部份、不確定性可提出 cjB D項部分和
不確定性無法提出 cjB D項之部分，表示如下︰ 
 
1 1 1( ) ( )( ) ( ( ) ) ( ( )( ) )( ( ) )c c c c c c c c c cA d A B D B D A d A I B D B D A d A
+ += + − + − −  (70) 
 
式中 ( )cjB D +為 cjB D之虛擬反矩陣定義如下︰ 
 
1( ) (( ) ( )) ( )T Tc c c cB D B D B D B D
+ −=  (71) 
 
將式(70)帶入式(68)可得重新整理過後的系統誤差動態方程式如下︰ 
 
1 1
1
2
( )( ) ( ( ) ) ( ( )( ) )( ( ) )
( ) ( )( ( ) )
ej c ej c c c c ej c c c c ej
c ej c ej
X A X B D B D A d A X I B D B D A d A X
B D u B D D D d I u
+ +
−
= + − + − −
+ + −

 (72) 
 
式中 0α ≥ 為權重函數，藉由設定狀態之不確定性之上界，由於式(72)中的控制器輸入 eju ，僅
能針對含有 cB D項的 1( )cA d 部份達成控制，而對於無法提出 cB D項之 1( )cA d 部分則無法達成
有效之控制，因此須增加一個含有 ( ( )( ) )c cI B D B D +− 項之輔助之控制器輸入 jv ，來處理 eju 無
法控制之部分，此時的系統誤差動態方程式可寫為如下之型式︰ 
 
( ( )( ) )
( ( )( ) )
ej c ej c ej c c j
ej
c ej c c c
j
X A X B Du I B D B D v
u
A X B D I B D B D
v
α
α
+
+
= + + −
⎡ ⎤⎡ ⎤= + − ⎢ ⎥⎣ ⎦ ⎣ ⎦

 (73) 
  43
dyiqyi
ayibyi
*
qyv
*
dyv
*
ayv
*
byv
*
cyv
*
ryθ
*
dyi
ˆrxω
rˆyθ
ryθ
dxiqxi
axibxi
*
qxv
*
dxv
*
axv
*
bxv
*
cxv
*
rxθ
*
dxi
rˆxθ
rxθ
ˆryω rˆyθ
rˆxθ
qyi
qxi
ayvbyvcyv
axv
bxv
cxv
X軸之微型永磁同步電動機驅動系統
Y軸之微型永磁同步電動機驅動系統 ryθ
rxθ
X-Y定位平台
 
圖 22 含轉軸偵測元件之微型永磁同步電動機閉迴控速系統。 
 
 
4.4 狀態估測器設計 
 
4.4.1 簡介 
近年來，隨著數位訊號處理器迅速的發展，使得微電腦可以在很短的週期取樣時間下，達
到複雜的運算功能。對於一個高性能的伺服驅動系統，必須具有精確的電動機轉速及寬廣的控
速範圍，需藉由編碼器訊號提供目前的速度與位置等資訊來給控制器運算出合適之控制量。微
處理器被廣泛應用在電動機的控制系統上，由於增量型的編碼器電路較簡單，因此仍普遍使用
於工業界。而在機器人或精密機械裝置的應用上，即使在轉速很低或是負載轉矩變動下，仍必
須確保精確的速度及定位控制，因此編碼器必須確保在任何轉速範圍，其解析度是足夠的，但
是由於本計畫所使用之微型編碼器，並不能提供足夠的解析度，因此使得微型永磁同步電動機
的轉速範圍受到限制。 
電動機轉速的偵測係基於數位平均速度估測法[28]，藉由在固定的取樣週期或偵測時間下編
  45
4.4.2 狀態估測器設計原理 
根據上述週期與脈波之關係，若我們可以建立一個位置/速度狀態估測器，其週期與電流控
制週期相同，而電流控制週期為位置控制週期的 1/10 倍，假如本計畫之位置控制週期 sT 為 1 毫
秒，電流控制週期及狀態估測器週期 esT 則為 100 微秒，此時與圖 24 比較，証明在低轉速範圍下，
狀態估測器的轉速估測比編碼器所提供的解析度更良好。 
 
sT
esT
 
圖 24 狀態估測器與速度控制週期的關係圖。 
 
假設外部負載干擾是一個常數值，由電動機的機械方程式，亦即式(10)、(11)及(15)可得到下
列狀態方程式： 
 
j j jX AX Bu= +  (79) 
j jy CX=  (80) 
 
其中 X 為狀態變數向量， y為輸出，其定義如下所示： 
 
[ ]
0 1 0 0
10 , , 1 0 0 ,
0 0 0 0
m t
m m m
B KA B C
J J J
⎡ ⎤ ⎡ ⎤⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥= − − = =⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥⎣ ⎦ ⎣ ⎦
 (81a) 
, ,
T
j rj rj Lj j rj j qjX T y u iθ ω θ⎡ ⎤= = =⎣ ⎦  (81b) 
 
其中 , ,A B C 為狀態方程式中與電動機參數相關之矩陣， ju 為 j軸上的控制輸入，由(79)至(80)
  47
ˆ
j j je X X= −   (88) 
 
將式(79)及式(82)代入式(88)中計算，可得誤差動態方程式如下： 
 
( )j je A LC e= −  (89) 
 
根據式(89)中之誤差動態方程式，可利用極點配置法來設計位置/速度狀態估測器之極點，達到
估測誤差快速且穩定收歛之目的，其特性方程式可表示如下： 
 
[ ] 1 2 3det ( ) ( )( )( ) 0sI A LC s P s P s P− − = + + + =  (90) 
 
1
m mJ s B+
t
m
K
J
1
s
1
s
1
s
m
m
B
J
1
mJ
1
s
1l
2l
3l
qji
tK
ejT
LjT
rjθ
rˆjθ
ˆ
rj rjθ θ−
rjω
ˆrjω
LˆjT
+
−
+
+ + +
+
+
+
−
−−
 
圖 25 狀態估測器方塊圖。 
 
  49
需功率[21]，使電動機之電壓及電流更加平滑。 
 
(1) 數位/類比轉換電路 
本計畫使用 LTC7541A 數位/類比轉換器，將數位信號處理器中控制器計算後之d q− 軸電
壓命令 *djv 及
*
qjv 經由 /dq abc座標軸轉換之程式處理，計算出數位的三相電壓命令
*
ajv 、
*
bjv 、
*
cjv ，
隨後，經由數位/類比轉換器 LTC7541A 輸出 15V± 的類比三相數位電壓命令，表 2 即為數位/
類比信號的對照表，其解析度為 12 位元，且具有功率耗損低，成本低等優點。圖 26 為其應用
時電路圖，圖中為單組轉換器示意圖，本計畫中每部微型同步電動機必須輸出三相電壓，故需
要三組轉換器方能驅動微型電動機。 
 
 
圖 26 數位/類比轉換電路架構圖。 
 
 
 
 
 
 
 
 
  51
−
+
V+
V-
GND
0.1 Fμ
(-10V~10V)
(-12V~12V)
10kΩ 20kΩ
OPA551
0.1 Fμ
*
_a DACV
*
_a OPAV
RL
Io_max
       = 200mA
 
圖 27 a-相線性放大器電路結構圖。 
 
4.5.2.2 電流回授及偵測電路 
本計畫之數位訊號處理器(DSP TMS320LF28335)其內建 16 個 12 位元之類比/數位轉換模
組，轉換速度僅需 80ns，輸入電壓之容許範圍則為 0V ~3V 。 
電流回授及偵測電路如圖 28 所示。採用精密量測用的超小型交流電流感測器 CTL 6-L-Z，
可精確量測交、直流及脈衝電流，並具有線性，可靠度高及不受溫度影響的特性，其規格如表 3
所示，偵測電流範圍為 1mA至 15 A，且具電流比 1/800，故二次側電流甚小。利用上述電流感
應元件，本系統首先將定子電流流經電流感應元件的一次側。以 a 相為例，因一次側的繞線為
20 匝，故當一次側最大電流為 100mA時，二次側輸出為 2.5mA電流，並透過 100Ω電阻，轉換
產生 0.25V 電壓降。接著，經由高抗雜訊比的運算放大器 OPA27，調整比例至輸出電壓為
-3 V ~3 V ，再經由電壓補償，使輸入數位信號處理器之類比電壓為 0 V ~3 V 對應於
-100 mA~100mA的電流。最後，輸出端再以稽納二極體限制輸出電壓，以免輸入至類比/數位轉
換器的類比電壓過高。 
 
  53
4.5.3 軟體程式 
本計畫所製作的閉迴路控制系統，其驅動、座標軸轉換、位置/速度狀態估測器及位置最
佳控制器等，皆以數位訊號處理器 TMS320F28335 的 C 語言撰寫而成。軟體程式架構，主要
包含：記憶體空間配置，系統初始規劃，座標軸轉換，位置/速度狀態估測器，位置最佳控制
器等部份。 
上述程式設計的順序說明如下。首先，規劃數位訊號處理器晶片內之記憶體空間配置，
分別指定程式與資料使用之記憶體空間位址。接著系統初始規劃，設定中斷階層的優先遮罩，
中央處理單元計時中斷及設定各計數器的計數模式，並將記憶體及暫存器清除為零，完成數
位信號處理的初始規劃，並致能中斷服務程式。 
其次，執行中斷服務程式，此部份程式為電動機驅動系統的軟體程式，必須執行轉軸角
度倍頻、位置/速度狀態估測器、座標軸轉換及位置最佳控制器程式等相關計算。圖 29 為整
個系統主程式執行的流程圖。中斷服務程式流程分別如圖 30 所示。 
 
 
圖 29 主程式流程圖 
 
  55
USB
PORT/JTAG
CONTROLLER
EXTERNAL
JTAG
U
S
B
P
O
R
T
CAN-A
CAN-B
RS-232
SCI-B
128K x 16
SRAM
A
N
A
L
O
G
E
X
P
A
N
S
I
O
N
I
/
O
E
X
P
A
N
S
I
O
N
XZCS7n
CANA
CANB
CSIA
CSIB
JTAG
XTAL1/OSCIN
TMS320F28335
 
圖 31 eZdspTMF28335 平台架構圖[53]。 
 
 
圖 32 eZdspTMF28335 模組控制平台實體圖[53]。 
 
數位信號處理器 TMS320F283355 之晶片主要性能如下[53]： 
(1) 高性能靜態 CMOS 技術： 
  57
z 單一/同步取樣功能 
(11) 支持 ANCI C/C++ 編譯器/組合語言/連接器等開發工具 
(12) 三組電源管理模式： 
z 閒置模式 
z 等待模式 
z 停止模式 
 
圖 33 為晶片內記憶體與外部記憶體之對應圖。在晶片內記憶體區可分為資料記憶体及程式
記憶體區塊，在系統暫存器的規劃與中段位址的設定，將於後續章節再作說明。而外部記憶體
則提供給外部周邊介面使用，其提供 16 位元的資料匯流排及 16 位元的定址模式。 
  59
4.5.3.2 程式設計 
以下針對 X-Y 定位平台位置控制控制系統各部份程式流程做詳細介紹。 
 
(1) 記憶體空間配置 
記憶體空間配置主要分為記憶體與區段兩部份，本計畫使用之 eZdsp 開發平台，其配置
空間由連結檔(.cmd)來記錄。其中記憶體規劃所有的記憶體，而區段是把記憶體分成許多小
的區塊。在記憶體中有資料頁 0 及資料頁 1。資料頁 0 為程式記憶體，資料頁 1 為資料記憶
體。以圖 4.28 之記憶體位址來配置，資料頁 0 內包含主程式之晶片內記憶體區塊(L0，L1，
L2，L3)，以及晶片內之快取記憶體的設置，並包括中斷及重置啟動等宣告位址。而資料頁 1
則包含內部資料記憶體 (M0，M1)及各功能暫存器的位址配置，另外，中斷向量(PIE Vector)
亦存放在此。 
 
(2) 系統初始規劃 
本程式主要做為數位訊號處理器系統的初始規劃，其中包含設定系統及功能時脈，輸入/
輸出連接埠，中斷階層的優先遮罩，數位訊號處理器週邊的中斷允許旗標，中央處理單元計
時器功能，編碼器脈波 QEP 電路設置，類比/數位轉換器，主程式及輔助用計數器等設定，
並將記憶體及暫存器清除為零，每一模組須在程式設計之前加以設定規劃完成，其執行流程
如圖 34 所示。 
  61
  
(a)                          (b) 
圖 35 數位信號處理平台之 QEP 電路基本架構圖： 
(a) 4 倍頻狀態解碼；(b)計數器增減模式。 
 
(4) 位置/速度狀態估測器程式設計 
本程式係根據編碼器得到的轉軸角度資訊，進行狀態估測器的設計，提高轉軸角度解析
度，其取樣週期為 100 微秒。首先，微型永磁同步電動機藉由微型光學編碼器提供每圈 100
個脈波之輸入置數位訊號處理器中的 QEP 倍頻電路模組，得到每圈 400 個脈波，作為與狀態
估測器輸出估測角度比較之命令值，隨後，使用電流感測器讀入三相定子電流，並透過座標
軸轉換得到座標軸轉換得到q軸電流資訊及d 軸電流資訊，並利用本計畫所設計之位置/速度
狀態估測器來估測微型永磁同步電動機的角度、速度，估測過程中藉由轉軸角度 rjθ 與估測轉
軸角度 rˆjθ 作比較，得到角度誤差，並經由估測器回授增益 1 2,l l 及 3l 的設計，使 rˆjθ 收斂至 rjθ ，
得到狀態變數 ˆrjω 及 rˆjθ ，以供控制系統使用。 
  63
中斷服務程式開始
限制電壓命令
經轉軸角度倍頻，得到轉軸角度
rθ
執行狀態估測器程式，
得到估測轉軸角度 及角速度
rˆθ ˆrω
轉軸角度倍頻
* * *, ,a b cv v v
利用查表法得到三相電壓正弦函數值
以12位元數位電壓信號輸出至驅動級
返回主程式
電流類比/數位轉換及
座標轉換
速度迴路控制
電流迴路控制及
座標軸轉換
三相電壓弦式數位信號表
由電流偵測電路作三相電流 取樣, ,a b ci i i
/a b c d q− − −執行 座標轉換，
得到 ,d qi i
狀態估測器
* ˆr rω ω ωΔ = −計算速度誤差
執行速度比例-積分控制器，得到 *qi
計算 軸電流誤差
*
*
q q q
d d d
i i i
i i i
Δ = −
Δ = −{d q−
執行 軸電流比例-積分控制器，d q−
得到 * *,d qv v
執行 座標轉換，
得到
/d q a b c− − −
 
圖 36 使用比例-積分-微分控制器驅動控制核心中斷程式處理流程圖。 
 
  65
中斷服務程式開始
限制電壓命令
經轉軸角度倍頻，得到轉軸角度 rjθ
執行狀態估測器程式，
得到估測轉軸角度 及角速度rˆjθ ˆrjω
轉軸角度倍頻
* * *, ,a b cv v v
利用查表法得到三相電壓正弦函數值
以12位元數位電壓信號輸出至驅動級
返回主程式
電流類比/數位轉換及
座標轉換
位置最佳控制器
執行座標軸轉換
三相電壓弦式數位信號表
由電流偵測電路作三相電流 取樣, ,a b ci i i
/a b c d q− − −執行 座標轉換，
得到 ,dj qji i
速度/位置狀態估測器
* ˆ
rj rj rjθ θ θΔ = −計算位置誤差
執行位置最佳控制器，得到 * *,d qv v
執行 座標轉換，
得到
/d q a b c− − −
*
dj dj dji i iΔ = −計算位置誤差
累積誤差 rj djiθΔ Δ、
 
圖 37 使用最佳控制器的驅動控制核心中斷程式處理流程圖。 
 
  67
4.6.2 實測結果 
本章說明若干實測結果，以便驗證本計畫所推導之位置/速度狀態估測器與位置最佳控制
器應用於微型永磁同步電動機的 X-Y 平台位置控制系統的正確性及性能展現。以下分別說明
實測結果。本計畫中位置控制器、速度控制器、電流控制器及位置/速度狀態估測器的參數選
擇，主要依據前面所探討的步驟來設計。比例-積分控制器在位置、速度與電流迴路控制器的
參數選擇如下： 1 10psk = 、 1 0.01isk = 、 20psk = 、 0.05isk = 、 pq pdk k= 0.1= 和 5000iq idk k= = ，
而本計畫中所提出的位置最佳控制器參數選擇如下： 5α = 、 50β = 、 20ρ = ，此外考慮系統
狀態方程式中參數不確定性 1 [ 1.3,1.3]d ∈ − 和 2 [1,1.5]d ∈ 。另一方面，位置/速度狀態估測器回
授增益的選擇如下： 1 30l = ， 2 300l = ， 3 0.0005l = − 。 
相關實測波形說明如下。圖 38(a)(b)(c)為轉速 10000 rpm且未加載時，電動機的三相對中
性點電壓實測波形，圖中可知，利用數位/類比轉換器且中斷取樣週期 10 kHz 下及線性放大器
作為驅動級電路，線性放大器輸出電壓為連續的。圖 39(a)(b)(c)為轉速 10000 rpm且未加載
時，電動機的三相定子電流實測波形，圖中可看出電流約為± 20 mA，此時的定子電流為連
續。 
圖 40 為電動機在 20000 rpm時，使用編碼器計算電動機速度的響應圖，由圖可以得知，
使用差分方式計算出之電動機轉速並不平滑，導致控速的性能不佳。圖 41 則為使用狀態估測
器來計算電動機速度，由圖可知使用狀態估測器可以得到較平穩之速度響應圖，因此電動機
之速度控制性能較佳。圖 42(a)(b)為電動機於轉速 20000 rpm時，狀態估測器所估測的角度與
角度誤差。圖 42(a)中可知狀態估測器之估測角度與實際轉速非常接近。圖 42(b)為估測角度
與實際角度比較後之角度估測誤差，可以得知估測誤差約在 1± 度範圍內，由圖 42(a)(b)可驗
證狀態估測器所估測的狀態甚佳。圖 43 及圖 44 則為電動機於轉速 15000 rpm下分別使用編
碼器和狀態估測器的速度響應圖，由圖 43 可觀察使用編碼器所計算出的電動機轉速具有較大
之連波，而圖 44 中使用狀態估測器之情況，可以得到較平滑之速度響應，可知使用估測器可
以得到比使用編碼器較佳之效果。圖 45 則為使用編碼器下電動機的最低可操作速度，由於本
計畫所使用的微型編碼器每圈僅有 100 個脈波，因此嚴重限制了微型電動機的最低可控制轉
速，由圖中可知，在電動機轉速 120 rpm下，此時的編碼器解析度已經不足以用來計算電動
機速度，速度呈現嚴重的震盪。圖 46 為電動機轉速 120 rpm下，使用狀態估測器所估測得的
  69
機驅動 X-Y 定位平台，使用最佳控制器下追蹤菱型軌跡時，Y 軸上電動機的位置響應圖，由
圖 55(a)可看出電動機位置與 X 軸之情況類似，同樣改善使用比例-積分控制器時過衝的情
況，圖 55(b)則可以得知追蹤時的最大位置誤差約為± 0.1 mm。圖 56 為電動機驅動 X-Y 定位
平台，使用最佳控制器下追蹤菱型軌跡時，X 軸與 Y 軸上電動機的位置響應圖，與圖 53 的
比較可看出使用最佳控制器時，電動機追隨菱形軌跡的性能明顯較佳。 
圖 57(a)(b)為電動機驅動 X-Y 定位平台，使用比例-積分控制器下追蹤圓型軌跡時，X 軸
上電動機的位置響應圖，由圖 57(a)可看出使用比例-積分控制器下，電動機之暫態響應不佳，
而圖 57(b)則可以得知追蹤時的最大位置誤差約為± 0.6 mm。圖 58(a)(b)為電動機驅動 X-Y 定
位平台，使用比例-積分控制器下追蹤圓型軌跡時，Y 軸上電動機的位置響應圖，由圖 58(a)
可看出使用比例-積分控制器下，電動機位置與 X 軸之情況類似，同樣具有暫態響應不佳的
情況發生，圖 58(b)則可以得知追蹤時的最大位置誤差為± 1 mm。圖 59 為電動機驅動 X-Y
定位平台，使用比例-積分控制器下追蹤圓型軌跡時，X 軸與 Y 軸上電動機的位置響應圖，
可看出使用比例-積分控制器下，電動機追隨圓形軌跡的效果不佳。圖 60(a)(b)為電動機驅動
X-Y 定位平台，使用最佳控制器下追蹤圓型軌跡時，X 軸上電動機的位置響應圖，由圖 60(a)
可看出使用最佳控制器下，電動機位置追隨的效果明顯較使用比例-積分控制器佳，圖 60(b)
則可以得知追蹤時的最大位置誤差僅為± 0.2 mm。圖 61(a)(b)為電動機驅動 X-Y 定位平台，
使用最佳控制器下追蹤圓型軌跡時，Y 軸上電動機的位置響應圖，由圖 61(a)可看出電動機位
置可精確的追蹤位置命令，圖 61(b)則可以得知追蹤時的最大位置誤差約為± 0.2 mm。圖 62
為電動機驅動 X-Y 定位平台，使用最佳控制器下追蹤圓型軌跡時，X 軸與 Y 軸上電動機的位
置軌跡圖，與圖 59 的比較可看出使用最佳控制器時，電動機追隨圓形軌跡的性能明顯較佳。 
 
 
 
 
  71
 
 
圖 39 速度 10000 轉/分時，三相定子電流實測圖︰ 
(a)a-相；(b)b-相；(c)c-相。 
  73
degree
estimated
real
Time (ms)  
(a) 
 
Error (degree)
Time (ms)  
(b) 
圖 42 速度 20000 轉/分時，狀態估測器估測響應圖︰ 
(a)角度；(b)角度估測誤差。 
  75
rω (r/min)
Time (sec)  
圖 45 使用編碼器時電動機的最低速度響應圖。 
 
rω (r/min)
Time (sec)  
圖 46  使用狀態估測器時電動機的最低速度響應圖。 
 
  77
*
rxθ
rˆxθ
 
(a) 
 
 
(b) 
圖 48 三角波位置命令時，使用最佳控制器電動機的位置響應圖︰ 
(a) 位置；(b) 位置誤差。 
  79
*
rxθ rˆxθ
 
(a) 
 
 
(b) 
圖 50 正弦波位置命令時，使用最佳控制器時電動機的位置響應圖︰ 
(a) 位置；(b) 位置誤差。 
  81
*
ryθ
rˆyθ
 
(a) 
 
 
(b) 
圖 52  X-Y 平台追蹤菱形軌跡時，使用比例-積分控制器時 Y 軸上電動機的位置響應圖︰ 
(a) 位置；(b) 位置誤差。 
  83
*
rxθ
rˆxθ
 
(a) 
 
 
(b) 
圖 54  X-Y 平台追蹤菱形軌跡時，使用最佳控制器 X 軸上電動機的位置響應圖︰ 
(a) 位置；(b) 位置誤差。 
  85
Position X (mm)
Position Y (mm)
 
圖 56  X-Y 平台追蹤菱形軌跡時，使用最佳控制器電動機的位置響應圖。 
 
 
 
 
 
 
 
 
 
 
 
 
 
  87
Time (sec)
Position (mm)
*
ryθ
rˆyθ
 
(a) 
 
Error (mm)
Time (sec)  
(b) 
圖 58  X-Y 平台追蹤圓形軌跡時，使用比例-積分控制器 Y 軸上電動機的位置響應圖︰ 
(a) 位置；(b) 位置誤差。 
  89
Position (mm)
Time (sec)
*
rxθ
rˆxθ
 
(a) 
 
Time (sec)
Error (mm)
 
(b) 
圖 60  X-Y 平台追蹤圓形軌跡時，使用最佳控制器 X 軸上電動機的位置響應圖︰ 
(a) 位置；(b) 位置誤差。 
  91
Position X (mm)
Position Y (mm)
 
圖 62  X-Y 平台追蹤圓形軌跡時，使用最佳控制器電動機的位置響應圖。 
 
  93
六、參考文獻 
[1] A. B. Frazier, R. O. Warrington, and C. Friedrich, “The miniaturization technologies: past, 
present, and future,” IEEE Transactions on Industrial Electronics, vol. 42, no. 5, pp. 423-430, 
1995. 
[2] H. Fujita, “Microactuators and micromachines,” Proceedings of the IEEE, vol. 86, no. 8, pp. 
1721-1732, 1998. 
[3] P. L. Chapman and P. T. Krein, “Smaller is better? [micromotors and electric drives],” IEEE 
Transactions on Industry Applications Magazine, vol. 9, no. 1, pp. 62-67, 2003. 
[4] M. Mehregany, S. D. Senturia, J. H. Lang, and P. Nagarkar, “Micromotor fabrication,” IEEE 
Transactions on Electron Devices, vol. 39, no. 9, pp. 2060-2069, 1992. 
[5] D. J. Sadler, T. M. Liakapoulos, and C. H. Ahn, “A universal electromagnetic microactuator 
using magnetic interconnection concepts,” Journal of Microelectromechanical Systems, vol. 9, 
no. 4, pp. 460-468, 2000. 
[6] A. C. Aguero, F. A. Actis, V. C. Silva, J. R. Cardoso, and S. I. Nabeta, “Finite element 
analysis of a synchronous permanent magnet micromotor through axisymmetric and transverse 
planar simulations,” IEEE Transactions on Magnetics, vol. 34, no. 5, pp. 3604-3607, 1998. 
[7] M. Feldmann and S. Buttgenbach, “Linear variable reluctance (VR) micro motors with 
compensated attraction force: concept, simulation, fabrication and test,” IEEE Transactions on 
Magnetics, vol. 43, no. 6, pp. 2567-2569, 2007. 
[8] T. C. Neugebauer, D. J. Perreault, J. H. Lang, and C. Livermore, “A six-phase multilevel 
inverter for MEMS electrostatic induction micromotors,” IEEE Transactions on Circuits and 
Systems, vol. 51, no. 2, pp. 49-56, 2004. 
[9] J. Scott, J. McLeish, and W. H. Round, “Speed control with low armature loss for very small 
sensorless brushed DC motors,”  IEEE Transactions on Industrial Electronics, vol. 56, no. 4, 
pp. 1223-1229, 2009. 
  95
[20] K. Wiedmann, S. Demmig, and A. Mertens, “Modified sliding mode controller for 
positioning of micro linear motors,” European Conference on Power Electronics and 
Applications, pp. 1-10,2007. 
[21] J. Zhang and M. Schroff, “High-performance micromotor control systems,” IEEE 
IECON-2003, pp. 347-352, Nov. 2003. 
[22] A. E. Glazounov, S. Wang, Q. M. Zhang, and C. Kim, “Piezoelectric stepper motor with 
direct coupling mechanism to achieve high efficiency and precise control of motion,” IEEE 
Transactions on Ultrasonics, Ferroelectrics and Frequency Control, vol. 47, no. 4, pp. 
1059-1067, 2000. 
[23] J. Friend, K. Nakamura, and S. Ueha, “A piezoelectric micromotor using in-plane shearing of 
PZT elements,” IEEE/ASME Transactions on Mechatronics, vol. 9, no. 3, pp. 467-473, 2004. 
[24] D. Shuxiang, S. P. Lim, K. H. Lee, Z. Jingdong, L. C. Lim, and K. Uchino, “Piezoelectric 
ultrasonic micromotor with 1.5 mm diameter,” IEEE Transactions on Ultrasonics, 
Ferroelectrics and Frequency Control, vol. 50, no. 4, pp. 361-367, 2003. 
[25] M. M. Bech, J. K. Pedersen, and F. Blaabjerg, “Field-oriented control of an induction motor 
using random pulsewidth modulation,” IEEE Transactions on Industry Applications, vol. 37, 
no. 6, pp. 1777-1785, 2001. 
[26] H. W. Kim and S. K. Sul, “A new motor speed estimator using Kalman filter in low-speed 
range,” IEEE Transactions on Industrial Electronics, vol. 43, no. 4, pp. 498-504, 1996. 
[27] T. J. Kweon and D. S. Hyun, “High-performance speed control of electric machine using 
low-precision shaft encoder,” IEEE Trans-actions on Power Electronics, vol. 14, no. 5, pp. 
838-849, 1999. 
[28] N. J. Kim, H. S. Moon, and D. S. Hyun, “Inertia identification for the speed observer of the 
low speed control of induction machines,” IEEE Transactions on Industry Applications, vol. 
32, no. 6, pp. 1371-1379, 1996. 
[29] K. B. Lee and F. Blaabjerg, “Robust and stable disturbance observer of servo system for 
low-speed operation,” IEEE Trans-actions on Industry Applications, vol. 43, no. 3, pp. 
  97
[42] B. Kim,S. Lee, J. H. Park, and J. O. Park, “Design and fabrication of a locomotive 
mechanism for capsule-type endoscopes using shape memory alloys (SMAs),” IEEE/ASME 
Transactions on Mechatronics, vol. 10, no. 1, pp. 77-86, 2005. 
[43] V. R. C. Kode and M. C. Cavusoglu, “Design and characterization of a novel hybrid actuator 
using shape memory alloy and DC micromotor for minimally invasive surgery applications,” 
IEEE/ASME Transactions on Mechatronics, vol. 12, no. 4, pp. 455-464, 2007. 
[44] T. Sebastian, G. Slemon, and M. Rahman, “Modelling of permanent magent synchronous 
motors,” IEEE Transactions on Magnetics, vol. 22, no. 5, pp. 1069-1071, Sep. 1986. 
[45] P. Pillay and R. Krishnan, “Modeling, simulation, and analysis of permanent-magnet motor 
drives. I. The permanent-magnet synchronous motor drive,” IEEE Transactions on Industry 
Applications, vol. 25, no. 2, pp. 265-273. Mar. / Apr. 1989. 
[46] G. Jang and M. G. Kim, “A bipolar-starting and unipolar-running method to drive a hard disk 
drive spindle motor at high speed with large starting torque,” IEEE Transactions on Magnetics, 
vol. 41, no. 2, pp. 750-755, Feb. 2005. 
[47] N. Bennett, J. Wang, D.W. Shimmin, and K. J. Binns, “A new vector control scheme for an 
adjustable speed AC drive system utilising a high field permanent magnet synchronous 
machine,” IEEE IEMDC-1993, pp. 121-126, Sep. 1993. 
[48] W. Leonhard, “Field-orientation for controlling AC machines-principle and application,” 
Conference Record in Power Electronics and Variable-Speed Drives, pp. 277-282, July 1988. 
[49] C. K. Lin, T. H. Liu, and C. H. Lo, “Sensorless interior permanent magnet synchronous motor 
drive system with a wide adjustable speed range,” IET Electric Power Applications, vol. 3, no. 
2, pp. 133-146, 2009. 
[50] N. Matsui, “Sensorless PM brushless DC motor drives,” IEEE Transactions on Industrial 
Electronics, vol. 43, no. 2, pp. 300-308, 1996. 
[51] L. Ju-Suk, T. Takeshita, and N. Matsui, “Stator-flux-oriented sensorless induction motor 
drive for optimum low-speed performance,” IEEE Transactions on Industry Applications, vol. 
33, no. 5, pp. 1170-1176, 1997. 
