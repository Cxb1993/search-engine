目錄 
中文摘要……………………………………………..……………I 
英文摘要…………………………………………….……………II 
報告內容 
一、前言及研究目的……………………………………..………1 
二、文獻探討………………………………………………..……1 
三、研究方法………………………………………………..……3 
四、結果與討論…………………………………………..………8 
五、參考文獻……………………………………………….……21 
六、計畫成果自評……………………………………….………22 
 
附錄: 
1. Cheng-Ling Lee , Ray-Kuang Lee , Yee-Mou Kao , “ Design of multichannel DWDM fiber Bragg 
grating filters by Lagrange multiplier constrained optimization,” Optics Express , Vol. 14, No. 23, 
pp.11002-11011, Nov. 2006. (SCI) (NSC-95-2221-E-239-053). 
2. Cheng-Ling Lee, Ray-Kuang Lee , Yee-Mou Kao, “Synthesis of Long-Period Fiber Gratings with a 
Lagrange Multiplier Optimization Method,” Optics Communications, In Press 2007. (SCI). 
(NSC-95-2221-E-239-053) 
3. Cheng-Ling Lee, Ray-Kuang Lee , Yee-Mou Kao, “Lagrange Multiplier Constrained Optimization 
for Designing Narrowband Dispersionless Fiber Bragg Gratings,” accepted, Optical 
Engineering,2007. (SCI). (NSC-95-2221-E-239-053). 
          II 
 
 
 
英文摘要 
 
Optimal Control Technique (OCT) is an optimal algorithm using variation method and 
functional analysis to search optimal solutions for a given object function (target) and to control 
several designed parameters for the problem to be solved, while meeting a set of preset constrains. 
In many published papers, OCT has been successfully utilized for solving many optimal problems 
in engineering and mathematics fileds. In recent years, linear and nonlinear fiber gratings have 
played important roles in many advanced applications. Among these, the linear fiber gratings with 
linear coupling coefficients, for example: Fiber Bragg Grating、Long-Period Fiber Grating， and the 
nonlinear fiber gratings have the second-order coupling coefficients in their grating structures, such 
as QPM (quasi- phase-matching) devices. The feature of fast astringency is very well in OCT 
algorithm and it has never been used in the inverse design of linear or nonlinear fiber gratings. 
Therefore, the main research of this project is to develop an OCT optimization algorithm for the 
inverse design of the advanced linear fiber gratings for fiber-optics applications. The same method 
can be applied to the design of second-order nonlinear QPM fiber gratings which can achieve SH 
pulse shaping and SH pulse compression. Therefore, the investigations involved in this project will 
include the development of new algorithms for both linear and nonlinear fiber grating designed 
tasks. 
 
 
 
Keyword: optimal control technique, fiber gratings 
 
 
 2
possibilities for the design of gratings. Peral et al. [1] proposed an iterative, numerical method to solve 
the Gel’fand-Levitan-Marchenko(GLM) equations in order to synthesize arbitrary grating response 
and yield smoother coupling coefficients than those obtained from previous methods. In 1999, Feced 
et al. [3] adopted an efficient method for the design of complex fiber Bragg gratings. The method 
relies on the synthesis of the impulse response of the grating by means of a so-called differential 
layer-peeling (LP) algorithm. The algorithm takes into account all the multiple reflections inside the 
grating, giving an exact solution to the inverse scattering problem. Its low algorithmic complexity 
enables the synthesis of long fiber gratings and the complexity of the algorithm grows only as 
)( 2NO and is usually well suited for parallel computation. 
In 2000, a direct and simple algorithm, the so-called continuous layer-peeling algorithm (CLP), was 
proposed by Poladian [4]. One can now synthesize a grating from any reflection spectrum by direct 
solution of the standard couple-mode equation while simultaneously evaluating a simple integral to 
obtain the grating coupling strength. This approach has the advantage of being based on a 
well-understood set of equations, making it amenable to physical interpretation, mathematical 
approximation, and generalization.  
From 2001, inverse scattering discrete layer-peeling (DLP) algorithm [5] has been widely used as a 
powerful tool for designing complex FGs devices. By DLP method, one can find the grating structure 
from a given reflection spectrum simply by propagating the fields along the grating structure, while 
simultaneously evaluating the grating strength using the causality argument. In 2003, a DLP-based 
two stage design approach was presented for designing dispersionless FBGs with shorter grating length 
for practical applications [6]. Although these layer-peeling algorithms are general and powerful 
computation, the profile of the coupling coefficient (κ(z)) found by these methods are in general very 
complicated. Such a κ(z) with a complex distribution and with values over the feasible range that can 
be achieved by photosensitive fibers may result in the impossibility of practically implementing such a 
grating.   
In addition to the above methods, another branch of synthesis methods of fiber gratings, different kind 
of Monte-Carlo optimization approaches (Tabu search, genetic algorithms or evolutionary algorithms) 
[7-13], have been applied to synthesize low dispersion (linear phase) FBGs and long-period fiber 
gratings (LPGs) according to the above mentioned specifications. An optimizing Genetic Algorithm 
(GA) method has been demonstrated by J. Skaar et.al. [7]. The GA algorithm facilitates different 
trade-offs in the design process. However, since the GA method can be slow and not guaranteed to 
converge, it still may not be a desirable method.  
Recently, a new optimization-based approach for multichannel FBGs for DWDM has been presented 
[14]. The approach is based on a simple and direct algorithm, the Lagrange multiplier constrained 
optimization (LMCO) with optimal control technique. In the present work, for demonstrating the 
 4
Where ( ) ( ) ( ) 20/0 RSr =λ is the calculated reflection spectrum, L is the total length of the grating, and β is 
a positive number acting as a weighting parameter for the constraint control. In the defined cost 
functional, Eq. (2), the spatially coupling coefficient κ(z) is used to shape an output reflection 
spectrum )(λr  of a given reflection spectrum )(λdr  and to minimize both the reflection spectra 
difference and the norm of the coupling coefficient profiles simultaneously.  
In the proposed method, the forward / backward-modes and the Lagrange multipliers are separated 
into real and imaginary parts, respectively, i.e. IR iRRR += , IR iSSS += , IRRRR i ,, µµµ +=  and 
ISRSS i ,, µµµ += . 
To minimize the cost functional J , a variational method for Eq (2) is used with respect to the 
forward- and backward- modes R and S through the Lagrange multipliers Rµ and Sµ . The resulting 
equations of motion for the Lagrange multipliers are  
                     SRR iiz
κµµδµ −⋅=∂
∂
                          (3a) 
RS
S ii
z
µκµδµ *+⋅−=∂
∂
                        (3b) 
with the boundary conditions obtained by varying R and S at z=0,  
                     ( ) ( ) 22200
IR
r
R RR
rR +
∆−=µ                         (4a) 
( ) ( ) 22200
IR
r
S RR
S +
∆=µ                           (4b) 
where )()( λλ dr rr −=∆  is the discrepancy between the output and target reflection spectrum. Then, the 
cost functional J  is varied with respect to the coupling coefficient function κ(z)  
( ) λµµκβδκδ dRSiJ SR∫∞∞− −+⋅= ***                (5) 
Finally, the Eq.s (1)-(5) are solved in a self-consistent way with the following procedures: 
(a) Guess an initial ( )ziniκ and let ( ) ( )zz iniold κκ = . 
(b) Solve the Eq.(1) and R(z) and S(z) can be obtained from Lz = to 0=z . 
(c) Set the boundary conditions of ( )0Rµ and ( )0Sµ by using Eq. (4). Then, the propagations of the 
Lagrange-multiplier functions ( )zRµ and ( )zSµ  from 0=z to Lz =  can be obtained by solving 
 6
              ( )[ ] ( )[ ]∫ ∫∞∞− +−=Φ Ldco dzzdTT 0 22 2)(21 κβλλλ                (8) 
where ( ) ( ) ( ) 20/ cococo ALAT =λ is the calculated transmission spectrum of output core mode for LPG, 
)(λdT  is the target transmission spectrum, L is the total length of the grating, and β is a positive 
number acting as a weighting parameter for the constraint control on the spatial coupling 
coefficient, )(zκ . In the defined cost functional, Eq. (8), the spatially coupling coefficient κ(z) is used 
to shape an output transmission spectrum in the core mode )(λcoT  for a given transmission spectrum 
)(λdT , meanwhile both the spectra discrepancy and the norm of the coupling coefficient profiles are 
minimized simultaneously. In the proposed LMO algorithm to synthesize LPGs, the Lagrange 
multipliers coµ  and clµ  were introduced for the core and cladding modes of LPG, respectively. 
With the objective functional for LPG inverse design in Equation (2), a specific cost functional is 
expressed as follows: 
      
dzdAiAi
dz
dA
dzdAiAi
dz
dA
dzdAiAi
dz
dA
dzdAiAi
dz
dA
J
L cocl
cl
cl
I
L cocl
cl
cl
R
L clco
co
co
I
L clco
co
co
R
λκδµ
λκδµ
λκδµ
λκδµ
∫ ∫
∫ ∫
∫ ∫
∫ ∫
∞
∞−
∞
∞−
∞
∞−
∞
∞−
⎥⎦
⎤⎢⎣
⎡ −+⋅+
⎥⎦
⎤⎢⎣
⎡ −+⋅+
⎥⎦
⎤⎢⎣
⎡ −−⋅+
⎥⎦
⎤⎢⎣
⎡ −−⋅+
Φ=
0
*
0
*
0
0
Im
Re
Im
Re
.            (9) 
The core and cladding modes, )(zAco  and )(zAcl , coupling coefficient, )(zκ , and the Lagrange 
multipliers, coµ  and clµ , used in LMO methods are all complex numbers here. We separate these 
complex variables into real and imaginary parts, respectively, i.e. coI
co
R
co iAAA += , clIclRcl iAAA += , 
IR iκκκ += , coIcoRco iµµµ +=  and clIclRcl iµµµ += . To minimize the cost functional, J , in Equation 
(9) a variational method was used with respect to coI
co
R AA   , of the core mode, and 
cl
I
cl
R AA   , of the 
cladding mode through the Lagrange multipliers )(),( zz clco µµ   . The resulting equations of motion for 
the Lagrange multipliers can be derived as follows, 
 8
(a) Guess an initial coupling coefficient function Rκ (only real part is given for simplifying the 
algorithm).  
(b) Calculate the core and cladding modes, )(zAco  and )(zAcl , with Eq. (1) from 0=z  to Lz =  
with the given initial conditions, 1)0( =coA , 0)0( =clA and obtain all values of )(zAco , )(zAcl  
from 0=z  to Lz = . 
(c) If the )(LAco , )(LAcl  are calculated and known, then the boundary condition at Lz =  for the 
Lagrange-multipliers, coµ  and clµ , in Eq. (11) are known as well. 
(d) Compute the propagation of the Lagrange-multiplier functions in Eq. (10) from Lz =  to 0=z  
with the boundary conditions in Eq. (11). 
(e) Update the new coupling coefficient profile with a suitable ad hoc parameter by using the Eq. 
(12) and (13). 
(f) Repeat step (b) to step (e) until 0=
R
J
δκ
δ  and 0=
I
J
δκ
δ , i.e. the LMO method converges. 
四、模擬結果與討論 
1. Designing fiber Bragg gratings (reflection-type) with constrained LMO 
algorithm 
In order to evaluate the effectiveness of the proposed LMO algorithm for FBG filter design, several 
MCFBG filters with different grating length, channel spacing and bandwidth are presented in this 
section. All of the MCFBG filters are designed with the LMO algorithm described in the previous 
section with a same initial Gaussian apodization profile for the coupling coefficient. In the designed 
MCFBGs, the target spectrum of the reflectivity is set to be  
∑
−
−= ⎪⎪⎭
⎪⎪⎬
⎫
⎪⎪⎩
⎪⎪⎨
⎧
⎥⎥
⎥⎥
⎦
⎤
⎢⎢
⎢⎢
⎣
⎡
∆
⎟⎠
⎞⎜⎝
⎛ ∆⋅++−
−⋅=
1
2
2
20
0
)
2
12(
exp
N
Nm
CSc
m
rr λ
λλ
            (14) 
where N is the total number of the channels, 0r  is the maximum reflectivity, λc is the central 
wavelength, ∆CS is channel spacing, and ∆λ  is the bandwidth for each channel. The total number of 
the calculated spectral points is set to be 200 and the central wavelength is set to be 1.55×10 3− mm 
(1550nm). The units of λ and L are mm , and κ(z) is 1−mm . In the LMO algorithm for synthesizing 
MCFBGs, α is an ad hoc constant and β is a weighting parameter which is zero for unconstrained 
 10
1549.6 1549.75 1549.9 1550.04
-500
-250
0
250
500
Wavelength(nm)
D
is
pe
rs
io
n 
(p
s/
nm
)
0 5 10 15 20 25 30
-4
-2
0
2
4
6
8
x 10
-4
In
de
x 
M
od
ul
at
io
n 
∆ n
Grating Length (mm)
Initial ∆n
Final ∆n(d)
(c)
 
Fig. 1 Two-channel low dispersion FBG filter with channel spacing 50GHz synthesized by the 
LMO method. (a) Reflection spectrum and dispersion profile, (b) transmission and target 
spectra, (c) the detailed dispersion profile in one channel, (d) designed apodization profile of 
the index modulation. 
 
In the following design example, an eight-channel FBG, N=8, with grating length 80mm, channel 
spacing 25GHz and the ∆λ =0.088nm corresponding to a bandwidth of full width at half maximum 
0.16nm and bandwidth 0.2nm in -50dB is synthesized. The simulation results appear in Fig. 2. Again, 
the designed reflection spectrum meets very well with the target spectrum in Fig. 2(a) with more than 
30dB isolation outside the channels. In Fig. 2(c), the dispersion profile in one channel of the 8-channel 
FBG is shown. The apodization profile of the index modulation for this eight-channel FBG filter is 
shown in Fig. 2(d), with the maximum index modulation 1.6 times higher than the single-channel one 
(initial Gaussian apodization). It should be noted that the simulation is finished after hundreds of 
iterations. The convergence of the LMO method for MCFBG syntheses is efficient and 
monochromatic. Unlike other phase sampling approaches, no additional Monte-Carlo based 
optimization algorithm is used here. The typical evolution curves of the calculated average error (total 
error divided by the number of spectral points) for the cases of N = 2, 4, 8 channel numbers are shown 
in Fig. 3. The reason why the initial error increases with the channel number is simply because we use 
the same Gaussian apodization function as the initial guess for all the design cases. When the channel 
number is increased, the initial error is increased due to the larger mismatch. However, the important 
thing here is that the convergence behavior (or trend) for different channel numbers is basically the 
same as can be seen in Fig.3, despite the different magnitude of the initial errors. That is, the 
convergence quality actually does not degrade due to the increase of the channel numbers. This proves 
the suitability of the present method for designing complicated multichannel FBG filters. 
 12
0 50 100 150 200 250 300
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
Iteration
A
ve
ra
ge
 e
rro
r
two-channel
four-channel
eight-channel
 
Fig. 3 Typical evolution curves of the average error for the designed MCFBGs in the LMO method. 
In the above MCFBG syntheses, the weighting parameter β is zero for the unconstrained design. In 
this case, the maximum index modulation approximately grows proportional to the square root of the 
channel numbers, the same rate as a phase sampling approach. To further decrease the maximum value 
of the index modulation, β = -7101×  is used to control the maximum index modulation in the 
apodization profile. In Fig. 4, it can be seen that the maximum index modulation of a MCFBG could 
be significantly decreased to the same magnitude as the single-channel FBG case by slightly 
sacrificing the channel reflectivity.  
1548 1549 1550 1551 1552
-40
-30
-20
-10
0
Wavelength (nm)
R
ef
le
ct
iv
ity
 (d
B
)
0 5 10 15 20 25 30
-5
0
5
10
x 10
-4
Grating length (mm)I
nd
ex
 M
od
ul
at
io
n 
∆ n
β= 0
β=10-7
β= 0
β=10-7
(a)
(b)
 
1548 1549 1550 1551 1552
-40
-30
-20
-10
0
Wavelength(nm)
R
ef
le
ct
iv
ity
(d
B
)
0 10 20 30 40 50 60 70 80
-5
0
5
10
x 10
-4
Grating Length(mm)I
nd
ex
 M
od
ul
at
io
n 
∆ n
β=0
β=10-7
β=0
β=10-7
(c)
(d)
 
Fig. 4 Reflection spectra and the apodization index profiles for (a), (b) two-channel FBG and (c), (d) 
eight-channel FBG  with the weighting parameter β = 0 and 7101 −× for unconstrained and constrained 
coupling coefficient designs, respectively.  
 14
Moreover, due to the intrinsic variation-based property of the proposed LMO method, the final 
apodization profile of the index modulation has very similar shape with the initial guess one. To prove 
this point, in the following simulations, we compare the syntheses of linear LPGs with different 
maximum values of 0n∆  as well as different initial apodization functions, in Figures 6-8. Except for 
the above mentioned Gaussian function, initial guess index modulations as sinc function ( )(zSC , Fig. 
7), and uniform function (Fig. 8) are also presented with the explicit formulations of 
)]50( [10π sinc∆ 0 L
L.zn)z(SC −⋅= . Due to the linear transmission spectrum of the target, one can see 
that the synthesized LPGs have better results when the initial guess functions are sinc functions. In 
this situation, for a broad range of the initial guess value for the maximum value of the index 
modulation 0n∆ , a fast and monochromatic convergence rate of the average errors can be obtained, as 
shown in Fig. 7(d). Figure 8 shows the corresponding final synthesized index modulation profiles, the 
calculated transmission spectra, and the curve of the average errors for an initial uniform coupling 
coefficient profile. To achieve a smooth convergence rate for the average error, our calculations also 
indicate that the maximum value of the initial index modulation 0n∆  should not be too larger in the 
LMO algorithm.  
 
0 5 10 15 20 25 30 35 40
0
0.5
1
x 10
-4
In
iti
al
 ∆n (a)
0 5 10 15 20 25 30 35 40
0
0.5
1
x 10
-4
A
m
pl
itu
de
 o
f f
in
al
 ∆n
  
Grating Length(mm)
(b)
α=5x102
α=1x103
α=5x103
α=1x104
1.53 1.54 1.55 1.56 1.57 1.58
0
0.5
1
Wavelength(µm)
Tc
o (c)
0 100 200 300 400 500
0
0.05
0.1
0.15
0.2
Iteration
A
ve
ra
ge
 e
rro
r
(d) α=5x102
α=1x103
α=5x103
α=1x104
Target
α=5x102
α=1x103
α=5x103
α=1x104
 
Fig.5 (a)The initial guess of the Gaussian apodization coupling coefficient for the proposed algorithm, 
(b) final designed amplitude of the apodization profiles, (c) synthesized core mode transmission 
spectra, and (d) typical evolution curves of the absolute value of average error (average t∆ ) for 
the designed linear LPGs with different ad hoc parameter α in the LMO method. 
 16
0 5 10 15 20 25 30 35 40
0
0.5
1
1.5
x 10
-4
In
iti
al
 ∆n
(a)
0 5 10 15 20 25 30 35 40
0
1
2
3
4
x 10
-4
A
m
pl
itu
de
 o
f f
in
al
 ∆n
  
Grating Length(mm)
(b)
∆n0=1x10-5
∆n0=5x10-5
∆n0=1x10-4
1.53 1.535 1.54 1.545 1.55 1.555 1.56 1.565 1.57
0
0.5
1
Wavelength(µm)
Tc
o
(c)
0 100 200 300 400 500
0
0.1
0.2
0.3
0.4
Iteration
A
ve
ra
ge
 e
rro
r
(d)
∆n0=1x10-5
∆n0=5x10-5
∆n0=1x10
-4
Target
∆n0=1x10-5
∆n0=5x10-5
 ∆n0=1x10-4
 
Fig.8 (a) The initial guess of the uniform index modulation with different maximum value of index 
modulation 0n∆ , (b) final designed amplitude of apodization profiles, (c) synthesized core 
mode transmission spectra, and (d) typical evolution curves of the average error for synthesized 
linear LPGs. 
Another example to demonstrate by LMO method is the well known EDFA gain flattening LPG 
(EDFA-GFLPG). For the designed EDFA-GFLPGs, the center wavelength is set at the 
wavelength mm.D
3105311 −×=λ . First of all, results of the designed EDFA-GFLPGs with different 
ad hoc values are shown in Figure 9, where a uniform initial guess index modulation profile is used 
with 50 105.1∆n
−×= . The comparisons of the final index modulation profiles, the calculated 
transmission spectra, and the tendency of the average error convergence are shown in Figures 9(b)-(d). 
From the calculations, best convergence of the average errors occurs with the α  value about 3105× . 
Next we try to use different initial guess of the apodization functions to synthesize EDFA-GFLPGs, 
with fixed 50 105.1∆n
−×= and 3105×=α . Figures 10(a) and 10(b) show the initial and the final 
designed profiles of index modulations with uniform, sinc, Gaussian, and sinusoidal functions. In this 
case, again the final synthesized apodization functions are shaped into similar profiles as the initial 
guess functions. For a smaller value of the maximum value of 0n∆ = 5105.1 −× , the convergence rates 
of the average errors are all efficient no matter what kind of the initial guess index modulation profile 
is chosen, as shown in Fig. 10(d). However, for a larger value of 0n∆ , say about 4105.2 −× , the LMO 
algorithm becomes divergent for the uniform initial guess profile. In the other hand, the LMO 
algorithm are more stable by using initial guess functions with sinc and Gaussian profiles, as shown in 
Fig.11. From the simulation results for designing EDFA-GFLPGs, we find that the best results can be 
 18
0 5 10 15 20 25 30 35 40
0
1
2
3
x 10
-5
In
iti
al
 ∆ n (a)
0 5 10 15 20 25 30 35 40
0
0.5
1
1.5
x 10
-4
A
m
pl
itu
de
 o
f f
in
al
 ∆ n
Grating Length(mm)
(b)
α=1x104
α=5x103
α=1x103
α=5x102
∆n0=1.5x10-5
1.52 1.53 1.54 1.55 1.56 1.57 1.58
0
0.5
1
Wavelength (µm)
Tc
o
(c)
Target
α=1x104
α=5x103
α=1x103
α=5x102
0 100 200 300 400 500
0
0.2
0.4
0.6
0.8
Iteration
A
ve
ra
ge
 e
rro
r α=1x104
α=5x103
α=1x103
α=5x102
(d)
 
Fig.9. Designing of a 4cm long EDFA-gain flattering LPG with different ad hoc parameter α in LMO 
algorithm; (a) the initial guess index modulation profile, (b) final designed amplitude profiles, 
(c) synthesized core mode transmission spectra, and (d) typical evolution curves of average 
error. 
 
0 5 10 15 20 25 30 35 40
-2
0
2
4
x 10
-5
In
iti
al
 ∆n
(a)
0 5 10 15 20 25 30 35 40
0
0.5
1
1.5
x 10
-4
A
m
pl
itu
de
 o
f f
in
al
 ∆n
Grating Length(mm)
(b)
uniform 
sinc 
Gaussian 
sine
uniform
sinc 
Gaussian 
sine
1.52 1.53 1.54 1.55 1.56 1.57
0
0.5
1
Wavelength(µm)
Tc
o
(c) Target
 uniform
 sinc 
 Gaussian
 sine
0 50 100 150 200
0
0.2
0.4
0.6
0.8
Iteration
A
ve
ra
ge
 e
rro
r
(d)
 uniform
 sinc
 Gaussian
 sin
 
Fig.10 (a) Different initial guesses of the apodization function (with fixed 50 105.1n
−×=∆  and 
3105×=α ), (b) final designed amplitude of the index modulation, (c) synthesized core mode 
transmission spectra, and (d) typical evolution curves of the average error for EDFA-GFLPGs 
synthesis by LMO method. 
 20
0 5 10 15 20 25 30 35 40
0
1
2
x 10
-5
(a)
0 5 10 15 20 25 30 35 40
-5
0
5
10
x 10
-5
Fi
na
l ∆n (b)
Initial ∆n
Real part
 Imaginary part
0 5 10 15 20 25 30 35 40
0
0.5
1
x 10
-4
Grating Length(mm)
(c)
A
m
pl
itu
de
 o
f ∆
n
-1
0
1
P
ha
se
 o
f ∆
n 
( π)
 
Fig.13 Final designed complex index modulation profiles of the synthesized EDFA gain flattering 
LPG in Fig.12; (a) the initial guess index modulation profile, (b) the real and imaginary parts, 
and (c) the amplitude and phase of the final index modulation profiles. 
 
In this research, for the first time, a simple and fast fiber grating synthesis methods based on the LMO 
optimization algorithms have been investigated and demonstrated. Based on the simulation results, it 
has been found that single stage MCFBGs with arbitrary channel spacing and bandwidth of low 
dispersion for DWDM applications can be obtained by using the proposed design method. In addition, 
the maximum amplitude of the index profile of the designed MCFBGs can be reduced by choosing a 
properly constrained parameter in the LMO algorithm in order to obtain a better index modulation 
profile for practical photosensitivity fibers. As for transmission-type fiber gratings, such as linear LPG 
and EDFA gain flattening LPG filters with different parameters are successfully synthesized by using 
the proposed method. Based on the results with different ad hoc parameter, maximum values, and 
profiles of initial guess index modulation, the effects of these parameters in the LMO algorithm for 
designing LPGs and the corresponding convergence of average errors are analyzed systematically in 
this research. From this first study, it appears that the proposed approach is an effective method which 
converges quickly on designing not only reflection-type FBG but also transmission-type LPG filters.  
 
 
 
 
 22
Chem. Phys., vol. 104, pp.1173-1178, 1996. 
17. R. Buffa, “Optimal control of population transfer through the continuum,” Optics. 
Communications, vol. 153, pp.240-244, 1998. 
18. T. Erdogan, ”Fiber grating spectra,” J. of Lightwave Technol., vol. 15, no. 8, pp.1277-1294, 
1997. 
19. Cheng-Ling Lee, Ray-Kuang Lee, Yee-Mou Kao, “Synthesis of Long-Period Fiber Gratings with 
a Lagrange Multiplier Optimization Method,” Optics Communications, In Press, 2007. 
(NSC-95-2221-E-239-053)[附錄 2] 
20. Cheng-Ling Lee, Ray-Kuang Lee, Yee-Mou Kao, “Lagrange Multiplier Constrained 
Optimization for Designing Narrowband Dispersionless Fiber Bragg Gratings,” accepted, Optical 
Engineering,2007. (NSC-95-2221-E-239-053)[附錄 3] 
六、計畫成果自評 
拉格朗日(Lagrange)法，是一種利用變分法(variation method)及泛函分析(functional analysis)找尋
一個給定目標函數(Object function)極小值並可控制多項變數的最佳化方法，文獻上，拉格朗日
法已經成功應用並計算一些數學的最佳化問題。有鑒於近幾年，光纖光柵被動元件在光電領域
及科技應用上著實扮演重要角色，因此在提升這些進階元件性能及大量製程的可行性之前，發
展出新的逆向設計演算法及相關程式工具成為目前極為重要的工作。本研究計畫已成功得利用
拉格朗日最佳演算法進行新穎光纖光柵元件之逆向設計，這些元件包括有: (1)應用於 DWDM多
波道低色散之複雜光纖光柵濾波器，成果以發表於 Optics Express國際期刊[14]、(2) 掺鉺光纖
之長週期光纖光柵增益平坦器、應用於感測領域之長週期光纖光柵線性濾波器等之穿透式進階
光纖光柵元件，研究成果也於近期刊登於 Optics Communications國際期刊[19]、 (3) 多目標最
佳化的問題應用於窄帶通無色散布拉格光纖光柵, 研究成果已經被Optical Engineering期刊所接
受，並於近期刊登[20]，因此，95 年計畫成果主要在線性複雜光纖光柵元件之發展以及設計。
至於非線性之相關元件則為 96 年計畫主要進展的項目。  
 
 
 
 
sensor applications using covariance matrix adapted evolution algorithm,” Opt. Commun. 260, 716–722 
(2006). 
10. S. Baskar, R. T. Zheng, A. Alphones, N. Q. Ngo, and P. N. Suganthan, “Particle swarm optimization for the 
design of low-dispersion Fiber Bragg Gratings,” IEEE Photon. Technol. Lett. 17, 615-617 (2005). 
11. R. Feced, M. N. Zervas, and M. A. Muriel, “An efficient inverse scattering algorithm for the design of 
nonuniform fiber Bragg gratings,” IEEE J. Quantum Electron. 29, 1824-1834 (1993). 
12. J. Skaar, L. Wang, and T. Erdogen, “On the synthesis of fiber Bragg grating by layer peeling,” IEEE J. 
Quantum Electron. 37, 165-173 (2001). 
13. H. Li and Y. Sheng, “Direct design of multichannel fiber Bragg grating with discrete layer-peeling 
algorithm,” IEEE Photon. Technol. Lett. 15, 1252-1254 (2003). 
14. Q. Wu, P. L. Chu, and H. P. Chan, ”General design approach to Multichannel Fiber Bragg Grating,” J. of 
Lightwave Technol. 24, 1571-1580 (2006). 
15. N. Wang and H. Rabitz, “Optimal control of pulse amplification without inversion,” Phys. Rev. A 53, 
1879-1885 (1996). 
16. N. Wang and H. Rabitz, “Optimal control of population transfer in an optical dense medium,” J. Chem. Phys. 
104, 1173-1178 (1996). 
17. R. Buffa, “Optimal control of population transfer through the continuum,” Opt. Commun. 153, 240-244 
(1998). 
18. F. I. Lewis, Optimal Control, (Wiley, New York, 1986). 
19. S. A. Rice and M. Zhao, Optimal Control of Molecular Dynamics, (Wiley, New York, (2000). 
 
1. Introduction 
Fiber Bragg gratings (FBGs) are essential optical devices both for fiber communications and 
sensor applications due to their powerful ability to act as narrowband filters, optical add-drop 
multiplexers, dispersion compensators and cavity mirrors in fiber lasers [1]. Among these, 
superstructure or sampled FBG filters are especially attractive for dense 
wavelength-division-multiplexing (DWDM) applications in the existing long-haul fiber 
network due to their comb filter response [2], [3].  
With a periodic sampling function for the single channel seed grating profile, one can 
generate a multiple channel reflection spectrum by a sampled FBG. Subsequently, it has been 
found that sampled FBGs could be extended to compensate simultaneously for both the 
dispersion slope and the dispersion itself [4-6]. However, in comparison to a single channel 
grating, manufacture of an N-channel FBG device requires larger variation of the 
photo-induced refractive index change. In fact, it has been shown that the total index change is 
directly proportional to the number of the constituent gratings to be written, N times higher 
than a single channel grating [2]. Since the maximum index change with UV irradiation in 
silica glass is in the order of 0.001, there is an upper bound on the number of gratings that can 
be written by the superposition method in practical fabrication. Therefore, phase sampling is a 
preferred method for high-channel count FBG designs as the index modulation requirement 
for optimized gratings is only a square root growth with the number of channels, N times 
higher [7], [8]. In the literature, there have been many developed optimization-based or 
inverse design methods for fiber Bragg grating filters [9-12]. Among these methods, the 
inverse scattering discrete layer-peeling (DLP) algorithm has been used to directly design 
multichannel fiber gratings with an additional simulated annealing optimization process for 
different channel phases [13]. Recently, a general design method based on a genetic algorithm 
has also been applied to design the multichannel optical add-drop multiplexer as well as its 
dispersion shifts [14].  
However, for these approaches, the simplicity, efficiency, and direct synthesis advantages 
of the DLP algorithm are faded due to the inclusion of an additional Monte-Carlo approach 
(simulated annealing or genetic algorithms). What is more, all these methods mentioned above 
are complicated and lacking the design flexibility for practical applications. In other words, 
the flexibility of spectrum-tailoring for filter design, fabrication and packaging is limited.  
In this study, a new optimization-based approach for synthesizing the MCFBG filters for 
DWDM applications is investigated. The approach is based on a simple algorithm, the 
(C) 2006 OSA 13 November 2006 / Vol. 14,  No. 23 / OPTICS EXPRESS  11003
    
( )[ ] ( )[ ]
dzdRiSi
dz
dS
dzdRiSi
dz
dS
dzdSiRi
dz
dR
dzdSiRi
dz
dR
dzzdrrJ
L
IS
L
RS
L
IR
L
RR
L
d
λκδμ
λκδμ
λκδμ
λκδμ
κ
βλλλ
∫ ∫
∫ ∫
∫ ∫
∫ ∫
∫ ∫
∞
∞−
∞
∞−
∞
∞−
∞
∞−
∞
∞−
⎥
⎦
⎤
⎢
⎣
⎡
++⋅+
⎥
⎦
⎤
⎢
⎣
⎡
++⋅+
⎥
⎦
⎤
⎢
⎣
⎡
−−⋅+
⎥
⎦
⎤
⎢
⎣
⎡
−−⋅+
+−=
0
*
,
0
*
,
0 ,
0 ,
0
22
Im
Re
Im
Re
2
)(
2
1
            
Where ( ) ( ) ( )20/0 RSr =λ is the calculated reflection spectrum, L is the total length of the 
grating, and β is a positive number acting as a weighting parameter for the constraint control. 
In the defined cost functional, Eq. (2), the spatially coupling coefficient κ(z) is used to shape 
an output reflection spectrum )(λr  of a given reflection spectrum )(λdr  and to minimize 
both the reflection spectra difference and the norm of the coupling coefficient profiles 
simultaneously.  
In the proposed method, the forward / backward-modes and the Lagrange multipliers are 
separated into real and imaginary parts, respectively, i.e. IR iRRR += , IR iSSS += , 
IRRRR i ,, μμμ +=  and ISRSS i ,, μμμ += . 
To minimize the cost functional J , a variational method for Eq (2) is used with respect to 
the forward- and backward- modes R and S through the Lagrange multipliers Rμ and Sμ . The 
resulting equations of motion for the Lagrange multipliers are  
                       SR
R ii
z
κμμδμ −⋅=
∂
∂
                             (3a) 
        RS
S ii
z
μκμδμ *+⋅−=
∂
∂
                           (3b) 
with the boundary conditions obtained by varying R and S at z=0,  
                      ( ) ( ) 22200
IR
r
R RR
rR
+
Δ
−=μ                             (4a) 
             ( ) ( ) 22200
IR
r
S RR
S
+
Δ
=μ                              (4b) 
where )()( λλ dr rr −=Δ  is the discrepancy between the output and target reflection 
spectrum. Then, the cost functional J  is varied with respect to the coupling coefficient 
function κ(z)  
( ) λμμκβ
δκ
δ dRSiJ SR∫
∞
∞−
−+⋅= **
*
                     (5) 
 
Finally, the Eq. (1)-Eq. (5) are solved in a self-consistent way with the following procedures: 
 
(a) Guess an initial ( )ziniκ and let ( ) ( )zz iniold κκ = . 
(b) Solve the Eq. (1) and R(z) and S(z) can be obtained from Lz = to 0=z . 
(2) 
(C) 2006 OSA 13 November 2006 / Vol. 14,  No. 23 / OPTICS EXPRESS  11005
1548 1548.5 1549 1549.5 1550 1550.5 1551 1551.5 1552
-40
-30
-20
-10
0
Wavelength(nm)
Re
fle
ct
ivi
ty
(dB
)
1548 1548.5 1549 1549.5 1550 1550.5 1551 1551.5 1552
-15
-10
-5
0
Wavelength(nm)
Tr
an
sm
is
sio
n
(dB
)
-6000
-4000
-2000
0
2000
4000
6000
D
is
pe
rs
io
n
 
(ps
/n
m
)
Target
Designed
(a)
(b)
 
1549.6 1549.75 1549.9 1550.04
-500
-250
0
250
500
Wavelength(nm)
Di
sp
er
si
o
n 
(ps
/n
m
)
0 5 10 15 20 25 30
-4
-2
0
2
4
6
8
x 10
-4
In
de
x 
M
o
du
la
tio
n
 Δ
n
Grating Length (mm)
Initial Δn
Final Δn
(d)(c)
 
Fig. 1. Two-channel low dispersion FBG filter with channel spacing 50GHz synthesized by the 
LMO method. (a) Reflection spectrum and dispersion profile, (b) transmission and target 
spectra, (c) the detailed dispersion profile in one channel, (d) designed apodization profile of 
the index modulation. 
In the following design example, an eight-channel FBG, N=8, with grating length 80mm, 
channel spacing 25GHz and the ∆λ =0.088nm corresponding to a bandwidth of full width at 
half maximum 0.16nm and bandwidth 0.2nm in -50dB is synthesized. The simulation results 
appear in Fig. 2. Again, the designed reflection spectrum meets very well with the target 
spectrum in Fig. 2(a) with more than 30dB isolation outside the channels. In Fig. 2(c), the 
dispersion profile in one channel of the 8-channel FBG is shown. The apodization profile of 
the index modulation for this eight-channel FBG filter is shown in Fig. 2(d), with the 
maximum index modulation 1.6 times higher than the single-channel one (initial Gaussian 
apodization). It should be noted that the simulation is finished after hundreds of iterations. The 
convergence of the LMO method for MCFBG syntheses is efficient and monochromatic. 
Unlike other phase sampling approaches, no additional Monte-Carlo based optimization 
algorithm is used here. The typical evolution curves of the calculated average error (total error 
divided by the number of spectral points) for the cases of N = 2, 4, 8 channel numbers are 
(C) 2006 OSA 13 November 2006 / Vol. 14,  No. 23 / OPTICS EXPRESS  11007
0 50 100 150 200 250 300
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
Iteration
Av
er
ag
e 
er
ro
r
two-channel
four-channel
eight-channel
 
Fig. 3. Typical evolution curves of the average error for the designed MCFBGs in the LMO 
method. 
In the above MCFBG syntheses, the weighting parameter β is zero for the unconstrained 
design. In this case, the maximum index modulation approximately grows proportional to the 
square root of the channel numbers, the same rate as a phase sampling approach. To further 
decrease the maximum value of the index modulation, β = -7101×  is used to control the 
maximum index modulation in the apodization profile. In Fig. 4, it can be seen that the 
maximum index modulation of a MCFBG could be significantly decreased to the same 
magnitude as the single-channel FBG case by slightly sacrificing the channel reflectivity.  
 
 
 
 
 
 
 
 
 
(C) 2006 OSA 13 November 2006 / Vol. 14,  No. 23 / OPTICS EXPRESS  11009
Acknowledgments 
The authors thank Prof. Yinchieh Lai for his useful discussions. This research is supported by 
the National Science Council of the Republic of China, NSC 94-2215-E-239-002 and NSC 
95-2120-M-001-006. 
(C) 2006 OSA 13 November 2006 / Vol. 14,  No. 23 / OPTICS EXPRESS  11011
Lagrange Multiplier Constrained Optimization for 
Designing Narrowband Dispersionless Fiber Bragg 
Gratings 
Abstract — This paper presents a new synthesized method for designing complex fiber 
Bragg gratings (FBGs). The method is based on a multiobjective Lagrange multiplier 
constrained optimization (LMCO) which various constraints of the designed filters can be 
added in with the consideration of practical application demands and fabrication requirements. 
That is, the maximum amplitude of the index modulation profiles of the designed FBGs can 
be substantially reduced under constrained conditions. When compared with layer-peeling 
(LP) algorithm, LMCO method can easily embedded with different types of requirement in 
terms of the user-defined cost function. Compared to stochastic approaches such as genetic 
algorithms and others, the proposed method is a direct optimization method but without using 
random numbers and therefore has a smoother coupling coefficient profile as well as faster 
convergence speed.  A theoretical model and investigation have been done in this study. A 
narrowband dispersionless fiber Bragg grating (NBDL-FBG) filter for optical fiber 
communication was designed and simulation results were compared with those of the LP 
algorithm. The study results demonstrate that the LMCO algorithm can provide an alternative 
for practical and complex fiber grating filters. 
 
 
 
 
 
 
Index Terms — Dispersionless Fiber Bragg gratings (FBGs), Lagrange multiplier 
constrained optimization (LMCO), Grating synthesis.  
 
 
does not use random numbers and thus has a smoother coupling coefficient profile as well as 
faster convergence speed. Moreover, by varying the weighting parameters according to 
user-defined cost function, the maximum index modulation of the designed gratings can be 
controlled to meet real fabrication requirements. Therefore, in this study, the proposed 
algorithm also took the phase parameters of the designed filters into consideration. The main 
aim of the present work was to carry out the theoretical framework and demonstrate the 
suitability and advantages of this method for advanced FBG filter design.  In the study, 
complete mathematical theory for multi-target optimal FBGs was obtained with the 
additional advantage of reducing the index modulation. The convergence rate was fast and 
direct for the LMCO algorithms when compared to the stochastic approach. This is, 
apparently, the first demonstration that the design of dispersionless FBGs from the LMCO 
multi-target optimization approach can indeed be achieved.  
The organization of this paper is as follows: In Section 2, the theoretical formulas of the 
Lagrange multiplier constrained optimization (LMCO) algorithm for the design of 
dispersionless FBGs are presented. Section 3 contains numerical results and comparisons to 
alternative synthesis methods, for example, the layer-peeling algorithm, and finally, the main 
conclusions are drawn in Section 5. The detailed derivation of the formulations for LMCO 
algorithm is presented in the Appendix section. 
2. Lagrange Multiplier Constrained Optimization (LMCO) Algorithm for Designing 
Dispersionless FBGs 
The LMCO algorithm is based on the well-known coupled-mode equations for FBGs [1]  
( ) ( ) ( ) ( )
( ) ( ) ( ) ( )                zRziκzSi
dz
zdS
zSziκzRi
dz
zdR
*−⋅−=
+⋅=
δ
δ
    (1)    
where the amplitudes R  and S  are the forward- and backward mode amplitudes， 
⎟⎠
⎞⎜⎝
⎛
Λ−=
12 0
λπδ
n  is wavelength detuning, and Λ is the grating period. The parameter κ(z) = 
ξπ ∆n(z) is the designed coupling coefficient distribution function with index modulation: 
∆n(z) of gratings. The main idea of the LMCO method is to define an objective function that 
needed to be minimized with respect to R  and S . For the convenience of variation with the 
modes, R  and S , in the dispersionless FBG design case, the objective function has to be 
defined as follows:  
 
where the forward / backward-modes R , S  and the Lagrange multiplier functions ),( zδμ  
were separated into real and imaginary parts, respectively, i.e. IR iRRR += , IR iSSS += , 
IRRRR i ,, μμμ +=  and ISRSS i ,, μμμ += . To minimize the cost functional J , a variational 
method for Eq. (4) was used with respect to the forward- and backward- modes R , S  
through the Lagrange multipliers Rμ  and Sμ . The proof is given in the Appendix. The 
resulting equations of motion for the Lagrange multipliers are  
( ) ( ) ( ) ( )zzizi
z
z
SR
R μκδμμ −=∂
∂
                                  (5)  
( ) ( ) ( ) ( )zzizi
z
z
RS
S μκδμμ +−=∂
∂
                                (6) 
with the boundary conditions at z=0  
[ ]))0(2)0(())0(2)0(()0(2)0( RSiRSrRr IIRRdrR ρρημ −Δ−−Δ⋅+Δ−=          (7) 
Δ⋅+Δ= )0()0(2)0( RrS drs ημ                                              (8) 
where  
)()( λλ dr rr −=Δ                                                      (9)          
is the discrepancy between the output and target reflection power, and 
2
,
R
-ρρ RdR
R =Δ ,                                                    (10) 
2
,
R
-ρρ IdI
I =Δ                                                       (11) 
are the real and imaginary parts of the normalized discrepancy between the complex output 
and target reflection coefficient spectra , respectively. Here the Δ  can be written as follows: 
)(4.0 10
−= mmκ is a constant value, FWHM  is set to be 6mm. In the designed NBDL-FBG, 
the target spectrum of the complex reflection coefficient for linear phase response is set to be  
( )δπδ
δλρ ××−⋅⎟⎟⎠
⎞
⎜⎜⎝
⎛
⎟⎟⎠
⎞
⎜⎜⎝
⎛−×= 3expexp)(
10
0 jr
c
d                   (16) 
Where )( 1−mmδ is the wavelength detuning parameter and )( 43.0 1−= mmcδ which 
corresponds to a bandwidth of full width at half maximum (-3dB bandwidth) of the filter 
about 0.2nm and -0.5dB bandwidth about 0.165nm, 0r  is the maximum reflectivity set 0.99. 
The central wavelength was always 1550nm. In the proposed algorithm, the units of λ and L  
are mm , and κ(z) is 1−mm . α, β and η are ad hoc constants which have different roles in 
different designs.  Parameter α is the evolution of the coupling coefficient, η is a weighting 
phase parameter which is nonzero for dispersionless FBG and zero for usual FBG when only 
the reflectivity spectrum is taken into consideration, and β is a constrained parameter for the 
coupling coefficient of the designed fiber grating which is zero for unconstrained conditions 
and nonzero for the constrained coupling coefficient.  The constraint on the value of the 
coupling constant can be easier enforced by sacrificing the reflectivity spectrum quality with 
an increase in the values of the weighting parameterβ. In this study, it was found that the best 
value of α was around 5101× and η was about 0.5, which produced an optimal and smoother 
convergence in the designed NBDL-FBG filters. The unconstrained synthesized results with 
α= 5101× , η=0.5 and β=0 for LMCO-NBDL-FBG (Lagrange multiplier constrained 
optimization narrowband dispersionless FBG) are given below.  Fig. 1 shows the 
synthesized reflectivity spectra of 0.2nm NBDL-FBG filters using LMCO and LP methods. 
The designed reflection spectrum met well with the target spectrum for a grating length of 
4cm. The corresponding apodization profiles of the index modulation (κ) with different 
methods are shown in Fig.2. The results show the apodization profile of the LMCO method 
as being more symmetrical than with the LP method. The initial guess of the Gaussian 
apodization profile (dotted line) for the proposed algorithm also appears in the Fig.2 as a 
reference. The in-band group delay and in-band dispersion profiles of the designed 
NBDL-FBG filters in Fig.1 appear in Fig.3. From Fig.3, it can be seen that the deviation of 
the LMCO-dispersion profile in 75% of the central region of the stopband is smoother and 
lower than that of the LP-dispersion profile. The better synthesis results comes from that we 
multiply the targeted reflection power )(λdr  in the third part of the cost function in Eq. (2), 
with this about 75% central region of stopband keeps maximum value 0r .   
the maximum value of the coupling coefficient function κ(z) can be reduced by 25%, from 
0.4 (mm 1− ) to 0.3 (mm 1− ). 
4. Conclusion 
In conclusion, a novel NBDL-FBG synthesizing method based on the multiobjective 
Lagrange multiplier constrained optimization (LMCO) is presented. The method is able to 
take into account multiple optimization objectives and various constrained parameters for 
practical application.  This is especially important in NBDL-FBG design, in which both the 
reflection power of the whole spectrum and the phase response of the in-band spectrum must 
be simultaneously optimized. Compared to stochastic approaches such as genetic algorithms 
or others, the proposed method is a direct optimization method which does not use random 
numbers (sectional structure) and therefore has a smoother coupling coefficient profile as 
well as faster convergence speed.  When compared to the existing results from the powerful 
layer-peeling (LP) method, we have demonstrated that an optimal 25 GHz (0.2nm) 
NBDL-FBG with an adaptive design for multiobjective optimization can be obtained by 
using the proposed method. Finally, except for the longer computation time, a number of 
advantages for using the proposed LMCO approach for solving the inverse design problems 
of FBGs have been identified. These advantages include the possibility to constrain the 
patterns of the coupling coefficient profiles, to constrain the fiber grating length, and to 
obtain better solutions by skillfully arranging the weighting parameters regarding cost. These 
features certainly have great merits in designing practical fiber grating devices with special 
requirements. 
5. Appendix 
In this appendix, we give the detailed derivations of the resulting equations of motion for the 
Lagrange multipliers in Eq. (5-6) and the boundary condition for the Lagrange multipliers in 
Eq. (7-8). First of all, we minimize the cost functional J  in Eq. (4) by the variational 
method. By the variation Eq. (4) with respect to RR  and IR , and we get 
,0=+∂
∂
κμσ-μ
z
μ
- S,IR,I
R,R              (A1.a) 
.0=+∂
∂
κσ-μμ
z
μ
- S,RR,R
R,I             (A1.b) 
Variation with RR  and IR  again, then the following equations are obtained 
Acknowledgements 
The authors thank Prof. Yinchieh Lai for his useful discussions. This research is supported by 
the National Science Council of the Republic of China, NSC 95-2221-E-239-053 and NSC 
95-2120- M-001-006. 
References 
1. T. Erdogan, “Fiber grating spectra,” J. of Lightwave Technol., 15(8), 1277-1294, (1997). 
2. A. M. Bruckstein and T. Kailath, “Inverse scattering for discrete transmission-line 
models,” SIAM Rev., 29(3), 359–389 (1987). 
3. A. M. Bruckstein, B. C. Levy, and T. Kailath, “Differential methods in inverse 
scattering,” SIAM J. Appl. Math., 45(2), 312–335 (1985). 
4. E. Brinkmeyer, “Simple algorithm for reconstructing fiber gratings from reflectometric 
data,” Opt. Lett., 20(8), 810–812(1995). 
5. E. Peral, J. Capmany, and J. Marti, “Iterative solution to the Gel’Fand- 
Levitan-Marchenko coupled equations and application to the synthesis of fiber 
gratings,” IEEE J. Quantum Electron., 32(12), 2078–2084 (1996). 
6. M. A. Muriel, J. Azana, and A. Carballar, “Fiber grating synthesis by use of 
time-frequency representations,” Opt. Lett., 23(19), 1526–1528 (1998). 
7. R. Feced, M. N. Zervas, and M. A. Muriel, “An efficient inverse scattering algorithm for 
the design of nonuniform fiber Bragg gratings,” IEEE J. Quantum Electron., 35(8), 
1105–1115 (1999). 
8. L. Poladian, “Simple grating synthesis algorithm,” Opt. Lett., 25(), 787-789 (2000). 
9. J. Skaar, L. Wang, and T. Erdogen, “On the synthesis of fiber Bragg grating by layer 
peeling,” IEEE J. Quantum Electron., 37(2), 165-173 (2001). 
10. J. Skaar and K. M. Risvik, “A genetic algorithm for the inverse problem in synthesis of 
fiber gratings,” J. Lightwave Technol., 16(10), 1928–1932 (1998). 
11. C- L. Lee and Y. Lai, “Evolutionary Programming Synthesis of Optimal long-Period 
Fiber Grating Filters for EDFA Gain Flattening,” IEEE Photon. Tech. Lett., 14(11), 
1557-1559 (2002). 
12. C- L Lee, “Designing Optimal Long-Period Fiber Gratings with the Overlapped 
Gaussian-Apodization Method for Flattening EDFA Gain Spectra,” Opt. Commun, 262, 
170-174 (2006). 
13. S. Baskar, P.N. Suganthan, N.Q. Ngo, A. Alphones, R.T. Zheng, “Design of triangular 
FBG filter for sensor applications using covariance matrix adapted evolution algorithm,” 
Opt. Commun., 260, 716-722 (2006). 
14. C- L Lee, R- K Lee and Y- M Kao, “Design of multichannel DWDM fiber Bragg 
grating filters by Lagrange multiplier constrained optimization,” Optics Express, 14(23), 
Electrical Engineering of National Taiwan University (EE/NTU) in 1993, and his 
MS degree and Ph.D. degree from Institute of Electro-Optical Engineering of 
National Chiao Tung University (IEO/NCTU), in 1999 and 2004 respectively. 
He worked as an assistant scientist at National Center for High-Performance 
Computing, Taiwan, from 2001 to 2004, and as a visiting fellow at The 
Australian National University, Australia, in 2004. Then he joined the Institute of 
Photonics Technologies of National Tsing Hua University as a faculty member at 
Aug. 2005. He is currently an assistant professor in the Institute of Photonics 
Technologies. His research interests include nonlinear optics, quantum optics, 
and device synthesis.  
 Yee-Mou Kao received his MS and Ph.D. degrees in Physics 
from National Tsing Hua University, Hsinchu, Taiwan, in 1991 and 1996, 
respectively.  Currently he is an associate professor at Department of Physics, 
National Changhua University of Education, Changhua, Taiwan. His research 
interests are mainly on the statistical physics related problems. Recently, he is 
engaged in the study of thermodynamic properties of trapped Bose-Einstein 
Condensation.  
 
 
 
 
 
1549.9 1549.95 1550 1550.05 1550.1
0
100
200
300
400
500
Wavelength(nm)
G
ro
up
 d
el
ay
 (p
s)
1549.9 1549.95 1550 1550.05 1550.1
-1000
0
1000
Wavelength(nm)
D
is
pe
rs
io
n 
(p
s/
nm
)
Designed on LP method
Designed on LMCO method(a)
(b)
 
Fig. 3 The synthesized (a) in-band group delay, and (b) in-band dispersion profiles of 0.2nm NBDL-FBG filters 
by using LMCO and LP methods.  
1549.9 1550 1550.1
-2000
0
2000
4000
Wavelength(nm)
D
is
pe
rs
io
n 
(p
s/
nm
)
0 10 20 30 40
0
0.2
0.4
Grating Length(mm)
κ  (
m
m
-1
)
0 500 1000
0.025
0.03
0.035
0.04
Iterations
A
ve
ra
ge
 Δ
1549 1549.5 1550 1550.5 1551
-70
-60
-50
-40
-30
-20
-10
0
Wavelength(nm)
R
ef
le
ct
iv
ity
(d
B
)
α=5x105
α=105
α=104
α=103
α=5x105
α=105
α=104
α=103
α=5x105
α=105
α=104
α=103
α=5x105
α=105
α=104
α=103
(a) (b)
(c)
(d)
 
Fig. 4 The synthesized (a) reflectivity spectra, (b) in-band dispersion profiles (c) designed apodization profiles, 
and (d) typical evolution curves of the average error (average Δ ) for the designed NBDL-FBG filters with 
different α values in the LMCO method. 
