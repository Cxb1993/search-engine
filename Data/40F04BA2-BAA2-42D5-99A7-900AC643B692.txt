control architecture, motion controller is designed 
to improve the bandwidth of servo systems and to 
generate smooth feedrate profiles. Otherwise, large 
jerk would reduce the accuracy, even might cause 
system vibration which decrease the machine life or 
break the tool. 
The purpose of the project is to investigate NURBS 
interpolator of five-axis machine tool. A real-time 
NURBS surface curve interpolation algorithm with 
look-ahead function is proposed to realize high-speed 
and high-accuracy five-axis machining. The 
constraints such as real-time performance, system 
dynamics and machining accuracy are considered 
simultaneously. As compared to the current 
literatures which only study the factors including 
surface geometry property, move to and out surface, 
tool orientation and tool offset, we will establish 
the more complete kinematic transformation matrix and 
servo dynamics for five-axis machine tool. System 
identification will be utilized to verify the 
developed model and for future improvement of the 
model. Based on the five-axis cross-coupled control 
model, we propose a procedure to develop the real-
time NURBS surface curve interpolator. The algorithm 
considers the important factors such as tool 
orientation, static chord error, dynamics contouring 
error, acceleration/deceleration, jerk-limit and 
real-time computing. Finally, the feasibility of the 
proposed algorithm will be verified on a five-axis 
milling machine. 
英文關鍵詞： Motion control, Real-time interpolation, Cross-
coupled Control, Five-axis machining, System 
dynamics, NURBS 
 
 2
 
國科會補助專題研究計畫成果報告自評表 
請就研究內容與原計畫相符程度、達成預期目標情況、研究成果之學術或應用
價值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）、是
否適合在學術期刊發表或申請專利、主要發現或其他有關價值等，作一綜合評
估。 
1. 請就研究內容與原計畫相符程度、達成預期目標情況作一綜合評估 
▓  達成目標 
□  未達成目標（請說明，以 100 字為限） 
□ 實驗失敗 
□ 因故實驗中斷 
□ 其他原因 
說明： 
 
 
 
2. 研究成果在學術期刊發表或申請專利等情形： 
論文：▓已發表 □未發表之文稿 □撰寫中 □無 
專利：□已獲得 □申請中 ▓無 
技轉：□已技轉 □洽談中 ▓無 
其他：（以 100 字為限） 
 
 
 
附件二 
 4
 
 
國科會補助專題研究計畫項下出席國際學術會議心得報告 
                                  日期： 100 年 10 月 27 日 
一、參加會議經過 
2011 年高等智能化機電整合國際會議(2011 IEEE/ASME International Conference on Advanced 
Intelligent Mechatronics, AIM2011)於 7月 3日至 7月 7日在匈牙利布達佩斯Mercure Budapest Buda Hotel
舉行。本屆大會共有來自世界各國之專家學者與民間廠商代表約 300-400 人與會，分別來自學術界、
研究機構、工程顧問公司、政府機關等，其中來自台灣之與會人員約二十多位。 
筆者於 7 月 3 日完成報到註冊手續並參加當天晚上之歡迎晚會，而正式大會則於 7 月 4 日早上 8
時 30 分揭開序幕。開幕典禮由本次會議的總主席致歡迎辭。典禮後並連續三天安排了四場精彩的重點
演講(Plenary Talk)：第一場次的演講者為來自德國奧斯格堡 Research & Development of KUKA 
Laboratories 的 Dr. Ralf Koeppe 專家；第二場次的演講者為來自美國 Carnegie Mellon University 的 Metin 
Sitti 教授；第三場次的演講者為來自匈牙利 Eötvös University 的 Ádám Miklósi 教授；第四場次的演講
者為來自日本 National Institute of Advanced Industrial Science and Technology 的資深研究學者 Takanori 
Shibata。筆者聆聽此次專題演講演講獲得不少的學術以及研究方面的啟發，對於日後的研究工作有莫
大的助益。各分組會議則於 7 月 4-6 日 3 天分別在四個(Room A,B,C,D)會場同時進行，筆者則被安排於
7 月 6 日上午 Room A, Session TA1 加工技術場次進行口頭報告，論文題目為”Analysis and compensation 
計畫編號 99-2221-E-150-023- 
計畫名稱 用於 CNC 工具機運動控制之即時 NURBS 曲面曲線差補器研究 
出國人員
姓名 林明宗 
服務機構
及職稱 
國立虎尾科技大學機械設計工程系 
助理教授 
會議時間 100 年 7 月 3 日至 100 年 7 月 7 日 會議地點 匈牙利布達佩斯 
會議名稱 
(中文)  2011 高等智能化機電整合國際會議 
(英文)  2011 IEEE/ASME International Conference on Advanced Intelligent 
Mechatronics (AIM2011) 
發表論文
題目 
(中文) 具傾斜搖籃平台五軸工具機之幾何誤差分析與補償 
(英文)  Analysis and compensation of geometric error for five-axis CNC 
machine tools with titling rotary table 
附件四 
Computer-Aided Design 43 (2011) 612–628
Contents lists available at ScienceDirect
Computer-Aided Design
journal homepage: www.elsevier.com/locate/cad
The feedrate scheduling of NURBS interpolator for CNC machine tools
An-Chen Lee a, Ming-Tzong Lin b,∗, Yi-Ren Pan a, Wen-Yu Lin a
a Department of Mechanical Engineering, National Chiao Tung University, Hsinchu 30010, Taiwan, ROC
b Department of Mechanical Design Engineering, National Formosa University, Yunlin 63201, Taiwan, ROC
a r t i c l e i n f o
Article history:
Received 18 April 2010
Accepted 26 February 2011
Keywords:
NURBS
Feedrate scheduling
Curve splitting
Off-line scanning
a b s t r a c t
This paper proposes an off-line feedrate scheduling method of CNC machines constrained by chord
tolerance, acceleration and jerk limitations. The off-line process for curve scanning and feedrate
scheduling is realized as a pre-processor, which releases the computational burden in real-time task. The
proposed method first scans a non-uniform rational B-spline (NURBS) curve and finds out the crucial
points with large curvature (named as critical point) or G0 continuity (named as breakpoint). Then, the
NURBS curve is divided into several NURBS sub-curves using curve splittingmethodwhich guarantees the
convergence of predictor–corrector interpolation (PCI) algorithm. The suitable feedrate at critical point
is adjusted according to the limits of chord error, centripetal acceleration and jerk, and at breakpoint is
adjusted based on the formulation of velocity variation. The feedrate profile corresponding to each NURBS
block is constructed according to the block length and the given limits of acceleration and jerk. In addition,
feedrate compensation method for short NURBS blocks is performed to make the jerk-limited feedrate
profile more continuous and precise. Because the feedrate profile is established in off-line, the calculation
of NURBS interpolation is extremely efficient for CNC high-speed machining. Finally, simulations and
experiments with two free-form NURBS curves are conducted to verify the feasibility and applicability
of the proposed method.
© 2011 Elsevier Ltd. All rights reserved.
1. Introduction
In order to achieve high-speed and high-accuracy machining,
many scholars devote to investigate the fields such as parametric
curve interpolation, feedrate profile scheduling and servo-loop
control techniques. Since 1950s, parametric curves like Bezier,
B-spline and NURBS have been developed. Because of the benefits
of NURBS [1], NURBS even becomes the standard format of free-
form curve and surface in 1991. Recently, STEP compliant NC
programming, STEP-NC has been specified as a new NC data
model [2,3]. NURBS is adopted by STEP-NC and becomes the
standard interface for data exchange between CAD/CAM and CNC
systems. How to design a reliable and efficient NURBS interpolator
is critical for developing the next generation intelligent CNC
machine tool.
Shpitalni et al. [4] first proposed parametric curve interpolation
and realized the parametric interpolator in CNC machine, which
accepts parametric curve codes directly from CAD/CAM. For
generating more precise motion trajectory, Yang and Kong [5]
applied Taylor’s expansion method to develop the first-order
and second-order interpolation algorithmswith constant feedrate.
∗ Corresponding author. Tel.: +886 5 631 5342; fax: +886 5 636 3010.
E-mail addresses: aclee@mail.nctu.edu.tw (A.-C. Lee), mtlin@nfu.edu.tw,
ericfishxp@gmail.com (M.-T. Lin).
Nevertheless, because of high-order truncation errors [6], Taylor
series interpolatormight not generate accurate feedrate command
alonghigh-curvature tool paths for high-speedmachining. Tsai and
Cheng [7] proposed a closed-loop predictor–corrector interpolator
(PCI) algorithm to replace Taylor’s expansionmethod and provided
the convergent condition of corrector. The advantage of PCI
method is that the feedrate fluctuation can be controlled through
setting tolerance of feedrate error for either given constant or
variable feedrate command. Erkorkmaz and Altintas [8] proposed
a quintic spline interpolation method to minimize feedrate
fluctuation. This is done by either approximating the relation
between the arc length and spline parameter using a feed
correction polynomial or by solving the exact parameter using an
iterative interpolation method. Otherwise, Lei et al. [9] proposed a
fast NURBS interpolation method which generated inverse length
functions (ILF) for each parameter subinterval in off-line. The new
setting path parameter was calculated directly by using the ILF
without the need for any time-consuming computation of NURBS
derivatives and iterations in real time. However, most of the
proposed methods attempt to maintain constant feedrate without
considering chord error and acceleration/deceleration (ACC/DEC).
Yeh and Hsu [10] first proposed an adaptive-feedrate interpo-
lator to adjust curve speed according to chord tolerance. Zhim-
ing et al. [11] presented a curvature-based interpolation algorithm
based on curvature of curves. Yang and Narayanaswami [12] pro-
posed an off-line algorithm to detect feedrate sensitive corners and
0010-4485/$ – see front matter© 2011 Elsevier Ltd. All rights reserved.
doi:10.1016/j.cad.2011.02.014
614 A.-C. Lee et al. / Computer-Aided Design 43 (2011) 612–628
Fig. 1. The flowchart of feedrate scheduling method.
3. Off-line curve scanning
In order to plan the feedrate profile of any given NURBS curve,
an off-line process for curve scanning and feedrate scheduling is
developed as a pre-processor, which releases the computational
burden in real-time task. The flowchart of the proposed feedrate
scheduling method is shown in Fig. 1. In the stage of curve
scanning, the breakpoints with G0 continuity are detected by
checking the multiplicity of knots in the knot vector of a NURBS
curve, and the curve is split into several NURBS sub-curves.
The adaptive-feedratewith curvature-based feedrate interpolation
algorithm [18] is utilized to scan a NURBS curve for determining
critical points with large curvatures. Furthermore, the suitable
feedrate Vi at each breakpoint is adjusted according to the limits
of velocity variation on motion axes. The suitable feedrate Vi at
each critical point is evaluated with the constraints of chord error,
centripetal acceleration and jerk limitations. Consequently, the
NURBS curve is divided into small NURBS blocks after determining
the breakpoints and critical points, which are called crucial
points. The curve parameters ui of crucial points are recoded
simultaneously. The length Si of each NURBS block between
two adjacent crucial points is estimated by the adaptive Lobatto
quadrature method [25]. Finally, the scanning data (ui, Vi, Si) for
each NURBS sub-curve and block are obtained and ready for the
next stage of feedrate scheduling presented in Section 4.
3.1. Kinematic constraints
To generate smooth tool path for NURBS curves, jerk-limited
feedrate profile should be planned in terms of acceleration and
jerk limits. Here, Amax and Jmax are denoted as acceleration and
jerk limits on each axis for CNC machine, respectively. The limits
616 A.-C. Lee et al. / Computer-Aided Design 43 (2011) 612–628
a b
c d
Fig. 4. The geometry and kinematic properties of a hat contour (a) curvature profile of hat curve; (b) critical points in Cases I and VI; (c) critical points in Cases II and III; (d)
critical points and breakpoints in Case II.
where δ, Ts and Vmax are chord tolerance, sampling time and
maximum feedrate, respectively. In Eq. (13), the first condition is
derived from the adaptive-feedrate interpolation algorithm [10];
the second and third conditions are derived from the equations
of centripetal acceleration and jerk in [17]. Any interpolation
point with its curvature κi being larger than the critical curvature
is defined as a candidate point since it exceeds one of three
constraints. The point which has the local maximum curvature
among the candidate points is defined as a critical point and
its suitable feedrate Vi is modified according to the following
equation.
Vi = min
 2
Ts

1
κ2i
−

1
κi
− δ
2
,

An
κi
, 3

Jn
κ2i
 (14)
where κi is the curvature of the critical point. The hat curve is
provided to further demonstrate the concept. The contour and
curvature profiles of the hat curve are shown in Figs. 2 and 4(a),
respectively. In general, one could expect that four points marked
as B, C, F and G should be identified as critical points because the
curvatures at these points are local maximum. In fact, the points
C and F might satisfy three constraints under some geometry and
kinematic conditions, only the points B and G need to be regarded
as critical points. In order to demonstrate howmany critical points
are detected under different conditions, four cases are tested
and the corresponding parameters are listed in Table 2. Case I
includes the following default values such as δ = 1 µm, Vmax =
100 mm/s, An = 800 mm/s2 and Jn = 26 400 mm/s2. In Case I,
two critical points of B and G are detected as shown in Fig. 4(a) and
(b). The critical curvature (κcr = 0.08) is determined by the second
condition in Eq. (13), and the suitable feedrates at the critical
points are constrained by centripetal acceleration. When the given
feedrate increases to 250 mm/s in Case II, four critical points of B,
C, F and G are obtained as shown in Fig. 4(c). The critical curvature
(κcr = 0.0128) is still determined by the second condition. As
compared with Case I, if the chord tolerance is reduced from 1µm
to 0.1 µm in Case III, four critical points of B, C, F and G are
detected. The critical curvature (κcr = 0.02) is determined by
the first condition. The suitable feedrates are limited by chord
tolerance. As compared with Case I, if the centripetal acceleration
increases to 2000mm/s2 in CaseVI, only two critical pointsmarked
as B and G are detected. The critical curvature (κcr = 0.0162)
is determined by the third condition. The suitable feedrates are
constrained by centripetal jerk. Finally, the curve parameters ui
and suitable feedrates Vi at the critical points are stored and will
be utilized in Sections 3.5 and 4.
3.5. The length estimation of NURBS blocks
After detecting all breakpoints and critical points within
a NURBS curve, their parameters ui and suitable feedrate Vi
are obtained; the curve is divided into small NURBS blocks
corresponding to the scanning data (ui, Vi). For example, the hat
curve is divided into seven NURBS blocks AB, BC, CD,DE, EF , FG
and GA shown in Fig. 4(d). The length of each NURBS block is
required for feedrate scheduling.However, it is difficult to calculate
the length by integratingNURBSparametric equation. The adaptive
Lobatto quadrature method [25] is adopted to estimate the length
of each NURBS block accurately. Given a tolerance of length error ε,
the length of each block Si is calculated over the parameter interval
618 A.-C. Lee et al. / Computer-Aided Design 43 (2011) 612–628
4.2. Feedrate profile generation for each NURBS block
In this section, the procedure of feedrate scheduling for each
NURBS block is shown in Fig. 7 and the details are illustrated
schematically as follows.
Step I.
In the first step, it needs to calculate the number of sampling
time Na and Nd in the ACC/DEC sections of sine-curve profile. For
given start feedrate Vs, allowable feedrate Vfs = Vmax and limits of
tangent acceleration and jerk, the number Na can be derived from
Eq. (19),
Na = max
Vfs − Vs
2
π
AtTs
,

Vfs − Vs
2
1
Jt

π
Ts
2 . (20)
The process for calculating Nd is similar to that of calculating
Na. The areas under the ACC/DEC sections of sine-curve profile are
derived as
Sa =
∫ ts
t0

Vmax − Vs
2
[
sinπ

t − t0
Ta
− 1
2

+ 1
]
+ Vs

dt
= (Vs + Vmax) · NaTs
2
Sd =
∫ te
tc

Vmax − Ve
2
[
sinπ

t − tc
Td
− 3
2

+ 1
]
+ Ve

dt
= (Ve + Vmax) · NdTs
2
.
(21)
Therefore, the number of sampling time in the CF section of
sine-curve profile is obtained:
Nc = Si − Sa − SdVmaxTs . (22)
If Nc > 0, it means that the length of NURBS block Si is long
enough to plan the CF section with maximum feedrate Vmax, and
the feedrate profile is planned as Fig. 7(a). Otherwise, the process
goes to Step II.
Step II.
For the feedrate profile without CF section, it is necessary to
reduce the feedrate from maximum feedrate Vmax to allowable
feedrate Vfs. It is represented as
Na−1−
j=0
(Vfs − Vs)
2
[
sinπ

j
Na
− 1
2

+ 1
]
Ts + VsNaTs
+

Nd−1−
j=0
(Vfs − Ve)
2
[
sinπ

j
Nd
− 3
2

+ 1
]
Ts
+ VeNdTs + VfsNcTs = Si. (23)
Simplifying Eq. (23), one obtains the allowable feedrate Vfs as
Vfs =
Si
Ts
+ 12 (aVs + bVe)− VsNa − VeNd
(a+b)
2 + Nc
(24)
where a =∑Na−1j=0 [sinπ( jNa − 12 )+ 1] and b =∑Nd−1j=0 [sinπ( jNd −
3
2 ) + 1]. If the Vfs is greater than max (Vs, Ve), the process goes to
feedrate schedulingwithout CF section as shown in Fig. 7(b). In this
case,Na andNd are calculated using Eq. (20), andNc is equal to zero.
There are three cases according to the relation between Vs and Ve
(i.e., Vs > Ve or Vs < Ve or Vs = Ve). Otherwise, the acceleration or
jerk may exceed the limitation, so that feedrate scheduling must
be performed further and the process goes to Step III for the case of
Vfs ≤ max(Vs, Ve).
Step III.
If the allowable feedrate Vfs is greater than min (Vs, Ve), the
feedrate profile with only ACC or DEC section is considered as
shown in Fig. 7(c). In this case, the Vfs is set as max (Vs, Ve), and
the parameter Na or Nd is evaluated from Eq. (20). Eq. (24) is used
to calculate the Vfs. Note that if Vs > Ve, the parameters Na,Nc and
a in Eq. (24) are set to zero; otherwise, the parameters Nd,Nc and
b are set to zero.
If the Vfs is smaller thanmin (Vs, Ve) or equal tomin (Vs, Ve), the
acceleration or jerk still could exceed the limitation. Therefore, it
needs to perform feedrate scheduling further and goes to Step IV.
Step IV.
For the case of Vfs ≤ min(Vs, Ve), the feedrate profile with only
CF section is adopted as shown in Fig. 7(d). The feedrates Vs and Ve
are all set as min (Vs, Ve). Therefore, the length of NURBS block Si
is the only condition for feedrate scheduling. The Vfs is determined
through Eq. (24) where the parameters Na,Nd, a and b are set to
zero, and the process of feedrate scheduling for each NURBS block
is finished.
In summary, the concept of feedrate scheduling for each NURBS
block is summarized as follows:
1. By the constraints of tangent acceleration and jerk, the numbers
of sampling time in the ACC/DEC section of sine-curve velocity
profile can be evaluated from Eq. (20).
2. According to the length of NURBS block, the allowable feedrate
Vfs after feedrate scheduling is evaluated from Eq. (24).
3. Finally, the feedrate scheduling data (Vs, Vfs, Ve,Na,Nc,Nd) are
determined by the feedrate scheduling algorithm.
4.3. Short NURBS block determination and prior handling
In the process of feedrate scheduling proposed in the last
section, the boundary condition Vs or Ve may be changed in some
situations. This problem may cause jump and discontinuity at the
junction of two feedrate profiles corresponding to two adjacent
NURBS blocks. Furthermore, the acceleration and jerk could exceed
the limitation.
For example, if the length of NURBS block is too short, its
feedrate profile could be changed from the form of Fig. 7(b) to the
form of Fig. 7(c) or (d) in the process of feedrate scheduling, so
Vs or Ve is changed, too. Therefore, one hope to determine how
‘‘short’’ NURBS block the boundary condition may be changed. As
shown in Fig. 8, the criterion length of NURBS block satisfied Vfs =
max(Vs, Ve) can be derived as
Sstd =

1
2
(Vs + Ve)NaTs + VeNdTs, Vs < Ve
1
2
(Vs + Ve)NdTs + VsNaTs, Vs > Ve
(Na + Nd)VsTs Vs = Ve.
(25)
Through Eq. (25), if Si ≥ Sstd, the boundary condition is not
changed after feedrate scheduling process and the corresponding
NURBS block is called a ‘‘long’’ NURBS block. Otherwise, the NURBS
block is called a ‘‘short’’ NURBS block. For avoiding the jump and
discontinuity at the junction of two feedrate profiles, it is necessary
to check if the next NURBS block is ‘‘short’’ or not before scheduling
the feedrate profile for ith NURBS block. If so, searching all of
the following short NURBS blocks is performed in priority, e.g.,
(i + 1)th, (i + 2)th, . . . , (i + k)th block are short. After feedrate
scheduling for those short NURBS blocks and ith NURBS block
is performed in the opposite direction, e.g. (i + k)th, (i + k −
1)th, . . . , (i + 1)th, ith, the work of feedrate scheduling is moved
to (i+k)th block and goes on. The concept of feedrate rescheduling
for short NURBS blocks is illustrated in Fig. 9.
620 A.-C. Lee et al. / Computer-Aided Design 43 (2011) 612–628
Table 3
Parameters of kinematic constraints and feedrate scheduling method.
Parameters Symbols Units
Sampling time Ts 0.002 s
Chord error δ 1 µm
Maximum feedrate Vmax 250 mm/s
Maximum acceleration Amax 800 mm/s2
Maximum jerk Jmax 26 400mm/s3
Length estimation error ε 0.1 µm
Feedrate error of PCI εPCI 0.1%
The correctional coefficient of PCI β 0.9
The number of feedrate compensation Ncom 50
sampling time. The sine-curve interior
−π2 , 3π2  is utilized as the
compensated feedrate curve shown at the bottom of Fig. 1. Its
equation is represented as
1V (j) = 1Vcom
2
[
sinπ

2j
N
− 1
2

+ 1
]
. (28)
Let the area under the compensated feedrate curve be equal to
1Si, and represented as
1Si =
Ncom−1−
j=0
1V (j)Ts (29)
where Ncom is the number of sampling time of the compensated
feedrate curve. The parameter 1Vcom can be obtained from
Eqs. (28) and (29). If 1Vcom is positive, the actual moving length
of NURBS block is larger than the estimated length, i.e. 1Si > 0;
otherwise, the actual moving length is smaller than the estimated
length, i.e.1Si < 0.
To calculate the error distance, the interpolation should be
performed for each NURBS block. The sum of the original
feedrate profile and compensated feedrate profile becomes the
new feedrate command profile which is used in the final Ncom
times interpolation. It is noted that only Ncom sampling points
need to backtrack, and the compensated feedrate curve generates
new curve points in real-time interpolation process. Finally, the
problem of terminal error is eliminated via the process of feedrate
compensation.
5. Simulation and experimental verification
In the following, analytical simulations and experiments are
performed to demonstrate the feasibility and applicability of
the proposed feedrate scheduling method. The performance
evaluation among first-order Taylor, second-order Taylor and PCI
interpolation algorithms are also performed to verify the efficiency
of the proposed method.
5.1. Efficiency and accuracy analysis
The environment of simulation consists of Intel Core i7-860
2.8 GHz personal computer with Windows XP operating system,
and the proposed feedrate scheduling method is developed by
MATLAB. The PCI interpolation algorithm in [7] is applied to
generate curve parameter. Even though PCI has a disadvantage of
stability problem that corrector may not converge at breakpoints
with G0 continuity, it still works in this paper since the NURBS
curve which contains the breakpoints has been split into several
NURBS sub-curves. In this section, two free-form curves are chosen
to simulate and to compare the efficiency and accuracy among
the first-order Taylor, second-order Taylor and PCI interpolation
algorithms. The parameters of kinematic constraints and feedrate
scheduling method are presented in Table 3 unless stated
otherwise.
To illustrate the computing efficiency, the number and total
clock cycles of arithmetic operations required to realize various
interpolation techniques are summarized in Tables 4 and 5,
respectively. The degree of NURBS curve p, the number of motion
axes Na and the iteration number of PCI Nj are considered as
performance influencing factors. To improve feedrate accuracy,
PCI algorithm requires to perform Eqs. (6)–(9) recursively. Since
the Cox–de Boor algorithm needs p(p+1)2 times of function calls to
generate an interpolation pointC(u), the total number of ADD, SUB,
MUL andDIV operations for PCI increases proportional to the factor
(Nj − 1)Na p(p+1)2 in [29]. In contrast to PCI, since the Taylor series
methods only need to calculate the first and second derivatives of
a NURBS curve in Eq. (4) using the Cox–de Boor algorithm, the total
number for the first- and second-order Taylor methods increases
proportional to the factors Na
p(p−1)
2 and Na(p − 1)2, respectively.
Therefore, the computation of PCI algorithm consumes the most
clock cycles as compared with the others shown in Table 5. In the
hat case with p = 2,Na = 3,Nj = 2, the total clock cycles
consumed by PCI is about 4.08 and 6.63 times of that consumed
by the first- and second-order Taylor methods, respectively.
Although computing efficiency of PCI algorithm is not better
than the Taylor seriesmethods, it is still worth to apply PCImethod
to reduce feedrate fluctuation for high-speed machining. There-
fore, the hat and butterfly curves are tested to prove the accuracy
and feasibility of the proposed feedrate scheduling algorithmwith
PCI method. The adaptive-feedrate interpolation algorithm (ADA),
adaptive-feedrate with curvature-based feedrate interpolation al-
gorithm (ADACB) and proposed feedrate scheduling method (FS)
are adopted to plan the feedrate profile of a NURBS curve; the first-
and second-order Taylor methods, and PCI methods are applied to
generate an interpolation point. The comparisons of feedrate errors
among various NURBS interpolation algorithms are summarized
in Table 6. It is clear that the PCI method achieves the best fee-
drate accuracy as compared with the Taylor methods for the two
curves. Furthermore, the FS with PCI method can outperform all
of the other algorithms both in maximum and root mean square
of feedrate accuracy. The corresponding feedrate error is within
the tolerance 0.1%, and root mean square of feedrate error is only
0.04%. It is noted that the ADA algorithm with first-order Taylor
method is not suitable for high-speed machining since the max-
imum feedrate fluctuations are over a hundred percent of given
feedrate command. In the following sections, simulations are con-
ducted to demonstrate the feasibility and applicability of the pro-
posed feedrate scheduling method.
Table 4
Arithmetic operations of various NURBS interpolation methods.
Arithmetic operation First-order Taylor Second-order Taylor PCI
ADD Na + Nap(p− 1)/2 Na(p− 1)2 + Na + 2 (Nj − 1) [Nap(p+ 1)/2+ Na + 1]+ Na(p2 + p+ 1)
SUB 3Nap(p− 1)/2 3Na(p− 1)2 + 1 (Nj−1) [Nap(p+ 1)/2+ Na + 3]+Na(3p2+3p+1)+2
MUL Na(p2 − p+ 1)+ 1 2Na(p− 1)2 + Na + 13 (Nj − 1)

Na(p2 + p+ 1)+ 2
+ Na(2p2 + 2p+ 1)+ 2
DIV Nap(p− 1)/2+ 1 Na(p− 1)2 + 4 (Nj − 1) [Nap(p+ 1)/2+ 3]+ Na(p2 + p)+ 2
SQRT 1 1 Nj
Note. ADD: Addition, SUB: Subtraction, MUL: Multiplication, DIV: Division, SQRT: Square Root, p: the degree of NURBS curve, Na: the number of motion axes, Nj: the number
of iterations for PCI.
622 A.-C. Lee et al. / Computer-Aided Design 43 (2011) 612–628
Table 7
Parameters of the servo control systems and motion controllers.
Quantity Symbol Value Units
x-axis y-axis z-axis
Servo system dynamics a 35.833 58.532 23.117 s
b 3.640× 10−3 4.094× 10−3 0.425× 10−3 mm/Volt
Position controller Kpp 148.200 153.128 145.242 1/s
Velocity controller Kvp 11.393× 10−2 10.285× 10−2 96.754× 10−2 Volts/mm
Ti 8.172× 10−3 7.323× 10−3 8.720× 10−3 1/s
Velocity feedforward controller Kvff 0.95 0.95 0.95
ωn 500 500 500 Hz
a
c d
b
Fig. 10. The hat curve: (a) contour, (b) sub-curves and blocks, (c) curvature profile and (d) feedrate profile.
under the given jerk constraint. The proposed algorithm com-
bines the long block C3C4 and the short block C4C5 into one long
block C3C5, and plans the deceleration profile for the block as
shown in Fig. 7(c.2). Finally, the algorithm reschedules the fee-
drate profile for each combined block shown in Fig. 12(d), and
the number of NURBS blocks decreases from 32 to 26. Comparing
Fig. 12(c) with Fig. 12(d), it illustrates that the feedrates at criti-
cal points C5, C8, C10, C13, C19, C22, C24 and C27 with larger curva-
tures are lower than those of other critical points with smaller
curvatures.
Again, one can check that the feedrate profile of the butterfly
curve satisfies the constraints of chord error, acceleration and jerk
limitations shown in Fig. 13(a)–(c). As shown in Fig. 13 (d)–(f), the
profiles of velocity, acceleration and jerk for x-axis and y-axis are
also constrained on the given limits of 250 mm/s, 800 mm/s2 and
26 400mm/s3, respectively. From the simulation results, it demon-
strates that the proposed feedrate schedulingmethod achieves the
desired precision and satisfies the kinematic constraints of CNC
machine for high-speed machining.
5.4. Simulation comparisons among different NURBS interpolation
algorithms
In order to point out the differences among the proposed
method and previous researches including dynamic-based inter-
polator with real-time look-ahead algorithm (DBLA) in [18] and
adaptive-feedrate interpolation algorithm (ADA) in [10], some
simulations are performed as follows. The block diagram and spec-
ification of AC servo control systems are referred to [18]. The
parameters of servo control systems and motion controller are
listed in Table 7 unless stated otherwise.
For the hat case, since the DBLA and ADA algorithms cannot
detect the breakpoints D and E as shown in Fig. 2, they will
not suitably decrease the feedrate and consequently deteriorate
624 A.-C. Lee et al. / Computer-Aided Design 43 (2011) 612–628
a
c d
b
Fig. 12. The butterfly curve: (a) contour, (b) sub-curves and blocks, (c) curvature profile and (d) feedrate profile.
Table 8
Performance comparisons of simulations among different NURBS interpolation algorithms for hat contour.
Feedrate command
(mm/min)
Interpolation
algorithm
Chord error (µm) Tracking error (µm) Contour error (µm) Machining time (s)
MAX RMS MAX (x/y-axis) RMS (x/y-axis) MAX RMS PRE MAC Total
1454
ADA 0.203 0.010 150.512/61.178 10.526/9.097 74.330 5.395 0 8.908 8.908
DBLA 0.060 0.007 128.752/60.309 10.025/8.922 67.000 4.856 0 9.110 9.110
FS 0.057 0.007 28.737/39.317 9.378/8.732 23.077 4.272 33.138 9.448 42.586
Note. MAX: maximum, RMS: root mean square, PRE: pre-process, MAC: machining.
profile through Eqs. (16)–(19); the process of feedrate scheduling
is shown in Fig. 7.
5.5. Experimental results
In this section, experiments are performed on a three-axis
engraving machine with Panasonic MINAS-A4 servo drivers and
MSMD042S1S servo motors. The drivers of servo motors are set to
torque mode. The off-line feedrate scheduling algorithm is imple-
mented on MATLAB, and the three-axis engraving machine shown
in Fig. 15(a) is controlled by a PC-basedmotion controllerwith Intel
Core i7-860 2.8 GHz microprocessor. The hat and butterfly curves
are tested under feedrate command of 15 000 mm/min. Since the
maximum velocities of servo drivers are limited to 120 mm/s, the
maximum feedrate for real machining is set to be 7200 mm/min.
The feedrate scheduling method implemented as a pre-process
consumes about 8.881 s and 11.361 s for the hat and butterfly
cases, respectively. The real machining test of the butterfly curve
is shown in Fig. 15(b).
Some experiments are performed to do the comparative anal-
ysis among the ADA, the FS with and without real machining for
the butterfly curve. Since the DBLA cannot meet the specifica-
tion of maximum feedrate, only the ADA is used for comparison.
Experimental results are shown in Fig. 16. Statistical data are sum-
marized in Table 9. The ADA which only considers chord errors
cause high jerks, large tracking and contour errors at the criti-
cal points of C1, C5, C8, C10, C13, C19, C22, C24, C27, C31, as shown in
Fig. 16(b)–(d). The chord errors cannot be constrained by 1 µm
using the ADA for high-speed machining as shown in Fig. 16(a).
Nevertheless, the FS detects the critical points in advance, and
plans a smoother feedrate profile under the given constraints
of chord error, acceleration and jerk as shown in Fig. 16(f).
Fig. 16(e)–(h) demonstrate that the proposed FS can improve the
chord, tracking and contour performances simultaneously as com-
paredwith the ADA. As shown in Table 9, the totalmachining times
for performing the FSwith andwithout realmachining are 19.411 s
and 11.361 s, respectively. The tracking and contour errors are
almost the same as expected between simulation and experimen-
tal results. The FS can reduce the maximum contour error by
76.52% as compared with the ADA, with a penalty of 464.27%more
machining time. The experimental results demonstrate the feasi-
bility of the proposed off-line feedrate scheduling method and the
applicability for real-time implementation.
626 A.-C. Lee et al. / Computer-Aided Design 43 (2011) 612–628
(a) ADA. (b) DBLA.
(c) FS. (d) ADA.
(e) DBLA. (f) FS.
Fig. 14. Simulation results of ADA, DBLA and FS interpolation algorithms for the hat curve.
Fig. 15. The real machining test (a) three-axis engraving machine, (b) the butterfly contour.
628 A.-C. Lee et al. / Computer-Aided Design 43 (2011) 612–628
6. Conclusions
In this study, an off-line feedrate scheduling method con-
strained by chord tolerance, acceleration and jerk limitations is
proposed to construct a jerk-limited feedrate profile of NURBS
curve. In off-line process, scanning a NURBS curve in advance is
performed to find out the breakpoints with G0 continuity, and the
curve is split into several NURBS sub-curves. The proposedmethod
also detects the critical points with large curvatures, and the curve
is further divided into small blocks. Furthermore, the suitable fee-
drates at breakpoints and critical points are determined based on
the constraints of chord tolerance, acceleration and jerk limita-
tions, and velocity variation. The length of eachNURBSblock is esti-
mated and stored as the scanning data. The feedrate profile for each
NURBS block is constructed by utilizing the results of curve scan-
ning. In addition, feedrate compensation method for short NURBS
block is established to make the whole feedrate profile more con-
tinuous and precise. The proposed method is realized as a pre-
processor, which avoids the complicated and heavy calculations
in real time. In real-time process, it is simple and efficient to per-
form the interpolation algorithm and to generate the curve point.
Finally, simulations and experiments are conducted to verify the
feasibility and applicability of the proposed feedrate scheduling
method.
References
[1] Piegl L, Tiller W. The NURBS Books. second ed. Berlin, Heidelberg: Springer;
1997.
[2] Xu XW, Newman ST. Making CNCmachine toolsmore open, interoperable and
intelligent—a review of the technologies. Computers in Industry 2006;57(2):
141–52.
[3] Xu XW. Realization of STEP-NC enabled machining. Robotics and Computer-
Integrated Manufacturing 2006;22(2):144–53.
[4] Shipitalni M, Koren Y, Lo CC. Real-time curve interpolators. Computer-Aided
Design 1994;26(11):832–8.
[5] Yang DCH, Kong T. Parametric interpolator versus linear interpolator for
precision CNC machining. Computer-Aided Design 1994;26(3):225–34.
[6] Farouki RT, Tsai YF. Exact Taylor series coefficients for variable-feedrate CNC
curve interpolators. Computer-Aided Design 2001;33(2):155–65.
[7] Tsai MC, Cheng CW. A real-time predictor–corrector interpolator for
CNC machining. ASME Transaction Journal of Manufacturing Science and
Engineering 2003;125(3):449–60.
[8] Erkorkmaz K, Altintas Y. Quintic spline interpolation with minimal feed fluc-
tuation. ASME Transaction Journal of Manufacturing Science and Engineering
2005;127(2):339–49.
[9] Lei WT, SungMP, Lin LY, Huang JJ. Fast real-time NURBS path interpolation for
CNC machine tools. International Journal of Machine Tools and Manufacture
2007;47(10):1530–41.
[10] Yeh SS, Hsu PL. Adaptive-feedrate interpolation for parametric curves with a
confined chord error. Computer-Aided Design 2002;34(3):229–37.
[11] Zhiming X, Jincheng C, Zhengjin F. Performance evaluation of a real-time
interpolation algorithm for NURBS curves. International Journal of Advanced
Manufacturing Technology 2002;20(4):270–6.
[12] Yong T, Narayanaswami R. A parametric interpolator with confined chord
errors, acceleration and deceleration for NC machining. Computer-Aided
Design 2003;35(13):1249–59.
[13] Sun Y, Jia Z, Ren F, Guo D. Adaptive feedrate scheduling for NC machining
along curvilinear paths with improved kinematic and geometric properties.
International Journal of Advanced Manufacturing Technology 2008;16(1–2):
60–8.
[14] Nam SH, YangMY. A study on a generalized parametric interpolator with real-
time jerk-limited acceleration. Computer-Aided Design 2004;36(1):27–36.
[15] Liu X, Ahmad F, Yamazaki K,MoriM. Adaptive interpolation scheme for NURBS
curves with the integration of machining dynamics. International Journal of
Machine Tools and Manufacture 2005;45(4–5):433–44.
[16] Xu RZ, Xie L, Li CX, Du DS. Adaptive parametric interpolation scheme with
limited acceleration and jerk values for NC machining. International Journal
of Advanced Manufacturing Technology 2008;36(3–4):343–54.
[17] Lai JY, Lin KY, Tseng SJ, Ueng WD. On the development of a parametric
interpolator with confined chord error, feedrate, acceleration and jerk.
International Journal of Advanced Manufacturing Technology 2008;37(1–2):
104–21.
[18] Lin MT, Tsai MS, Yau HT. Development of a dynamics-based NURBS
interpolator with real-time look-ahead algorithm. International Journal of
Machine Tools and Manufacture 2007;47(15):2246–62.
[19] Tsai MS, Nien HW, Yau HT. Development of an integrated look-ahead
dynamics-based NURBS interpolator for high precisionmachinery. Computer-
Aided Design 2008;40(5):554–66.
[20] Dong J, Stori JA. Optimal feed-rate scheduling for high-speed contouring. ASME
Transaction Journal of Manufacturing Science and Engineering 2007;129(1):
63–76.
[21] Tikhon XM, Ko TJ, Lee SH, Kim HS. NURBS interpolator for constant material
removal rate in open NCmachine tools. International Journal ofMachine Tools
and Manufacture 2004;44(2–3):237–45.
[22] Choi IH, Yang MY, Hong WP, Jung TS. Curve interpolation with variable fee-
drate for surface requirement. International Journal of Advanced Manufactur-
ing Technology 2005;25(3–4):325–33.
[23] Fleisig RV, Spence AD. A constant feed and reduced angular acceleration
interpolation algorithm for multi-axis machining. Computer-Aided Design
2001;33(1):1–15.
[24] Mohan S, Kweon SH, Lee DM, Yang SH. Parametric NURBS curve interpolators:
a review. International Journal of Precision Engineering and Manufacturing
2008;9(2):84–92.
[25] Kincaid D, Cheney W. Numerical Analysis: Mathematics of Scientific
Computing. 3th ed. Brooks Cole; 2002.
[26] FANUC Corporation. FANUC Series 30i/300i/300is-MODEL A. Series 31i/310i/
310is-MODEL A5. Series 31i/310i/310is-MODEL A. Series 32i/320i/320is-
MODEL A—Parameter Manual. 2004.
[27] Jeon JW, Ha YY. A generalized approach for the acceleration and deceleration
of industrial robots and CNC machine tool. IEEE Transactions on Industrial
Electronics 2000;47(1):133–9.
[28] Intel Corporation. Intel r⃝64 and IA-32 Architectures—Optimization Reference
Manual. 2009.
[29] Yau HT, Lin MT, Tsai MS. Real-time NURBS interpolation using FPGA for high
speed motion control. Computer-Aided Design 2006;38(10):1123–33.
 2
of geometric error for five-axis CNC machine tools with titling rotary table”。本屆會議內容相當充實且豐
富，包涵以下各個主題：Intelligent Space and Sensor Network、Mobile Robots、Optimal Design、
Rehabilitation Robots、Networked Robotics、Field Robotics / UAV、Learning、Micro Robots and Systems、
Sensors and Sensor Network、Vehicle Control、Applications of Mechatronics Systems、Robotic Surgery、
Machining、Micro Applications、Cooperative and Industrial Robots、Biomechatronics、Actuator Design、
Micro/Nano Positioning、Human-Centerd Systems、Identification and Estimation、Actuators、Scanning Probe 
Microscopy、Human-Oriented Design and Control、Control Applications in Mechatronics、Novel Actuators、
Path Planning and Navigation、Motion Control、Machine Vision、Robotic Locomotion、Robot Dynamics and 
Control、Image Processing、Neural and Fuzzy Control in Mechatronics、Service Robotics、Emerging 
Applications 等。以上的會議主題幾乎涵蓋了現今高等智能化機電整合相關的領域，共約有 300 餘篇論
文在這些專門領域的年會主題中發表。與會學者在輕鬆和諧的氣氛下交換意見，收穫頗豐。大會並且
於 7 月 5 日晚上 19:00 安排與會者至 Lázár Equestrian Park 參觀活動並欣賞匈牙利馬術表演，最後於 7
月 6 日晚上 18:00 舉行閉幕儀式讓此次會議圓滿落幕。 
二、與會心得 
    在短短五天的會議期間，會議主題涵蓋了智慧型機器人、生物機電、感測器與制動器、願動
控制、影像處理、系統動態與控制等高等智能化機電整合領域，並依論文特性區分為多個主題進
行研討，確實極為充實豐富。筆者是第一次利用新進人員國科會計畫之經費參與國際會議，深感
國際研討會之重要性，透過國際研討會可以認識許多來自世界各國之資深教授、學者專家以及工
程師，藉以彼此交流學術研究之心得，並進一步建立學術人際網絡，開啟國際合作之可能性；對
於國家則可營造我國參與國際社會，並積極回饋國際社會之良好形象，以提升我國國際地位。筆
者和與會先進就研究領域討論交流時，不再只是學術理論的角度，更得到工業界回饋的意見，可
進一步促成學術界與產業界雙方正面交流。 
三、考察參觀活動(無是項活動者略) 
    無。 
四、建議 
    筆者在此特別感謝國家科學委員會的支持，得以透過新進人員國科會計畫之參與國際會議經
費使得此次會議得以順利成行。在此筆者謹就個人參加國際會議經驗提出下列建議供國科會參考: 
1. 國科會及政府部門(如教育部)宜更加積極鼓勵學術界參與各項學術性國際組織以及活動，並
全力補助學術界新進人員各式經費，除了將教學及研究成果投稿國際期刊外，更能進一步融
入國際學術性組織參與舉辦各式活動，新進人員便可以開啟國際視野，增加參與國際合作計
畫的機會。 
五、攜回資料名稱及內容 
    本次會議攜回會議行程表、會議手冊以及論文光碟片一片。 
六、其他 
PSPB Operations Manual, including provisions covering originality, authorship, author responsibilities and author misconduct. More information on
IEEEs publishing policies may be found at http://www.ieee.org/publications_standards/publications/rights/pub_tools_policies.html. Authors are
advised especially of IEEE PSPB Operations Manual section 8.2.1.B12: "It is the responsibility of the authors, not the IEEE, to determine whether
disclosure of their material requires the prior consent of other parties and, if so, to obtain it." Authors are also advised of IEEE PSPB Operations
Manual section 8.1.1B: "Statements and opinions given in work published by the IEEE are the expression of the authors."
 
 
RETAINED RIGHTS/TERMS AND CONDITIONS
 
General
 
1. Authors/employers retain all proprietary rights in any process, procedure, or article of manufacture described in the Work.
 
2. Authors/employers may reproduce or authorize others to reproduce the Work, material extracted verbatim from the Work, or derivative works for
the author's personal use or for company use, provided that the source and the IEEE copyright notice are indicated, the copies are not used in any way
that implies IEEE endorsement of a product or service of any employer, and the copies themselves are not offered for sale.
 
3. In the case of a Work performed under a U.S. Government contract or grant, the IEEE recognizes that the U.S. Government has royalty-free
permission to reproduce all or portions of the Work, and to authorize others to do so, for official U.S. Government purposes only, if the contract/grant
so requires.
 
4. Although authors are permitted to re-use all or portions of the Work in other works, this does not include granting third-party requests for
reprinting, republishing, or other types of re-use.The IEEE Intellectual Property Rights office must handle all such third-party requests.
 
5. Authors whose work was performed under a grant from a government funding agency are free to fulfill any deposit mandates from that funding
agency.
 
Author Online Use
 
6. Personal Servers. Authors and/or their employers shall have the right to post the accepted version of IEEE-copyrighted articles on their own
personal servers or the servers of their institutions or employers without permission from IEEE, provided that the posted version includes a
prominently displayed IEEE copyright notice and, when published, a full citation to the original IEEE publication, including a link to the article
abstract in IEEE Xplore.Authors shall not post the final, published versions of their papers.
 
7. Classroom or Internal Training Use. An author is expressly permitted to post any portion of the accepted version of his/her own IEEE-copyrighted
articles on the authors personal web site or the servers of the authors institution or company in connection with the authors teaching, training, or work
responsibilities, provided that the appropriate copyright, credit, and reuse notices appear prominently with the posted material. Examples of permitted
uses are lecture materials,course packs, e-reserves, conference presentations, or in-house training courses.
 
8. Electronic Preprints. Before submitting an article to an IEEE publication, authors frequently post their manuscripts to their own web site, their
employers site, or to another server that invites constructive comment from colleagues.Upon submission of an article to IEEE, an author is required to
transfer copyright in the article to IEEE, and the author must update any previously posted version of the article with a prominently displayed IEEE
copyright notice. Upon publication of an article by the IEEE, the author must replace any previously posted electronic versions of the article with
either (1) the full citation to the IEEE work with a Digital Object Identifier (DOI) or link to the article abstract in IEEE Xplore, or (2) the accepted
version only (not the IEEE-published version), including the IEEE copyright notice and full citation, with a link to the final, published article in IEEE
Xplore.
 
 
INFORMATION FOR AUTHORS
IEEE Copyright Ownership
 
 
 
 
  
Abstract—In this paper, an approach is proposed to analyze 
and compensate geometric errors of five-axis machine tools 
using a novel optical measurement instrument. The instrument 
consists of two pairs of QDs (quadrant detectors) and 
triangulation laser probes, one magnetic base and one glass 
ball. The kinematic and geometric error models of a five-axis 
machine with a titling rotary table are obtained using the HTM 
(homogeneous transformation matrix). The error model totally 
includes 43 geometric errors. The proposed method first 
analyzes the sensitivity Jacobian matrix and observes what are 
the critical offsets of five-axis machine which dominant the 
overall volumetric errors. Three types of error sources consists 
of the center bias, circle and eccentric are identified. NC test 
paths such as BK2 are planned according to the inverse 
kinematic equations. Simulations are performed to generalize 
the polar plots of error patterns. Finally, the proposed method 
is applied to compensate the geometric errors of the five-axis 
machine tool, and the machine accuracy can be significantly 
improved. 
 
Index Terms –Five-axis, Geometry error, Error model, Inverse 
kinematics. 
I. INTRODUCTION 
INCE a five-axis machine tool has two additional rotary 
axes as compared with a three-axis machine tool, it can 
position and orient its cutting tool simultaneously in the 
workspace. The capability makes five-axis machine tools 
highly flexible. Therefore, five-axis machining increases 
material removal rate, improves surface quality, reduce 
machining time and workpiece setup time. However, 
five-axis machines are not suitable for heavy-duty cutting 
and high-speed machining due to its poor machine stiffness. 
In addition, they are more prone to errors because of the 
increased flexibility in their geometry and servo control. 
Measuring, identification and compensation methods for 
machine errors should be used to reduce geometric errors 
and verify cutting accuracy of five-axis machines. 
To enhance the accuracy of multi-axis machine tools, 
many researchers have developed different methodologies 
in recent years. Bryan [1] first proposed the DBB (double 
 
M.–T. Lin is with the Department of Mechanical Design Engineering, 
National Formosa University, Yun-lin, Taiwan, R.O.C. (phone: 
886-5-6315000-5342; fax: 886-5-6363010; e-mail: mtlin@nfu.edu.tw). 
Y.–T. Lee is with the Institute of Mechanical and Electro-Mechanical 
Engineering, National Formosa University, Yun-lin, Taiwan, R.O.C. 
W.-Y. Jywe is with the Department of Automation Engineering, 
National Formosa University, Yun-lin, Taiwan, R.O.C. 
J.–A. Chen is with the Institute of Mechanical and Electro-Mechanical 
Engineering, National Formosa University, Yun-lin, Taiwan, R.O.C. 
ballbar) to inspect the compounded error for two-axis 
circular trajectories. The error sources can be rapidly 
diagnosed by comparing with the measuring error plots with 
a set of reference trace patterns. According to the study [2], 
Abbaszadeh-Mir et al. [3] concluded that a complete and 
minimum set of eight link errors of a five-axis machine tool 
can be identified using the magnetic DBB. The reduction 
process used properties such as the size, rank, and condition 
number of the sensitivity Jacobian matrix to signal out these 
independent error parameters. Since then, Tsutsumi and 
Saito [4], [5] proposed an approach to identify eight link 
errors associated with the rotary axes by means of 
simultaneous multi-axis motion trajectories. Zargabashi and 
Mayer [6] proposed a method to asses the axis motion errors 
of a trunnion-type A-axis through five DBB tests with a 
single setup. 
In order to analyzing and calibrating geometric errors of 
machine tools, other measurement devices have been 
developed and applied on real measuring. In a series of three 
papers, Lei and Hsu [7]-[9] developed a 3D probe ball which 
combined the DBB and 3D measuring probe to directly 
measure 3D overall errors of five-axis machine tools. The 
error model including fifty nine errors was established and 
thirteen link errors were identified using the least square 
estimation method. Based on the identified error model, a 
real-time error compensation method was proposed to 
improve the accuracy of machine tools. However, the errors 
cannot be appropriate compensated when the rotary axes are 
at certain degrees. Hsu and Wang [10] further proposed a 
new compensation method to overcome the problem and the 
compensation mechanism can be directly applied in the 
postprocessors of CAM systems. Furthermore, Bringmann 
and Knapp [11] adopted a non-contact measurement device, 
named R-test, to measure the TCP (tool center point) 
deviations at different five-axis poses. Zargabashi and 
Mayer [12] proposed an identification procedure to estimate 
the link errors through an iterative algorithm based on a 
sensitivity Jacobian matrix in [3]. Although above 
measuring devices, error models and compensation methods 
were used to calibrate the errors of five-axis machine tools, 
few papers made a detailed survey for five-axis calibration 
methods. 
Bohez [13] analyzed the systematic errors in the five-axis 
tool path generation. The overall model and strategy to 
compensate these errors was outlined. Otherwise, a 
complete survey of five-axis error models was proposed in 
Analysis and Compensation of Geometric Error for Five-axis CNC 
Machine Tools with Titling Rotary Table 
Ming-Tzong Lin, Yi-Tsung Lee, Wen-Yuh Jywe, and Jr-An Chen 
S 
2011 IEEE/ASME International Conference on
Advanced Intelligent Mechatronics (AIM2011)
Budapest, Hungary, July 3-7, 2011
978-1-4577-0839-8/11/$26.00 ©2011 IEEE 350
 
 
 
five-axis machine tool are listed in Table I and unless stated 
otherwise. 
( ) ( ) ( )
( ) ( ) ( ) ( ) ( )[ ]
( ) ( ) ( ) ( )[ ]
( ) ( ) ( ) ( )[ ]
( ) ( ) ( ) ( ){ }
( ) ( ) ( )[ ] ( ) ( )[ ]{ }
( ) ( ) ( ) ( )[ ]
( ) ( )[ ] ( )[ ]
( ) ( ) ( )
( ) ( )[ ] ( ) ( )[ ]
( ) ( ) ( )[ ] ( ) ( )[ ]
( ) ( )[ ] ( ) ( )[ ]
( ) ( ) ( )[ ] ( ) ( )[ ]
( ) ( )[ ] ( ) ( )[ ]
( ) ( ) ( )[ ] ( ) ( )[ ]
( ) ( ) ( )[ ] ( ) ( ) ( )[ ]
( ) ( )[ ]{ }
( ) ( ) ( ) ( )[ ]
( ) ( )[ ] ( )[ ]
( ) ( ) ( )[ ] ( ) ( )[ ]
( ) ( )[ ] ( ) ( )[ ] ⎪⎭
⎪⎬⎫⎪⎩
⎪⎨⎧ ++−+++
+++−−−+
⎪⎭
⎪⎬⎫⎪⎩
⎪⎨⎧ ++++
+++−−+
+−−+
⎪⎭
⎪⎬⎫⎪⎩
⎪⎨⎧ +++−++++
+++−−−+
⎪⎭
⎪⎬⎫⎪⎩
⎪⎨⎧ ++−+++
+++−−−+
⎪⎭
⎪⎬⎫⎪⎩
⎪⎨⎧ ++−+++
+−+−−+
⎪⎭
⎪⎬⎫⎪⎩
⎪⎨⎧ +++−
++−+
⎪⎭
⎪⎬⎫⎪⎩
⎪⎨⎧ +−++
++−+−+
+−++−−+
−−++++
++++
++++
+++++
++=
xzyycyzxxca
zzacyyaycaca
m
xyzczzca
yyayacxcaca
m
zzccm
xzyyycyzxxxca
zzacyyaycaca
ht
xzyycyzxxca
zzacyyaycaca
zh
xyzzcyzxxca
zzcayyayacca
zh
yyazzac
ycycaxcaca
yz
xyzcyya
zzcaxcayacca
yz
yyazzacycacaxy
yyaxycazcarw
zzzzca
yyyyca
xxxxxc
ycxxx
yxCyxSC
awSCcwCaCCSS
Z
xCawCC
cwSaSCxSSSC
Y
awSCX
zyxCzyxSC
awSCcwCaCCSS
Z
yxCyxSC
awSCcwCaCCSS
Z
yxCyxSS
awCCcwSaSCSC
Y
cwCawSC
xCaCCxSCSS
Z
xCcwS
awCCxSSaSCSC
Y
cwCawSCaCCSSZ
cwZwZwYX
tzyxSS
tzyxSC
tzyxaC
aScwP
γεεγεε
εεεεε
γεεε
εεεε
εε
γεεεγεεε
εεεεε
γεεγεε
εεεεε
γεεγεε
εεεεε
εεεε
εεε
γεεε
εεεε
εεεεε
εεεε
δδδδ
δδδδ
δδδδδ
δδδ
   (4) 
 ( ) ( ) ( )
( ) ( ) ( ) ( ) ( ){ }
( ) ( ) ( ) ( ){ }
( ) ( ) ( ) ( ){ }
( ) ( ) ( )[ ]
( ) ( ) ( )[ ] ( ) ( )[ ]{ }
( ) ( ) ( ) ( )[ ]
( ) ( )[ ] ( )[ ]
( ) ( ) ( )
( ) ( )[ ] ( ) ( )[ ]
( ) ( ) ( )[ ] ( ) ( )[ ]
( ) ( )[ ] ( ) ( )[ ]
( ) ( ) ( )[ ] ( ) ( )[ ]
( ) ( )[ ] ( ) ( )[ ]
( ) ( ) ( )[ ] ( ) ( )[ ]
( ) ( ) ( )[ ] ( ) ( ) ( )[ ]
( ) ( )[ ]{ }
( ) ( ) ( ) ( )[ ]
( ) ( )[ ] ( )[ ]
( ) ( ) ( )[ ] ( ) ( )[ ]
( ) ( )[ ] ( ) ( )[ ] ⎪⎭
⎪⎬⎫⎪⎩
⎪⎨⎧ ++++++
+−+++−+
⎪⎭
⎪⎬⎫⎪⎩
⎪⎨⎧ +−+−
+−−−−+
+−+
⎪⎭
⎪⎬⎫⎪⎩
⎪⎨⎧ ++++++++
+−+++−+
⎪⎭
⎪⎬⎫⎪⎩
⎪⎨⎧ ++++++
+−+++−+
⎪⎭
⎪⎬⎫⎪⎩
⎪⎨⎧ ++++++
++++++
⎭⎬
⎫
⎩⎨
⎧
+++−
−−−+
⎪⎭
⎪⎬⎫⎪⎩
⎪⎨⎧ +−+−
+−−−−+
+−+++−+
++−−+
++++
++++
++++−
++=
xzyycyzxxca
zzcaxxaycaac
m
xyzczzca
xxaycaxacca
m
zzccm
xzyyycyzxxxca
zzcaxxaycaac
ht
xzyycyzxxca
zzcaxxaycaac
zh
xyzzcyzxxac
zzcaxxaycaca
zh
zzcaxxa
ycycaxcaac
yz
xyzczzca
xxaycaxacca
yz
zzcaxxaycaacxy
xxaxxcacarw
zzzzac
yyyyca
xxxxxc
ycyyy
yxSyxCC
awSScwCaSCSC
Z
xSawSC
cwSaSSxSCCC
Y
awCSX
zyxSzyxCC
awSScwCaSCSC
Z
yxSyxCC
awSScwCaSCSC
Z
yxSyxSC
awSCcwSaSSCC
Y
awSScwC
xSaSCxCCSC
Z
xSawSC
cwSaSSxSCCC
Y
awSScwCaSCSCZ
cwZwZYY
tzyxSC
tzyxCC
tzyxaS
aCcwP
γεεγεε
εεεεε
γεεε
εεεε
εε
γεεεγεεε
εεεεε
γεεγεε
εεεεε
γεεγεε
εεεεε
εεεε
εεε
γεεε
εεεε
εεεεε
εεε
δδδδ
δδδδ
δδδδδ
δδδ
   (5) 
B. Geometric error modeling 
As mentioned in the previous section, there are totally 43 
errors in the kinematic model. After planning the motion 
trajectory and generating the desired position rQt=[Qx Qy 
Qz]T and the orientation rKt=[Kx Ky Kz]T of the tool, motion 
commands Pm=[Xm Ym Zmθaθc]T can be determined. If all 
errors are set to zero, the inverse kinematic equations are 
obtained as: 
( ) ( ) ( )
( ) ( ) ( ) ( ){ }
( ) ( ) ( ) ( ){ }
( )
( ) ( )[ ] ( ) ( )[ ]{ }
( ) ( ) ( )[ ] ( ) ( )[ ]{ }
( ) ( ) ( )[ ] ( ) ( )[ ]{ }
( ) ( )[ ] ( ) ( )[ ]
( ) ( )[ ]
( ) ( )[ ] ( ) ( )[ ]
( ) ( )[ ]
( ) ( )[ ] ( ) ( )[ ]
( ) ( ) ( )[ ]
( ) ( ) ( )[ ] ( ) ( )[ ]{ }
( ) ( ) ( )[ ] ( ) ( )[ ]{ }
( ) ( )[ ] ( ) ( )[ ]
( ) ( )[ ] ⎪⎭
⎪⎬⎫⎪⎩
⎪⎨⎧ ++−
+++−−+
+++−−+
+++++
⎪⎭
⎪⎬⎫⎪⎩
⎪⎨⎧ +++−
+++−−+
⎪⎭
⎪⎬⎫⎪⎩
⎪⎨⎧ ++−
+++−−+
⎪⎭
⎪⎬⎫⎪⎩
⎪⎨⎧ +++
+−++−+
+−++++
+++−−+
+++−−+
−−+−−
++++
+++−
++=
yzxxa
yycaxxaca
m
yycaxxcaxaam
yycxxcym
yzxxxa
yycaxxaca
ht
yzxxa
yycaxxaca
zh
yzxxa
yycaxxcaa
zh
yycaxxacxaayz
yycaxxcaxaayz
yycaxxacaxy
xcaaxcawcrw
zzzza
yyyya
zzzz
yxS
cwSScwSCC
Z
cwSCcwCCxCSY
cwCcwSaX
zyxS
cwSScwSCC
Z
yxS
cwSScwSCC
Z
yxC
cwSCcwCCS
Y
cwSScwSCxSCZ
cwSCcwCCxCSY
cwSScwSCCZ
wYZZZZ
tzyxC
tzyxS
acwP
γεε
εεεε
εεεεε
εεεεε
γεεε
εεεε
γεε
εεεε
γεε
εεεε
εεεεε
εεεεε
εεεε
ε
δδδδ
δδδδ
δδδ
   (6) 
 
xtrxacaacrwac
rwcazayacxcam
yhrxacacarwca
rwcazaycaxcam
cacrwcrwcycxcm
yxc
za
ZZCYSCYSC
XSSQCQSCQSSZ
YZSYCCYCC
XSCQSQCCQSCY
YSYSXCQSQCX
KKa
Ka
++−+
+−−−=
+−−+
++−−=
+−++−=
=
=
)tan(
)cos(
θ
θ
                         (7) 
Finally, the geometric error model is established as follows: 
eJPQP t
r
t
r
t
r =−=δ                                                                (8) 
where δP and rJt are the measuring error vector and the 
sensitivity Jacobian matrix of the tool versus reference 
frame. e is the error vector including 43 geometric errors. 
IV. SIMULATION AND ANALYSIS 
A. Standards for machine tools 
The basic standard for geometric testing of machine tools 
is ISO series 230 [23], [24] and another important series of 
machine specific standards is ISO series 10791 [25]-[26] for 
machining centers. Based on the standard ISO 230-7 and 
ISO 10791-6 draft, the path interpolation, circular and 
kinematic test methods for five-axis machine tools are 
chosen to analyze the geometric error model in this section. 
To simplify the error model, the BK2 path which performs X, 
Y and C-axis synchronized motions at the TCP mode is 
utilized to test the deviations of the machine tool. The 
desired position rQt 
and the orientation rKt 
are set to [0 0 0] T 
and [0 0 1] T, respectively. For decreasing the influence of 
acceleration transient, the jerk-limited feedrate profile [16] 
is applied to generate the C-axis trajectory. Therefore, 
Xm=-Rcos(θc), Ym=-Rsin(θc) and Zm=θa=0 are obtained 
where R is the radius of circular trajectory. By substituting 
352
 
 
 
[2] L. J. Everett and A. H. Suryohadiprojo, “A study of kinematic models 
for forward calibration of manipulators,” in the IEEE Conference on 
Measuring Technology and Mechatronics Automation, Zhangjiajie, 
PA, USA, Apr. 24-29, 1988. 
[3] Y. Abbaszadeh-Mir, J. R. R. Mayer, G. cloutier and C. Fortin, “Theory 
and simulation of the link geometric errors for a five-axis machine tool 
using a telescoping magnetic ball-bar,” International Journal of 
Production Research, vol. 40, no. 18, pp. 4781-4797, 2002. 
[4] M. Tsutsumi and A. Saito, “Identification and compensation of 
systematic deviations particular to 5-axis machining centers,” 
International Journal of Machine Tools and Manufacture, vol. 43, no. 
8, pp. 771-780, 2003. 
[5] M. Tsutsumi and A. Saito, “Identification of angular and positional 
deviations inherent to 5-axismachining centers with a tilting-rotary 
table by simultaneous four-axis control movements,” International 
Journal of Machine Tools and Manufacture, vol. 44, no. 12-13, pp. 
1333-1342, 2004. 
[6] S. H. H. Zargabashi and J. R. R. Mayer, “Assessment of machine 
trunnion motion error using magnetic double ball bar,” International 
Journal of Machine Tools and Manufacture, vol. 46, no. 14, pp. 
1823-1834, 2006. 
[7] W. T. Lei and Y. Y. Hsu, “Accuracy test of five-axis CNC machine 
tool with 3D probe–ball. Part I: design and modeling,” International 
Journal of Machine Tools and Manufacture, vol. 42, no.10, pp. 
1153-1162, 2002. 
[8] W. T. Lei and Y. Y. Hsu, “Accuracy test of five-axis CNC machine 
tool with 3D probe-ball. Part II: errors estimation,” International 
Journal of Machine Tools and Manufacture, vol. 42, no. 10, pp. 
1163-1170, 2002. 
[9] W. T. Lei and Y. Y. Hsu, “Accuracy enhancement of five-axis CNC 
machines through real-time error compensation,” International 
Journal of Machine Tools and Manufacture, vol. 43, no. 9, pp. 
871-877, 2003. 
[10] Y. Y. Hsu and S. S. Wang, " A new compensation method for 
geometry errors of five-axis machine tools," International Journal of 
Machine Tools and Manufacture, vol. 47, no. 2, pp. 352-360, 2007. 
[11] B. Bringgmann and W. Knapp, ”Model-based ‘chase-the-ball’ 
calibration of a 5-axis machining center,” CIRP Annals – 
Manufacturing Technology, vol. 55, no. 1, pp. 531-534, 2006. 
[12] S. H. H. Zargabashi and J. R. R. Mayer, “Single setup estimation of a 
five-axis machine tool eight link errors by programmed end point 
constraint and on the fly measurement with Capball sensor,” 
International Journal of Machine Tools and Manufacture, vol. 49, no. 
10, pp. 759-766, 2009. 
[13] E. L. J. Bohez, “Compensation for systematic in 5-axis NC 
machining,” Computer-Aided Design, vol. 34, no. 5, pp. 391-403, 
2002. 
[14] E. L. J. Bohez, B. Ariyajunya,  C. Sinlapeecheewa, T. M. M. Shein, D. 
T. Lap and G. Belforte, “Systematic geometric rigid body error 
identification of 5-axis milling machines,” Computer-Aided Design, 
vol. 39, no. 4, pp. 229-244, 2007. 
[15] H. Schwenke, W. Knapp, H. Haitjema, A. Weckenmann, R. Schmitt, 
and F. Delbressine, ”Geometric error measurement and compensation 
of machines – An update,” CIRP Annals – Manufacturing Technology, 
vol. 57, no. 2, pp. 660-675, 2008. 
[16] M.-T. Lin, M.-S. Tsai and H.-T. Yau, “Development of a dynamics- 
based NURBS interpolator with real-time look-ahead algorithm,” 
International Journal of Machine Tools and Manufacture, vol. 47, no. 
15, pp. 2246-2262, 2007. 
[17] K. Erkorkmaz and M. Heng, ”A heuristic feedrate optimization 
strategy for NURBS toolpaths,” CIRP Annals – Manufacturing 
Technology, vol. 57, no. 1, pp. 407-410, 2008. 
[18] B. Sencer, Y. Altintas, and Elizabeth Croft, “Modeling and control of 
contouring errors for five-axis machine tools-Part I: Modeling,” 
ASME Journal of Manufacturing Science and Engineering, vol. 131, 
no. 3, 2009. 
[19] B. Sencer and Y. Altintas, “Modeling and control of contouring errors 
for five-axis machine tools-Part II: Precision contour controller 
design,” ASME Journal of Manufacturing Science and Engineering, 
vol. 131, no.3, 2009. 
[20] B. Bringgmann and P. Maglie, ”A method for direct evaluation of the 
dynamic 3D path accuracy of NC machine tools,” CIRP Annals – 
Manufacturing Technology, vol. 58, no. 1, pp. 343-346, 2009. 
[21] W. T. Lei, I. M. Paung and C.-C. Yu, “Total ballbar dynamic tests for 
five-axis CNC machine tools,” International Journal of Machine 
Tools & Manufacture, vol. 49, no. 6, pp.488-499, 2009. 
[22] A. H. Slocum, Precision Machine Design, Prentice-Hall, Englewood 
Cliffs, NJ, 1992. 
[23] ISO 230-4, Test code of machine tools. Part 4: Circular test for 
numerically controlled machine tools, International Standard, 2005. 
[24] ISO 230-7, Test conditions for machine centers. Part 4: Geometric 
accuracy of axes of rotation, International Standard, 2006. 
[25] ISO 10791-6, Test code of machine tools - Accuracy of feeds, speeds 
and interpolations, International Standard, 2001. 
[26] ISO 10791-8, Test code of machine tools. Part 8: Evaluation of 
contouring performance in the three coordinate planes, International 
Standard, 2001. 
[27] Heidenhain Corporation, NC Software 340 490-02, 491-02, 492-02, 
493-02-iTNC530 Technique Manual, 2006. 
 
 
 
Fig. 1. An optical measurement instrument on the five-axis machine tool. 
 
 
 
 
             
 
Fig. 2. The kinematic chain of a five-axis machine tool. 
 
Machine Spindle
Magnetic base 
C-axis table 
Tool holder 
Sensing head 
Glass ball 
X 
Y
Z
Tool 
Tool holder 
Spindle 
Reference 
A-axis 
Workpiece
C-axis
X-axis
Y-axis 
Z-axis
Yh
Xh 
Zh
Yt
Xt 
Zt
Yr
Xr 
Zr
Yc,a 
Xc,a
Zc,a
Yw
Xw
Zw
Yx
Xx 
Zx
Xz
Yz 
Zz 
Zht
Zyz 
Zzh
Zrw
Zwc
Yy
Xy 
Zy
Zax
Zxy
Yzh
Yyz 
354
國科會補助計畫衍生研發成果推廣資料表
日期:2011/12/13
國科會補助計畫
計畫名稱: 用於CNC工具機運動控制之即時NURBS曲面曲線差補器研究
計畫主持人: 林明宗
計畫編號: 99-2221-E-150-023- 學門領域: 動力與控制
無研發成果推廣資料
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
其他成果 
(無法以量化表達之
成果如辦理學術活
動、獲得獎項、重要
國際合作、研究成果
國際影響力及其他
協助產業技術發展
之 具 體 效 益 事 項
等，請以文字敘述填
列。) 
2011 IEEE ICMA 會議 Session Chair 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
