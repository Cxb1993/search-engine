2結合廣域量測系統及電腦叢集於電力系統狀態估測與短期負載預測之研究
A Study on WAMS and PC Cluster for Power System State Estimation and
Short-Term Load Forecasting
計畫編號 : NSC 96-2221-E-214-069
執行期限 : 96年 8月 1日至 97年 7月 31日
主持人 : 楊俊哲 助理教授
計畫參與人員 : 蔡和憬 謝維霖
執行機構及單位名稱 : 義守大學電機工程學系
摘要 –由於本計畫”結合廣域量測系統及電腦叢集於電力
系統狀態估測與短期負載預測之研究”當初提案時為二年期
計畫，但國科會僅同意為一年期計畫，故我們於這一年中針
對結合電腦叢集與短期負載預測進行研究。在本研究中，我
們利用電腦叢集平行運算的特性，提出不同的架構結合基因
演算法與類神經網路進行短期負載預測。在此新的架構下，
我們不需要決定類神經網路中隱藏層的節點個數，而基因演
算法與類神經網路會被交替使用，使得每個基因均會經歷如
同生物的出生、學習及死亡的過程，我們並以台電 2007 年 7
到 9 月之負載資料為學習及驗證的資料，經模擬驗證我們所
提出之基因類神經演算法架構具有相當優秀的表現，適合使
用於短期負載預測。
關鍵字 : 電腦叢集、平行運算、短期負載預測、類神經網路、
基因演算法
Abstract –Since NSC only approved this project “A Study on 
WAMS and PC Cluster for Power System State Estimation and
Short-Term Load Forecasting”for a year project, we chose
short-term load forecasting to apply to PC cluster to be the goal
of this year. In this project, we utilize the feature of parallel
computing on PC cluster to support a new algorithm of combing
Genetic Algorithm and Back Propagation Neural Network. In
this new algorithm, Genetic Algorithm and Back Propagation
Neural Network are used to search the best solution by turns, and
each gene in this algorithm to be born, to learn and to die just like
life. We use the record data of load demand from July to
September in 2007 which provided by Taipower company to
train and test this algorithm. The simulation results show that this
algorithm is much better than Back Propagation Neural Network
and suitable for short-term load forecasting.
Keywords: PC Cluster, Parallel Processing, Short-term Load
forecasting, Neural Network, and Genetic Algorithm.
I. 簡介
現今的電力系統如此龐大複雜，為了維持電力系統
的穩定運轉，在穩態及動態下需要有適當的控制以因應
負載的變化，且在暫態下則需要有正確的保護動作以避
免系統崩潰，所以有許多新的研究與應用紛紛被發展出
來。其中，為了能全盤掌握電力系統的狀況，設置廣域
量測系統(Wide Area Measurement System, WAMS)已經
是電力領域中的一股潮流，目前已有許多應用皆以廣域
量測系統為基礎。藉由廣域量測系統，控制中心的人員
可以及時監測電力系統的狀況，更可以進一步預防事故
的發生或減少事故危害的範圍。
同 步 相 量 量 測 單 元 (synchronized Phasor
Measurement Unit, PMU)為現代廣域量測系統中不可或
缺的要角，藉由同步相量量測單元所量測到的同步匯流
排電壓、電流相量等相關資訊，廣域量測系統才能發揮
作用。但對一個電力系統而言，不太可能每個匯流排均
安裝 PMU，所以部分匯流排的狀態還是需要經過狀態
估測(State Estimation)後得到。然而，隨著 PMU 架設的
匯流排增加，廣域量測系統將面臨以下的問題:
一、龐大的量測資料流量與儲存。
二、後續即時應用的資訊需求。
三、廣域量測系統本身的可靠度。
所以，綜合以上三個問題，我們需要一個能使網路
資料負載分攤、具有高速運算能力，以及提高廣域量測
系統可靠度的技術，在這裡我們選擇了電腦叢集(PC
Cluster)作為解決的方法，這是因為電腦叢集可以充分
滿足廣域量測系統的需求，說明理由如下[1]:
一、負載平衡叢集 :以目前入口網站 Yahoo!及
Google 為例，如此龐大的資訊流量，應該沒有ㄧ部單
一伺服器可以應付，所以，Yahoo!及 Google 所採用的
方式就是利用電腦叢集負載平衡的能力，將資訊流量分
攤至多台伺服器上。
二、平行運算叢集:電腦叢集-也就是使用多部一般
的個人電腦來組成超級電腦已經被證實為可行，而且使
用電腦叢集具有價格低廉、元件取得容易、維護容易等
優點，非常適合支援科學與工程領域的大量平行處理等
應用。目前，國家高速網路與計算中心組合的福爾摩沙
一號(Formosa Cluster I)已經名列世界五百大超級電腦
之ㄧ[2]。
三、高可用性叢集:想要提高系統的可靠度，最好
的方法就是 Redundancy，只有在設計良好的高可用性
叢集下，為所有裝置建立備援與自動錯誤輪替裝置，才
能避免單點失敗的發生。
而在本研究中，將先針對廣域量測系統中所需的高
速運算能力著手，選擇短期負載預測此項需要大量運算
且適合予以平行化處理的課題作為切入點，希望能逐步
實現讓廣域量測系統成為一個可應用於電力系統控制
的平台。
雖然目前發表於 IEEE 的論文中，將電腦叢集應用
於電力系統的論文並不多見[3-8]，這是因為這項技術發
展的時間不長。電腦叢集本身是從 1994 年美國太空總
署(NASA)的 CESDIS (Center of Excellence in Space
4圖二、電腦叢集實際完成圖
在軟體方面:基本上，對於熟悉 Linux 系統的人而
言，架設電腦叢集並不困難只需要下列幾點提示即可:
Step1.決定主機(master)及節點(slave)，並設定好網路
環境，使其能透過網路傳遞訊息。
Step2.設定主機及節點的RSH。使其可以靠ssh或sftp
傳遞訊息。
Step3.設定主機及節點的NFS。將主機的目錄及檔案
分享給節點。
Step4.設定主機及節點的NIS。用以維護Linux主機間
的帳號及密碼。
Step5.安裝訊息傳遞介面(MPICH2)於主機及節點。
其中:
RSH(Remote SHell):遠端登入介面，由於主機執行平
行運算時要遠端登入節點，故必須開啟該項服務。
SSH(Secure SHell protocol):將進行連線之資料加密之
技術，使資料傳遞更安全。
SFTP(SSH File Transfer Protocol):類似FTP的功能，但
資料加密，故更為安全。
NFS(Network File System):藉由網路將目錄及檔案分
享給連線之節點。
NIS(Network Information System):讓網域內的使用者
不論在哪一台主機上操作，只要NIS伺服器有其帳號及
密碼，Linux系統就會到NIS伺服器上去比對，即可讓使
用者登入。
完成以上之步驟，只能算將電腦的硬體及作業系統
結合起來，重點是如何撰寫平行化程式以及進行平行運
算。一般而言，平行化計算的理念就像是一個人處理一
個問題，若是分給十個人，每個人負責處理一部份，這
樣看起來似乎會節省下許多時間。但實際上，十個人共
同解決一個問題需要彼此溝通協調，若是溝通不良將發
生人多手雜的狀況，不一定能達到節省時間的效果，所
以並不是每一種演算法或計算方法均適合使用平行運
算，使用不當還會導致反效果，徒然浪費運算資源。實
際上，要將演算法或計算方法平行化所付出的代價很
高，使用電腦叢集意味著要以全新的角度研究以及思考
所要撰寫的程式，而且，程式撰寫中最花費時間的除錯
(debug)與程式最佳化，也可能無法從以前的經驗中獲得
要幫助，而且撰寫完成的平行化程式也不一定符合預
期。所以，演算法或計算方法本身是否適用於平行運
算，才是平行程式設計成功與否的關鍵。
演算法或計算方法平行化的第一步，是將其計算特
性予以分類[11]，根據 Geoffrey Fox 的分類，可將其分
成四類:
1.完美平行化(perfect parallelism):每個平行處理之
資料完全獨立，如同完全不相干的工作交給不同的主機
運算一般，所以計算的效能隨著計算節點的增加而得到
顯著的提升。
2.管線平行化(pipeline parallelism):計算資料的過程
如同工廠的生產線ㄧ樣，從一個計算階段到下ㄧ個計算
階段，因此只要每個計算階段所需之計算時間相近，則
平行化的效能也不錯。
圖三、平行化架構分類
6電腦必須是非忙碌中方可使用此指令，不然將造成資料
遺失。
MPI_Barrier : 則是等所有電腦執行到這行指令後，才
繼續執行下去。
MPI_Wtime : 將傳回電腦目前的時間。
MPI_Reduce : 平行運算中，相同的變數名稱因計算
的部份不同，因此值也不同，此指令可將相同的變數名
稱的值依照指定方式予以統一到指定的電腦。
MPI_Allreduce : 與MPI_Reduce類似，但此指令可將
相同的變數名稱的值依照指定方式予以統一全部的電
腦。
由於現今電腦運算速度遠高過網路通訊速度，因此
在將演算法實際平行化前有必要分別估算及量測其計
算之時間及網路通訊之次數及通訊時間，我們分別針對
點對點通訊及集體通訊在不同傳輸資料量下進行通訊
時間量測，量測結果如表一。
表一、電腦叢集傳輸時間量測
由上表可知，點對點通訊在 2 點互傳或 4 點互傳的
時間消耗上相當接近且遠小於集體通訊，因此，若非必
要，選擇點對點通訊將比較有效率。同時，請注意
MPICH2 訊息傳遞介面通訊時有資料量的限制，當資料
量過大時，將產生當機的嚴重後果。此外，根據演算法
的通訊次數及資料量，由上表可以輕易推算出通訊時
間，若是運算時間小於通訊時間，就必須考慮放棄平行
化。不過，平行化不一定能加快求解速度。但是當資料
越多、計算越複雜運算量超過一台處理器所能負荷時，
此時平行化處理就是解決這種問題的方法之ㄧ。此外，
平行化還具有交互驗證提高系統可靠度的優點。
III. 演算法
目前，已有許多論文探討短期負載預測，這些方法
可以簡單分成統計法(Statistical Method)以及人工智慧
法(Artificial Intelligence, AI)。而在統計法中較常用的有
時間序列法(Time Series Prediction)，線性迴歸(Linear
Regression Model) 以 及 自 動 迴 歸 移 動 平 均 (Auto
Regressive Moving Average, ARMA)，至於人工智慧法
則包括專家系統(Expert System)，類神經網路(Artificial
Neural Network, ANN)，及模糊理論(Fuzzy Theorem)。
A. 倒傳遞類神經網路
在上述方法中，以倒傳遞類神經網路(BP)最廣泛被
使用於短期負載預測，這是因為類神經網路的輸出入變
數間的關係無須設定任何假設，可以用簡單的網路權值
描述複雜的集合數據，並可適用於任意型態之輸出入映
對，對非線性模型學習力高，但缺點為學習速度緩慢、
學習時運算量大、學習過程中常落入區域最佳解、隱藏
層之節點數難以決定等問題。簡單的類神經網路架構可
由圖四表示。
圖四、類神經網路基本架構
由上圖中可以知道，類神經網路主要由三個層組成:
輸入層、隱藏層及輸出層，每一層均由節點(神經元)組
成，基本上，根據輸入的資料可以決定輸入層的節點
數，而輸出層的節點數由希望輸出的學習資料決定，但
是隱藏層的節點數無法決定，節點數太少，則學習的效
果不好，但節點數太多除了學習效率不好，也可能造成
overfitting 的問題，雖然目前有些文獻有建議的節點數
計算方式，但通常效果不是很好。此外，隱藏層並沒有
限定只能一層，但研究顯示隱藏層不宜超過兩層，但是
一層好還是兩層好，目前並沒有結論。
類神經網路中，層與層之間的神經元均有連結權
重，輸入的資料經權重計算累加後與神經元內的偏權值
加總，之後再經過轉換函數得到神經元輸出，由於類神
經網路的連結權值、偏權值一般是由亂數給定，而隱藏
層中節點數也是需要多次測試比較後方能得到，對使用
者而言很不方便，因此，有文獻提出結合基因演算法
(GA)以搜尋最佳初始連結權值及偏權值，並獲得良好的
效果，因此本研究也採用基因演算法結合類神經網路來
進行短期負載預測。但是，本研究提出新的結合架構並
使其在電腦叢集上獲得良好的效果。以下針對基因演算
法進行簡單說明。
B. 基因演算法
基因演算法是根據達爾文的進化論而被提出的方
法，是由 Holland 於 1975 年首先提出，之後在 1989 年，
8是可被拿掉的神經元，也就是不重要的神經元，反之，
用來通過訊號的神經元，也就是重要的神經元，所以偏
權值正值越大的神經元就是越重要的神經元，而偏權值
負值越大的神經元就是越不重要的神經元。因此，依據
此推論排列神經元的重要順序，就可以確定每一個獨特
的解。
此外由於轉移函數的輸出為二進位，所以用來預測
短期負載的輸出將是一連串的 0 與 1 的組合，可是每個
位置的輸出重要性卻大不相同，越是越前面的位元出現
的錯誤，轉換為十進位後的誤差將越大，所以，為確保
越前面的位元能越正確，我們設定越前面的位元學習率
越高。
圖八、基因內染色體示意圖
為了方便基因進行突變及交配，也為了方便類神經
訓練與學習，我們定義基因的架構就如同類神經，如圖
八。因此，類神經學習方式不需要更改，直接沿用原有
的倒傳遞類神經網路的學習方式，但我們重新定義每一
個隱藏層之神經元以及其所連結的上下兩部分連結權
重合稱為一對染色體，因此圖八中共有 5 對染色體。
此外，由於本演算法是基因演算法及類神經網路交
互使用，所以我們定義”一年”為完成訓練(春、夏)，經
歷死亡(秋)，迎接新生(冬)。
藉由上述之定義，我們描述所提出基因類神經
(GABP)演算法:
訓練:為了鑑別基因的好壞，將基因交給類神經網路訓
練是必要的，訓練一次的定義是將訓練資料全部
學習一次，但是每年的訓練次數不是一直訓練到
網路連結權值收斂，而是固定的 5 次。然後依照
每次學習的錯誤率調整其學習率，錯誤率持續下
降者提高其學習率，而錯誤率起伏不定者降低其
學習率。
死亡 :基因的死亡意謂著將基因移出基因池(Gene
Pool)，有兩種不同的方式挑選死亡的基因。
淘汰:在基因池接近額滿的狀況下，錯誤率高的基
因將被淘汰。
退休 :由於每年的訓練可以使基因的錯誤率降
低，因此，單純使用淘汰的缺點為:被淘汰
的基因幾乎為新生的基因。所以，根據基因
的年紀，當在基因池接近額滿的狀況下，年
老的基因將退休離開基因池。
出生:在第一年中，所有的基因為隨機產生，為了基因
的多樣性以及解決類神經網路無法決定節點數的
問題，我們連染色體個數也是在限定範圍內隨機
產生，除了第一年外，之後出生的方式還有:交
配、突變及遷徙。
交配:基因池內錯誤率較低之前 15 名基因有交配
之能力，每名基因隨機選取其中一位與其交
配，但是染色體對數相差 1 以上將配對失
敗，配對成功後之子代染色體對數由錯誤率
較低之染色體決定。子代染色體取得方式為
隨機取其父母之染色體上或下部份。
突變:由於類神經最佳節點數未知，本演算法起始
的染色體對數不一定是最佳節點數，所以藉
由交配後突變的機制尋找。為達成此目的，
只有基因池內錯誤率最低前 3 名基因且染
色體對數為基因池內最多或最少者可以交
配突變，突變的方向為:染色體對數最多者
隨機增加一對染色體，而染色體對數最少者
固定去除一對最不重要的染色體。
遷徙:由於本演算法在電腦叢集上執行，為使每台
電腦的基因池可以互相交流，每個基因池內
最好的基因將可遷徙至其他基因池，為避免
遷徙後發生無法交配的情況(染色體對數相
差過多)，若欲遷徙進入之基因池無染色體
相差 1 之內之基因，將發生遷徙失敗。
同時，為維持基因池內基因數增長速度不要太快，
每年最多增加的基因數為 3名。基本上，因為只有好的
基因能交配及遷徙，所以將造成基因池內基因的單純
化，而突變及亂數產生則能使基因多樣化，為使新生基
因能夠存活，退休及淘汰是必要的，但是，只要基因池
尚未接近額滿，基因的死亡機制也不會動作，所以每個
基因死亡時間並非固定。
這樣的流程將持續 200 年，200 年後將進入第二階
段，在這個階段，基因池的額滿個數將逐漸減少且不再
發生突變及亂數產生，每個基因的退休年紀將被提升，
主要目的就是要基因池單純化以找出最佳基因。
因此，我們提出之 GABP 演算法架構如圖九所示:
10
圖十一、染色體對數收歛過程(起始染色體對數 50-60)
圖十二、染色體對數收歛過程(起始染色體對數 36-44)
圖十三、九月二日(日)預測結果 圖十四、九月三日(一)預測結果
出席國際學術會議心得報告
計畫編號 NSC 96-2221-E-214-069
計畫名稱 結合廣域量測系統及電腦叢集於電力系統狀態估測與短期負載預測之研究
出國人員姓名
服務機關及職稱
楊俊哲、義守大學電機工程學系、助理教授
會議時間地點 民國 97年 7月 20日起至 97年 7月 24日止、美國匹茲堡
會議名稱 2008 IEEE Power Engineering Society General Meeting
發表論文題目 A Hybrid Method for the Estimation of Power System Low-FrequencyOscillation Parameters
一、參加會議經過
由於本次會議在匹茲堡舉行，在國科會僅四萬元的補助下，找到最便宜的班機飛往匹茲
堡，就是件頭痛的問題，華航及長榮找不到可以直飛的班機，所以決定先搭乘港龍飛香港，
然後轉搭國泰飛洛杉磯，再轉搭 Delta飛亞特蘭大，最後再轉飛匹茲堡，途中遇到一位亞特
蘭大州立大學教授，閒聊起台灣及美國教育研究生的方式，還有台灣少子化的問題，以及美
國次級房貸的影響，該教授人很客氣且很健談，我們大概聊了三、四個小時，整個航程加上
等待轉機的時間超過 24小時，整個人累到一進匹茲堡的旅館就睡了快 12個小時才醒來，星
期二才赴會場註冊並參加各項議程，本次大會安排許多參觀行程，但是均要額外的費用，在
衡量有限的經費下，本人均沒有參加。由於本人的報告是星期四中午，也是會議的最後一天，
通常最後一天的參與的人數不多，反應也很少，會議結束後就搭機返國。
二、與會心得
IEEE PES General Meeting 是電力領域最重要的年會之一，每次參加均能有豐富的收穫，
可惜舉行的地點幾乎在美國境內，若是在美西舉辦，國科會的補助還勉強可以應付機票錢，
若是在美東則一定是要額外花費不少。希望國科會可以多補助出席國際會議上，讓有心想出
席國際重要會議的老師獲得更多幫助。
