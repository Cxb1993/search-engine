voltage power MOSFET implemented outside of the MPPT 
controller chip, it can be employed for the PV panels 
with input voltage of 20V~40V and output power of 
300W. The maximum measured tracking efficiency and 
conversion efficiency are 99.5% and 97%, 
respectively. The transient tracking factor (TTF) is 
0.36ms/W. 
This subject proposes an AC-DC converter control chip 
with MPPT and power factor correction (PFC) functions 
for wind-turbine generator with one-cycle control 
based PFC circuit mplemented. The theoretic analysis 
of one-cycle control and the experimental circuits 
have been developed to verify the feasibility via 
FPGA control-chip design. 
The micro-inverter controller chip was designed for 
the PV power generation systems with on-grid and 
stand-alone modes. The micro-inverter controller is 
designed for TSMC 0.18μm 1P6M 3.3V Mixed-Signal CMOS 
process with only 0.97mm2 layout area. Post-layout 
simulations show that the 100W micro-inverter reaches 
96.5% conversion efficiency and 2.5% THDi. 
This Subject aims at establishing the simulation and 
test environments for the hybrid solar PV and wind 
power generation systems developed as described 
above. In the meantime, the programmable digital 
control IC is used as a core to establish the solar 
and wind power management system. Co-working the 
converters developed in Subjects 1-3 and the 
charging/discharging circuits, the researches achieve 
effective switching among system operation modes as 
well as islanding detection functions through FPGA 
chip design. 
英文關鍵詞： Hybrid Solar PV and Wind-turbine Generation, Control 
Chip Design, Power Converters, Grid-Connected 
Operation, Islanding Operation 
 
  i 
中文摘要 
再生能源的應用在現今溫室效應造成環境氣候變遷的嚴重衝擊下，益發突顯
其重要性，尤其能源多元化已成為世界各國能源政策努力的目標。近年來，小型
分散式發電系統已廣泛設置利用，且數量逐年成長，例如，電力儲能設備、太陽
能電力系統與風力發電系統均已有效與市電系統併聯運轉。本計畫旨在透過晶片
設計與應用，模擬與研製一包括太陽能與風力之混合能源發電市電併聯之整合系
統，計畫內採「整體規劃、分項實施」方式，本期報告為第三年度結案期末報告，
各分項執行內容如下： 
分項ㄧ 
分項一採用 TSMC 0.5μm 2P4M 5V Mixed Signal CMOS 製程實作 IC，就所
知為全世界最先以類比積體電路實現的太陽能發電最大功率追蹤轉換器，晶片尺
寸約為 3mm2，遠小於傳統實現方式的成本及體積。藉由發展的創新技術，可針
對不同的太陽能電池做最佳化並提升效能。外接高壓功率電晶體後可用於最大功
率點電壓範圍為 20V~40V 左右的太陽能板且輸出功率可達 300W 以上，實際量
測結果顯示其追蹤效率高達 99.5%，功率轉換效率可達 97%以上，其暫態響應參
數為 0.36ms/W，遠優於現有技術。本設計成果之系統在成本、功率消耗及體積
上均大幅降低的優勢下，相較傳統追蹤器更適合應用於強調高效率的車用商品及
光電建築等太陽能發電系統。 
分項二 
本分項旨在提出風力發電系統具最大功率追蹤與功因校正功能之 AC-DC 轉
換器控制晶片並實現單週期控制之功因校正控制電路。單週期控制之功率因數校
正電路為定頻操作控制之功因修正電路，適用於中、高瓦數之應用。經三年計畫
的執行本計畫完成單週期控制之控制原理分析與實體電路測試；並使用 FPGA 完
成控制晶片系統，提出採用數位晶片控制方式實現單週期控制理論及方法。應用
單週期控制功率因數校正電路，可整合最大功率追蹤運算，且免用乘法器即可達
到功率因數校正，達到減少風力發電機之輸出電流諧波提高風力發電機之功率因
數，以整高風力發電機之電能轉換效率。 
分項三 
在分項三中提出一個適用於再生能源的直流/交流換流器控制晶片，並且擁
有與市電併併聯和獨立供電的功能。在市電併聯的模式下系統使用 current 
distortion reducing 演算法降低輸出電流諧波失真成分，並且提升換流器的轉換效
率。對於獨立供電模式下輸出電壓的穩定度也透過建立小訊號模型來加以驗證。
使用類比控制器降低系統運算複雜度以及硬體成本，並且提出許多應用於此直流
/交流換流器的電路。此電路是透過 TSMC 0.18µm 1P6M 3.3V Mixed-Signal 
  iii 
ABSTRACT 
Renewable energy has been drawing more attention since the advent of global 
warming effects. In particular, multiple-energy sources have currently become one of 
the goals for energy policy of the developed countries around the world. Over the last 
decades, an increased percentage of dispersed small-scaled generators, such as battery 
energy storage systems, photovoltaic (PV) systems, wind generation, and 
cogeneration, has been operated effectively in parallel with utility networks. Through 
chip designs and applications, the project aims at simulating and implementing an 
integrated system connecting the grid with hybrid solar PV and wind-turbine power 
generation systems. Based on schemes of “integrated planning and divided subject 
implementing”, the subjects and their contents of the project are described as follows. 
Subject 1:  
The chip was designed and fabricated by TSMC 0.5μm 2P4M 5V Mixed Signal 
CMOS process. To the best of our knowledge, this is the first maximal power point 
tracking (MPPT) converter which is implemented by analog integrated circuit. The 
total chip area is about 3 mm2, which is far smaller than conventional types in cost 
and volume. By the proposed techniques, output power of different PV panels can be 
optimized and its performance can also be enhanced. With a high voltage power 
MOSFET implemented outside of the MPPT controller chip, it can be employed for 
the PV panels with input voltage of 20V~40V and output power of 300W. The 
maximum measured tracking efficiency and conversion efficiency are 99.5% and 97%, 
respectively. The transient tracking factor (TTF) is 0.36ms/W, the best one ever 
recorded. Compared with the conventional MPPT trackers, this design largely reduces 
cost, power loss and volumn, a fact which means it is more appropriate to apply for 
the products requiring high-efficiency converter, such as products in vehicles and 
building-ntegrated photovoltaics (BIPV). 
Subject 2: 
This subject proposes an AC-DC converter control chip with MPPT and power 
factor correction (PFC) functions for wind-turbine generator with one-cycle control 
based PFC circuit mplemented. One-cycle control based PFC is a fixed frequency 
operating circuit, and appropriate in the middle and high power applications. The 
theoretic analysis of one-cycle control and the experimental circuits have been 
developed to verify the feasibility via FPGA control-chip design. The One-cycle 
control based PFC was also integrated with MPPT control easily to achieve high 
power factor and low wind power generator output current harmonic distortion. With 
  v 
目 錄 
中文摘要........................................................................................................................................i 
ABSTRACT ...............................................................................................................................iii 
圖  目  錄 .................................................................................................................................vi 
表  目  錄 ..................................................................................................................................x 
壹、計畫緣由與目的 ...............................................................................................................1 
貳、計畫研究初步成果 ...........................................................................................................3 
2.1 分項一：太陽能發電系統具最大功率追蹤功能之 DC-DC 轉換器控
制晶片設計 ..................................................................................................3 
2.1.1 前言 ......................................................................................................3 
2.1.2 發展動機 ..............................................................................................6 
2.1.3 整體系統架構 ......................................................................................9 
2.1.4 整體電路設計 ....................................................................................10 
2.1.5 晶片實作、效能量測及比較 ............................................................17 
2.2 分項二：風力發電系統具最大功率追蹤與功因校正功能之 AC-DC 
轉換器控制晶片設計 ................................................................................25 
2.2.1 前言 ....................................................................................................25 
2.2.2 功率校正電路 ....................................................................................26 
2.2.3 單週期控制之分析研究 ....................................................................27 
2.2.4 應用數位控制晶片實現單週期控制之晶片控制結構分析設計 ....32 
2.2.5 三相 PFC 閉迴路控制系統 ...............................................................36 
2.2.6 量測結果與討論 ................................................................................37 
2.3 分項三：具高效能適應控制型與功率管理能力之 DC-AC 換流器控
制晶片設計 ................................................................................................39 
2.3.1 前言 ....................................................................................................39 
2.3.2 設計原理與分析 ................................................................................39 
2.3.3 量測結果 ............................................................................................62 
2.4 分項四：具不同運轉模式切換與管理技術與更有效偵測孤島運轉功
能之整合系統 ............................................................................................64 
2.4.1 前言 ....................................................................................................64 
2.4.2 風光混合能源系統架構與運轉模式 ................................................64 
2.4.3 雙向充放電系統 ................................................................................66 
2.4.4 孤島偵測 ............................................................................................77 
參、參考文獻 ..........................................................................................................81 
  vii 
圖 2- 1 傳統單相整流電路與加入電流修正技術後之輸出電流......................................................26 
圖 2- 2 風力機 AC-DC PFC 系統架構 .............................................................................................27 
圖 2- 3 單週期控制之降壓式轉換....................................................................................................27 
圖 2- 4 定頻操作之單週期控制電路 ................................................................................................29 
圖 2- 5 單週期控制電路示意圖........................................................................................................29 
圖 2- 6 理想之功因校正電路等效模型 ............................................................................................30 
圖 2- 7 實現公式(2-18)之控制電路圖 ..............................................................................................31 
圖 2- 8 電流感測(Vsense)、積分器輸出(Vint)與單週期控制訊號(Vgs)之理想波形......................31 
圖 2- 9 數位控制晶片結構圖 ...........................................................................................................32 
圖 2- 10  PI 補償器示意圖...............................................................................................................32 
圖 2- 11  數位 PI 補償器架構 ..........................................................................................................33 
圖 2- 12 數位反向積分器 .................................................................................................................33 
圖 2- 13 控制波形：(a)類比型態 (b)數位形態................................................................................34 
圖 2- 14 數位控制波形與責任週期波形 ..........................................................................................34 
圖 2- 15 串聯式除頻器 .....................................................................................................................35 
圖 2- 16 時脈訊號關係圖 .................................................................................................................35 
圖 2- 17 時序訊號傳送示意圖..........................................................................................................35 
圖 2- 18 應用於三相風力發電機之功因修正電路...........................................................................36 
圖 2- 19 不同輸出功率下之轉換效率曲線 ......................................................................................37 
圖 2- 20 在不同輸出功率下之線電流諧波失真...............................................................................37 
圖 2- 21 不同輸出功率下之發電機輸出電流波形(a)300W (b)500W (c)1000W..............................38 
 
圖 3- 1 (a)市電併聯模式併聯換流器架構圖 (b)獨立供電模式併聯換流器架構圖.........................40 
圖 3- 2 系統方塊圖...........................................................................................................................41 
圖 3- 3 電流控制型換流器之功率級電路 ........................................................................................42 
圖 3- 4 負半週期之單極性脈波頻寬調變切換.................................................................................42 
圖 3- 5 電流控制型換流器之電路....................................................................................................43 
圖 3- 6 電流控制型換流器之輸出波形 ............................................................................................43 
圖 3- 7 電流控制型換流器之輸出電流頻譜分析圖 .........................................................................44 
圖 3- 8 電流控制型換流器之半週期輸出平均電流 MATLAB 分析圖 ...........................................45 
圖 3- 9 電流控制型換流器之切換頻率與市電電壓關係圖 .............................................................45 
圖 3- 10 電流控制型換流器之半週期輸出平均電流 MATLAB 分析圖 .........................................45 
圖 3- 11 使用電流模式控制之電壓控制型換流器架構圖 ...............................................................47 
圖 3- 12 使用電流模式控制之電壓控制型換流器小訊號模型方塊圖 ............................................47 
圖 3- 13 使用電流模式控制之電壓控制型換流器且無補償器時之輸出阻抗 ................................48 
圖 3- 14 使用電流模式控制之電壓控制型換流器且有補償器時之輸出阻抗 ................................48 
圖 3- 15 使用電壓模式控制之電壓控制型換流器架構圖 ...............................................................49 
圖 3- 16 使用電壓模式控制之電壓控制型換流器小訊號模型方塊圖 ............................................50 
圖 3- 17 使用電壓模式控制之電壓控制型換流器且無補償器時之輸出阻抗 ................................50 
圖 3- 18 使用電壓模式控制之電壓控制型換流器且有補償器時之輸出阻抗 ................................50 
圖 3- 19 併聯電壓控制型換流器與電流控制型換流器之小訊號模型方塊圖 ................................51 
圖 3- 20 極零點之座落圖 .................................................................................................................52 
  ix 
圖 4- 23 系統與市電併聯操作於 600W 實驗波型圖(CH1：vac、CH2：Igrid、CH3：Vdc、CH4：
vgrid).....................................................................................................................................77 
圖 4- 24 本計畫所採用主動式孤島偵測控制流程圖 .......................................................................78 
圖 4- 25 類比轉數位晶片 ADC0820 腳位圖 ....................................................................................78 
圖 4- 26 市電電壓電壓閃爍 3.6%之孤島偵測結果..........................................................................79 
圖 4- 27 市電電壓電壓驟升 114 Vrms 之孤島偵測結果 .................................................................80 
圖 4- 28 市電電壓諧波失真 THD = 9%之孤島偵測結果 ................................................................80 
  1 
1 壹、計畫緣由與目的 
由於石化能源的大量使用，油價攀升、溫室效應等環境污染問題亦日益嚴
重，開發再生能源以減少對自然環境的影響至為重要。再生能源的開發與研究，
如太陽能、風力、水力、潮汐、海洋溫差等，即受到相當的重視。再生能源當中，
以太陽光能發電潔淨，不污染環境，且來自太陽的能源蘊藏量豐富，同時隨著商
品化的太陽能光電板轉換效率的提升，使我們可以從太陽光能中取得更多的能
源，也使得太陽光能的應用範圍更加寬廣。 
另一方面，目前全球各國對發展風力能源產業發展亦不餘遺力，以發展潛力
而言，我國屬於海島地形，有較佳的風能可供使用，相當具發展風力發電的潛能，
並由於風力發電為目前成本較低廉之再生能源，故已成為各國再生能源發展重點
之一。為達成政府綠色電力政策之目標，及符合全球氣候變化綱要公約之要求，
國內也已擬定『風力發電十年發展計畫』，極力推行風力發電之發展，未來十年
內將以 200 台風力發電機或總裝置容量 30 萬瓩為實際實施之目標[1]。 
然而，單一再生能源易受季節、氣候等因素影響，導致系統發電量不甚穩定，
供電連續性不佳，而再生能源中太陽能與風能在個別運用上因晝夜、季節氣候等
不可控制因素，使得太陽能與風力在運用上較難掌控，也因此近年來太陽能與風
能結合之「風光互補」發電，使此再生能源供電系統的開發成為分散式發電的主
流，以提高供電調度與系統運轉可靠性。 
結合太陽能與風能之混合式系統，如前所述為較具發展潛力的能源利用方
式，原因如下： 
1. 單一再生能源往往易受晝夜、季節氣候等因素影響，使得系統之供電連續
性不佳，實用性不高，結合太陽能及風能之混合系統可彌補上述缺點，可
達供電之穩定性及連續性。 
2. 若考量能源管理策略，混合型系統因調度之便利性，易於使用能源管理控
制機制，可提高其供電效率。 
3. 太陽能與風力具互補性，利用一年四季中，夏季的日照時間最長也最強，
反之冬季時間太陽光則較弱，適合太陽能發電，而對於風力發電來說冬季
的風力最大，夏季最小；而在白天提供太陽能、風力，而夜間則提供風力。
由於單一再生能源往往容易受到季節、氣候環境等自然因素影響，使得系
統之供電連續性不佳，因而缺乏實用性。 
綜合上述研究背景與動機，本計畫建置一結合太陽能發電與風力發電系統，
透過晶片設計技術，分別針對下列四分項進行研究，各分項執行目標如下： 
 
  3 
2 貳、計畫研究初步成果 
2.1  分項一：太陽能發電系統具最大功率追蹤功能之 DC-DC 
轉換器控制晶片設計 
2.1.1 前言 
在所有再生能源當中，以太陽光能發電潔淨、不污染環境、無需大量人力時
時監控且來自太陽的能源最豐富。在過去 10 年間太陽能電池(solar cell)裝置快速
發展，同時隨著商品化的太陽能光電板(solar photovoltaic panel, 也稱太陽能電池)
轉換效率的提升，使我們可以從太陽光能中取得更多的能源，也使得太陽光能的
應用範圍更加寬廣。 
太陽能發電系統大致上分為兩種，圖 1-1 為市電併聯(grid-connected)，應用
於綠色建築及太陽能發電廠等;圖 1-2 為獨立型(stand-alone)，即不與市電電力系
統相連，只供應部份獨立的負載，可用在可攜式電子產品、家用、醫療及車用電
子產品等。由於太陽能為間歇性能源，其輸出功率會隨外在因素如陽光照度、溫
度的影響而變動，而其電壓與電流間呈現非線性的關係，在不同的工作環境下，
具有不同的工作曲線且每條工作線只有一個最大功率點(即最佳工作點)。為充分
地運用太陽能源，需利用最大功率追蹤控制法則來使太陽能源端隨時操作在最大
功率輸出。這對於目前轉換效率都還不高的太陽能電池而言，不僅僅能夠提高太
陽能系統整體效率也可以降低太陽能的發電成本。 
目前已有一些文獻發表了許多方法來達到最大功率追蹤的效果，在分類上多
達十多種以上，這些方法的不同在於演算法複雜度、感應器需求、收斂速度、成
本、硬體實現、其他層面等[2]。 
 
圖 1- 1  太陽能發電之市電併聯系統架構 
Solar PV 
Panel
MPPT
Converter Battery DC Load
 
圖 1- 2  太陽能發電之獨立型系統架構 
常使用的追蹤方式需要大量且複雜的數學運算及數位訊號處理，因此在硬體
  5 
 
圖 1- 3  最大功率追蹤演算法 
 
 
圖 1- 4  太陽能發電之獨立型系統架構 
分項一利用太陽能電池接收太陽光產生電流與電壓，經由電路上的電壓與電
流偵測取得資訊並傳到類比乘法器做功率計算，再將目前的功率取樣值與前一取
樣值做比較並將結果輸入到 ALLS 電路中並與偵測得到的太陽能電池輸出電壓
做計算，進而控制閘極驅動器的責任週期並推動功率電晶體使太陽能電池輸出達
最大功率點。有別於傳統的電路實現方式，分項一不僅利用類比積體電路方式來
實現最大功率追蹤轉換器，也藉由結合其他的技術，使轉換器同時具備快速收斂
(convergence)、高追蹤效率 (tracking efficiency)與高功率轉換效率 (conversion 
efficiency)之功能。整體系統控制電路包含了自動調整電路 (Auto-adjustment 
Tracking Voltage, ATV)、最適負載線斜率(ALLS)技術及快速暫態響應(transient 
response)技術，功率輸出級則包含閘極驅動器(gate driver)及功率電晶體(power 
MOSFET)。 
  7 
 
1
2
3
 
(a) 
3
2
1
 
(b) 
 
2
1
3
 
(c) 
圖 1- 6 最大功率追蹤演算法追蹤效果比較圖(追蹤過程由 123)(a)電壓迴受控
制(b)電流迴受控制(c)分項一所提之 ALLS 方法 
圖 1-8 為最大功率轉換器的簡單架構圖示。MPPT IC 方塊代表積體化之 IC
方塊，由圖 1-8 及方程式(1-1)可知，由電路偵測太陽能輸出電池電壓(Vpv)及電流
(Ipv)，再利用自動調整(auto-adjustment)及 ALLS 演算法比較 Vpv與 Vstep並產生脈
寬調變(pulse-width modulation, PWM)訊號控制功率電晶體(power MOSFET)的責
任週期，再經由回授路徑對太陽能電池輸出功率進行追蹤，持續重複上述的動
作，能使太陽能電池長時間操作在最大功率點。圖 1-9 與圖 1-10 為上述自動調
整之演算法及電路方塊圖，利用功率取樣及比較改變 Vstep，再以遞迴方式 
  9 
 
 
圖 1- 9  自動調整演算法流程圖 
 
 
圖 1- 10  自動調整演算法電路方塊圖 
 
2.1.3 整體系統架構 
分項一將 ALLS 演算法、自動調整電路(ATV)、快速暫態響應偵測(TD)及功
率電積體置於晶片中，圖 1-8 為其系統架構圖，其他用於濾波的電容(Cin)與低通
濾波器(L & Cout)因元件值較大則放在 PCB 板上，負載併聯一個可維持穩定電壓
值的充電電池，此晶片的安全操作區域(safe operation area, SOA)為 5V 及 3W，
非常適用於可攜式產品。圖 1-11 為 20~40V, 300W 高壓系統架構圖，有別於圖
1-8，其加入了高低壓的轉換介面並將系統重組為升壓式架構，而只需將電流電
壓資訊傳入晶片中即可利用其控制功能達到最大功率追蹤效果，非常適用於較大
功率系統。 
 
  11 
A. 電流偵測電路 
由於最大功率追蹤器需由太陽能電池輸出電壓及電流計算其輸出功率，因此
電流及電壓偵測機制也是重要的方塊之一。傳統電流偵測利用一個電阻串接在電
流路徑上，偵測電阻上的壓降後算出電流值，但此方式會增加許多功率損耗，然
而，使用 CMOS 製程實現不但可藉由加大電晶體的大小降低導通電阻，大大降
低因電流偵測造成的損耗，也可將阻值精準度提高即提高電流偵測精準度。分項
一使用的電流偵測機制如圖 1-13 所示，在電流路徑上串接一 PMOS(即 PMOS1)
並藉由電流鏡將 Ipv 依一定比例引入 Mps 導通路徑上，再透過圖 1-13 中的 OP 將
Vc1和 Vin的電壓控制在相同的值使 Mps 和 PMOS1 跨壓相同即可得到準確的電流
值，再經由 Rsen轉換成電壓型式傳入 ALLS 電路中。 
上述方式為低壓模式下的操作方式，但若操作於高壓模式下，則因晶片耐壓
有限，為了防止外部環境對晶片造成損傷，採用電阻串電流偵測方式，即在輸入
端串聯一小電阻並偵測其壓降再傳入圖 1-14 中的 Ipv_sen中，雖然會有微量功率損
耗，但在高壓模式下此損耗對效率的影響是可忽略的。 
B. 自動調整電路 
傳統上大都是用微處理器做最大功率追蹤轉換器內部計算。首先利用類比數
位轉換器將偵測到的電流電壓值轉換為數位訊號，經過數位訊號處理(digital 
signal processing, DSP)後，將得到的結果輸出的下一個電路方塊中。雖然微處理
器可做精準且快速的運算，但其會有額外功率損耗、花費更多成本及增加類比/
數位電路轉換器等缺點，因此，分項一利用全新架構的類比電路取代之，以克服
上述缺點帶來的影響。 
 
 
圖 1- 13  電流偵測電路 
  13 
 
圖1- 17  S/H時脈波形圖 
3. 上數/下數計數器 
當結束功率比較時，資訊會傳送到上數/下數計數器，作用在於告知系統目
前功率點與最大功率點的差距方向，讓演算法電路可以得到正確的電壓增量值。
為使本系統使用的計數器操作在一定計算範圍內，如圖 1-18 多加了一個防止溢
位計數電路(overflow-prevention counting circuit)，即若給予的資訊已超過計數器
的範圍，仍不會產生錯誤。 
 
圖1- 18  本系統使用的上數/下數計數器 
4. 電阻串式 DAC 
如圖 1-5 與方程式(1-1)所示，ALLS 技術需將負載線操作在最大功率點區
域，因此，本系統使用一電阻串式 DAC 定義操作範圍。根據圖 1-19 中 DAC 所
接上的參考電壓(Vref1 及 Vref1)決定方程式(1-1)中 Vstep的移動範圍，而追蹤的準確
度是由 DAC 的解析度決定，DAC 的輸出則由上數/下數計數器輸出決定。 
  15 
D. 快速暫態響應偵測機制 
太陽能電池輸出功率會隨外部造成的照度變化而改變，此時輸出功率會有一
段時間處於暫態即輸出未達最大功率。然而，快速的環境變化對效率的影響是無
法避免的，因此分項一提出快速暫態響應技術降低其影響程度。如圖 1-21 定義
了一組太陽能電池輸出電流與時間斜率(ΔI/ΔT)，若電流對時間變化斜率小於此
定義值，快速暫態響應不會啟動，反之，則會啟動快速暫態響應機制用以加快系
統切換頻率，讓太陽能電池輸出快速達到穩態並操作在最大功率操作點。其操作
機制如下： 
 
圖 1- 21  快速暫態響應電流與時間關係圖 
Vbound
Comp2
OP
Ipv_sen
SWtrans
φ1
φ2
φ2
Comp1
φ5
φ4
φ5φ4φ3
φ6
CLK 
generator
C1
C2
C3V(t)
+
-
V(t-1)
+
-
X+Vos
+
-
 
圖 1- 22  快速暫態響應偵測電路 
 
圖 1- 23  快速暫態響應時脈關係圖 
 
  17 
2.1.5 晶片實作、效能量測及比較 
A. 晶片實作 
此積體化太陽能最大發電功率追蹤器採用 TSMC 0.5μm 2P4M 5V Mixed 
Signal CMOS 製程進行實作。最後所實現出的晶片尺寸為 1.718 mm 1.796 mm，
總面積約為 3 mm2。圖 1-25 為此實作 IC 照片。此單晶片由國家晶片系統設計中
心 (National Chip Implementation Center, CIC)協助製作，並使用 14 腳位
SSOP(Shrink Small Outline Package, SSOP)封裝。 
 
MPPT
Controller
Power
PMOS
 
圖 1- 25  實作 IC 照片 
B. 規格定義 
1. 追蹤效率 
追蹤效率(ηtrack)的定義為：在同一環境及最大功率追蹤轉換器穩定操作的情
形下，轉換器追蹤到的輸出功率與實際上太陽能電池輸出最大功率的百分比值 
[11]。數學表示式如下 
                   %100
)(
)(
2
1
2
1
t
t
max
t
t
track 


dttP
dttPactual
                    (1-4) 
Pactual為太陽能電池實際輸出功率，Pmax為轉換器追蹤到的輸出功率。此可判定
轉換器的追蹤精準度即太陽能電池操作在最大功率點時的輸出功率轉換效率。 
2. 暫態響應 
圖 1-26 說明太陽能電池輸出功率變化與時間關係圖，在時間 T1 時太陽能電
池輸出功率瞬間由大變小；在時間 T2 時，太陽能電池輸出功率瞬間由小變大。
然而，現今還未有適當的規格定義最大功率追蹤轉換器之暫態響應，因此分項一
  19 
C. 量測環境與結果摘要 
1. 量測環境 
圖 1-28 為分項一晶片低壓量測環境示意圖，圖 1-29 為分項一晶片高壓量測
環境示意圖，圖 1-30 則為低壓 PCB 板與 IC 實照圖，圖 1-31 則為高壓 PCB 板與
IC 實照圖。因此分項一使用安捷倫太陽能陣列模擬器 (Agilent Solar Array 
Simulator, SAS) E4361 取代，並操作在 SAS 模式，負載為致茂電子 63030 電子負
載(Chroma 63030 Electronic Load)，操作在定電壓模式(constant voltage mode)。 
 
 
 
圖 1- 28  低壓量測環境示意圖 
 
 
 
圖 1- 29  高壓量測環境示意圖 
 
 
 
 
  21 
 
Vpv
Ipv
Ppv
1V/div
1W/div
376µs
0.2A/div
1.04W
 
(a) 
 
Vpv
Ipv
Ppv
1V/div
0.2A/div
1W/div
480µs
1.04W
 
(b) 
圖 1- 32 低壓太陽能電池輸出暫態響應量測圖其功率變化(a)1.93W0.28W 
(b)0.28W1.93W 
 
 
圖 1- 33  低壓轉換器太陽能追蹤效率量測結果 
 
 
 
 
 
 
 
  23 
 
圖 1- 37  高壓轉換器功率轉換效率量測結果 
表 1- 2  量測效能摘要 
Items Description Unit 
MPPT IC 
Technology Process 
TSMC 0.5μm 2P4M 5V 
 Mixed Signal CMOS Process 
 
MPPT IC Supply 
Voltage 
5 (Supplied by PV panel) V 
Rated Output Power Up to 300 W 
MPPT Voltage Range 20~40 V 
Load Voltage 48 V 
Load Current Up to 6 A 
Switching Frequency 100 kHz 
Tracking Efficiency 99.5 (Measurement) % 
Transient Response 0.36 (Measurement) ms/W 
Conversion Efficiency 97 (Measurement) % 
MPPT IC Area 
Effective Area: 1.5 x 0.44 
Total Area: 1.796 x 0.545 mm
2
 
PCB Area 10 x 12 Cm2 
 
3. 與先前技術比較 
最大功率追蹤轉換器最重要的指標為追蹤效率和暫態追蹤係數，因此若能同
時最佳化以上兩種規格即為難能可貴。表 1-3 為分項一與近三年國際知名學術機
構 IEEE 文獻及有 IC 實現之產品的效能比較表，可明顯看出，分項一不只在追
蹤效率與暫態追蹤係數上領先群雄外，因未使用微處理器而能大大降低成本及電
路複雜度。另外，在目前市售商品中，國內還未有類似的產品發表，但國外已有
相關產品上架。以德商安德森電能技術公司所研發的 GT615X [17] 為例，其追
  25 
2.2  分項二：風力發電系統具最大功率追蹤與功因校正功能
之 AC-DC 轉換器控制晶片設計 
2.2.1 前言 
近年因相關技術發展漸趨成熟，發電效益高，併聯風力與太陽能之再生能源
混合型發電市電併聯系統為一可利用性極高之再生能源之來源，其中風力發電為
眾多再生能源中，原理簡單，建置成本相對低廉。但風力不穩定，易受氣候影響，
例如：臺灣夏季和冬季之風力就有極大之差異，此為風力發電最大之缺點。 
目前風力發電機之輸出為一整流後之直流電源。傳統使用全橋式整流後再使
用電容濾波來得到直流電源之方法，對風力發電機而言為一整流性負載，具高輸
出電流峰值，低功因及高電流諧波失真，導致多餘的電源轉換損失降低風力發電
機之發電效率。對於前述之缺點可藉由在風力發電機後級改採用一主動式功因修
正轉換器來加以改善，提高風力發電機發電效率。本計畫為設計一具最大功率追
踪與功率因數校正之 AC-DC 轉換器控制晶片。用以提高風力發電機之發電效
率。目前已對功率因數校正部份做分析研究，本報告將對應用單週期控制之功率
因數校正電路做一介紹分析。 
傳統風力發電機之輸出經單相全波整流後電流電壓波型如圖 2-1 所示，具 
下列之缺點： 
 風力機組之輸出電流不為弦波使得輸出電流含有諧波失真成份 
 造成發電機組之機械振盪。 
 降低風力發電機之功率因數。 
 需較高之輸出峰值電流才可達到要求之輸出功率，導致產生之銅線損失
增加，降低發電機輸出效率。 
 輸出電容具較高之充放電電流，影響輸出電容壽命 
 
 
 
 
  27 
一具最大功率追踪功能之功因校正電源轉換器控制晶片。  
2.2.3  單週期控制之分析研究 
首先將舉一降壓式轉換器 Buck converter 做為例子解釋單週期控制之基本精
神及如何達到輸入電源擾動抑制之功能，如圖 2-3 所示。在這裡定義二極體 D 之
跨壓為開關之週變訊號。操作頻率 fs=1/TS ，跟據電感在穩態操作時之伏秒平衡
定理，電感上之跨壓在一個操作週期下平均為零可得公式(2-1)。 
0
1
0
 
 
ST
L
S
v dt
T
                          (2-1) 
由於電感之平均跨壓在一週期內為零，故可推得輸出電壓之平均值為二極體
跨壓為平均值，如公式(2-2)所示。 
 
 
圖 2- 2 風力機 AC-DC PFC 系統架構 
 
圖 2- 3 單週期控制之降壓式轉換 
  29 
為實現公式(2-7)，圖 2-4 所使用之積分器電路產生之積分訊號為負電壓值，
故在傳統單週期控制中需要正負電壓之供給才可達到功能。目前控制電路多以單
一正電壓供給的情況下，傳統之單週期控制需要雙電壓供應為缺點必需被加以改
進。 
圖 2-6 為一理想之功因校正電路之等效模型。理想功因校正電路之輸入電壓
與電流應為一線性之電阻性關係，如(2-10)式所示。 
g
g
e
v
i
R
            (2-10) 
gi 為整流後之平均電流，vg 為整流後之電壓，Re 則為輸入端之等效負載電
阻。輸入電壓 vg 與輸出電壓 VO 之關係可由下式定義一轉移函數加以連接。 
( )O
g
V
M d
v
          (2-11) 
 
 
圖 2- 4 定頻操作之單週期控制電路 
Reset
Integrator
with resetI O
Integrator
with resetI O
Integrator
with resetI O
clock
S
R Q
Qbar
3 2
v+(t)
p(t)v3 v2 v1(t)
Reset Reset
 
圖 2- 5 單週期控制電路示意圖 
 
  31 
m S T mv R i v d                         (2-17) 
比較(2-17)與(2-11)可以發現 
1
2
0
m S T
m
v v R i
v v
 




              (2-18) 
由(2-18)可知，由單週期控制為基礎達到功因校正之功能在理論上是可行
的。如圖 2-7 所示為達到公式(2-18)之控制電路方塊圖，使用單一正電壓供應達
到控制之功能。 
m m S Tv v d R i              (2-19) 
其相關波形圖如圖 2-8，Vint = (1 )mv d 、Vsen = S TR i 、Vgs 為單向 PFC 之主電
路控制開關訊號。 
S TR i
1
(1 )
2 m
v d
(1 )mv dmv
 
圖 2- 7 實現公式(2-18)之控制電路圖 
 
圖 2- 8 電流感測(Vsen)、積分器輸出(Vint)與單週期控制訊號(Vgs)之理想波形 
  33 
圖 2-12 為數位反向積分器架構方塊圖。圖中，方塊 Reg.代表一個有開關功
能的暫存器，能夠儲存 Derror 並封鎖住輸入訊號，直到 clock 訊號將 PFC 之責任
週期由低準位拉至高準位時，Reg.才存入下一個 Derror。三角形方塊 n 代表一個
乘積的數位小數值，方塊 subtraction 為 8 位元減法器，藉由 clock 訊號控制並重
覆遞減的動作，以達到類似類比負積分器的功能。方塊 Mux.則為多位元輸入之
二對一多工器，能接收兩個 8 位元的數位訊號，並藉由 reset 訊號的 0 與 1 來決
定輸出訊號等於何者。最後的方塊圖 Comp. 則為一個 8 位元的數位比較器，用
來比較電感電流數位值與負載電壓數位值並以輸出訊號的改變來決定功因校正
器之功率元件何時停止導通。 
數位反向積分器之運作原理為：當 Derror 存入暫存器(Reg.)以後，先乘上一個
數位小數值 n 並與其相減，即可得到 Derror*(1–n)，並將此直存入 register。數位
反向積分器持續重複此動作，直到其輸出值 Derror*(1–d(t)) 低於 Di*R 並使 Dpulse
由低準位轉成高準位，reset 訊號經過一個時間週期以後由低準位轉為高準位，
並使 Derror*(1–d(t))隨著 Derror 改變，此時的 PFC 控制訊號也由原本的高準位轉為
低準位。數位控制晶片將不斷的重覆此動作並調整責任週期，讓負載電壓值能夠
保持穩定。 
 
圖 2- 11 數位 PI 補償器架構 
 
圖 2- 12 數位反向積分器 
 
 
  35 
圖 2-15 為串聯式的除頻器。其中，方塊圖 Div_freq1 與 Div_freq2 內具有計
數器，藉由計數器的累計來達到除頻的效果由於是以串連的方式，所以時脈訊號
clk0、clk1 與 clk2 之頻率為比率關係。時脈訊號 clk0 具有最快頻率，用來提供
給類比轉數位轉換器之取樣頻率。時脈訊號 clk1 則是頻率較低，適合當作控制
數位 PI 補償器與反向積分器，最後時脈訊號 clk2 則是頻率最慢同時也是功因校
正轉換器的功率元件之時間週期。藉由圖 2-16 來說明時脈訊號關係，藍色線代
表除頻器之計數器，由圖可之 clk0 之頻率為最快，clk1 次之，最慢為 clk2。幅
度較大的藍色階梯坡由 clk0 計數而得，當計數值為 0 時，clk1 訊號變換。幅度
較小的藍色階梯坡則是以 clk1 來計數，並產生 clk2 訊號。 
 
 
圖 2- 15  串聯式除頻器 
 
 
圖 2- 16 時脈訊號關係圖 
 
圖 2- 17 時序訊號傳送示意圖 
 
  37 
2.2.6 量測結果與討論 
本計畫已實作一額定功率為 1 kW 之具最大功率追踪之 AC-DC 轉換器及控
制晶片設計。電路規格與參數如表 1 所示。圖 2-19 為操作在不同之輸出功率狀
況下之轉換器效率，最高效率可達 96.3%滿載效率為 92.8%。圖 2-20 為在不同輸
出功率下之風力發電機輸出電流波形。其功率因數皆可達到 0.99。總輸入電流諧
波失真可達到 7.2%以下，整理如圖 2-21 所示。 
本計畫成功的以 FPGA 為控制核心，研製一 1kW 應用於三相永磁式風力發
電機之 AC-DC 電能轉換器，達到高功率因數及低諧波失真之目標。所實做之電
路系統也可透過變流器將風力發電機所產生之電能饋回市電端與其他子計畫併
聯操作。本研究所得到之成果，在未來可應用至有結合風力發電機之再生能源發
電系統。 
表 2- 1 電路元件規格表 
Specifications Circuit Parameters 
Vin 25~70 V DB GBU4J 
Iin 5 Arms*3 L1 1 mH 
Vout 200 V L2 1 mH 
Iout 2 A*3 S 20N60C (infineon) 
fsw 39 kHz D1, D2 MUR460 
 
 
圖 2- 19 不同輸出功率下之轉換效率曲線 
 
0
5
10
15
20
0 200 400 600 800 1000 1200
TH
D
i %
 
圖 2- 20 在不同輸出功率下之線電流諧波失真 
  39 
2.3  分項三：具高效能適應控制型與功率管理能力之 DC-AC 
換流器控制晶片設計 
2.3.1 前言 
如前述，由於各種再生能源如太陽能、風力等，容易受到環境劇烈變動，並
不能提供一穩定的能源，通常需要將再生能源先整流為直流源後，經由蓄電池儲
存；因此發展直流轉交流之換流器 (DC/AC inverter) ，並與市電併聯
(Grid-connected)，提供負載能量之外，可將多餘能量回饋至市電，以有效利用再
生能源即顯得格外重要。 
基於上述石化能源日漸減少，且環保議題逐漸受到重視，使裝置容量超過
500MW 之大型集中式發電機組的增設日益困難，小型分散式發電機特別是利用
再生能源發電已成為電源開發的新途徑。因此使用處理 100~200W 小功率的微換
流器非常適合做為小型風力發電機、太陽能板的後端電源處理轉換器，也利於發
展『家庭式綠色能源』。 
傳統換流器為輸出電壓型，與市電併聯時需兼顧電壓大小、頻率與相位問
題，才可做到與市電併聯效果。但其需要鎖相迴路電路以供同步控制之用。因為
鎖相迴路電路控制會造成系統響應變慢，倘若換流器與市電之電壓大小、頻率與
相位不相同時，會造成循環電流，而燒毀系統裝置。 
分 項 三 將 使 用 一 個 併 聯 操 作 之 微 換 流 器 (Parallel operation of 
micro-inverters)，以輕易的達到大功率輸出並降低成本，並提出變頻切換控制降
低回授至市電之電流諧波因素(Current THD%)，使功率因素(Power factor)趨近為
1。在控制上不需要複雜的運算或微控制器(Micro-controller)，提出一全類比控制
積體電路以達到快速動態響應、降低穩態誤差並減少成本，進一步建立新式小訊
號模式與穩定度分析以最佳化控制器設計。分項三使用 0.18μm 1P6M 1.8V/3.3V 
mixed-signal 製程，輸出功率 100(W)，電流諧波小於 2.5%，轉換效率根據 CEC 
(California Energy Commission)對於再生能源系統的效率定義約為 96%。 
2.3.2 設計原理與分析 
A. 整體架構與系統方塊圖 
分項三提出一換流器架構結合市電併聯與獨立供電模式，如圖 3-1(a)所示，
當市電在正常運作時，將電流控制型換流器(Current controlled PWM inverter, 
CCPI)併聯操作，除提供負載能量外，並將多餘能量回授至市電。 
在偏遠市電無法到達的地區，可將其中一個換流器切換至電壓控制型換流器
(Voltage controlled PWM inverter, VCPI)如圖 3-1(b)所示，電壓控制型換流器可產
生市電輸出電壓波型，使其它的電流控制型換流器有正確的參考電壓，提供能量
  41 
 
1S
3S
2S
4S
1L
2L
oC
1S
3S
2S
4S
 
圖 3- 2 系統方塊圖 
1. 電流控制型換流器(Current-controlled PWM inverter, CCPI) 
電流控制型換流器使用一電感與市電進行串聯，藉由控制 PWM 之輸出電壓
進而控制輸出電感電流，由於並非為一回授系統，因此系統沒有穩定度上之問
題，但由於傳遞弦波電流時需考慮功率因素(Power factor)對整體系統傳遞實功之
影響，又功率因素受到電流全諧波失真(Total harmonic distortions, THD)與電流與
市電相位上差異(Phase displacement)的影響。因此，電流控制型換流器需要注意
輸出之電感電流與市電電壓同步之問題。圖 3-3 所示為一電流控制型換流器之功
率級電路，以下將以 Power MOS 之驅動電路之控制策略進行探討，如圖 3-4 所
示，在負半週期內: 
 
  TA+ off, TA- on; TB+ on, TB- off; VBN = -VAB = VDD  
TA+ off, TA- on; TB+ off, TB- on; VAN = -VAB = 0            (3-1) 
  43 
gridV
DDV
S
RQ
E
Subtractor
Buffer
Positive
Sensor
Negative
Sensor
Summing 
circuit
Comparator
E
E
E
E
Comparator
Buffer
E
S
RQ
E
Compensation
ramp
CLK
E
s1L
s2L
 
圖 3- 5 電流控制型換流器之電路 
 
 
圖 3- 6 電流控制型換流器之輸出波形 
將圖 3-6 之電感電流部分擷取出，並帶入 MATLAB 進行頻譜分析，可得以
下圖 3-7，並代入以下公式: 
I
IIII
THD hhhh


2
4
2
3
2
2
2
1%                 (3-3) 
關注 0~21 倍市電頻率(0~1.26kHz)時，電流之 THD%為 8.3%。以下公式分
別為電感之平均電流在連續導通模式(Continuous conduction mode, CCM)與不連
續導通模式(Discontinuous conduction mode, DCM)下推導之公式: 
  45 
0 0.314 0.628 0.942 1.256 1.57 1.884 2.198 2.512 2.826 3.14
0
0.3
0.6
0.9
1.2
1.5
Wt (Radius)
A
ve
ra
ge
 c
ur
re
nt
 (
A
)
 
圖 3- 8 電流控制型換流器之半週期輸出平均電流 MATLAB 分析圖 
 
圖 3- 9 電流控制型換流器之切換頻率與市電電壓關係圖 
0 0.314 0.628 0.942 1.256 1.57 1.884 2.198 2.512 2.826 3.14
0
0.3
0.6
0.9
1.2
1.5
Wt (Radius)
A
ve
ra
ge
 c
ur
re
nt
 (
A
)
 
圖 3- 10 電流控制型換流器之半週期輸出平均電流 MATLAB 分析圖 
  47 
 
圖 3- 11 使用電流模式控制之電壓控制型換流器架構圖 
 
 
圖 3- 12 使用電流模式控制之電壓控制型換流器小訊號模型方塊圖 
 
  49 
(2) 電壓模式控制(Voltage-mode control) 
圖 3-16 中之藍線為電壓分流器(Voltage divider)與補償器(Compensator)之小
訊號模型，分別就有無補償器分析小訊號之輸出阻抗: 
  
      LoadLLoadCLoadCLLoadC
LCLoad
o
o
RRRCRRRCRLsRRLCs
sLRsCRR
i
V


 2
1
ˆ
ˆ
  (3-8) 
使用上述之小訊號轉移函數代入 MATLAB 進行驗證結果如圖 3-17 所示，根
據圖 3-17 之轉移函數可以發現此時電壓控制換流器之輸出電壓會受到電流控制
換流器之輸出電流影響達到-20(dB)。有補償器時之輸出阻抗: 
  
        LoadCminLLoadC
LoadLC
o
o
RsCRFsAVRsLRRsC
RRsLsCR
i
V



111
1
ˆ
ˆ

   (3-9) 
使用上述之小訊號轉移函數代入 MATLAB 進行驗證結果如圖 3-18 所示，根
據圖 3-18 之轉移函數可以發現此時電壓控制換流器之輸出電壓受到電流控制換
流器之輸出電流抑制達到-85(dB)。比較電壓控制型換流器受電流模式控制與電
壓模式控制其輸出電壓抵抗負載電流的能力各為-35、-85(dB)，因此選擇電壓模
式控制之電壓控制型換流器能併聯更多的電流控制型換流器。 
 
 
圖 3- 15 使用電壓模式控制之電壓控制型換流器架構圖 
 
  51 
3. 電壓控制型換流器併聯電流控制型換流器之小訊號模型推導 
上述為電壓控制型換流器單獨運作時小訊號推導，但實際電路在操作上又併
聯許多電流控制型換流器，因此將其納入整體小訊號模型之考量將使得整體模擬
較為準確。 
  
apV dˆ
D
ciˆ
c
ˆI d
m1F
1dˆ
C
CR
R
 T s
L2Iˆ
oVˆ
apV dˆ
D
ciˆ
c
ˆI d
m 2F
2dˆ
'
rK
 eH s iR
K
2L L2R1L L1R
 
圖 3- 19 併聯電壓控制型換流器與電流控制型換流器之小訊號模型方塊圖 
 
其整體之控制至輸出(Control-to-output)小訊號轉移函數之公式為: 
 
   
   
 
  
 
 
    
  zniLoadCniLoadiLLoadC
zniLLoadC
niL1LoadCrinm
niLoadC1LoadC1nL1C11
niLoadC111
iL
zniiC11C1L
C11nizniC11
niC11
Loadin1
1
o
QωRLRRCωRR)R(R)LR(RC
QωRL)RR(RCL
ωRRRRCL)K(V-FG
ωRRRC)LR(RC)ωRi()RR(RCLF
ωRRRCLE
RRD
QωRRRCRRCLC
RCLωRQωRRCB
ωRRCA
IHsGsFsEs
DCsBsAsRV
d
V












211
2
2111
21111
2
11122
2
111
2
Load1
2
2
212
2
2
2
234
23
11
ˆ
ˆ
 
    
    
  
  )R(R iL2Load 



RR)R)K(1V1-F)R(RRI
)R(RRRCQωRLR
)R(R)RR(RCLQωRLR
RL)K(1V1-FRCR)K(1V1-FH
LoadL1rin2m2iL2L1
iL2LoadC11zni2Load
iL2L1LoadC111zni2L1
Load1rin2m2C11L1rin2m2
 
 
  53 
B. 直流/交流換流器控制晶片電路設計 
1. 電壓感測器 
此控制晶片所使用的電壓感測器電路架構如圖 3-22 所示，此電路能將電網
兩端的差動訊號 V+和 V-轉為整流過的單端訊號，而市電相位訊號則是透過比較器
產生兩控制訊號 POS 和 NEG 傳到電壓感測器的控制開關，使得電壓感測器可以
做雙向電壓感測(bidirectional voltage sensing)。對於輸入差動訊號 V+和 V-會有負
值的問題則是透過電壓位準移位器(level shifter)將負電壓往上移一個準位，使得
M1 和 M3 這兩顆 PMOS 的源級對閘級電壓(VSG1 和 VSG3)不會超過場效電晶體的
源級對閘級崩潰電壓，透過 M1, M2, MB1 和 M3, M4, MB2產生一閉迴路迴授控制
提高電壓位準移位器的線性度[31]，流過電阻 RD 的電流為(V+-V-)/RD，流過 M2
和 M4 的電流分別為 IBias+IRD 和 IBias-IRD，透過電流鏡最終在 RL上的跨壓為 
   VVR
R
M2V
D
L
O                       (3-10) 
2. 可校準倍率電流感測器 
此控制晶片所使用的電流感測器電路架構如圖 3-23 所示，低壓測輸出級功
率電晶體在全導通週期時在 RDS 有一跨壓 V1 = I RDS，而 V1 可作為電流感測的電
壓資訊，但對於不同的輸出級功率電晶體 RDS 皆不一定一樣，所以需要可調放大
倍率電流感測器來修正 RDS 不同所造成的誤差，V1 透過一電壓-電流轉換器產生
一電流 VI/RD，利用電流鏡將此電流放大 M 倍，輸出電阻 RL為 RD 的 N 倍，所以
可以得到輸出電壓 Vo 為 
D
L
DSO NR
MR
IRV                           (3-11) 
 
圖3- 22 電壓感測器 
 
  55 
 
1OP
 
圖 3- 25 傳統的加法電路 
 
1M
1OP 2OP
2M 3M4M
5M 6M
D
D
DDV
GND
 
圖 3- 26 改良後的 wide-swing 加法電路 
忽略運算放大器非裡想的效應，其轉移函數可表示為 
21
43
3
1221
RR
RR
R
RVRV
V ININO 


                 (3-12)
 
其加法電路的輸出是由輸入訊號及電阻的比例所決定。在直流對直流
(DC/DC)轉換器的應用中，控制器裡迴授及控制訊號的變化會受到輸入電壓及輸
出電流所影響。而直流對直流轉換器必須避免輸出電壓透過迴授機器而產生的變
化。由於轉換器的輸入電壓或輸出電流有小變動，此電路適合用簡單且容易的方
式實現。然而在微換流器(micro-inverter)中，輸出電壓及電流是以正弦波的形式
週期性的變動。此加法電路並不適合用在這個應用上，因為 AB 類運算放大器的
輸出級並非 rail-to-rail，當輸出電壓過低時，有些電晶體將會操作在線性區。
Wide-swing 的加法電路如圖 3-26。 
由電晶體 M1、M5，電阻 R1 及運算放大器 OP1 組成電壓-電流轉換器(V-I 
converter)，而由 M3, M6, R2 及 OP2 組成另一個電壓-電流轉換器。其電流透過電
流鏡 M2 及 M4 流經電阻 R3 而產生輸出電壓，而改良過的加法電路，其轉移方程
式為 
3
2
2IN
1
1IN
O RR
NV
R
MV
V 






                    (3-13)
 
當換流器操作在接近零交越點(zero crossing point)時，其脈衝寬度調變(PWM)
的切換頻率會升高而寬度會減小。但由於運算放大器會有頻寬的限制，會造成
PWM 訊號產生邏輯的錯誤。在 PWM 訊號中，加入動態的關閉開關以矯正錯誤，
  57 
由於上述之轉移函數太過於複雜而不利於設計者進行分析，我們必須將此轉
移函數之極點分開以利於設計者能確切知道極點之位置，得到以下之轉移函數: 
 
 
   
         pin
o
AsRCCsRsCRCCsA
RsCRRsC
A
sV
sV
0221331210
22313
0 1||111
11


      (3-14) 
以 MATLAB 進行驗證如圖 3-23 所示，紅色為完整轉移函數之波德圖、藍色
為經過簡化後之轉移函數之波德圖，可以發現，在頻寬裡差異不大。由圖 3-31
中顯示之模擬結果，即使併聯許多電流控制型換流器仍不影響電壓控制型換流器
之弦波輸出電壓。 
1OTA
GND
mG
 
圖 3- 28 補償器之架構圖 
 
表3- 2 補償器參數 
R1 R2 R3 C1 C2 C3 
903.719(kΩ) 28.504(MΩ) 10(kΩ) 0.1016(pF) 2.219(pF) 70(pF) 
 
10
0
10
1
10
2
10
3
10
4
10
5
10
6
30
40
50
60
70
80
Frequency (Hz)
G
ai
n 
(d
B
)
Compensator
 
 
10
0
10
1
10
2
10
3
10
4
10
5
10
6
-100
-50
0
50
100
Frequency (Hz)
P
ha
se
 (d
eg
re
es
)
 
 
Integral derivation
Simplfied derivation
 
圖 3- 29 補償器之小訊號轉移函數 
  59 
 
C
in
,p
V
C
in
,n
VV
in
,p
V V
in
,n
V
D
D
A
V
A
G
N
D
L
S
D
1
V
L
SD
2
V
H
S
D
1
V
H
SD
2
V
D
D
D
V
D
G
N
D
REFV 
ERRV
REFV 
CSENV
TUNEV
MV
VSENV
DHV
GCVREFV
rampV
CLK
SUMV
EN
BIASV
REFE
 0.97 mm


1
m
m
 
圖 3- 32 換流器控制器之布局 
圖 3-33, 3-34 為布局後模擬結果。接再一個 110 (Vrms) 市電與 300 (Ω) 電
阻式負載。圖 3-36 為併聯三個電流控制型市電併聯換流器之波形圖，而在其三
個輸入之 Vdc 皆為不同值時，電感電流 iGrid的 Current THD%皆小於 2.5%。如圖
3-1 獨立供電模式架構圖所示，電壓控制型換流器需要在許多電流控制型換流器
併聯操作下，其補償器(Compensator)需不受負載電流干擾，將兩端電位差控制在
一假想的弦波電壓下；因此各自分析電流模式控制(Current-mode control)與電壓
模式控制(Voltage-mode control)兩者的 Output impedance；電流模式控制使用補償
器在低頻時為-32(dB)，而電壓模式控制使用補償器在低頻時接近-90(dB)，顯示
電壓模式控制較能承受負載電流之劇烈變動，因此在電壓控制型換流器上使用電
壓模式控制。圖 3-39 為獨立供電時之波形圖，電壓控制型換流器啟動並產生一
模擬市電電壓波型，使其他兩組電流控制換流器正確操作，提供負載能量。 
  61 
Grid Voltage
Inductor Current 
1
Inductor Current 
2
Inductor Current 
3
Summed Current
 
圖 3- 35 三個市電併聯模式換流器模擬結果 
 
 
圖 3- 36 三個獨立供電模式換流器模擬結果 
 
 
  63 
表 3- 3 與現有文獻比較表 
Reference [31] [32] [33] [34] [35] [36] [37] [38] This 
Work 
Stage 3 2 3 2 3 3 2 1 1 
Nominal Power 
(W) 
300 100 150 160 100 100 300 250 100 
Grid Voltage (V) 220 100 220 230 240 240 100 240 110 
Power Factor 0.9988 0.9987 0.9987 0.9987 N/A N/A N/A 0.999 0.9996 
THD (%) 4.89 5 5 5 N/A N/A N/A 4.5 2.5 
Transformer Yes Yes Yes Yes Yes Yes Yes No No 
Efficiency (%) 80 70 85.4 82 91 92 89 96 96.5 
Switching 
Frequency (kHz) 
20 50 200 40 250, 
500 
75,150 9.6 25 Variable 
Controller 
Integration 
No No No No No No No No Yes 
FOM 0.0833 0.0714 0.0383 0.0404 N/A N/A N/A 0.0488 0.0235 
 
 
  65 
於智慧電網架構中，傳統集中式的發電系統轉為具分散式的多能源供電方
式，於中、低壓的微電網中可能包含數種不同額定與形式之分散式能源、儲能設
備及負載，因此如何控制與協調各裝置之動態行為而使系統穩定，為電能管理最
主要目的之一，而控制方法主要應考量[39]： 
 最佳分散式能源利用率 
 負載供電可靠度 
 避免控制過於複雜 
對於太陽能與風力發電市電併聯系統而言，由於太陽能與風力發電系統受到
環境因素的影響，因此所能提供之電能非固定不變，故本系統中藉開關切換設
計，實現不同環境下的模式切換。控制架構圖如圖 4-2 所示，其中包含中央控制
器(Central Controller, CC)與區域控制器(local Controller, LC)。LC 之控制對象可為
太陽能發電、風力發電、儲能設備或負載，由於實際微電網 CC 與 LC 可能相距
甚遠，且 LC 數量亦可能很多，故 CC 與 LC 之控制權限協調應避免過於繁複。
本計畫中 CC 僅決定較高層級的命令，即系統中各裝置之運轉模式，而需較快響
應速度之項目則由 LC 自行控制，如電壓與頻率穩定、最大功率追蹤、風速過低
或過高保護、定電壓(流)充電控制等。 
本系統功率控制判斷流程如圖 4-3 所示，表 4-1 所示為系統運轉模式總覽
表，其中共含六個模式： 
 模式 1：再生能源同時供應負載、對電池充電及饋入市電 
 模式 2：再生能源、電池及市電同時供應負載 
 模式 3：電池已充飽，再生能源同時供應負載並饋入市電 
 模式 4：表示電池殘電量過低，再生能源與市電同時供應負載 
 模式 5：表示無載，再生能源同時對電池充電及饋入市電 
 模式 6：表示無載，且電池已充飽，再生能源電能饋入市電 
 
中央控制系統
(Central Controller, CC)
區域控制器
(Local Controller, LC1) 區域控制器
(Local Controller, LC2) 區域控制器
(Local Controller, LC3)
 
圖 4- 2 系統控制架構[39] 
  67 
4-7(a)、(b)所示。由於電感滿足式(4-1)，由式(4-2)可知流經電感上之電流 iL為週
期性時，電感平均電壓 VL為零。 
dttv
L
titTi
tT
t L


0
0
)(
1
)()( 0L0L                    (4-1) 
由圖 4-7 可推得電感平均電壓 VL如式(4-2)所示，因此電感電流 iL為週期性
時，電感平均電壓 VL為零亦稱為伏特-秒平衡。 
 
]VT)1(VT[
T
1
offonL  DDV                    (4-2) 
1. 降壓模式 
降壓模式時 Q1 導通及截止之等效電路分別如圖 4-9(a)、(b)所示，由圖 4-9(a)
可知當 Q1 導通時 VL＝VI-Vo，由圖 4-9(b)可知當 Q1 截止時 VL＝VI，由式(4-2)可
推得 VI與 Vo關係式如式(4-3)。 
 
I1I1L VT)1()VV(T0  DDV o  
o1I VV  D                                     (4-3) 
L
_
oV

LC LR
_
IV

1Q
sTD1
2Q sTD2
sT
sT
1Q
D
2Q
D
 
圖 4- 4 雙向 DC-DC 轉換器電路圖[43] 
+
Vo
-
L
C
DQ1
+
VI
-
Q2
 
圖 4- 5 雙向 DC-DC 轉換器操作於降壓模式之等效電路圖[44] 
 
  69 
)V(T)1(VT0 I2I2L oVDDV   
I
2
o V1
1
V 


D
                                 (4-4) 
逆向升壓模式時效率高，由於流過功率開關元件之電流小，故導通損失較
小。輸入端具有平滑與連續電流特性，降低雜訊與電磁干擾影響。 
B. 全橋式變流器 
為使後級全橋式變流器操作於市電併聯模式，並有效將電池能量以單位功因
與低諧波因數饋入市電系統，本文開關切換方式主要利用前述單極性正弦脈波寬
度調變(Unipolar SPWM)與功因校正控制技術。市電併聯型變流器控制策略上，
如圖 4-9 所示一般可分為電壓控制型與電流控制型。 
圖 4-9(a)電壓控制型電路主要藉由回授變流器輸出電壓與偵測市電相位然後
使用鎖相位(Phase-locked loop, PLL)演算法[45]、[46]進行市電併聯。但因電壓控
制型控制程序與計算輸出電流較電流控制型複雜，所以本系統後級市電併聯變流
器採用電流控制模式，如圖 4-9(b)所示。電流控制型電路是將變流器輸出視為電
流源，市電端則視為電壓源進行併聯的動作。電流控制型變流器控制流程為回授
輸出電感(Lf)上的電流與參考信號做比例積分控制，使輸出電流追隨參考信號，
達成輸出單位功因的交流弦波。 
從上述控制流程得知，電流控制型較電壓控制型具即時控制瞬間電流，故有
較高的動態響應，並精確地將輸出電流控制在單位功因與有效降低其諧波因數等
優點。如圖 4-10 市電併聯型變流器電路，輸入側電源為前級轉換器輸出直流鏈
電壓(Vdc)，硬體電路主要由四顆開關所構成(S1~S4)，輸出串聯電感後併入市電。 
 
 
(a)                               (b) 
圖 4- 9 併聯型變流器市電併聯控制法等效電路圖(a)電壓控制型(b)電流控制型 
  71 
 
 
圖4- 11 電流控制型市電併聯變流器控制流程方塊圖[47] 
與此控制流程中，利用即時偵測變流器輸出市電之電流(igrid)與具式電相位之
輸出電流參考信號(io*)進行比較，誤差值為 ierror，以此誤差值修正輸出電流相位
與振幅，以達到變流器輸出為單位功因。本系統變流器透過前述電流控制器控
制，可將直流鏈電壓轉換成交流電與市電併聯，使具有高功率因數與低諧波失真
之優點。併聯市電前須注意變流器輸出交流電壓與市電系統電壓相同頻率與相
位，並進行功因修正控制以確保輸出單位功因交流電流饋入市電網路。由於系統
與市電併聯，所以變流器輸出電壓已被市電電壓鎖住於 110VAC，接下來主要透
過功因修正控制變流器輸出電流追隨市電相位，輸出交流電流與電壓同相後即可
出實功給市電系統。 
C. 控制方法 
圖 4-12 與圖 4-13 分別為雙向充放電系統之充電控制與放電控制示意圖，於
放電時雙向充放電路採穩壓控制，將 DC bus 穩定控制於 200V，變流器採定電流
控制，以令輸出電流追蹤控制器設定之電流命令並將電能饋入市電端；充電模式
時，將變流器作為整流以將交流電能轉換為直流，同時將 DC bus 穩定控制於
200V，而雙向充放電路以定電流控制對電池充電。 
Battery 
Bi-direction
Charge/Discharge
Inverter
2kW26Ah x4
Ibat
+
-
Vbat
穩壓控制 電流控制
+
-
200V 110V, 60Hz (AC)
 
圖 4- 12 雙向升降壓轉換器在放電模式下之控制示意圖 
  73 
 
圖 4- 15 APP020 PLUS dsPIC 30F4011 實驗板[49] 
因為系統所需量測直流電壓均於 300V 以下屬低壓量測範圍，故本系統採用
電阻分壓方式，取得即時電池輸出電壓；市電電壓則使用變壓器隔離方式取樣至
數位訊號處理器，經運算後完成前級直流/直流轉換器及後級直流/交流轉換器輸
出等相關參數。 
3. 市電電壓回授電路 
系統需偵測市電電壓，以確保換流器輸出電流與市電電壓同相，因此需精確
偵測市電電壓相位。因數位訊號處理器內部類比/數位轉換器所能接收訊號為 0V
到 5V 之間電壓訊號。因此，市電電壓回授電路分為變壓器隔離降壓、準位提升
及二階低通濾波三級電路。 
如圖 4-16 所示，市電電壓的第一級電路為變壓器隔離降壓電路，利用變壓
器將市電電壓降壓至數位訊號處理器之工作電壓。第二級電路為準位提升電路，
將交流訊號之準位提升至 2.5V 以利數位訊號處理器處理。第三級電路為二階低
通濾波電路以消除高頻雜訊。最後於二階低通濾波電路輸出再加上二極體(D1, D2)
做電壓保護，避免過大電壓進入數位訊號處理器。 
4. 直流電壓回授電路 
圖 4-17 所示為直流電壓回授電路，主要用於回授電池輸出電壓與 DC-DC 轉
換器輸出電壓。擷取電池輸出電壓係為執行最大功率追蹤，回授 DC-DC 轉換器
輸出電壓是為了要判斷電壓是否到達工作電壓，市電併聯是否可以啟動。 
  75 
系統利用霍爾元件取得換流器輸出電流，進行回授訊號與參考訊號比較，產
生的誤差量來控制輸出電流。電路利用 HY-10P 霍爾元件，與太陽能輸出電流回
授電路一樣規格。換流器輸出電流交流電流回授電路可分為二級電路。如圖 4-19
所示，交流電流經由霍爾元件將電流轉換為電壓型式，第一級電路為準位提升電
路，將交流訊號之準位提升至 2.5V 以利數位訊號處理器應用。第三級電路為二
階低通濾波電路以消除高頻雜訊。最後再加上二極體(D1, D2)做過電壓保護，避
免過大電壓進入數位訊號處理器。 
8. 功率電晶體驅動電路 
圖 4-20 為功率電晶體驅動電路，主要功能乃將數位信號處理器輸出之脈波
寬度調變信號，經由光耦合器(TLP-250)作放大及隔離之效能，防止前級電路遭
到後級故障而損壞。 
TLP-250 具有快速響應、電氣隔離與高抗雜訊的功能。當在高電壓、大電流
時，藉由 TLP-250 將控制電路與開關電路作電氣隔離，避免切換開關在高頻切
換時，產生的雜訊干擾了控制電路中的控制信號，大幅提高系統的穩定性。本文
所提系統共有 10 組驅動電路獨立驅動 10 顆功率開關，為使系統穩定動作，故其
各別之驅動電路穩定性及可靠度相當重要。 
 
 
圖 4- 18 直流電流回授電路 
 
 
圖 4- 19 交流電流回授電路 
  77 
   
圖 4- 22 雙向充放電路(a)升壓模式定電壓波形 (b)降壓模式定電流充電波形 
 
 
圖 4- 23 系統與市電併聯操作於 600W 實驗波型圖(CH1：vac、CH2：Igrid、CH3：
Vdc、CH4：vgrid) 
2.4.4 孤島偵測 
A. 主動式孤島偵測方法 
本計畫以 FPGA 實現主動式孤島偵測方法，其控制流程如圖 4-24 所示。量
測交流電壓並經 A2D Converter 轉為數位訊號以供控制器讀取，並計算市電電壓
之有效值(Vac)後與參考電壓(Vref)相減，得到之誤差量經過 PI 控制器放大後得電
路擾動量(Δd)加入變流器輸出電流之控制命令。當系統與市電網路正常併聯時，
擾動電流控制命令不會對市電電壓造成影響，而當孤島現象發生時，擾動電流控
制命令將改變交流端電壓，藉此正回授控制架構促進系統電壓不穩定，進而達到
主動式孤島偵測之目的。 
  79 
根據方均根公式 
n
x
V
n
i  1
2
rmsac,                         (4-9) 
兩邊各取平方乘以 n 後得 
 
n
i xVn 1
22
rmsac,                        (4-10) 
本系統取樣頻率設為 625kHz，在一個市電週期(60Hz)約可以取 10417 個點。
因此將回授之市電數位訊號平方累加 10417 次即為平方和，根據表 4-3 經由查表
法可找到對應的方均根植。 
表 4- 3 市電電壓有效值平方和對應表 
Vac,rms 數位值平方和 Vac,rms 數位值平方和 
100 254321289 111 313349260 
101 259433147 112 319020625 
102 264595869 113 324742854 
103 269809456 114 330515947 
104 275073906 115 336339905 
105 280389221 116 342214727 
106 285755400 117 348140413 
107 291172444 118 354116963 
108 296640352 119 360144377 
109 302159124 120 366222656 
110 307728760   
D. 模擬測試結果 
為測試所提孤島偵測方法可行性，將正弦波電壓加入電力品質擾動訊號以測
試其穩定性，圖 4-26 至圖 4-28 所示分別為當市電電壓閃爍 3.6%、電壓驟升與含
9%諧波失真時之模擬結果，由結果可得所提演算法皆未發生誤判，且與市電解
聯後約 50 ms 即可偵測出孤島運轉現象。 
3 
50 ms
Grid-connected Islandingvac
Vrms
孤島信號
 
圖 4- 26 市電電壓電壓閃爍 3.6%之孤島偵測結果 
  81 
4 參、參考文獻 
[1] 國家政策研究基金會，http://www.npf.org.tw/ 
[2] Trishan Esram, Patrick L. Chapman, “Comparison of Photovoltaic Array 
Maximum Power Point Tracking Techniques,” IEEE Trans. Energy Convers., 
vol. 22, No. 2, June 2007 
[3] N. Femia, Giovanni Petrone, Giovanni Spagnuolo, and Massimo Vitelli, 
“Optimization of Perturb and Observe Maximum Power Point Tracking 
Method,” IEEE Trans. Power Electron., vol. 20, no. 4, pp. 963-973, July 2005. 
[4] D. Sera, R. Teodorescu, J. Hantschel, and M. Knoll, “Optimized maximum 
power point tracker for fast-changing environmental conditions,” IEEE Trans. 
Ind. Electron., vol. 55, no. 7, pp. 2629-2637, July 2008. 
[5] E. Koutroulis, K. Kalaitzakis, and N. C. Voulgaris, “Development of a 
microcontroller-based, photovoltaic maximum power point tracking control 
system,” IEEE Trans. Power Electron., vol. 16, no. 1, pp. 46-54, Jan. 2001. 
[6] W. Xiao, W. G. Dunford, P. R. Palmer, and A. Capel, “Application of centered 
differentiation and steepest descent to maximum power point tracking,” IEEE 
Trans. Ind. Electron., vol. 54, no. 5, pp. 2539-2549, Oct. 2007. 
[7] Y.-C. Kuo, T.-J. Liang, and J.-F. Chen, “Novel Maximum- Power- Point 
Tracking Controller for Photovoltaic Energy Conversion System,” IEEE Trans. 
Ind. Electron., vol. 48, no. 3, pp. 594-601, June 2001. 
[8] F. Liu, S. Duan, F. Liu, B. Liu, and Y. Kang, “A Variable Step Size INC MPPT 
method for PV systems,” IEEE Trans. Ind. Electron., vol. 55, no. 7, pp. 
2622-2628, July 2008. 
[9] A. Brambilla, M. Gambarara, A. Garutti, and F. Ronchi, “New approach to 
photovoltaic arrays maximum power point tracking,” in IEEE Power Electron. 
Spec. Conf., 1999, pp. 632-637 
[10] N. Femia, Giovanni Petrone, Giovanni Spagnuolo, and Massimo Vitelli, 
“Optimization of Perturb and Observe Maximum Power Point Tracking 
Method,” IEEE Trans. Power Electron., vol. 20, no. 4, pp. 963-973, July 2005. 
[11] N. S. D'Souza, Luiz A. C. Lopes, Xuejun Liu, “Peak Current Control Based 
Maximum Power Point Trackers for Faster Transient Responses,” in IEEE 
Electr. and Comput. Eng., 2006, pp. 659-663. 
[12] K. H. Hussein, I. Muta, T. Hoshino, and M. Osakada,” Maximum photovoltaic 
power tracking: An algorithm for rapidly changing atmospheric conditions,” 
IET Proc. Inst. Elect. Eng., pp. 59-64., Jan. 1995 
  83 
[28] B. Arbetter and D. Maksimovic, “Feed-forward pulse-width modulators for 
switching power converters” Power Electronics Specialists Conference, pp. 
601-607, June 1995 
[29] G. Spiazzi, F. C. Lee, “Implementaion of Single-Phase Boost 
Power-Factor-Correction Circuits in Three-Phase Applications” Transactions on 
Industrial Electronics, Vol. 44, No. 3, pp.365-371 
[30] J. F. Chen, and C. L. Chu, “Combination voltage-controlled and current- 
controlled PWM inverters for UPS parallel operation,” IEEE Trans. Power 
Electron., vol. 10, no. 5, pp.547-558, Sept. 1995. 
[31] N. P. Papanikolaou, E. C. Tatakis, A. Ciritsis and D. Klimis, "Simplified high 
frequency converters in decentralized grid-connected PV systems: A novel 
low-cost solution,” in Eur. Conf. Power Electron. Appl., 2003.  
[32] T. Shimizu, K. Wada, and N. Nakamura, “A flyback-type single phase utility 
interactive inverter with low-frequency ripple current reduction on the DC input 
for an AC photovoltaic module system,” IEEE Power Electron. Spec. Conf., vol. 
3, 2002, pp. 1483–1488. 
[33] S. B. Kjaer and F. Blaabjerg, “Design optimization of a single phase inverter for 
photovoltaic applications,” IEEE Power Electron. Spec. Conf., vol. 3, 2003, pp. 
1183–1190. 
[34] M. Nagao and K. Harada, “Power flow of photovoltaic system using buck-boost 
PWM power inverter,” Conf. Power Electron. and Drive Systems, vol. 1, 1997, 
pp. 144–149. 
[35] S. Mekhilef, N. A. Rahim, and A. M. Omar, “A new solar energy conversion 
scheme implemented using grid-tied single phase inverter,” IEEE Trends and 
Develop. in Converging Technol., vol. 3, 2000, pp. 524–527. 
[36] D. C. Martins and R. Demonti, “Grid connected PV system using two energy 
processing stages,” IEEE Photovoltaci Spec. Conf., 2002, pp. 1649–1652. 
[37] M. Meinhardt, T. O’Donnell, H. Schneider, J. Flannery, C. O. Mathuna, P. 
Zacharias, and T. Krieger, “Miniaturised ‘low profile’ module integrated 
converter for photovoltaic applications with integrated magnetic components,” 
IEEE Applied Power Electron. Conf. and Expo., vol. 1, 1999, pp. 305–311. 
[38] (2001, Oct.) Soladin 120. Mastervolt. [Online]. Available: 
www.mastervolt.com/sunmaster  
[39] Z. Zhang, X. Huang, J. Jiang, and B. Wu, “A load-sharing control scheme for a 
microgrid with a fixed frequency inverter,” Electric Power Systems Research vol. 
80, pp. 311-317, 2010 
[40] E. Barklund, N. Pogaku, M. Prodanovic´, C. Hernandez-Aramburo, and T. C. 
Green, “Energy Management in Autonomous Microgrid Using 
Stability-Constrained Droop Control of Inverters,” IEEE Trans. on POWER 
ELECTRONICS, vol. 23, no. 5, 2008. 
[41] Yun Wei Li and Ching-Nan Kao, “An Accurate Power Control Strategy for 
Power-Electronics-Interfaced Distributed Generation Units Operating in a 
國科會補助計畫衍生研發成果推廣資料表
日期:2012/01/11
國科會補助計畫
計畫名稱: 具最大功率追蹤與控制之併聯型混合太陽能與風力發電電源轉換器晶片設計
與系統研製(3/3)
計畫主持人: 楊宏澤
計畫編號: 99-2220-E-006-006- 學門領域: 晶片科技計畫--目標導向型研究
計畫 
研發成果名稱
(中文) 換流器之類比式控制方法
(英文) Analog Control Method of Inverters
成果歸屬機構
國立成功大學 發明人
(創作人)
楊宏澤,郭泰豪,郭永超
技術說明
(中文) 本發明提出一種能夠應用於再生能源換流器之類比式控制器，這個控制器適合採
用類比積體電路設計技術，接收再生能源與市電之輸出電壓與電流資訊，並根據
此資訊來適應性地調整導通時間，以提高再生能源的輸出功率效益。因為使用類
比積體電路來實現此最大功率追蹤控制裝置，相較於先前技術，本方法之電路實
現成本較低且容易使用並整合至再生能源換流器中。 
 
本發明的目的之一，是在不同環境因素條件之下，為了讓再生能源的輸出功率可
以最大化，利用本發明所提出換流器之控制器，適應性調整導通時間，可獲得換
流器與發電裝置之輸出電壓與電流特性曲線的最佳化關係，透過此運作機制可得
到輸出最大功率之效果。
(英文) In this invention, an analog inverter controller circuit is proposed which can applied to 
many kinds of renewable energy sources. The controller is suitable for employing the 
analog IC technology.The controller can adaptively adjusts the duty ratio according to the 
grid voltage and current signal and thus, enhances the output efficiency. Compared to 
existing inverters, the high power output efficiency of renewable energy sources can be 
achieved with low process complex, low cost, reduced size by employing the analog 
inverter controller circuit. 
 
One of the targets of this invention is to reach maximum output power under different 
enviromental conditions. Taking the advantage of the adaptively adjusting duty cycle, the 
inverter can reach an optimized relationship between output voltage and output current. 
And the maximum output power is gauranteed.
產業別 其他專業、科學及技術服務業
技術/產品應用範圍 風能轉換器、太陽能轉換器
技術移轉可行性及
預期效益
本技術屬於系統層面的解決方式，可有效且廣泛的針對再生能源輸出效率問題加以改善，
並由於本技術可藉由類比積體電 
路來施行，在輸出響應特性上有相當之優勢。因此，廠商若技轉此一技術，可大幅提高
產品層次及節省成本，在商業應用上將更有競爭力。
註：本項研發成果若尚未申請專利，請勿揭露可申請專利之主要內容。
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
1.旺宏金矽獎設計組評審團銅獎：以類比積體電路實現太陽能最大發電功率追
蹤器 
2.旺宏金矽獎設計組指導教授獎：以類比積體電路實現太陽能最大發電功率追
蹤器 
3.旺宏金矽獎設計組優勝獎：能量採集積體電路系統之自動合成設計 
4.立錡盃電源 IC 設計暨系統應用競賽佳作獎：智慧型電網與太陽能充電 IC 之
自動合成設計 
5.立錡盃電源 IC 設計暨系統應用競賽佳作獎：太陽能與風能最大效率之充電器
設計 
 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
