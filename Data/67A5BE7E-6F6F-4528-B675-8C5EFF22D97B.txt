此外，由於 C-arm 的成像特性，其影像
會隨拍攝位置的變化而有不同的扭曲變形，
本研究採用全域性法中的三次多項式 Cubic
Camera Model[1]來校正 C-arm 影像變形。
三、研究方法
本研究設計了一影像校正器裝設於
C-arm X-光機之接收端上，校正器上附有已
知排列方式的鋼珠作為識別標記，如圖 2。
圖 2－影像校正器夾附於 C-arm 接收端
首先將 C-arm 影像擷取至電腦中顯示，
並利用標記影像來校正變形的影像，同時求
取 X-ray 有效發射源，以建立 X-ray 的投影模
式；此一投影模式應用在兩張不同照射角度
的 C-arm 影像上，即可在兩張影像上分別規
劃手術器械的目標方位；之後，將定位裝置
測得之手術器械方位轉換至 C-arm 影像上，
便能由調整縮小影像上所即時顯示器械與目
標的相對方位誤差，將手術器械正確地導引
至預先規劃的目標方位上，達成以影像輔助
導引手術定位之目的；上述導引定位的過程
中，包含下述六個主要步驟：
(一) 座標系統定義與轉換關係
首先定義各座標系如表 1 所示，表中
DRF 為光學式定位裝置的「動態參考框架」
各座標系的實際位置與相對關係如圖 3 所
示。
表 1 座標系列表
名稱 說 明
FH 手術器械上的 DRF 座標系
FD 手術刀具(例如：鑽頭)座標系
FS 光學式定位裝置座標系
FP 固定於病患身上的 DRF 座標系
FC 校正器上的 DRF 座標系
FO C-arm 上的校正器座標系
FI 相對於 FP 之 C-arm 影像座標系
圖 3－座標系的實際位置
為了能在電腦螢幕中的 C-arm 影像上顯
示出手術器械的方位，須將手術器械座標系
轉換至影像座標系，其轉換關係如下：
TTTTTTT IO
O
C
C
P
P
S
S
H
H
D
I
D  (1)
座標系 FH、FP、FC 與座標系 FS 間的轉
換關係 P
ST 、 CPT 、 IOT 可由光學式定位裝置量
測得出；待求的轉換關係有三： THD , TOC 及
TIO ，各項的求解方法敘述於下。
(二) 刀具方位對正
本研究設計一座標對正器以求取固定於
手術器械上之 DRF 座標系與鑽頭端點位置
及方位間的轉換關係 THD ，如圖 4 所示；對正
器上設置一 DRF，並有各種尺寸之滑槽與一
歸零點。
圖 4－座標對正器
其操作原理說明如下：由光學定位系統量測
得出轉換矩陣 THS 與 T
R
S ；座標對正器座標系
三個被動式反光
標記構成之 DRF
各種尺寸滑槽
歸零點
接收端
光學式定位
裝置感測器
刀具
(鑽頭)
發射端
器械
未扭曲影像
校正器
C-arm
接收端
DRF
第一層
第二層
鋼珠
置，並轉換至座標系 FO；扭曲的影像座標
(xD,yD)可由原始影像分割出的鋼珠成像位置
得出，兩者代入(4)式，以最小平方法或其他
最佳化方法求解求解 a0 ~ a9 與 b0 ~ b9等 20
個未知數，得出影像扭曲校正方程式。
(六) 有效射源求解
理想的 C-arm 成像(扭曲變形已校正)幾
何如圖 8 所示：
X-Ray 由射源 F 射出，穿過空間中的一
點 Pi 並於成像面的 PUIi上成像；其中 Pi 為量
測校正器第二層上的第 i 個鋼珠位置，並經
由座標轉換得出相對於光學定位裝置座標系
FS 的座標。PUIi 的位置可由 Pi 的成像位置並
代入扭曲影像校正方程式中求得。又 Pi與 PUI
的連線可視為 X-光的一條射線。
以最小平方法可求出空間中一點 F 到所
有射線的距離 di 平方總合最小，即為 C-arm
的有效射源；求得 C-arm 的有效射源後，即
可以有效發射源作為單點透視投影模式中的
投影中心，建構出 C-arm 的成像幾何，之後
便可在兩張不同角度拍攝的 C-arm 影像上標
定出空間中一點座標的投影，以達到定位與
導引之目的，也可透過兩張 C-arm 影像來決
定空間中一點的座標，例如將將刀具的位置
與方位投影於 C-arm 影像上。。
四、實驗與結果討論
(一) 系統架設
系統操作時，可大致區分為手術前與手術
中兩個階段；系統術前的架設如 圖 9 所示。
術前操作時，先將校正器夾附於 C-arm
接收端，並在病患待手術的骨塊上鎖固一
DRF 用以決定 FP，之後調整 C-arm 至兩個
不同的方位分別取像。手術進行時，則不需
再使用 C-arm。
圖 9－系統術前架設
(二) 系統定位精度驗證
用以測試系統定位精確度的豬骨如圖
10 所示，實驗前先將作為標記用的 2mm 鋼
珠固定於豬骨表面。再將 DRF 固定在實驗用
豬骨上並置於手術台，以 C-arm 在不同照射
角度下各取像一張；取像後計算各座標系的
轉換關係，並以滑鼠在兩張影像中點選相同
標記的影像中心位置，並以前述方法計算出
該標記的空間座標值(計算值C

)；之後以探針
量測該標記之空間座標值(量測值M

)；計算
值與量測值之差即為系統單點誤差，六次的
實測結果如表 2 所示。
圖 100－實驗用豬骨與測試用標記
圖 8－理想的 C-arm 成像幾何
個人電腦
接收端
發射端
校正器
光學式
定位裝置
（xi , yi , z）
Y
Z
（xUIi , yUIi , 0）
X PUIi
Pi
有效射源
F=(Fx , Fy , Fz)
di
2mm鋼珠
