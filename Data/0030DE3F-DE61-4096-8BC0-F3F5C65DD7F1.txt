 
中 文 摘 要 ： 本計畫執行迄今，在整體查核點及預定工作項目進度之表現
上尚能符合原擬計畫目標，且在跨學術專業領域的整合，建
構符合自行車使用者及相關業者於使用及推廣上之需求上，
已篩選合適的技術，以進行實際的開發與佈建；不論自學術
或實務方面，都累積出相當的成果，足以作為後續推動本計
畫的基礎。本期計畫主要的重點置於將自行車顯示平台改成
Android 作業系統平台，往後只要是 Android 作業系統智慧
型行動裝置，即可 WSN聯結。此外，在運動心率紀錄與管
理、自行車防盜及警示裝置、空氣品質監測模組、WSN 模組
建置與測試、綠色電能供應、路由演算法設計、Gateway 雙
向資料傳輸設計、資訊站介面設計、Google Map Latitude 
API 環境建置、軌跡追蹤與定位演算法等亦均能順利完成。 
中文關鍵詞： Android 作業系統，智慧型行動裝置，運動心率紀錄，自行
車防盜，空氣品質監測模組，WSN 模組建置與測試，綠色電
能供應，路由演算法設計，Gateway 雙向資料傳輸設計，資
訊站介面設計，軌跡追蹤與定位演算法。 
英 文 摘 要 ：  
英文關鍵詞：  
 
2 
 
也希望能夠隨著「自行車與生活」的概念推廣，將
本悠活自行車聯盟系統運用到全台灣，俾利於無線
感測器網路建設及達到「輕鬆騎車、快樂吃飯、身
體健康」的目的。 
 
關鍵詞: 無線感測器網路、自行車、節能、環境監
測、健康生活、軌跡追蹤。 
 
二、緣由與目的 
近年來，「樂活」與「環境教育」成為新生
活／教育運動，兩者環環相扣，並與「認識自然」
這項功課密不可分。與大自然接觸卻不淪為走馬看
花，事先準備功夫不能馬虎；若能進一步運用恰當
活動深化人與自然當下的關係，人類對環境就能更
體貼、尊重。另一方面，近來自行車運動越來越風
行，自行車不僅可以幫助人舒緩平時累積的壓力，
有益健康身心，更可對於地球日趨嚴重的溫室效應
有所助益。牽著自行車擁抱戶外，讓身體的健康、
地球的環保以及生活的樂趣由此而生，一切都從踩
下踏板的動作開始。 
有鑑於上述兩個議題，聖約翰科技大學與海
洋大學研究團隊，利用無線感測器網路(Wireless 
Sensor Network，WSN)的平台及相關技術，針對與
自 行 車 騎 乘 活 動 攸 關 的 節 能 (Energy 
Conservation)、健康生活(Health  Care)、環境監測
(Environmental  Monitoring)、軌跡追蹤(Positioning 
and  Tracking)以及安全與防盜(Safety  and  Security)
等議題，進行深入的研發，希冀能以淡水河沿岸之
自行車車道為「自行車與生活」的實現場地。 
截至目前為止本研發團隊於除了在「自行車
裝置模組」、「車道端佈建模組」、「資料庫建置
與分析模組」，加強開發所需要的核心技術外，
「Google Map」的完整呈現，和計畫與模組間的技
術互相支援性亦為本年度重點。同時為了鼓勵自行
車騎士在大自然進行探索，深化人與自然當下的關
係，本年度的研發作品跳脫了工藝品冰冷的外觀，
以紅樹林沿岸的「水筆仔」、「飛鳥」、「彈塗魚」
作為本年度戶外設備的外觀，希冀讓自行車騎士來
到淡水，不僅只是享受生活外，還可以結合個人經
驗和智慧成長，「慢慢的騎、仔細的看」，來促成
騎士的自我發現以及知識建立。此外針對「自行車
防盜技術」、「車道人流量紀錄技術」、「心率變
異性紀錄」、及「光學呼吸率紀錄」等技術均已完
成。 
本年度計畫的情境，主要是建構在無線感測
器網路平台技術創新應用上。在此計畫中，我們希
望能夠找到新北市的自行車租借站合作成立「悠活
自行車聯盟」入口服務站。凡喜愛騎自行車的同
好，不管有沒有自行車，都可以在此處得到服務。 
每位聯盟的自行車騎士來到本服務站時，可
以有兩種選擇，一種是使用自己的Android手機當作
控制介面，此時使用者只要事先透過網路到Android
應用服務專用商店(Android  Market)下載悠活自行
車專屬控制軟體，現場只要租借感測器網路設備即
可。另一種則是借用聯盟專用自行車(請參考圖
一)，車上配備了本團隊設計的風與光轉換設備以
及專用的Android外接裝置，透過這些設備，讓自行
車騎士可以更加輕鬆、無負擔暢遊北台灣的黃金水
岸。 
當自行車騎士徜徉於黃金水岸的美麗山水
時，車道端設備不斷的蒐集使用者的行車軌跡、生
醫資訊，以及車道端的微氣候資料，透過感測器平
台裝置傳送回到後端資料庫，以便建立使用者的個
人軌跡等資料，同時也將必要的群組訊息回傳到使
用者端的裝置上。而自行車騎士的安全及自行車的
防竊機制也同時處於系統的監控之下。系統的網路
架構圖請參考圖二。 
本計畫共有三個分項模組：「自行車裝置模
組」、「車道端佈建模組」、「資料庫建置與分析
模組」，旨在共同開發所需要的核心技術，整個計
畫的應用範疇涵蓋了「綠色電力供應」、「生理回
饋系統」、「軌跡追蹤及群組定位」以及「即時安
全系統」等，模組間的技術互相支援性高，而且主
題最後的目標趨向一致。 
最後，本計畫預期將以三年時間完成整體規
劃之內容，計畫執行迄今已兩年半，截至目前為止
本計畫所得之重要執行成果及價值如下所述： 
 本計畫之技術領域涵蓋資訊，通訊，電能及
生醫等四大部分，透過跨領域的整合，成功
建構符合自行車使用者及相關租賃與販售業
者於使用及推廣上之需求。 
 本計畫透過實際的開發與佈建，結至目前已
達成：自行車端模組之WSN模組建置與測
試，綠能儲存及使用技術，Zigbee Handshaking
及封包格式制定，與伺服器與資料庫建置等
工作。 
 本計畫分別已與創揚科技及盛暘科技有限公
4 
 
市政府高灘地管理處的路段，都大約是這個車道寬
度，但中間有部分車道，屬於新北市政府的人行步
道，不是高灘地管理的自行車道(例如說，紅樹林
保留區)，那些路段為了保留原始風貌，沒有特別
管理，路段也是沒有特別劃分，人車一起行走，實
地建置時，將跳開這些路段。 
本期實地佈建時，車道端的模組我們使用清
華大學的Octopus模組，Octopus為以16位元MSP430
和無線傳輸器CC2420為核心的無線感測器平台，其
傳輸距離可以到達200公尺遠(理論值)。電力管理的
部分，Octopus  II的電力來源主要是兩顆3號電池。
MSP430提供了5種省電模式，其中一種可以藉由關
掉所有震盪器功能，讓MSP430達到最低0.2  μA的
耗電。因此，使用者可以進入這個省電模式，讓無
線感測節點有最長的使用時間。本模組適合戶外架
設使用，每個模組間的連線距離約30～50公尺，並
且為了戶外使用方便，本團隊挑選市面上的太陽能
燈具模組作為外觀主體，請參考圖七。這個產品除
了能提供美觀和防風雨、日曬外，也兼具了日間太
陽能充電、夜間蓄電的功能，因此，本團隊改造了
整個系統的電路，並加上計畫所使用的Octopus模
組，以做為關渡自行車道的戶外車道端感測路由器
設備，整體的設計請參考圖三至五。圖六至八則為
Octopus感測模組與戶外太陽能燈兩個裝置的結
合，本團隊除了改裝其電路設備外，亦將設計一套
220轉110伏特的轉換模組，來提供此戶外裝置的用
電。 
在自行車道的分區設計中，我們改以感測器
網 路 的 PAN(Personal  Area  Network) 來 分 組
(PAN=0x21~0x2A共十區)，每個區塊內掛10個感測
器模組，並且在每一區塊加上一個Gateway，以便
把訊號透過3.5G傳到後端的使用者資料庫。並且在
分區設計中，不同於前一年的設計，整個感測器網
路加上了資料聚合的技術(Data Aggregation)，系統
示意圖請參考圖九。 
在每個分區的車道端路由器中，其網路拓樸
為線型分布，每個子(父)節點都只有一個父(子)節
點 ， 每 個 分 區 內 的 路 由 器 編 號 分 別 為
0x0001~0x000A，共十個，第一編號的路由器節點
亦為上傳資料的3.5G Gateway，為了減輕節點的負
擔，第一個路由器節點將約不負責與自行車間的通
訊。 
另一方面，在系統的望路協定設計部分，每
個車道端的感測器路由器內建十筆資料緩衝區，其
緩衝區的資料格式設為指標結構，資料型態為16進
位無號整數，分別儲存最近10筆自行車Mac短位
址，和接收到訊號的車道端感測路由器編號。車道
端路由器會收到兩種自行車的訊號，封包的協定請
參考表一。 
1.  普通的自行車訊號：此時車道端的路由器
會把該訊號儲存於感測器的資料緩衝區中，並且會
過濾掉重複的自行車識別碼。同時，車道端感測路
由器預設為每隔兩秒發送一次封包訊號給父節
點，若於兩秒內，且該路由器收到剛好收滿十筆來
自不同的自行車的短位址訊號，亦會提早發出自行
車封包給父節點，並且重設該計時器，重新數滿兩
秒。 
2.  自行車求救訊號：此時，若自行車騎士按
下車載裝置的求救按鈕，此時，自行車會持續發
“99  99＂的2byte封包，若車道端的路由器收到
後，會隨即以廣播的方式再傳出去。 
 
表一、車道端封包協定 
  自行車  車道端路由器 
一般
訊號 
含自行車
短位址的
封包 
z 收滿十筆不同的自
行車封包隨即轉發
給父節點 
z 若滿兩秒鐘也轉發
封包給父節點 
求救
訊號 
含自行車
短位址和
“99 99”2 
byte的求
救訊號 
z 以廣播封包的方式
轉發給周遭 
 
節點休眠設定 
在Octopus中，使用的是TI的MSP430微處理器
(MCU)，該處理器通常有幾個電源狀態，它們具有
不同的電源功率、喚醒延遲和對週邊支援。微處理
器在能滿足程式需求的前提下，應當一直處於能量
消耗儘量低的電源狀態。一般來說，為了準確地判
斷處理器該處於哪個狀態，需要有大量外圍子系統
和週邊設備的電源狀態資訊。另外，程式中處理狀
態轉換是很常見的。每當微處理器處理一個中斷
時，它從低功耗狀態切換到啟動狀態；也就是當
TinyOS發現任務佇列為空時，它回到低功耗狀態。
在本系統所使用的TinyOS 2.x，其內建三種機制來決
定讓處理器處於哪種狀態：狀態和控制暫存器，電
源狀態覆蓋(override)。 
6 
 
cycle，則呼叫setLocalDutyCycle(5)。在本系統中則
以0.05%的duty cycle為實施的目標。 
 
圖三、淡水河右岸地形圖 
 
 
圖四、布建之自行車道實景 
 
 
圖五、布建之自行車道實景二 
 
 
圖六、Octopus 與外接模組 
 
 
圖七、太陽能戶外燈 
 
 
(a) 
 
(b) 
圖八、車道端感測器路由器裝置，(a)裝上 Octopus，
(b)同時提供 Led 照明與 Octopus 訊號傳輸 
 
 
8 
 
明，分別為等待連接一直到與藍芽鎖連接成功的畫
面截圖。圖十三則是Android手機的警示與待機畫
面。當藍芽鎖偵測到三軸感應被震動到，或自行車
主發現與自行車的藍芽鎖斷線時，則會發出Android
手機的警訊。同時藍芽鎖亦會持續發出“99 98＂的
警示訊息給車道端模組。 
 
 
 
 
 
圖十二、Android 系統操作介面，(a)權限開啟要求，
(b)藍芽連接畫面，(c)等待生醫訊號裝置，與藍芽裝
置連接，(d)與藍芽鎖連接 
 
  
10 
 
 
B. 車道人流量紀錄技術 
自行車道端人流量紀錄，可提供政府及自行
車運動愛好者很有用的資訊，用以了解每時段，使
用自車車道的人數，掌握本技術，可應用百貨公
司、商場人流統計，以了解最佳銷售時段，做最適
當安排。本計畫整合車道端太陽能發電技術、無線
感測網路，及焦電式紅外感測(PIR)技術，與新北市
政府合作，在淡水紅樹林自行車道路段，裝設自行
車道端人流監測。 
自行車車流量監測，採用PIR偵測人體溫度輻
射，因為人體的體溫在36.5℃時會輻射出波長為
10um的紅外線，圖十七表示不同溫度在不同波長
下的輻射能量。 
0,1 1 10 100
100
103
106
109
1012
ultraviolet vis infrared region
vi
si
bl
e 
lig
ht
 re
gi
on
 
 
 300 K
 500 K
 1000 K
 2000 K
 3000 K
Sp
ec
ifi
c 
sp
ec
tra
l e
m
is
si
on
 in
 W
/(m
2  μ
m
 s
r)
Wavelength in μm
圖十七、不同溫度熱輻射能量 
 
本製作另一個主要物件是Optical  Filter，對於
穿透的波長具選擇性，Optical Filter只允許7～14μ
m波長的紅外光通過，過濾掉不是人體輻射的其他
能量，而人體產生的紅外線在此透過Fresnel  Len幫
助PIR收集遠距離的紅外光，可以達成指向性設計
及聚焦遠距能量，本系統有效量測範圍6‐8公尺。
電路圖如圖十八所示，利用兩次帶通放放大器，放
大弱感策信號，並用cds補償白天與晚上不同背景
之差異，最後用比較器產生人流次數之脈波，此脈
波信號與WSN結合統計每時段人流次數。雛型實體
如圖十九所示。 
 
 
圖十八、PIR 人流量感測電路 
 
 
圖十九、PIR 人流量模組雛型 
 
C. 心率變異性紀錄 
自行車運動心率紀錄，我們採用MSP430AFE
及藍芽模組，與智慧手機連線，將心率資訊傳送並
記錄於智慧型手機，電路實體圖及手機收訊示意圖
如圖二十、圖二十一所式。當我們紀錄完整的運動
心率資料，可將整筆的心率資訊做心率變異性分
析，以提供更多健康檢測資訊。 
. 
 
圖二十、藍芽心率紀錄器 
 
12 
 
 
圖二十五、光學心率紀錄器 
 
 
圖二十六、參考用壓電呼吸模組 
 
200 400 600 800 1000 1200 1400 1600 1800 2000
0
1
2
3
4
Time
A
m
pl
itu
de
The orginal PPG Signal
200 400 600 800 1000 1200 1400 1600 1800 2000
-0.3
-0.25
-0.2
-0.15
-0.1
-0.05
Time
A
m
pl
itu
de
The reference respiratory signal
200 400 600 800 1000 1200 1400 1600 1800 2000
0.4
0.6
0.8
1
Time
A
m
pl
itu
de
The estimated respiratory signal
 
圖二十七、PPG 呼吸頻率實驗結果 
 
E. WSN平台模組建置與設計 
由於本年度車道端的主要目標，主要在建立
車道端節點、自行車節點與後端資料庫雙向之訊息
傳輸，並維持通道上的穩定性。因此，本年度的首
要工作，就是針對台大平台的MAC協定，重新加以
改寫，其目的在於系統能更加穩定在WSN自行車系
統中運作。首先在環境中，系統預期環境中的自行
車數量多且移動速度快，因此，沿用傳統的Zigbee
網路註冊協定將造成系統的延遲，無法達到自行車
快速移動的目的。因此，為了避免造成資料傳送延
遲的碰撞，網路中主要的傳輸方式都是透過包含節
點MAC  位址的廣播封包。 
系統網路的分布狀況是以分區呈現，每區包
含一個支援HSDPA/GPRS  行動傳輸的Gateway和四/
五個Router(目前系統每區以四個Router為主)。車道
端沿線佈建Router，負責交換/蒐集自行車資訊，而
3G  Gateway負責以HSDPA/GPRS的網路訊號和後端
伺服器連線，負責傳送自行車使用者資訊。不同於
去年期的技術，本年度已經全面使用Zigbee路由協
定，所有區內節點把資料傳送到該區負責與資料庫
通訊的3G Gateway即可，可以節省網路花費在行動
路由傳輸的費用，並減少Gateway硬體費用。圖二
十八為實體佈建時的照片，以聖約翰校園及淡金公
路為佈建場景。 
(a) Gateway外觀與設計 
延續去年計畫，Gateway為一台具備3.5G連線
的工業小電腦，並透過RS232與台大平台相連接。
今年度為了實現戶外實體佈建的目標，本團隊設計
可防水、透氣、上鎖的白鐵外置箱，尺寸為
48x15x10cm，來放置戶外Gateway，白鐵箱下面有
開孔，做為透氣和天線外露處等，請參考圖二十九。 
 
(b) Router外觀與設計 
另外，在本年度計畫中，每個Router節點負責
的工作是雙向傳輸，包含以下的功能： 
z 蒐集並發送自行車節點資訊， 
z 發送區域內的微氣候資訊， 
z 代傳區域內封包資訊， 
z 發送緊急求救訊號， 
z 自行車車主尋找車友及發送簡訊等。 
因此，Router節點需要大量沿線佈建在車道
端，並且要符合安裝的便利與具備防水功能。目前
的設計以防水壓克力盒和白鐵箱為主，白鐵外盒請
參考Gateway設計，尺寸為24x15x10cm，請參考圖
三十。 
14 
 
 
 
圖三十二、系統平台的概念，紅線為下傳，藍線為
上傳 
 
(a) Router的封包傳送設計 
在網路上的設計上，首先為了不浪費區域內
Router與Router之間的頻寬，Router若沒有接收到來
自Gateway的資料時(廣播封包，檔頭值為0xDD)，
會處於Data Aggregation狀態，只負責不斷蒐集通訊
範圍內的資料，而不上傳(在系統中設定為每隔1~3
秒上傳)，若於上傳時機到時，便會把緩衝區內資
料整合成一個封包，開始傳送給上層一個Router，
並於上傳後將Data Aggregation Buffer清空，重新蒐
集區域內資料。 
同時，Router會根據自己的網路位置和接收時
間有不同的轉傳格式： 
z 若節點不是終端 Router節點，則當收到
來自上一連結發出的封包時，Router 便
會將此封包傳往下一個連結的Router節
點， 
z 若節點是終端 Router 節點，則此終端
Router 收到轉傳過來的封包時，便會上
傳包含 0xAA 檔頭的封包、本身 Router
的識別資訊、本身 Aggregate Buffer的資
料…等內容封包，給上一個 Router， 
z 若節點本身是路徑中的 Router節點，若
收到下一節點的上傳封包時，此時
Router 便會把上傳的封包與自己的資料
結合再向上傳(Data  Aggregation)，直到
傳至 Gateway 為止。 
z 上傳過程中Router會過濾掉除重覆的資
訊減少頻寬的使用，當上傳封包過長時
Router會切割封包分別上傳。 
 
 
表二、Router 節點的上傳封包格式 
欄位
名稱 
HEADER  Gateway 
ID 
Router 
數目 
Router
ID 
資料
筆數 
Bicycle
ID 
RSSI  Control   
code 
DATA 
Octets  1  1  1  2  1  2  1  1  USE_DATA_L
ENGHT 
  N  N 
  M  M 
 
表三、Router 節點的下傳封包格式 
欄位 
名稱 
HEADER  Gateway 
ID 
資料 
筆數 
Bicycle 
ID 
Control 
  code 
DATA 
Octets  1  1  1  2  1  USE_DATA_LENG
HT 
  N                    N   
 
表四、自行車控制命令 
封包命令欄位  控制命令 
00  定位 
01  尋找他人 
99  求救訊號 
 
16 
 
性，本團隊重新設計的自行車上的設計與顯示介
面。其中，為了方便使用者的資訊傳達、以及Google 
Map的顯示，整個系統架構在智慧型手機/平台系統
中。同時具有兩種選擇，(1)使用支援Android平台
的ARM平板電腦，並使用Rs‐232有線連線，(2)使用
Android手機。請參考圖三十四。 
 
Android 系統 
Google在2007年11月5日公佈的手機系統平
台：Android  系統，是基於  Linux  核心的軟體平台
和作業系統，其架構早期由  Google  規劃，之後再
由各大手機製造商的組成的開放手機聯盟(Open 
Handset Alliance)開發(最知名的如台灣的HTC  )，這
個目前正熱門的行動作業系統跟以往各大手機廠
閉門自修所發展出的  Linux  系統最大的不同在於
它開放原始碼，讓一般人也可以輕易的利用  SDK 
( Software Development Kit )開發各式各樣的軟體，
另外也結合了各項  Google  所提供的服務功能，使
得   Android  作業系統在短短的兩年內迅速成竄
起，成為市場的明日之星。 
目前來說，Android具有的優點如下： 
z 整合網頁瀏覽器 
z 強大的繪圖能力 
z 媒體支援能力 
z Android Market 
z Google  規劃  Android  系統每半年進行
一次系統升級 
而在本計畫中，本團隊為了突顯感測器網路
的優勢，於是決定讓自行車端的控制獨立於GPS和
3.5G訊號外，因此，也就是說本研究團隊決定結合
Google Map和感測器網路於一體，不需要其他的通
訊媒體。 
首先我們先將Google  Map中的地圖利用離線
地圖製作器，將離線地圖抽取出來。市面上有一套
離線地圖製作器   Mobile  Atlas，除了具備產生 
SQLite  地圖資料庫(BigPlanet_maps.sqlitedb)的基本
功能外，更具備自動將程式分次執行所下載的不同
區域地圖檔，都新增至同一個資料庫的貼心功能。
另外，我們儲存資料庫為SQLite  資料庫，使得原本 
25萬多(257,289)個檔案，實際大小共  466MB  的全
部地圖，存入  SQLite  資料庫後變成  496 MB，其中
多出現的  30MB  主要是用來儲存資料庫內的索引
(Index)，496MB  的  SQLite  資料庫放進  SD  卡內還
是  496 MB，經過團隊測試，雖然資料庫內存了  25 
萬多筆資料，但尚無效能問題。請參考圖三十五。
而在我們設計的自行車控制介面中，則可以方便的
從App Market下載，並且自行安裝到手機中。圖三
十六分別為悠活自行車程式執行畫面。(a)為程式安
裝後的畫面，(b)為使用者位置顯示畫面，(c)為自行
車騎士求救畫面，(d)為程式附加功能執行畫面，最
後(e)則為搜尋隊友的畫面。 
 
 
圖三十五、Mobile Atlas  地圖製作器 
 
 
(a)(b) 
18 
 
以及目前的進度，在這裡將上述的五大功能作更細
部的工作項目區分如表六。 
 
 
圖三十九、資訊站功能表 
 
表六、資訊站功能細部分項 
會員系統  社群系統  查詢定位系統  軌跡記錄及分析
系統 
訊息發送系統 
實作  功能  實作  功能  實作 功能  實作 功能  實作  功能 
●  會員管理  ●  新建及解散
群組 
●  查詢單車所
在地 
●  路徑紀錄  ●  發送 
訊息 
●  會員註冊  ●  加入群組  ●  顯示單車回
報資訊 
●  顯示行車
路徑 
●  歷史 
紀錄 
●  登入登出  ●  群組管理  ●  車道建置         
●  資料修改  ●  群組公告  ●  顯示車道回
報資訊 
       
●  會員分級  ●  群組活動  ●  建立車道 
資料 
       
●  查詢密碼  ●  新增刪除好
友 
           
 
 
(b) 群組系統與軌跡追蹤 
使用者可以建立群組，拉攏許多志同道合的
朋友一同加入這個社群，同時可以透過發送群組訊
息與群組內的組員交流，亦或是透過系統的追蹤功
能來找到組員目前所在地如圖四十。 
 
(c) 建立群組 
使用者可以自行建立群組，只要在『建立群
組』的頁面輸入群組名稱以及群組簡介即可如圖四
十一。 
 
 
20 
 
 
圖四十六、群組定位頁面 
 
當我們想要知道某個組員的現在位置，可以
在右邊的下拉式選單選取該組員的名稱，系統會根
據名稱去資料庫搜尋該組員的現在位置以及相關
資訊，並且顯示在地圖上如圖四十七，若是想要觀
看車道上Gateway的各種資訊，只要點擊地圖上面
的圖示如圖四十八。 
 
 
圖四十七、組員定位訊息 
 
 
圖四十八、Gateway 定位訊息 
 
(h) 歷史軌跡 
可使用Google  Earth播放會員之自行車騎乘之
歷史軌跡，同時可供其他會員參考車道之景觀。圖
四十九所示為一位會員騎乘特定自行車道之歷史
紀錄，左邊為利用Google Earth重現之騎乘之歷史軌
跡，右邊為利用Google Map所顯示之位置圖。 
 
 
圖四十九、Gateway 自行車道之歷史紀錄 
 
 
(i) 資料庫欄位 
資料庫中的部分欄位需要自行車以及
Gateway回傳相關資訊給伺服器作記錄，這邊分為
兩個部分： 
 
自行車端：當自行車經過車道上的Gateway，
此時需要回傳自行車的相關資訊給資料庫如表七： 
 
 
表七、資料表中需要自行車回傳的欄位 
Bike_report 
欄位名稱  型態  值(範例)  說明 
Br_id  Int(10)  1  資料的流水號，由資料庫自動遞增 
Br_receiver  Char(23)  88 0f 16 11 
03 01 11 09 
收到自行車資料的節點 id   
22 
 
l_lng  float(13,10)  121.4502868652  緯度 
l_nodecount  int(11)  4    車道目前佈建的節點數 
 
表十、建立新車道所需資料表欄位(Gateway) 
Lanenode 
欄位名稱  型態  值(範例)  說明 
n_id  int(11)  12    流水號 
n_address  varchar(23)  88 0F 16 11 
03 01 11 09   
節點 ID   
n_name  varchar(20)  Gateway 1    節點名稱 
n_group  int(10)  15    所屬車道 ID   
n_order  int(11)  1    所屬車道的節點順位 
n_lat  float(13,10)  25.2269020081  經度 
n_lng  float(13,10)  121.4513931274  緯度 
n_type  varchar(20)  Gateway    節點類型(gateway / node) 
 
 
Gateway端：車道上的Gateway，要定時回報
現場的環境資料，如氣溫、濕度等環境觀測資料，
內容如表八： 
 
(j) 建立新車道 
建立新車道時，需要填入相關資料給資料
庫，該資料除了作為資料登記使用，還可以呈現在
『資訊站』給使用者查詢相關資訊。建立一筆車道
資料大致上可分為兩個部分，『車道』的資訊，以
及車道內『Gateway』的數量與位置，車道的資訊
需要填入車道名稱、簡介等資料如表九。 
新車道的資訊建立完成後，還需要將車道內
所有的Gateway資料如經緯度、所屬車道ID等資訊
填入資料表內如表十。 
 
I. 自行車步道網路模擬技術 
無線感測網路  (Wireless Sensor Network)具有
低功耗、體積小、擴充性佳等優點，相當適合作為
具有高即時性且需要長期監測的自行車道感測應
用，雖然透過事前的網路模擬，可以改善自行車的
佈建成本以及網路效能，但是網路模擬器(Network 
Simulator)的使用者需要具備高度的網路背景及相
關實驗設備，並不適合一般人使用。因此本文提出
一套能夠將網路模擬的繁雜流程簡化的系統，系統
端結合了OMNeT++、PHP、Google  Maps  API  等工
具，讓使用者僅需要使用瀏覽器即可達成佈建者網
路模擬的需求。 
本系統大致可以分成兩大區塊，分別是網頁
伺服器以及模擬器，網頁伺服器端可再細分車道佈
建系統模組以及網頁模擬系統模組，模擬器部分則
是分為模擬器功能模組以及模擬器中介程式模
組，各模組的敘述如下： 
車道節點佈建系統模組：使用網路模擬器
時，需要將每一個網路節點的位置，逐行輸入到模
擬環境的設定檔內，本模組結合Google Maps API，
讓使用者能夠在真實比例的地圖來選擇網路節點
的位置，並且將網路節點的GPS座標轉換為模擬器
所需要的座標格式，以供模擬器使用。 
本模組考慮到提昇模擬的精準度以及方便
性，這個模組結合了Google Maps API，讓使用者不
需要提者GPS設備前往每個網路節點實際位置讀取
GPS座標，直接在地圖上標記節點位置如圖五十，
即可透過Google Maps API取得座標資訊，並且使用
球面距離公式如公式(1)，其中的 2211 ,,, yxyx 分別
代表兩個點的座標，R代表地球的半徑常數，如此
24 
 
發，因此對於無線相關的協定支援不完整。而MF
在網路節點的移動路徑演算法有多樣化的選擇。
MiXiM針對 ZigBee網路模型的開發完成度高於
INET，並且可以使用部分MF模型的移動路徑演算
法，因此本系統選擇MiXiM模型來自行車感測節點
模擬的開發。 
 
(c) 模擬器中介程式模組： 
當使用者將節點位置、相關參數設定完成
後，透過此中介程式讀取使用者所設定之參數並且
透過模擬器功能模組進行模擬，當模擬完成之後，
讀取模擬結果資料，在特定頁面顯示模擬數據與相
關圖表。 
要進行網路模擬之前，必然需要輸入一系列
複雜的參數，本模組替使用者簡化了這個步驟。本
模組主要有兩大功能，一個是讀取網頁端模擬系統
介面模組傳送的資料，轉換成模擬所需要的參數與
格式，並且驅動模擬功能模組。另一個是當使用者
需要在網頁端模擬系統瀏覽模擬結果時，可以在網
頁端單選或是複選如圖五十二先前的模擬結果，透
過本模組讀取先前的模擬資料，擷取出需要的資料
欄位如：平均每秒接收封包量如圖五十三、受到干
擾而丟棄的封包如圖五十四、平均傳送延遲如圖五
十五以及平均走過的節點個數，並以圖表化的方式
呈現在網頁上如圖五十六。 
 
 
圖五十二、模擬結果檢索部分頁面 
 
圖五十三、平均每秒接收封包量 
 
圖五十四、收到干擾而丟棄的封包數 
 
圖五十五、平均傳送延遲 
 
平均封包走過節點個數 
 
26 
 
 
圖六十、(a)風力發電機)  ，(b)太陽能板(追日
&MPPT) 
 
 
(a)   
 
(b)   
圖六十一、自行車設備，(a)太陽能板架設位置，
(b)彈塗魚風力發電機 
 
車道端主要是將太陽能與風能轉換成電能之
後，再將這些電能儲存至鋰鐵電池中，提供車道端
設備之電力來源。提供低壓WSN電路所用鋰鐵電池
穩壓電路如圖六十二所示。 
 
圖六十二、鋰電池 TB88‐50  升壓模組 
 
此為鋰電池供給移動式設備的DC  5V升壓模
組，其中二極體選用蕭特基二極體1N5817，相較於
一般整流二極體1N4001，其耐壓及耐流較大，可達
20V/1A，且導通速度也較快。其規格如下： 
 輸入電壓(Input Voltage)：0.9~7V 
 輸出電壓(Output Voltage)：5V 
 最大輸出電流(Output  Maximum 
Current)：500mA 
並且由數據可得知，輸出電流越大，輸入與
輸出的功率耗損就會越大。 
而本設備主要是用於小型可攜式裝置，一般
耗電量並不大，應此是可行的。(如：Super Node  大
約23mA)，實驗數據如表十二所示。 
 
表十二、實驗數據 
28 
 
 
圖六十六、殘量過低偵測流程圖 
 
 
圖六十七、殘量過低偵測實體圖 
 
由於太陽能板會隨著日照與溫度的不同，而
會有輸出功率不同的特性，所以為了要讓太陽能板
在不同環境中，都能達到當時最大的輸出功率，勢
必要使用最大功率追蹤法(Maximum  power  point 
tracking,  MPPT)。本系統採用被動式追日感測器，
在本系統中主要用來追蹤當時太陽之角度，必須裝
設在無遮蔽物之空曠地方，且利用光線直射的原理
以達到使追蹤器與太陽近乎成垂直的角度。本系統
如圖六十八所示。 
 
 
圖六十八、被動式追日系統 
 
本被動式追日感測器主要是以光敏電阻的分
壓變化來判斷日照光線的大小，原理是利用光線直
射的特性，當追日板未與太陽呈現垂直狀態時，隔
板兩側的光敏電阻會因為阻值的不同而使分壓值
不同，圖六十九所示。反之，當追日板與太陽呈現
垂直狀態時，因隔板兩側光敏電阻受光照的照度相
等，因此所產生的分壓值也會相等，因此利用此原
理來判斷是否已追到日，圖七十所示。 
 
 
光敏電阻光敏電阻
受
光
不
受
光
太
陽
光
追日板
 
圖六十九、被動式追日感測器(未與太陽垂直) 
 
 
光敏電阻光敏電阻
受
光
受
光
太
陽
光
追日板
 
圖七十、被動式追日感測器(與太陽垂直) 
 
現今許多追日系統大多都是依靠光感測器去
追日，但往往會因為一些外在自然因素而造成誤動
作(如：烏雲、鳥屎、灰塵…等)，如此一來不但會
不準確，而且會隨之浪費掉了在這些誤動作中所使
用的電力。 
因此，本被動式追日系統使用了三組光感測
器，微處理機一次判斷三組光感測器的平均電壓
值，當其中一組光敏電阻受外在因素影響時，系統
30 
 
表十三，2011 年 1~6 月太陽過中天時刻表 
(資料來源：中央氣象局) 
日 1月 2月 3月 4月 5月 6月 
1 
2 
3 
4 
5 
12:03:16 
12:03:44 
12:04:12 
12:04:40 
12:05:07 
12:13:29 
12:13:37 
12:13:44 
12:13:51 
12:13:56 
12:12:27 
12:12:15 
12:12:03 
12:11:51 
12:11:38 
12:04:04 
12:03:46 
12:03:29 
12:03:11 
12:02:54 
11:57:11 
11:57:04 
11:56:57 
11:56:51 
11:56:46 
11:57:45 
11:57:54 
11:58:03 
11:58:13 
11:58:24 
6 
7 
8 
9 
10 
12:05:34 
12:06:00 
12:06:26 
12:06:52 
12:07:16 
12:14:01 
12:14:05 
12:14:08 
12:14:11 
12:14:12 
12:11:24 
12:11:10 
12:10:56 
12:10:42 
12:10:27 
12:02:37 
12:02:20 
12:02:03 
12:01:46 
12:01:30 
11:56:41 
11:56:36 
11:56:33 
11:56:29 
11:56:27 
11:58:34 
11:58:45 
11:58:57 
11:59:08 
11:59:20 
11 
12 
13 
14 
15 
12:07:41 
12:08:04 
12:08:27 
12:08:50 
12:09:12 
12:14:13 
12:14:13 
12:14:12 
12:14:11 
12:14:09 
12:10:11 
12:09:55 
12:09:39 
12:09:23 
12:09:07 
12:01:14 
12:00:58 
12:00:43 
12:00:27 
12:00:13 
11:56:24 
11:56:23 
11:56:22 
11:56:21 
11:56:21 
11:59:32 
11:59:44 
11:59:56 
12:00:09 
12:00:21 
16 
17 
18 
19 
20 
12:09:33 
12:09:53 
12:10:13 
12:10:32 
12:10:50 
12:14:06 
12:14:02 
12:13:57 
12:13:52 
12:13:46 
12:08:50 
12:08:33 
12:08:15 
12:07:58 
12:07:40 
11:59:58 
11:59:44 
11:59:30 
11:59:16 
11:59:03 
11:56:22 
11:56:23 
11:56:25 
11:56:27 
11:56:30 
12:00:34 
12:00:47 
12:01:00 
12:01:13 
12:01:26 
21 
22 
23 
24 
25 
12:11:07 
12:11:24 
12:11:40 
12:11:55 
12:12:10 
12:13:40 
12:13:33 
12:13:25 
12:13:17 
12:13:08 
12:07:22 
12:07:04 
12:06:46 
12:06:28 
12:06:10 
11:58:51 
11:58:39 
11:58:27 
11:58:16 
11:58:05 
11:56:33 
11:56:37 
11:56:42 
11:56:47 
11:56:52 
12:01:39 
12:01:52 
12:02:05 
12:02:18 
12:02:31 
26 
27 
28 
29 
30 
31 
12:12:23 
12:12:36 
12:12:48 
12:13:00 
12:13:10 
12:13:20 
12:12:58 
12:12:48 
12:12:38 
12:05:52 
12:05:34 
12:05:16 
12:04:58 
12:04:40 
12:04:22 
11:57:54 
11:57:45 
11:57:35 
11:57:27 
11:57:19 
11:56:58 
11:57:05 
11:57:12 
11:57:19 
11:57:27 
11:57:36 
12:02:43 
12:02:56 
12:03:09 
12:03:21 
12:03:33 
 
表十四，2011 年 7~12 月太陽過中天時刻表 
(資料來源：中央氣象局) 
32 
 
 
圖七十四、主動式追日流程圖 
 
例： 
假設使用者欲想使用主動追日模式時，操作
步驟如下： 
1. 選單頁面選至「自動」。 
2. 點選「主動式」。 
3. 輸入主動追日的時間間隔(分)。 
4. 確定以上輸入皆無誤後，按下確定「SET」
按鈕。 
5. 系統自動開始執行主動式追日。 
 
使用介面如圖七十五所示。 
 
 
圖七十五、VB 主動式追日介面 
 
被動模式 
當系統被設定在被動模式下時，太陽能板角
度控制的依據主要由遠端被動式太陽能追日感測
器所提供。 
伺服器VB控制端會每隔固定一段時間後(使用
者需自訂)，經由zigbee無線感測模組自動向遠方追
日感測器要取當時太陽所在之角度，接著利用所獲
取之角度控制遠端太陽能板角度，進而達到追日之
目的。 
例： 
假設使用者欲想使用被動追日模式時，操作
步驟如下： 
1. 選單頁面選至「自動」。 
2. 點選「被動式」。 
3. 輸入被動追日的時間間隔(分)。 
4. 確定以上輸入皆無誤後，按下確定「SET」
按鈕。 
5. 系統自動開始執行被動式追日。 
使用介面如圖七十七所示。 
34 
 
 
圖七十九、3.23  主被動式追日流程圖 
 
 
圖八十、VB 主被動式追日介面 
 
 
K. 無線運動心率紀錄器設計 
本階段以改變自行車顯示面板為重點，採用
Andriod作業系統為顯示器人機界面平台，方便將本
研發程果融入行動手機或平板電腦，使應用有更佳
的擴展性。上一期我們完成自行車端心率信號攫取
裝置，採用自行車把手為電極，紀錄心率信號，此
法受限於使用者只能在自行車上，兩手握把手時才
能量得心率信號。我們希望擴展為不在自行車，即
使是走路、慢跑也能記錄運動歷程的心率變化。在
此改採光學方式記錄心率心號，就不受電極介面的
限制，如圖八十一左圖所示，只要成本低廉的紅外
光反射器，就可擷取右圖的脈率信號，經微分處理
可輕易的獲得心率，本心率信號經MCU及藍芽傳送
可在Andriod平台顯示即時心率。本電路實體圖如圖
八十二所示。 
 
圖八十一、光學心率偵測示意圖 
 
 
圖八十二、無線心率實體圖 
 
在Andriod平台，我們紀錄運動歷程的心率，
使用前先記錄個人資料:年齡、體重，以確定最式運
動心率及消耗卡路里，如圖八十三所示，可選擇一
般運動模式或最適運動模式，一般運動模式只記錄
紀錄運動歷程的心率、速度、消耗卡路里。最適運
動模式，會以聲音提醒使用者加速或降低速度，使
心率落於最適範圍，如:一般正常人最適運動心率
=(220‐年齡 )*(0.6~0.8)，身體較差者適運動心率
36 
 
續執行可能面對的較大困難，將是如何讓大量的自
行車能同時在車道上接受服務，及如何實體佈建
WSN模組等困擾，此部分計畫團隊將會在後續研究
的過程中，有更多的投入；冀使本計畫的執行能在
團隊的合作機制下，提出可行建議及實際的施設，
已順利完成本計畫之預期成果。 
 
六、早期參與廠商績效 
 
計畫執
行期間 廠商名稱 
早期參與
金數額 
合約年
限(年) 
參與金繳
交與否 
第 1年 創揚科技有限公司  150,000  1  是 
第 2年 盛暘科技有限公司  100,000  1  是 
 
 
 
 
 
報告人姓名 翁仲銘 聖約翰科技大學 
電腦與通訊工程系 
參加會議經過： 
此次 ICUFN 2012 在泰國普吉島舉行，舉辦日期為 7/04 至 7/06，為期 3 天的議程中包
括在資訊工程上不同領域的研究，其中又以 Wireless and Communication Network、Cognitive 
Radio Network、Ad-hoc and Relay Network 與 Cooperative Communication 等議題最為仲銘所
感興趣。這些議題對無線網路各領域均有所討論，各國的學者們均發表他們的研究成果，
發表方式為 oral 與 poster 兩部分，每篇 oral 文章以 15 分鐘左右的時間向參與來賓報告成
果，而 poster 則是張貼海報在 90 分鐘內向有興趣和疑問的來賓解說。所以這次的主辦單
位可說是辛苦至極，在議程的安排與論文的選擇上可見一般。 
在三天的會議中，又以下幾個場次的議題最為精彩： 
July 4 
Session 1B: Wireless Sensor Networks and RFID (1) 
 An Energy-Efficient Routing Protocol in Wireless Sensor Networks with Holes 
以往關於繞境議題的相關論文在處理空洞問題時，大部分採用簡單的 GPSR 技術來達
到資料成功傳輸的目的。但是先前研究並沒有考慮轉送節點之剩餘電量的問題。若轉
送節點的電量過低，可能導致網路的空洞的範圍增大，因此，本篇論文加入 Anchor 機
制，利用此機制，可以讓節點選擇電量較多的轉送節點，同時也能減少 Hop 數。 
 
 Performance Evaluation of 802.15.4 Medium Access Control During Network Association 
and Synchronization for Sensor Networks 
無線感測網路最主要的特色是自我組織以及維持連通性的能力，先前研究主要針對網
路初始化的階段，而本論文則針對 802.15.4 MAC 的設備互連以及同步的情況提出相對
應的機制。實驗結果顯示作者改良的 Frame structure 可以有效降低電量消耗，以及設備
連節時間，另一方面，每一段 Beacon interval 的長短也會影響網路整體效能。 
 
 Joint Energy-Balanced and Full-Coverage Mechanism Using Sensing Range Control for 
Maximizing Network Lifetime in WSNs 
Coverage 議題一直是 WSNs 中非常受到注目的問題，因為感測器必須能夠覆蓋使用者
有興趣的區域，以蒐集感測的資料。先前論文並沒有考慮 Sensor 的剩餘電量，因此某
些節點可能因為封包傳輸頻繁，進而導致節點耗盡電量，導致網路存活期短暫。因此，
本篇論文考慮節點剩餘電量，利用調整感測半徑來延長網路存活時間，同時達到 Full 
coverage 的目的。 
 
 July 6 
Session 5C:Wireless Sensor Networks/RFID (3) 
 Cross -Layer QoS Routing Protocol for Multimedia Communications in Sensor Networks 
本篇論文提出一個以 Cameras 為基礎的多媒體繞徑傳輸協定。由於多媒體感測網路對於時間傳輸
延遲有很大的要求，因此本論文主要目的為提出一個保證 soft end-to-end delay 的繞境協定，希望
能夠透過較少的 Hop 數就能完成繞徑。實驗顯示作者提出的方法確實能夠有效提升網路存活期以
及網路吞吐量，進一步而言，本協定亦可降低 end-to-end delay，然而，我認為本論文的比較對象
太少，實驗真實性有待商榷。 
 
 Data Dissemination Protocol with Hole Masking Algorithm in Grid-based Wireless Sensor Networks 
由於感測器節點可能因為電量耗盡而導致節點死亡，造成網路空洞產生，進一步導致資料傳輸中
斷。大多數的論文多建立一條繞過空洞的資料傳輸路徑進行資料傳輸，然而，這條路徑上的節點
可能因為過度頻繁資料轉送而加速節點死亡。本篇論文主要目的為動態建立資料傳輸路徑，讓每
個在空洞附近的節點能夠均勻分擔工作量，以延長網路生命時間。 
 
 整體來說，此次會議辦的相當成功，令仲銘收益良多。此外，不論在軟、硬體的準備上也很周到，
希望以後還有機會參加類似會議。 
 2
解整個會場與議程的安排並參加開幕歡迎會。 
101 年 9 月 24 日 09:00 在會場飯店的 Agung Room 經由會議主席 Prof. 
Suwarno 宣佈會議正式開始。當天早上進行主題演講及邀請演講的議程，包含日
本中央電力研究所(Central Research Institute of Electric Power Industry, Japan)、中
國華北電力大學(North China Electric Power University)、韓國電力資訊科技研究
院(Power IT Research Institute, Korea)、Swiss utility BKW FMB Energy Ltd. 等單
位的專家學者發表目前各單位正在進行的電力相關研究主題。本次大會的與會
人士約有十五餘國並六百多位國際學者與專家，發表論文六百餘篇，規模相當
龐大，大會並邀請許多知名學者進行專題演講，互相交流研究之內容與經驗。
大會於晚間舉辦盛大的歡迎晚宴，讓與會人士彼此之間能夠互相認識及討論研
究心得。 
接下來三天半的議程內容分成口頭及壁報論文發表。由於發表的議程及參
加人數相當多，因此口頭報告的論文發表分為三個演講廳同時進行，時間為早
上 08:00 至 12:40，下午 13:30 至 18:00。而壁報報告的論文發表分為 2 個場次，
分別在 9 月 24 日 14:00~15:30 及 9 月 25 日 13:30~15:00 舉行。本次會議議程整
體內容包含以下 12 個部份： 
1. Condition monitoring and diagnosis for power equipments and power 
systems 
2. Condition monitoring and diagnosis in power plants 
3. Failure phenomena based on electrical, mechanical, chemical and thermal 
causes 
4. Dielectric materials and their aging mechanisms 
5. Degradation assessment for power equipment 
6. Modern maintenance tools for effective replacement 
7. Advanced sensing techniques for condition monitoring and diagnosis 
8. Applications of artificial intelligence for data mining and condition 
assessments 
9. Applications of information and communication technologies for condition 
 4
此次會議規模相當龐大，大會並邀請許多知名學者進行專題演講，互相交
流所研究之內容與經驗，非常值得我們學習。本次會議攜回大會之會議論文集
及其全文光碟，內含許多國際間於此相關領域之重要研究，非常值得參考。經
由本次觀摩學習，未來有機會應多參與相關會議，以了解各國學者的研究近況
與學術概況，增進國際視野與研究能力。出席研討會所獲得之國際最新技術發
展趨勢，對於個人未來之研究及產學合作計畫之執行，獲益良多。 
 
五、 建議及攜回資料： 
此次大會的與會人士約有十五餘國並六百多位國際學者與專家，投稿論文
數目一千餘篇，審查後僅接受並發表論文六百餘篇，其規模相當龐大，大會並
邀請許多知名學者進行專題演講，互相交流所研究之內容與經驗，非常值得我
們學習。本次會議攜回大會議程表、IEEE 會議論文集(IEEE Catalog Number：
CFP1230D-CDR, ISBN：978-1-4673-1018-5)、廠商產品型錄等。 
此次展覽及會議所蒐集到的資料及出席研討會所獲得之新知，將有助於個
人未來之研究及產學合作計畫之執行。 
100年度專題研究計畫研究成果彙整表 
計畫主持人：陳金蓮 計畫編號：100-2218-E-129-001- 
計畫名稱：以感測器網路實現悠活自行車聯盟(3/3) 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 1 1 100%  
研討會論文 9 9 100% 
篇 
 
論文著作 
專書 2 2 100%   
申請中件數 2 2 100%  專利 已獲得件數 1 1 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 20 20 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 8 8 100%  
研究報告/技術報告 0 0 100%  
研討會論文 6 6 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
