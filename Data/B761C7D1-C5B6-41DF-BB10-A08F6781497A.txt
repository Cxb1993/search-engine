 2 
遍，主要是運作原理是由攻擊者在以太網
路技術所架構的區域網路內發送假造的
ARP 封包給其他受害的鄰近主機，讓傳送
至受害者位址的流量被錯誤送到攻擊者的
地方。藉以利用被動竊聽(Passive Sniffing)
方式，竊取所處的區域網路內所傳送的重
要資訊，如重要主機系統、BBS 的密碼，
或是受害者傳送與接收的 Email 與瀏覽網
頁的內容，甚至將原始傳送的資料篡改後
再轉送，造成受害者更大的損害。而此類
的攻擊若在虛擬主機的環境發動將更為容
易，並且因為共享網路介面傳輸效率較
高，攻擊效力將更為提高，並且整個欺騙
攻擊的傳送封包都只會發生在虛擬主機的
網路環境內，外界網路並不容易偵測。 
 
 
三、結果與討論 
 
我們利用多變量異常偵測系統即時收集
NetFlow之流量傳輸資訊，同時依照當前時
段至正常流量資料庫中取出該時段的之流
量傳輸資料，建立多變量常態模式，接著
與當前時段之流量傳輸資料進行多變量之
運算，以判定當前流量傳輸資料是否落入
異常區間，若該時段流量傳輸資料落入異
常區間，則提出異常警報，若無異常發生
則將當前流量傳輸資料儲存回流量資料庫
中，以更新歷史流量傳輸資料。 
 
本計畫使用 NetFlow 做為資料來源，
NetFlow是由 Cisco所提出之網路協定，被
路由器所廣泛支援使用，其資料包含 Layer 
3與 Layer 4之資訊，即包含了 IP層資訊，
因此 NetFlow 能提供追查網際網路上異常
主機之資訊。NetFlow資料來源主要為網路
傳輸設備(例如路由器、交換器)所提供之流
量傳輸資訊，其中最廣為使用的是 v5的版
本[17]。 
 
由於網路通訊技術蓬勃發展，加上網際網
路使用者人數大增，網路頻寬亦大幅增
加，各種新穎的網路服務如雨後春筍般出
現，對於大範圍的網路異常偵測，早已無
法使用封包內容進行分析、比對的方式處
理，此外 SNMP無法提供第二層以上之資
訊，亦使得我們無法進一步追查異常原因
與來源，故本研究採用具流量傳輸資訊及
分析成本較低的 NetFlow 做為異常偵測技
術之資料來源。 
 以下為本計畫從 NetFlow 傳輸資料中
統整的七個變數，用來摘要單位時間內網
路傳輸之情況。我們將 NetFlow 傳輸資訊
主要分為流入、流出兩大部份，流入是指
資料流入異常偵測系統所監控之網域，流
出則是指資料由異常偵測系統所監控之網
域流出。藉由監測此兩部份的變數，我們
能夠判斷我們所監控的網域內是否有任何
異常發生，例如當阻斷式服務攻擊發生
時，將可能造成單位時間內的流入總量大
增。此七個變數如表 1所示。 
 
表 1 實驗變數 
變數名稱 說明 
Total 
MegaBytes 
Input 
單位時間內流入之總流量 
(以MB為流量統計單位) 
Total Packets 
Input 
單位時間內流入之封包總
數 
Total Services 
Port 
單位時間內伺服端通訊埠
總數 
Total 
MegaBytes 
Output 
單位時間內流出之總流量 
(以MB為流量統計單位) 
Total Packets 
Output 
單位時間內流出之封包總
數 
Total Clients 
Port 
單位時間內客服端通訊埠
總數 
Total IP 
connection 單位時間內通訊的 IP數 
 
Total Input MegaBytes：流入之總量(MB)
是指在單位時間內計算 Netflow 傳輸資料
中屬於流入之總 MegaByte(MB)數。由於
NetFlow 傳輸資料是以 byte 數做為計算單
位，為了計算方便，故我們將 byte數加總
後轉為 MB 數。許多網路異常事件之異常
特徵會表現於單位時間內的流量上，因此
對網管人員而言，所監控的網域單位時間
內的流入的流量若是過大或是過小，則表
示極有可能發生了網路異常的情況。故本
研究將此變數納為判斷是否網路異常的變
數之一。 
Total Output MegaBytes：流出之總量(MB)
 4 
(2) 
   (3) 
 (4) 
 
 本計畫中，我們以五分鐘為時間單
位，統計匯整每五分鐘表 2 的變數，並將
其視為一筆流量變化之紀錄，以建立每日
相同時刻的多變量常態模式，並藉此偵測
網路中的異常。 
 
單一樣本多變量 Hotelling’s T-Square檢定 
 
本計畫使用 Hotelling’s T-Square檢定進行
檢定是否當前網路流量有異常發生。單樣
本的 Hotelling T-Square 檢定，其假說 H0
為一向量 u等於平均向量 u0，意即在單位
時間內該流量變化屬於正常情況，反之，
其假說 H1 為一向量不等於平均向量 u0，
意即在單位時間內該流量變化屬於異常現
象。其檢定公式如(5)所示。 
   (5) 
其中，n為正常網路流量樣本大小，S-1為
該正常網路流量樣本的共變異數矩陣。 
當 時，Hotelling’s T-Square的值會近
似於 之值，如(6)所示，其中
為顯著水準 且自由度為
的 F分配。 
   (6) 
因此我們可以藉由比較T2與
之值判定是否發生異常。如果 T2 值大於
，則代表當前的網路流量落
入異常範圍，反之，則代表落入正常範圍。 
 
 
四、計畫成果自評 
 
本計畫所發展出的虛擬主機環境偵測異常
攻擊技術與相關演生的研究成果，己發表
多篇國內研討會論文，以實證角度而言，
本計畫己驗證了在實際網際網路上長期偵
測攻擊路徑的效力，若能大幅利用本研究
的成果，於學術網路骨幹上蒐集虛擬主機
環境內的 NetFlow 的流量資訊將可有效的
找出此類攻的攻擊路徑，以區域聯防的技
術有效的防阻這類攻擊的傷害。在我們進
行的計畫的過程中發覺在 2011 年網路攻
擊的 BotNet 攻擊數量突然增多，目前國
內有許多網路伺服主機仍處於這類的攻擊
的嚴重威脅之下，本計畫的研究成果相信
可以為未來防禦此類虛擬主機環境下 
BotNet 攻擊的機制提供了一個很好的基
礎，來大幅提昇防制這類網路代理人的攻
擊效力。 
 
五、參考文獻 
[1]  D. Moore, V. Paxson, S. Savage, C. Shannon, S. 
Staniford, and N. Weaver, "Inside the Slammer 
Worm," IEEE Security and Privacy, vol. 1, 2003, 
pp. 33-39. 
[2]  P. Barford and D. Plonka, "Characteristics of 
network traffic flow anomalies," IMW '01: 
Proceedings of the 1st ACM SIGCOMM 
Workshop on Internet Measurement, New York, 
NY, USA: ACM, 2001, pp. 69-73. 
[3]  G. Nychis, V. Sekar, D.G. Andersen, H. Kim, 
and H. Zhang, "An empirical evaluation of 
entropy-based traffic anomaly detection," IMC 
'08: Proceedings of the 8th ACM SIGCOMM 
conference on Internet measurement, New York, 
NY, USA: ACM, 2008, pp. 151-156. 
[4]  G. Nychis, H. Zhang, and D.G. Andersen, An 
Empirical Evaluation of Entropy-based Anomaly 
Detection, 2007. 
[5]  L. Feinstein and D. Schnackenberg, "Statistical 
Approaches to DDoS Attack Detection and 
Response," In Proceedings of the DARPA 
Information Survivability Conference and 
Exposition, 2003, pp. 303-314. 
[6]  J. Mirkovic and P. Reiher, "A taxonomy of 
DDoS attack and DDoS defense mechanisms," 
SIGCOMM Comput. Commun. Rev., vol. 34, 
2004, pp. 39-53. 
[7]  J. Jung, V. Paxson, A.W. Berger, and H. 
Balakrishnan, "Fast Portscan Detection Using 
 6 
行政院國家科學委員會補助專題研究計畫 █ 成 果 報 告   
□期中進度報告 
 
（計畫名稱） 
虛擬主機環境下的入侵偵測與防禦技術之研究 
 
 
計畫類別：□ 個別型計畫  █ 整合型計畫 
計畫編號：NSC 98－2221－E－390－021 
執行期間：民國九十九年八月一日至一百年七月三十一日 
 
計畫主持人：蕭漢威助理教授 
 
 
成果報告類型(依經費核定清單規定繳交)：█精簡報告  □完整報告 
 
本成果報告包括以下應繳交之附件： 
□赴國外出差或研習心得報告一份 
□赴大陸地區出差或研習心得報告一份 
□出席國際學術會議心得報告及發表之論文各一份 
□國際合作研究計畫國外研究報告書一份 
 
 
處理方式：除產學合作研究計畫、提升產業技術及人才培育研究計畫、列
管計畫及下列情形者外，得立即公開查詢 
          □涉及專利或其他智慧財產權，□一年█二年後可公開查詢 
          
執行單位：國立高雄大學資訊管理學系 
 
中   華   民   國 一百 年 十 月 三十 日 
 
99 年度專題研究計畫研究成果彙整表 
計畫主持人：蕭漢威 計畫編號：99-2218-E-390-003- 
計畫名稱：虛擬主機環境下的入侵偵測與防禦技術之研究 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 1 100%  
研究報告/技術報告 0 0 100%  
研討會論文 2 3 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 3 3 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
