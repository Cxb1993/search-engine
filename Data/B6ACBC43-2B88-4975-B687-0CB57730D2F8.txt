 I
摘要 
本研究計畫主要是研究單軸平台之振動主動控制方法與適用於龍門機台之多重輸入修正法，振動
主動控制採用 PID 控制法則，而輸入修正法則對架於龍門系統上之撓性鐵尺系統進行研究 ZV-ZV 法與
ZV-ZVD 法的研究。閉迴路 PID 控制器參數經由模擬設計，軌跡追蹤的有效頻寬為 0~15Hz，並可以追
上目標值 20um。在輸入修正法研究方面，使用 ZV-ZVD 法下，系統抑制殘餘振動最低可降至 5%以下，
而 ZV- ZV 法最低只能降至 7%，故 ZV-ZVD 法具有較好之抑制振動能力。若比較兩種輸入修正法於週
期變異下之強健性則可發現，當 ωn<ωa時，ZV-ZV 法之強健性相對較佳；當 ωn>ωa時，ZV-ZVD 法之
強健性相對較佳。但無論是何種輸入修正法，皆能有效降低於龍門系統上之撓性鐵尺之振動量。 
 
關鍵字：振動、主動控制、PID、輸入修正法 
 
 
Abstract 
Development of active vibration control is always an important research issue for vibration reduction on 
the advanced facilities. This method integrated with input shaping which changes the motion of gantry can 
suppress vibration of this facility rapidly, and be of great help for the technology development of these 
advanced facilities. This project is mainly to study active vibration control method on single-axis stage, and 
input shaping method on the advanced facility with gantry. PID control method is adopted as the active 
control algorithm and the parameters of close-loop PID controller are designed by computer simulation. The 
effective frequency range of signal tracking is 0 to 15 Hz, and it is able to track 20 um. On the research of 
input shaping method, the ZV-ZV method and ZV-ZVD method are studied individually on the flexible steel 
ruler on the gantry, and it is shown that ZV-ZVD method is greater than ZV-ZV method simultaneously in 
the residual vibration reduction. Moreover, to compare robust performance for the variation in period, 
ZV-ZV method is greater than ZV-ZVD method when ωn<ωa , but it is reversed when ωn>ωa. No matter what 
input shaping method is adopted, the vibration of the flexible steel ruler on the gantry can be reduced 
effectively. 
 
Keyword: vibration, active control, PID, input shaping method 
 
 2
是運用輸入修正法控制馬達運轉，使龍門到位後的振動擾動較小，參考圖二，本計畫以架於龍門系統
上之撓性鐵尺系統進行此振動抑制的實驗；再來利用撓性定位機構搭配主動振動控制來進一步抑制殘
餘振動。 
輸入修正法為一種前置補償控制方法，使用方法為針對動態系統之輸入做適當的調整，以達到改
變其輸出之效果。其概念為藉由波的疊加原理，使波產生破壞性干涉，進而相消，來達到抑制動態系
統振動的目的。一般常見的輸入修正法有Zero-Vibration (ZV) shaper及Zero-Vibration and 
Derivative(ZVD) shaper，其控制示意圖如圖三所示。ZV法將原始輸入改為相隔系統振盪半週期時間
差，強度減半的兩階段輸入，根據線性疊加原理將系統殘餘振動破壞性干涉相消，留下加減速瞬間所
產生之overshoot及undershoot，此方法可成功抑制系統的殘餘振動；ZVD法則將原始輸入改為三階段
輸入，各階段輸入之時間差仍為系統振盪的半週期，第一與第三階段輸入強度為原始輸入強度之四分
之一，第二階段輸入強度為原始輸入強度之二分之一，此方法不僅可成功抑制系統殘餘振動，更進一
步將參數不確定時殘餘振動敏感度曲線之導數降為零，因此較ZV法有更佳的強健性。利用多重輸入修
正法對架於龍門系統上之撓性鐵尺系統進行振動抑制的實驗，討論當系統使用ZV-ZV法、ZVD-ZVD
法，消除前兩個模態振動之振盪結果，並觀察各輸入修正法於撓性鐵尺運動過程中的振動狀況及其定
位能力，討論其振動抑制能力。另一方面，強健性在控制系統中佔有一定地位的重要性，若振動抑制
方法具有足夠的強健性，即使在系統參數設定有誤差時，也能保有良好的控制效能。將探討輸入修正
法對架於龍門系統上之撓性鐵尺系統對於週期變異之參數不確定的強健性，觀察各方法對此參數誤差
的容忍度。 
 
         
    圖一、Repair機台示意圖                圖二、撓性鐵尺架構於龍門移動系統之示意圖 
 
(a)                                       (b) 
     
T/2
ZV Shaper
Total
Response
Response to Each Impulse              T/2 T/2
Total
Response
ZVD
Shaper
Two ZV
Shapers
Residuals from ZV 
responses tend to cancel 
each other out
 
           圖三、輸入修正法示意圖 (a)ZV shaper (b)ZVD shaper 
 
當龍門移動停止瞬間使花崗岩平台大幅晃動時，利用主動振動控制與微米級定位機構補償鏡頭與
花崗岩平台之間的相對位移，讓影像模糊無法作業的時間縮至最短。在鏡頭組與龍門之間加入微米級
定位機構，利用感測器量測鏡頭組與花崗岩平台之間的振動量輸入控制器中，若兩者產生水平相對位
 4
台作定位控制。莊鎮文[12]設計力量估測器，並且利用了順滑模態控制器(Sliding-Mode Control)透過壓
電致動器對線性馬達對平台的振動作補償。J-C. Shen 與 W. Y. Jywe 等人[13]，利用了 PI 模型將壓電致
動器的遲滯特性消除，消除了壓電的非線性特性。但是並無法完全的將非線性特性給消除，必定殘留
一些非線性特性。因此作者再加上對系統外界干擾及系統的非線性項不確定性具有相當好的強健性之
順滑模態控制器，來增加壓電致動器的軌跡追蹤精確性，並且提高整個系統的強健性。謝銘謙[14]，目
標希望利用所使用到的控制理論，包含 PID 控制與在 PC-Based 實現的數位控制系統之設計理論，以及
嘗試使用的 N 次前饋控制理論，將 X 軸移動行程達到 260μm、Y 軸行程能達到 300μm 以上，步階定
位的一個標準差誤差 X 軸、Y 軸接控制在 40nm 以下；斜坡及循圓追蹤誤差能達到 40μm 以下。陳信
達[15]，利用 Low 及 Guo 所提出之壓電模型來進行實驗系統之系統鑑別。將 un-modeled 遲滯效應視為
系統之狀態迴授干擾，提出已函數近似為基礎之適應控制器解決此一干擾，並與 PID 控制器作一比較。
實驗結果顯示，適應性控制在加入系統輸入干擾的情況下，比 PID 控制器有更良好的軌跡追蹤能力。
另外也有基於內部模式控制器(Internal model control,IMC)之設計方法，如 Chien[16]將程序近似成一階
或二階時延模式然後靠一可調的參數來決定 PID 控制器參數。Singhose 等人[17]於 1995 年利用輸入修
正法做三次元量測儀的減振控制，其實驗結果證實可有效提高三次元量測儀之再現性(Repeatability)。
Singer 等人[18]於 1997 年利用輸入修正法作天車系統之振動抑制控制，並依照系統之運動特性設計具
備高強健性之輸入修正模式。國立成功大學陳國聲教授研究團隊陳敬元[19]於 2005 年將輸入修正法應
用於一懸臂樑系統，並結合回授控制做振動抑制；林莞慈[20]於 2007 年建立一單軸移動之雙單擺系統，
結合輸入修正法與電磁回授控制作減振控制；戴辰軒[21]於 2009 年建立可於雙軸移動之撓性單擺系
統，並由實驗應證有限元素軟體於此架構下之可行性。 
 
四、研究方法與過程: 
本計畫設計一個單軸撓性平台作為測試平台，其驅動力的來源是來自於壓電致動器，並且以雷射
位移感測器來量測平台的位移量做回授的動作。利用有限元素分析壓電驅動平台的剛性、最大位移量、
降伏應力等，完成平台分析設計後，建立系統的模型以作為往後控制器設計之用。藉由 MATLAB/SIMULINK
的協助來模擬平台加入控制器之後的響應，如定點控制、軌跡追蹤等。最後將系統做個整合，實際運
用 PID 迴授控制來控制平台來作定點控制以及軌跡追蹤。本研究利用平板式雙軸定位平台來設計壓電
微定位平台。針對所設計出來的平台，測試其平台靜態以及動態特性如最大位移、最大應力、自然頻
率、阻尼係數。規劃流程，於開迴路下，輸入步階訊號觀察平台無負載時之響應，之後加入 PID 控制
器，觀察重點在於平台的最大超越量、安定時間、穩態誤差。最後規劃一組弦波訊號運動路徑，觀察
平台軌跡追蹤能力。 
在修正法方面，實驗架構系統為將一組具有撓性之鐵尺附於龍門移動系統上，撓性鐵尺架構體需
為一可撓性佳之材料，以模擬撓性雙軸平台於龍門系統上之振動情形；此外，為避免實驗過程中之外
界干擾，造成訊號截取上之誤差，於龍門移動系統下架設氣浮隔振器系統，以隔絕外界干擾產生之振
動源。本實驗所採用的感測器為壓電式單軸加速規 752A13，置於撓性鐵尺下端，量測系統移動於鐵尺
下端造成之加速度，做為振動量測量之參考指標。整體實驗架構，考慮龍門系統做直線運動，將撓性
鐵尺利用螺絲鎖於龍門架構上，由電腦端控制龍門系統做直線運動，藉由龍門帶動撓性鐵尺，使撓性
鐵尺沿龍門移動方向自由晃動，模擬龍門系統在面板檢測時，下端檢測系統因慣性力而產生晃動的運
動情形。整體實驗流程，首先由 PC1 送出經輸入修正法設計後的輸入命令，藉以移動龍門系統，帶動
撓性鐵尺在所規劃的路徑上移動，並藉由撓性鐵尺上的加速規量測撓性鐵尺的加速度，傳輸到頻譜分
析儀，記錄加速規所量測到的振動訊號。一般的輸入修正法，只針對系統第一自然頻率做設計，以消
除系統第一模態之振動，但無法完全消除系統其他模態的振動。本實驗對系統前兩個振動模態做多重
 6
寸，平板式雙軸平台設計兩種尺寸，一個為小尺寸 10cm×10cm×0.7cm，搭配型號 PSt150/5×5/20 的致
動器，另一個為大尺寸 30cm×30cm×12cm，搭配型號 PSt150/7/60 的致動器。 
本研究著重在定位平台第一自然共振頻率與平台剛性，完成 3D 模型後利用 ANSYS 有限元素分析軟
體進行分析。材料使用 SUS304 不鏽鋼（密度 7700 kg/m3、卜松比 0.3、楊氏係數 1.9228×1011 N/m2），
在 ANSYS 設定條件裡，邊界條件的設定是定位平台四角落以 C 型夾給予固定處令為固定端，進行靜態
力分析目的為，假設我們希望平台(紅色圈圈處)移動 20um 的位移量，此時，必須找尋能推動平台的驅
動器，我們選擇科鳴PSt150/7/60來當成推動平台之驅動器，由型錄得知PSt150/7/60最大出力為1800N 
，因此，我們使用此條件(F=1800N)來得知說，當我壓電致動器出力到 1800N 時，定位平台之位移量是
否有達到我要的目標(20um)，也可由此圖六分析中得知平台剛性是否過大。 
   
 靜態增益(Ks)
0.00E+00
5.00E-05
1.00E-04
1.50E-04
2.00E-04
0 200 400 600 800 1000 1200 1400 1600 1800
力(N)
位
移
(m
)
 
圖六：大平板式雙軸（30×30×12cm）定位平台 ANSYS 靜力分析 
（左 1，2:模擬與實體條件，左 3:模擬不同條件力下平台之位移量） 
 
另外，雙軸定位平台之自然頻率也是我們所關心的要素之一，模態分析目的是要確認第一個模態
的頻率是否會在主動控制的頻率範圍內，以免影響控制效果，分析結果大平板式雙軸定位平台（30×30
×12cm）自然頻率約為 180Hz，並對大平台進行敲擊測試實驗，來驗證模態分析結果圖七。 
          
圖七：平板式大雙軸定位平台(30×30×12cm) 模態分析(左圖模擬值:180Hz，右圖實驗值:186Hz) 
 
4.2、耦合實驗測試: 
進行控制實驗之前要先測試平台的性能，主要檢查雙軸平台兩軸向的耦合情況，耦合比例越低表
示兩軸的致動器在驅動時不會互相干涉，如此在做控制時可減低控制演算法的複雜度與提高控制成效。 
另一個是檢視平台的響應波形與頻率，例如 PZT 致動器激振 10HZ 正弦波訊號時，平台上的加速規所量
到的訊號應是單純的 10Hz 正弦波，其倍頻訊號（20Hz、30Hz、40Hz…）要很小，表示雙軸平台呈線性
響應。若是雙軸平台呈非線性響應，則控制演算法難以設計無法應用在主動控制上。耦合實驗系統硬
體有：壓電致動器、雙軸定位平台、WR731A 與 752A13 加速規、壓電放大器、NI 4472(24bit)、
6014(16bit)DAQ 卡。軟體：LabVIEW 圖控程式。 
 8
)()()( tftxtx =+&τ                                       (3) 
s
sGpzt τ+= 1
1)(                                        (4) 
as
bsGpzt +=
1)(  
(4)式中τ 為時間常數。 
一階系統模型可把大多數過阻尼響應系統描述的很好，另外，我們在使用二階系統模型來描述無
阻尼響應系統。最後，我們將以實驗與模擬分析來求得模型中靜態增益 sk 、自然頻率 nω 、阻尼比ξ 、
時間常數τ ，等動態特性參數。以實驗來求取數學模型內之參數值，給予定位平台一個力量輸入，來
看平台的響應，如圖7所示，於是我們使用壓電致動器給予定位平台一個步階輸入力(產波器給振幅1v、
壓電的放大器的偏壓75v、在乘上放大倍率30倍)，並使用電容式位移計來量取位移訊號，取樣頻率為
10000HZ、取樣點數為100000點，所得到位移為max(v)-min(v)=8.6v-6.6v=2V，位移計靈敏度為1V=5um，
所以位移為10um，所測得步階響應如圖十。 
 
            
步階響應
0
1
2
3
4
5
6
7
8
9
10
5.0 5.0 5.0 5.0 5.0 5.0 5.1 5.1 5.1 5.1 5.1 5.1 5.1 5.1 5.1 5.1 5.1 5.1 5.2 5.2 5.2 5.2 5.2 5.2
時間 (t)
電
壓
(V
)
 
      圖十、步階響應測試 (左圖:實驗圖，右圖:電容式位移計所收到平台之響應) 
 
我們利用振動分析裡的對數衰減法(Logrithmic Decrement)，可求得平台的阻尼比係數約為 0.0824。由
敲擊實驗與 ANSYS 分析得知自然頻率為 Hzf 186= ， 4.1130=nω s
rad 。當 0=s 時， sstage ksG =)( ，
sksu
sy =
)(
)( ，其中， )(su 為輸入力， )(sy 為系統響應，系統的靜態增益值，此增益值能加快系統反應速
度。 61061.62 −×=sk 。時間常數τ ，可由步階響應開始至終止的 63.2%得到，時間常數τ =0.0109。所以
根據平台( stageG )以及壓電致動器( pztG )的轉移函數組合，可以知道壓電微定位平台系統的轉移函數為一
個典型的三階系統 T(s)。 
32
23
1
)(
cscscs
dGGsT pztstage +++=×=   (5) 
我們便可根據此一轉移函數 )(sT 來設計 PID 控制器，使平台響應進而達到我們的需求。接下來，
對所使用 Matlab/simulink 軟體進行模擬。首先，做開迴路步階響應模擬，並與實驗步階響應數據做
比對，因為所求得數學模型與真實的實體一定會存在誤差，做此比對，可以確認數學模型與實際的實
體誤差多少，以實驗數據為主，進而對數學模型做調整，做此比對可以增加模擬的準確性。下圖十一
架構為開迴路步階響應測試，模擬條件與前面求數學模型實驗條件相符，給予 30V 的命令，來得平台
輸出位移。 
另外，在模擬架構圖，當我下一命令(電壓值)給壓電致動器，先經過 pztG 轉移函數，我以一階來
模擬壓電遲滯的動態特性。再來是壓電靜態的部分，定位平台輸出的響應(位移)要如何移動到我們想
要的位置上呢，我們必須需要有一個力量來推動平台，使其達到我想要的響應(位移)。因此，在模擬
 10
                            
 圖十三、Z-N 頻率響應法公式 
 
4.5、定點分析: 
再加入回授與 PID 補償裝置後，也是先以定點分析來觀察，另外，靜態分析也是為了追動態目標
先前的準備，由定點響應之上升時間，便可得知在追動態目標時有效的頻寬範圍。由 Z-N method 可求
得知 01945.0=pK ， 00275.0=IT ， 0006875.0=DT 。將 PID 初始值丟入模擬架構中，觀察輸出響應(位
移) ，目標為 20um，並且改變控制器之參數，探討其各個參數對系統響應之影響。 
 
   
  
        圖十四、控制器參數對系統步階響應之影響(a)改變 Kp(b)改變 Ki(c)改變 Kd(無負載) 
 
由定點模擬觀察(圖十四)，改變 P 控制器參數，可以加快一開始的反應時間，但到達目標的時間
變慢了，必須引入 I 控制器，來有效的改善穩態誤差。改變 I 控制器參數，可以快速有效的消除穩態誤
差，但會導致過衝量產生。改變 D 控制器，增加系統阻尼，使得一開始的反應變慢，可改善過衝行為。 
 
 12
考慮參數變異於0.8~1.2間，以觀察撓性鐵尺系統在週期參數變異控制下的殘餘振動量大小。其中，ωa
為變異後套入輸入修正法之頻率值，ωn為系統自然頻率。圖十六為ZV-ZV法與ZV-ZVD法於各種變異程
度下之殘餘振動量。藉由量測撓性單擺系統在不同週期參數變異控制下的殘餘振動量大小，作出其敏
感度曲線，橫軸定義為ωn/ωa，縱軸為Performance，其定義為經過輸入修正法控制後的殘餘振動量相對
於未經控制的最大殘餘振動量之百分比，如式(9)所示: 
   Performance(%)= %100
shapingwithoutswingresidual
shapingwithswingresidual ×                        (9) 
 
  
                    
 
     圖十六 鐵尺實驗結果之殘餘振動             圖十七 輸入修正於週期變異敏感度曲線 
由圖十七知，當輸入修正使用的時間參數為自然頻率時，系統具有最小的殘餘振動，當時間參數
往0.8或1.2移動，系統殘餘振動逐漸增大。使用ZV-ZVD法下，系統抑制殘餘振動之performance的最低
點可降至5%以下，而ZV- ZV法最低只能降至7%，故考慮兩種輸入修正法，則ZV-ZVD法具有較好之抑制
振動能力。若比較兩種輸入修正法於週期變異下之強健性則可發現，當ωn<ωa時，ZV-ZV法之強健性相
對較佳；當ωn>ωa時，ZV-ZVD法之強健性相對較佳。但無論是何種輸入修正法，皆能有效降低於龍門系
統上之撓性鐵尺之振動量。 
參考文獻: 
[1] Scire. F. E. and Teague. E. C, “Piezodriven 50-μm Range Stage with Subnanometer Resolution”, Review 
of Scientific Instruments, vol.49, No.12, pp.1735-1740, 1978. 
[2] J. R. Matey, R. S. Crandall and B. Brychi, “Biomorph-driven X-Y-Z Translation Stage for Scanned 
Image Microscopy”, Review of Scientific Instruments, vol.58, No.4, pp.567-570, 1987. 
[3] N. Henmi, K. Sato, S. I. Wada, A. Shimokohbe, “A Six-Degrees of freedom Fine Motion Mechanism”, 
Mechatronics, vol.2, No.5, pp.445-457, 1992. 
[4] A. Kanai, H. Sano, J. Yoshioka and M. Miyashita, “Positioning of a 200kg Carriage on Plain Bearing 
Guideways to Nanometer Accuracy with a Force-operated Linear Actuator”, Nanotechnology, vol.2, 
pp43-51, 1991. 
[5] M. V. Shutov, D. L. Howard, E. E. Sandoz, J. M. Sirota, R. L. Smith, S. D. Collins, “Electrostatic 
Inchworm Microsystem with Long Range Translation”, Sensors and Actuators A：Physical, vol.114, 
No.2-3, pp.379-386, 2004. 
[6] 傅士澤，"奈米級微定位平台最佳化設計與分析”，碩士論文，國立中興大學機械工程所，民國 2001。 
 行政院國家科學委員會補助參與國際學術學會會議報告 
                                    九十九年 五 月十七日 
 
報告人姓名 
 
劉雲輝 
 
服務機構
 
南台科技大學機
械系 
 
職稱 
 
副教授 
 
會議正式名稱 
中文：第三屆國際動力、振動、與控制學術研討會 
英文：The Third International Conference on Dynamics, Vibration and 
Control  (ICDVC-2010) 
會 議 時 間       自 2010 年 5 月 12 日至
2010 年 5 月 14 日 
地點（國、城市） 中國、杭州 
 
三、其他 
感謝國科會計畫支助相關費用乃能順利成行，特此申致。 
 
四、攜回資料名稱及內容 
1.詳細議程 
2.論文摘要集 
3.論文集光碟片 
4.相關廠商及設備資料 
 
無研發成果推廣資料 
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
具有大型移動載具的 TFT-LCD 面板產業的精密設備，幾乎都需要同時解決地板
振動與龍門造成擾動的問題。以往國內面板設備廠幾乎都使用具有高阻尼特性
的氣墊隔振器進行地板振動隔離與龍門移動的擾動抑制，然而在提高效能的市
場需求之下，龍門移動的速度不斷提高，使得在龍門到達定位時，機台晃動更
加嚴重。本研發成果中，輸入修正法可大幅降低龍門到位之後機台搖晃到靜止
的等待時間，而主動控制技術可進一步抑制殘留振動，使得機台能更快進行影
像擷取與修補雷射對位的動作，提昇機台整體的性能表現，增強國內業者之國
際競爭力。 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
