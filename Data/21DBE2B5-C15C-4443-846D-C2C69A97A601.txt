 0 
 
 
目錄 
目錄 .....................................................................................................................0 
中文摘要 ...............................................................................................................1 
1. 前言................................................................................................................3 
2. 研究目的........................................................................................................4 
3. 文獻探討........................................................................................................5 
4. 研究方法........................................................................................................7 
5.1. 問題架構....................................................................................................7 
5.2. 資料預處理................................................................................................9 
5.3. 基因選取與規則建立模式......................................................................10 
5.4. 基因分群模式..........................................................................................13 
5.5. 決策建議與評估......................................................................................16 
5. 結論與建議..................................................................................................17 
 2 
 
ABSTRACT 
 
Biotechnology is an increasingly important industry, in which bio-chip data is a 
new data type that has not been addressed thoroughly. In particular, Biochips are 
miniaturized devices, made of glass, plastic or other materials, on which biological 
samples can be anchored (bioarrays) and/or manipulated (microfluidic processors). 
Biochips can perform up to thousands of experiments in a massively parallel, 
low-volume format, substantially reducing time and cost.  By doing so, biochips and 
systems facilitating their use can enable rapid advances in genomic research and 
healthcare diagnostics, moving medical science quickly towards the goal of improved 
delivery of individualized healthcare. Bio-chip data consists of high dimensional 
attributes that have much more attributes than specimens. According to the special 
data type, this study focuses on developing bio-chip data mining approaches and 
framework to explore the relationships of genes and diseases for medical decision 
making.  
This study aims to integrate data mining and medical decision making approach 
for developing methodologies for analyzing biochip measurement data. In addition, 
through the cooperation with Agnitio bio-tech, the proposed methodologies will be 
validated based on empirical studies. We will collect the data of the related factors in 
the micro-array of biochip and apply data mining methods to build the empirical 
model between the related factors and the targeted medical indexes. Because the 
medical decision is critical, we applied experimental design to collect the empirical 
data. We also use the constructed model to derive some of the data instead of 
collecting all real data. Furthermore, based on the data, we can identify the significant 
variables of the biochip measurements for specific disease, i.e. cancer. The study 
adopts a breast dataset from Stanford Microarray Database to validate our models. 
Through this project, we will be able to enhance the competitive advantages of 
bio-tech companies in Taiwan. 
 
Keywords: Bio-chip, Data Mining, Decision Tree Analysis, Cluster Analysis, 
microarray, Significant Analysis of Microarray 
 4 
 
2. 研究目的 
本計畫目的係研究生物晶片資料挖礦方法與技術發展，以作為後續醫療檢測
與診斷之依據。從問題定義與架構釐清基因晶片資料與其他大型資料之異同、針
對此特定資料型態進行資料預處理作業、發展系統化基因分析模式探索具價值之
資訊、再進行模式驗證及詮釋分析結果。本計畫將資料挖礦方法(data mining)
等統計分析方法運用於生物科學研究所取得之資料中，除了從生物晶片資料進行
解讀基因分析，從中探索具價值之資訊（例如：致病基因及其表現）並協助生物
晶片(microarray)研發工作者在流行病學檢測技術發展上之各項指標、危險因子
關係的判定及相關性與判讀指標(指數)之發展等參數之決策參考依據。本研究從
問題定義與架構、決策目標釐清、資料收集、資訊整理、基因分析、醫療決策分
析乃至醫生決策輔助的完整思維過程，建立解決生物晶片的檢測分析模式與決策
支援系統，提供生物晶片分析結果的數字化、系統化之決策依據。而資料挖礦此
一新興的整合學門，是一種不斷循環的資料分析與決策支援過程，主要是以自動
或是半自動的方式如：統計分析方法、決策樹、貝氏網路、集群分析、顯著性分
析（significant analysis）、機器學習（machine learning）、類神經網路、隱
藏馬可夫模式（hidden Markov model）、遺傳演算法等，從大量資料中探索和分
析，以發現出有意義的樣型（Pattern）或規則（Rule），並將其整理成有價值的
知識。生物晶片所產生的檢測資料，衍生出複雜的資料處理、分析問題與醫療決
策問題。本計畫將整合已累積的研究能量，將統計決策與資料挖礦方法引進國內
生物科技領域，並發展生物晶片資訊挖掘模式及技術。 
本計畫歸納進行基因晶片資料挖礦（data mining）時，所面臨的挑戰主要包
括：1.基因挑選（Gene Selection）：對於某特定類別挑選出最相關的基因的過程。
目前在基因挑選的方法上多是個別的評估每一個基因，並且忽略基因之間的相關
性。2.分類（Classification）：從基因表現的樣型來分類疾病或預測結果用以進行
最佳的治療方式，由於晶片資料是變數遠大於樣本數的型態，一般統計及機器學
習的方法極易因隨機變異的關係導致錯誤的發現。3.分群及視覺化（Clustering 
and Visualization）：分群的一項重要功能在於將同樣表現的基因分在同一群，然
而解釋這些分在同一群表現一致的基因卻極需要具備領域知識（domain 
knowledge），因此很難做到全自動化，另一項重點則是發掘基因網路及交互作
用。當然這些都是要以視覺化的方式呈現。4.生物學上的發現（Biological 
Discovery）：利用晶片資料分析發掘生物的知識。5.低階的分析（Low-level 
analysis）：這些分子生物上分類問題的分析方法的改善同時也等同於發展更好、
更有效的資料分析技術。所謂的低階分析指的是提供更佳的輸出數據，如更正確
可信的生物狀態估計值（Bergeron, 2002; Piatetsky-Shapiro and Tamayo, 2004）。 
本計畫擬從決策分析解構問題的角度與資料挖礦進行大量資料探索的技術
將資料挖礦與統計分析方法應用在生物晶片的資料分析，分析流程設計邏輯則首
先從降低維度的角度進行基因挑選，以決策樹分析挖掘篩選顯著影響基因並建立
 6 
 
提出一個有效率的變數選取方法。這個方法考量了兩個部分：資訊增益
（information gain）來衡量每個因素的貢獻度與相關係數（correlation）來表示因
素間的相關性。因為這兩個部分都會提供某種程度的資訊，藉由這兩者結合的最
佳資訊量，找出最重要的因素，以降低高維度數值分類的問題，藉以選取具影響
力的因素。Miyamoto et al.（2003）將變數選擇的問題定義為從候選變數集合中，
挑選出在某一分類系統下表現最佳的子集合。這個過程不僅可因減少變數量而降
低成本，同時能提供較佳的分類正確性。Chuang et al.（2004）整理變數選取的
方法，結合 6 個方法並提出一個新的研究架構，稱之為「Ranking and Combination 
analysis, RAC」。 
Khabzaoui et al.（2004）使用關聯性法則（association rule）探索基因尋找樣
型（pattern）。該篇提出一個多屬性模式的關聯法則問題並且結合基因演算法設
計及關聯性法則來處理生物晶片資料。Troyanskaya et al.（2003）提出一種使用
貝式網路整合生物資料用來做基因功能預測的網路架構（Multisource Association 
of Genes by Integration of Clusters, MAGIC），結合專家知識架構的系統、基因表
現、物理上的交互作用與生物狀況，然後根據輸出值提供一個信心水準（belief 
level）並允許使用者依其需要而變化。SØrlie et al.（2001）使用晶片資料上的基
因表現進行階層式分群（hierarchical clustering），並使用 SAM 法萃取出顯著基
因，再結合病歷資料觀察分群基因與病歷資料的關係，或觀察病歷資料（如存活
時間）依分群狀況而改變的情形。Eisen et al.（1998）使用階層式集群分析建立
基因分群並建立圖像化之演算軟體，為目前多數研究進行基因分群時使用，使用
方式為先運用其發展的 Cluster 軟體進行計算再以匯出檔案於另一圖像化軟體
TreeView 上呈現。Knudsen（2004）在其書中則提供了三個包含 Cluster 軟體的分
群軟體（另二個為 GeneCluster 與 Expression Profiler）。Jackson and Koprinska
（2002）則使用 SOM 進行基因分群並與其他 K-means、single-link、complete-link
等方法進行比較。Gets et al.（2000）認為高維度的基因資料無法一次獲得完整的
分析，採用降低變數維度與資料點的概念進行並發展其成對雙向式集群分析
（Coupled two-way clustering analysis, CTWC），並應用在結腸癌（colon cancer）
與血癌（leukemia）晶片資料中。該研究雖號稱進行集群分析，然分析過程中卻
仍使用目標集合以進行監督式分析（supervised）。Hastie et al.（2000）發展“Gene 
shaving”的演算法進行基因分群，其概念以向下分裂的劃分方法進行，起始為一
群向下切割至每個基因獨立一群，並計算每階段的第一主成份，將其他基因與第
一主成份內積最小者移除，停止法則則使用類似華德法計算 gap 統計量（群間變
異/總變異變化最大處），最後應用在包含 4673 個基因與 48 個病人的擴散淋巴瘤
（diffuse large B-cell lymphoma）實驗上。Thykjaer et al.（2001）使用階層式分群
進行膀胱癌（bladder cancer）的分析。實驗樣本包含 36 個正常組織與 29 個腫瘤
組織，並將膀胱癌區分為四種等級，首先從 4096 個基因中以平均法採用向上凝
聚方式進行腫瘤的分群，接著再挑選出正相關與負相關各 200 個基因與十個樣本
以倍差法為分群依據進行基因分群。 Herrero et al. （ 2000 ）將 SOTA 
 8 
 
 
進行基因選取與
規則建立
粗略基因選取
(SAM)
進階基因選取
(Decision tree)
刪除不顯著因子
修樹: 修剪分支
區分訓練集
與測試集資料
測試集驗證模式信度
彙整及決策參考
Yes
效度檢驗
整理顯著基因及規則
進行基因分群
資料預處理
隨機排序
剩餘基因
資料集
第i個高相
關子集
剩餘
基因
建立基因
分群表
生物晶片資料挖
礦模式
No
問題定義與
架構
問題定義
資料預處理
分析模式
模式驗證
決策建議
優先排序顯著
基因
提供顯著基因
提供其他相關基因資訊  Yes
No
F檢定分支長樹
與起始基因依序
相關係數群聚
R>門檻值 R<門檻值
停止群聚條件
(R<門檻值及群內
最少個數)
No 
 
圖二 研究架構 
 
 10 
 
餘及不需要之名目（nominal）欄位去除，如 spot、gene name、gene symbol、gene 
ID，僅保留 Accession No.（即唯一且統一的完整基因編碼），再將不需要及無效
之數值欄位去除，如 Accession No.名稱遺失。 
資料清理（data cleaning）：則對離群值、遺漏值與空白值進行處理，包含
去除離群值、刪除空白值過多的變數、進行遺漏值的補值。因此將個別 Accession 
No.遺失值過多者去除（20％遺失值，本資料集個別基因樣本遺失值超過 25 個），
不予做之後的分析。 
資料轉換（data transformation）：有時會為特定目的會將資料進行標準化、
固定在某區間內或類別變數進行重新命名。各別針對以下二個分析模式分別進行
處理：在基因選取模式中，則另外賦予目標集（即病人與正常人類別資料），將
此成對資料分別以-1, 1, -2, 2,...的 方式命名；在基因分群模式中則不需要目標
集，且須與模式一中之訓練資料一致。 
並且將經過預處理過後的資料採用比例原則將資料集隨機區分為訓練資料
集（80％）與測試資料集（20％）。以上則為本研究模式中的一般性資料預處理
步驟。 
 
5.3. 基因選取與規則建立模式 
第一階段為利用 SAM 法初步先篩選顯著的基因；第二階段則利用決策樹分
析進一步篩選基因，並建立決策規則，然後結合領域專家的經驗和知識對結果做
詮釋和解讀，以整理發掘有意義的資訊，提供相關決策和判斷之根據。並採用隨
機重複抽樣（re-sampling）的方式進行，並藉用交互驗證（cross validation）的概
念，訓練集與測試集為 80％：20％，重複抽樣 n 次以計算平均正確率，各次訓
練資料集主要用以建構生物晶片資料之決策樹模式與規則，測試集資料則用以衡
量模式效度。步驟說明如下： 
步驟 1A：以 SAM 法粗略篩選敏感（sense）基因 
首先計算各基因之相對差 id ： 
0
, 1, 2, ,ii
i
rd i p
s s
= =+ K  (1) 
2
( )
( )
j ij i
j
i
j j
j
y x x
r
y y
−
= −
∑
∑  (2) 
ijx 為樣本 j 的基因 i 表現值； jy 為樣本 j 之依變數； ir為基因 i 之線性迴歸
係數。在本研究模式中， jy 為正常人/病人成對資料，即依變數-k 與依變數 k 成
 12 
 
為了要最小化決策樹葉節點中目標變數的變異，使用降低變異準則作為分支
準則，透過卡方自動檢定對基因作進階選取，以進一步萃取有意義的基因規則。
目標變數重新定義為病人（1）或正常人（0），以 SAM 篩選後的顯著基因為分
支變數進行長樹，若基因為連續尺度，則對基因區間進行分組，並計算各組檢定
p-value 值，若大於顯著水準 α則將二組合併，直到所有組別檢定 p-value 均小於
α。將所有顯著基因作為候選分支變數，再從中選出可降低最多變異的基因作為
分支變數。 
步驟 1C：長樹與規則萃取 
若有分支變數可降低目標變數變異，則繼續進行分支，否則結束為葉節點，
反覆生長決策樹，直到所有的節點無法符合分支準則或都是葉節點。根據決策樹
分支架構與葉節點所代表的意義，每一條由根節點到葉節點的路徑可萃取出
If-Then 規則。 
在此由於變數屬性為連續變數，利用決策樹分析，使用 F 分配檢定為分支法
則，接著從步驟 1A 挖掘出的較顯著基因當做乳癌決策樹的分類子（classifier）
進行決策樹分析後，五次重複抽樣後分別得到 12、14、18、14、16 個分支解釋
率達到 90%以上之決策樹，五次分析結果各依分類表現排序如錯誤! 找不到參照
來源。至錯誤! 找不到參照來源。，聯集共得到 21 個分支解釋率 90%以上之決
策樹與顯著影響乳癌的基因及其規則，本文彙整 IF THEN 規則及其分支正確率
（判定為乳癌病人之分支）、平均正確率及模式解釋力等資訊，其中分支解釋率
以分數型式表示能更清楚顯示分支情形，括弧內之數字為該決策規則在五次重複
抽樣分析中出現之次數，如 50/50(5)為此規則 50 人為判定乳癌患者，實際患者
亦為 50 人，此規則在五次分析中出現五次；整體正確率為計算所有正確判別情
形；平均模式解釋力為單一規則在各次模式解釋力的平均表現。 
步驟 1D：模式驗證 
利用反覆 n 次之測試集資料對萃取之規則進行驗證與評估模式效度，將挖掘
出的規則套用在測驗集上，測試其平均正確率。考量在小樣本下，採用重複抽樣
方法反覆進行交互驗證評估建構模式之效度，以求取最佳決策規則及顯著基因。
驗證作法為依研究個案分別訂定決策規則正確率、偽陰性（false negative）及偽
陽性（false positive）門檻作為驗證標準（在醫學上偽陰性，即未將病人檢驗出
來較偽陽性顯得重要）。萃取通過驗證的模式之規則，解釋分析結果與規則，提
供醫學研究者參考依據；若模式驗證未通過，則刪除該筆規則或返回資料蒐集、
資料預處理步驟，重新進行資料準備，或修正分析模式及其參數，並反覆循環此
一步驟，直到模式驗證通過。 
最後將各次重複抽樣所剩餘的 28 筆資料當作測試集進行模式規則驗證，在
醫學上偽陰性，即未將病人檢驗出來比偽陽性顯得重要，根據生物晶片與生物資
訊領域知識，在模式驗證時，若偽陰性高於 10％則該規則予以刪除，若偽陽性
高於 20％時予以刪除。將測試集資料分別帶入各次分析中所挖掘出的決策規則
中，在經過驗證之後刪除項次 5、6、7、8，IF (T53121＜2,000) THEN patients、
 14 
 
層架構。演算步驟為先將表現相近的基因聚集在一起分成數大群，再個別將大群
內基因依判定停止分群法則予以停止分裂，故謂之混合式。由於基因變數數量龐
大階層式圖形不易清楚觀察分群狀況，使用表格式的呈現方式將能清楚的觀察基
因分群狀況。本模式假設任意兩變數 X, Y 為線性關係，則： 
簡單線性迴歸方程式： 0 1y xβ β ε= + +  (5) 
最小平方估計式： 1 2
( )( )
ˆ
( )
i i
i
i
i
x x y y
b
x x
β
− −
= = −
∑
∑  (6) 
依據公式(2-11)與(3-10) X
Y
Sr b
S
⇒ ∝ ⋅ ，當 X, Y 標準化後 r b⇒ ∝  
假設 2 2xy xzr r> , 1 2θ θ> , 0 / 2iθ π≤ ≤  
當斜邊為單位長度 1 時，斜率為 tan iθ , 1 2' sin , ' siny zθ θ= =  
2
1 2 1 2 3
1
sin'sin sin , tan
' sin
z
y
θθ θ θ θ θ θ> ⇔ > = =Q  
當 1 20.9 tan 1,  tan 0.78xy xzr rθ θ≤ = ≤ = < , tanθ1－tanθ3＞0 
則隱含 2 2xy yzr r> 的可能關係，從驗證資料中得出僅角度差異極小（9.5%）的違反
此關係。 
基因分群模式執行步驟如下（程式介面如圖三）： 
步驟 2A：優先排序模式一之 17 個顯著基因並亂數隨機排序剩餘基因資料訓練集
Ω（41,664 個基因）。 
步驟 2B：設定相關係數門檻值 α。 
步驟 2C：與起始基因相關係數超過 α者群聚為子資料集 Group 1；並產生剩餘資
料集。 
步驟 2D：亂數隨機排序剩餘資料集。 
步驟 2E：執行迴圈，重複步驟 2B、2C，產生 Group k 及剩餘基因資料集 kΩ ，
反覆搜尋至 k＝n 停止。 
步驟 2F：設定群內最少個數 β。 
步驟 2G：亂數隨機排序 Group k，執行步驟 2E。 
如單獨使用本基因分群模式時，無參考之顯著基因，則隨機排序資料集。 
 
 16 
 
 
經模式分析後，以 Level 1 為例，群數為 16,819，部份分群結果如表三三。
分群結果儲存於 Excel 檔案中，因此使用者得以方便觀察分群情形以及快速輸入
特定欲觀察之基因與同群基因。 
結合模式一探索出的顯著基因與模式二的分群結果，本研究發現顯著基因
R95691、AA701996、AI001134、W01204 與其他 57 個基因被分在同一群（Group 
3）；H79533 與 AA995045 在 Group 4；T98611 與 AI679372 和其他 16 個基因為
同一群（Group 6）；AI923787 與 H52245 和其他 17 個基因為 Group 10。在模式
一中的 17 個顯著基因中，共有 9 個基因表現呈現相互高相關。 
此外，由於分群狀況取決於相關係數值的設定與初始排序，除前述案例參數
設定，本研究從 r＝0.8~0.9 共執行 5 次實驗，各次分群部分結果如表四 ，比較
結果如表四。另外，本研究為觀察步驟 2A 之優先排序顯著基因的影響，以不優
先排序顯著基因的方式，採用完全隨機排序執行分析以進行差異比較，部分分群
結果如表 。Level 1 的群數仍然為 16,819，以 T98611 為例，仍然與 AI679372 分
在同一群；AI923787 與 H52245 亦是。 
表四 不同參數設定分群狀況表 
Threshold # of groups # of maximum group
0.80 7,524 1,364
0.82 10,428 829
0.85 16,819 331
0.87 22,430 223
0.90 31,872 79
 
5.5. 決策建議與評估 
在本生物晶片料挖礦模式中，模式一挖掘出 17 個顯著基因及其判定規則，
其效度與驗證信度均極高，模式一所尋找出的基因可做為模式二的先期資訊；模
式二則以拋磚引玉的角度，鑑於現行電腦科技的限制提出一個初期運算模式，在
此扮演的角色為提供分析者更多觀察的資訊，分析者除可根據模式一的 17 個顯
著基因進行乳癌檢測亦可進一步觀察與其相關之其他基因在醫學上的意義。兩模
式亦可獨立單獨執行。從模式二的分析中可發現在模式一中的顯著基因許多均被
分在同一群，顯示顯著基因彼此之間呈現高相關，然模式中的參數設定端視專家
的專業判斷，專家更可依其判斷或優先選取亦欲觀察的特定基因以提高分析正確
性。 
 18 
 
參考文獻 
大石正道（2002），圖解人類基因組的構造，世茂出版社，台北。 
王道還（2003），「人類基因組計畫完成了」，科學發展，第 365 期，頁 76。 
王鴻儒、簡禎富、李培瑞、徐紹鐘（2002），「決策樹資料挖礦架構及其於半導體
製程之實證研究」，科技管理學刊，第 7 卷，第 1 期，頁 137-160。 
公共電視出版社（2006），「DNA 時代」VCD。 
吳文騰（2003），生物產業技術概論，清大出版社，新竹。 
何國傑、葉開溫、鄭石通、靳宗洛（2001），基因工程與生物技術概論-基因選殖
及 DNA 分析，藝軒圖書出版社，台北。 
江晃榮（2003），經濟巨人 Bio-生物科技的千億商機，世茂出版社，台北。 
台灣大學莊榮輝教授，http://140.112.78.220/~juang/JRH/biotech.htm/。 
耿直、鄔宏潘、謝邦昌、趙雅婷、蘇志雄（2003），生物醫學統計學-理論與資料
分析應用，鼎茂圖書出版有限公司，台北。 
莊慧明（2002），「生物晶片」，產業調查與技術季刊，第 141 期，頁 2-25。 
陽明大學生物晶片資訊站，http://binfo/.ym.edu.tw/binfo/。 
經濟部工業局，「兩兆雙星推動計畫」，http://www.moeaec.gov.tw/。 
簡禎富（2005），決策分析與管理: 全面決策品質提升之架構與方法，雙葉書廊，
台北。 
簡禎富、吳文婷（1997），「醫療決策分析：以唐氏症之診斷為例」，醫療資訊雜
誌，第 6 期，頁 39-53。 
簡禎富、林鼎浩、徐紹鐘、彭誠湧（2001），「建構半導體晶圓允收測試資料挖礦
架構及其實證研究」，工業工程學刊，第 18 卷，第 4 期，頁 37-48。 
簡禎富、李培瑞、彭誠湧（2003），「半導體製程資料特徵萃取與資料挖礦之研究」，
資訊管理學報，第 10 卷，第 1 期，頁 63~84。 
簡禎富、林鼎浩、劉巧雯、彭誠湧、徐紹鐘、黃佳琪（2001），「建構晶圓圖分類
之資料挖礦方法及其實證研究」，工業工程學刊，第 19 卷，第 2 期，頁 23-38。 
簡禎富、蕭禮明、王興仁（2004），「建構半導體製造管理目標層級架構與製造資
料之資料挖礦」，工業工程學刊，第 21 卷，第 4 期，頁 313-327。 
簡禎富、王興仁、陳麗妃（2005），「利用資料挖礦提升半導體廠製造技術員人力
資源管理品質」，品質學報，第 12 卷，第 1 期，頁 9-28。 
簡禎富、林國勝（2006），「建構 cDNA 生物晶片之二元資料挖礦模式及其實証
研究」，資訊管理學報，第 13 卷，第 4 期，頁 133-159。 
Aczel, A. D., and J. Sounderpandian, (2002), Complete Business Statistics, 
McGraw-Hill Companies, Boston. 
Baldi, P., and S. Brunak, (2004), Bioinformatics: The Machine Learning Approach, 
The MIT Press, London. 
Bergeron, B., (2002), Bioinformatics Computing, Prentice Hall, New Jersey. 
 20 
 
Bostein, and P. Brown, (2000), “Gene shaving as a method for identifying 
distinct sets of genes with expression patterns,” Genome Biology, Vol. 1, pp. 
1-21. 
Herrero, J., A. Valencia, and J. Dopazo, (2001), “A hierarchical unsupervised growing 
neural network for clustering gene expression patterns,” Bioinformatics, Vol. 17, 
pp. 126-136. 
Higgins, J. J., (2004), An Introduction to Modern Nonparametric Statistics, Duxbury 
Press, Belmont. 
Jackson K., and I. Koprinska, (2002), “DNA Microarray Data Clustering Using 
Growing Self Organizing Networks,” Proceedings of the 9th International 
Conference on Neural Information Processing, Vol. 2, pp. 805-808. 
Khabzaoui, M., C. Dhaenens, and E. Talbi, (2004), “A Multicriteria Genetic 
Algorithm to analyze DNA microarray data,” Proceedings of the Fourth IEEE 
Symposium on Bioinformatics and Bioengineering, pp. 1874-1881. 
Kass, G. V., (1980), “An exploratory technique for investigation large quantities of 
categorical data,” Applied Statistics, Vol. 29, pp. 119-127. 
Knudsen, S., (2004), Guide to Aanlysis of DNA Microarray Data, John Wiley & Sons 
Inc, New Jersey. 
Kristina, A. K., and L. A. Salter, (2004), “A comparison of methods for estimating the 
transition: transversion ration from DNA sequences,” Molecular Phylogenetics 
and Evolution, Vol. 32, pp. 495-503. 
Lesk, A. M., (2002), Introduction to Bioinformatics, Oxford University Press, New 
York. 
Liang, M. Y., A. G. Briggs, E. Rute, A. S. Greene, and A. W. Cowley, (2003), 
“Quantitative assessment of the importance of dye switching and biological 
replication in cDNA microarray studies,” Physiological Genomics, Vol. 14, No. 3, 
pp. 199-207. 
Matsuya, T., K. Otake, S. Tashiro, N. Hoshino, M. Katada, and T. Okuyama, (2006), 
“A new time-resolved fluorometric microarray detection system using 
core-shell-type fluorescent nanosphere and its application to allergen 
microarray,” Analytical and Bioanalytical Chemistry, Vol. 385, No. 5, pp. 
797-806. 
Miyamoto, T., S. Uchimura, H. Yoshihiko, N. Iizuka, M. Oka, and Y. Yamada-Okabe, 
(2003), “Comparative study of feature selection methods on microarray data,” 
IEEE EMBS Asian-Pacific Conference on Biomedical Engineering, pp. 82-83. 
Mukherjee, S. N., (2003), “Gene ranking using bootstrapped P-value,” Knowledge 
Discovery and Data Mining, Vol. 5, No. 2, pp. 16-22. 
Nadimpally, V., and M. Zaki, (2003), “A Novel Approach to Determine Normal 
 22 
 
of the National Academy of Science of the United States of America, Vol. 98, No. 
19, pp. 10869–10874. 
Thykjaer, T., C. Workman, M. Kruhøffer, K. Demtro¨der, H. Wolf, L. D. Andersen, C. 
M. Frederiksen, S. Knudsen, and T. F. Ørntoft, (2001), “Identification of Gene 
Expression Patterns in Superficial and Invasive Human Bladder Cancer,” Cancer 
Research, Vol. 61, pp. 2492-2499. 
Troyanskaya, O., K. Dolinski, A. Owen, R. Altman, and D. Botstein, (2003), “A 
Bayesian framework for combining heterogeneous data sources for gene function 
prediction (in Saccharomyces cerevisiae),” Proceedings of the National Academy 
of Science of the United States of America, Vol. 100, No. 14, pp. 8348–8353. 
Tusher, V., R. Tibshirani, and G. Chu, (2001), “Significance analysis of microarrays 
applied to the ionizing radiation response,” Proceedings of the National Academy 
of Science of the United States of America, Vol. 98, No. 9, pp. 5116–5121. 
Welm, A. L., J. B. Sneddon, C. Taylor, D. S. A. Nuyten, and M. J. Vijver, (2007), 
“The macrophage-stimulating protein pathway promotes metastasis in a mouse 
model for breast cancer and predicts poor prognosis in humans,” Proceedings of 
the National Academy of Science of the United States of America, Vol. 104, No. 
18, pp. 7570–7575. 
Wu, Y., and A. Zhang, (2004), “Feature Selection for Classifying High-Dimensional 
Numerical Data,” Proceedings of the 2004 IEEE Computer Society Conference 
on Computer Vision and Pattern Recognition, pp. 251-258. 
Yun, H., D. Ha, B. Hwang, and K. Ryu, (2003), “Mining association rules on 
significant rare data using relative support,” The Journal of System and Software, 
Vol. 67, pp. 181-191. 
Zelditch M., D. Swiderski, D. H. Sheets, and W. Fink, (2004), Geometric 
Morphometrics for Biologists, Academic Press, New York. 
 
資訊管理學報 第十三卷 第四期 133 
 
建構 cDNA生物晶片之 
二元資料挖礦模式及其實證研究 
 
簡禎富 
清華大學工業工程與工程管理學系 
 
林國勝 
清華大學工業工程與工程管理學系 
 
摘要 
生物晶片之基因微陣列技術（microarray）及基因選殖技術（gene cloning）的突
破，加上資訊科技的進展能力，使得生物科技和生物晶片的研究和應用在過去十年有
非常蓬勃的發展，也因而衍生許多資料處理和分析的問題亟待克服，特別是生物晶片
資料變數多而樣本數少的問題。本研究目的係針對 cDNA 生物晶片之二元資料的特
性，發展生物晶片資料挖礦（Data Mining）方法和模式藉以探索與尋找疾病與特定基
因的關係，並建構其規則以作為醫療診斷決策支援參考。本研究並採用史丹佛大學晶
片資料庫中乳癌晶片資料以驗證研究效度，從四萬多個基因與 64個樣本當中，使用顯
著性分析（Significant Analysis of Microarray）與決策樹（Decision Tree）挖掘出具影
響力的基因及診斷決策規則，從中萃取有價值之資訊，研究結果可以驗證本研究所提
出之方法的效度。 
 
關鍵字：生物晶片、資料挖礦、決策樹、微陣列技術、顯著性分析 
 
建構 cDNA 生物晶片之二元資料挖礦模式及其實證研究 135 
 
壹、緒論 
生物晶片一次就能夠紀錄成千上萬個基因表現的樣型（gene expression pattern），
再以光學儀器掃描檢測結果轉換成數據（numerical data）加以分析，已經根本地改變
了醫療檢測的方式。在醫學上的應用，若能將人類基因機能加以推測，並將各個族群
加以分類的話，必能更準確地得知各項機能；或者不同的基因表現用來區別不同的腫
瘤型態；亦可藉此研發出和以往化學結構與作用機制完全不同的新藥，觀察或預測用
藥後的成果及反應；並且可與臨床診斷結合發展特定的療法。目前同一種疾病的醫療
方法及藥物都是相同，所以有時會發生同種症狀的不同病人產生不一樣的結果。主要
原因是因為每個人身上的基因結構並非完全相同，未來基因的謎團逐漸解開之後，醫
生就可依據每個人的基因表現或特色進行診斷及醫療行為決策。 
目前正在發展將資訊和生物統計理論有效應用於分析生物晶片資料上，根據美國
國家衛生院（NIH）定義：生物資訊是一門資料蒐集與運用的學科，它是一門將數學、
統計、資訊科學、人工智慧等理論與技術運用於生物科學研究所取得之資料中，以有
效地得到顯著成果的學科。生物基因晶片之基因微陣列技術的突破與電腦資料處理和
計算的能力，加速了基因研究的速度，也因而衍生許多資料處理和分析的問題亟待克
服。從生物晶片上記錄下來的龐大基因資料，使得生物資訊的資料取得、收集、整理、
除錯、建檔及分析成為相當複雜的工作，要從中找出有意義的規則或樣型，更需要整
合生物統計、資料挖礦分析與資料處理技術，將原始序列資料或晶片資料轉為有用的
知識，以突破資料分析理論限制，並更有效且快速的做有系統的整理解讀和分析。 
本研究歸納進行基因晶片資料挖礦（data mining）時，所面臨的挑戰主要包括：
1.基因挑選（Gene Selection）：對於某特定類別挑選出最相關的基因的過程；2.分類
（Classification）：從基因表現的樣型來分類疾病或預測結果用以進行最佳的治療方
式，由於晶片資料是變數遠大於樣本數的型態，一般統計及人工智慧的方法極易因隨
機變異的關係導致錯誤的發現（Bergeron, 2002）。 
本研究目的係研究生物晶片資料挖礦方法與技術發展，並以史丹佛大學生物晶片
資料庫中的乳癌資料集進行實證研究，以驗證本研究模式之效度。因此，本研究擬從
問題定義與架構、資料預處理、基因分析模式、模式驗證及詮釋的完整分析過程，建
立 cDNA生物晶片之二元資料挖礦模式，從生物晶片資料進行基因分析解讀，探索具
價值之資訊、判定危險因子關係與發展分析模式，提供生物晶片數字化、系統化的分
析，以作為後續醫療檢測與診斷之依據。 
本文架構說明如下：第一節敘述分子生物學與基因工程當今的發展、所面臨的問
題與其特殊的資料型態。第二節介紹生物晶片與生物資訊，並回顧其相關研究與資料
挖礦理論基礎。第三節提出 cDNA生物晶片之次元資料挖礦模式。第四節以史丹福大
學生物晶片資料庫中的乳癌資料集進行實證研究，以檢驗本研究所建構的模式的效
度。第五節討論本研究貢獻和限制，並探討未來研究方向。 
建構 cDNA 生物晶片之二元資料挖礦模式及其實證研究 137 
 
性，拓展快速有效的 DNA 定序技術，以及生物晶片的產生使研究者得以同時觀察數
以萬計的基因表現，加速基因研究的速度及範圍。 
生物資訊所涵蓋的對象包含 DNA、RNA、mRNA、cDNA、Protein secondary structure
等，從標的萃取、複製技術到晶片製程品質、雜交實驗的 DNA 濃度，到最後判讀數
據的分析等皆影響資料分析的結果。 
半導體設計與製造技術已成功引進到生物晶片上，發展出包括目前最廣泛的
Affymetrix，使得微陣列晶片更加縮小且涵蓋更多的點。針對不同半導體的問題，已
發展具體有效的資料挖礦方法，包括事故診斷（Chien et al., 2002）、良率提升（簡禎
富等，2003）、生產效率（簡禎富等，2004），及人力資源管理（簡禎富等，2005）等
相關分析。 
二、生物晶片資料分析相關研究 
生物晶片資料的特性就是高維度而樣本數卻很少。因此基因挑選可視為一個困難
的變數挑選（Feature selection）的問題。Tusher et al.（2001）使用實驗設計的方式以
不同細胞、基因、實驗組及對照組觀察基因的檢測值是否會因輻射而變化，使用顯著
性分析法(Significant Analysis of Microarray; SAM)，SAM法類似統計 T檢定以相對差
異是否顯著，說明依照不同準則分組下，何種準則具有顯著差異，以證明輻射會影響
細胞及基因的量測值，並且以錯判率驗證 SAM 法表現較傳統的倍差法(Fold change 
method)有效。Mukherjee et al.（2004）提出拔靴法的基因排列演算法解決小樣本的 T-
統計量變異的有效方法，用來尋找基因與發病的關係，由於本類問題的特性即是樣本
數小，因此作者採用拔靴法創造資料量，再以此人工資料集進行 T檢定並將具影響力
之基因排序。同樣 Chen（2003）提出一個系統化的方法用來選取癌症分類的基因集合，
利用基因演算法及支援向量機演算法(Support Vector Machines; SVM)進行基因分類，
目標是選出能判別不同的樣本來自於不同類別的基因並藉由 SVM 來評估其判別力；
基因演算法則是用來尋找最佳的子集；拔靴法則是用來創造資料以克服小樣本的難
題，最後利用基因演算法得到的候選基因集合計算個別基因出現的次數當作顯著基因
的說明。Wu和 Zhang（2004）提出一個有效率的變數選取方法，稱為因素重要度。這
個方法考量了兩個部分：資訊增益（information gain）來衡量每個因素的貢獻度；與
相關係數（correlation）來表示因素間的相關性。因為這兩個部分都會提供某種程度的
資訊，藉由這兩者結合的最佳資訊量，找出最重要的因素，以降低高維度數值分類的
問題，藉以選取具影響力的因素。Miyamoto et al.（2003）將變數選擇的問題定義為從
候選變數集合中，挑選出在某一分類系統下表現最佳的子集合。這個過程不僅可因減
少變數量而降低成本，同時能提供較佳的分類正確性。首先採用倍差法找出基因表現
值在 A、B 群差異大於二倍者；依照 Fisher criterion 選取最佳的 50 個；從這 50 個中
反覆搜尋選出最理想的 d個（ 50dC 次）。Chuang et al.（2004）整理變數選取的方法，區
分為：(1)參數法：利用統計方法辨別基因對於類別間的差異的影響，並給予分數。這
些方法皆奠基於假設這些資料都具備同樣的分配；(2)無母數法：使用排序結果進行分
建構 cDNA 生物晶片之二元資料挖礦模式及其實證研究 139 
 
三、資料挖礦技術 
資料挖礦是一種不斷循環的資料分析與決策支援過程，主要是以自動或是半自動
的方式如：統計分析方法、決策樹、貝氏網路（Bayesian Network）、集群分析
（Clustering）、機器學習、類神經網路（Neural Network）等，從大量資料中探索和分
析，以發現出有意義的樣型（pattern）或規則（rule），並將其整理成有價值的知識（簡
禎富等， 2001）。因此在整個分析過程當中，資料挖礦是屬於探索導向
（Discovery-Driven），並非假設導向（Assumption-Driven）；資料挖礦模式是由相關實
證資料推導的（Empirically Derived）而非理論架構。首先了解應用領域，包含相關且
具有價值的知識以及應用的目標。建立目標資料集，選擇一個適合分析的資料集或是
相關變數之子集。然後進行資料預處理作業以去除混雜其中的不相關資料及清理、合
併、分箱等去蕪存菁的方式轉化處理，以確保分析資料的品質和分析結果的正確性，
或是將資料投射和簡化以轉換成適於應用分析目標的格式。接著選擇合適的資料挖礦
的工具，推導資料挖礦演算法及分析模式。最後與領域專家合作透過闡釋將探索出的
資訊以一種可以被確認、觀察和再使用的形式呈現，而使決策者能夠理解，並將這些
所得有價值的資訊實際應用於現實系統上，以確認這些知識的價值性。 
資料挖礦在銀行業、商業行為及工業等有許多成功案例，如製程良率提升（Yield 
Enhancement）或錯誤偵測（Fault Detect & Classification）等均有良好的成效（Chien et 
al., 2007）。然而這些案例一般來說都是具有大量的資料（或紀錄）及遠小於資料量的
變數（或屬性）；相反地，生物晶片資料由於樣本蒐集的困難性和實驗成本的關係，卻
是極少量的資料（大多是數十到數百筆）卻擁有大量的變數（即由數千到上萬基因所
構成）。既有的資料挖礦方法並不能直接用來分析生物晶片的資料。因此，本研究針對
資料特性發展更適合分析生物晶片資料的架構和模式。 
由於挖掘目標和問題不同，配合所使用的挖掘工具，可得到不同類型的挖掘結
果，資料挖礦結果的類型包括：關連規則（Association Rule）、分類（Classification）、
聚集（Clustering）、預測（Prediction）。資料挖礦藉由使用不同的工具來執行，如：貝
氏網路、決策樹、統計方法、類神經網路、遺傳演算法等。其中，決策樹（Decision Tree）
在資料挖礦的領域裡通常扮演監督式特徵萃取與描述的角色，解決分類型態的問題。
透過變數的選擇與目標（target）的指定對資料進行分類而成樹枝狀的架構。對於資料
挖礦之主要用途是能夠將輸入變數依據某種規則或資料特性對資料進行分類，並以樹
枝狀方式表現類別之間由輸入變數所造成的區別，故藉由決策樹的分析規則可對資料
進行層級架構的分類。利用訓練完成的決策樹架構，亦可對資料進行比較或預測分析。
決策樹是一個廣泛應用來架構決策問題的工具，應用於資料挖礦之主要功能在於能夠
將輸入變數依據某種規則或方法對資料進行分類，並以樹枝狀方式表現出來，進而挖
掘出顯著影響結果的因子，故可以藉由決策樹的分析規則對資料進行層級架構的分類。 
目前相關研究採用諸多啟發式演算法進行資料分析，生醫工作者在判定某基因是
否顯著的典型簡易處理方式如公式(1)，將實驗組病人在基因 i 的表現平均值除以對照
建構 cDNA 生物晶片之二元資料挖礦模式及其實證研究 141 
 
1993)等，如表 2 所示。CHAID 採用統計的卡方檢定作為分支依據，因此用作處理非
連續型變數資料是一個有效的演算法，所以若是資料型態為連續型變數則須先行處理
將資料離散化；CART 是二元分類法則的決策樹，其分類法則為最小化錯分率
（Gini-index），可處理連續型或離散型態的資料；ID3 則以熵度（Entropy）為分類法
則，可處理連續型或離散型態的資料；而 C4.5則是採用 Gain-ratio為其分支法則，可
處理連續型或離散型態的資料，進一步之整理比較可參考表 2。假設有癌症病人 15筆
基因資料紀錄以及對照組正常人資料 15筆，經決策樹分類後發現當 Gene 1>2000時可
清楚區分出病人/正常人，如圖 2所示。 
 
癌症基因資料
N:30
Normal
N:2
Patient
N:14
Normal
N:13
Patient
N:1
Gene1>2000Gene 1<2000 
 
圖 2：決策樹示意圖 
 
為了因應生物醫藥的資料型態，各種新的資料庫結構也相繼出現，這些資訊系統
被設計來管理並收集生物晶片的資料。生物晶片所產生的大規模實驗資料，衍生出複
雜的資料處理問題。對於這些大量且複雜的資料，資料挖礦將可提供快速且正確的分
析方法。 
建構 cDNA 生物晶片之二元資料挖礦模式及其實證研究 143 
 
一、問題定義與架構 
生物晶片萃取基因表現的方式，是以微陣列製備儀（Arrayer）放置人類或生物的
單股基因探針，由實驗組抽取出標地核酸，以紅色螢光劑標示，同時將標地核酸對照
組以綠色螢光劑標示，將兩組標地核酸均勻混合後，再與已放置基因探針的玻璃片進
行雜交反應，經螢光掃瞄儀分析後，若玻璃片上某些探針點位置只出現紅色亮點，則
表示該基因只有在實驗組會表現，而正常人並沒有表現；反之，則表示該基因只有在
正常人會表現，而在病人並沒有表現。各個基因表現從頻譜變化顏色轉換後的數據顯
示之（如圖 4所示），然而實驗數據的變化除了受個別基因的影響，尚受到其他干擾因
素的影響，本研究整理干擾實驗數據的因素，以實驗準備面、設備面及數據面將變異
區分如表 3。因此，一次的實驗中，即可獲得實驗組與對照組的所有基因表現報告。 
 
 
圖 4：生物晶片分析示意圖（資料來源：本研究整理） 
 
一片生物晶片可同時解析出上千種基因表現，龐大的資料和數據，若未經更進一
步的資料的處理和分析，將無法從中發現哪些基因將會導致致病因子的產生。目前一
片晶片的價格可能高達 500美金，使得資料蒐集不易，受測者的樣本數往往遠小於實
驗變數個數，不僅增加了生物晶片分析的困難度，更遑論檢視各個基因彼此之間的交
互作用。本研究針對生物晶片上 Cdna 之二元資料發展資料挖礦理論模式，從中刪除
不敏感之基因並擷取可能具影響力之基因，並從分析過程中獲得有意義之樣型或歸納
出規則，搜尋出基因在正常人與病人不同的表徵，以及藉由了解基因與致病因子之間
的關聯，以提供醫學研究者針對特定的疾病或症狀下判斷之依據。 
建構 cDNA 生物晶片之二元資料挖礦模式及其實證研究 145 
 
三、生物晶片資料之決策樹建構 
針對生物晶片資料不易蒐集，量測基因眾多的特性，一般變數投影轉軸方式無法
處理，因此，本研究整合 SAM 法及決策樹分析，建構生物晶片資料基因之決策樹架
構。先利用 SAM 法進行以初步挖掘較顯著的基因；接下來採用資料挖礦的決策樹方
法找出對模式具顯著影響的基因，並進一步建立決策規則。具體步驟敘述如下：  
步驟一：以 SAM法粗略篩選敏感（sense）基因 
根據基因表現值在不同狀態下之差異，利用重複量測及差異標準化的方式，給定
各基因相對評分，超過類似 T 檢定值彈性調整接受範圍之基因，判定該基因變化具統
計顯著差異，最後利用不同樣本之排列與重複量測的方式評估各基因之鑑別率
(FDR)。由於基因表現值的變動對基因具專一性，首先定義各基因之相對差 id ： 
pi
ss
rd
i
i
i ,...2,1,
0
=
+
=  (4) 
∑
∑
−
−
=
j
jj
j
iiji
i yy
xxy
r 2)(
)(
 (5) 
ijx 為樣本 j 的基因 i表現值； jy 為樣本 j 之依變數； ir為基因 i 之線性迴歸係數 
在本研究模式中， jy 為正常人/病人成對資料，即依變數-k 與依變數 k 成對，
},,...2,2,1,1{ KKy j −−−∈  
∑ −=
j
jj
i
i
yy
s
2)(
σˆ  (6) 
2
)ˆ(
ˆ
2
−
−
=
∑
n
xx
j
ijij
iσ  (7) 
jiiij yrx += 0ˆˆ β  (8) 
jiji yrx −=0βˆ  (9) 
is 為 ir之標準誤； iσˆ 為殘差均方誤 
)(id 為由基因的相對差異（relative difference）順序統計量（order statistic），而 )(id
為 )(id 平均。選定適合之門檻值△。對大部分基因 ii dd ≅ ，若基因兩者間差異大於設定
之門檻者，則判定為具顯著差異。為了預估 SAM 可能誤認之顯著基因數，以所有判
定顯著基因之最小 )(id 與所有被抑制基因之最大之負 )(id 為水平界線，計算對於各排列
所得超出界線之基因數之誤認數，最後以各組排列之平均為預估之誤認數。SAM法可
有效而簡易的過濾在各生物狀態具差異之基因，並提供篩選出之各基因其鑑別率資
訊，以彈性縮小進行深入分析的範圍。 
建構 cDNA 生物晶片之二元資料挖礦模式及其實證研究 147 
 
針點）與病人、非病人各一位樣本，反應後所得之表現值，總計 64筆晶片資料分別儲
存於 64 個 EXCEL檔中，每個原始檔案約包含 46,000 乘 64 個儲存格，部份原始資料
如表 4，表 4 為編號 18195 晶片資料，每列為各個不同基因，每欄表示各個基因不同
表現值，包含基因名稱、座標、基因強度表現等等，共 128筆樣本生病與非生病各半，
如 Spot 為探針流水編號、Accession 為基因名稱，而 Ch1/Ch2 Net 之數值為各基因相
對應之正常人/病人基因強度表現。因此可獲得 64 片晶片資料的 64 位病人在 45,696
個基因的晶片表現值；及其對照組 64位正常人在 45,696個基因的晶片表現值。 
針對本組基因晶片的資料，從中刪除不敏感之基因並擷取可能具影響力之基因，
並從分析過程中獲得有意義之樣型或歸納出規則，以提供醫學研究者對於先期判斷乳
癌之依據或後續研究之參考。因此首先決定須分析變數為表 4 中基因名稱(Accession 
No.)、CH1 Net、CH2 Net分別為正常人與病人之基因表現，並根據本資料特性和問題
特徵擬定假設以進行分析，假設實驗來自同一批製程下之晶片且實驗進行為同樣的時
間及環境，並假設基因 i在病人/正常人來自機器及實驗的變異是隨機變異且相同，再
進行資料預處理動作。 
表 4：生物晶片原始資料表 
 
 
二、資料預處理 
資料的預先處理包含無效屬性刪除、資料整合或解構、遺失值的填補等，可以提
高分類過程的準確性和效率性，本研究並不盲目的將所有的資料皆放進模式分析，而
事先將資料以去蕪存菁的方式轉化處理，以確保分析資料的品質和結果的正確度。首
先整理各別晶片資料(subset)將冗餘及不需要之名目（nominal）欄位去除，如 spot、gene 
name、gene symbol、gene ID，僅保留 Accession No.（即唯一且統一的完整基因編碼），
再將不需要及無效之數值欄位去除，如Accession No.名稱遺失。再將個別Accession No.
遺失值過多者去除（20%遺失值，本資料即遺失值超過 25 個），不予做之後的分析。
建構 cDNA 生物晶片之二元資料挖礦模式及其實證研究 149 
 
三、生物晶片資料之決策樹建構 
步驟一：將處理過之病人與非病人各 64 筆資料所彙整之資料表，任意成對挑選
出各 50筆共 100筆作為訓練資料，剩餘各 14筆共 28筆做為最後驗證用資料，並重複
抽樣五次。設定門檻值 =3△ 。分析後分別得到 11,104、12,829、13,219、12,770、13,745
個較顯著基因，部分分析結果如表 6 及圖 6。表 6為經 SAM分析後顯著基因列表，紅
色顯示為超過管制線之基因，反之為綠色，Score(d)、Numerator、Denominator則分別
為公式(3)之 d 值、分子、分母值。圖 6 為基因表現散佈圖，超過上下二條管制線者判
定為顯著基因。表 6 則列出各個顯著基因及其檢定值。 
 
SAM Plotsheet
-20
-15
-10
-5
0
5
10
15
-3 -2 -1 0 1 2 3
Expected Score
Ob
ser
ve
d S
co
re
圖 6：部分 SAM之 ( )d i  vs. ( )Ed i 散佈圖 
表 6：SAM分析結果（部份） 
 
建構 cDNA 生物晶片之二元資料挖礦模式及其實證研究 151 
 
All Data
50
50
100
 50%
 50%
100%
0 to 5000
2
50
52
  4%
 96%
100%
AA233079
5000 or greater
48
-
48
100%
-
100%
 
All Data
50
50
100
 50%
 50%
100%
0 to 2000
2
50
52
  4%
 96%
100%
W56522
2000 or greater
48
-
48
100%
-
100%
 
All Data
50
50
100
 50%
 50%
100%
0 to 2000
2
50
52
  4%
 96%
100%
AI001134
2000 or greater
48
-
48
100%
-
100%
 
All Data
50
50
100
 50%
 50%
100%
0.000000 to 4000.0...
2
50
52
  4%
 96%
100%
AI375135
4000.000000 or gre...
48
-
48
100%
-
100%
 
All Data
50
50
100
 50%
 50%
100%
0.000000 to 2000.0...
50
2
52
 96%
  4%
100%
AI923787
2000.000000 or gre...
-
48
48
-
100%
100%
All Data
50
50
100
 50%
 50%
100%
0.000000 to 2000.0...
50
2
52
 96%
  4%
100%
H52245
2000.000000 or gre...
-
48
48
-
100%
100%
All Data
50
50
100
 50%
 50%
100%
0 to 2000
2
50
52
  4%
 96%
100%
W01204
2000 or greater
48
-
48
100%
-
100%
 
All Data
50
50
100
 50%
 50%
100%
0 to 2000
49
1
50
 98%
  2%
100%
AA486362
2000 or greater
1
49
50
  2%
 98%
100%
All Data
50
50
100
 50%
 50%
100%
0 to 1000
49
1
50
 98%
  2%
100%
H12338
1000 or greater
1
49
50
  2%
 98%
100%
圖 7：決策樹規則（部份）（續） 
 
步驟二：在此由於變數屬性為連續變數，利用決策樹分析，使用 F分配檢定為分
支法則，接著從步驟一挖掘出的較顯著基因當做乳癌決策樹的分類子（classifier）進
行決策樹分析後，五次重複抽樣後分別得到 12、14、18、14、16個分支，其解釋率達
到 90％以上之決策樹，聯集共得到 21個分支解釋率 90％以上之決策樹(如圖 7)與顯著
影響乳癌的基因及其規則，本文彙整 IF THEN規則及其分支正確率（判定為乳癌病人
之分支）、平均正確率及模式解釋力等資訊，其中分支解釋率以分數型式表示能更清楚
顯示分支情形，括弧內之數字為該決策規則在五次重複抽樣分析中出現之次數，如
50/50(5)為此規則 50 人為判定乳癌患者，實際患者亦為 50人，此規則在五次分析中出
現五次；整體正確率為計算所有正確判別情形；平均模式解釋力為單一規則在各次模
式解釋力的平均表現，詳如表 7： 
建構 cDNA 生物晶片之二元資料挖礦模式及其實證研究 153 
 
四、模式驗證 
最後將各次重複抽樣所剩餘的 28 筆資料當作測試集進行模式規則驗證，在醫學
上偽陰性（false negative），即未將病人檢驗出來比偽陽性（false positive）顯得重要，
根據生物晶片與生物資訊領域知識，在模式驗證時，若偽陰性高於 10％則該規則予以
刪除，若偽陽性高於 20％時與以刪除。表 8 為將測試集資料分別帶入各次分析中所挖
掘出的決策規則中，Category為正常人/病人(0/1)之分類，藉以驗證，紅色表決策規則
判斷錯誤者，黃色表遺失值。從表 8-1中可看出決策規則僅規則 6：IF (AA961402<2,000 ) 
THEN patients，在正常人中誤判三人（3/14），偽陰性為 21.4％，應將此規則刪除；而
其餘 11條決策規則均沒有錯誤分類的狀況，正確率 100％，在 336筆檢測值當中，正
確率高達 99.1％；在表 8-2中，規則 8：IF (AA913206 < 5,000) THEN patients，在正
常人中誤判二人（2/14），偽陰性為 14.3％，應予以刪除，其餘 13 條規則僅錯判 2 筆，
在 390筆檢測值當中，正確率高達 98.0％；在表 8-3中，規則 5：IF (T53121 < 2,000) 
THEN patients、規則 7：IF (AA938940 < 1,000) THEN patients、規則 8：IF (AA913206 
< 5,000) THEN patients等三條規則，偽陰性(false negative)超過 10％，應予以刪除，
在 488筆檢測值當中，正確率高達 97.1％；在表 8-4中，均無規則偽陰性(false negative) 
超過 10％，在 390筆檢測值當中，正確率高達 99.2％；在表 8-5中，IF (AA913206 < 5,000) 
THEN patients，在正常人中誤判三人，已於前次驗證時刪除，在 430筆檢測值當中，
正確率高達 98.8％，五次整體平均正確率為 98.62%(詳如表 8)。 
綜上所述，在表 7 所建立的 21條決策規則，在經過驗證之後刪除項次 5、6、7、
8，IF (T53121 < 2,000) THEN patients、IF (AA961402 < 2,000) THEN patients 、IF 
(AA938940 < 1,000) THEN patients、IF (AA913206 < 5,000) THEN patients等四條規
則，五次驗證結果正確率均達 97％以上。 
 
表 8-1：決策規則驗證結果(第一次) 
 
建構 cDNA 生物晶片之二元資料挖礦模式及其實證研究 155 
 
表 8-5：決策規則驗證結果(第五次) 
 
五、規則解釋與評估 
由於醫學研究往往牽涉患者的健康、生命安全，研究模式的解釋能力以及可靠度
需以更嚴格的標準衡量，因此本研究選取模式解釋能力 90%以上的 21 個基因為醫療
檢測參考因子並建立其個別決策規則，如當基因 AA777396 檢測值小於 1,000 時，則
判定為患有乳癌，大於 1,000 時則為正常人；在使用測試集進行驗證分析的時候，採
取偽陰性若高於 10％時則該規則予以刪除，偽陽性高於 20％時予以刪除，共刪除四條
決策規則（各規則信度效度如上表 7、8所示）。本研究所建立的決策規則，係純以晶
片資料進行分析，由於無法取得相關病歷資料，故無法更深入探討病人基因表現值與
相關病歷的關係，如年齡、性別、區域人種等，亦未建立規則間彼此的交互關係。 
本研究模式發展生物晶片資料挖礦的架構和方法，可以提供一完整有效的分析架
構，從最前端的資料處理開始架構完整的處理步驟、分析模式與結果驗證及彙整決策
支援建議。從龐大的資料庫當中，首先必須瞭解資料型態；再進行資料預處理工作，
去除雜亂無用的屬性及資料與遺失值的填補並彙整成可用分析的資料集；接著即從降
低變數維度的角度，並且採用階段式的步驟進行分析，根據本研究提出的生物晶片資
料挖礦模式進行影響特定疾病基因之挖掘，並以史丹佛大學基因晶片資料庫之乳癌實
驗晶片 cDNA 資料進行研究驗證，從 41,681 個基因的 64 筆樣本中分階段降低變數維
度，到最後歸納出正確率極高之規則，已經證明本方法的效度。 
在分析的過程中發現，雖然原始資料為電腦掃描判讀產生，但仍高達近 10％的無
效資料無法進行處理及分析而必須捨棄。本研究從原始資料的解構、整合到資料整理，
再採用階段性步驟進行研究分析，最後建立出 17條各別決策規則，可供生醫研究者進
行後續分析或決策參考應用。 
建構 cDNA 生物晶片之二元資料挖礦模式及其實證研究 157 
 
5. 簡禎富、吳文婷，1997『醫療決策分析：以唐氏症之診斷為例』，醫療資訊雜誌，
第六期：39~53頁。 
6. 簡禎富、林鼎浩、徐紹鐘、彭誠湧，2001『建構半導體晶圓允收測試資料挖礦架
構及其實證研究』，工業工程學刊，第十八卷．第四期：37~48頁。 
7. 簡禎富、李培瑞、彭誠湧，2003『半導體製程資料特徵萃取與資料挖礦之研究』，
資訊管理學報，第十卷．第一期：63~84頁。 
8. 簡禎富、林鼎浩、劉巧雯、彭誠湧、徐紹鐘、黃佳琪，2001『建構晶圓圖分類之
資料挖礦方法及其實證研究』，工業工程學刊， 第十九卷．第二期：23~38頁。 
9. 簡禎富、蕭禮明、王興仁，2004『建構半導體製造管理目標層級架構與製造資料
之資料挖礦』，工業工程學刊，第廿一卷．第四期：313~327頁。 
10. 簡禎富、王興仁、陳麗妃，2005『利用資料挖礦提升半導體廠製造技術員人力資
源管理品質』，品質學報，第十二卷．第一期：9~28頁。 
11. Baldi, P., and Brunak, S. Bioinformatics: The Machine Learning Approach, The MIT 
Press, London, 2004 
12. Bergeron, B. Bioinformatics Computing, Prentice Hall, New Jersey, 2002 
13. Breiman, L., Friedman, J. H., Olshen, R. J., and Stone, C. J. Classification and 
Regression Tree, Wadsworth, Belmont, CA, 1984 
14. Chen, X., “Gene Selection for Cancer Classification Using Bootstrapped Genetic 
Algorithms and Support Vector Machines,” Proceedings of the 2003 IEEE 
Bioinformatics Conference 2003, pp: 504-505 
15. Chien, C.F., Chen, S., and Lin, Y., “Using Bayesian Network for Fault Location on 
Distribution Feeder of Electrical Power Delivery Systems,” IEEE Transactions on 
Power Delivery, (17:13) 2002, pp: 785-793 
16. Chien, C.F., Wang, W.C., and Cheng, J.C., “Data mining for yield enhancement in 
semiconductor manufacturing and an empirical study,” Expert Systems with 
Applications, (33:1) 2007, pp: 1-7 
17. Chuang, H., Liu, H., Brown, S., McMunn-Coffran, C., Kao, C., and Hsu, F. 
“Identifying Significant Genes from Microarray Data,” Proceedings of the Fourth 
IEEE Symposium on Bioinformatics and Bioengineering 2004, pp: 358-365 
18. Fayyad, U., “Data mining and knowledge discovery in database: implication for 
scientific databases,” Scientific and Statistical Database Management 1997, pp: 2-11 
19. Gregory, P., and Tamayo, P., “Microarray Data Mining: Facing the Challenges,” 
Knowledge Discovery and Data Mining, (5:2) 2003, pp: 1-5 
20. Han, J. and Kamber, M. Data Mining Concepts and Techniques, Morgan Kaufmann 
Publishers, San Francisco, CA, 2000 
21. Hartigan, J. A. Clustering Algorithms, John Wiley & Sons, New York, 1975 
22. Khabzaoui, M., Dhaenens, C., and Talbi, E., “A Multicriteria Genetic Algorithm to 
analyze DNA microarray data,” Proceedings of the Fourth IEEE Symposium on 
建構 cDNA 生物晶片之二元資料挖礦模式及其實證研究 159 
 
of the United States of America, (98:9) 2001, pp: 5116–5121 
36. Wu, Y., and Zhang, A., “Feature Selection for Classifying High-Dimensional 
Numerical Data,” Proceedings of the 2004 IEEE Computer Society Conference on 
Computer Vision and Pattern Recognition 2004, pp: 251-258 
37. Yun, H., Ha, D., Hwang, B., and Ryu, K., “Mining association rules on significant 
rare data using relative support,” The Journal of System and Software, (67) 2003, pp: 
181-191 
 
PROCEEDING OF INTELLIGENT MANUFACTURING & LOGISTICS SYSTEMS   August, 2005 
1 
 
PROCEEDING OF IML2005 
 †  The authors are both with the Department of Industrial Engineering 
& Engineering Management, National Tsing Hua University, Taiwan, 
R.O.C. Email: cfchien@mx.nthu.edu.tw 
Using data mining for bio-chip data analysis and decision 
support 
Kuo-Sheng Lin and Chen-Fu Chien† 
Abstract 
This study aims to develop a data mining approach for analyzing 
specific genes between normal and abnormal individuals to 
clarify the relationships among genes, diseases and symptoms. 
We adopt the breast cancer patient cDNA microarray dataset to 
firstly extract significant genes from more than 6,000 genes by 
and then use Decision Tree to classify rules for decision support. 
Furthermore, the information can be utilized helping for medical 
diagnosis. 
Key words: 
Microarray, Data mining, Significant Analysis of Microarray, 
Decision Tree. 
1. Introduction 
Organism’s inner characteristic is controlled by DNA 
that is made of 2 base pairs, A, T, G, and C. Besides 
biology domain knowledge, one kind of ways, helping us 
understands more knowledge about relationship of 
specific genes, tissues and disease is to use microarray 
data analysis. Microarray data is presented by ratio of 
abnormal/normal expression in each gene. Challenge of 
microarray data analysis, one of fields in bio-technology, 
is mainly including gene selection, classification, 
clustering, biological discovery among genes, tissues and 
disease. Gene selection is a process of feature selection, 
finds the genes most strongly related to a particular class. 
Classification is to classify diseases or predicting 
outcomes based on gene expression patterns. Clustering is 
finding the groups of gene expressions similar or new 
biological classes [8]. 
 
 
Fig. 1  Displayed gene expression in microarray. 
Experiments in bio-chip (microarray) utilize hybridization 
probing technology, DNA fluctuations and spectrum 
scanner to display gene expression difference between the 
specific disease patients and the normal references(see Fig. 
1). For example, first, use Arrayer to lay up one thousand 
kinds of oligonucleotide probes related cancer on bio-chip. 
Next, extract target nucleic acid labeled red fluctuation 
from cancer patients and from normal references whose 
are labeled green at the same time. After mixing the DNA 
solution of the two samples, hybridization reflection is 
preceded with bio-chip. Through scanner readout the 
reflection by spectrum expression, if a spot display red 
color, it means that this specific gene only presents in 
cancer patients and if green, it means that only presents in 
normal reference, respectively. The readout color is 
displayed from red to green spectrum and transformed to 
numeric data. Thus we can obtain one thousand of gene 
expression of abnormal/normal differential report in one 
bio-chip simultaneously. 
In microarray information, focusing on some symptom or 
disease, if we can find out some influent genes or 
meaningful patterns, this will help people understanding 
mystical genes, even more, become the foundation of 
biotechnology development, for examples, building the 
index of medical test, discovery the potential relation with 
disease factors or helping for different diagnosis and 
therapy. Resulting of the degree of freedom of data in 
microarray, it is hard to use traditional statistical methods 
dealing with feature selection. For example, there are more 
30,000 genes in human beings and there are often tens or 
hundreds samples in a specific experiment. Because one 
biochip presents gene expression includes thousands or ten 
thousands of genes and only dozens or hundreds samples 
(biochips) in one experiment, data mining and machine 
learning technology play important rules. Many 
researchers develop new methods or technologies to 
overcome the relative constraint and difficulty of data in 
present. 
Although massive amounts of data are generated, methods 
are needed to determine whether changes in gene 
expression are experimentally significant. Cluster analysis 
of microarray data can find coherent patterns of gene 
expression but provides little information about statistical 
significance. 
This study aims to develop and validate a data mining 
approach for analyzing bio-chip data. In particular, 
IEICE TRANS. FUNDAMENTALS/COMMUN./ELECTRON./INF. & SYST., VOL. E85-A/B/C/D,  No. 1   JANUARY 2002 
3 
 
 
 
 
Fig. 2  Research framework 
 
In Stage 1, because of the variation or noise from bio-chip 
manufacturing, experiment and random errors, etc, we 
transformed the original data to normalized data. Resulting 
from the 64 samples, we obtained 64 patients and 64 
normal references observations, respectively. 
In next stage, Gene feature selection in microarray data 
mining, it is a problem that feature dimensions are more 
tremendous than sample numbers. First, we use SAM 
method for rough selection to discover significant gene 
and eliminate nonsense ones. Unfortunately, this limitation 
is that we can’t find interactions among genes. Next, we 
use decision tree, a kind of technology in data mining, and 
use the selected significant genes in the previous step 
being the split classifiers to discover potential rules. The 
decision tree tool we used is CHAID, a famous algorithm 
in data mining field. 
Third, after gene selection stage from training set, we use 
the remaining data to validate the discovered rules 
efficient or not. If the rules is not good enough after 
validation stage, repeat stage 1 and 2 and adjust some 
parameters, for example, SAM threshold or model. 
Finally, summarize the significant genes and rules from 
the numerical analysis and it maybe provide bio-physician 
some meaningful use. 
4. Results & Discussion 
According to the previous framework, this study adopted 
the breast cancer cDNA microarray dataset from SMD 
database with 64 samples and 6,640 genes. By using 
Significant Analysis of Microarray method, we found 55 
single significant genes within their individual impact in 
the training set (parts shown in Fig. 3). Furthermore, we 
used the 55 genes being the branch nodes for classifying 
and discovering rules. We found 3 rules from 15 
significant genes (parts shown in Fig. 4) and the partial 
results are as below (IMAGE number is some specific 
gene name). 
Rule 1: IF (IMAGE: 668685 < 5000) THEN patients 
Rule 2: IF (IMAGE: 668685<5000) ELSE  
IF (IMAGE: 74537>8000) THEN patients 
Rule 3: IF (IMAGE: 306841 < 4000) THEN patients 
 
 
Fig. 3  Impact of significant genes 
 
Finally, we use the remaining 28 observation to validate 
these rules described, we found that there were no false 
discovery in Rule 1 and 2, and the false discovery rate is 
7.14% in Rule 3 (parts shown in Table 1). 
 
 
Fig. 4  Rules in decision tree 
 
Table 1: Validation of rules 
Category 1 1 1 2 2 2 
IMAGE: 
668685 10412 22425 31059 627 486 734 
Rule 1 
classifi-
cation 
1 1 1 2 2 2 
Category 1 1 1 2 2 2 
IMAGE: 
668685 10412 22425 31059 627 486 734 
IMAGE: 
74537 5873 8017 11015 305 43 318 
Rule 2 1 1 1 2 2 2 
