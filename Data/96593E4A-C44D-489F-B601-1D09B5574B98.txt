技術研發成果說明： 
本計畫電力需量控制節能系統之人機介面採用 LabVIEW8.2 軟體來設計，所完成的主畫面如圖 1
所示，計有主畫面、監控畫面、預測畫面、超約警報總覽、復歸總覽、報表與歷年報表等七個子介面，
也包括了圖 2~圖 4 等三個子程式(登入資料、介面選擇及設定參數)。圖 2 所示為登入者資料程式，考
量了使用者的權限問題，即欲執行此系統者必須先輸入帳號、密碼，正確時系統會顯示其姓名與職稱，
並將登入時間儲存於電腦內，所以能了解系統的使用狀況。圖 3 為介面選擇子程式，由於系統需長時
間監控和定時擷取用電資料，會導致電腦 CPU 長時間維持在尖峰狀況，因此，為考量電腦的壽命問
題，乃利用 LabVIEW 的事件結構(Event Structure)來設計；而為了方便使用者設定參數，將 Modbus 
TCP/IP 傳輸資料的格式以人機介面的方式來設計輸入資料的顯示情形，其程式如圖 4 所示。 
 
 
圖 1. 主畫面 
 
 
圖 2. 登入者資料程式 
 
 
 
圖 5. 監控畫面 
 
 
 
 
圖 6. Modbus TCP/IP 通訊介面程式 
 
 
 
 
圖 9. 預測動態趨勢圖程式 
 
 
圖 10 和圖 11 為超約警報總覽與復歸總覽，即時顯示系統於預測需量超過控制需量值時，已執行
之卸載段數與加載回復情形，且會予以紀錄，做為追蹤與檢討的參考。 
 
 
 
圖 10. 超約警報總覽 
 
  
圖 13. 復歸總覽程式 
 
圖 14 為每日報表顯示，將系統各項數據利用 Excel 每日存檔的方式顯示於報表上，另以每 30 秒
儲存一筆資料，使用者亦可在 Excel 軟體中自行規劃圖表、記錄存檔，並透過網路作檔案分享，方便
相關人員隨時掌控用電需量情況。 
 
 
圖 14. 每日報表 
 
圖 14 之每日報表系統的設計程式如圖 15 所示，將各項數據先輸入至 Format Into String 物件中，
並設定小數點的進位，接著分別輸入至 Build Array 物件與 Concatenate Strings 物件中，前者使用 Table 
Control 作為報表，後者則利用 Build Path 設定存檔路徑，將資料經由 Write To Spreadsheet File.vi 物件
儲存於電腦中，並由使用者自行設定檔案儲存路徑。 
 
