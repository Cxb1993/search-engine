I 
 
目錄 
 
中文摘要……………………………………………………………………………II 
英文摘要……………………………………………………………………………III 
報告內容……………………………………………………………………………1 
1. 前言……………………………………………………………………………1 
2. 研究目的………………………………………………………………………1 
3. 文獻探討………………………………………………………………………1 
4. 研究方法………………………………………………………………………6 
5. 結果與討論…………………………………………………………………17 
參考文獻……………………………………………………………………………24 
計畫成果自評………………………………………………………………………28 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
III 
 
英文摘要 
This project studied an envelope-tracking RF linear transmitter based on our newly proposed 
HQPM (Hybrid Quadrature Polar Modulation) architecture. The HQPM transmitters adopt a 
high-efficiency Class-E power amplifier instead of a conventionally used low-efficiency linear power 
amplifier to significantly enhance efficiency. In the mean time, the HQPM transmitters use digital 
predistrotion techniques to effectively improve linearity. The main advantage of HQPM transmitters 
is that it has a high average transmit efficiency performance, which is ideally irrelevant to output 
power levels and thus good for application to modern mobile communication systems featured with 
transmit power control and a high peak-to-average power ratio. This project enhanced the 
performance of HQPM transmitters in three ways: First, the power combining technique was used to 
implement a CMOS power amplifier for CMOS single-chip integration of HQPM transmitters. 
Second, local oscillator pulling effects on the HQPM transmitter were carefully investigated. 
Effective methods were developed to cancel or suppress the interference imposed on the local 
oscillator. Third, the AM/AM and AM/PM digital predistortion schemes were used to notably 
improve the linearity of HQPM transmitters for meeting the stringent linearity requirement in 
advanced mobile communication systems. 
Keywords: Envelope-tracking transmitter, HQPM, Class-E power amplifier, power combining 
technique, local oscillator pulling, digital predistrotion. 
 
 
2 
作頻段愈趨向高頻化，對混波器間的性能匹配、90o 分配器之平衡性以及功率放大器的線性度
要求將成為此架構的設計瓶頸。 
為了避免犧牲效率換取線性度的情況發生，發展出多種改善功率放大器線性度之
方法 [3],[4] ，較常見有回授法 (Feedback) 、前饋式法 (Feedforward) 、預失真技術
(Predistortion)。傳統回授電路架構，射頻輸出訊號藉由回授路徑提供之增益將功率放大
器所產生之非線性項數值縮減，以達到線性化效果[1]-[5]；此方式雖能有效改善功率放
大器線性度，但由於回授路徑本身存在不穩定及頻寬受限的問題，因此並不適用於寬
頻行動通訊系統。前饋式技術為一相當成熟之線性化技術，與回授電路相反地，前饋
式技術利用輸入訊號與輸出訊號相比較算出非線性補償量，與輸出訊號相加後即可校
正非線性現象[1],[2],[6],[7]。雖然此架構避免回授路徑造成電路不穩定與頻寬受限的問
題，但仍存在許多缺點；第一、輸入與輸出訊號之間增益與相位資訊不匹配造成補償
量估計失準；第二、補償量需經過一放大器將訊號放大，於此處產生之非線性效應無
法補償；第三、前饋式技術架構過於複雜，使得功率消耗過大，導致效率不彰。  
預失真技術主要概念是針對功率放大器非線性現象將輸入訊號進行預先補償，使
得預失真電路與功率放大器兩者合併之 AM/AM 與 AM/PM 現象為一線性關係[8]，無電
路不穩定與頻寬限制問題且架構簡單易實現，為現今線性化技術中最為廣泛應用者。
功率放大器本身之失真特性常會隨著頻段、操作環境及電路老化等因素而改變，因此
線性化電路須具有適應性來追蹤功率放大器因環境因素所造成之非線性效應，可藉由
適應性演算法與數位邏輯控制單元便能實踐適應性線性化技術，使預失真功能更強韌，
發射機之線性度表現也能更穩定。適應性查表式預失真電路架構是利用耦合器取得少
部分射頻輸出訊號，經由正交解調器與類比數位轉換器處理後降頻並轉換為數位訊號，
此訊號與原基頻輸入訊號比較後經演算法得出藉以調整數位預失真器之參考訊號，進
而達成適應性改變預失真訊號之目的[9]-[13]。  
以上所討論之線性化技術能有效改善線性度，使功率放大器得以線性操作於高功
率區以達到較高轉換效率，此轉換效率定義為固定供應電壓情況下，輸入訊號為弦波
連續訊號(CW)測試條件下，對應之輸出功率效率表現；但發射機實際使用變動波包調
制訊號時，由於調制訊號振幅隨時間變化，而各輸入訊號振幅有一出現機率值，因此
整體效率表現應定義為輸入訊號振幅各點對應之輸出功率乘上機率分佈函數
(Probability Distribution Function, PDF)，再予以平均，除以消耗直流功率，得出參數命
名為平均效率[14]-[15]。而線性化技術對於效率改善僅止於高瞬時輸出功率區，對於整
體平均效率改善相當有限，因此強化平均效率即成為現今研究之關鍵議題。  
為了進一步提高發射機整體平均效率，諸多發射機架構相繼被提出討論，常見者
如 LINC(Linear Power Amplifier using Nonlinear Components)、波包追蹤架構(Envelope 
Tacking)、波包消除重建架構(Envelope Elimination and Restoration)、極座標調制架構
(Polar Modulation)。LINC 架構將射頻輸入訊號分解為兩固定波包訊號，藉由非線性功
率放大器將訊號高效率且不失真放大，最後再將訊號合併[16],[17]，此方法理論上可兼
具線性度與效率表現，但實際上卻存在兩路功率放大器間增益與相位不匹配、使用被
動元件造成功率損耗等問題，使得此架構於實際應用上大打折扣。在傳統線性發射機
4 
  DPR 處理器之發射機使用極座標調制架構，主要包含了以數位控制壓控振盪器(digital 
controlled oscillator, DCO)為核心的全數位式鎖相迴路(all digital PLL, ADPLL)[33]以及操作近
似 E 類的可數位控制功率放大器(digital PA, PA)[31]。DRP 發射機應用了 ADPLL 所具有的寬頻
頻率調制能力以及 DPA 數位控制電晶體陣列的方式來進行波包振幅調制，最後於 DPA 輸出還
原出具有時變波包特性的調制訊號。相較於傳統收發射機架構，DRP 的特色在於大量採用數
位處理技術取代傳統類比射頻電路功能，此不但使 DRP 易於與以 CMOS 製程為主的通訊系統
基頻功能整合且能大幅縮小通訊晶片面積。即使 DRP 架構能大幅採用 CMOS 製程進行高度整
合，但受限於 CMOS 製程崩潰電壓限制，其發射功率仍需藉助外部前端模組的線性功率放大
器進行放大，因此整體發射機效率最後仍受限於外部功率放大器。 
  為了解決上述所有發射機架構的缺點，本計畫提出一混合正交與極座標調制(Hybrid 
Quadrature and Polar Modulation, HQPM)之發射機架構[36]-[41]，其架構如圖 1 所示。如同極座
標調制發射機架構，HQPM 發射機同樣使用數位基頻處理器產生波包以及相位訊號但能使射
頻輸入訊號之振幅與供應電源電壓在功率放大器上具有一正比的線性關係( in sV V )，此舉將使
射頻輸入訊號與供應電源電壓具有相同的時變波包。在任何瞬間，供應電源電壓都將追隨射頻
輸入訊號之波包振幅大小，因此功率放大器之 PAE 將具有最佳化的結果。除此之外當波包在
零交越的瞬間，射頻輸入訊號之波包可同時為零因此避免極座標調制架構中的零交越失真現象。
而 HQPM 架構採用 S 類調制器取代極座標調制中的電壓調節器，S 類調制器之轉換效率與輸
出波包振幅大小無關的特性使得整體 HQPM 發射機之效率與輸出波包振幅大小無關。 
 
圖 1  混合正交與極座標調制(HQPM)發射機架構 
  雖然具有變動波包的射頻輸入訊號解決了極座標調制架構中的饋入穿透問題，但卻因 inV
與 sV 同時具有波包訊息而令調制訊號品質將受此雙重波包調制(double envelope modulation)所
影響。為了解決此問題，HQPM發射機運用預失真技術更進一步提昇調制訊號品質，採用HQPM
之射頻線性發射機詳細架構如圖 2 所示。其包含兩個主要電路，一為以 E 類設計之切換式功
率放大器另一為虛線內之混合正交與極座標調制器。混合正交與極座標調制器包含數位基頻處
理器、正交調制器以及 S 類調制器，其中數位基頻處理器則包含了用以換算基頻 I/Q 訊號波包
之波包計算器、補償功率放大器 AM-AM 失真之數位預失真器以及進行正交調制訊號與波包訊
號同步之延遲單元。由正交調制器所調制出的射頻訊號送至 E 類功率放大器之射頻輸入端，
而數位波包訊號則經由 S 類調制器將其轉換為類比波包後送至 E 類功率放大器之電源供應
端。 
Hybrid Quadrature 
Polar Modulator
I
Q
PAin
V
sV
outV
 
predistorted envelope
predistorted 
quadrature-modulated 
carrier
 
Class-S modulator
 
6 
4. 研究方法 
一般功率結合器可區分為兩種，圖 4 分別為串聯結合轉換器(SCT)與並聯結合轉換器
(PCT)。其主要組成之元件乃為耦合變壓器，利用本計畫所設計之三線纏繞新型六邊形三埠功
率結合器及所前面所提之具有 scalable 特性變壓器等效物理模型電路，故可進一步建立出功率
結合器之等效電路並可成功驗證所有設計與製作的平面型功率結合器之模擬與量測結果。對於
功率結合器之性能評估表現，通常可分別定義其振幅不平衡(Δ)為 
12
10
13
20log S
S
   
相位不平衡(θ)為 
12 13S S     
差模差拒比(differential-mode rejection ratio, DMRR)為 
12 13
12 13
1
21
1
2
1
21
1
2
j
j
e
S SDMRR
S S
e




                                         
 
以及消耗功率損耗(dissipated power loss)為 
   2 2 2 210 22 12 10 33 1310log 10logDL S S S S      
等指數。 
         
(a)                                (b) 
圖 4  (a)串聯結合轉換器(SCT)  (b)並聯結合轉換器(PCT) 
  
8 
在應用於 CMOS 功率放大器之結合器設計上，採用三線纏繞的並聯結合架構，圖 9 為本
設計的等效電路圖與佈局圖，結合之主線圈總數為 2，主次線圈圈數比為 1:2，同一主線圈的
兩端訊號為相位差180的差動訊號，設計的頻段在 2.4 GHz。 
 
(a)                         (b)                         (c) 
圖 8  三種接地型態功率結合器 (a)外接地 (b)內接地 (c)環形接地 
 
圖 9  並聯結合轉換器 (a)等效電路圖 (b)佈局圖 
 
圖 10  兩組推挽式放大器功率結合架構 
次線圈
主線圈 1
主線圈 2
次線圈
主線圈 1
主線圈 2
接地環
10 
  本地振盪源在射頻收發機中是的關鍵重要元件之一，其設計經常以鎖相迴路做為基礎來得
到一個純淨的弦波訊號以提供收發機進行解調/調變或升頻/降頻。如圖 12 所示，一鎖相迴路由
相位頻率偵測器(PFD)、電荷幫浦(CP)、迴路濾波器、壓控振盪器(VCO)以及構成迴授路徑的
除頻器所組成。由於振盪器本身的特性使鎖相迴路容易因為受到干擾而發生頻率牽引現象，進
而降低頻譜的純淨度。不同於現有的分析方法，本研究使用頻域與離散時域的分析方法能提供
有效與準確的計算來預測頻率牽引現象。除了自由振盪器之外，本研究的主要貢獻在於能分析
鎖相迴路受到注入干擾而產生的頻率牽引現象。本報告的第一部分結合了 Adler 的方程式與頻
域的鎖相迴路模型來推導注入轉移函數，並且顯示了其轉移函數具有帶通型式的頻率響應；第
二部分則是找出離散時域下 Adler 方程式的遞迴方程式，使用遞迴運算可以準確的預測本地振
盪源受到弦波或調變訊號注入所導致的頻譜失真現象；最後則是將離散時域分析的結果在不同
注入條件下與鎖相迴路量測進行比較。 
 
圖 12  鎖相迴路與注入訊號示意方塊圖 
 
圖 13  注入訊號之下振盪器瞬時訊號電壓向量圖 
圖 13 所示為自由振盪訊號  oscS t 和注入訊號  injS t 的瞬間電壓的向量圖，在圖中， injE 為
注入訊號  injS t 的電壓振幅且振盪頻率為 inj ； oscE 為自由振盪訊號  oscS t 的電壓振幅且頻率
為  osc t ；  outS t 代表在注入情況之下振盪器的輸出訊號，電壓振幅表示為 E並且相對於注入
訊號頻率具有瞬間頻率如下式： 
   out inj d tt dt 
  
其中  d t dt 代表振盪器輸出頻率相對於注入頻率 inj 的瞬時頻率差。不同於眾所周知 Adler 分
PFD
Frequency
Divider
CP LoopFilter
VCO
 outS t
 tV t refS t
 injS t
 e t
 ,osc oscE t
 ,E t
,inj injE 
 t
 d t
dt

 injS t
 oscS t  outS t
12 
 
圖 14  在注入情況下鎖相迴路之頻域模型  
根據圖 14，可推出鎖相迴路輸出相位為 
         out ref ref injs H s s H s s       
其中 
    
2
2 2
2
2
d v n n
ref
d v n n
NK K F s sH s N
Ns K K F s s s
 
 
        
 
    2 22inj d v n n
B BsH s
s K K F s s s      
 refH s 和  injH s 在以上 2 式中分別代表與參考訊號和注入訊號相關的轉移函數。考慮一個二階
鎖相迴路，以上 2 式能分別改寫為自然頻率 n 和阻尼因子 的關係式，取上式絕對值且令 s j
可得 
   22 2 2 2 24inj n n
BH s j 
    
 
 
 
其中 為距離合成中心頻率的頻率偏移。在上式中，注入轉移函數具有帶通的頻率響應，令上
式的微分為零，能找出注入轉換函數在 n  時有最大值，亦即 
 
2 4
c inj
p inj n
n n osc
EBG H s j
Q E
       
從上式中可以看出有高 Q 值的壓控振盪器以及有高自然頻率和高阻尼因子的鎖相迴路可以幫
助減少注入牽引的效應。 
 對於一個具有訊號注入情況下的鎖相迴路而言，注入鎖定過程和鎖相迴路鎖定過程將會相
互影響，意即在上述數學式中的  osc t 和  t 彼此相關，因此很難使用頻域的分析方法求得鎖
相迴路的輸出頻譜，本計畫提出了使用離散時域的分析方法來解決這個問題。考慮一個振盪器
輸出訊號為一個複數訊號，表示如下: 
VCO
 ref s  e s dK  F s
PFD & CP
Loop Filter
vK
s
1
N
 out s
 osc s
 s
Frequency Divider
B
s

 s
14 
 
圖 15 具有抵抗本地振盪源牽引效應之 HQPM 發射機 
首先假設校正後的受干擾本地振盪訊號與直接升頻發射機輸出調制訊號可表示為 
 , ,( ) cos ( ) LO c LO c LOS t E t   
 ( ) ( )cos ( ) ( ) TX inj LO mS t E t t t   
其中為此兩訊號間之相位差，而 ,LO cE 則代表校正後本地振盪訊號之振幅大小；此兩項係數
將能透過該迴路中的相位位移器與可變增益放大器予以調整，藉此確保該混波機制具有最大的
轉換增益 mixerG ，則射頻混波器混波後的輸出訊號為 
    mod ( ) ( )sin ( ) mixer inj m mixer inj mS t G E t t G E t t   
經由一低通濾波器濾除不必要的交互調變項後，該基頻訊號中將蘊含干擾訊號的波包與相位調
制資訊。將此訊號饋入壓控振盪器之第二調制埠，用以抵銷牽引效應之頻率調制失真，此時本
地振盪訊號輸出頻率為 
       mod mod( )   LO osc v t LRt K V t t t K S t     
由上 2 式經過數學處理，受干擾後的本地振盪訊號輸出頻率可改寫為 
 
   
mod( ) ( ) ( )2
( ) ( ) ( ) ( ) ( ) ( ) .
      
     
osc
LO c v t mixer inj m
osc
LR LO o LO LR m o m
t K V t K G E t t
QE
t t t t t t
  
       
 
在忽略調制干擾路徑延遲前提下( 0o )，可做出 ( ) ( ) m m ot t   之數學簡化；則上式中，因變
動波包調制干擾所引致的頻率調制失真，在滿足 mod 2mixer osc oscK G QE 條件下，透過第二點調
制壓控振盪器技術將能予以完全抵銷，令該發射機輸出調制品質獲得大幅度改善。 
預失真器的概念可由圖 16 加以說明，針對功率放大器本身之非線性現象，在訊號進入功
率放大器前透過預失真器先行補償，產生得以反函數般抵銷功率放大器非線性現象之預失真訊
號，使得最後的輸出結果與輸入訊號間能維持一線性關係，達成線性化的目標。利用圖 17 可
進一步解釋預失真器操作之原理，圖中實線為功率放大器輸入電壓與輸出電壓的關係曲線，而
虛線則為線性化之目標。當輸入電壓為 iV 時，對應功率放大器之實際輸出電壓為 oV ，然而若
要維持線性輸出電壓 0V ，則必須改變輸入電壓至 iV ，依此類推。 
 tV t

 modS t o
  ,LO cS t
 TXS t
 LOS t
   , ,inj o inj iV t V t
 LOS t
 LOS t
 TXS t
i
16 
0 1 2 3 4 5 6 7
RMS Output Voltage (V)
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
Su
pp
ly
 V
ol
ta
ge
 (V
)
 
圖 18  E 類功率放大器 Vdd/AM 特性之反函數曲線 
 
    (a)                       (b)                      (c) 
圖 19  Vdd/AM 查找表建立示意圖 (a)振幅切割 (b)求取反函數找出相對應補償點 (c)計算各
點補償值 
compG comp Q r
r

 
圖 20 數位預失真器電路架構圖 
18 
      
                    (a)                                      (b) 
圖 23  並聯結合轉換器模擬與量測比較  (a)反射係數幅度 (b)穿透係數幅度 
  
                     (a)                                       (b) 
圖 24  E 類功率放大器波形 (a)電晶體電壓電流時域波形 (b)電晶體汲極與閘極電壓時域波形 
     
                     (a)                                      (b) 
圖 25  CMOS E 類功率放大器動態直流  (a)直流電流 (b)直流功率消耗 
 圖 24 為模擬電晶體在輸入功率 20 dBm 時的電壓與電流時域波形，理想 E 類操作時，電
壓與電流波形會完全錯開，實際由於一些非理想效應，造成時域波形電壓與電流並不會完整的
錯開。圖 25(a)為模擬疊接架構的兩組電晶體，輸入功率 20 dBm 時，汲極與閘極的電壓時域波
形，汲極與閘極的最大電壓差Vdg皆不超過 3.6 V，不會有晶片燒毀的風險。圖 25(b)為功率放
大器操作時的直流對輸入功率的關係，在小功率區域模擬與量測較為吻合，在大功率區域實際
量測之直流功率消耗較模擬值大。 
1 2 3 4
frequency (GHz)
-20
-15
-10
-5
0
S 1
1 (
dB
)
Sim
Meas
1 2 3 4
frequency (GHz)
-20
-15
-10
-5
0
in
se
rt
io
n 
lo
ss
 (d
B)
Sim_single_ended
Meas_single_ended
Sim_differential
0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8
Time  (nsec)
0
1
2
3
4
5
6
V
ds
  (
V
)
-0.1
0
0.1
0.2
0.3
Ids   (A
)
Vds
Ids
0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9
Time  (nsec)
-2
-1
0
1
2
3
4
5
6
V
Vd_M2
Vg_M2
Vd_M1
Vg_M1
0 5 10 15 20 25
Pin  (dBm)
0
0.1
0.2
0.3
0.4
0.5
I d
c  
(W
)
Sim
Meas
0 5 10 15 20 25
Pin  (dBm)
0
0.2
0.4
0.6
0.8
1
1.2
P d
c  
(W
)
Sim
Meas
20 
本計畫設計並實現了一個 CMOS 製程的 2.4 GHz 頻率合成器，當此頻率合成器鎖定在 2.46 
GHz 時，估計自然頻率為 63.23 kHz 和阻尼因子為 1.54，此時輸出功率為 1.44 dBm。根據[5]，
實驗中注入訊號被注入壓控振盪器中並且同時藉由旋轉器將注入訊號與壓控振盪器的輸出訊
號隔離，注入訊號功率設定為比振盪器輸出功率 1.44 dBm 低 40 dB。圖 28 為注入轉移函數的
量值響應，如同前面所提到的，此響應為帶通的型態，並且在截止頻率等於自然頻率(63.23 kHz)
時有最大值為 2.85 dB。 
 
圖 28  2.4 GHz CMOS 頻率合成器的注入轉移函數量值響應圖 
 
                            (a)                       (b) 
圖 29 當注入訊號頻率距離鎖相迴路合成頻率 5 MHz 時鎖相迴路之輸出頻譜 (a)量測 (b)計算 
首先，實驗上使用頻率以 2.46 GHz 為準的弦波注入訊號，頻率偏移量選擇在 5 MHz，500 
kHz 和 20 kHz，個別對應的注入轉移函數量值分別為-11.25 dB、-1.49 dB 和 1.51 dB。這個量
值主要是用來估計注入鎖定效應在注入頻率偏移上的相關性。圖 29-31 比較了使用離散時間分
析方法的理論預測值和在三種不同的注入頻率偏移情形的量測值，結果與理論相當吻合。鎖相
迴路在弦波注入下產生許多額外的諧波，而這些諧波的頻率間距等於注入頻率與振盪頻率的頻
率差距，從圖 29-31 觀察可以發現，最大的兩個額外的 tone 出現在注入頻率 injf 和鏡相注入頻
率 02  injf f ，其中 0f 是頻率合成器的中心頻率。在注入頻率偏移為 5 MHz 的例子中，由鎖相迴
路在圖 29 中的輸出頻譜得知在注入頻率 injf 和鏡相注入頻率 02  injf f 有兩功率相似的 tone，且
兩者都比中心頻率 0f (2.46 GHz)的功率低很多，以上的特性為弱注入效應。根據圖 30 和 31 可
以發現當頻率偏移越接近自然頻率 63.23 kHz 時，注入鎖定效應越強。圖 30 和 31 中的兩根額
外的 tone 以 0f 來看是不對稱的，且當兩者愈靠近 0f 則功率愈大。在圖 31 中，最大的額外的 tone
的功率甚至在頻率偏移為 20 kHz 情形下時超越了 0f 的功率。以上頻譜結果只需要不超過 90
101 102 103 104 105 106 107 108
Frequency Offset (Hz)
-40
-30
-20
-10
0
10
In
je
ct
io
n 
Tr
an
sf
er
 F
un
ct
io
n 
   
   
   
  M
ag
ni
tu
de
 (d
B
)
2.452 2.456 2.46 2.464 2.468
Frequency (GHz)
-100
-80
-60
-40
-20
0
M
ea
su
re
d 
Sp
ec
tr
um
 (d
B
m
)
2.452 2.456 2.46 2.464 2.468
Frequency (GHz)
-100
-80
-60
-40
-20
0
C
al
cu
la
te
d 
Sp
ec
tr
um
 (d
B
m
)
finj
f0 f0
finjf f
22 
為了驗證本研究所提出之改善本地振盪源牽引效應方法，我們實現一 cdma2000 1x 系統之
發射機雛形，調制方式為 QPSK，資料傳輸率則為 1.2288 MHz。圖 33 為比較不同本地振盪源
牽引效應改善方法對發射訊號品質之影響，包括圖 33(a)所示之輸出頻譜與圖 33(b)所示解調之
EVM 值。圖中顯示同時採用第二點調制壓控振盪器技術以及內部自我注入迴路可以獲得最大
改善效果。根據理論預測與實驗結果，當本地振盪源面臨一功率約為-45 dBm 之調制干擾時，
其發射機輸出訊號之 EVM 與 ACPR 等系統性能皆能滿足 cdma 2000 1x 規範要求。  
   
                     (a)                                      (b) 
圖 33 改善本地振盪源牽引方法對發射訊號品質之影響測試 (a)輸出頻譜 (b)EVM 
 
圖 34  HQPM 發射機在輸出 W-CDMA 調制訊號位移 5 MHz 條件下之 ACLR 測試結果 
在HQPM發射機的研究上，本計畫提出一種E類功率放大器高動態範圍之線性化方法，該
技術是針對E類功率放大器進行偏壓點的控制，控制電路可整合於數位預失真器中，使得功率
放大器可操作於高輸出功率(Class-E)與低輸出功率(Class A/AB)兩種模態，大大提升HQPM發射
機之輸出功率動態範圍。應用E類功率放大器於波包追隨式發射機具有高效率之特點，搭配所
發展之數位輔助方法，包含AM/AM及AM/PM預失真與功率放大器E-A/AB類模態轉換控制等
功能，致使本發射機架構兼具高線性度、高效率與高動態範圍之優點。 
針對此發射機進行5 MHz頻寬之W-CDMA調制訊號測試，圖34及圖35分別為位移5 MHz
及10 MHz條件下鄰近通道洩漏比(ACLR)對調制輸出功率之關係。結果顯示在高達74 dB之動態
範圍中，本發射機可滿足W-CDMA對於鄰近通道洩漏比的規範。圖36則為發射機效率表現，
2.1475 2.1485 2.1495 2.1505 2.1515 2.1525
Freqeuncy (GHz)
-90
-80
-70
-60
-50
-40
-30
-20
-10
0
10
20
Tr
an
sm
it 
Sp
ec
tr
um
 (d
B
m
)
W/O Pulling
Not improved
Improved by two point modulation
Improved by inner self-injection
Improved by both methods
-65 -60 -55 -50 -45
Modulated Outer Self-injection Power Level (dBm)
0
10
20
30
40
50
EV
M
 (%
 rm
s)
W/O pulling
W/ pulling @ Pinj=-45 dBm
Improved by two point modulation
Improved by inner self-injection
Improved by both methods
cdma2000 1X specification
-60 -50 -40 -30 -20 -10 0 10 20 30
Modulated Output Power (dBm)
-55
-45
-35
-25
A
C
LR
 (d
B
c)
High power mode
Low power mode
Requirement
24 
本計畫研究成果 2008 年 8 月迄今所發表(含被接受)的 SCI 期刊論文共有 6 篇[40]-[45]，所
發表(含被接受)的 EI 國際會議論文共有 10 篇[46]-[55]，國內專利申請中 1 件[56]，成果頗為豐
碩。 
 
參考文獻 
[1] M. Faulkner, “Amplifier linearization using RF feedback and feedforward techniques,” IEEE 
Trans. Veh. Technol., vol. 47, pp. 209-215, Feb. 1998. 
[2] P. B. Kenington and D. W. Bennett, “Linear distortion correction using a feedforward system,” 
IEEE Trans. Veh. Technol., vol. 45, pp. 74-81, Feb. 1996. 
[3] S. C. Cripps, RF Power Amplifiers for Wireless Communications, Artech House, Boston USA, 
1999. 
[4] P. B. Kenington, High-Linearity RF Amplifier Design, Artech House, Boston USA, 2000. 
[5] B. Shi and L. Sundstrom, “Linearization of RF power amplifiers using power feedback,” in IEEE 
49th Vehicular Technology Conf., 1999, pp. 1520-1524. 
[6] A. H. Coskun and S. Demir, “A mathematical characterization and analysis of a feedforward 
circuit for CDMA applications,” IEEE Trans. Microwave Theory Tech., vol. 51, pp. 767-777, March 
2003. 
[7] Y. Y. Woo, Y. Yang, J. Yi, J. Nam, J. Cha and B. Kim, “An adaptive feedforward amplifier for 
WCDMA base stations using imperfect signal cancellation,” Microwave J., vol. 46, pp. 22-44, April 
2003. 
[8] C. W. Park, F. Beauregard, G. Carangelo and F. M. Ghannouchi, “An independently controllable 
AM/AM and AM/PM predistortion linearizer for cdma2000 multicarrier applications,” in Proc. IEEE 
Radio Wireless Conf., 2001, pp. 53-56. 
[9] M. Faulkner and M. Johansson, “Adaptive linearization using predistortion-experimental results,” 
IEEE Trans. Veh. Technol., vol. 43, pp. 323-332, May 1994. 
[10] L. Sundstrom, M. Faulkner and M. Johansson, “Quantization analysis and design of a digital 
predistortion linearizer for RF power amplifiers,” IEEE Trans. Veh. Technol., vol. 45, pp. 707-719, 
Nov. 1996. 
[11] J. K. Cavers, “Optimum table spacing in predistorting amplifier linearizers,” IEEE Trans. Veh. 
Technol., vol. 45, pp. 1699-1705, Sept. 1999. 
[12] K. J. Muhonen, M. Kavehard and R. Krishnamoorthy, “Look-up table techniques for adaptive 
digital predistortion: a development and comparison,” IEEE Trans. Veh. Technol., vol. 49, pp. 
1995-2002, Sept. 2000. 
[13] S. Kusunoki, K. Yanamoto and T. Iida, “Power-amplifier module with digital adaptive 
predistortion for cellular phones,” IEEE Trans. Microwave Theory Tech., vol. 50, pp. 2979-2986, 
Dec. 2002. 
[14] G. Hanington, P. F. Chen, P. M. Asbeck and L. E. Larson, “High-efficiency power amplifier 
using dynamic power-supply voltage for CDMA applications,” IEEE Trans. Microwave Theory 
26 
switching-mode power amplifiers,” IEEE Microwave and Wireless Components Lett. Aug. 2006, to 
appear. 
[30] J. K. Jau, Y. A. Chen, S. C. Hsiao, T. S. Horng and J. Y. Li, “Highly efficient multimode RF 
transmitter using the hybrid quadrature polar modulation scheme,” in IEEE MTT-S Int. Microwave 
Symp. Dig., 2006, to appear. 
[31] R. B. Staszewski et al., “All-digital PLL and GSM/EDGE transmitter in 90nm CMOS,” in IEEE 
ISSCC 2005 Dig. Tech. Papers, Feb. 2005, pp. 316-317. 
[32] R. B. Staszewski et al., “All-digital PLL and transmitter for mobile phones,” IEEE J. Solid-State 
Circuits, vol. 40, no. 12, pp. 2469-2482, Dec. 2005. 
[33] R. B. Staszewski, D.Leipold, K. Muhammad and P. T. Balsara “Digitally controlled oscillator 
(DCO)-based architecture for RF frequency synthesis in a deep-submicrometer CMOS process,” 
IEEE Trans. Circuits and Systems-II, vol. 50, no. 11, pp. 815-828, Nov. 2003. 
[34] R. B. Staszewski et al., “All-digital TX frequency synthesizer and discrete-time receiver for 
bluetooth radio in 130-nm CMOS,” IEEE J. Solid-State Circuits, vol. 39, no. 12, pp. 2278-2291, Dec. 
2004. 
[35] K. Muhammad et al., “First fully integrated quad-band GSM/GPRS receiver in a 90-nm digital 
CMOS process,” IEEE J. Solid-State Circuits, vol. 41, no. 8, pp. 1772-1783, Aug. 2006. 
[36] J. K. Jau, F. Y. Han, M. C. Du, and T. S. Horng, “Polar modulation-based RF power amplifiers 
with enhanced envelope processing technique,” in Proc. European Microwave Conf., 2004, pp. 
1317-1320. 
[37] K. C. Peng, J. K. Jau, and T. S. Horng, “A novel EER transmitter using two-point delta-sigma 
modulation scheme for WLAN and 3G applications,” in IEEE MTT-S Int. Microwave Symp. Dig., 
2002, pp. 1651-1654. 
[38] C.-J. Li, C.-T. Chen, T.-S. Horng, J.-K. Jau and J.-Y. Li, “High average-efficiency multimode 
RF transmitter using a hybrid quadrature polar modulator,” IEEE Trans. Circuits and Systems II, 
accepted. 
[39] C.J. Li, T.S. Horng, J. K. Jau  and J. Y. Li, “System design issues in a HQPM-based 
transmitter,” IEEE MTT-S International Microwave Symp., June 2007. 
[40] C. J. Li, C. T. Chen, T. S. Horng, J. K. Jau, J. Y. Li, and D. S. Deng, “Hybrid Quadrature Polar 
Modulation-based transmitter with digital predistorter for simultaneous enhancement of ACPR and 
PAE,” IET Microwaves, Antennas & Propagation, Vol. 2, No. 8, pp. 801-812, Dec. 2008. 
[41] C. T. Chen, C. J. Li, T. S. Horng, J. K. Jau, and J. Y. Li, “Design and linearization of class-E 
power amplifier for non-constant envelope modulation,” IEEE Trans. Microwave Theory and Tech., 
Vol. 57, No. 4, pp. 957-964, Apr. 2009. 
[42] C. J. Li, F. K. Wang, T. S. Horng, and K. C. Peng, “A novel RF sensing circuit using injection 
locking and frequency demodulation for cognitive radio applications,” IEEE Trans. Microwave 
Theory and Tech., Vol. 57, No. 12, pp. 3143-3152, Dec. 2009. 
[43] C. J. Li, C. H. Hsiao, F. K. Wang, T. S. Horng, and K. C. Peng, “A rigorous analysis of a 
phase-locked oscillator under injection,” IEEE Trans. Microwave Theory and Tech., Vol. 58, No. 5, 
 1
 
國科會補助專題研究計畫項下出席國際學術會議心得報告 
                                     日期：100 年 6 月 30 日 
 
計畫編號 NSC 97－ 2628 － E － 110 － 041 － MY3  
計畫名稱 高度 CMOS 積體化之混合正交極座標調制架構線性發射機 
出國人員
姓名 洪子聖 
服務機構
及職稱 國立中山大學電機系教授 
會議時間 100 年 6 月 5 日至 100 年 6 月 10 日 會議地點 美國馬里蘭州巴地摩爾市 
會議名稱 
(中文) 2011 年 IEEE 國際微波會議與 IEEE 射頻積體電路會議 
(英文) IEEE International Microwave Symposium 2011 (IMS2011) 
& IEEE Radio Frequency Integrated Circuit Symposium (RFIC2011) 
發表論文
題目 
(中文)  
1.利用兩級注入鎖定振盪器之無線極座標接收機  
(IEEE 國際微波會議) 
2.具有抵抗本地振盪源牽引之非常數波包調制直接轉頻發射機  
(IEEE 國際微波會議) 
3.能抵銷隨機身體移動偵測生理訊號之相互注入鎖定式 SIL 感測器 
(IEEE 國際微波會議) 
4.利用注入鎖定兩級壓控振盪器之 CMOS 頻譜感測器  
(IEEE 射頻積體電路會議) 
5.具有雙回朔同時輸入與雜訊匹配之寬頻共閘極低雜訊放大器 
(IEEE 射頻積體電路會議) 
 
(英文)  
1. Wireless polar receiver using two injection-locked oscillator stages for 
green radios (IMS2011) 
2. Direct-conversion transmitter with resistance to local oscillator pulling 
in non-constant envelope modulation systems (IMS2011) 
3. Mutual injection-locked SIL sensor array for vital sign detection with 
random body movement cancellation (IMS2011) 
4. A CMOS spectrum sensor using injection locking of two 
voltage-controlled oscillators for cognitive radio system (RFIC2011) 
5. Wideband common-gate low-noise amplifier with dual-feedback for 
simultaneous input and noise matching (RFIC2011) 
 3
無 
四、建議 
以上幾點心得將建議為台灣舉辦同等級之國際會議，闢如亞太微波會議，在會
議之議程、場地及註冊費安排上的重要學習參考。 
五、攜回資料名稱及內容 
所帶回來的資料，包括隨身碟形式之大會技術與專題場次論文集以及各項議程
安排資料，這些論文與資料對於本人實驗室之研究工作以及協助中山大學籌辦 2012
年亞太微波國際會議將有莫大幫助 
六、其他 
本人參加 2011 年 IEEE 國際微波會議之現場照片。 
 
 
frequency  osc t  can be replaced by ( )c v tK V t  , where 
vK  denotes the tuning sensitivity of VCO. Assume that this 
VCO is finally phase-locked with a weak injection. The 
assumptions can be mathematically restated as ( )v t cK V t   
and sin ( ) ( ) 2 / ( )osc injt t QE E t   . Therefore, the subsequent 
LO output frequency  LO t  can be approximated as   ( ) ( ) ( )LO c v t LRt K V t t t                    (2) 
where  
( )
( )
2
injc
LR
osc
E t
t
Q E
                                (3) 
is interpreted as the time-varying locking range of a free-
running oscillator with a time-varying amplitude injection 
signal. In (2), ( ) ( )LR t t   can be regarded as an equivalent 
injection-induced source that causes FM in the LO. Roughly, 
( )LR t  and ( )t are attributed mainly to the AM-FM and 
PM-FM distortion, respectively, caused by the time-varying 
amplitude injection signal. Integrating (2) yields the resulting 
LO output phase as 
 0( ) ( ) ( ) ( )LO c v t LRt t K V t dt t t dt          
, ,( ) ( ) ( )c f pll f injt t t                           (4) 
where 0  and ( )c t  represent an initial oscillation phase and 
an instantaneous synthesized carrier phase. The phase 
fluctuation terms, , ( )f pll t  and , ( )f inj t , in (4) are caused by 
the PLL and injection-locking process, respectively.  
When the LO enters a self-injection-locking state by an 
insertion of the LO-modulated signal into the injection port of 
the VCO via an outer feedback path, the injection signal phase 
( )inj t  can be regarded as a delayed LO output phase ( )LO t  
plus a delayed DCT output phase modulation ( )m t . Based on 
the assumption of narrow modulation bandwidth, ( )t  can be 
approximated as 
 ( ) ( ) ( )LO o m o LOt t t t                        (5) 
where o represents the time delay of the self-injection path. 
Based on the above derivations, the phase dynamics of all 
signals of interest in the LO under modulated outer self-
injection can be modeled as shown in Fig. 2, where, with 
respect to the PLL parameters, dK  denotes the combined gain 
of the phase frequency detector (PFD) and the charge pump 
(CP); ( )f t  represents the impulse response of the loop filter; 
N is the divider modulus; ( )ref t is the phase of the reference, 
and ( )e t  is the output phase error of the PFD. Although such 
a phase dynamic model does not include the PA gain and self-
injection path loss, they both will be concealed in the injection 
signal amplitude ( )injE t , and thus, the locking range  ( )LR t . 
Consider that the output signal for an LO under modulated 
outer self-injection is given by 
      ( )Re Re j t tj t c fLOLO osc oscS t E e E e              (6) 
where 0 , ,( ) ( ) ( )f f pll f injt t t       is regarded as an 
instantaneous phase fluctuation function, caused by the 
interaction between PLL and the self-injection-locking 
process. The following calculation to determine the output 
signal involves the instantaneous phase fluctuation function  f t  only without using the synthesized carrier frequency 
c . Therefore, it has the advantages of a fast computability. 
 In the discrete-time domain, the instantaneous phase 
fluctuation function can be represented as 
0 ,[ ] [ ] [ ]f v t f injn K V n nT n                 (7) 
where 
, ,[ ] [ 1] [ ] [ ]f inj f inj LRn n n n T               (8) 
and T  is the calculation time step. With the discrete-time 
representation of the PLL process, [ ]tV n  in (7) can be 
expressed as 
[ ] [ ] [ ]t d eV n K n f n                       (9) 
where 
[ ] [ 1] /e fn n N    .                     (10) 
To obtain the LO output signal, the instantaneous phase 
fluctuation function is finally expressed as a pulse train that is 
weighted by [ ]f n , given by (7). The LO output waveform is 
of the form 
     cosLO osc c f r
n
S t E t n h t nT               (11) 
where  rh t  is the impulse response of the reconstruction 
filter. Subsequently, the transmission signal is simulated using 
an Agilent EEsof ADS Ptolemy, to which are input the LO 
output waveform data that were calculated from (11). 
III. IMPROVEMENT APPROACH 
    Fig. 3 presents the experimental prototype of the proposed 
DCT, which is utilized to demonstrate the improvement in LO 
spectral purity and quality of the transmission signal achieved 
by applying a second-point VCO modulation and an inner 
self-injection. The DCT includes an LO, IQ modulator, and 
PA in an original architecture. In the experiments, the LO is 
locked at 2.15 GHz, delivering an oscillation power of 0 dBm. 
To imitate the pulling phenomenon, the DCT output signal is 
fed back to the LO via a delay line with time delay o , an 
attenuator, and a combiner, and thus serves as a modulated 
outer self-injection signal into the LO. This experiment is 
performed with Quadrature-Phase-Shift-Keying (QPSK) 
modulation at a 1.2288 Mb/s data rate, which is normally 
adopted in cdma2000 1x systems. The baseband I and Q 
component signals are provided by an Agilent E4438C vector 
signal generator. The following subsections explain the theory 
of the adopted second-point VCO modulation and inner self-
injection approaches which can effectively reduce the AM-
FM and PM-FM distortions in the DCT. 
Fig. 2. Phase dynamics model of a PLL synthesized LO pulled by a non-
constant envelope modulated self-injection signal.  
 
978-1-61284-757-3/11/$26.00 C2011 IEEE
  ( )( )
( )
1 ( )
m
v t LR o
LO
LR o LRi i
d tK V t t
dtt
t

   
 
                 (21) 
Equation (21) clearly reveals that the residual FM distortion 
term ( ) ( ) /LR o mt d t dt    in the nominator can be effectively 
suppressed by increasing the product of the inner self-
injection locking range LRi  and path delay i  in the 
denominator. 
IV. RESULTS AND DISCUSSION 
Fig. 5 compares the error vector magnitudes (EVMs) 
achieved using various improvement approaches. In this 
figure, the blue broken line, red dotted line, and black solid 
line represent the improvements achieved by applying only 
second point VCO modulation approach, only inner self-
injection approach and the above two approaches in 
combination, respectively. The dark gray solid line represents 
the EVM results when no improvement approach was utilized, 
while the light gray broken-dotted line plots the EVM 
minimum required specifications for a cdma2000 1x system. 
The measurements are highly consistent with the theoretical 
predictions. Additionally, the EVMs are significantly 
improved using the combined approach, by up to 
approximately 40%, as the modulated outer self-injection 
power increases up to -45 dBm. 
 Fig. 6 shows how the effects of pulling on transmitted 
output spectral regrowth at a modulated outer self-injection 
power of -45 dBm, and compares the improved results among 
different approach options. The comparison reveals severe 
spectral regrowth in the pulled spectrum without improvement, 
but the proposed approaches substantially improve this 
phenomenon. Table I summarizes the comparison of the 
simulated and measured adjacent channel power ratios 
(ACPRs). The proposed combined approach markedly 
improves ACPR by around 26 dB at frequency offsets of 885 
kHz and 1.25 MHz. 
V. CONCLUSION 
 This study considers the effects of LO pulling on a 
cdma2000 1x DCT that uses QPSK modulation. The FM 
distortion of the transmission signal that is caused by the 
pulled LO can be effectively mitigated by the proposed 
second-point VCO modulation and inner self-injection 
approaches. The simulation and measurement results correlate 
well with each other, showing that, with the combination of 
the two approaches, the transmit signal quality is greatly 
improved to meet the EVM and ACPR requirements up to a 
modulated injection power level of -45 dBm. Future works 
will extend this study to more complex modulation systems, 
such as WiMAX and LTE. 
ACKNOWLEDGMENT 
This work was supported in part by the National Science 
Council, Taiwan, under Grant 97-2628-E-110-041-MY3 and 
by the Department of Industrial Technology, Taiwan, under 
Grant 99-EC-17-A-01-S1-104. The authors wish to thank the 
National Chip Implementation Center, Taiwan, for providing 
the IC foundry service and measurement support. 
REFERENCES 
[1] B. Razavi, “RF transmitter architectures and circuits,” in Proc. IEEE 
Custom Integrated Circuits Conf., San Diego, CA, 1999, pp. 197–204. 
[2] B. Razavi, “A study of injection locking and pulling in oscillators,” 
IEEE J. Solid-State Circuits, vol. 39, no. 9, pp. 1415–1424, Sep. 2004. 
[3] J. Dominguez, A. Suarez, and S. Sancho, “Semi-analytical formulation 
for the analysis and reduction of injection-pulling in front-end 
oscillators,” in IEEE MTT-S Int. Microw. Symp. Dig., Jun. 2009, pp. 
1589–1592. 
[4] C.-J. Li, C.-H. Hsiao, F.-K. Wang, T.-S. Horng, and K.-C. Peng, “A 
rigorous analysis of a phased-locked oscillator under injection,” IEEE 
Trans. Microw. Theory and Tech., vol. 58, no. 5, pp. 1391–1400, May 
2010. 
[5] I. Bashir, R.-B. Staszewski, O. Eliezer, K. Waheed, V. Zoicas, N. Tal, J. 
Mehta,  M.-C. Lee, P.-T. Balsara, and B. Banerjee, “An EDGE 
transmitter with mitigation of oscillator pulling,” in IEEE Radio 
Frequency Integrated Circuit Symp. Dig., pp. 13-16, May 2010. 
[6] C.-H. Hsiao, C.-J. Li, F.-K. Wang, T.-S. Horng, and K.-C. Peng, 
“Analysis and improvement of direct-conversion transmitter pulling 
effects in constant envelope modulation systems,” IEEE Trans. Microw. 
Theory and Tech., vol. 58, no. 12, pp. 4137-4146, Dec. 2010. 
[7] R. Adler, “A study of locking phenomena in oscillators,” Proc. IRE, vol. 
34, no. 6, pp. 351–357, Jun. 1946. 
-65 -60 -55 -50 -45
Modulated Outer Self-injection Power Level (dBm)
0
10
20
30
40
50
EV
M
 (%
 rm
s)
Not improved
Improved by second point VCO modulation
Improved by inner self-injection
Improved by both methods
cdma2000 1x specification
Measurement
 
Fig. 5. Comparison of transmitter EVMs among different improvement 
options. 
2.1475 2.1485 2.1495 2.1505 2.1515 2.1525
Freqeuncy (GHz)
-90
-80
-70
-60
-50
-40
-30
-20
-10
0
10
20
Tr
an
sm
it 
Sp
ec
tr
um
 (d
B
m
)
Not improved
Improved by second point VCO modulation
Improved by inner self-injection
Improved by both methods
2.1475 2.1485 2.1495 2.1505 2.1515 2.1525
Freqeuncy (GHz)
-90
-80
-70
-60
-50
-40
-30
-20
-10
0
10
20
Tr
an
sm
it 
Sp
ec
tr
um
 (d
B
m
)
Not improved
Improved by second point VCO modulation
Improved by inner self-injection
Improved by both methods
(a)                                                     (b) 
Fig. 6.  Comparison of transmitter output spectra among different 
improvement options. (a) Measured results. (b) Simulated results. 
      TABLE I. COMPARISON OF ACPR RESULTS 
Measurement Bandwidth 30 kHz 
Channel Bandwidth 1.25 MHz 
Frequency Offset 885 kHz 1.25 MHz 
cdma2000 1x Specification -45 dB -45 dB 
ACPR w.r.t.
Pulled Spectrum 
(Pinj = -45 dBm) 
Sim. Mea. Sim. Mea.
-28.09 dB -26.73 dB -34.41 dB -33.55 dB
ACPR w.r.t. 
Improved Pulled Spectrum -54.12 dB -52.51 dB -60.63 dB -60.74 dB
  
978-1-61284-757-3/11/$26.00 C2011 IEEE
 noise, respectively,  bb s  is the baseband phase detection 
output, and  v s  is the phase modulation that is introduced 
in the SIL path by the Doppler effect. In the SIL process,  
tank2
injosc
LR
osc
E
Q E

                                   (1) 
is interpreted as the locking range [8] of an SIL oscillator 
where osc , tankQ , oscE  and injE  denote the oscillation 
frequency, tank quality factor, oscillation amplitude, and 
injection amplitude, respectively. Moreover, 2 osc p     
represents the phase delay associated with the SIL path.  
According to Fig. 2, the oscillator output phase shift can be 
found as 
         out m v o ns H s s H s s   	 
 	              (2) 
where, for 1ps   
     2
cos cos
1 cos 2cos 1 p
LR LR
m s
LR pLR
H s
ss e 
   
    
 
 

  	
  	 
  (3) 
is a transfer function of integration with respect to  v s  and 
   2
1
1 cos 2cos 1 p
o s LR pLR
sH s
s e      
 

  	
  	 
   (4) 
is a transfer function of suppression with respect to  n s . To 
extract the phase-modulation signal, a frequency demodulator 
that is based on delay-line discrimination is subsequently used 
to process the oscillator output signal. For a time delay d  in 
the delay-line discrimination process, the baseband phase 
detection output can be expressed as 
  cos( ) ( )
1 2 cos
LR d
bb out d v
LR p
s s s s
  
   
  
 	
 	  	

  	
               
( )
1 2 cos
d
o
LR p
s
s


  

 	

  	
         (5) 
From (5), the equivalent model in Fig. 2 behaves as a first-
order delta-sigma modulator for noise shaping to enhance the 
signal-to-noise ratio (SNR) of the phase-modulation signal. 
The SIL mechanism acts like an integrator to reinforce the 
low-frequency components of phase-modulation signal, and 
like an attenuator to suppress the phase noise. In contrast, 
frequency demodulation involves a differential operation to 
restore the phase-modulation signal without distortion and, in 
the meantime, push the phase noise out of the modulation 
bandwidth to higher frequencies. The SNR gain is defined as 
the ratio between the SNR after to that before the delta-sigma 
modulation process, and it is of the form 
 
 
2 2
2
cos
.m LRSNR
o
H s
G
sH s
 
                     (6) 
III. CANCELLATION OF EFFECTS OF RANDOM BODY 
MOVEMENT 
Fig. 3 displays the proposed two-sensor array for cancelling 
the effects of random body movement on the detection of vital 
signs. In Fig. 3, a subject is assumed to move back and forth 
randomly between two SIL sensors, one front and one rear, 
with an instantaneous displacement  bx t . The two sensors, 
SIL sensors 1 and 2, with different locking ranges, 1LR  and 
2LR , are mutually injection-locked to each other through the 
sensors’ transmitting and receiving antennas with proper beam 
width and direction. Notably, in Fig. 3, the round trip 
propagation delays from SIL sensors 1 and 2 to the subject 
and back equal 12 p  and 22 p , respectively, and the 
propagation delay over a body thickness equals b . Therefore, 
the one-way propagation delay s  between two sensors can 
be regarded as 1 2p p b  
 
 . The effects of random body 
movement can be cancelled by matching the propagation 
delays of the SIL paths of the two sensors. Once a mismatch 
happens, the phase shifter that is used in SIL sensor 1 
provides a tunable phase shift c  for compensation.  
Fig. 4 shows the equivalent frequency-domain model for 
the proposed mutual injection-locked two-sensor array. Under 
the MIL condition, the oscillator output phase signals in both   
sensors can be found as 
     11 2 1
1 1
sLR ss s out
LR LR
ss s e s
s s
  
 
 


 

       (7) 
      22 1 2
2 2
sLR ss s out
LR LR
ss s e s
s s
  
 
 


 

      (8) 
where 
        1 1 1 1( ) ( )out m v b o ns H s s s H s s    	  
 	        (9) 
        2 2 2 2( ) ( )out m v b o ns H s s s H s s    	 
 
 	    (10) 
are the oscillator output phase shifts in both sensors under the 
SIL condition. Notably, in (9) and (10), ( )v s  and ( )b s  
represent the phase modulation due to vital sign and 
movement of the body, respectively. Since the vital sign 
causes an inward-and-outward chest motion, whereas the 
body movement is back-and-forth, the resultant phase 
modulation in the detection output of the SIL sensors 1 and 2 
( )v s( )n s
( )out s
2 pse 
cosLR
s
 ds( )bb s
Self-injection-locking 
process
Delay-line 
discrimination
 
Fig. 2. Frequency-domain model of SIL sensor. 
 
1p
1p
2p
2p
Tx Ant.
Rx Ant.
1
SIL path w/ 
 delay 2 p 2
SIL path w/ 
 delay 2 p
1 2MIL path w/ delay 
 
p p b  
1 2MIL path w/ delay 
 
p p b  
Rx Ant.
Tx Ant.
c
Phase 
Shifter
( )bx t
SIL 
Sensor 1
LR 1
inj
outfdo( )bbS t
SIL 
Sensor 2
out
inj
fdo
LR 2
not
used
Fig. 3. Proposed mutual injection-locked SIL sensor array for
cancelling effects of random body movement on vital sign detection.
2( )
 sss s e
1( )out s
1( )s s 1LR
s

1ds( )bb s
Mutual-injection-
locking process
Delay-line 
discrimination
1( )
 sss s e
 2( )out s
2( )s s
2ds
Delay-line 
discrimination
not 
used
SIL Sensor 1 SIL Sensor 2
2LR
s

Mutual-injection-
locking process
Fig. 4. Frequency-domain model of proposed mutual injection-
locked SIL sensor array. 
978-1-61284-757-3/11/$26.00 C2011 IEEE
 computed for comparison. The rms values that correspond to 
the three motion signals with maxbx equal to 1, 2 and 3 cm are 
0.7857, 1.2814 and 1.7591 V, respectively, from the one-
sensor detection results, but only 0.0096, 0.0326 and 0.074 V, 
respectively, from the two-sensor array detection results. The 
reduction percentages are therefore 98.8, 97.5 and 95.8 %, 
respectively, revealing a decrease in cancellation with 
increasing upper displacement limit. 
In the cardiopulmonary monitoring, an adult subject was 
seated approximately in the middle of the 2 m spaced two-
sensor array under the same operating conditions as in the 
preceding experiment. This subject was breathing normally 
and moving slowly and randomly with a displacement of 
several centimeters. Figs. 7(a) and 7(b) show the output 
waveform from only one sensor and the two-sensor array, 
respectively. Noably, a digital filter with the passband 0.1 – 
10 Hz is applied to the baseband detection output signals. 
Comparing Figs. 7(a) and 7(b) demonstrates that the two-
sensor results, with random body movement cancellation, 
yield a more uniform waveform than the one-sensor results 
without cancellation. This is because the latter includes the 
effects of random body movement which cause a non-uniform 
swing in the waveform, whereas the former cancels these 
effects. Taking the Fourier transform of the results in Figs. 7(a) 
and 7(b) yields the detection output spectra in Figs. 8(a) and 
8(b). The respiration signal can be clearly identified in the 
one-sensor results but distinghusing between the heartbeat 
signal and the random body motion signal is difficult. In 
contrast, both respiration and heartbeat signals can be clearly 
identified in the two-sensor array results with random body 
movement cancellation. 
V. CONCLUSION 
This paper presents a novel SIL sensor array architecture 
that can eliminate the effects of random body movement on 
vital sign detection using MIL techniques. This study also 
develops a theoretical model to derive the conditions for 
cancelling the Doppler shift due to random body motion, and 
meanwhile obtaining the best SNR for the proposed 
architecture. Experiments on actuator-controlled motion 
experiments verify the theoretical predictions of excellent 
cancellation of Doppler shift that is caused by back-and-forth 
motion. In practical cardiopulmonary monitoring, the 
proposed architecture provides high-quality sensing of the 
cardiopulmonary activities of a subject who is allowed to 
move slowly and randomly.  
ACKNOWLEDGMENT 
This work was supported in part by the National Science 
Council, Taiwan, under Grant 97-2221-E-110-035-MY3 and 
by the Department of Industrial Technology, Taiwan, under 
Grant 99-EC-17-A-01-S1-104. The authors wish to thank the 
National Chip Implementation Center, Taiwan, for providing 
the IC foundry service and measurement support. 
REFERENCES 
[1] A. D. Droitcour, O. Boric-Lubecke, V. M. Lubecke, J. Lin, and G. T. A. 
Kovac, “Range correlation and I/Q performance benefits in single-chip 
silicon Doppler radars for noncontact cardiopulmonary monitoring,” 
IEEE Trans. Microw. Theory Tech, vol. 52, no. 3, pp. 838-848, Mar. 
2004. 
[2] Y. Xiao, J. Lin, O. Boric-Lubecke, and V. M. Lubecke, “Frequency 
tuning technique for remote detection of heartbeat and respiration using 
low-power double-sideband transmission in the Ka-band,” IEEE Trans. 
Microw. Theory Tech., vol. 54, no. 5, pp. 2023-2032, May 2006. 
[3] T.-Y. Chin, K.-Y. Lin, S.-F. Chang and C.-C. Chang, “A fast clutter 
cancellation method in quadrature Doppler radar for noncontact vital 
signal detection,” in IEEE MTT-S Int. Microwave Symp. Dig., May 2010, 
pp. 764-767. 
[4] F.-K. Wang, C.-J. Li, C.-H. Hsiao, T.-S. Horng, J. Lin, K.-C. Peng, J.-K. 
Jau, J.-Y. Li, and C.-C. Chen, “A novel vital-sign sensor based on a self-
injection-locked oscillator,” IEEE Trans. Microw. Theory Tech., vol. 58, 
no. 12, pp. 4112-4120, Dec. 2010. 
[5] I. Mostafanezhad, O. Boric-Lubecke, V. Lubecke, and D. P. Mandic, 
“Application of empirical mode decomposition in removing fidgeting 
interference in Doppler radar life signs monitoring devices,” in Proc. 
IEEE Engineering in Medicine and Biology Society Annu. Int. Conf., 
Sep. 2009, pp. 340-343. 
[6] C. Li and J. Lin, “Random body movement cancellation in Doppler radar 
vital sign detection,” IEEE Trans. Microw. Theory Tech., vol. 56, no. 12, 
pp. 3143-3152, Dec. 2008. 
[7] R. Fletcher and J. Han, “Low-cost differential front-end for Doppler 
radar vital sign monitoring,” in IEEE MTT-S Int. Microwave Symp. Dig., 
Jun. 2009, pp. 1325-1328. 
[8] R. Adler, “A study of locking phenomena in oscillators,” Proc. IRE, vol. 
34, no. 6, pp. 351–357, Jun. 1946. 
10 15 20 25 30
Time (s)
-3
-2
-1
0
1
2
3
Se
ns
or
 D
et
ec
tio
n 
   
   
O
ut
pu
t (
V)
 
          (a) 
10 15 20 25 30
Time (s)
-3
-2
-1
0
1
2
3
Se
ns
or
 D
et
ec
tio
n
   
   
O
ut
pu
t (
V)
 
            (b) 
Fig. 7. Comparison of detection output waveforms between one 
sensor and two-sensor array. (a) One sensor. (b) Two-sensor array.
0 0.5 1 1.5 2
Frequency (Hz)
0
0.2
0.4
0.6
0.8
1
  S
en
so
r D
et
ec
tio
n 
O
ut
pu
t S
pe
ct
ru
m
 (V
)
Respiration
Unrecognizable
  
0 0.5 1 1.5 2
Frequency (Hz)
0
0.2
0.4
0.6
0.8
1
 S
en
so
r D
et
ec
tio
n
O
ut
pu
t S
pe
ct
ru
m
 (V
)
Respiration
Heartbeat
2nd harmonic
of respiration
                              (a)                                                   (b) 
Fig. 8. Comparison of detection output spectra between one sensor 
and two-sensor array. (a) One sensor. (b) Two-sensor array. 
 
978-1-61284-757-3/11/$26.00 C2011 IEEE
 the ILO model and synchronization conditions derived in [6], 
when an oscillator with an inherent oscillation frequency ( )osc tω  is under injection, the resultant ILO output signal can 
be regarded as a vector that is rotating clockwise with an 
instantaneous beat frequency ( )d t dtα  with respect to the 
injection frequency ( )inj tω , as given by 
( ) ( )osc osc ot d t dtω ω θ= +                          (1) 
( ) ( )inj inj it d t dtω ω θ= +                            (2) 
( ) ( ) ( ) ( )oscd t dt B t t tα β ω= − ⋅ + Δ                   (3) 
where 
( ) ( ) ( )
2
osc inj
osc
t E t
B t
Q E
ω ⋅= ⋅                              (4) 
( ) ( )( ) ( )
sin
1 cosinj
osc
t
t
E t
t
E
αβ
α
=
+ ⋅
                         (5) 
( ) ( ) ( )osc osc injt t tω ω ωΔ = − .                       (6) 
Here, ( )od t dtθ  and ( )id t dtθ  denote the instantaneous 
modulation frequencies of inherent oscillator output and 
injection signals, respectively. ( )injE t  and oscE  represent the 
time-varying and constant amplitudes of the injection and 
oscillation signals, respectively. Q  is the quality factor of the 
tank circuit of the oscillator. 
Equation (3) is a generalized locking equation that describes 
the phase dynamics of an ILO with all possible injections of 
modulated signals [6]. In this equation, ( ) ( )B t tβ  can be 
regarded as an equivalent injection-induced source that causes 
frequency modulation in the LO. Roughly, ( )B t  and ( )tβ  are 
attributed mainly to the AM-FM and PM-FM effect, 
respectively, caused by the time-varying amplitude injection 
signal. The following receivers that use ILOs are based on the 
assumptions that injection locking is valid while an ILO is 
injected with a weak signal and the inherent oscillation 
frequency is tuned to the injection frequency. Once the 
synchronization condition is established, the instantaneous 
beat frequency is equal to the instantaneous modulation 
frequency of the injection signal. That is 
( ) ( )id t dt d t dtα θ= .                       (7) 
Therefore, the instantaneous frequency of the ILO would be  
( ) ( ) ( )out inj inj it d t dt d t dtω ω α ω θ= + = + .        (8) 
B. ILQR 
 
 
 
 
 
 
 
Fig. 2. Small-signal block diagram of an ILQR. 
Fig. 2 displays the small-signal block diagram of an ILQR 
using one ILO. The mixer is regarded as an ideal multiplier, 
and its output ( )1m t  can be expressed as 
( ) ( ) ( )1 inj outm t S t S t= ⋅  
( ) ( ) ( )cos cosinj inj osc outE t t t E t tω ω⎡ ⎤= ⋅ ⋅ ⋅⎡ ⎤⎣ ⎦⎣ ⎦               
( ) ( )1 1 cos 2 2
2
i
osc inj inj
d t
E E t t
dt
θω⎧ ⎫⎡ ⎤⎛ ⎞⎪ ⎪= + + ⋅⎢ ⎥⎜ ⎟⎨ ⎬⎢ ⎥⎝ ⎠⎪ ⎪⎣ ⎦⎩ ⎭
.      (9) 
After filtering out the high frequency component with a low-
pass filter, the baseband in-phase component ( )X t  is 
obtained as 
( ) ( )1
2 osc inj
X t E E t= .                           (10) 
Similarly, ( )2m t  is found by 
( ) ( ) ( )2 inj outm t S t S t τ= ⋅ −                       (11) 
where τ  stands for the group delay caused by the 90D  phase 
shifter in the operating band and is equal to 
2 inj
πτ ω= .                                      (12) 
Under the assumption that τ  is small, the baseband 
quadrature-phase component ( )Y t  is approximated as 
( ) ( ) ( )
2
i
osc inj
d t
Y t E E t
dt
θτ≈ .                     (13) 
From (10) and (13), the instantaneous modulation envelope 
and frequency components are calculated by 
2 ( )( )inj
osc
X tE t
E
=                                    (14) 
( )
( )
( )i Y td t
dt X t
θ
τ= .                                 (15) 
The instantaneous modulation phase component ( )i tθ  can 
be further evaluated by integrating (15) over time. 
Subsequently, with the help of CORDIC algorithm for polar-
to-rectangular coordinate transformation, we obtain the 
receiver quadrature output signal components in a digital 
signal processing (DSP) unit.  
C. Polar Receiver 
 
 
 
 
 
 
 
Fig. 3. Small-signal block diagram of proposed polar receiver. 
( )injS t
( )outS t
( )2m t ( )tY
( )tX( )1m t
o90
( )injS t
( ),1outS t
( )tX
( )3m t
( ),2outS t
o90 ( )tΛ
978-1-61284-757-3/11/$26.00 C2011 IEEE
  
 
 
 
 
 
 
(a) 
 
 
 
 
 
 
 
(b) 
 
 
 
 
 
 
 
 
 
 
(c) 
Fig. 6. Demodulated (a) envelope, (b) phase and (c) constellation of 
QPSK signal at 2 Msps and a received power of -40 dBm. 
 
 
 
 
 
 
 
 
 
 
 
(a)                                                   (b)                     
Fig. 7. Demodulated EVMs of (a) π/4 DQPSK and (b) QPSK versus 
received power at various symbol rates. 
 
Fig. 7(a) and 7(b) plot the measured EVMs of π/4 DQPSK 
and QPSK demodulation versus received power at various 
symbol rates for the polar receiver. According to the 
comparison, the EVMs of π/4 DQPSK are generally better 
than those of QPSK at the same received power and symbol 
rate. This is because QPSK signal has a higher peak-to-
average power ratio (PAPR) than π/4 DQPSK signal, which 
will cause more serious AM-to-FM effect. Furthermore, 
higher demodulation quality was identified around a received 
power of -40 dBm in the current experimental setup. 
Accordingly, the experiments support two important 
observations about the polar receiver. Firstly, the sensitivity of 
the receiver is determined by the minimum injection power 
level for locking the oscillator of the first stage, and can be 
much improved by using a low-noise amplifier prior to this 
oscillator. Secondly, nonlinear distortion may occur at high 
injection power levels. Therefore, a mechanism for bypassing 
over-level received signals is suggested for this receiver.  
IV. CONCLUSION 
A novel polar receiver using two ILO stages is presented. 
The receiver prototype demodulates π/4 DQPSK and QPSK 
signals with 7.5% EVM and 8.2% EVM, respectively, both at 
2 Msps and a received power of -40 dBm. Owing to the 
injection locking, the proposed receiver is not required to use 
any carrier recovery circuitry, and thus more appropriate for 
energy-efficient designs for short-range wireless 
communication applications. Our future work will focus on 
circuit optimization, mainly in the ILO design, to improve the 
distortion of this receiver. 
ACKNOWLEDGEMENT 
This work was supported in part by the National Science 
Council, Taiwan, under Grant 97-2628-E-110-041-MY3 and 
by the Department of Industrial Technology, Taiwan, under 
Grant 99-EC-17-A-01-S1-104. The authors wish to thank the 
National Chip Implementation Center, Taiwan, for providing 
the IC foundry service and measurement support. 
REFERENCES 
[1] S. Armour, et al., “Green radio: sustainable wireless networks,” 
[Online] Available: http://kn.theiet.org/magazine/rateit/ 
communications/green-radio-article.cfm, 2009. 
[2] J. M. Lopez-Villegas and J. J. S. Cordoba, “BPSK to ASK 
signal conversion using injection-locked oscillators— part I: 
theory,” IEEE Trans. Microw. Theory Tech., vol. 53, no. 12, pp. 
3757-3766, Dec. 2005. 
[3] H. Yan, J. G. Macias-Montero, A. Akhnoukh, L. C. N. de 
Vreede, J. R. Long, J. J. Pekarik, and J. N. Burghartz, “A 120 
μW fully-integrated BPSK receiver in 90nm CMOS,” in IEEE 
Radio Frequency Integrated Circuits Symp. Dig., 2010, pp. 277-
280. 
[4] J. P. Costas, “Synchronous communications,” Proc. IRE, vol. 47, 
pp. 2058-2068, 1959. 
[5] M. A. Tarar and Z. Chen, “A direct down-conversion receiver 
for coherent extraction of digital baseband signals using the 
injection locked oscillators,” in IEEE Radio and Wireless Symp. 
Dig., 2008, pp. 57-60. 
[6] C.-J. Li, C.-H. Hsiao, F.-K. Wang, T.-S. Horng, and K.-C. Peng, 
“A rigorous analysis of a phase-locked oscillator under 
injection,” IEEE Trans. Microw. Theory Tech., vol. 58, no. 5, pp. 
1391-1400, May 2010. 
-50 -45 -40 -35 -30 -25 -20
Received Power (dBm)
5
7
9
11
13
15
17
19
EV
M
 (%
)
500 ksps
1 Msps
2 Msps
-50 -45 -40 -35 -30 -25 -20
Received Power (dBm)
5
7
9
11
13
15
17
19
EV
M
 (%
)
500 ksps
1 Msps
2 Msps
0 2 4 6 8 10
Time (μs)
0
0.5
1
1.5
2
En
ve
lo
pe
 (V
) Source ILQR Polar Receiver
0 2 4 6 8 10
Time (μs)
-280
-200
-120
-40
40
120
200
280
Ph
as
e 
(D
eg
) Source ILQR Polar Receiver
-1.2 -0.6 0 0.6 1.2
-1.2
-0.6
0
0.6
1.2
Source
ILQR
Polar Receiver
978-1-61284-757-3/11/$26.00 C2011 IEEE
amplifier (LNA) amplifies the received signal. The 
amplified signal 
 injS t  is input to the CMOS spectrum 
sensor. This chip contains a swept oscillator with an 
injection input to receive the injection signal 
 injS t , and 
a frequency discriminator that is composed of a mixer and 
a delay element. An off-chip low-pass filter (LPF) is 
applied and outputs a signal 
 LPFS t  to diagnose the 
spectrum activity. Accordingly, communications can be 
established in unoccupied frequencies for cognitive radios. 
As depicted in Fig. 2, the free-running VCO generates 
an inherent oscillation signal 
 oscS t  with instantaneous 
frequency 
 osc t  and constant amplitude oscE . When 
the VCO operates under an injection signal 
 injS t  with 
instantaneous frequency 
 inj t  and constant amplitude 
injE , the resultant output signal is represented as  outS t  
with instantaneous frequency 
 out t  and constant 
amplitude outE . The sweeping voltage )(tVt is adopted to 
tune the free-running frequency )(tosc  of the oscillator 
and perform spectrum scanning in the aimed frequency 
range. 
Based on Adler’s analysis [7], 
 outS t  can be regarded 
as a vector that rotates clockwise with a beat frequency 
 
d t dt  with respect to 
 injS t , and  t  is the 
instantaneous phase difference from 
 injS t  to  oscS t . 
The instantaneous VCO output frequency 
 out t  is 
represented as 
   
 

  out inj
d t
t t
dt
.                        (1) 
The generalized Adler’s equation gives 
)(
)(cos1
)(sin
2
)()( t
t
E
E
t
E
E
Q
t
dt
td
osc
osc
injosc
injosc







	    (2) 
where Q  is a quality factor of the tank circuit. 
 
 osc t  
defines the frequency separation between the oscillation 
frequency )(tosc  and the injection frequency )(tinj .  
Therefore, 
         osc osc inj c V t injt t t K V t t .      	   	   (3)                     
where VK  is the tuning sensitivity and c  is the center 
frequency of the VCO. Substituting (2) and (3) into (1) 
yields the instantaneous VCO output frequency: 

 
 
sin ( )( ) ( ) 1
2 cos ( )
out c V t
osc inj
tt K V t
Q E E t

 

 
 
   	
 

 
. (4) 
Since the periodic ramp signal ( )tV t  that is plotted in 
Fig. 2 enters the tuning terminal of the swept oscillator. 
Fig. 3 explains the spectrum sensing principle. 
 osc t  is 
continuously sweeping in the sensing frequency range 
from L  to H . L  and H  are the lower and higher 
VCO inherent frequencies, respectively, with a frequency 
offset from the injection frequency inj  by a locking 
range LR , i.e.,   2H L LR   	  . In the period of 
tuning 
 osc t  from L  to H ,  oscS t  falls in the 
locking range, the beat frequency
 
d t dt  approaches 
zero as time increases, and so the instantaneous phase 
difference 
 
t  between 
 injS t  and  oscS t  approaches 
a constant in the steady state, 

, from the initial value 
0 . From (2), the maximum osc takes place when 
cos /inj oscE E  	 . Based on the assumption that the 
VCO has a small tuning range, the locking range can then 
be found as 
2
1
1
2








	

osc
injosc
injc
LR
E
EE
E
Q

 .                    (5) 
Fig. 2 also illustrates the frequency demodulation of the 
sensing circuit. The swept oscillator output signal 
 outS t  
is input to the discriminator and output to the LPF, 
resulting in the low-pass filtered signal 
 LPFS t . 
According to (4), both frequency scanning and the 
injection signal affect the output frequency. When the 
injection signal is outside the locking range during the 
scanning of oscillation frequency, the VCO will exhibit 
injection pulling behavior and its output frequency 
 out t  will be modulated with  d t dt  to induce an 
additional time-varying beat frequency, which can be 
filtered out by the LPF. When osc  is smaller than LR , 
the pull-in process pulls the oscillator output frequency 
 out t  to lock on the injection frequency inj  [7]. More 
generally,
 LPFS t  has the same waveform characteristic 
as 
 tV t , owing to the discriminator and the LPF, when 
the oscillator is not injection-locked. However, as depicted 
in Fig. 2, a flat zone appears in 
 LPFS t  because of the 
injection locking of the oscillator. The period of the flat 
zone lT  is given by 
LR
lT SR




                                   (6) 
 
Fig. 2. Proposed spectrum sensor architecture. 
sweep
oscP
Power
L 'L 'H Hinj
injP
Frequency
2 LR
 
Fig. 3. Illustration of the spectrum sensing principle. 
 
IV. SPECTRUM SENSING RESULTS AND DISCUSSION 
This section presents results concerning the use of the 
spectrum sensor to sense a combination of three 
independent modulating signals. Fig. (6) presents the 
spectrum of these signals. The first is an FM signal at 
1f  2.419 GHz with 1P  -85 dBm and a modulation 
bandwidth of 320 kHz; the second is a QPSK signal at 
2f  2.44 GHz with 2P  -103 dBm and a data rate of 1 
Mbps; the third is a GMSK signal at 3f  2.45 GHz with 
3P  -99 dBm and a data rate of 271 kbps. The combined 
signal was first amplified by an external LNA with 28 dB 
power gain and then fed into the sensor IC. Fig. 7 shows 
the low-pass filter output of the sensor IC. In this figure, 
three flat zones are observed at different times, 
corresponding to the three above signals in the 
environment. Table II summarizes the estimates of 
frequency and power made using (7) and (8), which agree 
well with the measurements. 
V. CONCLUSION 
This paper has presented a CMOS spectrum sensor that 
can detect the frequency and power of wireless 
communication signals in the specified spectral range, and 
thus suitable for cognitive radio applications. The 
proposed design differs from conventional approaches by 
the use of the injection locking of VCOs to eliminate the 
need for a frequency synthesizer. The main advantages are 
low circuit complexity and high scanning speed. The 
measurement results indicate that the implemented sensor 
can perform accurate spectrum sensing in the 2.4-2.484 
GHz ISM band with frequency (in Hz) error and power (in 
dBm) error of less than 0.2% and 5%, respectively, for 
signals of over -103 dBm at a fast scanning speed of 100 
MHz/ms. 
ACKNOWLEDGMENT 
This work was supported in part by the National 
Science Council, Taiwan, under Grant 99-2622-E-110-
003-CC1 and by the Department of Industrial Technology, 
Taiwan, under Grant 99-EC-17-A-01-S1-104. The authors 
wish to thank the National Chip Implementation Center, 
Taiwan, for providing the 0.18 μm CMOS foundry service. 
REFERENCES 
[1] J. Mitola, III and G. Q. Maquire, Jr., “Cognitive radio: 
Making software radios more personal,” IEEE Pers. 
Commun., vol. 6, no. 4, pp. 13-18, Aug. 1999. 
[2] H. Urkowitz, “Energy detection of unknown deterministic 
signals,” Proc. IEEE, vol. 55, no. 4, pp. 523-531, Apr. 1967. 
[3] W. A. Gardner, “Sinal interception: a unifying theoretical 
framework for feature detection,” IEEE Trans. Commun., 
vol. 36, no. 8, pp. 897-906, Aug. 1988. 
[4] B. Razavi, “Cognitive radio design challenges and 
techniques,” IEEE J. Solid-State Circuits, vol. 45, no. 8, pp. 
1542-1553, Aug. 2010. 
[5] T. D. Gathman and J. F. Buckwalter, “Injection locked 
oscillator arrays for spectrum analysis,” in IEEE Radio 
Frequency Integrated Circuits Symp. Dig., Jun. 2009, pp. 
575-578.  
[6] C.-J. Li, F.-K. Wang, T.-S. Horng, and K.-C. Peng, “A 
novel RF sensing circuit using injection locking and 
frequency demodulation for cognitive radio applications,” 
IEEE Trans. Microw. Theory Tech., vol. 57, no. 12, pp. 
3143–3152, Dec. 2009. 
[7] R. Adler, “A study of injection locking phenomena in 
oscillators,” Proc. IEEE, vol. 61, pp. 1380-1385, Oct. 1973. 
[8] W. Zhuo, X. Li, S. H. K. Embabi, J. P. de Gyvez, D. J. 
Allstot, and E. Sanchezz-Sinencio, “A capacitor cross-
coupled common-gate low-noise amplifier,” IEEE Trans. 
Circuits Syst. II, Exp. Briefs, vol. 52, no. 12, pp. 875–879, 
Dec. 2005. 
[9] R. C. Mackey, “Injection locking of klystron oscillators,” 
IRE Trans. Microw. Theory Tech., vol. 10, pp. 228-235, Jul. 
1962
2.4 2.41 2.42 2.43 2.44 2.45 2.46 2.47 2.48
Frequency (GHz)
-130
-120
-110
-100
-90
-80
-70
-60
Sp
ec
tr
um
 (d
B
m
)
GMSK@2.450 GHzFM@2.419 GHz
QPSK@2.440 GHz
 
Fig. 6. Spectrum of three signals including a 2.419 GHz FM 
signal, a 2.44 GHz QPSK signal, and a 2.45 GHz GMSK signal. 
0 0.2 0.4 0.6 0.8
Time (ms)
0
0.2
0.4
0.6
0.8
1
O
ut
pu
t V
ol
ta
ge
 (V
)
flat zone 1
flat zone 2
flat zone 3
 
Fig. 7. Measured output voltage of the spectrum sensor in the 
sensing of the spectrum shown in Fig. 6. 
TABLE II.   COMPARISON OF ESTIMATED SPECTRUM SENSING 
RESULTS WITH MEASUREMENTS 
 Measured results in 
Fig. 6 
Estimated results 
from Fig. 7 
1f  (GHz) 2.419 2.415 
1P  (dBm) -85 -86 
2f  (GHz) 2.440 2.442 
2P  (dBm) -103 -108 
3f  (GHz) 2.450 2.447 
3P  (dBm) -99 -102 
 
transformer feedback. The main difference between this 
CG LNA and the gm-boosting CG LNA in [5] is that the 
source and drain terminals of M1 are respectively 
connected to series inductors, Lp and Ls, which are 
magnetically coupled to form a transformer. The 
transformer constructs a positive-feedback network. 
Moreover, the current ip in the primary winding is 
proportional to the RF input signal current iin and in phase 
with it. Hence, the current is in the secondary winding is 
sum of iin and ip. Therefore, the current gain of the 
proposed CG LNA is larger than one without the 
consumption of additional dc power, increasing the gain 
and input impedance above those of the gm-boosting CG 
LNA [5]. In Fig. 2, the input impedance Zin,DF(s) and the 
source impedance to be matched are derived as 
( )( ),
1 1 1( )
1 1
gsin DF
m pneg
Z s sC
g sLA nk
⎛ ⎞
= + +⎜ ⎟⎜ ⎟+ − ⎝ ⎠
 (3) 
 ( ), 1
1( )
2 1s in DF m Aneg
R Z s
g nk
=
= ≈
−
 (4) 
where n is the turn ratio of transformer, which is the ratio 
of the number of secondary turns N
s
 to the number of 
primary turns Np, and k is the coefficient of magnetic 
coupling. Comparing (2) and (4) clearly shows that the 
proposed CG LNA has an additional design parameter n·k 
to determine Zin,DF(s). The value of gm can be increased to 
enhance power gain without increasing the difficulty of 
obtaining input matching. Furthermore, because of passive 
positive-feedback is used, the proposed CG LNA does not 
consume more dc power consumption in the input 
matching condition, and meanwhile does not affect the 
voltage headroom of M1. 
B. Noise Figure 
In Fig. 1(a), noise factor F of the g
m
-boosting CG LNA 
with input impedance matched to R
s
 = 50 Ω is derived as 
 
41 2
s
L
RF R
γ
α= + +  (5) 
where γ is CMOS transistor thermal noise coefficient, and 
α is the ratio of g
m
 to the zero-bias drain conductance. 
Equation (5) indicates that the NF of gm-boosting CG 
LNA is higher than 3 dB, even without considering noise 
from parasitic resistance of Lp or the induced gate noise. 
This result leads to a low sensitivity for receivers. Fig. 3 
shows an equivalent noise model of the proposed CG 
LNA. In Fig. 3, the noise current comprises thermal noise 
components iRS, iRL, and iPS, and the channel noise 
component iD. In this model, the gate induced noise and 
the channel length modulation are ignored. Additionally, 
noise from the parasitic resistance of the secondary 
winding Ls is ignored when the output resistance ro of M1 
is large. The noise factor F of the proposed CG LNA is 
derived as 
( )
( ) ( ) ( )
2
2
1
1 2 2
1
PSs s
L pneg
nk R R RF nkRA L
γ
α ω
−
= + + − +
+
  (6) 
where RPS is equivalent parasitic resistance of Lp. On the 
right hand side of (6), the second term represents the 
contribution of M1 to noise and is minimized when n·k and 
A
neg are maximal. The third term represents the 
contribution of RL to thermal noise, which can be reduced 
by increasing n·k and RL. The fourth term represents the 
contribution of RPS to thermal noise. Comparing (5) and (6) 
clearly indicates that the proposed CG LNA greatly 
reduces the contributions of M1 and RL to noise, without 
consuming additional dc power. However, Equation (4) 
indicates that the proposed CG LNA is unstable when n·k 
exceeds one. Fortunately, the coefficient k of the 
transformer that is implemented using CMOS technology 
is 0.6 – 0.9. Hence, the stable amplifier is certain if n =1 is 
used for the transformer. 
III. CIRCUIT DESIGN 
Fig. 4 schematically shows the proposed CG LNA. The 
g
m
-boosting feedback comprises capacitive cross-couple 
topology (CG1 and CG2), resulting in Aneg ≤ 1 when CG1,(2) is 
larger than Cgs. The transistor size of M1,(2) is related to the 
linearity of the proposed CG LNA. Reducing the gate 
width of M1,(2) increases the linearity under a given bias 
current. A smaller transistor is associated with a smaller 
Cgs, and therefore a wider input bandwidth because of the 
equivalent low-Q parallel RLC circuit at the input node. 
 
 
Fig. 2. Equivalent small-signal model of Fig. 1(b). 
 
 
Fig. 3. Equivalent noise model of Fig. 1(b). 
 
V. CONCLUSION 
A wideband CG LNA, employing dual-feedback to 
enhance NF and power gain over a wide frequency range, 
is proposed. Circuit analysis indicates that the dual-
feedback improves the NF and power gain of the CG LNA 
without increasing the dc power consumption. Moreover, 
this dual-feedback mechanism overcomes the trade-off 
between input matching and noise matching in the CG 
LNA designs. 
ACKNOWLEDGMENT 
This work was supported in part by the National 
Science Council, Taiwan, under Grant 99-2622-E-110-
003-CC1 and by the Department of Industrial Technology, 
Taiwan, under Grant 99-EC-17-A-01-S1-104. The authors 
wish to thank the National Chip Implementation Center, 
Taiwan, for providing the 0.18 CMOS μm foundry service 
and measurement support. 
REFERENCES 
[1] M. T. Reiha, J. R. Long, and J. J. Pekarik, “A 1.2 V 
reactive-feedback 3.1 – 10.6 GHz ultrawideband low-noise 
amplifier in 0.13 µm CMOS,” IEEE J. Solid-State Circuits, 
vol. 42, no. 5, pp. 1023 – 1033. May 2007. 
[2] S. M. Rezaul Hasan, “Analysis and design of a multi-stage 
CMOS band-pass low-noise pre-amplifier for ultra-wide-
band RF receiver,” IEEE Trans. on VLSI Systems, vol. 18, 
no. 4, pp. 638 – 651, Apr. 2010. 
[3] C.-F. Liao, and S.-I. Liu, “A broadband noise-canceling 
CMOS LNA for 3.1 – 10.6-GHz UWB receivers,” IEEE J. 
Solid-State Circuits, vol. 55, no. 10, pp. 2015 – 2023. Oct. 
2007. 
[4] S. Chehrazi, A. Mirzaei, R. Bagheri, and A. A. Abidi, “ A 
6.5 GHz wideband CMOS low noise amplifier for multi-
band use,” in Proc. IEEE Custom Integrated Circuits Conf., 
2005, pp. 801 – 804. 
[5] C.-Y. Wu, Y.-K. Lo, and M.-C. Chen, “A 3 – 10 GHz 
CMOS UWB low-noise amplifier with ESD protection 
circuits,” IEEE Microw. Wireless Compon. Lett., vol. 19, no. 
11, pp. 737 – 739, Nov. 2009. 
[6] T. Kihara. T. Matsuoka, and K. Taniguchi, “A 1.0 V, 2.5 
Mw, transformer noise-canceling UWB CMOS LNA,” in 
IEEE Radio Frequency Integrated Circuits Symp. Dig., 
2008, pp. 493 – 496. 
[7] A. Liscidini, C. Ghezzi, E. Depaoli, G. Albasini, I. Bietti, 
and R. Castello, “Common gate transformer feedback LNA 
in a high IIP3 current mode RF CMOS front-end,” in Proc. 
IEEE Custom Integrated Circuits Conf., 2006, pp. 25 – 28. 
[8] H. Lee, and S. Mohammadi, “A 3 GHz subthreshold CMOS 
lose noise amplifier,” in IEEE Radio Frequency Integrated 
Circuits Symp. Dig., 2006, pp. 11 – 13. 
                 
0 1 2 3 4 5 6 7 8 9 10
Frequency (GHz)
0
5
10
15
20
25
S 2
1 (
dB
)
-55
-45
-35
-25
-15
S
12  (dB
)
Simulated
Measured
 
Fig. 8. Simulated and measured S21 and S12. 
0 1 2 3 4 5 6 7 8 9 10
Frequency (GHz)
1
2
3
4
5
6
N
F 
(d
B
)
1
2
3
4
5
6
μ
Simulated
Measured
 
Fig. 9. Simulated and measured NF and µ. 
 
                              
 
0 1 2 3 4 5 6 7 8 9 10
Frequency (GHz)
-4
-2
0
2
4
6
IIP
3  (
dB
m
)
Simulated
Measured
 
Fig. 10. Simulated and measured IIP3. 
TABLE I. PERFORMANCE COMPARISON OF THE DESIGNED WIDEBAND CG LNA WITH PREVIOUS PUBLISHED WORKS 
 Bandwidth 
(GHz) 
Gain 
(dB) 
NF 
(dB) 
IIP3 
(dBm) 
Power 
(mW) 
FoM Process 
(CMOS) 
This work 1 – 8  13.5 – 16.5 1.9 – 2.65 -2 – 3  10.8 21.6 0.18 µm 
[2] 3.4 – 11 14 4.7 – 5.6  -5.3 30 1.9 0.18 µm 
[3] 3.1 – 10.6 6.7 – 9.7 4.5 – 5.1 -6.2 – 4.9 20 8.2 0.18 µm 
[4] 0.1 – 6.5 10 3 – 4.2 1 12.6 16 0.13 µm 
[5] 3 – 10.35 9.5 – 12.5  3.3 – 11.4 -4 7.2 11.4 0.13 µm 
 
97 年度專題研究計畫研究成果彙整表 
計畫主持人：洪子聖 計畫編號：97-2628-E-110-041-MY3 
計畫名稱：高度 CMOS 積體化之混合正交極座標調制架構線性發射機 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 3 3 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 1 1 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 2 2 100%  
博士生 2 2 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 6 0 80% 
本計畫與國科會
產學計畫及經濟
部學專計畫共同
研究成果，以本計
畫實際貢獻比例
為最高。 
研究報告/技術報告 0 0 100%  
研討會論文 10 0 80% 
篇 
本計畫與國科會
產學計畫及經濟
部學專計畫共同
研究成果，以本計
畫實際貢獻比例
為最高。 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
