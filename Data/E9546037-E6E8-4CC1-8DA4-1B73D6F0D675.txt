I 
 
行政院國家科學委員會專題研究計畫期中報告 
結合聲音偵測和字幕辨認以擷取棒球影片的精彩片段 
 Extracting Highlights on Baseball Video by Fusing Sound Detection 
and Caption Recognition 
 
計畫編號： NSC 94-2213-E-214-003 
                  計畫主持人： 蘇義明 
                 執行單位： 義守大學 電子工程系 
 
中文摘要 
根據棒球影片中的字幕內容變化與偵測聲音來分析是否發生精采事件，讓觀眾可以依據
喜好來決定觀看哪些精彩事件，節省觀看的時間。本計劃研究之目的為實現在即時棒球影
片中，擷取字幕內容並加以辨識，根據辨識與聲音偵測之結果，進行判斷與分類，得知是
否發生精采事件和發生何類精采事件。以聲音為基礎的架構中，我們使用具 MDL( Minimum 
Description Length)定理的高斯混合模型(Guassian Mixture Models)對聲音訊號進行分類
(classification )，MDL-GMMs 能在有限的訓練資料 (training data)中提高系統的分類
(classification)的準確度，相對地也大大改善在擷取棒球運動視訊精采片段的正確度。字幕
內容的辨識及發展判斷精彩事件的架構中，在取得字幕內容並獲得可信賴的辨識結果後，
進行精采事件判斷。精采事件之判斷為使用模型(model-based)與規則為基礎(rule-based)之整
合方法，將獲得之分類結果和方法進行比對。 
 
關鍵字：事件偵測，高斯混合模型，Minimum Description Length，model-based，rule-based 
 
Abstract 
   As the number of various sports videos has increased for the recent years, it is important to 
provide an efficiently browsing and indexing the digital videos. An automatic sports highlight 
classification system applied to the sports videos is helpful for analyzing and understanding the 
video content. In this paper , we use MDL-GMMs training data in audio domain processing. With 
the MDL-GMMs , we are also able to greatly improve the accuracy in extracting sports hihloghts     
Additionally, a sports caption has a lot of important information about the state of the game. It 
gives a great help to analyze the highlight events of the baseball video.  
Keyword：Event Detection， Gaussian Mixture Model，Minimum Description Length 
1 
 
一、 前言 
近幾年，運動影片逐漸在多媒體影應資訊領域中受到重視，主要是因為運動比賽的已
訂立完整的規則，建立一個能夠認知、分類及總結視訊資料的系統相對較易達成，且因運
動節目具有高重覆性，高相關性的鏡頭特性，對視訊和音訊分析具有相當的幫助。 
許多關於運動比賽分析之研究，所擷取的特徵包括影像、運動、聲音及文字，其中以
文字最能夠做直接指出當下的比賽狀態。由字幕得到的資訊包含分數比、好壞球數、出局
數及壘包狀態。單純使用字幕內容作精彩事件分類時，有著先天上的不足：相同的字幕內
容變化包含兩種可能發生之精采事件，故我們加入聲音特徵以彌補字幕資訊之不足。 
以音訊為基礎做為擷取精采運動片段的好處是因計算複雜度較低，且對於內容語意有
著傑出呈現能力，從相關文獻[7][10][11][12]討論中得知，精華片段中音訊類型間的轉換通
常都會遵循固定的模式，例如出現全壘打時，一開始會是轉播員的聲音，在球被擊出的聲
音之後，會出現觀眾的歡呼聲，接著會是一連串歡呼聲與轉播員的播報交替著；而其他精
華片段中也存在同樣的轉換特性，且與全壘打的轉換特性相似，只是時間較短。 
在辨識字幕內容時，由於字幕的尺寸大都小於9*9像素，使得使用ㄧ般辨識軟體並無法
得到滿意的結果。然而辨識的正確度深深的影響精彩事件的判斷。故得到正確且可信任的
辨識結果是很重要的ㄧ環。 
使用字幕內容作精彩事件判斷，主要是使用以規則為主的方法， Kuo et al. [4]藉由尋
找精采事件的規則建立表格而Liang et al. [1]建立了決定樹(decision tree)。然而資訊的限制，
使得上述方法都無法得到最佳的結果，無法將所有的精采事件完全分類，例如無法分辨出
一壘安打或保送。 
在本棒球視訊精采事件偵測系統中，(1)正確偵測棒擊聲與歡呼聲、(2)正確的辨識數
字、(3)根據字幕與聲音建立正確的精采事件模型，是本研究所需解決的重要問題。 
二、研究動機與背景 
在本研究中，將棒球比賽之精采事件分為八類：(1)雙殺、(2)一壘安打、(3)二壘安打、
(4)三壘安打、(5)保送、(6)全壘打、(7)犧牲打、(8)盜壘。並將棒球比賽中音訊訊號做了以
下分類：(1)擊球(ball hit)，(2)歡呼(cheering)，(3)音樂(music)，(4)講話(speech)，及(5)帶有
背景音樂的講話(speech with music background)。 
根據相關文獻[7][10][11]和實驗結果中發現若以一連串的聲音特徵值來找出他們在時
間軸上的轉換，通常這些聲音特徵值在未做任何處理前，會呈現出類似雜訊(noise)的分佈，
其中所夾帶的資訊量並不大，並不適合直接拿來作分析。而在這些類別中，音樂及帶有背
景音樂的講話這兩個類別是為了過濾廣告片段；而另外三個類別則用來偵測播報員的播報
及精彩事件的發生。從實驗中我們觀察到，廣告片段通常含有大量的音樂片段，並且參雜
著人的講話及對話聲。因此，音樂及帶有背景音樂的講話這兩個類別基本上會大量地在廣
告中交互出現。 
 
 
 
3 
 
3.1 音訊特徵擷取 
音訊特徵參數的擷取，其目的就是要找出一組能正確表現每個音訊訊號特性的參數，而
且希望能具有鑑別性（ discriminative ）不容易受到環境的干擾。以下就針對系統中我們
所使用音訊特徵參數擷取方式做一簡單扼要說明。 
 
◎ 梅爾刻度式倒頻譜 
   梅爾刻度式倒頻譜分析流程如圖二所示，以下針對細節部份做一說明。 
 
  
 
 
 
 
 
 
 
 
1) 取音框和加窗（Frame Blocking and Windowed） 
將音訊訊號假設是變化緩慢，然後利用短時距中音訊訊號特性固定的觀念對音訊訊號
做處理，而稱短時距為音框，此外為了消除原本各個音框兩端可能會造成的訊號不連續性
（discontinuities）我們將音框乘上漢明窗，漢明窗表示如下： 
W（m）=
⎪⎩
⎪⎨
⎧ <≤⎟⎠
⎞⎜⎝
⎛
−−
otherwise                         0                  
  0      
1
2cos*46.054.0
，
， Nm
N
nπ
 
 
2) 快速傅立葉轉換（FFT Transform） 
    音訊訊號在時間域(time domain)上的變化快速而不穩定，所以通常都將它轉換成頻率域
(frequency domain)上來觀察，因為此時它的頻譜會隨著時間作緩慢的變化。 
 
3) 三角帶通濾波器（Triangular Band-Pass Filter ） 
    將音框的頻譜參數通過一組由二十個三角帶通濾波器（triangle band-pass filter）所組成
的梅爾刻度濾波器，將每個頻帶的輸出取對數，求得每一個輸出的對數能量（log energy）
kE ，k = 1,2,…20。再將此20個參數代入餘弦轉換（cosine transform）求出L 階 Mel-scale 
cepstrum參數。 
    餘弦轉換公式如下： 
C ∑
=
=⎟⎟⎠
⎞⎜⎜⎝
⎛ ⎟⎠
⎞⎜⎝
⎛ −=
N
k
km LmN
kmE
1
....2,1,
2
1cos π  
其中 N 表示三角帶通濾波器數目，在系統中為 20。 
 
音訊訊號取音框和加窗快速傅立葉轉換三角帶通濾波器差量倒頻譜參數M
FC
C 參數
圖二  MFCC特徵參數擷取流程  
5 
 
 
3.2 音訊模型分類與訓練 
高斯混合模型（Gaussian mixture models - GMMs）是在聲學（acoustic）上一種常用來
建立聲音模型的方法，原因是它的每個基本密度可以模擬一些聲學種類（acoustic classes）
的特性，諸如母音（vowels）、鼻音（nasals）、磨擦音（fricatives）等等的組合，且由於
高斯混合模型能夠很平滑（smooth）地近似任意形狀的密度，因此能達到與原來資料分佈
最近似的結果，而我們在高斯混合模型中加入了 MDL 定理是為了能夠解決傳統高斯模型 
GMMs 要先分多少子類別(the number of mixtures)而且每類別(Class)可能都有相同子類別
數，因此當子類別數多於理想值會造成 overfitting(過度配合)使得計算量較多,反之,當子類別
數少於理想值會造成 underfitting(低於配合)使得誤差變多，以下將做個簡單說明，詳細過程
請參閱文獻[2][13] 
一個完整的高斯混合密度（Gaussian mixture density），是由K個基本密度（component 
densities）所組成的，每個基本密度包括三個參數：平均值向量（mean vector）、共變異矩
陣（variances）和混合係數（mixture coefficients）。我們用θ 來表示這些數的集合： 
{ }, , , 1 . . .i i iR i Kθ π μ= =  
其中 iπ 是每個基本密度的混合係數，μi 是平均值向量，R i 是共變異矩陣。 
接下來定義M維的基本密度函數 n 1Y = { Y } Nn = 如下： 
/ ( / , )
1 1
log ( / , ) log( )
n n n k
N K
y y x y k
n k
p y K p θθ Π
= =
= ∑ ∑  
模型訓練的主要目的是從每個音訊片段中，找出一組高斯混合模型的K，和 ( )kΘ∈Ω 即平
均值向量、共變異數矩陣和混合權重。這些模型的參數最能代表訓練特徵參數向量的分佈。
而估算高斯混合模型參數的方法，我們採用最大可能性（Maximum Likelihood - ML）估算
法。 
( ) y
arg  max  log p ( / , )
kML
y K
Θ∈Ω
Θ = Θ
 
根據MDL定理期望能將K值減到最小： 
1( , ) lo g ( / , ) l o g ( )
2y
M D L K p y K L N MΘ = − Θ +
 
其中   ( M + 1 ) ML =   K  (  1 +  M  +   )  - 1
2
 
為了能夠找出最佳 K 值和 ( )kΘ∈Ω  我們使用 EM (Expectation Maximization)演算法合
併最鄰近叢聚(clusters) l和m 當作成單一叢聚( ,l m )，其中( ,l m )表示先前平均值向量和
共變異矩陣，進行疊代找出下一個平均值向量和共變異矩陣直到MDL 值收斂到最小值
7 
 
字幕資料的辨識 
當辨認出輸入字幕的形態其先前所建立的模板(template)將直接對應輸入字幕的區域，
直接取得字幕資料不須經過一般切割的程序。先前所建立每一個字幕的模板，其各別資料
(例如：出局數、壘數和分數等)的位置都被定義好了。因此，擷取出來的資料其屬性都可得
知。如圖四 
                                
為了實現即時系統，我們採用簡易的特徵擷取方法和數字辨認法。 
特徵擷取 
本研究使用之特徵為網狀特徵(Meshing Features)：將字形分成 N×N 網狀格子，然後計
算每一格子內資訊之有無，如此可得 N×N 個特徵值。由於視訊取得圖像資料為彩色，為了
方便處理，將圖像由 RGB 色彩空間轉換成 YUV 色彩空間，並使用 Y 值，即灰階特徵，作
處理。 
RGB 與 YUV 色彩空間轉換公式如下： 
 
 
 
 
判斷資訊有無的方法為，若網格內之灰階值大於臨界值，則視為含有資訊。然而視訊
之平均灰階值變化不定，因此必須先對偵側區域進行前處理的動作，自動設定臨界值。臨
界值的設定乃是根據圖片中灰階值之直方圖(histogram)及背景明暗來自動設定，並去除無效
的雜訊。如圖五所示。 
 
 
 
本論文中所使用的方法如圖六所示，將樣本分成 9×9 個網狀格子，如果網格內有資訊
則為 1，否則為 0。因此，經過網狀特徵的抽取，每個樣本會得到 81 個參數值。 
                      
 
圖四、字幕與相對資訊 
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢
⎣
⎡
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢
⎣
⎡
−−
−−=
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢
⎣
⎡
B
G
R
V
U
Y
081.0419.0500.0
500.0331.0169.0
114.0587.0299.0
圖六、網狀特徵 
圖五、自動設定臨界值後之二值圖，依順序分別為原始圖、灰階圖、二值圖 
9 
 
 
根據表格，建立樹狀圖，以期分類快速。建立之決定樹如圖八所示。 
 
 
 
以模型為基礎(Model-Based) 
為了彌補以規則為基礎之方法的不足，我們加入了以模型為底之方法。 
我們採用的字幕資訊為分數變化(S)，出局數變化(O)及壘包變化(B)。根據各變化量的
多寡，給予相對的位元數。例如，分數變化最多可達4分，故給予3個位元。因此，總共將
會有輸入8位元、輸出256個值。如圖九所示。 
 
  
 
 
 
 
根據此方法，分析事件可能發生之情況，作出統計圖表，可得知各精彩事件與輸出之
情形，如圖十所示。 
 
 
 
 
 
 
 
Ex.二壘安打 
                S    O   B 
     變化量  001   00  101 
     輸出    00110101 = 53 
 圖九 以模型為基礎(model-based)之示意圖 
圖八、決定樹 
11 
 
 
四、實驗結果 
4.1 音訊偵測 
  我們已經利用 MPEG1 影片型式，收集多種電視運動影片，去評估此研究成果。 
   
  聲音偵測方面，我們從電視廣播中獲取大約12小時左右MPEG-I格式棒球比賽的影片，然
後從中選擇691音訊片段，這些音訊片段60 % 做為訓練樣本，40 %用來做為測試評估系統
效能使用。然後利用MDL-GMM對音訊分類，結果如表一所示，表一中所列出的結果為在一
個10分鐘長的比賽片段中的測試。我們先將此10分鐘長的片段分割為一個一個的clip，針對
每一個clip我們都計算其發生在五個類別中的機率，也就是在五個GMM中的機率，而機率
最高的即為其屬於的類別，其中Miss個數為音訊中有出現該類型音訊但分類器無法分類出
來個數。 
 
 
(1)擊 球 (2)歡 呼 (3)音 樂 
(4)有背景音
樂的講話 
Miss個數 
 
(1)擊 球 32 0 0 3 2 
(2)歡 呼 0 35 3 0 5 
(3)音 樂 0 0 18 1 2 
(4)有背景音
樂的講話 
0 1 22 3 2 
 
 
類 別 Precision Recall 
擊 球 91.4 % 94.11 % 
歡 呼 92.12 % 87.5 % 
音 樂 94.73 % 90 % 
有背景音樂的講話 84.62 % 91.66 % 
 
 
從以上的表中我們可以了解到歡呼有不錯的辨識率，主要因歡呼聲具有較簡單的頻
譜，結構模型化的過程相對比較簡單容易，且不易受其他因素的干擾。相對於講話的
聲音，雖然頻譜結構較複雜，但是只要適當調整模型的混合數也能得到不錯的效能。
另外對於擊球聲來說，分類效率不高可能和音樂和有背景音樂的講話有關，主要原因
是他們中有地方可能出現短時距的高頻信號造成系統判斷錯誤。 
 
 
表一 MDL- GMMs 分類正確和不正確結果
表二 MDL- GMMs 分類 Precision 和 Recall
13 
4.3 結合聲音和字幕偵測與辨識 
   利用影像字幕處理的方法做精彩事件判斷時無法精確判斷出保送、一壘安打等事件差
異，本系統中特別加入將音訊中所偵測到打擊和歡呼聲來判斷上述事件，實驗結果顯示加
入聲音判斷條件後改善了一壘安打與保送字幕內容無法清楚判斷的事件，其中一壘安打事
件為 9 次，保送事件為 5 次，但無法精確指出何種事件還是有 3 次，主要是因其無偵測到
聲音事件發生所導致，其系統結果如下圖所示 
 
 
 
 
 
 
 
 
 
 
 
圖十、未加入 Audio 偵測 
15 
 
五、未來工作 
在音訊方面，在此我們只針對棒球音訊做為樣本，接下來我們希望能夠加入像足球、
籃球和高爾夫球等相關音訊訊號作判斷，發展出一個能判斷各種比賽精采事件的單一平台
系統。 
在影像方面，除了字幕，更可加入其他特徵，如顏色分佈與攝影機運動，可以更加準
確的偵測出事件的開端，或追蹤某球員之片段，供使用者除了可搜尋精采事件之發生外，
更可進一步搜尋喜愛之球員所發生之精采事件。 
 
六、具體成果 
 在此一計畫中，我們已經完成一套字幕事件偵測系統及音訊辨識系統並達成預期目標。 
 完成音訊偵測處理系統，可偵測出五種型態音訊之發生。 
 完成字幕內容之辨識與精彩事件之偵測。 
 結合聲音和字幕偵測與辨識以解決無法精確判斷出保送、一壘安打等事件。 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
