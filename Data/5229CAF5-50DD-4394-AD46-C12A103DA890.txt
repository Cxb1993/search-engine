2 
 
In this project, we proposed a multilevel gridless full-chip routing system to handle these 
four design challenges. We developed three major techniques:  
1. Gridless Routing Model: To handle modern routing with nanometer electrical effects, 
we need to consider designs with variable wire/via widths and spacings, for which gridless 
routing approaches are desirable due to its great flexibility. We proposed a gridless routing 
model that can obtain design-rule-correct paths and avoid redundant wires. 
2. Multilevel Framework: To cope with the increasing complexity, new multilevel 
frameworks of next generation electronic design automation for nanometer designs are needed. 
We presented a new multilevel framework for performance consideration. The new 
framework works in the following manner: top-down uncoarsening followed by bottom-up 
coarsening. 
3. Optical Proximity Correction (OPC) modeling: Due to the sub-wavelength lithography, 
manufacturing the sub-90 nm feature size requires intensive use of Resolution-Enhancement 
Techniques (RET„s), among which OPC is the most popular technique in industry. 
Considering OPC during routing can significantly alleviate the cost of post-layout OPC 
operations. We presented a model-based OPC modeling to predict the behavior of a 
post-layout OPC tool and incorporate the models into our gridless router to reduce the OPC 
cost. 
 
Keywords: physical design, routing, gridless routing, multilevel framework, design for 
manufacturability (DFM), optical proximity correction (OPC) 
 
三﹑背景和目的 
As the process technology continues to advance, the minimum feature size becomes 
significantly smaller than the lithographic wavelength. This trend increases many difficulties 
of the lithography and makes the sub-wavelength lithography become one of the key 
techniques for manufacturing in the nanometer circuit design [L03]. In the sub-90 nm process, 
design shapes on a wafer may have large distortions, as illustrated in Figure 1 [CKS00]. 
Manufacturing sub-90 nm feature size requires intensive use of Resolution-Enhancement 
Techniques (RET's) [S04], among which OPC is the most popular RET in industry. 
 
Figure 1: (a) Distortion without OPC. The red rectangle is the desired image. (b) The red area 
inside the green area is the original layout. The green area is the OPCed layout. (c) Distortion 
with OPC [CKS00]. 
 
As shown in Figure 1, OPC operations might change the layout configurations 
substantially. Considering OPC during routing can significantly alleviate the cost of 
post-layout OPC operations. Therefore, the modeling of OPC in the routing stage and 
OPC-aware routing are needed to minimize the OPC cost. As shown in Figure 2(b), the 
4 
 
四﹑研究方法 
In modern nanometer process technologies, such as 90 nm technology and beyond, most 
of the metal layers need OPC to control the line width and length variations. Considering OPC 
in the routing stage, we can maximize the effects of the correction and thus reduce the number 
of OPC pattern features during masking. There are generally two major approaches to OPC: 
rule- and model-based approaches. The rule-based method adds the OPC pattern features 
based on some predefined design rules. This approach is inevitably less accurate, but is much 
simpler and more efficient. In contrast, the model-based method applies optics simulation to 
add OPC pattern features to fix the OPC problem. It is typically more accurate, but is much 
more complicated and time-consuming. 
4.1 Rule-Based OPC Modeling 
In this subsection, we define the OPC cost function of a set of major OPC design rules. 
Note that it is not our intention here to elaborate on all OPC design rules or the accuracy of 
the rules. Though not presented here, nevertheless, it is not hard to incorporate other (more 
accurate) OPC design rules into the cost function of our router. The OPC effect of a line is 
related to its neighboring configuration. Since the neighboring configuration of a line is not 
fixed in the routing stage (not all lines are routed), it is very hard to evaluate the OPC cost 
with unfixed neighboring configuration. Therefore, we propose a combined estimation of 
actual and estimated OPC costs to calculate the OPC cost for a line considering the routed and 
unrouted neighboring lines. We define the OPC cost for a line e by 
 
The combined cost consists of an actual cost costa(e) (for real neighboring configuration) and 
an estimated cost coste(e) (for the worst-case neighboring configuration). At first, the OPC 
cost for a line is estimated by the worst-case neighboring configuration alone. After a 
connection is routed successfully, the real neighboring configuration will be updated 
dynamically. Therefore, our OPC cost is based on the OPC effect incurred by both the already 
routed nets and the estimated unrouted nets. As routing proceeds, we have more and more 
accurate OPC effect for routing succeeding nets. We describe how to calculate these two cost 
as follows: 
 Actual cost: We calculate the actual cost for a line based on the OPC effect caused by 
the neighboring routed lines. In addition, the optical interference is limited within a 
region of several wavelengths [HW04, WTW05]. Therefore, only neighboring routed 
lines within the effective region (spacing) are considered. Here, the effective region is 
defined by the foundry. Consequently, we define the actual cost for a line e to be the 
total number of pattern features as follows: 
 
where lo and wo are the overlapping length and width with the routed neighboring lines 
within the effective region (spacing), respectively. Here, LL and WL (the unit-length 
and unit-width for adding a pair of line biasings) are parameters related to the process 
technology and are defined by the foundry. 
 Estimated cost: Evaluating the OPC cost for a line without considering the OPC effect 
caused by the neighboring unrouted lines may be inaccurate. Since we do not know the 
final layout of the neighboring configuration, we consider the worst-case neighboring 
configuration for the cost estimation. In other words, we assume that a line segment is 
fully surrounded by adjacent lines. Therefore, the OPC cost for the line is proportional 
to its length and width. For a line, we need to add four serifs at the corners to increase 
the fidelity of images. As the length of a line increases, the ends of the line are 
shortened. Therefore, we need to add two hammerheads at the line ends for a long line. 
6 
 
first k terms in the series, we can rewrite equation as follows: 
 
where 
 
Therefore, the intensity at a point (x, y), induced by a rectangular aperture p, can be calculated 
as follows: 
 
There are k
4
 terms in last equation. By scaling the k
4
 terms appropriately, last equation gives a 
good approximation to the simulated intensity data. The fitted intensity function is defined as 
follows: 
 
where  ( k
2
 terms) are determined by a multiple linear regression to the simulation data. 
Based on the coefficient , the fitted amplitude is given by 
 
4.2.2 Intensity Fitting for Multiple Rectangular Apertures 
We present the intensity fitting for multiple rectangular apertures. We first derive a 
closed form to calculate the intensity at a point, induced by two rectangular apertures, and 
then generalize it to an arbitrary number of rectangular apertures. 
The fitted intensity at a point (x, y), induced by two rectangular apertures p and q, can be 
calculated as follows: 
 
The first and second terms in the equation can be derived from equations in last subsection. 
The third term in the equation can be calculated as follows: 
 
Therefore, we can rewrite the equation as follows: 
8 
 
(sec)” represents the runtimes in second. Compared with MGR, the experimental results show 
that OPC-MGR-Rule achieves an average 9% reduction in the number of pattern features 
required and still maintains 100% routing completion for all circuits, with very small 
overheads in the wirelength and runtime. 
 
Table 2: Comparison of (A) MGR and (B) OPC-MGR-Rule. 
 
4.3. 2 OPC-Aware Multilevel Routing with Model-Based OPC Modeling 
We implemented the model-based OPC modeling into MGR (called OPC-MGR-Model) 
by the C++ language. The geometry of the routing results of MGR and OPC-MGR-Model 
were extracted and fed into Mentor Graphics's Calibre-OPC [Calibre] to perform the 
correction. 
Table 3 gives the comparison of MGR and OPC-MGR-Model. In this table, “Comp. 
Rates” gives the routing completion rates, “WL (um)” gives the total wirelength in um, 
“Routing Time (sec)” gives the runtimes of routing in second, “EPEtotal” gives the total EPE 
in nm, and “EPEmax” gives the maximum EPE in nm. All of the EPEtotal and EPEmax were 
obtained from Calibre-OPC. As shown in the table, OPC-MGR-Model achieves the same 
routability as MGR, reduces the total EPE by 18% and the maximum EPE by 17% with 
incurring a 1% overhead in the total wirelength and about 2X running time for the routing. 
Figure 3 shows the full-chip, the original partial, and the partial OPCed routing solutions for 
“Mcc2” obtained from OPC-MGR-Model. 
These two experimental results reveal the effectiveness of our OPC-aware multilevel 
router. 
 
Table 3: Comparison of (A) MGR and (B) OPC-MGR-Model. 
 
10 
 
of ACM International Symposium on Physical Design, pp. 12--18, April 2000. 
[CFK01] J. Cong, J. Fang, and K. Y. Khoo, ``DUNE-a multilayer gridless routing system," IEEE Transactions on 
Computer-Aided Design of Integrated Circuits and Systems, vol. 20, no. 5, pp. 633--647, May 2001. 
[CFX+05] J. Cong, J. Fang, M. Xie, and Y. Zhang, ``MARS-a multilevel full-chip gridless routing system," IEEE 
Transactions on Computer-Aided Design of Integrated Circuits and Systems, vol. 24, no. 3, pp. 382--394, March 2005. 
[CFZ01] J. Cong, J. Fang, and Y. Zhang, ``Multilevel approach to full-chip gridless routing," in Proceedings of IEEE/ACM 
International Conference on Computer-Aided Design, pp. 396--403, November 2001. 
[CJH+06] T.-C. Chen, Z.-W. Jiang, T.-C. Hsu, H.-C. Chen, and Y.-W. Chang, ``A high quality analytical placer considering 
preplaced blocks and density constraint," in Proceedings of IEEE/ACM International Conference on Computer-Aided Design, 
pp. 187--192, November 2006. 
[CL04] Y.-W. Chang and S.-P. Lin, ``MR: a new framework for multilevel full-chip routing," IEEE Transactions on 
Computer-Aided Design of Integrated Circuits and Systems, vol. 23, no. 5, pp. 793--800, May 2004. 
[CLW00] J. Cong, S. Lim, and C. Wu, ``Performance driven multilevel and multiway partitioning with retiming," in 
Proceedings of ACM/IEEE Design Automation Conference, pp. 274--279, June 2000. 
[CKS00] S. Chow, A. B. Kahng, and M. Sarrafzadeh, ``Modern physical design: algorithm technology methodology," in 
Tutorial of IEEE/ACM International Conference on Computer-Aided Design, November 2000. 
[CR88] J. Cohoon and D. S. Richards, ``Optimal two-terminal α-β wire routing," Integration, the VLSI Journal, vol. 6, no. 1, 
pp. 35--57, May 1988. 
[CXZ02] J. Cong, M. Xie, and Y. Zhang, ``An enhanced multilevel routing system," in Proceedings of IEEE/ACM 
International Conference on Computer-Aided Design, pp. 51--58, November 2002. 
[CZW00] Y.-W. Chang, K. Zhu, and D. F. Wong, ``Timing-driven routing for symmetrical-array-based FPGAs," ACM 
Transactions on Design Automation of Electronic Systems, vol. 5, no. 3, pp. 433--450, July 2000. 
[H50] H. H. Hopkins, Wave Theory of Aberrations, Oxford University Press, New York, NY, 1950. 
[H69] D. Hightower, ``A solution to line routing problems on the continuous plane," in Proceedings of Design Automation 
Workshop, pp. 1--24, 1969. 
[HCC+03] T.-Y. Ho, Y.-W. Chang, S.-J. Chen, and D.-T. Lee, ``A fast crosstalk- and performance-driven multilevel routing 
system," in Proceedings of IEEE/ACM International Conference on Computer-Aided Design, pp. 382--387, November 2003. 
[HCC04] T.-Y. Ho, Y.-W. Chang, and S.-J. Chen, ``Multilevel routing with antenna avoidance," in Proceedings of ACM 
International Symposium on Physical Design, pp. 34--40, April 2004. 
[HCC+05a] T.-Y. Ho, Y.-W. Chang, S.-J. Chen, and D.-T. Lee, ``Crosstalk- and performance-driven multilevel full-chip 
routing," IEEE Transactions on Computer-Aided Design of Integrated Circuits and Systems, vol. 24, no. 6, pp. 869--878, 
June 2005. 
[HCC+05b] T.-Y. Ho, C.-F. Chang, Y.-W. Chang, and S.-J. Chen, ``Multilevel full-chip routing for the X-based 
architecture," in Proceedings of ACM/IEEE Design Automation Conference, pp. 597--602, June 2005. 
[HL91] J. Heisterman and T. Lengauer, ``The effiient solutions of integer programs for hierarchical global routing," IEEE 
Transactions on Computer-Aided Design of Integrated Circuits and Systems, vol. 10, no. 6, pp. 748--753, June 1991. 
[HS85] T. C. Hu and M.-T. Shing, ``A decomposition algorithm for circuit routing," VLSI Circuit Layout: Theory and 
Design, IEEE Press, New York, NY, 1985. 
12 
 
[O84] J. K. Ousterhout, ``Corner stitching: a data-structure technique for VLSI layout tools," IEEE Transactions on 
Computer-Aided Design of Integrated Circuits and Systems, vol. CAD-3, no. 1, pp. 87--100, January 1984. 
[O85] T. Ohtsuki, ``Gridless routers-new wire routing algorithms based on computational geometry," in Proceedings of IEEE 
International Conference on Circuits and Systems, pp. 802--809, May 1985. 
[P05] D. Z. Pan, ``Lithography-aware physical design," in Proceedings of IEEE International Conference on ASIC, pp. 
1172--1173, October 2005. 
[PGP97] Y. C. Pati, A. A. Ghazanfarian, and R. F. Pease, ``Exploiting structure in fast aerial image computation for 
integrated circuit patterns," IEEE Transactions on Semiconductor Manufacturing, vol. 10, no. 1, pp. 62--74, February 1997. 
[RAP+06] J. A. Roy, S. N. Adya, D. A. Papa, and I. L. Markov, ``Min-cut floorplacement," IEEE Transactions on 
Computer-Aided Design of Integrated Circuits and Systems, vol. 25, no. 7, pp. 1313--1326, July 2006. 
[S04] F. M. Schellenberg, ``Resolution enhancement technology: the past, the present and extension for the future," in 
Proceedings of SPIE Optical Microlithography XVII, pp. 1--20, May 2004. 
[S07] Semiconductor Industry Association, International Technology Roadmap for Semiconductors, 2007. 
[SKJ+90] W. Schiele, T. Kruger, K. Just, and F. Kirsch, ``A gridless router for industrial design rules," in Proceedings of 
ACM/IEEE Design Automation Conference, pp. 626--631, June 1990. 
[SSO87] M. Sato, J. Sakanaka, and T. Ohtsuki, ``A fast line-search method based on a tile plane," in IEEE International 
Symposium on Circuits and Systems, pp. 588--591, May 1987. 
[TCF92] C. Tsai, S. Chen, and W. Feng, ``An H-V alternating router," IEEE Transactions on Computer-Aided Design of 
Integrated Circuits and Systems, vol. 11, no. 8, pp. 976--991, August 1992. 
[W01] A. K. K. Wong, Resolution Enhancement Techniques in Optical Lithography, SPIE Press, 2001. 
[WK97] D. Wang and E. Kuh, ``A new timing-driven multilayer MCM/IC routing algorithm," in Proceedings of IEEE 
Multi-Chip Module Conference, pp. 89--94, February 1997. 
[WTW05] Y.-R. Wu, M.-C. Tsai, and T.-C. Wang, ``Maze routing with OPC consideration," in Proceedings of ACM/IEEE 
Asia and South Pacific Design Automation Conference, pp. 18--21, January 2005. 
[WWS+87] Y. F. Wu, P. Widmayer, M. D. F. Schlag, and C. K. Wong, ``Rectilinear shortest paths and minimum spanning 
trees in the presence of rectilinear obstacles," IEEE Transactions on Computers, vol. C-36, no. 3, pp. 321--331, March 1987. 
[XK02] Z. Xing and R. Kaog, ``Shortest path search using tiles and piecewise linear cost propagation," IEEE Transactions 
on Computer-Aided Design of Integrated Circuits and Systems, vol. 21, no. 2, pp. 145--158, February 2002. 
[ZLI96] S. Q. Zheng, J. S. Lim, and S. S. Iyengar, ``Finding obstacle-avoiding shortest paths using implicit connection 
graphs," IEEE Transactions on Computer-Aided Design of Integrated Circuits and Systems, vol. 15, no. 1, pp. 103--110, 
January 1996. 
 
2 IEEE TRANSACTIONS ON COMPUTER-AIDED DESIGN OF INTEGRATED CIRCUITS AND SYSTEMS, VOL. XX, NO. Y, MONTH 2009
OPCed Layout
Without OPC Original Layout With OPC
(a) (b) (c)
Fig. 1. (a) Distortion without OPC. The (red) rectangle gives the desired
image. (b) The dark gray (red) rectangle inside the gray (green) region gives
the original layout. The gray (green) region shows the OPCed layout. (c)
Smaller distortion with OPC [7].
(a) (b) (c)
source
target
source
target
source
target
Fig. 2. (a) Routing example. The black and gray (blue) regions denote a
routed wire and an OPC-prohibited region, respectively. (b) The dark gray
(green) wire crosses two OPC-prohibited regions. (c) A routing path that
does not cross any OPC-prohibited region, resulting in the minimum number
of bends with the shortest wirelength.
router. Here, EPE is the distance between the edge of a drawn
shape and the edge of an actual manufactured shape. It is a
measure for the distortions of manufactured layouts. Kong et
al. in [14] performed rip-up and re-route to remove litho-
hotspots based on pattern matching techniques. Cho et al.
in [6] considered litho-hotspots with pre-defined litho-cost
during routing. All of these works focused on OPC-aware
routing based on given OPC modeling. They did not consider
the potential post-layout OPC change, which is very critical
for real OPC cost reduction.
Since a layout is changed dynamically and frequently during
routing, the resulting intensity needs to be updated rapidly.
Fig. 3 shows a schematic of a typical projection system. Using
the Hopkins model [11], the process of optical imaging can
be described by the following equation:
퐼(푥, 푦) =
∫ ∫ ∫ ∫
퐽(푥1 − 푥2, 푦1 − 푦2)퐿(푥1, 푦1)
퐿∗(푥2, 푦2)퐾(푥− 푥1, 푦 − 푦1)
퐾∗(푥− 푥2, 푦 − 푦2) 푑푥1 푑푦1 푑푥2 푑푦2, (1)
where 퐼(푥, 푦) is the intensity at a point (푥, 푦) on a wafer,
퐽(푥1 − 푥2, 푦1 − 푦2) is the mutual intensity function of the
mask at the points (푥1, 푦1) and (푥2, 푦2), 퐿 is the pattern
being imaged (mask), and 퐾 is the kernel function. Here, ∗
denotes the operator of complex conjugate. The above imaging
model constructs most of today’s aerial image simulators,
including SPLAT [15]. Direct implementation of Equation (1)
is too complex for modern IC designs. The implementation
of SPLAT uses some of the structures, transmission cross
Illumination Mask Image planeProjection
Fig. 3. Schematic of optical projection for IC manufacturing.
coefficients (TCC), in its model to reduce the required compu-
tations. However, SPLAT is still too time-consuming to be
applied during routing, although it is considered a golden
lithography simulator in academia and even in industry. The
table-lookup method is a popular approach for intensity com-
putation. However, memory and accuracy are issues of table-
lookup methods during routing. Extra memory is always a
concern during the memory-consuming detailed routing stage
since 50GB designs are not uncommon nowadays. Besides,
table-lookup methods need interpolation to predict the values
of middle points since lookup tables only record discrete
points. Therefore, it is desirable to develop an efficient and
economical, yet reasonably accurate method to compute the
intensity to guide the routing.
In this paper, we focus on intensity modeling and OPC-
effect optimization. We present an efficient, accurate, and
economical analytical formula for intensity computation and
develop the first modeling of the post-layout OPC based on
a quasi-inverse lithography technique. We believe that this
technique can lead to a new direction for post-layout OPC
modeling during routing. Extensive simulations with SPLAT
show that the intensity formula has high fidelity, with an
average error of within 2.21%, for the three common patterns
studied in recent works. Note that SPLAT is the golden
lithography simulator in academia and even in industry; for
example, it is used at Intel and TSMC today. Incorporating
the OPC costs computed by the quasi-inverse lithography
technique for our post-layout OPC modeling into an academic
router, the router can be guided to maximize the effects of the
correction. Compared with the rule-based OPC method used
in [4], the experimental results show that our approach can
achieve 15% and 16% reductions in the maximum and average
layout distortions, respectively.
The remainder of this paper is organized as follows. Sec-
tion II describes the problem formulation. Section III derives
the intensity formulae. Section IV describes the quasi-inverse
lithography technique. Section V extends the intensity formu-
lae and the quasi-inverse lithography technique to partially
coherent systems. Section VI incorporates the proposed quasi-
inverse lithography technique into routing. Section VII shows
the experimental results. Finally, concluding remarks are given
in Section VIII.
II. PROBLEM FORMULATION
To develop an efficient and economical, yet reasonably
accurate method to compute the intensity to guide the routing,
we first consider the following problem:
4 IEEE TRANSACTIONS ON COMPUTER-AIDED DESIGN OF INTEGRATED CIRCUITS AND SYSTEMS, VOL. XX, NO. Y, MONTH 2009
(a) (b) (c)
Fig. 5. Three common patterns: (a) Staircase; (b) Rocket; (c) Mountain.
Substituting Equation (12) into Equation (11), we can rewrite
Equation (11) as follows:
퐼˜{푝,푞}(푥, 푦) =
(
퐸˜{푝}(푥, 푦) + 퐸˜{푞}(푥, 푦)
)2
=
(
퐸˜{푝}(푥, 푦)
)2
+
(
퐸˜{푞}(푥, 푦)
)2
+ 2퐸˜{푝}(푥, 푦)퐸˜{푞}(푥, 푦)
= 퐼˜{푝}(푥, 푦) + 퐼˜{푞}(푥, 푦)
+ 2퐸˜{푝}(푥, 푦)퐸˜{푞}(푥, 푦). (13)
The first and second terms in Equation (13) can be derived
from Equation (9). By Equation (10), the third term in Equa-
tion (13) can be calculated as follows:
퐸˜{푝}(푥, 푦)퐸˜{푞}(푥, 푦)
=
∑
0≤푖1,푗1,푖2,푗2<푘
푐˜푖1,푗1 푐˜푖2,푗2훼푝(푖1)훽푝(푗1)훼푞(푖2)훽푞(푗2).
(14)
Therefore, we can rewrite Equation (13) as follows:
퐼˜{푝,푞}(푥, 푦)
=
∑
0≤푖1,푗1,푖2,푗2<푘
푐˜푖1,푗1 푐˜푖2,푗2 (훼푝(푖1 + 푖2)훽푝(푗1 + 푗2)
+ 훼푞(푖1 + 푖2)훽푞(푗1 + 푗2) + 2훼푝(푖1)훽푝(푗1)훼푞(푖2)훽푞(푗2)) .
(15)
Finally, we give a general formula for calculating the fitted
intensity at the point (푥, 푦), induced by 퐴:
퐼˜퐴(푥, 푦) =
∑
푝∈퐴
퐼˜{푝}(푥, 푦) + 2
∑
푝,푞∈퐴
푝 ∕=푞
퐸˜{푝}(푥, 푦)퐸˜{푞}(푥, 푦).
(16)
The first and second terms in Equation (16) can be calculated
by Equations (9) and (14), respectively.
C. Accuracy
To verify the accuracy of our fitted intensity function (Equa-
tion (16)), we tested it on the three common patterns studied
in recent works [2] and [21], as illustrated in Fig. 5. SPLAT
is used to generate the simulated intensity data, since it is the
golden lithography simulator in academia and industry. The
optical parameters of SPLAT are 휆 = 193푛푚, 푁퐴 = 0.85,
and 푑푒푓표푐푢푠 = 0.
To accurately fit the SPLAT simulated intensity data, we
generated a large number of data points in the region of
interest. The region of interest and the number of points are
given in Table I, where 푊푎, 퐻푎, 푋푎, and 푌푎 denote the
TABLE I
REGION OF INTEREST AND THE NUMBER OF POINTS USED FOR DESIGN
PARAMETERS. 푊푎 , 퐻푎 , 푋푎 , AND 푌푎 DENOTE THE WIDTH, THE HEIGHT,
THE X-COORDINATE, AND THE Y-COORDINATE OF THE APERTURE,
RESPECTIVELY.
Design Parameter Region of Interest #Points
푊푎 90 to 270 푛푚 3
퐻푎 90 to 900 푛푚 10
푋푎 -1000 to 1000 푛푚 10
푌푎 -1000 to 1000 푛푚 10
 0
 10
 20
 30
 40
 50
 60
 70
 80
 0  5  10  15  20
E
rr
o
r 
(%
)
Degree of the Taylor polynomial, k
Emax
Eavg
Fig. 6. Maximum (퐸푚푎푥) and average (퐸푎푣푔) intensity errors for different
푘’s.
width, the height, the x-coordinate, and the y-coordinate of
the aperture, respectively. We ran SPLAT on all combinations
of design parameter points (3x10x10x10 = 3000 points in
total). The total running time was about 5 hours on a 1 GHz
Sun Blade-2000 workstation with 8 GB memory. The statistics
package SAS [13] was then used to perform a multiple linear
regression on the generated SPLAT data.
In Section III-A, 푠푖푛푐() is approximated by the first 푘 terms
of the Taylor series. The degree 푘 affects the accuracy of the
approximated 푠푖푛푐 function, and so does the accuracy of the
fitted intensity function. Therefore, we performed curve fitting
with different 푘’s to investigate the influences of 푘. Table II
shows the results with different 푘’s and patterns, where 푘,
퐸푚푎푥, and 퐸푎푣푔 are the degree of the Taylor polynomial,
the maximum intensity error between the results from SPLAT
and our fitted intensity function, and the average intensity
error, respectively. Fig. 6 plots the curves of the maximum
and average intensity errors with different 푘’s. As shown in
Fig. 6, when 푘 is larger than 9, the maximum and average
intensity errors between the results from SPLAT and our fitted
intensity function are stable. Therefore, the required number of
fitting coefficients is small (92 terms is enough). The average
intensity error between the results from SPLAT and our fitted
intensity function is less than 2.21% for 푘 ≥ 9. The intensity
images obtained from SPLAT and our fitted intensity function
with 푘 = 9 are illustrated in Fig. 7. Simulations with SPLAT
show the high fidelity of our fitted intensity function.
IV. QUASI-INVERSE LITHOGRAPHY TECHNIQUE
In the sub-wavelength lithography, some design shapes
might not be printed clearly because these shapes printed by
the original layout have insufficient intensity. By enlarging
and/or adding patterns, an OPC tool can modify the layout to
6 IEEE TRANSACTIONS ON COMPUTER-AIDED DESIGN OF INTEGRATED CIRCUITS AND SYSTEMS, VOL. XX, NO. Y, MONTH 2009
Algorithm: OPC-Demand-Calculation
Input: 퐺 – a layout with a set of design shapes
퐼 – intensity formula
푄 – quasi-inverse kernel function
Output: 퐷퐺 – the OPC demand map of 퐺
1. Use 퐼 to obtain the original intensity map of 퐺;
2. Calculate the insufficient intensity map of 퐺;
3. Calculate the insufficient amplitude map of 퐺;
4. Use 푄 to obtain the OPC demand map 퐷퐺 of 퐺;
5. return 퐷퐺.
Fig. 9. OPC demand calculation.
A point with a larger OPC demand means that it has a higher
probability to be added with OPC patterns in the point by a
post-layout OPC tool. We shall reserve those points with larger
OPC demands in the routing stage to avoid OPC failures and
thus a layout modification process.
Since the output of most lithography simulators is an inten-
sity map, we develop an approximate insufficient amplitude
map by using an intensity map. The approximate insufficient
amplitude 퐸˜푠 is calculated as follows:
퐸˜푠 =
√
퐼푠, (25)
퐼푠 =
{
퐼푡 − 퐼, 퐼푡 > 퐼;
0, otherwise, (26)
where 퐼 , 퐼푡, and 퐼푠 are the intensities induced by the original
layout, the given threshold intensity of photoresist reaction,
and the insufficient intensity, respectively. Underestimating the
insufficient amplitude might cause insufficient free space for
an OPC tool. Since we can guarantee that the approximate
insufficient amplitude 퐸˜푠 is always larger than or equal to
the insufficient amplitude 퐸푠, our approximation will never
underestimate the required free space for post-layout OPC.
We have the following lemma and theorem.
Lemma 1: 퐸˜푠 ≥ 퐸푠.
Theorem 1: Our approximate insufficient amplitude never
underestimates the required free space for post-layout OPC.
Therefore, we can rewrite Equation (24) as follows:
퐷(푥, 푦) =
∞∫
−∞
∞∫
−∞
퐸˜푠(푥− 푓, 푦 − 푔)푄(푓, 푔) 푑푓 푑푔. (27)
Fig. 8 shows an illustration and an example of OPC demand
calculation. First, we use the intensity formula in Section III-B
to obtain the original intensity map. Second, the insufficient
intensity map is computed by subtracting the values in the
target intensity map from the corresponding ones in the
original intensity map. Third, the insufficient amplitude map is
computed by Equation (25). Finally, we use the quasi-inverse
kernel functions to get the OPC demand map by Equation (27).
Fig. 9 summarizes the algorithm for OPC-demand calculation.
V. EXTENSIONS TO PARTIALLY COHERENT SYSTEMS
As pointed out in [18], a partially coherent system can be
approximated by the singular value decomposition of the TCC
(transmission cross coefficients) matrix. This approximation
method is called the sum-of-coherent system (SOCS). The
푛푡ℎ-order approximation can be described by a weighted
sum of coherent systems. The aerial image intensity of a
partially coherent illumination system can be decomposed into
a number of fully coherent systems as follows:
퐼 =
∑
1≤푚≤푛
푚퐼푚, (28)
퐼푚 = (퐸푚)
2
= 퐸푚 ⋅ 퐸∗푚
= (퐿⊙퐾푚) ⋅ (퐿⊙퐾푚)∗,
where 푛, 푚, 퐸푚, 퐿, and 퐾푚 denote the number of coherent
systems, the scaling factor for the coherent system 푚, the
amplitude induced by the coherent system 푚, the pattern on
the mask, and the kernel function of the coherent system 푚,
respectively.
The intensity formula can be smoothly extended under a
partially coherent system. According to Equation (28), we can
rewrite Equation (9) as follows:
퐼˜{푝}(푥, 푦)
=
∑
0≤푖1,푗1,푖2,푗2<푘
1≤푚≤푛
푐˜푚,푖1,푗1 푐˜푚,푖2,푗2훼푝(푖1 + 푖2)훽푝(푗1 + 푗2),
(29)
where 푐˜푚,푖,푗 (푛푘2 terms) are determined by a multiple linear
regression to the simulation data. Based on the coefficient
푐˜푚,푖,푗 , the fitted amplitude for the coherent system 푚 is given
by
퐸˜푚,{푝}(푥, 푦) =
∑
0≤푖,푗<푘
푐˜푚,푖,푗훼푝(푖)훽푝(푗). (30)
Consequently, a general formula for fitting the intensity at the
point (푥, 푦), induced by 퐴, can be derived as follows:
퐼˜퐴(푥, 푦) =
∑
푝∈퐴
퐼˜{푝}(푥, 푦)
+2
∑
푝,푞∈퐴
푝∕=푞
1≤푚≤푛
푚퐸˜푚,{푝}(푥, 푦)퐸˜푚,{푞}(푥, 푦).
(31)
Since Equation (31) is an analytical formula, it can be used
to calculate the intensity very efficiently.
To verify the accuracy of our fitted intensity function
(Equation (31)) under a partially coherent system, we tested
it with the same experimental setup in Section III-C. The
illumination system was annular with 휎 = 0.94/0.74 and was
decomposed into six fully coherent systems. Table III shows
the results with different 푘’s and patterns, where 푘, 퐸푚푎푥, and
퐸푎푣푔 are the degree of the Taylor polynomial, the maximum
intensity error between the results from SPLAT and our fitted
intensity function, and the average intensity error, respectively.
Simulations with SPLAT show the high fidelity of our fitted
intensity function under a partially coherent system.
The quasi-inverse lithography technique can also be
smoothly extended under a partially coherent system. For each
8 IEEE TRANSACTIONS ON COMPUTER-AIDED DESIGN OF INTEGRATED CIRCUITS AND SYSTEMS, VOL. XX, NO. Y, MONTH 2009
global routing path (with 1 푢푚 extensions along the path
for our implementation), since the detailed routing area is
bounded by the global routing path. For the “grid cell” shown
in Fig. 8, its size is 10 푛푚 × 10 푛푚 in our implementation.
Therefore, the number of stored cells is reasonable, leading
to only additional 5% memory usage as will be reported in
Section VII. After computing the OPC demand, we perform
detailed routing considering the wirelength and OPC demand
to find a real routing path based on the global routing result.
The OPC demand is then used to guide the detailed routing to
avoid OPC-prohibited regions. To consider the wirelength and
OPC demand, we compare the wirelength first and then the
OPC demand during routing since longer wirelength consumes
more routing resource and may lower routability.
VII. EXPERIMENTAL RESULTS
We implemented the proposed intensity and quasi-inverse
lithography formulae in the C++ programming language and
incorporated them into the MGR detailed router [4] (called
QL-MGR), and compared it with the gridless full-chip mul-
tilevel router that considers rule-based OPC [4] (called RB-
MGR). The two routers were run on the same 1 GHz Sun
Blade-2000 workstation with 8 GB memory and used the
same setting for the size of routing tiles for all benchmarks.
We used two sets of benchmarks, the MCNC benchmarks
(provided by the authors of [9]) and the Faraday benchmarks
introduced in [1], for our comparative study on routing. The
MCNC benchmarks are commonly used in academia while
the Faraday benchmarks are real industrial designs with many
more nets and more complex design rules than the MCNC
ones. To investigate the effects of OPC, we modified the
original MCNC benchmarks to generate a set of benchmarks
with the 65 푛푚 technology. The wire width of each benchmark
was shrunk to 90 푛푚. The layout dimensions and design rules
were also shrunk by the same shrinking ratio of the wire width.
Tables IV and V list the set of benchmarks. In these tables,
“Circuit” gives the names of the circuits, “Size (휇푚2)” gives
the layout dimensions in 휇푚2, “#Layers” denotes the number
of routing layers used, “#Nets” gives the total number of
nets, “#Connections” gives the number of two-pin connections
after net decomposition, “#Pins” gives the number of pins,
“Wire/Via Width (휇푚)” gives the design rules for wire/via
width, and “Wire/Via Spacing (휇푚)” gives the design rules
for wire/via spacing. Table VI lists the design rules for the
Faraday benchmarks with six metal layers and five via layers,
including widths and spacings.
The geometries of the routing results of RB-MGR and
QL-MGR were extracted and fed into Mentor Graphics’s
Calibre-OPC [2] to perform the correction. The optical pa-
rameters of Calibre-OPC were 휆 = 193푛푚, 푁퐴 = 0.85,
and 푑푒푓표푐푢푠 = 0/0.1휇푚. The illumination system was
annular with 휎 = 0.94/0.74 and was decomposed into six
fully coherent systems. The thicknesses of photoresist and the
bottom anti-reflective coating (BARC) were 75 푛푚 and 80
푛푚, respectively.
We compared RB-MGR and QL-MGR by the total wire-
length, the memory usage, the routing time, the EPE distri-
bution, the maximum EPE, and the average EPE. Table VII
Circuit
N
u
m
b
er
 o
f 
E
P
E
 D
is
tr
ib
u
ti
o
n
s
1
10
100
1000
10000
100000 
1000000 
RB-MGR/0-10
RB-MGR/10+
QL-MGR/0-10
QL-MGR/10+
Fig. 10. Comparison between RB-MGR and QL-MGR by the EPE distri-
bution with 푑푒푓표푐푢푠 = 0.
gives the comparison of RB-MGR and QL-MGR by the total
wirelength, the memory usage, and the routing time. In this
table, “WL” gives the total wirelength in 휇푚, “Memory” gives
the memory usage in MB, “Routing Time” gives the and
running times for routing in second. All benchmarks were
100% routed. The memory requirements for QL-MGR range
from 9.8 MB for Primary1 to 2062.3 MB for RISC1 (the
average is 431.4 MB, only 5% larger than RB-MGR). Further,
QL-MGR reduces 1% total wirelength and incurs only 13%
larger running time than RB-MGR.
Figs. 10 and 11 (Figs. 12 and 13) give the comparisons
of RB-MGR and QL-MGR for the EPE distribution, the
maximum EPE, and the average EPE with 푑푒푓표푐푢푠 =
0 (푑푒푓표푐푢푠 = 0.1). In these figures, “0–10”, “10+”,
“퐸푃퐸푚푎푥”, and “퐸푃퐸푎푣푔” give the number of EPE distri-
bution between 0 and 10 휇푚, the number of EPE distribution
larger than 10 휇푚, the maximum EPE, and the average EPE in
푛푚, respectively. The number of EPE distribution, 퐸푃퐸푚푎푥,
and 퐸푃퐸푎푣푔 were obtained from Calibre-OPC. Compared
with the rule-based RB-MGR, QL-MGR reduces the number
of EPE distribution between 0 and 10 휇푚 by 46% (45%),
the number of EPE distribution larger than 10 휇푚 by 59%
(55%), the maximum EPE by 15% (12%), and the average
EPE by 16% (14%). The results show that our quasi-inverse
lithography technique is effective, efficient, and economical.
Fig. 14 shows the full-chip, the original partial, and the
partial OPCed routing solutions for “Mcc2” obtained from QL-
MGR.
VIII. CONCLUSIONS
In this paper, we have presented an efficient, accurate, an
economical analytical formula for intensity computation and
developed the first modeling of the post-layout OPC based
on the quasi-inverse lithography technique. This technique
provides key insights into a new direction for post-layout
OPC modeling during routing. Extensive simulations with
SPLAT have shown that the intensity formula has high fidelity.
Incorporating the OPC costs computed by the quasi-inverse
lithography technique for our post-layout OPC modeling into
a router, the router can be guided to maximize the effects of
the correction. Compared with the rule-based OPC method in
10 IEEE TRANSACTIONS ON COMPUTER-AIDED DESIGN OF INTEGRATED CIRCUITS AND SYSTEMS, VOL. XX, NO. Y, MONTH 2009
(nm)
Circuit
0
5
10
15
20
25
30
RB-MGR/EPEmax
RB-MGR/EPEavg
QL-MGR/EPEmax
QL-MGR/EPEavg
Fig. 11. Comparison between RB-MGR and QL-MGR by the maximum
EPE and the average EPE with 푑푒푓표푐푢푠 = 0.
Circuit
N
u
m
b
er
 o
f 
E
P
E
 D
is
tr
ib
u
ti
o
n
s
1
10
100
1000
10000
100000 
1000000 
RB-MGR/0-10
RB-MGR/10+
QL-MGR/0-10
QL-MGR/10+
Fig. 12. Comparison between RB-MGR and QL-MGR by the EPE distri-
bution with 푑푒푓표푐푢푠 = 0.1.
(nm)
Circuit
0
5
10
15
20
25
30
35
RB-MGR/EPEmax
RB-MGR/EPEavg
QL-MGR/EPEmax
QL-MGR/EPEavg
Fig. 13. Comparison between RB-MGR and QL-MGR by the maximum
EPE and the average EPE with 푑푒푓표푐푢푠 = 0.1.
OPC
(b)
(a)
(c)
Fig. 14. Routing solutions for “Mcc2” obtained from QL-MGR. (a) Full-
chip routing solution. (b) Original partial solution. (c) Partial OPCed solution.
Wires in Metals 1, 2, 3, and 4 are colored in blue, green, red, and pink,
respectively.
a state-of-the-art gridless router, the experimental results have
shown that our approach can achieve 15% and 16% reductions
in the maximum and average layout distortions, respectively.
Future work includes extending the analytical formula for
intensity computation to consider other manufacturing pa-
rameters, such as photoresist and lens aberration, and other
important DFM techniques, such as non-optical lithography
(projection E-beam, imprint, etc.) and lithography with the
immersion technology.
REFERENCES
[1] S. N. Adya, S. Chaturvedi, J. A. Roy, D. Papa, and I. L. Markov,
“Unification of partitioning, floorplanning and placement,” in Proc. Int.
Conf. Comput. Aided Des., pp. 550–557, Nov. 2004.
[2] Calibre OPC, Mentor Graphics Corporation.
[3] T.-C. Chen and Y.-W. Chang, “Multilevel full-chip gridless routing
considering optical proximity correction,” in Proc. Asia South Pacific
Des. Autom. Conf., pp. 1160–1163, Shanghai, China, Jan. 2005.
[4] ——, “Multilevel full-chip gridless routing with applications to optical-
proximity correction,” IEEE Trans. Comput.-Aided Design Integr. Cir-
cuits Syst., vol. 26, no. 6, pp. 1041–1053, Jun. 2007.
[5] T.-C. Chen, G.-W. Liao, and Y.-W. Chang, “Predictive formulae for OPC
with applications to lithography-friendly routing,” in Proc. Des. Autom.
Conf., pp. 510–515, Anaheim, CA, Jun. 2008.
[6] M. Cho, K. Yuan, Y. C. Ban, and D. Z. Pan, “ELIAD: Efficient
lithography aware detailed routing algorithm with compact and macro
post-OPC printability prediction,” IEEE Trans. Comput.-Aided Design
Integr. Circuits Syst., vol. 28, no. 7, pp. 106–1016, Jul. 2009.
[7] S. Chow, A. B. Kahng, and M. Sarrafzadeh, “Modern physical design:
Algorithm technology methodology,” in Tutorial of Int. Conf. Comput.
Aided Des., Nov. 2000.
[8] N. B. Cobb, “Fast optical and process proximity correction algorithms
for integrated circuit manufacturing,” Ph.D. dissertation, University of
California at Berkeley, 1998.
[9] J. Cong, J. Fang, M. Xie, and Y. Zhang, “MARS-A multilevel full-
chip gridless routing system,” IEEE Trans. Comput.-Aided Design Integr.
Circuits Syst., vol. 24, no. 3, pp. 382–394, Mar. 2005.
[10] J. W. Goodman, Introduction to Fourier Optics, 3rd Edition. Greenwood
Village, CO: Roberts & Company Publishers, 2004.
[11] H. H. Hopkins, Wave theory of aberrations. New York, NY: Oxford
University Press, 1950.
[12] L.-D. Huang and D. F. Wong, “Optical proximity correction (OPC)-
friendly maze routing,” in Proc. Des. Autom. Conf., pp. 186–191, San
Diego, CA, Jun. 2004.
[13] R. Khattree and D. N. Naik, Applied Multivariate Statistics with SAS
Software. Cary, NC: SAS Institute, 1999.
 1
 
國科會補助專題研究計畫項下出席國際學術會議心得報告 
                                    日期： 99 年 7 月 3 日 
一、參加會議經過 
電子設計自動化會議（ACM/IEEE Design Automation Conference）為國際歷史最悠久（2010
年為第四十七屆）、最重要及最大型的電子自動化設計會議（暨展覽）。除學術論文發表外，全球
主要的電子自動化設計公司均會參與。對於了解國際性的研發趨勢經驗交流及促成國際合作關係
助益極大。 
今年的電子設計自動化研討會於6月13日至6月18日舉行，本次於美國加州洛杉磯的Anaheim 
Convention Center 進行，與會人員超過 1000 名，包含世界各國系統設計師和架構師、邏輯和電路
設計師、驗證工程師、設計自動化經理/資深經理/總經理及著名大學的研究人員和學者，並有將近
200 家全球主要的電子自動化設計公司、矽與 IP 供應商參加展覽。這次會議是由 Association for 
Computing Machinery（ACM)，Association for Computing Machinery’s Special Interest Group on 
Design Automation（ACM/SIGDA)，SIGDA/DAC University Booth，EDA Consortium，IEEE，
IEEE/Council on Electronic Design Automation，IEEE/Circuits and Systems Society（CASS），以及
IEEE/Computer Aided Network Design（CEDA）主辦。 
會議的主題包括了: system-level design，low-power design，physical design and manufacturing，
embedded systems，logic and high level synthesis，simulation，verification，testing 及 emerging 
technologies 等等。另外，大會安排了三個 keynote speech。講者分別為 Doug Grose，Bernard S. 
Meyerson，及 Iqbal Arshad。Doug Grose 為 GLOBALFOUNDRIES 的 CEO，講題是” From contract to 
collaboration delivering a nre approach to foundry”，由 CEO 的觀點來看製程廠在電子設計中所扮演
的角色。Bernie Meyerson 是 IBM 的的創意副總，講題是” Echoes of DAC’s past: from prediction to 
計畫編號 NSC 97－2218－E－008－008－MY2 
計畫名稱 在奈米製程下考量效能和可製造性之多階層無格線式全晶片繞線 
出國人員 
姓名 陳泰蓁 
服務機構 
及職稱 
國立中央大學電機工程學系 
助理教授 
會議時間 99 年 6 月 13 日至 99 年 6 月 18 日 會議地點 美國、加州、洛杉磯 
會議名稱 (中文)2010 電子設計自動化會議 
(英文)2010 ACM/IEEE Design Automation Conference 
發表論文 
題目 
(中文) 
(英文) 
附件四 
國科會補助計畫衍生研發成果推廣資料表
日期 2010年11月01日
國科會補助計畫
研發成果名稱
發明人
(創作人)
技術說明
技術移轉可行性及
預期效益
技術/產品應用範圍
產業別
計畫名稱:
計畫主持人:
計畫編號: 學門領域:
(中文)
(英文)
成果歸屬機構
(中文)
(英文)
在奈米製程下考量效能和可製造性之多階層無格線式全晶片繞線
陳泰蓁
97 -2218-E -008 -008 - 積體電路及系統設計
在奈米製程下考量效能和可製造性之多階層無格線式全晶片繞線
國立中央大學 陳泰蓁,洪牧新
隨著製程技術進入奈米（nanometer）時代，晶片上元件的尺寸縮小到90奈米以
下，同時，單顆晶片可容納超過十億個電晶體。再者，元件的最小尺寸比微影
技術（lithography）所使用的波長小上許多，因此晶圓上的設計形狀可能有很
大的失真（distortion）。為了處理如此龐大又複雜的電路設計，需要發展新
的繞線系統（routing system）來處理現代設計的四大挑戰：複雜度
（complexity）、可繞度（routability）、晶片效能（performance）以及可
製造性（manufacturability）。
本技術提出了一個多階層（multilevel）無格線式（gridless）全晶片繞線系
統以解決這四大挑戰。
As technology advances into the nanometer era, chips may consist of
billions of transistors, and process geometries shrink to 90 nm and
below. Further, the minimum feature size becomes significantly
smaller than the lithographic wavelength, and thus design shapes on a
wafer may have large distortions. For such large and complex designs,
it is desirable to develop a new routing system that can cope with
the four major modern design challenges: complexity, routability,
performance, and manufacturability.
In this proposed technique, we proposed a multilevel gridless full-
chip routing system to handle these four design challenges.
其他專業、科學及技術服務業
電子設計自動化, 積體電路設計, 積體電路布局, 積體電路製造
本技術已開發出之自動化軟體可技轉給業界，大幅提升台灣IC 設計產業的競爭力
註：本項研發成果若尚未申請專利，請勿揭露可申請專利之主要內容。
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
1. 指導學生獲教育部「九十七學年度大學校院積體電路電腦輔助設計軟體製作
競賽」定題組佳作一件 [單題第一名], 入選一件[大學部同學] 
2. 新思科技訪問教授 
3. 台灣 IC 設計學會沈文仁教授年度論文獎 
4. 指導學生獲教育部「九十六學年度大學校院積體電路電腦輔助設計軟體製作
競賽」定題組佳作一件 [單題第一名], 入選一件[大學部同學] 
 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
