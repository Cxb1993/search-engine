1. 前言 
為了使汽油引擎的運轉達到安全性、舒
適性及環保的目的，引擎上有各種不同的感
測器，分別擷取不同的動態訊號，輸入行車
電腦(ECU)做分析及計算，進而控制引擎的
運轉。當汽油引擎的感測器產生故障時，往
往會使 ECU 因接收到錯誤的訊息，而造成
引擎的運轉不良，導致引擎損毀，或廢氣
排放過多而造成嚴重的空氣污染問題。因
此，如果可以及時修復錯誤的訊號，使引擎
回復正常運作，保障行車安全，是一必要且
迫切的任務。在此，本文將利用類神經模
糊技術，在引擎運轉狀況下，藉由量測引
擎的各種感測器信號來判別引擎的空氣流
量感測器是否產生故障及修復此故障，使
引擎仍能在正常狀況下運轉。 
類神經模糊技術是一種結合類神經網
路及模糊理論的新興技術，藉由類神經網
路的自我學習來訓練系統的參數，因此具
有良好的容錯性和適應性，尤其對於非線
性系統的動態模式辨識，更能展現其特殊
的辨識能力，因而被廣泛應用在樣本識別
及故障診斷上。Tyan [1]等利用類神經網路
來診斷磁浮軌道車輛的故障源，並使用模
糊控制方法使系統回歸至正常模式。Huang 
[2]等的模糊故障診斷系統是利用衍生式演
算法來調整模糊推論法則之歸屬函數參數
與故障源之診斷輸出。Patrick [3]等以引擎
轉速及節汽門角度所組成的多項式來近似
空氣質量流率，由多項式係數的變化率，
來判斷空氣質量流率感測元件是否故障。 
在本文中，提出了一個空氣流量故障修
復系統架構，包含了一個空氣流量預測系統
及一個空氣流量監控系統。由空氣流量預測
系統去預測引擎當時的正常空氣流量；由空
氣流量監控系統去判別是否修正傳送到引擎
ECU 的空氣流量信號。當空氣流量感測器產
生故障時，空氣流量故障修復系統會以預測
的空氣流量信號取代錯誤的空氣流量信號，
以改善引擎因故障的空氣流量信號所導致的
錯誤操控模式。空氣流量預測系統是由模糊
系統所架構而成，利用類神經網路、倒傳遞
學習演算法及最陡坡降法來調整模糊集合的
參數及推論法則的輸出增益，以降低嘗試錯
誤的時間。空氣流量預測系統的輸入變數是
節氣門開度、引擎轉速及噴油脈波寬度，輸
出變數是空氣流量。本研究已在國內發表四
篇研討會論文[6, 7, 8, 10]，一篇國內的期刊
論文[5]，及一篇國外的 SCI 期刊論文[9]。
由實驗結果知，結合類神經網路及模糊系統
來建立空氣流量故障修復系統，可以達到修
復錯誤空氣流量信號的目的。 
2. 空氣流量預測系統 
本文以模糊系統來建立汽油引擎的空氣
流量預測系統，這個系統有三個輸入變數分
別是x1、x2和x3及一個輸出y。模糊推論法則
的描述如下： 
R1: IF x1 is A11 and x2 is A21 and x3 is A31
THEN  y is y1
R2: IF x1 is A12 and x2 is A22 and x3 is A32 
THEN  y is y2
…     …  
R[((i-1)q+j-1)r+ k]: 
IF x1 is A1i and x2 is A2j and x3 is A3k
THEN  y is y((i-1)q+j-1)r+k
…     … 
Rpqr: IF x1 is A1p and x2 is A2q and x3 is A3r
THEN  y is ypqr
其中，A1i (i=1, p)，A2j (j=1, q) 和A3k (k=1, r)
分別為x1、x2和x3的模糊集合。在本文中，x1
代表節氣門開度，x2代表引擎轉速，x3代表
噴油脈寬，輸出變數y代表空氣流量。yn代表
第n條推論法則的輸出增益。推論法則的真實
2 
同理，可得到推論法則輸出增益的調整法則
如下： 
( ) ( ) ( )
∑∑∑
= = =
⋅−+=+ p
i
q
j
r
k
n
n
nn
h
hyy
tyty
1 1 1
* ˆ
1
γ
    (14) 
其中 α, β, γ 是代表學習率，t 是代表迭代次
數。空氣流量預測系統的訓練步驟如下： 
1. 給定p, q, r值，學習率α,β及γ值，期望收
斂值ε及訓練次數tmax。 
2. 設定歸屬函數中心起始值及寬度起始
值，a1i0, b1i0 (i=1,p)，a2j0, b2j0 (j=1,q)，a3k0, 
b3k0 (k=1,r)，及起始增益yn0 (n=1, rqp ×× )。 
3. 讀入訓練資料，計算每條模糊規則的真實
度。 
4. 由(2)式計算解模糊化輸出 。 yˆ
5. 由(8)到(14)式更新a1i, b1i, a2j, b2j, a3k, b3k, 
及yn。 
6. t = t+1，計算均方根誤差(RMSE)，如(15)
式所示 
( )
n
yy
RMSE
n
s
ss∑
=
−
= 1
2* ˆ
            (15) 
s 表示第 s 筆資料，n 表示訓練資料長度。 
7. 若RMSE < ε或t > tmax，則學習完成；否則
回到步驟 3 繼續學習。 
當訓練學習過程結束後，便完成了空氣流量
預測系統。 
4. 空氣流量故障修復系統 
當空氣流量信號產生偏移時，會導致引
擎被控制於混合比過濃或過稀的狀況下運
轉，混合比過濃會造成排放廢棄物過多，混
合比過稀會使引擎的輸出動力不足。因此本
文提出空氣流量故障修復系統，其系統架構
圖如圖 1 所示。將引擎的節氣門角度、轉速
和噴油脈寬信號輸入到空氣流量預測系統，
以得到引擎在當時運轉狀況下的空氣流量。
之後，將預測的空氣流量信號和實際測量的
空氣流量信號做比較，若誤差大於 3%以上
時，則由空氣流量故障修復系統輸出空氣流
量信號到引擎的 ECU，進行空氣流量信號的
修正，將引擎導正到正常的燃料混合比下運
轉。 
5. 結果與討論 
圖 2 是汽油引擎系統的實驗架構。本研
究所用的汽油引擎系統為 Mitsubishi 4G92
多點順序噴射引擎，直列式四汽缸，總排氣
量 1597cc，壓縮比 10:1。 
收集引擎在空氣流量正常及錯誤下的各
項引擎感測器的動態資料，再把這些資料分
為訓練資料與測試資料二個部份。訓練資料
用來訓練空氣流量預測系統的各項參數，而
測試資料則用來驗證及評估空氣流量故障修
復系統的可行性。 
由於從引擎上所擷取到的動態資料的級
數(order)相差很大，例如：轉速信號和節氣
門角度信號的等級就相差很多，因此必須將
這些資料轉變為相同級數的資料。使用正規
化(normalization)的方法，經過正規化的步驟
可以避免數值較小的資料其重要性被忽略
掉，而影響到訓練及鑑別的正確性。本文所
使用的正規化參數分別敘述如下： 
minmax
min
1 θθ
θθ
−
−=x          (16) 
 
minmax
min
2 rpmrpm
rpmrpmx −
−=         (17) 
minmax
min
3 __
__
ontont
ontontx −
−=        (18) 
minmax
min*
airair
airairy −
−=        (19) 
其中，x1代表正規化的節氣門角度，x2代表
正規化的引擎轉速和x3代表正規化的噴油脈
4 
最大，分別是 0.027296（空氣流量信號偏低）
及 0.026352（空氣流量信號偏高）。由表 2
知，故障的空氣流量信號經修正後的引擎狀
態變數誤差率皆低於引擎運轉時的變動率，
故此修復結果是可行的，亦即利用本文所提
出的方法，來校正汽油引擎因空氣流量感測
器產生故障，導致引擎運轉不正常的缺失是
可以被改善的。 
6. 結論 
本文提出了空氣流量故障修復系統架
構，包含了空氣流量預測系統及空氣流量監
控系統。空氣流量預測系統利用類神經網
路、倒傳遞學習演算法及最陡坡降法來訓練
預測系統的模糊集合參數及輸出增益，以達
到準確預測空氣流量的目的。空氣流量監控
系統可判別是否修正傳送到引擎 ECU 的空
氣流量信號，以確保引擎在正常狀況下運轉。 
本計劃分成兩部分來進行，第一部分是
由空氣流量預測系統來預測引擎的正常空氣
流量值。由表 1 所列出的空氣流量預測值和
正常值的均方根誤差都小於 0.01，知空氣流
量預測系統有很好的容錯性及適應性，且能
正確的預測正常的空氣流量值。 
第二部分是由空氣流量監控系統來確保
傳送正確的空氣流量信號到引擎 ECU。在實
際測試上，空氣流量故障修復系統能將錯誤
的空氣流量信號，修正為正確的空氣流量信
號再傳送到引擎 ECU。由表 2 結果知，空氣
流量信號經過修正後的引擎狀態誤差率皆小
於引擎運轉時的變動量，表示引擎經過空氣
流量故障修復系統修正後，引擎的狀態與正
常引擎的狀態是十分接近的，證明本文所提
的空氣流量故障修復系統架構在引擎的實際
應用上是可行的。 
 
 
7. 參考文獻 
[1] Tyan, C. Y., Wang, P. P. and Bahler, D. R.,    
“Neural fault diagnosis and fuzzy fault 
control for a complex linear dynamic 
system,” Proceedings IEEE International 
Conference on, Vol.2, pp.1001-1008, 1995. 
[2] Huang, Y. C., Yang, H. T. and Huang C. L., 
“An evolutionary computation based fuzzy 
fault diagnosis system for a power 
transformer,” Soft Computing in Intelligent 
Systems and Information Processing, 
Proceedings Asian, pp. 218 –223, 1996. 
[3] Buehler, P. J., Freanchek, M. A. and Makki, 
I., “Mass air flow sensor diagnostics for 
adaptive fueling control of internal 
combustion engines,” Proceedings of the 
American Control Conference Anchorage, 
Vol.3, pp.2064-2069, 2002. 
[4] Shi, Y. and Mizumoto, M., “A new 
approach of neuro-fuzzy learning 
algorithm for tuning fuzzy rules,” Fuzzy 
Set and System, Vol.112, pp.99-116, 
2000. 
[5] 陳沛仲，廖哲鴻，”應用類神經模糊技術
於汽油引擎系統之含氧濃度感測器與噴
油嘴不作動之故障診斷＂,Journal of 
Vehicle Engineering, Chinese Society of 
Automotive Engineering, vol 1, pp.47-56, 
2004. 
[6] 陳沛仲，陳聖洲，”應用類神經模糊技
術在汽油引擎的故障診斷－空氣流量
感知器＂，2004 自動控制研討會，pp. 
1-6，民國 93 年。 
[7] 陳沛仲，廖哲鴻，”應用模糊聚類分析於
汽油引擎的建模及預測”，第二十一屆機
6 
0 100 200 300
-0.1
0
0.1
No. of data
P
er
to
n
ton
0 100 200 300
0
0.005
0.01
0.015
No. of data
P
er
ai
r
air
0 100 200 300
-0.01
0
0.01
No. of data
P
er
tp
s
tps
0 100 200 300
-0.1
0
0.1
No. of data
P
er
rp
m
rpm
 
圖 6、測試樣本 r18_L 的誤差率響應圖 
0 100 200 300
-0.1
0
0.1
No. of data
P
er
to
n
ton
0 100 200 300
0
0.005
0.01
0.015
No. of data
P
er
ai
r
air
0 100 200 300
-0.02
-0.01
0
0.01
No. of data
P
er
tp
s
tps
0 100 200 300
-0.05
0
0.05
No. of data
P
er
rp
m
rpm
 
圖 7、測試樣本 r18_H 的誤差率響應圖 
0 100 200 300
-0.1
0
0.1
No. of data
P
er
to
n
ton
0 100 200 300
0
0.02
0.04
0.06
No. of data
P
er
ai
r
air
0 100 200 300
-0.01
0
0.01
No. of data
P
er
tp
s
tps
0 100 200 300
-0.1
0
0.1
No. of data
P
er
rp
m
rpm
 
圖 8、測試樣本 r20_L 的誤差率響應圖 
0 100 200 300
-0.1
0
0.1
No. of data
P
er
to
n
ton
0 100 200 300
0
0.02
0.04
No. of data
P
er
ai
r
air
0 100 200 300
-0.01
0
0.01
No. of data
P
er
tp
s
tps
0 100 200 300
0
0.02
0.04
0.06
No. of data
P
er
rp
m
rpm
 
圖 9、測試樣本 r20_H 的誤差率響應圖 
0 100 200 300
-0.1
0
0.1
No. of data
P
er
to
n
ton
0 100 200 300
-0.05
0
0.05
No. of data
P
er
ai
r
air
0 100 200 300
0
0.01
0.02
No. of data
P
er
tp
s
tps
0 100 200 300
-0.1
0
0.1
No. of data
P
er
rp
m
rpm
 
圖 10 測試資料 r24_L 的誤差率響應圖 
0 100 200 300
-0.1
0
0.1
No. of data
P
er
to
n
ton
0 100 200 300
-0.05
0
0.05
No. of data
P
er
ai
r
air
0 100 200 300
0
0.01
0.02
No. of data
P
er
tp
s
tps
0 100 200 300
-0.1
0
0.1
No. of data
P
er
rp
m
rpm
 
圖 11 測試資料 r24_H 的誤差率響應圖 
 
8 
