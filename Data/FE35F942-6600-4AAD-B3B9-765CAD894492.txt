2明顯的不同。由於電廠用地之取得越來越不易，水
資源有限，以及火力發電燃料昂貴，世界各國的電
力公司紛紛斥資興建大型高效率電廠，為充份利用
各電廠的設備及提高燃料使用效率，各電力公司均
積極研究電力系統的經濟調度，包括火力機組的派
遣與水火力發電協調最佳調度、火力發電的燃料成
本限制等等，都是目前被廣泛討論的。
在台灣地區電力系統之主要發電方式分成火
力發電，包括核能、燃煤和燃油以及天然氣等火力
發電機組，及水力發電，其中包括水力電廠與抽蓄
電廠。而其中核能機組因發電成本低及不希望經常
作發電量調整，因此通常維持一定的發電量而當作
基載(base load)機組；其它像燃煤和燃油及天然氣
機組則視其在發電成本效益及反應速度的因素考
量下，分別當成基載、中載及尖載(peak load)機組
來使用；而水力機組因幾乎零運轉成本且反應快
速，但卻受限於水資源的供應量限制，一般只作尖
峰發電；抽蓄發電機組則利用離峰時段較廉價的電
力來抽水而於尖峰時段放水發電，以取代尖峰時段
較昂貴的電力，此種電能之轉換在負載變動範圍極
大的台灣地區確實有其經濟效益。在種種的自然與
人為的因素影響下，如何對資源做有效的應用，為
目前台灣電力公司積極著手的目標。
發電系統有效經濟的規劃和運轉，在電力工
業裏扮演一個重要的角色。電力系統運轉的一個主
要目的是在盡可能低成本下安全地提供服務。在處
理成本最小化問題時，需考慮系統運轉上的限制條
件以確保系統的安全，預防無法預見的因素而造成
系統的崩潰。
良好的發電調度可以節省大量發電成本。因
此，在規劃時段內，水火力發電如何調度將是一個
重要的課題。因為水火力發電調度必須考慮系統、
水火力機組特性和水力資源限制等條件，所以水火
力發電調度[1-12]比單純以火力機組構成之機組排
程[13-15]複雜，因此被視為大型、非線性、非凸函
數及混合整數之最佳化問題。為了求解這樣複雜的
問題，許多的數值方法已經被提出來[1,3,10,16]，
但這些方法屬於貪婪搜尋演算法，容易找到局部而
非全域最佳解，且不易處理龐大和複雜的限制條
件。
在水火力發電調度中，利用拉格雷基法[2,5-9]
求解最佳化問題之演算法，皆根據系統限制條件之
電力供需平衡和備轉容量違反的程度，更新拉格雷
基乘數，除非在每次疊代中，能夠確定拉格雷基乘
數被適當的修正，否則，沒有必要投入的發電機組
會發生，最後會導致較高的發電成本。然而，拉格
雷基法比其他分解方法，更有彈性的掌握各式各樣
的限制條件[5]。
基因演算法[17,18]採用多路徑平行尋優之技
巧搜尋問題的最佳解，同時可以處理連續型及離散
型變數，且具有跳脫局部最佳解而趨近全域最佳解
的能力，此演算法之主要特性是可應用於凸型和非
凸型、可微和不可微之目標函數及包含等式和不等
式限制條件。基因演算法目前已經被應用來求解含
大量限制條件之最佳化問題，並且已經被證明能有
效率地尋找到全域最佳解。在電力工程領域上基因
演算法也已受到重視，如火力機組排程[13,14]、經
濟調度[19,20]、虛功率規劃[21]及發電擴充規劃
[22]，都能獲得不錯的解。但是，基因演算法是利
用罰點因子將問題的限制條件鬆弛，對於大型的水
火力發電調度之最佳化問題不易決定適當的罰點
值，然而，拉格雷基鬆弛法可藉由拉格雷基乘數將
限制條件鬆弛。
本計畫提出以拉格雷基法為基礎的共同進化
演算法[23]應用於水火力發電調度問題上，利用拉
格雷基鬆弛法能掌握不同形式的限制條件之優
點，結合基因演算法能跳脫局部最佳解趨近全域最
佳解之優點，將基因演算法融入拉格雷基法中，同
時調整控制變數和拉格雷基乘數。首先，利用拉格
雷基法將問題中的限制條件藉由拉格雷基乘數加
以鬆弛，將原問題表示成拉格雷基函數，接著定義
對偶函數；其次，將控制變數和拉格雷基乘數分成
兩個不同的族群，族群一為控制變數和族群二為拉
格雷基乘數，藉由基因演算法之多路徑平行尋優技
巧求解對偶問題，同時對族群一及族群二進化，兩
族群進化目標互相對立，族群一改變控制變數且最
小化其評估函數及族群二改變拉格雷基乘數且最
大化其評估函數，來增強其求解的效能。
為了驗證本計劃所提方法求解水火力發電調
度的有效性，本研究計劃以三個測試範例作測試。
三、本計畫問題的描述
水火力發電調度是在調度的時間範圍及有限
的水力資源限制條件下，安排系統中水火力機組每
個時段的發電量，使得火力機組的總發電量成本為
最低，同時滿足系統、水火力機組特性和水力資源
限制等條件。在本計畫中，系統限制條件包含電力
供需平衡和備轉容量；火力機組限制條件包括電力
輸出範圍、最少運轉時間和最少停機時間等；水力
資源限制條件包括水力電廠之釋放水量、水庫之蓄
水量及水庫之總可用水量，其中每座水庫溢出的水
量忽略。其數學式描述如下：
3.1 目標函數(objective function)
本計畫目標函數為最小化調度時間內的總成
本，總成本為各火力機組燃料成本和啟動成本的
4其中
min,jq ：水力機組 j最小的發電放水量。
max,jq ：水力機組 j最大的發電放水量。
(4.2) 水庫的蓄水量限制：
max,,min, jtjj VVV 
TtNj h ,...,2,1,...,2,1  (10)
其中
min,jV ：水庫 j最小蓄水量。
max,jV ：水庫 j最大蓄水量。
(4.3) 水力機組的總可用發電水量限制：
 

T
t
totaljtj qq
1
,, , hNj ,...,2,1 (11)
其中
totaljq , ：水力機組 j總可用發電水量。
四、 本計畫採用的方法
在本計畫中，提出以拉格雷基法為基礎的共同
進化演算法作水火力發電調度。首先將原問題表示
成拉格雷基函數，接著定義對偶(dual)函數，進而
使用共同進化演算法求解對偶問題。
4.1 對偶問題的建立
拉格雷基鬆弛法可將問題中龐大的限制條件
藉由拉格雷基乘數(Lagrange multiplier)加以鬆弛，
將原問題表示成拉格雷基函數。原問題之拉格雷基
函數如下：
 
 
  
    
 
  
     




 



 



 
h
t h
t t t h
N
j
T
t
totjtjj
T
t
N
i
N
j
jtiittt
T
t
N
i
N
i
T
t
N
i
N
j
tjtitittistti
qq
PuPSRD
PuPDCFL
1 1
,,
1 1 1
max,,max,
1 1 1 1 1 1
,,,,,,,,,,,


γμλPUq (12)
首先，利用拉格雷基乘數λ、μ和γ分別將限制條
件(2)、(3)和(11)式鬆弛，表示成拉格雷基函數，接
著定義對偶問題，其表示如下：
 γμλ
γμλ
,,max
,,
q (13)
其中
   γμλPUqγμλ
PUq
,,,,,min,,
,,
Lq  (14)
並且滿足(4)-(8)和(9)-(10)之限制條件。
 TNhqqqq ,...,, 21
 Tjjjj qqq ,2,1, ,...,,q , j=1,2,…,Nh
 TNtUUUU ,...,, 21
 Tiiii uuu ,2,1, ,...,,U , i=1,2,…,Nt
 TNtPPPP ,...,, 21
 Tiiii PPP ,2,1, ,...,,P , i=1,2,…,Nt
 
 
 
hN
T
T



,...,,
,...,,
,...,,
21
21
21



γ
μ
λ
解此對偶問題是包含兩個最佳化的問題。在傳
統方法中，首先給定一組λ、μ和γ的初始解，由
(14)式的右邊作最佳化，可求得水力電廠之釋放水
量q和火力機組之運轉狀態U及其發電量P。然後
固定q、U和P，對(13)式作最佳化，可得到λ、μ
和γ值。如此過程不斷重覆，直到最佳解被找到為
止。我們將在下一小節中說明共同進化演算法如何
求解水火力發電調度問題。
4.2共同進化演算法求解水火力發電調度問題
對偶問題建立後，利用基因演算法平行的分別
對族群一和族群二進行進化，其中族群一之染色體
由水力電廠之釋放水量 q和火力機組之運轉狀態
U所構成，至於族群二之染色體由拉格雷基乘數
λ、μ和γ所組成，步驟如下：
步驟一 族群建立及初始化
將控制變數和拉格雷基乘數分為兩個不同的
族群，族群一染色體的基因是由控制變數組成，包
含每個時段 Nh個水力電廠的釋放水量和火力機組
之 Nt個長度 T 的二位元字串，其染色體總長度為
(Nt+Nh)×T，如(15)式所示；族群二染色體的基因是
由拉格雷基乘數組成，包含λ、μ和γ，其染色體
總長度為 (2×T+Nh)，如(16)式所示。其中，水庫的
釋放水量必須介於最小和最大釋放水量之間，λ和
μ必須介於全部火力發電機組之最小和最大增量
成本之間，γ數值的範圍必須根據釋放水量和電力
輸出的關係來決定。族群一和族群二染色體的數目
分別為 V和 W。族群一和族群二染色體表示如下：
6步驟四 交配
在族群一中，從交配槽任意挑選兩個染色體判
斷是否需要交配。隨機產生一個亂數α1，其值介於
0到 1之間，若α1大於族群一的交配率，則直接將
染色體複製到下一代，反之則進行交配。其染色體
的基因包含連續變數 (水力電廠之釋放水量) 和二
位元字串。其中，連續變數之交配採用 ”BLX-α運
算式[18]”，二位元字串交配使用 ”均勻的交配
[17]”。
在族群二中，從交配槽任意挑選兩個染色體判
斷是否需要交配。隨機產生一個亂數α2，其值介於
0到 1之間，若α2大於族群二的交配率，則直接將
染色體複製到下一代，反之則進行交配。其染色體
的基因由連續變數(拉格雷基乘數) 組成，此交配採
用 ”BLX-α運算式[18]”。
步驟五 突變
在族群一中，由交配所產生的染色體必須判斷
是否要進行突變。隨機產生一個亂數η1，其值介於
0到 1之間，若η1大於族群一的突變率，則不進行
突變動作，反之則進行突變。其染色體的基因包含
連續變數(水力電廠之釋放水量)和二位元字串。其
中，連續變數之突變方式以(21)式或(22)式進行。
 





max,
'
max,
'
min,max,
'
jjjj
jjjj
xxthenxxif
xxxx 
(21)
 





min,
'
min,
'
min,max,
'
jjjj
jjjj
xxthenxxif
xxxx  (22)
其中為一個亂數，其值介於 0到 1之間， jx 為進
行突變前染色體基因 j， 'jx 是突變後染色體基因 j。
離散變數之突變方式以(23)式進行





10
01
'
'
ii
ii
yify
yify
(23)
其中 yi為進行突變前染色體基因 i， 'iy 是突變後染
色體基因 i。
在族群二中，由交配所產生的染色體必須判斷
是否要進行突變。隨機產生一個亂數η2，其值介於
0到 1之間，若η2大於族群二的突變率，則不進行
突變動作，反之則進行突變。其染色體的基因由連
續變數(拉格雷基乘數)組成，此突變方式採用(21)
式或(22)式。
突變是為了避免共同進化演算法陷入區域最
佳解。在本計畫中族群一的初始突變率 Μ1及族群
二的初始突變率 Μ2皆很高，隨著世代數的增加，
其突變率將逐漸變小，其公式如下：
  199.0 11  gMgM (24)
  199.0 22  gMgM (25)
其中 g為世代數的指標。
步驟六 評估染色體之適應能力
跟上述步驟二相同。
步驟七 停止條件
停止條件是利用族群一與族群二最差染色體
評估函數值之間的差距，稱為對偶差距來判斷是否
停止進化。此對偶差距的百分比表示如下：
   
  %100min
minmax
2
21


w
w
w
w
v
v
F
FF (26)
若對偶差距百分比連續幾個世代數皆小於容許
值，則停止疊代且輸出最佳解，反之，繼續步驟八。
步驟八 族群取代
從舊族群一(舊父代)和新族群一(子代)中，分
別挑選出前 0.5V 個適應能力較佳的染色體，組成
下一代新的族群(新父代)。同時也從舊族群二(舊父
代)和新族群二(子代)中，分別挑選出前 0.5W個適
應能力較佳的染色體，組成下一代新的族群(新父
代)。此動作可確保族群一和族群二之適應能力最
佳的染色體可以一直進化，往最佳解尋找，而不會
退化。
完成族群取代程序後，重新回到步驟三。
五、實例測試與分析
為了驗證以拉格雷基法為基礎的共同進化演
算法 (CEA) 作水火力發電調度的有效性和正確
性。本文將以三個實例測試，其中每時段之備轉容
量為該時段負載需求之 5%，所求得的結果分別與
λ –γ疊代法和基因演算法比較，以驗證共同進化
演算法應用於水火力發電調度之最佳化問題的有
效性和正確性。在本文中，共同進化演算法是以
Borland C++ 程式語言撰寫，所執行的系統為個人
電腦 Pentium進行模擬測試。實例一和實例二的系
8圖 1 測試實例一之適應能力的收斂圖 圖 2 測試實例一之對偶差距的收斂圖
表 3 測試實例一之電力輸出和總發電成本
演算法 時段
火力機組
電力輸出
( MW )
水力機組
電力輸出
( MW )
水庫的釋水量
( acre-ft/h )
傳輸損失
( MW )
發電成本
( $ )
CEA
1
2
568.45
684.64
666.74
877.19
3643.68
4689.63
35.56
61.56
169,626.84
GA
1
2
566.48
686.65
669.89
875.07
3659.36
4679.07
35.56
61.26
169,641.81
λ –γ
1
2
567.43
685.73
668.30
875.60
3651.50
4681.70
35.73
61.33
169,640.69
5.2 測試實例二
為了進一步說明以拉格雷基法為基礎的共同
進化演算法於水火力發電調度的有效性，本文以另
一個規劃時段較長的系統作為測試範例 [16]，其機
組資料與實例一相同，負載型態為 3天 6個時段，
如表 4所示。但是水力機組的初始狀態和限制條件
與測試實例一不同，其初始條件和限制條件如下所
述：
水庫之初始蓄水量： 100,000 acre-ft
水庫之終了蓄水量： 60,000 acre-ft
水庫之最大蓄水量： 120,000 acre-ft
水庫之最小蓄水量： 60,000 acre-ft
水庫之自然進流量： 2,000 acre-ft/h (每天)
其中”溢洪量”與”電力傳輸損失”忽略不計
CEA 控制參數設定如表 2 所示。圖 3 為測試
實例二之評估函數的收斂圖，虛線由族群一中適應
能力最差 (適應能力值為最大值) 的染色體所組
成；實線是族群二中適應能力最差 (適應能力值為
最小值) 的染色體所組成。在圖 3中，族群一之染
色體由全部水庫的釋水量和火力機組運轉狀態所
構成，其進化目標是最小化評估函數；族群二之染
色體由拉格雷基乘數組成，其進化目標是最大化評
估函數，故兩族群的進化目標互相對立，由圖 3可
得知族群一和族群二之適應能力值最後會收斂，兩
族群之間的差距百分比如圖 4所示，其對偶差距會
逐漸變小直到收斂且找到最佳解，然而從所有染色
體中挑選適應能力最佳者為最佳解，其結果列於表
5。從表中可明顯得知，共同進化演算法比λ –γ疊
代法和基因演算法更容易找到全域最佳解。
適
應
能
力
0 10 20 30 40 50
100
130
160
190
220
x 10
3
世 代 數
…… 族群一之適應能力值
── 族群二之適應能力值
對
偶
差
距
(%)
世 代 數
0 10 20 30 40 50
0
5
10
15
20
10
水庫的儲水量
( acre-ft )
1
2
3
4
5
6
101,801.9
85,883.4
93,812.6
60,170.9
68,956.7
60,000.5
101,116.6
85,466.4
93,767.9
60,001.1
66,373.0
60,019.4
102,333.3
85,946.7
93,680.0
60,000.0
71,466.7
60,000.1
發電成本( $ ) 709,861.4 709,872.8 709,877.4
圖 5 測試實例三之負載資料
5.3 測試實例三
由前面兩個測試實例得知 CEA 能有效的應用
在水火力發電調度上，最後以台灣電力公司的實際
發電系統作為測試實例，進一步探討 CEA 應用於
大型的水火力發電調度之有效性，在本文中也利用
GA 作相同測試，驗證本文所提出的 CEA 之有效
性。此系統是在總規劃時段 24小時內由 11個水力
電廠，包含濁水溪流域的明潭、大觀二、大觀一及
鉅工發電廠，其中明潭及大觀二是抽蓄機組的電
廠；大甲溪流域上德基、青山、谷關及天倫發電廠；
其他還包含立霧、龍澗及義興三個較小型的水力發
電廠；和 48 部火力機組參與排程。負載型態如圖
5所示。
表 2 為測試實例三之 CEA 控制參數。族群一
和族群二的適應能力值之間的差距百分比如圖 6
所示，最後其對偶差距小於容許值且持續數個世代
數，代表已經找到最佳解，從所有染色體中挑選適
應能力最佳者為最佳解，其結果列於表 6。表 6是
分別由 CEA和 GA所求得的總發電成本。由 CEA
所求得水火力發電調度結果，如圖 7所示。從圖 7
中可得知水力電廠的電力輸出與調度當日的系統
負載量有相當大的關連性，在重載時水力電廠為發
電狀態，但在輕載時由水力抽蓄電廠執行抽水運
轉，以減少重載時高燃料發電成本的火力機組運
轉。從測試結果可明顯得知，CEA 能有效的應用
於水火力發電調度。
圖 6 測試實例三之對偶差距的收斂圖
5000
7000
9000
11000
13000
15000
17000
19000
1 3 5 7 9 11 13 15 17 19 21 23
時間 (h)
負
載
(MW)
0 200 400 600 800 1000 1200
0
20
40
60
80
對
偶
差
距
(%)
世 代 數
