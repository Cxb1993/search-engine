 I
中文摘要 
 
一般而言，磁浮軌道系統主要可區分為磁力懸浮與推進系統兩部分，
由於電磁鐵所產生的吸引力具有非線性特性且懸浮平台的姿態控制問題
亦有待克服，是故磁力懸浮系統為目前極為熱門研究主題之一；另一方
面，移動平台懸浮時所產生的正向力往往會對推進系統造成相當程度的
干擾，導致於磁浮軌道系統耦合動態呈現高度非線性且時變特性。有鑑
於此，本多年期計畫主要研製一創新混合型磁浮軌道系統架構，主要採
用混合式電磁鐵以降低移動平台懸浮過程中電能消耗，透過理論分析其
整體耦合動態行為，進而發展以步階迴歸設計為基礎之控制架構應用於
磁力懸浮系統之定位控制 (第一年度 )，並設計適應性模糊類神經網路控制
架構同時應用於磁力懸浮及推進系統，期許達成混合型磁浮軌道系統穩
定平衡及循軌控制之目的 (第二年度 )。首先，根據拉格蘭茲理論，分析包
含混合式電磁鐵動態、懸浮平台動態及推進系統動態之整體混合型磁浮
軌道系統耦合模型。再者，引進強健參數估測及動態曲面控制技術經由
步階迴歸系統化設計磁力懸浮系統之定位控制策略，改善傳統步階迴歸
控制對於系統不確定量之需求、減輕控制力抖動現象及克服因高階微分
所可能引起致動器飽合之問題，此為第一年度計畫創新前瞻之處。更進
一步，為降低控制系統對於系統參數的需求性、縮短控制策略執行時間
以及省略習用輔助控制器以簡化整體控制架構，融合滑動模式控制及模
糊類神經網路設計線型磁浮軌道系統之穩定平衡及循軌控制策略，此為
 III
英文摘要 
 
In general, a magnetic-levitation (maglev) rail system contains two sub-systems 
including maglev and propulsion systems. The subject of inherently unstable 
electromagnetic force and nonlinear attitude control of the moving platform in the maglev 
system is one of interesting research topics at present. On the other hand, the 
corresponding control performance of the propulsion system is influenced easily by the 
normal force produced by the maglev system so that the coupled dynamic model of the 
maglev rail system is highly nonlinear and time varying. Therefore, this multi-years project 
is mainly to design a novel structure of a hybrid maglev rail system with electromagnets 
and permanent magnets to alleviate the power consumption for levitation, and to analyze 
the corresponding entire coupled behavior including hybrid electromagnetic dynamic, 
maglev platform dynamic, and propulsion system dynamic. Moreover, it introduces the 
techniques of robust parameter estimation and dynamic surface control into backstepping 
systematic design for the positioning control of the hybrid maglev system in the first-year 
project to relax the requirement of system uncertainties, to eliminate the chattering 
phenomena, and to deal with the explosion terms caused by repeated differentiations in 
backstepping design procedure and the possible problem of actuator saturations in 
conventional backstepping control. In order to alleviate the sensitivity of a control scheme 
with respect to system parameters, to reduce the execution time of a control strategy, and to 
leave out traditional auxiliary controllers for simplifying conventional complex control 
frameworks, it embeds the sliding-mode control into a fuzzy neural network to design a 
suitable decoupled control methodology for the stable balancing and tracking control of the 
hybrid maglev rail system in the second-year project. All the control laws for the hybrid 
 V
Content 
 
中文摘要  I 
英文摘要  III 
Content V 
Chapter 1 Introduction 1 
Chapter 2 Dynamic Analyses of Hybrid Magnetic Levitation Rail 
System 8 
 2.1 Overview 8 
 2.2 Hybrid electromagnetic system 9 
 2.3 Maglev system 12 
 2.4 Propulsion system 14 
Chapter 3 Backstepping-Based Levitation Control Design 17 
 3.1 Overview 17 
 3.2 Backstepping-based control systems 18 
 3.2.1 Backstepping control system 18 
 3.2.2 Adaptive backstepping control system 20 
 3.2.3 Adaptive dynamic surface control system 22 
 3.3 Numerical simulations and experimental results 25 
 3.4 Conclusions 37 
Chapter 4 Adaptive Fuzzy-Neural-Network Control Using 
 1
Chapter 1 
Introduction 
 
Nowadays, magnetic levitation (maglev) techniques have been respected for 
eliminating friction due to mechanical contact, decreasing maintaining cost, and achieving 
high-precision positioning. Therefore, they are widely used in various fields, such as 
high-speed trains [1−5], magnetic bearings [6, 7], vibration isolation systems [8], wind 
tunnel levitation [9] and photolithography steppers [10]. In general, maglev techniques can 
be classified into two categories: electrodynamic suspension (EDS) and electromagnetic 
suspension (EMS). EDS systems are commonly known as “repulsive levitation”, and the 
corresponding levitation sources are produced by superconductivity magnets [11] or 
permanent magnets [12]. However, the repulsive magnetic poles of superconductivity 
magnets can not be activated at low speed so that they are only suitable for long-distance 
and high-speed train systems. Basically, the magnetic levitation force of EDS is partially 
stable and allows a large clearance. Nevertheless, the productive process of magnetic 
materials is more complex and expensive. On the other hand, EMS systems are commonly 
known as “attractive levitation”, and the magnetic levitation force is inherently unstable so 
that the control problem becomes more difficult. Generally speaking, the manufacturing 
process and cost of EMS are lower than that of EDS, but extra electric power is required to 
maintain a preset levitation height. To merge the merits of these two kinds of levitation 
systems, a hybrid electromagnetic system to be investigated in this project is combined 
with an electromagnet and a permanent magnet. The magnetic force generated by the 
additional permanent magnet is used to alleviate the power consumption for levitation. 
In general, a maglev rail system contains two sub-systems including maglev and 
 3
function in order to obtain faster convergence with moderate input magnitude. Liaw et al. 
[17] presented a two-loop robust control scheme via backstepping recursive design for a 
centrifugal compressor with spool dynamics to achieve stable control performance. 
Unfortunately, the information of system uncertainties is required in these traditional BSC 
systems.  
In previous research literature [18−21], various adaptive estimation mechanisms for 
uncertainty information are usually embedded in BSC to be capable of keeping the 
robustness properties with respect to the uncertainties. Lin and Lee [18] introduced an 
adaptive backstepping control for a linear induction motor (LIM) drive to track periodic 
reference inputs. Zhou et al. [19] developed an adaptive backstepping control (ABSC) 
algorithm for a class of uncertain nonlinear systems with unknown backlash-like hysteresis 
uncertainty. Zhang et al. [20] addressed the control of linear time-varying systems with 
known and unknown parameters via ABSC design. Shieh et al. [21] presented an adaptive 
displacement tracking control via only displacement feedback for a piezo-positioning 
mechanism. Though these control strategies had good control performances and were 
insensitive to uncertainties, adaptive estimation algorithms for system uncertainties are 
always monotonous functions, and tracking error introduced by any uncertainty, such as 
sensor error or accumulation of numerical error, will cause the estimated values increase 
even to infinity with time. It results that the actuator will eventually be saturated and the 
controlled system may be unstable.  
On the other hand, the “explosion of terms” caused by the repeated differentiations of 
the virtual inputs in backstepping design procedure is a latent problem [22]. Recently, the 
dynamic surface control (DSC) technique has been investigated to deal with this problem 
by introducing a filter mechanism at each step of conventional backstepping design 
procedure [23−25]. Swaroop et al. [23] proposed a dynamic surface controller belonging to 
 5
unbalance, saturation of magnetizing inductance, and end effect [28]. Therefore, its 
mathematical model is difficult to derive completely. Though much research has modelled 
the dynamic performance of the LIM and taken all the significant variations into 
consideration [26−30], there still exist uncertainties, which usually are composed of 
unpredictable plant parameter variations, external disturbance, unmodelled and nonlinear 
dynamics, in practical applications of the LIM. Also, they may increase the complexity of 
the analyses and the design of servo controllers.  
For the last decades, intelligent control methods have attracted more attention to deal 
with the complex nonlinear problem of the magnetic levitation [31–35]. Shiakolas et al. 
[31] discussed the use of a real-time digital control environment with a 
hardware-in-the-loop magnetic levitation device for modeling and controls education, with 
emphasis on neural network (NN) feedforward control. Phuah et al. [32] proposed a 
synergistic combination of NN with SMC methodology to carry out a magnetic levitation 
system. Buckner [33] utilized intelligent uncertainty bound estimation with traditional 
SMC to reveal excellent tracking performance without excessive control activity in a 
magnetic levitation system. However, the network weights in [31–33] were adjusted via 
modified online error back-propagation algorithms so that the entire system stability is a 
challenging problem to be solved and the detailed control action behavior in NN is difficult 
to handle clearly. On the other hand, Yang et al. [34] improved the stability and reliability 
of a maglev train based on a composite fuzzy-PID controller. Santisteban et al. [35] used 
the fuzzy logic approach in the magnetic bearing system whose dynamic behavior was not 
well known, and these rules were based on experimental results of a derivative 
proportional controller (PD) previously implemented via computer simulations. Although 
these fuzzy logic techniques [34, 35] allows the constructing of a control system based in a 
group of rules in a similar way as the human thought does, how to build appropriate rules 
 7
FNN-based control scheme can be guaranteed in Lin et al. [40], supervisory control design 
and prior system knowledge were required. Wai et al. [41] presented a robust FNN control 
system for a linear ceramic motor driven by a unipolar switching full-bridge voltage source 
inverter using LC resonant technique. The requirement of prior system knowledge in [40] 
was relaxed in [41] because the FNN controller was designed to learn an ideal feedback 
linearization control law. But an extra robust controller was still required to compensate 
the shortcoming of the FNN controller. Besides, the convergence of network parameters is 
a common problem to be solved in [39–41]. According to the survey of previous works 
with similar control frameworks, the superiority of the proposed AFNNC strategy over 
AFNN schemes from existing literature is summarized as follows: 1) The outputs of the 
AFNNC scheme can be directly supplied to the hybrid electromagnets and LIM without 
complicated control transformations for relaxing strict constrains in conventional 
model-based control methodologies. 2) On-line learning algorithms via Taylor series 
expansion are designed to ensure the stability of the controlled system without the 
requirement of auxiliary control design. 3) The convergence of network parameters in the 
FNN is ensured by the use of projection algorithm. 
 
 9
on the march. 
I-shaped 
Steel Bridge
Linear Induction 
Motor
Moving
Platform
Fender Vertically 
Auxiliary Wheel
Hybrid 
Electromagnet
Gap Sensor
Perpendicularly
Firm Cube
Transversal
Auxiliary Wheel
Motion Basal 
Platform
Magnetic 
Tape
Magnetic
Sensor
3-Phase
Winding
Aluminum 
Sheet
Limit Switch
 
Fig. 2.1  Entire framework of hybrid maglev rail system. 
 
2.2 Hybrid electromagnetic system 
Since the moving platform of the hybrid maglev rail system is levitated by hybrid 
electromagnetic forces, the hybrid electromagnetic dynamic is established before analyzing 
the maglev dynamic. The sketch diagram of a hybrid electromagnetic system is depicted in 
Fig. 2.2, which consists of a hybrid electromagnet, a ferrous plate, a load carrier and a gap 
sensor. Among these, the hybrid electromagnet is composed of a permanent and an 
electromagnet. It forms two flux-loops in the E-type hybrid electromagnet, and the flux 
passes through a permanent magnet, a ferrous plate, an air gap and a core in each loop. The 
corresponding magnetic equivalent circuit can be represented as Fig. 2.3. The 
magnetomotive force (mmf) of this hybrid maglev system is the summation of the 
 11
 ( , ) f ff e e
e
W W
dW x d dx
x
λ λλ
∂ ∂= +∂ ∂  (2.7) 
To compare (2.6) with (2.7), the mechanical force ( , )eF x i  can be expressed via (2.3) as 
 
( , ) 1( , ) ( )
2
f e
e m P m f
e e
W x PF x i N F N i i G i
x x
∂ ∂= − = − + ≡ −∂ ∂
λ
 (2.8) 
where the term fG  is related to the total magnetomotive force, coil turns and the 
permeance in the magnetic path. 
( )U t
ex
mg
( , )eF x i
 
Fig. 2.2  Sketch diagram of hybrid electromagnetic system. 
FeRFeR
PR PR
ex
R
ex
R
cR cR
PF
mN i
Φ Φ
 
Fig. 2.3  Equivalent circuit. 
 13
kinds of motions including levitation ( z , moving in z-direction), rolling (θ , rotating along 
x-axis) and pitching (φ , rotating along y-axis) should be considered to analyze the dynamic 
model of the maglev system. In other words, the mechanical behavior is constrained on the 
side-to-side movements, and it only takes the reliance on the levitation, roll and pitch into 
account in the dynamic derivation. To regard the moving platform as a three-dimensional 
coordinate of the levitation stage, the sketch diagram of the maglev system is illustrated in 
Fig. 2.4, where tl  and tw  are the length and width of the moving platform. Oc , which is 
located at z-axis ( 0=x , 0=y ) in the three-dimensional coordinate, denotes the mass 
center of the moving platform. Oz  and ,maxOz  are the central levitation height and its 
maximum limitation. By dividing the moving platform equally into four sub-platforms 
labeled as A, B, C and D areas, Ac , Bc , Cc , and Dc  represent the mass centers of four 
sub-platforms, and the corresponding levitation heights labeled as Az , Bz , Cz , and Dz  
are measured via gap sensors installed in the location of individual mass center. ll  and wl  
are the horizontal distances from the mass centers of four sub-platforms to x-axis and 
y-axis, respectively. The applied control forces labeled as Af , Bf , Cf , and Df  of four 
sub-platforms are acquired through levitation force produced by hybrid electromagnets.  
According to (2.8), the levitation forces produced by four hybrid electromagnets in 
this maglev system can be arranged as follows: 
 2 2 21( , )
2A A
A
A
A e A m A A A
e
Pf x i N i G i
x
∂= − ≡∂ , 
2 2 21( , )
2B B
B
B
B e B m B B B
e
Pf x i N i G i
x
∂= − ≡∂  
 2 2 21( , )
2C C
C
C
C e C m C C C
e
Pf x i N i G i
x
∂= − ≡∂ , 
2 2 21( , )
2D D
D
D
D e D m D D D
e
Pf x i N i G i
x
∂= − ≡∂  (2.10) 
where the symbols with suffixes A, B, C and D indicate the variables for four hybrid 
electromagnets in different areas. 
In accordance with Lagrangian method, the dynamic model of the maglev system can 
 15
qsv  are d-axis and q-axis primary voltage; rrr rlt =  is the secondary time-constant; 
)(1 2 rsm lll−=σ  is the leakage coefficient; )2(3 rmpf hllnk π=  is the force constant; 
limF  is the electromagnetic force; Lf  is the external force disturbance; pm  is the total 
mass of moving element; d  is the viscous friction and iron-loss coefficient.  
The secondary flux amplitude is defined as follows: 
 22 )()( qrdrr λλλ +=  (2.17) 
and using (2.14) and (2.15), the time derivative of λr  can be derived as follows: 
 
rr
qrqsdrdsm
r
r
r t
iil
t λ
λλλλ )( ++−=  (2.18) 
From (2.16), the LIM motion dynamics can be expressed as 
 ( )f p Lm e dr qs qr ds e
k m fx v i i v
d d d
λ λ= = − − −   (2.19) 
where mx  is the mover position. In the LIM dynamics described by (2.18) and (2.19), dsi  
and qsi  are the control inputs, and rλ  and mx  are the system outputs. Thus, the LIM 
dynamic is a coupled system. Because there is no direct relations between the outputs and 
inputs, it is difficult to design suitable control inputs dsi  and qsi  so that the system 
outputs rλ  and mx  can track the desired trajectories accurately. Besides, the 
corresponding control performance of the LIM propulsion system is also influenced easily 
by the normal force produced by the maglev system so that the coupled dynamic model of 
the hybrid maglev rail system is highly nonlinear and time varying. 
By considering the mechanical equation of the propulsive LIM (2.19) and the dynamic 
model of the maglev system (2.11), the entire dynamic model of the hybrid maglev rail 
system can be organized by the following matrix form: 
 ,0 ,0 , ,0M BR R R R R c R+ = −x x u d   (2.20) 
 17
Chapter 3 
Backstepping-Based Levitation Control Design 
 
3.1 Overview 
The levitation control in a hybrid magnetic-levitation (maglev) rail system is a subject 
of considerable scientific interest because of highly nonlinear and unstable behaviors. The 
first-year project mainly focuses on the sequential developments of backstepping-based 
control systems including a backstepping control (BSC), an adaptive backstepping control 
(ABSC) and an adaptive dynamic surface control (ADSC) for the levitated positioning of 
the hybrid maglev rail system. In the proposed ADSC system, a filter mechanism is 
incorporated with BSC to cope with the problem of the explosion terms caused by repeated 
differentiations in backstepping design procedure. Moreover, a robust observer is designed 
for predicting system uncertainties to solve the trouble of chattering phenomena caused by 
a sign function in BSC and ABSC laws despite the utilization of a fixed value or an 
adaptive tuning algorithm for the lumped uncertainty bound. The effectiveness of the 
proposed control schemes for the levitation control of a maglev system is verified by 
numerical simulations and experimental results, and the superiority of the ADSC system is 
indicated in comparison with the BSC and ABSC systems. This chapter is organized as 
follows. Section 3.2 states the sequential developments of backstepping-based control 
systems including a BSC, an ABSC and an ADSC system for the maglev system in detail. 
The effectiveness of the proposed control methodologies is verified in Section 3.3 by 
numerical simulations and experimental results under the possible occurrence of 
uncertainties, and the advantages of the ultimate ADSC design are indicated in comparison 
 19
model can be represented realistically as  
 0( ) ( )M+ M c d∆ = − + ∆ −x u d d f  (3.1) 
where M∆  and ∆d  denote the uncertainties introduced by system parameters and 
unmodelled dynamics; 0df  expresses the external disturbance vector in practical 
applications. By defining a lumped uncertainty vector as 0Mu d= ∆ + ∆ +l x d f , (3.1) can 
be rewritten as 
 M u c+ = −x l u d  (3.2) 
where the bound of the lumped uncertainty vector is assumed to be given by u ρ<l , in 
which ⋅  is the Euclidean norm and ρ  is a given positive constant. 
Reformulate (3.2) as 
 -1 -1 -1M M Mu c= − − +x d l u  (3.3) 
By viewing x  as a virtual control input (i.e., 1 x≡ α  is chosen as the control input for 
the e -subsystem) and considering a first Lyapunov function candidate -11 1 2e e/
TV = H  
with a diagonal positive-definite matrix 1H , whose derivative is 
1 1
1 1 1 1( )H H
T T
dV = = −- -e e e x  α , then there exists a stabilizing controller 1 1K= − +e xdα  
such that -11 1 1 0e e
TV = − ≤H K , in which 1K  is a diagonal positive-definite matrix. Since 
the derivative of 1V  is a negative-definite function, it can imply that the error state vector 
0=e  is asymptotically stable. In order to design an actual control input for ensuring the 
stability of the maglev system in (3.2), define a virtual error vector 1s = −e x α  and its 
derivative can be represented as 
 -1 -1 -11 1M M Ms u c= − = − − + −e x d l u   α α  (3.4) 
Consider a second Lyapunov function candidate 12 1 2 2H
T
s sV V= + -e e /  with a diagonal 
 21
implementation, the compromise between robust control performance and chattering 
control force is usually trade off. Thus, a simple bound estimation embedded in the BSC 
system is organized to form an adaptive backstepping control (ABSC) system in this 
section. In the ABSC system, the adaptation law for the bound of the lumped uncertainty 
vector, ρˆ , is designed as  
 -1 -12 1ˆ H M
T
sρ η= e  (3.6) 
and the estimated error ρ  is defined as  
 ˆρ ρ ρ= −  (3.7) 
where η  is a positive constant. Replacing ρ  by ρˆ  in (3.5), the ABSC law can be 
represented as  
 1 1 -12 1 2 2 1ˆ sgn[( ) ]H M M MK MH H
T T
ABSC s sρ − −= − + − −u d e e eα  (3.8) 
Define a tertiary Lyapunov function candidate as 
 23 2 /(2 )ρ η= + V V  (3.9) 
The derivative of 3V  with respect to time can be expressed with the inequality 
T T≤a b a b
1
sgn( )T≤ ≤ =a b a a b a b  for 1, nR ×∈a b  as follows: 
 
-1 -1 -1 1
3 1 1 2 2 2 1
-1 1 -1 1
2 2 1
-1 -1 -1 1 -1 1
1 1 2 2 2 21 1
-1 -1 -1 1
1 1 2 2 2 1
-1 -1
1 1 2 2
( )
( )
0
T T T
s s s
T T
s u s
T T T T
s s s s u
T T T
s s s u
T T
s s
V ρ ρ
ρ
ρ
ρ
−
− −
− −
−
= − − − −
− −
≤ − − − +
= − − − −
≤ − − ≤
e e e e e
e l e
e e e e e e l
e e e e e l
e e e e
 

H K H K H M
H M H M
H K H K H M H M
H K H K H M
H K H K
 (3.10) 
Since 3 0V ≤ , 3 ( ( ), ( ), )sV t t ρe e   is a negative semi-definite function (i.e., 
3 ( ( ), ( ), )sV t t ρe e  3( (0), (0), )sV ρ≤ e e  ), which implies that e, se  and ρ  are bounded 
functions. Let function 1 11 1 2 2( ) H K H K
T T
s sp t = +- -e e e e 3 ( ( ), ( ), )sV t t ρ≤ − e e  , and integrate 
 23
1 2 3( , , )ε ε ε  are respective time constants for (3.13). Define a filter error vector 
1 1 1f= −y α α  and its derivative -11 1 1 1 1 1Tf= − = − −y y   α α α . Following that, a new virtual 
error vector is reformulated as 1f f−e = x α , and its derivative can be represented as  
 -1 -1 -11 1M M Mf f u c f= − = − − + −e x d l u   α α  (3.14) 
Thus, the derivative of the error state vector can be given as  
 1 1 1 1 1Kd f f d f d f= − = − = − = − + +e x x e + x e + y + x e e y    α α  (3.15) 
By observing (3.5) and (3.8), the chattering phenomenon is unavoidable as long as a sign 
function is existed in the control law in despite of the utilization of a fixed value or an 
adaptive tuning algorithm for the lumped uncertainty bound. In order to deal with this 
problem, a robust observer is further designed in this section to estimate the lumped 
uncertainty vector, ul , and its adaptation law is assumed to take the following form: 
 -1 -13 4 4 3 4ˆ ˆ2H M H ΓH K H
T T T T
u f u= − − −l e l e  (3.16) 
where Γ , 3H , 4H  and 3K  are diagonal positive-definite matrices. By incorporating 
the robust observer into a DSC system, the adaptive dynamic surface control (ADSC) law 
can be represented as  
 -11 2 3 5ˆ M MK MH HADSC u f f= + + − −u d l α e e  (3.17) 
where 5H  is a diagonal positive-definite matrix. Define a new Lyapunov function 
candidate as 
 -1 -1 -13 4 5 1 1/ 2 / 2 / 2 /(2 )H H H
T T T T
f f u uV γ= + + +e e l l e e y y   (3.18) 
where ˆu u u= −l l l  is the observed error vector, and γ  is a positive constant. Given any 
positive number pb , for all initial conditions satisfying 
-1 -1 -1
3 4 5 1 1(1/ ) 2H H H
T T T T
f f u u pbγ+ + + ≤e e l l e e y y  , there exists 3H , 4H , 5H  and γ  such 
 25
Equation (3.21) means that ( )V t  eventually is bounded by 2mk τ . Because the values of 
-1 -1
4 4 )
T T
u ul l H (H , ΓTu ul l  and ,maxyb  could be restricted reasonably within predetermined 
levels, the quantity 2mk τ  can be made sufficiently small by appropriately increasing the 
values of τ  and 4H . Thus, all signals of the closed-loop system, i.e., e , fe , ul , and 
1y , are uniformly ultimately bounded. As a result, the error state vector e  will be 
attracted into a small stable region near origin by the appropriate selection of control gains. 
The effectiveness of the proposed control systems is verified by the following numerical 
simulations and experimental results. 
 
3.3 Numerical simulations and experimental results  
Numerical simulations of backstepping-based control systems as shown in Fig. 3.1 are 
implemented via the MATLAB software and the corresponding sampling time is 6ms. 
Moreover, a second-order transfer function of the following form with rise time 0.04s is 
chosen as the reference model, which is used to specify the reference trajectories for the 
position and angle of the moving platform, for step commands: 
 
2
2 22
n
n ns s
ω
ζω ω+ +  (3.22) 
where s is the Laplace operator; ζ  and nω  are the damping ratio (set at one for critical 
damping, 1ζ = ) and undamped natural frequency ( 45nω = ). In addition, 
mean-square-error (MSE) measures of the position and angle responses are defined as 
 2
1
1( ) ( )
T
i i
r
MSE x e r
T =
= ∑  (3.23) 
where ix  and ie  indicate the elements of the system state vector [ ]
T
Oz θ φ=x  and 
the corresponding error state vector, e; T is total sampling instants. According to (3.23), the 
 27
external disturbance. The choice of γ  is related to eliminate the effect caused by the 
explosion of terms, and the design of 3H , 4H  and τ  is a compromise between the 
superiority of control performance and the magnitude of control effort. The selection of 
3K  is aimed to eliminate the steady-state error. By the way, the time-constant matrix 1T  
in (3.13) can be calculated according to the predetermined values of τ  and γ . In the 
first-year project, the control objective is to make the central levitation height of the 
moving platform follow the reference trajectory (i.e., a step command is set at 1mmOdz =  
initially, and is changed from 1mm to 3mm at 2s and from 3mm to 2mm at 3s), and keep 
the corresponding rolling and pitching angles horizontal (i.e., 0d dθ φ= = ) under the 
possible occurrence of uncertainties. All the simulation illustrations of backstepping-based 
control systems are depicted in Figs. 3.2−3.7. The sub-figures (a)−(c) are the tracking 
responses of central levitation height, rolling and pitching angles; the sub-figure (d) is the 
related attitude control force, zF ; the sub-figures (e)−(h) are the corresponding control 
currents for electromagnets A to D.  
The simulated results of the BSC system in Section 3.2.1 at cases 1 and 2 are depicted 
in Figs. 3.2 and 3.3, respectively. In Figs. 3.2(a) and 3.3(a), the central levitation heights 
follow the reference trajectories well before 3s, but the performance becomes poor because 
of the reference central height decreasing from 3mm to 2mm and the external disturbance 
occurring at 3s. Similarly, the degenerate rolling and pitching angles in Figs. 3.2(b)−(c) 
and 3.3(b)−(c) caused by the inappropriate selection of ρ  are also occurred after 3s. 
Though a larger bound of the lumped uncertainty vector may solve the problem of 
degenerate responses, it will result in more serious chattering and excessive control 
currents than the ones in Figs. 3.2(e)−(h) and 3.3(e)−(h). Moreover, the effects of 
explosion terms caused by the repeated differentiations of the virtual inputs in BSC can be 
 29
m
m de
g
de
g N
82.27N 104.63N
Central Levitation
Height, Oz
NMSE(   )
=8.9276°
θ
NMSE(   )
=8.9366°
φ
NMSE(    )
=7.6396mm
249.38N
Oz
dφ
Reference Pitching 
Angle, 
Pitching Angle,φ
Reference Rolling 
Angle, dθ
Rolling Angle, θ
Reference 
Central
Height, Odz
Time (sec)
Time (sec) Time (sec)
Time (sec)
(a) (b)
(c) (d)
Attitude Control 
Force,   zF
m
m de
g
de
g N
 
A A
A A
Time (sec) Time (sec)
Time (sec) Time (sec)
(e) (f)
(g) (h)
Control Current,   Ai Control Current,   Bi
Control Current,   Ci Control Current,   Di
A A
A A
 
Fig. 3.3  Numerical simulations of BSC system at case 2. (a) Tracking response of central 
levitation height. (b) Rolling angle response. (c) Pitching angle response. (d) Attitude 
control force. (e) Control current for electromagnet A. (f) Control current for 
electromagnet B. (g) Control current for electromagnet C. (h) Control current for 
electromagnet D. 
 31
A A
A A
Time (sec) Time (sec)
Time (sec) Time (sec)
(e) (f)
(g) (h)
Control Current,   Ai Control Current,   Bi
Control Current,   Ci Control Current,   Di
m
m de
g
de
g N
89.72N
NMSE(   )
=19.3708°
θ
NMSE(   )
=20.0141°
φ
NMSE(    )
=0.6350mm
Oz
dφ
Reference Pitching 
Angle, 
Pitching Angle,φ
Rolling Angle, θ
dθ
Central Levitation
Height, Oz
Reference 
Central
Height, Odz
78.81N
250.97N
Time (sec)
Time (sec) Time (sec)
Time (sec)
(a) (b)
(c) (d)
Attitude Control 
Force,   zF
Reference Rolling
Angle, 
A A
A A
m
m de
g
de
g N
A A
A A
A A
A A
m
m de
g
de
g N
m
m de
g
de
g N
 
Fig. 3.5  Numerical simulations of ABSC system at case 2. (a) Tracking response of 
central levitation height. (b) Rolling angle response. (c) Pitching angle response. (d) 
Attitude control force. (e) Control current for electromagnet A. (f) Control current for 
electromagnet B. (g) Control current for electromagnet C. (h) Control current for 
electromagnet D. 
 33
A A
A A
Time (sec) Time (sec)
Time (sec) Time (sec)
(e) (f)
(g) (h)
Control Current,   Ai Control Current,   Bi
Control Current,   Ci Control Current,   Di
A A
A A
A A
A A
 
Fig. 3.6 (Cont.)  Numerical simulations of ADSC system at case 1. (e) Control current for 
electromagnet A. (f) Control current for electromagnet B. (g) Control current for 
electromagnet C. (h) Control current for electromagnet D. 
For examining the superiority of the proposed ADSC system, the simulated results of 
the ADSC system are depicted in Figs. 3.6 and 3.7 for comparison. Once the additional 
weight is not loaded on the mass center of the platform, not only the levitation height, but 
also the rolling and pitching angles will be affected at the same time. As can be seen from 
Figs. 3.6(a)−(c) and 3.7(a)−(c), the system states follow individual reference commands 
well, and the robust control characteristics under the occurrence of varied reference 
trajectories, parameter variations and external disturbance can be clearly observed. 
Moreover, the chattering phenomena in the BSC and ABSC systems are disappeared as 
shown in Figs. 3.6(d)−(h) and 3.7(d)−(h) since the ADSC system possesses the ability of 
the online observation of the lumped uncertainty vector. Note that, there are shaking 
control efforts at the later response because of the external disturbance with sine or cosine 
shape occurring at 3s. By observing Figs. 3.6(d) and 3.7(d), the spikes in the attitude 
 35
additional weight of 1kg is loaded at 2s and is unloaded at 6s. In Fig. 3.8, the additional 
weight is loaded at the mass center of the moving platform, Oc . Owing to the absence of 
major damping or restricting force on the moving platform, the overshoot to the command 
step occurs. Fortunately, the central levitation height has been in the steady state about 0.5s. 
Even if unpredictable change of weight occurred, the tracking error of the central levitation 
height converges quickly and the moving platform still can be kept balance. 
A A
A A
Time (sec) Time (sec)
Time (sec) Time (sec)
(e) (f)
(g) (h)
Control Current,   Ai Control Current,   Bi
Control Current,   Ci Control Current,   Di
A A
A A
 
Fig. 3.7 (Cont.)  Numerical simulations of ADSC system at case 2.  (e) Control current 
for electromagnet A. (f) Control current for electromagnet B. (g) Control current for 
electromagnet C. (h) Control current for electromagnet D. 
In Fig. 3.9, the additional weight is loaded at the mass center of the sub-platform C, Cc . 
When the loading or unloading conditions occur, the central levitation height, rolling and 
pitching angles are affected simultaneously. Due to the robust characteristic of the 
proposed ADSC system, the system states return to the corresponding reference trajectories 
promptly. Because the nonlinear relationship between the current and displacement may no 
allow large travel ranges, huge control currents produced by explosion terms and their 
chattering phenomena will cause the BSC and ABSC system unworkable in practical 
 37
m
m
de
g
de
g
N
N
-m
N
-m
334.3N
Central Levitation Height, Oz
Reference Central Height, Odz
Loading Unloading Loading Unloading
Loading Unloading
Loading Unloading
Rolling Angle, θ
Loading Unloading
Loading Unloading
Time (sec) Time (sec)
(a) (d)
Time (sec) Time (sec)
(b) (e)
Time (sec) Time (sec)
(c) (f)
Attitude Control Force,   zF
Attitude Control Torque,Tθ
Attitude Control Torque,   TφPitching Angle,φ
m
m
de
g
de
g
N
N
-m
N
-m
 
Fig. 3.9  Experimental results of ADSC system at 1mmOdz =  and 0d dθ φ= =  under 
the conditions of loading (2s) and unloading (6s) an additional 1kg weight on Cc . (a) 
Tracking response of central levitation height. (b) Rolling angle response. (c) Pitching 
angle response. (d) Attitude control force, ZF . (e) Attitude control torque, Tθ . (f) Attitude 
control torque, Tφ . 
 
3.4 Conclusions 
The first-year project has successfully investigated three backstepping-based control 
schemes including BSC, ABSC and ADSC for the levitation control of a hybrid maglev 
rail system. The performance comparisons of the BSC, ABSC and ADSC systems are 
summarized in Table 3.1. Note that, the robustness of individual control schemes in this 
table is relative comparison so that the property can be clearly understood by readers. 
According to the NMSE measures, the proposed ADSC system has over 94.18% and 
 39
Chapter 4 
Adaptive Fuzzy-Neural-Network Control Using 
Sliding-Mode Method 
 
4.1 Overview 
A hybrid magnetic-levitation (maglev) rail system including levitation and propulsion 
control is a subject of considerable scientific interest because of highly nonlinear and 
unstable behaviors. In the second-year project, the dynamic model of a hybrid maglev rail 
system including levitated electromagnets and a propulsive linear induction motor (LIM) 
based on the concepts of mechanical geometry and motion dynamics is developed firstly. 
Then, a model-based sliding-mode control (SMC) strategy is introduced. In order to 
alleviate chattering phenomena caused by the inappropriate selection of uncertainty bound, 
a simple bound estimation algorithm is embedded in the SMC strategy to form an adaptive 
sliding-mode control (ASMC) scheme. However, this estimation algorithm is always a 
positive value so that tracking errors introduced by any uncertainty will cause the 
estimated bound increase even to infinity with time. Therefore, it further designs an 
adaptive fuzzy-neural-network control (AFNNC) scheme by imitating the SMC strategy 
for the hybrid maglev rail system. In the model-free AFNNC, on-line learning algorithms 
are designed to cope with the problem of chattering phenomena caused by the sign action 
in SMC design, and to ensure the stability of the controlled system without the requirement 
of auxiliary compensated controllers despite the existence of uncertainties. The outputs of 
the AFNNC scheme can be directly supplied to the electromagnets and LIM without 
complicated control transformations for relaxing strict constrains in conventional 
 41
 , , 0( ) ( ) ( )M + M B B GR R R R R R R s R R R R d∆ + + ∆ = − + ∆ −x x u d d f   (4.1) 
where MR∆  and R∆d  denote the uncertainties introduced by system parameters and 
unmodelled dynamics; , 0R df  expresses the external disturbance vector in practical 
applications. By defining a lumped uncertainty vector as 
, , 0M BR u R R R R R R d= ∆ + ∆ + ∆ +l x x d f  , (4.1) can be rewritten as 
 , ,M B GR R R R R u R s R R+ + = −x x l u d   (4.2) 
where the bound of the lumped uncertainty vector is assumed to be given by ,R u Rρ<l , in 
which ⋅  is the Euclidean norm and Rρ  is a given positive constant. 
By viewing ,
v
R cu  as a virtual control effort vector (i.e., , ,G
v
R c R s R R= −u u d ) and 
reformulating (4.2) as 
 -1 -1 -1, ,M B M M
v
R R R R R R u R R c= − − +x x l u   (4.3) 
In the conventional SMC design, a sliding surface vector is chosen as follows: 
 Ll R R= +s e e  (4.4) 
where 1 2 3 4 5diag( , , , , )λ λ λ λ λ=L , in which 1λ , 2λ , 3λ , 4λ  and 5λ  are all positive 
constants. Take the derivative of the sliding surface vector with respect to time and use 
(4.3), then 
 -1 -1 -1, , ,M B M M L
v
l R R R R R u R R c R d R= − − + − +s x l u x e     (4.5) 
In the second-year project, the SMC law can be designed as  
 , , , ,/ 2 sgn( )B M M L M K
v
R c SMC R R R R d R R l R l R R s lρ= + − − − −u x x e s s s    (4.6) 
where a control gain Rρ  is concerned with the upper bound of uncertainties, sgn[ ]⋅  is a 
sign function, and ,K R s  is a diagonal positive-definite matrix. According to Lyapunov 
theorem, the stability of the SMC strategy can be guaranteed with ,R u Rρ<l . However, 
 43
uncertainty vector, ˆRρ , is designed as  
 , 1ˆ K
T T
R R l R sρ η= s  (4.7) 
and the estimated error Rρ  is defined as  
 ˆR R Rρ ρ ρ= −  (4.8) 
where Rη  is a positive constant. Replacing Rρ  by ˆRρ  in (4.6), the ASMC law can be 
represented as  
 , , , ,ˆ/ 2 sgn( )B M M L M K
v
R c ASMC R R R R d R R l R l R R s lρ= + − − − −u x x e s s s    (4.9) 
According to Lyapunov theorem and Barbalat’s lemma, it can be shown that the vector ls  
goes to zero as time tends to infinite.  
Unfortunately, the adaptation law for the bound of the lumped uncertainty vector shown 
in (4.7) is always positive and tracking errors introduced by any uncertainty will cause the 
ˆRρ  growth. It implies that the ASMC law (4.9) will result in large chattering with time 
gradually. In other words, the electromagnets and the LIM will eventually be saturated and 
the controlled hybrid maglev rail system may be unstable. Besides, it is worth to mention 
that the control currents to electromagnets belong to nonnegative inputs. According to the 
relation of , ,G
v
R c R s R R= −u u d , the realistic control current vectors derived from the SMC 
and ASMC laws as shown in (4.6) and (4.9) have to be transferred by 
 -1, , , ,( )G
v
R SMC R s R c SMC R= +u u d  (4.10a) 
 -1, , , ,( )G
v
R ASMC R s R c ASMC R= +u u d  (4.10b) 
To ensure the stability of the controlled system despite the existence of uncertainties, 
alleviate chattering phenomena in control efforts, and avoid redundant transformation steps, 
an adaptive fuzzy-neural-network control (AFNNC) scheme without auxiliary controller 
design is further investigated in the following section. 
 45
 
2
2
( )
( ) exp[ ]
( )
i
i
j
l ij
i l j
i
s m
s
c
µ −= −  (4.11) 
where exp( )⋅ is the exponential function; jim  and ( 1, , ; 1, , )iji pc i n j N= =" " , 
respectively, are the mean and standard deviation of the Gaussian function in the jth term 
of the ith input linguistic variable 
il
s  to the node of this layer. In order to represent the 
general case including different clusters with respect to the network inputs, the symbol 
ip
N  is utilized to denote the individual number of membership functions. For ease of 
notation, define parameter vectors m and c collecting all mean and standard deviation of 
Gaussian membership functions as 1 2 11 1 11 1 2 2[ ]
pp p n rNN N NT
n nm m m m m m R
×= ∈m " " " "  and 
1 2 11 1 1
1 1 2 2[ ]
pp p n rNN N NT
n nc c c c c c R
×= ∈c " " " " , where 
1 i
n
r pi
N N==∑  denotes the total 
number of membership functions. 
3) The output of each node in this layer is determined by fuzzy AND operation. Each node 
in the rule layer is denoted by ∏ , which multiplies the input signals and outputs the result 
of the product. The product operation is utilized to determine the firing strength. It can be 
referred as the fuzzy inference mechanism. The output of this layer is given as 
 
1
( )
i
n
k j
k ji i l
i
l w sµ
=
=∏  (4.12) 
where ( 1, , )k yl k N= "  represents the kth output of the rule layer and all values can be 
collected by a parameter vector 1 2[ ]y
T
Nl l l=l " ; kjiw , the weights between the 
membership layer and the rule layer, are assumed to be unity; yN  is the total number of 
rules. 
4) Layer four is the output layer. The output node together with links connected it act as a 
defuzzification procedure. Each node ( 1, , )o fy o N= "  computes the output as the 
summation of all input signals with the following type: 
 47
information and auxiliary compensated control. Moreover, the network parameters tuning 
laws are derived in the sense of projection algorithm and Lyapunov stability theorem to 
ensure the network convergence as well as stable control performance. According to the 
powerful approximation ability, there exists an optimal FNN control * ,R FNNu  to learn the 
SMC law, ,R SMCu , such that 
 *, , ( , , , )
* * *WR SMC R FNN l R= +u u s m c ε  (4.16) 
where Rε  is a minimum reconstructed error vector; 
*W , *m  and *c  are the optimal 
parameters of W , m  and c  in the FNN.  
Design the control current vector of the AFNNC scheme as 
 , ˆˆ ˆ ˆ( , , , )WR R FNN l=u u s m c  (4.17) 
where Wˆ , mˆ  and cˆ  are the estimates of *W , *m  and *c , as provided by tuning 
algorithm to be introduced later. Subtracting (4.17) from (4.16), an approximation error 
Ru  is defined as 
 *, , ,ˆR R SMC R R FNN R R FNN= − = + −u u u u u ε  (4.18) 
In the second-year project, the linearization technique is employed to transform the active 
functions into partially linear form so that the expansion of Ru  in Taylor series to obtain 
 
1 1
2 2
*1
ˆ 1 1 1
1
*2
ˆ 2 2 2 *
2 ˆ
*
ˆ
ˆ| ( )
ˆ| ( )
ˆ| ( )
ˆ| ( )
T
T
Tf
N N f f ff f
f
T
w
T
w
R
R l R
N T
N N wN
N
y o
y o
y
o
=
=
=
=
∂⎡ ⎤− +⎢ ⎥∂⎢ ⎥∂⎢ ⎥− +⎢ ⎥ ∂∂= + − + +⎢ ⎥ ∂⎢ ⎥⎢ ⎥∂⎢ ⎥− +⎢ ⎥∂⎣ ⎦
w w
w w
l l
w w
w w
w
w w uwu l l o ε
l
w w
w

#
 
 1 2 *ˆ1 2 ˆ| ( )f f
TNT T T R
w w w N w l R=
∂⎡ ⎤= + + − + +⎣ ⎦ ∂ l l
uy w y w y w o l l o ε
l
  "   
 Y Uw t l w l R= + + + +w l o o ε  (4.19) 
 49
AFNNC scheme can be assured. 
1 , ,( )K G Y
T T T
l R s R s wa− s  
if ˆ( )t wb<w   
or ˆ( t wb=w  and  , , ˆ 0)K G YT Tl R s R s w t ≤s w  
(4.22a)
ˆ t
⎧⎪⎪= ⎨⎪⎪⎩
w  
1 , ,
1 , , 2
( )
ˆ ˆ
[ ( )]
ˆ
K G Y
K G Y
T T T
l R s R s w
T
T T Tt t
l R s R s w
t
a
a
−
−
s
w ws
w
 if ˆ( t wb=w  and , , ˆ 0)K G YT Tl R s R s w t >s w  (4.22b)
2 , ,( )K G U
T T T
l R s R s l ma− s l  
if ˆ( )mb<m   
or ˆ( mb=m  and  , , ˆ 0)K G UT Tl R s R s l m ≤s l m  
(4.23a)
⎪⎪⎩
⎪⎪⎨
⎧
=mˆ  
2 , ,
2 , , 2
( )
ˆ ˆ
[ ( )]
ˆ
K G U
K G U
T T T
l R s R s l m
T
T T T
l R s R s l m
a
a
−
−
s l
mms l
m
if ˆ( mb=m  and , , ˆ 0)K G UT Tl R s R s l m >s l m  (4.23b)
3 , ,( )K G U
T T T
l R s R s l ca− s l  
if ˆ( )cb<c   
or ˆ( cb=c  and  , , ˆ 0)K G UT Tl R s R s l c ≤s l c  
(4.24a)
ˆ
⎧⎪⎪= ⎨⎪⎪⎩
c  
3 , ,
3 , , 2
( )
ˆ ˆ
[ ( )]
ˆ
K G U
K G U
T T T
l R s R s l c
T
T T T
l R s R s l c
a
a
−
−
s l
ccs l
c
 if ˆ( cb=c  and , , ˆ 0)K G UT Tl R s R s l c >s l c  (4.24b)
where 1a , 2a  and 3a  are positive learning rates, and wb , mb  and cb  are given 
positive parameter bounds.  
Proof: Define a Lyapunov function candidate as 
 , 1 2 3( , , , ) / 2 /(2 ) /(2 ) /(2 )K M
T T T T T
R l t l R s R l t tV a a a= + + +s w m c s s w w m m c c          (4.25) 
By subtracting (4.2) from (4.6) and using (4.21) one can obtain 
 
-1
, , ,
-1
, , ,
,
[ sgn( ) / 2 ]
[ sgn( ) / 2
]
M K M G
M K M G Y G U
G U
l R R u R R s l R l l R s R
R R R R s l R l l R s w t R s l m
R s l c
ρ
ρ
= − − − − −
= − − − − − −
−
s l s s s u
ψ s s s w l m
l c
 
  

 (4.26) 
where the uncertain term , , 'GR R u R s= +ψ l y  is assumed to be bounded by ,R R by<ψ . 
 51
 , , 2 ˆ[( (1/ ) ] 0K G U
T T T
m l R s R s l mV a= − + =s l m m   (4.31) 
By (4.23b) 
 
2
, , , ,
, ,
2
, ,
ˆ ˆ ˆ[ ( / )
]
ˆ ˆ ˆ( / )
K G U K G U
K G U
K G U
T T T T T
m l R s R s l m l R s R s l m
T T
l R s R s l m
T T T
l R s R s l m
V = − −
−
=
s l s l mm m
s l m
s l m m m m


 (4.32) 
If the conditions of ˆ mb=m  and , , ˆ 0K G UT Tl R s R s l m >s l m  are satisfied, the results of 
*ˆ ˆ ˆ( )T T= −m m m m m 2 22* *ˆ ˆ0.5( ) 0= − − − <m m m m  and 0mV <  can be obtained 
according to * mb<m  and (4.32). From the analyses in (4.31) and (4.32), one can 
conclude that 0mV ≤ . 
If the adaptation law for the standard deviations of Gaussian functions in the FNN is 
designed as (4.24), then cV  can be rewritten as follows: 
By (4.24a) 
 , , 3 ˆ[ (1/ ) ] 0K G U
T T T
c l R s R s l cV a= − + =s l c c   (4.33) 
By (4.24b) 
 
2
, , , , , ,
2
, ,
ˆ ˆ ˆ[ ( / ) ]
ˆ ˆ ˆ( / )
K G U K G U K G U
K G U
T T T T T T T
c l R s R s l c l R s R s l c l R s R s l c
T T T
l R s R s l c
V = − − −
=
s l s l cc c s l c
s l c c c c


 (4.34) 
If the conditions of ˆ cb=c  and , , ˆ 0K G UT Tl R s R s l c >s l c  are satisfied, the results of 
*ˆ ˆ ˆ( )T T= −c c c c c 2 22* *ˆ ˆ0.5( ) 0= − − − <c c c c  and 0cV <  can be obtained according to 
*
cb<c  and (4.34). From the analyses in (4.33) and (4.34), one can conclude that 0cV ≤ . 
Consequently, with the design of ,R R byρ = , (4.28) can be represented as 
 
, , ,
, , ,1 1
, , ,1
[ sgn( )]
( ) 0
K K K
K K K
K K K
T T T T
R w m c l R s l l R s R R R s l
T T T T T T
l R s l l R s R R l R s
T T T T T T
l R s l l R s R R l R s l
V V V V ρ
ρ
ρ
= + + − − +
≤ − + −
= − − − ≤ − ≤
s s s ψ s
s s s ψ s
s s s ψ s s

 (4.35) 
 53
trajectories for the levitation height of the hybrid maglev rail system, for step commands. 
In the second-year project, ζ  and nω  are set at 1 and 9, respectively. In addition, the 
mean-square-error (MSE) measure of position and angle responses is defined as (4.25), and 
ix  and ie  indicate the elements of the system state vector [ ]
T
R O mz xθ φ κ=x  
and the corresponding error state vector, Re . According to MSE measures, the 
normalized-mean-square-error (NMSE) values of the levitation-height response, angle 
response, and platform-position response using per-unit values with 610− -mm, 
610− -degree, and 410− -cm bases are used for examining the control performance in the 
second-year project. 
To investigate the robustness of the proposed control systems, the following two cases 
with parameter variations and time-varying external force disturbance are considered:  
Case 1) A step command for the central levitation height is set at 1mmodz =  initially, 
and a sinusoidal command for the platform position is chosen as 
10sin[0.2 ( 1)]cmmdx tπ= −  after 1s. An additional weight of 0.5kg (about 10% 
full load) is loaded on Cc  at 2s and is unloaded at 5s.  
Case 2) A step command for the central levitation height is set at 0.5mmodz =  initially, 
and is changed from 0.5mm to 2mm at 4s and from 2mm to 1mm at 6s. A 
sinusoidal command for the platform position is chosen as 10sin(0.2 )cmmdx tπ= . 
An additional weight of 1kg (about 20% full load) is loaded on Oc  at 2s and is 
unloaded at 5s.  
Other identical conditions in these two cases are represented as 1) Initial system state: 
(0) 0.2mmOz = , (0) 0θ = D , (0) 0φ = D , (0) 0cmmx = ; 2) External force disturbance 
occurring at 7s: , 0 [2 sin(2 ) sin(2 ) cos(2 ) [cos(2 ) / ] sin( ) 0R d lim lt t t t M l= −f π π π π π φ  
 55
and 4.4, respectively. In Figs. 4.3(a) and 4.4(a), the central levitation heights follow the 
reference trajectories well before 2s, but the performance becomes poor because of the 
additional weight loading and unloading as 2s and 5s and external force disturbance 
occurring at 7s. Similarly, the degenerate rolling and pitching angles in Figs. 4.3(b)−(c) 
and 4.4(b)−(c) caused by the inappropriate selection of Rρ  are also occurred after 2s. In 
addition, the tracking responses of the platform position in Figs. 4.3(d) and 4.4(d) also 
possess degenerate performance under the occurrence of uncertainties. Figures 4.5 and 4.6 
show the simulated results of the SMC strategy with a large uncertainty bound ( 50Rρ = ) 
at cases 1 and 2, respectively. Though a larger bound of the lumped uncertainty vector can 
solve the problem of degenerate responses, it will result in more serious chattering and 
excessive control currents. Besides, the undesired chattering control efforts will wear the 
mechanical structure and might excite unstable system dynamics. 
NMSE(    )
=0.6200mm
Oz
Central Levitation 
Height, Oz
NMSE(    )
=78.2960°
φ
Pitching Angle,φ
dφReference Pitching Angle, 
Attitude Control 
Force,   zF
de
g
m
m
N
Reference Central 
Height, Odz
Time (sec)
(a)
Time (sec)
(c)
Time (sec)
(e)
Time (sec)
(b)
Time (sec)
(d)
Time (sec)
(f)
NMSE(    )
=83.5588 °
θ
de
g
cm
A
NMSE(    )
=2.0878cm
mx
LIM Control Current,   limi
Platform 
Position, mx
Reference Platform Position, mdx
Rolling Angle, θ
Reference Rolling Angle, dθ
de
g
m
m
N
de
g
cm
A
de
g
m
m
N
de
g
cm
A
 
Fig. 4.3  Numerical simulations of SMC strategy with small uncertainty bound ( 15Rρ = ) 
at case 1. (a) Tracking response of central levitation height. (b) Rolling angle response. (c) 
Pitching angle response. (d) Platform position response. (e) Attitude control force. (f) LIM 
control current. 
 57
de
g
m
m
N
Pitching Angle, φ
NMSE(    )
=5.9441 °
φ
NMSE(    )
=0.6255mm
Oz
Central Levitation 
Height, Oz
Reference
Central 
Height, Odz
de
g
cm
A
NMSE(    )
=0.1816cm
mx
Reference Platform 
Position, mdx
Platform 
Position, mx
NMSE(    )
=4.8970 °
θ
LIM Control Current,   limiAttitude Control Force,   zF
Time (sec)
(a)
Time (sec)
(c)
Time (sec)
(e)
Time (sec)
(b)
Time (sec)
(d)
Time (sec)
(f)
Rolling Angle, θ
Reference Rolling Angle, dθ
Reference Pitching Angle, dφ
de
g
m
m
N
de
g
cm
A
 
Fig. 4.6  Numerical simulations of SMC strategy with large uncertainty bound ( 50Rρ = ) 
at case 2. (a) Tracking response of central levitation height. (b) Rolling angle response. (c) 
Pitching angle response. (d) Platform position response. (e) Attitude control force. (f) LIM 
control current. 
Figures 4.7 and 4.8 illustrate the simulated results of the ASMC strategy at cases 1 and 
2, respectively. As can be seen from Figs. 4.7(a)−(d) and 4.8(a)−(d), acceptable tracking 
responses and robust characteristics can be obtained according to the online adjustment of 
the bound of the lumped uncertainty vector. However, the estimated bound is gradually 
increased with time so that the attitude control forces and LIM control currents tend to 
diverge. These situations can be verified by observing Figs. 4.7(e)−(f) and 4.8(e)−(f). 
Though the chattering amplitude at beginning is smaller than the one in the SMC strategy, 
the magnitude and chattering phenomena of the control efforts raise gradually with the 
increasing of the estimated bound of the lumped uncertainty vector. As a result, the growth 
estimated bound not only will cause more serious chattering in control efforts but also may 
make the controlled system unstable.  
 59
For comparison, the proposed AFNNC scheme is also applied to control the hybrid 
maglev rail system. To show the effectiveness of the AFNNC scheme, the FNN has 4 
( 4n = ), 12 ( 4 3 12
ir p
N n N= × = × = ), 81 and 5 neurons at the input, membership, rule and 
output layer, respectively. It can be regarded that the associated fuzzy sets with Gaussian 
function for each input signal are divided into N (negative), Z (zero) and P (positive), and 
the number of rules with complete rule connection is 3 3 3 3 81yN = × × × = . The active 
functions in the output nodes ( 1, , 4o = " ) are chosen as sigmoid functions (i.e., 
1, ,4
1
1
1( )
[1 exp( )]
y
y
N
o
o o k k No
k o
k k
k
y f w l
w l
σ= =
=
= =
+ −
∑ ∑"
 with a positive constant 225σ = ) because 
of nonnegative control current inputs for four electromagnets, and the active function in the 
output node ( 5o = ) is chosen as a bypass function (i.e., 
5
1 1
( )
y yN N
o o
o o k k k ko
k k
y f w l w l= = =
= =∑ ∑ ) for 
the LIM control current. According (4.19), Yw  can be implemented as 
5 405
1 1 2 2 3 3 4 4diag[ (1 ) (1 ) (1 ) (1 ) ]l l l l lw y y y y y y y y Rσ σ σ σ ×= − − − − ∈Y , in which 
1 2[l l l= "  81]Tl and 1, ,81k kl = "  can be computed by (4.12). Moreover, some heuristics 
can be used to roughly initialize the parameters of the AFNNC scheme for practical 
applications; e.g., the means and the standard deviations of the Gaussian functions can be 
determined according to the maximum variation of elements in the sliding surface vector, 
ls . By considering the same simulated cases as the SMC and ASMC strategies, the 
numerical simulations of the proposed AFNNC scheme at cases 1 and 2 are depicted in 
Figs. 4.9 and 4.10, respectively. Not loading the additional weights at the center of mass of 
the platform affects not only the levitation height and the propulsion force of the LIM, but 
also simultaneously affects the rolling and the pitching angles.  
 61
As can be seen from Figs. 4.9(a)−(d) and 4.10(a)−(d), the error state vector converges 
quickly, and the robust control characteristics under the occurrence of varied reference 
trajectories, parameter variations and external force disturbance can be clearly observed. 
Because all parameters in the AFNNC are roughly initialized, the tracking errors are 
gradually reduced through on-line training process whether system uncertainties exist or 
not. By observing Figs. 4.9(e)−(f) and 4.10(e)−(f), the degenerate performance or 
undesirable chattering phenomena in the SMC strategy and the gradually increasing 
chattering phenomena in the ASMC scheme can be all removed. Note that, there are 
shaking control efforts at the later response because of the external disturbance with sine or 
cosine shape occurring at 6s. Consequently, the proposed AFNNC scheme indeed yields 
superior performance than the SMC and ASMC strategies. 
 
4.5 Conclusions 
The second-year project has successfully investigated the sliding-mode control (SMC), 
adaptive sliding-mode control (ASMC) and adaptive fuzzy-neural-network control 
(AFNNC) schemes for the hybrid maglev rail system. The performance comparisons of the 
SMC, ASMC and AFNNC systems are summarized in Table 4.1. Note that, the robustness of 
individual control schemes in this table is relative comparison so that the property can be clearly 
understood by readers. According to the NMSE measures, the proposed AFNNC scheme has 
over 99.34% and 98.59% height-tracking improvements, 99.66% and 97.87% 
angle-stabilizing improvements, and 80.3% and 68.44% position-tracking improvements 
than the SMC and ASMC strategies, respectively. The AFNNC scheme has the salient 
merits of model-free control design, favorable robust characteristic, and control effort 
without chattering in comparison with the SMC and ASMC strategies. Thus, the proposed 
 63
References 
[1] NAKASHIMA, H.: ‘The superconducting magnet for the maglev transport system’, 
IEEE Trans. Magn., 1994, 30, (4), pp. 1572–1578 
[2] POWELL, J.R., and DANBY, G.T.: ‘Maglev vehicles-raising transportation advances 
of the ground’, IEEE Trans. Pot., 1996, 15, (4), pp. 7–12 
[3] CHEN, M.Y., WANG, M.J., and FU, L.C.: ‘Modeling and controller design of a 
maglev guiding system for application in precision positioning’, IEEE Trans. Ind. 
Electron., 2003, 50, (3), pp. 493–506 
[4] KALOUST, J., HAM, C., SIEHLING, J., JONGEKRYG, E., and HAN, Q.: 
‘Nonlinear robust control design for levitation and propulsion of a maglev system’, 
IEE Proc. Contr. Theory Appl., 2004, 151, (4), pp. 460−464 
[5] HOLMER, P.: ‘Faster than a speeding bullet train’, IEEE Trans. Spectrum, 2003, 40, 
(8), pp. 30−34  
[6] LIN, C.T., and JOU, C. P.: ‘GA-based fuzzy reinforcement learning for control of a 
magnetic bearing system’, IEEE Trans. Syst., Man, and Cybern., Part B, 2000, 30, 
(2), pp. 276−289 
[7] KIM, O.S., LEE, S.H., and HAN, D.C.: ‘Positioning performance and straightness 
error compensation of the magnetic levitation stage supported by the linear magnetic 
bearing’, IEEE Trans. Ind. Electron., 2003, 50, (2), pp. 374–378 
[8] NAGAYA, K., and ISHIKAWA, M.: ‘A noncontact permanent magnet levitation 
table with electromagnetic control and its vibration isolation method using direct 
disturbance cancellation combining optimal regulators’, IEEE Trans. Magn., 1995, 
31, (1), pp. 885−896 
[9] TANG, D.M., GAVIN, H.P., and DOWELL, E.H.: ‘Study of airfoil gust response 
 65
[19] ZHOU, J., WEN, C., and ZHANG, Y.: ‘Adaptive backstepping control of a class of 
uncertain nonlinear systems with unknown backlash-like hysteresis’, IEEE Trans. 
Auto. Contr., 2004, 49, (10), pp. 1751–1757 
[20] ZHANG, Y., FIDAN, B., and IOANNUO, P.A.: ‘Backstepping control of linear 
time-varying systems with known and unknown parameters’, IEEE Trans. Auto. 
Contr., 2003, 48, (11), pp. 1908–1925 
[21] SHIEH, H.J., LIN, F.J., HUANG, P.K., and TENG, L.T.: ‘Adaptive tracking control 
solely using displacement feedback for a piezo-positioning mechanism’, IEE Proc. 
Contr. Theory Appl., 2004, 151, (5), pp. 653–660 
[22] YANG, Z.J., MIYAZAKI, K., Kanae, S., and WADA, K.: ‘Physical parameter 
identification of a magnetic levitation system under a robust nonlinear controller’, 
Proc. 15th IFAC World Congr., Barcelona, Spain, 2002, pp. 848–853 
[23] SWAROOP, D., HEDRICK, J.K., YIP, P.P., and GERDES, J.C.: ‘Dynamic surface 
control for a class of nonlinear systems’, IEEE Trans. Automat. Contr., 2000, 45, 
(10), pp. 1893–1899  
[24] YANG, Z.J., MIYAZAKI, K., KANAE, S., and WADA, K.: ‘Robust position control 
of a magnetic levitation system via dynamic surface control technique’, IEEE Trans. 
Ind. Electron., 2004, 51, (1), pp. 26–34 
[25] WANG, D., and HUANG, J.: ‘Neural network-based adaptive dynamic surface 
control for a class of uncertain nonlinear systems in strict-feedback form’, IEEE 
Trans. Neural Networks, 2005, 16, (1), pp. 195–202 
[26] TAKAHASHI, I., and IDE, Y.: ‘Decoupling control of thrust and attractive force of a 
LIM using a space vector control inverter’, IEEE Trans. Ind. Applicat., 1993, 29, (1), 
pp. 161−167 
[27] BOLDEA, I., and NASAR, S.A.: ‘Linear electric actuators and generators’, IEEE 
 67
[36] LIN, C.T., and GEORGE LEE C.S.: ‘Neural fuzzy systems’, (Prentice-Hall, 
New-Jersey, 1996) 
[37] WANG, L.X.: ‘A course in fuzzy systems and control’, (Prentice-Hall, New-Jersey, 
1997) 
[38] OMIDVAR, O., and ELLIOTT, D.L.: ‘Neural systems for 
control’, (Academic Press, 1997) 
[39] LIN, F.J., FUNG, R.F., and WAI, R.J.: ‘Comparison of sliding mode and fuzzy neural 
network control for motor-toggle servomechanism’, IEEE/ASME Trans. 
Mechatronics, 1998, 3, (4), pp. 302–318  
[40] LIN, F.J., HWANG, W.J., and WAI, R.J.: ‘A supervisory fuzzy neural network control 
system for tracking periodic inputs’, IEEE Trans. Fuzzy Syst., 1999, 7, (1), pp. 41–52 
[41] WAI, R.J., LIN, F.J., DUAN, R.Y., HSIEH, K.Y., and LEE, J.D.: ‘Robust fuzzy 
neural network control for linear ceramic motor drive via backstepping design 
technique’, IEEE Trans. Fuzzy Syst., 2002, 10, (1), pp. 102–112 
 
 69
adopted in this invention. When the hybrid electromagnets attract the 
upper plate of the rail, the motion platform will be levitated. The 
levitating height is acquired by gap sensors. Furthermore, the 
perpendicularly firm cubes are equipped for holding the vertical angle 
between the two conductor plates of the motion platform to reduce 
measure errors. When the transversal displacement is varied during the 
linear motion, the transversal auxiliary wheels are employed to guide 
the motion platform on the march. 
可利用之產業 
及 
可開發之產品 
本混合型磁浮運動機構是一具有相當完整性之機電整合裝置，所
涉及之技術領域也相當廣泛，其中包含有電機控制、電力電子、機
械結構、微處理機技術；本發明所牽涉技術領域很廣，但其主要在
於規劃出一完善之機電整合裝置，此裝置以數位訊號處理器為其中
央控制系統之核心，並藉由已訂定完整之驅動控制介面作為相互聯
繫的溝通橋樑，使其成為全數位化之混合型磁浮運動機構。 
技術特點 
本技術主要之優點，水平位移採用線型感應馬達，可避免線型永
磁馬達異物侵入狀況發生；平台位移訊號由磁力尺量測可避免平台
懸浮且尚未進行水平移動時易有預力產生及其設置問題；線型感應
馬達動子線圈置於運動平台上方內側，可降低成本及容易維修；垂
直方向採取混合式電磁鐵懸浮，消除傳統運輸系統之摩擦消耗，並
且能解決利用超導體低速時無法產生感應斥力的現象，同時亦能減
少電能消耗以提升整體效率；除此之外，本裝置還具備以下四點優
點： 
1.本裝置具有混合式電磁鐵控制系統經由數位訊號處理器可調整
所需要之氣隙，將四只混合式電磁鐵進行解耦控制，並且在載重
發生變化及水平位移時能維持所需之懸浮高度。 
2.本裝置設有直角固定塊，可固定運動平台底座良導體版之間垂直
度避免因不當外力使運動平台底座變形。 
3.本裝置設有輔助輪，其中縱向輔助輪可在混合式電磁鐵不作用或
者故障時仍可使線型感應馬達做水平運動，而橫向輔助輪則是避
免在對垂直及水平方向進行控制時產生之不預期橫向位移使運
動平台底座產生橫向移動造成磨損。 
4.本裝置具有保護功能，在線型感應馬達兩端裝有防撞檔板及極限
開關，防止失控時運輸車體底座毀損。 
推廣及運用的價值 
目前大眾軌道運輸系統皆以感應機產生推進力並作減速剎車回
收電能。為達到高效率的營運目的，確保行車的安全舒適，必須藉
由電力電子元件，進行整流後，再配合行控中心傳來的速度碼及偵
測到之列車重量，決定變壓變頻換流器之電壓與頻率，驅動感應機
以維持列車時刻表。於列車進站時，為提升剎車效能，除傳統機械
摩擦剎車之外，又必須將感應機當作感應發電機將定子頻率低於轉
速，以產生剎車力並將列車動能回收，以台北捷運之列車而言，其
動力負載高達四千匹馬力以上，而班次高達二分鐘一班，整體路網
之電能消耗非常龐大，需要藉由電力電子元件，進行剎車再生發電
以大幅降低電能消耗。現今運輸系統之運用除傳統鋼軌鋼輪之軌道
運輸系統外，發展磁浮系統更能節省能源消耗及維修成本，由於沒
行政院國家科學委員會補助國內專家學者出席國際學術會議報告 
99 年 07 月 26 日  
報告人  
姓名  
 
魏榮宗  
 
服務機構
及職稱  
元智大學  
專任教授  
時間  
 
會議地點  
自 99 年 07 月 18 日至 99
年 07 月 23 日  
西班牙 -巴塞隆納  
本會核定
補助文號
已於 NSC 97-2221-E-155-065-MY2
計畫中核定出席國際會議費用
70,000元  
會議  
名稱  
(中文 ) 2010年世界計算智能會議  
(英文 ) 2010 IEEE World Congress on Computational Intelligence (WCCI 2010) 
發表  
論文  
題目  
(中文 )設計動態派翠模糊類神經網路於自走車強健路徑追蹤控制  
(英文 )Design of Dynamic Petri Recurrent-Fuzzy-Neural- Network for Robust Path 
Tracking Control of Mobile Robot 
一、參加會議經過  
本次會議搭乘國泰航空班機 CX403於七月十五日上午九點二十分由桃園國
際機場起飛，經香港及法蘭克福搭乘德國航空班機轉機，於七月十六日下午十
一點四十五分整抵達馬德里，並於七月十八日下午抵達位於 CCIB 之研討會會
場辦理註冊報到。本次會議分為 IJCNN、FUZZ-IEEE 及 IEEE-CEC 三大主題會
議進行，計有一千七百一十五篇論文發表，估計約有三千餘人參加。七月十九
日上午參加論文發表會，主題是 IJCNN-Poster Session I，共有九篇論文發表；七
月十九日下午參加論文發表會，主題是 IJCNN-Poster Session II，共有十一篇論文
發表；七月二十日上午參加論文發表會，主題是 IJCNN-Robotics II，共有六篇論
文 發 表 ； 七 月 二 十 日 下 午 參 加 論 文 發 表 會 ， 主 題 是 IJCNN-Self-Organizing 
Networks，共有五篇論文發表；七月二十一日上午參加論文發表會，主題是
IJCNN-Machine Learning for Renewable Energy Applications，共有六篇論文發表；七月
二十一日下午參加論文發表會，主題是 IJCNN-Poster Session VI，共有十二篇論文
發表；七月二十二日上午參加論文發表會，主題是 IJCNN-Approximate Dynamic 
Programming with Feedback Control Applications，共有六篇論文發表；本人論文被安
排於七月二十二日下午三點開始之論文發表會中發表，共有十六篇論文發表，
會中問題討論熱烈，每篇平均有三個問題以上，參與的聽眾約有百餘人。搭乘
德國航空班機 LH4453 於七月二十三日下午十二點四十分由巴塞隆納機場起
飛，經法蘭克福及香港轉機，於七月二十四日台灣時間下午二點十五分抵達桃
園國際機場，結束此次會議行程。  
Design of Dynamic Petri Recurrent-Fuzzy-Neural- Network for Robust 
Path Tracking Control of Mobile Robot 
 
Rong-Jong Wai, Senior Member, IEEE, and Chia-Ming Liu 
 
Abstract⎯In this study, a robust path tracking control scheme 
is constructed for a nonholonomic mobile robot via a dynamic 
Petri recurrent-fuzzy-neural-network (DPRFNN). In the 
DPRFNN, the concept of a Petri net (PN) and the recurrent 
frame of internal feedback loops are incorporated into a 
traditional fuzzy neural network (FNN) to alleviate the 
computation burden of parameter learning and to enhance 
the dynamic mapping of network ability. This five-layer 
DPRFNN is utilized for the major role in the proposed control 
scheme, and the corresponding adaptation laws of network 
parameters are established in the sense of projection 
algorithm and Lyapunov stability theorem to ensure the 
network convergence as well as stable control performance 
without the requirement of detailed system information and 
the compensation of auxiliary controllers. In addition, the 
effectiveness of the proposed robust DPRFNN control scheme 
is verified by numerical simulations of a differential-driving 
mobile robot under different moving paths and the 
occurrence of uncertainties, and its superiority is indicated in 
comparison with a stabilizing control system. 
 
I.  INTRODUCTION 
In recent years, wheel-based mobile robots have 
attracted considerable attentions in various industrial and 
service applications [1]–[6]. These applications require 
mobile robots to have the ability to track specified path 
stably. From the motion control point of view, one 
fundamental important issue is the development of 
favorable trajectory tracking algorithm in varied moving 
paths. In general, wheeled mobile robots constitute a class 
of nonholonomic mechanical systems characterized by 
kinematic constraints. Nonholonomic behavior in robotic 
systems is particularly interesting because this mechanism 
can be completely controlled with reduced number of 
actuators. A unicycle-like mobile robot under perfect 
rolling constraints is a nonholonomic system, and the most 
adopted mobility schemes can be analyzed in terms of the 
unicycle-like kinematics. Thus, the major topic of this 
study is to develop an intelligent path tracking control for a 
nonholonomic unicycle-like mobile robot. 
Fuzzy control (FC) using linguistic information 
possesses several advantages such as robustness, 
model-free, universal approximation theorem and 
rule-based algorithm [7]. Thus, FC methods have attracted 
more attention to deal with the complex control problem of 
mobile robots [8]–[12]. Although these fuzzy logic 
techniques allow the constructing of a control system based 
in a group of rules in a similar way as the human thought 
does, how to build appropriate rules and reduce control 
complexity is the major challenging problem.  
Recently, much research has been done on the 
applications of feedforward neural network (NN) for 
identification and control of dynamic systems [13]–[15]. It 
is well known that a feedforward NN is capable of 
approximating any continuous functions closely. However, 
the feedforward NN is a static mapping. Although much 
research has used the feedforward NN with tapped delays 
to deal with dynamical problems, the feedforward NN 
requires a large number of neurons to represent dynamical 
responses in the time domain. Moreover, the weight 
updates of the feedforward NN do not utilize the internal 
information of the NN and the function approximation is 
sensitive to the training data. On the other hand, recurrent 
NN (RNN) [16]–[18] has superior dynamic capability than 
the feedforward NN. Since the recurrent neurons have 
internal feedback loops, the dynamic response of a system 
can be captured without using external feedback through 
delays. Thus, the RNN is a dynamic mapping and 
demonstrates good control performance in the presence of 
system uncertainties. However, the possible limitation of 
the RNN, which is the same as the NN, is that the function 
of the network is difficult to interpret.  
Nowadays, the concept of incorporating fuzzy logic 
into a NN has been grown into a popular research topic 
[19]–[21]. In contrast to the pure NN or fuzzy system, the 
integrated fuzzy-neural-network (FNN) system possesses 
the merits of both fuzzy systems [7] (e.g., humanlike 
IF-THEN rules thinking and ease of incorporating expert 
knowledge) and neural networks [13] (e.g., learning and 
optimization abilities, and connectionist structures). By this 
way, one can bring the low-level learning and 
computational power of neural networks into fuzzy 
systems and also high-level, humanlike IF-THEN rule 
thinking and reasoning of fuzzy systems into neural 
networks. Moreover, the recurrent FNN (RFNN) [22], [23], 
which naturally involves dynamic elements in the form of 
feedback connections used as internal memories, has the 
same dynamic and robust advantages as the RNN. In 
addition, the function of the network can be interpreted 
using fuzzy inference mechanism. 
For the last decades, Petri net (PN) has been developed 
into a powerful tool for modeling, analysis, control, 
optimization, and implementation of various engineering 
systems [24]−[26]. David and Alla [24] proposed the basic 
concept relative to PN and derived various models for 
This work was supported in part by the National Science Council of
Taiwan, R.O.C. through grant numbers NSC 97-2221-E-155-065-MY2. 
R. J. Wai is with the Department of Electrical Engineering and Fuel
Cell Center, Yuan Ze University, Chung Li, Taiwan, R.O.C. (e-mail:
rjwai@saturn.yzu.edu.tw). 
C. M. Liu is with the Department of Electrical Engineering, Yuan Ze
University, Chung Li, Taiwan, R.O.C. (e-mail:kim882068@yahoo.com.
tw) 
WCCI 2010 IEEE World Congress on Computational Intelligence 
July, 18-23, 2010 - CCIB, Barcelona, Spain IJCNN
978-1-4244-8126-2/10/$26.00 c©2010 IEEE 1539
trajectories. 
 
III.  ROBUST DPRFNN CONTROL SYSTEM 
In order to handle the trajectory tracking of a 
nonholonomic mobile robot under different moving paths 
effectively, the basic concept of a Petri net (PN) and the 
recurrent frame of internal feedback loops are incorporated 
into a traditional fuzzy neural network (FNN) to organize a 
dynamic Petri recurrent FNN (DPRFNN), and the entire 
robust DPRFNN control system is depicted in Fig. 2. 
1e
du
dv
u
v
θ
rv
lv
ˆˆ , ,
, ,
W
m s
l
l l lα
ˆ ˆ ˆ ˆ, , ,ow m s   α
wη mη sη αη G
dtd
dtd
∑ 2e
1e
2e
∫
1a2a
∫
∑
1f
2f
∑
∑
 
Fig. 2.  Block diagram of robust DPRFNN control system. 
 
A.  Stabilizing Control 
In this section, a stabilizing control is firstly designed 
so that the system states can track desired reference 
commands. To achieve this control objective, define a 
tracking error vector (
1 2[ ]
Te ee = ) and its corresponding 
filtered error vector (
1 2[ ]
Tf ff = ) as 
 1
2
( ) cos ( )sin
( )
( )sin ( ) cos
d d
d d
u u v ve
t
e u u v v
θ θ
θ θ
− + −⎡ ⎤⎡ ⎤
= = ⎢ ⎥⎢ ⎥
− − + −⎣ ⎦ ⎣ ⎦
e  (4) 
 
0
( )
t
dτ τ= + ∫Af e e  (5) 
where du  and dv  are the desired position of the mobile 
robot in the global coordinate frame; 1
2
0
0
a
=
a
⎡ ⎤⎢ ⎥⎣ ⎦
A  is a 
positive-definite constant matrix, in which 
1a  and 2a  
are positive constants. By differentiating (4) with respect to 
time and using (3), one can obtain 
21
2 1
cos sin cos sin
( )
sin cos sin cos
d d
d d
u v u v ee
t
e u v u v e
θ θ θ θ θ
θ θ θ θ θ
⎡ ⎤+ − − +⎡ ⎤
= = ⎢ ⎥⎢ ⎥
− + + − −⎢ ⎥⎣ ⎦ ⎣ ⎦
e
        
t t= − + − − +H = B Hq u d  (6) 
where 
 2
1
cos sin
sin cos
d d
d d
u v e
u v e b
θ θ θ
θ θ θ θ
⎡ ⎤+ +
= ⎢ ⎥
− + − +⎢ ⎥⎣ ⎦
H
 
  
 
Consider a Lyapunov function candidate as 
 1
1 /2
T
tV
−
= GBf f  (7) 
where the constant matrix G  is selected so that 1t
−GB  is 
a diagonal positive-definite matrix. Take the derivative of 
(7) with respect to time, one can obtain 
 
1
1
1( )
T
t
T
t t t
V −
−
=
− − + +
GB
GB B H A
f f
= f u d e

 (8) 
Then, there exists a stabilizing control law 
 1 1 1 1 1sgn( )sc t t t t tκ
− − − − −
= + +B H B GB B A Bu f e + f  (9) 
such that 
1 1 1 1
1
1 1
1 1 1 1
1 1 1
11 1
{ [ sgn( )
] }
sgn( )
T
t t t t t
t t t
T T T
t t t t t
T T T
t t t t
V κ
κ
κ
− − − −
− −
− − − −
− − −
− +
+ − + +
− − −
≤ − − +
GB B B H B GB
B A B H A
GB GB GB GB
GB GB GB
 = f f
e + f d e
= f f f f f d
f f f f d
 (10) 
1 1 1
11
( ) 0T T Tt t t tκ
− − −
− − − ≤ − ≤GB GB GB= f d f f f f  
where sgn( )⋅  is a sign function. Since the derivative of 
1V  is a negative-definite function, it can imply that the 
tracking error vector 0=e  is asymptotically stable 
according to Lyapunov stability theorem [29]. However, 
the exact values of the external disturbance and unmodeled 
dynamics are difficult to obtain in advance for practical 
applications. Selection of the upper bound of uncertainties 
has a significant effect on the control performance. If the 
bound is selected too large, the sign function in (9) will 
result in serious chattering phenomena in the control efforts. 
The undesired chattering control efforts will wear the 
mechanical structure and might excite unstable system 
dynamics. On the other hand, if the bound is selected too 
small, the stability conditions may be not satisfied. It will 
cause the controlled system to be unstable. To ensure the 
stability of the controlled system despite the existence of 
uncertainties, a DPRFNN is investigated in the following 
section to mimic the stabilizing control law in (9) to ensure 
robust control performance. 
 
j
iμ
∑∑
∏
1x inx
j
iα
-1z -1z -1z -1z -1z -1z
∏∏ ∏∏
k
jiw
kφ
o
kw
j
it thd thd thd thd thd thd
 
Fig. 3.  Five-layer DPRFNN structure. 
 
B.  Dynamic Petri Recurrent-Fuzzy-Neural-Network 
A five-layer DPRFNN configuration, which comprises 
the input ( i  layer), membership ( j  layer), Petri ( p  
layer), rule ( k  layer) and output ( o  layer) layers, is 
depicted in Fig. 3. The recurrent feedback is embedded by 
adding feedback connections in the membership layer. The 
1541
membership functions into partially linear form so that the 
expansion of l  in Taylor series [7] to obtain 
 m s hα≡ + + +l l m l s l α o     (21) 
where * ˆ= −m m m ; * ˆ−s = s s ; * ˆ−α = α α ; 1ynh R ×∈o  
is a vector of higher-order terms; 1 2φ φ∂ ∂⎡= ⎢ ∂ ∂⎣ml m m "
 
ˆ|
y y r
T
n n nR
φ
×
=
∂ ⎤
∈⎥∂ ⎥⎦ m mm
; 1 2 ˆ|
y y r
T
n n nR
φφ φ ×
=
∂ ⎤∂ ∂⎡
= ∈⎥⎢ ∂ ∂ ∂⎣ ⎥⎦s s s
l
s s s
"  
and 1 2 ˆ|
y y r
T
n n nR
φφ φ ×
=
∂⎡ ⎤∂ ∂
= ∈⎢ ⎥∂ ∂ ∂⎢ ⎥⎣ ⎦
"α α αl α α α
. Rewrite (21), 
one can obtain 
 * ˆ m s hα= + + +l l + l m l s l α o    (22) 
To substitute (22) into (20), the approximation error 
scu  
can be reformulated as 
 
* *
*
ˆˆ
ˆ ˆ ˆ ˆ
sc
m s m
s h
α
α
= + −
= + + + +
+ + + +
W W
W W W W W
W W W
u l ε l
l l m l s l α l m
l s l α ε o

    
  
 (23) 
In (21), the linearization of the membership functions is 
helpful for representing the approximation error (23) being 
linear in the parameters and it is convenient for the stability 
analyses. 
Theorem 1: Consider the dynamic model of the mobile 
robot system by (3), if the robust DPRFNN control law is 
designed as (19) and the adaptation laws of the DPRFNN 
parameters are designed as (24)−(27), then stable control 
performance of the proposed robust DPRFNN control 
scheme can be assured. 
If ( ˆ o wb<w ) or ( ˆ o wb=w  and ˆˆ 0
T
o o ≤w l g f ) 
 ˆˆ T To w oη=w f g l  (24a) 
If ( ˆ o wb=w  and ˆˆ 0
T
o o >w l g f ) 
 2ˆ ˆˆ ˆ ˆ ˆ/T T T T To w o w o o o oη η= −w f g l f g l w w w  (24b) 
If ( ˆ mb<m ) or ( ˆ mb=m  and ˆ ˆ 0
T
m ≤GWf l m ) 
 ˆˆ ( )T Tm mη= GWm f l  (25a) 
If ( ˆ mb=m  and ˆ ˆ 0
T
m >GWf l m ) 
 
2
ˆˆ ( )
ˆ ˆ ˆ ˆ[ ( / )]
T T
m m
T T T
m m
η
η
=
−
GW
GW
m f l
f l mm m

 (25b) 
If ( ˆ sb<s ) or ( ˆ sb=s  and ˆ ˆ 0
T
s ≤GWf l s ) 
 ˆˆ ( )T Ts sη= GWs f l  (26a) 
If ( ˆ sb=s  and ˆ ˆ 0
T
s >GWf l s ) 
 2ˆ ˆˆ ˆˆ ˆ( ) [ ( / )]T T T T Ts s s sη η= −GW GWs f l f l ss s  (26b) 
If ( ˆ bα<α ) or ( ˆ bα=α  and ˆ ˆ 0T α ≤GWf l α ) 
 ˆˆ ( )T Tα αη= GWα f l  (27a) 
If ( ˆ bα=α  and ˆ ˆ 0T α >GWf l α ) 
 2ˆ ˆˆ ˆ ˆ ˆ( ) [ ( / )]T T T T Tα α α αη η= −GW GWα f l f l αα α  (27b) 
where the constant matrix G is reformulated as 
1 1
1
1 22 2
1
[ ]o
o
o
n
n
n
g g
g g
⎡ ⎤⎢ ⎥= ⎢ ⎥⎣ ⎦
G g g g
"
 …"
2 onR ×∈ ; ˆ ow  is the 
estimate of the optimal parameter vector *ow ; wη , mη , 
sη  and αη  are positive learning rates; wb , mb , sb  and 
bα  are given positive parameter bounds; ⋅  denotes the 
Euclidean norm. 
According to Lyapunov theorem and Barbalat's lemma 
[29], it can imply that the filtered error vector ( )tf  will 
converge to zero as t → ∞ . According to (4) and (5), the 
tracking error vector ( )te  also will converge to zero as 
t → ∞ . As a result, the stable control behavior can be 
ensured without the requirement of detailed system 
information and the compensation of auxiliary control 
design. 
 
IV.  NUMERICAL SIMULATIONS 
In this study, a differential-driving mobile robot is used 
for an example to verify the effectiveness of the proposed 
control scheme. The detailed parameters of this mobile 
robot are listed as follows: 
 0.0925mr = , 0.167 mb = , max 0.4m/ sv =  (28) 
In order to exhibit the superiority of the proposed robust 
DPRFNN control system, the stabilizing control in (9) is 
also examined. In the DPRFNN, the network inputs are the 
tracking error vector and its derivative (i.e., 4in = ; 
1 1x e= , 2 1x e=  , 3 2x e=  and 4 2x e=  ); the network 
outputs are the left-wheel and right-wheel velocities (i.e., 
2on = ; 1 ly v=  and 2 ry v= ). To get better responses in 
the early part of illustrations, the initial values of network 
parameters are pre-trained before the control process 
begins. This pre-trained procedure is to persistently execute 
the robust DPRFNN control algorithm until the 
corresponding control performance achieves an acceptable 
level. After that, ultimate network parameters are used for 
initial values in the next control cycle. The effect due to 
different operational circumstances can be retrieved by 
on-line adaptation laws in (24)−(27). 
In the simulations, two types of reference path 
trajectories are chosen to test the adaptability of the 
proposed control schemes. In the first path, a 8-shaped 
reference trajectory [12] is considered to show the ability 
in tracking of smooth path. In the second path, a square 
reference trajectory [15] is considered to illustrate the fast 
adaptability in tracking of straight and curved lines. 
Moreover, the initial position and angle of the mobile robot 
are all set at zero, and the control parameters in the control 
systems are given as 
0.01 0
0 0.01
= ⎡ ⎤⎢ ⎥⎣ ⎦A
, 1 1=
1 1
⎡ ⎤⎢ ⎥
−⎣ ⎦G
, 0.01κ = , 0.2wη = ,  
0.01mη = , 0.01sη = , 0.01αη = , 5wb = , 5mb = , 
1543
the sign function in (9). As can be seen from Figs. 5 and 7, 
there are no chattering phenomena in the right-wheel and 
left-wheel velocities as shown in Figs. 5(e)−(f) and 7(e)−(f), 
and the robust control performance with respect to the 
occurrence of external disturbance can be clearly observed. 
The simulated NMSE value of the path tracking error for 
the robust DPRFNN control scheme due to the 8-shaped 
path tracking is 3.72 × 10-5; the one due to the 
square-shaped path tracking is 4.03×10-5. By comparing 
Figs. 5 and 7 with Figs. 4 and 6, the proposed robust 
DPRFNN control system indeed yields superior control 
performance without chattering control efforts to the 
stabilizing control system. 
Time (sec)
(a)
Time (sec)
(b)
Time (sec)
(c)
Time (sec)
(d)
Time (sec)
(e)
Time (sec)
(f)
Time (sec)
(h)
m m
m m
m
/s
m
/s
V
 (m
)
U (m)
(g)
U-axis Tracking Error V-axis Tracking Error
1
23
4
Reference Path 
Actual Path 
Path Tracking Error
m
NMSE=4.39×10-4
U-axis Reference 
Trajectory
Actual U-axis                                                
Trajectory
Start
End
V-axis Reference 
Trajectory
Actual V-axis 
Trajectory
Right-wheel Linear Velocity Left-wheel Linear Velocity
m m
m m
m
/s
m
/s
V
 (m
)
m
 
Fig. 6.  Numerical simulations of stabilizing control system due to 
square-shaped path tracking. (a) U-axis tracking response. (b) V-axis 
tracking response. (c) Linear displacement response. (d) Rotation angle 
response. (e) Right-wheel velocity. (f) Left-wheel velocity. (g) Path 
tracking response. (h) Tracking errors. 
The corresponding NMSE measures of the stabilizing 
control scheme and the proposed robust DPRFNN control 
system are summarized in Table I. The simulated NMSE 
values of the path tracking error for the stabilizing control 
scheme due to the 8-shaped path tracking is 1.48×10-4; the 
ones due to the square-shaped path tracking is 4.39×10-4. 
The simulated NMSE values of the path tracking error for 
the robust DPRFNN control scheme due to the 8-shaped 
path tracking is 3.72 × 10-5; the ones due to the 
square-shaped path tracking is 4.03×10-5. As can be seen 
from Table I, the proposed robust DPRFNN control system 
indeed yields superior control performance without 
chattering control efforts than the stabilizing control 
system. 
Time (sec)
(a)
Time (sec)
(b)
Time (sec)
(c)
Time (sec)
(d)
Time (sec)
(e)
Time (sec)
(f)
Time (sec)
(h)
m m
m m
m
/s
m
/s
V
 (m
)
U (m)
(g)
U-axis Tracking Error V-axis Tracking Error
Path Tracking Error
m
NMSE=4. 03×10-5
Right-wheel Linear Velocity Left-wheel Linear Velocity
U-axis Reference 
Trajectory
Actual U-axis                                                
Trajectory
V-axis Reference 
Trajectory
Actual V-axis 
Trajectory
1
23
4
Reference Path 
Start
End
m m
m m
m
/s
m
/s
V
 (m
)
m
 
Fig. 7.  Numerical simulations of robust DPRFNN control system due to 
square-shaped path tracking. (a) U-axis tracking response. (b) V-axis 
tracking response. (c) Linear displacement response. (d) Rotation angle 
response. (e) Right-wheel velocity. (f) Left-wheel velocity. (g) Path 
tracking response. (h) Tracking errors. 
TABLE I 
PERFORMANCE MEASURES OF STABILIZING CONTROL AND ROBUST 
DPRFNN CONTROL 
        Condition 
Control Systems 
8-Shaped 
Path Tracking 
Square-Shaped 
Path Tracking 
Stabilizing Control 1.48 410−×  4.39 410−×  
Robust DPRFNN 
Control 3.72
510−×  4.03 510−×  
 
V.  CONCLUSIONS 
This study has successfully incorporated the concept of 
a Petri net (PN) and the recurrent frame of internal 
feedback loops into a conventional fuzzy neural network 
(FNN) to form a dynamic Petri recurrent FNN (DPRFNN), 
and designed a robust DPRFNN control system to the path 
tracking of a differential-driving mobile robot. Numerical 
simulations were provided to exhibit the superiority of the 
1545
無研發成果推廣資料 
