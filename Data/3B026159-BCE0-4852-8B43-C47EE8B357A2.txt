 1
摘要 
    近年來，由於軟體規模的日益龐大複雜，使得軟體系統的開發與管理愈加的困難，所耗費的時間
與金錢相當龐大。由OMG (Object Management Group)在2003年所訂定之模型導向架構 (Model-Driven 
Architecture, MDA) [1]，藉由建立軟體的模型，提高軟體的抽象化程度，使得軟體系統架構較易為發展
團隊所瞭解與管理，同時也讓開發人員易於維護系統，並可加快開發時程，降低人力成本。然而好的
開發技術與好的軟體品質並沒有一個正比的關係，如何能夠兼顧技術與品質，便成為開發團隊的一個
重要議題。目前已有不少領域，藉由統計流程管制 (Statistical Process Control, SPC)來改進所使用的流
程，並使用管制圖 (Control Chart)來進行產品之品質管控。 
    使用模型導向架構開發方法 (Model-Driven Architecture, MDA)產生模型的順序CIM (Computation 
Independent Model)PIM (Platform Independent Model)PSM (Platform Specific Model)程式碼。本研
究提出以管制圖 (Control Chart)用於PIM模型(主要針對UML類別圖)修改歷程之品質管控，分析每一次
修改之品質趨勢，管控整個修改流程品質，並對影響品質之因素加以分析。更進一步，透過CASE工具，
將PIM模型轉換成PSM模型，藉由比對模型導向架構 (Model-Driven Architecture, MDA)兩階段模型 
(PIM and PSM)的品質趨勢差異，分析並探討造成該差異的原因，以進行模型驅動開發方法之持續改善。 
 
關鍵字：模型導向、模型驅動、管制圖、統計流程管制、類別圖、類別圖品質、可維護性、流程改善 
        Model-Driven Architecture、MDA、Control Chart、Statistical Process Control、Class Diagram、
Quality、SPC、Maintainability、Process Improvement 
 
前言 
近年來由於軟體規模日益龐大複雜，使得軟體系統的開發與管理愈加的困難。藉由模型驅動開發
方法來建立軟體的模型有下列特點[2]： 
1、縮短系統開發週期：因為程式碼會經由轉換工具產出，所以實作系統的時間會加快。 
2、系統開發時間降低：因為從PSM模型轉為所需程式碼時有自動轉換工具，可降低人力成本。 
3、模型可以重覆使用：PIM模型為高抽象化系統邏輯[3]，若將來有類似之系統需求可以直接套用，
或是加以修改原有之PIM，增加了重覆使用性（Reuse）。 
4、增加系統品質：PSM模型至下一階段所轉出的程式碼，部份的程式碼是由機器產出，所以可以
降低一小部份人為的缺失，提高系統品質。 
5、易轉換平台：PIM模型為高抽象化之邏輯模型[3]，可以直接映射到另一個特定平台PSM模型，
而後產出程式碼，降低轉換平台之難度。 
但僅使用模型作為提高抽象化程度以及軟體系統開發的依據，開發人員雖可藉由模型的轉換達成
快速開發，但卻無法在早期模型開發的過程中，瞭解該模型的品質趨勢，進而控制產出系統之品質。
因此在本研究中，我們透過使用管制圖 (Control Chart)對模型進行品質監控，使我們能在開發的過程中
瞭解並預期模型的品質趨勢，以及軟體系統發展流程上的瑕疵。 
然而管制圖 (Control Chart)並不適合直接用在軟體流程管理之上[4][5]，且現今的管制圖輔助工具
大多數都是以製造業生產製程輔助工具為主要應用，跟有關軟體業的衡量目標並不相同，因此本研究
藉由將模型之品質量化成數值，使之能進行管制圖 (Control Chart)分析。 
為了維持產品品質的穩定性，目前已有不少領域，如硬體製造或是服務提供的領域，藉由統計流
程管制 (Statistical Process Control, SPC)來改進所使用的流程，並使用管制圖 (Control Chart, 或稱為流
 3
 
圖 1  研究流程圖 
 
2、流程圖說明 
   在圖中主要分兩個方向來進行模型品質的分析，一為 PIM 模型的品質趨勢分析，另一方向則對 PSM
模型進行品質分析。以下針對流程圖中各部份做說明： 
 (1)擷取需求： 
本研究針對國民小學校園排課系統擷取需求，由受試者(任職國小：帶班-高年級經驗一年，行政
經驗-非教學組長四年，電腦科任一年)依據本身對國小排課的認知，提出系統需求。相關需求整
理如附錄A-1。 
 (2)設計 PIM： 
    根據功能性需求來設計與繪製 PIM 模型，必須描繪出所需的功能以滿足功能性需求，在此所描
繪的模型只需依照功能的考量且依照設計模式的架構來描繪，不需要將目標平台的相容性作考
量。在此一階段皆使用 UML 類別圖作為塑模語言，並使用 Borland Together 來繪製類別圖，繪
製之類別圖如附錄 B-1。 
(3)CASE 工具轉換： 
    使用 Borland Together 將 PIM 模型轉換成 PSM-JAVA 模型。 
   (4)量化 PIM： 
      本研究參考 Marcela Genero et al.[7]針對類別圖可維護性的研究。根據 Marcela Genero et al.研究，
類別圖內部結構影響可維護性部分，總共列出十一個並且加以量化，詳細內部結構與定義如表
1。接著 Marcela Genero et al.分析類別圖的可維護性等級而得到等級數據，然後將這十一個已量
化之內部結構與類別圖可維護性等級作斯皮爾曼等級相關係數分析，分析結果如表 2。由表 2
可得知並非每一個內部結構對可維護性的影響程度都一樣。故本研究針對每一個內部結構對可
維護性的影響設定權重，並利用所設定的權重來量化 PIM 之品質。權重設定方式如下所列： 
流程圖符號說明： 
流程符號 符號名稱 
 起止符號 
 處理符號 
 輸入/輸出符號
 
 5
別的聚合階層數量總和。 
NUMBER OF GENERALISATIONS 
HIERARCHIES (NGenH) 
一般化階層的數量。每個類別一般化階層的數量是指該類別
在一般化階層裡，從該類別算到根類別總共階層數，然後將
每個類別的一般化階層數量總和。 
MAXIMUM HAGG (MaxHAgg) 最大聚合階層的數量。每個類別都有聚合階層數量，數量最
多的就是最大聚合階層的數量。 
MAXIMUM DIT (MaxDIT) 最大繼承樹深度。每個類別都有繼承樹深度，深度最深的就
是最大繼承樹深度。 
 
表 2 類別圖內部結構與可維護性進行斯皮爾曼等級相關係數分析結果 
 NC MA NM NAssoc NAgg NDep NGen NAggH NGenH MaxHAgg MaxDIT
Understandability 0.912 
P=0 
0.892 
P=0 
0.859 
P=0 
0.775
P=0 
0.789
P=0
0.554
P=0
0.833
P=0
0.683
P=0 
0.857 
P=0 
0.718 
P=0 
0.677 
P=0 
Analysability 0.926 
P=0 
0.896 
P=0 
0.883 
P=0 
0.724
P=0 
0.812
P=0
0.529
P=0
0.848
P=0
0.693
P=0 
0.863 
P=0 
0.684 
P=0 
0.759 
P=0 
Modifiability 0.943 
P=0 
0.907 
P=0 
0.909 
P=0 
0.730
P=0 
0.788
P=0
0.525
P=0
0.881
P=0
0.676
P=0 
0.891 
P=0 
0.673 
P=0 
0.805 
P=0 
註：Marcela Genero et al.研究將類別圖可維護性分成三個子項目(可瞭解性、可分析性、可修改性) 
 
表 3 類別圖內部結構影響可維護性部分權重 
類別圖 
內部結構 NC NA NM NAssoc NAgg NDep NGen NAggH NGenH 
Max 
HAgg
Max
DIT
權重 1.73 1.68 1.65 1.39 1.49 1.00 1.59 1.28 1.62 1.29 1.39
 
表4 量化PIM計算範例 
類別圖 
內部結構 NC NA NM NAssoc NAgg NDep NGen NAggH NGenH
Max 
HAgg
Max
DIT
內部結構 
計算結果(1) 4 7 12 3 2 1 3 1 2 3 1 
權重(2) 1.73 1.68 1.65 1.39 1.49 1.00 1.59 1.28 1.62 1.29 1.39
(1)*(2) 6.92 11.76 19.8 4.17 2.98 1.00 4.77 1.28 3.24 3.87 1.39
PIM 品質量化數據 
Σ(1)*(2) 61.18 
結果與討論 
1、分析結果 
      由PIM模型修改歷程擷取十個PIM模型產出，並將此十個PIM模型進行量化而得到品質數值如
表5。接著透過 Borland Together CASE工具轉換，將此十個PIM模型轉換成PSM-JAVA模型，接著將
這十個PSM-JAVA模型進行量化而得到品質數值如表6。 
 
 
 7
 
      
             圖 4  PSM模型X管制圖                  圖 5  PSM模型MR管制圖 
 
2、實驗結果分析 
   (1)PIM模型與PSM模型管制圖為上升趨勢，代表模型可維護性屬性增加（資料量的增加），後續維
護將可提供更多的資料提供維護者理解模型，因此模型之可維護性隨著製作流程增加。 
   (2)隨著軟體模型製程雖然可維護性不斷增加，但凝聚力與耦合力卻有可能因此下降，從第九個模型
( PIM 與 PSM )得知，經過系統重構，曲線雖下滑，但提高了模型凝聚力與耦合力。 
   (3)探討表5與表6可發現模型經過轉換時，在PIM模型使用之相依性，經過CASE工具轉成PSM-JAVA
後，全部都消失了，經過探討此情形在PIM模型階段設計時就產生問題，導致轉換過程出現異常， 
     此原因為軟體系統分析者不熟悉系統分析設計所致。 
   (4)如果能在管制圖分析時，有更多的類別圖能提供品質相關數值，則管制圖分析結果才能更具有母
體代表性。 
   (5)在本 Case Study 中，PIM 模型的製作分析人員對於系統分析之經驗尚淺，因此需求分析上之錯誤
也較多，因此可以明顯的看出在 PIM 至 PSM 模型轉換中，其可維護性屬性之量化結果有較大
的差異，甚至出現類別相依性的關係在經過轉換後消失的現象。因此，藉由量化的分析及管制
圖的比對，可從中發現分析人員對於類別圖分析的品質差異。如能有在職系統分析師投入設計，
將使得本實驗樣本更具有母體代表性，所分析的資料，也更能符合業界實際分析數據。 
4、研究貢獻 
   本研究提出使用管制圖 (Control Chart)對 PIM 模型進行品質監控，使我們能在開發的過程中瞭解並 
   預期模型的品質趨勢，以及軟體系統發展流程上的瑕疵，並使系統分析師針對品質異常能及早作應 
   對，以節省系統開發時間與成本。 
5、未來研究方向 
   (1)未來可將本研究方法用於各種不同領域、不同複雜度之類別圖研究，然後將類別圖依不同領域與 
     複雜度作分類，並且制訂該類別類別圖制訂標準，可供系統分析師分析系統軟體時，有個標準
參考依據，使之能在早期便能得知所設計之系統類別圖品質，如果有品質不良情形能及早作修
正。 
   (2)將 PIM 其他類型模型，如活動圖 (Activity Diagram)、時序圖 (Sequence Diagram)等加以量化，
並透過管制圖 (Control Chart)分析，將所得資料作綜合性評估，如果可得知此軟體系統各面向
PIM 模型之品質綜合考量。 
   (3)可將此研究複製，將不同領域與不同複雜度之類別圖透過管制圖 (Control Chart)作分析研究，將
品質變異之原因蒐集起來成一資料庫，供系統分析師研究，可避免犯相同錯誤，而造成開發成
本的增加與金錢的浪費。 
   (4)PIM 模型修改歷程可分兩個同時進行，其一由生手(在校資訊相關學系學生)進行修改，另一由有
 9
附錄 A -1 
 
 
 
排課系統使用案例圖(Use Case Diagram) 
 
使用案例(UC)名稱 簡述 
1、輸入相關資料 使用者可以輸入排課相關資料： 
1、教師人數與教師姓名。 
2、科目名稱與科目數量。 
3、輸入各年級上課時段 
4、每位教師授課節數。 
5、每位教師教學科目優先順序。 
6、不上課時間（國定假日、畢業旅行等） 
2、設定規則 使用者可以設定排課規則： 
1、設定特定老師上課時間。 
2、設定特定科目兩節連著上。 
3、設定科目安排時段。（例如：國文與數學等盡量安排在早上，體育與
音樂等盡量安排在下午） 
4、教師一天最多節數設定 
3、自動排課 依照所設定的規則自動安排課程。 
4、調課 自動排課後，可再針對課程安排做小幅度調整。 
5、計算鐘點 計算特定教師學期上課總時數、節數。 
 11
附錄 A-3 
排課系統第二次修改需求使用案例圖(Use Case Diagram) 
使用案例(UC)名稱 簡述 
1、輸入相關資料 使用者可以輸入排課相關資料： 
1、教師人數與教師姓名。 
2、科目名稱與科目數量。 
3、輸入各年級上課時段。 
4、每位教師授課節數。 
5、每位教師教學科目優先順序。 
6、不上課時間（國定假日、畢業旅行等） 
7、科任教室資料 
8、科任教室時間安排輸入 
2、設定規則 使用者可以設定排課規則： 
1、設定特定老師上課時間。 
2、設定特定科目連著上，或者依天數分開。 
3、體育課特殊設定。(體育課有時上游泳課，需把原本分開的兩節體育
課連在一起上課，所以體育課安排後，上游泳課的時間能做調課) 
4、設定科目可依上午與下午比例安排時段。 
5、教師一天最多節數設定。 
3、排課衝突警示 依照所設定的規則如無法排課，會顯示衝突說明，說明衝突原因。 
4、資源班課表安排 1、學生到資源班上課，可指定該節課原來班級上導師的課或者科任課，
科任課可指定科目。 
2、資源班課程可套用設定規則功能。 
5、手動排課 針對更細部的規則或者特殊規則，可自己安排課程。 
6、自動排課 1、扣除手動排課課程，其餘課程依照所設定的規則自動安排課程。 
2、自動排課後，可對於某些不滿意之課表再自動排課。 
7、調課 自動排課後，可再針對課程安排做小幅度調整。 
8、計算鐘點 計算特定教師學期上課總時數、節數。 
 13
附錄 B-2 
 
PIM 模型-9 
 
 
PSM 模型-9 
無研發成果推廣資料 
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
無 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
