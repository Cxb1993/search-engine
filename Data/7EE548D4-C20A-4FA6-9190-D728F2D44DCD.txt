2 
 
行政院國家科學委員會補助專題研究計畫 ■ 成 果 報 告   
□期中進度報告 
 
條件式模糊群播協定之研究 
 
 
計畫類別：■ 個別型計畫  □ 整合型計畫 
計畫編號：NSC 96－2628－E－218－002－MY2 
執行期間：96年 08月 01日至 98年 07月 31日 
 
計畫主持人：李南逸 
共同主持人： 
計畫參與人員： 李國彰、李姿誼、姜宏仁 
 
 
成果報告類型(依經費核定清單規定繳交)：□精簡報告  ■完整報告 
 
本成果報告包括以下應繳交之附件： 
□赴國外出差或研習心得報告一份 
□赴大陸地區出差或研習心得報告一份 
■出席國際學術會議心得報告及發表之論文各一份 
□國際合作研究計畫國外研究報告書一份 
 
 
處理方式：除產學合作研究計畫、提升產業技術及人才培育研究計畫、
列管計畫及下列情形者外，得立即公開查詢 
          ■涉及專利或其他智慧財產權，■一年□二年後可公開查詢 
          
執行單位：南台科技大學資訊管理系暨研究所 
 
中   華   民   國 98年 07月 31日
4 
 
Abstract 
How to protect the privacy and security of transmitting data in the Internet is a very 
important issue. Cryptographic techniques are the tools to enhance the network transmission 
security. Oblivious transfer protocol is one of the tools in the contemporary cryptography. In the 
original oblivious transfer protocol, a sender holds one secret message and a receiver can get the 
secret message with 1/2 probability. Now, t out of n oblivious transfer protocol allows that the 
sender holds n secret messages and the receiver can choose and get t messages. The transmission 
efficiency is obviously improved. However, if the cryptographic parameters in the initial phase of 
the protocol can be repeatedly used, the efficiency can be excellently enhanced. Thus, the first 
year of this project will develop a reusable oblivious transfer protocol for enhancing the 
efficiency. 
Moreover, the newest construction of conditional oblivious transfer protocol is that a public 
predicate is used to evaluate the sender’s and receiver’s inputs. The result of the predicate will 
decide which message the receiver can get. Besides, the environment of the conditional oblivious 
cast protocol has become to include one sender and two receivers. The transmitted message is 
also decided by the result of the predicate. Until now, only one out of two conditional oblivious 
cast protocol is developed. The second year of this project is trying to design t out of n 
conditional oblivious cast protocol for extending the applied environments. 
 
Keywords: Conditional Oblivious Cast, Predicate, Oblivious Transfer, Reusable, Cryptographic 
technology 
  
6 
 
在2001 年Naor和Pinkas[26]兩位學者提出有效率的模糊傳送協定(efficient oblivious 
transfer protocol)，其中先提出二選一模糊傳送協定，然後再將其擴大應用，並提出了一個n
選一模糊傳送協定，如圖三所示，此一協定允許傳送者傳送n個訊息給接收者，而接收者只
獲得其中1個訊息，並沒有辦法得知其他訊息。 
 
圖三、n選一模糊傳送協定 
另外Tzeng[45]也在同年提出一有效率的模糊傳送架構，其中也提出了n選一模糊傳送架
構，在這些n選一的模糊傳送協定中，傳送者對於接收者所選取之資訊並不知情，而接收者
亦無法得知傳送者所傳送之其他資訊。Tzeng並利用此一架構，提出利用平行處理的方式達成n
選t模糊傳送，如圖四所示。隨後，在2002年，由Mu,Zhang,和Varadharajan[50]提出n選t之模
糊傳送協定，此協定允許傳送者傳送n個訊息，而接收者從n個訊息中獲得t個，同樣的在n
選t模糊傳送中，傳送者於協定中對於接收者所獲得的資訊一無所知，而接收者同樣無法得
知由傳送者所傳送之其他訊息。此協定主要是利用解多項式的方法達成n選t模糊傳送。在
2004年Kurosawa以及Duong [21]，提出了可重覆使用的n選一模糊傳送概念，如圖五所示，
模糊傳送協定基本上會分成初始階段以及傳輸階段，初始階段主要目的在產生模糊傳送協
定所需要的參數值，日後，傳送者與接收者可利用這些參數進行多次的模糊傳送，而不必
重新產生參數，可節省參數的產生、計算和交換的成本，進而使得模糊傳送協定更具效率。 
M1,M2…,Mn 
MA  
Sender 
A 
n選一 OT協定 
 
Receiver 
8 
 
 
圖五、Kurosawa及 Duong可重覆使用 n選一模糊傳送協定 
 
10 
 
圖六、Blake和 Kolesnikov所提出的強健型條件式模糊傳送協定 
 
或 
12 
 
 
圖八、Chu和 Tzeng提出之二選一條件式模糊群播協定 
二、 研究目的 
模糊傳送協定可以分成許多種類，除了安全性的考量，還得考慮協定的效率，才得以
應用在不同的環境之上。其中在 2004年 Kurosawa及 Duong兩位學者提出了重覆使用之 n
選一模糊傳送協定[21]的概念，主要的目的是在多次使用模糊傳送之參數以增進協定的效
率，而可重覆使用 n選一模糊傳送協定主要可分成以下兩個階段： 
14 
 
類型之加密技術來達到模糊傳送的目標。 
 
圖九、以 ElGamal公開金匙密碼系統進行乘法同態加解密 
在條件式模糊群播協定中需要考慮的不僅是接收者的隱私，傳送者的隱私，和許多不
同種類的攻擊方式外，主要需考慮到述語判斷式 Q(x,y)的結果，根據其結果來決定接收者
可解開那一個訊息，因在結果出爐前，接收者不能解開訊息，結果出來後，接收者也不能
解開未允許之訊息，因此所有訊息皆需在加密狀態下運算，故需採用乘法同態加密技術或
者是加法同態加密技術。而在 n選一條件式模糊群播協定中，傳送者必需要提出 n個條件
式 x1，x2，…，xn，與接收者所提出的條件 y進行比對，如此一來，整個協定的困難度必
然大大提升。因此將以第一年的研究成果，再深入研究乘法同態加密技術、加法同態加密
技術，以期設計出功能更加強大的條件式模糊群播協定。 
三、 研究方法 
16 
 
為(N,g)和私密鑰匙 SK為 ( ) ( ) ( )11 -´-= qpNl 。 
l 加密：若要加密一訊息 m，則計算 ( ) 2mod NrgmEc Nm== ,其中 NZr Î 。 
l 解密：解密 c，則計算
( )
( ) NNgL
NcLm N
N
mod
)mod(
)mod(
2
2
l
l
= ，其中
N
uuL 1)( -= 。 
l 加法同態加密技術：加密訊息 m0與 m1成為 c0= E(m0)，c1= E(m1)，加法同態加密
則計算 
( ) ( )
( ) ( )
( )
( )
3
10
21
10
10
10
10
10
c
mmE
rrg
rgrg
mEmE
cc
Nmm
NmNm
=
+=
=
´=
´=
´
+  
0’與 1’編碼： 
在 n選 1條件式模糊傳送協定與 n選 1條件式模糊群播協定中，會使用到 0編碼
與 1編碼，但在 x做 1編碼與 y做 0編碼的情況下，僅能辨別 x > y，卻不能辨別 yx £
的情況，因此除 0編碼與 1編碼之外，吾人還設計 0’編碼與 1’編碼，而對一長度為 n
的二元字串 s做 0’編碼，即是 { }nisssssS iiinns ££== +- 1,0|11'0 L , 而做 1’編碼，即是
{ }nissssS iinns ££== +- 1,1|0111 L ，若有兩個相同長度的二元字串x做1’編碼得到 '1xS ，
對 y做 0’編碼得到 '0yS ，只有在 x > y的情況下，
'1
xS 與
'0
yS 會產生交集。原理如同 0編
碼與 1 編碼，若二元字串 11 xxxxx jnn LL-= 與 11 yyyyy jnn LL-= ，假設第一個不同
的 bit為 xj與 yj，在 x > y的情況下可以發現 jjnnnn yxyxyx >== -- ,,, 11 L ，並且可以
知道 xj = 1與 yj = 0，而 y做 0’編碼會使得 yj = 0 與 x做 1’編碼 xj = 0的情況相同，進
而得到 jjnnnn yxyxyx === -- ,,, 11 L 的交集。 
18 
再計算 mode ki iX m N
Å= ，i=1,..,n。同樣地，為考慮安全因素，必須確保 e kim N
Å > ，
若 e kim N
Å £ 則可在訊息中加入時間或是雙方的 ID。並且事先依照
( ) ' 1mod ( )e k d NfÅ ´ = 計算出 'd ，最後將 1 2, ,..., ,nX X X k傳送給接收者。 
步驟 二： 當接收者收到 1 2, ,..., nX X X 之後，接收者隨機選擇 t個亂數
*
1 2, ,..., t Ns s s ZÎ ，並由
所收到的 1 2, ,..., nX X X 中選擇 t 個想要的秘密值 1 2, ,..., ti i iX X X ，接著計算
1 21 1 2 2
, ,..., mod
t
e k e k e k
i i t t iY s X Y s X Y s X N
Å Å Å= = = ，最後將 1 2, ,..., tY Y Y 傳回給傳送者。 
1 2, ,..., ,nX X X k  
mode ki iX m N
Å=
1 21 1 2 2
, ,
..., mod
t
e k e k
i i
e k
t t i
Y s X Y s X
Y s X N
Å Å
Å
= =
=
圖十、可重覆使用之 n選 t模糊傳送協定傳輸階段 
 
1 2, ,..., tY Y Y
' '
1 1 2 2
'
, ,
..., mod
d d
d
t t
Z Y Z Y
Z Y N
= =
=
1 2, ,..., tZ Z Z  
1 2
1 1
1 1 2 2
1
, ,
..., mod
t
i i
i t t
m Z s m Z s
m Z s N
- -
-
= =
=
 
 
 
Sender 
 
 
 
Receiver 
 
20 
 
1 moda e q-= ，計算 1 1 2 2, ,..., mod
a a a
t tZ Y Z Y Z Y p= = = , 3 1 2( || || ... || )k tMAC F Z Z Z= ，
最後將 1 2, ,..., tZ Z Z 以及 3MAC 傳給接收方。 
步驟 四： 接收方收到 1 2, ,..., tZ Z Z 以及 3MAC 之後，計算
'
3 1 2( || || ... || )k tMAC F Z Z Z= 並比較
3MAC 與
'
3MAC 是否相等，倘若不相等，則放棄此協定。若相同，則繼續執行。
令 1 1 11 1 2 2, , ..., modt tb s b s b s q
- - -= = = ，最後可經由下列式子得到所選擇的 t 個秘密
值： 1 2
1 21 2
, ,..., modt
t
bb b
i i i tm Z m Z m Z p= = = 。 
3. 具內藏型使用者確認之模糊傳送協定 
具內藏型使用者確認之模糊傳送協定，主要是為確保訊息不被第三方得知。首先，產
生初始的參數：G為一乘法循環群其序為 q，且 q為一個大質數，並讓 p=2q+1，而 p也為
質數，並且傳送方透過秘密通道傳送隨機產生的大質數 k給接收方，再進行下列步驟： 
步驟 一： 傳 送 方 隨 機 選 擇 一 個 整 數 *qe ZÎ ， 並 計 算
1 1 2 2( ( || )) , ( ( || )) ,..., ( ( || )) mod
e e e
A A n A nX k ID m X k ID m X k ID m p= ´ = ´ = ´ ， AID 為
傳送方的 ID，最後將 1 2, ,..., nX X X 傳送給接收方。 
步驟 二： 接收方隨機選擇 t個亂數 *1 2, ,..., t qs s s ZÎ ，並在 1 2, ,..., nX X X 中選擇所要的秘密值
1 2
, ,...,
ti i i
X X X ，最後計算 1 2
1 21 2
, ,..., modt
t
ss s
i i t iY X Y X Y X p= = = ，並將 1 2, ,..., tY Y Y 傳回
給傳送方。 
步驟 三： 傳 送 方 先 令 1 moda e q-= ， 當 收 到 1 2, ,..., tY Y Y 之 後 ， 計 算
1 1 2 2, ,..., mod
a a a
t tZ Y Z Y Z Y p= = = ，最後將 1 2, ,..., tZ Z Z 傳給接收方。 
步驟 四： 接收方令 1 1 11 1 2 2, , ..., modt tb s b s b s q
- - -= = = ，最後可經由下列式子得到傳送方 ID和
22 
 
 
圖十一、植基於加法同態加密技術之 n選一條件式模糊傳送協定 
步驟 一： 接收者提出條件值 x，並且轉換為二進位模式，變成長度為 w的位元串，再將每
個位元分別使用公開金鑰加密成為EPK(xi)( xi指x轉化為二進位後的第 i個位元)，
再將 EPK(xi)以及公開金鑰 PK傳送給傳送者(亦可將 PK放在某信任中心，由傳送
者自行取得)。若先前傳送者已有接收者的公開金鑰 PK，便可不需重覆傳送金鑰
以節省傳輸量。 
步驟 二： 在傳送者收到 EPK(xi)以及公開金鑰 PK後，便會產生 n-1個條件值 yk( 11 -££ nk )，
並且將其轉換為二進位模式，變成長度為 w 的位元串 yki，再計算式子(4a)得到
dki和 d’ki，與式子(4b)得到 eki和 e’ki，以及式子(4c)得到 fki。 
 
Sender EPK(xi)、PK 
( )
( )
( )
( ) ( ) ( )
( ) ( )
'
; ' ' '
1 1
'
''
0 1 0 1 2 1
1
1
''
''
2 1
4 , 1
(4 ) , , 0, ,
4
1 , 1 , '
4
, , ' ,
4 1 1
ki i ki ki i ki
ki ki i i ki ki ki n ki ki R N
ki ki ki
w
keq ki ki ki ki i ki ki i l
i
ki ki ki R N
keq k ki
i
a d x y d x y
b e r e d e r d e r r Z
c f e e
k c m r d c r f m c r f f m
r r r Z
k n c m r
a
a
+ +
=
-
=
= - = + -
= + = = Î
= +
= = + = + + = + +
Î
< < - = +
å
( )
( ) ( ) ( )
''
1
1
'' ''
3 2 1 1
1
, , ,
4 1 , 1 , ,
w
ki ki ki k l k ki k R N
w
keq n ki ki ki n i n ki k R N
i
d c r f f m r r Z
k n c m r d c r f m r r Za
+
- - -
=
= + + Î
= - = + = - + Î
å
å
 
EPK(ckeq),EPK(cki) 
yki 
 
Receiver 
24 
 
二: 當 1j jy x y -< < 時，x與 yj第一個不同 bit會使的 1=jif ，x與 yj+1第一個不同的 bit
會使的 11 -=+ ljf ，因此在式子 ( ) klkkiki mffrc ++= +1 中，接收者可以解出秘密訊息
mj，而當 jx y= 時 jid 維持為 0，因此在式子 ki
w
i
kikkeq drmc å
=
- +=
1
''
1 中，接收者可以解
出秘密訊息 mj-1。 
三: 當 xyn <-1 時， x 與  yn-1 第一個不同 bit 會使的 11 =- inf ，因此在式子
( ) 11 1 -- +-= ninki mfrc 中，接收者可以解出秘密訊息 mn-1，而當 1-= nyx 時 ind 1- 維持
為 0，因此在式子 ki
w
i
kinkeq drmc å
=
- +=
1
''
2 中，接收者可以解出秘密訊息 mn-2。 
l 接收方的隱私：接收方所提出的條件值由 Paillier加密法保護，傳送方不可能得知接收
方的條件值以及述語判斷式的結果，接收方保障了自己的隱私。 
l 傳送方的隱私：  
一: 當 1yx £ 時 接 ， 收 者 除 了 可 以 從 式 子
( ) ( ) ( )''1 0 1 0 1 2 1
1
4 , 1 , '
w
keq ki ki ki ki i ki ki i l
i
c m r d c r f m c r f f ma
=
= + = + + = + +å 中解出秘密訊
息 m0 及 21 yxy << 時 ， 解 出 秘 密 訊 息 m1 外 ， 式 子
( ) ( )''2 1 1
1
4 ,
w
keq k ki ki ki ki k l k
i
c m r d c r f f ma - +
=
= + = + +å 與 ( ) ''3 2
1
4 ,
w
keq n ki ki
i
c m r da -
=
= + å
( )1 11ki n i nc r f m- -= - + 中 2111 -=-=+ -+ inlkki fff 而 )1( ¹kd ki 不為 0，因此除了 m0
外，接收者無法獲得其它訊息。 
二: 當 1+<£ jj yxy 時 ， 接 收 者 除 了 可 以 從 式 子
( ) ( )''2 1 1
1
4 ,
w
keq k ki ki ki ki k l k
i
c m r d c r f f ma - +
=
= + = + +å 中解出秘密訊息 mj 或 mj-1。在
1k ky y x+< < 的情況下， 21 =+ + lkki ff ，而在 1k kx y y +< < 的情況下， 21 -=+ + lkki ff ，
之 外 ， 式 子 ( ) ( )''1 0 1 0
1
4 , 1
w
keq ki ki ki i
i
c m r d c r f ma
=
= + = + +å 與
26 
 
 
圖十二、植基於乘法同態加密技術之 n選 1條件式模糊傳送協定 
步驟 一： 接收者提出條件值 x，並且計算 [ ]( )iSE xPK 1 與 [ ]( )iSE xPK '0 ，即將 x轉換成為長度為
w 的二進位串，並且建立一個二維表格 T-table， [ ] { } { }1,2,,,1,0,, LwvuvuT ÎÎ ，
依二進位串轉換結果 x=xwxw-1…x1填入表格 [ ] ( )1, PKi EixT = 與 [ ] ( )rEixT PKi =,  (r為
一亂數),，最後將 T-table、EPK(x)以及公開金鑰 PK 傳送給傳送者(亦可將 PK 放
在某信任中心，由傳送者自行取得)。若先前傳送者已有接收者的公開金鑰 PK，
便可不需重覆傳送金鑰以節省傳輸量。 
步驟 二： 在傳送者收到 T-table、EPK(x)以及公開金鑰 PK 後，便會產生 n-1 個條件值
[ ]( ) [ ]( ) ( ) PKxEiSEiSE PKxPKxPK ,,, '01  
EPK(c01i),EPK(cj2i),EPK(cn-13i) ,EPK(cj4) 
[ ]( ) [ ]( ) ( )kPKyPKyPK yEiSEiSE kk ,, '10  
( ) ( ) [ ]( ) [ ]( )( )
( )
( ) [ ]( ) [ ]( )( )
[ ]( ) [ ]( )( )
( ) ( ) [ ]( ) [ ]( )( )
( ) ( ) ( ) ( )( )
1
1
1
10' 1'
01 0
11 0
2 1 1
10' 1'
2 2
11 0
13 1
1
4 1
5 1 ,
5 2
,
5 3 ,
5 4
l
l
k
l
k
l
n
l
r
i PK PK x PK y l R q
r
k i PK k PK x PK y
r
PK x PK y l R q
r
n i PK n PK x PK y l R q
r
k PK k PK PK k
c E m E S i E S i r G
c E m E S i E S i
E S i E S i r G
c E m E S i E S i r G
c E m E x E y
a
a
a
a
+
-
-
-
-
-
- -
-
-
= Ä Ä Î
= Ä Ä Ä
Ä Î
= Ä Ä Î
= Ä Ä
 
 
Sender 
 
Receiver 
28 
 
步驟 四： 將步驟三 ( )5 1a 、 ( )5 2a 、 ( )5 3a 及 ( )5 4a 所計算得到的 EPK(c01i)，EPK(cj2i) ，
EPK(cn-13i)與 EPK(cj4)傳送給接收者。 
步驟 五： 接收者解開 EPK(c01i)，EPK(cj2i) ，EPK(cn-13i)與 EPK(cj4) ，依述語判斷式 Q(x,yj)的
結果，若 1yx £ 則語判斷式 Q(x,y0)=1，接收者獲得秘密訊息 m0，若 1+£< jj yxy
則語判斷式 Q(x,yj)=1，接收者獲得秘密訊息 mj，若 xyn <-1 則語判斷式 Q(x,yn-1)=1，
接收者獲得秘密訊息 mn-1。 
5.1植基於乘法同態加密技術之 n選 1條件式模糊傳送協定(MCOT)安全分析 
    植基於乘法同態加密技術之 n選 1條件式模糊傳送協定的安全分析如下： 
l 正確性：若傳送者與接收者遵照協定進行，可得到下列四種情況。 
一: 當 1x y< 時，x的0’編碼與 y1的1’編碼會產生交集，使 [ ]( ) [ ]( ) 11'1'0 1 =Ä
-iSEiSE yPKxPK ，
因此在式子 ( ) [ ]( ) [ ]( )( ) lryPKxPKPKi iSEiSEmEc 1'1'0001 1 -ÄÄ= 中，接收者可以解出秘密訊
息 m0。 
二: 當 1j jy x y +< < 時，x的1編碼與yj的0編碼會產生交集，使 [ ]( ) [ ]( ) 111011 =Ä -iSEiSE jyPKxPK ，
x的 0’編碼與 y1的 1’編碼會產生交集，使得 [ ]( ) [ ]( ) 112'12'0 1 =Ä -+ iSEiSE jyPKxPK 因此在式
子 ( ) [ ]( ) [ ]( ) [ ]( ) [ ]( )1
1 1
1 0 0' 1'
2 1 1 2 2
l l
j j
r r
j i PK j PK x PK y PK x PK yc E m E S i E S i E S i E S i+
- -æ ö æ ö= Ä Ä Ä Äç ÷ ç ÷
è ø è ø
中，接收者可以解出秘密訊息 mj。  
三: 當 xyn <-1 時，x的1編碼與yn-1的0編碼會產生交集，使 [ ]( ) [ ]( ) 1101 1 =Ä
-
-
iSEiSE
nyPKxPK
，
因此在式子 ( ) [ ]( ) [ ]( )( ) l
n
r
yPKxPKnPKin iSEiSEmEc
101
113 1
-
-- -
ÄÄ= 中，接收者可以解出秘
密訊息 mn-1。 
四: 當 jx y= 時， ( ) ( ) 11 =Ä -jPKPK yExE ，因此在式子 ( ) ( ) ( )( ) lrjPKPKjPK yExEmE 11 -- ÄÄ
中，接收者可以解出秘密訊息 mj-1。  
l 接收方的隱私：接收方所提出的條件值由 ElGamal加密法保護，傳送方不可能得知接
收方的條件值以及述語判斷式的結果，接收方保障了自己的隱私。 
30 
 
四: 當 jx y= ， 時 接 收 者 除 了 可 以 從 式 子
( ) ( ) ( ) ( )( )14 15 4 lrk PK k PK PK kc E m E x E ya --= Ä Ä 中解出秘密訊息 mj-1 外，式子
( ) ( ) [ ]( ) [ ]( )( )1 10' 1'01 05 1 l
r
i PK PK x PK yc E m E S i E S ia
-
= Ä Ä 、 ( ) ( )25 2   k i PK kc E ma = Ä
[ ]( ) [ ]( )( ) [ ]( ) [ ]( )( )11 11 0 0' 1'1 1 2 2l lk k
r r
PK x PK y PK x PK yE S i E S i E S i E S i+
- -
Ä Ä Ä 與 ( )13 1(5 3) n i PK nc E ma - -= Ä
[ ]( ) [ ]( )( )1 11 0 ln
r
PK x PK yE S i E S i-
-
Ä 由於編碼結果不會產生交集，因此除了 mj外，接收
者無法獲得其它訊息，因此傳送方的隱私得到保障。 
6. 植基於加法同態加密技術之n選一條件式模糊群播協定（ACOC） 
在這個協定中，傳送者握有 n個秘密訊息 m0,m1…,mn-1，並且比較接收者 B所提出的條
件值 y1,…,yn-1，與接收者 A所提出的條件值 x，若 x < y1則述語判斷式 Q(x, y0)=1，接收者
可獲得秘密訊息 m0，若 yn-1 < x則述語判斷式 Q(x, yn-1)=1，接收者可獲得秘密訊息 mn-1，若
1+£< jj yxy 則述語判斷式 Q(x, yj)=1，接收者可獲得秘密訊息 mj。如圖十三所示，接收者 A
與接收者 B會先建立並分享 Paillier 加密法的公開金鑰 PK與秘密金鑰 SK，再進行下列步
驟： 
32 
 
序性。 
步驟 二： 在傳送者收到 EPK(xi)以及 EPK(yki)後，再計算式子(6a)得到 dki和 d’ki，與式子(6b)
得到 eki和 e’ki，以及式子(6c)得到 fki。 
步驟 三：  
一: 計算式子 ( ) ( )''1 0 1 0
1
6 , 1
t
keq ki ki ki i
i
c m r d c r f ma
=
= + = + +å ，本式子 1yx £ 時，讓接收者
獲得秘密訊息 m0。 
二: 計 算 式 子 ( ) ( )''2 1 1
1
6 ,
w
keq k ki ki ki ki k l k
i
c m r d c r f f ma - +
=
= + = + +å ， 本 式 子 可 在
1+£< jj yxy 時，讓接收者獲得秘密訊息mj與 jx y= 時，接收者獲得秘密訊息 mj-1。 
三: 當 ( 1)ky k n= - 為 傳 送 者 最 後 一 個 條 件 式 時 ， 則 計 算 式 子
( ) ( )''3 2 1 1
1
6 , 1
t
keq n ki ki ki n i n
i
c m r d c r f ma - - -
=
= + = - +å ，本式子可在 1ny x- > 時，讓接收
者獲得秘密訊息 mn-1與 1nx y -= 時接收者獲得秘密訊息 mn-2。 
步驟 四： 將步驟三 1(6 )a 、 2(6 )a 及 3(6 )a 所計算得到的 EPK(ckeq)與 EPK(cki)傳送給接收者。 
步驟 五： 接收者解開 EPK(ckeq)與 EPK(cki) ，依述語判斷式 Q(x,yj)的結果，若 1yx £ ，則述
語判斷式 Q(x,y0)=1，接收者獲得秘密訊息 m0，若 1+£< jj yxy 則述語判斷式
Q(x,yj)=1，接收者獲得秘密訊息 mj，若 xyn <-1 則述語判斷式 Q(x,yn-1)=1，接收
者獲得秘密訊息 mn-1。 
6.1 植基於加法同態加密技術之 n選 1條件式模糊群播協定(ACOC)安全分析 
植基於加法同態加密技術之兩接收者 n選 1條件式模糊群播協定的安全分析如下： 
l 正確性：若傳送者與接收者遵照協定進行，可得到下列三種情況。 
34 
 
之 外 ， 式 子 ( ) ( )''1 0 1 0
1
6 , 1
t
keq ki ki ki i
i
c m r d c r f ma
=
= + = + +å 與
( ) ( )''3 2 1 1
1
6 , 1
t
keq n ki ki ki n i n
i
c m r d c r f ma - - -
=
= + = - +å 中， 211 =+if ，而 211 -=-- inf 以
及 )( jkd ki ¹ 不為 0，因此除了 mj或 mj-1外接收者無法獲得其它訊息。 
三: 當 xyn £-1 時 ， 接 收 者 除 了 可 以 從 式 子
( ) ( )''3 2 1 1
1
6 , 1
t
keq n ki ki ki n i n
i
c m r d c r f ma - - -
=
= + = - +å 中解出秘密訊息 mn-1或 mn-2外，
式 子 ( ) ( )''1 0 1 0
1
6 , 1
t
keq ki ki ki i
i
c m r d c r f ma
=
= + = + +å 與
( ) ( )''2 1 1
1
6 ,
w
keq k ki ki ki ki k l k
i
c m r d c r f f ma - +
=
= + = + +å 中， 1 11i ki k lf f f ++ = + = 1 1 2n if - - = ，
而 )1( -¹ nkd ki 不為 0，因此除了 mn-1或 mn-2外，接收者無法獲得其它訊息，因此
傳送方的隱私得到保障。 
7. 植基於乘法同態加密技術與hash函數之n選一條件式模糊協定（MHCOC） 
在這個協定中傳送者握有 n個秘密訊息 m0,m1…,mn-1，並且比較接收者 B所提出的條件
值 y1,…,yn-1，與接收者 A所提出的條件值 x，若 1x y< 則述語判斷式 Q(x,y0)=1，接收者可獲
得秘密訊息 m0，若 1ny x- < 則述語判斷式 Q(x,yn-1)=1，接收者可獲得秘密訊息 mn-1，若
1+£< jj yxy 則述語判斷式 Q(x,yj)=1，接收者可獲得秘密訊息 mj。如圖十四所示，接收者 A
與接收者 B會先建立並且分享 ElGamal加密法的公開金鑰 PK與秘密金鑰 SK，再進行下列
步驟： 
36 
 
者。同時接收者 B亦產生 n-1個條件值 yk( 11 -££ nk )，並且計算 [ ]( )iSE
kyPK
0 與
[ ]( )iSE
kyPK
'1 ，即將 yk轉換成為長度為 w 的二進位串，並且建立 n-1 個二維表格
TB-table ，  [ ] { } { }1,2,,,1,0,, LwvuvuTB ÎÎ ， 依 二 進 位 串 轉 換 編 碼 結 果
0
1 kyiwwki
Syyyy Î= - L 或 者 是
'1
1 kyiwwki
Syyyy Î= - L 填 入 表 格
[ ] ( )( ) ( )( ) ),(,, 11 iiirikwkwrikwkwPKkiB bacyyyhgyyyhEiyT ii ==== -- bLL 與
[ ] ( )rEiyT PKkiB =,  (r 為一亂數)，最後將 TB-table、EPK(yk)傳送給傳送者，而在這
裡 yk必需保持它的順序性。 
步驟 二： 在傳送者收到 TA-table、TB-table、EPK(x)以 EPK(yk)後，再進行步驟三。 
步驟 三：  
一: 計算式子 ( ) ( ) [ ]( ) [ ]( )( )1 10' 1'1 07 1 k PK PK x PK yc E m E S i E S ia -= Ä Ä ，本式子 1yx < 時，
讓接收者獲得秘密訊息 m0。 
二: 當 (1 1)ky k n< < - 為第 2 個到第 n-2 個之間的條件式時，計算式子 ( )7 2a
( ) [ ]( ) [ ]( )( ) l
k
r
yPKxPKkPKk iSEiSEmEc
101
2
-
ÄÄ=  [ ]( ) [ ]( )( ) l
k
r
yPKxPK iSEiSE
11'0
1
-
+
ÄÄ ，本式子
可在 1+<< jj yxy 時，讓接收者獲得秘密訊息 mj。 
三: 計算式子 ( ) ( ) [ ]( ) [ ]( )( )1 11 03 17 3 ln
r
k PK n PK x PK yc E m E S i E S ia -
-
-= Ä Ä ，本式子可在
1ny x- < 時，讓接收者獲得秘密訊息 mn-1。 
四: 計算式子 ( ) ( ) ( ) ( )( )14 17 4 lrk PK k PK PK kc E m E x E ya --= Ä Ä ，本式子可在 jx y= 時，
讓接收者獲得秘密訊息 mj-1與本節一開始的假設相同。 
步驟 四： 將步驟三 ( )7 1a 、( )7 2a 、( )7 3a 及 ( )7 4a 所計算得到的 EPK(c01i)，EPK(cj2i)，EPK(cn-13i) 
38 
 
四: 而當 jx y= 時， ( ) ( ) 11 =Ä -jPKPK yExE 因此在式子 ( ) ( ) ( )( ) lrjPKPKjPK yExEmE 11 -- ÄÄ
中，接收者可以解出秘密訊息 mj-1。  
l 接收方的隱私：接收方所提出的條件值由 ElGamal 加密法保護，傳送方不可能得知接
收方的條件值以及述語判斷式的結果，接收方保障了自己的隱私。 
l 傳送方的隱私：  
一: 當 1x y< 時 ， 接 收 者 除 了 可 以 從 式 子
( ) ( ) [ ]( ) [ ]( )( )1 10' 1'1 07 1 k PK PK x PK yc E m E S i E S ia -= Ä Ä 中解出秘密訊息 m0 外，式子
( )7 2a ( ) [ ]( ) [ ]( )( ) l
k
r
yPKxPKkPKk iSEiSEmEc
101
2
-
ÄÄ= [ ]( ) [ ]( )( ) l
k
r
yPKxPK iSEiSE
11'0
1
-
+
ÄÄ 、
( ) ( ) [ ]( ) [ ]( )( )1 11 03 17 3 ln
r
k PK n PK x PK yc E m E S i E S ia -
-
-= Ä Ä 中 x的 1編碼與 yj的 0編碼
不會產生交集，而式子 ( ) ( ) ( ) ( )( )14 17 4 lrk PK k PK PK kc E m E x E ya --= Ä Ä 在 x y¹ 的
情況下，不能解出秘密訊息，因此除了 m0外，接收者無法獲得其它秘密訊息。 
二: 當 1j jy x y +< < 時 接 收 者 除 了 可 以 從 式 子 ( )7 2a
( ) [ ]( ) [ ]( )( ) l
k
r
yPKxPKkPKk iSEiSEmEc
101
2
-
ÄÄ= [ ]( ) [ ]( )( ) l
k
r
yPKxPK iSEiSE
11'0
1
-
+
ÄÄ 中解出秘
密訊息 mj。在 xyy jj £< +1 情況，x 的 0’編碼與 yj+1的 1’編碼不會產生交集，與
1j jx y y +< < 的情況下，x 的 1 編碼與 yj 的 0 編碼不會產生交集之外，式子
( ) ( ) [ ]( ) [ ]( )( )1 10' 1'1 07 1 k PK PK x PK yc E m E S i E S ia -= Ä Ä 中 x的 0編碼與 y1的 1’編碼不
會產生交集，與 ( ) ( ) [ ]( ) [ ]( )( )1 11 03 17 3 ln
r
k PK n PK x PK yc E m E S i E S ia -
-
-= Ä Ä 中 x 的 1
編碼與yn-1的0編碼不會產生交集，( ) ( ) ( ) ( )( )14 17 4 lrk PK k PK PK kc E m E x E ya --= Ä Ä
在 x y¹ 的情況下，不能解出秘密訊息，因此除了 mj外，接收者無法獲得其它訊
息。 
40 
 
3. 讓參與之工作人員能學習到模糊傳送協定之理論基礎與特性。 
4. 讓參與之工作人員能學習到從事科學研究、執行計畫、團隊合作的能力。 
5. 此研究的部分成果已撰寫成論文並投稿至 IEICE國際期刊等，詳細內容請參閱[9] 
[32][33][34][35]或附件。 
6. 在國科會的支援與協助下，本年度共已發表 1 篇國際期刊論文，4 篇國際會議論
文與 7篇國內會議論文。 
7. 本研究計畫在國科會給予經費與充分的協助之下，已順利完成，因具學術與實用
價值，故自評為極佳。  
參考文獻 
[1] 王建智，”可驗證模糊傳送之研究”，南台科技大學資訊管理所碩士論文，民 94年。 
[2] 林季玄，”可重覆使用之模糊傳送協定之研究”，南台科技大學資訊管理所碩士論文，
民 95年。 
[3] A. Parakh “Oblivious Transfer using Elliptic Curves,” Proceedings of the 15th International 
Conference on Computing (CIC'06), 2006. 
[4] A Parakh, “Oblivious Transfer based on key Exchange,” Cyptologia, Vol. 32-1, 2008, pp. 
37-44. 
[5] A. Sadeghi, “How to break a semi-anonymous fingerprinting scheme,” Information Hiding 
2001, LNCS 2137, Springer-Verlage, 2001, pp. 384-394. 
[6] B. Aiello, Y. Ishai, and O. Reingold, “Priced Oblivious Transfer: How to sell Digital Goods”, 
Advances in Cryptology – Eurocrypt 2001, LNCS 2045, 2001, pp. 119-135. 
[7] B. Chor, O. Goldreich, E. Kushilevitz, and M. Susdan. “Private Information Retrieval,” 
Journal of the ACM 45(6), 1998, pp. 965-982. 
[8] C. Crepeau and J. Kilian, “Achieving oblivious transfer using weakened security 
assumptions”, Proceedings of the 28th symposium on Foundations of Computer Science 
(Focs ‘88), IEEE, 1988, pp. 42-52. 
42 
 
[19] J Ren, and L Harn, “Generalized Ring Signatures,” IEEE Transactions on Dependable and 
Secure Computing, Vol. 5, No. 3, 2008. 
[20] K. Frikken, and M. Atallah, “Achieving Fairness in Private Contract Negotiation”, Financial 
Cryptography and Data Security: 9th International Conference, FC’05, 2005, pp. 270-285. 
[21] K. Kurosawa and Q. Duong “How to Design Efficient Multiple-Use 1-out-n Oblivious 
Transfer,” IEICE Trans. Fundamentals, Vol. E87–A, No. 1, 2004, pp. 141-146. 
[22] L. Harn and H. Y. Lin, “Noninteractive Oblivious Transfer”, Electronics Letters, Vol. 26, No. 
10, 1990, pp. 635-636. 
[23] M. Bellare and S. micali, “non-interactive oblivious transfer”, In Proceedings of Advances in 
Cryptology – Crypto 89, LNCS 435, Springer-Verlag, 1990, pp. 547-557. 
[24] M. Blum, and M. Rabin, “How to send certified electronic mail”, Dept. EECS, University of 
California, Berkeley, Calif, 1981. 
[25] M. Blum, “Three Application in of Oblivious Transfer: Part I: Coin flipping by telephone; 
Part II: How to exchange secrets; Part III: How to send certified electronic mail”, Dept. 
EECS, University of California, Berkeley, Calif, 1981. 
[26] M. Naor and B. Pinkas, “Efficient Oblivious Transfer Protocols”, Proceedings 12th Ann. 
Symp. Discrete Algorithms, 2001, pp. 448-457.  
[27] M. Naor and B. Pinkas, “Oblivious Transfer and Polyomial Evaluation”, Proc. 31st ACM 
Symp. Theory of Computing, 1999, pp. 145-254 
[28] M. Naor and B. Pinkas, “Computationally Secure Oblivious Transfer”, Crypot 99, 1999. 
[29] M. Rabin, “How to Exchange Secrets by Oblivious Transfer,” Technical Report TR-81, 
Aiken Computation Laboratory, Harvard University, 1981. 
[30] M. Rabin, “Exchange of secrets”. Dept. of Applied Physics, Harvard University, Cambridge, 
Mass, 1981. 
[31] N. Y. Lee and C.C. Wang, “Verifiable Oblivious Transfer Protocol,” IEICE Trans. 
44 
 
[42] T. ELGamal, “A Public-Key Cryptosystem and a Signature Scheme Based on Discrete 
Logarithms,” IEEE Trans. On Information Theory, Vol. IT-31, No. 4, 1985, pp. 469-472. 
[43] T. Pedersen, “Non-Interactive and Information-Theoretical Secure Verifiable Secret 
Sharing”, Proc. Advances in Cryprology (Crypto ‘91), 1991, pp. 129-140. 
[44] W. Diffie, and M. Hellman, “New Directions in Cryptography,” IEEE Transactions on 
Information Theory, Vol. IT-22, No. 6, 1976, pp. 644-654. 
[45] W.G. Tzeng, “Efficient Oblivious Transfer Scheme”, Proceedings of 2001 International 
Workshop on Practice and Theory in Public-Key Cryptography (PKC 02), LNCS 2274, 
Springer-Verlag, 2002. 
[46] W.G. Tzeng, “Efficient 1-out-of-n oblivious transfer schemes with universally reusable 
parameters”, IEEE Transactions on Computers 53(2), 2004, pp. 232-240. 
[47] W.G. Tzeng, “Efficient 1-out-of-n Oblivious Transfer Schemes”, PKC’02, 2002, pp. 
159-171. 
[48] W. Stallings, “Cryptography and Network Security”, Third Edition, Prentice Hall, 2003, pp. 
324-327. 
[49] Y. H. Chen, and T. Hwang, “ID-based non-interactive zero-knowledge Proof System Based 
on one-out-of-two Noninteractive Oblivious Transfer,” Computer Communications, Vol. 18, 
No. 12, 1995, pp. 993-996. 
[50] Y. Mu, J. Zhang, V. Varadharajan, and Y. X. Lin, “Robust Non-Interactive Oblivious 
Transfer,” IEEE Communications Letters, Vol. 7, No. 4, 2003, pp. 153-155. 
[51] Y. Mu, J. Zhang, and V. Varadharajan, “m out of n Oblivious Transfer”, ACISP 2002, LNCS 
2384, 2002, pp. 395-405. 
 
 
 
Ernest Johnson 教授所提之 Concept of Trust and Risk in Internet Privacy and Security，來自台灣高
雄第一科大 Ping-Shou Cheng 教授等人所提之 Study on the RFID Unifies Watermark Application to 
Security Management System，來自台灣清華大學 Han-Cheng Hsiang 教授等人所提之 Secure 
mCoupons Scheme Using NFC等等，此類論文在對我們繼續探索安全與 RFID等研究，皆有相當
大的助益。 
 
The 3rd Joint Workshop on Information Security (JWIS2008)國際會議乃針對資訊安全領域
所舉辦之國際會議，本會議原先為日本與韓國雙方交流資訊安全相關研究與議題之會議，後來
由於台灣等國家對於資訊安全的研究與貢獻也不斷茁壯，所以今年特地開放台灣方面的研究群，
本會議由日本之 Information and Communication System Security (ICSS) of the Institute of 
Electronics, Information and Communication Engineers (IEICE) 與韓國之  Korea Institute of 
Information and Cryptology (KIISC)所合辦，去年在日本舉辦，今年在韓國首爾舉辦，明年將會在
台灣高雄中山大學舉辦，可說是促進臺、日、韓三方交流的一大盛會。 
 
本 JWIS2008國際會議在 7月 10日、11日韓國 Hanyang University舉辦，由於在大學內
舉辦，所以學術、人文氣息特別濃厚，由於較屬交流性質，所以邀請了 6 位專家學者做專題演
講，分別是日本的 Youki Kadobayashi 教授演講 Recent Developments in Communications 
Traceability，台灣 Der-Tsai Lee院士演講 iCAST, International Collaboration for Advancing Security 
Technology，韓國 Bin Xiao教授演講 Internet Worm Threat and Defending Mechanism，韓國 JooSeok 
Song教授演講A Survey of WiBro Security in Heterogeneous Wireless Networks，台灣Chi-Sung Laih
教授演講Web Application Security Trends in Taiwan，日本 Koichi Arimura教授演講 Introducing 
Cyber Clean Center of Japan - Practical Implementation and Cooperation by Major Japanese ISPs in 
Anti-bot Measures within Japan，與會人員在聽完演講後皆獲益良多。 
 
吾人所發表之論文為 Undeniable Signature with a Reusable Subliminal Channel，該 session
之主持人為日本 University of Tsukuba之Masahiro Mambo教授，在聽完本人之報告後，主持人
亦提出 2 個問題，其一為針對潛隱通道之接收者是否知道傳送者正在傳送潛隱訊息給他？在我
們所設計的機制中並無探討此類問題，所以吾人提到接收者可以嘗試解開訊息，若訊息無意義，
代表並無傳送訊息，若訊息有意義，則有傳送潛隱訊息。對於此類之問題與建議，對於我們日
後設計相關安全機制，皆有助於做進一步腦力激盪。附圖為 JWIS2008會議與日本、韓國資訊安
全專家學者合影之照片。 
 
最後吾人要感謝國科會對於我們的研究經費之支持與協助，若無國科會之協助，本次國
際交流可能就無法成行，所以在此再一次的感謝國科會，讓我們能夠順利參與 2 個國際會議並
進行相關報告與交流活動。 
 
 
Ordinal Authentication Protocols for RFID Tags 
 
Narn-Yih Lee and Chun-Chang Pan 
Information Management Department, Southern Taiwan University, 
No. 1, Nan-Tai Street, Yung-Kang City, Tainan County 710, Taiwan ROC 
nylee@mail.stut.edu.tw 
m9390108@webmail.stut.edu.tw 
 
ABSTRACT 
RFID has become a useful and important technology for people now.  However, it also brings many 
problems such as user privacy, forgery, and malicious attacks.  Thus, many researchers have 
proposed several authentication protocols to protect RFID reader and tags from malicious behaviors.  
This paper mainly studies the security of authenticating two or multiple RFID tags.  The proposed 
protocols can authenticate the simultaneous presence of two tags or multiple tags.  Moreover, each 
tag can verify transmitted messages whether they come from related tags or not.  Finally, the 
proposed protocols not only can ensure product privacy and unlinkability, but also can withstand the 
replay attack, forgery attack, predicted time attack, and denial of service attack. 
 
Keywords: RFID, User privacy, Forgery, Authentication 
 
1. INTRODUCTION 
An RFID (Radio Frequency Identification) tag contains a microchip and an antenna that can transmit a 
unique identifier in response to a query from the reader.  Fundamentally, RFID tags own a lot of 
advantages such as non-line of sight, contactless, and memory capacity, etc.  It is considered that it 
will replace barcode in the future.  Therefore, many manufacturers expect that RFID technologies 
will help them reduce the cost of management of goods and enhance efficiency.  For example in the 
supermarket, clerks can quickly be notified that the number of products is not enough on the shelf, 
since he/she can continually monitor the status of products on the shelf by the RFID system. 
Since RFID tags can be queried without contacting with a reader, many research works are now 
concerned with privacy problems [1][3][4][6][8][11].  If a user carries the product with an RFID tag, 
the adversary can easily track his/her location or record his/her habits.  Thus, some researchers have 
proposed the protocols [5][7][8][10][11] with cryptographic technologies to protect users or 
manufacturers from malicious behaviors such as forgery, tracking, and replay attack, etc.  In 2004, 
Juels [2] first proposed an authentication protocol to prove the simultaneous presence of two tags to an 
RFID reader.  For example, assume that a specific product consists of two separate components.  
Both components must be used together to take effects.  Accordingly, it is necessary to ensure that 
both components are present before buying/using it.  The study of authenticating the simultaneous 
presence of two tags thus becomes important. Unfortunately, Saito and Sakurai [9] in 2005 pointed out 
 
 
 
Figure 1: Arrangement phase 
 
Arrangement phase: 
 
Step 1. The reader broadcasts a request signal to check the presence of a couple of tags. 
Step 2. Once receiving the signal, tag A and tag B will respectively generate random numbers, ntA and 
ntB, and reply them to the reader. 
Step 3. When the reader receives the random numbers ntA and ntB, it will decide the communication 
sequence.  Whatever the reader first receives will be its priority. If the random numbers are 
received at the same time, the reader will randomly decide the sequence. 
Step 4. Without loss of generality, we assume that the reader chooses tag A as the first priority.  Then, 
the reader generates a random number nr, and broadcasts Order, ntA, ntB, and nr to the tags.  
When tag A and tag B receive the message, they will know their priority in communication. 
 
 
Figure 2: Verification phase 
 
Verification phase: 
 
In here, tag A and tag B share the same secret key KS. 
 
Step 1. Tag A computes mA= HKS (nr, ntA, ntB) and send it to the reader. 
 
 
Step 3. Once receiving mP and ntP , the reader broadcasts ProductProof, nr, ntP and mP to all product 
tags. 
Step 4. Tag i (1 ≤ i ≤ n) will check the validation of mP by using KS.  If it is correct, tag i generates a 
random number nti, computes HKS(nti,ntP) and performs XOR operation with Vi, where 1 ≤ i ≤ n.  
Finally, tag i sends Vi, HKS(nti, ntP), and nti to the reader. 
Step 5. The reader transmits Vi⊕HKS (nti, ntP ) and nti to the pallet tag. 
Step 6. The pallet tag gets Vi of the tag i by performing XOR operation with HKS(nti, ntP). Finally, the 
pallet tag computes V’, where V’ =V1⊕V2⊕… ⊕Vn.  If V’=V, it will reply HKS(nr, ntP, V) to 
the reader.  Otherwise, it will reply an “Error” message. 
Step 7. After receiving HKS(nr, ntP, V), the reader transmits P to the backend server for verification, 
where P=( nr, ntP, HKS(nr, ntP, V)). 
Step 8. The backend server will search a possible key KS' from the database to compare whether HKS(nr, 
ntP, V)=HKS'(nr, ntP, V) or not.  If it is correct, the backend server finds the identities of the tags 
and ensures that all tags are present. 
 
3. SECURITY ANALYSIS 
• Product privacy: In both protocols, each tag will generate a new random number when the reader 
broadcast a query.  As the result, the adversary cannot distinguish the transmitted messages from 
the same tag or different tags, and thus cannot collect correct product information.  Thus, our 
proposed protocols can ensure product privacy. 
• Unlinkability: In both protocols, the reader and all tags will generate new random numbers and use a 
keyed hash function to mix the verification values.  It is infeasible to track a specific tag or 
multiple tags, or use previous messages to link to tags.  Therefore, our proposed protocols can 
promise the property of unlinkability. 
• Resist replay attack: Since the adversary can eavesdrop the communication between the reader and 
the tag, he/she can collect transmitted messages.  However, the collected messages cannot be 
reused.  That is because that the transmitted messages include fresh random numbers controlled by 
the reader.  Thus, the proposed protocol can withstand the replay attack. 
• Resist forgery attack: Except destroying the tag to obtain secret information, the adversary cannot 
utilize public information to masquerade as a couple of tags or multiple tags. 
• Resist predicted time attack: In the Saito and Sakurai [9], the reader transmits the timestamp to the 
tag, and the tag replies the verification value.  As the result, the adversary may try to predict the 
time, transmit it to the tag, and get the useful verification value.   Then, the adversary can use it to 
cheat the reader.  In the proposed protocols, the reader generates new random number each time.  
Thus, it is infeasible to predict the next random number for the adversary. 
• Resist denial of service attack: In both protocols, tags do not update their secret information 
immediately. Even though the adversary intentionally interrupts authentication procedure, the 
authentication procedures still can correctly generate verification values. 
 
 
REFERENCES 
[1] Simson. L. Garfinkel, Ari Juels and Ravi Pappu, 2005, “RFID privacy: An Overview of Problems 
and Proposed Solutions”, Security and Privacy Magazine, page(s): 34-43. 
[2] Ari Juels, 2004, “Yoking-Proof for RFID tags”, Proceedings of the Second IEEE Annual 
Conference on Pervasive Computing and Communications Workshop, page(s): 138-143. 
[3] Ari Juels, David Molnar, and David Wagner, 2005, “Security and Privacy Issues in E-passports”, 
Security and Privacy for Emerging Areas in Communication Networks, page(s): 74-88. 
[4] Ari Juels, 2006, “RFID Security and Privacy: A Research Survey”, IEEE Journal on Selected Areas 
in Communication, page(s): 381-394. 
[5] Ari Juels and Ravikanth Pappu, 2003, “Squealing Euros: Privacy Protection in RFID-Enabled 
Banknotes”, Lecture Note in Computer Science Financial Cryptography 2003, page(s): 103-121. 
[6] Heiko Knospe and Hartmut Pohl, 2004, “RFID Security”, Information Security Technical Report, 
page(s): 39-50. 
[7] David Molnar and David Wagner, 2004, “Privacy and security in library RFID: issues, practices, 
and architectures”, Proceedings of the llth ACM conference on Computer and communications 
security, page(s): 210-219. 
[8] Miyako Ohkubo, Koutarou Suzuki and Shingo Kinoshita, 2003, “Cryptographic Approach to 
Privacy-Friendly tags”, RFID Privacy Workshop, MIT. 
[9] Junichiro Saito and Kouichi Sakurai, 2005, “Grouping proof for RFID tags”, Proceedings of the 
19th International Conference on Advanced Information Networking and Application, page(s): 
621-624. 
[10] Junichiro Saito, Jae-Cheol Ryou and Kouichi Sakurai, 2004, “Enhancing privacy of Universal 
Re-encryption scheme for RFID tags”, Lecture Notes in Computer Science, page(s): 879-890. 
[11] Sarma Weis, Sanjay Sarma, Ronald Rivest and Daniel Engels, 2003, “Security and Privacy 
Aspects of Low-Cost Radio Frequency Identification Systems”, International Conference on 
Security in Pervasive Computing, Lecture Notes in Computer Science, page(s): 454-469. 
 
 
2 Lecture Notes in Computer Science: Authors’ Instructions
Since then, many researches of embedding subliminal channels in digital sig-
nature schemes have been proposed [2][3][4][5][11]. Assume that a digital signa-
ture scheme needs β bits of security against forgery and α bits used to commu-
nicate a signature. Simmons [1] defined that the subliminal channel is said to be
broadband, if it uses all of the α−β bits. Otherwise, it is said to be narrowband.
In 1993, Simmons [2] proposed a broadband subliminal channel embedded in
the DSA [6]. It, however, requires the subliminal receiver to share the sender’s
signing key. In other words, the subliminal receiver has the ability to forge the
sender’s signature for any message. In 1997, Harn and Gong [3] proposed two
digital signature schemes with a broadband subliminal channel. The major fea-
ture of the Harn-Gong schemes is that it allows several subliminal receivers to
simultaneously retrieve different subliminal messages. Each subliminal receiver
only holds a part of sender’s signing key, thus subliminal receivers cannot forge
the sender’s signature. However, both Harn-Gong’s schemes will suffer from the
subliminal receivers’ conspiracy attack.
In 1999, Jan and Tseng [4] proposed two digital signature schemes with
subliminal channels based on the discrete logarithm problem. Both schemes are
more efficient than Harn-Gong’s schemes [3] and also allow multiple subliminal
receivers to simultaneously retrieve different subliminal messages hidden in a
signature. The Jan-Tseng’s first scheme is with a broadband subliminal channel,
however, it suffers from the same conspiracy attack as in the Harn-Gong schemes
[3]. The Jan-Tseng’s second scheme is designed to prevent the conspiracy attack,
but it is only with a narrowband channel. Unfortunately, in 2003, Lee-Lin [11]
showed that Jan-Tseng’s schemes are insecure. A malicious subliminal receiver
can forge the signature and hide a new subliminal message in the signature. The
new subliminal message will be accepted by the other subliminal receivers. Lee
and Lin also showed an improvement to avoid the above security flaw.
Kuwakado-Tanaka [5], in 1999, also proposed a new broadband subliminal
channel embedded in the ESIGN [8]. The major advantages of the paper are
as follows. First, the bandwidth of the proposed subliminal channel exceeds the
upper bound that Simmons [7] has conjectured. Furthermore, the sender does
not need to share any secret key with the subliminal receiver in advance.
Up to now, all schemes [2][3][4][5][11] construct subliminal channels that al-
low a sender to transmit subliminal messages to a or some specific subliminal
receivers. Only a fixed number (usually one or two) of subliminal messages can be
hidden in a digital signature. Moreover, the sender usually has to decide who the
subliminal receivers are before generating digital signatures, because the sender
has to share a secret key with the subliminal receivers in advance.
On the other hand, in 1989, Chaum and van Antwerpen [9] first proposed
an undeniable signature scheme. An undeniable signature is generated based on
the message to be signed and the signer’s secret key. Specifically, it cannot be
verified without the signer’s cooperation. In 1990, Chaum [10] also proposed
a zero-knowledge undeniable signature scheme. In 2004, Lee-Ho [16] proposed
subliminal channels based on a convertible undeniable signature scheme, which
4 Lecture Notes in Computer Science: Authors’ Instructions
Signature confirmation phase: Assume that S promises to help V to verify the
validation of the undeniable signature z, and wants to send a subliminal message
m to V. They can cooperate to perform the following steps.
Step 1. First, V computes the common session key Tsv=T kvs mod p shared by
S and V, where Ts is S’s public key of Diffie-Hellman key exchange protocol
and kv is V’s secret key of Diffie-Hellman key exchange protocol. Then, V
randomly chooses two integers a and b from Z∗p , and sendsW=M
a·h(Tsv,M)αb
mod p to the sender.
Step 2. S computes the common session key Tsv=T ksv mod p. S also encrypts
the subliminal message m by using V’s public key as δ = Epkv (m). Then, S
computes R1=Wαδ·Tsv mod p, and R2=R1xs mod p.
Step 3. S replies R1 and R2 to V.
Step 4. V sends a and b to S.
Step 5. S checks W ?=Ma·h(Tsv,M)αb mod p. If it is true, S releases δ to V.
Step 6. V checks R1 ?= Wαδ·Tsv mod p, and R2 ?= za·h(Tsv,M) · y(b+δ)·Tsvs mod
p. If they are true, z is a valid signature of the message M .
Signature disavowal phase: If S alleged that he/she did not generate the sig-
nature z, S has to run the Disavowal protocol with a verifier V to prove that it
was not generated by himself/herself. The Disavowal protocol is the same as in
[10].
Subliminal message recovery phase: V can retrieve the subliminal message m
by directly computing m=Dskv (δ).
It is important to notice that if S wants to transmit another subliminal
message m∗ to another verifier V ∗, S can send (M, z) to V ∗ and run Signature
confirmation phase with V ∗ again. Then, V ∗ can get m∗ in the Subliminal
message recovery phase.
3 Discussions and Analysis
3.1 Security analysis
In this section, we will analyze the security of the proposed scheme. Because
that the proposed scheme is based on the Chaum undeniable signature scheme,
the security analysis is quite similar to the one in [10]. In the following, we will
focus on the security analysis of the subliminal channels.
(1) No one can retrieve the subliminal message unless he/she is an authorized
subliminal receiver.
The subliminal message m is protected by a secure public key cryptosystem.
Thus, no one can extract the subliminal message unless he/she can break
the public key cryptosystem or finds the subliminal receiver’s secret key.
(2) No outsider can be aware whether any subliminal message is embedded in
the signature.
If S wants to hide a subliminal message, the δ is computed by using a prob-
abilistic public key cryptosystem. Otherwise, the δ is chosen by a random
6 Lecture Notes in Computer Science: Authors’ Instructions
3.2 Discussions
The proposed scheme offers the following advantages.
(1) The sender and the verifier need not share a common secret key in advance.
(2) In the proposed scheme, the verifier need not share the sender’s signing
key, because that a public key cryptosystem is used for subliminal commu-
nication. If only a private key cryptosystem is available in the system, the
sender has to share a common secret key with the verifier in advance. Even
so, verifier still does not know the sender’s signing key and cannot forge the
sender’s signatures.
(3) According to the Signature confirmation phase and Subliminal message
recovery phase, the sender need not generate another undeniable signature
for transmitting new subliminal messages. Thus, the subliminal channel is
reusable.
The comparisons among our scheme and some previous schemes [3][4][5][11]
[16][17] are shown in Table 1. In Table 1, the item of “All” means that the
verifier must know all of the sender’s secret signing keys to recover the subliminal
message. The item of “Part” is that the verifier only knows a part of the sender’s
secret signing keys to get the subliminal message. Although [16] keeps the same
properties with our scheme, our scheme has better efficiency compared with [16].
Table 1: The comparisons among [3][4][5][11][16][17] and our scheme
[3] [4] [5] [11] [16] [17] Our
scheme
Attacking
method
Conspiracy
attack
Conspiracy
attack
No Conspiracy
attack
No No No
Share sender’s
signing key
Part Part No Part No No No
Reusable sub-
liminal channel
No No No No Yes No Yes
References
1. G.J. Simmons, The Prisoner’s Channel and the Subliminal Channel, Proc.
CRYPTO’83, pp.51-67, 1984.
2. G.J. Simmons, Subliminal Communication is Easy Using the DSA, Eurocrypt’93,
pp.218-232, 1994.
3. L. Harn and G. Gong, Digital Signature with a Subliminal Channe, IEE Proc.
Comput. Digit. Tech., Vol. 144, No.6, pp.387-389, 1997.
4. J.K. Jan and Y.M. Tseng, New Digital Signature with Subliminal Channels Based
on the Discrete Logarithm Problem, Proceedings of the 1999 International Work-
shops on Parallel Processing, 1999.
5. H.kuwakado and H. Tanaka, New Subliminal Channel Embedded in the ESIGN,
IEICE Trans. Fundamentals, Vol. E82-A, No.10, pp.2167-2171, 1999.
出席國際學術會議心得報告 
                                                             
計畫編號 NSC 96－2628－E－218－002－MY2 
計畫名稱 條件式模糊群播協定之研究 
出國人員姓名 
服務機關及職稱 
李南逸 南台科技大學 資訊管理系 教授 
會議時間地點 July 6-8, 2009 
會議名稱 2009 International Conference on Business and Information (BAI2009) 
發表論文題目 Reliable Delegation Scheme for RFID Systems 
 
 
今年 2009 International Conference on Business and Information (BAI2009)首度在
馬來西亞（Malaysia）首都吉隆坡（Kuala Lumpur）舉辦，由於馬來西亞為東南亞最大
經濟體，因此就將相關的研究論文投稿至此國際會議，希望藉由此次出國機會認識更多
國際著名研究學者並收集到最新的研究資料，也希望因此對馬來西亞這個回教國家有更
深一層的認識。 
 
2009 International Conference on Business and Information (BAI2009)國際會議共
收到 32個國家近 500篇論文投稿，這些國家包含澳大利亞、中國、芬蘭、法國、德國、
香港、印度、日本、韓國、美國、英國等，每篇論文也都有 2位以上之審查委員，共 312
篇論文被接受，因此投稿之論文被接受，相當高興。BAI2009今年在馬來西亞吉隆坡舉
辦，7月 6日為報到，7月 7日、8日會議正式進行，由發表論文眾多，共有 44個 session
要在 2天內安排完畢，所以會議行程相當緊湊，所有聽眾都只能擇有興趣且相近的研究
論文旁聽。在本會議中，我們所發表的論文為： 
Reliable Delegation Scheme for RFID Systems 
與會學者雖未對我們的論文提出挑戰或意見，但與會研究學者專家都相互進行
認識與交流，希望未來有機會能進行國際合作與參訪。此外，吾人亦收集相關資訊安全
與密碼學的相關研究資料，如：由 Chang Gung University大學 之 Jing-Jang Hwang 教授
等人所提之 User Authentication with a Single Password in Internet Banking where the User 
Has Account in Several Banks，來自朝陽科技大學 Sue-Chen Hsueh 教授等人所提之 A 
Secure and Lightweight Mobile Coupon System Using Qr Code for Mobile Tagging，來自
Chang Gung University大學 Chien-Hsing Wu教授等人所提之 An Application of the RFID 
Technology in an Oil Refinery等等，此類論文在對我們繼續探索資訊安全與 RFID等研
究，皆有相當大的助益。 
 
 
information and make tracking goods as simple as possible. More and more related RFID
researches and applications have been proposed in [7][10][12][13]. However, RFID systems
introduce new privacy and security risks. Molnar and Wagner [5] pointed out that RFID
in libraries may reveal the information of readers’ habits. Knospe and Pohl [6] indicated
that passive tags are powered by the incoming signal from the reader, and transmit their
identities without further security mechanism. Attackers can utilize these identities to
identify tags. In [3], Choi et al. showed that consumers need some security mechanisms
to resist possible privacy abuses. Therefore, how to ensure privacy safeguards in RFID
use becomes very important.
In 2005, Molnar et al. [4] proposed a new delegation scheme (MSW) that allows the
backend system to delegate the ability of identifying tags to RFID readers. In 2007,
Fouladgar and Afifi [11] further proposed a Simple Delegation Scheme (SiDeS). Both
MSW and SiDeS use counters to control delegated time, it may not be very accurate. In
this paper, we try to utilize the timestamp to fix the problem.
1.1 Security Requirements
Here shows that the RFID authentication protocol should achieve the following se-
curity features and resist some attacks.
• User Privacy: It involves anonymity and untraceability. Anonymity means that
secret information should not be leaked from the tags. Untraceability means that
adversaries cannot use some information that tags sent out to trace those tags.
• Unlinkability: Messages sent by the tag are not linkable. It means that an adversary
cannot distinguish that two messages are sent by the same tag or different tags.
• Substantive Privacy: When a tag is compromised, leaked information from the tag
cannot help the adversaries to compromise other tags.
• Forward Privacy: Assume that a tag is compromised, and the secret keys are re-
vealed. Forward privacy ensures that the messages transmitted before will still keep
secure.
• Data Integrity: Data loss may happen by the DoS attack, power interruption, or
message hijacking etc. Thus, the protocol must provide the property of data recovery
2
Figure 1: RFID system model
• Tag: it is a wireless transponder; its energy comes from the signal of the reader.
When the tag receives the incoming signal, it will broadcast a response to the nearest
reader.
• Reader: it is a transceiver; it broadcasts signals to the tags, and receives the reponse
signals. The reader can send information via a secure channel to communicate with
the backend system.
• Backend system: it is a trusted entity. We can assume that this system cannot be
compromised. This system is responsible for identifying tags, and it can also go
through a secure channel to communicate with the reader. The backend system
can transmit information to mobile devices via a secure channel in local location,
and can transmit message to mobile devices through general channel in out-side
location.
• Mobile device: like notebooks, PDAs, and mobile phones. It acts as a reader role,
4
Figure 2: Identification phase
6
compute a delegation table (see Table 3) and send it to the mobile devices via a secure
channel. The delegation table includes delegation time Tx, Ht, and Ktemp i, but not the
tag key.
Table 3: Delegation table
Tag1 Tag2 ... Tagn
Tx = 1 H1,1 H1,2 ... H1,n
Tx = 2 H2,1 H2,2 ... H2,n
... ... ... ... ...
Tx = m Hm,1 Hm,2 ..... Hm,n
Ktemp i = HKi(Ki, IDr), Ha,b = HKb(Tx, IDr),
where Tx = a, a = 1, 2, ...m, b = 1, 2, ...n
The tag identification phase is showed in Figure 3.
Step 1. Backend system ← PDA : Request
First, the PDA will send a request to the backend system.
Step 2. Backend system → PDA : Tx, Sx
Once the backend system receives the request, it will confirm the identity. If it is
legal, it will send the timestamp Tx and the system key Sx to the PDA, where x is
the x-th time interval.
Step 3. PDA → Tag : IDr, Rr, Tx, Sx
When PDA receives Tx and Sx, it will choose a random value Rr, and sends
IDr, Rr, Tx, Sx to the tag, where IDr is PDA’s identity.
Step 4. PDA ← Tag : Rt, Ht
Once the tag receives IDr, Rr, Tx, Sx, it will compute i = Tx − Tt. If i > 0 and
H i(Sx) = St, the tag lets Tt = Tx, St = Sx, Ki = H
it(Ki), and sends Ht =
HKi(Tx, IDr) to the PDA. Otherwise, if i ≥ 0, the tag will compute Z = H i(Ki),
and use Z and IDr to compute Ktemp i = (Z, IDr). Finally, the tag computes
Ht = HKtemp i(Rr, Rt) and sends Ht to the PDA.
8
Step 5. PDA identifies tag
When the PDA receives Rt and Ht, it will pass Rr, Rt, Tx, Ht to the backend system.
The backend system will search the delegation table (See Table 3) to find the same
Tx in the rows. If the same Ht is found in the row, it means that the PDA identifies
the tag successfully. If the PDA cannot find the same Ht in the row, it will use all
tags’ temporary key Ktemp i to compute H
′
t = HKtemp i(Rr, Rt) until H
′
t = Ht. If
H ′t = Ht, it means that the PDA identifies the tag successfully.
3 Security analysis
We analyze the security of the proposed protocol as follows:
• User privacy: In the proposed protocol, the tag generates a new response Rt and
Ht for every reader query, where Ht = HKi(Tx, IDr) or Ht = HKtemp i(Rr, Rt). The
adversary cannot identify or track the tag by using the response of the tag, because
Rr and Rt are random numbers, and the value of Tx will change all the time.
• Unlinkability: In the proposed protocol, the tag will generate a new response for the
reader’s query. An adversary is unable to distinguish whether the messages from
the same tag or not.
• Substantive privacy: When a tag is compromised, an adversary cannot use Ki to
compromise other tags. That is because that all tags’ secret keys Ki are different
in the proposed protocol.
• Forward privacy: When a tag is compromised, it is helpless for the adversary to
reveal the previous information of the tag. It comes from that the tag’s key will
change in each time interval, where Ki = H
i(Ki).
• Data integrity: Once an adversary breaks the communication between the tag and
the reader, the proposed protocol still can identify the tag.
• Delegation: The proposed protocol can authorize mobile devices to identify tags.
• Resist replay attack: The adversary cannot generate a legal Sx. Hence, he only can
obtain Ht = HKtemp i(Rr, Rt). When a legal reader wants to query a tag, the reader
will send a random number Rr to the tag. Rr cannot be controlled by the adversary
10
to identify tags. That is, the mobile RFID reader can identify tags without the on-line
help of the backend system. Finally, the comparisons among the [4][11] and our protocol
are given.
Acknowledgements
This research was supported in part by the National Science Council of Republic of China
under the contract numbers NSC96-2628-E-218-002-MY2.
References
[1 ] A. Juels, “RFID Security and Privacy: A Research Survey”, IEEE Journal on Selected
Areas in Communications, Vol. 24, No. 1, pp.381-394, 2006.
[2 ] A. Juels and R. Pappu, “Squealing Euros: Privacy Protection in RFID-Enabled
Banknotes”, Lecture Note in Computer Science Financial Cryptography 2003, pp:
103-121, 2003.
[3 ] D. H. Choi, T. S. Kim, and H. W. Kim, “Privacy protection for secure mobile RFID
service”, International Symposium on Wireless Pervasive Computing, 2006.
[4 ] D. Molnar, A. Soppera, and D. Wagner, “A Scalable, Delegatable Pseudonym Proto-
col Enabling Ownership Transfer of RFID Tags”, in Selected Areas in Cryptography,
SAC2005, pp.276-290, 2005.
[5 ] D. Molnar and D. Wagner, “Privacy and security in library RFID: issues, practices,
and architectures”, ACM conference on Computer and communications security,
pp.210-219, 2004.
[6 ] H. Knospe and H. Pohl, “RFID Security”, Information Security Technical Report,
Vol. 9, No. 4, pp.39-50, 2004.
[7 ] K. Finkenzeller, “RFID Handbook: Fundamentals and Applications in Contactless
Smart Cards and Identification 2nd Edition”.
[8 ] M. Conti, R. D. Pietro, L. V. Mancini, and A. Spognardi, “RIPP-FS: An RFID
Identification, Privacy Preserving Protocol with Forward Secrecy”, International
12
出席國際學術會議心得報告 
                                                             
計畫編號 NSC 96－2628－E－218－002－MY2 
計畫名稱 條件式模糊群播協定之研究 
出國人員姓名 
服務機關及職稱 李南逸 南台科技大學 資訊管理系 教授 
會議時間地點 July 7-9, 2008 
會議名稱 2008 International Conference on Business and Information (BAI2008) 
發表論文題目 
1. Ordinal Authentication Protocols for RFID Tags 
2. Fatherhood Web Community Based on Web 2.0 - Creative Cool-Pa
Community 
 
計畫編號 NSC 96－2628－E－218－002－MY2 
計畫名稱 條件式模糊群播協定之研究 
出國人員姓名 
服務機關及職稱 李南逸 南台科技大學 資訊管理系 教授 
會議時間地點 July 10-11, 2008 
會議名稱 The 3rd Joint Workshop on Information Security (JWIS2008) 
發表論文題目 Undeniable signature with a reusable subliminal channel 
 
由於 2008 International Conference on Business and Information (BAI2008)與 The 
3rd Joint Workshop on Information Security JWIS2008 兩個國際會議皆在韓國首都首爾舉
辦，且舉辦日期剛好連續、不相重疊，所以就將相關的研究論文投稿至此兩個國際會議，
希望藉由此次出國機會認識更多國際著名研究學者並收集到最新的研究資料。 
 
2008 International Conference on Business and Information (BAI2008)國際會議共
收到 39 個國家近 700 篇論文投稿，每篇論文也都有 2 位以上之審查委員，共 465 篇論
文被接受，因此投稿兩篇論文皆被接受，實屬相當難得。BAI2008 今年在韓國首爾市舉
辦，7 月 7 日為報到，7 月 8 日、9 日會議正式進行，由發表論文眾多，共有 53 個 session
要在 2 天內安排完畢，所以會議行程相當緊湊，所有聽眾都只能擇有興趣且相近的研究
論文旁聽，我們所發表的論文為： 
Ordinal Authentication Protocols for RFID Tags 
Fatherhood Web Community Based on Web 2.0 - Creative Cool-Pa Community 
與會學者雖未對我們的論文提出挑戰或意見，但與會研究學者專家都仔細研究
 
of products are not enough on the shelf since he/she can continually monitor
the status of products on the shelf by the RFID system.
Since RFID tags can be queried without contacting with a reader, many
research works are now concerned with privacy problems [1][3][4][6][8][11]. If
a user carries the product with an RFID tag, the adversary can easily track
his/her location or record his/her habits. Thus, some researchers have pro-
posed the protocols [5][7][8][10][11] with cryptographic technologies to protect
users or manufacturers from malicious behaviors such as forgery, tracking, and
replay attack, etc. In 2004, Juels [2] ﬁrst proposed an authentication protocol
to prove the simultaneous presence of two tags to an RFID reader. For exam-
ple, assume that a speciﬁc product consists of two separate components. Both
components must be used together to take eﬀects. Accordingly, it is neces-
sary to ensure that both components are present before buying/using it. The
study of authenticating the simultaneous presence of two tags thus becomes
important. Unfortunately, Saito and Sakurai [9], in 2005, pointed out that the
Juels protocol cannot withstand the replay attack, and further proposed an
improved protocol based on timestamp. Moreover, an authentication protocol
for multiple (larger than two) tags is also given.
However, according to this paper’s analysis, an adversary can easily observe
and predict the transmitted timestamp in the Saito and Sakurai protocol. Con-
sequently, the adversary can try to send a timestamp to the tag and obtain
a valid veriﬁcation value for malicious purposes. Besides, previous protocols
2
Figure 1: Arrangement phase
2.1 Ordinal double tags authentication protocol
The proposed ordinal double tags authentication protocol is shown in the Fig-
ure 1 and Figure 2.
Arrangement phase:
Step 1. The reader broadcasts a request signal to check the presence of a
couple of tags.
Step 2. Once receiving the signal, tag A and tag B will respectively generate
random numbers, ntA and ntB , and reply them to the reader.
Step 3. When the reader receives the random numbers ntA, and ntB, it will
decide the communication sequence. Whatever the reader ﬁrst receives
will be its priority. If the random numbers are received at the same time,
the reader will randomly decide the sequence.
Step 4. Without loss of generality, we assume that the reader chooses tag A
as the ﬁrst priority. Then, the reader generates a random number nr,
4
veriﬁcation, where PAB=(ntA, ntB, nr, mA, mB).
Step 4. The backend server will search a possible key K ′S from the database
to compare whether mA= HK ′S(nr, ntA, ntB) and mB=HK ′S(mA, nr, ntB)
or not. If both are correct, the backend server can ﬁnd the identities of
tags and ensure that both tags are present.
2.2 Ordinal multiple tags authentication protocol
The following will introduce an ordinal multiple tags authentication protocol
which is an extension of the protocol in the Section 2.1. It is also shown in the
Figure 3.
Arrangement phase:
1. Pallet tag and product tagsi, 1 ≤ i ≤ n, share the same secret key KS.
2. Each product tags i store a veriﬁcation value Vi (1 ≤ i ≤ n), and pallet tag
stores V , where V=V1
⊕
V2
⊕
. . .
⊕
Vn.
Veriﬁcation phase:
Step 1. The reader generates a random number nr, and sends PalletProof and
nr to the pallet tag.
Step 2. Once receiving nr, the pallet tag generates a random number ntP , and
replies a mP ,and ntP to the reader, where mP=HKS(nr, ntP ).
6
3 Security Analysis
• Product privacy: In the DTAP+ and GTAP+, each tag can generate
a new random number when the reader broadcast a query. As the result,
the adversary cannot distinguish messages from the same tag or diﬀerent
tags, and then collect related product information. Thus, our proposed
protocol can ensure product privacy.
• Unlinkability: In the DTAP+ and GTAP+, the reader and each tag
can generate a new random number. It is diﬃcult to track a particular
couple of tags or group tags, and use past messages to link to a couple
of tags or group tags. Therefore, our proposed protocol can promise the
property of unlinkability.
• Resist replay attack: Since the adversary can eavesdrop the commu-
nication between the reader and the tag, he/she can acquire transmitted
data. However, the gather messages cannot be used in the next time.
That is because those transmitted data contain fresh random numbers
which is controlled by the reader. Thus, the proposed protocol can with-
stand the replay attack.
• Resist forgery attack: Except for destroying the tag and obtaining
secret information, the adversary cannot utilize public information to
masquerade as a couple of tags or one of tags.
• Resist predicted time attack: In the Saito and Sakurai, the reader
8
References
[1] Simson.L. Garﬁnkel, Ari Juels and Ravi Pappu, ”RFID privacy:An
Overview of Problems and Proposed Solutions”, Security and Privacy
Magazine, page(s):34-43, 2005.
[2] Ari Juels, ”Yoking-Proof for RFID tags”, Procedings of the Second IEEE
Annual Conference on Pervasive Computing and Communications Work-
shop, page(s):138-143, 2004.
[3] Ari Juels, David Molnar, and David Wagner, ”Security and Privacy Issues
in E-passports”, Security and Privacy for Emerging Areas in Communi-
cation Networks, page(s):74-88, 2005.
[4] Ari Juels, ”RFID Security and Privacy: A Research Survey”, IEEE Jour-
nal on Selected Areas in Communication, page(s):381-394, 2006.
[5] Ari Juels and Ravikanth Pappu, ”Squealing Euros: Privacy Protection in
RFID-Enabled Banknotes”, Lecture Note in Computer Science Financial
Cryptography 2003, page(s):103-121, 2003.
[6] Heiko Knospe and Hartmut Pohl, ”RFID Security”, Information Security
Technical Report, page(s):39-50, 2004.
[7] David Molnar and David Wagner, ”Privacy and security in library RFID:
issues, practices, and architectures”, Proceedings of the llth ACM confer-
ence on Computer and communications security, page(s):210-219, 2004.
10
Undeniable Signature with a Reusable
Subliminal Channel
Narn-Yih Lee1, Pei-Hsiu Ho2 and Dai-Rui Lin2?
1 Department of Information Management,
Southern Taiwan University,
Tainan County 710, Taiwan, R.O.C.
2 Department of Computer Science and Engineering,
National Sun Yat-sen University,
Kaohsiung County 804, Taiwan, R.O.C.
{Narn-YihLee}nylee@mail.stut.edu.tw
Abstract. In 1983, Simmons first introduced the concept of the sub-
liminal channel. Since then, many researches of embedding subliminal
channels in digital signatures have been proposed. However, only a fixed
number of subliminal messages can be hidden in a digital signature and
the content of the subliminal messages cannot be changed after the sig-
nature is generated. Moreover, the sender has to share a secret key with
the subliminal receivers. Chaum and van Antwerpen, in 1989, proposed
the concept of the undeniable signature which cannot be verified without
the signer’s cooperation. Later, Chaum also proposed a zero-knowledge
undeniable signature scheme. The aim of the paper is to integrate sublim-
inal channels with an undeniable signature. The undeniable signatures
can be used to hide subliminal messages repeatedly. Namely, the sublim-
inal channel is reusable. Moreover, the sender does not need to share any
secret key with the subliminal receivers.
Key words: Cryptography, Covert communication, Digital signature,
Undeniable signature, Subliminal channel
1 Introduction
The concept of the subliminal channel was first introduced by Simmons [1] in
1983. The subliminal channel is a covert communication channel that allows
a sender to transmit a secret message to an authorized receiver. This secret
message, called subliminal message, is hidden in other messages and cannot be
discovered by any unauthorized receiver. Several applications may benefit by
using subliminal channels. For example, a credit card provider can hide card
holder’s credit history and credit limit in a digital signature for an issued credit
card [3].
? This work was supported in part by NSC96-2628-E-218-002-MY2 and NSC 96-2219-
E-006-009
Lecture Notes in Computer Science: Authors’ Instructions 3
provides more than one subliminal channels for the signer. This is the first scheme
combined subliminal channels with convertible undeniable signatures.
The aim of the paper is to invent a reusable subliminal channel based on a
modified zero-knowledge undeniable signature scheme. It has many applications,
i.e., the seller can make the expiration date, serial number and other informa-
tion of the product embedding in subliminal message, and signs a signature on
product. Then, the legal buyer can not only verify the signature with the seller
but also can get the information of the product from the subliminal message.
This work can prevent to disseminate the product by the illegal user.
It has the following advantages.
(a) The sender does not need to share his/her signing key with the subliminal
receivers.
(b) The subliminal channel is reusable. Namely, the sender does not need to
create a new undeniable signature for transmitting a new subliminal message
to a new subliminal receiver.
(c) The sender does not need to decide who the subliminal receivers are before
generating digital signatures.
The organization of the paper is as follows. The proposed scheme and security
analysis are presented in Section 2 and Section 3, respectively. Finally, Section
4 concludes this paper.
2 Reusable Subliminal Channel
We will embed a subliminal channel on the modified Chaum’s zero-knowledge
undeniable signature scheme [10]. The scheme is divided into five phases, Initial-
ization phase, Signature generation phase, Signature confirmation phase, Signa-
ture disavowal phase and Subliminal message recovery phase. We describe them
in detail as follows.
Initialization phase: Assume that a sender S and a verifier V in the system.
Let p be a large prime and α be a primitive element in GF (p). h(.) is a one-way
function. There are three types of cryptographic keys in the system. The first is
used for generating undeniable signatures. The second is used in Diffie-Hellman
key-exchange protocol [12]. The last is used in a general public key cryptosystem,
like RSA [13] or ElGamal system [14].
The sender S first chooses a random signing key xs, xs ∈ Z∗p , for generating
undeniable signatures. The corresponding public key ys is computed as follows.
ys = αxs mod p.
Then, S chooses another random secret key ks for the Diffie-Hellman key-
exchange protocol and computes the public key Ts = αks mod p. Finally, S
chooses a key pair (sks, pks) for a public-key cryptosystem. Encryption and
decryption with the public-key cryptosystem are denoted by Epk(.) and Dsk(.),
respectively.
Signature generation phase: Assume that S wants to sign a message M , where
1 < M < P . The sender S computes z =Mxs mod p as the undeniable signature
of M and then sends M and z to a verifier V.
Lecture Notes in Computer Science: Authors’ Instructions 5
number generator. The random number generator is hopefully to yield ran-
dom numbers which are polynomially indistinguishable from ciphertexts.
Then, the distribution of the output random number is computationally
indistinguishable from the distribution in the probabilistic public key cryp-
tosystem. Then, no one can recognize the subliminal message and random
number in a polynomial time. Thus, no outsider is aware whether a signature
involves any subliminal message or not.
(3) The common session key Tsv cannot be computed except S or V.
The session key Tsv is computed by the equation Tsv = T kvs mod p = T
ks
v
mod p. The kv and ks are the verifier’s and sender’s secret keys, respectively.
It is hard to compute Tsv from Ts and Tv, unless he/she can break the Diffie-
Hellman key exchange protocol [12]. On the other hand, if an attacker wants
to get Tsv, he/she has to invert the hash value h(Tsv,M). However, it is
infeasible because h(.) is a one-way hash function.
(4) An attacker cannot pretend to be the sender to transmit subliminal messages
to subliminal receivers.
If an attacker wants to pretend to be the sender, he/she has to compute
R1 = Wαδ·Tsv mod p in the Step 2 of the Signature confirmation phase.
However, it is very hard for the attacker to compute Tsv according to the
above analysis (3). Thus, the verifier will not believe that the undeniable
signature is valid and comes from the real sender. So, the forgery will not be
successful.
(5) The meddler attack [15] cannot work.
The meddler attack in [15] is that a malicious verifier V with the help of the
sender can convince another verifier V* the validation of the undeniable sig-
nature. The sender will believe that he/she is confirming with V, but he/she
is confirming with V* in fact. In the proposed scheme, we use a common ses-
sion key Tsv to avoid the meddler attacker. Since the sender and the verifier
V* will use different session keys Tsv and Tvv∗, the undeniable signature will
not be confirmed during the Signature confirmation phase.
Then, we check the security of the proposed scheme of the verifier’s and
sender’s point of views, respectively.
From the verifier’s point of view, the subliminal message must be sent from
the sender. If the subliminal message is sent from the forge sender, the verifier
cannot get the subliminal message, because the forge sender doesn’t know
nothing about Tsv. This attack can not work and it is described in (4). No
one can forge the verifier to get the subliminal message. If the forge verifier
can get ciphertexts of the subliminal message from the sender, he/she also
cannot get the plaintexts of the subliminal message, because no one knows
Tsv except verifier and sender. It is also described in (1) and (3).
From the sender’s point of view, the verifier cannot be forged by the attacker.
If the verifier is forged, he/she only can confirm the signature that is the
sender sent. The forge verifier cannot get the plaintexts of the subliminal
message, because he/she doesn’t know Tsv. Our scheme can be prevented
the above attack. It is described in (1), (3) and (5).
Lecture Notes in Computer Science: Authors’ Instructions 7
6. Digital Signature Standard, Federal Information Processing Standard, Publication
186, NIST, 1994.
7. G.J. Simmons, Results Concerning the Bandwidth of Subliminal Channels, IEEE
J. Select. Areas Common., Vol.16, No.4, pp.463-473, 1998.
8. T. Okamoto, A Fast Signature Scheme based on Congruential Polynomial Opera-
tions, IEEE Trans. Inf. Theory, Vol. 36, No.1, pp.47-53, 1990.
9. D. Chaum and H.V. Antwerpen, Undeniable Signature, Proc. Crypto’89, pp.212-
217, 1989.
10. D. Chaum, Zero-knowledge Undeniable Signature, Advances in Cryptology, EU-
ROCRYPT’90. Springer-Verlag, pp. 458-464, 1991.
11. N.Y. Lee and D.R. Lin, Robust Digital Signature Scheme with Subliminal Chan-
nels, IEICE Trans. Fundamentals, Vol.E86-A No.1, pp.187-188, 2003.
12. W. Diffie and M. E. Hellman, New Directions in Cryptography, IEEE Trans. on
Inf. Theory, Vol. IT-22, No. 6, pp.644-654, 1976.
13. R. L. Rivest, A. Shamir and L. Adleman, A method for Obtaining Digital Signa-
tures and Public Key Cryptosystems, Communications of the ACM, Vol. 21, No.
2, pp.120-126, 1978.
14. T. ElGamal, A Public Key Cryptosystem and a Signature Scheme based on Dsi-
crete Logarithms, IEEE Trans. on Inf. Theory, Vol. 31, No. 4, pp.469-472, 1985.
15. Y. Desmedt and M. Yung, Weaknesses of Undeniable Signature Schemes, Lecture
Notes in Computer Science 547, Proc. Eurocrypt’91, Springer Verlag, pp. 205-220,
1992.
16. N. Y. Lee and P. H. Ho, Convertible Undeniable Signature with Subliminal Chan-
nels, Applied Mathemantics and Computation, Vol. 158, Issue 1, pp.169-175, 2004.
17. Z. Wang and W. Gao, Perfect Subliminal Channel in a Pairing-Based Digital Sig-
nature, Asian Journal of Information Technology Vol.5, No.4, pp. 392-395, 2006.
International Conference on Business and Information 自從 2004 年第一次在台北劍
潭青年活動中心舉辦以來，今年已是第六屆，每年舉辦的地點皆有不同，明年規劃辦理
的地點將會在日本的 Kitakyushu，可以預期的是將又會是全球專家學者的一大盛會，會
中亦邀請與會人士繼續予以支持，並將優秀的研究論文投至明年的 BAI2010，進一步做
全球學術交流。 
 
最後吾人要感謝國科會對於我們的研究經費之支持與協助，若無國科會之協
助，本次國際交流可能就無法成行，所以在此再一次的感謝國科會，讓我們能夠順利參
與 BAI2009 國際會議並進行相關報告與交流活動。以下為出席 BAI2009 的相關照片，與
台灣同往馬來西亞之資訊安全專家學者合影之照片。 
 
 
Reliable Delegation Scheme for RFID Systems
Narn-Yih Lee, and Zong-Jhih Lin
Information Management Department, Southern Taiwan University,
Tainan County 710, Taiwan, R.O.C.
Email: nylee@mail.stut.edu.tw
m9490227@webmail.stut.edu.tw
Abstract
Radio Frequency Identification (RFID) system is an automatic and contactless
technology. However, RFID systems also introduce new privacy and security risks.
Many papers have tried to propose various RFID authentication mechanisms to
solve the RFID privacy issues. In 2005, Molnar et al. first presented the property
of delegation. In 2007, Fouladgar and Afifi proposed a simple delegation scheme
for RFID systems. The scheme utilizes a counter to control delegation time, but
it cannot accurately control the delegation time. In this paper, we aim to use the
timestamp to control delegation time and enhance the security of the RFID systems.
key words: Cryptography, Delegation, RFID, Timestamp, Security.
1 Introduction
Radio Frequency Identification (RFID) is an automatic identification technology. In
2006, Juels [1] indicated that RFID has two advantages compared with barcode tech-
nology. First, each RFID tag has a unique identity (ID), while a barcode only exhibits
the type of products. The unique ID can help to search related information of the prod-
ucts, such as manufacture date or expiration date. It gives customers well support for
products. Second, RFID is an automatic system which can identify products without line-
of-sight contact. Due to the above advantages, RFID system has become an important
and popular technology in 21st century.
RFID has brought much convenience in our life. For example, RFID can help cus-
tomers to quickly finish payment procedures. RFID also can help staffs gather inventory
1
to avoid any failure.
• Delegation: The backend system can authorize to others to identify the identities
of tags.
• Replay attack: It means that a third party can obtain some information through
the eavesdropping method. Then, the third party transmits the information to the
RFID reader to achieve the purpose of cheating later.
• Man-in-the-middle attack: It means an adversary locates between a legal tag and a
reader. He uses an illegal reader to obtain the communicated data transmitted by
the tag. After obtaining the information, he can impersonate the legal tag to cheat
any legal reader.
• Denial of Service attack: It only tries to bother the backend system and make the
system unable to provide services to authorized users.
• Forgery attack: It means that an adversary tries to use some methods of forgery to
impersonate tags to cheat readers.
1.2 Our Contributions
This paper tries to use the timestamp to control the delegated time. The times-
tamp obviously has the advantages than counter to provide more accurate authorization.
Besides, the proposed protocol can satisfy the mentioned security requirements, and use
pre-computation to speed up tags identification. The next section presents the proposed
protocol. Section 3 analyzes the security of the proposed protocol. The final is a conclud-
ing remark.
2 The Proposed Protocol
2.1 RFID model and Notations
The proposed RFID system includes four entities: tags, readers, backend system,
and mobile devices. The illustration is showed in the Figure 1.
3
and it has sufficient capacity to store information from the backend system to iden-
tify tags.
We use the notations as summarized in the table 1 through out the paper.
Table 1: Notations
Backend system RFID system’s backend system
Reader RFID system’s reader
RFID Tag System’s tags
H(.) One-way hash function
H i(x) H3(x) = H(H(H(x)))
IDr Reader’s identity
Tx Timestamp in time interval x
Sx System’s secret key in time interval x
Ktemp i Tag’s temporary key
PRNG Random number generator
2.2 Initial phase
The proposed protocol uses the Lamport hash chain [9] to prove the identity of the
reader. Before deploying the tags, the backend system will compute a long hash chain,
S0, S1, ..., Stop, with a random seed a.
Stop = a,
Sx = H(Sx+1) = H
top−x(a), where x = 0, 1, ..., top− 1
For example, S1 = H(S2) = H
9(S10)
All tags share a unique key Ki with the backend system, and know the value S0 and
T0 through a secure channel.
2.3 Identification phase
The proposed protocol is shown in Figure 2.
5
Step 1. Reader → Tag : IDr, Rr, Tx, Sx
The reader chooses a random value Rr, and sends IDr, Rr, Tx, Sx to the tag, where
IDr is the reader’s identity. (The backend system lets all readers keep the same
IDr.) Tx is the timestamp, Sx is the system key.
Step 2. Reader ← Tag : Rt, Ht
Once the tag receives IDr, Rr, Tx, Sx, it will compute i = Tx − Tt. If i > 0 and
H i(Sx) = St, the tag will update data, compute Tt = Tx, St = Sx, Ki = H
i(Ki), and
sendHt = HKi(Tx, IDr) to the reader. Otherwise, the tag will compute Z = H
i(Ki),
and use Z and IDr to compute Ktemp i = (Z, IDr). Finally, the tag computes
Ht = HKtemp i(Rr, Rt) and sends Ht to the reader.
Step 3. System → Reader : Rr, Rt, Tx, Ht
When the reader receives Rt and Ht, it will pass Rr, Rt, Tx, Ht to the backend sys-
tem. The backend system will search the look-up table (See Table 2) to find the
same Tx in the rows. If the same Ht is found in the row, it means that the backend
system identifies the tag successfully. If the backend system cannot find the same
Ht in the rows, it will use all tags’ key to compute Ktemp i = HKi(Ki, IDr), where
Ki is the tag’s key at the time interval Tx. Finally, the backend system will compute
H ′t = HKtemp i(Rr, Rt) until H
′
t = Ht. If H
′
t = Ht, it means that the backend system
identifies the tag successfully.
Table 2: Look-up table in the backend system
K1 K2 ... Kn
Tx = 1, Ki = H(Ki) H1,1 H1,2 ... H1,n
Tx = 2, Ki = H
2(Ki) H2,1 H2,2 ... H2,n
... ... ... ... ...
Tx = m,Ki = H
m(Ki) Hm,1 Hm,2 ..... Hm,n
Ha,b = HKb(Tx, IDr), where Tx = a, a = 1, 2, ...m, b = 1, 2, ...n
2.4 Delegation phase
The proposed protocol allows the backend system to delegate mobile devices to
identify RFID tags. When the backend system wants to delegate a mobile device, it will
7
Figure 3: Tag identification phase
9
and the tag must reply according to the random number Rr. Thus, the adversary
cannot use the legal tag’s response to cheat the legal reader.
• Resist man-in-the-middle attack: The adversary inserts an illegal reader between a
legal tag and a legal reader to eavesdrop the communication. Those transmitted
messages are unable to be distinguished without the correct Ki. Since the adversary
cannot obtain the secret key Ki, he cannot impersonate a legal tag to cheat a legal
reader.
• Resist Denial of Service attack: Assume that an adversary tries to break the back-
end system, he interrupts the signal that the mobile device generates. Although
the mobile device cannot connect to the backend system, it still can identify tags.
Therefore, the proposed protocol can resist DoS attack.
• Resist forgery attack: In the proposed protocol, it does not leak any secret infor-
mation during the communication between the reader and the tag. As a result,
adversaries cannot cheat the legal reader to impersonate as a legal tag.
Table 4: Comparisons of security properties
MSW[4] RIPP-FS[8] SiDeS[11] Ours
User privacy O O O O
Unlinkabilty O O O O
Substantive privacy O O X O
Forward security X O X O
Data integrity O O O O
Delegation O X O O
Resist forgery attack X O X O
Resist replay attack X O X O
Resist Man-in-the-
middle attack
X O X O
Resist DoS attack X O O O
4 Conclusions
In this paper, we have utilized the timestamp to control delegation time for RFID
system. The proposed protocol can resist known attacks that include replay attack, man-
in-the-middle attack, DoS attack, and forgery attack, and it can delegate mobile device
11
