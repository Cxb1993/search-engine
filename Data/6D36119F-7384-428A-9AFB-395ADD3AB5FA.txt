一、 中、英文摘要與關鍵字 
微型銑刀為一種切削 PCB 電路板之重要工具，生產業者根據不同的客戶需
求，生產符合該客戶需求規格之銑刀。目前品管作業是以人工進行量測，在工業
科技日益精密的情況下，微型銑刀之直徑越來越小，也增加人工量測之困難度。 
本研究計畫的目的運用電腦視覺方法，發展出一套自動光學量測系統，設計
並運用影像處理方法擷取銑刀魚尾端面上之特徵點，基於這些特徵點計算出銑刀
特徵值，實驗結果顯示，能快速而客觀有效的量測出微型銑刀成品魚尾端面上之
特徵值，避免人工量測所造成之誤差，進而確保銑刀成品之品質。計畫所研發完
成之機台，可針對不同刃數與尺寸之銑刀魚尾端面特徵值包括右刃溝深、前周角
與間隙進行快速、精確且穩健的自動量測。 
關鍵字: 微型銑刀、魚尾端面、電腦視覺 
Microrouter is an important tool used to cut a printed circuit boards (PCB). The 
microrouter manufacture produces a variety of microrouters to fulfill distinct 
customers’ requirements. Traditional quality control on the microrouter still depends 
on human inspectors. As the diameter of the microrouter gets smaller, it is more 
difficult for human inspectors to examine the microrouter’s quality. 
In this project, we proposed an auto-optical measurement system by using 
machine vision method for measuring the feature. The designed and developed  
system can capture the feature points of microrouter fishtail. And the feature values 
on the microrouter, including right hook deep (RHD), the rake and the gap, can be 
computed. Experimentation results revealed that the developed measurement system 
can accurately, effectively and robustly measure the features of microrouter in 
different sizes and different types. 
Keywords: microrouter, fishtail, machine vision 
二、前言 
微型銑刀主要用於銑床上加工平面、台階、溝槽、成形表面和切斷工件等。
在工業科技日益精密的情況下，對於電路板的品質要求也越來越嚴格，由於用於
切削電路板之微型銑刀會影響電路板品質，所以銑刀之重要性隨著 PCB 的需求
增加而越來越顯著。 
 
圖 1 微型銑刀側視示意圖 
圖 1 為銑刀成品側視示意圖，分為刃身與魚尾兩部份，直徑為 1 公釐（mm）。
製造過程中會經砂輪依下述三道程序進行機械加工:右刃加工、左刃加工、魚尾
加工，如圖 2 所示。 
2 
 
光源
鏡頭
影像形成裝置
電子攝影機
影像擷取
介面卡 影像處理器
週邊及輸出裝置
主電腦
待測工件
 
圖 4 典型視覺系統架構 
影像形成裝置包含了電子攝影機與鏡頭，根據需求挑選適當倍率之電子攝影
機與鏡頭。好的光源環境可以突顯待測工件的特徵，提高影像之對比度，降低後
續影像處理的複雜度。不同的待測工件表面材質，有其適合之打光方式，常見的
光源架設方式有以下幾種[7]，圖 5 為其示意圖，本研究將參考這些打光方式，
設計最適用於本研究使用之光源架構。 
1.  前照式(Front lighting)：光源與 CCD 在物體之同側，利用光線反射強弱的不
同，常作為檢測物體表面特徵時之照明。 
2.  背照式(Back lighting)：光源與 CCD 在物體的不同側。使物體產生對比強烈
的輪廓線。 
3.  側照式(Side lighting)：光源放在物體的側面，光源的照射方向與物體平面近
乎平行。常作為突顯待檢測物體幾何性質之用。 
 
環形光源
背光源
物件
物件
CCD CCD
物件
CCD
環形光源
側照式背照式前照式  
圖 5 常見打光方式示意圖 
(2) 影線分割 
4 
 
於光源系統不均勻的情況，對於因光源系統不均勻所造成之影像模糊或陰影，有
較佳之處理結果。 
適應性閥值其閥值的選取方法有許多種，其中一種方法為 Ahmad and Choi[1]
使用之局部性閥值(local threshold)，影像中的像素點 其二值化步驟如下: 
Step 1:使用平均濾波器公式(1)求得平均值   
 
    為原始影像像素點座標 之灰階值， 為遮罩大小。 
Step 2:依據公式(2)求得局部性閥值  
 
Step 3:依據公式(3)求得二值化結果  
 
(3) 膨脹和侵蝕(Dilate and Erode) 
膨脹(Dilate) [4]運算是藉由結構元素使影像中目標物進行擴張的影像處理方
法，定義如下: 
⎭⎬
⎫
⎩⎨
⎧ ∈∈−−+−−=⊕ gf DtsDtysxtsgtysxfyxgf ),(;)(),(|),(),(max),)((   (4) 
侵蝕(Erode)[4]運算則是藉由結構元素使影像中目標物縮小的影像處理方
法，定義如下: 
f( Θ  (5) ⎭⎬
⎫
⎩⎨
⎧ ∈∈−−+−−= gf DtsDtysxtsgtysxfyxg ),(;)(),(|),(),(min),)(
其中 代表灰階影像， 為進行影像之膨脹與侵蝕的結構元素，
和 分別為 與 的定義域，膨脹其最簡單的應用之一是在橋接縫隙，侵蝕則是
用於除去二元影像裡的雜訊。 
 
(4) 斷開和閉合(Open and Close) 
6 
 
(a)
(b) (c)
(d) (e)
圖 8 閉合運算(Close)說明圖 
 
 
四、右刃溝深與前周角特徵值量測 
銑刀魚尾端面之特徵值量測，根據不同的加工時間點可區分為兩個階段，第
一階段之時間點為銑刀進行右刃加工後、尚未進行左刃加工及魚尾加工前；第二
階段之時間點為銑刀完成前述三道機械加工後。右刃溝深和前周角可在第一階段
進行量測，而間隙則需在第二階段進行量測。本研究計畫分別針對兩階段之量
測，提出適用之硬體架構設計與視覺檢測演算法。 
(1)右刃溝深與前周角特徵值定義 
參照圖 9，選定欲量測之魚尾端面刀刃，該刀刃之刃尖為圖形中之 A 點，其
相鄰左右二側刀刃之刃尖分別為 C、D 兩點，以一線段連接 C、D 兩點得一CD，
將CD從選定刀刃尖 A 點平移至此刀刃底部 A’點得另一線段 'C ，由 A 點至'D ''DC 之
垂直距離即為右刃溝深。 
C D
A
右刃溝深
A＇
 
圖 9 右刃溝深示意圖 
參照圖 10，找一點 B 位於銑刀輪廓上，且距離該刀刃之刃尖(圖形中 A 點)
垂直距離 1/3 右刃溝深處。過 B 點做一直線垂直CD，垂足為 P 點，則 AP 與 BP之
夾角即為前周角。 
8 
 
圖 12 魚尾端面影像 
(3)量測演算法 
量測演算法流程如圖 13 所示。 
 
圖 13 右刃溝深與前周角特徵值量測演算法流程圖 
其中影像二值化部份，本研究採用適應性閥值法(Adaptive Thresholding)選取
閥值。透過此法，可將影像中的銑刀與背景分離出來。接著應用邊界擷取法獲得
銑刀輪廓資訊，完成邊界擷取後對所有輪廓點進行編號並儲存輪廓點資訊。接著
以最小外接圓方法(Minimum Enclosing Circle)[2]，求得一個包含魚尾端面且面積
為最小的圓，定義為銑刀魚尾端面之外接圓。接著將銑刀魚尾端面上所有輪廓點
對外接圓之圓心投影(如圖 14)，得到一二維剖視圖(如圖 15)，此方法稱為圓心投
影法(centroidal profile)[6]。 
10 
 
    圖 16 銑刀上各刀刃之刃尖與刃底的位置 
 
五、間隙特徵值量測 
(1) 間隙特徵值定義 
參照圖 17，兩線段 與 分別為通過兩個梯形裂縫上底所成的直線，兩線
段間的距離即為間隙。 
1L 2L
       
12 
 
圖 7 間隙示意圖 1
L2 
L1 
兩個 
梯形裂縫 
 
(2) 量測演算法 
間隙量測項目之硬體架構設置如圖 18 所示，藉由前照式環形光源，將光源
照射在銑刀魚尾端面上，透過銑刀之傾斜面將光源反射以取得對比鮮明之銑刀影
像，如圖 19 所示。 
 圖 20 銑刀間隙特徵值量測演算法流程圖 
 其中擷取銑刀魚尾端面裂縫部份，是運用影像處理形態學方法中的閉合運算
子(Close)。將經閉合運算子得到的影像與原始影像相減，即可得到魚尾端裂縫影
像。 
 
六、結論與討論 
 
(1) 結論 
本研究計劃設計與開發出一套銑刀特徵值機器視覺量測系統，包含硬體架構
與軟體演算法，此一系統可自動量測出銑刀魚尾端面上之右刃溝深、前周角、與
間隙特徵值，量測結果不受銑刀放置於夾具上的方位影響。本計畫透過所設計之
硬體架構擷取銑刀魚尾端面影像，利用適應性閥值法來找尋將銑刀魚尾端面與背
景分離之閥值，不受光源系統影響，不需再經過任何參數訓練的調整來找尋閥
值。經過多次實驗驗證後，量測所得之特徵值其精確度皆在業界允許之誤差範圍
內，提供一穩健(Robust)且客觀的量測系統。 
本計畫設計開發之演算法，透過兩階段測試第一階段包含右刃溝深與前周
角、第二階段間隙等量測，量測一隻銑刀所需時間不到兩秒鐘，相較於人工量測
所需分析的時間，更能提供有效且客觀的量測結果。詳細量測時間整理於表 1。 
 
 
 
14 
 
16 
 
[7] D. B. Perng and Y. C. Chen, "An Advanced Auto-Inspection System for 
Micro-router Collapse," Accepted by Machine Vision and Application, 2008. 
[8] L. G. Shapiro and G. C. Stockman, Computer Vision, Englewood Cliffs, Prentice 
Hall PTR Upper Saddle River, USA, 2001 
[9] J. Neter, W. Wasserman and M. H. Kutner, Applied Linear Statistical Models, 
1990. 
[10] 陳賢義，”視覺技術在線上檢測之應用”，自動化感測技術專輯，機械工業雜
誌 6 月號，267-279，1993。 
[11] 梁有燈，”機器視覺在 BGA 銲球尺寸量測上之應用”，中華大學機械與航太
工程研究所碩士論文，2001。  
 
 
七、 計畫成果自評 
z 研究內容與原計畫相符程度 
本研究內容與原計畫近乎相符，特別在銑刀魚尾端面透過本計畫開發檢
測右刃溝深、前周與間隙特徵值，量測結果不受銑刀放置於夾具上的方
位影響。 
z 達成預期目標情況 
本研究計畫透過兩年的研發成果，對不同種類的銑刀進行刃面缺陷檢測
演算法與相關視覺檢測系統架構之開發與研究。右刃溝深、前周角與間
隙特徵值量測結果不受銑刀放置於夾具上的方位影響，經過實驗驗證
後，精確度位於業界允許誤差範圍內，提供一穩健(Robust)且客觀的量
測系統。 
z 研究成果之學術或應用價值 
本研究計畫開發之檢測軟硬體技術，可應用於銑刀之特徵值量測，同時
在開發專用光源系統時所分析不同類型之光源特性，亦可應用於其他相
關之研究項目中。 
z 是否適合在學術期刊發表或申請專利 
本研究計畫已經於收錄中國工業工程學會年會論文集: ”微型銑刀特
徵值之機器視覺量測,” 中壢市，中原大學，民國97年12月13日。 
 

國科會補助計畫衍生研發成果推廣資料表
日期:2010/12/16
國科會補助計畫
計畫名稱: 微型銑刀自動化光學量測與檢測系統之研究與開發
計畫主持人: 彭德保
計畫編號: 96-2221-E-009-077-MY3 學門領域: 生產系統規劃與管制
無研發成果推廣資料
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
其他成果 
(無法以量化表達之
成果如辦理學術活
動、獲得獎項、重要
國際合作、研究成果
國際影響力及其他
協助產業技術發展
之 具 體 效 益 事 項
等，請以文字敘述填
列。) 
2007 IEEE International Student Experimental Hands-on Project Competition
獲得「第四名」 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
