 ii 
Table of Contents              
 
Abstract ..........................................................................................................................................iii 
中文摘要......................................................................................................................................... iv 
I. Introduction ............................................................................................................................ 1 
1.1 Background....................................................................................................................... 1 
1.2 Motivation ......................................................................................................................... 2 
1.3 Overview of cooperative communication systems......................................................... 3 
1.4 Organization of this report.............................................................................................. 4 
II. System Model.......................................................................................................................... 5 
2.1 System Model Description............................................................................................... 5 
2.2 Optimization Criteria .................................................................................................... 11 
III. Adaptive Resource Allocation for Dual-Hop Single-Relay OFDM-Based Cooperative 
Communication Systems ............................................................................................................. 14 
3.1 Introduction .................................................................................................................... 14 
3.2 Analytical Model ............................................................................................................ 15 
3.3 Optimization Criteria .................................................................................................... 18 
3.4 Simulation Results.......................................................................................................... 23 
3.5 Summary ......................................................................................................................... 24 
IV. Adaptive Resource Allocation for Dual-Hop Multi-Relay OFDM-Based Cooperative 
Communication Systems ............................................................................................................. 26 
4.1 Introduction .................................................................................................................... 26 
4.2 System Model.................................................................................................................. 26 
4.3 Optimization Criterion .................................................................................................. 28 
4.4 Simulation Results.......................................................................................................... 31 
4.5 Summary ......................................................................................................................... 35 
V. Summary and Conclusions.................................................................................................. 37 
References ..................................................................................................................................... 38 
 
 
 
 
 iv 
中文摘要 
    本計畫旨在探討具正交分頻多工(Orthogonal Frequency Division Multiplexing, OFDM)  
技術合作式通訊系統之適應性資源分配演算法。為了提升系統的子載波位元傳輸率和降低
子載波傳送位元所需功率，動態資源分配儼然成為一個重要的議題。目前存在的動態資源
分配議題，大致上分為以下兩類：在有限的功率與目標位元錯誤率限制下，最大化系統產
出量  (Throughput)及在有限的功率與傳輸速率限制下，最小化位元錯誤率。本計畫將針對
前者進行詳細研究。  
  首先，我們對單一來源端、目的端及中繼節點環境下，探討正交分頻多工技術之合作式
通訊系統的最佳化問題。為了達到來源端子載波功率分配最佳化，我們導入拉格朗日乘數
並利用 KKT  (Karush-Kuhn-Tucker)  的條件法，成功推導出最佳化的來源端子載波功率
分配。基於最佳化方法運算複雜度非常高，為了降低複雜度，並達到最大化系統產出量的
目標，我們對來源端的子載波功率分配問題，設計其次佳化演算法。此次佳化演算法在有
限的功率及目標位元錯誤率限制下，藉由調整來源端的子載波功率分配，仍可有效達到提
升系統產出量的目標。 
    接著，我們針對單一來源端、目的端及多個中繼節點的環境中，探討中繼節點選擇及
來源端子載波功率分配問題。為了降低前面所導出最佳化方法的運算複雜度，並有效提升
系統產出量，而設計次佳化演算法。此演算法先對來源端及所有中繼節點做平均功率分配，
決定一個中繼節點傳輸，再依據總功率和目標位元錯誤率限制下，對來源端子載波做功率
分配，以達到最大化系統產出量。由模擬驗證，我們提出的演算法能夠在總功率及目標位
元錯誤率的限制下，有效提升系統產出量。  
   
關鍵字：  正交分頻多工、合作式通訊、目標位元錯誤率。
 2 
is of spectrum efficient. Cooperative communications are a new paradigm that draws from the 
ideas of using the broadcast nature of the wireless channel to make communicating nodes help 
each other, of implementing the communication process in a distribution fashion and of gaining 
the same advantages as those found in MIMO systems. The end result is a set of new tools that 
improve communication capacity, speed, and performance; reduce battery consumption and 
extend network lifetime; increase the throughput and stability region for multiple access schemes; 
expand the transmission coverage area; and provide cooperation tradeoff beyond source–channel 
coding for multimedia communications.  
Cooperative communications are a new communication paradigm which generates 
independent paths between the user and the base station by introducing a relay channel. The relay 
channel can be thought of an auxiliary channel to the direct channel between the source and 
destination. Since the relay node is usually several wavelengths to distant from the source, the 
relay channel is guaranteed to fade independently from the direct channel, which introduces a 
full-rank MIMO channel between the source and the destination. In the cooperative 
communications setup, there is a-priori few constraints to different nodes receiving useful energy 
that has been emitted by another transmitting node. The new paradigm in user cooperation is that, 
by implementing the appropriate signal processing algorithms at the nodes, multiple terminals 
can process the transmissions overheard from other nodes and be made to collaborate by relaying 
information for each other. The relayed information is subsequently combined at a destination 
node so as to create spatial diversity. This creates a network that can be regarded as a system 
implementing a distributed multiple antenna where collaborating nodes create diverse signal 
paths for each other.  
Hence, cooperative communications are a new paradigm shift for the fourth generation 
wireless system that will guarantee high data rates to all users in the network, and we anticipate 
that it will be the key technology aspect in the fifth generation wireless networks. 
 
1.2 Motivation  
With the increasing needs for high speed wireless applications, future wireless networks, no 
matter infrastructure-based, such as cellular networks, or ad hoc, such as a disaster recovery 
network, will be required to provide reliable high data rate services in dynamic environments. 
The use of multiple antennas can improve the power and spectral efficiency greatly in single-link 
wireless communications [2]-[9]. In many instances, however, this may be impractical due to 
limitations on the size and power of the communication devices. Cooperative transmission, which 
utilizes the broadcast nature of the wireless medium and the numerous nodes in a network, is an 
efficient way to realize the benefits of multi-antenna transmission with only one antenna at each 
node.  
The system performance is improved by the resource management, in an OFDM-based 
cooperative system, in which the link gain varies by several instantaneous rates of the subcarriers. 
When the channel coefficient differences among subcarriers are large, it is possible that 
subcarriers with good channel coefficient will be allocated most of the resource, i.e., bits and 
 4 
 
 
1.4 Organization of this report  
This report is organized as follows. In Chapter I, Chapter II, the adaptive resource allocation 
for the cooperative OFDM- based communication systems are described. The cooperative 
OFDM-based system model and channel model are presented in Chapter 2.1. In Chapter 2.2, to 
evaluate the performance of multiuser OFDM system, an analytical model is studied, and 
optimization criteria are reviewed. In Chapter III, the adaptive resource allocation for dual-hop 
single-relay OFDM-based cooperative communication systems is presented.  
In Chapter 3.1 the dual-hop single relay amplify-and-forward cooperative communication 
systems problem is introduced. In Chapter 3.2, the system model is describes. In Chapter 3.3, the 
optimization criteria of adaptive resource allocation for dual-hop single-relay OFDM-based 
cooperative communication system are presented. The suboptimal resource allocation algorithm 
is proposed in Chapter 3.4. The performance of the proposed suboptimal allocation algorithms for 
dual-hop single-relay OFDM-based cooperative communication system is analyzed and a series 
of simulations are compared in Chapter 3.4.  
In Chapter IV, the adaptive resource allocation for dual-hop multi-relays OFDM-based 
cooperative communication system is introduced in Chapter 4.1. The optimization criterion 
multi-relay problem for OFDM-based cooperative communication system is formulated in 
Chapter 4.2. In Chapter 4.3 the proposed suboptimal adaptive resource allocation algorithm is 
discussed. In Chapter 4.4, the performance of dual-hop multi-relay OFDM-based cooperative 
system is analyzed. Finally, Chapter V summarizes the conclusions of this report and points the 
areas for future research. 
 6 
arranged in parallel for each subcarrier and modulated independently. At each subcarrier, 
according to the number of the assigned bits, the adaptive modulator chooses the corresponding 
modulation scheme to form a modulated bit. The modulated bits per symbol and the allocated 
transmit power are denoted as iT  and isP  for the ith subcarrier, respectively. The modulated 
bits of all subcarriers are transformed into the time domain samples by the inverse fast Fourier 
transform (IFFT) to form a time domain OFDM bits per symbol. After IFFT operation, a cyclic 
prefix (CP) is inserted at the beginning of each time domain OFDM symbol and the length of CP 
is assumed to be longer than or equal to the maximum delay spread of the multipath channel, to 
prevent ISI. The transmit signal is then passed through different frequency selective fading 
channels to different subcarriers. 
  
Channel Model  
In this report, the channel is modeled to be a Rayleigh fading channel whose fading characteristic 
is assumed to be quasi-static so that the fading gains are constant during one OFDM symbol 
period, but vary from one symbol to another. At different subcarriers, the signal received from the 
transmitter is assumed to undergo frequency selective fading channel, independently. The channel 
impulse response for the ith subcarrier is given by (2.1) as follows [21]: 
 
∑
=
−=
L
l
lii tlcgtg
1
)()()( τδ                         (2.1) 
 
Where ( )．δ is the Dirac delta function, L is the number of resolvable paths; for the lth path, 
)(lcg i  and lτ  denote the path gain and path delay, respectively. The path gains are independent 
for different paths. We assume that the symbol duration for each subcarrier is large relative to the 
multipath delay spread, Lτ ; therefore, each subcarrier approximately experiences flat fading. The 
channel gain for the ith subcarrier, denoted as iα , can be expressed as follows [22]-[23]: 
 
Nielcg
L
l
Nnlj
ii ,...,2,1     )(
1
/2
== ∑
=
− piα               (2.2) 
Receiver  
At each receiver, after the CP is removed from the received time domain samples, the samples are 
transformed into frequency domain modulation symbols b the fast Fourier transformed (FFT). 
After propagation through a Rayleigh fading channel, if the transmitted signal is received by the 
ith subcarrier; hence, the signal received from the ith subcarrier can be expressed as 
 
   iiss wTGPr ii +=                        (2.3) 
 
Where iw  denotes the frequency domain additive white Gaussian noise (AWGN) with zero 
 8 
For an Amplify and Forward cooperation protocol, the relay amplifies the received signal and 
forwards it to the destination with transmitted power 
ifP . In phase 2, the received signal at the 
destination from the relay can be expressed as 
iii
ii
i
i fdsffd
sfs
f
fd zrg
NgP
P
r +
+
=
0
20
                   (2.6) 
 
where 
ifdg  is the channel coefficient from the relay to the destination and ifdz  is an additive 
noise.  
We assume that the source sends data with power 
is
P on the ith subcarrier  to relay and 
destination, while the relay retransmits an amplified signal of the received data to the destination. 
The relay received signal from the source can be expressed as follow 
iiii fdfdisfsd zgarr += )(                        (2.7) 
 
Where ia  is a power scaling factor and can be expressed as 
0
2
NgP
P
a
ii
i
sfs
f
i
+
=                        (2.8) 
to ensure a relay transmit power on the ith subcarrier of 
ifP . The noise variance at the relay 
within one OFDM subcarrier is denoted by 0N . 
    The relay received the signals from the source that the 
isfSNR can be expressed as 
  
0
2
N
gP
SNR ii
i
sfs
sf =                           (2.9) 
The destination received the signals from two ways that one is the source, the other one is the 
relay. If the destination received the signal from the source that the 
isdSNR can be expressed as    
0
2
N
gP
SNR ii
i
sds
sd =  (2.10) 
The destination receives the signal from the relay that the 
ifdSNR can be formulated as 
 10 







 −
+≈
i
MRC
i BER
SNR
b i
5ln
6.1
1log 2                     (2.15) 
The instantaneous rate where the maximum achievable discrete bits numbers can be formulated 
as of the communication between source and destination with the relay on the ith subcarrier is 
transmitted therefore can be formulated as 
 
















Γ
+≈ i
MRC
i
SNR
b 1log 2                         (2.16) 
Where  ．  denotes the floor operator and Γ  is a constant for the ith subcarrier’s target BER, 
denoted as tBER , the constant can be specified as 
6.1
)5ln(
−
=Γ tBER (2.17) 
 
 
Fig. 2.3 BER approximation for M-QAM over Rayleigh fading channel 
 
In [27], a simple adaptive modulation scheme was proposed, the modulation mode used is 
adapted on the instantaneous SNR under tBER constraint. Based on the instantaneous SNR, the 
Q-mode adaptive modulation scheme adjusts the transmission mode q, where { }Qq ,...,1,0= , to 
satisfy tBER constraint. Following the approach proposed in [27], the mode selection rule is 
given by 
Select mode q when ),(
, qnMRC bSNRBER i <≤ tBER ),( 1, +qnMRC bSNRBER i , 
 12 
















Γ
+≈ i
MRC
i
SNR
b 1log 2                  (2.18) 
The resource allocation cooperative OFDM-based optimization problem was investigated, 
where the objective is to maximize the total instantaneous data rate of the OFDM-based system 
subject to total available transmission power at source, relay and target BER constraints. 
Mathematically, the optimization problem is formulated as 
∑
=
N
i
ib
1ps
Max                             (2.19) 
subject to:   
Ni
N
P
P total
i
s
s ,...,1  , ==                      (2.20) 
∑
=
=
N
i
ff totali PP
1
                             (2.21) 
NiP
if ,...,1,0 =≥                           (2.22) 
NitBERBERi ,...,1   , =≤                     (2.23) 
where N denotes the total number of subcarriers, 
is
P  denotes the power allocated for ith 
subcarrier at the source, 
ifP denotes  the power allocated for the ith  subcarrier from relay to 
the destination. 
totals
P  denotes the total  power  constraint  at  the  source that divide by N 
denote uniform power allocation. 
totalfP  denotes the total power constraint at the relay. 
To obtain the optimal solution in (2.19), to allocation power on the ith subcarrier at source and 
relay should be allocated jointly. However, this causes a prohibitive high computational 
complexity. Separating the source and relay power allocation is a way to reduce the 
computational complexity. The transmission power for each subcarrier can be adapted by using 
Lagrange multiplier method with KKT conditions. The algorithm is demonstrated in [28]-[29] as 
the optimal solution for the problem that distributed power into parallel independent channels 
with a total available power constraint. After subcarrier allocation, the system employed 
Lagrange multiplier method to solve the optimization problem of (2.19), the KKT conditions by 
those constraints of follows for the uniform power allocation at the source node (equal power 
distribution), and total power and target BER constraints. With the subcarriers  
of the relay node must be transmitted by a signal or equal to zero. Use differentiate to  
solve Lagrange function for get the power distribution across subcarriers the optimal 
power allocation for subcarriers at relay 
ifP  can be obtained by 
 14 
III.  Adaptive Resource Allocation for Dual-Hop Single-Relay 
OFDM-Based Cooperative Communication Systems 
 
3.1 Introduction  
Cooperative relaying strategies have become a major topic in the wireless research 
community. The first research on relay channels was obtained in the seventies in [30]-[32]. The 
interest in this topic was initiated recently by the conference papers [33]-[35] and triggered a 
large amount of work in this area [34].  
  Most of the literatures available today consider frequency-flat fading. In [36] cooperative 
diversity protocols are analyzed for combating multi-path fading and shadowing effects in a 
wireless network and thereby increasing the robustness of the wireless connection between source 
and destination. In [37] a form of spatial diversity is investigated, in which diversity gains are 
achieved via the cooperation of two mobile users that communicate with a base station. It is 
shown that cooperation leads not only to an increase in uplink rate for both users but also to a 
more robust system, where user rates are less sensitive to channel variations. In [38], [39] and [40] 
optimal power allocations between source and relay (regenerative and nonregenerative) are 
discussed for the case that both share a total amount of transmit power over the two time-slots 
required for relaying. In [41] the optimal gain allocation between multiple nonregenerative 
coherent relays is presented which maximizes the instantaneous rate for multiple nonregenerative 
coherent relays, retransmitting in the same bandwidth. This gain allocation can be interpreted as a 
distributed maximum ratio combining (MRC). 
The case of cooperative relaying in frequency-selective fading channels is much less 
examined so far. In [42], the authors determine power allocations for multiple orthogonal 
nonregenerative relays which are the same as having one relay using OFDM to maximizing the 
average SNR of the maximum ratio combiner at the destination node. In [43] the information rate 
of OFDM and OFDMA networks consisting of one source/destination pair and multiple relays is 
examined. In the case of OFDM only one amplification gain is used for all subcarriers at the 
nonregenerative relay. Therefore, the rate is not optimized with respect to the frequency-selective 
channel. In the case of OFDMA only one nonregenerative relay is assigned to one subcarrier, 
which results in an optimization problem that can  be solved by integer programming. In [44] 
distributed Alamouti coding [45] for OFDM relaying links is proposed. Furthermore, a closed 
form expression for the bit error ratio (BER) assuming BPSK, M-QAM, MPSK modulation is 
presented.    
    In this project, we focus on dual-hop AF with single or multiple relay for OFDM-based 
communication system. The transmitted signals are subject to frequency selective Rayleigh 
fading channels. We examine the possibilities of power allocation over the subcarriers at relay to 
maximize overall throughput that is the instantaneous rate of the link. It is assumed that source 
and relay have their own separate transmit power. The source and relay have total power and 
target BER constraints. We give the optimal power allocation at the source that maximizes overall 
throughput for a given relay power allocation. The KKT conditions has to be solved the optimal  
 16 
 
Fig.3.2 Block diagram of OFDM-based communication systems with single AF  
cooperative relay 
 
  Denoting g to be the frequency domain channel coefficient, the received bits/symbol on the ith 
subcarrier at the destination or relay. In the phase 1, the received signals at the destination and 
relay can be expressed as 
iiii sdisdssd zTgPr +=                              (3.1) 
iiii sfisfssf zTgPr +=                              (3.2) 
 
Where 
is
P  denote the transmitted power at the source of the ith subcarrier, Ti denotes the 
transmitted information symbol, and 
isdz  or isfz  denote additive noise. In (3.1) and (3.2), isdg  
and 
isfg  are the channel coefficients received by destination and relay from source to destination 
and source to relay respectively. They are modeled as zero-mean, complex Gaussian random 
variables with variances 2
isdδ and 
2
isfδ  respectively. The noise terms isdz  or isfz  is modeled as 
zero-mean, complex Gaussian random variable with 0N . 
  For an Amplify and Forward cooperation protocol, the relay amplifies the received signal and 
forwards it to the destination with transmitted power 
ifP . In phase 2, the received signal at the 
destination from the relay can be expressed as 
iii
ii
i
i fdsffd
sfs
f
fd zrg
NgP
P
r +
+
=
0
2
                     (3.3) 
where 
irdg  denote the channel coefficient from the relay to the destination and isdz  is an 
additive noise. 
 
 18 
which denotes by bi can be approximated as    








−
×







−≈
12
6.1
2
112),(BER
i
i
i
i b
MRC
b
i
iMRCi
SNR
erfc
b
bSNR           (3.10) 
  However, the above expression is not easily differentiable or invertible in its SNR or the 
number of bits. Considering a different approximation with these properties, an approximation 
BER is presented as 








−
−
≈
12
6.1
exp2.0),(BER
i
i
i b
MRC
iMRCi
SNR
bSNR                (3.11) 
  For a given target BER (tBER), the maximal achievable bits transmitted by the ith subcarrier 
can be approximated as 








Γ
+≅ i
MRC
i
SNR
b 1log2                         (3.12) 
where 
6.1
)5ln(
−
=Γ tBER  is a constant. 
    In this project, we consider the M-QAM with Gray bit mapping is applied. The 
OFDM-based system applies adaptive modulation scheme in order to take advantage of 
fluctuations in the channel condition. The main idea of this chapter would be the transmission 
rate as high as possible when the link condition better, and transmission at a lower rate when the 
link condition bad. Lower rates are achieved by using a small constellation, such as QAM. The 
higher rates are achieved with large constellations, such as 256-QAM. 
 
3.3 Optimization Criteria  
The objective of proposed optimization problem is to maximize throughput by power allocation 
at source node. An OFDM-based downlink system for a single relay scheme is considered. The 
constraint to this problem is total transmission power at source node which include subcarrier and 
power allocation, provides subcarrier and bit allocation data to the source for an OFDM symbol.  
To optimize the transmit power allocation of the relay and/or source over the N subcarriers 
with respect to separated sum power constraints at both nodes as 
 ∑
=
=
N
i
ss totali
PP
1
                              (3.13) 
∑
=
=
N
i
ff totali PP
1
                              (3.14) 
 
  The values of the transmit power over the subcarriers are thereby stacked in the vectors can be 
define as TS ],...,,[ 21 Nsss PPP=Ｐ  and ],...,,[ 21F Nfff PPP=Ｐ ，respectively. We assume that all 
parameters which are not subject of the current optimization problem are known to the optimizing 
 20 
∑∑∑
∑ ∑∑
∑∑ ∑
===
= ==
== =
+





−+






















Γ
+
++
+=
+





−+





Γ
+=
+





−+=
N
i
si
N
i
ss
sds
fd
f
sfs
fd
f
sfs
N
i
N
i
N
i
si
N
i
ss
MRC
N
i
si
N
i
N
i
ssi
Nss
itotali
ii
i
total
ii
i
total
ii
itotali
i
itotali
N
PPP
N
gP
Ng
N
P
gP
g
N
P
gP
N
PPP
SNR
PPPb
PPL
11
0
2
0
22
22
0
1
2
1 11
2
11 1
1
1
1log
1log
),...,,,,...,(
1
εα
εα
εα
εεα
 
(3.18) 
 
The Lagrange function can be rewrited as 
 
∑
∑∑
=
==
+






−+
























Γ












++
+
+=
N
i
si
N
i
ss
r
isi
f
isi
si
N
i
Nss
i
totali
total
i
total
i
i
N
P
PPN
P
cPb
N
P
cPb
Pa
PPL
1
11
21
                                         
1
1log),...,,,,...,(
1
ε
αεεα
 (3.19) 
 
Where 
0
2
N
h
a
isd
i = ，
0
2
N
h
b isfi = ，
0
2
N
h
c
ifd
i =  
  The solution [ ]TS ,...,, 21 Nsss PPP=Ｐ  satisfies the following conditions: 
0),...,,,( 1 =∇ NL εεαｓＰ Ｐｓ                        (3.20) 
0
1
=−∑
=
N
i
ss totali
PP                        (3.21) 
0=
isi
Pε    for Ni ,...,1=         (3.22) 
 0≥sP    for Ni ,...,1=         (3.23) 
 22 






Γ
+= i
MRC
i
SNR
b 1log2  
2) Terminate algorithm  
  
In this subsection, we discuss a suboptimal of source power allocation algorithm where equal 
power distribution at the relay has been described. The proposed algorithm for the source power 
allocation use (2.18) list below 






Γ
+= i
MRC
i
SNR
b 1log2  
  The subcarrier of the source power allocation can be formulated from (2.18) to the solution as 






















Γ
+
++
+≅
0
2
0
22
22
0
2
1
1log
N
gP
Ng
N
P
gP
g
N
P
gP
N
b
ii
i
total
ii
i
total
ii sds
fd
f
sfs
fd
f
sfs
i  
Where iiiiiiii
b
i cbcaabdld i −−−=−Γ= ),12(  substitute into above equation as 
ii
f
iiiiii
s ba
N
P
cddball
P
total
i 2
42
−






++±−
= (3.29) 
 
 
 
Suboptimal Power Allocation Algorithm  
 
1) Initialization 
1.a) Let MAXi bb =  for all i 
1.b)N={1,2,…,N}  
 
2) Source power allocation 
2.a) Obtain 
is
P  from (3.29) for all i 
2.b) If ∑
=
>
N
i
ss totali
PP
1
 go to next step, else set final allocation and terminate algorithm 
 24 
 
Fig. 3.3 Total throughput for different power allocation algorithm with N = 16 and  
tBER = 0.01 
                
 
Fig. 3.4 Total throughput for different power allocation algorithm with N = 16 and  
tBER = 0.005  
 
3.5 Summary  
This chapter introduces the resource allocation for the powe allocation at subcarrier of source 
 26 
IV. Adaptive Resource Allocation for Dual-Hop Multi-Relay 
OFDM-Based Cooperative Communication Systems 
  
4.1 Introduction  
Cooperative relaying technique has become a powerful topic of the next-generation wireless 
communication systems for its ability of extending coverage and improving capacity. One of the 
important relaying strategies of amplify and forward (AF) is proved to be usable in practical 
scenario [50]. Amplify and forward (AF) mode is simple as the received signal at relay to amplify 
and forward without any decoding or demodulation process. A lot of research has been done to 
analyze the related performance.    
Due to the spectrum efficiency robustness in multi-path propagation environments and ability 
to combat the inter symbol interference the orthogonal frequency division multiplexing (OFDM) 
is considered an effect technique in the broadband wireless communication system. The 
combination of the relaying and OFDM is an even promising way to improve system capacity 
and extend coverage. Different from single carrier system, multi-relay OFDM-based systems 
channel transfer function may vary in different relay links because of the propagation 
environment. In conventional cooperative OFDM-based AF relaying systems, no additional relay 
selection operation is done in relay. To utilize the independence of different relay links, recently 
single relay without direct SD link is discussed to improve the capacity of both AF [51]-[52] and 
DF relaying [53]-[54]. The basic idea is to pair the subcarriers of the first hop (SD link) and the 
second hop (RD link) in the order of channel gain for data transmission. However, these 
researches only focus on single relay scenario. When systems are with multiple relays less than 
one source are concerned, relay selection should be taken into consideration, referring to which 
relay is selected to forward signal on a certain relay links. In [55], jointly subcarrier matching and 
relay selection with multiple parallel without direct SD link, AF relays has been studied. However, 
no power allocation with regard to multiple relays has been studied, which is crucial for capacity 
enhancement.  
  In this chapter, we consider a two-hop AF relaying system where a source communicates with 
its destination through multiple relay nodes. To maximize the allocation bits at the subcarriers, we 
formulate the optimal solution for selected relay and optimization of multi-relay ubcarriers 
assignment and power allocation as a mixed binary integer programming problem. Due to the 
high complexity of the problem, a suboptimal solution is proposed to solve relay and power 
allocation problems. Simulation results show that the proposed algorithm with relay  selection 
and optima bits power allocation achieves are very close to optima compared to the optimal 
solution.  
  
4.2 System Model  
A downlink single source-destination multi-relay OFDM-based cooperative system which 
consists of a transmitter, N subcarrier and M relay is shown in Fig. 4.1.    
 
 28 
    In the phase 1, the received SNR at the mth relay and destination can be formulated 
respectively as 
0
2
,
, N
gP
SNR mii
mi
sfs
sf =                             (4.4) 
0
2
N
gP
SNR ii sdssd =                              (4.5) 
In the phase 2, the received SNR at destination from the selected mth the relay that the 
imi dfSNR ,  
can be formulated as 
0
22
22
0
,,,
,,,
,
1
NgPgP
gPgP
N
SNR
imimimii
imimimii
imi
dffsfs
dffsfs
df
++
=                 (4.6) 
In the phase 2, the received SNR at destination using maximum ratio combiner (MRC) can be 
formulated as 
+
++
=
0
22
22
0
,,,
,,,
,
1
NgPgP
gPgP
N
SNR
imimimii
imimimii
mi
dffsfs
dffsfs
MRC
0
2
N
gP
ii sds
           (4.7) 
 
 
4.3 Optimization Criterion  
 
Considered the single source, destination and multi-relay OFDM-Based cooperative systems is to 
allow selected mth relay node reliably receive data from the mth relay of the ith subcarrier. The 
throughput of ith subcarrier is determined by the data rate (number of bits transmitted over an 
OFDM symbol) of the ith subcarrier by ib . Thus, the instantaneous data rate mib ,  can be 
expressed as 








Γ
+= mi
MRC
mi
SNR
b ,1log2,  (4.8) 
In multi-relay OFDM-based cooperative systems the transmission ability is dependent on each 
relay. To choose the maximize throughput relay from multi-relay environment would be better 
than single relay systems. The relay selection will be more important than single relay systems. 
Let 
N
P
P total
i
s
s = , N
P
P total
mi
f
f =
,
 define the uniform power distribution at source and relay 
subcarriers. The rule of relay selection can be describe as 
 30 
formulated as 
 
22
2
2222*
,
ii
ii
ii
ii
ii
ii
s fe
kg
fe
kg
fe
mjP
mi α
α
α
α
α
αα
+
+
−





+
+
+
+
−−−
=  (4.15) 
 
Optimal source Power Allocation Algorithm  
1) Relay selection  
  1.a) Select the maximum transmission bits numbers of the source using 
∑
=
=
=
N
i
mi
Mm
bm
1
,
,...,1
*
max *maxarg  
2) Optimal power allocation at source 
2.a) obtain α  from (3.28)    
2.b) use α  , into (3.27) to get 
is
P  for all i  
2.c) calculate *
,mi
b , to allocate the bits number for all subcarriers 








Γ
+=
*
,
* 1log2,
mi
MRC
mi
SNR
b  
3) Terminate algorithm 
 
The 
*
,mi
sP , denotes the power allocation from ith subcarrier of source node to selected mth 
relay node. The source power allocation can be formulated from (2.18) to the solution as 
bc
adPaacvv
P i
i
f
s 2
))(4( 2
−
++±−
=                      (4.16) 
 
 
The suboptimal of source power allocation algorithm can be described as    
Suboptimal source Power Allocation Algorithm 
  
1) Initialization 
1.a) let MAXmi bb =*,  for all i   
1.b) N={1,2,…,N}  
 
 2) Source power allocation  
 32 
 
Fig. 4.2 Total throughput for different power allocation algorithm with M = 5, N = 16  
and tBER = 0.01 
 
 
 
Fig. 4.3 Total throughput for different power allocation algorithm with M = 5, N = 16  
    and tBER = 0.005 
 34 
 
Fig. 4.6 Total throughput for different power allocation algorithm with M = 15,    
N = 16 and tBER = 0.01 
 
 
Fig. 4.7 Total throughput for different power allocation algorithm with M = 15,    
N = 16 and tBER = 0.005 
 36 
selected node that to the multi-relay in the single source-destination OFDM-based cooperative 
systems. We first formulated the relay selection problem. Secondly, based on subcarriers power 
allocation at selected relay node, we proposed relay power allocation algorithms for effective 
throughput maximization. As mentioned in simulation results, it is also observed that the system 
effective throughput is significantly improved by using our proposed algorithms. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 38 
References 
 
[1] K. J. Ray Liu, A. K. Sadek, W. Su, A. Kwasinki, Cooperative Communications and Networking, 
Cambridge University Press, 2009. 
 
[2] M. Schwartz, W. R. Bennett, and S. Stein, Communication Systems and Techniques, 
McGraw–Hill, 1966.  
 
[3] D. Tse and P. Viswanath, Fundamentals of Wireless Communications, Cambridge University 
Press, 2005.  
 
[4] Goldsmith, Wireless Communications, Cambridge University Press, 2005.  
 
[5] G. J. Foschini and M. J. Gans, “On Limits of Wireless Communications in a Fading 
Environment When Using Multiple Antennas,” Wireless Personal Communications, vol. 6, pp. 
311–335, Jan. 1998.  
 
[6] J. H. Winters, “On the Capacity of Radio Communication Systems with Diversity in A Rayleigh 
Fading Environment,” IEEE Journal on Selected Areas in Communications, vol. 5,no. 5, pp. 
871–878. June 1987.  
 
[7] G. J. Foschini, “Layered Space-time Architecture for Wireless Communication in A Fading 
Environment When Using Multi-element Antennas,” Bell Labs Tech. J., vol. 1, no. 2, pp. 
41–59,Sep. 1996.  
[8] I. E. Telatar, ”Capacity of Multi-antenna Gaussian Channels,” European Transactions on 
Telecommunications, vol. 10, no. 6, pp. 585–595, Nov.–Dec. 1999.  
 
[9] V. Tarokh, N. Seshadri, and A. R. Calderbank, “Space-time Codes for High Data Rate Wireless 
Communication: Performance Criteria and Code Construction,” IEEE Transactions on 
Information Theory, vol. 47, no. 2, pp. 744–764, Mar. 1998.  
 
[10] Z. Shen, J. G. Andrews, and B. L. Evans, “Adaptive Resource Allocation in Multiuser OFDM 
Systems with Proportional Rate Constraints,” IEEE Transactions on Wireless Communications, 
vol. 4, issue. 6, pp. 2726–2737, Nov. 2005.  
 
[11] Mohanram and S. Bhashyam, “A Sub-optimal Joint Subcarrier and Power Allocation Algorithm 
for Multiuser OFDM,” IEEE Communication Letters, vol. 9, issue 8, pp. 685–687, Aug. 2005.  
 
[12] T. Jiang, W. Xiang, H. H. Chen, and Q. Ni, “Multicast Broadcast Services Support in 
OFDMA-based WiMAX Systems,” IEEE Communication Magazine, vol. 45, issue 8, pp. 78–86, 
 40 
 
[24] L. Hanzo, C. H. Wong, and M. S. Yee, Adaptive Wireless Transceivers: Turbo-Coded, 
Turbo-Equalized and Space-Time Coded TDMA, CDMA and OFDM Systems, John-Wiley & 
Sons Press, 2002.  
 
[25] S. T. Chung and A. J. Goldsmith, “Degrees of Freedom in Adaptive Modulation: A Unified 
View,” IEEE Transactions on Communications, vol. 49, no. 9, pp. 1561–1571, Sep. 2001.  
 
[26] V. D. Nguyen and H. Kuchenbecker, “Intercarrier and Intersymbo1 Interference Analysis of 
OFDM Systems on Time-Invariant Channels,” in Proc. IEEE International Symposium on 
Personal Indoor and Mobile Radio Communications, vol. 4, pp. 1482–1487, 2002.  
 
[27] S. Chen, A. K. Samingan, B. Mulgrew, and L. Hanzo, “Adaptive Minimum-BER Linear 
Multiuser Detection for DS-CDMA Signals in Multipath Channels,” IEEE Transactions on 
Signal Processing, vol. 49, no. 6, Jun. 2001.  
 
[28] J. Jang and K. B. Lee, “Transmit Power Adaptation for Multiuser OFDM Systems,” IEEE 
Journal on Selected Areas in Communications, vol. 21, no. 2, pp. 171–178, Feb. 2003.  
 
[29] G. Li and H. Liu, “On the Optimality of the OFDMA Network,” IEEE Communication Letters, 
vol. 9, no. 5, pp. 438–440, May 2005.  
 
[30] C. van der Meulen, “Three-terminal Communication Channels,” Adv. Appl. Prob., vol. 3, pp. 
120–154, 1971. 
 
[31] H. Sato, Information Transmission Through a Channel with Relay, Tech. Rep. B76-7, The 
Aloha System, University of Hawai, Honolulu, Mar. 1976.  
 
[32] T. M. Cover and A. A. El Gamal, “Capacity Theorems for the Relay Channel,” IEEE 
Transactions on Information Theory, vol. 25, pp. 572–584, Sep. 1979.  
 
[33] A. Sendonaris, E. Erkip, and B. Aazhang, “Increasing Uplink Capacity via User Cooperation 
Diversity,” In Proc. IEEE International Symposium on Information Theory, Cambridge, MA, p. 
156, Aug. 1998.  
 
[34] P. Gupta and P. R. Kumar, “The Capacity of Wireless Networks,” IEEE Transaction on 
Information Theory, vol. 46, pp. 388–404, Mar. 2000.  
 
[35] N. J. Laneman, D. N. Tse, and G. W. Wornell, “An Efficient Protocol for Realizing Cooperative 
Diversity in Wireless Networks,” in Proc. IEEE International Symposium on Information 
 42 
[47] W. Yao, S. Chen, S. Tan, and L. Hanzo, OFDM and MC-CDMA for Broadband Multi-User 
Communications, WLANs and Broadcasting, Wiley Press, 2003.  
 
[48] S. T. Chung and A. J. Goldsmith, “Degrees of Freedom in Adaptive Modulation: A Unified 
View,” IEEE Transactions on Communications, vol. 49, no. 9, pp. 1561–1571, Sep. 2001.  
 
[49] V. D. Nguyen and H. Kuchenbecker, “Intercarrier and Intersymbo1 Interference Analysis of 
OFDM Systems on Time-variant Channels,” in Signal Processing Advances in Wireless 
Communications, 2003, vol. 4, pp. 140 –144.  
 
[50] N. J. Laneman, D. N. Tse, and G. W. Wornell, “Cooperative Diversity in Wireless Networks: 
Efficient Protocols and Outage Behavior,” IEEE Transactions Information Theory, vol. 50, pp. 
3062–3080, Dec. 2004.  
 
[51] M. Herdin, “A Chunk Based OFDM Amplify-and-forward Relaying Scheme for 4G Mobile 
Radio Systems,” IEEE International Conference on Communications 06, Istanbul, Turkey, Jun. 
2006, pp. 4507–4512,.  
 
[52] M. herdin and A. Gunther, “Pilot Design for OFDM Amplify-and-Fordward With Chunk 
Reordering,” Wireless Communication and Networking Conference, Honk Kong, China, Mar. 
2007, pp. 1400–1405.  
 
[53] W. Wang, S. Yang, and S. Yang, “Optimally Joint Subcarrier Matching and Power Allocation in 
OFDM Multihop System,” EURASIP Journal on Advances in Signal Processing, vol. 2008, pp. 
3229–3232, Feb. 2008.  
 
[54] W. Wang, S. Yan, and L. Gao, “Comparison of Schemes for Joint Subcarrier Matching and 
Power Allocation in OFDM Decode-and-forward Relay System,” In Proc. IEEE International 
Conference on Communications 08, pp. 4983–4987, May 2008.  
 
[55] M. Zhou, L. Li, H. Wang, P. Zhang, and X. Tao, “Sub-carrier Coupling for OFDM Based AF 
Multi-relay Systems,” In Proc. IEEE Personal, Indoor and Mobile Radio Conference, Sep. 2007, 
pp. 1–5.
 44 
3. 請依學術成就、技術創新、社會影響等方面，評估研究成果之學術或應用
價值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）
（以 500 字為限） 
學術成就 
    本計畫探討具正交分頻多工技術合作式通訊系統之適應性資源分配
演算法，並使用動態資源分配之方法提升系統的子載波位元傳輸率和降低
子載波傳送位元所需功率。目前存在的動態資源分配議題，大致上分為以
下兩類：在有限的功率與目標位元錯誤率限制下，最大化系統產出量  
(Throughput)及在有限的功率與傳輸速率限制下，最小化位元錯誤率。本
計畫針對前者進行詳細研究與分析。  
   
技術創新 
    我們對單一來源端、目的端及中繼節點的環境與單一來源端、目的端
及多個中繼節點的環境下，探討正交分頻多工技術之合作式通訊系統的最
佳化問題。為了達到來源端子載波功率分配最佳化，我們導入拉格朗日乘
數並利用 KKT  (Karush-Kuhn-Tucker)  的條件法，成功推導出最佳化的
來源端子載波功率分配。基於最佳化方法運算複雜度非常高，為了降低複
雜度，並達到最大化系統產出量的目標，我們對來源端的子載波功率分配
問題，設計其次佳化演算法。此次佳化演算法在有限的功率及目標位元錯
誤率限制下，藉由調整來源端的子載波功率分配，仍可有效達到提升系統
產出量的目標。 
     
社會影響 
    目前正交分頻多工技術已被許多的無線通訊標準所採用，該技術除了
有高效率的頻譜使用率外，也能有效地對抗頻率選擇性衰減，因此如果能
適當的結合合作式通訊技術，將能提升無線通訊系統的效能。然而在實際
的通訊系統中，傳送訊號都會有傳送功率的限制。因此，為了在有限的功
率下改善系統的效能，使得功率分配在無線通訊中是一個相當重要的研究
議題。我們在本計畫中提出之適應性資源分配演算法可對產業界在研發正
交分頻多工技術相關產品時提供一個極佳的解決參考，另外優良的資源分
配演算法亦可降低能源消耗，進而達到促進產業發展與節能減碳之目的。 
 
 
 
 
 2 
    本次會議中，吾人等共發表兩篇論文於 Invited Sessions 之 “Intelligent Systems”，主題分
別為” Multiuser Detection Using Simulated Annealing Hopfield Neural Network for DS-UWB 
Systems” 及  “PAPR Reduction In OFDM System Using Differential Evolution-Based Partial 
Transmit Sequences Scheme”，其內容摘要如下： 
 
Multiuser Detection Using Simulated Annealing Hopfield Neural Network for DS-UWB Systems   
Yung-Cheng Yao , Chia-Hsin Cheng , Guo-Jun Wen , And Jyh-Horng Wen 
Abstract:  
The authors introduced the simulated annealing Hopfield neural network and applied it to multiuser 
detection in direct sequence-ultra-wideband (DS-UWB) systems in this paper. The conventional HNN 
algorithm may converge easily to local minimum. In order to solve this problem, the authors proposed 
modified HNN based on simulated annealing (SA) method which can avoid local minimum problem. 
From simulation results, the HNN detector based on SA method provided an attractive performance. 
The HNN detector based on SA method could be implemented easily on hardware circuit in the 
multiuser DS-UWB systems. 
 
 
PAPR Reduction In OFDM System Using Differential Evolution-Based Partial Transmit 
Sequences Scheme 
Yung-Cheng Yao , Ho-Lung Hung , and Jyh-Horng Wen 
Abstract:  
    This paper proposes a partial transmit sequence (PTS) scheme with applying a stochastic 
optimization technique for peak-to-average power ratio (PAPR) reduction in the  
orthogonal frequency division  multiplexing (OFDM) system. PTS technique combining can improve 
the PAPR statistics of an OFDM signals, but the considerable computational complexity  
for the required search through a high-dimensional vector space is a potential problem for 
implementation in the practical systems. Differential evolution (DE) is an efficient and powerful  
population-based stochastic search technique for solving optimization problems over continuous space, 
which has been widely applied in many scientific and engineering fields. Thus, to reduce the 
complexity for searching phase weight vector and to improve the PAPR statistics, we introduce the DE, 
an effective algorithm that solves various combinatorial optimization problems, to search the optimal 
phase weight factors. The simulation results show that the proposed DE-based PTS obtains the 
excellent PAPR performance with a low computational complexity. 
 
 
二、與會心得 
    2011 International Conference on Machine Learning and Cybernetics 就機器學習與控制理論相關
研究議題和應用進行廣泛的學術交流，並邀請國際著名專家作專題報告，吾人等深覺受益良多。 
這次筆者之博士生以口頭發表的方式發表論文，與各方先進意見交換，對姚生而言是一種挑戰，
如何讓在座學者明確瞭解我們所提論文的主要概念，進而讓先進學者們在聽完報告後，能夠給予
 4 
 
七、論文摘要 
 6 
 
 
 
98 年度專題研究計畫研究成果彙整表 
計畫主持人：溫志宏 計畫編號：98-2221-E-029-011-MY2 
計畫名稱：合作式無線中繼網路之子載波功率分配策略研究 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 0%  
研究報告/技術報告 0 0 0%  
研討會論文 3 1 300% 
篇 
另有審查中會議
論文 3篇 
論文著作 
專書 0 0 0%   
申請中件數 0 0 0%  專利 已獲得件數 0 0 0% 件  
件數 0 0 0% 件  
技術移轉 
權利金 0 0 0% 千元  
碩士生 6 4 150%  
博士生 2 1 200%  
博士後研究員 0 0 0%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 0% 
人次 
 
期刊論文 1 1 100%  
研究報告/技術報告 0 0 0%  
研討會論文 2 1 200% 
篇 
 
論文著作 
專書 0 0 0% 章/本  
申請中件數 0 0 0%  專利 已獲得件數 0 0 0% 件  
件數 0 0 0% 件  
技術移轉 
權利金 0 0 0% 千元  
碩士生 0 0 0%  
博士生 0 0 0%  
博士後研究員 0 0 0%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 0% 
人次 
 
國科會補助專題研究計畫成果報告自評表 
請就研究內容與原計畫相符程度、達成預期目標情況、研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）、是否適
合在學術期刊發表或申請專利、主要發現或其他有關價值等，作一綜合評估。
1. 請就研究內容與原計畫相符程度、達成預期目標情況作一綜合評估 
■達成目標 
□未達成目標（請說明，以 100 字為限） 
□實驗失敗 
□因故實驗中斷 
□其他原因 
說明： 
2. 研究成果在學術期刊發表或申請專利等情形： 
論文：□已發表 ■未發表之文稿 □撰寫中 □無 
專利：□已獲得 □申請中 ■無 
技轉：□已技轉 □洽談中 ■無 
其他：（以 100 字為限） 
本計劃有已接受尚未發表期刊論文 1篇；已發表會議論文 2篇；已接受尚未發表會議論文
3篇；審查中會議論文 3篇。 
3. 請依學術成就、技術創新、社會影響等方面，評估研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）（以
500 字為限） 
學術成就 
    本計畫探討具正交分頻多工技術合作式通訊系統之適應性資源分配演算法，並使用動
態資源分配之方法提升系統的子載波位元傳輸率和降低子載波傳送位元所需功率。目前存
在的動態資源分配議題，大致上分為以下兩類：在有限的功率與目標位元錯誤率限制下，
最大化系統產出量  (Throughput)及在有限的功率與傳輸速率限制下，最小化位元錯誤
率。本計畫針對前者進行詳細研究與分析。  
   
技術創新 
    我們對單一來源端、目的端及中繼節點的環境與單一來源端、目的端及多個中繼節點
的環境下，探討正交分頻多工技術之合作式通訊系統的最佳化問題。為了達到來源端子載
波功率分配最佳化，我們導入拉格朗日乘數並利用 KKT  (Karush-Kuhn-Tucker)  的條件
法，成功推導出最佳化的來源端子載波功率分配。基於最佳化方法運算複雜度非常高，為
了降低複雜度，並達到最大化系統產出量的目標，我們對來源端的子載波功率分配問題，
設計其次佳化演算法。此次佳化演算法在有限的功率及目標位元錯誤率限制下，藉由調整
來源端的子載波功率分配，仍可有效達到提升系統產出量的目標。 
     
社會影響 
