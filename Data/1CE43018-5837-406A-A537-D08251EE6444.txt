 1
工業製品之細微表面瑕疵檢測 
 
Surface tiny defects detection of industrial products 
 
計畫編號：NSC94-2212-E-324-001 
執行期限：94 年 8 月 1 日 至 95 年 7 月 31 日 
主持人：林宏達  朝陽科技大學  工業工程與管理系  副教授 
計畫參與人員：蔡博宇  朝陽科技大學  工業工程與管理系  碩士班 
 
中文摘要 
由於高科技與精密製造產業的蓬勃發
展，產品零件生產體積逐漸縮小，其產品
檢測精密度與準確度也要相對提升，即使
是細微表面瑕疵(Tiny  surface defects)也
必須能被正確地偵測。在一般的工業產品
中，表面細微瑕疵仍屬常見的瑕疵，例如
在表層障蔽型半導性瓷片（Surface Barrier 
Layer, SBL）、TFT-LCD 面板、金屬鑄件
與鋼珠等表面，表面皆有細微瑕疵的存
在，其影響的層面不僅會破壞產品的外
觀，且會影響其功能與安全。 
針對表面細微瑕疵之偵測，本研究延
續先前研究使用二維離散餘弦轉換
(Discrete Cosine Transform; DCT)將空間域
數位影像轉換至離散餘弦頻率域影像，搭
配兩階段式離散餘弦頻譜分析與解構規則
後，本研究提出應用能量集中性分析具隨
機性與結構性背景紋路影像上之瑕疵偵
測，最後搭配曲率法(Curvature)計算頻率
域能量值平緩曲線之曲率值，導入累和演
算法(Cumulative sum algorithm)、快速起
始回應法(FIR)，利用累和演算法具有偵測
微量異常偏移及可回溯偏移發生處的起始
點位置之特性，將能量值平緩曲線之轉角
點求出以決定最佳切割値，再使用濾波器
去除頻譜內的能量值後，還原至空間域數
位影像，即可達到去除具結構性背景紋路
並強化電腦視覺處理中難以尋找的細微瑕
疵。最後透過瑕疵影像分離Entropy及Otsu
法，搭配不同檢測之需要進行不同的閥值
切割技術以確定瑕疵之位置，將瑕疵影像
分離並取出特徵值，即可完成表面細微瑕
疵的偵測。 
在研究成果方面，本研究以被動電子
元件之圓板型電容瓷片、具結構背景紋路
之 TFT-LCD 面板、金屬鑄件與鋼珠為
例，這些工業製品其材質均不同於 SBL，
分別具有不同色彩變化、透明、金屬表面
反光與曲面效果等特性，透過實際的系統
開發成功地驗證了本研究所提之一系列的
表面細微瑕疵檢測方法，實驗數據顯示經
本研究所提之離散餘弦頻譜影像能量分析
法，與先前研究方法比較能有效將型 I 誤
差錯誤警報的機率由 5%降低至 0%，且針
對具結構性紋路背景影像也能有效偵測出
表面細微瑕疵，客觀地呈獻本研究所提離
散餘弦頻譜影像能量分析法的貢獻。 
 
關鍵詞：表面瑕疵檢測、電腦視覺系統、
離散餘弦頻譜解構、曲率累和管
制法、快速起始回應法。 
 
Abstract 
The advancement of the hi-tech and 
precision manufacturing industries has made 
it possible to manufacture products of 
smaller and smaller sizes.  To ensure 
product quality, inspection techniques with a 
much greater degree of precision and 
accuracy must be developed to detect tiny 
 3
頻譜圖上各元素的能量趨勢，並使用反序
累和管制法(R_CUSUM)與反序累和管制
法(RD_CUSUM)方法偵測屬於正常影像
的部分，透過部分能量消除的方式去除之
後再將已消除部分能量的頻率域頻譜圖還
原至空間域的數位影像，即可凸顯並強化
有瑕疵影像的部分，最後使用瑕疵分離法
即可得到瑕疵的範圍與其特徵值。 
在實驗樣本來源方面，將先以先前研
究所使用之表層障蔽型半導性瓷片 SBL
為例，後續再以液晶顯示器(LCD)、發光
二極體(LED)、金屬鑄件與鋼珠等產品，
這些工業製品在其生產過程中產品表面上
亦經常存在細微瑕疵，不僅破壞其外觀，
更重要會影響其產品功能，而這四種工業
製品其材質均不同於 SBL，分別具有不同
色彩變化、透明、金屬平面與金屬曲面等
特性，分別在電子產業、精密工業與民生
用品產業中占有重要的地位。圖 1 (a)為
SBL半導性瓷片其中一種規格的實際外觀
與尺寸比例，其厚度約為 0.05mm、直徑
約為 7mm，具有體積小、生產批量大等製
程及產品特性。圖 1 (b)為 LCD 面板由單
一像素 array 所組成，包括信號線（Data 
line）、閘線（Gate line）、薄膜電晶體（TFT）
與像素電極，其高解晰度下之感測影像會
形成水平與垂直之紋路表面。圖 1 (c)與(d)
為金屬鑄件與鋼珠兩種各具平面與曲面特
性之金屬物件。本研究將藉由檢驗具多種
特性工業製品表面的細微瑕疵，驗證本研
究所提出基於離散餘弦頻譜之細微表面瑕
疵影像偵測方法，發展適用表面細微瑕疵
的自動化視覺檢測系統，期望對國內產業
界的生產技術之競爭力提升有所幫助。 
 
三、文獻探討 
1. 工業製品表面瑕疵檢測系統 
洪崇祐[17]針對TFT-LCD面板中微觀
瑕疵項目，包括指觸、配向膜孔洞、TFT 面
板刮痕、與粉塵污染進行自動瑕疵偵測，
利用傅立葉影像轉換與反傅立葉影像還原
的技術，濾除 TFT-LCD 規律性紋路具週
期性頻譜響應部分與保留瑕疵頻率元素，
並應用全尺寸小波轉換之特性除去光源不
均之現象,再經過管制界線方式突顯瑕疵
達到瑕疵偵測目的。 
2. 頻率域影像處理 
Lee [4]將一般常用於空間域數位影像
的閥值切割法應用在頻率域的頻譜影像，
所用的頻率域轉換法為傅利葉轉換，並於
研究中說明若影像為空間域的數位影像，
則使用一般的閥值切割法是一個既簡單又
快速的方法，但對於較難切割的影像使用
頻率域的切割方法則能克服空間域切割時
的問題。Tico 等三人[8]使用頻率域轉換中
的小波轉換，應用於指紋辨識領域，其研
究使用 K-NN 之分類器進行績效之評估，
而實驗結果發現其指紋辨識率跟之前之研
究並無太大之顯著差異但此種新方法卻有
較佳之執行效率。Wen [13]等四人設計一
套利用離散小波轉換建構的影像及影片搜
尋系統，其能提供使用者輸入影像的資
料，同時又能達到傳統的文字型搜尋技術
一樣的影片搜尋目的。 
Tsai 等三人[9, 11]使用離散傅利葉轉
換進行方向性與隨機性紋路表面之瑕疵檢
測，其透過分析經傅立葉轉換後之方向性
紋路頻譜的帯狀寬度與隨機性紋路的環狀
分布，進行相關的高通濾波與低通濾波動
作，最後再進行相關瑕疵檢測的動作。此
外，Tsai 與 Hsiao [10]也提出使用多解析度
的方法，檢驗一致性紋路表面上的局部瑕
疵。此種方法不需要依靠傳統上擷取紋路
的特徵，而是使用小波轉換 (Wavelet 
transform)透過在反小波轉換中不同解構
階段時選擇適當的平滑子影像或細微子影
像的組合，在重建後的影像可移除固定與
重複性的紋路圖形且增強瑕疵的區域，最
 5
( ) ( )( / 2) 1 ( / 2) 1 2 2#1 #1', ' 0,0
' 0 ' 0
M N
u v
u v
POO DOO DOO
− −
= =
= −∑ ∑       （8） 
( )( / 2) 1 ( / 2) 1 2#1', '
' 0 ' 0
M N
u v
u v
POE DOE
− −
= =
= ∑ ∑                （9） 
( )( / 2) 1 ( / 2) 1 2#1', '
' 0 ' 0
M N
u v
u v
PEO DEO
− −
= =
= ∑ ∑                （10） 
( )( / 2) 1 ( / 2) 1 2#1', '
' 0 ' 0
M N
u v
u v
PEE DEE
− −
= =
= ∑ ∑                （11） 
 
由式子（8）至（11）的定義，可計算出四
個頻率矩陣的能量值，再進行能量值分
析，其中奇-奇矩陣不包含 DC 值。 
(2). 曲率累和演算能量分析法 
曲率累和演算法為改良式的曲率法結
合累和演算法[18]。將曲率值代入累和演
算法中，以曲率的累積和對此曲率值作一
微量偏移之管制。若曲率之累積和超出管
制界限，則判斷有一累積能量值平緩曲線
之轉折點 R 被偵測出來，而最佳扇形切割
半徑 R*的正確位置則是利用累和演算法
具可回溯製程開始發生偏移點之特性來找
出。 
假設平面上有三個點分別間隔 k 個距
離，先計算向量 ikA
K 及 ikB
K ，如式子（12）
與（13）所示。由點 Pi與前後第 k個點之
位置座標值所合成之前後向量為 [ ],ik ikA BG G ，
可求得其點 Pi 之曲率值 ikcosθ 為式子
（14），一般 k値設定為(k=4~6)。 
( , )ik i i k i i kA x x y y+ += − −
JK
                 （12） 
( , )ik i i k i i kB x x y y− −= − −
JK
                 （13） 
ik ik
ik
ik ik
A Bcos
A B
θ =
G GiG G                     （14） 
將累積能量值平緩曲線之每一點之曲
率值求算出來後，因曲率值為點 Pi與 Pi-k
之間餘弦函數值，故其值應介於-1 與+1
之間。若 ik| cos |θ 之數值愈接近 1，則表示
此點愈趨近於平滑直線；若愈偏離 1，則
表示此點角度愈尖銳(即有可能為轉折
點)。本研究中利用奇-奇矩陣能量值每一
個點座標求算出 ikcosθ 曲率，將具有方向
屬性之曲率值代入累和演算法中，利用累
和演算法有管制微量異常偏移的特性來偵
測能量值平緩曲線轉折點 R，最後可將最
佳扇形切割半徑 R*定義出來。 
累和管制圖表格判斷製程偏移是否超
出異常的 iC + 與 iC − 計算為式子（15）與
（16）： 
{ }0 1 0    i i iC max , X ( K ) Cμ+ +−= − + +      （15） 
{ }0 1 0    i i iC max , ( K ) X Cμ− −−= + − +     （16） 
其中， iC
+ 與 iC
− ＝0, K  2δσ= 。 
累和管制圖所管制的特徵為奇-奇矩
陣累積能量曲率值，轉折點偵測情形可由
累和管制圖表格中累和輸出值 iC + 或 iC − 的
情形來判定，當 iC + 或 iC − 之累加值大於 H
值(H=4σ or 5σ)則判定為管制圖偵測出
異常情形。累和管制圖發生警訊後經過其
追溯異常變動起始位置之情形，可有效地
追蹤出奇-奇矩陣累積能量曲線之轉折
點，用以定義出最佳扇形切割半徑 R*之所
在位置。 
(a). 反序曲率累和演算法 
曲率累和演算法所能偵測的製程變異
數列與本研究的累積能量數列有許多相同
的特點，例如在數列的某些區段內具有微
量偏移的特性等，不同的是曲率累和演算
法所偵測的數列在前幾期必須為穩定狀
態，但本研究的能量數列在前幾期時為不
穩定狀態，之後漸趨穩定，為能順利應用
累和演算法進行平緩曲線轉折點的偵測動
作，因此本研究將欲偵測的一維能量數列
內的數值進行反向排序的動作，因為若將
能量數列內之數值反序後，將具有前幾期
為穩定狀態，之後開始產生偏移的特性。
進行反序曲率累和演算法之前，首要動作
為將原始的能量數列內的數值進行反序排
列，其定義為： 
 
 7
在本研究中分割還原後之空間域影像
所使用的方法，為電腦視覺自動閥值切割
法中的熵演算法與 Otsu algorithm，可以用
來偵測本研究影像中細微的瑕疵影像，在
未經離散餘弦處理之前若直接使用自動閥
值切割法，將因影像中有太多的雜訊而造
成誤判，但使用了離散餘弦轉換搭配本研
究所提之反序累和曲率演算法與反序差累
和曲率演算法進行頻譜影像增強法後，將
可精確的定位出瑕疵影像，並可計算出其
各種影像特徵值。 
(5). 實例驗證與效益評估 
在應用離散餘弦轉換與能量分析後，
使 用 本 研 究 所 提 出 的 RC-CUSUM 、
RDC-CUSUM與 FIR方法分別進行離散餘
弦頻譜扇形切割半徑與矩形寬帶之偵測，
使其得以順利進行高通濾波的動作，之後
再轉換回空間域的數位影像，進行偵測細
微針孔狀瑕疵影像的動作與結果呈現。 
本研究針對所提之能量値瑕疵偵測方
法與先前研究進行比較，分別計算α誤判
（正常判定為瑕疵，望小特性），與β誤判
（瑕疵判定為正常，含瑕疵總數誤判錯
誤，望小特姓），依序根據型一及型二誤差
與先前研究進行偵測效率之效益評估。 
本研究針對表面細微瑕疵偵測系統研
究流程，其詳細過程說明如下： 
1. 影像在離散餘弦頻譜上的特性 
(1). 隨機性紋路中瑕疵影像資訊 
本研究針對 SBL(隨機性紋路)影像，
以瑕疵影像(Defective SBL)與無瑕疵影像
(Faultless SBL)為例，依序使用低通濾波、
低通濾波(去除 DC 值)、高通濾波(DC 值
保留)、高通濾波四種不同 DCT 濾波的方
式，依影像經能量分析所獲得之最佳扇形
切割半徑對頻率域影像進行濾波處理，進
而尋找出切割區域與針孔狀瑕疵影像資訊
於頻率域影像中的位置。嘗試使用四種不
同 DCT 濾波方式之瑕疵偵測之結果，可以
發現適用本研究之濾波方式為去除最佳半
徑以內的頻率元素(High -Pass Filtering:低
通濾波)，且移除 DC 值，因為 DC 區是整
張頻譜圖中產生能量最大的位置，DC 值
為整張影像的明暗度變化之平均值，加入
DC 值會使整張影像之背景與針孔細微瑕
疵不易區隔，導致在瑕疵偵測判定上的誤
判，會使誤判的個數α提升。以細微瑕疵
類型來說，加入 DC 值會使瑕疵面積值增
大導致瑕疵面積偵測的誤判，因此剔除
DC 值有利於本研究之細微瑕疵偵測，如
圖 3 所示。 
(2). 結構性紋路背景瑕疵影像資訊 
本研究針對 LCD (結構性背景紋路)
影像之表面瑕疵偵測，依結構性背景紋路
經 DCT 轉換後具有垂直能量與水平能量
集中之頻譜特性，使用 FIR 進行頻譜能量
值分析以獲得最佳矩形寬帶切割值，再針
對頻率域影像進行濾波處理，進而尋找出
切割區域即具結構性背景紋路影像資訊於
頻率域影像中的位置。 
依據此ㄧ規律性進行後續選擇濾波器
大小之研究時，只須要擷取各類型影像其
能量集中之矩陣能量值進行分析即可，不
但能只針對其能量集中即頻率響應部分進
行分析、同時也節省自動化處理時程式的
運算時間。 
2. 影響能量集中性的參數與因素 
本研究經由改變拍攝時因子設定的實
驗設計，找出影響能量集中於奇-奇矩陣之
重要因子，最後透過分析重要因子找出最
佳化拍攝模式。根據 Model 與數值分析的
結果，如圖 4 所示，C（z:位置）對於反應
變數 Yp 為重要因子，且位置設在低位準
(0)、面積設為高水準(60W) 與形狀 (圓
形)，能使 Yp 達到望大特性。 
3. 重要因子之敏感度分析 
根據上述實驗設計分析的結果得知，
本研究所提之奇-奇矩陣能量分析方法會
 9
五、結果與討論 
本計畫所提頻率域影像增強處理，主
要是透過電腦視覺系統擷取待測影像，實
驗影像拍攝環境如圖 8 所示，透過二維正
離散餘弦轉換將其轉換至頻率域頻譜影
像，之後透過頻譜解構與能量分析，偵測
頻譜矩陣能量之平緩曲線轉折點法以決定
切割值的大小，去除部份頻譜值後再將其
轉換回空間域數位影像，再進行瑕疵影像
的偵測與特徵值擷取的動作，系統程式介
面，如圖 9 表面細微瑕疵偵測系統之使用
介面所示。本研究所提之偵測方法於計畫
所提及之工業製品細微瑕疵樣本皆能被偵
測出瑕疵，如圖 10 實驗樣本瑕疵偵測結
果影像所示。 
 
六、計畫成果自評 
本計畫之成果自評依所發展之表面細
微瑕疵系統可分成下列幾點說明： 
1.建構離散餘弦頻譜解構與能量分析程序 
本研究透過二維離散餘弦頻譜解構程
序，分析離散餘弦頻率矩陣能量累積的趨
勢性，發展成為新式的一般細微瑕疵偵測
與具背景紋路影像之瑕疵偵測技術 
2. 影響能量累積之重要因子敏感度分析 
以實驗計劃法進行重要因子的敏感度
分析，決定各式目標物的影像拍攝之參數
設定，且找出能量値集中之矩陣以利於後
續最佳閥值之偵測。 
3. 建構一般性表面細微瑕疵偵測系統 
透過與二維離散餘弦頻譜解構程序的
結合分析能量集中趨勢，以決定隨機性紋
路影像使用扇形半徑切割法與結構性紋路
影像使用矩形寬帶切割法，再整合能量值
曲率資訊與累和管制法找出最佳切割值，
最後之自動閥值切割，細微瑕疵偵測採用
Entropy 方法，一般瑕疵偵測則使用 Otsu
方法。圖 11 顯示，結構性背景紋路瑕疵偵
測適用 FIR 找尋最佳矩形寬帶切割值 D*
與 Otsu 自動閥值切割。 
以上三個功能的建立，對於本研究之
工業製品表面之細微瑕疵影像偵測的研
究，皆有相當重大的關聯。不同影像{隨機
性紋路、結構性紋路(如圖 12 所示) }藉由
頻率域轉換低頻區、中頻區與高頻區的不
同特性，進行不同的影像增強處理，以輔
助完成一般空間域方法難以偵測的表面瑕
疵偵測。 
本計畫之成果不但具有學術研究價值
且亦具有實際應用於工業產品檢測之潛
力，而所發展出的表面細微瑕疵偵測系
統，已匯集部分內容與初步成果發表於：
中國工業工程學會九十四年度年會暨學術
研討會[16]。 
精密工業與電子產業為我國目前看好
的熱門高科技產業，儼然為國家未來發展
的主流，許多廠商也紛紛投入此領域之生
產與開發，因此有效改善產品之生產技術
與品質，加速此產業技術的成熟也是一重
點的發展關鍵。本計畫之成果，盼能解決
工業界廠商對於產品表面細微瑕疵之自動
化檢測與品質管制之問題，藉以協助國內
業者對於產品表面細微瑕疵檢測技術之發
展所需的品質管制模式與評估要求，並進
一步發展一套結合自動化視覺檢測之電腦
視覺系統，藉以發展與構建最適合國內工
業界所需之表面細微瑕疵檢測技術與品質
管制系統，以提高國家工業界生產技術發
展之競爭力。 
 
參考文獻 
[ 1 ] Chan, Yuk-Hee, Lap-Pui Chau, and Wan-Chi 
Siu, “Efficient implementation of discrete 
cosine transform using recursive filter 
structure,” IEEE Transactions on Circuits 
and Systems for Video Technology, Vol. 4, 
No. 6, pp.550-552, 1994. 
[ 2 ] Garg, G., P. K. Sharma, and S. Chaudhury, 
“Image based document authentication 
using DCT,” Pattern Recognition Latters, 
Vol.22, pp.725-729, 2001. 
 11
 輸入欲檢測之
待測影像
分析能量曲線
偵測最佳扇形半徑
消除離散餘弦頻譜中
最佳扇形半徑範圍內
之頻譜值
還原離散餘弦頻譜
至空間域影像
分離背景影像與
瑕疵影像
轉換空間域影像
至離散餘弦頻譜
產生目標物遮罩
正離散餘弦轉換
移除正常影像的
頻譜值
反離散餘弦轉換
套用目標物遮罩
並使用Entropy
自動閥值切割
擷取分離出之
瑕疵影像特徵值
離散餘弦頻譜之
解構與能量分析
使用頻譜解構法與
本研究所提能量分析
標示目標物遮罩範圍
內所有的瑕疵區域
頻率域影像增強法
實驗不同的最佳
扇形切割半徑偵測法
並取最佳偵測法切割
偵測與切割瑕疵影像
頻率域之濾波處理
DCT能量集中性分析
DCT能量曲線分析
輸出檢驗結果 檢測結果之統計分析報表
實驗與效益評估
進行最佳切割半徑之
敏感度分析
改變瑕疵面積大小
對檢測結果的影響
改變照射光源之強弱
對檢測結果的影響
將瑕疵面積做很小差
異之變動以進行實驗
在不同的光源功率
下拍攝影像進行實驗
將最佳半徑做很小差
異之變動以進行實驗
環境參數的改變
重要參數之
敏感度分析
檢測模式
是否適用?
Yes
No
進行檢測結果
之統計分析
計算各種檢測結果之
統計型一與型二誤差
檢測結果統計項目:
1. 正確偵測的瑕疵數
 2. 誤判的瑕疵數
 3. 遺漏的瑕疵數
 4. 偵測瑕疵之面積偏差率
瑕疵面積的改變
 
圖 2  本研究之表面細微瑕疵檢測系統流程圖 
 
 
圖 3  去除最佳半徑以內的頻率元素(高通濾波) 
 
 
圖 4  能量集中性之實驗計劃法 Yp 數值分析 
 13
SBL 半導性瓷片 Small defect Medium defect Large defect 
Original image 
(Defective) 
   
 (a1) 瑕疵面積 6pixel (b1) 瑕疵面積 10pixel (c1) 瑕疵面積 14pixel 
Restored image 
   
 (a2) R*=9 (b2) R*=9 (c2) R*=9 
Resulting binary 
images 
   
 (a3) E=114 (b3) E=117 (c3) E=106 
圖 7  不同瑕疵面積大小之檢測結果 
 
 
圖 8  本研究實驗影像拍攝時之環境架構 
 
 
圖 9  本研究表面細微瑕疵偵測系統之使用介面 
