目  錄 
中文摘要............................................................................................................................................................... I 
Abstract ................................................................................................................................................................. I 
1. 前言.............................................................................................................................................................. 1 
2. 研究目的...................................................................................................................................................... 3 
3. 研究方法...................................................................................................................................................... 3 
3.1. Notations .............................................................................................................................................. 4 
3.2. The proposed secure and cost-effective content protection scheme .................................................... 4 
3.3. The proposed scheme for accommodating expectations of consumer personal uses .......................... 7 
3.4. The proposed fair use scheme for DTV broadcasting ......................................................................... 9 
4. 結果與討論................................................................................................................................................ 11 
4.1. The secure and cost-effective content protection scheme for server sides ........................................ 11 
4.2. Accommodating expectations of consumer personal uses................................................................. 12 
4.3. The fair use scheme for DTV broadcasting ....................................................................................... 13 
5. 結論............................................................................................................................................................ 14 
6. 參考文獻.................................................................................................................................................... 15 
 
 II
unfair and inconvenient since the subscribers cannot receive programs for themselves on any set-top boxes 
owned. By applying the experience of binding rights object to a specific consumer to the use of streaming 
contents in home domain, a novel scheme for fair use is presented to receive programs for subscribers 
themselves on any set-top boxes. Therefore, the main contribution of this project is designing DRM systems 
that keep fairer balancing between the interests of content providers and consumers. We believe that the 
research results of this project can encourage consumers to use the DRM service again to benefit the digital 
content industry. 
 
Keywords: content protection, content portability, DRM, efficiency, fair use. 
 
 2
 Whenever content is newly produced by one of the contracted content providers, the additional cost for a 
secure channel establishment between a content provider and the license server, used to securely transmit the 
corresponding content encryption key, will be required. From the expense perspective for establishing the 
secure channel, it is extremely costly because large numbers of content encryption keys associated to various 
contents must be transmitted between a content provider and the license server via the secure channel in the 
existing DRM systems. Moreover, there is a heavy burden on the license server when it comes to managing 
large numbers of the content encryption keys and securing against server compromises. 
(2) Unfair use in device-based and smart-card-based DRM systems 
The term “DRM” is treated as “anti-copying protection” by content providers. Without taking the 
behaviors and needs of consumers into account, the existing DRM systems have been associated with 
prohibitively tight protection measures that have unnecessarily draconian restrictions on usage rights. The 
device-based DRM systems that tie rights object to a specific device or few specific ones include the 
commercial Apple FairPlay, Microsoft’s Windows Media DRM [11], and OMA DRM [12]. The device-based 
DRM system results in restriction on content portability. That is, a consumer cannot consume the content 
she/he has bought before on the device she/he switches to because the switched device fails to pass the 
hardware checks in these DRM systems. Undoubtedly, from the viewpoint of consumers’ use expectations, the 
term “DRM” has a very negative connotation, such as “Digital Restrictions Management” rather than its 
denotation “Digital Rights Management”. In order to provide content portability for personal use, the 
smart-card-based DRM systems [1][8] appear. The core concept of the smart-card-based DRM systems is that 
the content is consumed if and only if the smart card is presented. However, there are security issues in the 
smart-card-based DRM systems, such as smart card cloning problems in which the illegitimate access to the 
content may take place if the smart card is duplicated. Without both fair use and security functionalities, it 
discourages the consumers from using the service associated DRM-enabled contents again. 
 (3) Unfair use of domain-based devices in streaming contents 
In a pay-TV with a CAS, a program is scrambled by the service provider to prevent unauthorized 
subscribers from receiving the program. The scrambler is controlled by a control word (CW). In order to 
guarantee that only the legal subscriber can derive the CW and then descramble the scrambled program within 
a set-top box (STB), a smart card is used to coordinate with the STB. Without mutual authentication in the 
communication between STB and smart card, the so-called McCormac Hack problems occur when data line 
between STB and smart card is trapped and directed to another STB that acts as if it has the same smart card 
inside. Apart from McCormac Hack problems, smart card cloning is another problem in which a legal smart 
card is duplicated to make many illegal cards used to allow unauthorized subscribers who hold the cloned 
cards to receive the program. To provide the security in terms of mutual authentication between STB and 
smart card, much research [6][9][16] that binds a smart card only to a specific STB has been proposed. 
Nevertheless, such a method does not provide fair use that allows program to be received by the authorized 
subscriber on every STB. This situation is unfair and inconvenient to the authorized subscriber since access to 
programs is restricted only on a specific STB: for instance, the smart card the subscriber owned is permitted to 
be used on the STB in the living room, but not on the STB in the bedroom. 
 4
3.1. Notations 
 The following notations throughout this project repot are depicted as follows: 
p, q: Two random large primes. 
n: The product n = p⋅q. 
e: The public key of license server such that gcd(φ(n), e) = 1 and 1< e< φ(n). 
d: The private key of license server such that d = e−1 mod φ(n). 
H(.): A strongly collision-free hash function.  
h(.): A secure one-way hash function h(.): {0, 1}*→Zn, where Zn denotes the set 
of nonnegative integers less than n. 
EK(.): A symmetric encryption with key K, such as AES or TDES. 
DK(.): A symmetric decryption with key K. 
⊕: A bit-wise XOR operation. 
IDC: An unique identity of the consumer. 
AÆB: M A data M sent from entity A to entity B. 
 In addition, “LS”, “C”, “D”, and “O” denote the license service, the consumer, the distributor, and the 
content provider, respectively. Assume that a public key infrastructure has been established and the license 
server obtains a key pair (e, d) and the corresponding certificate from CA. 
3.2. The proposed secure and cost-effective content protection scheme 
 The proposed content protection model [2] is illustrated in Fig.2. The following three phases to compose 
the model are mandatory, which are indicated as the solid line in Fig.2: 
(1) Delegation phase: The content provider will delegate its access-authorizing capability to the contracted 
license server and gives the license server the power for further discovery of the content encryption key. 
(2) Package and key embedded phase: The content provider encrypts its own content with a content 
encryption key as the protected content. After that, the content provider embeds the content encryption 
key into the protected content.  
(3) License generation phase: The license server firstly discovers the embedded content encryption key 
from the protected content. Next, the license server generates an appropriate license containing 
information about the identity of the consumer, the content encryption key, and the authorized usage 
rule applied to the content.  
Assume that a content provider has a key pair in identity-based (ID-based) cryptography issued from a 
trusted third party −the Private Key Generator (PKG), in which the public key of the content provider is 
generated from a known identity value such as the content provider’s ID, e-mail address, and so on. Note that 
the scheme [13] is the improved version of Shamir’s ID-based signature to resist Chosen-ID attack. In this 
report, the public key of the content provider is denoted as IDO. 
 6
(1) Define a set of UR that is specified in LA of WR. 
(2) Produce the metadata, denoted as MD, referring to the information about Content, such as content 
identity, content provider identity IDO, the corresponding UR, the various components that Content is 
made of, and content type, etc. 
(3) Privately choose a random number k∈Zn. 
(4) Compute CK for Content as  
     CK = H(k, MD),             (2) 
 where k is used to be the secret component of CK and is crucial to computing CK. 
(5) Encrypt Content with CK as ECK(Content). 
(6) Compute a digest of ECK(Content) as CIP = H(ECK(Content)). 
(7) Seal a signature (rc, sc) on MD and CIP by using IKO as 
     rc = ke mod n,                                      (3) 
     sc = IKO⋅kH(rc, MD, CIP) mod n.                     (4) 
(8) Generate the protected content PC = ((rc, sc), MD, (WR, sWR), ECK(Content)). 
(9) Transform PC to the distributor. 
 The distributor avails PC for distribution and prompts it. Moreover, with the license server’s public key e 
and the content provider’s public key IDO, a consumer is convinced that any unauthorized modification does 
not exist in the downloaded PC if and only if the following signature equality holds 
     (sc)e = h(sWR, IDO)⋅rcH(rc, MD, CIP) mod n.         (5) 
3.2.3 License Generation Phase 
 To render PC, the consumer connects with URLLS, recorded in WR.  
Step 1. CÆLS: (rc, sc), MD, (WR, sWR), IDC, SR 
The consumer makes a payment for the corresponding license and selects a usage rule SR which is a 
subset of UR according to what the consumer desires, such as play for 1 month. 
Step 2. LSÆC: L, sL 
Upon receiving ((rc, sc), MD, (WR, sWR), IDC, SR), the retrieval of CK and the generation process of a 
valid license are performed by the license server as follows: 
(1) Verify (WR, sWR). 
(2) Check whether SR is a subset of UR in WR or not. 
(3) Use d as a clue to discovery of the embedded k from rc by the following equation: 
     k = (rc)d mod n.              (6) 
(4) Retrieve CK = H(k, MD).                (7) 
(5) Prepare L = (CK, IDC, SR, TL), where TL is the due date of the license. 
(6) Sign L as follows: 
     sL = h(L)d mod n.              (8) 
 8
The consumer uses the rendering device to perform the following procedures in the tamper-proof 
memory: 
(1) Prepare his/her identity IDC. 
(2) Use the generation procedure Gen(.) of fuzzy extractor with the scanned physiological feature, denoted 
ω, to extract a uniform randomness R and a helper string α as follows: 
Gen(ω) → (R, α).             (10) 
(3) Compute a consumer master key MKC: 
MKC = h(R, IDC, α).             (11) 
(4) Send {IDC, MKC, α} as a registration request via a secure channel. 
Note that the consumer master key MKC is the hashed result of {R, IDC, α} instead of the 
physiological feature ω or the uniform randomness R. In addition, the computed MKC will be deleted in 
the tamper-proof memory after the registration request is sent. 
Step 2. LSÆC: (rC, sC), α, TC 
Upon receiving the request from the consumer, the license server will perform the following 
operations: 
(1) Check whether IDC is legal or not. 
(2) Generate the expiration date TC for this registration. 
(3) Seal a signature (rC, sC) on the consumer’s IDC, α, MKC, and TC with the signature scheme [13]: 
     rC = MKCe mod n, and                               (12) 
     sC = h(IDC)d ⋅ MKCH(rC, α, TC) mod n.                       (13) 
(4) Delete MKC. 
(5) Send the authorization information {(rC, sC), α, TC} via physically delivering a memory card which has 
this information stored, or digitally transferring it on the encrypted links, for example. 
Upon receiving {(rC, sC), α, TC}, the consumer checks whether α is the one transmitted to the license 
server and whether TC is valid. Furthermore, to determine whether or not (rC, sC) is issued from the license 
server, the truth can be verified by using the license server’s public key and the consumer’s identity, if and 
only if the following equality holds 
    sCe = h(IDC) ⋅ rC H(rC, α, TC) mod n.          (14) 
3.3.2 License Acquisition Phase 
The consumer downloads MD and ECK(Content) from the distributor. To render this protected content, 
the consumer has to buy a valid license from the license server. The payment processes occur between the 
license server and the consumer, which are beyond the scope of this research. After the payment for the 
license is accomplished, the license acquisition phase is enabled. 
Step 1. CÆLS: MD, IDC, (rC, sC), α, TC 
The consumer uses his/her device to perform the following operation for acquiring the corresponding 
license: 
(1) Get the URL of rights web page of the license server from MD. 
Step 2. LSÆC: Z, IDC, MD, TL, sL 
The license server will perform the following procedures: 
(1) Check whether or not IDC is legal. If it does not hold, reject the request. 
(2) Check whether or not TC is expired. If it does not hold, ask the consumer to return to the Registration 
 10
(3) Compute verifier V = H(IDC, R). 
Step 2. SMSÆSubscriber: IDC, MPK, α 
Upon receiving the registration request from the subscriber, SMS performs the following tasks: 
(1) Compute a shared key KC = H(IDC, KB) for the subscriber, where KB is STB’s private key and we 
assume that all the STB have the same KB. 
(2) Generate MPK = V ⊕ KC. 
(3) Store IDC, MPK, and α in the smart card and issue it to the subscriber. 
3.4.2 Login and Mutual Authentication Phase 
 This phase is started if the subscriber attaches his/her smart card to a STB and imprints his/her 
physiological information on the sensor to attempt receiving the program.  
Step 1. Smart CardÆSTB: IDC, TC, MACC 
The smart card will perform the following operations: 
(1) Obtain a biometric trait ω′ from the scanned physiological information. 
(2) Perform Rep(ω′, α)→(R). 
(3) Compute verifier V = H(IDC, R).  
(4) Retrieve the shared key KC = MPK ⊕ V.  
(5) Compute MACC = H(TC, KC), where TC denotes current time stamp generated by subscriber. 
Step 2. STBÆSmart Card: TC, TS, MACS 
Upon receiving the request from the smart card, STB performs the following procedures: 
(1) Check the freshness of TC. If TC has already appeared in an executed session, stop the following steps. 
(2) Compute KC′ = H(IDC, KB). 
(3) Verify the received MACC by computing H(TC, KC').  
(4) Compute MACS = H(TC, TS, KC'), where TS denotes current time stamp generated by STB. 
Step 3. Smart CardÆSTB: TS, MACC' 
After receiving the messages from STB, the smart card authenticates STB as follows: 
(1) Check if the received TC is equal to the stored TC to assure the freshness of the received message. 
(2) Verify the received MACS by computing H(TC, TS, KC). 
(3) Compute MACC' = H(TS, KC + 1). 
 After receiving MACC' from the smart card, STB checks if the received TS is equal to the stored TS to 
assure the freshness of the received message. If the received TS is fresh, STB computes H(TS, KC' + 1) to 
verify the received MACC'. If it holds, the smart card is authenticated by STB. 
3.4.3 Key Agreement Phase 
 After the mutual authentication between STB and the smart card is achieved, a common session key 
shared between them is computed as SK = H((TC, TS) ⊕ KC') and SK = H((TC, TS) ⊕ KC) and respectively 
agreed by STB and the smart card because of the fact that KC' is equal to KC.  
 12
(2) Integrity of Content and Its License 
 The integrity of content and its license is guaranteed by examining the following cases: 
 Case 1. An attacker attempts to modify the protected content. The protected content is signed by the 
content provider with the signing key. The signing key is computed with the license server’s private key as Eq. 
(1). Because all server members principally mind that their revenues are decreased from unauthorized 
accesses by the consumer and then resist consumers’ piracies in co-ordination, the license server is trusted by 
the content provider. In addition, according to Assumption 1, none can create a valid signing key to pass the 
signature verification Eq. (5) [13]. If any alteration is made on or any malicious code is attached to the 
protected content, the alternation leads to failure in the verification of the signature (rc, sc), Eq. (5), and will be 
detected. 
 Case 2. An attacker attempts to modify the license. The license is signed by the license server. The 
signature on the license can be verified through Eq. (9) to detect any modifications of the license. Hence, the 
integrity of the license is guaranteed. 
(3) Simple Key Management 
 The component of content encryption key, k, appears as a part of an ordinarily digital signature (rc, sc) for 
the protected content. None can retrieve the k to compute the content encryption key from the signature (rc, sc) 
except the license server. With the private key, the license server can retrieve the content encryption key from 
the component of the protected content, sent from the consumer, as Eq. (7). That is, the license server keeps 
only its private key instead of security-sensitive databases storing large number of content encryption keys. 
Hence, the management of content encryption keys is simplified for the license server. 
(4) Cost Reduction 
 With the way that the content encryption key can be retrieved from the component of the protected 
content, secure channels between a content provider and the license server need not be established to transmit 
the content encryption keys. Only one signing key is sent in a secure channel between a content provider and 
the license server instead of a huge amount of content encryption keys. Hence, the cost for the establishment 
of numerous secure channels can be effectively reduced, which will be a great benefit to DRM systems. 
(5) Efficiency 
 The ID-based signature has been employed to seal signatures on the protected content and the warrant by 
the content provider. In this way, the verification of the signatures on the protected contents and warrants do 
not demand the public key certificates of the numerous content providers. Instead, only the public key 
certificate of the license server is required. For instance, to verify the signature (rc, sc) on the protected content, 
the content provider’s ID and only the public key certificate of the license server are required in Eq. (5). 
Hence, the proposed scheme can provide efficiency due to decline in the verification of the numerous content 
providers’ public keys and removal of the large content providers’ public key directories. 
4.2. Accommodating expectations of consumer personal uses 
 In this subsection, the following criteria are examined to show that accommodating expectations of 
consumer personal uses are done for preserving consumers’ interests: 
(1) Confidentiality of Content Key 
 The content key is protected with the consumer key UKC in Eq. (17). In order to compute the consumer 
key, it is necessary to obtain the secret consumer master key MKC. As the consumer master key is not saved in 
 14
(1) Mutual Authentication 
 The session key SK is treated as a clue to authenticity of both STB and the authorized subscriber who has 
a coupled smart card. The session key is generated as the output of a one-way hash function whose input is the 
XOR operation result of the shared key KC between STB and the smart card and the concatenation of TC and 
TS. Mutual authentication between STB and smart card is examined as follows: 
 Smart Card Authentication 
 In order to retrieve the shared key, verifier V and MPK are necessary because of KC = MPK ⊕ V. 
The MPK is stored instead of the biometric trait ω into a specific smart card tied to an authorized 
subscriber. The verifier V is only derived from a biometric trait of the authorized subscriber. As a 
biometric trait is extremely difficult to copy, share, and distribute, the only way to derive V is that the 
legal subscriber is presented at the time and the STB his/her smart card inserted to receive the program. 
That is, except the legal subscriber with his/her smart card, no one can derive the shared key KC. With the 
shared key, STB can authenticate subscriber/smart-card by verifying MACC and MACC'.  
 STB Authentication 
 For the STB, the shared key is computed with the subscriber’s identity and STB’s private key. 
According to Assumption 2, STB is capable of protecting its own long-term private key from any 
disclosure. As only the STB can compute MACS = H(TC, TS, KC'), the subscriber/smart card will 
authenticate the STB by verifying MACS.  
 If the adversary wants to replay the legal messages MACC, MACS, and MACC', the replay attack will fail 
since these messages involve timestamps used for the challenge and response mechanism. According the 
above analysis, the mutual authentication is achieved. 
(2) Resistance against McCormac Hack Problems 
 When the data line is trapped between STB and smart card and redirected to another STB, called STB B, 
the STB B receiving the redirected data CW' has no information about a legal session key without mutual 
authentication and key agreement phases. Without the session key, the STB B cannot derive the CW from 
decrypting CW'. Hence, McCormac Hack problems cannot work. 
(3) Resistance against Smart Card Cloning Problems 
 Even if the smart card of the subscriber is cloned, the cloned smart card cannot pass mutual 
authentication phase without the biometric of the subscriber. As a result, the proposed scheme is secure from 
smart card cloning problems. 
(4) Fair Use 
 Unlike the related research, our scheme does not tie a smart card to a specific STB. Instead, our scheme 
binds a smart card to the subscriber authorized by SMS. The program of DTV can be received on every STB 
if the subscriber and his/her smart card are presented.  
5. 結論 
 In this project, three schemes are proposed to achieve that goal that fairer balancing between the interests 
of content providers and consumers. Fist, the content protection is proposed without maintaining an awkward 
storage to securely keep large numbers of content encryption keys, the verification of the numerous content 
 16
(NSC 98-2221-E-035-031 and NSC 098-2811-E-035-009) 
[8] W. B. Lee, W. J. Wu, and C. Y. Chang, “A portable DRM scheme using smart cards,” Journal of 
Organizational Computing and Electronic Commerce, Vol. 17, No. 3, pp. 247-258, 2007. 
[9] J. S. Lee, H. S. Rhee, and D. H. Lee, “Efficient and secure communication between set-top box and smart 
card in IPTV broadcasting,” Proceedings of International Conference on Convergence and Hybrid 
Information Technology, pp. 307-310, Aug. 2008. 
[10] I. Maghiros, Y. Punie, S. Delaitre, E. Lignos, C. Rodríguez, M. Ulbrich, M. Cabrera. B. Clements, L. 
Beslay, and R. V. Bavel, “Biometrics at the frontiers: Assessing the impact on society,” Institute for 
Prospective Technological Studies, Technical Report EUR 21585 EN, Feb. 2005. 
[11] Microsoft Corporation, Digital rights management (DRM), 2010, 
http://www.microsoft.com/windows/windowsmedia/forpros/drm/default.mspx. 
[12] Open Mobile Alliance, DRM architecture, Candidate Ver. 2.1. 2009, 
http://www.openmobilealliance.org/release_program/docs/DRM/V2_1-20070724-C/OMA-AD-DRM-V2_
1-20070724-C.pdf. 
[13] H. Qian and Z. Cao, “A novel ID-based partial delegation with warrant proxy signature scheme,” 
Proceedings of the ISPA 2005 Workshops, Nanjing, China, LNCS 3759, pp. 323-331, Nov. 2005. 
[14] W. Stallings, Cryptography and Network Security: Principles and Practices, 3rd Edition, Prentice Hall, 
New Jersey, 2003. 
[15] U.S. Copyright Office, Copyright Law of the United States of America and Related Laws Contained in 
Title 17 of the United State Codes, Oct. 2007. http://www.copyright.gov/title17/. 
[16] E. J. Yoon and K. Y. Yoo, “Robust key exchange protocol between set-top box and smart card in DTV 
broadcasting,” Informatica, Vol. 20, No. 1, pp. 139-150, Feb. 2009. 
1378         H. Chen et al. /Journal of Computational Information Systems 6:5(2010) 1377-1386 
 
(3) License server is responsible for creating and issuing a license, also known as a rights object 
[13][14], that restrains what usage rules and rights are associated with what content and which devices, 
smart cards, or consumers. The license server typically has a contract relationship with the content owner 
and is delegated to give license for playing the content produced by the contracted content owner. 
(4) Consumer who uses the DRM system renders the desired content in accordance with the 
corresponding license through a compliant device. The rendering device must support the DRM system and 
could have a DRM agent, which is responsible for properly interpreting the usage rules and rights defined 
in the license and for controlling the content consumption in accordance with the usage rules and rights. 
The common DRM workflow [10] is depicted in Fig.1. Firstly, the content owner encodes a digital 
content into the format supported by the DRM system. The content is then encrypted and packaged using a 
content encryption key, generated by the content owner, as a protected content. The protected content is 
transferred to the appropriate distributor for distribution. Secondly, a set of usage rules corresponding to the 
content is defined by the content owner. Then, the content encryption key and the set of usage rules are 
securely transferred to the license server. Thirdly, the consumer can freely download the protected content 
from the distributor. Before being able to play the protected content on the device, the consumer has to 
require a valid license from the license server. Once the consumer pays legal tender for the license, the 
license is securely downloaded on the consumer’s device. Afterward, the device uses the content 
encryption key to unlock the protected content and then renders the content in a form based on the 
authorized usage rules and rights included in the license. 
 
 
Fig.1 A Typical DRM Workflow 
Since cryptography is a general measure to reach basic content protection −content confidentiality, key 
management is crucial to security and efficiency of the cryptographic measure. To ensure a secure delivery 
of content encryption key from any eavesdropping and tampering over the Internet, a secure channel 
establishment, such as via Diffie-Hellman key exchange [6], encrypted key exchange [5], public key, 
face-to-face, and so on, between a content owner and the license server is required. Generally, the 
“many-to-one” relation exists since a large number of content owners have contracts with the same license 
server, shown as Fig.2: for instance, the Walt Disney Company, Twentieth Century Fox Film Corporation, 
Audible.com, and so on confirm contracts with Apple iTunes Store. Whenever content is newly produced 
by one of the contracted content owners, the additional cost for a secure channel establishment between a 
content owner and the license server, used to securely transmit the corresponding content encryption key, 
will be required. From the expense perspective for establishing the secure channel, it is extremely costly 
because large numbers of content encryption keys associated to various contents must be transmitted 
between a content owner and the license server via the secure channel in the existing DRM systems. 
Distributor 
Protected Content Protected Content 
(2) 
(3) 
License Server 
Consumer 
License (4) 
(1) 
Content Encryption Key  
+Usage Rule 
Content Owner 
1380         H. Chen et al. /Journal of Computational Information Systems 6:5(2010) 1377-1386 
 
time-consuming verification of the content owners’ public keys if the content has integrity. Therefore, in 
this paper, a secure and cost-effective content protection scheme for DRM systems is proposed to fulfill 
these requirements. 
The rest of this paper is organized as follows. In Section 2, the proposed scheme is introduced. In Section 
3, analysis of how the requirements are fulfilled is examined. In Section 4, comparisons with the related 
works are given. Finally, conclusions are given in Section 5. 
2. The Proposed Scheme 
The proposed content protection model of a DRM system is illustrated in Fig.3. The following three phases 
to compose the model are mandatory, which are indicated as the solid line in Fig.3: 
(1) Delegation phase: The content owner will delegate its access-authorizing capability to the contracted 
license server and gives the license server the power for further discovery of the content encryption key. 
(2) Package and key embedded phase: The content owner encrypts its own content with a content 
encryption key as the protected content. After that, the content owner embeds the content encryption key 
into the protected content.  
(3) License generation phase: The license server firstly discovers the embedded content encryption key 
from the protected content. Next, the license server generates an appropriate license containing information 
about the identity of the consumer, the content encryption key, and the authorized usage rule applied to the 
content. 
 
Fig.3 The Proposed Content Protection Model of a DRM System 
2.1. Notations 
The following notations throughout this paper are depicted as follows: 
p, q: Two random large primes. 
n: The product n = p⋅q. 
e: The public key of license server such that gcd(φ(n), e) = 1 and 1< e< φ(n). 
d: The private key of license server such that d = e−1 mod φ(n). 
H(.): A strongly collision-free hash function.  
h(.): A secure one-way hash function h(.): {0, 1}*→Zn, where Zn denotes the set of nonnegative 
integers less than n. 
EK(.): A symmetric encryption with key K, such as AES [19] or TDES [19]. 
License RequestLicense Server Delegation  
Package and Key 
Embedded Distributor 
(1) 
(2) 
License  
Generation 
Protected Content Protected Content 
License 
(3) 
Consumer Content Owner 
1382         H. Chen et al. /Journal of Computational Information Systems 6:5(2010) 1377-1386 
 
Step 7. Seal a signature (rc, sc) on MD and CIP by using IKO as 
     rc = ke mod n,                                 (3) 
     sc = IKO⋅kH(rc, MD, CIP) mod n.                  (4) 
Step 8. Generate the protected content PC = ((rc, sc), MD, (WR, sWR), ECK(Content)). 
Step 9. Transform PC to the distributor. 
In Step 7, the secret component of the content encryption key associated with Content is embedded into 
the ordinary signature process of the ID-based cryptography scheme [16], which is a superior way to have 
no extra cost for hiding the secret component k. 
The distributor avails PC for distribution and prompts it. At this point, everyone can verify (WR, sWR) to 
learn about the delegation relationship between the content owner and the license server. Moreover, with 
the license server’s public key e and the content owner’s public key IDO, a consumer is convinced that any 
unauthorized modification does not exist in the downloaded PC if and only if the following signature 
equality holds 
     (sc)e = h(sWR, IDO)⋅rcH(rc, MD, CIP) mod n.      (5) 
2.4. License Generation Phase 
To render PC, the consumer connects with URLLS, recorded in WR. The consumer makes a payment for the 
corresponding license and selects a usage rule SR which is a subset of UR according to what the consumer 
desires, such as play for 1 month. Then, the consumer sends ((rc, sc), MD, (WR, sWR), IDC, SR), where IDC 
denotes the identity of the consumer, to the license server.   
Upon receiving ((rc, sc), MD, (WR, sWR), IDC, SR), the retrieval of CK and the generation process of a 
valid license are performed by the license server as follows: 
Step 1. Verify (WR, sWR). 
Step 2. Check whether SR is a subset of UR in WR or not. 
Step 3. Use d as a clue to discovery of the embedded k from rc by the following equation: 
     k = (rc)d mod n.             (6) 
Step 4. Retrieve CK = H(k, MD).              (7) 
Step 5. Prepare L = (CK, IDC, SR, TL), where TL is the due date of the license. 
Step 6. Sign L as follows: 
sL = h(L)d mod n.                      (8) 
The (L, sL) is treated as the license and is then delivered to the consumer in some secure mechanisms, 
although this is beyond the scope of this paper. Please refer to [4], [9], or [21] for more detailed 
descriptions. After receiving (L, sL), the consumer can be convinced the validity of the signature sL on the 
license if and only if the following equality holds 
     h(L) = sLe mod n.        (9) 
Afterward, through the consumer device, ECK(Content) in PC is decrypted by CK in the license and then 
is rendered based on SR and TL included in the license. 
3. Analysis 
Prior to the analysis, some assumptions are given. 
Assumption 1. The server members including content owner and license server have accomplished 
mutual authentications and therefore trust each other. It is reasonable because all server members 
principally mind that their revenues are decreased from unauthorized accesses by the consumer and then 
1384         H. Chen et al. /Journal of Computational Information Systems 6:5(2010) 1377-1386 
 
pass the signature verification Eq. (5) [16]. If any alteration is made on or any malicious code is attached to 
the protected content, the alternation leads to failure in the verification of the signature (rc, sc), Eq. (5), and 
will be detected. Hence, the integrity of the protected content is guaranteed. 
Case 2. An attacker attempts to modify the license. The license is signed by the license server. The 
signature on the license can be verified through Eq. (9) to detect any modifications of the license. Hence, 
the integrity of the license is guaranteed. 
In addition, the critical component of the content encryption key is embedded into a protected content 
which is public and can be stored in local devices. In the proposed scheme, the content encryption key is 
not privately stored in the license server. The integrity of the content encryption key is critical to the 
confidentiality of content and then be examined in the following case. 
Case 3. An undetectable fault in content encryption key derived from an altered content or a modified 
license exists to fool the DRM system. According to the examination in Cases 1 and 2, the integrity of 
protected contents and licenses is guaranteed. The valid content encryption key is derived only when the 
integrity of protected content or the license. This implies that a failed content encryption key derived from 
a modified content or license is detectable because the modified content or license cannot satisfy Eq. (5) or 
Eq. (9). Hence, this case has no capabilities to fool the DRM system. 
3.3. Simple Key Management 
In the proposed scheme, the component of content encryption key, k, appears as a part of an ordinarily 
digital signature (rc, sc) for the protected content. In other words, the k is well hidden within the signature. 
As with the examination of Case 1 in subsection 3.1, none can retrieve the k to compute the content 
encryption key from the signature (rc, sc) except the license server. With the private key, the license server 
can retrieve the content encryption key from the component of the protected content, sent from the 
consumer, as Eq. (7). That is, the license server keeps only its private key instead of security-sensitive 
databases storing large number of content encryption keys. Hence, the management of content encryption 
keys is simplified for the license server in the proposed scheme. 
3.4. Cost Reduction 
With the way that the content encryption key can be retrieved from the component of the protected content 
as the examination in subsection 3.3, secure channels between a content owner and the license server need 
not be established to transmit the content encryption keys. After sharing the signing key between the 
content owner and the license server, the cost for secure channel establishments used to transmit the content 
encryption keys, corresponding to the content produced by the content owner, will not be necessary. In the 
proposed scheme, only one signing key is sent in a secure channel between a content owner and the license 
server instead of a huge amount of content encryption keys. Hence, the cost for the establishment of 
numerous secure channels can be effectively reduced, which will be a great benefit to DRM systems. 
3.5. Efficiency 
With the ID-based cryptosystem, the proposed scheme inherits the advantage for taking the known signer’s 
ID as the corresponding public key instead of a random number that is necessary to be certified by a CA for 
its validity. The ID-based signature [16] has been employed to seal signatures on the protected content and 
the warrant by the content owner. In this way, the verification of the signatures on the protected contents 
and warrants do not demand the public key certificates of the numerous content owners. Instead, only the 
public key certificate of the license server is required. For instance, to verify the signature (rc, sc) on the 
protected content, the content owner’s ID and only the public key certificate of the license server are 
required in Eq. (5). Hence, the proposed scheme can provide efficiency due to decline in the verification of 
the numerous content owners’ public keys and removal of the large content owners’ public key directories. 
1386         H. Chen et al. /Journal of Computational Information Systems 6:5(2010) 1377-1386 
 
Acknowledgment 
The authors would like to thank the National Science Council of the Republic of China, Taiwan, for 
financially supporting this research under Contract No. NSC 98-2221-E-035-031 and 098-2811-E-035-009. 
Reference 
[1] Abbadi IM. Digital Rights Management for Personal Networks. Technical Report, RHUL-MA-2008-17, 
University of London, Jun. 2008. 
[2] Apple Inc.. Available at http://www.apple.com/, 09/03/2009. 
[3] Becher E, Buhse W, Günnewig D, Rump N. Digital Rights Management: Technological, Economic, Legal and 
Political Aspects. Springer-Verlag, Berlin/New York, 2003. 
[4] Chen HB, Lee WB. Efficient and Portable Digital Rights Management for Preserving User Privacy Using Smart 
Cards. Journal of Computers, Vol. 19, No. 1, pp. 3-12, Apr. 2008. 
[5] Chen TH, Lee WB, Chen HB. A Round- and Computation-Efficient Three-Party Authenticated Key Exchange 
Protocol. Journal of Systems and Software, Vol. 81, No. 9, pp. 1581-1590, Sep. 2008. 
[6] Diffie W, Hellman M. New Directions in Cryptography, IEEE Transactions on Information Theory, Vol. 22, No. 
6, pp. 644-654, 1976. 
[7] Feng M, Zhu B. A DRM System Protecting Consumer Privacy. In Proceedings of the 5th IEEE Consumer 
Communications and Networking Conference, pp. 1075-1079, Jan. 2008. 
[8] Jeong Y, Yoon K, Ryou J. A Trusted Key Management Scheme for Digital Rights Management. ETRI Journal, 
Vol. 27, No. 1, pp. 114-117, Feb. 2005. 
[9] Lee WB, Wu WJ, Chang CY. A Portable DRM Scheme Using Smart Cards. Journal of Organizational 
Computing and Electronic Commerce, Vol. 17, No. 3, pp. 247-258, 2007. 
[10] Liu Q, Safavi-Naini R, Sheppard NP. Digital Rights Management for Content Distribution. In Proceedings of the 
Australasian Information Security Workshop Conference on ACSW Frontiers 2003, Adelaide, Australia, Vol. 21, 
pp. 49-58, 2003. 
[11] Microsoft Corporation. Digital Rights Management (DRM). Available at http://www.microsoft.com/windows/ 
windowsmedia/forpros/drm/default.mspx, 09/06/2009. 
[12] Microsoft Corporation. Windows Media DRM FAQ. Available at http://www.microsoft.com/windows/ 
windowsmedia/forpros/drm/faq.aspx, retrieved 10/05/2010. 
[13] Open Mobile Alliance. DRM Architecture, Candidate Ver. 2.1. Available at http://www.openmobilealliance. 
org/release_program/docs/DRM/V2_1-20070724-C/OMA-AD-DRM-V2_1-20070724-C.pdf, 08/11/2009. 
[14] Open Mobile Alliance. Digital Rights Management, Approved Ver. 1.0. Available at http://www. 
openmobilealliance.org/Technical/release_program/docs/DRM/V1_0-20040625-A/OMA-Download-DRM-V1_0
-20040615-A.pdf, 09/03/2009. 
[15] Popescu BC, Kamperman FLAJ, Crispo B, Tanenbaum AS. A DRM Security Architecture for Home Networks. 
In Proceedings of the 4th ACM Workshop on Digital Rights Management, Cairns, Australia, pp. 1-10, 2004. 
[16] Qian H, Cao Z. A Novel ID-Based Partial Delegation with Warrant Proxy Signature Scheme. In Proceedings of 
the ISPA 2005 Workshops, Nanjing, China, LNCS 3759, pp. 323-331, Nov. 2005. 
[17] Shamir A. Identity-Based Cryptosystems and Signature Schemes. In Advances in Cryptology: CRYPTO 84, 
Santa Barbara, California, United States, pp. 47-53, 1984. 
[18] Schneier B. Applied Cryptography, 2nd Edition. John Wiley and Sons, New York, 1996. 
[19] Stallings W. Cryptography and Network Security: Principles and Practices, 3rd Edition. Prentice Hall, New 
Jersey, 2003. 
[20] Subramanya SR, Yi BK. Digital Rights Management. IEEE Potentials, Vol. 25, No. 2, pp. 31-34, Mar.-Apr. 
2006. 
[21] Sun HM, Hung CF, Chen CM. An Improved Digital Rights Management System Based on Smart Cards. In 
Proceedings of the 2007 Inaugural IEEE International Conference on Digital EcoSystems and Technologies, 
Cairns, Australia, pp. 308-313, Feb. 2007. 
[22] Sun MK, Laih CS, Yen HY, Kuo JR. A Ticket Based Digital Rights Management Model. In Proceedings of the 
6th IEEE Consumer Communications and Networking Conference, Las Vegas, NV, USA, Jan. 2009. 
[23] Trusted Computing Group. Available at https://www. trustedcomputinggroup.org/home, 12/ 10/2009. 
This implies that R can be reproduced exactly if both W 
and W belong to the same personal. 
III. THE PROPOSED SCHEME 
The proposed scheme is composed of four phases: 
registration, login and mutual authentication, key agreement, 
and CW transmission. 
The notations used throughout this paper are the 
following: “AB: M” denotes a data M sent from entity A to 
entity B. “IDC” represents an unique identity of subscriber. 
“TC/TS” denotes current time stamp generated by subscriber/ 
STB. “H(.)” denotes a collision-free hash function, such as 
SHA-512. “” represents a bit-wise XOR operation. 
“Ek(.)/Dk(.)” denotes a symmetric encryption/decryption 
scheme using secret key k. 
A. Registration Phase 
1) SubscriberSMS: IDC, P, V 
If a subscriber applies to subscribe to a charged program 
from a service provider, the subscriber must register at the 
subscriber management system (SMS) that is used to 
administrate the issue or update of smart card for subscriber 
in DTV broadcasting. Assume that the communication in the 
registration phase is transferred in a secure channel. The 
subscriber will make a registration request as follows: 
a) Imprint his/her physiological information to obtain a 
biometric trait W. 
b) Perform Gen(W)(R, P). 
c) Compute verifier V = H(IDC, R). 
2) SMSSubscriber: IDC, MPK, P 
Upon receiving the registration request from the 
subscriber, SMS performs the following tasks: 
a) Compute a shared key KC = H(IDC, KB) for the 
subscriber, where KB is STB’s private key and we 
assume that all the STB have the same KB. 
b) Generate MPK = V  KC. 
c) Store IDC, MPK, and P in the smart card and issue it 
to the subscriber. 
B. Login and Mutual Authentication Phase 
This phase is started if the subscriber attaches his/her 
smart card to a STB and imprints his/her physiological 
information on the sensor to attempt receiving the program.  
1) Smart CardSTB: IDC, TC, MACC 
The smart card will perform the following operations: 
a) Obtain a biometric trait W from the scanned 
physiological information. 
b) Perform Rep(W, P)(R). 
c) Compute verifier V = H(IDC, R).  
d) Retrieve the shared key KC = MPK  V.  
e) Compute MACC = H(TC, KC).  
2) STBSmart Card: TC, TS, MACS 
Upon receiving the request from the smart card, STB 
performs the following procedures: 
a) Check the freshness of TC. If TC has already appeared 
in an executed session, stop the following steps. 
b) Compute KC = H(IDC, KB). 
c) Verify the received MACC by computing H(TC, KC'). 
If it cannot pass the verification, stop the 
communication. 
d) Compute MACS = H(TC, TS, KC'). 
3) Smart CardSTB: TS, MACC' 
After receiving the messages from STB, the smart card 
authenticates STB as follows: 
a) Check if the received TC is equal to the stored TC to 
assure the freshness of the received message. If it does 
not hold, stop the following steps. 
b) Verify the received MACS by computing H(TC, TS, KC). 
If it does not hold, disconnect from the STB. 
c) Compute MACC' = H(TS, KC + 1). 
After receiving MACC' from the smart card, STB checks 
if the received TS is equal to the stored TS to assure the 
freshness of the received message. If the received TS is fresh, 
STB computes H(TS, KC' + 1) to verify the received MACC'. 
If it holds, the smart card is authenticated by STB. 
C. Key Agreement Phase 
After the mutual authentication between STB and the 
smart card is achieved, a common session key shared 
between them is computed as SK = H((TC, TS)  KC') and SK 
= H((TC, TS)  KC) and respectively agreed by STB and the 
smart card because of the fact that KC' is equal to KC.  
D. CW Transmission Phase 
1) Smart CardSTB: CW' 
After deriving CW, the smart card secures CW and sends 
the result to STB for descrambling the program as follows: 
a) Encrypt CW with SK as CW' = ESK(CW). 
Upon receiving CW', STB can derive CW by decrypting 
CW' with SK as CW = DSK(CW'). Then, STB outputs the 
program to the subscriber by using CW to descramble the 
scrambled program.  
IV. ANALYSIS OF THE PROPOSED SCHEME 
A. Mutual Authentication 
In the proposed scheme, session key SK is treated as a 
clue to authenticity of both STB and the authorized 
subscriber who has a coupled smart card. The session key is 
generated as the output of a one-way hash function whose 
input is the XOR operation result of the shared key KC 
between STB and the smart card and the concatenation of TC 
and TS. Mutual authentication between STB and smart card 
is examined as follows: 
1) Smart card authentication 
In order to retrieve the shared key, verifier V and MPK 
are necessary because of KC = MPK  V. The MPK is stored 
instead of the biometric trait W into a specific smart card tied 
to an authorized subscriber. Nobody can get any knowledge 
about W from the smart card. On the other hand, the verifier 
V is only derived from a biometric trait of the authorized 
subscriber. As a biometric trait is extremely difficult to copy, 
157
Authorized licensed use limited to: Feng Chia University. Downloaded on July 08,2010 at 03:30:35 UTC from IEEE Xplore.  Restrictions apply. 
 17
 
國科會補助專題研究計畫成果報告自評表 
請就研究內容與原計畫相符程度、達成預期目標情況、研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）、是否適
合在學術期刊發表或申請專利、主要發現或其他有關價值等，作一綜合評估。
1. 請就研究內容與原計畫相符程度、達成預期目標情況作一綜合評估 
■  達成目標 
□ 未達成目標（請說明，以 100 字為限） 
□ 實驗失敗 
□ 因故實驗中斷 
□ 其他原因 
說明： 
 
 
 
2. 研究成果在學術期刊發表或申請專利等情形： 
論文：■已發表 □未發表之文稿 □撰寫中 □無 
專利：□已獲得 ■申請中 □無 
技轉：□已技轉 □洽談中 □無 
其他：（以 100 字為限） 
 
 
 
3. 請依學術成就、技術創新、社會影響等方面，評估研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）（以
500 字為限） 
 
    本計畫成果率先指出伺服器端存在金鑰管理與傳輸成本隨內容數量增加
而巨幅成長之問題，提出金鑰管理與傳輸成本並不隨著內容數量增加而增加
的解決方案，可為內容供應商省下可觀的成本並提升內容供應商的利益，可
見此成果在學術與技術都具有創新的價值，並可活絡數位內容產業的發展。
    基於此平台，本計畫應用生物資訊技術實現內容播放權利跟著人走取代
跟著設備的概念，只要消費者現身於內容播放現場即可播放內容的方式，可
避免內容侵權(content abuse)以保護內容供應商的營收，同時鬆綁現行對消費
者而言窒礙難行之限定設備限制，以保障消費者被法律所賦予的公平使用權
益，締造同時保障內容供應商與消費者權益的雙贏 DRM 機制。研究成果不
附件二 
 19
 
國科會補助專題研究計畫項下出席國際學術會議心得報告 
                                     日期： 99 年 6 月 8 日 
一、參加會議經過 
    此次參加的是位於加拿大溫哥華舉行之 ISI-2010國際研討會(2010 IEEE International 
Conference on Intelligence and Security Informatics: Public Safety and Security)，自 2003 年
在美國亞利桑那州第一次開辦，本屆已經是第 8 屆舉辦。在這個為期 4 天的會議裡，主
要目的是要提供一個國際公開的場合，可以讓學界、法界、工程界等精英討論先進的網
路犯罪預防機制與公共政策的制定等可以影響網際安全的議題。此行的目的為發表我們
在資訊保護應用方面的研究心得並主持 M2-II Information Systems Security and Cyber 
計畫編號 NSC 98－2221－E－035－031 
計畫名稱 消費者為導向的數位版權管理系統之研究 
出國人員
姓名 李維斌 
服務機構
及職稱 
逢甲大學資訊工程學系 
教授 
會議時間 99 年 5 月 23 日至 99 年 5 月 26 日 會議地點 加拿大-溫哥華 
會議名稱 
(中文)2010 IEEE 智慧與安全資訊學國際研討會 
(英文)2010 IEEE International Conference on Intelligence and Security  
      Informatics: Public Safety and Security (ISI-2010) 
發表論文
題目 
(中文)保護機上盒與智慧卡間的安全傳輸機制以便在數位電視傳播環 
      境中來維護使用的公平性 
(英文) Secure Communication between Set-Top Box and Smart Card for 
      Fair Use in DTV Broadcasting 
主持場次 中文：資訊系統安全及網際安全 
英文：M2-II Information Systems Security and Cyber Security 
 21
    此外，大會也宣佈新的Springer Journal: Intelligence and Security Informatics將在 2011
年發刊，Editor-in-Chief 是 University of Arizona 的 Hsinchu Chen 教授，相關資訊可以參
考 http://ai.arizona.edu/ISI。此外，如果對恐怖份子的行為分析與相關犯罪預防技術有興
趣 的 學 者 專 家 可 以 參 考 Hu 教 授 建 置 的  Dark Web Forum Portal 
http://ai.arizona.edu/research/terror/。 
 
二、與會心得 
    這次聽了不少犯罪預防的技術與實務經驗分享，以前只是在報章雜誌上看到事件，
這次可以聽到事件背後的一些技術研究與理論分析，真的滿有趣的。 
    加拿大剛舉辦完奧運，因此奧運維安的過程與挑戰當然成為這次大會的專題演講主
要議題，看到如此大規模的資訊投入，後勤、預算及機動性的挑戰，可想而知。但是畢
竟沒有相關經驗只能想像，因此有幸能聽到主事者敘述相關場景，還滿興奮的。只是沒
有細節的敘述，還是少了點味道。 
 
    另外，透過此次會議的參與，從中獲得許多的省思，舉例如下： 
1. 加拿大政府宣布一項 $96 million 的安全提升計畫。有鑒於 2008 年有 85,000 頓的貨櫃
運經溫哥華，其中 75%是經由客機載運，而不幸的是這些貨櫃竟然沒有被過濾。加拿
大政府希望能擴大機場能接觸到敏感區域員工的背景調查、貨運公司的認知及監控訓
練，希望透過從貨櫃裝箱開始就進行安控，訓練更多的緝毒犬等等作為希望在 2015
年能完成全部的貨運都能被檢查過濾。實際的技術並沒有被提及，不過反思國內的現
況，不知是否有相似的地方或是可以借鏡的地方? 
 23
里路”，但相對於國立大學，私立學校的學生除了學校的補助外，似乎較難獲得政府的
補助。而學校的經費在僧多粥少的情況下，學生所能得到的補助實在有限。個人以為親
身體驗的感受所能獲得的東西實在很難量化且其影響更不容忽視。因此增加學生國外經
驗及結交國際友人的機會，都是應該且值得投資的。 
 
五、攜回資料名稱及內容 
1. “SIS-2010 會議＂大會手冊。 
 
六、其他 
    無 
 
 
表 Y04                                                                                第 2 頁 
決方案。 
 
在 M2-II Information Systems Security and Cyber Security 的場次中，埃及學者提出 Agent based
的 correlation model 來做入侵偵測，效率看來不錯，只是報告者並非團隊成員，而是來自俄羅
斯的研究生，所以一些細節無法進一步釐清。私下問了這位俄羅斯的研究生，得知其指導教
授與埃及的研究團隊有合作關係，此次埃及團隊無法前來所以請她幫忙報告。其實挺羨慕這
種跨國的合作關係，只是在逢甲這類研究只能尋求重點突破的地方，該如何建立這樣的關係，
我思考著! 
 
此外，大會也宣佈新的 Springer Journal: Intelligence and Security Informatics 將在 2011 年發刊，
Editor-in-Chief 是 University of Arizona 的 Hsinchu Chen 教授，相關資訊可以參考
http://ai.arizona.edu/ISI。此外，如果對恐怖份子的行為分析與相關犯罪預防技術有興趣的學者
專家可以參考 Hu 教授建置的 Dark Web Forum Portal http://ai.arizona.edu/research/terror/。 
 
二、與會心得 
這次聽了不少犯罪預防的技術與實務經驗分享，以前只是在報章雜誌上看到事件，這次可以
聽到事件背後的一些技術研究與理論分析，真的滿有趣的。 
加拿大剛舉辦完奧運，因此奧運維安的過程與挑戰當然成為這次大會的專題演講主要議題，
看到如此大規模的資訊投入，後勤、預算及機動性的挑戰，可想而知。但是畢竟沒有相關經
驗只能想像，因此有幸能聽到主事者敘述相關場景，還滿興奮的。只是沒有細節的敘述，還
是少了點味道。 
 
另外，透過此次會議的參與，從中獲得許多的省思，舉例如下： 
1. 加拿大政府宣布一項 $96 million 的安全提升計畫。有鑒於 2008 年有 85,000 頓的貨櫃運經
溫哥華，其中 75%是經由客機載運，而不幸的是這些貨櫃竟然沒有被過濾。加拿大政府希望
能擴大機場能接觸到敏感區域員工的背景調查、貨運公司的認知及監控訓練，希望透過從貨
櫃裝箱開始就進行安控，訓練更多的緝毒犬等等作為希望在 2015 年能完成全部的貨運都能被
檢查過濾。實際的技術並沒有被提及，不過反思國內的現況，不知是否有相似的地方或是可
以借鏡的地方? 
2. 加拿大聯邦政府(應該是卑詩省吧!)預計年底要通過反垃圾郵件法，希望建立有效的法制力
量，成立 spam-reporting centre 與政府部門合作取得強制關閉相關犯罪網站的權利。不知國內
是否有相關議題的討論或做法? 
 
這次會議對個人而言學到也聽到許多有趣的議題，譬如利用資訊科技在監視設備中找到可疑
的行為、建立海巡署的 SOC 機制、在網路拓蹼上找到可疑的攻擊等等都非常實務又兼具研究
價值的議題，太多的實務議題使我ㄧ直問自己國內的情況呢?研究是可以落實到人間的!這些
內容也吸引我想試著接觸這類議題，只是相關資訊的取得在國內似乎並不開放。中央警大在
這些議題上應該可以有很好的發揮，但是這次只有在議程委員名單中看到不少警大的教授卻
未見相關文獻的發表。如果可以提供一些機會讓民間學者也能接觸相關議題與資訊，相信對
國家社會的安全及研究質量一定是多贏的局面。 
 
此行最大的收穫是對國家及社會安全的議題多了一些認識，很多原本只是想像中的問題直接
呈現在眼前，真希望有機會接觸此類議題的資源，能貢獻自己在資安領域的一些經驗，期望
有機會能建立更好的安全機制來保障大家的人身安全。 
 
Secure Communication between Set-top Box and 
Smart Card for Fair Use in DTV Broadcasting 
 
Wei-Bin Lee, Hsing-Bai Chen, Ching-Chih Cheng  
Department of Information Engineering and Computer Science 
Feng Chia University 
Taichung, Taiwan 40724, R.O.C. 
{wblee, P9317594, M9601628}@fcu.edu.tw 
 
 
Abstract—Existing secure communication mechanisms between 
set-top box and smart card in digital television broadcasting 
are unfair and inconvenient since the subscribers cannot 
receive programs for themselves on any set-top boxes owned. 
In this paper, a novel scheme for fair use is presented to 
receive programs for subscribers themselves on any set-top 
boxes. Moreover, the proposed scheme can prevent McCormac 
Hack and smart card cloning problems which are serious 
threats in digital television broadcasting. 
Keywords-biometrics; condition access system; information 
security; pay-TV; smart card 
I. INTRODUCTION 
Due to extreme changes in information technology 
coupled with the evolution of digital networks, digital 
television (DTV) broadcasting and related technologies have 
been developing actively. To guarantee a secure and 
convenient access of pay-TV services, a conditional access 
system (CAS) that provides a secure access management 
mechanism is required. CAS can lead the legal subscribers to 
access what programs they have subscribed and assist the 
service provider to charge subscription fees. 
In a pay-TV with a CAS, a program is scrambled by the 
service provider to prevent unauthorized subscribers from 
receiving the program. The scrambler is controlled by a 
control word (CW). In order to guarantee that only the legal 
subscriber can derive the CW and then descramble the 
scrambled program within a set-top box (STB), a smart card 
is used to coordinate with the STB. Without mutual 
authentication in the communication between STB and smart 
card, the so-called McCormac Hack problems [3] occur 
when data line between STB and smart card is trapped and 
directed to another STB that acts as if it has the same smart 
card inside. Apart from McCormac Hack problems, smart 
card cloning [3] is another problem in which a legal smart 
card is duplicated to make many illegal cards used to allow 
unauthorized subscribers who hold the cloned cards to 
receive the program. Therefore, for the security improvement 
of system, secure communication with mutual authentication 
between STB and smart card is vital.  
To provide the security in terms of mutual authentication 
between STB and smart card, much research that binds a 
smart card only to a specific STB has been proposed, such as 
[2], [4], and [7]. Nevertheless, such a method does not 
provide fair use that allows program to be received by the 
authorized subscriber on every STB. This situation is unfair 
and inconvenient to the authorized subscriber since access to 
programs is restricted only on a specific STB: for instance, 
the smart card the subscriber owned is permitted to be used 
on the STB in the living room, but not on the STB in the 
bedroom. 
In this paper, the idea that ties a smart card to an 
individual subscriber with biometrics is introduced instead of 
a specific STB, such as [2], [4], and [7]. Apart from security 
against smart card cloning and McCormac Hack problems, 
the proposed scheme provides fair use in DTV broadcasting 
that allows only the authorized subscriber to receive program 
on any STB while preserving the benefit of service providers. 
II. FUZZY EXTRACTOR 
Recently, biometric-based authentication has become 
popular and widely used because it has the ability to employ 
biometric information to differentiate between legitimate 
user and pretender. To propose a secure communication with 
mutual authentication between STB and smart card in the 
DTV broadcasting, we employ Dodis et al.’s fuzzy extractor 
[1] that is based on theoretical foundations for generating 
cryptographic keys from biometrics. Dodis et al. define that 
fuzzy extractor as reliably generating nearly uniform 
randomness R from the inputted biometrics W in a noise-
tolerant way. Noise-tolerant means that R can be reproduced 
exactly if the input changes to W but remains close together. 
The biometrics W is inputted in generation function 
Gen(.), which results in the output of a random string R and a 
helper reproduction parameter P.  
GenWR, P
Note that P needs to be safely public because incorrect P 
cannot restore actual R. If and only if W is sufficiently close 
to W, fuzzy extractor can use the helper string P to extract 
actual R which remains uniformly random via the 
reproduction function Rep(.).  
RepW, PR
978-1-4244-6446-3/10/$26.00 © 2010 IEEE 156 ISI 2010, May 23-26, 2010, Vancouver, BC, Canada
Authorized licensed use limited to: Feng Chia University. Downloaded on July 08,2010 at 03:30:35 UTC from IEEE Xplore.  Restrictions apply. 
share, and distribute, the only way to derive V is that the 
legal subscriber is presented at the time and the STB his/her 
smart card inserted to receive the program. That is, except 
the legal subscriber with his/her smart card, no one can 
derive the shared key KC. With the shared key, STB can 
authenticate subscriber/smart-card by verifying the received 
messages MACC and MACC'.  
2) STB authentication 
For the STB, the shared key is computed with the 
subscriber’s identity and STB’s private key. With the trust 
platform module (TPM) [8], STB is capable of protecting its 
own long-term private key from any disclosure, which is the 
security baseline. No one will have a legal private key to 
derive the shared key except the STB. As only the STB can 
compute MACS = H(TC, TS, KC'), the subscriber/smart card 
will authenticate the STB by verifying MACS.  
If the adversary wants to replay the legal messages MACC, 
MACS, and MACC', the replay attack will fail since these 
messages involve timestamps used for the challenge and 
response mechanism. According the above analysis, the 
mutual authentication is achieved. 
B. Resistance against McCormac Hack Problems 
When the data line is trapped between STB and smart 
card and redirected to another STB, called STB B, the STB 
B receiving the redirected data CW' has no information about 
a legal session key without mutual authentication and key 
agreement phases. Without the session key, the STB B 
cannot derive the CW from decrypting CW'. Hence, 
McCormac Hack problems cannot work. 
C. Resistance against Smart Card Cloning Problems 
Even if the smart card of the subscriber is cloned, the 
cloned smart card cannot pass mutual authentication phase 
without the biometric of the subscriber. As a result, the 
proposed scheme is secure from smart card cloning problems. 
D. Fair Use 
Unlike the research [2], [4], and [7], the proposed scheme 
does not tie a smart card to a specific STB. Instead, the 
proposed scheme binds a smart card to the subscriber 
authorized by SMS. The program of DTV can be received on 
every STB if the subscriber and his/her smart card are 
presented.  
In sum, mutual authentication, resistance against 
McCormac Hack and smart card cloning problems, and fair 
use in the proposed scheme are confirmed. 
V. CONCLUSIONS 
This paper has introduced a novel communication 
scheme between STB and smart card in DTV broadcasting. 
It is worthwhile to note that a subscriber’s biometrics is 
skillfully tied to a smart card, which achieves mutual 
authentication to secure the communication between STB 
and smart-card. Neither McCormac Hack problems nor 
smart card cloning problems appear in our scheme. In the 
secure environment to preserve service providers’ benefit, 
authorized subscribers can receive programs on any STB.  
Although many potential challenges still exist in 
development of biometric cryptosystems such as costly 
biometric authentication hardware, it is believed that the 
biometric-based authentication will be widespread and led to 
cost reductions.  It is exactly as the European Union’s report 
[5] said “…biometrics might be useful for DRM to replace 
code and/or password protected files…” in the future. We 
believe that the proposed scheme will be fairer and more 
practical. 
ACKNOWLEDGMENT 
The authors would like to thank the National Science 
Council of the Republic of China, Taiwan, for financially 
supporting this research under Contract No. NSC 98 - 2221 - 
E - 035 - 031. 
REFERENCES 
[1] Y. Dodis, L. Reyzin, and A. Smith, “Fuzzy extractors: How to 
generate strong keys from biometrics and other noisy data,” SIAM 
Journal of Computing, vol. 38, no. 1, pp. 97–138, 2008. 
[2] H. Kim, “Secure communication in digital TV broadcasting,” 
International Journal of Computer Science and Network Security, vol. 
8, no. 9, pp. 1–5, Sep. 2008. 
[3] W. Kanjanarin and T. Amornraksa, “Scrambling and key distribution 
scheme for digital television,” Proceedings of IEEE International 
Conference on Networks, pp. 140–145, Oct. 2001. 
[4] J. S. Lee, H. S. Rhee, and D. H. Lee, “Efficient and secure 
communication between set-top box and smart card in IPTV 
broadcasting,” Proceedings of International Conference on 
Convergence and Hybrid Information Technology, pp. 307–310, Aug. 
2008. 
[5] I. Maghiros, Y. Punie, S. Delaitre, E. Lignos, C. Rodríguez, M. 
Ulbrich, M. Cabrera. B. Clements, L. Beslay, and R. V. Bavel, 
“Biometrics at the frontiers: Assessing the impact on society,” 
Institute for Prospective Technological Studies, Technical Report 
EUR 21585 EN, Feb. 2005. 
[6] A. Saxena, “An efficient and secure protocol for DTV broadcasts,” 
Proceedings of the 2nd International Conference on Security of 
Information and Networks, Famagusta, North Cyprus, pp. 288–292, 
2009. 
[7] E. J. Yoon and K. Y. Yoo, “Robust key exchange protocol between 
set-top box and smart card in DTV broadcasting,” Informatica, vol. 
20, no. 1, pp. 139–150, Feb. 2009. 
[8] Trusted Computing Group, “Trusted platform module (TPM) 
specifications,” Tech. Rep., Aug. 2009. 
 
 
 
 
 
 
 
 
 
 
 
 
 
158
Authorized licensed use limited to: Feng Chia University. Downloaded on July 08,2010 at 03:30:35 UTC from IEEE Xplore.  Restrictions apply. 
98年度專題研究計畫研究成果彙整表 
計畫主持人：李維斌 計畫編號：98-2221-E-035-031- 
計畫名稱：消費者為導向的數位版權管理系統之研究 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 1 1 100% 
專利『具單一識別
性數位浮水印系
統與方法』申請 專利 
已獲得件數 0 0 100% 
件 
 
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 5 5 100%  
博士生 2 2 100%  
博士後研究員 1 1 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 1 1 100% 
1篇發表於EI等級
期刊。 
1 篇投稿至 SCI 等
級期刊， 
2 篇潤稿中，準備
投稿至 SCI等級期
刊。 
研究報告/技術報告 0 0 100%  
研討會論文 1 1 100% 
篇 
EI indexed 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
 
