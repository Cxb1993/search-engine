2 
 
基於模糊位置之無線感測網路中設計及實作  
定位、繞徑及覆蓋技術  
Localization, Routing and Coverage Mechanisms with Inaccurate-Location 
Information in WSNs 
計畫 編號：NSC 99-2221-E-164-005- 
執行 期限：99/08/01 ~ 100/07/31 
主 持 人：張兆村  修平科技大學資訊管理系助理教授 
E-mail: cctas@mail.hust.edu.tw 
一、中文摘要 
本計畫為一年期研究計畫，其主要目的為
改善現有模糊位置資訊的相對位置精準度，以
區別相鄰感應器的東西南北相對位置，進而提
升現有繞徑(Routing)協定的效能。此外，在無
法實現位置絕對精準的情況下，本計畫亦針對
覆蓋(Coverage)問題，研發一考量覆蓋品質的解
決方案。 
本計畫首先利用 Mobile Anchor 幫助感測器
獲得模糊位置資訊，並透過本計畫所提出之
Differentiating Relative Locations (DRL)機制，讓
感測器能以分散式的方式，區別其與鄰居之相
對位置資訊。接著，在感測器僅具模糊位置資
訊的情況下，本計畫提出 p-Eval 與 preq-coverage
兩個演算法，藉由調整感測節點之感測半徑，
使感測網路的覆蓋程度可滿足使用者所要求的
覆蓋品質。 
為了驗證本計畫所發展之技術的可行性，
我們除了在 Tossim 模擬器上測試其效能外，亦
實機實作 Mobile Anchor，並在現有的感測節點
(MICA 2)上撰寫本計畫所發展之技術。 
關鍵詞： 無線感測網路、定位技術、覆蓋
技術、模糊位置資訊。 
英文摘要 
This project is a one-year project which aims to 
design and implement localization and coverage 
protocols with inaccurate-location information in 
Wireless Sensor Networks (WSNs). 
This project firstly proposes Differentiating 
Relative Locations (DRL) Protocol. Based on this 
protocol, each sensor is able to distinguish relative 
locations with all of its neighbors, hence 
significantly improving the performances of the 
existing routing protocols. Then, consider that each 
sensor has inaccurate-location information. Two 
coverage schemes which are p-Eval and 
preq-coverage algorithms are proposed to reach the 
full coverage requirement while satisfying the 
coverage quality.  
To verify our proposed localization and 
coverage mechanisms, this project initially uses the 
Tossim simulator to simulate the proposed schemes. 
Then, we further implement a mobile anchor and 
sensor nodes based on MICA 2.  
Keywords: Wireless Sensor Networks, 
Localization, Coverage, Inaccurate-location 
information. 
二、前言與研究目的 
近年來，無線感測網路的技術已廣泛的被
討論，並可應用於物件追蹤、軍事監控、居家
照顧、生態及環境監控、生理訊號監控、急難
偵測、自動控制等多種用途[1][2][3]。無線感測
網路主要是由大量的感測點(Sensor Node)，以
及少數的資料收集點 (Sink Node)所組成，其
中，每個感測點均具有感應、計算、儲存及無
線通訊的能力。不同於感測點，在無線感測網
路中的另一角色為 Sink Node，其為無線感測網
路收集資料的匯集處，透過 Sink Node的轉送，
人類可將交付感應器執行的命令或任務，傳達
給每個 Sensor Node。由於感應器的無線傳輸距
離較短，而監控區幅員遼闊，通常感應器擬將
其所感應的資料傳送回 Sink Node時，需以多步
(Multi-hop)方式透過鄰居的代傳，才能將封包
順利送達。 
在無線感測網路中，位置資訊扮演相當重
要的角色，每個感應器若能有精準的位置資
訊，在回報訊息時，便能將其感應的資訊與地
理位置資訊結合，使感應的資料更具意義。在
大部分的相關研究中，均假設每個感測器擁有
位置資訊。然而，精準的位置資訊是難以取得
的，即使每個感測器均具有全球定位系統
(GPS)，其定位之精準度亦有數公尺的誤差，遑
論其硬體成本昂貴且耗電等問題。基於此，有
許多的定位技術在近年來已陸續被提出，這些
定 位 技 術 大 致 可 區 分 為 Range-based 及
4 
 
sa 落在較大的圓形區域 O2 裡面。因此，就可以
判斷出 sa 位於 O2 扣掉 O1 的區域裡面。依此類
推，只要 Mobile Anchor 在感測器附近不同的地
方使用三次此演算法，即可得到如圖(2)所示之
交集區域，而此區域就是感測器 sa 所在的區
域。然而，與研究[11][12][13]類似，研究[10]所
定位出來的結果為一區域，當感測器佈建的密
度較高時，相鄰感測器的亦無法區別其東西南
北的位置關係。 
anchor
O1
O2
sa
 
圖 ( 2 )： 使 用 不 同 的 訊 號 強 度 找 出 感 測 器 可 能
存 在 區 ， 並 在 感 測 器 周 圍 三 個 地 方 廣 播 以 找
出 s a 存 在 之 交 集 區 。  
在另一類研究中，研究 [14] 以 Mobile 
Anchor 協助感測器定位出一精準位置，Mobile 
Anchor 在監控環境中行走並不斷地廣播當前的
座標位置。如圖(3)(a)所示，當 Mobile Anchor 進
入感測器的通訊範圍時，感測器紀錄 Mobile 
Anchor 在自己通訊範圍中出現和消失的位置，
分別是座標 a 和 b。經過一段時間之後，當
Mobile Anchor 再次進入感測器的通訊範圍之內
時，感測器就可以獲得第三個座標位置 c。最後
如圖(3)(b)所示，將這三個座標位置兩兩相連之
後，可以分別求得兩條中垂線 Lab、Lbc。因為感
測器所在位置即是圓心位置，根據圓形的特
性，圓心必定同時落在 Lab、Lbc上面，因此可以
算出感測器所在位置的座標位置。 
c
Sensor
a
b
 
Sensor
a
b
c
Lab
Lbc
 
(a) (b) 
圖 ( 3 ) ： M o b i l e  A n c h o r 移 動 時 不 斷 地 發 送
B e a c o n 以 找 出 三 個 座 標 ， 再 利 用 中 垂 線 以 協
助 感 測 器 定 位 。  
然而，在研究[14]中，定位精準度與 beacon
發送的頻率高低成正比。如果 Mobile Anchor 發
送 beacon 的頻率不夠高，則感測器聽到的
Mobile Anchor 座標未必剛好在以感測器為圓心
的圓周之上，這將導致取得三個用來幫感測器
定位的座標有誤差，進而影響到定位的準確
度，也無法保證感測器與其鄰居間的相對位置
正確與否。反之，若要強調精準的定位，則必
須提高 Mobile Anchor 發送 beacon 的頻率，這又
將導致消耗的電量增加。此外，由於每個感測
器必須要有三個座標位置才可進行定位的動
作，這會造成等待監控區域內，所有感測器完
成定位的時間變得不可預期，導致衍生定位時
間過長的問題。 
為了改善上述的問題，本計畫使用 Mobile 
Anchor搭配低功率發送之 tone signal幫助感測器
判斷其與鄰居間正確的相對位置關係，並且以
少量的 beacon message 賦予感測器基本的位置資
訊。如此，當有特定事件發生時，感測器可以
利用「其與鄰居間相對位置關係」以及「基本的
位置資訊」這兩個訊息建立起一條有效率且趨近
於最佳的路徑。 
在覆蓋問題部份，覆蓋在無線感測網路的
研究中一直是很重要的主題，無線感測網路的
覆蓋程度通常代表著其監控品質。為保證監控
區為完全覆蓋，文獻[15][16][17]提出方法，試
圖找出監控區中的 Coverage Holes，並討論如何
重新佈建感測節點，使監控區達到完全覆蓋。
文獻[18][19]亦提出偵測 Redundancy Nodes 方
式，並安排感測節點醒睡之排程以達到節省電
力效果。 
研究[20]依據所需的網路強韌度的不同，而
決定出適當大小的 Probing Range。當 Sensor 
Node 從睡眠狀態切換至清醒狀態時，需詢問在
自己Probing Range內的Sensor Node。若Probing 
Range 內有 Sensor Node 回應，則此 Sensor Node
可回至睡眠狀態，以降低電源的消耗。然而，
研究[20]卻無法保證整個 Probing Range 為 Full 
Coverage。 
研究[21]提出 Optimal Geographical Density 
Control (OGDC)演算法，其尋找一組最少數量的
Sensor Nodes 對整個監控區進行運作。研究[22]
則提出Centralize及Decentralize 兩種作法，並試
圖尋找一組最少數量的Sensor Nodes能覆蓋整個
監控區域。其做法由任一 Sensor Node 為起始，
依序向外尋找可以滿足連接性的管線，並選擇
一條可以提供涵蓋目前未被涵蓋區域最大的管
線，之後，並加入此管線上的 Sensor Nodes，反
覆執行則可達到全區覆蓋的目標。 
研究[23]提出一個分散式排程演算法，分散
式地讓 Senssor 決定其工作時間，並達到
Coverage 以及 Connectivity 的條件。其主要做法
為，讓每一個 Sensor Nodes 自行決定一個
Reference Point Time 值 ， 並 透 過 與 鄰 居
Reference Point Time值的計算後，便可得到自己
工作的時間。研究[24]則解決研究[23]因分散式
作法所造成的電量消耗不平均問題，其藉由安
6 
 
<Iy, =Iy}。舉例來說，sa >Ix sb表示 Mobile Anchor
以東西方向行進時，sa較 sb早接收到來自Mobile 
Anchor的 tone signal、sa <Ix sb表示Mobile Anchor
以東西方向行進時，sa較 sb晚接收到來自Mobile 
Anchor 的 tone signal，而 sa =Ix sb 表示 Mobile 
Anchor以東西方向行進時，sa與 sb同時接收到來
自Mobile Anchor的 tone signal。依此類推，其餘
三個符號代表 Mobile Anchor 以南北方向行進
時，感測器接收信號的順序關係。 
sa.EntryE
sa
sb
scMA MA MA
sb.EntryE
sa sc
sb
sa
sc
sb
sa
sa
sc.EntryE
sa
sa sb
sa sb
sa sb
sa sb sc
sa sb sc
sa sb sc
 
圖 ( 5 )： 三 個 鄰 近 的 感 測 器 s a、 s b 及 s c 透 過
M o b i l e  A n c h o r 所 發 送 的 t o n e  s i g n a l 來 區 別 彼
此 的 東 西 相 對 位 置 之 例 子 。  
如圖(5)所示，若 sa >Ix sb且 sb >Ix sc，則 sa先
將自己的感測器 ID 紀錄在其私有之 EntryE中，
之後廣播自己的感測器 ID 給一步鄰居 sb及 sc，
sb及 sc收到 sa所廣播的 ID 後，便將 sa之感測器
ID紀錄在自己私有的EntryE中。依此類推，sb、
sc收到Mobile Anchor所發送之 tone signal後也會
執行相同的步驟。當上述過程結束後，觀察 sa
最後的 EntryE Table，我們可發現在 sa的東邊有
兩個鄰居，依西向東之順序為 sb、sc。觀察 sb最
後的 EntryE Table，可發現 sb 位於兩個鄰居中
間。其中，sa在其西邊、sc在其東邊。而 sc最後
之 EntryE Table 讓我們得知，sc的所有鄰居皆位
在其西邊，依西向東之順序為 sa、sb。同理，當
Mobile Anchor 以南北向直線前進時，每個感測
器又可獲得各自的 EntryN Table。各感測器將自
己所掌握之 EntryE和 EntryN兩 Table 結合，即可
得到其與鄰居間之相對位置關係。 
上述之演算法，是以「先接收到 tone signal
的感測器會位於較西邊的位置」這個想法來解決
問題。然而，此方法尚有所缺失，如圖(6)所示
sa >Ix sb，但若是用上述方式來判斷感測器間東
西方向的先後順序，則最後我們將得到一個與
事實相反的 EntryE Table。 
sb
MA
sa.EntryE
sa.EntryE
sa
sa
sa
West East
sb
MA
sa.EntryE
sa.EntryE
sa
sa sb
sa sb
West East
圖 ( 6 )： 以「 先 接 收 到 t o n e  s i g n a l 的 感 測 器 會 位
於 較 西 邊 的 位 置 」 的 概 念 運 作 ， 可 能 產 生 判 斷
相 對 位 置 錯 誤 的 例 子 。 感 測 器 s a 雖 較 s b 早 收
到 M o b i l e  A n c h o r 之 T o n e  s i g n a l， 但 其 位 置 卻
落 在 s b 東 邊 。  
另一個問題如圖(7)所示，若 sa 與 sb 互為鄰
居且 sa =Ix sb，則 sa與 sb均會先紀錄自己的感測
器 ID 至各自私有的 EntryE，之後再廣播自己的
感測器 ID 給對方，結果將導致兩 EntryE的內容
順序不一致。因此，一旦發生圖(6)或圖(7)所示
之狀況，感測器將誤判其與鄰居間相對位置的
關係。 
MA
sa
sb
sa.EntryE
sa
sb.EntryEsb
West East
sa sb
sb sa
West East
 
圖 ( 7 )： 以 B a s i c  C o n c e p t 敘 述 之 作 法 運 作 ， 可 能
造 成 判 斷 相 對 位 置 錯 誤 的 例 子 。 感 測 器 s a 與 s b
同 時 收 到 M o b i l e  A n c h o r 之 T o n e  s i g n a l， 導 致 兩
T a b l e 的 資 訊 錯 亂 。  
經過觀察，上述所產生的兩個問題均由圓
形的特殊形狀所造成。因此，若是我們想利用
Mobile Anchor 幫助我們區分感測器間的相對位
置關係，則勢必得跨越這關鍵性的障礙。基於
此，我們除了執行先前提及的處理步驟外，也
提出另一輔助判斷之規則，使感測器使用新增
的 Table ExitN、ExitE 來進一步記錄失去 Mobile 
Anchor發送之 tone signal後的先後順序。其中，
ExitN 是紀錄感測器與其鄰居間由北至南失去
tone signal 的先後順序、ExitE則是紀錄感測器與
其鄰居間由西至東失去 tone signal 的先後順序。
另外，獲得 Table ExitN 及 ExitE 資訊的方法與
EntryN及 EntryN大同小異，差別只在於感測器依
失去 tone signal 的先後順序記錄自己及鄰居的感
測器 ID。 
為了方便接下來的描述，我們令 sa ε sb為感
測器 sa 與 sb 失去 Mobile Anchor 所發送之 tone 
signal 的先後順序關係。其中，εא{>Ox, <Ox, =Ox, 
>Oy, <Oy, =Oy}。舉例來說，sa >Ox sb表示 Mobile 
Anchor 以東西方向行進時，sa 較 sb 早失去來自
Mobile Anchor 的 tone signal、sa <Ox sb 表示
Mobile Anchor 以東西方向行進時，sa 較 sb 晚失
去來自 Mobile Anchor 的 tone signal，而 sa =Ox sb
表示 Mobile Anchor 以東西方向行進時，sa與 sb
同時失去來自Mobile Anchor的 tone signal。依此
類推，其餘三個符號代表 Mobile Anchor 以南北
方向行進時，感測器失去信號的順序關係。 
舉例說明，假設有兩互為鄰居之感測器 sa
及 sb且 sa >Ox sb。當 sa失去Mobile Anchor所發送
的 tone signal 時，會先紀錄自己的感測器 ID 到
8 
 
播給其鄰居。其中，t 將會被記錄在封包當中。
而鄰居收到封包後，可根據封包中所記錄的時
間 t 得知自己與其鄰居間收到或是失去 tone 
signal 的先後順序。 
C. Rules for Ambiguous Conditions 
本計畫所提出之演算法，是比較感測器與
其鄰居間的 Table 紀錄的順序來判別相對位置關
係。然而，有兩種特殊情況擁有相同的 Table 紀
錄順序，卻有完全不同的結果，我們使用下面
的範例來說明這兩種情況。 
MA sa
sb
 
MA sa
sb
(a) (b) 
圖 ( 1 0 )： 感 測 器 s b 較 s a 晚 收 到 ， 卻 較 早 失 去
M o b i l e  A n c h o r 所 發 之 T o n e  s i g n a l。 ( a )與 ( b )
兩 種 完 全 不 同 的 情 況 ， 卻 會 得 到 相 同 的
E n t r y 以 及 E x i t  T a b l e， 導 致 兩 感 測 器 無 法 光
憑 T a b l e 資 訊 判 斷 相 對 位 置 關 係 。  
如圖(10)(a)所示，當感測器 sa 收到 Mobile 
Anchor 所發之 tone signal 時，感測器 sb 尚未收
到，而此例子特殊之處在於，sb 收到 tone signal
的時間較 sa 晚，而失去 tone signal 的時間卻較
早。依照之前敘述過的作法，最後這兩個感測
器均可得到自己私有的 Table 資訊。其中，sa 與
sb之 EntryE均紀錄為 sa >Ix sb、ExitE也同為 sb >Ox 
sa。另一情況如圖(10)(b)所示，sb 同樣也是較 sa
晚收到Mobile Anchor所發之 tone signal，卻較 sa
早失去 tone signal。所以照前述之作法，sa與 sb
之 EntryE均紀錄為 sa >Ix sb、ExitE也均為 sb >Ox 
sa。觀察兩種情況，雖然兩感測器 sa 和 sb 之
Table 內容在圖(10)(a)和圖(10)(b)時相同，但其
東西方向的順序結論卻相反。因此，當感測器
比較其與鄰居間的 Table 資訊時，若是發現紀錄
的順序如同圖(10)(a)和圖(10)(b)所得到的內容，
則必須額外使用我們接下來所提出的判斷法
則，以區分這兩種情況。 
在描述接下來的判斷法則之前，我們先定
義幾個符號以便解說。令 dis(i, j)代表兩位置 i 和
j 之間的距離、loc(s)表示感測器 s 的所在位置。
搭配圖(11)來看，當感測器 sa 先收到 Mobile 
Anchor 所發之 tone signal 時，對其任一鄰居 sb
而言，Ly,a、Lx,b分別為通過 loc(sa)且與 y 軸平行
之直線、和通過 loc(sb)且與 x 軸平行之直線，pb
為Lx,b和Mobile Anchor通訊圓之兩交點 pw,p、pe,p
連線的中點位置，其中，pw,p 為較西邊之交點、
pe,p為較東邊之交點，而 PLy,a, Lx,b為 Ly,a和 Lx,b的
交點位置。有這些定義後，接下來我們就可以
敘述第三個 Lemma 如何區別圖(10)中兩種不同
的情況。 
Lemma 3：若 sa與 sb之EntryE均紀錄為 sa >Ix 
sb、ExitE均紀錄為 sb <Ox sa，且令 
),()),(( ,,,,, pebLxaLypeb pPdispslocdisd −=  
若 d>0，則兩感測器由西向東的先後順序為 sa、
sb，否則兩感測器由西向東的先後順序為 sb、
sa。 
證明：若感測器 sa與 sb之EntryE均為 sa >Ix sb
且 ExitE 均為 sb <Ox sa，又滿足 d<0 時，表示
dis(loc(sb), pe,p)小於 dis(pLy,a, Lx,b, pe,p)，也就是說 sb
絕對不可能位於 Ly,a 的東邊。因此得證，由西向
東之先後順序為 sb、sa。同理可證，當 d>0 時，
由西向東之先後順序為 sa、sb。  
為了讓感測器可以順利區分圖(10)(a)及圖
(10)(b)兩種狀況，我們讓感測器在廣播或接收到
鄰居訊息時，除了紀錄 ID 之外，也將當時自身
clock 的時間點紀錄起來，如此便可搭配 Mobile 
Anchor 前進的速度而計算出 dis(loc(sb), pe,p)與
dis(pLy,a,Lx,b, pe,p)，進而可幫助感測器判斷事件屬
於那一種情況，下面我們將舉個例子做說明。 
如圖(11)所示，有兩互為鄰居之感測器 sa與
sb，假設 Mobile Anchor 行進的速度為等速 v 且
sa 較 sb 早在 Tain =10:02 的時間點接收到 Mobile 
Anchor 所發之 tone signal，則 sa會將自身 ID 以
及進入時間點作紀錄，此時 sa 之 EntryE 內容為
<sa：10:02>。之後 sa只將自身感測器 ID 廣播給
鄰居。由於鄰居間的時間未必同步，因此，sb以
其私有的 clock 上之時間為主，假設 sb 在
Tain’=10:08 的時間點收到 sa 之廣播，則 sb 之
EntryE 內容為<sa：10:08>。依此類推，令 sb 在
Tbin =10:13 的時間接收到 Mobile Anchor 所發之
tone signal，則最後可得到 sa 之 EntryE 為<sa：
10:02, sb：10:07>、sb之 EntryE為<sa：10:08, sb：
10:13>。 
sb
MA
Ly, a
pb pe,ppw,p
pLy,a, Lx,bLy, b
 
圖 ( 1 1 )： 當 感 測 器 s a 無 法 光 憑 T a b l e 資 訊 判
斷 其 與 鄰 居 間 的 相 對 位 置 時 ， 將 利 用 d 值 的
大 小 輔 助 s a 判 斷 。  
另外，在感測器失去 Mobile Anchor 所發送
之 tone signal 的部份，若 sb 較 sa 早失去 tone 
signal，依照各自 clock，sa與 sb失去 tone signal
範圍之時間點各為 Taout=10:10 與 Tbout=10:15，則
ExitE 各為<sb：10:09, sa：10:10>、<sb：10:15, 
sa：10:16>。對照 Table 後發現此時為如圖(10)所
示之無法區分相對位置的狀態，因此必須套用
判斷法則以輔助感測器區分相對位置。觀察圖
10 
 
Lemma 3 的條件式分別為 condition 1、condition 
2 和 condition 3。而 si.RelativeLoc 為紀錄 si與其
鄰居之相對位置關係的 Table。si 經過與其鄰居
交換 Entry 與 Exit Table 後，如 Line 5-18 所示，
利用先前 DRL Properties 章節所敘述之各 Lemma
幫助 si判斷其與鄰居間相對位置關係。其中，若
是 Line 13 所敘述的條件式成立，代表此時的情
況如圖(10)所示，si與其鄰居 sj無法光靠 Entry及
Exit Table 判斷相對位置，此時必須利用 d 值的
大小來輔助 si作判斷。 
1 for each sensor si do 
2 // sjאN(si) 
3      Check the Entry and Exit tables of si and sj 
4   
5    if condition 1 is satisfied then 
6       si.RelativeLoc <− si.ExitTable 
7    end if 
8    else if condition 2 is satisfied then 
9       si.RelativeLoc <− si.EntryTable 
10     or si.RelativeLoc <− si.ExitTable 
11    end if 
12    else if condition 3 is satisfied then 
13       if d<0 then 
14          si.RelativeLoc <− si.ExitTable 
15       else 
16          si.RelativeLoc <− si.EntryTable 
17       end if 
18    end if 
19 end for 
圖 ( 1 5 )： D R L  演 算 法 。  
4.1.2 p-Eval Scheme 與 preq-coverage Scheme 
在第二部份中，我們探討如何提升監控區
覆蓋機率，並且分別介紹本計畫提出 p-Eval 
Scheme 與 preq-coverage Scheme。 
A. Basic Concept 
首先，我們定義保守覆蓋區域及樂觀覆蓋
區域，由這兩個區域，我們可知道哪些區域是
百分之百被覆蓋或是可能被覆蓋，並針對可能
被覆蓋的區域評估其覆蓋機率是否滿足使用者
要求。對於系統對監控區所要求的覆蓋機率 preq
而言，本計畫提出 p-Eval Scheme，由感測節點
si 評估計算可能被覆蓋的區域是否滿足 preq，若
存有不滿足 preq 之區域，則表示監控區不為
Cov(preq) ， 接 著 我 們 將 提 出 preq-coverage 
Scheme，由 si 針對其周圍不滿足 preq 的空洞區
域，依據節省電量及平衡電量的考量下，調整 si
的感測半徑，使監控區的覆蓋程度可滿足使用
者所要求的覆蓋機率 preq，亦即使監控區滿足
Cov(preq)。 
透過我們對感測節點的感測範圍與模糊位
置關係的觀察，可分別定義保守覆蓋區域及樂
觀覆蓋區域，用以區分哪些區域是百分之百被
覆蓋或是可能被覆蓋。 
Definition: 保守覆蓋區域： guaiR  
感測節點 si不論落在其模糊位置資訊 bi內的
任何位置，均可保證覆蓋之區域，稱為 si的保守
覆蓋區域 guaiR 。  
我們可由 si的感測半徑 ri及其模糊位置資訊
bi，推算出 si 的保證覆蓋區域為 guaiR ，以下列式
子表示： 
( , )
( , )
i
i
rgua
i x y
x y b
R c
∈
= ∩  (4)
為簡化保守覆蓋區域的計算，如圖(16)所
示，我們分別以 bi 的 4 個頂點為圓心，其代表
sensor si 可能的邊界極限位置，接著在此四個位
置分別繪出感測圓後之交集區域，即為保守覆
蓋區域 guaiR ，在邏輯上，這塊交集區表示，即
使 sensor si 落於邊界的極限，仍能覆蓋此交集
區，因此，其為保證可以覆蓋區域。求出保守
覆蓋區域 guaiR 後，若 guaiR φ≠ 且位置 ( , ) guaix y R∈ ，
我們可以保證 si必定可覆蓋位置(x, y)；反之，若
位置 ( , ) guaix y R∉ ，我們便無法確定 si 一定能覆蓋
位置(x, y)。 
bi
ri
gua
iR  
圖(16)：保守覆蓋區域 guaiR ，為 si保證可覆蓋的區域。 
Definition:樂觀覆蓋區域 opt
iR   
感測節點 si可能覆蓋到的區域範圍，稱為 si
的樂觀覆蓋區域 optiR 。  
我們可由 si的感測半徑 ri及其模糊位置資訊
bi，推得 si 可能覆蓋的區域為 optiR ，以下列式子
表示: 
( , )
( , )
i
i
ropt
i x y
x y b
R c
∈
= ∪  (5)
如圖(17)所示，由 si之感測圓沿著 bi邊界行
走所圍出的綠色線區域即為樂觀覆蓋區域 optiR 。
我們可以保證，若位置 ( , ) optix y R∈ ，則 si 可能覆
蓋位置(x, y)；反之，若位置 ( , ) optix y R∉ ，則保證
si不能覆蓋位置(x, y)。 
12 
 
內，則 si可能部分覆蓋 gm,n，因此，我們可以推
導出 Property-2 如下: 
Property-2: 若 si滿足下列式子，則稱 si可能部份
覆蓋 gm,n。 
,, m n
part
i i gb R φ∩ ≠  (10) 
(b) 計算網格之覆蓋機率 
根據上述 2 個 Properties，我們可判斷哪些
感測節點可能完全或部分覆蓋 gm,n，當我們計算
gm,n 之覆蓋率時，必須將這些對 gm,n 有覆蓋貢獻
之感測節點皆列入計算考量。以下敘述 si如何計
算 gm,n 之覆蓋機率，我們以 ,( )c m np g 表示為 gm,n 被
完全覆蓋的機率，其值可由下列式子求得: 
, , ,( ) ( ) ( )
c ind cop
m n m n m np g p g p g= +  (11)
其中 ,( )ind m np g 由 phase 1 計算求得，表示 gm,n
至少被一個感測節點所獨立完全覆蓋的機率，
,( )
cop
m np g 由 phase 2計算求得，為感測節點合作完
全覆蓋 gm,n的機率。當 phase 1 所計算之 ,( )ind m np g
滿足 preq，則不需再執行 phase 2，且視 gm,n被覆
蓋，否則接續執行 phase 2，並且由等式(11)求得
,( )
c
m np g ，若 ,( )c m np g 滿足preq，則視gm,n被覆蓋，反
之，則表示 gm,n為空洞區域，接下來，我們將分
別敘述兩個 phase 如何運作。 
Phase 1：Independent Coverage 
在這個 Phase 中，我們以 Property-1 為概念
基礎，找出有機會能完全覆蓋 gm,n 之感測節點
si，且令 ,indm nS 表示為所有滿足 Property-1 的感測節
點之集合。令 si完全覆蓋 gm,n之機率為 ,( )ci m np g ，
我們由觀察 ,, m nfulli gR 與 bi的交集區域，可推得 ,( )ci m np g
為： 
,, ,
( ) ( ). / .
m n
c full
i m n i g i ip g R b size b size= ∩  (12)
接著，我們可求得 gm,n至少被一個感測節點
所獨立完全覆蓋的機率 ,( )ind m np g ，可由 1 扣除該
網格不被任何節點完全覆蓋之機率。算式(13)即
闡述如何計算 ,( )ind m np g 之值。 
,
, ,( ) 1 (1 ( ))
ind
i m n
ind c
m n i m n
s S
p g p g
∈
= − −∏  (13)
如圖 (20) 所示，有兩個感測節點滿足
Property-1，且其 bounding box 面積均為 10，首
先，由 s1的 bounding box b1與 s1對於 gm,n之完全
覆蓋區域的交集區域，如圖中黃色區域面積為
4，利用算式(12)求出 1 ,( ) 0.4c m np g = ，同理，由圖
中紫色區域面積為 3，求得 2 ,( ) 0.3c m np g = 。接著，
利用算式(13)，求得 gm,n 至少被一個感測節點所
獨立完全覆蓋的機率 ,( ) 0.58ind m np g = 。 
b1
b2
,, m n
full
i gR ,, m n
part
i gRgm,nbi
4
3
10
10
 
圖(20)：s1與 s2滿足Property-1，可能獨立完全覆蓋 gm,n。
我們可將 ,( )ind m np g 之值視為 gm,n 之覆蓋機率
的 Lower Bound，這主要是因為 Phase 1 所考慮
的覆蓋情況為感測節點獨立完全覆蓋 gm,n，而沒
有考慮感測節點合作覆蓋 gm,n 的可能性。若
Phase 1 所計算的 Lower Bound 滿足 preq，則 gm,n
之覆蓋率已滿足使用者需求，該網格即不需進
行 Phase 2 之運算，否則，接下來執行 Phase 2，
計算感測節點合作覆蓋 gm,n的可能性。 
Phase 2：Cooperative Coverage 
在這個 Phase 中，我們基於 Property-2 的觀
念基礎，找出對 gm,n有覆蓋貢獻之感測節點 si，
且令
,
cop
m nS 表示為所有滿足 Property-2 的感測節點
之集合。 
,, m n
full
i gR ,, m n
part
i gRgm,nbi
s1 s2
 
圖(21)：s1與 s2合作覆蓋 gm,n。 
gm,nbi
x1
xn
s1 s2
Remained hole
 
圖(22)：s1 與 s2 合作覆蓋 gm,n。 
等式 (14) 中的 ,( )cop m np g 值，表示由滿足
Property-2 的感測節點 si，也就是他們均僅能部
分覆蓋 gm,n，但卻可合作完全覆蓋 gm,n 之機率，
如圖(21)所示，s1 與 s2 均沒有位於其對於 gm,n 的
完全覆蓋區域內，亦即圖中黃色和紫色區域，
因此 s1 與 s2 均僅能部分覆蓋 gm,n。雖然 s1 與 s2
均不能獨立完全覆蓋 gm,n，但由於 s1與 s2的互補
合作，卻可完全覆蓋 gm,n。 
14 
 
小，對合作覆蓋的機率越有利。由於合作覆蓋
的表現，除了距離因素外，亦取決於感測半徑
的大小，對於感測半徑大的感測節點而言，其
即使距離網格 gm,n較遠，也可能有不錯的覆蓋表
現，因此，以下我們以感測節點距離網格 gm,n的
遠近及感測半徑的大小來衡量其合作覆蓋的表
現優劣。令 ravg 表示為所有感測節點的感測半徑
之平均值，davg 表示為 di 的長度之平均值。只要
davg值小於等於 ravg值，則設定 distanceα 值達到最大
值1，其理由為當davg小於等於 ravg時，感測節點
即可大部分覆蓋 gm,n 中心點的周圍，如圖(24)所
示，三個感測節點的感測半徑均等於其 id 值，
則此三個感測節點之感測圓交於 gm,n中心點並且
可合作覆蓋gm,n。相反地，當davg大於 ravg值越大
時，表示 si平均距離gm,n越遠，因此， expα 值將隨
之減少。我們以下列式子來表示距離參數對合
作覆蓋的影響。 
(1, )avgdistance
avg
r
min
d
α =  (19)
最後，由等式 (14)，我們可以估算求得
,( )
cop
m np g ，並且由等式 (11) 求得 ,( )c m np g ，若
,( )
c
m np g 不滿足 preq，則視 gm,n 為空洞區域。在執
行完 Phase 2 之後，我們將針對不滿足 preq的空
洞區域，以下章節提出preq-coverage Scheme，用
以修補空洞區域，進而使監控區滿足 Cov(preq)。  
C. preq-coverage Scheme  
對於監控區中存有空洞區域，本章節依據
節 省 電 量 及 平 衡 電 量 的 考 量 下 ， 提 出
preq-coverage Scheme，以 si調整感測半徑來修補
空洞，進而使監控區滿足使用者所要求的覆蓋
機率 preq。 
經由執行 3.2 的 p-Eval Scheme，在 si評估其
負責的網格集合 Gi 後，可知道其周圍是否存在
空洞網格。若有空洞網格，則 si將調整感測半徑
以修補空洞網格，然而，若多個感測節點同時
調整感測半徑，將可能造成過多的調整，因
此，我們將避免相近的感測節點同時調整，令
感測節點 si的感測鄰居為 { | }opt opti j i jN s R R φ= ≠∩ ，
在調整感測半徑的時機設計上，我們不允許 si與
Ni 中的任意其他成員同時調整感測半徑。為了
決定 si與其感測鄰居Ni調整的優先順序，我們設
定 si的優先權值為其生命週期 li，且由 li 最大者
優先起來修補空洞。 
在環境初始時，感測節點經由發送 hello 
packet，獲得其感測鄰居訊息，其包含感測節點
的感測半徑與剩餘電量。當感測節點 si決定其是
否可優先起來調整感測半徑時，si 判斷其生命週
期是否為其所有感測鄰居 Ni 中最大值，若其值
為最大，則 si可起來執行修補空洞網格，反之，
則等待其感測鄰居 Ni 中最大生命週期之感測節
點，直到其執行完修補動作為止。 
當 si決定其可起來調整感測半徑時，若 si所
評估之網格集合 Gi 中不存在空洞網格，則 si 宣
告自己不再執行修補動作；若 si所評估之網格集
合 Gi 中存在空洞網格，則 si 調整感測半徑以修
補空洞網格，在調整完後，si 依據新調整的感測
半徑，更新其 Gi與 Ni集合，以及重新計算 Gi內
所有網格之覆蓋機率，並且將更新的資訊廣播
給感測鄰居，接著，si與其感測鄰居Ni再決定誰
可優先起來調整感測半徑，重覆由生命週期最
大的感測節點接續修補空洞網格。 
當感測節點 si決定其應該進行修補空洞網格
時，以下，我們討論兩個重要議題，第一個議
題是針對特定的一個空洞網格，感測節點 si應該
如何調大其感測半徑，才能使空洞網格滿足使
用者要求之覆蓋機率。第二個議題是在考量電
量平衡的前提下，針對 si 所負責的多個網格空
洞，si 該如何選擇空洞網格來修補，使其可兼顧
空洞網格的覆蓋機率增加以及電量平衡。 
針對第一個議題，令 ,im nh 表示為 si 欲修補的
空洞網格。以下說明當 si 決定修補 ,im nh 時，則 si
應該如何調整其感測半徑來修補 ,im nh ，以使得
,( )
c i
m np h 值可滿足使用者要求。令 ri,,new表示為 si調
整的新感測半徑， , ,( )c ii new m np h 表示為 si 調整其感測
半徑為 ri,,new時，si對 ,im nh 之覆蓋機率， , ,( )c ii new m np h 表
示為 si調整其感測半徑為 ri,,new後，網格 ,im nh 被完
全覆蓋的機率。由等式(11)， ,( )c im np h 值為 ,( )ind im np h
與 ,( )cop im np h 兩數值之和，我們討論 ,( )ind im np h 與
,( )
cop i
m np h 值應提升為何，即可使得 ,( )c i reqnew m np h p≥ ，
進而推導出 , ,( )c ii new m np h 值以及其對應的 ri,,new。此
外，令 ,( )cop inew m np h 表示為 si 調整其感測半徑為 ri,,new
時，感測節點合作覆蓋 ,im nh 的機率值， ,( )ind inew m np h 為
si 調整為新的感測半徑後，至少有一個感測節點
獨立覆蓋 ,im nh 之機率，則我們可以改寫等式
(11)，以下列式子求得 ,( )c inew m np h 。 
, , ,( ) ( ) ( )
c i ind i cop i
new m n new m n new m np h p h p h= +  (20)
從等式(20)中，欲由已知的 ,( )c inew m np h 值推導
出 ,( )ind inew m np h 與 ,( )cop inew m np h 值，以及其對應的 ri,,new 值是
一件困難的事，因為其只能由逐步調大感測半
徑，直到計算 ,im nh 的完全覆蓋機率滿足 ,( )c inew m np h 為
止，但其計算複雜度很高。然而，若只有一個
獨立機率值 ,( )ind inew m np h 為未知數，則我們可由下列
方法計算 ,( )ind inew m np h 值並進一步推導出 ri,,new值。 
首先，在已知 ,( )c inew m np h 的條件下，為了求得
,( )
ind i
new m np h 值，我們將以目前的 ,( )cop inew m np h 值做為
,( )
cop i
new m np h 的估算值，因此可由式(21)中求得 ,( )ind inew m np h
16 
 
是不平衡的，因此，選擇 Strategy 2，以快速修
補空洞。此外，為避免 Strategy 2 的缺點，即感
測節點 si因過度調整感測半徑，因而使其生命週
期減少過劇，造成 si較於鄰近感測節點快速耗盡
電量的問題，我們在 Strategy 2 中，加入限制感
測節點之生命週期最多減少至平均值的條件，
以解決上述問題。令
i
farl 表示 si修補完 Gi集合內
離 bi 中心點最遠的空洞網格後之生命週期， newil
表示 si 決定這次所要調整的生命週期，則
Strategy 2 中所加入的限制條件，可寫成下列限
制式。 
max( , )
i
new far
i il l l=  (24)
最後，在考慮感測半徑有最大調整限制的真實
情況下，若是計算 si應調整的感測半徑超過 si可
調整的最大感測半徑，則 si 維持為最大感測半
徑，並且無能力再去修補空洞區域，此時，si 宣
告其不再參與 phase I，且尚未修補之空洞區域
將由其他感測節點進行修補。 
4.2 以 Tossim 模擬器實作 
本子章節利用 Tossim 模擬器驗證本計畫所
提出之定位與覆蓋技術。以下，我們將模擬部
份分成兩個部份作進一步說明。 
4.2.1 DRL Protocol 之效能 
本實驗的環境設定如 Table 1 所示，其中網
路裡的所有感測器均為固定式感測器，並假設
無障礙物存在。 
Table 1：Simulation Parameters 
Simulated area 300m × 300m area 
Transmission range 30m ~ 70m 
Density 0.006 ~ 0.02(nodes/m2) 
在本子章節中，我們將對本計畫所提出的
DRL 演算法進行效能評估。此外，為了更加清
楚地呈現本計畫的貢獻，我們將加入兩個比較
的對象 r-DOL與 s-DOL。其中，r-DOL與 s-DOL
均為研究[13]中所提出之定位演算法，其差別
在於 r-DOL 讓 Mobile Anchor 以未經規劃的路徑
在網路中隨意行走，而 s-DOL 則如圖(13)(a)所
示之方式，讓 Mobile Anchor 以東西方向在網路
中蛇行一次。 
30 35 40 45 50 55 60 65 70
0.0
0.2
0.4
0.6
0.8
1.0
DRL
s-DOL
r-DOL
Transmission range (m)
N
um
be
r o
f h
op
 c
ou
nt
s 
(n
or
m
al
iz
ed
)
N
um
be
r o
f h
op
 c
ou
nt
s 
(n
or
m
al
iz
ed
)
 
圖 ( 2 7 )： 將「 感 測 器 可 區 分 其 與 鄰 居 間 之 相 對
位 置 關 係 」 的 訊 息 加 入 的 繞 徑 協 定 中 ， 得 到
可 大 幅 提 升 繞 徑 協 定 的 結 果 。  
如圖(27)與圖(28)所示，我們設計一繞徑應
用的場景，把相對位置資訊加入知名的 GPSR
繞徑協定 [25]之中，以驗證本計畫所提出之
DRL 演算法，是否可增加協定的執行效能。我
們規劃在網路場景中隨機挑出兩個感測器作為
來源端與目的端，其距離約三百公尺左右，測
試從來源端發送封包至目的端所需要經過的
hop 數。在圖(27)中，三種比較的演算法的 hop
數均隨著傳輸半徑的增加而減少，然而，我們
可以發現若是在傳輸過程中，感測器精確的知
道與鄰居間的相對位置，則將大大地降低傳送
封包的平均 hop 數。 
再觀察圖(28)，此實驗圖中紅色的點表示
來源端與目的端，其餘的點均為感測器。每當
感測器代傳一次封包，則感測器的顏色便會加
深。因此，我們可以很清楚的發現使用 DRL 演
算法時，有顏色的感測器均集中在來源端與目
的端之間，而由於 DOL 演算法並沒有「相對位
置關係」的資訊，故在其對應的兩張圖上，有顏
色的感測器並不集中在兩端點之間。經由圖(27)
與圖 (28)可以得知，本計畫所提出之定位技
術，可有效地提升現存繞徑協定之效能。 
s-DOL r-DOL
-DRL
 
圖 ( 2 8 )： 在 繞 徑 協 定 中 加 入 相 對 位 置 關 係 的
資 訊 ， 將 可 減 少 繞 遠 路 的 情 況 發 生 。  
0.006 0.008
0.01
0.012
0.014
0.016
0.018 DRL
DOL
0
0.2
0.4
0.6
0.8
1
Density(nodes/m^2)
A
vg
. B
ou
nd
in
g 
B
ox
 S
iz
e
 
18 
 
Bounded box size
Co
ve
ra
ge
 r
at
e
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
0x0 1x1 2x2 3x3 4x4 5x5
Real
Center
Cov(1)
 
圖(33)：不同 bounding box size 對 Center 評估演算法之
coverage rate 影響。 
Bounded box size
Co
ve
ra
ge
 e
sti
m
at
e 
er
ro
r r
at
e
0
0.1
0.2
0.3
0x0 1x1 2x2 3x3 4x4 5x5
Center
Cov(1)
Cov(0.9)
 
圖(34)：Coverage estimate error rate。 
圖(34)主要比較 p-Eval Scheme與 center評估
演算法之 coverage error rate，我們隨機佈建 50
個感測節點，並且設定感測節點之感測半徑均
為 7m，bounding box size 範圍為平均 0m x 0m ~ 
5m x 5m。由於 Cov(1)曲線只計算保守覆蓋區域
為覆蓋區域，因而不會有 coverage error，而
Cov(0.9)曲線為計算滿足機率 0.9 的網格為覆蓋
區域，因此，可獲得其 coverage error rate 之
upper bound 為 0.1，且 Cov(0.9)曲線實驗數據確
實落在 0 至 0.1 之間。然而，Center 評估演算法
之 coverage estimate error rate 則隨 bounding box 
size 增加而明顯增加，因為 Center 評估演算法
僅依據 bounding box中心位置為感測節點位置資
訊，並不考慮 bounding box size 對感測節點位置
資訊誤差的影響，因此，當 bounding box size 越
大，感測節點位置資訊誤差也就越大，因而使
得 coverage estimate error rate 越大。 
圖(35)與圖(36)，我們隨機佈建 30 ~ 70 數量
的感測節點於監控區，探討在不同的感測節點
數量下，對於執行不同 preq 要求的 preq-coverage 
Scheme 後，coverage rate 與 average sensing range
之差異程度。從圖(35)中我們可以看到在執行不
同 preq要求的 preq-coverage Scheme 之後，其可達
到的 coverage rate 均隨著感測節點數量增加而提
升，而 0.7-coverage Scheme 曲線所獲得的
coverage rate相較其他曲線高，因為0.7-coverage 
Scheme所要求的網格覆蓋機率為0.7是最低的，
因此，0.7-coverage Scheme 比較容易獲得較高的
coverage rate。圖(36)，由於 0.7-coverage Scheme
所要求的網格覆蓋機率為 0.7 是最低的，因此，
0.7-coverage Scheme 比較容易調整較小感測半
徑，而可達到覆蓋機率為 0.7 之要求。 
Number of nodes
Co
ve
ra
ge
 r
at
e
0.5
0.6
0.7
0.8
0.9
1
30 40 50 60 70
0.7-coverage Scheme
0.8-coverage Scheme
0.9-coverage Scheme
1-coverage Scheme
 
圖(35)：在不同的感測節點數量下，對於執行不同 preq
要求的 preq-coverage Scheme 後，coverage rate 之差異程
度。 
Number of nodes
Av
er
ag
e 
se
ns
in
g 
ra
ng
e.
5
6
7
8
9
10
30 40 50 60 70
0.7-coverage Scheme
0.8-coverage Scheme
0.9-coverage Scheme
1-coverage Scheme
 
圖(36)：在不同的感測節點數量下，對於執行不同 preq 要
求的 preq-coverage Scheme 後，average sensing range 之差
異程度。 
4.3  感測節點實機實作 
本計畫用以 Mica 2 感測器實作，可分為無
線通訊與感測，感測定位及監控系統三個部
份，以下將詳細講解實作內容。 
 
圖(37)：以 notebook 或 PC 所建構的 sink node。 
 
圖(38)：sensor 的基本元件。 
1. 無線通訊及感測之實作 
如圖(37)所示，我們在網路上設置一台 PC
連接 Mote Mica2 模組，當作 sink 端，並使用多
個 Mote Mica2 模組形成感測網路。構成感測點
20 
 
command 是由於此 Module 提供 "Std Control" 
interface，而實作 fired() event 是由於這個
Module 使用 "Timer" interface，所以必須實作
fired() event。 
//BlinkM.nc
module BlinkM {
provides {
interface StdControl;
}
uses {
interface Timer;
interface Leds;
}
}
implementation {
command result_t StdControl.init() {
call Leds.init();
return SUCCESS;
}
command result_t StdControl.start() {
return call Timer.start(TIMER_REPEAT, 1000) ;
}
command result_t StdControl.stop() {
return call Timer.stop();
}
event result_t Timer.fired() {
call Leds.redToggle();
return SUCCESS;
}
}  
圖(41)：Module 程式實例片段。 
有了上述 nesC 的基本概念之後，利用這些
Interface，我們可以快速編寫出我們所需之應用
程式。在此說明幾個重要之 interface—Clock 為
一種 Hardware interface，其主要之 command 為
setRate，即為設定 Clock 每秒有幾次之反應，一
旦到達設定之間隔時間，便觸發這項事件，如
此我們在設計感測點數據收集之應用程式時，
將會實作此 Clock 之 interface，以達到定時取得
環境變化數據之目的。另外，在我們所使用
Mote 模組時，還提供了三個分別為紅、黃、綠
之 LED 燈，這三個 LED 燈也有相對的 interface
可供實作使用，即為 Leds，我們可以實作此
interface，分別控制三個 LED 燈。而 Mote 模組
中和無線通訊有關之功能，在此也有 interface可
以使用，即為接收資料之 ReceiveMsg，和傳送
資料之 SendMsg，在此較特別的是 ReceiveMsg
只有 events 之函數，沒有 command 之函數在其
中。還有一個和感應器有關之 interface 為
ADC，其意為 Analog to Digital Converter，一般
感應器之感應動作是形成類比信號，如此之數
據不易使用來參考比對，因此要轉成數位信號
才易於傳送及處理。 
在此簡單的介紹一些本計畫使用的元件： 
無線通訊程式實作 
1. IntToRfm：是一個從 IntOutput interface
中接收 Output 值，再經由無線傳輸將其值以廣
播的方式傳輸給其他Mote的元件。在 IntToRfm 
Module 中，nesC 將傳送訊息的資料型態宣告為
IntMsg，包含兩個欄位，一欄位用來放置資料
值，另一欄位則放置此訊息的傳送的來源端位
址，在傳送資料的同時會以接收端位址與資料
大小以及資料值為參數呼叫 Send.send()函式，
將資料傳給接收端的 Mote。IntToRfm Module
使用一個 pending flag 來檢視暫存區的狀態，假
若前一個訊息資料還處在傳送階段，我們不能
更改暫存區內的值，此時將不會送出新的訊
息，並回傳 FAIL 值；假若目前傳送暫存區是空
的，則可以將訊息載入暫存區中並傳遞此訊
息。在 TinyOS 中，無線通訊傳輸採用 Active 
Message的模式，即為在網路中每個封包都有一
個 Handler ID 交給接收端的 Mote 處理，此
Handler ID 位於封包內的標頭欄位中，我們可
將此 Handler ID 視為一個數字或是 Port 
Number，一旦訊息被接收端接收後，根據不同
的 Handler ID 將會有相異的 event 被觸發，而不
同的Motes收到相同的Handler ID亦有可能觸發
不同的 event。 
2. RfmToInt ： 我 們 利 用 ReceiveMsg 
Interface中宣告的 receive()的 command函數，透
過一個指標觸發 event 來接收資料。在 TinyOS
中記憶體管理對於接收進來的訊息將會以動態
的方式管理，一個訊息抵達接收端 Mote 後會被
擺放至暫存區中，此時 Active Message Layer 會
將收到訊息的 Handler Type 解開並作處理，同
時 Application 元件將透過 ReceiveMsg.receive()
事件來處理暫存區中的訊息，當 Application 元
件處理完成後必須回傳一個指標給暫存區。假
如我們的元件需要儲存訊息內容，則需要將此
訊息複製至另一個新的暫存區，或是經由
network stack 回傳一新的訊息暫存區。在
TinyOS 中訊息封包中在標頭欄位中包含了
Group ID，Group ID允許Motes組成多個不同的
Groups 分享相同的通訊頻道，假若在一個空間
裡，例如實驗室有 Motes 組成多個 Groups，則
需設定 Group ID 值以避免接收到其他 Group 的
訊息。除此之外，標頭欄位中還囊括 16-bit 接
收端位址以供多個 Group 使用。 
3. RandomLFSR：這個元件在整個傳輸過程
當中，會隨機產生一個 16 位元的隨機數字。利
用這個元件，我們可以讓 sensor產生數值，使其
成為我們要傳輸的資料。 
4. TimerC：時間計時器。這個元件主要是
可以讓 sensor node 計算時間，接著讓時間倒
數，倒數完了之後再讓 RandomLFSR 產生資
料。 
5. GenericComm：這是元件主要是讓我們用
來通訊的。當 RandomLFSR 產生資料之後，由
22 
 
sensor node 因為光的亮度不同，感測的資料也
不同。再來，我們利用燈光照射 sensor node，
所以 sensor node 會感應到強烈的光源，如圖中
標示(2)的地方，這段的曲線數值會較高。 
 
圖(46)：Oscilloscope 對 sensor node 傳輸實作。 
我們在傳輸實作當中，利用 sink node 和
sensor node 來做距離的測試，我們讓 sensor 
node 慢慢遠離 sink node 並且觀察傳輸的過程。
如圖(46)所示，當 sensor node 與 sink node 在距
離五公尺之內的範圍，sensor Node 和 sink node
皆能夠傳輸資料，然而當超過這個範圍後，如
圖(46)中藍色標示的部份，sink node 就逐漸接
收不到資料，甚到 sink node 已收不到資料，表
示 sensor node 已經無法將資料傳輸回給 sink 
node。 
 
圖(47)：Static Sensor 接收模組設計架構圖。 
 
圖(48)：Static Sensor 接收感測範圍資訊的程式片段實
例。 
圖(49)：Static Sensor 處理接收到的感測範圍資訊封包之
程式片段。 
當感測器使用 InttoRfm Module 去廣播感測
範圍資訊的封包給週遭的感測點時，感測點可
利用RfmToInt Module來觸發封包接收事件，此
模組的設計架構圖及程式片段如圖(47)與圖(48)
所示。一旦 MicaZ 成功接收到封包時，利用
ReceiveMsg Interface 中 宣 告 的 receive() 的
Command 函數，透過一個指標觸發 Event 來接
收資料，由於 TinyOS 記憶體管理對於接收進來
的訊息將會以動態的方式管理，一個訊息抵達
接收端 MicaZ 後會被擺放至暫存區中，
Application 元件將透過 ReceiveMsg.receive()事
件來處理暫存區中的訊息。圖 (49)為接收到
Sensor 位置資訊時，Sensor Node 處理感測範圍
資訊的程式片段。 
最後，我們將這些通訊模組整合起來，燒
錄至 Mote MicaZ 中，此通訊模組包含了
InttoRfm Module以及RfmToInt Module，使得不
論是Mobile Sensor或是Static Sensor都具備傳送
與接收封包的能力。另外，我們也設計了 Timer
以及 IntToLed 兩個 Module，其主要目的分別
是提供計時器以及控制燈號的功能。完整的
MicaZ 實作架構圖如圖(50)所示。 
 
圖(50)：MicaZ 實作架構圖。 
4.4 Mobile Anchor 實機實作 
以下，我們將實機實作 Mobile Anchor 的過
程分為硬體整合與系統開發兩個部份。 
4.4.1 Mobile Anchor 硬體整合 
為了讓 Mobile Anchor 具備無線通訊的能
力，本計畫整合 MICA 2 感測節點至 Arduino 嵌
入式系統平台，使 Mobile Anchor 擁有與其他感
測器進行通訊的能力。此外，為了賦予 Mobile
行走的能力，本計畫將 Arduino 嵌入式系統基板
搭載於 BB-Car 全方位自走車上，透過 BB-Car
全方位自走車所搭載之伺服馬達，即可透過程
式輕易控制其行走方向以及行進速度。為了讓
Mobile Anchor 隨時掌握位置資訊及其行進方
向，本計畫亦讓 Mobile Anchor 搭載 GPS 全球衛
星定位系統及數位電子羅盤。圖 (51)(a)與圖
(51)(b)分別為本計畫所實作出之 Mobile Anchor
的硬體組成元件及其硬體架構。 
如圖(51)(a)所示，本計畫將 MICA 2 感測節
24 
 
串進行切割，獲得 Mobile Sensor 所在之位置。 
圖 ( 5 3 )： Mo b i l e  A n c h o r 透 過 G P S 獲 得 位 置 資
訊 。  
B. 透過電子羅盤確保其行進方向 
如圖(54)所示，當取得方向之函式啟動後首
先會執行 
HM55B_StartMeasurementCommand() 
其會初始化我們的 HM55B 電子羅盤，並指定相
關的訊號腳位，發出此命令後尚須等待 40ms 才
能取得感測資料。透過 HM55B_ReadCommand()
我們可順利取得感測資料，並透過一連串的數
學運算以獲得最終之實際方向數值，並將之回
傳於呼叫者。 
圖 ( 5 4 )： Mo b i l e  A n c h o r 透 過 電 子 羅 盤 確 保 其
行 進 方 向 。  
C. 控制 Mobile Anchor 行進的方向 
圖(55)為BB-Car之控制程式碼片段，lpin 與
rpin 分別指定為左伺服馬達與右伺服馬達之腳
位，當我們的 Mobile Sensor 透過 GPS 及電子羅
盤之資訊計算出前進方向後，透過呼叫不同的
行進方向程式碼即可使 BB-Car 進行移動。 
 
圖 ( 5 5 )： 控 制 Mo b i l e  A n c h o r 行 進 的 方 向 。  
D. 利用 MICA 2 發送訊號 
圖(56)為 Mobile Anchor 發送訊號的程式碼
片段，透過 Serial.print()函式，即可將資料透過
MICA 2 進行傳送。 
 
圖 ( 5 6 )： 利 用 M I C A  2 發 送 訊 。  
五、現有研究成果 
具 SCI 之國際期刊 
[1] C. Y. Chang, C. Y. Lin, and C. T. Chang, 
“Tone-Based Localization for Distinguishing 
Relative Locations in Wireless Sensor 
Networks,” to appear in IEEE Sensors 
Journal, 2011. 
[2] C. T. Chang, “Hash Caching Mechanism in 
Source-Based Routing for Wireless Ad Hoc 
Networks,” to appear in Journal of Network 
and Computer Applications. 
[3] C. Y. Chang, C. T. Chang, S. W. Chang, and 
S. C. Lee, “Active Route Guiding Protocols 
for Resisting Obstacles in Wireless Sensor 
Networks,” IEEE Transactions on Vehicular 
Technology, Vol. 59, No.9, pp.4425-4442, 
Nov. 2010. 
[4] C. Y. Chang, C. T. Chang, Y. C Chen, and H. 
R. Chang, “Obstacle-Resistant Deployment 
Algorithms for Wireless Sensor Networks,” 
IEEE Transactions on Vehicular Technology, 
Vol. 58, No.6, pp.2925-2941, July 2009. 
[5] C. T. Chang, C. Y. Chang, and Y. C. Chen, 
26 
 
[11] T. V. Srinath, “Localization in Resource Constrained 
Sensor Networks Using a Mobile Beacon with 
In-Ranging,” IEEE International Conference on Wireless 
and Optical Communications Networks (IEEE WOCN), 
April 2006. 
[12] J. P. Sheu, J. M. Li, and C. S. Hsu, “A Distributed Location 
Estimating Algorithm for Wireless Sensor Networks,” 
IEEE International Conference on Sensor Networks, 
Ubiquitous, and Trustworthy Computing (IEEE SUTC), 
June 2006. 
[13] A. Galstyan, B. Krishnamachari, and K. Lerman, 
“Distributed Online Localization in Sensor Networks 
Using a Moving Target,” ACM/IEEE Information 
Processing in Sensor Networks (ACM/IEEE IPSN), April 
2004. 
[14] K. F. Ssu, C. H. Ou, and H. Jiau, “Localization with 
Mobile Anchor Points in Wireless Sensor Networks,” 
IEEE Transactions on Vehicular Technology, vol. 54, pp. 
1186–1197, May 2005. 
[15] A. Ghosh, “Estimating Coverage Holes and Enhancing 
Coverage in Mixed Sensor Networks,” IEEE International 
Conference on Local Computer Networks (IEEE LCN), 
November 2004. 
[16] G. L. Xing, C. Y. Lu, R. Pless, and J. A. O'Sullivan, 
“Co-Grid: An Efficient Coverage Maintenance Protocol 
for Distributed Sensor Networks,” IEEE Information 
Processing in Sensor Networks (IEEE IPSN), April 2004. 
[17] C. F. Huang and Y. C. Tseng, “The Coverage Problem in a 
Wireless Sensor Network,” ACM International Conference 
on Wireless Sensor Networks and Applications (ACM 
WSNA), September 2003. 
[18] B. Carbunar, A. Grama, J. Vitek, and O. Carbunar, 
“Coverage Preserving Redundancy Elimination in Sensor 
Networks,” IEEE Sensor and Ad Hoc Communications 
and Networks (IEEE SECON), October 2004.  
[19] B. Carbunar, A. Grama, J. Vitek, and O. Carbunar, 
“Redundancy and Coverage Detection in Sensor 
Networks,” ACM Transactions on Sensor Networks, vol. 2, 
no. 1, pp. 94–128, February 2006,. 
[20] F. Ye, G. Zhong, J. Cheng, S. Lu, and L. Zhong, “PEAS: 
A Robust Energy Conserving Protocol for Long-Lived 
Sensor Networks,” IEEE International Conference on 
Distributed Computing Systems (IEEE ICDCS), May 2003. 
[21] H. Zhang and J. C. Hou, “Maintaining Sensing Coverage 
and Connectivity in Large Sensor Networks,” NSF 
International Workshop on Theoretical and Algorithmic 
Aspects of Sensor, Ad Hoc Wireless, and Peer-to-Peer 
Networks, 2004. 
[22] H. Gupta, S. R. Das, and Q. Gu, “Connected Sensor Cover: 
Self-Organization of Sensor Networks for Efficient Query 
Execution,” ACM International Symposium on Mobile Ad 
Hoc Networking and Computing (ACM MobiHoc), June 
2003. 
[23] T. Yan, T. He, and J. A. Stankovic, “Differentiated 
Surveillance for Sensor Networks,” ACM International 
Conference on Embedded Networked Sensor Systems 
(ACM SenSys), November 2003. 
[24] C. F. Huang, L. C. Lo, Y. C. Tseng, and W. T. Chen, 
“Decentralized Energy- Conserving and 
Coverage-Preserving Protocols for Wireless Sensor 
Networks,” IEEE International Symposium on Circuits 
and Systems (IEEE ISCAS), May 2005. 
[25] B. Karp and H. T. Kung, “GPSR: Greedy Perimeter Stateless 
Routing for Wireless Networks,” ACM International Conference 
on Mobile Computing and Networking (ACM MobiCom), August 
2000. 
 
國科會補助專題研究計畫項下出席國際學術會議心得報告(一) 
                                        日期：99 年 7 月 20 日 
一、參加會議經過 
二、與會心得 
三、考察參觀活動(無是項活動者略) 
四、建議 
五、攜回資料名稱及內容 
六、其他 
 
計畫編號 NSC 99-2221-E-164-005- 
計畫名稱 基於模糊位置之無線感測網路中設計及實作定位、繞徑及覆蓋技術 
出國人員
姓名 林志宇 
服務機構
及職稱 淡江大學 
會議時間 
100 年 7 月 10 日至
100 年 7 月 12 日 會議地點 中國北京 
會議名稱 
(中文) IEEE 汽車電子與安全國際會議 
(英文) IEEE International Conference on Vehicular Electronics and Safety  
發表論文
題目 
(中文) Location-Aware Power Saving Mechanism Based on Adaptive Quorum 
Systems for Mobile Ad Hoc Networks 
(英文) Location-Aware Power Saving Mechanism Based on Adaptive Quorum 
Systems for Mobile Ad Hoc Networks 
參加會議經過 
                                                                          99 年 7 月 20 日 
報告人姓名 林志宇 就讀系所年級 資訊所博士班二年級 
參加會議經過： 
此次 ICVES 2011 在大陸北京舉行，舉辦日期為 7/10 至 7/12，為期三天的議程中包括在資訊工程上
不同領域的研究，其中又以 Vehicular electronics、sensor network 等議題最為我所感興趣。在三天的會
議中，又以下幾個場次的議題最為精彩： 
 
July 10 
本日一共有四個會議議程，分別為 Active and Passive Safety Systems、Vehicle/Engine Control、Active 
and Passive Safety Systems、Sensor Network等。由於本實驗室對於Sensor Network的研究較有興趣，因
此本次會議均參與相關的議程。 
Session：Sensor Network 
 An Energy-Efficient Sensor Deployment Scheme for Wireless Sensor Networks 
此篇論文討論在有電量限制的無線感測網路環境下，如何有效率的分佈感測器。 
 Location-Aware Power Saving Mechanism Based on Adaptive Quorum Systems for Mobile Ad Hoc 
Networks 
此篇論文使用Quorum的技術並加入感知器位置而提出新的省電機制，並且從實驗部分來看，此
方法具有很高的成功率。 
 Fast Double-Parallel image processing based on FPGA 
此篇論文在無線感測網路環境下，基於 FPGA 的技術，提出一高速平行處理之影像處理法來提
升影像處理速度。 
 
July 11 
本日一共有六個會議議程，分別為Global perspectives of active safety systems research and development、
Vehicle Testing and Measurement Technology、Telematics、Active and Passive Safety Systems、Pattern 
Recognition for Vehicles、Driver Assistance Driving Systems、Pattern Recognition for Vehicles 等。由於本
實驗室有進行 VANET 相關的研究，因此我選擇 Driver Assistance Driving Systems 此會議議程。 
 
Session：Driver Assistance Driving Systems 
 A set of driver assistance services ready to be deployed on board 
本篇論文旨在提出一個新的方法來提升駕駛以及乘客的安全性與隱私性，且從實驗結果看來，
雖然有較高的控制封包流量，但其所達成的安全效果非常顯著。 
參加會議心得 
一、 報告時程 
Session: Sensor Network 
Time: Sunday, 10/Jul/2011 3:30 pm - 5:10 pm 
Title: Location-Aware Power Saving Mechanism Based on Adaptive Quorum Systems for Mobile Ad Hoc 
Networks 
Chao-Tsun Chang, Hsiuping Institute of Technology 
Chih-Yung Chang, Tamkang University 
Li-Ling Hung, Aletheia University 
Chih-Yao Hsiao, Tamkang University 
Chih-Yu Lin, Tamkang University 
 
 
二、 與會心得 
車用行動通訊網路 Vehicular Ad-Hoc Network (VANET)是藉由無線通訊與資料傳遞技術，串聯交通
工具以及路邊交通設施，所形成的特殊網路。其主要功能在於讓所有的用路人可以即時取得與傳遞與交
通相關的資訊，以便提高行車效率，增進用路安全與舒適性。隨著無線通訊網路技術的進步與普及，行
車安全問題也越來越受到重視，IEEE 針對 VANET 定義了約四十種的相關應用，除了學界的前瞻技術探
討外，目前美國、歐洲的業界也在發展各類型的應用，顯示出國際上對 VANET 的相關應用與研究發展
之高度重視，而在這次的研討會議裡，主要探討各類網路的研究，其議題如下： 
• Active and Passive Safety Systems  
• Telematics  
• Vehicular Power Networks  
• X-By Wire Technology  
• System-On-a-Chip  
• Vehicular Sensor  
• Vehicle Bus  
• Sensor Network  
• Embedded Operation System  
• Electro Magnetic Compatibility  
• Inter-Vehicular Network  
• Vehicle Testing  
• Vehicle Hardware /Software System  
• Navigation and Localization Systems  
• Vehicular Measurement Technology  
• Vehicular Signal Processing  
• Micro-electromechanical Systems  
• Image Sensor  
• Vehicle/Engine Control  
• Driver Assistance Driving Systems  
• Adaptive Cruise Control Systems  
• Pattern Recognition for Vehicles  
• Human Machine Interaction  
• Diagnostics on Line  
• Virtual/Digital System  
Location-Aware Power Saving Mechanism 
Based on Adaptive Quorum Systems for 
Mobile Ad Hoc Networks 
Chao-Tsun Chang1, Chih-Yung Chang2, Li-Ling Hung3, Chih-Yao Hsiao2 and Chih-Yu Lin2 
1Hsiuping Institute of Technology, Taiwan 
2Tamkang University, Taiwan 
3Aletheia University, Taiwan 
cctas@mail.hit.edu.tw, cychang@mail.tku.edu.tw, llhung@mail.au.edu.tw, {cyhsiao, 
cylin}@wireless.cs.tku.edu.tw 
 
Abstract 
Abstract－IEEE 802.11 specifies a Power Saving 
Mode (PSM) in order to save the energy consumptions 
of mobile hosts. Following the standard of PSM, a 
number of studies [1-4] further discussed the 
wakeup/sleep scheduling of beacon intervals based on 
Quorum systems so that any communication pair of 
hosts has common awake intervals for data exchange. 
However, most of them did not take into consideration 
the fact that non-neighbor stations do not require to 
have a common wake up intervals since they are 
unable to communicate with each other. Hence the 
energy conservation and the transmission delay can be 
not significantly improved. This paper utilizes the 
location information and proposes a location-aware 
power saving mechanism. Experiment results reveal 
that the proposed scheme outperforms existing 
approaches in terms of energy conservation and 
transmission delay. 
 
Keywords－Quorum; Power saving; IEEE 802.11; 
Scheduling. 
I. INTRODUCTION 
A Mobile Ad-hoc Network (MANET) which 
comprises of mobile hosts can construct a low cost 
wireless network anywhere and anytime without 
infrastructure. Since the operations of mobile hosts 
are battery powered, how to save their energy is one 
of the most important issues in MANET. A number 
of studies [2-4] have proposed their communication 
protocols by taking into accounts the energy 
conservation of mobile hosts with PSM.  
In PSM, the time is partitioned into beacon 
intervals. Each beacon interval is initiated by two 
sub-intervals, called ATIM window and Data 
window. The beacon intervals are used to 
coordinate and synchronize the communication 
chances among mobile hosts. In the ATIM window, 
a host intending to communicate with its 
neighboring host can send an ATIM packet to ask 
its neighbor staying awake in the Data window. 
Upon receiving the ATIM packet, the destination 
host will reply with an ATIM-ACK packet to 
indicate the agreement of data transmission in the 
Data window. Then the destination host should 
keep awake in the Data window for data exchange 
based on the DCF protocol defined in 802.11. 
Otherwise, the host can sleep in the Data window 
for energy conservation.  
Previous studies [2, 4] proposed a power saving 
scheme which applies a two-dimension array where 
each entry is labeled with a number denoting the 
sequence numbers of beacon intervals. Each mobile 
host randomly selects one row and one column from 
the array to determine the beacon intervals that it 
should wake up in ATIM windows. As shown in 
Fig. 1(a), host A selects the 3rd row and the 1st 
column to determine its awake beacon intervals. 
Similarly, host B selects the 3rd row and the 2nd 
column of the array. This means that host A will 
wake up in the beacon intervals 0, 3, 6, 7 and 8 
while host B will wake up in beacon intervals 1, 3, 4, 
5, 7 and 8. As a result, the common beacon intervals 
for hosts A and B communicating with each other 
are beacon intervals 3 and 7, as shown in Fig. 1(c). 
This mechanism not only simply exploits the 
communication opportunities for any pair of hosts 
in a distributed manner but also saves the energy 
consumption. However, the ratio of the awake to the 
sleep beacon intervals can be not dynamically 
improved based on the traffic load. 
0
3
6
1
4
7
2
5
8  
(a) The quorum intervals applied 
in host A. 
0
3
6
1
4
7
2
5
8  
(b) The quorum intervals 
applied in host B. 
Station A 0 3 61 4 72 5 8
Station B 0 3 61 4 72 5 8  
(c) The illustration of the common beacon intervals by 
applying the Quorum system for hosts A and B. 
Figure 1: An example for illustrating the common beacon 
intervals of hosts A and B determined by the 9 9×  
Quorum set . 
Study [3] proposed a traffic-aware Quorum 
13
6
12
18 19 20
7
2 3
9 10
16
23
0
6
13
4 5
11
12 17
20 18
27 27 24
34 34
0
24
30
25 26
3231 33
0
kC 1
kC 3
kC2
kC 4
kC 5
kC
22
5
7
15
29
30
6
kC
 
(c) 
 
1
kC 3kC2
kC 4
kC 5
kC
15
6
kC
Q[3,1] Q[0,2] Q[0,3] Q[0,4] Q[1,5] Q[2,6]
1143219
22
Q[4,1] Q[4,2] Q[1,3] Q[1,4] Q[2,5] Q[3,6]
171092625
29
Q[5,1] Q[5,2] Q[5,3] Q[2,4] Q[3,5] Q[4,6]
2316333231
 
(d) 
Figure 3: The procedure of assigning awake beacon intervals 
achieves the neighboring cells of Cki having a common awake 
beacon interval with Ck0. 
Then two neighboring cells will be assigned 
with as more as possible the common awake beacon 
intervals to exploit their communication 
opportunities. There are three conditions considered 
in the relationship of the neighboring cells: (1) 
between Ck0 and its neighbors, (2) between Ck1, 
Ck2, …, Ck5 and Ck6 (3) between the cells of the 
neighboring groups. The following depicts the 
scheduling procedure for each condition in detail. 
First, the scheduling awake beacon intervals for 
Ck0 and its neighbors will be determined cell by cell 
in the order of Ck0, Ck1, …, Ck6. The element Q[p-1, 
6] will be set to Q[p-1, p] and then the element 
Q[p-1, p] is set to Q[p-1, 0] for each p, where 
1≤p≤6. In addition, the element Q[5, 6] is set to Q[5, 
0]. Take Fig. 3(a) as the example. Since cells Ck0 
and Ck1 are neighboring, the element Q[1, 0] will be 
replaced by the element Q[0, 0], resulting in a 
common beacon interval between cells Ck0 and Ck1. 
Before the replacement, a shift operation that shifts 
the element Q[1, 0] to Q[1, 6] should be executed 
due to the element Q[1, 0] will be not used by cell 
Ck1. As a result, cell Ck1 becomes to have awake 
beacon intervals 0, 7, 13, 19, 25 and 31 as shown in 
Fig. 3(b). The similar operations will be executed 
column by column until all columns of Q have been 
arranged. In Fig. 3(b), the changed Q achieves that 
each neighboring cells of Ck0 has a common awake 
beacon interval with Ck0. 
Second, the common awake beacon intervals 
between cells Cki and Cki-1, where 2≤i≤5, are 
arranged as the element Q[i, i] is set to Q[i, i-1] for 
each i. In addition, the elements Q[0, 6] and Q[1, 6] 
are set to Q[0, 5] and Q[1, 1], respectively. Figure 
3(c) shows the modification of the array Q. Each 
cell should be arranged six awake beacon intervals 
for communicating with its neighboring cells. As 
shown in Fig. 3(c), there are three awake beacon 
intervals assigned for the columns Ck1, Ck2, Ck3, Ck4, 
Ck5 and Ck6. 
29
16
4 8
21
22
1
17
33
11 14
23
35
15
28
13
6
12
18 19 20
7
2 3
9 10
25
19
0
6
13
2 5
9
12
32
20
18
27 27
24
34 34
0
24
30
25 26
3231 31
0
kC 1
kC 3
kC2
kC 4
kC 5
kC
10
5
7
3
26
30
6
kC Unused 
Beacon Intervals 
 
Figure 4: The available location-aware Quorum applied in 
LAPS. 
Third, considering the common awake beacon 
intervals for communicating with the neighboring 
groups, the unused beacon intervals depicted in the 
Fig. 3(d) will be assigned according the relationship 
among the cells neighboring to different groups. 
Since the proposed mechanism intends to average 
the waiting time between two neighboring common 
awake beacon intervals, the common awake beacon 
intervals assignment for the neighboring groups will 
apply the rule of short row distance first. As a result, 
the elements Q[3, 5] , Q[2, 4], Q[5, 3], Q[0, 4] , Q[4, 
6], Q[2, 5] , Q[1, 5] , Q[2, 6] and Q[3, 6] will be 
replaced by Q[3, 1], Q[4, 1], Q[5, 1], Q[0, 2] , Q[4, 
2], Q[5, 2], Q[1, 3] , Q[0, 3] and Q[1, 4], 
respectively. The available location-aware Quorum 
is presented in Fig. 4. The Quorum system showed 
in Fig. 4 can guarantee the communication chance 
between Ski and the hosts located in N1(Cki) and 
avoid the collisions between Ski and the hosts 
located in N2(Cki). The location-aware Quorum 
system applied in LAPS will achieve the scheduling 
with the minimal waiting time. 
3.2 Cell Identifying Phase 
In this phase, each host has to identify the group 
and the cell where it locates in according the 
location of anchor, the area of the given network N, 
and itself location information. The network N is 
partitioned by the groups, say G1, G2, …,Gm-1 and 
Gm, and indexed by the order left to right and then 
up to down. The center of group Gk is set at the 
center point of cell Ck0. Let the anchor location be 
(x1, y1) where locates at the center point of C10. 
Figures 5(a) and (b) show the slopes of the line 
groups L1 and L2. The center point of cell Ck0 can be 
determined by computing the intersection of line 
groups L1 and L2. Since the horizontal distances 
between two neighboring lines belonged to the line 
group L1 or belonged to the line group L2 are equal 
to 4.5e, the line groups L1 and L2 can be determined 
by the following Equations. 
1 1 1 : 
2 3( ) ( ) 4.5 ,
3
L y y x x e Zα α− = − +   ∈  (1)
2 1 1 : 
5 3( ) ( ) 4.5 ,  
3
L y y x x e Zβ β−− = − + ∈  (2)
 
1
0C 34
2
e×
(x1, y1)
e
3e
L1
(a) 
e
1.5e
L2
35
2
e×
1
0C
(x1, y1)
(b) 
Figure 5: (a) The slope of line group L1. (b) The slope of line 
group L2. 
Figures 6(a) and (b) show the line groups L1 and 
L2 how to determine the group and the cell where 
intervals will be used to reduce the transmission 
delay caused by collisions. 
Another, the adapted beacon intervals are also 
used to increase the bandwidth when the data can 
not be sent within a DATA window. To achieve this, 
the sender will inform the receiver about the 
remaining data. Upon receiving the data, the 
receiver can determine whether the adapted beacon 
intervals are required to be extended for the 
following transmission. The same extension of the 
adapted beacon intervals is also determined by the 
sender. If it is the case, both of the sender and the 
receiver will intend to add the next adapted beacon 
intervals. This means that both of the sender and 
receiver will be wake up at the adapted beacon 
interval for sending and receiving the remaining 
data. Note that the adapted beacon intervals are 
extended one by one depending on the size of 
remaining data. 
As shown in Fig. 4, we assume that a sender, 
says x, stayed in cell Ck1 intends to communicate 
with the receiver, says y, located in cell Ck5 at the 
interval Q[3, 1]=19. Assume that the data 
transmission needs 3 beacon intervals. Host x will 
send the remaining data. Upon receiving the packets, 
host y is aware that it needs to extend the next 
adapted beacon interval to receive the remaining 
data of host x. As a result, the adapted beacon 
intervals 21 and 22 will be extended for the 
transmission, and hence the transmission delay is 
only one beacon interval. Note that, without 
applying the adapted beacon intervals, the 
transmission delay will be up to 70 beacon intervals 
in the example. 
V. PERFORMANCE STUDIES 
This section investigates the performance 
improvement of the proposed scheme against the 
802.11 PSM, PowerMac [2], and AQEC [3] by 
using the simulator ns-2 [5]. In the experiments, the 
MANET region is set to the area of 600 meters × 
600 meters and a number of hosts, ranging from 30 
to 150, are randomly deployed in the network. The 
communication range is 250 meters. The variable 
bit rate from 0 to 40kbps is considered as the traffic 
model when comparing LAPS with the other 
schemes. The energy consumption for transmitting, 
receiving, idling and sleeping are set to 1400mW, 
1000mW, 830mW and 130mW, respectively. 
Figure 7 shows the comparison of the efficiency 
of energy consumption among 802.11 PSM, 
PowMac and the proposed mechanism. In general, 
the efficiencies of energy consumption of the 
compared schemes are increased with the number of 
hosts. This is because that the network traffic and 
collisions increase with the number of hosts and 
hence the energy consumption required for 
successfully transmitting each byte is also increased 
accordingly. The IEEE 802.11 PSM has a poor 
performance because all hosts stay awake in each 
ATIM window regardless that whether or not they 
attempt to transmit data. The PowMac has higher 
packet loss rate and thus has lower energy 
efficiency. The proposed mechanism outperforms 
the other compared mechanisms since the adapted 
beacon intervals can be applied to reduce the 
transmission delay and increase the transmission 
bandwidth. 
802.11 PSM
PowMac
LAPS
Figure 7: The performance comparison of 802.11 PSM, 
PowMac and ALPS in terms of the efficiency of energy 
consumption. 
Figure 8 investigates the comparison of the 
efficiency of energy consumption among 802.11 
PSM, AQEC and the proposed mechanism. The 
AQEC will degrade to the IEEE 802.11 PSM that 
all hosts awake in each beacon interval when the 
network traffic is extremely large. However, the 
accumulated packets compete with the current 
traffic and hence the packet loss rate of AQEC is 
worse than IEEE 802.11 PSM and the proposed 
LAPS. The proposed mechanism not only avoids 
the packet collision problem but also utilizes the 
unused beacon interval for packet retransmission. 
Hence the proposed LAPS outperforms 802.11 
PSM and AQEC in terms of efficiency of energy 
consumption. 
802.11 PSM
AQEC
LAPS
 
Figure 8: The performance comparison of 802.11 PSM, AQEC 
and ALPS in terms of the efficiency of energy consumption. 
VI. CONCLUSIONS 
A number of power saving mechanisms have 
been developed by applying the quorum system 
based on the IEEE 802.11 PSM. However, they did 
not take into account the fact that hosts larger than 
one hop distance did not need to have the common 
awake intervals since they are unable to 
communicate with each other. In addition, none of 
them utilize the location information in the design 
國科會補助專題研究計畫項下出席國際學術會議心得報告(二) 
                                        日期：99 年 7月 20 日 
一、參加會議經過 
二、與會心得 
三、考察參觀活動(無是項活動者略) 
四、建議 
五、攜回資料名稱及內容 
六、其他 
計畫編號 NSC 99-2221-E-164-005- 
計畫名稱 基於模糊位置之無線感測網路中設計及實作定位、繞徑及覆蓋技術 
出國人員
姓名 林志宇 
服務機構
及職稱 淡江大學 
會議時間 
100 年 7 月 6 日至 
100 年 7 月 10 日 會議地點 中國安徽省黃山市黃山學院北區 
會議名稱 
(中文) 2011 海峽兩岸前瞻技術研討會  
(英文) 2011 海峽兩岸前瞻技術研討會  
發表論文
題目 
(中文) Design and Implementation of a Campus Surveillance System for Wireless 
Sensor Networks 
(英文) Design and Implementation of a Campus Surveillance System for Wireless 
Sensor Networks 
參加會議經過 
                                                                          99 年 7 月 20 日 
報告人姓名 林志宇 就讀系所年級 資訊所博士班二年級 
參加會議經過： 
此次「2011 海峽兩岸前瞻技術研討會」在大陸北京舉行，舉辦日期為 7/6 至 7/10，為期五天的議
程中包括在資訊工程上不同領域的研究，如「多媒體、人工智能與軟性計算」、「網路與通訊」、「資
通安全」等。其中，在「多媒體、人工智能與軟性計算」方面，學者們主要提出與「多媒體處理」、
「計算機視覺」、「人工智能技術與應用」、「機器學習」、「軟性計算」與「演化計算」相關之論
文；而在「網路與通訊」方面，主要包含「寬頻網路」、「無線通信」、「行動計算」、「智慧生活」、
「綠能技術」與「雲端計算」等論文；在「資通安全」方面，包含「行動通信安全」、「密鑰管理」、
「網路安全」、「密碼技術」、「雲端技術安全」、「信息隱藏」、「數字簽名」與「鑑別」。 
我所發表的論文題目為「Design and Implementation of a Campus Surveillance System for Wireless 
Sensor Networks」，其屬於「網路與通訊」中的「智慧生活」類別。對於此篇論文，許多的與會研究
者對於我們論文的細節很感興趣，同時也互相交流了彼此的意見。此外，從這次的會議中，也讓我體
會到許多電腦技術均已相當成熟。希望國內應該要多多舉辦類似的會議，提供國內的學者一個交流的
平台，如此，相信對於國內的學術風氣及國際地位能有相當程度的幫助。 
整體來說，此次會議辦的相當成功，尤其是在「網路與通訊」相關議題上令我收益良多。此外，
不論在軟、硬體的準備上都很周到，希望以後還有機會參加這個會議。 
 
Design and Implementation of a Campus Surveillance System for 
Wireless Sensor Networks 
 
Chao-Tsun Chang1, Chih-Yung Chang2, and Chih-Yu Lin2 
1Hsiuping Institute of Technology, Taiwan 
2Tamkang University, Taiwan 
cctas@mail.hit.edu.tw, cychang@mail.tku.edu.tw, cylin@wireless.cs.tku.edu.tw 
 
摘要 
近年來校園問題氾濫，引起社會大眾的重
視，除了各單位的巡察人員擔負起校園安全與
危機處理的責任外，各校也裝設監視、照明系
統，以消極抵制外人入侵校園的竊盜、縱火、
破壞與騷擾等等。然而現有的監控設備大都以
24 小時持續攝影，不僅造成儲存設備的大量負
擔與成本、更提高搜尋上的時間及人力成本，
而當意外事件發生後，再進行監控影像比對亦
失去對事件處理的即時性。本研究應用新興的
無線感測器網路技術，發展一套即時監控系
統。本系統整合紅外線感應、光感應、無線傳
輸、視訊遠端監控之自動開及關閉等多種先進
技術，首先，我們在校園監控區建置紅外線感
應照明燈及具光感應功能之感測器，當感應照
明燈以紅外線感應到闖入者，無線感測器將感
應到光度的變化，並以無線的方式通知資料收
集者，資料收集者將透過 Ethernet 發送監控指令
控制攝影機的轉動、拍照與錄影及停止錄影，
並可將此警訊同時傳遞至警衛室或巡邏者。本
系統的軟體架構具有擴充性，容易維護，可大
幅降低系統整合及後續開發成本。本系統以
nesC 及 C 分別實作於 MICA2 Sensor Node 及
Stargate Gateway 以實現系統的建置及實作實驗
顯示，相較於傳統的固定巡邏轉動及持續攝
影，本系統更具備實用的價值。 
關鍵詞: MICA2、nesC、Stargate Gateway. 
 
Abstract 
In recent years, the campus security has received 
much attention and been widely discussed. 
Nowadays, each school has equipped with a 
monitoring system which consists of a motion 
detection sensor, a camera, a lighting system to 
passively avoid theft, arson, sabotage and 
harassment and so forth. However, most of the 
existing monitoring equipment usually works all the 
time, hence leading to the maintenance cost in terms 
of a lot of storage and energy consumption. This 
work applies a novel wireless sensor network 
(WSN) technology to develop a real-time 
monitoring system which integrates the sensing 
system, communication system as well as the 
remote control framework. Hardware components 
of the sensing system mainly consist of MICA2 
sensor nodes with motion detection sensor, camera, 
lamp, and a gateway. When any people moves 
around the sensing system, the motion detection 
sensor can detect the motion event and then power 
on the lamp. The light sensor can subsequently 
detect the light change and starts to notify the 
gateway in a wireless sensor node. The message 
sent from the light sensor to the gateway includes 
the location of the light sensor. Upon receiving the 
event message from the light sensor, the gateway 
subsequently drives the camera starting to monitor 
the image of the people until the motion event 
disappears. Software that implements the MICA2 
sensors and the gateway are nesC and C languages, 
respectively. Performance evaluation reveals that 
the designed system has a good performance in 
terms of intruder tracking. 
Keywords: MICA2, nesC, Stargate Gateway. 
 
1. 前言 
近年來，由於無線感測網路(Wireless Sensor 
Network)的快速崛起，讓許多學術領域的研究人
員投入此專業領域之中。無線感測網路可被廣
泛的應用於醫療照護、軍事、災難、環境監
控、工廠管理及智慧型家電等應用。隨著科技
的日新月異，微型製造技術以及通訊技術也隨
之成長，以往許多門檻高的應用，就技術上而
言已非遙不可及。這也使得感測器具備了感
應、無線通訊及處理資訊的能力，其不但能夠
感應及偵測環境目標物的改變，並且可處理收
集到的數據，並將處理過後的資料以無線傳輸
的方式送到資料收集中心(Sink)或基地台(Base 
Station)。透過在生活環境中佈置大量、微小、
便宜而低耗電的感應、計算及通訊裝置，將可
建構各式各樣之無線感測網路以提供安全及便
捷的服務應用。 
以下我們從文獻探討及現有的系統來探究
監控及追蹤的技術進展，並藉以區別本系統設
計及實作之貢獻與價值。在過去的研究中，雖
然在文獻 [1][2][3]有大量的研究提出不錯的監
控、後續追蹤及事件處理等通訊協定，然而，
其均假設感測器可偵測闖入物。現有商業化的
感測器大都均只能感測聲音、溫度、光度、溼
2.2 系統軟體架構 
在整個監控系統的實作中，最核心的部份
有包括 Motes 光感應感測器中的感應及通訊、
Stargate 中的資料收集與接收、Stargate 的事件
位置計算及 CCD 的轉動與錄影操控。如圖二元
件(1)所示，作為感測環境光度的 MICA2，使用
其內部的計時器，每隔一固定的時間便驅動光
感應元件感測目前光度，並透過無線電發射器
傳送出去。如圖二元件(2)所示，接收端感測器
接收到來自無線電的資料後，將資料內容轉換
為 UART 格式輸出。如圖二元件(3)所示，在
Stargate Gateway 接收資料前，先透過 Serial 
Gateway 的硬體處理，將 UART 資料以 RS-232
介面輸出。如圖二元件 (4) 所示， Stargate 
Gateway 接收來自 RS-232 的資料，進行資料分
析及計算處理後，決定攝影機的轉動或攝影等
行為，並透過 Ethernet 發送控制指令給予攝影
機。 
 
圖二：無線感測網路監控系統軟體架構 
MICA2 是可程式化的單晶片平台。美國加
州大學柏克萊分校(UC Berkeley)針對 MICA2 設
計 TinyOS [6] 這套嵌入式作業系統，與
nesC(network embedded system C)[7]程式語言，
nesC 程式語言的架構與語法跟一般我們使用的
C 語言擁有類似的架構與指令；而 Stargate 使用
的作業系統為 Linux，核心版本為 2.4.19，並且
支援大多數的 Debian[8]公用程式，支援 jffs2、
ext2、ext3、vfat 及 msdos 檔案格式；由於是
Linux 的核心，所以大多數的程式語言都能夠在
此平台運行，而我們選擇了執行速度較快速，
適合嵌入式系統的C語言。我們結合C、nesC和
TinyOS，分別開發我們所需要的功能與協定，
並載入到監控系統的硬體中。 
以下，我們將針對這些重要的軟體元件逐
一介紹其特性及功能。 
A. Tiny OS 作業系統 
TinyOS 是一開放源碼之嵌入式作業系統，
為加州柏克萊大學為無線感測器所開發的作業
系統。主要應用於無線感測器網路之實作。
TinyOS 是屬於『元件式』的作業系統，依據嵌
入應用可輕易增減控制執行的功能，且編譯器
可避免資料競爭(Data Race)的現象，有助於節省
記憶體空間的硬體資源，且能夠同時執行多個
要求快速回應的控制運作。 
TinyOS 有兩種負責處理同步的函式，分別
是任務(task)與事件(event)，任務一旦被執行便
必須執行到結束，每一個任務之間不能互相中
斷，較適用於短時間或是非即時的運算。事件
被觸發之後亦會執行到結束，但事件可中斷正
在執行的任務或是其他的事件。另外，TinyOS
提供了雙向運算(split-phase operation)的機制，
一個是進行運算的命令(command)函式，另一個
則是運算完成之後的事件(event)函式。以傳送封
包為例，傳送端呼叫〝send〞command，表示傳
送開始，當傳送完成後，會觸發〝sendDone〞事
件，代表傳送結束。雙向運算的好處是，在等
待運算完成時，可以先進行其他的事件要求，
不必浪費等待的時間。 
TinyOS 有著元件基礎(component based)的
結構，提供一群內建的系統元件，功能各自不
同，譬如感光、計時、網路協定等等。程式設
計者設計應用程式時，將所需用到的元件做一
連結即可。而這些元件程式全部皆由 nesC 所撰
寫而成。nesC 的語法和 C 類似，它不但為
TinyOS 提供協同模型(Concurrency Model)，更
提供了架構 TinyOS 系統的命名(Naming)及連結
(Link)元件的功能。最終的目地即是希望讓程式
設計者在執行程式的時候能更輕易的偵錯。 
B. nes C 程式語言 
nesC 是 C 語言的一種擴展，是用來使
TinyOS 執行模組具體化的程式語言。nesC 其程
式架構和內容是分離的，且元件是經由各介面
做靜態連結 (link)，每個介面又都具有雙向
(bidirectional)的特性，各元件的行為必須在介面
實作中詳述。 
表格一、介面的實現 
Component Command Event 
Use Can call Must 
implement 
Provide Must 
implement 
Can signal 
 
在 nesC 中，介面(interface)具有雙向溝通的
能力，並且描述在提供者 (provider)跟使用者
(user)間的交互管道。在介面中具有事件(event)
跟命令(command)兩組指令集，其實現如表格一
所示。 
元件 (component)包含了兩類：一是模組
(Module)，另一是結構(Configuration)。在模組
後固定長度的資料即為一個完整的封包，進而
取得封包內容中的感測器座標及光度數值。 
由於我們的攝影機 DCS-5300G 一次轉動的
角度約為 15 度，故我們將一個平面分為 13 個目
標區域，如圖五所示，我們設定攝影機位置於
所有線段的交點並且面向正前方，初始目標區
域為 6。當接收封包獲得光感應感測器的座標，
計算出光感應感測器與攝影機的相對位置後，
利用反函數 atan 計算出從目前目標區域轉動到
其他目標區域所需的角度，並將角度換算為目
標區域代號。每次轉動攝影機後，會紀錄下目
前所在的目標區域，當計算出新的目標區域
時，將利用新目標區域代號減去目前所在目標
區域代號，計算出需要轉動的次數，必且若為
正數為向左轉動，負數為向右轉動，並進而發
送適當的轉動及錄影的控制指令給予攝影機。 
角度計算公式如下： 
 
PI
ccdYmoteY
ccdXmoteX
angle
180)(tan 1 ×−
−
=
−
 (1)
轉動的次數的定義如下： 
TurnCount = new_target – old_target (2)
 
圖五：攝影機區域圖 
 
由於我們的攝影機 DCS-5300G 並沒有公開
其遠端控制程式化的方法，所以我們利用封包
擷取的方式，將攝影機所有的控制指令及其對
應的封包所有內容擷取記錄下來，並將封包完
整內容寫在程式之中，所以使用控制指令時，
將封包內容完整傳送給攝影機即可。 
 
4. 實驗數據 
為了評估我們的監控系統是否能夠有效追
蹤闖入物，我們做了實驗，並在不同的情境
下，探討其監控的效率。在我們的實驗設計
中，闖入物是以一般人行走的速度進入監控區
域，並沿著闖入位置與攝影機等距離的圓的圓
周行走。 
我們的實驗是觀察攝影機在闖入物闖入的
第一時間，攝影機轉動到達目標感測器區域時
是否成功捕捉到闖入物的畫面。我們的攝影機
DCS-5300G 每次轉動 15 度角約花費 0.7 秒，在
實驗情景中，我們假設闖入物以一般人行走的
速度 4km/hr 移動，我們使闖入物從各個區域闖
入並沿著以攝影機為圓心距離 5、10、15、20公
尺的同心圓往區域 6移動。表格二即為實驗的結
果。 
表格二、實驗情景一追蹤成敗表 
距離
區域
離攝影
機5m 
離攝影
機10m 
離攝影
機15m 
離攝影
機20m
0 失敗 失敗 失敗 成功 
1 失敗 失敗 成功 成功 
2 失敗 失敗 成功 成功 
3 失敗 成功 成功 成功 
4 失敗 成功 成功 成功 
5 成功 成功 成功 成功  
由於闖入物追蹤的成功與否與攝影機轉動
的速度有著絕對的關係，若能夠提昇攝影機轉
動的速度將會有更好的效果。 
 
5. 結論 
監控系統是校園安全中非常重要的一環，
其可有效抵制外人的入侵並在事件發生時即時
啟動事件之緊急處理程序。傳統監控系統不僅
耗費人力物力，在事件發生後進行監控影像比
對亦失去對事件處理的即時性。為了能夠使監
控系統更有效率，並且擁有即時性。我們整合
多種先進技術，設計並實作一高效能的監控系
統，我們所設計的監控系統能夠得知事件發生
的時間及位置，並立即對事件位置區域進行錄
影監控，其優點為省電、節省儲存體空間、減
少監控系統死角以及易於檢視事件攝影紀錄
等。 
除了系統的實作外，我們亦針對此監控系
統進行實驗，闖入物以各個不同的距離及各個
不同的角度闖入監控區域。實驗結果顯示，無
線感測網路監控系統除了省電、節省儲存體空
間及易於檢視事件攝影紀錄等優點，還能夠有
效的監控各個區域。 
參考文獻 
[1]  C. Y. Lin, W. C. Peng, and Y. C. Tseng, “Efficient 
In-Network Moving Object Tracking in Wireless Sensor 
Networks,” IEEE Transactions on Mobile Computing, vol. 
5, no. 8, pp. 1044-1056, August 2006 
[2]  J. Aslam, Z. Butler, F. Constantin, V. Crespi, G. Cybenko, 
and D. Rus, “Tracking a Moving Object with Binary 
Sensors,” ACM SenSys, 2003. 
[3]  H. T. Kung and D. Vlah, “Efficient Location Tracking 
Using Sensor Networks,” IEEE WCNC, 2003. 
[4]  Crossbow Technology Inc.: Online available at: 
http://www.xbow.com 
[5]  D-Link Inc.: Online available at: http://www.dlink.com/ 
[6]  TinyOS: Online available at: http://www.tinyos.net 
[7]  NesC: Online available at: http://nescc.sourceforge.net 
[8]  Debian: Online available at: http://www.debian.org/ 
[9]  A. Caruso, S. Chessa, S. De, and A. Urpi, “GPS-Free 
Coordinate Assignment and Routing in Wireless Sensor 
國科會補助計畫衍生研發成果推廣資料表
日期:2011/10/27
國科會補助計畫
計畫名稱: 基於模糊位置之無線感測網路中設計及實作定位、繞徑及覆蓋技術
計畫主持人: 張兆村
計畫編號: 99-2221-E-164-005- 學門領域: 計算機網路與網際網路
無研發成果推廣資料
已獲得件數 0 0 100%  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
1.可改善現有 wireless sensor node 產品(如 Mica2, Mica2Dot, Mica Z 等)之
硬體中的通訊協定，以防止感測器消耗不必要之電量或產生空洞問題。 
2.現有 Wireless Sensor Node 將可具更高的智慧並延長其電量使用時間，已商
業化的現有設備如 Mica2, Mica2Dot, Mica Z 等產品，將能在通訊時具有更長
的生命期。 
3.待效能調整後可申請專利。 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
