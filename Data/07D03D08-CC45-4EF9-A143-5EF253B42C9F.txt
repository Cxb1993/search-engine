impedance controller, cross-couple compensator and 
exercise data transmitter are accomplished by 
dsPic30F6015 and dsPic30F4011 such that a virtual 
mechanism connected body-building system is developed 
and constructed. The experimental results demonstrate 
the system feasibility and variability. Moreover, the 
proposed control scheme can guarantee the system with 
good tracking performance in synchronous and 
independent mode. 
英文關鍵詞： impedance control, fuzzy neural networks, body-
building system. 
 
 2
個設備的重量也非常重且須佔據相當大的空間，
對於ㄧ般家庭中使用上既佔空間又難以移動。若
是能將其阻力來源改以電能驅動的方式來產生，
以馬達來產生原本質塊、阻尼或是彈簧的反作用
力，這樣可以大大縮小原本設備的體積和重量，
若需變換這些配備的重量或是元件，只需重新設
定系統中的參數，如此可讓健身保健器材能夠容
易使用於健身房之外的空間，而且不佔空間又易
於操作，實為未來研究發展之目標。 
2. 研究目的 
健身器材在一般的傳統的使用上，是經由質
塊、阻尼器與彈簧所構成，其參數值的選取是依
據使用者的運動需求來決定。當剛開始訓練或是
肌耐力較不足的情況下，質塊會少放一些，讓移
動時可以較輕鬆省力，彈簧也會選擇少並聯幾
條，或是選用彈簧係數較低來進行健身，這些模
式在傳統上利用牛頓力學即可輕易被分析與建立
其數學模式。而本計畫提出之健身系統，除了是
將以上傳統的物理式健身器材，轉換為由電氣驅
動的方式，讓原本被動物理性的力經由線性滑軌
內的馬達產生該阻力或恢復力，讓使用的人可以
感受到與原本傳統健身器材相同的鍛鍊與運動效
果。 
實際之健身器材的應用上，以上肢為例，常
常都是使用到雙手同時操作，除了特定鍛鍊某隻
手的特定肌肉外，極少只採用單手操作。但是，
雙手操作的機構，其連桿或是同動機構往往又是
造成體積較大與收納不易的問題所在，因此本計
畫為了克服這些問題，提出了虛擬連接之同動健
身系統。原本 98 年計畫單滑軌之設計擴增為雙滑
軌，此雙滑軌之間無任何連結機構，如圖 1 所示，
但其線性滑軌系統必須擁有與傳統健身器材相同
的動態響應。 
在工業控制應用的產品上，大多使用微處理
器作為系統的控制核心，將所需的控制法則與數
值估測和運算以軟體撰寫於微處理器中處理，並
結合外部硬體電路處理訊號擷取和裝置的驅動。
Microchip 公 司 出 產 之 dsPic30F4011 及
dsPic30F6015 晶片，其運算能力強，也整合一些
馬達驅動相關電路和模組於其中供開發者使用，
因而其在馬達控制領域應用的相當廣泛。其優異
的運算能力，可以供遞迴式模糊類神經網路與肌
電訊號處理時所需的大量運算，快速準確地計算
出控制所需的參數和數值，達到極佳的控制效
果。在週邊電路部分，因其內建脈波寬度調變模
組 (Pulse Width Modulation)與編碼器脈波數的
QEP 模組，這大大簡化系統電路設計的複雜度，
可快速發展以達到線性滑軌中馬達驅動控制的目
的 。 因 此 本 計 畫 設 計 dsPic30F4011 及
dsPic30F6015 控制模組，利用其優異的運算能力
和完善的週邊電路，將設計之強健遞迴式模糊類
神經網路控制器與模糊阻抗調整器以軟體撰寫其
中，且可透過 QEP 模組回授線性滑軌的位置訊
號，並配合馬達之驅動器與線性滑軌機構，完成
本計畫所提出之具體能監測之智慧型健身保健系
統。 
 
 
 
圖 1 線性滑軌之外觀 
 4
圖如圖 2a；若考慮利用重力的形式的數學模式則
如(1b)式，其示意圖如圖 2b 所示。 
sgn( )        
                 if ( )
0;  0         others
L R d
L R d
F F Mx Bx Kx x F
F F Mx Bx Kx F
x x
+ = + + +⎧⎪ + − + + >⎨⎪ = =⎩
  
 
 
  (1a) 
   
                      if 0
   0; 0;  0
                      if  0  and 0
L R
L R
L R
F F M g Mx Bx Kx
F F M g
x x x
F F M g x
+ − ⋅ = + +⎧⎪ + − ⋅ >⎪⎨ = = =⎪⎪ + − ⋅ ≤ ≤⎩
 
  (1b) 
其中， ,  L RF F 是使用者左側與右側外加施力，M
是阻抗值中之質量，B 是阻抗值中之阻尼係數，K
是阻抗值中之彈簧係數， x 是系統位移， g 為重
力加速度， dF 為摩擦力， sgn( )i 代表正負符號。 
    2. 兩側施力運動：像是擴胸健身器材、兩軸
連動健身器材等。這類型的數學模式較單側施力
複雜，其動作完全取決於兩側施力之值，若施力
相等時左右的位移理論上會是同動運動；若不平
衡時，質塊會朝向力量較大的方向移動，其示意
圖如圖 3，數學模式如(2)式。 
( ) ( ) ( )
( )
L R L R L R L R
L R L R
F F M x x B x x K x x
F F M x x
⎧ + = − + + + +⎪⎨ − = −⎪⎩
   
 
 (2) 
    根 據 (2) 式 再 推 導 出 1 2( ) ( , )L Lx t f F F= 與
1 2( ) ( , )R Rx t f F F= 的關係式。結合上述的數學模式
分析，即可建立不同類型健身保健器材阻抗的參
考模型。 
LF RF
Lx
Rx
 
(a) 
  
L RF F+
 
(b) 
圖2 單側施力拉伸健身器材之示意圖。 
     
LF RF
Lx Rx
 
圖 3 兩側施力拉伸健身器材之示意圖。 
b、虛擬連結之線性滑軌阻抗控制架構之設計 
    虛擬連結之線性滑軌阻抗控制架構如圖 4 所
示。其中阻抗控制的部份，藉由力量感測器偵測
輸入力量 F 後，經過阻抗參考模型分別產生線性
滑軌的速度命令 * *,  L Rx x  與位置命令 * *,  L Rx x ，然後輸
出個別的控制力。而兩根滑軌雖無連動機構，但
需產生連動的效果，兩根滑軌在施力的過程中會
隨時變動且可能不一致，因此本計畫中加入一個
動態模糊類神經網路控制器來補償同動時的誤
差，在傳統模糊類神經網路中加入內部神經元的
動態回授，使整個網路中能夠更即時反應當下的
狀態與控制整個複雜的動態系統，來控制此無連
動機構之雙滑軌健身保健器材達成連動的動作。    
結合阻抗控制與同動補償器使系統之輸出速
度 ,  L Rx x  和輸出位置 ,  L Rx x 能協調地追蹤命令
值。由圖中可知， * *,  L Rx x  與 * *,  L Rx x 是由阻抗值和外
在施力所決定，其中左右施力 LF 與 RF 愈大，位移
速度愈快、位移量愈大；阻抗值設定愈大時，位
移速度要快或位移想要大時則需要更大的施力，
這是可以依照使用者所需來設定更改。這兩項變
因決定了系統中的阻力及動態響應的參考依據。 
阻抗控制中的阻抗參考模型，將事先設計好
存在數位訊號處理器中，以供未來使用者切換模
式用。而在阻抗控制的部分，將誤差量輸入阻抗
控制器之中，以產生線性滑軌中馬達驅動的電流
命令 * *( )nL sLi i+ 與 * *( )nR sRi i+ ，在此為簡化整個系統的
複雜度，阻抗控制器採用比例-積分-微分控制器
與強健遞迴式模糊類神經網路補償器。比例-積分
-微分控制器用以讓標秤模型輸出近似參考模
型，讓線性滑軌的標秤模型輸出具有快速且精確
的追蹤性能，而系統的非線性、不確定參數及變
動負載的部分，將由強健遞迴式模糊類神經網路
補償器對系統即時提供補償力，使此線性滑軌在
參數及負載變動下皆具有良好的響應和強健性。 
 6
線性滑軌
機構馬達
阻抗參考模型
比例積分
微分控制器
單滑軌系統
之標秤模型
強健式
模糊類神經
網路補償器
外加施力F
*x
*x
nx
nx
ne
ne *
ni
*
si
*i
e
e
x
x
+
+
+
+
+
−
−
−
−
*
C ii
 
圖 5 線性滑軌阻抗控制之架構 
 
其中 ( )ijz k 與 ( )ij kσ 分別是歸屬函數中的中心值和
寬度的參數。 ( )si k 則是強健式模糊類神經網路補
償器的輸出， 4 ( )rW k 為規則庫層到輸出層的權值。 
    最終線性滑軌馬達驅動器的電流命令為： 
               * * *( ) ( ) ( )n si k i k i k= +          (5) 
    為了確保強健式模糊類神經網路補償器的控
制命令 *( )si k ，可以確實補償真實系統與系統標秤
模型控制間的誤差，定義強健式模糊類神經網路
補償器的誤差函數為 
2 21 1( ) ( ( ) ( )) ( )
2 2n
E k x k x k e k= − =    (6) 
    藉由最深梯度法與連鎖律，模糊類神經網路
中的權值更新法則可表示為： 
4 4 4( 1) ( )r r rW k W k Wη+ = − Δ  
( 1) ( )ij ij ijz k z k zη+ = − Δ  
( 1) ( )ij ij ijk kσ σ η σ+ = − Δ  
其中 
22
4
* 2
1,  
( )
exp
( )
i ij
r
i j ms ij
z zEW
i σ= ∈
⎡ ⎤−∂Δ = −⎢ ⎥∂ ⎢ ⎥⎣ ⎦∏       (7) 
22
4
* 2 2
1,  
2( ) ( )
exp
( ) ( )
i ij i ij
ij r
r i j ms ij ij
z z z zEz W
i σ σ= ∈
⎡ ⎤− −∂Δ = −⎢ ⎥∂ ⎢ ⎥⎣ ⎦∑ ∏  (8) 
2 22
4
* 3 2
1,  
2( ) ( )
exp
( ) ( )
i ij i ij
ij r
r i j ms ij ij
z z z zE W
i
σ σ σ= ∈
⎡ ⎤− −∂Δ = −⎢ ⎥∂ ⎢ ⎥⎣ ⎦∑ ∏  (9) 
*
4
* 4
( )( )
( ) ( )
S
r
S r
i kE kW
i k W k
∂∂Δ = ∂ ∂                 (10) 
* 3
1
1 * 3
1 1
( ) ( )( )
( ) ( ) ( )
D S S
S D
S S s
i k O kE kr
i k O k r k
∂ ∂∂Δ = ∂ ∂ ∂          (11) 
 
2* 3
1
* 3 2
1
( )( ) ( )( )( )
( ) ( ) ( ) ( )
ijS S
ij
S S ij ij
O ki k O kE kz k
i k O k O k z k
∂∂ ∂∂Δ = ∂ ∂ ∂ ∂   (12) 
2* 3
1
* 3 2
1
( )( ) ( )( )( )
( ) ( ) ( ) ( )
ijS S
ij
S S ij ij
O ki k O kE kk
i k O k O k k
σ σ
∂∂ ∂∂Δ = ∂ ∂ ∂ ∂   (13) 
以上之η為學習因子，本計畫利用(4)~(6)式推導出
(10)~(13)式之結果。 
d、無連動機構之雙線性滑軌阻抗控制器 
動態模糊類神經網路控制器之架構圖如圖 7所
示，其數學運算可表示為： 
 8
另外在倒傳遞演算法(back-propagation)更新
權值時，若選擇較小的學習因子，其收斂速度將
變得緩慢，造成響應速度不夠快的缺點；而若選
擇較大的學習因子則極容易造成系統的震盪，甚
至出現發散不穩定的現象。所以選擇一個良好的
學習因子，是糢糊類神經網路穩定的重要關鍵。
基於如此的考量，本計畫以 Lyapunov 定理分析
模糊類神經網路的穩定度，以求得較適之學習因
子。 
首先，定義離散型式之 Lyapunov 函數： 
21( ) ( )
2c c
V k e k=             (20) 
而 Lyapunov 函數的變化量可表示為 
2 21( ) ( 1) ( ) ( 1) ( )
2c c c c c
V k V k V k e k e k⎡ ⎤Δ = + − = + −⎣ ⎦ (21) 
根據 Lyapunov 定理，若系統穩定則滿足
( ) 0cV kΔ < 的條件。因此，若將誤差函數變化量改
寫成 
( )( 1) ( ) ( ) ( )
T
c
c c c c
e ke k e k e k e k W
W
∂⎡ ⎤+ = + Δ = + Δ⎢ ⎥∂⎣ ⎦ (22) 
上式之 WΔ 為(16)~(18)。本計畫將研究利用
(16)~(18)式代入(22)式，整理出結果，再將(22)代
回(21)式，分析滿足 ( ) 0cV kΔ < 所需達成的條件，
求得學習因子 cη 的穩定範圍與選擇的最佳數值。 
5. 結果與討論 
a. 實驗結果 
    本文採用 dsPIC30F4011 與 dsPIC30F6015 為控
制核心，控制整個系統的運作。使用磁簧開關、微
動開關來做移動平台的原點位置判斷以及系統的
安全機制功能，將拉力計所偵測到的訊號送到控制
核心。用由 TLP250、IR2101 所組成的驅動電路及
大功率晶體 6MBI15L-120 來驅動馬達使線性滑軌
移動。 
本系統兩組線性滑軌的虛擬連結，是經由控制
核心中的SPI(串列外設介面)模組來實現，主控線性
滑軌跟從屬線性滑軌作溝通，故將兩組線性滑軌的
拉力計所讀取到的訊號都送到主控線性滑軌的控
制核心A (dsPIC30F6015)，再經由SPI模組傳送給從
屬線性滑軌的控制核心B (dsPIC30F4011)，控制核
心B再利用PI控制方程式計算後，從PWM(脈波寬度
調變)模組產生波形，輸出至驅動電路。控制架構如
圖8所示。 
本系統使用馬達來替代一般健身器材的鍊條
或皮帶，以通電之後產生的轉速和扭力來替代質塊
或彈簧。本系統的操作流程圖如圖 9 所示，機構開
始運作後移動平台會先進行歸位之動作，移動平台
須先往馬達方向進行移動，碰到微動開關後再往磁
簧開關移動，磁簧開關感應到後移動平台便停止；
拉力計用來偵測輸入訊號，拉力計上面的壓力感測
器偵測到訊號後，送到控制核心經由 A/D(類比轉數
位)運算計算出力的值，用來計算使用者力的大小。
磁簧開關用來作為原點的偵測，移動平台的下方有
一個鐵片，只要經過磁簧開關就會送出訊號，系統
偵測到訊號則表示回歸原點。
 
TLP250
IR2101
TLP250
IR2101
I/O Port A/D SPI
 A (dsPic30F6015)
QEI PWM訊號
I/O Port SPI
 B (dsPic30F4011)
QEI PWM訊號
 
圖 8 控制架構圖 
 10
兩組滑軌所施力的總合。圖 14 則將將參數設置為
D1，重力型，且對兩組滑軌同時施力如圖 14(b)(d)
所示，剛開始施力時滑軌並沒有動作，當施力大
於約 78.4N 時才開始動作如圖 14(a)(c)所示，而兩
組滑軌運行軌跡與參考模式相同。 
 
       
(a) A 滑軌位移量            (b) A 滑軌施力圖 
         
(c) B 滑軌位移量           (d) B 滑軌施力圖 
圖 11 無重力之非連動模式-實驗參數 S1 之結果 
 
       
(a) A 滑軌位移量            (b) A 滑軌施力圖 
       
(c) B 滑軌位移量           (d) B 滑軌施力圖 
圖 12 具重力與非重力之非連動模式-實驗參數 S2 之結果 
 
        
(a) A 滑軌位移量            (b) A 滑軌施力圖 
        
(c) B 滑軌位移量           (d) B 滑軌施力圖 
圖 13 無重力之連動模式-實驗參數 D1 之結果 
 12
53, no. 2, pp. 569-580, April 2006. 
[11] T. J. Ren, and T. C. Chen, “Robust speed 
controlled induction motor drive based on 
recurrent neural network,” Electric Power 
System Research, vol. 76, no. 12, pp. 
1064-1074, Dec. 2006. 
[12] H. A. Zarchi, G.R. A. Markadeh, and J. Soltani, 
“Direct torque and flux regulation of 
synchronous reluctance moptor drivers based 
on input-output feedback linearization”, Energy 
Conversion and Management, vol. 51, no. 1, pp. 
71-80, January 2010. 
[13] F. J. Lin, and P. H. Shen, “Robust fuzzy neural 
network sliding-mode control for two-axis 
motion control system,” IEEE Trans. Industrial. 
Electronics, vol. 53, no. 4, pp. 1209-1225, 
August 2006. 
[14] F. J. Lin, P. H. Chou, and Y. S. Kung, “Robust 
fuzzy neural network controller with nonlinear 
disturbance observer for two-axis motion 
control system,” IET Control Theory and 
Applications, vol. 2, no. 2, pp. 151-167, 
February 2008. 
[15] T. J. Ren, T. C. Chen, and C. J. Chen, “Motion 
control of a two-wheeled vehicle using a 
self-tuning PID controller,” Control 
Engineering Practice, vol. 16, no. 3, pp. 
365-375, March 2008. 
[16] R. J. Wai, M. A. Kuo, and J. D. Lee, “Design 
of cascade adaptive fuzzy sliding-mode control 
for nonlinear two-axis inverted-pendulum 
servomechanism,” IEEE Trans Fuzzy Systems, 
vol. 16, no. 5, pp. 1232-1244, October 2008. 
[17] F. J. Lin, and P. H. Chou, “Adaptive control for 
two-axis motion control system using interval 
type-2 fuzzy neural network,” IEEE Trans. 
Industrial. Electronics, vol. 56, no.1, pp. 
178-193, January 2009. 
[18] O. Ustrun, “A nonlinear full model of switched 
reluctance motor with artificial neural 
network,” Energy Conversion and 
Management, vol. 50, no. 9, pp. 2413-2421, 
September 2009. 
[19] J. Yu, B. Chen, and H. Yu, “Position tracking 
control of induction motor via adaptive fuzzy 
backstepping,” Energy Conversion and 
Management, vol. 51, no.11, pp. 2345-2352, 
November 2010. 
[20] K. S. Sollmann, M. K. Jouaneh, and D. 
Lavender, ”Dynamic modeling of a two-axis, 
parallel, H-Frame-Type XY Positioning 
System,” IEEE/ASME Trans. Mechatronics, 
vol. 15, no. 2, pp. 280-290, April 2010. 
100年度專題研究計畫研究成果彙整表 
計畫主持人：任才俊 計畫編號：100-2221-E-168-011- 
計畫名稱：應用阻抗控制於虛擬連接之同動健身系統之設計 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 1 100%  
研究報告/技術報告 0 0 100%  
研討會論文 1 1 100% 
篇 2012UHC 第 六 屆
優質家庭生活科
技關鍵研討會 
論文著作 
專書 0 0 100%   
申請中件數 1 1 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 1 1 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
國科會補助專題研究計畫成果報告自評表 
請就研究內容與原計畫相符程度、達成預期目標情況、研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）、是否適
合在學術期刊發表或申請專利、主要發現或其他有關價值等，作一綜合評估。
1. 請就研究內容與原計畫相符程度、達成預期目標情況作一綜合評估 
■達成目標 
□未達成目標（請說明，以 100字為限） 
□實驗失敗 
□因故實驗中斷 
□其他原因 
說明： 
2. 研究成果在學術期刊發表或申請專利等情形： 
論文：□已發表 □未發表之文稿 ■撰寫中 □無 
專利：□已獲得 ■申請中 □無 
技轉：□已技轉 □洽談中 ■無 
其他：（以 100字為限） 
1.開發成果參與 2012年萬潤創新創意競賽，獲得佳作 (B38，
http://www.arccc.ksu.edu.tw/download.html) 
2.開發部分成果已發表於 2012UHC 第 6 屆優質家庭生活科技關鍵技術研討會中。 
3. 請依學術成就、技術創新、社會影響等方面，評估研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）（以
500字為限） 
本計畫之研究主題在於實現一個雙軸虛擬連接之健身系統，利用阻抗控制的原理，感應使
用者施力而產生相對應之抗力，並且利用同動的方式以達成和一般傳統上兩臂連動健身器
材相同之效果，但提出的系統具有阻抗調變的彈性和機構體積的減小與多樣性。 
本計畫採用兩組線性滑軌來實現所提出之的健身機構，其控制方法包含線性滑軌阻抗控制
中之強健式模糊類神經網路阻抗控制器設計與無連結機構之雙線性滑軌阻抗控制中之動
態模糊類神經網路控制器的設計，計畫中以 Lyapunov 理論分析模糊類神經網路的穩定
度，證明所提控制架構的穩定性，且求得更新法則（Update Law）以確保系統的穩定。在
學術上對於動態模糊類神經網路進行數學上的推導，以及控制技術上的精進應用有些微貢
獻。 
最後，本計畫以 Microchip 生產之 dsPic30F6015 及 dsPic30F4011數位信號處理器作為控
制模組，以其為核心，實現所設計之控制器、補償器。由實現數據可知，在不同阻抗參數
施用時，系統皆會所產生對應之阻抗值，系統也依據不同模式而有同動與非同動之多樣變
化展現，達成數位化具有彈性調整阻抗值功能之智慧型健身系統之目的。 
因此，本研究成果可製作一個體積與重量比一般機械式健身器材小，較不佔用空間、收納
方便、無需添加或購買鉛塊、阻尼、彈簧，只需調整軟體即可增加或減少訓練程度。滑軌
兩端配置微動開關，以達到保護使用者安全和避免機器損壞，並使用馬達搭配線性螺桿來
