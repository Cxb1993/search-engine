 2
份。子機主要功能是將員警週遭之聲音即時
傳回車機再輸出至警車上之影音介面進行錄
音，同時並可接收來自車機之即時語音。車
機主要功能是依照警用電腦之指令內容回覆
訊息或遙控子機，並於錄音狀態下與子機進
行雙向之即時語音傳輸。子機必須透過車機
之註冊基座向車機註冊後才能與該車機通
訊。以下將分別簡介系統功能以及車機和子
機的操作介面。 
2.1 功能簡介 
(1) 待機(Ready)狀態：此時子機每秒鐘只打
開接收機約 6 ms 以接收車機之指令，其餘時
間則關閉收發機以節約電能。 
(2) 錄音(On air)狀態：此時子機與車機進行
雙向即時語音傳輸，語音裝置並進行同步錄
音。一旦啟動錄音，子機無法自行取消錄音
功能，只能由車機遙控取消。 
(3) 靜音(Mute)狀態：在錄音狀態下，若搭
配靜音狀態，則子機不傳回語音，其餘功能
則與錄音狀態相同。此狀態並不能單獨存在。 
(4) 緊急(Panic)狀態：此狀態會自動搭配錄
音狀態並取消靜音狀態，除非特殊狀況下警
用電腦才會下令關閉緊急狀態，否則在正常
使用時只能由子機按鍵解除緊急狀態。 
(5) 隱藏(Cover on)狀態：此狀態下子機只有
震動器會動作，其餘所有 LED 燈號及蜂鳴器
均不作用。 
(6) 失聯(Over range)狀態：當子機或車機連
續 1 秒收不到對方的訊號時，即自行認定為
失聯狀態。 
(7) 電力不足(Battery low)狀態：此狀態下子
機會以 LED、蜂鳴器和震動發出警示，若同
時處於隱藏狀態則只以震動發出警示。 
(8) 休眠(Idle)狀態：由於子機並無電源開
關，也無退出註冊之機制，因此當子機連續
約 1 分鐘接收不到車機之訊息時即自動進入
閒置狀態，此時子機改為每 10 秒鐘才打開接
收機一次。閒置狀態下若收到車機之訊息，
子機會自動向車機提出回復註冊之請求，等
車機回復確認後即可回復待機狀態或依車機
指示進入新狀態。 
(9) 子機閒置或待機時，車機可接受新子機
之註冊而剔除原註冊子機。 
(10) 子機處於連線狀態(錄音、靜音、隱藏)
時，其對應之車機註冊座不接受新子機之註
冊。 
(11) 子機若被放入充電座，其連線狀態(錄
音、靜音、隱藏)會被強迫取消。 
(12) 子機若被放入註冊座，即進行重置及註
冊動作。 
2.2 車機之介面及顯示裝置 
車機包括與警用電腦通訊之 RS 485 介
面及顯示子機狀態之 LED，茲分述如下： 
(1) 充電/註冊基座：供子機充電或註冊用。 
(2) RS 485 介面：警車內之警用電腦可透過
此介面傳遞下述指令給車機，車機也透過此
介面回報訊息。 
(i) 狀態讀取指令(R 指令)：可指定讀取單
一子機之狀態或同時讀取兩部子機之
狀態，車機立即回應所指定子機之狀
態。 
(ii) 功能設定指令(S 指令)：可設定單一子
機操作緊急、靜音、隱藏、預留功能
1 以及預留功能 2 之權限，也可同時
設定兩部子機之操作權限。 
(iii) 遙控指令(C 指令)：可遙控單一子機
啟動或停止錄音、緊急、靜音、隱藏、
預留功能 1 以及預留功能 2，也可同
時遙控兩部子機。 
(iv) 型號讀取指令(P 指令)：可指定讀取
車機或單一子機之型號，車機則回應
其型號或註冊子機之型號。 
(v) 韌體版本讀取指令(V 指令)：可指定
讀取車機或單一子機之韌體版本號
碼，車機則回應其本身或註冊子機之
韌體版本號碼。 
(vi) 序號讀取指令(N 指令)：可指定讀取
車機或單一子機之硬體序號，車機則
回應其本身或註冊子機之硬體序號。 
(3) 顯示面板：共有 3 對 LED，分別顯示下
列之子機狀態。 
(i) 第一對(綠色，LED0、LED1)：常亮時
代表對應之子機處於錄音狀態；每秒
閃兩次代表對應之子機處於靜音狀
態。 
(ii) 第二對(紅色，LED2、LED3)：常亮
 4
語音輸入
語音輸出#1
ADPCM#1
語音輸出#2 ADPCM#2
μC車上 I/O裝置
CC2430
警用
電腦
註冊介面
(SPI) (GPIO)
(UART)
RF
 
圖 1. 車機系統規劃 
 
3.2 子機系統規劃 
子機系統規劃如圖 2.所示，整個系統仍
由 CC2430 內建之 8051 主控，並搭配另一顆
簡易μC 以擴充 IO 數量。語音之取樣與復原
使用 ADPCM 晶片，RF 部分負責 2.4 GHz 與
900 MHz 之轉頻與功率放大；註冊介面則為
一對接點。CC2430 與μC、ADPCM 間以共用
的 SPI 傳遞訊息，註冊介面則使用 UART，
其它各控制訊號則使用 GPIO。各裝置之詳細
介面規劃分述如下。 
語音輸入
語音輸出 ADPCM
μC I/O裝置
CC2430
註冊介面
(SPI) (GPIO)
(UART)
RF
 
圖 2. 子機系統規劃 
3.3 註冊介面規劃 
當子機放入車機之註冊座#1 或#2 時，
車機之感應輸入(CC2430之P2.3或P2.4)會由
Low 變 High，此時車機會由其 UART1 之 Tx
端(P0.4)依序送出連線指示資訊約 0.32 秒，
由於此時雙方並未同步，因此連線指示資訊
必須設計為非同步傳輸格式，其內容如圖 3.
所示，各欄位說明如下： 
標頭 頻道 註冊號碼
0xFE Channel
網路號碼
PANIdH
(1 byte) (1 byte) (2 bytes)
PANIdL
(1 byte)
檢查碼
RegNo
(1byte)
CheckSum  
圖 3. 註冊指示資訊格式 
(1) 標頭：由於連線指示資訊必須循環送
出，因此必須選定一組特殊代碼以標示其開
頭，此處規劃為 0xFE，其他欄位必須避免使
用到 0xFE。 
(2) 頻道：用來指示子機使用哪一無線頻道。 
(3) 網路號碼：此處沿用 IEEE 802.15.4 之名
稱 PANId，毎一部車機開機時會選定一組 16
位元之 PANId 做為其辨識號碼。 
(4) 註冊號碼：以 0x01 或 0x02 做為子機之
註冊編號。 
(5) 檢查碼：由於 UART 介面同時也是與
RS485 的通訊介面，為避免可能出現的錯
誤，特別在最後加上一個 byte 的加總檢查
碼，以利子機檢查是否資訊有誤。 
另一方面，當子機放入車機之註冊座
時，其感應輸入(CC2430 之 P2.3)會由 Low 變
High，此時子機會啟動其 UART 接收功能，
一旦接收到一段完整的註冊指示資訊，即開
始設定其 PANId 和註冊編號，並將頻率調至
Channel 所指示的頻道。接著便以無線方式送
出請求加入(NEWJOIN_REQUEST)的封包，
封包內包含了子機之型號、序號、版本。接
著子機便打開其接收機等著接收車機傳回之
確認(JOIN_RESPONSE)封包，若順利收到確
認封包即進入”Ready”狀態，並發出兩次短音
及振動提醒使用者註冊程序完成。註冊過程
中若有任一環節出錯，子機即回歸”Reset”狀
態，使用者若等待超過 1 秒仍無註冊完成之
聲響及振動，必須拿起子機再重新註冊。 
3.4 語音傳輸規劃 
本期計畫所重新規劃的語音傳輸時槽
如圖 4.所示，車機毎 5.76 ms 送出下傳封包，
此定時傳送的封包雖然是以 IEEE 802.14.5的
Data 格式封裝，不過在本系統中，其功能類
似於 Beacon 封包，可供連線子機校正其同步
時間。此外，該封包尚可用來傳遞管控指令、
回應指令以及語音資料。也就是說，我們把
Beacon、Command、Acknowledgement、Data
全部整合在同一封包中。 
整個系統三部裝置依照車機、#1 子機、
#2 子機的順序依序送出封包，各裝置封包傳
送時槽之間隔為 1.92 ms。由於車機相對於子
