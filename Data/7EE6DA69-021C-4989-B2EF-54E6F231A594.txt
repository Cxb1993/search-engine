2行政院國家科學委員會專題研究計畫成果報告
多機密圖像分享與視覺式秘密分享：高效能分存設計與性質探討
計畫編號：NSC 97-2221-E-155-025
執行期限：97年 08月 01日至 98年 10月 31日
主 持 人：王任瓚 元智大學 資訊工程學系
計畫參與人員：陳耶舜 元智大學 資訊工程學系
計畫參與人員：林永益 元智大學 資訊工程學系
計畫參與人員：藍永青 元智大學 資訊工程學系
計畫參與人員：郭建甫 元智大學 資訊工程學系
一、中文摘要
本計畫針對多層次圖像分享與視覺式秘
密分享技術分享所產生的分存圖像做設計
與探討，強化與探討多機密圖像分享與視覺
式秘密分享技術所建立的分存之各種特
性，建立更安全與實用的圖像分享與保護機
制。在這個計畫中，我們針對兩種圖像分享
技術：(a)視覺式秘密分享，與(b)基於多項
式的圖像分享，分別成功設計出高效能分存
圖像的增值式圖像分享方法。在視覺式秘密
分享方面，我們利用隨機影格 (Random
Grids)的概念，設計出一個像素不擴張的增
值式視覺式秘密分享技術。在基於多項式的
圖像分享方面，我們利用區塊餘弦轉換，設
計出小分存的多機密圖像分享方法。由實驗
結果顯示，我們所設計的方法讓增值式圖像
分享所產生的分存圖像更有效率，這這些方
法實用性更高。
關鍵詞：圖像分享、分存圖像、秘密分享、
視覺式秘密分享
Abstract
This project designed efficient shadow
images for both the visual secret sharing
technique and polynomial-based secret image
sharing method. The developed techniques
enforce the practicability of secret image
sharing schemes. In the aspect of designing
visual secret sharing scheme, we applied the
concept of random grids to build an
incrementing visual secret sharing without
pixel expansion. In the aspect of designing
polynomial-based image sharing method, a
discrete cosine transform based method is
designed to generate the shadow images with
smaller sizes. The experimental results show
the designed schemes are efficient in the sizes
of the created shadow images. It leads the
further processing of the shadow images such
as transmission or storage in a more efficient
way.
keywords: image sharing, shadow images,
secret sharing, visual secret sharing.
二、緣由與目的
視覺式秘密分享是由Naor與 Shamir[1]
於 1994 年所提出，其最主要的特色為解碼
是由人眼來辨識分存疊合圖上所顯現的訊
息，不需要經過電腦計算解密。在 Naor 和
Shamir提出了視覺式秘密分享技術後，相關
的研究也隨者展開。如討論一般化的存取架
構[2,3]；研究像素擴展與疊合圖像明亮對比
(contrast)間的最佳化方法[4-7]；與設計灰階
與彩色視覺秘密分享方法[8-11]。在多機密
的視覺式秘密分享技術，Wu 與 Chen[12]
率先提出一個利用正方圖像基於旋轉解出
兩個機密的視覺式秘密分享技術。Wu 與
Chang[13]則利用圓盤式的分存圖像，藉由
巧妙的安排達到在同一張分存圖像上分享
兩個秘密資訊的機制。Shyu等[14]又擴充設
計出圓盤式多機密的分享機制。我們在上一
年的計畫設計出一個基於區域的增值式覺
式秘密分享技術[15]，讓圖像中的機密可以
4級。在 2層的方法中，我們將提出三種建構
方法。在每一種方法中都將會產生 3張隨機
影格似的分存圖像 S1、S2及 S3。
表二 2層方法機密層級間透光率關係
機密層級
疊合的
分存量
背景 第 1層 第 2層
1 10c 11c 12c
2 20c 21c 22c
3 30c
3
1c
3
2c
建構方法 I
S1 中的每個像素點的產生都是隨機
的，隨機選擇 0 或 1 的像素值並放入每個
點，選擇 0 或 1 機率是完全相同的。在 S2
中，只有第 1層機密的像素點是從 S1中的相
同位置的像素點複製過來，背景與第 2層機
密的像素點都是隨機選擇 0或 1的像素值並
放入其中的每個點。最後，在 S3中，背景的
像素點其值為隨機選擇 0或 1並放入其中；
當一像素點為第 1層機密時，則從 S1的相同
位置複製像素點並放入 S3的相同位置；而當
一點像素點為第 2層機密時，其值的內容為
S1 相同位置的像素值與 S2 相同位置像素值
做互斥或之後取補數的值。
此方法的透光率分別敘述如下：當只有
1 張分存圖像時，每一層級的透光率都同為
1/2，而疊合的分存圖像數量來到 2張時，除
了第 1層的機密為 1/2的透光率，第 2層與
背景的透光率都為 1/4，使得我們無法從中
區分第 2層機密的所在位置。當疊合全部 3
張分存圖像時，個別的透光率分別為背景是
1/8，第 1層機密是 1/2，第 2層機密是 0也
就是全黑的。
建構方法 II
在此方法中，S1的產生也如同隨機影格
一般，每一層級的秘密包括背景的像素點的
產生都是隨機選取 0 或 1 的像素值。在 S2
中的像素點，當此點為背景或第 2層的機密
時，隨機選取 0或 1的像素值放入其中，當
此點為第 1層的機密時，直接複製 S1中相同
位置像素點的像素值。最後，在 S3的像素點
中，若此點為背景時，隨機選取 0或 1的像
素值放入其中；若是第 1層的機密，則從 S1
的相同位置中，複製其像素值放入此點；若
是第 2 層的機密，則從 S1與 S2相同的位置
分別取出像素值，並且做互斥或之後所得到
的像素值放入此點。
利用建構方法 II所得到的透光率的關係
敘述如下：當只有一張分存圖像時，不管是
何種秘密層級的透光率都是 1/2；當疊合的
分存圖像數量來到 2張時，第 1層的機密將
被還原，並且其透光率為 1/2，第 2 層的機
密因為分存數量不夠所以其透光率將與背
景相同，同為 1/4；最後，當將所有的分存
圖像疊合時，第 1 層機密的透光率為 1/2，
第 2 層機密的透光率為 1/4，背景的透光率
為 1/8，因此我們能夠很清楚的分辨背景與
各秘密層級間的機密資訊。
建構方法 III
與前兩個方法相同，S1的產生有如隨機
影格一般，S1中的每一個像素點的產生都是
隨機選擇 0或 1的像素值。當一個像素點在
S2中是屬於第 1層的機密時，直接從 S1的相
同位置複製其像素值，並放入此點。而當一
個像素點屬於背景或第 2層的機密時，則隨
機選擇 0或 1的像素值。最後，在 S3中，當
一點像素點為背景時，則從 S1與 S2的相同
位置分別取出像素點並做互斥或，做完互斥
或的值再取補數並且放入 S3 相同的位置
中。當一點為第 1層的機密時，則從 S1中相
同的位置複製像素值並放入此點。當一點的
秘密層級為第 2 層的時候，從 S1與 S2相同
位置分別取出像素值並且做互斥或，做完互
斥或之後的值直接放入此點中。
此方法的透光率分別敘述如下：當只有
一張分存圖像時，因為分存圖像的產生與隨
機影格相同，所以不論是背景、第 1層機密
或第 2 層機密的透光率都是 1/2，因此每一
張分存圖像的外觀有如雜訊般沒有任何圖
樣顯示在其中；當疊合的分存數量有兩張
時，第 1層的機密將被顯示出來，此時第 1
層機密的透光率為 1/2，背景與第 2 層機密
的透光率為 1/4；當疊合全部的分存圖像時，
背景的透光率為 0，也就是背景是全黑的，
第 1 層機密的透光率為 1/2，而第 2 層機密
的透光率為 1/4，因此能夠很容易的辨別機
密區域位於第 1層或是第 2層。
圖一為所設計區域式 2層視覺式秘密分
享範例。其中(a)為原機密圖像，(b)為機密分
層結果，三種建構方法所產生的三份分存圖
像分別列於圖(c)-(e)、(j)-(l)、(q)-(s)中，我們
6數分存解密出。
步驟 2. 設定現階段的處理層級為 1。
步驟 3. 從 n+1 張 分 存 圖 像 Shadow1,
Shadow2,…, Shadown+1 任取出+1
張分存圖像，用 (+1, n+1)圖像分
享機制的解密處理將 K 解密。
步驟 4. 使用 K 和 Thien-Lin (+1, n+1)圖
像分享機制的解密處理將第層分
存圖像 l 1
l
3
l
2
l
1 LS,,LS,LS,LS n 解密
出。其中第層分存圖像的大小可
以從圖像區域層級記錄求出。
步驟 5. 第層分存圖像的像素每 w個為一
組，其為每一個區塊 zigzag順序之
前 w個 DCT係數，使用 IDCT將這
些 88 的區塊還原出。並依據圖像
區域層級記錄的記載將這些像素放
回 S中圖像區域屬於層的區域。
步驟 6. 設定到下一個層級，即 1 。
步驟 7. 重複步驟 3 到 6，直到 S 中所有的
像素都已解密，即可得到解密出的
圖像。
此實驗中，GF( 82 )運算中所採用的質數
多項式為 1xxxx 2358  。圖 2 和圖 3
分別呈現所提出增值式 2 層圖像分享範
例，圖 4和圖 5分別呈現所提出增值式 3層
圖像分享範例。圖 2(a)為 8位元灰階的原始
圖像“Lena”，圖像大小是 512512 。將圖
2(a)劃分成二個層級區域的結果呈現在圖
2(b)中。第二層區域包括整個臉的部份，第
一層區域則是剩下所構成的區域。圖 2(c)
為每一個區塊取前 28個DCT係數去執行分
享處理(參數 w 設為 28)所得到的分存圖
像，每一個分存圖像大小為 58,184 byte，約
為原圖的 20.2%。圖 2(d)顯示從這 3張分存
圖像任取 2張所重建的圖像，只有第 1層的
圖像區域被解密出。圖 2(e)是用全部 3張分
存圖像解密結果，整張原始圖像都解密出
了。圖 2(g)和圖 2(e)的 PSNR 為 37.38dB，
呈現出所還原圖像的高品質。
圖 3(a)為另一個 2層的分享範例。圖 3(c)
為每一個區塊取前 10個DCT係數去執行分
享處理(參數 w 設為 10)所得到的分存圖
像，每一個分存圖像大小為 19,008 byte，約
為原圖的 7.2%。圖 3(d)顯示從這 3 張分存
圖像任取 2張所重建的圖像，只有第 1層的
圖像區域被解密出。圖 3(e)是用全部 3張分
存圖像解密結果，整張原始圖像都解密出
了。圖 3(e)和圖 3(a)的 PSNR 為 32.56dB，
呈現出所還原圖像的高品質。
圖 4(a)為 8位元灰階的原始圖像“Jet”，
圖像大小是 512512 。將圖 4(a)劃分成三個
層級區域的結果呈現在圖 4(b)中。第一層區
域則是圖中雪和山脈所構成的區域，第二層
區域包括整個飛機部份，第三層區域則是圖
中二個文字方塊。圖 4(c)參數 w設為 28所
得到的分存圖像，每一個分存圖像大小為
50,473 byte，約為原圖的 19.2%。圖 4(d)顯
示從這 4 張分存圖像任取 2 張所重建的圖
像，同樣只有第 1層的圖像區域被解密出。
圖 4(e) 顯示從這 4 張分存圖像任取 3 張所
重建的圖像，一樣看到第 1 和第 2 兩層的
圖像區域。圖 4(f)是用全部 4張分存圖像解
密結果，整張原始圖像都解密出了。而圖
4(f)和圖 4(a)的 PSNR為 37.93 dB，呈現出
所還原圖像的高品質。
圖 5(a)為另一個 3層的分享範例。圖 5(c)
參數 w 設為 10 所得到的分存圖像，每一個
分存圖像大小為 18,053 byte，約為原圖的
6.8%。圖 5(d)顯示從這 4張分存圖像任取 2
張所重建的圖像，同樣只有第 1層的圖像區
域被解密出。圖 5(e)顯示從這 4張分存圖像
任取 3張所重建的圖像，一樣看到第 1和第
2 兩層的圖像區域。圖 5(f)是用全部 4 張分
存圖像解密結果，整張原始圖像都解密出
了。而圖 5(f)和圖 5(a)的 PSNR為 31.014 dB，
顯示還原圖像的品質還可以接受。
四、計畫成果自評
本計畫設計出的兩個小分存之圖像分
享方法，針對我們之前所發展的區域式增值
式視覺秘密分享與多層次機密圖像分享技
術做改良。我們成功的設計出像素不擴張的
區域式增值式視覺秘密分享技術，並已經投
8(a) (b) (c) (d) (e)
(f) (g) (h) (i) (j)
(k) (l) (m) (n) (o)
(p) (q) (r) (s) (t)
(u) (v) (w)
圖 1 區域式 2層視覺式秘密分享範例。(a)為原機密圖像，(b)為機密分層結果，(c)-(e)、(j)-(l)、
(q)-(s)為所設計三種方法個別產生的三份分存圖像，(f)-(h)、(m)-(o)、(t)-(v)分別為三種方法
兩份分存(1,2)(1,3)(2,3)疊合的結果，(i)、(p)、(w)分別為三種方法三份分存疊合的結果。
10
(a) (b) (c) (d) (e)
(f)
圖 5 小分存多層次機密圖像分享 3 層圖像分享的實驗範例(每個區塊取 10 個 DCT 係數分
享)。(a)原圖像。(b)圖像分層結果。(c)產生之分存圖像。(d)任取 2張分存圖像解密結果。(e)
任取 3張分存圖像解密結果。(f)4張分存圖像解密結果。(a)和(f)兩張圖像的 PSNR為 31.01
dB。
