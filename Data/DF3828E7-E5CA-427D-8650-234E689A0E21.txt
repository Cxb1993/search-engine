ii 
 
中文摘要 
 
本計畫著力於整合行動與無線網路、電腦網路與數位家庭網路間多媒體內容傳輸與管理服務，提
出「結合同儕網路協定與家庭網路協定的多媒體閘道器平台」、「行動與無線家庭網路下無縫式多媒體
串流服務」與「大型同儕網路系統中分散式同儕管理與配對機制」。 
同儕網路（Peer-to-Peer; P2P）為現今網際網路中主流的多媒體內容傳輸技術，同儕網路透過系統
內數以萬計的同儕節點協同儲存與傳播極大量的多媒體內容；然而，大多數同儕網路的服務對象僅侷
限於傳統電腦終端使用者，當使用者在家庭內以其他家庭網路裝置（譬如網路電視、遊戲終端機、平
板電腦或行動終端裝置）連結上網時，受限於家庭網路的封閉性與裝置的客製差異，無法接取外部的
同儕網路。因此，我們的研究提出具相容性的多媒體閘道器平台，在開放性的 OSGi 閘道器平台上結
合最普及的同儕網路協定（BitTorrent P2P）以及國際產業標準化的家庭網路協定（Universal Play and Play; 
UPnP），透過該一閘道器支援 P2P 和 UPnP 協定轉譯、格式轉換與內容發佈等功能設計，使得家庭網
路裝置可直接要求下載和播放同儕網路上的多媒體內容，增進家庭多媒體娛樂的使用情境。 
新型態行動終端設備支援 IP 通訊、網路、儲存與多媒體處理能力，使用者能透過行動手持設備無
所不在、隨時隨地連結其他行動使用者和相鄰的網路裝置。因此，我們的研究基於新型態網路應用之
發展，研發行動與無線家庭網路下無縫式多媒體串流服務，此一應用層服務不受限於下層網路通訊模
組和作業系統，完全執行於 TCP/IP 網路之上，透過 TCP 協定操作、快速 TCP 連線、Network I/O 資料
緩衝區的導向傳輸、以及串流播放引擎的控制等功能付以實現無縫式多媒體串流服務，該服務軟件可
直接應用於現有消費性行動通訊裝置中，支援各類新穎服務發展之所需。 
再者，基於對 BitTorrent-like 同儕網路系統架構的分析，我們進一步探討以 Tracker 為中心的同儕
管理與配對方式對於多媒體檔案傳輸效能的影響，提出大型同儕網路系統中分散式同儕管理與配對機
制，此機制之設計考量同儕傳輸能力的差異、存在性的變異（Peer Churn）和不互惠的行為（Free 
Riding），利用頻寬能力的差異與資料上傳貢獻的聲譽兩參考指標，設計兩套相輔的演算方法支援同儕
配對的選擇、替換與最佳化，以能合理地分配同儕節點的上傳與下載的傳輸資源，達到更快速的檔案
傳輸，同時維持系統服務的公平性。 
本計畫成果，完成以上三套機制，以整合行動、無線和有線寬頻網路的新型態網路為計畫內容的
應用環境，研發結合同儕網路系統與技術的多媒體內容傳輸與管理服務（整合式多媒體閘道器、無縫
性多媒體串流、同儕管理以及配對選擇等），並具體完成相關軟件和系統雛形。我們認為在開放式的 IP
通訊環境中，以內容為主、技術應用為導向的應用研究，將逐漸成為整合性網路多媒體服務的主流發
展。 
 
關鍵字：多媒體閘道器、多媒體內容傳輸、行動應用程式、同儕管理、同儕網路、行動同儕網路 
iv 
 
proposed scheme can not only achieve appropriate bandwidth utilization to expedite the file delivery but also 
sustain service fairness against dynamic traffic workloads. 
Therefore, the efforts of this research project achieve three deliverables for P2P content distribution in 
new, emerging network environments, including a P2P-to-UPnP proxy gateway (with a prototype 
implementation), seamless media streaming service (with a prototype implementation), and a distributed peer 
paring scheme (with performance reports), in integrated network environments. It is noteworthy that the 
content-oriented software and technology would be the mainstream of developing new multimedia services in 
open IP communication environments. 
Keywords: Media gateway, multimedia distribution, mobile application, peer management, peer-to-peer 
network, mobile peer-to-peer network 
2 
 
downloading manager, and UPnP AV media server on the OSGi framework. Figure A.1(Right) depicts these 
components and associated services, and their functional procedures. 
BitTorrent peer supports downloading P2P media content from the Internet. This component consists of 
the basic P2P file sharing service, media playback service (MPS), and UP2P-to-UPnP content directory service 
(xCDS). The UP2P gateway runs this peer to join the BitTorrent overlay, resolves torrents, and downloads 
media files. MPS allows non-UPnP HNDs to browse and play downloaded media content. The xCDS catalogs 
those downloaded files into a shared UPnP AV content directory that the UPnP AV media server can access.  
UPnP downloading manager provides two UPnP-specific services, torrent directory service (TDS) and 
media download service (MDS), which UPnP devices use to access P2P content. Firstly, TDS maintains a 
torrent directory that contains torrent metadata records (names, lengths, piece size used, piece-based hashing 
codes, and a tracker’s URL.), and performs torrent addition, removal, and enumeration requested by UPnP 
devices. With TDS, UPnP devices can share torrents with others in a home network. Secondly, MDS manages 
P2P downloading processes on behalf of UPnP devices because a BitTorrent peer is not UPnP-customized. 
MDS interacts with the BitTorrent peer via internal APIs to handle concurrent connection establishments, 
segment assembly, downloading progress report, publish/subscribe event notification, etc.  
UPnP AV media server runs on the UP2P gateway to provide plentiful downloaded media files into the 
home network domain. This server functions CDS, CMS and AVT according to UPnP AV specifications [1]. 
When the downloading manager completely downloads any files, MDS can invoke xCDS to update the 
CDS-specific DIDL-Lite document. UPnP devices can find new media files by CDS, negotiate with the UPnP 
AV media server by CMS, and transfer media streams for playback by AVT. 
A.4  Prototype and Demonstration 
The prototypical UP2P gateway software integrates a BitTorrent peer, UPnP downloading manager, and 
UPnP AV media server bundles on the Knopflerfish v.2.3.3 OSGi framework [6], and develops TDS, MDS, 
MPS, xCDS, basic UPnP, and UPnP AV services in light of UPnP conventions.  
Figure A.2 demonstrates the proposed scenario: the UP2P gateway shares P2P media content with HNDs in a 
home network. Figure A.3(a) shows a UPnP CP that operates TDS, selects torrents, and requests MDS to 
download desired media files. Figure A.3(c) shows the downloading manager that handles all downloading 
tasks in active, complete, or idle state. Figure A.3(b) depicts a UPnP device that subscribes to MDS for 
receiving notifications of downloading progress. When any file is downloaded completely xCDS updates the 
UPnP AV content directory. Then, MDS notifies each subscriber to start playing the media file. Figure A.4 
depicts three TCP connections that concurrently download separate segments of the same file from the 
UPnP
P2P
UPnP/DLNA Context
P2P
UPnP
P2P Context
Home NetworkInternet
Gateway
     
U
P2
P 
Bu
nd
le
s
UP2P Torrent Directory Service
UP2P Media Playback Service
UP2P Media Download Service
UP2P-to-UPnP Content Directory Service
UPnP Device Architecture
UPnP AV (CDS, CMS, AVT)
O
S
G
i S
er
vi
ce
 F
ra
m
ew
or
k
UPnP AV Media 
Server
BitTorrent Peer
UPnP Downloading 
Manager
Basic P2P Service
Figure A.1. The UPnP-to-P2P (UP2P) Gateway Design, and UP2P-specific components and services. 
4 
 
content. Therefore, it seems natural and inevitable that people will exchange, share, and publish media content 
among various networked devices in social communities [1]. 
Modern home-networked devices (HNDs), including PC, CE and mobile devices, have upgraded 
computation, networking, and storage capabilities. Figure B.1 depicts the home living context where HNDs 
interconnect in wired/wireless networks such as Ethernet and Wi-Fi. HNDs can not only play but also share 
media content stored in the local storages with others in a networked manner for home AV entertainment. 
Users with mobile devices can move about at home. During media streaming/transferring, the movement 
of either a media player/receiver or server/sender may break any ongoing transfer connections due to terminal 
mobility, and then induce playback discontinuity or termination. To remedy these issues, previous research 
focused on how to perform fast connection switch, recovery, handoff, and mobile IP mechanisms in terms of the 
network system design. This sort of approach requires the complicated designs of underlying network hardware, 
software, and communication protocols. Unfortunately, it is difficult to be integrated into CE and mobile 
devices, and not appropriate for home networking technologies. 
This study proposes a seamless media streaming and playing mechanism based on standard TCP/IP 
protocols and socket APIs. This design is application-level and platform-independent. Target HNDs can employ 
this mechanism without customizing system kernel and networking modules. Prototype implementation 
achieves two proof-of-concept versions for JVM and OSGi runtime contexts [1]. Demonstration presents the 
desirable media streaming and playback services in a ubiquitous home network environment. 
B.2  Mechanism Design and Development 
The proposed mechanism includes three software facilities, network transport, media streaming, and media 
playing modules, which support many featured functions below. Figure B.2 depicts these building blocks and 
their interactive flowcharts.  
• Dynamic naming and endpoint identity mapping  
• Automatic re-connection and network I/O switching 
• P2P-like media streaming in a home network 
• Asynchronous and concurrent data delivery 
• Media segment access, control, and management  
• Triple buffers for media segment aggregation 
• Standalone playback state machine 
• Home-based shared media directory 
B.2.1  Network Transport Facility 
The network transport facility provides a robust media transport mechanism which can rapidly and 
automatically resolve the TCP connection break and partial closing problems due to the sender- or 
  
                                              OSGi Framework / Java Virtual MachineJNA
Media Playing Module Media Streaming Module Network Transport Module
Playback 
State 
Machine
GUI
Operation
Media Directory
Segment BufferPlaying BufferCodec
Control
Data Buffer
Connection Manager
Transport
I/O Switch
Network Location Manager
Callback Functions
Operating System & Hardware Platforms
Figure B.1. A ubiquitous home network environment.          Figure B.2. The functional blocks. 
6 
 
working port
listening port
5 4 3 2 1
file
Sender
file
Receiver
5 4 3 2 1
file
a+1
a
new listening port
a+2
a+1
working port
listening port
b+1
b
aworking port
(a) 
Sender-initiated case
5 4 3 2 1
Sender
working port
listening port
5 4 3 2 1
file
Sender
file
move
Receiver
5 4 3 2 1
file
b+1
b
listening port
a+1
new listening port
b+1
b
a
working port
(b) 
Receiver-initiated case
5 4 3 2 1
Receiver
b+2
working port
x
push
x
pull
IP 1
IP 2
IP 1
IP 2
move
Figure. B.3. Sender- and receiver-initiated movements.
Home Network
data buffer
A 2C 4 51 3
media 
content 
directory
2 4 51 3. . .2 4 51 3
4 3 2 15
4 3 2 15
playing buffer
C C
peer
D
C
segment buffer
B
2 1C
peer peer
P2P media sharing 
media playing facility
Figure B.4. The seamless media streaming scheme. 
Sender IP: 10.1.0.4        10.1.0.5 Reciever IP: 10.1.0.9        10.1.0.8 TCP I/O graph
Figure B.5. Trace log at the receiver side. 
sender’s and receiver’s IP/working-port are bound 
with 10.1.0.4/23456 and 10.1.0.9/38223. When the 
sender changes to 10.1.0.5/58814, it promptly 
re-connects to the receiver’s listening port 
10.1.0.9/38224(=38223+1). Later, the receiver 
changes to 10.1.0.8/59606 and connects to the sender 
via 10.1.0.5/58815(=58814+1). As the I/O graph 
shows, the procedures of re-connection and 
resumption of media data transport are very quick. 
B.4  Summary 
This study has developed a seamless media 
streaming and playing mechanism in a ubiquitous 
home network. Prototype demonstration shows that 
the proposed mechanism can protect media data 
delivery and playback continuity against HNDs’ 
movement in home networks. This solution is simple 
and functional without modifications of underlying 
OS, network kernels, and TCP/IP protocols. 
B.5  Reference 
[7] R. S. Hall and H. Cervantes, “Challenges in 
building service-oriented applications for OSGi,” 
IEEE Communications Magazine, vol. 42, no. 5, 
pp. 144-149, May 2004. 
[8] E. K. Lua, J. Crowcroft, M. Pias, R. Sharma, and 
S. Lim, “A survey and comparison of peer-to-peer 
overlay network schemes,” IEEE Communications Surveys and Tutorials, vol. 7, no. 2, pp. 72–93, 2005. 
[9] W. K. Edwards, “Discovery systems in ubiquitous computing,” IEEE Pervasive Computing, vol. 5, no 2, pp. 
70–77, 2006. 
[10] Knopflerish OSGi SDK, available via http://www.knopflerish.org/. 
[11] VideoLan open source, available via http://www.videolan.org/. 
 
Part C 
C.1  Introduction 
Peer-to-peer systems encounter critical issues, such as peer churn, free riding, and varied workload, which 
significantly affect performance results such as resource utilization, service agility, and fairness. This study 
proposes a distributed pairing strategy for fast and fair file sharing in large-scale P2P networks. This design 
exploits peer duality, in that each peer plays a dual role of both service provider (server) and a consumer (client) 
8 
 
contributions of upload bandwidth voluntarily provided by the peer. The measure of peer contribution is given 
by a linear formula of a peer's previous contribution: 
Ci = ULpast(i)×α + ULnow(i)×(1-α),                           (1) 
where ULnow is the number of segments which a peer is uploading now, ULpast is the number of segments that a 
peer has uploaded in the past, and 0≤α≤1 is a tunable parameter of relative weighting between the terms ULpast 
or ULnow that can be emphasized as desired. Thus, the central server takes Ci to prioritize download requests 
from client peers. On the other hand, in allocating upload bandwidth, a central server decides which server peer 
should serve client peer's requests by grading the upload bandwidth capacity that a server peer can provide to 
its client peers, given by 
Gi = μi/(ULnow(i)+1),    and Gi≥μ.                          (2) 
C.3  Distributed Pairing Scheme 
The proposed distributed peer pairing scheme augments the centralized peer assignment strategies in our 
companioned study [3], which are particularly basic peer selection scheme (BPSS) and advanced peer selection 
strategies with peer substitution and elimination (APSS and APSS-E). Particularly, BPSS chooses server peers 
to process download requests in descending order of peer contribution in light of indirect-reciprocity notion. 
APSS extends BPSS with a substitute policy to cope with peer churn and varying request workload. In addition, 
APAS-E associates APSS with a peer elimination process to cope with possible service starvation and further 
boost the ability of service differentiation and fairness. 
The distributed pairing scheme is applied into both local and external P2P domains, simultaneously, to deal 
with service fairness, throughput, and starvation in a distributed manner. The proposed scheme generates a set 
of candidate server peers from a tracker group instead of a singular tracker, as compared in BPSS and APSS. 
Therefore, the proposed distributed pairing scheme extends BPSS, APSS, and APSS-E with elegant 
modification for fast, fair and non-blocking file sharing in distributed P2P environments. This scheme performs 
two-phase procedures in local and global P2P domains.  
C.3.1 Local Domain 
Each tracker Ti in its local domain Di takes the request workload in descending order of peer grading Gi, 
and schedules requests in descending order of peer contribution Ci. Given a peer pi whose download bandwidth 
is higher than μ, it can send Ti a request rki to download a segment Sk. With a rki, Ti generates a peer set, called 
H(Sk) including all peers having Ski in their local storages. Then, Ti selects the server peer pr with the highest 
upload rate in H(Sk). If pr's Gr is not lower than μ, Ti notifies pi of its server peer pr in charge. Then, pi 
negotiates with pr for downloading Sk. If pr has no enough upload bandwidth to serve rki at this moment, Ti will 
mark pi's download state as sleep and push this request back into the request queue. The server later checks if rki 
is valid yet. In this way, Ti can simply and evenly balance the use of bandwidth capacities among peers in Di. 
C.3.2 Global Domain 
However, the basic scheme can encounter upload or download blocking due to service starvation, resulting 
in poor performance. This situation does not mean that a requested segment does not exist in the system. A 
heavy request workload for scarce segments, peer churn, and skewed access patterns can all induce this 
problem. To address this problem of service starvation, the proposed distributed pairing scheme enforces the 
peer substitute and elimination policies. This scheme attempts to find an optimal substitute peer ps∗ in the 
distributed system to replace a busy peer pr in H(Sk) and take over its ongoing uploading tasks. The replaced 
peer pr can then reclaim more upload bandwidth and accept another request for some segment now held by pr. 
10 
 
tracker-oriented method induces a linear growth in message overhead as the tracker group size increases, as 
Figure C.2(a) shows. In contrast, the message overhead by the peer-oriented method remains nearly constant 
regardless of the tracker group size. Second, computing a pre-determined subset of potential trackers using the 
peer-oriented method is cost-effective, since it efficiently reduces the overall message overhead. Additional 
results in Figure C.2(c) support this observation that the tracker-oriented method sends more outward messages 
to external trackers than the peer-oriented method. Third, bandwidth granularity affects the measure of message 
overhead. Peer-oriented and tracker-oriented methods produce lower message overheads under higher 
granularity as depicted in Figure C.2(a). Fourth, the tracker-oriented method is sensitive to the variance of 
number of segments that every peer begins with. The hosting tracker handles almost every request in its local 
domain. Adding more initialized segments effectively increases the probability of finding a server peer within 
the domain. Finally, the tracker- or peer-oriented method can find the same optimal substitute server peer ps∗ in 
a large-scale distributed P2P network, though they generate different message overheads. Both the peer- and 
tracker-oriented methods can augment service fairness by peer substitute and elimination. Figure C.2(d) depicts 
the measures of blocking rates among peer clusters. The blocking rate is very low when no server peers are 
available as a result of temporary unavailability due to unsuccessful peer elimination. 
C.5  Summary 
This study presents a distributed pairing scheme to addresses the peer churn and free riding problems 
appearing in large-scale distributed P2P networks. Performance results show that two variants of peer-oriented 
and tracker-oriented pairing methods maintain the effects of specific peer substitute and elimination policies. 
However, the peer-oriented method outperforms the tracker-oriented method in terms of message overhead, but 
may induce higher computation costs. Two methods are thus alternatives with different communication and 
computation concerns. With extensive simulations, the proposed distributed pairing scheme is able to ensure 
fast and fair file sharing applications in large-scale P2P networks. 
C.6  References 
[1] Z. Ge, D. Figueiredo, S. Jaiswal, J. Kurose, and D. Towsley, “Modeling peer-peer file sharing systems,”  in 
Proceedings of IEEE INFOCOM’03, vol. 3, pp. 2188–2198, April 2003 
[2] E. K. Lua, J. Crowcroft, M. Pias, R. Sharma, and S. Lim, “A survey and comparison of peer-to-peer overlay 
network schemes,” IEEE Communications Surveys and Tutorials, vol. 7, no. 2, pp. 72–93, 2005. 
[3] C.-L. Hu, Y.-H. Chang, D.-Y. Chen, and Y.-W. Chen, “Simple peer selection strategies for fast and fair 
peer-to-peer file sharing,” in Proceedings of the 12th International Conference on Advanced Communication 
Technologies (ICACT’10), February 2010. 
[4] Chih-Lin Hu, Da-You Chen, Yi-Hsun Chang, and Yu-Wen Chen, “Fair Peer Assignment Scheme for 
Peer-to-Peer File Sharing,” KSII Transactions on Internet and Information Systems, Vol. 4, No.5, 
pp.709-736, 2010. 
12 
 
3. 請依學術成就、技術創新、社會影響等方面，評估研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）（以
500 字為限） 
 
本計畫著力於整合行動與無線網路、電腦網路與數位家庭網路間多媒體內容傳輸與管理
服務，提出「結合同儕網路協定與家庭網路協定的多媒體閘道器平台」、「行動與無線家庭網
路下無縫式多媒體串流服務」與「大型同儕網路系統中分散式同儕管理與配對機制」。 
    雖然同儕網路（Peer-to-Peer; P2P）是目前網際網路中主流的多媒體內容傳輸服務，但是
大多數同儕網路的服務對象僅侷限於傳統電腦終端使用者，當使用者經由網路電視、遊戲終
端機、平板電腦或行動終端裝置等家庭網路裝置連結上網時，受限於家庭網路的封閉性與裝
置的客製差異，使用者無法接取上外部的同儕網路。因此，我們在開放式 OSGi 閘道器平台
上研發出一套結合 BitTorrent 同儕網路和國際產業標準化的 UPnP 家庭網路協定，使得家庭網
路裝置可直接要求下載和播放同儕網路上的多媒體內容，增進家庭多媒體娛樂的使用情境。
再者，由於新型態行動終端設備支援 IP 通訊、網路、儲存與多媒體處理能力，使用者能
透過行動手持設備無所不在、隨時隨地連結其他行動使用者和相鄰的網路裝置。因此，我們
的研究基於新型態網路應用之發展，研發行動與無線家庭網路下無縫式多媒體串流服務，此
一應用層服務不受限於下層網路通訊模組和作業系統，完全執行於 TCP/IP 網路之上，該服務
軟件可直接應用於現有消費性行動通訊裝置中，支援各類新穎服務發展之所需。 
最後，我們基於對 BitTorrent-like 同儕網路系統架構的分析，探討以 Tracker 為中心的同
儕管理與配對方式對於多媒體檔案傳輸效能的影響，進一步提出大型同儕網路系統中分散式
同儕管理與配對機制，此機制的設計考量到真實的同儕網路中同儕傳輸能力的個別差異、存
在性的變異（Peer Churn）和不互惠的行為（Free Riding），能合理地分配同儕節點的上傳與
下載的傳輸資源，達到更快速的檔案傳輸，同時維持系統服務的公平性。 
    本計畫成果，完成以上三套機制，以整合行動、無線和有線寬頻網路的新型態網路為計
畫內容的應用環境，研發結合同儕網路系統與技術的多媒體內容傳輸與管理服務（整合式多
媒體閘道器、無縫性多媒體串流、同儕管理以及配對選擇等），並具體完成相關軟件和系統雛
形。我們認為在開放式的 IP 通訊環境中，以內容為主、技術應用為導向的應用研究，將逐漸
成為整合性網路多媒體服務的主流發展。 
 
 
14 
 
（英文）This form proposes a remote control method for changing 
the display target of media objects with NFC-aided support. The 
design of this method provides a data exchange model based on 
NFC between two contacted devices. A portable device equipped 
with NFC module is to serve as the key controller device. Using 
this controller device allows users to identify and tag neighboring 
controlled devices. Then, the controller device and controlled 
devices are to be grouped in a closed community. Any pair of two 
controlled devices can be indicated and instructed by the controller 
device to process media content transfer in a networked manner. 
The form developed two operational ways in a complementary 
fashion, i.e., front-end remote control in short-distance interaction 
and back-end remote control in extended-distance interaction. A 
user can operate either way to select the media object source and 
the destination, and then conduct the change of media rendering 
onto the destined display target. With the support of the proposed 
method, the above procedure of sending media object and 
rendering is characterized by a simplified and fast manner without 
complicated manual operations. 
 
產業別 資訊服務業 研究發展服務業 
技術/產品應用範圍 
技術：多媒體傳輸、顯示與播放、遠端遙控技術、近場通訊技
術。 
產品應用：家庭網路影音設備、寬頻網路設備、家用電腦設備、
家用影音設備。 
技術移轉可行性及預期效益 
1. 提出一可攜式並整合 NFC 元件的遠端操控裝置與方法。
2. 支援動態地受控制端標定與配對。 
3. 支援媒體物件在兩受控制端之間的顯示與換置。 
4. 支援簡易非手控的網路操控模式。 
5. 支援在一區域環境中識別與標定網路相鄰的受控制端裝
置，構組一包含主控制端和受控制端之群組。 
6. 提出兩套互補的前端和後端支援的遠端操控方法。 
 
 
 
參與計畫人員的出國出席國際會議和發表論文紀錄 
 
 
 
 
計畫編號 NSC99－2221－E－008－011－ 
計畫名稱 行動同儕網路下多媒體內容傳輸與管理技術之研究 
出 國 人 員
姓名 胡誌麟 
服務機構及
職稱 
國立中央大學通訊工程學系 
助理教授 
會議時間 100 年 3 月 21 日至 
100 年 3 月 25 日 會議地點 Seattle, USA 
會議名稱 
(中文) 第九屆 IEEE 普及計算暨通訊國際會議 
(英文 ) The 9th IEEE International Conference on Pervasive Computing and 
Communications (PerCom) 
(中文) 第七屆行動同儕計算國際研討會 
(英文) The 7th IEEE PerCom Workshop on Mobile Peer-to-Peer Computing (MP2P) 
發 表 論 文
題目 
擔任 MP2P-2011 Workshop Co-chair、研討會主持人和論文的共同發表作者 
(中文) 行動環境中位置私密性維護方法 
(英文) On Preserving Location Privacy in Mobile Environments 
計畫編號 NSC99－2221－E－008－011－ 
計畫名稱 行動同儕網路下多媒體內容傳輸與管理技術之研究 
出國人員
姓名 陳大猷 
服務機構
及職稱 
國立中央大學通訊工程系 
碩士級研究生 
會議時間 100 年 2 月 13 日至 100 年 2 月 16 日 會議地點 
Phoenix park, Korea 
會議名稱 (中文)第 13 屆先進通訊科技國際研討會 
(英文) The 13th International Conference On Advanced Communication Technology 
發表論文
題目 
(中文)在 P2P 網路底下具延展性之分散式配對系統 
(英文) Distributed Pairing for File Sharing in Large-Scale Peer- 
to-Peer Networks 
計畫編號 NSC99－2221－E－008－011－ 
計畫名稱 行動同儕網路下多媒體內容傳輸與管理技術之研究 
出國人員
姓名 林信成 
服務機構
及職稱 
國立中央大學通訊工程系 
碩士級研究生 
會議時間 100 年 1 月 9 日至 100 年 1 月 12 日 會議地點 
美國 拉斯維加斯 
會議名稱 (中文)第二十九屆 IEEE 消費性電子國際會議 
(英文) The 29th IEEE International Conference on Consumer Electronics 
發表論文
題目 
(中文) 整合 P2P 內容分享與 UPnP 網路之家庭閘道器設計 
(英文)Integrated Home Gateway Design for Enabling P2P Content Sharing in 
UPnP-Based Home Networks 
 2
會眾依序試穿選擇自己喜好的衣服的大小。櫃台隔壁即是點心區，那大大綠色 Starbucks 標誌讓人
眼睛為之一亮的，一大圈的點心也頗為誘人，各款星巴克的熱門點心都出現。果然，在星巴克的發
源地開會就是不一樣，就是星巴克，不用懷疑！望出窗外，不難在幾個接到轉角處看到 Starbucks。
第一天，我選擇聆聽的三個 Workshops 包括 Workshop on Managing Ubiquitous Communications and 
Services (MUCS 2011)、Workshop on Sensor Networks and Systems for Pervasive Computing (PerSeNS 
2011)和 Workshop on Middleware and System Support for Pervasive Computing (PerWare 2011)。值得
一提的是，這一次開會剛好是日本發生大海嘯之後不久，許多歐美人士看到我們東方臉孔時總會問
起我們來自日本嗎？日本還好吧？雖然我們是台灣人，但是在這樣的事情發生後，我們看到真實的
人道關懷與問候。也因為日本災後交通癱瘓之影響，PerCom 委託製作的會議論文 USB 碟尚未抵
達，未能在第一時間提供給大家。不過大會隨即在後端伺服器提供所有與會者下載電子檔，不影響
整體會議論文的發佈與討論。傍晚相遇到另一位也是來自台灣交通大學的陳烈武博士，同其他兩位
一同尋找餐廳用餐，最後在一家小 Bar 吃了冰涼的海鮮後，回旅館休息；接下來這幾天，我們一行
四人經常是集體行動，相互照應，丁博士第三天感冒、陳博士第四天起也腸胃不適，本人攜帶的隨
身醫藥支援給他們。 
3/22 -- 24 大會一早即開始主議程，每一篇論文的分量相當扎實，每一位作者有完整的三十分鐘簡
報與問答。因為主會議三天議程的安排為單一 Session，同時間沒有其他的 Workshop Session，所有
與會人士匯集在大會議室，我在一次離開上洗手間回來，我就失去了那寶貴的座位，真的是太滿了，
不適會議室太小，至少擠進去有 250 人吧，連走道和出國都站滿人。頂級會議果真不同，每當簡報
人完成口述後，就有多人舉手發問，主持人完全不需要擔心冷場而必須勉強硬擠出問題，討論屢屢
延長至下一 Session，在旁等候的下一講者多能感受到這樣的氣氛，也不自覺緊張，不斷的默背講
稿，到上台時，大多年輕學者講述時也參雜的顫抖的聲音。接下來的兩天，也是類似的情形，還好
我的時段是最後一天，尚有些許的時間可以調適與練習，這幾天很享受這樣的氣氛。特別來說，
PerCom 的議題很明確，透過交叉提問與答復的過程中，我們可以明確地接受到著名學者們對於下
一階段或接下來發展的方向已有清楚的表示，這也會影響到緊接下來幾年內這領域的 CFP 主題，
提供給我們後學者相當寶貴的研究參考。同時，本人這期間也積極參與 Demo 論文的海報發表與時
機展示，觀察到 PerCom 很注重系統整合實作，純理論性的論文反而少數，與會者相當重視理論的
實作驗證，這從論文發表者和與會人士的國籍身分不難看出來，歐陸人士相當多，這樣的系統與理
論研究論述一項是歐系人士的長項。相反地，台灣的學術風氣較傾向理論導向和模擬分析，系統開
發甚少。 
3/25 本人主持的第七屆行動同儕計算國際研討會安排在最後一天的上午，這次經過審查人嚴格的
篩選出六篇論文：依據收錄論文的內容，主軸定位為 Mobile P2P Data and Network Services，這次
MP2P研討會亦邀請兩位同為國內新進學研人士擔任 session chairs（Dr. Wei-Chih Ting (ITRI, Taiwan); 
Kate Ching-Ju Lin (Academia Sinica, Taiwan)），為我們自己搭建一個難得的國際場合交流平台。在
 4
仰賴團隊的合作，付出的時間與人力很多，但是也頂多換來一篇 SCI；相較於理論分析和演算法
設計與模擬之類的研究，以論文產出數量來看，系統設計的研究投資報酬率相對少很多，也因
此，少有學者能持續堅持走下去。但是，這是對的現象嗎？或許值得我們再議之。 
行動同儕計算國際研討會自 2004 年創始即與 IEEE PerCom 一同舉辦，因研討會的主軸新穎
和明確，歷次均獲得 IEEE PerCom 的接受為衛星研討會，也由於 IEEE PerCom 的成功，MP2P
也獲得國際眾多學研人士的專注與參與。本人自 2010 年起接受行動同儕計算國際研討會創會主
席（Dr. Jiannong Cao, Hong Kong Polytechnic University, Hong Kong）的邀請，協助籌組第六屆研
討會、擔任共同主席與大會聯絡人，今年持續擔任第七屆研討會的共同主席與大會聯絡人。有
感於過去少有台灣作者能直接投上 IEEE PerCom，我們希望能藉由 MP2P 的籌組和論文的審議
過程等方式，在某種程度上讓我們來自台灣的論文和學研人士能夠更有機會接近這頂級會議，
有機會到場與這領域國際上知名學者群交流，聆聽最新的成果和接下來的發展方向。期待很快
地又可以有來自台灣的論文登上 IEEE PerCom。 
 
三、 考察參觀活動(無是項活動者略)：無 
四、 建議 
    IEEE PerCom會議過程相關行政人士所表現出的高工作效率以及安排，看得出IEEE PerCom的
專業和素質，在這方面的充足準備與企圖，也反映在論文的極高水準，名實相符。反觀，近幾次參
與國內學術研討會，所接觸到的場景與人事物，不禁有感而發總次欠缺那門一點“專業＂和“效率”，
研討會的人士大多是研究生工讀生、和計畫助理充當接待，有一懂沒一懂，整體表現難免混亂點。
希望我國政府或是法人單位有專責的行政單位協助舉辦國際會議之財務收受、住宿安排以及場地佈
置等，能表現出更積極的輔導角色。 
 
五、 攜回資料名稱及內容 
會議論文集電子書 
 
六、 其他（與會的影像紀錄） 
 
 1
國科會補助專題研究計畫項下出席國際學術會議心得報告 
                                     日期：100 年 10 月 23 日 
一、參加會議經過 
ICACT’11 在南韓江原道鳳凰城渡假村舉辦，會議期間為 2011/2/13 ~2011/2/16。這次很幸
運的可與一位於工研院的工作的學長結伴同行，兩人於 2/12 日一早搭乘中華航空前往首爾。由
於 2/12 日在鳳凰城度假村的飯店已經客滿，因此 2/12 日便先在東大門附近的高爺會館落腳，隔
天早上(2/13)搭乘巴士前往江原道鳳凰城渡假村。經過約三個小時的車程後，終於到達了目的
地，在會場報到領取 ICACT 會議論文集電子檔、記事本、紙本的 final program，並了解會場
的狀況後，就趕緊回到房間準備自己隔天的報告，畢竟是第一次出國且用非母語的英文發表，
難免會有些緊張，所以把握時間不斷的重複練習報告的內容，希望可以很清楚以及流暢的將自
己的口頭發表完成。房間的視野很好，從陽台可以看到度假村附設的滑雪場，十分壯觀，便希
望報告完後可以有機會去滑雪場玩一玩，畢竟這是這輩子第一次看到雪。 
敝人的報告被安排在第二天(2011/2/14)的下午，Session Topic 為 Distributed Computing 
Technologies。因此第二天一早對於報告內容做最後一次確認後，便先到早上的其它 Session 聆
聽其他人的發表，並了解一下會議進行的模式。報告過程十分順利，比較尷尬的是由於主席是
印度人，因此主席第一次提問時因為口音關係，我有點聽不懂主席的問題。幸好請主席複述一
計畫編號 NSC99－2221－E－008－011－ 
計畫名稱 行動同儕網路下多媒體內容傳輸與管理技術之研究 
出國人員
姓名 陳大猷 
服務機構
及職稱 
國立中央大學通訊工程系 
碩士級研究生 
會議時間 
100 年 2 月 13 日
至 
100 年 2 月 16 日 
會議地點 
Phoenix park, Korea 
會議名稱 
(中文)第 13 屆先進通訊科技國際研討會 
(英文) The 13th International Conference On Advanced Communication 
Technology 
發表論文
題目 
(中文)在 P2P 網路底下具延展性之分散式配對系統 
(英文) Distributed Pairing for File Sharing in Large-Scale Peer- 
to-Peer Networks 
 3
 
 
 
 2
說也堪稱流利易懂；但接下來的一位西班牙腔就相當嚴重導致中間有部分實作細節流程說明不
易理解，輪到本人上台時雖情緒緊張，但還是再有備稿的情況下順利將演講結束，並回答
Session Chair 的一個簡短問題。 中午休息片刻緊接著就是下午場次的 Poster Session，瀏覽
過其他 session 的大致狀況，觀察到 poster session 在時間較充裕狀況下反而能與有興趣的學
者專家有更多深刻的互動，因展示場地為會議中心走廊且前一時間梯次之 session 提早結束得
以提早進駐攤位擺設，在布置海報時發生未帶齊美工用具等窘境，索性與隔壁攤位也同樣未準
備的一位荷蘭籍博士生一同向大會請求協助，在互相分享與會心得之後便開始正式的 poster 
session，在展示期間尤以一位華人學者提出最多問題並不吝給予寶貴建議，之後回國才得知其
為交大電子工程系之方偉騏教授。 
二、與會心得 
此次為學生第一次參與國際會議活動，過程中接觸到不同國家的各領域的研究學者，也看到
大陸學生出席會議的嚴謹與充足準備-其中尤以北京航天大學的 poster 攤位令人印象深刻，不
僅有全版全彩且版面經過設計過的海報，攤位更備有實機展示與多名學生解說，與清華大學教
授談話討論後也得知大陸一流大學對學生的紮實訓練栽培，實可引以為鑑。 
 
三、考察參觀活動(無是項活動者略)：無 
四、建議  
此次出國發表深深體會英文口語表達與學術交流相輔相承的關係，唯有能與國際產學人士
流暢溝通才能將台灣研究成果推向國際舞台，期望政府多鼓勵補助研究生在國際舞台發表，對
於拓展學生視野與國際觀能有莫大的助益。 
五、攜回資料名稱及內容：會議論文集電子書 
六、其他 
 
Distributed Pairing for File Sharing in Large-Scale
Peer-to-Peer Networks
Chih-Lin Hu and Da-You Chen
Department of Communication Engineering, National Central University, Taoyuan, Taiwan 32001, R.O.C.
clhu@ce.ncu.edu.tw; 995203011@cc.ncu.edu.tw
Abstract—Peer-to-peer systems encounter critical issues, such
as peer churn, free riding, and varied workload, which signif-
icantly affect performance results such as resource utilization,
service agility, and fairness. This study proposes a distributed
pairing scheme that supports fast and fair ﬁle sharing applica-
tions in large-scale peer-to-peer networks. This design exploits
the peer duality of both server-oriented peer capacity and client-
oriented peer contribution. Accordingly, the scheme can perform
peer assignment, substitution, and elimination, and cope with
subtle situations of free-riding, service starvation, and download
blocking, thus making the system design robust and amenable.
Simulation results conﬁrm that the proposed mechanisms are
effective in maintaining service agility and fairness in large-scale,
distributed peer-to-peer ﬁle sharing environments.
I. INTRODUCTION
Peer-to-peer (P2P) networking has emerged as a new dis-
tributed computing paradigm for content distribution applica-
tions. The wide deployment of P2P systems has an explosive
increase of peer population and service capacity. In P2P ﬁle
sharing applications, like Napster, Gnutella, eDonkey, and Bit-
Torrent, a peer requests ﬁles from its peers, and also stores and
serves ﬁles to its peers [1]. Increasing peer population not only
increases request workload, but also produces a concomitant
increase in service capacity to process the workload [2].
However, critical issues such as peer churn, free riding,
and varied workload signiﬁcantly affect performance results
such as service agility, fairness, and resource utilization. In
P2P systems, peers cooperate to run an application-level over-
lay network [3] that provides connectivity, signal messaging,
routing, and searching between end hosts that are addressable
on top of IP communication networks. Peer churn, which
represents the dynamics of peer participation in a system,
inﬂuences overlay design, resiliency, and assessment [4]. Peer
transiency and its mutual dependency affect the efﬁcacy of
replication, search, and query mechanisms in content distrib-
ution [5][6]. On the other hand, free riders, which maximize
their own utility disproportionate to their contribution to the
system, negate the reciprocal provision of resources among
peers [7]. If no request admission or scheduling policy is
enforced to maintain service fairness, generous peers often
become frustrated and refuse to contribute anymore [8]. To
encourage peer contribution and guarantee service fairness,
the growing recognition of reputation-based incentive schemes
[9] has generated signiﬁcant research in this area: reputable
peers receive high priority and are rewarded more resources
to compensate for their contribution.
This study proposes a distributed pairing strategy for fast
and fair ﬁle sharing in large-scale P2P networks. This design
exploits peer duality, in that each peer plays a dual role of both
service provider (server) and a consumer (client) of the imple-
mented service [10] in P2P networks. Accordingly, the system
performs distributed peer management that records peers’
uploading and downloading behavior. The system then applies
distributed pairing schemes based on reputation incentives
to control the request admission and scheduling processes.
The proposed mechanisms guarantee fair and efﬁcient use
of resources without decreasing overall system throughput
against peer churn, free riding, and workload dynamics.
Therefore, the concept, design, and development phases
are described as follows. First, a practical large-scale P2P
system usually consists of many small-scale centralized and
structured P2P systems [1][11]. Each small system contains
a hosting tracker that acts as a local central directory for
peers in its domain. Trackers from external domains form in
a tracker network and can forward downloading requests to
other trackers. Second, with the grading measures of client-
oriented peer contribution and server-oriented peer capacity,
the trackers can manage peers in a distributed manner to cope
with free-riding, service starvation, and download blocking.
Third, this study presents two kinds of tracker-oriented and
peer-oriented pairing schemes based on indirect-reciprocity
incentives [12] to control the request admission and scheduling
processes for fair and efﬁcient use of resources. Finally, exper-
imental simulations assess performance sensitivities in terms
of average download time, download ratio by contribution
range, and communication overhead. Consequently, this study
presents a systematic methodology that provides an effective
peer pairing scheme in large-scale distributed P2P ﬁle sharing
systems. The proposed mechanisms protect system throughput,
service agility, and fairness against service starvation and
varying trafﬁc dynamics in P2P networks.
The rest of this article is organized as follows. Section II
models a distributed P2P environment. Section III details the
proposed distributed pairing schemes. Section IV presents the
performance results, while Section V provides the conclusion.
II. SYSTEM MODEL
This section models a large-scale distributed P2P network,
and the measures of client-oriented contribution and server-
oriented bandwidth capability for priority determination and
pairing assignment among peers.
ISBN 978-89-5519-155-4 492 Feb. 13~16, 2011 ICACT2011
III. DISTRIBUTED PAIRING SCHEME
This section describes a distributed pairing scheme for
large-scale, distributed P2P ﬁle sharing systems. This design
presents two kinds of tracker-oriented and peer-oriented dis-
tributed pairing approaches that are functional in maintaining
service agility and fairness in dynamic network environments.
A. Design Considerations
The practical deployment of a large-scale distributed P2P
system comprises many small-scale centralized and structured
P2P systems. Though an unstructured P2P system is somewhat
workable in a small-scale network, combining many unstruc-
tured P2P systems into a large one is impracticable due the
drastic increase of message workload and tremendous search
requests ﬂooding the system. Instead, the proposed scheme
is based on a partially-centralized and structured network
architecture. Figure 1 shows this reference architecture, which
introduces a new tracker network. A tracker group includes
many trackers that perform peer assignment strategies in their
local P2P domains. Trackers communicate with other trackers
to collaborate on the distributed peer pairing scheme over
the tracker network. Due to a variety of architectural and
protocol dependencies, the design of a tracker network overlay
is beyond the scope of this study. Since a tracker network
is relatively small, without complication, this design plainly
refers to a simple request/response messaging protocol by
unicasting and broadcasting.
The proposed distributed peer pairing scheme augments
the centralized peer assignment strategies in our previous
study [11], which are particularly basic peer selection scheme
(BPSS) and advanced peer selection strategies with peer
substitution and elimination (APSS and APSS-E). The below
summarizes the effects of BPSS, APSS, and APSS-E, while
the details are omitted here to save page space.
• BPSS chooses server peers to process download requests
in descending order of peer contribution in light of
indirect-reciprocity notion [12]
• APSS extends BPSS with a substitute policy to cope with
peer churn and varying request workload.
• APAS-E associates APSS with a peer elimination process
to cope with possible service starvation and further boost
the ability of service differentiation and fairness.
The distributed pairing scheme is applied into local and
external P2P domains, simultaneously and collectively, to
deal with service fairness, throughput, and starvation in a
distributed manner. Note that the BPSS procedure within a
local domain remains unchanged. What is mainly modiﬁed
in the proposed scheme is the procedure of generating a set
of candidate server peers from a tracker group instead of a
singular tracker, as compared in APSS. The proposed scheme
is based on several assumptions that are appropriate in a large-
scale, distributed P2P environment.
• A peer is able to communicate with more than one tracker
to operate different queries and downloading requests.
• When a peer has completely downloaded any requested
segment through some tracker’s coordination, this peer
becomes linked to the domain of that tracker. In other
words, a peer can concurrently belong to multiple do-
mains, hosted by different trackers, from which this peer
has downloaded different segments.
• Every tracker is not only responsible for offering the
segments kept its local domain, but can also deliver to
and receive from other trackers speciﬁc request/response
messages to perform distributed tasks.
B. Scheme Description
The proposed distributed pairing scheme extends BPSS,
APSS, and APSS-E with elegant modiﬁcation for fast, fair
and non-blocking ﬁle sharing in distributed P2P environments.
This scheme performs two-phase procedures, BPSS and dis-
tributed version of APSS and APSS-E, in local and global P2P
domains, respectively.
1) Local Domain: Each tracker Wl in its local domain
Gl takes the request workload in descending order of peer
grading Jl, and schedules requests in descending order of peer
contribution Fl. Given a peer sl whose download bandwidth
is higher than , it can send Wl a request uln to download a
segment Vn. With a uln, Wl generates a peer set, called K(Vn)
including all peers having Vln in their local storages. Then,
Wl selects the server peer su with the highest upload rate
in K(Vn). If su’s Ju is not lower than , Wl notiﬁes sl of
its server peer su in charge. Then, sl negotiates with su for
downloading Vn. If su has no enough upload bandwidth to
serve uln at this moment, Wl will mark sl’s download state
as sleep and push this request back into the request queue.
The server later checks if uln is valid yet. In this way, Wl can
simply and evenly balance the use of bandwidth capacities
among peers in Gl.
However, the basic scheme can encounter upload or down-
load blocking due to service starvation, resulting in poor
performance. This situation does not mean that a requested
segment does not exist in the system. A heavy request work-
load for scarce segments, peer churn, and skewed access
patterns can all induce this problem. When all peers owning
Vn are in busy state, they have no more bandwidth to upload.
Any requests for Vn are then blocked until any su in K(Vn)
reclaims sufﬁcient upload bandwidth to accept a new request.
2) Global Domain: The proposed distributed pairing
scheme enforces the peer substitute and elimination policies
to address this problem of service starvation. This scheme
attempts to ﬁnd an optimal substitute peer sv in the distributed
system to replace a busy peer su in K(Vn) and take over
its ongoing uploading tasks. The replaced peer su can then
reclaim more upload bandwidth and accept another request
for some segment now held by su.
In reference to Fig. 1, the distributed pairing scheme has
ﬁve procedural steps (Steps 1–5). Algorithm DP shows the
algorithmic form to ease presentation. Initially, distributed
pairing will start in case that a peer sl with a request uln runs
into a downloading blocking situation.
ISBN 978-89-5519-155-4 494 Feb. 13~16, 2011 ICACT2011
Fig. 2. Algorithmic form.
• Average ratio of pending requests is the total number of
pending requests in queue to the total of segment requests
that all peers have sent to the system.
B. Experimental Results
This study simulates the distributed pairing scheme and
compares tracker-oriented and peer-oriented methods in a
distributed P2P environment. Experiments were conducted to
examine the inﬂuences of different factors, including tracker
group size, initial number of segments owned by each peer,
bandwidth granularity, and peer contribution. The experimen-
tal results in Fig. 3(a)-(d) show some observations below.
First, the tracker-oriented method induces a linear growth
in message overhead as the tracker group size increases, as
Fig. 3(a) shows. In contrast, the message overhead generated
by the peer-oriented method remains nearly constant regard-
less of the tracker group size. This is because the hosting
tracker in the tracker-oriented method forwards K(Vn) to all
external trackers and asks them to ﬁnd an optimal substitute
server peer. This process propagates a considerable amount
of messages across the tracker network. In the peer-oriented
method, however, the hosting tracker ﬁrst determines a subset
of potential trackers. This process avoids a “blanket” search
in the tracker network.
Second, computing a pre-determined subset of potential
trackers using the peer-oriented method is cost-effective, since
it efﬁciently reduces the overall message overhead. Though
this pre-determining process generates some computation and
communication overheads, these costs are limited in the host-
ing tracker’s domain. Hence, this process is superior to the
high expense of the tracker-oriented method. The additional
experimental results depicted in Fig. 3(c) support this obser-
vation in that the tracker-oriented method sends more outward
messages to external trackers than the peer-oriented method.
Third, bandwidth granularity directly inﬂuences the measure
of message overhead. Both peer-oriented and tracker-oriented
methods produce lower message overheads under higher gran-
ularity. For instance, the obvious differentiation between the
cases of =10% and =50% depicted in Fig. 3(a) conﬁrms
this observation.
Fourth, the tracker-oriented method is sensitive to the vari-
ance of number of segments that every peer begins with.
The greater the initial number is, the smaller the number
of messages a request may incur. When the initial number
is larger enough, the average number of outward messages
caused by every request approaches zero. In other words, the
hosting tracker handles almost every request in its local do-
main. Adding more initialized segments effectively increases
the probability of ﬁnding a server peer within the domain.
On the other hand, the message overhead of the peer-oriented
method remains low for the same reason as mentioned above.
Finally, using the tracker-oriented or the peer-oriented
method achieves the same result of ﬁnding an optimal sub-
stitute server peer sv in a large-scale distributed P2P network,
though they generate different message overheads. Both the
peer-oriented and tracker-oriented methods can augment ser-
vice fairness by peer substitute and elimination. Figure 3(d) de-
picts the measures of blocking rates among peer clusters. The
blocking rate is very low when no server peers are available as
a result of temporary unavailability due to unsuccessful peer
elimination. Again, the blocking rate can be much reduced as
the system has segments scattered over a distributed network.
The discussion above reviews the peer-oriented and tracker-
oriented methods in a distributed P2P network environment.
Based on the relative performance indicated in Fig. 3, the peer-
oriented method is superior to the tracker-oriented method
in terms of efﬁciency and cost-effectiveness. Nevertheless,
whereas the peer-oriented method induces a higher computa-
tion overhead, the tracker-oriented method is preferable under
some critical situations. For example, peers may be resource-
constrained to reduce computation cost, or when transmission
between the tracker and its mobile or thin peers is limited or
unreliable. Hence, though the tracker-oriented method is not
ISBN 978-89-5519-155-4 496 Feb. 13~16, 2011 ICACT2011
Abstract--This paper proposes a home gateway architecture 
which integrates P2P file sharing and UPnP AV services on the 
OSGi framework. This design allows UPnP devices to access P2P 
media content from the Internet. Prototype demonstration 
presents several friendly UPnP-style scenarios for P2P AV 
entertainment in a home network environment. 
I. INTRODUCTION 
Importing plentiful peer-to-peer (P2P) media content from 
Internet into a home network could enrich home-entertainment 
services. However, media content sharing services have 
respective networking and interoperability specifications in 
the public access network and home network. This paper 
proposes an integrated home gateway design, briefly named as 
UP2P, which is able to offer P2P media downloading and 
streaming services in a UPnP-based home network. This 
allows home-networked devices (HNDs) to play P2P content 
using UPnP and UPnP AV fashions [1]. Prototyping work 
implements a proof-of-concept software on the Open Service 
Gateway initiative (OSGi) platform [2]. Demonstration 
presents several interesting scenarios for P2P AV 
entertainment in a UPnP-based network environment. 
II. MOTIVATION AND CONSIDERATIONS 
Many modern consumer electronics and HNDs have 
upgraded computation, networking, multimedia processing, 
and storage capabilities. DLNA [3] and UPnP have addressed 
the interoperability of distributed multimedia services among 
PC, CE and Mobile products in a home network. Observe that 
some sorts of HNDs, e.g., NAS, PC, laptop, and STB, can 
simultaneously or alternatively connect to external/public 
access networks. Such HNDs may also run P2P file sharing 
applications [4] to download media content from the Internet. 
Users in home networks are desirable to access P2P content 
with their HNDs in a friendly UPnP way. 
However, P2P and UPnP have separate communication 
networks, and application domains. A UPnP network is closed 
since all UPnP devices must agree with the same messaging 
and interoperable principles in a singly administrative network. 
P2P communication protocols are proprietary and 
incompatible with UPnP’s ones. For P2P media sharing across 
public and home networks as depicted in Fig. 1, this paper 
proposes the UP2P gateway architecture to support the inter-
networking, media transport, media transformation, and media 
management. This design considers the factors of cost-
effectiveness, heterogeneity, and distribution transparency, 
and user experience. The UP2P gateway can not only alleviate 
asymmetric bandwidth, computation, and playback 
capabilities between two heterogeneous networks, but also 
provide access and location transparencies when P2P content 
is widely distributed in the Internet. Thus, the UP2P gateway 
can help HNDs save communication, energy and storage costs. 
In addition, the UPnP gateway can learn user access behavior 
and enhance user experience. 
III. ARCHITECTURE DESIGN 
The UP2P gateway architecture integrates three software 
components, BitTorrent peer [5], UPnP downloading manager, 
and UPnP AV media server on the OSGi framework. Fig. 2 
and Fig. 3 depict these components and associated services, 
and their functional procedures. 
BitTorrent peer supports downloading P2P media content 
from the Internet. This component consists of the basic P2P 
file sharing service, media playback service (MPS), and 
UP2P-to-UPnP content directory service (xCDS). The UP2P 
gateway runs this peer to join the BitTorrent overlay, resolves 
torrents, and downloads media files. MPS allows non-UPnP 
HNDs to browse and play downloaded media content. The 
xCDS catalogs those downloaded files into a shared UPnP AV 
content directory that the UPnP AV media server can access.  
UPnP downloading manager provides two UPnP-specific 
services, torrent directory service (TDS) and media download 
service (MDS), which UPnP devices use to access P2P 
content. Firstly, TDS maintains a torrent directory that 
contains torrent metadata records (names, lengths, piece size 
used, piece-based hashing codes, and a tracker’s URL.), and 
performs torrent addition, removal, and enumeration requested 
by UPnP devices. With TDS, UPnP devices can share torrents 
Integrated Home Gateway Design for Enabling P2P Content 
Sharing in UPnP-Based Home Networks 
Chih-Lin Hu, Member, IEEE, Hsin-Cheng Lin, Bing-Jung Hsieh, and Yu-Feng Hsu 
Department of Communication Engineering, National Central University, Taiwan, R.O.C. 
UPnP
P2P
UPnP/DLNA Context
P2P
UPnP
P2P Context
Home NetworkInternet
Gateway
 
Fig. 1.  An illustrative scenario based on the UP2P Gateway. 
U
P2
P 
B
un
dl
es
UP2P Torrent Directory Service
UP2P Media Playback Service
UP2P Media Download Service
UP2P-to-UPnP Content Directory Service
UPnP Device Architecture
UPnP AV (CDS, CMS, AVT)
O
SG
i S
er
vi
ce
 F
ra
m
ew
or
k
UPnP AV Media 
Server
BitTorrent Peer
UPnP Downloading 
Manager
Basic P2P Service
 
Fig. 2.  UP2P-specific components and services. 
2011 IEEE International Conference on Consumer Electronics (ICCE)
978-1-4244-8712-7/11/$26.00©2011 IEEE 229
Abstract—This paper proposes a simple, application-level, and 
platform-independent mechanism which provides seamless media 
streaming and playing services in a home network. Prototype 
implementation achieves the software applications which can 
perform fast TCP re-connections and pre-fetch media segments, 
thus sustaining playback continuity against users’ movements in 
a ubiquitous home network environment.  
I. INTRODUCTION 
Modern home-networked devices (HNDs), including PC, 
CE and mobile devices, have upgraded computation, 
networking, and storage capabilities. Fig. 1 depicts the home 
living context where HNDs interconnect in wired/wireless 
networks such as Ethernet and Wi-Fi. HNDs can not only play 
but also share media content stored in the local storages with 
others in a networked manner for home AV entertainment 
Users with mobile devices can move about at home. During 
media streaming/transferring, the movement of either a media 
player/receiver or server/sender may break any ongoing 
transfer connections due to terminal mobility, and then induce 
playback discontinuity or termination. To remedy these issues, 
previous research focused on how to perform fast connection 
switch, recovery, handoff, and mobile IP mechanisms in terms 
of the network system design. This sort of approach requires 
the complicated designs of underlying network hardware, 
software, and communication protocols. Unfortunately, it is 
difficult to be integrated into CE and mobile devices, and not 
appropriate for home networking technologies. 
This paper proposes a seamless media streaming and 
playing mechanism based on standard TCP/IP protocols and 
socket APIs. This design is application-level and platform-
independent. Target HNDs can employ this mechanism 
without customizing system kernel and networking modules. 
Prototype implementation achieves two proof-of-concept 
versions for JVM and OSGi runtime contexts [1]. 
Demonstration presents the desirable media streaming and 
playback services in a ubiquitous home network environment. 
II. MECHANISM DESIGN AND DEVELOPMENT 
The proposed mechanism includes three software facilities, 
network transport, media streaming, and media playing 
modules, which support many featured functions below. Fig. 2 
depicts these building blocks and their interactive flowcharts.  
 Dynamic naming and endpoint identity mapping  
 Automatic re-connection and network I/O switching 
 P2P-like media streaming in a home network 
 Asynchronous and concurrent data delivery 
 Media segment access, control, and management  
 Triple buffers for media segment aggregation 
 Standalone playback state machine 
 Home-based shared media directory 
A. Network Transport Facility 
The network transport facility provides a robust media 
transport mechanism which can rapidly and automatically 
resolve the TCP connection break and partial closing 
problems due to the sender- or receiver-initiated movement in 
a home network. This design includes a network location 
manager and a connection manager. The former can change 
the HND’s identity and endpoint assignment (IP address, 
socket, a pair of working and listening ports), and notify the 
other party of updated location information. The latter can 
establish and rebind TCP connections associated with a new 
endpoint to replace the broken ones, and then switch I/O 
streams to continue sending/receiving remaining media data.  
Fig. 3 illustrates the sender- and receiver-initiated 
movement cases. During media streaming, the sender’s 
network location manager holds a pair of working and 
listening ports bound with the same socket and IP address, and 
so does the receiver’s. When either party moves and obtains a 
new endpoint, it can still reach the other by re-connecting to 
its listening port. Two parties’ connection managers then 
remain media streaming via the new connection regardless of 
the broken one.  
B. Media Streaming Facility 
This facility integrates the P2P paradigm [2] in a home 
network environment, and supports the on-the-fly media 
streaming service for impromptu playback. This design 
presents a triple buffer scheme with data, segment, and 
playing buffers to perform asynchronous and concurrent 
HTTP-based downloads from multiple peers, segment 
A Simple Mechanism for Seamless Media Streaming and 
Playing Services in a Ubiquitous Home Network 
Kuo-Fu Huang and Chih-Lin Hu, Member, IEEE  
Department of Communication Engineering, National Central University, Taiwan, R.O.C. 
Fig. 1.  A ubiquitous home network environment. 
OSGiFramework/JavaVirtualMachineJNA
MediaPlayingModule MediaStreamingModule NetworkTransportModule
Playback
State
Machine
GUI
Operation
MediaDirectory
SegmentBufferPlayingBufferCodec
Control
DataBuffer
ConnectionManager
Transport
I/OSwitch
NetworkLocationManager
CallbackFunctions
OperatingSystem&HardwarePlatforms
Fig. 2.  The functional blocks in the proposed mechanism. 
2011 IEEE International Conference on Consumer Electronics (ICCE)
978-1-4244-8712-7/11/$26.00©2011 IEEE 323
國科會補助計畫衍生研發成果推廣資料表
日期:2011/10/25
國科會補助計畫
計畫名稱: 行動同儕網路下多媒體內容傳輸與管理技術之研究
計畫主持人: 胡誌麟
計畫編號: 99-2221-E-008-011- 學門領域: 網路 
研發成果名稱
(中文) 以近場通訊技術協助變換媒體物件顯示標的之遠端操控方法
(英文) A Remote Control Method for Changing the Display Target of Media Objects with NFC-
aided Support
成果歸屬機構
國立中央大學 發明人
(創作人)
胡誌麟,林佳志,林正倫
技術說明
(中文) 提出一套以近場通訊技術協助變換媒體物件顯示標的之遠端操控方法。此方法的
設計採用NFC 接觸式資料交換模式，以一可攜式並整合NFC 元件的主控制端裝置，
在一區域環境中識別與標定網路相鄰的受控制端裝置，構組一包含主控制端和受
控制端之群組。針對使用者與受控制端裝置的傳輸距離之不同，本專利提出兩套
互補的操控方式：(A)具控制端前端支援的遠端操控方法、（B）具受控制端後端
支援的遠端操控方法。前者的使用主要支援時機為使用者與受控制端兩者間距短，
後者主要支援時機為使用者與受控制端兩者間距大。使用者可藉由操作主控制端
來選配媒體物件的來源端與接收端，進一步以接觸式或非接觸式的簡易操作方式，
操作一媒體物件的傳送與接收，完成媒體物件顯示標的之換置，取代傳統繁複手
動操作模式，達到快速的物件傳輸與顯示換置。
(英文) This form proposes a remote control method for changing the display target of media 
objects with NFC-aided support. This method provides a data exchange model based on 
NFC between two contacted devices. A portable device equipped with NFC module is to 
serve as the key controller device. Using this controller device allows users to identify 
and tag neighboring controlled devices. Any pair of two controlled devices can be 
indicated and instructed by the controller device to process media content transfer in a 
networked manner. The form developed two operational ways in a 
complementary fashion, i.e., front-end remote control in short-distance interaction and 
back-end remote control in extended-distance interaction. A user can operate either way 
to select the media object source and the destination, and then conduct the change of 
media rendering onto the destined display target. 
產業別 研究發展服務業；其他專業、科學及技術服務業；資訊服務業
技術/產品應用範圍
ˋ技術範圍：多媒體傳輸、顯示與播放、遠端遙控技術、近場通訊技術 
產品應用範圍：家庭網路影音設備、寬頻網路設備、家用電腦設備、家用影音設備
技術移轉可行性及
預期效益
有鑑於目前常用的媒體物件顯示標的之換置必須以使用者手動操作兩台以上的裝置（包
括繁複的媒體物件的標定、顯示裝置的選定、網路傳輸的啟動等過程），這類的動作經
常是繁瑣的，導致使用者必須經常在兩台以上的裝置之間不斷地切換工作環境，耗時操
作的結果卻又容易出錯。我們注意到目前的遠端控制裝器尚未整合NFC 技術，並且尚未
開發利用NFC特性。我們分析NFC 結合網路應用之特性與潛在功能，提出一套以近場通訊
技術協助變換媒體物件顯示標的之遠端操控方法，發展所屬軟件，並成功在市售的可攜
式行動裝置上實現所擬的功能。 
 
創作的技術的預期效應，包括： 
可攜式並整合 NFC 元件的遠端操控裝置與方法。 
支援媒體物件在兩受控制端之間的顯示與換置。 
支援簡易非手控的網路操控模式。 
支援在一區域環境中識別與標定網路相鄰的受控制端裝置，構組一包含主控制端和受控
制端之群組。 
提出兩套互補的前端和後端支援的遠端操控方法。 
註：本項研發成果若尚未申請專利，請勿揭露可申請專利之主要內容。
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
辦理學術活動： 
- Guest Editor, International Journal of Computer Networks &amp；
Communications, Special Issue on Networks and Communications, 2011. 
- Co-organizer, IEEE PerCom'11 Workshop: The Seventh Int'l Workshop on 
Mobile Peer-to-Peer Computing (MP2P’11), Seattle, USA, March 2011. 
- General Co-chair, The 3rd Int'l Workshop on Wireless, Mobile Networks 
&amp； Applications, Dubai, UAE, May 2011. [Springer CCIS Vol. 154] 
 
獲得獎項： 
2011 國立中央大學資訊電機學院新進研究優良獎 
 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
