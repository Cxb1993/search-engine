1Study on Self-Localization for Cooperative
Wireless Relay Networks
Chih-Yu Wen
Department of Electrical Engineering
Graduate Institute of Communication Engineering
National Chung Hsing University
Abstract
One of the most needed and challenging components in wireless mobile networks is the development
of practical localization algorithms for the automatic discovery of mobile station position with cooperative
communication and networking. This proposal outlines recent work in which we have developed an
efficient principled approach to localize an object. We identify a number of ways that the method can
be made more efficient and robust for localization and target tracking in wireless mobile networks. A
design study will be performed to determine the detailed system requirements - to determine the required
spatial coverage, data rates, communication protocols, and position estimation accuracy, and to study the
trade-offs against the system model and power requirements of the subsequent radio systems. Based
on modular, self-powered, autonomous mobile nodes, we will develop a robust infrastructure, which
combines cooperative communications and navigation, to enable the positioning task.
I. INTRODUCTION
In this project, we develop a robust, combined communications and navigation infrastructure, based
on modular, self-powered, autonomous nodes, to enable the positioning task. The infrastructure will be
based around wireless radio systems that determines autonomously the relative physical positions of each
unknown station in relay-based mobile networks. The position estimation becomes more accurate as more
reference stations (RS) (i.e. the base station (BS), the relay nodes (RNs) or the mobile stations (MSs)
with position information) are presented to the network and as more network traffic propagates. Initially,
all of the MS positions are unknown and must deduce their positions based on the limited information
that they receive. The basic strategy is to form a local coordinate system using reference nodes and allow
group of nearby MSs to deduce their positions relative to each other. This in a nutshell is the cooperative
self-localization problem.
II. METHODOLOGY
The system consists of two components: GPS-enabled BS and RNs, and position-unaware MSs. The
stations with position information are called reference stations (RS). RSs broadcast beaconing messages
while unknown MSs receive the message to find their current position. The objective of the algorithm
is to find a new position at a current time with the logged data of beacon messages. RS’s duty is to
inform its position to nearby unknown stations. Unknown MSs periodically compute and broadcast their
positions at current time.
Fig. 2. The distance information can be use to obtain the x and y coordinate bounds for the unknown MS, which provides a
good set of initial samples for the particle filtering.
The measurement term for the MSm is
zk =
∑
ℓ∈Hm
∣∣∣|xmk − xℓk| − dmℓ∣∣∣+ vk (2)
where the sum is over the nearby MSs xℓk, dmℓ represents the measured distance between the estimated
MS and RSs and may be approximated in application by the inverse of the signal strength or by calculated
from the time delay between transmission and reception [1]; the measurement noise is another uncorrelated
zero mean Gaussian white noise process; the MS set Hm is the chosen RSs for the measurement.
Before measurements are taken at k = 1, the initial state vector is obtained by applying the distance
measurements as constraints on the x and y coordinates of the unknown MS. The idea in [2], using
known MS positions and the bounding-box algorithm to extrapolate unknown MS positions, inspires us
to choose a prior density for generating initial samples in a proper way. This bounding-box algorithm is
a simple way to localize the unknown MSs with their distance information to the known ones. Figure 2
shows how the distance information can be use to obtain the x and y coordinate bounds for the unknown
MS. Therefore, the unknown MS combines its bounds on the coordinates to form a bounding box, which
provides a good set of initial samples for the particle filtering. The particle filter method is shown in
Table I.
B. Location Adjustment
After obtaining the estimated MS position, location adjustment is executed. Because the particle filter
looses diversity in the samples for static models, the Metropolis-Hastings (M-H) algorithm is used to
generate new samples. Here we summarize the M-H algorithm[15] with the initial value x0(i):
• Set k = 0 and repeat for xk(i), i = 1, 2, . . . , N .
• Draw x′k(i) from the proposal density q(xk(i), ·).
• Set u to a draw from a U(0, 1) distribution.
3
III. COOPERATIVE ESTIMATION FUSION
Based on the relative coordinate system and the refined position estimates in Section II-B, when the
measurement does not meet the required estimation accuracy (e.g. the measurement variance is larger than
the accuracy threshold) or the unknown MS cannot receive sufficient information for position estimation,
the estimated MS, say MSm, may broadcast a fusion message to its neighboring RSs and trigger the
cooperative estimation fusion to resolve conflicts or disagreements, and complement the observations
of the environment. This section introduces the centralized scheme, the progressive scheme, and the
distributed scheme for cooperative position estimation (Figure 3).
Fig. 3. An example of group topology and the approaches for cooperative position estimation: (a) the centralized scheme, (b)
the progressive scheme, and (c) the distributed scheme.
A. Low Mobility
1) The Centralized Scheme: A centralized position estimation scheme is a process structure that all
the neighboring RSs transmit their observations directly to the estimated MS (the central unit) where
the estimation is performed. By means of the given measurements and (2), the approximated probability
density function characterizing the cooperative estimation is obtained with the approaches in Section II-B.
The drawback is that if some RSs are faulty or the observations are corrupted, the fusion among all the
neighboring RSs may deteriorate the estimation accuracy.
2) The Progressive Scheme: The progressive position estimation scheme is a processing structure that
the estimation groups update the estimation result sequentially based on each group’s local observation
and partial decision from it’s previous groups in the sequence without sending data from all RSs to a
central processing unit [3][4]. Hence, only partial estimation results are transmitted through the network.
In this work, the progressive scheme (Table II) is developed based on the particle-based approaches in
5
weighted smaller, which means the weight of the estimate may be described by the inverse proportion of
the utility measure. Therefore, when a neighboring system estimate succeeds the utility measure, it may
cooperate with the local estimate with
ωmℓ =
1
Umℓ∑
k∈Us
1
Umk
, (6)
where Us is the index set of the neighboring estimates that pass the utility test. Otherwise, ωmℓ is set
to be zero. However, when failing the majority of the utility measures (i.e. the local estimate and the
group estimates are non-coherent), another possible approach for MSm is to choose the estimate with
more confidence (less variance), or to exclude its local estimate and fuse the group estimates using
the Covariance Intersection (CI) method [9]. The CI method takes a convex combination of mean and
covariance estimates that are represented in information space. Since these estimates are independent, the
general form is
P−1cc = ω1P
−1
a1a1 + · · ·+ ωnP−1anan , (7)
P−1cc c = ω1P
−1
a1a1a1 + · · ·+ ωnP−1ananan, (8)
where
∑n
i=1 ωi = 1, n > 2, ai is the estimate of the mean from available information, Paiai is the
estimate of the variance from available information, c is the new estimate of the mean, and Pcc is the
new estimate of the variance. The cooperative fusion procedure is summarized in Table III.
TABLE III
THE DISTRIBUTED ESTIMATION FUSION
1. The target MS, say MSm, broadcasts a fusion message.
2. Group nearby two MSs into a measurement system and form the neighboring
Bayesian measurement teams.
3. MSm collects the estimation information from the neighboring multi-Bayesian teams.
4. Use the Mahalanobis distance to test the individual utility measure.
if (the utility measure Umℓ 6 1)
cooperate with the local estimate with ωmℓ =
1
Umℓ∑
k∈Us
1
Umk
, where Us is the index set
of the neighboring estimates that pass the utility test.
else
ωmℓ = 0 (i.e. discard that group estimate)
end
5. When the majority of the utility measures fail
(1) choose the estimate which has more confidence (less variance) or
(2) fuse the group estimates with the CI method.
B. High Mobility
For a MS with high mobility, the progressive scheme and the distributed scheme may result in a
growing location error if the node changes its moving direction or speed. Thus, an unknown MS may
move far from the RSs and is no longer receiving sufficient messages for position estimation. However, a
centralized scheme may be a sensible choice since the local RSs return their current anchor information,
and the unknown MS regards the center of the returned information as its new position.
7
Among these three cooperative estimation methods, the distributed scheme may provide an efficient way
to weight out the faulty nodes and corrupted observations to suppress the estimation error. This is because
if some nodes are faulty or the observations are corrupted, the fusion among all the neighboring nodes
(i.e the centralized scheme) may degrade the estimation performance as shown in Figure 4.
B. Comparison
This subsection compares the localization algorithms from two perspectives: the algorithm perspective
and the network topology perspective. Hence, the probabilistic approximation method (i.e. the particle
filter) and the deterministic methods are investigated from the algorithm perspective. Moreover, the
proposed hierarchical approach and other cluster-based approaches are discussed from the network
topology perspective.
1) Algorithm Perspective: Several deterministic methods are proposed for localization [10], [11], [12],
[13]. For instance, the Min-max method [10], where the main idea is to construct a bounding box for each
reference node using its position and distance measurement, and then to determine the intersection of
these boxes. Notice that the above methods solve the localization problem with a single estimate; the point
algorithm (SPA), where the location estimate is placed at the same position [11]; the centroid algorithm,
where the geometric centroid of the positions of the nodes that generates measurements presents the
location estimate; the smooth weighted centroid algorithm, where the centroid position computation is
weighted by the node likelihood models (e.g. the characteristics of the nodes and the measurements)
[13]. In contrast, the proposed method carries along a complete distribution of position estimation.
The following experiments are conducted in order to depict the weakness and the strength of each
method. Figure 5 depicts the initial position estimation using Min-max [10] and particle filtering. Note
that ’•’ presents the reference node, ’◦’ presents the unknown node, and ’×’ presents the estimated node
location. Min-max method has the advantage of being computationally cheap, but it requires a good
placement for anchors. In Phase I, we use particle filter method with bounding box algorithm to carry
out the initial position estimation. Compared with Min-max (Figure 5 (left)), particle filter method Figure
5 (right)) can give more precise location estimation in initial phase. In addition, the distribution of the
initial position estimate can be used to do refinement.
Fig. 5. Using Min-max and particle filtering for initial position estimation.
0 2 4 6 8 10
0
1
2
3
4
5
6
7
8
9
10
Min−max Algorithm
0 2 4 6 8 10
0
1
2
3
4
5
6
7
8
9
10
Particle Filtering
Given the errors of distance measurements, Figures 6 and 7 depict the position errors of the proposed
method and the SPA [11] schemes. In the absence of measurement noise, the distance between the
unknown node and the reference nodes defines a circle corresponding to possible node locations. Hence,
9
Fig. 7. The average position error of each unknown node with the measurement noise σ2d = 0.1; the proposed method (top
left); the SPA (top right).
0 2 4 6 8 10
0
1
2
3
4
5
6
7
8
9
10
S6
S3
S1
S5
S2
S4
S7
0 2 4 6 8 10
0
1
2
3
4
5
6
7
8
9
10
S6
S3
S7
S2
S5S4
S1
1 2 3 4 5 6 7
0
0.5
1
1.5
Sensor ID
e
rr
o
r 
o
f p
os
itio
n
 
 
error of CHPA
error of SPA
2) Network Topology Perspective: The cluster-based localization approaches are proposed because of
the need for scalability and efficiency. Compared with the registration processes in [11] and [16], the
computational complexity of the proposed method is much lower since the calculations are not easy
to implement for wireless networks. [17] applies a complex multidimensional scaling (MDS) algorithm
[18] to estimate the position of clusterheads. Thus, the cluster members can use clusterheads as reference
nodes. Although this approach achieve reasonable accuracy, computational and communication overheads
are high. In [19], anchor nodes are deployed for deriving the position of adjacent clusterheads such that
this set of nodes with known positions may form a basis for other clusterheads to localize themselves.
The problem with manual entry of position information may limit the size and scalability of a network.
Therefore, the proposed approach may provide an efficient way to build up a coordinate system for
wireless networks.
V. PROJECT PUBLICATIONS
The following works are supported by the National Science Council under the grant No. NSC-98-
2221-E-005-040.
• Chih-Yu Wen∗, Yu-Cheng Hsiao, and Fu-Kai Chan, “Cooperative Anchor-Free Position Estima-
tion for Hierarchical Wireless Sensor Networks,” Sensors, Special Issue on Instrumentation, Signal
Treatment and Uncertainty Estimation in Sensors, vol. 10, no. 2, pp. 1176-1215, February 2010.
(SCI)
11
Sensors 2010, 10, 1176 - 1215; doi:10.3390/s100201176
OPEN ACCESS
sensors
ISSN 1424-8220
www.mdpi.com/journal/sensors
Article
Cooperative Anchor-Free Position Estimation for Hierarchical
Wireless Sensor Networks
Chih-Yu Wen ⋆, Yu-Cheng Hsiao and Fu-Kai Chan
Department of Electrical Engineering, Graduate Institute of Communication Engineering, National
Chung Hsing University, Taichung 402, Taiwan; E-Mails: shaw73324@yahoo.com.tw (Y.-C.H.);
58990006@yahoo.com.tw (F.-K.C.)
⋆ Author to whom correspondence should be addressed; E-Mail: cwen@dragon.nchu.edu.tw;
Tel.: +886-4-22851549 Ext. 811; Fax: +886-4-22851410.
Received: 30 December 2009; in revised form: 27 January 2010 / Accepted: 27 January 2010 /
Published: 1 February 2010
Abstract: This paper proposes a distributed algorithm for establishing connectivity and
location estimation in cluster-based wireless sensor networks. The algorithm exploits the
information flow while coping with distributed signal processing and the requirements
of network scalability. Once the estimation procedure and communication protocol are
performed, sensor clusters can be merged to establish a single global coordinate system
without GPS sensors using only distance information. In order to adjust the sensor
positions, the refinement schemes and cooperative fusion approaches are applied to reduce
the estimation error and improve the measurement accuracy. This paper outlines the technical
foundations of the localization techniques and presents the tradeoffs in algorithm design. The
feasibility of the proposed schemes is shown to be effective under certain assumptions and the
analysis is supported by simulation and numerical studies.
Keywords: anchor-free localization; cooperative estimation fusion; wireless sensor networks
1. Introduction
One of the most needed and challenging components in an ad-hoc wireless network is the development
of practical localization algorithms for the automatic discovery of sensor position. Due to the low power,
lower cost, and simple configuration requirements of wireless sensor networks, GPS devices and the
Sensors 2010, 10 1178
One of the unique features of our algorithm is the “sharing” of distributional data by the various
sensors. This has the obvious intuitive effect of helping to make all the estimates consistent. But it
may also have the effect of spreading misinformation if (for instance) a sensor malfunctions. It should
be possible to include reliability measures that would effectively discard “bad” information. Hence we
explore adding this feature into the basic algorithm to provide extra tolerance to sensor faults, which can
be viewed as an attempt to reduce or remove error propagation.
The organization of this paper is as follows: Section 2 reviews the current literature on the sensor
localization approaches. Section 3 formulates the position estimation problem and derives a hierarchical
solution that relies on a cooperative self-localization protocol [3]. Then, Section 4 investigates the impact
of the measurement errors and the uncertainty associated with the system model on estimation accuracy.
Section 5 summarizes the performance of the proposed localization methodology. Finally, Section 6
draws conclusions and shows future research directions.
2. Related Work
Recent approaches to location discovery often require the availability of GPS on some reference
sensors [4, 5], or assume some sensors with prior position information [6, 7]. In [8], the authors describe
a centralized method using connectivity constraints and convex optimization when some number of
beacon nodes are initialized with known positions. For a wireless ad-hoc network, these assumptions
may not be reasonable because the information may not be available or because of the communication
requirements. In [9, 10], distributed systems for GPS-free positioning in ad-hoc networks are proposed
to establish a relative global coordinate system. However, the computational burden of these procedures
is heavy and their communications overhead is large.
[11] presents a case study of applying particle filters to location estimation for ubiquitous computing.
The performance results shows that it is practical to run particle filters on devices ranging from high-end
servers to handholds. [12] provides a theoretical foundation for the problem of network localization
in which some nodes know their locations and other nodes determine their locations by measuring the
distances to their neighbors. Grounded graphs and graph rigidity theory are applied to construct network
localization. In [13], the Cramer-Rao lower bound (CRLB) is derived for network localization. The
authors argue that besides considering measurement errors, algorithmic errors should be explored in
assessing localization accuracy. In [14, 15], acoustic sensor networks for a relative localization system
are analyzed by reporting the accuracy achieved in the position estimation. The proposed systems are
designed for those applications where objects are not restricted to a particular environment and thus
one cannot depend on any external infrastructure to compute their positions. The proposed mechanisms
efficiently handle multiple acoustic sources by removing false-positive errors that arise from the different
propagation ranges of radio and sound.
In [9, 16, 17], clusters consisting of clusterheads and their cluster members are first localized in order
to build local coordinate systems. Registration is then used to compute the transformations between
neighboring coordinate systems such that the related global coordinate system can be established. The
authors in [18] propose a cluster-based localization approach to provide efficient and scalable localization
in a large and high-density network. [19] proposes to use cluster-based network topology for determining
the position information of the sensor nodes. [20] describes a distributed algorithm for localizing a
Sensors 2010, 10 1180
of the proposed measurement mechanism is presented to assess the achievable estimation accuracy and
to explore the fundamental performance of the algorithm. Specifically, a statistical model is derived
to describe the localization performance considering unreliable measurements, which may provide a
valuable way to show the limits of performance.
3. Cooperative Hierarchical Positioning Algorithm (CHPA)
This section describes a distributed algorithm that forms a relative global coordinate system
efficiently. The localization operation is performed in four phases: “initial local position estimation”,
“position refinement”, “relative global coordinate system”, and “cooperative estimation fusion.” The
main assumptions on the network are that (a) the sensors are in fixed but unknown locations, (b) all links
between sensors are bidirectional, and (c) all sensors have the same transmitting range. Observe that
there is no base station or centralized control to coordinate or supervise activities among sensors.
3.1. Phase I: Initial Local Position Estimation
When sensors of a network are first deployed, they may apply the Clustering Algorithm via Waiting
Timer (CAWT) from [38] to partition the sensors into clusters using the waiting timer
WT
(k+1)
i = γ ·WT (k)i (1)
where WT (k)i is the waiting time of sensor i at time step k and 0 < γ < 1 is inversely proportional
to the number of neighbors. If the random waiting timer expires and none of the neighboring sensors
are in a cluster, then sensor i declares itself a clusterhead. It then broadcasts a message notifying its
neighbors that they are assigned to join the new cluster with ID i. After applying the CAWT, there are
three different kinds of sensors: (1) the clusterheads (2) sensors with an assigned cluster ID (3) sensors
without an assigned cluster ID, which will join any nearby cluster later and become 2-hop sensors. Thus,
the topology of the ad-hoc network is now represented by a hierarchical collection of clusters. Figure 1
(left) shows an example of the cluster formation in a random network of 100 sensors with R/ℓ = 0.175,
where R is the transmission range and ℓ is the side length of the square.
When the estimation procedure starts in a cluster-based network topology, a clusterhead called
sensor 1 locates itself at the origin (0, 0) and selects the left-hand or the right-hand coordinate system as
the local coordinate assignment. Then sensor 1 detects its neighbors and deploys one of the neighboring
sensors, sensor 2, to the x-axis at (d12, 0) based on the distance information d12. A third sensor is
selected to be sensor 3 which has connectivity to both sensors 1 and sensor 2. Given the known positions
of sensors 1 and 2 and distance information, d13 and d23, sensor 3 can estimate its own location to the
responding coordinate system. Therefore, sensors 1, 2 and 3 considered as a group form a basis for
this local coordinate system. The solvability of the network localization problem is detailed in [39],
which suggests that if the three known sensors are no-three-in-line, the network localization problem is
solvable and the unknown position can be determined in the two-dimensional space. Accordingly, all
other sensors which are within communication range of these sensors can then estimate their positions
with respect to this local coordinate system. Similarly, as the cluster of known sensors grows, the location
of each of the unknown sensors can be determined from three neighboring known sensors. Thus, the
Sensors 2010, 10 1182
where the sum is over the nearby sensors xℓk, Im is the index set of estimated known sensors, || · || denotes
the ℓ1-norm ranging measurement, dmℓ represents the measured distance between the sensors and may
be approximated in application by the inverse of the signal strength or by calculated from the time delay
between transmission and reception [40], and the measurement noise vk is another uncorrelated zero
mean Gaussian white noise process.
Figure 2. The x and y coordinate bounds of the unknown sensor can be obtained by the
distance and position information, which provides a good set of initial samples for the
particle filtering.
Table 1. The Particle Filtering Method.
1. Initialization: Generate a set of random samples xk(i), i = 1, 2, . . . , N from the prior density
at time k = 0. Each sample of the state vector is a ‘particle’.
2. Prediction: Each random sample is passed through the state equation to obtain samples from
the prior density at time k + 1. Thus
xˆk+1(i) = Φxk(i) + Γwk(i),
where wk(i) is a sample drawn from the probability density function of the system noise.
3. Measurement Update: The weights of the likelihood function p(zk+1|xˆk+1(i)) are updated
for each sample in the random set i = 1, 2, . . . , N and the normalized weights are
qk+1(i) =
p(zk+1|xˆk+1(i))∑n
j=1
p(zk+1|xˆk+1(j))
for each sample.
4. Resampling: Take N samples with replacement from the random sample set xˆk+1(i),
i = 1, 2, . . . , N , to generate the new sample set xk+1(i).
5. Position: The best single estimate of the position is the mean of xk+1(i), x¯k+1.
Before measurements are taken at k = 1, the initial state vector is obtained by applying the
distance measurements as constraints on the x and y coordinates of the unknown sensor. The idea
in [7], using known sensor positions and the bounding-box algorithm to extrapolate unknown sensor
Sensors 2010, 10 1184
M-H algorithm with the initial value x0(i) in Table 2. The performance evaluation and the discussion of
the proposed location adjustment algorithms are depicted in Section 5.
3.3. Phase III: Relative Global Localization
This section shows how the geometrical and communication requirements change when merging two
coordinate systems to a single one. At some point, as the position estimation proceeds, the coverage
of two coordinate systems begin to overlap, at which time they may be merged together into a single
coordinate system. Eventually, all sensors have been gathered into one coordinate system and the sensor
location problem is solved. If there is GPS (or other absolute measures) available, then this coordinate
system can be referenced to standard measurements. If there are no GPS available, then the coordinate
system is relative.
3.3.1. The Information Flow
The information flow for achieving a global coordinate system in a sensor network is now described.
Table 3 details the messages used to communicate between sensors. The communication protocol starts
when the clusterhead sends a Local signal to its cluster members in order to establish a local coordinate
system. When a sensor has information to share, it can broadcast an Info signal to its neighboring
sensors. Based on the transmission and reception of the Info signals, sensors disseminate and obtain
preliminary information such as estimates of position and distance between nearby sensors. When a
sensor has location information from two coordinate systems, which means it is a shared sensor in two
clusters, it sends a Merge signal that contains information of its estimated positions from two clusters
to its neighboring sensors. After finishing the process of transmitting and receiving the Merge signal,
the border sensors calculate adjustment information, a translation vector
−→
dS and an orthonormal rotation
matrix Rmerge (detailed in Subsection ), for reorienting the coordinate system. Then it transmits an
Adjust message that contains adjustment information to the reoriented cluster in order to convert the two
coordinate systems into a single one, this merging the two clusters into one.
Table 3. The Message Types for Communication.
1. Local - The target sensor, say sensor m, broadcasts a Local message
to build a local coordinate system.
2. Info - When a sensor has information to share, it can broadcast a Info signal
to its neighboring sensors.
3. Merge - A Merge signal contains position information of the shared border sensor.
It is sent when the sensor has location information from two coordinate systems.
4. Adjust - Adjust messages contain instruction that all sensors in the cluster
must update their coordinates to reflect the merging of the clusters.
Sensors 2010, 10 1186
v⃗(1) =
 xi
yi

B
−
 xj
yj

B
. (6)
Thus, the rotation angle θ(1)merge is
θ(1)merge = cos
−1 w⃗(1) · v⃗(1)
|w⃗(1)||v⃗(1)| , 0 ≤ θ
(1)
merge ≤ pi (7)
Then the orthogonal matrixR(1)merge is obtained to encapsulate the rotation operation. With the adjustment
information, the transformed positions of sensors i and j yield
p
′
i =
 x′i
y
′
i

A
= R(1)merge
 xi
yi

B
+
−→
dS (8)
p
′
j =
 x′j
y
′
j

A
= R(1)merge
 xj
yj

B
+
−→
dS (9)
Accordingly, the transformation errors are given by
errorp′i
=
 x′i
y
′
i

A
−
 xi
yi

A
(10)
errorp′j
=
 x′j
y
′
j

A
−
 xj
yj

A
(11)
For case 2, the positions of sensors i and j in the coordinate system of cluster B need to be mirrored
around one of their axes. That is,
pi =
 −xi
yi

B
pj =
 −xj
yj

B
(12)
Thus, the rotation angle θ(2)merge is described as in (7) with
w⃗(2) =
 xi
yi

A
−
 xj
yj

A
(13)
v⃗(2) =
 −xi
yi

B
−
 −xj
yj

B
(14)
and the reoriented positions are
p
′′
i =
 x′′i
y
′′
i

A
= R(2)merge
 −xi
yi

B
+
−→
dS (15)
p
′′
j =
 x′′j
y
′′
j

A
= R(2)merge
 −xj
yj

B
+
−→
dS (16)
As a result, the transformation errors are
errorp′′i
=
 x′′i
y
′′
i

A
−
 xi
yi

A
(17)
Sensors 2010, 10 1188
is larger than the accuracy threshold), the estimated sensor, say sensor m, may broadcast a fusion
message to its neighbors and trigger the cooperative sensor fusion to resolve conflicts or disagreements,
and to complement the observations of the environment. The cooperative estimation system can be
organized by sensor m with collecting the neighboring observations or grouping nearby two sensors into
a measurement system with group IDs based on the neighboring geometric information. This subsection
introduces the centralized scheme, the progressive scheme, and the distributed scheme for cooperative
position estimation (Figure 5).
Figure 5. An example of group topology and the approaches for cooperative position
estimation: (a) the centralized scheme, (b) the progressive scheme, and (c) the
distributed scheme.
3.4.1. The Centralized Scheme
A centralized position estimation scheme is a process structure that all the neighboring sensors
transmit their observations directly to the estimated sensor (the central unit) where the estimation
is performed. By means of the given measurements and (3), the approximated probability density
function characterizing the cooperative estimation is obtained with the approaches in Phases I and II.
The drawback is that if some sensors are faulty or the observations are corrupted, the fusion among all
the neighboring sensors may deteriorate the estimation accuracy.
3.4.2. The Progressive Scheme
The progressive position estimation scheme is a processing structure that the estimation groups
sequentially update the estimation result based on each group’s local observation and partial decision
Sensors 2010, 10 1190
Referring to (19), the weight reflects the significance attached to the estimate, which can be used to
model the reliability of an information. As a result, the next issue is to determine ωmℓ for each estimate
and try to weight out faulty estimates. There are many strategies to choose ωmℓ. One scheme is to use the
utility measure. Since the utility of a sensor measurement is a function of the geometric location of the
sensors, here we consider the Mahalanobis measure [49]. Hence, with respect to a neighboring system
estimate characterized by the mean µmℓ and covariance Σ, the utility function for sensor m is defined as
the geometric measure
Umℓ = (µm0 − µmℓ)TΣ−1(µm0 − µmℓ) (20)
where µm0 is the local estimated position of sensor m and ℓ = 1, 2, . . . , Nc. That is, the utility measure
is based on the Mahalanobis measure of the local estimate to a neighboring system estimate. In order to
arrive at a consensus, the utility measure Umℓ can be shown to be Umℓ ≤ 1 [50].
Table 5. The Distributed Estimation Fusion.
1. The target sensor, say sensor m, broadcasts a fusion message to form the neighboring
Bayesian measurement groups.
3. Sensor m collects the estimation information from the neighboring multi-Bayesian groups.
4. Use the Mahalanobis distance to test the individual utility measure.
if (the utility measure Umℓ1)
cooperate with the local estimate with ωmℓ =
1
Umℓ∑
k∈Us
1
Umk
, where Us is the index set
of the neighboring estimates that pass the utility test.
else
ωmℓ = 0 (i.e., discard that group estimate)
end
5. When the local estimate and the group estimates are non-coherent
(1) choose the estimate which has more confidence (less variance) or
(2) exclude the local estimate and fuse the group estimates with the CI method.
Given the utility measure, two estimates can be allowed to be compared in a common framework and
measure how much they differ |µm0 − µmℓ|. For a larger Umℓ, the neighboring system estimate may be
weighted smaller, which means the weight of the estimate may be described by the inverse proportion of
the utility measure. Therefore, when a neighboring system estimate succeeds the utility measure, it may
cooperate with the local estimate with
ωmℓ =
1
Umℓ∑
k∈Us
1
Umk
(21)
where Us is the index set of the neighboring estimates that pass the utility test. Otherwise, ωmℓ is set to
be zero. However, when the local estimate and the group estimates are non-coherent (i.e., Umℓ > 1, ∀ ℓ),
another possible approach for sensor m is to choose the estimate with more confidence (less variance),
or to exclude its local estimate and fuse the group estimates using the Covariance Intersection (CI)
Sensors 2010, 10 1192
Figure 6. Two examples showing the way to compute the unknown sensor position (xe, ye)
by triangulation using known distance and position information.
Due to the errors in distance measurement, the position and distance estimates may be described by
normal random variables. Let Dij denote the normal random variable for the distance estimate between
a pair of sensors i and j with Dij ∼ N(µDij , σ2Dij). Let Xi and Yi be the normal random variables
for the known estimated x and y coordinates of sensor i, respectively, with Xi ∼ N(µXi , σ2Xi) and
Yi ∼ N(µYi , σ2Yi). Now we rewrite (24) as
Xe = W1 +W2 (28)
where the random variables
W1 =
Dce′Xa +Dae′Xc
Dae′ +Dce′
(29)
W2 = Dae ·W3 · W4
W5
(30)
W3 =
Yc − Ya
Xc −Xa (31)
W4 = sinα = sin
(
arccos
(
D2ae +D
2
ac −D2ce
2DaeDac
))
=
√√√√1− (D2ae +D2ac −D2ce
2DaeDac
)2
(32)
W5 =
√
1 + (
Yc − Ya
Xc −Xa )
2 =
√
1 +W 23 (33)
W6 =
Dce′Ya +Dae′Yc
Dae′ +Dce′
(34)
For the random variableW1, let us first consider the distribution function of Dae′ . Based on Figure 6,
the random variable Dae′ is
Dae′ = Dae cosα =
V
2Dac
(35)
where V = D2ae + D
2
ac − D2ce. Thus, the random variable V is the weighted sum of quadratic forms
of independent normal random variables (i.e., a linear combination of noncentral chi-squared random
Sensors 2010, 10 1194
σ2W3 =
µ2M1σ
2
M2
µ4M2
+
σ2M1
µ2M2
(47)
For the random variable W4 (32), it can be further expressed by W4 =
√
1−Q2, where the random
variable Q = V/(2DaeDac) and the random variable V is defined as in (36). Hence, the density function
of Q is given by
Q ∼ N(µQ, σ2Q) (48)
with
µQ =
µV
2µDaeµDac
(49)
σ2Q =
4µ2Q(µ
2
Daeσ
2
Dac + µ
2
Dacσ
2
Dae) + σ
2
V
4µ2Daeµ
2
Dac
(50)
With Taylor development ofW4 at µQ, we obtain
W4 ≈
√
1− µ2Q −
µQ√
1− µ2Q
(Q− µQ) (51)
Therefore, the density function of W4 is approximated by W4 ∼ N(µW4 , σ2W4) with µW4 =
√
1− µ2Q
and σ2W4 = µ
2
Qσ
2
Q/(1 − µ2Q). Similarly, for W5 defined as in (33), with Taylor development at µW3 and
applying the density function ofW3, the density function may be approximated byW5 ∼ N(µW5 , σ2W5)
with µW5 =
√
1 + µ2W3 and σ
2
W5
= µ2W3σ
2
W3
/(1 + µ2W3).
Accordingly, referring to (30) and applying the normal approximation techniques, the density function
of the random variableW2 yields
W2 ∼ N(µW2 , σ2W2) (52)
with
µW2 =
µDaeµW3µW4
µW5
(53)
σ2W2 = µ
2
Daeµ
2
W3
(
σ2W5µ
2
W4
µ4W5
+
σ2W4
µ2W5
)
+
µ2W4
µ2W5
(
µ2Daeσ
2
W3
+ µ2W3σ
2
Dae
)
(54)
Thus, the density function of the estimated x coordinateXe isXe ∼ N(µXe , σ2Xe) with µXe = µW1+µW2
and σ2Xe = σ
2
W1
+ σ2W2 , where µW1 , σ
2
W1
, µW2 , and σ
2
W2
are described as in (43), (44), (53), and (54),
respectively.
For the estimated y coordinate Ye, it can be rewritten as
Ye = W6 ±Dae · W4
W5
(55)
Following the same analysis procedures for Xe and applying the normal approximations, the density
function yields
Ye ∼ N(µYe , σ2Ye) (56)
with
µYe = µW6 ± µDae
µW4
µW5
(57)
σ2Ye = σ
2
W6
+ µ2Dae
(
σ2W5µ
2
W4
µ4W5
+
σ2W4
µ2W5
)
+
σ2Daeµ
2
W4
µ2W5
(58)
Sensors 2010, 10 1196
where
M(a) =
1√
2pi
∫ a
−∞
e−t
2/2dt (65)
In order to estimate the position, at least three nearby location-aware sensors are needed. Without loss
of generality, let the neighboring sensor ID be ℓ = 1, 2, and 3 and assume that the folded normal random
variables are independent, which is a reasonable condition in our case. Thus, the distribution of the sum
of the folded normals Sm =
∑3
ℓ=1 Fmℓ can be derived by convolution, which is
hSm(sm) =
2
pi
√√√√ 1
(σ2Fm1 + σ
2
Fm2
)σ2Fm3
∫ sm
0
eA(x) [erf (σFm1B(x)) + erf(σFm2B(x))] dx, sm ≥ 0 (66)
withA(x) = −x2/2(σ2Fm1+σ2Fm2)+(sm−x)2/2σ2Fm3 andB(x) = x/
√
2σ2Fm1σ
2
Fm2
(σ2Fm1 + σ
2
Fm2
), where
erf(·) is the error function and σ2Fmℓ is described as in (64), which is related to the variances of position
and distance estimates.
Suppose that the measurement noise is negligible. Thus the distribution of the random measurement
term Zm may be described by (66), which highly depends on the deviations of estimated anchor positions
and estimated distances. Observe that the measurement term Zm is actually a way to depict estimation
accuracy of the system since the objective is to minimize the estimation error. Based on the above
settings, (66) may also represent an ideal measurement performance for realistic estimation experiments.
However, with the deviations of distance estimates, in order to suppress the measurement error we may
obtain inaccurate localization results though using the anchor sensors with accurate position information.
In other words, when applying the particle filtering methodology, the measurement term Zm of sensor m
may weight out the best possible particles due to the incorrect distance information. The measurement
performance will be illustrated and further discussed in Section 5.
4.3. Complexity Analysis
When developing the local position estimation (Phase I), one round of local flooding is initiated in
order to gather distance information. Then, the distance and position information from the nearby three
nodes are applied to estimate its own position. Thus, the time complexity is O(1) round.
Suppose that the total power requirements include the power required to transmit messages ET ,
the power required to receive ER, and the power required to process EP . Therefore, the total energy
consumption for initial local positioning in the network is EL = N
(L)
T ·ET +N (L)R ·ER+N (L)P ·EP with
N
(L)
T = NS, N
(L)
R =
NS∑
i=1
Ni, N
(L)
P = NS (67)
where NS is the number of sensors in the network and Ni is the number of the neighboring sensors of
sensor i. Thus, for a sensor node, the average energy consumption yields EL/NS . Given the energy
consumption analysis above, the communication complexity for establishing the local coordinate system
in the network and for estimating the position of a sensor node are O(NS) and O(1), respectively.
Due to the error caused by the location estimation algorithm (the estimation error) and the error
intrinsic to the problem (noisy distance measurements), location adjustment algorithms (Phase II) are
needed in order to improve the estimation accuracy and limit the propagation errors. Once the position
Sensors 2010, 10 1198
estimation fusion. The energy consumption is given by ECD = N
(D)
T ·ET +N (D)R ·ER+N (D)P ·EP with
N
(D)
T = 2 ·NEG, N (D)R =
∑
j∈G(i)
b
Nj, N
(D)
P = NEG + 1 (73)
Similar to the progressive scheme, the communication complexity due to transmitting the observations
and group decisions is O(2NEG).
5. Experiments and Discussion
In order to assess the performance of the proposed methodology, the feasibility of the proposed
schemes is examined via simulation and numerical results. In the following experiments, the particle
filtering methodology is applied with the number of samples N = 500.
5.1. Initial Position Estimation
In this section we present the result of initial local position estimation by placing three reference
nodes and one unknown node over the sensing field 10×10 units in size and assuming that this unknown
node connects with all reference nodes. The positions of the three reference nodes are (7,3), (3,8),
(1,4) and the true position of this unknown node is (4,1). Figures 7 (a)-(c) show the procedures of
initial position estimate by using particle filter method with the bounding box algorithm. “•” represents
the reference node, “◦” represents the unknown node, “·” represents the particle and “×” represents
the initial estimated sensor location. The estimation error of the initial position estimate is shown in
Figure 7 (d), which depicts that the estimation error converges to 0.5 quickly after a few iterations.
Figure 8 shows the resulting initial position estimation for a network of 25 nodes with 3 reference
nodes, which suggests that the particle filter method with bounding box algorithm provides an acceptable
performance of initial position estimation.
5.2. Performance of Theoretical Approximation
This set of experiments compares the initial position estimation of an unknown sensor using particle
filtering and the theoretical approximation derived in Section 4.2. We consider the uncertainty of position
estimation and distance measurement and then use the estimated distributions from other known sensors
to get the distribution of the position estimate of the unknown sensor. Let σD and σP denote the distance
deviation and position deviation, respectively. Suppose that the true position of the unknown sensor
m is (17,30) and the position distributions of three known sensors are N(µP 1 , σ2P 1), N(µP 2 , σ
2
P 2), and
N(µP 3 , σ
2
P 3) with µP 1 = (0, 0), µP 2 = (23, 70), µP 3 = (50, 0), σDm1 = σDm2 = σDm3 = σD, and
σP 1 = σP 2 = σP 3 = σP . In the simulation, we sample the distributions of the position estimates
obtained from three known sensors and the distributions of the distance estimates 200 times in order to
get the possible values for the particle filtering. Then we fuse these 200 distributions to get the possible
position distribution of the unknown sensor using the Covariance Intersection (CI) method described as
in Equations (22) and (23). In this set of experiments, we choose to weight each typical run equally.
Sensors 2010, 10 1200
Given the deviations at distance and position information, Figure 9 shows the distributions
of simulation results and the theoretical approximation of initial position estimates with unbiased
distance and position information (top left) and biased distance measurements (top right), respectively.
Figure 9 (bottom) shows the standard deviation of the mean value of position estimates. The plot varies
the variance of the distance measurement. Observe that Figures 9 demonstrates that the approximated
probability density function can well describe the measurement performance, which implies that the
approximation may be a sensible way to assess the estimation process of an unknown sensor under the
circumstances with ranging and positioning errors of known sensors.
Figure 9. The distributions of simulation results and the theoretical approximation of initial
position estimates with unbiased distance and position information (top left) and biased
measurement information (top right); the estimated sensor position versus the variance of
the distance measurement for simulation results and theoretical approximation (bottom).
10 15 20 25 30 35 40
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
Estimated X− and Y− Positions
Simulation: σ2P = 0.5, σ
2
D = 0.50
Analysis: σ2P = 0.5, σ
2
D = 0.50
Simulation: σ2P = 1.25, σ
2
D = 2.0
Analysis: σ2P = 1.25, σ
2
D = 2.0
10 15 20 25 30 35 40
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
Estimated X− and Y− Positions
Simulation: σ2P = 0.25, σ
2
D = 0.50, Dbias = 1.0
Analysis: σ2P = 0.25, σ
2
D = 0.50, Dbias = 1.0
Simulation: σ2P = 0.25, σ
2
D = 2.25, Dbias = 2.0
Analysis: σ2P = 0.25, σ
2
D = 2.25, Dbias = 2.0
0 1 2 3 4 5 6 7
15
20
25
30
35
40
Variance of Estimated Distance σ2D
Es
tim
at
ed
 X
− 
an
d 
Y−
 P
os
itio
ns
Analysis: σ2P = 0.5
Simulation: σ2P = 0.5
5.3. Measurement Performance
Due to the errors occurring in the distance estimation, the following special case is studied to explore
the impact of the ranging error on the performance of random measurement term. Assume that the
Sensors 2010, 10 1202
5.4.1. Proposal Density I
By adopting this density, the proposed particles are generated from a random walk x′k(i) = xk(i)+σε1
(random walk Metropolis-Hastings). From the work in [59], it recommends that if the proposal density
is normal, then the acceptance rate should be around 0.45 for the random walk chain. Here, we adjust
the parameters to achieve an acceptance rate of 0.4 to 0.5. Figures 11 (a,b) demonstrate the initial
position estimation with perfect distance measurements (σ2d = 0). The simulation results of the sensor
location estimation and the estimation error are shown in Figure 11 (c), which shows the ability of the
sensor location algorithm detailed in Section 3.2. to locate all n = 10 sensors using only distance (e.g.,
received signal strength or time-of-arrival) information. In Figure 11 (d), the error propagation within
the network is shown to be suppressed by applying the Metropolis-Hastings algorithm. As the number
of iteration increases, a high acceptance rate will be achieved. In this case, accepted particles are taking
distinct but very close values compared with the current state estimate.
5.4.2. Proposal Density II
Instead of using only information from the current state estimate, the complete current distribution of
samples may be used to generate the proposed particles. To evaluate the performance, the same network
layout and the number of samples as that of the system with proposal density I are used. Figures 11
(e,f) illustrate the performance of the sensor location algorithm with proposal density II. Compared with
Figure 11 (d,f) demonstrates that using proposal density II gives more precise sensor location estimates,
less estimation error, and less error propagation. In addition, a faster speed of convergence in location
estimate is achieved. This is attributed to the fact that more sampling diversity is introduced and the
sample impoverishment problem is alleviated.
5.4.3. Resampling
The key point with resampling is to prevent a high concentration of probability mass at a few particles.
Here we investigate the importance of resampling after carrying out the MCMC steps. For comparison,
a particle filter using the same network structure and the number of particles is applied to the samples
drawn from proposal density I with resampling, proposal density I without resampling, proposal density
II with resampling, and proposal density II without resampling, respectively. The simulations based
on these different approaches are shown in Figures 11 and 12. In these tests, the performances of the
methods applying resampling (Figures 11 (d,f) are superior to those of approaches without resampling
(Figures 12 (d,f)). This shows how the degeneracy problem with the MCMC steps can be reduced by
using a resampling scheme.
Sensors 2010, 10 1204
Figure 12. (a)(b) demonstrate the initial position estimation; (c)(d) show the sensor location
adjustment and the estimation error by using distance information and proposal density I
without resampling; (e)(f) show the sensor location adjustment and the estimation error by
using distance information and proposal density II without resampling, where σ2d = 0 and
σ2ε = 0.5.
0 2 4 6 8 10
0
1
2
3
4
5
6
7
8
9
10
Xk
(a)
Yk
0 2 4 6 8 10
0
1
2
3
4
5
6
7
8
9
10
Xk
(b)
Yk
0 2 4 6 8 10
0
1
2
3
4
5
6
7
8
9
10
Xk
(c)
Yk
0 5 10 15 20
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
The number of iterations
(d)
Es
tim
at
io
n 
er
ro
r
0 2 4 6 8 10
0
1
2
3
4
5
6
7
8
9
10
Xk
(e)
Yk
0 5 10 15 20
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
The number of iterations
(f)
Es
tim
at
io
n 
er
ro
r
Sensors 2010, 10 1206
Figure 13. (a)(b) demonstrate the initial position estimation; (c)(d) show the sensor location
adjustment and the estimation error by using distance information and proposal density
I; (e)(f) show the sensor location adjustment and the estimation error by using distance
information and proposal density II, where σ2d = 0.1 and σ
2
ε = 0.5.
0 2 4 6 8 10
0
1
2
3
4
5
6
7
8
9
10
Xk
(a)
Yk
0 2 4 6 8 10
0
1
2
3
4
5
6
7
8
9
10
Xk
(b)
Yk
0 2 4 6 8 10
0
1
2
3
4
5
6
7
8
9
10
Xk
(c)
Yk
0 5 10 15 20 25 30
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
The number of iterations
                      (d)                     
Es
tim
at
io
n 
er
ro
r
0 2 4 6 8 10
0
1
2
3
4
5
6
7
8
9
10
Xk 
(e)
Yk
0 5 10 15 20 25 30
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
The number of iterations
(f)
Es
tim
at
io
n 
er
ro
r
Observe that in the case of good distance observations and a moderate position deviation, Figure 16
depicts that the estimated sensor may still obtain acceptable position estimate without cooperation. On
the other hand, with poor distance observations, the cooperative techniques may be good approaches to
improve the estimation accuracy.
Sensors 2010, 10 1208
Figure 16. The comparison of position estimation with and without cooperative fusion
schemes for different variances of the distance measurement; σ2P = 0.01 (left) and σ
2
P = 1
(right); the position error PmE = ||Pmtrue − Pmestimate|| for sensor m.
0 0.5 1 1.5 2 2.5 3
0
0.5
1
1.5
2
2.5
3
3.5
4
σ2D
Po
si
tio
n 
Er
ro
r P
E 
(m
)
 
 
Original Estimate 
Centralized Scheme
Distributed Scheme
Progressive Scheme
0 0.5 1 1.5 2 2.5 3
0
0.5
1
1.5
2
2.5
3
3.5
4
σD
2
Po
si
tio
n 
Er
ro
r P
E 
(m
)
 
 
Original Estimate 
Centralized Scheme
Distributed Scheme
Progressive Scheme
as shown in Figure 16.
5.7. Comparison
This subsection compares the localization algorithms from two perspectives: the algorithm
perspective and the network topology perspective. Hence, the probabilistic approximation method
(i.e., the particle filter) and the deterministic methods are investigated from the algorithm perspective.
Moreover, the proposed hierarchical approach and other cluster-based approaches are discussed from the
network topology perspective.
5.7.1. Algorithm Perspective
Several deterministic methods are proposed for sensor localization [7, 9, 60, 61]. For instance, the
Min-max method [7], where the main idea is to construct a bounding box for each reference node
using its position and distance measurement, and then to determine the intersection of these boxes.
Notice that the above methods solve the localization problem with a single estimate; the point algorithm
(SPA), where the location estimate is placed at the same position [9]; the centroid algorithm, where
the geometric centroid of the positions of the sensors that generates measurements presents the location
estimate; the smooth weighted centroid algorithm, where the centroid position computation is weighted
by the sensor likelihood models (e.g., the characteristics of the sensors and the measurements) [61]. In
contrast, the proposed CHPA method carries along a complete distribution of position estimation.
The following experiments are conducted in order to depict the weakness and the strength of each
method. Figure 17 depicts the initial position estimation using Min-max [7] and particle filtering.
Note that “•” represents the reference node, “◦” represents the unknown node, and “×” represents the
estimated sensor location. Min-max method has the advantage of being computationally cheap, but
it requires a good placement for anchors. In Phase I, we use particle filter method with bounding box
algorithm to carry out the initial position estimation. Compared with Min-max (Figure 17 (left)), particle
Sensors 2010, 10 1210
Figure 18. The average position error of each unknown sensor with the measurement noise
σ2d = 0.01; the proposed CHPA (top left); the SPA (top right).
0 2 4 6 8 10
0
1
2
3
4
5
6
7
8
9
10
S1
S6
S3
S7
S2
S4
S5
0 2 4 6 8 10
0
1
2
3
4
5
6
7
8
9
10
S1
S6
S3
S7
S4
S2
S5
1 2 3 4 5 6 7
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
Sensor ID
e
rr
o
r 
o
f p
os
itio
n
 
 
error of CHPA
error of SPA
proposed method (detailed in Section 4.3.) is much lower since the calculations are not easy to implement
for wireless sensor networks. [18] applies a complex multidimensional scaling (MDS) algorithm [62] to
estimate the position of cluster heads. Thus, the cluster members can use clusterheads as reference nodes.
Although this approach achieve reasonable accuracy, computational and communication overheads are
high. In [19], anchor nodes are deployed for deriving the position of adjacent clusterheads such that
this set of nodes with known positions may form a basis for other clusterheads to localize themselves.
The problem with manual entry of position information may limit the size and scalability of a sensor
network. Therefore, the proposed CHPA approach may provide an efficient way to build up a coordinate
system for wireless sensor networks.
6. Conclusions
We propose a distributed algorithm for the sensor positioning problem in hierarchical wireless sensor
networks. By performing the proposed estimation procedures, a single global coordinate system can be
established without GPS sensors using only distance information. In order to elevate the estimation
accuracy, the Markov chain Monte Carlo (MCMC) steps may be applied to reduce the estimation
error such that the propagation error can be suppressed. In the case of poor observations, cooperative
estimation fusion schemes are proposed to complement the measurements of the environment and
improve the estimation accuracy. Furthermore, the same basic approach can also solve the tracking
Sensors 2010, 10 1212
References
1. Doucet, A.; de Freitas, N.; Gordon, N. Sequential Monte Carlo Methods in Practice;
Springer-Verlag: New York, NY, USA, 2001.
2. Gordon, N.J.; Salmond, D.J.; Smith, A.F.M. Novel approach to nonlinear/non-gaussian bayesian
state estimation. Proc. IEEE 1993, 140, 107–113.
3. Wen, C.Y.; Hsiao, Y.C. Decentralized anchor-free localization for wireless ad-hoc sensor networks.
In Proceedings of IEEE International Conference on Systems, Man, and Cybernetics, Singapore,
October 2008; pp. 2777–2785.
4. Bahl, P.; Padmanabhan, V.N. RADAR: An in-building rf based user location and tracking system.
In Proceedings of IEEE INFOCOM, Tel Aviv, Israel, March 26–30, 2000; pp. 775–784.
5. Yedavalli, K.; Krishnamachari, B. Sequence-based localization in wireless sensor networks. IEEE
Trans. Mob. Comput. 2008, 7, 81–94.
6. Savarese, C.; Rabaey, J.M.; Beutel, J. Locating in distributed ad-hoc wireless sensor networks.
In Proceedings of ICASSP, Salt Lake City, UT, USA, May 7–11, 2001; pp. 2037–2040.
7. Savvides, A.; Han, C.C.; Srivastava, M.B. Dynamic fine-grained localization in ad-hoc networks
of sensors. In Proceedings of ACM SIGMOBILE, Rome, Italy, July 16–21, 2001; pp. 166–179.
8. Doherty, L.; Pister, K.; Ghaoui, L.E. Convex position estimation in wireless sensor networks.
In Proceedings of IEEE INFOCOM, Anchorage, AK, USA, April 2001; pp. 1655–1663.
9. Capkun, S.; Hamdi, M.; Hubaux, J.P. GPS-free positioning in mobile ad-hoc networks.
In Proceedings of the 34th Hawaii International Conference on System Sciences, Maui, HI, USA,
January 3–6, 2001; pp. 3481-3490.
10. Iyengar, R.; Sikdar, B. Scalable and distributed GPS free positioning for sensor networks.
In Proceedings of IEEE International Conference on Communications, Anchorage, AK, USA,
May 11–15, 2003; pp. 338–342.
11. Hightower, J.; Borriello, G. Particle filters for location estimation in ubiquitous computing:
A case study. In Proceedings of the Sixth International Conference on Ubiquitous Computing,
Nottingham, UK, September 7–10, 2004; pp. 88–106.
12. Eren, T.; Goldenberg, D.; Whiteley, W.; Yang, Y.R.; Morse, A.S.; Anderson, B.; Belhumeur,
P. Rigidity, computation, and randomization in network localization. In Proceedings of IEEE
INFOCOM, Hong Kong, China, March 7–11, 2004; pp. 2673–2684.
13. Savvides, A.; Garber, W.; Adlakha, S.; Moses, R.; Srivastava, M.B. On the error characteristics
of multihop node localization in ad-hoc sensor networks. In Proceedings of IPSN, Palo Alto, CA,
USA, April 22–23, 2003; pp. 317-332.
14. DeMarziani, C.; Urena, J.; Hernandez, A.; Mazo, M.; Garcia, J.J.; Jimenez, A.; PerezRubio, M.C.;
Alvarez, F.; Villadangos, J.M. Acoustic sensor network for relative positioning of nodes. Sensors
2009, 9, 8490–8507.
15. Kim, Y.G.; Ahn, J.H.; Cha, H.J. Locating acoustic events based on large-scale sensor networks.
Sensors 2009, 9, 9925–9944.
16. Niculescu, D.; Nath, B. DV based positioning in ad hoc networks. Kluwer J. Telecommun. Syst.
2003, 22, 267–280.
Sensors 2010, 10 1214
32. Gustafsson, F.; Gunnarsson, F. Mobile positioning using wirelsss networks. IEEE Signal Process.
Mag. 2005, 22, 41–53.
33. Sayed, A.H.; Tarighat, A.; Khajehnouri, N. Network-based wireless location. IEEE Signal Process.
Mag. 2005, 22, 24–40.
34. Luo, J.; Shukla, H.V.; Hubaux, J.P. Non-interactive location surveying for sensor networks with
mobility-differentiated TOA. In Proceedings of the 25th IEEE INFOCOM, Barcelona, Spain, April
23–29, 2006; pp. 1–12.
35. Tang, H.; Park, Y.W.; Qiu, T.S. A TOA-AOA-based NLOS error mitigation method for location
estimation. EURASIP J. Adv. Signal Process. 2008, 8, 1–14.
36. Guvenc, I.; Chong, C.C. A survey on TOA based wireless localization and NLOS mitigation
techniques. IEEE Commun. Surv. Tutorials 2009, 11, 107–124.
37. Savvides, A.; Girod, M.S.L.; Estrin, D. Localization in sensor networks. In Wireless Sensor
Networks; Kluwer Academic Publishers: Boston, MA, USA, 2004.
38. Wen, C.Y.; Sethares, W.A. Automatic decentralized clustering for wireless sensor networks.
EURASIP J. Wirel. Commun. Netw. 2005, 5, 686–697.
39. Aspnes, J.; Eren, T.; Goldenberg, D.K.; Morse, A.S.; Whiteley, W.; Yang, Y.R.; Anderson,
B.D.O.; Belhumeur., P.N. A theory of network localization. IEEE Trans. Mob. Comput. 2006,
5, 1663–1678.
40. Wen, C.Y.; Morris, R.D.; Sethares, W.A. Distance estimation using bidirectional communications
without synchronous clocking. IEEE Trans. Signal Process. 2007, 55, 1927–1939.
41. Chib, S.; Greenberg, E. Understanding the Metropolis-Hastings algorithm. Am. Statist. 1995,
49, 327–335.
42. Chu, K.T.; Wen, C.Y.; Ouyang, Y.C.; Sethares, W.A. Adaptive distributed topology control for
wireless ad hoc sensor networks. In Proceedings of the First International Conference on Sensor
Technologies and Applications, Valencia, Spain, October 14–20, 2007; pp. 378–386.
43. Bachrach, J.; Taylor, C. Localization in sensor networks. In Handbooks of Sensor Networks:
Algorithms and Architectures; John Wiley & Sons: Hoboken, NJ, USA, 2005; pp. 277–310.
44. Horn, B.K.P.; Hilden, H.; Negahdaripour, S. Closed-form solution of absolute orientation using
orthonormal matrices. J. Opt. Soc. Am. 1988, 5, 1127–1135.
45. Wang, X.L.; Qi, H.R.; Beck, S.; Du, H.T. Progressive approach to distributed multiple-target
detection in sensor networks. In Sensor Network Operations; John Wiley & Sons: Hoboken, NJ,
USA, 2006; pp. 486–503.
46. Hanebeck, U.D.; Briechle, K.; Rau, A. Progressive bayes: A new framework for nonlinear state
estimation. In Proceedings of SPIE AeroSense Symposium, Orlando, FL, USA, April 21, 2003;
Volume 5099, pp. 256–267.
47. Kotecha, J.H.; Djuric, P.M. Gaussian particle filtering. IEEE Trans. Signal Process. 2003,
51, 2592–2601.
48. Stone, M. The opinion pool. Ann. Stat. 1961, 32, 1339–1342.
49. Zhao, F.; Guibas, L. Wireless Sensor Networks: An Information Processing Approach; Morgan
Kaufmann: San Fransisco, CA, USA, 2004.
AOA-Aided TOA Distributed Positioning for Mobile
Wireless Sensor Networks
Fu-Kai Chan and Chih-Yu Wen
Department of Electrical Engineering/GICE
National Chung Hsing University
Taichung 402, Taiwan, R.O.C.
{cwen@dragon.nchu.edu.tw}
Abstract—Location-awareness is crucial and becoming in-
creasingly important to many applications in wireless sensor
networks. This paper presents a network-based positioning sys-
tem and outlines recent work in which we have developed an
efﬁcient principled approach to localize a mobile sensor using an
TOA/AOA hybrid positioning scheme employing multiple seeds
in the line-of-sight scenario. The proposed algorithm exploits the
information ﬂow while coping with distributed signal processing
and the requirements of network scalability. The feasibility of
the proposed scheme is shown to be effective under certain
assumptions and the analysis is supported by simulation and
numerical studies.
Index Terms—Localization, Sensor networks, TOA/AOA.
I. INTRODUCTION
One of the most needed and challenging components in
a wireless sensor network is the development of practical
localization algorithms for the automatic discovery of sensor
position. Due to the low power, lower cost, robust and dis-
tributed internal algorithms are required for sensor positioning
problems. Common ranging techniques used for location es-
timate include: receiver signal strength indicator (RSSI), time
of arrival (TOA), time difference of arrival (TDOA) and angle
of arrival (AOA).
For TDOA, centralized sophisticated estimation schemes
may lead to computation-intensive problems [1], and in order
to suppress the estimation error, a large amount of distance
estimates have to be processed for each target node [2][3],
which may not be practical in wireless sensor networks. For
conventional TOA location algorithm, at least three TOA
information must be obtained from three nodes with known
positions given line-of-sight (LOS) propagation paths. In order
to make location estimate in most propagation environments,
some available information, such as signal strength and AOA
information, could be used altogether to achieve the location
estimate. Thus, a hybrid algorithm, an TOA positioning system
with aided AOA information, may be employed in most
propagation environments.
In general, the localization problem can be solved by
the joint TOA/AOA positioning scheme using a single seed.
However, in the case of poor observations, more AOA-aided
TOA measurements may be applied to complement the mea-
surements of the environment. In this paper, we introduce an
TOA/AOA hybrid positioning scheme, the AOA-aided TOA
Positioning Algorithm (ATPA), employing multiple seeds in
the LOS scenario and present a network-based positioning
system considering the relative movement between the seed
and the mobile sensor. Assume that the clocks of the seeds and
the mobile sensors with unknown positions are synchronized
and the target sensor will not dramatically change its moving
direction. Moreover, assume the seeds broadcast their position
information periodically. The goal of the proposed scheme is
to estimate the target position coincided with the broadcasting
time stamp of the seeds.
The operation of the proposed ATPA can be regarded as the
reverse operation of TDOA, which allows all mobile sensors
to obtain adequate observations and to localize themselves
by passively listening to the seeds without interfering with
each other. Accordingly, the ATPA positioning scheme per-
forms location estimation in two phases: (I) AOA-Aided TOA
Measurement and (II) Geometrical Positioning with Particle
Filtering. In Phase I, since the movement of a target sensor
introduces differences between arrival times of the signals from
seeds, the aided AOA information may be used to modify the
TOA measurements (detailed in Section III-A), which can be
applied to compute the location estimates. In Phase II, the
Bayesian particle filter [4] is used to estimate the unknown
sensor position from state equations (detailed in Section III-B).
The objective is to find feasible position to make the error of
state vector minimum.
This paper is organized as follows: Section II reviews the
literatures on hybrid TOA/AOA positioning schemes. Section
III describes the approach of proposed scheme. Section IV
derives the performance bound for position estimation in terms
of minimum achievable error. In Section V, we evaluate the
effects of the variations of critical parameters on position esti-
mation. By comparing the TDOA-based positioning technique,
the benefit of the ATPA is highlighted. The final section makes
a conclusion and shows future research directions.
II. LITERATURE REVIEW
Mobile location with TOA/AOA information at a single
base station is first proposed in [5]. The authors in [6] analyze
the location accuracy of an TOA/AOA hybrid algorithm with
a single base station in the LOS scenario. Deng and Fan
[7] introduce an TOA/AOA location algorithm with multiple
base stations. However, the speed of the mobile station is
assumed to be very low and the relative movement between
1774978-1-4244-5046-6/10/$26.00 c©2010 IEEE
1) Distance Measurements: Assume the target sensor m
obtains new measurements from neighboring seeds and esti-
mates its own position using the particle filter. The position of
the target sensor is given by the discrete-time state equation
xk = Φxk−1 + Γwk, (3)
where xk is the position of the mobile sensor and wk is an un-
correlated Gaussian diffusion term describing the uncertainty.
Note that this system equation is suitable for many different
systems and the only changes will be the matrixes Φ and Γ,
which depend on the system model.
The measurement term for the target sensor m is
zk =
∑
∈Hm
∣∣|xmk − xk| − dm∣∣+ vk (4)
where the sum is over the nearby seeds with location xk, dm
represents the measured distance between the estimated target
sensor m and seed S and may be approximated in application
by the inverse of the signal strength or by calculated from
the time delay between transmission and reception [16]; the
measurement noise is another uncorrelated zero mean Gaussian
white noise process; the set Hm is the chosen seeds for the
measurement.
2) Geometrical Positioning: Particle filter is an algorithm
of estimation used to estimate the unknown sensor position
from state equations. The objective is to find feasible position
to make the error of state vector x minimum. The state
vector is represented as a set of random samples updated and
propagated with the algorithm. One of the main advantages
of this approach is that the mobile sensor carries along a
complete distribution of estimates of its position. Therefore,
the distribution is inherently a measure of the accuracy of the
positioning system - hence, if a given task requires a certain
accuracy, it is possible to determine if that level of accuracy
is currently available. Moreover, [17] presents a case study of
applying particle filters to location estimation for ubiquitous
computing. Therefore, our approach may be computationally
affordable by sensor nodes. The particle filter method is shown
in Table I.
IV. CRAMER-RAO LOWER BOUND
A. TDOA
The location geometry is shown in Figure 1, where N seeds
at locations si = (sxi , syi)T are use to locate target at position
P = (x, y)T through TDOA measurements. Let di be the true
distance between the target and seed Si,
di =
√
(x− sxi)2 + (y − syi)2 (5)
ui = di+1 − d1, (6)
where i = 1, 2, . . . , N − 1. Assume that
r[i] = di + ni, (7)
TABLE I
THE PARTICLE FILTERING METHODOLOGY
1. Initialization: Generate a set of random samples xk(i),
i = 1, 2, . . . , N from the prior density at time k = 0.
Each sample of the state vector is a ‘particle’.
2. Prediction: Each random sample is passed through the state
equation to obtain samples from the prior density at time
k + 1. Thus
xˆk+1(i) = Φxk(i) + Γwk(i),
where wk(i) is a sample drawn from the probability density
function of the system noise, Φ is related to the mobility model,
and Γ is an identity matrix.
3. Measurement Update: The weights of the likelihood function
p(zk+1|xˆk+1(i)) are updated for each sample in the random
set i = 1, 2, . . . , N and the normalized weights are
qk+1(i) =
p(zk+1|xˆk+1(i))∑n
j=1 p(zk+1|xˆk+1(j))
for each sample.
4. Re-sampling: Take N samples with replacement from the
random sample set xˆk+1(i), i = 1, 2, . . . , N , to generate the
new sample set xk+1(i).
5. Position: The best single estimate of the position is the mean
of xk+1(i), xk .
where ni is the TOA noise that is assumed to be zero-mean
Gaussian. Thus, the distribution of r[i] is
f(r[i];x, y) =
1
(2πσ2)N/2
exp(−
∑N
i=1(r[i]− ui)2
2σ2
), (8)
where i = 1, 2, . . . , N and −∞ ≤ r[i] ≤ ∞.
The CRLB is the lowest possible variance that an unbiased
linear estimator can achieve. It is given by the inverse of
the Fisher information matrix I(P ) and r[i] be the Gaussian
distribution with variance σ2 defined as
I(P ) =
[
I1,1 I1,2
I2,1 I2,2
]
, (9)
where
I1,1 =
∂DT
∂x
Σ−1
∂D
∂x
(10)
I1,2 =
∂DT
∂x
Σ−1
∂D
∂y
(11)
I2,1 =
∂DT
∂y
Σ−1
∂D
∂x
(12)
I2,2 =
∂DT
∂y
Σ−1
∂D
∂y
(13)
with
∂D
∂x
=
[
∂μ1(x, y)
∂x
∂μ2(x, y)
∂x
· · · ∂μN−1(x, y)
∂x
]T
=
[
x− sx2
d2
− x− sx1
d1
· · · x− sxN
dN
− x− sx1
d1
]T
∂D
∂y
=
[
∂μ1(x, y)
∂y
∂μ2(x, y)
∂y
· · · ∂μN−1(x, y)
∂y
]T
=
[
y − sy2
d2
− y − sy1
d1
· · · y − syN
dN
− y − sy1
d1
]T
1776 2010 5th IEEE Conference on Industrial Electronics and Applicationsis
the estimated position of the target mobile sensors. For com-
parison, the position estimation using the TDOA technique, the
position estimation using the conventional TOA technique, and
the estimation accuracy using the proposed hybrid TOA/AOA
technique are depicted and the CRLBs with perfect AOA
information (i.e. σ2φ = 0) are provided for assessing the
performance of the proposed approach.
A. The Effect of Mobility
For the first set of experiments, we consider three seeds
and the mobility of the target sensor ranging from 1 to 10
m/s. Assuming that the variance of the distance measurement
is σ2d = 10−3, Figure 4 shows the position estimation accuracy
against the target mobility, which implies that the performance
of the TDOA and the proposed TOA/AOA method remain
approximately stable regardless of the node moving speed.
On the contrary, the estimation error of the conventional TOA
method increases with the increasing target speed. Therefore,
Figure 4 suggests that ATPA may be suitable for geometrical
positioning in situations involving modest mobility.
1 2 3 4 5 6 7 8 9 10
−60
−50
−40
−30
−20
−10
0
10
Speed (m/s)
M
S
E
 
o
f 
X 
ax
is
 (
dB
)
Proposed ATPA
TOA
TDOA
CRLB of TDOA
CRLB of ATPA
1 2 3 4 5 6 7 8 9 10
−60
−50
−40
−30
−20
−10
0
10
Speed (m/s)
M
S
E
 
o
f 
Y 
ax
is
 (
dB
)
Proposed ATPA
TOA
TDOA
CRLB of TDOA
CRLB of ATPA
Fig. 4. The effect of mobility on position estimation.
B. The Effect of Uncertainty of Angle Estimation
Given the target speed 5 m/s and the variance of angle
estimation (angle measurement in degree), the second set of
experiments investigates the effect of uncertainty of angle
estimation on position estimation accuracy with varying the
variance of distance measurement ranging from σ2d = 10−4 ∼
1. As expected, Figure 5 illustrates that the proposed scheme
achieves better performance with a lower variance of angle
estimation. Observe that with a small variance of distance
measurement, the angle information dominates the accuracy of
position estimation. However, with a larger variance of distance
measurement, the localization accuracy is determined by the
ranging error.
−40 −35 −30 −25 −20 −15 −10 −5 0
−50
−45
−40
−35
−30
−25
−20
10*log(Var(d))
M
SE
 o
f 
X 
ax
is
 (
dB
m)
Var(θ)=−10dB
Var(θ)=30dB
Var(θ)=40dB
−40 −35 −30 −25 −20 −15 −10 −5 0
−50
−45
−40
−35
−30
−25
−20
10*log(Var(d))
M
S
E
 
o
f 
Y 
ax
is
 (
dB
m)
Var(θ)=−10dB
Var(θ)=30dB
Var(θ)=40dB
Fig. 5. The effect of uncertainty of angle estimation on position estimation
accuracy.
C. The Effect of Measurement Noise of Distance Estimation
As shown in Figure 6, given the target speed 5 m/s and
the variance of angle estimation σ2φ = 0.1, the the position
estimation error increases with the increasing variance of
distance measurement (ranging from σ2d = 10−4 ∼ 1). Notice
that the CRLB, the performance of the TDOA method, and the
performance of the proposed method merge together with a
measurement noise σd ≥ 1. Therefore, a fundamental problem
when locating mobile sensors in a network is to estimate
the distance between the seed and the target sensor since
accurate location estimates highly rely on precise distance
measurements.
D. The Effect of Number of Seeds
With the target speed 5 m/s and variance σ2d = 10−3, we
vary the number of seeds in the network from 3 to 10. The
estimation of position is shown in Figure 7, which shows the
accuracy of the position estimate. The performance improves
along with the number of seeds. However, like the TDOA
approach, the improvement is not significant (especially when
number of seeds is greater than 5). This suggests that even
a low number of seeds can also achieve good estimation
accuracy.
Compared with Figure 4, given 3 seeds with random loca-
tions and the speed at 5 m/s, the estimation accuracy of Figure
7 is much lower than the one in Figure 4. This is due to the
quality of the TOA measurements. Therefore, the number of
TOA measurements for position estimation (i.e. the number
of seeds chosen for the measurement) should be dynamically
1778 2010 5th IEEE Conference on Industrial Electronics and Applicationsis
出席國際學術會議心得報告 
                                                             
計畫編號 98-2221-E-005-040- 
計畫名稱 應用於合作式無線中繼網路之自我定位研究 
出國人員姓名 
服務機關及職稱 
溫志煜 助理教授 
國立中興大學 通訊工程研究所 
會議時間地點 October 11-14, 2009   Texas, USA 
會議名稱 IEEE International Conference on Systems, Man, and Cybernetics - SMC2009 
發表論文題目 
The Design of Wireless Sleep EEG Measurement System With Asynchronous 
Pervasive Sensing 
 
一、參加會議經過 
We presented our paper in an oral session “Smart Sensor Networks”. Our technical session was highly 
popular judging by the high number of attendees. We also attended The 2009 IEEE SMC Workshop on 
Brain-Machine Interfaces (BMI) Systems. BMI is about transforming thought into action, or conversely, 
sensation into perception. This novel paradigm contends that a user can perceive sensory information and 
enact voluntary motor actions through a direct interface between the brain and a prosthetic device in 
virtually the same way that we see, hear, walk or grab an object with our own natural limbs. Proficient 
control of the prosthetic device relies on the volitional modulation of neural ensemble activity, achieved 
through training with any combination of visual, tactile, or auditory feedback. Therefore, BMI has 
enormous potential as therapeutic technology that will improve the quality of life for the physically 
impaired.  
 
二、與會心得 
 
The 2009 IEEE International Conference on Systems, Man, and Cybernetics (SMC2009) provides an 
international forum that brings together those actively involved in areas of interest to the IEEE Systems, 
Man, and Cybernetics Society, to exchange ideas and advances in all aspects of systems science and 
engineering, human machine systems, and cybernetics. The theme of the conference is: Intelligent 
Human-Machine Systems for Quality of Life. Since advances in Systems Science and Engineering, 
Human-Machine Systems, and Cybernetics continually play increasing roles in creating intelligent 
environments and improving the quality of our lives, we have completed a paper called “The Design of 
Wireless Sleep EEG Measurement System With Asynchronous Pervasive Sensing” This paper proposes 
an asynchronous pervasive sensing method using cooperative communication and networking between a 
pair of sensors for wireless EEG signal collection. A theoretical analysis and experiments are developed 
to assess the impact of time synchronization errors and the performance of the proposed approach, which 
may provide a sensible way for practical system design and the analysis of EEG, machine learning 
techniques, and shared control for blending the human user’s intelligence with the intelligent behavior of 
a semi-autonomous device. 
algorithm. In Section IV, an analytical tool is built up to
approximate the desired performance of the proposed scheme.
Section V illustrates the simulation results and summarizes the
performance of the proposed methodology. Finally, Section VI
draws conclusions and shows future research directions.
Fig. 1. Overview of a standard wire/wireless EEG system, where the Box
consists of a preampliﬁer and a ﬁlter.
Fig. 2. Each sensor node transmits bio-potential signals to the Sink.
II. LITERATURE REVIEW
[8] designs and tests a prototype portable EEG system. It
consists of input instrumentation ampliﬁer, band-pass ﬁlter,
driven-right-leg circuit and analog digital converter. [9] de-
velops wireless technologies for medical application. Based on
wireless network protocols, the wireless transmission pathways
for portable and long time recording. Figure 1 depicts the stan-
dards overview of a wire/wireless EEG system. [10] presents
a design of a hybrid medical sensor network with Tmote Sky
motes as wireless EEG sensor nodes and uses Independent
Component Analysis (ICA) to remove artifacts and then to
analyze with a Fourier transformation.
As illustrated in Figure 2, Ng [7] designs a wireless pro-
grammable system for bio-potential signal acquisition, includ-
ing a base unit and a plurality of individual wireless, remotely
programmable transceivers that connect to patch electrodes.
The base unit manages the transceivers by issuing registration,
conﬁguration, data acquisition, and transmission commands
using wireless techniques. [4] proposes a multi-channel wire-
less EEG system, which allows the signal to be observed and
stored without any long cables and further analyzed by an
integrated classiﬁcation method. However, preamble concepts
and synchronization techniques are implemented in each wire-
less channel without considering wireless transmission effects,
which may substantially degrade the EEG signal in the back-
end system.
III. ASYNCHRONOUS PERVASIVE SENSING ALGORITHM
This section describes a distributed algorithm, which applies
the concept of cooperative communication and networking to
achieve the task of signal collection efﬁciently. Figure 3 shows
the system architecture of one-pair mixed sleep EEG for the
proposed scheme. The procedures of the proposed algorithm
are described in the following subsections.
Fig. 3. The architecture of the proposed sleep EEG system.
A. Phase I: Time Synchronization and Signal Collection
1) Overview of Time Calibration Method: In order to
synthesize a signal, a distributed time calibration method [11],
based on a two-way time-of-arrival approach, may be used
to simultaneously undertake synchronization and propagation
time estimation. It operates analogously to a pulsed radar in
which a signal is bounced from the target and the propagation
time is determined by how long it takes the signal to return.
Since sensors are typically small and operate with low power;
the signal cannot bounce from the receiver. Instead, the target
sensor receives the transmission and sends a reply that acts
analogously to the return of the radar. Moreover, this method
helps to alleviate the need for highly accurate synchronous
clocking. Suppose that sensors A and B are equipped with
clocks (oscillators) that are assumed to be asynchronous in
both frequency and phase. Denote tai and tbj as the time stamps
in sensors A and B, respectively; let tadel and tbdel be the delay
time in sensors A and B, respectively; the scale factor z is
used for time adjustment, tab is the signal propagation time.
The estimation proceeds as shown in Figure 4.
Fig. 4. Time synchronization using the time stamps of transmission and
reception in sensors A and B.
In order to alleviate the multipath effect in the wire-
less channel, the precoding technique, such as Tomlinson-
Harashima (TH) precoding [12][13], is used for the propa-
gation time measurement between pairs of sensors. This pre-
equalization technique is used principally in data transmission
systems to combat the effect of interchannel interference
715
where n = L/2, (L/2 + 1), . . .. Accordingly, a new segmen-
tation criterion, G(n) can be derived,
G(n) =
{
Gnleo(n) if Gnleo(n) ≥ T (n)
0 if Gnleo(n) < T (n).
(5)
Thus, ﬁnal segmentation boundaries can be identiﬁed by
ﬁnding the local maxima or peaks.
Figure 6 illustrates the simulation result using the approach
detailed in Section III-B for signal segmentation. Observe
that with synchronous clocking and without the signal mea-
surement noise, the segmentation criterion can be applied to
separate the test signals successfully.
0 100 200 300 400 500 600 700 800
−1
−0.5
0
0.5
1
Test Signal
0 100 200 300 400 500 600 700 800
0
0.05
0.1
0.15
0.2
0.25
Energy Operator φ
0 100 200 300 400 500 600 700 800
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
New Segmentation Criterion
Fig. 6. Simulation example of segmentation of two channels with syn-
chronous clocking and without measurement noises; f1 = 5K Hz, f2 = 2∗f1
Hz, f3 = 3.5 ∗ f1 Hz, and f4 = 2.75 ∗ f1 Hz. The sampling frequency
fs = 10 ∗ f1 Hz.
IV. ANALYSIS
The impact of time synchronization problem and the mea-
surement noise on the performance of the proposed sleep EEG
system is explored in this section. The Gaussian approximation
is applied to describe the estimation accuracy of propagation
time between C4 and A1 and the estimation accuracy of signal
segmentation.
A. Estimation Accuracy of Propagation Time
The fundamental limitation on time accuracy of the prop-
agation time estimate between a pair of sensors, sensors A
and B, is related to the form of the signal and the clock,
including signal bandwidth, signal-to-noise ratio (SNR), and
timing calibration. Assume that the random time error and
time bias error from propagation conditions are negligible.
The time-measurement accuracy may be characterized by the
measurement error
σP =
(
σ2S + σ
2
clock
)1/2
, (6)
where σS is the SNR-dependent random time accuracy and
σclock is the clock-dependent random time accuracy. Note that
σS relates the accuracy of synchronous propagation time esti-
mates to the signal-to-noise ratio and the effective bandwidth
of the signal. The expression of σclock is the added inaccuracy
due to the asynchronous clocking mechanism as detailed in
[11].
For the SNR-dependent propagation time measurement,
the estimation accuracy is inﬂuenced by the error sources
such as channel estimation, correlator performance, and sig-
nal format. Due to channel estimation errors, sensor B may
possess erroneous channel information, which may degrade
the performance of the TH precoder. Assume that the channel
estimation is assumed to be accurate (i.e. the variance of the
correlator is negligible and the proper correlation peak is cho-
sen). Accordingly, the accuracy of synchronous propagation
time estimates [16]-[18] is related to the signal-to-noise ratio,
the distance, and the effective bandwidth of the signal, which
is given by
σS ≥ dab
2βe
√
2SNR
, (7)
where βe is the effective bandwidth of the signal [18].
Now consider sensor A and B in the above analysis as the
primary point (C4) and the secondary point (A1), respectively.
Hence, the estimation error of signal propagation time between
A1 and C4 in the proposed method is
σP =
(
σ2S + σ
2
clock
)1/2 ≥
√
d2ab
8β2eSNR
+ σ2Tab . (8)
B. Estimation Accuracy of Signal Segmentation
This subsection investigates the impact of estimation accu-
racy of the propagation time on signal segmentation. Based
on the messages communicated between A1 and the sink, A1
may estimate the channel and transmit the pre-equalized signal
to the sink using the TH-Precoding. Thus, the samples of the
received signal at the sink can be denoted as
x(n) = A cos
(
2πf0
fs
n + φ
)
+ w(n) (9)
where A is the signal amplitude, f0 is the carrier frequency, fs
is the sampling frequency, φ is the initial phase, and w(n) is
AWGN noise. Then based on the Non-Linear Energy Operator
as described in (1), the calculation of x(n− 1)2 is given by
x(n− 1)2 = A
2
2
· [f(2n− 2) + f(0)] + g(w(·)) (10)
where f(z) = cos(Ω0 ·z+φz), g(w(·)) is a function of AWGN
noise, ts = 1/fs, Ω0 = 2πf0ts, and φz = 2πf0t · z + φ.
Note that t is assumed to be a normal random variable with
717
0 100 200 300 400 500 600 700 800
−0.05
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
Energy Operator φ
0 100 200 300 400 500 600 700 800
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
New Segmentation Criterion
Fig. 8. Simulation example of segmentation of two channels with syn-
chronous clocking and the measurement noise σw = 0.05.
0 100 200 300 400 500 600 700 800
−0.4
−0.2
0
0.2
0.4
0.6
Energy Operator φ
0 100 200 300 400 500 600 700 800
0
0.5
1
1.5
New Segmentation Criterion
0 100 200 300 400 500 600 700 800
0
0.5
1
1.5
2
2.5
New Segmentation Criterion
Fig. 9. Simulation example of segmentation of two channels with syn-
chronous clocking and with measurement noises σw = 0.1 and N = 5
(top) and N = 15 (bottom), respectively.
B. Application: Wireless Sleep EEG System
Since the variance of energy operator depends on the timing
resolution, Figure 12 and 13 depict the corresponding energy
output variances given the timing resolutions. As expected, in
Figure 12 a higher timing resolution σ (Phase I) introduces
a lower variance of energy operator output σms (Phase II).
Therefore, a lower timing resolution may increase the difﬁ-
culty of distinguishing the boundaries of different EEG signal
patterns. As shown in Figure 13, for a test signal composed of
f1 = 10 Hz and f2 = 20 Hz, the timing resolution σ = 10−6
second leads to σms = 0.0048 and σ = 10−3 second leads to
0 100 200 300 400 500 600 700 800
−2
−1.5
−1
−0.5
0
0.5
1
1.5
2
Test Signal
0 100 200 300 400 500 600 700 800
−0.1
0
0.1
0.2
0.3
0.4
0.5
0.6
Energy Operator φ
0 100 200 300 400 500 600 700 800
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
New Segmentation Criterion
Fig. 10. The impact of the time synchronization error on signal segmentation
without TH-Precoding.
0 100 200 300 400 500 600 700 800
−2
−1
0
1
2
Test Signal (b)
0 100 200 300 400 500 600 700 800
−0.1
0
0.1
0.2
0.3
0.4
0.5
0.6
Energy Operator φ
0 100 200 300 400 500 600 700 800
0
0.5
1
1.5
New Segmentation Criterion
Fig. 11. The impact of the time synchronization error on signal segmentation
with TH-Precoding.
σms = 0.477.
In Section V-A, the performance of the EEG segmentation
algorithm is shown by a sine signal with immediate frequency
719
0 50 100 150 200 250 300
0.02
0.04
0.06
0.08
0.1
Energy Operator φ
0 50 100 150 200 250 300
0
0.05
0.1
0.15
0.2
Segmentation Criterion
Fig. 16. Simulation example of segmentation of two channels with timing
resolution σ = 10−3 second, measurement noises σw = 0.05, and time
synchronization error 20/fs, where fs = 100 Hz.
0 50 100 150 200 250 300
0.01
0.02
0.03
0.04
0.05
0.06
Energy Operator φ
0 50 100 150 200 250 300
0
0.05
0.1
0.15
0.2
0.25
Segmentation Criterion
Fig. 17. Simulation example of segmentation of two channels with TH
precoding and the measurement noise σw = 0.05.
proposed scheme may be applied to analyze the long time
recording data efﬁciently. Compared with conventional EEG
measurement systems, the proposed algorithm may provide
a reliable EEG reading system with asynchronous pervasive
sensing.
For the proposed measurement solution, trade-offs are found
between model complexity, energy consumption, signal seg-
mentation strategy, and sensible model description in real
systems. Future plans will involve generalizing the methods
to consider different EEG signal segmentation algorithms (e.g.
wavelets) and to perform actual measurements to determine
how precise the synchronization of EEG channels needs to be
in practice.
REFERENCES
[1] Joseph J. Carr and John M. Brown, “Instrumentation for Mea-
suring Brain function,” in Introduction to Biomedical Equipment
Technology, Fourth Edition, pp. 369-395, 2001.
[2] D. Holschneider and A. Leuchter, “Clinical neurophysiology us-
ing electroencephalography in geriatric psychiatry: neurobiologic
implication and clinical utility,” in J. Geriatr. Psychiatry Neurol.,
vol. 12, pp. 150-164, 1999.
[3] Halit Eren, “Instruments and Instrumentation,” in Wireless Sen-
sors and Instruments Network, Design, and Application, pp. 1-
58, 2005.
[4] Robert Lin, Ren-Guey Lee, Chwan-Lu Tseng, Yan-Fa Wu and
Joe-Air Jiang, “Design and Implementation of Wireless Multi-
channel EEG Recording System and Study of EEG clustering
Methods,” in Biomedical Engineering Application, Basis &
Communications, pp. 276-283, 2006.
[5] Sharon A. Keenan, “An Overview of Polysomnography,” in
Christian Guilleminault ed., Clinical Neurophysiology of Sleep
Disorders, pp. 33-50, 2005.
[6] M. Chen, J.-M. Lei, C.-L. Peng, and X.-M. Guo, “Time Synchro-
nization in Wireless Physiological Information Sensor Network,”
in Proc. IEEE Engineering in Medicine and Biology 27th Annual
Cinference, pp. 5176-5178, 2005.
[7] Ng et al, United State Patent (Patent No.: US 6,496,705),
December 2002.
[8] Mehmet Engine, Tayfun Dalbasti, Merih Gulduren, Eray Davash
and Erkan Zeki Engin, “A prototype portable system for EEG
measurements,” in Measurement, vol. 40, pp. 936-942, 2007.
[9] N. Golmie , D. Cypher and O. Rebala, “Performance analysis
of low rate wireless technologies for medical applications,” in
Computer Communication, vol. 28, pp. 1266-1275, 2005.
[10] Behcet Sarikaya, M. Abdul and Siamak Rezaei, “Integrating
Wireless EEGs into Medical Sensor Networks,”in Proc. IEEE
IWCMC, pp. 1369-1373, 2006.
[11] C.-Y. Wen, R. D. Morris, and W. A. Sethares, “Distance Estima-
tion Using Bidirectional Communications Without Synchronous
Clocking,” in IEEE Transactions on Signal Processing, vol. 55,
pp. 1927-1939, May 2007.
[12] M. Tomlinson, “New Automatic Equalisier Employing Modulo
Arithematic,” in Electronics Letters, pp. 138-139, March 1971.
[13] C.-Y. Wen, J.-K. Chen, and W. A. Sethares, “Asynchronous Two-
Way Ranging Using Tomlinson-Harashima Precoding and UWB
Signaling,” in EURASIP Journal on Wireless Communications
and Networking, vol. 8, no. 3, pp. 1-13, 2008.
[14] J. F. Kaiser, “On a simple algorithm to calculate the ‘energy’ of
a signal,” in Proc. IEEE Intl Conf. Acoust., Speech, and Signal
Processing, 1990.
[15] R. Agarwal and J. Gotman, “Adaptive segmentation of electroen-
cephalographic data using nonlinear energy operator,” in Proc.
IEEE ISCAS, pp. 199-202, 1999.
[16] V. H. Poor, An Introduction to Signal Detection and Estimation,
2nd ed. New York: Springer-Verlag, 1994.
[17] W. S. Burdic, Radar Signal Analysis, Prentice-Hall, 1968.
[18] G. R. Curry, Radar System Performance Modeling, 2nd ed.,
Artech House, 2005.
[19] E.C. Fieller, “The Distribution of the Index in a Normal Bivari-
ate Population,” Biometrika, vol. 24, pp. 428-440, 1932.
[20] D.V. Hinkley, “On the Ratio of Two Correlated Normal Random
Variables,” Biometrika, vol. 56, pp. 635-639, 1969.
[21] R. Ware and F. Lad, “Approximating the Distribution for Sum
of Product of Normal Variables,” the research report of the
Mathematics and Statistics department at Canterbury University,
2003.
[22] S. Gezici, Z. Tian, et al., “Localization via Ultra-Wideband
Radios,” in IEEE Signal Processing Magazine, vol. 22, no. 4,
pp. 70-84, July 2005.
[23] K. Susmakova, ‘Human Sleep and Sleep EEG,” Measurement
Science Review, vol. 4, pp. 59-74, 2004.
721
98年度專題研究計畫研究成果彙整表 
計畫主持人：溫志煜 計畫編號：98-2221-E-005-040- 
計畫名稱：應用於合作式無線中繼網路之自我定位研究 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 1 1 25% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 2 0 0%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 2 0 100%  
博士生 1 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 3 4 30%  
研究報告/技術報告 0 0 100%  
研討會論文 3 4 25% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
 
