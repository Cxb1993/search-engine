 中文摘要 
 
採用擴展型卡爾曼濾波器(extended Kalman filter，EKF)應用於導航訊息處理已受到普遍之
採用。單純 GPS與 GPS/INS整合導航系統的數學模型之建立，無論濾波間隔之選擇多小，
系統的數學描述都仍是非線性的。對於此非線性系統，目前尚沒有一種比較完善的濾波方
法，現有的濾波算法都是在一定的假設下的近似方法。以傳統卡爾曼濾波器估測系統之狀
態，須事先知道環境中雜訊之統計特性及明確之系統狀態描述，方能得到最佳解。自適應
濾波在於利用觀測數據進行濾波遞推之同時，不斷地由濾波本身去判斷載體在動態上是否
有變化。當判斷有變化時，需進一步決定將此種變化視為隨機干擾而歸於模型雜訊中，抑
或對原動態模型進行修正，使之掌握並適應目標變化後之動態。當系統之數學模型不夠精
確抑或存在建模不確定性時，使用自適應性卡爾曼濾波器，可線上(on-line)估計並調整濾波
器內部之系統數學模型與雜訊強度，進而提昇濾波器之性能。本研究主要採用了三種方式，
依序為：(1) 模糊神經網路自適應性機制於導航卡爾曼濾波器雜訊強度之估測及其於 GPS
與GPS/INS導航之應用；(2) 自適應性模糊強跟蹤擴展型卡爾曼濾波器(adaptive fuzzy strong 
tracking Kalman filter (AFSTKF)於 GPS 導航之設計，及其(3) 粒子族群最佳化(Particle 
Swarm Optimization, PSO)與放射狀基底函數(Radial Basis Function, RBF)網路輔助 GPS/INS
整合式導航系統之設計。 
 
關鍵字: 全球定位系統(GPS)，慣性導航系統(INS)，擴展型卡爾曼濾波，模糊邏輯，模糊神
經網路，自適應強跟蹤卡爾曼濾波器，粒子族群最佳化，放射狀基底函數網路 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
I 
 目錄 
中文摘要………………………………………………………………… I 
英文摘要………………………………………………………………… I I 
目錄………………………………………………………………… I I I 
圖目錄……………………………………………………………………I V 
表目錄…………………………………………………………………V I 
第一章 前言............................................................................................................1 
第二章 研究目的 ....................................................................................................3 
第三章 文獻探討… ................................................................................................5 
第四章 研究方法 ....................................................................................................7 
4-1導航基礎 ............................................................................................................................7 
4-1.1 GPS navigation processing ...........................................................................................7 
4-1.2 GPS/INS navigation system........................................................................................10 
4-2模糊神經網路自適應性機制於導航卡爾曼濾波器雜訊強度之估測及其於 GPS與
GPS/INS導航之應用 .............................................................................................................12 
4-2.1 Structure of the Fuzzy Neural Network.......................................................................14 
4-2.2 Back-Propagation Algorithm for Training the FNN.....................................................15 
4-3自適應性模糊強跟蹤擴展型卡爾曼濾波器於 GPS導航之設計 ....................................19 
4-3.1 Strong tracking Kalman filter .....................................................................................19 
4-3.2 The fuzzy logic adaptive system (FLAS) ....................................................................21 
4-3.3 Adaptive fuzzy strong tracking Kalman filter (AFSTKF)............................................22 
4-4粒子族群最佳化與放射狀基底函數網路輔助 GPS/INS整合式導航系統之設計..........25 
4-4.1 Particle swarm optimization (PSO)..............................................................................26 
4-4.2 The radial basis function network ................................................................................26 
4-4.3 The proposed PSO-RBFN design ................................................................................28 
4-4.4 Fitness function for the PSO-RBFN mechanism ..........................................................29 
4-4.5 Feasibility check for the proposed fitness function.......................................................30 
4-4.6 Roles of the PSO-RBFN mechanism ...........................................................................31 
第五章 結果與討論… ..........................................................................................35 
5-1 Application of the FNN aided AKEF to GPS and GPS/INS navigation solutions ...............35 
5-2 Adaptive fuzzy strong tracking extended Kalman filtering for GPS navigation..................39 
5-3 Application of the PSO-RBFN for GPS/INS navigation design .........................................49 
參考文獻................................................................................................................54 
計畫成果自評........................................................................................................56 
可供推廣之研發成果資料表.................................................................................57 
 
III 
 Fig. 32. Comparison of error standard deviation traces for AFSTKFand STKF............................48 
Fig. 33. The softening factors (top) and fading factors (bottom) ..................................................48 
Fig. 34. The vehicle trajectory for simulation ..............................................................................50 
Fig. 35. Velocity components (top) and euler angles (down) for the vehicle.................................50 
Fig. 36. Positioning errors – without differential correction .........................................................52 
Fig. 37. Positioning errors – DGPS mode ....................................................................................52 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
V 
 第一章 前言 
 
The Global Positioning System (GPS) is a satellite-based navigation system that provides a 
user with the proper equipment access to useful and accurate positioning information anywhere 
on the globe. The GPS [9] are capable of providing accurate position information. Unfortunately, 
the data is prone to jamming or being lost due to the limitations of electromagnetic waves, which 
form the fundamental of their operation. The system is not able to work properly in the areas due 
to signal blockage and attenuation that may deteriorate the overall positioning accuracy. The 
inertial navigation system (INS) [9,25] is a self-contained system that integrates three 
acceleration components and three angular velocity components with respect to time and 
transforms them into the navigation frame to deliver position, velocity and attitude components. 
The three orthogonal linear accelerations are continuously measured through three-axis 
accelerometers while three gyroscopes sensors monitor the three orthogonal angular rates in an 
inertial frame of reference. For short time intervals, the integration with respect to time of the 
linear acceleration and angular velocity monitored by the INS results in an accurate velocity, 
position and attitude. However, the error in position coordinates increase unboundedly as a 
function of time. The GPS/INS integration is the adequate solution to provide a navigation 
system that has superior performance in comparison with either a GPS or an INS stand-alone 
system.  
The extended Kalman filter (EKF) [4,10] which provides optimal (minimum mean square 
error) estimate of the system state vector, has been widely applied to the field of navigation 
system designs [2,3]. While employed in the GPS receiver [2] and the GPS/INS integrated 
navigation systems as the navigational state estimator, the extended Kalman filter has been one of 
the promising approaches. To obtain good estimation solutions using the EKF approach, the 
designers are required to have good knowledge on both dynamic process (plant dynamics, using 
an estimated internal model of the dynamics of the system) and measurement models, in addition 
to the assumption that both the process and measurement are corrupted by zero-mean white 
noises. The divergence due to modeling errors is a critical problem in Kalman filter applications. 
If the theoretical behavior of a filter and its actual behavior do not agree, divergence may occur. A 
conventional Kalman filter fails ensure error convergence due to limited knowledge of the 
system’s dynamic model and measurement noise. If the Kalman filter is provided with 
information that the process behaves a certain way, whereas, in fact, it behaves a different way, 
the filter will continually intend to fit an incorrect process signal. 
In the Kalman filter, the system model, system initial conditions, and noise characteristics 
have to be specified a priori. In various circumstances, there are uncertainties in the system 
models and noise description, and the assumptions on the statistics of disturbances are violated 
since in a number of practical situations, the availability of a precisely known model is unrealistic. 
The facts discussed above results in filtering performance degradation. In actual navigation filter 
designs, there exist model uncertainties which cannot be expressed by the linear state-space 
model. The linear model increases modeling errors since the actual vehicle motions are non-linear 
process. It is very often the case that little a priori knowledge is available concerning the 
1 
1 
 第二章 研究目的 
 
To prevent divergence problem due to modeling errors using the EKF approach, the adaptive 
filter algorithm has been one of the strategies considered for estimating the state vector. Many 
efforts have been made to improve the estimation of the covariance matrices. 
In the first portion of this research, a FNN aided adaptive extended Kalman filtering 
approach for the GPS and GPS/INS navigation systems has been conducted. After being trained, 
the FNN was employed as a noise identification mechanism to implement the on-line 
identification of measurement noise covariance matrices. Covariance matching method is a 
conventional adaptive approach for estimation of noise covariance matrices. The technique 
attempts to make the filter residuals consistent with their theoretical covariance. However, this 
innovation-based adaptive estimation shows noisy result if the window size is small. To 
overcome the problem, the fuzzy method combined with NN to identify the noise covariance 
matrix is proposed. Fuzzy modelling is the method of describing the characteristics of a system 
using fuzzy inference rules. Fuzzy neural networks (FNNs) are systems that apply fuzzy 
reasoning to neural networks. The appropriate rules and membership functions could accelerate 
the convergence of network. The basic idea of the composition method of the FNN is to realize 
the process of fuzzy reasoning by the structure of an NN. 
The second portion of the report presents the Adaptive Fuzzy Strong Tracking Extended 
Kalman Filtering for GPS Navigation. One of the methods proposed is called the strong tracking 
Kalman filter (STKF) [6,29]. The STKF is essentially a nonlinear smoother algorithm that 
employs suboptimal multiple fading factors, in which the softening factors are involved. STKF 
has several merits, such as: (1) strong robustness against model uncertainties; (2) good real-time 
state tracking ability even when a state jump occurs, no matter whether the system has reached 
steady state or not. In a STKF, the softening factor is introduced to provide better state estimation 
smoothness. Traditional STKF approach for determining the softening factors heavily relies on 
personal experience or computer simulation using a heuristic searching scheme. In order to 
resolve this shortcoming, a new approach called the adaptive fuzzy strong tracking Kalman filter 
(AFSTKF) is proposed. The fuzzy logic reasoning system based on the Takagi-Sugeno (T-S) 
model is incorporated into the STKF for real-time for tuning the softening factor. Instead of 
determining the fading factor directly, determining the softening factor provides the alternative 
design strategy based on the theory of STKF, for which the convergence has been ensured. The 
fuzzy reasoning system is constructed for obtaining suitable softening factors according to the 
time-varying change in dynamics. By monitoring the innovation information, the FLAS is 
employed for dynamically adjusting the softening factors based on the proposed fuzzy rule. Using 
the AFSTKF, the FLAS, which is the filter’s internal mode, is used to continually adjust the 
softening factor so as to improve the Kalman filter performance.  
In the third portion of this report, a new approach is presented for improving GPS/INS 
navigation system designs. The method makes use of the radial basis function network (RBFN) 
(Haykin, 1994 [12]) and the particle swarm optimization (PSO) techniques (Kennedy and 
3 
 第三章 文獻探討 
 
The Kalman filter [4,10] provides optimal (minimum mean square error) estimate of the 
system state vector has been widely applied to the fields of GPS receiver position/velocity 
determination [2], radar target tracking, and integrated navigation system design. In practice, the 
Kalman filter will provide the optimal result if the complete a priori knowledge of the process 
noise covariance matrix and the measurement noise covariance matrix are available. In actual 
navigation filter designs, there exist the model uncertainties which cannot be expressed by the 
linear state-space model. The linear model includes modeling errors since the actual vehicle 
motions are non-linear process. The system model, system initial conditions, and noise 
characteristics have to be specified a priori. It is very often the case that little a priori knowledge 
is available concerning the maneuver. 
Many efforts have been made to improve the estimation of the covariance matrices. Mehra 
[20-22] classified the adaptive approaches into four categories: Bayesian, maximum likelihood, 
correlation and covariance matching. These methods can be applied to the Kalman filtering 
algorithm for realizing the adaptive Kalman filtering [13,20-22]. However, the first two methods 
are computationally demanding so that their practical applications are limited. As for the 
correlation methods, a set of equations is derived to relate the functions to the unknown 
parameter. The covariance matching technique attempts to make the filter residuals consistent 
with their theoretical covariances. Results from such innovation-based adaptive estimation are too 
noisy if the window size is small. On the other hand, the transient time needed to reach the 
converged value will increase if the window size is increased. 
Neural networks (NNs) [12] are trainable, dynamic systems that can estimate input-output 
functions. NNs have been applied to a wide variety of problems. The NN is motivated by their 
ability to approximate an unknown nonlinear input-output mapping through supervised training. 
They have been applied to a wide variety of problems since they are model-free estimator, i.e., 
without a mathematical model. Fuzzy modeling is the method of describing the characteristics of 
a system using fuzzy inference rules. Takagi and Sugeno proposed a fuzzy modeling approach to 
model nonlinear systems [27]. The method has a distinguishing feature in that it can express 
complex nonlinear systems linguistically. However, it is difficult to identify the fuzzy rules and 
tune the membership functions of the fuzzy reasoning. Identification of the rules takes a lot of 
times and tuning membership functions of the fuzzy reasoning needs “the fuzzy reasoning of 
experts”. Several researches have been done to combine the learning capability of NN and fuzzy 
reasoning [14-16]. The scheme is fuzzy neural network (FNN) or neurofuzzy network. 
GPS/INS integration is typically carried out through Kalman filter (KF) (see Brown and 
Hwang [4], and Gelb [10] for details). In Kalman filter designs, the divergence due to modeling 
errors is critical. If the theoretical behavior of a filter and its actual behavior do not agree, 
divergence problems will occur. If the Kalman filter is provided with information that the process 
behaves a certain way, whereas, in fact, it behaves a different way, the filter will continually 
intend to fit an incorrect process signal. When the measurement situation does not provide 
5 
 第四章 研究方法 
 
本計畫之研究方法分四部份介紹，分別為：(一) 導航基礎; (二)模糊神經網路自適應性
機制於導航卡爾曼濾波器雜訊強度之估測及其於 GPS與 GPS/INS導航之應用； (三) 適應
性模糊強跟蹤擴展型卡爾曼濾波器於 GPS 導航之設計；以及(四)粒子族群最佳化與放射狀
基底函數網路輔助 GPS/INS整合式導航系統之設計。 
 
4-1 導航基礎 
4-1.1 GPS navigation processing 
The most commonly used approaches for the GPS navigation solutions are the least squares 
and the extended Kalman filtering approaches. The Kalman filter is briefly reviewed for 
convenience. 
 
(1) Linearisation of GPS pseudorange equations 
Consider the vectors relating the Earth’s centre, satellites and user position. The vector s  
represents the vector from the Earth’s centre to a satellite, u  represents the vector from the 
Earth’s centre to the user’s position, and r  represents the vector from the user to satellite, we 
can write the vector relation 
usr -=                                 (1) 
The distance |||| r  is computed by measuring the propagation time from the transmitting satellite 
to the user/receiver. The pseudorange ir  is defined for the i th satellite by 
i
vctbii rr ++-= |||| us                           (2) 
where c  is the speed of light and bt  is the receiver clock offset from system time, and ivr  is 
the pseudorange measurement noise. Consider the user position in three dimensions, denoted by 
),,( uuu zyx , the GPS pseudorange measurements made to the n  satellites can then be written as 
i
vctzzyyxx buiuiuii rr ++-+-+-=
222 )()()( , ni ,,1 K=        (3) 
where ),,( iii zyx  denotes the i -th satellite’s position in three dimensions.  
The states and the measurements are related nonlinearly; the nonlinear ranges are linearized 
around an operating point using Taylor’s series. Equation (3) can be linearized by expanding 
Taylor’s series around the approximate (or nominal) user position )ˆ,ˆ,ˆ( nnn zyx  and neglecting the 
higher terms. Defining irˆ  as ir  at )ˆ,ˆ,ˆ( nnn zyx  gives 
i
vctzeyexe buiuiuiiii rrrr ++D+D+D=-=D 321ˆ               (4) 
where 
i
in
i r
xx
e
ˆ
ˆ
1
-
= ; 
i
in
i r
yy
e
ˆ
ˆ
2
-
= ; 
i
in
i r
zz
e
ˆ
ˆ
3
-
=                 (5) 
222 )ˆ()ˆ()ˆ(ˆ ininini zzyyxxr -+-+-=  
The vector iiii eee Eº),,( 321 , ni ,,1 K= , denotes the line-of-sight vector from the user to the 
7 
  kkk xΦx ˆˆ 1 =-+                                 (13) 
 kkkkk QΦPΦP +=-+ T1                              (14) 
  Correction steps/measurement update equations: 
1TT ][ --- += kkkkkkk RHPHHPK                          (15) 
]ˆ[ˆˆ -- -+= kkkkkk xHzKxx                            (16) 
--= kkkk PHKIP ][                             (17) 
Equations (13-14) are the time update equations of the algorithm from k  to step 1+k , and 
Equations (15-17) are the measurement update equations. These equations incorporate a 
measurement value into a priori estimation to obtain an improved a posteriori estimation. In the 
above equations, kP  is the error covariance matrix defined by ])ˆ)(ˆ[( TkkkkE xxxx -- , in which kxˆ  
is an estimation of the system state vector kx , and the weighting matrix kK  is generally 
referred to as the Kalman gain matrix. The Kalman filter algorithm starts with an initial condition 
value, -0xˆ  and -0P . When new measurement kz  becomes available with the progression of time, 
the estimation of states and the corresponding error covariance would follow recursively ad 
infinity. 
    The extended Kalman filtering is a nonlinear version of Kalman filtering, which deals with 
the case described by the nonlinear stochastic differential equations: 
                      )(),( tt uxfx +=&                            (18a) 
)(),( tt vxhz +=                            (18b) 
The algorithm for the extended Kalman filtering is essentially similar to that of Kalman filtering, 
except that some modifications are made. Firstly, the state update equation becomes 
]ˆ[ˆˆ -- -+= kkkkk zzKxx                           (19) 
where 
)ˆ(ˆ 11 --
- = kkk xfx                            (20a) 
and 
)ˆ(ˆ -- = kkk xhz                            (20b) 
Secondly, the linear approximation equations for system and measurement matrices are obtained 
through the relations 
-=¶
¶
»
k
k
k
xxx
f
Φ
ˆ
 ; 
-=¶
¶
»
k
k
k
xxx
h
H
ˆ
                     (21) 
Further detailed discussion can be referred to Gelb [10] and Brown and Hwang [4]. The flow 
chart for the GPS navigation processing using extended Kalman filter approach is shown in Fig. 
1. 
 
 
 
 
 
 
 
 
9 
 psi-angle (y ): the angle between c-frame and p-frame. 
phi-angle ( F ): the angle between n-frame and p-frame. 
theta-angle (q ): the angle between n-frame and c-frame. 
o
mC : DCM from m-frame to o-frame, where DCM is the direction cosine matrix. 
j
klw : angular rate between k-frame and l-frame resolved in j-frame. 
 
The details are derived in the inertial literature in the list of references but the psi-angle 
position, velocity and attitude errors are given as follows: 
Position Error: 
cnn
en VRωR ddd +´= -&                           (22) 
Velocity Error 
              cciecec
hr
g
r
g
r
g
bp
b
e
e
e
VωωΨRfCV dddd ´+´-
ú
ú
ú
ú
û
ù
ê
ê
ê
ê
ë
é
+=
+
-
-
)2(
00
00
00
2
&            (23) 
Psi-angle: 
b
ib
p
b
c
ie
c
ec ωCΨωωΨ d+´+-= )(&                      (24) 
where bibωd  refers to the gyro errors in the body-frame expressed in continuous-time. 
The dynamic process model in state space form is 
  
ú
ú
ú
ú
ú
ú
ú
ú
û
ù
ê
ê
ê
ê
ê
ê
ê
ê
ë
é
+
ú
ú
ú
ú
ú
ú
ú
ú
û
ù
ê
ê
ê
ê
ê
ê
ê
ê
ë
é
ú
ú
ú
ú
ú
ú
ú
ú
û
ù
ê
ê
ê
ê
ê
ê
ê
ê
ë
é
-
-
=
ú
ú
ú
ú
ú
ú
ú
ú
û
ù
ê
ê
ê
ê
ê
ê
ê
ê
ë
é
b
g
a
g
a
p
b
p
b
g
a
g
g
u
u
u
0
0
0
b
ε
ε
Ψ
V
R
000000
0I0000
00I000
0C0F00
00CFFF
0000FF
b
ε
ε
Ψ
V
R
d
d
d
d
t
t
1
1
33
232221
1211
&
&
&
&
&
             (25) 
In Equation (25), the ‘0’s are 33´  matrices of zeros, and the ‘C’s stand for the direction cosine 
matrices.  
and ][11 ´-= nenωF ; 
ú
ú
ú
û
ù
ê
ê
ê
ë
é
=
100
010
001
12F ; 
ú
ú
ú
ú
û
ù
ê
ê
ê
ê
ë
é
=
+
-
-
hr
g
r
g
r
g
e
e
e
2
21
00
00
00
F ; ])2([22 ´+-= nienen ωωF ; ][23 ´= bfF ; ])([33 ´+-= nienen ωωF . 
where ‘ f ’is the specific force vector; ‘ g ’ is gravity; er  is the radius of the earth; h  is the 
vehicle height above the reference ellipsoid; necω  refers to transport-rate; nieω  refers to 
earth-rate vector. The term ][ ´A  refers to the skew-symmetric matrix form of the vector A . 
The error model for INS is augmented by some sensor error states such as accelerometer 
11 
 storage. BPNN is a neural system with a BP algorithm that can learn input-output functions from 
a series of samples. It is a gradient-based algorithm, in the sense that the weight update is 
performed along the direction of the gradient of an appropriate error function. 
Mehra classified the adaptive approaches into four categories: Bayesian, maximum 
likelihood, correlation and covariance matching. The innovation sequences have been utilized by 
the correlation and covariance-matching techniques to estimate the noise covariances. The basic 
idea behind the covariance-matching approach is to make the actual value of the covariance of 
the residual consistent with its theoretical value. From the incoming measurement kz  and the 
optimal prediction -kxˆ  obtained in the previous step, the innovations sequence is defined as 
--= kkkk xHzυ ˆ                               (26) 
The innovation represents the additional information available to the filter as a consequence of 
the new observation kz . The weighted innovation, )ˆ( -- kkkk xHzK , acts as a correction to the 
predicted estimate -kxˆ  to form the estimation kxˆ . Substituting the measurement model (11b) 
into (26) gives 
 kkkkk vxxHυ +-= - )ˆ(                            (27) 
which is a zero-mean Gaussian white noise sequence. By taking variances on both sides, we have 
the theoretical covariance 
kkkkk RHPHC +=
- T
u                            (28) 
This leads to an estimate of kR : 
Tˆˆ
kkkkk HPHCR
--= u                            (29) 
where kuCˆ  is the statistical sample variance estimate of kuC . Matrix kuCˆ can be computed 
through averaging inside a moving estimation window of size N  
å
=
=
k
jj jjk N 0
T1ˆ υυCu                              (30) 
where 10 +-= Nkj  is the first sample inside the estimation window. Based on the residual 
based estimate, the estimate of process noise kQ  is obtained: 
T
1
0
T1ˆ
kkkk
k
jj jjk N
ΦPΦPxxQ -å
=
-+DD=                       (31) 
where --=D kkk xxx ˆˆ . This equation can be written in terms of the innovation sequence: 
Tˆˆ
kkkk KCKQ u»                             (32) 
For further information of these equations, see Mohamed & Schwarz [22]. If the window 
size N is too small, the estimation of measurement covariance will be too noisy. On the other 
hand, if a large window size is utilized, the estimation of measurement covariance will be 
smoother, however, at the expense of long transient time. The window size is chosen empirically 
to give some statistical smoothing. In some practical applications, there are chances in which the 
noise spectral amplitudes rapidly change, then the conventional approach will not suffice the 
adaptation requirement. 
13 
 function: 
mnnk
AInput P=m:                            (36) 
å
==
k
k
kiOOutput m
m
mˆ: 4                          (37) 
where mnA  is the fuzzy variables in the premises, km  is the true value of the kth fuzzy rule and 
kmˆ  is the normalized value of km . The number of neurons in the fourth layer is i2 , and these 
neurons represent the amount of fuzzy rules. Moreover, å km  represents the summation of km  
from different 3iO . 
In the consequence part, the connection weights pw  represent control rules. The center of 
gravity defuzzifier (COG) is used to infer the output of network. The final inferred value is 
obtained from the sum of kpw mˆ.  and the network realizes the following fuzzy rules: 
:kR If 
1uC  is 1mA , 2uC  is 2mA , ,L 1+pCu  is )1( +pmA  then 5iO  is kB                                            
The above fuzzy rule is equivalent to  
  å
=
=
fR
k kki
BO
1
5 mˆ                                (38) 
where kR  is kth fuzzy rule, kB  is a constant and fR  is the number of rules. 
4-2.2. Back-Propagation Algorithm for Training the FNN  
The back-propagation learning algorithm is employed to train the connection weights. The 
adjustments to the connection weights, cw , gw  and pw , are computed for the purpose of 
minimizing a cost function defined as the sum of squared errors: 
å -= 2)]()([
2
1)( nyndnE                           (39) 
where )(nE  is the total error energy value in n  iteration, )(nd  is the desired output and )(ny  
is the output of FNN. Let M denote the total number of patterns contained in the training set, the 
average percentage error is defined as 
å
= ÷
÷
ø
ö
ç
ç
è
æ -
=
M
j j
jj
d
yd
M
Eav
1
2
1                           (40) 
The weights cw , gw  and pw  are modified to identify fuzzy rules and tune the 
membership functions in the premises. The adjustment of weights is implemented by 
)()()1( nwnwnw Nji
N
ji
N
ji D+=+                          (41) 
where 
)()()]()([)( 1 nOnfnyndnw Nij
N
ji
-×¢×-×=D h  
)()( 1 nOn Ni
N
j
-××= dh                           (42) 
15 
 provided with the adaptive capability for estimation by combining the filter and the FNN. A flow 
chart of the FNN aided AEKF is presented in Fig. 3, in which there are two main blocks in dash 
lines. The right-hand-side block represents the covariance identification loop, while the 
left-hand-side block is the standard Kalman filter loop. 
As for the selection of training data, one thing needs to be pointed out. The FNN designer 
should have a rough idea on the ranges of noise strengths, kQ  and kRˆ , for certain environment 
where the navigation will be performed. The proposed algorithm may not be a good choice when 
the designer has not any knowledge about the ranges of the noise strengths. Although the FNN 
still demonstrate its adaptation capability, however, the performance will be degraded if range of 
the training data does not cover all possible range (in the testing phase). Wider range of training 
data results in larger training time consumption for obtaining a well-trained network. 
At the time of recall, when the AEKF receives the measurement kz , it provides the 
estimations of the state vector and the -- kk zz ˆ  to calculate the innovation. When the input nodes 
receive the innovation, the appropriate covariance kRˆ  is obtained. Thus, the Kalman filter is 
provided with the adaptive capability for estimation by combining the filter and the FNN. A flow 
chart of the FNN aided AEKF is presented in Fig. 4, in which there are two main blocks in dash 
lines. The left-hand-side block represents the covariance identification loop, while the 
right-hand-side block is the standard Kalman filter loop. Fig. 5 provides the navigation solutions 
using fuzzy neural network aided adaptive EKF. 
As for the selection of training data, the FNN designer should have a rough idea on the 
ranges of noise strengths, kQ  and kR , for certain environment where the navigation will be 
performed. The proposed algorithm may not be a good choice when the designer has not any 
knowledge about the ranges of the noise strengths. Although the FNN still demonstrate its 
adaptation capability, however, the performance will be degraded if range of the training data 
does not cover all possible range (in the testing phase). Wider range of training data results in 
larger training time consumption for obtaining a well-trained network. 
 
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
1 
1uC  
Σ 
Σ 
f 
f 
1 
2uC
Σ 
Σ 
f 
f 
•
•
•
1 
1+p
Cu  
Σ 
Σ 
f 
f 
Π 
Π 
Π 
•
•
•
Π 
Σ ii
Rˆ
gw
cw  
cw  
cw  
gw
gw
gw
gw
gw
1 
 1 
1 
1 
iiQˆ  
pw
pw
pw
(1) (2) (3) (4) (5) 
Consequences Premises 
1 
1 
1 
1 
 
Fig. 2. The topology of a fuzzy neural network. 
17 
  
4-3適應性模糊強跟蹤擴展型卡爾曼濾波器於 GPS導航之設計 
The second topic deals with the application adaptive fuzzy strong tracking extended Kalman 
filtering for GPS navigation. The implementation of Kalman filter requires the a priori 
knowledge of both the process and measurement models. Poor knowledge of the models may 
seriously degrade the Kalman filter performance, and even provoke the filter divergence. To fulfil 
the requirement, an adaptive Kalman filter can be utilized as the noise-adaptive filter to adjust the 
parameters. 
Mehra classified the adaptive approaches into four categories: Bayesian, maximum likelihood, 
correlation and covariance matching. The innovation sequences have been utilized by the 
correlation and covariance-matching techniques to estimate the noise covariances. The basic idea 
behind the covariance-matching approach is to make the actual value of the covariance of the 
residual consistent with its theoretical value. From the incoming measurement kz  and the 
optimal prediction -kxˆ  obtained in the previous step, the innovation sequence is defined as 
--= kkk zzυ ˆ                              (50) 
The innovation represents the additional information available to the filter as a consequence of 
the new observation kz . The weighted innovation, )ˆ( -- kkk zzK , acts as a correction to the 
predicted estimate -kxˆ  to form the estimation kxˆ .  
One of the approaches for adaptive processing is on the incorporation of fading factors. The 
idea of fading memory is to apply a factor matrix to the predicted covariance matrix to 
deliberately increase the variance of the predicted state vector: 
k
T
kkkkk QΦPΦλP +=
-
+1                         (51) 
where ),,( 21 mk diag lll K=λ . The main difference between different fading memory algorithms 
is on the calculation of scale factor matrix kλ . One approach is to assign the scale factors as 
constants. When 1£il ( mi ,,2,1 K= ), the filtering is in a steady state processing while 1>il  , 
the filtering may tend to be unstable. For the case 1=il , it deteriorates to the standard Kalman 
filter. There are some drawbacks with constant factors, e.g., as the filtering proceeds, the 
precision of the filtering will decrease because the effects of old data tend to become less and less. 
The ideal way is to use time varying factors that are determined according to the dynamic and 
observation model accuracy. 
 
4-3.1 Strong tracking Kalman filter 
It is well known that the process model is dependent on the dynamical characteristics of the 
vehicle onto which the navigation system is placed. In order to overcome the defect of the 
conventional Kalman filtering, Zhou et al. [29] proposed a concept of strong tracking Kalman 
filter (STKF) and solved the state estimation problem of a class of nonlinear systems with white 
noise. In the so called STKF algorithm, suboptimal fading factors are introduced into the 
nonlinear smoother algorithm. The STKF has several important merits, including (1) strong 
robustness against model uncertainties; (2) good real-time state tracking capability even when a 
state jump occurs, no matter whether the system has reached steady state or not. Zhou et al 
19 
 value no less than 1) leads to better estimation accuracy; while a smaller b  provides stronger 
tracking capability. The value is usually determined empirically through computer simulation and 
5.4=b  is a commonly selected value.  
 
4-3.2 The fuzzy logic adaptive system (FLAS) 
Fuzzy logic was first developed by Zadeh in the mid-1960s for representing uncertain and 
imprecise knowledge. It provides an approximate but effective means of describing the behavior 
of systems that are too complex, ill-defined, or not easily analyzed mathematically. A typical 
fuzzy system consists of three components, that is, fuzzification, fuzzy reasoning (fuzzy 
inference), and fuzzy defuzzification, as shown in Fig. 6. The fuzzification process converts a 
crisp input value to a fuzzy value, the fuzzy inference is responsible for drawing calculations 
from the knowledge base, and the fuzzy defuzzification process converts the fuzzy actions into a 
crisp action.  
 
Fig. 6. A fuzzy system.  
 
The fuzzification modules: (1) transforms the error signal into a normalized fuzzy subset 
consisting of a subset for the range of the input values and a normalized membership function 
describing the degree of confidence of the input belonging to this range; (2) selects reasonable 
and good, ideally optimal, membership functions under certain convenient criteria meaningful to 
the application. The characteristics of the fuzzy adaptive system depend on the fuzzy rules and 
the effectiveness of the rules directly influences its performance. To obtain the best deterministic 
output from a fuzzy output subset, a procedure for its interpretation, known as defuzzification 
should be considered. The defuzzification is used to provide the deterministic values of a 
membership function for the output. Using fuzzy logic to infer the consequent of a set of fuzzy 
production rules invariably leads to fuzzy output subsets.  
Fuzzy modeling is the method of describing the characteristics of a system using fuzzy 
inference rules. In this paper, a Takagi-Sugeno (T-S) fuzzy system is used to detect the divergence 
of EKF and adapt the filter. Takagi and Sugeno proposed a fuzzy modeling approach to model 
nonlinear systems. The T-S fuzzy system represents the conclusion by functions. The typical T-S 
system is shown as in Fig. 7.  
Membership functions 
 
Rule base 
 
Fuzzification 
 
Fuzzy inference 
 
Defuzzification 
 
21 
 When a designer lacks sufficient information to develop complete model or the parameters will 
slowly change with time, the fuzzy system can be used to adjust the performance of EKF on-line, 
and it will remain sensitive to parameter variations by ‘remembering’ most recent data samples. 
The covariance matrix of the innovation is given by   
kkkkkkk E RHPHυυC +==
- TT ][u                      (60) 
The trace of innovation covariance matrix can be obtained through the relation: 
)( TT kkkk tr υυυυ =                            (61) 
The degree of divergence (DOD) parameters for identifying the degree of change in vehicle 
dynamics can be determined based on the idea of Equations (60) and (61). Examples for possible 
approaches are given as follows. 
(1) Category 1: The innovation information at the present epoch is employed for timely reflect 
the change in vehicle dynamics. The DOD parameter x  can be defined as the trace of 
innovation covariance matrix at present epoch (i.e., the window size is one) divided by the 
number of satellites employed for navigation processing: 
m
kk υυ
T
=x                              (62) 
where Tmk υυυ ][ 21 L=υ , m is the number of measurements (number of satellites). 
Alternatively, the averaged magnitude (absolute value) of innovation at the present epoch can 
also be used: 
å
=
=
m
i
iυm 1
||1z                             (63) 
(2) Category 2: The discrepancy for the trace of innovation covariance matrix between the 
present (actual) and theoretical value is used. The DOD parameter can be of the form: 
m
tr kkkkkk )(
TT RHPHυυ +-
=
-
h                      (64a) 
or 
m
tr kkkkkk |)(|
TT RHPHυυ +-
=
-
h                     (64b) 
The alternative form is the rate for the trace of innovation covariance matrix for the current and 
theoretical value, given by: 
)( T
T
kkkk
kk
tr RHPH
υυ
+
=
-
m                         (65a) 
or  
1
)( T
T
-
+
=
-
kkkk
kk
tr RHPH
υυ
m                        (65b) 
For each of the proposed approach, only one scalar value needs to be determined, and therefore 
the fuzzy rules can be simplified resulting in the decrease of computational efficiency. 
In the FLAS, the DOD parameters are employed as the inputs for the fuzzy inference 
engines. By monitoring the DOD parameters, the FLAS is able to on-line tune the softening 
23 
  
 
 
Fig. 8. Flow chart of the AFSTKF. 
 
 
4-4 粒子族群最佳化與放射狀基底函數網路輔助 GPS/INS整合式導航系統之設計 
 
The third topic deals with the application of the PSO-RBFN for GPS/INS navigation design. 
The conceptual block diagram for the proposed GPS/INS navigation system is shown in Fig. 9. 
Calculation of degree of 
divergence parameters 
(x , z , h  or m ) 
Determination of β 
through FLAS 
Strong tracking loop  FLAS 
-
0xˆ  and 
-
0P  
--= kkk zzυ ˆ  
ï
î
ï
í
ì
³
+
+
=
=
- 1,
1
][
0,
1
00
k
k
T
kkk
T
k
r
r υυV
υυ
V  
T
kkkkkk HQHRγVN --= b  
T
k
T
kkkkk HΦPΦHM =  
][
][
k
k
k tr
tr
c
αM
N
=  
î
í
ì
<
³
=
1,1
1,
,
ki
kiki
ki c
cc
a
aa
l  
kkk xΦx ˆˆ 1 =
-
+  
k
T
kkkkk QΦPΦλP +=
-
+1  
1TT ][ --- += kkkkkkk RHPHHPK  
]ˆ[ˆˆ -- -+= kkkkk zzKxx  
[ ] --= kkkk PHKIP  
25 
 trainable, dynamic systems that can estimate input-output functions and have been applied to a 
wide variety of problems since they are model-free estimators, i.e., without a mathematical model. 
A NN is a network structure consisting of a number of nodes connected through directional links. 
Each node represents a process unit, and the links between nodes specify the casual relationship 
between the connected nodes. The importance of a NN includes the way a neuron is implemented 
and how their interconnection/topology is made. 
Initial population of particles with random 
position xi and velocities vi   
Evaluate the fitness of each particle 
If |fitness (xi)| < |fitness (Pbest)| then Pbest = xi 
If |fitness (xi)| < |fitness (Gbest)| then Gbest = xi 
vi = vi+2*rand()*(Pbest-xi)+2*rand()*(Gbest-xi) 
xi = xi+vi 
Output Gbest and 
fitness (Pbest) 
 
Fig. 10. Flowchart for the PSO algorithm 
One of the other types of neural network is called a radial basis function network. This 
network shuns the biological paradigm in favor of a topology which is simpler and more 
amenable to analysis and training. In an RBFN, only a single layer of nodes with radically 
symmetric basis activation functions is needed to achieve a smooth approximation to an arbitrary 
real nonlinear function. Fig. 11 shows a schematic of a typical RBF network. Unlike the 
multi-layer perceptron (MLP) networks, RBFN has simple architecture of only three layers: input, 
hidden and output layers. The RBFN has an equivalent structure to the so-called optimal 
Bayesian equalization solution, and it can provide the conditional density function (CODF) of the 
transmitted symbols. The overall response of the RBF network )(xF  of Fig. 11 using Gaussian 
function )(xjj  can be formulated as 
)()()(
01
xxx åå
==
=+=
J
j
jj
J
j
jj wbwF jj                      (68) 
and 
÷÷
÷
ø
ö
çç
ç
è
æ -
-= 2
2
2
exp)(
j
j
j
m
s
j
x
x                           (69) 
where x  is the input pattern; jm  represents the center of the RBFN, which have the same 
dimensionality as the input vector ; •  denotes the Euclidean norm; φj(·) is the Gaussian (basis) 
xi: Position vector 
vi: Velocity vector 
Pbest: best fitness encountered by the 
particle 
Gbest: best particle in the swarm 
27 
 covariance matrices of the process noise and measurement noise for the navigation KF. Fig. 12 
shows the PSO-RBFN functional block diagram. 
 
 
Noise corrupted signal 
z 
xNN 
vNN 
Tuning of RBFN parameter (J and σ) 
PSO 
RBFN 
+ 
_ 
 
Fig. 12. PSO-RBFN functional block diagram 
4-4.4 Fitness function for the PSO-RBFN mechanism 
In this paper, the PSO-RBFN mechanism is employed basically for the low pass filtering 
purpose. The RBFN is employed for filtering out the high frequency noise while the PSO is 
employed for obtaining the suitable network parameters so as to obtain good filtering 
performance. 
Expressing the measurement model for certain time interval: 
vxz +=  
where z  is the measurement vector, ][ 1 nkkk zzz ++= Lz ; x  is the state vector, 
T
nkkk xxx ][ 1 ++= Lx ; and v  is the measurement noise vector, Tnkkk vvv ][ 1 ++= Lv . It 
should be noted that the ‘vector’ here is formed by a group of n samples at n time epochs for 
certain state variable. Furthermore, the measurement noise vector taken at the previous epoch and 
is denoted as Tnkkkf vvv ][ 121 ++++= Lv . Taking the difference for ‘current’ epoch and 
‘previous’ epoch, we have  
T
nknkkkkkf vvvvvv ][ 1211 ++++++ ---=-=D Lvvv  
Taking the variance for zD  leads to 
]var[]var[ vxz D+D=D  
For xD  and vD  being mutually independent, we have 
              ]var[]var[]var[ vxz D+D=D                          (72) 
where vD  stands for the difference of measurement noise vector v  for two successively 
epochs.. Taking the variance of vD  leads to 
]var[]var[ fvvv -=D  
      ][][2][2]var[]var[ fff EEE vvvvvv ×+×-+=                (73) 
29 
  
Further examination will be conducted. In this second example, validation on Equations (78) 
will be performed in addition to validation of Equations (76) and (79). Now, a set of 3600 sample 
points corrupted by the Gaussian white sequence were generated using the following function: 
randnttx +-= )10/exp()sin(200  
where pp 4:900/:0=t  and randn  stands for the unity Gaussian white sequence. The original 
vectors ( x , v  and z ) and their difference-between-epoch vectors ( xD , vD  and zD ) are shown 
in Fig. 13. Table 2 provides summary of the statistics for various sequences of concern. Equations 
(78) and (79) both hold and ]var[ vD  is approximately equal to ]var[2 v . 
 
     x          v       z  
 
 
xD         vD        zD  
 
Fig. 13. Original vectors (top) and their difference-between-epoch vectors (down) 
 
Table 2. Statistics for various sequences of concern. 
 
]var[ zD  2.0398 
]var[ xD  0.1052 
]var[ vD  1.9346 
]var[2 v  1.9644 
]var[2]var[]var[ vxz -D-D  -0.0299 
][ fE vv ×  0.0150 
4.4.6 Roles of the PSO-RBFN mechanism 
The detailed design strategy of the PSO-RBFN mechanism is introduced. 
(1) Use of RBFN as a low pass filter  
RBFN is employed to filter out high frequency noises. The RBFN outputs can be utilized for 
deriving the noise variances (process noise and measurement noise) for the navigation filter. 
+ 
+ 
= 
= 
31 
  
 
(a) 
 
(b) 
Fig. 14. (a) PSO-RBFN output as compared to the actual trajectory and noise corrupted trajectory; 
(b) Errors for the PSO-RBFN outputs 
 
Fig. 15. Convergence history of the PSO fitness function  
 
 
 
 
 
 
 
 
 
Network output  
– actual trajectory 
Noise corrupted trajectory 
– actual trajectory 
 
33 
 第五章 結果與討論 
 
本計畫之結果與討論分三部份介紹，分別為：(1) Application of the FNN Aided AKEF to 
GPS and GPS/INSnavigation solutions (模糊神經網路自適應性機制於導航卡爾曼濾波器雜訊
強度之估測及其於 GPS 與 GPS/INS 導航之應用)；(2) Adaptive Fuzzy Strong Tracking 
Extended Kalman Filtering for GPS Navigation(適應性模糊強跟蹤擴展型卡爾曼濾波器於
GPS導航之設計)；以及(3) Application of the PSO-RBFN for GPS/INS navigation design(粒子
族群最佳化與放射狀基底函數網路輔助 GPS/INS整合式導航系統之設計)。 
 
5-1 Application of the FNN Aided AKEF to GPS and GPS/INS navigation solutions 
Simulation experiments have been carried out to evaluate the performance of the proposed 
method in comparison with the conventional methods for GPS and GPS/INS navigation 
processing. Simulation was conducted using a personal computer with Celeron 4 2.93 GHz CPU. 
The computer codes were constructed using the Matlabâ 6.0 version software. The commercial 
software Satellite Navigation (SATNAV) Toolbox, INS Toolbox and Navigation System 
Integration and Kalman Filter Toolbox by GPSoft LLC was employed. The scenario for 
simulation is as following. The user kinematics is assumed to move at a constant velocity with 
mean value sm10  to East and sm310  to North (which results in a speed of sm20 ), 
starting from the position of North 25.15 degrees, East 121.78 degrees. Assume that the 
differential GPS mode is used and most of the errors can be corrected, but the multipath and 
receiver thermal noise cannot be eliminated. The measurement update rate is one second and 
therefore the integration time interval 1=Dt  second is used. The initial measurement variance 
for each of the pseudorange observables is assumed to be 29mr i =r (which is the sum of the 
variances of the code multipath and measurement noise), for ni L1= . After a while, the 
measurement noise standard deviations are raised by ten times of the original one. 
The FNN structure is shown in Fig. 2, with learning rate and momentum both to be 
0.3.Based on the selection of 6=p , the numbers of neurons employed in the present work is as 
follows: 7 neurons in the first (i.e., input) layer; 14 neurons in both the second and third layers; 
12827 =  neurons in the fourth layer; 1 neuron in the fifth layer. The following parameter values 
are used: 1=bias ; three learning rates 9.0,7.0,5.0=h , respectively in the second, third and fifth 
layers; three momentum coefficients 5.0,3.0,1.0=a , respectively in the second, third and fifth 
layers. The parameters are tuned based on our experience. There may be other sets of values that 
will provide better adaptation capability. However, if one chooses the values deviating from the 
present values within some range (for example, about 2.0±  for h ’s and about %50±  for a ’s, 
in the present case), the change of performance is not seen significant.  
The dynamic process of the GPS receiver in medium dynamic environment can be represented 
by the PV (Position-Velocity) model. When selecting Kalman filtering as the navigation state 
estimator in the GPS receiver, using b  and d  to represent the GPS receiver clock bias and drift, 
the differential equation for the clock error is written as 
35 
  
If only the pseudorange observables are available, the measurement equation based on n  
observables leads to 
ú
ú
ú
ú
ú
û
ù
ê
ê
ê
ê
ê
ë
é
+
ú
ú
ú
ú
ú
ú
ú
ú
ú
ú
ú
û
ù
ê
ê
ê
ê
ê
ê
ê
ê
ê
ê
ê
ë
é
ú
ú
ú
ú
ú
û
ù
ê
ê
ê
ê
ê
ë
é
=
ú
ú
ú
ú
û
ù
ê
ê
ê
ê
ë
é
-
ú
ú
ú
ú
û
ù
ê
ê
ê
ê
ë
é
n
n
z
n
y
n
x
zyx
zyx
nn v
v
v
x
x
x
x
x
x
x
x
hhh
hhh
hhh
r
r
r
r
r
r
r
r
r
M
444444 3444444 21
MMMMMMMM
43421
MM
2
1
8
7
6
5
4
3
2
1
)()()(
)2()2()2(
)1()1()1(
2
1
2
1
01000
01000
01000
ˆ
ˆ
ˆ
kHkZ
                (82) 
Assuming measurement errors among satellites are uncorrelated, we have 
ú
ú
ú
ú
ú
û
ù
ê
ê
ê
ê
ê
ë
é
=
n
k
r
r
r
r
r
r
0
0
R
O
2
1
                             (83) 
Since we assumed that the differential GPS (DGPS) mode is used and most of the errors can 
be corrected, but the multipath and receiver measurement thermal noise cannot be eliminated. 
The measurement noise variances irr  value are assumed a priori known, which is set as 9
2m . 
Let each of the white-noise spectral amplitudes that drive the random walk position states be 
sec/)sec/(0.1 2 radmS p = . Also, let the clock model spectral amplitudes be sec)10(4.0 18-=fS  and 
118 sec)10(58.1 --=gS . These spectral amplitudes can be used to find the kQ  parameters in 
Equation (81). Based on the parameter values and scenario presented above, the simulation is 
conducted. Fig. 17 illustrates the system architecture for performing GPS/INS navigation 
solutions using NN aided adaptive EKF. A comparison on the identification results using different 
approaches for the example is provided in Figs. 18 and 19. A comparison of GPS positioning 
errors based on three cases: (1) without adaptation; (2) with adaptation by proposed approach; (3) 
perfect adaptation, are presented in Fig. 18. Results when incorporating FNN adaptation 
mechanism into the GPS/INS navigation system is provided in Fig. 19. Substantial accuracy 
improvement is achieved by using the proposed adaptive technique. 
 
 
 
 
 
 
 
 
 
 
 
37 
 5-2 Adaptive Fuzzy Strong Tracking Extended Kalman Filtering for GPS Navigation 
 
The conceptual block diagram of the GPS navigation processing using the AFSTKF is shown 
in Fig. 20. The simulation scenario is as follows. The experiment was conducted on a simulated 
vehicle trajectory originating from the position of North 25.1492 degrees and East 121.7775 
degrees at an altitude of 100m. This is equivalent to [ ]T2694074.34911080.23042329.2- m in 
the WGS-84 ECEF coordinate system. The location of the origin is defined as the (0,0,0) m 
location in the local tangent East-North-Up (ENU) frame. The three dimensional plot of 
trajectory is shown as in Fig. 21. The description of the vehicle motion is listed in Table 4. In 
addition, vehicle velocity in the east, north, and vertical components is also provided in Fig. 22 
for providing better insight into vehicle dynamic information in each time interval. The related 
setting of parameters for the EKF, STKF and AFSTKF is listed in Table 5. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Fig. 20. GPS navigation processing using the AFSTKF.  
 
 
 
 
 
 
 
 
 
 
 
 
 
Reference 
GPS 
pseudorange 
xˆ  
kz  
STKF 
b  
-- kk zz ˆ  
+ 
- 
measurement prediction 
)ˆ(ˆ -- = kk xhz  
FLAS 
39 
 0 50 100 150 200 250 300 350 400 450
-100
0
100
200
300
400
E
as
t  
km
/h
r
0 50 100 150 200 250 300 350 400 450
-300
-200
-100
0
N
or
th
  k
m
/h
r
0 50 100 150 200 250 300 350 400 450
0
50
100
Time (sec)
A
lti
tu
de
  k
m
/h
r
 
Fig. 22. Vehicle velocity in the east, north, and vertical components. 
 
Table 5. Setting of parameters for the EKF, STKF and AFSTKF. 
 EKF STKF AFSTKF 
i
rr  29m  29m  29m  
dt  sec15.0  sec15.0  sec15.0  
pS  sec//)sec/(0.1 2 radm  sec//)sec/(0.1 2 radm  sec//)sec/(0.1 2 radm  
gS  118 sec)10(58.1 --  118 sec)10(58.1 --  118 sec)10(58.1 --  
fS  sec)10(4.0 18-  sec)10(4.0 18-  sec)10(4.0 18-  
b  NA 4.5 FLAS outputs 
r  NA 0.95 0.95 
iα  NA 1 1 
 
The parameter b  in STKF is a constant and does not change subject to the change in 
dynamics. When the vehicle is in high dynamic environments, a smaller softening factor ( b ) will 
be required for better tracking capability; when the vehicle is in lower dynamic environments, a 
larger b will be needed for better estimation precision. Therefore, the improved versioned of 
STKF, which incorporates the FLAS, can be introduced for automatically adjust the value of b . 
For the vehicle in a very low dynamic environment, b  should be increased to a very large value, 
which leads ki,l  to 1 and results in the standard Kalman filter. 
The philosophy for defining the rules is straightforward: (1) for the case that the DOD 
parameter is small, our objective is to obtain results with better estimation accuracy, and a larger 
softening factor ( b ) should be applied; (2) for the case that the DOD parameter is increased, our 
objective is to increase the tracking capability, and a smaller softening factor should be applied. 
The membership functions (MFs) of input fuzzy variable DOD parameters as shown in Figs. 
23~26 are triangle MFs, obtained by the function:  
41 
 0 5 10 15
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1 Zero 
Small Large 
1.5 
 
Fig. 25. Membership functions of input fuzzy variable h . 
(4) Method 4 – use m  in Equation (65b) as the DOD parameter 
1. IF m  is zero THEN b  is 202 +m  
2. IF m  is small THEN b  is 10+m  
3. IF m  is large THEN b  is 2  
The membership functions of input fuzzy variable m  are provided in Fig. 26. 
0 0.5 1 1.5 2 2.5 3
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1 Zero Small 
Large 
 
Fig. 26. Membership functions of input fuzzy variable m . 
 
Figs. 27 to 32 provide the GPS navigation results for the standard EKF, STKF and AFSTKF 
approaches. For comparison purpose, various types of illustrations are provided, discussed as 
follows. The navigational errors in the East-North plane for the AFSTKF method and the STKF 
method is given in Fig. 27. Subplot (a) and (b), respectively, of Fig. 28 show the East, North and 
Vertical components of navigational errors and the corresponding 1-s  bounds for the STKF and 
the AFSTKF, respectively. Performance comparison between STKF and EKF is shown in Fig. 29; 
performance comparison between AFSTKF and STKF is shown in Fig. 30. Fig. 31 and Fig. 32 
provide the error standard deviation traces of east-component position errors, for STKF versus 
EKF, and for AFSTKF versus STKF, respectively.  
It can be seen that substantial estimation accuracy improvement is obtained by using the 
proposed technique, discussed as follows: 
(1) In the time interval of 0~50 sec, the vehicle is stationary. For this case, all the EKF, STKF and 
AFSTKF provide good results. At this time interval, the DOD is small. At this moment, the FLAS 
gives a larger softening factor b  resulting in the results with better smoothness. 
(2) In the three time intervals, 101~150、201~250、351~450 sec, the vehicle is not maneuvering 
and is conducting constant-velocity straight-line motion for all the three components. By use of 
the T-S fuzzy logic, the FLAS senses smaller values of DOD parameter, and gives a larger 
softening factor resulting in more precise results, too. It is clearly seen that the AFSTKF 
43 
  
 
 
0 50 100 150 200 250 300 350 400
-10
0
10
E
 (m
)
0 50 100 150 200 250 300 350 400
-10
0
10
N
 (m
)
0 50 100 150 200 250 300 350 400
-10
0
10
Time (sec)
U
 (m
)
 
(a) STKF 
0 50 100 150 200 250 300 350 400
-10
0
10
E
 (m
)
0 50 100 150 200 250 300 350 400
-10
0
10
N
 (m
)
0 50 100 150 200 250 300 350 400
-10
0
10
Time (sec)
U
 (m
)
 
(b) AFSTKF 
Fig. 28. East, north and up components of the navigation results and the corresponding 1-s bound 
based on the STKF method and AFSTKF method. 
 
 
45 
  
0 50 100 150 200 250 300 350 400 450
-15
-10
-5
0
5
10
15
E
as
t (
m
)
Time (sec) 
 
(a) East  
0 50 100 150 200 250 300 350 400 450
-12
-10
-8
-6
-4
-2
0
2
4
6
8
N
or
th
 (m
)
Time (sec)  
(b) North  
0 50 100 150 200 250 300 350 400 450
-8
-6
-4
-2
0
2
4
6
8
Time (sec)
A
lti
tu
de
 (m
)
 
(c) Altitude  
Fig. 30. Navigation accuracy comparison for AFSTKF and STKF. 
 
 
 
AFSTKF (solid) 
AFSTKF (solid) 
STKF (dashed) 
STKF (dashed) 
AFSTKF (solid) 
STKF (dashed) 
47 
47 
 5-3 Application of the PSO-RBFN for GPS/INS navigation design 
Satellite constellation was simulated and the error sources corrupting GPS measurements 
include ionospheric delay, tropospheric delay, receiver noise and multipath. The positioning result 
obtained form GPS is based on the least-squares approach. It assumed that there is no GPS failure 
during simulation. The INS errors are assumed to be follows: initial east velocity error: 2 m/s; 
initial north velocity error: 2 m/s; body-x tilt error = 0.1 milli-radian; body-y tilt error = 0.1 
milli-radian; x-acceleration bias = 500 micro-g; y-acceleration bias = 500 micro-g; acceleration 
noise = 0.00001 km/hour2; gyro bias = 0.0015 deg/hr; gyro noise = 0.00001 deg/hr2.  
Fig. 34 shows the vehicle trajectory and Fig. 35 gives the velocity components and Euler 
angles for the vehicle for simulation. Detailed trajectory information of vehicle trajectory for 
simulation is given in Table 6. The trajectory of the aircraft can be approximately divided into 
three zones according to the dynamic characteristics: (1) At Zone 1, the aircraft performed 
highest dynamic flight, during the time interval 0-11 min; (2) At Zone 2, the aircraft performed 
medium dynamic flight, during the time interval 11-22 min; (3) At Zone 3, the aircraft performed 
straight line flight, during the time interval 22-32 min. The characteristics of the trajectory can be 
approximately divided into three zones, in which low dynamic motion is involved during 
698-1314 second; medium dynamic maneuvering is involved during 1314-1914 second; high 
dynamic maneuvering is involved during 0-698 second. The initial position of the aircraft was 
located at the position North 39o degrees and West 82o degrees at an altitude of 1000 meters. This 
is equivalent to  
[ ]T3992328.014915038.01-690763.55 m 
in the WGS-84 ECEF coordinate system. 
 
 
 
49 
 to be adjusted. The parameters used in the PSO are as follows: 
- Number of samples for the measurements: 300; 
- Maximum J value: 30;  
- Number of particles in each swam: 5; 
- Number of iterations (generations) for each searching process (epochs): 30;  
- Window size for NNw-s  derivation: 30;  
- Window size for NNv-s  derivation: 30. 
(2) Kalman filter parameters 
The parameters in the Kalman filter recursive loop include kΦ , kH , kQ and kR .  
Matrices kΦ  and kQ are obtained through the setting: 
    
ú
ú
ú
ú
ú
ú
ú
ú
û
ù
ê
ê
ê
ê
ê
ê
ê
ê
ë
é
=
000000
0I0000
00I000
000000
0000I0
000000
W ;
ú
ú
ú
ú
ú
ú
ú
ú
û
ù
ê
ê
ê
ê
ê
ê
ê
ê
ë
é
=
000000
00000
00000
000000
000000
000000
G
g
a
s
s
   
where I*981.9*3.0 -= eas ; I*81 -= egs . Through  W and G  matrices, kΦ  and kQ  can 
be computed. In addition, [ ]  00000IH =k ; IR ´= prk , where 100=pr . The ‘0’s in 
 W , G  and kH  are 33´  matrices of zeros. The initial values of covariance matrix and state 
vector, -oxˆ  and  -oP , respectively, are 
118ˆ ´
- = 0xo ;  
000
000
000
000
18,18
1,1
1,1
ú
ú
ú
ú
ú
û
ù
ê
ê
ê
ê
ê
ë
é
=-
p
p
p
o O
P  
where prppppp ===== 18,1817,1716,162,21,1 ;  
45,54,4 == pp ;  
819,98,87,7 -=== eppp ;  
2
12,1211,1110,10 4)(9.81e -=== ppp ;  
4515,1514,1413,13 -=== eppp ;  
06,63,3 == pp . 
 
The positioning errors based on the standard KF and as compared to the proposed method 
are shown in Figs. 36 and 37. Fig. 36 presents the result for which no differential correction is 
applied; Fig. 37 presents the result for which differential correction is applied. Table 7 provides 
the RMS position errors in the East (top) and North (bottom) components for all the three zones. 
Substantial performance improvement is clearly seen for both the modes without and with 
differential correction. 
 
 
 
 
51 
  
Table 7. RMS position errors in the East (top) and North (bottom) components (unit: meters) for 
DGPS mode. 
 
 Zone 1 Zone 2 Zone 3 
DGPS 0.9208 0.8888 0.8214 
Standard KF 1.2640 1.7727 1.7783 
Proposed method 0.3807 0.2788 0.2220 
 
 Zone 1 Zone 2 Zone 3 
DGPS 1.6600 1.6258 1.5728 
Standard KF 1.4174 2.3057 1.0984 
Proposed method 0.5793 0.6219 0.4905 
 
 
A fuzzy neural network aided adaptive extended Kalman filtering approach for GPS 
navigation has been presented. The fuzzy neural network was employed as a noise identification 
mechanism to implement the on-line identification of noise covariance matrices. Based on the 
proposed approach, the noise adaptive capability can be significantly improved as compared to 
the conventional innovation-based algorithms. The algorithm presented in this paper can be 
applied to all the Kalman filtering related applications, such as GPS/INS integration, radar target 
tracking, and so forth. 
The conventional extended Kalman Filter requires more states for better navigation accuracy 
and does not present the capability to monitor the change of parameters due to changes in vehicle 
dynamics. Traditional strong tracking Kalman filter (STKF) approach for determining the 
softening factors heavily relies on personal experience or computer simulation using a heuristic 
searching scheme. This paper has presented an adaptive fuzzy strong tracking Kalman filter 
(AFSTKF) for GPS navigation processing to prevent the divergence problem in high dynamic 
environments. Through the use of fuzzy logic, the FLAS in the AFSTKF has been employed as a 
mechanism for timely detecting the dynamical changes and implementing the on-line tuning of 
softening factor by monitoring the innovation information so as to maintain good tracking 
capability. When a designer does not have sufficient information to develop the complete filter 
models or when the filter parameters are slowly changing with time, the fuzzy system can be 
employed to enhance the STKF performance. By use of the FLAS, lower order of filter model 
can be utilized and, therefore, less computational effort will be sufficient without compromising 
estimation accuracy significantly. The navigation accuracy based on the proposed method has 
been compared to the STKF and EKF and has demonstrated substantial improvement in both 
navigational accuracy and tracking capability.  
Incorporation of PSO-RBFN mechanism into the Kalman filter design has been presented. 
Fitness function for the PSO-RBFN mechanism has been proposed and the feasibility has been 
checked. The PSO is employed to search for the optimal RBFN parameters such that the 
PSO-RBFN is able to filter out high frequency noises (act as a low pass filter). The PSO-RBFN 
53 
 [15] Horikawa, S., Furuhashi, T.  Uchikawa, Y., “On fuzzy modeling using fuzzy neural 
network with the back-propagation algorithm,” IEEE Trans. Neural Network, vol. 3, 1992, pp. 
801-806. 
[16] Juang, J. G., “Fuzzy neural network approaches for robotic gait synthesis,” IEEE Trans. on 
Syst., Man and Cybern., Part B: Cybernetics, vol. 30, 2000, pp. 594-601. 
[17] Kennedy, J., and Eberhart, R., “Particle Swam Optimization,” Proc. IEEE Neural Network 
Conf., Perth, Australia (1995) 1942–1945 
[18] Kobayashi, K. Cheok, K. Watanabe, K., “Estimation of the absolute vehicle speed using 
fuzzy logic rule-based Kalman filter,” in Proc. American Control Conf., Seattle, 1995, pp. 
3086-3090. 
[19] Kong, X., Nebot, E. M., Durrant-Whyte, H., “Development of a non-linear psi-angle 
modelfor large misalingment errors and its application in INS alignment and calibration,” 
Proceedings of the 1999 IEEE International Conference on Robotics & Automation, 1999 
1430~1435 
[20] Mehra, R. K., “Approaches to adaptive filtering,” IEEE Trans. Automat. Contr. AC-17, 
1972, pp. 693-698. 
[21] Mehra, R. K. “On-line identification of linear dynamic systems with applications to Kalman 
filtering,” IEEE Trans. Automat. Contr. AC-16, 1970, pp. 12-21. 
[22] Mohamed, A. H., Schwarz, K. P., “Adaptive Kalman filtering for INS/GPS,” Journal of 
Geodesy, vol. 73, 1999, pp. 193-203. 
[23] Mostov, K. Soloviev, A. “Fuzzy adaptive stabilization of higher order Kalman filters in 
application to precision kinematic GPS,” in Proc. ION GPS-96, vol. 2, Kansas City, 1996, pp. 
1451-1456. 
[24] Reynolds, R. G. and Sverdlik, W. “Problem solving using cultural algorithms Evolutionary 
computation,” Proc. IEEE World Congress on Computational Intelligence, vol. 2 pp.645-650, 
1994. 
[25] Salychev, O., Inertial Systems in Navigation and Geophysics, Moscow: Bauman MSTU 
Press, 1998. 
[26] Sasiadek, J. Z., Wang, Q., Zeremba, M. B., “Fuzzy adaptive Kalman filtering for INS/GPS 
data fusion,” in Proc. 15th IEEE int. Symp. on intelligent control, Rio, Patras, Greece, 2000, 
pp.181-186. 
[27] Takagi, T. Sugeno, M. “Fuzzy identification of systems and its application to modelling and 
control,” IEEE Trans. Syst., Man, Cybern., vol. SMC-15, 1985, pp. 116-132. 
[28] Yang, C. and Simon, D., “A new particle swarm optimization technique,” Proc. 18th 
International Conference on Systems Engineering, 2005. 
[29] Zhou, D. H., Frank, P. M. “Strong tracking Kalman filtering of nonlinear time-varying 
stochastic systems with coloured noise: application to parameter estimation and empirical 
robustness analysis,” Int. J control, vol. 65. no.2, pp.295-307, 1996. 
 
 
 
55 
 可供推廣之研發成果資料表 
□ 可申請專利  ▉ 可技術移轉                                      日期：96年 1月 30日 
國科會補助計畫 
計畫名稱：以模糊神經網路實現 GPS與 GPS/INS導航之自適應濾
波(2/2) 
計畫主持人：卓大靖         
計畫編號：NSC 94-2212-E-019-003   學門領域：航太工程 
技術/創作名稱 
模糊神經網路自適應性機制於導航卡爾曼濾波器雜訊強度之估測
及其於 GPS與 GPS/INS導航之設計、自適應性模糊強跟蹤擴展型
卡爾曼濾波器於 GPS導航之設計、粒子族群最佳化與放射狀基底
函數網路輔助 GPS/INS整合式導航系統之設計。 
 
發明人/創作人 卓大靖 
中文：當系統之數學模型不夠精確抑或存在建模不確定性時，使用
自適應性卡爾曼濾波器，可線上(on-line)估計並調整濾波器內部之
系統數學模型與雜訊強度，進而提昇濾波器之性能。此處採用三種
方式提昇濾波精確度，分別為：(1) 模糊神經網路自適應性機制於
導航卡爾曼濾波器雜訊強度之估測及其於 GPS與 GPS/INS導航之
應用；(2) 自適應性模糊強跟蹤擴展型卡爾曼濾波器(adaptive fuzzy 
strong tracking Kalman filter (AFSTKF)於 GPS導航之設計，及其(3) 
粒子族群最佳化(Particle Swarm Optimization, PSO)與放射狀基底函
數(Radial Basis Function, RBF)網路輔助 GPS/INS整合式導航系統
之設計。 
技術說明 英文：The adaptive algorithm has been one of the approaches to 
improve the estimation accuracy of the EKF when precise knowledge 
on the system models is not available or not precisely known. Three 
approaches for improving the navigation accuracy is proposed: (1) 
application of the FNN aided AKEF to GPS and GPS/INS navigation 
solutions for identifying the measurement noise covariance matrix; As 
a dynamic model corrector, the FNN is employed to aid the Kalman 
filter for real-time identification of nonlinear dynamics errors, 
especially when the modeling of uncertainty is considered in the 
problem. (2) adaptive fuzzy strong tracking Kalman filtering 
(AFSTKF) for GPS Navigation; (3) application of the PSO-RBFN for 
GPS/INS navigation design, as the dynamic model correctors for 
identifying the real-time nonlinear dynamics modeling error.. 
可利用之產業 
及 
可開發之產品 
結合智慧型與最佳化理論於自適應導航系統之設計，含(1)模糊神經
網路自適應性機制於導航卡爾曼濾波器雜訊強度之估測及其於
GPS與 GPS/INS導航之設計;(2)自適應性模糊強跟蹤擴展型卡爾曼
濾波器於GPS導航之設計;(3)粒子族群最佳化與放射狀基底函數網
路輔助 GPS/INS整合式導航系統之設計等，可適用於導航航電產
品精確度與系統穩定性之提昇。 
57 
出席國際學術研討會會議報告 
卓大靖 
國立台灣海洋大學 通訊與導航工程學系 
 
I. ICNC-FSKD 2005國際學術研討會 
國際學術研討會- 2005 International Conference on Natural Computation，於 2005年 8月
27-29日於中國湖南長沙舉行(圖一)。 
與會人員來自世界 32國家或地區，乃一規模相當龐大之會議。共有 3136篇論文投稿， 502
篇論文接受發表，接受率僅有 26.6%。研討會論文主題涵蓋了 Neural Network Learning 
Algorithms, Neural Network Architectures, Neuraldynamics, Statistical Neural Network Models 
and Support Vector Machines, Cognitive Science, Neuroscience Informatics, Bioinformatics, 
Bio-medical Engineering, Neural Network Applications, Evolutionary Learning, Artificial Immune 
Systems, Membrane, Molecular, and DNA Computing, Ants Colony, Quantum Computing, Swarm 
Intelligence and Intelligent Agents 等諸項重要之議題。筆者於 8月 29日進行口頭報告，題目
為“ANFIS Based Dynamic Model Compensator for Tracking and GPS Navigation Applications”。
由於應用卡爾曼濾波器(Kalman filter)進行狀態估測時，必須明確掌握系統的狀態空間模型。
GPS 與雷達目標物追蹤的數學模型之建立，無論濾波間隔之選擇多小，系統的數學描述都仍
是非線性的。對於此非線性系統，目前尚沒有一種比較完善的濾波方法，現有的濾波算法都
是在一定的假設下的近似方法。當系統的數學模型不夠精確或者存在建模之不確定性時，這
種濾波器就會呈現不穩定行為。本論文係利用模糊化類神經網路(ANFIS) 於動態誤差之補
償，來補償卡爾曼濾波器。藉由類神經網路的適應性學習能力得以補償卡爾曼濾波器動態模
型之不確定性，以克服傳統卡爾曼濾波器之限制。文中採用了糊化類神經網路，應用於 GPS
導航與雷達追蹤濾波器之設計。此報告引起許多與會專家之興趣，獲得了許多廻響，之後亦
與聽眾進行了心得交換。 
 
 
 
 
 
 
  
圖一、筆者攝於研討會會場。 
