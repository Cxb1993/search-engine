1 
目  錄 
中文摘要…………………………………………………………………………………………1 
英文摘要…………………………………………………………………………………………1 
第一章 簡介…………………………………………………………………………………2 
1.1 數位產權管理系統的角色與運作機制………………………………………………3 
1.2 目前現行數位產權管理介紹…………………………………………………………10 
1.2.1 Apple－FairPlay…………………………………………………………………10 
1.2.2 Microsoft－Windows Media Right Management……………………………13 
1.2.3 Microsoft－Window Right Management Services System……………………16 
1.2.4 InterTrust－Rights|System ………………………………………………………22 
1.3 目前數位產權管理系統的潛在問題………………………………………………24 
第二章我們所提出的數位產權管理整合方案…………………………………………25 
2.1 我們設計的三層技術劃分…………………………………………………………26 
2.2.1 上層：多媒體層(Multimedia Layer)………………………………………………26 
2.2.2 中層：權利描述語言編譯層(REL Interpreter Layer)……………………………28 
2.2.3 下層: OS & Hardware Layer……………………………………………………28 
2.2 各層之間的身分驗證…………………………………………………………………33 
2.3 產權描述語言的整理與轉換………………………………………………………33 
2.3.1 產權描述語言的標籤設計………………………………………………………34 
2.3.2 數位內容以及產權檔案的準備階段……………………………………………37 
2.3.3 數位內容的使用階段……………………………………………………………43 
2.4 系統相容(跨平台溝通)…………………………………………………………………46 
第三章我們所提出的保障合理使用權方案……………………………………………………46 
3.1 可攜性與合理使用權的問題………………………………………………………48 
3.2 保障合理使用權的線上數位產權管理系統設計……………………………………50 
3.2.1 註冊與私鑰分割託管階段…………………………………………………………52 
3.2.2 購買階段……………………………………………………………………………53 
3.2.3 播放階段……………………………………………………………………………54 
第四章 家庭數位內容共享……………………………………………………………………55 
4.1 具合理使用的家庭數位內容共享機制……………………………………………56 
4.1.1 設備製造初始階段…………………………………………………………………57 
4.1.2 設備啟動階段………………………………………………………………………57 
4.1.3 數位內容與使用執照取得階段……………………………………………………60 
第五章  系統分析………………………………………………………………………………62 
5.1 DRM 三層設計的系統分析…………………………………………………………62 
5.2 保障合理使用權的線上數位產權管理系統設計分析……………………………62 
5.3 具合理使用的家庭數位內容共享設計分析………………………………………64 
第六章 結論…………………………………………………………………………………66 
第七章 參考文獻………………………………………………………………………………69 
1 
 
建立更安全公平的跨平台數位產權管理機制 
中文摘要 
數位產權管理系統是由資訊技術元件與服務組成的系統，符合相關法律、政
策、商業模式的一種智慧財產發佈與有效控管產權的機制。現存的數位產權管理
(Digital Right Management, DRM)系統，在獨立發展下，各自有不同的管理機制
與支援不同格式的數位內容，平台之間也不能相容，屬於封閉式系統，對使用者
的限制繁多。如此的發展，數位產權管理系統的推動恐不樂觀。本計畫將針對此
問題進行探討，並提出數位產權管理系統的分層設計與溝通機制，實現開放性架
構的數位產權管理系統，達到可以跨平台相容的目標。將數位產權管理系統做更
清楚的分層設計，讓廠商能在擅長的層級開發相關功能，合作開發出相容的數位
產權管理系統。 
關鍵詞：資訊安全、數位產權管理、合理使用 
英文摘要 
Digital rights management is a system of information technology components 
and services along with corresponding law, policies and business models which strive 
to distribute and control intellectual property and its right. All of the existing digital 
rights management systems are developed independently with particular design of 
management mechanism and different digital content format. There is not existence 
any interface which can be used to integrate the different digital right management 
systems. There is a lot of restriction for user. It will be not optimistic for further 
development. This project is preparing to propose a layered digital rights management 
system. Moreover, we will design the interface for the cross-platform utilization. And 
we will design an open system architecture for the digital right management systems 
with clear layer interface. The layered architecture can make the development of the 
digital right management system under cooperation of the information technologic 
companies.  
Keywords: Information Security, Digital Right Management (DRM), Fair Use 
 
 
 
 
 
 
 
3 
 
1.1 數位產權管理系統的角色與運作機制 
數位產權管理系統的運作是整合多種軟硬體技術之實施，包括：數位內容的
呈現、複雜的產權控管機制、數位內容與產權保護，使數位內容擁有者能有效保
護他們的數位內容產品，防止任何的非法使用，使用者必須付費並取得使用執照
後，依執照的權限來使用數位內容。為符合這樣的需求，一般數位產權管理系統
的規劃，都是針對下列四種角色的互動來做設計： 
一、 數位內容創作者(Content Provider)： 
數位內容創作者會先將數位內容進行加密，以限制數位內容的流通，
並製作該數位內容相對應的產權，賦予數位內容使用上的限制。然後
將封裝的數位內容和產權分別安全地傳送至數位內容經銷者和使用執
照供應商。 
二、 使用執照供應商(License Server 或 Clearing House)： 
負責保管數位內容使用執照(內含產權與保護金鑰)的機構。 
三、 數位內容經銷者(Content Distributor)： 
為數位內容創作者和使用者之間的媒介，主要提供一個傳播的管道，
負責販賣或散佈由數位內容創作者合法加密過後的數位內容。 
四、 使用者端(Client)： 
整個系統中，使用者是最不被信任的，因為任何一個使用者都有可能
想要破解受保護的數位內容。所以為了要確保整個系統能夠安全運
作，使用者端的數位產權執行軟硬體(DRM-enabled Application)必須具
備 Tamper Proof 的特性，不致於讓惡意使用者能夠竄改軟硬體的保護
措施，確保數位內容僅能依其權限使用。 
 
圖 1、數位產權管理系統的運作 
5 
 
 
圖 1、數位產權管理系統的的五大安全技術 
 
一、密碼學機制(Cryptographic Mechanisms) 
使用加密和簽章等密碼學技術，可以達成資料傳輸時的資料保密性、完整
性、不可否認性等，而在數位產權管理系統也都使用到這類的密碼學機制： 
（一）對稱式加密法(Symmetric Encryption) ：  
為了防止非法複製數位內容，且在使用者得到合法使用執照後能快
速解出內容，所以採取對稱式加密法對數位內容做加密。 
（二）非對稱式加密法(Asymmetric Encryption)： 
使用執照供應商所傳送的使用執照 (License)，因為包含可解開數位
內容的對稱式金鑰，故在傳送給使用者的過程中，是以使用者端的
公開公鑰做非對稱式加密，只有對應的私密金鑰才能解出使用執
照，並進一步解得數位內容。 
（三）數位簽章(Digital Signature)：     
在數位產權管理系統中通常使用數位簽章來達到使用執照發佈的不
可否認性，所以使用執照供應商可對核發的使用執照作簽章，以供
使用者端的數位產權執行軟體(或硬體)可驗證使用執照的合法性。 
（四）雜湊函數(One-way hash functions)： 
使用執照供應商核發的使用執照，是採用其雜湊值來做簽章，以確
保其完整性。 
 
7 
 
z 自我修改的程式碼(self-modifying Code) ： 
在 2002 年由 Cloakware 公司發表一種 One-Way program 
translation tool，可讓程式轉換成獨一無二且可抵禦攻擊的形式， 
而利用這樣的機制，每個使用者端的數位產權執行軟體解被改寫
成不同形式的的程式碼，對於有意要破解的人而言，更加提高其
破解的困難度。 
 
（二）用硬體技術(Hardware Based Technologies)達到防止竄改之目的： 
以硬體技術為主的解決方案，是由硬體或作業系統提供所謂的
"Hardware Trust Space"，將使用者端的數位產權執行軟體(或硬體)、
使用執照、數位內容解密後的型態都控制儲存於此空間內，此空間
可防止外界惡意程式的攻擊，讓數位產權執行軟體在安全的環境中
執行，成為所謂的"Trusted Software"。如同目前許多業者為了強化數
位產權管理系統機制的安全運作，紛紛針對數位產權管理系統平台
提出技術標準的制定，如 Intel 所提倡的 “Trusted Computing 
Group”[34] ， 以 及 微 軟 公 司 所 提 倡 的 “Next-Generation Secure 
Computing Base”計畫(前身為 Palladium 計畫)[22]，也就是說他們的
目標皆是致力於促成新一代具有安全、信任能力的硬體運算平台，
來完成更安全的個人計算機標準，使得硬體與作業系統對於應用軟
體有更佳的安全監控功能，盜版軟體或被竄改的軟體將無法運作。
簡而言之，在 Trusted Computing 上所執行的應用軟體可以實施非常
有力的版權控制，一旦使用者開機成功，其電腦變為一台具有擁有
唯一識別碼的計算機，可為業者認證所使用的應用軟體是否具合法
性。故可保障盜版軟體無法在此平台上運作或是控制數位內容的合
法性播放。 
 
   所以，使用者端的數位產權執行軟硬體若能確保不可竄改，則使用者端
便是可信任的。因此當使用者欲使用數位內容時，只有使用者端數位產權
執行軟硬體的私密金鑰或是使用者憑證才能解開使用執照，得出數位內容
的金鑰與產權，在產權規範下解密數位內容，並在安全的環境中使用數位
內容，不會有非法外流的情況，如圖 3 所示。這也是先前我們介紹過的，
整個過程是在使用者端的應用層、產權解譯層、作業系統層和硬體層等共
同合作，才能達到所需的安全性。 
 
 
9 
 
解數位產權管理系統。故在數位產權管理系統中，為了防止這樣類
似的攻擊，進而提出利用浮水印嵌入數位內容的方式，直到輸出至
周邊設備才由硬體將會造成雜訊的浮水印移除。且這裡嵌入的浮水
印必須能夠承受像是類比/數位訊號轉換、濾波處理、壓縮等過程，
而且當浮水印被非法移除時會嚴重影響數位內容的播放品質，這樣
就不用擔心有心人士以取代裝置驅動程式擷取數位內容的攔截攻
擊。 
 
五、產權描述語言(Right Expression Languages)： 
產權利描述語言是為了能夠完整描述繁瑣、複雜的使用權限而產生的，為
了跨平台與可攜性之目的，採用 XML(eXtensible Markup Language)來做設
計。數位產權管理系統的運作，基本上是將數位內容與使用執照分開的，
一份數位內容可以有許多份的使用執照，每份使用執照可以針對不同的使
用者制訂不同的使用授權，數位內容使用權限就是以產權描述語言來訂
定，像是使用期限、存取頻率、產權移轉次數和授權對象等等。且由上述
可知數位產權管理系統的安全機制須結合應用層、作業系統層和硬體層之
間的合作才能達到所需的高度安全性，而其中各層之間的溝通亦需利用產
權描述語言做彼此間的通訊。 
目前各家數位產權管理系統採用的產權描述語言，以下列兩種為主：  
   (一)  Extensible right Markup Language (XrML)[9]： 
由ContentGuard公司所設計，目前已應用於MPEG、OASIS、The Open 
eBook Forum(OeBF)等標準組織，並有電子書、數位出版、數位廣播、
音樂、影片、數位電影/電視等領域的應用，已有許多知名大廠諸如：
Microsoft、Adobe、Sony、HP 和 Xerox 等及一些著名出版商率先採
用。 
   (二)  Open Digital Rights Language (ODRL)[28]： 
由智慧財產權體系(IPR System)所發起，目前已被公開行動聯盟
(Open Mobile Alliance, OMA)所採用，做為行動通訊裝置設備所使用
的權利語言，並已實際應用於多個計畫中(例如 COLIS 計劃及
OpenIPMP)。ODRL 誕生的理念是為了推廣 Open Source 的精神，
ODRL 通常被認為是 XrML 的 Lite 版，因為其架構設計較為簡單也
只著重在多媒體數位內容的產權規範。很多公司包括 Nokia 宣稱支
援 ODRL 初步概念，RealNetworks 一開始採用 XMCL(eXtensible 
Media Commerce Language)做為自家數位內容(MPEG-21)的產權描
述語言，但自 ODRL 上市後便改用 ODRL
11 
 
算法將裝置硬體序號資料 hash 成唯一識別碼，並將使唯一識別碼和
AppleID  一起傳送至 Fairplay 伺服器。 
Step 3 ︰因為數位產權管理機制—Fairplay 限制一首歌曲最多只能在 5 台不同電
腦播放，所以 Fairplay 伺服器會檢查此帳號是否已註冊五個不同的硬體
識別碼，若沒有便將此唯一識別碼登錄進來。 
Step 4 ︰每個會員都有一把對稱式金鑰CK  (Content Key)，會員在 iTune 音樂商
店購買下載的音樂會用這把金鑰加密。所以在這個步驟，FairPlay 伺服
器會將使用者的金鑰傳回使用者端的電腦。 
Step 5 ︰使用者端 iTune 程式會將金鑰儲存至本地端的 SC Info file 檔案中。 
Step 6 ︰使用者端 iTune 程式利用第二步驟所產生的唯一識別碼，將 SC Info file
加密保護起來。 
 
圖 4、FairPlay 使用者購買和播放階段 
 
1.2.1.2 購買與播放階段 
Step 1 ︰使用者登入 iTune 音樂商店後便可購買數位內容。 
Step 2 ︰iTune 音樂商店便透過 Fairplay 伺服器得到帳號使用者的加密金鑰。 
Step 3 ︰iTune 音樂商店利用此把金鑰將使用者所購買的數位內容作加密，才傳
送至使用者端。 
13 
 
1.2.2 Ｍicrosoft－Windows Media Right Management 
微軟公司的 Microsoft Windows Media Right Management(WMRM)數位產權
管理系統[23]主要支援 Windows Media Audio(WMA)檔案格式的數位音樂，同樣
是一個封閉式系統。WMRM 的運作流程主要分為四個階段：1.播放軟體獨特化、
2.數位內容創作者的註冊與產權的定義、3.數位內容的封裝、4.數位內容的購買
及使用執照的取得。 
 
圖 5、Windows Media Right Management 的獨特化機制過程  
 
1.2.2.1 [播放軟體獨特化階段] 
Step 1 ︰使用者進行 Windows Media Player 更新時，系統會主動抓取其裝置的硬
體序號向伺服器註冊。 
Step 2 ︰伺服器端以每個裝置的硬體序號產生一組 RSA 金鑰對。 
Step 3 ︰伺服器端產生唯一動態鏈結檔檔案（Dynamic Link Library）。 
Step 4 ︰將產生的私密金鑰嵌入動態鏈結檔內。   
Step 5 ︰將檔案安全傳送至使用者端。 
Step 6 ︰使用者端將此唯一動態鏈結檔與 Windows Media Player 結合，成為獨特
化的數位產權執行軟體(或硬體) 。 
 
 
15 
 
Step 8 ︰使用執照供應商利用 KeyID 和本身所儲存的 KeySeed 結合運算得到CK
且將此CK 置入使用執照。 
Step 9 ︰使用執照供應商利用使用者端 Media Player 軟體的公鑰，將含有CK 的
使用執照加密後，安全的傳送給使用者。 
Step 10 ︰使用者端 Media Player 軟體之獨特化動態鏈結檔有對應的私密金鑰，
可解密得到使用執照裡的CK ，再以CK 解出數位內容，並在產權規範
下使用數位內容。 
 
1.2.2.5 安全機制分析 
一、 密碼學機制(Cryptographic Mechanisms)： 
使用對稱式加密法來保護數位內容，並以非對稱式加密法來保護使用執
照。 
二、獨特化機制(Individualization)： 
Media Player 軟體會主動抓取其裝置的硬體序號向微軟公司的伺服器註
冊，伺服器以裝置的硬體序號產生一組 RSA 金鑰，然後產生唯一 DLL
動態鏈結檔，將產生的私密金鑰嵌入動態鏈結檔內。要請求下載數位內
容的使用執照時，會以 Media Player 軟體的公鑰加密使用執照傳送回
去，最後該名使用者的 Media Player 軟體才能解出數位內容。這樣的過
程，達成播放裝置的獨特化，使用者購買的數位內容因此限定只能在這
些裝置播放。 
三、不可竄改性(Tamper Resistance)：    
使用者端的 Media Player 軟體內存有私密金鑰與使用執照，其安全性皆
由 Windows 作業系統做嚴格的存取控制，其採取的保護措施有： 
 應用程式的排除(Application Exclusion)：提供機制禁止除了已授權
播放程式之外的應用程式播放特定的封裝檔案 
 DRM 元件的排除(DRM Component Exclusion)：提供機制供 DRM
元件遭到破壞時，則數位產權管理服務機制可拒絕授權給予播放數位
內容。 
 
17 
 
 RMS Server： 
是 Windows Server 2003 系統的一個服務，負責管理資訊保全的權限授
權工作。使用者在經過 Active Directory 驗證身份後，RMS Server 就可
根據文件的權限設定，負責核發授權給使用者。  
 RMS Client： 
於使用者端與 RMS Server 搭配，取得文件之使用授權。 
 RMS Add-on for IE： 
安裝於使用者端之免費軟體，讓 IE 擁有 E-DRM 功能，讓需要存取受保
護的文件時，就算沒有 Office 2003，仍可使用 IE 閱讀有權讀取的文件。 
 Office 2003： 
Word、Excel、PowerPoint、Outlook內建 IRM功能，可以連線到RMS Server
或微軟的 Passport 網站，實施企業或個人對於 Office 文件的使用權限管
理，使用者可以定義誰可以開啟、讀取、修改和轉發佈內容，保護網頁
內容、Office 文件和電子郵件，就算被散佈出去，也只有合法授權的使
用者可以開啟。 
    在介紹整個 Window Right Management Services System 之前，首先介紹在此
系統中應用的憑證以及產權。最後再探討整體應用層面的運作方式。RMS 提供
下列三種憑證和二種使用執照，來達到合法地使用數位文件。 
 RMS 電腦憑證(Security Processor Certificate, SPC)： 
使用者端的電腦必須具備 RMS 電腦憑證，才能被識別並為 RMS 系統所
信任。在使用者啟動 RMS 功能時，電腦會自動產生一個 RMS 電腦憑證。 
 權限帳號憑證(Right Account Certificate, RAC)： 
用以識別使用者帳號與特定電腦相關聯的權限帳號憑證。當使用者要求
存取受 RMS 保護的數位內容，需提供自己的權限帳號憑證。 
 用戶端授權人憑證(Client License Certificate, CLC)： 
使用者取得用戶端授權人憑證，即可對自己的創作發行受 RMS 保護的
權限。 
 發行授權(Publication License, PL)： 
RMS 相容應用程式的使用者可以指派檔案與資訊的使用權限。這些使
用權限儲存在發行授權中，指定哪些人可檢視內容，以及編輯與發佈內
容的方式。 
 使用授權(Utilization License, UL)： 
要使用受 RMS 保護的內容，需要取得使用授權。收到 RMS 保護內容
及該內容發行授權中提到的使用者，均可以要求使用授權。 
19 
 
 
圖 8、CLC 憑證的產生階段  
 
1.2.3.2 CLC 憑證的產生階段 
Step 1 ﹕使用者想對自己的創作發行受 RMS 保護的權限，就必須向 RMS Server
申請取得 CLC 憑證。首先，傳送 RAC 憑證至 RMS Server。 
Step 2 ﹕RMS Server 驗證 RAC 憑證。 
Step 3 ﹕RMS Server 為使用者產生一組金鑰對 ( )CLCCLC SKPK , 。 
Step 4 ﹕利用使用者所傳送的 RAC 中的公開金鑰 RACPK 對 CLCSK 做加密。 
Step 5 ﹕產生 CLC 檔案存放 CLCPK 、 ( )CLCPK SKE RAC 、及 RMS Server 的公開
金鑰 srvPK ，並加以簽章，成為用戶端授權人憑證。 
Step 6 ﹕最後將 CLC 憑證傳送到使用者端，以供使用者可離線創作受 RMS 保護
的數位內容。 
 
 
21 
 
Step 10 ﹕RMS Server 利用 RAC 中的公開金鑰 RACPK 將金鑰CK 加密，然後連
同使用權限置入 UL 檔案，並加以簽章，成為使使用授權，傳回使用者
端。 
Step 11 ﹕使用者端的 RMS 相容應用程式以 LockBox 中的 cSK 解開 RAC 裡的
RACSK ，就可以進一步解出 UL 裡的CK ，再解開受保護的數位內容，
然後依循產權規範來使用數位內容。 
 
1.2.3.4 安全機制分析 
一、密碼學機制(Cryptographic Mechanisms)： 
使用對稱式加密法來保護數位內容，並以非對稱式加密法來保護使用權限。 
二、 獨特化機制(Individualization)：    
雖然 RMS 在初始時，並無使用裝置的硬體序號執行獨特化的動作，但初始
時除了每台電腦裝置自我產生 security processor certificate(SPC)且向 RMS 伺
服器註冊以供將來辨識硬體的合法性外，RMS 伺服器並針對裝置上的每個
使用者發佈 Right account certificate(RAC)，使每個使用者在 RMS system 中
皆擁有屬於自己的唯一識別碼，意即使用者在其他受 RMS 保護的裝置上仍
可使用屬於自己的唯一識別碼來得到產權中可解開加密的數位內容的對稱
式金鑰，以便瀏覽數位內容，也就是說由 RMS 伺服器所發佈的 RAC 憑證
中的資訊，在整個數位產權管理系統中將使用者的驗證達到唯一性，一樣達
到獨特化機制中，防止全面性破解數位產權管理系統的目標。 
三、 不可竄改性(Tamper Resistance)： 
使用者端的 RMS 相容應用程式才可存取憑證內的私密金鑰，其安全性皆由
Windows 作業系統做嚴格的存取控制，其採取的保護措施有： 
 應用程式的排除(Application Exclusion)：禁止非授權的應用程式存取特
定的數位內容封裝檔案。 
 DRM 元件的排除(DRM Component Exclusion)：當 DRM 元件遭到破壞
時，則拒絕授權播放數位內容。 
 所以，使用者端的 RMS 相容應用程式結合作業系統的保護機制，在安
全的環境中執行，進行數位內容的解密與播放。 
四、 數位浮水印(Digital Watermarking)： 
數位內容創作者在執行數位內容加密之前，可以視需要加入浮水印達成版權
的保護或追蹤產權使用情形。 
23 
 
Step 4 ：使用者選擇要購買數位內容且向數位內容經銷者的付款系統進行付費過
程。 
Step 5 ：一旦交易經過認證後，使用執照供應商便將產生的授權檔案傳至使用者
端的數位產權管理軟體(“Right|Client”) 。 
Step 6 ：使用者端數位產權管理軟體會自動至使用執照供應商中下載該數位內容
的產權檔案“Right|Pack” 。  
Step 7 ：此使用者在下載數位內容與產權檔案後，便可在產權“Right|Pack”規         
範下使用數位內容。 
 
1.2.4.2 安全機制分析 
一、 密碼學機制(Cryptographic Mechanisms)： 
在 InterTrust 的數位產權管理系統中，將產權管理元件與數位內容以藉由密
碼學的方法結合一起，稱為”DigiBox”，受保護的數位內容是根據其授權，
在合法的情形下使用。 
二、 獨特化機制(Individualization)： 
在 InterTrust 的數位產權管理系統中，Server Products 系列中的 System 
Operations Server 的安全元件，具有將數位產權執行軟體獨特化以及核發憑
證、金鑰等功能，使用者購買的數位內容因此限定只能在特定裝置上播放。 
三、 不可竄改性(Tamper Resistance)： 
”DigiBox”必須在可信任的產權保護應用程式中執行，目前已推出各種平台
的版本，有適用於個人電腦的 Rights|Desktop 、適用於行動電話
Rights|Phone、適用於 PDA 的 Rights|PD、適用於機上盒的 Rights|TV 等。每
種版本都是結合作業系統和硬體層的保護機制，在安全的環境中執行，進行
數位內容的解密與播放。 
四、 數位浮水印(Digital Watertmarking)： 
查無資料。 
 
 
 
25 
 
 數位產權管理系統應該獨立於特定檔案格式之外，系統必須支援多樣化
的數位內容格式。 
 支援消費者與消費者之間可以相互交流數位內容，提供超傳播(Super 
Distribution)是必須的，此技術可以讓數位內容更快的在網路中散佈。  
 現今的數位產權管理系統可以提供多種廣泛的服務，其中有些牽涉到十
分複雜的超傳播與植基於使用執照的數位產權管理技術，要實現使用執
照中產權描述需要強大的產權執行技術。  
 數位產權管理系統必須要能根據不同的需求供應不同形式的服務。  
 現存許多數位內容的播放平台與獨立裝置，如果一個數位產權管理系統
可以支援多種外部裝置與平台，將是非常受用的。 
要建立一個可以同時兼顧上述技術要求的數位產權管理系統是非常困難
的。即使這樣的系統被開發出來的，也將面臨到需求改變與技術日新月異的影
響。所以，P. A. Jamkhedkar 與 G. L. Heileman 認為系統的分層化，可以讓各家廠
商著重於數位產權管系統的不同層級，開發專長的技術與產品。而每一層都有可
能再細分出子層(Sub-Layer)去開發，且整個架構也必須要足夠的彈性，以滿足需
求與技術的改變。於是，P. A. Jamkhedkar 與 G. L. Heileman 提出大略的分層概念： 
 上層：數位產權管理應用程式須依據產權規範進行數位內容的使用。 
 中層：著重產權描述以及針對不同環境，編譯其所適用的產權規範。 
 下層：注重在產權與數位內容如何被使用。 
P. A. Jamkhedkar 與 G. L. Heileman 提出數位產權管理系統的初步分層概
念，希望達到各廠商相互合作開發能夠相互溝通的系統。不過，他們只提出一個
概念，沒有詳細規劃各層該有的技術，而且層與層之間的部分功能重疊，並無法
落實真正的分層設計。 
除了上述跨平台的整合問題，數位產權管理系統的未來發展關鍵，最重要的
就是應該符合法律層面的合理使用權保障，讓消費者保有合法的自由度。因為現
在大部分數位產權管理系統對於數位內容的使用限制甚多，法律上賦予消費者在
合理範圍內的使用原則幾乎都未受到保障，這會讓一般使用者對數位產權管理系
統望而卻步。 
 
2.我們所提出的數位產權管理整合方案 
  DRM 的安全性，必須架構於軟、硬體的保護技術上，以及周全的管理機制，
包含數位內容的呈現、複雜的產權控制以及數位內容與產權本身的保護。 
27 
 
 Display Software：提供播放器、瀏覽器、編輯器等，可以呈現數
位內容播放程式，並遵照產權規範下，合法、合理的使用數位內
容。 
多媒體層的技術主要著重在數位內容的解碼以及播放器的應用程
式，使用者在面對多樣的數位內容格式，總有著其好厭喜惡以及環境
的限制。以下將介紹數種數位內容格式以及適用環境，例如： 
 串流影音格式(Stream)：通常影音數位內容都相當龐大，在網路頻
寬的限制之下，使用者必須忍受長時間的下載整個影音數位內容
到電腦後才能觀賞。而因為「串流技術」具有隨點即看、不需佔
硬碟空間、進而縮短下載時間的優點，逐漸成為網路上傳播影音
數位內容的主流。目前是以 asf、rm、以及 mov 三種串流格式較
為通用，由於不同的串流格式是由不同廠商所開發，彼此之間不
易轉換格式與相容，所以各種串流數位內容都有其專屬的播放軟
體、編碼程式。以下為各串流格式及播放器之比較。 
 Asf：微軟公司開發，適用於 Windows Media Player。 
 Rm：RealNetworks 公司開發，適用於 RealPlayer。 
 Mov：蘋果電腦開發，適用於 QuickTime Player。 
 檔案影音格式(File)：串流格式的數位內容為了要能夠在網路上流
暢的觀賞，使用者必須忍受畫質/音質不佳的缺點，因此各家廠商
在多媒體影音的壓縮技術上不端研發新技術，以求有更好的影音享
受，目前較通用的多媒體數位內容： 
 Wma/Wmv：微軟公司開發，適用於 Windows Media 
Player。 
 MP3：Winamp 公司開發，適用於 Winamp Player。 
 AAC：蘋果電腦開發，適用於 iTune Player 或 iPod。 
 文件刊物：並不只有多媒體影音的數位內容需要數位產權管理系統
的保護而已，其他數位化的文件刊物同樣可以加入數位產權管理的
系統之中，以受到完整的保護。例如，發表的論文、電子書、公司
文件、個人網路創作…等等，下表將列示幾種通用的文件格式的數
位內容： 
 Word/Excel/PointPoint：微軟公司開發，適用於 Windows 
office 2003。 
29 
 
使用，須對其做加密保護，以及考慮數位內容的檔案容量較
大，用非對稱式加密法加密非常不具效率，所以數位內容通常
使用對稱式加密法來對數位內容本身作保護。 
 非對稱式加密法(Asymmetric Encryption): 非對稱式加密法植
基於金鑰對(key pair)公鑰與私鑰的使用，用其中一把 key 加密
再用另一把去解出真正內容。數位證書(Digital License)，內包
含著數位內容的解密金鑰(content decryption key)，而這把金鑰
就是用接收方的公開金鑰所加密著，因此除了合法授權的接收
方(私鑰持有者)，可將數位內容的解密金鑰解密外，並無其他
第三方可解密，可保證數位內容的使用者為合法使用者。 
 雜湊函數(Hash Function):單向赫序函數(one-way hash function)
通常與數位簽章一同使用，用作為完整性的驗證功能上，例如:
使用執照的提供方(License Provider)，便是利用赫序函數對使
用執照(License)產生唯一赫序值(Hash Value)，再用自己的私鑰
(Private Key)對此一赫序值作簽章，待要驗證使用權限(usage 
right)時，再用 License Provider 的公鑰解密出 License 的
Hash-Value，在經過比對 Hash-Value 後便可得知使用權限是否
遭到竄改。 
 
硬體層(Hardware Layer)： 
介紹到此都是屬於軟體層面以上(MultiMedia Layer ÅÆ REL Layer 
ÅÆ OS Layer)的功能，但這樣完善的分工與保護，還未能達到十
分完整的保護，因為即使數位內容位於 OS 所控管的某一塊記憶體
中，任何非法軟體都不得存取此塊記憶體，但是當已經是明文狀態
的數位內容經由 OS 輸出到硬體的途中，不能確保不會被駭客從中
擷取(在 OS 與介面卡中間安裝擷取硬體)，所以我們需要浮水印技
術的支援。在數位內容加入浮水印後可以使其造成雜訊，所以若有
人想從 OS 與介面卡中間擷取出視訊流或影像流時，品質是相當差
的，所以有了浮水印做最後一層把關，我們唯一要擔心的盜版行為
便是直接對電腦螢幕照相或對喇叭錄音了。 
 浮水印移除(Watermark remove):由硬體來做最後一層把關。數
位內容在解密後，還並不是以完整的明文形式存在，而是仍有
嵌入的浮水印(Watermark)所繼續保護著，直到數位內容要真正
透過硬體設備(音效卡、顯示卡)，輸出到外部裝置時(喇叭，螢
幕)時，才由硬體設備將會造成雜訊的浮水印拿掉。如此，便
可以保證即使在作業系統層解密完數位內容後，將資料流輸出
到硬體設備時，即使遭到從中竊取，也會因為浮水印的存在，
31 
 
 
圖 15、XrML 的 Core Schema 
33 
 
2.2 各層之間的身分驗證 
   現今獨力發展的數位產權管理系統，因為每個元件都是廠商自行開發，並不
存在各元件的認證機制，而我們所規劃的三層架構，因為廠商可針對單一層進行
開發，一個 DRM 系統可能由不同廠商所開發的技術層架構起來的，各層之間如
何取得信任是相當重要的。因此如何驗證此三層的合法性，便是此節所要討論的
重點。 
    以網際網路上數以億計的數位內容(檔案、程式或服務)為例，一般使用者無
法判斷該軟體程式的來源或合法性，無形之間增加了使用的危險性，也無法得知
軟體程式碼是否已遭人竄改成為惡意程式。因此，微軟公司利用 Authenticode 技
術及其基本的程式碼簽署機制，幫助使用者來因應這一問題。Authenticode 技術
仰賴數位憑證，並以業界中已成功運用的規格標準為基礎，其中包括公開金鑰密
碼編譯標準 PKCS #7 (加密金鑰規格)、PKCS #10 (憑證要求格式)、X.509 (憑證
規格) 以及安全雜湊演算法 (SHA) 和 MD5 雜湊演算法來建立起安全性。  
     關於三層之間的相互的身分認證，我們建議使用驗證碼技術Authenticode [1]
來達成下列目標： 
z 驗證碼技術確保軟體在經過其開發廠商簽章之後，驗證是否遭到竄改。 
z 憑證中心扮演確認軟體開發廠商身分的角色。 
z 受驗證碼保護的軟體會建立一個指向發行者的可靠連結，其中開發商已簽章
保證該軟體不含惡意的程式碼。所以，無須逐行檢查軟體的程式碼。 
    我們將設立一個新角色”DRM CA”，用來發行各個階層的開發商的數位憑
證。各個階層的開發商對開發的 DRM 軟體做簽章後，確保該軟硬體合法來源，
並非是惡意的軟硬體，經過赫序值的比對後也可確保未遭竄改。 
2.3 產權描述語言的整理與轉換 
DRM 能夠對數位內容進行產權控制，便是透過權利描述語言來規範數位內
容的合理使用行為，以限制軟硬體的操作。數位內容的產權描述，對於數位產權
管理是相當重要的一環，目前主要使用的產權描述語言，有 XrML[9]以及
ODRL[28]。兩大產權描述系統迥異的發展方向，造成了產權描述系統互不相容。
例如圖 17，在規範數位內容的使用次數上，XrML 與 ODRL 的表示法就完全不
同：
35 
 
標籤 <!ELEMENT (#PCDATA)> 
說明 訊息信封的檔頭，包含溝通訊息的檔頭標籤。 
z Element < MsgHeader > 
標籤 <!ELEMENT (#PCDATA)> 
說明 溝通訊息的檔頭，描述出該訊息的類型（neta-data）。 
z Attribute < request-response > 
標籤 <!ELEMENT (#PCDATA)> 
說明 溝通訊息的類型，指明訊息在發出後需要對方回覆訊息。 
z Attribute < request > 
標籤 <!ELEMENT (#PCDATA)> 
說明 溝通訊息的類型，指明訊息發出後不需要對方回覆訊息。 
z Attribute < response > 
標籤 <!ELEMENT (#PCDATA)> 
說明 溝通訊息的類型，回覆訊息。 
z Element < RequestFrom > 
標籤 <!ELEMENT (#PCDATA)> 
說明 溝通訊息的來源(Sender)。 
z Element < RequestType > 
標籤 <!ELEMENT (#PCDATA)> 
說明 溝通訊息的類型。 
z Element < Body > 
標籤 <!ELEMENT (#PCDATA)> 
說明 訊息信封的主要內容。 
z Element < ContentID > 
標籤 <!ELEMENT (#PCDATA)> 
37 
 
2.3.2 數位內容以及產權檔案的準備階段 
階段一、要求數位內容對應的產權檔案(Acquire License) 
當使用者要使用數位內容(Content)時必須先經過準備階段，也就是 DRM 系
統必須先尋找到相對應的產權檔案(使用執照，License)，才能進一步讓使用
者繼續使用數位內容，而 Content 與 License 的對應關係是透過 ContentID 以
及 LicenseID 的比對運算(一般作法通常 LicenseID 是 ContentID 的赫序值)，
因而找到相對應的 License，若找不到與 Content 相對應的 License 則通知使
用者必須先購買 License。 
 
圖 19、要求數位內容對應的產權檔案 
Step 1: MultiMedia Layer 向 REL Layer 發出尋找 acquire License 的指令，編譯成
XML，並將 ContentID 資訊放入溝通文件中，XML 示意如下: 
MultiMedia Layer OS Layer 
1. Content ID 
REL Layer 
2. 尋找對應 License ID 
3. (License ID||Content ID) 
4.Search 
Content &  
License 
5. Ack 
6. Ack 
39 
 
 
Step 6: REL Layer 回覆 MultiMedia Layer Content Ready。  
 
 
 
<?xml version="1.0"?> 
<env:Envelope xmlns:env="DRM-envelope"> 
  <env:Header> 
      <n:MsgHeader xmlns:n="response "> 
        <n: ResponseFrom> REL _Layer </n: ResponseFrom > 
        <n: ResponseType>Acquire License</n: ResponseType > 
      </n:MsgHeader> 
  </env:Header> 
  <env:Body>      
     <ContentStatus>Content Ready</ ContentStatus > 
  </env:Body> 
</env:Envelope> 
<?xml version="1.0"?> 
<env:Envelope xmlns:env="DRM-envelope"> 
  <env:Header> 
      <n:MsgHeader xmlns:n="response "> 
        <n: ResponseFrom>OS_Layer </n: ResponseFrom > 
        <n: ResponseType>Acquire License</n: ResponseType > 
      </n:MsgHeader> 
  </env:Header> 
  <env:Body>      
     <ContentStatus>Content Ready</ ContentStatus > 
     <LicenseStatus >License Ready</LicenseStatus > 
  </env:Body> 
</env:Envelope>
41 
 
 
因為 License 的加解密金鑰通常是 DRM 平台的公鑰/私鑰對來做加解密作
業，所以不需要 License Key ID 來指定解密金鑰。 
Step 3: O.S.Layer 根據 CEncrypt algo.以及 LEncryptionAlgo 來進行解密。 
Step 4: O.S.Layer 回覆 REL Layer License Decrypted 。 
<?xml version="1.0"?> 
<env:Envelope xmlns:env="DRM-envelope"> 
  <env:Header> 
      <n:MsgHeader xmlns:n=" request-response "> 
        <n: RequestFrom>REL_Layer </n: RequestFrom > 
        <n: RequestType> Decrypt License and Content</n: RequestType > 
      </n:MsgHeader> 
  </env:Header> 
  <env:Body>      
      <HashFunction> SHA1</ HashFunction > 
     <CEncryptionAlgo> AES 128-bit </ CEncryptionAlgo > 
     <LEncryptionAlgo> RSA 1024-bit </LEncryptionAlgo > 
  </env:Body> 
</env:Envelope> 
43 
 
    此 2 個階段在我們的設計中，其實是一個階段就完成的，在數位內容對應的
產權檔案階段，當 OS Layer 找到對應的 Content 以及 License 時，便會根據指定
演算法開始進行解密動作。當數位內容以及產權檔案的準備階段完成後，使用者
就可以進行播放使用的階段。 
 
2.3.3 數位內容的使用階段 
階段一、 多媒體層(上層)與產權直譯層(中層)溝通：使用者對數位內容進行
任何操作前，多媒體層都會將指令封裝成 XML 訊息傳遞給 REL 層，REL 層確
認與產權規範相符合時，才能允許進行操作。下圖是使用者下達播放指令流程。
 
圖 21、上層與中層溝通 
Step 1: MultiMedia Layer 下達播放指令(Play)給 REL Layer。 
 
Step 2: REL Layer 檢查 MultiMedia Layer 所下達的操作是否符合權限，一個單純
的播放指令 REL Layer 可能就必須檢查下列幾個欄位： 
<?xml version="1.0"?> 
<env:Envelope xmlns:env="DRM-envelope"> 
  <env:Header> 
      <n:MsgHeader xmlns:n="requestresponse"> 
        <n:RequestFrom>MultiMedia_Layer </n:RequestFrom > 
        <n:RequestType>Player Operation</n: RequestType > 
      </n:MsgHeader> 
  </env:Header> 
  <env:Body>  
     <Operation> Play </Operation> 
  </env:Body> 
</env:Envelope> 
MultiMedia Layer 
1.Operation: Play 
REL Layer
2.Check Right 
3.return result  
45 
 
 
Step 2: OS Layer 執行撥放指令。 
Step 3: OS Layer 回覆 REL Layer 執行結果 
 
我們所提出的架構與解決方案，主要開放性架構，就是要讓更多廠商進
入，在良性競爭下不僅為消費者提供更多元服務，也能進一步將應用環境
擴大延伸，為廠商提供更大的市場，在對雙方都有利的情形下，數位產權
管理才能真正發揮當初誕生的意義-保護著作權人的智慧財產權。DRM 的
發展，除了需要各家廠商的獨立技術以外，更需要相互合作，並詳細考慮
使用者的權益與需求，才能使得數位產權系統有發展的可能性。我們便是
基於這樣的精神與概念，提出了我們的方案，令 DRM 系統成為完全開放
性的系統，促進 DRM 有更進一步發展的機會。 
<?xml version="1.0"?> 
<env:Envelope xmlns:env="DRM-envelope"> 
  <env:Header> 
      <n:MsgHeader xmlns:n="response "> 
        <n: ResponseFrom> OS _Layer </n: ResponseFrom > 
        <n: ResponseType> Player Operation </n: ResponseType > 
      </n:MsgHeader> 
  </env:Header> 
  <env:Body>      
     <OperationProcess> Done </ OperationProcess > 
  </env:Body> 
</env:Envelope> 
<?xml version="1.0"?> 
<env:Envelope xmlns:env="DRM-envelope"> 
  <env:Header> 
      <n:MsgHeader xmlns:n="requestresponse"> 
        <n:RequestFrom>REL_Layer </n:RequestFrom > 
        <n:RequestType>Player Operation</n: RequestType > 
      </n:MsgHeader> 
  </env:Header> 
  <env:Body>  
     <Operation> Play </Operation> 
     <OperationProcess> Accept </ OperationProcess > 
  </env:Body> 
47 
 
用權。於是，目前有研究是提出以智慧卡，在不影響數位內容的安全性下，提高
數位內容的可攜性。將原本數位內容的授權對象指定在電腦轉到使用者隨身攜帶
的智慧卡，便可以在任何一個數位產權執行軟硬體播放自己合法購買的數位內
容。也就是說，消費者可以在個人擁有的多台裝置上，合法使用其所購買的數位
內容。而且因為智慧卡不可能被仿製，可保證數位內容在同一時間只有在一個裝
置使用，達成數位內容可攜性與合理使用之目的。 
 
圖 24、以智慧卡達成數位內容可攜性與合理使用 
針對這個研究方向，Conrado 等人[5]在 2003 年發表一篇「Privacy in an 
Identity-based DRM System」，提出如何導入智慧卡與數位產權執行軟硬體共同
運作，讓消費者可在任何一個數位產權執行軟硬體播放自己合法購買的數位內
容。不過，Conrado 的 Identity-based DRM System 的設計中，只有數位內容創作
者和使用者兩個角色，沒有所謂的數位內容經銷者，其認定數位內容創作者和數
位內容經銷者的角色應合而為一，也就是每個創作者都被假設有能力自己做行
銷，這樣的設計將導致不懂得行銷也沒有經銷管道協助的個人獨立創作者居於劣
勢，這樣的設計並不符合實際需求。另外，更嚴重的是 Conrado 的系統是由創作
者自己將使用執照散佈在網路上，所以也沒有使用執照供應商這個角色，而其過
程被質疑消費者的隱私未被尊重的問題。 
在 2005 年，Hung-Min Sun 等人[33]針對 Conrado 的 Identity-based DRM 
System 提出三項缺點： 
 缺乏實用性(Lacking of Practicability)： 
其數位內容創作者的也必須扮演數位內容經銷者和使用執照供應商的
角色，這樣的設計並不符合實際需求，在數位產權管理系統的應用上，
49 
 
目前數位產權管理系統下的數位內容使用缺乏可攜性，並不符合法律所賦予
的個人合理使用權。例如 Apple 公司的 FairPlay 和微軟公司的 Windows Media 
Right Management，一開始都會對數位產權執行軟硬體進行獨特化的程序，以使
用者端的硬體資訊產生唯一的金鑰，只有該台電腦或裝置才能解開使用執照，進
一步解出數位內容，而這樣的設計實質上是把授權對象指定在裝置而不是使用者
本身，致使數位內容是無法合理重製使用。例如消費者更新硬體後，由於硬體資
訊序號改變了，消費者原先購買的合法數位內容將無法使用。 
另外，在 Window Right Management Sevices System(RMS)的設計，是以憑證
來確保數位內容的確是在被授權者使用的電腦上執行，與前述兩套系統最大的差
別，在於以使用者憑證認定身份，數位內容的授權的確是針對使用者本身而非裝
置，使用者可以在任何一台電腦再度使用有合法授權的數位內容，相較之下確實
是對使用者的合理使用權有所保障。 
數位產權管理系統的保護措施若嚴格限制產權的可攜性，不能讓消費者合法
購買的數位內容可以合理使用，看似對數位內容業者較為有利，因為數位內容不
會被重製，有效保障數位內容業者的權益。但持續限制消費者的權益，不僅對消
費者造成不便，更是違反相關法律規定，讓消費者不願意接納使用，反而造成數
位產權管理系統的推廣不易。所以，如何有效保護數位內容，而同時又能兼顧消
費者的合理使用權，是值得研究的方向。 
目前有研究，提出不影響數位內容的安全性，以智慧卡提高數位內容的可攜
性。將原本數位內容的授權對象指定在電腦轉到使用者隨身攜帶的智慧卡，便可
在任何一個數位產權執行軟硬體播放自己合法購買的數位內容。也就是說，消費
者可以在個人擁有的多台裝置上合法使用其購買的數位內容。而且因為智慧卡不
可能被仿製，可保證數位內容在同一時間只在一個裝置使用，達成數位內容可攜
性與合理使用之目的。  
前述文章中曾提到，針對這個研究方向，Conrado 等人[5]在 2003 年提出如
何導入智慧卡與數位產權執行軟硬體共同運作，讓消費者可在任何一個數位產權
執行軟硬體播放自己合法購買的數位內容。在 2005 年，Hung-Min Sun 等人[33]
針對 Conrado 的設計提出改進。 
不過，在一般的電腦上，智慧卡並不夠普及，這樣的現象在 Chadwick[2]的
文章中道出原因：1.需要額外裝置讀卡機、2.成本高、3.智慧卡的容量與運算能
力有限、4.在一般電腦上，以智慧卡做為身份辨識有時比軟體方式的”Software 
Token”效率較差。所以，針對現實的環境，我們提出如何將 Virtual Software Token 
[17,18]導入數位產權管理系統，讓數位內容有更高的可攜性。 
51 
 
在我們設計的三個階段協定，使用下列的符號： 
表 1：使用符號 
λ 1024 bit 
N N=p*q , 2λ-1≦N＜2λ 
(e,d) 使用者 RSA 金鑰對且 e, dאZ*ψ(n) 
(PKws ,SKws) 網路服務業者的 RSA 金鑰 PKws ,SKwsאZ*ψ(n) 
(PKsrvi ,SKsrvi) 託管伺服器的 RSA 金鑰對 PKsrvi ,SKsrvi אZ*ψ(n) 
d0 使用者端保留不託管分割金鑰 d0אZ*ψ(n) 
di 儲存在託管伺服器的分割金鑰 diאZ*ψ(n) 
ts 時戳 
Ktemp 使用者端與伺服器的暫時通訊金鑰 
KeyID 數位內容的辨識碼 
CK 加密數位內容的對稱式金鑰 
License 含有產權和 CK 的使用執照 
Content 數位內容 
 
接下來，分別就系統運作的三個階段，做下列的設計： 
 
 
53 
 
3.2.2  [購買階段] 
 
圖 27、購買階段 
 
Step 1 使用者向數位內容經銷商購買封裝過後的數位內容。 
Step 2 使用者得到的數位內容封裝包含 keyID 和 ECK(Content)。 
Step 3 使用者以 keyID 向使用執照供應商請求發佈相對應的使用執照。 
Step 4 使用執照供應商可藉由 keyID 查出對應的解密金鑰 CK，並將數位內容創
作者事先制訂的產權一併封裝進使用執照。 
Step 5 使用執照供應商可由數位產權管理憑證中心得知使用者公鑰 e，對使用執
照加密，安全傳送給使用者。 
Step 6 此時使用者擁有 Ee(License)，利用其數位產權執行軟硬體保留的金鑰 d0，
計算出[Ee(License)] d0。 
Step 7 最後，數位產權執行軟體(或硬體)將[Ee(License)]d0 和 ECK(Content)，以網
路服務業者的公鑰 PKws 加密，安全傳送至網路服務業者。 
 
55 
 
息進行下列運算： 
   [Ee(License)] d0*M1* M2* …*Mn 
  = [Ee(License)] d0+d1+…+dn 
  = [Ee(License)] d 
  = License 
合法解出使用執照，得出數位內容的解密金鑰 CK 與產權。 
Step 7 在產權規範下，將 ECK(Content)解密得出數位內容。 
Step 8 網路服務業者的數位產權伺服器，以串流技術將數位內容傳送，由使用者
端的數位產權執行軟硬體同步接收，數位內容仍受數位浮水印保護，唯有
在產權規範下才可合法使用。 
在我們的設計，將 Virtual Software Token 導入數位產權管理機制，藉此改
善許多數位產權管理系統設計不具可攜性的問題。  
 
4.家庭數位內容共享 
在以往數位產權管理系統的設計中，其使用執照授權對象指定在單台特定
的 DRM 設備上，只有該台 DRM 設備的私鑰才能解開使用執照，並在產權規範
下使用數位內容，這樣的做法雖然確保了數位內容免於重製的危機，但這卻嚴重
限制了消費者的使用權益。舉例來說，當消費者擁有的播放裝置不只一台時，這
樣的設計將無法讓其它的播放裝置來共享消費者所擁有的數位內容，或者當播放
設備需要汰舊換新時，這會讓使用者無法使用那些曾經購買的數位內容，這對消
費者是一件相當不公平的事。 
為了解決上述的問題，另外有研究[4,13,19,20,29,30,32]提出如何將數位產權
管理系統與數位家庭做整合，其中最重要的就是將家庭伺服器(Home Server)這個
角色納入設計當中，由家庭伺服器建立信認網域(Authorized Domain)[7]，並負責
監控、管理家庭內所有播放設備的使用情形，在數位產權管理系統機制的運作
下，使家庭播放設備不但可以共享該家庭所擁有的數位內容，而且同樣可以保護
數位內容的安全，以杜絕盜版的行為。然而 DRM 設備在加入網域的程序，主要
使用公開金鑰加解密技術以達到安全控管之目的，但在成本考量下，一般家庭的
DRM 設備不會有如此高的運算能力，因此低運算量的設計將會是數位產權管理
系統較佳的選擇。我們曾經針對數位內容的合理使用性，以及一般家庭播放器運
算能力不足的問題，提出了一個解決方案[36]。然而當初欠缺考慮如何限制 DRM
設備加入多個家庭網域的問題。在此，我們提出新的設計改進上述缺點，是一個
符合輕運算量又具合理使用的數位產權管理系統。 
57 
 
表 2：使用符號 
變數 說明 
()h  
⊕  
||  
?=  
iP  
X  
DK  
iID  
HPK  
HSK  
()PKE  
()SKD  
xDES  
iR  
CID  
M  
cK  
單向雜湊函數 
互斥或運算 
字串連結 
辨斷是否相同 
裝置 i的通行碼 
設備製造商的祕密金鑰 
家庭設備金鑰 
DRM 設備的序號 
DRM 家庭伺服器的公鑰 
DRM 家庭伺服器的密鑰 
利用公鑰做非對稱式加密 
利用私鑰做非對稱式解密 
以金鑰為 x做對稱式加密 
DRM 設備啟動碼 
數位內容的編號 
數位內容明文 
數位內容保護金鑰，用來加密數位內容的對稱式金鑰 
 
4.1.1 設備製造初始階段 
當製造商在生產每一台 DRM 設備時，都會為其指定一個序號 iID 並預設一個
密碼 iP ，然後以製造商的祕密金鑰 X 進行下列運算得出一啟動碼 iR : 
)||()( iii IDXhPhR ⊕=  
然後，將啟動碼 iR 儲存於設備中限制讀取的記憶體。而密碼 iP 是印製在產品
保証書上，並加以安全彌封。 
 
4.1.2 設備啟動階段 
當使用者購買新的 DRM 設備時，將保證書上的密碼輸入至設備中，DRM
設備進行啟動程序，以密碼運算出的驗證資訊傳送給 DRM 家庭伺服器，即產生
59 
 
再以 DRM 家庭伺服器的公鑰對 3b 和 4b 進行加密得到 1e 值: 
)||( 431 bbEe HPK=  
        最後，將密文 1e 與亂數 2n 、 3n 傳回 DRM 家庭伺服器，並且記錄該 DRM
設備為已啟動狀態不允許再度啟動。 
 
步驟 4: 當 DRM 家庭伺服器接收到上述訊息後，使用本身的私鑰 HSK 解開密文
1e ，得到 3b 、 4b 值，如下所示: 
)||(
))||(()(
43
431
bb
bbEDeD
HHH PKSKSK
=
=
 
家庭金鑰 DK 分別與 3b 、 4b 進行下列運算以備夠安全傳送給 DRM 設備: 
D
D
Kbb
Kbb
⊕=
⊕=
46
35  
       最後，將 5b 、 6b 和亂數 2n 、 3n 傳送到 DRM 設備。 
 
步驟 5: 當 DRM 設備收到上述的訊息之後，為了確定資料的完整性，DRM 設備
將 1b 值分別與 2n 、 3n 進行運算得到值 7b 、 8b : 
)(
)(
318
217
nbhb
nbhb
⊕=
⊕=
 
       然後利用 7b 、 8b 來驗證 5b 、 6b 的完整性，其驗證方式如下: 
65
?
87 bbbb ⊕=⊕  
        若通過驗證，則代表收到的這段啟動訊息在傳送的過程中沒受到更動，
於是該 DRM 設備利用 7b 與 4b 進行下列運算得到家庭金鑰 DK : 
              
D
Dii
D
K
KnIDXhhnIDXhh
Kbnbhbb
=
⊕⊕⊕⊕=
⊕⊕⊕=⊕
)))||((())||((
)()(
22
32157
 
        最後將此家庭金鑰 DK 儲存於 DRM 設備中限制讀取的區域，並完成啟
動階段。 
61 
 
 
步驟 4:當使用執照供應商接收到上述的訊息後，其利用私鑰解出其家庭金鑰
DK ，如下所示: 
D
DPKSKSK
K
KEDaD
LSLSLS
=
= ))(()( 1
 
然後依據數位內容編號，找到該數位內容的保護金鑰 cK 與使用產權 R ，
並以家庭金鑰 DK 對數位內容金鑰 cK 進行加密，而產生該數位內容相對
應的使用執照 iL 值: 
)||( RKDESL
iD cKi
=  
       然後，將此使用執照 iL 傳送到 DRM 設備。 
 
步驟 5:當 DRM 設備收到使用執照 iL ，其利用家庭金鑰 DK 解開使用執照內容，
即得到數位內容保護金鑰
ic
K 和使用產權 R ，再利用數位內容保護金鑰
ic
K 解開加密的數位內容，並依據使用產權 R 來播放數位內容。若使用的
DRM 設備不具連網功能，則前述步驟就是透過 DRM 家庭伺服器來取得
使用執照。 
 
在我們設計的 DRM 系統中，合理使用性是很重要的考量，同時也考慮一般
家庭設備運算能力不足的實際狀況，而系統仍具有高度的安全性 
 
 
 
 
 
 
 
63 
 
一、密碼學機制 
在我們的設計中，使用對稱式加密法保護數位內容，再以非對稱式加
密法保護使用執照。只有使用者端的私鑰 d 才能解出使用執照，取得數位內
容的解密金鑰。然而私鑰 d 在初始階段即被數位產權執行軟(或硬體)分割託
管於不同伺服器，因此不論是內部攻擊者(在組織內部伺機竊取的人)或是外
部攻擊者(試圖闖入攔截破解的人)，需破解所有的伺服器才有機會。而為了
抵禦低指數攻擊(Low Exponent Attack)，我們建議使用者的公鑰 e 的大小至
少要為 216+1，而各個分割私鑰 di也要符合 N1⁄4＜di＜N2⁄3 且 diא Zψ(n)，如此
得以保障金鑰的安全性。 
二、獨特化機制 
在我們的設計中，並非使用裝置硬體序號執行獨特化的動作，而是以
憑證來確保數位內容的確是在被授權者所使用的電腦上執行，數位內容的
授權是針對使用者本身而非裝置，使用者可在任何具有合法數位產權執行
軟(或硬體)的電腦，使用合法授權的數位內容，合理使用權受到保障。 
三、不可竄改性 
在使用者端與網路服務業者端的數位產權執行軟體(或硬體)確保不被
竄改的情況下，便可保障分割私鑰相關運算的安全性，並結合應用層、作業
系統和硬體層的保護機制，就能使數位內容限定在產權規範下合法使用。 
四、數位浮水印 
網路服務業者的數位產權伺服器，在產權規範下，以串流技術將數位
內容傳送，由使用者端的數位產權執行軟硬體同步接收，數位內容在傳輸過
程仍應受數位浮水印保護，是數位內容創作者在加密之前就先嵌入浮水印，
以達到保護效果。 
五、產權描述語言 
產權利描述語言是為了能夠完整描述繁瑣、複雜的使用權限而產生
的，為了跨平台與可攜性之目的，採用 XML 語法。而我們的設計雖然不討
論這個部分，不過更具有可攜性的特性，是更為彰顯這方面的價值。 
特別值得一提的，是我們的設計更具有實用價值，應用 Virtual Software 
Token 更較智慧卡具有可攜性，實質授權對象是使用者本身而非裝置，達到
法律上賦予的合理使用權，也更適合應用於現今的網路環境。 
現今網際網路頻寬的改善，各式的網路服務(Web Service)逐漸被開發
出來並受到重視，大家越來越習慣透過瀏覽器上網處理事務，例如電子郵
件、行事曆、網路硬碟等，網路服務已成為最受重視的技術，所以我們的
設計是符合這樣的主流趨勢。也就是說，我們在整個架構中加入的網路服
65 
 
)(1 ii PhRb ⊕=  
因此家庭伺服器可藉由設備製造商的幫助，利用 3b 與 4b 這兩個祕密值來
保護家庭金鑰 DK ，安全傳送到 DRM 設備。 
2. 家庭金鑰的完整性 
前述啟動階段的第四步驟之所以要產生 5b 與 6b ，是為了避免傳輸的過程
中訊號不穩定或遭受竄改，而導致傳送的資訊有所改變。若因此 DRM 設
備在啟動過程存入錯誤的 DK ，則 DRM 設備將無法正常使用。所以，在
家庭金鑰的傳遞過程當中必須正確無誤，而傳送 5b 與 6b 兩值之目的就是
為了做完整性檢查。在啟動階段的步驟五中，當 DRM 設備收到 5b 、 6b 、
2n 、 3n 後，將亂數值 2n 、 3n 連同 1b 值運算得出 7b 、 8b ，並以下列方式驗
證 5b 、 6b 的完整性: 
)()(.2
)()(.1
4365
212187
DD KbhKbhbb
nbhnbhbb
⊕⊕⊕=⊕
⊕⊕⊕=⊕
 
           
65
?
87
2121
43
.3
)()(
bbbb
nbhnbh
bb
⊕=⊕
⊕⊕⊕=
⊕=
 
確認 5b 與 6b 為正確無誤後，DRM 設備即可保證從 5b 或 6b 解出正確的家庭
金鑰 DK ，因此確保了家庭金鑰在傳輸過程中的完整性。 
二、可行性 
我們提出的設計是符合家庭使用 DRM 系統的環境，許多 DRM 設備不
一定具有很好的運算能力，但要有一台運算能力較佳的設備擔任 DRM 家庭
伺服器的角色，即可讓該家庭的 DRM 設備得以共享數位內容。在此環境考
量下，我們確實針對各種設備之運算能力及運作流程做合理的設計，分析
如下: 
1. 在我們的協定中，只需在既有的 DRM 系統額外增加 DRM 設備啟動
程序，即可達成家庭內 DRM 設備合理共用數位內容。 
2. 由於一般家庭用的 DRM 設備，在成本考量下不會有太高的運算能
力，所以 DRM 設備只需做簡單的雜湊函數與互斥或運算，即可被
DRM 家庭伺服器驗證並加入家庭網域。 
3. 我們考慮到家庭 DRM 設備可能無上網的功能，所以我們在設計中
有說明無連網功能的 DRM 設備，如何透過 DRM 家庭伺服器上網購
買數位內容。 
67 
 
並且對於數位產權管理系統的整體運作機制、五大安全機制和現行數位產
權管理的問題提出了解決方案： 
    1. 產權可攜性： 
A. 我們的設計方法主要是將產權授權對象指定在使用者本身而非裝
置硬體，使得驗證產權的授權更加具有彈性。 
B. 結合私密金鑰切割的概念和 Virtual Software Token 機制，在不影
響安全性的前提之下，讓使用者身份驗證機制不再侷限於某特定
裝置，使用者可以在任何時間地點，無需攜帶任何可驗證身份的
智慧卡之類相關隨身裝置，便可在產權規範下合理使用其所購買
的數位內容，因此達成產權可攜性。 
C. 在我們的設計之所以能達成上述二點，可由播放階段得知，我們
的設計導入 Virtual Software Token 機制，一旦使用者需解密
( )LicenseEe 的時候，只要身份驗證被通過，即可應用儲存在託管
伺服器端的切割私鑰 id 執行相關運算，如 ( ) ide LicenseE   ( )ni ≤≤1 ，並結合預先儲存在網路服務業者端的 ( ) 0de LicenseE ，
則最後使用執照將在網路服務業者端被解密。由此可知將 Virtual 
Software Token 的概念導入數位產權管理系統中，讓使用者隨時
皆可透過網路應用其私密金鑰，因此使用執照的解密不再侷限於
存在某特定裝置中的私密金鑰，所以產權可攜性大幅提升。 
2. 法律所保障的合理使用權： 
A. 一般數位產權管理系統皆是將授權對象指定在裝置硬體，因此系
統會限制數位內容移轉其他裝置的次數來達成合理使用權且保障
其安全性，但在我們的設計之中卻是直接將授權對象指定在使用
者本身，因此使用者並不需被限制數位內容移轉次數，便可更具
彈性地使用數位內容且達到法律所保障的合理使用權。且使用者
也不需因為硬體裝置的更換，而導致其權利受損。 
B. 與網路服務業者的協同運作，讓使用者不需藉由下載檔案的方
式，就能讓使用者在不用等待且不佔硬碟空間的情況，不受時間、
地點和裝置限制下，在產權規範中隨時合理使用其購買的數位內
容。 
 
最後在數位家庭中的合理使用的內容共享機制，我們也提出了解決方案。不
但考慮了合理使用，同時也考慮一般家庭設備運算能力不足的實際狀況，而系統
仍具有高度的安全性。 
1. 安全性: 
DRM 設備啟動時會從 DRM 家庭伺服器取得家庭金鑰，其中的傳輸過程
確保其機密性，避免傳輸的過程中訊號不穩或遭受竄改，確保金鑰的完
整性。如此讓家庭網域內的 DRM 設備都可用家庭金鑰解開並使用數位內
容。在我們的設計中，只要確保家庭金鑰的安全，便可保證數位內容免
於非法使用。 
69 
 
參考文獻 
1. Authentication Code specification, http://msdn.microsoft.com/library/default.asp 
2. D. Chadwick, "Smart Cards aren't always the Smart Choice", IEEE Computer, 
Volume 32, Issue 12, Dec. 1999, pp.142-143. 
3. H. Chang and M. G. Atallah, "Protecting Software Code By Guards", ACM 
Workshop on Security and Privacy in Digital Rights Management, 2001.   
4. D. Choi, Y. Lee, H. Kang, S. Kim, and D. Won, “An Efficient and Secure Rights 
Sharing Method for DRM System Against Replay Attack.” Autonomic and 
Trusted Computing, LNCS 4610, pp.135-146, 2007. 
5. Claudine Conrado, Frank Kamperman, Geert Jan Schrijen, and Willem Jonker, 
"Privacy in an Identity-based DRM System", IEEE Proceedings of the 14th 
International Workshop on Database and Expert Systems Applications (DEXA’03), 
Prague, September 2003, pp.389-395. 
6. Jeffrey Dambrtowski, "InterTrust's Role in Information Assurance for Digital 
Media", http://www.acsu.buffalo.edu/~jwd/MGS602project/intertrust.shtml, Nov. 
20, 2003.     
7. DVB technical module sub-group on Copy Protection Technologies. Call for 
Proposals for Content Protection & Copy Management technologies. TM2549, 
DVB-CPT rev. 1.2, July 2001 
8. J. S. Erickson, "Fair use, DRM, and Trusted Computing", Communications of 
the ACM, Vol.46(4), 2003, pp.34-39. 
9. eXtensible rights Markup Language , http://www.xrml.org/ 
10. Extensible Stylesheet Language Transformations, http://www.w3.org/TR/xslt. 
11. FairPlay：Effectiveness and Weaknesses of Apple’s Digital Right 
Management Technology, http://e170.ex.com/p1/indigo.pdf 
12. E. W. Felten, "A Skeptical View of DRM and Fair Use", Communications of 
the ACM, Vol. 46(4), 2003, pp.56-59. 
13. S. van den Heuval, W. Jonker, F. Kamperman, and P. Lenoir, “Secure Content 
Management in Authorized Domains.” In: Proc. IBC, pp. 467–474, 2002. 
14. IDC, http://www.idc.com 
15. Pramod A. Jamkhedkar and Gregory L. Heileman, "DRM as a Layered System", 
ACM DRM Washington, DC, USA., October 25, 2004. 
16. Mayur Kamat, "Security Requirements for Digital Rights Management", 
TRACK: Leading Edge and Emerging Technologies, October 14, 2003. 
17. Taekyoung Kwon, "Virtual Software To-kens – A Practical Way to Secure 
PKI Roaming", Proceedings of the Infrastructure Security (InfraSec), Vol. 2437 of 
LNCS, Springer-Verlag, 2002, pp.288-302. 
71 
 
34. Trusted Computing Group, https://www.trustedcomputinggroup.org    
35. XML Path Language , http://www.w3.org/TR/xpath . 
36. 陳育毅、蔡柏宏、詹進科, "建立家庭網路與個人合理使用的跨平台數位產權
管理機制", 2005 商管與資訊研討會(Taiwan conference on Business and 
Information), Sep. 29-30, 2005. 
37. "中華民國著作權法", http://www.cca.gov.tw/law/html/7-1.html   
73 
 
推廣及運用的價值 
一、 針對數位產權管理系統的特性進行三層劃分，並明確規劃各
層負責功能，落實分層設計達到分工效果。 
二、 將各層之間溝通的介面與格式定義，使得各家異質 DRM 系
統達到相互溝通，跨平台相容之目的，所有廠商都可基於自
己擅長的技術，切入 DRM 不同層級的產品開發。 
三、 完成兩大產權描述系統的標籤整理歸類，我們歸類出兩大產
權描述系統之間，語意相同但格式不同的標籤，來進一步設
計語意標籤的轉換。我們提出的三層架構中的產權直譯層，
加入了標籤轉換功能，可使得數位內容在不同平台使用時，
達到產權相互辨識及產權控制之目的。對未來切入此層產品
開發有很大的幫助，不同的產權描述系統，也能進行對數位
內容的產權控制，提高相容性。 
四、 第三方可信賴組織 DRM CA，用來發行各個階層的開發商的
數位憑證。在各個階層的開發商對其所開發的 DRM 軟體做
簽章後，即可確保該軟硬體合法來源，並非是惡意企圖取得
數位內容的軟硬體，經過赫序值的比對後可確保未遭竄改。
五、 在我們設計的保障合理使用權的線上數位產權管理系統，將
Virtual Software Token 導入數位產權管理機制，使用者
可以利用在不同裝置中的合法數位產權執行軟體(或硬體)
執行 Virtual Software Token 機制，提高數位內容使用的
可攜性，重點在於最關鍵的私密金鑰託管於伺服器，讓使用
者無須攜帶任何設備，任何時間地點都可透過網路進行身份
認證，合法存取數位內容。而在安全機制上，同樣將加解密
技術、獨特化機制、不可竄改性、數位浮水印、產權描述語
言等五大安全技術加以整合，確保數位內容的安全。 
六、 具合理使用的家庭數位內容共享的設計，是將 DRM 技術導入
到數位家庭中，所提出的方法，可適用於加解密能力低階的
家庭裝置上，便可達到家庭伺服器與裝置的雙方身分驗證。
加入家庭產權伺服器，運算能力不足的資訊家電也能具備高
安全性。保障了消費者的合理使用，在家庭內可合理重製滿
足消費者自由使用數位內容的需求。數位內容提供者也能開
放數位內容在家庭中使用，也讓消費者有更多樣選擇。 
※ 1.每項研發成果請填寫一式二份，一份隨成果報告送繳本會，一份送 
貴單位研發成果推廣單位（如技術移轉中心）。 
※ 2.本項研發成果若尚未申請專利，請勿揭露可申請專利之主要內容。 
※ 3.本表若不敷使用，請自行影印使用。 
具合理使用的家庭數位內容共享機制 
 
陳育毅 
中興大學資訊管理學系 
台中市 402 南區國光路 250 號 
chenyuyi@nchu.edu.tw 
詹進科 
中興大學資訊科學與工程學系 
台中市 402 南區國光路 250 號 
jkjan@cs.nchu.edu.tw 
紀宥孙 
中興大學資訊科學與工程學系 
台中市 402 南區國光路 250 號 
s9256006@cs.nchu.edu.tw 
 
聯絡人: 
陳育毅 
中興大學資訊管理學系 
台中市 402 南區國光路 250 號 
chenyuyi@nchu.edu.tw 
TEL: 04-22840864 轉 614 
FAX: 04-23112724 
 
 
 
 
 
 
有的播放裝置不只一台時，這樣的設計將無法讓其它的播放裝置來共
享消費者所擁有的數位內容，或者當播放設備需要汰舊換新時，這會
讓使用者無法使用那些曾經購買的數位內容，這對消費者是一件相當
不公平的事。 
為了解決上述的問題，另外有研究[1-7]提出如何將數位產權管
理系統與數位家庭做整合，其中最重要的就是將家庭伺服器(Home 
Server)這個角色納入設計當中，由家庭伺服器建立信認網域(Authorized 
Domain)[8]，並負責監控、管理家庭內所有播放設備的使用情形，在
數位產權管理系統機制的運作下，使家庭播放設備不但可以共享該家
庭所擁有的數位內容，而且同樣可以保護數位內容的安全，以杜絕盜
版的行為。然而在一些研究[1,3-5,7]中，DRM 設備在加入網域的程序，
主要使用公開金鑰加解密技術以達到安全控管之目的，但在成本考量
下，一般家庭的 DRM 設備不會有如此高的運算能力，因此低運算量
的設計將會是數位產權管理系統較佳的選擇。我們曾經針對數位內容
的合理使用性，以及一般家庭播放器運算能力不足的問題，提出了一
個解決方案[9]。然而當初欠缺考慮如何限制 DRM 設備加入多個家庭
網域的問題，而讓使用者有超出合理使用範圍的可能。在本篇文章
中，我們提出新的設計改進上述缺點，是一個符合輕運算量又具合理
使用的數位產權管理系統。 
當消費者添購 DRM 設備時，在啟用加入家庭網域後，即能共享
屬於這個家庭所擁有的數位內容。接下來我們以設備製造初始階段、
設備啟動階段和數位內容與使用執照取得階段來說明整個運作方
式，而在進一步介紹前先簡要整理使用相關的符號如表一所示: 
變數 說明 
()h  
  
||  
?
  
iP  
X  
DK  
iID  
HPK  
HSK  
()PKE  
()SKD  
xDES  
iR  
CID  
M  
cK  
單向雜湊函數 
互斥或運算 
字串連結 
辨斷是否相同 
裝置 i 的通行碼 
設備製造商的祕密金鑰 
家庭設備金鑰 
DRM 設備的序號 
DRM 家庭伺服器的公鑰 
DRM 家庭伺服器的密鑰 
利用公鑰做非對稱式加密 
利用私鑰做非對稱式解密 
以金鑰為 x 做對稱式加密 
DRM 設備啟動碼 
數位內容的編號 
數位內容明文 
數位內容保護金鑰，用來加密數位內容的對稱式金鑰 
表一、符號 
2.1 設備製造初始階段 
當製造商在生產每一台 DRM 設備時，都會為其指定一個序號 iID
並預設一個密碼 iP，然後以製造商的祕密金鑰 X 進行下列運算得出一
啟動碼 iR : 
)||()( iii IDXhPhR   
然後，將啟動碼 iR 儲存於設備中限制讀取的記憶體。而密碼 iP 是印
服器本身的公鑰
HPK ，傳送給設備製造商 
步驟 3: 設備製造商以其祕密金鑰 X 連同 DRM 設備的序號 iID 經過雜
湊運算得到 '1b 值: 
)||('1 iIDXhb   
        然後即可以下列方式來驗證
2b ，如下所示: 
2
?
11 )'( bnbh   
        若通過驗證代表該設備為合法的 DRM 設備，於是進一步以
兩個亂數值
2n 、 3n ，分別與 '1b 進行下列運算: 
)'(
)'(
314
213
nbhb
nbhb


 
再以 DRM 家庭伺服器的公鑰對 3b 和 4b 進行加密得到 1e 值: 
)||( 431 bbEe HPK  
        最後，將密文
1e 與亂數 2n 、 3n 傳回 DRM 家庭伺服器，並且
記錄該 DRM 設備為已啟動狀態不允許再度啟動。 
步驟 4: 當 DRM 家庭伺服器接收到上述訊息後，使用本身的私鑰
HSK
解開密文
1e ，得到 3b 、 4b 值，如下所示: 
)||(
))||(()(
43
431
bb
bbEDeD
HHH PKSKSK


 
家庭金鑰
DK 分別與 3b 、 4b 進行下列運算以備夠安全傳送給
DRM 設備: 
D
D
Kbb
Kbb


46
35  
示: 
 
 
圖二 
步驟 1:DRM 設備傳送數位內容編號 iCID 向數位內容銷售商提出購買
數位內容的請求。 
步驟 2:銷售商依據數位內容編號 iCID ，將金鑰 cK 加密的數位內容
)( iKi MDESC c  連同某種形式的購買証明傳送給 DRM 設備。 
步驟 3:當 DRM 設備取得加密的數位內容後，將其家庭金鑰
DK 以使用
執照供應商的公開金鑰 LSPK 加密得到密文 1a ，如下所示: 
)(1 DPK KEa LS  
       並將加密的家庭金鑰
1a 、數位內容編號 iCID 以及購買證明傳
送給使用執照供應商請求為其產生使用執照。 
步驟 4:當使用執照供應商接收到上述的訊息後，其利用私鑰解出其家
執照則是用家庭金鑰進行加密，如此讓家庭網域內的 DRM 設備都可
用相同的家庭金鑰解開並使用數位內容。因此在我們的協定中，只要
確保家庭金鑰的安全，便可保證數位內容免於非法使用。在我們的設
計中，DRM 設備啟動時會從 DRM 家庭伺服器取得家庭金鑰，其中的
傳輸過程必須確保其機密性，而且避免傳輸的過程中訊號不穩或遭受
竄改，也須確保金鑰的完整性。 
(一) 家庭金鑰的機密性 
家庭金鑰
DK 是儲存於 DRM 設備和 DRM 家庭伺服器中，而上述兩
個 DRM 裝置皆具有不可竄改的特性，所以惡意的使用者無法從中
取得金鑰
DK 。唯一有可能被竊取的情況是在啟動階段的第四步
驟，當 DRM 家庭伺服器將家庭金鑰
DK 傳送給 DRM 設備時可能會
存在安全的風險，惡意的攻擊者可以竊取 5b 與 6b : 
D
D
D
D
Knbh
Kbb
Knbh
Kbb




)(
)(
31
46
21
35
 
然而要從 5b 或 6b 解出 DK 之前，必須先知道 1b 值才能推算 3b 或 4b ，
進而解得
DK 值.。但在傳輸過程當中，我們並沒有將 1b 曝露於傳
輸通道上，只有在啟動階段的第一步驟，使用者將密碼輸入 DRM
設備時，經過下列運算後，DRM 設備方可得到
1b : 
)(1 ii PhRb   
DRM 家庭伺服器的角色，即可讓該家庭的 DRM 設備得以共享數位內
容。在此環境考量下，我們確實針對各種設備之運算能力及運作流程
做合理的設計，分析如下: 
(一) 在我們的協定中，只需在既有的 DRM 系統額外增加 DRM 設
備啟動程序，即可達成家庭內 DRM 設備合理共用數位內容。 
(二) 由於一般家庭用的 DRM 設備，在成本考量下不會有太高的
運算能力，所以 DRM 設備只需做簡單的雜湊函數與互斥或
運算，即可被 DRM 家庭伺服器驗證並加入家庭網域。 
(三) 我們考慮到家庭 DRM 設備可能無上網的功能，所以我們在
設計中有說明無連網功能的 DRM 設備，如何透過 DRM 家庭
伺服器上網購買數位內容。 
目前市面上推出一些像網路音響這樣的產品，可透過區域網路連
結到家中的個人電腦，並可播放儲存於電腦上的音樂，但這些產品沒
有提供 DRM 的機制來限制使用者在合理的範圍使用數位內容。未來
DRM 進入家庭後，只要將我們的設計整合到這樣的技術中，消費者
就可在合理的範圍內來共享數位內容。另外，這些播放器屬於運算能
力較低的設備，所以在我們的設計中播放器只要做簡單的雜湊函數與
互斥或運算，即可加入家庭網域以共享網域內的數位內容。對於無連
網功能的播放設備也可以透過家庭伺服器上網購買數位內容，所以我
Trusted Computing, LNCS 4610, pp.135-146, 2007. 
2. S. van den Heuval, W. Jonker, F. Kamperman, and P. Lenoir, “Secure Content 
Management in Authorized Domains.” In: Proc. IBC, pp. 467–474, 2002. 
3. Yun-kyung Lee, Jong-wook Han, and Kyo-il Chung, “ Home Device 
Authentication Method in Ubiquitous Environment.” , IEEE International 
Symposium on 20-23 June Page(s):1 – 5, 2007. 
4. Yun-kyung Lee, Deok Gyu Lee, and Jong-wook Han, “Home Device 
Authentication Method Based on PKI.” FGCN, pp. 7-11, 2007. 
5. B. C. Popescu, F. L. A. J. Kamperman, B. Crispo, and A. S. Tanenbaum, “A 
DRM security architecture for home networks.” In Proceedings of the 4th ACM 
workshop on Digital Rights Management, pages 1–10, 2004. 
6. M. Ripley, and C. Traw, “Content Protection in the Digital Home.”, Intel 
Technology Journal, Vol. 6, Issue 4, 2002. 
7. S. Sovio, N. Asokan, and K. Nyberg, “Defining Authorization Domains Using 
virtual Devices.” In: SAINT Workshops, pp. 331–336, 2003. 
8. DVB technical module sub-group on Copy Protection Technologies. Call for 
Proposals for Content Protection & Copy Management technologies. TM2549, 
DVB-CPT rev. 1.2, July 2001 
9. 陳育毅,蔡柏宏,詹進科,”建立家庭網路與個人合理使用的誇平台數
位產權管理機制”,2005商管與資訊研討會論文集, PP. (Sect IV) 11-24. 
10. "中華民國著作權法", http://www.cca.gov.tw/law/html/7-1.html  
 
  
information in the content package, Client requests 
License from License Server. Finally, the protected 
content can be decrypted and used under the conditions 
stated in the corresponding License. 
DRM system could be misunderstood as a 
cryptosystem, if the DRM-enabled application against 
cracking is not stated clearly. In fact, Client’s 
compliant device should cooperate with many 
technologies in application layer, REL layer, software 
layer and hardware layer. So, cryptographic 
mechanisms are important elements of DRM systems, 
but not the complete solution. Therefore we will give a 
description of these concepts in advance. 
 
2. Security technology in DRM 
 
There are existing DRM systems such as Apple 
FairPlay[3], Microsoft Windows Media Right 
Management (WMRM)[4], Window Right 
Management Services(RMS)[5] and InterTrust 
Rights|System[6]. DRM system should be applied at 
least five major security technologies as follows[7-9]. 
• Cryptographic Mechanism: 
DRM system uses cryptographic technologies to 
protect the content and License. 
• Individualization: 
At the beginning, DRM-enabled application is 
individualized for each Client. Therefore, 
License can not be transferred discretionarily and 
the corresponding content is use-limited in a 
unique compliant device or user. 
• Tamper Resistance: 
There needs a tamper-resistance mechanism to 
prevent malicious users from cracking DRM-
enabled application. Therefore the Client is 
enforced under persistent access control. 
• Digital Watermarking: 
Digital Watermarking is applied in DRM system 
to embed some information into the content. It 
usually be used to prevent grabbing attack in 
Client. Furthermore, it also can be used for copy 
control, content identification or tracing. 
• Rights Expression Languages (RELs): 
In DRM system, it is used to specify the usage 
rules of the content. Therefore, DRM-enable 
application displays the content under the 
conditions defined by RELs. 
 
3. Issue of portability and fair use 
 
Most existing DRM system is designed for powerful 
protection. However, these systems may come into 
conflict with “fair use”[7,10-13]. Fair use means the 
user can, within a reasonable scope, access their legal 
content anytime and anywhere.  Nevertheless, existing 
DRM systems would most likely bind the content to be 
accessible on a specific device. Fair use allotted under 
copyright is crippled. 
As Mulligan et al.[14] stated before, “The Digital-
Consumer’s Bill of Rights” had already emphasized 
that individuals have the rights for space shift and time 
shift, after they have ownership of the legal copy. If 
portability is restricted by close confinement of DRM 
protection mechanism, the user can not reasonably 
access the legal copy. Thus, how to secure the content 
and assure fair use simultaneously is important. 
For improving portability of DRM system, Conrado 
et al.[15] first proposed how to use smart card to 
achieve fair use. In 2005, Hung-Min Sun et al.[16] 
improved their protocol to be more secure. However, 
their designs are not really practical. The reasons are 
discussed by[17],  the difficulty is not so much in the 
cost of smart card, but much more in deploying the 
same standard smart card reader on each computer for 
user mobility. 
 
4. Our Scheme 
 
 
Figure 2.Online DRM System 
 
For the same reason to improve the portability of 
DRM system, but not using smart card, we proposed 
how to utilize the concept of Virtual Software 
Token[18,19] to make the License portable among 
various compliant devices. The user can legally access 
the content, within a reasonable scope, in anytime 
(time shift) on any compliant device (space shift). And 
there is not necessary to carry any device for 
identifying their verification. The roles of our design 
are illustrated in Figure 2. Besides the four roles of a 
typical DRM system, the following two roles are 
involved in our design. 
• “Web Service Server” provides web-based 
stream service. 
• “Trusteeship Server” provides key escrow 
service for Client. 
  
4.3. Play Phase 
 
 
Figure 5. Play Phase 
 
Step 1 Client gets the encrypted License 
)(LicenseEe in public domain. DRM-
enabled application generates some temporary 
keys
itempK , where ni ≤≤1 , randomly. 
After, ( )( )
iisrv tempePK
KLicenseEE ,  is 
generated and sent to Trusteeship Servers 
separately. 
Step 2 Trusteeship Server’s DRM-enabled 
application decrypts the above message to get 
)(LicenseEe and itempK . Then, the escrowed 
key id of the user is used to generate 
( ) ide LicenseE . 
Step 3 After ( )( )ideitempK LicenseEE  is generated and 
sent to the Client. 
Step 4 Client’s DRM-enabled application decrypts ( )( )ideitempK LicenseEE from all Trusteeship 
Servers. After, ( )( )i
ws
d
ePK LicenseEE ) , 
where ni ≤≤1 , are generated and sent to 
Web Service Server. 
Step 5 Web Service Server’s DRM-enabled 
application decrypts all of ( )( )i
ws
d
ePK LicenseEE ) , where ni ≤≤1 . 
The results are assigned as follows.  
( )
( )
( ) nden
d
e
d
e
LicenseEM
LicenseEM
LicenseEM
=
=
=
M
2
1
2
1
 
Moreover, the License can be decrypted as 
follows. 
( )
( )
( )
License
LicenseE
LicenseE
MMMLicenseE
d
e
ddd
e
n
d
e
n
=
=
= +++ L
L
10
0 **** 21
 
Then, the content key CK  and usage rights 
can be got from the License. Web Service 
Server’s DRM-enabled application will make 
sure that ( )ContentECK  could be decrypted 
only under the conditions stated in the 
corresponding License. 
Step 6 Finally, Client’s DRM-enabled application 
can legally access the content from Web 
Service Server.  
 
5. Analysis of our scheme 
 
In this section, we will discuss the practicability and 
security of our scheme. For the issue of practicability 
in our system, the concept of Virtual Software Token is 
introduced to improve the portability of DRM system. 
That means any user with legal Virtual Software Token 
can be authenticated in our DRM system. Moreover, 
the user’s authentication mechanism is not limited in 
some specific devices.  Since, virtual software token is 
a key which securely stored on remote server and can 
be accessed anytime and anywhere through the 
network. So we deploy the Trusteeship Servers to 
deposit the user’s private key. It will be more practical 
and portable in current environment. 
But, maybe someone will doubt the reason-ability of 
many servers which we deployed. However, many 
kinds of web services get more and more popular. As 
we know, people have already used to put their private 
information on web services. People have also used to 
utilize web service to deal with routine work. It is thus 
evident that people can embrace and trust the 
utilization of web services. 
For the issue of security in our system, it meets the 
following criteria: 
 
