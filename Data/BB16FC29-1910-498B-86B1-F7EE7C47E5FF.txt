 II
Abstract 
This project is a subproject of an integrated project. Its does research in transmission 
signal processing technologies for wireless communication. The research conducted in this 
project can be divided broadly into two parts: algorithm research and digital signal 
processor (DSP) software implementation research. The topics addressed include 
bidirectional relaying techniques, IEEE 802.16 uplink ranging techniques, IEEE 802.16m 
multi-input multi-output (MIMO) transmission techniques, DSP software implementation of 
IEEE 802.16m initial downlink synchronization technique, and DSP software 
implementation of IEEE 802.16m channel estimation technique. Of these topics, the first 
three pertain to algorithm research and the last two pertain to DSP software implementation 
research. 
Concerning relaying techniques, we study a bidirectional relaying method which can, 
effectively, let the weaker transmitter share the transmission power of the stronger 
transmitter. In IEEE 802.16m uplink ranging techniques, we study the corresponding 
specifications, algorithms, and performance. In IEEE 802.16m MIMO transmission 
techniques, we also study the corresponding specifications, algorithms, and performance. In 
DSP software implementation of IEEE 802.16m initial synchronization technique and IEEE 
802.16 channel estimation technique, we base the work on our past algorithm research 
results. The DSP implementation employs fixed-point computation and we also conduct 
code optimization, both for the benefit of execution speed. 
 
Keywords: Orthogonal Frequency-Division Multiple Access (OFDMA), Orthogonal 
Frequency-Division Multiplexing (OFDM), Relay, Ranging, Multi-input Multi-output 
(MIMO), Synchronization, Channel Estimation 
 
 1 
一、計畫與報告簡介 
無線通訊技術本就不斷發展，但自從國際電信聯盟射頻通訊標準部門(ITU-R)於幾
年前公布其制定第四代(4G)行動通訊標準 IMT-Advanced 的計畫後，更引發一波相關
的研發浪潮。許多公司與機構都意圖在此一標準中取得一席之地。但由於行動通訊系
統高度複雜，所以這些公司與機構係透過組成團隊的方式來參與 IMT-Advanced 標準
研發。此其中兩個主要的標準團隊就是 IEEE 802.16m工作團(task group)和第三代行動
通訊夥伴計畫(3GPP)先進長程發展(LTE-Advanced)團體。以空氣介面系統而言，幾個
主要且被這些團隊所積極發展的技術包括：各型多輸出入(multi-input multi-output, 
MIMO)傳輸技術、極微細胞(femtocell)系統技術、以及中繼(relay)系統技術。其中底層
的調變方式皆基於正交分頻多工(orthogonal frequency-division multiplexing, OFDM)型
式的技術，含正交分頻多重進接(orthogonal frequency-division multiple access, OFDMA)
和單載波分頻多重進接(single-carrier frequency-division multiple access, SC-FDMA)。 
本計畫為一整合型計畫之子計畫，旨在研究無線通訊之傳輸訊號處理技術。其細部
研究內容的規劃，係本於一個思維，即：立足近期標準相關之技術，放眼未來可能之
發展。說明如下。先參 Fig. 1-1，其中所示係根據目前技術發展趨勢，所設想未來無線
傳輸系統之可能環境架構。圖中 BS、RS、與 MS 之間的雙箭頭連線表示無線通道。
實際上，視 BS、RS、與 MS的相對位置，MS也可以不經 RS而直接連上 BS(這也就
是目前行動通訊系統的一般架構，是故此示意圖可說亦涵蓋目前的行動通訊系統架
構)。但一方面這樣的情況比圖中所示者單純，二方面若也顯示直接連接的情況，會使
示意圖太複雜。所以我們只顯示MS經 RS連上 BS的情況。此系統最複雜的運作情境，
是各 BS、各 RS、和各MS都可以有多支天線，而多個 BS可以同時向多個 RS傳送訊
號(即downlink multiuser MIMO加上downlink coordinated multi-point [CoMP])或同時接
收從多個 RS傳來的訊號(即 uplink multiuser MIMO加上 uplink CoMP)，且多個 RS也
可以同時向多個 MS 同時傳送訊號或同時接收從多個 MS 傳來的訊號。若是 RS 具有
雙向傳收功能(即 bidirectional RS或 two-way RS)，則各 BS和各MS又可以同時向各
RS傳送訊號，而各 RS也可以同時向各 BS和各 MS傳送訊號。然而以上最複雜的運
作情境，在目前只是一個長程的研究方向，預期還要不少年以後才會趨於實用。較短
期內可以實用化的運作情境，應該比此最複雜的情境要簡單。 
 
 
Fig. 1-1. 傳輸環境架構示意圖，其中 BS = base station, RS = relay station, MS = mobile 
station。 
 3 
二、雙向中繼技術研究 
本節主要內容自下頁起，以學術論文初稿方式呈現。我們將在未來繼續進行相關研
究。 
 
0 1
h h+
0 1
h h−
0 1
h h− +
0 1
h h− −
0
R
y = 1Fg h1Fg h−
0
0 1
( , )x x = ( 1, 1)− − ( 1, 1)− + ( 1, 1)+ +( 1, 1)+ −
R
x =
0 1
( , )x x =
( 1, 1)+ −
( 1, 1)− +
( 1, 1)+ +
( 1, 1)− −
0
h
0
h−
Fig. 2. Noiseless received and transmitted relay signal constellations for
(2,2)-PAM and the corresponding source signal pairs.
modulation as (M0,M1)-PAM. Without loss of generality,
assume h0 ≥ h1 > 0. And define h = h1/h0. In the broadcast
(BC) phase, relay R broadcasts the folded signal xR = f(yR)
to T0 and T1. The folding operation and the detection methods
at the terminal nodes are described further later.
III. CASE WITH (2,2)-PAM
In the (2,2)-PAM case, we have x0, x1 ∈ {+1,−1}. In
absence of relay noise, the yR constellation consists of either
3 or 4 points, depending on whether h = 1 or h < 1.
We concentrate on the latter condition as the former can
be considered an asymptotic case of it. The four noiseless
received signal points at the relay are given by ±h0±h1. Let
the FF operation be given by (similar to [11])
f(yR) = gF (|yR| − h0) (2)
where gF is a scaling factor to satisfy any transmission power
constraint of the relay and the subtraction of h0 is to make
xR approximately zero-mean. The exact relation between gF
and the relay transmission power will be given later.
The noiseless constellations of yR and xR are illustrated
in Fig. 2, together with the corresponding source signal pairs
(x0, x1). The constellation for xR satisfies the “exclusive law”
[8], [9]; that is, given x0 (resp. x1), different values of x1
(resp. x0) are mapped to different constellation points. Hence
both terminals can determine the other party’s transmission
unambiguously from the received BC signal of the relay, if
there is no noise. The detection method (in noise) at terminal
Ti (i = 0, 1) is given by
xˆi¯ =
{
sgn(yi), if xi > 0,
−sgn(yi), otherwise, (3)
where xˆi¯ is the detected signal at Ti, with 0¯ = 1 and 1¯ = 0,
and sgn(·) is the signum function with sgn(0) , 1.
A. Error Performance
For simplicity, assume that n0, n1, and nR are white Gaus-
sian (AWGN) with equal variance σ2n. Because the received
signal at either terminal contains two AWGN components,
it turns out that the effective decision boundaries and er-
ror regions for Ti can be conveniently depicted in a two-
dimensional plot as shown in Fig. 3, where the four black
dots indicate the noiseless received signal constellation at the
relay. In the figure, region I (shaded) applies to the error of
having xˆi¯ = −xi when xi¯ = xi, and region II that of having
xˆi¯ = xi when xi¯ = −xi. (The decision boundary is the same
for all four signal points.) In contrast, the effective decision
boundaries under plain AF are as shown in Fig. 4, where gA
is the relay amplification factor under AF. For either T0 or T1,
the thick solid line (resp. dashed line) indicates the boundary
Ry
0F ig hh
in
0h0h−
Fig. 3. Effective decision boundaries and error regions for (2,2)-PAM under
FF for terminal Ti, i = 0, 1.
Ry
2
0Ag h
0n
Ry
2
1Ag h
1n
2
0Ag h−
2
1Ag h−
0h−
1h−0h 1h
Fig. 4. Effective decision boundaries for (2,2)-PAM under AF at terminals
T0 (left) and T1 (right).
when the local transmitter emitted a +1 (resp. −1) in the
MA phase. For clarity, signal points associated with the solid-
line boundaries are indicated using solid dots, whereas those
associated with the dashed-line boundaries are indicated using
cross-hatched dots.
The qualitative difference in performance between FF and
AF can be gleaned without going to detailed mathematics
by comparing Figs. 3 and 4. For this, note that, in high
signal-to-noise ratio (SNR), the error probability of each signal
point is primarily determined by its distance to the nearest
decision boundary. For the sake of argument, let gF = gA
for now. Then, by comparing Fig. 3 with the left plot in
Fig. 4, we see that the detection error probabilities at T0 (for
signals transmitted from T1) under both forwarding schemes
are similar. But they are different at T1 (compare Fig. 3 with
the right plot in Fig. 4), with AF claiming advantage over
FF because the former has a larger distance between each
signal point and its associated decision boundary. However,
if the relay is power-limited rather than gain-limited, then
we can have gF > gA because FF has a smaller relay
signal constellation than AF (see Fig. 2). Then the relative
performance of FF with respect to AF improves. In particular,
FF yields a better performance than AF at T0 by effecting a
larger distance between each signal point and its corresponding
decision boundary. At T1, the relative performance of FF also
improves, but in many conditions (details omitted) still lags
that of AF. Compared to AF, therefore, FF may be viewed in
some sense as virtually robbing the detection performance of
T0 signals (which are detected at T1) in favor of T1 signals
(which are detected at T0). Thus the title of this letter.
Employing the formulation proposed in [12], we obtain the
bit error rate (BER) under FF at Ti (for signals from Ti¯) as
PFi =
1
2
(P Ii + P
II
i ) (4)
with
P Ii =
1
2pi
∫ pi−(φIi−φi)
0
e−
γi(h1)
2 sin2 θ dθ
− 1
2pi
∫ pi−(φIi+φi)
0
e−
γi(2h0+h1)
2 sin2 θ dθ (5)
5
Ry
0F ig hh
in
0h0h−
0 12h h−0 12h h− + 0 12h h+0 12h h− −
0 1( 2 )F ig h h h+
0 1( 2 )F ig h h h−
Fig. 7. Effective decision boundaries for (2,4)-PAM under FF at terminals
T1 (thick dashed line) and T0 (all three thick solid and dashed lines).
satisfying the exclusive law so that colocated points are asso-
ciated with uniquely distinguishable signals at the terminals
[8], [9]. In fact, more than one workable folding method
can be conceived. Space precludes a detailed discussion.
However, for (2,M1)-PAM the method in (2) suffices. And the
noiseless transmitted signal constellation of the relay is given
by {kgFh1|k = ±1,±3, . . . , ... ± (M1 − 1)}. The detection
method at T1 can be the same as in (3) and that at T0 can be
xˆ1 =
{
min(−3,max(3, xˆa1)), if x0 > 0,
min(−3,max(3,−xˆa1)), otherwise, (14)
where
xˆa1 = 2 · ⌈y1/(2gFh21)⌉ − 1, (15)
with ⌈ ⌉ being the ceiling function.
To illustrate the resulting performance, consider (2,4)-PAM
with the FF operation as given in (2). Then the effective
decision boundaries under FF are as shown in Fig. 7. Hence,
in high SNR, the symbol error rate (SER) at Ti (i = 0, 1) (for
signals from Ti¯) under FF is approximately given by
PFi = K
F
i Q
(
h1(gFhi)√
1 + (gFhi)2 σn
)
(16)
where KF0 = 1.5 and K
F
1 = 0.5. In contrast, that under AF
is approximately given by
PAi = K
A
i Q
(
hi¯(gAhi)√
1 + (gAhi)2 σn
)
(17)
where KA0 = 1.5 and K
A
1 = 1. We omit detailed derivation as
well as the expressions for the exact SER due to their length.
Nevertheless, we note that, for i = 1, the equality in (17) is
exact because T0 signals are binary.
Fig. 8 shows the SER performance for the condition h0 = 1,
h1 = 0.33, and PR = 1. Again, theory and simulation results
agree well. And, in comparison to AF, FF again improves
significantly the detection performance of T1 signals (detected
at T0) at the expense of the detection performance of T0
signals (detected at T1), as discussed.
V. CONCLUSION
We studied the FF technique for two-way relaying. We
showed that, in asymmetric channel conditions, FF could tip
the error performance in a way that appeared like letting
the worse-conditioned terminal share the transmitter power of
the better-conditioned terminal virtually. Similar can be said
for the case where the two terminals are subject to unequal
transmitter power constraints.
5 10 15 20 25
10−6
10−5
10−4
10−3
10−2
10−1
100
Nominal SNR (10 log10(1/σn
2), dB)
SE
R
 
 
FF simul., T0 signal
FF theory, T0 signal
FF approx., T0 signal
AF simul., T0 signal
AF theory, T0 signal
FF simul., T1 signal
FF theory, T1 signal
FF approx., T1 signal
AF simul., T1 signal
AF approx., T1 signal
Fig. 8. SER performance with (2,4)-PAM in AWGN at h0 = 1, h1 = 0.33,
and PR = 1. Curves marked “theory” give exact theoretical values, although
their expressions under FF are omitted in this letter.
REFERENCES
[1] K. M. Josiam, Y.-H. Nam, and F. Khan, “Intelligent coding in relays,”
IEEE Veh. Tech. Mag., vol. 4, no. 1, pp. 27–33, Mar. 2009.
[2] F. Rosetto and M. Zorzi, “Mixing network coding and cooperation for
reliable wireless communications,” IEEE Wirel. Commun., vol. 18, no.
1, pp. 15–21, Feb. 2011.
[3] S. Zhang, S. C. Liew, and P. P. Lam, “Hot topic: physical-layer network
coding,” in Proc. 12th Annual Int. Conf. Mobile Comput. Network. ACM,
2006, pp. 358–365.
[4] P. Popovski and H. Yomo, “Physical network coding in two-way wireless
relay channels,” in IEEE Int. Conf. Commun., 2007, pp. 707–712.
[5] R. Ahlswede, N. Cai, S.-Y. R. Li, and R. W. Yeung, “Network informa-
tion flow,” IEEE Trans. Inf. Theory, vol. 46, no. 4, pp. 1204-1216, July
2000.
[6] S. Katti, H. Rahul, W. Hu, D. Katabi, M. Me´dard, and J. Crowcroft,
“XORs in the air: practical wireless network coding,” IEEE/ACM Trans.
Network., vol. 16, no. 3, pp. 497–501, June 2008.
[7] I.-J. Baik and S.-Y. Chung, “Network coding for two-way relay channels
using lattices,” in IEEE Int. Conf. Commun., 2008, pp. 3898–3902.
[8] T. Koike-Akino, P. Popovski, and V. Tarokh, “Optimized constellations
for two-way wireless relaying with physical network coding,” IEEE J.
Sel. Areas Commun., vol. 27, no. 5, pp. 773–787, June 2009.
[9] T. Uricar and J. Sykora, “Design criteria for hierarchical exclusive
code with parameter-invariant decision regions for wireless 2-way relay
channel,” EURASIP J. Wirel. Commun. Network., vol. 2010, pp. 1–13,
Jan. 2010.
[10] W. Chen, L. Hanzo, and Z. Cao, “Network coded modulation for two-
way relaying,” in Proc. IEEE Wirel. Commun. Netowrk. Conf., 2011, pp.
1765–1770.
[11] T. Cui, T. Ho, and J. Kliewer, “Memoryless relay strategies for two-way
relay channels,” IEEE Trans. Commun., vol. 57, nos. 10, pp. 3132–3143,
Oct. 2009.
[12] J. W. Craig, “A new simple and exact result for calculating the probabil-
ity of error for two-dimensional signal constellations,” in IEEE Military
Commun. Conf., Nov. 1991, pp. 571–575.
7
Study in Initial Ranging for IEEE 802.16m
Preliminary Draft
Abstract—We consider the uplink ranging specifications in
IEEE 802.16m and we study the associated uplink ranging
method. Simulations are conducted to evaluate the detection
performance.
I. INTRODUCTION
Initial ranging is the procedure where a mobile station
(MS) expresses desire to connect to a base station (BS). This
procedure is variously named in different systems. Whereas it
is termed initial ranging in IEEE 802.16m, such a procedure
is termed random access in the 3GPP cellular communication
systems.
During initial ranging, an MS transmits a ranging signal
according to the format and the opportunity provided by the
BS. However, due to motion and other reasons, it is likely that
the signal arrives at the BS with a time offset, a frequency
offset, or a power offset that is outside the allowed range
of operation. Upon detection of a ranging signal, the BS
may have to initiate a procedure for communicating with the
ranging MS to adjust these parameters and to acquire further
identity information regarding the MS.
The present study is concerned with the detection of initial
ranging signals. In what follows, Sec. II introduces the ranging
signal specifications of IEEE 802.16m. Sec. III presents the
proposed ranging signal detection method which also obtains
the timing of the detected signal. It will also present some
simulation results. Sec. IV considers carrier frequency offset
(CFO) estimation following detection of the ranging signals.
And Sec. V is the conclusion.
II. RANGING SIGNAL IN IEEE 802.16M
The ranging channel in IEEE 802.16m can be classified into
ranging channel for synchronized and non-synchronized MSs,
where the former is for so-called “periodic ranging” and the
latter is for initial access and handover. We consider the latter
only.
According to IEEE 802.16m, a physical ranging channel for
non-synchronized MSs consists of the ranging preamble (RP)
with length of TRP depending on the ranging subcarrier spac-
ing △fRP , and the ranging cyclic prefix (RCP) with length of
TRCP in the time domain, where TRP , △fRP , and TRCP are
some parameters. A ranging channel occupies a bandwidth
of one subband. The ranging channel has two formats as
described in Table I, where Tb, Tg , and △f are some other
paramters, k1 = (Nsym +1)/2 and k2 = (Nsym − 4)/2, with
Nsym being the number of OFDMA symbols in a so-called
“advanced air interface” (AAI) subframe. In our work, for
simplicity, we let Tb = 1024, Tg = 128, △f = 10.9375 kHz,
and Nsym = 6, which are a proper set of values under IEEE
802.16m.
TABLE I
RANGING CHANNEL FORMATS AND PARAMETERS
Format No. TRCP TRP △fRP
0 k1 × Tg + k2 × Tb 2× Tb △f/2
1 3.5× Tg + 7× Tb 8× Tb △f/8
Fig. 1. Ranging channel allocation in AAI subframe [1, Fig. 570(a)].
Ranging channel for non-synchronized AMSs is allocated
in one or three uplink (UL) AAI subframes for format 0 or
format 1, respectively. Format 0 has a repeated structure as
shown in Fig. 1. The transmission start time of the ranging
channel is aligned with the UL AAI subframe start time at
the AMS. The remaining time duration of the AAI subframes
is reserved to prevent interference between the adjacent AAI
subframes.
For initial ranging, each MS randomly chooses one of the
ranging preamble codes from the available set of ranging
preamble codes specified by the BS. These codes are Zadoff-
Chu sequences. The pth ranging preamble code xp(k) is given
by
xp(k) = exp(−j · pi · rp · k(k + 1) + 2 · k · sp ·NCS
NRP
), (1)
where NRP , rp, sp, and NCS are some parameters. Based on
the IEEE 802.16m specifications, we have NRP = 139. For a
detailed definition of the other parameters, we refer to [1].
III. RANGING SIGNAL DETECTION AND TIMING
ESTIMATION
Fig. 2 shows the overall UL transmitter and receiver system.
W assume that there may be more than one user transmitting
ranging signals at the same time. The receiver at the BS will
collect 4096 samples of the received signal located in the
middle of a subframe as shown in Fig. 3. We add the first
2048 points to the latter 2048 points together to get r(n).
This is because the ranging signal has a two-times repetition
structure as shown in Fig. 1. After the timing offset estimation
and ranging code detection blocks, the output contains the
information of detected codes and estimated timing offsets.
Details of these blocks are described below.
We assume that the BS allocates u possible ranging codes,
where u = 8. So the BS has to correlate each of these codes
with R(k) to determine if any of them is present and, for each
9
−20 −15 −10 −5 0 5 10 15 20
0
0.2
0.4
0.6
0.8
1
1.2
1.4
Average Sample Offset RMSE in the AWGN channel
SNR(dB)
a
ve
ra
ge
 s
am
pl
e 
of
fs
et
 R
M
SE
 
 
3 users
2 users
1 user
Fig. 6. Timing estimation accuracy in AWGN with different number of
ranging signals occupying the same ranging channel.
−20 −15 −10 −5 0 5 10 15 20
1
1.1
1.2
1.3
1.4
1.5
1.6
1.7
1.8
Average Sample Offset RMSE in the SUI3 channel
SNR (dB)
a
ve
ra
ge
 s
am
pl
e 
of
fs
et
 R
M
SE
 
 
1 user
2 users
3 users
Fig. 7. Timing estimation accuracy in SUI3 channel with different number
of ranging signals occupying the same ranging channel.
all users’ wireless channels being AWGN or SUI3 [3]. (The
SUI wireless channels were originally developed for fixed
wireless access studies. But they have been used for mobile
radio studies by imposing a greater Doppler spread on their
channel multipaths.) The performance in different wireless
channel conditions show similar general trends, although they
are different in details. We see that, even with three ranging
users in one ranging channel, the root-mean-square (RMS)
timing error is still under two sample, which appears accurate
enough for practical application.
Now consider a case where there may be one, two, or three
users transmitting ranging signals in the same ranging channel,
but the multipath wireless channels of the users are different.
Fig. 8 shows some results, where TU stands for the 6-path
typical urban channel [4, ch. 2]. In this case, the performance
is worse than in the previous two cases. But the maximum
RMS timing error (which occurs with three users transmitting
ranging signals in the same ranging channel) is still under four
samples down to approximately −15 dB of signal-to-noise
ratio (SNR), which appears sufficiently good for application.
IV. CARRIER FREQUENCY OFFSET ESTIMATION
After detection of the ranging signals and estimation of
their timing, we proceed to estimate their CFOs. This is so
that the BS may feed this information back to the MSs for
−20 −15 −10 −5 0 5 10 15 20
0
2
4
6
8
10
12
14
16
18
Average Sample Offset RMSE in the hybrid channel (SUI1, SUI3, TU)
SNR (dB)
a
ve
ra
ge
 s
am
pl
e 
of
fs
et
 R
M
SE
 
 
1 user
2 users
3 users
Fig. 8. Timing estimation accuracy with different number of ranging signals
occupying the same ranging channel. The ranging signals experience different
multipath wireless channels.
1i≠
∑
i Q≠
∑
…
…
…
…
…
…
…
…
Fig. 9. Proposed multiple CFO estimation method.
carrier frequency adjustment. As there may be more than
one ranging signals occupying the same ranging channel, we
propose an iterative method for CFO estimation based on
parallel interference cancellation. The method is illustrated in
Fig. 9. It is motivated by [5].
Note that, in the UL, we expect the ranging signals are
only subject to fractional CFO (where the CFO normalized
to the subcarrier spacing is a fractional number). This is
because before the MS attempts ranging, it has to have already
executed an initial downlink (DL) synchronization procedure
to acquire the ability to receive DL signals from the BS.
In Fig. 9, s(m)i (n) denotes the interference-cancelled version
of the ith ranging signal after the mth iteration. In each
iteration, the CFO of the ith ranging signal is estimated as
εˆi =
1
−2pi∠
∑
n
yi(n) · y∗i (n+N), i = 1, 2, ..., Q, (2)
where Q is the number of ranging signals and yi(n) is the
interference-cancelled received signal.
Fig. 10 shows some results of the estimation performance
with all ranging signals in AWGN. The MSEs for all three
ranging signals (users) decrease linearly with increasing SNR,
which appears intuitively reasonable. Fig. 11 shows some
results with the ranging signals experiencing different wireless
channels. The performance becomes worse than that in AWGN
(which may be intuitively expected) and channel-dependent
11
 13
四、IEEE 802.16m多輸出入傳收技術研究 
本節主要內容自下頁起，以學術論文初稿方式呈現。這些結果係摘自參考文獻[1]。 
 
Fig. 1. Basic frame structure for 5, 10 and 20 MHz channel bandwidths
(Fig.466 in [10]).
The basic frame structure is applied to FDD and TDD
duplexing schemes, including H-FDD MS operation. The
number of switching points in each radio frame in TDD
systems shall be two, where a switching point is defined as a
change of directionality, i.e., from DL to UL or from UL to
DL.
B. Downlink MIMO Architecture and Data Processing
The architecture of downlink MIMO at the transmitter side
is shown in Fig. 2. The MIMO encoder block maps L MIMO
layers (L ≥ 1) onto Mt MIMO streams (Mt ≥ L), which are
fed to the precoder block. For the spatial multiplexing modes
in SU-MIMO, “rank” is defined as the number of MIMO
streams to be used for the user allocated to the Resource Unit
(RU). For SU-MIMO, only one user is scheduled in one RU,
and only one forward error correction (FEC) block exists at the
input of the MIMO encoder (vertical MIMO encoding at trans-
mit side). For MU-MIMO, multiple users can be scheduled in
one RU, and multiple FEC blocks exist at the input of the
MIMO encoder (horizontal MIMO encoding or combination
of vertical and horizontal MIMO encoding at transmit side,
which is called multi-layer encoding). The precoder block
maps MIMO stream(s) to antennas by generating the antenna-
specific data symbols according to the selected MIMO mode.
The subcarrier mapper blocks map antenna-specific data to the
OFDM symbol.
Fig. 2. DL MIMO architecture (Fig.537 in [10]).
C. MIMO Layer to MIMO Stream Mapping
MIMO layer to MIMO stream mapping is performed by
the MIMO encoder. The MIMO encoder is a batch processor
that operates on M input symbols at a time. The input to the
MIMO encoder is represented by an M × 1 vector as
s =

s1
s2
...
sM
 (1)
where si is the ith input symbol within a batch. In MU-MIMO
transmissions, the M symbols belong to different AMSs. Two
consecutive symbols may belong to a single MIMO layer. One
AMS shall have at most one MIMO layer. MIMO layer to
MIMO stream mapping of the input symbols is done in the
space dimension first. The output of the MIMO encoder is an
Mt ×NF MIMO STC matrix as,
x = S(s), (2)
which serves as the input to the precoder, where Mt is the
number of MIMO streams, NF is the number of subcarriers
occupied, x is the output of the MIMO encoder, s is the
input MIMO layer vector, and S() is a function that maps
an input MIMO layer vector to an STC matrix which will
be further defined specifically for various cases below. There
are four MIMO encoder formats (MEF): SFBC, vertical en-
coding (VE), multi-layer encoding (ME), and conjugate data
repetition (CDR). For SU-MIMO transmissions, the STC rate
is defined as R =
M
NF
For MU-MIMO transmissions, the STC rate per user (R) is
equal to 1 or 2.
1) SFBC Encoding: The input to the MIMO encoder is a
2× 1 vector
s =
[
s1
s2
]
, (3)
and the MIMO encoder generates the 2× 2 SFBC matrix
x =
[
s1 −s∗2
s2 s
∗
1
]
. (4)
Where x is a 2 × 2 matrix The matrix x occupies two
consecutive subcarriers.
2) Vertical Encoding (VE): The input and the output of
MIMO encoder are both the same M × 1 vector as
x = s =

s1
s2
...
sM
 (5)
where si, 1 ≤ i ≤ M , belong to the same MIMO layer. The
encoder is an identity operation.
3) Multi-layer Encoding (ME): The input and the output
of MIMO encoder are again the same M × 1 vector
x = s =

s1
s2
...
sM
 , (6)
15
MIMO 
Feedback 
Mode
Description 
and Type of 
RU
FeedbackContent Support MIMO Mode 
Outside the OL region
Support MIMO
Mode Inside the OL 
region
0 OL SU MIMO
SFBC/SM
(Diversity:
DLRU, NLRU)
Sounding 
based CL SU 
and MU 
MIMO
1. STC rate
2. WidebandCQI
MIMO mode 0 and 
MIMO mode 1
Flexible adaptation 
between the two
modes
STC rate=1:SFBC CQI
2<=STC rate<=4:SM CQI
In DLRU: M
t
=2 for SM
In NLRU: M
t
>=2 for SM
For sounding based CL 
SU MU MIMO, STC rate 
=1:SFBC CQI
MIMO mode 0 and 
MIMO mode 1
Flexible adaptation 
between the two 
modes
STC rate=1:SFBC CQI
STC rate=2:SM CQI
In DLRU only
1 OL SU MIMO
SM (Diversity: 
NLRU)
1. Wideband CQI n.a MIMO mode 5
STC rate = 1/2
2 OL SU MIMO 
SM (localized: 
SLRU)
1. STC rate
2. SubbandCQI
3. Subband
selection
MIMO Mode 1
1<=STC rate<=8
MIMO mode 5
STCrate = 1/2
3
CL SU MIMO 
(localized: 
SLRU)
1. STC rate
2. SubbandCQI
3. SubbandPMI
4. Subband
selection
5. Wideband 
correlation 
matrix
MIMO mode 2
1<=STC rate<=8
n.a
4
CL SU MIMO
(Diversity: 
NLRU)
1. WidebandCQI
2. Wideband PMI
3. Wideband 
correlation 
matrix
MIMO mode 2
(M
t
≦4)
n.a
5 OL MU 
MIMO 
(localized:
SLRU)
1. SubbandCQI
2. Subband
selection
3. MIMO stream 
indicator
MIMO mode 3 MIMOmode 3
6 CL MU 
MIMO 
(localized:
SLRU)
1. SubbandCQI
2. SubbandPMI
3. Subband
selection
4. Wideband 
correlation 
matrix
MIMO mode 4 n.a
7 CL MU 
MIMO 
(Diversity: 
NLRU)
1. Wideband CQI
2. Wideband PMI
3. Wideband 
correlation 
matrix
MIMOmode 4 n.a
Fig. 5. MIMO feedback modes (from [10, Table 849]).
Fig. 6. System structure.
IV. PROPOSED FEEDBACK SELECTION SCHEMES
In this section, we derive two feedback selection schemes
maxminSNR-based search method and MMSE-based exhaus-
tive search method that can greatly reduce the complexity.
A. MaxminSNR-Based Search Method
In this method, We maximize the minimum SNR at the
receiver antennas under MMSE or ZF equalization. It can be
thought as minimize the maximum symbol error rate (SER)
at the receive antennas. The signal power per receive antenna
can be expressed as
| gTkHFix |2 . (15)
The noise power is
σ2n | gTk gk | . (16)
The optimum precoding matrix F selected from the codebook
C maximizes the minimum SNR of at the receive antennas as
F = argmax
Fi
min
k|Fi
SNRk
= argmax
Fi
min
k|Fi
| gTkHFix |2
σ2n | gTk gk |
(17)
where k is the index of the receive antennas, i is the index of
the precoder, and gk is the equalizer for kth receive antenna.
B. MMSE-Based Exhaustive Search Method
In this method, we minimize the mean square error (MSE)
between Xˆ and X under the ZF or the MMSE equalizer. We
compare all possible precoders to find the best one in the
source that
minMSE = argmin
Fi
‖Xˆ−X‖2. (18)
For ZF equalizer, therefore,
minMSE = argmin
Fi
‖(HFi)†HFiX+ (HFi)†n−X‖2,
(19)
and for the MMSE equalizer,
minMSE = argmin
Fi
‖(HFiFHi HH +R−1n )HFiHFiX
+ (HFiF
H
i H
H +R−1n )HFin−X‖2.
(20)
Then we will transmit the precoder index i back to the
transmitter. The transmitter will use this precoder to allocate
the power. In this method, the computation of complexity is
high, because we have to evaluate all the precoders.
V. SIMULATION RESULTS
In the simulation, we consider both additive white Gaussian
noise (AWGN) channels.
A. System Parameter and Channel Model
Channel models for evaluation of IMT-Advanced candidate
radio interface technologies [6]. We use the Suburban macro-
cell model. The parameter are in Fig. 7. The root-mean-square
(RMS) delay spread of Suburban macrocell channel is 75.7485
ns. Table I gives the primitive and derived parameters used in
our simulation work. The results are averages over 10,000,000
channel realizations.
B. Two Transmit Antennas and Two Receive Antennas with
Rank Two
For comparison, we consider a no feedback system with
feedback system.
First, consider the case of AWGN channels. Fig. 8 shows the
symbol-error-rate (SER) performance of the systems. There is
no difference between theory, MMSE equalizer with feedback
and MMSE equalizer without feedback.
17
0 5 10 15 20 25 30
10−2
10−1
100
101
102
103
Different equalizer with different feedback V120
SNR (dB)
N
or
m
al
iz
e 
M
SE
 
 
ZF, No feedback
ZF, SVD−Based
ZF, MMSE−Based
ZF, MaxminSNR
ZF, Optimum Precoder
MMSE, No feedback
MMSE, SVD−Based
MMSE, MMSE−Based
MMSE, MaxminSNR
MMSE, Optimum Precoder
Fig. 11. MSE for QPSK using ZF and MMSE equalizer with different
feedback methods at 120 km/h in multipath Suburban channel.
0 5 10 15 20 25 30
10−3
10−2
10−1
100
Different equalizer with different feedback V120
SNR (dB)
SE
R
 
 
ZF, No feedback
ZF, SVD−Based
ZF, MMSE−Based
ZF, MaxminSNR
ZF, Optimum Precoder
MMSE, No feedback
MMSE, SVD−Based
MMSE,  MMSE−Based
MMSE, MaxminSNR
MMSE, Optimum Precoder
Fig. 12. SER for QPSK using ZF and MMSE equalizer with different
feedback methods at 120 km/h in multipath Suburban channel.
C. Four Transmit Antennas and Four Receive Antennas with
Rank Two
In the last part, we consider the case of suburban macrocell
channel with 4 transmit antennas and 4 receive antennas
transmiting two streams. Figs. 13–12 show that there is a 1dB
gain with precoding and no precoding.
D. Computation Complexity
In the design of signal processing algorithms, an analysis
of the required number of flops is often derivable. Where
a flop means a floating point operation. In this regard, a
dot product of length n vectors is considered to require 2n
flops because there are n multiplications and n adds. We
derive the expressions for the number of needed flops that
the equalization in the CL MIMO requires. [16] gives the flop
counts of some common matrix operations.
0 5 10 15 20 25 30
10−3
10−2
10−1
100
101
102
103
ZF equalizer with different feedback V120
SNR (dB)
N
or
m
al
iz
e 
M
SE
 
 
ZF No feedback 2*2
ZF, MMSE−Based 2*2
ZF, Optimum Precoder 2*2
ZF No feedback 4*4
ZF, MMSE−Based 4*4
ZF, Optimum Precoder 4*4
Fig. 13. MSE for QPSK using ZF equalizer with different feedback methods
and different antennas at 120 km/h in multipath Suburban channel.
0 5 10 15 20 25 30
10−6
10−5
10−4
10−3
10−2
10−1
100
ZF equalizer with different feedback V120
SNR (dB)
SE
R
 
 
ZF No feedback 2*2
ZF, MMSE−Based 2*2
ZF, Optimum Precoder 2*2
ZF No feedback 4*4
ZF, MMSE−Based 4*4
ZF, Optimum Precoder 4*4
Fig. 14. SER for QPSK using ZF equalizer with different feedback methods
and different antennas at 120 km/h in multipath Suburban channel.
In an order of magnitude study, we often throw away the
lower order terms since their inclusion does not contribute to
the overall flop count. But if the n is small, we have to keep
the all the terms. This happens to be our case. We list the total
flop counts per subcarrier in Fig. 15.
We can see that optimum precoder performs well in com-
plexity because it does not have a complex computation flow.
Also we can see that ZF equalizer is much easier than MMSE
equalizer. SVD-based and maxminSNR-based search method
have less complexity in high order matrix. We can have a
conclusion that if the matrix size is low, we can use the
MMSE-based search method. When the matrix size is high,
we use SVD-based and maxminSNR-based search method.
VI. CONCLUSION
We considered joint design at both end of the links and
introduced two classes of linear equalization: Zero-forcing
19
 21
五、IEEE 802.16m初始下行同步技術之數位訊號處理器軟體實現研究 
本節主要內容自下頁起，以學術論文初稿方式呈現。這些結果係摘自參考文獻[2]。
本項成果係衍伸之前在演算法方面的研究成果[3]。 
 
SU0 SU1 SU2
Superframe : 20ms
F0 F1 F2 F3
TDD frame : 5ms
Superframe Header PA-Preamble SA-Preamble
DL
SF
DL
SF
DL
SF
UL
SF
UL
SF
TTG RTG
 
Fig. 1. Location of the A-Preamble symbol (re-arranged from Fig. 500 in
[5]).
640267A0C0DF11E475066F1610954B5AE55E189EA7E72EFD57240FN/APartially configured10
D46CF86FE51B56B2CAA84F26F6F204428C1BD23F3D888737A0851Creserved9
3A65D1E6042E8B8AADC701E210B5B4B650B6AB31F7A918893FB04Areserved8
DA8CE648727E4282780384AB53CEEBD1CBF79E0C5DA7BA85DD3749reserved7
8A9CA262B8B3D37E3158A3B17BFA4C9FCFF4D396D2A93DE65A0E7Creserved6
7EF1379553F9641EE6ECDBF5F144287E329606C616292A3C77F928reserved5
BCFDF60DFAD6B027E4C39DB20D783C9F467155179CBA31115E2D04reserved4
6DE116E665C395ADC70A89716908620868A60340BF35ED547F8281reserved3
92161C7C19BB2FC0ADE5CEF3543AC1B6CE6BE1C8DCABDDD319EAF720 MHz2
1799628F3B9F8F3B22C1BA19EAF94FEC4D37DEE97E027750D298AC7,8.75,10 MHz1
6DB4F3B16BCE59166C9CEF7C3C8CA5EDFC16A9D1DC01F2AE6AA08F5 MHz
Fully 
configured
0
Series to modulateBWCarrierIndex
 
Fig. 2. PA-Preamble Series (Table 780 in [5]).
RTG PA-Preamble Data Symbol
CP
256 64 512 576
Window size = 576 samples
00…..000000
320
Data Symbol
Window Sliding
Window size = 576 samples
 
Fig. 3. Window sliding structure [1].
is boosted before transmitting, and the detail parameter refer
to [5].
Other parameter values are specified in Table I.
3. INITIAL DOWNLINK SYNCHRONIZATION ALGORITHM
FOR IEEE 802.16M
The downlink synchronization can be divided into two type:
initial synchronization and normal synchronization. When the
advance mobile station (AMS) receiver enters the network for
the first time, it need to perform initial DL synchronization.
Afterward, the AMS needs to keep trading the carrier fre-
quency, and the timing, and the power level, which constitutes
the work of normal DL synchronization. In this thesis, our
study focuses on initial DL synchronization; so we discuss the
initial DL synchronization problem of the IEEE 802.16m TDD
TABLE I
SYSTEM PARAMETERS USED IN OUR STUDY
Parameters Values
System Channel Bandwidth (MHz) 5 10 20
Sampling Frequency (MHz) 5.6 11.2 22.4
FFT Size 512 1024 2048
Subcarrier Spacing (kHz) 10.94 10.94 10.94
Useful Symbol Time (µsec) 91.4 91.4 91.4
Guard Time (µsec) 11.4 11.4 11.4
OFDMA Symbol Time (µsec) 102.9 102.9 102.9
system and introduce the initial DL synchronization algorithm
of [1], [2].
1. The Initial Synchronization Problems
In the DL, due to potentially large tolerance in the free-
running oscillator frequency of the MS, and due to the motion-
induced Doppler spread, there may be large CFO in the
received signal. The large CFO can be partitioned into the
fractional part of “normalized CFO” (where normalization
is with respect to the subcarrier spacing) and integral part
of “normalized CFO”. We call them “fractional CFO” and
“integer CFO” respectively in this paper.
2. Initial DL Synchronization
1) Coarse Timing Synchronization: Fig. 3 depicts a model
about the 576-points power sum with the window sliding. We
know the information of TTG + RTG =165 µs in [5], so it
is reasonable to suppose RTG is 45 µs, about 256 sampling
periods, and CP factor is 1/8 in our study. We can also know
the power of PA-Preamble is larger than the common data
symbol because the amplitude of PA-Preamble is boosted
before transmitting [5].
When the MS receives the PA-Preamble signal subject to
delay, multipath propagation, and additive noise, the first task
is to estimate the coarse timing to facilitate later work. Refer
to Fig. 3. We consider summing the signal power in a 576-
point window. With the window sliding, we can decide the
coarse timing as the point with the maximum power sum.
This technique can actually be interpreted as quasi-maximum
likelihood (ML) noncoherent detection of the preamble timing.
According to [1], [2], Figs. 4 and 5 show the results of
power sum with the window sliding in 0 dB of signal-to-
noise ratio (SNR), under the AWGN channel and the SUI-5
channel with mobility 350 km/h. The rayleighchan, a Matlab
function, leads to an initial delay of the generated channel,
even if we set the delay of the direct path zero. Figs. 7 depict
this phenomenon and we must compensate it in [1].
Note that the PA-Preamble timing we get by the above
method has an offset to the real PA-Preamble timing due to
multipath and noise effects. We will handle these problems in
fine timing synchronization.
2) Estimation of Fractional Carrier Frequency Offset: We
attempt an ML estimation of δ from it. It turns out that a
truly ML estimation is quite complex because T576 is not
circulant. However, if the coarse timing lands us in the CP
and if we sacrifice the available signal power in the CP, then
23
The likelihood function of y512 can be written as:
p(y512|δ,H, k) = 1
(2piσ2η)
512
·exp(− 1
2σ2η
‖y512−Γ(δ)·FH ·Dk·H‖2),
(7)
in the likelihood function, there are three unknowns, namely
δ, H and k. The ML estimation is thus given by
arg max
δ,H,k
p(y512|δ,H, k) (8)
= arg min
δ,H,k
‖y512 − Γ(δ) · FH ·Dk ·H‖2 (9)
= argmin
δ,k
min
H|δ,k
‖y512 − Γ(δ) · FH ·Dk ·H‖2 (10)
⇒ argmin
δ,k
‖y512 − Γ(δ) · FH ·Dk ·DHk · F · ΓH(δ) · y512‖2.(11)
Note that (11) arises because the inner minimization of (10)
is achieved with H = DHk ·F ·ΓH(δ) ·y512 as can be obtained
via standard least-square estimation technique. Since Dk ·DHk
is the same whatever for add k, we cannot solve for the optimal
k from (3.14), but must find it through above other means, In
addition, the minimization target in (3.14) is a function of δ
only. Thus it is equivalent to:
argmin
δ
‖y512 − Γ(δ) · FH ·Dk ·DHk · F · ΓH(δ) · y512‖2 (12)
= argmin
δ
‖[I − Γ(δ) · FH ·Dk ·DHk · F · ΓH(δ)] · y512‖2(13)
= argmin
δ
yH512 · [I − Γ(δ) · FH ·Dk ·DHk · F · ΓH(δ)]2 · y512(14)
= argmax
δ
yH512 · Γ(δ) · FH ·Dk ·DHk · F · ΓH(δ) · y512 (15)
= argmax
δ
γH(δ) · [YH · FH ·Dk ·DHk · F ·Y] · γ(δ) (16)
where γ(δ) = [exp(−j · 2pi512 · δ · 0), exp(−j · 2pi512 · δ ·
1), ..., exp(−j · 2pi512 · δ · 511)]
′
, and Y is a diagonal matrix
whose ith diagonal element is the ith element in y512.
Note that sinceDk·DHk is diagonal,W , FH ·Dk·DHk ·F is
a circulant matrix. Indeed, because Dk ·DHk is nearly periodic
(with mostly every other element equal to 1 while others equal
to zero) along the diagonal, W is nearly tri-diagonal and so
is M. The three diagonal sums are given by
M0 =
511∑
i=0
wi,i · |yi,i|2, (17)
M−256 =
511∑
i=256
yHi,i · wi,i−256 · yi−256,i−256, (18)
M256 =
511∑
i=256
yHi−256,i−256 · wi−256,i · yi,i, (19)
where yi,i is the ith diagonal element of Y, and wi,i is the
ith diagonal of W. We utilize the mathematic format of FFT
of these three dominant terms to estimate fractional carrier
frequency (FCFO) by finding the peak value and derive as
δ = − 1pi arctan
ℑ{M256}
ℜ{M256} .
0 100 200 300 400 500 600
0
1
2
3
4
5
6
7
x 105
 Fig. 8. The estimated CIR with accurate ICFO, 8, compensating and correct
PA-Preamble index, 1, under PB channel with 120 km/h, 0dB in SNR.
3) Joint Estimation of Integral CFO, PA-Preamble Index,
Channel Estimation and Fine Timing Offset: CFO is separated
into two parts, FCFO and integral carrier frequency offset
(ICFO), and the former have been estimation in the previous
subsection. We can expect that the power of channel impulse
response (CIR), the inverse fourier transform of H as obtained
in (11), will be more concentrated if we compensate with the
accurate CFO and use the correct one of the three possible PA-
Preamble symbols. For example, Figs. 8 and 9 depict two CIRs
obtained from using a combination of correct CFO and correct
PA-Preamble index and from using a combination of incorrect
values. The simulation environment we choose in Figs. 8 and
9 is PB channel, 120 km/h, 0 dB in SNR, the correct ICFO
8, the correct PID 1 (10-MHz), the wrong ICFO 6, and the
wrong PID 0 (5-MHz). We consider there are 21 possible
ICFO explained in the Eq. (20), 3 PA-Preamble symbols and
256 timing locations in CIR, therefore, 21× 3× 64 = 16128
candidates in total. The method we use here is to do 64 points
sum of squared CIR for these candidates and find out one
which has the maximum of power sum. The reason why we
choose the searching range of ICFO from −20 to 20 is that we
assume a maximum mismatch of the local oscillator frequency
of ±80 ppm, so that a wireless system with carrier frequency
2.5 GHz ±18.28 subcarriers of offset at the 10.9375 kHz
subcarrier spacing of IEEE 802.16m, as given by
2.5G · 80ppm
10.94K
≈ 18.28. (20)
For the fine timing, since it is reasonable to assume that the
CIR is mostly concentrated over a length not exceeding the
CP length, we decide the ICFO, the PA-Preamble index and
the fine timing offset by finding which one of all candidates
has the maximum power sum over the CP length.
4) Overall Block Diagram: In summary, Fig. 10 shows
the resulting overall block diagram of the derived initial DL
synchronization method.
25
550 560 570 580 590 600 610 620 630 640
0
50
100
150
Coarse timing estimation under PB at mobility 10 km/h in 0 dB.
Cu
m
ul
at
ive
 a
m
ou
nt
Estimated timing index
575 580 585 590 595 600
0
50
100
150
200
250
300
350
400
Coarse timing estimation under PB at mobility 10 km/h in 10 dB.
Cu
m
ul
at
ive
 a
m
ou
nt
Estimated timing index
Fig. 12. Histograms of coarse timing estimation under PB channel in different
SNR value for a velocity of km/h.
TABLE II
THE ERROR RATE OF TIMING ESTIMATION.
AWGN PB 10km PB 90km SUI1 10km SUI1 90km
0 dB 0.013 0.113 0.118 0.011 0.021
10 dB 0 0.001 0.005 0 0
20 dB 0 0 0 0 0
• SNR value: 0 dB, 10 dB.
They illustrates the histograms under AWGN and SUI-1
channels at SNR values of 0 and 10dB and velocities 10 and
90 km/h, respectively. Figs. 19 to 20 show the histograms of
PID detection under AWGN and SUI-1 channels at similar
SNR and velocity setting. They show that the ICFO and PID
estimation are quite accurate at different SNR and channel
condition. Figs. 21 illustrates the performance of fine timing
estimation under AWGN, SUI-1 and PB channels in 0 dB,
10 dB, and 20 dB of SNR at speeds 10 km/h and 90 km/h,
respectively. We define “error” is that the estimated timing
index does not locate between the boundary of delay spread
and the right end of CP, then we can calculate the error rate,
show in Table II. The simulation results of overall timing
estimation is similar with reference [1].
540 560 580 600 620 640 660
0
20
40
60
80
100
120
140
160
Coarse timing estimation under PB at mobility 90 km/h in 0 dB.
Cu
m
ul
at
ive
 a
m
ou
nt
Estimated timing index
579 580 581 582 583 584 585 586 587 588 589 590 591 592 593
0
50
100
150
200
250
300
350
400
Coarse timing estimation under PB at mobility 90 km/h in 10 dB.
Cu
m
ul
at
ive
 a
m
ou
nt
Estimated timing index
Fig. 13. Histograms of coarse timing estimation under PB channel in different
SNR value for a velocity of 90 km/h.
2. Fixed-Point Implementation
Usually, we use floating-point processing to verity the
performance of the algorithms. But fixed-point processing
improves power efficiency, speed and hardware cost. Hance
large-volume practical implementation normally employ fixed-
point processing. In this section, we present the initial down-
link synchronization algorithm implementation in fixed-point
processing using TI’s TMS320C6416T DSP. We also try to
utilize coding style and intrinsic functions to reduce cycle
counts on DSP.
Fig. 22 shows the fixed-point data formats used in the
different places in our algorithm, where Qx.y means there
are x bits before the binary points and y bits after. In our
case, x+y = 15 because the sign takes 1 bit. We choose Q7.8
to be the data format at many places, because coarse timing
estimation needs to accumulate the squared norm of data. The
Q7.8 format can avoid overflow in coarse timing estimation.
In fact, we find that the Q7.8 data format has enough accuracy
for our experiment. In the following subsections, we discuss
the details of the blocks in the algorithm.
1) Coarse Timing Estimation and Removal of Cycle Prefix:
The first step in the procedure is coarse timing estimation to
27
−25 −20 −15 −10 −5 0 5 10 15 20 25
0
100
200
300
400
500
600
700
800
900
1000
 
 
Bin Count: 1e+003
Bin Center: 8
Bin Edges: [7.5, 8.5]
ICFO estimated index
Cu
m
ul
at
ive
 a
m
ou
nt
ICFO estimation under AWGN in 0 dB.
−25 −20 −15 −10 −5 0 5 10 15 20 25
0
100
200
300
400
500
600
700
800
900
1000
 
 
Bin Count: 1e+003
Bin Center: 8
Bin Edges: [7.5, 8.5]
ICFO estimated index
Cu
m
ul
at
ive
 a
m
ou
nt
ICFO estimation under AWGN in 10 dB.
Fig. 17. Histograms of integer CFO estimation under AWGN channel in
different SNR values.
10 and 90 km/h, respectively. Note that the simulation results
are almost the same with the floating-point results shown in
Figs. 11 to 13.
2) Fractional CFO Estimation: Figs. 28 to 30 show the
MSE of fractional CFO estimation in SUI-1, SUI-3, PB and
AWGN channels at speeds 10, 30, 60 and 90 km/h with fixed-
point and floating-point computation. From the simulation
results, we can see that the performance curves for floating-
point and fixed-point computation are only a little different.
3) Joint Estimation of Integral Carrier Frequency Offset,
PID and Fine Timing: Figs. 31 shows the estimation perfor-
mance of integer CFO under AWGN channel at SNR of 0
and 10 dB, respectively, and Figs. 32 shows the estimation
performance of PID under AWGN channel at SNR of 0 and
10 dB. Table III shows the error rate of timing estimation.
We can see that floating-point and fixed-point implementation
have the same results shown in Figs. 17 to 32, in all cases
simulated.
4. Speeding Up of DSP Implementation
In this section, we discuss how to reduce cycle counts
in DSP implementation. The optimization techniques used
−25 −20 −15 −10 −5 0 5 10 15 20 25
0
100
200
300
400
500
600
700
800
900
1000
 
 
Bin Count: 1e+003
Bin Center: 8
Bin Edges: [7.5, 8.5]
ICFO estimated index
Cu
m
ul
at
ive
 a
m
ou
nt
ICFO estimation under SUI1 at mobility 90 km/h in 0 dB.
−25 −20 −15 −10 −5 0 5 10 15 20 25
0
100
200
300
400
500
600
700
800
900
1000
 
 
Bin Count: 1e+003
Bin Center: 8
Bin Edges: [7.5, 8.5]
ICFO estimated index
Cu
m
ul
at
ive
 a
m
ou
nt
ICFO estimation under SUI1 at mobility 90 km/h in 10 dB.
Fig. 18. Histograms of integer CFO estimation under SUI-1 channel in
different SNR values at a velocity of 90 km/h.
TABLE III
THE ERROR RATE OF TIMING ESTIMATION.
AWGN PB 10km PB 90km SUI1 10km SUI1 90km
0 dB 0.017 0.121 0.155 0.031 0.025
10 dB 0 0.002 0.001 0 0
20 dB 0 0 0 0 0
include compiler option, intrinsic functions and DSP library
function. We set the level of optimization of compiler option
to -o3, which performs software pipelining and loop optimiza-
tions, and we do not perform loop unrolling ourselves. In the
following, we concentrate the discussion on the use of intrinsic
functions and DSP library functions in the function blocks.
1) Speeding Up of Coarse Timing Estimation: Calculating
the magnitude-square of a complex number needs two mul-
tiplication, so accumulating 576 magnitude-squares for 1152
time position would require 576×2×1152 = 1, 327, 104 mul-
tiplications. However, most of accumulated quantities appear
repeatedly across successive time positions as shown in Fig.
33. Using this fact, we may compute the sum of magnitude-
squares as
Power(N + 1) = Power(N)−R(N) +R(N + 576), (21)
29
TABLE VI
ICFO, PID, FINE TIMING ESTIMATION RESULTS FOR OPTIMIZATION
LEVEL 3
Functions Avg. Clock Cycles
Sum of CIR 75411
CIR Computation 33705
MaxFixed 33453
Others 6042
TABLE VII
ICFO, PID, FINE TIMING ESTIMATION RESULTS FOR OPTIMIZATION
LEVEL 1
Functions Avg. Clock Cycles
Sum of CIR 406602
CIR Computation 326970
MaxFixed 547848
Others 340204
in the frequency domain, hence we need not compute the
CIR the corresponding with PA-Preamble subcarrier is 0.
Furthermore, we use the same method with coarse timing
estimation to calculate the sum of CIR. Therefore, it is needs
216 × 2 × 3 × 21 = 27, 216 multiplications to compute the
CIR and (64×2+256×4)×3×21 = 72, 576 multiplications
to compute the sum of CIR.
According to Table VI, the efficiency of sum of CIR is
(72576 ÷ 4 ÷ 75411) × 100 = 24.1% and the efficiency of
CIR computation is (27216 ÷ 2 ÷ 33705) × 100 = 40.4%.
Table VII shows the cycle counts for compiler option of
optimization level 1, the efficiency of sum of CIR is (72576÷
2 ÷ 406602) × 100 = 8.9%, and the efficiency of CIR
computation is (27216÷ 2÷ 326970)× 100 = 4.16%.
5. DSP Optimization Results
Table VIII shows the number of clock for each function
used in the initial DL synchronization procedures, and number
of clock cycles does not including TI library in this table.
Obviously, IFFT function takes the most percentage of total
cycles, because number of IFFT times is the 21 (ICFO
candidates)×3 (bandwidth) = 63 times, and IFFT function time
positions would require about 14,000 cycles per time. The
DSP fft16x16r() function is already highly optimized.
Table IX shows the number of clock cycles including and
excluding memory access. Table X shows the code size of the
program for different optimization levels. In our system, the
clock frequency of TMS320C6416T DSP is 1 GHz, so the
total execution time of initial DL synchronization procedures
is 1.181 ms.
5. CONCLUSION
In this thesis, we first presented the overall procedure of
initial DL synchronization of the IEEE 802.16m TDD system,
and verified them through floating-point computation. Second,
we implemented the initial DL synchronization to fixed-point
computation and compared the performance with floating-
point computation. Finally, we optimized procedure of initial
DL synchronization on TI’s C6416T digital signal processor.
TABLE VIII
DSP OPTIMIZATION RESULTS
Functions Avg. Clock Cycles Percent Total Cycles
Coarse Timing Estimation 10239 0.96
FCFO Estimation 5911 0.554
Compensation 2141 0.2
FFT 14046 1.318
IFFT 884394 82.963
ICFO Estimation 148611 13.941
Remove CP 668 0.063
Total cycles 1066010 100
TABLE IX
DSP OPTIMIZATION RESULTS WITH INCLUSION AND EXCLUSION OF
MEMORY ACCESS
Total Cycles Avg. Clock Cycles
Exclude Memory Access 1066010
Include Memory Access 1168531
TABLE X
CODE SIZE RESULTS
Program Memory
Optimization Level 3 Program Code Size (-o3) 448.613 KB
Optimization Level 1 Program Code Size (-o1) 439.781 KB
Data Memory Size 327.68KB
In the procedure of initial DL synchronization, we used
coarse timing estimation to estimate the PA-Preamble location,
thus, we obtained the FCFO from the quasi-ML estimation. In
the end, we utilized the characteristic of the power centraliza-
tion of CIR to estimate the ICFO, PID and fine timing offset.
For DSP implementation, we chosen Q7.8 to be our data for-
mat, and verified the performance through simulation results is
close to the floating-point computation. We used optimization
techniques that including preamble character, intrinsic func-
tions and DSP library function to reduce the computation
time. According to Table VIII, if the clock frequency of
TMS320C6416T DSP is 1 GHz, execution time of initial DL
synchronization procedures is 1.181 ms.
REFERENCES
[1] Kai-Wei Lu, “Initial downlink synchronization for IEEE
802.16m,” M.S. thesis, National Chiao Tung University,
Hsinchu, Taiwan, R.O.C., February 2010.
[2] P. S. Wang, K. W. Lu, D. W. Lin, and P. Ting, “Quasi-
maximum likelihood initial downlink synchronization for
IEEE 802.16m,” in Proc. IEEE Int. Workshop Signal
Processing Advanes Wirel. Commun., June 2011, pp. 506–
510.
[3] Man-On Pun, Michele Morelli, and C.-C. Jay Kuo,
“Maximum-likelihood synchronization and channel esti-
mation for OFDMA uplink transmissions,” IEEE Trans.
Commun., vol. 54, no. 4, pp. 726–736, Apr. 2006.
[4] Lior Eldar, M. R. Raghavendra, S. Bhashyam, Ron
Bercovich, and K. Giridhar, “Parametric channel es-
timation for pseudo-random user-allocation in uplink
OFDMA,” in IEEE Int. Conf. Commun., 2006, vol. 7,
pp. 3035–3039.
31
Fig. 22. Fixed-point data formats used in DSP implementation.
Fig. 23. Calculating the correlation in received PA-Preamble.
Fig. 24. ICFO estimation and PID detection flow chart.
540 560 580 600 620 640
0
50
100
150
200
250
Bin Count: 249
Bin Center: 576
Bin Edges: [576, 577]
Coarse timing estimation under AWGN in 0dB with fixed−point implementation.
Cu
m
ul
at
ive
 a
m
ou
nt
Estimated timing index
575 576 577
0
100
200
300
400
500
600
700
800
900
Bin Count: 850
Bin Center: 576
Bin Edges: [576, 577]
Coarse timing estimation under AWGN in 10dB with fixed−point implementation.
Cu
m
ul
at
ive
 a
m
ou
nt
Estimated timing index
Fig. 25. Histograms of coarse timing estimation under AWGN channel in
different SNR values.
33
0 5 10 15 20
10−6
10−5
10−4
10−3
MSE of FCFO Estimation
M
SE
Preamble SNR (dB)
 
 
AWGN
AWGN−Fixed
SUI3 (10 km/h)
SUI3 (60 km/h)
SUI3 (90 km/h)
SUI3−Fixed (10 km/h)
SUI3−Fixed (60 km/h)
SUI3−Fixed (90 km/h)
Fig. 29. Mean square error of FCFO estimation under SUI-3 and AWGN
channels with fixed-point and floating-point computation.
0 5 10 15 20
10−6
10−5
10−4
10−3
MSE of FCFO Estimation
M
SE
Preamble SNR (dB)
 
 AWGN
AWGN−Fixed
PB (10 km/h)
PB (60 km/h)
PB−Fixed (10 km/h)
PB−Fixed (60 km/h)
Fig. 30. Mean square error of FCFO estimation under PB and AWGN
channels with fixed-point and floating-point computation.
−25 −20 −15 −10 −5 0 5 10 15 20 25
0
100
200
300
400
500
600
700
800
900
1000
Bin Count: 1e+003
Bin Center: 8
Bin Edges: [7.5, 8.5]
ICFO estimation under AWGN in 0dB.
Cu
m
ul
at
ive
 a
m
ou
nt
ICFO estimated index
−25 −20 −15 −10 −5 0 5 10 15 20 25
0
100
200
300
400
500
600
700
800
900
1000
Bin Count: 1e+003
Bin Center: 8
Bin Edges: [7.5, 8.5]
ICFO estimation under AWGN in 10dB.
Cu
m
ul
at
ive
 a
m
ou
nt
ICFO estimated index
Fig. 31. Histograms of integer CFO estimation under AWGN channel in
different SNR values with fixed-point implementation.
35
 37
六、IEEE 802.16m通道估計技術之數位訊號處理器軟體實現研究 
本節主要內容自下頁起，以學術論文初稿方式呈現。這些結果係摘自參考文獻[4]。
本項成果係衍伸之前在演算法方面的研究成果[5]。 
 
TABLE I
PRU STRUCTURE FOR DIFFERENT TYPES OF SUBFRAMES
Subframe Type Number of Subcarriers Number of Symbols
Type-1 18 6
Type-2 18 7
Type-3 18 5
from [10].
1) OFDMA Basic Terms: We introduce some basic terms
appeared in the OFDMA physical layer (PHY) of IEEE
802.16m. These definitions help us understand the concepts
of subcarrier allocation and transmission in IEEE 802.16m
OFDMA.
• Physical and logical resource unit: A physical resource
unit (PRU) is the basic physical unit for resource alloca-
tion. It comprises Psc consecutive subcarriers by Nsym
consecutive OFDMA symbols. Psc is 18 subcarriers and
Nsym is 6 OFDMA symbols for type-1 subframes, 7
OFDM symbols for type-2 subframes, and 5 OFDMA
symbols for type-3 subframes. A logical resource unit
(LRU) is the basic logical unit for distributed and lo-
calized resource allocations. An LRU is Psc · Nsym
subcarriers for type-1, type-2, and type-3 subframes. The
LRU includes the pilots that are used in a PRU. The
effective number of subcarriers in an LRU depends on
the number of allocated pilots.
• Distributed resource unit: A distributed resource unit
(DRU) contains a group of subcarriers which are spread
across the distributed resource allocations within a fre-
quency partition. The size of DRU equals the size of
PRU, i.e., Psc subcarriers by Nsym OFDMA symbols.
• Contiguous resource unit: The localized resource unit,
also known as contiguous resource unit (CRU), contains
a group of subcarriers which are contiguous across the
localized resource allocations. The size of CRU equals
the size of PRU, i.e., Psc subcarriers by Nsym OFDMA
symbols.
2) Frame Structure: The advanced air interface basic frame
structure is illustrated in Fig. 1. Each 20 ms superframe is
divided into four 5-ms radio frames. When using the same
OFDMA parameters as in Figs. II and III with channel
bandwidth of 5, 10, or 20 MHz, each 5-ms radio frame further
consists of eight subframes for G = 1/8 and 1/16. With
channel bandwidth of 8.75 or 7 MHz, each 5-ms radio frame
further consists of seven and six subframes, respectively for
G = 1/8 and 1/16. In the case of G = 1/4, the number of
subframes per frame is one less than that of other CP lengths
for each bandwidth case. A subframe shall be assigned for
either downlink (DL) or uplink (UL) transmission. There are
four types of subframes:
• Type-1 subframe consists of six OFDMA symbols.
• Type-2 subframe consists of seven OFDMA symbols.
• Type-3 subframe consists of five OFDMA symbols.
• Type-4 subframe consists of nine OFDMA symbols.
This type shall be applied only to UL subframe for
the 8.75 MHz channel bandwidth when supporting the
WirelessMAN-OFDMA frames.
Fig. 1. Frame structure for 5, 10 and 20 MHz modes (Fig. 484 in [10]).
TABLE II
OFDMA PARAMETERS (TABLE 794 IN [10])
TABLE III
ADDITIONAL OFDMA PARAMETERS (TABLE 795 IN [10])
The basic frame structure is applied to FDD and TDD duplex-
ing schemes, including H-FDD MS operation. The number of
switching points in each radio frame in TDD systems shall
be two, where a switching point is defined as a change of
directionality, i.e., from DL to UL or from UL to DL.
39
Fig. 4. Pilot patterns used for 2 DL data streams (Fig. 506 in [10]).
Fig. 5. PRBS generator for pilot modulation (Figure 584 in [10]).
carriers, on which no pilot or data is transmitted. In this thesis,
we used the pilot structure for 2 DL data streams.
2) Pilot Modulation: Pilot subcarriers are inserted into
each data burst in order to constitute the symbol. The PRBS
(pseudo-random binary sequence) generator depicted in Fig. 5
is used to produce a sequence wk. Each pilot is transmitted
with a boosting of 2.5 dB over the average non-boosted power
of each data tone. The pilot subcarriers is modulated according
to
ℜ{ck} = 8
3
(1
2
− wk
)
, ℑ{ck} = 0. (4)
5. Downlink MIMO Architecture and Data Processing
The architecture of downlink MIMO at the transmitter side
is shown in Figure 6. The MIMO encoder block maps L
MIMO layer (L ≥ 1) onto Mt MIMO streams (Mt ≥ L),
which are fed to the precoder block. A MIMO layer is an in-
formation path fed to the MIMO encoder as an input. A MIMO
layer represents one channel coding block. For the spatial
multiplexing modes in single-user MIMO (SU-MIMO),“rank”
is defined as the number of MIMO streams to be used for
the user allocated to the Resource Unit (RU). For SU-MIMO,
Fig. 6. DL MIMO (Figure 547 in [10]).
only one user is scheduled in one RU, and only one channel
coding block exists at the input of the MIMO encoder (vertical
MIMO encoding at transmit side). For MU-MIMO, multiple
users can be scheduled in one RU, and multiple channel coding
blocks exist at the input of the MIMO encoder. The existence
of multiple channel coding blocks at the input of the MIMO
encoder can be caused by either using horizontal encoding
or by using vertical encoding in several MIMO layers or
by using a combination of vertical and horizontal encoding
in several MIMO layers at the transmit side. Using multiple
MIMO layers is called multi-layer encoding.
6. MIMO Layer to MIMO Stream Mapping
MIMO layer to MIMO stream mapping is performed by
the MIMO encoder. The MIMO encoder is a batch processor
that operates on M input symbols at a time. The input to the
MIMO encoder is represent by an M × 1 vector as
s =

s1
s2
...
sM
 (5)
where si is the ith input symbol within a batch. In case of
MU-MIMO transmissions, the M symbols belong to different
MSs. Two consecutive symbols may belong to a single MIMO
layer. One MS shall have at most one MIMO layer.
MIMO layer to MIMO stream mapping of the input symbols
is done in the space dimension first. The output of the MIMO
encoder is an Mt ×NF MIMO STC matrix as
X = S(s) (6)
where
• Mt is the number of MIMO streams,
• NF is the number of subcarriers occupied by one MIMO
block,
• X is the output of the MIMO encoder,
• s is the input MIMO layer vector,
• S() is a function that maps an input MIMO layer vector
to an STC matrix, and
• S(s) is an STC matrix.
The STC matrix X can be expressed as
X =

x1,1 x1,2 ... x1,NF
x2,1 x2,2 ... x2,NF
... ... ... ...
xMt,1 xMt,2 ... xMt,NF .
 . (7)
41
Fig. 8. Linear interpolation.
3. LMMSE Channel Estimation
We have given a brief introduction to the method in chapter
1. Now we describe it in more detail. The material in this
section is mainly taken from [1], [2].
1) Channel Modeling for Channel Estimation: Consider a
discrete-time equivalent lowpass channel impulse response
h(n) =
L−1∑
l=0
αlδ(n− l) (20)
where n and l are integers in units of the sampling period Ts
and αl is the complex gain of path l. The mean delay and the
RMS delay spread are given by, respectively,
τµ =
∑L−1
l=0 E(|αl|2)l∑L−1
l=0 E(|αl|2)
(21)
and
τrms =
√√√√∑L−1l=0 E(|αl|2)(l − τµ)2∑L−1
l=0 E(|αl|2)
. (22)
One question here is how the expectation E(|αl|2) should be
defined. As our purpose is channel estimation, suppose one
channel estimation is performed for K OFDM symbols. Then
the expectation should be an average that is taken over these
symbol, note that we may let k = 1. In addition, we assume
that the channel estimator input contains no carrier frequency
error, but the PDP can have a nonzero initial delay τ0, although
conventional definition of the PDP usually zero out the initial
path delays.
Fourier transforming the PDP gives the corresponding fre-
quency autocorrelation function. For an exponential PDP with
initial delay τ0, we have
Rf (k)
Rf (0)
=
e−j2piτ0k/N
1 + j2piτrmsk/N
(23)
where τ0 = τµ − τrms and N is the DFT size used in the
multicarrier system. For a uniform PDP of width T with a
initial delay τ0,
Rf (k)
Rf (0)
=
e−j2piτ0k/N sin(piTk/N)
piTk/N
(24)
where τµ = τ0 + T/2 and T =
√
12τrms.
2) Estimation of Channel Delay Parameters: The fre-
quency response of the channel in (20) is given by
H(f) =
L−1∑
l=0
αle
−j2pilf/N (25)
where the division by N in the exponent normalizes the period
of H(f) in f to N . If we advance the channel response by τ
(arbitrary) time units, then the frequency response becomes
Ha(f) = e
j2piτf/NH(f) =
L−1∑
l=0
αle
−j2pi(l−τ)f/N . (26)
Differentiating Ha(f) with respect to f , we get
dHa(f)
df
=
−j2pi
N
L−1∑
l=0
αl(l − τ)e−j2pi(l−τ)f/N . (27)
Applying Parsevals theorem, we get
J(τ) ,
〈
|dHa(f)
df
|2
〉
=
4pi2
N2
L−1∑
l=0
|αl|2(l − τ)2 (28)
where < · > denotes frequency averaging. Hence
J(τ) , E(
〈
|dHa(f)
df
|2
〉
) =
4pi2
N2
L−1∑
l=0
E((|αl|2)(l − τ)2).
(29)
The above equations show that J(τ) is minimized when τ =
τµ. In addition,
τ2rms =
N2min J(τ)
4pi2
∑L−1
l=0 E(|αl|2)
. (30)
For pilot-transmitting OFDM systems, the below given a way
to find τµ and τrms from the frequency domain channel
estimate.
Consider a system where one out of every Fs subcarriers
is a pilot. We can approximate dHa(f)/df by the first-order
difference, [Ha(f + Fs) − Ha(f)]/Fs and substitute it into
(29). Then, we obtain
J(τ) ≈ 1
F 2s
E
〈
|ejφH(f + Fs)−H(f)|2
〉
p
(31)
where φ = 2piτFs/N , f takes values only over pilot frequen-
cies, and < · >p denotes averaging over pilot subcarriers.
Then we modify the approximation by taking circular differ-
encing over f rather than linear differencing. Therefore, we
approximate J(τ) by
J(τ) ≈ 1
F 2s
E|
〈
|ejφH ((f + Fs)%N) −H(f)|2
〉
p
(32)
where % denotes modulo operation, and we have assumed
that (f + Fs)%N is a pilot subcarrier. Now let Ri be
the (instantaneous) frequency-domain autocorrelation of the
channel response:
Ri =
〈
H((f + iFs) %N)H
∗(f)
〉
p
. (33)
Then from (32) we have
J(τ) ≈ 2
F 2s
[E(R0 −R{ejφE(R1)})]. (34)
Then (34) gives an approximation of J(τ) defined in (29).
According to (34), τµ and τrms can be estimated in the
following way:
1) estimate the channel responses at the pilot subcarriers,
43
Fig. 10. Mixed method.
1. Nonlinear Function Implementation
In our implementation, we will need to carry out the compu-
tation of some function that are implemented the math library
of C as subroutines. These subroutines may take many CPU
cycles to execute. We can use some technique to avoid calling
these subroutines and save cycles. We discuss the techniques
below. Specially, the functions that we are interested in are
sqrt(), sin(), cos(), and arctan().
1) Table Look-Up Method: A simplest method to imple-
ment a mathematical function is to use a look-up table. First,
we build a table which contain the desired number of output
values for the function. Then, we only need to enter the proper
input index to get the answer from the table. But table size
determines the needed memory space. If we want to have
more output precision, then a larger table needs to be limit.
Therefore, we have to know what range of input and output
values that we need. When know there ranges, we can prevent
wasting of unnecessary table space. Table look-up offer a
simple method to replace calling library, but its precision
depends on the table size. If the memory size is very limited,
then it may not have enough space to store a table with the
desired precision.
2) Mixed Method [14]: Mixed method is a trade off
between table look-up and computation, which is based on
table look-up but calculates the output value further by linear
interpolation as shown in Figure 10. First, we have to build
two tables of reduced size compared to the full-precision table,
one is to record the function outputs and the other to record
the slopes between pairs of input values. See Figure 10. If we
want to know the corresponding output of X , we can get the
answer by calculating the distance between X and X1 and the
slope between X1 and X2. Adopting this technique, we can
use a little computation to exchange for more precision.
2. Q-Scaling Flow Chart
Figure 11 shows the flow chart of the channel estimation
procedure together with the scaling factors of key variables.
The channel estimation method has been introduced in chapter
4. The scaling factor have been designed based on theoretical
analysis and they are determined so that a highest possible
computational accuracy can be maintained without overflow.
1
0
| |1 (1 )
32
RRmstemp
R
= −
Fig. 11. Q-scaling flow chart for LMMSE channel estimation.
3. DIV fixed Function Analysis
For fixed-point DSP implementation, we should try to avoid
divisions. This is because the DSP does not have a hardware
divide but call a library subroutine to carry out the division,
which cost quite a few CPU cycles. If one wants to calculate
x/y for some y many times, it is advisable to calculate the
reciprocal of the divisor and record it first. Them we can
calculate x/y for any x. This can reduce a large amount of
cycles. In this work, we use divisions in several place which
can reference to Fig.11: 1 division to calculate Rmstemp, 1
division for arctangent function to calculate angle, 17 divisions
to calculate the correlation function, 4 divisions for Levinson-
Durbin parameter calculation and 6 divisions for each data
response calculation, totalling to 1+ 1+17+ 4+6× 15(data
subcarrier number) = 113 divisions in theory for each OFDMA
symbols.
But sometimes to calculate the reciprocal of the divisor
would incur two problems. First is about overflow. For ex-
ample, suppose we want to calculate 1/y and scale to Q13
and y uses Q14 scaling. Then
k =
1
y
⇒ (Q13)(k) = (Q27)1
(Q14)y
=
227
Y
,
range of Y : 1 to 215 (assume Y is positive),
range of K : 212 to 227.
As for range ofK, we have to use integer type for recordK.
If we want to reuse that, for example Z/Y = Z×K (however
Z is short or integer type), we have to readjust the K scaling
to avoid overflow. The second problem is about precision. For
example, if we want to calculate 1/y and y is scaling to Q28,
we can only get Q4 (assume y is positive) precision for result
of 1/y at most. To avoid overflow and promote the precision
of 1/y, we design a subfunction which named DIV−fixed.
Figure 12 shows the structure of that. Left branch can solve
overflow problem and right branch can promote the precision
of 1/y.
45
TABLE V
PILOT INTERPOLATION CLOCK CYCLES COMPARISON
Symbol Type Excl. Total cycle
Original Loop 485433
Modified Loop 113784
Fig. 15. C code for pilot channel response interpolation before modification.
Fig. 16. C code for pilot channel response interpolation after modification.
PRU × multiplications = 28×11×48×4 = 59136. Efficiency
is 59136/113784 = 52%. The efficiency has exceeded fifty
percent, the performance looks better.
7. Calculation of R0 and R1
After we calculate channel response for all pilots, we
do LMMSE channel estimation for the data positions. First
we should calculate the autocorrelation values R0 and R1.
Because R0 and R1 are used in subsequent computation, their
precision is very important. So we let them be Q15 to have
maximum fractional bits allowed in 16-bit fixed-point format.
8. Rmstemp and Angle Calculation
We use the R0 and R1 to calculate mean delay and RMS
delay spread which are combination by Rmstemp and the angle
of R1. Rmstemp is given by
Rmstemp =
√
1
32
× (1− |R1|
R0
)
Fig. 17. Correlation function shapes in the time domain and the frequency
domain.
which is a reduced parameter and which has positive propor-
tional with RMS delay spread. The fixed-point implementation
methods to calculate Rmstemp and angle has been discussed
in sections 4.1.2.
9. Correlation Function Calculate
When we have the Rmstemp and the angle, we can use
them to calculate the correlation function in the frequency
domain. But in fixed-point implementation, because of nu-
merical errors, some results may violate the physical meaning.
Figure 17 illustrates its shapes in time and frequency. From
the left plot, we see that the amplitude of RH[0] = R0 is its
maximum value in the frequency domain. So we set a limit as
follows: if |RH[i]|2 > |RH[i− 1]|2, then let RH real[i] =
RH real[i − 1] and RH imag[i] = RH imag[i − 1], for
1 ≤ i ≤ 17.
10. Wiener Coefficients Calculation
We use the correlation function to calculate the autocorrela-
tion Rpp and the crosscorrelation rdp. As for the Wiener filter
coefficients, we need to calculate the inverse matrix of Rpp.
We consider three methods: Gauss elimination, the direct for-
mula method, and the Levinson-Durbin method. Recall that the
Wiener filter coefficients as given by wd = (Rpp+σ2nI)
−1rdp,
where by the 16m signal structure, (Rpp + σ2nI) is a 3 × 3
matrix given by
R , Rpp + σ2nI =
RH[0] + σ2n RH[8] RH[16]RH[8]∗ RH[0] + σ2n RH[8]
RH[16]∗ RH[8]∗ RH[0] + σ2n

=
R0 R8 R16R∗8 R0 R8
R∗16 R
∗
8 R0
 .
1) Gauss Elimination: Figure 18 shows the process of
Gauss elimination. BecauseR is a covariance matrix, it inverse
has a Hermitian structure. For this reason, we only need to do
the elimination six times to get the whole inverse matrix. But
in this process, we can not control the numerical ranges of
the values, so it is hard to give these values a proper scaling.
After we complete the process, we may lose a large amount
of precision in the process. So we also consider other methods
to have better control over the scaling of values.
47
22 21 2
2
2
22 21 2
2
2
22 21
2
2
( Re{ (2) ( (0)) ( (1))} )
{
Re{ } 32767;( 15)
Im{ } 0;
}
(Im{ (2) ( (0)) ( (1))} )
{
Im{ } 32767;
Re{ } 0;
}
{
(2) ( (0)) ( (1))
}
if p a p a p P
c Q
c
else if p a p a p P
c
c
else
p a p a p
c
P
− × − × >
=
=
− × − × >
=
=
− × − ×
=
1
* * 2
1 1
† 2 2 *
1 1 1 1
2 2 4
1 1 1 1
†
2
1 1 0
( 0 )
{
1 ( )
1 || || || ||
9 (0) ( ) || || || ||
}
{
(1 | | )
}
if P
k k
R k k k k
r
k k k k
W R p
else
P k P
==
 
 
= ×
 
 ×
 
= ×
= − ×
*
11 1 11
21
21
*
11 1 11
21
21
*
21 11 1 11
( Re{ } 32767)
{
Re{ } 32767;( 15)
Im{ } 0;
}
(Im{ } 32767)
{
Im{ } 32767;
Re{ } 0;
}
{
}
if a k a
a Q
a
else if a k a
a
a
else
a a k a
− × >
=
=
− × >
=
=
= − ×
11 1
1
1
11 1
1
1
11
1
1
( Re{ (1) (0)} )
{
Re{ } 32767;( 15)
Im{ } 0;
}
(Im{ (1) (0)} )
{
Im{ } 32767;
Re{ } 0;
}
{
(1) (0)
}
if p a p P
c Q
c
else if p a p P
c
c
else
p a p
c
P
− × >
=
=
− × >
=
=
− ×
=
* *
11 1
2
2
* *
11 1
2
2
* *
11
2
1
( Re{ (2) (1)} )
{
Re{ } 32767;( 15)
Im{ } 0;
}
(Im{ (2) (1)} )
{
Im{ } 32767;
Re{ } 0;
}
{
(2) (1)
}
if r a r P
k Q
k
else if r a r P
k
k
else
r a rk
P
− × >
=
=
− × >
=
=
− ×
=
Fig. 21. Necessary precautions to maintain stability on fixed-point imple-
mentation for Levinson-Durbin method.
R =
RH[0] + σ21 + σ22 RH[8] RH[16]RH[8]∗ RH[0] + σ21 + σ22 RH[8]
RH[16]∗ RH[8]∗ RH[0] + σ21 + σ
2
2

=
RH[0] + σ2n RH[8] RH[16]RH[8]∗ RH[0] + σ2n RH[8]
RH[16]∗ RH[8]∗ RH[0] + σ2n
 .
This way of lower-boundary the noise variance, however, leads
to an error floor in the channel estimation performance. In
our experiments, for the downlink system, a lower bound
of σ2n = (Q16)7000 (SNR ≈ 9.714) dB would get the
better performance. For uplink system, a lower bound of
σ2n = (Q16)9000 (SNR ≈ 8.622) dB is better.
At last we offer a possible solution for error floor. We
can maintain the original noise variance in matrix R but
compensate a little noise variance on c0 and k1, where c0 and
k1 are parameters in Levinson-Durbin method and which has
discussed in Section 4.10.3. By reducing the amount of noise
variance compensation mights be possible to let error floor
slightly, but we do not validate the performance are there on
this way, maybe which can implement in future work.
11. Data Channel Response Calculate
After we get the Wiener filter coefficients, we use them
to calculate the data subcarrier channel responses. For opti-
mization, Figure 22 shows the original code. We can employ
the method used in Section 4.5 to replace the PilotPosition.
Another optimization is replacing the pointer. Because we save
the Wiener filter coefficients in an array, when we call them
Fig. 22. C code for data subcarrier response calculation before modification.
Fig. 23. C code for data subcarrier response calculation after modification.
for multiplications, we have to use an array pointer to obtain
their values, which result in multilevel data loading and cost
large amount of cycles. So we first place the Wiener filter
coefficients into temporary registers as shown in Figure 23 and
use the temporary registers for multiplication. Table VI shows
the cycles and efficiency evaluation of all the modifications for
data subcarrier response calculation, the field names Rounding
means we consider the rounding effect in our program, we can
see it would increase additional cycles. The average efficiency
for fifteen data subcarrier can be calculated by : Symbols ×
SNR × PRU × multiplications = 28× 11× 48× 6 = 88704.
Efficiency is 88704/143896.8 = 61.64%. We can see good
performance from the result.
12. Summary
According to the above discussion, we reduce the total clock
cycle time and code size successfully. Finally, DSP C6000
compiler compile our C code and packages to a out file,
which size is 273 KB. Table VII shows the clock cycles for
all C code functions. Incl.Total cycle means total number of
cycles for all executions including function calls. Subfunc-
tion channel estimation fixed includes all the functions
described in Figure 11. And subfunction interpolation in-
cludes all the function described in Figure 11 except pilot
subcarrier channel estimation. Subfunction main deals with
SNR and symbol number setting. ParameterTable record
the pilot value. Because of we do not write all the C code
49
TABLE IX
OFDMA DOWNLINK PARAMETERS
Parameters Values
Bandwidth 10 MHz
Central frequency 3.5 GHz
Nused 865
Sampling factor n 28/25
G 1/8
NFFT 1024
Sampling frequency 11.2 MHz
Subcarrier spacing 10.94 kHz
Useful symbol time 91.43 µs
CP time 11.43 µs
OFDMA symbol time 102.86 µs
Sampling time 44.65 ns
TABLE X
PROFILES OF SUI-2 AND SUI-5 CHANNELS [13]
error floor phenomenon is not obviously for MSE in AWGN
channel.
3. SISO Transmission Results
We conduct simulation with the six SUI channels to examine
the channel estimation performance. Figure 25 and Figure 26
shows the simulation results in SUI-2 channel and SUI-5
channel, respectively. In our result, because of the precise
problem, the MSE performance of channel estimation different
velocities become hardly distinguishably. When SNR small,
the MSE curve for fixed-point is very close to floating-point,
but if the SNR value is bigger than 12 dB, because we
set a lower bound to avoid singular, the error floor would
occurrence.
0 5 10 15 20 25 30
10−4
10−3
10−2
10−1
100
DSP Implementation  for IEEE 802.16m Downlink Channel Estimation in AWGN
Es/N0(dB)
M
SE
 
 
Floating point
Fixed point
0 5 10 15 20 25 30
10−5
10−4
10−3
10−2
10−1
100
DSP Implementation  for IEEE 802.16m Downlink Channel Estimation in AWGN
Es/N0(dB)
SE
R
 
 
Floating point
Fixed point
Theory
Fig. 24. Fixed-point channel estimation MSE and SER for QPSK in AWGN
for IEEE 802.16m downlink.
4. SFBC Transmission Results
SFBC is a technique that uses multiple antennas to achieve
better diversity effect. Figure 28 and Figure 29 shows the
simulation results in SUI-2 channel and SUI-5 channel, re-
spectively. In our simulation, we use two transmit antennas and
one receive antenna. We estimate the two channel responses
separately. So the MSE performance is not different by using
SFBC as compared to SISO, but the SER performance is
better. To check with our results, the fixed-point MSE curve
is very close to floating point and which has similar SER
performance to floating-point in AWGN channel.
6. CONCLUSION
In this thesis, first half of that we discussed about the
LMMSE channel estimation method for OFDMA downlink
and uplink for IEEE 802.16m. We summarize the process to
following steps:
• First, use least-square method on pilot position to get
each pilot response.
• Second, do linear interpolation in time to get all the pilot
response and related equivalent to true pilot position and
there referred to as pilot positions..
• Third, use pilot response to calculate mean delay and rms
delay.
• Fourth, use above two parameters to calculate correlation
function
• Fifth, use correlation function to calculate Wiener filter
coefficient.
51
0 5 10 15 20 25 30
10−4
10−3
10−2
10−1
100
DSP Implementation for IEEE 802.16m Downlink Channel Estimation in SUI−5 with SFBC
Es/N0(dB)
M
SE
 
 
v=30 with Antenna 1 (Fixed−point)
v=30 with Antenna 2 (Fixed−point)
v=30 with Antenna 1 (Floating−point)
v=30 with Antenna 2 (Floating−point)
v=60 with Antenna 1 (Fixed−point)
v=60 with Antenna 2 (Fixed−point)
v=60 with Antenna 1 (Floating−point)
v=60 with Antenna 2 (Floating−point)
v=90 with Antenna 1 (Fixed−point)
v=90 with Antenna 2 (Fixed−point)
v=90 with Antenna 1 (Floating−point)
v=90 with Antenna 2 (Floating−point)
0 5 10 15 20 25 30
10−2
10−1
100
DSP Implementation for IEEE 802.16m Downlink Channel Estimation in SUI−5 with SFBC
Es/N0(dB)
SE
R
 
 
v=30 (Floating−point)
v=60 (Floating−point)
v=90 (Floating−point)
v=30 (Fixed−point)
v=60 (Fixed−point)
v=90 (Fixed−point)
Fig. 29. Fixed-point channel estimation MSE and SER for QPSK with SFBC
at different velocities in SUI-5 channel for IEEE 802.16m downlink, where
the speed v is km/h.
• Sixth, calculate data response by Wiener filter calculation.
and we extended to multiple antennas with SFBC technique,
we validation with C code simulation and compared the result
with different channel types.
The last half of thesis we discussed about fixed-point
implementation on DSP chip. We integrated the contents to
following items:
• We analysis the advantages and defects of fixed-point and
floating-point calculation.
• Discussed the importance of scaling factor and propose
two different scaling expression for reference.
• The knack of nonlinear function implementation and
summarized four steps for fixed-point implementation
pre-work.
• We designed a division subfunction to prevent overflow
operation and maintain the precision.
• Along the channel estimation process to analysis and
optimized the C code.
REFERENCES
[1] Chih-Wei Wang, “LMMSE channel estimation for IEEE 802.16e and
802.16m OFDMA DownLink,” M.S. thesis, Department of Electronics
Engineering and Institute of Electronics, National Chiao Tung Univer-
sity, Hsinchu, Taiwan, R.O.C., June 2009.
[2] K.-C. Hung and D. W. Lin, “Pilot-based LMMSE channel estimation for
OFDM systems with power-delay profile approximation,” IEEE Trans.
Veh. Technology, vol. 59, no. 1, pp. 150–159, Jan. 2010
[3] H. Stark and J. W. Woods, Probability and Random Processes, 3rd ed.
Upper Saddle River, NJ: Prentice-Hall, 2002.
[4] P. Hoeher, S. Kaiser, and P. Robertson, “Two-dimensional pilot-symbol-
aided channel estimation by Wiener filtering,” in Proc. IEEE Int. Conf
Acoust. Speech Signal Processing, vol. 3, 1997, pp. 1845–1848.
[5] O. Edfors, M. Sandell, J.-J. van de Beek, S. K. Wilson, and P. O. Bor-
jesson, “OFDM channel estimation by singular value decomposition,”
IEEE Trans. Commun., vol. 46, no. 7, pp. 931–939, July 1998.
[6] R. van Nee and R. Prasad, OFDM for Wireless Multimedia Communi-
cations. Boston: Artech House, 2000.
[7] L. Wilhelmsson, B. Bernhardsson, and L. Anderson, “Channel estima-
tion by adaptive interpolation,” U.S. patent 7,433,433, Oct. 7, 2008.
[8] Man-On Pun, Michele Morelli, and C.-C. Jay Kuo, “Maximum-
likelihood synchronization and channel estimation for OFDMA uplink
transmissions,” IEEE Trans. Commun., vol. 54, no. 4, pp. 726–736, Apr.
2006.
[9] Lior Eldar, M. R. Raghavendra, S. Bhashyam, Ron Bercovich, and
K. Giridhar, “Parametric channel estimation for pseudo-random user-
allocation in uplink OFDMA,” in IEEE Int. Conf. Commun., vol. 7,
2006, pp. 3035–3039.
[10] IEEE 802.16 Task Group m, Part 16: Air Interface for Broadband
Wireless Access Systems — Advanced Air Interface (working document).
Doc. no. IEEE 802.16m/D9, October 6, 2010.
[11] M.-H. Hsieh, “Synchronization and channel estimation techniques for
OFDM systems, ”Ph.D. dissertation, Department of Electronics Engi-
neering and Institute of Electronics, National Chiao Tung University,
Hsinchu, Taiwan, R.O.C., May 1998.
[12] S. Coleri, M. Ergen, A. Puri, and A. Bahai, “Channel estimation
techniques based on pilot arrangement in OFDM systems,” IEEE Trans.
Broadcasting, vol. 48, no. 3, pp. 223–229, Sep. 2002.
[13] V. Erceg et al., “Channel models for fixed wireless applications,” IEEE
standards contribution no. IEEE 802.16.3c-01/29r4, July 2001.
[14] Hsiung Wei Chang, Liang Chen and Kuang Hui Hsu, DSP Chip:
Fundamental and Application. (In chinese) Wu Nan, 2004.
[15] B. Farhang-Boroueny, Adaptive Filters: Theory and Applications. Wiley,
1998.
53
 55
八、計畫成果自評 
研究內容與原計畫相符程度：符合計畫方向，即第四代行動通訊技術之研究。本年
度達成之成果包括：雙向中繼技術之研發、IEEE 802.16m 上行測距技術研發、IEEE 
802.16m多輸出入傳收技術研究、IEEE 802.16m初始下行同步技術之數位訊號處理器
軟體實現、以及 IEEE 802.16m通道估計技術之數位訊號處理器軟體實現等。(補充說
明：本計畫為一個二年期計畫之第二年。上一年度的研究成果包括：對 IEEE 802.16m
規範的進一步了解，對寬頻單輸出入及多輸出入無線通道特性、計算軟體、與模擬方
式之進一步探討，OFDM傳送端峰均功率比控制方法與效能之探討，中繼前送技術之
研發與分析，分散式中繼系統功率分配方法之研究與效能分析，測距機制之初步設計，
以及載波間干擾削減機制之設計與分析，等。兩年度之研究內容中，部份子題有區隔，
另外部份則係連續。本年度部份成果係基於上年度之初步研究作進一步之研究而得。) 
達成預期目標情況：本計畫達成之貢獻形式，含創新之發現、理論之推導、技術水
準之提升、實驗系統之擴充、人才培育(多位碩博士生參與研究)。 
成果之學術與應用價值等： 
1. 學術價值方面：本計畫獲得若干創新之見，除形成學生學位論文之基礎外，並
陸續投稿國際學術會議與期刊中。 
2. 應用價值方面：以上成果皆可供相關產研界參考。我們也已本於歷年來在相關
領域的研究成果，與國內研發機構進行技術研發與國際標準等方面的合作。此
外，我們亦已將部份成果向國內外申請專利。 
綜合評估：本計畫獲得不少具有學術與應用價值的成果，並達人才培育之效。成效
良好。 
 
 2 
一、參加會議經過 
IEEE個人、室內、暨行動無線通訊國際研討會(IEEE International Symposium on Personal, 
Indoor, and Mobile Radio Communications，簡稱 PIMRC)本年係第 21 屆。記得此一會議於十多
年前曾在台北舉辦一次，這次則是在土耳其伊斯坦堡。我此次參加該會議，係為發表本系所
桑梓賢教授與本人共同指導之博士生吳俊榮與我們二人合著之論文“Design of Distributed 
Amplify-and-Forward Relay Network for MIMO Transmission”。 
本次 PIMRC 係於 2010 年 9 月 26 日(週日)至 9 月 29 日(週三)舉行，主會期在週一至週
三，前一天(週日)有幾場 tutorials和 workshops。因為這些 tutorials和 workshops 需要另外繳費，
故我沒有參加，但到會場去看了一下，其間巧遇大會主席 Prof. Hikmet Sari，談了一會，主要
是關於此次會議的一些細節以及法國 Supelec 與交大合作的事。我於多年前結識 Prof. Sari，
當時他在工業界工作。他於近年來轉任法國 Supelec研究所 Advanced Wireless Communications 
Systems (AWCS) program 的主管。該校最近和本校(交大)簽約合作，本校亦有少數研究生開始
赴該校就學。我這次之所以會投稿此一會議，也是因為 Prof. Sari 去年十月來訪交大時，談到
他擔任此一會議的主席，並邀我們投稿之故。 
我參加了主會期的研討會，其中技術論文發表的部份共分 93個一般 technical sessions及
6個 special sessions，每個 session長度為 90或 110分鐘，視其中發表 5篇或 6篇論文而定，
總共發表約 500篇論文。不過主辦單位似乎沒有公布投稿篇數與論文接受率。除論文場次外，
本會議還有 4個 keynote speeches以及 9個 panel sessions。四個 keynote speeches分在兩個 1.5
小時長的依序發表，為數共 108的 technical sessions、special sessions、和 panel sessions 則分
為 10個時段，各安排 9至 11個平行場次同步進行。 
伊斯坦堡人口千餘萬，是土耳其第一大城。(第二大城是首都安卡拉，第三是旅遊中心
Izmir。)伊城是歷史名城，不過我國航空公司均沒有飛航。由桃園機場來回伊城，往往需要中
停兩次。我此次去程飛機的航線是桃園、新加坡、杜拜、伊斯坦堡，回程經過相反路徑。其
中在杜拜雖有上下客，但其他乘客須留在機上進行安檢，不能下機，這和我過去搭機的經驗
不同。伊城夏令時間與台灣差五小時。本次去程啟航時間是下午六時餘，在次日上午七時餘
抵達伊城，也就是台灣時間過午，航程共費時十八小時左右。約於上午九時抵達旅館，但因
尚未有清理好的空房，故不能提早入住，須等到過午。回程啟航時間在伊城時間下午一時半，
即台灣時間下午六時半，於次日下午約一時半抵台，航程共費時約十九小時。 
這是我第一次去伊斯坦堡。印象深刻的一件事是當地開車速度飛快，如拼命三郎。此外，
進入旅館或會場均須經過安檢，顯然是防避恐怖攻擊的措施。會場設施摩登，但有的會議室
日照較強，空調顯得不足，或許是設計建造上的疏忽。 
二、與會心得 
三天的主會期中，前兩天各有兩個 keynote speeches，各分在一個 1.5 小時的場次中依序
發表。第一個 keynote 係由 Turkcell 的 CEO Mr. Sureyya Ciliv先生主講，講題為Making An 
Impact Through Technology。Turkcell 是土耳其第一大的行動電話公司，除土耳其本國外，營
運範圍另還涵蓋中東地區和前蘇聯的八個國家。它亦是歐洲第三大行動電話公司，共有訂戶
 4 
802.16m(這也難怪，因為他是 IEEE 802.16 Working Group的 ITU-R Liaison Group Chair)，其
他人都著重 LTE。兩者氣勢上的差異，或許由此可見。可惜的是，兩場 panel sessions 的演講
內容似乎都偏重概念性的介紹，缺少深入的量化數據呈現與分析或是深入的技術評析，不免
令我有點遺憾。 
三、考察參觀活動：無 
四、建議：無 
五、攜回資料名稱及內容 
會議議程(紙本)一冊，論文集(光碟)一張。 
 

Design of Distributed Amplify-and-Forward Relay
Network for MIMO Transmission
Chun-Jung Wu, David W. Lin, and Tzu-Hsien Sang
Department of Electronics Engineering and Institute of Electronics
National Chiao Tung University, Hsinchu, Taiwan 30010, ROC
E-mails: cjwu.ee91g@nctu.edu.tw, dwlin@mail.nctu.edu.tw, tzuhsien54120@faculty.nctu.edu.tw
Abstract—We consider the design of a multi-input multi-output
(MIMO) transmission system equipped with distributed, single-
antenna amplify-and-forward relays. In particular, we consider
how to optimize the complex forwarding coefficients of the
relays to maximize the system capacity. Existing studies on
MIMO relay network designs mostly concentrate on the case
of single relay with multiple antennas, whose results are not
applicable to distributed networks. We first analyze how the
system capacity relates to the relay transmission powers and
the channel coefficients. An upper bound on the asymptotic
capacity at high relay powers is derived. Aided by the capacity
results, we consider the optimization of relay coefficients under
two noise conditions: that where the destination noise dominates
the total noise and that where the relay noise dominates the
total noise. It turns out that no simple analytic solutions can
be found for all relay network sizes. Therefore, we propose
suboptimal solutions that involve computation of optimal relay
coefficients with optimal selection of relays for network sizes
that can be solved analytically. The results on diversity order are
found to show resemblance to that for single-hop MIMO systems
employing antenna selection. Simulation results also verify the
superior performance of the proposed technique.
I. INTRODUCTION
There is a recent surge in studies of relay-aided multi-
input multi-output (MIMO) transmission due to its potentials
in answering to the ever-rising quest for higher mobile data
speed. The primary uses of relays, as envisioned by many,
are to enhance coverage and capacity. To preserve the degree
of freedom available in a MIMO system, in such relay-aided
MIMO transmission it is natural to consider using a relay with
multiple antennas or using a relay network.
For the case of single relay equipped with multiple antennas,
both single-input single-output (SISO) [1] and MIMO [2],
[3] end-to-end transmissions have been considered. To fully
exploit the advantage that may be offered by the relay, suitable
beamforming over the multiple relay antennas is needed for
both the backward and the forward MIMO channels. One
disadvantage of the single-relay architecture is its lack of
spatial or system diversity. When the single relay is in an
outage condition due to fading or other reasons, the relaying
link breaks. A reasonable alternative, therefore, is to employ
geographically scattered multiple single-antenna relays for
This study was conducted under the Wireless Broadband Communications
Technology and Application Project of the Institute for Information Industry,
which has been subsidized by the Ministry of Economic Affairs of the
Republic of China, and under Grant NSC 98-2219-E-009-012 of the National
Science Council of the Republic of China.
better diversity. However, the advantage in diversity comes
at the cost of greater difficulty in beamforming compared to
using a single multi-antenna relay, as subsequent discussion
will further demonstrate.
For the case of multiple single-antenna relays, i.e., the
case of a distributed single-antenna relay network, the most
straightforward design conceivable of the relay gains (i.e.,
relay coefficients) is to assign identical gains to all relays
subject to some power limit. This has been termed the all-pass
scheme [4]. Some have studied the ergodic characteristics of
capacity under simple designs like the all-pass [5]. But how
to effect good designs of the relay gains remains a problem
to be further looked into.
In this work, we consider the design of distributed single-
antenna amplify-and-forward (AF) relay networks. In partic-
ular, we consider the optimization of the relay forwarding
coefficients for maximization of the Shannon capacity of the
system. We aim at an analytical solution of the problem,
although it will be seen later that there are limits to what
can be achieved by analysis. We assume that the relays know
the relevant channel coefficients (or channel state information,
CSI).
First, we examine the dependence of capacity on the relay
transmission powers and the channel coefficients. Due to the
use of AF, both the signal power and the relay noise are
scaled by the relay forwarding coefficients. We show that the
capacity increases with the relay output powers, but there is an
upper bound to its asymptotic value at the limit of very high
relay powers. The analysis also helps to guide the subsequent
relay network design. In relay network design, we note that
there are two noise terms that impact the system performance,
namely, the relay noise and the destination noise. We find
that an analytical characterization of the optimal solution and
the performance bound can be obtained when either noise
dominates the total noise and when the number of relays are of
certain particular values. Based on these observations, we thus
propose suboptimal designs that optimize the relay forwarding
coefficients with proper relay section.
The resulting performance of the proposed designs shows
close resemblance to that of MIMO systems with antenna
selection [6], [7], which have been developed to reduce the
complexity of the MIMO transceiver without sacrificing the
diversity order by activating only a subset of the transmitter
or the receiver antennas. In [7], the outage diversity with
21st Annual IEEE International Symposium on Personal, Indoor and Mobile Radio Communications978-1-4244-8015-9/10/$26.00 ©2010 IEEE 892
seem to be a no-brainer as increasing the transmission power
should be beneficial to the signal-to-noise ratio (SNR) and
thus the capacity. But mathematically, due to the presence
of some matrices in (3) and (1), a solid proof nevertheless
requires a little work. We give the proof in Appendix A.
(Some intermediate results in the proof will also have use
later in system design.) For convenience, we state the result
as a theorem.
Theorem 1 (Capacity scaling): When the (complex) relay
gains R are scaled by s ∈ C with |s| > 1, C(sR) > C(R).
Therefore, we confirm that scaling up of the relay gains
can increase system capacity. Hence we may simplify the
optimization constraint to
PR =
L∑
i=1
(σ2R + σ
2
x‖gi‖2)|r(i)|2. (6)
That is, the relays should transmit at the maximum allowed
total power.
Next, one may wonder if the capacity could increase without
bound if the total relay transmission power tends to infinity.
Intuitively, the answer may appear to be another no-brainer
because, from (1), the quality of the source-to-relay links
should place a cap on the amount of information rate that
the system can support, however much the relay transmission
power can be. But again, a solid mathematical proof requires
a few lines of reasoning. Again for convenience, we state the
result as a theorem below and prove it in Appendix B.
Theorem 2 (Asymptotic capacity with high relay power):
As |s| → ∞, C(sR) is upper-bounded by
log det[IM + (
σx
σR
)2GGH ]
and it approaches the upper bound if and only if G and FR
span the same row space.
With Theorem 2, it is verified that C(R) is upper-bounded
irrespective of the power level of the relays.
III. RELAY NETWORK DESIGN FOR TWO TYPES OF NOISE
DOMINATION
We now consider how to design the relay coefficients
for maximization of the system capacity. Directly solving
(4) seems difficult because the diagonal nature of matrix R
rules out conventional beamforming-based solutions [2]. While
algorithms can always be developed to facilitate a solution of
the problem via computation, an analytical solution may give
more insights to the nature of the optimizing solutions. The
latter is the approach taken in this work. For this, note first that
the system performance depends on two noise terms, namely,
the relay noise vector nR and the destination noise vector
nD. The problem becomes much more tractable when one of
them dominates. In what follows we concentrate on these two
simplified scenarios and attempt at the corresponding solutions
of optimal relay gains.
A. Destination Noise-Dominating: Relay Selection and Power
Allocation
When σD  σR, from (2) we have W ≈ σ2DI . Thus from
(3) we get
C(R) ≈ log det[IM + ( σx
σD
)2HHH]
 CD(R). (7)
Hence the capacity is nearly that of an M×M MIMO system
with an end-to-end channel matrix H at SNR = (σx/σD)2.
Even in this simplified condition, a simple general solution
that maximizes CD(R) for L > M is, to the best of our
knowledge, not available. Nor is the efficient technique for
maximization of matrix determinant through convex optimiza-
tion under linear matrix inequality constraints [11] applicable.
However, we find that an analytical solution can be obtained
for L = M under high SNR. To proceed, therefore, we first
develop the solution for this condition. The solution can be
applied to the condition L > M to select good relays.
Let ρi(HHH) denote the ith largest eigenvalue of HHH .
With L = M and under a high end-to-end SNR, we have
CD(R) ≈ log det[( σx
σD
)2HHH]
= log[(
σx
σD
)2 det(FFH) det(GGH) det(RRH)]. (8)
So we need to find R to maximize det(R) subject to the
power constraint (6). Equivalently we may do
max
r
∏
i
|r(i)|2 (9)
subject to
PR =
L∑
i=1
(σ2R+σ
2
x‖gi‖2)|r(i)|2 ≈ σ2x
∑
i
‖gi‖2|r(i)|2. (10)
Employing the Lagrange multiplier technique leads to the relay
power allocation
|ropt(i)| =
√
PR
Mσ2x‖gi‖2
. (11)
When L > M , we can do relay selection by choosing M
relays out of the L such that (8) is maximized.
It is of interest to note that, under the above solution, the
product of the last two determinant terms in the right-hand-
side (RHS) of (8) is upper-bounded as
det(GGH) det(RRH) =
det(GGH)∏
i ‖gi‖2
(
PR
Mσ2x
)M
≤ ( PR
Mσ2x
)M . (12)
The last inequality can be shown by considering QR de-
composition of G. Let RG denote the triangular matrix in
the decomposition. Then det(GGH) =
∏
i |RG(i, i)|2 where
RG(i, i) is the ith diagonal element of RG. Apparently,
|RG(i, i)|2 ≤ ‖rGi‖2 where rGi denotes the ith column of894
16 18 20 22 24 26 28
10−3
10−2
10−1
100
capacity (bps/Hz)
CD
F
M=3, σ
x
 = 1, σR = 10
−2
, σD = 10
−1
, PR=1
 
 
L= 6 ant selection
L= 6 relay
L= 9 ant selection
L= 9 relay
L=12 ant selection
L=12 relay
Fig. 3. MIMO system with distributed relays in destination noise-dominating
condition: performance with different relay network sizes.
consequence of mismatch between the actual noise condition
(that the relay noise is not dominating) and the assumed
condition (that the relay noise dominates) under which the
solution is obtained. Nevertheless, with sufficiently dominating
relay noise (such as when σR/σD = 10 or 100), the diversity
performance becomes close to that of an antenna-selection
system, which in turn has a similar performance in diversity
order as a full MIMO system (the “full 3 × 6 MIMO” curve
in the plot), only a lower beamforming gain. In addition,
the capacity of the all-pass design still falls significantly
below that of the proposed design mostly. In Fig. 5, we
see that the performance of the proposed design is tightly
upper-bounded by the corresponding antenna-selection system
(assuming equal number of antennas to select from as there
are relays), and the diversity order again grows with the size
of the relay network in a similar way to an antenna-selection
system.
V. CONCLUSION
We considered the design of distributed relay networks to
aid MIMO transmission, where a major point in considering
a distributed relay network instead of a single multi-antenna
relay was the potential to effect a better diversity performance.
An analytical solution was attempted, though it turned out that
such analytical solutions could only be obtained for a limited
number of conditions. Nevertheless, these analytical results
facilitated suboptimal designs that could exploit the diversity
order afforded by the relay network to a similar degree to that
of a single-hop MIMO antenna-selection system. The proposed
suboptimal designs employed relay selection with optimal
setting of relay gains. Simulation results were presented which
demonstrated the diversity order performance of the proposed
designs and its superior performance compared to the simple
all-pass design.
10 15 20 25 30 35
10−3
10−2
10−1
100
capacity (bps/Hz)
CD
F
M=3, L=6, PR=100, σx=1, σR=0.1
 
 
σR/σD=10
2
σR/σD=10
σR/σD=1
ant selection
full 3× 6 MIMO
allpass, σR/σD=10
2
Fig. 4. MIMO system with distributed relays in relay noise-dominating
condition.
24 25 26 27 28 29 30 31 32 33
10−2
10−1
100
M=3, L=6, 9 or 12, σ
x
=1, σR=0.1, σD=0.01
capacity (bps/Hz)
CD
F
solid: relay system
dashed: ant selection
L = 6
L = 9
L = 12
Fig. 5. MIMO system with distributed relays in relay noise-dominating
condition: performance with different relay network sizes.
APPENDIX A
PROOF OF THEOREM 1
First, it is clear in (3) that C(sR) = C(|s|R). Without
loss of generality we assume s ∈ R+ (the set of positive real
numbers) hereafter.
Consider a singular value decomposition of FR given by
FR = UΛV H (17)
where for convenience we let Λ be M×M . Thus U ∈ CM×M
is the matrix of left singular vectors as usual, but the matrix of
right singular vectors V becomes L×M , that is, V ∈ CL×M .
Further, let the singular values along the diagonal of Λ be
arranged in descending numerical order. Let λi denote the ith
diagonal element in Λ. Substituting the above into (2) and (3),896
國科會補助計畫衍生研發成果推廣資料表
日期:2011/10/13
國科會補助計畫
計畫名稱: 子計畫三：合作式多輸出入無線通訊之上行傳收器訊號處理技術研究(2/2)
計畫主持人: 林大衛
計畫編號: 99-2219-E-009-010- 學門領域: 接取技術(網通國家型)
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
無。 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
