 2
Keywords: Real-time tracking, Active 
vision-based control, Binocular vision, 
Mobile robot, Telerobotics, On-line 
calibration. 
1. 前言 
機器人的應用範圍相當廣泛，從
家庭到工廠，甚至於太空都可見其蹤
跡。機器人如同人一般，需要了解外
界的狀態來進行反應。人有眼耳鼻及
皮膚，機器人則有各式各樣的感測器
來量測外界環境的狀態變化，進而做
出適當的反應。在眾多感測器中，攝
影機能夠提供非接觸且大量的量測資
訊，因此被廣泛的採用。然而，相對
於其它感測器而言，透過攝影機來量
測外界環境狀態的變化，其複雜性與
困難度均相對提升很多。因此，利用
視覺來進行各種的應用，乃成為許多
學者專家所研究的方向。其中，應用
視覺來進行導航控制，因為能賦與機
器人自我行進能力，乃成為一個熱門
的研究主題。 
其實，以感測器進行定位及地圖
重建 (SLAM:Simultaneous Localization 
and Map-Building)的研究非常多[1]。如
Chong 和 Kleeman[2]結合了聲納及精
密的里程計來建立地圖。Thrun 等人[3] 
則使用雷射測距儀和視覺以輔助機器
人能在真實的環境中進行導航。
Leonard 和 Feder[4]提出了一套利用聲
納資訊來達成地圖建立的方法，並實
際應用在水底機器人上。使用攝影機
回授的訊號進行導航控制時，其複雜
性及困難度均相當高。尤其在雙眼視
覺中，除了需要面對基本的影像處理
外，更多了對應比對(Correspondence 
matching)的難題。所謂的對應比對，
即是討論如何利用影像處理的技巧，
從二部攝影機所擷取到的影像上，來
得知三度空間中的物體，在左右影像
上呈像的對應關係。因為，唯有清楚
知道此對應的關係，才能夠從雙眼的
影像，重建回原來三度空間的環境。
因此，本計劃的主要目的，乃期望提
出一個分析及設計主動立體視覺伺服
系統之整合系統，在完全仰賴視覺，
並且無需其它感測器的輔助，依然能
夠在未知的室內環境之下，透過即時
重建的三度空間環境地圖，來規劃導
航控制法則，以自主地控制自製的輪
式移動型機器人，來完成導航控制任
務。並且當客戶端透過網路下達任務
時，此自主地控制的移動型機器人可
以與其他機械手臂整合已進一步精確
執行主動式視覺控制任務。 
利用視覺於未知環境中來進行導
航控制，主要可分二種方法，即無地
圖 (Mapless) 及 基 於 地 圖 建 立
(Map-building-based) 二種方式 [5] 。
Santos-Victor 等人[6]提出了一套以光
流為基礎(Optical-flow-based)的無地圖
視覺導航控制法則。另外，Hager 等人
[7]所採用的則是基於地圖建立的方
式，其利用雙眼視覺所提供的深度資
訊，來建立二維的平面地圖，進而進
行導航控制。而本計劃所採用的是以
邊緣特徵為基礎 (Edge-feature-based)
的三度空間環境重建的方法[8]，相較
於現存的方法而言，能夠更有效且快
速地達成三度空間環境重建，並進而
進行導航控制。藉由導航控制，自主
式移動型機器人將可以進行重建並導
航控制，而在到達機械手臂附近時，
自主式移動型機器人將透過無線網路
接受遠端的命令與對機械手臂端電腦
下達控制命令，而在利用視覺迴授來
 4
移動型機器人將透過無線網路接受遠
端的命令與對機械手臂端電腦下達控
制命令，再利用視覺迴授來控制機械
手臂，此方法不但可以達到精確的定
位控制，而且也可使機械手臂在進行
任務時更加有強健性，其示意圖如圖
三所示 
 
圖三 自主式移動型機器人與機械手臂架構 
不過當進行視覺迴授控制時，機械手
臂和攝影機之間的手眼協調關係會左
右任務的成敗，這個問題使得如果要
使用視覺迴授來進行機械手臂控制
時，就必須要事先量測好機械手臂和
攝影機之間的手眼協調關係，但是為
了要達到自主式移動型機器人的目
的，本研究提出了一種全新的線上校
準方法，利用立體視覺在未知攝影機
和機械手臂手眼協調位置的情形下，
來對機械手臂來進行校準，並進行控
制。而以下將介紹立體視覺系統，包
括了視覺追蹤演算法及對應比對法
則。 
3. 立體視覺系統 
在立體視覺系統中，包括了五個
部分，適應性邊緣偵測、最大值搜尋
法、對應比對演算法、視覺追蹤及參
數估測。 
A. 適應性邊緣偵測 
為了獲取出影像中的邊緣資訊，乃採
用在空間域中時常使用到的遮罩運
算，其運算方式為 
∑∑
−=−=
++=
b
bt
a
as
tysxftswyxg ),(),(),(  (1) 
其中，w 是一個 nm× 的遮罩， f 是原始
待處理的影像，g 為經過運算後所得到
的 輸 出 影 像 ， 且 2/)1( −= ma ，
2/)1( −= nb 。圖三為邊緣偵測後的雙眼
影像。 
  
圖三 邊緣偵測後的雙眼影像 
此外，為了能有效地適應不同的照度
變化，乃採用了自動門檻值調整法則
(Automatic threshold selection)[9-10]。 
B. 最大值搜尋法 
由於在經過霍夫轉換後，霍夫空間上
的峰值會因外在的因素而使得我們無
法選擇一個固定的門檻值，來找出全
部邊緣特徵在霍夫空間中所對應的參
數。因此，我們提出了一個尋找峰值
的方法，用來找尋霍夫空間的區域最
大值。這個搜尋演算法，分為下列三
個主要步驟。 
1. 定義一個適當大小的遮罩。 
2. 利用遮罩來搜尋整個霍夫空間，
進而判斷遮罩中心部分的值是否
比周圍的值高。若是，則此點為
峰值，反之，則不是峰值。 
3. 接著，一點接一點移動遮罩，重
複步驟 2 和步驟 3，直到遮罩掃描
過整個霍夫空間。 
從實驗結果得知，此方法在外在條件
的影響下，均能有效地找出霍夫空間
中的峰值。 
C. 對應比對演算法 
在影像經過邊緣偵測後，即可針
 6
 
圖九 重建後的三維及二維地圖 
因此，每一對比對成功的邊緣，均可
採用相同的計算，來重建回三度空間
的邊緣。很明顯的，即使在未知的室
內環境中，我們依然可以得到一個基
於邊緣特徵所重建的三度空間地圖。
經由重建的三度空間地圖，更進一步
地，可得到二維的平面地圖，進而應
用在導航控制上[11-13]。 
5. 視覺導航與控制 
根據視覺追蹤演算法、對應比對
法則及三度空間環境重建，三維和二
維的地圖會即時地更新。因此，我們
可以設計適當的控制法則，以控制機
器人行走在未知的室內環境下。 
5.1 機器人之運動學模型 
在移動式機器人模型方面，乃根
據實際機器人的結構，採用運動學模
型為機器人的模型。 
 
圖十 移動型機器人 MARS-II 
如圖十所示，選定基底座標系統在車
體上，其原點定為二輪輪軸的中點。
因此，移動式機器人相對於世界座標
的線性速度與角速度和其左右輪角速
度之間的關係為 
⎥⎦
⎤⎢⎣
⎡
⎥⎥
⎥⎥
⎥⎥
⎦
⎤
⎢⎢
⎢⎢
⎢⎢
⎣
⎡
−
−−
=
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢
⎣
⎡
R
L
W
s
b
s
b
bb
bb
y
x
ω
ωθθ
θθ
θ
22
cos
2
cos
2
sin
2
sin
2
&
&
&
   (3) 
上標W 表示世界座標系統。其中， ),( yx
和θ 分別為車體相對於世界座標系統
的位置及角度， Rω 和 Lω 分別為右輪和
左輪的旋轉角速度，b 為車輪的半徑，
s為半車身長。 
5.2 控制器設計 
如圖十一所示，為機器人初始姿態與
期望姿態的示意圖。 
 
(a) 初始姿態   (b) 期望姿態 
圖十一 導航控制示意圖 
因此,在環境座標系統 E 上定義適當的
編碼誤差為 
0  ;   ***
*
*
*
===
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢
⎣
⎡
−
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢
⎣
⎡
≡ θ
θθ
dxd
x
d
x
e
EE
E  (4) 
因為我們希望機器人相對於環境座標
系統 E 的最終姿態是 *x 、 *d 和 *θ 均為
零，如圖十一(b)所示。此外，若將編
碼誤差表示在世界座標系統 W  上，
則 
0  ;   **
*
*
*
==
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢
⎣
⎡
−
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢
⎣
⎡
≡ θ
θθ
xy
x
y
x
e
WW
W    (5) 
將(4)對時間微分，可得 
 8
Step 3:計算誤差 )1(ˆ)()()( −−= tttyt T θφε  
Step 4:更新參數 )()()1(ˆ)(ˆ ttKtt εθθ +−=  
Step 5:更新 ( ) λφ /)1()()()( −−= tPttKItP T  
Step 6:回到 Step:2 
其中 10 ≤< λ 為 forgetting factor, )(ˆ tθ
為想估算的參數， )(ty 與 )(tφ 為所輸入
的資料 
7. 實驗 
在視覺導航控制實驗中，架設在
機器人之上的雙眼攝影機所看到的影
像，會在電腦中進行分析，將機器人
所看到的自然幾何特徵，即走道的邊
緣，透過對應比對、視覺追蹤及環境
重建等等步驟，來達成即時的三度空
間環境重建。透過二維的平面地圖，
電腦會輸出適當的控制命令給機器
人，以驅使機器人能夠沿著規劃的路
徑行走，以保持機器人行走在道路的
中間，直到走道轉彎處。此外，在自
主式移動型機器人在行走到目的地
時，為了要進行測試手眼協調參數校
準方法的正確性，因此設計了一個點
到點的任務來進行測試。 
7.1 實驗環境設定 
 
圖十二 實驗環境與自製移動型機器人 
整個系統，如圖十二所示，包括
了一個自製的移動型機器人 MARS-II 
(Mobile Autonomous Reconnaissance 
System-II)，其上搭載一對具有水平俯
仰 變 焦 功 能 的 攝 影 機 ， SONY 
EVI-D100。所有的影像處理及控制法
則運算都在機器人身上的筆記型電腦
中執行。實驗中，從影像擷取、特徵
抽取到視覺控制器輸出，平均工作時
脈約為 10Hz 左右。而所搭配控制的機
械手臂如下圖所示 
 
Mitsubishi RV-1A 六軸機械手臂 
7.2 立體視覺導航 
整個自主式視覺導航實驗，在初
始狀態下移動式機器人準備進入走
廊。從雙眼影像中，藉由邊緣偵測所
萃取出的自然幾何特徵，透過霍夫轉
換後，進而在霍夫空間中進行對應比
對，以了解這些自然幾何特徵在雙眼
的對應比對的關係。當對應比對的關
係清楚知道以後，隨即在這些已完成
對應比對的自然幾何特徵上，擺放追
蹤視窗，用以更新這些特徵在霍夫空
間的參數，如圖十三(a)所示。如此便
能降低霍夫轉換的運算量，來達成即
時控制，並且仍能保有原有的對應比
對結果。接著，針對這些比對成功後
的特徵，再配合攝影機的校準參數，
即可得到即時的三維及二維的地圖，
並依此重建的地圖進行導航控制，如
圖十三(b)所示。從圖十三到十六，顯
示所提出的視覺導航控制器，能自主
地控制機器人，沿著所規劃的路徑行
走，直到走廊底部的轉彎處。圖十七
(a)、(b)和(c)分別表示 x 、 d 和θ 的誤
差。從圖中我們可以清楚地看到，在
一段時間後 x 、 d 和θ 的誤差都維持在
零附近振盪。 
 10
0 5 10 15 20 25 30
-5
-4
-3
-2
-1
0
1
2
3
4
5
E
rr
or
 in
 θ 
(d
eg
.)
Time (sec.)  
(c) θ 的誤差 (deg.) 
圖十七  誤差結果圖 
7.3 手眼協調參數校準 
由於在我們的任務中，是想要對於機
械手臂進行像是點到點之類的控制動
作，但是對任務進行控制器設計時，
攝影機座標相對於機械手臂基底座標
的旋轉矩陣和平移向量等參數是必須
的，且由於攝影機並不是固定再空間
中某一個固定的位置，而是架設在移
動型機器人上，所以無法使用固定的
參數去設計控制器，因此我們再此利
用我們提出的全新的線上校準方法來
校準出正確的參數來使得任務可以順
利完成。圖 8 到圖 13 顯示實驗過程。
而點到點任務誤差收斂情形如圖 14 所
示，由誤差收斂圖可以發現。當一開
始手眼協調參數由於未校準過，因此
剛開始控制機械手臂時務差不但不收
斂，反而有發散的跡象，經過一段短
暫的時間後，手眼協調參數即可收斂
到相當準確的程度，因此機械手臂就
可以順利完成任務。而其中所估算的
參數與預期的參數如表一所示 
   
圖 8. 實驗過程      圖 9. 實驗過程 
   
  圖 10. 實驗過程     圖 11. 實驗過程 
   
   圖 12. 實驗過程    圖 13. 實驗過程 
 
圖 14. 誤差收斂圖 
 預期參數 求得的參數 
旋轉矩陣
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢
⎣
⎡
−
−
−
010
100
001
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢
⎣
⎡
0.001.0238-0.01
1.0874-0.0010.021-
0.0154-0.02170.9871-
平移向量
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢
⎣
⎡
30
660
360  
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢
⎣
⎡
29.1832
660.9314
362.4527  
表一. 誤差收斂圖 
8. 結論 
本計劃提出一套利用雙眼視覺來
達成即時三度空間環境重建的演算
法，採行以邊緣為基礎的對應比對法
則，相較於一般所採用的區塊比對方
式，因為有了追蹤視窗的輔助，使得
我們所提出的方法，能有效降低不必
要的運算，能在不需要特殊演算法及
硬體的搭配之下，達成即時性的目
標。經由實驗結果的呈現，從邊緣偵
測、霍夫轉換、在霍夫空間進行的對
