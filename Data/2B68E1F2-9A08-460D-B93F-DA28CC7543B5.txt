 附件一 
行政院國家科學委員會補助專題研究計畫  成 果 報 告   □期中進度報告 
 
以指骨特徵為主之手掌 X 光影像骨齡估測系統之研究 
A study on bone age assessment system based on 
phalangeal features of hand radiographs 
 
計畫類別： 個別型計畫  □ 整合型計畫 
計畫編號：NSC 100－2221－E－005－086－ 
執行期間：2011 年 08 月 01 日至 2012 年 07 月 31 日 
 
計畫主持人：喻石生 
共同主持人： 
計畫參與人員：  
 
 
成果報告類型(依經費核定清單規定繳交)：精簡報告  □完整報告 
 
 
 
 
處理方式：除產學合作研究計畫、提升產業技術及人才培育研究計畫、
列管計畫及下列情形者外，得立即公開查詢 
          □涉及專利或其他智慧財產權，□一年□二年後可公開查詢 
          
執行單位：國立中興大學 
 
中   華   民   國  101 年  10 月  21  日 
前言 
 
在臨床醫學上，「骨齡估測」已是目前公認鑑定生長發育程度最準確、可
靠、且最簡單易行的方法，這是一種利用科學方式來評估骨頭的生長年齡，也
就是所謂的生物年齡，它可以反應孩童體內發育成熟的程度，所以臨床上常應
用於評估孩童生長問題的鑑別診斷。除了上述的應用之外，骨齡還可以用來預
測未來成年時的身高，進一步還可以作為運動員選才之用。然而，骨齡或骨骼
成熟度的估測在對於兒童內分泌醫學的診斷和治療決策過程中尤其扮演極為
重要角色；特別是針對那些患有內分泌疾病和生長發育失序兒童，更是一大評
估指標，以便及時作出因應對策[1]。在兒童臨床醫學上，主要是對於左手 X
光片影像進行感興趣(Region of interest: ROI)區域特徵之觀察及分析來估測骨
齡，然後與其實際年齡(日曆年齡)相互比較，進而判斷在骨骼發展過程中是否
異常(即與實際年齡不符)。以目前醫學上來看，在骨齡評估過程中使用最廣泛
的兩種方法分別為 Greulic and Pyle [2] 及 Tanner and Whitehouse (TW2) [3]。但
不論是那一種方法，在骨齡評估的過程中，均是由判讀者以人工的方式來完
成，他們必須專注於觀察某些特定骨骼的出現時間順序和發展特徵，甚至必要
時還必需相互比較同一受檢者在不同時間之影像前後變化的差異。因此存在下
列缺點︰工作量非常大、資源消耗大、測定週期長、 此外還可能導致同一判
讀者針對同一張影像因前後時間的不同而有相異的估測結果，或是不同判讀者
間對相同影像估測的差異性(以上人為因素所產生之判別的不準確性)。換言
之，一個骨齡評估的結果往往取決於醫生專業技能和純熟的經驗，因此，一個
準確且客觀的電腦輔助骨齡估測系統乃為迫切必需的 [4, 5]，它除了可針對所
關注的每塊骨頭進行獨立判定及量測外，還能有效完成對整體臨床特徵的定量
評估並降低上述之差異性，以達到臨床上早期診斷和有效的監控。 
 
 
 
 
 3
系統。 
 
文獻探討 
 
由於在後期骨骼發展 ROI 影像，其骨骺及幹骺區域融合程度較難以影像
切割技術進行骨齡估測。因此紋理分析技術於後期骨骼發展影像中，較適合
於骨齡估測之用。早期之紋理分析技術大多於影像空間域觀察其局部空間關
係性，從鄰近像素值變化程度找出其相依性，而這當中則以灰階共相關矩陣
[31, 32]及局部二元圖騰[2]技術最俱代表性。然而空間域像素關係分佈交雜著
許多幾何方向性資訊，當局部區域像素關係含有複雜空間關係時，空間域紋
理分析技術就難以從中萃取出重要資訊。小波轉換為一個多重解析之分解技
術，其轉換後所得到之子頻帶分別含有豐富之空間分佈關係資訊，如：LH
頻帶含有垂直分佈關係、HL 頻帶含有水平分佈關係、HH 頻帶含有對角分佈
關係。於是在近年的紋理分析技術中，小波轉換則被大量作為紋理特徵分析
萃取上主要的技術[33, 34, 35]。因此，在本計畫中，小波轉換技術有利於後
期骨骼發展 ROI 影像中，針對骨骺及幹骺區域融合處進行紋理分析，並進而
達到骨齡估測之目的。 
基本上，以小波為基礎之紋理特徵技術多直接萃取其小波係數作為建立
預測模型之用。然而各頻帶之小波係數個數規模相當龐大，對於計算與估測
預測模型的參數會產生較龐大且複雜的計算成本。由於奇異值分解的計算特
性可將數據資料藉其計算分解得到一奇異值矩陣，從該奇異值矩陣之對角係
數中萃取特徵當中最重要且精華的資訊，如此一來可達到保留重要特徵資訊
的目的並且可降低資料維度及時間複雜度。由於從過往文獻中可得知不同紋
理類別的奇異值係數分佈是有顯著的差異，即便是同一類紋理影像，在不同
子頻帶間其奇異值係數的分佈也是會有差異。此外，萃取奇異值矩陣中較低
位置之奇異值係數又可達到除去雜訊的效果，便可更有助於在較現實與嚴苛
的影像環境中達到較佳之區別效果。因此在此階段，奇異值分解技術將應用
在前一階段之各子頻帶的正規化區域能量矩陣中。 
支援向量機將使用者所給予之非線性樣本資料轉換對映為線性樣本資
料，即可將原始資料特徵提昇至高維度的資料空間，並在高維度空間中尋找
 5
子頻帶可計算出一個 λ 參數，代表一張 ROI 影像便可取得三個 λ 參數。一張
手掌影像便可藉由九張 ROI 影像得到 27 個 λ 參數，如此一來便形成一個 27
維的特徵向量。每張手掌影像所取得的特徵向量便可輸入作為機器學習訓練
且分類之用。 
所獲得的三個階段的特徵萃取後，所得到的就是各張掌骨影像的特徵向
量。支援向量機被使用為主要學習訓練與分類器。支援向量機(Support Vector 
Machine，簡稱為 SVM)是一個以統計學習理論與結構風險最小化觀念之監督
式學習(Supervised learning)的學習機器[36, 37]，其特色為根據已知分類的訓練
樣本中的特徵值（輸入值）與目標值（輸出值）來作為訓練學習機器所用。 
 
成果與討論 
 
本計畫除在國外 Conference 發表一篇 paper (EI)外，尚有一篇 Journal paper
準備要投稿。此外，另有一篇關於：由乳房 X 光影像中，將肌肉定位與切割
出來的 paper，發表於 Computers & Mathematics with Applications (Vol.64, pp. 
1100 —1107. Rank:6.31%)。本計畫之成果不論在學術上或應用上，均有其重要
之貢獻。很可惜，國科會遲遲無法提供多年期之支持，因此，根本無法有效
的進行研究。 
 
參考文獻 
 
[1] D.B. Darling, Radiography of Infants and Children, 1st ed. Springfield, IL: 
Charles C Thomas, Ch.6: (1979) 370–372,  
[2] W.W. Greulich and S.I. Pyle, Radiographic Atlas of Skeletal Development of 
Hand Wrist (ed2), Stanford, CA: Standford University Press (1971). 
[3] J. M. Tanner and R.H. Whitehouse, Assessment of skeletal maturityand 
prediction of adult height (TW2 Method) London: Academic Press (1975). 
[4] E. Pietka, A. Gertych, S. Pospiech, H.K. Huang and F. Cao, Computer Assisted 
Bone Age Assessment: Omage Pre-processing and ROI Extraction, IEEE Trans 
Med Imaging. 20 (2001) 715–729. 
[5] H. Kwon, S.Z. Der and N.M. Nasrabadi, An Adaptive Segmentation Algorithm 
 7
methods, British Journal of Rradiology 67 (1994) 848–851. 
[16] C.W. Hsieh, T.L. Jong, and C.M. Tiu, The Phalangeal Morphological 
Characteristics for Bone Age Recognition, 13th IEEE-NPSS Real time 
conference 2003, Montreal, Canada, May (2003). 
[17] C.H. Chang, C.W. Hsieh, T.L. Jong and C.M. Tiu, A Fully Automatic 
Computerized Bone Age Assessment Procedure Based on Phalange 
Ossification Analysis, In 16th IPPR conference on CVGIP, Kinmen (2003) 
463-468. 
[18] D. Giordano, R. Leonardi, F. Maiorana, G. Scarciofalo and C. Spampinato, 
Epiphysis and Metaphysis Extraction and Classification by Adaptive 
Thresholding and DoG filtering for Automated Skeletal Bone Age Analysis, 
Conf Proc IEEE Eng Med Biol Soc( 2007) 6552–6557. 
[19] K.S. Pospiech, A. Gertych, E. Pietka, F. Cao and H.K. Huang, Wavelet 
Decomposition Based Features in Description of Epiphyseal Fusion, Analysis 
of Biomedical Signals and Images. In proceedings of 15th Euroconference 
Biosignal, Brno (2000) 246–248. 
[20] A. Bielecki , M. Korkosz and B. Zielinski, Hand Radiographs Preprocessing, 
Image Representation in the Finger Regions and Joint Space width 
Measurements for Image Interpretation, Pattern Recognition 41 (12) (2008), 
3786–3798. 
[21] E. Pietka, K.S. Pospiech, A. Gertych, F. Cao, H.K, Huang and V. Gilzanz, 
Computer Automated Approach to the Extraction of Epiphyseal Regions in 
Hand Radiographs, J Digit Imaging 14 (4) (2001) 165–172. 
[22] A. Kumar, D.C.Wong, H.C. Shen and A.K. Jain, Personal Authentication Using 
Hand Images, Pattern Recognition Letters 27 (13) (2006) 1478–1486. 
[23] S. Baskana, M.M. Buluta and V. Atalay, Projection Based Method for 
Segmentation of Human Face and its Evaluation, Pattern Recognition Letters 
23 (14) (2002) 1623–1629. 
[24] R.C.Gonzalez, R.E. Woods, Digital Image Processing. Addison-Wesley 
Longman Publishing Co., Inc., Boston, MA, USA( 2002). 
[25] D.J. Michael and A.C. Nelson, HANDX: A Model-based System for Automatic 
 9
 11
[36] V. Vapnik, The Nature of Statistical Learning Theory. Springer, New York, 
1995. 
[37] V. Vapnik, Statistical Learning Theory. John Wiley, New York, 1998.  
 
附錄 
 
                                  
epiphyseal/metaphyseal regions of interest (EMROI) of distal, 
middle, and proximal phalanges of a hand radiograph at the 
later stage are extracted for bone age assessment [7–9]. In [10–
12], image processing and pattern recognition techniques are 
employed to extract the bony tissues of an EMROI. Pietka et al. 
[11] applied wavelet transform to obtain the horizontal sub-
band of EMROI at the later stage. Then 4 features are used to 
establish feature histograms. The user can select one of the 
feature histograms and search for similar results in the database. 
The accuracy is definitely not insured. 
This paper presents a later stage BAA system. The diagram 
is shown in Figure 2. Wavelet transform is used to obtain three 
sub-bands: LH, HL and HH, of each EMROI. A ӳ-feature of 
each sub-band of EMROI is extracted and then support vector 
machine (SVM) is employed to do the classification. It is more 
efficient and accurate for bone age assessment. Section 2 
presents sub-band extraction and feature extraction procedures 
of the proposed system. Section 3 introduces the principle of 
SVM. Experimental results are presented in Section 4. 
Conclusions are given in Section 5. 
Figure 2. The diagram of the presented BAA system of hand radiographs at 
the later stage. 
II. FEATURE EXTRACTION AND BONE AGE ASSESSMENT
In this section, the procedures of feature extraction and 
classification are described in detail. According to [4, 13, 14], 
nine EMROIs are extracted from the index, middle, and ring 
phalanges of a hand radiograph. Then the bony tissues of each 
EMROI are extracted by procedures proposed in [10–12]. And, 
by [15], a given hand radiograph is classified into a suitable 
stage. For hand radiographs at the later stage, the following 
procedures are applied to assess the related bone ages. 
A. Wavelet Transform 
First, wavelet transform is applied to each EMROI to obtain 
three detail sub-bands. For given low-pass filter g and high- 
pass filter h, the 2-D discrete wavelet transform (DWT) is 
described as follows: 
( ) ( ) ( ) ( ) ( ) ( )¦¦
∞
−∞=
∞
−∞=
−=−=
k
H
k
L khkjixjiwkgkjixjiw ,2,.,,2,,
 (1) 
where x(i,j) is the input signal. And, 
( ) ( ) ( )
( ) ( ) ( )
( ) ( ) ( ),,2,
,,2.,
,,2,
khjkiwkiw
kgjkiwjiw
khjkiwjiw
k
HHH
k
HHL
k
LLH
¦
¦
¦
∞
−∞=
∞
−∞=
∞
−∞=
−=
−=
−=
                      (2) 
where wLH, wHL, and wHH represent the LH, HL, and HH sub-
bands, respectively. By decomposing an image with DWT, the 
three detail sub-bands (LH, HL, and HH) can be obtained for 
further feature extraction. 
B. Nonlinearity 
 Next, the nonlinearity is applied to make sub-band values 
less sensitive to local variations. A total energy, Er, of the rth 
sub-band is given as: 
( ) ,,1
1 1
2¦¦
= =
=
R
i
C
j
rr jiw
RC
E                          (3) 
where r =LH, HL, and HH, respectively, and R and C are the 
numbers of rows and columns of the sub-band, respectively. 
And, a local energy sub-band, Lr, obtained by applying a 3×3
window to the rth sub-band is described as follows: 
                    ( ) ( ) .1,1
9
1
,
2
0
2
0
2¦¦
= =
+−+−=
u v
rr vjuiwjiL
 (4) 
Then, the nonlinearity procedure normalizes the local 
energy sub-band to get a normalized local sub-band, Nr, by: 
                                    ( ) ( ) ./,, rrr EjiLjiN =  (5) 
C. Singular Value Decomposition 
Now, singular value decomposition (SVD) is applied on the 
normalized sub-band Nr to obtain singular values by: 
                                    ,*rrrr VUN Σ=  (6) 
where Nr is the rth normalized sub-band of size R×C, Ur is an 
orthogonal matrix of size R×C, Vr is an orthogonal matrix of 
size C×C, and Σr is a diagonal matrix of size C×C. The 
diagonal coefficients of Σr are sorted in decreasing order, which 
are the singular values. 
D. ӳ-Feature Extraction 
A number, n, described as follows is used to reduce the 
number of singular values. 
                                    ,/
1
22
1 »¼
»
«¬
«
= ¦
=
C
i
issCn
 (7) 
2012 7th IEEE Conference on Industrial Electronics and Applications (ICIEA) 1327
                                   
wavelet transform to obtain three detail sub-bands which 
preserve the main texture information of each EMROI and 
applies SVD to extract the notable eigenvalues. These 
eigenvalues are further refined to get the ӳ-features. Hence, 
theseӳ-features can present the significant characters of an 
EMROI. Again, as what is shown in Table I, SVM can provide 
a best performance. Therefore, the proposed bone age 
assessment system can perform an efficient and very well bone 
age assessment for hand radiographs at the later stage. 
REFERENCES
[1] D. B Darling, Radiography of Infants and Children, 1st ed. Springfield, 
IL: Charles C Thomas, 1979. 
[2] K. S. Pospiech, A. Gertych, E. Pietka, F. Cao and H. K. Huang, 
“Wavelet decomposition based features in description of epiphyseal 
fusion, Analysis of Biomedical Signals and Images”, Proceedings of 
15th Euro Conference Biosignal, Brno, pp.246–248, 2000. 
[3] K. S. Prasanna and A. Gurdial, “Image thresholding using two-
dimensional Tsallis-Havrda-Charvát entropy”, Pattern Recogn. Lett., 
vol.27, pp.520–528, 2006. 
[4] C. W. Hsieh, T. L. Jong, C. M. Tiu, “Bone age estimation based on 
phalanx information with fuzzy constrain of carpals”, Med. Biol. Eng. 
Comput., vol.45 (3), pp.283–295, 2007. 
[5] D. G. King, D. M. Steventon, M. P. O’Sullivan, A. M. Cook, V. P. 
Hornsby and I G. Jefferson, “Reproducibility of bone ages when 
performed by radiology registrars: An audit of Tanner and Whitehouse II 
versus Greulich and Pyle methods”, Br. J. Radiol., vol.67, pp.848–851, 
1994. 
[6] F. E. Johnston and S. B. Jahina, “The contribution of the carpal bones to 
the assessment of skeletal age”, Am. J. Phys. Anthropol, vol.23 (4), 
pp.349–354, 1965. 
[7] J. M. Tanner, M. J. R. Healy, H. Goldstein, N. Cameron, Assessment of 
Skeletal Maturity and Prediction of Adult Height (TW3 Method), 
London: WB Saunders, 2001. 
[8] J. M. Tanner, R. H. Whitehouse, Assessment of Skeletal Maturity and 
Prediction of Adult Height (TW2 Method), London: Academic Press., 
1975. 
[9] W. W. Greulich, S. I. Pyl, Radiographic Atlas of Skeletal Development 
of Hand Wrist (ed2), Stanford, CA: Standford University Press.; 1971. 
[10] E. Pietka, S. P. Kurkowska, A. Gertych, F. Cao, “Integration of 
computer assisted bone age assessment with clinical PACS”, Comput. 
Med. Imag. Grap., vol.27 (3), pp.217–228, 2003. 
[11] E. Pietka, A. Gertych, K. S. Pospiech, F. Cao, H. K. Huang, V. Gilzanz, 
“Computer-assisted bone age assessment: graphical user interface for 
image processing and comparison”, J. Digit. Imaging, vol.17 (3), 
pp.175–188, 2004. 
[12] C. C. Han, C .H. Lee and W .L. Peng, “Hand radiograph image 
segmentation using a coarse-to-fine strategy”, Pattern Recogn., vol. 40 
(11), pp.2994–3004, 2007. 
[13] H. H. Lin, W. C. Chiang, S. G. Shu, L. M. Shih, and S. S. Yu, “The 
effect of ROI normalization for hand radiographic image segmentation”, 
Int. J. Innov. Comp., Inf. Control, vol. 7 (10), pp.5669–5688, 2011. 
[14] E. Pietka, K. S. Pospiech, A. Gertych, F. Cao, H. K. Huang and V. 
Gilzanz, “Computer automated approach to the extraction of epiphyseal 
regions in hand radiographs”, J. Digit. Imaging, vol. 14 (4), pp.165–172, 
2001. 
[15] H. H. Lin, S. G. Shu, Y. H. Lin, and S. S. Yu, “Bone age cluster 
assessment and feature clustering analysis based on phalangeal image 
rough segmentation”, Pattern Recogn., vol. 45 (1), pp.322–332, 2012. 
[16] V. N. Vapnik, The Nature of Statistical Learning Theory, Springer-
Verlag, New York, 1995. 
[17] R. M. Haralick, K Shanmugam and I. Dinstein, “Textural features for 
image classification”, IEEE Trans. on Systems, Man, and Cyber., 
vol.SMC-3 (6), pp.610–621, 1973. 
[18] S. Arivazhagan and L. Ganesan, “Texture classification using wavelet 
transform”, Pattern Recogn. Lett., vol. 24 (9-10), pp.1513–1521, 2003. 
2012 7th IEEE Conference on Industrial Electronics and Applications (ICIEA) 1329
C.-C. Liu et al. / Computers and Mathematics with Applications 64 (2012) 1100–1107 1101
Fig. 1. The flow chart of the proposed pectoral muscle segmentation algorithm for mammograms.
operators such as areamorphology, alternating sequential filter, openings and closings. Kwok et al. [6] detected the pectoral
muscle edge in a restricted neighborhood derived by estimating the pectoralmuscle edge as a straight line segment, and then
refined the detected edge by surface smoothing. However, the hypothesis of a straight line segment for the representation
of the pectoral muscle edge is not always correct.
Multiple regression analysis (MRA) is a statistical method used to model the relationships between several independent
variables and a dependent variable by fitting an equation to the observed data [7,8]. Numerous experiments have shown
that multiple regression models can be used to make accurate predictions. Multiple regression procedures are very widely
used in the social and natural sciences today [9]. It is also a suitable technique for us tomodify the extracted pectoral muscle
border to increasing the precision of the proposed pectoral muscle segmentation algorithm.
The proposed pectoral muscle segmentation algorithm bases on the positional characteristic of pectoral muscle in a
breast region to combine the iterative Otsu thresholding scheme and the mathematic morphological processing to find
a rough border of the pectoral muscle. Once the pectoral muscle border is extracted, the multiple regression analysis is
then employed on the rough border to obtain an accurate segmentation of the pectoral muscle. The presented algorithm
is tested on the digital mammograms from the Mammogram Image Analysis Society (MIAS) database. The experimental
results show that (i) the pectoral muscle extracted by the presented algorithm approximately follows that extracted by an
expert radiologist, (ii) the proposed scheme is adaptive to large variations in appearance of the pectoral muscle; it remains
effective when the pectoral border is obscured by superimposed muscle tissue or artifacts, (iii) the proposed scheme will
decrease the false positives in computer aided detection (CAD) of breast cancer. The remainder of this paper is organized in
the following order: Section 2 introduces the presented extraction algorithm of pectoral muscle region frommammograms.
Section 3 presents the experimental results. The conclusions of this paper are presented in Section 4.
2. Proposed pectoral muscle segmentation algorithm
In order to construct an accurate pectoral muscle segmentation algorithm for digital mammograms, several schemes are
used in this paper. The overall pectoralmuscle segmentation algorithm for digitalmammograms is shown in Fig. 1. There are
mainly three stages involved in the algorithm: (i) breast region extracted by using modified gradient vector flow (MGVF)
snake, (ii) rough pectoral muscle region detection by using the iterative Otsu thresholding scheme, (iii) pectoral border
modification by utilizing multiple regression analysis. The details of these stages used in the presented pectoral muscle
segmentation algorithm are described in the following subsections.
2.1. Breast region extracted by using modified gradient vector flow (MGVF) snake [10]
To segment a digital mammogram into the breast region and the background is an essential step for pectoral muscle
segmentation. By extracting the breast region, the precision of the pectoral muscle segmentation is increased and the time
consumption is shortened. The breast region extraction algorithm must be fully automated and give correct results for all
digital mammograms. The breast region segmentation by using anMGVF snake is employed in this paper, amethod thatwas
introduced in our previous paper: ‘‘a breast extraction scheme for digital mammograms using gradient vector flow snake’’ [10].
The proposed breast region extracting algorithm integrated the median filtering step, the scale down step, the binarization
processing step, the morphological erosion processing step and novel gradient adjusting step. The median filter step was
used to filter out the noise in amammogram, the scale down stepwas used to resize down themammogram size to speed up
the breast region extraction. The binarization processing step and the morphological erosion processing step were used to
find a rough breast border. The novel gradient adjusting step was applied to get a modified edgemap; and then the gradient
vector flow snake (GVF snake) was employed to obtain an accurate breast border from the rough breast border. This breast
extraction scheme can output the corresponding accurate breast region from an input digit mammogram, and the output
breast region will be used in the following stage to detect a rough border of the pectoral muscle.
C.-C. Liu et al. / Computers and Mathematics with Applications 64 (2012) 1100–1107 1103
In this paper, the black region in a mammogram is the background, and white regions usually contained the pectoral
muscle. For obtaining a region as the pectoral muscle, the presented algorithm will apply the morphological operation and
connected component scheme on the white regions colored by the Otsu thresholding scheme to extract the pectoral muscle
area in following processes.
2.2.2. Morphological processing
In anOtsu binarizedmammogram, thewhite area located either at the left upper or right upper corner of the breast region
may be the pectoral muscle. For obtaining a better and simple binary image of pectoral muscle, the presented algorithm
adapts the morphological opening operation to delete the non-pectoral-muscle white areas. The structuring element of the
morphological opening operation used in the presented algorithm is a disk with radius 2 pixels.
2.2.3. Extract pectoral muscle border
Many non-pectoral-muscle white areas still remain in the binary mammograms that have been operated by the
morphological opening operation, but they don’t locate at either the left upper or right upper corner of the breast regions.
The presented algorithm utilizes the location characteristic of the pectoral muscle in a breast region to extract the upper
left or upper right corner white area as the pectoral muscle area I. Those white areas located outside the left upper and
right upper corners will be set to be the background IB, and the gray levels of IB are reset as zero (black). The initial pectoral
muscle border is extracted by subtracting the eroded IB from the IB before eroding.
2.3. The modification of pectoral muscle border using multiple regression analysis [9]
When performing experiments, data are frequently tabulated in the form of ordered pairs (x1, y1), (x2, y2), . . . , (xn, yn)
with each xi distinct. Given the data, it is then usually desirable to be able to predict y from x by finding a mathematical
model, that is, a function y = H(x) that fits the data as closely as possible. One way to determine how well the function
y = H(x) fits these order pairs (x1, y1), (x2, y2), . . . , (xn, yn) is to measure the sum of squares of the errors (SSE) between
the predicted values of y and the observed values yi for all of the n data points.
Multiple regression is one of the widely used statistical techniques [11]. This technique is used to find a polynomial
function of degree k, y = β0 + β1x + β2x2 + · · · + βkxk as the predicting function, that has the minimum of the sum
of squares of the errors(SSE) between the predicted values of y and the observed values yi for all of the n data points
(x1, y1), (x2, y2), . . . , (xn, yn). The values of β0, β1, β2, . . . , and βk that minimize
SSE(β0, β1, . . . , βk) =
n
i=1
[yi − (β0 + β1xi + β2x2i + · · · + βkxki )]2, (14)
are obtained by setting the k + 1 first partial derivatives ∂
∂β0
SSE(β0, β1, . . . , βk), ∂∂β1 SSE(β0, β1, . . . , βk), . . . , and
∂
∂βk
SSE(β0, β1, . . . , βk) equal to zero, and solving the resulting simultaneous linear system of the so-called normal
equations:
nβ0 + β1
n
i=1
xi + β2
n
i=1
x2i + · · · + βk
n
i=1
xki =
n
i=1
yi, (15)
β0
n
i=1
xi + β1
n
i=1
x2i + β2
n
i=1
x3i + · · · + βk
n
i=1
xk+1i =
n
i=1
xiyi, (16)
β0
n
i=1
xki + β1
n
i=1
xk+1i + β2
n
i=1
xk+2i + · · · + βk
n
i=1
x2ki =
n
i=1
xki yi, (17)
and the matrix form solution of the normal equations system is
β0
β1
β2
:
βk
 = B = XTX−1 XTY  , (18)
where
X =

1 x1 x21 · · · xk1
1 x2 x22 · · · xk2
1 x3 x23 · · · xk3: : : ::: :
1 xn x2n · · · xkn
 , Y =

y1
y2
...
yn
 . (19)
C.-C. Liu et al. / Computers and Mathematics with Applications 64 (2012) 1100–1107 1105
Table 1
The MOEs of the pectoral muscle border of mdb005 obtained by MRA with a polynomial of degree n, n = 1, 2, . . . , 10.
Poly. Degree 1 2 3 4 5 6 7 8 9 10
ME1 0.3411 0.2957 0.2062 0.1812 0.1803 0.1803 0.1803 0.1803 0.1803 0.1803
ME2 0.0371 0.0335 0.0219 0.0179 0.0173 0.0172 0.0172 0.0172 0.0172 0.0172
RFAE 0.0042 0.0038 0.0027 0.0020 0.0020 0.0020 0.0019 0.0019 0.0019 0.0019
EER 0.0130 0.0097 0.0085 0.0079 0.0076 0.0077 0.0077 0.0076 0.0076 0.0076
NU 0.0258 0.0224 0.0186 0.0152 0.0148 0.0149 0.0148 0.0148 0.0148 0.0148
MHD 0.3018 0.2503 0.1831 0.1456 0.1410 0.1410 0.1410 0.1410 0.1409 0.1409
Fig. 3. The pectoral muscle border of mdb005 constructed by MRA with different degree polynomials; (a) original mammogram, (b) ground truth labeled
by an expert radiologist, (c) degree 1, (d) degree 2, (e) degree 3, (f) degree 4, (g) degree 5, (h) degree 6, (i) degree 7, (j) degree 8, (k) degree 9, (m) degree 10.
(vi) ThemodifiedHausdorff distance (MHD) is utilized to assess the shape similarity of the extracted objectOe to the ground-
truth object Og , which is defined as:
MHD(Oe,Og) = 1|Og |

p∈Og
d(p,Oe), (25)
where |Og | is the pixel number of the ground-truth object Og , d(p,Oe) is the distance from pixel p to the extracted
object Oe which is defined as:
d(p,Oe) = min{distance(p, q)|q ∈ Oe}, (26)
where distance(p, q) is the Euclidean distance between pixels p and q.
Fig. 3 shows the pectoral muscle borders of mdb005 constructed by MRA polynomials with different degrees to
demonstrate the performance in vision of the variation of the degrees of the MRA polynomials. Table 1 shows the
corresponding MOEs of Fig. 3. Table 1 illustrates that the pectoral muscle border constructed with degree one polynomial
for mdb005 is the worst, and the pectoral muscle border constructed with degree ten polynomial for mdb005 is the best.
Although both Fig. 3 and Table 1 show that the higher degree polynomial fitting functions have higher accuracy for pectoral
muscle border detection, they also show that the precisions of the pectoral muscle borders fitted by polynomials with
degrees more than four are almost the same. Hence, the degree five polynomial is taken as the optimal polynomial for
the proposed pectoral muscle segmentation not only to reduce the complexity and the time consumption, but also to obtain
the highly accurate segmentation.
To demonstrate the better performance of the proposed algorithm compared to the other related schemes, the scheme of
Ferrar et al. [14] is used as a comparison. The performance comparison between the proposed and the Ferrar et al. schemes
for the segmentation results for the 322 mammograms of the Mammogram Image Analysis Society (MIAS) database are
illustrated in Fig. 4, Tables 2 and 3.
Fig. 4 is given to compare the visual results obtained by using Ferrar et al. and the proposed schemes on six pectoral
muscles includingmammograms. In Fig. 4, row 1 shows the visualizations of six original mammograms for experiment, row
2 shows the corresponding ground truth of pectoral muscle labeled by an expert radiologist with hand carefully. Rows 3 and
4 show the corresponding segmentation results obtained by using the method of Ferrar et al. and the proposed algorithm,
respectively.
The pectoral muscle may appear on the mammogram as very small or very large, as convex or concave with different
curvatures as shown in Fig. 4(a)–(e). They were all segmented accurately to show that the proposed algorithm is adaptive to
variations in pectoral muscle size, density and curvature. Fig. 4(a)–(d) show that although the pectoral muscles are obscured
by tapes of different thickness, they were all segmented successfully. The results illustrate that the proposed segmentation
C.-C. Liu et al. / Computers and Mathematics with Applications 64 (2012) 1100–1107 1107
of Ferrar et al. are much larger than that for the proposed scheme. These facts indicate that the proposed method provides
more consistent results than the method of Ferrar et al.. The method of Ferrar et al. is very accurate for a straight line
segment pectoral muscle border. Since many mammograms’ pectoral muscle edge curves away from the chest wall toward
themiddle and lower-half of the images, the segmentation accuracy of pectoralmuscle in themethod of Ferrar et al. degrades
significantly while a mammogram pectoral muscle border is not a straight line segment. The proposed method takes an
additional step, the multiple regression analysis step, to modify the pectoral muscle border extracted by the iterative Otsu
thresholding scheme. Compared to the method of Ferrar et al., the accuracy is much higher in the proposed method. Table 3
shows that the proposed scheme can give precise extractions for pectoral muscles from mammograms.
4. Conclusions
Breast cancer is the most common cancer in women — which constitutes approximately 25% of all cancers in women,
and every one in eight women develop breast cancer. Successful treatment relies on early detection, and screening
mammography targeting high risk groups is a common practice in developed countries. Extracting the breast region
accurately from a mammogram is a kernel stage for mammography. The appearance of pectoral muscle in medio-lateral
oblique (MLO) views of mammograms can increase the false positives in the computer aided detection (CAD) of breast
cancer. For this reason, pectoral muscle has to be identified and segmented from the breast region in a mammogram before
further analysis.We have proposed an accurate and efficient algorithm to automatically segment the pectoralmuscle inMLO
mammograms. The proposed algorithm is based on the positional characteristic of pectoral muscle in a breast region and
combines the iterative Otsu thresholding scheme andmathematic morphological processing to find the rough border of the
pectoralmuscle. Themultiple regression analysis is then employed to overcome the limitation of the straight-line hypothesis
imposed by other algorithms to obtain the accurate segmentation of the pectoral muscle. The presented algorithm is tested
on 150 pectoral muscles including digital mammograms from the Mammogram Image Analysis Society (MIAS) database. In
the experiments, several measures of errors, such as mean error (ME1) function, misclassification error (ME2) function,
relative foreground area error (RFAE), extraction error rate (EER), region non-uniformity (NU), and modified Hausdorff
distance (MHD) were conducted to measure the performance of the proposed algorithm. With reference to the manually
demarcated pectoral muscle regions, the segmented regions provided by the proposed scheme resulted in low average
ME1, ME2, RFAE, EER and MHD with 1.7188, 0.0083, 0.0056, 0.0134 and 0.8702, respectively. The experimental results
show that the pectoral muscle extracted by the presented algorithm approximately follows that extracted by an expert
radiologist. The experimental results also show that the proposed scheme is adaptive to large variations in the appearance of
the pectoral muscle; it remains effectivewhen the pectoral border is obscured by superimposedmuscle tissue or artifacts. In
the future we will develop a high performance breast mass analysis based on accurate breast region segmentation to power
the computer aided detection of breast cancer.
Acknowledgments
This research was supported by the National Science Council R.O.C. under Grant NSC 100-2221-E-005-086 and NSC 100-
2221-E-167-028.
References
[1] G. Kom, A. Tiedeu, M. Kom, Automated detection of masses in mammograms by local adaptive thresholding, Computers in Biology and Medicine 37
(2007) 37–48.
[2] P. Delogu, M.E. Fantacci, P. Kasae, A. Reticoa, Characterization of mammographic masses using a gradient-based segmentation algorithm and a neural
classifier, Computers in Biology and Medicine 37 (2007) 1479–1491.
[3] A.R. Domiınguez, A.K. Nandi, Detection of masses in mammograms via statistically based enhancement, multilevel thresholding segmentation, and
region selection, Computerized Medical Imaging and Graphics 32 (2008) 304–315.
[4] J. Nagi, S.A. Kareem, F. Nagi, S.K. Ahmed, Automated breast profile segmentation for ROI detection using digital mammograms, in: 2010 IEEE EMBS
Conference on Biomedical Engineering & Sciences, 2010, pp. 87–92.
[5] R.D. Yapa, K. Harada, Breast skin-line estimation and breast segmentation in mammograms using fast-marching method, International Journal of
Biomedical Sciences 3 (1) (2008) 54–62.
[6] S.M. Kwok, R. Chandrasekhar, Y. Attikiouzel, M.T. Rickard, Automatic pectoral muscle segmentation onmediolateral oblique viewmammograms, IEEE
Transactions on Medical Imaging 23 (9) (2004) 1129–1140.
[7] Y.L. Feng, S.G. Lv, Unified approach to coefficient-based regularized regression, Computers and Mathematics with Applications 62 (2011) 506–515.
[8] V. Strijov, G.W. Weberb, Nonlinear regression model generation using hyperparameter optimization, Computers and Mathematics with Applications
60 (2010) 981–988.
[9] C.C. Liu, W.Y. Chen, Screw pitch precision measurement using simple linear regression and image analysis, Applied Mathematics and Computation
178 (2006) 390–404.
[10] S.S. Yu, C.Y. Tsai, C.C. Liu, A breast extraction scheme for digital mammograms using gradient vector flow snake, in: 4th International Conference on
New Trends in Information Science and Service Science, Gyeongju, Korea, 2010, pp. 715–720.
[11] K. Qin, K. Xua, F. Liu, D. Li, Image segmentation based on histogram analysis utilizing the cloudmodel, Computers andMathematics with Applications
62 (2011) 2824–2833.
[12] M. Sezgin, B. Sankur, Survey over image thresholding techniques and quantitative performance evaluation, Journal of Electronic Imaging 13 (1) (2004)
146–165.
[13] M.H. Horng, Performance evaluation of multiple classification of the ultrasonic supraspinatus images by using ML, RBFNN and SVM classifiers, Expert
Systems with Applications 37 (2010) 4146–4155.
[14] R.J. Ferrari, R.M. Rangayyan, J.E.L. Desautels, R.A. Borges, A.F. Frère, Automatic identification of the pectoralmuscle inmammograms, IEEE Transactions
on Medical Imaging 23 (2) (2004) 232–245.
 2 
摘要（200-300字） 
 Skeletal maturation estimation or bone age assessment of children is a common 
procedure performed in pediatrics. The bone age assessed by physicians could vary from 
time to time and the accuracy depends on physicians’ experiences. In order to provide a 
stable and more accurate bone age assessment, computer-assisted bone age assessment 
systems are employed. Once the epiphyseal fusion has started, the degree of fusion and 
texture features are analyzed. This paper presents an algorithm to extract and analyze the 
texture features of the regions of interest of phalanges in hand radiographs at the later stage 
in order to provide a stable and efficient later stage bone age assessment. The presented 
algorithm first uses wavelet transform to obtain three detail sub-bands from each region of 
interest. Then singular value decomposition is employed on each sub-band to extract the 
maximum likelihood feature, λ . Finally, support vector machine is applied for 
classification. Experimental results show that this algorithm can provide efficient and 
accurate later stage bone age assessment. 
 
 
 4 
目的 
出席國際學術研討會，與國際學者交流，瞭解新加坡特色，並發表論文：Later 
Stage Bone Age Assessment on Hand Radiographs。 
過程 
 半夜 2點開始出發前往搭車到桃園機場，出國開會並不輕鬆。出新加坡樟宜
機場後，先去稍微瞭解一下新加坡，發現其物價很貴，但其薪資所得比台灣
高。會議在 Holiday Inn的地下室一樓舉行，遇見許多台灣與大陸來的學者，
發現許多學者在參加會議這事兒上，都很打拼。發表論文倒也很快，與一些
學者討論一下下，就沒時間了。回程時在新加坡樟宜機場呆的時間較久，機
場大廳設計的漂亮、大方。 
心得及建議 
 兩岸學者似乎有個共同點，交流多了點，學術少了點。老師很努力，往往比
學生要努力許多。會議上聽到許多有趣、有意義的研究，但回台灣後，有能
力、有意願去做的學生真的不多。而在台灣努力從事研究這麼多年，獲得的
補助一點點，報告一堆。學生也一年不如一年，看來也只好度小月，忍點。 
 
(a) (b) (c) 
(d) (e)  
Later Stage Bone Age Assessment on Hand 
Radiographs
Yeong-Seng Yuh 
Department of Pediatrics 
Cheng Hsin Hospital 
Department of Pediatrics 
National Defense Medical Center 
Taipei, Taiwan 
yuhyeongseng@gmail.com.tw 
Chen-Chung Liu 
Department of Electronic Engineering 
National Chin-Yi University of 
Technology 
Taiping, Taichung, Taiwan 
ccl@ncut.edu.tw 
Jun-Dong Chang, Shyr-Shen Yu
*
Department of Computer Science and 
Engineering 
National Chung-Hsing University 
Taichung, Taiwan 
{phd9607, pyu}@nchu.edu.tw 
Abstract—Skeletal maturation estimation or bone age assessment 
of children is a common procedure performed in pediatrics. The 
bone age assessed by physicians could vary from time to time and 
the accuracy depends on physicians’ experiences. In order to 
provide a stable and more accurate bone age assessment, 
computer-assisted bone age assessment systems are employed. 
Once the epiphyseal fusion has started, the degree of fusion and 
texture features are analyzed. This paper presents an algorithm 
to extract and analyze the texture features of the regions of 
interest of phalanges in hand radiographs at the later stage in 
order to provide a stable and efficient later stage bone age 
assessment. The presented algorithm first uses wavelet transform 
to obtain three detail sub-bands from each region of interest. 
Then singular value decomposition is employed on each sub-band 
to extract the maximum likelihood feature, ӳ. Finally, support 
vector machine is applied for classification. Experimental results 
show that this algorithm can provide efficient and accurate later 
stage bone age assessment. 
Keywords-Bone age assessment, later stage, wavelet transform, 
singular value decomposition, support vector machine. 
I. INTRODUCTION
Bone age (BA) or skeletal maturation estimation is one of 
the important applications of hand radiography in the area of 
pediatrics, especially for the diagnosis of endocrinological 
problems and growth disorders [1]. In clinical practice, based 
on a radiological examination of a left-hand-wrist, the BA is 
assessed and then compared with the child’s chronological age. 
If a significant discrepancy is present, an abnormal skeletal 
development is suspected.  
Bone age assessment (BAA) is based on a radiographic 
image analysis of ossification centers of both the carpal bones 
and epiphysis of tubular bones including distal, middle, and 
proximal phalanges. Due to the variations in bony structures, 
the skeletal development in the metaphyseal and epiphyseal 
regions is divided into two stages: the early and the later stages. 
Epiphysis usually ossifies after birth. At the early stage of 
skeletal development, as the age increases, the bony penetration 
advances from the initial focus (Figure 1(a)) in all directions 
(Figure 1(b)) and the epiphysis increases in width and thickness 
(Figure 1(c)). In the later stage, the gap between the epiphysis 
and metaphysis is diminished gradually (Figure 1(d)). The gap 
disappears completely at the completion of growth (Figure 
1(e)), when the epiphysis and metaphysis fuse into an adult 
bone. There are different feature extraction problems which 
have to be solved at various stages of skeletal development. In 
the early stage, the size and shape of epiphysis is of high 
discrimination power for features describing. The image 
analysis on the regions of interest (ROI) is subjected to a 
feature extraction procedure, which separates the epiphysis and 
metaphysis from the soft tissue. In the later stage, the degree of 
fusion must be considered. A wavelet analysis is used when the 
epiphyseal fusion has started [2, 3]. It has been reported in 
many studies that features of carpal bones for bone age 
assessment are significant and valuable only for the analysis of 
skeletal development at the early stage [4–6]. Studies are 
undertaken by image analysis of the phalangeal regions at the 
later stage. The studies of carpal bones [6] and of phalanges at 
the early stage are out of the scope of this paper and left to our 
future work. 
Figure 1. Regions of interest of epiphysis/metaphysis at various skeletal 
development stages. 
The clinical bone age assessed by physicians could vary 
from time to time. To achieve the accuracy and consistency, 
computer-assisted bone age assessment (CABAA) systems are 
considered. In a CABAA system, features extracted from the 
This research was supported by the National Science Council R.O.C. 
under Grant NSC 100-2221-E-005-086 and NSC 100-2221-E-167-028 
1326978-1-4577-2119-9/12/$26.00 c©2012 IEEE
                                   
where C is the number of columns of Nr, si is the ith singular 
value in Σr. Then, a maximum likelihood feature, λ-feature, is 
extracted by: 
                                    ,/
1
¦
=
=
n
i
isnλ  (8) 
where si is the ith singular value in Σr. As there are 3 detail sub-
bands of each EMROI and 9 EMROI of a hand radiograph, 27 
λ-features are extracted from a hand radiograph. 
III. PRINCIPLE OF SUPPORT VECTOR MACHINE
A supervised classifier, support vector machine (SVM), 
proposed by Vapnik and Collaborators [16] is a common used 
classifier. Let a sample dataset be described as: 
( ){ } { },1,1,x,,,2,1|,x −∈∈== imiii yRliyS !             (9) 
where xi = (xi1, xi2, …, xim) is the ith input pattern with m tuples; 
and yi is the class label for xi. Then, SVM finds a hyper-plane 
H for S as the following: 
                                    ,0x: =+⋅ bwH Ti  (10) 
where T is the transpose operation, w = (w1, w2, …, wm) is the 
weight vector, and b is a bias. In order to get an optimal value 
for (w, b) to maximize the margin ρ which is 1/||w||2 between 
wxi + b = 1 and wxi + b = –1, the optimal value for (w, b) can 
be obtained by solving the follow condition: 
( ) ( ){ }liby TiiT ,,2,1,1wx|ww2/1min !=≥+        (11) 
The condition is also called prime problem, we can use the 
Karush-Kuhn-Tucker (KKT) theorem and LaGrange multiplier 
method to solve the dual problem as follow: 
( )
1 1 1 1
1
max x ,x | 0, 0 ,
2
l l l l
i i j i j i j i i i
i i j i
y y K yα α α α α
= = = =
­ ½
− = ∀ ≥® ¾
¯ ¿
¦ ¦¦ ¦  (12) 
where αi denotes Lagrange multipliers associated with Eq. 
(12), K(xi,xj) is the kernel function. Finally, the optimal 
decision function f (x) is given as: 
                        ( ) .xxsignx
1
¸
¹
·¨
©
§
+= ¦
=
byf Tii
l
i
iα  (13) 
IV. EXPERIMENTAL RESULTS
21 hand radiographs at the later stage (from 7 years old to 
12 years old) are used for evaluations, which are provided by 
the Taichung Veterans General Hospital. 27 detail sub-bands 
are obtained from a hand radiograph. And, a ӳ-feature set is 
extracted from these 27 detail sub-bands. Finally, support 
vector machine (SVM) inputsӳ-feature sets for classification. 
21 hand radiographs are divided into two sets; the first 14 
images are used for training, and the remaining 7 images are 
used for testing in this scheme. The 3-fold cross validation is 
used to avoid the overtraining due to the limited experimental 
data during the training phase. 
The kernel used in SVM is the Gaussian radial basis 
function. The performances of BAA systems (BAAS) using 
SVM, neural network, Bayes, nearest neighbor classifiers are 
compared and listed in the following: 
TABLE I. THE AVERAGE ACCURACY OF BAAS USING DIFFERENT 
CLASSIFERS
Age 
Classifiers 
SVM 
Neural 
 Network 
Bayes 
Nearest 
Neighbor 
7 years 
old
98.24% 90.58% 75.46% 61.32% 
8 years 
old 
92.47% 91.38% 67.35% 54.38% 
9 years 
old 
94.01% 85.94% 72.09% 64.61% 
10 years 
old 
92.58% 86.41% 53.54% 57.24% 
11 years 
old 
89.80% 82.48% 60.51% 58.97% 
12 years 
old 
87.36% 78.25% 74.31% 45.92% 
Average 92.41% 85.84% 67.21% 57.07% 
Furthermore, the performances of BAAS using ӳ-feature, 
Pietka et al.’s wavelet features [11], gray-level co-occurrence 
matrix (GLCM) [17] and Wavelet statistical features-Wavelet 
co-occurrence features (WSF-WCF) [18] are compared and 
listed in Table II. 
TABLE II. THE AVERAGE ACCURACY OF BAAS USING DIFFERENT 
FEATURE SETS BY SVM CLASSIFIER
Age 
Features 
ӳ-feature Pietka et al. 
[11]
GLCM [17]
WSF-WCF 
[18]
7 years 
old
98.24% 88.45% 75.46% 80.21% 
8 years 
old 
92.47% 84.53% 67.35% 81.34% 
9 years 
old 
94.01% 83.78% 72.09% 73.19% 
10 years 
old 
92.58% 80.34% 53.54% 71.87% 
11 years 
old 
89.80% 79.72% 60.51% 65.74% 
12 years 
old 
87.36% 76.20% 74.31% 64.20% 
Average 92.41% 82.17% 67.21% 72.76% 
V. CONCLUSIONS
In this paper, a bone age assessment system for hand 
radiographs at the later stage is presented. This system uses 
1328 2012 7th IEEE Conference on Industrial Electronics and Applications (ICIEA)
國科會補助計畫衍生研發成果推廣資料表
日期:2012/10/21
國科會補助計畫
計畫名稱: 以指骨特徵為主之手掌X光影像骨齡估測系統之研究
計畫主持人: 喻石生
計畫編號: 100-2221-E-005-086- 學門領域: 圖形辨識
無研發成果推廣資料
其他成果 
(無法以量化表達之
成果如辦理學術活
動、獲得獎項、重要
國際合作、研究成果
國際影響力及其他協
助產業技術發展之具
體效益事項等，請以
文字敘述填列。) 
無 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
