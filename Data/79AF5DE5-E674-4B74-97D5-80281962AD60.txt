based classifiers are better than the BPN based 
classifier. The C5.0 decision tree is better than the 
other decision trees in large sample size. On the 
contrary, the CHAID decision tree is better in small 
sample size. In additions, the Apriori algorithm, 
considering both minimum support and minimum 
confidence precision rate of 100% for the case of CC, 
truly can raise the overall accuracy rate.  
 
英文關鍵詞： DRGs, data mining, expert systems, 
gastroenterological 
 
 2 
 
獻及專家討論找出相關因子，並將資
料分為 80%訓練資料與 20%測試資
料，第一階段以倒傳遞類神經建構預
測的模式及決策樹來萃取規則；另一
部份則是針對有 CC 的規則，利用
VPRS 及關聯規則找出有 CC 的規則，
進行第二階段篩選，最後再建立規則
知識庫，並進行專家系統之建立。如
圖 1 所示： 
 
圖 1 研究架構圖 
2.2  資料收集 
首先經由健保局資料庫蒐集民國
97 到 98 年外科手術的資料，經篩選後
所收集的腸胃科手術有三種，分別為
肛門手術、闌尾切除術及腹腔鏡膽囊
切除術，個別的樣本筆數為：肛門手
術的樣本筆數為 15471 筆，有 CC 的筆
數為 1766 筆，無 CC 的筆數為 13707
筆；闌尾切除術的樣本筆數為 2265
筆，有 CC 的筆數為 739 筆，無 CC 的
筆數為 1526 筆及腹腔鏡膽囊切除術的
樣本筆數為 226 筆，有 CC 的筆數為
32 筆，無 CC 的筆數為 194 筆。收集
的項目為主要診斷、次要診斷、主要
手術、次要手術、性別及診療項目及
費用共23個輸入因子及有CC及無CC
兩組輸出因子。 
2.3 模型建構 
本論文模型建構共分為兩大階
段，第一階段先利用倒傳遞類神經網
路建立判定是否有 CC 預測模型，且再
利用決策樹 C5.0、C&RT 及 CHAID 演
算法萃取分類規則，相互比較選出最
佳的分類規則，再進行第二階段的篩
選；第二階段主要目的在於提昇準確
率，利用關聯規則及 VPRS 萃取出有
CC 的分類規則，之後在二次篩選，期
望能降低將原本可分類至有 CC 結果
卻誤判成無 CC 的情形，最後經分析比
較及與專家討論後找出最佳分類規
則，建置專家系統。 
本研究使用Clemenine12.0計算倒
傳遞類神經網路、C5.0、C&RT、CHAID
決策樹及關聯規則 Apriori，而可變精
確度粗集合(VPRS)則是使用 Matlab 程
式語言進行撰寫 。 
3. 研究結果 
3.1.1 肛門手術第一階段研究結果 
進行比較後得知，決策樹 C5.0 皆
優於其他方法，因此本研究將選定決
策樹 C5.0 研究分類結果，再進行第二
階段篩選，表 1 與表 2 為訓練與測試
的正確率。萃取出 46 條分類規則，本
研究將部分呈現，如表 3。 
表 1 肛門手術第一階段訓練 
 
表 2 肛門手術第一階段測試 
 4 
 
選自第一階段表現最佳的決策樹
C5.0 研究結果中判定無合併症/併發症
的資料，利用 VPRS 及關聯規則所萃
取的分類規則進行第二階段的篩選，
經比較過後可將第一階段訓練中 4 筆
原本被誤判無 CC 成功判斷正確；可將
測試中3筆原本被誤判無CC成功判斷
正確。表 9 與 10 為訓練與測試混淆矩
陣。 
表 9 闌尾手術訓練樣本混淆矩陣 
 
表 10 闌尾手術測試樣本混淆矩陣 
 
3.3.1 腹腔鏡手術第一階段研究結果 
進行比較後得知，決策樹 CHAID
皆優於其他方法，因此本研究將選定
決策樹 CHAID 研究分類結果，再進行
第二階段篩選，表 11 與表 12 為訓練
測試之正確率。其萃取出 4 條分類規
則，本研究將部分呈現，如表 13。 
表 11 腹腔鏡手術第一階段訓練 
 
表 12 腹腔鏡手術第一階段測試 
 
表13 腹腔鏡手術第一階段分類規則 
Rule 1 for  N    
 if 次診斷1 in [ 29620 4029 4292]  
     and 放射線診療費 <= 0  
     then N  
Rule 2 for  Y    
 if 次診斷1 in [29620 40290 4292 ]  
     and 放射線診療費 > 0  
     then Y  
3.3.2 腹腔鏡手術第二階段研究結果 
    由於第一階段決策樹CHAID所萃
取出的分類規則包含於第二階段
VPRS 及關聯規則，且第一階段在訓練
整體準確率已達 100%、測試整體準確
率也高達 96.49%，改善空間有限，因
此結果與第一階段雷同。雖然未能提
升其準確率，但冀望兩階段分類規則
結合，在未來驗證部分能達到準確率
的提升。 
3.4 專家系統的建置 
    本研究利用 Visual C#來建立胃腸
科合併症/併發症判別系統，經由兩階
段 人 工 智 慧 方 法 所 萃 取 出 來 的
「IF..Then」規則建立規則知識庫，主
要欄位為各個手術判定合併症/併發症
關鍵因子，例如肛門手術的關鍵因子
為：主要診斷、次要診斷 1~4、主要手
術、次要手術 2、藥費、檢查費、特殊
材料費、治療處置費、性別等 12 個關
國科會補助計畫衍生研發成果推廣資料表
日期:2012/07/06
國科會補助計畫
計畫名稱: 應用資料探勘技術於健保疾病碼與DRGs碼分類之研究(I)
計畫主持人: 侯東旭
計畫編號: 100-2221-E-224-061- 學門領域: 服務系統與科技管理
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
研究成果已跟合作的醫院主管報告過,提供該醫院參考. 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
