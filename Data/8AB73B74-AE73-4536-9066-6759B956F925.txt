 2
which mean each machine can process any jobs and 
have the same performance. For the second problem, 
this project tries to apply genetic algorithm to generate 
Pareto solutions which can be references and support 
production managers to choose a satisfactory solution. 
The third problem discusses a generalization case 
where machines have different processing 
performances due to type, purchasing year etc., and is 
widely found in many plant factory. For the third 
problem, this project presents different meta-heuristics 
such as simulated annealing, genetic algorithm to 
solve it. Finally, this project will conduct different 
computational experiments to test the proposed 
algorithms and compared it with other algorithms. 
 
Keywords: sequence-dependent setup times, 
scheduling, multi-objective, greedy 
randomized adaptive search procedure, 
genetic algorithm 
 
三、緣由與目的 
 
隨著時代巨輪轉動所帶來的時空環境因素變
化以及科技創新之不斷激勵，消費者不但能夠輕易
地藉由多元、普及化的資訊傳媒快速地接收來自於
全球最新的產品訊息。另外，消費者也隨著供需互
動關係的調整，轉而抬頭成為具有主導市場能力的
顧客導向優勢地位。在這樣的經營條件狀況下，企
業除了必須迎合顧客需求、消費型態轉變等外在環
境因素的變化之外，尚且需要面臨來自於自由貿易
風潮下所帶來全球同業間弱肉強食激烈競爭的殘
酷事實。因此，企業為了確保維持本身的競爭優勢
條件而擬定爭取顧客訂單之訴求項目，也從過去單
一的價格項目訴求擴充到品質甚至於達到滿足顧
客各項需求的複雜多樣訴求。在此背景環境之下，
管理者不僅需要憑藉著過去豐富的經驗之外，更要
結合現代化各項科技技術來提昇企業本身的競爭
優勢，生產管理者已經不能單靠經驗或直覺的判斷
來處理問題，而是要發展解決問題的模式與方法並
藉助一些現代化的電腦科技與演算方法來迅速地
找出最適的解決方案，藉以提昇整體生產管理的績
效，這是一項攸關能否永續經營的重要課題。 
在生產管理課題中，如何將不同的工作安排其
加工順序於機器上進行處理作業，以便獲致較佳的
工作效率並降低生產成本是屬於生產排程的領域
問題。有效率的生產排程不但可以提高工作效率以
及降低生產成本，而且還能提高顧客的服務水準以
及市場的反應能力與競爭優勢。 
一般教科書與期刊上探討瓶頸排程問題的文
獻中，不管是單機或是平行機台的生產環境大部分
均屬於靜態排程(static scheduling)的問題，其基本
的前提假設是所有工作的釋放時間(release time)必
須同時抵達生產系統而且時間均為零。然而在實際
的生產環境中，工作大部分是具有不同的釋放時間
特性，亦即所有的工作並非一次全部同時抵達生產
系統，而是陸陸續續地釋放到生產系統當中。除此
之外，過去的生產排程研究者常常為了簡化其問題
的複雜程度，因而假設整備時間跟工作的加工順序
沒有任何地關連，所以可以將此整備時間合併計入
到加工處理作業時間之內。然而在實務上，順序相
依(sequence-dependent)整備時間的考量卻是更能符
合實際的生產作業環境需求。例如射出成形的加工
處理作業中，訂單或工作會隨著生產計畫所規劃的
時間釋放到生產系統之中。此外，射出成形機台也
會依據前一個加工工作與即將處理工作的差異性
來決定是否需要更換模具或材質配方，因此工作的
整備時間長短就會隨著工作的順序而有所差異。還
有在現代化製藥(modern pharmaceutical)產業中，製
藥廠通常是採取相同的儀器設備（反應槽、萃取儀
器、噴霧造粒、研磨設備、薄膜濃縮等…）來操作
處理加工不同的工作(jobs)或藥品(medicine)。每一
種藥品的加工作業時間長短會隨著藥品本身的成
份配方與特性而有所差異之外，其中最特別的是這
些儀器設備在操作各項工作之前必須執行一些諸
如清洗、調校與設定操作參數等項之整備作業，此
項整備作業的耗費時間會隨著前一項工作或藥品
內容而有所差異，因而形成前面所描述的順序相依
整備時間現象。除此之外，在實際的生產環境中生
產工作也是陸陸續續地將製藥原料準備妥當後釋
放到藥品製造工廠內進行後續的加工處理作業。 
目前有關於順序相依整備時間的排程問題探
討研究上，佔整體的排程研究數量比例上並不多。
其主要的原因並非是實務的應用性不大，而是受到
其複雜度以及困難程度過高的影響。然而，由於科
技的進步與發展使得組合最佳化 (combinatorial 
optimization)問題在求解的知識與工具上均有突破
性的進展。受到此項因素的激勵下，近年來已經逐
漸有一些排程研究朝向順序相依整備時間的課題
探討。有鑑於此，本研究計畫將針對此種工作具有
釋放時間以及順序相依整備時間之排程問題作深
入的研究與探討。 
過去在有關的工作具有釋放時間以及順序相
依整備時間之排程問題文獻中，絕大多數只探討諸
如所有工作完工時間點(makespan)最小化、總流程
時間 (total flow time)最小化或總遲交時間 (total 
tardiness)最小化之單一評估準則的問題，並且以此
評估準則轉成管理績效之目標函數藉以作為排程
決策的唯一參考依據。然而在一般的實務應用上，
決策者在評估解決方案時卻往往不只單純地參酌
一項管理績效目標來制訂決策。在這種狀況下，如
果仍然倚靠只考慮單一管理績效目標模式下所獲
得的生產排程計畫，儘管在此條件狀況下根據此管
理績效目標所獲得的生產排程計畫是最佳解，但是
對於需要考量其他管理績效目標的決策目標而
言，此生產排程計畫卻是不見得也會是最佳解，甚
至於可能是一組很差的生產排程計畫。因此在生產
排程計畫問題中，同時將多項管理績效目標納入一
併考量是有其必要性。本計畫將同時考量機器產能
 4
在現今多變的競爭環境中，企業在降低成本與
提高品質等兩項傳統管理績效目標主軸下，提供物
美價廉的產品給顧客似乎只是滿足顧客基本需求
的必備條件，影響顧客滿意的關鍵因素之一則是來
自於是否能夠如期的交貨。一份良好的排程計畫不
但能夠減少資源的閒置時間以及降低在製品存貨
水準之外，更可以使工作能夠如期的完成，進而滿
足顧客的交期需求。 
在生產排程研究中，為了達到使機器設備產能
利用率(utilization)提高的管理績效目標，通常是將
目標函數設定為所有工作完工時間點(makespan)最
小化。要達到降低在製品存貨水準以便降低製造生
產成本的目的，常用的評估準則是將目標函數設定
為總完工時間最小化。但是基於每一件工作的重要
性或價值不盡相同，因此需要針對每一個工作給予
不同的加權係數值，因而將目標函數修正為總加權
完工時間(total weighted completion time)最小化。至
於滿足顧客交期的要求(due date commitment)藉以
提高顧客滿意程度的管理績效目標，通常是將目標
函數設定為總加權遲交時間(total weighted tardiness)
或總加權遲交件數(total weighted number of tardy 
jobs)。 
在過去文獻中絕大多數只探討諸如前面所述
之所有工作完工時間點(makespan)最小化、總流程
時間 (total flow time)最小化或總遲交時間 (total 
tardiness)最小化等…之單一管理績效目標的問
題，並且以此評估準則轉成目標函數藉以作為排程
決策的唯一參考依據。然而在一般的實務應用上，
決策者在評估解決方案時卻往往不只參酌一項管
理績效目標來制訂決策。在這種狀況下，如果仍然
倚靠只考慮單一管理績效目標模式下所獲得的生
產排程計畫，儘管在此條件狀況下根據此管理績效
目標所獲得的生產排程計畫是最佳解，但是對於需
要考量其他管理績效目標的決策目標而言，此生產
排程計畫卻是不見得也會是最佳解，甚至於可能是
一組很差的生產排程計畫。因此在生產排程計畫問
題中，同時將多項管理績效目標納入一併考量是有
其必要性。 
本研究計畫係探討 n 個具有非同時釋放（或抵
達）時間的工作經由特定單一機台來進行加工作
業，每一個工作在機台加工作業之前需要執行諸如
清洗、置換夾模治具或調整機台設定參數等相關的
整備(setup)作業，其整備時間長短會受到加工順序
的影響。除了上述的問題描述之外，本計畫的各項
前提假設說明於后。 
1. 所有工作的釋放時間、加工時間以及順序相依
整備時間的矩陣表均為確定值(deterministic)且
已知； 
2. 每一個工作的價值或重要性（亦即加權係數值）
均為已知； 
3. 機台同時間最多只能加工一個工作，並且不允
許佔先或掠奪(non-preemptive)情形發生； 
4. 在排程規劃期間假設機台不會發生故障。 
本計畫係針對單機具有釋放時間以及順序相
依整備時間之環境特性，透過權重法來整合多項管
理績效目標使之成為單一目標。在此狀況下，構建
一個數學規劃模式來解決此一特定之排程問題。為
了方便說明此數學規劃模式，茲將模式中所使用到
之符號定義說明於后。 
已知變數： 
n  ：工作個數 
jr  ：工作 j 的釋放時間； nj ,...,3,2,1=  
jp  ：工作 j 的加工時間； nj ,...,3,2,1=  
jd  ：工作 j 的交期時間； nj ,...,3,2,1=  
js0  ：工作 j 安排在第一個加工順序時，所需執行
的整備時間； nj ,...,3,2,1=  
ijs  ：工作 j 緊接在工作 i之後進行加工時，所需執
行的整備時間； ni ,...,3,2,1= ； nj ,...,3,2,1= ； ji ≠  
jw1  ：工作 j 完工時間的加權係數值； nj ,...,3,2,1=  
jw2  ：工作 j 遲交時間的加權係數值； nj ,...,3,2,1=  
jw3  ：工作 j 遲交所需承受的懲罰係數值；
nj ,...,3,2,1=  
ψ  ：很大的正整數 
α  ：針對所有工作完成時間點最小化的管理目標
所給予的偏好值 
β  ：針對總合加權完工時間最小化的管理目標所
給予的偏好值 
γ  ：針對總合加權遲交時間最小化的管理目標所
給予的偏好值 
λ  ：針對總合加權遲交件數最小化的管理目標所
給予的偏好值 
決策變數： 
kR  ： 第 k 個 加 工 順 序 工 作 的 釋 放 時 間 ；
nk ,...,3,2,1=  
kS  ：執行第 k 個加工順序工作前所需的整備時
間； nk ,...,3,2,1=  
kP  ： 第 k 個 加 工 順 序 工 作 的 加 工 時 間 ；
nk ,...,3,2,1=  
kA  ：第 k 個加工順序工作可以開始加工作業的時
間； nk ,...,3,2,1=  
kC  ： 第 k 個 加 工 順 序 工 作 的 完 工 時 間 ；
nk ,...,3,2,1=  
jC  ：工作 j 的完工時間； nj ,...,3,2,1=  
jT  ：工作 j 的遲交時間； ),0( jjj dCMaxT −= ；
nj ,...,3,2,1=  
jU  ：工作 j 是否有遲交； nj ,...,3,2,1=  
 
⎪⎩
⎪⎨
⎧
≤−=
>−=
00
01
jjj
jjj
dCifU
dCifU
 
k
jX  ：工作 j 是否被安排在第 k 個加工順序進行加
工； nj ,...,3,2,1= ； nk ,...,3,2,1=  
 
 6
時間之因素，因此採取非延遲的觀念來事先過濾掉
一些可能會造成機器長時間空閒(idle)的狀況。除此
之外，基於順序相依整備時間的特性，因而提出一
個新的判斷優先執行順序的指標，透過此項指標將
可以增加判斷排程順序的正確性。整個啟發式演算
法的虛擬程式碼(pseudo code)如下所示，複雜度經
過分析後為 )( 3nO 。 
演算法的虛擬程式碼： 
set 1←k , IJSCJS ← , { }φ←AJS , 0←ρ , 0←C  
set 0←Z , 01 ←Z , 02 ←Z , 03 ←Z , 04 ←Z  
while ( { }φ≠CJS ) do 
 ∞←t  
 for (each CJSi∈ ) do 
  if ( tri < ) 
   irt ←  
  end if 
 next for 
 ( )CtMAXC ,← , { }φ←WJS  
 for (each CJSi∈ ) do 
  if ( Cri ≤ ) 
   { }iJWJSWJS ∪←  
  end if 
 next for 
 0←Index  
 for (each WJSi∈ ) do 
  if ( Index
sp
w
ii
i >+ ρ
) 
   
i
i
sp
wIndex
i ρ+
← , i←π  
  end if 
 next for 
 ρππ spCC ++← , { }πJAJSAJS ∪← , 
{ }πJCJSCJS \←  
 if( Cd <π ) 
  πdCT −← , 1←U  
 else 
  0←T , 0←U  
 end if 
 CwZZ ⋅+← 122 π , TwZZ ⋅+← 233 π , 
UwZZ ⋅+← 344 π  
 πρ ← , 1+← kk  
end while 
CZ ←1 , 4321 ZZZZZ ⋅+⋅+⋅+⋅← λγβα  
演算法的符號定義： 
 IJS  ：啟使的工作串列集合 
 CJS  ：候選的工作串列集合 
 WJS  ：篩選後的工作串列集合 
 AJS  ：已經列入排程的工作串列集合 
組合最佳化(combinatorial optimization)的問題
中，貪婪隨機調適搜尋程序演算法 (Greedy 
Randomized Adaptive Search Procedure, GRASP)是
一種常用的有效率解決手法。每次貪婪隨機調適搜
尋的程序當中均包含有兩的階段，其中一個是建構
階段(construction phase)以及另外一個局部搜尋階
段(local search phase)。基本上建構階段具有重複執
行、貪婪進行以及可調適之特性，因此每次過程均
可能建立產生一組不同的可行解。本計畫研擬的建
構階段是利用上述啟發式演算法之指標判斷值計
算式作為貪婪函數，經由貪婪函數計算每一個候選
工作的指標判斷值並且透過適當的函數轉換成被
挑選中的機率值，形成一個不均勻的俄羅斯轉盤，
然後再依據產生的隨機亂數來判斷決定下一個作
業順序之工作。至於局部搜尋階段，本計畫則是預
計運用最為單純的兩兩交換(pair-wise interchange)
來改善建構階段所產生的可行解。整個演算法的程
序架構，表達成如下之虛擬碼。 
);__(}
;__
)_(
;_
)_(
);(int__
();_
{
;__
();_
falseflagconditionstopwhile
trueflagconditionstop
conditionstopsatisfiedif
ysolutionbest
solutionbestyif
xerchangewisepairy
phaseonconstructix
do
falseflagconditionstop
heuristicsolutionbest
=
=
=
<
=
=
=
=
 
 
六、研究成果與結論 
   
本計畫係針對工作具有順序相依整備時間與
釋放時間之單機排程問題環境，同時考量機器產能
利用率 (utilization) 、在製品存貨水準 (work in 
process, WIP)以及交期績效(due date commitment)
等管理績效目標，將決策者對於每一項管理績效目
標的偏好予以加權並且透過權重法構建出一個數
學規劃模式。數學規劃模式雖然均可以獲致最佳
解，然而此問題被證實是屬於 NP-Hard 的特性使得
當問題之工作數目一旦增多時，數學規劃模式所藉
助的 ILOG OPL Studio 3.7 最佳化求解套裝軟體便
無法在可容忍的時間（設定為兩個小時）內執行完
畢。因此基於求解效率的考量因素下，本計畫同時
亦提出一個複雜度為 ( )3nO 的啟發式演算法，透過
此啟發式演算法的電腦程式運算，使用者可以非常
迅速地獲得一組可行解。為了驗證此啟發式演算法
的求解品質狀況，本計畫乃運用電腦隨機產生的各
種測試數據範例分別執行啟發式演算法的電腦程
式以便獲致各種可行解，透過這些結果來瞭解求解
速度以及經過整合之後的目標函數值整體成效。同
時為了改善單一啟發式演算法求解品質的成效，本
計畫也應用貪婪隨機調適搜尋程序演算法來進行
整體最佳化的搜尋求解。經由上述之研究過程，目
前已經能夠獲致一個可以迅速、穩定且求解品質不
錯的演算法，並且將此研究的部分成果撰寫成論文
