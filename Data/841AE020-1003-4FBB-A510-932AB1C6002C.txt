2融入萃取提昇型結構於強韌複數型卡爾曼濾波器之電力系統頻率偵測
Embedded the Structure of Lifting Scheme in Robust Extended Complex
Kalman Filter for Detection of Distorted Signals on Power Systems
摘要
本計畫提出萃取提昇型結構融入於強韌性複數型卡爾曼濾波器以提高在電力系統
之基頻的估測，並可依此基頻求出系統電壓之振福及相位，以利系統電壓之參數應用於分
散式配電系統之監控。由於本計畫所提出之萃取提昇型結構可以及時及線上對輸入訊號作
正確的前置篩選，因此可增加強韌性複數型卡爾曼濾波器對系統電壓參數的估測效果，並
可藉此提高濾波器對雜訊及其他干擾訊號的免疫能力。本計畫除了應用於模擬訊號作測
試，已驗證所提方法的可行性，同時亦應用於工廠的實際訊號，以測試本計畫所提方法的
實用性。
關鍵詞：基頻估測、系統電壓參數、發散式配電系統、融入萃取提昇型結構、強韌性複數
型卡爾曼濾波器。
4一、前言
在電力系統的運轉及應用中，無論在發電、輸電或是配電系統中，系統基頻的頻率變
化常透露許多與系統運轉有關的重要訊息。而各系統的控制應用中，如何固定基頻的頻率
也是一項很重要的工作。例如假若基頻頻率的突降、突昇，其意味可能是供電與負載間匹
配不一致所產生的問題、或是系統故障的發生、或是負載突然劇降或加重所導致。另外基
頻頻率也可能因為孤島效應的發生而緩慢下降。因此之故，系統基頻頻率不正常的變化往
往透露出系統運轉有不良因子的存在。所以一般而言，電力公司即訂定基頻頻率變化的上
下限，作為制訂應變措施的準則，冀望使系統受到最低的傷害，以免處置不良而導致整個
系統的崩潰。又目前許多電力系統的相關設備中，亦常利用基頻頻率的偵測判定系統運轉
是否正常。若對於不正常的運轉，相關設備會藉此偵測的結果作相關應變措施，例如斷路
器即常藉由頻率的偵測決定系統是否不正常而需要跳開，自動電壓調整器亦是藉由頻率偵
測決定電壓是否需要補償。除此此外，在訊號的振幅及相位的演算法中，其計算準確與否，
又決定於頻率偵測的準確性。有此可見，基頻頻率的偵測在電力系統應用中，其重要性可
見一斑。
二、研究目的
然而在實際應用於分散式電源系統中，基頻頻率的偵測亦是一個相當重要的角色，若
就其原因可由下列數例中予以窺知。
然應用分散式電源系統的優點是為了可增加電力系統的可靠度和電力品質、以及增加
電壓調節的能力、減少輸配電系統損失、減少輸配電系統壅塞以提高供電效率、減緩系統
的設備的新建或既有設備的更新、舒緩供電壓力，但是這些效益必須在分散型電源和電網
良好的配合下始能呈現其正面的功能。反之若配合不良則對電力業者及用戶和分散型電源
業者都有負面的影響。至於系統間的配合是否良寙則基頻頻率的變化即是一項重要的指
標。例如若有大型分散式電源加入一般輸配電系統中，其電壓調節常因部分分散型電源發
電的不穩定性（如風力發電）而發生困難。因為在配電系統不同的阻阬下分散型電源和電
壓調整器互相作用，使供電系統的電壓及其基頻受其影響而變化不定，漂離正常額定的範
圍，造成電壓閃爍的現象。
又如在一般電力系統保護之研究中，當市電網路跳脫後，若負載用電量與分散式發電
系統供電量之差異頗大時，用戶端的電壓與頻率均會出現較大的擾動，故系統保護電驛能
夠即時檢知，進而與市電網路解除併聯，但當發電系統與負載間之電力供需幾近平衡時，
系統保護電驛可能無法予以偵測，以致未能切離市電系統，此種情形特別容易發生於形成
電力孤島時。
由上述各項討論所述，分散式電源和電力系統間的相互影響，即需藉由可靠的監測系
統對基頻作線上、及時的量測及計算，可藉由計算的結果對系統給予最適當的處置。然而
一般所量得的量測數據主要是電壓波形的瞬間值，因此一個快速、及時且精確的演算法，
可將電壓波形的瞬間值，計算得其基頻的頻率值，就顯得異常需要。
然而一般量測所得的電壓波形均含有雜訊、干擾訊號、諧波等因素，因此在計算基頻
的演算法時，常受到這些不良因素影響，而無法有精確值的表現，甚至無法收斂。所以如
何建立一個有效且強韌的演算法，一直是這項領域所研究的目標。
三、 文獻探討
對於系統基頻的演算法在過去文獻中，已被相繼提出，其主要的方法是將波形之訊號
作快速傅利葉轉換而得基頻頻率[1-4]。但此方法由於有洩漏效應及柵欄效應等不利因素，
又加上取樣定理的限制，致使此方法在估測頻率時，其準確性並不高。雖然有相關文獻[5]
利用 Prony 方法加以改善，但因為訊號本身非純粹為正弦波，致而效果有限，故而隨後有
狀態估測的方法被提出[6-12]。而所謂狀態估測是藉由電力系統之各項量測值，應用機率
統計準則估測系統的狀態變數值。過去的文獻所提[7,8]狀態估測是利用最小平方法為基
6圖 1 所示，就是將卡爾曼濾波器應用在基頻偵測時所遇上的相關問題，及過去文獻中如何
解決這些問題的梗概示意圖。如圖所示，量測公式的非線性可藉由複數型的狀態變數予以
簡化為線性的量測公式。對於量測值的變動，可由強韌演算法加以改進。而諧波因素則需
藉由本計畫所提之萃取提昇型結構(lifting scheme)的方法予以抑制之。
圖 1：卡爾曼濾波器應用的問題及解決方法的示意圖。
近年來小波轉換(Wavelet transform)之應用甚為廣泛，此轉換技巧可利用窗型函數限制
時域之寬度，並依高、低頻訊號而自動調變，因此有區域性的特性於時域及頻域間的轉換，
故而優於傅利葉轉換，因此其應用相當廣泛，諸如影音壓縮、訊號分析、資料偵測及量測
等方面均有許多文獻提出相關研究成果[13,14] 。然在小波轉換演算法的應用中，其主要特
性可將訊號分解成不同頻率的成分，亦可將不同頻率的成分予以組合，此即為時域多層解
析 (Multiresolution Time Domain; MTR)，也就是將一個訊號分解成許多低解析度
（Low-resolution components）的組成。例如以離散小波轉換 (Discrete Wavelet Transform，
DWT) [13]的轉換架構主要是由一對低頻濾波器與高頻濾波器所組成。而本計畫即提出第
二代小波轉換的萃取提昇型之結構應用於強韌性複數型卡爾曼濾波器，以期提升基頻偵測
的效能。萃取提昇型結構是一個以空間為定義域的雙正交小波的結構，此法首度由斯瓦德
(Sweldens)於 1996 年所提出[15-16]。此法與傳統小波轉換比較具有數項的優點，即快速的
演算法，具有非線性的能力，對時間及空間可作不規則的取樣，可選擇適當空間作計算，
可作適應性的設計。因此之故本計畫選擇此結構作訊號偵測的前級處理。其功能是將輸入
訊號作進一步的篩選，以減少諧波量及雜訊於訊號中，以增進強韌性推廣型卡爾曼濾波器
的估測效能。
四、研究方法及成果
本計畫所提之萃取提昇型之結構主要對量測訊號先作適當的篩選，然後再進行以強
韌性複數式卡爾曼濾波器之方法作訊號追蹤及偵測電壓、相位、頻率的變化。本計畫之
內容首先說明偵測訊號的模式，接著說明強韌性複數型卡爾曼濾波器的計算方法
[12]，然後闡述萃取提昇型結構的演算法及應用，最後提出本計畫的方法如何應用在訊號
追蹤及偵測。
A. 偵測訊號的電壓模式
在電力系統中，一個在時間為 tk 時之可觀測電壓訊號 yk，而可觀測訊號可視為由 M 個
正弦波所組成之訊號 zk再加上雜訊訊號 vk 所得，其公式表示為：
Nkvzy kkk ,,2,1  (1)
且
8
















 
)1(ˆ
1
0
)1(ˆ
)3(ˆ
0)1(ˆ)2(ˆ
001
|
)(
2
ˆ1
kk
k
kkxx
k
k
k
xx
x
xx
x
xf
F
kk
(18)
T
kkkk ][][ HKIMHKIP  Tkkk KRK (19)
上述各式中
K :為濾波增益矩陣。
R :為增益的運算權值，其公式 )~exp( xHyRR  。式中之 R 為測量值誤差
向量 v 之共變數矩陣。此項R 在強韌性複數式卡爾曼濾波器中是當成權數應用，
增加濾波的成效。
M 及 P :分別為預測及濾波誤差之共變數矩陣，其值是依濾波狀態估測值 xˆ 而變化。
圖 2 所示為本文所提之強韌性複數式卡爾曼濾波器的流程圖。抑制函數與權值的相
乘，存在於濾波步驟之間。
輸入值
輸入值
Kk, Mk, Pk各矩陣之計算
狀態濾波
停止
是
更新Pk
否k=k+1
Nk
狀態變數預測: kx
~
)~exp( iiii xHyRR 
)~( kkk xHyKx 
kkk xxx ~ˆ
000ˆ yPx
圖 2：強韌計算法的複數式卡爾曼濾波器
C. 萃取提昇型結構的演算法及應用
萃取提昇型結構主要是由四個步驟所組成第一步驟為資料的分割(splitting)，第二步驟
為預測運算 (prediction)，第三步驟為更新運算 (update)，最後一個步驟為係數正規化
(normalization)。今就依此四個步驟依序作如下之說明：
1. 資料分割
所謂資料分割的作法是將原始的資料分割為兩個不同的群組。最簡單的作法是將訊號
的資料 x(n)，依其資料的下標分成偶數的資料序列 xe(n)及奇數的資料序列 xo(n)。兩者可表
示如下：
xe(n)=x(2i) (20)
xo(n)=x(2i+1) (21)
上兩式中 N1i ,, 。圖 4 所示為將訊號序列的資料 x(n)予以分割的示意圖。當資料分割
10
用。
由過去文獻得知[15-17]，基本上 P 運算及 U 運算並無一定的格式，端視應用問題的特
性來決定。有些文獻提出的方法僅是簡單的加減運算，有些則是應用法則來決定。本計畫
欲採用的運算格式如下所示：
eo xxid 3952.0)(
)1( 
)(3418.0)1(4866.0)( )1()1()1( ididxic e 
)1(4941.0)(1024.0)()( )1()1()()2(  icicidid i
)(3648.0)1(480.1)()( )2()2()1()2( ididicic 
)(017.2)1(492.9)()( )2()2()2()3( icicidid 
)2(0218.0)1(253.0)()( )3()3()2()3(  ididicic
)1(46.912)()( )3()3()4(  icidid
)(7408.0)( )3( icic 
)(351.1)( )4( idid  (26)
圖 6：應用萃取提昇型結構之基本示意圖
D. 模式驗證
本節對於模式的驗證分為兩部份，一為以數值模擬，另一是應用於實際量測，
以便了解本計畫所提方法對電力系統之失真信號參數估測追蹤的效果，並驗證其
可能性。本文在狀態估測模擬時變訊號之参數變化情況時是以推廣式強韌複數型卡爾曼濾
波器與本文所提方法作比較。由於使用推廣式強韌複數型卡爾濾波器需應用磁滯迴線作濾
波增益及變異數的修正，以避免濾波震盪的發生，依過去文獻所示[7]其磁滯迴線最大誤差
邊界值需取 0.3 p.u.為界，而最小誤差邊界值取 0.2 p.u.為界。對於本文訊號中各種参數估
測之相對誤差 er 定義如下式所示：
%100ˆ  
k
kk
x
xx
re (27)
其中 kxˆ 為参數估測值， kx 為参數真實值。
在實際量測部份，分別量測函數產生器 (Function Generator)、市電、台電變
電所及不銹鋼管廠之電壓信號。
A. 模擬訊號之測試
本文模擬兩種不同的時變訊號做振幅及頻率變化的偵測，以驗證本文所提方法的可行
性。第一個時變訊號是僅由基本波與雜訊所組合，如式(28)所示。另一時變訊號除了基本
波與雜訊外另加諧波於訊號中，如式(29)所示。
訊號 1=Acos( )1 sTk +雜訊 (28)
12
因為訊號 2 內存有 5 次及 7 次諧波，所以欲估測訊號之振幅及頻率則其準確度通常會
下降，且有估測震盪的現象。圖 6(a)及 6(b)所示即為強韌性複數型卡爾曼濾波器(RECKF)
及本文所提方法(LSRECKF)對訊號 2 所做的振幅及頻率偵測的結果。在強韌性複數型卡爾
曼濾波器的估測中，無論是振幅或頻率顯然無法有效估測。雖然欲以改變磁滯迴線的邊界
值做此震盪現象的抑制，似乎是無法達成。然 LSRECKF 的估測結果顯然優於 RECKF，而
且不需修正磁滯迴線的邊界值。
圖 6(a)訊號 2 時之振幅偵測 圖 6(b)訊號 2 時之頻率偵測
狀況二：時變訊號之頻率下降
圖 7(a)及 7(b)所示依序為訊號 1 及 2 之時變訊號波形，並於時間第 0.1 秒處其基本波之
頻率突然由 60Hz 變化上昇至 64Hz，而訊號之其他参數則維持正常無變化。
圖 7(a)於情況 II 之訊號 1 波形 圖 7(b)於情況 II 之訊號 2 波形
於圖 8(a)及 8(b)所示為 RECKF 及本文所提方法(LSRECKF)於情況 II 中對訊號 1 所做的
振幅及頻率的偵測結果。在振幅的偵測中，兩個方法都有估測變化突起的現象且其大小相
當，但由圖 8(a)得知 RECKF 無法準確的估測此時之訊號振幅為 1.4 p.u.，而有些情況甚至
有很大偏移。而由 LSRECKF 估測結果可知其估測之準確性甚高。在頻率偵測上，如圖 8(b)，
RECKF 的估測有甚高的脈衝出現，其相對誤差為 2.09 310 。而 LSRECKF 在此情況所估測
的相對誤差為 5.14 210 ，前者的誤差是後者的約 10 倍。
14
濾波器追蹤的結果仍有震盪現象，而此現象對於頻率偵測是相當不利，因為無法確定實際
基本波的頻率為何。
圖 10 實測工廠之電力單線圖
7.246.77 7.00
1.5
-1.5
0
(秒)
(p.u.)
圖 11：電弧爐之 a 相電壓波形
圖 12(a)訊號 2 時之振幅偵測 圖 12(b)訊號 2 時之頻率偵測
五、結論
本文應用萃取提昇型結構做估測前之訊號處理，以增進強韌性複數型卡爾曼濾波器的
估測效果。經由模擬訊號做應用的結果，顯然此萃取提昇型結構有相當優越的表現。又由
驗證的結果得知，對於應用強韌性複數型卡爾曼濾波器所需磁滯迴線邊界的選取，可有更
16
VII. 計畫成果自評
目前本計畫所做研究的內容與先前所提計畫的內容相符。本計畫主要是提出萃取提昇
型結構做估測前之訊號處理，以改進應用成效。本計畫所做之內容及結果很適合於作學術
期刊發表，已相對發表在電力研討會中。
