 
圖 1、受測鋼鐵廠之單線圖 
 
 
 
 
圖 2、電弧爐匯流排之電壓閃爍值 
 
在有電弧爐設備之工廠，會因煉鋼過程使負載變化現象顯得相當劇烈，因此會造成廠區的總
用電需量呈現非線性的結果，一旦用電最高需量超出所申請的契約容量時，超出部分在契約容量
10%以下，是按二倍計收基本電費(即超約附加費)，超出部分在契約容量 10%以上，按三倍計收
基本電費，因此為避免發生契約容量超約受罰之情形，因應作法是採取提高廠區內自備發電機的
發電量或減少負載等措施來預防。圖 3 為某煉鋼廠廠區內某月之日電量分佈情形，由圖中可知，
隨鐵料熔解程度會呈現非線性的負載變化，加上尖離峰電費差異之因素與發電機維修等可能因
素，致廠內總用電量的變化並非呈現週期或線性的分佈情形。 
 
對於上述非線性的時間序列資料，我們對它的了解都是起於觀察、量測及記錄數據，然後再
歸納整理，來描述該系統的行為，並不是一個數學方程式，因此我們無法描述我們所得數據後面
的變化。傳統上時間序列的分析，為了達到理想化與精簡化的目標，對於分析資料的特徵描述多
   
],,[
    
],,[
],,[
10866
6422
5311
xxxX
xxxX
xxxX
=
=
=
M
 
    因此在相空間 Rm 中，其中一個座標軸是時間序列本身，其它由(m-1)個延遲時間序列軸所構
成，換言之，我們可以透過 m 個不同的延遲時間，建立 m 個不同的觀測軸，由 i、i+t、i+2t、…、
i+(m-1)t 所架構的空間上，即 Xi 是一個 m 維的向量。 
    在重建相空間時，延遲時間和嵌入維度是我們必須去決定的，但是如何找到適合的延遲時間
與嵌入維度使建構的相空間更能反應出內部的動態行為是非常重要的。關於如何選取延遲持間與
嵌入維度，現在主要有兩種不同的觀點，一種是延遲時間與嵌入維度互不相關，即兩者的選取是
獨立進行的(因 Takens 理論認為兩者是相互獨立的)，有部分學者以自相關函數(Autocorrelation 
function)來求出延遲時間，然後由 G-P 演算法，利用計算相關維度來求解嵌入維度；另一種求解
相空間參數的方法是認為延遲時間與嵌入維度的選取是相關的，即兩者相互依賴，其中以 C-C
方法為代表，可以同時求出延遲時間與時間窗口並找出嵌入維度。 
以C-C法決定相關維度與延遲時間 
    Brock [10,11]等，發展出一個非線性時間序列的測試方法，使用統計學上檢定的方法，定義
S(m,N,r)=C(m,N,r)-Cm(1,N,r)，這裡的 C 代表為相關積分，而當時間序列 x(i)假設為獨立且同分佈
(IID)時，對所有的 m 與 r 其 C(m,N,r)=Cm(1,N,r)。而在這裡考慮了與時間延遲 t 的關係，因此我
們將式子改為 S(m,N,r,t)=C(m,N,r,t)-Cm(1,N,r,t)，計算 S 隨著時間延遲 t 的變化量，藉以決定延遲
時間與延遲時間窗口，則稱這個方法為 C-C 法。根據 Packard [12]和 Takens [9]所提出，m 維的
相空間中，嵌入時間序列的相關積分表示為: 
 
∑
≤<≤
>−−−= Mji ji ),   rXXH(r)M(MC(m,N,r,t) 1 01
2
 
 
如果 N→∞，則： 
 
)t,r,N,m(Clim)t,r,m(C
N ∞→
=
 
 
那麼相關維度定義為： 
 
rln
)t,r,m(Clnlim)t,m(D
r 0→
=
 
 
但是因為時間序列長度是有限的，且半徑 r 不可能無限小，所以我們通常用一個線性區域的斜率
    式中計算了所有 r 中 S(m,r,t)的最大變動值，那麼局部最佳時間應該為∆S(m,t)的最小值，所
以延遲時間則對應這些局部最佳時間的第一個值，即 S(m,r,t)的局部第一個零點或者是∆S(m,t)的
局部第一個最小值，就是我們所需要的最佳時間。 
   而 m、N 和 r 的選擇經由 Brock [10]等，所做的統計結果表明，當 2 ≤ m ≤ 5、σ/2 ≤ r ≤ 2σ 和
N ≥ 500 時能得到較好的結果，其中 σ為時間序列的標準差(Standard deviation)。而半徑 r 在範圍
內我們取四個值(即 r1 = 0.5σ, r2 = σ, r3 = 1.5σ, r4 = 2σ)，最後得到的平均值為: 
 
∑∑
= =
=
5
2
4
116
1
m j
j ,t)S(m,r(t)S
 
 
∑
=
=
5
24
1
m
)t,m(S)t(S ΔΔ
 
    所以局部的最佳時間延遲 t 為 )t(S 的第一個零點時的 t 值或 )t(SΔ 的第一個最小值時(也就是
第一個谷底值)的 t 值，延遲時間 τ = τs t，τs 為取樣時間。而整體最佳時間 t’，為當 )t(S 和 )t(SΔ 都
接近於零時的值，即當 )t(S)t(S +Δ 的值為最小值時的值為最佳時間，定義為: 
 
  
)t(S)t(S)t(Scor += Δ  
 
根據 τw =(m-1)τ的關係，我們可以找出適合的嵌入維度 m。圖 4 為電壓閃爍值之時間延遲 t = 2
時， )(tSΔ 存在第一個局部最小值，因此 τd = t × τs = 2×10 = 20 分鐘；而在 中顯示最小值出現
在 t’=16，所以 τw = t’ × τs = 16×10=160 分鐘。因此根據 τw= (m−1)·τd，決定相空間的維度 m 為 9。
然而根據[13]研究顯示，重建相空間時由於資料干擾與假設的過程下，建議測試多組 m 與 τd 組
合並且必須滿足(m-1)·τd=160，因此我們可以找出(2,16)、(3,8)、(4,5)、(5,4)、(6,3)、(7,3)、(8,2)、
(9,2)等。 
)(tScor
 
 
圖 4、電壓閃爍 Pst 計算後之 )(tSΔ 與  )(tScor
 
圖 6、從時間序列計算里亞普諾夫指數的方法 
 
      
)0(
)(ln11lim
1
0
1 ∑−
=→∞
=
N
i Li
Li
N d
td
tN
λ  
 
    本研究共使用三種預測法來對電壓閃爍時間序列預測，其中預測方法一是在混沌時間序列預
測中最常見的方法，是鑒於整體的平均里亞普諾夫指數來預估未知值，方法二與方法三則是本文
根據預測方法一與長時間的觀察而加以改進的方法，也是基於里亞普諾夫指數來做預測，各預測
法詳細說明如下。 
平均里亞普諾夫指數法(方法A) 
    重建相空間的目的在於高維度空間中呈現混沌吸引子，混沌吸引子作為混沌系統的特徵之
ㄧ，出現混沌系統的規律性，意味著混沌系統最終會踏入某個特定的軌跡之中，而這種軌跡轉回
與時間相關的序列時，卻呈現混亂的行為。而里亞普諾夫指數也能表現相空間軌跡的收斂或發散
的程度，它是基於系統長期的行為所顯現出的量，代表著這個系統的特性，因此我們利用此特性
來對時間序列做短期時間的預測。 
    假設時間序列 ，時間序列長度為 N，嵌入時間延遲 t，維度為 m 的相空間
中，則相空間總點數為 M，M=N-(m-1)t。而時間序列的平均里亞普諾指數為: 
Ni xxxx ,,, 21 K=
 
  
)0(
)(ln1
)(
1
1
1 ∑−
=−=
tM
i Li
Li
d
td
ttM
λ  
 
鄰近相點之里亞普諾夫指數法(方法B) 
    這個方法也是基於里亞普諾夫指數的預測方法，但是不以時間序列的平均里亞普諾夫指數來
估算預測值。里亞普諾夫指數是計算相空間中兩相鄰軌跡的發散或收斂程度，因此當時間序列為
時，相空間總點數為 M，因此可以計算出從最初相點到最後相點每段時間的里
亞普諾夫指數 λi。 
Ni xxxx ,,, 21 K=
 
其中 K 為權值，表示如下: 
 
)min(   , min
1
)(
)(
min
min
wP
w
DD
DD
w DD
e
eK
w
w ==
∑
=
−−
−−
 
預測流程 
圖 8 為本研究所使用的預測流程圖，在 one-step ahead 預測法中，當預測出下一筆資料(假設 P1)
時，若要再繼續做預測，則必須使用真實值來取代預測值 P1，而訓練資料則需要移動增加，並
且重新計算新的平均里亞普諾夫指數，之後再做新的預測結果(P2)。而在 multi-step ahead 預測法
中，使用預測值來預測下一筆資料，直到我們設定預測筆數，而且每增加一筆預測值都必須重新
計算新的平均里亞普諾夫指數後，再做下一筆預測資料。 
 
SΔ corS
 
 
圖 8、模擬預測流程圖 
 
    有關衡量預測與實際值間的正確性，本研究中採用平均絕對誤差(Mean Absolutely Error)以及
平均絕對誤差百分比(Mean Absolutely Percentage Error)來做為衡量的準則，定義如下:  
 
 
圖 10、由羅吉斯方程式產生的時間序列下的實際值與預測值比較結果 
電壓閃爍預測結果 
本研究所使用之電力品質分析儀係裝設位置於電弧爐負載出口端的匯流排上，實際量測時間
達一個月，取樣時間為每 10 分鐘一筆 Pst 值，樣本資料數 N 共 4310 筆。另外讀取電錶之最大需
量，1 筆最大需量紀錄 15 分鐘為計，1 個小時 4 筆，一天 96 筆，實際量測值為 8928 筆，因此量
測實際值約為 3 個月之用電長度。 
    圖 11 顯示選取四組資料在 one-step ahead 預測法中，進行 30 筆之預測結果，其平均里亞普
諾夫指數為正值，代表皆具有渾沌特性。結果顯示 C-C 法在動態系統下相空間重建具有較佳的
能力，且發現當預測長度延長後，有較明顯的誤差產生。表 1 為預測結果之 MAE，從結果可知
方法 C 較其他兩個方法好，雖然 MAE 似乎偏高，但是從圖 11 可以發現在預測序列的前半段，
其誤差是顯得相當小的，因此若預測長度低於 30 筆時，其 MAE 也會相對變得較小。 
    圖 12 顯示在不同訓練資料組下使用方法 C 之 one-step ahead 與 multi-step ahead 的預測精準
度。由結果得知，當預測長度皆是 30 筆時，one-step ahead 預測結果比 multi-step ahead 的預測結
果好；再從預測經驗得知，排除非正常的操作周期外，在許多情況下，短期的閃爍預測結果是準
確的，但是當預測程度拉長時，仍會帶來較差的預測結果。而經驗顯示，本研究所用的方法不可
能適用在非典型的操作期間，例如臨時的停工、機器調整或維護。 
    由於沒有強而有利的理論能夠證明，如何取決建立電壓閃爍預測模型所需的訓練資料數，對
預測結果有較正確性，本研究再模擬訓練長度從 1000 筆(大約 1 星期)到 3000 筆的數據為基準，
執行相關的預測，圖 13 為三種不同訓練長度下的 30 筆 one-step ahead 預測結果。另由表 2 可知
訓練長度會影響預測模型及預測的正確性，當訓練長度 2000 到 3000 筆時，預測結果相較下比短
的訓練長度資料來的佳。 
    為能表示本研究採用渾沌理論之預測方法之可行性，本研究也同時應用人工智慧的類神經網
 
表 1、電壓閃爍 one-step ahead 預測下不同資料組的 30 筆預測結果 MAE 
預測方法 方法 A 方法 B 方法 C 
Data set 1  0.92 1.02 0.78 
Data set 2  0.92 0.89 0.86 
Data set 3  0.69 0.41 0.41 
Data set 4  1.07 0.95 1.00 
Average MAE 0.90 0.82 0.76 
 
 
 
圖 12、電壓閃爍值採用 multi-step ahead 及預測方法 C 下，不同訓練組 30 筆預測結果之 MAE 值 
 
 
 
圖 13、電壓閃爍值在不同訓練長度下，預測方法 C 之 30 筆預測結果 
 
表 2、電壓閃爍值在不同訓練長度下，預測方法 C 之 30 筆預測結果 MAE 值 
資料長度 
(資料筆數) 
一星期 
(1008) 
二星期 
(2016) 
三星期 
(3024) 
MAE 1.88 0.48 0.78 
 
表 3、電壓閃爍值在不同訓練資料及預測模式下，預測 30 筆之 MAE 值 
 
表 4、 電力最高需量在不同訓練長度的 30 筆預測結果 MAPE 
資料筆數 1500 2000 2500 3000 3500 4000 4500 
方法 A 2.81% 2.82% 2.53% 2.72% 2.88% 2.55% 2.67% 
方法 B 2.34% 2.69% 2.26% 1.99% 2.48% 2.16% 2.20% 
方法 C 2.47% 2.61% 2% 2.34% 2.68% 2.39% 2.60% 
 
 
表 5、電力最高需量在訓練長度 3000 筆資料下不同資料之 30 筆預測結果 MAE 與 MAPE 
資料組 Data 1 Data 2 Data 3 Data 4 Data 5 Data 6 Data 7 Data 8 Data 9 Data 10 平均值 
MAE 29.51 28.00 30.69 30.45 21.76 15.83 17.20 16.74 15.48 16.23 22.19 
方法 A 
MAPE 5.93% 4.98% 6.04% 5.16% 3.72% 2.60% 2.89% 2.80% 2.57% 2.72% 3.94% 
MAE 25.32 24.30 28.26 23.11 19.76 9.09 13.13 14.61 14.63 11.90 18.41 
方法 B 
MAPE 5.09% 4.32% 5.56% 3.92% 3.38% 1.49% 2.21% 2.44% 2.43% 1.99% 3.28% 
MAE 28.22 24.82 29.43 28.77 19.86 14.66 15.59 15.60 13.36 13.93 20.42 
方法 C 
MAPE 5.67% 4.42% 5.79% 4.88% 3.40% 2.41% 2.62% 2.61% 2.22% 2.34% 3.63% 
 
IV. 結論 
    本研究藉由混沌理論來幫助我們瞭解電壓閃爍時間序列及電力需量的動態行為架構，透過相
空間重建(Phase Space Reconstruction)原理，計算里亞普諾夫指數(Lyapunov exponent)，再建立三
種不同的預測模型，嘗試進行電壓閃爍值及電力需量的預測。預測結果顯示，在許多的情況下，
短期的電壓閃爍及電力最高需量的預測是可行的，但是其預測長度仍然不夠長。準確的電壓閃爍
預測模型能為電弧爐操作，提供有用的訊息，以減少電壓閃爍不穩定及超過規範之情事；而準確
的電力最高需量預測，可以幫助負載的調度，以避免超約受罰。本研究提供了一常用預測方法外
的另一選擇，供產業界參考使用。 
V. 參考文獻 
[1] I. Vervenne, K. Van Reusel, R. Belmans, “Electric arc furnace modeling from a power quality’s 
point of view,” 9th International Conference, Electrical Power Quality and Utilization, Barcelona, 
9-11 October 2007. 
[2] P. Varaiya, F. Wu, and H. D. Chiang, “Bifurcations and chaos in power systems: a survey,” EPRI 
Report, TR-100834, Aug. 1992. 
[3] P. E. King, T. L. Ochs, and A. D. Hartman, “Chaos response in electric are furnace,” Journal of 
Applied Physics, vol. 76, pp. 2059–2065, 1994. 
[4] E. O’Neill-Carrillo, G. T. Heydt, E. J. Kostelich, S. S. Venkata, and A. Sundaram, “Nonlinear 
deterministic modeling of highly varying loads,” IEEE Trans. on Power Delivery, vol. 14, no. 2, pp. 
pp. 437-440, 2003. 
[24] J. P. Eckmann, S. Oliffson Kamphorst, D. Ruelle and S. Ciliberto, “Lyapunov exponents from time 
series,” Phys. Rev. A. vol. 34, pp. 4971-4979, 1986. 
[25] W. Kinsner, “Characterizing chaos through Lyapunov metrics,” IEEE Trans. on Systems, Man, and 
Cybernetics, vol. 36, pp. 141-151, 2006. 
[26] H. Wang, G. Chen, J. Lu, “Complex dynamical behaviors of daily data series in stock exchange,” 
Phys. Lett. A 333, pp. 246-255, 2004. 
 
 
