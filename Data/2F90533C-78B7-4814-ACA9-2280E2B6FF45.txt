 2
摘要 
傳統的影像監視系統受限於舊有設備，僅能提供使用者低品質的監視錄影功能，對於大多
數自動化的應用，如異常偵測、分析、資訊融合顯示等皆無法妥善支援。但隨著電腦運算
速度與監視器材功能的逐漸增強與引入，傳統的影像監視系統無論在功能、架構方面亦需
配合改善，並且藉由新的影像處理技術，提供更具智慧性的功能。在本研究中，將建置了
一套使用雙攝影機的影像監視系統。第一部攝影機主要用於監視環境中的變化，並將影像
資料持續的傳入監視系統內，供變化偵測模組以及特寫取像模組使用。藉由變化偵測模組
與特寫取向模組的合作，系統得以進一步的操控第二部攝影機，再針對特定位置拍攝高解
析度的特寫影像，以便使用者能做更進一步的分析與使用。這樣的智慧型影像監視系統將
具有更優良的變化偵測能力、降低資料儲存量、提供有效監視資訊、加速資料檢索速度、
減輕人力負擔等優點。 
關鍵詞：變化偵測、時域相減法、區塊標記法、攝影機校正、特寫鏡頭。 
Abstract 
The traditional video surveillance system only can provide the low-end surveillance function 
because of the limited old equipment. It can’t support most of the applications such as abnormal 
detection, annoyance, and information fusion. Since the abilities of computers and surveillance 
equipments are enhanced, the traditional video surveillance system is requested to improve its 
functions and the framework in order to supply the more intelligent capability. In this research 
project, a dual cameras surveillance system is set up. The first camera is mainly to detect the 
change of the environment and transfer the image information to “Variation Detecting Module” 
and “Close-up Shooting Module“. By the corporation of these two modules, we can control the 
second camera to shoot the high precise image at designated position. The intelligent video 
surveillance system can reduce the storage space of required images, speed up the data searching, 
provide the effective surveillance information, and mitigate user’s encumbrance.     
Keywords：change detection, temporal difference, connected component, labeling, camera 
calibration, close-up shooting. 
1. 前言 
影像監視系統約在 1970 年開始有商業化的產品被導入市場中(Regazzoni et al. 2001)，
其中包含了攝影機、監視螢幕、錄影機和錄影帶等相關元件，當時影像監視系統的主要功
能在於錄影跟播放。安裝於監視環境中的攝影機在取像後，資料經由類比訊號的傳輸，持
續的將畫面傳回使用者所在的主控台，由監視螢幕顯示，最後並透過錄影機和錄影帶將畫
面儲存。在使用傳統的影像監視系統時，所有的監視工作都必須由使用者親自處理，監視
系統只能提供錄影跟播放的功能。以一個大樓而言，使用者可能需要同時觀看 5 至 10 個，
甚至更多的監視畫面，在觀看上十分的不便。除此之外，使用者在注視監視螢幕一段時間
後，其注意力往往不再集中，導致監看的效能降低，無法察覺變化的發生，也因此容易失
去第一時間處理的機會。傳統的影像監視系統在系統啟動時，即開始不間斷的持續錄影，
以便能提供詳細的監視紀錄，由於資料是以類比的方式儲存，因此需要大量的儲存空間才
足以應付需求。然而，在普遍的應用中，監視環境有大部分的時間都是處於靜止不動的狀
態下。因此，不間斷的持續錄影不僅浪費儲存空間，也使得資料的搜尋更加費時與費力。 
2. 研究目的 
以往對於影像監視系統的要求主要在於，拍攝畫面的清晰度、視頻訊號的雜訊比、操
 4
至最低。 
3. 文獻探討 
本系統最主要的目的在於自動偵測環境中的變化，並對於進入此監視環境中的人員取
得其臉部特寫影像。在這一連串的處理流程中，最主要的部分為變化偵測處理、多攝影機
合作方式以及特寫影像的拍攝。在本節中，將會對於這三類關鍵問題就目前已知的研究方
法與種類作一整理，並闡述其優、缺點。 
3.1 變化偵測處理 
變化偵測處理在影像監視系統中扮演著很重要的角色，它提供了將移動物體從背景中
分離的能力，以便系統能進行後續的處理。基本上，不論是室內或是室外的環境，光照的
情況無時無刻不在改變。因此，變化偵測處理的關鍵議題之一便是如何在不同光照變化的
情況下，持續的偵測出影像中的移動物體。目前用來判定兩張影像間差異的辦法主要有下
列這幾種： 
(1)像素統計分類法(Pixel-Wise Statistical Classification)(Wren et al. 1997)：此方法的理論依據
為：假設影像序列中，影像中每一點的像素值皆可以用 Gaussian 機率分配加以描述。因此，
透過事前的計算，可以求出背景像素值的機率分佈。欲偵測影像中的移動物體時，則可藉
由計算背景影像與目前影像每一像素值之間的馬式距離(Mahalanobis Distance)，以分離出移
動物體。此法的優點在於具有推理統計的理論基礎，分離結果有較高的穩定度，但是缺點
則是必須事先產生理想的背景統計模型，故不易達到，且背景模型的精確度與正確性，與
分離結果的好壞有高度的相關性。 
(2)靜態背景相減法(Static Background Subtraction)(Long et al. 1990；Chung et al. 2002)：此方
法會對於使用者欲監視之場景，事先取得一張無外物的背景影像。之後所取得的每一張影
像皆與此張背景影像做相減的處理，若得到之值大於事先訂定之門欄值(Threshold Value)，
則認為此像素發生變化，反之則否。此方法的優點在於做法簡單，但是缺點則是必須事先
產生無外物的背景影像，且背景的好壞與偵測的結果有密切的關係。 
(3)時域相減法(Temporal Differencing)(Dailey et al. 1999；Daniel et al. 2000)：此方法與靜態
背景相減法類似，但不需事先產生一乾淨之背景影像，而是利用時間軸上相鄰或是間隔一
定距離之兩張影像做相減的處理，若得到之值大於事先訂定之門欄值則認為此像素發生變
化，反之則否。此方法的優點在於前後兩張影像的間隔時間短，偵測結果不易受光照變化
的影響，但是缺點則是物體若在前後兩張影像間的變化不明顯，則物體內部重疊之區塊易
被視為無變化發生，以致於此方法只能偵測出物體的輪廓。 
(4)陰影模型法(Shading Model)(Skifstad et al. 1989)：此方法主要是基於 Skifstad 與 Jain 的理
論所發展出來的。其假設影像中每一點的亮度是由光照強度乘上物體表面該點之陰影係數 
(Shading Coefficient)，若物體無物理變化，同一點於不同時間所攝得的亮度之比例，便等於
光照強度的比例。如欲計算影像中是否有變化時，其做法是先將影像切割成許多固定大小
的區塊，並假設區塊中物體表面之陰影係數固定不變。因此，同一區塊中各點在不同時間
所攝得之亮度，將呈現一致之變化比值，若各點的變化比值不固定，則表示可能有移動物
體或雜訊出現在此區塊中。此種方法的優點在於不易受光照變化的影響，但缺點則是偵測
出的結果其輪廓與真實物體的輪廓有較大的差距，且對雜訊的抵抗性較低。 
(5)向量模型法(Vector Model)(Durucan et al. 2001)：此法為 Durucan 等人所提出，其理論為
將影像上的每一點，皆以其週遭 nn× 大小範圍內之像素值所形成之向量來代表。要決定不
同影像間的同一點是否發生變化，可藉由檢查兩者之向量是否為線性相依(Linear Dependent)
 6
 
(2)系統執行流程 
本影像監視系統是由兩台攝影機互相合作以達成人員定位以及特寫影像拍攝任務。其
中搜索攝影機負責整個環境的監看，搜索是否有人員在監視環境中移動。它主要的執行工
作為進行變化偵測，並求得人員之相關資料(包括位置與高度)。在取得所需資料後，系統
會先利用事先定義好的座標系統轉換機制將這些資料進行轉換，接著將資料傳送給照明攝
影機，並要求進行特寫取像。依此原則，系統執行的流程規劃如圖 3所示。 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
天花板 
搜索攝影機 
人員 
電控式雲台 
照明攝影機
人員行走方向 
圖 2 兩台攝影機在真實世界中的建置關係 
(a)搜索攝影機 (b)照明攝影機
圖 1 搜索攝影機與照明攝影機 
變化偵測模組 人員偵測 
人體結構分析 
開始
繼續
結束 
特寫取像模組 
攝影機校正 攝影機內參數校正 
攝影機外參數校正 
座標系統轉換 
人員定位 
特寫取像 
是 
否
(照明攝影機) 
(照明攝影機，搜索攝影機) 
(搜索攝影機) 
(搜索攝影機) 
(照明攝影機，搜索攝影機) 
(照明攝影機) 
(照明攝影機回 
復初始狀態) 
圖 3 系統執行流程 
 8
本研究中，則需要在相減後的影像中，將變化 1 和變化 3 的部份保留，並從偵測結果中消
除變化 2的部份，為了達到這個目的，本研究的解決方法如下執行流程如圖 6所示。 
 
4.2.3 閉運算與區塊標記法 
經由改良式時域相減法的處理後，可以發現偵測結果影像中的變化區塊，其區塊內部
並不十分的完整，可能包含著許多的孔洞，或是屬於同一物體的區塊並不相連。為了使得
接下來對變化區塊進行的分析能更加的準確。首先對於偵測結果中的變化區塊進行閉運算
的處理，藉以填充區塊內部的孔洞、連接鄰近的區塊，並在不顯著改變區塊面積的情況下，
平滑其邊界。在利用閉運算填充變化區塊內部的孔洞以及連結鄰近的區塊後，尚能發現偵
測結果中除了有移動物體所造成的變化外，還包含了雜訊以及光影所造成的變化。由於物
體(移動部份)在影像中佔有最大數量的“0＂像素，而背景(靜止)部份則佔有最大數量的
“1＂像素，其它部份的“0＂或“1＂像素則會被視為雜訊。 
為了去除由雜訊以及光影所造成的無意義的變化，接著利用 8 鄰近 (8-connected) 的
區塊標記法，把影像中產生變化且相鄰的像素，結合成一個區塊，並給予每個區塊一個獨
特的標記。最後再統計每個區塊所包含的像素個數，將像素個數太少的區塊視為無意義的
-+ 
+ 
原始影像序列 樣板影像
+ 
- 
I(1) 
I(2) 
I(3) 
...
部分變化影像  
... . . . ... 
偵測結果 
+
+
M(1) 
R(3) 
M(2) 
M(3) 
P(2) 
P(3) 
R(2) 
圖 6 改良式時域相減法執行流程 
(a) 未經閉運算
處理之原始影像 
(b)經閉運算處理
之影像 
(c)經區塊標記法
處理後之影像 
圖 7 原始影像以及經閉運算處理後之影像 
 10
4.3 特寫取像模組 
針對搜索攝影機所取得的影像序列進行變化偵測模組的處理後，可以得知人員在影像
中的各項資訊，接下來的工作便是透過特寫取像模組的處理，求取人員在真實世界中的身
高以及所在位置，並且進一步預估出特寫取像位置以及雲台所需移動的旋轉角度等。本章
將會對於照明攝影機欲進行特寫取像時，被監視人員身高的計算、特寫取像位置的預估以
及攝影機的設定方式做一詳細的描述。 
4.3.1 人員定位 
(a)計算地板平面方程式：為了得知被監視人員在真實環境中的所在位置，因此必須先求得
地板的平面方程式後，才能透過影像中的資訊與地板平面方程式計算出人員的所在位置。
搜索攝影機經過攝影機校正的程序後，可以得知 WCS 下的 XW、YW、ZW在 CCS 中的單位方
向向量，以及 ZW上的一點的座標值。藉此可以唯一決定一個穿過該點的平面方程式，此平
面方程式即為地板平面方程式。 
(b) 求取人員身高與位置：在本實驗系統中，欲利用人員的頭部資訊來估計其身高與所在
位置，以減少陰影所造成的影響。為了達到此目的，首先必須了解頭部長度與身體比例之
間的關係，文獻(Cui et al. 1998；Rees 1970)中指出，人的平均身高值為 7.5 個頭長，亦即頭
部與完整身高的長度比為 1：7.5。根據上述的比例關係與人員頭部長度資訊在不需實際計
算 3D 資訊的情形下，可以利用交比值(Cross Ratio)來做三維空間中的定位，即可分別找出
人員腳底以及頭頂在三維空間中的所在位置，之後利用計算這兩點的距離即可求得人員的
完整身高。 
4.3.2 人員位置預估 
當搜索攝影機偵測出人員所在的位置之後，這些資料必須先經過座標值轉換的處理，
以供照明攝影機使用。接著，系統會依照人員距離攝影機的遠近與高低位置，動態的調整
電控式雲台的角度以及鏡頭的 Zoom、Focus 參數，以取得最佳的特寫模式。然而當照明
攝影機執行完這些調整的步驟而開始拍攝特寫影像時，調整步驟所耗費的時間，可能已使
得人員離開原本照明攝影機欲拍攝的位置，而造成特寫取像失敗。為了解決上述的問題，
系統在決定特寫取像位置時，必須考慮到人員的移動速度，以及照明攝影機進行調整所需
花費的時間。在進行特寫取像作業時，藉由傳送預估的特寫取像座標，來取代實際偵測到
的人員位置座標，以提高特寫取像的成功機率。藉由“求取人員身高與位置＂的處理後，
可以得知每張影像中人員在真實世界中的身高以及所在位置。當持續對影像序列處理的同
時，若有連續三張影像所偵測出的人員資訊符合下列兩項條件時，系統便會根據這三張影
像中的人員資訊來預估最適當的特寫位置。 
(1) 當前後張影像中所偵測出的人員身高差距小於一適當範圍( HΔ )時。 
(2) 當影像中所偵測出來的人員位置座標與照明攝影機的距離持續遞減時。 
假設人員是以等速直線行走的方式持續前進，並且已知系統平均進行一次變化偵測處理需
耗費 TΔ 秒，根據三張影像中人員行走的距離 S1 與 S2，可以求得人員的平均行走速率 V。
當系統取得三組用來預估特寫取像位置的人員資訊後，若從計算預估位置一直到雲台與鏡
頭調整完成系統共需花費 Z 秒，則透過已知的人員平均行走速率 V 可以得知，經過 Z 秒後
人員的移動距離為 D，而特寫取像點則為點第三點再加上人員在行進方向上所移動的距離
D。 
4.3.3 雲台旋轉角度 
為了能準確的替人員拍攝特寫影像，使其臉部能完整的出現在影像中，首先必須將照
 12
9 所示。 
(3)臉部特寫影像：人們在使用監視系統時，最需要的是了解被監視者的身份，而不僅僅是
需要一段視訊紀錄而已。為了滿足使用者這方面的需求，本系統除了儲存被監視者的移動
軌跡，好讓使用者在事後能了解事情發生的過程外，還儲存了被監視者的臉部特寫影像，
以便使用者能藉由清晰的臉部特寫影像來達到識別的目的。臉部特寫影像如圖 10 所示。透
過移動資訊檔、移動軌跡影像與臉部特寫影像，本實驗系統不但可以幫助使用者清楚的了
解到事件發生的過程以及被監視者的身分外，還可顯著的縮小資料儲存量並加快資料的檢
索速度。 
 
5.結果與討論 
在研究方法的驗證上，將會根據所描述的各項軟、硬體設施來開發實驗系統，並以大
樓內的走廊作為實驗環境，來驗證變化偵測之效果與臉部特寫拍攝之準確度。 
5.1 變化偵測處理 
為了測試改良式時域相減法在變化偵測上的準確性與強健性，設計了六種不同的環
境，並與 5種已知的變化偵測方法來進行比較，如圖 11 所示。最後則是分析各種評比項目
的比較結果。 
z 時域相減法：此方法雖然執行速度快，但是偵測結果中物體輪廓破碎且內部重疊部分易
被視為沒有變化。 
z 陰影模型法：此方法由於取採區塊且不重疊的計算方式，因此在計算時間與物體內部完
整的偵測上有較佳的表現，但是此方法對於雜訊的抵抗性較低，易受影響。 
z 統計變化偵測法：此法方的偵測效果不佳，且由於利用重疊的區塊計算方式，所以執行
時間也最久。 
z 向量模型法：此方法在光線明亮的情況下有不錯的偵測效果，且執行時間中等。但是，
由於在光線陰暗的情況下，有著大量的雜訊與陰影，以至整體的表現水準下降。 
z “Wronskian”變化偵測法：此方法與向量模型法類似，但是在光線陰暗的環境下，卻更能
圖 9 人員移動軌跡影 圖 10 臉部特寫影 
圖 11. 變化偵測處理方法的比較 
(e) 像素統計分類法 (f) 向量模型法 (g) Wronskian 變化偵測法 (h) 我們的方法 
(c) 傳統時域相減法(a) 輸入影像 1 (d) 陰影模型法 (b) 輸入影像 2 
 14
      
      
      
      
      
(a)搜索影像 (b)變化偵測結果 (c)照明影像  (a)搜索影像 (b)變化偵測結果 (c)照明影像 
                
(d) 人員移動軌跡                         (e)臉部特寫影像 
圖 13、臉部特寫實驗結果 
 
5.5 結果檢討 
在研究的過程中，首先嘗試解決攝影機校正的問題。在攝影機內部參數校正方面，
主要是根據 Wentao Zheng 等人所提出的方式(Zheng et al. 2001)，利用兩張影像來求取
照明攝影機在不同的 Zoom 步進數與 Focus 步進數組合下的焦距大小。得知攝影機的內
部參數後，再根據場景中事先定義好的校正物與空間幾何的關係，則可以推算出座標系
統進行轉換所需的外部參數。當人員進入監視環境後，首先利用本研究所提出的改良式
時域相減法來進行變化偵測，藉由改良式時域相減法，本系統可以在只小幅增加處理時
間的情況下，提供使用者一個良好的變化偵測處理效果。之後，更利用閉運算與區塊標
記法的處理來提高偵測結果的品質。得知人員在影像中的位置後，接著便是尋找其頸部
圖 14 事件查詢畫面 
 16
13. Long, W. and Yang, Y.H., “Stationary Background Generation：An Alternative to the 
Difference of Two Images,” Pattern Recognition, Vol. 23, 1990, pp. 1351-1359. 
14. Raja, Y. et al., “Tracking and Segmentation People in Varying Lighting Conditions Using 
Color,” in IEEE Proc. Automatic Face and Gesture Recognition, Nara, Japan, Apr. 14-16, 
1998.pp.228-233 
15. Rees, D.W., ”Panoramic Television Viewing System,” United States Patent, No. 3,505,465, 
Apr. 1970. 
16. Regazzoni, C.S., Ramesh, V., and Foresti, G.L., “Special Issue on Video Communications, 
Processing, and Understanding for Third Generation Surveillance Systems,” Proceedings of 
the IEEE, Vol. 89, No. 10, Oct. 2001, pp. 1355-1365. 
17. Regazzoni, C.S., Sacchi, C., and Dambra, C., “Remote Cable-Based Video Surveillance 
Applications: The AVS-RIO Project,” in Proc. ICIAP99, Venice, Italy, Sept. 27-29,1999. 
18. Skifstad, K. and Jain, R., “Illumination Independent Change Detection for Real World Image 
Sequences,” Computer Vision and Image Processing, Vol. 46, No. 3, 1989, pp. 387-399. 
19. Wren, C., Azarbayejani, A., Darrell, T., and Pentland, A., “Pfinder：Real-Time Tracking of the 
Human Body,” IEEE Transactions on Pattern Analysis and Machine Intelligence, Vol. 19, No. 
7, July 1997, pp. 780-786. 
20. Zheng, W., Shishikui, Y., Kanatsugu, Y., Tanaka, Y., and Yuyama, I., “A High-Precision 
Camera Operation Parameter Measurement System and Its Application to Image Motion 
Inferring,” IEEE Transactions on Broadcasting, Vol. 47, No. 1, March 2001, pp.46-55. 
