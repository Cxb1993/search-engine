(一) 計畫中文摘要 
隨著資訊科技的進步以及網際網路的發展，數位內容的取得變得越來越容
易，藉由網際網路的特性，人們可以將數位媒體資訊透過網際網路達到無遠弗屆
的傳遞與散佈。然而，也因為散佈數位內容相當容易，使得侵害智慧財產權的情
況日趨嚴重。因此，在近幾年來數位權利管理(Digital Rights Management)引
起廣泛的討論，數位權利管理所包含的範圍相當廣泛，但是主要處理的範圍將著
重在於數位內容的保護、授權以及傳遞。其宗旨為保護數位內容的智慧財產權，
使得數位內容無法在未授權的情況下使用與散佈。 
第三代行動通訊(3G)將在未來行動通訊系統扮演一個重要的角色，其提供了
無遠弗屆的覆蓋率以及更高的無線頻寬。3G 提供了快速的傳輸速率，不僅可以
滿足人們對語音傳遞的品質需求，對於發展多媒體應用服務也是極為有利的基
礎。然而，在發展多媒體應用服務前，勢必要將數位權利管理整合其中，以因應
未來可能發生的一些智慧財產權侵害的問題。由於 3G 網路環境提供了一個完整
的認證機制以及記帳系統，提供了一個很好的利基來發展數位權利管理。本研究
計畫將著重在數位權利管理與 3G 安全機制的整合，透過 3G 的安全機制來加速數
位權利管理所需的認證流程。鑑於 3G 整合完整性問題以及消費者使用習慣，在
此計畫中我們發展出三種機制分別應用於三種不同的情況，如此將可以促進 DRM
以及 3G 的整合，並針對消費者的使用習性採用最適之機制。 
 
關鍵字:第三代行動通訊、授權、數位權利管理、智慧財產權、安全、隱私權保
護 
 
(二) 計畫英文摘要 
With the rapid growth of the Internet, acquiring digital contents over the 
Internet has become commonplace. Most of traditional items can be translated into 
the digital items and distributed easily and fast over the Internet. Thus, the 
problems of piracy are more and more serious. Therefore, the concept of the 
Digital Rights Management (DRM) was proposed. The major purpose of the DRM 
is keeping the intellectual property. The DRM system deals with the process of the 
digital content including protection, distribution and authorization.  
The third generation (3G) mobile communication system is the next 
important thing in the world of mobile communication. The 3G network provides 
global coverage, efficiently transmission and the necessary network and 
management infrastructure to cater for security, roaming and billing. Furthermore, 
a cell phone can offer more reliable personal information and billing system 
existed and authentication architecture matured in the 3G environment. Therefore, 
it provides a good solution for developing DRM system. In this project, we focus 
on integrating the security mechanism of 3G network with DRM. With the 
for voice communication. The well-know first generation mobile communication 
systems are Advanced Mobile Phone Service (AMPS), Nordic Mobile Telephone 
(NMT), and Total Access Communication Systems (TACS). The second generation 
(2G) mobile communication systems are using digital technology. When the 2G 
communication systems are put on the market, its utilization became prevalent very 
rapidly. The well-know second generation mobile communication systems are Global 
System of Mobile communication (GSM), Personal Digital Cellular (PDC), and 
Digital AMPS (D-AMPS) [19]. However, the GSM system is the most popular 2G 
mobile system in the world. In addition, the GSM system uses the technology of 
circuit-switch for data transmission. Unfortunately, it will not provide ideally data 
transmission rates. Recently, the technology of the General Packet Radio Service 
(GPRS) is proposed, it uses packet-switched technology for the data transmission. 
Moreover, the GSM system can upgrade and add some network elements for 
supporting the packet data service. Generally, the technology of the GPRS is called as 
2.5G technology. 
 
The third generation (3G) mobile communication system is the new generation of 
wireless communication system. It is the next important thing in the mobile 
communication and it will lead the mobile communication into a new age. The 3G 
mobile communication system is not only rise of bandwidth, it will also change the 
way of using the mobile communication. Since the 3G employs the technology of 
Internet Protocol (IP) and packet-switched services to achieve high data transmission 
rates. And the high data transmission rates can allow more services, such as 
multimedia services. In addition, the 3G packet-switched service has efficient 
transmission, multimedia service, large capacity and it can achieve good quality of 
service (QoS). Up to now, the cell phone operators still consider the existing 2G 
system investment when they develop the 3G network. Since the infrastructure of the 
3G network need to add new network elements architecture for the packet routing, IP 
address assign and location management. Thus, the current cell phone operators are 
not to make the investment rashly. The well-know third generation mobile 
communication systems are the Universal Mobile Telecommunication System (UMTS) 
and the Wideband Code-Division Multiple-Access (WCDMA). However, the UMTS 
seems to be the major 3G system since it can upgrade from the GSM systems.  
 
The 3rd Generation Partnership Project (3GPP) is an organization established for 
developing and formulating the specifications for the third generation mobile 
communication system. The 3G system is based on the UMTS Terrestrial Radio 
Access Network (UTRAN) radio interface and the enhanced GSM/GPRS Mobile 
provides high efficiency of packet-switched service and high data transmission rates 
which means that the user can through 3G network for using various services, such as 
media services. On the other hand, the UMTS architecture can upgrade from the 
existing 2G GSM/GPRS system. Thus, the cell phone operators can upgrade some 
network elements simplify to develop their 3G system. 
Figure 1: UMTS network architectures 
 
2.1 Access Security in UMTS 
The mechanisms of access security provide users with secure access to 3G 
services, and protect them against the malicious attacks. However, the detailed 3GPP 
security architecture is specified in 3GPP TS 33.102 [4]. Generally, there four parts in 
the access security mechanisms:  
 User identity confidentiality 
 Authentication and key agreement 
 Data confidentiality  
 Integrity protection of signaling message 
The detailed information of those parts will describe in next section. There are four 
entities participating in the UMTS security architecture. These are: 
 The Home Environment (HE):  
The home environment in the 3G environment represents the home domain of 
 
2.3 Authentication and Key Agreement 
In the 3G environment, the UMTS Authentication and Key Agreement (AKA) 
protocol performs user authentication and session key distribution for granting the 
access to the network. The mechanism of the AKA is composed of a 
challenge/response protocol. The UMTS AKA protocol is of secret-key type. In the 
AKA procedure, the mutual authentication can be achieved based on the secret key K 
shared between the MS and the HE. After the AKA procedure, the MS and 
VLR/SGSN will share the corresponding cipher key (CK) and integrity key (IK) 
respectively. However, the cipher key (CK) is used to protect the user data for data 
confidential protection, and the integrity key (IK) is used for the signaling message 
integrity protection. The detailed information of the AKA procedure is illustrated in 
Figure 2, Figure 3 and Figure 4. 
 
Figure 2: The overview of the UMTS AKA 
 
When the MS logins to the UMTS system or updates its location, the AKA 
procedure will be performed. There are two stages in the full AKA procedure. In the 
first stage, an ordered array of n authentication vector (AV) will generate and send to 
the VLR/SGSN by the HLR/AuC. Hence, the VLR/SGSN and the MS can 
authenticate each other and compute the corresponding session keys by using the AV 
in the second stage. When the MS roams to a new VLR/SGSN, the MS will send the 
TMSI or IMSI (if the MS is the first time registration in UMTS system) to the new 
verifying by subscriber and preventing the reply attack from the malicious attackers. 
Subsequently, the following values are computed using the secret key K that shared 
with the MS. The detail steps of the corresponding parameters are as follows. 
(1) The message authentication code MAC = f1K(SQN||RAND||AMF), where f1 
is message authentication function that formulated by 3GPP and AMF is an 
authentication management field which can support multiple authentication 
algorithms and keys. 
(2) The expected response XRES = f2K(RAND) where f2 is another message 
authentication function. 
(3) The cipher key CK = f3K(RAND) and the integrity key IK = f4K(RAND) 
where both f3 and f4 are key generating functions. 
(4) The anonymity key AK = f5K(RAND) where f5 is also a key generating 
function and AK is used to conceal the sequence number (SQN).  
Finally, the HE/AuC can construct the authentication token AUTN = 
(SQN⊕AK||AMF||AMC). And then, the HE/AuC sends the AUTN to the VLR/SGSN 
for performing the stage-2 of the UMTS AKA. 
 Stage-2: Authentication and Key Agreement 
(1) After the stage-1 of the UMTS AKA, the VLR/SGSN will receive the AV 
(includes RAND, MAC, XRES, CK, IK and AUTN). Thus, the VLR/SGSN 
keeps XRES, CK, and IK, then the VLR/SGSN sends the random challenge 
RAND and authentication token AUTN to the MS for mutual 
authentication. The AUTN that involved in the AV consists of a sequence 
number (SQN) which execute XOR operation with an anonymity key (AK), 
an authentication management field (AMF), and a message authentication 
code (MAC). 
(2) When the MS receives the RAND and the AUTN, the MS can authenticate 
the VLR/SGSN by verifying the MAC and SQN. First, the MS computes 
the AK using the secret key K, AK = f5K(RAND), and retrieves the SQN by 
SQN = (SQN⊕AK)⊕AK. Then, the MS computes XMAC = 
f1K(SQN||RAND||AMF), and checks the result with the MAC received from 
the VLR/SGSN. If the result is true, then the MS authenticated the HLR. 
Because of the retrieved sequence number (SQN) values were indeed 
generated in AuC and only the one who owns the same secret key K can 
compute the corresponding MAC. Finally, the MS then checks the fresh of 
the sequence number (SQN) to guarantee the AV that has not been used 
before.  
(3) After the above step, the MS authenticated the VLR/SGSN. Therefore, the 
MS computes RES = f2K(RAND) and sends it back to the VLR/SGSN for 
side will achieved. 
 
In the UMTS access security, it also provides the integrity protection of signaling 
data. The integrity protection mechanism is responsible for ensuring the signaling data 
that have not been modified or tampered in an authorized way since the signaling data 
sent out. When the user coordinates with the network for establishing the session keys 
(such as CK and IK) after the mutual authentication is finished. The IK (integrity key) 
is used to perform integrity protection process. When integrity protection process is 
running, the IK and the message/data will input into a cryptographic integrity function 
f9 [5]. Afterward, the output of the cryptographic integrity function f9 is a 32 bits 
message authentication code (MAC) and it will be appended to the frame. Hence the 
receiver can confirm the MAC to ensure that the origin signaling data is indeed the 
one claimed. 
 
3. The overview of Digital Rights Management  
Today, there is lack of a standard definition of DRM. We list some definitions as 
follows: 
¾ The chain of hardware and software services and technologies confining the 
use of digital content to authorized use and users and managing any 
consequences of that use throughout the entire life cycle of the content. DRM 
is one kind of content protection technology [18]. 
¾ DRM responsible for controlling and managing rights to protect digital 
intellectual property [8]. 
¾ DRM is the description, identification, trading, protection, monitoring and 
tracking of all forms of rights usages over both tangible and intangible assets 
including management of rights holder relationships [13]. 
We sum up two viewpoints from the DRM definitions. One is about managing the 
digital content protection and distribution, and the other is about ensuring the usage 
rules enforcement correctly. 
 
3.1 Emerging Standards and Current Commercial Products 
 Open Mobile Alliance: 
The Open Mobile Alliance (OMA) is a group composed by many companies and 
organizations. They have released the version 1 DRM specification in June 2004 
and released the version 2 in July 2004 [28]. According to the DRM specification 
of OMA, their main scope of DRM is to control the digital content access under 
the usage right of the content provider issued. In the version 1 of OMA DRM 
right-holder. Figure 5 illustrated the model of ODRL. 
Digital 
signature
Rights Permission
Constraint
Condition
Requirement
Offers
Agreements
Parties Asset Encryption Key
Rights Holders
Consumer
Figure 5: ODRL Rights Expression Model [34] 
 
¾ Digital Property Rights Language:  
The DPRL is another XML-based expression language, developed by 
Xerox. The DPRL is flexible and supports many pricing models. The focus 
of the DPRL is how to handle certain rights, both for primary and 
derivative use. The main goals of the DPRL are: (1) To describe rights 
appropriately. (2) Standard terms for rights specifications. (3) Provide 
operational definitions of specifications (4) Provide extensibility to new 
language. 
¾ XrML:  
The XrML is a XML-based specification grammar for expressing rights 
information; it states the rights information associated with digital 
resources, such as media files and electronic documents. The XrML is 
extending from the DPRL; XrML provides more expression ability and 
functions, such as integrity, authentication of entities and adds structural 
and semantic tags for specifying metadata. Furthermore, XrML supports 
specifying conditions for usage locations and tracking.  
 Current Commercial Products 
Today, there are some commercial DRM solutions on the market, Windows Media 
Rights Manager (WMRM) [24] by Microsoft Corporation, the Electronic Media 
Licensing & 
Reference 
Services
Trusted Computing 
Framework
Provisioning
Services
Trusted Computing 
Framework
Retailer / Service 
Provider(Clearinghouse)
Content 
Provider
Packing
Services
Trusted Computing 
Framework
Consumer
Consuming 
Application
(Full-Featured Host)
Trusted Computing 
Framework
Portable
(tethered)
Device
Trusted Computing 
Framework
Distributor
Host-Device 
Interface
Rules & 
License 
information
 License
Protected
Content
Protected
Content
Contractual 
information
Figure 6: The architecture of DRM system [32] 
 Clearinghouse:  
The duty of the clearinghouse is to issue the license to consumer and handle the 
financial transaction data. The clearinghouse is responsible for collecting 
payment from the consumer and portioning out the fee to the content provider 
and distributor. 
 Consumer:  
This refers to people who use DRM system to acquire the digital content by 
downloading from the distributor and purchase license for playing the content. 
 Trusted computing framework:  
In DRM environment, all DRM application and service are all built on the 
trusted computing framework. The trusted computing framework is responsible 
for secure distribution, execution environment, and license enforcement, 
supporting cryptographic functions and key management, and tamper resistance. 
 
 
 
super-distribution [17, 37] to acquire the encrypted content. 
 License obtaining:  
After obtaining the encrypted content, the consumer must send a request to the 
clearinghouse for getting license and pay the payment with his/her identity. Thus, 
the clearinghouse will verify the consumer’s identity and charge from his/her 
account. Meanwhile, the distributor will pay the royalty to the content provider 
and the distribution fee to the distributor, respectively.  
 Content decrypting:  
When the consumer obtains the license, he/she can input the encrypted content 
and license to DRM module that is built on the device of the consumer. Then, 
DRM module will verify the license and decrypt the encrypted content using 
corresponding cryptography technique chosen by the content provider. If all the 
verifications prove to be true, the DRM module will play the content correctly 
with a corresponding media player. 
 
3.4 General Requirements of DRM 
According to many literatures [3, 10, 20, 27, 28, 47], we sum up three general 
requirements of a DRM system listed as follows: 
 Ensure content protection:  
Content protection is one of the most important issues in the DRM environment. 
The content must require permanent protection and assure the authenticity and 
integrity of the content. If the requirement is not, the DRM system will break 
down. That is because if the content protection is not permanent, then the 
consumer who buys the content will distribute it through Internet and anyone can 
download and use without any restriction. Thus, the DRM system loses its 
efficacy. Furthermore, the DRM system must avoid illegal copy and protect the 
integrity of the content. 
 Control usage rule:  
Usage rule establishing and control is another important issue. The DRM 
systems must enable to control access and usage of content. Usually, usage rule 
includes in a license file. The license is necessary for the DRM system to play 
the encrypted content correctly. Therefore, the content provider must set up the 
usage rule unambiguously and establish a license file with the consumer’s 
information for preventing consumer abuse. Moreover, it must prevent the 
license forgery, alteration and duplication. 
 Trusted environment:  
A trusted environment provides a reliable environment to operate related 
processes. However, in DRM system, it must base on the trusted environment. 
management. The last, we follow the 3G architecture; assume that the 3G operator is 
trusted.  
In our proposed schemes, we employ a DRM module for handling the process of 
the DRM system. The major responsibilities of the DRM module are as follows. 
(1) Digital content decryption:  
The functionality is the basis function in the DRM system, it responsible for 
decrypting the protected digital content. 
(2) Signature verification:  
In general, the license has the signature of the content provider. Due to prevent 
the license forgery, thus, the DRM module need to verify the correctness of the 
signature. 
(3) Key management:  
In the DRM module, the functionality of the key management deals with the 
secure distribution and storage of keys. Note that, the module of the key 
management involves a key database for storing keys. 
(4) Usage rule analyzing:  
Generally, the license has the usage rule that restricting the limits of authority of 
the digital content. Thus, the DRM module need able to parse the usage rule and 
control the usage of the digital content. 
(5) Control content delivery:  
In proposed schemes, we allow that the user delivers the digital content under the 
usage rule. However, the DRM module need to ascertain that the legitimacy of 
the delivery. 
 
The following is the notations and abbreviations are used in our proposed 
schemes. 
Table 2: Notations table 
Notation Description 
CK The cipher key used in 3G 
( )K mE  The message m is encrypted by using the secret key. 
ID3G The identity of the 3G operator 
IDCP The identity of the content provider 
IDCT The identity of the encrypted content  
IDMS The identity of the consumer 
h( )‧  The one-way hash function 
HCi The hash chain hash i times  
HWMS The hardware information of the 3G consumer 
K3G_CP Pre-share key with the 3G operator and content provider 
Signalling
GPRS
3G Operator
Billing
3G based 
Bussiness 
association
Content Provider
Content License
3G Co
nsum
er
Mobile 
equipment
OMA
DRM Module
UICC/USIM
 
Figure 8: Overview of our DRM solution in scenario 1 
 
4.2.1  System Process of Scenario 1 
In this scenario, the 3G consumer does not need to register to the content 
provider before he/she consumes the digital content. However, the digital content will 
bind the consumer’s hardware. That is meaning that the digital content will not to 
delivery to other device, even the owner of the device had bought the digital content. 
In addition, the mobile equipment of the consumer must support the functionality of 
OMA DRM [28]. There are four steps in this protocol, and the process is described as 
follows. 
(1) License request: 
When a 3G consumer received the promotion information from the content 
provider through 3G network. However, the consumer is not the member of the 
content provider, and he/she still want to buy the digital content and not willing 
to register to the content provider because of many reasons. Therefore, the 
consumer must send a request to the content provider for acquiring the digital 
content and billing as follows. 
MS→CP:  
( )3 1 1
, ,, ( , , ( ), ), , ,
h CKG MS MSK
T TID E PN PI h OI HW PN OI HW  
(2) Cipher key request:  
When receiving the message from the 3G consumer. The content provider will 
accord ID3G to find the pre-shared key with the 3G operator (K3G_CP). Thus, the 
the 3G consumer wants to deliver the digital content to other device, thus, the 3G 
consumer must to perform the registering protocol and execute the rendering protocol. 
The registering and rendering protocol will describe in next section. 
 
4.3 Scenario 2 
In our proposed schemes, we focus on the process of license acquiring and 
protecting. The encrypted content can be obtained from various ways, such as 
downloading from the website of the content provider through Internet or through the 
technique of the superdistribution [17, 37]. In this scenario, the 3G operator provides 
an integrated platform that establishing the related specification about DRM, such as 
media formats, encryption/decryption systems and usage rule established. Every 
content provider wants to join to the business model, it must to comply with the DRM 
specification that formulated by the 3G operator. Furthermore, since the 3G 
environment have intact security architecture, thus, we can use the security 
architecture of 3G network to assist in designing the protocol. However, the major 
issue in this scenario is how to overcome the problem of non-repudiation. The 
property of non-repudiation is meaning that one consumer do not repudiate the 
business transaction. In general, most of protocols are using the technique of digital 
signature to achieve the property of non-repudiation. As everyone knows, the 
technique of digital signature is adopting the public-key cryptosystems to achieve the 
non-repudiation. However, the public-key cryptosystems have heavy computation 
operations, its will increase the loading of the mobile equipments. Due to the mobile 
equipments have less power and lack of the computation ability, thus, the protocol in 
this scenario should reduce complicated operations, such as exponent operation and 
pubic-key cryptosystem. 
 
In this scenario, the consumer must register to the 3G operator to start using the 
DRM services and setup the DRM module. In our protocol, we reduce the relationship 
between the consumer and the content provider, because of the integration reason.  
 
In our proposed solution, the 3G consumer is unnecessary to maintain the 
relationship of membership with content providers. That implies that the 3G consumer 
can obtain various legal digital content through different content providers, even the 
3G consumer is not the member of the content provider. The main idea of proposed is 
that as long as the content provider has the agreement relationship with the 3G 
operator and provides its digital content in accordance with the DRM specification 
that formulated by the 3G operator. Thus, the 3G consumer can through 3G network 
or Internet to purchase the legal digital content that the content provider provided. 
the 3G consumer. When receiving the message from the 3G consumer, the 3G 
operator accords IDMS to find the pre-shared key with the 3G consumer (K3G_MS), 
and check the IDMS and PN (extracted 
from
3 _
, , ( ( ))( )
G MSK MS MS MS
ID PN Sig h s IDE ⊕ ). If the results are true, then the 3G 
operator confirms the identity of the 3G consumer. Therefore, the 3G operator 
choose a random key (KDRM) and records it with IDMS and ( ( ))MS MSSig h s ID⊕ to 
its database. Finally the 3G operator transfers the DRM module with the share 
key (KDRM) to the 3G consumer. Note that, the DRM module will bind the 
hardware information (HWMS) of the 3G consumer to prevent the illegal 
distribution.  
Finally, after the 3G consumer receives the DRM nodule, he/she must setup it to 
his/her device, thus, the registering protocol is complete. Therefore, the consumer can 
perform the consuming protocol to consume the digital content that provided by the 
content provider.  
 Consuming protocol 
After the 3G consumer to start using the DRM services (means the 3G consumer 
had been to register to the 3G operator), the 3G consumer can perform this protocol to 
buy the digital content that the 3G consumer interested. Figure 10 illustrated the 
process of this protocol and Figure 11 showed the detailed flow. There are four steps 
in this protocol, and the process is described as follows. 
(1) License request:  
When the 3G consumer obtains an encrypted content, he/she must require a 
license for playing. Therefore, the 3G consumer must send a request to the 
content provider for acquiring the license. Before that, the 3G consumer will 
compute the authentication hash chain ( ( || )i i MSHC h s ID= ) for achieving the 
property of the non-repudiation and send the following message to the content 
provider. 
MS→CP:  
IDMS, ID3G, 3 _ ( , , , ( ), )G MS
i
K MSE ID PN PI h OI HC , OI, PN, iHC  
(2) Cipher key request:  
When receiving the message from the 3G consumer, the content provider checks 
whether 1( )i ih HC HC += , where the 1iHC + is the hash chain value that the 
content provider last received. If the results are positive, the content provider will 
store iHC and accord OI to find the content key that the 3G consumer requested. 
Furthermore, the content provider sends a request for cipher key acquiring. The 
Thus, the DRM module will compute h(KDRM) and h(CK) and use them to get the 
content key (KCT). If the h(KDRM) and h(CK) are correct, the extracted KCT can decrypt 
the encrypted content well and the 3G consumer can play the digital content correctly 
and legally. Furthermore, when the 3G consumer plays the content, the DRM module 
will check h(KDRM). If true, the DRM module will play the content according by usage 
rule in the license. In addition, the DRM module stores h(CK) and IDCT into the key 
database that built in the DRM module for future use.  
 
In the future, if the 3G consumer wants to play the encrypted content, he/she also 
takes the encrypted content and the corresponding license into the DRM module. The 
DRM module will also check the h(KDRM), then take out the content id (IDCT) from the 
license, and find out the corresponding h(CK) in the key database. Thus, the DRM 
module using h(KDRM) and h(CK) to extract the content key (KCT). Finally, the DRM 
module can decrypt the encrypted content and play the digital content according by 
usage rule. 
 
In our proposed schemes, we allow the 3G consumer transfer his/her digital 
content and the corresponding license to other device. But, there is one limitation that 
the device must also installed the DRM module with the same pre-shared key (KDRM) 
that generated by the 3G operator when the 3G consumer registering. That is meaning 
the 3G consumer need to connect to the 3G operator and apply to download the DRM 
module. The 3G consumer needs to provide the identity of himself/herself and the 
device’s hardware information to the 3G operator. Therefore, the 3G operator will 
check the identity of the 3G consumer and transfer the DRM module to the consumer. 
Note that, the DRM module not only includes the pre-shared key, but also binds the 
3G consumer’s device hardware information. However, the 3G operator can control 
the number of times that the 3G consumer re-gets the DRM module, such as a 
consumer only can apply five devices to install the DRM module when the consumer 
registering. If the consumer wants to apply more than five times, thus, the 3G operator 
will charge to the consumer for extra usage of the DRM module.  
information. Figure 12 showed the detailed flow of the rendering protocol and the 
process is described as follows. 
(1) Rendering request:  
The 3G consumer takes the license and sends the rendering request to the content 
provider as follows. Note that, the license involves 
IDCT, 3,( ) ( ( ) )CT Gh CK K Sig h PI PN⊕ ⊕ , usage rule, HWMS and the content 
provider’s signature. The message of the rendering request is as follows. 
MS→CP:  
IDMS, ID3G, PN, License,
3 _
( , ))
G MSK MS
E ID PN   
(2) Identity confirmation and cipher key request:  
After receiving the request, the content provider parses the license and takes out 
the usage rule and 3 ( ( ) )GSig h PI PN⊕ . Therefore, the content provider sends 
the following message to the 3G operator. 
CP→3G:  
IDCP, IDMS, PN,
3 _
( , )
G MSK MS
E ID PN  
(3) Transfer the cipher key:  
When the 3G operator receives the message, it accords the IDMS to find the 
pre-shared key (K3G_MS) and uses it to obtain and check IDMS and PN. If the 
results are positive, the 3G operator checks the validity of the PN (extracted 
from
3 _
( , )
G MSK MS
E ID PN ). Thus, the 3G operator will transfer the following 
message to the content provider. 
3G→CP:  
ID3G, 3 _ 3( , , ( ) ( ))G CP DRMK GE ID PN h CK h K⊕ , 3 ( ( ))GSig h PI  
(4) Update the license:  
After receiving the message, the content provider will use K3G_CP to obtain ID3G, 
PN and ( ) ( )DRMh CK h K⊕ . Furthermore, the content provider checks the 
correctness of ID3G and PN. If true, the content provider accords the usage rule to 
construct a new license. Finally, the content provider transfers the new license to 
the 3G consumer as follows. 
License :{IDCT, h(KDRM)♁h(CK)♁KCT, RULE, 3 ( ( ))GSig h PI } 
key (KDRM). Finally, the 3G operator will deliver the DRM module to the 3G 
consumer. Due to the confidentiality and integrity, the process of the initiation DRM 
service will employ the technique of the SSL [40]. Figure 13 is illustrated the 
overview of our DRM solution in scenario 3.  
 
Figure 13: Overview of our DRM solution in scenario 3 
 
4.4.1 System Process of Scenario 3 
After the 3G consumer initiated the DRM services, he/she can perform this 
protocol to buy the digital content that the 3G consumer interested. In this protocol, 
we employ the technique of dual signature. The dual signature is designed for the 
Secure Electronic Transaction (SET) [23] in order to achieve the property of the 
non-repudiation. The SET protocol [23] was developed by Microsoft, IBM, Netscape, 
GTE, Visa, and MasterCard in 1996. It major objective is ensuring the security of the 
financial transactions on the Internet. Figure 14 illustrated the detailed flow. There are 
four steps in this protocol, and the process is described as follows. 
(1) License request:  
When the 3G consumer obtains an encrypted content, he/she must require a 
license for playing. Therefore, the 3G consumer must send a request to the 
content provider for acquiring the license. Before that, the consumer will 
generate the dual signature ( ( ( ( ) || ( )))
MSKRE h h PI h OI ). For briefly, the dual 
Moreover, the content provider will store the 3 ( ( ), )GSig h PI DS as the receipt. 
Finally, the content provider can construct the license, make a signature of the 
license and send it to the consumer as follows. 
License :{IDCT, h2(KDRM)♁KCT, RULE, 3 ( ( ), )GSig h PI DS } 
3G OperatorContent ProviderConsumer
IDMS, ID3G, OI, h(PI), DS, T1
1. License request
IDCP, PN, T1
4. Transfer the license
License :{IDCT, RULE, Sig3G(h(PI), DS), 
h2(KDRM)♁KCT}
2. Billing request
3. Transfer the DRM module key
K (IDMS, PI || h(OI) || DS, T1)
ID3G, 
(ID3G, h2(KDRM), h(OI), T2) EK3G_CP
Sig3G(h(PI), DS), T2
(IDMS, PI || h(OI) || DS, T1)E h(KDRM) Eh(KDRM)
Figure 14: Detailed flow of the scenario 3 protocol 
 
Finally, after the 3G consumer receives the license, he/she can take the encrypted 
content and the license into the DRM module which is built on his/her mobile device. 
Thus, the DRM module will compute h2(KDRM) get the content key (KCT). If the 
h2(KDRM) is correct, the extracted KCT can decrypt the encrypted content well and the 
3G consumer can play the digital content correctly and legally. Furthermore, when the 
3G consumer plays the content, the DRM module will check KDRM. If true, the DRM 
module will play the content according by usage rule in the license.  
 
 In this project, we proposed a total solution for DRM that integrating the 3G 
security architecture. In our protocol, we divided into three scenarios. However, each 
scenario achieved different functionalities. Thus, we summarize the functionalities 
and operational capabilities of each scenario in Table 3. 
 
 
 
 
 
 
prevent the reply attack. Thus, if the content provider replies the request the obtained 
from the 3G consumer, the 3G operator will conscious that the request is illegal. In the 
consuming protocol of the scenario 2, we adopt the technique of hash chain to prevent 
reply attack. If the attacker or the content provider replies the request message to the 
3G operator, thus, the 3G operator will find out this request message is illegally by 
checking the value of hash chain ( 1( ) ?i ih HC HC += ) and the valid period of 
timestamp. Furthermore, we adopt timestamp technique to prevent the attacker 
replying the cipher key respond message. If an attacker tries to reply the respond 
message from the 3G operator (ID3G, 
3 ( ( ), )
i
GSig h PI HC , 3 _ 13( , ( ) ( ), ( ), )G CP DRMK GE ID h CK h K h OI T⊕ ,T1) to the content 
provider, the content provider will reject it, because the content provider will check 
whether the timestamp (T1) are within a valid period. Similarly, we employ the 
technique of timestamp to prevent the reply attack in scenario 3 protocol. 
 
4.5.3 Forgery Attack 
In our proposed protocol of scenario 1 and scenario 2 are suitable for use in 3G 
environment. However, in 3G network, the cipher key (CK) only the mobile device 
and the 3G operator can learn the information. Moreover, the cipher key is not used 
for unlimited period of time. That means the cipher key will re- establish with the 3G 
operator and the consumer at regular intervals. So, no one has the ability to forge 
other legitimate user’s identity, because the CK is only knows with the 3G operator 
and the mobile device. Therefore, even the content provider will not fabricate the 
request message. In scenario 3, the 3G consumer has pre-shared key with the 3G 
operator. Thus, no one can forge the legitimate user’s identity except the pre-shared 
key compromise. 
 
4.5.4 The Property of Non-repudiation 
In electronic commerce, the property of the non-repudiation is an important issue. 
Generally, most of solution is using digital signature to achieve the property of 
non-repudiation. Thus, in our protocol of scenario 3, because of the personal 
computer has more power and computation ability, so we employ the technique of 
dual signature to achieve the non-repudiation. However, In the consuming protocol of 
scenario 2, due to the mobile device has less power and computation ability and the 
technique of digital signature will lead to mass computational cost. Thus, we employ 
the technique of hash chain to solve the problem of non-repudiation. If the consumer 
has some doubts about billing, he/she doubts whether the 3G operator overcharge. 
Thus, the consumer, the content provider and the 3G operator must provide related 
solutions, a user has to keep business associations with each content provider before 
he accesses the different contents. It is not efficient when there are many content 
providers. Furthermore, the content providers need to deal with the billing system 
problems and it costs much to maintain the bill information. The 3G system provides 
global coverage and necessary network and management infrastructure to cater for 
security, roaming and billing. Therefore, the digital content provider can associate 
with the 3G system to sell the digital content. The 3G environment provides a good 
solution for developing DRM system. Since a cell phone can offer more reliable 
personal information and keep the billing system existed and authentication 
architecture matured, the content provider can team up with the 3G operator to have 
the benefit of 3G system. 
Furthermore, the 3G operator worries about the utility rate of their PS domain 
service. There is no successful application like the voice communication of CS 
service in the PS service. Therefore, we propose a DRM solution based on 3G 
network. In our protocol, a 3G user can use UMTS security architecture to buy a 
content license from a content provider through the 3G PS service or Internet. If the 
3G PS service has high data transmission rates and good quality of service, the user 
may also use 3G PS service to download content. It is likely that the user will accept 
the DRM solution based on 3G network when the 3G handset has high computation 
capability and multimedia functions. As to the consumers, the advantage is that they 
only take care of one business associations with the 3G operator and receive only 
single bill. On the other hand, the content providers do not need to deal with the 
billing system and can share numerous customers of the 3G operator. The 3G operator 
also can get some benefits of the PS service access and user authentication service 
fees. Therefore, we sum up the advantage of integrating the 3G with DRM as follows. 
 The viewpoint of the 3G operator 
(1) Increase the utility rate of the PS domain service:  
The 3G operator worry about the utility rate of their PS domain service is 
too low. Thus, integrating with DRM will increase the utility of the PS 
domain service. 
(2) Provide variety application services:  
With the numerous content providers join, the 3G operator can offer more 
services.  
(3) Gain the extra revenues:  
Because the 3G operator provides an integrated platform, the content 
provider will pay the fix amount of money in one business transaction. 
 The viewpoint of the content provider 
(1) The security architecture of 3G is provided:  
perform the rendering protocol after the consumer register. In scenario 2, due to the 
mobile device is less capable in computation and has low power. Our proposed 
protocol employs some hash functions, XOR operations, symmetric cryptosystems 
and once public-key digital signature for reducing the computational cost of the 
consumer’s mobile device. In scenario 3, we propose the solution that allowing the 
consumer can obtain the legal digital content via Internet. We employ the technique of 
dual signature to achieve the non-repudiation in this scenario. Moreover, Many DRM 
solutions do not allow a user to transfer content to other devices. However, in our 
protocol, we allow the consumer to transfer the encrypted content and the 
corresponding license to other device under the usage rule. 
 
There are many commercial DRM solutions on the market. Unfortunately, each 
DRM solution has different model and protocol. More important is each DRM 
solution is not compatible. That will bring inconvenience to the consumer and resist 
using DRM systems. In this study, we proposed a total solution about DRM that 
integrating the DRM model indirectly. Since the 3G operator provides a platform for 
developing the DRM system, it will formulate the related DRM specification. Thus, 
any content provider want to join to the business alliance  needs to comply with this 
specification to generate the encrypted digital content, usage rule, and license. 
Therefore the consumers only take care of one business associations with the 3G 
operator and they can obtain the legal digital content from various content providers. 
 
Reference 
[1] 3GPP, Tech. Spec. Group, Core Network, GPRS Tunneling Protocol (GTP) 
across 
[2] 3GPP, Tech. Spec. Group, Svcs. and Sys. Aspects, General Packet Radio Service 
(GPRS); Service Description,” Tech. Spec. 3G TS 23.060 v. 6.0.0 (2004-09), 
2004 
[3] 3GPP, Tech. Spec. Group, Svcs. and Sys. Aspects,“Digital Rights 
Management,” Tech. Spec. 3G TS 22.242 v1.0.0, (2003-03), 2003 
[4] 3GPP, Tech. Spec. Group, 33.102 (v6.2.0), 3G Security, Security Architecture, 
Release 6, Sep 2004. the Gn and Gp Interface,” Tech. Spec. 3G TS 29.060 v. 
6.6.0 (2004-09), 2004 
[5] 3GPP, Tech. Spec. Group, 33.908 (v4.0.0), 3G Security; General report on the 
Design, Specification and Evaluation of 3GPP Standards Confidentiality and 
Integrity Algorithms, Release ’99, Sep 2001 
[6] “Advanced Encryption Standard (AES),” FIPS PUB 197, Nov. 2001; 
[27] N. Garnett, “Digital Rights Management, Copyright, and Napster,” ACM 
SIGecom Exchanges, Vol. 2, Iss. 2, pp.1-5, 2001 
[28] OMA DRM; http://www.openmobilealliance.org 
[29] Q. Liu, R. Safavi-Naini and N. S. Sheppard, “Digital Rights Management for 
Content Distribution,” Proceedings of the Australasian information security 
workshop conference on ACSW frontiers, January 2003. 
[30] Real Networks, RealSystem Media Commerce Suit Technical White Paper; 
http://www.realnetworks.com/products/commerce 
[31] R. Grimm, P. Aichroth, "Privacy protection for signed media files: a 
separation-of-duty approach to the lightweight DRM (LWDRM) system," 
Proceedings of the 2004 multimedia and security workshop on Multimedia and 
security, pp.93-99, September 2004 
[32] R. H. Koenen, J. Lacy and M. Mackay, “The Long March to Interoperable 
Digital Rights Management,” Proceedings of the IEEE, Vol. 92, Iss. 6, pp. 
883-897, June 2004 
[33] R. Iannella, Open Digital Rights Language (ODRL) version 1.0,” IPR System 
Ptd Ltd., November 2001 
[34] R. Iannella, The Open Digital Rights Language: XML for Digital Rights 
Management,” Information Security Technical Report Vol. 9, Iss. 3, pp. 47-55, 
July - September, 2004 
[35] R. L. Rivest, A, Shamir, and L. Adleman, A Method for Obtaining Digital 
Signatures and Public-Key Cryptosystems,” Communication of. ACM, vol. 21, 
Iss. 2, pp. 120-126, 1978 
[36] R. L. Rivest, “The MD5 Message Digest Algorithm,” RFC 1321, 1992. 
[37] R. Mori and M. Kawahara, Superdistribution: The Concept and the 
Architecture,” The Transaction of the IEICE, vol. E73, no. 7, July 1990. 
[38] R. Stern, “Napster: a walking copyright infringement?” IEEE Micro., vol. 20, 
Iss. 6, pp.4-5, 95, Nov.-Dev. 2000 
[39] S. H. Kwok, “Digital rights management for the online music business,” ACM 
SIGecom Exchanges, Vol. 3 Iss. 3, June 2002 
[40] SSL Protocol Version 3.0 Specification; http://wp.netscape.com/eng/ssl3/ 
[41] T. ElGamal, “A public-key cryptosystem and a signature scheme based on 
discrete logarithms,” IEEE Transaction on Information Theory, Vol.IT-31, No4, 
pp. 469-472, 1985. 
[42] T. Messerges and E. Dabbish, “Digital rights managements in a 3G mobile 
phone and beyond,” Proceedings of the 2003 ACM workshop on Digital rights 
management, October 2003 
[43] “Proposed Federal Information Processing Standard for Digital Signature 
