項；當一個行動客戶端查詢資料時，會先查詢自己
的快取空間，再查詢鄰近節點的快取空間，若都找
不到有效的資料項，最後會向伺服器端查詢資料，
這種快取方法稱為合作式快取(Cooperative cache)。 
4. 相關研究 
目 前 ， 在 合 作 快 取 的 相 關 研 究 有
[6][7][8][9][10][11]。其中，在[6][7]中， Cao 提出
的協助一個節點尋找鄰近節點中的快取資料項的
方法；在[11]中，Hara 提出如何協調鄰近節點，共
同決定快取空間的配置方法； 在[8]中作者提出如
何在 MANET 中快速尋找有效版本以及快取空間
的 管 理策略 ： 在 [9][10] ； 作 者 提出 點 對點
(Peer-to-Peer)的合作快取方法。這些方法[6-11]所
採用的資料一致性準則，是所謂的弱資料一致性
(weak data consistency)，亦即紀錄快取資料項到何
時為止仍然有效(Time-to-Live)，若目前時間超過
TTL 時，快取資料版本即失效；在此準則下，快取
資料項無法與伺服器端保持同步。 
目前考慮資料（同步）一致性的快取方法比較
少。在[1-2]中，Cao 提出以廣播的方式尋找有效資
料版本及維持快取資料一致性的方法(ACOD)。其
方法如下：(一)、行動客戶端向伺服器端廣播尋找
資料項的查詢封包；（二）、所有接收到查詢封包的
節點，會將該資料項的快取版本的時戳，附加在查
詢封包上；（三）、伺服器端會驗證快取版本的有效
性，並通知行動客戶端；（四）行動客戶端向一個
存有有效版本的節點，取的所需資料項的內容。 
在[3]中， Leu 等提出一個改進 ACOD 的方
法，稱為 NCIS。該方法的主要精神是，以單播的
方式決定尋找資料的廣播半徑；在該廣播半徑內，
以廣播的方式，尋找所需資料項的有效版本。其方
法如下：（一）、客戶端以單播的方式（透過繞境協
定），送出資料驗證封包(request packet)到伺服器
端，其中包含所需資料項名稱，及自有版本(local 
copy)的時戳；（二）、伺服器端沿著之前單播的路
徑，以回應封包（response packet）回傳所需資料
項的最新時戳，以及一個初始值為 1 的跳躍數
(hop-count)；（三）、路徑上的節點收到回應封包
時，若本身有有效（最新）的版本時，會將 hop-count
重設為 1，並回傳封包：否則，將 hop-count 加 1，
並回傳封包；（四）、客戶端以所收到的回應封包的
hop-count 值為廣播半徑，以廣播的方式尋找所需
資料項的有效版本。與 ACOD 相比，NCIS 具有兩
個優點：（一）、廣播半徑可能比較小；（二）、先作
驗證，再做搜尋，若本地版本有效，則不需再進行
廣播搜尋。 
由於 ACOD 及 NCIS 都必須透過廣播搜尋資
料，在 MANET 上進行廣播，容易引起廣播風暴，
且有隱藏節點（hidden terminal）的問題，耗時又
耗電。且兩者都沒有提到快取配置（應該快取誰？）
的問題。本論文提出一個在強一致性的要求下，不
需要廣播，考慮快取配置，回應時間短且能源耗費
少的合作快取方法。 
5. 研究方法 
本研究方法分為系統環境設定、擴展樹的建立、合
作快取方法 CA 及 PIU、客戶端資料需求處理、伺
服器端資料異動處理及重新規劃路徑等，茲分述如
下： 
 
5.1 系統環境設定 
(1).無線隨意網路環境: 
假設有 n 個節點，存在於無線隨意網路環境中，
N={N1，N2，…，Nn}代表節點的編號，節點的能
源有限，節點可以在指定的範圍內任意移動，節點
和節點之間或節點與伺服器之間，利用多點跳躍
(multi-hop)的方式進行溝通。 
(2).存在一個資料伺服器: 
共有 d 個資料項(D>0)，D={D1，D2，…，Dd}代
表資料編號，資料項的更新都在伺服器端進行。 
 
5.2 快取路徑擴展樹的建立 
我們所提的方法是透過一條規劃出的路徑，搜尋快
取資料項；一開始，伺服器端以廣播的方式進行路
徑的規劃，參考[4]的方法，為每一個客戶端尋找
一條到達伺服器的路徑；不同的是， [4]中為每一
個客戶端到達伺服器端所選的路徑，具有最少的跳
躍數。而我們所選的路徑，具有節點與節點之間的
最大距離為最短的特性，主要原因是這種路徑在節
  
  
  
  
  
  
  
  
  
 
    
 
圖 2. CA 協同式快取分配示意圖
A 8 B 6 C 4 D 1
1
5
3
A B C D 
5 5 3 2 
Cache AB 
A B C D 
6 7 6 3 
Cache AB 
A B C D 
8 6 10 4 
Cache AC 
4
A B C D 
2 1 2 3 
Cache AD 
A 6 B 6 C 1 D 1 
A 5 B 5 C 3 D 2  
A 2 B 1 C 2 D 3  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
更新頻率 A3 B6 C5 D4  A 2 B 1 C 2 D 3 
5
1
圖 3.PIU 協同式快取分配示意圖 
 
 
(c) CAH (CA with Hop-count) 
這個方法和 CA 的變異，只是多考量了 Hop-count。
此方法的考量因素為，如果一個資料項沒有被某一
個節點快取時，則當此節點發生對此資料項的需求
時，它必須經過幾個 Hop 才能拿到這個資料項，此
方法會盡量降低這種 hop-count 數，作法為以
hop-count 為權重，計算累加頻率。 
以圖 4中的節點 3為例，c資料項的存取頻率，由
節點 4 貢獻 2，由節點 5 貢獻 3，自己貢獻 1：若
節點 3不快取資料項 c，則節點 4、5要取得 c，至
少要經過 2個 hop；所以在節點 3，c資料項的 CAH
值為 5*2+1*1=11。根據 CAH 值，節點 3 所快取的
資料項為 BC，依此類推。 
(d) PIUH (PIU with Hops-count) 
這個方法是以 PIU 為基礎，再加入未快取資料項時
的 Hops-count 考量，來計算 p/u 值，以圖 5為例，
節點 3 的資料項 c 的原 CAH 值為 11，所以其 PIUH
3
A B C D 
5 5 3 2 
Cache AB 
P/U: A 5/3  B 5/6 
     C 3/5  D 2/4 
A B C D 
6 7 6 3 
P/U: A 6/3 B 7/6  
C 6/5 D 3/4   
Cache AC 
A B C D 
8 13 4 4    
Cache AB 
P/U: A 8/3  B 13/6   
C 4/5  D 4/4 
4
A B C D 
2 1 2 3 
P/U: A 2/3  B 1/6 
     C 2/5  D 3/4 
Cache AD 
A 6 B 6 C 1 D 1
A 8 B 6 C 4 D 1 
A 5 B 5 C 3 D 2 
求時，可以先查看離自己一個跳躍數遠的子節點是
否存有其所需要的資料項，如果有就直接跟自己子
節點要，如果沒有就往伺服器端送出需求封包。 
(3).向伺服器端遞送資料需求封包 
如果這個資料項不存在客戶端的快取空間
中，而且客戶端一個跳躍數的子節點也沒有所需資
料項時，用戶端就必須透過規劃出的路徑往伺服器
端傳送需求封包，在傳送過程中也會對路徑上的其
它節點詢問是否有此需求資料項，如果存在這個資
料項就回傳給需要資料項的客戶端，這次查詢就完
成了。如果路徑上的節點都不存此資料項的有效快
取版本時，這個需求封包最終會到達伺服器端，再
經由伺服器端回傳所需資料項的內容到達需求客
戶端，這次的查詢就完成了。 
(4).當規劃路徑失效的資料項需求處理與路徑修
復方式  
    而當規劃出的路徑，因節點的移動而發生路徑
傳送失效時，節點可利用現有的路徑繞送協定
(Routing protocol)，例如:AODV，以單播的方式
將需求封包傳送到伺服器端，提出資料項的需求，
伺服器端再將需求資料項送回需求客戶端，這次的
查詢就完成了。 
以圖 6 為例，節點 N2 發生資料項 C 的需求，
首先會先確認本身的快取空間是否存在資料項
C，如果存在資料項 C，且資料項有效，這次的需
求就完成了，但節點 N2 並無快取資料項 C，此時 
 
 
 
 
 
 
 
 
 
圖 6. 發生需求資料項示意圖 
我們發現節點 N3 存有資料項 C，且為合法，節點
N2 會以單播的方式向節點 N3 送出一個 Request 
packet，節點 N3 收到後回傳資料項 C，當資料項 C
送達節點 N2 時，資料求需即完成。 
假設節點 N2 的資料項需求改為 I時，如圖 7所示，
我們發現，在節點 N2 與節點 N2 的子節點 N3、N4
都沒有快取資料項 I；所以節點 N2 必須透過固定
路徑向前傳送需求封包到資料來源端，過程中也會
去尋問節點 N1 是否存有資料項 I，如果沒 
 
 
 
 
 
 
 
 
        
 
圖 7. 發生需求資料項示意圖 
有就再往下傳，直到伺服器，而伺服器端會把資料
項 I依照原路徑送回到節點 N2，節點 N2 收到資料
I則需求完成。 
  在斷線節點透過 AODV 建立到伺服器端的路徑
後，即可詢問其路由路徑的下一節點，是否可加入
它的旗下而成為其新的子節點。加入後，斷線節點
即將其目前的累計頻率傳送給新的父節點，父節點
加入新的累計頻率後，透過漸進式取代的方式，將
快取資料慢慢調整並更新。 
5.5 資料異動的處理 
(1).透過規劃路徑進行資料項招回和更新 
當資料項在伺服器端發生異動時，伺服器端會主動
透過規劃路徑資訊，對存有失效資料項的節點進行
招回動作，以維護資料的一致性，之後再隨機選擇
數個距離伺服器端最近的存有失效資料項的節
點，進行資料項更新的動作，以減少發生需求資料
項時的回應時間，同時又不會耗費過多的能源在資
料項更新上。 
如圖 8所示，伺服器端發生資料項Ｃ的更新，
此時伺服器端可以透過規劃出的路徑資訊和節點
的快取內容進行招回，以下是有快取資料項Ｃ的節
點和路徑資訊： 
 (replace)的動作，透過這種方式，慢慢的把本身
的快取空間，一步一步轉換成目前應該快取的資料
項，而不會花費太多的封包傳送成本。以圖 9 為
例，當節點 N1 發生資料項 A 的需求時，發現自己
的快取空間並沒有這個資料項，而且自己的子節點
也沒有快取這個資料項，節點 N1 會向伺服器端送
出需求封包；伺服器端收到後會回傳資料項 A，而
當節點 N1 收 A 時，發現資料 A 是目前應該快取的
資料項，節點 N1 會先對 A 做暫存的動作，並送出
確認封包到伺服器端，這個封包也包含了目前暫存
資料項 A的時間戳記(Time Stamp)，一同送達伺服
器端，讓伺服器修正節點快取的資訊，這樣下次 A
資料項失效時，伺服器端才會對節點 N1 進行失效
資料項招回的動作。透過這種方式，慢慢的將每個
節點的快取內容換置成重新分配後，節點應該快取
的資料項。利用這種方式，不會因整個快取空間的
完全換置，而造成龐大的能源消耗和網路負載。 
 
我們所模擬的參數為，在長 1200 公尺，寬 800
公尺的長方形空間中共有 50 個自由移動的節點， 
移動速度為每秒 0.1 公尺，節點的傳輸半徑為 250
公尺，節點的快取空間為 2.5KB。任意指定一個節
點為伺服器節點，伺服器所存有的資料項為 1000
個資料項，每一個資料項的大小固定，都為
0.05KB，提供給節點們進行存取，而資料項的更新
頻率的預設值為平均每 80 秒更新一次，資料項的
查詢需求頻率預設值為平均每 80 秒一次，表 1為
實驗參數的列表。 
在能源耗損部分，我們參考[5]當中的計算公式 
來行進能源耗損的計算和評估。 
6.2 評估指標 
我們主要是由下幾點進行效能評估: 
(1).查詢回應時間: 
 當一個節點發生資料項的需求時，從發生這個資料
項需求，到滿足這個資料項需求所經過的時間，我
們稱為回應時間。 
6.實驗模擬與分析 
為了比較我們所提的方法與其他方法在快取資料
項上面的表現，我們以 NS2 網路模擬軟體進行實
驗。 
 (2).整體網路能源耗費 
    由於節點的電力有限，在資料查詢的過程中，
我們必須考量能源的耗損，以減少能源的支出。 表 1. 實驗環境參數設定 
(3).封包數總和 
當整體網路中的封包數愈少，整個網路的負載量也
就愈少，所以我們也以封包數做為一個衡量指標。 
6.3 回應時間的比較 
我們先對回應時間的比較進行說明，圖 10 所示，
我們發現因為 ACOD 和 NCIS 在需求發生時，都必須
到伺服器端進行資料驗證，之後才能透過驗證的結
果，找尋有效的資料項，而我們提出 Tree-based
的規劃路徑方式，則不用到達伺服器端進行資料的
驗證，所以回應時間較 ACOD 以及 NCIS 小很多。 
相同的，在圖 11 中我們所提出的 Tree-base 方法
也會較 ACOD 和 NCIS 具有更快的回應時間。 
另外，我們比較圖 10 和 11 發現，考量了更新頻率
的 PIU 和 PIUH 這兩個方法，其回應時間會較未考
量更新頻率的 CA 和 CAH 這兩個方法來的長，這是
因為考量更新頻率時，我們會把較常 
項目 值 
模擬網路範圍 1200 公尺 x1000 公尺 
節點個數 50 個 
傳輸距離(R) 250 公尺 
節點移動速度 0.1 公尺/秒 
節點快取空間大小 2.5KB 
節點平均要求查詢
週期 
80 秒( 20 ~ 200 秒 ) 
資料來源端個數 1 
資料總數量 1000 
資料大小 0.05KB 
資料平均更新週期 80 秒( 20 ~ 200 秒 ) 
路由通訊協定 AODV 
SKEW 0.85 
6.1 參數設定 
server 
(b) server 使用 unicast，將目前 ser
上 data
ver
的 timestamp，從 reverse path 回
項時，則query
不為合法資料項
 
要資料 
 IS
躍個數分 析︰ 
定會花費 2*L
(ii) 
數為 0。而不擁
(iii) 
到 count 欄位期望值，我們可
播半徑即
傳回 requesting node (中間的 node會更新
此封包的 hop-count 欄位) 
(c) 如果 requesting node 本身擁有該
資料項，且也仍為合法資料
處理步驟至此結束。 
(d) 若 requesting node 本身並無擁有
該資料項，或該資料項
時，則 requesting node 根據收到的
hop-count 欄位，作 hop-count 範圍大小的
broadcast 
(e) requesting node 向最先回應 ACK 
packet 的 node
 根據上面的動作，我們將 NC 的平均節點跳
就幾個部份進行分
(i) 步驟(a)、(b)，為 NCIS 協定的固定成
本，即每次 query，一
的 hop 數，到 server 詢問所需資料項
的最新 timestamp。 
在步驟(c)，節點擁有合法資料項的機
率為 PValid，所需節點
有合法資料項的機率為(1-PValid)，此
時將繼續進行 query 處理的步驟(d)
與(e)。 
分析 requesting node 在步驟(d)，所收
的 hop-
約略估算為路徑長度的一半，因此廣
2
L 。 
(iv) 步驟(e)所需的 hop-count 由四個小步
驟所組成︰ 
式，詢問周圍鄰居節點是否擁
告知 requesting 
 
(擁
點與 requesting 
，
即在
 requesting node 以廣播方
有合法資料項 
 擁有合法資料項的鄰居節
點，以ACK封包
node 它擁有最新資料項 
 requesting node 向最先收到
回應的鄰居節點要求資料
 該鄰居節點傳送資料給
requesting 
此步驟下，所使用的 hop-count，應為
有合法資料項鄰居節
node 之距離) * 4。我們在估計在廣播過
程中，在廣播半徑的一半距離的節點
1
2 2 4
L L* = 的距離的節點中，會擁
有合法資料項。因此，此步驟的
hop-count 期望值為 *4
4
Average Ho
L L= 。 
綜合以上所述，我們可將 NCIS 的
p Count 整理如下︰
2* (1 )*ValidCacheNCIS L P L= + −  
 
7.2 CA 的 hop count 分析   
CA 處理 query 步驟如下︰ 
(a) 確認本身的快取
間 
hild node 是
message 向
間有任何節點擁
資料回原節點。 
在 q
論兩種
(
(
此
的各節
空
(b) 確認 c
否有可用資料 
(c) 使用 unicast 的方
式，沿著規劃路徑
傳送 control 
server，若路徑中
有該資料，則回傳
uery 的 hop-count 討論中，我們將分別討
不同的 case︰ 
a) 節點所要求的資料項已因 server招回
callback)而失效 
case 的發生機率為(1-PValid)。則此時節
點自身、其子節點、規劃路徑上
Networks,'' IEEE International Conference on Mobi
Ad-hoc and Sensor Systems (MASS), 2004. 
[2]S. Lim, W
le 
. Lee, G. Cao, and C. Das, “Cache 
g Policy for Mobile Ad Hoc 
rence on 
, 
. Kim, “An 
 Consumption of a Wireless Network Interface 
EE 
ice in MANETs,” Autonomic and 
ce 
 2005, 
 
 
a 
Replication for Improving Data Accessibility in Ad 
Hoc Networks”, IEEE Trans. on Computers, Vol. 5, 
No. 11, Mobile Computing, November 2006.  
invalidation strategies for internet-based mobile ad 
hoc networks,” Computer Communications 30 (2007) 
1854–1869. 
[3] Y. Leu, J.J. Hung and M.B. Lin, “A New Cache 
Invalidation and Searchin
Networks,” WSEAS International Confe
Computer Engineering and Applications, Gold Coast
Australia, January 2007. 
[4] D. Kim, J. Kim and K.H
Energy-efficient Data Gathering Technique using 
Multiple Paths in Wireless Sensor Networks,”  IEEE 
CCNC 2006 proceedings. 
[5] L. Feeney and M. Nilsson, “Investigating the 
Energy
in an Ad Hoc Networking Environment,” in 
Proceedings of IEEE INFOCOM, Anchorage, AK, 
2001. 
[6] L. Yin, and G. Cao, “Supporting cooperative 
caching in ad hoc networks,” IEEE Transactions on 
Mobile Computing, Volume 5, Issue 1, Jan. 2006. 
[7] G. Cao, L. Yin, and C.R. Das, “Cooperative 
cache-based data access in ad hoc networks,” IE
Computer Magazine, Volume 37, Issue 2, Feb. 2004. 
[8] Yu Du and S.K.S. Gupta, “COOP – A cooperative 
caching serv
Autonomous Systems and International Conferen
on Networking and Services, 2005. ICAS-ICNS
Oct. 2005. 
[9]C.-Y. Chow, H. V. Leong, and A. T. S. Chan, 
“Cache Signatures for peer-to-peer cooperative 
caching in mobile environment,” in Proc. of 
International Conference on Advanced Information 
Networking and Applications, Mar. 2004, PP. 96-101. 
[10] C.-Y. Chow, H. V. Leong, and A. T. S. Chan,
“GroCoca : Group-based Peer-to-Peer Cooperative 
Caching in Mobile Environments,” IEEE Journal on
selected areas in  communications, JAN. 2007. 
[11] Takahiro Hara and Sanjay K. Madria, “Dat
 附件一 
行政院國家科學委員會補助專題研究計畫 5 成 果 報 告   □期中進度報告 
 
行動隨意網路中之合作快取與資料散佈之研究 
 
計畫類別：5個別型計畫   □整合型計畫 
計畫編號：NSC 98－2221－E－011－115－ 
執行期間： 98 年 8 月 1 日至 99 年 7 月 31 日 
 
執行機構及系所：國立台灣科技大學資訊管理系 
 
計畫主持人：呂永和 
共同主持人： 
計畫參與人員：李建邦、何明璇、范恆嘉 
 
 
 
成果報告類型(依經費核定清單規定繳交)：5精簡報告  □完整報告 
 
本計畫除繳交成果報告外，另須繳交以下出國心得報告： 
□赴國外出差或研習心得報告 
□赴大陸地區出差或研習心得報告 
5出席國際學術會議心得報告 
□國際合作研究計畫國外研究報告 
 
 
處理方式：除列管計畫及下列情形者外，得立即公開查詢 
            □涉及專利或其他智慧財產權，□一年□二年後可公開查詢 
 
中   華   民   國 99  年 10 月 31 日 
 2
 4
3. 請依學術成就、技術創新、社會影響等方面，評估研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）（以
500 字為限） 
本研究是要建立一個無線行動隨意網路中的合作快取方法，讓無線行動隨意
網路的使用者可以透過合作快取的機制，快速地取得儲存在資料伺服器上的
資料庫資料。本方法透過建立一個擴展樹的合作快取結構，讓行動節點可以
有效率地互相幫忙存取及驗證所需要的資料。因觀念創新，理論分析完整，
有機會成為一篇國際期刊的論文；因此，正在努力修改及驗證 NS2 模擬程式，
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
國科會補助專題研究計畫項下出席國際學術會議心得報告 
                                     日期： 99年 10月31 日 
計畫編號 NSC98－2221－E －011 －115－ 
計畫名稱 行動隨意網路中之合作快取與資料散佈之研究 
 
出國人員
姓名 呂永和 
服務機構
及職稱 國立台灣科技大學資管系 
會議時間 99年 3月 24日至 99 年 3 月 26 日 會議地點 越南順化 
會議名稱 
(中文)第二屆亞洲智慧型資訊及資料庫系統 
(英文) The 2nd Asian Conference on Intelligent Information and Database Systems  
 
發表論文
題目 
(中文)一個基於模糊時間序列與類神經網路的選擇權預測方法 
(英文) A fuzzy time series-based neural network approach to option price forecasting  
 
附件四 
一、參加會議經過:職於 99 年 3 月 24 日下午到達越南順化古城，進駐當地旅館，隨
即前往 Hue University 的一個研究中心報到，晚上前往參加歡迎酒會；3 月 25 日
參加會議所安排的 city tour，參觀越南王室陵墓及王宮，隨後參觀順化城的街道。
於 3 月 26 日離開。 
二、與會心得：簡報論文時仍有不順的地方，雖相較於其它台灣去的報告者好很多，
但仍須改進，我想以後如果能用英文上課，當有機會進行良好的簡報；不過職的一
般會話英文倒是對答如流，為台灣進行了一場良好的國民外交。 
 6
 
國科會補助專題研究計畫項下赴國外(或大陸地區)出差或研習心得報告 
                                     日期：   年   月   日 
計畫編號 NSC  －    －  －    －    － 
計畫名稱  
出國人員
姓名  
服務機構
及職稱  
出國時間  年 月 日至  年 月 日 出國地點  
附件五 
一、國外(大陸)研究過程 
二、研究成果 
三、建議 
四、其他 
 
 
 
 
 
 
 
 
 
 8
國科會補助計畫衍生研發成果推廣資料表
日期:2010/11/02
國科會補助計畫
計畫名稱: 行動隨意網路中之合作快取與資料散佈之研究
計畫主持人: 呂永和
計畫編號: 98-2221-E-011-115- 學門領域: 資料庫系統及資料工程
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
無 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
