 I
摘要 
本計畫主要是發展一套偵測(detection)與切割(segmentation)技術，精確地從新柏氏電腦超
薄(ThinPrep)子宮頸抹片不同倍率之上皮細胞(epithelial cells)影像中，切割出細胞質(cytoplasm)
與細胞核(cell nucleus)輪廓，以便分析出子宮頸細胞正常(normal)或異常(abnormal)現象。 
子宮頸癌(cervical cancer)為婦女最常見的癌症之一，亦位居婦女十大死亡原因之首。採
用子宮頸抹片檢查做為子宮頸癌之偵測已達數十年之久，該項技術同時也是預防子宮頸癌的
最佳方法。ThinPrep 是一項專門針對改善抹片採檢品質的一大革新發明，目前美國食品藥物
衛生管理局(FDA)已通過 ThinPrep 為合格的抹片製作方式，且已經廣泛運用於婦產科採檢，
其準確度高達 93%，是子宮頸抹片細胞影像分析之優良題材。 
本計劃的主要目的，係希望在藉由電腦的輔助之下進行自動判讀，以減少人為疏忽、提
高影像判讀的效能，及提升我國子宮頸癌細胞抹片的篩檢能力及檢查單位之篩檢品質。子宮
頸細胞常依據細胞核大小、細胞核質輪廓長度、核質比及核染顏色的深淺等特徵，來進行抹
片判讀。然而，上述特徵中除了核染顏色外，其餘特徵皆仰賴於精確的細胞輪廓切割技術。
因此，如何從一子宮頸細胞抹片影像中，確地分割出背景、細胞質與細胞核影像區域，便顯
得特別的重要。 
本研究於影像處理技術中，首先採用 mean filter，有效的去除影像中的雜訊。其次，利
用 Sobel 邊緣偵測(Sobel edge detection)產生物件輪廓邊緣線之梯度，再經由假邊緣處理(false 
edge processing)，該方法係以分析真實邊緣梯度大小與真實邊緣梯度在其鄰近範圍內之特
性，有效的保留真實邊緣梯度，去除雜訊梯度。在物件輪廓加強之梯度方面，主要是假設梯
度呈 log函數分佈，以做為加強物件輪廓梯度之依據。然而，於物件輪廓邊緣線之細線化方面，
本文採用非最大值刪除(non-maximum suppression)技術將邊緣線以線形方式顯示，再配合遲滯
性門檻(hysteresis thresholding)來決定物件的初始邊緣輪廓線。在邊緣萃取方面，主要係透過
近似細胞輪廓修補之處理，以確保細胞核輪廓的完整性，藉由細胞核邊緣線段輪廓為簡單封
閉曲線之定義，分析該曲線內之細胞核邊緣與細胞核內部的色階特徵，進而萃取出細胞核輪
廓。最後，將細胞核輪廓線上的每一像元定義為初始種子點(initial seed)，並運用區域成長
(region growing)演算法配合自適應性門檻與真實邊緣門檻值之設定，切割出細胞質區域。 
實驗部分，本文分別以 ThinPrep 子宮頸抹片細胞之 100 倍、200 倍、400 倍率的表層細
胞(superficial cell)、中層細胞(intermediate cell)、旁基底細胞(parabasal)及異常細胞等醫學影
像，做一系列的細胞輪廓偵測與切割之實驗分析。 
關鍵字：ThinPrep 子宮頸抹片、上皮細胞、倍率、偵測、切割、邊緣、輪廓、區域成長 
 III
目錄 
1. 緒論.................................................................................................................................................1 
1.1 研究背景...............................................................................................................................1 
1.2 文獻回顧...............................................................................................................................2 
1.3 研究目的...............................................................................................................................4 
2. 相關研究工作(relate works).........................................................................................................8 
2.1 邊緣連結(edge linking)與邊界偵測(boundary detection)...................................................9 
2.2 門檻值(thresholding) ..........................................................................................................10 
2.3 基於區域切割(region-bases segmentation) .......................................................................10 
2.4 SRGFE 演算法(SRGFE algorithm)....................................................................................10 
2.5 Connected Coherence Tree 演算法 .....................................................................................10 
2.6 Level Set 演算法 ................................................................................................................. 11 
3. 子宮頸細胞(cervical cell)影像前置處理(image preprocessing) .............................................. 11 
3.1 色彩空間(color space)轉換灰階影像(gray image) ........................................................... 11 
3.2 Haar 離散小波轉換(HDWT) ..............................................................................................12 
3.3 平均濾波器(Mean filter) ....................................................................................................12 
4. 邊緣偵測(edge detection)............................................................................................................13 
4.1 Sobel 邊緣偵測(Sobel edge detection) ..............................................................................14 
4.2 假邊緣處理(false edge processing)....................................................................................15 
4.3 邊緣加強(edge enhancement) ............................................................................................16 
4.4 非最大值刪除(non-maximum suppression)........................................................................17 
4.5 遲滯性門檻(hysteresis thresholding) .................................................................................18 
5. 細胞核(cell nucleus)邊緣萃取(edge extraction) .......................................................................18 
5.1 近似細胞輪廓修補和細線化處理......................................................................................18 
5.2 分水嶺(watershed)式的區域邊緣萃取..............................................................................20 
5.3 細胞核(cell nucleus)邊緣萃取 ...........................................................................................20 
6. 細胞質(cytoplasm)邊緣萃取(edge extraction)..........................................................................22 
6.1 區域成長特徵萃取種子法.................................................................................................23 
6.2 自適應性門檻值之區域成長法(region growing for adaptive threshold) .........................24 
 V
圖目錄 
圖(1)子宮頸抹片的表層細胞(400 倍率) ...........................................................................................2 
圖(2) 複層扁平上皮(Stratified squamous epitheium)(參考[46])...................................................5 
圖(3) ThinPrep 子宮頸抹片之複層扁平上皮細胞(100 倍率) .........................................................6 
圖(4) ThinPrep 子宮頸抹片之表層細胞(Superficial cells)分類 .....................................................6 
圖(5) ThinPrep 子宮頸抹片之中層細胞(Intermediate cells)分類 .................................................6 
圖(6) ThinPrep 子宮頸抹片之旁基底細胞(Parabasal)分類...........................................................7 
圖(7) ThinPrep 子宮頸 400 倍率表層異常細胞影像.......................................................................7 
圖(8) 不同影像的邊緣 .......................................................................................................................8 
圖(9) 邊緣清處的子宮頸細胞影像 ...................................................................................................9 
圖(10) 邊緣模糊不清的子宮頸細胞影像 .........................................................................................9 
圖(11) 子宮頸細胞影像 ................................................................................................................... 11 
圖(12)子宮頸細胞灰階影像 .............................................................................................................12 
圖(13) 一階 HDWT 示意圖 ............................................................................................................12 
圖(14) HDWT 後之影像 ..................................................................................................................12 
圖(15) 3×3 遮罩.................................................................................................................................13 
圖(16) 子宮頸細胞(cervical cell)400 倍率影像的前置處理 .........................................................13 
圖(17) 子宮頸細胞(cervical cell)400 倍率邊緣偵測結果 .............................................................14 
圖(18) 3×3 遮罩空間座標與運算子.................................................................................................14 
圖(19) 細胞核的邊緣影像 ...............................................................................................................15 
圖(20) 初步的假邊緣處理 ...............................................................................................................16 
圖(21) 假邊緣處理 ...........................................................................................................................16 
圖(22) 對數函數分佈的邊緣加強 ...................................................................................................17 
圖(23) 邊緣加強後影像 ...................................................................................................................17 
圖(24) 非最大值刪除後影像 ...........................................................................................................18 
圖(25) 邊緣細線化處理 ...................................................................................................................18 
圖(26) 近似輪廓修補的 8 種樣本 ...................................................................................................19 
 VII
表目錄 
表(1) 評估值 ME 比較表 ................................................................................................................38 
表(2) 評估值 RAE 比較表 ..............................................................................................................39 
表(3) 評估值 MHD 比較表 .............................................................................................................40 
表(4) 平均的評估標準比較表 .........................................................................................................41 
 2
隨著國人防癌意識的提昇，ThinPrep也逐漸受到民眾及醫師的重視。 
ThinPrep是一項專門針對改善抹片採檢品質的一大革新發明，目前FDA已通過ThinPrep
為合格的抹片製作方式，且已廣泛運用於婦產科採檢，其準確度高達93%，亦能解決傳統抹
片「假陰性」問題，大幅提升子宮頸癌的預防效益，改善傳統取樣、塗抹及細胞保存等問題，
致使檢體細胞呈現均勻、較易判讀、減少誤差。由於，刮取的細胞受到完整保存，且透過多
餘的血液及黏液等物質處理過後，再運用微電腦科技提供良好品質的細胞抹片，以大幅提升
抹片的準確性，因此ThinPrep可貴為是細胞影像分析的良好題材如圖(1)所示。 
 
(a) 傳統抹片 (b) Thin Prep 子宮頸抹片 
圖(1)子宮頸抹片的表層細胞(400倍率) 
ThinPrep技術是將子宮頸檢體置於液態懸浮液上來進行保存，其次透過電腦自動化儀器
將細胞檢體均勻處理，然而檢體中的血液、黏液及發炎殘渣等，在製作抹片的過程中會先被
處理掉，然後再藉由特殊淨濾方式有效的將細胞製成薄層細胞抹片。所以，在自動化的製程
中，可避免因傳統抹片檢體不良，以及固定不良引起的遮掩異常細胞所導致不正確判讀[5]。
ThinPrep顯微鏡下，細胞分散於清楚的背景，且外型保持良好，細胞聚集和微生物成分也將
獲得保持[10]。 
ThinPrep是傳統抹片使用五十年以來第一次的增進[11]，這種新式抹片檢查大幅提高了檢
品之準確度，確實達到篩檢的目的。其檢體採樣的方式仍與傳統抹片相同，所以患者在採樣
的過程中不會產生不適感，但由於細胞固定及細胞製方式與傳統做法有相當大的差異，因此
會影響細胞形態的改變；ThinPrep的處理方式可使採樣器上的細胞完全轉移至保存液中，不
會被遺漏，其次再送往自動化儀器中做成新柏氏電腦超薄抹片。然而，執行細胞判讀的醫檢
師及醫師都需要接受再教育課程，在取得該項證照後才能執行這項業務；Thin Prep的發明徹
底改進傳統抹片製作過程中的缺陷，而且根據全球研究報告和臨床試驗結果中指出Thin Prep
確實比傳統抹片更為準確。 
1.2 文獻回顧 
綜合以上所述，ThinPrep子宮頸抹片在臨床診斷分析上，檢體細胞均勻、較易判讀、減
少誤差，比傳統子宮頸抹片更能正確的提供細胞分佈、組織特性及細胞受損程度，相對於醫
師的診斷過程中，易可使患者得到早期發現早期治療之益。由於子宮頸抹片細胞學成像的過
程中，會因病理人員素質良莠不齊及個人主觀意識等因素，造成判讀誤差。因此，如何提升
子宮頸抹片之品質與其正確率，是一個值得研究、探討的方向。 
近年來科技的發達，數位化影像處理及電腦視覺的理論日臻成熟，子宮頸抹片細胞學成
像技術，將期望藉由電腦輔助處理技巧，來取代人工的影像判讀；在偵測子宮頸癌方面的研
 4
(3) 過去的研究多偏重於傳統子宮頸抹片細胞影像之研究，針對 ThinPrep 子宮頸抹片取
樣的細胞影像進行分析的研究者甚少。 
(4) 一般的研究顯少從抹片篩檢的角度來進行分析與研究，例如：抹片篩檢主要是根據細
胞學的原理來進行判讀，細胞之種類可大至區分為表層細胞 superficial cells，中層細
胞 intermediate cells 與深層細胞 deep cells，因此進行研究分析所選用的子宮頸抹片之
細胞影像必須經過嚴密的分類。 
(5) 過去的研究主要是針對某一層細胞中，較大倍率的影像為主，其次再從影像中找出具
有代表性的單獨細胞，進行細胞之偵測與切割，如此僅考慮到小區域的影像處理與偵
測的技巧而已。 
(6) 採用影像分析之電腦理論如 ACM 邊緣輪廓切割、梯度向量流模型、Fuzzy 模糊理論
等，除了偵測與切割過程極為耗時外，其所獲得的切割效果亦非理想且正確率不佳，
以致影響診斷結果。 
(7) 透過子宮頸抹片細胞影像之各種細胞形態切割，其次再分別計算出其所屬之特徵，以
分類、訓練的資料探索方式，進行正異常細胞辨識與診斷方面的研究十分缺乏。 
1.3 研究目的 
細胞(cell)是構成生物的基本單位[47]，也是生物之生命基礎。細胞的種類很多，大小、
形態及功能都不盡相同。但其中仍有部份相同之構造，該部份係以細胞中心為形狀的微小圓
形或橢圓形稱為核(nucleus)，核以外的部份稱為細胞質(cytoplasm)。 
人類所發生的癌症中有85％屬於上皮癌[48]，也就是說上皮細胞(epithelial cells)不正常增
生或失去塑性的調控，造成人類大部分的癌症滋長。子宮頸癌形成的原因現今已知與人類乳
狀突病毒有密切關係，當子宮頸上皮細胞受到感染時，該乳狀突病毒便會提供子宮頸額外的
核酸 (DNA)，子宮頸細胞便容易發生突變而產生癌症[2]。因此，大部分的子宮頸癌是發生在
子宮頸表面扁平上皮與柱狀上皮細胞交界相互移形轉變的地帶[49]，該地帶的上皮基底層細
胞生長型態較為活躍，容易受人類乳狀突病毒的侵犯攻擊，感染高危險型病毒的致病基因成
為病毒感染細胞。所以，採集陰道與陰道部之複層扁平上皮細胞(stratified squamous epithelial 
cells of the vagina and the portio vaginalis)來做ThinPrep子宮頸抹片檢查，對子宮頸癌和子宮頸
癌前病變的診斷有極大的幫助。 
陰道與陰道部之複層扁平上皮細胞(stratified squamous epithelial cells of the vagina and the 
portio vaginalis)之種類大致上可區分為表層細胞(superficial cells)，中層細胞(intermediate cells)
與深層細胞(deep cells)，其中，深層細胞又分為旁基底細胞(parabasal)及基底細胞(basal)如圖
(2)。然而，主要的細胞診斷對象為表層細胞(superficial cells)、中層細胞(intermediate cells)以
及旁基底細胞(parabasal)，由於基底細胞排列在基底膜(basement membrane)上，不易於剝離下
來，當癌細胞真性糜爛，侵犯至基底膜時，此時在陰道塗抺片上即可看出基底細胞，不過當
下的基底細胞其變性很大，故診斷價值不高[47]，因此不列為細胞診斷之對象。 
 6
 
 
 
 
 
 
表 層 細 胞 (superficial 
cells)是三種細胞中最大
的(40-60μ )。 
 
大多染為藍色，比表皮細
胞更透明，細胞大小約
35-45μ 。 
在組織上所佔的量最多
(80-90%)，N/C 也較高，
是三種細胞中最小的
(15-25μ )。 
圖(3) ThinPrep 子宮頸抹片之複層扁平上皮細胞(100 倍率) 
 
 
 
 
 
圖(4) ThinPrep 子宮頸抹片之表層細胞(Superficial cells)分類 
 
 
 
 
 
 
圖(5) ThinPrep 子宮頸抹片之中層細胞(Intermediate cells)分類 
扁平上皮細胞 
(squamous epithelial cells)
表層細胞 
(superficial cells) 
中層細胞 
(intermediate cells)
旁基底細胞 
(parabasal) 
中層細胞 
100 倍率 200 倍率 400 倍率 
表層細胞 
100 倍率 200 倍率 400 倍率 
 8
基層細胞(parabasal cell)，再經由低倍率自動執行判讀，倘若有異常細胞之疑慮，即繼續做高
倍率之詳細判讀。 
2. 相關研究工作(relate works) 
影像切割主要係將影像中不同區域的物件切割出來，而物件切割一般係指找出影像中同
一物件的連續邊緣，然後再確認這個區域是否符合影像的物件意義。在一張影像中，邊緣泛
指各顏色間的邊界，例如：一張二值影像如圖(8a)所示，在黑白兩色系間存在於一個顯而易見
的邊緣，但在自然影像中，由於色彩的差異不大，不容易鑑別出物件間的邊緣如圖(8b)所示。
因此，物件的灰階影像切割將成為我們研究與分析重要的課程。 
 
圖(8) 不同影像的邊緣 
要能精確地從 ThinPrep 子宮頸抹片的影條中分辨出背景、細胞質(cytoplasm)與細胞核
(nucleus)影像區域，有賴於精確的物件輪廓切割(segmentation)技術[13,14,33-46]。大多數物件
輪廓檢測法都會對輪廓邊緣進行加強的動作，以便能精確的區別出背景與物件輪廓。邊緣與
輪廓偵測法常利用濾波器取得灰階影像中高頻的部份，其次將物體邊緣鄰近像元的灰階度加
以放大，以增強物體邊緣輪廓。大部份的技術採微分運算(Derivative Operators)為工具，即對
影像像元灰階度進行一階或二階導數，來增強物體邊緣輪廓，以便能更有效地判斷出邊緣輪
廓所在的位置。所有的邊緣偵測方法都必須先將階梯邊緣模式化，才有辦法以特定的演算法
偵測邊緣線。依照所根據的邊緣線模式(Edge model)加以序論，最常見的邊緣加強法為 Gradient 
filter[34]，Gradient filter 係採一次微分的觀念來進行邊緣加強化。一個影像色階 x 與 y 方向的
梯度大小 ),( yxxΔ 與 ),( yxyΔ ，求得近似解的方式很多，以運算式的方式一般可分為一階導數
運算式與二階導數運算式。目前已有許多物件邊緣加強與輪廓檢測方法被提出，如 Edge 
Linking and Boundary Detection ： Gradient[34] 、 Laplacian 邊 緣 偵 測 (Laplacian edge 
detection)[34]、Sobel邊緣偵測(Sobel edge detection) [34]、Canny邊緣偵測(Canny edge detection) 
[35,36]、Watershed[37,38]；Thresholding：Otsu’s[39]，以及 Region-Bases Segmentation：Active 
Contour Model (ACM)[40-42] 與 LevelSet[43-46]等邊緣與輪廓偵測法。一般物件的 Contour 
segmentation 之處理大致分為：(1) Edge Linking and Boundary Detection (2) Thresholding (3) 
Region-Bases Segmentation。 
因現有細胞抹片製作技術精良不一或症狀不同，所產生出來的影像的品質亦不相同。較
好的細胞抹片影像，含有較少雜訊，且染色較均勻，細胞核也較顯明如圖(9) [50,51]。較差的
細胞抹片影像，含有相當多複雜的資訊，染色雜亂且不均勻如圖(10)；正常的子宮頸細胞如
圖(9)呈現柱狀、細胞核顯明且呈現適當大小、細胞質量多、沒有高核染及分裂等現象，且染
色質呈均勻分佈；不正常細胞如圖(10)則呈現細胞大小與形狀之差異甚大，甚至連肉眼都不
易於辨別。其中，如紅色箭頭所指處：包括核質界線不清、細胞核擴大並具有明顯的濃染情
形及呈現微細或粗大的顆粒、細胞質非常的稀少導致核質比率增大、核分裂及染色質擴大而
呈現不規則形狀以及染色質分佈不均等特徵。因此，該類子宮頸細胞影像在醫學的偵測與判
斷上是致關重要的。為能在不破壞影像資訊的情形下，正確的診斷出疾病，亦須達到精確且
edge 
edge 
(a) 二值影像 (b) 自然影像 
 10
刪除不正確的邊緣點。 
2.2 門檻值(thresholding) 
Otsu’s[39]為著名的門檻值設定方法之一，其方法主要係以分析各群組間差異，以獲取群
組間最大的可能分隔點。其準則主要是在於化大兩群間的差異程度，以達到各群組內的差異
最小化。該方法將依序評估每一可能的門檻值，以群組間的差異程度或以各群組內之同質性
來作為分群門檻的評估標準，並從中選取最適當的值作為分群之門檻值，該設定門檻值的方
法仍為目前最常被引用的方法之一。 
2.3 基於區域切割(region-bases segmentation) 
Active Contour Model (ACM)輪廓檢測法[40-42]常被於醫學影像之物件切割，亦貴為輪廓
不明顯的物件切割利器。最原始的 ACM 又稱為蛇型輪廓模型，該方法主要係藉由輪廓線具
有雲型線(spline)及連續的特性(此特性即為內力)，外加影像力(外力)及外部限制力之交互作
用，經由最小極值求解以得到符合影像特徵之輪廓線。內力的作用在於限制輪廓為連續平滑
的曲線，而外力則是將輪廓線推至具有影像特徵的位置，例如直線、邊緣、或是其他特定特
徵的輪廓。外部的限制力則負責將輪廓限制在區域最小值的範圍內。 
ACM 在進行物件切割時，必須先設定物件的初始輪廓，其次透過輪廓形變不斷的修正，
最後將輪廓線推向實際邊緣處收斂。ACM (active contour model)影像切割技術，雖廣受研究學
者的肯定，但冗長的執行時間，以及須於影像中事先給定物件的初始輪廓，為其重大缺陷。
因此，物件初始輪廓的制訂與否，對於 ACM 能否正確切割出物件與其執行時間的長短皆有
重大之影響。 
幾何式主動輪廓線模型，又名等位函數法( Level Set method )[43-46]，其中 Osher and 
Sethian[42]是用來研究並追蹤物體的幾何變化；Chen and Vese [44]提出了一種叫做『Active 
Contours Without Edges』的方法，利用輪廓曲面定義出一個以能量(Energy)表示的泛函
(Functional)，其次透過此泛函找出能量的最小值，也就是我們所定義的最佳輪廓。能量(Energy)
乃是利用初始的輪廓曲面之影像資訊。 
2.4 SRGFE 演算法(SRGFE algorithm) 
區域成長演算法(Region growing algorithm)是一種能成功應用於數位影像的切割技術
(segmentation technique)。植基於萃取特徵技術的區域成長演算法是目前研究將門檻值技術運
用於其中的進一步應用。其中，特徵萃取演算法稱為區域成長特徵萃取的種子演算法(seeded 
region growing feature extraction algorithm, SRGFEA)[14]。該方法運於萃取子宮頸癌細胞之細
胞核大小、細胞質大小、細胞核灰階值與細胞質灰階值等四個特徵，其實驗所提出之 SRGFEA
的萃取樣本和細胞病理人員以人工方式萃取的樣本進行相關性檢定。於實驗結果得知，
SRGFEA 用於萃取子宮頸癌細胞的重要特徵是合適，且為一種高功能性的影像切割技術。而
該技術將協助細胞病理學家與細胞病理技術在診斷子宮頸癌細胞上，提供精確的細胞核和細
胞質大小與灰階值等特徵。 
2.5 Connected Coherence Tree演算法 
Ding 等[52]相鄰一致性樹演算法(connected coherence tree algorithm, CCTA)為一種無需事
前資訊的影像切割方法。其目的係依方法中的ε -neighbor 相似切割為準則，找出鄰近特性一
致的區域。換言之，該方法可透過空間大小與不同強度大小的調整來改善切割之結果。CCTA
通常能夠達到單一影像中，最常出現的鄰近像元區域集合值之內容(包含複雜背景的影像)。
實際上，每一鄰近相似的像元集合皆對應至一個相似的類別(coherence class, CC)，而每個相
 12
之轉換矩陣表示如下： 
 
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢
⎣
⎡
+
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢
⎣
⎡
×
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢
⎣
⎡
−−
−−=
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢
⎣
⎡
128
128
0
081.0418.05.0
5.0331.0168.0
114.0587.0209.0
B
G
R
C
C
Y
r
b
           (1) 
本文採用Y 做為色彩空間轉換之灰階影像如圖(12)所示。 
 
圖(12)子宮頸細胞灰階影像 
3.2 Haar 離散小波轉換(HDWT) 
離散小波轉換(Discrete Wavelet Transformation, DWT)是一種將空間域(spatial domain)轉
換成頻率域(frequency domain)的影像處理技術。一張影像經過 DWT 後會產生不同的重要性
資料，我們將根據這些資料的重要性級別分別做一處理。 
Haar 離散小波轉換(Haar Discrete Wavelet Transformation, HDWT)係將影像中所有的像元
值(pixels)分別視為各自獨立之數值，其次針對這些獨立的像元值做相加、相減的運算，以求
得影像之頻率(frequency)。當相加後的像元總值愈大時，代表該值愈為重要，且能以肉眼明
顯觀察，因此相加後的運算視為低頻(low frequency)之部份；相減後的值代表著像元間的差
距，且該運算結果會突顯出物體的邊緣輪廓，所以視相減後的運算結果為高頻(high frequency)
的部份。本文以 HDWT 模式將影像分割成四個頻帶，如圖(13)所示。模糊的細胞邊緣在經過
HDWT 轉換後，如圖(14)所示。於圖(14)中可以發現，低頻帶(LL)的細胞影像有利於細胞邊緣
的偵測。 
LL HL 
LH HH 
 
 
圖(13) 一階 HDWT 示意圖 圖(14) HDWT 後之影像 
3.3 平均濾波器(Mean filter) 
 14
及非最大值刪除(non-maximum suppression)與遲滯性門檻(hysteresis thresholding)等步驟。 
 
 
(a) 子宮頸細胞400倍率影像 (b) Canny邊緣偵測 
圖(17) 子宮頸細胞(cervical cell)400倍率邊緣偵測結果 
4.1 Sobel 邊緣偵測(Sobel edge detection) 
Sobel 邊緣偵測[34]係採用 3×3 遮罩如圖(18)，影像內任意像元 ),( yx 的遮罩其所對應的空
間座標位置如圖(18a)，且 x (水平)和 y (垂直)方向在遮罩上的運算子(Sobel operator)分別表示
如圖(18b)與圖(18c)。當我們對遮罩內的元素做摺積時，其所獲得的兩方向之梯度分量分別為
),( yxxΔ 與 ),( yxyΔ ，由兩方向之梯度分量就可以依據(3)和(4)式計算邊緣的梯度大小及方向。 
)1,1( −− yx ),1( yx − )1,1( +− yx
)1,( −yx  ),( yx  )1,( +yx  
)1,1( −+ yx ),1( yx + )1,1( ++ yx
圖(a) 遮罩對應的空間座標位置 
 
-1 0 1
-2 0 2
-1 0 1 
-1 -2 -1
0 0 0
1 2 1 
    圖(b) x 方向的運算子  圖(c) y 方向的運算子 
圖(18) 3×3 遮罩空間座標與運算子 
例如我們欲求得一張影像內像元 ),( yx 座標位置上的梯度大小及方向，則以 ),( yx 為中心
點取得 3×3 遮罩如圖(18a)，由圖(18a)的遮罩與圖(18b)的遮罩做摺積，以獲得 x (或水平方向的
邊緣偵測)方向的梯度 ),( yxxΔ ，其表示式如下： 
[ ]
[ ])1,1()1,(2)1,1(
)1,1()1,(2)1,1(),(
−++−+−−−
++++++−=Δ
yxfyxfyxf
yxfyxfyxfyxx        (3) 
 16
     
圖(a) 梯度比率在 90%以上的梯度          圖(b) 初步的假邊緣處理  
圖(20) 初步的假邊緣處理 
上述所考慮的邊緣輪廓，係當梯度範圍值高於該張影像 90%以上的梯度值時，則將其視
為真邊緣。然而，在這門檻值的過濾層中，亦包含些許的分散雜訊，如圖(20b)紅色框圈處。
因此，本文將藉由分散雜訊的共同特徵，該像元之梯度值與相鄰區域梯度值間的明顯差距，
透過 5×5 的運算遮罩做為過濾雜訊的區域，並添增一判斷依據，列示為假邊緣判斷處理，其
表示式如下： 
   σμσμ +<<− iG  and fi TG ≥           (7) 
其中，μ與σ 分別表示為該遮罩內的像元平均值和標準差，公式如下： 
∑∑
==
−−==
N
i
i
N
i
i GN
G
N 1
2
1
)(
1
1  ,1 μσμ            (8) 
式中 iG 為梯度值，N 為影像像元總數。原梯度影像在經由假邊緣處理後如圖(21a)所示。將圖
(19)之原梯度影像與圖(21a)之假邊緣處理後的結果做差值即為假邊緣部分，如圖(21b)所示。 
   
圖(a) 修正的假邊緣處理              圖(b) 假邊緣部分 
圖(21) 假邊緣處理 
4.3 邊緣加強(edge enhancement) 
子宮頸抹片細胞影像中仍存在於細胞核與細胞質間顏色強度相近之細胞，因該區域之梯
度值極為低小，導致無法明顯地偵測出細胞核與細胞質間的邊緣輪廓。在梯度的計算處理中，
 18
為二值化的處理。 
4.5 遲滯性門檻(hysteresis thresholding) 
遲滯性門檻係指處理二值化時門檻值的設定定義，一般在取門檻值時都是取單一值，然
而 Canny [35,36]則建議在考慮像元邊緣值與鄰近像元間的邊緣值時，使用遲滯性門檻來區分
是否為物件的邊緣值與非邊緣值，並且使用兩個門檻值而非一個。 
遲滯性門檻主要的目標是將不正確的邊緣值刪除，而採用兩個不同的門檻值，一個是高
門檻值(high thresholding)設為 HT ，另一個為低門檻值(low thresholding) LT 。本文將前一節的非
最大值刪除後之梯度影像，利用 Otsu[39]門檻值設定方法，將所取得的門檻值設定為本文之
高門檻值 HT ，並將高門檻值 HT 乘 0.5 作為低門檻值 LT 之標準。 
假設我們考慮像元 ),( yx 位置上的非零像元(邊緣點)，若該像元的梯度值大於 HT ，則將該
像元列為非零像元。倘若該像元的梯度值小於 HT ，則以此像元 ),( yx 為中心選擇一個 3×3 遮
罩，不包括中心的 8 個鄰近像元中，只要有任何一個像元的梯度值大於 LT 者，亦將該像元列
為非零像元，反之，為零像元(非邊緣點)，經由遲滯性門檻之處理後，其所得的結果如圖(25)
所示。 
圖(24) 非最大值刪除後影像 
 
圖(25) 邊緣細線化處理 
5. 細胞核(cell nucleus)邊緣萃取(edge extraction) 
 子宮頸細胞(cervical cell)影像經邊緣偵測後，雖可偵測出大多數的細胞核輪廓，但仍存在
因細胞核染色質分佈不均，與其背景內所產生之細微顆粒等因素，導致細胞核內部出現零碎
之邊緣雜訊，以及因細胞核邊緣受核分裂及染色質擴大呈不規則狀之影響，所產生的邊緣輪
廓斷裂等情形。 
 影像中的細胞核物件係由一群屬性相似且極為群聚的像素值之集合，故其邊緣必為一簡
單封閉曲線。然而，並非所有封閉曲線皆為細胞核邊緣，其中亦存在於一些類似於細胞核輪
廓之雜訊。因此，為能有效的從邊緣線段中萃取出真實的細胞核輪廓，本文將針對上述問題
及細胞核的特性，提出一細胞核邊緣萃取之方法，其步驟包含近似細胞輪廓修補與細線化處
理、分水嶺式(watershed)的區域邊緣萃取及細胞核邊緣萃取。 
5.1 近似細胞輪廓修補和細線化處理 
經二值化處理後，尚有部分輪廓存在於微小的破碎(一個像素之差)線段。因此，我們將
該類型的破碎輪廓定稱為近似輪廓。 
 20
0 0 0  0 0 1 0 1
 1   1 1 0 1 1 0 1 1 0
1 1 1  1 1 0 0 0
1 1 1  1 0 1 0 0
 1   0 1 1 0 1 1 0 1 1
0 0 0  0 0 0 1 1
圖(28) 細線化之邊緣架構 
5.2 分水嶺(watershed)式的區域邊緣萃取 
分水嶺(watershed)式的區域邊緣萃取，係針對每個盆地進行灌水，若該盆地會滲水，則
表示該盆地為非簡單封閉曲線的區域(non-simple close region)。由於子宮頸細胞之細胞核實屬
簡單封閉曲線，因此，我們將邊緣偵測後的細胞輪廓邊緣線，以分水嶺式的影像分割法，決
定出各邊緣線是否為簡單封閉(simple close)的曲線，並將非簡單封閉曲線的邊緣像元修改為非
邊緣像元，其子宮頸細胞初始分割結果如圖(29c)所示。 
分水嶺式的區域邊緣萃取係先將已完成的邊緣輪廓線，以該像元的鄰近像元點，即8個鄰
近點為連結點，建立其邊緣線之編號。其次，標記各邊緣線編號所屬的盆地如圖(29b)所示，
圖中每一盆地就代表一個切割區域，若該區域無法圍成一盆地，亦表示其邊緣線編號並非簡
單封閉曲線。 
 
 
 
 
 
 
圖(29) 分水嶺式的區域邊緣萃取 
5.3 細胞核(cell nucleus)邊緣萃取 
子宮頸細胞影像在經由分水嶺式的區域邊緣萃取後，其所獲得的邊緣輪廓包含細胞質與
細胞核輪廓如圖(30a)所示。由於本節主要的目的是獲取精確的細胞核輪廓，再以此細胞核的
輪廓做為細胞質的初始輪廓，以自適應性門檻值之區域成長法(region growing for adaptive 
threshold)取得細胞質的輪廓，因此此步驟首先將細胞核輪廓的外圍之細胞質輪廓去除。我們
運用各個獨立細胞的輪廓，判斷其內部是否存在於其它的邊緣輪廓，若有則去除該獨立細胞
的外圍輪廓，反之則予以保留，經該方法之處理後如圖(30b)所示。 
   
(a) 二值化邊緣線段 (b) 各盆地區域標記結果 (c) 簡單封閉曲線 
細胞質的輪廓
細胞核的輪廓
 22
上述的導論後，我們將所有輪廓內的平均灰階值由小到大排序，再從次小的平均灰階值小於
最小平均灰階值加上2倍的標準差做為細胞核輪廓判斷之依據，以由小至大依序處理。顯微鏡
400倍下的子宮頸細胞影像，其所進行的濾除非細胞核輪廓處理之方法步驟如下： 
INPUT 1c , 2c ,…, nc ，其中 n為總輪廓數 
OUTPUT L  and Y  
Step 1 計算每一輪廓內的像元平均灰階值μ，並且由小到大排序 nμμμμ <<<< L321  
Step 2 將第1個輪廓內的區域歸類為細胞核區域，並計算其區域內標準差 1σ 作為第2個輪廓
內的區域平均灰階值 2μ 的相似性門檻值 111 2 σμ ×+=Th 。 
Step 3 Set 1=i  
Step 4 if 第 1+i 個輪廓內的區域平均灰階值 ii Th≤+1μ , Then 
Step 5 Set 第 1+i 的輪廓內的區域歸類為細胞核區域 
Step 6 重新計算所有被歸類為細胞核區域之平均灰階值 1+iμ 與標準差 1+iσ 作為第 1+i
個的相似性門檻值 111 2 +++ ×+= iiiTh σμ  
Step 7 Else 將第 1+i 以上的輪廓內的區域歸類為非細胞核區域 do Step 10 
Step 8 set 1+= ii  
Step 9 重複步驟4-9 
Step 10 OUTPUT ( ); 
STOP 
顯微鏡400倍下的子宮頸細胞影像在進行濾除非細胞核輪廓後的結果如圖(32b)所示，於
圖中可明顯看出，本文方法能在去除雜訊邊緣之餘，亦能成功的保留真實的細胞核輪廓。 
  
(a) 顯微鏡下200的子宮頸細胞影像 (b) 顯微鏡下400倍的子宮頸細胞影像 
圖(32) 濾除非細胞核輪廓後之影像 
6. 細胞質(cytoplasm)邊緣萃取(edge extraction) 
細胞質(cytoplasm)的灰階值介於背景與細胞核(cell nucleus)之間，其中較高的灰階值近似
 24
⎩⎨
⎧
−
+≤≤−
                                                    otherwiseseed,non
),(  if        seed, locallocallocallocal σμσμ yxf  
其中 localμ 與 localσ 分別為像元 ),( yx 55× 運算區域內的所有像元之平均灰階值與標準
差，而 ),( yxf 則為像元 ),( yx 上的灰階值。 
Case II  for 細胞核 
if Tyx Δ<Δ ),(  then 
⎩⎨
⎧
−
≤
               otherwiseseed,non
 ),(  if        seed, NTHyxf   
其中 NTH 為細胞核灰階值門檻。 
Case III  for 細胞質 
if Tyx Δ<Δ ),(  then 
⎩⎨
⎧
−
≤
              otherwiseseed,non
 ),(  if        seed, CTHyxf   
其中 CTH 為細胞質灰階值門檻。 
 
 
 
 
 
圖(34) 每一梯度值在總梯度值中所佔的比率 
6.2 自適應性門檻值之區域成長法(region growing for adaptive threshold) 
萃取子宮頸細胞之細胞核與細胞質技術，SRGFEA[14]的確提供了我們一個簡便的方法，
但使用者必須在每一個細胞核上選定一個初始的種子(initial seed)後，再透過嚴選每一細胞核
NTH 與細胞質 CTH 的灰階門檻值(threshold)，以獲得精確的細胞核與細胞質物件。然而，上節
所述的梯度值在總梯度值中所佔的比率 %95=iρ ，亦非一適當之標準。除此之外，SRGFEA
只適用於圖(9)和(10)內的單顆子宮頸細胞影像之細胞核與細胞質的萃取技術，對於圖(32)內的
子宮頸細胞影像之細胞核與細胞質的邊緣萃取，實屬不易。因此，慎選適當的參數與灰階門
檻值，以利於細胞核與細胞質的邊緣萃取，明顯不適於子宮頸細胞影像的細胞核與細胞質之
萃取技術。 
95% 
ρ  
Δ
TΔ
 26
式中 A 表示為細胞核區域， B 、 0
~A 分別表示為以該像元為中心的3×3區域之結構元素
(structuring element)及細胞質初始區域。最後，再透過細胞質初始區域 0
~A 內的平均值
0T
μ 與標
準差
0T
σ 的計算，獲得該細胞質之初始自適應性門檻值 0T ，表示如下： 
00
20 TTT σμ ×+=         (13)  
細胞質的初始種子會隨著下一節所敘述之區域成長原理而變更，當該細胞的初始種子成
長至細胞質的第1個區域 1
~A 時，便可獲得第1個自適應性門檻值 1T 。然而，隨著細胞質初始區
域變動至第 i個區域 iA
~ 時，相對的可獲得到第 i個自適應性門檻值 iT 。 
6.2.3 區域成長法(region growing for adaptive threshold) 
本文應用區域成長法之概念，提出一影像處理之技術。該方法係以細胞核(cell nucleus)
邊界做為區域成長法(Region Growing)之初始種子(initial seed)，並依予對每一種子之鄰近非細
胞核區域內的像元做區域成長之判斷處理，本文定稱為本文自適應性門檻值之區域成長法
(Region Growing for Adaptive Threshold, RGFAT)。該方法必須在符合真實邊緣門檻值 TΔ 及自
適應性門檻值 iT 的條件下，其中 iT 係由細胞質初始區域 0=i 所取得，再經由RGFAT為各種不
同區域的變化下得到 ,...2,1=i 直至區域成長條件終止，以萃取出各細胞之細胞質所屬的區域
範圍。 
在RGFAT演算法中，於第 i個區域 iA
~ 上之像元 ),( yx 的區域成長法下，其是否符合真實邊
緣門檻值 TΔ 及自適應性門檻值 iT 的條件表示式為： 
Case I if Tyx Δ≥Δ ),(  then 
⎩⎨
⎧
−
+≤≤−
                                                    otherwiseseed,non
),(  if        seed, locallocallocallocal σμσμ yxf  
式中 localμ 與 localσ 分別為表示以像元 ),( yx 中心計算 55× 區域內的所有像元之平均灰階
值和標準差，而 ),( yxf 則為像元 ),( yx 上的灰階值。 
Case II if Tyx Δ<Δ ),(  then 
⎩⎨
⎧
−
≤
              otherwiseseed,non
 ),(  if        seed, iTyxf  
子宮頸細胞影像經RGFAT法處理後，該影像內的細胞質區域仍存在於因紋理或雜訊所產
生的細微雜訊。因此，本文將透過影像形態(morphological processing)技術中的閉合(closing)
運算來進行去除雜訊之處理。當結構元素B對細胞質區域 nA
~ 閉合，記為 BAn •~ ，定義為： 
( )ΘBBABA nn ⊕=• ~~ ,                         (14) 
其次，運用邊界抽取(boundary extraction)技術，萃取出細胞質之邊緣。該方法係先由 B 侵蝕，
 28
7. 實驗結果 
為驗證本文方法的準確性與可用性，在實驗的部分我們將分別以三個主要的單元，依予
進行實驗結果之分析與探討。第一單元是以較常見且精確度極高的影像切割方法，在細胞核
與細胞質之不同區域下分別進行實驗結果之比較與分析；第二單元是以人工切割的影像輪廓
為主，分別以細胞核與細胞質影像切割區域，針對第一單元之其他比較方法與本文方法所得
獲的影像切割結果做效能評估；在 ThinPrep 子宮頸抹片細胞影像之細胞核切割中，由於該類
影像在其他方法上皆未獲得較好的解決方案，因此該部份的實驗只針對本文方法做細胞核之
切割，並將該部份方法之敘述與分析結果分列於第三單元中。 
本文將從 ThinPrep 子宮頸抹片細胞影像資料庫中，分別選取表層、中層、旁基底層及異
常的細胞影像等 10 張細胞影像進行實驗。然而，子宮頸細胞影像在顯微鏡下的倍率越低時，
其所獲得的細胞影像之細胞數越多，反之，當顯微鏡下的倍率越高時，影像解析度越低，越
能凸顯出細胞內部的紋理特徵。因此，本文將表層、中層與旁基底層下的細胞，依其顯微鏡
下的倍率之異，細分為 100 倍、200 倍與 400 倍的細胞影像，並在不同層級與不同倍率中，
各取 1 張細胞影像及 400 倍的異常細胞影像分別進行實驗，如圖(36)所示。 
顯微鏡下倍率 100 倍 200 倍 400 倍 
表層細胞 
中層細胞 
旁基底層細胞 
異常細胞 
(顯微鏡下 400 倍) 
 
圖(36) ThinPrep 子宮頸抹片的細胞影像 
7.1 子宮頸細胞切割之比較 
由於本文所取樣的細胞影像中，含有眾多密集的細胞量，倘若我們針對每一細胞，逐一
進行實驗之比較分析，則較無法明確的區分出，各方法間的細胞切割品質之異。然而，針對
 30
 細胞質初始輪廓 細胞核初始輪廓 
顯微鏡下
倍率 100 倍 200 倍 400 倍 100 倍 200 倍 400 倍 
表層細胞 
     
中層細胞 
      
旁基底層
細胞 
      
異常細胞 
(顯微鏡下4
00 倍)   
圖(38) GVF-ACM 的細胞質與細胞核初始廓輪 
GVF-ACM 演算法中，α參數決定內力中輪廓的連續性及平滑性；β參數決定內力中的
曲度影響力，當β越大時其所偵測之輪廓越為平滑；而γ與κ參數則分別表示前一回合的輪
廓權重係數與外力之權重係數，當γ越大時表示新產生的輪廓線受上一回合輪廓的影響越深
，而當κ越大時，表示輪廓線每次修正的幅度越大，意即可獲得較少的修正次數，達到偵測
邊緣之目的。本文於 GVF-ACM 的實驗流程中，分別設定參數α=1、β=2、γ=1、κ=0.5，
經由疊代運算次數 iteration=80 後，其所獲得之細胞質輪廓結果如圖(39)所示。由圖中可明顯
看出，使用者必須給定非常接近於真實輪廓之初始輪廓後，才可獲得較佳的邊緣輪廓線段。
否則，經該演算法之影像處理後，細胞質輪廓容易受到模糊的細胞質邊緣與雜訊等影響，而
產生邊緣扭曲與物件切割錯誤之情形。 
 顯微鏡下 100 倍之表層細胞 
初始輪廓 
  
執行結果 
  
圖(39)  GVF-ACM 的實驗結果 
 CCTA[52]係以區域成長為基礎(region growing based)之研究，透過找尋鄰近區域內的灰階
 32
顯微鏡下
倍率 100 倍 200 倍 400 倍 
表層細胞  
中層細胞  
旁基底層
細胞  
異常細胞 
(顯微鏡下4
00 倍)  
圖(41) SRGFEA 的初始種子點 
Level Set 係由 Li 等人[46]所提出之方法，該方法必須事先給定一初始輪廓，其次經由數
次疊代運算後，以獲得符合該方法條件之邊緣輪廓。子宮頸細胞影像經 Level Set 處理後，該
影像之細胞質輪廓如圖(42)所示。於圖中可明顯看出，由於原影像之細胞質輪廓糢糊且細胞
質與背景對比度甚低，導致細胞影像經 Level Set 處理後，其所獲得之細胞質輪廓無法精確的
表達。然而，隨著疊代次數的增加，邊緣輪廓越往細胞質方向縮近。因此，為從子宮頸細胞
影像中獲得較佳之細胞質輪廓，我們必須以人工代替電腦的方式，持續性的調整、測試疊代
運算次數。倘若我們將經由該方法獲得影像之細胞核輪廓時，仍須從新設定細胞核之初始輪
廓，然後再透過該方法之執行，以獲取細胞核輪廓。綜合上述，Level Set 除了在執行過程中
需耗費大量的執行時間外，初始輪廓的設定及疊代運算的次數都將影響至影像切割之結果，
所以，本文對於下述實驗之比較分析中，將不考慮採用 Level Set。 
執行結果 
  
執行時間(s) 0 47 59.3438 72.6563 87.1252 
疊代運算次數 0 300 400 500 600 
圖(42) Level Set[46]於不同疊代次數下的切割結果 
7.1.2 細胞核輪廓偵測之比較分析 
 細胞核輪廓偵測之實驗，係以圖(37)中 10 張單顆子宮頸細胞影像進行細胞核切割，其細
胞核切割之結果如圖(43)所示。於該實驗之 GVF-ACM 方法中，其參數設定分別為α=1、β
=2、γ=1、κ=0.5。由圖(43)之實驗結果中得知，該方法運用於細胞核輪廓切割時，容易因細
胞核邊緣糢糊及細胞核擴大濃染等情形之影響，導致細胞核外形輪廓扭曲呈不規則狀，如 200
倍的旁基底層影像及異常細胞影像；CCTA 係以像元間的相似性做為主要之判斷處理，透過
將特性一致的像元歸類為同一類別，進而對每一類別之細胞核物件做分割處理，以獲取細胞
 34
 
Original 
image 
Ground 
-truth GVF-ACM
CCT 
algorithm
SRGFE 
algorithm 
Proposed 
result 
100倍 
 
200 
 
表
層 
400 
 
100倍 
 
200 
 
中
層 
400 
 
100倍 
 
200倍 
 
旁
基
底
層 
400倍 
 
異
常
細
胞 
400倍 
 
圖(43) 子宮頸細胞核之切割結果 
7.1.3 細胞質輪廓偵測之比較分析 
 本研究持續以圖(37)中的 10 張單顆子宮頸細胞影像進行細胞質切割之分析，其所獲得的
細胞質影像切割結果如圖(44)所示。於實驗結果中得知，GVF-ACM 在表層、中層與異常的細
 36
 
Original 
image 
Ground 
-truth GVF-ACM
CCT 
algorithm 
SRGFE 
algorithm 
Proposed 
result 
100倍 
 
200 
 
表
層 
400 
 
100倍 
 
200 
 
中
層 
400 
 
100倍 
 
200倍 
 
旁
基
底
層 
400倍 
 
異
常
細
胞 
400倍 
 
圖(44) 子宮頸細胞質之切割結果 
7.2 子宮頸細胞切割之效能評估 
上節所分析的子宮頸細胞影像之細胞核與細胞質輪廓切割實驗，主要係以視覺角度做為
 38
值越小表示參考影像物件輪廓與實驗影像之輪廓越為相似，精確度越高。MHD 方法可表示為： 
)),,(),,(max(),( OTMHDTOMHDTO FFdFFdFFMHD =     (18) 
其中 
.1),( min TO
Ff Ffo
TOMHD ffF
FFd
OO TT
−= ∑
∈ ∈
 
式中 TO ff − 為參考影像與實驗影像物件區域內各像元的空間位置之歐基里德距離， OF 與 TF
分別表示參考影像與實驗影像的物件面積。 
參考影像與各研究方法所獲得的物件之 ME 評估值如表(1)所示，由表中明顯得知，本研
究方法相較於其他方法所獲得之 ME 評估值，無論在細胞核或細胞質物件上，其 ME 評估值
皆低於一定的標準之下。換言之，於表(1)細胞核與細胞質物件切割之 ME 評估值中驗證出，
本研究方法相較於其他研究方法下，確能精確切割出細胞質與細胞核區域。雖然在 100 倍、
200 倍的細胞核旁基底層與 200 倍細胞質表層及 100 倍之細胞質旁基底層中，其所獲得之 ME
評估值較高，但該部份影像之錯誤率與其他方法比較下相距甚小。 
表(1) 評估值 ME 比較表 
 子宮頸細胞核切割方法 子宮頸細胞質切割方法 
Sample images 
GVF 
-ACM 
CCT 
algorithm 
SRGFE 
algorithm
Proposed 
method
GVF 
-ACM 
CCT 
algorithm 
SRGFE 
algorithm
Proposed 
method
100 倍 0.0018 0.0023 0.0029 0.0007 0.0641 0.0311 0.0470 0.0248 
200 倍 0.0015 0.0029 0.0025 0.0008 0.0446 0.0345 0.0477 0.0462 
表
層 
400 倍 0.0014 0.0031 0.0008 0.0004 0.0337 0.5431 0.0526 0.0184 
100 倍 0.0049 0.0091 0.0107 0.0023 0.0311 0.0329 0.1095 0.0243 
200 倍 0.0049 0.0103 0.0116 0.0009 0.0498 0.6800 0.0799 0.0291 
中
層 
400 倍 0.0068 0.0053 0.0141 0.0018 0.0617 0.6328 0.0535 0.0331 
100 倍 0.0071 0.0025 0.0043 0.0056 0.0402 0.0267 0.0422 0.0433 
200 倍 0.0026 0.0014 0.0014 0.0017 0.0245 0.0371 0.0292 0.0169 
旁
基
底
層 400 倍 0.0039 0.0042 0.0016 0.0016 0.0284 0.0474 0.0765 0.0226 
異
常
細
胞 
400 倍 0.0137 0.0148 0.0225 0.0026 0.0374 0.0338 0.0353 0.0231 
RAE 評估結果如表(2)所示，於表中可明顯看出，CCTA 雖然在細胞核部分的旁基底層 200
倍與 400 倍影像中，獲得到較低的 RAE 評估值，但其總體評估值仍介於 0.0239 與 0.9999 之
間。然而，本研究方法所獲得之 RAE 評估值則僅介於 0.0319 與 0.2328 之間。由上述評估範
圍值中驗證出，本研究方法於細胞核之物件切割上，其總體錯誤率比明顯低於各研究方法，
 40
表(3) 評估值 MHD 比較表 
 子宮頸細胞核切割方法 子宮頸細胞質切割方法 
Sample images 
GVF 
-ACM 
CCT 
algorithm 
SRGFE 
algorithm
Proposed 
method
GVF 
-ACM 
CCT 
algorithm 
SRGFE 
algorithm
Proposed 
method
100 0.9448 1.8596 2.7400 0.2470 0.5539 0.1047 0.2005 0.0882 
200 0.8109 2.2303 1.6726 0.3556 0.4438 0.2225 0.4066 0.5189 
表
層 
400 1.1316 5.7933 0.4599 0.1546 0.4721 45.7553 0.8876 0.2370 
100 1.1557 5.1639 10.4096 0.3312 0.2757 0.2266 1.1641 0.1493 
200 1.7778 10.8868 20.9011 0.1156 0.9472 46.4264 1.0562 0.2435 
中
層 
400 4.3615 1.8555 43.7047 0.3830 2.3772 78.6354 0.9755 0.6719 
100 0.9305 0.1458 0.3173 0.6683 0.2297 0.1009 0.2759 0.2225 
200 0.5412 0.1748 0.1869 0.3407 0.2924 0.5267 0.3670 0.1371 
旁
基
底
層 400 0.7251 0.7950 0.0977 0.2358 0.4196 0.9896 2.4367 0.2508 
異
常
細
胞 
400 1.2962 0.8025 2.2054 0.0770 1.0740 0.6858 1.6019 0.5997 
為獲得綜合平均之測量結果，本研究將上述實驗所獲得的三種評估結果分別取其平均，
如(19)式所示，以獲取更精確的影像切割品質評估。該方法主要係將 ME、RAE 及 MHD 評估
值正規化為 0 至 1 之間，並分別表示為 MEN 影像中物件的空間位置、 RAEN 物件面積及 MHDN 物
件輪廓之評估結果。 
( ) 3/MHDRAEME NNNAVE ++=                        (19) 
AVE 效能評估除了可以評估出參考影像與實驗影像之物件在影像中的空間分佈外，亦可
偵測出兩影像間物件面積及物件輪廓的差異度，AVE 綜合評估結果如表(4)所示。表中可明顯
看出，本研究方法所獲得的細胞核與細胞質之 AVE 評估範圍值，分別位於 0.0369~0.1838 與
0.0106~0.0729 間，明顯優於其他方法。雖然僅有少數影像之 AVE 評估值略大於其他方法，但
其評估值間的差異甚小。因此，經由上述評估分析中驗證出，本研究方法的確能精確的從細
胞影像中切割出細胞核與細胞質物件。 
 42
顯微鏡下倍率 100 倍 200 倍 400 倍 
表層細胞 
中層細胞 
旁基底層細胞 
異常細胞 
(顯微鏡下 400 倍) 
 
圖(46)子宮頸細胞之細胞核萃取結果 
8. 結論 
本計畫主要是發展一套偵測(detection)與切割(segmentation)技術，精確地從新柏氏電腦超
薄(ThinPrep)子宮頸抹片不同倍率之上皮細胞(epithelial cells)影像中，切割出細胞質(cytoplasm)
與細胞核(cell nucleus)輪廓。首先，透過色彩空間轉換技術將子宮頸影像轉換成本研究方法的
來源影像－灰階影像。其次，運用邊緣特徵之基礎進行小波轉換、去除雜訊、計算梯度
(gradient)、梯度雜訊去除、加強邊緣、非最大值刪除(non-maximun suppression)、遲滯性門檻
(hysteresis thresholding)、近似細胞核邊緣修補及邊緣萃取等方法，切割出細胞核區域。依序
再以細胞核區域為初始種子點，以配合真實邊緣門檻值與自適應性門檻值的設定，進行區域
成長之影像切割。其中，真實邊緣門檻值係用來區別出影像邊緣之區域，而自適應性門檻則
會隨著每一回合的區域成長而變動。然而，透過門檻值的設定，能有效克服細胞質區域內染
色質分佈不均與拍攝光源所造成的影像漸層等問題，成功的切割出細胞質區域。 
在以區域切割為基礎的物件切割方法之比較分析中驗證出，本研究所提出之方法，仍無
須於大量的人力資源與前處理技術等輔助之下，自動切割出細胞核與細胞質區域。於實驗結
果中明顯得知，本文方法確實能精確、有效的切割出物件輪廓，且足以提供細胞病理人員一
判斷依據。 
 
 44
[19] J. L. Alcazar and M. Jurado, “Trans-vaginal color Doppler for predicting pathological 
response to preoperative chemo-radiation in locally advanced cervical carcinoma: A 
Preliminary study＂, Ultrasound in Medicine and Biology, Vol.25, No.7, pp.1941-1945, 1999. 
[20] H. M. Cole, Human papillomavirus DNA testing in the management of cervical neoplasia, 
JAMA, 1993, pp.2975-2981. 
[21] S. W. K. Chang, K. S. Leung, and W. S. F. Wong, “Expert system for the detection of 
cervical cancer cells using knowledge-based image analysis＂ , Artificial Intelligence in 
Medicine, Vol.8, pp.67-90,1996. 
[22] L. Zhong and K. Najarian, “Automated classification of Pap smear tests using neural 
networks ＂ , IEEE Neural Networks Proceedings International Joint Conference,Vol. 
4,pp.2899 - 2901 . July 2001. 
[23] T. Jiang and F. Yang , “An Evolutionary Tabu Search for Cell Image Segmentation＂, IEEE 
Transaction on systems, Vol. 32, No. 5, October 2002 
[24] H. Refai and L. Li, “Automatic count of hepatocytes in microscopic images＂, IEEE Image 
Processing Proceedings International Conference, Volume 2, pp.1101-1104 ,Sept. 2003. 
[25] E. S. Bak, K. N. and J. P. Brockway, “Efficient Segmentation Framework of cell images in 
noise environments＂  , IEEE Engineering in Medicine and Biology Society, EMBC 
Conference Proceedings. 26th Annual International Conference, Volume 1, pp.1802 -1805, 
2004. 
[26] 黃博琪，“子宮頸細胞自動化電腦輔助影像分析系統之設計研發＂，國立中興大學生物
醫學研究所碩士論文，民國九十一年。 
[27] 劉于綸，“細胞顯微影像分割與運動分析＂，國立央大學機械工程研究所碩士論文，民
國九十三年。 
[28] 賴宣宇，“電腦輔助診斷系統於乳房腫瘤 X 光與超音波影像之整合應用＂，私立中原大
學醫學工程所碩士論文，民國九十四年。 
[29] 黃俊魁，“子宮頸抹片細胞之電腦輔助診斷系統＂，私立中原大學醫學工程所碩士論
文，民國九十五年。 
[30] 陳淑嬌，“梯度向量流主動輪廓模型於子宮頸抹片細胞邊界偵測之應用＂，中興大學電
機工程研究所碩士論文，民國九十二年。 
[31] 馮齡儀，“電腦輔助子宮頸抹片異常細胞辨識之初期研究＂，私立中原大學醫學工程所
碩士論文，民國九十三年。 
[32] 王仁宏，“子宮頸抹片細胞之參數分析＂，私立中原大學醫學工程所碩士論文，民國九
十五年。 
[33] A. Limaye et al., “Comparotive Analysis of Conventional Papanicolaou Tests and a 
Fluid-Based Thin-Layer Method,” Arch Pathol Lab Med, Vol. 127, No. 2, 2003, pp. 200-204. 
[34] R. C. Gonzalez, and R. E. Woods, “Digital Image Processing,” Second Edition, Prentice Hall 
2002. 
[35] J. F. Canny, “A Computational Approach to Edge Detection,” IEEE Transaction on Pattern 
Analysis and Machine Intelligence, Vol. 8, No. 6, 1986, pp. 679–698. 
[36] L. Ding, and A. Goshtasby, “On the Canny Edge Detector,” Pattern Recognition, Vol. 34, 2001, 
pp.721-725. 
[37] D. Wang, “A Multiscale Gradient Algorithm for Image Segmentation Using Watersheds,” 
Pattern Recognition, Vol. 30, Issue: 12, December, 1997, pp. 2043-2052. 
[38] K. Haris, S. N. Efstratiadis, N. Maglaveras, and A. K. Katsaggelos, “Hybrid Image 
Segmentation Using Watersheds and Fast Region Merging,” IEEE Transactions on Image 
Processing, Vol. 7, Issue: 12, December 1998,  pp. 1684-1699. 
[39] N. Otsu, “A threshold selection method from gray-level histograms,” IEEE Transactions of 
Systems, Man, and Cybernetics 9, 62–66. 1979. 
[40] C. A. Davatzikos, and J. L. Prince, “An Active Contour Model for Mapping the Cortex,” IEEE 
