1 
 
1. 計畫回顧 
小(微)衛星進行的任務的能力從早期的軍事用途發展至氣象預測、資源探
勘、通訊及科學實驗等方面。小(微)衛星擁有機械結構簡單、可靠性高、價格低
廉、研究人員與設備精簡等優點。所以設計成本低、製作時間短、及高精度的微
小衛星便成為各大學及小型科技機構主要研究之領域。 
衛星從載具脫離進入任務軌道之前，會有大翻滾帶著高角速度旋轉姿態，或
初始旋轉角速度超出設計容忍值時，姿態控制系統其作用為抑制翻滾和降低角速
度，以利衛星進入任務軌道達成指向定位。若姿態控制系統採用推力器產生推力
以矯正姿態，其優點為不受外在環境限制、易於操作、可配合任何控制方法、修
正時間快速，且指向精度高。衛星內部不確定性為噴嘴配置距離有誤差、推力器
噴嘴傾斜面不精確、氣體燃料使用使質量中心偏移等。衛星外部擾動如高度及位
置對磁力、重力梯度及空氣阻力等環境因素等。噴嘴使用開關閥控制易產生開關
型控制(bang-bang control)，無法如線性開關有高燃料效率，脈寬脈頻調變器可同
時解決推力器上述問題。 
考慮衛星姿態處於系統不確性與外擾並存時最惡劣狀況下(worst case)，採用
強健性控制理論結合脈寬脈頻調變器是小(微)衛星從克服大翻滾、高旋轉角速度
和高精度指向任務姿態控制法則。本計畫將上述問題最佳控制器為求解漢彌頓偏
微分不等式(Hamilton-Jacobi inequality)。當內部參數變化外部擾動時衛星姿態能
滿足任務要求。 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
3 
 
3. 微衛星推力-力矩 
衛星運動座標方向如圖 1 所示，衛星的 4個推力噴嘴置於 x y 平面傾斜
角度，噴嘴方向朝 z 方向，排列成正方形相距離 d。燃料槽於噴嘴 x y 平面 l距
離 z 方向於衛星重心位置，如圖 2 所示。  、 d 和 l 各表示為噴嘴傾斜角
度、噴嘴相對距離和燃料槽重心位置偏移的不確定性，以下列為推力產生力矩 uτ
的推導如下: 
 
 
 
 
 
 
 
 
 
 
x
y
z



      
uτ  r F  u 1 1 2 2 3 3 4 4r F r F r F r F      u        
1 1 1 1 1 1 1 1
2 2 2 2 2 2 2 2
3 3 3 3 3 3 3 3
       
       
       
                                      
u  
   B B u  
其中               
       
1 2 3 4
d d d d d d d d
r d d d d d d d d
l l l l l l l
x
y
zl
                                   
  
       
       
       
sin sin sin sin
sin sin sin sin
cos cos cos
1 2 3 4
cos
x
y
z
F
           
           
       
                                   
  
x 
y
z
圖 1 衛星座標方向 圖 2 衛星噴嘴幾何座標 
x 
y z
d
d
3 4 
2 1 
5 
 
4. 推力器之脈寬調變法則 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
s
thruster
command
M M
T

commandM
,
thrust
o i
er
s
ntM
T 
2sT
2sT
 min ,min on iit t
, , minon i on it t t 
 max ,max on iit t
, ,on i on i biast t t 
2sT
max2bias st T t 
on-modulation off-modulation 
Controller  
thr e
s
ust rM
T
2sT
2sT
thrus
s
terM
T
 
Satellite 
Dynamics 
Thruster 
－ 
＋ 
on-time bias 
PWM 
disturbance
ref
ref
ref



     
 
圖 3 微衛星姿態控制脈寬調變推力器方塊圖 
圖 4 脈寬調變 on/off modulation 控制流程圖 
7 
 
6. MATLAB/Simulink程式模擬響應圖 
微衛星系統參數和初使值 
1 ,  5deg,    0.24 ,  0.25 ,  0.1 ,  0.1 ,  0.1
2
l m d m l l d d                 
   100 36 20 deg,       
 1.2 1.1 23 deg/ sec,           
 1.472 1.452 1.479xx yy zzJ J J Nm     
0 500 1000 1500 2000 2500
-2
-1.5
-1
-0.5
0
0.5
1
1.5
2
Quaternions(PWM)
Time (sec)
 
 
0 500 1000 1500 2000 2500
-200
-100
0
100
200
Spacecraft Attitude
 R
ol
l(d
eg
)
0 500 1000 1500 2000 2500
-100
-50
0
50
100
 P
itc
h(
de
g)
0 500 1000 1500 2000 2500
-200
-100
0
100
200
 Y
aw
 (
de
g)
Time (sec)
 
 
 
 
圖 5 Time Response of Quaternion 
圖 6 Time Response of Spacecraft Attitude 
9 
 
7. 處理器迴路之實現 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
  
 
 
 
 
繼電器
卡 
脈寬調變推
力控制器 
微衛星動態與
運動方程式 
推力器 
×4 
姿態量測 
元件 
類比輸
出卡 
類比輸 
入卡 
微衛星 
角速度 
乙太網路 飛行電腦 主電腦 
推進器開
關命令
  
圖 10 處理器迴路測試架構
(b) 處理器迴路系統測試實體圖 
(a) 處理器迴路系統方塊流程圖 
11 
 
8. 結果與討論 
衛星基本姿感測器包含姿態感測器(Attitude Sensors)與姿態角速
度感測器(Attitude Rate Sensors)兩種。姿態感測器有:太陽感測器(Sun 
Sensor)、地平線感測器(Horizon sensor)、磁場感測器(Magnetometer)、
恆星感測器 (Star Tracker)，但是姿態角速度感測器只有陀螺儀
(Gyro)，傳統上陀螺儀造價非常昂貴，也相對地不可靠(參考點漂移，
是主要的测量誤差源)，相較於姿態感測器容易故障。故隨著衛星技
術普遍化，衛星價格也被要求降低，另外軟體與演算法技術之提升，
使得以姿態資料經軟體處理而獲得姿態變化率資訊也越來越成熟，陀
螺儀當然是工程師第一個想要拿掉的元件，因此無陀螺儀(gyro-less)
的設計近年來研究驅勢。 
研究中使用一種四元數偽量測模式(bogus measurement model)，
提供無陀螺儀衛星姿態確定演算法。該濾波算法不需要對量測方程作
線性化近似，能夠有效提高衛星大姿態角情況下的姿態確定性能。並
通過引入強健追蹤性，使演算法獲得了更高的收斂性。模擬結果顯
示，演算法能夠有效的提高無陀螺儀衛星在初始姿態翻滾、三軸穩定
等狀況下的姿態估計收斂速度，並能夠實現高速旋轉狀況下的姿態跟
蹤。該演算法具有簡明的線性結構，計算負擔符合實時要求，結構簡
單，對硬體配置要求不高。尤其適用於低成本的微(小)衛星。 
對衛星的姿態估計，一般歸結為一個非線性系統的濾波問題。在
非線性濾波方法中，擴展式卡爾曼濾波(Extend Kalman Filter， EKF)
由於方法簡單、容易實現、快速收斂等優點而得到最廣泛的應用。但
是，EKF需要對量測方程進行線性化近似以求取賈可比(Jacobian)矩
陣，容易引入線性化誤差，造成估計精度降低。 
本論文提出了使用四元數的性質，得到線性的偽量測模式，避免了對
量測方程作線性化近似。將此線性偽量測模式與四元數運動學方程相
結合，構成了一種新型四元數卡爾曼濾波器(Quaternion Kalman Filter， 
QKF)。由於系統狀態方程即四元數運動學方程也是線性的，二者結
合構成的濾波器整體上具有線性結構，降低了演算法的複雜性。 
研究方式為通過狀態擴展，將 QKF 進一步拓展到解決無陀螺儀情
況下的姿態確定問題，並通過選用正規的角速度運動模型，保持了濾
波器的線性特色。在此基礎上，本文進一步通過引入強健追蹤處理，
以降低對角速度的估計偏差。在計算量增加不大的情況下，有效提高
了無陀螺儀 QKF 的性能，加速了演算法的初始收斂，並獲得了對快
速姿態運動的跟蹤能力[6]。 
 
 
 
13 
 
10. 與計畫相關之論文發表 
[1] Ho-Nien Shou, Lih-Jen Huoh, Fu-Hwa Liu, and Lih-Feng Lin ,“Analysis and 
Design of Robust Attitude Detumbling Control Using Pulse-Width 
Pulse-Frequency Modulation for Micro-Satellite,” Journal of Air Force Institute 
of Technology, Vol. 10, No. 1, pp. 115-130, 2011. 
[2] Ho-Nien Shou, Yi-Na Liu, Fu-Hwa Liu, and Lih-Feng Lin “Micro-Satellite 
Robust Attitude Fault Tolerant Control,” Journal of Air Force Institute of 
Technology, Vol. 10, No. 1, pp. 103-114, 2011. 
[3] Ho-Nien Shou and Jia-Shing Sheu, “Robust Micro-Satellite Attitude Thruster 
Control: Kalman Filter Approach,”2011 2nd World Congress on Computer 
Science and Information Engineering (CSIE 2011), 2011. 
[4] 壽鶴年，林辰宗，“微衛星姿態翻滾強健控制使用脈寬脈頻調變推力器之分
析與設計＂，2011陸官建國百年暨八十七週年校慶學術研討會論文集，2011。 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
航空技術學院學報  第十卷  第一期（民國一○○年） 
104 
FTC)和主動容錯控制(active FTC)。 
容錯控制可以追溯到提出完整性控制的
新概念為標誌[2] ，關於可穩定的文章是最
早開始專門研究容錯控制的文章[3]，然而直
到 1993 年國際上才出現了容錯控制的文章
[1,4]，目前尚未見到國外有容錯控制的專著
問世。 
動 態 系 統 的 故 障 檢 測 與 診 斷 (Fault 
Detection and Diagnosis, FDD)是容錯控制的
重要支撐技術之一。FDD 技術的發展已大大
超前於容錯控制的發展，其理論與應用成果
也遠遠多於容錯控制方面的成果。目前國際
上每年發表的有關 FDD 方面的論文與報告
在數千篇以上，基於解析備援的故障診斷技
術被公認為起源於 1971[5]，第 一 篇 FDD
方 面 的 綜 述 文 章[6]，國際出版了上第
一本 FDD 方面的學術著作[7]，這方面的重
要綜述文章與著作[8-14]。 
容錯控制發展至今只有 20 年左右的歷
史，因此這是一門新興交叉學科。促使這門
學科迅速發展的一個最重要的動力來源於航
空航天領域。美國空軍從 70 年代起就不斷投
入巨資支持容錯控制的發展，力求開發出具
有高度容錯能力的戰鬥機，甚至在多個翼面
受損時，也能夠保持戰鬥機的生存能力。 
做為一門交叉性學科，容錯控制與強健
控制、故障檢測與診斷、適應性控制、智慧
型控制等有密切的聯繫。現代控制理論、信
號處理、系統識別、最佳化方法、決策論、
統計數學等構成了容錯控制的理論基礎。 
經典容錯控制方法可分 (1)被動容錯控
制和(2)主動容錯控制。被動容錯控制大致可
以分成(i)可穩定性、(ii)完整性和(iii)聯立穩
定三種類型。可穩定性:使用多個補償器進行
可穩定的概念是由 Siljak 最先提出的[3]，可
穩定實際上是關於控制器的容錯問題，針對
單個被控對像當採用兩個補償器時，存在可
穩定解的充要條件是被控對像是強可穩定的
(strongly stabilizable)即此對像可以被穩定的
控制器所穩定[15]。然而，當被控對像不滿
足強可穩定的條件時，補償器就會出現不穩
定的極點，受到過程雜訊的影響，閉迴路系
統就會出現不穩定。前敘方法的另外一個缺
點是，即使穩定性問題是可解的，怎樣設計
這兩個補償器也是一個非常困難的問題。給
出了設計兩個動態補償器的參數化方法，解
決了上述部分問題[16]，以得到可穩定問題
的解。此文還給出了把一個穩定的控制器分
解成兩個並聯的動態補償器，進而實現可穩
定問題的有效方法，其前提仍然是被控對像
必須是強可穩定的。進一步 給出了一個新穎
的可穩定問題的求解方法，即使對不是強穩
定的多變量系統依然有效，其設計考量是採
用多個並列的動態補償器 (可大於兩個 ) 
[17]。與傳統方法不同的是，這裡，每個補
償器需要其它補償器的輸出信號，因此就需
要輔助的感測器來觀測其它致動器的運行狀
況[17]。綜上所述，可穩定問題已基本上趨
於成熟。完整性:完整性問題也稱作完整性控
制(integral control)，它一直是被動容錯控制
中的熱門研究問題。此問題之所以有很高的
應用價值，是因為控制系統中感測器是最容
易發生故障的元件。此問題研究的一般都是
MIMO 線性非時變系統[18-20]。研究了關於
致動器斷路故障的完整性問題，提出了求解
靜態迴授增益陣的一種簡單的偽逆方法
[19]。然而，該方法並不能保證故障狀態下
的閉環系統是穩定的。基於 n 維線性特徵係
數理論及參數空間設計方法，給出了關於致
動器斷路故障的完整性問題的求解方法
[20]。該方法的一個特點是可以在實現完整
性的同時，在致動器的各種故障下，都可以
將系統的閉環極點配置在預定的區域內。因
此，此方法在滿足容錯控制的條件下還可以
兼顧閉環系統的動態特性。該方法的一個缺
陷是，當系統的維數大於 3 時，解析解就不
再存在，只能採用數值解，並可能無解。由
此可見，完整性問題還遠未徹底解決，缺乏
有效地求解容錯控制律的構造性方法。尤其
是對高維多變數系統。聯立可穩定:聯立可穩
定有兩個主要作用，其一，當被控對像發生
故障時，可以使其仍然保持穩定，具有容錯
航空技術學院學報  第十卷  第一期（民國一○○年） 
106 
進一步提高了容錯控制能力，因此，該方法
也可以看成是模型跟隨重組控制與控制律重
構設計的一種有機結合。 
強健容錯控制，不管是主動容錯控制，
還是被動容錯控制，都需要具有關於模型不
確定性與外界擾動的強健性，被動容錯控制
的核心就是強健性，以使閉環系統對各類故
障不敏感，目前主動容錯控制面臨的兩個具
有挑戰性的問題就是[32]：1)基本控制器應具
有強健性，在控制律重構期間使系統保持穩
定；2) 單元應具有強健性，以減少誤報與漏
報，減少故障檢測時間，因此，強健容錯控
制問題近年來受到了高度重視[1,34]，已成為
目前容錯控制領域的熱門研究方向。 
非線性系統的故障診斷與容錯控制，由
前敘的分析可知，被動容錯控制均不採用 
FDD 技術，因此也就不能提供系統的故障訊
號。在發生故障後，與系統正常運行時相比，
被動容錯控制系統的性能(至少是動態性能)
會有所下降，另外，經典的被動容錯控制討
論的對象都是線性系統。為了克服上述缺
陷，將 FDD 技術與被動容錯控制相結合，提
出了一種關於非線性系統感測器故障的集成
故障診斷與容錯控制方法[35,36]，此方法的
優點：1)可處理多種感測器故障，包括斷路、
增益衰減、加性與乘性偏差等，因此克服了
傳統的完整性控制問題只能處理失效故障的
缺陷；2)在發生故障時，閉環系統的性能指
標幾乎不受影響；3)適用於一大類(帶隨機雜
訊的)非線性系統；4)不管對低維還是高維系
統，設計方法都同樣簡單[36]。此外，採用
非線性狀態空間模型，提出了一種關於都市
交通網絡系統的容錯控制方法，在系統發生
某些故障時，可以保持系統的穩定[37]。提
出了一種基於預測控制的致動器容錯控制方
法，並用某一飛機操縱系統的模型進行了仿
真研究[38]。給出了一 種基於自適應神經元
網絡的非線性系統的容錯控制方法，通過採
用一個輔助的回路，來補 償系統中較大的輸
入輸出擾動[39]。 
在容錯控制理論的應用成果上，儘管容
錯控制理論不像 FDD 技術那樣已經在眾多
的領域取得了大量應用成果，但仍然取得了
一些重要的應用成果。容錯控制做為一門新
興的交叉學科，其學科意義就是要盡量保證
動態系統在發生故障時仍然可以穩定運作，
並具有可以接受的性能指標。因此，容錯控
制為提高複雜動態系統的可靠性開闢了一條
新的途徑。由於任何系統都不可避免地會發
生故障，因此，容錯控制也可以看成為是保
證系統安全運行的最後一道防線。除前敘介
紹的強健容錯控制以外，當前容錯控制中的
熱門問題還有以下一些，1)快速 FDI 方法的
研究。故障檢測與分離都需要一定時間，造
成了一定的時延，這段時延越短，對控制律
的重構設計就越有利。這段時延有可能會產
生非常嚴重的穩定性問題，除非原來的基礎
控制器本身就具有很高的完整性和很強的強
健性[4]。2)強健故障檢測與強健控制的集成
設計問題，強健故障檢測的目標是，在一定
的模型不確定性下，檢測出盡可能小的故
障，強健控制的目標是使得控制器對模型不
確定性與微小的故障不敏感。因此，這兩者
存在著矛盾，而它們都是強健容錯控制的基
本問題。所以說，把強健故障檢測與強健控
制進行統一設計，把上面的兩種目標進行折
衷，已成為熱門研究課題。3)控制律的在線
重組與重構方法。做為主動容錯控制的一種
最重要的方法，控制律的在線重組與重構已
成為當前容錯控制領域的熱點研究方向之
一，只有在被控對像發生變動時，實時調整
控制器的結構與參數，才有可能達到最優的
控制效果[29,30]。4)主動容錯控制中的強健
性分析與綜合方法。在主動容錯控制中，需
要同時做到:a)基礎控制器具有強健性，b)故
障檢測與診斷算法具有強健性，c)重組或重
建的控制律具有強健性。這三個方面的相互
作用使得對主動容錯控制的整體強健性分析
變得非常困難[1]。除了上述熱門研究方向以
外，因現有的理論結果還非常有限，容錯控
制領域還有一些 難點問題。 
1)非線性系統的容錯控制。這裡的主要難點
航空技術學院學報  第十卷  第一期（民國一○○年） 
108 
1
0
s s yC C
Cυ
⎡ ⎤⎢ ⎥= Σ Γ⎢ ⎥⎢ ⎥⎣ ⎦
,         
11
0 0 0
0 0
0
s s y
u a a
DD
D D
ξ
υ υξ
⎡ ⎤⎢ ⎥Σ Γ= ⎢ ⎥⎢ ⎥Σ Γ⎣ ⎦
, 
12 0
u a
I
D
Dυ
⎡ ⎤⎢ ⎥= ⎢ ⎥⎢ ⎥Σ⎣ ⎦
 
2 s yC C= Σ , 21 0 s yI DD ξΣ= ⎡ ⎤⎣ ⎦ , 
( )ky k y kk s s
k
u
C x Dz ξξ
υ
⎡ ⎤⎢ ⎥+= Σ Γ⎢ ⎥⎢ ⎥⎣ ⎦
 
( )a ky k y kk s s s
k
u
C x Dw ξξ
ξ
Δ⎡ ⎤⎢ ⎥+= Δ Σ Γ⎢ ⎥⎢ ⎥⎣ ⎦
 
   系統採用強建輸出回授控制器，則強建控
制器表示式如下 
    1ˆ ˆ
ˆ
k c k c k
k c k c k
x A x B y
u C x D y
+ = +⎧⎨ = +⎩
                   
(3) 
其中： ˆˆ nx∈   為是控制器的狀態， cA ， cB ， cC
和 cD 是待確定的控制器的參數矩陣，此時，
由輸出回授控制器(3)和線性不確定系統(2)
所組成的閉迴路系統為 
    1k cl k cl k
k cl k cl k
A B w
z C D w
η η
η
+ = +⎧⎨ = +⎩
                
(4) 
其中：
ˆ
x
x
η ⎡ ⎤= ⎢ ⎥⎣ ⎦
, 2 2 2
2
c c
cl
c c
A B D C B C
A
B C A
+⎡ ⎤= ⎢ ⎥⎣ ⎦
, 
1 2 21
21
c
cl
c
B B D C
B
B D
+⎡ ⎤= ⎢ ⎥⎣ ⎦
, [ ]1 12 2 12cl c cC C D D C D C= + , 
11 12 21cl cD D D D D= +  
當系統致動器機構和感測器發生故障失
效時具有完整性，對不確定性參數具有強健
性而且滿足預先給定的干擾衰減指標約束的
輸出反授控制設計問題即為：對於系統(2)給
定強健干擾衰減指標 γ ，求取輸出回授控制
(3)，使得閉迴路系統(4)對於任意故障均保
持漸近穩定，且從 w 至 z 的轉移函數的 H∞之
范數小於 γ ，即 2
2
z
w
γ≤ 。 
三、強健容錯控制主要結果 
引理 1[5] 0γ > 存在控制器(3)，使得閉迴路
系統(4)從 w 至 z 的轉移函數的 H∞ 之范數小
於 γ ，且閉迴路系統矩陣 clA 是穩定陣的充分
必要條件是存在 T=X X ，滿足線性矩陣不等
式 
0
0
0
cl cl
T
cl
T
cl
A B
C
I D
I
γ
γ
⎡ ⎤⎢ ⎥∗⎢ ⎥ <⎢ ⎥∗ ∗ −⎢ ⎥∗ ∗ ∗ −⎣ ⎦
X X X
X        (5) 
(5)式中 ∗表示矩陣元素斜對稱對應再取
轉置。 
 
定理 1 對於系統(2)，存在一個輸出回授 H∞控
製 器 ， 若 存 在 矩 陣 T n n×= ∈X X   ，
T n n×= ∈Y Y   ， n qL ×∈  ， p nM ×∈  ， p qN ×∈   ，
n nK ×∈  ，使得線性矩陣不等式 
( )
( )
( )
2 2 2 2 12
2 1 21
1 12
1 12 2
11 12 21
0
0
0
0
0
T
T
T
I AY B M A B NC B B ND
K AX LC XB LD
I CY D M
C D NC
I D D ND
I
γ
γ
+ + +⎡ ⎤⎢ ⎥∗ + +⎢ ⎥⎢ ⎥∗ ∗ +⎢ ⎥ <⎢ ⎥∗ ∗ ∗ +⎢ ⎥⎢ ⎥∗ ∗ ∗ ∗ − +⎢ ⎥∗ ∗ ∗ ∗ ∗ −⎣ ⎦
Y
X
Y
X
 (6) 
成立，利用奇異值分解 TUV I= − XY ，則存
在矩陣 
 
 
航空技術學院學報  第十卷  第一期（民國一○○年） 
110 
( )
( )
( )
22 33
0 0 11 33
22 11
4
3
J J
A J J
J J
ω
−⎡ ⎤⎢ ⎥= −⎢ ⎥⎢ ⎥−⎣ ⎦
, 
( )1 0 11 22 33
0 0 1
0 0 0
1 0 0
A J J Jω
−⎡ ⎤⎢ ⎥= − + ⎢ ⎥⎢ ⎥⎣ ⎦
, 
11
2 22
33
0
J
A J
J
⎡ ⎤⎢ ⎥= ⎢ ⎥⎢ ⎥⎣ ⎦
, d uF F I= =  
在系統狀態空間表示式(2)中，選取狀態
變量和系統受控輸出向量分別為 
TT Tx q q= ⎡ ⎤⎣ ⎦& , TT T Tq q qη = ⎡ ⎤⎣ ⎦&& &  
系統測量輸出向量 y 為陀螺測量輸出角
速度和星光感測器輸出測量角度，相對應系
統矩陣如下 
1 1
2 0 2 1
0 I
A
A A A A− −
⎡ ⎤= ⎢ ⎥− −⎣ ⎦
，
1
2
0
d
B
A Fξ −
⎡ ⎤= ⎢ ⎥−⎣ ⎦
，
1
2
0
u
u
B
A F−
⎡ ⎤= ⎢ ⎥−⎣ ⎦
，  
1 1
2 0 2 1
0
0
z
A A A A
C I
I
− −⎡ ⎤− −⎢ ⎥= ⎢ ⎥⎢ ⎥⎣ ⎦
，
1
2
0
0
d
z
A F
D ξ
−⎡ ⎤⎢ ⎥= ⎢ ⎥⎢ ⎥⎣ ⎦
，
1
2
0
0
u
zu
A F
D
−⎡ ⎤⎢ ⎥= ⎢ ⎥⎢ ⎥⎣ ⎦
， y yC D Iξ= =  
五、衛星強健容錯控制姿態模擬 
衛星運動座標方向如圖 1(a)所示，衛星
的 4 個推力噴嘴置於 x y− 平面傾斜 λ角度，
噴嘴方向朝 z− 方向，排列成正方形相距離
d。燃料槽於噴嘴 x y− 平面 l距離 z+ 方向於
衛星重心位置，如圖 1(b)， (c)所示。使用
Matlab/Simulink@模擬中使用 FDD 結果得到
aΣ , sΣ 選取 3 3a I ×Γ = ， 6 6s I ×Γ = ，致動器機構
故障發生時刻為 50sec.t = ，感測器故障發生
的時刻為 300sec.t = ，圖 2 所示為微衛星姿態
變化率響應，圖 3 所示為微衛星姿態角響
應 ， 任 務 中 微 衛 星 目 標 穩 定 精 度 為
0.3 sec.rad ，目標指向精度為 0.1deg .。 
 
圖 1 (a)衛星運動座標方向 
 
圖 1 (b)衛星衛星的 4 個推力噴嘴置於 x y−  
平面噴嘴方向朝 z− 方向，排列成正方
形相距離 d  
 
圖 1 (c)衛星衛星的 4 個推力噴嘴置於 x y−
平面傾斜 λ角度 
 
表 1 衛星三個慣性主軸轉動慣量與噴
嘴幾何參數 
 
 
 
 
 
 
 
2
11
2
22
2
33
=5.5384 kg-m , 
=5.6001 kg-m , 
=4.2382 kg-m ,
J
J
J
5deg
0.5 m 
0.1 m
l
d
λ =
=
=
 
航空技術學院學報  第十卷  第一期（民國一○○年） 
112 
29, No. 4, pp. 815-835, 1993. 
12. Basseville M., “Detection of Abrupt 
Changes in Signals and Dynamical 
Systems,” Springer, Berlin, 1986. 
13. Ron Patton, Paul M. Frank, “Fault 
Diagnosis for Dynamic Systems,” 
Springer,  London Berlin, 2000. 
14. Xue Jun Zhang,  “Auxiliary signal design 
in fault detection and diagnosis,” 
Springer,1989.  
15. Vidyasagar M, and N Viswanadham, 
“Reliable Stabilization Using a 
Multi-controller Configuration,” 
Automatica, vol.21, pp. 599–602, 1985. 
16. Gundes A N., “Controller design for 
reliable stabilization,” Processing  of 
12th IFAC World Congress, vol.4, pp.1-4, 
1993. 
17. N. Sebe and T. Kitamori, “Reliable 
stabilization based on a 
multi-compensator configuration,” 
Processing 12th IFAC World Congr., vol. 
4, Sydney, Australia, 1993, pp.5–8. 
18. Morari, M., "Robust Stability of Systems 
with Integral Control," IEEE Transactions 
on Automatic Control, vol. AC-30. No. 6, 
pp.574-588, 1985. 
19. Nwokah 0 D I, Yau C H, and  Perez R A., 
“Robust integral stabilization and 
regulation of uncertain multivariable 
systems,” Processing  of 12th IFAC 
World Congress, vol.4 , pp.13-17, 1993. 
20. Ye Y. Z.,  “Fault-Tolerant Pole 
Assignment for Multivariable System 
Using a Fixed State Feedback,” Control 
Theory and Applications, vol.10, no. 2, 
pp.212-218,  1993. 
21. A.W. Olbrot, “Robust stabilization of 
uncertain system by periodic feedback,” 
International  Journal  of  Control, 
vol.45, pp.747-758, 1987. 
22. Saeks, R. and Murray, J., “Fractional 
representation, algebraic geometry, and 
the simultaneous stabilization problem,” 
IEEE Transactions on Automatic Control,  
vol.27, no. 4, pp. 895- 903, 1982. 
23. Khargonekar, P.P.,  Pascoal, A.M. 
and   Ravi, R., “Strong, simultaneous, 
and reliable stabilization of 
finite-dimensional linear time-varying 
plants,” IEEE Transactions on Automatic 
Control,  vol.33, no. 12, pp. 1158-1161, 
1988. 
24. Kabamba, P.T. and   Yang, C., 
“Simultaneous controller design for linear 
time-invariant systems,” IEEE 
Transactions on Automatic Control,  
vol.36, no. 1, pp. 106-111, 1991. 
25. McLean D., “Application of Precomputed 
Control laws in. Reconfigurable Aircraft 
Plight Control Systems,” AlAA Journal of 
Guidance, Navigation  and  Control, 
vol.12, pp. 325-333, 1989. 
26. Rugh, W.J., “Analytical framework for 
gain scheduling,” IEEE  Control System,  
vol.11, no. 1, pp. 79-84, 1991. 
27. Huber, R. R. and McCulloch, B., 
“Self-Repairing Flight Control System,” 
SAE Technical Paper Series, 841552, 
Processing of Aerospace Congress 
Exposition. 
28. R. Srichander and B. K. Walker, 
"Stochastic Stability Analysis for 
Continuous-Time Fault Tolerant Control 
Systems," International Journal of Control, 
vol.57, no. 3, pp.433-452, 1993. 
29. Ramamurthi, K . and A.M. Agogino, 
“Real-Time Expert Systems for Fault 
Tolerant Supervisory Control,” Journal of 
dynamic systems, measurement, and 
control, vol. 115, no,2, pp. 219-227 ,1993. 
30. Napolitano, Marcello R and Swaim, Robert 
航空技術學院學報  第十卷  第一期（民國一○○年） 
114 
Attitude Determination: Using Kalman 
Filtering of Magnetometer Data 
Approach,” IEEE Processing of 
International Symposium on Computer, 
Communication, Control and Automation, 
pp.169-171, 2010. 
46. Zames G., “Feedback and Optimal 
Sensitivity Model Reference 
Transfomation Multiplicative Seminoms 
and Approximate Inverses,” IEEE 
Transactions on Automatic Control,  
vol.26, no.2, pp.301-320, 1981. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
航空技術學院學報  第十卷  第一期（民國一○○年） 
116 
一、前言 
衛星從載具脫離進入任務軌道之前，會有
大翻滾帶著高角速度旋轉姿態，或初始旋轉
角速度超出設計容忍值時，姿態控制系統其
作用為抑制翻滾和降低角速度，以利衛星進
入任務軌道達成指向定位。若姿態控制系統
採用推力器產生推力以矯正姿態，其優點為
不受外在環境限制、易於操作、可配合任何
控制方法、修正時間快速，且指向精度高。
衛星內部不確定性為噴嘴配置距離有誤差、
推力器噴嘴傾斜面不精確、氣體燃料使用使
質量中心偏移等。衛星外部擾動如高度及位
置對重力梯度、空氣阻力及磁力等環境因素
等。噴嘴使用開關閥控制易產生開關型控制
(bang-bang control)，無法如線性開關有高燃
料效率，脈寬脈頻調變器可同時解決推力器
上述問題。 
考慮衛星姿態處於系統不確性與外擾並
存時最惡劣狀況下(worst case)，採用強健性
控制理論結合脈寬脈頻調變器是小(微)衛星
從克服大翻滾、高旋轉角速度和高精度指向
任務姿態控制法則。本文將上述問題最佳控
制 器 為 求 解 漢 彌 頓 偏 微 分 不 等 式
(Hamilton-Jacobi inequality)。當內部參數變
化外部擾動時衛星姿態能滿足任務要求。 
本文之目的為衛星入軌精度與姿態控制
理論分析與設計，奠定有關微衛星之研究基
礎，欲更精進發展出微衛星更小具地球觀測
功能之微微級衛星姿態控制態技術，並進一
步製作出衛星工程實體與飛行體。此一研究
之目標為： 
1.有效落實微型衛星設計於學術單位，
並進而推廣，擴大參與面。 
2.實際地延伸我國的微型衛星基礎之研
究，增進地球觀測之功能。 
3.強化學校對微型衛星次系統之分析、
設計與整合測試的能力。 
4.整合國內產官學界技術，開發微型衛
星之相關元件。 
衛星姿態或軌道控制時常併入數種不
同致動器(actuator)交互使用，包括改變衛星
慣性矩裝置和推力器(thruster)，改變衛星慣
性矩裝置如動量輪(moment wheels) 、制動輪
(reaction wheels) 、 制 力 矩 陀 螺 群 (control 
moment gyros)所能提供力矩為0.02-1牛頓．
米，推力器提供力矩範圍為0.01-30牛頓．米
之間 [1]。衛星從載具脫離進入任務軌道之
前，初始會有大翻滾帶著高角速度旋轉姿
態，若採用改變慣性矩裝置將無法抑制翻滾
和降低角速度[2]。推力器系統產生推力以矯
正姿態的誤差，其優點為不受外在環境限
制、易於操作、可配合任何控制方法、修正
時間快速，且指向精度高，最高可達0.001°
的指向精度，缺點為有限度使用，若能提高
使用效率將可延長使用時間[3]。 
本文內容著重於(1)推力器位置配置設
計，(2)以衛星姿態角速度、四元素作狀態回
授作為推力器命令，(3)考慮當推力器位置距
離有誤差、推力器噴嘴傾斜面不精確、氣體
燃料使用使質量中心偏移為衛星內部不確定
性，(4)外部擾動如衛星高度及位置對磁力、
重力梯度及空氣阻力等環境因素等，(5)推力
器使用脈寬脈頻調變器能將開關型控制轉化
為相應的精確線性控制開關，(6)將上述問題
系統地闡述以漢彌頓偏微分不等式[4][5]，求
解出此漢彌頓偏微分不等式即為減少外擾與
抑制系統參數不確性衛星姿態控制器。強健
控制理論在能量消耗限制不同情况下可實現
快速、節能的控制過程。 
本文內容結構如下：第二節問題闡述，
第三節衛星推力的產生-力矩推導，第四節為
推力器之脈寬調變法則，第五節為卡爾曼濾
波器介紹與不同的演算的方法第六節為軟體
迴路 (Software-in-the-Loop, SIL)與處理器迴
路(Processor-in-the-Loop, PIL)之實現，最後
一節為未來展望、實現與結論。 
二、問題闡述 
考慮衛星姿態運動方程式： 
 
 
航空技術學院學報  第十卷  第一期（民國一○○年） 
118 
x
y
z
τ
τ
τ
⎡ ⎤⎢ ⎥= ⎢ ⎥⎢ ⎥⎣ ⎦
uτ  
( )r F= × urr  
1 1 2 2 3 3 4 4r F r F r F r F⎡ ⎤= × × × ×⎣ ⎦ u
r r r rr r r r  
1 1 1 1
2 2 2 2
3 3 3 3
β β β β
β β β β
β β β β
⎛ − −⎡ ⎤⎜ ⎢ ⎥= − −⎜ ⎢ ⎥⎜ ⎢ ⎥− −⎣ ⎦⎝  
1 1 1 1
2 2 2 2
3 3 3 3
β β β β
β β β β
β β β β
−Δ Δ Δ −Δ ⎞⎡ ⎤ ⎟⎢ ⎥+ −Δ −Δ Δ Δ ⎟⎢ ⎥ ⎟⎢ ⎥−Δ Δ −Δ Δ⎣ ⎦ ⎠
u  
( )= +ΔB B u  
其中 
 
1
2
α = , 1 d lβ αλ= + , 
2 d lβ αλ= − , 3 dλβ α= , 
( ) ( )1 d d d l l lβ λ λ α λ λ λΔ = Δ − Δ +Δ + Δ + Δ +Δ Δ , 
( ) ( )2 d d d l l lβ λ λ α λ λ λΔ = Δ − Δ +Δ − Δ + Δ +Δ Δ ,
和 
( )3 1 d d d dβ λ λαΔ = Δ + Δ + Δ Δ  
 
   推力轉換力矩矩陣 B有下列特性： 
   (1) ( ) { }min ,rank m n+ Δ =B B  
   (2) ( )( )+ Δ + Δ TB B B B
 
    
( )
( )
( )
1 1
2 2
3 3
4 0 0
0 4 0
0 0 4
β β
β β
β β
+ Δ⎡ ⎤⎢ ⎥= + Δ⎢ ⎥⎢ ⎥+ Δ⎣ ⎦
 
四、推力器之脈寬調變法則: 
依推力控制器與PWM工作週期可分為 
off-modulation 與  on-modulation 兩種工作
模式，如圖4 PWM法則方塊圖所示。由圖4 得
知在 off-modulation 工作模式中，在整個工
作 週 期 內 至 少 有 一 個 推 力 器 工 作 ； 在 
on-modulation 工作模式中，整個工作週期內
工作至少有一個推力器不工作，在本文中是
採用on-modulation工作模式。 
 
圖 3 微衛星姿態控制脈寬調變推力器方塊
圖 
 
 
圖 4 脈寬調變 on/off modulation 控制流程
圖 
航空技術學院學報  第十卷  第一期（民國一○○年） 
120 
4 3 2
3 4 1
2 1 4
1 2 3
q q q
q q q
q q q
q q q
−⎡ ⎤⎢ ⎥−⎢ ⎥Λ = ⎢ ⎥−⎢ ⎥− − −⎣ ⎦
 
5.1 擴展式卡爾曼濾波器 
   設非線性系統狀態模型及量測動態模型
表示為[2][3][4] 
( )1k k kx f x w+ = +                  (6a) 
( )k k kz h x v= +                   (6b) 
其中 
kx 為在k時刻之系統狀態向量 
( )f   為非線性系統模型 
kw 為在k時刻之系統動態雜訊 
   kz 為在k時刻之量測動態向量 
( )h   為非線性系統量測模型 
kv 為在k時刻之量測動態雜訊 
若是雜訊 w 及 v 之機率分佈為隨機任意
的，則（6）式為一般的離散非線性系統模型。
但這類系統對於最佳估測求解是非常不方便
的，因此為了使估測問題得到可行之解答，
必須對雜訊的統計特性給予符合實際而又方
便計算之假設，於一般工程問題中，對 w及 v
設為為彼此互不相關且均值為零的高斯白雜
訊。 
其系統誤差之協方差矩陣（Covariance 
Matrix） jQ 如下：  
{ }   ,0    ,jTi j Q i jE w w i j=⎧= ⎨ ≠⎩                (7) 
與 觀 測 誤 差 之 協 方 差 矩 陣 （ Covariance 
Matrix） jR 如下：  
{ }   ,0    ,jTi j R i jE v v i j=⎧= ⎨ ≠⎩               （8） 
在此， w與 v是相互獨立不相關的 
{ } 0,    ,Ti jE w v i j= ∀                 （9） 
假設在 kt 時刻之前，狀態程序有一事先（a 
priori）估測值 ˆkx−，其中“^”表示在時刻 kt 之
估測值，而“-”表示為未更新之狀態。則定義
估測誤差為： 
ˆk k ke x x
− −= −                       (10) 
及相關誤差之協方差矩陣為：  
{ }Tk k kP E e e− − −= −   
   ( )( ){ }ˆ ˆ Tk k k kE x x x x− −= − −         (11) 
假設（6）式為一般非線性系統，當及之雜訊
恆為零時，系統模型（6）式的解則稱為非線
性方程之解析解，又稱為“預測參考狀態”或
是“預測參考軌跡”，記為 
( )1ˆ ˆk kx f x−+ =                      (12a) 
( )ˆˆk kz h x− −=                     (12b) 
一般把非線性系統（6）式的數值解稱之為“真
實狀態”或是“真實軌跡”。則非線性系統之真
實運動狀態與預測參考運動狀態之誤差為 
1ˆk k kx x x
−
+Δ = −                    (13a) 
   1ˆk k kz z z
−
+Δ = −                    (13b) 
如果這些誤差夠小則可以將（6）式用泰勒級
數展開，並取第一階項 
( ) ( )1 ˆ
ˆ
k k
k k
k
k k k kx x
k x x
f x
x f x x w
x+ = =
∂= + ⋅Δ +∂   (14a) 
( ) ( )ˆ
ˆ
k k
k k
k
k k k kx x
k x x
h x
z h x x v
x− −= =
∂= + ⋅Δ +∂   
(14b) 
其中將（12）式帶入（14）式，得 
( )
1 1
ˆ
ˆ
k k
k
k k k k
k x x
f x
x x x w
x
−
+ +
=
∂= + ⋅Δ +∂
     
(15a) 
( )
ˆ
ˆ
k k
k
k k k k
k x x
h x
z z x v
x −
−
=
∂= + ⋅Δ +∂       (15b) 
或 
( )
1 1
ˆ
ˆ
k k
k
k k k k
k x x
f x
x x x w
x
−
+ +
=
∂− = ⋅Δ +∂   
( )
ˆ
ˆ
k k
k
k k k k
k x x
h x
z z x v
x −
−
=
∂− = ⋅Δ +∂   
可得非線性系統的線性誤差方程   
1k k k kx x w+Δ = Φ ⋅Δ +              (16a) 
k k k kz H x vΔ = ⋅Δ +              (16b) 
航空技術學院學報  第十卷  第一期（民國一○○年） 
122 
( )1 M BJ ×− ⎛ ⎞∂⎜ ⎟= ⎜ ⎟∂⎝ ⎠q  
 
0
0
0
yy zz xx zz
z y
xx xx
zz xx zz xx
z x
yy yy
xx yy xx yy
y x
zz zz
J J J J
J J
J J J J
J J
J J J J
J J
ω ω
ω ω
ω ω
⎡ ⎤− −⎢ ⎥⎢ ⎥⎢ ⎥− −∂ ⎢ ⎥=∂ ⎢ ⎥⎢ ⎥− −⎢ ⎥⎢ ⎥⎣ ⎦
&ω
ω
 
輸出量測: 
T
m s gH H H H⎡ ⎤= ⎣ ⎦  
其中 
磁力計量測輸出 
ˆ ˆ T
m
b bH
⎡ ⎤∂ ∂= ⎢ ⎥∂ ∂⎣ ⎦q ω
 
3 3
ˆ 0
Tbody
ECI
ECI
i
A b
q ×
⎡ ⎤∂= ⎢ ⎥∂⎣ ⎦
 
 
太陽感測器量測輸出 
ˆ ˆ
T
s
s sH ⎡ ⎤∂ ∂= ⎢ ⎥∂ ∂⎣ ⎦q ω
 
3 3ˆ 0
Tbody
ECI
ECI
i
A s
q ×
⎡ ⎤∂= ⎢ ⎥∂⎣ ⎦
 
 
陀螺儀量測輸出 
ˆ ˆ T
gH
⎡ ⎤∂ ∂= ⎢ ⎥∂ ∂⎣ ⎦q
ω ω
ω  
[ ]3 4 3 30 TI× ×=  
5.4 樣點式卡爾曼濾波器 
樣點式濾波演算法的基本思想與擴展式
濾波相同都是採取卡爾曼濾波器的遞推公
式，通過系統狀態均値與誤差協方差的遞推
及觀測量的訊息來進行更新，也由於是採取
卡爾曼濾波器之架構，所以樣點式濾波器也
稱為樣點式卡爾曼濾波器。 
樣點式卡爾曼濾波器與擴展式卡爾曼濾
波器不同的地方就在於樣點式不採取線性化
的方法，而是經由非線性轉換來處理狀態均
值與誤差協方差的遞推與更新，非線性轉換
是一種計算隨機變量的非線性變換統計特性
的方法，主要思想是藉由一組經由確定性採
樣方法所得到的樣本點，簡稱為標準點，透
過這些標準點與系統裡非線性模型進行非線
性轉換，這種思維就是“非線性估計算法應更
接近系統的非線性本質”，而且不必求取系統
方程式與量測方程式的賈可比矩陣，實現速
度也就更快了。 
   樣點式變換是一種經由確定性採樣的方
法得到了一組標準點，而透過這些標準點與
系統裡的非線性狀態方程和量測方程之間的
轉換過程，經過加權處理後便可求得比擴展
式採取線性化方法更加準確的系統估計值。 
根據上敘理論用下式子選取標準點: 
0 ˆkxχ −=  
( )( )ˆ   1,2, ,Ti k k
i
x n P i nχ λ−= + + = L     (19) 
( )( )ˆ   1,2, ,Ti n k k
i
x n P i nχ λ−+ = − + = L  
計算權重值: 
     ( )miW n
ε
ε= +  
( )20 0 1 21c mW W ε ε= + − +          (20) 
( )
1
2
m c
i iW W n ε= = +  
其中 ( )21 n nλ ε γ= + − ，n 為向量維數， 1ε 通常
設ㄧ小的正數 ( )4 1. .,10 1e g ε− ≤ ≤ ，它決定標準
點環繞於 x 的範圍， γ 為一比例因子通常默
設為 0，當處於高斯分佈下時取 2 為最佳，
( )( )k
i
n Pε+ 表示取矩陣方根的第 i 列。 
航空技術學院學報  第十卷  第一期（民國一○○年） 
124 
0 1 2 3 4
T
x y zq q q qχ ω ω ω⎡ ⎤= ⎣ ⎦  
1 2 3 4
T
i x y zq q q qχ ω ω ω⎡ ⎤= ⎣ ⎦  
( )( )7    1, 2, ,7x
i
P iε+ + = L
 
1 2 3 4
T
i x y zq q q qχ ω ω ω⎡ ⎤= ⎣ ⎦  
( )( )7    8,9, ,14x
i
P iε− + = L  
 
狀態誤差轉移矩陣: 
1
1
2k k k
t+
⎛ ⎞= Ω Δ +⎜ ⎟⎝ ⎠q q q  
( )11k k k k kJ M b J tω ω ω ω− × ×+ = − Δ +  
 
磁力計座標轉換矩陣: 
( ) ( )
( ) ( )
( ) ( )
2 2 2 2
1 2 3 4 1 2 3 4 1 3 2 4
2 2 2 2
1 2 3 4 1 2 3 4 1 4 2 3
2 2 2 2
1 3 2 4 2 3 1 4 1 2 3 4
2 2
ˆ 2 2
2 2
k
q q q q q q q q q q q q
b q q q q q q q q q q q q
q q q q q q q q q q q q
⎡ ⎤− − + + −⎢ ⎥= − − + − + +⎢ ⎥⎢ ⎥+ − − − + +⎣ ⎦
 
,ECI kb×  
太陽感測器座標轉換矩陣: 
( ) ( )
( ) ( )
( ) ( )
2 2 2 2
1 2 3 4 1 2 3 4 1 3 2 4
2 2 2 2
1 2 3 4 1 2 3 4 1 4 2 3
2 2 2 2
1 3 2 4 2 3 1 4 1 2 3 4
2 2
ˆ 2 2
2 2
k
q q q q q q q q q q q q
s q q q q q q q q q q q q
q q q q q q q q q q q q
⎡ ⎤− − + + −⎢ ⎥= − − + − + +⎢ ⎥⎢ ⎥+ − − − + +⎣ ⎦
   
,ECI ks×  
六、軟體迴路
(SOFTWARE-IN-THE-LOOP, SIL)
與處理器迴路
(PROCESSOR-IN-THE-LOOP, PIL)
之實現 
在計畫中微衛星姿態控制系統的期中完
成軟體迴路測試驗證，在此驗證架構下，感
測器與致動器的電氣介面皆使用數學函式達
成。此驗證方式，可以驗證姿態控制系統軟
體之功能與性能，但是當實際任務飛行階段
時，因為感測器與致動器及其電氣介面都在
閉迴路內，故實際且完整之控制系統並未經
嚴謹之驗證[5]。 
航太工程實驗發展衛星計畫之前常需先
行完成姿態控制系統之發展、設計及驗證工
作。期末完成以微衛星為對象，建立之控制
器迴路系統。此系統(電腦)用以實現衛星姿
態模擬測試器姿態模擬測試器，內部之中執
行微衛星動態與運動方程式、環境模擬(環境
干擾力矩、10階地球磁場)和姿態量測元件數
學模型，另一個系統包含一個用以取代衛星
姿態控制器的即時軟硬體系統 (real time 
controller NI cRIO-9014) 和姿態控制元件數
學模型(on modulator PWM、Thruster)，如圖
10所示。 
6.1 軟體迴路 
微衛星姿態控制器之設計分兩個階段驗
證。第一階段是不加入感測元件與致動元件
電氣介面之軟體迴路 (Software-in-the-Loop)
驗證，目的是先期驗證脈寬調變推力控制器
在即時(real time)環境下之性能表現，其架構
如圖 10 所示。主電腦(Host computer)中建構
了微衛星動態與運動方程式、環境模擬(環境
干擾力矩、10 階地球磁場)和姿態量測元件
數學模型，運算週期為 0.25 秒；而脈寬調變
推力控制器則建構於具即使計算功能之飛行
電腦中，運算週期為 2 秒。主電腦端透過乙
太網路 (Ethernet)將微衛星之三軸角速度訊
號傳輸至飛行電腦端之脈寬調變推力控制器
上，控制器經計算後會決定出二組(四根)推
力器之開啟時間，並將推力器開啟時所造成
之力矩再經由乙太網路回傳至主電腦端之微
衛星動態與運動方程式中，完成一閉迴路之
架構。軟體迴路驗證脈寬調變推力器於微衛
星姿態在三軸起始翻滾角速度分別為 [200, 
-200, 300]度 /秒下之強健控制測試結果如圖
11-13 所示。 
 
 
 
 
 
航空技術學院學報  第十卷  第一期（民國一○○年） 
126 
 
(a)Thruster 1 
 
(b)Thruster 2 
 
(c)Thruster 3 
 
(d)Thruster 4 
圖13 噴嘴時間響應 
 
6.2 處理器迴路 
由於軟體迴路架構下無法驗證姿態量測
元件與推力器之電氣介面特性，其須透過第
二階段之處理器迴路 (Processor-in-the-Loop)
驗證[6]。圖14為處理器迴路之架構，其與軟
體迴路之架構相似，不同處在於微衛星之三
軸角速度值所對應之電壓訊號會經由飛行電
腦端之類比輸出卡(Analog Output)輸出至之
類比輸入卡(Analog Input)後再轉換成對應之
角速度值供脈寬調變推力控制器使用，且推
進器之開啟命令會傳輸至控制推進器開關之
繼電器卡(Relay)上。處理器迴路驗證脈寬調
變推力器於微衛星姿態在三軸起始翻滾角速
度分別為[200, -200, 300]度/秒下之強健控制
測試結果如圖15-17 所示，其中姿態量測元
件 與 推 力 器 開 關 之 電 器 介 面 是 基 於
ADXRS300EB 單軸陀螺儀與KSD-9602閥件
(見表一)所設計。 
 
(a)系統方塊流程圖 
 
(b)測試實體圖 
圖 14 處理器迴路測試架構 
 
(a)Roll rate 
航空技術學院學報  第十卷  第一期（民國一○○年） 
128 
 
(c)Thruster 3 
 
(d)Thruster 4 
圖 17 噴嘴時間響應 
六、MATLAB/SIMULINK 程式模擬響應
圖 
1 ,  5deg,    0.24 ,  0.25 ,
2
l m d mα λ= = = =
 
 0.1 ,  0.1 ,  0.1l l d dλ λΔ = ± Δ = ± Δ = ±  
[ ] [ ]100 36 20 deg,φ θ ϕ = − −  
[ ]1.2 1.1 23 deg/ sec,φ θ ϕ⎡ ⎤ = − −⎣ ⎦& & &  
[ ]1.472 1.452 1.479xx yy zzJ J J Nm⎡ ⎤ =⎣ ⎦  
0 500 1000 1500 2000 2500
-2
-1.5
-1
-0.5
0
0.5
1
1.5
2
Quaternions(PWM)
Time (sec)  
圖 5 Time Response of Quaternion 
0 500 1000 1500 2000 2500
-200
-100
0
100
200
Spacecraft Attitude
φ R
ol
l(d
eg
)
0 500 1000 1500 2000 2500
-100
-50
0
50
100
θ P
itc
h(
de
g)
0 500 1000 1500 2000 2500
-200
-100
0
100
200
ψ Y
aw
 (
de
g)
Time (sec)
 
圖 6 Time Response of Spacecraft Attitude 
0 500 1000 1500 2000 2500
-400
-200
0
200
400
Sapcecraft Attitude Rate
R
ol
l R
at
e 
(d
eg
/s
ec
)
0 500 1000 1500 2000 2500
-250
-200
-150
-100
-50
0
50
P
itc
h 
R
at
e 
(d
eg
/s
ec
)
0 500 1000 1500 2000 2500
-200
0
200
400
600
Y
aw
 R
at
e 
(d
eg
/s
ec
)
Time (sec)  
圖 7 Time Response of Spacecraft Attitude 
Rate 
0 500 1000 1500 2000 2500
0
0.5
1
Thruster on time  
P
W
M
 1
0 500 1000 1500 2000 2500
0
0.5
1
P
W
M
 2
0 500 1000 1500 2000 2500
0
0.5
1
P
W
M
 3
0 500 1000 1500 2000 2500
0
0.5
1
P
W
M
 4
Time (sec)  
圖 8 Time Response of Thruster on time 
0 500 1000 1500 2000 2500
0
0.2
0.4
0.6
0.8
PWM output 
P
W
M
 1
0 500 1000 1500 2000 2500
0
0.2
0.4
0.6
0.8
P
W
M
 2
0 500 1000 1500 2000 2500
0
0.2
0.4
0.6
0.8
P
W
M
 3
0 500 1000 1500 2000 2500
0
0.2
0.4
0.6
0.8
P
W
M
 4
Time (sec)  
圖 9 Time Response of PWM output 
七、誌謝 
作者們感謝國科會專題研究案  NSC99- 
2221-E-344-002 和國家太空中心的計畫任
航空技術學院學報  第十卷  第一期（民國一○○年） 
130 
Control Design: A Nonlinear H∞  
Approach,” Asian Journal of Control, vol. 5, 
no. 3, pp. 406-411, 2003. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
The prototype PWPF modulator consists of two 
components: one is a first order low-pass filter, the other is a 
Schmitt trigger, both inside the feedback loop. The 
modulator has the advantages such as closed to the linear 
operation, high accuracy and adjustable pulse-width and 
pulse frequency which provide scope for advanced control. 
Unfortunately, a Schmitt trigger is simply an on-off relay 
with a deadband and hysteresis. On the other hand, the 
rather unique and inherent nonlinear and discontinuous 
characteristics of PWPF modulators give rise to challenges 
in the stability analysis of satellite attitude control systems. 
Stability results for PWPF feedback systems with linear 
plants have been established by a variety of methods 
[1516,17], with linearization nonlinear plants and PWPF 
modulators [18]. 
There have been a several papers reporting H control 
technique for the mismatched uncertainty/disturbance 
[17,18]. The study of robust control for a nonlinear 
spacecraft containing mismatched: thruster canted 
inaccuracy angle, the function of center of mass (CM) offset 
dependent on the thrusters are mounted a distance, the 
disturbing on the spacecraft may be attributed to gravity 
gradient, solar pressure, atmospheric drag and so on. Both 
uncertainty and disturbance has been adequately addressed 
or discussed in the literature. Developing a robust controller 
for satellite attitude control has become an important 
engineering issue due to limited resources (thruster fuel) 
subject to input nonlinearities (PWPF), disturbances and 
parametric uncertainties (moment inertia variation), and 
time. The concern of worst cases moment inertia variation is 
surmounts. At the same time, the uncertainties of mass 
offsets and thrust misalignments must be take into account.  
The rest of the paper is as follows: Section II presents the 
problem formulation of the spacecraft thruster control. 
Section III briefly describes the nonlinear robust control 
theory. The PWPF  presents and analyzes in section VI. 
Section V synthesis of robust controller are present. 
Simulation and Analyzes the results in Section VI. Section 
VII concludes the paper. 
II. PROBLEM FORMULATION OF THRUSTER CONTROL 
In the section, the dynamics of spacecraft thruster control 
model are derived and the control design problem is 
formulated. The four thrusters of the spacecraft are mounted 
on the  plantx y of the satellite in each corner of a square, 
in Figure 1(a). This is illustrated schematically in Figure 1. 
The side length is  2 d d  , 

 thrust mounting geometry 
misalignments, as depicted in Figure 1(b). The thrusters 
point primarily along z-body axis, but canted    from 
the z-axis to produce moments about the z-axis,   is 
thruster canted inaccuracy angle. The arrows in the left-hand 
side of Figure 1(c) indicate the direction of force generated 
by each thruster in the body x-y plane. A combination of 
thrusters 2 and 4 produce +z torque, while 1 and 3 produce a 
z  torques. Other thruster combinations produce torque 
about the y and z axis. During thruster burning in attitude 
control, the momentum of the satellite is change rapidly. As 
fuel tank in the satellite geometry center, the function of 
center of mass (CM) offset dependent on the thrusters are 
mounted a distance with uncertainty. Since the thrusters are 
mounted at a distance l l   along the –z axis from the 
satellite center of mass (and coordinate system origin), l  is 
the center of mass offset. The thrusters are canted such that 
the force vectors are at 45  to the principle axes in the x-y 
plane. For small  ,  cos 1        and 
 sin        . The unit thruster force vectors are 
indeed 
 
 
 1
1  
  
  
          
f ,
 
 
 
1  
  
  
           
2f
, 
 
 
 3
1  
  
  
            
f  
and 
 
 
 4
1  
  
  
           
f  
where 1 2  . Let ju  be, respectively, the thrust 
generated in each thruster torque on the spacecraft is 
   
 
4
1
u j j j
j
u

  r f  
in which 
jr  and jf  are the moment arm and thruster force 
direction vector of each thruster, respectively. Let 
 1 2 3 4 Tu u u u u , the control torque u  can then be 
expressed as 
 u B B u B u      
where 
1 1 1 1
2 2 2 2
3 3 3 3
b b b b
B b b b b
b b b b
         
, 
1 1 1 1
2 2 2 2
3 3 3 3
b b b b
B b b b b
b b b b
                
, 1 2b d , 
2b d l  , 3b d l  ,  1b d d d d          , 
   2b d d d l l l                    and  
   3b d d d l l l                 .and 
B B B      The variable u  is the thruster command, 
which is also the control input to be designed. 
The dynamics of the spacecraft satellite is described by 
the equation of motion  
     gJ J J J B B u                            (1) 
Then the system has a finite 2L  gain less than  . Once 
 V x is found, the control signal u  can be synthesized as  
  
2
T
xu g V   
where 
1 2
T
x
n
V V VV
x x x
        
 . 
Proof: See van der Schaft[19], Isidori [20] and Isidori 
& Astolfi [23]. Lemma 1 can further by generalized to 
account for uncertainties. This generalization may then 
become useful when we account for the practical satellite 
control problems in which the system is subject to thrust 
level variation, center of gravity offset and misalignment of 
thrusters. 
 
Theorem 1 Consider the nonlinear uncertain system (3) and 
the uncertainty of system parameters satisfies the following 
equation. 
     Tf x x x    ,        1 1 1 1T Tg x g x G x G x   , and 
       2 2 2 2T Tg x g x G x G x   , 
where   n mx   ,   1 mx    and   in piG x  , 1, 2i   
are known vector, for which we assume that there exist scale 
functions   0x   with  x  described by    x x    
with  0 0  . Under this assumption, if system (3) satisfies 
the following conditions: 
(i)       1,f x f x h x   is zero-state detectable. 
(ii) there exists a smooth function   0x    such 
that the following Hamilton -Jacobi partial differential 
inequality 
   1 1 2 221 1 1 12T T T Tx x xV f V g g g g V 
      
 
+
1 1 2 22
1 1 1 1
2
T T T T
x xV G G G G V
    
      
   
1 1
1 1 0
2 2
T Th h                                                     (7) 
has a smooth positive solution  V x where x X , and X  is 
an neighborhood of origin in n , then by the following state 
feedback law 
   2T xu x g V                                                           (8) 
the closed-loop system of (3) has a robust H -performance. 
IV. THE PULSE-WIDTH PULSE-FREQUENCY MODULATOR 
ANALYZES AND CRITERION 
The PWPF modulator process a pulse command 
sequence to the thruster value by adjusting the pulse width 
and pulse frequency. In its linear rang, the average torque 
produced equals the demand torque input. The PWPF 
modulator is depicted in Figure 3. It is comprised of a pre-
filter, Schmidt Trigger, and a feedback loop. When a 
positive input to the Schmidt Trigger is greater than d, the 
trigger output is mU . Consequently, when the input falls 
below d-h, the trigger output is 0. The response is also 
reflected for negative inputs. The Schmidt Trigger output, 
 u  , from the feedback loop, and the system input,  r t , 
from the error signal  e t . The error is fed into the pre-filter 
whose output  v t  feeds the Schmidt Trigger. The 
parameters of interest are the pre-filter coefficients mk  and 
m , and The Schmidt Trigger parameters d, h, mU  [16]. 
With a constant input, the PWPF modulator drives the 
thruster valve with an on–off pulse sequence having a nearly 
linear duty cycle with input amplitude. The modulator has a 
behavior that is independent of the system in which it is 
used. The static characteristics of the continuous time 
modulator for a constant input  e   are as follows: 
ln 1
1on m
T      
                                        (9) 
ln 1off m
bT      
                                          (10) 
1
ln 1 1
1m
f
b b
            
                     (11) 
ln 1
1 
ln 1 ln
1
b
duty cycle
b b
               
                             (12) 
Where 
m m
hb
k U h
 
, m
m m
k r d
k U h
  
. 
The approximation of PWPF modulator process can be 
described by [22]  
 
   1 2du t dr drr udt dt dt                                         (13) 
where 0i  , i=1,2 and  are constants, satisfying 2   . 
We shall now examine the solution properties of the 
dynamic model (13) and explain the corresponding 
switching mechanism, which is crucial for design of the 
controller. Eq. (13) can be solved explicitly for  r t  
piecewise monotone 
     2u t r t n r    
with  
     1 0 sgn0 2 0 r r rn r u r e                                                (14) 
for r  constant and  0 0u r u . Analyzing (14), we see that it 
is composed of a line with the slope, together with a 
term  n r . For  n r , it can be easily shown that if 
 0 0; ,u r r u  is the solution of (14) with initial values  0 0,r u , 
then, if  0 0r r   and  r   , 
one has 
VII. SIMULATION 
In the section, simulations are performed to verify the 
design method. The main requirement of the satellite 
attitude control was to produce a pointing knowledge 
accurate to within one pixel of the observed. The attitude 
control also was required to transfer the micro satellite from 
its parking orbit to a circular (about 700 km), raised its orbit. 
The time specified of these, setting time of three bodies rate 
is 100 sec. within 0.1deg/ sec , the three attitude angles 
setting time is 100 sec. within 0.1 deg and the thrust burn 
command are as possible as minimal. To ensure ability of 
robustness, the moment inertial variation start from 1.2 
multiple of extra up bound value,  1.2 M MI I  , to 0.8 
multiple extra low bound value,  0.8 M MI I . Table 1 
contains the inertia matrix and related parameters of the 
spacecraft. In Figure 3, represents the quaternion behavior. 
Figure 4 shows the  large angular rate maneuvers. In Figure 
5 depicts the PWPF time response the thrusters control 
components. Both simulations consider the disturbed torque 
and output limitation. The nonlinear H  controller results in 
a fast decay response and has a superior ability to attenuate 
the effects of external disturbance. 
VIII. CONCLUSION 
This paper presents a nonlinear robust state-feedback 
satellite large angle rate attitude PWPF thrusters control 
technique. An additional freedom in the candidate 
Lyapunov function is identified and explored to solve the 
nonlinear H  Hamilton-Jacobi inequality. The method is 
capable of designing a robust controller for nonlinear 
uncertain system such as the attitude control system of a 
spacecraft. The simulation results verify the effectiveness of 
the proposed method.  
ACKNOWLEDGMENT 
This work was supported by National Space 
Organization under Contract NSC 99-2221-E-344 -002 -. 
 
REFERENCES 
 
[1] Kalman, R.E., and R.S. Bucy, “New Results in Linear Filtering 
and Prediction Theory,” ASME J. Basic Eng., Vol. 80, pp. 193-
196, 1961. 
[2] [2] Stevens, B.L., and F.L. Lewis, Aircraft Control and 
Simulation, John Wiley and Sons, New York,  pp. 485-534, 
1992.  
[3] [3] Y. K. Chang, B. H. Lee, J. W. Choi, M. Y. Yun and S. J. 
Kang, “Rapid Initial Detumbling Strategy for 
Micro/Nanosatellites Using a Pitch Bias Momentum System”, 
Transactions Japan Society for Aeronautical and Space 
Sciences,, vol. 50, pp.63-69, 2007. 
[4] [4] Wyatt R. Johnson, James M. Longuski and Daniel T. 
Lyons, “Nondimensional Analysis of Reaction-Wheel Control 
for Aerobraking, ” Journal of Guidance, Control, and 
Dynamics, vol.26, no.6,pp.861-868, 2003. 
[5] [5] Hyochoong Bang, Hyun-Sam Myung, and Min-Jea Tahk, 
“Nonlinear Momentum Transfer Control of Spacecraft by 
Feedback Linearization, ” Journal of Spacecraft and Rockets, 
vol.39 no.6, pp.866-873, 2002. 
[6] [6] Haruhisa Kurokawa, “Survey of Theory and Steering 
Laws of Single-Gimbal Control Moment Gyros ,”Journal of 
Guidance, Control, and Dynamics, vol.30, no.5, pp.1331-
1340, 2007.  
[7] [7] Marco Lovera, Alessandro Astolfi, “Global Magnetic 
Attitude Control of Inertially Pointing Spacecraft ,”Journal of 
Guidance, Control, and Dynamics, vol.28, no.5, pp.1065-
1072, 2005. 
[8] [8] Mark L. Psiaki, “Global Magnetometer-Based Spacecraft 
Attitude and Rate Estimation ,” Journal of Guidance, Control, 
and Dynamics, vol.27, no.2, pp.240-250, 2004. 
[9] [9] Christian H. Tournes, Yuri B. Shtessel, and Ilya 
Shkolnikov, “Missile Controlled by Lift and Divert Thrusters 
Using Nonlinear Dynamic Sliding Manifolds ,” Journal of 
Guidance, Control, and Dynamics, vol.29, no.3, pp.617-625, 
2006.  
[10] [10]B. N. Agrawal, R. S. Mcclelland and Gangbing Song, 
“Attitude Control of Flexible Spacecraft Using Pulse-Width 
Pulse-Frequency Modulated Thrusters,” Space Technolog, 
Vol. 17, No. 1, pp.15-34, 1997. 
[11] [11]S. B. Skaar, Tang, L, and Yalda-Mooshabad, I. “On-off 
Control of Flexible Satellite,” Journal of Guidance, Control, 
and Dynamics, Vol. 9, No.4, pp.5070-510, 1986. 
[12] Dodds, S. J. and Williamson, S. E. “A signed switching time 
bang-bang attitude control law for fine pointing of flexible 
spacecraft,” International Journal of Control, Vol. 40, 
pp.795-811, 1984. 
[13] Agrawal, B. N. and Bang, H., “Slew maneuver of a flexible 
spacecraft using on-off thrusters,” Proceedings of  AIAA 
Guidance, Navigation, and Control Conference, pp.224-233, 
1993. 
[14] Bolzer, E., “The imitation of impules in cardiacmuscal,” 
American Journal Physiology, Vol. 138, pp.273-282, 1942. 
[15] Katz, B., “The nerve impulse,” Science American, Vol. 187, 
no. 5, pp.55-64, 1962. 
[16] Wu, S. H., Heinen, J. A., and Sances, A., Jr., “Nonlinear pulse 
modulation in pupilary systems,” IEEE-ISA 19th Engineering 
in Medicine and Biology Conference, pp. 196, 1966. 
[17] Balestrino, A., Eisinberg, A. and Sciavicco, L., “A 
generalized approach to the stability analysis of PWM 
feedback control systems,” Journal of Franklin Institute, vol. 
298, no. 1, pp.45-58, 1974. 
[18] Bong Wie and Carl T. Plescia, “Attitude Stabilization of 
Flexible Spacecraft During Stationkeeping Maneuvers,” 
Journal of Guidance, Control and Dynamics, Vol. 7, No. , 
pp.430-436, 1983. 
[19] H,  N, Shou and J, C, Juang, “An LMI-Based Nonlinear 
Attitude Control Approach,” IEEE Transactions on Control 
Systems Technology,  vol.11,  no. 1, p.73-83, 2003. 
[20] H, N, Shou and J, C, Juang, Y. W. Jan and C. T. Lin, 
“Quaternion Feedback Attitude Control Design: A Nonlinear 
H  Approach,” Asian Journal of Control, vol. 5, no. 3, pp. 406-411, 2003. 
[21] van der Schaft, A.J., “  gain2L  Analysis of  Nonlinear Systems and Nonlinear State Feedback H  Control,” IEEE Transaction on Automatic Control, vol.37, no. 6, pp.770-784 , 
1992. 
[22] A. Isidori, “ H  Control via Measurement Feedback for Affine Nonlinear System,” International Journal of Robust 
Nonlinear Control, vol.4, no. 4, pp.553-574, 1994. 
[23]  A. Isidori, and A. Astolfi, “Disturbance Attenuation and H  Control via Measurement Feedback in Nonlinear Systems,” 
 
 
 
八十七週年校慶基礎學術暨通識教育研討會                              民國一○○年五月十三日 
EE-94 
 
微衛星姿態翻滾強健控制使用脈寬脈頻調變推力器之分析與設計 
 
壽鶴年F1F 林辰宗 2 
 
1 空軍航空技術學院 航空通訊電子系 
2 國家太空中心 衛星飛行控制組 
 
摘要 
 
小(微)衛星進行的任務的能力從早期的軍事用途發展至氣象預測、資源探勘、通訊
及科學實驗等方面。小(微)衛星擁有機械結構簡單、可靠性高、價格低廉、研究人員與
設備精簡等優點。所以設計成本低、製作時間短、及高精度的微小衛星便成為各大學及
小型科技機構主要研究之領域。我國第二期太空計畫預計以自主發展微衛星為主要里程
碑，並期望使用自主載具進行發射。本文目的為探討微衛星脫離載具初入軌道之姿態控
制(Attitude Detumbling Control)問題。主要將藉由推力進行抑制衛星轉動及姿態穩定控
制，並使用軟體迴路(Software-in-the-Loop, SIL)與處理器迴路(Processor-in-the-Loop, PIL)
來實現。 
關鍵詞：姿態翻滾控制，軟體迴路，處理器迴路。 
 
 
                                                 
 
 
  1. 前言 
衛星從載具脫離進入任務軌道之前，會
有大翻滾帶著高角速度旋轉姿態，或初始
旋轉角速度超出設計容忍值時，姿態控制
系統其作用為抑制翻滾和降低角速度，以
利衛星進入任務軌道達成指向定位。若姿
態控制系統採用推力器產生推力以矯正姿
態，其優點為不受外在環境限制、易於操
作、可配合任何控制方法、修正時間快速，
且指向精度高。衛星內部不確定性為噴嘴
配置距離有誤差、推力器噴嘴傾斜面不精
確、氣體燃料使用使質量中心偏移等。衛
星外部擾動如高度及位置對重力梯度、空
氣阻力及磁力等環境因素等。噴嘴使用開
關閥控制易產生開關型控制 (bang-bang 
control)，無法如線性開關有高燃料效率，
脈寬脈頻調變器可同時解決推力器上述問
題。 
考慮衛星姿態處於系統不確性與外擾
並存時最惡劣狀況下(worst case)，採用強
健性控制理論結合脈寬脈頻調變器是小
(微)衛星從克服大翻滾、高旋轉角速度和
高精度指向任務姿態控制法則。本文將上
述問題最佳控制器為求解 H漢彌頓偏微分不
等式 H(Hamilton-Jacobi inequality)。當內部
參數變化外部擾動時衛星姿態能滿足任務
要求。 
本文之目的為衛星入軌精度與姿態控
制理論分析與設計，奠定有關微衛星之研
究基礎，欲更精進發展出微衛星更小具地
球觀測功能之微微級衛星姿態控制態技
術，並進一步製作出衛星工程實體與飛行
體。此一研究之目標為： 
1. 有效落實微型衛星設計於學術單位，並
進而推廣，擴大參與面。 
2. 實際地延伸我國的微型衛星基礎之研
究，增進地球觀測之功能。 
3. 強化學校對微型衛星次系統之分析、設
 
 
 
八十七週年校慶基礎學術暨通識教育研討會                              民國一○○年五月十三日 
EE-96 
 
(v) uτ 表示衛星姿態控制力矩，在本文
先由強健控制理論推導得到 uτ 與
推力器矩陣輸入u關係，再以脈寬
調變器命令結合噴嘴閥產生推力。 
(vi) 本文所提使用脈寬調變器與強健控
制器合成，使用軟體迴路測試，結
果如預期。 
 
3.衛星推力的產生-力矩推導 
衛星運動座標方向如圖 1 所示，衛星
的 4個推力噴嘴置於 x y− 平面傾斜λ 角
度，噴嘴方向朝 z− 方向，排列成正方形相
距離 d 。燃料槽於噴嘴 x y− 平面 l距離 
z+ 方向於衛星重心位置，如圖 2 所示。
λΔ 、 dΔ 和 lΔ 各表示為噴嘴傾斜角度、噴
嘴相對距離和燃料槽重心位置偏移的不確
定性，以下列為推力產生力矩 uτ 的推導如
下: 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
x
y
z
τ
τ
τ
⎡ ⎤⎢ ⎥= ⎢ ⎥⎢ ⎥⎣ ⎦
uτ  
( )r F= × urr  
1 1 2 2 3 3 4 4r F r F r F r F⎡ ⎤= × × × ×⎣ ⎦ u
r r r rr r r r  
1 1 1 1
2 2 2 2
3 3 3 3
β β β β
β β β β
β β β β
⎛ − −⎡ ⎤⎜ ⎢ ⎥= − −⎜ ⎢ ⎥⎜ ⎢ ⎥− −⎣ ⎦⎝  
1 1 1 1
2 2 2 2
3 3 3 3
β β β β
β β β β
β β β β
−Δ Δ Δ −Δ ⎞⎡ ⎤ ⎟⎢ ⎥+ −Δ −Δ Δ Δ ⎟⎢ ⎥ ⎟⎢ ⎥−Δ Δ −Δ Δ⎣ ⎦ ⎠
u  
( )= + ΔB B u  
其中 
( ) ( ) ( ) ( )
( ) ( ) ( ) ( )
( ) ( ) ( ) ( )
1 2 3 4
d d d d d d d d
r d d d d d d d d
l l l l l l l
x
y
zl
− + Δ − + Δ + Δ + Δ⎡ ⎤⎢ ⎥= − + Δ + Δ + Δ − + Δ⎢ ⎥⎢ ⎥− + Δ − + Δ − + Δ − + Δ⎣ ⎦
r
 
( ) ( ) ( ) ( )
( ) ( ) ( ) ( )
( ) ( ) ( ) ( )
sin sin sin sin
sin sin sin sin
cos cos cos
1 2 3 4
cos
x
y
z
F
ρ λ λ ρ λ λ ρ λ λ ρ λ λ
ρ λ λ ρ λ λ ρ λ λ ρ λ λ
λ λ λ λ λ λ λ λ
− + Δ − + Δ + Δ + Δ⎡ ⎤⎢ ⎥= + Δ − + Δ − + Δ + Δ⎢ ⎥⎢ ⎥− + Δ − + Δ − + Δ − + Δ⎣ ⎦
r
 
1
2
α = , 1 d lβ αλ= + , 2 d lβ αλ= − , 
3
dλβ α= , 
( ) ( )1 d d d l l lβ λ λ α λ λ λΔ = Δ − Δ +Δ + Δ + Δ +Δ Δ
( ) ( )2 d d d l l lβ λ λ α λ λ λΔ = Δ − Δ +Δ − Δ + Δ +Δ Δ
( )3 1 d d d dβ λ λαΔ = Δ + Δ + Δ Δ  
   推力轉換力矩矩陣B有下列特性: 
 (1) ( ) { }min ,rank m n+ Δ =B B  
x 
y
z
圖 1 衛星座標方向 
圖 2 衛星噴嘴幾何座標 
x 
y z
d 
d 
3 4 
2 1 
 
 
 
八十七週年校慶基礎學術暨通識教育研討會                              民國一○○年五月十三日 
EE-98 
 
僅適用於線性系統中，工程系統大多為非
線性系統，這時欲使用卡爾曼濾波器就必
須適時的修正。擴展式卡爾曼濾波器是針
對非線性系統的狀態方程與觀測方程採取
泰勒級數（Taylor Series）展開的線性化方
法，當系統存在著諸多高階導數項時，也
就是高非線性系統時，擴展式卡爾曼濾波
器線性化方法會導致濾波器性能下降甚至
發散的情況，而且在求解過程裡必須求取
賈可比矩陣(Jacobian matrix)矩陣，這對於
系統模型複雜性高的系統來說是不易去解
算的。  
樣 點 卡 式 爾 曼 濾 波 器 (Unscented 
Kalman Filter， UKF)演算法則是透過一
確定性採樣的方法獲得一組標準點(sigma 
point)，經由標準點對系統之非線性模型進
行非線性轉換(unscented transform)，這樣
一來無需對系統模型進行線性化的動作，
也就避免掉了線性化之後所引入的誤差，
使得濾波器的狀態估測精準度大大提高，
而且樣點式卡爾曼濾波器也不用求取計算
繁雜且易出錯的賈可比矩陣，大大的提升
其便利性。 
本文使用樣點式卡爾曼濾波器於微衛
星姿態翻滾模擬，並與擴展式卡爾曼濾波
器進行分析與比較，在相同模擬條件下樣
點式卡爾曼濾波器所估測之結果相較於擴
展式卡爾曼濾波器來得更加準確，定位精
度更高，而且其實現速度更快。 
 
於討論卡式爾曼濾波器前，關於四元素
方程式於 t t+Δ 和小角度 ϕΔ 的說明[1] 
( )
0
0
sin
02
0
z y x
z x y
y x z
x x z
e e e
e e e
t t
e e e
e e e
ϕ
⎛ −⎡ ⎤⎜ ⎢ ⎥−Δ⎜ ⎢ ⎥+ Δ = ⎜ ⎢ ⎥−⎜ ⎢ ⎥⎜ − − −⎣ ⎦⎝
q                
( )4cos 2 tI
ϕΔ ⎞+ ⎟⎠q          (2) 
對小角度 ϕΔ 而言，近似的觀念可得+ 
tϕ ωΔ = Δ  
1sin
2 2
tϕ ωΔ ≈ Δ  
cos 1
2
ϕΔ ≈  
所以式(2)成為 
( ) ( )412t t t I t
⎛ ⎞+ Δ = ΩΔ +⎜ ⎟⎝ ⎠q q          (3) 
其中 
0
0
0
0
z y x
z x y
y x z
x x z
ω ω ω
ω ω ω
ω ω ω
ω ω ω
−⎡ ⎤⎢ ⎥−⎢ ⎥Ω = ⎢ ⎥−⎢ ⎥− − −⎣ ⎦
 
 
對式(3)求導函數 
( ) ( )
0
1lim
2t
t t t
tΔ →
+ Δ −= = = ΩΔ
q q&q q       (4) 
改寫式(4)可得 
4 3 2
3 4 1
2 1 4
1 2 3
1 1
2 2
x
y
z
q q q
q q q
q q q
q q q
ω
ω
ω
−⎡ ⎤ ⎡ ⎤⎢ ⎥− ⎢ ⎥⎢ ⎥= = Λ⎢ ⎥⎢ ⎥− ⎢ ⎥⎢ ⎥ ⎣ ⎦− − −⎣ ⎦
&q ω
   
(5) 
其中 
4 3 2
3 4 1
2 1 4
1 2 3
q q q
q q q
q q q
q q q
−⎡ ⎤⎢ ⎥−⎢ ⎥Λ = ⎢ ⎥−⎢ ⎥− − −⎣ ⎦
 
 
5.1 擴展式卡爾曼濾波器 
   設非線性系統狀態模型及量測動態模
型表示為[2][3][4] 
( )1k k kx f x w+ = +                (6a) 
( )k k kz h x v= +                 (6b) 
其中 
kx 為在k時刻之系統狀態向量 
( )f   為非線性系統模型 
kw 為在k時刻之系統動態雜訊 
   kz 為在k時刻之量測動態向量 
( )h   為非線性系統量測模型 
kv 為在k時刻之量測動態雜訊 
 
若是雜訊 w 及 v之機率分佈為隨機任
意的，則（6）式為一般的離散非線性系統
模型。但這類系統對於最佳估測求解是非
常不方便的，因此為了使估測問題得到可
行之解答，必須對雜訊的統計特性給予符
合實際而又方便計算之假設，於一般工程
問題中，對w及 v設為為彼此互不相關且
 
 
 
八十七週年校慶基礎學術暨通識教育研討會                              民國一○○年五月十三日 
EE-100 
 
更新估測值:  
( )ˆk k k k k kx x K z H x− −Δ = Δ + Δ − Δ  
更新誤差之協方差矩陣:                     
( )k k k kP I K H P−= −  
預測參考狀態誤差: 
  1 ˆk k kx x−+Δ = Φ ⋅Δ  
估測誤差之共變異數矩陣:  
1
T
k k k k kP P Q
−
+ = Φ Φ +  
其中: 
( )
ˆk k
k
k
k x x
f x
x =
∂Φ = ∂ , 
( )
ˆk k
k
k
k x x
h x
H
x −=
∂= ∂  
 
5.3 擴展式卡爾曼濾波器在程式上的實現 
 
衛星系統估測狀態: 
1 2 3 4ˆ
T
x y zx q q q q ω ω ω⎡ ⎤= ⎣ ⎦  
 
狀態誤差轉移矩陣: 
( )
7 7k
f x
I t
x×
∂Φ ≈ + Δ∂  
7 7I t×
∂ ∂⎡ ⎤⎢ ⎥∂ ∂⎢ ⎥= + Δ∂ ∂⎢ ⎥⎢ ⎥∂ ∂⎣ ⎦
& &
& &
q q
q ω
ω
q ω
ω  
其中 
1 1
2 2i i iq q q
∂ ∂ ∂Ω= Ω +∂ ∂ ∂
&q q q  
1 1
2 2i iq q
∂ ∂= Ω + Λ∂ ∂
q ω  
1
2
= Ω  
1
2
∂ ∂ ⎛ ⎞= Ω⎜ ⎟∂ ∂ ⎝ ⎠
&q qω ω  
1
2
∂ ⎛ ⎞= Λ⎜ ⎟∂ ⎝ ⎠ωω  
1
2
∂= Λ ∂
ω
ω  
1
2
= Λ  
,
,1
c mag body
c mag
T m b
T
J −
= ×
∂⎛ ⎞∂ = ⎜ ⎟∂ ∂⎝ ⎠
&ω
q q
 
( )1 M BJ ×− ⎛ ⎞∂⎜ ⎟= ⎜ ⎟∂⎝ ⎠q  
0
0
0
yy zz xx zz
z y
xx xx
zz xx zz xx
z x
yy yy
xx yy xx yy
y x
zz zz
J J J J
J J
J J J J
J J
J J J J
J J
ω ω
ω ω
ω ω
⎡ ⎤− −⎢ ⎥⎢ ⎥⎢ ⎥− −∂ ⎢ ⎥=∂ ⎢ ⎥⎢ ⎥− −⎢ ⎥⎢ ⎥⎣ ⎦
&ω
ω
 
 
輸出量測: 
T
m s gH H H H⎡ ⎤= ⎣ ⎦  
其中 
磁力計量測輸出 
ˆ ˆ T
m
b bH
⎡ ⎤∂ ∂= ⎢ ⎥∂ ∂⎣ ⎦q ω
 
3 3
ˆ 0
Tbody
ECI
ECI
i
A b
q ×
⎡ ⎤∂= ⎢ ⎥∂⎣ ⎦
 
 
太陽感測器量測輸出 
ˆ ˆ
T
s
s sH ⎡ ⎤∂ ∂= ⎢ ⎥∂ ∂⎣ ⎦q ω  
3 3ˆ 0
Tbody
ECI
ECI
i
A s
q ×
⎡ ⎤∂= ⎢ ⎥∂⎣ ⎦
 
 
陀螺儀量測輸出 
ˆ ˆ T
gH
⎡ ⎤∂ ∂= ⎢ ⎥∂ ∂⎣ ⎦q
ω ω
ω  
[ ]3 4 3 30 TI× ×=  
 
6. 軟體迴路(Software-in-the-Loop, SIL)
與處理器迴路(Processor-in-the-Loop, PIL)
之實現 
在本文微衛星姿態控制系統的期中完
成軟體迴路測試驗證，在此驗證架構下，
感測器與致動器的電氣介面皆使用數學函
式達成。此驗證方式，可以驗證姿態控制
系統軟體之功能與性能，但是當實際任務
飛行階段時，因為感測器與致動器及其電
氣介面都在閉迴路內，故實際且完整之控
制系統並未經嚴謹之驗證[5]。 
航太工程實驗發展衛星計畫之前常需
 
 
 
八十七週年校慶基礎學術暨通識教育研討會                              民國一○○年五月十三日 
EE-102 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
圖 11 姿態角變化率時間響應 
(a) Roll rate 
(b) Pitch rate 
(c) Yaw rate 
圖 12 四元數時間響應 
(d) Quaternion 4 
(c) Quaternion 3 
(b) Quaternion 2 
(a) Quaternion 
(a) Thruster 1
(b) Thruster 2 
(c) Thruster 3 
 
 
 
八十七週年校慶基礎學術暨通識教育研討會                              民國一○○年五月十三日 
EE-104 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
7.MATLAB/Simulink 程式模擬響應圖 
依據前述各節說明與推導結果，微衛星
模擬參數系統採用初始條件如下: 
 
 
 
 
 
 
(c) Yaw rate 
圖 15 姿態角變化率時間響 
(a) Quaternion 1 
(b) Quaternion 2 
(c) Quaternion 3 
(d) Quaternion 4 
圖 16 四元素時間響應 
圖 17 噴嘴時間響應 
(d) Thruster 4 
(c) Thruster 3 
(b) Thruster 2 
(a) Thruster 1 
1 ,  5deg,    0.24 ,  0.25 ,  
2
0.1 ,  0.1 ,  0.1
l m d m
l l d d
α λ
λ λ
= = = =
Δ = ± Δ = ± Δ = ±
 
[ ] [ ]100 36 20 deg,φ θ ϕ = − −  
[ ]1.2 1.1 23 deg/ sec,φ θ ϕ⎡ ⎤ = − −⎣ ⎦& & &  
[ ]1.472 1.452 1.479xx yy zzJ J J Nm⎡ ⎤ =⎣ ⎦  
 
 
 
八十七週年校慶基礎學術暨通識教育研討會                              民國一○○年五月十三日 
EE-106 
 
的濾波器整體上具有線性結構，降低了演
算法的複雜性。 
研究方式為通過狀態擴展，將QKF進一步
拓展到解決無陀螺儀情況下的姿態確定問
題，並通過選用正規的角速度運動模型，
保持了濾波器的線性特色。在此基礎上，
本文進一步通過引入強健追蹤處理，以降
低對角速度的估計偏差。在計算量增加不
大的情況下，有效提高了無陀螺儀QKF的
性能，加速了演算法的初始收斂，並獲得
了對快速姿態運動的跟蹤能力[6]。 
參考文獻： 
[1] H. Weidong, Z. Yulin, “Rate Damping 
Control for Small Satellite Using 
Thruster,” Acta Astronautica, vol.55, 
pp.9-13, 2004. 
[2] B. N. Agrawal, R. S. Mcclelland and G. 
Song, “Attitude Control of Flexible 
Spacecraft Using Pulse-Width 
Pulse-Frequency Modulated Thrusters,” 
Space Technolog, vol. 17, No. 1, 
pp.15-34, 1997. 
[3] J. Yuan ,  D. Yang, and    H. Wei, 
“ Flexible Satellite Attitude Maneuver 
Control Using Pulse-width 
Pulse-frequency Modulated Input 
Shaper,” International Symposium 
on HSystems and Control in Aerospace 
and Astronautics, pp.1407-1412, 2006.  
[4] H,  N, Shou and J, C, Juang, “An 
LMI-Based Nonlinear Attitude Control 
Approach,” IEEE Transactions 
on HControl Systems Technology, H 
vol.11,  Hno. 1H, pp.73-83, 2003. 
[5] H, N, Shou and J, C, Juang, Y. W. Jan 
and C. T. Lin, “Quaternion Feedback 
Attitude Control Design: A Nonlinear 
H∞  Approach,” Asian Journal of 
Control, vol. 5, no. 3, pp. 406-411, 2003. 
 
 
 
 
 
 
誌謝 
作者們感謝國科會專題研究案 NSC 
99-2221-E-344-002 和 國 家 太 空 中 心
NSPO-S-099135 的工程技術諮詢、協助與
研究經費的贊助。 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
國科會補助計畫衍生研發成果推廣資料表
日期:2011/07/27
國科會補助計畫
計畫名稱: 應用卡門濾波器於微衛星姿態估測:處理器實驗迴路之設計與驗證
計畫主持人: 壽鶴年
計畫編號: 99-2221-E-344-002- 學門領域: 航太科技
無研發成果推廣資料
權利金 0 0 100% 千元  
碩士生 2 2 100%  
博士生 1 1 100%  
博士後研究員 0 0 100%  
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 0 1 100%  
研究報告 /技術報
告 0 0 100%  
研討會論文 1 1 100% 
篇 
Ho-Nien Shou, Yi-Na 
Liu, Fu-Hwa Liu, and 
Lih-Feng 
Lin ＇Micro-Satellite 
Robust Attitude Fault 
Tolerant Control,＇ 
Journal of Air Force 
Institute of 
Technology, Vol. 10, 
No. 1, pp. 103-114, 
2011. 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 1 1 100%  
博士生 2 2 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
其他成果 
(無法以量化表達之
成果如辦理學術活
動、獲得獎項、重要
國際合作、研究成果
國際影響力及其他
協助產業技術發展
之 具 體 效 益 事 項
等，請以文字敘述填
列。) 
為 98 國家太空中心研究計畫實際延伸:微型衛星基礎之研究 
(國家太空中心研究計畫:使用脈寬脈頻調變推力器於微衛星姿態翻滾強健控制
分析與設計 
計畫編號：98-NSPO(A)-GE-FE23-01) 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
科 
教 
處 
計 
教材 0  
 
