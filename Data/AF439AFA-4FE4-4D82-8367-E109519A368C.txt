驗結果成功的建立預測系統。Petrova 與Kazmer[6]則加入
了一些影響射出成型的因素，如切變率、流變性及黏滯性
等，使的類神經網路系統的輸入更為精確。Helps 等[7]
使用類神經方法來預測成型品的特性，並證明此法能對多
種產品且產品尚在模腔內時，即能對成型品做成功的預
測。Helps 等[8]同時利用類神經方法來預測新的射出成型
產品的參數設定值。Fara 等[9]則使用類神經方法設計兩
個控制器分別控制射出成型製程的填充與保壓階段。Lam 
等 [10]利用極小化填充過程中的流徑長度 (Flow Path 
Length)或填充時間的標準差來找尋模具澆口的最佳位
置。對於均勻厚度的成型品兩種方法皆適用，但對非均勻
厚度的產品，極小化填充時間的標準差的方法優於極小化
流徑長度。Min 等[11]利用類神經方法建立非線性回歸模
型來尋找射出成型的最佳製程狀態，降低成形品的體積收
縮率。Liang 等[12]利用類神經方法建立射出成型的自我
學習控制器，首先利用CAE 軟體獲得製程參數，根據這
些參數作實驗設計獲得輸入與輸出資料，然後利用輸入與
輸出資料訓練類神經網路以建立製程控制器與品質預測
器。Turng 等[13]結合射出製程模擬軟體與最佳化軟體來
找尋最佳設計與製程參數。 
近年來，多位學者提出有關製程控制方面研究，
MacGregor[14]，Box 和ramer[15]，Box 和Jenkins[16] 提
出了EWMA(Exponentially Weighted Moving Average)控制
器理論。Box和Jenkins 所提的EWMA 控制器是將目標值
與輸出值的差距，依其時點與現今時點的不同，給予一呈
現遞減幾何分配的權重，也就是說，離現今時點越近的資
料點，給予資料點的權重越大。Box 和Jenkin 也證明當
製程擾動呈現IMA(1,1)(Integrated Moving Average)型態
時，EWMA 控制器是一MMSE (Minimum Mean Squraed 
Error)控制器。Tucker 和Faltin[17]，Vander Wiel 等[18]
則提出了一應用連續製程產業 (Algorithmic Statistical 
Process Control)。半導體業界最先提到批次控制的理論係
德州儀器公司的Guide 等[19]，探討利用氧化時間來控制
氧化層的生長厚度。而後MIT 研究群提出了批次控制器
的理論與實驗結果[20-26]。柏克萊大學[27,28]，密西根大
學[29-33]與德州儀器公司[34-38]亦隨後提出這類研究。
Butler 與 Stefani[35]所提出的 PCC (Predictor Corrector 
Control)控制方法應用於具有漂移特性的製程，將製程平
均值調整至目標值。Chen 等 [39]則提出Age based 
DEWMA 控制方法來估計製程真正漂移量，此法能應用
於非連續抽樣量測。 
本計畫與竹永成精密機械合作，將先進製程控制運
用於射出成型機，以改善產品品質。本計畫選擇重量為產
品品質指標，在製程模型建立以部分因子實驗篩選眾多因
子與重量較顯著的關係，透過較顯著的因子以反應曲面法
設計出製程模型，在以RLS不斷的修正製程模型使得符合
現場變動，再以MVC控制製程變異使得符合製程目標
值。預期使得射出成型產業在機構性原件上製程的改善。 
 
研究方法 
  本計劃研究先進製程控制於塑膠射出成型之應
用，研究方法首先將運用部份因子實驗設計，將影響產品
品質的重要因子篩選出來，再利用反應曲面法，建立製程
的輸入因子與輸出的關係式。並利用最小平方法(RLS)來
做製程模型的即時調變，再以最小變異控制器(MVC)來預
估下一個製程的輸入以期輸出能符合預定之目標值。本計
畫與竹永成精密機械合作，針對 ADSL 的下蓋當測試產
品，以產品重量(Y)當產品的規格，依據業者生產產品所
要求之規格目標值為 Y=88.4g。以重量當規格是因為在機
構性元件上，產品的品質往往與重量有關係，產品因為縮
水、短射、毛邊等等都影響到重量的問題，所以本研究以
此為反應變數來做分析，文獻上亦可見到產品重量對射出
成型品的品質影響之重要性。各方法分敘述如下： 
 
部份因子設計 
部分因子設計主要的目的是在篩選實驗（Screening 
experiments），主要是因為在實驗初期，眾多的因子與反
應的關係未知，有可能影響很大或是很小，所以透過部分
因子設計辨認出效應大的因子，被辨認為重要的因子作為
後續更深入的討論。在射出成形中眾多的因子影響產品的
品質特性，為了避免漏掉與產品特性相關的因子，透過專
業家討論並建議以下七種參數，（A）速度、（B）壓力、（C）
時間、（D）料管溫度、（E）模具溫度（F）背壓（背壓越
大、密度越大、重量越重）（G）螺桿距離（只需有足夠
的量）。依照專家的經驗提出了上面七種主要有關的因
子，但是（F、G）不列入設計主要是因為只要是適當設
定，在製程中不會去改變此參數。部份因子的實驗設計上
考慮溫度在調整上需要時間很久所以相同溫度同時做，其
它的再以隨機性選取。選擇五個因子、兩水準只做二分之
一（25-1=16 次），每個實驗序的前五次不予記錄，只取第
六次至第十次之結果，實驗結果如表一所示。配合
STATISTICA 6.0 軟體分析，可以發現只有A（速度）、C
（壓力）因子是顯著的，在整體模型解釋力方面
R2=0.849，解釋能力稍嫌不足。接下來把交互作用放進來
檢定，發現主因子的部分只有E（模具溫度）因子不具有
顯著性，整體模型解釋能力方面R2=0.998，所以由以上數
據分析得知變數E（模具溫度）P-value>0.05（不顯著）所
以我們把變數E拿掉，最後留下A（速度）、B（壓力）、C
（時間）、D（料管溫度），四個因子來做反應曲面法。 
表一 部份因子實驗結果 
實驗序
 
第六次
 
第七次
 
第八次
 
第九次
 
第十次
 
實驗序
 
第六次
 
第七次
 
第八次
 
第九次
 
第十次
 
1 91.8 91.9 91.6 91.7 91.6 9 92.6 92.5 92.5 92.6 92.6
2 92.6 92.3 92.4 92.4 92.4 10 91.9 92 91.9 91.9 91.9
3 87.5 87.4 87.4 87.4 87.5 11 87.1 87.3 87.4 87.3 87.4
4 91.5 91.5 91.6 91.5 91.5 12 91.7 91.7 91.8 91.7 91.7
5 91.1 91.2 91.2 91.4 91.5 13 93.1 93 93.2 93.1 93 
6 91.5 91.5 91.3 91.4 91.5 14 92 91.9 92 92 91.9
7 87.4 87.4 87.4 87.3 87.4 15 91.2 91.1 91.2 91.2 91 
8 92.7 92.7 92.8 92.7 92.7 16 87.4 87.4 87.3 87.2 87.2
  
 
反應曲面法 
反應曲面法（response surface methodology, RSM）
為結合數學及統計技術，它是實驗設計的一種方法，它可
以將一問題數學模式化，通常以圖形的方式來表示反應曲
 
結果與討論 
 影響重量的四個因子為速度、壓力、時間、料管溫
度，本研究控制實驗中只選用其中兩個因子速度、壓力作
為控制器調整用。時間不調整的主要原因是因為現場人員
希望每個製程的時間保持一定的循環，以方便估計產量，
料管溫度不調整主要是因為調整無法及時反應在製程
上，需要很長的時間加熱、散熱，所以本研究選用了速度、
壓力作為變異的調整。時間與料管溫度本研究以第四章之
初步參數找尋的設定作為固定，除了關鍵因子外其它條件
如：模溫、鎖模力等等皆以適當設定，實驗當中並不改變。 
所建立的預測模型因為保壓時間為 2（Seconds）與
料管溫度=215（℃）固定為常數，假設製程在時間 t的輸
出值重量 可表示輸入值tY 1tX − 之關係模式，所以(1)式改
寫如下。 
1, 1, 1, 1,
2 2
1, 1,
55.7438 1.128625 0.3073 0.0095
0.016654 0.005859
t A t B t A t B
t A t B
Y X X
X X ε
− − −
− −
= + + +
− − +
X X −  (15) 
其中 ε 為誤差項 ，而 2~ (0,0.369 )NIDε
[ ]t ty Y= , ,  ,
,
1
t t A
t B
u X
X
⎡ ⎤⎢ ⎥= ⎢ ⎥⎢ ⎥⎣ ⎦
, ,
2
,
2
,
t A t B
t t A
t B
X X
Z X
X
⎡ ⎤⎢ ⎥= ⎢ ⎥⎢ ⎥⎣ ⎦
55.7438
1.128625
0.3073
T
N
⎡ ⎤⎢ ⎥= ⎢ ⎥⎢ ⎥⎣ ⎦
, . 
0.0095
0.016654
0.005859
T
M
⎡ ⎤⎢ ⎥= −⎢ ⎥⎢ ⎥−⎣ ⎦
 
遞迴最小平方法驗證結果 
測試了三組設定參數，每組五十筆實驗，並以調整
RLSλ 值，λ 值為歷史資料與現在資料的權重（λ =1 代
表歷史資料與現在資料的權重相同、λ =0.9 代表現在資料
比歷史資料重要，依照製程穩定性調整為主）。測試參數：
1.速度=33（percent）、壓力=30（percent）。2.速度=31
（percent）、壓力=35（percent）。3.速度=35（percent）、
壓力=30（percent）。調整方式：改變λ 值（λ =1、λ =0.9）。 
一、速度=33（percent）、壓力=30（percent），λ =1 如
圖一和λ =0.9 如圖二。 
 
圖一 速度=33、壓力=30、λ =1，實際值與預測值 
 
圖二 速度=33、壓力=30、λ =0.9，實際值與預測值 
由圖一、圖二得知，分別以不同λ 值作為測試，發現
圖一明顯的有波動，是因為λ 值的大小代表了歷史資料的
重要度，圖二（λ =0.9）預測值的震幅有明顯隨著實際值
再變動，以實際的 MSE 做比較，圖 5.3（λ =1）、圖二
（λ =0.9）的 MSE 分別為 0.36、0.15，λ =0.9 比較好，
主要是因為資料波動很大，λ 值越小越相信現在的資料。 
二、速度=31（percent）、壓力=35（percent），λ =1 如
圖三和λ =0.9 如圖四。 
 
圖三 速度=31、壓力=35、λ =1，實際值與預測值 
 
圖四 速度=31、壓力=35、λ =0.9，實際值與預測值 
由圖三、圖四得知，實際值 23~50 筆資料比 1~22 筆
資料有明顯偏高，λ =0.9 也比λ =1 更有效的修正預測
值，從圖四看出在第 37 筆就追上實際值，然而圖三卻要
第 45 筆才趕上，所以λ 值的大小關係到預測器修正的快
慢。MSE 分別為λ =1 時 0.97、λ =0.9 時 0.023。 
三、速度=35（percent）、壓力=30（percent），λ =1 如
圖五和λ =0.9 如圖六。 
（代表現在資料比歷史資料重要）模擬數據如
圖十一、圖十二。  
 
圖十一 λ =0.6 時，模擬機台實際生產之重量變化量 
 
圖十二 λ =0.6 時，模擬機台實際生產的輸入參數變化量 
λ =0.6，從圖十一、圖 5.1 十二 4 來看似
乎沒有加速收斂，與圖七、圖八比較幾乎一
樣，主要是因為改變λ 值是把過去資料與現在
資料做權重分配，以本次模擬來看機台穩定所
以不會因為改變λ 造成加速收斂。 
(四) ε =0.07（加入干擾）、cost function 如(14)式、
λ =1（代表歷史資料和現在資料的權重相同），
模擬數據如圖十三、圖十四。  
 
圖十三 ε =0.07 時，模擬機台實際生產的重量變化量 
 
圖十四 ε =0.07 時，模擬機台實際生產的輸入參數變化量 
本次模擬把ε =0.07 加入，模擬線上生產
產生的干擾誤差，從圖十三與圖十四發現控制
器很快就達到目標值，並不斷在修正輸出參
數。 
二、假設機台因為零件消耗產生重量偏移，造成機台射出
重量與之前有差距，模擬各種調整方式如下，T（偏
移量）=0.5  
1, 1, 1, 1,
2 2
1, 1,
55.7438 1.128625 0.3073 0.0095
0.016654 0.005859
t A t B t A t B
t A t B
Y X X
X X Tε
− − −
− −
= + + +
− − + +
X X − (16) 
(一) ε =0（無干擾）、cost function 如(14)式、λ =1
（代表歷史資料和現在資料的權重相同）、T（偏
移量）=0.5，模擬數據如圖十五、圖十六。 
 
圖十五 偏移造成重量變化量 
 
圖十六 偏移造成輸入參數變化量 
由圖十五得知忽然的重量偏移造成控制器
收斂速度慢但是經過兩百五十筆還是可以收斂
至目標值，圖十六可以看出速度設定參數經過
很久才掉下來到 32.7。 
(二) ε =0（無干擾）、cost function 如 5.6 式、λ =0.6
（代表現在資料比歷史資料重要）、T（偏移量）
=0.5。模擬數據如圖十七、圖十八。 
 
圖十七 λ =0.6 時，造成偏移的重量變化量 
 
 
圖二十五 漂移造成重量變化量 
 
圖二十六 漂移造成輸入參數變化量 
圖二十五模擬機台發生漂移可以發現也
是要經過一百五十筆才能達到收斂，圖二十六
可以看出在輸入參數變化量在收斂的情況。 
(二) ε =0（無干擾）、cost function 如(14)式、λ =0.6
（代表現在資料比歷史資料重要）、 d（漂移量）
=0.02。模擬數據如圖二十七、圖二十八。 
 
圖二十七 λ =0.6 時，造成漂移的重量變化量 
 
圖二十八 λ =0.6 時，造成漂移的輸入參數變化量 
圖二十七和圖二十五比較就可以發現改
變了 λ 值就會照成控制器快速達到目標值也
是和偏移時的模擬一樣有效過。 
(三) ε =0（無干擾）、cost function 如(14)式、λ =1
（代表歷史資料和現在資料的權重相同）、d（漂
移量）=0.02。模擬數據如圖二十九、圖三十。 
 
圖二十九未考慮輸入值差距改變量造成漂移的重量變化
量 
 
圖三十 未考慮輸入值差距改變量造成漂移的輸入參數變
化量 
從圖二九、圖三十仍可以快速的達到目標
值，並沒有發生像偏移時產生的過度控制。 
(四) ε =0.07（加入干擾）、cost function 如(14)式、
λ =1（代表歷史資料和現在資料的權重相同）、
d（漂移量）=0.02。模擬數據如圖三十一、圖
三十二。 
 
圖三十一 ε =0.07 時，重量改變量 
 
圖三十二 ε =0.07 時，輸入參數改變量 
本次模擬把第一次的模擬加入干擾ε =0.07，整體的趨勢差異不大，如圖 5.33 圖
5.34。 
(五) ε =0.07（加入干擾）、cost function 如(14)式、
λ =0.6（代表現在資料比歷史資料重要）、d（漂
移量）=0.02，模擬數據如圖三十三、圖三十四。 
