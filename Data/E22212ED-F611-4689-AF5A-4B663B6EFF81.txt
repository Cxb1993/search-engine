 2
摘要 
一直以來股市就是最為普遍的一種投資方式，本研究最終目的是藉由智慧型計算工具，建立一個
高效率的股市決策支援系統，希望藉由此一系統可以提供投資者額外的參考，對於投資人來說，有很
多保守的散戶是將股票作為一長期投資，只希望可以得到穩定的投資報酬率。本研究主要利用線段切
割法（Picewise Linear Representation–PLR）和叢集式類神經網路（Ensemble Neural Network）來進行
股票轉折點之預測。線段切割法主要應用在將股價資料做細部線段切割，並且去除雜訊資料，以判斷
股價走勢，如何決定細部線段切割之最佳門檻值為一重要關鍵；而叢集式類神經網路主要是結合多個
不同的類神經網路，透過此一方法讓最後的輸出可以穩定，以達到投資人希望穩定報酬率的目標。 
其中，類神經網路主要在訓練技術指標（Input Variables）與股價轉折點(Output Variables)之連結權
重，透過叢集式方法期望找出穩定的最佳買賣點時機。本研究以台灣股市與美國股市中的個股作為研
究對象，將以預測出的買賣點進行實際的投資獲利計算，經實驗結果證明，本研究所建構之線段切割
法及叢集式類神經網路之預測模型，比傳統之技術指標方法能更加準確且穩定的預測出股價之最佳轉
折點。 
本計畫藉由型態比對學之靈感，將線段切割法結倒傳遞類神經網路，建構成一智慧型交易決策支
援系統，協助投資人判斷買賣股票的適當時機並賺取利潤。透過此方式加強模式之穩定度，使預測效
果更為優異，最後並期望將此一應用資料技術，回饋至總計劃，加強總計劃之運用效果。本子計畫運
用上述之技術，進一步思考除了找出股票價格趨勢之外，如何運用此一趨勢線分析，有效幫助投資者
獲取利潤。此一部分本計畫期望運用線段切割法及類神經網路互相搭配做為本計畫之主要研究方法，
期望藉由此一研究方法有效掌握股票市場之交易點預測，幫助投資者獲取利潤。 
關鍵字：線段切割法、股市交易訊號、類神經網路 
Abstract 
 Stock turning signals detection is a very interesting subject arising in numerous financial and economic 
planning problems. In this paper, Ensemble Neural Network system with Intelligent Piecewise Linear 
Representation for stock turning points detection is presented. The Intelligent piecewise linear representation 
method is able to generate numerous stocks turning signals from the historic data base, then Ensemble Neural 
Network system will be applied to train the pattern and retrieve similar stock price patterns from historic data 
for training. These turning signals represent short-term and long-term trading signals for selling or buying 
stocks from the market which are applied to forecast the future turning points from the set of test data. 
Experimental results demonstrate that the hybrid system can make a significant and constant amount of profit 
when compared with other approaches using stock data available in the market. 
 
Key words: Piecewise Linear Representation, Stock Trading Signals, Neural Networks 
 
1. Introduction 
證劵市場是一個國家在穩定發展後的必然產物，亦是經濟的櫥窗。其中股票交易為一個國家最重要
的資本市場之一，而股價又反應了企業之價值，因此股票市場之榮枯不僅影響了企業之籌資管道，也
會對經濟發展造成影響。近年來，在集中交易市場中，每日交易量動輒數百億，甚至上千億。根據台
灣證券交易所統計資料顯示，民國98年1月底為止，國內股市投資人累計開戶人數為一千四百八十九萬
九千人，由此顯示股票等有價證券已逐漸成為國人主要投資理財的管道。 
在證劵市場中，所有能影響股票價格的資訊都能迅速且完整的被反映到股價上，即股票的價格會隨
著公司的利多或利空等新訊息的出現而立即調整，使得任何投資者都無法持續賺得超常報酬(abnormal 
return)。對股市投資人來說，大多數都積極的希望能從中獲得超額的報酬。為能獲取投資的最大利潤，
投資人必須考量關於資金、政治、經濟、技術及心理等各種因素。而如此眾多影響股價之因素糾纏在
一起，實非單一人類專家所能全權掌控的。從以股市的開戶人口看來，根據統計有九成左右屬於散戶，
在缺乏資訊與專業的分析能力與操盤時間的情況下，每當有重大事件或突發狀況時，其損失往往十分
慘重。 
在股票交易市場中，投資人區都是希望在股市中獲取利益，因此就會產生各種預測股價方法，希望
 4
理，其目的是為了減少原始資料的複雜性，並在各線段中作細部切割，使切割線段能夠與原始資料更
加符合。  
2.4.  類神經網路(Neural Network) 
類神經網路（Artificial Neural Network），是指模仿生物神經網路的資訊處理系統。類神經網路是
一種計算系統，其中包括軟體與硬體，它使用大量簡單的人工神經細胞來模仿生物神經網路的能力。
人工神經元是生物神經元的簡單模擬，它從外界環境或者其他人工神經元取得資訊，並加以非常簡單
的運算，輸出其結果到外界環境或者其他人工神經元，以便用於推估、預測、決策、診斷。類神經網
路應用於股市預測方面的研究則最為常見。Liu 與 Yao [6]的研究結果發現，以演化式神經網路預測股
價，可以明顯提高預測能力。Abraham 等[7]的實驗結果顯示，類神經網路預測出的 RMSE 值在 3.5%
以下，而模糊類神經模型也可以提供 100%的趨勢預測。 
2.5. 叢集式方法(ensemble method) 
對於各種不同的問題，使用各個方法都有其不同之優缺點，為了將每個模型之優點結合，進而出現
了叢集式方法，期盼藉由此一方法可以得到最好的結果，叢集式方法是藉由對不同模型進行投票（權
重）來達成目的。叢集式方法最基本的方式為每個模型的權重相同（Bayesian averaging），但是每個模
型的權重相同不能讓一些較好的模型，對於整體的改善更明顯，所以到後來又出現了一些權重修正的
方法，例如：Bagging、boosting等等…，希望可以讓整體模型獲得更加的改善。Liu 與 Xin [8]介紹最
基本的叢集式方法，將數個類神經網路模型結合，其研究中認為一個類神經網路可以學習到某一個片
段，使用數個不同的類神經網路，每一個神經網路分別學習到不同的片段，經由叢集式方法將每一個
類神經網路結合，將可以學習到全部的片段，已達到更好的效果。其實驗結果也說明叢集式類神經網
路，確實比單一個類神經網路有更好的結果。 
Perrone 與 Cooper [9]是用叢集式方法將不同個類神經結合應用在圖片處理上面，研究中計算
MSE(Mean Squared Error)要使 MSE 最小，利用交叉效度（Cross-Validation）來修正個別模型的權重，
每次修正完都將所有權重正規化使其全部相加為一。實驗結果證明，此種方法可以得到要比最基本的
叢集式方法更好的結果。 
3. Methodology 
本研究方法的運作方式。本研究結合 PLR、倒傳遞類神經網路、基因類神經網路與 Adaboost，結合
線段切割法與叢集式類神經網路於股價買賣點之預測，主要是利用叢集式類神經網路將各個神經網路
模型的輸出結合，目的是期許經過 PLR 將雜訊去除後，再透過叢集式類神經網路使得訓練過後的權重
不僅可以府和股價走勢，而且可以更穩定，期望透過此種方式能夠找出未來較佳之買賣點時機，形成
一決策支援系統，協助投資者於股票買賣點的判斷。整個系統流程圖如圖 3所示。 
 
圖 3. 方法流程圖 
 6
)(
thresholdMaxd 
 
圖 4 PLR 之流程圖 
3.2 . 倒傳遞類神經網路 
本研究主要是透過倒傳遞類神經網路的樣本訓練及測試，找出未來股價漲跌趨勢的非線性變化，
並藉由倒傳遞網路之輸出值，判斷買賣點時機，以計算投資報酬率，形成一交易決策系統。本研究所
使用的倒傳遞類神經網路共有三層：輸入層、隱藏層、輸出層。而其演算的分為三個階段，分別是資
料輸入階段、網路學習階段及回想預測階段。 
以下將針對倒傳遞類神經網路中各個演算步驟作一詳細說明： 
 資料輸入階段 
倒傳遞網路的輸入資料分為輸入動量及目標輸出動量，以下分別將說明之: 
1. 輸入動量 
首先，本研究將篩選出的個股計算其各個技術指標，接著利用逐步迴歸分析選出與此支個股
走勢最為相關的技術指標作為輸入動量的輸入變數，( nxxx ,...,, 21 )，因為影響每支股票走勢的因素
皆不相同，故本研究的輸入因子會隨著不同的個股而作調整。由於輸入變數間之值域相差甚大，
可能導致某些值域較小的輸入變數失去作用，使得網路在訓練權重時產生之誤差變大，故對於每
個輸入變數必須加以正規化處理，將變數的最小值、最大值映射到期望的最小值、最大值，本研
究所採取的正規化公式如下： 
newX   n
old
xxx
X
,......,,max 21
       (4-3) 
其中， newX ：經過正規化之參數資料值， oldX ：原始參數資料值，值域介於-1~1之間。由於
股價的技術指標存有負值，正負值代表的是各技術指標與轉折點之間的相關性，故我們採取絕對
值最大值，再以各別的技術指標除以最大值，目的是希望能保有原始資料的敏感度。 
2. 目標輸出動量 
本研究的目標輸出動量是以PLR法判斷出來的買賣點。首先，將原始資料進行PLR切割，記錄
各個切割斷點後，則計算每個切割斷點之股價趨勢。公式說明如下： 
 8
為 0.5 在買點之前 it 皆為大於 0.5，在買點之前離買賣點最遠的點設定為將其設定為 1，中間的點
就由 1等距降為 0.5，相反地，在賣點之前離買賣點最遠的點，將其設定為 0其他的點也是等距
升為 0.5，買點之前的值皆大於 0.5，在賣點之前的值皆小於 0.5，買賣點為中間值 0.5，因此系
統可以精確的判斷出買點和賣點。 
目標輸出動量經由 PLR 轉換之後，我們希望不單只有 0與 1的訊號，而是會隨著買賣點時機
的波動給予其權重值，表示各點股價間與買賣轉折點重要程度的差異，使得 BPN 的訓練值亦會隨
著 it 值程度上的差異，增加其敏感度，期許能讓預測效果更加準確，如表 2所示。 
表 2 it 值轉換說明(以 Google 為例) 
時間序列 股價 目標輸出動量 it 值 
1 176.29 1 0.5 
2 171.43 1 0.7 
3 169.98 1 0.9 
4 173.43 1 0.9 
5 171.65 1 0.7 
6 170.45 0 0.5 
7 178.69 0 0 
8 179.78 1 0.5 
 回想預測階段 
將利用網路學習階段訓練出最佳的權重，以計算測試樣本之輸出值，演算步驟如上相同，故在此
不在多作說明。在回想預測階段，主要是利用 BPN 之輸出值判定買賣點；本研究的輸出值介於 0~1 之
間，判定買賣點的分界線為輸出值之平均值。故本研究決定買賣時機的判斷方式：以平均值為界線，
當輸出值下降低於平均值時，判定為買點；當輸出值上升高於平均值時，判定為賣點。由於每支個股
的輸出值範圍皆不相同，因此，平均值也會依照個股而改變。以下將舉一簡例說明如何判定買賣點。
假設平均值為 0.224467，判斷出來的買賣點如表 3所示： 
  表 3. 買賣點判斷案例說明(以 Google 為例) 
時間序列 股價 BPN 輸出值 買賣點
1 469 0.239794  
2 465.78 0.24739 買 
3 473.23 0.179203  
4 471.12 0.212211 賣 
5 467.27 0.240874  
6 466.81 0.23217 買 
7 469.25 0.206416 賣 
8 461.47 0.256623 買 
3.3  Adaboost 
 Adaboost 是一個啟發式的機器學習演算法，近年來常常被用於結合各種不同的學習演算法。
Adaboost 利用一次又一次的更新權重來降低錯誤率、提高整體效能。Adaboost 原先為分類的概念，在
我們挑了一個比較好的演算法後（≧50％），他利用每次更新權重的方式降低錯誤率，初始時每一個演
算法的權重是相同的，在每一次的分類中，我們要使得分成對的機率提昇，降低錯誤的機率，利用更
以 0.224467 為
界線輸出值下
降低於0.224467
時,判定為買點. 
輸出值上升高
於 0.224467 時, 
判定為賣點. 
 10
表意義為 PLR 線段切的較細，所以會有比較多的買賣訊號，門檻值越大則相反，買賣訊號越少，本實
驗為望大型目標，且希望系統越穩定越好，最終目的是希望股票之利潤越大越好，標準差越小越好。
因為每次經過類神經網路跑出來的結果都不一樣，故實驗進行二十次取平均值還有其標準差，並取三
支股票，友達（2409）、晶圓電子（2448）、GOOGLE 分別逐一進行測試並且進行紀錄，根據所得之結果，
threshold 等於 4或 6時有最大之獲利率，且標準差最小，我們將用此參數進行最後之測試。 
5.5 實驗結果評估 
為了能夠更明確得知預測結果效益，本研究將以預測出的買賣點進行實際的投資獲利計算。臺灣股市
與美國股市投資金額皆以 100,000 元為單位，此外，股市交易期間則為 2006 年 7 月 12 日至 2006 年 12
月 29 日，每一次買賣皆是將全面金額投入交易。以下將針對我們挑出的股票作實驗結果評估。 
1. GOOGLE： 
類神經網路訓練期間為 2000 年 1 月 3 日到 2003 年 12 月 31 日，共 1003 筆資料，測試期間為 2006 年
7 月 12 日到 2006 年 12 月 29 日，共 120 筆資料。實驗結果整理於下。將本研究建構預測系統之實驗
結果與林俊宇[11]之預測結果互相比較。在比較指標方面，本研究採取相同的測試樣本期間之報酬率
作為衡量模型間優劣之標準值。整理結果如下表所示： 
表 4. GOOGLE 實驗結果比較 
研究者 模型建構方式 賺取金額 報酬率 標準差 
林俊宇 PLR+DTW 25226 25.23% 14378.52 
本研究 PLR+ENSEMBLE 39738 39.74% 2416.733 
 
圖 6.GOOGLE 類神經網路之買賣點預測結果 
2. S&P500： 
類神經網路訓練期間為 2000 年 1 月 3 日到 2003 年 12 月 31 日，共 1003 筆資料，測試期間為 2006
年 7 月 12 日到 2006 年 12 月 29 日，共 120 筆資料。實驗結果整理於下： 
表 5. S＆P500 實驗結果比較 
研究者 模型建構方式 賺取金額 報酬率 標準差 
林俊宇 PLR+DTW -3550 -3.55% 2986.5 
本研究 PLR+ENSEMBLE -5053 -5.05% 1457.971 
 12
 
圖 9.友達類神經網路之買賣點預測結果 
針對上述個股實驗結果作進一步分析探討，評估預測模型的優劣，主要以投資報酬率和標準差作
為評估準則，將各股的實驗結果整理如下： 
表 8.投資報酬率結果綜合比較 
  模型建構方式  
  PLR PLR+DTW PLR+ENSEMBLE 
GOOGLE -0.29% 25.23% 39.74% 
S&P500 -6.41% -3.55% -5.05% 
聯電 -9.25% 5.30% 3.87% 
友達 -19.70% -16.36% 45.70% 
從上表中，本研究所提出之 PLR + Ensemble 可獲得較高之投資報酬率，其系統穩定度亦為最高，
主要是因為使用了叢集式方法，應用叢集式方法可以使系統穩定的抓到真正的買賣點，買賣次數大為
減少，使得整體系統之投資報酬率增加，且穩定度也是大為提昇。 
從實驗中，我們發現，各股之 threshold（δ）值應該要因應各股的股價波動幅度來調整，股價
波動幅度大則 threshold 增加可得到較高之投資報酬率，若股價波動幅度小 threshold 小可得到較高
之投資報酬率，在實驗過程中發現一些值得探討的部份，以下將提出來逐一分析探討： 
 技術指標是否影響到買賣點預測 
在測試幾支個股過程中發現到，不同切割門檻值( )所切割出來的不同漲跌趨勢不僅對日後逐
步迴歸指標之篩選有相當大的影響，也對日後倒傳遞類神經網路訓練與測試資料的判斷佔有相當
重要的一部份。逐步迴歸篩選出的技術指標，作為類神經的輸入，所以輸出和輸入的因子有很強
的關聯性，而多個技術指標所預測出來的結果大多會比單一的指標要來的優秀且預測出來的獲利
率的彈性會比單一指標要來的有變化。 
 買賣點判定方式 
在類神經網路的輸出值中，如何去尋找一個判斷買賣點的依據，顯得格外地重要。實驗的過
程中，本研究使用的買賣點判定方式是以設定值為中間值：計算輸出值之最大值、最小值，對此
兩者取平均值，作為區分界限，當輸出值下降低於本門檻值時，判定為買點；當輸出值上升高於
本門檻值時，判定為賣點。本研究在個股中買賣點的判定中，皆是以 BPN 輸出值之中間值作為區
分界限。 
 Ensemble 能夠減少買賣次數及高買低賣之錯誤判斷 
在實驗過程中，我們發現，Ensemble 讓買賣點次數大為減少，且可以準確的根據 PLR 切出的
線段判斷最好的買賣時機，將 threshold 提昇就可以減少賺取小差額之情形發生。 
綜合上述各項實驗結果，本研究所建構之預測模型比傳統的技術指標方法能更加準確的預測出股
價走勢之最佳買賣點，也減少買賣點誤判及頻繁之問題，以此交易系統來協助投資人為一個明確的投
 14
7. Abraham, A., Nath ,B., and Mahanti , P. K., “Hybrid Intelligent Systems for Stock Market Analysis”, 
Proceedings of the International Conference on Computational Science-Part II, pp.337-345, 2001. 
8. Liu, Y and Xin, Yao and Tetsuya Higuchi , “Evolutionary ensembles with negative correlation learning. ” 
IEEE Transaction on Evolutionary , Vol. 4,Num. 4,November 2000 
9. Michael P. P. and Leon N. C., “When network s disagree:ensemble methods for hybrid neural network.” 
Mammone RJ Neural Networks for speech and image processing. Chapman-Hall , London 
10. Wu, H., Salzberg ,B. and Zhang , D., “Online Event-driven Subsequence Matching over Financial Data 
Streams,” SIGMOD, 2004. 
11. 林俊宇，「建構動態時間校正與線段切割法於股價買賣點之預測」，元智大學資訊管理研究所，2008
年碩士論文 
98年度專題研究計畫研究成果彙整表 
計畫主持人：張百棧 計畫編號：98-2221-E-155-014- 
計畫名稱：智慧型計算於知識萃取之整合研究--子計畫四:智慧型計算應用於財務資料之知識萃取預測
(I) 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 3 3 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
 
