合非線性呼吸阻力模式，則整個系統方程式的求解，已非
Laplace transform 或 Euler-Lagrange Equation 等傳統工
具可以解決。因無法獲得壓力、氣流與肺體積等呼吸瞬時訊
號波形的完整解之下，使最佳化過程中所使用性能指標也難
以進一步求解。在此困難下，本研究則利用了 Runge-Kutta
之方法，求得各呼吸訊號之數值解，並以 Matlab 進行最佳化
求解。 
在吸入二氧化碳與運動狀態下，研究中以無負載(NL)與連續
性阻抗負載(CRL) 來模擬「最佳機化呼吸控制模式」與「非
線性呼吸阻力模式」相結合後的系統控制行為，除檢視了呼
吸瞬時訊號波形與各種通氣響應外，並與先前在線性化呼吸
機械特下的結果相比對，以期讓「最佳機化呼吸控制系統」 
更具有呼吸治療的臨床應用價值。 
中文關鍵詞： 呼吸控制、肌神經訊號、呼吸機械特性、非線性呼吸阻力、
模式化與模擬。 
英 文 摘 要 ： In recent years, the researcher has engaged with NSC 
projects of extended applications of the ＇Optimal 
Chemical-Mechanical Respiratory Control Model＇. 
Based on the model, it is possible to minimize a 
combined controller cost consisting of the total 
chemical challenges and mechanical cost of breathing.
In previous research results, the neural-muscular 
driving signal represents an actuating signal that 
drives the respiratory muscle into a mechanical 
behavior of ventilation. The description of the 
neuro-mechanical, meanwhile, is based on a lumped-
parameter model proposed by Younes and Riddle. The 
respiratory mechanics, including the flow-resistive 
and volume-elastic components of the respiratory 
system, is linearly approximated as the effective 
impedance values of the respiratory muscles. The 
approximation is clearly insufficient to describe the 
nonlinear relationship of the viscous and elastic 
properties of the tracheobronchial airways and the 
behavior of the alveolar space and chest wall. 
In current project, it is aimed to model the 
nonlinear respiratory mechanics, including the airway 
resistance lung compliance of distinctive segments, 
and to study the effects on the optimization of the 
neuro-muscular drive. The optimization of the neuro-
muscular drive and analysis of the system behavior 
行政院國家科學委員會補助專題研究計畫  
R成果報告    ﹍  期中進度報告  
 
非線性呼吸機械特性模式對肌神經驅動訊號最佳化的影響  
 
計畫類別「R 個別型計畫  ﹍ 整合型計畫 
計畫編號「 NSC 100-2221-E-035 -007 
執行期間「 100年 8月 1日 至 101年 7月 31日 
 
計畫主持人「 林賢龍 
共同主持人「 
計畫參與人員「  
 
 
成果報告類型(依經費核定清單規定繳交)「﹍ 精簡報告  R 完整報告 
 
本成果報告包括以下應繳交之附件「 
﹍赴國外出差或研習心得報告一份 
﹍赴大陸地區出差或研習心得報告一份 
R出席國際學術會議心得報告及發表之論文各一份 
﹍國際合作研究計畫國外研究報告書一份 
 
 
處理方式「除產學合作研究計畫︾提升產業技術及人才培育研究計畫︾列
管計畫及下列情形者外︽得立即公開查詢 
          ﹍涉及專利或其他智慧財產權︽﹍一年﹍二年後可公開查詢 
          
執行單位「逢甲大學 
 
中   華   民   國  101 年  11  月   1  日 
 2 
Abstract 
Considerable effort have been expended by many research groups during the past century to 
imitate the function of human respiratory system, which has been known to be one of the most 
important regulatory systems in the human body. In recent years, the researcher has engaged with 
NSC projects of extended applications of the “Optimal Chemical-Mechanical Respiratory Control 
Model”. Based on the model, it is possible to minimize a combined controller cost consisting of the 
total chemical challenges and mechanical cost of breathing. Under the support of former NSC 
grants, we have successfully implemented the “Optimal Respiratory Control Simulator” based on 
Matlab and LabVIEW platforms. An experimental mechanical ventilation apparatus was also 
realized with the optimal airflow based on the open loop and close-loop control with minimum 
WOB feedback. 
In previous research results, the neural-muscular driving signal represents an actuating signal 
that drives the respiratory muscle into a mechanical behavior of ventilation. The description of the 
neuro-mechanical, meanwhile, is based on a lumped-parameter model proposed by Younes and 
Riddle. The respiratory mechanics, including the flow-resistive and volume-elastic components of 
the respiratory system, is linearly approximated as the effective impedance values of the respiratory 
muscles. The approximation is clearly insufficient to describe the nonlinear relationship of the 
viscous and elastic properties of the tracheobronchial airways and the behavior of the alveolar space 
and chest wall. 
In current project, it is aimed to model the nonlinear respiratory mechanics, including the 
airway resistance lung compliance of distinctive segments, and to study the effects on the 
optimization of the neuro-muscular drive. In the original proposal, it was planned as a two-year 
project. Unfortunately, since the proposal was granted as a one-year project, we may only fulfill the 
modeling and simulation of the nonlinear resistance model by Hirayama in the optimal respiratory 
control model. The optimization of the neuro-muscular drive and analysis of the system behavior 
will be performed on the optimized respiratory signals, breathing pattern, ventilatory responses, and 
the loop functions. 
The work of current project is valuable to fine-tune the system behavior and unleash the 
limitation of the model on the expiratory activity and extensive muscular exercise. The shortening 
of the gap between current model and experimental respiratory physiology is expected with 
increased possibility for future clinical application in respiratory therapy. The nonlinear breathing 
mechanism by Barbini and nonlinear normal lung model by Liu were left behind. To take advantage 
of the inclusion of nonlinear respiratory mechanics, the performance index of optimization 
involving other nonlinear terms, such as the pressure-time integral that approximates the oxygen 
cost of breathing during isometric contraction, and the square magnitude of volume acceleration to 
minimize possible muscle destruction from abrupt contraction, will also be studied in the future. 
 
Keyword: respiratory control, neuro-muscular drive, respiratory mechanics, nonlinear airway 
resistance, neuro-muscular drive, modeling and simulation. 
 
 4 
監測軟體︾訊號示波器︾與人體呼吸控制模擬器等︽對人工肺進行通氣實驗〈目前已完成一
般醫院中常用之三種吸氣氣流型態正弦波︾方波︾漸減波等三種呼吸器送氣波形與通氣設定
之最佳化︽並進一步利用實驗室中自行架設完成之�呼吸器最佳送氣波形通氣實驗硬體設備
架構︽陸續完成 Eucapnia 與 Hypercapnia 呼吸環境下與呼吸機械特性改變下︽透過通氣波形
(壓力︾流速形態︾肺體積) 與迴圈函數之分析[38,40]︽嚐試將呼吸器之最佳通氣設定與呼吸
治療之臨床觀察結︽作完整之比較分析〈 
二︾研究目的  
呼吸時肌肉本身並無先天的收縮節律︽若無運動神經衝動是不會收縮的︽已知呼吸時的
瞬時氣流波形係由呼吸中樞傳來的肌神經脈衝訊號來控制︽在之前的呼吸控制系統模式裡︽
為了最佳化研究中機化控制系統的通氣量與氣流︽所設計的�神經—機械反應器︽主要作為
聯繫肌神經訊號和機械通氣氣流之間的關聯〈而這個神經–機械反應器可藉由圖所示的簡化型
�呼吸系統 RC電路來表示[53,69,84,85]︽其中呼吸道阻抗(Rrs) 與肺的順應性(Crs=1/Ers) ︽
採用了靜態的線性特性︽並以 Agostoni1964 和 Mead1964 所發表的正常平均值為參數(Rrs=3.02 
cm-H2Ol-1s, Ers=21.9 cm-H2Ol-1)︽來簡化最佳化過程的非線性性能指標(performance index, 
J)〈雖然上述線性化的呼吸機械特性︽也廣為許多研究學者引用︽作為呼吸控制與模式化的
模型特性參數︽但卻忽略下列幾項呼吸機械的特性「 
�一呼吸道不均質(heterogeneous)系統的複雜性︽氣道包括了上呼吸道︾氣管︾小支氣
管︽而影響氣道阻力的因素包括氣道長度︾氣道半徑︾及氣體流速〈 
�二呼氣或吸氣時阻織位移︽導致肺和胸組織對氣體的摩擦阻力︽而克服此阻力所須之
力與運動之速度有關〈 
�三肺間壓力改變造成肺部容積變化的動態肺順應特性〈 
雖然呼吸控制模式中忽略上述的非線性呼吸機械特性，可以讓模式化與最佳化的過程更
為精簡，但從先前的研究結果來，所模擬的呼吸波形與通氣響應，在呼吸機械特性改變下（阻
力增加或肺順應性增加），仍有部份呼吸臨床實驗無法正確因應。本研究之主旨，即在考量上
述非線性呼吸機械特性的效應，把非線性呼吸機械特性進行模式化，進而取代「最佳機化呼
吸控制系統」中的神經–機械反應
器的簡化 RC電路模型，以進行一
系列運動狀態、吸入二氧化碳下、
呼吸機械特性改變等呼吸控制模
擬，並與呼吸生理臨床實驗文獻相
比對，期待獲得更精確的系統控制
行為與呼吸通氣響應模擬。	 
雖然呼吸控制模式中忽略上述的非線性呼吸機械特性︽可以讓模式化與最佳化的過程更
為精簡︽但從先前的研究結果來︽所模擬的呼吸波形與通氣響應︽在呼吸機械特性改變下�阻
力增加或肺順應性增加︽仍有部份呼吸臨床實驗無法正確因應〈本計畫之主旨︽即在考量上
述非線性呼吸機械特性的效應︽把非線性呼吸機械特性進行模式化︽進而取代�最佳機化呼
吸控制系統中的神經–機械反應器的簡化 RC電路模型︽以進行一系列運動狀態︾吸入二氧
 6 
心臟病︾肺泡/肺血管纖維化或硬化︾肺氣腫︾肺炎︾胸廓疾患等︾與呼吸道阻力
變化�如氣喘︾肺氣腫︾腫瘤或氣道阻塞等梗阻性疾病︽其呼吸機械特性的變化
已不是單純改變呼吸道阻力/肺順應性之正常平均參數所能模擬︽而運用非線性呼
吸機械特性取代呼吸控制中簡化 RC電路模式︽將可把現今呼吸控制模擬更精準地
提升到呼吸性疾病的模擬層次〈 
三︾文獻探討  
3.1 呼吸控制模式  
我們所使用的�最佳機化呼吸控
制模型︽最早是由Gray1950所發展出的
呼吸控制化學模型〈在該模型中︽超越了傳統以 PaCO2為唯一考量的呼吸模式︽嚐試去模擬出
當接受外來 CO2, O2, [H+]刺激時的通氣反應〈Otis1950,1956[53]則提供了呼吸機械制動的模型依據︽
並以一簡化 RC 電路模式︽來進一步描述了壓力︾ 氣流︾肺體積等︽與呼吸道阻力和肺彈性
等之間的數學模式〈Poon1983,1987[60~63] 提出了呼吸控制以呼吸耗能最小化的重要假設︽並提
供了運動狀態(eucapnia)與吸入二氧化碳(hypercapnia)下︽通氣響應的最佳化理論基礎〈但
Poon&Lin1992[69] 則成功結合了上述的機械模式與化學模式︽提出一個肌神經驅動訊號的數
學模型︽並透過呼吸機械耗能與化學耗能最小化︽在化學刺激與機械特性改變下︽進一步產
生最佳化的呼吸訊號波形與通氣範型〈 
Hamalainen1978[27]曾以呼吸氣流波形的最佳化作為呼吸控制的準則︽以 Otis1950[53]和
Mead1964[48]曾使用的正弦波氣流波形︽利用呼吸時氧氣耗能與減小呼吸肌傷害作為最佳化準
則︽預測不同呼吸道阻力下的氣流與壓力變化︽但同樣的︽該研究並未考量非線性呼吸機械
特性的影響︽而系統也無法模擬不同化學刺激準位下的通氣響應〈 
Hirayama1995[28] 雖然在其提出的呼吸控制的最佳化模型中︽首度引進非線性呼吸機械特
性︽在最佳化性能指標的準則中︽也包含動態的壓力︾肺體積︾氣流︾與氣流變化速率等因
子︽並使用 Euler-Lagrange Equation 來描述最佳化求解的數學模形︽但其呼吸氣流波形仍是
正弦波氣流︽且只考慮了機械耗能的影響︽無法模擬化學刺激下的呼吸行為〈 
Tehrani1998[77]也使用了最佳化的觀念來進行呼吸控制模化︽但不同於我們運用肌神經驅
動訊號最佳化的方法︽以一方波來近似肌神經驅動壓力訊號︽並提出一階層式的最佳化呼吸
控制「第一階段藉由最佳化呼吸耗能求得最佳化的呼吸頻率︽ 假設人體的阻抗(K ʹ′ʹ′ )與順應性
(K ʹ′ )為固定常數︽並使用 Otis1950所提出的人體呼吸機械特性模型〈最佳化的性能指標為呼吸
機械耗能方程式︽用以求取最佳化呼吸頻率(f*)「 
W= pdv '! = K'V' dv '0
VT! + K" dv 'dt
"
#$
%
&'0
T2! dt  
f != - "K  VD + "K  VD
2 +32 "K  ""K  VD !VA
16 ""K  VD
 
該模擬所得的結果與 Silverman1951所作的通氣實驗相對照︽在低強度與中度運動下︽皆
能得到相當程度的符合〈Tehrani1998[77]第二階段則是引用 Johnson1995[32]預測運動狀態下肺
 8 
抗較大〈Barbini2003[4,6]提到呼氣流速會受到機械通氣的影響︽
因此建立一非線性的氣道模型了解︽在模型中將氣道分為三
段︽並假設肺泡及胸壁為線性變化︽發現氣道最下段的阻力增
加︽並不會增加吐氣氣流限制︽但是中段氣道的阻力增加卻會
造成氣道塌陷︽使系統改變︽而 F-V loop所表現出的非線性阻
抗與呼吸系統的變化更接近︽此研究中的氣道模型對本計畫所
建立的方向有很大幫助〈 
在 Liu1998 研究中︽建立一非線性模型︽模型主要由呼吸機
械特性︾肺循環以及氣體交換為基礎︽且利用四名受測者與模型
比較︽發現與病患的數據相近︽但是肺血流量的變化率還需進一
步的驗證〈LIU1998所提到的模型中說明氣道開放時︽假設氣管和
肺是包含在胸腔內︽在胸腔內的空間認為是同時間變化︽空間中
受到胸腔壓力( )(Ppl t )的驅動︽這假設為胸腔壓力作用於肺和肌
肉並產生呼吸〈肺泡區域被假設為一非線性且時變︽且具有黏滯
性特性︽壓力與容積(P-V)關係描述出靜態的彈性特性的關係〈
用力呼吸後肺部的收縮程度依賴Ppl︽因此︽兩者成線性關係〈
肺組織的阻抗(  tiL,R )設定為恆定的狀態〈氣道末端一小段氣道以
電阻( SR )表示︽而這與肺泡容積( AV )成反比〈在吐氣末時︽氣
道關閉使肺泡的容量降低〈肺泡和塌陷區域分別定義為 AP 和 CP ︽描述的是邊界氣道壁上平衡
和壓力︽利用 D' Alembert原理〈設定 refP 壓力的溫度是在 37℃︽Pel為肺彈性反彈︽Ptm為
塌陷氣道的壓力〈 
ref
A
 tiL,A PPpld
dV
RPelP ++⎟
⎠
⎞
⎜
⎝
⎛
+=
t
 
refC PPplPtmP ++=  
其中彈回的壓力Pel被分為吐氣階段(PelE)和吸氣階段(PelI)︽還有胸腔內壓力變化(ne)〈 
IE Pel)ne0.5(ne)Pel(0.5Pel −++=  吐氣時 
IE Pel)ne0.5(ne)Pel(0.5Pel ++−=  吸氣時 
氣道塌陷區域( CV )隨 P-V關係改變︽其中 CmaxV 是一項參數〈saptm和 sbptm是連續性的常數〈 
2
Cmax
C 7.0
V
V
sbptm-saptmPtm ⎟⎟
⎠
⎞
⎜⎜
⎝
⎛
−=
 
 10 
態下吸入不同程度 CO2之呼吸行為︽並與之模型做一比較〈POON1983,1987[60,61,63]作了一個重
要的假設︽即是人體是以對自己最有利的方式來呼吸︽並提出修正先前文獻之最佳機械≒化
學控制模型︽係假設人類呼吸是採用最低耗能的方式進行著︽其中呼吸耗能(J)包含兩個部分︽
一為化學部分耗能(JC)︽另一為機械部分耗能(JM)〈而機械耗能又依吸/吐氣期分為 IW 與 EW 兩
部分〈將會利用 Poon1992[69]的研究所提到的吸入周期變化(IRL)︾呼出周期變化(ERL)︾連續
性的肺彈性係數變化(CEL)和連續性的阻抗變化(CRL)來了解參數的結果〈 
P(t) = a0 + a1t + a2t2     0 ! t ! t1
P(t) = P(t1) "e
#
t#t1
!         t1 ! t ! t1 +t2
 
Milhorn1965 [50]的研究中導出 CO2與 O2在穩態和暫態的的關係︽並利用電腦模擬與實驗
的結果比較︽使呼吸系統的調節作一個更有效的運作〈Baconnier1995[3]等提出一量測呼吸機械
特性的運算理論︽包括呼吸道阻抗︾肺順應性︾吐氣末陽壓及呼吸時間常數︽另利用電腦程
式化︽這個方向與做法對於本計劃有很大的助益〈Olender1976模擬最大呼氣 F-V 曲線會受到
大呼吸道阻抗︾小呼吸道阻抗及肺順應性的影響︽[3]所使用到的模型更為簡化︽但實驗的結
果比較正確︽模型中所使用的參數︽在計畫中是重要的參考〈 
Diong2007 提到肺功能的測試要與試驗對象有相當的合作程度︽但是卻不適合小孩與老
人︽但可以使用適當的呼吸系統模型來模擬︽因此評估五種電路模型︽分別是 RIC Model︾
Viscoelastic Model︾DuBois Model︾Mead Model和 Extended RIC Model︽並利用總平均誤差
分析各模型的優缺點 〈 
Verbraak1991[81] 也曾提出一個肺臟模型︽具有一個壓縮的段落︽主要是用來模擬在呼吸
道及肺泡產生病變(如「asthma, emphysema, fibrosis and upper airway obstruction)時的呼吸行
為〈這個模型也可以作為正常的呼吸行為︽且有關肺順應性的描述︽與目前廣被接受的呼吸
生理較學吻合〈系統的參數估測與穩定性測試︽主要是利用一個正弦氣流當作輸入訊號〈然
而這和我們研究中的�最佳機化呼吸控制模式中︽利用最佳化的肌神經驅動訊號來推算出
最佳氣流波形︽較不符合〈 
3.3 肌神經驅動訊號  
  無意識中換氣行為的產生︽是橫隔膜接受來自位於延腦的節律中樞的神經訊號所刺
激︽進行收縮與舒張︽來造成肺容積的變化︽進而造成呼吸氣流的產生〈由於我們難以量測
呼吸神經中樞所輸出的神經訊號︽因此產生肌神經驅動訊號的假設︽等同於神經中樞對肺部
通氣的控制命令︽而驅動訊號的假設︽可為壓力︾氣流︽或是容積訊號〈 
關於肌神經驅動訊號的模式化︽Younes1981 [86,87]的理論模型中︽是以時變與非線性動態
氣流方程式︽並對化學機械呼吸模型中的神經機械反應器提供一個好的說明〈
Poon&Lin1992[69]以呼吸系統的 P(t)取代了 Younes1981的模型所提的神經活動︽肌神經驅動訊
號波形分為吸氣與吐氣波形兩部份︽這吸氣的壓力是一個隨時間上升的函數並且由二次多項
式函數�Quadratic Function來近似︽而這也是本研究主要採用的模型〈這裡 a0與 a1是常數
並且表現初值時間的驅動壓力與開始時上升的吸氣相位︽a2 也是常數並用來描述驅動壓力波
形〈尤其︽當 a2=0時︽其波形是線性的︽當 a2>0時︽其波形以內凹(concave)形態上升的︽當
a2<0時︽其波形以外凸(convex)形態上升〈吐氣時︽一般相信肌肉提供了一些溫和與休息時吐
 12 
Gallagher1987[20] 的實驗研究中︽分別提供了漸進式適度運動[13]︾極度運動狀態[20]︾高血
碳酸運動狀態[20] 等不同呼吸生理化學刺激下的連續性的彈性負載實驗︽並觀察其對呼吸範
型[13,20] 與呼吸頻率所造成的影響〈D'Urzo1985[13] 的彈性負載係透過一個設計的 80-公升金
屬風鼓來提供︽裡面則充滿了聚苯乙烯芯片(polystyrene chips) 以確保內含之氣體為等溫︽並
利用了自行車�Bodyguard cycle ergometer來提供漸進性的週期運動〈 
 VT TI TE TI/T F 
! 
˙ V E A A0.5 Ref.  l sec sec %T bpm l/min cmH2O %A 
Control 0.66±0.05 1.69±0.12 2.75±0.27 0.38* 14.1±1.3 8.97±0.44 12.28±0.99  
[64] IRA 0.67±0.04 1.48±0.07 2.77±0.26 0.35* 14.6±1.3 9.57±0.42 10.98±0.93  
%change 1.52* -12.43* 0.73* -8.51* 3.55* 6.69* -10.59*  
Control 0.78±0.21 1.7±0.6 3.0±1.1 0.36* 14.5±4.0 10.2±1.8   
[11] L6 CRL 0.82±0.25 2.0±0.7 3.0±1.2 0.40* 13.8±3.7 10.2±2.3   
%change 5.13* 17.65* 0.00* 10.59* -4.83* 0.00*   
Control 0.71±0.19 2.06±1.02 3.35±1.34 0.38* 12.24±3.04 8.10±1.05 12.17±5.31 63.0±12.4 
[30] IRL 0.77±0.18 2.93±0.97 3.55±1.37 0.45* 10.15±2.98 7.31±0.96 15.00±3.12 80.4±14.0 
%change 8.45* 42.23* 5.97* 18.75* -17.08* -9.75* 23.25* 27.62* 
Control 0.597±0.09 1.78±0.60 3.26±0.66 0.35* 12.40±2.6 7.26±0.87 11.20±2.0 49.5±6.4 
[65] ERL      6.77±0.87   
%change 12.8±8.2 12.2±6.9 25.0±10.1  -14.0 -6.75±2.88 16.60±10.2  
Control 0.79±0.14    15.00±1.3 11.70±1.6   
[13] CEL 0.70±0.17    17.70±1.6 12.30±1.9   
%change -11.39*    18.00* 5.13*   
上表摘錄了上述重要的呼吸道阻抗性負載下之呼吸與肺彈性係數負載下之呼吸的相關呼
吸生理實驗的呼吸範型結果[11,13,30,64,65]︽ 未來本計畫執行時︽將可作為系統模擬結果之
分析比對的實驗數據〈此外︽在先將 Lin2011[39] 以簡化 RC電路模式作為線性呼吸機械特性的
相關系統模擬︽有關呼吸機械特性改變時的呼吸範型響應數據︽則另整理於下表中︽作為未
來本計畫引入各項非線性呼吸機械特性模式到�最佳機化呼吸控制模式時︽不同模式之神
經–機械反應器的系統效能比對依據〈 
 VT TI TE TI/T F 
! 
˙ V E A A0.5 
 l sec sec %T bpm l/min cmH2O %A 
Control 0.60 0.035 0.043 0.46 12.76 7.60 14.38 54.74 
IRL 0.66 0.046 0.047 0.51 10.78 7.12 15.91 68.73 
%change 10.95 30.79 8.14 11.43 -15.54 -6.30 10.65 25.56 
ERL 0.70 0.046 0.058 0.45 9.671 6.81 16.72 58.14 
%change 18.16 29.66 33.95 -2.13 -24.23 -10.47 16.27 6.20 
CEL 0.58 0.043 0.032 0.58 13.47 7.77 19.67 51.02 
%change -3.19 20.62 -26.74 26.12 5.60 2.23 36.79 -6.80 
四、研究方法	 
本研究原訂為一個兩年期的研究計畫︽但很遺憾的︽國科會僅通過第一年的期程︽因而
整個研究重心必須因應期程的縮短而作變更︽因為各項工作彼此互相影響︽也進因使研究成
果與效率變差〈計畫原訂之研究流程如下圖所示︽其中灰色部分為呼吸控制系統模式化︾模
擬︾與系統分析鑑別的研究主體︽不論在第一︾第二年的計畫中都須共同經歷〈整個流程包
括「 
一︾最佳機化呼吸控制模式之建構 
二︾神經機械反應器 
 14 
�二回授路徑化學品受體(The Feedback 
Paths-Chemoreceptors)：延腦吸氣神經元可以
接受許多傳入訊息︽其中最重要是來自中樞和
週邊化學接受器的訊息〈從圖一可以發現︽最
佳機化控制系統中的回授回路包含中樞(IC)和
週邊(IP)化學接受器〈這兩個平行的通道裡︽
二個化學感測器分別傳送著動脈中氣體分壓
訊號到呼吸中樞︽亦即控制器〈 
�三神經機械反應器(The Neuro-Mechanical 
Effector)「呼吸時肌肉本身並無先天的收縮節
律︽若無運動神經衝動是不會收縮的︽已知呼
吸時的瞬時氣流波形係由呼吸中樞傳來的肌
神經脈衝訊號來控制︽在之前的呼吸控制系統模式裡︽為了最佳化研究中機化控
制系統的通氣量與氣流︽設計一個�神經機械反應器來聯繫肌神經訊號和機
械通氣氣流之間的關聯〈  
�四控制器最佳化控制器(Optimal Controller)「系統所設計最佳機化控制器︽假設人
體的呼吸控制係以最佳化的方式來進行︽其中包含一個量化的呼吸耗能�機械耗
能與化學耗能最小化過程︽以求解最佳之通氣設定參數與呼吸範型〈呼吸耗能(J)
包含兩個部分︽一為化學部分耗能(JC)︽另一為機械部分耗能(JM)〈而機械耗能又
依吸/吐氣期分為 IW 與 !WE兩部分〈 
4.2神經機械反應器與非線性呼吸阻力 
在先前的呼吸控制系統模式裡︽為了最佳化研究中機化控制系統的通氣量與氣流︽所設
計的�神經機械反應器︽主要作為聯繫肌神經訊號和機械通氣氣流之間的關聯〈而這個神
經機械反應器是藉由右圖所示的簡化型�呼吸系統 RC電路來表示[53,69]︽P(t) 即為肌神
經驅動訊號︾Rrs�阻抗與 Crs�電容值︽=1/Ers分別代表線性模式下的呼吸道平均阻力與
肺順應性︽採用了靜態的線性特性(Rrs=3.02 cm-H2Ol-1s, Ers=21.9 
cm-H2Ol-1)[1,48]〈流經 RC電路的電流
! 
˙ V (t)也代表進出肺臟的氣體
流速︽電容充電電荷量 V(t)則可表為通氣中肺臟的體積︽整個 RC
電路的關係可以表示為「 
! 
P(t) = ˙ V (t) "Rrs+ V(t) "Ers          (1) 
本研究之主旨︽即在考量非線性呼吸阻力的效應︽把非線性呼吸阻力進行模式化︽進而
取代�最佳機化呼吸控制系統中的神經機械反應器的簡化
RC 電路模型︽ 進行模式化與模擬︽最後並在系統分析時進行
比較與驗證〈首先將以定性之方式︽暫不考量非線性的動態肺
順應特性對呼吸控制模式的影響〈正如 HIRAYAMA1995在最小化
非線性呼吸系統的研究一樣〈在該系統中︽仍以最簡單的 RC串
連電路作為呼吸機械制動的模式〈P 為呼吸系統的驅動壓力︾
! 
˙ V (t)為氣體流速︾V(t)為通氣中肺臟的體積﹔K 代表了呼吸系統
PaCO2 = PICO2 +
863! !VCO2
!VE (1" VDVT )
VD = 0.037 !VC(1+ VT8 )
IO = IC + IP = #! (PaCO2 "$)
P(t) = !V(t) !Rrs+V(t) !Ers
P(t) =
a0 + a1t + a2t2 0 % t % t1
P(t1) !e
"
t"t1
& t1 % t % t1 +t2
'
(
)
*
)
'
(
)
)
*
)
)
J = JC + JM
     JC = #2 ! (PaCO2 "$)2
     JM = ln !W
'
(
))
*
)
)
_
+
R1 R2
KP(t)
V'(t)
 16 
V(t) = P(t1)Rrs ! ( 1"rs - 1" )
e#
t-t1
" # e
#
t-t1
"rs
$
%
&&
'
(
))+V(t1) !e
#
t-t1
"rs                              (6)
 
!V(t) = P(t1)Rrs ! ( 1"rs - 1" )
1
"rs
e
#
t-t1
"rs # 1" e
#
t-t1
"
$
%
&&
'
(
))#
V(t1)
" rs
!e
#
t-t1
"rs                            (7)
 
A1 = a2
A2 = a1 ! 2a2"rs
A3 = a0 ! a1"rs + 2a2"rs2
"rs = Rrs #Crs
$
%
&
&
'
&
&
                            (8)
 
但在本研究中︽須將式(3) 代入式(2) 非線性呼吸阻力的電路方程式中︽由於式(2) 涉及
了氣流的平方項次︽因此模式化的研究過程中︽已無法運用傳統 Laplace transform 的轉換運
算來取得氣流( )與肺體積瞬時訊號(V(t))的完整解。在 HIRAYAMA1995的研究中︽他們已預先
假設氣流波形吸氣期為一正弦波氣流模式︽再以正弦波的模型參數作為最佳化的控制變數︽
運用 Euler-Lagrange equation︽依序推導出吸氣期最佳化氣流︾肺體積與壓力訊號波形︽而整
個研究也局限在吸氣期︽無法求得整個呼吸周期的完整訊號波形〈由於在呼吸臨床而言︽在
休息狀態︾吸入二氧化碳︾運動狀態︾高血碳酸運動狀態︾吸氧/吐氣期呼吸阻力負載︾肺彈
性負載︾甚至在外加死腔負載等各種呼吸狀態下︽所觀察到的氣流波形模式有著近似矩形波︾
漸減波︾或正弦波等不同的變化︽因此在 HIRAYAMA1995 的正弦波氣流模式與吸氣期的限制︽
顯然不足以因應呼吸控制與通氣響應的完整需求〈 
但由於將式(3) 代入式(2) 後︽因微分方程式階次提高︽使得系統方程式之複雜度與格度
增加︽本研究也無法運用 Laplace TRANSFORM或 Euler-Lagrange equation 來進行求解︽因此嘗
試了 Fourth-order Runge-Kutta 來取得氣流( )與肺體積瞬時訊號(V(t))的數值近似解。 
                                                 (9) 
                               (10) 
                            (11) 
                               (11.a) 
                           (11.b) 
                           (11.c) 
                           (11.d) 
藉由式(10) 與式(11) 的近式求解︽當提供了最佳求的初使值 a0︾a1︾a2︾t1︾t2 與τ之
後︽即可取得初始之氣流( )與肺體積瞬時訊號(V(t))數值近似解︽並進入最佳化性能指標︽
進行呼吸耗能最小化之數值運算〈〈 
4.5 呼吸耗能最小化之性能指標  
在 HIRAYAMA1995的研究中︽其使用的最佳化性能指標如下式所示 
 18 
4. Continuous Elastic Loading (CEL): 連續性的彈性負載模擬中︽吸氣期與吐氣期都
是給予ΔErs=10 cm-H2O⋅l-1的負載〈  
但在本研究中︽非線性呼吸阻力模式包含了 R1(呼吸系統中氣流流過的總黏滯阻力)︾
R2(與功率成正比的氣流通過的阻力)︾與K�呼吸系統的總順應性︽在 HIRAYAMA1995的模擬
研究中，分別使用了 R1=12 cm-H2O⋅l-1⋅s︾R2=3 cm-H2O⋅l-1⋅s與 Ers=10 cm-H2O⋅l-1〈為了與先前
研究得結果相比對︽我們調整了休息無負載狀態的非線性呼吸阻力模式 R1=3.02 
cm-H2O⋅l-1⋅s︾R2=1.5 cm-H2O⋅l-1⋅s與 Ers=16 cm-H2O⋅l-1〈 
   
1.A          1.B 
圖 1「A「Instantaneous driving pressure (P(t), top), airflow rate ( !V(t) , middle), and lung volume (V(t), 
bottom) over a complete breathing cycle at various levels of exercise CO2 output (left) and inhaled 
CO2 (right) with the linear respiratory mechanic model. 
圖 1.B「Instantaneous driving pressure (P(t), top), airflow rate ( !V(t) , middle), and lung volume (V(t), 
bottom) under various levels of mechanical loads at rest. Rrs = 3.02 cm-H2O⋅l-1⋅s and Ers = 21.9 
cm-H2O/l for NL, Rrs = 8 cm-H2O⋅l-1⋅s and Ers = 31.9 cm-H2O/l for loaded breathing. Left column: 
comparisons of inspiratory resistive load with no load. Middle column: comparisons of expiratory 
resistive load with no load. Right column: comparisons of continuous elastic load with no load. 
在系統分析與驗證部分︽將透過包含肌神經驅動訊號(P(t))、氣流( )︾與肺體積 (V(t))
三種呼吸瞬時訊號之分析︽並與相關之臨床呼吸生理實驗文獻所提供的數據相互檢視︽以進
行呼吸控制系統及非線性機械特性模式的驗證〈圖 1.A 顯示了先前所研究的線性呼吸機械特
性下，在運動狀態與吸入二氧化碳下，三種呼吸瞬時訊號的最佳化波形；而圖 1.B 則是三種
呼吸瞬時訊號在休息狀態︽分別利用 IRL︾CRL︾CEL 的機械特性負載下︽最佳化波形的相對
變化〈在圖 2則列出本研究的非線性呼吸阻力模式，在運動狀態（左）與吸入二氧化碳（下），
三種呼吸瞬時訊號的最佳化波形〈 
在前述不同化學刺激狀態或不同之呼吸機械負載下︽將呼吸範型兩相比對︽將可提供許
多不同通氣響應之分析〈幾種具呼吸生理臨床實驗價值之通氣響應︽如在不同準位化學刺激
下之 !VE︽分別與 f︾VT︾t1/T、PaCO2、 !VCO2之通氣響應分析〈如圖 3所示為分別模擬吸入二氧
化碳¡)與運動狀態(r)下︽每分鐘總通氣量� !VE分別對動脈血二氧化碳分壓�PaCO2︾
 20 
六︾結論  
本研究成功地把 Hirayama1995 非線性呼吸阻力模式，和假設人體以最小耗能情況下進行
呼吸控制之「最佳機化呼吸控制模式」相結合，因所形成的	 壓力、氣流與肺體積等呼吸瞬時
訊號波形具二次式的微分方程式，模式化研究過程克服了 Laplace transform或 Euler-Lagrange 
Equation等傳統工具無決求解的困境，我們利用 Runge-Kutta之方法，求得各呼吸訊號之數值
解，並以Matlab進行最佳化求解。	 
本研究之主旨嚐試考量 1)	 呼吸道不均質(heterogeneous)系統的複雜性、2)	 呼氣或吸氣時
阻織位移，導致肺和胸組織對氣體的摩擦阻力、及 3)	 肺間壓力改變造成肺部容積變化的動態
肺順應特性等非線性呼吸機械特性，利用非線性呼吸阻力模式，去解決先前採用靜態線性	 「呼
吸系統 RC 電路」在呼吸控制模擬中的遭遇困境。我們利用呼吸控制系統中的「神經–機械
反應器」，與具備吸氣相為	 二次多項式的上升函數、吐氣相為被動性的指數遞降函數的「肌
神經驅動訊號」作為最佳化的控制變數，以產生具備任意波形的最佳瞬時氣流，來彌補
Hirayama1995研究中固定的正弦波氣流波形模式且僅針對吸氣期進行控制模擬的不足。	 
透過	 PICO2=0%~7%及 =0.2~1.0 分別模擬吸入二氧化碳(CO2 inhalation)與運動狀態
(muscular exercise)。在呼吸機械特性改變方面，在原先針對線性呼吸機械特性的研究中，相
對於休息無負載(NL, no load) 下，並將給予機械負載 CRL、IRL、ERL、CEL 等不同型態之呼
吸道阻抗負載與肺彈性負載。模擬結果並透過包含肌神經驅動訊號(P(t))、氣流( )、與肺
體積(V(t)) 等三種呼吸瞬時訊號之分析，及包含每分鐘總通氣量（ !VE）分別對動脈血二氧化
碳分壓（PaCO2）、呼吸頻率（f）、潮氣容積（VT）、及吸氣工作周期（t1/T）等之通氣響應分析，
再與呼吸臨床生理實驗數據、Hirayama1995非線性呼吸阻力模式研究成果、及「最佳機化呼吸
控制模式」之靜態線性呼吸機械特性研究成果等進行比較分析，以期對人體最佳呼吸控制模
式的系統行為，進行更完整的模擬、驗證與修正。	 
本研究原訂為一個兩年期的研究計畫︽但很遺憾的︽國科會僅通過第一年的期程︽因而
整個研究重心必須因應期程的縮短而作變更︽因為各項工作彼此互相影響︽也進因使研究成
果與效率變差〈但因應一年期程之限制，研究流程已作修改，在非線性呼吸機械特性的模式
化部分︽僅能針對 Hirayama1995 的非線性呼吸阻力進行模式化研究︽並直接跨躍至原訂第二
年之範圍︽對非線性呼吸阻力與佳機化呼吸控制模式結合後︽對最佳化肌神經驅動訊號的影
響進行探討〈至於 Barbini2003的非線性呼吸機械特性與 Liu1998的正常肺臟非線性模型︽只能
留待後續再進行〈 
參考文獻  
[1] Agostoni1964, E., and J. Mead, “Statics of the respiratory system,” in: Handbook of Physiology, 
Respiration, Sec. 3, Vol. I, Chap. 13, pp. 387-409, 1964. 
[2] Aljuri1999, N., L. Freitag, and J.G. Venegas, “Modeling expiratory flow from exercised tracheal tube 
laws”. J. Appl. Physiol. 87(5): 1973-1980, 1999. 
[3] Baconnier1995, P.F., P.Y. Carry, A. Eberhard, J.P. Perdrix, and J.M. Fargnoli, “A computer program 
for automatic measurement of respiratory mechanic in artificially ventilated patient,” Computer 
Methods and Programs in Biomed., 47: 205~220, 1995. 
 22 
[24] Gray1956, S., F. S. Groadins, and E. T. Carter, “Alveolar and total ventilation and the dead space 
problem,” J. Appl. Physiol., 9: 307-320,1956. 
[25] Groadins1950, F. S., “Analysis of factors concerned in regulation of breathing in exercise,” Physiol. 
Rev., 30: 220-239, 1950. 
[26] Guyenet2010, P. G., R. L. Stornetta, S. B. G. Abbott, S. D. Depuy, M. G. Fortuna, and R. Kanbar, 
“Central CO2 chemoreception and integrated neural mechanisms of cardiovascular and respiratory 
control,” J. Appl. Physiol., 108: 995-1002, 2010. 
[27] Hamalainen1978, R. P., and A. A. Viljanen, “Modelling the Respiratory Airflow Pattern by 
Optimization Criteria,” Biological Cybernetics, 29: 143-179, 1978. 
[28] Hirayama1995, H., Y. Shimizu, and Y. Fukuyama, “Optimal control of nonlinear respiratory system 
with performance function involving non linear terms,” Proc. 34th SICE Annu. Conf., 1229-1234, 
1995. 
[29] Hudgel1984, D. W., R. J. Martin, B. Johnson, and P. Hill, “Mechanics of the respiratory system and 
breathing pattern during sleep in normal humans,” J. Appl. Physiol., 56: 133-137, 1984. 
[30] Im Hof1986, V. H., P. West, and M. Younes, “Steady-state response of normal subjects to inspiratory 
resistive load,” J. Appl. Physiol., 60: 1471-1481, 1986. 
[31] Jacobi1987, S., V. I. Iyawe, C. P. Patil, R. C. Cummin, and K. B. Saunders, “Ventilatory responses to 
inhaled carbon dioxide at rest and during exercise in man,” Clin. Sci., 74: 177-182, 1987. 
[32] Jonson1993, B., L. Beydon, K. Brauer, C. Mansson, S. Valind, and H. Grytzell, “Mechanics of 
respiratory system in healthy anesthetized humans with emphasis on viscoelastic properties,” J. 
Appl. Physiol., 75: 132-140, 1993. 
[33] Jubran1997, A., B. J. B. Grant and M. J. Tobin, “Effect of hyperoxichy-hpercapnia on variational 
activity of breathing,” Am. J. Respir. Crit. Care Med., 156: 1129-1139, 1997. 
[34] Khoo1982, M. C., R. E. Kronauer, K. P. Strohl and A. S. Slutsky, “Factors inducing periodic 
breathing in humans: a general model,” J. Appl. Physiol., 53: 644-659,1982. 
[35] Khoo1982, M. C., R. E. Kronauer, K. P. Strohl and A. S. Slutsky, “Factors inducing periodic 
breathing in humans: a general model,” J. Appl. Physiol., 53: 644-659,1982. 
[36] Landa1996, P.S., and M.G. Rozenblyum, “Model of a system of control of respiration,” Biophysics, 
41(2): 491-498, 1996. 
[37] Lanteri1993, C. J., and P. D. Sly, “Changes in respiratory mechanics with age,” J. Appl. Physiol., 74: 
369-378, 1993. 
[38] Lin2011, S. L., H. W. Shia, and C. C. Chen, “Simulations and Experiments of Optimal Sinusoidal 
Airflow under CMV,” Journal of Chang Gung Institute of Technology, Accepted, 2010. 
[39] Lin2011, S. L., N. R. Guo, and C. C. Chiu, “Modelling and Simulation of Respiratory Control with 
LabVIEW,” Journal of Medical and Biological Engineering, Accepted, 2010. 
[40] Lin2010, S. L., Y. C. Tsai, H. W. Shia, and N. C. Chang, “Optimizations of the Airflow Waveforms 
and Comparative Studies of Ventilation Settings under Respiratory Mechanical Loadings,” 中華民
國九十九年度生物醫學工程科技研討會︽99年12月10~11日︽義守大學︽高雄︽臺灣〈 
[41] Liu1998, C. H., S. C. Niranjan, J. W. Clark, K. Y. San, J.B. Zwischenberger, and A. Bidani, “Airway 
mechanics, gas exchange, and blood flow in a nonlinear model of the normal human lung,” J. Appl. 
Physiol., 84: 1447-1469, 1998. 
[42] Long1962, E. C., W. E. Hull, and E. L. Gebel, “Respiratory dynamic resistance,” J. Appl. Physiol., 17: 
609-612, 1962. 
[43] Lorino1993, A. M., and A. Harf, “Techniques for measuring respiratory mechanics: an analytic 
approach with a viscoelastic model,” J. Appl. Physiol., 74: 2373-2379, 1993. 
 24 
[66] Poon1989, C.S., “Effects of inspiratory resistive load on respiratory control in hypercapnia and 
exercise,” J. Appl. Physiol., pp. 2391~2399, 1989.  
[67] Poon1989, C.S., “Effects of inspiratory elastic load on respiratory control in hypercapnia and 
exercise,” J. Appl. Physiol., pp. 2400~2406, 1989. 
[68] Poon1992, C. S., “Potentiation of exercise ventilatory response by airway CO2 and dead space 
loading,” J. Appl. Physiol., 73: 591-595, 1992. 
[69] Poon1992, C. S., S. L. Lin, and O. B. Knudson, “Optimization character of inspiratory neural drive,” 
J. Appl. Physiol., 59: 2005-2017, 1992. 
[70] Poon1995, C. S., “Respiratory Models and Control,” in The Biomedical Engineering Handbook, J. D. 
Bronzine (Ed), Boca Raton: CRC Press, pp. 2404-2421, 1995. 
[71] Puddy1991, A., and M. Younes, “Effect of slowly increasing elastic load on breathing in conscious 
humans,” J. Appl. Physiol., 70: 1277-1283, 1991. 
[72] Rafferty1996, G. F., and W. N. Gardner, “Control of the respiratory cycle in conscious humans,” J. 
Appl. Physiol., 81: 1744-1753, 1996. 
[73] Rybak1995, A., M. Pottmann, B. A. Ogunnaike, and J. S. Schwaber, “A closed-loop model of the 
respiratory control system,” Proc. Am. Control Conf., 275-279, 1995.  
[74] Suki1991, B., and J. H. Bates, “A nonlinear viscoelastic model of lung tissue mechanics,” J. Appl. 
Physiol., 71: 826-833, 1991. 
[75] Suki1993, B., “Nonlinear phenomena in respiratory mechanical measurements,” J. Appl. Physiol., 74: 
2574-2584, 1993. 
[76] Tehrani1993, F. T., “Mathematical analysis and computer simulation of the respiratory system in the 
newborn infant,” IEEE Trans. Biomed. Eng., 40: 475-481, 1993. 
[77] Tehrani1998, F. T., “Optimal control of respiration in exercise,” Proc. 20th Annu. Int. Conf. of the 
IEEE Eng. in Med. and Biol. Soc., 20: 3211-3214, 1998. 
[78] Teppema2010, J., and A. Dahan, “The ventilatory response to hypoxia in mammals: mechanisms, 
measurement, and analysis,” Physiol. Rev., 90: 675-754, 2010. 
[79] Thompson2000, W. H., P. Carvalho, J. P. Souza, and N. B. Charan, “Effect of expiratory resistive 
loading on the noninvasive tension-time index in COPD,” J. Appl. Physiol., 89: 2007-2014, 2000. 
[80] Tomlinson1994, S. P., D. G. Tilley, and C. R. Burrows. “Computer simulation of the human 
breathing process,” IEEE Eng. Med. Biol. Mag. 13: 115–124, 1994. 
[81] Verbraak1991, A. F. M., J. M. Bogaard, J. Beneken, E. Hoorn, and A. Versprille, “Serial lung model 
for simulation and parameter estimation in body plethysmography,” Med. Biol. Eng. Comput., 29: 
309~317, 1991 
[82] Yamashiro1971, S. M., and F. S. Grodins, “Optimal regulation of respiratory airflow,” J. Appl. 
Physiol., 30: 597-602, 1971. 
[83] Yamashiro1993, S.M., “Uniqueness of Optimal Controllers During Exercise,” Annals of Biomedical 
Engineering, pp. 531~535, 1993. 
[84] Younes1981, M., and W. Riddle, “A model for the relation between respiratory neural and 
mechanical outputs, I. Theory,” J. Appl. Physiol., 51: 963-977, 1981. 
[85] Younes1981, M., and W. Riddle, “A model for the relation between respiratory neural and 
mechanical outputs, II. Methods,” J. Appl. Physiol., 51: 979-989, 1981. 
[86] Younes1984, M., and G. Kivinen, “Respiratory mechanics and breathing pattern during and 
following maximal exercise,” J. Appl. Physiol., 57: 1773-1782, 1984. 
 2 
5月12日「 
Session A: Agriculture, Biological, and Food Technology 
Session B: Engineering Technology 
5月13日「 
Session A: Fault Analysis and Process Systems 
Session B: Modelling and Identification 
筆者 同本系的洪三山(系主任)︾張興政兩位教授︽及兩位電通博士班的學生︽共同出席本次
會議︽總共發表了四篇論文︽並都安排於5月13日上午8:30~12:20 Session B的場次中發表〈 
在5月11~13日共三天的會議議程中，首日在大會主席香港工業科技研究中心Dr.	 Mark	 Fong的
歡迎演說後，即連續安排了三場	 Keynote	 Speeches，分別是： 
• Keynote Speeches 1:  
• Speaker: Prof. Jennifer Ann Harikrishna, University of Malaya 
• Keynote Speeches 2:  
• Speaker: Cheng-Hsien Liu, National Tsing Hua University, Taiwan 
• Keynote Speeches 3:  
• Speaker: Prof. Wilhelm Holzapfel, Handong Global University, South Korea 
大陸近年來︽在各領域的學術研究發展迅速與蓬勃︽並結合了各主要的旅遊與文化古城如「
北京︾上海︾武漢︾濟南︾西安︾南京︾成都︾洛陽等城市︽積極地舉或承辦國際大型研討會︾
Congress︾展示會︾論壇等︽也連帶地使得其國內的教授︾學者︾研究生等︽就近參與國際性研討
會的機會大增︽刺激了與國際間的學術交流︽相關學術聲譽與實力之累積︽實已不可同日而語〈
去年筆者也曾在四月時來廣州︽參加國際計算機︾電機︾系統科學與工程研討會(CESSE2011) ︽是
時正逢其全國教育會議期間︽飯店等住宿空間相當熱門搶手︽住宿費用也㕖漲到約台幣5,000~10,000
元/晚〈但一年之後再度造訪︽相同等級飯店的住宿︽竟僅需約去年1/3費用︽實在難以想像〈 
攜回資料名稱及內容 
• Conference Program of the AFBE 2012 
其他「論文簡報內容 
 4 
 
 
Simulation of Ventilatory Responses to 
Dead Space and CO2 Inhalation with 
Optimal Respiratory Control Model  
Shyan-Lung Lin 1,∗, Nai-Ren Guo 2, San Shan Hung1  
1 Department of Automatic Control Engineering, Feng Chia University, Taichung 407, Taiwan 
2 Department of Electrical Engineering, Tung Fang Design University, Kaohsiung 829, Taiwan 
Many experiments have been performed and differences have been observed in the ventilatory response to 
breathing with an imposed external dead space and inhalation of a fixed level of CO2 in human subjects. One of 
the human respiratory control models which successfully demonstrate the ventilatory responses to chemical 
stimuli as well as muscular exercise was proposed earlier with optimality hypothesis. In this study, to verify the 
model behavior of the optimal chemical-mechanical respiratory control model, the ventilatory control under dead 
space loading and CO2 inhalation were simulated. A LabVIEW® based human respiratory control simulator and 
signal monitoring system based on the environment was implemented for simulation. The dead space volume 
was described with two distinct models, from Gary and Coon, and the effects on the ventilatory responses were 
investigated and compared with experimental findings. 
	  
	  
	  
	  	  	  	  	  	  	  	  	  	  	  	  	  	  	  	  	  	  	  	  	  	  	  	  	  	  	  	  	  	  	  	  	  	  	  	  	  	  	  	   	  	  	  	  	  	  	  	  	  	  	  	  	  	  	  	  	  	  	  	   	  
∗	  Author	  to	  whom	  correspondence	  
1. INTRODUCTION 
The problem concerning the nature and the function of the dead 
space is of basic importance for the full comprehension of the 
respiratory physiology and pathophysiology.1 Bohr originated the 
dead space concept by using a mass balance approach to 
calculate dead space from measurements of tidal volume and 
mixed and expired alveolar gas compositions with knowledge of 
the composition of inspired air. Dead space values were important 
in the past, because alveolar ventilation was calculated from total 
ventilation using an assumed or empirical value for dead space.2 
Fowler determined dead space volume using Bohr’s formula, 
together with measurements of total expired volume from a tidal 
breath of pure oxygen that completely filled the dead space, and 
the volume mixed with alveolar gas downstream of the dead 
space. 
Extended studies on the concept of dead space have been 
made in the last half-century since Fowler’s work.2 Pappenheimer 
et al.3 proposed a new technique utilizing constant alveolar gas 
tensions for measuring VD, PACO2 and PAO2, and provided a 
graphical solution of the Bohr formula. Although Pappenheimer’s 
appeared to be better than that of Coon et al., 4 Wolff and Garratt5 
used the latter because of its independence of metabolic rate, 
however, Coon’s method assumes VD as constant. Folkow and 
Pappenheimer6 noted that a relation of the form: VD = mVT + c, 
where c is an intercept, would give a linear FEx vs. 1/VT for O2 and 
CO2. Gray7 presented an analysis of the respiratory dead space 
problem with careful distinctions between measured anatomical 
dead space and calculated physiological (virtual) dead space.  
Several studies have examined the effects of added dead space 
on ventilatory response under CO2 breathing. Forster et al.8 used 
six tracheostomized ponies to determine the effect of reducing 
anatomical dead space on arterial CO2 pressure during CO2 
inhalation and concluded the !VE -PaCO2, f-PaCO2, and VT-PaCO2 
relationships did not differ between normal and decreased dead 
Logarithm
Coupler
Optimal
Controller
Work Rate
Index
Neuro-Mexhanical
Effector
Gas
Exchanger
Quadratic
Coupler Chemoreceptors
!
 
Figure 1. The mathematical modeling of the optimal 
chemical-mechanical respiratory control 
 
3. THE OPTIMAL RESPIRATORY CONTROL 
MODEL AND THE SIMULATOR 
In earlier works, a simulation strategy based upon a mathematical 
modeling (Fig. 1) of the optimal respiratory control21 was 
implemented. In Fig. 1, we demonstrate the coupling of chemical 
cost JC and mechanical cost JM, which is represented by the 
quadratic coupler of chemical feedback signal and the logarithm 
coupler of work rate, respectively. The fundamental hypothesis of 
the model is that a total cost function can be formulated to reflect 
the balance of a combined challenge due to the chemical and 
mechanical cost of breathing19. The respiratory control is modeled 
as a closed-loop feedback system comprising four major functional 
blocks: the plant, the feedback path, the controller, and the 
effector. 
3.1. Gas Exchanger: 
The plant describes the events of the pulmonary exchange subject 
to the control signal !VE  and disturbances in the inhaled and 
metabolic CO2 and O2 (PICO2/ PIO2, Torr, !VCO2 / !VO2 , l/min), and lactic 
acidosis. The system's outputs are the pressures of arterial CO2 
and O2 (PaCO2/PaO2, Torr), and [H
+]a (arterial H-ion concentration, 
mole/l). However, because the conditions of normoxia and normal 
acid base condition will be assumed in this paper, only the effects 
on PaCO2 will be considered. The gas exchanger equation 
describes the dependence of the arterial blood gas tension on the 
total ventilation and other disturbances is given as: 
 PaCO2 = PICO2 +
863! !VCO2
!VE (1" VDVT )
                    (12) 
where PaCO2 is assumed to be identical to mean alveolar PCO2.  
3.2. Chemoreceptors: 
The feedback loop of the control model consists of two 
chemosensory structures, known as the central and peripheral 
chemoreceptors. The total chemical stimulation level of the 
controller (IO, impulses/sec), the sum of the central (IC, 
impulses/sec) and peripheral chemoreceptor stimulus (IP, 
impulses/sec), are assumed to be a linear function of PaCO2: 
IO = IC + IP = !" (PaCO2 #$)                    (13) 
where α is the sensitivity of the chemoreceptors; β is the threshold 
of the chemoreceptor (impulses/sec) and is set empirically.  
3.3. Neuro-Mechanical Effector: 
To optimize the ventilatory airflow of the chemical-mechanical 
model, a neuro-mechanical effector, which relates the neural 
respiratory output to resultant mechanical airflow, is required to 
optimize the neural input to the respiratory muscles. Such effector 
can be described by the electrical RC model based on a model 
proposed by Younes and Riddle for the relation between 
respiratory neural and mechanical outputs. In this model, the 
equation of motion is given by the following dynamic equation 
 P(t) = !V(t) !Rrs +V(t) !Ers                       (14) 
The parameters Rrs (cm-H2O⋅l-1⋅sec) and Ers (=1/Crs, cm-H2O/l) 
represent the total flow-resistive and volume-elastic components, 
respectively. These include the passive resistance and elastance 
of the lung, chest wall, and airways. The isometric pressure 
waveshape (P(t), cm-H2O) is modeled into an inspiratory and 
expiratory phase. The inspiratory pressure is approximated by a 
quadratic function and the expiratory pressure is represented by 
an exponential discharge function. 
3.4. Optimal Controller: 
Rather than a reflex response to the chemical stimulus, the 
fundamental hypothesis of the optimal controller is that a total cost 
function (J) can be formulated to reflect the balance of a combined 
challenge due to chemical (JC) and mechanical (JM) cost of 
breathing.21 
J = JC + JM
      JC = !2 " (PaCO2 #$)2
      JM = ln !W
                      (15) 
The optimal control output is determined by the minimum of J, 
which consists of the square law for chemical feedback and 
logarithmic law for mechanical feedback, conforming to Steven's 
law and Weber-Fechner law of sensory reception, respectively. On 
the other hand, the respiratory work rate !W  is assumed to be an 
explicit function of the respiratory neural drive and can be 
parameterized by the mechanical constraints of the respiratory 
system although this takes a quantitative description of the 
mechanical effector system. 
3.5. Work Rate Index: 
In current study, the mechanical work rate of inspiration and 
expiration are evaluated to predict the inspiratory waveshape and 
ventilatory responses to various types of system inputs. 
!W = !WI +! " !WE
      !WI = P(t)#
!V (t)
$1
n " $2
no
Ti%  dt /T
            $1 =1&P(t) / Pmax
$2 =1& !P(t) / !Pmax
'
(
)
*)
      !WE = P(t) " !V(t)Ti
T
%  dt /T
               (16) 
In Eq. (16), the total mechanical index is assumed to be a 
weighted sum of the inspiratory and expiratory indexes with a 
weighting parameter λ, and !W, !WI, and !WE represent the total 
respiratory, inspiratory, and expiratory work rate (kg⋅m/sec), 
respectively. The efficiency factors ξ1 and ξ2 account for the effects 
of respiratory-mechanical limitation and the decrease in 
neuromechanical efficiency with increasing effort. The overall 
efficiency is dependent on the maximum isometric pressure (Pmax) 
and the maximum rate of rise of the isometric pressure ( !Pmax ). 
3.6. The Simulator: 
The simulation process is implemented on the LabVIEW platform 
by calling the optimization subprograms from the IMSL 
subroutine23. The human-machine interface of the simulator is 
constructed with a multilayer structure from main panel for modular 
design and expandable advantage. The main panel of the human 
respiratory control, as shown in Fig. 2, included eight modules as 
follows: 1) Input-Parameters: 2) Controller-Optimization; 3) 
 Fig. 4. The effects of dead space loading on breathing frequency under 
CO2 inhalation for Model 1 (left) and Model 2 (right) 
 
 
Fig. 5. The effects of dead space loading on tidal volume under CO2 
inhalation for Model 1 (left) and Model 2 (right) 
 
 
Fig. 6. The total ventilation (left) and alveolar ventilation (right) vs. 
PaCO2 under CO2 inhalation with different EDS loadings for Model 1 
 
 
Fig. 7. Relationship between tidal volume and dead space, the latter 
includes both external dead space loading (EDS, solid) and total dead 
space (VD-total, open), under CO2 inhalation 
 
Figure 8. Total ventilation vs. tidal volume during CO2 inhalation (open) 
and EDS loading (solid) 
 
5. CONCLUSION 
A unified prediction of exercise and chemical responses was 
shown entirely in terms of conventional feedback-mechanisms 
based on the optimal chemical-mechanical respiratory control 
model, instead of using a separate stimulus signal. Our model 
uses a human respiratory control model to simulate ventilatory 
responses to CO2 inhalation. To examine the effects of external 
dead space loadings on resultant ventilatory responses, two dead 
space models, by Gray (model 1) and Coon (model 2), were 
applied to simulations of different applied levels of EDS. Although 
both dead space models appeared to have satisfactory predictions 
on !VE -PaCO2, 
!VA -PaCO2, F-PICO2, and VT-PICO2 relationships, model 
1 provided better correlation and more consistent results by 
comparisons with experimental findings. Simulations were also 
performed to study the EDS-VT, VD-total-VT, and !VE -VT relationships. 
The simulation results showed favorable agreement with 
experimental data for ventilatory responses during CO2 inhalation 
and dead space loading. 
Current study attained valuable results from simulations of 
imposed dead space on respiratory control using the optimal 
respiratory control model. This work could be extended to simulate 
the ventilatory response of eucapnic and hypercapnic exercise, 
and to simulate the effects of respiratory mechanical (resistive or 
elastic) loading and EDS loading for more extensive model 
verification. 
 
References 
1. R. A. Klocke, J Appl Physiol. 100(1), 1 (2006) 
2. W. S. Fowler, Am. J Physiol. 154, 405 (1948) 
3. J. R. Pappenheimer, A.P. Fishman, L.M. Borrero, J Appl. 
Physiol. 4(11), 855 (1952) 
4. R. L. Coon, J. P. Kampine, J Appl. Physiol. 51(1), 154 (1981) 
5. C. B. Wolff, R. C. Garratt, J Appl. Physiol. 53(1), 297 (1982) 
6. B. Folkow, J. R. Pappenheimer, J Appl. Physiol. 8(1), 102 
(1955) 
7. J. S. Gray, F. S. Groadins, E. T. Carter, J Appl. Physiol. 9(3), 
307 (1956) 
 1 
國科會補助專題研究計畫項下出席國際學術會議心得報告 
                                     日期「2012 年 4 月 20 日 
                                 
本次論文發表主題為「Simulation and Comparative Studies of Dead Space Loading for Human 
Respiratory Control under Exercise and CO2 Inhalation」，本研究以人體呼吸最佳控制模式為模擬的基
礎，並利用先前裝置於LabVIEW平台的呼吸控制模擬器為模擬工具，來模擬在外加死腔時呼吸控
制的通氣響應。在血碳酸正常和高血碳酸的呼吸環境模擬中，我們運用兩種文獻中的呼吸死腔估
測模式，來作為呼吸耗能最佳化程序下的死腔運算模式，並進
行比較分析。 
會議主辦單位IASTED (The International Association of 
Science and Technology for Development) 是個國際性的非營利
學術組織︽創立於1977年︽並以促進世界之經濟與文化為宗旨〈
該組織每年均籌劃了許多以工程︾科學︾與教育為主軸之跨領
域多重訓練的學術性與專業性之會議︽以2012年為例︽共計有
下列各項會議於世界各地舉辦「 
• February 2012 
February 15 – 17, 2012 Innsbruck, Austria  
• BioMed 2012 Biomedical Engineering 
• Telehealth 2012 Telehealth 
• AT 2012 Assistive Technologies 
• April 2012  
April 2 – 4, 2012 Phuket, Thailand 
• AsiaPES 2012 Power and Energy Systems 
• AsiaMIC 2012 Modelling, Identification and 
Control 
• ACSE 2012 Advances in Computer Science and 
Engineering 
• May 2012 
May 14 – 16, 2012 Baltimore, USA 
• ISPHT 2012 Imaging and Signal Processing in 
Health Care and Technology 
• HCI 2012 Human-Computer Interaction 
• CIIT 2012 Communication, Internet, and 
計畫編號 NSC 100-2221-E-035 -007 
計畫名稱 非線性呼吸機械特性模式對肌神經驅動訊號最佳化的影響 
出國人員姓名 林 賢 龍 
服務機構及 
職稱 
逢甲大學自動控制工程學系 
副教授 
會議時間 
2012年 4月 2日 
至 
2012年 4月 4日 
會議地點 
泰國、普吉島 
Phuket, Thailand 
會議名稱 
2012	 第 31 屆亞洲模式化、識別、與控制會議	 
The 31st IASTED Asian Conference on Modelling, Identification and Control ~AsiaMIC 
2012~ 
發表論文題目 
Simulation and Comparative Studies of Dead Space Loading for Human Respiratory 
Control under Exercise and CO2 Inhalation 
 3 
Session 6: Recent Advances in MIN and their Applications 
在4月2~3日共三天的會議議程中，在大會主席的歡迎演說後，除了論文發表場次，另有安排
兩場	 Keynote	 Speeches	 和兩場教學課程tutorials，分別是： 
• Keynote Speeches 1: The Roles of Metaheuristics on Control Design Optimization and Identification 
Research (啟發性演算法在控制系統設計最佳化和識別研究中的角色) 
• Speaker: Dr. Sarawut Sujitjorn 
• Summary: 而由於萬用啟發式演算法(Metaheuristics)是一
種新興的最佳演算法,其概念通常是經由觀察自然界所獲
得的靈感，例如GA演算法是	 源自於生物演化、蟻群演
算法習自蟻群的覓食行為，粒子群最佳化演算法則是效
法鳥類的覓食。這些演算法非常具有彈性，可求解許多
不同問題且做法簡單，求解效率高，因此已經成為數量
方法中最重要的方法之ㄧ。本主題演講內容，包含萬用
啟發式演算法的定義、對演算法的效能和收斂特性的需
求、多目標控制設計最佳化的問題、模型識別的問題、
通用型和特定的運算法則等。 
• Keynote Speeches 2: Phasor Measurements as Smart Device for 
Observing Power System Dynamics 
• Speaker: Prof. Yasunori Mitani 
• Summary: Phasor Measurement Unit (PMU) is an apparatus 
which detects the absolute value of phase angle in sinusoidal signal. Here, suppose that more than two 
measurement units for instantaneous voltage with short sampling time are located distantly apart from 
each other. Then, we can get multiple measured voltage data but they cannot be compared exactly 
along with time since we do not know the reference of time. However, once they are used with GPS 
signal which tells us the information on exact time, it becomes ready to get phase differences among 
them. Thus, PMU with GPS receiver is applied to the monitoring of AC power system dynamics and 
usually installed at substations of transmission lines. 
• Tutorial 1: Biologically-Inspired Communication and Networking 
• Speaker: Prof. Mohamed Hamdi 
• Summary: Bio-inspired networking and communication protocols and algorithms are devised by 
considering biology as source of inspiration, and by adapting behaviors, laws, and dynamics 
governing biological systems. While the literature related to biologically-inspired computing is 
abundant, the focusing on the application of biological concepts in networking is still in infancy. In 
this tutorial, we address the applicability of biological mechanisms and techniques in various 
communication fields. Particularly, we explore the mechanisms and the challenges in embedded 
communication systems with primary focus on recent applications of bio-inspired techniques in 
communication networks. Nonetheless, the results that have been reached so far show that this area is 
very promising. 
• Tutorial 2: Latest Applications in Computer Networks: from IPTV to Mobile Multimedia 
Networks 
 5 
 
 
寄件人: <Review@iasted.org>
標題: AsiaMIC 2012 - Notification of Acceptance - Final Paper is due on February 15
日期: 2012年1月19日 上午12時34分07秒格林威治標準時間+08:00
收件人: <sllin@fcu.edu.tw>
January 18, 2012
Shyan-Lung Lin
Feng Chia University
100 Wen-Hwa Rd., Seatween
Taichung
Taiwan
Re:  769-056
 Simulation and Comparative Studies of Dead Space Loading for Human Respiratory
Control under Exercise and CO2 Inhalation
Dear Dr. Shyan-Lung Lin,
Congratulations! Your paper has been accepted for the IASTED International Conference on
Modelling, Identification and Control, which will be held Apr 02, 2012 to Apr 04, 2012, in
Phuket, Thailand. We cordially invite you to attend the conference and to present your paper. 
You must take into consideration the reviewers' comments to improve your paper before you
submit your final manuscript. The reviewer comments and paper status information are also
available to view on your "My Papers" page on the IASTED website:
http://www.iasted.org/conferences/mypapers.aspx?id=769
All registration materials and tour options will be posted on our web site. Please register and
book your flight as soon as possible. The registration information is available here:
http://www.iasted.org/conferences/registrationinfo-769.html
In order to attend, you need to submit the following by Feb 22, 2012:
1. Registration Form (mandatory) 
2. Author Information Form (mandatory)
3. Copyright Form (mandatory)
4. Audio Visual Requests (If you need any AV equipment for your presentation)
5. Hotel Reservation Form (If you need assistance reserving a hotel room)
Please be advised that only papers that have been registered, fully paid for, and presented at
the conference will be included for publication in the conference proceedings. If for any
SIMULATION AND COMPARATIVE STUDIES OF DEAD SPACE LOADING 
FOR HUMAN RESPIRATORY CONTROL UNDER EXERCISE AND CO2 
INHALATION  
 
S.L. Lin1  N.R. Guo2 
1Department of Automatic Control Engineering, Feng Chia University 
100 Wen Hwa Rd., Seatween, Taichung/Taiwan 
sllin@fcu.edu.tw 
2Department of Electrical Engineering, Far East University 
Tainan County/Taiwan 
nrguo@mail.tf.edu.tw 
 
 
ABSTRACT 
In this paper, the effect of imposed external dead space on 
ventilator responses of respiratory control is simulated. 
Comparative studies are presented with respect to two 
dead space models under eucapnia and hypercapnia. A 
human respiratory control simulator based on the optimal 
chemical-mechanical respiratory control model is 
implemented with LabVIEW environment and employed 
for current study. Simulations of respiratory control with 
and without external dead space loading are performed 
under rest, muscular exercise with CO2 output of 0.2~1.0 
(L/min), and CO2 inhalation of 2~7%. Various ventilatory 
responses, including arterial partial pressure of CO2, 
breathing frequency, tidal volume, total ventilation, 
alveolar ventilation, under different levels of dead space 
loading are derived and examined based on the optimized 
neural muscular drive, airflow, and lung volume profiles 
with minimum effort of breathing. 
KEY WORDS 
Dead space; respiratory control; exercise; CO2 inhalation; 
ventilatory response. 
 
1. Introduction 
 
The problem concerning the nature and the function of the 
dead space is of basic importance for the full 
comprehension of the respiratory physiology and 
pathophysiology. In dead space, the upper airways are 
filled with inspired gas that has undergone no gas 
exchange and the alveolar units contain gas that 
approximates pulmonary capillary blood in composition. 
Between these two sites, in the intrapulmonary airways, 
the gas composition must vary between these two 
extremes, approaching or equaling inspired composition 
in the central airways and alveolar composition in the 
peripheral airways. 
The dead space concept was originated by Bohr by 
using a mass balance approach to calculate dead space 
from measurements of tidal volume and mixed and 
expired alveolar gas compositions with knowledge of the 
composition of inspired air. Before Fowler [1] began his 
studies, values of dead space were important because at 
that time alveolar ventilation was calculated from total 
ventilation and an assumed or empirical value for dead 
space. Together with the measurement of total expired 
volume from a tidal breath of pure oxygen that completely 
filled the dead space and mixed with alveolar gas down 
stream of the dead space, he calculated the dead space 
volume with Bohr’s formula and concluded the regional 
nonuniformity of ventilation/lung volume was the most 
important factor. 
Extended studies on the concept of dead space have 
been made in the last half-century since Fowler’s work. 
Pappenheimer et al. [2] proposed a new technique that 
utilizes constant alveolar gas tensions for measuring VD, 
PACO2 and PAO2, which provides a graphic solution of the 
Bohr formula. Although it appeared a better method than 
Coon et al. [3] and Wolff and Garratt [4] have described 
latter because of its independence of metabolic rate, 
however, the method depended on constancy of VD. 
Several studies have examined the effects of added 
dead space on ventilatory response under distinct 
respiratory stimuli. Warley [5] conducted experiments by 
with added dead space of 230 ml and CO2 inhalation to 
determine the ventilatory responses between REMS 
(rapid-eye-movement sleep) and SWS (slow-wave sleep) 
of healthy men. Maruyama [6] studied ventilatory 
response during external dead space breathing and CO2 
inhalation for given increase in PETCO2 with different 
levels of PETO2 (hyperoxia, normoxia, and hypoxia) in 
human subjects. Lofaso [7] investigated the effect of 
positive or negative inspiratory pressure on respiration, 
either without or with added external dead space of 600 
ml, through either added inspiratory laminar flow 
resistances or with inspiratory pressure support. Poon [8] 
examined the effects of different modes of airway CO2 
load on the ventilation-CO2 output relationship during 
mild to moderate exercise with and without a large 
external dead space. 
	  	  	  Among those respiratory control models under 
studied during the past years, possible optimality principle 
has found to be existed in the modeling of the respiratory 
control [9~10]. An earlier research by Poon [9] suggested 
and airways. The isometric pressure waveshape (P(t), cm-
H2O) is modelled into an inspiratory and expiratory phase. 
The inspiratory pressure is approximated by a quadratic 
function and the expiratory pressure is represented by an 
exponential discharge function of the form 
P(t) = a0 + a1t + a2t2     0 ! t ! t1                     (4) 
P(t) = P(t1) !e
"
t"t1
#         t1 $ t $ t1+t2                (5) 
where the parameters a0 and a1 in Eq. (4) represent the net 
driving pressure and its rate of rise at the onset of the 
neural inspiratory phase, and the parameter a2 describes 
the shape of the wave; t1 (sec) and t2 (sec) represent the 
neural inspiratory and expiratory duration, respectively. In 
Eq. (5), P(t1) is the peak inspiratory pressure (cm-H2O) at 
the end of inspiration (t1), and τ denotes the rate of decline 
of inspiratory activity. 
 
2.4 Optimal Controller 
 
Poon and colleagues proposed and verified that an 
optimal controller might counterbalance the metabolic 
needs versus energetic needs of the body, and the 
resulting compromise would determine the ventilatory 
response. Rather than a reflex response to the chemical 
stimulus, the fundamental hypothesis of the optimal 
controller is that a total cost function (J) can be 
formulated to reflect the balance of a combined challenge 
due to chemical (JC) and mechanical (JM) cost of 
breathing. 
J = JC + JM                                                (6) 
JC = !2 " (PaCO2 #$)2                            (7) 
JM = ln !W                                          (8) 
The optimal control output is determined by the 
minimum of J, which consists of the square law for 
chemical feedback and logarithmic law for mechanical 
feedback, conforming to Steven's law and Weber-Fechner 
law of sensory reception, respectively. On the other hand, 
the respiratory work rate , is assumed to be an explicit 
function of the respiratory neural drive and can be 
parameterized by the mechanical constraints of the 
respiratory system although this takes a quantitative 
description of the mechanical effector system. 
 
2.5 Work Rate Index 
 
The optimization equation of Eqs. (6)~(8) requires an 
explicit description of respiratory power. Several 
mechanical indexes have been previously studied for 
respiratory optimization. In the implemented simulator of 
current study, the mechanical work rate of inspiration and 
expiration are evaluated to predict the inspiratory 
waveshape and ventilatory responses to various types of 
system inputs. 
!W = !WI +! " !WE                                           (9) 
!WI =
1
T
P(t)! !V(t)
"1
n # "2
no
Ti$  dt                       (10) 
!WE =
1
T P(t) !
!V(t)
Ti
T
"  dt                        (11) 
!1 =1"
P(t)
Pmax
!2 =1"
!P(t)
!Pmax
#
$
%
%
&
%
%
                            . 
In Eq. (9), the total mechanical index is assumed to 
be a weighted sum of the inspiratory and expiratory 
indexes with a weighting parameter λ, and
!W, !WI, and !WE represent the total respiratory, inspiratory, 
and expiratory work rate (kg⋅m/sec), respectively. The 
efficiency factors ξ1 and ξ2 of Eq. (10) account for the 
effects of respiratory-mechanical limitation and the 
decrease in neuromechanical efficiency with increasing 
effort. The overall efficiency is dependent on two factors: 
the maximum isometric pressure (Pmax) and the maximum 
rate of rise of the isometric pressure ( !Pmax ). The 
respiratory period of a breathing cycle (T=t1+t2, sec) 
accounts the inspiratory (t1) and expiratory (t2) duration of 
neural activity, however, the parameter TI describes the 
mechanical inspiratory duration where the airflow flows 
into lung for inspiratory work of breathing. 
 
2.6 Dead Space Modeling  
 
Two inference equations for dead space volume from 
Gray and Coon are employed for simulations and 
comparative studies. They suggested different forms of 
dead space equations. In this section, an estimate will be 
presented one can be reasonably simulated. 
When  !VA  was defined as the miniute volume of gas 
that, when in CO2 eqilibrium with arterial blood, must be 
expired to maintaon !VCO2 . The !VA  therefore equals the 
miniute volume of gas expiredfrom alveolar structures 
only when all these structures have a mean PCO2that equals 
PaCO2. When we defines !VA  in terms of !VCO2 , dead-space 
ventilation ( !VD ) is also defined 
!VE = !VA + !VD                                            (12) 
The above equation can further be derived, firstly by 
Bohr, to measure the physiological dead space. 
VD =
FACO2 !FECO2( ) "VT
FACO2
                          (13) 
where FACO2 is alveolar CO2, FECO2 is the fractional 
concerntration of CO2 from mixed expired gases. 
VD =
PaCO2 !PeCO2( ) "VT
PaCO2
                          (14) 
The Bohr equation is considered to be complicated 
since it is based upon the fact that all CO2 comes from 
alveolar gas and the exhalation of CO2 can therefore be 
used to measure gas exchange or lack of gas exchange if 
there is alveolar dead space. For each tidal volume there 
will be a proportion of dead space (anatomical) but the 
! 
˙ W 
respiratory control [13], as shown in Fig. 2,  included 
eight modules as follows: 
•  Input-Parameters 
•  Controller-Optimization 
•  Controller-Neural Network 
•  Signal Monitoring-Current Simulation Panel 
•  Signal Monitoring-Previous Saved Simulation 
•  Signal Monitoring-Comparisons 
•  Output Listings 
•  Exit 
 
 
Figure 2. The MAIN panel of the human respiratory 
control simulator 
 
Figure 3. The INPUT panel (left) and OPTIMIZATION panel 
(right) of the simulator	  
	  
Firstly the user gets to the MAIN panel of Fig. 2, the 
simulation can be initiated through the INPUT panel to 
setup the respiratory parameters (left of Fig. 3), including
!VCO2  (metabolic rate of CO2) , PICO2 (inhaled CO2 partial 
pressure), Rin (inspiratory airway resistance), Rex 
(expiratory airway resistance), Ers (lung elastance of 
breathing mechanics), and external dead space. 
The user has to select the controller from two 
alternatives, OPTIMIZATION for employing the optimal 
control model to optimize the respiratory waveforms and 
breathing pattern, or NEURAL NETWORK for utilizing both 
back-propagation neural network and forward model to 
obtain simulated results without going through the time-
consuming process of optimization. As the OPTIMIZATION 
of the main panel is chosen, the process will be advanced 
to the window shown on the right of Fig. 3. In the upper 
part of the window, the user is requested to setup the 
initial parameters which are essential for optimization to 
be proceeded. As all the initial guesses are properly set, 
the user is expected to press “Execute Optimization” 
button. The optimization is proceeded until the numerical 
calculation is completed and optimum is reached. The 
optimized variables, a0, a1, a2, t1, t2, and τ, are displayed 
in the middle of the window as soon as the “Display 
optimized results” is enabled. The obtained optimized 
parameters can then be applied to compose the isometric 
pressure profile. The resultant instantaneous wavefors of 
airflow and lung volume can also be derived.  
 
4. Simulation Results and Discussion 
 
By using the simulator with specified breathing 
environment and parameters, the respiratory pattern 
variables can be derived from the optimized driving 
pressure, airflow, and lung profiles. Various respiratory 
pattern variables, including breathing frequency (F), 
partial pressure of arterial CO2/O2, (PaCO2/PaO2), tidal 
volume (VT), total/arterial ventilation ( !VE !VA ), initial 
lung volume (VO), and duty cycle (Ti/T), are monitored 
through the virtual instrument of LabVIEW. The 
hypercapnia and isocapnis responses can be simulated by, 
respectively, increasing PICO2 and !VCO2  to higher levels 
from the rest where PICO2 = 0% and !VCO2 = 0.2  (L/min).  
The system response to moderate muscular exercise 
can be achieved by varying !VCO2  in the range of 0.2~1.0 
L/min. To examine the significance of the model under 
study, one can further inspect the exercise response by 
varying degree of hypercapnia and eucapnia (PaCO2=40 
Torr and higher, respectively). 
The simulation of CO2 inhalation can be performed 
with various levels of CO2 concentration. In resting state, 
PICO2 is set to be 0%, and we can simply regulate the 
inhaled gas to a higher concentration (PICO2=2~ 7%). 
 
 
Figure 4. The responses of !VA  vs. PaCO2 under muscular 
exercise (white) and CO2 inhalation (dark) for Model 1 
(left) and Model 2 (right).	  
 
4.1 Alveolar Ventilation vs. Arterial CO2 Pressure 
Figure 4 demonstrates the well-recognized ventilatory 
responses !VA  vs. PaCO2 based on the simulation results 
from the simulator with increased CO2 (dark) and exercise 
input (white) for both models. The imposed EDS did not 
show much effect on the characteristics of nearly constant 
PaCO2 under muscular exercise for both models. The 
predicted slopes of !VA  vs. PaCO2 increased linearly with 
the magnitude of EDS on both models. 
 
conventional feedback-mechanisms instead of a separate 
stimulus signal, which has never been clearly 
demonstrated. With this model, a human respiratory 
control simulator is constructed to simulate the ventilatory 
responses under muscular exercise and CO2 inhalation. 
To examine the effects of external dead space 
loadings on the resultant ventilatory responses, two dead 
space models by Gray and Coon were applied for the 
simulations with different levels of EDS. Alththough both 
dead space models appeared to have satisfactory 
predictions on !VA-PaCO2 , !VE ! !VCO2 , !VA ! !VCO2 , F- !VCO2 , 
F-PICO2 , VT- !VCO2 , and VT-PICO2  relationship, model 1 
seemed to have more successful correlation and more 
consistent results in comparisons with experimental 
findings. 
Current study attained valuable results in 
simulations of imposed dead space on respiratory control 
with the optimal respiratory control model. Further work 
can be extented to include the effects of respiratory 
mechanical (resistive or elastic) loading along with EDS 
loading. On the other hand, simulations under muscular 
exercise can also be extended to include the eucapnic and 
hypercapnic responses 
 
References 
 
[1] W.S. Fowler, Lung function studies. II. The 
respiratory dead space. Am J Physiol. 154, 1948, 405-416. 
[2] J.R. Pappenheimer, A.P. Fishman, & L.M. Borrero, 
New Experimental Methods for Determination of 
Effective Alveolar Gas Composition and Respiratory 
Dead Space, in the Anesthetized Dog and in Man, J Appl 
Physiol, 4(11), 1952, 855-867. 
[3] R.L. Coon, & J.P. Kampine, Measurement of dead 
space ventilation using a pH servo-controlled ventilator, J 
Appl Physiol, 51(1), 1981,154-159. 
[4] C.B. Wolff, & R.C. Garratt, Measurement of dead 
space ventilation. J Appl Physiol, 53(1), 1982, 297-298. 
[5] A. Warley, Ventilatory response to an inhaled constant 
CO2 load and added dead space in healthy men, awake 
and asleep, Respir Physiol, 75(2), 1989, 183-192. 
[6] R. Maruyama. Comparison of Ventilatory Response 
between Dead Space and CO2 Breathing in Humans, Jpn J 
Physiol, 38(3), 1988, 321-328. 
[7] F. Lofaso, D. Isabey, H. Lorino, & P. Scheid, 
Respiratory response to positive and negative inspiratory 
pressure in human, Respir Physiol, 89(1), 1992, 75-88.  
[8] C.S. Poon, Potentiation of exercise ventilatory 
response by airway CO2 and Dead Space Loading, J Appl 
Physiol, 73(2), 1992, 591-595. 
[9] C.S. Poon, Ventilatory control in hypercapnia and 
exercise: optimization hypothesis, J Appl Physiol, 62(6), 
1987, 2447-2459.  
[10] F.T. Tehrani, Optimal control of respiration in 
exercise, Paper presented at: 2nd IEEE AIC 1998, Proc. 
20th Annual International Conference of the IEEE 
Engineering in Medical and Biology Society, Hong Kong, 
China, 20, 1998, 3211-3214.  
[11] C.S. Poon, S.L. Lin, & O.B. Knudson, Optimization 
character of inspiratory neural drive, J Appl Physiol, 
72(5), 1992, 2005-2017.  
[12] N.R. Guo, LabVIEW-based Respiratory Control 
Simulator and Simulation of Imposed Dead Space, MS 
Thesis, Feng Chia University, Taichung, Taiwan, 1999. 
[13] S.L. Lin, N.R. Guo, & C.C. Chiu, Modeling and 
Simulation of Respiratory Control with LabVIEW, J Med 
Biol Eng, 32(1), 2012, 51-60. 
 
100年度專題研究計畫研究成果彙整表 
計畫主持人：林賢龍 計畫編號：100-2221-E-035-007- 
計畫名稱：非線性呼吸機械特性模式對肌神經驅動訊號最佳化的影響 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 2 2 50%  
研究報告/技術報告 1 1 100%  
研討會論文 3 3 50% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 4 4 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 6 2 50%  
研究報告/技術報告 0 0 100%  
研討會論文 4 2 50% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
