  
1 
 
行政院國家科學委員會補助專題研究計畫成果報告 
※※※※※※※※※※※※※※※※※※※※※※※※※※ 
※             迴授擾動量化控制技術與應用           ※ 
※※※※※※※※※※※※※※※※※※※※※※※※※※ 
 
計畫類別：▇個別型計畫  □整合型計畫 
計畫編號：NSC 100-2221-E-110-023 
執行期間： 100 年 8 月 1 日至 101 年 7 月 31 日 
 
計畫主持人：余祥華 
共同主持人： 
計畫參與人員：王星翰、吳亭佑 
 
 
 
 
 
 
 
 
 
 
 
 
 
執行單位：中山大學電機系 
 
 
 
 
中 華 民 國 101 年 9 月 3  日 
  
3 
 
2. 回授擾動原理 
構想的回授擾動量化架構如圖二，其組成
包括量化器、濾波器、比較器。其中，濾波
器與比較器之功能為：(1)估測量化雜訊 e
與連續控制信號 u 的線性相關度;(2)產生一
位元(binary)Dither 信號來改變量化結果，
而降低雜訊與信號的相關程度。濾波器 Z
扮演關連性估測器的角色。設計原理類似通
信電路中 Matched Filter 原理[6, p. 135]，設
計濾波器的頻率響應以偵測量化雜訊 e 中
的與連續控制信號 u 相關的信號成分，相關
聯雜訊高則產生大幅值的輸出信號 v。比較
器負責 Dither 信號的產生，目標以減小信
號 v 為原則。圖二(右)為初步的簡易關連性
估測器及 Dither 產生器電路。簡易電路利
用運算放大器搭配電感電容，實現關連性估
測器，在信號頻率附近產生高增益；而比較
器實現 Dither 產生器，根據關連性估測器
輸出，產生兩幅值的 Dither 信號。圖三為
模擬結果，假設連續控制信號為 1Hz 弦波，
為顯現 Dither 量化的功能性，關連性估測
器的輸出初始值設為 0.5。模擬顯示，Dither
量化如預期的將關連性估測器的輸出變
小，而量化雜訊頻譜則顯示，在信號頻率
1Hz 附近其頻率成分大量被抑制，有效的降
低信號與量化雜訊的線性相關程度。圖四為
比較分析，所提的迴授擾動電路是可行的且
有非常卓越的性能，可大量降低量化器所產
生與信號相關的雜訊，提高其線性程度。 
3. 直流交流轉換器之控制系統設計 
   將回授擾動量化技術應用於直流至交流
轉換器[8]的控制與調變。對於直流至交流
轉換器而言，輸出的交流電源會提供給各式
負載，這樣的負載變動系統，使得系統會處
於極不穩定的狀態，必須針對此系統進行改
善，且提高系統的使用效能。圖五為直流至 
 
圖二、迴授擾動量化方塊圖(左)與回授擾動電路(右)
0 2 4 6 8 10
-1
0
1
Time (sec)
uq     
0 2 4 6 8 10
-0.5
0
0.5
Time (sec)
v  
0.01 0.1 1 10 100 500
-80
-60
-40
-20
0
20
Frequency (Hz)
dB  
圖三、回授擾動量化電路模擬結果：上圖為量化輸出
結果；中圖為關連性估測器的輸出；下圖為穩態量化
雜訊頻譜。 
2 4 6 8 10 12 14 16
-50
-40
-30
-20
-10
0
10
20
Number of quantization levels
A
ve
. C
N
S
R
 (d
B
)
no dither
uniform-PDF dither
sawtooth-waveform dither
lowpass feedback dither
bandpass feedback dither
圖四、各種擾動(dither)對不同階量化器(quantizer)的
影響。性能指標為correlated-noise-to-signal ratio [7]
(CNSR)，其值越小代表所產生的量化雜訊與輸入信
號的關連性越低。結果顯示所提出的兩種低通及帶通
回授擾動設計與常見的dither比較，均顯示較佳的性
能，可以有效改善量化器的線性度。 
  
5 
 
電壓與電流波形。利用電壓總諧波失真顯示出
各次諧波皆能有效的抑制，產生出高品質的電
壓電源。 
將此控制架構實現於不受控的非線性負載
下，圖九表示電壓波形與非線性的電流波形，
電壓總諧波失真顯示出此設計的控制架構具
有強健性對於輸出負載所造成的影響。 
 觀察電壓電流波形了解負載瞬間變動對
於此控制架構於直流至交流轉換器所造成的
影響，圖十為 50Ω的線性負載的情況下轉變至
無載，以及圖十一為在無載的情況下轉變至
50Ω的線性負載兩種情況下討論。當電流瞬間
變化時，會使得輸出電壓波形受到影響，但經
由控制架構的作用下，經由兩個週期的時間後
使得電壓回復到較佳的電力品質的電壓輸出。
 
 
 
圖七、輸出端負載為∞Ω(無載)且電壓總諧波失真
(THD)為 0.269%。 
 
圖八、輸出端負載為 25Ω(重載)且電壓總諧波失真
(THD)為 0.32%。 
 
圖九、輸出端負載為非線性負載且電壓總諧波失
真(THD)為 0.29%。 
 
 
圖十、負載變動於 50Ω 的線性負載轉變至無載。 
 
圖十一、負載變動於無載轉變至 50Ω 的線性負
載，且電壓瞬間變動誤差百分比為 26.7%。 
 
5. 結論 
  用回授擾動量化技術取代傳統的脈波寬度
調變技術，有明顯的優勢: 回授擾動量化在低
頻處有較佳的線性度、較低的雜訊與諧波失
真，因此對於電力電子的量化控制系統，有提
  
 
Abstract—This paper presents a novel sinusoidal modulation 
scheme that features least correlated noise and high linearity. The 
modulation circuit, which is composed of a quantizer, a resonator, and 
a comparator, is capable of eliminating correlated modulation noise 
while doing modulation. The proposed modulation scheme combined 
with the linear quadratic optimal control is applied to a single-phase 
voltage source inverter and validated with the experiment results. The 
experiments show that the inverter supplies stable 60Hz 110V AC 
power with a total harmonic distortion of less than 1%, under the DC 
input variation from 190 V to 300 V and the output power variation 
from 0 to 600 W.  
 
Keywords—Pulse width modulation, feedback dithering, linear 
quadratic control, inverter. 
I. INTRODUCTION 
INUSOIDAL pulse width modulation (SPWM) [1], widely 
applied to an inverter for DC-to-AC conversion [2, 3] or 
motor drive [4, 5],  is a technique to convert a sinusoid to a 
multi-level switched waveform by performing amplitude 
modulation and pulse width modulation [5-7]. Two most 
concerned issues for SPWM are its switching frequency and 
signal quality. The switching frequency determines the 
switching loss of the inverter, and the signal quality is related to 
the amount of noise, harmonics, and tones present at the output 
of the inverter.  
This work focuses on the second design issue, attempting to 
derive a novel SPWM to enhance its signal quality. The 
proposed design is mainly derived from the feedback dithering 
concept recently developed in [8]. Figure 1 displays the block 
diagram of the proposed modulation. The modulation is 
performed by a dithered quantizer, where the dither is 
generated by feeding back the modulation noise n through a 
resonator and a comparator. The feedback dithering 
automatically randomizes the noise and eliminates the 
correlated noise present at the output, so as to attenuate in-band 
noise and make the modulator behave like a linear gain added 
with uncorrelated noise.  
II. FEEDBACK DITHERING MODULATION 
Figure 1 shows the block diagram of a feedback dithering 
modulator that is designed to perform SPWM. The modulator 
consists of a quantizer and a recently developed feedback 
 
This work is supported by National Science Council, Taiwan, under grant 
NSC 100-2221-E-110-023. The authors are with National Sun Yat-Sen 
University, Kaohsiung 804, Taiwan (e-mail: shaun@mail.ee.nsysu.edu.tw; 
hansheng1101@hotmail.com).  
dithering circuit [8]. The quantizer quantizes a sinusoidal signal 
to a prescribed set of levels, say {‒1, 0, 1} for normalized 
three-level modulation. A binary dither δ that is generated by 
the feedback dithering circuit intends to randomize the 
quantization pattern and eliminate correlated noise.   
The feedback dithering circuit, made from a resonator G and 
a comparator, is responsible for minimizing the correlation 
between modulation noise n and sinusoidal input u. First, the 
resonator G performs correlation estimation, and its resonant 
frequency ω is the same as the frequency of the sinusoidal input 
u. Under the assumption of zero initial conditions, the output of 
resonator G in Fig. 1 is  
  dtnAtv t  )()sin( )(  
 0  ,  (1) 
 
where Asin(ωt+θ) is the impulse response of G. In the steady 
state, the resonator’s output level can be used to estimate the 
magnitude of the cross-correlation function R(t) of sinusoidal 
input u and modulation noise n,  
 
  dtnutR T
T
 )()( lim)(
 
 0   .  (2) 
 
Obviously R(t) is zero when v(t) is bounded. Thus, to achieve 
complete decorrelation R(t) 0 , the dither signal δ should be 
designed to influence the quantization so that the resulting 
modulation noise n will minimize and bound the resonator 
output level. The choice of the instantaneous value of dither 
signal δ obeys the following simple rule 
 
 )(sgn)( tvdt  ,  (3) 
 
 
Shiang-Hwua Yu and Han-Sheng Tseng 
Novel Sinusoidal Pulse Width Modulation      
with Least Correlated Noise 
S
22 

s
bas
 
Fig. 1 Feedback dithering modulation 
 
World Academy of Science, Engineering and Technology 60 2011
978
  
0.6 6   60  600 6k 30k
-80
-60
-40
-20
0
20
40
60
M
ag
ni
tu
de
 (d
B
)
Frequency (Hz)                  
0.6 6 60 600 6k 30k
-80
-60
-40
-20
0
20
40
60
M
ag
ni
tu
de
 (d
B
)
Frequency (Hz)  
(a) (b) 
 
Load


0.5L
C y
H-birdge
MOSFETs
r
1 80
1 80
comparators 
&
logic circuit
60kHz
  
 


controller
d
d
Current estimator
1 80
u 

Li
uq
0.5L
1
resonator
modulator
Ls+r
G
 
 
ye qu

r P
 47.94 4.87
4 2 8 12
3 6
4.314 10 1.911 10 0.5 10
3.553 10
s s
s s
    
 
Li
y
   
n



1 80
1 80
Fig. 5 LQR control system, in which a linear gain block and an additive 
uncorrelated noise source are used to model the modulator, and the 
 
 
IV. APPLICATION: SINGLE-PHASE INVERTER 
The proposed feedback dithering modulation is applied to a 
single-phase voltage source inverter, intended to convert a 
200V DC power to a 60Hz 110V AC power. Figure 4 shows the 
block diagram of the proposed design. It consists of three parts: 
a controller, a modulator and an LC filter plus load. The design 
strategy is to modulate the waveform with least correlated noise 
so that the modulator can be modeled as a linear gain added 
with a bounded uncorrelated noise, and the feedback controller 
can thus be designed and optimized using only linear feedback 
theory. 
A. Modulator Design 
The core of the inverter is the modulator, which consists of 
the feedback dithering circuit and a three-level clocked 
quantizer. The clocked quantizer is formed with a combined 
circuit of comparators AD8561, D-type flipflops TTL74F74, 
switching logic and dead-time circuit, optocouplers HCPL- 
3180 and predrivers IR2110, and a full bridge of power 
MOSFETs IRFP460, performing three-level quantization at a 
rate of 60 kHz and with the dead time of switching set to 1.6 μs. 
The dither amplitude and the resonator of feedback dithering 
are chosen the same as those in (11). 
 
 
B. Controller Design 
The controller is designed using the frequency-shaped linear 
quadratic regulator method [10]. The plant to be controlled is 
the dynamics from the switched waveform uq to the output y, 
constituted by the output LC filter (L=2.5 mH and C=10 μF) 
and a load [11]. The plant is lowpass with a cutoff frequency 
roughly of 1 kHz. The modulator is modeled as a linear 
amplifier added with uncorrelated noise. The controller is 
optimized by minimizing the following quadratic cost 
functional with the additive uncorrelated modulation noise 
neglected.  
 
 
 dURYjW
U
 |)(||)]()()[(| min
 22   , 
 
where Y, R, and U are the Fourier transforms of output y, 
reference r, and unquantized control u, respectively. To 
attenuate low-frequency noise and eliminate the fifth harmonic 
at 300 Hz, the weighting function is chosen as 
 
 ])3002([
105.0)( 22
12

 sssW  
Fig. 3 Power spectra of three-level waveforms modulated by (a) sine-triangle PWM  and (b) feedback dithering modulation 
Fig. 4 Functional diagram of single-phase inverter plant models the LC-filter-plus-load dynamics 
World Academy of Science, Engineering and Technology 60 2011
980
  
[2] C. G. C. Branco, C. M. T. Cruz, R. P. Torrico-Bascope, and F. L. M. 
Antunes, “A nonisolated single-phase UPS topology with 110-V/220-V 
input–output voltage ratings,” IEEE Trans. Ind. Electron., vol. 55, no. 8, 
pp. 2974-2983, 2008. 
[3] P. K. W. Chan, H. S. H. Chung, and S. Y. Hui, “A generalized theory of 
boundary control for a single-phase multilevel inverter using second- 
order switching surface,” IEEE Trans. Power Electron., vol. 24, no. 10, pp. 
2298-2313, 2009. 
[4] A. M. Trzynadlowski, Z. Wang, J. M. Nagashima, C. Stancu, and M. H. 
Zelechowski, “Comparative investigation of PWM techniques for a new 
drive for electric vehicles,” IEEE Trans. Ind. Appl., vol. 39, no. 3, pp. 
1396-1403, 2003. 
[5] L. Tolbert, F. Z. Peng, and T. Habetler, “Multilevel converters for large 
electric drives,” IEEE Trans. Ind. Appl., vol. 35, no. 1, pp. 36–44, Jan. 
1999. 
[6] J. Rodriguez, J. S. Lai, and R. Z. Peng, “Multilevel inverters: A survey of 
topologies, controls, and applications,” IEEE Trans. Ind. Electron., vol. 
49, no. 4, pp. 724–738, Aug. 2002. 
[7] G. Carrara, S. Gardella, M. Marchesoni, R. Salutari, and G. Sciutto, “A 
new multilevel PWM method: A theoretical analysis,” IEEE Trans. Power 
Electron., vol. 7, no. 3, pp. 497–505, Jul. 1992.  
[8] S. H. Yu, “Feedback dithering for decorrelating quantization noise and 
enhancing SNDR,” IEEE Trans. Control Syst. Technol., published on-line 
before print, 2011. 
[9] C. Edwards and S. K. Spurgeon, Sliding Mode Control. Boca Raton, FL: 
CRC Press, 1998.  
[10] S. H. Yu and M. H. Tseng, “Optimal control of a nine-level class-D audio 
amplifier using sliding-mode quantization,”  IEEE Trans. Ind. Electron., 
vol. 58, no. 7, pp. 3069-3076, July, 2011. 
[11] P. Peltoniemi, P. Nuutinen, M. Niemelӓ, and J. Pyrhönen, “Control of the 
single-phase customer-end inverter in a low-voltage DC distribution 
network,”  in 2008 Conference of IEEE Ind. Electron., pp. 635-640. 
[12] R. Schaumann, H. Xiao, and M. E. Van Valkenburg, Analog Filter Design. 
New York: Oxford University Press, 2011. 
 
World Academy of Science, Engineering and Technology 60 2011
982
100 年度專題研究計畫研究成果彙整表 
計畫主持人：余祥華 計畫編號：100-2221-E-110-023- 
計畫名稱：迴授擾動量化控制技術與應用 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 2 2 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 1 1 100%  
研究報告/技術報告 0 0 100%  
研討會論文 1 1 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
