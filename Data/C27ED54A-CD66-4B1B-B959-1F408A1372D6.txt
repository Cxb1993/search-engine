 II
中文摘要 
本研究提出一個結合改進人工位能場的進化演算法，並成功地應用於無人飛行載具(UAV)
自動導航的路徑規劃。此演算法中，候選的路徑係藉由虛擬的位能場快速地避開附近的障
礙物；它具有尋找多目標最佳解特性的進化演算特性，也兼顧無人飛行載具的飛行限制，
找到適合且合理的路徑，供無人載具採最佳路徑飛行。此一演算法在虛擬的環境下，經過
多次的模擬，證實比傳統的進化演算法尋求最佳飛行路徑更有效率。本計畫同時提出一
個以派翠西網路為基礎的圖像式導航理論作為導航系統。其優點在於此系統不必建
立複雜的數學模型，只需倚靠專家經驗，建立完整流程圖，便可控制無人飛行載具
的行為。本研究未來可供智慧型機器人行為模式建立及最佳路徑規劃等相關研究之
架構。 
關鍵字：無人飛行載具、派翠西網路、路徑規劃、障礙物閃避 
 
英文摘要 
In this research, the idea of evolutionary algorithms (EAs) is combined with modified 
artificial potential fields to successfully develop a novel flight route planner for unmanned 
aerial vehicle’s (UAV’s) autonomous navigation. In this design framework, the individual 
candidate routes could avoid threats quickly by introducing a virtual potential field while 
taking into account a variety of flight constraints. This architecture allows users rapidly 
creating a mission task or alters its frame simply. Also proposed is a behavior-based 
navigation scheme based on the Petri nets for UAVs. The architecture integrates route 
planning, event disposal and UAV-ground station cooperation. A large amount of 
simulations have been performed to verify the effectiveness and superiority of our 
proposed approach.  
keywords: Unmanned aerial vehicle, Petri net, Route planning, Obstacle avoidance 
 2
position and [ ]Tn n n np x y zK   being the goal 
position. The second via point on the flight route 
is given by 
1 0 1 0 1 0, ,
dir dir dir dir dir dir
s s s s s sx x x y y y z z zε ε ε= + = + = +  
where 
Tdir dir dir
s s sx y z⎡ ⎤⎣ ⎦  specifies the direction of 
the UAV at the starting position and dirsε  would be 
a small value 
The chromosome string for the k-th flight 
route represented in terms of the start, 
intermediate and end nodes is defined as 
,0 ,1 ,2 ,( 1) ,
0 1 ,2 ,( 1)
k k k k k n k n
k k n n
r p p p p p
p p p p p
−
−
⎡ ⎤⎣ ⎦
⎡ ⎤= ⎣ ⎦
K K K K K "
K K K K K"
 
which is actually a 3 ( 1)n× +  matrix. Note that the 
start node, the second node and the end node are 
always the same and fixed. 
Revision of Chromosome Representation  
Let , , ,( 1)k i k i k is p p −= −K K K  represent the vector of 
the i-th segment in the k-th chromosome. Then, it 
is appropriate to set the maximal and minimal 
lengths of the route segment as maxL  and minL  
respectively and restrict ,k is
K  as follows 
min , max  ,     ,  2, ,k iL s L k i n≤ ≤ ∀ =K …  
where min max0.5L L≤ . 
Mutation Operator 
Given a route, the mutation operator selects 
randomly the nodes and alters the coordinates of 
these nodes randomly: 
[ ], , ( , , ) (0,1) (0,1) (0,1) Tk i k i x y zp p diag N N Nσ σ σ′ = +K K  
Where , 1, , 1k i n∀ = −"  and (0,1)N  denotes the 
normalized Gaussian random number with zero 
mean and unit standard deviation; xσ , yσ  and zσ  
are the magnitudes of mutation on the 
corresponding direction. 
B. Virtual Potential Field 
Repulsive Force of Multi-Obstacle 
Magnitude of the force filed of the i-th way 
point of the k-th flight route to each obstacle is 
defined as 
( )
{ }
( ) { }
{ }
1
,
0
1 1
, ,
max ,, ,
0 0
1
,
0
        0,                                     
,
        ,                      
l
k i j w
w
l lj w k i j w
k i j w j wk i j w
j w j w w w
l
k i j w
w
p B
S d
F F p A B
S R
p A
−
+
=
− −+ +
+ ++ + + = =
−
+
=
∈
− ⎛ ⎞ ⎛ ⎞⎛ ⎞= ∈⎜ ⎟ ⎜ ⎟⎜ ⎟⎜ ⎟ ⎜ ⎟ ⎜ ⎟−⎝ ⎠ ⎝ ⎠ ⎝ ⎠
∞ ∈
K
K ∩
K
∩
∩ ∪
∪                
⎧⎪⎪⎪⎪⎨⎪⎪⎪⎪⎩
 
where ( ){ } ( ){ },j w j w j w j w j w j wA p R p o B p S p o+ + + + + += ≥ − = ≥ −K K K K K K  
and maxF  is a positive gain parameter to modulate 
the potential field height. 
Then, the virtual potential force of the i-th 
way point of the k-th flight route to the (j+w)-th 
obstacle is defined as: 
(i) When { } 1 1,
0 0
l l
k i j w j w
w w
p A B
− −
+ +
= =
∈K ∩∩ ∪ : 
( )
1
,
, , , ,
0 ,
l
k i j wMulti
k i j k i j w
w k i j w
p o
F F
p o
− +
+
= +
−= −∑
K KK
K K  
(ii) When { } 1
0
l
i j w
w
p A
−
+
=
∈K ∪ : 
( ) ( ), , , , , ,2gMulti Multi Multik i j k i j k i j g k i j
i ig
s
F F p o s p o
s
⎧ ⎫⎛ ⎞⎪ ⎪= − − ⋅ −⎨ ⎬⎜ ⎟⎝ ⎠⎪ ⎪⎩ ⎭
∑ ∑
KK K K K K K
K  
where ,g k n cs p p= −K K K  with [ ]Tc c c cp x y zK   being 
the UAV’s current coordinates. 
Generate New Chromosomes by Force Field 
The resultant force influencing the i-th node 
of the k-th flight route can be defined as 
, , ,  ,   2, , 1
Total Multi
k i k i jj
F F i n= = −∑K K …  
The vector ,fk iq
K  is defined as the correction for the 
i-th node in the k-th chromosome according to the 
magnitudes of virtual forces: 
, ,, , , ,
,
, , , , ,
,
,  if 
,  otherwise
Tf f f f Total Total
k i k ik i k i k i k i
TotalT k if f f f f
k i k i k i k i k i Total
k i
q x y z F F
F
q x y z L
F
⎧ ⎡ ⎤ = ≠ ∞⎪ ⎣ ⎦⎪⎨ ⎡ ⎤ =⎪ ⎣ ⎦⎪⎩
K KK 
K
K  K
. 
where ,fk iL  is the minimal value to ensure that the 
point ,k ip′K  will be located outside the zone where 
Total
iF = ∞
K
. New nodes are then generated as 
, , , , , ,  ,  2, , 1
T f
k i k i k i k i k i k ip x y z p q i n′ ′ ′ ′⎡ ⎤ = + = … −⎣ ⎦K K K  
Each original chromosome generates a new 
chromosome by incorporating the virtual force 
field. Assume there are N  original chromosomes 
and new chromosomes are defined as 
,0 ,1 ,2 ,( 1) ,
0 1 ,2 ,( 1)   ,     1, ,
N k N k N k N k N k n N k n
k k n n
r p p p p p
p p p p p k N
+ + + + + − +
−
⎡ ⎤⎣ ⎦
′ ′⎡ ⎤= =⎣ ⎦
K K K K K "
K K K K K" …
 
which is a 3 ( 1)n× +  matrix. For all new 
chromosomes, 0p
K , 1pK  and npK  always remain 
invariant in the virtual force field.  
C. Objective Function 
Cost Function 
 4
(i) When there is no obstacle around the pop-up 
threat area: 
Rst xyzF T=
K K
 
(ii) When there are obstacles around the pop-up 
threat area: 
( )2 2 2 2 11  ,   0 1,   2Rst xyz xyzF k T k O k k′= + − < ≤ ≠
KK K
 
where 2k  is the weighting factor of the virtual 
potential field.  
Assume that the maximal turning angle of the 
UAV is maxθ  and the maximal climbing and 
diving angles are maxα  and maxβ  respectively. The 
horizontal velocity of the UAV is xyv  and the 
vertical velocity is zv . The magnitude of the 
virtual force is defined as the flight distance of the 
UAV shifted by the virtual field within a unit of 
time T . The horizontal and vertical magnitudes 
of the virtual field can be expressed as follows. 
(i) Maximum magnitude of the horizontal force 
field: 
 max
 
sin t T
xy xyt
f v dt
T
θ += ∫  
(ii) Maximum magnitude of the vertical force 
field: 
[ ]
[ ]
  max
  
  max
  
tan 1 ,        0 0 1 0
tan 1 ,        0 0 1 0
t T t T
xy z Rstt t
z
t T t T
xy z Rstt t
v dt v dt F
T Tf
v dt v dt F
T T
α
β
+ +
+ +
⎧ − ⋅ ≥⎪⎪= ⎨⎪ + ⋅ <⎪⎩
∫ ∫
∫ ∫
K
K
 
The maximum magnitude of the virtual force is 
given by max
T
xy xy zF f f f⎡ ⎤= ⎣ ⎦ . Then, an artificial 
potential field for the treat avoidance mechanism 
can be written as 
( , , )xyz xy xy z RstF diag f f f F=
K K
 
Regulate Vertical Magnitude of the Force Field 
A function is derived to regulate magnitude 
of the vertical virtual potential field to ensure the 
UAV with a steady flight in the vertical direction. 
Denote that [ ]0 0 1 TH =K .Then, the virtual 
potential field is given by: 
( )4 4
3
( )1
1 xyzc d dTA xyz
d
H F Hk z z k R
F F k
R H
⋅⎛ ⎞− + −= − −⎜ ⎟⎝ ⎠
K K KK K K  
where 3k  and 4k  are the weighting factors which 
determine respectively the maximal and minimal 
magnitudes of the vertical force and 30 1k≤ ≤ , 
40 1k≤ ≤ . 
B. Structure of Threat Avoidance Mechanism 
The threat avoidance mechanism is used to 
deal with the navigation problem in the condition 
of UAVs flown into a pop-up threat area. Based on 
regulating the weighting factors 1 4, ,k k…  about 
the efficiency of fleeing, the safety and the steady 
flight altitude respectively, a fitting flight route 
will be created for the UAV to flee from the 
pop-up threat area. The threat avoidance 
algorithm is described in Fig. 2. 
IV. NAVIGATION SCHEME 
In this section, a navigation scheme for the 
UAV is designed by Petri-net. A Petri-net consists 
of place nodes, transition nodes and directed arcs 
connecting places with transition. Behaviors are 
designed as places and the changes between them 
are modeled as transition. A place may contain 
any number of token and the distribution of 
tokens over places is called a marking. Figure 2 
shows the resultant navigation scheme model. 
Table 1 describes the physical meaning of places 
and transition of the model. 
V. DEMONSTRATIVE RESULTS 
To verify the valid of the navigation scheme, 
markings of the Figure 3 and 4 are shown in table 
2 and 3 respectively. The markings denoted the 
corresponding state of the navigation scheme 
controlled during the process of experiment. 
Case 1: 
Fig. 3(a)-(c) display three snapshots of the 
evolution process with the virtual potential field. 
The route planner generated an optimal route for 
the UAV shown as in Fig. 3(d). From Fig. 3(e)(f), 
one observes that the original flight route crosses 
the pop-up threats with the threat zone producing 
a virtual potential field against the original route. 
Then the generated route makes a detour from the 
threats in the next a couple of generations of 
evolution (show in Fig. 3(g)) with the virtual 
potential field. A near-optimal flight route in the 
new environment was generated at last. See Fig. 
3(h)(i), in which the original route was illustrated 
by the dash line. 
Case 2: 
As illustrated in Fig. 4(a), the route planner 
has generated an optimal flight route under the 
known environmental information. Then the UAV 
 6
 
1t
3t 2t
8t
11t
10t
4t 7t 6t
5t
9t
AP
HP GP
BP
CP
DP
EP
IP
JP
FP
 
Fig. 3 Petri-net model of the UAV 
 
 
 
 
(a)                      (b)                       (c) 
 
(d)                      (e)                       (f) 
 
(g)                      (h)                       (i) 
Fig. 3 Route planning for UAVs. (a)(b)(c) Result 
of the generation 1, 50 and 100 with a virtual 
potential field. (d) Result of the generation 100 
shown on the XY plane. (e) A pop-up obstacle. 
(f)(g)(h) Replanning result of the generation 0, 10 
and 100 with a virtual potential field. (i) 
Replanning result of the generation 100 shown on 
the XY plane. 
 
 
 
 
 
(a)                      (b)                       (c) 
    
(d)                         (e) 
Fig. 4 Result of route planning for the UAV 
fleeing from a threat area. (a) A planned flight 
route. (b) A pop-up threat area. (c) Flee from the 
threat area by a virtual force field. (d) Vertical 
view of (c). (e) Route planned by evolutionary 
route planner. 
 
 
Tab. 1 Description of place and transition 
Place Description 
AP  Takeoff 
BP  Steady flight 
CP  Tracking flight 
DP  
Receive information and commands from 
the ground station 
EP  Avoid the pop-up threat area 
FP  Plan the flight route 
GP  Lift / Descend 
HP  Hover 
IP  Land 
JP  Flight to the place for crash 
Transition Description 
1t  Arrive specific height 
2t  Convert to tracking flight mode 
3t  Convert to steady flight mode 
4t  Time to communicate with ground station 
5t  Confirm the flight condition 
6t  Confirm the UAV’s position 
7t  Route planning has been finished 
8t  Change flight scheme 
9t  Convert to hover or steady flight 
10t  Convert to steady flight mode 
11t  Execute the landing process 
 8
計畫成果自評： 
本研究提出一個結合改進人工位能場的進化演算法，並應用於無人飛行載具(UAV)自動導
航的路徑規劃。此演算法中，候選路徑係藉由虛擬位能場快速地避開附近的障礙物；它具
有尋找多目標最佳解特性的進化演算特性，也兼顧無人飛行載具的飛行限制，找到適合且
合理的路徑，供無人載具採最佳路徑飛行。此一演算法在虛擬環境下，經過多次模擬，證
實比傳統進化演算法尋求最佳飛行路徑更有效率。本計畫同時提出一個以派翠西網路為
基礎的圖像式導航理論作為導航系統。其優點在於此系統不必建立複雜的數學模
型，只需倚靠專家經驗，建立完整流程圖，便可控制無人飛行載具的行為。此外，
它的可塑性大，可經由任意打斷或增加鍵結，以插入或移除工作。期望此研究未來
可供智慧型機器人行為模式建立及最佳路徑規劃等相關研究之架構探討。 
 
本研究之部分成果已以長篇論文之形式投稿AIAA Journal of Guidance, Control, and 
Dynamics 並於2007 International Automatic Control Conference以口頭發表論文。關於利用
派翠西網路作為UAV導航設計部分，目前先完成單機飛行想定之驗證，仍續進行多機攻擊
之模擬想定驗證，預期近期內即能完成電腦模擬及論文撰寫。 
 
 
Proceedings of 2007 CACS International Automatic Control Conference 
where 
Tdir dir dir dir
s s s sp x y z⎡ ⎤⎣ ⎦K   specifies the direction 
of the UAV at the starting position and dirsε  would be a 
small value. 
If the UAV’s flight direction is restricted when it ar-
rives the goal, an extra way-point close to the goal should 
be set and a vector from the goal to this extra point can be 
used to represent its limited direction. By setting this 
extra way-point, the route planner will consider whether 
the flight angle to the goal is feasible and eventually find 
out a feasible route with limited terminal direction for the 
UAV. The extra way-point [ ]1 1 1 1 Tn n n np x y z+ + + +K   is 
defined as  
 1 dir dirn n g gx p pε+ = +K K K  (2) 
where 
Tdir dir dir dir
g g g gp x y z⎡ ⎤⎣ ⎦K   is the expected direc-
tion to the goal, and dirgε  is small so that the extra point 
only has small effect on the goal position. 
Each chromosome has a random number of inter-
mediate nodes and each intermediate node of the indi-
vidual set as the parents to randomly generate their off-
springs. Note that the start node 0p
K , the second node 1pK  
and the end node np
K  are always the same for all the 
chromosomes in each population and fixed in the evolu-
tionary procedure. The chromosome string for the k-th 
flight route represented in terms of the start, intermediate 
and end nodes is defined as 
 ,0 ,1 ,2 ,( 1) ,
0 1 ,2 ,( 1)
k k k k k n k n
k k n n
r p p p p p
p p p p p
−
−
⎡ ⎤⎣ ⎦
⎡ ⎤= ⎣ ⎦
K K K K K "
K K K K K"
 (3) 
which is actually a 3 ( 1)n× +  matrix and ,0 0kp p=K K , 
,1 1kp p=K K , ,k n np p=K K  for k∀ . If the terminal flight direc-
tion for the UAV is specified, the last node will be 1np +
K  
which should be kept the same for all chromosomes. 
B. Revision of Chromosome Representation 
All chromosomes of the initial population are gener-
ated randomly for the flight routes. The maximum length 
of each chromosome generated, i.e. the number of nodes, 
is an input parameter of the system. The way-point 
placed too close to the others will cause the evolutionary 
process less efficient and the one too far from its nearby 
way-pinots will lead to a less smooth flight route. Let 
,k is
K
 represent the vector of the i-th segment in the k-th 
chromosome: 
 , , ,( 1) ,  1, ,k i k i k is p p i n−= − =K K K …  (4) 
Then, it is appropriate to set the maximal and minimal 
lengths of the route segment as maxL  and minL  respec-
tively and restrict ,k is
K  as follows 
 min , max  ,    ,  2, ,k iL s L k i n≤ ≤ ∀ =K …  (5) 
where min max0.5L L≤ . 
Note that ,1ks
K  indicates the initial direction of the 
UAV so that the length of the first segment ,1ks
K  
shouldn’t be restrained by the constraint discussed above. 
Similarly, if the terminal direction of the UAV has to be 
restricted, then ,( 1)k ns +
K  shouldn’t be restrained.  
C. Mutation Operator 
Mutation is the major operator in all evolutionary 
algorithms which is used to impose a random change to 
the nodes’ coordinates, which could be either feasible or 
infeasible. Given a route, the mutation operator selects 
randomly the nodes and alters the coordinates of these 
nodes randomly: 
 , ,
(0,1)
( , , ) (0,1)
(0,1)
k i k i x y z
N
p p diag N
N
σ σ σ
⎡ ⎤⎢ ⎥′ = + ⎢ ⎥⎢ ⎥⎣ ⎦
K K  (6) 
where the i-th new way-point of k-th flight route ,k ip′K  
is the mutated by the i-th originally way-point of k-th 
flight route ,k ip
K  and (0,1)N  denotes the normalized 
Gaussian random number with zero mean and unit 
standard deviation; xσ , yσ  and zσ  are the magnitudes 
of mutation on the corresponding direction. 
III. VIRTUAL POTENTIAL FIELD 
The virtual potential field method was originally used 
for obstacle avoidance with fast mobile robots in 2-D 
environment. We extend here the 2-D virtual potential 
field to 3-D space to shift the infeasible candidates (route 
nodes) from the threat area to the safe area. 
The cases of single and multiple obstacles are dis-
cussed separately. 
A. Repulsive Force of Single Obstacle 
Magnitude of the force filed for the i-th way point of 
the k-th flight route to the j-th obstacle is defined as 
 
, ,
, ,
, , max , ,
, ,
        0,                       
,   
       ,                      
k i j j
j k i j
k i j j k i j j
j j
k i j j
d S
S d
F F R d S
S R
d R
⎧ >⎪ ⎛ ⎞−⎪= < ≤⎜ ⎟⎨ ⎜ ⎟−⎪ ⎝ ⎠⎪ ∞ ≤⎩
 (7) 
where maxF  is the maximum magnitude of the virtual 
force within the zone between jR  and jS ; jS  denotes 
sphere of influence (radial extent of the force from the 
mass center of the j-th obstacle); jR  is the minimal ra-
dius measured from the mass center of the j-th obstacle 
which covers the whole obstacle, and , ,k i jd  is the dis-
tance of the i-th way point of the k-th flight route to the 
center of the j-th obstacle. 
Denote the coordinates for the mass center of the j-th 
obstacle as jo
K . Construction of the virtual potential force 
Proceedings of 2007 CACS International Automatic Control Conference 
B. Constraints 
Since a flight route consists of a series of route seg-
ments, the constraints on the entire flight route can be 
converted to that on each route segment. Some of the 
constraints considered here were consulted from [2]: 
(i) Maximal Route Distance: Denote the maximal 
route distance as totalL  then 
 ( )1 , 1
1
n
k k i
i
g r s b
=
≤∑ K  (18) 
where 1 totalb L= . 
(ii) Maximal/Minimal Altitude: Denote the allowable 
maximal and minimal altitudes being maxH  and 
minH  respectively. Then 
 ( ) ( )2 , min max 212i k k ig r z H H b− + ≤  (19) 
where ( )2 max min0.5b H H= − . 
(iii) Maximal Turning Angle: Denote ,k ia
K  being the 
projection of ,k is
K  on the X-Y plane and the maxi-
mal turning angle be maxθ , then 
 ( ) , ,( 1)13 3
, ,( 1)
cos k i k ii k
k i k i
a a
g r b
a a
+−
+
⎛ ⎞⋅⎜ ⎟ ≤⎜ ⎟⎝ ⎠
K K
 K K  (20) 
where ( ), ,diag(1,1,0)k i k ia s=K K  and 3 maxb θ= . 
(iv) Maximal Climbing/Diving Angle: Denote the al-
lowable maximal climbing angle and diving angle 
to be maxα  and maxβ  respectively, then the con-
straint for the climbing/diving angles are 
( )
, ,( 1)1
4 , ,( 1)
,
4
,( 1) ,1
4 , ,( 1)
,
tan , 0
tan ,  0
k i k i
k i k i
k i
i k
k i k i
k i k i
k i
z z
b z z
a
g r
z z
b z z
a
−−
−
−−
−
⎧ ⎛ ⎞−⎪ ⎜ ⎟ ≤ − ≥⎜ ⎟⎪⎪ ⎝ ⎠⎨ ⎛ ⎞⎪ −⎜ ⎟ ≤ − <⎪ ⎜ ⎟⎪ ⎝ ⎠⎩
K

K
 (21) 
where 4 maxb α= , if , ,( 1) 0k i k iz z −− ≥  and 
4 maxb β= − , if , ,( 1) 0k i k iz z −− < . 
(v) Safety Flight Route: This determines whether the 
way-point lies outside the given obstacles and each 
segment of the route won’t cross any obstacle. 
Assume that the safe distance between the mass 
center of j-th obstacle and the i-th segment of the 
k-th flight route is jR , which is the same as the 
minimal radius measured from the mass center of 
the j-th obstacle which covers the whole obstacle. 
Then  
( )
( )
( )
, ,( 1) 5
5 , ,
5
,
min , ,side 0
,           side 0
j k i j k i j
i k k i j k i
j
k i
R p o p o b
g r p o s
R b
s
−⎧ − − − ≤ ≥⎪⎪⎨ − ×⎪ − ≤ <⎪⎩
K K K K
K K K
K
 (22) 
where ( ) ( )1side i j i i j ip o s p o s−⎡ ⎤ ⎡ ⎤− ⋅ − ⋅⎣ ⎦ ⎣ ⎦K K K K K K  and 
5 0b = . 
C. Objective Function 
The constrained objective function for the current 
problem can be formulated as follows 
 ( ) ( ) ( )k k kf r C r P r=  (23) 
where the penalty term ( )kP r  is defined as 
( ) ( )( )
( )
( )
5
1
1 max max
1 2 1
11
n
ji kk
k p pj
k ji kj i
b rb r
P r w w
nb r b r= =
⎛ ⎞ΔΔ ⎜ ⎟= + + ⎜ ⎟Δ Δ⎝ ⎠∑∑  (24) 
in which  
( ) ( ){ }
( ) ( ){ }
( ) ( ){ }
( ) ( ){ }
1 1 1
max
1 1
max
max 0, ,
max , ,
max 0, ,  2, ,5 ,  1, ,  
max , , 
k k
k k
ji k ji k j
ji k ji k
b r g r b
b r b r
b r g r b j i n
b r b r
ε
ε
Δ = −
Δ = Δ
Δ = − = =
Δ = Δ
… …
 
where 
max
b
b
Δ
Δ , ibΔ  is the value of violation for the i-th 
constraint, and ε  is a small positive constant. 
1 5, ,p pw w…  are the weighting factors of the penalty 
term. 
V. STRUCTURE OF FLIGHT ROUTE PLANNER 
In the proposed flight route planner, a chromosome 
represents a candidate flight route which consists of all 
line segments. All flight routes within a population have 
the same start and goal points. Each individual is evalu-
ated by using the evaluation criterion and affected by the 
virtual potential field described above. 
It is expected that the objective function converges to 
its lowest value in the least number of generations. An 
objective value lower than the values caused by the con-
straint violation term ensures a feasible route for UAVs 
and a planned route with the lowest objective value be-
coming the one which possesses the shortest path, 
steadiest flight altitude and ensure the best security for 
UAVs. The process realizing the algorithm is illustrated 
in Fig. 1. 
VI. DEMONSTRATIVE RESULTS 
The developed route planner was tested in a simulated 
environment, in which the threats were randomly created. 
Settings for the route planner are as follows: 1cw , 2cw  
and 3cw  were set to be 10, 5 and 5 respectively; 
1 2 5, ,p p pw w w…  were equally set to be 10; the flight 
coefficients refh  were 6 km; the magnitude and the 
range of virtual potential field, jS , were set to be 1 km; 
the constraints for totalL , maxL , minL , maxH , minH , θ , 
α , and β  are, respectively, 30km, 2 km, 0.5km, 10 km, 
Proceedings of 2007 CACS International Automatic Control Conference 
 
Fig. 1.  Evolutionary route-planner based on the potential field 
 
 
 
Fig. 2.  Comparison of objective values for evolutionary planners and 
evolutionary planners with virtual potential field 
 
 
   
(a)                               (b)                                (c) 
  
(d)                               (e)                                (f) 
 
(g) 
Fig. 3.  Result of route planning for UAVs. (a) Randomly generate 
initial routes. (b) Result of the generation 1. (c) Result of the generation 
50 with a virtual potential field. (d) Result of the generation 100 with a 
virtual potential field. (e) Result of the generation 100 shown on the XY 
plane. (f) Vertical profiles of (d). (g) Objective value versus generation 
number. 
   
(a)                                 (b)                                 (c) 
Fig. 4.  Result of route planning for the UAV with constrained terminal 
direction of (0,1,0). (a) Result of route planning after 300 generations of 
evolution. (b) Vertical profiles of the route. (c) Objective value versus 
generation number. 
 
 
 
   
(a)                              (b)                               (c) 
Fig. 5.  Result of route planning for the UAV with constrained terminal 
direction of (1,0,0). (a) Result of route planning after 500 generations of 
evolution. (b) Vertical profiles of the route. (c) Objective value versus 
generation number. 
 
 
 
   
(a)                               (b)                                (c) 
.   
(d)                               (e)                                (f) 
 
(g) 
Fig. 6.  Result of route planning for the UAV detecting a new threat. (a) 
Result of the generation 100. (b) Result of the generation 100 in the 3-D 
space with a virtual potential field. (c) Result of the generation 110 in 
the 3-D space with a virtual potential field. (d) Result of the generation 
200 in the 3-D space with a virtual potential field. (e) Result of the 
generation 200. (f) Vertical profiles of (d). (g) Objective value versus 
generation number. 
characteristics when designing a controller. We 
describe the standard PID controller in the form: 
 
 P Iu K e K edt K e= + +∫ D  (1) 
 
     
where 
PK , IK  and DK  are scaling matrices 
corresponding to  and  respectively.  e e
 
 Fig. 1. Generalized PID control scheme 
 
Stability Criterion. The situation of SISO plants is 
considered with regard to the closed-loop system. 
First let the nominal plant model be factorized as 
( ) 1 ( ) ( )n p pP s D s N s−=  with the stable rational function 
matrices  and ( )pN s ( )pD s  constitutes the left-coprime 
factorization of . The controller  and the 
sensor dynamics is factorized as 
 with the stable rational 
function matrices 
( )nP s ( )C s
( )H s
( ) 1( ) ( ) ( )c cC s H s N s D s−=
( )cN s  and ( )cD s  constitutes the 
right-coprime factorization of ( ) ( )C s H s .  
 
The nominal characteristic equation for the closed-
loop system is given by 
 
  (2) ( )( ) det ( ) ( ) ( ) ( ) 0p c p cs D s D s N s N sΛ = + =
 
The stabilizing parameter space is characterized by 
 
                                          
 { }0 , ,  Re ( , , ) 0,P I D i P I DK K K K K K iλΨ ≡ < ∀  (3) 
 
where  denotes the root of the characteristic 
equation described by  
iλ
(3). The restricted, admissible 
controller parameter space can be denoted by the 
following equation under practical hardware 
limitation imposed on the device:  
                    
 { }, , , , , , , , 0, ,  , P I D P I D P I Dn P I D ij ij ij P I DK K K k k k KΨ ≡ ≤ ≤ ∈Ψ  (4) 
 
3. ES BASED PARAMETER OPTIMIZATION
 
ES is a stochastic optimization algorithm which 
works directly with the real representation of the 
parameter set from an initial population. The basic 
element processed by ES is a vector formed by all 
,P ijk , ,I ijk and ,D ijk . Each vector represents a point in 
the search space. The vector is evaluated to obtain 
the objective function value of an individual point. A 
set of w individuals denoted by S, called population, 
is first expressed as follows:  
 
 
 { }1 2, , , wS s s s= …  (5) 
 
For the current problem, the population set for w 
individuals is given by 
 
 { }, , , ,P I D wS k k k k= …  (6) 
 
where
1 1 1vec vec vec vec vec vec
TT P T P T I T I T D T D
n nk k k k k k kn⎡ ⎤=⎣ ⎦" " " , 
with the ‘vec’ operator being defined as 
, Tmmmmm ppppppP ][vec 1212111 …#…#…#…= m mP ×∈ ℜ . 
 
Selection of potential individuals. We first need to 
characterize potential individuals used for the 
solution search. For SISO cases, the suitable 
parameter space for system stability can be separated 
from the parameter space by using the root contours 
technique. Individuals of S are selected randomly 
from the suitable parameter space by the ES 
mechanism. 
 
Evolution strategy (ES). The concept of ES is to 
represent an individual as a pair of float-valued 
vectors ( )( )2, 0,iv k N σ= . The first vector ik  
represents a point in the search space. The second, 
( )20,N σ represents a vector of independent random 
Gaussian numbers with zero mean and standard 
deviation of σ . The search of new points is based on 
one operator, i.e. the mutation operator.  
 
In ( ),w λ  ES, the search begins by generating w  
parents in each generation. Then λ  offspring are 
generated by mutation, resulting from addition of 
random numbers, and it is assumed that wλ > . Each 
mutant is subjected to the constraints imposed. The 
non-feasible one is eliminated. Selection of the 
qualified mutant is performed until all members are 
feasible. Next, the λ  members are sorted according 
to the magnitude of the objective function values. 
Then the w  best individuals of the λ  members 
generated become the parents of the next generation. 
Note that the offspring (mutant) is accepted as a new 
member of the population if and only if it has better 
fitness. Otherwise, the offspring is eliminated, and 
the original parent remains. To realize the previous 
descriptions, we characterize the mutations by 
replacing the individual 
ik  by 
 
 ( )( 1) ( ) 20, , 1, , , 1, ,g gij ijk k N i w jσ+ = + = =" " l  (7) 
 
where g is the index of the generation number.  
 
Fitness function design. Operation speed of the 
computer is related with the number of individuals in 
a population. Therefore, it is necessary to either 
  
( )
( ) ( )( )2 ta a a a a t b
s K
e s s L Js L D R J s R D K K
θ
η= ⎡ + + + +⎣ ⎤⎦
 (19) 
 
where 
:  applied armature voltage, V
:  aramature curretn, A
:  field current, A
:  equivalent viscous coefficient of the motor
   to the motor shaft, N-m/rad/sec
:  equivalent moment of inertia of the motor 
a
a
f
e
i
i
D
J
2
and load
   referred to the motor shaft, kg-m
:  back emf constant, V/rad/s
:  Torque constant, N-m/A
:  aramature inductance, H
:  armature resistance, 
:  torque developed by the motor, N-m
:  gear r
b
t
a
a
K
K
L
R
T
η
Ω
atio of speed reducer
:  angular displacement of the motor shaft, radθ
 
 
aLaR
ai T J
θ
D
bKae
 constantfi =  
     
Fig. 2. Schematic diagram of MBDCM 
 
We choose the MBDCM parameters according to the 
data acquired from an experiment platform for the 
MBDCM control system provided by the Pittman 
Express Company listed in Table 1.  
Table 1 Specifications of MBDCM 
 
Specification Value/Status 
Torque Constant ( )tK  4.86E-02 N-m/A 
Back-EMF Constant ( )  bK 4.86E-02 V/rad/s 
Resistance ( )aR  9.32 (Ω) 
Inductance ( )aL  1.16 (mH) 
Equivalent moment of 
inertia of the motor ( )J  
1.4E-06 (kg-m2) 
Equivalent viscous 
coefficient  ( )D
2.5E-06 (N-/rad/s) 
Reference Voltage 38.2 (V) 
No-Load Speed 775 (rad/s) 
Gear ratio of speed reducer 1/46 
 
The environment conditions are chosen with 
consideration of the physical property. We first 
implement the controller in MATLAB to verify the 
asymptotic tracking performance before actual 
system implementation.  The term 
t bK K  is usually 
smaller than other constant terms so that it may be 
neglected. The following plant model is obtained 
 
 ( ) ( )8 2
0.0486
7.47 10 0.0006 0.1097
P s
s s s−
= ⋅ + +  (20) 
The constraint 29.285 HzBω ≤  is implemented to 
avoid noise corruption, where Bω  denotes the 
bandwidth. Next, consider the frequency domain 
specifications. The sensitivity function eliminates 
steady state error and the control energy function 
avoids excessive control energy emergence in the 
system loop which may result in burning the 
FPGA/CPLD chip. The weighting functions of the 
sensitivity function and the control energy function 
were justified by equations (11) through (14) and 
were chosen as follows 
 
2
2
2
0.05 22.36 2500
3.196 2.5
5000
10 100
s
r
s sW
s s
W
s s s
+ += + +
= + +
 (21) 
 
On applying the ES for parameters search, the 
parents’ population consists of 15 individuals; they 
are initially randomized. The offsprings are mutated 
in normal distribution and their number is 7 times to 
the parent generation. The number was numerically 
verified to be able to find out the optimal solution. 
The parameters of the fitness function defined in (8) 
are chosen as follows: 
 
 1 2 3 1 2 30.4, 0.2, 4, 1n n nε ε ε= = = = = =  
 
Based on the characteristic equation in of the closed-
loop system, the root contours for various values of 
, ,  and P Ik k kD  are drawn in Fig. 3. It can be easily 
seen that the stabilizing ranges of , ,  and P I Dk k k  are 
characterized by 
 
0,  0,  0P I Dk k k> > >  
 
 
Fig. 3 Root contour of the corresponding system 
 
Performing the developed searching algorithm for 
150 generations of the population, we obtain the 
controller parameters: 
 
6.9778, 0.00461, 0.08261P I Dk k k= = =  
 
and the PID controller is applied: 
 
 ( ) 20.08261 6.9778 0.00461s sC s
s
+ +=  (22) 
 
     
After receiving control signals, CPLD sends a 3-
phased signal to the motor driving circuit which 
sends a 6-phased signal to drive the motor.  
 
5. CONCLUSIONS 
 
This paper proposes a robust control design which 
possesses the advantages of high performance, 
miniaturization and low cost to construct the servo-
driving system for MBDCMs. The proposed control 
scheme has achieved the requirements of precise 
positioning control, which is proved via simulation 
and experimental verifications. The excellent 
experimental results show that it is practically 
realizable and reliable.  
 
ACKNOWLEDGEMENTS 
This research was sponsored by National Science 
Council, Taiwan, R.O.C. under the Grant NSC 93-
2212-E005-005. 
 
REFERENCES 
 
D. Jouve, J.P. Rognon, and D. Roye(1990). Effective 
Current and Speed Controllers for Permanent 
Magnet Machines: A Survey. In: Conf. Applied 
Power Electronics and Exposition, pp. 384-393. 
H. Butler, G. Honderd, and J. van Amerongen(1989). 
Model Reference Adaptive Control of a Direct-
Drive DC Motor. IEEE Contr. Systems 
Magazine, vol. 9, pp. 80-84. 
I.C. Baik, K.H. Kim, and M.J. Youn(2000). Robust 
Nonlinear Speed Control of PM Synchronous 
Motor Using Boundary Layer Integral Sliding 
Mode Control Technique. IEEE Trans. Contr. 
Systems Technology, vol. 8, pp. 47-54. 
M.P. Kazmierkowski, and L. Malesani(1998). 
Current Control Techniques for Three-Phase 
Voltage-Source PWM Converter: A Survey. 
IEEE Trans. Ind. Elect, vol. 45, pp. 691-703. 
K. Zhou, & J. C. Doyle(1998). Essentials of robust 
control. Prentice Hall, New Jersey. 
K.S. Low, and Z. Hualiang(2000). Robust Model 
Predictive Control and Observer for Direct 
Drive Application. IEEE Trans. Power Elect., 
vol. 15, pp. 1018-1028. 
M. Iwasaki, N. Matusi(1993). Robust Speed Control 
of IM with Torque Feedforward Control. IEEE 
Trans. Ind. Elect., vol. 40, pp. 553-560. 
R.A. Mammano, and J.J. Galvin(1989). Driving 
three-phase brushless DC motors-a new low loss 
linear solution. In: Conf. Proc. Applied Power 
Elect. Conf. and Exposition, pp. 75-80. 
 
fluctuation between the droppers is neglected. It was 
shown in (Wu and Brennan, 1997) that the time-
varying stiffness  can be expressed as ( )P t
 ( )0 3 0
max min
0 max min
max min
2( ) (1 cos ) ( ) ,
1 ( ),   
2
V
0 3P t k t y k k t yL
k kk k k
k k
πα
α
⎡ ⎤= + = + Δ⎢ ⎥⎣ ⎦
−= + = +
 (1) 
where  is the average stiffness,   denotes 
the uncertain stiffness and 
0k 0 ( )k tΔ
α  is the stiffness 
variation coefficient in a span,  and  
represent the maximum and minimum stiffness of the 
overhead wire in a span, respectively; the time-
varying stiffness of the catenary is related to the 
vehicle travelling speed V ; 
maxk mink
L  is the length of one 
span. 
     
 
Equations of motion of the pantograph model can be 
lumped into a second-order matrix equation:  
 Mq Cq Kq u+ + =   (2) 
where the generalized coordinates vector is 
, the inertia matrix, the damping 
matrix, the stiffness matrix, and the control vector 
are, respectively, defined as 
3 2 1[
Tq y y y= ]
F
( ) ( ) ( )a a a t sF F F F k y y c y y k y y c y
3 2
3 2 1 3 2 3 2
2 1 2
3 0 0 3
3 2 3 2 3 2
2 1 2
0
 ( , , ) , ,
0
( ) 0
 ,  
0
T
up
c c
M diag m m m C c c c c
c c c
k k k k
K k k k k u F F
k k k
−⎡ ⎤⎢ ⎥= = − + −⎢ ⎥⎢ ⎥− +⎣ ⎦
+ + Δ −⎡ ⎤⎢ ⎥ ⎡ ⎤= − + − = ⎣ ⎦⎢ ⎥⎢ ⎥− +⎣ ⎦
 
where the upper mass  represents the pan-head, 
the middle and lower  masses represent the 
plunger and frame arms, respectively;  and 
 are lift forces by aero force at high speeds; 
 is the static uplift force applied to the 
pantograph;  represent the stiffness of pan-
head suspension, the plunger suspension, and the 
frame suspension, respectively;  represent the 
viscous damping of the pan-head suspension, the 
plunger suspension, and the frame suspension, 
respectively. Aiming at achieving the minimum 
vibration, the parameters , , , ,  and  
closely connected to the objective have to be finely 
tuned. 
3( )m
2 1( , )m m
2 ( )F t
3 ( )F t
1( )F t
3 2 1, ,k k k
3 2 1, ,c c c
1k 1c 2k 2c 3k 3c
 
3. DESIGN OF ACTIVE PANTOGRAPH SYSTEM
 
To achieve best contact effect, it is necessary to 
cancel the forces caused by the passive springs and 
dampers, which act on the pan-head resulting in 
heave accelerations. For the active control design, 
the active forces are generated with equal magnitude 
but in opposite direction to the passive forces so that 
the pan-head is completely isolated from the plunger. 
 
According to the force cancellation, the pantograph 
is separated into two subsystems: pan-head and 
plunger. By observing the dynamic equations, after 
force cancellation, the pan-head act like a double 
integrator without damping and hence is inherently 
unstable. To stabilize the vehicle motion, it is 
necessary to measure velocities of the pan-head with 
respect to the inertia frame. This is named as the 
skyhook damper. For the optimization of suspension 
working space, the distance between pan-head and 
track should also be fed back to maintain the 
reasonable ranges among pan-head, plunger, and 
track, and to make the vehicle’s pantograph follow 
the tendency of the track profile. This is the track-
following spring. The desired control configuration is 
illustrated in Fig. 3. The active control law can be 
summarized as follows 
 
33 1 2 3 3 3 2 3 3 2 3 1+ + = − + − − − −   (3) =
 
A. Performance objectives 
Traditional pantograph suspension system designs 
can only deal with the static deformations, they fail 
to obtain the dynamic deformation between of the 
pantograph and contact wire. In practice, the 
pantograph system is severely influenced by the 
irregular rail surface which may cause vibrations and 
deteriorate quality of transmission of electricity to 
vehicles. The individual objective functions 
considered are given as follows 
 
2 2 2
1 1 2 3
1
2 3 21
3 2 11
4 11
1 ( ) ( ) ( )
3
max ( ) ( )
max ( ) ( )
max ( )
N
j
j N
j N
j N
J y j y j y j
N
J y j y j
J y j y j
J y j
τ τ τ
τ τ
τ τ
τ
=
≤ ≤
≤ ≤
≤ ≤
⎡ ⎤= + +⎣ ⎦
= −
= −
=
∑   
 (4) 
where N is the number of sampling cycles for 
measuring the related transient signals, τ  is the 
sampling period. To achieve the better power 
transmission, the suspension length should be 
optimally tuned to absorb the fluctuations caused by 
the contact wire irregularity and the stiffness 
fluctuation of the caternary. 
 
Since the suspensions can only move within the 
available travelling ranges, therefore, the following 
constraints should be imposed: 
 ( ) , 2,3,i i ig J b i 4= ≤ =  (5) 
 
B. Optimal robust control design 
Robust stability analysis considers the effect of time-
varying stiffness resulting from the uneven overhead 
wire. The perturbed system model is given as follows
 ( ) ( ( )) ( )x t A A t x t B
u Gx
= + Δ + u
= −
   (6) 
where G  is the feedback control gain matrix and 
3 3 3 3 3 3
1 1 1
0 0
,   ( , )
( ) 0
I
A A x t
M K M C M K t
× × ×
− − −
0⎡ ⎤ ⎡= Δ = ⎤⎢ ⎥ ⎢− − − Δ ⎥⎣ ⎦ ⎣
 
⎦
 
in which  is the uncertain part of ( , )A x tΔ  A , which 
corresponds to changes of uneven stiffness of the 
overhead wire. 
 
The plant uncertainty can be further 
decomposed as 
( )A tΔ 
 ( ) ( )A t B tΔ = Δ  (7) 
The process is summarized in the follows. 
Step 1 (generate mutants): Randomly generate the 
mutants , 1,...,gix i λ=G  by using (20) and subject to 
(21). 
Step 2 (preliminary screening): Calculate the 
adaptable average fitness level from the parent 
individuals 
 
1
2
1
11 ln ( )
g w
pg g
ig
ip
N
f x
N w
−
−
=
⎛ ⎞Ψ = +⎜ ⎟⎜ ⎟⎝ ⎠ ∑
G  (22) 
where we have defined  as the set of superior 
individuals passing the preliminary screening: 
( )g pΩ
{ }( ) ( ) , 1, ,g g g gi ip x f x i λΩ ≡ ≥ Ψ =G G  …  
with  being the number of 
elements in 
( ( )g gpN Num p= Ω
     
)
gΩ  and p denoting the qualified mutants.  
Step 3 (gradient search): First, determine the 
gradient ( )g gif x∇ G  for the individuals belonged to 
: ( )g pΩ
 ( ) ( ) ( ) ( ) ( ) ( ) ( )
1 1 2 2 6 6
, , ,
                                                                    ( ), 1, ,
T
g g g g g g
i i i i i ig g
i g g g g g g
i i i i i i
g g g
i
f x f x f x f x f x f x
f x
x x x x x x
x p i N
⎡ − − −⎢∇ − − −⎢⎣
∈Ω =
G G G G G G  G  "G G G G G G  
G … p
⎤⎥⎥⎦
  
Next, pick out the mutants with their corresponding 
gradient ascents lying between  and ShS φ : 
 ( ){ }( ) , 1, ,g g g gi i hp x S f x S i MφΘ ≡ ≤ ∇ ≤ =G G … gp  
with ⋅  being some vector norm. The number of 
elements in  is denoted by ( )g pΘ ( ( ))g gpM Num p= Θ  
with p  denoting the qualified mutants. 
Step 4 (elitism): The g
pM  mutants of 
g
ix
G  and the w  
parent individuals of g
jx
G  are sorted according to the 
magnitude of their fitness values defined. The w  
bests of the gpM w+  members, denoted by 1gix +G , are 
sorted out and kept as the parents for the next 
generation.  
Return to Step 1, selection of the qualified mutants is 
performed until all members are feasible. When the 
stopping condition is reached, an individual with the 
highest fitness in the converged population is picked 
up. A graphical illustration of the EGA is displayed 
in Fig. 4. 
 
5. RESULTS AND DISCUSSIONS 
 
Vibration analyses of the pantograph-catenary 
system are performed in the time domain. The 
catenary is treated as an uncertain time-varying 
system due to the time-varying stiffness. We suppose 
that the distance between each supporter is one unit 
of span. Accelerations at the pan-head , plunger 
 and frame arm  are measured.  Duration of 
the computer simulations is 10 s. For the EGA, the 
population size of individuals is taken to be 100. 
Two hundred generations are executed to validate 
convergence of the fitness function. 
3( )m
2( )m 1( )m
 
-Case 0 (nominal parameter design) 
Simulation has been carried out on the basis of the 
pantograph catenary model with the parameters given 
in (Corriga et al., 1994). The overall acceleration of 
the pantograph system is 1.9259 m/s2 (r.m.s.). In the 
following cases, the active control strategy will be 
adopted to reduce the acceleration of pantograph-
catenary system and compromise the deflection of 
suspensions. 
 
-Case 1 (passive pantograph design)  
Consider the passive pantograph parameters which 
are restricted to the range from 80% to 120% of their 
nominal values in Case 0 to examine vibration of the 
overhead wire and check whether the natural 
frequency of pantograph mass still meets the 
specification. It is found that the overall acceleration 
in the passive pantograph system reduces to 1.3745 
m/s2 (r.m.s.). However, this only shows a slight 
performance improvement.  
 
-Case 2 (active pantograph design) 
We combine the EGA with the optimal robust 
controller. The overall acceleration of pantograph 
system has been further reduced to 0.4804 m/s2 
(r.m.s.). Consequently, the overall vibration is 
significantly improved by 75.56%. Obviously, all 
deflections of the suspensions are enlarged; however, 
they are still within the allowable ranges.  
Figure 5 illustrates convergence of the fitness 
functions for the passive and active vibration control 
designs using the proposed optimization scheme. It is 
seen that the active pantograph gets the final fitness 
value of 2.5007 whereas the passive design gives 
only 1.5757. This demonstrates distinctive 
performance in solving the complicated constrained 
multiobjective optimization problem with our 
proposed approach. Figure 6 shows the resulting 
pantograph vertical accelerations for different 
suspension designs. 
 
6. CONCLUSIONS 
 
We show that force cancellation, skyhook damper 
and track-following spring can be jointly applied to 
construct an active vibration control system for the 
vehicle’s pantograph. Determination of the 
suspension parameters is assisted by a systematic and 
effective optimization scheme where the 
evolutionary-gradient algorithm serves as an efficient 
solution search tool. Simulation results are presented 
to illustrate the proposed design.  
 
ACKNOWLEDGEMENT 
This research was sponsored by National Science Council, 
Taiwan, R.O.C. under the Grant NSC 94-2213-E005-013.  
 
REFERENCES 
 
I. Yuki, T. Thomas & H. Mikio, Modeling and 
simulation of a molded pantograph mechanism 
with large-deflective hinges and links. Proc. of 
11th World Congress in Mechanism and 
Machine Science, Tianjin, China, 2003, 1437-
1441. 
     
 
 
 
 
 
 
 
 
 
 
 
 
 
 
SOLVING CROSS-COUPLING PROBLEM WITH ARTIFICIAL NEURAL NETWORK FOR A 
DUAL-AXES MOTION PLATFORM 
 
 
Horn-Yong Jan1, Chun-Liang Lin2, Thong-Shing Hwang3 and Ching-Huei. Huang4
 
 
1 Research Assistant, Graduate Institute of Electrical and Communications Engineering, Feng Chia University, 
Taichung 40724, Taiwan, R.O.C. E-mail: p9112206@.fcu.edu.tw 
2 Corresponding author, Professor, Department of Electrical Engineering, National Chung Hsing University, 
Taichung 402, Taiwan, R.O.C. E-mail: chunlin@dragon.nchu.edu.tw
3 Professor, Graduate Institute of Electrical and Communications Engineering, Feng Chia University, Taichung 
40724, Taiwan, R.O.C. E-mail: tshwang@.fcu.edu.tw 
4 Graduate Student, Department of Electrical Engineering, National Chung Hsing University, Taichung 402, 
Taiwan, R.O.C. E-mail: a5123933310@yahoo.com.tw 
 
 
 
 
This paper presents a new approach to deal with the dual-axes control design problem for 
a two-input two-output motion platform. The cross-coupling problem of the platform is 
effectively solved by a neural net-based decoupling compensator. A sufficient condition 
ensuring closed-loop stability is presented. An evolutionary algorithm possessing the 
universal seeking capability is proposed for finding the optimal connecting weights of the 
neural compensator and the gains of X-Yaxes controllers. Extensive numerical study 
verifies performance and applicability of the proposed design under a variety of operating 
conditions. 
 
Keywords: Decoupling control; Multi-objective optimization; Evolutionary algorithms; 
Linear motor; Neural network. 
 
 
 
 
 
 
2.1 Robust stability 
 
Seeking for the optimal connecting weights of the 
ANN and six PID control gains is the key issue to be 
tackled. Before addressing it, a condition ensuring 
loop stability when there is in the presence of the 
compensation error for the cross-coupling effect is 
derived. The condition is used as a constraint while 
determining related parameters. 
Referring to Fig. 4, let us only focus on the X axis 
control system with the coupled perturbation 
illustrated in Fig. 5. 
The plant input is  'u u d= +
Where  is the control command and d  is the 
decoupled command defined by 
cx xu G e= ( ),x yd f e e=                               
where
                                                                                          
( ), ( )x y x c x x y yf e e C C C e C e= +      
Suppose that there is a constant gain  so that ck
( ),x yf e e  is within a conic sector:  
( ) 2 22,x y c x x x y yf e e k e e eγ γ− ≤ +                            
 
2.2 Evolutionary strategy     
 
We choose ESs for seeking the feasible connecting 
weights of the neural network and six PID control 
gains from the permissible solution space. The idea of 
evolution strategies (ES, (ω,λ)) is to represent an 
individual as a pair of float-valued 
vector ( )( )2, 0,ik Nυ = σ , where ik  represents a point 
in the search space and ( 20,N )σ  consists of 
independent random Gaussian numbers with zero 
mean and the standard deviation σ . 
The search starts by generating ω  parents in each 
generation. Then, λ  offsprings are generated by 
mutation, as a result of the addition of random 
numbers. It is assumed that λ ω>  where lλ ω= . 
Note that each mutant is subjected to the constraints 
imposed. The non-feasible one is eliminated first. 
Selection of the qualified mutants is performed until 
all members are feasible. Next, λ  members are 
sorted according to the magnitude of the prespecified 
objective function. The offspring (mutant) is accepted 
as a new member of the population if and only if it 
has better fitness. Otherwise, the offspring is 
eliminated, and then the original parent remains. 
Finally, there are ω  members of the λ  mutants are 
collected as the parent individuals for the next 
generation. This is also called as the competitive 
selection. 
To utilize the depicted ES, the individual ik  of a 
generation consists of six PID control gains and all 
connecting weights of the ANN which is defined by  
, ,,  ,  1,...,i i PID i NNk k k i ω⎡ ⎤= =⎣ ⎦  
where 
( ) ( )
( ) ( )
, , , , , , ,
( 1)( )
, , 1 ,
,1 1
     
vec ,vec ,
            vec ,vec , 1, , ,  1, , ,  1, , 1
i PID i Px i Ix i Dx i Py i Iy i Dy
T in T
i NN i j i kj
T out T bias
i k i
k k k k k k k
k w w
w w j j k j
μ μ
μ μ μ
+
+
⎡ ⎤= ⎣ ⎦
⎡= ⎣
⎤ L= = =⎦
 
" " " −
 
The mutants are generated by replacing the 
individuals 
ik  by 
( )( 1) ( ) 20, , 1, , , 1, ,g gij ijk k N i j jμσ ω+ = + = =" "                                         
where jμ  is the number of neurons per layer, g is the 
index of the generation and L is the number of hidden 
layers. An appropriate choice of the variable standard 
deviations will speed up the convergence of the 
evolution-searching algorithm to the global minimum 
of the cost function. Fixed standard deviations may 
encounter the situation of difficulty that the search 
cannot escape from the local solution. However, 
using variable standard deviations by generations can 
make the search more effective.
 
2.3 Fitness function design 
 
The suitability of a valid parameter vector is defined 
by the fitness function denoted ( )iO k . Combination of 
the neural network’s weights and PID control gains 
forms an individual of the ES. The optimal solution is 
to be determined via the ES-based optimization 
process with respect to the full operating range (in 
terms of the operating angles) of this dual-axes 
system. The following fitness function is defined: 
( )
2
0 1 2 3
1
( )
exp
xy j j j j j j
j
z C z Err z Tr z Os
iO k
=
⎛ ⎞⎜ ⎟− + + +⎜ ⎟⎝ ⎠
∑=  
where jz  is the weighting factor with respect to the 
jth performance index;
jErr , jTr and jOs  are the 
normalized performance indices of steady-state error, 
rise time and maximum overshoot for X and Y axes; 
xyC denotes the cross-covariance between the coupled 
subsystems:  
20 0 0
1 1( ) ( ) ( ) ( )f f
t t t
xy
f f
C x t y t dt x t dt y t dt
t t
= −∫ ∫ ∫ f  
The process is suggested as follows: 
a. Initially, a population of ω  parent solutions 
, 1, ,ik i ω= "  are chosen based on the selection 
criterion. 
b. Each parent creates an offspring ik ′ , where ik ′  is 
determined by ( )20,i ik k N σ′= + , rασ σ′ =   
where the exponent ( 2~ 0,N )α σΔ  denotes the 
normal distribution with mean zero and variance and 
σΔ  is the difference of σ  between the last two 
generations.  
c. Perform the closed-loop system simulation for the 
step input with respect to each offspring. Each 
offspring solution 
ik ′  is scored in light of the 
constrained fitness function iO .  
d. Each solution ( )1, ,ik i λ′ = ⋅⋅⋅  is evaluated against 
other randomly chosen solutions from the population. 
For each comparison, a ‘winner’ is assigned if its 
score is larger than that of its opponent. 
     
motion control system. 
 
dxP
dyP + −
+
−
−
+
+ −
++
yC
xC
cyG
cxG
cC
ε y
C
xC
pyG
pxG
y
x
ye
xe
Fig. 4. Configuration of the dual axes cross-coupling 
control system. 
 
dxP +
−
−
+
+
yC
xC
cxG
cCε
yC
xC
pxG
x
ye
xe
ck
ck
+ − +u
d
'u
 Fig. 5. Single axis control system used for  
       determining the stability condition 
 
 
(a) 
 
(b) 
Fig. 6. Step responses of (a)X axis and (b)Y axis 
driving loops with the ANN decoupling 
compensator while 15θ = degrees. 
 
0 10 20 30 40 50 60 70 80 90 100
180
190
200
210
220
230
240
250
260
270
280
The comparison of curve trajectory tracking
X-axis displacement (mm)
Y
-a
xi
s d
is
pl
ac
em
en
t (
m
m
)
Desired Path
With ANN decoupling compensator
moving direction
50.05 50.055 50.06 50.065
201.215
201.22
201.23
201.235
0.6 mμ201.225
Fig. 7. Comparison of curve trajectory tracking with 
ANN decoupling compensation from -90 to 0  
degrees. 
90 100 110 120 130 140 150 160 170 180 190
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
149.7149.75 149.8 149.85 149.9 149.95 150 150.050.009
0.01
0.011
0.012
0.013
0.014
0.015
0.016
27 mμ
 
 (a) 
0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 2
180
190
200
210
220
230
240
250
260
270
280
Y
-a
xi
s d
is
pl
ac
em
en
t (
m
m
)
The contour error of X-axis  (mm)
0.048 0.05 0.052 0.054 0.056 0.058 0.06 0.062
269.8
269.9
270
270.1
270.2
270.3
270.4
45 mμ
(b) 
Fig. 8. (a)(b) Contour error of Y axis (X axis) with 
ANN decoupling compensator while the moving 
displacement on X axis (Y axis) is fixed for the 
curve tracking from -90 and 0 degrees. 
 
 
     
出席 2006 年 ICC 國際控制學術研討會心得報告 
 
國立中興大學電機工程學系   林俊良 教授
 
摘  要 
2006年國際控制工程學術研討會(International Conference Control 2006)是由格拉斯哥大學和史
崔克萊大學(University of Glasgow and University of Strathclyde)兩所英國知名大學及IEEE UK 
& RI Industry Applications Chapter、Advanced Control Technology Club、Institute of Measurement 
and Control (IMC)、Institution of Engineering and Technology、Institute of Mechanical Engineering
共同主辦，並由世界各國頂級之控制界學者專家共同與會進行口頭報告論文及交流研究經
驗，係全歐洲最重要的控制相關領域研討會之ㄧ。今年大會由格拉斯哥大學Dr. David 
Murray-Smith 與史崔克萊大學 Dr. Bill Leithead共同擔任此會議主席，會中邀請到機械與航太
控制理論知名大師Prof. Robert Bitmead與國際控制理論知名大師Prof. Peter Fleming等擔任專
題演講，目前分別任職於 Department of Mechanical & Aerospace Engineering, University of 
California, San Diego, USA 與 Department of Automatic Control and Systems Engineering 
University of Sheffield, Sheffield, UK；其中Prof. Peter Fleming 其主要研究領域為適應控制、神
經網路、模糊控制等等方面，目前是IEEE Fellow以及澳洲技術研究院的研究員之一。 
本次會議，計有全球20多個國家約120篇論文獲選與會進行報告。正式會議於英國蘇格蘭
格拉斯哥大學和史崔克萊大學，自八月三十日起舉行三天。今年會議重點在於針對控制理論，
控制系統設計與應用為主要的議題。此會議最重要的特色是全部的議題都是關於控制理論方
面，全世界唯一單純控制領域的國際型會議，其包含控制理論(Control theory)、數位控制(Digital 
control system analysis and design methods)、離散系統控制(Discrete event systems in control)、非
線性控制系統(Nonlinear control systems)、生物演算法控制(Biological control systems and 
biomedical applications of control)、智慧型控制(Artificial neural networks in control, Fuzzy 
systems methods for control)、飛行控制(Aerospace and aeronautical applications)、預估控制
主要在處理於不確定環境下針對特定座標物理系統(Coordinated System)利用所設計之預估
控制進行位置估測。演講中首先提出四條船舶機構系統，當有不確定外在環境因素(External 
Disturbances)或輪機本身的干擾(Noise)產生時，利用作者所提出的估測控制進行不同情形
下的位置估測。 
首先，Prof. Robert Bitmead先說明何謂座標控制(Coordinated 
Control)；初步假設有一多目標互聯之運載交通工具 (Multiple 
Vehicles)，其主要研究目的為估測其物理系統目標(Target)、位置
(positions)；當遇到外在擾動時(External Disturbances)，所設計的控
制法則，是否有足夠的回授增益(feedback gains)進行抑制並有效控
制系統的性能(Performance index)；除此之外作者考慮一種非衝突
性限制條件(No-Collision Control)與一些常用估測法則(Estimate)進
行估測控制器設計；並且利用LMI(Linear Matrix Inequalities)理論求解非線性系統之解；最後
將針對各分散式子系統的各項資訊，串接起來成為一個完整的互聯系統以進行控制。演講中
介紹所設計之模式估測控制理論(Model Predictive Control Approach)為:  
{ }, 1 , , 1
1
, ..., , arg min
N
k i i T i i T i T
i k k N k k j k k j k k j k j
j
u u x Q x u Ru+ − + + + + −
=
⎡ ⎤= +⎣ ⎦∑  
這是一種卡爾曼更新法則(Kalman Update)；此外本身狀態估測(Own State Estimate)可設計
成:  
){ }
1, , ,  ,  0,..., 1
where Pr ,   Pr: Collision Constraint
i i i
k j k k j k k j k
i l
k j k j
x Ax Bu j N
x x rα
+ + + +
+ +
= + = −
⎡ ⎤− < <⎣ ⎦

 
此外並設計相關限制條件與估測法則如下 
1. No-Collision Constraint : / /ˆ ~ ( ,  )
i i i
k j k k j k j kx N x+ + +Σ  
2. Gaussion Estimate : , / , /ˆ ~ ( ,  )
l l l
i k j k k j i k j kx N x+ + +Σ  
3. Cross Estimate ⇒  Probabilistic No-Collision Constraint : ( )Pr i lk j k jx x α ε+ +− < <  
Implied by / / max / , /ˆ ˆ ( )
i l i l
k j k k j k k j k i k j kx x α β λ+ + + +− > + Σ +Σ , 
建議 
在未來中我們可以重視實務的應用，配合所提出的控制理論，將會使研究更完整；此外
並舉辦大型會議，提供學術合作及交流，只要持續努力，在台灣所受的訓練及教育也會有不
凡的表現。而筆者也希望學校可以多多鼓勵學生出國參加國際會議，對學生而言參加國際性
會議，不但可以增廣見聞還可以加強英文口語及聽力。  
由於本會議發表地點為蘇格蘭格拉斯哥大學，當地交通便捷且氣候適宜，與會來賓相當
踴躍；會場中也看到許多大型廠商舉辦的多場workshop及許多控制領域相關書商所帶來的書
籍資訊，使會議會場中添加許多學術交流之氣息，是一場相當盛大的國際型會議。 
總之，本次研討會議程安排相當緊湊，筆者在三天的與會過程中，聆聽了約十幾場次的
論文發表，由這些國際知名學者及專家所發表之論文獲得相當多的啟發，許多現場激發出來
的研發創意，將是筆者未來一年可資採行的研究論題。 
 
 
(Predictive control) 、最佳化控制(Optimal control)世界上所有控制領域幾乎都包含在內，是一
次相當難得純粹屬於控制領域的國際研討會；此外由主要議題衍生跨領域(multidisciplinary)、
聲學與振動控制(Active sound and vibration control)、硬體控制(Control hardware)、分散控制
(Distributed control)、隨機控制(Stochastic control)等主題。 
 
參加會議經過 
筆者於八月三十日至九月一日赴英國蘇格蘭格拉斯哥參加第一屆國際控制工程學術研討
會(International Conference Control 2006) 係由格拉斯哥大學和史崔克萊大學(University of 
Glasgow and University of Strathclyde)兩所英國知名大學及IEEE UK & RI Industry Applications 
Chapter、Advanced Control Technology Club、Institute of Measurement and Control (IMC)、
Institution of Engineering and Technology、Institute of Mechanical Engineering共同主辦。該研討
會以廣邀全球從事相關控制工程研究的學者及專家發表論文、交換研究心得及介紹前瞻控制
工程發展及系統識別為主要目的。該學術研討會於英國蘇格蘭格拉斯哥(Glasgow)舉行。會議
地點位於中格拉斯哥大學和史崔克萊大學(University of Glasgow and University of Strathclyde)
兩所知名大學中。此會議場所是蘇格蘭兩所知名工程領域的大學，其議程於內部大型研討室
中舉行。本次此次投稿之論文近五百餘篇，發表之論文篇數亦高達約三百餘篇，如同一般研
討會本次會議進行時為多軌同時舉行，主要涵蓋有四十多種類電機控制相關領域。在三天會
議中可藉由直接面對面與作者進行口頭討論與交流，可以很快的解開自己有疑問的地方，受
益良多。 
筆者與研究生一行於八月二十八日晚上19:40從台灣出發，經過香港、慕尼黑、倫敦轉機，
經過三次辛苦的轉機及20小時的飛行時程中，終於在八月二十九日下午2:00左右抵達目的地
Glasgow Airport。 
八月三十日至九月一號的三天正式議程中，大會於三十日上午9:00~10:00之時段，安
排了一場邀請演講。由來自美國加州大學聖地牙哥分校之機械與航太工程系所著名探討適
應性控制與預估控制理論出名的大師級教授 Prof. Robert Bitmead介紹其最新的研究成果: 
Constrained Control & Communications Resource Assignment in Coordinated Systems。該論文
2 2( ) 1 ,   :  disturbution with d d xβ ε αΨ ≥ − Ψ −  
其中作者設計第三種估測法則(Cross Estimate)藉由LMI(Linear Matrix Inequalities)理論求解非
線性系統之解，此LMI理論亦可設計系統之穩定性 (Stability)、控制性能表現 (Control 
Performance)等等。本演講Prof. Robert Bitmead利用具有拘束條件座標系統下進行估測控制，
利用所提出的估測法則加上LMI理論的概念；使其當處理具有干擾抗拒的系統時，能利用LMI
理論求得系統性能達到所需的範圍內，針對干擾能有較佳的抑制能力，不會因外擾而影響到
本體之穩定性，且能使系統具有強漸穩定性。對於這個問題，目前許多論文中皆是利用降階
法簡化其系統模式，再利用所謂的智慧型控制方法，例如：類神經網路(NN)和模糊邏輯(Fuzzy)
等智慧型演算法進而求解出所需的系統性能指標(Performance index)；但由於為了簡化其運算
過程，往往忽略某些部份的考量。因此，Prof. Robert Bitmead 除了提出精闢的觀點並提供理
論的框架及基本定律，利用傳統預估控制中的機率數學概念及LMI理論探討系統性能與穩定性
的問題，其方法可使所求得的答案更趨於真實系統達到更精闢的解，更可利用數學提出更強
而有力的証明及解釋，這些嶄新的概念將對於未來學術研究中處理系統具有擾動、不確定模
式發生時甚有幫助。但是由於內部牽扯許多數學概念，筆者認為以數學推導解決此類問題時
雖然更近似系統的模式狀態，但計算處理過於複雜不好實際應用於硬體上，並不適於大部分
需要精確數值描述的工程系統，這些概念或許更適於純粹數理上的推導及應用。對於大會所
精心安排的各項議題，與會學者專家咸認為獲益匪淺，更重要者，這些議題對於從事控制工
程研究者從事前瞻性研發時相當具有啟發性。 
 
與會心得 
在本次會議中，我們共發表三篇論文，本人也受邀擔任 Session 5 “Real-time control” 主
席。筆者本次被大會安排在八月三十日於”Artificial neural networks in control”小組進行口頭論
文報告。論文報告過程中，筆者與小組主席 Prof. David Owen及台下與會教授進行了即席詢答
與討論。此位國際知名之學者認同筆者之立論，咸認為該理論之正確性無庸置疑，而筆者也
由大師所提出之問題中發覺了可供該論文改進並延伸研究的方向，給予筆者正面肯定的評價。
 
出席 2006年 ICC國際控制學術研討會心得報告 
 
國立中興大學電機工程學系   林俊良 教授
 
摘  要 
2006年國際控制工程學術研討會(International Conference Control 2006)是由格拉斯哥大學和史
崔克萊大學(University of Glasgow and University of Strathclyde)兩所英國知名大學及IEEE UK 
& RI Industry Applications Chapter、Advanced Control Technology Club、Institute of Measurement 
and Control (IMC)、Institution of Engineering and Technology、Institute of Mechanical Engineering
共同主辦，並由世界各國頂級之控制界學者專家共同與會進行口頭報告論文及交流研究經
驗，係全歐洲最重要的控制相關領域研討會之ㄧ。今年大會由格拉斯哥大學Dr. David 
Murray-Smith 與史崔克萊大學 Dr. Bill Leithead共同擔任此會議主席，會中邀請到機械與航太
控制理論知名大師Prof. Robert Bitmead與國際控制理論知名大師Prof. Peter Fleming等擔任專
題演講，目前分別任職於 Department of Mechanical & Aerospace Engineering, University of 
California, San Diego, USA 與 Department of Automatic Control and Systems Engineering 
University of Sheffield, Sheffield, UK；其中Prof. Peter Fleming 其主要研究領域為適應控制、神
經網路、模糊控制等等方面，目前是IEEE Fellow以及澳洲技術研究院的研究員之一。 
本次會議，計有全球20多個國家約120篇論文獲選與會進行報告。正式會議於英國蘇格蘭
格拉斯哥大學和史崔克萊大學，自八月三十日起舉行三天。今年會議重點在於針對控制理論，
控制系統設計與應用為主要的議題。此會議最重要的特色是全部的議題都是關於控制理論方
面，全世界唯一單純控制領域的國際型會議，其包含控制理論(Control theory)、數位控制(Digital 
control system analysis and design methods)、離散系統控制(Discrete event systems in control)、非
線性控制系統(Nonlinear control systems)、生物演算法控制(Biological control systems and 
biomedical applications of control)、智慧型控制(Artificial neural networks in control, Fuzzy 
systems methods for control)、飛行控制(Aerospace and aeronautical applications)、預估控制
主要在處理於不確定環境下針對特定座標物理系統(Coordinated System)利用所設計之預估
控制進行位置估測。演講中首先提出四條船舶機構系統，當有不確定外在環境因素(External 
Disturbances)或輪機本身的干擾(Noise)產生時，利用作者所提出的估測控制進行不同情形
下的位置估測。 
首先，Prof. Robert Bitmead先說明何謂座標控制(Coordinated 
Control)；初步假設有一多目標互聯之運載交通工具 (Multiple 
Vehicles)，其主要研究目的為估測其物理系統目標(Target)、位置
(positions)；當遇到外在擾動時(External Disturbances)，所設計的控
制法則，是否有足夠的回授增益(feedback gains)進行抑制並有效控
制系統的性能(Performance index)；除此之外作者考慮一種非衝突
性限制條件(No-Collision Control)與一些常用估測法則(Estimate)進
行估測控制器設計；並且利用LMI(Linear Matrix Inequalities)理論求解非線性系統之解；最後
將針對各分散式子系統的各項資訊，串接起來成為一個完整的互聯系統以進行控制。演講中
介紹所設計之模式估測控制理論(Model Predictive Control Approach)為:  
{ }, 1 , , 1
1
, ..., , arg min
N
k i i T i i T i T
i k k N k k j k k j k k j k j
j
u u x Q x u Ru+ − + + + + −
=
⎡ ⎤= +⎣ ⎦∑  
這是一種卡爾曼更新法則(Kalman Update)；此外本身狀態估測(Own State Estimate)可設計
成:  
){ }
1, , ,  ,  0,..., 1
where Pr ,   Pr: Collision Constraint
i i i
k j k k j k k j k
i l
k j k j
x Ax Bu j N
x x rα
+ + + +
+ +
= + = −
⎡ ⎤− < <⎣ ⎦

 
此外並設計相關限制條件與估測法則如下 
1. No-Collision Constraint : / /ˆ ~ ( ,  )
i i i
k j k k j k j kx N x+ + +Σ  
2. Gaussion Estimate : , / , /ˆ ~ ( ,  )
l l l
i k j k k j i k j kx N x+ + +Σ  
3. Cross Estimate ⇒  Probabilistic No-Collision Constraint : ( )Pr i lk j k jx x α ε+ +− < <  
Implied by / / max / , /ˆ ˆ ( )
i l i l
k j k k j k k j k i k j kx x α β λ+ + + +− > + Σ +Σ , 
