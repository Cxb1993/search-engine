 2
一、 簡介 
機械視覺應用於生產製程已相
當普遍且成熟，共同目的皆為縮短生
產時間，改善人工辨識之穩定及成
本，本研究主要利用機械視覺定位，
無需透過人工移動平台定位，定位完
成將訊號傳送雷射切割系統進行加
工。目前視覺檢測市場大都掌握於國
外形成壟斷局面，因此價格居高不
下，但市場需求大具有實用性。本研
究主要與國內厚膜電路製造產業合
作，在製程的生產線以視覺輔助雷射
修整電阻為本次研究主要目標，不僅
提升產業技術降低設備成本，且技術
免受國外大廠支配。 
    本研究計畫主要是以快速、低成本以
及穩定的解決合作廠商目前急需改進的
問題，合作廠商是以雷射切割 PCB 板的電
阻，藉由切割電阻改變電阻值大小達到所
需之性能參數，因此切割的位置必須精準
控制在容許的誤差範圍之內。由於缺少自
動化的視覺檢測技術，PCB 板的定位由人
工定位完成，現場作業員由固定式攝影機
得知對位與否，適度調整 X-Y 控制平台，
待定位完成命令雷射進行切割，因此人工
定位在速度與精度上有許多缺點。 
因此我們發展一套智能式適應性的
厚膜電阻雷射加工系統，利用 CCD 搭配影
像卡擷取影像，以 LabVIEW 為視覺檢測發
展平台，利用圖像比對技術找出欲搜索影
像區域，並輸出訊號回饋給主系統做雷射
控制與加工，再配合自動切割量測系統線
上即時回饋電阻值，完成整個視覺輔助雷
射修整電阻之自動化。 
 
二、視覺輔助雷射修整電阻架構分析與計 
2.1 視覺輔助雷射修整電阻原始架構： 
包括雷射加工系統、影像顯示系統、
X-Y 移動平台；雷射加工系統如圖 2.1 雷
射頭及圖 2.2 雷射加工系統內部結構圖所
組成，其運作方式是利用 Q-switch signal
觸發 LASER Power Supply，能量在共振腔
產生振盪並激發出雷射，雷射經過 BEAM 
POSITIONER GROUP 後，最後來到工作
平台做切割加工。影像顯示系統主要為方
便操作者對位，因為電路板夾持至治具上
並非準確定位，因此可以透過影像顯示系
統了解電路板對位情況，X-Y 控制平台如
圖 2.3 所示，此平台利用步進馬達驅動使
治具作微調，如果我們在顯示器上發現沒
有對位，可以透過人為控制步進馬達使治
具對準原點。加工前必須先設定雷射切割
 4
射加工系統硬體架構圖及圖 2.5 厚膜電阻
雷射加工系統製程流程圖所示，我們將
CCD 所擷取影像，透過 PCI(影像擷取卡)
將類比訊號轉為數位訊號，將所擷取影像
進行影像辨識軟體的處理並搜索工件影
像之目標位置，得到目標座標後將其欲補
正參數回傳到運動控制卡，運動控制卡分
別將訊號傳送至 X 與 Y 軸伺服馬達，搜索
定位 PCB 板的座標位置，接著傳送切割
訊號至雷射控制器，直接進行 YAG 雷射
切割電阻，等切割完畢後利用電表回饋量
測電壓值，檢測 PCB 板輸出電壓是否為
預設值，如果否，則繼續進行切割，如果
是，則完成線上雷射切割與檢測。 
 
 
 
 
 
 
 
圖 2.4 厚膜電阻雷射加工系統硬體架構 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
圖 2.5 厚膜電阻雷射加工系統
製程流程圖 
 
2.3 改良架構之視覺分析與設計 
在辨識的演算法上主要利用機械視
覺中圖樣比對(Template Matching)技術
[1]、[2]作為我們搜索辨識的主要策略。 
所謂圖樣比對，是指判斷兩個圖樣的 
相似程度，其目的是在兩組特徵個體
之間尋求最佳的對應關係，而該兩組特徵
個體可視為代表兩個欲比對的物體或影
像。 
對兩個比對的圖樣而言，標準圖樣可
 6
 
          圖 2.6 相關係數法 
相關係數法之改良： 
相關函數有一缺點，這就是它對 I(u,v)
和 T(i,j)的灰度值振幅變化比較敏感。例
如，當 I(u,v)的所有值都加倍時，c(u,v) 的
值也加倍。經常用來克服這一缺點的方法
是用相關係數進行比對，相關係數
(Correlation Coefficient)又稱正規化交互
相關性(Normalized Cross Correlation),
常用於圖樣比對，做為搜尋待測影像的特
徵，其定義如(3)所示： 
( )
( )[ ] ( )[ ]
( )[ ] ( )[ ]∑∑ ∑∑
∑∑
= = = =
= =
−−++
−−++
=
M
i
N
j
M
i
N
j
M
i
N
j
TjiTIvjuiI
TjiTIvjuiI
vur
0 0 0 0
22
0 0
,,
,,
,
  (3) 
其中 u=0，1，2，…，M-1；v=0，1，
2，…，N-1，是 ( )jiT , 影像中所有的像素
灰度平均值，而是 ( )vuI , 影像在圖樣
( )jiT , 範圍內所有的像素灰度平均值，即
重合的區域。 
相關係數法之改良特性： 
(1)相關係數 r(u,v)的取值範圍是從－1 到
1 ，與 I(u,v)和 T(i,j)灰度值振幅變化無
關。 
(2)r(u,v)等於 1 時表示為最佳比對，r(u,v) 
等於－1 則表示為反向最佳比對，所以
最佳比對的位置即 r(u,v)具有最大值。 
利用相關係數做搜尋比對有以下幾個優
點： 
(1)對於影像灰度變化不敏感 
(2)可以達到次像素的精度 
(3)有最好的穩定度 
(4)較不受影像有瑕疵的影響 
(5)允許影像些微的旋轉和縮放 
 
[圖樣比對之搜索區域策略流程] 
Step1：讀取資料比對的影像區域 
Step2：定義來源的影像區域 
Step3：決定搜索指定的角度範圍值 
Step4：從搜索的過程，選擇性地設
定影像的＂模糊＂像素移除 
Step5：指定影像搜索參數 
Step6：預處理影像搜索參數 
Step7：配置影像輸出結果，儲存至
 8
 
 
 
 
 
 
 
圖 3.2 厚膜電阻雷射加工系統PC-BASE 
      架構圖  
 
 
 
 
 
 
 
 
 
 
 
 
表(一) 設備規格表 
 
四、 實驗結果與討論 
4.1 視覺檢測系統之分析 
自動化精密視覺辨識系統利用CCD
搭配影像卡擷取影像，以LabVIEW為視覺
檢測的發展平台如圖4.1及圖4.2所示，其
操作程序如下： 
(a) 如圖 4.1 編號[H] Home 做歸零動
作。 
(b) 按樣本擷取如圖4.1編號[A]，X-Y
平台從平台原點移動到目標原
點如圖4.3、圖4.4所示。 
(c) 在原影像如圖4.1編號[D]框選出
樣本，按取樣本Button如圖4.1
編號[B]即將你選的樣本放在樣
本方框中如圖4.1編號[E]。 
(d) 選取完樣本，按比對開始Button
如圖4.1編號[C]即完成樣本比
對，比對完成系統會詢問使用者
是否符合需求如圖4.2所示，若按
「OK」X-Y平台即會回到平台原
點，若按「Cancel」則重新選取
樣本。 
(e) 完成比對按開始搜尋影像中心
點Button如圖4.2編號[G]所示，
即開始進行對位調整，若調整次
數超過我們設定調整次數，系統
會詢問使用者是否歸零重新補
正如圖4.4所示，按「OK」X-Y平
台回到平台原點重新調整，若按
「Cancel」系統繼續做對位調
整。 
(f) 對位調整完成，系統會詢問使用
者是否進行雷射切割如圖4.5所
示，按「OK」開始雷射切割，若
按「Cancel」X-Y平台將回到平
台原點。 
(g) 雷射切割再配合自動切割量測
系統線上即時回饋電阻值，完成
雷射修整電阻之自動化。 
(h) 完成雷射切割，X-Y平台即回到
平台原點，即完成整個視覺輔助
雷射修整電阻之自動化。 
 
 10
Trimming製程。整個電阻切割的精度回饋
控制是利用雷射切割控制卡內建PID控制
器來完成。
 
圖 4.7 雷射修整電阻之自動化流程 
 
五、結論 
本系統架構是利用CCD搭配影像卡補
捉影像，用LabVIEW開發一套相關搜索策
略的程式來搜索辨識影像並對其做定位
及補正，如下所示： 
(a) X-Y Table 將 PCB 板送至定位。 
(b)CCD 配合所撰寫的程式以機械視
覺的策略來搜索欲切割區域的正
確位置。 
(c)利用誤差回饋機制修正定位誤差
並控制平台移動到正確位置完成
自動化伺服運動補正控制。 
  (d) 完成自動化視覺定位即傳送訊
號至雷射切割系統，進行雷射
切割加工程序。 
  (e) 首先在PC預先設定雷射切割路
徑，並傳送給雷射切割控制
卡，雷射切割控制卡將路徑參
數轉成類比訊號給放大器，放
大器再轉換成電壓送至雷射反
射鏡，我們即利用電壓變化控
制雷射反射鏡反射角度。 
  (f) 整個雷射切割系統是配合電阻
自動量測系統，以達成生產線
上即時量測電阻值當完成工件
設定值，即完成整個自動化雷
射Trimming製程。 
  (g) 整個電阻切割的精度回饋控制
是利用雷射切割控制卡內建
PID控制器來完成。 
本研究考慮到廠商製程的需求，因此
將我們的系統著重在以下3點： 
(a) 快速：1.人工定位程序 (1)人工將
欲切割PCB板安裝至治具上 (2)接
著利用眼睛檢視螢幕上所要切割的
正確位置 (3)並以手動調整平台至
正確位置開始切割，這將近花費30
秒的時間。配合自動化視覺回饋系
統後 (1)X-Y Table將PCB板送至定
位 (2)CCD配合所撰寫的程式以機
械視覺的策略來搜索欲切割區域的
正確位置 (3)並自動控制平台移動
到正確位置開始切割，預計所花配
時間不到5秒。 
    2.目前雷射切割程序 (1)原先機台
雷射切割過程是雷射光束固定，利
用X-Y平台做移動切割 (2)雷射切
雷射切割控制卡 
PC 
放大器 
YAG 雷射 
即時檢測 
加工完成 
未達容許範圍修正
 
