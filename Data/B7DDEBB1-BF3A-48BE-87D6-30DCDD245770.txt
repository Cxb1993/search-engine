measure the hardness of any kind of materials including metals and non-metals by using the 
Microchip microcontroller. Included in this system are PIC-controlled circuit, AC inductive motor 
driver, LCD driver circuit, and linear variable differential transformer (LVDT) interface circuit or 
optical encoder interface circuit so forth. Once turning on, system initialization is automatically 
carried out and then waits for command inputs by users. When input signals are detected by the 
system, PIC circuit will perform the measurements of hardness for metals or non-metals according 
to the planned flowchart of measurement. This system can acquire the hardness of materials 
measured quickly and accurately by a predefined conversion formula through the returned values 
from the sensor. Besides, our system is also capable of validating the hardness of different metallic 
materials. The measured range of hardness in the system according to the standard specification of 
hardness tables is from 0 degree to 100 degrees, and the measured precision of ±0.05 deg. in our 
system can be achieved. 
 
Keywords: PIC microcontroller, Hardness meter, LVDT 
 
1. 系統架構導引  
 
本計畫以 Microchip PIC24FJ256GB110 單晶片來實現硬度計全自動量測系統，在此以洛
氏硬度計為例，整體系統之架構如圖 1 所示，主要包括 PIC 主控電路、AC 馬達驅動電路、
以及 LVDT 驅動與訊號解碼介面電路。以下將針對系統運作進行說明：當系統電源啟動時，
系統將處於待機狀態；當 LVDT 訊號產生變化時，PIC 主控電路便會開始進行量測的動作。
緊接著，主控電路將傳送訊號至 AC 馬達驅動電路，以便控制 AC 馬達的運作。藉由鋼珠或
鑽石測頭來加壓被測物體，可量測得到凹陷變形之位移距離，利用此位移距離，經過 LVDT
數值與硬度關係轉換之後，即可精確地計算出被測物體之硬度。 
  
圖 1. 硬度計量測系統架構圖 
氏硬度計為例，當接收到 LVDT 等於「定位指示設定值」時，約再等待 1~2 秒，馬達
即開始進行反轉。當馬達觸動到微動開關之下停止開關時，馬達即暫停並等待之前所
設定之暫停秒數，等到暫停秒數到達時，馬達即開始進行正轉，一直到馬達觸動到上
停止開關即停止。因此在馬達控制上，這部分相對容易達成。 
 
圖 3 為馬達驅動電路之實體圖，電路皆依據圖 4 之設計來進行實作，其中通道之功
率電晶體採用 BTA06，這兩顆功率電晶體主要的功能是作為開關之用，可控制進入馬
達線圈之電流方向，而將馬達驅動電路與 PIC 主控電路連接後，便可進行馬達正反轉
之控制。 
 
圖 3. 馬達驅動電路實體圖 
 
 
圖 4. 單相 AC 感應馬達之驅動電路設計圖 
 
3.2. 馬達驅動器之控制方式 
 
在 AC 馬達驅動器之控制方面，本計畫採用 MOC3010 光耦合 IC 及 BTA06 功率 IC 來設
計 AC 馬達控制器，可藉由控制來自於 PIC 主控電路之輸入訊號來決定馬達的正/反轉。在
此，對於馬達正/反轉的控制，本文總共定義有三種，分別 F/R=01 為正轉(順時針)，F/R=10
 
圖 7.  LVDT 位移信號量測流程方塊圖 
 
4.2. LVDT 訊號處理 
 
LVDT 輸出訊號為兩組弦波訊號需要先進行電壓之調整及外部雜訊之濾除，經過訊號放
大、取樣及數位化後就可得到探針位置之數據，由輸出的兩組弦波訊號即代表著目前探針的
所在位置，藉由該兩組訊號相減之差值來得到相對位移量，按照此差值即可換算得到硬度
值，如方程式(1)所示。 
0.331 100LVDTH V= − Δ +         (1) 
 
中 H 表示洛氏硬度計所量測之硬度值， LVDTVΔ其 為荷重加壓後，LVDT 量測之變化值。 
4.3. LVDT 輸出訊號 
 
發訊號，可得到兩組對應的弦波訊號輸出，藉由 LVDT 輸出之兩組弦
波訊 與圖 9 得知，當輸入訊號相對電壓(振幅)愈大時，輸出
訊號
 
 
LVDT 經由輸入觸
號，即可解讀出位移量。由圖 8
之相對電壓也是跟著變大，而輸入訊號相對電壓減小時，輸出訊號亦跟著減小，即兩者
是同相地進行變化。當探針位置於左半部時，此時輸出/入訊號會呈現差值為負值的狀態。
於中點時，對應之輸出訊號之振幅差值幾乎為 0，探針位於右半部時，此時輸出/入訊號會呈
現差值為正值的狀態。 
 
  
圖 8.  LVDT 輸出之弦波訊號(探針為至於左半時) 
   
  
圖 12. 相位差為 90 度的 AB 相訊號 圖 13. 正反轉訊號示意圖 
 
5.2. HCTL-2032 解碼電路 
為進行解碼計數，本研究採用 HCTL-2032 做為光學編碼器之解碼介面晶片，此顆 IC 之
工作頻率可達 33MHz，輸入點具有數位濾波器之設計，且具有很高之抗雜訊干擾能力，內
部計數器為 32 位元，並且以 4 倍頻進行解碼之動作，因此使用此顆 IC 的最大好處便是不須
在 PIC24FJ256GB110 中以軟體進行解碼工作，大幅降低 PIC24FJ256GB110 的軟體負擔，提
高控制效能。 
 
光學編碼器之解碼流程如圖 14 之電路示意圖所示，將訊號線接回到 HCTL-2032，進行
4 倍頻之解碼動作，將訊號 A 與訊號 B 的上緣及下緣分別作取樣，利用編碼器回授訊號 A
相及 B 相所產生之狀態(00、01、10 及 11)，經過光學編碼器內部轉盤正轉或反轉時產生如
圖 1 徵便可達成 4 編碼器
經 HCTL-2032 解碼後之計數值分為高 16 位元與低 16 位元輸出計數值訊號，因此很適合利
 
5 所示之狀態流程圖，利用此一狀態特 倍頻之解碼動作，最後光學
用微控制器來進行處理。 
 
 
圖 14. 光學編碼器解碼流程示意圖 圖 15. 4 倍頻解碼狀態圖 
 
人才培育成果說明： 
研究計畫進行之時，學生一開始由系統功能規劃、電路模組設計、韌體程式開發、到最
後對合作廠商的期末報告，可深刻地體會到一個完整專案之進行，不僅可強化學生開發與設
計之能力，於畢業後亦能夠快速地進入企業專案開發的行列。 
 
技術研發成果說明： 
 本計畫所開發之全自動硬度量測系統，採用先進製程單晶片微控制器元件，可依照不同
的硬度量測需求來調整內部的程式，較傳統採用指針式之設計更具有較高的應用彈性。除此
之外，本系統亦具有硬度量測速度快、精度高等優點。 
 
技術特點說明： 
 目前國內硬度計大都仍停留在手動量測之技術上，使用前必須瞭解儀器的特性以及操作
的規範，才能順利量測到金屬材或其它材料之硬度值，實在是相當的不方便。本技術特點在
於引入硬體量測電路與微控制晶片強大的控制功能，來達成硬度量測全自動化之目標。除此
之外，目前國外高階的硬度計量測儀器均相當昂貴，透過本技術引入國內廠商，也可望能有
效降低產品的價格，以提升國內產、學、研等研發機構在採購上的誘因。 
 
可利用之產業及可開發之產品： 
 硬度計數位控制器其硬度值由於採用數位式輸出，因此對於不同次代產品的開發上都擁
有相當良好的延續性，加上配合內部擁有剛性機構的設計，可減少因機構產生的誤差。本系
統硬度值量測範圍為 0~100 度，其精準度可達±0.05 度。本開發產品可廣泛應用於工業加工
之硬度測量上，如各加工廠金相檢驗實驗室、學校，與研究單位等。 
 
推廣及運用的價值： 
目前所開發的控制器，由於 LVDT 驅動/解碼使用 OP 放大器，其電路較為繁複，因此
以專用 IC 來驅動/解碼 LVDT 所回授之弦波訊號，可進一步提升硬度計數位控制器之功能，
不但可以降低維護成本與困難度，更能夠進一步提升系統穩定度。 
98年度專題研究計畫研究成果彙整表 
計畫主持人：黃登淵 計畫編號：98-2622-E-212-010-CC3 
計畫名稱：全自動化硬度量測系統設計與開發 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 1 1 100%  
研討會論文 0 1 100% 
篇 
將整理已完成的
技術報告，並與合
作廠商討論可發
表 的 部 份 內 容
後，再行投稿至國
內適當的研討會
中。 
論文著作 
專書 0 0 100%   
申請中件數 0 1 100% 
有關於專利的申
請必須看合作廠
商的態度，若合作
廠商願意申請專
利的話，再著手進
行相關專利的申
請。 
專利 
已獲得件數 0 0 100% 
件 
 
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 1 1 100%  
博士生 1 1 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 1 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 1 1 100%  
國外 
參與計畫人力 
（外國籍） 博士生 1 1 100% 
人次 
 
 
