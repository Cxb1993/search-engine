 1
????????????????????  
??????????????????????????????- 
????????????????????? 
Implementation of drive system for a permanent magnetic synchronous 
machine and application for electric motorcycle    
?????NSC 96-2221-E-239-035 
?????95? 8 ? 1 ?? 96 ? 7 ? 31 ? 
           ?  ? ?????                  ??????????? 
             ?????????                  ??????????? 
????????? ??? ???       ??????????? 
               
??:????????????????????
????????????????????????
????????????????????????
????????????????????????
????????????????????????
????????????????????????
????????????????????????
????????????????????????
????????????????????????
?? 
 
????????????????????????
?????? 
 
Abstract: The purpose of this projection is implementation 
of drive and intelligent control system for a permanent 
magnet synchronous machine (PMSM) based on digital 
signal processor (DSP), and application of drive and energy 
recycle for electric motorcycle. The projection of first year 
is proposed that the supervisor control system and intelligent 
control system combined recurrent fuzzy neural network 
with variable structure controller is proposed to control 
current response according to modeling of PMSM and drive 
system. Besides power converter, isolated drive circuit, 
current detect circuit and rotor position detect circuit, in 
order to reduce complexity of hardware and rising stability 
of system the control system structures are accomplished by 
DSP. The object of digital control can be achieved with 
intelligent and robust control. 
Keywords: Digital signal processor, permanent magnet 
synchronous machine, recurrent fuzzy neural 
network 
 
?? ????? 
????????????????????
??????????????????????
?????????????????????
??????????????????????
??????????????????????
??????????????????????
?????????????????????
??????????????????????
??????????????? 
????????????????????
??????????????????????
??????????????????????
??????????????????????
??????????????????????
????????????????????
?????????????????????
??????????????????????
??????????????????????
??????????????????????
?????????????????????
??????????????????????
??????????????????????
??????????????????????
?????????????????????
?????????????[1-3]???????
?????????????????????
??????????????????????
??????????????????????
??????????????????????
?????????????????????
??????????????????????
?????????????????????
????????[4-7]? 
???????????????????
???????????[8-15]????????
??????????????????????
?????????????????(Inference 
Mechanism)[9]?????????????[14-15]
??????????????????????
???????(a)??????????????
??????????????????????
??(b)???????????????????
?????????????????????
?????????? 
???????????????????
??????????????????????
??????????????????????
??????????????????????
?????????????????????
 3
???????????? DSP????????
??????????????????????
??????????????????????
???????DSP???????DSP????
? aV ? bV ? cV ???????IGBT??????
?????????????1.3????????
?????????????????????
??????????????????????
??????????????????????
????????????? 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
? 3 ???????? DSP ?????????
??????? 
 
2.4 ????????????????????
??????????????? 
????-???????????????
??????????????????????
????????-??????????????
??????????????????????
??????????????????????
?????????????????????
???????????????(Model Following)
?????????????????????-
??????????????????????
??????? mω ?  
???????????????????
?????????? *i ???????????
??????????????????????
??????????????????????
?????????????????????
??????????????????????
????????(1.7)?????? 
wCUBA
T
J
i
J
K
J
B
PtPrP
Ls
t
rr
++=
−+−=
ω
ωω 1&
                  (11) 
? ? JBAP −= ? 0>= JKB tP ? JCP 1−= ?
LTw = ?? qt iU = ??????????????
??????????????????????
? (11) ? ? ? ? ? ? ? ? ? ? ? ? ? ?
? : )( rUrP FA ωω ≤ ; UP GwC ≤ ; PL BB ≤ ; ??
)( r
UF ω ??????????? UG ? LB ???
?????????????? rme ωω −= ???
mω ?????????????e???????
??????????????????????
???????w??????????????
??? 
[ ] PmPrP BekwCAU /1* ++−−= ωω &          (12) 
?? 1k ?????(12)???(11)????? 
01 =+ eke&                                (13) 
????????? e? ∞→t ????????
??????????????????????
??????????????????????
??????????????????????
??????????????????????
??????????????????????
? 4????????????????????
????????????????????? 
SCRFt UUUU ++=                         (14) 
?? SU ??????????? RFU ?????
??????????? CU ?????????
????? SU ???????????????
??????????????????????
??????????? RFU ????????
??????????????????????
??????????????????????
??????????????????????
????? CU ???????????????
?????????????????????
??????????????????????
?????????????????????
???????????????????? 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
? 4 ???????????????????
????????????? 
  
????
??
?????
?????
????
??
??????
?????DSP ???
?????
???
*
ai
*
bi
*
ci
????
???+
-
????
???
ia ib ic
rθ
?????
????
ia
ib
ic
*
qi
0* =di
?????
?/??
???
C
??
Vdc= 48V
????
????
??/??
???
???
???
???
aT bT cT
+
aT −
aT
+
bT
+
cT−
bT
−
cT
+
aT −
aT
+
bT
−
bT
+
cT
−
cT
rω
  
tU
rω
???
?????
????
???????????
tK ∑ BJs +
1
LT
+
_
rωeT
)(sH p
emω RFU
e
e∆
????
?? ????
E
CU
+
++
_
????
Ε
γ
Γ
???????
oiijijko w,,m,w &&&& σ4
????
SU
+
+
11 −− z
HU
Lyapunov
??
sV ????
×
I
??????
????
*ω
 5
( )
( ) ( ) ( )22222
22
2 exp, jjjj
ij
iji
j netnetfy
mx
net ==−−= σ  (24) 
?? ijm ? ijσ ????????i???????
? 2ix ???j????????????????
????? 
??????? 
    ????????????∏??????
??????????????????????
k???????  ( ) 3333333 , kkkk
j
jjkk netnetfyxwnet ==∏=         (25) 
?? 3jx ?????????????j?????
3
jkw ????????????????????
???1? 
??????? 
???????????? Σ ??????
??????????????? ( ) 4444444 , ooookko
k
o netnetfyxwnet ==∑=   (1.26) 
??wko
4 ???? k???????????xk
4?
???????????? k ????? 4oy ??
??????????? RFo Uy =4 ??????
??????????? RFU ?????? ( ) ΓΘΘ TRFU =E   (1.27) 
?? [ ]Tlooo www 44241 LL=Θ ?? 4kow ??????
???????????????????[ ]Tlxxx 44241 LL=Γ ? 4kx ???????????
?????? 10 4 ≤≤ kx ? 
2.4.3 ?????? 
 ????????????????????
?(Minimum Approximation Error? ε )????? ( )** Θε ERFUU −=                        (28) 
?? *Θ??????????????????
??????????? ε ??????????
? δ?? δε < ??(1.28)??(1.17)???????
( )[ ]  −−−+= SCRFm UUUU ΘΛ EBEE *&   ( )[ ]{
( ) ( )[ ] }SCRFRF
RFm
UUUU
UU
−−−+
−+=
ΘΘ
ΘΛ
EE
EBE
*
**
( )  −−−++= SCTm UUΓΘΘΛ *εBE  (29) 
????? Lyapunov????? 
( ) ( ) ( )ΘΘΘΘ −−+= **
2
1
2
1 TtV γPEE
T          (30) 
?????????(1.29)??? 
( ) ( ) ΘΘΘ &&&& TTTtV −−+= *1
2
1
2
1
γPEEEPE  
( )
( ) ΘΘΘ
ΓΘΘ
ΛΛ
&T
SC
T
m
T
TTT
UU
−−


 −−−++
+=
*
*
1
2
1
2
1
γ
εPBE
PEEEPE
[ ] ( ) ΓΘΘ TmTSCmTT UU −+−−+−= *21 PBEPBEQEE ε  (31) 
???? 0)( ≤tV& ?????Θ& ?????? CU ?
???: 
ΓΘ mT PBEγ=&   (32) ( )mTCU PBEsgnδ=  (33) 
?? γ ??????(32)???(31)?????(21)
???
( ) SmTCmTmTT UUtV PBEPBEPBEQEE −−+−= ε2
1&
Cm
T
m
TT UPBEPBEQEE −+−≤ ε
2
1  (34) 
??(33)??? 
( ) 0
2
1 ≤−≤ QEETtV&  (35) 
?? ( ) 0≤tV& ? ( )tV& ????(Negative Semidefinite)
? ( ) ( )0VtV ≤ ????? E? ( )ΘΘ −* ????
????? ( ) ( ) 2QEETtVt =−= &Ξ ?? ( )tΞ ???
?????????? 
( ) ( ) ( )tVVdtt −=∫ 00 τΞ  (36) 
?? ( )0V ??????? ( )tV ????????
???? 
( ) ∞<∫∞→ τdttt 0lim Ξ                          (37) 
??? ( )tΞ ???????? 
( ) EQE && Tt =Ξ  (38) 
??(29)???????????????E& ??
???????? ( )tΞ ???????(Uniformly 
Continuous Function)[16]?? Barbalat???[16-17]
?? )(tΞ ? ∞→t ??????????? ∞→t
??? ( ) 0→tE ???????????????
?????????? ( ) 0=tE ????????
????e??????? 
2.4.4 ??????? 
 ????????????????????
??????????????????????
??????????????????????
??????????????????????
??????????????????????
??????????? Lyapunov??????
??????????????????????
??????????????????????
??????????????????????
 7
???????????????????
?????????????????????
?? NmTBBJJrpm L 0,,,1000 ====∗ω ???
?? NmTBBJJrpm L 0,3,3,1000 ====∗ω ??
?????????????? 6?? 7????
6(a)?(b)??????????????????
??????? 6(c)?(d)???????????
?????????????? 7(a)?(b)????
?????????????????????
7(c)?(d)??????????????????
??????????????????????
?????????????????????
????????????? 8?? 9????? 
? 8(a)?(b)????????????????? 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
?6 ????????????(a) ???????????
????(b) ?????????????????(c) ?
??????????????(d) ??????????
?????? 
???????? 8(c)?(d)??????????
??????????????? 9(a)?(b)???
??????????????????????
9(c)?(d)??????????????????
???????? 6(b)?(d)?? 7(b)?(d)????
??????????????????????
??????????????????????
??????????????????????
??????????????????? 8(b)?
(d) ?? 9(b)?(d)??????????????
??????????????????????
?????????????????????
??????????????????????
?? 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
?7 ????????????(a) ???????????
????(b) ?????????????????(c) ?
??????????????(d) ??????????
?????? 
(d)
(a)
(b)
(c)
1 sec
1 sec5 A
tU
0 rpm
0 rpm
1 sec
1 sec
tU
5 A
0 A
0 A
1000 rpm????
????
????
????
1000 rpm
(d)
(a)
(b)
(c)
1 sec
1 sec5 A
tU
????
????0 rpm
1 sec
1 sec
tU
5 A
0 A
0 A
1000 rpm
-1000 rpm
????
????0 rpm
1000 rpm
-1000 rpm
 9
[5] J. Y. Gan, K. T. Chau, C. C. Chan and J. Z. 
Jiang, “A new surface-inset, permanent-magnet, 
brushless DC motor drive for electric 
vehicles,” IEEE Transactions on Magnetics, 
vol. 36, no. 5, pp. 3810-3818, 2000.    
[6] C. C. Chan and K. T. Chau, “An advanced 
permanent magnet motor drive system for 
battery-powered electric vehicles” IEEE 
Transactions on Vehicular Technology, vol. 45, 
no. 1, pp. 180-188, 1996.   
[7] N. Bianchi, B. N. Bolognani and M. Zigliotto, 
“High performance PM synchronous motor 
drive for an electrical scooter,” in IEEE IAS’00, 
vol. 3, pp. 1901-1908, 2000. 
[8] Y. C. Chen and C. C. Teng, “A model reference 
control structure using a fuzzy neural 
network,” Fuzzy Sets and Systems., vol. 73, pp. 
291-312, 1995. 
[9] L. X. Wang, A Course in Fuzzy Systems and 
Control. Englewood Cliffs, NJ: Prentice-Hall, 
1997. 
[10] K. Kiguchi and T. Fukuda, “Intelligent 
position/force controller for industrial robot 
manipulators-application of fuzzy neural 
networks,” IEEE Transactions on Industrial 
Electronics, vol. 44, no. 6, pp. 753-761, Dec. 
1997.  
[11] W. A. Farag, V. H. Quintana, and G. 
Lambert-Torres, “A genetic-based neuro-fuzzy 
approach for modeling and control of 
dynamical systems,” IEEE Transactions on 
Neural Networks, vol. 9, no. 5, pp. 756-767, 
Sept. 1998. 
[12] F. J. Lin, R. J. Wai, and H. P. Chen, “A PM 
synchronous servo motor drive with an on-line 
trained fuzzy neural network controller,” IEEE 
Transactions on Energy Conversion, vol. 13, 
no. 4, pp. 319-325, Dec. 1998. 
[13] F. J. Lin, W. J. Hwang, and R. J. Wai, “A 
supervisory FNN control system for tracking 
periodic inputs,” IEEE Transactions on Fuzzy 
Systems, vol. 7, no. 1, pp. 41-52, Feb. 1999. 
[14] K. S. Narendra and K. Parthasarathy, 
“Identification and control of dynamical 
systems using neural networks,” IEEE 
Transactions on Neural Networks, vol. 1, no. 1, 
pp. 4-27, Mar. 1990. 
[15] Y. M. Park, M. S. Choi, and K. Y. Lee, “An 
optimal tracking neuro-controller for nonlinear 
dynamic systems,” IEEE Transactions on 
Neural Networks, vol. 7, no. 5, pp. 1099-1110, 
Sept. 1996. 
[16] J. E. Slotine and W. Li, Applied Nonlinear 
Control. Englewood Cliffs, New Jersey: 
Prentice-Hall, 1991. 
[17] K. J., Astrom, and B. Wittenmark, Adaptive 
Control. New York: Addison-Wesley, 1995. 
 ssetss
e
s
s
e
s
e iiKii
L
i
L
T ),()( θθθ ∆∂
∂=∂
∂=
2
1
2
1 2   (5) 
where 
e
sL
θ∂
∂
is derivative of self inductance corresponding 
with electric angular eθ , )(),( s
e
s
set i
L
iK θθ ∂
∂=  is the 
torque coefficient, si  is the exciting current of stator, eT  
is the electromagnetic torque. 
The equation of the motor dynamics is 
r
e
r
r
Pdt
d ωωθ ==  (6) 
rrLe JBTT ωω &++=  (7) 
In (6) and (7), rθ  is the rotor position, rω  is the rotor 
speed, rP  is the number of poles, LT  stands for the load 
torque (external load disturbance), B represents the viscous 
frictional coefficient and J is the moment of inertia.  
The basic principle in controlling a SRM drive is based 
on constant torque coefficient ),( set iK θ , so the 
electromagnetic torque eT  is then proportional to si , 
which is determined by closed-loop control. Since the 
generated torque is linearly proportional to the stator current 
in (5), the torque per ampere can be achieved. The block 
diagram of a switched reluctance motor drive system for 
electric motorcycle is shown in Fig. 1. This consists of five 
major parts: a motor and wheels of electric motorcycle, a 
current-regulated converter, commutation mechanism, a 
controller, and sensors. First the control algorithms are 
executed by digital signal processor (DSP) control board. 
Then, the output current command to the current-regulated 
converter is determined by the DSP controller. The 
current-regulated converter controls the four phase currents 
to follow the current commands. The sensors consist of the 
current and position sensors. For the speed control system, 
the electric motorcycle is operated to provide constant 
disturbance torque. The SRM used in this drive system is a 
four-phase six-pole 48V, 1.13Kw, 35A, 6000rpm type.  
 With the implementation of digital signal processor 
(DSP) control, the SRM drive can be simplified to a control 
system, in which 
BJs
sH p +=
1)(    (8) 
The parameters of the SRM are given as follows: Ω= 21.1R , 
25.32max =L mH, 82.124min =L mH. For the convenience 
of controller design, position and speed signals in the 
control loop are set at 1V=50rad/sec, respectively. The 
results turn out to be 
VNmradNmsB
VNmsradNmsJ
/309.0/1018.6
/052.01004.1
3
23
=×=
=×=
−
−
 (9) 
The overbar symbol represents the system parameter under 
the nominal condition. 
Due to the function ),( irθλ  of the flux linkage is 
relating to current i  and rotor position rθ . The function 
),( irθλ  is periodic in rθ , and monotonically increasing in 
i . It can be expressed as ),( irθλ = iiL r ),(θ , in terms of the 
inductance function L . Models assuming linear magnetic 
ignore the current dependence of L , i.e., )( rLL θ= , while 
in more realistic, nonlinear magnetic model ),( iL rθ  is 
monotonically decreasing in i  (due to saturation). The 
analysis and control design approach that are presented here 
are based on linear magnetic in this paper. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Fig. 1.  Configuration of a SRM drive. 
 
III.  HYBRID FUZZY NEURAL NETWORK CONTROLLER 
DESIGN FOR ELECTRIC MOTORCYCLE 
The dynamic equation of the SRM servo drive system can 
be formulated by rewriting (7) as follows:  
wCUBAT
J
i
J
K
J
B
PtPrPLs
t
r ++=−+−= ωωω 1*&  (10) 
where rω  is the rotor speed of the SRM; *si  is the 
command current of the stator of the  SRM; 
JBAP −= ， 0>= JKB tP ， JCP 1−=  and wTL = . 
Consider the variation of system parameters and external 
force disturbance, the parameters in (10) are assumed to be 
bounded, i.e., )( r
U
rP FA ωω ≤ , ULP GTC ≤ , PL BB ≤ , 
where )( r
UF ω  is a known continuous function, UG and 
LB  are know constants. Define the tracking error as 
follows: 
rme ωω −=   (11) 
where mω  represents the desired rotor speed; e is the 
tracking error of rotor speed. If the parameters of the SRM 
servo drive system and w are well known, the idea control 
law can be defined as follows [9]: 
[ ] PmPP BekwCAU /1* ++−−= ωω &  (12) 
where 1k  is positive constants. Substituting (12) into (11), 
the following equation can be obtained: 
01 =+ eke&  (13) 
Current 
Sensor 
Circuit
Current 
Controller
Encoder
Drive Circuit
PWM Circuit
ba HH ,
*
ai
*
bi
*
ci
*
di
SRM
C
+
-
Nonsymmetrical   
IGBT Inverter
ia ib ic id
DC 48V 
Electric 
Motorcycle
Position and 
Commutation 
Circuits
θ
Command 
Current 
Generator
ia
ib
ic
id
dc
ba
SS
SS
,
,
dcba SSSS ,,,
a+ b+ c+ d+
a+
a-
b+
b-
c+
c-
d+
d-
a+
a-
b+
b-
c+
c-
d+
d-
*ω ∑+_ Limiter
Digital 
Filter 
and 
d/dt
rω
e Speed 
controller
DSP Control Board
tU
+
-
1384
 the mentioned drawback. The FNN control is proposed to 
mimic the idea control law *U , and a compensated control is 
proposed to compensate the difference between *U and the 
FNN control instead of increasing the inference rules of the 
FNN. 
A four-layer FNN as shown in Fig. 3, which comprises the 
input (the i layer), membership (the j layer), rule (the k layer) 
and output layer (the o layer), is adopted to implement the 
FNN controller in this study. The signal propagation and the 
basic function in each layer of the FNN are introduced as 
follows: 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Fig. 3.  Structure of FNN. 
 
 Layer 1: Input Layer 
For every node i in this layer, the net input and the net 
output are represented as 
( ) 2,1,
,1
1111
411
===
−∏=
i)N(net)N(netf)N(y
)N(yw)N(x)N(net
iiii
ooi
o
ii
 (24) 
where ex rm =−= ωω11  is the command error between the 
desired command, mω , and the rotor speed of the SRM, 
rω ; ezex ∆≡= )-1( -112  is the command error change, in 
which 1−z  represents a time delay; N denotes the number 
of iterations; 4oy  is the output of the FNN. 
Layer 2: Membership Layer  
In this layer, each node performs a membership function. 
The Gaussian function, is adopted as the membership 
function. For the jth  node ( )
( )( ) ( ) njNnetNnetfNy
mx
Nnet
jjjj
ij
iji
j
,,1,)(exp)()(
,)(
2222
2
22
2
L===
−−= σ
    (25) 
where ijm  and ijσ  are, respectively, the mean and the 
standard deviation of the Gaussian function in the jth term 
of the ith input linguistic variable 2ix  to the node of layer 2, 
and n is the total number of the linguistic variables with 
respect to the input nodes. 
 Layer 3: Rule Layer 
Each node k in this layer is denoted by ∏ , which multiplies 
the input signals and outputs the result of product. For the 
kth rule node 
( ) lk)N(net)N(netf)N(y
)N(xw)N(net
kkkk
j
j
jkk
,,1,
,
3333
333
L===
∏=
 (26) 
where 3jx  represents the jth input to the node of layer 3; 
3
jkw , the weights between the membership layer and the rule 
layer, are assumed to be unity; ( )iinl /=  is the number of 
rules with complete rule connection if each input node has 
the same linguistic variables. 
Layer 4: Output Layer 
The single node o in this layer is labeled with ∑ , which 
computes the overall output as the summation of all input 
signals  
∑=
k
kkoo ,NxwNnet )()(
444
 
( )( ) ( ) 1,)( 4444 === oNnetNnetfNy oooo  (27) 
where the connecting weight 4kow  is the output action 
strength of the oth output associated with the kth rule; 4kx  
represents the kth input to the node of layer 4, Fo Uy =4 . 
Moreover, FU can be rewritten as follows: 
ΓΟ=Ο= TFF UU )(E        (28) 
where the error signal is the input of the FNN; [ ]Tlwww 41421411 LL=Ο is the adjustable parameter vector of 
the FNN; Tlxxx ][
44
2
4
1 LL=Γ , in which 4kx  is 
determined by the selected membership function and 
10 4 ≤≤ kx . 
To develop the compensated control law CU , first, a 
minimum approximation error ρ  is defined as follows: ( )** Ο−= EFUUρ  (29) 
where *Ο is an optimal weight vector achieves the 
minimum approximation error, and the absolute value of ρ  
is assumed to be less than a small positive constant, η  (i.e., 
ηρ <  ). The error (17) can be rewritten as follows: 
( )[ ]
( )[ ]{
( ) ( )[ ] }ACFF
Fm
ACFm
UUUU
UU
UUUU
−−Ο−Ο+
Ο−+Λ=



 −−Ο−+Λ=
EE
EBE
EBEE
*
**
*&
 
( )  −−ΓΟ−Ο++Λ= ACTm UU*ρBE  (30) 
Then, the Lyapunov function is defined as 
R u le
L a ye r
M em b e rsh ip
L a y e r
O u tp u t
L a ye r
In p u t
L a y e r i
j
k
oΣ
w jk
3
w ko
4
y i
1
y j
2
y k
3
y o
4
xi
1
Π Π Π Π
ΠΠ
FU
e e∆
1386
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Fig. 4.  Experimental results of HFNN control system without mounted 
electric motorcycle due to periodical step command: (a) speed at 1500 rpm 
case; (b) control effort at 1500 rpm case; (c) speed at 3000 rpm case; (d) 
control effort at 3000 rpm case 
 
[2] A. V. Randun, “High-power density switched reluctance motor 
drive for aerospace applications,” IEEE Transactions on Industry 
Applications, vol. 28, pp. 113-119, Jan./Feb. 1992.  
[3] K. M. Rahman, B. Fahini, G. Suresh, A. V. Rajarathnam, M. 
Ehsani, “Advantages of switched reluctance motor applications to 
EV and HEV: design and control issues,” IEEE Transactions on 
Industry Applications, Vol. 36, no. 1, pp. 111-121, Jan. /Feb. 2000.  
[4] C. T. Lin and C. S. G. Lee, “Neural-network-based fuzzy logic 
controland decision system,” IEEE Trans. Comput., vol. 40, pp. 
1320–1336, Dec. 1991. 
[5] Y. C. Chen and C. C. Teng, “A model reference control structure 
using a fuzzy neural network,” Fuzzy Sets Syst., vol. 73, no. 3, pp. 
291–312, Aug. 1995. 
[6] J. Zhang and A. J. Morris, “Fuzzy neural networks for nonlinear 
systems modelling,” Proc. IEE—Contr. Theory Applicat., vol. 142, 
no. 6, pp. 551–556, 1995. 
[7] T. S. R. Jang and C. T. Sun, “Neural-fuzzy modeling and control,” 
Proc. IEEE, vol. 83, pp. 378–405, Mar. 1995. 
[8] Y. G. Leu, T. T. Lee and W. Y. Wang, “On-line turning of 
fuzzy-neural network for adaptive control of nonlinear dynamical 
systems,” IEEE Trans. Syst. Man, Cybern., vol. 27, pp. 1034-1043, 
1997. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Fig. 5. Experimental results of HFNN control system with mounted electric 
motorcycle due to periodical step command: (a) speed at 1500 rpm case; (b) 
control effort at 1500 rpm case; (c) speed at 3000 rpm case; (d) control 
effort at 3000 rpm case. 
 
[9] F. J. Lin, W. J. Hwang, and R. J. Wai, “A supervisory fuzzy neural 
network control system for tracking periodic inputs,” IEEE Trans. 
Fuzzy Syst.,, vol. 7, no.1, pp. 41-52, 1999. 
[10] L. X. Wang, A Course in Fuzzy Systems and Control. Englewood 
Cliffs, NJ: Prentice-Hall, 1997. 
[11] F. J. Lin, R. J. Wai, and H. P. Chen, “A PM synchronous servo 
motor drive with an on-line trained fuzzy neural network 
controller,” IEEE Transactions on Energy Conversion, vol. 13, no. 
4, pp. 319-325, Dec. 1998. 
[12] T. J. E. Miller, Switched reluctance motors and their control, 
Clarendon Press, Oxford, 1993. 
[13] A. V. Radun, C. A. Ferreira, E. Richter, “Two channel switched 
reluctance starter/generator results,” IEEE Transactions on 
Industry Applications, vol. 34, no. 5, pp. 1026-1034, Sep./ Oct. 
1998.  
[14] J. G. J. O’Donovan, P. J. Roche, R. C. Kavanagh, M. G. Egan, and 
J. M. D. Murphy, “Neural network based torque ripple 
minimization in a switched reluctance motor,” in Conf. Rec. 
IEEE-IAS Annu. Meeting, 1994, pp. 1226–1231. 
[15] J. J. E. Slotine and W. Li, Applied Nonlinear Control. Englewood 
Cliffs, NJ: Prentice-Hall, 1991. 
[16] K. J. Astrom, and B. Wittenmark, Adaptive Control. New York, 
Addison-Wesley, 1995. 
1 5 0 0 rp m
ω
mω
2 s
2 s
( a )
(b )
tU
0 A
3 0 A
3 0 0 0 rp m
ω
mω
2 s
(c )
(d )
2 s
tU
0 A
3 0 A
1 5 0 0 rp m
ω
mω
2 s
ω
2 s
(a )
( b )
tU
0 A
3 0 A
3 0 0 0 rp m
ω
mω
2 s
(c )
(d )
2 s
tU
0 A
3 0 A
1388
? Y04 
28??plenary session??????????Power Electronics fir Future Utility Applications, 
Digital Control Generations-Digital Controls for Power Electronics Through the Third Generation, 
Power Electronics and Control of Renewable Energy Systems?????200?????????
????105???????????????????????????????????
?????????????????? 
1. Control Method for DC-DC Converters  
2. Convert Control 
3. EMI in Drives  
4. Gate Drive Units 
5. Ultracapacitors and Batteries 
6. Customer Applications 
7. Control Method for AC-DC Converters 
8. System Control and Converter Topologies 
9. Converter Control, Z-Source and Audio  
10. DC-DC Converters 
11. Lighting 
12. Application and System  
13. High Power Density Converters Designs 
14. Pernanent Magnetic Motor Drives 
15. Induction Motor and other AC Drives 
16. Zero Voltage Switching Converters 
17. Current Source Inverters 
18. SIC Unipolar Devices 
19. Bipolar Power Devices 
20. Low Power High Efficient Off-line Converters Topologies 
21. Energy Storage in Transportation 
22. Traction Converter Structures and Their Behavior 
23. Aerospace Power Applications/Power Supplies & Customer Applications 
24. EMC/ Power Quality/ PFC 
25. Intelligent Integrated Drives 
26. Inverter control, Drives and Motion Control 
27. Packaging and Thermal Management  
28. Design Methods and Tools 
29. Rectifier and DC-DC Converters 
30. Resonant Converters  
31. Transportations 
32. UPS systems and Alternative/ Regeneative Energy 
33. Multiphase Drive Systems 
34. Converts for Fuel Cells and Solar Cells 
35. Power Factory Correction  
36. Predictive Control 
37. Advance DC/DC Power Conversion Topologies 
38. Prototyping and Real-time Systems 
39. SR and BLDC Motor Drives 
40. Converter Transformers and Inductors 
41. Sensorless and Low Resolution Sensors 
42. Power Factory Corrector Control and Designs 
43. Matrix Converter Modulation Techniques 
44. AC-AC Converter Circuit 
45. Resonant Converters control, Modeling and Design Methods 
46. Island Converters 
 
Switched Reluctance Motor Drive for Electric Motorcycle Using HFNN Controller 
 
Chih-Hong Lin 
Department of Electrical Engineering                  
National United University, Miao Li, Taiwan            
                          No. 1, Lien-Da, Kung-Chieng Li, Miao Li 360      
E-mail: jhlin@nuu.edu.tw                      
 
Abstract—The switched reluctance motor (SRM) drive 
system using hybrid fuzzy neural network (HFNN) controller is 
developed to control electric motorcycle in this paper. First, the 
dynamic models of a SRM drive system and electric motorcycle 
are builted though experimental tests and  parameters 
measurements. Then, a HFNN speed control system that 
combined supervisor control, FNN control and compensated 
control is developed to control SRM drive system in order to 
drive electric motorcycle. In the proposed HFNN control 
scheme, an optimum phase advancing is achieved by 
continuous adaptation of the optimum conduction position for 
the FNN. The electric motorcycle is operated to provide 
constant disturbance torque. Finally, the effectiveness of the 
proposed control schemes is demonstrated by experimental 
results. 
 
I.  INTRODUCTION 
In recent years, for the purpose of reducing air pollution 
and enhancing environmental protection, quite a few 
countries require their automotive industries to develop 
electric vehicles in place of gasoline-powered automobiles 
gradually. Here we put our attention on the development and 
research of electric motorcycles since motorcycles are much 
more widespread than automobiles for individual 
transportation in Asia. The switched reluctance motor (SRM) 
has emerged as an attractive alternative to DC and AC 
motors for general purpose industrial drives [1-3]. Some of 
these methods use off-line data collected from the machine 
during the static conditions, which change during the motor 
operation due to changes in the motor parameters. Some 
methods use a linear model of the machine, which may not 
be suitable for high-performance applications. 
Recently much research has been done on the 
applications of fuzzy neural network (FNN) systems, which 
have the advantages of both fuzzy systems and neural 
networks, in the control fields to deal with nonlinearities and 
uncertainties of the control systems [4-5]. Moreover, the 
FNN’s are universal approximators [6-7], which can 
approximate any dynamics to a prespecified accuracy by the 
learning process [6]. The fuzzy-neural approximator 
presented in Leu, Lee and Wang [8] tuned on line to 
approximate the unknown nonlinear dynamic systems for 
adaptive control. The supervisory FNN controller proposed 
in Lin, Hwang and Wai [9] comprised a supervisory 
controller which is designed to stabilize the system states 
around a defined bound region, and an FNN sliding-mode 
controller which combines the advantages of the 
sliding-mode control with robust characteristics and the 
FNN with on-line learning ability. The adaptive control 
schemes of nonlinear systems that incorporate the 
techniques of FNNs have also grown rapidly [10-11]. 
Therefore, this paper presents a hybrid  fuzzy neural 
network (HFNN) control SRM drive for electric motorcycle. 
The method is not dependent upon the predetermined 
characteristics of the motor and can adapt to any change in 
the motor characteristics. Finally, some experimental results 
are provided to demonstrate the effectiveness of the 
proposed control schemes. 
 
II.  CONFIGURATION OF SRM DRIVE  
The machine model of a switched reluctance motor 
(SRM) can be described in matrix as follows [12-14] 
abcdsabcdabcdp irv −=λ  (1) 
where 
dt
dp =  is the differential operator, 
T
dcbaabcd ][ λλλλ=λ  is the vector of the stator flux 
linkage, Tdcbaabcd vvvv ][=v is the vector of the stator 
voltages, Tssss rrrdiag ][=r is the vector of the stator 
resistances, Tdcbaabcd iiii ][=i  is the vector of the 
stator currents.  
The vector of the stator flux linkage can be represented as  
abcdabcdabcd iL=λ  (2) 
in which  








=
ddcdbdad
cdccbcac
bdbcbbab
adacabaa
abcd
LLLL
LLLL
LLLL
LLLL
L   (3) 
where abcdL  is called stator inductance matrix, and aaL 、
bbL 、 ccL 、 ddL  are self inductance of per phase, abL 、
acL 、 adL 、 bcL 、 bdL 、 cdL  are mutual inductance of phase 
to phase. Due to the stator windings of the SRM are exciting 
using one-phase exciting method, i.e., mutual inductances 
are zero, therefore, the stator inductance matrix can be 
simplified as  
][
][
ssss
cdccbbaaabcd
LLLLdiag
LLLLdiag
=
=L
 (4) 
where sL is the self inductance. 
 The electromagnetic torque can be expressed as 
PEDS 2007
1-4244-0645-5/07/$20.00©2007 IEEE 1383
 which implies that 0lim =∞→ et , i.e., the system state can track 
the desired trajectories asymptotically. However, the 
parameter variations of the system are difficult to measure, 
and the exact value of the external load disturbance is also 
difficult to know in advance for practical applications. In 
order to control the rotor speed of the SRM effectively, a 
hybrid control system is proposed in this section. The 
configuration of the proposed hybrid control system, which 
combines a supervisory control system, FNN control system 
and compensated control system, is depicted in Fig. 2. The 
reference model shown in Fig. 2 is designed to generate the 
desired reference trajectories. The control law is assumed to 
take the following form [9]: 
CFSt UUUU ++=   (14) 
where SU  is the supervisory control, FU  is the FNN 
control and CU  is a compensated control. The supervisory 
control SU  is designed so that the states of the controlled 
system are stabilized around a redetermined bound region. 
Due to the excessive and chattering control effort induced 
by the supervisory control law, the FNN control and 
compensated control are introduced to reduce and smooth 
the control effort when the system states are inside the 
predefined bound region. The FNN control RU  is the main 
tracking controller used to mimic an idea control law, and 
the compensated control CU  is designed to compensate the 
difference between the idea control law and the FNN control. 
The supervisory control law fires only when the FNN 
approximation properties can not be guaranteed. 
The design of a supervisory hybrid control system is 
necessary for the condition of divergence of states to pull 
the states back to the predetermined bound region and 
guarantee the stability of the system. Inside the bound 
region the FNN control system approximates uniformly the 
idea control law. From (10), (12), and (14), an error 
equation is then obtained as follows: [ ]ACFP UUUUBeke −−−+= *1&  (15) 
In order to achieve a zero steady-state error, an integral 
equation can be defined as   
12 eee && === η      (16) 
Then an error equation can be redefined as follows: 
[ ]ACF UUUU −−−+Λ= *mBEE&   (17) 
where [ ]Tee 21=E is tracking error vector, 



−= 10
10
k
Λ is a stable matrix and [ ]TPB0m =B . 
Then, the Lyapunov function candidate is chosen as follows: 
PEE T
2
1=AV   (18) 
where P is a symmetric positive definite matrix which 
satisfies the following Lyapunov equation [10]: 
QPP −=+ ΛΛT  (19) 
and 0>Q  is selected by the designer. Take the derivative 
of the Lyapunov function and use (17) and (19), then 
[ ]ACFT
B
UUUU
V
−−−+Λ+Λ=
+=
*
2
1
2
1
2
1
2
1
m
TTT
TT
PBEPEEEPE
PEEEPE &&&
 
( ) ACF UUUU mTmTT PBEPBEQEE −−++−≤ *21   (20)  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Fig. 2.  HFNN control system. 
 
To satisfy 0≤BV& , the supervisory control AV is designed 
as follows [10]: 
( ) ( ) ++−= UULCFA GFBUUDU )(1sgn ωmTPBE  
( ) ( ) ++ ekBD mL 11sgn ωmTPBE  (21) 
where )sgn( ⋅  is a sign function, and the operator index 


<=
≥==
VVD
VVD
D
A
A
if,0
if,1  (22) 
in which V is positive constant. Substitute (12) and (19) 
into (18) and consider the case 1=D , then ( )
( )
 ++++−=
−−++−≤
ekwCA
B
UUUUV
mPP
P
ACFB
1
*
1
2
1
2
1
ωω &
&
m
TT
m
T
m
TT
PBEQEE
PBEPBEQEE
( )+++−−−−+ ekGFBUUUU mUULCFCF 11 ω&  
0
2
1 ≤−≤ QEE T  (23) 
Using the designed supervisory control AU  as shown in 
(21), the inequality 0<BV&  can be obtained for nonzero 
value of the tracking error vector E  when VV B > . As 
the results from (23), the supervisory control system is 
capable to drive the tracking error to zero without using the 
FNN control and compensated control system. However, 
owing to the selection of the bounds )(ωUF , UG , 
LB and sign function, the supervisory control law can result 
in excessive and chattering control effort. Therefore, a FNN 
control and compensated control are designed to overcome 
Fuzzy Neural
Network
Controller
emω FU
e
e∆
Tracking
Error
Compensated 
Controller
E
CU
+
++
_
Update Law
Ε
γ
Γ
Hybrid Fuzzy Neural Network (HFNN) Control System 
ijijko mw σ&&& ,,4
Supervisor
Controller
AU
+
tU
SRM Drive System
tK ∑ BJs +
1
LT
+
_
rωeT
)(sH p
11 −− z
Lyapunov
Function
LV
Operator
Index
×
D
Supervisor Control System
Reference
Model
*ω ∑∑
rω
1385
 ( ) ( ) ( )ΟΟΟΟ −−+= **
2
1
2
1 TtV γPEE
T  (31) 
Take the derivative of the Lyapunov function and use (30), 
then 
( ) ( ) ΟΟΟ &&&& TTTtV −−+= *PEEEPE γ12121  
[ ]ACTT UU −−+−= ρm2
1 PBEQEE
( ) ( ) ΟΟΟΓΟΟ &TTmT −−−+ **PBE γ1     (32) 
To satisfy 0)( ≤tV& , the adaptation laws Ο&  and the 
compensated controller CU  are designed as follows [9]: 
ΓΟ mT PBEγ=&  (33) ( )mTCU PBEsgnη=  (34) 
where 0>γ  is denoted as adaptation gains. Substitute (33) 
into (32) and use (21), then 
( ) AmTCmTmTT UUtV PBEPBEPBEQEE −−+−= ρ2
1&  
Cm
T
m
TT UPBEPBEQEE −+−≤ ρ
2
1  (35) 
use (34), thus 
( ) 0
2
1 ≤−≤ QEETtV&  (36) 
Since 0)( ≤tV& , )(tV&  is negative semidefinite (i.e., 
)0()( VtV ≤ ), which implies E  and )( * ΟΟ −  are 
bounded using (31). Let function 2)()( QEETtVt =−=Ξ & , 
and integrate function )(tΞ  with respect to time 
)()0()(0 tVVd
t −=∫ Ξ τς  (37) 
Because )0(V  is bounded, and )(tV  is nonincreasing and 
bounded, then ∞<∫ Ξ∞→ ςς d
t
t 0
)(lim . Differentiate )(tΞ  with 
respect to time, then EQE && Tt =Ξ )( . Since all the variables in 
the right side of (30) are bounded, it implies E&  is also 
bounded. Then )(tΞ  is uniformly continuous [15]. By 
using Barbalat’s lemma [15-16], it can be shown that 
0)(lim =Ξ∞→ tt . Therefore, 0)( →tE  as ∞→t .  
In order to train the FNN effectively, an on-line 
parameter training methodology [9], which is derived using 
the Lyapunov stability theorem and the gradient descent 
method, is omitted. Moreover, the update law [9] is omitted 
here. 
 
IV. EXPERIMENTAL RESULTS 
A block diagram of the DSP-based computer control 
system for a SRM servo drive is depicted in Fig. 1. The 
current-controlled PWM VSI is implemented by the IGBT 
power modules with a switching frequency of 15kHz. The 
control algorithm was implemented by a TMS320C32 
DSP-based control system. A TMS320C32 DSP-based 
control board includes multi-channels of D/A, 
eight-channels programmable PWM and encoder interface 
circuits.  
The control gains of the proposed HFNN control system 
are given in the following: 


= 10 01P , 2201 =k , 1=V , 9.0=γ , 5.0=η  (38) 
First, a 2nd-order transfer function of the following form 
with rise time 0.3sec is chosen as the reference model for 
the periodic step command: 
43.1512s8.77s
43.1512
s2s 222
2
++=++ nn
n
ωζω
ω     (39) 
Some experimental results are provided to demonstrate 
the control performance of SRM drive system using HFNN 
control for electric motorcycle. Two conditions are provided 
in the experimentation here, one being the 1500 rpm and 
3000rpm case without mounted electric motorcycle, another 
being the 1500 rpm and 3000rpm case with mounted electric 
motorcycle. The experimental results of the HFNN control 
system without mounted electric motorcycle and with 
mounted electric motorcycle due to periodic step command 
at 1500 rpm and 3000rpm case are shown in Fig.4 and Fig. 5. 
The speed responses of the SRM without and with mounted 
electric motorcycle at 1500 rpm and 3000rpm case are 
shown in Figs. 4(a), 4(c), 5(a) and 5(c); the associated 
control efforts are shown in Figs. 4(b), 4(d), 5(b) and 5(d), 
respectively. However, owing to the on-line adaptive 
mechanism of FNN and the compensated controller, 
accurate tracking control performance of the SRM can be 
obtained. From the experimental results, the control 
performance of the proposed the HFNN control system is 
suitable for SRM drive for electric motorcycle. 
    
V.  CONCLUSIONS 
The purpose of this paper is to develop a switched 
reluctance machines (SRM) in order to control electric 
motorcycle using a HFNN control. Then, a HFNN speed 
control system that combined supervisor control, FNN 
control and compensated control is developed to control 
SRM drive system in order to drive electric motorcycle. In 
the proposed HFNN control scheme, an optimum phase 
advancing is achieved by continuous adaptation of the 
optimum conduction position for the FNN. The electric 
motorcycle is operated to provide constant disturbance 
torque. Finally, the effectiveness of the proposed control 
schemes is demonstrated by experimental results.  
 
ACKNOWLEDGMENTS 
The author would like to acknowledge the financial 
support of the National Science Council in Taiwan, R.O.C. 
through its grant NSC 96-2221-E-239-035. 
 
REFERENCES 
[1] P. N. Materu, R. Krishnan, “Steady-state analysis of the 
variable-speed switched reluctance motor drive,” IEEE 
Transactions on Industrial Electronics, vol. 36, no. 4, pp. 523-529, 
Nov. 1989. 
1387
