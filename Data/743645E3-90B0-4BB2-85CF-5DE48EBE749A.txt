 2 
的信號（X 射線通過人體後的衰減）還原
重建出器官的 3D 影像，而重建後的影像即
代表器官組織相對於 X 光的穿透特性，或
稱衰減係數(attenuation coefficient)。由於不
同的生物組織對 X 射線的吸收力(或稱阻
射率 radiodensity)不同，可在 X 射源對角之
感應器接收並記錄其強度，稱之為該角度
之投影，在數學上稱為雷登轉換(Radon 
transform，如圖 1 所示)，收集完 180 度之
一維(1D)投影圖之後即可利用數學模型，
經由一系列的數字運算，也就是所謂的反
投影法(backprojection)重建來得到 2D 斷層
面影像；更進一步，如果將 2D 影像用電腦
軟體堆疊，即可形成三維(3D)的立體影像。 
 
圖 1 反投影法(backprojection)為基礎的二
維影像重建 
此外，有別於上述的斷層面掃描堆疊
達成三維成像方式，還有一種稱為錐形投
影(cone-beam projection)方式，錐形投影的
原理乃是由點光源經不同角度得到的 2D
投影資料，然後再直接重建出物體的 3D 影
像，如圖 2 所示。相較於斷層面掃描的作
法，吾人可知錐狀投影方式由於每次掃描
的區域較廣，故對具相同運算能力的電腦
而言，錐狀投影的 3D 重建較橫切面重建方
式所花費的時間要來得更短。 
事實上，目前的醫療大都以數位系統
擷取影像，而由於數位資料在醫療行為上
的日漸普及，以 CT、核磁共振造影
(magnetic resonance imaging，簡稱 MRI)及
超音波為主的醫學影像技術正由 2D 影像
朝向 3D 影像，甚至邁向多重空間影像重建
的發展(如 4D 超音波影像系統已經問世)，
而影像內容也包含了空間、時間、以及功
能變化的觀察。影像分析技術的演進為臨
床醫師帶來了新的資訊，而藉由這方面的
影像資訊，醫師將可對病患的診療和早期
診斷有嶄新的認知與了解。 
 
圖 2 三度空間中的錐形投影幾何 
無論是 CT 或者是 MRI 均十分依賴電
腦去重建其影像的，在不同的數學模式
中，有的利用線性矩陣運算，有的則通過
濾波器後進行向量的相加等，在過去 30 年
中不斷的有新方法或者是現有方法的改良
不斷被提出，但不管是數值逼近或是模型
推算，其運算量都與其影像解析度均呈指
數性的關係，故在要求高維度重建下影像
的解析度提高以及滿足即時分析的需求等
前提下，首先必須解決運算方面的問題。
在這方面，多核心處理器的出現提供了一
個新的可能性，由於其創新的運算架構，
我們能快速的處理大量的資料，其運作方
式對於矩陣的處理、向量的相加，特別是
在 2D 或是 3D 影像的處理上，能提供傳統
CPU 所無法提供的運算效率；實用上來
說，我們能以軟體的方式實現快速高解析
度的影像即時重建、或用以結合新的應用
與功能(例如生物標記的即時定位或術前
定位)、甚至是重建完整即時的動態 3D 影
像，上述應用無論與現有的 DSP 晶片，或
是專為重建影像所設計的 FPGA 硬體電路
相比，多核心處理器更能快速且有效率的
實現複雜的重建運算功能，在系統的維護
與更新方面也將更加便利，可有效降低成
本，故的確值得就此一課題進行深入研究。 
 4 
 
圖4 錐形投影幾何之座標示意圖 
現今之CT多半不是平行光，而是點光
源，其所形成的投影稱做錐狀投影
(cone-beam projection)，如圖4所示。如前
所述，橫切面2D CT影像主要可由平行或扇
形X光束經不同角度照射所得的1D投影資
料重建而得，而由連續切面所得之2D影像
則可進一步堆疊成3D立體影像。至於錐狀
投影重建的原理乃是由點光源經不同角度
得到的2D投影資料重建而直接重建出物體
的3D影像。相較於橫切面掃描的作法，吾
人可知錐狀投影方式由於每次掃描的區域
較廣，故對具相同運算能力的電腦而言，
錐狀投影的3D重建較橫切面重建方式所花
費的時間要來得更短。重建此種CT影像最
常用的方法是由Feldkamp, Davis and Kress
三人所提出的Feldkamp (FDK)演算法，主
要步驟是先把錐狀投影類比出二維之扇型
投影，在將扇型投影經過空間轉換成平行
投影，之後就可以利用前面介紹之FBP來重
建影像，利用座標轉換反投影回疊加至正
確的重建三維位置，再乘上權重函數就可
以得到重建截面，Feldkamp演算法的數學
表示式如(2.3)-(2.10)所示： 
 
 
 
 
 
 
 
 
 
根據(2.3)-(2.10)，吾人可歸納出Feldkamp
演算法可分為下列三步驟進行： 
 
1. 先求出加權後之投影資料(即錐狀投
影資料轉換為平行投影資料) 
2. 將加權後之投影資料通過一濾波器 
3. 將濾波後的資料利用反投影法重建出
3D的立體像素(voxel)值 
考慮步驟1，如(2.3)所示為一投影資料
P(u,v,β)經加權處理後可得P’(u,v,β)，在此加
權函數由(2.4)決定；緊接著是步驟2，即加
權後之投影資料P’(u,v,β)與一個濾波器h(u)
進行迴旋積分運算，如(2.5)所示；最後根
據步驟3，所欲求得之3D立體像素值I(x,y,z)
可由濾波後的資料P*(u,v,β)經一如(2.8)所
定義的加權因子W加權後，再將不同角度β
所得的結果全部加總起來估計而得，如(2.6)
所示。至於(2.7)、(2.9)與(2.10)則表不同座
標系統的轉換關係，其中Dso表點光源與物
體間之距離，Dsi則表點光源與X光屏幕間
之距離。 
3.3 將FDK重建演算法移植到Core i7 
初步的研究先從一個MATLAB的FDK
程式開始，由於MATLAB的向量式語言，
我們反而很難從中歸納出核心執行的關鍵
迴圈，不過MATLAB是非編譯的虛擬機式
程式語言，加上其大量的現成函式，非常
適合用來初期研究，以及了解演算法，在
經一連串測試後，我們規納出演算法必要
的流程，隨後再將FDK演算法改寫成C 
codes。最終的程式流程如圖5所示，輸入為
Ang個NN的投影影像P，輸出為NNN的
三維區域，首先將輸入的投影影像乘上 ，
並進行逐行濾波兩項前處理，由於此兩步
驟是固定的，故而可以採行平行處理的部
份只有核心迴圈。在此，核心迴圈的最外
層為每個投影角β，進入迴圈後，我們先由
x, y算出一個z截面所有的s, t, u，並且將u以
及 兩數值儲存在陣列中 (儲存NN
個)，此乃由於此兩數據在同一個β角的情
況下均是常數的，因此我們只需算一次便
 6 
持一定值，此乃由於 Core i7 只有 4 顆實體
核心，是以更多的執行緒僅會被作業系統
輪流排程，因而無法得到額外平行加速的
效果。至於與 Cell 所得的結果比較，吾人
發現在單執行緒時，利用 Core i7 並沒有得
到較佳的效果，但隨著線程的增加，Core i7
的效能反倒快速超越了 Cell，合理的解釋
之一應是由於Core i7在核心間的共享式快
取架構(shared Cache)達到了極高的運算效
率，而此一硬體加速的結果超越了 Cell 核
心間無共享式快取所得的結果。預計在未
來將積極針對核心間的分散式處理改採不
同平行策略與應用程式最佳化兩大方向進
行深入研究，使此一影像重建硬體加速效
果進一步提升。 
 
圖 8 四種不同實現方式的重建速度比較 
 
五、 參考文獻 
[1] C.-Y. Chu and S.-W. Chen, “Parallel 
implementation for cone-beam based 3D 
Computed Tomography (CT) medical 
image reconstruction on multi-core 
processors,” in IFMBE proceedings, vol. 
25/IV, pp. 2066-2069, 2009. 
[2] Intel Corporation, White paper: Intel next 
generation microarchitecture (Nehalem), 
2008. 
[3] Intel Corporation, White paper: Intel 
QuickPath Architecture, 2008. 
[4] L.A. Feldkamp, L.C. Davis, and J.W. 
Kress, Practical cone-beam algorithm, J. 
Opt. Soc. Am, vol. A1 no. 6, pp. 612-619, 
1984. 
[5] M. Sakamoto and M. Murase, “Parallel 
implementation for 3-D CT image 
reconstruction on cell broadband engine,” 
Multimedia and Expo, 2007 IEEE 
International Conference, pp 276-279, 
July 2007. 
[6] M. Knaup, W. A. Kalender and M. 
Kachelrieß, “Statistical cone–beam CT 
image reconstruction using the cell 
broadband engine” 2006 IEEE Nuclear 
Science Symposium Conference Record, 
pp. 2837-2840, 2006. 
[7] M. Kachelrieß, M. Knaup and O. 
Bockenbach, “Hyperfast perspective 
cone–beam backprojection,” 2006 IEEE 
Nuclear Science Symposium Conference 
Record, pp. 1679-1683, 2006. 
[8] M. Kachelrieß, M. Knaup and O. 
Bockenbach, “Hyperfast parallel–beam 
backprojection,” 2006 IEEE Nuclear 
Science Symposium Conference Record, 
pp. 3111-3114, 2006. 
[9] D. Rivera, D. Schaa, M. Moffie, D. Kaeli, 
“Exploring novel parallelization 
technologies for 3-D imaging 
applications,” 2007 IEEE 19th 
International Symposium on Computer 
Architecture and High Performance 
Computing, pp. 26-33, 2007 
 
六、計畫成果自評 
本研究所開發出的一個利用Intel Core 
i7的平行式處理架構實現3D醫學影像即時
重建之研究經系統模擬與驗證後，除與原
計畫設定研究內容大致相符外，且亦已達
成預期目標。此外，對於學術研究而言，
本計畫成果亦已發表1篇會議論文於2009
年世界醫學物理暨生物醫學工程研討會，
目前亦已投稿SCI 期刊論文一篇，將有助
於提升本國在多核心處理器的編程設計相
關方面的學術研究。另一方面，參與本計
畫之研究生亦可獲得平行處理設計、醫學
影像重建學及嵌入式多核心系統設計的訓
練，同時配合本系所開設之相關課程，如
生醫電子學、嵌入式系統、微處理機、資
料結構、數位訊號處理等，獲得應有的理
論基礎，對於其將來投身電子電機、醫療
科技產業，或是進一步從事學術研究，將
有極大的助益。 
二、與會心得 
本屆年會中所涵蓋的內容相當廣泛，主要針對包括帕金森氏症與行動障礙(Parkinson’s 
disease and movement disorders)、疾病活動的生物標記(biological markers of disease 
activity)、周邊神經系統感染(infections of the peripheral nervous system)、疼痛的新發展
(new developments in pain)、中風的新觀點(new aspects in stroke)、針對三種常見神經肌肉
疾病的務實處理方法 (a pragmatic approach to the management of three common 
neuromuscular disorders)、行為神經學的新領域(new frontiers in behavioral neurology)、杭
亭頓式症(Huntington’s disease)、多發性硬化症的新式口服治療(new oral treatment of 
multiple sclerosis)、植物人(the vegetative state)、退化性失智症的分子概念(molecular 
concepts in degenerative dementias)以及非痙攣性癲癇持續狀態的新概念 (emerging 
concepts in non-convulsive status epilepticus)等共計十二個大主題(main topics)進行探討，
總計四天會議期間，共有約1900篇的論文發表，超過5000名來自世界各地的醫界、學界
及業界人士與會，陣仗可說是十分浩大。此外，透過一些演講、工作坊(此次大會共舉
辦了十五個工作坊)以及海報展示，更使吾人充分瞭解到國際上在上述各個領域目前的重
點研究方向以及成果，可謂獲益良多。 
值得一提的是，本次大會還安排若干個專題研討會(satellite symposium)，本人也選擇參
加一個專為阿茲罕默症（Alzheimer’s Disease）所開闢的專題討論會，對此一引起全球關
注的俗稱為「老年癡呆症」的疾病有了更深刻的認識。事實上，阿茲罕默症是一種神經
退化的疾病，疾病剛開始時，最常被注意到的症狀是病人無法記住人名或東西放錯位
置，也就是會表現出一種所謂「認知異常的症狀」(cognitive symptoms)，這些認知上的
異常症狀將會嚴重地影響病人與周遭人、事、物溝通或互動的能力。而語言障礙為該病
症的早期症狀，之後則可能出現記憶力、學習力、執行力、注意力以及速度與視覺
空間異常等問題。更進一步，如果病情加重，則病人的抽象思考，規劃和認知能力將大
幅降低。上述一連串障礙將會使病人喪失自主生活的能力，這對病人或家屬在生活品質
上所帶來的負面影響不言可喻。由於有近四成的照護者一致認為，語言與溝通障礙為阿
茲罕默症最仙人感困擾的症狀，故本專題討論會主要乃聚焦於語言與溝通障礙上治療的
討論。或許是因為本身具備工程專業背景之故，吾人對於阿茲罕默症的早期診斷方法設
計比較感興趣，亦曾思考過在現行標準的診斷程序之外，另行加入患者腦波訊號或者腦
部電位活動分佈影像特徵來進行該病症初期診斷之可行性，也曾就此一想法在會中與若
干專家學者進行廣泛討論並交換意見。 
而由於生醫電子相關領域及應用為本人的專長與研究興趣之一，故在此次會議中，本人
對於心電圖、腦波等醫學訊號或其他醫學影像應用在神經科學上的相關研究主題特別感
興趣，也分別聆聽了不少相關的口頭與海報論文的發表，結果吾人發現，上述這些領域
的研究發表在數量上比本人預期的還多，且有不少研究內容與成果頗具創新價值。例如
有研究報告指出，無論是痙攣性或非痙攣性的癲癇狀態均可以從腦波的不正常放電中偵
測出來；還有一個針對蛋白尿在腦血管疾病中的影響因子研究，他們在研究材料的採集
中除了血液與尿液檢驗外，也同時蒐集了病人的心電圖與腦血管 CT 影像，並進行一連
串的統計與相關性分析，而由於其所蒐集的研究資料相當完備，是以研究結果的參考價
值相當高；另外，關於偏頭痛的問題，在過去已有文獻證實其與自律神經的調變異常有
關，即交感神經的作用加強時可能導致偏頭痛的發生，而此次會議有來自土耳其的研究
團隊提出研究報告，指出從心電圖中亦可能偵測出偏頭痛的發生，研究人員針對一組有
偏頭痛症狀的病人分別記錄下他們在病發前的 12 導程心電圖，經分析後發現這些病人
的 P 波週期或者散佈的範圍均比一般正常人為大，這也是一個頗為有趣的研究發現，事
實上，根據另一篇發表於本研討會探討關於心因性中風的研究論文中亦指出，經由心電
圖中 P 波的散佈範圍可以預測心因性中風的發生；其他還有探討分析癲癇病人中出現心
血管併發症的頻率與其結構種類之研究，此研究主要乃蒐集一組癲癇病人的日間心電圖
國科會補助計畫衍生研發成果推廣資料表
日期:2011/01/28
國科會補助計畫
計畫名稱: 一個以多核心處理器為基礎的平行式錐形電腦斷層醫學影像重建系統之開發
計畫主持人: 陳思文
計畫編號: 98-2221-E-182-007- 學門領域: 醫用電子
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
無 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
