2Abstract
In this report, we present a simple method of selecting the partial cancellation factors 
(PCFs) for a two-stage hard-decision partial parallel interference cancellation (PPIC) detector 
for direct-sequence code-division multiple access (DS-CDMA) systems. Using Price‚Äôs 
theorem, we derive a range of the optimal PCFs for each PPIC stage in additive white 
Gaussian noise (AWGN) and multipath fading environments, where the lower and upper 
boundary values can be explicitly calculated from the processing gain and the number of users 
of the DS-CDMA system considered. Computer simulation results show that, using the 
average of the lower and upper boundary values as the PCF for each PPIC stage, the bit error 
rate (BER) performance closely approximates that of the real optimal PCFs under AWGN 
environments. Similar results are also obtained for multipath fading cases if the average of the 
lower and upper boundary values is used as the PCF for the first stage and the upper boundary 
value is used as the PCF for the second stage. Moreover, a two-stage PPIC detector using the 
proposed PCFs achieves comparable BER performance to a three-stage PPIC detector using 
arbitrary PCFs. This makes the proposed PCFs attractive for use in PPIC receivers in 
DS-CDMA systems. 
Keywords: code-division multiple access (CDMA), partial cancellation factors, partial 
parallel interference cancellation (PPIC), Price‚Äôs theorem, wireless communications. 
4Second, hard-decision PPIC requires fewer stages to achieve the best possible performance 
than soft-decision PPIC when sufficient knowledge of the amplitude and phase of each user 
are known at the receiver [13]. 
In this report, we first extend the work in [15] to derive a range of the optimal PCF for 
the second PPIC stage in an AWGN environment, and then derive ranges of the optimal PCF 
for both the first and second PPIC stages in a multipath fading environment, where the lower 
and upper boundary values of each range can be explicitly calculated from the processing gain 
and the number of users of the DS-CDMA system considered. Computer simulation results 
show that, using the average of the lower and upper boundary values as the PCF for each 
PPIC stage, the BER performance closely approximates that of the real optimal PCF under 
AWGN cases. Similar results are also obtained for multipath fading cases when the average of 
the lower and upper boundary values is used as the PCF for the first stage and the upper 
boundary value is used as the PCF for the second stage. With these results, reasonable PCFs 
can quickly be calculated without using time-consuming Monte Carlo simulations. It is worth 
mentioning that a two-stage PPIC detector using the proposed PCFs reaches comparable BER 
performance to a three-stage PPIC detector using arbitrary PCFs. In other words, under the 
same BER performance, the proposed PCF selection method can reduce the complexity of a 
PPIC detector, and is therefore attractive for use in DS-CDMA systems. 
Œü«µ‡πà›Ä·Ü∂‡´∏·çï
3.1 SYSTEM MODEL
Consider a synchronous DS-CDMA system with K users and a processing gain N. In this 
system, the transmitted signal for the kth user is given by 
1
0
1( ) ( ) ( ) ( ) ( )
N
k k k b k ki b c
m m i
s t b m c t mT b m c p t mT iT
N

 
    ¬¶ ¬¶ ¬¶      (1) 
where ( )kb m  represents the mth transmitted symbol taking on a value of r1 equiprobably, 
bT  is the symbol duration, 0 1 ( 1){ ,  ,  ...,  }k k k Nc c c   is a random spreading code with each 
element taking on a value of 1r  equiprobably, p(t) is a rectangular pulse (chip waveform) 
with unit power and duration c bT T N , and 
1
0
( ) 1 ( )Nk ki cic t N c p t iT

 
 ¬¶  is the signature 
waveform of the kth user. The baseband received signal under a multipath fading channel can 
be given by 
6Let
N N0 ( 1)
1
1 [0,...,0, ,..., ,0,...,0] ,  0,  1,  ...,  1Tkl k k N
l L l
c c l L
N   
  c      (7) 
be the augmented signature vector of the lth path for the kth user. Thus the received signal 
vector under a multipath fading environment can be expressed as 
1
1 0 1
( ) ( ) ( ) ( ) ( ) ( ) ( )
K L K
kl k kl k k k k
k l k
m A b m m A b m m m mD

   
     ¬¶¬¶ ¬¶r c n f n FAb n    (8) 
where 1
0
L
k kl kll
D
 
 ¬¶f c  is the effective composite signature vector,  F
1 2 ( 1)[ ]K N L K  uf f f"  is the effective composite signature matrix,  A
1 2( , , , )Kdiag A A A!  is the diagonal matrix containing the corresponding received signal 
amplitudes, 1 2( ) [ ( ) ( ) ( )]
T
Km b m b m b m b "  is the vector of symbols transmitted during 
the time interval of interest, and ( )mn  is the noise vector. 
Using multistage PPIC for the DS-CDMA system, we can express the corresponding 
RAKE receivers‚Äô output for all users as follows [1]: 
1 2 1
1 2 1
( ) ( ) [ ( ) ( ) ( )]
[ ( ) ( ) ( )]
H H H H T
K K
T
K K
m m m m m
y m y m y m
u
u
  
 
y F r f r f r f r"
"
    (9) 
Note that an AWGN environment can be obtained by assuming a single-path case for the 
above-mentioned signal model, i.e., letting 0 1 ( 1)1 [ , ,..., ]
T
k k k k N kN c c c   f c , and n(t) be a 
zero-mean real Gaussian noise with variance 2V . In this case, the received signal in (8) 
becomes 
( ) ( ) ( ) ( )
K
l l l k k k
k l
m m m Ab A b m
z
    ¬¶r FAb n c c n     (10) 
3.2 DETERMINATION OF THE PCFS FOR A TWO-STAGE PPIC SCHEME IN AWGN ENVIRONMENTS
3.2.1 A Range of the Optimal PCF for the First PPIC Stage 
Assuming that user l is the desired user, we can express the corresponding matched 
filter‚Äôs output for one symbol duration (i.e., ( )l lb b m ) as follows: 
K
H
l l l l k k kl l l l l l
k l
y Ab A b Ab IU K K
z
      ¬¶c r         (11) 
where 1Hll l lU   c c ,
H
kl l kU  c c ,
H
l lK  c n , and the MAI is 
K
l k k klk l
I A b U
z
 ¬¶ . Denoting the 
soft and hard decisions of the matched filter‚Äôs output for user l by (0)l lb y   and 
8i.e., ( ( 1))Q N K   [20] where 2( ) exp( 2) 2
x
Q x t dtS
f
 ¬≥ , then (15) can be rewritten as 
1, 1
1 2 ( ( 1))
1 2 ( ( 1))
1 ( 1) ( 2) opt
Q N K
p Q N K
N KS 
 
d   
  
         (16) 
It is interesting to note that the lower and upper boundary values can be explicitly calculated 
from the processing gain N and the number of users K.
3.2.2 A Range of the Optimal PCF for the Second PPIC Stage 
If we denote (1) (1)ÀÜ sgn{ }l lb b  ,
(2)
lb  as the soft decision of user l at the second PPIC stage 
and (2) (1)ÀÜÀÜ Kl k k klk lI A b Uz ¬¶  as the estimated MAI at the second PPIC stage based on hard 
decisions from the first PPIC stage, then the second PPIC stage with a PCF equal to p2 can be 
written [6] 
(2) (2) (1) (2) (1)
2 2 2 2 1
(2) (1)
2 1 2
ÀÜ ÀÜ ÀÜ( ) (1 ) ( ) (1 )( )
ÀÜ ÀÜ(1 )
l l l l l l l l
l l l
b p y I p b p y I p y p I
y p I p p I
        
   
 
   (17) 
From [6], the optimal PCF for the second PPIC stage corresponding to the linear minimum 
mean-squared error estimate of l lAb  is given by 
2
2,1 2 1,2 2,1
2, 2 2
1,2 2,1 2 1,2 2,12
optp
V U V V
V V U V V

 
 
      (18) 
where 2,i jV  is the power of the ith random variable at the jth stage, 
2 (2) 2
1,2
ÀÜ{( ) }l l lE I IV K  
is the power of the residual MAI plus noise at the second stage, 2 (1) 22,1 1 ÀÜ{( ) }l l lE I p IV K  
is the power of the residual MAI plus noise at the first stage, and 
(2) (1)
2 1,2 2,1 1
ÀÜ ÀÜ{( )( )}l l l l l lE I I I p IU V V K K      is the correlation between these two 
interference terms. Equation (18) can be rewritten as 
(1) (2) (1) (1) (2) (1)
1 1 1 1
2, (2) (1) 2 (2) (1) 2
1 1
ÀÜ ÀÜ ÀÜ ÀÜ ÀÜ ÀÜ{( )( )} {( )( )}
ÀÜ ÀÜ ÀÜ ÀÜ{( ) } {( ) }
l l l l l l l l l
opt
l l l l
E I p I I p I E I p I I p Ip
E I p I E I p I
K     |
 
  (19) 
where (2) (1)1ÀÜ ÀÜ{ ( )} 0l l lE I p IK  |  when the noise variance is small enough [15]. 
Assuming that the correlation between the hard decisions of the first and second PPIC 
stages is small, the numerator and denominator in (19) are 
(1) (2) (1) (2) (1) 2 (1) 2
1 1 1 1
(2) 2 (1)
,
ÀÜ ÀÜ ÀÜ ÀÜ ÀÜ ÀÜ{( )( )} {[ ( ) ]}
1ÀÜ{ } (1 2 )
l l l l l l l l l
K
l l u e u
u l
E I p I I p I E I I p I I p I
E I I A P
N z
  |  
  ¬¶
    (20) 
and
10
we must first calculate (1) (0) (0)1{ | , } { sgn( ) | , }
K
i i k k ki
k i
E b E b p A b U
z
  ¬¶b »° b »°   , ,  i u v . When the 
noise variance is small enough, the noise‚Äôs effect on the sign function can be ignored and 
(1){ | , }uE b b »°  can be given by 
(1) (0) (0)
1
(0)
1
(0) (1)
1
{ | , } { sgn( ) | , }
                   { | , } sgn( )
ÀÜ                   { | , }
K
u u k k ku
k u
K
K
u k k k i i ik kui k
k u
u u
E b E b p A b
E b p A A b Ab
E b p I
U
U U
z
z
z
 
|  
| 
¬¶
¬¶ ¬¶
b »° b »°
b »°
b »°
  


  (24) 
Similarly, (1) (0) (1)1 ÀÜ{ | , } { | , }v v vE b E b p I| b »° b »°  . With these results, 
(1) (1) (1) (1)
1
(0) (1) (0) (1) (0) (0)
1 1
ÀÜ{ | , } { | , }
ÀÜ ÀÜ                           { | , } { | , }
u u u u u
u u u u u u u
b E b y p I E b
b p I E b p I b E b K
   
|       
b »° b »°
b »° b »°
  
   
  (25) 
and (1) (1){ | , }v v vb E b K |b »°  , where 
(0){ | , } { | , }u u u u u u u uE b E A b I A b IK    b »° b »° . Thus, 
(1) 2 (0)
uvP V U P|  , ^ `(1) (1){(2 1)(2 1) | } 0ul vl u vE E Q QU U   |»° [15], (1)( , )lVar b  b »°
^ `(1) (1) 2 2[ { , }]l lE b E b V  b »°  , and (21) can be rewritten as 
^ `
^ `
(1) (1)
(0) (0)
(2) (1) 2 2 2
ÀÜ ÀÜ1 , | ,
,
2 2 2
ÀÜ ÀÜ1 , | ,
,
1ÀÜ ÀÜ{( ) } 4 { (0,0 | , ) | }
1( 4 { (0,0 | , ) | } )
u v
u v
K K K
l l u u v ul vl uv b b
u l u l v u l
K K K
u u v ul vl uv b b
u l u l v u l
E I p I A A A E E f
N
p A A A E E f
N
U U U V
U U U V
z z z
z z z
 | 
 
¬¶ ¬¶¬¶
¬¶ ¬¶¬¶
b »°
b »°
b »° »°
b »° »°
(26)
According to the assumptions made above, the conditional joint normal pdfs in (22) and 
(23) are as follows: 
(0) (0)
1
, , 2 2
exp( 2)(0,0 , )
2 1u v
T
b b b
b b
uv
f
SV U
 
b »°
m C mb »°        (27) 
(1) (1)
1
, , 2 2
exp( 2)(0,0 , )
2 1u v
T
b b b
b b
uv
f
SV U
c c c|
b »°
m C mb »°        (28) 
where (0) (0)[ { , }, { , }]Tb u vE b E b m b »° b »°  ,
(1) (1)[ { , }, { , }]Tb u vE b E bc  m b »° b »°  , b  C
{( )( ) }Tb bE  b m b m  , and {( )( ) }
T
b b bEc c c c c  C b m b m  with 
(0) (0)[ , ]Tu vb b b    and 
(1) (1)[ , ]Tu vb bc  b   . Since 
1
b
cC  and 1b
C  are positive semi-definite matrices, we can have 
(0) (0), , 2 2,  1
10 (0,0 , ) max  
2 1u v uv uvb b uv
f
U U SV Uzr
 d
b »°
b »°       (29) 
and
12
Following [2], a Gaussian distribution is assumed for (0)lb . That is, 
(0) ( ) ( ) ( )l l l lb m b m mE K         (36) 
where ( )l lm AE   is the equivalent signal amplitude (conditioned on ( )lb m ) and ( )l mK  is a 
zero mean complex-valued Gaussian noise with equivalent variance 1 2 2K kk lN A V

z
¬¶  when 
the signal from different paths are orthogonal for a particular user. With (36), the BER for the 
hard decision of (0)Re{ }lb , i.e., 
(0) (0)ÀÜ sgn(Re{ })l lb b  , is 
(0)
,e lP  
2 1 2 2( [0.5( )])Kl kk lQ A N A V

z
¬¶ . From the variance of the equivalent noise ( )l mK  in (36) 
and the Gaussian approximation for the residual interference and noise in [6], ( )l mK  can be 
assumed as 
( ) ( ) ( )
K
l k k kl l
k l
m A b m w mK U
z
 ¬¶        (37) 
where 1 1
H
kl l kU  c c  and ( )lw m  is a zero mean complex-valued Gaussian noise with 
independent real and imaginary components and covariance matrix equal to 2V I . Using this 
assumption, (36) can be rewritten as 
(0) ( ) ( ) ( ) ( )
K
l l l k k kl l
k l
b A m b m A b m w mU
z
  ¬¶      (38) 
This is similar to the expression of (11) under an AWGN environment, and we can use the 
same procedure as given in Section III-A to find a range of the optimal PCF at the first PPIC 
stage under a multipath channel as follows: 
2 (0) 2 (0)
, ,
1, 2 1 2
,
(1 2 ) 2
1
( 1)
K K
u e u u e uu l u l
optK K K K
u u v uu l u l v l u u l
A P A P
p
A N A A AS
z z

z z z z

d  
 
¬¶ ¬¶
¬¶ ¬¶ ¬¶ ¬¶
    (39) 
With perfect power control (i.e., u vA A A   and 
(0) (0)
,e u eP P ) and that 
(0)
eP  is 
approximated by the BER of the high SNR case, i.e., ( 2 ( 1))Q N K  , we can simplify (39) 
as follows: 
1, 1
1 2 ( 2 ( 1))
1 2 ( 2 ( 1))
1 ( 1) ( 2) opt
Q N K
p Q N K
N KS 
 
d   
  
     (40) 
3.3.2 The Second PPIC Stage‚Äôs Results 
Using the results in Sections III-B and IV-A, we can derive a range of the optimal PCF at 
the second PPIC stage under a multipath channel as follows: 
14
calculated from (16) as (0.5422, 0.9335, 0.7379) and (0.2112, 0.7024, 0.4568), respectively. 
Fig. 2 shows the BER performance of a two-stage hard-decision PPIC detector with the 
optimal PCF at the first stage for different PCFs at the second stage under an AWGN 
environment. The corresponding optimal PCFs at the second stage for different SNRs are 
summarized in Table I. From (34), we can calculate the lower boundary, upper boundary, and 
average values for K   20, 40, 60 as (0.3104, 0.7728, 0.5416), (0.2416, 0.9087, 0.5752), 
and (0.2013, 0.9573, 0.5793), respectively. As shown by Fig. 2, the average value is a good 
choice for the PCF at the second PPIC stage for all the SNR cases.  
Fig. 3 shows the BER performance at each stage of a three-stage PPIC detector for 
different PCF arrangements at the first and second stages (i.e., the optimal, proposed, and 
arbitrary approaches). The PCFs at the first and second stages for these three-stage cases (i.e., 
p1 and p2) are given in Table II and p3 = 0.9 for all the cases. The simulation results 
demonstrate that the proposed PCF selection scheme approximates the optimal approach very 
well and clearly outperforms the arbitrary approach. Moreover, a two-stage PPIC detector 
with the proposed PCFs reaches comparable BER performance to a three-stage PPIC detector 
using arbitrary PCF selection for each stage. Note that the BER performance at the third stage 
for the case using the proposed PCFs at the first and second stages is even better than that of 
the case using the optimal PCFs at the first and second stages; this is due to the fact that p3 is 
an arbitrary value and it does not guarantee better BER performance for the latter case. 
3.4.2 Simulation Results in Multipath Fading Environments 
The multipath channel used in our simulations is based on the model given in Section II, 
where the number of paths for each user is six (L = 6). For each simulation, 1,000 packets are 
applied for each user and each packet contains an independent sequence of 1,000 bits with 
BPSK modulation. In addition, the channel is assumed to be quasi-static, i.e., having constant 
impulse response and no Doppler shift during every packet transmission. Fig. 4 shows the 
corresponding simulation results of a single-stage hard-decision PPIC detector for different 
PCFs, where the optimal PCFs for different SNRs are given in Table III. Similar to that 
illustrated in Fig. 1, the use of the average of the lower and upper boundary values given in 
(40) as the PCF results in close performance to the use of the real optimal PCF for all the 
SNR cases. 
Fig. 5 shows simulation results of a two-stage PPIC detector for different PCFs at the 
second stage under a multipath fading environment, where the optimal PCF is used at the first 
stage. The corresponding optimal PCFs at the second stage for different SNRs are presented 
16
SNR is high or low. It has also been shown that a two-stage PPIC detector using the proposed 
PCFs achieves comparable BER performance to a three-stage PPIC detector using arbitrary 
PCFs. This means that, to achieve the same BER performance, the number of stages (or 
complexity) required for a multistage PPIC detector can be reduced when the proposed PCFs 
are used. This feature supports that the proposed PCF selection method is of great value for 
the design of a PPIC receiver in DS-CDMA systems. Part of this work has been submitted for 
publication in the IEEE Transactions on Communications and the manuscript is under 
revision for the second-round review. In addition to the PCF selection method, we have also 
proposed a low-complexity iterative power allocation scheme for multiuser OFDM systems, 
which has been presented in the 2008 IEEE Vehicular Technology Conference - Spring (VTC 
2008-Spring), Singapore, May 2008. 
Parts of the first-year and second-year works (NSC 94-2213-E-007-048 and NSC 
95-2221-E-007-119 with reports given in the end of this document) have been published in 
the 2006 International Wireless Communications and Mobile Computing Conference 
(IWCMC 2006), Vancouver, Canada, July 2006, the 2007 IEEE Wireless Communications 
and Networking Conference (IEEE WCNC 2007), Hong Kong, March 2007, and the IEEE 
Communications Letters, August 2007. 
œñ«µ‡≠ñ‘µ–é·ùò
[1] S. Verdu, Multiuser Detection. Cambridge, UK: Cambridge University Press, 1998. 
[2] X. Wang and H. V. Poor, Wireless Communication Systems: Advanced Techniques for 
Signal Reception. Upper Saddle River, NJ: Prentice-Hall, 2003. 
[3] R. Lupas and S. Verdu, ‚ÄúLinear multiuser detectors for asynchronous code division 
multiple access channels,‚Äù IEEE Trans. Inform. Theory, vol. 35, pp. 123-136, Jan. 1989. 
[4] U. Madhow and M. Honig, ‚ÄúMMSE interference suppression for direct-sequence 
spread-spectrum CDMA,‚Äù IEEE Trans. Commun., vol. 42, pp. 3178-3188, Dec. 1994. 
[5] M. K. Varanasi and B. Aazhang, ‚ÄúMultistage detection in asynchronous code-division 
multiple-access communications,‚Äù IEEE Trans. Commun., vol. 38, no. 4, pp. 509-519, 
Apr. 1990. 
[6] D. Divsalar, M. K. Simon, and D. Raphaeli, ‚ÄúImproved parallel interference cancellation 
for CDMA,‚Äù IEEE Trans. Commun., vol. 46, pp. 258-268, Feb. 1998. 
[7] D. Guo, L. K. Rasmussen, S. Sun, and T. J. Lim, ‚ÄúA matrix-algebraic approach to linear 
parallel interference cancellation in CDMA,‚Äù IEEE Trans. Commun., vol. 48, pp. 
18
[21] J. C. Liberti, Jr. and T. S. Rappaport, Smart Antennas for Wireless Communications:
IS-95 and Third Generation CDMA Applications. Upper Saddle River, NJ: Prentice Hall, 
1999.
!
œ§«µ·ÉôﬂÑ!
0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
10-2
10-1
100
PCF
B
E
R
K/N = 40/64
0.3169   
(Lower   
Boundary)
0.7998   
(Upper   
Boundary)
0.5584   
(Average)
SNR=0dB
SNR=4dB
SNR=8dB
SNR=12dB
SNR=16dB
SNR=20dB
SNR=100dB
Fig. 1. The BER performance of a single-stage PPIC detector under an AWGN environment. 
TABLE I
THE OPTIMAL PCFS OF THE FIRST AND SECOND PPIC STAGES UNDER AN AWGN ENVIRONMENT
SNR (dB) 0 4 8 12 16 20 100 
1st PPIC Stage 0.55 0.7 0.75 0.7 0.65 0.65 0.6 
Optimal PCF (K/N = 20/64) 
2nd PPIC Stage 0.35 0.55 0.7 0.65 0.55 - - 
1st PPIC Stage 0.5 0.55 0.6 0.6 0.6 0.6 0.6 
Optimal PCF (K/N = 40/64) 
2nd PPIC Stage 0.35 0.45 0.6 0.6 0.55 0.5 0.5 
1st PPIC Stage 0.45 0.5 0.5 0.5 0.5 0.5 0.5 
Optimal PCF (K/N = 60/64) 
2nd PPIC Stage 0.3 0.4 0.45 0.5 0.5 0.5 0.5 
20
0 2 4 6 8 10 12
10-2
10-1
SNR (dB)
B
E
R
K/N = 40/64
1st stage w ith optimal p
1
1st stage w ith proposed p
1
1st stage w ith arbitrary p
1
2nd stage w ith optimal p
1
 and p
2
2nd stage w ith proposed p
1
 and p
2
2nd stage w ith arbitrary p
1
 and p
2
3rd stage w ith optimal p
1
 and p
2
3rd stage w ith proposed p
1
 and p
2
3rd stage w ith arbitrary p
1
 and p
2
Fig. 3. The BER performance at each stage of a three-stage PPIC detector under an AWGN 
environment for different PCF arrangements (optimal, proposed, and arbitrary approaches) at 
the first two stages. 
TABLE II
THREE DIFFERENT PCF ARRANGEMENTS IN FIG. 3.
Optimal PCFs Proposed PCFs Arbitrary PCFs SNR
(dB) p1 p2 p1 p2 p1 p2
0 0.5 0.35 
4 0.55 0.45 
8 0.6 0.6 
12 0.6 0.6 
0.5584 0.5752 0.7 0.8 
22
0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
10-6
10-5
10-4
10-3
10-2
10-1
100
PCF
B
E
R
K/N = 40/64
0.2125   
(Lower   
Boundary)
0.8804   
(Upper   
Boundary)
0.5465   
(Average)
SNR=0dB
SNR=4dB
SNR=8dB
SNR=12dB
Fig. 5. The BER performance of a two-stage PPIC detector with the optimal PCF at the first 
stage under a multipath fading environment.
Ô®àÊîøÈô¢ÂúãÂÆ∂ÁßëÂ≠∏ÂßîÂì°ÊúÉÂ∞àÈ°åÁ†îÁ©∂Ë®àÁï´Êúü‰∏≠ÈÄ≤Ô®ÅÂ†±Âëä 
‰∏ã‰∏ñ‰ª£ÁÑ°Á∑öÈÄöË®äÂü∫È†ªËôïÔß§ÊäÄË°ì‰πãÁ†îÁ©∂ (2/3) 
Investigation of Baseband Technologies for Next-Generation Wireless 
Communications (2/3) 
Ë®àÁï´Á∑®ËôüÔºöNSC 95-2221-E-007-119 
Âü∑Ô®àÊúüÈôêÔºö95 Ô¶é 8 Êúà 1 Êó•Ëá≥ 96 Ô¶é 7 Êúà 31 Êó• 
‰∏ªÊåÅ‰∫∫ÔºöÁéãÊôâÔ•º    ÂúãÔß∑Ê∏ÖËèØÂ§ßÂ≠∏ÈÄöË®äÂ∑•Á®ãÁ†îÁ©∂ÊâÄ 
Ë®àÁï´Ô•´Ëàá‰∫∫Âì°ÔºöÊú±ÊòåÈúá„ÄÅÈô≥Ê≥âÊó≠„ÄÅËî°ÈüªËäù„ÄÅÈô≥ÂøóÂÆó 
 
‰∏Ä„ÄÅ‰∏≠ÊñáÊëòË¶Å 
Âú®Êú¨Êúü‰∏≠Â†±Âëä‰∏≠ÔºåÊàëÂÄëÈáùÂ∞ç‰∏ÄÈÅ©Áî®ÊñºÂ§öËºâÊ≥¢ÂàÜÁ¢º
Â§öÈáçÈÄ≤Êé•Á≥ªÁµ±‰πãËÆäÔ•¢Ô•æÁ∏ÆÊ∏õÂºèÈÉ®ÂàÜÂπ≥Ô®àÂπ≤ÊìæÊ∂àÈô§ÊäÄ
Ë°ìÔºåÊèêÂá∫‰∏ÄÊúÄ‰Ω≥Ê¨äÈáç‰øÇÔ•©ÈÅ∏ÊìáÊ≥ïÔºåÊ≠§ÊñπÊ≥ï‰πÉÁ∂ìÁî±ÊâÄ
Êé®Â∞éÁöÑÊ¨äÈáç‰øÇÔ•©‰πãÂñÆË™øÈÅûÂ¢ûÊ¢ù‰ª∂ËÆäÔ•¢ÂáΩÔ•©ÊúÄÂ∞èÂåñÊâÄ
ÂæóÔºåÂÖ∂‰∏≠ÂêÑÂπ≤ÊìæÊ∂àÈô§Á¥ö‰πãÊúÄ‰Ω≥Ê¨äÈáç‰øÇÔ•©ÁöÜÁõ∏Á≠â„ÄÇÈõª
ËÖ¶Ê®°Êì¨ÁµêÊûúÈ°ØÁ§∫ÔºåÊàëÂÄëÊâÄÊèêÂá∫‰πãÊúÄ‰Ω≥Ê¨äÈáç‰øÇÔ•©ÈÅ∏Êìá
Ê≥ïËÉΩÂ§†ÊúâÊïàÂú∞ÊîπÈÄ≤Á≥ªÁµ±ÁöÑÊÄßËÉΩ„ÄÇ 
ÈóúÈçµË©ûÔºöÂ§öÈáçÂ≠òÂèñÂπ≤Êìæ„ÄÅÂàÜÁ¢ºÂ§öÈáçÈÄ≤Êé•Á≥ªÁµ±„ÄÅÊúÄ‰Ω≥
Ê¨äÈáç‰øÇÔ•©„ÄÅÈÉ®ÂàÜÂπ≥Ô®àÂπ≤ÊìæÊ∂àÈô§„ÄÇ 
Abstract 
In this midterm report, we present an optimal 
weighting factor (OWF) selection algorithm for the 
variance-reduced partial parallel interference 
cancellation (VRPPIC) technique proposed by Wang 
and Wu in multicarrier code division multiple access 
systems. In this approach, a monotonically increasing 
conditional variance function of weighting factors 
derived from the VRPPIC operations is minimized 
under some assumptions so that the OWFs can be 
easily obtained. It is interesting to see that the proposed 
OWFs for all interference cancellation stages are equal. 
Computer simulation results show that the proposed 
OWF selection algorithm can effectively enhance the 
system performance. 
Keywords: Multiple access interference (MAI); 
multicarrier code division multiple access (MC-
CDMA); optimal weighting factor (OWF); partial 
parallel interference cancellation (PPIC). 
‰∫å„ÄÅÁ∑£Áî±ËàáÁõÆÁöÑ 
Multicarrier code division multiple access (MC-
CDMA) is a combination of orthogonal frequency 
division multiplexing and code division multiple access 
(CDMA) that naturally has some advantages, such as 
efficient spectrum utilization and immunity to 
multipath impairment [1]-[3]. This technique is one of 
the promising approaches for fourth-generation 
wireless mobile communication systems. One major 
drawback of MC-CDMA is the multiple access 
interference (MAI) problem in the uplink. To alleviate 
this problem, multiuser detection is often necessary for 
an MC-CDMA uplink system. 
There have been many multiuser detection 
techniques available for CDMA or MC-CDMA 
systems. Among them, parallel interference 
cancellation (PIC) using parallel signal processing has 
received great attention because of its low complexity 
and processing delay [4]. For performance 
improvements, various improved versions of PIC have 
been proposed in the literature, such as partial PIC 
(PPIC) [5] and turbo PPIC [6], [7]. Basically, a PPIC 
scheme estimates MAI and partially cancels it from the 
received signal on a stage-by-stage basis. In [7], Wang 
and Wu introduced a bit estimator after the final stage 
of PPIC to form a variance-reduced PPIC (VRPPIC), 
which can further improve the performance of a PPIC 
scheme for MC-CDMA systems. 
The performance of a multistage PPIC detector is 
always affected by the weighting factors used at each 
stage. To ensure good performance, some optimal 
weighting factor (OWF) selection algorithms were 
proposed for CDMA systems based on minimizing the 
bit-error-rate (BER) [8], [9]. Since the complexity of 
BER analysis increases significantly with the number 
of interference cancellation (IC) stages, these 
approaches are generally not suitable for applications 
with more than two stages. 
In this report, we develop a simple OWF selection 
algorithm without complicated BER analysis for 
VRPPIC in MC-CDMA systems. In this approach, a 
monotonically increasing conditional variance function 
of weighting factors is first derived according to the 
VRPPIC operations, and it is then minimized under 
some assumptions to find the OWF solutions. It is 
interesting to see that the proposed OWFs for all IC 
stages are equal. Computer simulation results show that 
our proposed OWF selection algorithm can enhance the 
system performance in different system loading 
scenarios. 
‰∏â„ÄÅÁµêÊûúËàáË®éÔ•Å 
3.1 SYSTEM MODEL 
Consider a quasi-synchronous MC-CDMA uplink 
system with K active users, where we assume that the 
spreading factor N (‚âßK) is equal to the number of 
subcarriers. Without considering pulse shaping, the 
frequency domain received data vector (after the 
discrete Fourier transform operation) at the receiver 
can be represented by 
3.2.2.2 OWF selection subject to a given first-IC-
stage‚Äôs weighting factor 
Given the first-IC-stage‚Äôs weighting factor, the OWF 
selection algorithm can be summarized by 
( 2) (3) ( )
2
( ),v
, ,..., 
(1)(1)
G
  
   subject to     and (5),
min
M
M
Œ≤ Œ≤ Œ≤
œÉ
Œ≤ Œ≤=
          (9) 
where (1)GŒ≤  is a value that needs to be determined 
appropriately. It is shown in the Appendix that the 
conditional variance function in (8) is monotonically 
increasing with the final weighting factor ( )MŒ≤ . 
Therefore, the solution of (9) can be easily obtained 
without any calculation; that is, 
( ) (1)( 1) (2) (1)... .M M GŒ≤ Œ≤ Œ≤ Œ≤ Œ≤‚àí= = = = =       (10) 
Note that the linear combination in the VRPPIC 
detector is based on (6), so the fidelity of soft decisions 
at each IC stage is still considered when the proposed 
OWFs in (10) are applied. 
3.3  SIMULATION RESULTS 
To demonstrate the effectiveness of the proposed 
OWF selection algorithm, computer simulations were 
performed for the VRPPIC detector in an MC-CDMA 
uplink system. For the purpose of comparison, the 
proposed OWFs ( OWFŒ≤ ), the full-search based OWFs 
( FSŒ≤ ), and the randomly selected weighting factors 
( RSŒ≤ ) were considered. The number of IC stages was 
set to be M=3. Here we find an appropriate weighting 
factor of the first IC stage (1)GŒ≤  by numerically 
searching for one dimension in the (0, 1) interval at 
signal-to-noise ratio (SNR) = 14dB such that the BER 
of the 1-stage PPIC is minimized and obtain the full-
search based OWFs FSŒ≤  by numerically searching for 
three dimensions in the same interval at each SNR case 
such that the BER of VRPPIC is minimized. Although 
the full-search approach for three dimensions is 
impractical, the corresponding results can be used as a 
performance reference of the proposed OWF selection
 
2
( ),v
( 1) ( ) (1)( ) ( 1) (0)
1 1 1
( 1) ( 1) ( ) ( 1) ( ) (2) (1)
( 1) (
[ | ]
          [ ... | ]
           
          {[ (1 ) ... (1 )(1 )...(1 ) ] | }
             {
M
M MM M
M M M
M M M M M
M
Œ≥ Œ≥ Œ≥
Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤
Œ≤ Œ≤
+ ‚àí+ + +
+ + +
+
=
= + + +
= + ‚àí + + ‚àí ‚àí ‚àí
+
s s s
c
œÉ var s s
var p p p s
var w s
var

#
) ( )
( 1) ( ) ( 1) ( 1) ( ) ( 1) ( 1)
( 1) ( ) ( 1) ( 2) ( 1) ( ) ( 1) ( 2)
( 1) (
ÀÜ | }
ÀÜ             {[ (1 ) (1 ) ] | }
             {[ (1 )(1 ) (1 ) (1 )
                      (1 )(1
M M
M M M M M M M
M M M M M M M M
M M
Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤
Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤
Œ≤ Œ≤
+ ‚àí + ‚àí ‚àí
+ ‚àí ‚àí + ‚àí ‚àí
+
+ ‚àí + ‚àí
+ ‚àí ‚àí + ‚àí ‚àí
+ ‚àí ‚àí
i s
var i s
var
) ( 1) ( 2) ( 2)
( 1) ( ) (2) (1) ( 1) ( ) ( 1) (2) (1)
( 1) ( ) (3) (2) (1) (1)
ÀÜ) ] | }
              
             {[ (1 )...(1 ) (1 ) (1 )...(1 ) ...
ÀÜ                      (1 )(1 )...(1 ) ] |
M M M
M M M M M
M M
Œ≤ Œ≤
Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤
Œ≤ Œ≤ Œ≤ Œ≤ Œ≤
‚àí ‚àí ‚àí
+ + ‚àí
+
+ ‚àí ‚àí + ‚àí ‚àí ‚àí +
+ ‚àí ‚àí ‚àí
i s
var
i s
#
}
            (7)
 
v
( )
v
2 ( ) ( ) ( ) ( ) ( ) (2) (1)
( ),v
( ) ( ) ( )
( ) ( ) ( 1) ( ) ( ) (
var{[ (1 ) ... (1 )(1 )...(1 ) ] }
ÀÜ            var{ }
            var{[ (1 ) (1 )
M
M M M M M
M c
W
M M M
I
M M M M M M
w
i
œÉ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤
Œ≤ Œ≤
Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤‚àí
= + ‚àí + + ‚àí ‚àí ‚àí
+
+ ‚àí + ‚àí
	

	

( 1)
v
1) ( 1)
( ) ( ) ( 1) ( 2) ( ) ( ) ( 1) ( 2)
( ) ( ) ( 1) ( 2) ( 2)
ÀÜ] }
            var{[ (1 )(1 ) (1 ) (1 )
ÀÜ                    (1 )(1 ) ] }                         
M
M
I
M M M M M M M M
M M M M M
i
i
Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤
Œ≤ Œ≤ Œ≤ Œ≤
‚àí
‚àí ‚àí
‚àí ‚àí ‚àí ‚àí
‚àí ‚àí ‚àí
+ ‚àí ‚àí + ‚àí ‚àí
+ ‚àí ‚àí
	

( 2 )
v
( ) ( ) (2) (1) ( ) ( ) ( 1) (2) (1)
( ) ( )
                 
             
            var{[ (1 )...(1 ) (1 ) (1 )...(1 ) ...
                    (1 )(1 )...(1
MI
M M M M M
M M
Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤
Œ≤ Œ≤ Œ≤
‚àí
‚àí+ ‚àí ‚àí + ‚àí ‚àí ‚àí +
+ ‚àí ‚àí ‚àí
	

#
(1)
v
(3) (2) (1) (1)
( ) ( 1) ( 2) (1)
v v v v v v v
ÀÜ) ] }                                                   
        ...  
I
M M M
i
W I I I I W I
Œ≤ Œ≤
‚àí ‚àí+ + + + + +
	

 
                  (8)
( ) 4 ( )
v
( ) ( ) ( 1) 2 ( 1)
( ) ( ) ( 1) ( 2) ( ) ( ) ( 1) ( 2) 2 ( 2)
( ) ( ) (2) (1) ( ) ( )
ÀÜ[ ] var{ }
ÀÜ      [2 (1 ) ] var{ }
ÀÜ      [2 (1 )(1 ) (1 )(1 ) ] var{ }
       
      [2 (1 )...(1 ) (1 ) (1
M M
M M M M
M M M M M M M M M
M M M M
I i
i
i
Œ≤
Œ≤ Œ≤ Œ≤
Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤
Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤
‚àí ‚àí
‚àí ‚àí ‚àí ‚àí ‚àí
=
+ ‚àí
+ ‚àí ‚àí + ‚àí ‚àí
+ ‚àí ‚àí + ‚àí
#
( 1) (2) (1)
( ) ( ) (3) (2) (1) 2 (1)
( ) 4 ( ) ( ) ( 1) 2 ( ) ( ) ( 1) ( 2) ( ) ( ) ( 1) ( 2) 2
(
)...(1 ) ...
ÀÜ         (1 )(1 )...(1 ) ] var{ }  
   {[ ] [2 (1 ) ] [2 (1 )(1 ) (1 )(1 ) ] ...
        [2
M
M M
M M M M M M M M M M M M
i
Œ≤ Œ≤ Œ≤
Œ≤ Œ≤ Œ≤ Œ≤ Œ≤
Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤
Œ≤
‚àí
‚àí ‚àí ‚àí ‚àí ‚àí
‚àí ‚àí +
+ ‚àí ‚àí ‚àí
= + ‚àí + ‚àí ‚àí + ‚àí ‚àí +
+ ) ( ) (2) (1) ( ) ( ) ( 1) (2) (1)
( ) ( ) (3) (2) (1) 2 (1)
(1 )...(1 ) (1 ) (1 )...(1 ) ...
ÀÜ           (1 )(1 )...(1 ) ] }var{ }  
M M M M M
M M i
Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤
Œ≤ Œ≤ Œ≤ Œ≤ Œ≤
‚àí‚àí ‚àí + ‚àí ‚àí ‚àí +
+ ‚àí ‚àí ‚àí
 
(AP.2) 
 
( ) 4 ( ) ( ) ( 1) 2 (1)
v
( ) 3 ( ) ( ) ( 1) ( ) ( 1) ( ) ( 1) (1)v
( )
( ) 3 ( ) ( ) ( ) ( 1) 2 (1)
ÀÜ       {[ ] [2 (1 ) ] }var{ }
ÀÜ{4[ ] 2[2 (1 ) ] [2(1 ) 2 ]}var{ }
ÀÜ          {4[ ] 8 (1 )(1 2 )[ ] }var{ }
   
M M M M
M M M M M M M M
M
M M M M M
I i
dI i
d
i
Œ≤ Œ≤ Œ≤ Œ≤
Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤Œ≤
Œ≤ Œ≤ Œ≤ Œ≤ Œ≤
‚àí
‚àí ‚àí ‚àí
‚àí
‚âà + ‚àí
‚âà + ‚àí ‚ãÖ ‚àí ‚àí
= + ‚àí ‚àí
( ) 3 ( ) ( ) ( ) ( 1) 2 ( ) ( ) ( ) ( 1) 2 (1)
( ) ( ) ( ) ( 1) 2 ( ) 2 ( ) ( ) ( 1) 2 (1)
( ) ( )
ÀÜ       {4[ ] 8 (1 )(1 )[ ] 8 (1 ) [ ] }var{ }
ÀÜ          {8 (1 )(1 )[ ] 4[ ] ( 2(1 )[ ] )}var{ }
          {8 (1 )(1
M M M M M M M M M
M M M M M M M M
M M
i
i
Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤
Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤
Œ≤ Œ≤
‚àí ‚àí
‚àí ‚àí
= + ‚àí ‚àí ‚àí ‚àí
= ‚àí ‚àí + ‚àí ‚àí
‚â• ‚àí ( ) ( 1) 2 ( ) 2 ( ) ( ) ( ) 2 (1)
( ) ( ) ( ) ( 1) 2 ( ) 3 ( ) ( ) (1)
positive
ÀÜ)[ ] 4[ ] ( 2(1 )[ ] )}var{ }
ÀÜ          {8 (1 )(1 )[ ] 4[ ] (1 2(1 ) )}var{ } 0
M M M M M M
M M M M M M M
i
i
Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤
Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤ Œ≤
‚àí
‚àí
‚àí + ‚àí ‚àí
= ‚àí ‚àí + ‚àí ‚àí >	

       (AP.3)
 
 
 
Ôßë„ÄÅÔ•´ËÄÉÊñáÁçª 
[1] S. Hara and R. Prasad, ‚ÄúDesign and performance 
of multicarrier CDMA system in frequency-
selective Rayleigh fading channels,‚Äù IEEE Trans. 
Veh. Technol., vol. 48, pp. 1584-1595, Sep. 1999. 
[2] S. Sigdel, K. M. Ahmed, and R. M. A. P. 
Rajatheva, ‚ÄúPerformance evaluation of MC-
CDMA uplink system with diversity reception and 
multiuser detection,‚Äù in Proc. IEEE Wireless 
Personal Multimedia Commun. (WPMC 2002), 
Hawaii, Oct. 2002, pp. 650-654. 
[3] R. van Nee and R. Prasad, OFDM for Wireless 
Multimedia Communications. Boston/London: 
Artech House, 1999. 
[4] D. Divsalar and M. K. Simon, ‚ÄúImproved CDMA 
performance using parallel interference 
cancellation,‚Äù in Proc. IEEE Military Commun. 
Conf., vol. 3, Oct. 1994, pp. 911-917. 
[5] D. Divsalar, M. K. Simon, and D. Raphaeli, 
‚ÄúImproved parallel interference cancellation for 
CDMA,‚Äù IEEE Trans. Commun., vol. 46, pp. 259-
268, Feb. 1998. 
[6] K.-M. Wu and C.-L Wang, ‚ÄúSoft-input soft-output 
partial parallel interference cancellation for DS-
CDMA systems,‚Äù in Proc. IEEE Int. Conf. 
Commun. (ICC 2001), Helsinki, Finland, June 
2001, pp. 1172-1176. 
[7] C.-L. Wang and C.-C. Wu, ‚ÄúImproved partial 
parallel interference cancellation for MC-CDMA 
uplink systems,‚Äù in Proc. IEEE Global 
Telecommun. Conf. (GLOBECOM 2004), Dallas, 
TX, Nov.-Dec. 2004, pp. 2823-2827. 
[8] A. N. Fawzy, A. W. Fayez, and M. M. Riad, 
‚ÄúOptimization of partial parallel interference 
cancellation (PPIC) factor in CDMA systems,‚Äù in 
Proc. IEEE Int. Conf. Syst., Man, and Cybern., 
Nashville, TN, Oct. 2000, pp. 2375-2380. 
[9] C.-H. Hu, S.-Q. Li, Y.-X. Tang, and Z.-L. Li, 
‚ÄúPerformance and optimization of multistage 
partial parallel interference cancellation for 
wideband CDMA systems in multipath fading 
channels,‚Äù IEEE Trans. Veh. Technol., vol. 55, pp. 
1137-1158, July 2006. 
[10] M. K. Varanasi and B. Aazhang, ‚ÄúMultistage 
detection in asynchronous code-division multiple-
access communications,‚Äù IEEE Trans. Commun., 
vol. 38, pp. 509-519, Apr. 1990. 
Ë°åÊîøÈô¢ÂúãÂÆ∂ÁßëÂ≠∏ÂßîÂì°ÊúÉÂ∞àÈ°åÁ†îÁ©∂Ë®àÁï´Êúü‰∏≠ÈÄ≤Â∫¶Â†±Âëä 
‰∏ã‰∏ñ‰ª£ÁÑ°Á∑öÈÄöË®äÂü∫È†ªËôïÁêÜÊäÄË°ì‰πãÁ†îÁ©∂ (1/3) 
Investigation of Baseband Technologies for Next-Generation Wireless 
Communications (1/3) 
Ë®àÁï´Á∑®ËôüÔºöNSC 94-2213-E-007-048 
Âü∑Ë°åÊúüÈôêÔºö94 Âπ¥ 8 Êúà 1 Êó•Ëá≥ 95 Âπ¥ 7 Êúà 31 Êó• 
‰∏ªÊåÅ‰∫∫ÔºöÁéãÊôâËâØ    ÂúãÁ´ãÊ∏ÖËèØÂ§ßÂ≠∏ÈÄöË®äÂ∑•Á®ãÁ†îÁ©∂ÊâÄ 
Ë®àÁï´ÂèÉËàá‰∫∫Âì°ÔºöÊú±ÊòåÈúá„ÄÅÈô≥Ê≥âÊó≠„ÄÅ‰æØÈõÖÊ¶ï„ÄÅÊûóÂ•êÊòá„ÄÅÁü≥ÂÅâ‰Ωë 
 
‰∏Ä„ÄÅ‰∏≠ÊñáÊëòË¶Å 
Âú®Êú¨Êúü‰∏≠Â†±Âëä‰∏≠ÔºåÊàëÂÄëÈáùÂ∞ç‰ΩøÁî®ËÑàÊ≥¢ÂΩ¢ÁãÄË™øËÆä
‰πãË∂ÖÂØ¨È†ªÁ≥ªÁµ±ÊèêÂá∫‰∏ÄÂ§öÈáçËÑàÊ≥¢Âπ≤ÊìæÊ∂àÈô§ÊäÄË°ìÔºåÊ≠§
‰∏ÄÊäÄË°ìÈ°û‰ººÊñºÂàÜÁ¢ºÂ§öÈáçÈÄ≤Êé•Á≥ªÁµ±‰∏≠‰πãÂπ≥Ë°åÂπ≤ÊìæÊ∂à
Èô§Ê¶ÇÂøµÔºåÂÖ∂‰∏≠ÊàëÂÄëË®≠Ë®à‰∫Ü‰∏ÄÁ®ÆÁâπÂÆöÁöÑË®ìÁ∑¥Â∫èÂàó‰æÜ
‰º∞Ê∏¨Âπ≤ÊìæÊ∂àÈô§ÊâÄÈúÄ‰πãÈÄöÈÅìË≥áË®ä„ÄÇÈõªËÖ¶Ê®°Êì¨ÁµêÊûúÈ°Ø
Á§∫ÔºåÊàëÂÄëÊâÄÊèêÂá∫‰πãÊñπÊ≥ïÁöÑÊÄßËÉΩÂú®‰∏çÂêåÁí∞Â¢É‰∏ãÂùáÊòé
È°ØË∂ÖË∂äÂ∏∏Áî®‰πãÊúÄÂ§ßÊØî‰æãÁµêÂêà‰ΩúÊ≥ï„ÄÇÈô§‰∫ÜÂ§öÈáçËÑàÊ≥¢
Âπ≤ÊìæÊ∂àÈô§‰ª•Â§ñÔºåÊàëÂÄë‰∫¶Â∑≤ÈáùÂ∞çÂ§öÁî®Êà∂Ê≠£‰∫§ÂàÜÈ†ªÂ§ö
Â∑•Á≥ªÁµ±‰πãË≥áÊ∫êÂàÜÈÖçÂèäË∑®Â±§Ë®≠Ë®àÊñπÊ≥ïÈÄ≤Ë°åÁ†îÁ©∂ÔºåÈ†ê
Ë®àËøëÊúüÂÜÖÂèØÂ±ïÁèæÂÖ∑È´îÊàêÊûú„ÄÇ 
ÈóúÈçµË©ûÔºöË∑®Â±§Ë®≠Ë®à„ÄÅÂ§öÈáçËÑàÊ≥¢Âπ≤Êìæ„ÄÅÂπ≥Ë°åÂπ≤ÊìæÊ∂à
Èô§„ÄÅÊ≠£‰∫§ÂàÜÈ†ªÂ§öÂ∑•„ÄÅËÑàÊ≥¢ÂΩ¢ÁãÄË™øËÆä„ÄÅË≥áÊ∫êÂàÜÈÖç„ÄÅ
Ë∂ÖÂØ¨È†ªÊäÄË°ì„ÄÇ 
Abstract 
In this midterm report, we propose a multiple-
pulse interference (MPI) cancellation scheme for 
ultra-wideband systems using pulse shape modulation. 
The proposed scheme is based on a similar concept to 
parallel interference cancellation for code-division 
multiple-access systems, where a specific training 
sequence structure is used to estimate the channel 
information and interference for MPI cancellation. 
Computer simulation results are given to show that it 
has much better performance than the maximum ratio 
combining scheme in different scenarios. In addition 
to MPI cancellation, we have also investigated 
resource allocation and cross-layer design methods for 
multiuser OFDM systems. It is expected that we can 
have some results of these works shortly. 
Keywords: Cross-layer design; multiple-pulse 
interference (MPI); parallel interference cancellation 
(PIC); OFDM; pulse shape modulation (PSM); 
resource allocation; ultra-wideband (UWB) 
technology. 
‰∫å„ÄÅÁ∑£Áî±ËàáÁõÆÁöÑ 
Ultra-wideband (UWB) technology has several 
important applications, including ground penetrating 
radar, image processing, and short range 
communications [1]. After the Federal 
Communications Commission (FCC) allocated 7.5 
GHz of spectrum for unlicensed use of ultra-wideband 
devices in the 3.1 to 10.6 GHz frequency band [2], 
UWB technology has attracted more and more 
interests. 
Impulse radio is one of the common signal types 
for UWB systems [3], where short pulses are directly 
radiated to the air. Using short pulses for transmission 
has some advantages. For example, the power 
spectrum density of the pulse spreads the energy very 
thinly over several GHz, and it does not interfere with 
other narrowband signals. Also, the system is robust 
to multipath fading environments because its high 
resolution channel supplies many multipath 
components as a resource for RAKE receivers. For 
efficient transmission, a variety of modulation 
methods can be employed for UWB systems, where 
pulse position modulation (PPM) [4] is one of the 
most popular schemes developed to date. A PPM 
UWB system transmits only one pulse in a frame time 
(or pulse repetition time). In order to achieve higher 
data rates, we must shorten the frame time for the 
system. However, this will increase the 
implementation complexity of the transceiver, and the 
corresponding timing acquisition will become very 
difficult to handle. In contrast, with pulse shape 
modulation (PSM) [5] for UWB systems, we can 
increase the data rate without shortening the frame 
time by transmitting several orthogonal pulses (each 
for one data bit) within the same frame time. One 
major problem associated with PSM is that the 
orthogonality among pulses would be destroyed in 
multipath environments. This may cause a multiple-
pulse interference (MPI) problem and limit the 
capacity of a PSM UWB system. 
In this report, an interference cancellation scheme 
is proposed to alleviate the MPI problem in PSM 
UWB systems. The proposed method is similar to 
parallel interference cancellation (PIC) for code-
division multiple-access (CDMA) systems [6]. It 
makes use of a specific training sequence structure to 
estimate the channel information as well as the 
interference among all orthogonal pulses first, and 
then cancel all the interference (i.e., MPI) from the 
received signal. Computer simulation results show 
that the proposed scheme can effectively reduce MPI 
for PSM UWB systems in different scenarios. 
[ ]
[ ] [ ]
[ ] [ ] [ ] [ ]
[ ] [ ]
[ ]
, ,
, , ,
, , , , ,
, , ,
, ,
1 0 0
2 1 0 0
0 1 2 1 ,
0 0 0 1 1
0 0 0 1
T
n m s n m
n m s n m n m
n m n m n m n m n m
n m n m n m s
n m n m s
g JN g L
g N g L g L
g g g L g L
g g g L N
g g L JN
‚é° ‚é§‚àí‚é° ‚é§‚é£ ‚é¶‚é¢ ‚é•‚é¢ ‚é•‚é¢ ‚é•‚àí ‚àí‚é° ‚é§‚é£ ‚é¶‚é¢ ‚é•= ‚àí ‚àí‚é¢ ‚é•‚é¢ ‚é•‚àí ‚àí‚é° ‚é§‚é£ ‚é¶‚é¢ ‚é•‚é¢ ‚é•‚é¢ ‚é•‚àí ‚àí‚é° ‚é§‚é£ ‚é¶‚é£ ‚é¶
G
" " "
# # # #
" "
" " "
" "
# # # #
" " "
                      (14)
[ ] [ ] [ ](1), , , ,
0 0 0
0 0 0
,0 1 1
0 0 0
0 0 0
T
n m n m n m n mg g g L
‚é° ‚é§‚é¢ ‚é•‚é¢ ‚é•‚é¢ ‚é•‚é¢ ‚é•= ‚àí‚é¢ ‚é•‚é¢ ‚é•‚é¢ ‚é•‚é¢ ‚é•‚é¢ ‚é•‚é£ ‚é¶
G
"
# # % #
"
"
"
# # % #
"
                                                         (15) 
[ ] [ ]
[ ] [ ] [ ]
[ ] [ ] [ ]
[ ] [ ]
, ,
, , ,
(2)
,
, , ,
, ,
1 0 0
2 1 0 0
0 0 0 0 .
0 0 0 1 1
0 0 0 1
T
n m s n m
n m s n m n m
n m
n m n m n m s
n m n m s
g JN g L
g N g L g L
g g g L N
g g L JN
‚é° ‚é§‚àí‚é¢ ‚é•‚é¢ ‚é•‚é¢ ‚é•‚àí ‚àí‚é¢ ‚é•= ‚é¢ ‚é•‚é¢ ‚é•‚àí ‚àí‚é¢ ‚é•‚é¢ ‚é•‚é¢ ‚é•‚àí ‚àí‚é£ ‚é¶
G
" " "
# # # #
" "
" " "
" "
# # # #
" " "
                               (16) 
 
 
3.2 PIC-BASED MPI CANCELLATION 
3.2.1 The Conventional PIC Technique 
The PIC technique had been proposed to reduce 
multiple access interference (MAI) for CDMA systems 
[6]. One advantage of this technique is its ease of 
implementation, as compared with other linear 
multiuser detectors such as minimum mean square 
error detectors and decorrelator detectors. The concept 
of PIC is to treat the received signal as a resource for 
reconstructing MAI and then cancel it from the 
received signal. 
To achieve better performance, multistage PIC is 
usually considered for CDMA systems. At the sth 
interference cancellation (IC) stage, the reconstructed 
MAI of the kth bit for the vth user can be written as 
( ) [ ] ( ) [ ] [ ] [ ]1 1
1 0, 
ÀÜÀÜ
c u
s
N N
s
v n n n v
i n n v
I k a b k c i c i
‚àí
‚àí
= = ‚â†
‚éõ ‚éû= ‚éú ‚éü‚éù ‚é†‚àë ‚àë         (17) 
where Nc is the processing gain, Nu is the number of 
users, an is the amplitude of the nth user, ( )ÀÜ snb [k] is the 
kth estimated bit for the nth user, and cn[i] is the ith 
chip of the spreading code for the nth user. After 
reconstructing MAI, the decision of the kth bit for the 
vth user is made by 
 ( ) [ ] ( ) [ ]( )ÀÜ ÀÜsgns sTv v k vb k I k= ‚àíc p                 (18) 
where pk is the received signal vector corresponding to 
the kth bit, vc  is the spreading code vector for the vth 
user, and sgn(‚Ä¢) is the sign function. Note that the 
elements of pk and vc  are in chip level, and the initial 
decisions (prior to the first IC stage) of the kth bit for 
all users are as follows: 
( ) [ ] ( )0ÀÜ sgn ,   0,  1,  ...,  1Tn v k ub k n N= = ‚àíc p .       (19) 
The PIC technique has low complexity and can 
effectively suppress MAI. Based on the concept of PIC, 
we will design a similar scheme to reduce MPI for 
PSM UWB systems in the next subsection. 
3.2.2 The Proposed Method 
Assume the guard-time Tg of the PSM UWB system 
is long enough and effectively works. Then the ISI 
term in (10) can be ignored and only the MPI problem 
needs to be considered. For the multiuser case, a PSM 
UWB system distinguishes the users by orthogonal 
pulses. So the corresponding MPI problem is similar to 
the MAI problem of CDMA systems. Following the 
conventional PIC approach for MAI cancellation, we 
can derive a scheme to reconstruct MPI for the desired 
user from the received signal and then cancel the MPI 
estimate from the received signal.  
To reconstruct MPI, we design a special training 
sequence structure as shown in Fig. 2 for estimation of 
the equivalent channel impulse response 
, , , ,[0] [1] ... [ 1]
T
n m n m n m n mg g g L‚é° ‚é§= ‚àí‚é£ ‚é¶g  corresponding to the 
nth pulse (used for the nth user) received at the mth 
matched filter. The sequence œân in Fig. 2 is modulated 
by the orthogonal pulse pn(t) to estimate gn,m for 
reconstructing the interference among different pulses. 
order. This implies that we can get throughput 
increment without degrading the system performance 
significantly by appropriately increasing the 
modulation order of a PSM UWB system. It should 
also be noted that, the higher the modulation order, the 
more complexity the transceiver will involve. 
Therefore, we need to choose the modulation order 
properly such that the BER performance, the 
throughput rate, and the transceiver‚Äôs complexity can 
be balanced. Part of this work has been accepted for 
presentation in the 2006 International Wireless 
Communications and Mobile Computing Conference 
(IWCMC 2006), Vancouver, Canada, July 2006. In 
addition to PIC-based interference cancellation, we 
have also investigated resource allocation and cross-
layer design methods for multiuser OFDM systems. It 
is expected that we can have some results of these 
works shortly. 
‰∫î„ÄÅÂèÉËÄÉÊñáÁçª 
[1] D. Porcino and W. Hirt, ‚ÄúUltra-wideband radio 
technology: potential and challenges ahead,‚Äù IEEE 
Commun. Mag., vol. 41, pp. 66-74, July 2003. 
[2] G. R. Aiello and G. D. Rogerson, ‚ÄúUltra-wideband 
wireless systems,‚Äù IEEE Microwave Mag., vol. 
4, pp. 36-47, June 2003. 
[3] M. Z. Win and Z. A. Scholtz, ‚ÄúImpulse radio: how 
it works,‚Äù IEEE Commun. Lett., vol. 2, pp. 245-
247, Jan. 1998. 
[4] M. Z. Win and R. A. Scholtz, ‚ÄúUltra-wide 
bandwidth time-hopping spread-spectrum impulse 
radio for wireless multiple-access 
communications,‚Äù IEEE Trans. Commun., vol. 
48, pp. 679-689, Apr. 2000. 
[5] L. B. Michael, M. Ghavami, and R. Kohno, 
‚ÄúMultiple pulse generator for ultra-wideband 
communication using Hermite polynomial based 
orthogonal pulses,‚Äù in Proc. IEEE Ultra Wideband 
Systems and Technologies (UWBST ‚Äô02), 
Baltimore, MD, May 2002, pp. 47-51. 
[6] D. Divsalar and M. K. Simon, ‚ÄúImproved CDMA 
performance using parallel interference 
cancellation,‚Äù in Proc. IEEE Military Commun. 
Conf., vol. 3, Oct. 1994, pp. 911-917. 
[7] K. Usuda, H. Zhang, and M. Nakagawa, ‚ÄúM-ary 
pulse shape modulation for PSWF-based UWB 
systems in multipath fading environment,‚Äù in Proc. 
IEEE Global Telecommun. Conf. 
(GLOBECOM ‚Äô04), vol. 6, Dec. 2004, pp. 3498-
3504. 
[8] N. Boubaker and K. B. Letaief, ‚ÄúBiorthogonal 
pulse shape modulation for ultra-wideband 
wireless communications,‚Äù in Proc. IEEE Global 
Telecommun. Conf. (GLOBECOM ‚Äô04), vol. 6, 
Dec. 2004, pp. 3493-3497. 
[9] B. Parr, B. Cho, K. Wallace, and Z. Ding, ‚ÄúA 
novel ultra-wideband pulse design algorithm,‚Äù 
IEEE Commun. Lett., vol. 7, pp. 219-221, May 
2003. 
[10] G. Durisi and S. Benedetto, ‚ÄúPerformance 
evaluation and comparison of different modulation 
schemes for UWB multiaccess systems,‚Äù in Proc. 
IEEE Int. Conf. Commun. (ICC ‚Äô03), vol. 3, May 
2003, pp. 2187-2191. 
[11] D. Cassioli, M. Z. Win, F. Vatalaro, and A. F. 
Molisch, ‚ÄúPerformance of low-complexity RAKE 
reception in a realistic UWB channel,‚Äù in Proc. 
IEEE Int. Conf. Commun. (ICC ‚Äô02), vol. 2, Apr. 
2002, pp. 763-767. 
[12] S. Verdu, Multiuser Detection. Cambridge, UK: 
Cambridge University Press, 1988. 
 
ÂÖ≠„ÄÅÂúñË°® 
 
 
Fig. 1. A PIC-based receiver structure. 
  
Fig. 6. A performance comparison between the MRC 
RAKE receiver and the proposed scheme for various 
numbers of RAKE fingers (modulation order = 4; 
guard time = 7Tp; 4 users). 
 
 
Fig. 7. A performance comparison between the MRC 
RAKE receiver and the proposed scheme for various 
numbers of RAKE fingers   (modulation order = 8; 
guard time = 7Tp; single user). 
 
0 2 4 6 8 10 12
10-5
10-4
10-3
10-2
10-1
100
Eb/No
B
E
R
1-stage PIC with  5 fingers
1-stage PIC with 10 fingers
1-stage PIC with 20 fingers
2-stage PIC with  5 fingers
2-stage PIC with 10 fingers
2-stage PIC with 20 fingers
 
Fig. 8. A performance comparison between the 
proposed scheme with 1-stage PIC and that with 2-
stage PIC for   various numbers of RAKE fingers  
(modulation order = 8; guard time = 7Tp; single user). 
 2
Multiuser OFDM Systems„ÄÇÂâçËÄÖ‰ª• oral ÊñπÂºèÁôºË°®ÔºåÂÖßÂÆπÊé¢Ë®é OFDM Á≥ªÁµ±‰∏≠
ÂèØÂêåÊôÇÈÄ≤Ô®àÊôÇÈñìÂêåÊ≠•ËàáÈÄöÈÅì‰º∞Ê∏¨ÁöÑÊñπÊ≥ï (‰∫¶Âç≥Ô¶óÂêàÊôÇÈñìÂêåÊ≠•ËàáÈÄöÈÅì‰º∞Ê∏¨Êñπ
Ê≥ï)ÔºåÊ≠§ÊñπÊ≥ïÁÇ∫ÊàëÂÄëÈÅéÂéªÊâÄÁôºË°®‰ΩúÂìÅ‰πãÊîπÈÄ≤ÁâàÊú¨ÔºåÔ•ßÂÉÖË§áÈõúÔ®Å‰ΩéÔºå‰∏îÊïàËÉΩ‰∫¶
Áõ∏Áï∂ÂÑ™Ë∂äÔºõÂæåËÄÖ‰ª• poster ÊñπÂºèÁôºË°®ÔºåÂÖßÂÆπÊé¢Ë®éÂ¶Ç‰Ωï‰ª•‰ΩéË§áÈõúÔ®ÅËø≠‰ª£ÊñπÂºèÂ∞ç
Â§öÁî®Êà∂ OFDM Á≥ªÁµ±ÈÄ≤Ô®àÂäüÔ•°ÂàÜÈÖçÔºå‰ª•‰ΩøÁ∏ΩÂÇ≥Ëº∏Ô•°ÈÅîÂà∞ÊúÄÂ§ß‰∏îÂêÑÁî®Êà∂‰πãÂÇ≥Ëº∏
Ô•°‰∫¶ËÉΩÁ¨¶ÂêàÊâÄË®≠ÂÆö‰πãÊØîÔ¶µÈôêÂà∂„ÄÇÊ≠§‰∫åÁØáÔ•ÅÊñá‰πã‰ΩúÊ≥ïÂÖ∑ÊúâÂâµÊÑèÔºåÂØ¶Áî®ÊÄßÈ´òÔºå
Âõ†Ê≠§ÔºåÂú®Ô•ÅÊñáÁôºË°®ÈÅéÁ®ã‰∏≠ÔºåÂê∏ÂºïÔ•ßÂ∞ëÂ≠∏ËÄÖÂ∞àÂÆ∂Ô•´ËàáË®éÔ•Å„ÄÇÈô§Ô¶∫ÁôºË°®Ô•ÅÊñáÂ§ñÔºå
Êú¨‰∫∫‰∫¶Ô•´ËàáÔ¶∫‰∏Ä‰∫õÁÜ±ÈñÄË≠∞Á®ã‰∏ªÈ°åÊúÉÂ†¥ÔºåËÅΩÂèñÂ≠∏ËÄÖÂ∞àÂÆ∂ÁôºË°®ÊúÄÊñ∞ÁöÑÁ†îÁ©∂Êàê
ÊûúÔºåÂåÖÊã¨ OFDM„ÄÅMIMO„ÄÅSynchronization„ÄÅResource Allocation„ÄÅCooperative 
Systems„ÄÅCognitive Radio Á≠âÊäÄË°ìÈ†ÖÁõÆÔºõÈÄô‰∫õÊúÄÊñ∞ÊäÄË°ìË®äÊÅØÂ∞çÊú¨‰∫∫Á†îÁ©∂ÊñπÂêë
‰πãÊéåÊè°ÂèäÁ†îÁ©∂‰∏ªÈ°å‰πãÈÅ∏ÂÆöÈ†óÊúâÂä©Ô®ó„ÄÇ 
VTC ÊòØÁÑ°Á∑ö„ÄÅÔ®àÂãïÈÄöË®äÔ¶¥Âüü‰∏≠Áõ∏Áï∂ÂÖ∑Êúâ‰ª£Ë°®ÊÄßÁöÑÂ§ßÂûãÊúÉË≠∞ÔºåÁõÆÂâçÂúãÂÖß
ÁÑ°Á∑ö„ÄÅÔ®àÂãïÈÄöË®äÁî¢Ê•≠Ê≠£Ëì¨ÂãÉÁôºÂ±ïÔºåÁÇ∫ÊéåÊè°Áõ∏ÈóúÁßëÊäÄÁôºÂ±ïÂãïÊÖãÔºåÊèêÊòáÊäÄË°ìÁ†î
ÁôºÊ∞¥Ê∫ñÔºåVTC ÊòØÈ†óÂÄºÂæóÂúã‰∫∫Ô•´ËàáÁöÑÊúÉË≠∞„ÄÇÂÄºÂæó‰∏ÄÊèêÁöÑÊòØÔºåÂè∞Â§ß„ÄÅÊ∏ÖÂ§ß„ÄÅ‰∫§
Â§ßÂèäÂè∞Ô•£ÁßëÂ§ßÁöÑ‰∏Ä‰∫õÁõ∏ÈóúÔ¶¥ÂüüÊïôÊéà (ÂåÖÂê´Êú¨‰∫∫) Â∑≤È†ÜÔßùÂêë IEEE Ô§ÇËºõÂàÜÊúÉÁà≠
ÂèñÂà∞ VTC2010-Spring ÁöÑ‰∏ªËæ¶Ê¨äÔºåÈ†êË®àÊñº 2010 Ô¶é 5 ÊúàÂú®Âè∞Ô•£ËàâÔ®àÔºåÂõ†Ê≠§Ôºå
ÊàëÂÄë‰∫¶ÊñºÊú¨Ê¨° VTC Â§ßÊúÉ‰∏≠ÔºåÂêë IEEE Ô§ÇËºõÂàÜÊúÉÂ†±ÂëäÁ±åÂÇôÔß∫Ê≥Å„ÄÇÊúüÂæÖ
VTC2010-Spring ÁöÑÂà∞Ô§≠ÔºåÔ§ÅÂ∏åÊúõÂÖ∂ËàâÔ®àÂèØÁÇ∫ÊàëÂúãÁÑ°Á∑ö„ÄÅÔ®àÂãïÈÄöË®äÁî¢Ê•≠ÁôºÂ±ï
ÂèäÔ§ÇËºâË≥áÈÄöË®äÁî¢Ê•≠ÁôºÂ±ïÊ≥®ÂÖ•Êñ∞ÁöÑÂãïÔ¶ä„ÄÇ 
 
‚ÄªÊîúÂõûË≥áÔ¶æÔºöProceedings of the 2008 IEEE Vehicular Technology Conference - 
Spring (VTC2008-Spring Ô•ÅÊñáÈõÜÂÖâÁ¢üÁâá)„ÄÇ 
A. The Training Sequence 
     The proposed scheme is developed based on the training 
sequence described in Fig. 2. The autocorrelation function of a 
m-sequence is periodic and two-valued. For a bipolar 
m-sequence bP=[b(0), b(1), ‚Ä¶, b(P√≠1)], where each sample 
within the sequence is either +1 or √≠1, its autocorrelation 
function can be shown to be 
( ) ( )( )( ) ( )
( )( )
1
0
1
1,   for 0
1 ,           elsewhere
P
bb P
n
P
R d b n d b n
P
d
P
‚àí
=
‚â° + ‚ãÖ
¬≠ ¬Ω=
¬∞ ¬∞
= ¬Æ ¬æ
‚àí¬∞ ¬∞
¬Ø ¬ø
¬¶
                 (1) 
where the notation ((‚ãÖ))P represents the operation of modulo P.
Assuming M1 and M2 represent the lengths of the cyclic prefix 
and postfix respectively, the relation b(n)=b(n+P) holds for 
n=√≠M1, √≠M1+1, ‚Ä¶, M2√≠1. A reasonable constrain is made that 
both the lengths of the cyclic extensions are chosen to be longer 
than the number of effective taps of the sample-spaced CIR, 
which is denoted by hL=[h(0), h(1), ‚Ä¶, h(L√≠1)]. 
B. The Correlator Output 
Due to the cyclic extensions attached, part of the received 
training sequence can be modeled as the cyclic convolution of 
the CIR and the m-sequence. For time indexes n=√≠M1+L√≠1, 
√≠M1+L, ‚Ä¶, P+M2√≠1, it can be expressed as 
( ) ( ) ( )( )( ) ( )1
0
         
L
P
k
y n h k b n k w n
‚àí
=
= ‚àí +¬¶       (2) 
where w(n) denotes the additive white Gaussian noise (AWGN). 
By calculating the crosscorrelation function between the 
received training sequence and the m-sequence, we have 
( )
( ) ( )
( ) ( )( )( ) ( ) ( )
( ) ( )( )( ) ( )
( ) ( )
( ) ( ) ( )
( ) ( )
( )
1
0
1 1
0 0
1 1
0 0
1
0
1 1
1
0 0
 0
1
1         
1         
1
1 1 ,            
       1
yb
P
n
P L
P
n k
L P
P
k n
P
n
L P
k n
L
k
k d
R d
y n d b n
P
h k b n d k w n d b n
P
h k b n d k b n
P
w n d b n
P
h k w n d b n d R
P P
h d h k
P
‚àí
=
‚àí ‚àí
= =
‚àí ‚àí
= =
‚àí
=
‚àí ‚àí
= =
=
‚â†
‚â° +
¬™ ¬∫
= + ‚àí + +¬´ ¬ª
¬´ ¬ª¬¨ ¬º
¬™ ¬∫
= + ‚àí¬´ ¬ª
¬´ ¬ª¬¨ ¬º
+ +
‚àí + + ‚àà
=
‚àí +
¬¶
¬¶ ¬¶
¬¶ ¬¶
¬¶
¬¶ ¬¶
( ) ( )
1 1
2
0
1 ,
P
n
w n d b n d R
P
‚àí ‚àí
=
¬≠ ¬Ω
¬∞ ¬∞
¬∞ ¬∞¬∞ ¬∞
¬Æ ¬æ
¬∞ ¬∞+ ‚àà
¬∞ ¬∞
¬∞ ¬∞¬Ø ¬ø
¬¶ ¬¶
 (3) 
where R1={√≠M1+L√≠1, √≠M1+L, ‚Ä¶, √≠1, L, L+1‚Ä¶, M2} and 
R2={0, 1, ‚Ä¶, L√≠1}. Due to the training sequence described in 
Fig. 2, the crosscorrelation function shows different 
characteristics in regions R1 and R2 respectively. In region R2, it 
contains the CIR garbled by noise and interference. The 
interference term 
( ) ( )
( )
1
 0
1 L
k
k d
I d h k
P
‚àí
=
‚â†
‚â° ‚àí ¬¶                            (4) 
is in consequence of the two-valued autocorrelation function of 
the m-sequence described in (1). 
C. The Probability Density Functions of the Correlator 
Outputs in Rayleigh Fading Channels 
Based on the results derived in (3), Ryb(d) contains an 
interference term and a noise term. In order to analyze the 
related distribution functions, some notations are introduced in 
advance. Let 2av wSNR P œÉ‚â° where Pav is the average power of 
the m-sequence and 2wœÉ  represents the AWGN power. Also let 
the average total power of the channel taps be unity to ensure 
the same received power. By analyzing the distribution of the 
noise term and the interference term respectively, we have 
concluded the following results for Rayleigh fading channels: 
( )
( )
( )
( )
1
2
0
1
2
0
1 2
0
1 2
0
1 1Re 0,  
2
1 1Im 0,  
2
1Re ( ) 0,  
2
1Im ( ) 0,  
2
L
k
L
k
P
av
n
P
av
n
h k N
P P
h k N
P P
P
w n d b n N
P P SNR
P
w n d b n N
P P SNR
‚àí
=
‚àí
=
‚àí
=
‚àí
=
¬≠ ¬Ω¬∞ ¬∞ ¬ß ¬∑
‚àí¬Æ ¬æ ¬® ¬∏¬© ¬π¬∞ ¬∞¬Ø ¬ø
¬≠ ¬Ω¬∞ ¬∞ ¬ß ¬∑
‚àí¬Æ ¬æ ¬® ¬∏¬© ¬π¬∞ ¬∞¬Ø ¬ø
¬≠ ¬Ω ¬ß ¬∑¬∞ ¬∞
+ ¬® ¬∏¬Æ ¬æ ¬® ¬∏
‚ãÖ¬∞ ¬∞ ¬© ¬π¬Ø ¬ø
¬≠ ¬Ω ¬ß ¬∑¬∞ ¬∞
+ ¬® ¬∏¬Æ ¬æ ¬® ¬∏
‚ãÖ¬∞ ¬∞ ¬© ¬π¬Ø ¬ø
¬¶
¬¶
¬¶
¬¶




           (5) 
where the notations Re{‚ãÖ} and Im{‚ãÖ} represent the operation of 
extracting the real part and imaginary part from its argument 
respectively and N(0, ƒ±2) denotes a zero mean Gaussian random 
variable with variance ƒ±2. Based on these results, the absolute 
value of Ryb(d) can be shown to be Rayleigh-distributed with 
the following PDF : 
( )
2
22
2 ,      0
Rd
d
r
d
R
rf r e rœÉ
œÉ
‚àí
= ‚â•                       (6.1) 
where 
2
12
2
2 2
2
22
.
1                           
22
1 1(1 )     
2 22
d
av
R
d av
P
d R
P SNRP
P
d R
P P SNRP
œÉ
œÉ
¬≠ ¬Ω
+ ‚àà¬∞ ¬∞
‚ãÖ¬∞ ¬∞
= ¬Æ ¬æ
¬∞ ¬∞+ + + ‚àà¬∞ ¬∞
‚ãÖ¬Ø ¬ø
       (6.2) 
For 2d R‚àà , the PDF is closely related to the average power of 
the dth channel tap ( 2dœÉ ). On the other hand, the PDF is 
independent to the time index d in region R1.
909
Authorized licensed use limited to: National Tsing Hua University. Downloaded on October 30, 2008 at 09:54 from IEEE Xplore.  Restrictions apply.
III. SIMULATION RESULTS
     The proposed joint time synchronization and channel 
estimation scheme and a previous approach [8] are evaluated 
under 10-path Rayleigh and Ricean fading channels where part 
of their average power profile is illustrated in TABLE II. The 
Rayleigh fading channel model has been discussed in detail in 
[8]. 
TABLE II. THE AVERAGE POWER PROFILE OF DIFFERENT CHANNELS
 CH I [12] 
(Rayleigh) 
CH II 
(Rayleigh) 
CH III [13] 
(Ricean, K=1) 
2
0œÉ 0.6321 0.2325 0.5 
2
1œÉ 0.2325 0.6321 0.3354 
2
2œÉ 0.0855 0.0855 0.1104 
2
3œÉ 0.0315 0.0315 0.0363 
An OFDM packet is composed of a training sequence 
followed by several OFDM data symbols. The structure of 
OFDM data symbols within the transmitted packet followed the 
same specifications described in [1]. A CFO, which is 
uniformly distributed within 0.5¬± subcarrier spacing, is also 
introduced independently from one packet to another. During 
our simulations, the modulatable orthogonal sequence [9] has 
been adopted to form the training sequence structure described 
in Fig. 1. The corresponding parameters were chosen as (M1, P,
M2)=(18, 64, 17). It should be noted that the length of a 
modulatable orthogonal sequence should be the square of a 
natural number. A primitive polynomial of degree 6 (1+D+D6)
had also been adopted to generate a m-sequence with period 
26√≠1. The parameters (M1, P, M2)=(18, 63, 18) were chosen to 
form the training sequence described in Fig. 2. 
The proposed scheme and a conventional one [8] are 
evaluated in several aspects. The results of the probability of 
perfect time synchronization are illustrated in TABLE III. 
Since the proposed scheme utilizes an optimized threshold, it 
has the highest probability of perfect time synchronization 
among all the cases considered. For the two different channel 
conditions, where the values of 20œÉ are 0.6321 and 0.2325 
respectively, the proposed scheme leads to comparable results 
as SNR increases. On the contrary, the conventional scheme 
can perform very differently even the same alpha is adopted. 
Once a particular alpha has been chosen, it remains fixed, 
which leads to insignificant performance gain as SNR 
increases. 
TABLE III. THE PROBABILITY OF PERFECT TIME SYNCHRONIZATION FOR 
DIFFERENT APPROACHES
 SNR 
10 dB 
  SNR 
15 dB 
SNR 
20 dB 
Ref. [8] (Œ±=1/2, CH I) 0.8971 0.9008 0.9020 
Ref. [8] (Œ±=1/2, CH II) 0.5780 0.5839 0.5852 
Ref. [8] (Œ±=1/3, CH I) 0.9446 0.9499 0.9520 
Proposed ( optŒ≤ , CH I) 0.9747 0.9895 0.9946 
Proposed ( optŒ≤ , CH II) 0.9444 0.9744 0.9859 
The bit-error-rate (BER) performances of the proposed 
scheme and the conventional one [8] are demonstrated in Fig. 5. 
The proposed scheme outperforms the conventional one due to 
the utilization of the optimal threshold, which adapts itself to 
the SNR, the period of the m-sequence, and the channel 
characteristics. Again, the proposed scheme is much more 
robust against channel changes comparing to the conventional 
one. Although better BER results could be obtained by 
substituting other values of alpha in the conventional scheme, 
the extensive trial and error process will be time-consuming 
and therefore unrealistic. The ultimate BER bound provided 
that the receiver is able to acquire the exact knowledge of 
symbol timing, CFO, and CIR is also illustrated as a reference. 
The BER performances of some variations of the proposed 
scheme are demonstrated in Fig. 6. Recall that »ïopt is a function 
of P, SNR, and 20œÉ . Since P should be known to the receiver 
and SNR can be constantly monitored by SNR estimation 
algorithms, »ïopt can be determined if 20œÉ  is also available to the 
receiver. In Fig. 3, we have shown that different values of 
2
0œÉ lead to similar values of »ïopt. Consequently, if the value 
of 20œÉ is unavailable, the threshold in (8) will be calculated by 
assuming 20 0.5œÉ = . Simulation results show that the proposed 
scheme leads to similar results with or without knowing the 
actual value of 20œÉ . With proper CFO estimation and 
compensation, which can be done by CP, the proposed scheme 
leads to similar results as compared to the case without any 
CFO. In other words, the effect of residual CFO is insignificant 
to the proposed scheme. Furthermore, although the optimal 
threshold is derived from Rayleigh fading channels, it can be 
utilized to assist joint time synchronization and channel 
estimation in Ricean fading channels as well. 
IV. CONCLUSIONS
We have presented a new joint time synchronization and 
channel estimation scheme based on m-sequences. The 
proposed scheme relies on an optimal threshold, which adapts 
itself to the SNR, the period of the m-sequence, and the channel 
characteristics, to ensure good performance. The proposed 
scheme outperforms a conventional scheme [8] and involves 
lower complexity. 
REFERENCES
[1] IEEE, ‚ÄúPart 11: Wireless LAN Medium Access Control (MAC) and 
Physical Layer (PHY) Specifications: High Speed Physical Layer in the 
5-GHz Band,‚Äù IEEE Std 802.11a-1999. 
[2] IEEE, ‚ÄúPart 16: Air Interface for Fixed Broadband Wireless Access 
Systems--Amendment 1--Management Information Base,‚Äù IEEE Std 
802.16f-2005. 
[3] IEEE, ‚ÄúPart 16: Air Interface for Fixed and Mobile Broadband Wireless 
Access Systems Amendment for Physical and Medium Access Control 
Layers for Combined Fixed and Mobile Operation in Licensed Bands,‚Äù 
IEEE Std 802.16e-2005. 
[4] J. J. van de Beek, M. Sandell, and P. O. B√∂rjesson, ‚ÄúML estimation of 
time and frequency offset in OFDM   systems,‚Äù IEEE Trans. Signal 
Processing, vol. 45, pp. 1800-1805, July 1997. 
[5] D. Landstr√∂m, S. K. Wilson, J. J. van de Beek, P. √ñdling, and P. O. 
B√∂rjesson, ‚ÄúSymbol time offset estimation in coherent OFDM systems,‚Äù 
in Proc. Int. conf. On Commun., Vancouver, BC, Canada, June 1999, pp. 
500-505. 
911
Authorized licensed use limited to: National Tsing Hua University. Downloaded on October 30, 2008 at 09:54 from IEEE Xplore.  Restrictions apply.
A Low-Complexity Iterative Power Allocation 
Scheme for Multiuser OFDM Systems 
 
Chin-Liang Wang 
Department of Electrical Engineering and Institute of 
Communications Engineering 
National Tsing Hua University 
Hsinchu, Taiwan 30013, Republic of China 
E-mail: clwang@ee.nthu.edu.tw 
Chiuan-Hsu Chen 
Institute of Communications Engineering 
National Tsing Hua University 
Hsinchu, Taiwan 30013, Republic of China
 
Abstract‚ÄîMultiuser orthogonal frequency division multiplexing 
(MU-OFDM) is a promising technique for future wide-area 
mobile communications, which can provide scalable high data 
rate transmission. In this paper, we propose a low-complexity 
iterative power allocation algorithm with proportional rate 
constraints. After appropriate subcarrier allocation with equal 
power distribution, the proposed algorithm can achieve 
proportional rates among users in a few iterations by 
determining each user‚Äôs power subject to the rate constraints and 
then equally distributing it to the corresponding subcarriers. 
Simulation results show that, for the equal rate case, the 
proposed approach achieves more than 98% of the minimum 
user‚Äôs capacity provided by a near-optimal power allocation 
algorithm when the number of subcarriers is 128. When the 
number of subcarriers increases to 1024, the proposed method 
approaches the optimal performance. 
Keywords-multiuser orthogonal frequency division multiplexing 
(MU-OFDM); power allocation; proportional rate constraints; 
resource allocation 
I.  INTRODUCTION 
Multiuser orthogonal frequency division multiplexing (MU-
OFDM), or OFDM access (OFDMA), is a modulation and 
multiple-access technique for high data rate transmission. It 
has been considered as one of the promising techniques for 
next-generation wireless communication systems [1], and has 
been adopted in the IEEE 802.16e standard [2]. 
Due to the inherent flexibility of OFDM in power loading 
across the subcarriers, the resource allocation, which involves 
subcarrier and power allocation, is an active area of research in 
recent years. An efficient resource allocation algorithm can 
improve the spectral efficiency and provide good quality of 
service [3]. There are two equivalent optimization problem 
formulations for resource allocation [4]; one is margin adaptive 
(MA) and the other is rate adaptive (RA). The MA formulation 
is to do subcarrier and power allocation in a way that the total 
power required is minimized, with a constraint on the users‚Äô 
data rates or bit error rates. In contrast, the RA formulation is to 
maximize each user‚Äôs error free data rate with a total transmit 
power constraint. It has turned out that the optimal subcarrier 
and power allocation in an OFDMA system can be 
simultaneously done with linear complexity on the order of  the 
number of subcarriers times the number of users by applying 
Lagrange dual decomposition [5], [6]. 
In this paper, we concentrate on the RA optimization 
techniques with additional proportional rate constraints. In [7], 
the sum capacity without proportional rate constraints was 
proved to be maximum when the power was allocated across 
subcarriers by the water-filling algorithm. The RA 
optimization method described in [8] (referred to as the RC 
algorithm) maximized the minimum user‚Äôs capacity, which 
can be regarded as a special case of the proportional rate 
constraints problem. The study in [9] (referred to as the SAE 
algorithm) focused on maximizing the sum capacity subject to 
the proportional rate constraints of users‚Äô data rates. This 
approach involves solving a set of nonlinear equations to get 
the power distribution among users under a high channel-to-
noise ratio (CNR) assumption and needs to calculate some 
parameters in advance, with complexity proportional to the 
number of subcarriers. Then the greedy water-filling algorithm 
is used for power distribution among subcarriers of each user. 
Although the SAE algorithm achieves near-optimum 
performance, its computational complexity is pretty high. In 
[10], Wong et al. proposed an algorithm which is simpler than 
the SAE algorithm but the proportional rate constraints are not 
strictly enforced. 
In this paper, we develop a low-complexity iterative power 
allocation algorithm to achieve proportional rates among users. 
Instead of solving the nonlinear equations in [9], the total 
available power for each user is updated iteratively such that 
the corresponding capacities approach the proportional rate 
constraints. Based on rough resource allocation by the RC 
algorithm with the proportional rate constraints [9], the desired 
rate proportionality can be fulfilled by the proposed algorithm 
in just a few iterations and the complexity required is 
proportional to the number of users. Instead of using the 
complicated greedy water-filling algorithm for power 
distribution among subcarriers of each user, the proposed 
algorithm equally distributes the power to all subcarriers of 
each user, which involves much lower complexity. Simulation 
results show that the proposed approach meets reasonable 
proportional rate constraints in comparison with the SAE 
algorithm when the number of subcarriers is 128. When the 
number of subcarriers increases to 1024, the proposed method 
even outperforms the SAE algorithm due to the fact that the 
high CNR assumption in some subcarriers is not held. 
This paper is organized as follows. Section II introduces the 
MU-OFDM system model and formulates resource allocation 
as an RA optimization problem. In Section III, the near-optimal 
This work was supported by the National Science Council of the Republic 
of China under Grants NSC 95-2221-E-007-119 and NSC 96-2221-E-007-067
978-1-4244-1645-5/08/$25.00  ¬©2008 IEEE 1935
Authorized licensed use limited to: National Tsing Hua University. Downloaded on October 30, 2008 at 09:57 from IEEE Xplore.  Restrictions apply.
power is (0)k total kP P N N=  and the resulting capacity is 
(0) 1
2 ,1
log (1 )kNk total k nnR N P H N
‚àí
=
= +‚àë . The goal of the iterative 
power allocation algorithm is to adjust the total power for all 
users at each iteration such that k k l lR RŒ≥ Œ≥‚Ä≤ ‚Ä≤= , k l‚â† . 
With the above results, the capacity difference between kR‚Ä≤  
and ( )mkR  is 
,( ) ( )
2 ( )
1 ,
( )
2 2 2( ) ( ) ( )
1
11 log ( )
1
1 log ( ) log ( ) log (1 )
k
k
N
k k n km m
k k k m
n k k n k
N m
k k k k k
m m m
n k k k
P H N
R R R
N P H N
P N P N P
N P N P N P
=
=
‚Ä≤+
‚Ä≤‚àÜ = ‚àí =
+
‚Ä≤ ‚Ä≤ ‚àÜ
‚âà = = +
‚àë
‚àë
(7) 
where ( ) ( )m mk k kP P P‚Ä≤‚àÜ = ‚àí  and both the terms ,k k n kP H N‚Ä≤  and 
( )
,
m
k k n kP H N  are assumed to be much greater than 1 [9]. With 
the Taylor series for ln(1 )x+  about x = 0 [12], i.e., 
2 3 4
ln(1 ) ,  1 1
2 3 4
x x xx x x+ = ‚àí + ‚àí + ‚àí < ‚â§"   (8) 
(7) can be approximated by 
( )
( ) ( ) ( )
( ) ,  | |ln 2
m
m m mk k
k k km
k
N PR P P
NP
‚àÜ‚àÜ ‚âà ‚àÜ     (9) 
Assuming that the set 1{ }
K
i iR =‚Ä≤  satisfies k k l lR RŒ≥ Œ≥‚Ä≤ ‚Ä≤= , k l‚â† , as 
the given constraints, the proportional capacity difference 
between kR‚Ä≤  and 
( )m
kR  can be expressed by 
( ) ( ) ( ) ( ) ( ) ( )m m m m m m
k k k l k l l k
k k k l k l k
R R R R R R R R
Œ≥ Œ≥ Œ≥ Œ≥ Œ≥ Œ≥ Œ≥
‚Ä≤ ‚Ä≤‚àÜ + ‚àÜ
= ‚àí = ‚àí = ‚àí
 (10) 
From (9), we can rewrite (10) as 
( ) ( ) ( ) ( )
( ) ( )ln 2 ln 2
m m m m
k k l l l k
m m
k k l l l k
N P R N P R
N P N PŒ≥ Œ≥ Œ≥ Œ≥
‚àÜ ‚àÜ
= + ‚àí   (11) 
Thus the power difference for user k is 
( ) ( ) ( ) ( )
( ) ( )
( ) ( ) ln 2
m m m m
m mk l k k k l k
k lm
l k l k l k
N P N P R RP P
N P N
Œ≥ Œ≥
Œ≥ Œ≥ Œ≥
‚àÜ = ‚àÜ + ‚àí    (12) 
With ( )
1
0K mkk P= ‚àÜ =‚àë , we can derive the power difference for 
user l as follows: 
( ) ( ) ( )( )
( ) 1
( )
1
[ ]ln 2
K m m mm
k l k k l km l k
l K m
l k k kk
P R R NNPP
N P N
Œ≥ Œ≥
Œ≥
=
=
‚àí
‚àÜ = √ó‚àë ‚àë
 (13) 
The numerator of ( )mlP‚àÜ  indicates that, the closer the value of 
( ) ( )
1{ }
m m K
l k k l kR RŒ≥ Œ≥ =‚àí to zero, the closer the value of ( )mlP‚àÜ  to 
zero. This means that when the capacities satisfy the given 
proportional rate constraints, all the power differences are zero 
since l k k lR RŒ≥ Œ≥‚Ä≤ ‚Ä≤= , k l‚â† . Finally, the updated power and 
capacity equations for user l are  ( 1) ( ) ( )m m ml l lP P P
+
= + ‚àÜ  and 
( ) ( )
( 1) ( ) ( )
2 ( ) ( )log (1 ) ln 2
m m
m m ml l l l
l l lm m
l l
N P N PR R R
N P NP
+ ‚àÜ ‚àÜ
‚âà + + ‚âà +   (14) 
From the above derivations, there are two issues needed to 
be investigated: 1) Does ( ) ( )| |m mk kP P‚àÜ   always hold?; 2) Is the 
algorithm convergent when the power is updated continuously? 
A. Condition for the Approximation 
Assume that ( )mŒ±  is the step size at the mth iteration of the 
power allocation algorithm and ( )mp  is a K√ó1 column vector 
with ith element ( ) ( )m mi iP P‚àÜ . When ( ) ( )| |m mk kP P‚àÜ / , ( )mŒ±  can 
be designed such that this approximation is held. Thus, the 
updated power equation for user k becomes ( 1) ( )m mk kP P
+
= +  
( ) ( ) ( ) ( ) ( ) ( )(1 )m m m m m mk k k kP P P PŒ± Œ±‚àÜ = + ‚àÜ , where 
( ) ( )0.4 || ||m mŒ±
‚àû
= p . 
It means that ( )mŒ±  makes ( ) ( )m mk kP P‚àÜ  be normalized by their 
maximum absolute value and then multiply 0.4. This value, 0.4, 
is chosen such that 80% approximation is attained, i.e., 
| [ ln(1 )] ln(1 ) | 0.2x x x‚àí + + ‚âà , and provides a good tradeoff 
between accuracy and convergence speed. By multiplying ( )mŒ± , 
the desired approximation is held and the above derivations can 
iteratively update the power for all users. 
B. Convergence of the Proposed Algorithm 
Proposition: With the condition in the last subsection, the 
proposed algorithm is convergent provided ( )mŒ±  satisfies  
( )0 2mŒ±< < , 0,1, 2,...m = . 
Proof: With (7), (9), (14), and the condition in the last 
subsection, the capacity for user k at the (m+1)th iteration is 
( 1) ( ) ( ) ( ) ( ) ( ) ( )( )m m m m m m mk k k k k kR R R R R RŒ± Œ±
+
‚Ä≤‚âà + ‚àÜ = + ‚àí  (15) 
Defining an error factor ( 1) ( 1)m mk k ku R R
+ +
‚Ä≤= ‚àí  and subtracting kR‚Ä≤  
from both sides of (15), yields 
( 1) ( ) ( ) ( ) ( ) ( )(1 )m m m m m mk k k ku u u uŒ± Œ±
+
‚âà ‚àí = ‚àí    (16) 
Proving that the proposed algorithm converges to kR‚Ä≤ , reduces 
to proving that the error factor ( 1)mku
+  converges to zero. Using 
repeated substitution, (16) can be expressed as ( 1)mku
+
‚âà  
( ) (0)
0
(1 )m i ki uŒ±= ‚àí‚àè . Consequently, ( 1)lim 0mkm u +‚Üí‚àû ‚Üí  provided 
( )|1 | 1iŒ±‚àí < , 0,1,...,i m=  . That is, ( )0 2mŒ±< < , 0,1, 2,...m = . ‚ñ† 
With this proposition and ( ) ( )0.4 || ||m mŒ±
‚àû
= p  when 
( ) ( )| |m mk kP P‚àÜ / , the step size at the mth iteration can be 
determined as 
( ) ( )min(0.4 || || ,1)m mŒ±
‚àû
= p     (17) 
since ( ) ( )| |m mk kP P‚àÜ   is held when ( )0.4 || || 1m ‚àû >p . 
C. Termination of the Iteration 
From [9], a quantity, average rate constraint deviation 
(RCD), to measure how well the rate constraints are satisfied 
can be defined as 
,1
1
| |1
2 2min
K
I k i kk
i
kk
R
I
Œ≥
Œ≥
=
=
‚àí
=
‚àí
‚àë‚àë  D     (18) 
where 
, , ,1
K
k i k i u iu
R R R
=
= ‚àë  is the normalized capacity of user k 
for channel realization i, 
1
K
k k uu
Œ≥ Œ≥ Œ≥
=
= ‚àë  is the normalized 
rate constraint, and I is the total number of channel realizations. 
To avoid infinite loops, the terminated condition of each 
channel realization can be determined by checking if 
( ) ( )
,1
| |Km mi k i kk R Œ≥=Œ¶ = ‚àí‚àë    is much smaller than (0)iŒ¶  or not, where 
( ) ( ) ( )
, , ,1
Km m m
k i k i u iu
R R R
=
= ‚àë . In this paper, we stop the algorithm 
when ( ) (0)0.1mi iŒ¶ < Œ¶ . That is, the RCD of the proposed 
algorithm is about a tenth of the RCD of the RC algorithm. 
1937
Authorized licensed use limited to: National Tsing Hua University. Downloaded on October 30, 2008 at 09:57 from IEEE Xplore.  Restrictions apply.
