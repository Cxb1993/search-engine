   
2 
PV system is an alternative method. Khas [5] proposed a 
four-parameter model in which the shunt resistance Rp is 
not considered in the PSIM, hence, the terminal electrical 
performance of solar cell can be expressed by an explicit 
function. However, a drawback goes with this method. The 
existence of shunt resistance influences the shape of the i-v 
curves. Simulation without considering the shunt resistance 
may obtain results different from measurement. Gow [6] 
proposed a double exponential model for PV cells, and 
simulated it with Pspice. Castaner and Silvester [7] 
published a book which illustrated how to model PV 
systems using Pspice.  
While Pspice excels in the simulation of electronic 
circuits, it is not a good tool for simulating an electric 
power system to which a PV system is to be connected. On 
the other hand, EMTP is a famous tool for power system 
network simulation which is an appropriate tool to simulate 
PV generator, especially when the PV system under 
consideration is connected to an AC grid.  
This paper proposes a new model of PV generator 
based on a piecewise linear parallel branches circuit that 
assimilates PV generator and can easily be used by the 
EMTP and its modeling tool “MODELS” [8]. The principle 
of the proposed model is to approximate the nonlinear i-v 
characteristic by several piecewise linear functions which 
can be fulfilled by several parallel linear branches. Once 
solar irradiance or temperature changes, the values of 
circuit components of the parallel branches change as well. 
This mechanism takes the effects of temperature and solar 
irradiance into account. To verify the proposed model, the 
i-v and P-v characteristics of PV generator are generated by 
EMTP simulation for different conditions of solar radiation, 
temperature, load and partial shading phenomenon. The 
forgoing simulation results are then compared with those 
obtained from equation-oriented model, and good 
agreements between both methods have been achieved. 
This paper is organized as follows: Section 2 shows 
the equation-oriented model which can be solved by 
mathematics software such as Mathcad. Section 3 is the 
development of the proposed model. This is followed by 
the comparison of the results obtained by the 
equation-oriented model and by the piecewise linear 
parallel branches model under several different conditions. 
3. EQUATION-ORIENTED MODEL 
The photocurrent Il is proportional to the irradiance G 
(w/m2) and corrected by the cell temperature. 
( )0
0
1l g c ref
GI I T T
G
⎛ ⎞ ⎡ ⎤= ⋅ ⋅ + α −⎜ ⎟ ⎣ ⎦⎝ ⎠
               (1) 
where Ig0 is the photocurrent at the standard test condition 
G0=1kw/m2, α  (%/℃ ) the temperature coefficient of 
photocurrent, Tc (K) the PN junction temperature, Tref (K) 
the reference temperature, and Id the diode current which 
can be expressed by the following expression: 
( )
0 exp 1
s
d
c
q V IR
I I
nkT
⎡ ⎤+⎛ ⎞= ⋅ −⎢ ⎥⎜ ⎟⎜ ⎟⎢ ⎥⎝ ⎠⎣ ⎦
                     
 (2) 
where q is the electronic charge, V and I are the across 
voltage and current flowing into the load of a solar cell 
respectively, Rs  the series resistance, n the ideality factor, 
k (J/K) Boltzmann constant, and I0 the saturation current. I0 
can be expressed by the following expression: 
3
0 0
1 1exp gcd
ref ref c
qET
I I
T nk T T
⎡ ⎤⎛ ⎞ ⎛ ⎞= −⎢ ⎥⎜ ⎟ ⎜ ⎟⎜ ⎟ ⎜ ⎟⎢ ⎥⎝ ⎠ ⎝ ⎠⎣ ⎦
             (3) 
where Id0 is the saturation current at temperature Tref and Eg 
(eV) the energy gap: 
2
41.16 7.02 10
1108
c
g
c
T
E
T
−= − × +                           
 (4) 
Tc can be estimated by the following equation: 
20
0.8c a
NOCTT T G−⎛ ⎞= + ⋅⎜ ⎟⎝ ⎠                                    
 (5) 
where Ta (C) is the surrounding temperature,  NOTC (C) 
means the normal operating cell temperature. The unit of 
Ta, NOCT and Tc are all centigrade in Equation (5). 
Therefore, Tc must be corrected to absolute temperature for 
the use of other equations. From Figure 1, the i-v 
characteristic of a solar cell is expressed by: 
( )
0 exp 1
s s
l
c p
q V IR V IR
I I I
nkT R
⎡ ⎤+⎛ ⎞ += − − −⎢ ⎥⎜ ⎟⎜ ⎟⎢ ⎥⎝ ⎠⎣ ⎦
     (6) 
where Rp is the shunt resistance of solar cell. It is noted that 
in Equation (6), the current I appears on both side of the 
equation. Equation (6) can not be written as an explicit 
function (I=f(V)) but can be expressed in an implicit form: 
( )
( )
0
, ,
( ) exp 1 0s sl
c p
f I V G
q V IR V IR
I I G I
nkT R
=
⎧ ⎫⎡ ⎤+⎛ ⎞ +⎪ ⎪− − − − =⎢ ⎥⎜ ⎟⎨ ⎬⎜ ⎟⎢ ⎥⎝ ⎠⎪ ⎪⎣ ⎦⎩ ⎭
 (7) 
In order to obtain a high power, several PV cells are 
electrically connected in series-parallel combinations to 
make a module. It can be shown that the module 
parameters (The subscript m denotes module) of m 
identical cells in series are: 
Rsm=mRs, Rpm=mRp, nm=mn, I0m=I0(G), Ilm=Il(G)  (8) 
Figure 2 shows equivalent circuit of a PV module 
with m identical cells which connected in series. The i-v 
characteristic equation of the module may be written in the 
same form as that of a single cell as 
( ) {
( )
0
, , ( )
exp 1 0
m m m m l
m m sm m m sm
m c pm
f I V G I I G
q V I R V I R
I
n kT R
= −
⎫⎡ ⎤+⎛ ⎞ + ⎪− − − =⎢ ⎥⎜ ⎟ ⎬⎜ ⎟⎢ ⎥⎝ ⎠ ⎪⎣ ⎦ ⎭
  (9) 
   
4 
turn on. This state is represented by the segment between 
voltage E2 and E3. When 3dV E≥ , all branches turn on. 
This state is represented by the segment between voltage E3 
and Voc in Figure 6. 
Figure 8 illustrates the concept of the piecewise 
linear parallel branches model for PV generator. Once 
irradiance and temperature change, according to this 
situation, MODELS calculate corresponding value of 
photocurrent, resistances, and DC voltage sources of each 
branch; this mechanism takes the effects of temperature 
and solar radiation into account. 
 
Vd (V)
0.00 0.50 0.55 0.60 0.65 0.70
I d
 (A
)
0
10
20
30
40
50
The i-v curve of diode
Using 4 segments to approximate the i-v curve
Using 8 segments to approximate the i-v curve
 
Fig. 5. Using 4 and 8 segments to approximate the i-v 
curve of the diode 
 
Id
Vd
m1 m2
m3
m4
E1 E2 E3 Voc
 
Fig. 6. The i-v curve characterized by 4 segments 
 
The circuit model shown in Figure 8 can be used to 
simulate a PV cell or a module at any irradiance and 
temperature. If we want to simulate many PV cells 
connected in series or in parallel at various weather 
conditions, or a PV module with shaded PV cells, then, the 
circuit model shown in Figure 8 needs to be modified. The 
terminal point b in Figure 8 is the grounding point, which 
does not allow the cell to be connected floatingly. To 
connect several cells in series and parallel, we need 
terminals a and b in Figure 8 to be floating nodes. A 
modification of the circuit of Figure 8 using grounded 
current sources is shown in Figure 9 in which nodes a and 
b are floating and can be connected to other cells.  
 
 
Vd
E1 E2 E3
R1
D
R3 R4R2
D D D
+
_
Id
 
Fig. 7. Using 4 parallel branches to approximate the 
i-v curve in Figure 6 
 
 
Fig. 8. conceptual diagram of the piecewise linear 
parallel branches model 
 
a
b
Id
R2
D
R4R1
. . .
D
Rp
Rs
Iph I
+
_
V
D
R3
D
Iph
1
2
E
R
1
2
E
R
2
3
E
R
2
3
E
R
3
4
E
R
3
4
E
R
 
Fig. 9. A modification of the circuit of Fig. 8 using 
grounded current sources to make output 
terminals a and b floating. 
5. SIMULATION RESULTS 
To see the effectiveness of the developed model, 
simulations have been conducted by considering Shihlin 
Electric SM50 PV module that is composed of 36 cells in 
series. The PV module parameters are calculated from 
measured data using the method proposed from [9]: Id0=2×
10-7A, n=1.4, Rs=0.031, Rp =1.5Ω, Ig0=3A, G0=1 kW/m2, 
Tref=25℃. 
Impact of Irradiance 
The proposed model with four parallel branches on 
the simulation screen in EMTP/ATP is shown in Figure 10. 
There is a very small resistance (10-7 Ω ) between 
MODELS controlled resistance and MODELS controlled 
voltage source due to some special requirement of the 
software. This extra small resistance is subtracted from the 
   
6 
V (V)
0 5 10 15 20
P 
( W
)
0
12
24
36
4 parallel branches
8 parallel branches
Tc=100 
oC
Tc=50 
oC
 
Fig. 14. P-v characteristics at different temperatures 
while irradiance is fixed at 1 kW/m2 
Change in Load Resistance 
Figure 15 shows variations of the output voltage and 
current when load resistance varies from 0 Ω to 100 Ω at 
irradiance 1 kW/m2 and temperature 25 °C . In the Figures 
solid lines refer to the simulation result of 4 parallel 
branches and dotted lines to the simulation results of 8 
parallel branches, respectively. 
 
t (s)
0 2 4 6 8 10
v(
t) 
( V
)
0
6
12
18
24
i( t
) (
A)
0.0
0.8
1.6
2.4
3.2
i(t)
v(t)
8 parallel branches
4 parallel branches
 
Fig. 15. Output voltage and current of PV module 
when load resistance change 
A PV Module with Shaded PV Cells 
Figures 16 and 17 show the simulation results of the 
i-v characteristics of a PV module with 1 and 4 shaded PV 
cells, respectively. In Figure 16, only one cell (s=1) in a PV 
module (the PV module is composed of 36 PV cells.) is 
covered by shadow. The shaded cell has an  irradiance of 
0.7 kW/m2 and other normal PV cells receive a higher 
irradiance of 1kW/m2. The temperature of the whole 
module is 50 °C .In Figure 16 the dotted line and the dashed 
line represent the results of equation-oriented model for the 
cases of s=0 and s=1, respectively. Two solid lines 
represent the simulation results of 4 parallel branches and 8 
parallel branches, respectively. Figure 17 shows the i-v 
characteristic of the PV module with 4 shaded cells (s=4). 
Figures 18 and 19 show the P-v curves of the PV module 
with 1 shaded cell and 4 shaded cells, respectively. The 
results of equation-oriented model and those of 8 parallel 
branches have shown good agreement. 
In fact, the solar irradiance, temperature and load are 
time-variant variables, the forgoing simulations are only 
snaps of the real situation. Nevertheless, the proposed 
model has the ability to take all relevant conditions into 
account at the same time, so dynamic time domain 
simulation can be carried out. 
 
0 5 10 15 20
0.0
0.5
1.0
1.5
2.0
2.5
3.0
s = 1
4 parallel branches
8 parallel branches
V (V)
I (
A)
s = 0
 
Fig. 16. The i-v characteristics of 1 module with 1 
shaded cell 
 
0 5 10 15 20
0.0
0.5
1.0
1.5
2.0
2.5
s = 4
4 parallel branches
8 parallel branches
V (V)
I (
A)
 
Fig. 17. The i-v characteristics of 1 module with 4 
shaded cell 
 
 
0 5 10 15 20
0
5
10
15
20
25
30
V (V)
P 
( W
)
4 parallel branches
8 parallel branches
s = 1
 
Fig. 18. The P-v characteristics of the module with 1 
shaded cell 
出席國際學術會議心得報告 
                                                             
計畫編號 NSC 96-2221-E-224-088 
計畫名稱 新型太陽能電池等效電路模型之開發 
出國人員姓名 
服務機關及職稱 
李明學 
國立雲林科技大學工程科技研究所博士生 
會議時間地點 97 年 6 月 2 日至 97 年 6 月 6 日，新加坡(Holiday Inn Atrium) 
會議名稱 第三屆 IEEE 工業電子與應用研討會 (ICIEA 2008) 
發表論文題目 感應機於史坦梅茲電路下之脈動轉矩分析 
 
 
一、參加會議經過 
 
2008 年 IEEE-ICIEA 國際研討會為全世界有關 Automation 、 Computational 
Intelligence、Control Systems and Applications、Energy and Environment、
Mechatronics 、 Power Electronics 、  Signal Processing 、 Network and 
Communication Technologies、Emerging Technologies相關研究方面重要會議之一，
且係為每一年舉辦一次。此次會議於2008年6月3日至6月5日在新加坡Holiday Inn Atrium
舉行，為期三天。研討會議議程包含廣泛，而其專題講授課程分別於6月3日~6月5日每天上
午各舉行一場，而會議之opening於6月3日上午8點30分舉行。此次會議共有來自世界各個
共32國家超過978篇文章投稿，而經大會審查並於會議中發表的共有來自26國家538篇文
章，其接受率不及55%，其分別被安排在53個oral sessions及9個interactive sessions。
而學生被安排在於此會議53個oral sessions中的Power Electronics-7議程中發表研究成
果，時間是在6月4日下午17點0分，並利用其餘的時間安排接下來幾天在會議過程中欲前往
參加的各項議程並規劃會議期間的聽講內容。而在此次的參與過程中，在學生報告的議程間
及其他議程認識了國外的一些學者與學生，更加珍惜此機會互相討論與交流，因此非常感謝
國科會予以補助，使得學生能參與此次國際研討會並與國際接軌。 
  本次參加會議，是在投稿文章接獲發表通知後，獲得國科會補助往返機票、註冊費及生
活費之經費；因此，讓我有機會參與一年一度有關 Automation、Computational 
Intelligence、Control Systems and Applications、Energy and Environment、
Mechatronics、Power Electronics、Signal Processing、Network and Communication 
Technologies、Emerging Technologies 方面的國際研討會(2008 年 IEEE-ICIEA)。 
參加會議行程簡介 
97 年 6 月 2 日:斗六-台北-新加坡,長榮航空( 當晚完成報到及領取相關資料 ) 
97 年 6 月 3 日:參加 IEEE-ICIEA2008 參加研討會 
97 年 6 月 4 日:參加 IEEE-ICIEA2008 參加研討會並發表論文 
97 年 6 月 5 日:參加 IEEE-ICIEA2008 參加研討會 
97 年 6 月 6 日:新加坡-台北-斗六,長榮航空 
