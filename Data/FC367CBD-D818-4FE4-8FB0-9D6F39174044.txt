Abstract 
The stability and robustness of control laws developed with local time approximation is 
studied in this paper. The local time approximation is a useful tool in solving the problem of 
controlling a time varying Hamiltonian system, of which one application is the formation flight 
about unstable trajectories, such as halo orbits. Starting with equations of motion derived for 
relative motion about unstable trajectories, we analytically prove the local stability of a controlled 
Hamiltonian trajectory and design a controller under the guide of this algorithm. Numerical 
simulations are provided to show the validity of the algorithm.  
 
Keywords：formation flight, orbit control, local time approximation, interferometric imagine 
 
1. Introduction 
Formation flight of spacecraft is recently of great interest among scientists, especially with 
application to interferometric imaging of space or the Earth. Interferometric imagine is performed 
by measuring the mutual intensity (the two point correlation [1-4]) that results from the collection 
and subsequent interference or two electric field measurements of a target made at two different 
observation point, with which a 2-D or 3-D mapping can be generated. Several space missions 
using interferometry for scientific observation have been carried out or under planning all over 
the world since 1978, such as TOPSAT by NASA. However, those missions were accomplished 
by a single spacecraft. A more efficient way to perform interferometric imagine is the usage of 
spacecraft formation. Results of this study will contribute to possible application of formation 
flight techniques about a Low Earth circular orbit. 
The current state of art in investigating formation flight around the Earth is to solve the 
linearized dynamics, such as the Clohessy-Wiltshire Equation (C-W Equation) [5] or the 
Tschauner-Hempel Equation (T-H Equation) [6], dealing with the relative motion about a circular 
or elliptic orbit, respectively. Many researchers have been devoted themselves into formation 
investigation in different areas, as shown in Ref. [7 – 13]. However, those scientists investigated 
formation problems around an Earth orbit usually approached by looking for natural periodic 
solutions. No methodology regarding control law design was proposed so far. The linearized 
model described by the T-H Equation is time varying. According, we would like to apply the 
“local time approximation”, developed for the control of relative motion about a halo orbit by 
Hsiao and Scheeres, to guide out thinking, and develop a feasible control law in the spacecraft 
formation about a Keplerian orbit. 
In this paper we try to investigate the stability of applying local time approximation to the 
spacecraft formation problem about unstable trajectories. To apply the local time approximation, 
we first show that our problem satisfies certain assumptions detailed in Ref. [11, 12]. Having 
proved this, we then investigate the stability of possible control laws and apply the control laws 
to stabilize unstable relative motions. Numerical simulations are provided to show the validity of 
the algorithm.  
 
2. Dynamics Model 
2.1 General Equations of Motion 
A spacecraft formation problem is usually formulated as the problem of relative motion with a 
chief spacecraft on the nominal trajectory and a deputy spacecraft in the vicinity. Therefore, the 
linearization technique is usually applied to derive the dynamics of the relative motion of the 
deputy. 
Consider a body-fixed frame attached on the chief spacecraft where x points from Earth to the 
spacecraft, y points along direction of the motion of the chief spacecraft, and z completes the triad, 
as shown in Fig. 1. Assume that the nominal trajectory is only governed by the Earth, meaning 
that the chief spacecraft moves in a Keplerian orbit. Given the eccentricity e, the true anomaly f, 
0 0( ) ( , ) ( )t t t t= Φx x , where  is the state transition matrix (STM). Given the system 
periodic, by application of Floquet theorem, the analysis of motion on the order of an orbit period 
or longer can be written as the product of two matrices: 
)0,( ttΦ
0 0 0( , ) ( ) exp(( ) )t t P t t t t DΦ = − −                                               (7) 
where P  is a periodic matrix of period T  and  is a constant matrix which has, as its 
eigenvalues, the characteristic exponents of the periodic orbit over one orbital period. 
D
For every small time interval tδ satisfying Ttt <<Δ<< δ0 , the local STM can be 
approximated as 
( , ) ( )i i it t t I A t tδ δΦ + ≈ + +L                                                 (9) 
provided ( ) ( )i iA t A t tδ′>> , where )(′ denotes the derivative of ( )A t  with respect to t. 
Equation (9) implies that the relative motion of the spacecraft over a short time span centered at 
can be understood by analyzing the eigenvalues and eigenvectors of the matrix [11, 12] if 
the variation of the dynamics matrix with time is small enough within the short time interval. 
it ( )iA t
 
3.2 Applicability to the Keplerian Formation 
To verify the applicability of the local time approximation to the dynamics of spacecraft 
formation about a Keplerian orbit, we have to examine the time variation of  over a short 
time interval. The complexity of Eq. (1), however, makes the analytical analysis impossible. To 
do the verification, we turn to the T-H Equation, given by: 
( )iA t
2J V 0δ δ δ′′ ′−r r - r =                                                       (10) 
where ),,( zyx=rδ , and  
0 1 0
1 0 0
0 0 0
J
⎡ ⎤⎢ ⎥= −⎢ ⎥⎢ ⎥⎣ ⎦
, 
3 0 0
1 cos
0 0
0 0
e f
V
⎡ ⎤⎢ ⎥+⎢ ⎥= ⎢ ⎥⎢ ⎥
0
1−⎢ ⎥⎢ ⎥⎣ ⎦
 
Accordingly, the dynamics matrix can be expressed as 
6 6
0
( )
2
I
A f
V J ×
⎡ ⎤= ⎢ ⎥⎣ ⎦
 
where ( )A f  is periodic with period 2f π= . Then, Eq. (10) can be written as a standard form: 
( )A f′ =x x                                                               (11) 
where denotes the derivatives with respect to f. We can find that the Eq. (11) is similar to 
Eq. (6). Therefore, we can view the variable  in Eq. (6) as a free parameter, and apply the same 
analysis in the preceding section to Eq. (11) simply by letting 
)(′
t
t f= . Moreover, all norms are 
equal since  is finite dimension, we select the )( fA norm∞−  of a matrix in practical 
computation. Given  in Eq. (11) and )( fA 10 << e , the norm of is computed as )( ifA
3( ) 2
1 cos i
A fi e f∞
= + +                                                    (12) 
On the other hand, we should compare the above result with ∞′ ii ffA δ)( . Given A(f) from Eq. 
(10), the derivative of  with respect to  is given by )( fA f
0 0
( )
' 0
A f
V
⎡ ⎤′ = ⎢ ⎥⎣ ⎦  
where 
Then,  and 0)0,0( =W 0),( >rr &δδW  if 0),( ≠rr &δδ . Additionally,  
     rrrrrr &&&&&& δδδδδδ TTVW
2
1),( +−=  
rrrrrr δδδδδδ VSV TTT &&&& −++−=  
0== rr && δδ ST  
Since the requirement of Lyapunov stability is that the time derivative of a Lyapunov function be 
less than or equal to zero, our linear system is proved stable in the sense of Lyapunov according 
to the above derivations. Also, due to its Hamiltonian structure, this result implies that our local 
time invariant system has all of its poles on the imaginary axis. 
 
5. Control Law Design 
5.1 Control law Design in Time Domain 
Having proved that the local time approximation is applicable to the Keplerian orbit with 
small eccentricity, the algorithm shown in Ref. [10] can thus be utilized to guide the thought of 
control law design.. 
According to the local time approximation, during the time interval i i it t t t tδ δ− ≤ ≤ + , 
1tδ << , the system can be formulated as locally linear-time-invariant, given by Eq. (1) with 
. In Ref. [10], a position-and-velocity feedback controller, given by it t=
( ) 2 ( ) ( )i i cr it t J V tϖ δ δ= − r - r&Τ , 
is designed to null out the Coriolis force and generate a non-Coriolis environment in the 
rotational system. The controller is applied in the following way 
( ) ( )i iA t t= +x x& Τ  
such that the controlled equations of motion are then in the following form: 
( ) 0des iV tδ δ−r r&& =
2
3 )
                                                         (17) 
where the force potential matrix  contains the desired oscillating modes. Accordingly, the 
position feedback in the controller can be obtained as 
( )des iV t
( ) ( ) ( )cr i i des iV t V t V t= −                                                       (18) 
By making 2 21 2( ,  ,  desV diag ω ω ω= − − − , we can create a system with three oscillators and 
arbitrary trajectories [10]. A relative circular formation can be achieved by designing a controller 
with all the oscillating frequencies the same, i.e., 2( )des iV t ϖ= − I , and with proper selection of 
initial conditions. 
5.2 Control Law Design in T-H Equation 
In addition to do the trajectory control in the time domain, an alternate approach is from the 
T-H Equation. The T-H Equation describes the relative motion about a Keplerian orbit, and there 
exist analytic solutions to the equation, as shown in Eqs. (3) – (5). However, we should notice 
that the solutions in Eqs.  (3) – (5) are normalized about the nominal position. Thus, the full 
solutions must be multiplied by the nominal position, . Given the controller )(tR
( ) 2 ( )i crf J V fiδ δ′= − r - rΤ ,                                                 (19) 
the closed-looped system can be written as ( ) ( )i iA f f′ = +x x Τ  or 0)( =−′′ rr δδ ides fV , 
provided . The relative motion of the deputy spacecraft can be analytically solved as ( )des iV t = −I
Journal of Guidance, Control, and Dynamics, Vol. 27, NO. 2, 2004, pp 297-301 
5. Clohessy, W. H., Terminal Guidance System for Satellite Rendezvous, Journal of Aerospace 
Sciences, Vol. 27, No. 9, September 1960, pp. 653-658,674 
6. Tschauner, J. and Hempel, P., Rendezvous with a Target in Elliptic Orbit, Astronautica Acta, 
Vol. 11, No. 2, 1965, pp. 104-109 
7. Vadali, S. R., An Analytical Solution for Relative Motion of Satellites, Proceedings of the 
5th International Conference on Dynamics and Control of Structures and Systems in Space, 
Cranfield University Press, 2002, pp.309-316. 
8. Melton, R. G., Time-Explicit Representation of Relative Motion Between Elliptical Orbits, 
Journal of Guidance, Control, and Dynamics, Vol. 23, No.4, 2000, pp. 604-610 
9. Vadali, S. R. and Alfriend, K. T., Modeling and Control of Satellite Formations in High 
Eccentricity Orbits, The Journal of the Astronautical Science, Vol. 52, No. 1-2, 2004, pp. 
149-168 
10. Hsiao, F. Y., and Scheeres, D. J., Design of spacecraft formation orbits relative to a 
stabilized trajectory, Journal of Guidance, Control and Dynamics, Vol. 28, No. 4, pp. 
782-794, July-August 2005 
11. Hsiao, F.Y., and Scheeres , D. J., The dynamics of  formation flight about a stable 
trajectory, Journal of the Astronautical Sciences, Vol. 50, No.3, pp. 269-287, July - 
September 2002 
12. Scheeres, D. J., Hsiao, F. Y., and Vinh, N. X., Stabilizing motion relative to an unstable 
orbit: applications to spacecraft formation flight, Journal of Guidance, Control and 
Dynamics, Vol. 26, No. 1, pp. 62-73, January-February 2003 
13. Li, S. J., and Hsiao, F. Y., Periodic Relative Motion Near a Keplerian Circular Orbit with 
Full Approach: Application to Formation Flight, submitted to 2006 AASRC/CCAS Joint 
Conference, Chungli, Taiwan, December 2006 
14. Bay, J. S., Fundamentals of Linear State Space Systems, 1999 
15. Battin, R. H., An introduction to the mathematics and methods of astrodynamics, (AIAA 
education series, AIAA, Reston, 1999) 
9. Chart arrangement 
To Earth
yz
δr
Chief
Deputy
Nominal Trajectory
x  
Fig.1  A cartoon showing how the coordinates are defined, and the 
relative positions between the chief and deputy spacecraft. 
 
a)                                     b) 
 
Fig.2  A nominal orbit with semi-major axis of 7000 km, and a) 
eccentricity of 0.001 b) eccentricity of 0.1 is used to simulate the formation 
flight. 
行政院國家科學委員會補助國內專家學者出席國際學術會議報告 
                                                            96 年 2 月 9 日 附件三
 
報告人姓名 蕭富元 
Fu-Yuen Hsiao 
 
服務機構
及職稱 
淡江大學航太系 
助理教授 
 
     時間 
會議 
     地點 
96/1/28-96/2/1 
Sedona, AZ, USA 
本會核定
補助文號
國科會計劃編號: 
95-2221-E-032-011- 
會議 
名稱 
 (中文) 2007 年度 AAS/AIAA 合辦太空飛行力學會議 
 (英文) 2007 AAS/AIAA Space Flight Mechanics Meeting, Sedona, AZ 
發表 
論文 
題目 
(中文) AAS 07 – 111 利用全解逼近法來求得刻卜勒型軌道之週期性相對運動 
(英文) AAS 07 – 111 Periodic Relative Motion Near a Keplerian Orbit with Full Approach 
(中文) AAS 07 – 154 近圓軌道之太空船編隊控制 
(英文) AAS 07 – 154 Control of Spacecraft Formation about a Near-Circular Orbit 
報告內容應包括下列各項： 
一、參加會議經過 
1/28 抵達及註冊 1/31 與其它學者交流及討論 
1/29 上午發表論文 AAS-111 2/01 離開 Sedona, AZ 
1/30 上午發表論文 AAS-154 及下
午參觀天文台 
 
 
二、與會心得 
AAS/AIAA Space Flight Mechanics Meeting 為美國太空學界之重要學術發表會。此次與會不僅有
機會將本身之研究公之於世，亦是一個與全世界其它學者互相切磋之難得機會。在四天的會議
之中，各界的學者不但對我的研究提出許多精闢的見解和意見，我也攜回了許多有用的資料，
以做為日後研究時的參考。而且許多學者亦向我表示合作的興趣，為將來國際合作打開一扇窗。
 
三、考察參觀活動(無是項活動者省略) 
 
至 Flagstaff 市區之 Lowell Observatory 參觀 
 
四、建議 
 
無 
 
五、攜回資料名稱及內容 
 
2007 AAS/AIAA Spaceflight Mechanics Meeting Proceeding 
 
六、其他 
 
 
表 Y04 
is performed by measuring the mutual intensity (the two point correlation [1-4]) that results
from the collection and subsequent interference or two electric field measurements of a
target made at two different observation point, with which a 2-D or 3-D mapping can be
generated. Several space missions using interferometry for scientific observation have been
carried out or under planning all over the world since 1978, such as TOPSAT by NASA.
However, those missions were accomplished by a single spacecraft. A more efficient way
to perform interferometric imagine is the usage of spacecraft formation. Results of this
study will contribute to possible application of formation flight techniques about a Low
Earth circular orbit.
The current state of art in investigating formation flight around the Earth is to solve the
linearized dynamics, such as the Clohessy-Wiltshire Equation (C-W Equation) [5] or the
Tschauner-Hempel Equation (T-H Equation) [6], dealing with the relative motion about a
circular or elliptic orbit, respectively. Many researchers have been devoted themselves into
formation investigation in different areas, as shown in Ref. [7-12]. However, those scien-
tists investigated formation problems around an Earth orbit usually approached by looking
for natural periodic solutions. No methodology regarding control law design was proposed
so far. The linearized model described by the T-H Equation is time varying. According,
we would like to apply the “local time approximation”, developed for the control of rela-
tive motion about a halo orbit by Hsiao and Scheeres, to guide out thinking, and develop a
feasible control law in the spacecraft formation about a Keplerian orbit.
In this paper we try to investigate the feasibility of applying local time approximation
to the spacecraft formation problem about a Keplerian orbit, and develop control law to
stabilize the unstable trajectories. To apply the local time approximation, we first need to
show that our problem satisfies certain assumptions detailed in Ref. [11,12]. Having proved
this, we then investigate possible control laws, one of which will generate a trajectory of
the “scaled” nominal orbit.
In detail, we first consider a spacecraft formation about a nominal Keplerian orbit, whose
dynamics described by the T-H Equation. Then the applicability of the “local time approx-
imation” is analytically proved, and utilized to guide our thinking of control law design.
We also propose potential control law investigated both in the time domain and in the true-
anomaly domain. By designing the control law in the true-anomaly domain, we not only
stabilize the unstable relative trajectory, but also “re-construct” the “scaled” nominal orbit
for our formation of spacecraft. Numerical simulations are also presented to verify our
results. The results will later contribute to the formation flight of spacecraft about the Earth
orbit with applications to interferometric imagining.
DYNAMICS MODEL
General Equations of Motion
A spacecraft formation problem is usually formulated as the problem of relative motion
2
analytic solution [6,7,9]:
x¯ = c1 cos f(1 + e cos f) + c2 sin f(1 + e cos f)
+
3c3
η2
[1− 3e
2η3
sin f(1 + e cos f)M ] (5)
y¯ = −c1 sin f(2 + e cos f) + c2 cos f(2 + e cos f)
−3c3
η5
(1 + e cos f)2M + c4 (6)
z¯ = c5 cos f + c6 sin f (7)
where c1 to c6 are coefficients determined by initial conditions, η =
√
1− e2, and M =
nt = E − e sinE is the Mean anomaly. We should notice that the motion in the z axis is
decoupled from the xy plane, and it is “nearly” simple harmonic. The only difference is
that the motion described in the above equations must be transformed back to the original
coordinates by multiplying the magnitude of the chief position. There exsit some initial
conditions leading to a natural periodic motion, which may be utilized for formation flight
of spacecraft, fully discussed in Ref. [6, 7, 9]. In most cases, however, the motion is a linear
combination of various modes. We can see from Eq. (6) that, in most cases, the motion in
the y-direction will drift away gradually if no control law is applied to the spacecraft.
Local Time Approximation
Local Time Approximation
The “local time approximation” was first proposed by Hsiao and Scheeres [11,12] to solve
the control problem of spacecraft formation about an unstable halo orbit. The spirit of the
local time approximation is to treat a time varying system as locally time invariant, and the
control law is design based on the local time-invariant system. This algorithm has been
shown valid and robust in controlling the formation about an unstable halo orbit, and in
designing the orbit of the constellation.
Consider a linear, time varying, periodic dynamics, formulated by
x˙ = A(t)x (8)
where x(t) is the states and A(t) is periodic with the period T , i.e.,
A(t+ T ) = A(t)
According to the linear theory [13], the solution to the Eq. (8) can be written as
x(t) = Φ(t, t0)x0
4
Accordingly, the equations of motion can be expressed as
x¯
′
= A(f)x¯ (13)
where (′) denotes the derivatives with respect to f , and
A(f) =
[
0 I
V (f) 2J
]
6×6
(14)
We should note that A(f) is periodic with the normalized period of 2pi.
Equation (13) is similar to Eq. (8). Therefore, we can view the variable in Eq. (8) as a
free parameter, and apply the same analysis in the preceding section to Eq. (13) simply by
letting t = f . Moreover, all norms are equal given A(f) finite dimension. The ∞-norm of
a matrix is selected in the practical computation, where the definition of ∞-norm is:
‖A‖∞ = max
i
∑
j
|aij| (15)
Given A(f) in Eq. (12) and 0 < e < 1, the norm of A(fi) is computed as
‖A(fi)‖∞ = max
i
∑
j
|aij(fi)|
= max
i
(1, 1, 1, 2 +
3
1 + e cos fi
, 2, 1)
= 2 +
3
1 + e cos fi
(16)
On the other hand, we should compare the result of Eq. (16) with ‖A′(fi)δfi‖∞. Given
A(f) =
[
0 I
V 2J
]
6×6
(17)
then the derivative of A(f) with respect to f is given by
A
′
(f) =
[
0 0
V
′
0
]
6×6
(18)
where
V
′
=
 3e sin f(1+e cos f)2 0 00 0 0
0 0 0
 (19)
Therefore,
‖A′(fi)δfi‖∞ = max
i
(0, 0, 0,
∣∣∣∣ 3e sin fiδfi(1 + e cos fi)2
∣∣∣∣ , 0, 0)
=
3e| sin fiδfi|
(1 + e cos fi)2
(20)
6
According to the local time approximation, during the time interval ti−δt ≤ ti ≤ ti+δt,
|δt| ¿ 1, the system can be formulated as linear time invariant, given by
δr¨− 2ω(ti)Jδr˙− V (ti)δr = 0 (23)
where δr = (x, y, z), and
ω(ti) = nlc(ti)
√
1 + e cos f(t− i)
V (ti) = n
2
lc(ti)
 3 + e cos f(ti) −2e sin f(ti) 02e sin f(ti) e cos f(ti) 0
0 0 −1

In Ref. [10], a position-and-velocity feedback, given by
T (ti) = −2ω(ti)Jδr˙− Vcr(ti)δr, (24)
is designed to null out the Coriolis force and create a “three dimensional oscillator” in the
rotational system. With proper initial conditions an arbitrary trajectory can be generated.
The controller is applied in the following way
x˙ = A(ti)x+ T (ti)
such that the controlled equations of motion are then in the following form:
δr¨− Vdes(ti)δr = 0 (25)
where the force potential matrix Vdes(ti) contains the desired oscillating modes. Accord-
ingly, the position feedback in the controller can be obtained as
Vcr(ti) = V (ti)− Vdes(ti) (26)
For example, by making
Vdes(ti) =
 −ω21 0 00 −ω22 0
0 0 −ω23
 ,
we can create a system with three oscillators and arbitrary trajectories [10]. A relative circu-
lar formation can be achieved by designing a controller with all the oscillating frequencies
the same, i.e., Vdes(ti) = −ω2I, and with proper selection of initial conditions.
Control Law Design in T-H Equation
In addition to do trajectory control in the time domain, an alternate approach is from the
T-H Equation. The T-H Equation describes the relative motion about a Keplerian orbit, and
there exist analytic solutions to the equation, as shown in Eqs. (5)- (7). However, we should
8
we design a state feedback controller T¯ (fi) = B¯x¯ for x¯′ = A¯x¯′ in the true-anomaly
domain. The transformation can be established by applying the chain rule:
d(·)
dt
=
d(·)
df
df
dt
= f˙
d(·)
df
(28)
Given x = T x¯, where T is the transformation matrix, the time derivative of x is given
by x˙ = T˙ x¯ + T ˙¯x. Since x¯ is a function of f , we can apply the chain rule to obtain the
derivative of x¯ with respect to f , given by:
x˙ = f˙T
′
x¯+ f˙T x¯
′
where (′) denotes the derivatives with respect to f , and the values of T and T ′ are given in
the appendix. Since x˙ = Ax and x¯′ = A¯x¯, the transformation is given by
Ax = f˙T
′
x¯+ f˙T A¯x¯
= (f˙T
′
+ f˙T A¯)x¯
= (f˙T
′
+ f˙T A¯)T−1x
(29)
or,
A = f˙T
′
T−1 + f˙T A¯T−1 (30)
Given the controllers T¯ (fi) written as T¯ = B¯x¯ and T = Bx, from Eq. (30) we have
A+B = f˙T
′
T−1 + f˙T (A¯+ B¯)T−1
= f˙T
′
T−1 + f˙T A¯T−1 + f˙T B¯T−1
Equating the matrix A with transformation in Eq. (30) we obtain
B = f˙T B¯T−1 (31)
Controlling the Original Nonlinear System
Although a neat conclusion is drawn in the linear scheme, the control law should be
examined in the original nonlinear system, which is assumed exclusively governed by the
Newton’s Gravitation Law, given by:
r¨ =
−µ
r3
r
Applied the state feedback law, over every small time interval ti − δt ≤ ti ≤ ti + δt the
controlled system is written in the following way,
r¨ =
−µ
r3
r+ T (ti) (32)
where T (ti) is given in Eq. (24) and must be transformed back to inertial frame. Moreover,
δr in Eq. (24) are evaluated as δr = r−R.
10
APPENDIX
Given δr = Rδr¯, we have
δr˙ = R˙δr¯+Rδ ˙¯r (33)
However, from Eq. (28) we can rewrite Eq. (33) as
δr˙ = f˙(R
′
δr¯+Rδr¯
′
) (34)
The derivatives of f˙ and R with respect to f can by analytically derived as:
R
′
=
d
df
(
p
1 + e cos f
)
=
(
p
1 + e cos f
)(
e sin f
1 + e cos f
)
= RF (35)
d
df
f˙ =
d
df
( h
R2
)
=
df˙
dR
dR
df
=
−2h
R3
RF
= −2f˙F (36)
where
F =
e sin f
1 + e cos f
(37)
Therefore, we can establish the transformation matrix T , given by
T =
[
RI 0
f˙RF I f˙RI
]
(38)
Similarly, we can obtain T ′ by taking the derivative of T with respect to f :
T
′
=
[
RF I 0
f˙RF¯ I −f˙RF I
]
(39)
where
F¯ =
e cos f
1 + e cos f
(40)
12
To Earth
x
yz
δr
Chief
Deputy
Nominal Trajectory
Figure 1: A cartoon showing how the coordinates are defined, and the relative positions
between the chief and deputy spacecraft.
−1 −0.8 −0.6 −0.4 −0.2 0 0.2 0.4 0.6 0.8 1
x 104
−6000
−4000
−2000
0
2000
4000
6000
X (km)
Nominal Trajectory with a=7000 e=0.001
Figure 2: A nominal orbit with semi-major axis of 7000 km, and eccentricity of 0.001 is
used to simulate the formation flight.
14
−10000 −8000 −6000 −4000 −2000 0 2000 4000 6000 8000
−6000
−4000
−2000
0
2000
4000
6000
X (km)
Nominal Trajectory with a=7000 e=0.1
Figure 5: A nominal orbit with semi-major axis of 7000 km, and eccentricity of 0.1 is used
to simulate the formation flight.
−60 −40 −20 0 20 40
−40
−30
−20
−10
0
10
20
30
40
y (m)
z 
(m
)
Relative Trajectory with nominal a=7000 e=0.1
Figure 6: A spacecraft formation with initial excursion of 50 m from the nominal is sim-
ulated. The nominal orbit is shown in Fig. 5, and the formation is simulated for one orbit
period.
16
−1.5 −1 −0.5 0 0.5 1 1.5 2 2.5 3
−1.5
−1
−0.5
0
0.5
1
1.5
2
y (m)
z 
(m
)
Relative Trajectory with nominal a=7000 e=0.001
Figure 9: A spacecraft formation with initial excursion of 1 m from the nominal, shown at
Fig. 8, is simulated in the original nonlinear scheme. This plot shows the controlled and the
uncontrolled trajectory with initial excursion about the nominal. The controlled trajectory
is run for one full period while the uncontrolled is only run for 3000 seconds.
0 1000 2000 3000 4000 5000 6000
0
0.5
1
1.5
2
2.5
3
3.5
4
x 10−5
Time (s)
|∆ 
V| 
(m
/s)
Cost of formation per spacecraft with nominal a=7000 e=0.001
Figure 10: A spacecraft formation with initial excursion of 1 m from the nominal, shown
at Fig. 8, is simulated in the original nonlinear scheme. This plot shows the cost in order to
control a spacecraft shown in Fig. 9.
18
target made at two different observation point, with which a 2-D or 3-D mapping can be
generated. Several space missions using interferometry for scientific observation have been
carried out or under planning all over the world since 1978, such as TOPSAT by NASA.
However, those missions were accomplished by a single spacecraft. A more efficient way
to perform interferometric imagine is the usage of spacecraft formation. Results of this
study will contribute to possible application of formation flight techniques about a Low
Earth circular orbit.
The current state of art in investigating formation flight around the Earth is to solve the
linearized dynamics, such as the Clohessy-Wiltshire Equation (C-W Equation) [5] or the
Tschauner-Hempel Equation (T-H Equation) [6], dealing with the relative motion about
a circular or elliptic orbit, respectively. Many researchers have been devoted themselves
into formation investigation in different areas, as shown in Ref. [7-13]. The results obtained
from the linearized model, however, should be verified in the original nonlinear Gravitation
Law. We can see that the error caused by omitting the higher order term during linearization
will be integrated as time elapses. Therefore, we would like follow a contrary way that
starts with a full solution from the original dynamics and approximates our results to a
simpler and applicable form. We call the methodology “the full approach”.
In this paper we try to investigate the feasibility of applying formation flight to small
or micro/nano satellites. An important feature of those satellites is small in volume and
light in weight, so that they cannot carry too much fuel for orbit control. Although the
C-W Equation and the T-H Equation have proposed some initial conditions that leads to a
periodic trajectory, and can be utilized for formation in the linear sense, the nonlinearity
may still destroy the formation. Hence, a better approximation with which the formation
can still be kept under the nonlinear circumstance is important.
In detail, we first discuss the classical approach to relative dynamics. Then we subtract
two adjacent orbits in the two-body problem to get the relative motion, and simplify the
results after several approximations. This process avoids solving differential equations of
the linearized model, and obtains a more precise solution for the trajectory. Numerical
simulations and error analysis are also presented to show the robustness of our results.
CLASSICAL DYNAMICS MODEL
General Equations of Motion
A spacecraft formation problem is usually formulated as the problem of relative motion
with a chief spacecraft on the nominal trajectory and a deputy spacecraft in the vicinity.
A body-fixed frame attached on the chief spacecraft is selected such that x points from
Earth to the spacecraft, y points along direction of the motion of the chief spacecraft, and
z completes the triad, as shown in Fig. 1. Moreover, linearization is applied to derive the
dynamics of the deputy motion in the classical approach.
To discuss the formation of spacecraft about the Earth, we usually consider that the
two-body model governs the motion of the chief spacecraft. Accordingly, given the posi-
2
where δr = (x, y, z). To simplify, we re-write Eq. (7) in the following way:
δr¨− 2ωfJδr˙− VRRδr = 0 (8)
VRR = n
2
lc
 3 + e cos f −2e sin f 02e sin f e cos f 0
0 0 −1
 (9)
ωf = nlc
√
1 + e cos f (10)
J =
 0 1 0−1 0 0
0 0 0
 (11)
Where VRR is the second partial derivative of the force potential with repect to vector, ωf
is the rotation rate of the rotational frame.
Equation (7) is a general form of the dynamics governing the relative motion in the
vicinity of a Keplerian orbit. By setting e = 0, Eq. (7) degenerates to the Clohessy-
Wiltshire Equation, which describes the relative motion about a circular orbit. Generally
speaking, Eq. (7) does not have a closed-form solution, except for e = 0. The eigenstruc-
ture is also too complex to reach a general conclusion, because the force potential matrix
is not symmetric. An alternative way to investigate this problem is through the Tschauner-
Hempel Equation (T-H Equation) [6].
Clohessy-Wiltshire Equation
To verify the derivation of Eq. (7), we let e = 0. Then the EOM degenerates to x¨y¨
z¨
 = 2nJ
 x˙y˙
z˙
+ n2
 3 0 00 0 0
0 0 −1
 xy
z
 , (12)
which is the well known “the Clohessy-Wiltshire Equation” (the C-W Equation) describing
the relative motion about a circular orbit. The solution to the C-W equation can be obtained
analytically [5]:
x(t) = 4x0 +
2y˙0
n
− (3x0 + 2y˙0
n
) cos(nt) +
x˙0
n
sin(nt) (13)
y(t) = y0 − 2x˙0
n
+
2x˙0
n
cos(nt) + (6x0 +
4y˙0
n
) sin(nt)− (6x0 + 3y˙0
n
)nt (14)
z(t) = z0 cos(nt) +
z˙0
n
sin(nt) (15)
By letting y˙0 = −2nx0, we can obtain a periodic solution:
x(t) = x0 cos(nt) +
x˙0
n
sin(nt)
4
+
e2
8
ρ21 cos 2f −
1
8
(4 + e2)ρ21 cos(2f + 2α) +
1
4
ρ23 cos(2f + 2β)
−e
8
ρ21 cos(3f + 2α)
y1 = −e
2
8
ρ21 sin 2f +
e
4
ρ1ρ2 sin(2f + α)− 1
8
(2− e2)ρ21 sin(2f + 2α)
−1
4
ρ23 sin(2f + 2β)
z1 =
3
2
ρ1ρ3 cos(α− β) + 1
2
cos(2f + α+ β)
FULL APPROACH
In this section we are going to discuss the so-called “full approach” that obtains a natu-
ral, periodic, relative trajectory from full solutions instead of integration from a linearized
model.
Natural Periodic Solution
In the two body problem there exist natural periodic trajectories, the elliptical and circu-
lar orbits, and their periods are determined by the semi-major axes. Taking the geocentric
inertial frame into account, we can view the uncontrolled formation as spacecraft orbiting
in two neighboring elliptical orbits with same period. Under this situation, the relative
motion of the deputy spacecraft to the chief spacecraft would naturally be periodic.
To be consistent with proceeding discussion, we would also like to investigate this al-
gorithm in the rotational frame attached with the chief spacecraft. We first formulate the
motion of chief spacecraft in the geocentric rotational frame whose rotation rate equals to
that of chief spacecraft orbiting the Earth, meaning that Rrc = (R, 0, 0), where the sub-
script “rc” means rotational frame with the chief. Similarly, we can formulate the motion
of the deputy spacecraft as rrd = (r, 0, 0) in the geocentric rotational frame whose rotation
rate equals to that of deputy spacecraft orbiting the Earth.
Then we can transform the position vector into the geocentric inertial frame with rotation
matrices, [R1] and [R2], such that
RI = [R1]Rrc
rI = [R2]rrd
The composite rotation matrices [R1] and [R2] can be computed in the following way:
[Rk] = Rz(Ωk)Rx(ik)Rz(ωk + fk) k = 1, 2
where Ω, i, ω, and f denote the longitude of ascending node, the inclination, the argument
of periapsis, and the true anomaly, respectively, and the rotation matrices Rx and Rz are
6
∆y = − sin(f1 − f2)− δω cos(f1 − f2)− δΩ[cos i2 sin(ω1 + f1)
sin(ω2 + f2) + cos i1 cos(ω1 + f1) cos(ω2 + f2)] +
δω2
2
sin(f1 − f2) + δΩ
2
2
[sin(ω1 + f1) cos(ω2 + f2)− cos i1 cos i2
cos(ω1 + f1) sin(ω2 + f2)]− δi
2
2
cos(ω1 + f1) sin(ω2 + f2)
∆z = −δi sin(ω2 + f2) + δΩ sin i1 cos(ω2 + f2) + δΩ
2
2
sin i1 cos i2
sin(ω2 + f2)
Application to Formation about Keplerian Orbits
Equation (23) gives an analytical expression of relative motion about an elliptical orbit
with a small initial excursion. Without lost of generality, we let ω1 = pi/2 to simplify the
derivation. Also, consider a simpler case, δω = 0 and δΩ = 0, and both orbits with the
same epoch time, tp. Equation (23) then becomes:
δr = r
 (1− δi22 ) cos f1 cos f2 + sin f1 sin f2−(1− δi2
2
) sin f1 cos f2 + cos f1 sin f2
−δi cos f2
−
 R0
0
 (24)
We can further simplify Eq. (24) by replacing r and f2 with R, r, e1, and e2. First of all,
in the two body problem, r is given by:
r =
a(1− e22)
1 + e2 cos f2
(25)
Moreover, the transformation of true anomaly to eccentric anomaly is given by the rela-
tions:
sin f =
√
1− e2 sinE
1− e cosE
cos f =
cosE − e
1− e cosE
Therefore,
r cos f2 =
a(1− e22) cos f2
1 + e2 cos f2
= a(cosE2 − e2) (26)
r sin f2 =
a(1− e22) sin f2
1 + e2 cos f2
= a
√
1− e22 sinE2 (27)
8
to evaluate Eqs. (31) to (33) so that we can obtain
x = R[
−δe(1 + e1 cos f1) cos f1
1− e21
+
− δe2
2
(1 +
e21√
1−e21
) sin2 f1 − δi22 (1− e21 − e1δe) cos2 f1
1− e21 − δe(e1 + cos f1)
] (34)
y = R sin f1{−−δe(1 + e1 cos f1)
1− e21
+
[− δe2
2
(1 +
e21√
1−e21
) + δi
2
2
(1− e21 − e1δe)] cos f1 − δe
1− e21 − δe(e1 + cos f1)
} (35)
z = Rδi[cos f1 +
δe(1 + e1 cos f1)
1− e21
+
δe sin2 f1
1− e21 − δe(e1 + cos f1)
] (36)
Application to Formation about Keplerian circular Orbits
Since the nominal trajectory is circular, leading to e1 = 0, we have
x = R(−δe cos f1 −
1
2
δe2 sin2 f1 − δi22 cos2 f1
1− δe cos f1 + . . .)
y = R(2δe sin f1 +
(1
2
δe2 + δi
2
2
) cos f1 sin f1
1− δe cos f1 + . . .)
z = Rδi(cos f1 − δe− δe sin
2 f1
1− δe cos f1 )
We notice that Rδi is actually the initial excursion in the z direction, z0, in the C-W
Equation. By letting −Rδe = x0, Our solution is completed by:
x = x0(cos f1 +
1
2
δe sin2 f1 +
z20
2x20
δe cos2 f1
1− δe cos f1 ) (37)
y = −x0(2 sin f1 +
(1
2
+
z20
2x20
)δe cos f1 sin f1
1− δe cos f1 ) (38)
z = z0(cos f1 − δe− δe sin
2 f1
1− δe cos f1 ) (39)
The first term of our result agree with the solution from the C-W Equation. This proves
the validity of our derivation. In addition, we obtain a higher order term through this
procedure so that we can predict the trajectory more precisely. Another advantage of our
methodology is that we don’t have to solve a differential equation as the C-W Equation did.
This simplify the computation and improve accuracy.
10
approach, the so-called “full approach”. We subtract two adjacent orbits in the two-body
problem to get the relative motion, and then simplify the results with several approxima-
tions. This procedure avoids solving differential equations in a linearized model, and obtain
a more precise solution for the trajectory. With the same initial conditions, our prediction
of trajectory is about as twice precise as the prediction from the C-W Equation. With the
initial conditions obtained from our model, the formation can be kept very well even under
the nonlinear circumstance. This result can be applied to small spacecraft formation for
the interferometric purpose, and used for lowering down the fuel usage for relative orbit
maintenance.
ACKNOWLEDGEMENT
The work described here was funded by the National Science Council through project NSC-
94-2212-E-032-015.
APPENDIX I
To investigate the the change in eccentric anomaly due to the change in eccentricity, we
first look into the Kepler’s equation:
Me = n(t− tp) = E − e sinE
There is no closed-form solution for eccentric anomaly E in Kepler’s equation. However,
this equation can be solved with a power series of e [19]:
E =Me +
∞∑
n=1
ane
n (40)
where
an =
1
2n−1
Σ
floor(n/2)
k=0 (−1)k
1
(n− k)!k! (n− 2k)
n−1 sin[(n− 2k)Me]
Equation (40) is named “Lagrange Series” and converges when e < 0.662743419. To
simplify the derivation but still keep the accuracy, we take the first three terms of the series
into consideration, given by,
E =Me + e sinMe +
e2
2
sin 2Me +
e3
8
(3 sin 3Me − sinMe)
In the preceding section we have selected two adjacent orbits with the same tp. Thus, at
any instant t the two spacecraft would have the same Me. Define δE = E2 − E1 and we
obtain
δE = (e2 − e1) sinMe + e
2
2 − e21
2
sin 2Me +
e32 − e31
8
(3 sin 3Me − sinMe) (41)
12
REFERENCES
[1] Born, M., and Wolf, E., “Principles of optics,” New York: Pergamon Press, 1964
[2] Dyson, J., “Interferometry as a measuring tool,” Brighton: Machinery Publishing,
1970
[3] Hariharan, P., “Basics of interferometry,” Boston: Academic Press, 1992
[4] Hussein, I., Scheeres, D. J., and Hyland D. C.,“Interferometric Observatories in Earth
Orbit ,”Journal of Guidance, Control, and Dynamics , Vol. 27, NO. 2, 2004, pp 297-
301
[5] Clohessy, W. H., “Terminal Guidance System for Satellite Rendezvous,” Journal of
Aerospace Sciences, Vol. 27, No. 9, September 1960, pp. 653-658,674
[6] Tschauner, J. and Hempel, P., “Rendezvous with a Target in Elliptic Orbit,” Astro-
nautica Acta, Vol. 11, No. 2, 1965, pp. 104-109
[7] Vadali, S. R., “An Analytical Solution for Relative Motion of Satellites,” Proceed-
ings of the 5th International Conference on Dynamics and Control of Structures and
Systems in Space, Cranfield University Press, 2002, pp.309-316
[8] Melton, R. G., “Time-Explicit Representation of Relative Motion Between Elliptical
Orbits,” Journal of Guidance, Control, and Dynamics, Vol. 23, No.4, 2000, pp. 604-
610
[9] Vadali, S. R. and Alfriend, K. T., “Modeling and Control of Satellite Formations in
High Eccentricity Orbits,” The Journal of the Astronautical Science, Vol. 52, No.
1-2, 2004, pp. 149-168
[10]Prasenjit Sengupta and Vadali, S. R., “Periodic Relative Motion Near A Keplerian
Elliptic Orbit with Nonlinear differential Gravity,” 16th AAS/AIAA Space Flight Me-
chanics Conference
[11]Hsiao, F. Y., Scheeres, D. J.,“Design of Spacecraft Formation Orbit Relative to a
Stabilized Trajectory ,”Journal of Guidance, Control, and Dynamics , Vol. 28, NO.
4, 2005, pp 782-794
[12]Hsiao, F. Y., and Scheeres, D. J., “The Dynamics of Formation Flight About a Stable
Trajectory ,”Journal of The Astronautical Sciences,Vol. 50, NO. 3, 2002, pp. 269-287
[13]Scheeres, D. J., Hsiao, F. Y., and Vinh, N. X.,“Stabilizing Motion Relative to an
Unstable Orbit: Applications to Spacecraft Formation Flight ,”Journal of Guidance,
Control ans Dynamics, Vol. 26, NO. 1, 2003, pp 62-73
[14]Bay, J. S., Fundamentals of Linear State Space Systems, 1999
[15]Nemytskii, V. V, Stepanov, V. V., Qualitative Theory of Differential Equation ,Dover,
New York, 1989, pp. 152
[16]Barden, B. T., and Howell, K. C.,“Fundamental Motions Near Collinear Libration
Points and Their Transitions ,”Journal of The Astronautical Sciences, Vol. 46, 1998,
pp 361-378
[17]Sabol, C. Burns, R., and Mclaughlin, C. A.,“Satellite Formation Flying Design and
Evolution ,”Journal of Spacecraft and Rockets, Vol. 38, No. 2, 2001, pp 270-278
14
To Earth
x
yz
δr
Chief
Deputy
Nominal Trajectory
Figure 1: A cartoon showing how the coordinates are defined, and the relative positions
between the chief and deputy spacecraft.
−2.5 −2 −1.5 −1 −0.5 0 0.5 1 1.5 2 2.5
−1.5
−1
−0.5
0
0.5
1
1.5
2
y
Figure 2: The relative motion governed by the C-W Equation. The initial conditions are
selected to generate a relative circular motion in the y − z plane. In this simulation, the
initial excursion is selected as x0 = 1, z0 = 2x0, y˙0 = −2nx0, z˙0 = 0 and n =
√
µe/70003.
The simulation is run for one period.
16
行政院國家科學委員會補助國內專家學者出席國際學術會議報告 
                                                            96 年 2 月 9 日 附件三
 
報告人姓名 蕭富元 
Fu-Yuen Hsiao 
 
服務機構
及職稱 
淡江大學航太系 
助理教授 
 
     時間 
會議 
     地點 
96/1/28-96/2/1 
Sedona, AZ, USA 
本會核定
補助文號
國科會計劃編號: 
95-2221-E-032-011- 
會議 
名稱 
 (中文) 2007 年度 AAS/AIAA 合辦太空飛行力學會議 
 (英文) 2007 AAS/AIAA Space Flight Mechanics Meeting, Sedona, AZ 
發表 
論文 
題目 
(中文) AAS 07 – 111 利用全解逼近法來求得刻卜勒型軌道之週期性相對運動 
(英文) AAS 07 – 111 Periodic Relative Motion Near a Keplerian Orbit with Full Approach 
(中文) AAS 07 – 154 近圓軌道之太空船編隊控制 
(英文) AAS 07 – 154 Control of Spacecraft Formation about a Near-Circular Orbit 
報告內容應包括下列各項： 
一、參加會議經過 
1/28 抵達及註冊 1/31 與其它學者交流及討論 
1/29 上午發表論文 AAS-111 2/01 離開 Sedona, AZ 
1/30 上午發表論文 AAS-154 及下
午參觀天文台 
 
 
二、與會心得 
AAS/AIAA Space Flight Mechanics Meeting 為美國太空學界之重要學術發表會。此次與會不僅有
機會將本身之研究公之於世，亦是一個與全世界其它學者互相切磋之難得機會。在四天的會議
之中，各界的學者不但對我的研究提出許多精闢的見解和意見，我也攜回了許多有用的資料，
以做為日後研究時的參考。而且許多學者亦向我表示合作的興趣，為將來國際合作打開一扇窗。
 
三、考察參觀活動(無是項活動者省略) 
 
至 Flagstaff 市區之 Lowell Observatory 參觀 
 
四、建議 
 
無 
 
五、攜回資料名稱及內容 
 
2007 AAS/AIAA Spaceflight Mechanics Meeting Proceeding 
 
六、其他 
 
 
表 Y04 
is performed by measuring the mutual intensity (the two point correlation [1-4]) that results
from the collection and subsequent interference or two electric field measurements of a
target made at two different observation point, with which a 2-D or 3-D mapping can be
generated. Several space missions using interferometry for scientific observation have been
carried out or under planning all over the world since 1978, such as TOPSAT by NASA.
However, those missions were accomplished by a single spacecraft. A more efficient way
to perform interferometric imagine is the usage of spacecraft formation. Results of this
study will contribute to possible application of formation flight techniques about a Low
Earth circular orbit.
The current state of art in investigating formation flight around the Earth is to solve the
linearized dynamics, such as the Clohessy-Wiltshire Equation (C-W Equation) [5] or the
Tschauner-Hempel Equation (T-H Equation) [6], dealing with the relative motion about a
circular or elliptic orbit, respectively. Many researchers have been devoted themselves into
formation investigation in different areas, as shown in Ref. [7-12]. However, those scien-
tists investigated formation problems around an Earth orbit usually approached by looking
for natural periodic solutions. No methodology regarding control law design was proposed
so far. The linearized model described by the T-H Equation is time varying. According,
we would like to apply the “local time approximation”, developed for the control of rela-
tive motion about a halo orbit by Hsiao and Scheeres, to guide out thinking, and develop a
feasible control law in the spacecraft formation about a Keplerian orbit.
In this paper we try to investigate the feasibility of applying local time approximation
to the spacecraft formation problem about a Keplerian orbit, and develop control law to
stabilize the unstable trajectories. To apply the local time approximation, we first need to
show that our problem satisfies certain assumptions detailed in Ref. [11,12]. Having proved
this, we then investigate possible control laws, one of which will generate a trajectory of
the “scaled” nominal orbit.
In detail, we first consider a spacecraft formation about a nominal Keplerian orbit, whose
dynamics described by the T-H Equation. Then the applicability of the “local time approx-
imation” is analytically proved, and utilized to guide our thinking of control law design.
We also propose potential control law investigated both in the time domain and in the true-
anomaly domain. By designing the control law in the true-anomaly domain, we not only
stabilize the unstable relative trajectory, but also “re-construct” the “scaled” nominal orbit
for our formation of spacecraft. Numerical simulations are also presented to verify our
results. The results will later contribute to the formation flight of spacecraft about the Earth
orbit with applications to interferometric imagining.
DYNAMICS MODEL
General Equations of Motion
A spacecraft formation problem is usually formulated as the problem of relative motion
2
analytic solution [6,7,9]:
x¯ = c1 cos f(1 + e cos f) + c2 sin f(1 + e cos f)
+
3c3
η2
[1− 3e
2η3
sin f(1 + e cos f)M ] (5)
y¯ = −c1 sin f(2 + e cos f) + c2 cos f(2 + e cos f)
−3c3
η5
(1 + e cos f)2M + c4 (6)
z¯ = c5 cos f + c6 sin f (7)
where c1 to c6 are coefficients determined by initial conditions, η =
√
1− e2, and M =
nt = E − e sinE is the Mean anomaly. We should notice that the motion in the z axis is
decoupled from the xy plane, and it is “nearly” simple harmonic. The only difference is
that the motion described in the above equations must be transformed back to the original
coordinates by multiplying the magnitude of the chief position. There exsit some initial
conditions leading to a natural periodic motion, which may be utilized for formation flight
of spacecraft, fully discussed in Ref. [6, 7, 9]. In most cases, however, the motion is a linear
combination of various modes. We can see from Eq. (6) that, in most cases, the motion in
the y-direction will drift away gradually if no control law is applied to the spacecraft.
Local Time Approximation
Local Time Approximation
The “local time approximation” was first proposed by Hsiao and Scheeres [11,12] to solve
the control problem of spacecraft formation about an unstable halo orbit. The spirit of the
local time approximation is to treat a time varying system as locally time invariant, and the
control law is design based on the local time-invariant system. This algorithm has been
shown valid and robust in controlling the formation about an unstable halo orbit, and in
designing the orbit of the constellation.
Consider a linear, time varying, periodic dynamics, formulated by
x˙ = A(t)x (8)
where x(t) is the states and A(t) is periodic with the period T , i.e.,
A(t+ T ) = A(t)
According to the linear theory [13], the solution to the Eq. (8) can be written as
x(t) = Φ(t, t0)x0
4
Accordingly, the equations of motion can be expressed as
x¯
′
= A(f)x¯ (13)
where (′) denotes the derivatives with respect to f , and
A(f) =
[
0 I
V (f) 2J
]
6×6
(14)
We should note that A(f) is periodic with the normalized period of 2pi.
Equation (13) is similar to Eq. (8). Therefore, we can view the variable in Eq. (8) as a
free parameter, and apply the same analysis in the preceding section to Eq. (13) simply by
letting t = f . Moreover, all norms are equal given A(f) finite dimension. The ∞-norm of
a matrix is selected in the practical computation, where the definition of ∞-norm is:
‖A‖∞ = max
i
∑
j
|aij| (15)
Given A(f) in Eq. (12) and 0 < e < 1, the norm of A(fi) is computed as
‖A(fi)‖∞ = max
i
∑
j
|aij(fi)|
= max
i
(1, 1, 1, 2 +
3
1 + e cos fi
, 2, 1)
= 2 +
3
1 + e cos fi
(16)
On the other hand, we should compare the result of Eq. (16) with ‖A′(fi)δfi‖∞. Given
A(f) =
[
0 I
V 2J
]
6×6
(17)
then the derivative of A(f) with respect to f is given by
A
′
(f) =
[
0 0
V
′
0
]
6×6
(18)
where
V
′
=
 3e sin f(1+e cos f)2 0 00 0 0
0 0 0
 (19)
Therefore,
‖A′(fi)δfi‖∞ = max
i
(0, 0, 0,
∣∣∣∣ 3e sin fiδfi(1 + e cos fi)2
∣∣∣∣ , 0, 0)
=
3e| sin fiδfi|
(1 + e cos fi)2
(20)
6
According to the local time approximation, during the time interval ti−δt ≤ ti ≤ ti+δt,
|δt| ¿ 1, the system can be formulated as linear time invariant, given by
δr¨− 2ω(ti)Jδr˙− V (ti)δr = 0 (23)
where δr = (x, y, z), and
ω(ti) = nlc(ti)
√
1 + e cos f(t− i)
V (ti) = n
2
lc(ti)
 3 + e cos f(ti) −2e sin f(ti) 02e sin f(ti) e cos f(ti) 0
0 0 −1

In Ref. [10], a position-and-velocity feedback, given by
T (ti) = −2ω(ti)Jδr˙− Vcr(ti)δr, (24)
is designed to null out the Coriolis force and create a “three dimensional oscillator” in the
rotational system. With proper initial conditions an arbitrary trajectory can be generated.
The controller is applied in the following way
x˙ = A(ti)x+ T (ti)
such that the controlled equations of motion are then in the following form:
δr¨− Vdes(ti)δr = 0 (25)
where the force potential matrix Vdes(ti) contains the desired oscillating modes. Accord-
ingly, the position feedback in the controller can be obtained as
Vcr(ti) = V (ti)− Vdes(ti) (26)
For example, by making
Vdes(ti) =
 −ω21 0 00 −ω22 0
0 0 −ω23
 ,
we can create a system with three oscillators and arbitrary trajectories [10]. A relative circu-
lar formation can be achieved by designing a controller with all the oscillating frequencies
the same, i.e., Vdes(ti) = −ω2I, and with proper selection of initial conditions.
Control Law Design in T-H Equation
In addition to do trajectory control in the time domain, an alternate approach is from the
T-H Equation. The T-H Equation describes the relative motion about a Keplerian orbit, and
there exist analytic solutions to the equation, as shown in Eqs. (5)- (7). However, we should
8
we design a state feedback controller T¯ (fi) = B¯x¯ for x¯′ = A¯x¯′ in the true-anomaly
domain. The transformation can be established by applying the chain rule:
d(·)
dt
=
d(·)
df
df
dt
= f˙
d(·)
df
(28)
Given x = T x¯, where T is the transformation matrix, the time derivative of x is given
by x˙ = T˙ x¯ + T ˙¯x. Since x¯ is a function of f , we can apply the chain rule to obtain the
derivative of x¯ with respect to f , given by:
x˙ = f˙T
′
x¯+ f˙T x¯
′
where (′) denotes the derivatives with respect to f , and the values of T and T ′ are given in
the appendix. Since x˙ = Ax and x¯′ = A¯x¯, the transformation is given by
Ax = f˙T
′
x¯+ f˙T A¯x¯
= (f˙T
′
+ f˙T A¯)x¯
= (f˙T
′
+ f˙T A¯)T−1x
(29)
or,
A = f˙T
′
T−1 + f˙T A¯T−1 (30)
Given the controllers T¯ (fi) written as T¯ = B¯x¯ and T = Bx, from Eq. (30) we have
A+B = f˙T
′
T−1 + f˙T (A¯+ B¯)T−1
= f˙T
′
T−1 + f˙T A¯T−1 + f˙T B¯T−1
Equating the matrix A with transformation in Eq. (30) we obtain
B = f˙T B¯T−1 (31)
Controlling the Original Nonlinear System
Although a neat conclusion is drawn in the linear scheme, the control law should be
examined in the original nonlinear system, which is assumed exclusively governed by the
Newton’s Gravitation Law, given by:
r¨ =
−µ
r3
r
Applied the state feedback law, over every small time interval ti − δt ≤ ti ≤ ti + δt the
controlled system is written in the following way,
r¨ =
−µ
r3
r+ T (ti) (32)
where T (ti) is given in Eq. (24) and must be transformed back to inertial frame. Moreover,
δr in Eq. (24) are evaluated as δr = r−R.
10
APPENDIX
Given δr = Rδr¯, we have
δr˙ = R˙δr¯+Rδ ˙¯r (33)
However, from Eq. (28) we can rewrite Eq. (33) as
δr˙ = f˙(R
′
δr¯+Rδr¯
′
) (34)
The derivatives of f˙ and R with respect to f can by analytically derived as:
R
′
=
d
df
(
p
1 + e cos f
)
=
(
p
1 + e cos f
)(
e sin f
1 + e cos f
)
= RF (35)
d
df
f˙ =
d
df
( h
R2
)
=
df˙
dR
dR
df
=
−2h
R3
RF
= −2f˙F (36)
where
F =
e sin f
1 + e cos f
(37)
Therefore, we can establish the transformation matrix T , given by
T =
[
RI 0
f˙RF I f˙RI
]
(38)
Similarly, we can obtain T ′ by taking the derivative of T with respect to f :
T
′
=
[
RF I 0
f˙RF¯ I −f˙RF I
]
(39)
where
F¯ =
e cos f
1 + e cos f
(40)
12
To Earth
x
yz
δr
Chief
Deputy
Nominal Trajectory
Figure 1: A cartoon showing how the coordinates are defined, and the relative positions
between the chief and deputy spacecraft.
−1 −0.8 −0.6 −0.4 −0.2 0 0.2 0.4 0.6 0.8 1
x 104
−6000
−4000
−2000
0
2000
4000
6000
X (km)
Nominal Trajectory with a=7000 e=0.001
Figure 2: A nominal orbit with semi-major axis of 7000 km, and eccentricity of 0.001 is
used to simulate the formation flight.
14
−10000 −8000 −6000 −4000 −2000 0 2000 4000 6000 8000
−6000
−4000
−2000
0
2000
4000
6000
X (km)
Nominal Trajectory with a=7000 e=0.1
Figure 5: A nominal orbit with semi-major axis of 7000 km, and eccentricity of 0.1 is used
to simulate the formation flight.
−60 −40 −20 0 20 40
−40
−30
−20
−10
0
10
20
30
40
y (m)
z 
(m
)
Relative Trajectory with nominal a=7000 e=0.1
Figure 6: A spacecraft formation with initial excursion of 50 m from the nominal is sim-
ulated. The nominal orbit is shown in Fig. 5, and the formation is simulated for one orbit
period.
16
−1.5 −1 −0.5 0 0.5 1 1.5 2 2.5 3
−1.5
−1
−0.5
0
0.5
1
1.5
2
y (m)
z 
(m
)
Relative Trajectory with nominal a=7000 e=0.001
Figure 9: A spacecraft formation with initial excursion of 1 m from the nominal, shown at
Fig. 8, is simulated in the original nonlinear scheme. This plot shows the controlled and the
uncontrolled trajectory with initial excursion about the nominal. The controlled trajectory
is run for one full period while the uncontrolled is only run for 3000 seconds.
0 1000 2000 3000 4000 5000 6000
0
0.5
1
1.5
2
2.5
3
3.5
4
x 10−5
Time (s)
|∆ 
V| 
(m
/s)
Cost of formation per spacecraft with nominal a=7000 e=0.001
Figure 10: A spacecraft formation with initial excursion of 1 m from the nominal, shown
at Fig. 8, is simulated in the original nonlinear scheme. This plot shows the cost in order to
control a spacecraft shown in Fig. 9.
18
target made at two different observation point, with which a 2-D or 3-D mapping can be
generated. Several space missions using interferometry for scientific observation have been
carried out or under planning all over the world since 1978, such as TOPSAT by NASA.
However, those missions were accomplished by a single spacecraft. A more efficient way
to perform interferometric imagine is the usage of spacecraft formation. Results of this
study will contribute to possible application of formation flight techniques about a Low
Earth circular orbit.
The current state of art in investigating formation flight around the Earth is to solve the
linearized dynamics, such as the Clohessy-Wiltshire Equation (C-W Equation) [5] or the
Tschauner-Hempel Equation (T-H Equation) [6], dealing with the relative motion about
a circular or elliptic orbit, respectively. Many researchers have been devoted themselves
into formation investigation in different areas, as shown in Ref. [7-13]. The results obtained
from the linearized model, however, should be verified in the original nonlinear Gravitation
Law. We can see that the error caused by omitting the higher order term during linearization
will be integrated as time elapses. Therefore, we would like follow a contrary way that
starts with a full solution from the original dynamics and approximates our results to a
simpler and applicable form. We call the methodology “the full approach”.
In this paper we try to investigate the feasibility of applying formation flight to small
or micro/nano satellites. An important feature of those satellites is small in volume and
light in weight, so that they cannot carry too much fuel for orbit control. Although the
C-W Equation and the T-H Equation have proposed some initial conditions that leads to a
periodic trajectory, and can be utilized for formation in the linear sense, the nonlinearity
may still destroy the formation. Hence, a better approximation with which the formation
can still be kept under the nonlinear circumstance is important.
In detail, we first discuss the classical approach to relative dynamics. Then we subtract
two adjacent orbits in the two-body problem to get the relative motion, and simplify the
results after several approximations. This process avoids solving differential equations of
the linearized model, and obtains a more precise solution for the trajectory. Numerical
simulations and error analysis are also presented to show the robustness of our results.
CLASSICAL DYNAMICS MODEL
General Equations of Motion
A spacecraft formation problem is usually formulated as the problem of relative motion
with a chief spacecraft on the nominal trajectory and a deputy spacecraft in the vicinity.
A body-fixed frame attached on the chief spacecraft is selected such that x points from
Earth to the spacecraft, y points along direction of the motion of the chief spacecraft, and
z completes the triad, as shown in Fig. 1. Moreover, linearization is applied to derive the
dynamics of the deputy motion in the classical approach.
To discuss the formation of spacecraft about the Earth, we usually consider that the
two-body model governs the motion of the chief spacecraft. Accordingly, given the posi-
2
where δr = (x, y, z). To simplify, we re-write Eq. (7) in the following way:
δr¨− 2ωfJδr˙− VRRδr = 0 (8)
VRR = n
2
lc
 3 + e cos f −2e sin f 02e sin f e cos f 0
0 0 −1
 (9)
ωf = nlc
√
1 + e cos f (10)
J =
 0 1 0−1 0 0
0 0 0
 (11)
Where VRR is the second partial derivative of the force potential with repect to vector, ωf
is the rotation rate of the rotational frame.
Equation (7) is a general form of the dynamics governing the relative motion in the
vicinity of a Keplerian orbit. By setting e = 0, Eq. (7) degenerates to the Clohessy-
Wiltshire Equation, which describes the relative motion about a circular orbit. Generally
speaking, Eq. (7) does not have a closed-form solution, except for e = 0. The eigenstruc-
ture is also too complex to reach a general conclusion, because the force potential matrix
is not symmetric. An alternative way to investigate this problem is through the Tschauner-
Hempel Equation (T-H Equation) [6].
Clohessy-Wiltshire Equation
To verify the derivation of Eq. (7), we let e = 0. Then the EOM degenerates to x¨y¨
z¨
 = 2nJ
 x˙y˙
z˙
+ n2
 3 0 00 0 0
0 0 −1
 xy
z
 , (12)
which is the well known “the Clohessy-Wiltshire Equation” (the C-W Equation) describing
the relative motion about a circular orbit. The solution to the C-W equation can be obtained
analytically [5]:
x(t) = 4x0 +
2y˙0
n
− (3x0 + 2y˙0
n
) cos(nt) +
x˙0
n
sin(nt) (13)
y(t) = y0 − 2x˙0
n
+
2x˙0
n
cos(nt) + (6x0 +
4y˙0
n
) sin(nt)− (6x0 + 3y˙0
n
)nt (14)
z(t) = z0 cos(nt) +
z˙0
n
sin(nt) (15)
By letting y˙0 = −2nx0, we can obtain a periodic solution:
x(t) = x0 cos(nt) +
x˙0
n
sin(nt)
4
+
e2
8
ρ21 cos 2f −
1
8
(4 + e2)ρ21 cos(2f + 2α) +
1
4
ρ23 cos(2f + 2β)
−e
8
ρ21 cos(3f + 2α)
y1 = −e
2
8
ρ21 sin 2f +
e
4
ρ1ρ2 sin(2f + α)− 1
8
(2− e2)ρ21 sin(2f + 2α)
−1
4
ρ23 sin(2f + 2β)
z1 =
3
2
ρ1ρ3 cos(α− β) + 1
2
cos(2f + α+ β)
FULL APPROACH
In this section we are going to discuss the so-called “full approach” that obtains a natu-
ral, periodic, relative trajectory from full solutions instead of integration from a linearized
model.
Natural Periodic Solution
In the two body problem there exist natural periodic trajectories, the elliptical and circu-
lar orbits, and their periods are determined by the semi-major axes. Taking the geocentric
inertial frame into account, we can view the uncontrolled formation as spacecraft orbiting
in two neighboring elliptical orbits with same period. Under this situation, the relative
motion of the deputy spacecraft to the chief spacecraft would naturally be periodic.
To be consistent with proceeding discussion, we would also like to investigate this al-
gorithm in the rotational frame attached with the chief spacecraft. We first formulate the
motion of chief spacecraft in the geocentric rotational frame whose rotation rate equals to
that of chief spacecraft orbiting the Earth, meaning that Rrc = (R, 0, 0), where the sub-
script “rc” means rotational frame with the chief. Similarly, we can formulate the motion
of the deputy spacecraft as rrd = (r, 0, 0) in the geocentric rotational frame whose rotation
rate equals to that of deputy spacecraft orbiting the Earth.
Then we can transform the position vector into the geocentric inertial frame with rotation
matrices, [R1] and [R2], such that
RI = [R1]Rrc
rI = [R2]rrd
The composite rotation matrices [R1] and [R2] can be computed in the following way:
[Rk] = Rz(Ωk)Rx(ik)Rz(ωk + fk) k = 1, 2
where Ω, i, ω, and f denote the longitude of ascending node, the inclination, the argument
of periapsis, and the true anomaly, respectively, and the rotation matrices Rx and Rz are
6
∆y = − sin(f1 − f2)− δω cos(f1 − f2)− δΩ[cos i2 sin(ω1 + f1)
sin(ω2 + f2) + cos i1 cos(ω1 + f1) cos(ω2 + f2)] +
δω2
2
sin(f1 − f2) + δΩ
2
2
[sin(ω1 + f1) cos(ω2 + f2)− cos i1 cos i2
cos(ω1 + f1) sin(ω2 + f2)]− δi
2
2
cos(ω1 + f1) sin(ω2 + f2)
∆z = −δi sin(ω2 + f2) + δΩ sin i1 cos(ω2 + f2) + δΩ
2
2
sin i1 cos i2
sin(ω2 + f2)
Application to Formation about Keplerian Orbits
Equation (23) gives an analytical expression of relative motion about an elliptical orbit
with a small initial excursion. Without lost of generality, we let ω1 = pi/2 to simplify the
derivation. Also, consider a simpler case, δω = 0 and δΩ = 0, and both orbits with the
same epoch time, tp. Equation (23) then becomes:
δr = r
 (1− δi22 ) cos f1 cos f2 + sin f1 sin f2−(1− δi2
2
) sin f1 cos f2 + cos f1 sin f2
−δi cos f2
−
 R0
0
 (24)
We can further simplify Eq. (24) by replacing r and f2 with R, r, e1, and e2. First of all,
in the two body problem, r is given by:
r =
a(1− e22)
1 + e2 cos f2
(25)
Moreover, the transformation of true anomaly to eccentric anomaly is given by the rela-
tions:
sin f =
√
1− e2 sinE
1− e cosE
cos f =
cosE − e
1− e cosE
Therefore,
r cos f2 =
a(1− e22) cos f2
1 + e2 cos f2
= a(cosE2 − e2) (26)
r sin f2 =
a(1− e22) sin f2
1 + e2 cos f2
= a
√
1− e22 sinE2 (27)
8
to evaluate Eqs. (31) to (33) so that we can obtain
x = R[
−δe(1 + e1 cos f1) cos f1
1− e21
+
− δe2
2
(1 +
e21√
1−e21
) sin2 f1 − δi22 (1− e21 − e1δe) cos2 f1
1− e21 − δe(e1 + cos f1)
] (34)
y = R sin f1{−−δe(1 + e1 cos f1)
1− e21
+
[− δe2
2
(1 +
e21√
1−e21
) + δi
2
2
(1− e21 − e1δe)] cos f1 − δe
1− e21 − δe(e1 + cos f1)
} (35)
z = Rδi[cos f1 +
δe(1 + e1 cos f1)
1− e21
+
δe sin2 f1
1− e21 − δe(e1 + cos f1)
] (36)
Application to Formation about Keplerian circular Orbits
Since the nominal trajectory is circular, leading to e1 = 0, we have
x = R(−δe cos f1 −
1
2
δe2 sin2 f1 − δi22 cos2 f1
1− δe cos f1 + . . .)
y = R(2δe sin f1 +
(1
2
δe2 + δi
2
2
) cos f1 sin f1
1− δe cos f1 + . . .)
z = Rδi(cos f1 − δe− δe sin
2 f1
1− δe cos f1 )
We notice that Rδi is actually the initial excursion in the z direction, z0, in the C-W
Equation. By letting −Rδe = x0, Our solution is completed by:
x = x0(cos f1 +
1
2
δe sin2 f1 +
z20
2x20
δe cos2 f1
1− δe cos f1 ) (37)
y = −x0(2 sin f1 +
(1
2
+
z20
2x20
)δe cos f1 sin f1
1− δe cos f1 ) (38)
z = z0(cos f1 − δe− δe sin
2 f1
1− δe cos f1 ) (39)
The first term of our result agree with the solution from the C-W Equation. This proves
the validity of our derivation. In addition, we obtain a higher order term through this
procedure so that we can predict the trajectory more precisely. Another advantage of our
methodology is that we don’t have to solve a differential equation as the C-W Equation did.
This simplify the computation and improve accuracy.
10
approach, the so-called “full approach”. We subtract two adjacent orbits in the two-body
problem to get the relative motion, and then simplify the results with several approxima-
tions. This procedure avoids solving differential equations in a linearized model, and obtain
a more precise solution for the trajectory. With the same initial conditions, our prediction
of trajectory is about as twice precise as the prediction from the C-W Equation. With the
initial conditions obtained from our model, the formation can be kept very well even under
the nonlinear circumstance. This result can be applied to small spacecraft formation for
the interferometric purpose, and used for lowering down the fuel usage for relative orbit
maintenance.
ACKNOWLEDGEMENT
The work described here was funded by the National Science Council through project NSC-
94-2212-E-032-015.
APPENDIX I
To investigate the the change in eccentric anomaly due to the change in eccentricity, we
first look into the Kepler’s equation:
Me = n(t− tp) = E − e sinE
There is no closed-form solution for eccentric anomaly E in Kepler’s equation. However,
this equation can be solved with a power series of e [19]:
E =Me +
∞∑
n=1
ane
n (40)
where
an =
1
2n−1
Σ
floor(n/2)
k=0 (−1)k
1
(n− k)!k! (n− 2k)
n−1 sin[(n− 2k)Me]
Equation (40) is named “Lagrange Series” and converges when e < 0.662743419. To
simplify the derivation but still keep the accuracy, we take the first three terms of the series
into consideration, given by,
E =Me + e sinMe +
e2
2
sin 2Me +
e3
8
(3 sin 3Me − sinMe)
In the preceding section we have selected two adjacent orbits with the same tp. Thus, at
any instant t the two spacecraft would have the same Me. Define δE = E2 − E1 and we
obtain
δE = (e2 − e1) sinMe + e
2
2 − e21
2
sin 2Me +
e32 − e31
8
(3 sin 3Me − sinMe) (41)
12
REFERENCES
[1] Born, M., and Wolf, E., “Principles of optics,” New York: Pergamon Press, 1964
[2] Dyson, J., “Interferometry as a measuring tool,” Brighton: Machinery Publishing,
1970
[3] Hariharan, P., “Basics of interferometry,” Boston: Academic Press, 1992
[4] Hussein, I., Scheeres, D. J., and Hyland D. C.,“Interferometric Observatories in Earth
Orbit ,”Journal of Guidance, Control, and Dynamics , Vol. 27, NO. 2, 2004, pp 297-
301
[5] Clohessy, W. H., “Terminal Guidance System for Satellite Rendezvous,” Journal of
Aerospace Sciences, Vol. 27, No. 9, September 1960, pp. 653-658,674
[6] Tschauner, J. and Hempel, P., “Rendezvous with a Target in Elliptic Orbit,” Astro-
nautica Acta, Vol. 11, No. 2, 1965, pp. 104-109
[7] Vadali, S. R., “An Analytical Solution for Relative Motion of Satellites,” Proceed-
ings of the 5th International Conference on Dynamics and Control of Structures and
Systems in Space, Cranfield University Press, 2002, pp.309-316
[8] Melton, R. G., “Time-Explicit Representation of Relative Motion Between Elliptical
Orbits,” Journal of Guidance, Control, and Dynamics, Vol. 23, No.4, 2000, pp. 604-
610
[9] Vadali, S. R. and Alfriend, K. T., “Modeling and Control of Satellite Formations in
High Eccentricity Orbits,” The Journal of the Astronautical Science, Vol. 52, No.
1-2, 2004, pp. 149-168
[10]Prasenjit Sengupta and Vadali, S. R., “Periodic Relative Motion Near A Keplerian
Elliptic Orbit with Nonlinear differential Gravity,” 16th AAS/AIAA Space Flight Me-
chanics Conference
[11]Hsiao, F. Y., Scheeres, D. J.,“Design of Spacecraft Formation Orbit Relative to a
Stabilized Trajectory ,”Journal of Guidance, Control, and Dynamics , Vol. 28, NO.
4, 2005, pp 782-794
[12]Hsiao, F. Y., and Scheeres, D. J., “The Dynamics of Formation Flight About a Stable
Trajectory ,”Journal of The Astronautical Sciences,Vol. 50, NO. 3, 2002, pp. 269-287
[13]Scheeres, D. J., Hsiao, F. Y., and Vinh, N. X.,“Stabilizing Motion Relative to an
Unstable Orbit: Applications to Spacecraft Formation Flight ,”Journal of Guidance,
Control ans Dynamics, Vol. 26, NO. 1, 2003, pp 62-73
[14]Bay, J. S., Fundamentals of Linear State Space Systems, 1999
[15]Nemytskii, V. V, Stepanov, V. V., Qualitative Theory of Differential Equation ,Dover,
New York, 1989, pp. 152
[16]Barden, B. T., and Howell, K. C.,“Fundamental Motions Near Collinear Libration
Points and Their Transitions ,”Journal of The Astronautical Sciences, Vol. 46, 1998,
pp 361-378
[17]Sabol, C. Burns, R., and Mclaughlin, C. A.,“Satellite Formation Flying Design and
Evolution ,”Journal of Spacecraft and Rockets, Vol. 38, No. 2, 2001, pp 270-278
14
To Earth
x
yz
δr
Chief
Deputy
Nominal Trajectory
Figure 1: A cartoon showing how the coordinates are defined, and the relative positions
between the chief and deputy spacecraft.
−2.5 −2 −1.5 −1 −0.5 0 0.5 1 1.5 2 2.5
−1.5
−1
−0.5
0
0.5
1
1.5
2
y
Figure 2: The relative motion governed by the C-W Equation. The initial conditions are
selected to generate a relative circular motion in the y − z plane. In this simulation, the
initial excursion is selected as x0 = 1, z0 = 2x0, y˙0 = −2nx0, z˙0 = 0 and n =
√
µe/70003.
The simulation is run for one period.
16
