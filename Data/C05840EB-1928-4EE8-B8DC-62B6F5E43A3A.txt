須發照（可應用在 315/433/868/916 MHz）即享有
20-50kbps 之頻寬，新一代之模組更可在 2.4GHz 及
250kbps之頻寬下使用。此外，在能源提供方面，若需長
時間在戶外使用，則需考慮硬體模組是否可與太陽能電
池整合。
生產系統常因緊急插單、機器故障、缺料、協力廠
商因素，或其它管理問題而造成停線或需換線，當生產
系統發生前述事故時，管理人員將面臨重新調整派工之
決策問題(Chen et al., 2003)。實務上，多數生產機構在考
量生產成本的因素下，他們都偏好採用批次生產模式，
而在搜集生產資訊或品質資訊時，也因批次生產模式而
採批次登錄資料方式，因此管理者或決策者無法適時獲
取即時資訊。當生產系統發生緊急狀況時，決策者往往
喪失寶貴的前置處理時間，因而使得事故擴大。如何快
速取得現場之即時資訊，將是管理人員一項非常重要的
課題(Panella, 1999)。
3. ZigBee 與 802.15.4概述
所謂 ZigBee 乃一商業聯盟組織（ ZigBee
Specifications, 2005），其成立宗旨乃為發展一個能可靠、
合乎成本效益及低耗能之無線網路標準（含產品），其使
用技術乃依據 IEEE 802.15.4之標準，並特別針對實體層
MAC 層定義相關網路架構。ZigBee 網路架構如圖 1 所
示，其中 PHY 與 MAC 層由 IEEE 制定標準，而NWK
與APL(包含、APS、APO、ZDO)由ZigBee聯盟制定標
準。
圖1. ZigBee 網路架構與運作功能示意圖
在實體層方面，此網路支援三種頻帶：2450 MHz(搭
配16個通道)、915 MHz(搭配10個通道)及868 MHz(搭
配1個通道)。前述頻帶均使用DSSS接取模式，而2450
MHz另支援O-QPSK接取模式搭配中繼點為915及868
MHz模式。
有關MAC層方面，ZigBee定義了兩種節點型式：
Reduced Function Devices (RFDs) 和 Full Function
Devices (FFDs)。在網路拓樸方面，ZigBee使用三種網路
拓樸：Star、Tree 及 Mesh。FFD 通常用於 PAN 網路之
協調者及充當Router，而RFD則用於端點之資料接取及
充當傳令者(Sensor/Actuator)。
ZigBee 應用層是由一組 APO、ZDO 及 APS 所組
成，ZigBee 應用可由分布在網路節點上之一組
APO(Application Object) 所組成，APO 可由軟體來實
現，它用來控制硬體元件，包括變壓器、開關及顯示燈。
ZDO 則負責提供對應之服務給 APO，包括網路之搜尋
及聯網，同時負責網路通訊及網路安全控管。APS則負
責在 APO 和 ZDO 之間轉送資料。在實作 ZigBee 應用
時，所有介面屬性及訊息格式必須符合ZigBee聯盟制定
之標準，而ZigBee應用組件之提供者，其產品及介面屬
性必須能與聯盟成員之產品互相聯通。因此，運用
ZigBee模組可以快速且方便的建構無線感測網路。
4. 無線網路實作
為了能快速擷取被監控對象之即時資訊，本研究引
用ZigBee無線通訊協定及模組來建構無線私用網路
(WPAN)，在端點應用方面則搭配RFID讀取裝置及各式
數位式感應裝置來搜集各類資訊。此外，為了降低一般
用戶或是生產機構引用無線感測網路之門檻，本研究將
開發一套整合式資訊系統，其功能包括網路工作環境參
數設定、監控指令集產生器、監控對象及監控計畫設定、
自動資料搜集與剖析介面，以及自動通報指令管理。
4.1 網路架構
本研究採用赫立訊科技生產的 IP-Link 2220無線通
訊模組來建構感測網路，系統架構如圖2所示。IP-Link
AP
Object
1
AP
Object
240
…
Application Framework
Application Sub Layer (APS)
ZigBee Device
Object
(ZDO)
Application Layer (APL)
Network (NWK) Layer
Medium Access (MAC) Layer
Physical (PHY) Layer
ZigBee
Alliance
IEEE
802.15.4
本研究建議的資訊系統如圖3所示，由系統管理模
組及網路管理模組所組成，下分九個子模組，各模組之
功能簡述如下。
5.1 系統管理模組
此模組用於產生及管理各類系統指令、工作參數及
端點感測裝置之資料格式，設定資料則儲存在資料庫
內，預設資料庫為Access，也可改用MySQL。
5.1.1網路參數管理模組
此模組用於管理下列資料：
通訊埠之通訊格式
ZigBee 模組之工作參數。
連結感測器資料格式及資料接收方式
制動器之處理方式。
圖3. 自動資料搜集與通報資訊系統架構圖
5.1.2資料庫管理模組
此模組用於管理各類屬性資料表及感測網路傳入的
資料，也可處理進階資料，諸如圖示、群組、匯出及刪
除。感測資料將以ZigBee模組為單位，分別儲存在各自
的資料表內，以方便其它應用系統之取用，例如檢驗紀
錄表之製作。
5.1.3指令集產生器
用於產生各類ZigBee模組之控制指令，IP-Link 2220
之控制指令分成下列五種類型：
AT Command Mode
Command Request：要求執行指令
Command Response：執行結果回覆
Data Request ：要求傳送資料
Acknowledgment：回覆資料
事前可由使用者依預設介面來產生指令，完成之指令將
儲存在指令集資料表內，當啟動感測網路時，可由用戶
選用預設之指令集來設定網路環境及啟動系統。
5.1.4事件產生器
用於產生各類監控事件，本研究擬將監控事件類別
分成下列幾種型態，完成的事件將儲存在事件資料表內。
Data：用於比對是否收到預設資料（特定資料，例如
溫度）。
 Payload：用於比對是否收到預設資料框(複合型資
料)。
 IO：用於比對指定之端點是否被觸發（例如煙霧偵測
器被觸發）。
 SQL：用於比對預設SQL指令之資料事件是否為真
（例如門禁管制是否已將某張磁卡予以disable）。
 Timer：用於設定計時器，當預設時間符合時則啟動
對應動作指令。
5.1.5感測資料格式定義
用於設定各類感測元件之資料格式及各類REID
Reader之讀取資料指令，感測網路傳回之Payload將依
此格式來剖析資料。
5.2網路管理模組
此部份為本研究之核心模組，用來啟動、監控
與管理整個感測網路之運作。網路管理模組由下列
四個子模組所組成，對應功能摘述如後。
5.2.1系統運作管理模組
系統啟動方式，可由用戶選用預設之指令集來啟動
系統，而指令集將依不同格式而有不同之運作方式，運
作方式說明如下：
 Initiate：只在啟動系統時執行一次。
自動資料搜集與通報資訊系統
網路參數
管理模組
資料管
理模組
事件監
控模組
資料庫管
理模組
指令集
產生器
事件產
生器
系統管理模組 網路管理模組
系統運作
管理模組
感測資
料格式
定義
自動通
報模組
圖5. 運作過程流程圖
6.2 指令和系統參數管理
由於篇幅限制，本文僅就指令集產生器及途程監控
計畫加以說明，指令集產生器應用介面如圖 7 所示，用
戶可自行選用各式指令或輸入相關指令參數，IP-Link
2220之指令格式如表1所示。完成的指令集將儲存在資
料表內備用，當啟動 Sever 時，用戶可選取備用指令集
來管理感測網路，指令集範例如圖 8 所示。圖 9 為途程
監控計畫設定介面，完成的途程監控計畫如圖10。
圖7 設定指令集工作畫面
表1 IP-Link2220指令格式
Control Header
(1)
Command
Request
(4-bit)
b1000
Sequence
Number
(4-bit)
Link
Quality
Indicator
(1)
Destination
Address
(2)
Payload
Length
(1)
Command
Code
(1)
Parameters
(0–96)
XOR
Checksum
(1)
系統起始化
資料感測 指令運行
定時/持續/事件
事件比對
資料剖析
觸發通報事件
觸發系統監控事件
Action
Silence
設定節點資料及
資料格式
設定途程監控計畫
