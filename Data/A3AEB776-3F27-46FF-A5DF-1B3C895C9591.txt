1行政院國家科學委員會專題研究計畫成果報告
考慮環境污染處罰成本之供應鏈網路設計
Design for supply chain networks incorporating penalty costs of
environmental pollution
計畫編號：NSC 97-2221-E-426 -010
執行期限： 97 年 8 月 1 日至 98 年 7 月 31 日
主持人：郭淑娉(spguo@mail.leader.edu.tw) 立德大學運籌與行銷管理學系
一、中文摘要
本研究將以供應國內市場需求之單一企業
為研究對象，企業在設計其供應鏈網路時，假
設原物料／零組件可由國內或國外供應商供
應，且供應商為已知。企業以總成本最小化為
目標，選擇將製造中心設置於國內或國外區
位，然後在國內的組裝／配送中心組裝完成後
配送至已知的國內零售商手中。在此供應鏈網
路架構下，本研究首先以環境永續發展及貨物
運輸兩大領域為主體，廣泛回顧相關文獻。其
次，建構單一企業之傳統供應鏈網路模式，探
討企業以成本最小化為目標時之最適製造中
心、組裝／配送中心的區位。第三，考慮環境
永續議題，探討未來落實「京都議定書」所提
到之二氧化碳排放減量目標，並制定「碳排放
交易（ET）」機制時，企業應如何藉著重新設
計供應鏈網路模式，如改變原物料／零組件供
應商、製造中心區位、組裝／配送中心區位，
來降低供應鏈成本。最後，本研究以一研究個
案為例，進行範例分析，以說明本研究所構建
模式之操作過程。
關鍵字：供應鏈網路、區位選擇、環境永續
Abstract
This study focuses on an enterprise which
supplies for inbound demand of domestic markets.
Some assumptions are made when an enterprise is
devoted to design its supply chain. First,
material/components can be supply by domestic
and foreign supplies and are supposed to be given.
Second, alternative manufacturing centers can be
located in domestic or foreign location. Third, the
objective of enterprise is to minimize the total cost
in the supply chain. This study explores how an
enterprise selects locations of manufacturing
center and assembling/distribution center. The
contents of the study include three aspects. First,
literature about sustainable environment, freight
transportation and supply chain networks are
reviewed. Second, this study constructs a
traditional supply chain network model to explore
the optimal locations of manufacturing centers and
assembling/distribution centers based on the
objective of minimizing total cost. Third, this
study incorporates the issue of sustainable
environment and constructs a supply chain
network model with considering the penalty cost
of environmental pollution. The redesign of
enterprise’s supply chain, such as relocation of
manufacturing centers and assembling/distribution
centers, reselection of suppliers, is analyzed.
Finally, this study illustrates the manipulation and
application of the constructed models.
Keywords: Supply chain networks, Location
choice, Sustainable environment
二、緣由與目的
2.1 研究背景與重要性
企業的生產及服務活動逐漸走向全球化與
國際化，以尋找更多降低成本與開發市場的機
會，企業間的逐利與生存競爭因跨越空間區隔
而更形劇烈。生產或服務的供應鏈佈局也不再
侷限於單一國家，而向全球擴散，根據經濟學
中的比較利益原則，專業分工的優勢將更形顯
著。為求利潤最大化或成本最小化，企業綜合
考量運輸成本、原物料價格、薪資成本、運輸
31. 以環境永續發展及貨物運輸兩大領域為主
體，廣泛回顧有關；(A)供應鏈網路設計、(B)
供應鏈網路績效評估、(C)永續型貨物運輸系
統、(D)考慮永續發展概念之供應鏈管理之
國內外相關文獻，了解過去學者對於環境永
續發展與供應鏈網路設計之整合研究的趨
勢及成果，作為本研究擬定研究目的、研究
方法與程序的參考。
2. 建構單一跨國企業之傳統供應鏈網路模
式，探討企業以成本最小化為目標時之最適
製造中心、組裝／配送中心的區位，其中，
在目標式方面，考慮原物料／零組件購買成
本、供應鏈網路各層級間的運輸成本、貨物
處理成本、設施設置成本等，而在限制式方
面，則包括流量守恆限制式與決策變數非負
限制式。
3. 考慮環境永續議題，探討未來企業面臨環境
成本時，應如何藉著重新設計供應鏈網路模
式，如改變原物料／零組件供應商、製造中
心區位、組裝／配送中心區位，來降低供應
鏈成本。本研究將環境污染處罰成本引入成
本函數，探討未來實施「碳排放交易（ET）」
機制以達成二氧化碳減量的目標時，不同區
位之碳資產價格不同，企業綜合考量環境影
響成本、設施設置成本、運輸成本、貨物處
理成本、零組件購買成本後，對企業供應鏈
網路設計的影響。
三、結果與討論
3.1 傳統供應鏈網路模式
本研究假設一跨國企業之供應鏈網路如圖
1，原物料／零組件之供應來源包括已知的國內
外廠商，製造中心設置地點包括國內外之替選
地點，而將組裝／配送中心設置於國內，以快
速配送至已知的零售商，滿足國內市場需求。
在傳統供應鏈網路模式構建方面，本研究首先
定義供應鏈網路之相關參數，令 FNS 與 DNS 分
別表示國外與國內原物料／零組件供應商之數
目； FNM 與 DNM 分別表示替選的國外與國內
製造中心之數目；ND表示替選國內組裝／配送
中心之數目；NR 表示零售商之數目。其次，定
義供應商與零售商之相關參數，令 Dis 表示國內
原物料／零組件供應商 i 之供應量； Fis 表示國
外原物料／零組件供應商 i 之供應量； ld 表示零
售商 l 之需求量。
Materials/components
Suppliers
Assembling/Distribution
Centers
RetailersManufacturing
Centers
Domestic
Foreign
Domestic
Foreign










v
圖 1 跨國企業之供應鏈網路設計
有關決策變數定義，包括兩類：(1)運送流
量決策變數；(2)區位選擇決策變數。在運送流
量的決策變數定義方面，本研究令 DDijf 表示從
國內供應商 i 至國內製造中心 j 之運送量； FDijf
表示從國外供應商 i 至國內製造中心 j 之運送
量； DFijf 表示從國內供應商 i 至國外製造中心 j
之運送量； FFijf 表示從國外供應商 i 至國外製造
中心 j 之運送量； DAjkg 表示從國內製造中心 j 至
組裝／配送中心 k 之運送量； FAjkg 表示從國外製
造中心 j 至組裝／配送中心 k 之運送量； ARklh 表
示從組裝／配送中心 k 至零售商 l 之運送量。而
在有關區位選擇之 0-1 決策變數則分別定義如
式(1)(2)(3)。其中，式(1)表示國內製造中心區位
選擇之 0-1 整數決策變數；式(2)表示國外製造
中心區位選擇之 0-1 整數決策變數；式(3)表示
國內組裝／配送中心區位選擇之 0-1 整數決策
變數。



otherwise0
locationdomesticealternativinlocatediscenteringmanufacturif1 j
xDj



otherwise0
locationforeignealternativinlocatediscenteringmanufacturif1 j
xFj



otherwise0
locationdomesticealternativinlocatediscenterion/distributassemblingif1 k
yDk
本研究應用數學規劃方法，構建傳統供應
鏈網路模式，假設單一跨國企業以總成本最小
為目標，所考慮的成本包括：原物料／零組件
購買成本、貨物運輸成本、設施設置成本、貨
5階段所產生之二氧化碳排放率（噸／仟單位）
為已知，令 M 表示在製造中心將原物料／零組
件製成半成品之二氧化碳排放率；令 A表示在
組裝／配送中心將半成品製成完成品之二氧化
碳排放率。故納入環境污染成本之企業總成本
函數推導如式(15)。而在限制式方面，則推導如
式(5)－式(14)。
)(
)()(
11
1111
12
D
k
NR
l
AR
kl
ND
k
AD
k
ND
k
D
k
F
j
FA
jk
NM
j
MF
j
ND
k
D
k
D
j
DA
jk
NM
j
MD
j
yhpa
yxgpmyxgpmTCTC
FD








3.3 結果分析
根據本研究所建構之模式求解程序以及相
關之參數值，求解傳統供應鏈網路模式，所得
結果如圖 1 所示。圖 1 顯示製造中心及組裝／
配送中心之近似最佳區位，以及供應商、製造
中心、組裝／配送中心、零售商間的近似最佳
運送量。圖中最左邊及最右邊括弧內之數字分
別代表已知的供應量及需求量。供應商、製造
中心、組裝／配送中心、零售商圖像旁的數字
代表近似最佳運送量。由圖 3 可知在現在的參
數條件下製造中心應全設置在國內的替選區
位，組裝／配送中心應設置在第 2 及第 4 個替
選區位，以最小化企業的總成本（即目標函
數）。此外，由同一節點（如供應商、製造中心、
組裝／配送中心）出發之運送量應儘量平均分
配至下游之相鄰節點，以最小化企業之總成本。
299.86
299.29
299.26
Materials/components
Suppliers
Assembling/Distribution
Centers Retailers
Manufacturing
Centers
Domestic
Foreign
Domestic
299.88
299.46
299.08





[211]
[207]
[266]
[213]
[236]
[269]
[239]
[264]
[274]
[265]
[70.02
[71.36
[69.36
69.10]
68.75]
69.06]
[77.83
[77.67
[76.29
70.13]
70.57]
72.28]
[76.52
[77.22
[78.61
[76.62
[75.78
[75.64
77.58]
76.74]
76.65]
[76.11
[74.64
[76.64
77.96]
78.72]
75.14]
[77.07
[76.96
[79.11
[121.61
[119.39
123.47]
122.53]
[120.75
[121.25
112.60]
113.40]
[77.37
[77.63
94.53]
93.47]
[111.62
[113.38
92.10]
91.90]
[241]
[246]
[242]
[226]
[155]
[188]
[225]
[184]
圖 1 傳統供應鏈網路模式之似近最佳區位選擇及
運送量
依常理而言，企業將選擇隱含較低環境污
染處罰成本之國外替選區位，以彌補較高的運
輸成本，因此，本研究假設國內替選區位之單
位環境污染成本 Djpm 較國內替選區位之單位環
境污染成本 Fjpm 為高。此外，環境污染處罰成
本（即排放交易成本）機制目前尚未正式實施，
故本研究假設碳資產之交易價格為 60 歐元／
噸，約等於 NT$2.7/kg。根據上述參數值，本研
究求解考慮環境污染處罰成本(排放交易成本)
之供應鏈網路模式，所得結果如圖 4。圖 4 顯示
隨著課徵環境污染處罰成本，製造中心之近似
最佳區位選擇發生變化，原先設置於國內第 2
及第 3 個替選區位之製造中心將移至國外第 2
及第 3 個替選區位，以最小化企業之總成本。
而組裝／配送中心之區位選擇之維持不變，仍
選擇第 2 及第 4 個替選區位。當企業面臨環境
污染之處罰成本壓力時，將透過供應鏈網路的
重新設計以最小化總成本。
由圖 4 本研究發現由同一節點（如供應商、
製造中心、組裝／配送中心）出發之運送量並
非平均分配至下游的接續節點。國內供應商反
而將大部份的運量運送至國外的製造中心；而
國外供應商反而將大部份的運量運送至國內的
製造中心。這種違反直覺的結果可能是由於本
研究所構建模式在於最小化總成本，故將使在
每一連串的供應商、製造中心、組裝／配送中
心、零售商的供應鏈上的成本相等。由於在國
外製造中心內的貨物處理成本、設施建置成本
以及環境污染處罰成本較低，故企業可負擔較
高運輸成本，將國內供應商的原物料／零組件
運送至國外製造中心。相反的，國內製造中心
內的貨物處理成本、設施建置成本以及環境污
染處罰成本較高，故企業以較低價的國外原物
料／零組件彌補較高的運輸成本及較高的製造
成本。
395.43
396.25
251.20
Materials/components
Suppliers
Approximately Optimal
Assembling/Distribution
Centers
RetailersApproximately Optimal
Manufacturing Centers
Domestic
Foreign
Domestic
250.97
251.25
251.73




[211]
[207]
[266]
[213]
[236]
[269]
[239]
[264]
[274]
[265]
[12.98
[126.96
[128.12
3.64]
117.33]
118.03]
[11.47
[126.74
[125.55
14.18]
129.35]
129.78]
[10.39
[127.69
[126.91
[187.79
[0.00
[0.00
186.73]
0.37]
0.00]
[185.34
[0.00
[0.43
189.82]
0.01]
0.76]
[186.64
[0.02
[0.27
[121.11
[119.89
121.66]
124.34]
[121.90
[120.10
112.31]
113.69]
[77.34
[77.66
93.65]
94.35]
[112.43
[112.56
92.33]
91.67]
[241]
[246]
[242]
[226]
[155]
[188]
[225]
[184]
Foreign

圖 2 考慮環境污染處罰成本(排放交易成本)之
供應鏈網路模式之似近最佳區位選擇及運送量
7supply chain,” Transportation Research Part E,
Vol. 43, pp. 321-337.
12. Lai, K.H., Ngai, E.W.T. and Cheng, T.C.E.
(2002), “Measures for evaluating supply chain
performance in transport logistics,”
Transportation Research Part E, Vol. 38, pp.
439-456.
13. Lai, K.H. (2004), “Service capability and
performance of logistics service providers,”
Transportation Research Part E, Vol. 40, pp.
385-399.
14. Linton, J.D., Klassen, R. and Jayaraman, V.
(2007), “Sustainable supply chains: An 
introduction,” Journal of Operations
Management, Vol. 25, pp. 1075-1082.
15.Matos, S. and Hal, J. (2007), “Integrating 
sustainable development in the supply chain:
The case of life cycle assessment in oil and gas
and agricultural biotechnology,” Journal of
Operations Management, Vol. 25, pp.
1083-1102.
16. Meixell, M.J. and Gargeya, V.B. (2005),
“Global supply chain design: A literature 
review and critique,” Transportation Research
Part E, Vol. 41, pp. 531-550.
17. Meng, Q., Huang, Y.K. and Cheu, R.L. (2007),
“A note on supply chain network equilibrium
models,” Transportation Research Part E, Vol.
43, pp. 60-71.
18.Min, H. and Melachrinoudis, E. (1999), “The 
relocation of a hybrid
manufacturing/distribution facility from
supply chain perspectives: a case study,” 
Omega, International Journal of Management
Science, Vol. 27, pp. 75-85.
19.Nagurney, A., Dong, J., Zhang, D. (2002), “A 
supply chain network equilibrium model,” 
Transportation Research Part E, Vol. 38, pp.
281-303.
20.Nijkamp, P. (1994), “Roads toward 
environmentaly sustainable transport,” 
Transportation Research, Vol. 28A, No. 4, pp.
261-271.
21. Nijkamp, P., Reggiani, A. and Bolis, S. (1997),
“European freight transport and the 
environment: empirical applications and
scenarios,” Transportation Research, Vol. 2D,
No. 4, pp. 233-244.
22. Petrovic, D. (2001), “Simulation of supply 
chain behavior and performance in an
uncertain environment,” International Journal
of Production Economics, Vol. 71, pp.
429-438.
23. Quak, H.J. and de Koster, M.B.M. (2007),
“Exploring retailers’ sensitivity to local 
sustainability policies,” Journal of Operations
Management, Vol. 25, pp. 1103-1122.
24.Richardson, B.C. (2005), “Sustainable 
transport: analysis frameworks,” Journal of
Transport Geography, Vol. 13, No. 1,
pp.29-39.
25.Roth, A. and Kåberger, T. (2002), “Making 
transport systems sustainable,” Journal of
Cleaner Production, Vol. 10, pp. 361-371.
26. Shang, K.C. and Marlow, P.B. (2005),
“Logistics cpaptility and performance in
Taiwan’s major manufacturing firms,”
Transportation Research Part E, Vol. 41, pp.
217-234.
27. Sheu, J.B. (2003), “Locating manufacturing
and distribution centers: An integrated supply
chain-based spatial interaction approach,”
Transportation Research Part E, Vol. 39, pp.
381-397.
28. Taniguchi, E., Noritake, T., Yamada, T. and
Izumitani, T. (1999), “Optimal size and 
location planning of public logistics
terminals,” Transportation Research Part E,
Vol. 35, No. 3, pp. 207-222.
29. Tsoulfas, G. T. and Pappis, C.P. (2006),
“Environmental principles applicable to 
supply chains design and operation,” Journal
of Cleaner Production, Vol. 14, pp.
1593-1602.
30. Van Woensel, T., Creten, R. and Vandaele, N.
(2001), “Managing the environmental 
externalities of traffic logistics: the issue of
emissions,” Production and Operations
Management, Vol. 10, No. 2, pp. 207-223.
31.Wilson, M.C. (2007), “The impact of 
transportation disruptions on supply chain
performance,” Transportation Research Part E,
Vol. 43, pp. 295-320.
Vehicle Route Planning for Mixed Pickup and Delivery Operations with Time
Window Constraints
Shwu-Ping Guoa* and Fu-Hao Yangb
a Department of Logistics and Marketing Management, Leader University,
No. 188, Sec. 5, An-Chung Rd., Tainan 709, Taiwan, R.O.C.
b Institute of Applied Information, Leader University,
No. 188, Sec. 5, An-Chung Rd., Tainan 709, Taiwan, R.O.C.
*Corresponding Author: spguo@mail.leader.edu.tw
ABSTRACT
This study presents a model for a mixed pick-up and delivery vehicle routing problem with
time windows by adopting mathematical programming method. A solving procedure to search
the initial solution by utilizing the nearest neighbor algorithm is proposed. Heuristic algorithms
such as 2-opt exchange method and 1-1 interchange method are utilized to improve the initial
solution. Furthermore, in the improving procedure, this study applies the simulated annealing
method to avoid local optimal solutions. Finally, the problem-solving program is written in
Microsoft Visual Studio .NET. The program results are the optimal vehicle routes, minimum
total distribution costs, visiting sequence and arrival times at each node.
Keywords: Time window, pickup and delivery, vehicle route, simulated annealing method.
1. Introduction
The logistics industry continuously evolves with economic growth. The cost of picking up and
delivering freight is significant in the total cost of a logistics company. Many studies have
investigated the Vehicle Routing Problem (VRP) to decrease the total logistics cost. Decreasing
the logistics cost largely depends on the ability to distribute freight via right routes using
appropriate vehicles in due time. Planning of vehicle routes is traditionally performed according
to the rule of thumb. Determining the optimal vehicle routes and decreasing the total costs
within a short time is a difficult task. Consumers generally request accurate service intervals.
The time interval of concern by customers is shortening from daily to hourly. Furthermore,
time-reliability is also an important measurement of supply-chain evaluation. Thus, Vehicle
Routing Problem incorporated with time window constraints (VRPTW) better coincides with
requirements of logistics management, and has attracted significant attention in recent decades.
Given the above circumstances, some studies incorporate time window constraints to examine
vehicle routings for single or multiple depots, e.g., Solomon and Desrosiers (1988), Tan, Lee
and Ou (2001), Wang and Regan (2002), Braysy, Hasle and Dullaert (2004) and Homberger and
Gehring (2005). Conversely, distribution management with mixed pickup and delivery
operations is very common for complying with the requirement for on-time delivery, and for
demand node i when vehicle k arrives early or late; ef and lf represent penalty costs per unit
early time and per unit delay time, respectively, and t denotes the time interval beyond which
early arrival and delay are penalized.
With respect to constraints, this study first addresses constraints of vehicle capacity and flow
conservation. The relevant parameters are defined as follows: ijkU indicates the load of vehicle
k arrived at demand node j from demand node i; ip and id indicate the pickup and delivery
volumes at demand node i, respectively, and Q represents the vehicle capacity. Time window
constraints are also incorporated: ijT denotes the travel time from demand node i to demand
node j; ia denotes a vehicle’s arrival time at demand node i; is indicates freight handling time
at demand node i; ie and il respectively indicate the earliest and latest service times at
demand node i, and oskT and oekT respectively represent departing time and returning time of
vehicle k to the depot.
Finally, binary variable ijkx is defined as the decision variable, and its definition is expressed
as in Eq. (1).




Otherwise0
nodedemandvianodedemandarrivesvehicleif1 ijk
xijk (1)
Consequently, the mixed pickup and delivery vehicle routes model with time window
constraints is constructed as Eqs. (2)-(13).

  

K
k
N
i
N
j
iijkij FDxCZ
1 1 1
)(Min (2)
s . t 
 

K
k
N
i
ijk Njx
1 1
1 (3)
 
   

K
k
N
i
K
k
N
i
jikijk Njxx
1 1 1 1
0 (4)



N
j
jjijkijk KkIiQpdxU
1
,)(0 ( 5 )
 
 







I
j
N
i
ijkj KkQxp
1 1
0 (6)
KkIjiVxTsaa ijkijiij  ,,)1( max ( 7 )
KkIiVxTTa oikoioski  ,)1( max (8 )
Iilae iii  (9 )
KkIiVxTsaT iokioiioek  ,)1( max ( 10 )
KkTe osko  (11 )
KklT ooek  (12)
combinatorial optimum problems, and addresses variations in system configuration. For
minimization problems, when the objective value of the new system configuration is less than
that of the old one, the variation in system configuration is accepted, and the probability of
acceptance is 1. Otherwise, the probability of accepting new system configuration equals
exp{(old objective value –new objective value) / temperature}. The temperature is a control
parameter. Figure 1 illustrates a flowchart of the problem solving procedure. This study assumes
that the frequency of temperature decrease is 100 times of node/link exchanges. The simulated
annealing procedure is terminated when the temperature declines to 1, or all the possible
exchanges are reached.
Start
Obtaining an initial feasible
solution
Setting initial temperature T
and cooling ratio α
Generate new feasible
solution by 2-opt or 1-1
exchange method
Let ΔE=
(Old objective value -
New objective value)
ΔE > 0 Yes
Replace present
solution with new
feasible solution
No
Generate a random number
U~(0,1). If U<exp(ΔE/T),
then replace present solution
with new feasible solution.
Decrease
temperature T Yes Calculate T = T * α
No
Reach the terminal
condition
Yes
Stop
No
Figure 1 Flowchart of problem-solving procedure.
4. Numerical Examples
4.1 Program description
The problem-solving program is written in Microsoft Visual Studio .NET according to the
procedure in Fig. 1. Diagrams for parameter setup and problem solving are constructed. The
time window is measured in minutes. Figure 2 depicts the diagram for parameter setup. Figure 3
illustrates the problem-solving diagram. Functions of the program are expressed as follows. Part
‘’depicts node locations and vehicle routes, where solid lines denote routes of morning group,
Figure 3 Diagram for setting solving procedure
4.2 Examples of testing the problem-solving procedure
Six examples were randomly generated to testing the model and program-solving procedure.
The study area was assumed to be a 200×200km2 rectangular area. Pickup and delivery volumes
were assumed to be random numbers in the ranges [0,10] and [1,20], respectively. The service
time of vehicle fleets were from 9 A.M to 5 P.M. Table 1 presents the basic parameters of the
mixed pickup and delivery vehicle routes model with time window constraints. Table 2 presents
the six randomly generated numerical examples with different node number, and their SA
system parameters such as cooling ratio and initial and terminal temperatures.
Table 1 Values for basic parameters
Vehicle
capacity
Cost per unit
distance(NT$)
Average
velocity(km/hr)
Time interval to
penalize(min)
Penalty for early
arrival(NT$)
Penalty for late
arrival(NT$)
100 10 30 30 10 20
Table 2 Parameter for SA system in six numerical examples
File name Number ofnodes
Cooling
ratio
Initial
temperature
Terminal
temperature
map 30-1 30 0.950 8000 1
map 50-1 50 0.965 9000 1
map 75-1 75 0.970 9500 1
map 100-1 100 0.975 10000 1
map 150-1 150 0.985 10000 1
map 200-1 200 0.990 10000 1
4.3 Results of numerical examples
Table 3 summarizes the results of the six numerical examples, including objective value of
Figure 4 Approximately optimal solution for numerical example with 30 nodes (map30-1)
Table 5 Approximately optimal vehicle routes for numerical example with 30 nodes
Vehicle routes and vehicle loads of morning group
Route 1 D(93), 20(88), 21(77), 9(67), 22(61), 10(58), 5(63), 14(62), 27(58), 26(47), D
Route 2 D(73), 8(70), 7(58), 19(62), 4(54), 29(44), 30(29), 23(31), D
Vehicle routes and vehicle loads of afternoon group
Route 1 D(98), 2(87), 18(78), 24(68), 25(67), 11(68), 13(70), 6(63), 28(48), D
Route 2 D(53), 15(56), 16(52), 12(42), 1(47), 3(37), 17(26), D
Total cost of objective function = 57240(NT$)
Number of vehicle routes = 4
Figure 5 illustrates the map of approximately optimal routes for numerical example with 50
demand nodes. The initial temperature and cooling ratio for SA system were 9000 and 0.965,
respectively. The approximately optimal solution was obtained in the 37562nd iteration. The
approximately optimal total cost of objective function was NT$58020, where the distance cost
and penalty cost were NT$24660 and NT$33360, respectively. Improving ratios between initial
feasible solution and approximately optimal solution for total cost, distance cost and penalty
cost were 9.70%, 7.09% and 11.63%, respectively. Table 6 presents the sequence of demand
nodes for each approximately optimal vehicle route in morning group and afternoon group,
respectively, for numerical example-map50-1.
Figure 6 Approximately optimal solution for numerical example with 75 nodes (map75-1)
Table 7 Approximately optimal vehicle routes for numerical example with 75 nodes
Vehicle routes and vehicle loads of morning group
Route 1 D(87), 57(86), 34(81), 71(75), 48(70), 60(59), 23(56), 21(52), 56(54), 68(54), 74(48),D
Route 2 D(99), 20(94), 2(82), 65(76), 41(67), 26(62), 12(66), 69(60), 75(63), 66(58), 36(45),6(46), D
Route 3 D(92), 46(100), 52(84), 59(83), 5(86), 28(72), 7(63), 54(52), 58(46), 32(49), D
Route 4 D(52), 8(48), 3(42), 37(43), 27(35), 50(34), D
Vehicle routes and vehicle loads of afternoon group
Route 1 D(90), 51(85), 62(89), 38(77), 61(76), 73(75), 39(67), 22(67), 67(58), 24(47), D
Route 2 D(95), 47(91), 16(77), 43(64), 70(51), 31(46), 72(54), 1(47), 40(37), 11(26), D
Route 3 D(86), 55(81), 19(66), 14(62), 17(50), 25(41), 9(26), D
Route 4 D(96), 13(93), 15(87), 49(83), 64(77), 63(77), 29(82), 4(73), 53(77), 44(71), 18(72),42(75), 35(77), 10(76), D
Route 5 D(37), 30(37), 45(24), 33(17), D
Total cost of objective function = 118880(NT$)
Number of vehicle routes = 9
Figure 7 illustrates the map of approximately optimal routes for the numerical example with 100
demand nodes. Due to the large number of demand nodes, the initial temperature raised to
10000 with a cooling ratio of 0.975 so as to reduce the convergent speed of the SA system, and
thereby find a better solution. The approximately optimal solution was found in the 264001st
iteration. The approximately optimal total cost of objective function was NT$130920, where the
distance cost and penalty cost were NT$34460 and NT$96460, respectively. The improving
ratios between the initial feasible solution and approximately optimal solution for total cost,
distance cost and penalty cost were 8.08%, 3.89% and 9.58%, respectively. Table 8 presents the
sequence of demand nodes for each approximately optimal vehicle route in morning group and
afternoon group, respectively, for numerical example-map100-1.
Figure 8 Approximately optimal solution for numerical example with 150 nodes (map150-1)
Figure 8 illustrates the map of approximately optimal routes for the numerical example with 150
demand nodes. The initial temperature and cooling ratio for SA system were 10000 and 0.985,
respectively. The approximately optimal solution was found in the 637309th iteration. The
approximately optimal total cost of objective function was NT$117120 where the distance cost
and penalty cost were NT$48030 and NT$69090, respectively. The improvement ratios between
the initial feasible solution and approximately optimal solution for total cost, distance cost and
penalty cost were 6.94%, 8.84% and 5.61%, respectively. Table 9 presents the sequence of
demand nodes for each approximately optimal vehicle route in the morning and afternoon
groups, respectively, for numerical example-map150-1.
Table 9 Approximately optimal vehicle routes for numerical example with 150 nodes
Vehicle routes and vehicle loads of morning group
Route 1 D(97), 71(96), 9(100), 23(99), 63(95), 2(91), 44(72), 128(69), 126(69), 47(72),37(62), 20(49), D
Route 2 D(84), 150(88), 64(79), 115(74), 102(66), 111(60), 67(50), 33(34), D
Route 3 D(86), 61(86), 146(87), 122(78), 68(80), 70(78), 105(81), 19(85), 58(76), 104(68),109(63), 60(61), D
Route 4 D(97), 149(85), 24(79), 83(76), 17(69), 139(70), 143(62), 113(52), 53(46), 138(31),D
Route 5 D(86), 125(82), 118(83), 46(83), 48(79), 31(80), 98(73), 38(71), 35(63), 108(51),4(48), D
Route 6 D(96), 49(77), 87(62), 51(57), 129(56), 75(37), 40(35), 90(23), D
Route 7 D(82), 123(75), 92(72), 78(70), 117(58), 21(50), 56(44), 110(41), 82(30), D
Route 8 D(29), 120(24), 14(7), D
Vehicle routes and vehicle loads of afternoon group
Route 1 D(99), 127(98), 91(99), 148(93), 27(87), 81(88), 124(80), 25(73), 22(66), 112(55),116(57), 5(50), D
Route 2 D(99), 10(98), 55(95), 54(91), 8(76), 39(68), 43(62), 76(52), 28(49), 79(49), 136(49),
Table 10 Approximately optimal vehicle routes for numerical example with 200 nodes
Vehicle routes and vehicle loads of morning group
Route 1 D(97), 92(92), 64(89), 152(75), 180(76), 183(83), 136(75), 104(69), 59(59), 93(47),D
Route 2 D(97), 46(89), 70(92), 116(85), 63(66), 55(64), 141(64), 54(57), 178(49), 94(52),83(51), D
Route 3 D(95), 78(77), 138(62), 103(54), 86(45), 81(41), 108(46), 129(36), D
Route 4 D(92), 181(87), 62(86), 88(69), 13(53), 30(45), 168(36), 49(24), 42(30), 68(26), D
Route 5 D(83), 197(74), 150(73), 154(71), 75(63), 67(64), 65(63), 106(53), 145(37), D
Route 6 D(89), 22(84), 39(85), 146(82), 36(85), 170(74), 117(65), 107(64), 33(61), 143(44),D
Route 7 D(96), 85(89), 137(73), 19(81), 44(71), 194(74), 84(65), 69(66), 125(64), 131(60), D
Route 8 D(93), 163(89), 38(76), 165(75), 20(76), 124(76), 31(69), 47(68), 172(55), 132(49),135(46), 153(35), D
Route 9 D(91), 151(79), 175(68), 190(73), 101(73), 8(64), 100(53), 169(36), D
Route 10 D(92), 48(76), 35(71), 156(72), 89(62), 176(57), 99(46), 179(41), 12(30), D
Route 11 D(97), 157(85), 200(76), 5(69), 162(58), 160(60), 193(49), 147(44), 118(44), D
Route 12 D(86), 23(78), 26(74), 140(76), 185(70), 174(69), 195(61), 198(63), 182(56),155(52), 45(54), D
Route 13 D(66), 139(63), 102(56), 9(45), 199(48), 187(43), 121(35), D
Vehicle routes and vehicle loads of afternoon group
Route 1 D(99), 98(100), 41(90), 110(86), 72(92), 15(88), 109(79), 112(75), 119(68), 122(66),73(69), 56(62), D
Route 2 D(91), 127(90), 159(76), 76(68), 60(75), 17(70), 188(54), 171(44), 7(41), D
Route 3 D(99), 128(88), 184(79), 77(65), 97(70), 14(57), 61(56), 126(56), 133(59), 115(51),192(43), 87(36), D
Route 4 D(85), 40(79), 3(67), 53(57), 148(53), 80(41), 58(38), 114(38), 29(27), D
Route 5 D(87), 113(77), 130(78), 191(62), 32(65), 173(58), 123(54), 196(45), D
Route 6 D(98), 120(97), 74(91), 189(92), 186(83), 164(72), 25(72), 95(56), 134(54), 161(44),D
Route 7 D(93), 57(91), 21(79), 149(71), 50(60), 18(55), 90(47), 1(45), 4(44), 144(47), D
Route 8 D(85), 28(91), 2(90), 158(81), 6(62), 105(64), 34(62), 167(65), 66(69), 51(57),10(50), D
Route 9 D(98), 82(94), 91(88), 142(84), 71(80), 52(72), 43(61), 11(59), 166(52), 24(52), D
Route 10 D(75), 111(62), 27(52), 177(48), 79(45), 16(43), 96(42), 37(35), D
Total cost of objective function = 142220(NT$)
Number of vehicle routes = 23
5. Conclusions and Suggestions
This study explores the planning of vehicle routes with mixed pickup and delivery operations
under the constraints of time windows. To adhere to the time window of each demand node, and
to minimize the total distribution cost, the proposed model incorporates travel distance cost and
penalty cost. The model was tested with several numerical examples. Analytical results
demonstrate not only the sequence of visited demand nodes, but also the loading and arrived
time at each demand node, for each vehicle route. These results can help distribution companies
to design their vehicle routes, particularly when fuel and gasoline costs are steeply.
This study adopts 2-opt exchange method and 1-1 interchange method to improve the initial
