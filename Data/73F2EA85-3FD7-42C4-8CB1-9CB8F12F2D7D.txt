 行政院國家科學委員會補助專題研究計畫 ■ 成 果 報 告   □期中進度報告 
 
多種類型影像隱藏技術(I) 
 
計畫類別：■ 個別型計畫  □ 整合型計畫 
計畫編號：NSC  96-2218-E-126-001- 
執行期間： 96  年 8 月 1 日至 97  年 7 月 30 日 
 
計畫主持人：莊潤洲 
 
計畫參與人員：碩士班研究生-兼任助理人員：廖俊盛 
 
 
成果報告類型(依經費核定清單規定繳交)：■精簡報告  □完整報告 
 
本成果報告包括以下應繳交之附件： 
□赴國外出差或研習心得報告一份 
□赴大陸地區出差或研習心得報告一份 
□出席國際學術會議心得報告及發表之論文各一份 
□國際合作研究計畫國外研究報告書一份 
 
 
處理方式：除產學合作研究計畫、提升產業技術及人才培育研究計畫
列管計畫及下列情形者外，得立即公開查詢 
         □涉及專利或其他智慧財產權，□一年□二年後可公開查詢 
          
執行單位：靜宜大學資訊傳播工程學系 
 
中   華   民   國  97  年  10  月   12   日 
 
 
DCT 區塊之係數內。為了避免藏入後對影像品質影
響，在選擇 DCT 係數上都僅可能選取較不重要的係
數，例如中頻係數及中低頻係數，為了安全性及強韌
性考量一般中高頻及高頻係數都不太考慮。第二種方
式採用間接藏入法，藉由參考兩個區塊或是兩個係
數，比較彼此的大小關係，藉此來藏入資訊。在壓縮
域影像隱藏技術都是在壓縮的過程一併將秘密訊息
藏入，以及在解壓縮的過程中將秘密資訊取出。以目
前在網路上最常見的壓縮圖檔如 JPEG、GIF、TIFF、…
等等，如果將秘密位元藏入這些一般平常的圖片中，
將可有效降低被駭客懷疑、破壞及干擾。 
在本研究中提出一種空間域的資訊隱藏技術，本
方法將透過像素分群概念來達成資訊隱藏技術。將灰
階像素依照相似性予以分成數組群組，依據藏入的秘
密數值來對應每一個群組的代號，以該群組中最相近
的灰階值替換即可完成資訊的隱藏，為了避免每次重
複選取相同群組，加入隨機亂數的功能將每一次藏入
的群組編號從新排列以降低被偵測的可能。我們這個
技術的好處在於能提供較好的偽裝影像品質和高潛
藏載量，此外本方法並非固定修改每一像素值最不重
要位元，也因此本方法可以有效降低被偵測的安全性
問題。本篇研究可分成以下幾個部份，第二部份介紹
和本研究有相關的技術，第三部份說明所提出的方
法，第四部份是實驗部份，第五部份是討論和為結論。 
 
 
2. 相關文獻介紹 
 
2.1 Thien 和 Lin 影像隱藏技術 
 
在 2003 年 Thien 和 Lin [13] 提出一個在空間域
下植基於模數運算之影像隱藏技術。假設給於一個模
數為p，將偽裝像素的數值 x 透過模數運算後(b=x mod 
p)，餘數 b 會介於 0 到(p-1)之間，如果餘數恰好是
要藏入的秘密數值則完成藏入動作，反之則需要調整
偽裝像素值 x 使其數值經由模運算後，餘數恰好是要
藏入的秘密數值。為了讓更動後的新值 x’和原始偽裝
數值 x不要有太多的誤差，更動後的新值必須要找最
接近的數值 x’，使得 min(|x- x’|)的誤差為最小。 
假設偽裝像素值為99，模數值p=4，機密資訊(10)2 
=2，經由模數運算後(99 mod 4)=3 後得到餘數 3，餘
數 3 和所要藏入的機密數值 2 不同，藉由調整原始像
素值 99 為 102 或是 98 都可以經由模運算後餘數為
2，由於更動後的數值 98 和像素值 99 誤差最小較為
接近，因此採用 98 作為新的像素值，而此時機密資
訊 2 也同時藏入。值得注意是，偽裝像素值調整需和
原始像素值之間的誤差要最小才可。所藏入的數值是
直接更動到整體偽裝像素值而非只有單一更動某幾
個最不重要位元，所以這個方法是比較不易被偵測出
有秘密位元藏入。 
 
 
2.2 偽裝影像的 X2資訊偵測技術 
 
在 2000年時Westfeld和 Pfitzmann提出一種空間
域底下偽裝影像的偵測技術[15]，這個方法是針對空
間域下的不重要位元潛藏資訊來探測，它分別以兩種
不同偵測方法來進行，如以下兩種方法：視覺攻擊法
(Visual attack, Enhance LSBs)，以及統計攻擊法也稱為
卡方攻擊法(Statistical attack, Chi-square analysis)來進
行。 
視覺攻擊法部分，將偽裝影像素用來潛藏不重要
的位元抽離出來，並依相關位置建立二值化影像，以
供人眼目測來進行判斷是否有機密資訊藏入其中，當
攻擊後的影像呈現出垂直線條時表示影像內是有藏
入資訊。如圖 1(a)原始 Lena 影像經由視覺攻擊後無
任何明顯垂直線條，而圖 1(b)藏入固定兩個位元的
LSBs 偵測的結果，可以發縣有出現明顯垂直線條。 
 
(a) 原始影像偵測結果 (b) 2-Bits LSBs 偵測結果
圖 1 Visual attack 範例圖 
卡方攻擊法是一種專門用於偵測最不重要位元
之資訊隱藏技術，這種方法會去分析偽裝圖中「配對
數值」(Pair of Values, PoVs)的個數，當兩相鄰像素之
最不重要位元互為相異時表示一組PoVs，例如: 127 
(01111111) 與 126 (01111110) 就是一組 PoVs。當藏
入的秘密資料 0 和 1 的個數相同，嵌入資訊的偽裝影
像PoVs組別內也會出現相等的平均個數，這也就是為
什麼Chi-Square 攻擊法可以去檢驗出是否有藏入資
料，只要分析出有這樣的特性,代表有資料藏入。卡方
攻擊法是採取影像中隨機抽取的樣本PoVs組別，然後
經相關統計分析後，最後偵測結果會出現下列三種情
況。我們以下圖 2-4，用一個簡單圖解例子說明三種
狀況，在三張圖片中水平軸部分都表示有 10 個樣本
的PoVs組別當判別基準，垂直軸中用 0-1 來表示該
PoVs組別資訊潛藏的可能機率性。如下圖 3判別結果
以紅色的曲線趨近於 0將表示沒有資訊的潛藏。反之
如下圖4判別結果紅色曲線趨近於1表示含有資訊的
潛藏且在影像中有 50%的資訊潛藏。或是圖 5 判別結
果紅色曲線呈現上下波動不規則情況下，也表示影像
含有資訊潛藏的可能性。 
 
0
0.2
0.4
0.6
0.8
1
1 2 3 4 5 6 7 8 9 10
嵌入資訊的10個隨機PoVs樣本
嵌
入
資
訊
的
機
率
 
圖 2偵測分析沒有嵌入資訊-紅色曲線分佈範例 
0
0.5
1
1.5
1 2 3 4 5 6 7 8 9 10
嵌入資訊的10個隨機PoVs樣本
嵌
入
資
訊
的
機
率
 
圖 3偵測分析出前 50%潛藏資訊-紅色曲線分佈範例 
出這兩組實驗數據來比較。 
表 1 藏完後的影像品質 (k=1,共藏入 262,144 位元) 
我們的方法 
傳統
LSB 
模數
LSB 
無採用
隨機 
亂數 
有採用
隨機 
亂數 
影像 
PSNR 
(dB) 
PSNR 
(dB) 
PSNR 
(dB) 
PSNR 
(dB) 
Lena 51.138 51.138 51.138 51.131
Pepper 51.138 51.138 51.138 51.151
Baboon 51.145 51.145 51.145 51.142
Airplane 51.144 51.144 51.144 51.139
Boat 51.128 51.128 51.128 51.125
Average 51.138 51.138 51.138 51.141
 
 
表 2 藏完後的影像品質 (k=2,共藏入 524,288 位元) 
我們的方法 
傳統
LSB 
模數
LSB 
無採用
隨機 
亂數 
有採用
隨機 
亂數 
影像 
PSNR 
(dB) 
PSNR 
(dB) 
PSNR 
(dB) 
PSNR 
(dB) 
Lena 44.157 46.373 46.373 45.082
Pepper 44.155 46.369 46.370 45.060
Baboon 44.151 46.361 46.361 45.051
Airplane 44.154 46.375 46.375 45.147
Boat 44.122 46.362 46.362 44.883
Average 44.1478 46.368 46.3682 45.044
 
表 3 藏完後的影像品質 (k=3,共藏入 786,432 位元) 
我們的方法 
傳統
LSB 
模數
LSB 
無採用
隨機 
亂數 
有採用
隨機 
亂數 
影像 
PSNR 
(dB) 
PSNR 
(dB) 
PSNR 
(dB) 
PSNR 
(dB) 
Lena 37.160 40.725 40.725 39.307
Pepper 37.170 40.738 40.742 39.258
Baboon 37.157 40.718 40.718 39.266
Airplane 37.210 40.698 40.698 39.814
Boat 37.155 40.729 40.729 39.141
Average 37.1704 40.721 40.722 39.357
 
表 4 藏完後的影像品質  (k=4,共藏入 1,048,576 位元) 
我們的方法 
傳統
LSB 
模數
LSB 
無採用
隨機 
亂數 
有採用
隨機 
亂數 
影像 
PSNR 
(dB) 
PSNR 
(dB) 
PSNR 
(dB) 
PSNR 
(dB) 
Lena 30.920 34.806 34.806 33.653
Pepper 30.922 34.765 34.793 33.311
Baboon 30.949 34.811 34.811 33.300
Airplane 30.920 34.827 34.827 34.071
Boat 30.865 34.831 34.831 32.705
Average 30.915 34.808 34.813 33.408
 
從表 1-4 得知在相同資訊藏入容量之下，本方法
採用隨機亂數的 PSNR 值比無採用隨機亂數方法較
低，原因是有採用隨機亂數法重新對群組編號，選取
到不適當群組的可能性就大大增加。當 k 的數值越
大，我們的方法在影像品質 PSNR 數值相對於傳統
LSB 就會比較好，原因在於傳統 LSB 可能會遇到藏
完後的誤差是很大但卻無法作修正動作，而我們的方
法會採用隨機亂數選取群組，因此有可能有機會修正
到比較小的誤差結。此外，相較於在空間域下非常不
錯模運算資料隱藏技術，本方法的 PSNR 值幾乎快要
和模運算隱藏技術所得到的結果相當接近，本方法也
提供另一種資料隱藏的思考方向。 
在圖 7-10 我們列出各個方法在藏完資料後的視
覺影像品質，圖 7-8 每一個偽裝像素固定藏入 3 個位
元，而圖 9-10 每一個偽裝像素固定藏入 4 個位元。
傳統 LSB 編碼藏入較多位元後會產生出一些不協調
的人工效應，尤其是在平滑的區域如肩膀和臉部，但
是模數 LSB 和本方法既使藏入較多秘密位元還可以
保持一定的視覺影像品質。 
 
(a) 傳統 LSB 
37.16 dB 
(b) 模數 LSB 
40.725 dB 
(c) 無採用隨機亂數
40.725 dB 
(d) 採用隨機亂數 
39.307 dB 
圖 7 藏完後的偽裝影像 Lena  (k=3) 
 
(a) 傳統 LSB  
    37.170 dB 
(b) 模數 LSB 
    40.738 dB 
