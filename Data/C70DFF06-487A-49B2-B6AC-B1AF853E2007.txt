研究目的 
 本計畫之目的即是改善目前許多數位出版社所發表的電子書中其功能不足之處，特別是如何符合
上述各項功能之考量外，並能提供迅速正確及智慧型的查詢機制。就以遠流出版社所研發的 KOOBE 
電子書平台為例，針對出版電子書應注重的各種考量因素中，遠流出版社的行銷策略及研發方向皆已
經達到目標並可以落實出版電子書的產品，事實上，遠流出版社已有多本電子書籍已榮獲獎項及殊榮，
成果斐然實令人敬佩，該產品目前唯一的弱項正是無法迅速正確的標示內文的位置造成文章內容查詢
不易，主要是因為電子書的檔案是使用向量圖形檔案格式所造成的影響，若能根據該弱點導入智慧型
之檢索機制，強化內文影像查詢之功能，將能有機會領導國內電子書市場的發展趨勢，全面推廣國內
讀書之風氣，進一步達到提升國內教育文化及知識台灣的目標。 
 
研究成果 
智慧型文件影像自動分析 
因合作廠商以 Adobe Flash 技術來建構電子書內容，故本計畫之文件影像分析技術皆以 Flash 為
主。 
 
1. 分析圖型及文字影像自動切割 
Flash 檔案(SWF)是一種以標籤(Tag)為基礎的檔案格式(如圖 1)，所以擁有高度可擴充性及向下相
容的特點，欲從 SWF 檔案切割出文字及圖型區塊，頇先閱讀 SWF 檔案規格書以了解檔案詳細規格及
各個標籤所代表的意義，再根據實際目標撰寫程式取出檔案中所需的標籤資料，本計畫的程式是依據
最新第 10 版的 SWF 檔案規格所開發完成，經由判斷標籤類型自動切割出文字及圖型區塊資料供後續
分析處理。 
 
圖 1 SWF 檔案結構 
 
2. 註解文字內容及文件影像之相對座標 
SWF 檔案支援兩種文字格式 glyph 和 device，glyph 是一種向量文字透過標準的 EM square 座標系
定義文字的形狀，EM square 是一種想像的矩形用來定義文字大小和排列 glyph 文字，包含了字型的
ascent 和 descent 部分及額外的留白空間。若能知道每個字的編碼及邊界矩形的位置及大小，便能提
供搜尋和註解文字的功能，DefineFont2 標籤定義了所需的文字編碼，每個字的邊界矩形則定義在
DefineText2 標籤中，針對這些標籤，我們開發了一範例程式能載入合作廠商提供的電子書原始檔案，
且能搜尋文字、計算該文字的邊界矩形，圖 2 是範例程式的擷取畫面，圖中透明的黃色區塊註記了搜
尋到的文字。 
標頭
Header
檔案屬性標籤
File 
Attributes Tag
標籤
Tag
標籤
Tag
標籤
Tag
結束標籤
End Tag
…
  
圖 3：本智慧型輸入檢索機制系統流程圖。 
 N-gram 自動切割 
本系統之設計目標，乃是進行中文文章之自動關鍵字擷取。但是，中文的文字系統中，卻缺乏如
英文或歐美語系中以空白鍵作為斷詞符號的機制，這也造成了自然語言處理所面對的中文自動斷詞問
題。常見的一種作法，是透過 N-gram 切割，將文字切割為 N 個長度的子字串。下面的範例為將一句
話分別透過 Bigram 與 Trigram 切割的結果： 
 
 
 
範例：中文文章的自動關鍵字擷取 
Bigram: 
中文  文文  文章  章的  的自  自動  動關  關鍵  鍵字  字擷  擷取 
Trigram: 
中文文  文文章  文章的  章的自  的自動  自動關  動關鍵  關鍵字  鍵字擷  字擷取 
Intelligent Typo detection  Automatic Keyword Extraction 
Document Structure 
Weighting (optional) 
N-gram Segmentation 
POS /Symbol 
filtering 
Substring Recovering 
Black / White List  
Filtering (optional) 
 
 
 
Documents 
Keyword 
Database 
Keystroke Transformation 
Keystroke 
Table 
Exhaustive Heteronym / 
Mispronunciation List 
 
Exhaustive Heteronym / 
Mispronunciation List 
Keystroke Transformation 
Exact Keyword Search 
Comparison 
Web Dropbox Suggestion 
User Query 
POS Table 
Statistic Scoring 
 (optional) 
 
Count Sorting 
Corpus 
Statistic 
Thresholding 
援自定義之黑名單功能，被列在黑名單中的詞將不會被選為關鍵字。另一方面，或是針對某些特別重
要出現，但出現頻率卻不高的的名詞，例如人名或地名，則可以透過自定義之白名單，若是該文章中
有出現過至少一次，則強制列為關鍵字。目前本系統並無任何預設之黑白名單。 
 
 門檻值過濾 
在經過上述步驟後，即可對每篇文章自動產生出排序過之關鍵字列表。系統將依照管理者設定，
針對不同長度的關鍵字，分別自動選出前幾名出現頻率最高的單詞。其中，出現單詞的頻率必頇在兩
次以上，若是出現兩次以上的單詞無法達到管理原設定的需求，則該長度的關鍵字從缺。 
 
透過上述的方法，我們可以針對每篇文章的關鍵字進行自動擷取，並建立一份記錄每篇文章關鍵
字的資料庫。以供智慧型輸入錯誤偵測模組使用。 
 
智慧型輸入錯誤偵測模組 
 鍵盤輸入特徵轉換 
當使用者欲搜尋某個關鍵詞時，必頇透過特定之輸入法，以鍵盤或其他任何周邊設備，將文字輸
入至電腦。因中文字字元數目比起英文字要多出許多，故透過鍵盤輸入中文時，大部分的輸入法皆需
進行選字，或是透過多次輸入才能輸入單一文字。而在透過鍵盤輸入文字時，因為選字錯誤是很常見
的錯誤產生方式。因此，本系統將透過文字/鍵盤輸入對應表，將每一個中文字元，轉換為輸入法在
鍵盤上所需要輸入的順序，即可以得到資料庫中的關鍵字與輸入字串的鍵盤輸入特徵。該特徵有著不
受選字系統錯誤的優點，透過比較關鍵字與查詢片語的鍵盤輸入特徵，即可已在使用者選字錯誤的情
況下，給予正確的文字建議。輸入特徵與使用者所使用之輸入法息息相關，本系統目前採用的是在台
灣地區廣為使用的注音輸入法為基礎，根據教育部常用國字標準字體表與次常用國字標準字體表為參
考，採用共約一萬三千字的中文/注音輸入對應表。透過更換輸入對應表，本系統亦可以支援其他輸
入法所造成的選字錯誤。 
 
 破音字 / 易混淆輸入窮舉 
除了單純的選字錯誤外，中文亦有破音字一字多種讀音的問題。儘管在生活中不同讀音代表不同的意
義，但對電腦而言不同讀音卻是指向同一字元。另一方面，生活中對破音字多種發音互相混淆的情況
亦時有所聞。因此，在考慮因選字而造成的錯誤時，亦頇同時考慮破音字造成的選字誤差。本系統將
窮舉所有更換輸入對應表中紀錄的破音字發音可能性，已增加正確猜測的可能性。 
 
 此外，不同的輸入法在輸入時，可能也會造成其輸入法特有之錯誤。例如注音輸入法在輸入時，
其韻尾常有混淆的情況。同樣的情況，本系統將會針對如“ㄥ”“ㄣ”等幾種常混淆的韻尾，加入窮
舉可能性清單之中。若是採取非注音輸入法之其他輸入法，如倉頡輸入法等拆字輸入法，亦可以加入
易混淆之拆字方式，以增加系統之偵測率。 
 
 關鍵字與輸入特徵比對 
本系統目前使用網頁介面作為示範雛形。當使用者在網頁介面上面輸入關鍵字時，本系統將在使
用者送出之前，即時的將使用者所輸入的文字轉變為鍵盤輸入特徵，並透過窮舉比對方式，針對關鍵
字資料庫預先產生之鍵盤輸入特徵資料欄位進行比對。若是有完全相符之關鍵字，則優先選用，否則
即優先挑選輸入順序相符或可透過錯誤模擬窮舉出的關鍵字，並透過下拉式選單方式，提供使用者搜
尋建議，幫助使用者更方便的搜尋至自己有興趣的內容。 
無研發成果推廣資料 
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
完成＇智慧型文件影像自動分析＇及＇ 智慧型注音輸入檢索機制＇兩大功能
模組，已將該模組交付合作廠商以整合進新版的電子書閱讀系統中，該系統於
今年國際書展中成功展出。 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
