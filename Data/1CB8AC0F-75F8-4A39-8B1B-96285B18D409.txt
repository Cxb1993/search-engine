 2
考訊號在統計上是不相關的；  zW 為適應性 FIR 濾
波器，階數為 L，表示為： 
     11110   LL zwzwwzW           (2) 
定義權重向量  nTw 及參考訊號向量  nTx 分別為： 
        nwnwnwn LT 110  w         (3)         11  LnxnxnxnT x       (4) 
所以 FIR 濾波器  zW 的輸出控制訊號  ny 可表示
為： 
     nnny T xw                 (5) 
 zP2 為第二路徑；  ny 稱為對抗噪音的訊號表示為：      nyzPny 2                 (6)  ne 為誤差麥克風所量到的訊號表示為： 
       nvnyndne               (7) 
由於期望將  ne 降到零，所以令   0nedesired ，傳統的
殘留誤差表示為：            nvnyndnenen desired        (8)  nCˆ 為置換誤差表示為： 
        nynnn TC  ˆˆˆ xw             (9) 
其中  nxˆ 為  nx 經過第二路徑之轉移函數濾波後的
訊號表示為： 
     nzPn 2 xx ˆˆ               (10)  nyˆ 為  ny 經過第二路徑之轉移函數濾波後的訊號
表示為： 
     nyzPny 2ˆˆ               (11)  nLˆ 為更新控制器權重用的殘留誤差表示為：      nnn CL  ˆˆ             (12) 
文獻中，更新控制器權重的 FxLMS/Ce 演算法表示
為：        nnμnn Lˆˆ1 xww             (13) 
根據(8)及(9)式，(12)式可重新表為： 
         nnndn TL xw  ˆˆ        nvnyny  ˆ            (14) 
從(14)式得知，當控制器權重更新到最佳值時，
     nnnd T xw  ˆ 這一項會收斂到零；當鑑別的第二
路徑之轉移函數  zP2ˆ 準確時，    nyny  ˆ 這一項可
以消掉；所以  nLˆ 中還存在有不相關的干擾  nv ，
其會影響控制器的性能；故本文考慮將干擾估算出
來，並利用估算出的干擾將實際存在的干擾扣除掉，
因此定義新殘留誤差表示為：      nenn vLN   ˆˆ           (15) 
並且利用  nNˆ 代替  nLˆ 輸入演算法中來更新控制
器的權重向量，適應性演算法表示為：        nnμnn Nˆˆ1 xww             (16) 
    要應用(16)式來更新控制器權重時，需將干擾估
算出來，所以接著說明如何得到干擾的估算值，根據
(7)式，可將  nv 表示為： 
       nyndnenv             (17) 
上式中的  ne 可由誤差麥克風量到，而  ny 已經由
(11)式估算出來，所以還需要將  nd 估算出來才能估
算出  nv 。從(1)式得知  nd 為參考訊號經第一路徑
後的訊號；但在實際應用時，第一路徑可能是時變的
或不容易取得其轉移函數，故本文藉由串聯適應性
FIR 濾波器的架構，來將  nd 估算出來。首先將控制
器串聯一組適應性 FIR 濾波器稱之為鑑別器  zC ， 
形成如圖二的系統方塊圖。  zC 為 M 階的 FIR 濾波
器，表示為： 
     11110   MM zczcczC           (18) 
在此，  nx 為  zC 的參考輸入，則參考向量  nTx 及
權重向量  nTc 表示為： 
        11  MnxnxnxnT x      (19) 
        ncncncn MT 110  c          (20) 
所以鑑別器  zC 的輸出表示為： 
     nnnu T xc                 (21) 
由於  nx 和  nv 在統計上是不相關的；而  nx 和  nd
在統計上是相關的，所以當  nx 為鑑別器 C(z)的參考
輸入時，可藉由 LMS 演算法更新  zC 的權重來學習
出  nd ，LMS 演算法表示為： 
       nenμnn vc xcc 1            (22) 
將  nev 定義為： 
                nunynenev  ˆ             (23) 
將(7)式代入(23)式得到：            nunynvnyndnev  ˆ     (24) 
在第二路徑的轉移函數  zP2ˆ 鑑別準確時，並根據(1)
及(21)式，可將(24)式表示為： 
           nnnvnxzPne T1v xc         (25) 
觀察(25)式，由於  nx 和  nv 在統計上是不相關的；
而    nxzP1 和    nnT xc 是相關的，所以利用(22)式之
LMS 演算法更新(25)式中的  nc 使    nnT xc 這一項
要等於    nxzP1 ；而鑑別器  zC 類似在作第一路徑的
線上鑑別，所以當鑑別器收斂後，    nnT xc 會近似
於    nxzP1 ，所以  ne v 就會近似於  nv ，於是估算
出  nv 表示為： 
   nvnev                   (26) 
在得到干擾的估測值  ne v 後，就可將實際存在的干
擾扣除掉而得到新殘留誤差，如此控制器在更新權重
時，將不會受到實際存在的干擾影響，其消音性能也
能 獲 得 改 善 ； 本 文 將 (16) 及 (22) 式 合 稱 為
CFxLMS/CeD 演算法。 
 
 
 4
式之 r 為不同值，對於控制器及鑑別器的權重收斂有
何影響， r 分別設定為 0.001、0.0005 及 0.00025；圖
六為控制器及鑑別器權重向量的 norm 值收斂示意
圖，由圖中的比較得知， r 選擇越大，權重收斂速度
越快，但控制器權重上下變化的現象也會變大。圖七
為 r 分別為 0.001、0.0005 及 0.00025 控制後之功率密
度頻譜，由圖六及圖七得知， r 為 0.00025 時，由於
權重在 20 秒還未收斂到定值，所以 100 Hz、200 Hz
及 300 Hz 的噪音在控制後功率衰減較少；接著比較 r
為 0.001 與 0.0005 得知，兩者在控制後的功率相差
4~5 dB，是由於 r 為 0.001 時控制器權重在收斂的過
程中上下變化較大，而影響了消音性能；所以選擇 r
時需在收斂速度及消音性能之間做取捨。 
 
實驗 
    本節將呈現受到干擾影響之窄頻主動噪音控制
系統的實驗結果，分別應用文獻[4]的 FxLMS/Ce 演算
法及本文提出的 CFxLMS/CeD 演算法於一維聲管的
實驗中，圖八為實驗的架構圖，利用數位訊號處理器
DS1103 來實現控制器及鑑別器的設計，實驗所設定
的參數都和模擬所設定的一樣，在此特別要注意的
是，本文分為兩種情形來做實驗：第一種實驗為原本
就存在的環境干擾的情況下，圖九為應用 FxLMS/Ce
演算法及 CFxLMS/CeD 演算法實驗得到之時域誤差
圖，圖十為控制前與分別應用 FxLMS/Ce 演算法及
CFxLMS/CeD 演算法控制後之功率密度頻譜，兩圖皆
顯示 CFxLMS/CeD 的消音性能優於 FxLMS/Ce。第二
種實驗為除了環境干擾外再加入人為的干擾，加入方
式為將誤差麥克風量到的訊號經過 A/D 轉換輸入電
腦後，以 SIMULINK 程式來將人為干擾額外加入。
圖十一為應用 FxLMS/Ce 演算法及 CFxLMS/CeD 演
算法實驗得到之時域誤差圖，由於誤差麥克風量到了
包含 6 個弦波訊號及 white noise，故藉由誤差麥克風
訊號之功率密度頻譜，比較控制前與控制後在這 6 個
頻率上功率的變化情形，圖十二為控制前與分別應用
FxLMS/Ce 演算法及 CFxLMS/CeD 演算法控制後之
功率密度頻譜，由圖中得知，對於要消除的噪音，在
控制前 100 Hz 為 6 dB、200 Hz 為 8 dB、300 Hz 為 3 
dB，而 175 Hz、275 Hz 及 375 Hz 則是沒有要控制的
干擾，比較兩種演算法控制後之功率得知，應用
CFxLMS/CeD 演算法控制後，100 Hz 的功率降到-54 
dB、200 Hz 的功率降到-55 dB、300 Hz 的功率可降
到-65 dB，並改善了應用 FxLMS/Ce 演算法時，在 125 
Hz、150 Hz、225 Hz 及 325 Hz 的功率有被放大的現
象，此實驗結果與模擬結果有類似的情形。 
 
四、結論與討論 
 
    對於受到干擾影響之窄頻主動噪音控制系統，本
文提出 CFxLMS/CeD 演算法來解決此問題，應用此
演算法時，須將第一路徑及第二路徑之轉移函數使用
離線鑑別的技術估算出來，然而第一路徑可能是時變
的或不容易取得其轉移函數，故本文將主動噪音控制
器串聯一組適應性 FIR 濾波器，其利用參考訊號與噪
音訊號之間的相關性來線上鑑別第一路徑，以便能估
算出干擾之大小，在估算出干擾後便能將誤差麥克風
訊號中實際的干擾扣除，並得到扣除干擾後的新殘留
誤差，如此控制器在利用新殘留誤差來更新權重時，
就不會受到干擾的影響，而能夠輸出適當的控制訊號
經控制喇叭來消除噪音，由電腦模擬及實驗結果得
知，使用 CFxLMS/CeD 演算法可改善權重收斂過程
中受到干擾影響所產生之上下劇烈變化的現象，並且
得到較佳的消音效果。 
 
五、參考文獻 
1. W. S. Gan and S. M. Kuo, “An Integrated Audio 
and Active Noise Control Headsets”, IEEE Trans, 
Consumer Electron., Vol. 48, No. 2, pp. 242-247, 
2002. 
2. S. M. Kuo and M. Ji, “Passband Disturbance 
Reduction in Periodic Active Noise Control 
Systems”, IEEE Trans, Speech Audio Process., Vol. 
4, No. 2, pp. 96-103, 1996. 
3. X. Sun and S. M. Kuo, “Active Narrowband Noise 
Control Systems Using Cascading Adaptive Filters”, 
IEEE Trans, Speech Audio Process., Vol. 15, No. 2, 
pp. 586-592, 2007. 
4. Ching-Wen Liao and Jong-Yih Lin, “New FIR 
Filter-Based Adaptive Algorithm Incorporating 
with Commutation Error to Improve Active Noise 
Control Performance”, Automatica, ScienceDirect, 
Vol. 43, pp. 325-331, 2007. 
5. S. M. Kuo and D. R. Morgan, Active Noise Control 
Systems: Algorithms and DSP Implementations, 
New York: Wiley, 1996. 
6. 黃靜宜，狹帶延遲類神經網路於主動噪音控制之
應用，碩士論文，國立中興大學機械工程研究
所，台中、台灣，2006。 
 
六、圖表 
 zP1
 zP2
 zP2ˆ


LMS
 nx  nd  nv
 ny  ny
xˆ
 ne zW
 
 
 zP2ˆ  nyˆ
 
 

 nCˆ n
0desirede
 n


w n

 nLˆ
 
圖一 應用 FxLMS/Ce 演算法於主動噪音控制之系統
方塊圖。 
 6
x
e
200 cm
155 cm
110 cm
5 cm
Control
Speaker
Main Duct
Noise
Speaker
Microphone
Amplifier 2
Filter&
Amplifier
Amplifier 1
D/A
A/D
D/A
DS1103
y
 
圖八 主動噪音控制實驗架構圖。 
 
 
圖九 實驗之時域誤差圖：未額外加入干擾時應用 
FxLMS/Ce 演算法、CFxLMS/CeD 演算法。 
 
 
圖十 實驗之誤差功率密度頻譜比較圖：未額外加入
干擾時，控制前及應用 FxLMS/Ce 演算法、
CFxLMS/CeD 演算法控制後。 
 
 
圖十一 實驗之時域誤差圖：額外加入干擾後應用 
FxLMS/Ce 演算法、CFxLMS/CeD 演算法。 
 
 
圖十二 實驗之誤差功率密度頻譜比較圖：額外加入
干擾後，控制前及應用 FxLMS/Ce 演算法、
CFxLMS/CeD 演算法控制後。 
 
99 年度專題研究計畫研究成果彙整表 
計畫主持人：林忠逸 計畫編號：99-2221-E-005-061- 
計畫名稱：具有「不相關之帶通干擾」之主動噪音控制系統的開發 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 1 100%  
研討會論文 0 1 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 2 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 0 1 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
 
