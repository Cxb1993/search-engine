 
行政院國家科學委員會專題研究計畫 研究成果報告 
 
 
 
 
 
 
 
 
 
計畫類別： 整合型計畫 
計畫編號： NSC 99－2220－E－006－005－ 
執行期間： 99 年08 月01 日至100 年07 月31 日 
執行單位： 國立成功大學資訊工程學研究所 
 
 
 
 
 
 
 
 
計畫主持人： 何宗易 
計畫參與人員： 吳博勳，許凱迪，張嘉文，楊宗翰 
報告類型： 完整報告 
報告附件： 國際合作計畫研究心得報告 
處理方式： 本計畫涉及專利或其他智慧財產權，2 年後可公開查詢 
 
 
 
 
 
 
 
 
中 華 民 國 100 年 10 月 28 日 
應用於細胞老化程度監測和疾病預防之居家型單晶片系統－子計畫四： 
應用於細胞老化程度監測和疾病預防之微機電設計自動化工具(3/3) 
1A Network-Flow Based Pin-Count Aware Routing
Algorithm for Broadcast-Addressing EWOD Chips
Abstract—Electrowetting-on-dielectric (EWOD) chips have
emerged as the most widely used actuators for digital microfluidic
(DMF) systems. These devices enable the electrical manipulation
of microfluidics with various advantages such as low power con-
sumption, flexibility, accuracy, and efficiency. In addressing the
need for low-cost and practical fabrication, pin-count reduction
has become a key problem to the large-scale integration of
EWOD-chip designs. One of the major approaches, broadcast
addressing, reduces the pin count by assigning a single control
pin to multiple electrodes with mutually compatible control
signals. Most previous studies utilize this addressing scheme by
scheduling fluidic-level synthesis on pin-constrained chip arrays.
However, the associated interconnect routing problem is still not
provided in currently available DMF automations, and thus the
broadcast-addressing scheme cannot be actually realized. In this
paper, we present the first network-flow based pin-count aware
routing algorithm for EWOD-chip designs with a broadcast
electrode-addressing scheme. Our algorithm simultaneously takes
pin-count reduction and wirelength minimization into consid-
eration for higher integration and better design performance.
Experimental results show the effectiveness and scalability of
our algorithm on a set of real-life chip applications.
I. INTRODUCTION
Due to the principle of electrowetting-on-dielectric
(EWOD), the EWOD chip has been appreciated as a promising
actuator for digital microfluidic (DMF) systems [13], [19],
[21], [22]. This chip enables the electrical manipulation of
discrete fluidics (i.e., droplets) with low power consumption,
flexibility, and efficiency. Furthermore, their capability of
automatic and parallel controls offers faster and more precise
execution. These advantages increase the practicality of
applications including immunoassays, DNA sequencing, and
point-of-care diagnosis on miniaturized DMF systems with
lower cost, less reagent consumption, and higher immunity
to human error.
As schematically presented in Figure 1(a), the general
diagram of a two-dimensional (2D) EWOD chip contains a
patterned electrode array, conduction wires, electrical pads
(i.e., I/O ports), and a substrate [11], [21], [22]. Through
these electrical devices, external micro-controller can drive
these electrodes by assigning time-varying actuation voltage.
Thus, by generating electrohydrodynamic force from elec-
trodes, many fluidic-level controls can be performed due to
the electrowetting phenomenon [19].
In order to drive the electrodes correctly, electrode ad-
dressing is introduced as a method through which electrodes
Copyright (c) 2010 IEEE. Personal use of this material is permitted.
However, permission to use this material for any other purposes must be
obtained from the IEEE by sending an email to pubs-permissions@ieee.org.
Preliminary version of this paper is presented at the 2010 IEEE/ACM
International Conference on Computer-Aided Design (ICCAD’10), San Jose,
CA, November 2010 [14]. This work was partially supported by National
Science Council of Taiwan under Grant No’s NSC 98-2220-E-006-013.
Electrode
Conduction 
wires 
Electrical pads
Substrate
2D pin array
Pin
(a)
(b)
Figure 1. (a) Schematic view of an EWOD chip. (b) Routing model on a
2D pin array.
are assigned or controlled by pins to identify input signals.
Specifically, the external micro-controller reads pin-actuation
status from memory, translates them into voltage control
signals, and activates or deactivates the corresponding control
pins on the EWOD chip [13]. Early EWOD-chip designs
relied on direct addressing [11], where each electrode is
directly and independently assigned by a dedicated control
pin. This addressing maximizes the flexibility of electrode
controls. However, due to the limited number of signal ports
in the micro-controller, it is infeasible for a micro-controller
to activate a large number of control pins. For example,
the micro-controller for a recently developed n-plex bioassay
application can only activate 64 control pins [4]. Therefore, it
cannot control thousands of electrodes directly. Moreover, the
high pin-count demand also introduces electrical-connection
problems, such as infeasible wiring or multi-layer connections.
In this regard, it is unreliable and prohibitively expensive to
manufacture this kind of chip [24], [25].
Recently, pin-constrained design has been raised as a pos-
sible solution to this problem. One of the major approaches,
broadcast addressing, reduces the number of control pins by
assigning a single control pin to multiple electrodes with
mutually compatible control signals [24]. In other words,
multiple electrodes are controlled by a single control signal
and are thus driven simultaneously. In this regard, much on-
going effort has been made to group sets of electrodes that can
be driven uniformly without introducing signal conflict [23],
[24].
For electrical connections, conduction wires must be routed
from the topside electrode array, through the underlying sub-
strate, to the surrounding pads. Hence, after the electrodes are
addressed with control pins, the routing problem for EWOD
chips can be specified to a 2D pin array, while establishing cor-
respondence between control pins and pads (see Figure 1(b)).
However, this routing issue is still not readily available among
3and wirelength can be simultaneously minimized in a
global view.
• In the progressive routing scheme, we divide the original
routing problem into a set of manageable subproblems
corresponding to each pin-count expansion. By deriving
a minimum-cost maximum-flow network to formulate the
pin-count expansion, the required number of control pins
can be minimally determined for electrode addressing and
routing in each subproblem.
• In readdressing and rerouting refinement, we introduce
a simple yet efficient post refinement to improve the
routability. With appropriately and locally handling the
unroutable electrodes left from previous routing stages,
the entire design overhead can be minimized.
Experimental results demonstrate the scalability and effec-
tiveness of our algorithm. The evaluation performed on a set
of real-life chip applications shows that our algorithm achieves
the best results in terms of routability, pin-count demand,
and wirelength. We also simulate the fluidic-level synthesis
and randomly generate several hard test designs to show the
robustness of our algorithm.
The remainder of this paper is organized as follows. Section
II describes the related preliminaries. Section III points out
the design challenge and formally defines the problem and
constraints. Section IV details the proposed pin-count aware
routing algorithm. Section V analyzes the time complexity of
the proposed algorithm. Finally, sections VI and VII show our
experimental results and conclusions.
II. PRELIMINARIES
This section first describes the related background of digital
microfluidics and the EWOD chips. Then, the control mecha-
nism of broadcast addressing is detailed.
A. Digital Microfluidics and EWOD Chips
In recent microfluidic technology, liquids have been success-
fully discretized or digitized into independently controllable
drop- lets in micro or nano scale. This miniaturization offers
several advantages over the traditional continuous-flow or
mist-based systems, such as higher sensitivity, lower reagent
consumption, and more flexible controls. Moreover, the digiti-
zation allows complex microfluidic functions to be efficiently
designed via hierarchical and cell-based design methods in
modern VLSI automation.
Droplet Electrode
High voltage to generate an electric field
Figure 4. Droplet control on an EWOD chip.
In performing various fluidic-handling functions, a primary
issue is the manipulation of droplets. Although droplets can
be controlled on many driving platforms [10], [16], [20],
[22], the EWOD chips, also referred to as EWOD actuators,
have received much more attention due to their high accuracy
and efficiency, and simple fabrication [11]. The EWOD chip
generates electric potential by actuating electrodes to change
the wettability of droplets, such that droplets can be shaped
and driven along the active electrodes [19], [21], as illustrated
in Figure 4. To induce enough change of wettability for droplet
motion, the voltage value applied to electrodes must exceed
a threshold. This phenomenon enables a binary value (i.e.,
1/0) to represent a relatively logic-high/logic-low value of an
actuation voltage, and thus the entire electrode controls can
be modeled simply. Furthermore, by patterning electrodes to a
general 2D array and adopting time-varying actuations, many
droplet-based operations (e.g., mixing and cutting) can be
well-performed on a 2D array in a reconfigurable manner [22].
B. Broadcast Addressing
To execute a specific bioassay, information for fluidic
controls must be stored in the form of electrode activation
sequences. Each bit in the sequence represents the activation
status of the electrode in a specific time step, and can be
represented as activated “1”, deactivated “0”, or don’t care
“X”. The aforementioned, “1” (“0”) represents a control signal
with a relatively logic-high (logic-low) value of the actuation
voltage. The symbol “X” indicates that the input signal can
be either “1” or “0”, which has no impact on scheduled
fluidic controls [24]. Examples of an electrode set and the
corresponding activation sequences are presented in Figures
5(a) and (b).
1 2
3 4
65 7 8
9 10
11 12
1 4
2 5
35 3 2
4 1
5 2
e1 e2
e3 e4
e6e5 e7 e8
e9 e10
e11 e12
Electrode
Activation Sequence
e1 e2 e3 e4 e6e5 e7 e8 e9 e10 e11 e12
1
0
0
X
X
1
0
0
X
X
0
1
0
0
X
0
1
0
0
X
0
1
0
0
1
X
0
1
0
0
X
0
1
0
0
0
1
0
0
1
X
X
0
1
X
X
X
0
1
X
X
X
X
0
1
X
X
X
0
1
(a)
(b)
(c) Pin count: 12 (d) Pin count: 5
Figure 5. (a) Electrodes that are used for handling fluidic functions. (b)
Scheduled fluidic functions in the form of activation sequences. (c) Applies
the direct-addressing scheme. (d) Applies the broadcast-addressing scheme.
To correctly drive these electrodes, control pins must be
appropriately assigned to the electrodes for identifying input
signals. This approach is also referred to as electrode address-
ing. Unlike direct addressing, where each electrode is assigned
by an independent control pin, broadcast addressing focuses
on electrode grouping and control signal merging through
the compatibility of activation sequences. Specifically, each
electrode activation sequence may contain several don’t care
terms. By carefully replacing these don’t care terms with “1”
or “0”, multiple activation sequences can be merged to an
identical outcome, which is also referred to as the common
compatible sequence of these electrodes. Therefore, these
electrodes can be assigned by the same control pin to receive
the same control signal.
5can be routed in any angle or even in a rounded manner [1],
[2], while the IC-based counterparts restrict most routing to
be orthogonal. Thus, without loss of generality, we focus
on orthogonal routing such that the horizontal and vertical
properties can be realized in both IC-based and PCB-based
technologies.
1.5mm
1.5m
m
(a) (b)
Figure 7. Number of wires between adjacent pins is 3. (a) Pin array. (b)
Grid model.
Another significant consideration is the avoidance of elec-
trical defects (e.g., shorts) caused by the shrinkage of wiring
clearance. To prevent these faults, the spacing between wires
must maintain a threshold; specifically, only a limited number
of wires can pass through adjacent pins. Since the capacity
between adjacent pins varies with the required electrode size
for different bio-applications, it can thus be customized. In
this paper, we use the real specification in [11] such that the
maximum number of wires between adjacent pins is 3. As
in most VLSI routing problems, we focus on uniform grid
structure for flexibility and generality. Figure 7 exemplifies
these concerns.
In addition, a multi-layer arrangement of electrical connec-
tions necessitates a mechanism for passing signals between
layers (e.g., vias and contacts), raising a cost issue in both
IC-based or PCB-based fabrication. For example, the cost
of PCB prototype fabrication with one, two, four and six
layers is respectively US$8.99, US$12.99, US$34.99 and
US$59.99, resulting in expenses which increase exponentially
with additional layers [1]. Since many biomedical applications
prefer disposability, it is likely that using multi-layered chips
is prohibitively expensive and thus undesirable. Therefore, in
this paper, we focus on single-layer routing.
D. Problem Formulation
The pin-constrained design problem for an EWOD chip can
be formulated as follows.
Input: A set Ee of used electrodes for fluidic controls, control
information of electrodes in the form of activation sequences,
and chip specification.
Constraint: Both broadcast constraints and routing con-
straints should be satisfied.
Objective: Derive an electrode-addressing result and establish
a routing solution, while minimizing the required control pins
and wirelength.
IV. ALGORITHM
In this section, we present our pin-count aware routing
algorithm. We first discuss the electrode grouping method
used in our routing algorithm. Then, the pin-count aware
global routing and progressive routing scheme are respectively
detailed.
For the purpose of readability and clarity, we use a real-
life chip application to exemplify each phase of the proposed
algorithm. As illustrated in Figure 8(a), the chip for DMF
based amino acid synthesis contains two types of droplets,
functional droplets and wash droplets. The functional droplets
(i.e., leucine, phenylalanine, and piperidine droplets) are used
for amino acid synthesis, while the wash droplets are used for
cleaning contaminations left behind on the surface, to avoid
erroneous reaction outcomes. More details can be referred
to [18].
A. Electrode Grouping Method
In our pin-count aware routing algorithm, we focus on two
kinds of electrode grouping methods in compatibility graph
Gc, maximum clique and maximum independent set. By recog-
nizing the maximum clique and maximum independent set in
Gc, we can identify a maximum electrode group with mutually
compatible and mutually incompatible control signals. Even
though general recognitions of maximum clique and maximum
independent set are known to be NP-hard, a number of high
quality heuristics and approximation algorithms are available
in the literature to solve them efficiently. In this paper, we use
the heuristic in [15] as our electrode grouping method, which
is based on the repeated addition of a candidate vertex with a
defined indicator (i.e., vertex degree).
B. Pin-Count Aware Global Routing
The major goal of pin-count aware global routing is to
schedule an initial arrangement for control pins and wires in
a global view, while keeping the pin-count demand and wire-
length minimized. To tackle the induced design complexity by
simultaneous addressing and routing, we identify the factors
that have impact on and attribute to pin-count demand and
wirelength as follows.
1) As presented in Figure 9(a), if the control pins are
not carefully assigned to electrodes, the induced rout-
ing complexity may trigger more deadlocks or detours
between different control pins, implying the orientation
of control pins and wires must be well-planned.
2) As presented in Figure 9(b), if the pins with the same
control signal are oriented in a line, a straight wire can
connect these pins together without any detour thereby
reducing the wirelength.
3) As presented in Figure 9(c), once the orientation of a
wire with a dedicated signal pin is determined, it is
desirable to maximize the number of electrodes that can
be wired together thereby reducing the pin count and
wirelength.
To fully utilize the properties that are favorable for pin-
count reduction and wirelength minimization, we construct
the global routing tracks on rows and columns in the 2D pin
array, such that all the electrodes can be covered. For each of
these global routing tracks (i.e., a certain row or column), we
identify a maximum electrode group without signal conflict
and assign a dedicated control pin to this group. Then, on this
track, conduction wires can be guided on a straight route to
this control pin without any detour.
73) For each node cj , create a directed edge cj → t with
one unit capacity.
s
c1
r1
r2
r3
r4
r5
r6
c2
c3
c4
c5
c6
c7
c8
t
Capacity = 1 Capacity = ∞ Capacity = 1
Nodes for global 
routing tracks
Minimun s-t cut [S, T]
Figure 11. Example of the maximum-flow based global routing tracks
construction for Figure 8(b).
As the example in Figure 8(b), there is a 2D pin array
with 6 rows and 8 columns, and 20 electrodes used for fluidic
controls. By implementing the two formulation rules, the entire
flow network Gmf can be constructed as illustrated in Figure
11. Based on the two formulation rules, two theorems can be
derived as follows.
Theorem 1: A minimum s-t cut in the flow graph Gmf ,
denoted as [S, T ], contains no edge ri → cj .
Proof: Theoretically, an s-t cut of Gmf is an edge set
[S, T ] such that Gf − [S, T ] has two components S and T ,
with s ∈ S and t ∈ T . According to MF-Rule #2, any s-t flow
must be the connectivity as s→ ri → cj → t. To disconnect
this s-t flow, at least one of the three edges s→ ri, ri → cj ,
and cj → t must belong to [S, T ]. Based on this definition,
the minimum s-t cut requires the total of the capacities on the
edge set [S, T ], denoted as C[S, T ], to be minimized. Since the
capacity of the edge ri → cj is assigned as infinite, a minimum
s-t cut of Gmf consequently contains no edge ri → cj .
Theorem 2: The optimal number of global routing tracks is
equal to the total of the capacities on the edge set [S, T ] in
Gmf .
Proof: A feasible solution for global routing tracks re-
quires that all electrodes ek ∈ Ee must be covered. According
to theorem 1 and cut property, for each edge ri → cj , at least
one of the two ending nodes must belong to the node set of
[S, T ], denoted as V[S,T ]. This feature implies that the node set
V[S,T ] − {s, t} covers all the edges ri → cj . In MF-Rule #1,
since all the edges s→ ri and cj → t are assigned by one unit
capacity, C[S, T ] can thus be regarded as the minimum number
of required nodes, ri and cj , to cover all the edges ri → cj .
Referring to MF-Rule #2, each edge ri → cj represents a
used electrode in the 2D array, meaning that covering all edges
ri → cj is equivalent to covering all electrodes. Therefore, the
minimum number of global routing tracks is equal to C[S, T ]
in Gmf .
In duality theorem, a maximum s-t flow value is equal to
the minimum capacity of an s-t cut. Therefore, by deriving
a maximum flow in Gmf , the minimum s-t cut [S, T ] can
be obtained. Then, based on the two theorems, the global
routing tracks can be optimally constructed by tracing the
corresponding rows and columns of the node set V[S,T ]−{s, t},
where V[S,T ] denotes the node set of [S, T ].
As shown in Figure 11, after deriving a maximum s-t flow,
the red-dash arrows represent the edge set of a minimum s-t
cut [S, T ], and the node set V[S,T ] − {s, t} is {r3, r4, c3, c6}.
By tracing the corresponding rows and columns in the 2D pin
array, the global routing tracks can be constructed as illustrated
in Figure 8(b).
3) Addressing and Routing: The details of the proposed
pin-count aware global routing can be presented in Algorithm
1. We first derive a maximum-flow formulation with the
duality of min-cut property to construct the global routing
tracks. After the global routing tracks are constructed (line 2-
4), we perform the electrode addressing and routing on these
specific tracks such that the design complexity can be greatly
reduced from the entire 2D pin array to these 1D tracks.
For each global routing track tki, we identify the maximum
electrode group without signal conflict, denoted as gi, by using
the proposed technique mentioned in Section IV-A. For the
purpose of efficiency, a priority queue Q, with the priority
of |gi|, is created for storing each tki (line 5-8). Then, we
iteratively extract a global routing track tki from the priority
queue Q, and assign a dedicated control pin to gi (line 9-
11). To minimize the wirelength, a horizontal/vertical wire is
guided to route this control pin without any detour (line 12).
When crossing a wire, the corresponding electrode group will
be decomposed followed by a readdress-and-reroute approach
(line 13-15). After tki is processed, the electrode grouping
information for each tkj left in Q is updated (line 16). Finally,
iterations end until all global routing tracks are processed (line
17).
Algorithm 1: Pin-Count Aware Global Routing
Input : A 2D pin array, an electrode set Ee
/* tki: a global routing track */
/* gi: the maximum non-conflict electrode group
on tki */
/* Q: a priority queue with the priority of |gi|
*/
1 begin
2 construct a maximum-flow network;
3 derive a maximum flow and obtain a minimum cut;
4 construct the global routing tracks;
5 foreach global routing track tki do
6 identify gi on tki;
7 Q.PUSH(tki);
8 end
9 while Q 6= φ do
10 tki ← EXTRACT-MAX(Q);
11 assign a dedicated control pin to gi;
12 guide a horizontal/vertical wire to route this control pin;
13 if cross other wires then
14 readdress and reroute;
15 end
16 update gj of tkj left in Q;
17 end
18 end
Output: Initial arrangement of control pins and wires
We use Figure 8(b)-(c) to exemplify our pin-count aware
global routing. By deriving a maximum-flow (MF) formulation
with the duality of min-cut property, the global routing tracks
9needs to be minimized. Consequently, for each subproblem
s, the problem of pin-count expansion can be formulated as
follows.
Given: A 2D pin array, Ps, and E′e.
Constraint: Broadcast constraints should be satisfied
Objective: Maximize the number of addressed electrodes by
using Ps such that pin-count expansion is minimized, while
also minimizing routing wirelength.
2) Minimum-Cost Maximum-Flow Formulation: To min-
imize pin-count expansion, we construct a minimum-cost
maximum-flow (MCMF) graph Gmcmf = (Vmcmf , Emcmf )
and propose two formulation rules. The first rule describes
the formulation of Vmcmf , and the second rule describes the
formulation of Emcmf .
The key idea behind our MCMF formulation is to map
the objective “maximize the number of addressed electrodes
by using Ps” into “maximum flow value” in Gmcmf , with
“minimize the routing wirelength” corresponding to “minimum
flow cost”. To avoid any violation of broadcast constraints in
our MCMF formulation, we define the control pin set P ks ∈ Ps
for each electrode ek ∈ E′e such that ek can be addressed
with the control pin p ∈ P ks . By identifying the compatibility
between ek and those addressed electrodes with control pins
p ∈ Ps, the P ks can be obtained. Since the wirelength for
routing an electrode ek with the control pin p ∈ P ks should be
minimized, we define the routing cost as follows.
Cost(ek, p) =
∑
(α · gc + β · gn), ∀ek ∈ E′e, p ∈ Pks (1)
where Cost(ek, p) represents the pin-to-wire routing cost
from electrode ek ∈ E′e to the routed wire of control pin
p ∈ P ks . Since our routing is based on uniform grid structure,
if the routing for ek crosses another wire in the grid point gc, a
high penalty α is assigned; otherwise a low cost β is assigned
to the non-crossing grid point gn. Then, we perform the A*
maze searching method to find a minimum cost routing path.
In this paper, we empirically set α = 10 and β = 0.1.
The two MCMF formulations rules can be detailed as
follows.
MCMF-Rule #1: Formulation of Vmcmf
1) For each electrode ek ∈ E′e, create a node vek .
2) For each control pin p ∈ Ps, create a node vp.
3) Create a source node s′, and a sink node t′.
MCMF-Rule #2: Formulation of Emcmf
1) For each node vek , create a directed edge s
′ → vek with
one unit capacity and zero cost per unit flow.
2) For each node pair (vek , vp), where ek ∈ E′e and
p ∈ P ks , create a directed edge vek → vp with one
unit capacity and Cost(ek, p) cost per unit flow.
3) For each node vp, create a directed edge vp → t′ with
one unit capacity and zero cost per unit flow.
Figure 14 shows a general diagram of the MCMF formu-
lation. Based on the proposed MCMF formulation rules, we
have the following two theorems
Theorem 3: A feasible s′ − t′ flow represents a correct
electrode addressing without any violation of broadcast con-
straints.
s’
ve1 v1
v2
v3
v4
vm-1
vm
ve2
ve3
ven-2
ven-1
ven
t’
vek Node for electrode ek
Cap. = 1
F. C. = 0 F. C. = 0
F. C. : Flow cost
F. C. = Cost(ek , p)
Cap. = 1 Cap. = 1
Cap. : Capacity
vp Node for control pin p
Figure 14. Formulates pin-count expansion to the minimum-cost maximum-
flow network.
Proof: Based on the constructed MCMF network, a fea-
sible flow f must be the connectivity as s′ → vek → vp → t′.
Since all the edge capacities in our MCMF formulation are
set to be one, the flow value of f must be one and thus can
be regarded as addressing electrode ek with control pin p.
According to the MCMF-Rule #2, for each electrode ek, the
edge vek → vp is constructed only for control pin p ∈ P ks .
As the definition, P ks is obtained by tracing all the existing
control pins that can be assigned to ek. Therefore, for any
feasible flow in the connectivity as s′ → vek → vp → t′, the
corresponding electrode addressing is valid without violating
broadcast constraints.
Theorem 4: Based on the proposed MCMF network, we
can adopt the MCMF algorithm to optimally maximize the
number of addressed electrodes with minimum total routing
costs.
Proof: Theoretically, the MCMF problem is to find a
set of feasible flows, with minimum total cost. According to
theorem 3, any feasible flow represents a correct electrode
addressing, and thus the number of addressed electrodes is
equal to the total flow value. In addition, the flow cost in
our MCMF network is modeled as the defined routing cost,
as formulated in MCMF-Rule #2. Therefore, by adopting the
MCMF algorithm, the number of addressed electrodes can be
optimally maximized with minimum total routing costs.
Based on the two theorems, we can maximize the number
of addressed electrodes by deriving a maximum flow value in
Gmcmf and have the following lemma.
Lemma 1: The extra pin-count demand for electrode ad-
dressing is equal to |E′e| − fmcmf , where fmcmf denotes the
maximum flow value in Gmcmf .
Proof: Since the maximum flow value fmcmf represents
the maximum number of addressed electrodes, the number
of unaddressed electrodes is equal to |E′e| − fmcmf . As
discussed, each of these unaddressed electrodes necessitates
dedicated control pins due to their mutually incompatibility. To
correctly address these electrodes, the extra pin-count demand
for electrode addressing is equal to |E′e| − fmcmf .
3) Addressing and Routing: The details of the proposed
progressive routing scheme can be presented in Algorithm 2.
As discussed before, our progressive routing scheme divides
the original problem into a set of manageable subproblems
corresponding to each pin-count expansion. In the beginning
of each subproblem s, we first identify an electrode group E′e
11
Figure 15 gives an illustration of the readdressing and
rerouting refinement. In (a), there is one electrode which
cannot be successfully routed because wiring pin 6 and pin
5 has blocked the routing region of this electrode. In the
readdressing and rerouting refinement, we try to select its
neighboring electrodes and then readdressing and rerouting
them by assigning dedicated control pins. As in (b), the
original two electrodes with pin 6 are decomposed into two
separate groups of pin 6 and pin 7 such that the blocking
situation can be removed. Hence, the unroutable electrode in
(a) can now be readdressed by a new pin 8 and successfully
routed.
As many post-refinement techniques in VLSI routing (e.g.,
rip-up and reroute), a means to identify a refinement region
locally is an important consideration. The reason is that
we want to preserve the previously arranged addressing and
routing solution without too much post modification which
always incurs design overhead. Referring to our network-flow
based algorithm, the global routing first constructs a set of
global routing tracks with minimum cardinality. Then, the
progressive routing iteratively completes the addressing and
routing on these tracks. In other words, the entire routing
solution maintains an arrangement orderly expanded from
the constructed global routing tracks. This feature reveals an
efficient refinement procedure based on these global routing
tracks.
Algorithm 3: Readdressing and Rerouting Refinement
Input : An infeasible routing solution with unroutable electrodes
/* tki: a global routing track */
/* ek: a unroutable electrode */
/* e
′
k: a neighboring prerouted electrode of ek */
1 begin
2 foreach global routing track tki do
3 foreach unroutable electrode ek on tki do
4 select neighboring prerouted electrodes e′k of ek;
5 if ek is routable by readdressing and rerouting e′k then
6 readdressing and reroute ek and e′k;
7 end
8 end
9 end
10 end
Output: Arrangement of control pins and wires
Regarding these concerns, the proposed readdressing and
rerouting refinement can be presented in Algorithm 3. First,
we iteratively identify a global routing track tki (line 2).
For each unroutable electrode ek on the track tki, we select
the neighboring prerouted electrodes e′k of ek and try to
readdressing and reroute e′k by a dedicated control pin. Then,
we check the feasibility of such a readdressing and rerouting
refinement and allow it once ek can be readdressed and
rerouted successfully (line 3-8).
V. TIME COMPLEXITY ANALYSIS
The runtime bottleneck of our algorithm comes from the
two network-flow based routing stages, pin-count aware global
routing and progressive routing. Let Ee denote the electrode
set. In the maximum-flow (MF) formulation of global routing
stage, the sizes of node set Vmf and edge set Emf are
O(|Ee|) by referring to the two formulation rules, MF-Rule
#1 and MF-Rule #2. Hence, the global routing problem can be
solved in O(|Ee|2log(|Ee|)) time complexity by implementing
the blocking flow algorithm in [9]. In the minimum-cost
maximum-flow (MCMF) formulation of progressive routing
stage, the sizes of node set Vmcmf and edge set Emcmf
are also O(|Ee|) by referring to the two formulation rules,
MCMF-Rule #1 and MCMF-Rule #2. In solving each MCMF
formulation, the time complexity can be O(|Ee|3) by im-
plementing the MCMF algorithm in [6]. Then, since there
are totally at most |Ee| progressive iterations, the progressive
routing stage can be completed in O(|Ee|4).
Theorem 5: Given an electrode set Ee, the routing problem
of EWOD chips can be solved in O(|Ee|3) time complexity
by the proposed algorithm.
Proof: Based on the previous analysis, the naive examina-
tion of time complexity is O(|Ee|4), which is bounded by the
progressive routing stage. To be more accurate, the progres-
sive routing stage decomposes the electrode set into several
electrode subsets corresponding to each MCMF-network sub-
problem. Suppose each electrode subset is denoted as Eie, then
the time complexity of the progressive routing can be rewritten
as O(Σ|Eie|3). By multinomial theorem [8], the term Σ|Eie|3
is always less than (Σ|Eie|)3. Since in our progressive routing
procedure the electrode subsets are decomposed in a disjoint
manner, thus we have Σ|Eie| = |Ee|. Consequently, we have
a more exact time complexity as O(|Ee|3).
VI. EXPERIMENTAL RESULTS
We implement the proposed algorithm in C++ language
on a 2-GHz 64-bit Linux machine with 16GB memory. We
evaluate our routing algorithm on a set of real-life chip appli-
cations [18], [22], [24] for amino-acid synthesis, protein syn-
thesis, protein dilution, multiplexed assay, and multi-functional
chip, as listed in Table I. To demonstrate our robustness, we
simulate the fluidic-level synthesis in larger scale (e.g., at most
30 droplets and 150 electrodes) and randomly generate 7 hard
test chips, as listed in Table I. For comparison purpose, we
implement the direct addressing with maze routing, denoted as
DA-maze, to independently route each electrode to component
(2D pin array) boundary. To further show the performance of
our integrated routing algorithm, we separately implement the
broadcast addressing and routing, denoted as BA-maze. In BA-
maze, we use the heuristic in [24] as the broadcast-addressing
manner. As discussed in Section III-A, the routing problem
for a broadcast-addressing result is an NP problem (multi-
terminal pins routing). Therefore, we use a heuristic based on
maze routing to sequentially and iteratively route a nearest
electrode pair with the same control pin until all electrodes
are routed.
Table I lists the overall comparison results. First, our algo-
rithm shows better routability by completing all 14 test cases
(100.0%), while the DA-maze and the BA-maze complete
only 7 (50.0%) and 8 (57.1%) test cases, respectively. In
detail, we observe that there is only one case of multi-function
cannot be successfully routed by the major two network-flow
13
routability, and shorter wirelength to realize low-cost and
reliable microfluidic actuators. Experimental results on real-
life chip applications and hard test designs have demonstrated
the robustness, effectiveness, and scalability of our algorithm.
REFERENCES
[1] http://www.ultimatepcb.com/
[2] http://pcdandf.com/cms/home
[3] http://www.siliconbiosystems.com/
[4] http://www.liquid-logic.com
[5] C. J. Alpert, D. P. Mehta, S. S. Sapatnekar, “Handbook of Algorithms for Physical
Design Automation,” CRC Press, 2009.
[6] B. V. Cherkassky, “Efficient algorithms for the maximum flow problem,” Math.
Methods Solut. Econ. Probl., vol. 7, pp. 117–126, 1977.
[7] M. Cho and D. Z. Pan, “BoxRouter: a new global router based on box expansion
and progressive ILP,” Proc. IEEE/ACM DAC, pp. 373–378, 2006.
[8] T. H. Cormen, C. E. Leiserson, R. L. Rivest, and C. Stein, “Introduction to
Algorithms,” Second Edition. MIT Press and McGraw-Hill, 2001.
[9] Y. Dinitz, “Dinitz Algorithm: The Original Version and Even’s Version,” Springer,
pp. 218–240. ISBN 978-3540328803, 2006.
[10] B. S. Gallardo, V. K. Gupta, F. D. Eagerton, L. I. Jong, V. S. Craig, R. R. Shah,
and N. L. Abbott, “Electrochemical principles for active control of liquids on
submillimeter scales,” Science, pp. 57–60, 1999.
[11] J. Gong and C. J. Kim, “Direct-referencing two-dimensional-array digital mi-
crofluidics using multilayer printed circuit board,” IEEE J. MEMS, no. 2, pp.
257–264, 2008.
[12] J. L. Gross, and J. Yellen, “Graph Theory and Its Application,” CRC Press, FL,
1999.
[13] T.-Y. Ho, J. Zeng, and K. Chakrabarty, “Digital microfluidic biochips: A vision
for functional diversity and more than Moore,” IEEE/ACM ICCAD, pp. 578–585,
2010.
[14] T.-W. Huang, S.-Y. Yeh, and T.-Y. Ho, “A network-flow based pin-count aware
routing algorithm for broadcast electrode-addressing EWOD chips,” IEEE/ACM
ICCAD, pp. 425–431, 2010.
[15] D. S. Johnson, “Approximation algorithms for combinatorial problems,” J.
Comput. Syst. Sci., pp. 256–278, 1974.
[16] T. B. Jones, M. Gunji, M. Washizu, and M. J. Feldman, “Dielectrophoretic liquid
actuation and nanodroplet formation,” J. Applied Physics, pp. 1441–1448, 2001.
[17] C. C.-Y. Lin and Y.-W. Chang, “ILP-based pin-count aware design methodology
for microfluidic biochips,” Proc. IEEE/ACM DAC, pp. 258–263, 2009.
[18] R.-W. Liao and T.-H. Yang, “Design and fabrication of biochip for in-situ
protein synthesis,” Master’s Thesis, Department of Optics and Photonics, National
Central University, Taiwan, 2008.
[19] M. G. Pollack, A. D. Shenderov, and R. B. Fair, “Electrowetting-based actuation
of droplets for integrated microfluidics,” LOC, pp. 96–101, 2002.
[20] T. S. Sammarco and M. A. Burns, “Thermocapillary pumping of discrete droplets
in microfabricated analysis devices,” AIChe. Journal, pp. 350–366, 1999.
[21] J. H. Song, R. Evans, Y. Y. Lin, B. N. Hsu, and R. B. Fair, “A scaling
model for electrowetting-on-dielectric microfluidic actuators,” Microfluidics and
Nanofluidics, pp. 75–89, 2009.
[22] F. Su, K. Chakrabarty, and R. B. Fair, “Microfluidics based biochips: Technol-
ogy issues, implementation platforms, and design-automation challenges,” IEEE
Trans. on CAD, pp. 211–223, 2006.
[23] T. Xu and K. Chakrabarty, “Droplet-trace-based array partitioning and a pin
assignment algorithm for the automated design of digital microfluidic biochips,”
Proc. CODES+ISSS, pp. 112–117, 2006.
[24] T. Xu and K. Chakrabarty, “Broadcast electrode-addressing for pin-constrained
multi-functional digital microfluidic biochips,” Proc. IEEE/ACM DAC, pp. 173–
178, 2008.
[25] T. Xu, K. Chakrabarty and V. K. Pamula, “Defect-tolerant design and optimization
of a digital microfluidic biochip for protein crystallization,” IEEE Trans. on CAD,
2010.
 2
心 得 
首先，謝謝國科會計畫可以撥款補助後學出國參加國際會議. 這項補助讓我可以
參加2010年11月在美國聖荷西所舉辦的IEEE/ACM ICCAD (International 
Conference on CAD)，值得一提的是，ICCAD為電子設計自動化領域之最頂尖之
國際會議，能在此會議發表，對台灣具有相當大的貢獻。國科會計畫的補助可以
幫助教師們出國參加會議，提昇自己及學校的國際視野並可以跟許多國外知名學
者或是工程師有接觸的機會，對國內學術界的整體水準有很正面的加分作用。 
今年我所發表的論文是在提出一個由考量針腳限制之數位微流體生物晶片下的
考慮製造度之廣播定址演算法，藉由網路流之完美架構，我們可以有效率的提升
晶片之製造率，達到晶片可靠度的目標。 
這次從ICCAD帶回來的除了會議的論文集之外，還有一本跟積體電路實體設計相
關的書籍。更重要的是，跟那邊的學者有許多接觸的機會。跟他們的討論中，也
激發了許許多多好的想法。重要的是，可以藉此增加人際關係的廣度。更多教師
出國參與國際論文研討會，可推升台灣之國際知名度，對國家與教師而言，是一
項雙贏的計畫。 
 
 
PAPER: 111
TITLE: A Network-Flow Based Pin-Count Aware Routing Algorithm for Broadcast Electrode-Addressing EWOD
Chips
This work proposes a routing algorithm for EWOD chips. The presentation
of the work is very detailed, and the authors have conducted a number
of experiments to compare the proposed approach with other approaches.
It would be good if the authors have also provided some information on
the impact on power consumption of this type of routing.
Also, it is a bit of a concern that the CPU time in the proposed
algorithm is still higher in all cases than the CPU time of other algorithms.
---------------------------- REVIEW 3 --------------------------
PAPER: 111
TITLE: A Network-Flow Based Pin-Count Aware Routing Algorithm for Broadcast Electrode-Addressing EWOD
Chips
This paper describes wire routing of passive EWOD chips in which the number of pins is limited and in which
multiple electrodes may be linked to the same potential, depending on the pattern of liquid flow one wishes to
achieve.   This is a new application of conventional routing algorithms.  Paper seems sound, but applicability
seems quite limited.
---------------------------- REVIEW 4 --------------------------
PAPER: 111
TITLE: A Network-Flow Based Pin-Count Aware Routing Algorithm for Broadcast Electrode-Addressing EWOD
Chips
A Network-Flow Based Pin-Count Aware Routing Algorithm for Broadcast Electrode-Addressing EWOD Chips
This paper presents a pin count aware routing algorithm for EWOD chips with broadcast electrode-addressing
schemes. The authors state this is the first of its kind.
My first thought is that this seems like a fairly limited solution (pin count, electrode-addressing, etc). How
applicable is this to other devices? Moreover, I was not very motivated that pin count reduction is a serious
issue. The introduction seemed to frame this as a cost issue. What is the cost tradeoff?  How much do these
devices even cost? Will this be a problem in 5 years?
This paper has a decent set of benchmarks for a EWOD paper. Also I like the fact that they also randomly
generate 7 hard test chips. As always statistical significance of the data could be questioned.
In the results there seems to be a lack of analysis.   For example I did not see any explanation of why multi-
function failed across the board. Also I did not see why amino-acid 1 and 2 and random had higher WL as
compared to DA-Maze. Also the Pin #s are higher for protein 1 and protein 2 vs. BA-maze. No discussion of this
is provided.
The paper is well written and has top notch diagrams. It is clear that it is well thought out and thorough. The
question will be how useful a problem this is to solve….
---------------------------- REVIEW 5 --------------------------
PAPER: 111
TITLE: A Network-Flow Based Pin-Count Aware Routing Algorithm for Broadcast Electrode-Addressing EWOD
Gmail - ICCAD2010 notification for paper 111 https://mail.google.com/mail/?ui=2&ik=c7c2cc9895&view=pt&q=icc...
2／3 2011/10/28 下午 04:20
A Network-Flow Based Pin-Count Aware Routing Algorithm
for Broadcast Electrode-Addressing EWOD Chips
Tsung-Wei Huang, Shih-Yuan Yeh, and Tsung-Yi Ho∗
Department of Computer Science and Information Engineering
National Cheng Kung University, Tainan, Taiwan
ABSTRACT
Electrowetting-on-dielectric (EWOD) chips have emerged as the most
widely used actuators for digital microfluidic (DMF) systems. These
devices enable the electrical manipulation of microfluidics with various
advantages such as low power consumption, flexibility, accuracy, and
efficiency. In addressing the need for low-cost and practical fabrication,
pin-count reduction has become a key problem to the large-scale inte-
gration of EWOD-chip designs. One of the major approaches, broad-
cast addressing, reduces the pin count by assigning a single control
pin to multiple electrodes with mutually compatible control signals.
Most previous studies utilize this addressing scheme by scheduling
fluidic-level synthesis on pin-constrained chip arrays. However, the
associated interconnect routing problem is still not provided in cur-
rently available DMF automations, and thus the broadcast-addressing
scheme cannot be actually realized. In this paper, we present the first
network-flow based pin-count aware routing algorithm for EWOD-chip
designs with a broadcast electrode-addressing scheme. Our algorithm
simultaneously takes pin-count reduction and wirelength minimiza-
tion into consideration for higher integration and better design perfor-
mance. Experimental results show the effectiveness and scalability of
our algorithm on a set of real-life chip applications.
1. INTRODUCTION
Due to the principle of electrowetting-on-dielectric (EWOD), the
EWOD chip has been appreciated as a promising actuator for digital
microfluidic (DMF) systems [11, 12, 13]. This chip enables the elec-
trical manipulation of discrete fluidics (i.e., droplets) with low power
consumption, flexibility, and efficiency. Furthermore, their capabil-
ity of automatic and parallel controls offers faster and more precise
execution. These advantages increase the practicality of applications
including immunoassays, DNA sequencing, and point-of-care diagnosis
on miniaturized DMF systems with lower cost, less reagent consump-
tion, and higher immunity to human error.
Electrode
Conduction 
wires 
Electrical pads
Substrate
2D pin array
Pin
(a)
(b)
Figure 1: (a) Schematic view of an EWOD chip. (b) Routing
model on a 2D pin array.
As schematically presented in Figure 1(a), the general diagram
of a two-dimensional (2D) EWOD chip contains a patterned elec-
trode array, conduction wires, electrical pads, and a substrate [6,
12, 13]. Through these electrical devices, external control circuits
can drive these electrodes by assigning time-varying actuation volt-
age. Thus, by generating electrohydrodynamic force from electrodes,
many fluidic-level controls can be performed due to the electrowetting
phenomenon [11].
To correctly drive the electrodes, electrode addressing is introduced
as a method through which electrodes are assigned or controlled by
∗This work was partially supported by the National Science Council
of Taiwan ROC under Grant No. NSC 98-2220-E-006-013.
pins to identify input signals. Early EWOD-chip designs relied on di-
rect addressing [6], where each electrode is directly and independently
assigned by a dedicated control pin. This addressing maximizes the
flexibility of electrode controls. However, for large arrays, the high pin-
count demand complicates the electrical connections, thus rendering
this kind of chip unreliable and prohibitively expensive to manufac-
ture [15, 16].
Recently, pin-constrained design has been raised as a possible solu-
tion to this problem. One of the major approaches, broadcast address-
ing, reduces the number of control pins by assigning a single control pin
to multiple electrodes with mutually compatible control signals [15].
In other words, multiple electrodes are controlled by a single control
signal and are thus driven simultaneously. In this regard, much on-
going effort has been made to group sets of electrodes that can be
driven uniformly without introducing signal conflict [14, 15].
For electrical connections, conduction wires must be routed from the
topside electrode array, through the underlying substrate, to the sur-
rounding pads. Hence, after the electrodes are addressed with control
pins, the routing problem for EWOD chips can be specified to a 2D
pin array, while establishing correspondence between control pins and
pads (see Figure 1(b)). However, this routing issue is still not readily
available among automations for EWOD chips, revealing an insuffi-
ciency of current DMF design tools. Due to the specialized electrode
structure and control mechanism, it is desirable to develop a dedicated
routing algorithm for EWOD chips, especially given the issue of the
pin-constrained design.
1 4
2
5
3
3
4
2
5
1
5 2
1 1
2 2
35 3 2
4 4
5 5
Conduction wire
Control pin
(a) Infeasible routig solution (b) Feasible routing solution
Crossing wire
Figure 2: Comparison of two different design methods for per-
forming the same fluidic controls. (a) Considers electrode ad-
dressing and routing separately. (b) Considers electrode address-
ing and routing simultaneously.
Furthermore, if routing is simply adopted to an electrode-addressing
result, the feasibility and quality of routing solutions may inevitably be
limited. For example, Figure 2 illustrates two routing solutions under
two different design methods that perform the same fluidic controls.
In (a), the separate consideration of electrode addressing and routing
results in many back detours for pins 3-4, and thus blocks the rout-
ing for pin 5. On the other hand, in (b), simultaneous consideration
of electrode addressing and routing provides a higher feasibility and
quality routing solution in terms of routability and wirelength. In the
case of (a), additional post processes such as electrode readdressing
and rerouting should be further included, and thus the effectiveness of
the entire design may be quite restricted.
Given these concerns, it is necessary to develop an integrated design
automation to assist in these practical design issues. Consequently,
we propose in this paper a pin-count aware routing algorithm that
simultaneously considers electrode addressing and routing to achieve
greater design flexibility and higher design performance.
1.1 Previous Work
To the best knowledge of the authors, there is no previous work in
the literature that provides a general pin-count aware routing algo-
5. This reduction requires fewer electrical devices and connections to
perform the same fluidic functions, thus improving chip reliability and
reducing fabrication cost [15, 16]. Therefore, the derivation of a cor-
rect electrode-addressing result under the pin-constrained issue is of
great importance, especially in the DMF marketplace.
3. PIN-CONSTRAINED CHIP DESIGN
This section first points out the difficulties and challenges for pin-
constrained chip designs. Then, the practical constraints for broadcast
addressing and routing are introduced. Finally, we formulate the de-
sign problem for EWOD chips.
3.1 Design Challenges
Typically, pin-constrained chip design consists of two major stages:
(1) broadcast-addressing stage and (2) routing stage. In the broadcast-
addressing stage, the major goal is to correctly address the electrodes
with low pin-count demand. To this end, electrode grouping is in-
troduced such that for all electrodes in any group, the corresponding
activation sequences are mutually compatible. To specify this manner,
a compatibility graph is constructed [15], where the vertex set repre-
sents the electrode set and an edge between two electrodes indicates
their corresponding activation sequences are compatible. For exam-
ple, Figure 5(a) demonstrates a compatibility graph Gc derived from
Figure 4(b). Based on the compatibility graph, the electrode grouping
can be mapped to the clique partition problem, which is a well-known
example of an intractable problem in graph theory. Since each clique
represents an electrode group with mutually compatible control sig-
nals, we can individually assign each clique with a dedicated control
pin. Accordingly, by recognizing a minimum clique partition in the
compatibility graph, the required number of control pins can be op-
timally minimized. However, the general minimum clique partition is
known to be NP-hard [7] and thus is computationally expensive.
e1e3 e11
Result 1 Result 2Pin
Two electrode grouping results
e5 e6e9
  
1 e1, e10 e1, e2
2 e3, e8, e12 e3, e4, e8
e7e8 e10 3 e6, e7 e6, e7
4 e2, e9 e9, e10
e2e4 e12
(a)
5 e4, e5, e11 e5, e11, e12
(b)
Figure 5: (a) A compatibility graph Gc derived from Figure
4(b). (b) Two possible electrode grouping results.
After addressing, in the routing stage, wires must be appropriately
routed to establish the correspondence between the control pins and
the surrounding pads while minimizing the total wirelength. Hence,
the routing problem for EWOD chips is similar to the typical escape
routing, in which the objective is to individually route all terminal
pins to the component (defined as 2D pin array) boundaries. How-
ever, in pin-constrained chip design, multiple electrodes may share
the same control pin for pin-count reduction. In other words, a single
signal source may contain multi-terminal pins. To realize the electri-
cal connections, multi-terminal pins with the same control signal must
first be wired together, and then escape to the component boundaries.
This feature makes the typical two-pin-net based escape router unsuit-
able for the routing problem in EWOD chips. Therefore, a specialized
escape routing algorithm must be developed to tackle this problem.
Unfortunately, even simply routing for multi-terminal pins with min-
imum wirelength is also well-known to be NP-complete in most VLSI
routing problems [4].
Although a number of heuristics and approximations can separately
cope with the two design stages, the potential gap may result in an
unsolvable routing problem. As discussed in Section 1, separate ad-
dressing and routing suffers from an infeasible routing solution, while
the simultaneous method provides a higher-quality one (see Figure 2).
The essence of this problem is that the clique partition is not unique
and thus multiple electrode grouping results exist. To clarify these
points, Figure 5(b) illustrates the corresponding electrode groups and
addressing results of Figure 2 (result 1 for (a), and result 2 for (b)).
Consequently, to achieve higher design performance, it is necessary to
develop an integrated automation for pin-constrained designs. In this
regard, the complexity resulting from the multi-objective minimiza-
tion of pin count and wirelength has become the most difficult design
challenge.
3.2 Broadcast Constraints
As discussed in Section 2.2: if a single control pin is assigned to an
electrode set, all the corresponding activation sequences of these elec-
trodes must be mutually compatible. Therefore, broadcast constraints
(BC for short) can be formulated as the two following rules:
BC-Rule #1: Given an electrode set, if the corresponding acti-
vation sequences are mutually compatible, this electrode set can be
addressed with the same control pin or not;
BC-Rule #2: Given an electrode set, if the corresponding activa-
tion sequences are not mutually compatible, this electrode set cannot
be addressed with the same control pin.
3.3 Routing Constraints
Practically, the wiring connections and media substrate can be formed
by using typical integrated circuit (IC) fabrication methods, or exist-
ing printed circuit board (PCB) manufacturing processes [3, 6]. In the
IC industry, fabrication methods typically rely on thin film planar and
photolithography, while the manufacturing processes of PCB are based
on electroplating and multi-layer lamination [6]. Due to the distinct
natures of these technologies, the different wiring criteria involve a
variety of routing requirements and constraints. A primary difference
is the wiring structures between the two technologies. In PCB-based
manufacturing processes, wires can be routed in any angle or even in a
rounded manner [1, 2], while the IC-based counterparts restrict most
routing to be orthogonal. Thus, without loss of generality, we focus
on orthogonal routing such that the horizontal and vertical properties
can be realized in both IC-based and PCB-based technologies.
1.5mm
1.5m
m
(a) (b)
Figure 6: Number of wires between adjacent pins is 3. (a) Pin
array. (b) Grid model.
Another significant consideration is the avoidance of electrical de-
fects (e.g., shorts) caused by the shrinkage of wiring clearance. To pre-
vent these faults, the spacing between wires must maintain a threshold;
specifically, only a limited number of wires can pass through adjacent
pins. Since the capacity between adjacent pins varies with the required
electrode size for different bio-applications, it can thus be customized.
In this paper, we use the real specification in [6] such that the max-
imum number of wires between adjacent pins is 3. As in most VLSI
routing problems, we focus on uniform grid structure for flexibility
and generality. Figure 6 exemplifies these concerns.
In addition, a multi-layer arrangement of electrical connections ne-
cessitates a mechanism for passing signals between layers (e.g., vias
and contacts), raising a cost issue in both IC-based or PCB-based fab-
rication. For example, the cost of PCB prototype fabrication with one,
two, four and six layers is respectively US$8.99, US$12.99, US$34.99
and US$59.99, resulting in expenses which increase exponentially with
additional layers [1]. Since many biomedical applications prefer dis-
posability, it is likely that using multi-layered chips is prohibitively
expensive and thus undesirable. Therefore, in this paper, we focus on
single-layer routing.
3.4 Problem Formulation
The pin-constrained design problem for an EWOD chip can be for-
mulated as follows.
Input: A set Ee of used electrodes for fluidic controls, control in-
formation of electrodes in the form of activation sequences, and chip
specification.
Constraint: Both broadcast constraints and routing constraints should
be satisfied.
Objective: Derive an electrode-addressing result and establish a rout-
ing solution, while minimizing the required control pins and wire-
length.
4. ALGORITHM
In this section, we present our pin-count aware routing algorithm.
We first discuss the electrode grouping method used in our routing
algorithm. Then, the pin-count aware global routing and progressive
routing scheme are respectively detailed.
For the purpose of readability and clarity, we use a real-life chip
application to exemplify each phase of the proposed algorithm. As
illustrated in Figure 7(a), the chip for DMF based amino acid synthesis
contains two types of droplets, functional droplets and wash droplets.
The functional droplets (i.e., leucine, phenylalanine, and piperidine
droplets) are used for amino acid synthesis, while the wash droplets are
used for cleaning contaminations left behind on the surface, to avoid
erroneous reaction outcomes. More details can be referred to [10].
4.1 Electrode Grouping Method
To solve the construction problem for global routing tracks, we con-
struct a maximum-flow (MF) graph Gmf = (Vmf , Emf ) and propose
two formulation rules. The first rule describes the formulation of Vmf ,
and the second rule describes the formulation of Emf . The details of
the two MF formulations rules are as follows.
MF-Rule #1: Formulation of Vmf
1. For each row i in the 2D pin array, create a node ri.
2. For each column j in the 2D pin array, create a node cj .
3. Create a source node s and a sink node t.
MF-Rule #2: Formulation of Vmf
1. For each node ri, create a directed edge s → ri with one unit
capacity.
2. For each electrode ek ∈ Ee at row i and column j on the 2D pin
array, create a directed edge ri → cj with infinite capacity.
3. For each node cj , create a directed edge cj → t with one unit
capacity.
s
c1
r1
r2
r3
r4
r5
r6
c2
c3
c4
c5
c6
c7
c8
t
Capacity = 1 Capacity = ∞ Capacity = 1
Nodes for global 
routing tracks
Minimun s-t cut [S, T]
Figure 10: Example of the maximum-flow based global routing
tracks construction for Figure 7(b).
As the example in Figure 7(b), there is a 2D pin array with 6 rows
and 8 columns, and 20 electrodes used for fluidic controls. By imple-
menting the two formulation rules, the entire flow network Gmf can be
constructed as illustrated in Figure 10. Based on the two formulation
rules, two theorems can be derived as follows.
Theorem 1. A minimum s-t cut in the flow graph Gmf , denoted
as [S, T ], contains no edge ri → cj .
Theorem 2. The optimal number of global routing tracks is equal
to the total of the capacities on the edge set [S, T ] in Gmf .
In duality theorem, a maximum s-t flow value is equal to the min-
imum capacity of an s-t cut. Therefore, by deriving a maximum flow
in Gmf , the minimum s-t cut [S, T ] can be obtained. Then, based
on the two theorems, the global routing tracks can be optimally con-
structed by tracing the corresponding rows and columns of the node
set V[S,T ] − {s, t}, where V[S,T ] denotes the node set of [S, T ].
As shown in Figure 10, after deriving a maximum s-t flow, the red-
dash arrows represent the edge set of a minimum s-t cut [S, T ], and the
node set V[S,T ]−{s, t} is {r3, r4, c3, c6}. By tracing the corresponding
rows and columns in the 2D pin array, the global routing tracks can
be constructed as illustrated in Figure 7(b).
4.2.3 Addressing and Routing
We use Figure 7(b)-(c) to exemplify our pin-count aware global rout-
ing. By deriving a maximum-flow (MF) formulation with the duality
of min-cut property, the global routing tracks are constructed on row
3, row 4, column 3, and column 6, as presented in Figure 7(b). Based
on the addressing and routing properties introduced in Figure 8, we
iteratively select a global routing track with the largest non-conflicting
electrode group on this track, and assign a dedicated control pin to
this group, followed by guiding a horizontal/vertical wire to route these
electrodes together, as shown in (b). In case of a crossing point, we
identify the smallest electrode group and decompose it for readdress-
ing and rerouting. For example, in (b), the routing for control pin 3
crosses the prerouted wire of control pin 1. Since our router tends to
maximize the number of electrodes to share the same control pin, the
smaller electrode group on column 3 (pin 3) is thus chosen to be de-
composed for readdressing and rerouting. Finally, following pin-count
aware global routing, an initial arrangement of control pins and wires
can be obtained as illustrated in (c).
4.3 Progressive Routing Scheme
Although the pin-count aware global routing presented in the pre-
vious section can derive an electrode addressing and routing result,
some electrodes may still not be addressed (see Figure 7(c)). Hence,
in this routing stage, the major goal is to deal with these unaddressed
electrodes left behind, while minimizing the increase of pin count and
wirelength.
Motivated from [5], we present a progressive routing scheme based
on pin-count expansion initiated from our global routing. The main
idea is to divide the original problem into a set of manageable sub-
problems corresponding to each pin-count expansion. After every ex-
pansion, the entire electrode set is decomposed into two subsets, an
unaddressed electrode set and an addressed electrode set. Our routing
algorithm uses a network-flow based strategy to efficiently determine
the minimum pin-count expansion for electrode addressing and rout-
ing between the two subsets. Then, the pin count is progressively and
appropriately expanded until all electrodes are addressed and routed.
P0
e1
e2
e3
e4
e5
e6
e7
e8
e9
e10 P1
e1
e2
e3
e4
e5
e6
e7
e8
e9
e10 P2
e1
e2
e3
e4
e5
e6
e7
e8
e9
e10
(a) (b) Subproblem 1 (c) Subproblem 2
Unaddressed electrode set
Addressed electrode set Pin-count expansion
Ps : Set of available control pins in subproblem s
Figure 11: The basic concept of our progressive routing scheme.
The overall idea can be illustrated in Figure 11. (a) shows the set
of available control pins initiated from our global routing, with an
addressed electrode set and an unaddressed electrode set. For each
subproblem, the pin count is minimally expanded for electrode ad-
dressing and routing as shown in (b). Finally, expansion ends when
all electrodes are addressed (see (c)). Our progressive routing scheme
offers three major advantages as follows.
1. Instead of directly solving the original problem, we focus on each
manageably-sized subproblem thereby significantly reducing the
entire design complexity.
2. By formulating the electrode addressing and routing into a flow
network, the expansion of pin count can be minimally deter-
mined.
3. Our progressive routing also preserves the pre-scheduled ad-
dressing and routing result for successive expansions, without
numerous modifications such as readdressing and rerouting.
4.3.1 Modeling the Pin-Count Expansion
The major challenge in our progressive routing scheme is to formu-
late the problem of pin-count expansion. The essence of pin-count
expansion describes the concept of extra pin-count demand to realize
the electrode addressing and routing for each subproblem s. However,
to avoid pin-count overhead, the expansion size must be minimized.
Hence, the means by which the set of available control pins in subprob-
lem s, denoted as Ps, can be utilized is the major concern in modeling
the pin-count expansion.
One of the difficulties in each subproblem s is to identify an unad-
dressed electrode set for addressing and routing. The difficulty is the
potential interference between grouping unaddressed electrodes with
addressed ones without violating broadcast constraints. For exam-
ple, as depicted in Figure 12(a), if we directly solve all the addressing
and routing problems between the addressed and unaddressed elec-
trode sets, much of the compatibility needs to be examined for broad-
cast constraints and thus is computationally expensive. To tackle this
problem, we reverse the regular electrode grouping method. Specif-
ically, we identify a maximum unaddressed electrode group, denoted
as E′e, with mutually incompatible, rather than compatible, control
signals. As demonstrated in Figure 12(b), this strategy achieves a sig-
nificant reduction of complexity attributed to the omission of grouping
considerations inside E′e. In this manner, the addressing and routing
problems can be regarded as a one-to-one matching determination
between the two sets E′e and Ps.
After an unaddressed electrode group E′e is identified, the major
goal is to appropriately schedule an electrode addressing and routing
result. Since all electrodes ek ∈ E′e must be independently addressed,
unaddressed electrodes necessitate extra pin-count demand, implying
a pin-count expansion. In order to avoid pin-count overhead, it is
desirable to maximize the number of addressed electrodes by utilizing
the existing control pins p ∈ Ps such that the pin-count expansion can
be minimized. Furthermore, the associated routing wirelength needs
to be minimized. Consequently, for each subproblem s, the problem
of pin-count expansion can be formulated as follows.
TABLE I: COMPARISON BETWEEN THE DA-MAZE, THE BA-MAZE, AND OUR ALGORITHM
Chip Size #E
Direct addressing Broadcast addressing
DA-maze BA-maze Ours
#Pin
WL
(#Grid)
#Fail
CPU
time
(sec.)
#Pin
WL
(#Grid)
#Fail
CPU
time
(sec.)
#Pin
WL
(#Grid)
#Fail
CPU
time
(sec.)
amino-acid-1 6× 8 20 20 156 0 0.02 13 254 0 0.03 9 190 0 0.08
amino-acid-2 8× 8 24 24 168 0 0.04 16 236 0 0.05 11 207 0 0.11
protein-1 13× 13 34 - - 1 - 19 814 0 0.43 24 462 0 0.26
protein-2 13× 13 52 - - 3 - 21 898 0 0.16 25 662 0 0.28
dilution 15× 15 54 - - 1 - - - 7 - 15 1178 0 0.17
multiplex 15× 15 59 - - 1 - - - 7 - 36 1444 0 0.36
multi-function 15× 15 81 - - 7 - - - 11 - - - 8 -
random-1 10× 10 20 20 281 0 0.01 14 353 0 0.02 8 278 0 0.04
random-2 15× 15 30 30 560 0 0.04 18 1053 0 0.05 11 614 0 0.10
random-3 20× 20 60 - - 1 - 23 4678 0 0.18 19 2720 0 0.31
random-4 30× 30 90 90 8924 0 0.33 31 8558 0 0.37 26 5975 0 0.48
random-5 50× 50 100 100 10945 0 1.19 - - 23 - 37 7965 0 1.53
random-6 60× 60 100 100 11344 0 1.48 - - 27 - 41 8901 0 2.23
random-7 70× 70 150 - - 22 - - - 31 - 80 16612 0 6.65
Total 36 106 8
#E: Number of used electrodes for fluidic controls. #Pin: Number of used control pins for electrode addressing.
#Fail: Number of failed electrodes (unable to find a valid addressing and routing manner).
WL: Total wirelength computed by the number of routing grids.
TABLE II: COMPARISON BETWEEN THE DA-MAZE AND OUR
ALGORITHM
Chip
DA-maze Ours
#Pin
WL
(#Grid)
CPU
time
(sec.)
#Pin
WL
(#Grid)
CPU
time
(sec.)
amino-acid-1 20 156 0.02 9 190 0.08
amino-acid-2 24 168 0.04 11 207 0.11
random-1 20 281 0.01 8 278 0.04
random-2 30 560 0.04 11 614 0.10
random-4 90 8924 0.33 26 5975 0.48
random-5 100 10945 1.19 37 7965 1.53
random-6 100 11344 1.48 41 8901 2.23
Total 384 32378 3.11 143 24130 4.57
TABLE III: COMPARISON BETWEEN THE BA-MAZE AND OUR
ALGORITHM
Chip
BA-maze Ours
#Pin
WL
(#Grid)
CPU
time
(sec.)
#Pin
WL
(#Grid)
CPU
time
(sec.)
amino-acid-1 13 254 0.03 9 190 0.08
amino-acid-2 16 236 0.05 11 207 0.11
protein-1 19 814 0.43 24 462 0.26
protein-2 21 898 0.16 25 662 0.28
random-1 14 353 0.02 8 278 0.04
random-2 18 1053 0.05 11 614 0.10
random-3 23 4678 0.18 19 2720 0.31
random-4 31 8558 0.37 26 5975 0.48
Total 155 16844 1.29 133 11108 1.66
Since the number of failed designs is different, it is hard to fairly
perform a direct comparison between the two methods and ours in
terms of pin count, wirelength, and runtime. Therefore, we focus on
these chips which are completed by both our method and another
approach as listed in Tables II and III. In the first comparison with
DA-maze, Table II shows that our algorithm achieves 62.8% pin-count
reduction and produce 25.5% shorter wirelength, with the reasonable
CPU time. Compared with direct addressing, this result shows that
the broadcast addressing requires only a small number of control pins
to perform the same fluidic functions. Moreover, without complicated
wiring connections, the system reliability and fabrication process can
be significantly improved.
In the second comparison, we compare our integrated method with
BA-maze which is based on separate broadcast addressing and routing,
respectively in terms of pin count, wirelength, and runtime. As listed
in Table III, we reduce the pin count by 14.2%, and shorten the wire-
length by 34.1% with small increase of CPU time. By simultaneously
considering the pin-count reduction and wirelength minimization, our
method can effectively achieve greater design performance and higher-
level integration.
6. CONCLUSION
In this paper, we have proposed the first pin-count aware routing
algorithm to deal with the routing problem on broadcast electrode-
addressing EWOD chips. Based on two kinds of flow formulations,
maximum-flow network and minimum-cost maximum-flow network,
the electrode addressing and routing problems can be correctly and
effectively solved. By comprehensively integrating various pin-count
saving issues into our routing, our router can lead to a superior ad-
dressing and routing solution with lower pin count, higher routability,
and shorter wirelength to realize low-cost and reliable microfluidic ac-
tuators. Experimental results on real-life chip applications and hard
test designs have demonstrated the robustness and scalability of our
algorithm.
7. REFERENCES
[1] http://www.ultimatepcb.com/
[2] http://pcdandf.com/cms/home
[3] http://www.siliconbiosystems.com/
[4] C. J. Alpert, D. P. Mehta, S. S. Sapatnekar, “Handbook of
Algorithms for Physical Design Automation,” CRC Press, 2009.
[5] M. Cho and D. Z. Pan, “BoxRouter: a new global router based on
box expansion and progressive ILP,” Proc. ACM/IEEE DAC, pp.
373–378, 2006.
[6] J. Gong and C. J. Kim, “Direct-referencing two-dimensional-array
digital microfluidics using multilayer printed circuit board,” IEEE
J. MEMS, no. 2, pp. 257–264, 2008.
[7] J. L. Gross, and J. Yellen, “Graph Theory and Its Application,”
CRC Press, FL, 1999.
[8] D. S. Johnson, “Approximation algorithms for combinatorial
problems,” J. Comput. Syst. Sci., pp. 256–278, 1974.
[9] C. C.-Y. Lin and Y.-W. Chang, “ILP-based pin-count aware design
methodology for microfluidic biochips,” Proc. ACM/IEEE DAC,
pp. 258–263, 2009.
[10] R.-W. Liao and T.-H. Yang, “Design and fabrication of biochip for
in-situ protein synthesis,” Master’s Thesis, Department of Optics
and Photonics, National Central University, Taiwan, 2008.
[11] M. G. Pollack, A. D. Shenderov, and R. B. Fair,
“Electrowetting-based actuation of droplets for integrated
microfluidics,” LOC, pp. 96–101, 2002.
[12] J. H. Song, R. Evans, Y. Y. Lin, B. N. Hsu, and R. B. Fair, “A
scaling model for electrowetting-on-dielectric microfluidic
actuators,” Microfluidics and Nanofluidics, pp. 75–89, 2009.
[13] F. Su, K. Chakrabarty, and R. B. Fair, “Microfluidics based
biochips: Technology issues, implementation platforms, and
design-automation challenges,” IEEE Trans. on CAD, vol. 25, pp.
211–223, 2006.
[14] T. Xu and K. Chakrabarty, “Droplet-trace-based array partitioning
and a pin assignment algorithm for the automated design of digital
microfluidic biochips,” Proc. CODES+ISSS, pp. 112–117, 2006.
[15] T. Xu and K. Chakrabarty, “Broadcast electrode-addressing for
pin-constrained multi-functional digital microfluidic biochips,”
Proc. ACM/IEEE DAC, pp. 173–178, 2008.
[16] T. Xu, K. Chakrabarty and V. K. Pamula, “Defect-tolerant design
and optimization of a digital microfluidic biochip for protein
crystallization,” IEEE Trans. on CAD, vol. 29, pp. 552–565, 2010.
99 年度專題研究計畫研究成果彙整表 
計畫主持人：何宗易 計畫編號：99-2220-E-006-005- 
計畫名稱：應用於細胞老化程度監測和疾病預防之居家型單晶片系統--子計畫四：應用於細胞老化程
度監測和疾病預防之微機電設計自動化工具(3/3) 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 1 0 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 3 0 100%  
博士生 1 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 2 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 10 0 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
國科會補助專題研究計畫成果報告自評表 
請就研究內容與原計畫相符程度、達成預期目標情況、研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）、是否適
合在學術期刊發表或申請專利、主要發現或其他有關價值等，作一綜合評估。
1. 請就研究內容與原計畫相符程度、達成預期目標情況作一綜合評估 
■達成目標 
□未達成目標（請說明，以 100 字為限） 
□實驗失敗 
□因故實驗中斷 
□其他原因 
說明： 
2. 研究成果在學術期刊發表或申請專利等情形： 
論文：■已發表 □未發表之文稿 □撰寫中 □無 
專利：□已獲得 □申請中 ■無 
技轉：□已技轉 □洽談中 ■無 
其他：（以 100 字為限） 
T.-W. Huang and T.-Y. Ho, ’’A Two-Stage ILP-Based Droplet Routing Algorithm for 
Pin-Constrained Digital Microfluidic Biochips,’’ IEEE Transactions on 
Computer-Aided Design of Integrated Circuits and Systems (IEEE TCAD), vol. 30, no. 
2, pp. 215-228, February 2011. 
 
3. 請依學術成就、技術創新、社會影響等方面，評估研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）（以
500 字為限） 
後學藉由電子設計自動化的技術來作全面性的考量及最佳化。目前研究成果相當傑出，部
分結果已發表於電子設計自動化領域最頂尖的國際會議 IEEE/ACM International 
Conference on Computer Aided Design (ICCAD)(4篇，已連續三年發表)與ACM/IEEE Design 
Automation Conference (DAC) (1 篇)及頂尖期刊 IEEE Transactions on Computer-Aided 
Design of Integrated Circuits and Systems (TCAD) (3 篇)。 
 
由於後學在此研究領域的傑出表現，不但分別在 2010 年 IEEE/ACM ICCAD 及 2011 年
ACM/IEEE CODES+ISSS 擔任 Tutorial Speaker，也分別在 2011 年的 IEEE MWSCAS、IEEE SOCC
及 ACM CASES 擔任 Special Session 的 Organizer。對於提升我國在此研究領域的國際地
位，具有極重要的貢獻。此外，後學也分別於 2009 年 9 月、2010 年 7 月及 2011 年 2 月受
邀至日本北九州大學(Kitatkyushu University)、京都大學(Kyoto University)及杜克大
學(Duke University)演講數位微流體晶片上之液珠繞線演算法，以及擔任 ACM SIGDA 
CADAthlon 國際程式設計比賽中 BioEDA 分項題目的出題委員(為台灣首位學者受此殊榮
者)。 
