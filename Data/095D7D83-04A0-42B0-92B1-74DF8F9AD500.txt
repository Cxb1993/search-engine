整合可規劃硬體於功因修正電路模組之晶片
化控制器設計與實現 
 
摘要-本計劃提出一針對升壓型切換式整流器電路之
新型控制方式，無須感測電流，即可達到輸入電流波形修
飾且高功率因素控制，並且於數位信號處理器為主之系統
上加以實現驗證。此控制架構除電壓迴路以外，尚包含有
兩個分別補償電阻壓降與開關導通壓降之補償迴路，使電
流波形更加接近弦波。與傳統上使用內電流迴路、外電壓
迴路之多迴路控制架構，所提出之無感測控制，只有一個
電壓迴路，藉以調整責任周期比信號之相位，便能達到傳
統多迴路之控制目的。 
Abstract- In this project, the single-loop current 
sensorless controls (SLCSC) for single-phase boost-type 
switching-mode-rectifiers (SMRs) are developed and 
digitally implemented in DSP-based system. Compared to 
the conventional multi-loop control with one inner 
current loop and one outer voltage loop, there is only one 
voltage loop in the proposed SLCSCs where its output is 
used to shift the nominal duty ratio pattern generated 
from the sensed input and output voltage. Because of no 
current loop, the efforts of sampling and tracking 
inductor current are unnecessary. It implies that the 
proposed SLCSCs are simple and very adaptable to the 
implementation with mixed-signal integrated circuits. It is 
also noted that the proposed SLCSCs are operated at 
continuous-current-mode (CCM). In this project, first, 
the effects of shifting nominal duty ratio pattern on the 
input current waveform are analyzed and modeled with 
considering the inductor resistance and conduction 
voltages. It shows that the aligned current waveform can 
be inherently generated by the nominal duty ratio pattern 
and the current amplitude is roughly proportional to the 
shifting phase of nominal duty ratio pattern. Then, a 
voltage controller is included to regulate the dc output 
voltage by tuning this controllable phase. Finally, some 
simulated and experimental results have been given to 
demonstrate the performances of the proposed SLCSCs. 
I. INTRODUCTION 
In DC/DC conversion, we often put close attentions 
on the performance of output voltage regulation. 
Alternatively, we are interested in the performances of 
input current shaping and output voltage regulation in 
the qualified AC/DC conversion. The use of 
switching-mode-rectifier (SMR) [1-3] with PFC 
function is an effective mean to perform the qualified 
AC/DC conversion. Boost-type SMRs as shown in Fig. 
1 are the most popular circuit topology among all the 
others to shape the current waveform for their 
continuous current in the boost inductors. 
 
 L
sv
D
SW
dC
Load
Li
dVsv
di loadIsP
si
dP
ci
 
Fig. 1. Power circuit of the boost-type SMR. 
 
Since there is only one controllable power switch in 
the boost-type SMR, both desired functions including 
input current shaping and output voltage regulation 
must be met by adequately turning on and turning off 
the single switch. In the conventional multi-loop 
control as shown in Fig. 2, the inner current loop and 
the outer voltage loop work together to achieve both 
desired functions by controlling the single switch 
where the former loop focuses on input current shaping 
and the latter loop contributes to voltage regulation, 
respectively.  
 
 
Voltage
controller
Σ
dV
*
dV sIˆ Σ
*
Li
Li
Current
controller
contv
)(td
vε iε)(sGcv )(sGci
triv)( ts ω 0
1
Comparator
 
Fig. 2. Conventional multi-loop control for boost-type SMRs in 
CCM. 
 
In order to perform the conventional multi-loop 
control, we need to sense three signals including input 
voltage, output voltage and input current. It is noted 
that the current sampling rate set according to the 
switching frequency is considerably greater than the 
voltage sampling rate decided based on the input line 
frequency. For single-phase boost-type SMRs, many 
voltage sensorless controls [4-5,7-9] and current 
sensorless controls [6-7] had been proposed in 
literatures in order to reduce the total number of input 
signals.  
From the view of control structure, those sensorless 
control methods can be divided into two categories: 
one is multi-loop sensorless control and the other is 
single-loop sensorless control. Since there is only one 
voltage loop in the latter category, they can be seen as 
voltage-mode control and therefore, the former 
category can be regarded as current-mode sensorless 
control for their inner current loop.  
In the boost-type SMR, the rising rate of current is 
proportional to the input voltage and the falling rate is 
proportional to voltage difference between the output 
voltage and input voltage. The above relations are used 
in the multi-loop sensorless control methods [4-6]. The 
input voltage in [4] is reconstructed from the rising rate 
of inductor current. The output voltages in [4-5] are 
estimated from the falling rate of the available inductor 
current. In [6], the current is predicted from duty ratio, 
the sensed input and output voltage.  
It is noted that at least two current samplings within 
the durations of rising current or falling current must be 
obtained in order to calculate the time rate of change of 
current in [4-5]. In the multi-loop current sensorless 
control in [6], the actual voltage sampling frequency 
must be increased to the level of switching frequency 
duty signal  of SLCSC is also generated from the 
comparison between the fixed triangle signal tri  and 
the control signal cont . However, it is noted that the 
control signal cont  of SLCSC is at (-) terminal, and 
the fixed triangle signal tri  is at (+) terminal. Besides, 
compared with the current magnitude s  at the output 
of voltage controller in Fig. 2, the output of voltage 
controller in proposed SLCSC is the controllable phase 
)(td
v
v
v
v
Iˆ
θ . 
 
Voltage
controller
Σ
dv
*
dV θ )( θω −tsvε )(sGcv
icontv ,
)( ts ω
ΣPhaseshifter
)(td
triv
*
d
L
V
r
*
ˆ
d
s
V
V
contv
θ,contv
sIˆ
L
Vs
ω
ˆ Li
~
vcontv ,
*
3
d
F
V
V
 
Fig. 4. Proposed SLCSC for boost-type SMRs. 
 
The control signal cont  in SLCSC composes of 
three signals and can be expressed as: 
v
  (4) vconticontcontcont vvvv ,,, −−= θ
where 
 )(
ˆ
*, θωθ −= tsV
Vv
d
s
cont  (5) 
 )(
ˆ
*, tsV
r
L
Vv
d
Ls
icont ωωθ=  (6) 
 *,
3
d
F
vcont V
Vv =  (7) 
and the signal )( ts ω  denotes the unity rectified signal 
of input voltage ss  . In addition, L  
and F  are the inductor resistance and diode/switch 
conduction voltage, respectively.  
Vtvts ˆ/)()( =ω r
V
By combining the main circuit topology in Fig. 1 
and the proposed SLCSC in Fig. 4, we can obtain the 
equivalent circuit model in Fig. 5 for simplified 
analysis where the diode rectifier is replaced by two 
series-connected diodes DB1 and DB2 and the input 
voltage is the ideal rectified sinusoidal voltage 
)sin(ˆ tVs ω . Then, the unity rectified signal )( ts ω  is 
)sin()( tts ωω =  and ))(sin())(( tsigntvsign s ω= . In 
addition, in order to simply the following analysis, all 
the conduction voltages of the three diodes and the 
single switch SW are assumed equal to each other and 
denoted by . FV
 
L
SW
dC
Li
dV
)sin(ˆ tVs ω
di
ci
dθ2DB
D
FV
FV
FVL
r
contv−1
1DB
FV
 
Fig. 5. Boost-type SMR with adjustable phase signal 
θ . 
 
From Fig.4, since the control signal cont  is at “-” 
terminal and the triangle signal tri  is at “+” terminal, 
the average duty ratio signal 
v
v
d  over one switching 
period can be expressed as: 
 contvd −=1  (8) 
From (4) through (8), the average duty ratio signal 
d  can be further expressed in term of phase signal θ  
of voltage controller:  
 
d
F
d
Ls
d
s
V
Vt
V
r
L
Vt
V
Vd 3)sin(
ˆ
)sin(
ˆ
1 ++−−= ωωθθω  (9) 
From Fig. 5, when SW is turning on, the current 
flows through DB1, SW and DB2. Thus, the sum of 
total conduction voltage drops is F . Otherwise, 
when SW is turning off, the sum of total conduction 
voltages is also F  because that the current flows 
through DB1, D and DB2. Then, the following two 
KVL equations according to the conduction states of 
power switch SW.  
V3
V3
 LLFsL riVtVdt
diL −−= 3)sin(ˆ ω  when SW is “on” (10) 
 LLFds
L riVVtV
dt
diL −−−= 3)sin(ˆ *ω  when SW is 
“off” (11)  
Based on the time-averaging approach, the above two 
KVL equations can be combined to obtain (12) through 
multiplying them by turning-on time sTd  and 
turning-off time sTd )1( − , respectively.  
 
LLFds
L rtiVVdtV
dt
tidL )(3)1()sin(ˆ)( * −−−−= ω  (12) 
where s  is the switching period. Therefore, by 
substituting the averaged duty ratio signal 
T
d  in (8) 
into (12) and arranging the terms, we can obtain the 
following time differential equations for inductor 
current 
 LLsssL rtitL
VtVtV
dt
tidL ))()sin(
ˆ
()sin(ˆ)sin(ˆ)( −+−−= ωω
θθωω  (13) 
where the terms of  are cancelled out.  FV
Then, the term )sin( θω −t  can be extracted by 
applying the approximations θθ ≈sin  and 1cos ≈θ  
if the phase signal θ  in radians is small and near to 
zero ( 0≈θ ) and the following trigonometric identity 
)sin( BA− ABBA cossincossin −=  and. Then, (13) 
can be rewritten as:  
 
L
rtit
L
V
L
ttV
L
tV
dt
tid
L
L
s
ssL
))()sin(
ˆ
(
)cos()sin(ˆ)sin(ˆ)(
−+
−−≈
ωω
θ
ωθωω
 (14)  
V. EXPERIMENTAL RESULTS 
It is noted that the digital resolution of duty phase 
is the main challenge in the implementation of the 
proposed SLCSC. Too small phase resolution would 
result in the instable operation of SMRs in shaping 
current waveform. In the experiment, the digital 
resolution of phase signal θ  is set to 0.00008π rads. 
For sinusoidal current waveform in SLCSC, the digital 
resolution of input current magnitude s  and average 
input power are about 0.0267A and 2.075W, 
respectively, corresponding to the digital resolution of 
phase signal 
Iˆ
θ . All the circuit parameters in the 
experimental system have been listed in Table I. 
Fig. 8 shows the experimental waveforms for the 
proposed SLCSC at the condition  and 
. The phase signal 
VV 300* =
Ω= 78.177loadR θ  shown in the 
middle plot keeps around 0.021π rads in order to stably 
yield enough input power to regulate the output voltage. 
It is noted the phase signal πθ 021.0≈  is so small 
that it is reasonable to use the approximations 
θθ ≈sin  and 1cos ≈θ  in order to derive (14). 
The average duty signal d  is also plotted to show 
the variation of duty ratio. We can find that maximum 
duty ratio is 100% and minimum duty ratio is about 
48% equal to the ratio of input voltage magnitude 
 and the output voltage . From 
the bottom plots of input current s  and input voltage 
s , the proposed SLCSC possesses good PFC function 
including input current shaping and output voltage 
regulation without sensing any current. 
VVs 155ˆ = VVd 300=
i
v
 
dv
θ
sv
si
d
)(021.0 radπθ ≈
 
Fig. 8. Experimental waveforms with SLCSC. 
 
To verify the dynamic performance of the proposed 
SLCSC, some experimental results are shown in Fig. 9 
where the load resistance Load  is suddenly changed 
from  to . In order to regulate the out 
voltage, the phase signal 
R
Ω200 Ω78.177
θ  tunes to increase due to 
PI-type voltage controller in order to yield sufficient 
input current and input power. During the regulation, 
the input current keeps in phase with the input voltage. 
It clearly shows that the proposed single-loop CSC also 
possesses good regulation ability.  
 
dv
θ
sv
si
 
Fig. 9. Experimental waveforms with 
SLCSC during load regulation. 
 
The input voltage and input current with various load 
resistances Ω300 , Ω400  and  are plotted in 
Fig. 10(a) and Fig. 10(b), respectively. Obviously, with 
large load resistance, the input currents tend to return to 
zero current early and be blocked to zero current until 
the next half line-cycle. Due to the stagnated current, 
the degraded quality including total current harmonic 
current (THDi) and power factor (PF) are plotted in Fig. 
11(a) and Fig. 11(b), respectively. In other words, not 
only the limited resolution of phase 
Ω500
θ  but also the 
degraded quality, we can find that the proposed SLCSC 
is not suitable under light load. 
 
sv
si
Ω= 300LR
 
(a) 
sv
si
Ω= 400LR
 
(b) 
sv
si
Ω= 500LR
 
(c) 
Fig. 10. Input voltage and input current with various 
load resistances: (a)300Ω; (b)400Ω; (c)500Ω. 
 
 
    本會議所發表兩篇論文，除磨練英文發
表能力以外，來自世界各國之聽眾所提出之
相關問題與寶貴意見，可最為將來整理成期
刊論文投稿時，需要注意並加強之地方。此
外，在底下聆聽各講次之演講與問題對答
中，對於本人則有莫大之幫助，除了可以增
加視野以外，並為未來進入該領域預作準
備。  
    本次藉參加位於奧斯汀 APEC08 會議之
便，會後並與工研院朋友，拜訪同樣位於美
國德州/阿靈頓大學(UTA)李偉仁教授。前輩
鼓勵要多多參加國際活動，尤其是委員會的
參與，增加與各國研究人員之交流；對於本
人甚多提醒，實在感到獲益良多。 
 
 
 
IEEE APEC 為全世界有關電機與電子
相關研究方面重要會議之一。本次會議共有
330 篇論文。台灣有 14 篇文章發表，在大
會之文章篇數上佔有很大之部分。目前台灣
在有關電機與電子相關研究具有重要之地
位，但大陸今年也有 50 多篇文章發表，為
提高台灣之學術地位，仍需國科會、教育部
及各學術單位的努力。在本次的會議中可以
看出論文品質及研發方向有很大的提升，在
本次會議中能認識其他國家的人士，彼此能
交換心得，對於開拓視野、提升研究品質有
莫大的幫助。 
 
 
 
Phase Feedforward Control 
For Single-Phase Boost-Type SMR 
 
*Hung-Chi Chen (IEEE Member), **Chih-Kai Huang 
*Department of Electrical and Control Engineering, 
National Chiao Tung University, HsinChu, Taiwan. 
**Industrial Technology Research Institute, HsinChu, Taiwan. 
 
Abstract- In this paper, the phase feedforward control 
(PFFC) for single-phase boost-type switching-mode-
rectifier (SMR) is proposed. Compared to the fixed 
feedforward signal in the conventional feedforward control, 
the phase of the conventional feedforward signal now is 
controllable according to the load power which makes 
PFFC be able to yield more feedforward efforts for high 
load power. For implementing the high-sampling-
frequency function of power factor correction (PFC) in 
low-cost DSP-based system or in digital integrated circuit, 
the economical proportional-type (P-type) feedback 
controller is used in the proposed PFFC instead of using 
the proportional-plus-integral-type (PI-type) feedback 
controller or other complicated controllers. In addition, we 
can use relatively small P-type parameter in the proposed 
PFFC which also increases the system stability. The 
analysis and design of proposed PFFC are described in 
detail. The simulation and experimental results also 
demonstrate the proposed PFFC. Target applications of the 
proposed PFFC are low-cost digital control for terrestrial 
50-60Hz system whose performance is limited by the speed 
of the digital controller. 
 
I. INTRODUCTION 
The AC/DC converter is an essential component for most 
power electronic systems to build up DC-link voltage source 
from the AC mains. The use of switching-mode-rectifier (SMR) 
with power factor correction (PFC) function is an effective 
mean to perform the AC/DC conversion with high input and 
output quality by shaping the input current waveform and 
regulating the output dc voltage. The boost-type SMRs are the 
most popular circuit topology among all the others to perform 
PFC functions for their continuous current in the front-end 
inductors [1-2]. 
Feedforward control is usually used to eliminate or reduce 
the effects of disturbances in a control system. It is also very 
useful in single-phase PFC applications with time-varying 
current references where input voltage feedforward has been 
successfully applied to eliminate the dependency of voltage 
loop gain on input root mean square voltage. In addition, in 
order to obtain better current tracking performance, many 
current controllers had been developed in the literatures, such 
as predictive control[3], mixed-mode control[4], robust current 
control[5] and feedback control [6,7]…. Most of them also 
include the feedforward loops in their current controller [3-7]. 
The basic idea of the conventional feedforward loop is to 
generate the “nominal duty ratio pattern” derived only from 
rectified input voltage in order to alleviate the task of the 
feedback controller. This nominal duty ratio pattern effectively 
produces a voltage across the switch whose average over a 
switching cycle is equal to the instantaneous rectified input 
voltage. A sinusoidal input current can then be produced by the 
feedback controller that changes the duty ratio around this 
nominal pattern according to current error. However, it is noted 
that this nominal duty ratio pattern is fixed regardless of load 
power. That is, the nominal duty ratio pattern generated in 
heavy load is the same as that in light load. 
Therefore, in order to generate a flexible (i.e. load-dependent) 
feedforward signal to help the feedback controller, “full 
feedforward” in [7] and “load feedforward” in [8] had been 
developed. In the former, the feedforward signal is not only 
from the rectified input voltage but also from the inductor 
current command. Otherwise, in the latter, an additional load 
current must be sensed to generate the flexible feedforward 
signal. Both feedforward loops can provide more forward duty 
than the nominal one when the AC/DC system must yield 
larger power. 
However, the full feedforward loop [7] is implemented in 
analog circuits but it is not suitable for the digital control 
system for the need of acceptable resolution in digital 
implementation. The need of sensing load current is the main 
disadvantage of the feedforward loop in [8]. For low-cost DSP-
based system, implementation of the proportional-plus-
integral-type (PI-type) controller in DSP-based environment 
needs more instructions than the proportional-type (P-type) 
controller. For digital integrated circuits, more circuits like 
“state machine” must be designed to implement PI-type 
controller than P-type controller. It implies that PI-type 
controllers are not suitable in low-cost digital control system. 
The proposed PFFC consists of economical P-type feedback 
controller and the phase feedforward loop. Because the 
proposed phase feedforward loop can be simply implemented 
by the actions of looking-up table, the proposed PFFC can be 
referred to as one solution of high-switching-frequency PFC 
function implemented in the low-cost DSP-based system or 
digital integrated circuits. It is noted that the phase feedforward 
signal in PFFC is not to change the nominal pattern of duty 
ratio but to shift it. The larger the current magnitude is, the 
more the shifting phase of the nominal duty ratio pattern is. 
978-1-4244-1874-9/08/$25.00 ©2008 IEEE 1313
the average duty ratio d  with conventional feedforward loop 
now can be expressed by: 
 
tri
contbcontf
V
vv
d ˆ
+=  (6) 
In order to reject the disturbance in Fig. 3, the conventional 
feedforward signal  (i.e. the nominal duty ratio pattern) is 
formulated as 
contfv
 )2sin(
ˆˆˆ
* tfV
VVVv in
d
s
tritricontf π−=  (7) 
From (7), we can find that the control feedforward signal 
contf  is repeated with double line frequency . Since the 
variables in current loop such as , L  and contb  are also 
repeated with the same frequency in , we can substitute (6) 
and (7) into (3) to yield the following simplified equation, 
v inf2
*
Li i v
f2
 contb
tri
dL v
V
V
dt
diL ˆ
*
=  (8) 
Based on (8), the equivalent control model can be plotted in 
Fig. 4 where the disturbance shown in Fig. 3 is disappeared 
after introducing the conventional feedforward signal . contfv
 
Σ
)(sGci
*
Li
Li
contbv
sL
1
pK
Li
tri
d
V
V
ˆ
*
 
Fig. 4. Equivalent control model with conventional feedforward loop. 
D. P-Type Current Feedback Controller 
After applying the command feedforward loop in previous 
section, the tracking error due to disturbance in Fig. 3 can be 
greatly reduced and thus the simple P-type feedback controller 
an be used to yield satisfactory control performance. 
Then, the closed-loop transfer function )(sTp  for ctor 
current can be derived from Fig. 4 to be 
pci KG =  c
indu
 
)ˆ(
1
1
ˆ)(
)()(
*
*
*
*
tri
dp
dptri
dp
L
L
p
VL
VK
sVKsVL
VK
si
sisT
+
=+==  (9) 
From (9), we can find that the transfer function  behaves 
like a low-pass filter and its cut-off frequency  in Hz is 
)(sTp
cf
 
tri
dp
c VL
VK
f ˆ2
*
π=  (10) 
It is noted that the cut-off frequency  is controllable by 
setting the parameter . Furthermore, the input admittance 
 of boost-type SMR with multi-loop control plus 
conventional feedforward loop can be expressed as 
cf
pK
)(sY
 
c
ss
L
L
s
s
f
f
sV
I
I
Vsi
si
sv
sisY
π21
1
ˆ
ˆ
ˆ
ˆ
)(
)(
)(
)(
)(
*
*
* +
===  (11) 
From (11), we can find that the SMR behaves like the pure 
resistor when input line frequency in  is further smaller than 
the cut-off frequency c . It implies that the desired PFC 
function can be simply obtained by increasing  (i.e. by 
increasing P-type parameter ). 
f
f
cf
p
However, too large gain in practical control system would 
contribute to instability. In the design of feedback control gain, 
two key issues are additionally considered: (i) the current 
command  is a rectified sine signal with double line 
frequency in ; (ii) since the operation stability of a ramp-
comparison PWM scheme is much affected by the P-type 
parameter p , a general criterion to determine the parameter 
is that the closed-loop cut-off frequency c  must be less than 
the half of switching frequency tri . In order to yield 
satisfactory current tracking switching control performance 
without sacrificing the switching operation stability, the 
frequency c  with the conventional feedforward loop in (9) 
must be located at the range:  
K
*
Li
f2
K
f
f5.0
f
 tricin fff 5.02 <<<  (12) 
III. PROPOSED PHASE FEEDFORWARD CONTROL 
Fig. 5 shows the proposed phase feedforward control (PFFC) 
for boost-type SMRs where its inner current controller is 
composed of a P-type feedback controller and a phase 
feedforward loop. From Fig. 5, the controllable phase θ  is 
generated from the current magnitude command *Iˆ  and can be 
expressed as  
 
shorts
in
I
II
V
Lf
ˆ
ˆˆ
ˆ
2 ** == πθ  (13)  
where  is the peak current that will flow if the input 
voltage  was short circuited through boosting inductance .  
shortIˆ
sv L
 
Σ
dv
*
dV *Iˆ Σ
*
Li
Li
contv )(tdv
ε iε
triv
0
s
in
V
Lf
ˆ
2π Phase
shifter
θ )2sin( θπ −tfin
Σ
Comparator0
*
ˆ
d
s
V
V Σ
contpfv
contbvVoltagecontroller
)(sGcv
)(ts
)(ts
)(sGci
pK=
triVˆ
triVˆtriVˆ
 
Fig. 5. Multi-loop control with proposed phase feedforward loop. 
 
1315
By substituting the parameters in Table I into (10) and 
setting the closed-loop cut-frequency  and 
, respectively, the parameter of current controller 
 can be obtained to be  and 
kHzfc 5=
kHzfc 5.0=
)(sGci 597.0=pK 0597.0=pK , 
respectively. For cut-off frequency  (i.e. 
), the simulated current waveforms without any 
feedforward loop, with conventional feedforward loop and 
with the proposed phase feedforward loop are plotted in Fig. 
7(a)-(c), respectively. 
kHzfc 5=
597.0=pK
 
Table I. Simulated circuit parameters 
Input line voltage (peak) )110(155ˆ rmss VVV =  
Triangular signal magnitude VVtri 1ˆ =  
Voltage command VVd 250
* =  
Input line frequency Hzf 50=  
Smoothing capacitance FCd µ560=  
Smoothing inductance mHL 65.4=  
Equivalent load resistance Ω=100loadR  
Carrier frequency kHzftri 25=  
In first, we can obviously find the current waveforms are 
improved through including both feedforward loops by 
comparing Fig. 7(a) with Fig. 7(b)-(c). However, negligible 
difference between the input current waveforms in Fig. 7(b) 
and in 7(c) can be found. Thus, for , the response 
with conventional feedforward loop is much close to the 
response with the proposed phase feedforward loop which also 
demonstrates that (9) will approximately become (11) when the 
closed-loop cut-frequency is far larger than the line frequency 
. 
kHzfc 5=
)50()5( HzfkHzf inc =>>=
ms10
A5
A5
ms10
A5
ms10
ini
ini
ini
 
Fig. 7. Input currents for :(a) without any feedforward loop; (b) 
with conventional feedforward loop; (c) with proposed phase feedforward loop.  
kHzfc 5=
In addition, the simulated waveforms for closed-loop cut-
frequency  are shown in Fig. 8. With comparison 
between Fig. 8(b) and Fig. 8(c), obvious current drops at zero-
crossing points can be found in Fig. 8(b). Such current drops 
can not only contribute to the high harmonic currents but also 
result in additional power loss due to hard-switching of diode. 
It means that P-type current controller  with 
conventional feedforward loop may not yield pure sine current 
waveforms when the closed-loop cut-frequency c  is close to 
the line frequency in  (i.e. when p  is small). Furthermore, 
from Fig. 7(c) and Fig. 8(c), the current responses can be seen 
as identical to each other for various pK  which also 
demonstrates the pure response in (21). Thus, in order to obtain 
the desired current responses, small P-type parameter pK  can 
be used in the proposed PFFC which will increase the overall 
system stability. 
kHzfc 5.0=
)(sGci
f
f K
Besides, the input harmonic currents of Fig. 8(b) and Fig. 
8(c) are plotted in Fig. 9. From Fig. 9, we can find that the 
current waveform in Fig. 8(b) with conventional feedforward 
loop possesses higher harmonic currents than that in Fig. 8(c) 
with proposed phase feedforward loop under the same P-type 
parameter 0597.0=pK .  
ms10
A5
A5
ms10
A5
ms10
ini
ini
ini
 
Fig. 8. Input currents for kHzfc 5.0= :(a) without any feedforward loop; (b) 
with conventional feedforward loop; (c) with proposed phase feedforward loop.  
 
1I
Ih
h
kHzfc 5.0=
 
Fig. 9. Input harmonic currents with conventional feedforward loop and with 
proposed phase feedforward loop. 
 
V. EXPERIMENTAL RESULTS 
 
The proposed PFFC has been digitally implemented in a 
DSP-based system using TMS320F240 where PI-type voltage 
1317
Current Sensorless Control 
for Single-Phase Boost-Type SMR 
*Hung-Chi Chen (IEEE Member), **Chih-Kai Huang 
*Department of Electrical and Control Engineering, 
National Chiao Tung University, HsinChu, Taiwan. 
**Industrial Technology Research Institute, HsinChu, Taiwan. 
 
Abstract- In this paper, the single-loop current sensorless 
controls (SLCSC) for single-phase boost-type switching-mode-
rectifiers (SMRs) are developed and digitally implemented in 
DSP-based system. Compared to the conventional multi-loop 
control with one inner current loop and one outer voltage loop, 
there is only one voltage loop in the proposed SLCSCs where its 
output is used to shift the nominal duty ratio pattern generated 
from the sensed input and output voltage. Because of no current 
loop, the efforts of sampling and tracking inductor current are 
unnecessary. It implies that the proposed SLCSCs are simple and 
very adaptable to the implementation with mixed-signal 
integrated circuits. It is also noted that the proposed SLCSCs are 
operated at continuous-current-mode (CCM). In this paper, first, 
the effects of shifting nominal duty ratio pattern on the input 
current waveform are analyzed and modeled with considering the 
inductor resistance and conduction voltages. It shows that the 
aligned current waveform can be inherently generated by the 
nominal duty ratio pattern and the current amplitude is roughly 
proportional to the shifting phase of nominal duty ratio pattern. 
Then, a voltage controller is included to regulate the dc output 
voltage by tuning this controllable phase. Finally, some simulated 
and experimental results have been given to demonstrate the 
performances of the proposed SLCSCs. 
I. INTRODUCTION 
In DC/DC conversion, we often put close attentions on the 
performance of output voltage regulation. Alternatively, we are 
interested in the performances of input current shaping and 
output voltage regulation in the qualified AC/DC conversion. 
The use of switching-mode-rectifier (SMR) [1-3] with PFC 
function is an effective mean to perform the qualified AC/DC 
conversion. Boost-type SMRs as shown in Fig. 1 are the most 
popular circuit topology among all the others to shape the 
current waveform for their continuous current in the boost 
inductors. 
 
 L
sv
D
SW
dC
Load
Li
dVsv
di loadIsP
si
dP
ci
 
Fig. 1. Power circuit of the boost-type SMR. 
 
Since there is only one controllable power switch in the 
boost-type SMR, both desired functions including input current 
shaping and output voltage regulation must be met by 
adequately turning on and turning off the single switch. In the 
conventional multi-loop control as shown in Fig. 2, the inner 
current loop and the outer voltage loop work together to 
achieve both desired functions by controlling the single switch 
where the former loop focuses on input current shaping and the 
latter loop contributes to voltage regulation, respectively. 
 
 
Voltage
controller
Σ
dV
*
dV sIˆ Σ
*
Li
Li
Current
controller
contv
)(td
vε iε)(sGcv )(sGci
triv)( ts ω 0
1
Comparator
 
Fig. 2. Conventional multi-loop control for boost-type SMRs in CCM. 
 
In order to perform the conventional multi-loop control, we 
need to sense three signals including input voltage, output 
voltage and input current. It is noted that the current sampling 
rate set according to the switching frequency is considerably 
greater than the voltage sampling rate decided based on the 
input line frequency. For single-phase boost-type SMRs, many 
voltage sensorless controls [4-5,7-9] and current sensorless 
controls [6-7] had been proposed in literatures in order to 
reduce the total number of input signals. 
From the view of control structure, those sensorless control 
methods can be divided into two categories: one is multi-loop 
sensorless control and the other is single-loop sensorless 
control. Since there is only one voltage loop in the latter 
category, they can be seen as voltage-mode control and 
therefore, the former category can be regarded as current-mode 
sensorless control for their inner current loop. 
In the boost-type SMR, the rising rate of current is 
proportional to the input voltage and the falling rate is 
proportional to voltage difference between the output voltage 
and input voltage. The above relations are used in the multi-
loop sensorless control methods [4-6]. The input voltage in [4] 
is reconstructed from the rising rate of inductor current. The 
output voltages in [4-5] are estimated from the falling rate of 
the available inductor current. In [6], the current is predicted 
from duty ratio, the sensed input and output voltage. 
It is noted that at least two current samplings within the 
durations of rising current or falling current must be obtained 
in order to calculate the time rate of change of current in [4-5]. 
In the multi-loop current sensorless control in [6], the actual 
voltage sampling frequency must be increased to the level of 
switching frequency to predict the current accurately [6]. It 
implies that the actual sensing effort does not decrease but 
increase as the developed sensorless method [4-6]. Because 
that the conventional multi-loop control structures are still used 
in [4-6], in fact, the complexities of the sensorless control 
978-1-4244-1874-9/08/$25.00 ©2008 IEEE 1221
compared with the current magnitude sI  at the output of 
voltage controller in Fig. 2, the output of voltage controller in 
proposed SLCSC is the controllable phase 
ˆ
θ . 
 
Voltage
controller
Σ
dv
*
dV θ )( θω −tsvε )(sGcv
icontv ,
)( ts ω
ΣPhaseshifter
)(td
triv
*
d
L
V
r
*
ˆ
d
s
V
V
contv
θ,contv
sIˆ
L
Vs
ω
ˆ Li
~
vcontv ,
*
3
d
F
V
V
 
Fig. 4. Proposed SLCSC for boost-type SMRs. 
 
The control signal contv  in SLCSC composes of three 
signals and can be expressed as: 
  (4) vconticontcontcont vvvv ,,, −−= θ
where 
 )(
ˆ
*, θωθ −= tsV
Vv
d
s
cont  (5) 
 )(
ˆ
*, tsV
r
L
Vv
d
Ls
icont ωωθ=  (6) 
 *,
3
d
F
vcont V
Vv =  (7) 
and the signal )( ts ω  denotes the unity rectified signal of input 
voltage ss  . In addition, Lr  and F  are the 
inductor resistance and diode/switch conduction voltage, 
respectively.  
Vtvts ˆ/)()( =ω V
By combining the main circuit topology in Fig. 1 and the 
proposed SLCSC in Fig. 4, we can obtain the equivalent circuit 
model in Fig. 5 for simplified analysis where the diode rectifier 
is replaced by two series-connected diodes DB1 and DB2 and 
the input voltage is the ideal rectified sinusoidal voltage 
)sin(ˆ tVs ω . Then, the unity rectified signal )( ts ω  is 
)sin()( tts ωω =  and ))(sin())(( tsigntvsign s ω= . In addition, 
in order to simply the following analysis, all the conduction 
voltages of the three diodes and the single switch SW are 
assumed equal to each other and denoted by . FV
 
L
SW
dC
Li
dV
)sin(ˆ tVs ω
di
ci
dθ2DB
D
FV
FV
FVL
r
contv−1
1DB
FV
 
Fig. 5. Boost-type SMR with adjustable phase signal θ . 
 
From Fig.4, since the control signal contv  is at “-” terminal 
and the triangle signal triv  is at “+” terminal, the average duty 
ratio signal d  over one switching period can be expressed as: 
 contvd −=1  (8) 
From (4) through (8), the average duty ratio signal d  can be 
further expressed in term of phase signal θ  of voltage 
controller:  
 
d
F
d
Ls
d
s
V
Vt
V
r
L
Vt
V
Vd 3)sin(
ˆ
)sin(
ˆ
1 ++−−= ωωθθω  (9) 
From Fig. 5, when SW is turning on, the current flows 
through DB1, SW and DB2. Thus, the sum of total conduction 
voltage drops is F . Otherwise, when SW is turning off, the 
sum of total conduction voltages is also F  because that the 
current flows through DB1, D and DB2. Then, the following 
two KVL equations according to the conduction states of 
power switch SW.  
V3
V3
 LLFsL riVtVdt
diL −−= 3)sin(ˆ ω  when SW is “on” (10) 
 LLFds
L riVVtV
dt
diL −−−= 3)sin(ˆ *ω  when SW is “off” (11)  
Based on the time-averaging approach, the above two KVL 
equations can be combined to obtain (12) through multiplying 
them by turning-on time sTd  and turning-off time sTd )1( − , 
respectively.  
 LLFdsL rtiVVdtVdt
tidL )(3)1()sin(ˆ)( * −−−−= ω  (12) 
where sT  is the switching period. Therefore, by substituting 
the averaged duty ratio signal d  in (8) into (12) and arranging 
the terms, we can obtain the following time differential 
equations for inductor current 
 LLsssL rtitL
VtVtV
dt
tidL ))()sin(
ˆ
()sin(ˆ)sin(ˆ)( −+−−= ωω
θθωω  (13) 
where the terms of  are cancelled out.  FV
Then, the term )sin( θω −t  can be extracted by applying the 
approximations θθ ≈sin  and 1cos ≈θ  if the phase signal θ  
in radians is small and near to zero ( 0≈θ ) and the following 
trigonometric identity )sin( BA− ABBA cossincossin −=  
and. Then, (13) can be rewritten as:  
 
L
rtit
L
V
L
ttV
L
tV
dt
tid
L
L
s
ssL
))()sin(
ˆ
(
)cos()sin(ˆ)sin(ˆ)(
−+
−−≈
ωω
θ
ωθωω
 (14)  
Since the inductor current is repetitive with double line 
frequency in , the current differential equation (14) can be 
simplified by removing the absolute operators 
f2
 
L
rtit
L
Vt
L
Vtsign
dt
tid L
L
ssL ))()sin(
ˆ
()]cos(
ˆ
))[(sin()( −+≈ ωω
θωθω  (15) 
Then, by solving (15), we can obtain the inductor current 
 )(tiL
1223
operation of SMRs in shaping current waveform. In the 
experiment, the digital resolution of phase signal θ  is set to 
0.00008π rads. For sinusoidal current waveform in SLCSC, the 
digital resolution of input current magnitude sI  and average 
input power are about 0.0267A and 2.075W, respectively, 
corresponding to the digital resolution of phase signal 
ˆ
θ . All 
the circuit parameters in the experimental system have been 
listed in Table I. 
Fig. 8 shows the experimental waveforms for the proposed 
SLCSC at the condition  and . The 
phase signal 
VV 300* = Ω= 78.177loadRθ  shown in the middle plot keeps around 0.021π 
rads in order to stably yield enough input power to regulate the 
output voltage. It is noted the phase signal πθ 021.0≈  is so 
small that it is reasonable to use the approximations θθ ≈sin  
and 1cos ≈θ  in order to derive (14). 
The average duty signal d  is also plotted to show the 
variation of duty ratio. We can find that maximum duty ratio is 
100% and minimum duty ratio is about 48% equal to the ratio 
of input voltage magnitude  and the output voltage 
. From the bottom plots of input current si  and 
input voltage sv , the proposed SLCSC possesses good PFC 
function including input current shaping and output voltage 
regulation without sensing any current. 
VVs 155ˆ =
VVd 300=
 
dv
θ
sv
si
d
)(021.0 radπθ ≈
 
Fig. 8. Experimental waveforms with SLCSC. 
 
To verify the dynamic performance of the proposed SLCSC, 
some experimental results are shown in Fig. 9 where the load 
resistance  is suddenly changed from  to LoadR Ω200 Ω78.177 . 
In order to regulate the out voltage, the phase signal θ  tunes to 
increase due to PI-type voltage controller in order to yield 
sufficient input current and input power. During the regulation, 
the input current keeps in phase with the input voltage. It 
clearly shows that the proposed single-loop CSC also possesses 
good regulation ability. 
 
dv
θ
sv
si
 
Fig. 9. Experimental waveforms with SLCSC during 
load regulation. 
 
The input voltage and input current with various load 
resistances Ω300 , Ω400  and  are plotted in Fig. 10(a) 
and Fig. 10(b), respectively. Obviously, with large load 
resistance, the input currents tend to return to zero current early 
and be blocked to zero current until the next half line-cycle. 
Due to the stagnated current, the degraded quality including 
total current harmonic current (THDi) and power factor (PF) 
are plotted in Fig. 11(a) and Fig. 11(b), respectively. In other 
words, not only the limited resolution of phase 
Ω500
θ  but also the 
degraded quality, we can find that the proposed SLCSC is not 
suitable under light load. 
 
sv
si
Ω= 300LR
 
(a) 
sv
si
Ω= 400LR
 
(b) 
sv
si
Ω= 500LR
 
(c) 
Fig. 10. Input voltage and input current with various load 
resistances: (a)300Ω; (b)400Ω; (c)500Ω. 
 
 
1225
出席國際學術會議心得報告 
                                                             
計畫編號 NSC 96-2221-E-009-247 
計畫名稱 
應用於平面顯示設備電源系統數位式電源控制驅動 IC 之研製與 IP 智權庫
發展計畫--整合可規劃硬體於功因修正電路模組之晶片化控制器設計與實
現 
出國人員姓名 
服務機關及職稱 
陳鴻祺 
國立交通大學 電機與控制工程學系 助理教授 
會議時間地點 Austin, Texas, USA 
會議名稱 Applied Power Electronics Conference (APEC08) 
發表論文題目 
1. Current Sensorless Control for Single-Phase Boost-Type SMR 
2. Phase Feedforward Control for Single-Phase Boost-Type SMR 
 
二、 與會心得 
IEEE APEC 為全世界有關電機與電子相關研究方面重要會議之一。本次會議
共有 330 篇論文。台灣有 14 篇文章發表，在大會之文章篇數上佔有很大之部分。
目前台灣在有關電機與電子相關研究具有重要之地位，但大陸今年也有 50 多篇
文章發表，為提高台灣之學術地位，仍需國科會、教育部及各學術單位的努力。
在本次的會議中可以看出論文品質及研發方向有很大的提升，在本次會議中能
認識其他國家的人士，彼此能交換心得，對於開拓視野、提升研究品質有莫大
的幫助。玆將出席本次會議心得分述如下： 
  本會議所發表兩篇論文，除磨練英文發表能力以外，來自世界各國之聽眾
所提出之相關問題與寶貴意見，可最為將來整理成期刊論文投稿時，需要注意
並加強之地方。此外，在底下聆聽各講次之演講與問題對答中，對於本人則有
莫大之幫助，除了可以增加視野以外，並為未來進入該領域預作準備。 
 
  
  
