 
中 文 摘 要 ： 本計畫之目的為應用稀薄燃燒系統，改善機車引擎的效率及
減少廢氣的排放。其系統包含有強烈的渦流進氣、進氣門開
啟時噴射燃油及空氣輔助燃油噴射等技術。本計畫的目標引
擎為一部 125 cc 四汽門引擎，其為氣道燃油噴射(port fuel 
injection, PFI)引擎。從 CFD 模擬結果可發現，均質模式缸
內流場情形較為混亂，易使燃料與空氣混合均勻；層狀模式
具有強烈的進氣渦流，可增強引擎點火時的紊流，並能夠提
升稀薄燃燒極限。本文中所採用的稀薄燃燒系統，係結合強
烈進氣渦流、半直接噴射(semi-direct injection, SDI)及
液化石油氣燃料等技術。藉由傳統機車氣道燃油噴射(port 
fuel injection, PFI)引擎進氣道修改並置入一可切換式檔
片，能將汽缸內之渦旋比(swirl ratio)從 0 提升至 0.958，
且由於缸內紊流強度增強的關係，其引擎的稀油極限(lean-
limit)將可提升至相對空燃比(relative air/fuel ratio, 
λ)1.7。機車引擎之稀薄燃燒控制策略，包含引擎管理系統
(engine management system, EMS)、適應性進氣歧管壓力
(pressure intake manifold, PIM)控制、層狀模式之適應性
扭力控制、均質模式之適應性扭力控制及均質/層狀模式切換
控制策略。 
首先，傳統機車汽油引擎與稀薄燃燒系統之機車引擎將於低
負載區域進行油耗與污染排放測試，其中包含了大多數 ECE-
40 行車型態下之運轉點。實驗結果顯示，制動能量消耗率
(brake-specific energy consumption, BSEC)可減少
19.2%，CO2、NOX 與 CO 的廢氣排放分別改善了 27%、47%及
94%，HC 排放則增加 4.5%。第二，機車引擎加上本研究提出
之控制策略，由實驗結果顯示在均質/層狀模式切換時能有效
的減少扭力顛簸。本研究提出之 SDI 引擎設計可以使機車在
稀薄燃燒情況下運行，減少廢氣排放及油耗且機車仍維持高
功率輸出。 
中文關鍵詞： 機車引擎、稀薄燃燒、引擎控制、半直接噴射系統、均質燃
燒、層狀燃燒 
英 文 摘 要 ： This project proposed an application of lean burn 
system for improving engine efficiency and reducing 
exhaust emissions of a motorcycle engine. This system 
comprises high swirl charge, injection during intake 
valve opening, and air-assisted fuel injection. The 
fuel goes into cylinder directly through intake valve 
near the middle intake stroke to make richer mixture 
around the spark plug, which is called semi-direct 
injection (SDI). The main fuel used is liquefied 
 計畫名稱：機車引擎半直接噴射系統實車驗證 
執行單位：國立台北科技大學車輛工程系 
計畫編號：NSC 99-2221-E-027-063-MY3 
計畫主持人：吳浴沂 教授 
共同主持人：陳柏全 教授 
研究人員： Tran Anh Trung、蔡弦錡、楊清潭、郭益銘、蔣洺豪、彭家慶、徐麗惠、李孟杰、 
高博愈、鄒永靖、徐詠富、吳宗霈 
連絡方式： 吳浴沂 教授；Tel: (02)27712171 ext. 3620, Email: cyywu@mail.ntut.edu.tw 
摘要 
本計畫之目的為應用稀薄燃燒系統，改善機車引擎的效率及減少廢氣的排放。其系統包含有強烈
的渦流進氣、進氣門開啟時噴射燃油及空氣輔助燃油噴射等技術。本計畫的目標引擎為一部 125 cc四
汽門引擎，其為氣道燃油噴射(port fuel injection, PFI)引擎。從 CFD模擬結果可發現，均質模式缸內流
場情形較為混亂，易使燃料與空氣混合均勻；層狀模式具有強烈的進氣渦流，可增強引擎點火時的紊
流，並能夠提升稀薄燃燒極限。本文中所採用的稀薄燃燒系統，係結合強烈進氣渦流、半直接噴射
(semi-direct injection, SDI)及液化石油氣燃料等技術。藉由傳統機車氣道燃油噴射(port fuel injection, 
PFI)引擎進氣道修改並置入一可切換式檔片，能將汽缸內之渦旋比(swirl ratio)從 0提升至 0.958，且由
於缸內紊流強度增強的關係，其引擎的稀油極限(lean-limit)將可提升至相對空燃比(relative air/fuel ratio, 
λ)1.7。機車引擎之稀薄燃燒控制策略，包含引擎管理系統(engine management system, EMS)、適應性
進氣歧管壓力(pressure intake manifold, PIM)控制、層狀模式之適應性扭力控制、均質模式之適應性扭
力控制及均質/層狀模式切換控制策略。 
首先，傳統機車汽油引擎與稀薄燃燒系統之機車引擎將於低負載區域進行油耗與污染排放測試，
其中包含了大多數 ECE-40 行車型態下之運轉點。實驗結果顯示，制動能量消耗率(brake-specific 
energy consumption, BSEC)可減少 19.2%，CO2、NOX 與 CO 的廢氣排放分別改善了 27%、47%及
94%，HC 排放則增加 4.5%。第二，機車引擎加上本研究提出之控制策略，由實驗結果顯示在均質/層
狀模式切換時能有效的減少扭力顛簸。本研究提出之 SDI 引擎設計可以使機車在稀薄燃燒情況下運
行，減少廢氣排放及油耗且機車仍維持高功率輸出。 
關鍵詞：機車引擎、稀薄燃燒、引擎控制、半直接噴射系統、均質燃燒、層狀燃燒 
 
ABSTRACT 
This project proposed an application of lean burn system for improving engine efficiency and reducing 
exhaust emissions of a motorcycle engine. This system comprises high swirl charge, injection during intake 
valve opening, and air-assisted fuel injection. The fuel goes into cylinder directly through intake valve near 
the middle intake stroke to make richer mixture around the spark plug, which is called semi-direct injection 
(SDI). The main fuel used is liquefied petroleum gas (LPG). Simulation results using computational fluid 
dynamics (CFD) show that richer fuel can be concentrated on the upper cylinder. A conventional spark 
ignition (SI) motorcycle engine with port fuel injection (PFI) was retrofitted by designing a new intake port 
with a controllable plate to enhance the swirl of intake flow. The swirl ratio was increased from 0 to 0.958, 
enhancing turbulence of air flow inside the combustion chamber, and the lean limit was extended to 1.7 of 
relative air/fuel ratio (lambda). The proposed lean-burn engine control strategies consist of engine 
management system (EMS), adaptive pressure intake manifold (PIM) control, and adaptive torque control in 
stratified mode, adaptive torque control in homogeneous mode, and switching strategies for switching 
between stratified and homogeneous mode.  
First, engine was tested at low-load region which includes most operating points of the ECE-40 driving 
cycle. A complete engine performance map was conducted for comparison between the new design and 
regular gasoline engines. The results show that brake-specific energy consumption (BSEC) is decreased by 
19.2%. Brake-specific exhaust emissions of CO2, NOx and CO were decreased by 27%, 47% and 94%, 
II 
 
目    錄 
頁次 
摘要...................................................................................................................................................................... II 
I. INTRODUCTION ............................................................................................................................................ 1 
II. LITERATURE REVIEW ................................................................................................................................ 1 
2.1  ENGINE EFFICIENCY ................................................................................................................................ 1 
2.2  EFFECT OF CHARGE MOTION TO FUEL DISTRIBUTION ............................................................................... 3 
2.3  ENGINE MODEL ....................................................................................................................................... 4 
2.4  ENGINE CONTROL .................................................................................................................................... 5 
III. RESEARCH METHODS .............................................................................................................................. 6 
3.1  COMPUTATION FLUID DYNAMIC .............................................................................................................. 6 
3.1.1  Numerical model ............................................................................................................................ 6 
3.1.2  Spray model .................................................................................................................................... 7 
3.1.3  Numerical method .......................................................................................................................... 8 
3.1.4  CFD grid ......................................................................................................................................... 8 
3.1.5  Boundary and Initial condition ....................................................................................................... 8 
3.1.6  Independent of grid ......................................................................................................................... 8 
3.2  EXPERIMENTAL SETUP ............................................................................................................................ 9 
3.2.1  Test engine ...................................................................................................................................... 9 
3.2.2  Flow bench test ............................................................................................................................. 10 
3.2.3  Swirl meter ................................................................................................................................... 11 
3.3  EXPERIMENTAL CONDITION .................................................................................................................. 11 
3.4  CONTROLLER DESIGN ............................................................................................................................ 11 
3.4.1  Estimator ....................................................................................................................................... 12 
3.4.2  Intake manifold pressure control .................................................................................................. 13 
3.4.3  Torque control at Stratified mode ................................................................................................. 17 
3.4.4  Torque control at Homogeneous mode ........................................................................................ 23 
IV. RESULTS AND DISCUSSION .................................................................................................................. 29 
4.1  CFD SIMULATION RESULT ..................................................................................................................... 29 
4.2  ENGINE MODEL AND CONTROLLER SIMULATION RESULT ....................................................................... 33 
4.2.1  Engine model validation ............................................................................................................... 33 
4.2.2  Controller design at Intake manifold pressure .............................................................................. 36 
4.2.3  Controller design at Torque control ............................................................................................. 36 
4.3  EXPERIMENTAL RESULT ........................................................................................................................ 38 
4.3.1  Effect of lean burn on exhaust pollution ...................................................................................... 38 
4.3.2  Engine performance map .............................................................................................................. 39 
4.3.3  Brake torque ................................................................................................................................. 42 
4.3.4  Intake manifold pressure control .................................................................................................. 42 
4.3.5  Torque control .............................................................................................................................. 43 
4.3.6  Driving cycle ................................................................................................................................ 47 
V. CONCLUSION ............................................................................................................................................. 48 
VII. REFERENCES ........................................................................................................................................... 49 
IV 
 
has some restrictions before being ready for market production, particularly in regards to fuel type, knock 
control, and ignition timing control. For lean-burn engine, an increase in air/fuel ratio (A/F) from 14.7 to 21.9 
could increase thermal efficiency to 6%, and if A/F increased to infinity, thermal efficiency could increase by 
as much as 18% [7], Figure 2.3. A gasoline direct injection (GDI) engine, which combines advantages of both 
diesel and gasoline engines, could potentially achieve such increases. 
 
Figure 2.1 Euro Emission Standards for Light Commercial Vehicle 
 
 
Figure 2.2 Measured engine components friction [6] 
 
The challenge of improving combustion efficiency could be solved by decreasing cooling loss and time 
loss. Decreasing heat exchange between the flame and combustion chamber wall could decrease cooling loss, 
while decreasing combustion duration would decrease time loss. Yamamoto [7] shows that reducing 
combustion duration and cooling loss could increase thermal efficiency to 8%, Figure 2.3. This could be 
achieved by stratified combustion in a GDI engine. Stratified combustion, with a slightly rich mixture around 
the spark plug, is the key feature of GDI. It achieves lean burn, decreased cooling and time loss, and hence, 
2 
 
and a half of two intake ports. The result indicated that swirl ratio at 3.5 could increase lean limit from 
A/F=17 to 25. However, it decreases flow coefficient, due to a smaller intake area. So, swirl ratio could not 
increase very high in a four-valve SI engine. There is another way to increase lean limit using a high-pressure 
gasoline injector to decrease Sauter mean diameter (SMD) of fuel drop which allows enough time for the fuel 
to evaporate, or using an alternative fuel which is complete evaporation. This way, the mixture could have 
better stratification and increase the lean limit [13, 14]. However, using a high-pressure injector increases the 
cost of the system. So Liquefied Petroleum Gas (LPG) in gaseous phase could be an alternative fuel for an 
SDI system. Previous research has observed that the break mean effective pressure (BMEP) of gasoline is 
higher than LPG, while LPG fuel consumption and emission, which includes CO, HC and CO2, are less than 
gasoline [15, 16]. Campbell et al. [17] compared the lean limit of a homogeneous mixture of gasoline and 
LPG at gaseous phase and the results showed that the lean limit of LPG is better than gasoline. Khan et al. [18] 
compared the exhaust emission of NEDC driving cycle between gasoline and LPG of V6 engine when lambda 
increases. The results shows that the HC, NOx, and CO emission could reduce 30%, 98% and 90% 
respectively and achieve EURO 4 without the aid of a reducing catalyst. Also the reduction of CO2 achieves 
33% at lambda 1.2 and increase to 40% at lambda 1.6. It could be concluded that using LPG in gaseous phase 
for SDI engine should improve air quality without catalytic converter. 
The purpose of the first step research is to design a new SDI system, which allows control of 
homogenous and stratified modes, and to investigate experimentally the effects of SDI using LPG on the fuel 
consumption and exhaust emissions of a motorcycle engine with various engine speeds at low loads. A 
complete engine performance map under half-load operation was conducted for comparison between SDI-
LPG and conventional gasoline engines. 
 
2.3  Engine model 
There are many commercial simulation software for internal combustion engine (ICE) such as AVL 
BOOST [19], Ricardo WAVE [20], etc., which can be used to assist engineers in designing of the ICE. 
However these software’s model is too complicated, it cannot be used for real-time simulation and controller 
development. In order to develop the model which can be applied for real time control, the development of 
Moskwa and Hedrick [21], Yoon and Sunwoo [22] could be used for real-time simulation engine model, 
which contains filling and emptying model for air intake, the combustion and torque production model, the 
fuel delivery model and engine dynamic. The output of the model could be used to estimate the engine torque 
output. However, the torque model is using experimental equation which calculates the steady state engine 
torque also the effect of the throttle; ignition timing; fuel mass flow rate and exhaust gas recirculation flow 
rate (EGR) on torque output are based on empirical mathematical model. So the torque model could not be 
expressed the real variation of the combustion stroke, and it cannot be used to estimate the instantaneous 
torque of the engine as well as engine control and diagnostic problems. Thus Kodah et al. [23] and Alla, [24] 
were using the heat release model to simulate the cylinder pressure, brake mean effective pressure (BMEP), 
engine torque and dynamic response, using this way can allow studying the effect of air-fuel ratio, ignition 
timing, heat release rate, compression ratio and combustion duration on the engine torque output. Since 
previously developed engine model are for large automobile engines, which is different with combustion 
characteristics of small engine, Wu et al [25] had been built a model for 125cc engine including filling and 
emptying model, friction model and torque model. In which, the torque model was using two different 
methods to calculate the torque output including torque function model and heat release model, so it can 
simulate the mean torque or instantaneous combustion dynamic. 
In the heat release modeling studies, the main purpose is to specify the mass fraction of burned gases at 
any time during the combustion process. This is achieved by using empirical burning laws, such as Wiebe 
function [26]. The empirical burning equations include some constants that must be determined suitably at the 
beginning of computation. These are the efficiency parameter, the form factor, the crank angle at the start of 
combustion and the combustion duration [27]. Several studies have been published the empirical burning 
equations for homogeneous charger with stoichiometric combustion [28] engine, homogeneous charger with 
lean combustion engine [29] and direct injection stratified charger engine [30,31]. However those equations 
could not apply to SDI engine, which is operating at indirect injection stratified charger. For these reasons, in 
4 
 
relationship between air flow into cylinder and throttle angle is not precise enough, as it is affected by ambient 
pressure and manufacturing tolerances [33], the command of air flow into cylinder cannot be directed by the 
throttle position. Since air flow is closely related to the pressure of the intake manifold (PIM), and the 
manifold absolute pressure (MAP) sensor is standard equipment on most electronic fuel injection (EFI) 
motorcycle engines, this project focuses on controlling airflow indirectly by controlling PIM. 
An adaptive controller based on a lead-lag compensator is proposed for intake manifold pressure in this 
work, a model of air flow dynamic and throttle dynamic is introduced, the lead-lag compensator design and 
the calculation of root-locus also introduces. 
 
III. Research methods 
The research purpose of this project is retrofitting the intake manifold to enhance swirl motion also 
change the fuel injection system and injection timing of a motorcycle engine to improve the stratified mixture, 
by this way the engine can operate at high air fuel ratio which could not be done in original engine and called 
SDI engine. The first, computation fluid dynamic (CFD) was use to simulate air flow dynamic and fuel vapor 
in cylinder for 125cc single cylinder four stroke motorcycle engine to compare between original and SDI 
engine, it is including verification of spray structure, in-cylinder air motion and distribution of fuel 
concentration. The second, doing experiment on dynamometer engine test-bed to find out the parameter which 
help SDI engine can work in high air fuel ratio and compare lean limit between two engines, at last building 
the engine performance map at part load, which the normal vehicle driving always operate, comparing engine 
efficiency and exhaust emission. The third, establishment of dynamic engine model for SDI engine, including 
intake flow, combustion, torque, friction and engine rotational model, which will used for engine control in 
the next state. 
 
3.1  Computation fluid dynamic 
The research purpose of this project is redesign the intake manifold to enhance swirl motion also change 
the fuel injection system and injection timing of a motorcycle engine to allow engine working at two modes: 
stratified and homogeneous, by this way the engine can operate at high air fuel ratio at low load and keep the 
stoichiometric mixture at high load and called SDI engine. The first, new intake manifold was tested on flow 
bench test to make sure the new design can achieve high swirl ratio at stratified mode while keeping the flow 
coefficient the same as original port at homogeneous mode. The second, computation fluid dynamic (CFD) 
was use to simulate flow field in cylinder. The third, doing experiment on dynamometer engine test-bed to 
make sure the lean limit can achieve like old system. 
 
3.1.1  Numerical model 
In general, the leakage occurs in the gap between piston and piston rings, valve and valve seat, and 
thread of spark plug and cylinder head. However, those leakages have insignificant influence on the 
simulation result. Thus it is not unreasonable to ignore the leakage in CFD model. 
The CFD software adapts to transient governing and turbulent equations in this study. The transient 
governing equation includes conservation of continuity, momentum, energy and species transfer equation for 
compressible flow. In-cylinder, flow field is turbulence due to the moving of piston, so the turbulent model is 
considered. Standard ε–k  model turbulence equations with the standard wall function is used as the near-
wall treatment. 
Continuity Equation 
mSVt
=⋅∇+
∂
∂ ρρ                                                                (3.1)  
6 
 
3.1.3  Numerical method 
The engine running was considered as the transient problem, so Pressure Implicit with Splitting of 
Operators (PISO) algorithm was used in the numerical method. At first, it is a pressure-velocity calculation 
procedure developed for the non-iterative computation of unsteady compressible flows. Therefore, it includes 
a prediction step and two correction steps to satisfy the momentum equation and continuity equation [54]. 
 
3.1.4  CFD grid 
The moving mesh and sliding mesh techniques were employed to simulate the movement mechanism of 
piston and valve and combined with the events to switch the valve action within CFD software. 
In order to improve the accuracy of computation process, the mesh in port and valve region were refined 
as shown in Fig. 3.1. Also, the hybrid method which employed tetrahedral remeshing, was used to increase 
the accuracy of swirl and tumble at transient state [55]. 
 
Fig. 3.1    Refined Mesh of CFD Engine Model 
 
3.1.5  Boundary and Initial condition 
In this study, the air is followed as ideal gas law and the effect of gravity in CFD model is not considered. 
(A) Inlet condition 
Inlet port is set to pressure-inlet boundary, it's same as the operating pressure 1 atm. The inlet 
temperature is set to 313 K. 
(B) Moving boundary 
Since the events controlled within Fluent, the movement of piston and valve are achieved. 
(C) Fix-wall boundary condition 
Each of walls satisfied the no-slip condition. The wall temperature referred to the paper of motorcycle 
engine in CFD software [56]. 
(D) Initial condition 
The real engine is transient and periodic problem. In principle, if the simulated time is enough, the 
solution of flow can be presented periodically, but this study just considers the intake stroke and compression 
stroke, so the assumptions of initial condition are important. 
In this study, the initial temperature is set 313 K, the turbulent kinetic and dissipation referred to 
experience equation [57]. For example, the turbulent kinetic and dissipation are evaluated at engine speed is 
4500 rpm, which is 39.34 m2/s2 and 37671.45 m2/s3. In this simulation, the Top Dead Center (TDC) position 
of intake stroke is defined as 360o CA, and combustion is 720o CA. 
 
3.1.6  Independent of grid 
In order to more approach the physical phenomena of real engine in simulated results. This study 
performs the grid independent analysis of average cylinder pressure. As piston at TDC position, the CFD 
engine model was established with different amounts of grid. When the grid increased to 423,724 nodes, the 
average cylinder pressure is not dependent on quantity of grid, as shown in Fig. 3.2. However, the maximum 
Refined mesh 
8 
 
burette flow detectors. The exhaust emissions, including CO, HC, NOx, O2, and excess air ratio (λ), were 
measured with a HORIBA MEXA-584L. 
The cylinder pressure was measured using a Kistler 6051B uncooled piezoelectric pressure transducer. 
The crank angle (CA) was detected by a shaft encoder (BEI H25). The output signal of the pressure transducer 
was amplified using a charge amplifier. This amplified signal was transmitted to a data acquisition system 
which was an AVL IndiCom 619 combustion analyzer. The cylinder pressure was recorded every 1°CA for 
100 cycles. The measured pressure data were then used for calculating the heat release rate. 
Engine control was accomplished by using a MotoHawk ECU 555-80 controller produced by Woodward 
to control the fuel injection rate and injection timing. The MotoHawk allows the user to automatically 
generate machine code from Simulink diagrams and operate control hardware in real-time operation. 
Horiba 
Emission
Analyzer
AVL
Combustion
Analyzer
Tailpipe
Spark Plug with 
Pressure Transducer
Engine
Surge 
Tank
Fuel 
Injector
Engine 
Dynamometer
MotoHawk 
ECU
 
Fig. 3.3  Schematic diagram of engine test. 
 
3.2.2  Flow bench test 
The original SuperFlow, industry standard SF-120 as shown in Fig. 3.4 comes with complete instructions 
on how to measure flow changes as small as 1%. All necessary air-blowers, controls and airflow measuring 
equipment are built in. Intake or exhaust flow direction can be switched from one to the other by simply 
turning two knobs. Five flow orifices at the top of the machine and an inclined flow meter. By selecting 
proper orifice combinations, flow meter can be used in nine ranges from 10 cfm (4.7 l/s) up to 185 cfm (87 
l/s), with readings all within 0.5%. Nine ranges increase the resolution of flow measurement as compared to a 
single-range system. 
10 
 
(Lambda) is kept at λ≈1 during homogeneous combustion mode. The engine speed shall always be larger than 
a specified idle-speed limit to avoid stalling, also in the presence of load disturbances. Minimizing fuel 
consumption is in principle equivalent to using stratified combustion mode whenever possible. Maintaining 
driver comfort involves minimizing torque bumps due to mode changes and avoiding too large torque 
gradients, especially at high torque low engine speed. 
 
Figure 3.6 Structure of SDI benchmark 
 
3.4.1  Estimator 
The EMS control signals are the command signal to the fresh-air throttle; the swirl control plate; the 
ignition-advance angle; the start of injection; and the fuel-injection duration; i.e., the amount of fuel injected. 
The start of injection essentially determines the combustion mode that the engine operates in. The ignition-
advance angle and start of injection are optimized by experimental and applying 3-D look-up table for the 
benchmark. The manifold pressure Pim; throttle position θ; engine speed n; and relative air/fuel ratio λ are 
measured signals available for feedback. The air inlet temperature, engine temperature, battery voltage and the 
atmospheric pressure are measured, but regarded as constant in simulation. Figure 3.7 shows the simplifier 
structure of the EMS core. Which has three controllers: torque controller at homogeneous mode includes 
torque control and lambda control; torque controller at stratified mode includes torque control, lambda control 
and idle speed control; at last is pressure intake manifold controller. The operating of switching strategies 
depends on the engine state and decides which and how controllers work and then send the control signal to 
actuator or another controller. 
 
Figure 3.7. Structure of EMS core 
 
12 
  
Figure 3.8 Compares the critical pressure between nonlinear and approximate function 
 
From (4.6)(4.7) and (4.10), the throttle angle can be calculated as follows: 
( )imatmthinth PPC
m
,
1
, ψ
θ ≈                                                        (3.10) 
where C is calculated as: 
21CCCC d=                                                                 (3.11) 
The intake manifold pressure imP  is obtained from the state equation of the ideal gas as follows: 
( )cylinthin
im
im
im mmV
RTP ,,  −=                                                        (3.12) 
where Vim and Tim are the volume and temperature of the intake manifold, respectively; and the mass airflow 
into cylinder cylinm ,  is calculated from 
im
im
cylv
cylin PRT
nV
m
120,
η
=                                                             (3.13) 
where Vcyl is the displaced cylinder volume; n is the engine speed; and ηv is the volumetric efficiency [21]. 
The equation 3.12 now can be rewritten as follows: 
imina
im
im
im PmV
RTP
τ
1
, −=                                                         (3.14) 
where τ is manifold time constant and calculated as follow: 
nV
V
RT
VP
mm
m
dv
im
im
imim
outaouta
a
η
τ
21
,,
===

                                             (3.15) 
where ma is air mass in intake manifold, combined with equation 4.10, the dynamic equation of intake 
manifold pressure now becomes: 
14 
 If 





≥
tdτ
σ 1      






−
−= −
1
tan
,
,1
1
dt
dt
στ
ωτ
πθ                                                         
else            






−
−= −
1
tan
,
,1
1
dt
dt
στ
ωτ
θ                                                     (3.22) 
If 




 ≥ σ
τ
1      





−
−= −
στ
ωτπθ
1
tan 12                                                            
else          





−
−= −
στ
ωτθ
1
tan 12                                                   (3.23) 






−
= −
σ
ωφ
1
1tan
z
                                                        (3.24) 
The gain Kc is evaluated by measuring the vector lengths from the poles and zeros to the root location. 
Hence, 
321
,
2
sinsinsin
sin
θθθ
φτω
K
K dtc =                                                    (3.25) 
The D2(s) is calculated as follows: 
( )( ) ssdtcsv es
K
ps
nps
ps
zsKK 1
11
lim
,1
1
0
≥







++






+
+






+
+
=
→ ττ
τ                              (3.26) 
where ess is a steady-state error for a step reference input. The gain p is chosen very small so that the lag 
compensator would have little effect on the location of desired root. From (3.26) n is calculated as: 
τ1
1
zKKe
pn
css
=                                                               (3.27) 
Figure 3.9 is presented the design root locus of phase lead and lag at 4000 rpm, K=478, τt,d=0.06 and 
τ=0.04. Two original poles are located at -16.6 and -25, new poles will be added at -39 and -0.03; new zeros 
are added at -28.43 and -5.49; The gain Kc= 0.0783. 
The lead-lag compensator is then converted from continuous domain to discrete domain by using 
Tustin’s equation:  
1
12
+
−
=
z
z
T
s                                                                  (3.28) 
where T is sampled time, which is the function of engine speed. 
16 
 
The operating of stratified mode area from idles to 5500 rpm and 0 to 3.5 Nm, which will be discussed in 
switching strategy part. In this part, design torque and air fuel ratio controller will be done for an example of 
engine speed and torque and chosen at 4000 rpm of engine speed and 1.2 Nm of engine torque, which is 
relative to 65 kPa of intake manifold pressure at lambda optimum 1.6. For another engine speed and torque of 
air fuel ratio controller, the step designs and compensator are the same and using linear interpolation for each 
compensator gains in transient mode. 
From Figure 3.11, the dynamic of engine torque could be approximately as a pure variable time delay 
( ) sSTRTeSTRTe STRTeeKsG ,__ τ−=                                                (3.29) 
where KTe_STR is torque gain and can be approximately as a constant, and τTe,STR is torque delay from induction 
to power stroke and can be approximately calculated as: 
nSTRTe
180
, ≈τ                                                       (3.30) 
The structure of close-loop system shows in Figure 3.12. The torque estimation is a function of intake 
manifold pressure (4.3), which is sampling at each two revolutions, so the torque estimation will has 
measurement noise with frequency is a function of engine speed (4.32), from 3000 rpm (clutch engagement 
speed) to 5500 rpm the noise frequency is increased from 157 rad/sec to 287 rad/sec, Figure 3.13 is torque 
noise of 4000 rpm with frequency around 209 rad/sec. So in this matter the controller designed should provide 
good damping for engine torque and satisfy all speed range. From that consideration, the design specifications 
are: the cutoff frequency must be lower than 157 rad/sec, and the phase margin (PM) from 70 deg to 80 deg is 
certainly quite adequate. 
120
2_
nf noiseTe π=                                                    (3.31) 
 
Figure 3.12 Structure of closed-loop system model for engine torque in stratified mode 
 
The transfer function of lag can be written as 
( )
11
11
__
+
+
=
s
s
sG
z
z
STRTec
ω
α
ω                                                           (3.32) 
where α is low frequency gain and ωz is corner frequency for the zero. 
18 
  
Figure 3.14 The Bode plot of compensated loop transfer function LTe_STR(s) 
 
Figure 3.15 is showing the relative air/fuel ratio control in stratified mode, the system modeling is 
included the PIM controller, throttle dynamic, intake manifold dynamic, engine dynamic, exhaust manifold 
dynamic and UEGO sensor dynamic. The transport time delay is significantly greater than the time constant 
of the UEGO sensor, the dynamics of the UEGO sensor is above the control bandwidth and can be neglected 
for feedback control design. 
The close loop transfer function of PIM controller and PIM dynamic at 4000 rpm and PIM =65 kPa as 
show in equation 3.34  
( )
8599036720272382.83
8513019480572
234
2
++++
++
=
ssss
sssGPIM                                (3.34) 
The dynamics of engine and exhaust manifold could be approximately as a pure variable time delay [36]: 
( ) sAFSTRexen eKsG τ−+ =_                                       (3.35) 
 
Figure 3.15 Structure of closed loop relative air/fuel ratio controller in stratified mode 
 
where τ is the pure time delay and could be calculated as 
20 
 
The transfer function of system at 4000 rpm and 65 kPa of intake manifold pressure is showing in 
equation 3.40. The design specifications are: steady state error is lower than 0.005, PM requirement of 60 deg. 
( )
8599036720272382.83
85130194805720216.0 234
2
1825.0
_ ++++
++
= −
ssss
ssesG sSTRAF                           (3.40) 
From Bode plot of system Figure 3.19 the dashed line, it can be seen that the crossover frequency is 
infinity and gain margin is 24 db at 148 rad/sec, adding a gain will shift up the magnitude, however the PM 
will be negative, which will make the system unstable. From that considering, the design now is: first design a 
lag compensator to reduce steady state error, second choosing a proportional gain to increase crossover 
frequency, and then adjust compensator parameter to meet all the specification. 
The transfer function of lag compensator and proportional gain can be written as 
( ) ( )( )1
1
___
c
c
STRAFSTRAFc ps
zsKsG
+
+
=                                               (3.41) 
where pc1 ≤ zc1 
The frequency is chosen at  ωc = 1000 rad/sec  
The lag compensator can be calculated as 
101
c
cz
ω
=      
p
c
c K
zp 11 =                                                     (3.42) 
where Kp is desired static position error constant, calculate from 
005.0
1
1
≤=
+ ssp
e
K
                                                       (3.43) 
The dash-dot line in Figure 3.19 is the open-loop system with lag compensator (3.44), it can be seen that 
the crossover frequency is now ωc≈8 rad/sec, PM≈90 deg and BW≈10 rad/sec.  
( ) ( )( )5.0
100
___ +
+
=
s
sKsG STRAFSTRAFc                                             (3.44) 
The PM is still high, so we have to increase crossover frequency. To do that a proportional gain KAF_STR 
have to be added to increase cross-over frequency to 30 rad/sec, which the PM can be reduced to 60 deg.  
However in the design of lag compensator we did not take care about the static position error constant of 
the system, so here we have to determine the ratio between magnitudes of compensator and compensated 
system at 0.1 rad/sec, and then multiply with Kp (4.43). The result of that ratio is 3.2, so the new lag 
compensator and proportional gain of system at 4000 rpm and 65 kPa are shown in equation 4.46 and Bode 
plot of compensated system show in Figure 4.24- the solid line. The BW of compensated system is around 90 
rad/sec, which is higher than BW of fuel injection control, so that result can be accepted. For other engine 
speed and intake manifold pressure, KAF_STR and pc1 are calculate again following above step and using 3-D 
look up table. 
( ) ( )( )157.0
10054.4__ +
+
=
s
ssG STRAFc                                      (3.45) 
22 
  
Figure 3.20 Structure of torque control in homogeneous mode 
 
 
Figure 3.21 Timing diagram for SDI engine in homogeneous mode 
 
 
Figure 3.22 Structure of closed loop torque controller in homogeneous mode 
 
24 
 101
c
cz
ω
=      
p
c
c K
zp 11 =                                                         (3.51) 
where Kp is desired static position error constant, calculate from 
05.0
1
1
≤=
+ ssp
e
K
                                                         (3.52) 
To reduce PM, a proportional gain KTe_Hom needs to be added to increase cross-over frequency to 36 
rad/sec as show in Figure 3.25. The compensator and proportional gain of system shows in equation 3.52 and 
Bode plot of compensated system show in Figure 3.25 The dashed line. The BW of compensated system is 80 
rad/sec, that result can be accepted as compare with pedal frequency of the driver. For other engine speed and 
intake manifold pressure also do follow above step and using 3-D look up table. 
( ) ( )( )263.5
10005.6__ +
+
=
s
ssG STRAFc                                     (3.53) 
Figure 3.26 is showing the structure of closed loop relative air/fuel ratio controller at homogeneous mode, 
which is included the dynamic of injector, engine dynamic, exhaust manifold dynamic and UEGO sensor 
dynamic. Since the dynamic of exhaust gas has larger delay, so the controller of A/F needs to have the feed 
forward part to speed up the control output and then add a lag compensator to reduce the steady state error. 
 
Figure 3.25 Bode plot of torque control in homogeneous mode using lag compensator 
 
The feed-forward part have to estimate the air into cylinder before fuel inject, however the pressure 
sample is taken at the end of intake stroke, Figure 3.21, it cannot estimate the airflow into cylinder at this 
cycle. So air into cylinder will be estimated by throttle position and fuel calculation is calculated before 
injection timing (exhaust stroke). 
26 
  
Figure 3.27 Fuel mass estimate from throttle area and PIM 
 
The dynamics of engine and exhaust manifold could be approximately as a pure variable time delay, the 
transfer function of system is shown in Figure 3.26 and calculated as: 
( ) sFAHomFA eKsG τ−=_                                                   (3.61) 
where τ is the pure time delay and could be calculated the same with A/F controller at stratified mode; KFA is 
calculated as follow: 
2617.07.15 ==
imdv
FA PV
RTK
η
                                                (3.62) 
At 5000 rpm and 75 kPa of intake manifold pressure, the transfer function of system is shown in equation 
3.63. The design specifications are: steady state error is lower than 0.005, PM requirement of 80 deg.  
( ) sHomFA esG 11.0_ 2617.0 −=                                         (3.63) 
 
Figure 3.28 Structure of closed-loop system model for relative air/fuel ratio controller in homogeneous mode 
 
The Bode plot of system shows in Figure 3.29 the dashed line, it can be seen that the crossover frequency 
is infinity, and gain margin is 11 db at 25 rad/sec. The design now is: design a lag compensator to reduce 
steady state error. 
The transfer function of lag compensator can be written as 
( ) ( )( )1
1
__
c
c
HomFAc ps
zssG
+
+
=                                                     (3.64) 
where pc1 ≤ zc1 
The lag compensator can be calculated as 
101
c
cz
ω
=      
p
c
c K
zKp 111 =                                                        (3.65) 
28 
 
cylinder axis. This result also indicates in fig. 4.2, which depict the air flow at the bottom dead center. At this 
time, the center of swirl flow is clear and has high flow velocity in border of vortex flow at stratified mode, 
while the tumble and swirl flow are not clear also lower flow velocity in homogeneous mode. 
Fig. 4.3 depict the air flow at 900 after bottom dead center, the flow velocity for homogeneous mode is 
stronger than stratified mode with flow direction from lower border of cylinder scroll up in to the center of 
cylinder, it will make the mixture achieve good mixing in whole cylinder, however this kind of mixture will 
be good only for stoichiometric combustion and not suitable for stratified combustion, which is hoping rich 
mixing around spark plug and lean in the rest of combustion chamber. In the stratified mode, the center of 
swirl flow keeps going with the direction from lower to upper. For the right injection timing, it may help the 
fuel distribute in the upper and center of swirl, which very close to spark plug. Therefore it could be able to 
extend the lean limit of combustion. 
The Fig. 4.4 describes the flow velocity at top dead center in combustion stroke. For homogeneous mode, 
low flow velocity can be seen, it could make the flame propagation with low speed and increase the 
combustion duration, while stratified mode has very high flow velocity with the center of swirl very close to 
spark plug, it could enhance turbulence combustion and decrease the combustion duration. 
Fig. 4.5 shows the flow in the cylinder at several crank angles. Fig. 4.5(a) depicts the flow at 90 degrees 
after top dead center (TDC) during intake stroke. In case of homogeneous mode, the velocity vector of air 
flow directing towards the bottom of cylinder can be seen far lower than stratified mode, which has high 
velocity and the direction of air is slanted from upper right to lower left. This is because the air inlet area of 
stratified mode smaller than homogeneous mode and inlet flow has a substantial net angular momentum about 
cylinder axis. This result also indicates in Fig. 4.5(b), which depict the air flow at the bottom dead center 
(BDC). At this time, the center of swirl flow is clear and has high flow velocity in border of vortex flow at 
stratified mode; while the tumble and swirl flow are not clear and lower flow velocities in homogeneous mode 
Fig. 4.5(c) depict the air flow at 90 degrees after BDC, the flow velocity for homogeneous mode is 
weaker than stratified mode with flow direction from lower border of cylinder scroll up in to the center of 
cylinder, it will make the mixture achieve good mixing in whole cylinder, however this kind of mixture will 
be good only for stoichiometric combustion and not suitable for stratified combustion, which is hoping rich 
mixing around spark plug and lean in the rest of combustion chamber. In the stratified mode, the center of 
swirl flow keeps going with the direction from lower to upper. For the right injection timing, it may help the 
fuel distribute in the upper and center of swirl, which very close to spark plug. Therefore it could be able to 
extend the lean limit of combustion. The Fig. 4.5(d) describes the flow velocity at TDC of combustion stroke. 
For homogeneous mode, low flow velocity can be seen, it could make the flame propagation with low speed 
and increase the combustion duration, while stratified mode has high flow velocity with the center of swirl is 
close to spark plug, it could enhance turbulence combustion and decrease the combustion duration. 
From Fig. 4.5 in stratified mode can be seen that if the position of injector is located at original position 
(center of intake manifold), the fuel distribution will still have stratification but it is difficult to distribute 
around spark plug, because fuel will follow the highest flow velocity and distribute in the border of swirl. 
From those considered above can see that if fuel is injected into the center of swirl and injection timing is 
closed to the end of intake stroke Fig. 4.5(b), which mean, fuel is injecting to the smallest flow velocity and 
hold at the upper of cylinder. By this way, fuel could be distributed around spark plug at the end of 
combustion stroke as expectation. To do this, the injection position is now located at left side of two ports, 
and the direction is follow the center of swirl as show in Fig. 4.6, the red arrow is the direction of fuel. 
Since the flow field characteristic of homogeneous mode is easy to make the good mixing of fuel in 
whole cylinder, so the simulation is focused on the stratified mode. Figure 4.7 is showing the fuel distribution 
in cylinder with 1.7 of global lambda. In which, the equivalence ratio (invert of lambda) is used instead of 
lambda. Fig. 4.8 is indicating the variation of equivalence ratio around spark plug versus with crank angle; 
two red lines are indicated the crank angle at 50 and 40 before TDC and the fuel distribution at this crank 
angle are showing in Fig. 4.7(a) and Fig. 4.7(b) respectively. From this figure can be seen that the mixture has 
very good stratification with most of fuel distributed close to spark plug. The equivalence ratio around spark 
plug at ignition timing is around 0.85 or lambda 1.17, with that lambda could make mixture easy to catch fire 
and reduce coefficient of variant. 
30 
  
 
Fig. 4.4 Compare flow velocity at top dead center of combustion stroke 
 
 
Fig. 4.5 Compare flow velocity between two modes: (a) 900 after TDC of intake stroke, (b) BDC of intake 
stroke, (c) 900 after BDC of compression stroke, (d) TDC of combustion stroke 
 
 
Fig. 4.6 The new position of injector: (a) upper view; (b) side view 
32 
  
Figure 4.9 Calculate and measurement PIM at the end of intake stroke 
 
 
Figure 4.10 Calculate and measurement air mass flow per cycle 
 
 
Figure 4.11 Simulated and measured heat release rate in homogeneous mode 
34 
 
Figure 4.11 and 4.12 show the comparison of heat release rate between simulated and measured 
homogeneous and stratified modes. The results for homogeneous mode were good; however, for stratified 
mode the peak of heat release rate had a small delay. This problem may come from the basic Wiebe function 
and is not suitable enough for stratified combustion. Nevertheless, the trends in engine speed are similar. 
The comparisons of simulated and measured cylinder pressures are shown in Figure 4.13. for an engine 
speed of 4700rpm. The cylinder pressure measurement was taken with a piezo-electric pressure transducer 
[38]. The simulated results were shown to be good and the computation time was very short (that was shorter 
than the physical real time). 
 
4.2.2  Controller design at Intake manifold pressure 
A nonlinear engine model introduced in chapter III is used to evaluate the performance of the proposed 
controller. The sampling time of the MAP signal is chosen at 1800 of crank angle, end of intake stroke, at this 
position, the calculation of air-mass flow by using speed density has the smallest error. This position is also 
used for experimental testing. 
The damping ratio ζ of the PIM controller is selected as 0.7, and the design root location in the real axis 
is located at the left side of the uncompensated root location and equal to 1.01 times of the uncompensated 
root location. The zero position of the lead compensator is selected at 1.3 times of the design root location and 
the steady-state error chosen is lower than 1%. The τt,d remains constant at 0.06, while τ and K are calculated 
following equations (3.15) and (3.19), respectively. 
Figure 4.15 shows the simulation result of intake manifold pressure response at 4000 rpm. Engine start to 
t≈2.5 (sec) is the period of increasing engine speed, after which engine speed remains constant. The 
simulation result shows that the pressure is followed with good accuracy. 
 
Figure 4.15 Simulation result of intake manifold pressure at 4000rpm 
 
4.2.3  Controller design at Torque control 
The controller was tested in simulink simulations with 4000 rpm constant speed. The tests include 
different scenarios of different durations and torque references, torque should be within ±0.4Nm from the 
reference during normal operation, those torque-bumps at the mode-switches should be less than 1 Nm and 
that the lambda should be controlled with accuracy within 2% at normal operation. 
Figure 4.16 shows the noise free simulation of the torque response in a torque scenario. The start of 
simulation matches with engine start, after that engine working at idle speed. At t=2 second, torque increase 
rapidly, the switching immediately switch to homogeneous mode, switching time about 0.5 second. At t=7.5 
second, the switching switch back to stratified mode. 
From result for torque scenario, it is clear that the controller has good performance in simulation. At the 
switching mode, there is a small delay between torque demand and torque estimated at t=2 because at this 
time engine speed pretty low and the trigger for Pim control is each engine cycle, so the adaptive time is longer, 
this problem can be seen in Pim diagram. At t= 7.5 is switch back to homogeneous mode, the simulation show 
36 
 
  
Figure 4.17 Result for lambda variation between two modes 
 
4.3  Experimental result 
4.3.1  Effect of lean burn on exhaust pollution 
Figure 4.18 shows the effect of relative air/fuel ratio on CO, NOx and HC at 4300 and 5000 rpm low 
loads of the original gasoline engine, original LPG engine and SDI engine. Relative air/fuel ratio is the ratio 
of the actual air/fuel ratio to the stoichiometric ratio. The value of CO concentration increases steadily with 
decreased relative air/fuel ratio. From 1.3, the CO concentrations in the exhaust vary little with relative 
air/fuel ratio. Around 1.1, CO emission produced by SDI engine is even lower than original gasoline engine 
for two kinds of fuel. Lower CO emission may be due to high turbulence intensities in SDI engine combustion, 
so CO easily interacts with O2 or OH to become CO2.  
The values of NOx at 1.1 of relative air/fuel ratio show a clear distinction between two engine speeds. At 
the same relative air/fuel ratio value, high load will have a higher combustion temperature, so higher NOx 
emission at 5000 rpm is produced than at 4300 rpm. At the same engine speed and low relative air/fuel ratio, 
NOx in SDI engine is always higher than original engine. This comes from the high SDI engine combustion 
temperature [39]. When relative air/fuel ratio increases, NOx will be decreased, because the combustion 
temperature is decreased. The results regarding NOx also indicate that NOx emission from LPG is lower than 
gasoline for all ranges of relative air/fuel ratio and engine speed. Khan et al. [18] had the same result, as well. 
Since unburned hydrocarbon emissions (HC) are used as a full measure of combustion inefficiency, it is 
an important factor for evaluating combustion efficiency of SDI engine. Results indicate good combustion 
efficiency in original LPG engine compared to original gasoline engine. As relative air/fuel ratio increases, the 
original gasoline engine HC emissions increase rapidly compared to LPG engine, meaning that using LPG as 
an alternative fuel could increase the lean limit of original engine. For the SDI engine, the HC emission value 
from 0.9 to 1.5 of relative air/fuel ratio is lower than original gasoline and LPG engines. HC emissions in SDI 
engine from 1.6 to 1.7 of relative air/fuel ratio approximate original gasoline engine operating at 
stoichiometric mixture (relative air/fuel ratio ≈ 1). So the optimum operating range of SDI engine is around 
1.6 to 1.7 of relative air/fuel ratio. 
38 
 
stratified mixture inside the cylinder, so it could reduce time and heat loss which would increase combustion 
efficiency [7]. Extending the lean limit of SDI engine to 1.7 of relative air/fuel ratio will reduce pumping loss, 
which is a key to friction loss in SI engine. That is the reason why SDI engine produces the lowest CO2 
emission [18, 39]. 
Figure 4.21 shows the BSCO maps of SDI engine and original gasoline engine in low loads. The BSCO 
of original engine is much higher than that of SDI. By taking the average of all testing points in the map, 
BSCO is reduced 94% for SDI compared with regular gasoline engine. The SDI engine is running at lean burn 
with relative air fuel ratio around 1.6 to 1.7, while the original gasoline engines are operated with a 
stoichiometric mixture (relative air/fuel ratio ≈ 1). So the CO emission of SDI engine must be lower than that 
of original gasoline engine [18]. Carbon monoxide, which has been the focus of many environmental studies 
[43, 44] is highly toxic to humans. The current study’s reported results contribute greatly to reducing carbon 
monoxide in the atmosphere. 
 
Figure 4.19 Brake specific energy consumption (MJ/kW.h) maps and ECE-40 operating points (▲) in low-
load region: (a) original gasoline engine, (b) SDI engine. 
 
 
Figure 4.20 Brake specific carbon dioxide (g/kW.h) maps and ECE-40 operating points (▲) in low-load 
region: (a) original gasoline engine, (b) SDI engine.
40 
  
Figure 4.23 Brake specific oxides nitrogen (g/kW.h) maps and ECE-40 operating points (▲) in low-load 
region: (a) original gasoline engine, (b) SDI engine. 
 
4.3.3  Brake torque 
The wide open throttle (WOT) was performed to compare the engine performance in homogeneous mode 
of SDI-LPG and original gasoline engine. The spark advance was chosen at maximum brake torque and also 
considering the knock limits and exhaust temperature. The air fuel ratio was selected at lean best torque 
(LBT). The ranger of engine speed is selected from 2000 to 7000 rpm with stepwise increments of 1000 rpm.  
Figure 4.24 shows the results of WOT. At low engine speeds (2000 rpm), the brake torque of SDI-LPG 
engine was observed to be higher compared to original gasoline engine. This is explained by the fact that 
WOT torque in gasoline at low engine speeds is limited by its knocking tendency. At low engine speeds, SDI-
LPG can improve the WOT torque characteristics of engine wherein the MBT in gasoline is highly restricted 
by knock. The results also indicate that the engine torque of SDI-LPG system from 3000 rpm is lower than 
original gasoline engine; it can be explained by the fact that the volumetric efficiency of SDI-LPG is lower 
than that of original gasoline. This is due to the fact that LPG displaces air in the intake system and does not 
cool the intake charge due to lack of vaporization of fuel in the intake port. Typical loss of volumetric 
efficiency is in the order of 5% [52]. 
 
Figure 4.24 Engine brake torque at WOT 
 
4.3.4  Intake manifold pressure control 
Experimental results are introduced in three profiles of PIM demand: multi-step change, fast accelerator 
and slow accelerator as shown in Figures 4.25, 4.26, 4.27, respectively. All setting gains are using the same 
simulation results (5.2.1). The sampling position of the single cylinder needs to be taken exactly at 180 CA; 
42 
 
 
from intake manifold and goes through one way valve to get the peak vacuum pressure Figure 4.30. The input 
signals for the controller are including pressure intake manifold, intake air temperature, throttle position, 
lambda, engine temperature and crank angle. The output signals are injector, spark ignition coil, throttle 
position and swirl plate, Figure 4.30.     
The controller was tested on the SuperFlow CycleDyn chassis dynamometer. The tests include different 
scenarios of different durations and torque references, torque should be within ±0.4Nm from the reference 
during normal operation, those torque-bumps at the mode-switches should be less than 1 Nm and that the 
lambda should be controlled with accuracy within 2% at normal operation.  
Figure 4.31 and 4.32 shows the torque response in a torque scenario. It is included two cycles, which has 
the same profile, in each cycle is consisted of five states: idle, accelerator, decelerator, stable and idle, it is 
simulated a small driving cycle including accelerator, constant speed and decelerator. The start of cycle is idle 
for 12 second, this time engine is working at stratified mode, after that torque demand increase rapidly Figure 
4.32(c), the first engine speed is increased to 3000 rpm to make sure the switching process do not make the 
engine stall Figure 4.31(a). When engine is reach 3000rpm, lambda demand is first reduced to 1.2 and waiting 
for UEGO signal Figure 4.33. When UEGO signal is reach 1.2, the switching from stratified to homogeneous 
is occurred, lambda demand for homogeneous mode is reduced from 1.2 to 1, and engine is entered to 
accelerator mode. At t≈ 25 sec and 75 sec, the torque demand is reduced quickly to 1 Nm; engine is switch 
back to stratified mode. Lambda demand of homogeneous mode is first increased to 1.2 and waiting for 
UEGO signal. When UEGO signal is reach 1.2, the switching from homogeneous to stratified mode is 
occurred, after that lambda demand for stratified mode is increased from 1.2 to lambda optimal. Torque 
demand is kept stable until t≈ 50 sec and 100 sec, after this time, engine is switch back to idle. Lambda idle is 
around 2.0.  
From result for torque scenario, it is clear that the controller has good performance on chassis 
dynamometer. At t≈ 12 and 65 are the acceleration time, the results show that the torque followed with good 
accuracy; at t≈ 25 and 75, are the switching times from homogeneous to stratified mode, the torque-bumps is 
small and in the acceptance limit, this result come from well strategies switching which can be seen on 
lambda results.  There is a difference between Pim demands and measured at idle mode, because at this mode 
the lambda is controlled directly to the throttle controller and ignore Pim controller.  
 
Figure 4.28 Swirl plate control device 
44 
  
Figure 4.31 Results for torque scenario (a) Fuel duration, (b) Lambda response, (c) Torque response 
 
 
Figure 4.32 Lambda variation from idle to homogeneous mode 
46 
 
Table 4.1 Fuel economies and exhaust emission potential. 
 CO 
(%) 
HC 
(ppm) 
NOx 
(ppm) 
ECE-40 
(km/l) 
50 kpm 
(km/l) 
Mean value (km/l) 
Original gasoline 
engine 
0.82 386 98 38.5 53.9 43.5 
SDI-LPG engine 0.02 480 30 43.73 58.2 48.55 
Potential (%) 97 -24 70 13.6 7.9 11.62 
 
V. Conclusion 
A 125 cc 4-valve engine was retrofitted by designing a controllable plate to enhance the swirl of intake 
flow at low load. This design combined high swirl, fuel injection during intake-valve opening [39], and LPG 
gaseous phase to produce stratified charge, which is called semi-direct injection (SDI). The lean limit was 
extended to 1.7 of lambda. The engine was tested at a low load region which comprised most operating points 
of the ECE-40 driving cycle. A complete engine performance map under half load operation was conducted 
for comparison between SDI-LPG and original gasoline engines. In developing SDI engine control system, a 
real time engine model was established and validated with experimental data. The SDI engine control strategy 
was establish, which is including engine management system, adaptive pressure intake manifold control, 
adaptive torque control in stratified mode, adaptive torque control in homogeneous mode, and switching 
strategies for switching between stratified and homogeneous mode. Measurements of various combustion 
characteristics, emissions and torque response on the target engine have led to the following conclusions: 
(1) The new intake port design can be operated in both homogeneous and stratified modes with flow 
coefficient at homogeneous mode staying the same as the original intake port, while swirl ratio can reach 
0.958 in stratified mode. The result of computation fluid dynamics show that the newly designed intake port 
could enhance both turbulence combustion and stratified mixture with fuel distribution around the spark plug 
if the injection timing is appropriate.  
(2) The lean limit of the SDI-LPG system has been extended to 1.7 of lambda. A homogeneous-charge SI 
engine for both LPG and gasoline cannot achieve such a lean limit; therefore, it must have the effect of charge 
stratification. 
(3) Exhaust pollution is dependent on relative air/fuel ratio. Increasing relative air/fuel ratio will decrease 
CO and NOx; however, original gasoline and LPG engines cannot achieve as high a lean limit compared to 
SDI engine, which can achieve a relative air/fuel ratio of 1.7, thus reducing both CO and NOx significantly. 
(4) Within a part load region, which consists of most of the engine operating points of the ECE-40 
driving cycle, SDI-LPG performs pretty well. By taking the average of all testing points in this region, the 
results of SDI compared with original gasoline engine are: BSEC and BSCO2 are reduced by 19.2% and 
27.0%, respectively. BSCO decreases tremendously by 94%, BSNOx decreases by 47%. However, BSHC 
increases 4.5%. 
(5) Results of real time engine model show that the modeling process is close to reality and the 
computation time is very short, the engine model is suitable for developing a SDI engine control strategy. The 
predicted pressure intake manifold is precise enough and the effect of charge motion on combustion and 
relative air fuel ratio can be taken into account in the heat-release model. This will improve the accurate of 
engine model in transition mode between homogeneous and stratified. 
(6) In pressure intake manifold control, an adaptive controller is proposed for intake manifold pressure of 
the lean burn motorcycle engine in this paper. The throttle position is used as the control input for maintaining 
the desired pressure, and is designed based on lead-lag compensator. The speed density method and one-
dimensional isentropic compressible flow equation are employed to calculate the dynamic model from throttle 
opening to intake manifold pressure. Root-locus technique is then used to design the adaptive controller. The 
simulation and experimental results show that the intake manifold pressure tracks well with demand signal 
variability. 
(7) The EMS was evaluate in simulation and experiment on torque scenario and ECE-40 driving cycle 
with good results in tracking performance and ride comfort with small torque bumps. 
48 
 
 
[21] J. J. Moskwa and J. K. Hedrick, “Modeling and Validation of Automotive Engines for Control 
Algorithm Development,” Transactions of the ASME, Journal of Dynamic Systems, Measurement, 
and Control, 1992, Vol. 114, pp. 278-285. 
[22] P. J. Yoon and M. Sunwoo, “A Nonlinear dynamic modeling of SI Engines for Controller Design,” 
International Journal of Vehicle Design, 2001, Vol. 26, No. 2-3, pp. 277-297. 
[23] Z. H. Kodah, H. S. Soliman, M. A. Qudais, and Z. A. Jahmany, “Combustion in a Spark-ignition 
Engine,” Applied Energy, 2000, Vol. 66, n 3, pp. 237-250. 
[24] G. H. A. Alla, “Computer Simulation of a Four Stroke Spark Ignition Engine,” Energy Conversion and 
Management, 2002, Vol. 43, n 8, pp. 1043-1061. 
[25] Y.-Y. Wu, Y. Shiao, and B.-C. Chen, “Motorcycle Engine Modeling for Real Time Control,” 2002 6th 
International Symposium on Advanced Vehicle Control, Hiroshima, Japan. 
[26] J.B. Heywood: Internal Combustion Engine Fundamentals. McGraw-Hill, 1988. 727-728. 
[27] J. B. Heywood, J. M. Higgins, P. A. Watts and R. J. Tabaczynski “Development and use of cycle 
simulation to predict SI engine efficiency and NOx emissions,” SAE paper No. 790291. 
[28] H. Bayraktar, O. Durgun, “Development of an empirical correlation for combustion durations in spark 
ignition engines,” Energy Conversion and Management 45 (2004) 1419–1431. 
[29] M. Gupta, S. R. Bell, S. T. Tillman, “An Investigation of Lean Combustion in a Natural Gas-Fueled 
Spark-Ignited Engine,” Journal of Energy Resources Technology JUNE 1996, Vol. 118 / 145. 
[30] P. Bollweg, A. Kaufmann, “Dynamic Burn Rate Modeling for the 1D Simulation of a GDI Engine in 
Homogeneous and Stratified Operation Mode,” SAE paper No. 2008-01-2393. 
[31] M. J. van Nieuwstadt, I. V. Kolmanovsky, D. Brehob and M. Haghgooie, “Heat Release Regressions 
for GDI Engines” SAE paper No. 2000-01-0956. 
[32] J. Gerhardt, H. Honninger, and H. Bischof, “A new approach to functional and software structure for 
engine management systems,” SAE technical paper 980801. 
[33] L. Guzzella and C.H. Onder, “Introduction to Modeling and Control of Internal Combustion Engine 
systems,” Berlin: Springer, 2004. 
[34] Y. Y. Wu, B. C. Chen, C. H. Wu and H. C. Tsai, “New Charging Model Imparting the Valve Timing 
for Real-Time Simulation,” Proceedings of ASME Internal Combustion Engine Division 2009 Spring 
Technical Conference, Milwaukee, Wisconsin, USA. 
[35] J. J. Moskwa, “Automotive Engine Modeling for Real Time Control,” Ph.D. thesis, Massachusetts 
Institute of Technology, 1988. 
[36] F. Zhang, K. M. Grigoriadis, M. A. Franchek and I. H. Makki “Linear Parameter-Varying Lean Burn 
Air-Fuel Ratio Control for a Spark Ignition Engine,” Transactions of the ASME 404 / Vol. 129, JULY 
2007. 
[37] M. Nakamura, Y. Sawada, and S. Hashimoto, “Fuel Injection System for Small Motorcycles,” SAE 
Paper No. 2003-32-0084. 
[38] Y. Y. Wu, Y. Y. Peng, and T. T. Gau “Emission Control of Four-stroke Motorcycle Engine,” SAE 
Paper No. 951760. 
[39] Y. M. Guo, A. T. Tran and Y. Y. Wu, “An Investigation on Lean Burn for Semi-Direct Injection 
Engine by Using Liquefied Petroleum Gas,” The 16th National Conference on Vehicle Engineering 
Taipei. 
[40] SAE J1088 (1993). Test Procedure for the Measurement of Exhaust Emissions from Small Utility 
Engines, SAE Recommended Practice. 
[41] d’A. Stefano, F. Roberto, S. Ezio, “Calculation of Mass Emissions, Oxygen Mass Fraction and 
Thermal Capacity of the Inducted Charge in SI and Diesel Engines from Exhaust and Intake Gas 
Analysis,” Fuel 90 (2011), 152-166. 
[42] M. Pecqueur, K. Ceustermans, P. Huyskens and D. Savvidis, “Emissions Generated from a Suzuki 
Liane Running on Unleaded Gasoline and LPG under the Same Load Conditions,” SAE paper No. 
2008-01-2637. 
50 
Design of HCCI Engine for Range Extender Using Dual Fuel of 1 
Gasoline and DME Alternative Fuel 2 
Author names: 3 
Yuh-Yih Wu
a
 4 
Bo-Chiuan Chen
a
 5 
Hsien-Chi Tsai
a
 6 
Cha-Ching Peng
a
 7 
Bo-Liang Chen
b
 8 
Authors’ affiliation: 9 
a
Department of Vehicle Engineering, National Taipei University of Technology, No. 1, Sec. 3, Jhongsiao E. Rd., Taipei 10 
10608, Taiwan. 11 
b
Mechanical and Systems Research Laboratories, Industrial Technology Research Institute, No. 195, Sec. 4, Chung 12 
Hsing Rd., Chutung, Hsinchu, 31040, Taiwan. 13 
Authors’ E-mail: 14 
cyywu@ntut.edu.tw 15 
bochen@ntut.edu.tw 16 
hc.tsai.chimo@gmail.com 17 
t9448040@ntut.org.tw 18 
Bowen@itri.org.tw 19 
Corresponding author: 20 
Hsien-Chi Tsai 21 
Telephone number: 886-2-27712171 ext.3678 22 
Fax number: 886-2-27314990 23 
E-mail address: hc.tsai.chimo@gmail.com (H.-C. Tsai) 24 
Postal address: Department of Vehicle Engineering, National Taipei University of Technology, No. 1, Sec. 3, Jhongsiao 25 
E. Rd., Taipei 10608, Taiwan. 26 
27 
generator, it has the advantage that the engine operation is independent of vehicle speed and road conditions [4]. In order 55 
to promote fuel economy, the engine can be operated at a higher efficiency and a stable operating point according to the 56 
charging power requirement from the power management strategy. Exhaust emissions can be also reduced by preventing 57 
transient engine operation. 58 
A conventional spark-ignition (SI) engine can be utilized as a RE engine; however, the pumping losses suffered 59 
from partial load will sacrifice fuel efficiency—a crucial concern for electrified vehicles. The compression-ignition (CI) 60 
engine is operated with higher fuel efficiency due to its higher compression ratio and throttleless features. But NOx and 61 
particulate matter (PM) emissions of CI engines are crucial problems, which result in the requirement of an expensive 62 
after-treatment system for both NOx and PM together, and with more-frequent periods of regeneration [1]. As a result, a 63 
CI engine in a RE application is a more expensive and heavy-handed solution than a SI solution. 64 
Many advanced technologies have been developed to improve fuel efficiency and reduce exhaust emissions of 65 
conventional SI and CI engines, such as gasoline direct injection (GDI) and homogeneous charge compression ignition 66 
(HCCI). HCCI engine produces very low NOx and PM emissions and high fuel efficiency. A HCCI engine is similar to a 67 
combination of a SI engine and CI engine. Its fuel-air mixture is premixed, as in a conventional SI engine, while its 68 
combustion is initiated by self-ignition, which is like CI combustion. Therefore, HCCI is considered a high-efficiency 69 
alternative to SI engine [5] and as a low-emission alternative to CI engine [6]. However, it still faces the challenges of its 70 
operating range, the difficulty in controlling ignition timing [7], and too high of a combustion rate at high loads [8-9]. 71 
Previous studies show that many methods can be used to facilitate HCCI operation: (1) Intake heating [10]; (2) Variable 72 
compression ratio (VCR) [11]; (3) Negative valve overlap (NVO) [12]; (4) Improving fuel ignitability [13]. It should be 73 
noted that some of these methods are too complex and costly, even difficult, to implement for a RE engine. Moreover, 74 
the control of a NVO or VCR system is another difficult problem. 75 
Since the changes in engine operating condition of RE engine are not as dynamic as in a conventional vehicle, it 76 
increases the possibility of controlling HCCI combustion for RE application. This paper, therefore, describes the design 77 
of a high-efficiency, low-emission HCCI engine for RE application which focuses on using a simple method for running 78 
HCCI with low retrofitting costs. Since fossil fuel reserves might be depleted due to limited resources, DME alternative 79 
fuel is selected as main fuel for HCCI operation after the analysis of in-cylinder compression temperature. Experiments 80 
are then executed to observe HCCI operating characteristics and identify methods for controlling HCCI combustion. This 81 
Since the HCCI combustion occurs by self-ignition, the self-ignition property of fuels becomes an important factor 102 
that affects the HCCI operation. In order to select the proper fuel for HCCI operation, in-cylinder gas temperature is 103 
calculated from the cylinder pressure of motoring [14], as shown in Fig. 2. The comparison of self-ignition temperature 104 
of fuels and in-cylinder gas temperature are made to identify the crank angle that the combustion may occur. Hence, the 105 
DME alternative fuel and gasoline are chosen as a dual fuel for HCCI operation in the target engine (the properties of 106 
which are listed in Table 2). It can be seen from Fig. 2, DME can self-ignite easily in the target engine; however, 107 
gasoline is difficult to self-ignite without assistance. Consequently, gasoline can be chosen as an additive fuel to reduce 108 
ignitability of the dual fuel mixture. 109 
Table 2 110 
Fuel properties 111 
Fuel 
Lower heating 
value (MJ/kg) 
Octane 
Number 
Self-ignition 
temperature
 
(K) 
Viscosity at 
20
o
C (cP) 
DME 28.9 35 508 0.224 
Gasoline 44.4 92~98 553-729 0.74 
b
Self-ignition temperatures are obtained from MSDS sheet. 112 
 113 
After operating fuels are determined, the dual-fuel supplying system is retrofitted on the target engine, as shown in 114 
Fig. 3. The original fuel and ignition systems are kept for starting the engine. The original gasoline injector is also used 115 
to provide gasoline as an additive fuel for HCCI operation. An additional DME supplying system, which includes a small 116 
DME tank, pressure regulator, filter, surge tank, and a flow control valve, is attached to the target engine with a DME 117 
supplying tube installed near the intake port. After starting the engine using gasoline in SI mode and achieving a stable 118 
coolant temperature, the controller can switch the engine operation to HCCI mode with dual fuel by controlling the duty 119 
cycle of the DME flow control valve and injection duration of the gasoline injector. In order to measure the gasoline and 120 
DME flow rate during engine experiments, the gasoline flow meter, gasoline defoaming tank, and DME flow meter are 121 
attached to the dual-fuel supplying system. 122 
The configuration of the designed HCCI engine is shown in Fig. 4. Even though previous studies have shown that 123 
internal EGR can be generated by NVO, controlling EGR ratio is not as simple as having an external EGR system. In 124 
addition, the retrofit of valve train geometry of the target engine will add quite a few complexities. The external EGR 125 
system is, therefore, established on the target engine with a small EGR pump and an EGR control valve which can be 126 
intake system (CO2%)intake and exhaust system (CO2%)exhaust as in Eq. 1 [13]. The measured CO and CO2 percentages in 154 
exhaust system are further utilized to obtain the combustion efficiency (ηc) using Eq. 2 [16]. 155 
%100
%)(
%)(
%
2
2 
exhaust
intake
CO
CO
EGR                                  (1) 156 
%%
%
2
2
COCO
CO
c

                                       (2) 157 
After determination of fuels, engine temperature, and fuel injection timing, the HCCI combustion is executed on the 158 
target engine. At first, the target engine is started up using SI mode with original ignition and fuel systems. When the 159 
coolant and oil temperatures reach 70
o
C and 65
o
C respectively, the engine is switched to HCCI mode by interrupting the 160 
ignition system and turning the throttle to wide open throttle (WOT), while fuel supply is adjusted for stable HCCI 161 
operation. Experiments are then done at various DME flow rates, engine speeds, EGR ratios, and gasoline additive ratios 162 
for investigating the operating characteristics of HCCI combustion. The methods for controlling HCCI combustion using 163 
dual fuel and external EGR are identified, as well. After that, a series of experiments for identifying the operating range 164 
of HCCI on the target engine is performed. Finally, some HCCI operating points with lower BSFC are selected as 165 
candidates of RE operation for a power management strategy. 166 
 167 
3. Results and Discussions 168 
3.1. HCCI operating characteristics 169 
HCCI operating characteristics of changing DME flow rate, EGR ratio, and gasoline additive ratio in the target 170 
engine are investigated from experiment-measured data. The operating characteristics include: combustion temperature, 171 
combustion rate, and combustion stability. One experimental data sets for the analysis include: (1) changing DME flow 172 
rate without gasoline additive and introducing EGR at 3000rpm; (2) changing EGR introduction ratio at 3000rpm while 173 
fixing DME flow rate and gasoline additive ratio at 0.1804g/s and 29%, respectively; (3) varying gasoline additive ratio 174 
at 3000rpm while fixing DME flow rate at 0.1780g/s without EGR introduction. 175 
Combustion temperature and combustion stability can be conjectured from combustion efficiencies shown in Figs. 176 
6-8. It can be observed from Fig. 6, the combustion efficiency increases with increasing DME mass flow rate. That 177 
indicates the HCCI combustion becomes more stable with richer AFR. Higher combustion efficiency also results from 178 
higher combustion temperature due to richer AFR [17]. However, the introduction of EGR will reduce the combustion 179 
Since the DME is in gaseous state at ambient pressure and temperature, the atomization problem and wall-wetting 207 
effects can be eliminated while delivering the DME into the intake manifold. This can further ensure that there is no 208 
liquid fuel entering the cylinder directly. In addition, the quench layer that results in HC emission becomes insignificant 209 
for pure DME operation as compared to that of liquid fuels. As observed in Fig. 12, the HC emission decreases slightly 210 
with increasing DME flow rate. This is mainly because the combustion becomes more stable for richer AFR operation. 211 
Due to the reduction of combustion temperature and deterioration of combustion stability after EGR introduction, the HC 212 
emission increases with increasing EGR ratio, as shown in Fig. 13. As compares with Figs. 12-14, HC emission will be 213 
significantly increased after the gasoline is added in, due to an atomization problem caused by the low-pressure injection 214 
system and quench layer. In addition, the results shown in Fig. 14 also indicate that HC emission increases with higher 215 
gasoline additive ratio even though the combustion becomes more stable. 216 
NOx emission will be produced due to longer combustion duration under higher combustion temperature and 217 
sufficient in-cylinder O2 concentration [19]. Since the combustion rate will be hastened and the O2 concentration will be 218 
reduced with richer AFR, NOx emission reduces with increasing DME flow rate, as shown in Fig. 12. It can be seen from 219 
Fig. 13, NOx emission can be reduced with higher EGR ratio because the EGR introduction will further decrease the 220 
combustion temperature. The gasoline additive will stabilize the HCCI combustion while increasing combustion 221 
temperature which will result in higher NOx emission for higher gasoline additive ratio, as shown in Fig. 14. 222 
Since the target engine is operated with WOT under HCCI mode, three methods are, therefore, concluded for 223 
controlling HCCI operating torques. The simplest method is to enrich the operation AFR as shown in Fig. 15. However, 224 
increases in brake mean effective pressure (BMEP) are limited, due to the knocking effect caused by a higher combustion 225 
rate. The negative work for combustion upon compression stroke will also limit torque output. The EGR introduction and 226 
gasoline additive in DME are, therefore, better methods for enlarging the BMEP in the target engine, which can be 227 
observed in Figs. 16-17. The introduction of EGR will slow down the combustion reaction; therefore, negative work for 228 
combustion upon compression stroke will be effectively reduced and higher torque output is promoted. Since the 229 
gasoline additive in DME could be employed to retard the combustion timing due to reduction of ignitibility of the dual 230 
fuel mixture, higher combustion rate in compression stroke can be constrained to reduce the negative work even though 231 
overall AFR is enriched (DME + gasoline) for larger torque output as shown in Fig. 17. 232 
 233 
because the operating range of RE is limited. The intake heating system requires a high power heater to warm up the 260 
intake air in a short period, so the control of air temperature is indeed slower. 261 
 262 
4. Conclusions 263 
A HCCI engine is designed for RE application with a simple control method and low retrofitting costs. The target 264 
engine is a 500cc spark ignition engine with modified compression ratio by reducing its clearance volume. After the 265 
analysis of in-cylinder gas temperature during compression stroke, DME alternative is selected as main fuel for HCCI 266 
operation and gasoline can be selected as an additive fuel to adjust the ignitibility of dual fuel mixture made from DME 267 
and gasoline. In order to control the HCCI combustion, adjusting dual fuel ignitibility and introducing external EGR are 268 
considered. Experiments involving changing DME flow rate, EGR ratio, and gasoline additive ratio are, therefore, 269 
executed to observe HCCI operating characteristics and identify methods for controlling HCCI combustion. Since the 270 
target engine is operated with WOT under HCCI mode, three methods are, therefore, concluded for controlling HCCI 271 
operating torques. The simplest method is to enrich the operation AFR; however, the knocking effect caused by higher 272 
combustion rate and the negative work for combustion upon compression stroke will limit the torque output. EGR 273 
introduction and gasoline additive in DME are, therefore, better methods for enlarging the torque output. EGR will slow 274 
down the combustion reaction; therefore, the negative work will be effectively reduced and promote higher torque output. 275 
Since the gasoline additive in DME could retard the combustion timing, higher combustion rates upon compression 276 
stroke can be constrained, which helps to enlarge the output torque by enriching overall in-cylinder AFR. Consequently, 277 
the largest BMEP and lowest BSFC found for HCCI operation is 476kPa and 181g/kW-h respectively at 3000rpm with 278 
29% gasoline additive in DME and introducing a 26.5% EGR ratio. Finally, three HCCI operating points, whose power 279 
outputs are 3.6kW, 5.9kW, and 7.8kW, are provided as candidates of RE operation for power management strategy. 280 
These selected operating points are found to have lower BSFC (< 250g/kW-h) and lower CO and NOx emissions as 281 
compared with original SI mode operation. 282 
 283 
Acknowledgement 284 
[11] Haraldsson G, Tunestål P, Johansson B, Hyvönen J. HCCI Combustion Phasing in a Multi Cylinder Engine Using 311 
Variable Compression Ratio. SAE Paper No. 2002-01-2858; 2002. 312 
[12] Zhong S, Jin G, Wyszynski ML, Xu H. Promotive Effect of Diesel Fuel on Gasoline HCCI Engine Operated with 313 
Negative Valve Overlap (NVO). SAE Paper No. 2006-01-0633; 2006. 314 
[13] Yao M, Chen Z, Zheng Z, Zhang B, Xing Y. Effect of EGR on HCCI Combustion Fuelled with Dimethyl Ether 315 
(DME) and Methanol Dual-Fuels. SAE Paper No. 2005-01-3730; 2005. 316 
[14] Wu YY, Chen BC, Hsieh FC, Ke CT. Heat Transfer Model for Small-Scale Spark-Ignition Engines. Int. J. Heat 317 
Mass Transf. 2009; 52: 1875-86. 318 
[15] Wu YY, Jang CT, Chen BL. Combustion Characteristics of HCCI in Motorcycle Engine. J. Eng. Gas. Turbines 319 
Power-Trans. ASME 2010; 132: 044501-1-4. 320 
[16] Lee CC, Lin SD. Handbook of Environmental Engineering Calculation 2nd Edition. McGraw-Hill, P. 2.177-2.178; 321 
2007. 322 
[17] Wu YY, Tsai HC, Liu TC. Investigation of Running HCCI with Dual-Fuel in a Small Scale Engine. ASME 2010 323 
Internal Combustion Engine Division Fall Technical Conference, San Antonio, Texas; 2010. 324 
[18] Sjöberg M, Dec JE. An Investigation into Lowest Acceptable Combustion Temperatures for Hydrocarbon Fuels in 325 
HCCI Engines. Proc. Combust. Inst. 2005; 30: 2719-26. 326 
[19] Turns SR. An Introduction to Combustion Concepts and Applications Second Edition. McGraw-Hill; 2006. 327 
328 
EGR Control Valve
EGR Pipe
Gasoline
Supply
EGR 
Temperature
Exhaust 
Temperature
Intake 
Temperature
Oil 
Temperature
EGR Pump Water Filter
Throttle
Surge Tank
Ambient 
Temperature
Spark 
Plug
DME 
Supply
Coolant 
Temperature
 337 
Fig. 4. Configuration of the designed HCCI engine. 338 
 339 
 340 
Fig. 5. MotoHawk ECU 555-80 controller. 341 
 342 
 343 
Fig. 6. Combustion and thermal efficiencies at 3000rpm with pure DME while changing DME flow rate. 344 
 345 
 357 
Fig. 10. Emissions of CO and CO2 at 3000rpm with fixed DME flow rate and gasoline additive ratio while changing 358 
EGR ratio. 359 
 360 
 361 
Fig. 11. Emissions of CO and CO2 at 3000rpm with fixed DME flow rate while changing gasoline additive ratio. 362 
 363 
 364 
Fig. 12. Emissions of HC and NOx at 3000rpm with pure DME while changing DME flow rate. 365 
 366 
 377 
Fig. 16. BMEP at 3000rpm with fixed DME flow rate and gasoline additive ratio while changing EGR ratio. 378 
 379 
 380 
Fig. 17. BMEP at 3000rpm with fixed DME flow rate while changing gasoline additive ratio. 381 
 382 
 383 
Fig. 18. Engine BMEP range of HCCI mode operation. 384 
 385 
 395 
Fig. 22. HC and NOx emissions of selected operating points for RE. 396 
 397 
 398 
 
 
 
Wu et al., Aerosol and Air Quality Research, 12: 1289–1297, 2012 1290
tremendously decreased by 92.9% and a relatively low 
combustion temperature in lean burn decreases NOx by 
32%. Furthermore, brake specific fuel consumption (BSFC) 
decreases to 11% compared with an original gasoline engine 
at low- and part load. As a result, SDI engine produces 
lower CO2, as well. From this result, we can affirm that 
SDI system in motorcycle engine can help to improve air 
quality and reduce greenhouse gas.  
To become a viable product, the SDI system should 
reduce CO2, as well as exhaust pollution. This could be 
achieved with a method that allows switching between 
stratified mixture at low load, and a homogeneous mixture 
at full load. This cannot be done in the current design. The 
SDI engine could have better results with CO2 and exhaust 
emission if there were an increase in the stratification of 
mixture. Ohm and Cho (2000) compared the lean limit of 
gasoline engine with different fuel types, the results of 
which showed that by decreasing Sauter mean diameter 
(SMD) of fuel drop, which allows enough time for the fuel 
to evaporate, or using an alternative fuel, which evaporates 
more completely, the result would be better stratification 
and increased lean limit. Khan et al. (2009) also had the 
same result.  
However, using a high-pressure injector increases the 
cost of the system. Liquefied petroleum gas (LPG) in 
gaseous phase could be an alternative fuel for an SDI 
system. Previous research has observed that the brake 
mean effective pressure (BMEP) of gasoline is higher than 
LPG, while LPG fuel consumption and emission, which 
includes CO, HC and CO2, are lower than gasoline (Saraf 
et al., 2009; Shanmugam et al., 2010). Campbell et al. 
(2004) compared the lean limit of a homogeneous mixture 
of gasoline and LPG at gaseous phase and the results 
showed that the lean limit of LPG is better than gasoline. 
Khan et al. (2006) compared the exhaust emission of new 
European driving cycle (NEDC) between gasoline and 
LPG of a V6 engine when the air/fuel ratio increases. The 
results show that the HC, NOx and CO emission could be 
reduced by 30%, 98% and 90%, respectively, and achieve 
EURO 4 without the aid of a reducing catalyst. Also, the 
reduction of CO2 achieves 33% at an air/fuel ratio of 17.6, 
and increases to 40% at an air/fuel ratio of 23.5. It could be 
concluded that using LPG in gaseous phase for SDI engine 
should improve air quality without the use of a catalytic 
converter.  
The purpose of this research was to design a new SDI 
system, which allows control of homogenous and stratified 
modes, and to investigate experimentally the effects of SDI 
using LPG on fuel consumption and exhaust emission of a 
motorcycle engine with various engine speeds at low loads. 
A complete engine performance map under half-load 
operation was conducted for comparison between SDI and 
conventional gasoline engines. 
 
EXPERIMENTAL SETUP 
 
Test Engine 
The experiments were carried out with a 125 cc single-
cylinder, air-cooled, 4-valve motorcycle engine produced 
by SANYANG Industry Co., Ltd. Detailed specifications of 
the test engine are shown in Table 1. The fuel was supplied 
by an electronic fuel injection (EFI) system. 
The experimental setup for engine testing is shown in 
Fig. 1. For the engine test, a Borghi & Saveri Srl FE150-S 
eddy-current engine dynamometer was employed to 
measure the engine output torque and speed. Dynamometer 
torque was calibrated to range from 0 to 30 Nm with 
several standard weights for precise torque measurement. 
Fuel flow rate was measured by using ONO SOKKI FX-
1110 mass burette flow detectors. LPG flow was measured 
by thermal mass flow meter TF-4000 combined with digital 
indicator. A thermocouple was located on the LPG pipe to 
measure gas temperature. Exhaust emissions, including 
CO, HC, NOx, CO2, O2, and air/fuel ratio were measured 
with a HORIBA MEXA-584L.  
The cylinder pressure was measured using a Kistler 
6051B uncooled piezoelectric pressure transducer. The crank 
angle (CA) was detected by a shaft encoder (BEI H25). The 
output signal of the pressure transducer was amplified using 
a charge amplifier. This amplified signal was transmitted to 
a data acquisition system which was an AVL IndiCom 619 
combustion analyzer. The cylinder pressure was recorded 
every 1°CA for 100 cycles.  
LPG with a composition of 50% propane and 50% butane 
was used. LPG pressure was controlled by a LPG pressure 
regulator. The gasoline fuel used for the comparison with
 
Table 1. Engine specifications. 
Engine Type Four-stroke, air cooled, four-valve, overhead camshaft (OHC) 
Bore × Stroke 52.4 mm × 57.8 mm 
Number of Valves 4 
Displacement 124.6 cc 
Compression Ratio 10.5 
Idle Speed 1600 ± 100 rpm 
Fuel System EFI, port injection 
Ignition Type Direct Current Transistor 
Intake Valve Open* 10° before top dead center (BTDC) 
Intake Valve Close* 20° after bottom dead center (ABDC) 
Exhaust Valve Open* 30° before bottom dead center  (BBDC) 
Exhaust Valve Close* 10° after top dead center (ATDC) 
* Valve timing is defined at 1 mm of valve lift. 
 
 
 
Wu et al., Aerosol and Air Quality Research, 12: 1289–1297, 2012 1292
 
Fig. 2. Schematic of intake port: (a) Homogeneous mode, 
(b) Stratified mode. 
1) Two intake valves; 2) Swirl port; 3) Swirl control plate; 
4) Swirl control plate shaft. 
 
al. (2005) reviewed a vast body of literature on the 
solution for the part-load problem and found that stratified 
charge was one of the most promising methods to decrease 
the fuel consumption at part load. Therefore, the engine 
performance map of SDI focuses on part load. 
The motorcycle emission regulations of many countries 
follow the ECE-40 driving cycle. Fig. 4 shows the engine 
BMEP curve as a solid line and ECE-40 operating points 
as triangle markers of the target motorcycle’s 125 cc 
engine. The square line in Fig. 4 is located within an engine 
speed of 3500 to 5500 rpm, and BMEP from 1 to 4 bar, 
which consists of most ECE-40 operating points. The 
engine performance map tests proceeded within this range; 
i.e., engine speed from 3500 to 5500 rpm with stepwise 
increments of 500 rpm, and BMEP from 1 to 4 bar with 
stepwise increments of 0.5 bar. 
The gasoline injection pressure was 2.45 bar and LPG 
was 1.5 bar. The injection timing of PFI was set at 90° 
BTDC of exhaust stroke, and that of SDI was set at 180° 
end of intake stroke (Guo et al., 2011). The fuel injection 
duration of PFI was controlled to obtain stoichiometric 
air/fuel ratio, and that of SDI was controlled to run at lean 
combustion with a constraint of coefficient of variation 
(COV) less than 10%, which is the limitation of drivability. 
The spark advance was controlled at maximum brake torque 
(MBT).  
The data taken from engine testing were: engine speed, 
torque, brake specific energy consumption (BSEC), brake 
specific CO2 emission (BSCO2), brake specific CO emission 
(BSCO), brake specific HC emission (BSHC), brake specific 
NOx emission (BSNOx). Here, the evaluation index of fuel 
consumption, BSEC (MJ/kW.h) was used because the lower 
heat value per unit mass was different between gasoline 
and LPG. Brake specific emissions are defined as the mass 
emission rates divided by the engine brake horsepower. 
The mass emission rates were calculated according to SAE 
J1088 and d’Ambrosio et al. (2011).  
 
RESULTS AND DISCUSSION 
 
Effect of Lean Burn on Exhaust Pollution 
Fig. 5 shows the effect of relative air/fuel ratio on CO, 
NOx and HC at 4300 and 5000 rpm low loads of the original 
gasoline engine, original LPG engine and SDI engine. 
Relative air/fuel ratio is the ratio of the actual air/fuel ratio 
to the stoichiometric ratio. The value of CO concentration 
increases steadily with decreased relative air/fuel ratio. From 
1.3, the CO concentrations in the exhaust vary little with 
relative air/fuel ratio. Around 1.1, CO emission produced by 
SDI engine is even lower than original gasoline engine for 
two kinds of fuel. Lower CO emission may be due to high 
turbulence intensities in SDI engine combustion, so CO 
easily interacts with O2 or OH to become CO2. 
 
 
Fig. 3. Comparison of flow coefficient of original and new design intake port. 
 
 
 
Wu et al., Aerosol and Air Quality Research, 12: 1289–1297, 2012 1294
 
Fig. 6. Brake specific energy consumption (MJ/kW.h) maps 
and ECE-40 operating points (▲) in low-load region: (a) 
original gasoline engine, (b) SDI engine.  
 
stratified mixture inside the cylinder, so it could reduce time 
and heat loss which would increase combustion efficiency 
(Yamamoto, 1999). Extending the lean limit of SDI engine 
to 1.7 of relative air/fuel ratio will reduce pumping loss, 
which is a key to friction loss in SI engine. That is the 
reason why SDI engine produces the lowest CO2 emission 
(Khan et al., 2006; Guo et al., 2011). 
Fig. 8 shows the BSCO maps of SDI engine and original 
gasoline engine in low loads. The BSCO of original engine 
is much higher than that of SDI. By taking the average of 
all testing points in the map, BSCO is reduced 94% for 
SDI compared with regular gasoline engine. The SDI engine 
is running at lean burn with relative air fuel ratio around 
1.6 to 1.7, while the original gasoline engines are operated 
with a stoichiometric mixture (relative air/fuel ratio  1). 
So the CO emission of SDI engine must be lower than that 
of original gasoline engine (Khan et al., 2006). Carbon 
monoxide, which has been the focus of many environmental 
studies (Colbeck et al., 2011; Ma et al., 2011) is highly toxic 
to humans. The current study’s reported results contribute 
greatly to reducing carbon monoxide in the atmosphere.  
Fig. 9 shows the BSHC maps of SDI engine and original 
 
Fig. 7. Brake specific carbon dioxide (g/kW.h) maps and 
ECE-40 operating points (▲) in low-load region: (a) original 
gasoline engine, (b) SDI engine. 
 
engine in low loads. BSHC of SDI engine is higher than 
that of original gasoline. By taking the average of all testing 
points in the map, the increase in BSHC is 4.57% for SDI, 
as compared with original gasoline engine. It could be 
explained that the HC emission is the consequence of 
incomplete combustion of hydrocarbon fuel, this might 
come from very lean regions at the periphery of the stratified 
charged fuel cloud (Håkan et al., 2000; James et al., 2003). 
Fig. 10 shows the BSNOx maps of SDI engine and 
original gasoline engine in low loads. BSNOx of SDI engine 
is pretty low. By taking the average of all testing points in 
the map, the reduction of BSNOx for SDI is 47.0%, as 
compared with original gasoline engine. It could be 
explained that the principal source of NOx is the oxidation 
of atmospheric nitrogen, which is temperature and oxygen 
concentration dependent (Lee et al., 2006; Wang et al., 
2012). In homogeneous charge combustion, NOx emission 
increases tremendously because its air/fuel ratio is close to 
the peak value for NOx emission production. In this 
research, however, the lean limit of SDI achieves 1.7 of 
relative air/fuel ratio, so the NOx emission decreases 
further (Khan et al., 2006). Since NOx is an important gas 
 
 
 
Wu et al., Aerosol and Air Quality Research, 12: 1289–1297, 2012 1296
 
Fig. 10. Brake specific oxides nitrogen (g/kW.h) maps and 
ECE-40 operating points (▲) in low-load region: (a) original 
gasoline engine, (b) SDI engine. 
 
REFERENCES 
 
Campbell, M., Wyszyński, Ł.P. and Stone, R. (2004). 
Combustion of LPG in a Spark-Ignition Engine. SAE 
Paper No 2004-01-0974. 
Chuang, S.C., Chen, S.J., Huang, K.L., Chang-Chien, G.P., 
Wang, L.C., Huang, Y.C., (2010). Emissions of 
Polychlorinated Dibenzo-p-dioxin and Polychlorinated 
Dibenzofuran from Motorcycles. Aerosol Air Qual. Res. 
10: 533–539. 
Colbeck, I., Nasir, Z.A., Ahmad, S. and Ali, Z. (2011). 
Exposure to PM10, PM2.5, PM1 and Carbon Monoxide on 
Roads in Lahore, Pakistan. Aerosol Air Qual. Res. 11: 
689–695.  
d’Ambrosio, S., Finesso, R. and Spessa, E. (2011). 
Calculation of Mass Emissions, Oxygen Mass Fraction 
and Thermal Capacity of the Inducted Charge in SI and 
Diesel Engines from Exhaust and Intake Gas Analysis. 
Fuel 90: 152–166. 
Guo, Y.M., Tran, A.T. and Wu, Y.Y. (2011). An 
Investigation on Lean Burn for Semi-Direct Injection 
Engine by Using Liquefied Petroleum Gas, The 16th 
National Conference on Vehicle Engineering, Taipei. 
Håkan, S., Ronny, L. and Ingemar, D. (2000). Sources of 
Hydrocarbon Emissions from a Direct Injection Stratified 
Charge Spark Ignition Engine. SAE Paper No 2000-01-
1906. 
Hu, E., Huang, Z., Liu, B., Zheng, J. and Gu, X. (2009). 
Experimental Study on Combustion Characteristics of a 
Spark-Ignition Engine Fueled with Natural Gas-Hydrogen 
Blends Combining with EGR. Int. J. Hydrogen Energy. 
34: 1035–1044. 
Huang, Z., Shiga, S., Ueda, T., Nakamura, H., Ishima, T., 
Obokata, T., Tsue, M. and Kono, M. (2003). Effect of 
Fuel Injection Timing Relative to Ignition Timing on the 
Natural-Gas Direct-Injection Combustion. J. Eng. Gas 
Turbines Power. 125: 783–790 
James, H., Zhiyu, H. and Top, C. (2003). Unburned 
Hydrocarbon Emissions from Stratified Charge Direct 
Injection Engines. SAE Paper No 2003-01-3099. 
Khan, M.A., Watson, H.C. and Baker, P. (2009). Mixture 
Preparation Effects on Gaseous Fuel Combustion in SI 
Engines. SAE Paper No 2009-01-0323. 
Khan, M.A., Watson, H.C., Baker, P. and Liew, G. (2006). 
SI Engine Lean-Limit Extension through LPG Throttle-
Body Injection for Low CO2 and NOx. SAE Paper No 
2006-01-0495. 
Kim, C.H., Perry, K., Viola, M., Li, W. and Narayanaswamy, 
K. (2011). Three-Way Catalyst Design for Urealess Passive 
Ammonia SCR: Lean-Burn SIDI Aftertreatment System. 
SAE Paper No 2011-01-0306. 
Kumar, U., Prakash, A. and Jain, V.K. (2008). A 
Photochemical Modelling Approach to Investigate O3 
Sensitivity to NOx and VOCs in the Urban Atmosphere 
of Delhi. Aerosol Air Qual. Res. 8: 147–159. 
Kutlar, O.A., Arslan, H. and Calik A.T. (2005). Methods 
to Improve Efficiency of Four Stroke, Spark Ignition 
Engines at Part Load. Energy Convers. Manage. 46: 3202–
3220. 
Lee, C.L., Jou, C.J.G., Tai, H., Wang, C.H., Hsieh, S.C. 
and Paul Wang, H. (2006). Reduction of Nitrogen Oxide 
Emission of a Medium-Pressure Boiler by Fuel Control. 
Aerosol Air Qual. Res. 6: 123–133.  
Lou, J.C., Hung, C.M. and Huang, L.H. (2003). Selective 
Catalytic Reduction of NO by Methane on Copper 
Catalysts: The Effects of Modifying the Catalysts with 
Acids on γ-alumina. Aerosol Air Qual. Res. 3: 61–73. 
Ma, C.M., Hong, G.B. and Chang, C.T. (2011). Influence of 
Traffic Flow Patterns on Air Quality inside the Longest 
Tunnel in Asia. Aerosol Air Qual. Res. 11: 44–50.  
Ohm, I.Y. and Cho, Y.S. (2000). Mechanism of Axial 
Stratification and Its Effect in an SI Engine. SAE Paper 
No 2000-01-2843. 
Pecqueur, M., Ceustermans, K., Huyskens, P. and Savvidis, 
D. (2008). Emissions Generated from a Suzuki Liane 
Running on Unleaded Gasoline and LPG under the Same 
Load Conditions. SAE Paper No 2008-01-2637. 
SAE J1088 (1993). Test Procedure for the Measurement of 
Exhaust Emissions from Small Utility Engines, SAE 
Recommended Practice. 
Saraf, R.R., Thipse, S.S. and Saxena, P.K. (2009). 
Semi-Direct Injection Engine Modeling 
for Real Time Control 
Yuh-Yih Wu1, a, Bo-Chiuan Chen1,b and Anh-Trung Tran1,c  
1National Taipei University of Technology, TAIWAN  
Department of Vehicle Engineering  
1, Sec. 3, Chung-Hsiao E. Rd. Taipei 106, TAIWAN 
Phone: (886-2)27712171 ext 3620 
Fax: (886-2)27314990  
acyywu@mail.ntut.edu.tw, bbochen@mail.ntut.edu.tw, ctrantrungice@gmail.com 
Keywords: Semi-direct injection, Engine model, Pressure intake manifold, Heat release rate, Air 
motion, Lean burn. 
Abstract. The Semi-Direct Injection (SDI) system has been shown to improve small engine 
efficiency and exhaust by utilizing a lean burn method. In order to better understand how to more 
readily utilize the control systems in SDI engine, the real-time operation of an SDI engine was 
modeled. A charging model was developed by using a filling-and-emptying model to simulate air 
exchange in an engine, including varying the intake manifold structure. A single-zone model was 
applied to a combustion model and the effects of air/fuel ratio and swirl ratio on combustion 
duration were also considered. The calculated results of the intake manifold pressure, heat release 
rate, and cylinder pressure were compared with the experimental data. The results of this study 
show that this modeling process approximates reality.  
Introduction 
World-wide interest in critical fuel supplies and emissions has developed particularly in the 
automobile industry. Automobile emissions standards, adopted in many countries, challenge vehicle 
manufacturers to develop improved engine designs. A number of directions, such as improving 
engine operation efficiency and reducing emissions, are crucial in not only for the industry, but also 
on a research scale. To date, a few methods exist to improve engine efficiency. Port fuel injection 
(PFI), which injects fuel into an engine’s intake port, has been widely applied in electronic fuel 
injection systems. High performance engine with low fuel consumption and low emissions can be 
obtained through employing GDI (Gasoline Direct Injection). GDI is not appropriate for 
motorcycles due to high manufacturing costs, as well as certain technical problems associated with 
small engines. Semi-direct injection (SDI) is expected to possess advantages of both GDI and PFI 
for motorcycle engines. The system includes air-assisted fuel injection, an intake swirl control 
valve, and injecting the fuel into port during the intake valve opening. Results [1][2] show that SDI 
performs better than PFI in an engine. 
As part of a system for engine control, an Engine Control Unit (ECU) significantly improves 
system efficiency. A well-designed ECU, particularly in SDI engine, is a key approach to ensure 
optimized engine performance, low exhaust emissions, and high efficiency [3]. In developing an 
ECU, a graphical dynamic system simulation software for model-based control, such as 
MATLAB/SIMULINK, has attained increased research interest as automotive engineers strive to 
reduce development time and costs [4]. This has increased the demand for developing engine 
models. In our previous research [5], valve actions and an accurate engine model were established 
for various applications. It is, however, difficult to simulate the effect of a stratified charger on 
combustion efficiency.  
Advanced Materials Research Vols. 347-353 (2012) pp 2504-2510
Online available since 2011/Oct/07 at www.scientific.net
© (2012) Trans Tech Publications, Switzerland
doi:10.4028/www.scientific.net/AMR.347-353.2504
All rights reserved. No part of contents of this paper may be reproduced or transmitted in any form or by any means without the written permission of TTP,
www.ttp.net. (ID: 140.124.141.175-22/11/11,16:31:41)
thA
atmP
inm
valinA ,
cylP
imP
StrHom /
cylinm ,
 
 
Fig. 2. Block diagram of the intake air dynamics in the charging model 
 
Throttle body, intake manifold, and intake valve are the three major structures of the intake air 
dynamics, as shown in Fig. 2. The isentropic compressible flow equation consisting of non-choked 
and choked flow dynamics are applied on throttle body dynamics, as shown in Eqs. (1) (2). 
 
1
11 2
,
,
2
1
1
atm
atm atm
f im th atm im atm im
in th
atm atm atmatm atm
C A P P P
m
P PR T
γ
γ γγ
γ
−  
     = −     −       
 ,    for 
1
1
2 −






+
>
atm
atm
atmatm
im
P
P γ
γ
γ
                      (1)  
     
1
2( 1)
,
,
2
1
atm
atm
f im th atm
in th atm
atmatm atm
C A P
m
R T
γ
γ
γ
γ
+
− 
=  
+ 
 ,     for 
1
1
2 −






+
≤
atm
atm
atmatm
im
P
P γ
γ
γ
                                                    (2) 
 
Briefly, the mass flow rate can be expressed as:  
 
( )imatmatmatmatmthimfin PRPTACfm ,,,,,,, γ=                    (3) 
 
where inm  is the mass airflow through the throttle body; imfC ,  is the discharge coefficient of the 
intake manifold; atmR  is the ideal gas constant of air; atmγ  is the specific heat ratio of air; atmT  and 
atmP  are the temperature and pressure of the atmosphere, respectively; thA is the cross-section area 
of the throttle body; imP is the pressure in the intake manifold. 
The intake manifold pressure can be calculated by using the state equation for ideal gas as: 
 
( )
( )
cylinin
strim
imimim mm
V
TR
dt
dP
,
hom/
 −=                        (4) 
 
where imR  is the ideal gas constant in the intake manifold; imT  is the temperature of the intake 
manifold; ( )strimV hom/ is the volume of intake manifold and difference value in homogeneous and 
stratified mode; cylinm ,  is the air mass flow rate from the intake manifold into the cylinder. This 
calculation is similar to Eqs. (1, 2) and expressed as: 
 
( )( )cylimimimimivstrivfcylin PRPTACfm ,,,,,,hom/,, γ=                                              (5) 
 
where ( )strivfC hom/,  is the flow coefficient of the intake valve for homogeneous and stratified mode; 
ivA  is the cross-section area of the intake valve; imR  is the ideal gas constant in the intake manifold; 
imγ  is the specific heat ratio in the intake manifold; imT is the temperature in the intake manifold; 
and cylP  is the pressure in the cylinder. 
2506 Renewable and Sustainable Energy
Where n is engine speed with the unit of rev/min; SA is spark advance with the unit of degree of 
crank angle; CBdelay is combustion delay; ai and bi are coefficients obtained from the curve fitting of 
experimental results. The coefficient of determination RS is used to evaluate correlation between 
measured and predicted value of 0θ  and dθ , which can be expressed as: 
 
( )
( )∑
∑
=
=
−
−
=
n
i
i
n
i
i
S
xx
xx
R
1
2
1
2
ˆ
                  (11) 
 
Where x is the experimental data; x is the mean value of experimental data; and xˆ  is the predicted 
data. Here, RS ranges between 0 and 1. If RS is close to 1, the curve fitted result is close to actual 
value, and vice versa. The resulting correlation of 0θ  and dθ  are shown in Figs. 4 and 5, 
respectively. Since RS of the proposed model for 0θ  and dθ  are equal to 0.9924 and 0.9908, 
respectively, the simulated results are determined to be very close to the experimental data.  
 
Fig. 4.  Correlation between simulated and 
measured of combustion delay 
Fig. 5.  Correlation between simulated and 
measured of combustion duration 
Result and discussion 
The pressure intake manifold (PIM), heat-release rate, and cylinder pressure between experimental 
and engine model data were compared. The experiment tested three conditions following the 
operational curve of the ECE-40 driving cycle: 4000 rpm, 4700 rpm, and 5300 rpm at 1.5 bar, 2 bar, 
and 3 bar of BMEP, respectively. All experiments were conducted in both homogeneous and 
stratified mode. For homogeneous mode, engine was operated with stoichiometric combustion 
(λ=1). For stratified mode, engine was run with lean combustion and λ was chosen at minimum fuel 
consumption.   
For the ECU system, PIM is an important signal for calculating air mass. If the intake system model 
has been estimated accurately, the time to do this step in the experiment will be reduced. So PIM is 
used to verify the charging model. Volumetric efficiency was compared [5]. Fig. 6 compares the 
PIM of model and measurement. The PIM measurement was taken with a manifold absolute 
pressure sensor and sampled at 30 degrees After Bottom Death Center (ABDC). This position 
represents high linearity and accuracy [7]. The outcome shows that the predicted results are very 
good. 
2508 Renewable and Sustainable Energy
The comparison of simulated and measured cylinder pressures are shown in Figs. 9 and 10 for an 
engine speed of 4700 rpm. The cylinder pressure measurement was taken with a piezo-electric 
pressure transducer [8]. The simulated results were shown to be good and the computation time was 
very short (that was shorter than the physical real time). 
Conclusion 
(1)  A SDI engine model was developed and validated with experimental data. Results show that 
the modeling process is close to reality and the computation time is very short. 
(2)  The engine model is suitable for developing a SDI engine control strategy. The predicted 
pressure intake manifold is precise enough.  
(3)  The effect of charge motion on combustion and relative air fuel ratio can be taken into account 
in the heat-release model. This will improve the accurate of engine model in transition mode 
between homogeneous and stratified. 
(4)  Future work should be done to verify heat-release rate with various swirl ratios and to show the 
SDI engine control in the application of this engine model. 
Acknowledgments 
This work was supported by grants from the National Science Council of Taiwan, R.O.C. under the 
contract No. NSC-99-2221-E-027-063-MY3. 
Reference 
[1] Y.Y. Wu, B.C. Chen and A.T. Tran in: Application of Semi-Direct Injection for Spark-ignition 
Engine, International journal of vehicle design IJVD-13031 (2010). 
[2] Y.Y. Wu, B.C. Chen and C.F. Liao in: Development of a Lean Burn Spark-Ignition Engine for 
Hybrid Electric Motorcycle, APAC conference 2009 paper no. APAC15-176. 
[3] J. Gerhardt, H. Hönninger and H. Bischof in: A New Approach to Functional and Software 
Structure for Engine Management Systems - BOSCH ME7, SAE conference 1998. Paper No. 
980801.  
[4] R.W. Weeks, and J.J. Moskwa in: Automotive Engine Modeling for Real-Time Control Using 
MATLAB/SIMULINK, SAE conference 1995. Paper No. 950417. 
[5] Y.Y. Wu, B.B. Chen, H.W. Chieh, and C.T. Hsien in: New charging model imparting the valve 
timing for real-time simulation, ICES conference 2009. Paper No ICES2009-76028.   
[6] J.B. Heywood: Internal Combustion Engine Fundamentals. McGraw-Hill, 1988. 727-728. 
[7] M. Nakamura, Y. Sawada, and S. Hashimoto in: Fuel Injection System for Small Motorcycles. 
SAE conference 2003. Paper No. 2003-32-0084. 
[8] Y.Y. Wu, Y.Y. Peng, and T.T. Gau in: Emission Control of Four-stroke Motorcycle Engine. 
SAE conference 1995. Paper No. 951760. 
2510 Renewable and Sustainable Energy
Engine Rotational Dynamics Calculation with Stroke Identification for 
Scooter Engine Using FPGA  
Yuh-Yih Wu, Bo-Chiuan Chen, Hsien-Chi Tsai, and Yu-Chuan Wang 
Department of Vehicle Engineering, National Taipei University of Technology, Taipei, Taiwan 
hc.tsai.chimo@gmail.com
Keywords: engine rotational dynamics; FPGA; stroke identification; robust kalman filter; HIL  
 
Abstract. Engine rotational dynamics can be estimated from the tooth signals of the crankshaft 
wheel. The accuracy of the calculation rises when the number of tooth increases. However, the 
engine control unit (ECU) needs to detect the tooth position and converts it into time information. It 
will overload the interrupt system. In order to overcome this problem, the field programmable gate 
array (FPGA) is proposed to implement the engine rotational dynamics calculation with stroke 
identification algorithm. The FPGA can accelerate the interpolation and the multiplication processes 
by implementing them in parallel computation. Thus, the proposed method can calculate the engine 
rotational dynamics in real time, and then the calculation results can be transferred into the robust 
Kalman filter which was established by Matlab/Simulink in a computer, i.e., a simulated ECU. 
Finally, a 125cc scooter is utilized to verify the proposed algorithm. The test results show that the 
proposed method can be used to obtain precise information of engine rotational dynamics. 
Introduction 
The engine management system (EMS) is an important system in automobile. The sensors of the 
system detect the engine operation modes, such as key on, cranking, idle, acceleration, and 
deceleration, and then the system outputs the control signal to the actuators. For example, in the 
cranking mode, the fuel should be enriched. In idle mode, the engine speed must be in close-loop 
control for the idle quality. Thus, the EMS is an essential system in automobile. 
EMS consists of two major parts: fuel injection and ignition control system. Obtaining the 
correct engine rotational dynamics is necessary to acquire the correct timings of the injection and 
the ignition. So the crank position sensor (CPS) signal is very significant because that is the basic 
input signal for EMS. Engine control unit (ECU) uses this signal to calculate the engine rotational 
dynamics, and decides the ignition and injection timings according to the stroke identification result. 
Using cam position sensor and CPS is able to obtain the more accurate stroke identification result. 
However, in scooter engine, cam position sensor is not used due to the space and cost limitation. As 
a result, the stroke identification strategy based on using the CPS must be employed.  
If the CPS signal is not correct, the ignition and injection timings will be wrong. Because the 
accuracy of the engine rotational dynamics increases with increasing the tooth signals, Rizzoni [1], 
Leteinturier [2], and Kuroda [3] proposed to use more tooth crankshaft wheels to measure the crank 
angle with digital filters. In such condition, the ECU needs to process every tooth, so it will 
overload the interrupt system. However, our previous study [4] proposed a robust Kalman filter to 
filter out the sensor noise and estimated the crank angle and engine speed. It used an external signal 
processing circuit to calculate the engine rotational dynamics. This method does not need to 
measure and calculate tooth signal in ECU. The ECU received the output of the external signal 
processing circuit, delivered to robust Kalman filter, and then calculated the timings of the ignition 
and the injection without noise and tooth processing. But the study was done only in the computer 
simulation, and it did not have the application on a real scooter engine. 
In order to realize the proposed system and maintain the ability to acquire engine position to 
avoid ECU overload, this paper used field programmable gate array (FPGA) to implement the 
external signal processing circuit and stroke identification algorithm to calculate engine rotational 
Applied Mechanics and Materials Vols. 110-116 (2012) pp 5314-5321
© (2012) Trans Tech Publications, Switzerland
doi:10.4028/www.scientific.net/AMM.110-116.5314
All rights reserved. No part of contents of this paper may be reproduced or transmitted in any form or by any means without the written permission of TTP,
www.ttp.net. (ID: 140.124.35.40-03/10/11,13:09:58)
iii
i
t∆
−
= −1
ωω
α                                                                 (2) 
where 1−−=∆ iii ttt . 
If the measurements of crank angle mθ  and engine speed mω  are requested by the ECU at time mt  
between it  and 1+it , they are actually extrapolated using (3) and (4), respectively, under the 
assumption of constant acceleration iα . 
2
2t
t iiim
∆
+∆+=
α
ωθθ                                                   (3) 
tiim ∆+= αωω                                                                (4) 
where t∆  is the time duration between mt  and it , i.e. im tt − .  If the measurement of the engine 
acceleration is requested by the ECU at time mt , it is set to be iα , i.e. im αα = . 
Stroke Identification. For a four-stroke engine, two TDC signals are picked within a cycle, one is 
after the compression stroke and the other is after the exhaust stroke. The stroke should be 
identified due to that the fuel injection and spark ignition are carried out every two revolutions. 
Cam sensor is used for identifying the stroke in most automobile engine. However, there is no cam 
sensor in scooter engine for cost reduction, so the strategy of stroke identification is necessary. The 
engine speed at different strokes is shown in Fig. 3. The engine speed at the TDC between the 
compression and combustion strokes is much slower than that between the exhaust and intake 
strokes [5]. After the TDC is detected, the corresponding engine speed )(iTDCω  is compared with the 
engine speed recorded at the previous TDC, i.e. )1( −iTDCω .  If )(iTDCω  is larger than )1( −iTDCω , the 
exhaust stroke is detected at the current TDC. Otherwise, the compression stroke is detected. 
0 180 360 540 720
1900
2000
2100
2200
2300
2400
Crank Angle (deg)
E
n
g
in
e
 S
p
e
e
d
 (
rp
m
)
Engine speed 
TDC TDC 
In. Comp. Ex.Comb.
TDC 
Tooth signal
 
Figure 3.  Engine speed at different strokes 
Kalman Filter. A robust Kalman filter is designed to filter out the sensor noise and to estimate the 
crank angle and the engine speed as proposed in [4]. It includes a state-space model of (5) and a 
Kalman gain for closed-loop estimation. The engine rotational dynamics is modeled as [4]: 
ωαθ bITTT eloade +=∆=− )(                                          (5) 
where eT  is the engine torque; loadT  is the external load torque; T∆  is the torque difference; b  is the 
damping constant of the crankshaft bearing; α  is the angular acceleration of the engine; )(θeI  is the 
nonlinear engine rotational inertia. 
The system state x , input u ,  and output y  are defined to be [ ]Tωθ , T∆ , and θ , respectively, 
the nonlinear state-space model can be expressed as follows: 
5316 Mechanical and Aerospace Engineering
  
 
Figure 4.  Modules of strategy in Verilog code 
 
Figure 5.  Crank angle signal chart 
HIL Structure. HIL simulation technology has been used in various control fields to shorten the 
development period time and reduce the development manpower [8]. A HIL system by using xPC 
target was developed for FPGA test in this research. The crank tooth signal generated from the 
engine was transformed to square wave and recorded by the target PC (Personal Computer) via a 
data acquisition card (NI 6024E). The host PC can get back the recorded data from the target PC 
through a network cable. After that, the recorded tooth signals were exported into the FPGA by 
employing the xPC target as well and hence the engine rotational dynamics were calculated by 
FPGA. The HIL test process is shown in Fig. 6.  
Result And Discussion 
FPGA Capability Inspection. The compilation result of Quartus II is used to confirm whether the 
strategies of Verilog codes are able to work on the FPGA or not. After the Verilog codes being 
compiled in Quartus II, the compilation report can be read as shown in Table II. The total utility rate 
of LEs (Logic Elements) is only 43% in this case, so that more strategic expansion can be applied in 
this FPGA. It can be seen in Table II, the total LEs, pins, registers and multipliers of the FPGA are 
used in low rates. Therefore, the capability of this FPGA is satisfied for this strategy. 
FPGA HIL Test. After the strategy of Verilog codes were confirmed to be able to work on the 
FPGA, the HIL simulation was employed to examining the implemented strategies in FPGA before 
using for a real engine of vehicle. During the HIL simulation, the recorded crank tooth signal was 
exported into the FPGA by applying the structure of xPC target, which can 
D B 
E 
G 
0th tooth after  
missing tooth,             9th tooth after missing tooth,  
TDC  
A 
5318 Mechanical and Aerospace Engineering
 1.54 1.55 1.56 1.57 1.58 1.59 1.6
0
100
200
300
400
500
600
700
Time (sec)
C
ra
n
k
 A
n
g
le
 (
d
eg
)
 
 
Tooth
TDCset
Theta
 
Figure 7.  Crank-angle generated from FPGA at HIL test 
1.54 1.56 1.58 1.6
0
200
400
600
800
1000
Time (sec)
C
ra
n
k
 A
n
g
le
 (
d
e
g
)
 
 
Actual Response
Conventional Algorithm
Robust Kalman Filter
 
Figure 8.  HIL test results of crank-angle 
FPGA Vehicle Test. For the vehicle test, the tooth signal of crankshaft was taken from a real 
engine and inputted to the FPGA. The experiment was performed on a 125 cc four-stroke scooter 
engine. As can be seen in Fig. 9, FPGA precisely identified the engine stroke and calculated the 
crank-angle. The results of robust Kalman filter are also similar to that of conventional algorithm as 
found in HIL test. 
However, the noise of signal was frequently observed near the top-dead center during the vehicle 
test. That occurred intermittently and its strength was not constant, which might be caused by the 
ignition coil [8]. When the CPS tooth signal has noise, the robust Kalman filter can filter out the 
noise. The robustness of the proposed estimation algorithm under the presence of large noise is 
compared with that of the conventional algorithm. Test results with a large noise occurred at 1.45 
seconds are shown in Fig, 10. As can be seen from Fig. 10, conventional calculation of crankshaft 
angle is significantly affected by the noise. Since the robust Kalman filter actually contains a copy 
of engine rotational dynamics, it can mitigate the effect of the noise. A large error of crank-angle 
signal will cause a large error of injection and ignition control. So the filtration of sensor noise is 
important for engine control. 
Conclusion 
In order to obtain the more accurate calculation of the engine rotational dynamics without 
overloading the interrupt system of ECU, the FPGA was proposed in this paper. A stroke 
identification algorithm was also implemented in the FPGA for obtaining 720 degree crank angle 
without cam sensor. The FPGA can be used to reduce the interruption of ECU, as well as the 
loading of ECU. Furthermore, the robust Kalman filter was employed to filter out the sensor noise 
and to estimate the engine rotational dynamics. The HIL simulation and a scooter engine were 
utilized to verify the proposed FPGA with the estimation algorithm. Both HIL simulation and 
vehicle test results show that the proposed algorithm of FPGA can be used to calculate the 720 
degree engine rotational dynamics and filter out the sensor noise. 
5320 Mechanical and Aerospace Engineering
International Conference on Applied Energy 
ICAE 2013, Jul 1‐4, 2013, Pretoria, South Africa 
Paper ID: ICAE2013‐439 
 
 1 Copyright © 2013 by ICAE2013 
DESIGN OF HCCI ENGINE FOR RANGE EXTENDER USING DUAL FUEL OF 
GASOLINE AND DME ALTERNATIVE FUEL 
 
 
Yuh‐Yih Wu1, Bo‐Chiuan Chen1, Hsien‐Chi Tsai1, Cha‐Ching Peng1, Bo‐Liang Chen2 
1 Department of Vehicle Engineering, National Taipei University of Technology, Taipei, Taiwan 
2 Mechanical and Systems Research Laboratories, Industrial Technology Research Institute, Hsinchu, Taiwan 
 
 
ABSTRACT 
This  paper  designs  a  homogeneous  charge  compression 
ignition  (HCCI)  engine  for  range  extender  application with 
high  operation  efficiency  and  low  exhaust  emissions.  The 
design is carried out on a 500cc spark ignition engine whose 
compression ratio is increased to enhance the compression 
temperature.  After  analyzing  the  in‐cylinder  gas 
temperature  during  compression  stroke,  Dimethyl  Ether 
(DME)  alternative  fuel  is  selected  as  main  fuel  for  HCCI 
operation  and  the  gasoline  can be  selected as an additive 
fuel  to  adjust  the  ignitibility  of  dual  fuel made  from DME 
and  gasoline.  In  order  to  run  HCCI  with  simple  control 
method and low retrofitting cost, adjusting the ignitibility of 
fuel  and  introduction of  external  exhaust  gas  recirculation 
(EGR)  are  considered  for  controlling  HCCI  combustion. 
Experiments  of  changing  DME  flow  rate,  EGR  ratio,  and 
gasoline additive  ratio are,  therefore, executed  to observe 
HCCI  operation  characteristics  and  identify  methods  for 
controlling HCCI  combustion. Finally,  three HCCI operation 
points, whose power outputs are 3.6kW, 5.9kW, and 7.8kW, 
are  provided  as  candidates  of  RE  working  for  power 
management strategy. These selected operation points are 
found  to  have  lower  brake  specific  fuel  consumption  (< 
250g/kW‐h) and  lower CO and NOx emissions as compared 
with original spark ignition mode operation. 
 
Keywords:  homogeneous  charge  compression  ignition, 
range  extender,  dual  fuel,  Dimethyl  Ether,  exhaust  gas 
recirculation 
NONMENCLATURE 
Abbreviation 
AFR    Air Fuel Ratio 
BMEP    Brake Mean Effective Pressure (kPa) 
BSFC    Brake Specific Fuel Consumption (g/kW‐h) 
CI    Compression Ignition 
COV    Coefficient of Cycle Variation 
DME    Dimethyl Ether 
ECU    Engine Control Unit 
EFI    Electronic Fuel Injection 
EGR    Exhaust Gas Recirculation 
EV    Electric Vehicle 
GDI    Gasoline Direct Injection 
HCCI    Homogeneous  Charge  Compression 
    Ignition 
IMEP    Indicated Mean Effective Pressure (kPa) 
MSDS    Material Safety Data Sheet 
NVH    Noise, Vibration, and Harshness 
NVO    Negative Valve Overlap 
PM    Particulate Matter 
RE    Range Extender 
RE‐EV    Range Extended Electric Vehicle 
SI    Spark Ignition 
VCR    Variable Compression Ratio 
WOT    Wide Open Throttle 
aBDC    After Bottom Dead Center 
aTDC    After Top Dead Center 
bBDC    Before Bottom Dead Center 
bTDC    Before Top Dead Center 
 
Symbols 
ηc    Combustion Efficiency 
 
1. INTRODUCTION 
Exhaust  emissions  of  internal  combustion  engines  are 
significant  sources  of  air  pollution.  They  not  only  create 
potential global warming effects, but also  implicate human 
health  issues.  Therefore,  exhaust  emission  and  fuel 
economy  regulations  are  increasingly  stringent.  This  is 
driving  the  automobile  manufactures  move  towards 
increasing  electrification  of  vehicles.  The  electric  vehicle 
Paper ID: ICAE2013‐439 
 
 3 Copyright © 2013 by ICAE2013 
Table 1 Specifications of the target engine 
Engine Type  4‐stroke, 4‐valve, 1‐cylinder
Cooling System  Water cooling 
Displacement  500 cc
Bore x Stroke  90mm x 78mm 
Compression Ratio  9.9:1 ‐> 12.0:1 
Fuel System  EFI, Port injection 
Intake Valve Opena  4obTDC
Intake Valve Closea  60oaBDC 
Exhaust Valve Opena  45obBDC 
Exhaust Valve Closea  12oaTDC 
aValve timing is defined at 0.7 mm of valve lift. 
 
Figure 1 Clearance volume of the target engine 
Since  the  HCCI  combustion  is  occurred  by  self‐ignition, 
the  self‐ignition  property  of  fuels  becomes  an  important 
factor that affects the HCCI operation. In order to select the 
proper fuel for HCCI operation, in‐cylinder gas temperature 
is calculated from the cylinder pressure of motoring [14] as 
shown in Fig. 2. The comparison of self‐ignition temperature 
of  fuels  and  in‐cylinder  gas  temperature  are  made  to 
identify  the  crank  angle  that  the  combustion  may  occur. 
Hence the DME alternative fuel and gasoline are chosen as 
dual  fuel  for  HCCI  operation  in  the  target  engine, whose 
properties are shown  in Table 2. It can be seen from Fig. 2, 
DME  can  self‐ignite  easily  in  the  target  engine;  however, 
gasoline  is  difficult  to  self‐ignite  without  any  other 
assistance.  Consequently,  gasoline  can  be  chosen  as  an 
additive fuel to reduce ignitability of dual fuel. 
Table 2 Fuel properties 
Fuel  Lower  heating value (MJ/kg) 
Octane 
Number 
Self‐ignition 
temperature (K) 
Viscosity  at
20oC (cP) 
DME  28.9  35  508  0.224
Gasoline 44.4  92~98  553‐729  0.74
bSelf‐ignition temperatures are from MSDS sheet. 
-60 -40 -20 0 20 40 60
300
350
400
450
500
550
600
Motoring
Crank Angle (deg)
In
 C
yl
in
de
r G
as
 T
em
pe
ra
tu
re
 (K
) 561K
508K
Self-ignition
temp. of DME
-11deg
553K
Self-ignition
temp. of Gasoline
 
Figure 2 In‐cylinder gas temperature from motoring of the 
target engine 
After  operation  fuels  are  determined,  the  dual‐fuel 
supplying  system  is  retrofitted  on  the  target  engine  as 
shown  in Fig. 3. The original  fuel and  ignition  systems are 
kept for starting the engine. The original gasoline injector is 
also  used  to provide  gasoline  as  an  additive  fuel  for HCCI 
operation.  An  additional  DME  supplying  system,  which 
includes a small DME tank, pressure  regulator,  filter, surge 
tank,  and  a  flow  control  valve,  is  attached  on  the  target 
engine with a DME supplying tube  installed near the  intake 
port. After starting the engine using gasoline with SI mode 
and achieving a  stable coolant  temperature,  the controller 
can  switch  the  operation  to HCCI mode with  dual  fuel  by 
controlling  the  duty  cycle  of  DME  flow  control  valve  and 
injection duration of gasoline  injector.  In order to measure 
the gasoline and DME flow rate during engine experiments, 
the gasoline flow meter, gasoline defoaming tank, and DME 
flow meter are attached on dual‐fuel supplying system. 
 
Figure 3 Dual‐fuel supplying system of HCCI target engine 
Clearance volume
Paper ID: ICAE2013‐439 
 
 5 Copyright © 2013 by ICAE2013 
respectively,  the  engine  is  switched  to  HCCI  mode  by 
interrupting the  ignition system and turning the throttle to 
wide open throttle (WOT). The supplying fuel is adjusted  in 
the meantime  for  stable HCCI  operation.  Experiments  are 
then  done  at  various  DME  flow  rate,  engine  speeds,  EGR 
ratios,  and  gasoline  additive  ratios  for  investigating  the 
operation characteristics of HCCI combustion. The methods 
for controlling HCCI combustion using dual fuel and external 
EGR  are  identified  as  well.  After  that,  a  series  of 
experiments for  identifying the operation range of HCCI on 
the  target  engine  is  performed.  Finally,  some  HCCI 
operation points with lower BSFC are selected as candidates 
of RE working for power management strategy. 
3. RESULTS AND DISCUSSIONS 
3.1 HCCI operation characteristics 
Three  HCCI  operation  characteristics  of  changing  DME 
flow rate, EGR ratio, and gasoline additive ratio in the target 
engine are  investigated  from experimental measured data. 
The  operation  characteristics  include  combustion 
temperature,  combustion  rate,  and  combustion  stability. 
Experimental data sets selected for the analysis include: (1) 
changing DME flow rate without gasoline additive and EGR 
introduction  at  3000rpm;  (2)  changing  EGR  introduction 
ratio at 3000  rpm while  fixing DME  flow  rate and gasoline 
additive  ratio  at  0.1804  g/s  and  29%,  respectively;  (3) 
varying gasoline additive ratio at 3000 rpm while fixing DME 
flow rate at 0.1780 g/s without EGR introduction. 
Combustion temperature and combustion stability can be 
conjectured  from combustion efficiencies shown  in Figs. 6‐
8. It can be observed from Fig. 6, the combustion efficiency 
increases  with  increasing  DME  mass  flow  rate.  That 
indicates  the HCCI  combustion  becomes more  stable with 
richer  AFR.  Higher  combustion  efficiency  is  also  resulted 
from  higher  combustion  temperature  due  to  richer  AFR 
[17].  However,  the  introduction  of  EGR  will  reduce  the 
combustion efficiency as shown  in Fig. 7, because a part of 
the  exhaust  gas  will  replace  fresh  air  to  restrict  the 
combustion  reaction.  The  combustion  temperature  and 
combustion  stability are,  therefore, depressed with higher 
EGR ratio. 
The combustion efficiency  increases with higher gasoline 
additive  ratio  as  shown  in  Fig.  8.  However,  it  is  different 
from  previous  observed  results  [17]  that  the  combustion 
efficiency  of  increasing  gasoline  additive  into  kerosene 
becomes  lower due  to poor  combustion  stability. This  can 
be explained that the DME is in gaseous state while entering 
the cylinder without atomization problem;  the combustion 
of DME mixture will take place easily  in a short time while 
the  self‐ignition  temperature  is  reached.  Richer  DME 
mixture will further hasten the combustion rate [17] which 
leads to increase the thermal efficiency due to reduction of 
heat  transfer  losses  as  shown  in  Fig.  6.  However,  higher 
combustion  rate  causes  knocking  effect  and  increases 
negative works  for  combustion under  compression  stroke. 
The  gasoline  additive,  therefore,  could  be  employed  to 
retard the combustion timing due to reduction of ignitibility 
of dual fuel. This can further increase the thermal efficiency 
because the negative works can be reduced, which is shown 
in Fig. 8. Since the gasoline additive in DME will stabilize the 
HCCI combustion,  the combustion efficiency as well as  the 
combustion  temperature  of  increasing  gasoline  additive 
ratio will be increased. The thermal efficiency increases with 
increasing EGR ratio as shown in Fig. 7. That  is because the 
introduction of EGR will slow down the combustion reaction 
that  reduces  the  negative  works  for  combustion  under 
compression stroke. 
The  CO  emission  decreases  with  increasing  DME  mass 
flow  rate  (richer AFR), as shown  in Fig. 9.  It differs  from SI 
combustion mode  in which  CO  increases with  richer  AFR. 
16
17
18
19
20
21
22
80
82
84
86
88
90
92
0.2130 0.2142 0.2160 0.2184 0.2225
Th
er
m
al
 E
ffi
ci
en
cy
 (%
)
C
om
bu
st
io
n 
Ef
fic
ie
nc
y 
(%
)
DME Mass Flow Rate (g/s)
Combustion Efficiency
Thermal Efficiency
 
Figure 6 Combustion and thermal efficiencies at 3000rpm 
with pure DME while changing DME flow rate 
30
34
38
42
46
50
95.4
95.44
95.48
95.52
95.56
95.6
0.0% 14.7% 26.5%
Th
er
m
al
 E
ffi
ci
en
cy
 (%
)
C
om
bu
st
io
n 
Ef
fic
ie
nc
y 
(%
)
EGR Ratio
Combustion Efficiency
Thermal Efficiency
 
Figure 7 Combustion and thermal efficiencies at 3000rpm 
with fixed DME flow rate and gasoline additive ratio while 
changing EGR ratio 
Paper ID: ICAE2013‐439 
 
 7 Copyright © 2013 by ICAE2013 
is  added  in  due  to  atomization  problem  caused  by  low‐
pressure injection system and quench layer. In addition, the 
results  shown  in  Fig.  14  also  indicate  the  HC  emission 
increases with  higher  gasoline  additive  ratio  even  though 
the combustion becomes more stable. 
NOx emission will be produced due to longer combustion 
duration  under  higher  combustion  temperature  and 
sufficient  in‐cylinder  O2  concentration  [19].  Since  the 
combustion rate will be hastened and the O2 concentration 
will be reduced with richer AFR, NOx emission reduces with 
increasing DME flow rate as shown in Fig. 12. It can be seen 
from Fig. 13, NOx emission can be reduced with higher EGR 
ratio because the EGR introduction will further decrease the 
combustion temperature. The gasoline additive will stabilize 
the  HCCI  combustion  while  increasing  combustion 
temperature which will  result  in  higher NOx  emission  for 
higher gasoline additive ratio as shown in Fig. 14. 
0
4
8
12
16
20
320
340
360
380
400
420
0.2130 0.2142 0.2160 0.2184 0.2225
N
O
x 
(p
pm
)
H
C
 (p
pm
)
DME Mass Flow Rate (g/s)
HC
NOx
 
Figure 12 Emissions of HC and NOx at 3000rpm with pure 
DME while changing DME flow rate 
0
2
4
6
8
10
780
800
820
840
860
880
0.0% 14.7% 26.5%
N
O
x 
(p
pm
)
H
C
 (p
pm
)
EGR Ratio
HC
NOx
 
Figure 13 Emissions of HC and NOx at 3000rpm with fixed 
DME flow rate and gasoline additive ratio while changing 
EGR ratio 
0
3
6
9
12
15
650
700
750
800
850
900
26.8% 27.5% 29.0% 31.4%
N
O
x 
(p
pm
)
H
C
 (p
pm
)
Gasoline Additive Ratio
HC
NOx
 
Figure 14 Emissions of HC and NOx at 3000rpm with fixed 
DME flow rate while changing gasoline additive ratio 
Since the target engine is operated with WOT under HCCI 
mode,  three  methods  are,  therefore,  concluded  for 
controlling HCCI operation torques. The simplest method  is 
to enrich  the operation AFR as shown  in Fig. 15. However, 
the  increases of brake mean effective pressure  (BMEP) are 
limited due to knocking effect caused by higher combustion 
rate. The negative works for combustion under compression 
stroke  will  also  limit  the  torque  output.  The  EGR 
introduction  and  gasoline  additive  in  DME  are,  therefore, 
better methods for enlarging the BMEP in the target engine, 
which can be observed from Figs. 16‐17. The introduction of 
EGR  will  slow  down  the  combustion  reaction;  therefore, 
negative works  for  combustion  under  compression  stroke 
will  be  effectively  reduced which  promotes  higher  torque 
output.  Since  the  gasoline  additive  in  DME  could  be 
employed to retard the combustion timing due to reduction 
of  ignitibility  of  dual  fuel,  higher  combustion  rate  under 
compression  stroke  can  be  constrained  to  reduce  the 
negative works even though overall AFR is enriched (DME + 
gasoline) for larger torque output as shown in Fig. 17. 
60
70
80
90
100
110
0.2130 0.2142 0.2160 0.2184 0.2225
BM
EP
 (k
Pa
)
DME Mass Flow Rate (g/s)  
Figure 15 BMEP at 3000rpm with pure DME while changing 
DME flow rate 
Paper ID: ICAE2013‐439 
 
 9 Copyright © 2013 by ICAE2013 
170
200
230
260
290
320
3
4
5
6
7
8
2000 3000 4000
B
S
FC
 (g
/k
W
-h
)
Po
w
er
 (k
W
)
Engine Speed (rpm)
Power BSFC_HCCI BSFC_SI
 
Figure 20 Engine power and BSFC of selected operation 
points for RE 
9
9.5
10
10.5
11
11.5
12
12.5
13
13.5
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
2000 3000 4000
C
O
2 
(%
)
C
O
 (%
)
Engine Speed (rpm)
CO_HCCI CO_SI
CO2_HCCI CO2_SI
 
Figure 21 CO and CO2 emissions of selected operation 
points for RE 
0
200
400
600
800
1000
1200
1400
1600
200
300
400
500
600
700
800
900
1000
2000 3000 4000
N
O
x 
(p
pm
)
H
C
 (p
pm
)
Engine Speed (rpm)
HC_HCCI HC_SI
NOx_HCCI NOx_SI
 
Figure 22 HC and NOx emissions of selected operation 
points for RE 
It  can  be observed  from  the  comparison  results  in  Figs. 
20‐22  that  the  developed  HCCI  engine  can  provide 
advantages of improving fuel efficiency and emissions of CO 
and NOx  as  compared with  conventional  SI  engine.  Since 
the developed HCCI engine doesn’t need  to deal with NOx 
emission  and  its  major  emission  is  HC,  it  can  be  treated 
using a cheaper  two‐way  catalyst  converter. Comparing  to 
other  control methods  for  HCCI,  the  retrofitting  cost  and 
controlling  complexity  of  developed  HCCI  engine  is  kept 
lower.  For  instance,  the  internal  EGR  controlled  by  NVO 
must be accomplished in an engine with variable valve train 
mechanism. However, for RE application, the variable valve 
train  mechanism  is  normally  redundant  due  to  its 
controlling complexity and cost.  It  is also unsuitable  for RE 
application  because  the  operation  range  of  RE  is  limited. 
The  intake heating system requires a high power heater to 
warm up the intake air in a short period and the control on 
air temperature is indeed slower. 
4. CONCLUSION 
A HCCI engine  is designed  for RE application with simple 
control method and low retrofitting cost. The target engine 
is a 500cc spark  ignition engine with modified compression 
ratio by reducing its clearance volume. After the analysis of 
in‐cylinder  gas  temperature  during  compression  stroke, 
DME alternative is selected as main fuel for HCCI operation 
and  the  gasoline  can  be  selected  as  an  additive  fuel  to 
adjust  the  ignitibility  of  dual  fuel  made  from  DME  and 
gasoline. In order to control the HCCI combustion, adjusting 
the ignitibility of dual fuel and introduction of external EGR 
are  considered.  Experiments  of  changing  DME  flow  rate, 
EGR  ratio,  and  gasoline  additive  ratio  are,  therefore, 
executed  to  observe  HCCI  operation  characteristics  and 
identify methods for controlling HCCI combustion. Since the 
target  engine  is  operated  with  WOT  under  HCCI  mode, 
three  methods  are,  therefore,  concluded  for  controlling 
HCCI  operation  torques.  The  simplest method  is  to  enrich 
the operation AFR; however, the knocking effect caused by 
higher  combustion  rate  and  the  negative  works  for 
combustion under compression stroke will  limit the torque 
output. EGR  introduction and gasoline additive  in DME are, 
therefore, better methods for enlarging the torque output. 
EGR  will  slow  down  the  combustion  reaction;  therefore, 
negative works will be effectively reduced which promotes 
higher  torque  output.  Since  the  gasoline  additive  in  DME 
could retard the combustion timing, higher combustion rate 
under compression stroke can be constrained which assists 
to enlarge the output torque by enriching overall in‐cylinder 
AFR.  Consequently,  the  largest  BMEP  and  lowest  BSFC 
found  for  HCCI  operation  is  476kPa  and  181g/kW‐h 
respectively at 3000rpm by 29% gasoline additive into DME 
with  introducing  26.5%  EGR  ratio.  Finally,  three  HCCI 
operation points, whose power outputs are 3.6kW, 5.9kW, 
and  7.8kW,  are  provided  as  candidates  of  RE working  for 
power  management  strategy.  These  selected  operation 
International Conference on Applied Energy 
ICAE 2013, Jul 1‐4, 2013, Pretoria, South Africa 
Paper ID: ICAE2013‐438 
 
 1 Copyright © 2013 by ICAE2013 
LEAN LIMIT EXTENSION OF SEMI‐DIRECT INJECTION ENGINE FOR EMISSION 
REDUCTION USING CFD NUMERICAL METHOD 
 
 
Yuh‐Yih Wu, Hsien‐Chi Tsai, Yi‐Ming Kuo 
Department of Vehicle Engineering, National Taipei University of Technology, Taipei, Taiwan 
 
 
ABSTRACT 
Since  stable  combustion  under  leaner  air‐fuel  ratio  can 
reduce  the  fuel  consumption  and  exhaust  emissions,  this 
paper proposes a design to  increase the fuel concentration 
near  spark  plug  for  semi‐direct  injection  (SDI)  engine  to 
extend the lean limit using CFD numerical method. At first, a 
controllable  swirl  plate  is  placed  in  the  intake  port  to 
generate  swirl motion  during  intake  event which  helps  to 
maintain  the  injected  fuel  near  the  spark  plug.  Liquefied 
petroleum gas (LPG) is selected as the fuel for SDI engine to 
prevent  the  atomization  problem  caused  by  low‐pressure 
injection  system.  The  ANSYS  CFD/FLUENT  software  is 
utilized to analyze the in‐cylinder swirl motion generated by 
the  swirl  plate  and  then  the  simulation  results  are 
compared with experimental results of flow bench on swirl 
ratio  and  flow  coefficient  to  verify  the  simulation model. 
Different  LPG  injector  positions  are  then  analyzed  on  in‐
cylinder  fuel  distribution  during  intake  and  compression 
stroke  to  obtain  higher  fuel  concentration  near  the  spark 
plug. Experimental  results  show  that  the  lean  limit  can be 
extended  by  the  proposed  design.  Improvements  on  fuel 
economy  and  exhaust  emissions  are  also  observed  for 
proposed design. 
In  the  new  design,  it  can  be  observed  that  the 
stratification in cylinder via the CFD calculated results of the 
fuel distribution, and the engine test results also show that 
the lean limit of this engine is extended. 
 
Keywords:  computational  fluid  dynamics,  semi‐direct 
injection, lean limit, liquefied petroleum gas, swirl ratio 
NONMENCLATURE   
Abbreviation 
A/F    Air Fuel Ratio 
BMEP    Brake Mean Effective Pressure (bar) 
CA    Crank Angle (deg) 
CAD    Computer Aided Design   
CFD    Computational Fluid Dynamics 
CO    Carbon Monoxide 
COV    Coefficient of Cycle Variation 
GDI    Gasoline Direct Injection 
HC    Hydrocarbon 
IMEP    Indicated Mean Effective Pressure (bar) 
LPG    Liquefied Petroleum Gas 
NOx    Nitrogen Oxides 
SDI    Semi‐Direct Injection 
TDC    Top Dead Center 
WOT    Wide Open Throttle 
 
Symbols 
Y    mass fraction 
λ    excess air ratio 
ϕ    fuel‐air equivalence ratio 
 
Subscript 
avg    average 
std    standard deviation 
 
1. INTRODUCTION   
Exhaust  pollution  from  a  motorcycle  gasoline  engine 
contains nitrogen oxides  (NOx), carbon monoxide  (CO) and 
unburned  hydrocarbon  (HC)  emissions.  HC  emissions  are 
the results of incomplete combustion [1]. NOx emissions are 
affected by the air/fuel ratio, the burned gas fraction of the 
in‐cylinder  mixture,  and  spark  timing.  Increasing  the 
burned‐gas  fraction  and  retard  spark  timing  could  reduce 
NOx  emission  levels  [2].  These  solutions,  however, would 
reduce combustion rate and engine torque. Controlling the 
air/fuel  ratio  could have a greater effect on NOx emission 
[3]  and  could  reduce NOx  levels  up  to  98%  at  an  air/fuel 
ratio  of  23.5.  Carbon monoxide  (CO)  emission  of  gasoline 
engine depends heavily on  the air/fuel  ratio. While a  lean 
combustion decreases  the amount of CO  in exhaust gas, a 
Paper ID: ICAE2013‐438 
 
 3 Copyright © 2013 by ICAE2013 
(a) 
(b) 
Figure 1 the intake port for (a) flow without swirl, (b) flow 
with swirl 
 
Table 1 Properties of gasoline and LPG 
Parameter  Gasoline  Propane  Butane
Density (kg/m3)  765  509  585 
Lower heating 
value (MJ/kg) 
44.04  46.34  45.56
Stoichiometric 
air/fuel ratio 
14.7  15.8  15.4 
Combustion rate 
(m/s) 
0.35  0.4  0.4 
Flammability 
limits (Vol. %) 
1.3‐7.6  2.1‐9.5  1.5‐8.5
Research octane 
number 
95  111  103 
 
The  fuel  system  contains  LPG  evaporator  and  injector. 
The  LPG  fuel  is  evaporated  with  LPG  evaporator  and 
regulated to 2.45bar of gas pressure. LPG electronic injector 
is consisted of a voltage‐drive type solenoid valve. A power‐
supply provide DC 13.8V for driving the solenoid valve. The 
injection  timing  and  duration  are  controlled  by  engine 
control unit, which is MotoHawk ECU 555‐80 controller. 
2.3 System configuration 
The new design  intake port with a  swirl  control plate  is 
shown  in  Fig.  2.  It  was  put  into  the  vehicle  that  is  a 
commercialized  scooter;  the  swirl  control plate was  linked 
to  the  vacuum  valve,  which  was  controlled  by  vacuum 
switching valve. The switching signal from controller will be 
sent  to  that  valve.  The  vacuum  pressure  is  taken  from 
intake manifold and goes through one way valve to get the 
peak vacuum pressure. The  input signals  for  the controller 
are  including  pressure  intake  manifold,  intake  air 
temperature,  throttle  position,  excess  air  ratio,  engine 
temperature  and  crank  angle.  The  output  signals  are  for 
injector, spark ignition coil, throttle position and swirl plate.   
The schematic diagram of SDI engine system  is shown  in 
Fig. 3. Where, 1: ECU, 2: vacuum switching valve, 3: one way 
valve,  4:  ignition  coil,  5: wide‐band  lambda  sensor,  6:  air 
filter,  7:  electric  throttle  and  throttle  position  sensor,  8: 
manifold  absolute  pressure  sensor  and  intake  air 
temperature  sensor,  9:  vacuum  valve  and  swirl  control 
plate,  10:  exhaust  pipe,  11:  LPG  injector,  12:  engine 
temperature sensor, 13: engine, 14: crank angle sensor. 
 
 
Figure 2 Swirl plate control device 
 
 
Figure 3 Schematic diagram of SDI engine system;   
3. ENGINE FLOW CALCULATION 
The commercialized software ANSYS CFD/FLUENT  is used 
for  CFD  (Computational  Fluid  Dynamics)  calculation  of 
engine port  flow  and  in‐cylinder  flow.  It  is  a  compressible 
turbulent  flow.  The  basic  equations  of  conservation  are: 
continuity equation, momentum equation, energy equation, 
and  species  transport  equation.  k-ε  turbulence  model  is 
used  for  numerical  analysis  of  flow  characteristics  in  this 
study.  Where,  turbulent  kinetic  energy,  k,  and  turbulent 
dissipation rate, ε, are inducted in the calculation. 
Paper ID: ICAE2013‐438 
 
 5 Copyright © 2013 by ICAE2013 
Table 2 the effect of grid number on the error of cylinder 
maximum pressure 
Grid 
number 
446247  662422  794225  996990  1218530
Error 
(%) 
8.05  3.04  0.95 0.51  0.51
 
3.4 Design for charge stratification 
Fuel could be distributed around spark plug at the end of 
combustion stroke as expectation. To do this, the  injection 
position  is directed  to  the  spark plug, and  the direction  is 
followed the center of swirl as show in Fig. 6. 
 
 
Figure 6 The concept fuel injection direction and swirl 
generation for charge stratification 
 
The  charge  stratification  can  be  identified  from  the 
distribution  of  fuel  air  equivalence  ϕ,  as  in  Eq.  (1).  The 
custom field function calculator of FLUENT can calculate the 
mass fraction of fuel Yfuel vapor and mass fraction of air Yair. 
 
vaporfuelair YY
FAtricStoichiome
/
/
                         (1) 
 
The  fuel  is  LPG with a composition of 50% propane and 
50% butane.  Its  stoichiomstric air  fuel  ratio  (A/F)  is 15.48, 
which is calculated from the following equations. 
)76.3(5.1197
)76.3(5.11
222
2210483
NOHCO
NOHCHC

             (2) 
48.15
5844
85.2876.45.11
)/( ,





ff
aa
f
a
LPGstoic MN
MN
m
mFA
    (3) 
4. EXPERIMENTAL SETUP 
4.1 Flow‐bench test 
A normal airflow bench (Super Flow SF‐120) was used to 
measure  flow  rate  through  the  inlet  port.  Additional  rigs 
were added  to measure  the swirl.  In  the  flow bench, air  is 
drawn  through  the  cylinder  head  inlet  port,  into  the 
machine, through a measuring orifice and exits via a blower. 
The  airflow  test  uses  2.49kPa  (10in.  H2O)  pressure  drop 
across the port as its reference condition. 
A swirl adapter was designed based on the dimension of 
target engine to simulate the flow from the intake port into 
the cylinder. A paddle wheel was installed in the adapters to 
measure the charge motion revolution. The swirl ratio was 
calculated according  to AVL  system because  it  is  the most 
popularly used [13]. 
4.2 Engine test 
The  experiments were  carried  out with  a  125  cc  single‐
cylinder, air‐cooled, 4‐valve motorcycle engine produced by 
SANYANG  Industry  Co.,  Ltd.  Detailed  specifications  of  the 
test engine are shown  in Table 3. The fuel was supplied by 
an electronic fuel injection (EFI) system. 
 
Table 3 Engine specifications 
Engine Type Four‐stroke, air cooled, four‐valve, 
overhead camshaft (OHC) 
Bore × Stroke 52.4 mm × 57.8 mm 
Number of Valves 4
Displacement 124.6 cc 
Compression Ratio 10.5
Idle Speed 1600 ± 100 rpm 
Fuel System EFI, port injection 
Ignition Type Direct Current Transistor
Intake Valve Open* 10° before top dead center (BTDC)
Intake Valve Close* 20° after bottom dead center (ABDC)
Exhaust Valve
Open* 
30° before bottom dead center   
(BBDC) 
Exhaust Valve
Close* 
10° after top dead center (ATDC)
* Valve timing is defined at 1 mm of valve lift. 
 
The experimental setup for engine testing is shown in Fig. 
7. For  the engine  test, a Borghi & Saveri Srl FE150‐S eddy‐
current engine dynamometer was employed to measure the 
engine output torque and speed. Dynamometer torque was 
calibrated to range  from 0 to 30 Nm with several standard 
weights for precise torque measurement. Fuel flow rate was 
measured by using ONO SOKKI FX‐1110 mass burette  flow 
detectors.  LPG  flow was measured  by  thermal mass  flow 
meter  TF‐4000  combined  with  digital  indicator.  A 
thermocouple was  located on the LPG pipe to measure gas 
temperature.  Exhaust  emissions,  including  CO,  HC,  NOx, 
CO2, O2,  and  air/fuel  ratio were measured with  a HORIBA 
MEXA‐584L. 
The cylinder pressure was measured using a Kistler 6051B 
uncooled piezoelectric pressure transducer. The crank angle 
Paper ID: ICAE2013‐438 
 
 7 Copyright © 2013 by ICAE2013 
 
Figure 9 Comparison of swirl ratio of new design intake port 
between simulation and test 
5.2 CFD calculated results 
The  flow  field  in  cylinder with  pure  air  can  be  used  for 
investigating the air motion. Figure 10 shows the pathlines 
of  in‐cylinder  flow at 40o before compression TDC which  is 
near  the  ignition  timing.  The  charge  flow  generate  swirl 
motion  in cylinder and the center of swirl  is near the spark 
plug. 
 
 
Figure 10 Pathlines of in‐cylinder flow at 40o Before 
Compression TDC with stratified mode 
 
The  stratification  of  air‐fuel  mixture  can  be  formed  by 
using the swirl motion  in cylinder. Consider the  location of 
the  swirl  center  as  shown  in  Fig.  10,  the  LPG  injector 
position and direction was designed as shown in Fig. 11, the 
red  arrow  is  the  direction  of  fuel.  The  fuel  injection was 
directed  to  the  swirl  center.  However,  CFD  calculation  of 
the  distribution of  equivalence  ratio  in  Fig.  12  shows  that 
the  rich  mixture  (orange  color  zone)  is  near  the  exhaust 
valves,  rather  than  the  spark plug. That may be caused by 
the centrifugal force of swirl drives the  fuel away  from the 
swirl center. 
From the equivalence distribution results of old direction 
design of LPG injection, the injection direction was modified 
as  shown  in  Fig.  13.  It  is  called  new  direction  of  LPG 
injection.  By  this  way,  fuel  could  be  distributed  around 
spark plug at the end of combustion stroke as shown in Fig. 
14.  Therefore,  the  application  of  CFD  can  effectively 
improve  the  system  design  for  achieving  better 
stratification of air‐fuel mixture.   
 
 
Figure 11 Old direction of LPG injection 
 
 
Figure 12 Distribution of equivalence ratio in cylinder at 40o 
Before Compression TDC with old LPG injection direction 
 
Paper ID: ICAE2013‐438 
 
 9 Copyright © 2013 by ICAE2013 
 
Figure 17 Effect of injection direction on COV of IMEP at 
various excess air ratio (λ) 
5.4 Emissions and fuel consumption 
The  exhaust  emission  of  CO  decreases  with  increasing 
excess  air  ratio  as  shown  in  Fig.  18.  The  HC  emissions 
become minimum in the excess air range of 1.1~1.3 for this 
SDI  engine  as  shown  in  Fig.  19. Although  the  further  lean 
causes  higher  HC  emissions,  the  catalytic  converter  can 
reduce HC effectively in lean mixture. 
The new design of fuel  injection gets better stratification 
of air‐fuel mixture.  It  improves the combustion, and hence 
decreases CO and HC emissions as shown in Figs. 18 and 19, 
respectively. 
 
 
Figure 18 Effect of injection direction on CO emission at 
various excess air ratio (λ) 
 
 
Figure 19 Effect of injection direction on HC emission at 
various excess air ratio (λ) 
 
The  NOX  emissions  are  caused  from  high  combustion 
temperature  and  abundant  of  air.  The  peak  of  NOX  is  at 
excess air  ratio 1.2  in  this  SDI engine as  shown  in Fig. 20. 
NOX  decreases  tremendously when  the  excess  air  ratio  is 
increased further.   
 
 
Figure 20 Effect of injection direction on NOx emission at 
various excess air ratio (λ) 
 
The  brake  specific  fuel  consumption  (BSFC)  gets  lowest 
around excess air ratio 1.5~1.7  in this SDI engine as shown 
in Fig. 21. The new design of  fuel  injection decreases BSFC 
due to the better stratification of air‐fuel mixture. 
 
AVEC ’12 
Development of Power Management Strategy for Range 
Extended Electric Vehicle Using Dynamic Programming 
  
Hsien-Chi Tsai, Bo-Chiuan Chen, Yuh-Yih Wu 
Department of Vehicle Engineering, National Taipei University of Technology 
  
1, Sec. 3, Chung-hsiao E. Rd. 
Taipei, 10608, Taiwan 
 Phone: (886-2) 27712171 ext. 3622 
 Fax: (886-2) 27314990 
 E-mail: bochen@ntut.edu.tw 
  
The multi-mode switch strategy is proposed as the power management strategy for range extended 
electric vehicle (RE-EV). At first, seven representative driving patterns (RDPs) are selected as 
candidates to represent real driving scenarios. For each RDP, the dynamic programming (DP) is 
utilized to solve the two-point boundary optimization problem to obtain optimal control policy 
which maximizes the fuel economy of RE-EV under charge depleting mode operation. The 
sub-optimal control rules are then extracted by observing DP behaviors using systematic 
procedures. Driving pattern recognition technique is employed to classify the current driving 
scenario into one of RDPs. Thus the multi-mode switch strategy can switch among these control 
rules according to the recognized driving pattern. The performance of proposed strategy is 
subsequently evaluated under three untrained Taiwan driving patterns. The results show that fuel 
economy, battery energy losses, and average battery charging/discharging current can be 
improved using the proposed strategy. 
  
Topics / Powertrain Control 
 
1. INTRODUCTION 
 
Due to the trend in increasingly stringent emission 
regulations, many automobile manufacturers have 
begun to develop electric vehicles (EV) and hybrid 
electric vehicles (HEV). However, EV’s disadvantages 
on traveling distance and battery life cycle are still an 
obstacle to its development. In order to overcome this 
drawback, the range-extended electric vehicle (RE-EV) 
seems to be the most promising short-term solutions. 
The range extender (RE), which consists of an internal 
combustion engine and generator, is combined in EV to 
work as a generator-set, i.e. genset. It could provide 
extra electric power for charging the battery, thus 
extending the traveling distance of RE-EV [1-2]. This 
additional electric power could also be employed to 
assist battery to satisfy higher power demands from the 
electric motor that protects the battery from higher 
discharging current. 
Because RE-EV could obtain the electric power 
from genset and electric power grid, it is classified as a 
plug-in hybrid electric vehicle (PHEV) [3]. Wirasingha 
and Emadi [4] mentioned that the operation mode of 
PHEV can be categorized into three types according to 
battery working conditions, which are charge-sustaining 
(CS) mode, charge-depleting (CD) mode, and EV mode. 
In CS mode, the genset maintains battery SOC at a 
certain threshold value. When the PHEV is operated 
under CD mode, the lower SOC value is only reached at 
the end of route during which the genset will be turned 
on to charge the battery. Karbowski et al. [5] have 
pointed out the battery energy losses can be reduced 
while the PHEV is operated under CD mode. 
Wirasingha and Emadi [4] classified the power 
management strategies of PHEV into three types. First 
type is all-electric-plus-hybrid strategy. PHEV will be 
operated in EV mode at beginning of route. When the 
SOC is lower than a threshold value, it will be changed 
into CS mode and the genset will be controlled using 
thermostat control strategy (TCS). In CS mode, the TCS 
will work the engine at a high efficiency operation point 
to give better fuel economy; however, higher average 
battery charging/discharging powers will deteriorate the 
battery life [6]. Second type is the rule-based blended 
strategy which can control the PHEV under CD mode 
and will balance the electric power distribution of 
genset and battery according to component efficiencies. 
If actual driving distance is greater than pre-defined 
value and the SOC is depleted, the PHEV will be 
operated in CS mode. As a result, the structure of 
control rules dominates the fuel economy and PHEV 
performance. Third type is the optimization-based 
blended strategy. These utilize optimization methods, 
e.g. equivalent consumption minimization strategy 
(ECMS) or dynamic programming (DP), to determine 
the power distribution between genset and battery to 
operate the PHEV under CD mode.  
DP can be used to obtain a global optimal power 
AVEC ’12 
gearwm n                (6) 
where ngear is the gear ratio; and ηgear is the gear 
efficiency. 
The motor-required electric power and 
genset-required mechanical power are expressed as Eqs. 
7 and 8. Two 2-D efficiency tables are used to convert 
the electric power and mechanical power for motor and 
genset, respectively. 
m
mechm
elecm
P
P

_
_               (7) 
gs
elecgs
mechgs
P
P

_
_              (8) 
where Pm_elec and Pgs_mech are the input electric and 
mechanical power of motor and genset, respectively; 
Pm_mech and Pgs_elec are the output mechanical and 
electric power of motor and genset, respectively; ηm and ηgs are the system efficiencies of motor and genset 
which are defined as the function of its delivering 
torque and rotational speed. 
In order to reduce calculation efforts of DP, the 
detailed engine dynamics are eliminated. Instead, the 
2-D BSFC map, which is indexed by engine speed and 
torque, is employed for fuel economy calculation, as 
shown in Fig. 4. 
The battery model is simplified as an equivalent 
circuit with a voltage source and a resistance [10]. The 
thermal effect on battery dynamics is also ignored by 
assuming the battery temperature won’t have major 
changes during vehicle testing. By considering the 
charging/discharging power changes, the only state of 
the simplified model, SOC, can be calculated as: 
btot
elecgselecmtotococ
QR
PPRvv
kSOCkSOC
2
)(4
)1()(
__
2 

    (9) 
where voc is open-circuit voltage of battery which is 
indexed by battery SOC; Rtot is the total internal 
resistance which is represented into two tables (function 
of SOC) for battery charging/discharging conditions; 
Pm_elec is positive value for traction and negative for 
braking; and Qb is the battery capacity. 
 
3. DYNAMIC OPTIMIZATION PROBLEM 
 
DP can easily handle constraints and nonlinearity of 
the problem for obtaining a globally optimal solution 
[11]. It is employed for solving the two-point boundary 
optimization problem, which is modeled as a finite 
horizon optimization problem in this paper, to obtain the 
optimal control policy which maximizes the fuel 
economy of RE-EV under CD mode operation. 
 
3.1 Problem Formulation 
The simplified model is defined as the plant in 
discrete form with single state variable and control input 
as follows: 
elecgsPu
SOCx
kukxfkx
_
))(),(()1(



            (10) 
where the state variable is battery SOC; and the control 
input u is genset electric power. 
In order to obtain an optimal control policy for the 
RE-EV to be operated under CD mode, the two-point 
boundary optimization problem is defined in this paper 
with the initial and final states as 80% and 20% SOC, 
respectively. The goal is to find the optimal control 
policy u*(k) over a certain driving pattern for 
minimizing the cost function as: 




1
1
))(),((
N
k
inst kukxLJ           ( 11) 
where N is the duration of driving cycle; and Linst is the 
instantaneous cost function. In order to maximize the 
fuel economy for RE-EV under CD mode operation, the 
fuel consumption of genset is defined as the 
instantaneous cost function in this paper. 
Four types of constraints must be observed during 
the optimization process. Type I is the system dynamics 
which is defined in Eq. 10. For ensuring safe operation, 
the second type of constraint is the physical dynamics 
boundaries of each component as follows: 
    maxmin )( SOCkSOCSOC   
))(()())(),(( max,min, kTkTkSOCkT mmmmm    
    ))(()())(( max,min, kTkTkT eeeee    
max,min, )( eee k                       (12) 
    ))(()())(( max,min, kTkTkT gsgsgsgsgs    
    max,min, )( gsgsgs k    
where Te and ωe are the torque and rotational speed of 
the engine, respectively; Tgs and ωgs are the torque and 
rotational speed of genset, respectively. 
Vehicle speed is constrained by the required driving 
pattern as the third type constraint. Type IV constraint is 
for NVH and battery protection. For the NVH concerns, 
the engine is turned off while the vehicle speed is less 
than 20 km/h. In order to protect the battery, the battery 
charging/discharging current is limited within 2C until 
the genset is operated to provide its largest electric 
power. 
 
3.2 Genset Operation Points Determination 
When the engine power is known, the coincident 
optimal fuel consumption, engine torque, and engine 
speed could be obtained by searching the BSFC map. 
However, the engine operating power, converted by the 
control input of genset electric power, is related to the 
genset efficiency table which is a function of genset 
torque and rotational speed. It constructs a recursive 
problem because the genset operation points, genset 
efficiency, and engine power are cross-related. Genset 
optimal operation point is difficult to be derived from 
the genset electric power directly during the DP process. 
In order to reduce the calculation effort in the DP 
process, the data of genset electric power vs. engine 
power, engine power vs. engine torque and engine speed, 
and engine power vs. engine fuel consumption are listed 
in look-up tables using the grid search method before 
DP manipulation. The standard deviations of engine 
speed and torque of its variations during 100 W engine 
power changes are 37.2 rpm and 0.9 Nm, respectively. 
AVEC ’12 
0 20 40 60 80 100 120
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Traveling Distance (km)
S
O
C
 o
f B
at
te
ry
 
 
Optimal DP Result
Sub-Optimal Rule-Based Result 252
268284
284
284
284
284
300
300
300 300 3
00
316
316
316 316
316
331 331
331 331
331
347 347
347
347
363
363
363
36
3
379
379
379
394 394
394
410 410
410
42
6 426
426
442 4
42 44
2
457 457
457
473 473
473
489 489
489
505 505 505521 521 521536 536 536552 552
55
2568
568 568584
584 584
599
599 599615 615
615
631 631
631
647
47
663 6
63
678
7869471072674157773
Engine Speed (rpm)
E
ng
in
e 
To
rq
ue
 (N
m
)
 
2000 3000 4000 5000 6000
20
40
60
80
100
BSFC MAP (g/kW-h)
Maximum Torque Curve
Optimal DP Result
Sub-Optimal Rule-Based Result
  
Fig. 4 Comparison between DP and rule-based results 
 
4. MULTI-MODE SWITCH STRATEGY 
 
Since the sub-optimal control rules that extracted 
from DP results are only based on a specific driving 
cycle, it may not perform well under the other driving 
cycles. In order to overcome this problem, a multi-mode 
switch strategy is proposed in this paper. 
 
4.1 Representative Driving Patterns 
In order to establish a multi-mode switch strategy, 
there are seven RDPs (See Table 1), which include 
different urban and suburban scenarios, are selected as 
candidates to compose the real driving scenarios. These 
RDPs are based on defined driving cycles and repeated 
several times for the driving distance around 105km. 
For representing the characteristics of RDPs [7], we 
calculate the mean power demand Pdem,mean and standard 
deviation of power demand Pdem,std for each RDP as 
shown in Table 1. 
 
Table 1 Representative Driving Patterns 
Driving cycle Distance (km) 
Pdem,mean  
(W) 
Pdem,std 
(W) 
NEDC*10 109.3 8216.6 (H) 11441 
UDDS*9 107.9 7955 (H) 10329 
FTP75*6 106.6 6592.7 (H) 10458 
J-1015*25 104.1 5544.3 (M) 8040.9 (H)
Tainan Suburban*21 103.5 5457.8 (M) 6352.2 (L)
Taipei urban*30 105.7 4514.6 (L) 7277.6 (L)
NYCC*55 104.4 4399.4 (L) 8535.4 (H)
 
DP is employed to obtain the optimal control policy 
over each RDP that maximize the fuel economy for 
RE-EV under CD mode operation. The sub-optimal 
control rules are then extracted by applying the 
developed systematic procedures. The threshold values 
in control rules are shown in Table 2 for each RDP. 
These extracted control rules are found to have similar 
consequence with NEDC RDP. 
 
Table 2 Threshold values of sub-optimal control rules 
Driving cycle V1 (kW)V2 (kW) V3 (kW) V4 (sec)
NEDC*10 17 2 11 6 
UDDS*9 12 6 11 5 
FTP75*6 12 9 9 5 
J-1015*25 14 7 14 6 
Tainan Suburban*21 12 13 18 6 
Taipei urban*30 17 12 14 6 
NYCC*55 21 -2 5 6 
 
4.2 Driving Pattern Recognition 
The concept of driving pattern recognition is shown 
in Fig. 5.  First, a First-In-First-Out (FIFO) buffer is 
employed to store the driver power demand. The buffer 
size is 200 seconds and the sampling time is chosen to 
be 1 second. The DPR processor with updating period = 
5 seconds calculates the Pdem,mean and Pdem,std using 
stored power demand values in the buffer to classify the 
current driving pattern into one of the RDPs using Eq. 
17 [7]. Thus the multi-mode switch strategy can switch 
among these control rules according to recognized 
driving pattern. 
 
 
Fig. 5 Configuration of driving pattern recognition 
 
7~1],)(
)[(minarg
2
,,,
2
,,,


iPP
PPRDP
istddemstddem
imeandemmeandem
i
i

    (17) 
where Pdem,mean,i and Pdem,std,i are the Pdem,mean and Pdem,std 
of RDPi; σ is the weighting factor for the difference 
between Pdem,std,i and Pdem,std, which is determined using 
grid search method. 
 
5. SIMULATION RESULTS 
 
In order to evaluate the control performance of 
sub-optimal control rules under each RDP, both 
conventional TCS and optimal control policies from DP 
are also verified using the backward-in-power nonlinear 
vehicle model for comparison. The conventional TCS is 
established using the same constraints in DP for NVH 
and battery protection, and its genset operation points 
are selected as 20kW and 31kW for best BSFC and 
largest genset power output, respectively.  
A performance index, Jtot, (See Eq. 18) is defined to 
evaluate the control performance on fuel economy and 
battery protection simultaneously. Jtot consists of fuel 
economy, battery energy losses, and average battery 
charging/discharging current. These three terms in Jtot 
are normalized by TCS results respectively. Higher 
battery energy losses will increase the battery 
temperature which is dangerous for battery. In addition, 
the battery will deteriorate rapidly with larger battery 
charging/discharging current. 
321
,_
_
,_
_
,
JJJ
I
I
E
E
m
m
J
TCSavgb
avgb
TCSlossb
lossb
TCSf
f
tot






  (18) 
where Eb_loss is battery energy loss; Ib_avg is average 
battery charging/ discharging current. For TCS, the Jtot 
is equal to 3, and J1, J2, and J3 are equal to 1. 
The simulation results are summarized in Table 3 
for each RDP. The control performance of sub-optimal 
control rules is between DP and conventional TCS. 
demP
FIFO
Buffer
 
DPR 
Processor 
 
Multi-Mode
Control RDP 
Driving Pattern Recognition time
International Conference on Applied Energy 
ICAE 2012, Jul 5‐8, 2012, Suzhou, China 
Paper ID: ICAE2012‐A10521 
 
 1 Copyright © 2012 by ICAE2012 
POWER MANAGEMENT ANALYSIS OF RANGE EXTENDED ELECTRIC VEHICLE 
USING DYNAMIC PROGRAMMING 
 
 
Hsien‐Chi Tsai, Bo‐Chiuan Chen, Yuh‐Yih Wu 
Department of Vehicle Engineering, National Taipei University of Technology, Taipei, Taiwan 
hc.tsai.chimo@gmail.com 
+886‐2‐2771‐2171 ext. 3678 
 
 
ABSTRACT 
Dynamic programming (DP) is used to analyze the power 
management of a  range‐extended electric vehicle  (RE‐EV). 
The  DP  procedure  starts  with  establishing  a  simplified 
backward‐in‐time  plant  model  of  RE‐EV.  Because  poor 
battery  energy  conversion  efficiency  will  result  in  higher 
battery  temperature,  battery  energy  loss  is  analyzed.  In 
order  to  evaluate  the  trade‐off  between  battery  energy 
losses and  fuel savings,  two different cost  functions based 
on  battery  energy  and  fuel  energy  are  defined  and 
minimized  for  four  different  driving  patterns.  Considering 
driver  comfort  and  battery  life,  the  limitations  of  noise, 
vibration,  harshness,  and  battery  charging/discharging 
currents are expressed as constraints for DP. Compared to 
a  conventional  thermostat  control  strategy,  preliminary 
results  show  that  the  battery  energy  losses,  maximum 
battery discharging current, and  time duration at  low SOC 
are significantly reduced using DP. 
Keywords:  range‐extended  electric  vehicle,  dynamic 
programming,  power  management,  battery  energy  loss, 
fuel energy loss. 
NONMENCLATURE 
Abbreviation 
BSFC    Brake Specific Fuel Consumption 
CG    Center of Gravity 
DP    Dynamic Programming 
ECMS  Equivalent  Consumption  Minimization 
Strategy 
EV    Electric Vehicle 
genset    Engine and Generator Set 
HEV    Hybrid Electric Vehicle 
Max.    Maximum 
Min.    Minimum 
NVH    Noise, Vibration and Harshness 
PF    Power Follower 
RE    Range Extender 
RE‐EV    Range‐Extended Electric Vehicle 
SOC    State of Charge 
TCS    Thermostat Control Strategy 
 
Symbols 
a     acceleration [rad/s2] 
b     damping coefficient 
F     force [N] 
h     height [m] 
i     current [A] 
J     cost‐to‐go 
I     inertia [kg‐m2] 
L     instantaneous cost 
l     wheel base [m] 
bl     distance from CG to rear axle [m] 
m     mass [kg] 
n     gear ratio 
Q     capacity [AH] 
R     resistance 
r     radius [m] 
T     torque [Nm] 
st     time step [s] 
V     speed [m/s] 
v     voltage [V] 
W     weight [N] 
     rotational speed [rad/s] 
     slip ratio 
     efficiency 
 
Subscript 
a     aero drag 
b     battery 
e     engine 
f     fuel 
elec     electric 
gs     genset 
m     motor 
mech     mechanical 
oc     open circuit 
r     rolling resistance 
Paper ID: ICAE2012‐A10521 
 
 3 Copyright © 2012 by ICAE2012 
The remainder of this paper  is organized as follows. The 
nonlinear  vehicle  model  and  simplified  backward‐in‐time 
model are introduced in Section 2, followed by the dynamic 
programming  in Section 3. Simulation results are shown  in 
Section 4. Finally, conclusions are made in Section 5. 
2. MODELING 
2.1 Vehicle model 
In order to analyze the power management of target RE‐
EV,  a  backward‐in‐power  nonlinear  vehicle  model  was 
established  in  Matlab/Simulink  which  neglects  effects  of 
driver and regenerative braking. The vehicle model consists 
of  vehicle,  wheel,  gear,  motor,  battery,  generator,  and 
engine dynamics, as shown in Fig. 1. 
 
 
Figure 1. Vehicle model in Matlab/Simulink. 
 
The  proposed  vehicle  model  is  revised  from  the  series 
HEV model  in ADVISOR  [19].  In order  to  follow  the  given 
driving  pattern,  the  corresponding  drag  forces  are 
calculated  in vehicle dynamics. Only  longitudinal dynamics 
is  considered  in  vehicle  dynamics  since,  in  general,  fuel 
economy  and  energy  losses  are  measured  in  the 
longitudinal motion. For wheel dynamics, the tire slip ratio 
effect  is  utilized  to  calculate  the wheel  speed; moreover, 
the  rotational  inertia  effect, which  is  expressed  as  inertia 
torque  in  Eq.  1,  compensates  the  required wheel  torque 
calculation. Motor dynamics  combines  the  torque  request 
from  the  gear  set  and  its  inertia  torque  (see  Eq.  1)  to 
compute the motor’s required torque. The required motor 
speed  and  torque  are  then  converted  into  electric  power 
request for battery. The genset dynamics include generator 
and  engine  dynamics.  The  engine  is  a  1.2  L  four‐stroke 
water‐cooled spark  ignition engine. The brake specific  fuel 
consumption (BSFC) map  is used for the engine model and 
is  represented  by  a  2‐D  look‐up  table  indexed  by  engine 
speed and torque. The BSFC map is further corrected by the 
thermal  behavior  of  engine.  The  output  engine  torque, 
which  is  compensated  by  the  engine  rotational  inertia,  is 
employed  to drive  the generator. The generator dynamics 
are  similar  to  that  of  motor  dynamics,  but  at  reverse 
calculation  from  generator  speed  and  torque  to  electric 
power. The RC model  [19]  from Advisor  is  selected as  the 
battery  model.  In  addition,  a  thermal  model  is  used  to 
compensate the temperature effect on battery parameters. 
 
ITI                                      (1) 
 
2.2 Simplified backward‐in‐time model 
Since  this detailed  vehicle model  is not  suitable  for  the 
DP optimization process due to its large number of states, a 
simplified  dynamic  model  was  developed.  The 
simplification is based on the structure of vehicle model. All 
necessary dynamics are discretized as difference equations 
backward‐in‐time. 
For longitudinal dynamics, the wheel torque Tw as shown 
in  Eq.  2  needs  to  overcome  road  loads, which  consist  of 
rolling  resistance,  aerodynamic  drag,  and  road  grade  to 
follow the given driving cycle. 
 
wawrw
s
ww
w
vw
wv
s
vv
w
rFrFI
t
kk
r
kVbrm
t
kVkVkT





 











 

)()1(
)()()1()(

        (2) 
 
 
where  k  denotes  for  the  kth  time  step;  the  vV   is  the 
vehicle  speed;  st   is  the  time  step  of  the  driving  cycle, 
which is 1 sec in this paper;  vm   is the vehicle mass;  wr   is 
the wheel radius;  wb   is the rotational damping coefficient 
of  the wheel;  w   represents  the  rotational wheel speed; 
wI   is the rotational inertia of the wheel;  rF   is the rolling 
resistance  force; and  aF   is  the air drag  force. The wheel 
driving force can then be computed as Fw(k) = Tw(k)/rw. 
Because  the  target RE‐EV  is a  front‐wheel‐drive vehicle, 
the  load  transfer  effect  during  acceleration/deceleration 
will affect  the rotational speed calculation of  front wheels 
due to the tire slip ratio. The normal  loads of front wheels 
are hence calculated as: 
 
  lhFhamlWkF aaCGvvbvzf /)(                    (3) 
 
where  the  zfF   denotes  for  the  normal  load  of  front 
wheel;  vW   is  the vehicle weight;  bl   is  the distance  from 
center of gravity  (CG)  to  rear axle;  va   is  the acceleration 
of vehicle;  CGh   is the CG height; and  l   is wheel base. 
The driving force and normal load of the front wheels are 
then  used  to  obtain  the  friction  coefficient  between  the 
wheels  and  the  road.  The  tire  slip  ratio,  acquired  by  the 
table of friction coefficient vs. tire slip ratio (see Fig. 2), can 
be  employed  to  compute  the  rotational  wheel  speeds 
according to the acceleration/deceleration condition of the 
wheels as shown in Eqs. 4 and 5, respectively. 
 
ww
v
w r
kVk
)1(
)()(



   (acc.)                      (4) 
 
w
vvw
w r
kVkVk )()()(     (dece.)              (5) 
Paper ID: ICAE2012‐A10521 
 
 5 Copyright © 2012 by ICAE2012 
3. DYNAMIC PROGRAMMING 
DP can easily handle  the constraints and nonlinearity of 
the problem  for obtaining a globally optimal solution  [20]. 
It  is  employed  for  solving  the  two‐point  boundary 
optimization problem to analyze the power management of 
RE‐EV,  which  is  modeled  as  a  finite  horizon  optimization 
problem in this paper. 
3.1 Problem formulation 
The simplified backward‐in‐time model  is defined as  the 
plant in discrete form with single state variable and control 
input as follows: 
 
elecgsPu
SOCx
kukxfkx
_
))(),(()1(



                        (11) 
 
where  the  state  variable  is  battery  SOC;  and  the  control 
input  u   is genset electric power. 
Because the optimization results of Karbowski et al. [21] 
show that the lower SOC value is only reached at the end of 
the  driving  cycle,  the  two‐point  boundary  optimization 
problem  is  defined  in  this  paper with  the  initial  and  final 
states as 80% and 20% SOC, respectively. The goal is to find 
the  optimal  control  policy  )(* ku   over  a  certain  driving 
pattern for minimizing the cost function as: 
 




1
1
))(),((
N
k
inst kukxLJ                       (12) 
 
where  N  is  the  duration  of  driving  cycle;  and  Linst  is  the 
instantaneous cost function. In order to evaluate the trade‐
off between battery energy  losses and  fuel energy  losses, 
two different instantaneous cost functions—battery energy 
based  batteryinstL   and  fuel  energy  based  fuelinstL —are  defined 
in  this  paper.  The  battery  energy  based  cost  function 
calculates the energy losses in the battery. The fuel energy 
based cost  function computes  the energy  losses  from  fuel 
energy  to engine output energy which consists of  thermal 
and combustion efficiencies. 
Four  types  of  constraints must  be  observed  during  the 
optimization process. Type I is the system dynamics defined 
by  the  system  dynamics  equation  in  Eq.  11.  For  ensuring 
safe operation, the second type of constraint is the physical 
dynamics boundaries of each component as follows: 
 
          maxmin )( SOCkSOCSOC   
          ))(()())(),(( max,min, kTkTkSOCkT mmmmm    
          ))(()())(( max,min, kTkTkT eeeee    
max,min, )( eee k                                               (13) 
          ))(()())(( max,min, kTkTkT gsgsgsgsgs    
          max,min, )( gsgsgs k    
where  eT   and  e   are the torque and rotational speed of 
the engine, respectively;  gsT   and  gs   are the torque and 
rotational speed of genset, respectively. 
Vehicle  speed  is  constrained  by  the  required  driving 
pattern  as  the  third  type  constraint.  The  driving  patterns 
selected  in  this  paper  include  the New  European  Driving 
Cycle  (NEDC),  Federal  Test  Procedure  (FTP),  Taipei  City 
Driving  Cycle,  and  Urban  Driving  Dynamometer  Schedule 
(UDDS). These driving patterns were repeated several times 
for  analyzing  the  power management  of  RE‐EV  at  driving 
distance around 105 km. 
Type IV constraint is for NVH and battery protection. For 
the  NVH  concerns,  the  engine  is  turned  off  while  the 
vehicle speed  is  less than 20 km/h.  In order to protect the 
battery, the battery charging/discharging current  is  limited 
within 80 A. 
3.2 Optimal operation points of genset 
When the engine power is known, the coincident optimal 
fuel  consumption, engine  torque, and engine  speed  could 
be  obtained  by  searching  the  BSFC  map.  However,  the 
engine operating power, converted by the control  input of 
genset  electric  power,  is  related  to  the  genset  efficiency 
table which  is  a  function  of  genset  torque  and  rotational 
speed.  It  constructs  a  recursive  problem  because  the 
genset  operating  points,  genset  efficiency,  and  engine 
power  are  cross‐related.  Engine  power  is  difficult  to  be 
derived  from  the  genset  electric  power  and  its  efficiency 
directly during the DP process. 
In  order  to  reduce  the  calculation  effort  in  the  DP 
process,  the  data  of  genset  electric  power  vs.  engine 
power, engine power vs. engine torque and engine speed, 
and engine power vs. engine fuel consumption are listed in 
look‐up  tables using  the optimal searching method before 
DP  manipulation.  These  look‐up  tables  are  illustrated  in 
Figs.  5‐7.  The  standard  deviations  of  engine  speed  and 
torque of its variations during 100 W engine power changes 
are  37.2  rpm  and  0.9  Nm,  respectively.  Small  standard 
deviations  of  engine  speed  and  torque  indicate  that  the 
optimal  searching  results  are  reasonable  for  switching 
genset operation points. 
3.3 Two‐point boundary value problem 
Based  on  Bellman’s  principle  of  optimality,  the  DP 
process  begins  from  the  final  state  and  then  calculates 
backward to the first state [20]. 
The DP processes can be seen  in Fig. 8. At each step, all 
possible  control  inputs  that observe  those  constraints  are 
considered and then the corresponding  instantaneous cost 
)(kLinst   and the SOC grid at step k+1, i.e.  )1( kSOC   are 
calculated.  These  possible  control  inputs  of  grids  in  each 
step are indicated as the possible path between steps. 
 
Paper ID: ICAE2012‐A10521 
 
 7 Copyright © 2012 by ICAE2012 
power  to electric power of motor. The result  illustrated  in 
Fig.  11  further  certifies  the  simplified  model  for  DP 
application. 
 
0 200 400 600 800 1000 1200
0
200
400
600
800
1000
1200
Time (s)
M
ot
or
 S
pe
ed
 (r
ad
/s
)
 
 
Vehicle Model
Backward-In-Time Model
 
Figure 9. Motor speed validation results. 
 
0 200 400 600 800 1000 1200
-100
-50
0
50
100
Time (s)
M
ot
or
 T
or
qu
e 
(N
m
)
 
 
Vehicle Model
Backward-In-Time Model
 
Figure 10. Motor torque validation results. 
 
0 200 400 600 800 1000 1200
0.55
0.6
0.65
0.7
0.75
0.8
0.85
Time (s)
S
ta
te
 O
f C
ha
rg
e
 
 
Vehicle Model
Backward-In-Time Model
 
Figure 11. Battery SOC validation results. 
4.2 DP results 
The simplified model is used for DP process to obtain the 
optimal  control  policy  over  time  for  four  selected  driving 
patterns. Then,  the optimal control policy  is used as  input 
for  the  complicated  vehicle model  to  evaluate  the power 
management  performance  of  the  target  RE‐EV.  The 
simulation results include fuel consumption, battery energy 
losses,  maximum  discharge  current  of  battery,  and  time 
duration at low SOC for control rules of TCS, battery‐energy 
based DP  (DPb),  and  fuel‐energy based DP  (DPf).  The  fuel 
energy  loss  is equivalent to fuel consumption, because the 
best way  to  diminish  fuel  energy  losses  is  to  reduce  fuel 
consumption. 
The  simulation  results  are  normalized  by  the  TCS,  as 
shown  in Table 1. The time duration of battery at  low SOC 
of DPb  and DPf  can  be  significantly  reduced  compared  to 
that  of  conventional  TCS.  This  is mainly  because  a  lower 
SOC value is reached only at the end of the driving pattern, 
which  can be  seen  in  Figs. 12‐15  for  four  selected driving 
patterns.  It  can  be  seen  that  a DP‐based  control  strategy 
can protect the battery life for RE‐EV due to the prevention 
of battery in low SOC. In addition, DPf can have the shortest 
time duration at low SOC. Since battery charging efficiency 
is worse for high SOC, more electric power from genset can 
be  charged  into  battery  without  exceeding  the  current 
limitation.  Therefore,  the  engine  is  frequently  turned  on 
when  the  SOC  is  higher.  It  can  be  seen  from  the  engine 
BSFC map  in  Fig.  3  that  the  engine  can  be  operated  in  a 
high‐efficiency  region  while  the  genset  operates  at  high 
power.  However,  poor  battery  efficiency  will  generate 
higher temperature in battery, which is bad for battery life. 
 
0 20 40 60 80 100
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
Percent of Total Distance (%)
B
at
te
ry
 S
O
C
Driving Pattern of NEDC*10
 
 
TCS
DPb
DPf
 
Figure 12. SOC histories over NEDC driving pattern. 
 
 
 
 
 
 
 
 
 
 
Paper ID: ICAE2012‐A10521 
 
 9 Copyright © 2012 by ICAE2012 
Engine Speed (rpm)
E
ng
in
e 
To
rq
ue
 (N
m
)
Driving Pattern of Taipei City*30
 
 
252
268
284284
284
284
284
300
30
0
300 300 30
0
316
316
316
316
316
316
331 331
331 331
331
347 34
7
347
347
363
363
363
363
379
379
379
394 394
394
410
410 410
42
6
426 426442
442 442457 457
457
473 473
473
489 489
489
505 505
505
521 521 521536 536 5
36
552 552
55
2568
568
568
584 584
584
599 59
9 599615 615
615
631 631
631
647
647
663
663
678 67
8694710726741757773
2000 3000 4000 5000 6000
20
40
60
80
100
 
 TCS
DPb
Engine Speed (rpm)
E
ng
in
e 
To
rq
ue
 (N
m
)
Driving Pattern of Taipei City*30
 
 
237252268284
284
284
284
284
300
300
300 300 300
300
316
316
316
316
316
316
331
331
331 331
331
347 347
347
347
363
363
363
36
3
379
379
379
394 394
394
410 410
410
42
6 426
426
442
442 442
457
457 457
473 473
473
489 489
489
505 505
505
521 52
1 521
536 536 5
36
552 552 552568
568
568
584
584 584599
599
599
615 615
61
631 631
631
647
647
663
663
678
6789471072674157773
2000 3000 4000 5000 6000
20
40
60
80
100
 
 
TCS
DPf
 
Figure 19. Engine operation points over Taipei City driving 
pattern. 
 
The  accumulated  battery  energy  losses  of  DPb  and  DPf 
can be improved over that of TCS as shown in Table 1. The 
major  reasons  for  battery  energy  losses  are  higher 
charging/discharging current and  the  time duration at  low 
SOC.  Figs.  20‐23  show  the  accumulated  battery  energy 
losses  of  TCS,  DPb,  and  DPf  for  each  selected  driving 
pattern, respectively. For TCS, the battery energy losses are 
dominated by  the higher battery discharge  current  at  the 
beginning of  the  route due  to  the pure electric operation. 
After  the  battery  energy  is  depleted,  the  rate  of  battery 
energy losses of TCS is still higher than DPb and DPf. That is 
because  the  battery  loss  increases  at  low  SOC. 
Nevertheless, DPb  can  further  improve  on  battery  energy 
losses  by  sacrificing  some  fuel  energy  in  order  to  reduce 
battery energy losses. As a result, the best way to reduce to 
battery energy losses is to deplete the battery power at the 
end of the route. 
 
0 20 40 60 80 100
0
0.3
0.6
0.9
1.2
1.5
Percent of Total Distance (%)
B
at
te
ry
 E
ne
rg
y 
Lo
ss
 (M
J)
Driving Pattern of NEDC*10
 
 
TCS
DPb
DPf
 
Figure 20. Accumulated battery energy losses over NEDC 
driving pattern. 
 
Because  the battery  charging/discharging current  is one 
of the constraints  in the DP process, the maximum battery 
discharge  currents  of DPb  and DPf  are  reduced  obviously. 
This  is  also  a  benefit  for  protecting  the  battery.  Because 
background  noises  and  vehicle  vibrations  are  relatively 
insignificant  at  low  vehicle  speed,  the  driver  will  feel 
uncomfortable  from  the  noise  and  vibration  of  engine 
operation.  Thanks  to  the  NVH  constraint,  the  engine 
operations of DPb  and DPf  are  kept off  for  vehicle  speeds 
under 20 km/h. 
0 20 40 60 80 100
0
0.5
1
1.5
2
Percent of Total Distance (%)
B
at
te
ry
 E
ne
rg
y 
Lo
ss
 (M
J)
Driving Pattern of FTP*6
 
 
TCS
DPb
DPf
 
Figure 21. Accumulated battery energy losses over FTP 
driving pattern. 
 
0 20 40 60 80 100
0
0.5
1
1.5
2
Percent of Total Distance (%)
B
at
te
ry
 E
ne
rg
y 
Lo
ss
 (M
J)
Driving Pattern of UDDS*9
 
 
TCS
DPb
DPf
 
Figure 22. Accumulated battery energy losses over UDDS 
driving pattern. 
 
0 20 40 60 80 100
0
0.5
1
1.5
2
Percent of Total Distance (%)
B
at
te
ry
 E
ne
rg
y 
Lo
ss
 (M
J)
Driving Pattern of Taipei City*30
 
 
TCS
DPb
DPf
 
Figure 23. Accumulated battery energy losses over Taipei 
City driving pattern. 
5. CONCLUSION 
Dynamic Programming (DP) is used to analyze the power 
management  of  a  target  RE‐EV.  Two‐point  boundary  DP 
problems are solved  in which two different cost functions, 
which are battery energy losses and fuel energy losses, are 
defined and minimized for four driving patterns at a driving 
distance  around  105  km.  The  NVH  effect  and  battery 
charging/discharging limitations are regarded as constraints 
Engine Rotational Dynamics Calculation with 
Stroke Identification for Scooter Engine Using 
FPGA  
 
Yuh-Yih Wu, Bo-Chiuan Chen, Hsien-Chi Tsai, and Yu-Chuan Wang 
Department of Vehicle Engineering 
National Taipei University of Technology 
Taipei, Taiwan 
hc.tsai.chimo@gmail.com
 
 
Abstract—Engine rotational dynamics can be estimated from 
the tooth signals of the crankshaft wheel. The accuracy of the 
calculation rises when the number of tooth increases. However, 
the engine control unit (ECU) needs to detect the tooth position 
and converts it into time information. It will overload the 
interrupt system. In order to overcome this problem, the field 
programmable gate array (FPGA) is proposed to implement 
the engine rotational dynamics calculation with stroke 
identification algorithm. The FPGA can accelerate the 
interpolation and the multiplication processes by implementing 
them in parallel computation. Thus, the proposed method can 
calculate the engine rotational dynamics in real time, and then 
the calculation results can be transferred into the robust 
Kalman filter which was established by Matlab/Simulink in a 
computer, i.e., a simulated ECU. Finally, a 125cc scooter is 
utilized to verify the proposed algorithm. The test results show 
that the proposed method can be used to obtain precise 
information of engine rotational dynamics. 
Keywords-engine rotational dynamics; FPGA; stroke 
identification; robust kalman filter; HIL  
I.  INTRODUCTION 
The engine management system (EMS) is an important 
system in automobile. The sensors of the system detect the 
engine operation modes, such as key on, cranking, idle, 
acceleration, and deceleration, and then the system outputs 
the control signal to the actuators. For example, in the 
cranking mode, the fuel should be enriched. In idle mode, the 
engine speed must be in close-loop control for the idle 
quality. Thus, the EMS is an essential system in automobile. 
EMS consists of two major parts: fuel injection and 
ignition control system. Obtaining the correct engine 
rotational dynamics is necessary to acquire the correct 
timings of the injection and the ignition. So the crank 
position sensor (CPS) signal is very significant because that 
is the basic input signal for EMS. Engine control unit (ECU) 
uses this signal to calculate the engine rotational dynamics, 
and decides the ignition and injection timings according to 
the stroke identification result. Using cam position sensor 
and CPS is able to obtain the more accurate stroke 
identification result. However, in scooter engine, cam 
position sensor is not used due to the space and cost 
limitation. As a result, the stroke identification strategy based 
on using the CPS must be employed.  
If the CPS signal is not correct, the ignition and injection 
timings will be wrong. Because the accuracy of the engine 
rotational dynamics increases with increasing the tooth 
signals, Rizzoni [1], Leteinturier [2], and Kuroda [3] 
proposed to use more tooth crankshaft wheels to measure the 
crank angle with digital filters. In such condition, the ECU 
needs to process every tooth, so it will overload the interrupt 
system. However, our previous study [4] proposed a robust 
Kalman filter to filter out the sensor noise and estimated the 
crank angle and engine speed. It used an external signal 
processing circuit to calculate the engine rotational dynamics. 
This method does not need to measure and calculate tooth 
signal in ECU. The ECU received the output of the external 
signal processing circuit, delivered to robust Kalman filter, 
and then calculated the timings of the ignition and the 
injection without noise and tooth processing. But the study 
was done only in the computer simulation, and it did not 
have the application on a real scooter engine. 
In order to realize the proposed system and maintain the 
ability to acquire engine position to avoid ECU overload, this 
paper used field programmable gate array (FPGA) to 
implement the external signal processing circuit and stroke 
identification algorithm to calculate engine rotational 
dynamics. Firstly, the hardware-in-the-loop (HIL) structure 
was used to export the recorded tooth signal into the FPGA 
for examining the implemented strategies. After that, the 
tooth signal from a real scooter was inputted into the FPGA 
for calculating the engine rotational dynamics. Either the 
calculation results from FPGA by using HIL or the real 
vehicle, the results were transferred into the robust Kalman 
filter which was established by Matlab/Simulink in a 
computer, i.e., a simulated ECU.  
II. ESTIMATION ALGORITHM 
The schematic diagram of engine rotational dynamics 
prediction is shown in Fig. 1.  It consists of external signal 
C. Kalman Filter 
A robust Kalman filter is designed to filter out the sensor 
noise and to estimate the crank angle and the engine speed as 
proposed in [4]. It includes a state-space model of (5) and a 
Kalman gain for closed-loop estimation. The engine 
rotational dynamics is modeled as [4]: 
ωαθ bITTT eloade +=Δ=− )(                  (5) 
where eT  is the engine torque; loadT  is the external load 
torque; TΔ  is the torque difference; b  is the damping 
constant of the crankshaft bearing; α  is the angular 
acceleration of the engine; )(θeI  is the nonlinear engine 
rotational inertia. 
The system state x , input u ,  and output y  are defined 
to be [ ]Tωθ , TΔ , and θ , respectively, the nonlinear state-
space model can be expressed as follows: 
Cx
BAxx
=
+=
y
u&                                (6) 
where ⎥⎥⎦
⎤
⎢⎢⎣
⎡
−=
)(
0
10
θeI
bA , ⎥⎥⎦
⎤
⎢⎢⎣
⎡
=
)(
1
0
θeI
B , and [ ]01=C . 
III. FPGA AND HIL STRUCTURE 
A. FPGA Structure 
In this research, it uses Altera Company’s IC (Integrated 
Circuit), Cyclone II EP2C20F484C8, for FPGA (Field 
Programmable Gate Array), and uses the Quartus II for 
compilation. The specifications of IC Cyclone II are shown 
in Table I [6]. 
This FPGA IC chip employs two dimensional vectors to 
logic reasoning [7], and generally, FPGA software is 
designed by Verilog hardware description language (HDL) 
or a very high speed integrated circuit HDL (VHDL). Its 
code is similar to C language. The logic synthesis tool 
always supports Verilog HDL, so using this HDL has good 
flexibility for FPGA IC selection. The basic element of 
Verilog code is constructed in module, which can be a single 
module or formed by the combination of several modules.  
Modules can be easily designed without considering the 
TABLE I.  FPGA IC SPECIFICATION 
Family Cyclone II 
Device EP2C20 
LAB Columns 46 
LAB Rows 26 
Logic Elements 18752 
Phase-locked loops 4 
M4K Memory Blocks 52 
Multiplier Blocks 26 
detailed circuit. The Verilog codes of strategies were written 
and designed for the I/O port in Quartus II. There are six 
modules in the codes, as shown in Fig. 4. The inputs are 
“Tooth” and “Clock”, and the outputs are crank angle θ , 
engine speed ω , and acceleration α . “Tooth” is the engine 
tooth signal. “Clock” is a 480 kHz square wave generated 
from a function generator. 
The module of “Ptime_counter” is for counting the clock 
times between rising edges of each tooth signal, then output 
the times of counts, which is indicated as “A” in Fig. 4. 
“Ntime_counter” module counts the clock times between 
falling edges of each tooth signal, and the instantaneous 
clock times from the falling edge of each tooth signal, which 
are shown as “C” and “D” respectively. “Miss_tooth” 
module receives “A” from “Ptime_counter” and “Tooth”, 
and then identifies the missing tooth. When the time duration 
of the tooth is greater than 1.6 times of previous one, i.e. 
16.1 −Δ×>Δ tit , the missing tooth is identified, otherwise, it 
is a normal tooth. “Tooth_counter” module uses the missing 
tooth signal “B” and “Tooth” signal to count the tooth 
sequence signal “F”. The tooth sequence numbers are reset 
to zero when the missing tooth signal is received. The 
“Tooth_counter” module also generates the estimated 
missing tooth signal “E” and top death center (TDC) signal 
“G”. The “Stroke_ID” module identifies the stroke at TDC 
and generates the basic crank-angle “H” in one cycle by 
using the stroke identification strategy. Finally the 
“Equation” module consists of (1)-(4), and uses the input 
signals to calculate the engine rotational dynamics of crank 
angle, engine speed and acceleration. The signals located on 
the tooth sequence are shown in Fig. 5. 
 
 
 
Figure 4.  Modules of strategy in Verilog code 
 
Figure 5.  Crank angle signal chart 
D B
E
G
0th tooth after  
missing tooth,             9th tooth after missing tooth, 
TDC 
A
1.54 1.56 1.58 1.6
0
200
400
600
800
1000
Time (sec)
C
ra
nk
 A
ng
le
 (d
eg
)
 
 
Actual Response
Conventional Algorithm
Robust Kalman Filter
 
Figure 8.  HIL test results of crank-angle 
C. FPGA Vehicle Test 
For the vehicle test, the tooth signal of crankshaft was 
taken from a real engine and inputted to the FPGA. The 
experiment was performed on a 125 cc four-stroke scooter 
engine. As can be seen in Fig. 9, FPGA precisely identified 
the engine stroke and calculated the crank-angle. The results 
of robust Kalman filter are also similar to that of 
conventional algorithm as found in HIL test. 
However, the noise of signal was frequently observed 
near the top-dead center during the vehicle test. That 
occurred intermittently and its strength was not constant, 
which might be caused by the ignition coil [8]. When the 
CPS tooth signal has noise, the robust Kalman filter can filter 
out the noise. The robustness of the proposed estimation 
algorithm under the presence of large noise is compared with 
that of the conventional algorithm. Test results with a large 
noise occurred at 1.45 seconds are shown in Fig, 10. As can 
be seen from Fig. 10, conventional calculation of crankshaft 
angle is significantly affected by the noise. Since the robust 
Kalman filter actually contains a copy of engine rotational 
dynamics, it can mitigate the effect of the noise. A large 
error of crank-angle signal will cause a large error of 
injection and ignition control. So the filtration of sensor 
noise is important for engine control. 
V. CONCLUSION 
In order to obtain the more accurate calculation of the 
engine rotational dynamics without overloading the interrupt 
system of ECU, the FPGA was proposed in this paper. A 
stroke identification algorithm was also implemented in the 
FPGA for obtaining 720 degree crank angle without cam 
sensor. The FPGA can be used to reduce the interruption of 
ECU, as well as the loading of ECU. Furthermore, the robust 
Kalman filter was employed to filter out the sensor noise and 
to estimate the engine rotational dynamics. The HIL 
simulation and a scooter engine were utilized to verify the 
proposed FPGA with the estimation algorithm. Both HIL 
simulation and vehicle test results show that the proposed 
algorithm of FPGA can be used to calculate the 720 degree 
engine rotational dynamics and filter out the sensor noise. 
3.28 3.29 3.3 3.31 3.32 3.33
0
200
400
600
800
1000
Time (sec)
C
ra
nk
 A
ng
le
 (d
eg
)
 
 
Actual Response
Conventional Algorithm
Robust Kalman Filter
 
Figure 9.  Vehicle test results of crank-angle 
1.4 1.42 1.44 1.46 1.48 1.5 1.52
0
200
400
600
800
1000
Time (sec)
C
ra
nk
 A
ng
le
 (d
eg
)
 
 
Actual Response
Conventional Algorithm
Robust Kalman Filter
 
Figure 10.  Vehicle test results of crank-angle with noise effect 
ACKNOWLEDGMENT 
This study was supported by the National Science 
Council in Taiwan under the contract number of NSC 99-
2221-E-027-063-MY3. 
REFERENCES 
[1] G. Rizzoni, and W. B. Ribbens, “Crankshaft position measurement: 
engine testing, control, and diagnosis,” Vehicular Technology 
Conference, IEEE 39th, May 1-3, 1989, pp 423-436. 
[2] P. Leteinturier, and J. Benning, “Enhanced engine position 
acquisition & treatment,” SAE Paper No. 1999-01-0203, 1999. 
[3] S. Kuroda, Y. Shimasaki, H. Igarashi, S. Maruyama, and Y. Asaka, 
“Development on digital filtering technology of crank speed 
measurement to detect misfire in internal combustion engine at high 
speed revolution,” JSAE Review, vol. 16, Oct. 1995, pp. 387-390. 
[4] B. C. Chen, Y. Y. Wu, and F. C. Hsieh, “Estimation of engine 
rotational dynamics using kalman filter with stroke identification for 
engine management systems,” Proc. Inst. Mech. Eng. Part D-J. 
Automob. Eng., vol. 219, no. 12, 2005, pp. 1391–1405. 
[5] E. M. Norppa, and R. J. Tkaczyk, “Engine cycle identification 
from engine speed,” U.S. Paten No. 5562082, 1995. 
[6] Galaxy Far East Corp., GFEC Cyclone II Starter Kit User Guide. 
2006. 
[7] Altera Corporation, Cyclone II Device Handbook, Volume 1. 2006. 
[8] Y. Y. Wu, B. C. Chen, and K. D. Huang, “Application of hardware-
in-the-loop for developing the engine management system,” Proc. of 
the 2007 Small Engine Technology Conference, Society of 
Automotive Engineers, Niigata, Japan, Oct. 30-Nov. 2 2007, SAE  
Paper No. 2007-32-0048, JSAE 20076548, 2007. 
華民國第十七屆車輛工程學術研討會，南開科技大學機械工程系，台灣南投，2012 年 11 月 9 日。 
The 17th National Conference on Vehicle Engineering, Nov. 9, 2012, Nan Kai U. of Tech., Nantou, Taiwan, R.O.C.  C–018 
  
因受限於當時電腦速度與數值模型發展尚未成熟無法
精確地模擬出正確結果；然而，近年來由於電腦 CPU高
運算處理速度能力的提升以及 CFD套裝軟體的便利
性，利用 CFD 的數值分析工具，可用來模擬預測引擎汽
缸內部流場特性，若再配合實際實驗數據予比對修正，
則能有效藉由 CFD的分析方法達到提升產品設計的品
質，縮短研發時程，達到降低設計成本的目的，此種設
計生產方式亦早已成為世界潮流。 
因此本研究將運用 CFD 數值方法建立引擎數值模
型並進行運算分析，透過模擬結果了解 SDI 引擎加入
LPG 氣態燃料噴射後，缸內流場變化對油氣分佈的影
響，並試著找出可產生預期油氣分佈的方法，讓引擎達
到高度層狀燃燒的效果，進而提升 SDI 引擎的稀油極
限。 
 
2. 研究動機 
為了研究探討 SDI 引擎之缸內油氣分佈對引擎燃
燒的影響，如果建立一汽缸且使用各種儀器裝置去量測
觀察缸內的油氣分佈，雖然是可以達到目的，但在時間
金錢上會內耗掉許多成本，現在由於電腦科技的大幅進
步，這類型的分析已可在電腦軟體之下大幅應用，不但
減少了金錢上的開銷也因 CFD 軟體的便利性使時間成
本上大幅縮小，且針對油氣分佈去做模擬更可以了解引
擎的燃燒特性，進而影響到引擎的燃燒效率。 
 
3. 研究方法 
    本研究會先模擬穩態流場，即是將目標引擎汽缸頭
在流量測試台(flow bench)上的實際情況，依「流量試驗
方法」計算新設計進氣道之均質與層狀模式的流量係數
和渦流比，並與流量試驗結果作比較與驗證。驗證完後
運用 CFD FLUENT 進行電腦數值模擬，運用 CFD 最先
探討穩態流場後，將引擎數值模型進行暫態流場模擬，
探討引擎缸內的氣流行為。最後再加入 LPG 燃料噴射，
進行缸內的油氣計算分析，利用後處理器以燃空當量比
(fuel-air equivalence ratio,  )呈現缸內油氣分佈情形，
從缸內流場行為及油氣計算分析，找出可提升 SDI 引擎
稀薄燃燒極限的方法。 
4. 實驗設備與條件 
4.1 實驗設備 
本研究使用的引擎為單缸氣冷式 124.6 cc 四汽門
機車引擎，其燃油供給為電子燃油噴射系統，詳細規格
如表 1。 
表 1 引擎規格表 
引擎形式 四行程單缸強制氣冷引擎 
缸徑×行程 52.4 mm×57.8 mm 
排氣量 124.6 cc 
壓縮比 10.5 
怠速轉速 1600±100 rpm 
燃油系統 EFI, port injection 
點火系統 全晶體式點火 
氣門正時 
進氣 
IVO=10 ºBTDC 
IVC=20 ºABDC 
排氣 
EVO=30 ºBBDC 
EVC=10 ºATDC 
 
本研究保留原廠噴射系統的部分零件，如：節氣門
位置感知器、歧管壓力感知器、曲軸位置感知器等，將
原廠 ECU 更換為 Woodward 公司製造之可程式化引擎
控制器，原廠噴嘴更換為 LPG 噴油嘴。 
並將目標引擎與引擎動力計作連接，由動力計控制
平台命令動力計固定想要測試的引擎轉速或負載燃料
從 LPG 鋼瓶經由氣化器、調壓閥及氣噴嘴將燃料噴入
汽缸內，安裝在引擎上的汽缸壓力計用來擷取燃燒後的
汽缸壓力訊號，經由電荷放大器送至 AVL 燃燒分析儀
進行汽缸壓力圖的繪製，以便了解引擎的燃燒情況，廢
棄分析儀則用來分析汙染排放情形。實驗設備架構如圖
1 所示。 
 
AVL indicating system
Exhaust filter
Amplifier
Exhaust gas analyzer
Pressure 
regulator
Surge tank
Dynamometer
 controll table
 LPG 
carburetor
LPG
Tank
Eddy current
dynamometer 
Engine 
Thermal 
couple
Air flowmeter
Air filter
Gas 
injector
Pressure 
transducer
 
圖 1. 實驗設備架構圖 
 
4.2 實驗條件 
在進行稀薄燃燒測試前，會先依照「引擎實驗方法」
進行 SDI 引擎之噴油正時的探討。噴射正時則是採用結
束噴油角(end of injection, EOI)，並以間隔 30 度曲軸角
為單位從進氣上死點(intake top dead center, ITDC)到進
氣下死點(intake bottom dead center, IBDC)，測試出引擎
運轉時其燃燒穩定性最佳的噴油正時。 
了解進氣門開啟時噴油對引擎燃燒穩定性的影
響，並以 COV of IMEP 作為燃燒穩定性之指標。其中
IMEP 為指示均效壓力(indicated mean effective pressure, 
IMEP)的循環變異量(coefficient of variation)10 %以下，
係為連續 100 個循環的指示均效壓力的標準差除以其
平均值之百分數，數學公式定義為： 
 
COV of IMEP =
avg
std
IMEP
IMEP
       (1) 
 
其中 IMEPstd 為取樣期間之 IMEP 標準差，IMEPavg為取
樣期間之 IMEP 平均值。 
之後從引擎轉速 4500 rpm及 FA / =22下之噴油正
時測試結果得知，如圖 2 所示。當噴油正時在結束噴油
角(EOI)於進氣上死點過後 120 度可獲得最佳的燃燒穩
定性。因此接下來的引擎實驗，將參照此噴油正時進行
SDI 引擎稀薄燃燒測試。 
華民國第十七屆車輛工程學術研討會，南開科技大學機械工程系，台灣南投，2012 年 11 月 9 日。 
The 17th National Conference on Vehicle Engineering, Nov. 9, 2012, Nan Kai U. of Tech., Nantou, Taiwan, R.O.C.  C–018 
  
設計的缸內油氣分佈情形，如圖 5.1 至圖 5.11 所
示。在 BCTDC
90 時，缸內流速較快的氣流將油氣
帶往燃燒室上層，使得多數油氣停滯於右進氣門下
方處。在 BCTDC 80 時，從汽缸 Z 座標方向顯示油
氣分佈情形，可發現右側進氣門後方處的油氣逐漸
被分散成兩油氣區塊，推測是受到缸內滾流捲動的
緣故，其中一油氣區塊開始移向火星塞右側，如圖
5.2 所示。隨著活塞持續往移動，左側較小的油氣
區塊逐漸與缸內空氣混合均勻。當活塞到達 BCTDC 
60 時，從汽缸 X座標方向可以觀察到，停留在右
側進氣門處的油氣開始散開，推測是受到缸內產生
的渦流的影響，如圖 5.3及圖 5.5所示。 
    如圖 5.7所示，為 BCTDC 40 時的缸內燃空當
量比與速度向量示意圖，圖中可以顯示，渦流中心
軸(綠色虛線)實際並未平行於汽缸中心，而是略為
傾斜，渦流(藍線)繞著該渦流中心軸旋轉，火星塞
附近油氣同時受到燃燒室形狀的影響，逐漸被帶往
燃燒室與活塞頂之間的夾縫處，由於 LPG 分子略重
於空氣，使得油氣並無法完全停留在渦流中心，而
是受到離心力的關係被帶到渦流外緣。活塞到達
CTDC時，分佈在火星塞右側的油氣也因缸內渦流減
弱，開始與缸內空氣混合均勻，如圖 5.11 所示。
為了提升 SDI引擎的稀薄燃燒極限，火星塞周圍的
燃空當量比高低是重要的關鍵因素，如圖 5.12 所
示，為活塞從進氣上死點至壓縮上死點，紀錄火星
塞周圍燃空當量比的變化情形。當點火正時在
BCTDC 39 時 ， 其 火 星 塞 周 圍 空 燃 比 約 為
A/F=18.5，若能夠改善此處的油氣濃度多寡，將對
SDI引擎稀薄燃燒的極限能有所幫助。 
 
 
圖 5.1 BCTDC 90 之缸內燃空當量比分佈結果 
 
 
圖 5.2 BCTDC 80 之缸內燃空當量比分佈結果 
 
 
圖 5.3 BCTDC 70 之缸內空當量比分佈結果 
 
圖 5.4BCTDC 60 之缸內燃空當量比分佈結果 
 
華民國第十七屆車輛工程學術研討會，南開科技大學機械工程系，台灣南投，2012 年 11 月 9 日。 
The 17th National Conference on Vehicle Engineering, Nov. 9, 2012, Nan Kai U. of Tech., Nantou, Taiwan, R.O.C.  C–018 
  
 
圖 5.11 CTDC之缸內燃空當量比分佈結果 
 
 
圖 5.12火星塞周圍燃空當量比與曲軸角關係圖 
 
5.2 稀薄燃燒測試結果 
    稀薄燃燒測試情形係引擎於層狀模式下，進行
噴氣嘴設計並在不同引擎轉速下比較 COV of IMEP 
之稀油極限，如圖 6所示。依照本研究中定義的稀
薄燃燒極限在 4000rpm 為 =1.72，4500rpm為
 =1.82，5000rpm 為 =1.84。 
從圖中可以發現隨著引擎轉速增加，SDI 引擎的稀
油極限也跟著提升，主要是因為引擎轉速增加後，
汽缸內紊流強度也會跟著增強，汽缸內強烈的紊流
運動能加強燃油的混合情形及燃燒速度[2]，提升
引擎的燃燒穩定性，但 逐漸增加的情況下，燃燒
情形也會隨著變差。 
 
圖 6 過剩空氣比與 COV of IMEP 之關係圖 
5.3 稀薄燃燒對汙染排放的影響 
引擎在稀薄燃燒運轉下雖然可降低車輛整體的油
耗性，但相對地進入汽缸內的燃油量極少，容易使得引
擎造成燃燒不完全的情形，對汙染排放會產生較明顯的
影響。如圖 7.1所示，為缸內不同過剩空氣比與一氧化
碳(CO)之關係圖，當缸內氧氣量不足以與燃燒後的碳結
合成二氧化碳(CO2)時，則會生成 CO，又以空燃比偏濃
( 1 )的情況下，CO的排放量較多。隨著 逐漸上升
(缸內空氣量增加)，CO 排放量亦相對減少，兩種設計
方案在進行稀薄燃燒實驗後，CO 的排放結果均有相同
趨勢，因此 SDI 引擎運轉在稀薄燃燒可降低 CO 的排放
量。 
 
圖 7.1 過剩空氣比與 CO 之關係圖 
汽缸內混合氣在理論空燃比附近時易使燃燒較為
完全，氧氣與碳結合成大量的 CO2，所以此時的排放量
較多，如圖 7.2 所示。當空然比偏稀或偏濃的情況，引
擎的燃燒情況都較差，CO2的排放量都會因此減少，故
SDI 引擎運轉在稀薄燃燒可減少 CO2的排放量。 
圖 7.2 過剩空氣比與 CO2 之關係圖 
 
缸內空燃比的變化對碳氫化合物(HC)的排放影響
最為明顯，其中空燃比偏稀時的 HC 排放量最低。如圖
7.3 所示，當 在理論空燃比偏稀時( =1.2)，因汽缸
內有足夠的氧氣與燃料一起參與燃燒反應，因此有較低
的 HC 排放量。過濃或過稀的混合氣都會讓引擎的燃燒
中國機械工程學會第二十八屆全國學術研討會論文集                         國立中興大學  台中市 
中華民國一百年十二月十日、十一日                                         論文編號: A03-010 
運用渦流產生器於半直接噴射引擎運轉模式切換之研究 
郭益銘
1
、Tran Anh Trung
2
、楊清潭
1
、吳浴沂
1
、陳柏全
1
 
1
國立台北科技大學 車輛工程系所 
2
國立台北科技大學 機電科技研究所 
Email: xrisaac241510@gmail.com 
國科會計畫編號 NSC-99-2221-E-027-063 
  
                 
摘要 
本研究係為設計能依引擎運轉狀態而可控制切
換進氣模式的進氣道。在引擎進氣道中置入一渦流產
生器檔片以切換成均質 (homogeneous) 與層狀
(stratified) 兩種不同進氣模式，並使用計算流體力學
(computational fluid dynamic, CFD)軟體模擬該流場，
最後進行引擎實驗比較該進氣道下的稀油極限(lean 
limit)。 
從流量測試台結果顯示，新設計進氣道之均質
模式流量係數仍與原廠進氣道相同，且層狀模式下可
增強汽缸內渦流運動。而模擬結果也顯示，在層狀模
式下具有強烈的進氣渦流，汽缸內較高的渦流運動在
燃燒過程時可加快燃燒速度，並提升稀薄燃燒極限。
從引擎實驗結果得知，層狀模式的稀油極限範圍為相
對空燃比(relative air fuel ratio, λ) λ=1.6，且相較均質
模 式 下 的 制 動 燃 油 消 耗 (brake specific fuel 
consumption, BSFC)可改善 10 %以上。 
 
關鍵字：機車引擎、稀薄燃燒、半直接噴射引擎、計
算流體力學、渦流 
  
1. 前言 
隨著台灣經濟的成長及國民所得提升，國內交
通工具的數量正逐年增加中，根據交通部統計處統計
[1]，截至 2011 年 7 月底為止全台機動車輛登記數為
15,044,808 輛。在高人口密的台灣都會城市中，這些
機動車輛所排放的有毒物質，如一氧化碳(CO)、碳氫
化合物(HC)及二氧化碳(CO2)等，是影響空氣品質及
人民健康的最大主因。近年來，我國環保署已提高機
車污染排放的標準，主要還是為了減少有毒物質的排
放，避免加劇地球溫室效應的演變。而在地球有限的
資源裡，這些資源絕非是用之不盡、取之不絕。因此，
低汙染及高效率已成為國內汽機車製造商的重要方
針之一。 
過去國內外已對電動機車(electric motorcycle)、
氣道燃油噴射(port fuel injection, PFI)引擎、混合動力
機車(hybrid electric motorcycle)及燃料電池機車(fuel 
cell motorcycle)等進行相關的研究與發展。其中 PFI
系統被廣泛地應用在電子燃油噴射機車上，為進氣門
關閉時將燃油噴入進氣道並與空氣先行混合好後送
入汽缸中。由於機車進氣道管徑較小，容易在氣道壁
面上形成燃油油膜，此為壁濕現象(wall wetting)，此
情形會造成引擎在加減速暫態時，進入汽缸內的燃油
量不準確而需要補償。而許多研究顯示，汽車上的汽
油直接噴射(gasoline direct injection, GDI)系統能使引
擎以低燃油消耗的方式達到高效率及低汙染的表
現，雖然 GDI 系統在汽車上展現其優越性，但因製
造成本與技術方面的問題很難應用在機車引擎上。觀
察 GDI 能達到高效率低污染的關鍵是在於層狀燃
燒，而 PFI 系統亦能達到如此效果。當進氣門開啟時
透過進氣門將燃油直接噴入汽缸中，並借助進氣渦流
的動量，讓大部分的燃油聚集在汽缸上層，可使火星
塞附近能有較濃的混合氣，以達到類似 GDI 系統的
層狀稀薄燃燒，在本文謂之半直接噴射系統。 
在過去研究中，Queenan [2]運用氣道燃油噴射系
統於 SI 引擎進行層狀進氣探討，是將雙進氣道擋住
一個以產生進氣渦流，其結果顯示該渦流在壓縮行程
時，確實可將混合氣集中在火星塞周圍。Kookmin 大
學[3-4]使用雷射光切面(laser light sheet)量測汽缸軸
向各位置的混合氣混合狀態，歸納出渦流強度與噴油
正時對燃料分佈狀態的影響。其結果顯示，利用缸內
渦流運動，當噴油正時為進氣上死點後 150o時，即有
層狀進氣效果，渦流越強，上層混合氣越濃。而吳浴
沂等人研究[5-6]顯示，利用 SDI 系統搭配進氣道中檔
片產生的進氣渦流，在進氣上死點後 80o時可獲得較
佳的燃燒穩定性，該渦流可提升稀薄燃燒極限，制動
燃油消耗(brake specific fuel consumption, BSFC)與原
引擎相比可減少 11.3%燃油消耗。 
當引擎運轉於低負載情形時，能以較稀薄的混
合氣運轉，減少燃油消耗。而高負載情形時，則使用
接近理論空燃比之混合氣，使引擎能獲得較大的動力
輸出。從過去研究中可發現，當 SDI 引擎搭配進氣渦
流能提升引擎稀薄燃燒極限，但其進氣道中的渦流檔
片卻無法依據引擎運轉情形而自由改變檔片的位
置。因此本研究重新設計引擎進氣道，並加入本研究
自行研發之渦流產生器，使引擎可依引擎負載條件而
切換均質與層狀兩種不同進氣模式。 
中國機械工程學會第二十八屆全國學術研討會論文集                         國立中興大學  台中市 
中華民國一百年十二月十日、十一日                                         論文編號: A03-010 
射系統的部分零件，如：節氣門位置感知器、歧管壓
力感知器、曲軸位置感知器等，並將原廠 ECU(engine 
control unit, ECU)更換為 Woodward 公司製造之可程
式引擎控制器。 
 
表一 目標單缸引擎規格 
引擎形式 四行程單缸強制氣冷引擎 
缸徑×行程 52.4 mm×57.8 mm 
排氣量 124.6 cc 
壓縮比 10.5 
怠速轉速 1600±100 rpm 
燃油系統 EFI, port injection 
點火系統 全晶體式點火 
氣門正時 
進氣 
IVO=10 ºBTDC 
IVC=20 ºABDC 
排氣 
EVO=30 ºBBDC 
EVC=10 ºATDC 
本研究利用火星塞式之汽缸壓力感測器擷取汽
缸內壓力，並經電荷放大器將該電壓訊號放大，搭配
角度編碼器所擷取的曲軸轉角訊號，同時送到燃燒分
析儀(combustion analyzer)，以繪製引擎汽缸壓力曲線
圖，藉此了解引擎汽缸內燃燒的情形。另外將排氣管
內廢氣導引至廢氣分析儀(emission analyzer)，以探討
稀薄燃燒對排放汙染的影響。實驗設備架構如圖五所
示。 
 
 
圖五 實驗設備架構圖 
 
4.2 實驗方法 
本研究實驗內容為探討 SDI 引擎對引擎扭力、
燃油消耗及汙染排放的影響。根據引擎在兩種不同運
轉情形，其為車速為 30 km/hr 時，引擎轉速約為 4500 
rpm、負載約為制動均效壓力(brake mean effective 
pressure, BMEP)1.7 bar；車速為 50 km/hr 時，引擎轉
速約為 5300 rpm、負載約為 BMEP 2.5 bar，進行均質
與層狀模式下之引擎稀油極限探討。而本研究定義稀
薄燃燒極限為引擎的指示平均有效壓力 (indicated 
mean effective pressure, IMEP) 的 循 環 變 異 量
(coefficient of variation, COV)在 10 %以內。 
 
5. 結果與討論 
5.1 流量測試台測試結果 
原引擎於兩進氣模式下之進氣道流量係數比
較，如圖六所示。新設計氣道之均質模式其流量係數
接近原廠數值，原廠平均流量係數為 Cf=0.502，而新
設計氣道之均質模式則是 Cf=0.496。新設計氣道之層
狀模式由於關閉另一個進氣道的緣故，故進氣道流量
係數較低為 Cf=0.202，但由於層狀模式適用在引擎運
轉於部分負荷(partial load)情形下，該流量係數尚可
接受。 
 
 
圖六 原廠與新設計進氣道之流量係數比較圖 
 
5.2 新設計進氣道之缸內流場模擬探討 
本研究 CFD 缸內流場分析主要係觀察汽缸內之
速度場(velocity field)情形，擷取通過汽缸軸中心且平
行於曲軸之橫斷面，觀察其氣流運動行為。模擬條件
設定為引擎 4500 rpm 且為部分負載(partial load)，其
模擬結果如圖七至圖十所示。 
 
 
圖七 進氣上死點後 90o 之缸內速度場比較圖 
 
 
圖八 進氣下死點之缸內速度場比較圖 
中國機械工程學會第二十八屆全國學術研討會論文集                         國立中興大學  台中市 
中華民國一百年十二月十日、十一日                                         論文編號: A03-010 
 
圖十三 相對空燃比與 NOX 之關係圖 
 
從圖十四可發現，當運轉於稀薄燃燒情形時，
因缸內的空氣量變多，氧氣量充足，燃燒過後的 CO
的排放量也隨之下降。如圖十五所示，為點火提前角
與相對空燃比之比較圖。因為在層狀模式時缸內混合
氣燃燒時間較短，故點火提前角小於均質模式。 
 
 
圖十四 相對空燃比與 CO 之關係圖 
 
 
圖十五 相對空燃比與點火提前角之關係圖 
 
 
5.5 新設計進氣道之燃油消耗探討 
如圖十六所示，為相對空燃比與制動平均燃油
消耗之關係圖。圖中顯示層狀模式之 BSFC 在
λ=0.9~λ=1.2 時較均質模式高，是由於引擎兩進氣道
其中之一被遮蔽住，使得引擎的泵吸損失(pumping 
loss)增加，BSFC 較均質模式來得高。而 λ=1.2~λ=1.6
時，引擎燃燒情形逐漸趨於穩定，其油耗漸漸受到改
善。當 λ>1.6 起，由於引擎已達到稀薄燃燒極限，燃
燒穩定性變差，因此 BSFC 隨之而上升。 
 
 
圖十六 相對空燃比與制動平均燃油消耗之關係圖 
 
6. 結論 
本研究利用一部 124.6 cc 四汽門機車引擎重新
設計進氣道及搭配可控制之渦流產生器檔片，以增強
引擎的進氣渦流，使引擎在低負荷時能以層狀進氣的
方法達到稀薄燃燒的目的。而本研究的新設計，結合
了進氣渦流與進氣門開啟時噴入燃油的方法，以產生
層狀進氣效果。研究結果吾人可得到下列幾點結論： 
(1) 新設計之進氣道與原廠進氣道相比，均質模式之
流量係數接近原廠數值，而層狀進氣則因關閉一
進氣道其流量係數較小。故本研究進氣道設計在
不影響原廠進氣道設定下，仍可以切換成不同進
氣模式。 
(2) 藉由計算流體力學軟體，可模擬缸內流場情形。
從模擬結果顯示，當切換成層狀模式時，引擎缸
內會有強烈渦流運動，在混合氣燃燒過程可藉由
此渦流提升缸內紊流，以減少燃燒時間。 
(3) 本研究運用半直接噴射系統搭配進氣渦流的方
式，可達到層狀進氣之效果，其稀薄燃燒極限於
層狀模式下可達到 λ=1.6。層狀模式下之 BSFC 
可比均質模式改善約 10 %以上。 
 
7. 誌謝 
本論文為國科會編號NSC-99-2221-E-027-063之
計畫，由於國科會的支持，使本計畫得以順利進行，
特此致上感謝之意。 
中華民國第十六屆車輛工程學術研討會，國立臺北科技大學車輛工程系，台灣台北，2011年 11月 11 日。 
The 16th National Conference on Vehicle Engineering, Nov. 11, 2011, National Taipei U. of Tech., Taipei, Taiwan, R.O.C.  C3-026   
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 
  
運用液化石油氣於半直接噴射引擎稀薄燃燒之研究 
 
郭益銘 1、Anh Trung Tran2、吳浴沂 3 
1國立臺北科技大學車輛工程研究所(碩士生) 
2國立臺北科技大學機電科技研究所(博士生) 
3國立臺北科技大學車輛工程系(教授) 
 
1
E-mail: xrisaac241510@gmail.com 
國科會計畫編號: 99-2221-E-027-063-MY3 
 
摘要 
本研究為利用液化石油氣(liquefied petroleum gas, 
LPG 於半直接噴射(semi-direct injection, SDI)引擎稀薄
燃燒之研究，在引擎進氣道中有一渦流產生器(swirl 
generator)檔片，藉由改變檔片在進氣道位置以切換均質
與層狀兩種不同進氣模式。均質模式(homogenous mode)
如同氣道燃油噴射(port fuel injection, PFI)係為進氣門
關閉時將燃油噴入進氣道，燃油在進氣門關閉時與空氣
先行混合後送入汽缸內。層狀模式(stratified mode)則於
進氣門開啟時將燃油直接透過進氣門噴入汽缸內，以達
到近似汽油直接噴射(gasoline direct injection, GDI)的效
果，本研究謂之半直接噴射。由於使用汽油等液態燃料
其燃燒情形易受燃油霧化不良影響，而 LPG 在常壓下
為氣體狀態且該燃料容易取得，故本研究利用 LPG 作
為燃料並搭配檔片所產生的進氣渦流，使引擎能達到層
狀進氣的方式，提升 SDI引擎稀薄燃燒的極限。 
過去研究曾使用液態燃料作為燃料，均質模式的稀
薄燃燒極限為過剩空氣比(excess air ratio, λ)λ=1.1，
層狀模式為λ=1.5。而本實驗結果顯示，若採用氣態燃
料做為燃料其均質模式下的稀薄燃燒極限為λ=1.4，層
狀模式則為λ=1.74。由此可知，使用氣態燃料因引擎
汽缸內燃燒情形不受燃油霧化情形影響，檔片切換至層
狀模式時其汽缸內產生的進氣渦流，能使火星塞附近油
氣為較濃的混合氣，使引擎能達到層狀燃燒以提高稀薄
燃燒極限，且汽缸內強烈的紊流可提升引擎燃燒速度及
燃燒效率。 
 
關鍵詞：液化石油氣、半直接噴射、稀薄燃燒、層狀進
氣、進氣渦流 
 
1. 前言 
在台灣這塊地狹人稠的地區，機車擁有高機動性、
便捷性的特性，儼然已成為國人最普遍的交通工具，根
據交通部統計處統計[1]，截至 2011 年 7 月底為止全台
機動車輛登記數為 15,044,808 輛，這些機車排放出來
CO、HC、CO2及 NOX等有毒物質是影響空氣品質的主
要原因之一，不但會危害人體健康且會加速地球的暖化
現象。在世界各國的汽機車污染法規當中，我國環保署
在機車排放汙染的管制上最為嚴苛。而目前台灣機車環
保法規已在 2007年 7月 1日邁入第五期排放標準[2]，
相當於歐盟 EURO 3 的標準，此標準日後勢必也會越來
越嚴峻。在能源與環保意識漸漸受到重視下，未來車輛
節能低污染技術的需求將越來越迫切。 
為了符合機車第五期環保法規標準，傳統化油器的
燃料供油系統已不符需求，進而採用電子燃油噴射 
(electronic fuel injection, EFI)系統。近年來，氣道燃油噴
射(port fuel injection, PFI)廣泛地被應用在 EFI系統上，
是在進氣門關閉時將燃油噴入進氣道，但是機車的進氣
道管徑較小，易在壁面上形成燃油油膜，此乃壁濕現象
(wall wetting)，此情形會造成引擎在加減速暫態時，進
入汽缸內的燃油量不準確而需要補償。汽油直接噴射
(gasoline direct injection, GDI)最早是運用於汽車上，利
用進氣氣流方向、燃燒室形狀與噴油正時適當的搭配，
在進氣或壓縮過程將燃油直接噴入燃燒室，使火星塞附
近是較易引燃的可燃氣，其他則為純空氣，藉此達到層
狀燃燒(stratified combustion)，可使引擎以極稀薄的燃油
運轉(λ>2.7)，亦即稀薄燃燒(lean burn)[3]。由於 GDI
系統燃油霧化時間相當短暫，其燃油液滴(droplet)的大
小會影響霧化時間，因此噴射壓力需要較高(約 50-100 
atm)[4]，噴油嘴霧化情形也需要較佳(液滴粒徑 25μm以
下)[4,5]。雖然 GDI 在汽車上的應用已相當純熟，但尚
難以應用在機車上，除了技術問題有待克服外，成本方
面仍是國內機車廠商所考量之處。 
目前汽機車引擎所使用的電子燃油噴射系統多為
PFI 系統。而本研究採用的半直接噴射係於進氣門開啟
時噴入燃油，燃油可由空氣直接帶入汽缸中達到近似
GDI 的效果。由於 SDI的噴射壓力較低(2-3 bar)可降低
噴射系統成本，且噴嘴不必接觸汽缸內高溫氣體，減少
積碳與故障發生。前人[6-11]利用 PFI 系統探討層狀進
氣情形。其中 Kookmin 大學歸納出渦流強度與噴油正
時對燃料分佈狀態的影響，運用進氣渦流且噴射正時為
進氣上死點後 150 CA即有層狀進氣的效果，讓油氣集
中在汽缸上層而能達到層狀燃燒。高志豪[12]利用空氣
輔助噴嘴(air-assist injector)探討 SDI 引擎稀薄燃燒極
限，藉由輔助空氣來改善噴嘴霧化情形，並於進氣道設
置一氣流引導隔板搭配半直接噴射，以達到層狀進氣的
效果。楊清潭[13]運用 CFD 數值方法進行 SDI 引擎層
中華民國第十六屆車輛工程學術研討會，國立臺北科技大學車輛工程系，台灣台北，2011年 11月 11 日。 
The 16th National Conference on Vehicle Engineering, Nov. 11, 2011, National Taipei U. of Tech., Taipei, Taiwan, R.O.C.  C3-026   
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 
  
除以其平均值之百分數，數學公式定義為： 
 
COV of IMEP =
avg
std
IMEP
IMEP
       (1) 
 
其中 IMEPstd為取樣期間之 IMEP 標準差，IMEPavg為取
樣期間之 IMEP 平均值。 
噴射正時則是採用結束噴油角 (end of injection, 
EOI)，並以間隔 30度曲軸角為單位從進氣上死點(intake 
top dead center, ITDC)到進氣下死點(intake bottom dead 
center, IBDC)，測試出引擎運轉時其燃燒穩定性最佳的
噴油正時。經由測試結果得知，當結束噴油角在進氣上
死點過後約 160 度曲軸角可獲得最佳的燃燒穩定性，如
圖 4所示。依照該噴射正時及引擎可獲得最佳的點火提
前角(MBT)下，以λ=0.1 為單位從理論混合比至稀改變
過剩空氣比的方式，探討 LPG 燃料於 SDI 引擎對稀薄
燃燒的燃燒穩定性、排放汙染及燃油消耗的影響。 
 
 
圖 4. 噴油正時與 COV of IMEP 關係圖 
 
5. 結果與討論 
5.1 稀薄燃燒對燃燒穩定性的影響 
均質模式以及層狀模式於不同引擎轉速下 λ 與
COV of IMEP 之關係圖，如圖 5、圖 6及圖 7所示。從
圖中可以發現，均質模式的稀薄燃燒極限為 λ=1.4，而
層狀模式的稀薄燃燒極限可至 λ=1.74。與楊清潭利用汽
油液態燃料作為燃料相比，其均質模式的稀薄燃燒極限
為 λ=1.1，層狀模式為 λ=1.5。本研究利用 LPG 氣態燃
料作為燃料，確實可提升 SDI 引擎稀薄燃燒的極限。 
在均質模式下因燃料進入汽缸內前已經與空氣先
行混合，汽缸中的混合氣濃度分佈較為均勻，但汽缸內
渦流運動較弱使火星塞周圍油氣較層狀模式稀薄，其稀
薄燃燒極限僅能達到 λ=1.4。而層狀模式藉由進氣渦流
與 SDI 系統，可促使汽缸內形成層狀進氣，讓火星塞周
圍有較濃的混合氣可被點燃，提升了稀薄燃燒的極限。 
圖 5 顯示兩種模式於 λ=1.0 至 λ=1.1 時，引擎的
COV of IMEP 並無太大變化，而層狀模式的 COV of 
IMEP 較均質模式低，是因汽缸內為層狀進氣之故，火
星塞附近有較濃的油氣，可獲得較穩定的燃燒情形。當
λ 大於 1.1 時，由於汽缸內混合氣濃度逐漸減少使燃燒
情形變得不穩定，降低引擎的燃燒穩定性，COV of 
IMEP 逐漸攀升。從圖 6 與圖 7 可發現，在較高引擎轉
速時，λ=1至 λ=1.3間的 COV of IMEP 變化均在 2.5 %
以內，其原因是因為在引擎轉速增加後，汽缸內紊流強
度也會跟著增強，汽缸內強烈的紊流運動能加強燃油的
混合情形及燃燒速度[14]，提升引擎的燃燒穩定性，但
在 λ逐漸增加的情況下其燃燒情形也漸漸變差。 
 
 
圖 5. 4000 rpm之過剩空氣比與 COV of IMEP 比較圖 
 
 
圖 6. 4500 rpm之過剩空氣比與 COV of IMEP 比較圖 
 
 
圖 7. 5000 rpm之過剩空氣比與 COV of IMEP 比較圖 
 
中華民國第十六屆車輛工程學術研討會，國立臺北科技大學車輛工程系，台灣台北，2011年 11月 11 日。 
The 16th National Conference on Vehicle Engineering, Nov. 11, 2011, National Taipei U. of Tech., Taipei, Taiwan, R.O.C.  C3-026   
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 
  
圍，當火星塞點燃混合氣時，使大部分油氣能完全被燃
燒，較不容易出現油氣未被點燃的情形，故 HC排放量
較均質模式低。 
 
 
圖 12. 過剩空氣比與 HC之關係圖 
 
當汽缸內的氧氣濃度不足，在燃燒過程中無法與碳
分子形成二氧化碳(CO2)時就會生成 CO，如圖 13所示，
為過剩空氣比與一氧化碳(CO)之關係圖。從圖中可發現
兩種模式下之 CO 排放結果有相同趨勢。隨著汽缸內空
氣量逐漸增加，CO 排放量會減少。 
 
 
圖 13. 過剩空氣比與 CO 之關係圖 
 
如圖 14 所示，為過剩空氣比與氮氧化合物(NOX)
之關係圖。NOX生成的原因會與汽缸內燃燒溫度、時間
跟氧氣濃度有關，其中 NOX 生成量最大時發生在理論
空燃比偏稀部分。當汽缸內空氣量較多時，會導致引擎
在燃燒過後氣體在高溫下有足夠的氧氣與氮氣結合成
較多的 NOX，從圖中可以得知 λ=1.1時，兩種模式下的
NOX生成量為最多。隨著空氣量的增加，燃油分子之間
的距離漸漸拉長，燃燒速度也變得緩慢，汽缸內的最高
溫度降低，使得 NOX的排放量逐漸減少。 
 
 
圖 14. 過剩空氣比與 NOx之關係圖 
 
如圖 15所示，為過剩空氣比與二氧化碳(CO2)之關
係圖。在理論空燃比附近因汽缸內混合氣燃燒較為完
全，使氧氣與碳結合大量的 CO2，所以排放量較多。但
λ 在理論空燃比或更稀時，CO2排放量則減少，是由於
引擎的空燃比在偏稀或濃的情形下，引擎的燃燒狀況都
是較差，因此 CO2的排放量都會因此而降低。 
 
 
圖 15. 過剩空氣比與 CO2之關係圖 
 
5.4 稀薄燃燒對燃油消耗之影響 
在本研究利用引擎排放污染數據(CO 及 CO2)來計
算引擎之燃燒效率，藉此以說明燃燒效率對引擎油耗的
影響，其 CO 及 CO2計算燃燒效率公式[15]如下所示： 
 
COCO
CO
c


2
2
               (2) 
 
即使汽缸內混合氣為理論當量比，但燃燒過程並未
全然是理想的燃燒情況。由於引擎運轉於每個循環下的
時間相當短，即使 λ在理論空然比時，仍有燃油未與空
氣充分混合，部分燃油分子在燃燒過程未能與氧氣反
應。如圖 17、圖 18 及圖 19 為兩種模式於引擎不同轉
速下燃燒效率之比較圖。從這些圖中可發現，當引擎運
轉在理論混合比時，由於沒有足夠的氧氣與燃油反應，
中華民國第十六屆車輛工程學術研討會，國立臺北科技大學車輛工程系，台灣台北，2011年 11月 11 日。 
The 16th National Conference on Vehicle Engineering, Nov. 11, 2011, National Taipei U. of Tech., Taipei, Taiwan, R.O.C.  C3-026   
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 
  
[3] R. Stone, Introduction to Internal Combustion 
Engines, PP.162-164, MACMILLAN Press Ltd, 
1999. 
[4] M. Kano, K. Saito, M. Basaki, S. Matsushita, and T. 
Gohno, “Analysis of Mixture Formation of Direct 
Injection Gasoline Engine,” SAE Paper No. 980157, 
1998. 
[5] F. Zhao, M.-C. Lai, and D. L. Harrington, “A review 
of mixture preparation and combustion control 
strategies for spark-ignited direct-injection gasoline 
engines,” SAE Paper No. 970627, 1997. 
[6] B. Queenan, C. Nightingale, and J. Bennett , “Charge 
stratification in a 4-valve SI engine through injection 
into one intake port with induced axial swirl within 
the cylinder,” SAE Paper No. 972875, 1997. 
[7] Y. Y. Wu, B. C. Chen, and A. T. Tran, Application of 
semi-direct injection for spark-ignition engine, 
International journal of vehicle design IJVD-13031, 
2010. 
[8] K. S. Jeong, Y. Ohm, Y. Yoon and I.S. Jeung, “Initial 
Flame Development under Fuel Stratified 
Conditions,” SAE Paper No. 981429, 1998. 
[9] I. Y. Ohm and Y. S. Cho, “Fuel Stratification Process 
in the Cylinder of an Axially Stratified Engine,” SAE 
Paper No. 2000-01-2842, 2000. 
[10] I.Y. Ohm and Y.S. Cho, “Mechanism of Axial 
Stratification and Its Effect in an SI Engine,” SAE 
Paper No. 2000-01-2843, 2000. 
[11] 吳浴沂、陳柏全，2005，「機車引擎稀薄燃燒可行
性研究計畫結案報告」，光陽工業股份有限公司委
託研究計畫。 
[12] 高志豪，空氣輔助噴嘴應用於半直接噴射系統之研
究，碩士論文，國立台北科技大學車輛工程系，台
北，台灣，2008。 
[13] 楊清潭，運用CFD數值方法於SDI引擎層狀進氣之
研究，碩士論文，國立台北科技大學車輛工程系，
台北，台灣，2011。 
[14] Willard W. Pulkrabek, Engineering Fundamentals of 
the Internal Combustion Engine, second edition, 
PEARSON Prentice Hall, 2004. 
[15] C. C. Lee and S. D. Lin, Handbook of Environmental 
Engineering Calculations, 2nd edition, McGraw-Hill, 
2007.  
  
 
國立臺北科技大學 
車輛工程系碩士班 
碩士學位論文 
     
運用 CFD 數值方法於 
SDI 引擎層狀進氣之研究 
An Investigation on Stratified Charging for SDI 
Engine by CFD Numerical Method 
 
 
 
 
 
 
 
 
研究生：楊清潭 
 
 
 
 
指導教授：吳浴沂 
 
 
 
中華民國 100 年 7 月 
 
 1 
 
國科會補助專題研究計畫項下出席國際學術會議心得報告 
                                   日期： 102 年 8 月 12 日 
                                 
 
一、參加會議經過 
今 (101)年度國科會計畫「機車引擎半直接噴射系統實車驗證」核定國
外差旅費 60,000 元，參加的研討會是： ICAE 2013 應用能源國際研討會  
(The 5
th
 International Conference on Applied Energy)，7 月 1~4 日在南非普利托里
亞 (Pretoria, South Africa) ，活動內容主要是研討會論文發表。  
計畫編號 NSC-99-2221-E-027-063-MY3 
計畫名稱 機車引擎半直接噴射系統實車驗證 
出國人員
姓名 
吳浴沂 
服務機構
及職稱 
國立臺北科技大學車輛系 
教授 
會議時間 
102年 7月 1日至 
102年 7月 4日 
會議地點 
南非普利托里亞 (Pretoria, South 
Africa) 
會議名稱 
(中文) ICAE 2013 應用能源國際研討會 
(英文) ICAE 2013 International Conference on Applied Energy 
發表論文
題目 
(中文 1) 運用計算流體力學(CFD)改善半直接噴射引擎稀薄極限以減
少排氣污染 
(英文 1) LEAN LIMIT EXTENSION OF SEMI-DIRECT INJECTION 
ENGINE FOR EMISSION REDUCTION USING CFD 
NUMERICAL METHOD 
(中文 2) 運用二甲醚(DME)及汽油於雙燃料均質壓燃引擎之增程器引
擎設計 
(英文 2) DESIGN OF HCCI ENGINE FOR RANGE EXTENDER USING 
DUAL FUEL OF GASOLINE AND DME ALTERNATIVE FUEL 
 
 3 
表二篇論文「LEAN LIMIT EXTENSION OF SEMI-DIRECT INJECTION ENGINE 
FOR EMISSION REDUCTION USING CFD NUMERICAL METHOD」和「DESIGN 
OF HCCI ENGINE FOR RANGE EXTENDER USING DUAL FUEL OF GASOLINE 
AND DME ALTERNATIVE FUEL」，如下所示。  
 
 
7 月 4 日無特別行程，只參加研討會，聽演講。 7 月 5 日搭中午起飛
的班機返國。  
 5 
Time 
2-A1 2-B1 2-C1 2-D1 2-E1 2-F1 2-G1 2-H1
1 08:10-08:30
2 08:30-08:50
3 08:50-09:10
4 09:10-09:30
5 09:30-09:50
6 09:50-10:10
10:10-10:30
2-A2 2-B2 2-C2 2-D2 2-E2 2-F2 2-G2 2-H2
7 10:30-10:50
8 10:50-11:10
9 11:10-11:30
10 11:30-11:50
11 11:50-12:10
2-A3 2-B3 2-C3 2-D3 2-E3 2-F3 2-G3 2-H3
12 13:10-13:30
13 13:30-13:50
14 13:50-14:10
15 14:10-14:30
16 14:30-14:50
17 14:50-15:10
15:10-15:30
2-A4 2-B4 2-C4 2-D4 2-E4 2-F4 2-G4 2-H4
18 15:30-15:50
19 15:50-16:10
20 16:10-16:30
21 16:30-16:50
22 16:50-17:10
Energy Sciences
Energy 
Management, 
Policy and 
Economics
Tea/Coffee Break 
Energy System 
& Efficiency 
Improvement
Energy System 
& Efficiency 
Improvement
Renewable 
Energy
panel session
Renewable 
Energy
Energy Sciences
18:00-22:00 Conference Banquet 
 Advanced 
Energy 
Systems
Renewable 
Energy
Energy 
Management, 
Policy and 
Economics
Energy Sciences
Climate 
Change 
Mitigation
Energy 
Management, 
Policy and 
Economics
Renewable 
Energy
Energy System 
& Efficiency 
Improvement
Tea/Coffee Break  
Afternoon
 Advanced 
Energy 
Systems
Renewable 
Energy
Energy 
Management, 
Policy and 
Economics
Energy Sciences
Climate 
Change 
Mitigation
Energy 
Management, 
Policy and 
Economics
Renewable 
Energy
Afternoon
12:10-13:10 Lunch 
Day 2: July 3, Wednesday
Morning
Renewable 
Energy
 Advanced 
Energy 
Systems
 Advanced 
Energy 
Systems
Renewable 
Energy
Renewable 
Energy
Energy 
Management, 
Policy and 
Economics
Energy 
Management, 
Policy and 
Economics
Energy 
Management, 
Policy and 
Economics
Energy System 
& Efficiency 
Improvement
 
 7 
4. 本人於該研討會所發表的二篇論文，已有一篇 (DESIGN OF HCCI ENGINE 
FOR RANGE EXTENDER USING DUAL FUEL OF GASOLINE AND DME 
ALTERNATIVE FUEL)接到通知被推薦投稿「Apply Energy」。該研討會 impact 
factor 很高，超過 4.0，品質要求很高，去年那篇經過多次審查修改，一年
後才被接受。 
5. 聽說南非貧富差距很大，所以治安不好，但是，普利托里亞大學(University of 
Pretoria)這個區域則很現代化，校園裡以英文為主，南非語為輔，學校
也很優美，超過百年歷史。師生有白人也有黑人，而且有幾位中國大陸去
的學生（他們在報到處擔任服務人員）。 
 
 
三、建議 
1. 大會晚宴上聽說明年(2014) ICAE 研討會將於台北市舉辦，同桌的幾位歐美
人士都表歡喜，中國大陸學者更喜歡，因為旅程很近。我們應當善用這些優
勢與機會，讓台北市在國際上更閃亮。 
 
 
四、攜回資料名稱及內容 
(1) 研討會論文，是存在 USB卡片型隨身碟中，攜帶及使用方便，並可查詢。 
(2) 與會人士的名片，促進國際交流，已有一位馬來西亞教授希望與我合作生質柴油
研究。 
 
 
99 年度專題研究計畫研究成果彙整表 
計畫主持人：吳浴沂 計畫編號：99-2221-E-027-063-MY3 
計畫名稱：機車引擎半直接噴射系統實車驗證 
量化 
成果項目 
實際已達
成數（被
接受或已
發表）
預期總達
成數(含實
際已達成
數) 
本計畫
實際貢
獻百分
比 
單位
備註（質化說明：如數個計
畫共同成果、成果列為該期
刊之封面故事...等） 
期刊論文 0 0 100%  
研究報告/技術報
告 0 0 100%  
研討會論文 3 3 100% 
篇
如附件十~附件十二 
論文著作 
專書 0 0 100%   
申請中件數 1 1 100%  
專利 已獲得件數 0 0 100% 件
本 計 畫 乃
「NSC-96-2221-E-027-037-MY3 
四行程汽油引擎半直接噴射系
統研發計畫」之延伸，而該計畫
所提出之研發成果，「噴射供油
方法及其裝置」發明專利在本計
畫執行期間已通過審查並在後
續計畫執行中應用，而本計畫期
間所提出之「新設計進氣道」發
明專利則還在審查當中但也在
計畫執行期間應用。 
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 9 9 100% 自本計畫產出兩篇碩士論文，如附件十四、附件十五 
博士生 1 1 100% 蔡弦錡，目前該名博士生仍在就讀中 
博士後研究員 0 0 100%  
國
內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次
 
期刊論文 4 4 100% 如附件一~附件四 
研究報告/技術報
告 0 0 100%  
研討會論文 5 5 100% 
篇
如附件五~附件九 論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
國
外 
技術移轉 
權利金 0 0 100% 千元  
