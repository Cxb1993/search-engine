 II
自主性分散式無線感測網路嵌入式系統研製(Ⅱ)-子計畫四: 
無線感測網路為系統程式與發展系統之研製(Ⅱ) 
 
 
摘要 
現在無線個人區域網路發展已漸趨成熟，開發應用的環境也有從室內走向室外的趨
勢，所以許多通信的規格也朝省電，輕薄，短小去發展，尤其是省電部份，因為延長無線
網路裝置工作生命，這對於長時間處在電源吃緊的戶外無線網路裝置而言，將無疑有如雪
中送炭般可貴。因此，本計畫主要是提出一些網路工作的機制，像裝置及協調者在信標模
式中可以不用在每個信標皆起來工作，取消非競爭模式(Contention Free Period，CFP)及協
調者適時的換手等方法，使感測網路能更省電及穩定，最後再透過MATLAB模擬證明了：
1.論文方法之省電效果確實比履行 IEEE 802.15.4規範之裝置來的好、2. P=信標間距/超級訊
框持續時間(SD/BI)越小之協調者在單位時間裡越省電及 3.工作在信標模式之裝置比工作在
非信標模式之裝置來的省電，然後本論文最後也開發出一個上述省電方法之模擬平台去證
明本文所提之方法是可被實行的。 
 
關鍵詞: 無線感測網路、IEEE 802.15.4、Beacon、Coordinator、信標 
 
 
 
 
 
 
 
 
 
 
 
 
 2
Frame 
type 
Security 
enable
Frame 
pending 
Ack 
request
Intra-
PAN Reserved
Dest 
addressing 
mode 
Reserved 
Source 
addressing 
mode 
圖 3 Capability information field之格式圖 
 
3 IEEE 802.15.4感測元件電源節省方法 
本計畫提出了以下的方法來促使無線感測元件能有較長之感測生命時間及使無線感測
網路有較穩定的網路傳輸： 
 
3.1、 競選 CD(協調者)的方法 
利用廣播剩餘電量的方法決定剩餘量最多者為無線感測網路中的協調者(Coordinator，
CD)。 
方法說明： 
在 Device處於 Power on或接受換手命令之後，會檢測是否有協調者，若無則 Device
會再檢查自己本身的 PANid是否為 0xFFFF或 macShortAddress是否為 0xFFFF，如果是，
表裝置未參與網路連結，然後讀取自己剩餘電量 Bt，接著把 Bt廣播出去，再接收其他 Device
廣播之剩餘電量 Br，把 Bt與 Br做比較，如果 Bt<Br，是的話，則停止廣播自己剩餘電量
Bt，否的話，則繼續讀出自己最新的剩餘電量廣播出去，直到 m次以前(m為自訂之次數，
此處因省電之需求，設為 3到 5之間)若已無聽到其他 Device廣播剩餘電量值 Br，則自己
剩餘電量 Bt為全部網域 Device中，電量最高者，則把 PAN_coordinator設起來，正式成為
CD，但倘若到了 m次以後含 m次，還是有聽到 Device廣播自己剩餘電力 Br(這時的 Br絕
對等於 Bt)，且 Bt=Br，則 Device與自己，從自己內部取一 timer亂數值當作 Bt在報出去，
若聽到的 Br<Bt則把 PAN_coordinator設起來正式成為 CD，若 Br>Bt則停止廣播出 Bt值，
但很不幸的這時Br=Bt則大家繼續讀取 timer亂數值當成Bt報出，直到決定出Bt>Br或Br>Bt
為止，CD產生為止。 
 
3.2、 Device實現多信標模式的設定 
每個無線感測元件依本身自我之屬性及需求，可決定要多少 Beacon起來工作。 
方法說明： 
每個無線感測元件，在 Device Power On時，就已知到自己需要多少信標週期起來工作
(由程式設計者去定義，更改 Chipset韌體就可以辦到)，然後在等到要加入(association)無線
感測網域時。於 association request command frame之 Capability information field中之 Bit5，
Bit4。依自己屬性定義，進行設定 Bit5及 Bit4，如表 1，共可決定 1、16及 32個信標週期。
而取 1、16及 32信標週期的原因，是使 CD能有較多之機會對全部 Device皆起來之信標
週期時間，發出信標訊框，告知全部 Device，CD需要執行換手等事宜。 
 
Beacon數\位元
位置 
Bit 5 Bit 4 
1 Beacon 0 0 
16 Beacons 0 1 
32 Beacons 1 0 
1 Beacon 1 1 
表 1  Capability information field Bit 4、5之意義 
 
3.3、 CD(協調者)決定多少信標起來工作之方法 
在CD決定出來後，CD會利用發出允許 association 網路的信標訊框，來收集全部Device
要多少 Beacon起來的屬性，以做為自己需隔多久時間，起來發出 Beacon的判斷依據。 
方法說明： 
Device為 CD，則把 BO設成 7、Agree_association設成 1，同意 Device對 CD發出
 4
Bc 0.07mA
每個協調者執行一個信標週期時間所耗
損之電力 
Ctn 待求 為第 n個協調者，共當多少次信標週期時間的協調者 
Bnc 0.01mA
每個裝置執行一個信標週期時間所耗損
之電力 
Cti 待求 為第 n個協調者，共當多少次信標週期時間的裝置 
X 50% 協調者換手電力百分比=(現存電力/Ball)*100% 
P 1 
P=SD/BI=2^(SO-BO)，為協調者動作時
間與一個信標總時間之比值，此處
BO=7，所以一個信標總時間為 2 sec。P
值在 0<P=<1區間，若 P=1，因未展現休
眠時間的省電，每一時間都持續耗電，
所以(4)式表現出的情形為近似非信標模
式，若 0<P<1則(4)式表現出的是信標模
式，因有展現休眠時間的省電，有部份
的時間未耗損電力。在此處 P假設為 1，
以方便模擬運算。 
表 2 數學式(4)各參數之意涵及模擬時所帶入數值 
 
下面數學式(5)表示第一個 Device當 CD經過 Ct1的時間換手，然後當了 Ct2的非
CD(Device)的時間，直到跟隨到第 n個 CD，做了 Ctn個非 CD(Device)的時間，最後所剩餘
的電量 Node1。而相同的道理(6)及(7)則分別表示第 2個當 CD及第 n個當 CD的 Device經
過 n次的換手，最後自己所剩餘的電量 Node2及 Noden。 
* 1* * 2* ... * * 1.....(5)
* 1* * 2* ... * * 2.....(6)
:
* 1* * 2* ... * * .....(7)
Ball Bc Ct P Bnc Ct P Bnc Ctn P Node
Ball Bnc Ct P Bc Ct P Bnc Ctn P Node
Ball Bnc Ct P Bnc Ct P Bc Ctn P Noden
− − − =
− − − =
− − − =  
 
假設數學表示式(5)、(6)及(7)中之剩餘電量 Node1 , Node2 , …., Noden的關係為，Node1 =< 
Node2…=< Noden(後面會用Matlab模擬跑出的圖形證明)，因為從(5)式可以看出 Ct1 >= Ct2 
>= Ct3 >= … Ctn(圖 4會證明)，所以我們只要分析(5)式就可以得到本文想要的最佳臨界關
係。 
為了方便計算及使模擬數值較簡單，在此我們先令 P=1(不考慮 P變數)，然後把表 2
參數數值帶入(4)式，分別可以一一算出 Ct1…Ctn，如圖 4，發現確實 Ct1 >= Ct2 >= Ct3 >= … 
>=Ctn。 
  
圖 4  Ct(n)與換手次數之關係圖   圖 5  Node(n)與第幾次做 CD之關係圖 
 
然後再把 Ct1 , Ct2 ,…, Ctn及表 2之數值帶入(5)、(6)及(7)式。利用Matlab執行，繪出
圖形如圖 5。從圖 5，我們可以發現到第一個當 CD的 Device在他跟隨 n個 Device進行換
 6
 
圖 9 首位 CD決定多少信標工作週期及總行為時間電力耗損模擬 
 
5.3、 用MATLAB模擬協調者在不同信標週期起來工作之耗電情形 
簡單考慮協調者的耗電(不考慮換手及只競爭一次之情形)如數學式(8)，此為協調者耗
電之數學表示式。 
CDPower(H)=Ball-K-{(Bc*P)*(H/BECONCNT)}.…(8) 
在(8)式中 
CDPower(H)：表協調者經過 H的時間，所剩之電量(mA)。 
H：表協調者工作歷經的總時間(hour)。 
BECONCNT： 表協調者多少個信標週期起來一次，這裡為 1、16及 32。 
其餘參數皆與表 2相符，只有”P”在這裡為不省略，此處 P為 0.01、0.5及 1。 
圖 10為把 P=0.5、BECONCNT=1及表 2之數值帶入式(8)，用MATLAB所繪出協調者
之剩餘電量與時間關係圖(此值模擬因其行為比較類似遵循 IEEE 802.15.4 信標模式規範之
協調者行為，所以此處模擬結果代表依循 IEEE 802.15.4 協調者之耗電情形)。然後用上述
的方法把 16及 32也分別帶入公式(8)，也可求出類似與圖 10之耗電與時間之關係圖，然後
我們可以觀察出如圖 10紅圈處之值，8小時處剩餘電力值將接近 0(這代表協調者的生命時
間)，依此類推也求出信標數 16與 32，分別在 140及 260小時處之剩餘電力值將接近 0。
再把不同信標數與上述電力剩餘 0之時間數繪圖，則得如圖 11，協調者的生命時間與不同
信標數之關係。然後我們把 P=0.5變成 P=0.01，分別再模擬 BECONCNT=1、16及 32之情
行，如圖 12、接者我們一樣去觀察圖 12、分別在 400、6300及 12300小時處之剩餘電力值
分別都將接近 0。 
 
協調者的生命時間與不同信標數之關係
8
140
260
0
100
200
300
0 10 20 30
信標數
時
間
(hr
)
P=0.5
 
圖 10 MATLAB模擬協調者每個信標週期起來工作之耗電情形(P=0.5) 
圖 11 協調者的生命時間與不同信標數之關係( P=0.5) 
 
協調者的生命時間與不同信標數之關係
400
6300
12300
0
5000
10000
15000
0 10 20 30
信標數
時
間
(hr
)
P=0.01
  
圖 12協調者的生命時間與不同信標數之關係(P=0.01) 
圖 13 MATLAB模擬協調者非信標週期工作之耗電情形 
 
