Huang transformation 
 
- 2 - 
 
Electrocardiogram)、口鼻氣流(Nasal and oral airflow)、胸及腹部呼吸動作(Chest and abdominal 
breathing effort)及血氧濃度(Blood oxygen saturation, SaO2)等主要訊號。腦波信號它依據頭部中
央區的腦波特徵(C3/A2 或 C4/A1)頻率、振幅及形狀來判讀，腦波主要形狀分為頭頂銳波(Vertex 
sharp waves)、k 複合波、紡錘波及鋸齒波(Sawtooth waves)所組成。眼動圖為測量 ROC(右眼外
側眼角)與 A1(左側耳垂或耳後乳突)位置，透過電位生理訊號判斷眼球移動。頦下肌電圖為測
量下顎部的變化。但上述傳統睡眠量測監測睡眠程度複雜且耗時，病患必須至醫院睡眠中心並
經由各種感測器連接至身上，透過睡眠技師判讀上述信號，以判定睡眠週期及相關的疾病，此
對病患而言，除了睡眠地點與習慣的問題外，監測時間過長及醫療費用與成本問題亟需有效的
改善。 
睡眠呼吸暫止症候群進行研究。此疾病發生主要原因通常為鼻咽腔和口咽腔至喉部上方
發生呼吸道縮窄或阻塞(圖 1 及 2)，當發生呼吸中止時，血氧飽和濃度降低，大腦中樞指揮系
統為了解決此問題，必須運作以爭一口氣，往往會伴隨大腦覺醒，但病人並不自知。因此夜晚
睡眠中，若每小時平均發生超過五次以上，長達十秒以上的呼吸暫停稱之睡眠呼吸暫止症候群。
臨床醫師依據多頻道睡眠生理分析儀及呼吸中止(Apnea)與淺呼吸(Hyponea)指數(AHI)，判定睡
眠呼吸中止症候群(Sleep apnea syndrome) 的嚴重度，一般分成輕度(每小時 5 - 15 次的呼吸中
止及淺呼吸)、中度(每小時 15 - 30 次的呼吸中止及淺呼吸)及重度(每小時 30 次以上的呼吸中
止及淺呼吸)。此疾病發生原因通常為身體構造、藥物、肥胖、年齡及酒精所造成，它不僅影
響病患晚上的睡眠及造成白天嗜睡，更會造成持續性高血壓、心律不整、心室肥大、肺部高血
壓、夜間心肌缺血，甚至梗塞或中風等疾病的產生。 
 
圖 1 正常睡眠呼吸 
 
 
圖 2 睡眠呼吸道阻塞 
- 4 - 
 
患的意識狀態監測：T. Ning 等人發現雙頻譜特性在安靜清醒、睡眠慢波第一及第二階段及快
速動眼期呈現差異性[1]；X. S. Zhang 等人將複雜度、近似熵及頻譜熵當成輸入參數，以類神
經模糊網路(Neural-fuzzy network)來估測麻醉的深度。目前有一個腦波意識監測的設備，EEG 
Bispectral Index (BIS)，係以腦波的特性來估測加護病房及全身麻醉病患之鎮靜深度及清醒程度，
BIS 會產生一個 0 至 100 的指標，0 表示無腦皮質活動，100 代表清醒，指標低於 60 表示不可
能回應口語命令。F. Dumana則是將病人整晚的睡眠EEG訊號做濾波後，再做Short Time Fourier 
Transform (STFT), Multiple Signal Classification (MUSIC) algorithm and Teager Energy Operator 
(TEO)三種方法後，合併成為一決策樹以判斷病人晚間的睡眠情況[2]。P. Jensen 發現當疼痛發
生時，大腦中的不同頻段的腦波也會跟隨者有不同的變化，並指出可以利用一些刺激大腦的方
式，來減少疼痛的感受[3]。 
 EEG 資料探勘為依據腦波訊號所萃取的特徵變數，利用統計或樣式特徵，探勘腦波知識。
A. H. Khandoker 利用連貫性分析(Coherence analysis)，找出 EEG 和 ECG 在 OSA 發生期間及發
生後，不同頻段功率頻譜密度關係[4]。結果發現 ECG 和 EEG 在快速動眼期，10~15Hz 的頻段
有極高的關連性，亦即在快速動眼期較容易識別 OSA 事件。 
P. Xavier 利用 Welch 頻譜估計法，分析呼吸中止和淺呼吸時及發生後，EEG 各頻段功率相關
性 [5]。研究發現，在事件發生時可能伴隨著腦波覺醒，且 Alpha 波、Theta 波及 Sigma 波功
率皆會上升。 
針對力病人與睡眠呼吸障礙的相關的研究，主要分為兩類：睡眠呼吸障礙指數及純粹生理
資訊統計。參考睡眠呼吸障礙指數會把 RDI 與其他測試參數比較：例如 Prudlo 將 19 個肌無力
患者進行兩天的睡眠實驗後發現肌無力患者的最大吸氣壓(Maximum inspiratory pressure)與睡
眠呼吸障礙呈現負相關，但無法找出肌無力患者與睡眠呼吸障礙之間的關聯性[6]。Quera-Slava 
等人針對 20 個肌無力病患進行臨床肺部壓力測試、橫隔壓力測試及動脈血氧測試並且經過 20
個月的觀察後發現肌無力病患且具有睡眠呼吸障礙的病人之年紀與 REM 期間 RDI 指數、睡眠
時間（Total sleep time）與睡眠時間血氧(SaO2)低於 90%指數呈現正相關[7]。而僅參考生理資
訊統計則常使用年齡、性別、罹患肌無力時間等參數找出與普通 OSA 病人不同之處，例如
Nicolle 首先將呼吸中止症狀、身體身高指數(BMI)、年紀評估產生一個 MAP 值(Multivariate 
apnea index)評估肌無力患者的睡眠障礙指數[8]，比對後發現肌無力且具睡眠呼吸障礙患者的
年紀比普通肌無力患者高、性別多為男性且具有較高的 BMI 值，但是睡眠障礙與患有肌無力
的時間以及肌無力的嚴重程度無關。Happe 蒐集 17 個肌無力病患與 14 健康人的持續兩週的睡
眠量表問卷後發現肌無力患者睡眠品質與睡眠效率較差而且也較常做夢[9]。 
 
3. 研究方法 
本計畫實作一個睡眠呼吸中止探勘系統架構，它包含三個模組：訊號前處理器、OSA 探勘
器及樣式建構器(圖 1)。訊號前處理器利用濾波器將腦波中極低頻和較高頻的成分濾除，並作
基線校正及希爾伯特-黃轉換((Hilbert-huang transformation)，以找出 OSA 特徵，它亦針對肌無
力症病患擷取心電圖低高頻比值(LF/HF)、肌電圖及眼動圖等特徵[10,11]。OSA探勘器依據OSA
特徵，利用 RBF 及 BPN 類神經網路，並結合歸納法，建立診斷規則及模型。肌無力樣式建構
器利用關聯規則探勘，建立肌無力且具睡眠呼吸中止症病人的生理訊號樣式模型。 
- 6 - 
 



t
ti
itP
9
][][                              (6) 
其中 β[i]為 Beta 波隨著時間變化的強度訊號。各頻段經由十秒移動頻率強度總和訊號處理之後，
再利用五點平均的 FIR 濾波器來作訊號的平滑化，以解決在特徵分析上會因為波峰或波谷相鄰
而產生特徵計算的誤差。 
特徵分析主要是針對阻塞型睡眠呼吸中止症(OSA)的持續時間(Duration)、睡眠時期(Stage)
及腦波相關頻段的計算。腦波相關頻段的計算是利用訊號轉換及平滑化後，留下與睡眠相關的
四個頻段（Delta、Theta、Alpha 和 Beta）之頻率強度，透過 HHT 轉換具有時域局部定位及充
分解析訊號的特性，根據圖 2 來觀察四個頻段在 OSA 持續期間內的振幅變化，腦波頻段上的
特徵萃取利用斜率(S)和變動率(A)，計算四個頻段在 OSA 持續時間內的最大、最小振幅值所
發生的時間點(圖 3.4)。腦波圖特徵變數分為睡眠技師標記的 OSA 持續時間、睡眠時期和睡眠
腦波頻段上的變動率和斜率等十個特徵。 
100*
timeMinXtimeMaxX
ampMinYampMaxY
iS 
                        (7) 






 

 ,,
,
100*
100*
timeMaxXtimeMinXifamp
ampamp
otherwiseamp
ampamp
MaxY
MaxYMinY
MinY
MinYMaxYiA
                (8) 
其中 i、 ampMaxY 、 ampMinY 、 timeMaxX 及 timeMinX 分別為四個腦波頻段(Beta、Alpha、Theta
和 Delta)、發生阻塞型睡眠呼吸中止症和腦波覺醒期間內最大和最小振幅值、最大和最小振幅
值的時間點(圖 3)。 
 
圖2 四個腦波頻段在OSA EEG持續時間內的成分 
 
 
- 8 - 
 
 
其中ܨ௦、ܴ௜及 ௝ܴ分別是是 ECG 的取樣頻率以及兩個 ECG 的 R 波。R 波的判斷方式為計算該點
之振幅為鄰近兩點間的最大值且振幅的大小超過 ECG 最大振幅之一半： 
R௜ = ݅		if	 ൞
ܧܥܩሾ݅ሿ > ܧܥܩሾ݅ + 1ሿ, ܽ݊݀
ܧܥܩሾ݅ሿ > ܧܥܩሾ݅ − 1ሿ, ܽ݊݀
ܧܥܩሾ݅ሿ > |ெ௔௫(ா஼ீ)|ଶ
               (12) 
其中ܧܥܩሾ݅ሿ及ܯܽݔ(ܧܥܩ)是 ECG 運算視窗第 i 點的值及 ECG 運算視窗內的最大值。 
EMG 及 EOG 則經過帶通濾波及基線校正後取出 0.05~0.2Hz 以及 0.05～0.5Hz 的頻段，並
利用均方根值計算其振幅的大小： 
 
   ܧܯܩ௥௠௦ = ට ଵమ்ି భ் ׬ ܧܯܩଶ(ݐ)݀ݐ
మ்
భ்                      (13) 
ܧܱܩ௥௠௦ = ට ଵమ்ି భ் ׬ ܧܱܩଶ(ݐ)݀ݐ
మ்
భ்                (14) 
 
其中 ଵܶ、 ଶܶ	、ܧܯܩ(ݐ)及ܧܯܩ(ݐ)分別為運算視窗的起始時間及結束時間、以及 EMG、EOG 濾
波後 t 秒內訊號。 
 
3.2 OSA 探勘器 
 OSA 探勘器利用兩種方法進行診斷知識規則探勘及模型建立。診斷知識規則探勘為透過
資料過濾及規則探勘，找出 OSA 診斷知識規則。前者為根據訊號前處理器輸出的 EEG 特徵向
量，利用 BPN 類神經網路進行分類過濾，輸入層有 10 個節點，分別代表 EEG 之信號特徵，
輸出層有 3 個，分別代表 OSA、OSA+Arousal 及 Arousal。後者為將過濾後分類正確的資料經
由最小類別的熵方法(Minimal Class Entropy)和最小描述長度原則(Minimum Description Length 
Principle)，將連續屬性進行量化，然後再透過 C4.5 決策樹演算法建立 OSA 的知識規則。診斷
模型建立為將 EEG 特徵向量利用 RBF 類神經網來學習，以建立 OSA 診斷模型。 
 
3.3 樣式建構器 
樣式建構器以腦電圖、心電圖、肌電圖及眼動圖特徵樣式，利用 Apriori 演算法探關聯規
則探勘，建立肌無力 OSA 前、OSA 時及 OSA 後各個頻段變化特徵樣式模型。特徵樣式組成
為{L_EEG,L_ECG,L_EMG,L_EOG}，其中 L_EEG、L_EMG、L_EOG 及 L_ECG 分別代表腦電
圖、肌電圖、眼動圖在 OSA 事件時的變異程度及心電圖之高低頻比值。變異程度是分別計算
腦電圖、肌電圖及眼動圖在發生 OSA 前 10 秒、OSA 持續 10 秒及 OSA 後 10 秒的頻率變異量
(V_EEG、V_EMG 、V_EOG)：    
ாܸாீ	 = | ∑ ܴܽݐ݅݋(݅ + 1) − ܴܽݐ݅݋(݅)்೐೙೏௜ୀ ೞ்೟ೌೝ೟ |                (15) 
- 10 - 
 
variations due to sleep disordered breathing events,” Proceedings of the IEEE International 
Conference on Engineering in Medicine and Biology Society, pp. 6097-6100, 2007. 
[6] M. A. Queta-Salva, C. Guilleminault, S. Chevret, and G. Troche, “Breathing  disorders during 
sleep in myasthenia gravis,” American Neurological Association, vol. 31, no. 1, pp. 86-92, 
1992. 
[7] J. Prudlo, J. Koenig, S. Ermert, and J. Juhász, “Sleep disordered breathing in medically stable 
patients with myasthenia gravis,” European journal of neurology, vol. 14, no. 1, pp. 321-326, 
2007. 
[8] M. W. Nicolle, S. Rask, and W. J. Koopman, “Sleep apnea in patients with myasthenia gravis,” 
Neurology, vol. 67, no. 1, pp. 140-142, 2006. 
[9] S. Happe, G. Klösch, and J. Zeitlhofer, “Perception of dreams and subjective sleep quality in 
patients with myasthenia gravis,” Neuropsychobiology, vol. 50, no. 1, pp. 21-27, 2004. 
[10] C. C. Hsu and Jie Yu, 2010.11, “Obstructive Sleep Apnea Diagnosis from 
Electroencephalography Frequency Variation by Radial Basis Function Neural Network,” The 
Second International Conference on Computational Collective Intelligence (ICCCI-2010), 
Lecture Notes in Computer Science 6422, pp. 268-277, 2010. 
[11] C. C. Hsu, Zhen-Gjia Cai, Hsing Mei, Hou-Chang Chiu, and Chia-Mo Lin, 2013.03, “Detecting 
the Duration of Incomplete Obstructive Sleep Apnea Events using Interhemispheric Features of 
Electroencephalography,” International Journal of Innovative Computing Information and 
Control, vol. 9, no. 2, pp. 705-726, 2013. 
 2
本次會議邀請 Shyi-Ming Chen、Seong-Whan Lee 及 Vladimír Mařík 擔任 Keynote 
Speaker，並有約 400 篇論文被接受並發表。本會議所有論文將收錄於 IEEE Computer 
Society。7 月 12 日晚間舉辦會議晚宴，並頒發最佳論文獎，晚宴出席人數約 200 人。 
 
二、與會心得及建議 
本人擔任本會議議程主持人(Session Chair)及論文發表人，本論文為在 7 月 13 日
OWC1：Machine learning and its applications 場次，時間為 9:00 至 10:05 進行，會議中共
有 6 篇論文發表，本人為第 6 位發表的作者。本議程由本人所組的議程，論文大都來自
國內各大學的教授所投稿，所有人均出席並發表論文。因本研討會為在大陸舉辦，因此
以華人居多，國內亦有近百篇論文發表，出席情況相當踴躍。 
 
三、考察參觀活動(無是項活動者略) 
略 
四、攜回資料名稱及內容 
   研討會論文集與論文光碟。 
  
100年度專題研究計畫研究成果彙整表 
計畫主持人：許見章 計畫編號：100-2218-E-030-003- 
計畫名稱：睡眠障礙診療與居家照護之研究--子計畫一：利用 EEG 訊號分析的睡眠障礙診斷系統之研
究(II) 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 1 1 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 4 4 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 1 1 100%  
研究報告/技術報告 0 0 100%  
研討會論文 1 1 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
