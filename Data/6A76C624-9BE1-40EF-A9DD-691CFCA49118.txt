2Rh Lh
ira
irb
irc
isa
isb
isc
JJG
sV
JJG
rVira
irb
irc
Re Le
ihaihbihc
ira irb irc
RdcCdc
Psh+jQsh Pse+jQse
Psh = Pse
Vha
Vhb
Vhc
Vea
Veb
Vec
Series
VSC
Shunt
VSC
Fig. 1. The UPFC circuit diagram
trol which will be effective only when the power system
experiences large disturbances. This supplementary control
strategy is related to on-line transient stability enhancement.
Traditionally, the control strategy is derived by the energy
function approach (or the so-called direct Lyapunov method)
[15], [16]. Although theoretical developments have been in-
vestigated, the corresponding controller design needs complete
representations of power system models and UPFC dynami-
cal models. As more detailed generator models are utilized
recently, more comprehensive analytical energy functions are
needed to develop first. Therefore, this approach seems not
to be very suitable for practical online applications. Some
alternative approaches must be adopted to overcome this
difficulty [17]. In this project, we will derive the corresponding
energy-function-based UPFC controller. In order to encounter
model inaccuracies arisen from the classical generator model,
we propose energy-function-based adaptive neural network
controllers. This controller can be treated as neural network
approximations of Lyapunov control actions. Therefore, this
controller can deal with model uncertainties and also provides
online UPFC control settings. The proposed control scheme
has been verified on a two-area power system. Simulation
results demonstrate that even when the power system is de-
scribed by high-order detailed generator models, the proposed
control strategy is still very effective for suppressing power
swing even under severe system conditions.
II. PASSIVITY CONTROL OF UPFCS
A. Euler-Lagrangian Model of UPFCs
VSC Model of UPFCs
A schematic representation of a UPFC embedded in a
transmission line, shown in Fig. 1, consists of two back-
to-back voltage source converters (VSCs), sharing a shunt
capacitor on the DC side. The shunt branch is in parallel
with the sending bus, where the shunt transformer and the
line reactance are model as a inductance Lh, Rh denotes
the transmission resistance. The terminal voltage of the shunt
converter denotes Vha, Vhb, Vhc, which are controlled by the
PWM control scheme to provide the shunt compensation and
keep the DC-voltage Vc at the desired value. The series trans-
former and the line reactance represent as a inductance Le.
The line resistance are model as a resistance Re. The terminal
voltage for the series converter represents Vea, Veb, Vec, which
is aimed to control the power flow at the desired transmission
line. Note that we use Rdc to represent the switching losses
of each VSC. The energy storing capacity of the dc capacitor
is generally small. Therefore, the active power drawn by the
shunt converter should be equal to the active power generated
by the series converter. Otherwise, the dc-link voltage may
adjust with respect to the rated voltage, depending on the net
power absorbed and generated by both converters. On the other
hand, the reactive power in the shunt or series converter can be
chosen independently, giving a greater flexibility to the power
flow control.
Control of both VSCs can be accomplished by the injection
of an AC synchronous voltage source with varying magnitude
and angle. The series converter of the UPFC can be modeled
as a controllable voltage Vse in series with Le, and Re. The
shunt side can be also represented by a synchronous voltage
source Vsh in series with Lh, and Rh. Thus, The synchronous
controllable voltage in both converters can be expressed as
~Vse=MseVs expj(θs+ϕse) = Vs(Ued + jUeq) expjθs (1a)
~Vsh=MshVs expj(θs+ϕsh) = Vs(Uhd + jUhq) expjθs (1b)
where Mse,Msh and ϕse, ϕsh are the modulation index and
the firing angle for each converters, respectively, Ued =
Mee cosϕse, Ueq = Mse sinϕse, and Uhd = Msh cosϕsh,
Uhq =Msh sinϕsh. Both shunt and series controllable voltage
Vse, Vsh are all depended on the magnitude and the angle of
the sending bus voltage Vs.
Mathematically, dynamical equations of the UPFC can be
written as follows:
Lhi˙hi +Rhihi = Vsi − Ehi , i = a, b, c (2a)
Lei˙ei +Reiei = Vsi − Vri − Eei , i = a, b, c (2b)
CdcV˙c −
∑
i=a,b,c
(Uhiihi + Ueiiei) +
Vc
Rdc
= 0. (2c)
This balanced three-phase system can be transformed into a
d− q synchronous reference frame by the Park’s transforma-
tion:[
xd
xq
]
=
[
cos θ cos(θ − 2pi3 ) cos(θ + 2pi3 )
sin θ sin(θ − 2pi3 ) sin(θ + 2pi3 )
] xaxb
xc

where x can be voltage or current variables. θ is the angle
between instantaneous system voltage vector and the a-phase
of the three-phase coordinate. Under this new coordinate, the
d-axis is always coincident with the instantaneous sending-bus
voltage vector while the q-axis is in quadrature with it, i.e.,
Vsd = |Vs|, Vsq = 0. Now the transformed UPFC dynamical
model is expressed as
Lhi˙hd +Rhihd + ωLhihq = Vsd − Ehd (3a)
Lhi˙hq − ωLhihd +Rhihq = Vsq − Ehq (3b)
Lei˙ed +Reied + ωLeieq = Vsd − Vrd − Eed (3c)
Lei˙eq − ωLeied +Reieq = Vsq − Vrq −Eeq (3d)
CdcV˙c −
∑
i=d,q
(Uhiihi + Ueiiei) +
Vc
Rdc
= 0. (3e)
Euler-Lagrange Modeling of UPFCs
The Euler-Lagrange (EL) equations were originally used to
describe the dynamics of mechanical systems. The advantage
of the EL formulation is that the form of the EL equations
4where the injection damping term is
Rm = diag[ Rmhd Rmhq Rmed Rmeq 0 ]
Subtracting of (8) from (6) yields the following error dynamic
model which is expressed in terms of x˜
M˜˙x+Rx˜+ J (u)x˜+Rmx˜ = 0 (9)
Thus, the associated Lyapunov function of this Euler-Lagrange
model can be defined as
H = 1
2
∑
i=d,q
i˜ThiLhi˜hi +
1
2
∑
i=d,q
i˜TeiLei˜ei +
1
2
V˜ Tc CdcV˜c. (10)
Following LaShall’s theorem, the time derivative of storage
energy function is forced to be negative semi-definite which
can be shown as
H˙ = −
∑
i=d,q
[(Re +Rmhi)˜i2hi − (Re +Rmei)˜i2ei]−
1
Rdc
V˜ 2c < 0.
Thus, the Lyapunov stability and convergence can be shown
that (6) is passive and input-output stable.
2) Determine Control Variables: The above method then
proceeds to restrict x = x∗ and solve Uh,dq, Ue,dq from (8).
The control inputs will become
Uhd=
1
V ∗c
(
−Rhi∗hd − ωLhi∗hq +Rmhdi˜hd + Vsd
)
, (11a)
Uhq=
1
V ∗c
(
ωLhi
∗
hd −Rhi∗hq +Rmhq i˜hq + Vsq
)
, (11b)
Ued=
1
V ∗c
(
−Rei∗ed − ωLei∗hq +Rmedi˜ed + Vsd − Vrd
)
,(11c)
Ueq=
1
V ∗c
(
ωLei
∗
ed −Rei∗hq +Rmeq i˜eq + Vsq − Vrq
)
(11d)
It can be shown that the resulting control contain the concept
of damping injection and energy shaping terms. The proposed
control algorithm, asymptotically achieves regulation of cur-
rents ih,dq, ie,dq to its reference command.
3) Decide Reference Current Commands: Both series
currents and shunt current commands are considered:
Series Current Command
The objective of the series converter is to inject a control-
lable voltage source into the line such that the line flow will
track the desired real power command P ∗r and reactive power
command Q∗r . Since the power at the UPFC receiving end can
be represented as follows:
Pr = (Vrdied + Vrqieq), Qr = (−Vrdieq + Vrqied).
Since Vrd = |Vr| cos θr and Vrq = |Vr| sin θr, the reference
current command ie,dq can be calculated from the desired
power flow commands and the voltage magnitude |Vr| at the
UPFC receiving end by the following formula:[
i∗ed
i∗eq
]
=
[
cos θr sin θr
sin θr − cos θr
]−1 [ P∗r
|Vr|
Q∗r
|Vr|
]
.
where θr is the receiving end bus angle. It can be obtained
from real-time measurements.
Shunt Current Command
The shunt converter is utilized to regulate the sending
bus voltage magnitude and the DC-bus voltage magnitude.
Therefore, the shunt real power Psh is regulated in order to
keep the UPFC DC voltage at the constant level, and the shunt
reactive power Qsh is determined by amounts of the sending
bus voltage Vs. If current variations in the shunt branch are
sufficiently small, real power and reactive power variations in
the shunt branch are proportionally to variations of sending bus
voltage magnitude and the DC-bus voltage magnitude, i.e.,
∆Qsh = k1(Vs − V ∗s ), ∆Psh = k2(Vc − V ∗c ). (12)
Since the d-axis is always coincident with the instantaneous
sending-bus voltage vector and the q-axis is in quadrature with
it, Vsd = |Vs|, Vsq = 0. The real power and the reactive power
through the shunt branch can be simplified as
Psh = Vsdihd, Qsh = −Vsdihq, (13)
where Psh and Qsh have the linear combination relationship
with ihd and ihq , respectively. After combining PI control and
(12)-(13), the reference current ih,dq can be obtained as.
i∗hd =
(
Kp +
KI
s
)
∆Psh, i∗hq =
(
Kp +
KI
s
)
∆Qsh.
4) Check the Zero Dynamics of the DC-bus voltages: Once
the current control is achieved, it remains to design the outer
loop control for DC-bus regulations. It is assumed that the
perfect current tracking is established. By substituting the PBC
control laws Eq.(11) into Eq.(6), the zero dynamics of DC-bus
voltage will of the following form:
V˙ ∗c (t) =
1
CV ∗c (t)Rd
[
Vc0 − V ∗c 2(t)
]
(14)
The above system has two equilibrium points. Similar to the
phase plane analysis discussed in [13], the smaller equilibrium
point is stable and only reasonable operating point. Therefore,
this design achieves the indirect control of DC-bus voltage to
the desired setting.
A block diagram of the proposed PBC control for designing
of UPFC controller is shown in Fig. 3. The proposed PBC
control system consists of two loops: the inner loop and outer
loop: the inner loop is designed by the PBC fed by the error
of d− q current, DC-side desired voltage V ∗c , and the UPFC
terminal voltage Vs, Vr . It is utilized to generate the switching
function for both converters. The outer loop is used to generate
the appropriate reference current into to the PBC inner loop
controller.
C. Simulation Results
In order to validate the proposed PBC method for UPFCs,
the conventional two-loop PI control scheme, shown in Fig
1, is also implemented for comparison studies. In this control
scheme,
shi = (Kp +
KI
s
)(ihi − i∗hi), sei = (Kp +
KI
s
)(iei − i∗ei)
61
10
2
20
3 101 13
4 14
11
110
12
UPFC
102
Fig. 5. One-line diagram of a two-area power system.
point. UPFC control parameters are Xse = 0.1 p.u., Xse =
0.1, V ∗s = 1 p.u., V ∗c = 1.5 p.u. , P ∗r = 150MW MW and
Q∗r = −80MW MVar. Two control parameters are chosen:
1) Conventional PI method: The parameters are Kps = 1,
Kis = 5, Kpc = 10, Kic = 10, Kpp = 5, Kip = 10,
Kpq = 5, and Kiq = 10.
2) PBC method: Rmhd = 0.1, Rmhq = 0.1 , Rmeq = 0.01,
and Rmeq = 0.01.
Three strategies are investigated:(1) without UPFC control, (2)
conventional PI control [6], and (3) PBC control. Simulation
verifications consists of two tests: (A) current regulation test,
and (B) system fault test.
D. Current Regulation Test
In order to show that the UPFC has the independent con-
trol ability, the external reference command will be changed
simultaneously. The following fault scenarios are applied: (i)
T=0s: Stating time simulation. (ii) T=2s: P ∗r from 150MW to
170MW and from -80MVAR to -60MVAR respectively. (iii)
T=8s: P ∗r and Q∗r are changed from 170MW to 190MW and
from -60MVAR to -40MVAR respectively. (iv) T=14s: P ∗r and
Q∗r are changed from 190MW to 170MW and from -40MVAR
to -60MVAR respectively. (v) T=20s: P ∗r and Q∗r are changed
from 170MW to 150MW and from -60MVAR to -80MVAR
respectively.
Fig. 6(a)-(b) show power flows on the UPFC transmission
line.C the power flow seems to have small oscillations after
changing the external reference under the PI control strategy.
Fig. 7 are detailed waveforms of Fig. 6 between 1.9 s and 2.4
s. Although the transmission line power flow can approach
to its reference under both control strategies, however PBC
control can provide more fast response than the conventional
PI control. The sending end and dc-side voltage are shown
in Fig. 6(c)-(d). It can be observed that the UPFC using the
proposed PBC control has better transient responses than that
of using the PI control.
E. System Fault Test
In order to validate transient response of the proposed UPFC
controller, a three phase fault is applied at Bus 3 near Bus 101
at 0.5 s. The near bus (Bus 3) fault is cleared at 0.55 s. The
remote bus (Bus 101) fault is cleared at 0.6 s. The UPFC line
power flow is shown in Fig. 8. From this simulation result, it
is clear that the PBC controller can provide more accurately
0 5 10 15 20 25
1.4
1.6
1.8
2
(a) time(s)
 
 
P
ref
PI Control
PBC Control
0 5 10 15 20 25
−1
−0.5
0
(b) time(s)
 
 
Q
ref
PI Control
PBC Control
0 5 10 15 20 25
0.99
1
1.01
(a) time(s)
 
 
PI Control
PBC Control
0 5 10 15 20 25
1.48
1.5
1.52
(b)  time(s)
 
 
PI Control
PBC Control
Fig. 6. Regulation test: (a)UPFC Line Real Power. (b)UPFC Line Reactive
Power. (c)UPFC Sending Bus Voltage (p.u.). (d)UPFC DC-side Voltage (p.u.).
1.9 1.95 2 2.05 2.1 2.15 2.2 2.25 2.3 2.35 2.4
1.4
1.5
1.6
1.7
(a) time(s)
R
ea
l P
ow
er
 (p
.u.
)
 
 
P
ref
PI Control
PBC Control
1.9 1.95 2 2.05 2.1 2.15 2.2 2.25 2.3 2.35 2.4
−0.9
−0.8
−0.7
−0.6
−0.5
(b) time(s)
 
 
Q
ref
PI Control
PBC Control
Fig. 7. Detailed Waveforms of the regulation test: (a) Line Real Power, and
(b) Line Reactive Power.
tracking performance than that of the conventional PI control
method even under serve contingencies. AC-bus and DC-bus
voltage profiles are shown in Fig 9. This experimental result
also validate that the proposed PBC method can provide some
robust ability in regulating both the AC-bus voltage and the
DC-bus voltage.
III. SUPPLEMENTARY CONTROL BY ENERGY FUNCTION
APPROACH
Energy functions that consider the UPFC’s action in the
form of supplement to energy functions for structure pre-
serving models are constructed. In order to easily derive
the efficacy of UFFCs for power system transient stability
analysis, the VSC-UPFC model can be seem as a voltage-
dependent model.
8is lossless (Psh = Pse), that is, Psh can be replaced by Pse.
Therefor, PUPFCs can be written as
PUPFCs = BseVsVrUed sin θsr +BseVsVrUeq cos θsr
= −PUPFCr (28)
It can be approved that the injection power PUPFCs is exactly
a negative quantity of PUPFCs .
C. Control Energy Functions of UPFC in Network-Preserving
Power System Models
1) Control Energy Function and LgV Controllers: As
shown later, the network-preserving power systems can be
described as the differential-algebra equation (DAE) which can
be built from eq. (33)-(39), as
x˙ = f(x, y) + h(x, y)u
0 = g(x, y) (29)
where xT = [ δ˜1 . . . δ˜m ω˜1 · · · ω˜m E′q1 · · · E
′
qm ],
yT = [ V1 · · · Vm+n θ˜1 · · · θ˜m+n ]. u represents the
control inputs from UPFCs. The differential equations describe
the dynamics of power systems while the algebraic equations
express the power flow equations at each bus. By virtue of the
implicit function theorem, it can be shown that this model can
be locally equivalent to a differential equation
x˙ = f(x, h(x)) = f¯(x)
Traditionally, energy function deal with the dynamical sys-
tems without inputs. Recently, some authors utilized energy
function candidates in feedback design by making the deriva-
tive of the energy function negative when choosing the control
[15], [20], [21], [22]. More precisely, consider a system
x˙ = f(x) + g(x)u
xe is an asymptotically stable equilibrium point of the open
loop system. Hence there exists a positive energy function
V (x) such that V˙ (x) = LfV (x) = ∇(V )f(x, u(x)) ≤ 0. A
control law of the form u = −k(LgV (x))T , k > 0 is called
an LgV control energy function. The closed-loop system is
then described by
x˙ = f(x)− kg(x)(LgV (x))T .
2) Energy Functions of Network-Preserving Power System
Models: The construction of the energy function of network-
preserving power system models will be investigated. It is
assumed that we have a multi-machine power system which
has a total of m + n buses of which the first m are internal
generator buses and the remaining n are load buses. It is
assumed that the transmission network is lossless and the one-
axis generator model is used for each generator. The dynamics
of each generators will be described with respect to the center
of inertia (COI) reference frame. The COI of the system is
defined as
δCOI =
1
MT
m∑
i=1
Miδi, ωCOI =
1
MT
m∑
i=1
Miωi (30)
where MT =
∑m
i=1Mi. Thus, generator variables in the COI
frame can be expressed as δ˜i = θi − δCOI , θ˜i = θi − δCOI
and ω˜i = ωi − ωCOI . For the i-th generator, i = 1 · · ·m,
˙˜
δi= ω˜i (31)
Mi ˙˜ωi=−Diω˜i + Pmi − Pei + Mi
MT
PCOI (32)
T
′
doE˙
′
qi=−
xdi
x
′
di
E
′
qi +
xdi − x′di
x
′
di
Vi cos(δ˜i − θ˜i) + Efdi(33)
where
Pei =
1
x
′
di
E
′
qiVi sin(δ˜i − θ˜i) +
x
′
di − xqi
2xqix
′
di
V 2i sin[2(δ˜i − θ˜i)]
PCOI =
m∑
i=1
(Pmi − Pei)
δ˜i is the rotor angle. ω˜i is the speed deviation. Di, Mi are the
damping ratio and the moment of inertia coefficients. xdi, xqi
are the direct and quadrature axis synchronous reactance. x′di
is the direct axis transient reactance. T ′doi is the direct axis
transient open circuit time constant. E′qi is the quadrature axis
voltage behind transient reactance. Efdi is the exciter gain.
The power balance at external generator bus i connecting
to the internal generator bus can be written as
Pi=
m+n∑
k=1
BikViVk sin(θ˜i − θ˜k) +
E′qiVi sin(θ˜i − δ˜i)
x′di
+
x′di − xqi
2xdixqi
V 2i sin[2(θ˜i − δ˜i)] (34)
Qi=−
m+n∑
k=1
BikViVk cos(θ˜i − θ˜k) +
V 2i − E′qiVi cos(θ˜i − δ˜i)
x′di
+
x′di − xqi
2xdixqi
V 2i {cos[2(θ˜i − δ˜i)]− 1}, fori = 1, · · · ,m,(35)
Similarly, the power balance at load bus i can be expressed as
Pi=
n+m∑
j=1
BijViVj sin(θ˜i − θ˜j) (36)
Qi=−
n+m∑
j=1
BijViVj cos(θ˜i − θ˜j), fori = m+ 1, · · · , n,(37)
In our formulation, the UPFC bus can be treated as a special
load bus. Therefore, power flow equations at each load bus
can be modified as
Pi + PLi + PUPFCi = 0 (38)
Qi +QLi +QUPFCi = 0 (39)
where PUPFCi and QUPFCi are power flow injections of
the UPFC embedded at bus i = r and i = s. Under this
framework, the energy function of the structure-preserving
power system model can be defined as
W (ω˜, δ˜, E′q, V, θ˜) =Wk +
8∑
u=1
Wpi +K0 (40)
10
ě
ě
ě
2
ijW
3
jnW
1
i
O
3
n
O

FNNK
ě
ě
2
j
O
( )u k
( )T 
sr s r
u or V or V
( )³u k
( 1)³u k
x2
x3
x4
x1
( 1)u k
Fig. 10. Forward Neural Networks
power system models. Some alternative approaches must be
adopted to overcome this difficulty [17]. In order to maintain
the additional damping from UPFCs under model uncertain-
ties and variations of operating conditions, the corresponding
gain of LgV control in eq. (48), 49), and (50) should be
adjusted according to operating points of studied systems and
UPFC installing locations. We will propose FNN controller
to adjust the output amounts of EFBSD controller online.
Generally speaking, this UPFC controller can be treated as
neural networks approximations of EFBSD control actions by
adjusting the output amounts of EFBSD controller online.
Thus, even when EFBSD is not mathematically precise as
the power system becomes more complex, the proposed FNN
supplementary damping control will provide learning ability
to automatically adjust the corresponding weighting functions
since the back-propagation learning algorithm incorporated in
the hidden layer.
The proposed forward neural networks (FNN) is shown in
Fig. 10. The overall FNN has three layers: one input layer, one
hidden layer, and one output layer. Note that there is very little
theoretical guidance for determining network size in terms of
the number of nodes of hidden layer it should contain [23].
By trial and error, 9 neurons in the hidden layer are optimally
chosen for this study. The input signals are chosen based on
different control objectives, such as, θ˜sr is referred to PUPFCsr
series control, Vr is chosen for QUPFCr series control, and
Vs is chosen for shunt QUPFCs shunt control. There are four
input signals. The first two are with time derivative of each
corresponding signals. The last two signals are chosen as the
integrator of each each corresponding input signals. The back
propagation algorithm is implemented for online tuning of
UPFC control settings. The output layer will compute the final
control command from the weighting sum of the hidden layer
outputs. The output signal K˜FNN can be seen as the adaptive
modulation gain of different control objectives for the UPFC
supplementary controller to damp out oscillations. Specifically,
the signal propagation in each layer is described as follows:
1) Input layer: There are four nodes in this layer, the output
of the net is presented as
net1i (k) = x
1
i (k)
O1i (k) = f
1(net1i (k)) = tanh(net
1
i (k)) (52)
where i = 1, · · · 4 denotes the neuron index in
input layer, k represents the number of iterations,
x1i (k), O
1
i (k) represents the input and output to the node,
and f1 is the activation function, which is a hyperbolic
tangent sigmoid function.
2) Hidden layer: The input-output relationship in this layer
is expressed as
net2j (k) =
4∑
i=1
W 2ijO
1
i (k)
O2j (k) = f
2(net2j (k)) = tanh(net
2
i (k)) (53)
where j = 1, · · · 9 denotes the neuron index in input
layer, O1i (k), O2j (k) represent the input and output to
the hidden layer, and W 2ij is the weights for the units in
the hidden layer. The activation f2 is also a hyperbolic
tangent sigmoid function.
3) Output layer: There is only one node in output layer,
which will compute the overall output as the summation
of all incoming signals as
O3n(k) =
9∑
j=1
W 3jnO
2
j (k) (54)
where n = 1 denotes the neuron index in input layer.
O2j (k) and O3n(k) represent the input and output to the
output layer, W 3jn is the weights for the units in the
output layer.
The weights in each layer are adjusted online by the back
propagation algorithm. We define the objective function of the
error signal as
E(k) =
1
2
4∑
i=1
xi(k)2 (55)
This objective function will consider to minimize the sum of
square of input signals. In order to minimize the objective
function, each weight is moved in the direction of the negative
gradient of E. Therefore, the weights can be updated as
W (k) =W (k − 1)− η∇W (k) (56)
where η is the learning rate, and ∇W (k) is the gradient of
E(k) with respect to W (k). In our simulations in the next
section, η = 0.001. The gradient of E(k) with respect to
weights for each node are derived as
∇W (k) = ∂E(k)
∂W (k)
=
∂E(k)
∂O3n(k)
· ∂O
3
n(k)
∂W (k)
(57)
where
∂E(k)
∂O3n(k)
=
4∑
i=1
xi(k)
∂xi(k)
∂O3n(k)
Since ∂xi(k)∂O3n(k) is not available analytically, we just estimateits sign and neglect its magnitude. Its magnitude will be
considered as the one portion of the learning rate η. Therefore,
∂xi(k)
∂O3n(k)
will be approximate by
∂xi(k)
∂O3n(k)
.= sign
[
xi(k)− xi(k − 1)
O3n(k)−O3n(k − 1)
]
12
Vc
+
_
Vs,ref
Power
System
Local Signals
Vs,dq
UPFC Shunt Controller
Passivity
-Based
Shunt
Controller
PIVc,ref 2 2
1tan
sh hd hq
hq
sh
hd
sh s sh
M U U
U
U
M
TT M

 
 
 
Uhd
Uhq
Vc ih,dq
Qr,ref
Passivity
-Based
Series
Controller
Vc ie,dq
+
PI
|Vs|
ihd*
ihq*
cos sin3
sin cos2
rr r
r r
r
P
V
Q
V
TT
TT
'ªº
«»ªº «»«» «» '¬¼ «»¬¼
Pr,ref
Vs,dq
Vr,dq
UPFC
VSC
Model
Vr,dq
ied*
ieq*
UPFC Series Controller
Ued
Ueq
Local Signals
2 2
1
tan
se ed eq
eq
se
ed
se s se
M U U
U
U
M
TT M

 
 
 
,se seM T
,sh shM TQsh_
Psh
Psr
Qr
srT/r rV V /s sV V
Qs
+
-
P
Q+
-
+
-
×
×
×
sr
T rV sV
Qr
Psr
Qs
or or
Forward Neural 
Network (FNN)
Energy Function Based FNN Supplementary Damping Controller
Local Signals
psr
K
qr
K
qs
K
ě
ě
ě
ě
ě
Fig. 11. The block diagram of the proposed UPFC control system
0 1 2 3 4 5 6 7 8 9 10
0.7
0.8
0.9
1
1.1
1.2
(a) time(s)
 
 Without control
PBC Control
PBC with EFSD Control
PBC with EFFNNSD Control
0 1 2 3 4 5 6 7 8 9 10
1.994
1.996
1.998
2
2.002
2.004
(b)  time(s)
 
 PBC Control
PBC with EFSD Control
PBC with EFFNNSD Control
Fig. 13. Transient response of the two area system in Case S3: (a)UPFC
Sending Bus Voltage (Bus 101), (b) UPFC DC-side voltage.
equivalent to a large part of the interconnected power system
and its behavior is similar to an infinite bus with low equivalent
impedance and high inertia. From system operation conditions
viewpoint, it would be desirable to install the UPFC in a
weak transmission line that is connected to low voltage buses.
Normally such line and bus are electrically close to the load
centers. Another important lines for UPFC installation are
0 1 2 3 4 5 6 7 8 9 10
25
30
35
40
45
50
55
60
65
time(s)
G
en
 3
 R
ot
or
 A
ng
le
(de
gre
e)
 
 
The original control sequence
The porposed control sequence
Fig. 14. Transient response of the two area system in Case S3: Rotor angle
(Gen 3) swing curves.
those that play as tie lines. This kind of line along with some
others can form tie lines for the system and are able to divide
the system into two or more main islands. According to [24],
it can be looked upon as two areas: generators 1,2, 3, 8, and
10 are in area A, and generators 4, 5, 6, 7, and 9 are in area
B. Bus 26 can be seen as one of a critical boundary bus and
line 26-29 also has a heavily load transfer. Thus, a UPFC are
14
G G
G
G
G
GG GG G
30
39
1
2
25
37
29
17
26
9
3
38
16
5
4
18
27
28
3624
35
22
21
20
34
23
19
33
10
11
13
14
15
8
31
12
6
32
7
UPFC
Fig. 19. Single line diagram of a New England system.
0 1 2 3 4 5 6 7 8 9 10
−30
−20
−10
0
10
20
30
40
50
60
70
80
time(s)
 
 
Gen 9
Gen 10
Gen 1
Gen 2
Gen 5
Gen 6Gen 3
Gen 4
Gen 7
Gen 8
Fig. 20. Transient response of a New England system without a UPFCin in
Case C1: Rotor angle swing curves
such a platform new control algorithms can be simulated and
executed directly, forming a real hardware in simulation loop
system. The operation of the system can also be monitored
and displayed on-line
The DSP-based dSPACE platform includes:
1) Power Electronics Drive Board: This board has the
capability to generate two independent PWM voltage
sources from a constant DC voltage source. It can be
seen as a back-to-back converter used in FACTS device.
To generate the controlled PWM voltage source, this
board requires various digital control signals. They are
generated by the DS1104 R/D controller board inside
the computer.
2) DSP based DS1104 R/D controller Board and CP1104
I/O board: In each discrete-time-step, the DS1104 con-
troller board takes some action to generate the digital
control signals. The type of action is governed by what
we have programmed in this board with the help of
MATLAB-Simulink real-time interface. This CP1104
0 1 2 3 4 5 6 7 8 9 10
−30
−20
−10
0
10
20
30
40
50
60
70
80
time(s)
 
 
Gen 9
Gen 10
Gen 1
Gen 2
Gen 5
Gen 6Gen 3 Gen 4 Gen 7
Gen 8
Fig. 21. Transient response of a New England system with a UPFC in Case
C1: Rotor angle swing curves
0 1 2 3 4 5 6 7
−100
−50
0
50
100
150
time(s)
 
 
Gen 9
Gen 10 Gen 1 Gen 2
Gen 5
Gen 6Gen 3
Gen 4Gen 7
Gen 8
Fig. 22. Transient response of a New England system without a UPFCin in
Case C2: Rotor angle swing curves
I/O board is an input-output interface board between the
Power Electronics Drive Board and DS1104 controller
board. The controlled digital signals supplied by DS1104
controller board are taken to the taken to the Power
Electronics Drive Board by CP1104.
3) MATLAB Simlulink and Control-desk: Control-Desk is
experiment software for seamless controller develop-
ment. It performs all the necessary tasks, and gives you
a single working environment, from the start of exper-
imentation right through to the end. The I/O ports of
CP1104 are accessible from inside the Simulink library
browser. When you build the Simulink control system
files by using real-time option, it implements the whole
system inside the DSP of DS1104 board. In control-
desk environment, you can change the variables of
your control system, and observe the detail information
through this software.
Table 1 is the parameters of the system. There are 2
conditions to validate the efficiency of the UPFC controller.
Due to the insufficient memory of the dSPACE hardware, there
is only shunt side of UPFC(STATCOM) implemented in this
experiment, and the switching frequency is limited at 2520Hz.
16
0 2 4 6 8 10
−1.4
−1.2
−1
−0.8
−0.6
−0.4
−0.2
0
0.2
Time (s)
iq
 
 
iq
iq
ref
Fig. 27. Current iq response to a change in the reference Vac command
0 2 4 6 8 10
38
38.5
39
39.5
40
40.5
41
41.5
42
Time (s)
V
dc
 
(V
)
 
 
Vdc
Vdcref
Fig. 28. Vdc response to a change in the reference Vac command
passivity control theory. the dynamical model of UPFC will
be represented by a Euler-Lagrangian (EL) system with a
set of EL parameters. The energy-dissipative properties of
system model are fully retained. The proposed nonlinear UPFC
controller consists of two feedback loops. In the inner loop, the
so-called passivity controller design will be applied to regulate
its reference current commands. The outer loop control is
to generate the proper reference signal into the inner PBC
inner controller according to the power flow requirement of
the UPFC. The second control objective is the supplementary
control which will be effective only when the power system
0 2 4 6 8 10
−0.8
−0.6
−0.4
−0.2
0
0.2
0.4
0.6
Time (s)
id
 
 
id
id
ref
Fig. 29. Current id response to a change in the reference Vac command
0 2 4 6 8 10
30
35
40
45
Time (s)
V
dc
 
(V
)
 
 
Vdc
Vdcref
Fig. 30. System response to a change in the reference Vdc command
0 2 4 6 8 10
−1.5
−1
−0.5
0
0.5
1
1.5
Time (s)
id
 
 
id
id
ref
Fig. 31. Current id response to a change in the reference Vdc command
experiences large disturbances. This supplementary control
strategy is related to on-line transient stability enhancement.
We develop the energy function-based control for this supple-
mentary control. The forward neural networks are incorporated
to this controller for robust control. Finally, this controlller is
realized in the dSPACE platform. Hardware implementations
of the proposed controller are studied. Various control objec-
tives are investigated through experimental studies to verify
the feasibility of the proposed UPFC controller.
0 2 4 6 8 10
18
18.5
19
19.5
20
20.5
21
21.5
22
Time (s)
Lo
ad
 V
ol
ta
ge
 : 
V l
o
ad
 
(V
)
 
 
V
ac
V
acref
Fig. 32. Vac response to a change in the reference Vdc command
出席國際學術會議心得報告 
                                                             
計畫編號 NSC 97-2628-E-007-031- 
計畫名稱 新型強化電力潮流控制器之協調控制設計與雛形實現 
出國人員姓名 
服務機關及職稱 
朱家齊(清華大學電機系副教授)  
會議時間地點 26-29 Oct.,2009 
會議名稱 IEEE Transmission & Distribution Asia Conference and Exposition 2009
發表論文題目 Applications of STATCOMs for Voltage Security Enhancements in Taiwan Power System  
 
一、參加會議經過 
 
2009 年 IEEE Transmission & Distribution Asia Conference and Exposition 2009
於 10 月 26 日至 10 月 29 日在韓國首爾 KOEX 會議中心舉行。本屆大會主題為”Green and Smart 
Grids”。由於近年來能源價格高居不下，再生能源與智慧型電網兩大議題成為本次大會最大
之特色。主要參與人員為亞太區學者專家，包含中日韓澳印度相關教授，台灣僅本人一人與
會，亦邀請多位美國知名教授參與如 Dr. Mohammad Shahidehpour , Illinois Institute of 
Technology 與 Prof. S. S. Venkata , University of Washington, USA 。本次大會之特
別議題安排如下： 
1. Advanced Data Mining Techniques for Power System Operating and Planning  
2. Microgrid and  Power Quality Enhancement 
3. Power IT 
此三主題均為 Smart Grid 發展之重點。其中第一主題為日本明治大學 Mori 教授精心規
劃。Mori 教授為本人舊識，潛淫 Data Mining 多年，他於國際學術活動表現積極。此外其他
二主題均由韓國教授規劃，特別值得一提的是＂Power IT＂此子題，主要報告韓國近年來於
Smart Grid 之發展。韓國於 2004 年已訂定國家級之相關智慧電網發展藍圖。目前已經完成
電力交易所之設置。用於系統調度之相關電能管理系統(EMS)之程式，已自行開發完畢。並外
銷至其他國家。相較於台灣電力系統，自由化尚未實施，過去舊的 EMS 系統已使用 18 年，新
的 EMS 系統由 Simmens 於本年度使用。但相關應用程式無法自製。此次大會特別凸顯韓國對
交易軟體，即時電力控制、FACTS、電力品質、PMU 等電力系統相關產品，韓國均可自製，足
證電力產業於韓國之蓬勃發展。 
二、與會心得 
1. IEEE Transmission & Distribution Asia Conference and Exposition 會匯集了世界各
國研究電力系統之產業人才、學界學者及研究生，透過多天的分組討論，針對當前電力系
統技術及發展深入探討。會議期間並與多位世界級大師晤談，收穫頗多。 
2. 近年來韓國積極發展電力事業，因此各種轉硬體均大量投資自行建製。此與台灣多利用國
外採購之模式大不相同。因此因實際開發之經驗豐富，國際上也備受矚目。可惜台灣無業
界代表可發表台灣之經驗，實感美中不足。 
3. 經由這次會議與多國師生討論，發覺台灣與會人數很少。在會場中看到多位中國大陸研究
生，自然地融入國際交流場合，反觀台灣學生雖能表達出研究之本意，但在臨場的問題解
答，則因社交用語及生活詞彙貧乏，表達未盡理想。台灣宜強化學生之國際觀，將可使台
灣學生在國際舞台更具競爭力。 
 
 
2C
AC
Grid
t
Vs Vsh
s
sh
Fig. 2. STATCOM Configuration: (a) Detailed Circuit Configuration. (b)
Equivalent Circuit.
Let the singular value decomposition of the system Jacobian
matrix has the following expression:
J = UΣV T =
n∑
i=1
σiuivi (2)
where U = [u1, · · · , un] and V T = [vT1 , · · · , vTn ]: ui and
vi are called the left singular vectors and the right singular
vectors respectively.
∑
is a diagonal matrix of positive real
singular values σi, such that σ1 ≥ σ2 ≥ . . . σi ≥ 0. The
smallest singular value σn is an indicator of the proximity to
the static voltage limit. The corresponding right singular vector
vn indicates the sensitive voltage magnitudes and angles.
Therefore, the relatively large elements of the right singular
vector vn will correspond to the most sensitive bus voltages
and this enables us to identify the weakest buses. Since the
propose of the shunt compensation is to provide the best
performance for voltage regulations, the STATCOM should
be placed at those buses which provide high voltage response
for incremental changes in reactive power injection.
III. STATCOM
The STATCOM is a power electronics-based generator of
dynamic reactive power that is connected in shunt with the
sub-station bus. As shown in shown in Fig. 2 (a), STATCOM
can be treated as an ideal voltage source converter, which in
general converts an input DC voltage into a three-phase AC
output voltage with rapidly controllable amplitude and phase
angle. In addition to this, the control system has a coupling
transformer and a DC capacitor. The control objective can be
designed to maintain the voltage magnitude and/or phase shift
of the VSC output voltage. Therefore, the STATCOM has the
ability to either generate or absorb reactive power by suitable
control of the controllable voltage Vsh with respect to the AC
grid voltage Vs. The equivalent circuit is shown in Fig 2(b),
in which Xt denotes the equivalent reactance of the coupling
transformer. The AC voltage difference across this reactance
produces the reactive power exchange between STATCOM and
AC grid.
The current injection model will be used to capture essential
dynamic behaviors of STATCOMS [1], [6]. Fig. 3 depicts its
block diagram. The input signal is the error signal between
the feedback voltage and the voltage reference command. In
addition, a droop loop is also used to avoid excessive control
actions and to coordinate with other voltage control equipment.
The error signal is passed through lead-lag term and integrator
to produce the STATCOM terminal voltage Vsh. The injection
current can be obtained by voltage deviations between the

Droop
 1 2
3 4
(1 )(1 )
(1 )(1 )
sT sT
sT sT


1
tX
atbase
base
S
S
K
s
Vs
ICMAX
ILMAX
Vsh
Vs
Vref
ISTATCOM
Fig. 3. STATCOM Control Diagram: Current Injection Model.
TABLE I
BUS VOLTAGE PROFILES UNDER SEVERE N-2 CONTINGENCIES. (P.U.)
Status Bus No. 1900 1910 2000 2100
Base 0.9965 0.9985 0.9972 0.9934
Heavily P1 0.9484 0.9274 0.9208 0.8922
Load P2 x x x x
P3 x x x x
Base 1.0113 0.9999 0.999 1.0291
Lightly L1 1.0054 0.9929 0.9936 1.0313
Load L2 0.9958 0.9929 0.9936 1.0444
L3 1.005 0.9962 0.9957 1.0308
AC terminal voltage and the STATCOM-side voltage, and the
coupling transformer reactance Xt.
IV. FEASIBILITY STUDY
Feasibility studies will be proceeded by the following steps:
1. Contingency Screening: First, static N-1 contingency analy-
sis will be performed. All power flows seem to converge
and satisfy the transmission planning criteria. Static N-2
contingency screening are proceeded. The most severe N-
2 contingencies during peak loaded hours are identified as
follows:
• P1: one unit of the Power Plant at Bus 10 trips out and
the transmission line between Bus 1900 and Bus 2490
trips.
• P2: one unit of the Power Plant at Bus 30 trips out and
the transmission line between the Bus 1900 and Bus 2490
trips.
• P3: Two transmission lines, between Bus 2000 - Bus 2480
and Bus 1900 - Bus 2490, trip.
Tab. I shows voltage profiles of major 345 kV substations
when the system experiences severe N-2 contingencies during
the heavily loaded hours. We find that P2 and P3 are the most
severe N-2 contingencies since power flow solutions can not
converge with mark ’x’ indicated in Tab. I. It can be concluded
that he most weak bus is Bus 2100.
We also perform contingency analysis for lightly loaded
hours. The most severe N-2 contingencies are listed as follows:
• L1: Two transmission lines, between Bus 2480 - Bus 2500
and Bus 1900 - Bus 2100, trip.
• L2: Both parallel transmission lines between Bus 1900
and Bus 2100 trip.
• L3: Two transmission lines, between Bus 1900 -Bus 2100
and Bus 1910 and 2100, trip.
All bus voltages are within the range of the transmission
planning requirement. However, the voltage profile at Bus
2100 are highest among the severe N-2 cases. In particular, in
L2 contingency, its voltage magnitude (1.04444 p.u.) is near
the maximum allowable value. Therefore, we need to install
some inductive compensators during the lightly loaded hours.
