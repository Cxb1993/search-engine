  I 
中文摘要 
本研究主要目的在於應用主成分分析(principal component analysis)、自組織映射圖
(self-organizing map, SOM)網路、指數洪水法(index flood method)與克利金法(kriging)推估台
灣地區未設測站地點不同重現期距之頻率降雨量，此方法可分為三個階段：分類階段、指
派階段以及建立階段。首先，本研究利用主成分分析針對台灣地區 127 個雨量站之年最大
一日雨量進行分析，總共擷取 9 個主要成分，再加上雨量測站之地文因子，以 SOM 網路進
行群集分析。由 SOM 網路所得之二維密度圖可知，全台雨量測站可被分成 17 群，亦即台
灣地區可劃分成 17 個均一性區域。根據未設測站地點之位置位於哪個均一性區域，即可知
其屬於哪個群集，再應用指數洪水法與克利金法推估該地點之平均年最大一日雨量，以進
行該地點之年最大一日雨量頻率分析。最後，經由交互驗證之結果顯示，不同重現期距之
雨量估計平均誤差大多低於 20%，因此建議可將此方法用於未設測站地點之雨量頻率分析。 
關鍵詞：主成分分析、自組織映射圖、區域頻率分析、未設測站地點 
Abstract 
The main purpose of the study aims to investigate the regional frequency for ungauged sites 
using principal components analysis, self-organizing map(SOM), index flood method and kriging 
method.  The proposed approach is composed of three steps: classification, assignment, and 
construction.  First, the 127 annual maximum daily rainfall data in Taiwan are available.  
Principal component analysis is applied to obtain the first nine principal components.  Based on 
the transformed data resulting from principal components analysis and the geographic characters 
of the gauges, the SOM is used to group the rain gauges into specific clusters.  A 
two-dimensional feature map indicates that the rain gauges can be grouped into 17 clusters.  That 
is, the 17 homogeneous regions for regional frequency analysis can be delineated.  One can 
determine which ungauged site belongs to which region according to the location of the site.  The 
index flood method and kriging method then are applied to investigate the regional frequency for 
ungauged sites.  The rainfall magnitudes with various return periods for 17 gauged sites are 
estimated.  Finally, the results of cross-validation tests show that the values of mean absolute 
percent error (MAPE) for most regions are less than 20%.  Hence, the proposed approach is 
recommended as an alternative to perform the regional rainfall frequency for ungauged sites. 
Keywords: Principal component analysis, Self-organizing map, Regional frequency analysis, 
Ungauged site. 
  2 
本身常不是研究的最後輸出，而是其他分析，例如：迴歸分析、因子分析(factor analysis)、
群集分析(cluster analysis)等輸出(楊皓二，1995)。假定有 P 個變量(X1, X2, X3,…,Xp)，即視為
其存在於一 P 維的向量系統中。因此變量彼此間可能具有高度相關性，就物理意義來說，
即某一訊息變量 Xi，亦同時存在於其他變量中。主成分分析可保留大部分原始變數分佈特
性，並達到降低變數之維度，且各成分間相互獨立，故可不重複表達大部分資料之特性。
主成分分析之理論如下： 
觀測向量 X 具有 P 個變數，N 項觀測資料，以矩陣可表示為： 
      p
t
X XEXEXE 21                                            (1) 
X 不同變數間之協變異數向量為 Σ，其為一對稱矩陣，可對 Σ 進行正交分解為： 
CCt                                                                (2) 
其中，為對角矩陣(diagonal matrix)，其對角線上之元素為 Σ 之特徵值 λ1, λ2… λp。C 為 P×P
維正交矩陣，且滿足 ICC t  ，其第 j 行即為相對於 λj 特徵值之特徵向量。轉軸後之主成
分向量 Y 與原始向量間存在著線性轉換關係： 
XCY                                                                 (3) 
2.1.2 SOM 網路分群 
SOM 網路屬前饋式、非監督式學習網路，係由 Kohonen 於 1982 年所提出，其網路架
構如圖 1 所示。SOM 網路之學習過程中包含三個重要程序，分別是競爭程序(competitive 
process)、合作程序(cooperative process)及調整程序(adaptive process)，其演算過程敘述如下： 
1. 競爭程序 
若輸入樣本資料具 m 維度如(4)式，則輸入層與隱藏層中各神經元間鍵結權重向量亦具
相同維度 m，而各神經元鍵結權重之初始值乃以隨機變數產生，優勝神經元權重如(5)式： 
 TmxxxX ,, ,21                                                       (4) 
ljwxxi j
j
,2,1minarg)(                                              (5) 
其中， )(xi 為輸入樣本與各神經元鍵結權重之最短距離。於此程序中每筆輸入樣本資料輸
入後，緊接為評估此輸入樣本資料與網路中各神經元之相似程度，而後挑出與該輸入樣本
資料相似度最高之神經元，令其受到激發並進入後續程序。 
2. 合作程序 
輸入樣本資料歷經競爭程序後便可得一個優勝神經元，而該神經元則作為拓樸鄰域之
中心。神經元間存在側向地交互作用之影響，且其與神經元間之距離成反比，距離愈遠則
影響相對愈小。關於拓樸鄰域之概念可以高斯函數表示如下： 
  )2/(exp
22
,, ijxij dh                                                       (6) 
其中，  ,j i xh 為優勝神經元 i 及鄰近神經元 j 之鄰近關係值。
2
,j id 為拓樸圖上神經元 j 與優勝
神經元 i 之歐式距離。其趨近無限大則拓樸鄰域將趨近於零，為 SOM 網路收斂之必要條
件。 為拓樸鄰域有效寬度(effective width)亦即鄰域半徑。拓樸鄰域另一特徵為隨時間增加
(疊代次數，the number of iterations)而縮小可利用，如下式： 
  ,2,1,0)/(exp 10  ttt                                               (7) 
其中， 0 為 之起始值，t 為疊代次數， 1 為常數，故可將拓樸鄰域以鄰域函數(neighborhood 
function)如下式： 
    )2/(exp
22
,, ndth ijxij                                                   (8) 
  4 
表 1 不一致估量臨界值 
測站數 不一致估量值 D 測站數 不一致估量值 D 
5 1.333 11 2.632 
6 1.648 12 2.757 
7 1.917 13 2.869 
8 2.140 14 2.971 
9 2.329 15 3 
10 2.491   
2. 異質性估量 
異質性估量之目的為測詴經由群集分析所得之群集，其水文量是否具有均一性，亦即
測詴群集內之測站其線性動差之分散度。Hosking and Wallis(1997)建議使用線性動差比 t 之
標準偏差作為分散度之簡單計算。異質估量統計值 H (heterogeneity test statistic)定義如下： 
ii VVii
VH  /)(  ，i=1 ,2 ,3                                                (12) 
其中，
iV 代表觀測資料之線性動差特性，其定義請參閱 Hosking and Wallis(1997)。 iVμ 及 iV
為四參數 kappa 分佈所繁衍之資料，其 iV 之平均值及標準偏差。若該群集資料計算所得之 H
值非常大時，則表示該群集內用於計算之測站資料具有異質性。Hosking and Wallis (1997)
建議當 1H 時為均一性區域；當 2H 時則為異質性區域；若H 介於 1 與 2 之間，則該區
域為可能的異質性區域。 
2.2 指派階段 
2.2.1 均一性區域劃分 
均一性區域代表該區域各測站之頻率分佈經由適度的轉換後是相同的。本研究所採用
均一性區域劃分之方法如下所述：假設將此區域劃分為 n 群的種類，空間中任一點必屬於
其中任一群。區域中有 m 個已知其類別之點，其座標為(x1, y1), (x2, y2), …, (xm, ym)。區域中
任一點座標為(x, y)，定義該點為第 a 群  na 1 的機率為 Pa(x, y)。若 Pa 為 P1, P2, …, Pn
其中最大者，則定義該點屬於第 a 群。Pa 在此並非指統計上真實的機率，而是一種概念，
是用以比較其屬於哪一種類別的比較值。計算 Pa 時，先設定一個函數 fi，用以代表第 i 個
已知點是否屬於第 a 群，1 代表隸屬，0 代表不隸屬： 




0
1
if   
ai
ai


  mi ,,2,1                                                (13) 
計算(x, y)至(x1, y1), (x2, y2), …, (xm, ym)的距離為 d1, d2, …, dm： 
   22 iii yyxxd                                                    (14) 
取 21 id  mi 1 為權重因子，並調整權重因子之相對大小使得Σwi =1： 
2
1
2
/ i
m
i
ii ddw 

                                                           (15) 
則任意點(x, y)上屬於第 a 群的機率值便為： 
  


m
i
iia fwyxP
1
,                                                         (16) 
比較(x, y)上共 n 群之機率值，選定最大者為該點的劃分之類別，將全區域劃分網格點，
計算每一點之類別，便可劃分出均一性區域。當均一性區域劃分完畢，即可根據未設測站
地點之位置落於哪個區域得到其屬於哪個群集。 
2.2.2 適合度估量 
  6 
關於未設測站地點之平均年最大一日雨量估計，本研究則利用克利金法來建立年最大
一日雨量平均值之空間模式，藉以推估未設測站地點不同頻率之年最大一日雨量，關於克
利金法之理論及應用於未設測站地點頻率分析之方法概述如下： 
克利金法之基本假設為各變數是具有某種空間特性之隨機變數，其中，最主要之特性
為「二階定常性」(second-order stationary)。定常性乃表示區域化變數的平均值及變異數不
因位置的改變而改變，而兩不同位置之觀測值的共變異數(covariance)只與其相對距離有
關。此外，克利金法具有最佳線性不偏估(best linear unbiased estimator)的特性，敘述如下： 
1. 線性：推估值為觀測值的線性組合。 
   i
n
i
i xzxz 


1
00
ˆ                                                          (23) 
其中，  0ˆ xz 為 0x 位置之估計值， i0 為內插係數，  ixz 為已知位置之觀測值。 
2. 不偏估：估計值的平均值與觀測值的平均值相同。 
     00 EˆE xzxz                                                         (24) 
將(23)式代入(24)式可得下式： 
     0
1
00 EE xzxz
n
i
i

                                                     (25) 
所以 
1
1
0 

n
i
i                                                               (26) 
3. 最佳：即估計誤差變異數為最小。 
     00ˆVarmin xzxz                                                      (27) 
三、實例應用 
3.1 研究區域概述 
本研究選用臺灣地區 127 個雨量測站為研究對象，其隸屬單位皆為經濟部水利署，每
個雨量測站之降雨資料長度為 20 年。圖 2 為 127 個雨量測站分布示意圖。 
 
圖 2 台灣地區 127 個雨量測站分布示意圖 
  8 
3 1 1 1 0 0 3 1 0 2 1 0 2 2
2 1 2 2 0 0 0 0 0 2 1 0 0 1
1 2 2 1 0 0 0 0 0 1 1 1 0 3
1 1 0 0 0 0 1 1 0 0 1 1 0 0
1 1 0 0 0 0 0 1 0 0 1 2 0 2
0 0 0 0 0 0 0 1 0 0 1 1 0 2
1 1 0 0 1 0 0 0 0 0 0 0 0 1
1 0 0 1 1 0 1 0 0 0 0 0 1 1
2 0 0 0 1 0 2 2 0 2 3 0 1 2
0 0 0 0 0 0 0 0 0 1 1 0 0 0
0 0 0 0 1 1 1 2 0 0 0 0 0 3
1 2 1 0 0 0 1 1 0 1 2 0 1 1
1 1 0 0 1 0 0 0 0 0 0 0 0 0
3 0 0 2 1 3 0 1 1 1 0 2 1 4  
圖 3 SOM 網路所得 14×14 之二維映射圖 
表 3 不一致估量及異質性估量測詴結果 
區域 
編號 
不一致 
估量 D 
異質性估量 H 區域 
編號 
不一致 
估量 D 
異質性估量 H 
H1 H2 H3 H1 H2 H3 
1 0.22~2.28 -1.14 -0.06 -0.82 10 0.07~2.42 -1.20 -2.49 -2.04 
2 1.00 -0.18 0.59 0.32 11 0.10~1.69 -0.01 0.08 0.76 
3 0.04~1.51 -0.14 -0.19 0.42 12 1.00 0.69 -0.70 -1.39 
4 1.00 -0.23 -0.41 -0.81 13 1.00 -0.54 -1.35 -1.34 
5 1.00 -1.26 -0.72 -0.33 14 1.00 -1.13 -0.34 -0.25 
6 0.44~1.33 -1.19 -1.05 -1.41 15 0.27~2.11 -1.14 -2.78 -3.11 
7 0.72~1.32 -0.72 -0.69 -0.80 16 1.00 -0.23 -0.41 -0.81 
8 0.07~1.73 0.34 -1.00 -1.09 17 0.48~1.61 0.41 -1.97 -2.47 
9 0.42~1.90 -1.16 -1.22 -0.96      
4.2 指派階段之結果 
為了接下來未設測站地點群集之歸屬問題，以及將來水利規劃使用上之便利性，本研
究特地將分類階段所得之各群集邊界分別求得並繪出，得到全台灣地區這 17 個群集之均一
性區域，圖 4 即為台灣地區 17 個均一性區域及測站位置分佈圖。 
區域內各測站的年最大一日降雨資料經檢定具有一致性及均一性後，本研究依據
Hosking and Wallis(1997)所建議之五種機率分佈來建立區域降雨頻率分佈，這五種機率分佈
分別為通用羅吉斯分佈(GLO)、通用極端值分佈(GEV)、三參數對數常態分佈(LN3)、皮爾
遜第 III 型分佈(PE3)以及通用帕雷托分佈(GPA)，本研究以適合度估量來判定五種機率分佈
用於各區域年最大一日降雨頻率分析之適用性。表 4 為 17 個均一性區域之適合度估量計算
結果，由表 4 之結果可知，在判定標準為|Z|≦1.64 之條件下，各區域能接受的機率分佈不
盡相同。 
決定各區域所適合的機率分佈後，本研究選擇符合|Z|≦1.64，且|Z|值取最小的機率分
佈作為該區域之最佳機率分佈。其中，屬於 GPA 之機率分佈最多，共計九個區域，分別為
第 2、3、4、5、6、8、10、11 及 14 區；屬於 GEV 之機率分佈共計兩個區域，分別為第 1
及 17 區；屬於 PE3 之機率分佈共計四個區域，分別為第 7、9、12 及 16 區；屬於 GLO 及
LN3 之機率分佈最少，分別各只有一區，分別為第 13 區及第 15 區。 
  10 
表 5 各均一性區域交互驗證之 MAPE 值(單位：%) 
區域 
編號 
重現期距(年) 區域 
編號 
重現期距(年) 
5 10 20 50 100 5 10 20 50 100 
1 16 16 16 17 18 10 9 6 7 9 10 
2 18 22 23 24 24 11 13 14 15 17 18 
3 8 9 9 13 17 12 5 3 3 3 6 
4 13 13 13 15 19 13 11 11 11 13 17 
5 12 12 12 12 13 14 16 17 18 21 23 
6 8 8 9 11 12 15 11 9 8 8 13 
7 12 13 13 16 19 16 12 12 14 16 18 
8 9 11 12 15 16 17 3 5 7 12 16 
9 10 9 7 10 15       
五、結論與建議 
5.1 結論 
1. 本研究主要目的是針對台灣地區雨量測站之年最大一日降雨量，以線性動差法作區域降
雨頻率分析。總共選取水利署 127 個雨量測站資料作分析，針對雨量測站之年最大日雨
量紀錄作整理，共計有 20 年之雨量紀錄。 
2. 本研究結合主成分分析與 SOM 網路，將其應用在台灣 127 個雨量測站之均一性區域劃
分上，經由 14×14 之映射圖發現雨量測站可被分成 17 個群集，因此可將全台灣地區劃分
成 17 個均一性區域。 
3. 經由線性動差之不一致估量及異質性估量演算結果可知，本研究所劃分之全台灣 17 個均
一性區域均通過檢定，亦即代表這些區域之雨量資料具有一致性及均一性。 
4. 本研究依適合度估量來判定五種機率分佈(羅吉斯分佈(GLO)、通用極端值分佈(GEV)、
三參數對數常態分佈(LN3)、皮爾遜第 III 型分佈(PE3)及通用帕雷托分佈(GPA))用於各區
域年最大一日降雨頻率分析之適用性，選擇符合|Z|≦1.64，且|Z|值取最小的機率分佈作
為該區域之最佳機率分佈，其結果將可供未來台灣地區水利設施規劃建設時之參考。 
5. 關於未設測站地點之頻率分析，本研究根據未設測站地點之位置位於哪個均一性區域，
即可知其隸屬哪個群集，再利用克利金法推估該地點之平均年最大一日雨量，以進行該
地點之年最大一日雨量頻率分析。 
6. 經由交互驗證之結果顯示，不同重現期距之雨量估計平均誤差大多低於 20%，因此建議
可將本研究所提之方法用於推估台灣地區未設測站地點最大一日降雨量上。 
5.2 建議 
1. 台灣地區之雨量測站分布並不平均，尤其是高度較高之山區，測站並不如平地般密集，
而山區之降雨一般而言較多且其變異性較大，所以有必要在山區增加雨量測站之設置，
以充分獲得雨量資料。此外，台灣東部地區之測站密度亦過低，建議應再增設測站，以
增加降雨頻率分析之精確度。 
2. 本研究以各雨量測站年最大一日雨量之主成分及測站地文因子為輸入資料，利用SOM網
路進行群集分析，進而探求台灣地區各重現期距下之頻率降雨量。建議未來能再蒐集其
他更多之降雨影響變量，例如：濕度、氣壓、溫度等氣象相關資料，再進行均一性區域
劃分，將更能了解各分區的統計特性與物理意義。 
3. 在未來實際應用時，若該地點沒有設置雨量測站或缺乏降雨紀錄，建議可參考本研究所
國科會補助計畫衍生研發成果推廣資料表
日期:2011/07/20
國科會補助計畫
計畫名稱: 自組織映射圖網路於區域化水文推估模式之研究
計畫主持人: 陳儒賢
計畫編號: 99-2221-E-434-003- 學門領域: 水利工程
無研發成果推廣資料
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
無 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
