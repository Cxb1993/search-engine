 2.2 機械手臂之運動學分析 
機械手通常是由多根連桿所組成的機構，每根
連桿均以滑動或旋轉的模式產生運動行為，一般任務
目標的描述多以卡氏直角座標系統作為之，然而實際
上機械手運動是由樞軸驅使，故控制力矩是產生於樞
軸處。對於處理機械手之樞軸空間系統與目標任務之
卡氏直角座標系統的轉換關係，在運動分析中包含了
順 向 與 逆 向 運 動 學 ， 順 向 運 動 學 ( Forward 
Kinematics )是已給予各軸轉角數據進而求出機械
手手端之位置及方向；而逆向運動學( Inverse 
Kinematics )則是由機械手手端之位置及方向反求
各軸轉角，其關係如圖二所示。 
 
圖二  機械手臂順逆向運動關係 
 
2.3 影像處理 
立體視覺（stereo vision）是電腦視覺的主要
技 術 支 一 。 空 間 中 的  3D 立 體 物 體 以  CCD
（Charge-Coupled Devices）攝影機擷取成 2D平面
影像，可以藉由影像處理方法，成為可用的影像資
訊，進而可以做為特徵萃取（feature extraction）、
辨識（recognition）…等應用。 
雖然影像前處理的技術與方法已趨成熟，電腦
視覺系統若想要自單張平面影像計算出立體物體的
深度資訊仍有困難，人類視覺系統卻可以輕易的感知 
3D 空間物體與環境的關係，其基本差異在於：人類
視覺系統是雙目並用的（binocular），因此建構電
腦立體視覺系統的最基本方法之一，乃模擬人類的視
覺採用二部或多部 CCD 攝影機同步擷取影像，擷取
的成對立體影像（stereo image pair）為同一物體
在不同視角的投影。 
2.3.1 影像校正 
即使是同時間製造的相機，也會有因為在生產
鏡 頭 時 的 些 微 製 造 誤 差 而 產 生 不 同 的 扭 曲
(distortion)，因此需要藉由影像校正來獲得更準確
的資訊。  
使用的影像校正軟體為Bouguet[8]所提供，如
圖三所示，輸入多張格點照片來校正相機，可將相機
輸出校正到無扭曲(undistorted)影像。 
 
圖三 輸入多張格點照片來校正相機 
2.3.2 影像深度 
立體視覺在於如何從一組成對影像中找出立體
物體的特徵，即找出對應點（ corresponding 
points），物體的對應點在成對影像中的位置差稱為
不相稱（disparity），如果攝影機的內部參數均為
已知，則可藉由此不相稱計算出物體的深度。雖然如
此，攝影機的校正問題仍左右深度計算的精確與否，
因為微小的校正誤差可能導致相當大的深度誤差，若
立體物體與攝影機有一段距離時，其誤差更是明顯。
因此，許多研究致力於開發快速攝影機自我校正的演
算法，使系統得以更快計算出精確的物體深度。 
圖4.4為立體幾何模型，w是一個三維空間中的
點， ),( 11 yx 和 ),( 22 yx 分別是點w在二張影像上的投
影，透鏡焦距為f，底線（baseline）寬度為B，我們
定義二個成對影像點 ),( 11 yx 和 ),( 22 yx 的位移為該
點在二張影像上的視差 d ， 21 xxd −= ，根據三角形
相似原理，公式（1）可以算出w的深度Z， 
 fBZ
d
=  (1) 
B
A
A
w
Z
X
Image 1
2
Plane of constant Z
Origin of
world
coordinate
system
Image
(x , y )2
(x , y )1 1
2  
圖四 立體幾何模型[9] 
 
攝影機模型是假設影像平面在x軸與y軸方向的
比例是相當的，但是如果是用數位的CCD攝影機，它
的影像平面上x軸y軸方向的比例就可能不是相當
的，也就是說經由CCD攝影機所得到的影像的每一個
像素可能不是正方形，因此，CCD攝影機的內部校正
矩陣就會變成公式(2) 
 
u 0 X
v = 0 Y
1 0 0 1 Z
x x
y y
f C
f C
⎡ ⎤ ⎡ ⎤ ⎡ ⎤⎢ ⎥ ⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥ ⎢ ⎥⎣ ⎦ ⎣ ⎦ ⎣ ⎦
 (2) 
其中 xf 與 yf 代表攝影機在x軸與y軸方向上單
位為像素的焦距， xC 與 yC 代表攝影機影像中心位
 或其他雜訊干擾所造成的影響，便可以區分出移動以
及未移動的區域，如(8)式所示:   
 1   ( , , ) ( , , 0)( , ,t)
0  
if I u v t I u v
D u v
otherwise
ε⎧= − ≥⎪⎨=⎪⎩
 (8) 
其中，ε 分別代表減少因受到光源微小的變動所
設定之門檻值， ( , ,t)D u v 則為相減所得之二值化影
像，其中，u 與 v 為影像中的座標，t 為當前所擷取
的影像，而 t為零表示在攝影機開始啟動時擷取影像
使其當作背景，如圖八(左)。 
相減所得之影像中，當值為1代表兩張影像中相
對之位置的亮度相差頗大，便將其視之為物體移動所
造成亮度發生變化之區域，若其值為0則代表為背景
部分，如圖八(右)所代表背景相減法處理後的結果。 
 
圖八 (左)背景影像(右)背景相減結果 
 
而在Camshift是基於顏色的追蹤演算法，在目
標物的上方容易受到光源的影響，而導致目標物影像
上半部所獲得的顏色不完全，所以利用背景相減法求
得的結果，來修補球體上方的受光源影響的部分。而
把修補後的結果再次做Camshift處理可以得到目標
物更為正確的位置，如圖十為修補後之結果。 
 
圖十 修補後的結果 
2.3.4 卡爾曼濾波器  
卡爾曼濾波主要是建立在線性代數與隱馬爾可
夫模型(Hidden Markov Model)之上。其基本系統可
以用馬爾可夫鏈表示，該馬爾可夫鏈是被建立在高斯
雜訊干擾的線性算子之上。系統的狀態可以利用一個
為實數的向量表示。隨著離散時間的增加，這個線性
算子就會作用在當前的狀態上，並且產生出新的狀
態，然而這個新狀態也會帶入一些雜訊，並且同時加
入某些已知的控制器之控制訊息。同時，另一個受雜
訊干擾的線性算子產生出這些隱藏狀態的可見輸出。 
為了從一系列有雜訊的觀察數據中，使用卡爾
曼濾波器來預估出被觀察過程的內部狀態，所以我們
必須要把這個過程建立一個模型在卡爾曼濾波器的
框架下。也就是說對於每一步 k，定義矩陣
, , ,k k k kF H Q R ，有時也需要定義 kB 。 
卡爾曼濾波模型假設k時刻的真實狀態是從
(k−1)時刻的狀態計算而來，符合下式： 
 1k k k k k kx F x B u w−= + +  (9) 
其中 
kF  是作用在 1kx − 上的狀態模型。  
kB 是作用在控制器向量 ku 上的輸入，其為控制
模型。  
kw 是過程雜訊，並且假設其符合均值為零，協
方差矩陣為 kQ 的多元的常態分佈。  
 ~ (0, )k kw N Q  (10) 
對於時刻 k ，其真實狀態 kx 的一個測量 kz 滿
足下式： 
 k k k kz H x v= +  (11) 
其中 kH 是觀測模型，它把真實狀態空間反應成
觀測空間， kv 是觀測雜訊，其均值為零，協方差為
kR ，並且符合常態分佈。 
 ~ (0, )k kv N R  (12) 
初 始 狀 態 以 及 每 一 時 刻 的 雜 訊
{ }0 1 1,   , ...  ,   ...  k kx w w v v 都是認為互相獨立的。. 
實際上，真實世界裡很多動態系統都並不確切
的符合這個模型，但因為卡爾曼濾波器是被設計在有
雜訊的狀況之下，所以一個近似且符合已經讓這個濾
波器非常有用了。 
卡爾曼濾波是一種遞回歸的預估，即只要獲知
上一時刻狀態的預估值以及當前狀態的觀測值就可
以計算出當前狀態的預估值，因此不需要記錄觀測或
者過去的預估資訊。卡爾曼濾波器與大多數濾波器不
同之處，是在於它是一種純粹的時域濾波器，並不像
低通濾波器等頻域濾波器那樣，需要在頻域設計再轉
換到時域實現。 
卡爾曼濾波器的狀態由以下兩個變數表示： 
ˆk kx ，在時刻k 的狀態的估計  
kkP ，誤差相關矩陣，計算估計值的精確程度。  
卡爾曼濾波器的公式包括兩個階段：預測與更
新。在預測階段，卡爾曼濾波器利用上一個狀態的預
估，做出當前狀態的預估。在更新階段，卡爾曼濾波
器利用當前狀態的觀測值優化預測現階段獲得的預
測值，以便獲得一個更精確的新預估值。 
預測 
11 1 1ˆ ˆk k kk k k kx F x B u −− − −= + (預測狀態) (13) 
1 11
T
k k k k kk kP F P F Q− −−= + (預測估計協方差)      (14) 
更新 
           
1ˆk k k k ky z H x −= −% (測量餘量)      (15) 
1
T
k k k k kkS H P H R−= − (測量餘量協方差)  (16) 
  
圖十四 實驗架設 
 
本實驗所使用機械手臂為DENSO公司所生產之
VS-6556G工業用六軸機械手臂，如圖十五。 
 
圖十五 DENSO VS-6556G機械手臂 
2.5.2 實驗結果 
圖十六為實驗抓取球的結果，在程式判定機器
手臂不在球上方之時，將持續的追蹤並且接近，如果
程式判定機器手臂接近在球的上方並且誤差值小於
設定值時，再經由賈氏矩陣計算下去夾球的六軸角度
為何，經由所算得的結果控制機械手臂下去夾球再將
球放置旁邊，可供給下次實驗持續放球，此截取樣時
間為每秒2張圖，而圖的排列依序為由左至右、由上
往下。圖十七為機械手臂追蹤球並抓取到旁邊的追蹤
軌跡。 
 
 
圖十六 抓取球的動作 
 
 
圖十七 手臂抓球追蹤軌跡 
 
2.6 結論 
此機器手臂追蹤系統的目標是建立一個利用立
體視覺得之目標物位置，但在影像處理完所獲得的目
標物位置並不是目標物真實的位置，所以利用卡爾曼
濾波器的特性來修正其誤差，使得計算完的位置更能
接近真實目標物的所在位置。控制手臂與影像部分是
分別處理，並且利用多執行緒來將其個別處理，避免
機器手臂必須要等待影像處理完成才開始動作，藉此
方法手臂運動順暢度更為流暢，但此方法必須注意影
像與手臂控制當中的資訊溝通。  
本計畫的系統是建立在二維的座標系統上，所
以二度空間座標上可以用極座標來表示目標物的座
標，對於極座標其半徑為常數，所以目標物移動可以
用角度來表示之，如果未來在抓球的方面想推廣到三
度空間上，必須要把卡爾曼濾波器的方法改為擴展型
卡爾曼濾波器，其中，利用泰勒展開式可以將非線性
的移動轉換成線性，並且再帶入卡爾曼濾波器可預測
三度空間。而且在Camshift追蹤目標物雖然能
有良好的表現，但是在影像裡面如有相同顏
色的物體會產生誤判，並且在追蹤物體消失
或者是追蹤失敗，必須要再利用別種方法來
尋找目標物，未來可以在影像上利用別種演
算法來加強追蹤的強建度。而影像受到光源
影響，導致左右影像所計算的球中心與實際
上有所偏差，使得在立體視覺上的計算會有
所誤差，可用別方法來加強影像辨識的準確
度，改善因辨識所產生的誤差，或者利用影
像追蹤(Image-based tracking)來改善其誤差。  
 
3.子題二：3D物件資料庫建立 
3.1 子題目標 
我們使用David G. Lowe[11]從影像擷取物件
SIFT特徵的方法如下圖十八，並以此特徵來作比對。
任何一個3D物件在空間擺放的角度位置不同，就會有
不同的2D影像，為了使機器人的視覺能夠對任意擺放
物件作辨識，必須擷取物件的各個角度的特徵，並建
立成一資料庫。 
Cameras 
 9. R.C. Gonzalez and R.E. “Woods, Digital Image 
Processing,” Addison Wesley, 1993. 
10. David G. Lowe, “Local feature view clustering for 
3D object recognition”. Proceedings IEEE 
Conference Computer Vision and Pattern 
Recognition, vol. 1, 2001, pp. 682-688.  
11. David G. Lowe, “Distinctive Image Features from 
Sacle-Invariant Keypoints,” International Journal of 
Computer Vision, 2004, vol. 60, no. 2, pp. 91-110.. 
12. Y. Ke and R. Sukthankar, PCA-SIFT: A More 
Distinctive Representation for Local Image 
Descriptors. IEEE Computer Society Conference on 
Computer Vision and Pattern Recognition, pages. 
511-517, 2004. 
 
 
  
出國參訪報告(一) 
 
(ROBIO 2008) 
2008 IEEE International Conference on 
Robotics and Biomimetics 
 
 
 
February 21-26, Bangkok, Thailand 
  
Industrial Robotics ‐ Trends and Opportunities in a Changing World 
 
 
Plenary Talk 3 
Professor Joel W. Burdick   
California Institute of Technology, USA 
 
 
 
 
Robotic Technology for Damaged Nervous System   
 
 
我參加會議的 Presentation 安排在周二的 session ROBOT Vision III session 上簡報。
本人也兼任該 session 的 chairman。簡報題目是 Object Orientation Recognition Based 
on SIFT and SVM by Using Stereo Camera System，係由本人和碩士班研究生 Setiawan 
Edwin 共同撰寫。參加本會議收穫很多。 
 
 
 
 
 
 5月21日至5月31日期間出訪英國，參訪的對象包含倫敦市內的Shadow公司和Plymouth市的
Plymouth University。 
 
位於倫敦的Shadow Robot公司為一家世界頂尖的機器手臂設計公司，他們已製作出具備26個
自由度高靈敏度機器手(如下左圖)，其複雜度和靈活度居世界領先地位。本人為發展未來全自主
機器人和機器手臂，特地前往洽商共同合作事宜。5月22日即前往洽談，跟公司主管相談甚歡(如
下右圖)。因該公司技術主管當日不在，又另約5月30日再來拜會。5月30日當天第二次拜會時，
該公司所有主管皆慎重地一起洽談合作事宜，他們特地展出最新的馬達驅動機器手臂(如下下左
圖)。會中達成協議，未來進行長期合作。 
 
 
 
 
參訪Plymouth大學Angelo Cangelosi教授和該校的機器人研究團隊的目的是企圖建立歐盟
FP-7大型研究案的加盟關係。Angelo Cangelosi教授的專長是Cognition，為先進國家極為重
視的一支機器人學習技術，該技術被視為機器人終極成為具備接近人類般智慧型為能力的重要關
鍵。該實驗室使用icub機器人進行學習實驗(下左)。5月27日在該校進行一場專題演講(下右)，並
參觀多間實驗室，也學習到不少新知。5月28日則進行技術合作的討論，最後達成加盟該歐盟團
隊的協議和工作方案。下下左圖為達成研究合作後一起和Angelo Cangelosi教授外出慶祝的畫
面。後來本人於正式成為一項9月15日開始執行的歐盟FP-7 PEOPLE計畫案的成員。本案也是台
灣第一次加入歐盟FP-7 PEOPLE 計畫案的案例。 
