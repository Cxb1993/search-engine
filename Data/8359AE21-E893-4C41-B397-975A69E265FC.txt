I 
 
行政院國家科學委員會專題研究計畫成果報告 
綠色產品生命週期管控之知識服務系統 
子計畫 8: 綠產品知識服務平台下結構化資訊檢索 
與推薦機制之建構 (3/3) 
計 畫 編 號：NSC 97-2221-E007-095-MY3 (3/3) 
          執 行 期 限：99 年 08 月 01日至 100年 7月 31日 
          主 持 人：王小璠   國立清華大學工業工程與工程管理系 
          計畫參與人員：徐昕煒、鄒永珊、黃衍善、李怡誼 
                        國立清華大學工業工程與工程管理系 
 
一、 中文摘要 
 
近年來地球的生態環境面臨很大的危機，產品的環保性設計、綠色設計已引起國際上廣泛的
重視。各國政府均根據歐盟訂定之環保指令規範 WEEE「廢棄電器電子設備指令」、RoHS「有
害物質管制法令」、EuP「能源使用產品對環境友善設計指令」等等，透過立法及公約，積極
推展綠色產品的實現。而先進國家為因應環保與能源議題，針對電子產品頻頻加強法令管制，
儼然新的「非關稅壁壘」。對以電子產業為主要外銷歐洲的我國誠然造成相當的威脅。 
    由於國內多為中小企業，綠色產品的生產除需上下游廠商之整合、更需有市場需求的足
夠誘因。因此如何有效管理相關資訊以提供消費者正確的綠產品知識，並就消費者之需要推
薦適合的產品是本子計畫的目的。 
    因此繼第一年的系統設計與分析，及第二年完成的分析模式及推薦策略之建立，本年已
如預期完成系統建置及電腦網路推薦之實例應用與評估。 
 
關鍵詞：推薦系統建置、實例應用與評估 
3 
 
1. Introduction 
With the rapid increase in the amount of information on the World Wide Web, Electronic Commerce 
(EC) has been the mainstream channel for modern markets. There is a high demand for web-based 
suppliers to locate their users‟ requirements efficiently and effectively because the amount of 
available web contents increases enormously. Recommender systems (RSs), which are a kind of EC 
functions, have been widely applied by EC companies to determine the preferences of online users 
and to aid the promotion of products (Schafer et al. 1999). Among the recommendation techniques 
used in RSs, collaborative filtering (CF) (Breese et al. 1998) is the most popular approach due to its 
ease of accommodation to various types of input data such as text and multimedia. Moreover, it is 
flexible in integrating with other recommendation mechanisms (Hanani et al. 2001, Karypis 2001, 
Kohrs and Meriadlo 2001, Schafer et al. 2001, Linden et al. 2003, Kim et al. 2006). 
In an RS, the user who receives a recommendation is called an active user. Generally, a 
recommendation scheme of CF mainly makes use of the information collected from “neighbors,” 
who are defined as users with behavior similar to that of the active user. There are two kinds of 
input data: the user‟s ratings (Schafer et al. 1999) and the market basket data (Mild and Reutterer 
2001, 2003). These two kinds of data are often stored as a user-item matrix, whose rows and 
columns correspond to the users and items, respectively. The ratings are the scores a user gives to 
the items. Market basket data contain the purchase history of users and sometimes their 
demographic features. Each item presented in a user‟s row can either be “1” or “0” to denote 
whether an item has been purchased or not, respectively. 
The drawback of CF is that no recommendation can be made if the historical data of users are 
sparse. This is known as the sparsity problem (Linden et al. 2003). This common issue of the sparse 
user-item matrix in CF results from a recommendation usually based on a highly dimensional 
database with relatively fewer transactions. The similarity between two users is not measurable if 
they have no record of common products purchased from thousands of items (Billsus and Pazzani 
1998, Papagelis et al. 2005). In particular, CF is also confronted with the cold-start problem (Sarwar 
et al. 2000, Schein et al. 2002, Deshpande and Karypis 2004), which is very similar to the sparsity 
problem. The CF‟s recommendation encounters the cold-start problem, where the neighbors of an 
active user are hard to identify, whereas the existing information of users is insufficient or 
incomplete. This problem is often referred to as the circumstance where in a start-up company, 
some profiles of the existing and active user are lacking. When this phenomenon is explained from 
the perspective of a user-item matrix, the matrix will be sparse with missing values. Therefore, in a 
CF-based RS, the problem of identifying the neighborhood of a cold-start user from the sparse 
user-item matrix becomes severe and needs to be solved. 
To cope with the sparse problem in a CF-based RS, this study proposes a method called the 
expectation-robust principle component analysis (E-RPCA) by combining the features of the 
expectation maximization (EM) (Dempster et al. 1977) with ROBPCA (Hubert et al. 2005), which 
is one of the robust principal component analysis (Robust PCA) techniques. Therefore, the 
proposed E-RPCA is expected to deal with the sparse user-item matrix problem that a CF-based RS 
would encounter. Aside from the regular user-item matrices with rating data, this study particularly 
5 
 
cold-start situation. However, tag systems are difficult in general applications because each element 
in an RS needs to be sufficiently tagged. Wang and Wu (2010) developed a recommendation 
module that proposes the clique-effect collaborative filtering (CECF). CECF is a method that aims 
to solve the cold-start and the sparsity problem by first classifying users or items into cliques and 
then exploiting the effects derived from the cliques. The in-clique and out-clique effects are linearly 
weighted to predict the active users‟ purchase behavior. CECF has been shown to outperform CF 
and provide a good solution to the cold-start problem. However, if the database could only be 
divided into fewer cliques, then the clique effects would not be sufficient to enhance the quality of 
the recommendation. 
 
2.1.2. Feature Analysis: PCA 
PCA is an effective approach to identify the features of the data. The main goals of PCA are as 
follows: 1) to extract and explain the most important information, 2) to reduce the dimension, and 3) 
to analyze the structure of a data set. These goals can be achieved by finding a set of the so-called 
principal components (PCs). The PCs are mutually orthogonal, and they are a linear combination of 
the original data variables (Grung and Manne 1998). In other words, the PCA is able to identify the 
most meaningful basis to reconstruct a data set (Shlens 2009). 
Let 
n mX  be the original data set, where n is the number of samples, i.e., observations, and m is the 
number of measurement types, i.e., variables and attributes. The columns of 
n mX  are centered so 
that the mean of each column is equal to 0. The (1 ) Tn X X  is denoted as a square m × m 
variance-covariance matrix with associated eigenvectors {a1, a2, ..., am}. An orthogonal matrix P is 
defined as P = [a1 a2 ... am], where the ith column is the eigenvector ai. n mX  
can be decomposed 
as T
n m n m m m  X = Y P , where n mY  is an orthogonal matrix that is a reconstructed matrix of n mX . 
These eigenvectors are the so-called PCs. The orthogonal PCs are derived to maximize the data 
variance. The portion of the data variability a PC can explain corresponds to its eigenvalues 
(Johnson and Wichern 2002). For highly dimensional data ( n m ), PCA can be used for data 
compression or dimension reduction by reconstructing the data set 
n mX  with the first k PCs 
(Jolliffe 2002). In general, PCA constructs a new set of k mvariables called loadings. These 
loading vectors, i.e., {a1, a2, ..., ak} span a k-dimensional subspace. PCA is then employed to 
reconstruct n mX by n kT , where n k n m m k  T X P . The dimensions are reduced from m to k. In 
particular, n kT  and m kP  are orthogonal matrices. n kT  is called the score matrix containing k 
loadings, and m kP  is called the loading matrix.  
Applying PCA to solve the sparsity problem in the RSs, Goldberg et al. (2001) proposed Eigentaste 
to facilitate dimension reduction. This allows the users‟ profiles, which are formed by rating a gauge 
set, are projected into an eigen plane at the offline stage. The gauge set is defined as a set of items 
commonly rated by all valid users. Consequently, at the online stage, the active user is asked to rate 
the gauge set to receive recommendations. However, the gauge set proposed in the Eigentaste could 
contain items that the cold-start user never knows. Aside from this, the size of the designated item 
set should also be carefully controlled because impatient users might be driven out of the system.  
7 
 
by the mean of a column or a row is known to have the risk of distorting the covariance structure of 
the data (Adams et al. 2002). Moreover, Bell et al. (2007) also argued that the methods using 
replaced ratings could significantly outnumber the original ratings due to the inaccurate replacement. 
In addition to the EM-PCA approaches, Julià et al. (2009) proposed an adapted factorization 
technique based on the alternation algorithm to predict the missing ratings in the user-item matrix. 
Compared with the EM-PCA approach, this method can directly deal with missing elements without 
any replacement and with smaller computational cost. However, an unstable recommendation 
quality could be its disadvantage. 
 
2.3. Prediction of Missing Values by Robust PCA 
EM-PCA indicates that in the iterative process, replacing missing elements by some means is risky 
because of the distortion of the data structure (Adams et al. 2002). The risk of inaccurate 
replacements mainly comes from outliers. In the data analysis, the existence of outliers in a sparse 
data set may lead to poor interpretation of the resultant estimates. Therefore, the presence of outliers 
affects the correct replacement of missing elements. Moreover, the presence of missing elements 
makes identifying the outliers difficult (Chen 2002). Robust versions of PCA have been proposed to 
construct a PCA model that is not influenced by outlying objects (Chen 2002, Stanimirova et al. 
2007, Serneels and Verdonck 2008). Many robust estimators other than the statistical mean have 
been devised (Little 1988, Rousseeuw and Van Driessen 1999, Hubert et al. 2005). To implement 
Robust PCA, Verboven and Hubert provided a toolbox in MATLAB and LIBRA, which can be 
downloaded from one of the following Web sites: http://www.wis.kuleuven.ac.be/stat/robust.html or 
http://www.agoras.ua.ac.be (Verboven and Hubert 2005). LIBRA mainly contains two Robust PCA 
methods: RAPCA and ROBPCA (Hubert et al. 2005). ROBPCA, which is based on projection 
pursuit ideas (Huber 1985) with a minimum covariance determinant estimator (Rousseeuw and Van 
Driessen 1999), has shown to outperform RAPCA in many situations; thus, ROBPCA will be 
adopted into the analysis. 
ROBPCA provides a diagnostic plot where the outliers can be identified. The diagnostic plot 
displays the data by plotting their orthogonal distance (OD) versus their score distance (SD). In 
general, two types of outlying data will affect the PCA: bad PCA-leverage data characterized by 
large OD and SD, and orthogonal outliers characterized by large OD and small SD (Stanimirova et 
al. 2007).  
When ROBPCA is performed on the data matrix n mX , a robust score matrix 
ˆ
n kT  and a robust 
loading matrix ˆm kP are generated. 
ˆ
n mX can then be predicted through
ˆ ˆ ˆ T
n m n k k m  X T P . This 
procedure, which is the same as that in the M-step in EM-PCA, is called R-step because it is derived 
from a robust version (Serneels and Verdonck 2008).  
 
2.4. Summary 
A CF-based RS, which is based on dimension reduction techniques such as grouping of individuals, 
9 
 
3.1.1. Initialization of (0)C , M:
 
Transformation of Basket Data into Compositional Data 
The compositional data composed of n observations are measured in m variables, i.e., 
1 2( , ,..., ), 1,2,...i i i imx x x x i n  . Each element of xi is a value proportional to the number of 
appearance in each variable. That is, such representation refers 
ijx  to the probability of user i 
having purchased item j. The elements of xi are constrained to the sum of the unity: 
1
1,
m
ijj
x i

  . 
Aitchison (1983) pointed out that this constraint introduces a bias of negative correlations to the 
variables. Thus, the log transformation of the data should be conducted. However, Aitchison‟s 
approach cannot handle zeros in the elements. Bacon-Shone (1992) proposed another approach to 
the compositional data based on ranks, allowing zeros to be present. However, Baxter (1993) 
showed that both approaches can be misleading when there are small but non-zero elements in the 
data set. Thus, performing PCA on the compositional data without modifications to retain its 
original information was recommended. 
As a result, the following procedure is proposed to transform basket data in a user-item matrix into 
compositional data. The variables n and m ( n m ) denote the number of users and items, 
respectively, in each user-group. Assume X to be an n m  matrix, where the missing elements are 
given with zero values. Then, 
,i jX  
is a missing element if 
, 0i j X . Let M be the set of positions 
of missing elements in X , which is defined by M = {(i,  j): 
,i jX is observed as a missing element}. 
Let (0)C  be a user-item matrix, where each row consists of the compositional data. To obtain (0)C  
as an input to the E-RPCA at the next stage,
 
three steps are proposed to be conducted:  
Step 1: Each entry of X is divided by the sum of the corresponding row.
 
Step 2: The value of 
,i jX , , , ( , )i j i j M   is replaced by the average of the mean of the j 
column and i row of X . 
 
Step 3: Redo Step 1 once to obtain (0)C . 
 
 
3.1.2. Prediction of Missing Elements by E-RPCA 
To cope with the missing elements, ROBPCA is adopted. The method is as follows. Recall that 
(0)
C represents the n m  user-item matrix, where each row consists of the compositional data. 
ROBPCA is applied to determine a robust center matrix ˆ n mμ  and a loading matrix 
ˆ
m kP . The 
score matrix ˆn kT  represents the coordinates of the centered  data of users according to the k 
loadings of 
(0)ˆ ˆˆ( )n k n m m k   T C μ P , where the robust loadings are computed using the techniques 
of projection pursuit (Huber 1985) and the minimum covariance determinant estimator (Rousseeuw 
and Van Driessen 1999).  
11 
 
( )t
C is further normalized as in C,
 
whose row vectors are compositional data. C is predicted and 
represented as the final user-item matrix, where 
,i jC  is the probability of user i having purchased 
item j. 
 
3.1.3. Top-N Transformation 
After achieving the two stages above, the binary user-item matrix X  of each user-group is 
transformed into the user-item matrix C, where 
,i jC  is the probability for the user i to purchase 
item j. To complete the prediction task for recommendation purposes, these real-numbered matrices 
are required to be converted by matrices with the basket data.  
In this study, the real-numbered matrices are converted into binary matrices according to the size of 
the recommended items. If the size of the recommended items is determined as N, the top-N values 
for each row vector of C are converted into 1 and others into 0.  
 
3.2. Recommendation Task 
 In the recommendation task, a traditional CF or any other CF-based methods can be used. In 
this study, CECF proposed by Wang and Wu (2010) is employed as illustrated below. With the 
active user denoted as a, the predicted item as j, the active user‟s group as Ut and other user-groups 
as Ug, 1,2,..., ,g G g t  . The relations between Ug and j are regarded as out-of-clique effects of 
the purchase probability measured for a. Users in the same clique with a (the so-called neighbors) 
can provide collaborative information to measure the purchase probability. The users in different 
cliques also provide collaborative information to a to a certain degree. In this respect, CECF 
suggests measuring the purchase probability of a with respect to j as in Eq. (4): 
 in-clique  out-of-clique
, , ,(1 )a j a j a jP P P         (4), 
where the probability (
,a jP ) is a convex combination of two distinct probabilities: one is the 
purchase probability (  in-clique
,a jP ) predicted by the collaboration of users in Ut (the neighbors), and the 
other (  out-of-clique
,a jP ) is predicted by the collaboration of users in Ug, 1,2,..., ,g G g t  ;   can be 
noted as the priority ranking on the effects from other user groups. The common concept of the 
CF-based methods with an adaptation to the binary basket data (Breese et al. 1998; Mild and 
Reutterer 2001, 2003) is presented as in Eq. (5):  
 in-clique
, 1 ( , ) ( , )
t
a j
U
P sim a neighbor C neighbor j    (5), 
where 
1  is a normalizing factor. The notation, ( , )sim a neighbor , is the similarity between a and 
his/her neighbor, whereas ( , )C neighbor j is the binary choice whether the neighbor purchases j
 
or 
13 
 
E-RPCA and the transformation procedure on the basket data. 
 
4.1. The Experiment on Rating Data: MovieLens Data set 
 The MovieLens datasets were collected by the GroupLens Research Project 
(http://www.grouplens.org/) and have contributed much to the research on RSs (Billsus and Pazzani 
1998, Sarwar et al. 2000, Kim and Yum 2005, Julià et al. 2009). One of the data sets consists of 
100,000 ratings (scaled discretely from 1 to 5) from 943 users on 1682 movies. The entire data set 
has already been split into 5 pairs of training and test sets, namely, u1–u5.base and u1–u5.test. Each 
base/test set consists of exactly 80,000/20,000 ratings. For each base/test set, the percentage of the 
missing data is around 94.96% or 98.74%. 
To study the recommendation accuracy of E-RPCA as well as the SVD-based approach proposed by 
Sarwar et al., their abilities to retrieve each user‟s preference on items are considered. Items with 
higher ratings should be recommended with higher probabilities. In the experiment, some data were 
randomly removed from each base/test set, thus increasing the percentage of missing data to 99.1% 
or 99.5%. The removed data were exploited to study the restored values as the test sets. Therefore, 5 
data sets with 99.1% missing data and 5 data sets with 99.5% missing data were used as the training 
sets in the experiment. The E-RPCA was also fixed to perform once in the experiment for 
benchmarking because the SVD-based approach is not an iterative procedure. 
To compare the recommendation accuracy of E-RPCA with the SVD-based approach, three 
responses of recall, precision, and F1 were used to measure the recommendation performance under 
different factors. The experiment was conducted using the following four factors (i.e., missing, 
method, N, and PCs) for factorial analysis: 
Data sets with two percentages of missing data (missing, 2 levels): 99% and 99.5% 
Methods to retrieve the missing values (method, 2 levels): E-RPCA and SVD 
Size of the recommended items (N, 19 levels): N ranged from 2–20 
Number of PCs/ rank values (PCs, 19 levels): PCs ranged from 2–20 
 
4.1.1. Factorial Analysis 
In the factorial analysis, the effects of the three-factor and four-factor interaction were ignored as 
most studies suggest. The analysis of variance table for recommendation performance is shown in 
Table 2. In Table 2, evidently, each factor considered in the experiment significantly influences the 
recommendation performances. The recommendation performances of E-RPCA and the SVD-based 
approach according to the number of PCs /rank values are shown in Fig. 3. Fig. 3 also shows that 
the performances of E-RPCA dominate those of the SVD-based approach when any number of 
PCs/rank value is taken. Moreover, the larger the number of PCs/rank value chosen, the lower the 
performance will be. The performances according to the two kinds of data sets and N are shown in 
Fig. 4. As observed on the right side of Fig. 4, E-RPCA dominates the SVD-based approach when 
considering the different sizes of the recommended items. The left side of Fig. 4 shows either 
approach performs better in the data sets with higher percentage of missing values. Note that the 
E-RPCA is slightly inferior to the SVD-based approach when only the mean of the recall in the data 
15 
 
considered in the RS significantly influences the recommendation performance. The 
recommendation performance, according to each level of each factor, was further compared as 
shown in Fig. 5. The following are observed from Fig. 5: 
The larger the value of N chosen, the higher the performances will be. 
E-RPCA performs well in terms of recall but poorly in terms of precision. In the leverage 
performance of F1, E-RPCA still performs better than No-ME. 
The performances of the three measures all reach the best when   is equal to 0.1.Then, it 
decreases as increases from 0.1 to 1. 
(Table 3. Analysis of Variance from the Case Study)  
(Fig. 5. Comparison of Performances via each Factor from the Case Study) 
Fig. 6 shows the respective effects while applying the E-RPCA into a sparse matrix or not. In Fig. 6, 
where y-axis represents the performance measure, for the measures of recall and F1, the E-RPCA 
overwhelms the No-ME. However, for the measure of precision, E-RPCA leads only 
when {0,0.1,0.2}  . 
(Fig. 6. Performances of E-RPCA with respect to and N) 
 
4.2.3. Discussion 
 In this case study, E-RPCA showed its effectiveness in enhancing the recommendation 
performance. Although it caused poor results in precision when some augments were taken, it led to 
good performances of recall as well as F1. Better performance of F1 is more important because it is 
more effective and significant. In this sparse data set, CECF did conflict with E-RPCA. This fact 
resulted in the decline of the performance measures. This could be attributed to the existence of 
only a few groups, i.e., three groups in this data set. The clique effects did not help in compensating 
for the insufficient information caused by the nature of a sparse matrix. Therefore, in a kind of data 
set with fewer user groups, using the E-RPCA and CECF with lower values of ranging from 0–0.2 
is suggested. 
 
5. Conclusions 
Among the studies of CF-based approaches, the problem of the sparse user-item matrix is critical 
because it occurs often and affects the recommendation performance significantly. In the 
approaches proposed for the sparse problem in CF-based RSs, two directions are usually considered: 
one is to exploit the dimension reduction techniques and the other is to complete the data matrix by 
the prediction of the missing elements. The two directions are known to have respective 
disadvantages. As a result, E-RPCA is presented to enhance the quality of the information that can 
be obtained from the sparse data set. By filling in the missing elements of the user-item matrix 
whose entries are market basket data, the hidden information can be retrieved, and the 
recommendation performance can be improved. 
The proposed E-RPCA can be applied to the sparse matrix containing basket data, rating data, or 
real numbers. In this study, E-RPCA was applied to basket data because this kind of matrix is often 
too sparse to be used, and the enhancement of performance could be more significant.  
17 
 
Jolliffe, I. T. Principal Component Analysis, 2nd edition. Springer Series in Statistics, New York, 
NY, 2002. 
Julià, C., Sappa, A. D., Lumbreras, F., Serrat, J., and López, A. Predicting missing ratings in 
recommender systems: adapted factorization approach. International Journal of Electronic 
Commerce, 14, 2, 2009, 89–108. 
Karypis, G. Evaluation of item-based Top-N recommendation algorithms. In Proceedings of the 
10th international Conference on Information and Knowledge Management, Atlanda, Georgia, 
USA, 2001, 247–254. 
Kim, B. M., Li, Q., Park, C. S., Kim, S. G., and Kim, J. Y. A new approach for combining 
content-based and collaborative filters. Journal of Intelligent Information System, 27, 1, 2006, 
79–91. 
Kim, D., and Yum, B. J. Collaborative filtering based on iterative principal component analysis. 
Expert Systems with Applications, 28, 4, 2005, 823–830. 
Kim, H. T., Ji, A. T., Kim, Ha. I., and Jo, G. S. Collaborative filtering based on collaborative tagging 
for enhancing the quality of recommendation. Electronic Commerce Research and Applications, 9, 
1, 2010, 73–83. 
Kohrs A., and Meriadlo, B. Creating user adapted websites by the use of collaborative filtering. 
Interacting with Computers, 13, 6, 2001, 695–716. 
Linden G., Smith B., and York J. Amazon.com recommendations: item-to-item collaborative 
filtering. IEEE Internet Computing, 7, 1, 2003, 76–80. 
Little, R. J. A. Robust estimation of the mean and covariance matrix from data with missing values. 
Applied Statistics, 37, 1, 1988, 23–38. 
Mild, A., and Reutterer, T. An improved collaborative filtering approach for predicting 
cross-category purchases based on binary market basket data. Journal of Retailing and Consumer 
Services, 10, 3, 2003, 123–133. 
Mild, A., and Reutterer, T. Collaborative filtering methods for binary market basket data analysis. 
Lecture Notes in Computer Science, 2252, 2001, 302–313. 
Papagelis, M., Plexousakis, D. and Kutsuras, T. Alleviation the sparsity problem of collaborative 
filtering using trust inferences. In Proceedings of the 3rd International Conference on Trust 
Management, Paris, France, 2005, 224–239. 
Rousseeuw, P. J., and Van Driessen, K. A fast algorithm for the minimum covariance determinant 
estimator. Technometrics, 41, 3, 1999, 212–223. 
Sarwar, B. M., Karypis, G., Konstan, J. A., and Riedl, J. T. Application of dimensionality reduction 
in recommender system – a case study. In Proceedings of ACM WEBKDD Workshop, Boston, MA, 
USA, 2000. 
Schafer, J. B., Konstan, J. A., and Riedl, J. T. Recommender systems in E-commerce. In 
Proceedings of the 1st ACM Conference on Electronic Commerce, Denver, Colorado, USA, 1999, 
158–166. 
Schafer, J. B., Konstan, J. A., and Riedl, J. T. E-commerce recommendation applications. Data 
Mining and Knowledge Discovery, 5, 1–2, 2001, 115–153.  
19 
 
1 2 3 4 5 6 7 8 9 10
0.05
0.1
0.15
0.2
0.25
Index
E
ig
e
n
v
a
lu
e
ROBPCA
 
Fig. 1. Screen plot with Optimal Value of k = 2 
 
 
0 100 200 300 400 500 600
0
1
2
3
4
5
6
Score distance (3 LV)
O
rt
h
o
g
o
n
a
l 
d
is
ta
n
c
e
 26  60
 76
  3
 87
134
ROBPCA
 
Fig. 2. Example of the Score Outlier map 
 
21 
 
SVDROBPCA
0.66
0.65
0.64
0.63
0.62
0.61
0.60
0.59
0.58
0.57
SVDROBPCA
0.525
0.500
0.475
0.450
0.425
0.400
0.375
0.350
SVDROBPCA
0.56
0.54
0.52
0.50
0.48
0.46
0.44
0.42
0.40
N
201918171615141312111098765432
0.75
0.70
0.65
0.60
0.55
0.50
0.45
0.40
N
201918171615141312111098765432
0.6
0.5
0.4
0.3
0.2
N
201918171615141312111098765432
0.6
0.5
0.4
0.3
0.2
99% data sets
99.5% data sets
E-RPCA
SVD
E-R CA S
E-R CA S
E-R CA S
Mean of Recall
Mean of Precision
Mean of F1
Mean of Recall
Mean of Precision
Mean of F1
 
Fig. 4. Performances according to the two kinds of data sets (left) and N (right) 
 
23 
 
CECF (  0 means the traditional CF) Size of recommended items, N
1.00.90.80.70.60.50.40.30.20.10.0
0.25
0.20
0.15
0.10
0.05
y-axis: Mean of Recall             x-axis: 
1.00.90.80.70.60.50.40.30.20.10.0
0.25
0.20
0.15
0.10
0.05
y-axis: Mean of Precision           x-axis: 
1.00.90.80.70.60.50.40.30.20.10.0
0.25
0.20
0.15
0.10
0.05
y-axis: Mean of F1                    x-axis: 
15141312111098765432
0.25
0.20
0.15
0.10
0.05
y-axis: Mean of Recall             x-axis: N
15141312111098765432
0.40
0.35
0.30
0.25
0.20
0.15
0.10
y-axis: Mean of Precision        x-axis: N
15141312111098765432
0.25
0.20
0.15
0.10
0.05
y-axis: Mean of F1                      x-axis: N
E-RPCA No-ME
 
Fig. 6. Performances of E-RPCA with respect to and N 
 
I 
 
行政院國家科學委員會專題研究計畫成果報告 
綠色產品生命週期管控之知識服務系統 
子計畫 8: 綠產品知識服務平台下結構化資訊檢索 
與推薦機制之建構 (3/3) 
計 畫 編 號：NSC 97-2221-E007-095-MY3 (3/3) 
          執 行 期 限：99 年 08 月 01日至 100年 7月 31日 
          主 持 人：王小璠   國立清華大學工業工程與工程管理系 
          計畫參與人員：徐昕煒、鄒永珊、黃衍善、李怡誼 
                        國立清華大學工業工程與工程管理系 
 
二、 中文摘要 
 
近年來地球的生態環境面臨很大的危機，產品的環保性設計、綠色設計已引起國際上廣泛的
重視。各國政府均根據歐盟訂定之環保指令規範 WEEE「廢棄電器電子設備指令」、RoHS「有
害物質管制法令」、EuP「能源使用產品對環境友善設計指令」等等，透過立法及公約，積極
推展綠色產品的實現。而先進國家為因應環保與能源議題，針對電子產品頻頻加強法令管制，
儼然新的「非關稅壁壘」。對以電子產業為主要外銷歐洲的我國誠然造成相當的威脅。 
    由於國內多為中小企業，綠色產品的生產除需上下游廠商之整合、更需有市場需求的足
夠誘因。因此如何有效管理相關資訊以提供消費者正確的綠產品知識，並就消費者之需要推
薦適合的產品是本子計畫的目的。 
    因此繼第一年的系統設計與分析，及第二年完成的分析模式及推薦策略之建立，本年已
如預期完成系統建置及電腦網路推薦之實例應用與評估。 
 
關鍵詞：推薦系統建置、實例應用與評估 
3 
 
2. Introduction 
With the rapid increase in the amount of information on the World Wide Web, Electronic Commerce 
(EC) has been the mainstream channel for modern markets. There is a high demand for web-based 
suppliers to locate their users‟ requirements efficiently and effectively because the amount of 
available web contents increases enormously. Recommender systems (RSs), which are a kind of EC 
functions, have been widely applied by EC companies to determine the preferences of online users 
and to aid the promotion of products (Schafer et al. 1999). Among the recommendation techniques 
used in RSs, collaborative filtering (CF) (Breese et al. 1998) is the most popular approach due to its 
ease of accommodation to various types of input data such as text and multimedia. Moreover, it is 
flexible in integrating with other recommendation mechanisms (Hanani et al. 2001, Karypis 2001, 
Kohrs and Meriadlo 2001, Schafer et al. 2001, Linden et al. 2003, Kim et al. 2006). 
In an RS, the user who receives a recommendation is called an active user. Generally, a 
recommendation scheme of CF mainly makes use of the information collected from “neighbors,” 
who are defined as users with behavior similar to that of the active user. There are two kinds of 
input data: the user‟s ratings (Schafer et al. 1999) and the market basket data (Mild and Reutterer 
2001, 2003). These two kinds of data are often stored as a user-item matrix, whose rows and 
columns correspond to the users and items, respectively. The ratings are the scores a user gives to 
the items. Market basket data contain the purchase history of users and sometimes their 
demographic features. Each item presented in a user‟s row can either be “1” or “0” to denote 
whether an item has been purchased or not, respectively. 
The drawback of CF is that no recommendation can be made if the historical data of users are 
sparse. This is known as the sparsity problem (Linden et al. 2003). This common issue of the sparse 
user-item matrix in CF results from a recommendation usually based on a highly dimensional 
database with relatively fewer transactions. The similarity between two users is not measurable if 
they have no record of common products purchased from thousands of items (Billsus and Pazzani 
1998, Papagelis et al. 2005). In particular, CF is also confronted with the cold-start problem (Sarwar 
et al. 2000, Schein et al. 2002, Deshpande and Karypis 2004), which is very similar to the sparsity 
problem. The CF‟s recommendation encounters the cold-start problem, where the neighbors of an 
active user are hard to identify, whereas the existing information of users is insufficient or 
incomplete. This problem is often referred to as the circumstance where in a start-up company, 
some profiles of the existing and active user are lacking. When this phenomenon is explained from 
the perspective of a user-item matrix, the matrix will be sparse with missing values. Therefore, in a 
CF-based RS, the problem of identifying the neighborhood of a cold-start user from the sparse 
user-item matrix becomes severe and needs to be solved. 
To cope with the sparse problem in a CF-based RS, this study proposes a method called the 
expectation-robust principle component analysis (E-RPCA) by combining the features of the 
expectation maximization (EM) (Dempster et al. 1977) with ROBPCA (Hubert et al. 2005), which 
is one of the robust principal component analysis (Robust PCA) techniques. Therefore, the 
proposed E-RPCA is expected to deal with the sparse user-item matrix problem that a CF-based RS 
would encounter. Aside from the regular user-item matrices with rating data, this study particularly 
5 
 
cold-start situation. However, tag systems are difficult in general applications because each element 
in an RS needs to be sufficiently tagged. Wang and Wu (2010) developed a recommendation 
module that proposes the clique-effect collaborative filtering (CECF). CECF is a method that aims 
to solve the cold-start and the sparsity problem by first classifying users or items into cliques and 
then exploiting the effects derived from the cliques. The in-clique and out-clique effects are linearly 
weighted to predict the active users‟ purchase behavior. CECF has been shown to outperform CF 
and provide a good solution to the cold-start problem. However, if the database could only be 
divided into fewer cliques, then the clique effects would not be sufficient to enhance the quality of 
the recommendation. 
 
2.1.2. Feature Analysis: PCA 
PCA is an effective approach to identify the features of the data. The main goals of PCA are as 
follows: 1) to extract and explain the most important information, 2) to reduce the dimension, and 3) 
to analyze the structure of a data set. These goals can be achieved by finding a set of the so-called 
principal components (PCs). The PCs are mutually orthogonal, and they are a linear combination of 
the original data variables (Grung and Manne 1998). In other words, the PCA is able to identify the 
most meaningful basis to reconstruct a data set (Shlens 2009). 
Let 
n mX  be the original data set, where n is the number of samples, i.e., observations, and m is the 
number of measurement types, i.e., variables and attributes. The columns of 
n mX  are centered so 
that the mean of each column is equal to 0. The (1 ) Tn X X  is denoted as a square m × m 
variance-covariance matrix with associated eigenvectors {a1, a2, ..., am}. An orthogonal matrix P is 
defined as P = [a1 a2 ... am], where the ith column is the eigenvector ai. n mX  
can be decomposed 
as T
n m n m m m  X = Y P , where n mY  is an orthogonal matrix that is a reconstructed matrix of n mX . 
These eigenvectors are the so-called PCs. The orthogonal PCs are derived to maximize the data 
variance. The portion of the data variability a PC can explain corresponds to its eigenvalues 
(Johnson and Wichern 2002). For highly dimensional data ( n m ), PCA can be used for data 
compression or dimension reduction by reconstructing the data set 
n mX  with the first k PCs 
(Jolliffe 2002). In general, PCA constructs a new set of k mvariables called loadings. These 
loading vectors, i.e., {a1, a2, ..., ak} span a k-dimensional subspace. PCA is then employed to 
reconstruct n mX by n kT , where n k n m m k  T X P . The dimensions are reduced from m to k. In 
particular, n kT  and m kP  are orthogonal matrices. n kT  is called the score matrix containing k 
loadings, and m kP  is called the loading matrix.  
Applying PCA to solve the sparsity problem in the RSs, Goldberg et al. (2001) proposed Eigentaste 
to facilitate dimension reduction. This allows the users‟ profiles, which are formed by rating a gauge 
set, are projected into an eigen plane at the offline stage. The gauge set is defined as a set of items 
commonly rated by all valid users. Consequently, at the online stage, the active user is asked to rate 
the gauge set to receive recommendations. However, the gauge set proposed in the Eigentaste could 
contain items that the cold-start user never knows. Aside from this, the size of the designated item 
set should also be carefully controlled because impatient users might be driven out of the system.  
7 
 
by the mean of a column or a row is known to have the risk of distorting the covariance structure of 
the data (Adams et al. 2002). Moreover, Bell et al. (2007) also argued that the methods using 
replaced ratings could significantly outnumber the original ratings due to the inaccurate replacement. 
In addition to the EM-PCA approaches, Julià et al. (2009) proposed an adapted factorization 
technique based on the alternation algorithm to predict the missing ratings in the user-item matrix. 
Compared with the EM-PCA approach, this method can directly deal with missing elements without 
any replacement and with smaller computational cost. However, an unstable recommendation 
quality could be its disadvantage. 
 
2.3. Prediction of Missing Values by Robust PCA 
EM-PCA indicates that in the iterative process, replacing missing elements by some means is risky 
because of the distortion of the data structure (Adams et al. 2002). The risk of inaccurate 
replacements mainly comes from outliers. In the data analysis, the existence of outliers in a sparse 
data set may lead to poor interpretation of the resultant estimates. Therefore, the presence of outliers 
affects the correct replacement of missing elements. Moreover, the presence of missing elements 
makes identifying the outliers difficult (Chen 2002). Robust versions of PCA have been proposed to 
construct a PCA model that is not influenced by outlying objects (Chen 2002, Stanimirova et al. 
2007, Serneels and Verdonck 2008). Many robust estimators other than the statistical mean have 
been devised (Little 1988, Rousseeuw and Van Driessen 1999, Hubert et al. 2005). To implement 
Robust PCA, Verboven and Hubert provided a toolbox in MATLAB and LIBRA, which can be 
downloaded from one of the following Web sites: http://www.wis.kuleuven.ac.be/stat/robust.html or 
http://www.agoras.ua.ac.be (Verboven and Hubert 2005). LIBRA mainly contains two Robust PCA 
methods: RAPCA and ROBPCA (Hubert et al. 2005). ROBPCA, which is based on projection 
pursuit ideas (Huber 1985) with a minimum covariance determinant estimator (Rousseeuw and Van 
Driessen 1999), has shown to outperform RAPCA in many situations; thus, ROBPCA will be 
adopted into the analysis. 
ROBPCA provides a diagnostic plot where the outliers can be identified. The diagnostic plot 
displays the data by plotting their orthogonal distance (OD) versus their score distance (SD). In 
general, two types of outlying data will affect the PCA: bad PCA-leverage data characterized by 
large OD and SD, and orthogonal outliers characterized by large OD and small SD (Stanimirova et 
al. 2007).  
When ROBPCA is performed on the data matrix n mX , a robust score matrix 
ˆ
n kT  and a robust 
loading matrix ˆm kP are generated. 
ˆ
n mX can then be predicted through
ˆ ˆ ˆ T
n m n k k m  X T P . This 
procedure, which is the same as that in the M-step in EM-PCA, is called R-step because it is derived 
from a robust version (Serneels and Verdonck 2008).  
 
2.4. Summary 
A CF-based RS, which is based on dimension reduction techniques such as grouping of individuals, 
9 
 
3.1.1. Initialization of (0)C , M:
 
Transformation of Basket Data into Compositional Data 
The compositional data composed of n observations are measured in m variables, i.e., 
1 2( , ,..., ), 1,2,...i i i imx x x x i n  . Each element of xi is a value proportional to the number of 
appearance in each variable. That is, such representation refers 
ijx  to the probability of user i 
having purchased item j. The elements of xi are constrained to the sum of the unity: 
1
1,
m
ijj
x i

  . 
Aitchison (1983) pointed out that this constraint introduces a bias of negative correlations to the 
variables. Thus, the log transformation of the data should be conducted. However, Aitchison‟s 
approach cannot handle zeros in the elements. Bacon-Shone (1992) proposed another approach to 
the compositional data based on ranks, allowing zeros to be present. However, Baxter (1993) 
showed that both approaches can be misleading when there are small but non-zero elements in the 
data set. Thus, performing PCA on the compositional data without modifications to retain its 
original information was recommended. 
As a result, the following procedure is proposed to transform basket data in a user-item matrix into 
compositional data. The variables n and m ( n m ) denote the number of users and items, 
respectively, in each user-group. Assume X to be an n m  matrix, where the missing elements are 
given with zero values. Then, 
,i jX  
is a missing element if 
, 0i j X . Let M be the set of positions 
of missing elements in X , which is defined by M = {(i,  j): 
,i jX is observed as a missing element}. 
Let (0)C  be a user-item matrix, where each row consists of the compositional data. To obtain (0)C  
as an input to the E-RPCA at the next stage,
 
three steps are proposed to be conducted:  
Step 1: Each entry of X is divided by the sum of the corresponding row.
 
Step 2: The value of 
,i jX , , , ( , )i j i j M   is replaced by the average of the mean of the j 
column and i row of X . 
 
Step 3: Redo Step 1 once to obtain (0)C . 
 
 
3.1.2. Prediction of Missing Elements by E-RPCA 
To cope with the missing elements, ROBPCA is adopted. The method is as follows. Recall that 
(0)
C represents the n m  user-item matrix, where each row consists of the compositional data. 
ROBPCA is applied to determine a robust center matrix ˆ n mμ  and a loading matrix 
ˆ
m kP . The 
score matrix ˆn kT  represents the coordinates of the centered  data of users according to the k 
loadings of 
(0)ˆ ˆˆ( )n k n m m k   T C μ P , where the robust loadings are computed using the techniques 
of projection pursuit (Huber 1985) and the minimum covariance determinant estimator (Rousseeuw 
and Van Driessen 1999).  
11 
 
( )t
C is further normalized as in C,
 
whose row vectors are compositional data. C is predicted and 
represented as the final user-item matrix, where 
,i jC  is the probability of user i having purchased 
item j. 
 
3.1.3. Top-N Transformation 
After achieving the two stages above, the binary user-item matrix X  of each user-group is 
transformed into the user-item matrix C, where 
,i jC  is the probability for the user i to purchase 
item j. To complete the prediction task for recommendation purposes, these real-numbered matrices 
are required to be converted by matrices with the basket data.  
In this study, the real-numbered matrices are converted into binary matrices according to the size of 
the recommended items. If the size of the recommended items is determined as N, the top-N values 
for each row vector of C are converted into 1 and others into 0.  
 
3.2. Recommendation Task 
 In the recommendation task, a traditional CF or any other CF-based methods can be used. In 
this study, CECF proposed by Wang and Wu (2010) is employed as illustrated below. With the 
active user denoted as a, the predicted item as j, the active user‟s group as Ut and other user-groups 
as Ug, 1,2,..., ,g G g t  . The relations between Ug and j are regarded as out-of-clique effects of 
the purchase probability measured for a. Users in the same clique with a (the so-called neighbors) 
can provide collaborative information to measure the purchase probability. The users in different 
cliques also provide collaborative information to a to a certain degree. In this respect, CECF 
suggests measuring the purchase probability of a with respect to j as in Eq. (4): 
 in-clique  out-of-clique
, , ,(1 )a j a j a jP P P         (4), 
where the probability (
,a jP ) is a convex combination of two distinct probabilities: one is the 
purchase probability (  in-clique
,a jP ) predicted by the collaboration of users in Ut (the neighbors), and the 
other (  out-of-clique
,a jP ) is predicted by the collaboration of users in Ug, 1,2,..., ,g G g t  ;   can be 
noted as the priority ranking on the effects from other user groups. The common concept of the 
CF-based methods with an adaptation to the binary basket data (Breese et al. 1998; Mild and 
Reutterer 2001, 2003) is presented as in Eq. (5):  
 in-clique
, 1 ( , ) ( , )
t
a j
U
P sim a neighbor C neighbor j    (5), 
where 
1  is a normalizing factor. The notation, ( , )sim a neighbor , is the similarity between a and 
his/her neighbor, whereas ( , )C neighbor j is the binary choice whether the neighbor purchases j
 
or 
13 
 
E-RPCA and the transformation procedure on the basket data. 
 
4.1. The Experiment on Rating Data: MovieLens Data set 
 The MovieLens datasets were collected by the GroupLens Research Project 
(http://www.grouplens.org/) and have contributed much to the research on RSs (Billsus and Pazzani 
1998, Sarwar et al. 2000, Kim and Yum 2005, Julià et al. 2009). One of the data sets consists of 
100,000 ratings (scaled discretely from 1 to 5) from 943 users on 1682 movies. The entire data set 
has already been split into 5 pairs of training and test sets, namely, u1–u5.base and u1–u5.test. Each 
base/test set consists of exactly 80,000/20,000 ratings. For each base/test set, the percentage of the 
missing data is around 94.96% or 98.74%. 
To study the recommendation accuracy of E-RPCA as well as the SVD-based approach proposed by 
Sarwar et al., their abilities to retrieve each user‟s preference on items are considered. Items with 
higher ratings should be recommended with higher probabilities. In the experiment, some data were 
randomly removed from each base/test set, thus increasing the percentage of missing data to 99.1% 
or 99.5%. The removed data were exploited to study the restored values as the test sets. Therefore, 5 
data sets with 99.1% missing data and 5 data sets with 99.5% missing data were used as the training 
sets in the experiment. The E-RPCA was also fixed to perform once in the experiment for 
benchmarking because the SVD-based approach is not an iterative procedure. 
To compare the recommendation accuracy of E-RPCA with the SVD-based approach, three 
responses of recall, precision, and F1 were used to measure the recommendation performance under 
different factors. The experiment was conducted using the following four factors (i.e., missing, 
method, N, and PCs) for factorial analysis: 
Data sets with two percentages of missing data (missing, 2 levels): 99% and 99.5% 
Methods to retrieve the missing values (method, 2 levels): E-RPCA and SVD 
Size of the recommended items (N, 19 levels): N ranged from 2–20 
Number of PCs/ rank values (PCs, 19 levels): PCs ranged from 2–20 
 
4.1.1. Factorial Analysis 
In the factorial analysis, the effects of the three-factor and four-factor interaction were ignored as 
most studies suggest. The analysis of variance table for recommendation performance is shown in 
Table 2. In Table 2, evidently, each factor considered in the experiment significantly influences the 
recommendation performances. The recommendation performances of E-RPCA and the SVD-based 
approach according to the number of PCs /rank values are shown in Fig. 3. Fig. 3 also shows that 
the performances of E-RPCA dominate those of the SVD-based approach when any number of 
PCs/rank value is taken. Moreover, the larger the number of PCs/rank value chosen, the lower the 
performance will be. The performances according to the two kinds of data sets and N are shown in 
Fig. 4. As observed on the right side of Fig. 4, E-RPCA dominates the SVD-based approach when 
considering the different sizes of the recommended items. The left side of Fig. 4 shows either 
approach performs better in the data sets with higher percentage of missing values. Note that the 
E-RPCA is slightly inferior to the SVD-based approach when only the mean of the recall in the data 
15 
 
considered in the RS significantly influences the recommendation performance. The 
recommendation performance, according to each level of each factor, was further compared as 
shown in Fig. 5. The following are observed from Fig. 5: 
The larger the value of N chosen, the higher the performances will be. 
E-RPCA performs well in terms of recall but poorly in terms of precision. In the leverage 
performance of F1, E-RPCA still performs better than No-ME. 
The performances of the three measures all reach the best when   is equal to 0.1.Then, it 
decreases as increases from 0.1 to 1. 
(Table 3. Analysis of Variance from the Case Study)  
(Fig. 5. Comparison of Performances via each Factor from the Case Study) 
Fig. 6 shows the respective effects while applying the E-RPCA into a sparse matrix or not. In Fig. 6, 
where y-axis represents the performance measure, for the measures of recall and F1, the E-RPCA 
overwhelms the No-ME. However, for the measure of precision, E-RPCA leads only 
when {0,0.1,0.2}  . 
(Fig. 6. Performances of E-RPCA with respect to and N) 
 
4.2.3. Discussion 
 In this case study, E-RPCA showed its effectiveness in enhancing the recommendation 
performance. Although it caused poor results in precision when some augments were taken, it led to 
good performances of recall as well as F1. Better performance of F1 is more important because it is 
more effective and significant. In this sparse data set, CECF did conflict with E-RPCA. This fact 
resulted in the decline of the performance measures. This could be attributed to the existence of 
only a few groups, i.e., three groups in this data set. The clique effects did not help in compensating 
for the insufficient information caused by the nature of a sparse matrix. Therefore, in a kind of data 
set with fewer user groups, using the E-RPCA and CECF with lower values of ranging from 0–0.2 
is suggested. 
 
5. Conclusions 
Among the studies of CF-based approaches, the problem of the sparse user-item matrix is critical 
because it occurs often and affects the recommendation performance significantly. In the 
approaches proposed for the sparse problem in CF-based RSs, two directions are usually considered: 
one is to exploit the dimension reduction techniques and the other is to complete the data matrix by 
the prediction of the missing elements. The two directions are known to have respective 
disadvantages. As a result, E-RPCA is presented to enhance the quality of the information that can 
be obtained from the sparse data set. By filling in the missing elements of the user-item matrix 
whose entries are market basket data, the hidden information can be retrieved, and the 
recommendation performance can be improved. 
The proposed E-RPCA can be applied to the sparse matrix containing basket data, rating data, or 
real numbers. In this study, E-RPCA was applied to basket data because this kind of matrix is often 
too sparse to be used, and the enhancement of performance could be more significant.  
17 
 
Jolliffe, I. T. Principal Component Analysis, 2nd edition. Springer Series in Statistics, New York, 
NY, 2002. 
Julià, C., Sappa, A. D., Lumbreras, F., Serrat, J., and López, A. Predicting missing ratings in 
recommender systems: adapted factorization approach. International Journal of Electronic 
Commerce, 14, 2, 2009, 89–108. 
Karypis, G. Evaluation of item-based Top-N recommendation algorithms. In Proceedings of the 
10th international Conference on Information and Knowledge Management, Atlanda, Georgia, 
USA, 2001, 247–254. 
Kim, B. M., Li, Q., Park, C. S., Kim, S. G., and Kim, J. Y. A new approach for combining 
content-based and collaborative filters. Journal of Intelligent Information System, 27, 1, 2006, 
79–91. 
Kim, D., and Yum, B. J. Collaborative filtering based on iterative principal component analysis. 
Expert Systems with Applications, 28, 4, 2005, 823–830. 
Kim, H. T., Ji, A. T., Kim, Ha. I., and Jo, G. S. Collaborative filtering based on collaborative tagging 
for enhancing the quality of recommendation. Electronic Commerce Research and Applications, 9, 
1, 2010, 73–83. 
Kohrs A., and Meriadlo, B. Creating user adapted websites by the use of collaborative filtering. 
Interacting with Computers, 13, 6, 2001, 695–716. 
Linden G., Smith B., and York J. Amazon.com recommendations: item-to-item collaborative 
filtering. IEEE Internet Computing, 7, 1, 2003, 76–80. 
Little, R. J. A. Robust estimation of the mean and covariance matrix from data with missing values. 
Applied Statistics, 37, 1, 1988, 23–38. 
Mild, A., and Reutterer, T. An improved collaborative filtering approach for predicting 
cross-category purchases based on binary market basket data. Journal of Retailing and Consumer 
Services, 10, 3, 2003, 123–133. 
Mild, A., and Reutterer, T. Collaborative filtering methods for binary market basket data analysis. 
Lecture Notes in Computer Science, 2252, 2001, 302–313. 
Papagelis, M., Plexousakis, D. and Kutsuras, T. Alleviation the sparsity problem of collaborative 
filtering using trust inferences. In Proceedings of the 3rd International Conference on Trust 
Management, Paris, France, 2005, 224–239. 
Rousseeuw, P. J., and Van Driessen, K. A fast algorithm for the minimum covariance determinant 
estimator. Technometrics, 41, 3, 1999, 212–223. 
Sarwar, B. M., Karypis, G., Konstan, J. A., and Riedl, J. T. Application of dimensionality reduction 
in recommender system – a case study. In Proceedings of ACM WEBKDD Workshop, Boston, MA, 
USA, 2000. 
Schafer, J. B., Konstan, J. A., and Riedl, J. T. Recommender systems in E-commerce. In 
Proceedings of the 1st ACM Conference on Electronic Commerce, Denver, Colorado, USA, 1999, 
158–166. 
Schafer, J. B., Konstan, J. A., and Riedl, J. T. E-commerce recommendation applications. Data 
Mining and Knowledge Discovery, 5, 1–2, 2001, 115–153.  
19 
 
1 2 3 4 5 6 7 8 9 10
0.05
0.1
0.15
0.2
0.25
Index
E
ig
e
n
v
a
lu
e
ROBPCA
 
Fig. 1. Screen plot with Optimal Value of k = 2 
 
 
0 100 200 300 400 500 600
0
1
2
3
4
5
6
Score distance (3 LV)
O
rt
h
o
g
o
n
a
l 
d
is
ta
n
c
e
 26  60
 76
  3
 87
134
ROBPCA
 
Fig. 2. Example of the Score Outlier map 
 
21 
 
SVDROBPCA
0.66
0.65
0.64
0.63
0.62
0.61
0.60
0.59
0.58
0.57
SVDROBPCA
0.525
0.500
0.475
0.450
0.425
0.400
0.375
0.350
SVDROBPCA
0.56
0.54
0.52
0.50
0.48
0.46
0.44
0.42
0.40
N
201918171615141312111098765432
0.75
0.70
0.65
0.60
0.55
0.50
0.45
0.40
N
201918171615141312111098765432
0.6
0.5
0.4
0.3
0.2
N
201918171615141312111098765432
0.6
0.5
0.4
0.3
0.2
99% data sets
99.5% data sets
E-RPCA
SVD
E-R CA S
E-R CA S
E-R CA S
Mean of Recall
Mean of Precision
Mean of F1
Mean of Recall
Mean of Precision
Mean of F1
 
Fig. 4. Performances according to the two kinds of data sets (left) and N (right) 
 
23 
 
CECF (  0 means the traditional CF) Size of recommended items, N
1.00.90.80.70.60.50.40.30.20.10.0
0.25
0.20
0.15
0.10
0.05
y-axis: Mean of Recall             x-axis: 
1.00.90.80.70.60.50.40.30.20.10.0
0.25
0.20
0.15
0.10
0.05
y-axis: Mean of Precision           x-axis: 
1.00.90.80.70.60.50.40.30.20.10.0
0.25
0.20
0.15
0.10
0.05
y-axis: Mean of F1                    x-axis: 
15141312111098765432
0.25
0.20
0.15
0.10
0.05
y-axis: Mean of Recall             x-axis: N
15141312111098765432
0.40
0.35
0.30
0.25
0.20
0.15
0.10
y-axis: Mean of Precision        x-axis: N
15141312111098765432
0.25
0.20
0.15
0.10
0.05
y-axis: Mean of F1                      x-axis: N
E-RPCA No-ME
 
Fig. 6. Performances of E-RPCA with respect to and N 
 
 
25 
 
Table 2. Analysis of Variance from the Experiment 
Source DF Seq SS  Adj SS  Adj MS  F   p-value 
Recall 
missing  1 1.91507  1.91507   1.91507  448478.19   0.000 
method  1 0.01651  0.01651  0.01651  3865.50   0.000 
N    18  12.92834  12.92834  0.71824  168199.97   0.000 
PCs  18 0.07011  0.07011  0.00390   912.15    0.000 
 S = 0.00206644   R-Sq = 99.97%   R-Sq(adj) = 99.96% 
Precision 
missing 1  7.54459   7.54459   7.54459  446752.74  0.000 
method  1   0.04886   0.04886   0.04886  2893.15   0.000 
N   18  17.92901  17.92901  0.99606   58981.46   0.000 
PCs   18 0.46979   0.46979   0.02610  1545.47   0.000 
 S = 0.00410945   R-Sq = 99.94%   R-Sq(adj) = 99.91% 
F1 
missing 1 6.74046    6.74046  6.74046  908659.11 0.000 
method  1 0.03992    0.03992  0.03992  5382.03   0.000 
N   18 19.55728   19.55728  1.08652  146469.69   0.000 
PCs  18  0.28532    0.28532  0.01585  2136.81   0.000 
 S = 0.00272360   R-Sq = 99.97%   R-Sq(adj) = 99.96% 
Note: The results of two-factor interaction are all hidden for simplicity. 
missing: 99% or 99.5% missing data. method: E-RPCA or SVD. PCs: # of PCs or rank values. N: 
size of recommended items. DF: degrees of freedom. Seq SS: sequential sum of squares. Adj SS: 
adjusted sum of squares. Adj MS: adjusted mean squares. S: root of mean square error. R-Sq: R
2
. 
R-Sq(adj): adjusted R
2
. 
 
27 
 
 
國科會補助專題研究計畫成果報告自評表 
請就研究內容與原計畫相符程度、達成預期目標情況、研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）、是否適
合在學術期刊發表或申請專利、主要發現或其他有關價值等，作一綜合評估。 
1. 請就研究內容與原計畫相符程度、達成預期目標情況作一綜合評估 
■   達成目標 
□ 未達成目標（請說明，以 100 字為限） 
□ 實驗失敗 
□ 因故實驗中斷 
□ 其他原因 
說明： 
Based on the 1
st‟s system design and analysis in the 1st year, and the development of the analytical 
model and the recommender strategies in the 2
nd
 year, this year we have successfully accomplished 
the system calibration and validation by the integration with other modules and experimental studies 
have been performed 
 
 
2. 研究成果在學術期刊發表或申請專利等情形： 
論文：■已發表 ■未發表之文稿 □撰寫中 □無 
專利：□已獲得 □申請中 □無 
技轉：□已技轉 □洽談中 □無 
其他：（以 100 字為限） 
 
1)."A Strategy-Oriented Operation Module for Recommender Systems in E-Commerce” , accepted 
by Computers & OR 
2).“Resolution of a Sparse User-item Matrix in the Recommender Systems by E-RPCA”, submitted 
to International Journal of Electronic Commerce Research and Applications. 
附件二 
 1 
國科會補助專題研究計畫項下出席國際學術會議心得報告 
                                  日期： 100  年 6 月 25  日 
                                 
心得報告 
     此次參加在芬蘭首都赫爾辛基北邊大城 Jyväskylä 舉行之兩年一次的第二十一屆多準則國際會議
發表有關政府與廠商在執行節能減碳之政策時所可能考慮的獎懲策略: Multi-level Subsidy and 
Penalty Strategy for a Green Industry Sector。 
    Jyväskylä 離赫爾辛基約三小時的火車車程。會議主辦單位與會議所在之 University of Jyväskylä 為
當地主要的學府。學校為著名建築師 Aalto所設計，依水而建的白色校園隱在茂密的綠樹間，錯落有
秩，精緻卻不失雄偉。令人對這以設計聞名的國家更有一番體認。 
   本人因為與 Aalto University 的工業工程與管理系(Department of Industrial Engineering and 
Management)的 Dr.Kari Kanstanen 在供應鏈管理的研究上有雷同之處，且因本人報告在第四日，故此
次藉此機會先在赫爾辛基停留兩日拜訪此系。 此系規模與本系相仿，16 人的師資下分別在管理、策
略與人因方面之工作心理下發展偏重工程管理方面的議題。除大學部外，每年培養約 60位碩士生、10
位博士生。學術水準之高展現在其多位師資擔任國際著名期刊之主編上。 
計畫編號 NSC  NSC 97-2221-E007-095-MY3 (3/3) 
計畫名稱 
綠色產品生命週期管控之知識服務系統 
子計畫 8: 綠產品知識服務平台下結構化資訊檢索與推薦機制之建構 (3/3) 
出國人員
姓名 
王小璠 
服務機構
及職稱 
國立清華大學工業工程與工程管
理系教授 
會議時間 
2011年 6月 13 
日至 
201年 6月 17日 
會議地點 
Jyväskylä, 芬蘭 
會議名稱 
(中文)第 21 屆國際多目標會議 
(英文)21st International Conference on Multiple Criteria Decision Making 
 
發表論文
題目 
(中文)以多階規劃訂定綠產業之獎懲費率 
(英文) Multi-level Subsidy and Penalty Strategy for a Green Industry 
Sector 
國科會補助計畫衍生研發成果推廣資料表
日期:2011/08/31
國科會補助計畫
計畫名稱: 子計畫八: 綠產品知識服務平台下結構化資訊檢索與推薦機制之建構
計畫主持人: 王小璠
計畫編號: 97-2221-E-007-095-MY3 學門領域: 資訊系統
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
1). 鄒永珊，’Multi-level Subsidy and Penalty Strategy for a Green 
Industry Sector’， Best Student Paper Award (優勝), CIIE, Dec. 25, 2010
2).  黃衍善，’ Demand-Driven Disassembly Planning for a Closed-Loop 
Supply Chain System,’， Good Student Paper Award (佳作), CIIE, Dec. 25, 
2010 
3). 2011, 鄒永珊，’Multi-level Subsidy and Penalty Strategy for a Green 
Industry Sector’， Master’s Thesis Competition Excellent Award (優
勝), CIIE, Jun. 28, 2011 
 
 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
