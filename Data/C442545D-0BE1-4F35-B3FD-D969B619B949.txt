2研究摘要(500字以內)：
（一）計畫中文摘要
早期的紙類加工產業所採用的生產排程，多以先進先出法(First In First Out，FIFO)和交
期最早法(Earliest Due Date，EDD)為主。研究顯示，EDD法僅在降低延遲方面有不錯的績
效，FIFO法則是在各方面的表現多不理想，以上兩種方法在生產過程中往往缺乏彈性，在
實際使用上皆無法發揮預期的效用。在動態的環境中更無法支援與解決公司生產排程以達
到最佳產能利用率，進而降低生產成本的效果。因此有別於上述的兩種排程方式，本研究
計畫將以排程理論觀念與啟發式搜尋法(Heuristic method)所建構的最適化模式，重新建構一
個排程法則，以提升現場設備利用率與縮短整備時間。
本研究計畫將運用Java開發工具(Java Development Kit 5.0，JDK 5.0)，以基因演算法
(Genetic Algorithms)的概念，來探討顧客訂單多規格的問題，利用所設定的排序條件
(Sequence condition)與適應函數(Fitness function)大小，建立一個最適化的排程，接著再將排
好的製造工單送到工廠實際作業，以有效縮短製程的整備時間。
本研究計畫主要目的是協助禔福紙業股份有限公司以排程理論為基礎，發展一套最佳
化排程的模式，使公司之整體生產流程最適化，且未來客戶訂單若不斷擴增時，也可投入
更少的時間與人力去完成訂單的排序，以增進整體營運機制之運行，所以如果能在此時投
入適量的人力與物力，來建構排程最佳化模式以縮短製造現場中的整備時間，則能幫助禔
福紙業公司大幅降低製造成本，相對的對於公司競爭力也會有不少的提升。
關鍵字：基因演算法(Genetic Algorithms)，啟發式搜尋法(Heuristic Search)，先進先出法(First-
In First-Out，FIFO)，交期最早法(Earliest Due Date，EDD)，排序條件(Sequence condition)
4一、人才培育成果說明：
參與本計畫的工作人員，將可獲得產學合作實務上的裨益，落實政府所提倡的「產
學合一」的目標，茲分述如下：
1. 了解瓦楞紙板製造產業的產業特性與高度國際競爭環境下可能面臨的問題。
2. 可以充分學習啟發式方法(Heuristic Method)與排序理論(Sequence Theory)的基礎與最佳
化模式之運用。
3. 從參訪及研究過程中，可以增廣見聞，使在複雜的理論學習過程中，獲得實際產業應用
的驗證，為國家經濟發展貢獻一己之力。
二、技術研發成果說明：
本計畫對禔福紙業股份有限公司進行訂單排程最適化之研究，以縮短現場整備時間。
研究流程如圖一所示：
圖一 建構禔福紙業公司排程最適化之研究流程圖
問題定義 建立實施團隊 製程分析
廠商訪談
資料收集
建構各種紙寬與
紙質資料庫
導入啟發式方法
與排序理論概念
最佳化排程
求解與分析
驗證模式、導入與
實施
6經實地拜訪禔福公司，瞭解各設備機台之生產作業方式與生產線佈置情況，如下圖二
所示。產品主要製造流程是由四部複瓦機完成，複瓦機分為 A、B 車處理芯紙或面紙壓線
與壓楞之動作，再由糊車貼合，最後經裁斷部裁切，即完成一項瓦楞紙紙板生產作業。
圖二 禔福瓦楞紙工廠設施平面圖
瓦楞紙分三層與五層紙板兩類，生產三層紙板會使用 A 車和糊車，而生產五層紙板則
會使用到 A、B 車和糊車。A 車、B 車及糊車皆設有原紙紙筒架，每組紙筒架可裝配兩卷
原紙紙筒，一卷為線上生產投料用，另一卷為換模用。其功能在於生產下筆產品時，作業
員可先將原紙筒上架來避免停機更換原紙，能有效地節省換模時間。但若生產排程不佳，
將導致生產產品紙質差異過大，也使得作業員將頻於紙筒上架作業，導致疲勞或作業疏失
發生，亦無法因應客戶臨時要求增加產量或設計變更。因此由改善排程換模次數，不僅可
增加員工生產效率，亦可節省更多換模作業時間來因應臨時之插單作業。
8圖四 禔福公司排程表
5. 建構各種紙寬與紙質資料庫
每一筆瓦楞紙資料包含紙寬與紙質兩項資料。
紙寬：廠內表單在尺寸單位使用上並無統一，排抄表使用的尺寸單位為台分，生產排程表
單則使用公厘。為了方便界定，整理紙寬共18種尺寸單位對應如下表二。
表二 尺寸單位對照表
台分 公厘
314
330
347
363
380
396
413
429
446
462
479
495
512
528
545
561
578
594
950
1000
1050
1100
1150
1200
1250
1300
1350
1400
1450
1500
1550
1600
1650
1700
1750
1800
10
單。
若A客戶有定訂交期無法延後且利潤相當好，但經生管部門評估後發現，若承接此單
則將面臨緊急插單，會造成產能無法因應的難題。否則，必須將其它公司的訂單交期延後。
步驟2. 排定現場排程。
通常排定現場排程有兩大目的，第一為給予現場人員考量先後生產次序的規則，第二
為評估現場產能負荷狀況，作為接單參考。目前的現場排程通常以給定各部門每天各產品
所須的產量為目標，使製造部門得以彈性運用機台。
當生管部門承接A客戶的訂單時，現場排程勢必依據產品線的可供產能重新排定。由
可供之排程起點，依訂單的緊急程度和數量多寡順序排入主生產排程。
步驟3. 排程排定後若有訂單之交期無法達成，須向客戶修改交期。
若因為廠內訂單較多而無法於預定的交期內完成時，通常必須先行告知客戶可能出貨
的修訂後交期，提供客戶參考。若客戶不能接受，則進一步依據客戶的重要程度採取不同
的做法；如果這個客戶非是主要客戶，則可能因交期無法如期而傾向不接單。如果這個客
戶相當重要，如利潤相當好，必須如期交貨，則會因為插單而導致延誤線上較不重要的客
戶的交貨日期，此時需再重新排定主生產排程後，針對某訂單必將延後出貨的客戶給予緊
急通知與協商。若客戶接受修改交期，則插單即可解決，否則插單的做法若不可行，將無
法承接客戶的新訂單。
步驟4. 決定生產優序。
若其它公司經協調後願意修改出貨交期，則重新排定的生排程即為實際的生產排程，
現場將依循此生產優序作為機器排程派工的準則。
基因演算法流程
應用基因演算法求解最佳化問題，必須先對問題所要搜尋的自然參數解集合，將其編
碼成一字串，此字串就如同是生物學上的染色體，而染色體組成的基因串列即是影響問題
之因素。將這些基因組合成一基因組即所謂基因演算法則上所稱之「編碼」動作。在將基
因編碼完成後，尚須設計一「適應函式」（Fitness function），此為由最佳化參數所構成的
函式，是用來作為評估所要尋求解答之問題是否滿足設定之終止條件。有了「基因串列編
碼」與「適應函式」，再經過複製(Reproduction)、交配(Crossover)、突變(Mutation)等三步
12
基因演算法在搜尋近似最佳解時，每一代演化係以一個族群（Population）為單位，因
此可以同時平行搜尋數個可能答案。其基本運算為複製、交配和突變等機制，其操作狀態
為根據隨機值而改變的，因此即使在環境參數完全固定不變下，每次運算求解所得之答案
可能並不相同。
7. 最佳化排程求解與分析
本研究計畫建構基因演算法的架構求解禔福工廠之排程問題，因此演算流程是依循基
因演算法則之交配、突變、複製三大步驟來做規劃，演算法之參數與演算條件如下說明。
 染色體結構：本研究案例之染色體結構是由兩類產品(三層紙與五層紙)與紙質符號
資訊所組成。
 基因串列編碼：表示產品在線的生產排序。
 族群：由於族群之個體數目大小會影響基因演算法的運作，族群太小，則難以達
到要求而較早收斂。族群大可使搜尋從更多點來進行，但較耗時。例如設定族群
數7可窮舉5040次排列組合。
 適應函數值：演算法求得的每一組基因皆代表一組可行之生產排序方案解，方案
解內包含著原紙更換次數資訊，而影響原紙更換次數的因素，則考慮紙寬度與紙
質種類。方案解就好比自然界中的物種，每當要進行下一代的演化時，必須先評
估該代所交配出來的新物種是否優於既存的？若是，則以新物種取代舊有的物
種，將舊物種淘汰。若否，則基於優生學觀念，新交配出來的物種，將不會被考
慮進化到下一代去。而評斷新、舊物種優劣的依據即是適應函數值。本案例對適
應函數的定義為原紙更換次數，期以找到的工作順序能使原紙更換次數最少，因
此選出個體中最大的適應函數值，和所有個體的適應函數相減後，差異越大者將
是希望能留下的基因串列，也就是較想要的工作次序。
 複製：演算法根據上一代族群之基因字串的適應度高低來決定字串被複製的機
率，因此具有較高績效的字串，就有較高機率被選擇到並被複製到下一代。亦即
適應程度高的物種將在下一子代中被大量複製，而適應程度低的物種則在下一子
代中會被優秀的物種所淘汰。複製方法採用輪盤法(Roulette wheel selection)，將各
個個體的適應值除以所有個體適應值的總和，得到各個體的適應值比率。在依各
14
以互換成對基因串列其指定位置內之基因值來完成交配過程，藉以產生新的子代基因字串。
步驟4. 判斷交配程序是否完成：如果交配池中各基因串列都經歷交配過程，則進入突變程
序，否則繼續進行交配過程。
步驟5. 訂定基因串列之突變機率：先設定一總族群之突變率水準，再以亂數方式分別為每
一基因串列個體產生一突變機率值，用以決定該基因串列是否要進一步進行突變演化。如
果基因串列之突變機率值小於或等於所設定之族群突變率水準，則該基因串列即可進行突
變處置。如果基因串列之突變機率值大於使用者所設定之族群突變率水準，則保持原交配
後或未被選入交配池中之基因串列基因組成。
步驟6. 進行突變：由步驟5.所挑選出之「待突變基因串列」，以亂數方式決定出基因幹上
兩突變位置，並將此兩位置上的基因值做互換的動作。
步驟7. 判斷突變是否完成：如果「待突變基因串列」都經歷了突變過程，則完成突變程序，
否則繼續突變過程。
步驟8. 判斷演化代數是否足夠：藉由觀察適應值是否已達到一收斂的狀況，來決定演化過
程是否要再增加演化代數或可停止。如果基因演算尚未滿足所設定之演化代數，則準備進
行將此代之優秀基因串列複製至下一子代。若適應值已達一收斂程度，且已達到所設定之
演化代數目標，則結束基因演算之搜尋工作，否則需重新設定並增加基因演化之代數，並
重新再次執行基因演算法，直到演化代數達到所設定之新值為止。重複前述觀察適應值之
收斂步驟，務必求得演化結果趨近於一收斂值為止，否則該問題解可視為無最佳解。
步驟9. 複製基因串列至下一子代：為達到子孫綿延繁衍且遵循「優生學」的目的，必須將
優質的基因串列設法遺傳至下一子代上，所以本研究將適應程度前百分之三十的基因串
列，依適應值比例之數量自我繁衍至下一子代中，並使其達到與母代相同之族群規模。
16
8. 驗證模式、導入與實施，將紙質換模次數控制在最佳狀態
依禔福工廠 95 年 2 月 22 日排抄表資料，得知客戶在尺寸寬度為 347 台分所訂購之產
品，按照訂單編號 1 至 6 順序為 3+3、4+3、JR9、4++++、B+++3 和 9++R9，所套用演算
法設定如下表四。
表四 演算法設定表
適應函數 排序種類之換模次數
染色體結構 由兩類產品(三層紙與五層紙)與紙質符號資訊所組成
基因字串 代表生產排序，且採十進位的編碼方式
參數設定
族群大小=7
總族群交配率水準=0.6
總族群突變率水準=0.1
基因串列保留率=0.3
演化世代數=20
演算方式
複製：不放回隨機抽樣方式複製
交配：順序交配運算(Order crossover operator，OX)
突變：簡單交換突變運算
亂數產生的編號排序 456321 為一種基因串列如下表五所示，統計個別更換紙筒的數量
與此種排序方式所更換紙筒的總次數。而基因串列能達到的換筒次數，即為該基因串列的
適應函數值。
表五 編號排序對應產品資訊、紙筒更換之統計表
寬度：347 台分
編號排序 產品 換筒個數
6 9++R9
2 --4+3 5.0
3 --JR9 3.0
4 4++++ 5.0
5 B+++3 2.0
1 --3+3 3.0
總換筒次數：18
再依適應函數值計算出適應值及適應值比率。下表六列出初始基因串列的統計量。
18
第一次基因交配：
將複製後的基因串列依亂數方式產生各交配機率值，再與設定之交配機率比較來決定
是否進行交配運算，如下表九。
表九 各基因串列依亂數方式產生交配機率
排序種類編號 基因串列 交配機率 是否交配
1
2
3
4
5
6
7
512346
512346
512346
452316
452316
423651
423651
0.24
0.38
0.13
0.41
0.21
0.49
0.64
是
是
是
是
是
是
否
假設經隨機選取後，基因串列 1 和 5 配成第一對、2 和 4 配成第二對、3 和 6 配成第 3
對。交配方式以 OX 運算法採隨機選取兩切點進行互換，假設第一對基因串列隨機選取的
切點為 1 和 3，第二對基因串列隨機選取的切點為 3 和 5，第三對基因串列隨機選取的切點
為 4 和 5。而第一對基因串列利用 OX 法之運算情形如下圖七：
基因串列編號 選取切點 1 和 3 OX 運算法互換結果
1
5
(5 1 2) 3 4 6
(4 5 2) 3 1 6
(4 5 2) 1 3 6
(5 1 2) 4 3 6
圖七 第一對基因串列利用 OX 法之運算
表十列出各基因串列交配後之運算結果
表十 第一次基因串列交配運算結果
排序種類編號 基因串列 交配串列 切點位置 交配後基因
1
2
3
4
5
6
7
512346
512346
512346
452316
452316
423651
423651
5
4
6
2
1
3
--
1，3
3，5
4，5
3，5
1，3
4，5
--
452136
542316
123654
512346
512436
265341
423651
20
從中選擇前百分之三十較優的基因串列植入下一代，所以選出編號 1~5 的基因串列，
而為了符合所需族群數，剩下的 2 個基因串列則需隨機產生來。表十三列出了下一代的基
因串列，其中編號 1 和 2 的基因串列為重新產生。
表十三 第一代基因串列統計量
排序種類編號 基因串列 適應函數值 適應值 適應值比率
1
2
3
4
5
6
7
123564
652431
452136
512346
512346
452316
512436
15
18
12
15
15
16
16
3
0
6
3
3
2
2
1.11
0.00
2.21
1.11
1.11
0.73
0.73
總和 19 7
平均 2.71
比較表五與表十三，可知第一代的最小適應函數值已較初代的最小目標函數值少了 3。
依此方式產生第 2 代、第 3 代…等的基因串列來改善目標函數值。
終止條件：
最後演算法將觀察到一收斂之適應值，排序為 452136，如表十四。
表十四 演算法最佳排序
寬度：1700
編號排序 種類 換筒個數
4 4++++
5 B+++3 2.0
2 --4+3 3.0
1 --3+3 1.0
3 --JR9 3.0
6 9++R9 3.0
總換筒次數：12.0
