2 
目  錄 
中文摘要…………………………………………………………………………………………1 
英文摘要…………………………………………………………………………………………2 
第一章 研究目的…………………………………………………………………………………3 
第二章 第一年研究 Internet Open Trading Protocol 相關文獻探討…………………………4 
第三章 我們提出的適用於國際貿易之 IOTP擴增設計………………………………………13 
3.1 Payment Instruction Block 的設計……………………………………………………16 
3.2 信用狀交易流程主要架構設計………………………………………………………19 
3.2.1 信用狀開立…………………………………………………………………………19 
3.2.2 出口押匯……………………………………………………………………………21 
3.2.3 進口贖單……………………………………………………………………………23 
3.3 信用狀交易流程細節設計……………………………………………………………24 
3.3.1 信用狀開立…………………………………………………………………………24 
3.3.2 出口押匯……………………………………………………………………………26 
3.3.3 進口贖單……………………………………………………………………………26 
3.4 適用於 IOTP 的信用狀交易流程安全性設計………………………………………27 
第四章 第一年研究結果與討論………………………………………………………………29 
第五章  第一年研究參考文獻…………………………………………………………………31 
第六章 第一年研究成果自評…………………………………………………………………32 
第七章 第二年研究電子化契約與行動代理人相關文獻探討………………………………33 
7.1 電子化契約介紹………………………………………………………………………33 
7.2 行動代理人介紹………………………………………………………………………36 
第八章  我們提出的安全契約簽署行動代理人設計…………………………………………38 
8.1 通知階段(Notification Phase) ………………………………………………………39 
8.2 協商階段(Negotiation Phase) …………………………………………………………42 
8.3 契約簽署階段(Contract Signing Phase) ……………………………………………43 
8.4 爭執解決階段(Dispute Resolution Phase) …………………………………………45 
第九章 第二年研究結果與討論………………………………………………………………48 
9.1 匿名性(Anonymity) …………………………………………………………………48 
9.2 不可偽造性(Unforgeability) …………………………………………………………48 
9.3 不可否認性(Non-repudiation) ………………………………………………………49 
9.4 公平性(Fairness) ……………………………………………………………………49 
9.5 樂觀主義(Optimism) …………………………………………………………………51 
第十章  第二年研究參考文獻…………………………………………………………………52 
第十一章 第二年研究成果自評………………………………………………………………55 
可供推廣之研發成果資料表……………………………………………………………………56 
可供推廣之研發成果資料表……………………………………………………………………58 
附錄一……………………………………………………………………………………………60
附錄二……………………………………………………………………………………………70 
2 
Abstract 
 
The Internet Open Trading Protocol (IOTP) provides an interoperable 
framework for Internet commerce. It describes the content, format and sequences of 
messages that pass amon the participants in an electronic trade – Consumers, 
Merchants, Payment Handler, Delivery Handler, Merchant Customer Care Provider. It 
is an electronic trade system which encapsulated independent payment systems such 
as SET, Mondex, CyberCash, DigiCash, GeldKarte, etc. It is a Baseline in that it 
contains ways of doing trades on the Internet which are the most common. 
Since long, business organizations have been interacting in international trade 
and business-to-business (B2B) scenarios to reach their goals. Companies need to 
exchange data with their trading partners to conduct business. Exchanging data 
electronically has many advantages over manual transmission. The most important 
advantage is the ability to automate business processes. Some other advantages are 
timeless, traceability, reliability, scalability and security. Exchanging data 
electronically necessitates standards so that the applications at both ends can 
understand each other. However, the scenarios IOTP version 1.0 concerned about is 
taking place in the way consumers and merchants trade (B2C).  
Now, the international trade is entering a new age, the trend will be the Internet 
trade in the future. After surveying the requirement of IOTP version2 (RFC3354), we 
find the way to apply the concept of IOTP and XML to design the suitable process for 
Internet trading. In this project, we try to figure out the total solution for the 
automation, e-contract, and security control of the Internet trade. 
 
Keywords: Information Security, Internet Open Trading Protocol(IOTP), 
International Trade, B2B E-commerce 
 
 
 
 
 
 
4 
第二章 第一年研究 Internet Open Trading Protocol 相關文獻探討 
IOTP 是由 IETF 組織的 Internet Society(ISOC)小組，針對網際網路的交易特
性所制訂的一套開放性交易標準，其中各項交易步驟的內容格式，是以 XML 格
式進行定義。該標準的目的是希望能在網際網路的電子商務交易平台上，建立一
套共通的交易機制，保障各交易角色能在安全的環境下，完成各項交易。而該標
準的制訂範圍，包含各個角色定義、角色互動時的交易步驟、各項交易步驟的內
容格式以及訊息接收後的相對應處理流程等，但 IOTP 目前的設計卻仍只侷限於
B2C 交易過程。 
在 IOTP v.1 所考量的商業模式中，定義了消費者(Consumer)、零售商
(Merchant)、付款系統商(Payment Handler)、運輸業者(Delivery Handler)、售後服
務提供商(Merchant Customer Care Provider)等五種交易角色，如圖所示： 
 
圖 1、IOTP 的主要角色與互動關係 
IOTP 中五種角色在交易過程中的主要行為是： 
 消費者：向廠商購買商品或服務。 
 零售商：提供商品或服務的商家。 
 付款系統商：代替商家向消費者收費的金流業者，而付款機制可採用任
何已存在的標準，例如 SET、Modex、CyberCash、DigiCash 等。 
 運輸業者：代替零售商貨物運送給消費者的物流業者。 
 售後服務提供商：當交易發生問題或糾紛時的仲裁機構。 
IOTP 也將交易過程定義了四種交易互動(Trading Exchange)模式，分別是
Consumer 
Merchant 
Payment Handler 
Delivery Handler 
Merchant Customer 
Care Provider
處理付款相關事務 
運送商品或顧客要求的服務 
提供商品或特定服務 
仲裁顧客投訴與解決顧客問題 
6 
因此可以知道以一般的交易買賣來說，只要再進一步瞭解 IOTP 的資料格
式，建構出 IOTP 所規範的 XML 標準，就能在網際網路上達成交易買賣，各個
角色都可在公開且安全的機制下有效運作。 
就目前 IOTP v.1 的定義，B2C 的交易買賣過程中，不外乎就是進行下列八
種的處理(Transaction)： 
1. Purchase：消費者向商家購物(包含 Offer、Payment、Delivery)。 
2. Value Exchange：允許搭配組合不同的金流機制。 
3. Refund：支援交貨後付款的機制。 
4. Withdrawal：支援電子現金機制之提領程序。 
5. Deposit：支援電子現今機制之存款程序。 
6. Authentication：任何角色若有必要可對其他角色要求進行身份認證
程序。 
7. Inquiry：任何交易程序的狀態皆可查詢。 
8. Ping：一方可判別另一方是否採用 IOTP 協定。 
而能夠完成交易，是藉由如下列的 XML 格式，達成所有的互動與資料交換。 
  <!ELEMENT IotpMessage 
      ( TransRefBlk, 
        SigBlk?, 
        ErrorBlk?, 
        ( AuthReqBlk |  
          AuthRespBlk | 
          AuthStatusBlk | 
          CancelBlk | 
          DeliveryReqBlk | 
          DeliveryRespBlk | 
          InquiryReqBlk | 
          InquiryRespBlk | 
          OfferRespBlk | 
          PayExchBlk | 
          PayReqBlk | 
          PayRespBlk | 
          PingReqBlk | 
          PingRespBlk | 
          TpoBlk | 
          TpoSelectionBlk 
        )* 
      ) > 
所以，我們也更進一步將 IOTP 的資料格式做了詳細的瞭解，其 XML 格式
內的欄位類別，主要分為 Transaction Reference Block、Signature Block、Error 
Block、Trading Block 四大區塊，並逐一制訂出各個欄位，如下圖所示： 
8 
三、 Error Block： 
   <!ELEMENT ErrorBlk (ErrorComp+, PaySchemeData*) > 
   <!ATTLIST ErrorBlk 
    ID                 ID      #REQUIRED > 
四、 Trading Blocks 是表示交易訊息的主要區塊，在一個交易處理(Transaction)
中，IOTP 訊息包含一個(或一個以上)的 Trading Block，且每一個 Trading 
Block 可由一或多個 Trading Components 組成。在 IOTP V.1 定義了十六個
Trading Blocks，如下所列： 
1. Authentication Request Block ： 
   <!ELEMENT AuthReqBlk (AuthReq, TradingRoleInfoReq) > 
   <!ATTLIST AuthReqBlk 
    ID                 ID      #REQUIRED > 
包含要求認證別的交易角色之相關資料。 
2. Authentication Response Block： 
   <!ELEMENT AuthRespBlk (AuthResp, Org) > 
   <!ATTLIST AuthRespBlk 
ID                 ID      #REQUIRED > 
包含了 Authentication Request Block 的相關回應資料。 
3. Authentication Status Block：  
   <!ELEMENT AuthStatusBlk (Status) > 
   <!ATTLIST AuthStatusBlk 
    ID                 ID      #REQUIRED 
包含代表認證成功與否的狀態值。 
4. Cancel Block： 
   <!ELEMENT CancelBlk (Status) > 
   <!ATTLIST CancelBlk 
    ID                 ID      #REQUIRED > 
通知其他交易角色取消此筆交易。 
5. The Delivery Request Block：  
   <!ELEMENT DeliveryReqBlk (Status, Order, Org, Delivery, 
ConsumerDeliveryData, TradingRoleData) > 
   <!ATTLIST DeliveryReqBlk 
    ID                 ID      #REQUIRED > 
10 
包含了請求開始付款程序的相關資訊。 
11. Payment Exchange Block：  
   <!ELEMENT PayExchBlk (PaySchemeData+) > 
   <!ATTLIST PayExchBlk 
    ID                 ID      #REQUIRED > 
包含的是交易中的兩個交易角色之間相互交換的交易大綱等的相關
資料。 
12. Payment Response Block：  
   <!ELEMENT PayRespBlk (Status, PayReceipt, PaySchemeData, 
PaymentNote, TradingRoleData) > 
   <!ATTLIST PayRespBlk 
    ID                 ID      #REQUIRED > 
包含的是 Payment Status 的資訊指明交易成功或失敗，並將可驗證此
筆交易的相關訊息放置於 PayReceipt Component 之中。 
13. TPO Trading Block  
   <!ELEMENT TpoBlk ( ProtocolOptions, BrandList*, Org* ) > 
   <!ATTLIST TpoBlk 
    ID                 ID      #REQUIRED > 
包含用於描述 IOTP 交易處理的相關選擇，例如，說明有哪些付費
方法及付費協定可供選擇。 
14. TPO Selection Block：  
   <!ELEMENT TpoSelectionBlk (BrandSelection) > 
   <!ATTLIST TpoSelectionBlk 
    ID                 ID      #REQUIRED > 
用於回應的是在 Trading Protocol Options Block 中所做的選擇。 
15. Ping Request Block：  
   <!ELEMENT PingReqBlk ( Org* ) > 
   <!ATTLIST PingReqBlk 
    ID                 ID      #REQUIRED > 
用於確認對應交易角色是否正常運行，與雙方所使用的加解密法是否
相容。 
 
12 
5 
Add provisions to indicate and handle a payment protocol not 
tunneled through IOTP. 
6 Add support for server based wallets. 
7 Support Repeated/ongoing payments. 
8 Enhanced Server to Server messages. 
9 
Include the ability to add both fields and attributes to existing 
trading blocks in addition to the present ability to add entirely 
new trading blocks. 
我們認為 IOTP V.1 未考量 B2B 交易模式，使得它無法適用國際貿易。因此
我們認為 IOTP 應當提供國際貿易解決方案，使得 IOTP 能跨向 B2B 應用領域。
在擴展 IOTP 的設計方面，我們的設計達成的目標，其中包括： 
 國際貿易具有多元性的付款方式，我們的設計能動態定義與處理交易流
程的特性。(表 1 第二點) 
 我們的付款方式設計，將以信用狀交易為主，並且改善原有 IOTPv.1 中
無法確認實際付款流程的缺點。(表 1 第五點) 
 我們認為原有欄位格式無法滿足國際貿易的需求，因此我們也將新增欄
位定義。(表 1 第九點) 
為了確保我們新增的欄位格式，符合 IOTP 設計架構，我們先對規格書中提
到，新增欄位格式應注意事項加以研究。在規格書中指出，目前與未來版本的
IOTP 協定都允許使用者藉由以下的兩種機制來新增與擴展 IOTP，分別是：1.擴
展 XML element，或是 2.在已有的 IOTP code 中增加新的值。 
並且我們可將擴展的 XML element 增加於以下幾種 IOTP 的階層中。 
 新的 Trading Block 
 新的 Trading Components 
 Trading Component 中新的 XML element 
而這些新增的 Element 且必須符合以下的條件： 
 任何新的 XML element 的宣告都必須符合 [XML Namespaces] 
( http://www.w3.org/TR/REC-xml-names)中的規定。 
 不論是在 Trading Block 層或是 Trading Component 層所新的 XML 
element 都必須含 ID attributes 作為該 ID 的屬性名稱。 
依據以上的設計要點，我們設計出一套符合規定的，並適用於國際貿易的
IOTP 協定，進而達成我們開放性 B2B 國際貿易流程設計的設計目標。 
 
14 
 
圖 4、國際貿易主要交易流程 
其中各個步驟的意義分別如下： 
1. 下訂單及確認 
買賣雙方經過合約交涉與洽談之後，買方正式下訂單給賣方。 
2. 申請開立信用狀 
出口商為確認進口商訂單，要求進口商提供銀行信用狀做為付款保證。 
3. 貨物出口前應完成之事宜 
當貨物生產之後，出口商開始做出貨準備。一方面會要求檢驗單位協助對
產品品質查驗並開具證明，一方面洽訂船位，以及貨物運輸的保險事宜。 
4. 辦理貨物出口通關事宜 
貨物從出口商工廠運送到港口或貨櫃場，在海關進行出口報關。出口報關
需要繳交：出口報單、輸出許可、包裝明細、商港服務費等。 
5. 辦理貨物出口裝運事宜 
當出口貨物完成報關，海關放行之後，船公司即接手該批貨物，貨物上船
開航之後，出貨人就能經由貨物通關系統向船公司索取提單 (Bill of 
Lading)。 
6. 出口押匯 
出口商 進口商 進口銀行出口銀行 運輸業 海關 保險業 
1.下訂單
要求開立信用狀 
開出 L/C 
通知 L/C 
5.出貨 
4 出口通關 
申請押匯 
墊付貨款 
進口贖單 
取回貨運單據 
10.取貨 
9. 進口通關 
2.申請信用狀
6.出口押匯 
3.出口前準備 
7.接受押匯 
8.進口贖單 
16 
因此，我們的設計重點，在於支援國際貿易信用狀的「申請信用狀」、「出口
押匯」、「進口贖單」三個流程，在符合 IOTP 架構下，加以擴展並設計出合適的
交易流程。 
3.1 Payment Instruction Block 的設計 
在設計「申請信用狀」、「出口押匯」、「進口贖單」相關流程之前，需定義這
三個步驟中所要傳遞的 IOTP 訊息格式，以利我們後面的流程設計。在參考 IOTP 
v.1 的相關訊息格式設計後，我們發現在就目前已定義的 16 個 Trading Block，
並不能滿足此處國際貿易的交易需求與信用狀交易的付款方式，因此我們於
IOTP 中新增一個 Trading Block 之定義  ，增加代表付款指示的「Payment 
Instruction Block」(如圖 5)。 
 
圖 5、IOTP 架構原有區塊與新增區塊圖 
為了使我們設計的 Payment Instruction Block 在加入 IOTP 後能夠正常運作，
我們必須要設計的是 Payment Instruction Block 的格式與參數，以及利用 Payment 
Instruction Block 來設計可行的交易流程。目標就是讓 IOTP 能支援進口商與銀行
Error Block (optional)
IOTP Message 
Trans Ref Block
Signature Block (optional)
Trading Block
Trading Block
…
 
原有定義
AuthReqBlk  
AuthRespBlk  
AuthStatusBlk  
CancelBlk  
DeliveryReqBlk  
. 
 
TpoBlk  
TpoSelectionBlk 等 16 個 Blocks 
我們規劃新增一個 
Payment Instruction Block 
18 
 
二、 Payment Instruction Exchange Block 
<! ELEMENT PayInstrExchBlk (TradeSchemeData+) > 
<! ATTLIST PayInstrExchBlk 
ID         ID           #REQUIRED> 
包含付款指示過程中需要交換的訊息。 
其 Attribute 包含了： 
ID 識別各個 Payment Instruction Exchange Block 的獨一無二鑑別碼 
其 Content 包含了： 
TradeSchemeData Trade Scheme Component 包含在執行交易時使用
的 Payment Scheme 及其 Payment Protocol 資訊，其
格式如前述定義。 
三、 Payment Instruction Response Block 
<! ELEMENT PayInstrRespBlk (Status, PayReceipt? , TradeSchemeData?, 
PaymentNote?, TradingRoleData*) > 
<! ATTLIST PayInstrRespBlk 
ID         ID           #REQUIRED> 
包含了回應付款指示最後處理結果相關訊息。 
其 Attribute 包含了： 
ID 識別各個 Payment Instruction Response Block 的獨一無二鑑別碼
其 Content 包含了： 
Status Status Components 表示這次的處理是成功或失敗。 
PayReceipt PayReceipt包含可用來驗證交易是否真正被成功執行
的相關驗證資料。 
<!ELEMENT TradeSchemeData (PackagedContent+) > 
<!ATTLIST TraedSchemeData 
ID              ID          #REQUIRED 
TradeStateRef     NMTOKEN  #IMPLIED 
UserId           CDATA      #IMPLIED 
BankId           CDATA     #IMPLIED 
ContentSoftwareId  CDATA     #IMPLIED > 
20 
 
圖 6、信用狀開立流程 
1. 進口商利用網站訂購或是其他方式向出口商提出訂貨的相關要求(offer 
information)。 
2. 由此開始進入 IOTP 的流程，出口商與進口商進行認證，包含了 Authentic 
Request、Authentic Response 與 Authentic State。而此處依循 IOTP v.1 既有
的 Authentication Document Exchange 設計。 
3. 依照 IOTP 既有的設計，出口商送出 TPO(Trading Protocol Options)，提供
能接受的各種付款方式供進口商選擇。 
4. 進口商選擇使用信用狀作為付款方式，並將其訊息以  TPO Selection 
( IotpMsg: Trans Ref Block ; TPO Selection Block ) 傳送出口商。 
5. 出口商此時即會將處理信用狀交易的相關訊息，以 Offer Response 
( IotpMsg: Trans Ref Block ; Signature Block ;Offer Response Block ) 回應
給進口商。 
6. 完成前面的五個步驟 Payment 方式的選擇，進口商確認 Offer 的訊息正確
無誤的之後，即開始進行付款指示的認證與資訊交換等相關交易步驟。 
前述第一至第五步驟，與一般的 IOTP 交易相同，主要目的是做商品的訂購
與付款方式的選擇。到了第六步驟，因為國際貿易與一般電子商務交易的付款方
式的不同，採用我們設計的 Payment Instruction Block，將 IOTP 應用於國際貿易
進口商 
進口商銀行 出口商銀行 
出口商 
2.Authentic Request 
Authentic Response 
 
Authentic State 
1.Offer information 
3.TPO  
4.TPO Selection 
5.Offer Response
Payment Instruction Request
Authentic Exchange 
Payment Instruction Exchange 
Payment Instruction Response 
Notify L/C 
6. 
22 
 
圖 7、出口押匯流程 
1. 出口商提出押匯要求。 
2. 出口商與出口商銀行進行認證，此處依 IOTP v.1 的 Authentication 
Document Exchange 設計。 
3. 進行與押匯相關的資訊交換等交易步驟。 
4. 取得貨款。 
5. 傳送相關文件，並通知進口商銀行償還代墊款項。 
在第三步驟「進行與押匯相關的資訊交換等交易步驟」中，主要是出口商應
備齊信用狀與信用狀中所指示的相關文件，向進口商銀行押匯取得貨款，也就是
利用單據換取貨款的動作。在此可以利用我們先前定義的 Payment Instruction 
Block，來進行出口押匯的 Request、Exchange、Response 處理，說明如下： 
1. Payment Instruction Request Block 
在此利用 TradeState 的參數來指示進行「出口押匯」，並以 Org 與
TradingRoleData 指示交易的角色、進口商及進口商銀行名稱。 
2. Payment Instruction Exchange Block 
利用 TradeSchemeData Component 進行押匯所需的資料交換，細節由銀行
依其進行押匯步所需的資料來設計其流程，或可參考後面我們提出的設計
建議。 
3. Payment Instruction Response Block 
回應給出口商指示此次的押匯交易是成功或失敗，並通知其貨款取得或是
再次進行出口押匯的動作。 
出口商 出口商銀行 進口商銀行 
2. Authentic request 
Authentic response 
5. (Document sg | Bank sign ) 
Authentic state 
1. Request negotiation 
Payment instruction exchange 
Payment instruction response  
4. Financing 
3. Payment instruction request 
24 
Document Exchange 設計。 
3. 進口商銀行送出 TPO(Trading Protocol Options)提供進口商選擇能接受
的各種付款方式供。 
4. 進口商選擇付款方式並將其訊息以 TPO SELECTION ( IotpMsg: Trans 
Ref Block ; TPO Selection Block ) 傳送給進口商銀行。 
5. 進口商銀行此時即會將進行付款所需的訊息傳送給進口商。 
6. 完成前面的五個步驟付款方式的選擇，進口商確認相關訊息正確無誤，
即開始付款認證與資訊交換等相關交易步驟。 
7. 完成付款，進口商要求銀行遞送單據。銀行完成遞送動作後，進口商即
取得單據。 
在整個進口贖單的處理過程，進口商目的是付款給銀行贖回相關單據。因此，
在我們的設計中，是將進口商欲贖回的相關單據視為 IOTP 所定義的買賣貨品，
所以這七個步驟設計是符合 IOTP v.1 的精神，也就是將銀行視為零售商、付款
系統商與貨運業者的綜合角色，而進口商則為顧客的角色，向銀行購買欲贖回的
相關單據，所以付款程序必須符合原有的 Payment Exchange 流程(也就是前述的
第六步驟)，而貨品交付程序則必須符合原有的 Delivery Exchange 流程(也就是前
述的第七步驟)。 
3.3 信用狀交易流程細節設計 
前述的「信用狀開立」、「出口押匯」及「進口贖單」，主要程序大致上都是由
Payment Instruction Request要求開始信用狀交易、由Payment Instruction Exchange
進行相關訊息交換並最終達成交易、而由 Payment Instruction Response 回傳交易
結果的訊息。而為了能簡要明白的闡述我們的設計精神，尚未對 Payment 
Instruction Exchange 中應該進行哪些訊息交換做更清楚的說明。不過，我們認為
要將國際貿易融入 IOTP，一定要將 Exchange 的細節再定義出來，因此在這一節
對「信用狀開立」、「出口押匯」及「進口贖單」這三步驟中所該進行的交易細節
提出設計建議。 
3.3.1 信用狀開立 
信用狀開立的主要流程是：進口商向開狀銀行提出申請；銀行經過初步調查
之後同意開狀申請；在經過適當的徵信與驗證程序後，才進行信用狀開立的動
作；開狀銀行首先將詢問所需開具的信用狀類型，之後再將所需具備的相關表格
與欄位交給進口商；進口商完成填表，銀行對表格內容以及其信用額度是否符合
進行查驗，如查驗結果符合規定，即以銀行間的交易系統將信用狀傳送給出口商
銀行，並副本傳回給進口商存查；接著出口商銀行通知出口商關於進口商的信用
狀已經開立完成，因此出口商就能開始做出貨準備動作。 
所以，我們針對信用狀開立的 Exchange 流程細節，提出如圖 9 中的 2.1 至
2.7 步驟：  
26 
3.3.2 出口押匯 
出口商銀行接受出口商的押匯純然是幫進口商銀行先行墊款融資給出口商
的行為，銀行必須先檢查進口商的押匯額度，餘額必須大於出口商所要求的押匯
金額才能答應出口商進行出口押匯。而進口商辦理押匯需要備齊的文件，包含商
業發票、包裝明細、船公司發給的提貨單、保險公司發給的保險單或保險證明，
要提示這些文件給銀行後，才能獲得墊付信用狀上的貨款。而銀行接受押匯後，
取得相關文件以便向進口商銀行要求償還墊款。 
所以，我們針對出口押匯的 Exchange 流程細節，提出如圖 10 中的 2.1-2.3
步驟： 
 
圖 10、出口押匯的 Exchange 機制 
當出口商要求押匯，首先把信用狀號碼、開狀銀行名稱、及相關的文件資訊
給出口商銀行，經過一連串 Exchange 步驟核實無誤即可付款給出口商，而其中
Exchange 步驟的設計意義，說明如下： 
2.1. 銀行要求出口商提供信用狀相關資料。 
2.2. 使用者將電子信用狀傳送給銀行，並提供符合內容之相關證明文件。 
2.3. 銀行對信用狀以及相關資料進行核實檢查。 
在現實狀況中，上述步驟的細節須依銀行作業流程仔細設計，而我們在此
只提出各角色的互動步驟中必須注意的認證與訊息交換，希望提供將來做更進一
步以 IOTP 實作之參考。 
3.3.3 進口贖單 
Response 
Exchange 
Request 
出口商 押匯銀行 
1. ask : ( L/C # || Bank ) 
2.1. ask info ( L/C Message || Draft || Document ) 
2.2. info ( L/C Message || Draft || Document ) 
2.3.Check L/C Message 
3. ok / not ok 
 Financing 
28 
 
四、單據適法性與合約相關規定查驗 
接者，銀行相關承辦人員應該對信用狀及其相關單據，是否有違反法
律，或是相關事項(如交貨時間等)是否與信用狀及合約規定相符，確定
交易無違法及滿足合約要求之後，即能押匯給出口商，出口商即能獲
得融資獲取回貨款。 
 
 
我們設計的 Payment Instruction Block 繼承了 IOTP 中對於 Signature Block
等所擁有的相關安全性設計，並且依國際貿易信用狀交易的需求，加入相關文件
認證及核實機制，使整個交易流程的安全性，得以獲得保障。 
我們簡單的說明一下安全性的保障，例如在傳送途中如果有惡意使用者，
置換了 Payment Instruction Exchange Block 裡面的 TradeSchemeData，那麼再第
二步驟的查驗 IOTP 訊息，就能藉由比對 Signature Block 中的 Payment Instruction 
Block 的 TradeSchemeData 的摘要值而被查驗出來。另外如果出口商利用偽造信
用狀想獲取更大利益時，可以於第三步驟中檢查信用狀的簽章值時被發現。或者
進口商使用非本次交易相關單據，例如出口商尚未出貨，但想利用別筆貨物提單
取得貨款，此時利用相關單據的一致性與相關性的核實系統即能發現此錯誤。 
因此，能夠利用我們新增 IOTP的Payment Instruction Block來達到擴展 IOTP
於國際貿易 B2B 交易，並且我們的設計不但繼承了中對於 Signature Block 等所
擁有的相關安全性設計，更加入相關文件認證及核實機制，符合國際貿易信用狀
交易的相關需求，使整個電子商貿得以使用 IOTP 來進行，並且整個交易流程的
安全性都能獲得保障。 
 <IOTP> 
SAFDFDF
IOTP Message 
TransRefBlk 
Signature 
PayInstrExchBlk 
<TradeSchemeData ID= ‘C.2’> 
 
 
 
 
</TradeSchemeData> 
信用狀 
提單 
ˇ信用狀開立者 
ˇ信用狀有效 
ˇ提單開立者 
ˇ提單有效 
圖 11、單據查驗示意圖 
30 
統與架構，才能有最大的相容性與通用性。在此我們所規劃的系統是將 IOTP
標準加以延伸設計，使其合乎國際通用的標準，確保了通用性與相容性。並
由於 IOTP 是使用 XML 格式定義，因此我們的設計在與目前現有的系統也
能做方便的轉換，達到最高的相容性。 
四、交易安全性的保障 
我們所設計的 Payment Instruction Block 中，對於安全性有諸多的考慮與設
計。我們的設計以 IOTP 為基礎，因此繼承了 IOTP 所擁有的相關安全性設
計，並且依國際貿易信用狀交易的需求，加入相關認證及核實機制，說明如
下： 
1. 利用 IOTP Msg 簽章確認 IOTP 交易處理是由正確的角色執行。 
在 IOTP 中的 Signature Block 具有可提供認證的相關資訊，因此藉
由查證每筆 IOTP Msg 中 Signature Block 裡的簽章值，就可以確定
目前進行交易步驟的角色身分，以及交易角色所執行的步驟是否合
法，因此能確保每一筆接收與處理的 IOTP Msg 是正確與合法的。 
2. 利用對文件的簽章確認內容與發行者真偽。 
我們設計的貿易相關文件格式之中，有加入發行者的簽章的欄位。
使得文件的接收者，或是銀行都能對文件與發行者的真偽加以驗
證。 
3. 利用銀行的文件核實系統來確認文件的相關性與正確性。 
在傳統國際貿易中，銀行須以人工方式做單據查核。以傳統人工作
業方式來說，銀行審核時間約在十天以上，對廠商而言相當不符合
成本效益。因此，我們的設計在單據核實這方面，提出適當的自動
文件核實系統的設計準則與建議，藉由分析各單據中特定欄位的內
容是否具有一致性與相關性，即能確定信用狀與所附的相關文件是
否符合基本的規定，使用文件核實系統能協助銀行對信用狀交易的
相關單據查驗，將可大大降低成本與增進效率，並能減少人為疏失。 
五、擴展 IOTP 的應用範圍 
我們的設計的 Payment Instruction Block 與其欄位定義，是符合在 IOTP 中新
增元素的設計規範。並且我們使用它來設計交易流程，滿足 IOTPv.2 提議的
需求，改善了 IOTPv.1 只以 B2C 交易模式為主要考量，而不考慮其他電子
商務模式的差異性的缺點。使其能支援國際貿易流程，並且提升效率與強化
安全稽核，即可讓 B2B 電子商貿之資訊流、金流、物流的運作可完全的在
網際網路上進行。 
 
 
32 
第六章 第一年研究成果自評 
在傳統的國際貿易的交易流程相當繁雜，向來需要專業的貿易人員以及報關
行，協助進出口商進行各項交易步驟，由於其中有多項交易相關單據與步驟仍依
靠人工作業製作執行，或是必須花費人力進行單據查驗。這些大量的人工單據作
業，往往曠日費時，並容易因人工作業的錯誤，使交易失敗而造成重大損失。因
此目前各國無不積極研究改進方法，希望能增進貿易速度，提升競爭力。但目前
貿易環境仍只達到部份流程電子化，尚無完整的電子化流程規劃。因此我們提出
研究使貿易流程能全面的電子化。 
我們的交易訊息設計與流程規劃是以IOTP v.1這種開放式貿易協定作為基
礎，並將其延伸使其能夠支援國際貿易中的信用狀交易模式，進而改善了原有
IOTP v.1中只支援B2C，以及金流系統效率與安全性不佳的缺點。 
雖然我們花了不少精神在釐清貿易流程，並將其電子化。但是在本計畫中
交易的安全一直是我們關注重點。在我們的設計中，藉由 IOTP 訊息中簽章區塊
來驗證傳送者的身分；使用信用狀及相關單據中的發行者簽章，來驗證文件的發
行者與文件的真偽；建立文件核實系統，確保信用狀與相關單據內容的是合法且
正確無誤。因此利用由單一訊息驗證到單一文件驗證，而到最後能將所有單據互
相驗證核實的這種環環相扣的關係，能達到對於交易角色與交易相關文件的認
證，確保交易的正確性與安全性，更改善了 IOTPv.1 中無從規範金流運作的安全
與效率，以及付款閘道協同運作的過程中，可能產生的效率與安全性問題。 
本計畫雖無真正實作系統，但希望透過整個設計的概念及過程，包括交易過
程及步驟分析、交易角色的定義、流程設計、格式的分析定義與交易角色應該具
備的訊息處理流程等等的設計概念，希望日後能參考我們的設計概念，進而設計
出IOTP的相關應用軟體。 
將來若能將我們的設計概念加以延伸，進一步規劃設計出符合貿易實務的各
種流程。就能使IOTP更廣泛的支援各種B2B的國際貿易流程與付款機制，並且使
其能更廣泛的應用。當然除了B2B之外，尚有C2C、P2P等各種交易型態，也都
能利用相似的概念發展相關的交易系統，使得各種交易都能在IOTP所建立的開
放性貿易協定的標準環境下建構出更多具有公平與安全的電子商貿環境。 
基於以上說明，我們的研究成果確實符合原計畫所預訂達成之目標，而研
究成果具有學術價值，已經以「以IOTP建構安全的國際貿易B2B電子商務系
統 – 以信用狀為例」為題發表於第三屆流通與全球運籌論文研討會。而本研究
的應用價值在於提出完全符合IOTP規範的擴增設計，若未來能被考慮引用我們
的設計精神，將能使IOTP能夠支援國際貿易中的信用狀交易模式，進而改善了
原有IOTP v.1中只支援B2C，以及金流系統效率與安全性不佳的缺點。而由於本
研究是設計符合IOTP規範，不應申請專利而妨礙其開放性。 
34 
約的流程予以電子化，並不能消弭彼此的不信任立場，也就無助於契約的實施運
作了。 
所以，以往這方面的研究[2, 7, 13, 14]，就有學者提到如何考量實施契約電
子化、自動化的環境架構，如下圖所示： 
 
圖 12、電子化契約的運作環境 
並且不同的交易模式，會有不同的簽訂契約模式，據我們的瞭解是這樣的： 
1. Just-in-time Contracting(又稱為τ -contracting)： 
在講求快速撮合的交易市集，買賣雙方的關係通常是到最後一刻才
確定，所以如果要在這樣的環境下建構電子化契約機制，快速效率
是最重要的條件。 
2. Micro Contracting(又稱為μ -contracting)： 
在交易產品價值不高或交易量不大的情況下，買賣雙方仍須契約的
保障，但是契約的機制必須成本不高。 
3. Precision Contracting(又稱為π -contracting)： 
在大宗交易的情況下，買賣雙方最重視的是契約品質，所以在這種
環境下建構電子化契約機制，必須在契約的設計上精確細緻，才能
獲得信賴。 
4. Enactment Contracting(又稱為ε -contracting)： 
在 EDI 或通關自動化系統這些環境下，一些契約過程是被要求必
須自動化的，所以如果要在這樣的環境下建構電子化契約機制，所
有自動化流程的整合與安全問題必須加以考量。 
更進一步探究，我們瞭解買賣雙方簽訂契約的過程，又可以細分為下列的階
段： 
Store 
Certificate Authority
Standard Contracts / Template
Financial 
user 
36 
不管是前面所提到的哪一種模式，契約簽訂過程中，買賣雙方皆會耗費相當
多的精力在契約條件協商(negotiation)上，以取得一致的協議。因此我們在電子
契約簽訂流程中，利用了代理人（Agent）的機制，作為契約簽訂雙方在進行資
料傳送、協商溝通、與契約簽訂時之代理工具。所以在第二年度的重點，我們找
出可通用於各種契約形式的通用協商機制，來加速整個契約簽定的過程。也就是
我們將針對契約簽訂過程中的核心部分，利用行動代理人的優點與特性，幫助買
方能夠進行簽約動作。 
7.2 行動代理人介紹 
所謂代理人 (Agent)[6,10,11,12,22,26,28,29]，是一個小型的智慧型程式
（Intelligent Programs），漫遊在網路之中。它們從使用者身上接收其命令與任
務，然後遊走在網路之中的各 Host 端來完成其任務與工作。行動代理人的工作
可以是收集資訊、回報問題、執行運算、或是更改修正現存程式等。並有學者指
出[6]代理人具有以下的特性與優點。 
1. 降低網路的負載（Reduce the network load）：行動代理人可以藉由
攜帶程式碼與必要的資料到另一個Host 端進行運算處理，來取代
在網路上傳送整個資料。如此能有效減少資料傳送的流量與頻率。 
2. 克服網路的延遲（Overcome network latency）：因為行動代理人不
需要大量的頻寬。因此在即時系統中，可以利用行動代理人來有效
控制與傳達與使用者的指令與指示。 
3. 封裝所使用之協定（Encapsulate protocols）：行動代理人能夠在遠
端的Host端，建立起一個行動代理人私有的通道（Channel），來
幫助代理人之間彼此相互的溝通協商。 
4. 非同步化獨立自主的能力（Execute asynchronously and 
autonomously）：這所謂非同步化的概念是指。當行動代理人被賦
予任務，傳送到遠端Host 端後，行動代理人便擁有獨立自主的能
力。即使行動代理人的使用者離線，行動代理人還是能繼續工作並
可稍後再取回所傳送出去的行動代理人。 
5. 動態適應新的環境（Adapt dynamically）：行動代理人依照他所身
處的執行環境，並且適當的自我調整與反應，保持最佳的設定來解
決處理問題。 
6. 異質特性（Naturally heterogeneous）：網路中擁有許多的異質環境，
包含網路中軟硬體設備，而行動代理人依靠中介處理的平台能很順
利在異質的環境中工作。 
7. 強健且具有容錯能力（Robust and fault-tolerant）：行動代理人具有
容錯的能力。例如：當Host端即將關閉時，行動代理人會作出調整，
遷移到下個Host端繼續它的拜訪行程。 
38 
第八章  我們提出的安全契約簽署行動代理人設計 
 在這章節中，將介紹我們所提出的方法。在我們的設計中，共有四種角色牽
涉其中，我們將各角色簡述如下: 
+ 
 
 憑證管理中心: (Certification Authority，CA)。具公信力第三者(Trusted 
Third Party) ，對系統中的參與角色提供認證及憑證簽發管理等服務，
以建立具有機密性、鑑別、完整性、不可否認性、接取控制及可用性而
的資訊通信安全環境與機制。 
 買方: 訂購商品或服務的買方。 
 賣方 : 提供商品與服務之商店。賣方將會與買方針對雙方之交易行為
進行電子契約簽訂之動作。電子契約中商品的內容與銷售金額、數量等
產品資訊，皆由賣方所提供。 
 代理人服務提供平台:為買方提供代理人服務，並且在買賣雙方進行契
約協商時，擔任契約協商公正平台的角色。 
在我們的設計中，相較於一般設計所不同的特色是我們加入了代理人服務提
供平台的角色。藉由代理人服務提供平台這個中介角色的加入，我們的設計能防
止惡意的賣方藉機竊取買方代理人中所夾帶的資訊，或是由買方藉機竊取賣方代
理人夾帶訊息等，雙方互相竊取對方的機密資料的情況產生。並且在我們的設計
中代理人服務提供平台發行兩種任務導向的代理人(mission-oriented agent) ，賣
方發行一種任務導向的代理人進行相關交易動作並說明如下:  
(1) 邀約代理人 (Invite Agent): 攜帶買方的交易需求，並且在各賣方平台
中移動，以尋找符合買方需求的賣方的代理人。此代理人將會邀請符合
需求的賣方發行代理人到代理人服務提供平台 平台上進行契約協商。 
(2) 協商代理人 (Negotiation Agent ): 攜帶買方的契約協商條件，並為買方
與賣方代理人進行契約條件的協商工作。 
圖 15、基本架構
代理人服務提供平台 
賣方 
買方 
憑證管理中心 
40 
 
圖 16、通知階段 
Step 1: 在申請使用代理人服務提供平台的服務前，買方必須準備他的憑證 
CCert ，購買需求 CREQ ，協商規則 CNRule 與交易時限 TC。另外，買方
必須將其私鑰拆分成兩個部分私鑰(partial private keys) 1Cd 與 2Cd 並部分
私鑰的產生方法如下: 
)( mod21 Cccc nddd φ+=  
接著，依據這兩個部分私鑰(partial private keys) 1Cd 與 2Cd 計算出相對應
的公鑰如下: 
)( mod111 Ccc nde φ−=  與 )(mod122 Ccc n de φ−=  
買方將訊息 ( CCert , Cn , 1Ce , 2Cd , CREQ , CNRule ,TC) 傳送至代理人服務
提供平台。 
 
Step 2: 代理人服務提供平台收到訊息，首先驗證買方的憑證 CCert 確認買方身
分的合法性。接著，計算出代理人服務提供平台對這次交易所發行的
保證書 CVou  如下: 
 )( 1cdC eSVou AH=  
代理人服務提供平台指派這次交易一組交易序號 SN 與產生其相對應
的簽章 ),( CdREQ REQSNSSG AH= 。  
代理人服務提供平台將訊息 ( SN ,VouC, SGREQ ) 送回給買方。  
 
CCert , Cn , 2Cd , 1Ce , CREQ , CC TNRule ,  Generate )( 1cdC eSVou AH=  , SN 
Generate ),( CdREQ REQSNSSG AH=  
Create IA,NA 
CAHREQCC TCertSGVouREQSN ,,,,,  
REQC SGVouSN ,,  
:SN, MSG, SGMSG ,K1 ,CertS 
買方 代理人服務提供平台 賣方 
IA
SA
42 
8.2 協商階段(Negotiation Phase) 
在這個階段，當各賣方所派出的賣方代理人到達代理人服務提供平台時，將
會依照各賣方代理人上所攜帶的交易序號 SN 訊息分配給相對應的協商代理人。 
賣方代理人與代表買方的協商代理人在代理人服務提供平台上進行「報價與
還價(offer-counter-offer)」式協商。當進行「報價與還價」式協商時，賣方代理
人將會提出條件，協商代理人將會依其所攜帶的買方協商規則同意或否決賣方代
理人所提出的交易條件，如果賣方代理人所提出的交易條件被否決，則賣方代理
人將會依其所攜帶的交易條件列表，一步一步的依序揭露各式交易條件與協商代
理人進行協商，直到達成協議或由某方終止協商為止。 
在我們所設計的協商階段中，我們所設計的協商模式是採用單邊不確定
(one-side uncertainty) [25]的形式。在此模式下，協商代理人握有買方對於某項商
品或服務的協商規則，也就是買方可否接受賣方代理人對其所欲購買之商品或服
務所提出的交易條件的完整資訊。而相反的賣方代理人並無法預測買方協商代理
人是否會接受其所提出之供貨條件，而必須依照預先設計好的交易條件列表，一
筆一筆揭露協商條件。我們所使用的這種協商機制，能使買賣雙方都能達到其所
設定的最佳條件。我們所設計協商機制是按部就班的進行討價與還價，其執行步
驟如圖 3 所示並說明如下。  
 
圖 17、協商階段 
 
Step 1: 當任何一個賣方代理人到達代理人服務提供平台時，代理人服務提供平
台會驗證賣方代理人所攜帶的憑證 SCert 與簽章值 SGMSG藉以確認其合
法性，並會依其所攜帶的交易序號 SN 指派給對應的協商代理人。 
 
NA SA
「報價與還價」式協商 
代理人服務提供平台 
Z[1] 
C[1] 
B[1] 
Certs , SGMSG 
Does it meets NRule ? 
Accept 
Reject 
44 
 
圖 18、契約簽署階段 
 
Step 1: 買方傳送其憑證 CertC與交易序號 SN 到代理人服務提供平台。 
 
Step 2: 代理人服務提供平台收到買方的訊息，並驗證買方的憑證 CertC後，代
理 人 服 務 提 供 平 台 將 其 所 蒐 集 到 的 協 商 訊 息  
}|])[,,{(  message bid all foriBContractCerts  傳送給買方。 
 
Step 3: 買方可由訊息中選擇一個或數個賣方進行簽約。進行簽約前，買方利用
他的部分私密金鑰(partial private key) dc1簽署契約並產生他的部分簽章
(partial signature)
1_ CCnt
SG 如下: 
])[,(
11_
iBContractSSG
CdCCnt
=  
買方將訊息(
1Cnt_Ccc
SGB[i],Contract,,Vou,Cert )傳送給欲簽約的賣方。 
 
Step 4: 當賣方收到簽約訊息(
1Cnt_Ccc
SGB[i],Contract,,Vou,Cert )後，首先會對買
方的憑證進行認證，接著賣方藉由代理人服務提供平台所發行的保證書
C Vou 來計算出相對應 1_ CCntSG 的買方的部分公鑰(partial public key) 1Ce
SNCertC ,  
1Cnt_Ccc
SGB[i],Contract,,Vou,Cert
}|])[,,{(  message bid all foriBContractCert s
SCntSG _
Verify 
CCert , AHe C1c Voue =  
][,(
?
1_1
iBContract   )SGV CCnteC =  
CCntSG _
賣方 代理人服務提供平台 
賣方 
46 
 
圖 19、爭執解決階段 
Step 1: 假設賣方已經將 SCntSG _  給買方，但卻沒有收到買方的完整簽章
CCntSG _ 。 此 時 ， 賣 方 已 經 在 交 易 過 程 中 得 到  (SN, 
VouC, ][, iBContract , 1_ CCntSG )訊息。為了彌補不正常結束的交易步驟，
賣方將這訊息 (SN, VouC, ][, iBContract , 1_ CCntSG ) 、其對與此筆交易的
完整簽章 Cnt_SSG 與其憑證 SCert 傳送給代理人服務提供平台，由代理
人服務提供平台來補正交易。 
 
Step 2: 當代理人服務提供平台收到訊息之後，它會利用賣方的公開金鑰驗證
此筆交易的完整簽章 SCntSG _ 是否正確，如下: 
 )( _ SCnte SGV S
?= ])[,( iBContract  
並且藉由 VouC，代理人服務提供平台能找出對應的部分公鑰(partial 
public key) C1e  來驗證買方對於此交易的部分簽章 1_ CCntSG  如下: 
])[,(
?
1_ iBContract )SG(V CCntec1 =  
SSCntCCntc CertSGSGB[i],Contract,,SN,Vou ,, __ 1
 
SCntSG _  
Verify
])[,()(
?
_ iBContractSGV SCnteS =  
])[,()(
?
1_1
iBContractSGV CCnteC =  
Generate 
])[,(
22_
iBContractSSG
cdCCnt
=  
NSGSGSG CCntCCntC mod. 2_1_=  
CCntSG _
買方 代理人服務提供平台 賣方 
48 
第九章 第二年研究結果與討論 
 
我們設計了一個基植於可信賴第三方的代理人服務提供平台之電子契約協
商機制。接著，我們將分析這機制是否達到以下的安全性需求。 
 
9.1 匿名性(Anonymity) 
 在我們的設計中，如果不進行正式簽約，賣方能竊取買方資訊的唯一機會就
是藉由竊取邀約代理人所夾帶的訊息來達此目的。但在我們的設計中，邀約代理
人只會攜帶與隱私無關的訊息( AHREQCC CertSGVouREQSN ,,,, )。因此不會對匿名性
造成破壞。或許有人會懷疑 CVou 隱含買方的某種形式的私密訊息而破壞了匿名
性，但是事實上，在 Notification Phase 的 Step 1 中，每次交易時，買方都會隨機
的將私鑰拆分兩個部分私鑰，因此 CVou 與 Cd 的關係並不會固定，而是依每筆交
易都有不同，因此在 Notification Phase 中我們的設計是符合匿名性的要求的。 
 
9.2 不可偽造性(Unforgeability) 
我們的設計滿足不可偽造性(Unforgeability) ，每一筆訊息都會被恰當的驗
證，因此整個交易不會被惡意的干擾。我們將我們設計中的不可偽造性說明如下: 
 
z 通知階段的不可偽造性(Unforgeability in Notification phase) 
在 Notification phase 的 Step 2 中代理人服務提供平台簽署了 REQSG  與
CVou 兩個訊息如下 
),( CdREQ REQSNSSG AH=  
)( 1cdC eSVou AH=  
其中 REQSG  代表買方合法性已經被代理人服務提供平台 所驗證，並買方所
要求的服務也已經被認可。另外 CVou 代表買方的交易相關參數與為了回復交
易所使用的買方的部分私鑰 2Cd 也已被託管。因此對於賣方而言，雖然無法
藉由邀約代理人來直接確認交易詢價的請求是由某個合法買方或是用者所
發出，但能確定此交易是合法的由代理人服務提供平台所認證的買方發出。  
 
50 
理人為其取得的契約資訊。但因為這些契約都尚未簽署，因此買方無法
單方面的宣稱契約的合法性或藉此取得不當利益。因此提供契約的賣方
不會造成公平性的疑慮。 
2. 當契約簽署階段正確完成後，買賣雙方都能正確無誤的取得擁有雙方簽
章的契約。買賣雙方都無法否認他倆已經同意此契約相關條款，並且已
簽署契約。因此簽署契約的雙方都不會造成公平性的疑慮。 
3. 當賣方完成契約簽署階段的 Step 4，也就是賣方已經完成契約簽署並簽
章 SCntSG _  已經送交買方。但是買方卻沒有正確的完成契約簽署階段的
Step 5 將其簽章 CCntSG _  送交賣方。賣方依然能藉由提供相關證據給代
理人服務提供平台並要求執行紛爭解決階段的相關步驟來取得買方的
簽章。代理人服務提供平台會執行下面的驗證程序，來證實買賣雙方都
有簽署契約的意願。  
)( _ SCnte SGV S
?= ])[,( iBContract  
])[,(
?
1_ iBContract )SG(V CCntec1 =  
當買方的部分簽章 1_ CCntSG 與賣方簽章 SCntSG _ 都正確驗證無誤，代理人
服務提供平台即能利用紛爭解決階段中的計算方法來完成買方的完整簽
章 CCntSG _ 。 
])[,(
22_
iBContractSSG
CdCCnt
=  
CCCntCCntCCnt n SGSGSG mod2_1__ ⋅=  
並且在完成紛爭解決階段後，代理人服務提供平台會將買賣方彼此的簽
章同步交給買賣雙方，因此簽署契約的雙方都不會造成公平性的疑慮。 
 
4. 如果賣方並沒有完成契約簽署階段中的 Step 4，但卻向代理人服務提供
平台要求執行紛爭解決階段，希望藉此取得買方簽章，不公平的完成契
約簽署。但賣方要求執行紛爭解決階段，也代表其簽章 SCntSG _  雖然沒
有正確送交買方，但卻可由代理人服務提供平台接收並驗證。因此在完
成紛爭解決階段後，代理人服務提供平台會將買賣方彼此的簽章同步交
給買賣雙方，簽署契約的雙方最終都能收到正確簽署的契約，不會造成
公平性的疑慮。 
52 
第十章  第二年研究參考文獻 
1. N. Asokan, V. Shoup, and M. Waidner. “Optimistic fair exchange of digital 
signatures.” In: EUROCRYPT’98, LNCS 1403, p. 591-606. Springer-Verlag, 
1998. 
2. S. Angelov, P. Grefen, “B2B eContract Handling - A Survey of Projects, 
Papers and Standards”, CTIT Technical Report 01-21, University of Twente, 
2001. 
3. S. Angelov, P. Grefen, “An Analysis of the B2B E-Contracting Domain - 
Paradigms and Required Technology”. Telematica Institute Technical Report, 
2003. 
4. M. Bellare, R. Sandhu, “The security of practical two-party RSA signature 
schemes. Manuscript”, http://www-cse.ucsd.edu/users/mihir/papers/, 2001. 
5. ConsumerWebWatch , “A matter of trust: What users want from web sites.” 
Results of a national survey of internet users for consumer WebWatch by 
Princeton Survey Research Associaties. January 2002, Electronic Publication, 
URL:http://www.consumerwebwatch.org/news/report1.pdf, last access: 1st July 
2004. 
6. Denny B. Lange and Mitsu Oshima, “Seven Good Reasons for Mobile Agents,” 
Communications of the ACM, Vol.42, No.3, p.88-89.,1999. 
7. Asuman Dogac, Ibrahim Cingil, B2B e-Commerce Technology: Frameworks, 
Standards and Emerging Issues - Chapter 6 Business-to-Business Electronic 
Commerce Frameworks, http://www.srdc.metu.edu.tr/ . 
8. A.O. Freier, P. Karlton, P.C. Kocher, ”The SSL Protocol Version 3.0”,  
http://netscape.com/eng/ssl3/draft302.txt,1996. 
9. D.L. Hoffman, T.P. Novak, M. Peralta, ”Building consumer trust online”, 
Communications of the ACM, 42, p. 80-85. ,1999. 
10. W. Jansen, T. Karygiannis, “NIST Special Publication 800-19 - Mobile Agent 
Security”, Technical Report MD 20899, National Institute of Standards and 
technologyComputer Security Division Gaithersburg.,1999. 
11. P. Kotzanikolaou, M. Burmester, V. Chrissikopoulos, “Secure Transactions with 
Mobile Agents in Hostile Environments”, In Proceedings of the 5th 
Australasian Conference on Information Security and Privacy, ACISP 2000, 
Springer-Verlag LNCS, Vol.1841, p. 289-297., 2000. 
12. P. Kotzanikolaou, G. Katsirelos, V. Chrissikopoulos, “Mobile Agents for Secure 
Electronic Transactions”, In Proceedings of Recent Advances in Signal 
Processing and Communications, World Scientific and Engineering Society Press, 
p. 363-368., 1999. 
54 
Second USENIX Workshop on Electronic Commerce, USENIX Press, pp. 
29-40,1996. 
28. Changjie Wang, Ho-fung Leung,” Mobile agents for secure electronic 
commerce transactions with privacy protection of the customers”, in: 
e-Technology, e-Commerce and e-Service, 2005. EEE '05. Proceedings. The 
2005 IEEE International Conference on, p 530- 535,2005. 
29. X. Yi, X.F.Wang, Lan Kwok Yan., “A secure Intelligent Trade Agent System”, 
In Proceeding of the Internation IFIP/GI Working Conference, TREC'98, 
Springer-Verlag LNCS, Vol.1402, pp. 218-228.,1998. 
30. J. Zhou and C. Tan ,”Playing Lottery on the Internet, Information and 
Communications Security”, Proceeding of 3rd International Conference,ICICS 
2001,Xian,China,Nov. 13-16, 2001. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
56 
可供推廣之研發成果資料表 
□ 可申請專利  ■ 可技術移轉                                      日期：96 年 10 月 30 日 
國科會補助計畫 
計畫名稱：網際商貿開放協定(IOTP)之安全研究與 B2B 商務應用
(1/2) 
計畫主持人：陳育毅 
計畫編號：NSC 94－2213－E－005－038  
學門領域：程式語言與軟體工程 
技術/創作名稱 以 IOTP 建構安全的國際貿易 B2B 電子商務系統 
發明人/創作人 陳育毅、詹進科、呂俊超 
中文：以電子化的方式做企業間資訊交換的主要優點可以促進商業
自動化，也可以讓商業互動更有效率、更具規模、更加可靠、更為
安全。不過，這需要有標準可以讓企業依循運作，但在 IOTP v.1
只提到在B2C的應用，還不適用於B2B的模式。我們在研讀過 IOTP 
v.2 的規劃需求(RFC3354)之後，結合 IOTP 與 XML 的觀念，針對
國際貿易流程設計出最適當的自動化、電子化的環境，並且提升效
率且強化安全稽核，即可讓 B2B 商貿完全在網際網路上進行，而
在這研究計畫達成電子商貿的完整解決方案。 
技術說明 
英文：Exchanging data electronically has many advantages over 
manual transmission. The most important advantage is the ability to 
automate business processes. Some other advantages are timeless, 
traceability, reliability, scalability and security. Exchanging data 
electronically necessitates standards so that the applications at both 
ends can understand each other. However, the scenarios IOTP version 
1.0 concerned about is taking place in the way consumers and 
merchants trade (B2C). After surveying the requirement of IOTP 
version2 (RFC3354), we find the way to apply the concept of IOTP 
and XML to design the suitable process for Internet trading. In this 
project, we try to figure out the total solution for the automation, 
e-contract, and security control of the Internet trade. 
可利用之產業 
及 
可開發之產品 
國際貿易相關業者、B2B 電子金流服務提供業者等都可以應用我們
的研究，發展出以 IOTP v.1 開放式貿易協定為基礎，延伸支援國際
貿易信用狀交易模式的服務。 
技術特點 
交易的安全一直是我們關注重點，在我們的設計，藉由 IOTP 訊息
中簽章區塊來驗證傳送者的身分；使用信用狀及相關單據中的發行
者簽章，來驗證文件的發行者與文件的真偽；建立文件核實系統，
確保信用狀與相關單據內容的是合法且正確無誤。因此利用由單一
訊息驗證到單一文件驗證，而到最後能將所有單據互相驗證核實的
這種環環相扣的關係，能達到對於交易角色與交易相關文件的認
證，確保交易的正確性與安全性，更改善了 IOTPv.1 無從規範金流
運作的安全與效率，以及付款閘道協同運作的過程中，可能產生的
效率與安全性問題。 
58 
可供推廣之研發成果資料表 
□ 可申請專利  ■可技術移轉                                      日期：96 年 10 月 30 日 
國科會補助計畫 
計畫名稱：網際商貿開放協定(IOTP)之安全研究與 B2B 商務應用
(2/2) 
計畫主持人：陳育毅 
計畫編號：NSC 95-2221-E-005-020- 
學門領域：程式語言與軟體工程 
技術/創作名稱 基植於可信賴第三方的代理人服務提供平台之電子契約協商機制 
發明人/創作人 陳育毅、詹進科、呂俊超 
中文：近年來由於網路科技以及資訊技術的快速發展，帶動了電子
商務的興起，使得許多傳統商務交易行為，都有朝向電子化發展的
趨勢。本研究即針對電子化契約簽定在安全與效率上的不足之處提
出更完善的設計，並且藉由行動代理人技術簡化複雜且費時的交易
契約的協商過程，加速整個契約簽定的過程。提升效率與強化安全
稽核，使電子交易可以在網際網路上安全的進行。 
技術說明 
英文：Because of the characteristics of mobility and autonomy, the 
mobile agent technology is playing an important role in electronic 
commerce on network environment. However, a couple of security 
issues need to be overcome before mobile agents can be employ in real 
life commercial applications. Moreover, a fair contract negotiation also 
included, it is very important to make a contract in E-Commerce 
reduce the risk of transaction. Then it will encourage people to 
purchase on Internet. We present a solution for secure E-Commerce 
transactions base on mobile agent services for balancing the 
performance and the security issue of mobile agent technology. 
可利用之產業 
及 
可開發之產品 
B2C、B2B、C2C 電子商務服務提供業者都可以應用我們的研究，
發展出以行動代理人技術簡化複雜且費時的交易契約協商過程，加
速整個契約簽定的過程，提升效率與強化安全稽核，使電子交易可
以在網際網路上安全的進行。 
技術特點 
電子化契約是電子商務中亟需解決的重要課題，因為利用電子化的
契約不但能夠使交易不受時空限制，而且更能大幅降低成本並且提
升效能。但是契約電子化並非單純的只是將契約條文電子化的問
題，實際上更需要關注的是整個電子化契約能夠運作的環境必須建
構出來，在整個電子化契約簽訂過程中，我們發現買賣雙方皆會耗
費相當多的精力在契約條件協商(Contract Negotiation)上，以取得一
致的協議。因此我們在電子契約簽訂流程中，利用了代理人(Agent)
的機制，作為契約簽訂雙方在進行資料傳送、協商溝通、與契約簽
訂時之代理工具。更重要的是我們在研究了行動代理人與其相關安
全性議題之後，知道行動代理人可能發生的相關的惡意平台攻擊，
而這些都能藉由代理人服務提供平台的機制來加以解決。 
60 
 
以IOTP建構安全的國際貿易B2B電子商務系統-以信用狀為例 
陳育毅 1 詹進科 2 呂俊超 3 
1 靜宜大學國企系 助理教授 
2中興大學資科所 教授 
3中興大學資科所 研究生 
3中興大學資科所資訊安全實驗室 
3E-mail：S9256046@cs.nchu.edu.tw 
摘要 
近年來由於網路科技以及資訊技術的快速發
展，帶動了電子商務的興起，形成了經濟貿易全球
化的趨勢，也擴展了貿易的規模與成長幅度，更加
速了國際貿易的運作。國際貿易(International Trade)
邁向網路化的趨勢，可預期的是網際貿易(Internet 
Trade)的盛行將來到。國際 IETF 組織已制定出網
際商貿開放協定(IOTP)，本文將針對 IOTP 在國際
貿易流程不足之處提出更完善的設計，提升效率與
強化安全稽核，讓 B2B 電子商貿之資訊流、金流、
物流的運作可完全在網際網路上進行。 
關鍵詞：資訊安全、網際商貿開放協定(IOTP)、國
際貿易、B2B電子商務 
1. 簡介 
電子商務的興起，加快了經濟貿易全球化的
步伐，利用電腦網路科技，使企業在處理商務活動
與夥伴間協調合作的過程更有效率，提升商業經營
績效、降低成本、提高服務品質，具備對市場變化
快速反應的能力，提高企業的競爭能力。隨著網路
時代的來臨，傳統國際貿易的交易實務[1,2,3]將因
此產生革命性改變，將來國際貿易(International 
Trade) ， 在 高 度 運 用 資 訊 科 技 (Information 
Technology)之下，會演進為網際貿易(Internet Trade)
的型態為主，於是(The Internet Engineering Task 
Force, IETF) 組 織 制 訂 出 網 際 商 貿 開 放 協 定
(Internet Open Trading Protocol, IOTP)[4]互動架
構，並引起許多學者的注意，發表文章[6,7,8,9]闡
述其運作原理及格式。使在此架構的規範下，網際
網路上進行交易買賣將有統一且公開的標準流程
與 資 料 交 換 格 式 。 其 格 式 定 義 出 四 大 區 塊 ：
Transaction Reference Block、Signature Block、Error 
Block、Trading Block，並逐一制訂出相關的欄位，
如圖 1 所示。  
圖 1. IOTP 架構區塊圖 
自 2000 年 IOTP 提出之後，至今卻未被廣泛
採用，極少有企業用它來建置電子商務系統。於
是，有學者在這方面做了探討[6]，發現主要的原
因如下： 
IOTP Message 
Trans Ref Block 
Trans ID Component 
Message ID Component 
Related To Component 
Signature Block 
Signature Component 
Certificate Component 
Error Block 
Error component 
Trading Block 
Trading Component 
Trading Block 
…
Trading Component 
<<附錄一>> 本研究「以 IOTP 建構安全的國際貿易 B2B 電子商務系統–以信用狀為例」
刊登於第三屆流通與全球運籌論文研討會(Oct 28, 2005). 
62 
四、 Payment Instruction Request Block 
<! ELEMENT PayInstrReqBlk (Status+, Org*, 
TradeSchemeData? ) > 
<!ATTLIST PayInstrReqBlk  
ID         ID          #REQUIRED 
TradeState  (1 | 2 | 3 )     #REQUIRED > 
包含了提出進行付款指示處理要求所需的相關訊
息，如交易角色的描述等。 
其 Attribute 包含了： 
ID 辨別各個 Payment Instruction 
Request Block 之獨一無二的識
別碼 
TradeState 用 來 指 示 當 前 的 Payment 
Instruction Request Block 要進
行的交易型態，以此呼叫對應
的 TradeSchemeData。 
其 Content 包含了： 
Status Status Components 表示這次的
處理是成功或失敗。 
Org The Organization Component 
內容是說明參與交易角色的細
節資料，包含了參與交易的角
色有哪些，以及押匯銀行與進
口商的資料。 
TradingRoleD
ata 
Trading Role Data Component 
包含了在進行 IOTP 交易時需
要封裝進來的任何資訊或文件
(例如進口商要通知出口商的相
關資訊)。 
TradeSchem
eData 
Trade Scheme Component 包含在
執 行 交 易 時 使 用 的 Payment 
Scheme 及其 Payment Protocol 資
訊，其格式定義如下： 
 
 
五、 Payment Instruction Exchange Block 
<! ELEMENT PayInstrExchBlk 
(TradeSchemeData+) > 
<! ATTLIST PayInstrExchBlk 
ID         ID           #REQUIRED> 
包含付款指示過程中需要交換的訊息。 
其 Attribute 包含了： 
ID 識 別 各 個 Payment Instruction 
Exchange Block 的獨一無二鑑別
碼 
其 Content 包含了： 
TradeSche
meData 
Trade Scheme Component 包含在
執 行 交 易 時 使 用 的 Payment 
Scheme 及其 Payment Protocol 資
訊，其格式如前述定義。 
 
六、 Payment Instruction Response Block 
<! ELEMENT PayInstrRespBlk (Status, 
PayReceipt? , TradeSchemeData?,  
PaymentNote?, TradingRoleData*) > 
<! ATTLIST PayInstrRespBlk 
ID         ID           #REQUIRED> 
包含了回應付款指示最後處理結果相關訊息。
其 Attribute 包含了： 
<!ELEMENT TradeSchemeData 
(PackagedContent+) > 
<!ATTLIST TraedSchemeData 
ID              ID          #REQUIRED 
TradeStateRef     NMTOKEN  #IMPLIED 
UserId           CDATA      #IMPLIED 
BankId           CDATA     #IMPLIED 
64 
出口商 出口商銀行 進口商銀行 
2. Authentic request 
Authentic response 
5. (Document sg | Bank sign ) 
Authentic state 
1. Request negotiation 
Payment instruction exchange 
Payment instruction response  
4. Financing 
3. Payment instruction request 
圖 3 出口押匯流程 
定義的 Payment Instruction Block，來進行與出口押
匯有關的 Request、Exchange、Response 的訊息處
理與設計，並說明如下： 
I. Payment Instruction Request Block 
在此利用 TradeState 的參數來指示進行「出口
押匯」，並以 Org 與 TradingRoleData 指示交易
的角色、進口商及進口商銀行名稱。 
II. Payment Instruction Exchange Block 
利用 TradeSchemeData Component 進行押匯所
需的資料交換，細節由銀行依其進行押匯步所
需的資料來設計其流程，或可參考我們提出的
設計建議。 
III. Payment Instruction Response Block 
回應給出口商指示此次的押匯交易是成功或
失敗，並通知其貨款取得或是再次進行出口押
匯的動作。 
完成以上的流程，代表出口商銀行接受出口
商押匯。之後出口銀行利用銀行間的金融電子資料
交換系統，將貨運相關文件交給進口商銀行，並請
求歸還墊款(即圖 3 中第 5 步驟)。進口商銀行審查
該文件無誤以及確定文件符合信用狀之規定後，進
口商銀行將墊付款歸還出口商銀行，接著就能通知
進口商辦理贖單。 
3.3 信用狀交易流程細節設計 
上 述 的 申 請 押 匯 主 要 程 序 大 致 上 都 是 由
Payment Instruction Request 要求開始信用狀交
易、由 Payment Instruction Exchange 進行相關訊息
交換並最終達成交易、而由 Payment Instruction 
Response 回傳交易結果的訊息。 
但是為了能簡要明白的闡述我們的設計精
神，並且使我們的設計能夠保有彈性，並對各銀行
的實際作業有最大的相容性。我們未對 Payment 
Instruction Exchange 中應該進行哪些訊息交換做
更清楚的說明。不過，我們認為要將國際貿易融入
IOTP 並實際運作，Exchange 的細節必須仔細定義
出來，因此我們的論文中也詳細的定義信用狀相關
的各交易步驟中的 Payment Instruction Exchange 的
細節步驟。但在此文限於篇幅我們將只能扼要說明
在信用狀交易中的出口押匯的主要流程設計裡第
66 
 <IOTP> 
SAFDFDF
IOTP Message 
TransRefBlk 
Signature 
PayInstrExchBlk 
<TradeSchemeData ID= ‘C.2’> 
 
 
 
 
</TradeSchemeData> 
信用狀 
提單 
ˇ信用狀開立者 
ˇ信用狀有效 
ˇ提單開立者 
ˇ提單有效 
圖 5、單據查驗示意圖 
出 口 商 經 過 向 銀 行 申 請 押 匯 之 後 ， 進 入
Payment Instruction Exchange 步驟，將相關單
據封裝並傳送給銀行。 
二、銀行查驗 IOTP 訊息 
銀行收到此 IOTP 訊息，首先做訊息格式與 ID
正確性的查驗動作，接者進行 Signature Block 
的解析。在 Signature Block 中，具有 Trading 
Block 或其他須保護的 Block 的訊息摘要，並
整個 Signature Component 被加以簽章，因此
能確定此 IOTP 訊息，在傳送途中沒有被竄
改。並且利用傳送者的憑證資訊，即能驗證此
訊息的傳送者。因此銀行藉由查驗 Signature 
Block 即能確定，此 IOTP 訊息是由正確的使
用者發出，並且未經竄改。接著就能進行下一
步驟。 
三、查驗單據 
經過上步驟，確定 IOTP 訊息是正確無誤後，
銀 行 即 能 將 封 裝 於 Payment Instruction 
Exchange Block 中 TradeSchemeData 
Component 裡面的 信用狀、提單、保單等相
關單據取出，並且驗證其發行者簽章(如圖
5)。驗證單據以及其發行者無誤後，即能將相
關單據以核實系統進行單據的一致性與相關
性分析，完成初步查驗動作 
四、單據適法性與合約相關規定查驗 
接者，銀行相關承辦人員應該對信用狀及其相
關單據，是否有違反法律，或是相關事項(如
交貨時間等)是否與信用狀及合約規定相符，
確定交易無違法及滿足合約要求之後，即能押
匯給出口商，出口商即能獲得融資獲取回貨
款。 
我們設計的 Payment Instruction Block 繼承了
IOTP 中對於 Signature Block 等所擁有的相關安全
性設計，並且依國際貿易信用狀交易的需求，加入
相關文件認證及核實機制，使整個交易流程的安全
性，得以獲得保障。 
我們簡單的說明一下安全性的保障，例如在
傳送途中如果有惡意使用者，置換了 Payment 
Instruction Exchange Block 裡 面 的
TradeSchemeData，那麼再第二步驟的查驗 IOTP
訊息，就能藉由比對 Signature Block 中的 Payment 
Instruction Block 的 TradeSchemeData 的摘要值而
68 
據查核。以傳統人工作業方式來說，銀行審
核時間約在十天以上，對廠商而言相當不符
合成本效益。因此，我們的設計在單據核實
這方面，提出適當的自動文件核實系統的設
計準則與建議，藉由分析各單據中特定欄位
的內容是否具有一致性與相關性，即能確定
信用狀與所附的相關文件是否符合基本的
規定，使用文件核實系統能協助銀行對信用
狀交易的相關單據查驗，將可大大降低成本
與增進效率，並能減少人為疏失。 
五、擴展 IOTP 的應用範圍 
我們的設計的 Payment Instruction Block 與其
欄位定義，是符合在 IOTP 中新增元素的設計
規範。並且我們使用它來設計交易流程，滿足
IOTPv.2 提議的需求，改善了 IOTPv.1 只以
B2C 交易模式為主要考量，而不考慮其他電子
商務模式的差異性的缺點。使其能支援國際貿
易流程，並且提升效率與強化安全稽核，即可
讓 B2B 電子商貿之資訊流、金流、物流的運
作可完全的在網際網路上進行。 
5. 結論 
在傳統的國際貿易的交易流程相當繁雜，向
來需要專業的貿易人員以及報關行，協助進出口商
進行各項交易步驟，由於其中有多項交易相關單據
與步驟仍依靠人工作業製作執行，或是必須花費人
力進行單據查驗。這些大量的人工單據作業，往往
曠日費時，並容易因人工作業的錯誤，使交易失敗
而造成重大損失。因此目前各國無不積極研究改進
方法，希望能增進貿易速度，提升競爭力。但目前
貿易環境仍只達到部份流程電子化，尚無完整的電
子化流程規劃。因此我們提出研究使貿易流程能全
面的電子化。 
我們的交易訊息設計與流程規劃是以IOTP 
v.1這種開放式貿易協定作為基礎，並將其延伸使
其能夠支援國際貿易中的信用狀交易模式，進而改
善了原有IOTP v.1中只支援B2C，以及金流系統效
率與安全性不佳的缺點。 
雖然我們花了不少精神在釐清貿易流程，並
將其電子化。但是交易的安全一直是我們關注重
點。在我們的設計中，藉由 IOTP 訊息中簽章區塊
來驗證傳送者的身分；使用信用狀及相關單據中的
發行者簽章，來驗證文件的發行者與文件的真偽；
建立文件核實系統，確保信用狀與相關單據內容的
是合法且正確無誤。因此利用由單一訊息驗證到單
一文件驗證，而到最後能將所有單據互相驗證核實
的這種環環相扣的關係，能達到對於交易角色與交
易相關文件的認證，確保交易的正確性與安全性，
更改善了 IOTPv.1 中無從規範金流運作的安全與
效率，以及付款閘道協同運作的過程中，可能產生
的效率與安全性問題。 
本文雖無真正實作系統，但希望透過整個設
計的概念及過程，包括交易過程及步驟分析、交易
角色的定義、流程設計、格式的分析定義與交易角
色應該具備的訊息處理流程等等的設計概念，希望
能夠幫助讀者能參考我們的設計概念，進而設計出
IOTP的相關應用軟體。 
將來若能將我們的設計概念加以延伸，進一
步規劃設計出符合貿易實務的各種流程。就能使
IOTP更廣泛的支援各種B2B的國際貿易流程與付
款機制，並且使其能更廣泛的應用。當然除了B2B
之外，尚有C2C、P2P等各種交易型態，也都能利
用相似的概念發展相關的交易系統，使得各種交易
都能在IOTP所建立的開放性貿易協定的標準環境
下建構出更多具有公平與安全的電子商貿環境。 
參考文獻 
1. 周良, 國際貿易實務系統整理, 千華, 1998. 
2. 謝宗興, 葉俊英, 芳宗鑫, 龔春生, 國際貿易實
務, 國立空中大學, 2002. 
3. 張錦源, 劉玲, 國際貿易實務(修訂二版), 三民, 
2003. 
4. IETF, Internet Open Trading Protocol - IOTP 
Version 1.0 (RFC 2801),  
70 
 
A Total Solution for Electronic Commerce Transactions with Negotiable Contract base 
on Mobile Agent Services 
Yu-Yi Chen and Jun-Chao Lui  
 
Abstract 
Purpose –The purpose of this paper is to involve the concept of trust Agent Home for 
balancing the performance and the security issue of mobile agent technology. 
Design/methodology/approach – Because of the characteristics of mobility and 
autonomy, the mobile agent technology is playing an important role in electronic 
commerce on network environment. However, a couple of security issues need to be 
overcome before mobile agents can be employ in real life commercial applications. 
Moreover, a fair contract negotiation also included, it is very important to make a 
contract in E-Commerce reduce the risk of transaction. Then it will encourage people 
to purchase on Internet. 
Findings –As we overview the security issues in mobile agent paradigm and 
summarize the security requirements for agent based electronic commerce 
applications. The most of weakness of mobile agent system is the visited malicious 
hosts may illegally collect the agent’s embedded information. We found this 
weakness of mobile agent system can be overcome by a trusted agent home involve to 
protect the customer’s privacy. 
Originality/value –The paper presents a solution for secure E-Commerce  
transactions base on mobile agent services for balancing the performance and the 
security issue of mobile agent technology. 
Keywords Electronic Commerce, Mobile Agent, Fair-exchange, security  
Paper type Technical paper 
 
1. Introduction 
Internet shopping has become popular all over the world, as it is more efficient 
than shopping in physical stores. Internet provides a virtual shopping environment 
that can help customers to make better selections. With only a few clicks, customers 
can go online to buy almost anything. On the account of the convent for Internet 
<<附錄二>> 本研究以「A Total Solution for Electronic Commerce Transactions 
with Negotiable Contract base on Mobile Agent Services」投稿至
國際期刊 Journal of Online Information Review，目前尚在審查中。.
72 
investigated in recent years. However, there are some security issues (Jansen and 
Karygiannis, 1999) need to concern before the agent concept can be applied in 
E-Commerce environments. Especially without any security mechanism, the visited 
malicious hosts may illegally collect the agent’s embedded information (Wang and 
Leung, 2005; Kotzanikolaou et al., 1999; Kotzanikolaou et al., 2000; Sander and 
Tschudin, 1998; Vigna, 1998; Yi et al., 1993). It will cause the transaction is unfair 
and damage the customers’ privacy. 
 
In this paper, we try to involve the concept of trust Agent Home for balancing 
the performance and the security issue of agent technology. The Agent Home is a 
trusted platform for customers to make deal with merchants. All the bids are 
negotiated on Agent Home’s platform. It is different from the traditional mobile agent 
scheme. All agents issued by Agent Home do not need to carry customers’ critical 
information for negotiation. The agents are just assigned to notify merchants of the 
opportunity of transaction on Internet. Such design can avoid that the visited 
malicious hosts to make any illegal collection of the agent’s embedded information. 
Moreover, a kind of fair contract negotiation is also included in our design. Agent 
Home provides more service to make sure the negotiation is fair and secure. It is very 
important to make a contract in the transaction for protecting the rights of both buyer 
and seller. Especially in E-Commerce, it will reduce the risk of transaction. Then it 
will encourage people to purchase on Internet. Of course, it is the basic requirement 
for business-to-business transaction. That’s why we thought that the contract 
negotiation should be included in the agent service. 
 
Before to introduce our design, we will briefly survey the criteria for the 
agent-base secure electronic transaction scenario, as summarized below: 
(1) Anonymity: No private information is revealed to the merchant from the 
agent during the transaction. 
(2) Unforgeability: For the correctness, in the transaction, each message 
should be signed by the creator. 
 
74 
z Agent Home acts as Customers’ agent service provider and the arbiter 
during the contract negotiated. All the bids are negotiation on the Agent 
Home’s platform before the transaction also called pre-transaction.  
 
 
Figure 1. The basic structure of our scheme 
 
In order to avoid that the visited malicious hosts may illegally collect the agent’s 
embedded information, we involve a trusted third party “Agent Home” in our scheme. 
There are two kinds of mission-oriented agents issued by Agent Home, and one agent 
issued by Online Store:  
(4) Invite Agent (IA): It carries Customer’s request information and migrate for 
host to host. It invites the Online Stores to negotiate the bids.  
(5) Negotiation Agent (NA): It is responsible for Customer to negotiate the bids 
with Sales Agents. 
(6) Sales Agent (SA): It carries the Online Store’s bids list and contract to 
negotiate with the Negotiation Agent at Agent Home’s platform.  
 
Moreover, Cryptology such as PKI (Public Key Infrastructure) (Rivest et al., 
1978), RSA signature (Rivest et al., 1978), hash chain (Zhou and Tan, 2001), and 
partial signature (Park et al., 2003) are applied in our scheme. The Internet SSL 
(Secure Socket Layer) protocol (Wagner and Schneier, 1996; Freier, 1996) is also 
applied to protect the end-to-end communications. Before proceeding with more 
76 
 
Figure 2. Notification Phase 
Step 1: Before asking for the agent service, Customer has to prepare his certificate 
CCert , purchase request CREQ , negotiation rules CNRule , and the 
deadline of the pre-transaction TC. Moreover, Customer randomly splits his 
private key   Cd into two partial private keys 1Cd  and 2Cd  as follows: 
)( mod21 Cccc nddd φ+=  
And the first partial public key 1Ce  will be generated as follows: 
)( mod111 Ccc nde φ−=  
Then Customer sends the message ( CCert , Cn , 1Ce , 2Cd , CREQ , CNRule ,TC) 
to Agent Home. 
 
Step 2: As the above message is received and the Customer’s certificate CCert  is 
verified, the following voucher CVou  will be issued by Agent Home for 
proving it accept the require for Customer as follows: 
)( 1cdC eSVou AH=  
Agent Home also issues a random session number SN and generates the 
signature ),( CdREQ REQSNSSG AH= for this request. After, ( SN ,VouC, 
SGREQ ) is sent to Customer for proving that his request has been accepted.  
 
78 
Then Online Store sends Sales Agent carried (SN, MSG , MSGSG , 1K , SCert ) 
to Agent Home. 
2.3 Negotiation Phase 
On Agent Home’s platform, for any Sales Agent which carries the same session 
number SN will be assigned to negotiate with the corresponding Negotiation Agent 
which carries the same SN. The negotiation will be running by the procedure called 
“offer-counter-offer” model. That is, Negotiation Agent can reject the offer from 
Sales Agent in order to get better price for customer. Sales Agent will propose the 
more feasible offer to Negotiation Agent step by step. This process will be continues 
until they make the deal or one side terminate it. Negotiation Agent has complete 
information about Customer’s requirement, but Sales Agent does not, this situation 
known as “one-side uncertainty” (Vincent, 1989) negotiation. The negotiation exists 
through until Sales Agent makes all offers and Negotiation Agent either accepts or 
rejects them. This kind of negotiation model can be run in our scheme since each 
Sales Agent carried a bid list. There is a series of condition about prices and payment 
for Customer’s requirement. The negotiation is processed to reveal the bid message 
one at a time as illustrate in Figure 3. It is the kind of “offer-counter-offer” 
negotiation as we mention before. 
 
Figure 3. Negotiation Phase 
Step 1: For any Sales Agent which carries the same session number SN will be 
80 
2.4 Contract Signing Phase 
In this phase, Customer pays for getting the result form Agent Home. Agent 
Home sends all the result bid messages (CertS, ][, iBContract ) to Customer such that 
some one could be chosen to make transaction.  
 
Figure 4. Contract Signing Phase 
Step 1: Customer sends his certificate CertC and the session number SN of his 
request to Agent Home. 
 
Step 2: As the above message is received and the Customer’s certificate CCert  is 
verified, Agent Home sends }|])[,,{(  message bid all foriBContractCerts  
to Customer. Here the procedure of “pre-transaction” has done. 
 
Step 3: Customer can choose one or some stores to make transaction. Then, 
Customer generates a partial signature 
1_ CCnt
SG of Contract for the bid B[i] 
by the partial private key dc1 as follows. 
])[,(
11_
iBContractSSG
CdCCnt
= .  
Then Customers sends (
1Cnt_Ccc
SGB[i],Contract,,Vou,Cert ) to Online 
Store.  
82 
Online Store has already sent its signature SCntSG _  to Customer but not receive 
Customer’s signature CCntSG _ . But, in this phase, Online Store can ask Agent Home to 
generate the complete signature CCntSG _  for this transaction. Such design will make 
participated parties cannot gain any advantage over the correctly behaving parties. 
 
Figure 5. Dispute Resolution Phase 
Step 1: Suppose Online Store has already sends its signature SCntSG _  to Customer 
but doesn’t receive Customer’s signature CCntSG _  from Customer. It already 
get (SN, VouC, ][, iBContract , 1_ CCntSG ) from Customer. Then it sends these 
messages with its signature Cnt_SSG  and its certification SCert to Agent 
Home.  
 
Step 2: As the above message is received and the Online Store’s certificate SCert  
is verified, Agent Home uses Online Store’s public key to verify the 
signature SCntSG _ as follows. 
)( _ SCnte SGV S
?= ])[,( iBContract  
According the voucher VouC, Agent Home finds out Customer’s escrowed 
partial public key C1e  to verify the signature 1_ CCntSG  as follows. 
])[,(
?
1_ iBContract )SG(V CCntec1 =  
Agent Home also find out Customer’s escrowed partial private key 2cd  to 
84 
),( CdREQ REQSNSSG AH=  
)( 1cdC eSVou AH=  
The first signature REQSG  means that Customer has been verified and his 
request has been accepted by Agent Home. The second signature CVou  is 
generated by Agent Home under the corresponding private key 2Cd  has be 
escrowed. Both signatures are carried by Invite Agent to let Online Store 
understand the pre-transaction is really issued by someone with the accepted of 
Agent Home. 
z Unforgeability in Contract Signing Phase 
In Contract Signing Phase, both parties, Online Store and Customer, make the 
signatures SCntSG _  and CCntSG _ for their agreement of Contract. 
SCntSG _ = ])[,( iBContractS Sd  
CCntSG _ = ])[,( iBContractS Cd  
These unforgeability signatures mean the promises for each other to make the 
deal about the transaction.  
 
3.3 Non-repudiation 
Non-repudiation viewpoint means that the request party provides related proof 
(such as digital signature) for the other party to verify that each transaction will not 
suffer from any false denial. We will state the non-repudiation scenarios in our 
scheme as follows. 
z Non-repudiation in Notification phase 
As the response signature REQSG of Customer’s request message, Agent Home 
can not deny it had agreed to provide agent service for Customer’s request. 
Moreover, Online Store can also verify the same signature REQSG  carried by 
Invite Agent. It is the proof for Invite Agent as issued by Agent Home. 
z Non-repudiation in Contract Signing phase 
In this phase, Customer and Online Store will finally get the signatures SCntSG _  
and CCntSG _  respectively. Both parties can not deny this transaction and 
commitment price. 
 
86 
simultaneously. 
 
3.5 Optimism 
The concept of “optimistic” fair exchange is proposed by Asokan et al. (1998). 
The TTP (trusted third party) should not be involved during the transaction when the 
parties behave correctly, just be involved to complete the transaction in case of 
problems with one of the parties. It obviously our scheme is “optimistic”. Since, 
Agent Home is not involved during the transaction (step3 to step5 of Contract Signing 
Phase). Suppose the transaction is not complete, it will be fixed in Dispute Resolution 
Phase with the assisted of Agent Home. 
 
4. Conclusions 
As we overview the security issues in mobile agent paradigm and summarize the 
security requirements for agent based electronic commerce applications. In this paper, 
we involve the concept of trust Agent Home for balancing the performance and the 
security issue of agent technology. The most of weakness of mobile agent system can 
be overcome by a trusted agent home involve to protect the customer’s privacy. 
Moreover, a fair contract negotiation is also included in our design, it is very 
important to make a contract in E-Commerce reduce the risk of transaction. Then it 
will encourage people to purchase on Internet. Our design are anonymity, 
unforgeability, non-repudiation, fairness, and optimistic. Hopefully, our system will 
completely meet the demands of the future. 
 
References 
Asokan, N., Shoup, V. and Waidner. M. (1998), “Optimistic fair exchange of digital 
signatures.” In: EUROCRYPT’98, LNCS 1403, pp. 591-606. Springer-Verlag. 
Angelov, S. and Grefen, P. (2003), “An Analysis of the B2B E-Contracting Domain - 
Paradigms and Required Technology”. Telematica Institute Technical Report. 
Bellare, M. and Sandhu, R. (2001), “The security of practical two-party RSA 
signature schemes. Manuscript”, http://www-cse.ucsd.edu/users/mihir/papers/. 
ConsumerWebWatch (2002): A matter of trust: What users want from web sites. In: 
Results of a national survey of internet users for consumer WebWatch by 
Princeton Survey Research Associaties. January 2002, Electronic Publication, 
