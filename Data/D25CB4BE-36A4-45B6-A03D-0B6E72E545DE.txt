MPEG 7 視訊影像系統之軟硬體共同設計 
“Software/Hardware Codesign for MPEG 7 Video and Image System” 
計畫編號：NSC 98-2221-E-024-005 
執行期間：98 年 8 月 1 日至 99 年 7 月 31 日 
主持人：高啟洲國立台南大學資訊工程系副教授 
 
一、 中文摘要 
MPEG-7標準提供了一個標準架構，包含
了很多可以描述及有效管理多媒體內容的
工具；這個標準可以應用在影像與視訊的索
引及擷取、多媒體內容摘要、即時影像傳
遞、監控系統及個人化服務等環境上。然
而，純以軟體構成的視訊或影像處理架構，
無法滿足快速或即時處理(real time)的要
求，因此以硬體加速是必要的選擇。雖然硬
體可以滿足快速處理的需求，卻無法在硬體
資源的使用上提供彈性，而且無法在同一時
間作不同的運算。此外，處理視訊或影像的
演算法也會不斷地更新或演進，所以軟硬體
共同設計是MPEG 7視訊影像系統最佳的選
擇。我們的研究將針對MPEG-7視訊影像系
統提供一個可規劃的硬體架構及高效能的
軟體設計之軟硬體共同設計系統。我們提出
一個針對MPEG-7的視訊影像的快速搜尋演
算法，改良存在的MPEG-7的演算法，使提
出的系統能擷取旋轉(Rotation)的圖像。並且
為能給予MPEG-7視訊影像系統一個可規劃
的硬體架構，我們針對平行可規劃計算機的
架構提出最佳化電路效能的資料流程圖時
間切割法及拓撲排序的技巧來解決切割及
排程的問題，使得MPEG 7視訊影像系統需
求的計算工作可以利用平行可規劃計算機
來完成。 
英文摘要 
The MPEG-7 standard was approved as an 
effort to address the growing need for 
handling multimedia content. The key aspect 
of MPEG-7 can be employed in applications 
such as video indexing and retrieval, content 
summarization, real-time content delivery, 
surveillance, personalized services, etc. 
However, a software implementation does not 
perform fast enough processing. Therefore, 
hardware acceleration is necessary. But, the 
hardware does not offer the flexibility and it 
can not be time-shared. Moreover, algorithmic 
research is expected to go on for future years. 
It is seen that the software/hardware codesign 
platform is the most appropriate choice. Our 
research will provide a hardware/software 
design in which has a reconfigurable hardware 
architecture and a high performance software 
design for MPEG 7 video and image system. 
We present a fast search algorithm for MPEG 
7 video and image system. The proposed 
system can retrieve rotation images. To 
provide a reconfigurable architecture for 
MPEG 7 video and image system, a temporal 
partition of the data flow graph and a 
topological order technique are proposed to 
optimize the performance of the parallel 
reconfigurable computer. It can ensure correct 
execution of the total computational task. 
 
二、 計畫的緣由與目的 
在未來將會有更多的應用領域需要處
理影音資訊，為了增加處理效能, 將影音資
訊以特定的格式描述，方便軟硬體處理，是
必要的步驟。MPEG 系列的標準已訂出
MPEG-1 及 MPEG-2 這類 frame-base 的影
音資料格式，或是 MPEG-4 這種 object-base 
的影音資料格式 [1-8]。這些格式只表示出
資料的值，卻無法表示資料在概念上的關係
或意義，如果我們想從中找尋具有特定意義
一個處理器將用於高階的應用程式碼，另外
一個處理器則用於控制和管理函式庫。 
PRC 的可規劃邏輯部分將用於協同處理
器、匯流排，資料輸出入及記憶體介面。在
晶片上的區塊記憶體(On-chip Block RAM)
會配置給協同處理器使用，而運算引擎的載
入或者是替換由配置管理員(configuration 
manager)來控制。 
 
圖 3. MPEG-7 影像視訊檢索系統平臺架構 
根據之前的系統架構，我們需要一個適
用於平行可規劃性計算機系統的工作切割
方法。傳統可規劃計算機的切割技巧並不能
針對平行可規劃計算機提供良好的切割及
排程的方法。因此，在本計畫中，我們將針
對平行可規劃計算機的架構提出最佳化電
路效能的資料流程圖時間切割法及拓撲排
序的技巧來解決切割及排程的問題。時間切
割 法 能 將 整 個 計 算 工 作 切 割 成 互 斥 
(mutually exclusive)，且大小受限制的子工
作，以滿足每一個子工作均不超出本身的邏
輯容量的需求；拓撲排序技巧則是用來排程
所有的平行子工作，以確保整個計算工作能
適當被執行。此計畫的貢獻除了可實作出高
效能的 MPEG-7 影像視訊搜尋系統外，我們
也以理論方式證實我們所提出的方法是一
個最佳化的演算法，投稿至重要的學術期刊
中，而產生重要的學術成果，因此，此工作
是能兼具學術與產業實務的研究工作。 
我們設定一個無迴圈的資料流程圖 
(acyclic data flow graph, DFG)，G = (V, E, 
W)，代表一個被切割成 n 個平行可規劃性計
算單位元的計算工作模型。其中 V 是節點個
數的集合，|V| = n，每個節點 vi ∈ V 代表一
個可規劃性計算的單位，權值 wi ∈ W 代表
vi的大小，1≤ i ≤ n，E 是邊個數所成的集合，
假如有一個有向邊 eij = <vi, vj> ∈ E，則表示
有一個可規劃性計算單位的輸出函數 vi 是
另一個可規劃性計算單位 vj的輸入函數。 
可規劃性計算組態重新規劃所耗的時
間，是可重組式運算系統的最大效能瓶頸所
在。相對於切割成 n 個平行可規劃性計算單
位元的資料流程模型圖，可規劃性計算組態
重新規劃所耗的時間即是切割成 n 個平行
可規劃性計算單位元的資料流程模型圖的
深度 (depth)，因此，本計畫針對最佳化切
割平行可規劃性計算單位元資料流程模型
圖的深度目標進行探討，我們先以理論方式
推導所提出的演算法為最佳化的演算法，再
利用實際的實驗結果來顯示方法的優越性。 
我 們 所 提 最 小 深 度  (parallel 
minimum-depth) 的平行切割排程演算法，
主要是基於我們所定義地板方塊  (floor 
block) 的概念，所謂的地板方塊  (floor 
block) 乃指一個平行可規劃性計算單位的
輸 入 均 為 主 輸 入 節 點  (primary input 
nodes)，藉由地板方塊的定義，我們再定義
最大可行地板方塊 (maximum feasible floor 
block)，最大可行地板方塊是一個有最大高
度 (maximum height) 且不超出可規劃性計
算裝置邏輯容量值的地板方塊。我們證明一
些的推論而得到”在最佳化切割平行可規劃
性計算單位元資料流程模型圖的深度解
中，最大可行地板方塊必是該解的一個子集
合”的理論，藉由此理論的成立，我們就能
以貪婪法 (greedy method) 來最佳化可規劃
性計算組態重新規劃所耗的時間，換句話
說，我們會遞迴式的在資料流程圖中找尋最
大可行地板方塊，找到後，即從資料流程圖
中切除這些最大可行地板方塊作為最佳化
可規劃性計算組態重新規劃所耗時間解的
子集合，這些工作將執行到當最佳化可規劃
性計算組態重新規劃所耗時間之解集合的
節點集合等於原來的資料流程圖節點集合
為止。至於找尋最大可行地板方塊的方法，
我們將發展一個標記 (leveling) 演算法來
解決。首先，我們以拓樸次序 (topological 
移動
 
色彩
 
形狀
 
引擎
 
X
X
X
 
形狀引擎
 
色彩引擎
 
移動引擎
 
處理器
 
處理器
 
協同處理器 設定 
配置管理員
PRC 
法及拓撲排序的技巧來解決切割及排程的
問題，使得 MPEG 7 視訊影像系統需求的計
算工作可以利用平行可規劃計算機來完成。 
本研究的研究結果，已發表於重要的期
刊論文中，MPEG-7 的視訊影像快速搜尋演
算法已被 Journal of Information Science and 
Engineering 期刊接受 [19]；針對平行可規
劃計算機的架構所提出最佳化電路效能的
資料流程圖時間切割法及拓撲排序的技巧
也被 International Journal of Electronics 期
刊接受 [20]。 
 
五、參考文獻 
1. International Telecommunication Union, 
http://www.itu.int 
2. International Standarization Organization, 
http://www.iso.ch 
3. G. Aggarwal et al., “An Image Retrieval 
System with Automatic Query 
Modification,” IEEE Trans. on Multimedia, 
vol.4, no.2, pp.201-214, Jun. 2002 
4. J. J. chen and C. Y. Liu, “A Universal 
Query Mechanism for Similarity Retrieval 
Based on Shape Information in Image 
Database,” Proc. IEEE ICASSP 2002, vol. 
3, pp. 3676-3679, May 2002 
5. J. J. Chen et al., “Morphological Shape 
Description and Boosting Similarity 
Retrieval in Image Databases,” CVGIP 
2001, Aug. 2001 
6. Y. Freund et al., “A Decision-theoretic 
Generalization of Online Learning and An 
Application to Boosting,” J. Comp.&Sys. 
Sci., vol. 55, no. 1, pp. 119-139, 1997 
7. V. K. Vutukuru et al., “A Rough Set 
Framework for Eontent Based Image 
Classification and Retrieval,” in Proc. Int 
Conf. Multimedia Process. and Syst., Aug. 
2000 
8. J. Smith and S. Chang, “VisualSEEK: A 
Fully Automated Content-based Image 
Query System,” Proc. ACM MM, MA, 
June 1996 
9. “MPEG, MPEG-7 Overview (version 9),” 
ISO/IECJTC1/SC29/WG11N5525 
10. “MPEG-7: The Generic Multimedia 
Content Description Standard,” IEEE 
Multimedia, pp. 78-87, Apr. 2002 
11. B. S. Manjunath, P. Salembier and T. 
Sikora, “Introduction to MPEG-7,” Wiley, 
2002 
12. D. N. Rakhmatov and S. B. K. Vrudhula, 
“Hardware-software Bipartitioning for 
Dynamically Reconfigurable System,” 
ACM Proc. of the 10th International 
Workshop on Hardware-Software 
Codesign(CODES) pp. 145-150, 2002 
13. K. S. Chatha and R. Vemuri, “An 
Interative Algorithm for 
Hardware-Software Partitioning, Hardware 
Design Space Exploration and 
Scheduling,” Design Automation for 
Embedded System, pp. 281-293, 2000 
14. C. Bobda, “CoreMap: A Rapid Prototyping 
Environment for Distributed 
Reconfigurable Systems,” Proc. of the 13th 
IEEE International Workshop on Rapid 
System Prototyping, 2002 
15. S. M. Loo and B. E. Wells, “Task 
Scheduling in a Finite Resource 
Reconfigurable Hardware/Software 
Codesign Environment,” INFORMS J. of 
Computing, 2003 
16. B. Mei, P. Schaumont, and S. Vernalde, 
“A Hardware-Software Partitioning and 
Scheduling Algorithm for Dynamically 
Reconfigurable Embedded Systems,” Proc. 
of the 11th ProRISC Workshop on Circuits, 
Systems, and Signal Processing, 2000 
17. H. Walder and M. Platzner, “Online 
Scheduling for Block-Partitioned 
Reconfigurable Devices,” ACM Proc. of 
the Design Automation and Test, 
Europ(DATE), pp. 290-295, 2003 
18. Ou, J., Choi, S., and Prasanna, V . K. 
(2004). Energy Efficient 
Hardware/Software Co-Synthesis for a 
Class of Applications on Reconfigurable 
SoCs, International Journal of Embedded 
Systems. Inderscience Publisher, USA. 
Vol. 1, No. 1. 
19. Yen-Tai Lai, Chi-Chou Kao, Tzu-Chiang 
Tai, and Wen-Chun Yeh, November 2010, 
“Performance-Driven Rotational Invariant 
Image Retrieval System,” Journal of 
Information Science and Engineering, Vol. 
26, No. 6, pp. **-**. (NSC 
98-2221-E-024-005) 
20. Chi-Chou Kao, Tzu-Chiang Tai, and 
Yen-Tai Lai, February 2010, “An 
Optimisation Communication Cost 
Algorithm for Dynamically 
Reconfigurable FPGAs,” International 
Journal of Electronics, Vol. 97, Issue 2, pp. 
177–182.  
JOURNAL OF INFORMATION SCIENCE AND ENGINEERING XX, 1-xxx (xxxx)
1
A Performance-Driven Rotational Invariant Image
Retrieval System *
YEN-TAI LAI 1, CHI-CHOU KAO 2 **, TZU-CHIANG TAI 1, AND WEN-CHUN YEH 1
Department of Electrical Engineering1 Department of Computer Science and Information Engineering2
National Cheng Kung University National University of Tainan
Tainan, Taiwan      Tainan, Taiwan
The color feature could be well represented in a feature and shape is a
distinguishable feature which can make coarse discriminations quickly. Based on those
reasons, we present an efficient image retrieval system to consider simultaneously
accuracy and performance by combining color moment with shape contexts in this
paper.
The shape rotation has significant influence on the similarity measure and retrieval
performance. Another important contribution of the paper is to present an efficient
algorithm for rotation invariance. In the algorithm, the rotated shape contexts together
are first clustered and then label each cluster so that the shape contexts in each cluster
have the same label. Using the histogram of label frequencies can quickly and efficiently
search for similar or rotational shapes. The experimental results have shown that our
system is effective and has better retrieval performance than the existing systems.
Keywords: image retrieval, performance, rotation-invariance, color, and shape context
1. INTRODUCTION
With the amount of digital multimedia data growing, the efficient information
retrieval issue is raised. Most of the early researches developed content-based image
retrieval. The content-based image retrieval system was focused on extracting effective
global visual features i.e. low-level features, such as color, texture, and shape to compare
images [1-4]. However, the retrieval performance is still far from user’s expectations. It is
well known that the most challenging problems of content-based image retrieval are the
semantic gap between low-level image representations and high-level human concepts.
Two approaches can be use to reduce the gap. The first approach is extracting
region-based features to represent the user’s perception. The region-based image retrieval
[5-8] applies image segmentation to decompose an image into several regions and extract
features of these regions. Therefore, each image can be represented by a set of regions,
which contain low-level features and importance weights. According to the weight, the
system determines which regions are interested. Compared to the case where global
image features are considered, the region-based image retrieval system is close to the
perception of human visual system. The second approach taken to reduce the gap is
*
 This paper was partially supported by National Science Council, Taiwan 98-2221-E-024-005.
** Corresponding Author
A PERFORMANCE-DRIVEN ROTATIONAL INVARIANT IMAGE RETRIEVAL SYSTEM 3
respectively. Each region in the query image will be encoded into a color codeword and a
shape codeword. The system will compare all the color and shape codebooks with the
color and shape codewords to find the best matching images. If the user is satisfied with
the results, the search is finished. Otherwise, the users choose correct images from the
results to the system. When system receives the correct images, it will learn human
concept and retrieve more accurate images in the next time.
Fig. 1. Flowchart of the proposed image retrieval system.
Image similarity between the query and database can be computed by utilizing
extracted features. After segmentation and extraction, each regional color feature is
encoded to a codeword. According to the features, an image can be represented as
compact and sparse representations. The similarity of two images is decided by the
distance of their representation. The shorter is the distance, the more similar the images.
To speed up the retrieval, database is structured as a codebook to filter quickly out
candidate images. All images in the database are segmented into homogeneous regions
and then the regional features in those images are extracted. Similar features will be
clustered together and encoded as a codeword. The database can be considered as a
codebook. The first column of a codebook is a codeword and the second column stores k
codewords similar to the first column one and sorted by the similarity, where k is a
natural number. The third column collects a list of images that have a region
corresponding to the first column codeword. According to those codewords, we can
obtain a set of images and compute the distances between the query image and the set.
If the matching results are not satisfied, the system will learn the importance of a
A PERFORMANCE-DRIVEN ROTATIONAL INVARIANT IMAGE RETRIEVAL SYSTEM 5
moment with shape contexts. Additionally, we also present an efficient algorithm for
rotation invariance in the shape matching step because the shape rotation has significant
influence on the similarity measure and retrieval performance. The rotation invariance
algorithm will be described in detail in the next section.
3. A ROTATIONAL-INVARIANT ALGORITHM
In this section, we first describe retrieval by shape contexts to formulate the rotated
object matching problem. Next, the rotation invariance algorithm based on the k-means
clustering method [20] is proposed.
3.1 Problem Formulation
Shape context is a rich shape descriptor for measuring shape similarity. The shape
context describes the coarse arrangement of the shape with respect to a given point on the
shape and this point is not required to be any special point such as maxima of curvature
or inflection point. The shape context analysis begins by taking n samples from the edge
elements on the shape. Then, a shape is represented by a discrete set of points sampled
from its contours. These points can be obtained as locations of edge pixels as found by an
edge detector, giving us a set P = {p1, p2, …, pn}, piR2, of n points. When we consider
the set of vectors originating from a point to all other sample points on a shape, these n-1
vectors express the configuration of the entire shape relative to the reference point. One
compact way to capture this information is the distribution of the relative positions of the
remaining n-1 points in a spatial histogram. Concretely, for a point pi on the shape, we
compute a coarse histogram hi of the relative coordinates of the remaining n-1 points,
)}(}{:{# mbinpqpqh iiki  .
This histogram is defined to be the shape context of pi. Thus, each shape can obtain
n shape contexts. To make the descriptor more sensitive to positions of nearby sample
points than to those of points farther away, we use bins that are uniform in log-polar
space. It should be noticed that in the absence of background clutter, the shape context of
a point on a shape is made scale invariant by normalizing all radial distances by the mean
distance  between the n2 point pairs in the shape.
We observe that shape contexts will be different for different points on a single
shape S; however, corresponding (homologous) points on similar shapes S and S will
tend to have similar shape contexts. As illustrated in Figure 2.a, Figure 2.b and Figure 2.c,
sampled edge points for one shape are at left and the shape context of the marked point is
at right. Each shape context is a log-polar histogram of the coordinates of the rest of the
points measured using the marked point as the origin; dark pixels represent larger values.
Figure 2.a and Figure 2.b have similar shape contexts since their marked points are
corresponding points on similar shapes. Figure 2.a and Figure 2.c have different shape
contexts although the two marked points are on the same shape.
A PERFORMANCE-DRIVEN ROTATIONAL INVARIANT IMAGE RETRIEVAL SYSTEM 7
To achieve rotation invariance in terms of traditional shape context, it is essential to
have the same collection of shape labels for a shape and its rotations. We propose a
rotation invariance algorithm based on the k-means clustering method to cluster together
not only the shape context vectors of similar shapes but also the corresponding shape
context vectors of original shape and its rotations.  Therefore, a shape label represents a
kind of distribution based on relative frame, rather than the absolute frame in traditional
shape context.
For two corresponding points on one shape and its rotation, we can find that one
shape context vector can be derived by circularly shifting another shape context vector.
The shifting position is a multiple of the number of bins for log r in the log-polar space.
By using this kind of shifting on a shape context vector, there are different shape context
vectors as many as the number of bins for θ. Each shape context vector corresponds to
one rotation that can be realized with respect to the original shape in the log-polar space.
Figure 3 illustrates an example where one shape is the rotation of the other shape by180 .
The log-polar space is uniformly divided into 12 bins for θ and 5 bins for log-r. We can
observe that the shape context vector in Figure 3.a can be derived when we circularly
shift the shape context vector in Figure 3.b by 30 positions. (180  is equal to 5 bins for
θ and rotating through one bin for θ is equal to 6 positions.)
(a) (b)
Fig. 3. One shape and its rotation with their shape contexts.
From the discussion above, we consider that all shape context vectors that can be
derived by circular shift represents the corresponding points for one shape and all of its
rotations. Therefore, these shape context vectors should be clustered together and
replaced with the same shape label. For this purpose, we propose the rotation invariance
algorithm as follows.
First, the absolute distance and representative shape context vector for 2 shape
context vector in our log-polar space:
For two shape context vectors  1 2 60, , ,X x x x  and  1 2 60, , ,Y y y y  , the
absolute distance of X and Y is denoted as XYD  and its computation is
A PERFORMANCE-DRIVEN ROTATIONAL INVARIANT IMAGE RETRIEVAL SYSTEM 9
frequencies and then the shape matching is performed.
Fig. 4. The flowchart of rotation invariance algorithm.
4. EXPERIMENTAL RESULTS
We use the ETH-80 image set [21] as our database. The database consists of eight
categories, and each category has ten unique objects. Each object is represented by 41
images from viewpoints spaced equally over the upper viewing hemisphere (a distance of
22.5 26  ). There are 3280 images totally. For every image, the database provides a
high-quality segmentation mask. For a query image, our system will sample 100 points on
its contour, determine a shape label to represent it, and then perform image retrieval from
our database by utilizing the histogram of shape label frequencies. A retrieved image is
considered a match if it belongs to the same category as the query image.
We select 32 rotated images as queries from eight categories, each containing four
of the images. Figure 5 shows some of shortlists of length 5 for the retrieval result in case
that the query image is not rotated. We have compared the existing system [22] with the
proposed system as shown in Figure 5. The result of Figure 5 is reflected as well in the
average precision-recall figure (Figure 6) where low recall indicates few number of the
answer set. The precision levels for both methods are similar at low recall levels. When
the recall level arises, the precision level for our rotation invariance algorithm is higher
than existing method. That is to say, when the number of images in the answer sets is few,
distance from shape
contexts to centroids
centroid
grouping based on
minimal distance
start
training data
number of cluster k
no shape context
move group?
end
yes
no
A PERFORMANCE-DRIVEN ROTATIONAL INVARIANT IMAGE RETRIEVAL SYSTEM 11
higher precision levels at all recall levels than the existing system.
(a) existing system  (b) proposed system
Fig. 7. Some shortlists when the query image is rotated by 90 .
Fig. 8. The average precision versus recall figure when half of the query images are rotated by
90 .
We also use the MPEG-7 CE [22] database, which is a widely accepted evaluation
platform for the rotation invariance matching. The MPEG-7 CE-Shape-1 database
consists of 1400 shapes and 70 classes, i.e. each class has 20 shapes. The retrieval
accuracy is reported by the so-called Bullseye test: Every shape is matched with all the
other shapes in a dataset. We keep 40 shapes with the highest similarity scores and
discard the others. Among the 40 retrieved shapes, we count the correct hits, i.e. the
number of shapes belonging to the same class as the query shape. There are at most 20
hits for each query. The accuracy of shape retrieval is the ratio of the number of correct
hits to the highest possible correct hits (which is 201400 in this experiment).
We conduct sampling uniformly along contours and take N sampling points for each
A PERFORMANCE-DRIVEN ROTATIONAL INVARIANT IMAGE RETRIEVAL SYSTEM 13
pp. 699 – 709, May 2004.
8. J. Li, J. Z. Wang, and G. Wiederhold, “IRM: Integrated Region Matching for Image
Retrieval,” Proceedings of the 8th ACM International Conference on Multimedia,
pp. 147 – 156, 2000.
9. J. Z. Wang, J. Li, and G. Wiederhold, “SIMPLIcity: Semantics-sensitive integrated
matching for picture libraries,” IEEE Transactions Pattern Analysis and Machine
Intelligence, vol. 23, pp. 947–963, Sept. 2001.
10. A. Kushki, P. Androutsos, K. N. Plataniotis, and A. N. Venetsanopoulos, “Query
Feedback for Interactive Image Retrieval,’’ IEEE Transactions Circuits and Systems
for Video Technology, vol. 14, pp. 644 – 655, May 2004.
11. I. Biederman, "Recognition-by-components: a theory of human image
understanding," Psychological Review, vol. 94 no. 2, pp. 115-147, Apr. 1987.
12. H. Kauppinen, T. Seppanen, and M. Pietikainen, “An experimental comparison of
autoregressive and fourier-based descriptors in 2D shape classification,” IEEE
Transactions Pattern Analysis and Machine Intelligence, pp. 201–207, Feb. 1995.
13. F. Mokhtarian, S. Abbasi, and J. Kittler, “Robust and efficient shape indexing
through curvature scale space,” In British Machine Vision Conference, pp. 53-62,
1996.
14. H. Alt, B. Behrends, and J. Blomer, “Approximate matching of polygonal shapes,”
Annals of Mathematics and Artificial Intelligence, pp. 251–265, 1995.
15. L. J. Latecki, R. Lakämper, and U. Eckhardt, “Shape descriptors for non-rigid
shapes with a single closed contour.” IEEE Conference on Computer Vision and
Pattern Recognition (CVPR), pp. 424–429, 2000.
16. E. G. M. Petrakis, A. Diplaros, and E. Millos, “Matching and retrieval of distorted
and occluded shapes using dynamic programming,” IEEE Transactions Pattern
Analysis and Machine Intelligence, pp. 1501–1516, Nov. 2002.
17. S. Belongie, J. Malik, and J. Puzicha, “Shape Matching and Object Recognition
Using Shape Contexts,” IEEE Transactions Pattern Analysis and Machine
Intelligence, vol. 24, no. 4, pp. 509-522, Apr. 2002.
18. G. Mori, S. Belongie, and J. Malik, “Efficient Shape Matching Using Shape
Contexts,’’ IEEE Transactions Pattern Analysis and Machine Intelligence, vol. 27,
pp. 1832 – 1837, Nov. 2005.
19. F. Jing, M. Li, H. J. Zhang, and B. Zhang, “Unsupervised Image Segmentation
Using Local Homogeneity Analysis,” Proceedings IEEE International Symposium
Circuits and Systems, vol. 2, pp. 456 – 459, May 2003.
20. T. Kanungo, D. M. Mount, N. Netanyahu, C. Piatko, R. Silverman, and A. Y. Wu,
“An efficient k-means clustering algorithm: Analysis and implementation,” IEEE
Transactions Pattern Analysis and Machine Intelligence, pp. 881-892, July 2002.
21. B. Leibe and B. Schiele, “Analyzing Appearance and Contour Based Methods for
Object Categorization,” Proceedings IEEE Conference Computer Vision and
Pattern Recognition, vol. 2, pp. 409 – 415, 2003.
22. L. J. Latecki, R. Lakamper, and U. Eckhardt, “Shape descriptors for non-rigid
shapes with a single closed contour,” Proceedings of IEEE Conference on Computer
Vision and Pattern Recognition, pp. 424–429, 2000.
An optimisation communication cost algorithm for dynamically
reconﬁgurable FPGAs
Chi-Chou Kaoa*, Tzu-Chiang Taib and Yen-Tai Laib
aDepartment of Computer Science and Information Engineering, National University of Tainan,
33, Sec. 2, Shu-Lin St, Tainan 700, Taiwan; bDepartment of Electrical Engineering, National
Cheng Kung University, No.1, University Road, Tainan City 701, Taiwan
(Received 20 September 2007; ﬁnal version received 16 February 2009)
In this article, we present a sequential circuit partitioning algorithm to optimise
the number of registers for dynamically reconﬁgurable FPGAs. The algorithm is
divided into two phases: (1) the labelling phase and (2) the minimising cost phase.
We ﬁrst improved the ‘as soon as possible’ and ‘as late as possible’ algorithms to
assign nodes so that the constraints of partition a sequential circuit partition
are satisﬁed for dynamically reconﬁgurable FPGAs. Then, some nodes are
adjusted or replicated to optimise the number of registers. Experimental results
demonstrate the eﬀectives of our algorithms.
Keywords: reconﬁgurable FPGA; sequential circuit; partition; precedence
constraint; optimisation
1. Introduction
There is a growing interest in dynamically reconﬁgurable FPGAs (DR-FPGAs)
because of their architectural ﬂexibility such as Dharma (Bhat, Chaudhary, and Kuh
1993), the Dynamically Programmable Gate Array (DPGA) (DeHon 1994, 1996a),
the Time-Switched FPGA (DeHon 1996b), the Virtual Element Gate Array (Jones
and Lewis 1995), and the Xilinx Time-Multiplexed FPGA (TMFPGA) (Trimberger
1997). To share the same physical device temporally, those DR-FPGAs can be
divided into sub-circuits by temporal partitioning. Each sub-circuit is called a stage
and the time that the sub-circuit occupies is denoted a micro-cycle. If the design is
partitioned into k stages, the k micro-cycles compose a macro-cycle.
The partitioning problems focus on large circuit designs, when the entire circuit
cannot be physically mapped into one device. Because the logic and interconnect
needed for a circuit is time-multiplexed on a DR-FPGA, the DR-FPGA partitioning
problem is diﬀerent form the FPGA partitioning problem (Cong and Ding 1994;
Cong and Ding 1999; Huang, Jou, and Shen 2000; Chen and Cong 2001; Li, Mak,
and Katkoori 2003; Pandey and Chattopadhyay 2003; Kao and Lai 2005). The
major diﬀerence is that the execution order of circuit elements must satisfy the
precedence constraints. The DR-FPGA partitioning problem has been studied in
the recent literatures (Chang and M. Marek-Sadowska 1997; Liu and Wong 1998;
*Corresponding author. Email: cckao@mail.nutn.edu.tw
International Journal of Electronics
Vol. 97, No. 2, February 2010, 177–182
ISSN 0020-7217 print/ISSN 1362-3060 online
 2010 Taylor & Francis
DOI: 10.1080/00207210903268973
http://www.informaworld.com
Constraint 2. A sequential gate has to be scheduled in a stage no earlier than any
of its fan-out gates.
Notice that these two constraints are based on the fact that time can be only
forward and the output signal of a sequential gate has to be reserved to the next
macro cycle.
The output generated by an early stage has to be stored in a buﬀer so that it can
be fed to the input in the next stage. Generally, we use registers as buﬀers and call
them micro-registers. The number of micro-registers between stages greatly
inﬂuences the complexity of placement and routing. In our graph model, the
number of micro-registers can be observed from the number of crossing nets between
stages. Therefore, the DR-FPGA partitioning problem can be formulated as a
graph-based problem as follows:
Given: A DAG G ¼ (V, E) and a conﬁgurable unit of size U.
Constraints: (1) The size of each stage is less than or equal to U.
Constraints: (2) The precedence constraints are satisﬁed for all nodes in V.
Objective: Partition G into k stages such that the number of nets between stages
is minimised.
3. Proposed partitioning algorithm
In this section, a temporal sequential circuit partitioning algorithm is proposed. The
algorithm includes two phases: (1) labelling phase and (2) minimising cost phase. The
labelling phase is used to ﬁnd an initial partitioning which satisﬁes all constraints.
The number of micro-registers is optimised in the minimising cost phase.
3.1. Labelling phase
We use a labelling method to partition the given DAG into stages to satisfy the
precedence constraints. In this method, we give each node a label and allocate the
nodes with the same label into the same stage. The existing As-Soon-As-Possible
(ASAP) algorithm can be used to guarantee that each node is allocated to as early a
stage as possible and the existing As-Late-As-Possible (ALAP) algorithm is used to
guarantee that each node is allocated to as late a stage as possible. By the ASAP and
ALAP scheduling results, the precedence constraints are satisﬁed for all nodes in V.
Although the precedence constraints are satisﬁed by using the ASAP and ALAP
algorithm, those algorithms cannot be used in the DR-FPGA partitioning problem.
This is because the size of each stage must be considered. Hence, we proposed an
improved ASAP and ALAP algorithms to solve the DR-FPGA partitioning
problem. In the improved ASAP and ALAP algorithms, a queue Q is used to store
the nodes whose in-degrees are zero. The in-degree of a node is deﬁned as the number
of its incoming edges. Initially, Q is an empty set. Then, all PI nodes which have no
incoming edges in G are added to Q and labelled as zero. Starting from the PI nodes,
a traversal of the graph in topological order can label every node. A node is labelled
with the same tag as its fan-in nodes if the size of the stage is less than U; it is labelled
with new tag otherwise. By the same token, if the ALAP algorithm is performed, we
replace the fan-in, PI nodes with the fan-out, PO nodes which have no outgoing
edges respectively in the above procedure.
International Journal of Electronics 179
Sv. Let Iv denote the set of nodes that are the predecessors of node v and Vn be
deﬁned as the set of nodes in stage n, where 1  n  Depth.
We denote jVj as the size of the node set of the graph and jEj as the size of the
edge set of the graph. In the labelling phase, the ASAP and ALAP algorithms can be
performed by a traversal of all edges, so the running time is proportional to
the number of edges. Therefore, the time complexity of this phase is is O(jEj). In the
minimising cost phase, we can move each node to a suitable position and the running
time is proportional to the number of nodes of the graph. The complexity of deriving
Sv and Iv for all nodes v in G is O(jEj). Thus, the time complexity of the minimising
cost phase is O(jVj þ jEj). According to the above analysis, the total time complexity
of our circuit partitioning algorithm is O(jVj þ jEj).
4. Experimental results
We have implemented our algorithm in C language on Intel Pentium III 650 MHz
with 256 MB memory, and experimented on the MCNC partitioning 93 benchmark
circuits. We performed a set of experiments to compare the performance of our
approach with two of the best heuristics reported in literature (Liu and Wong 1998;
Chao et al. 1999). The ﬁrst heuristic is FBP-m (Liu and Wong 1998) which uses a
sequential ﬂow-based approach, and the second is PAT (Chao et al. 1999) which uses
a probability-based iterative-improvement approach. As in Liu and Wong (1998)
and Chao et al. (1999), we applied our algorithm for balanced partitioning into eight
stages. The results are shown in Table 1. Compared with FBP-m (Liu and Wong
1998) and PAT (Chao et al. 1999), our algorithm gets 34.9% and 38.6%
improvements in the number of communication cost. These results demonstrate
the eﬀectiveness of our algorithms.
5. Conclusions
We have proposed a sequential partitioning algorithm for DR-FPGA to reduce the
number of micro-registers. After the graph formulation for a circuit, we use ASAP
and ALAP scheduling algorithms to allocate the stage to each node to satisfy the
precedence constraints. To further minimise the number of micro-registers, we adjust
nodes for certain conditions and replicate nodes to make use of slack capacity of
Table 1. Comparison of 8-stage partitioning.
Algorithms
Circuit
The number of communication cost
FBP-m PAT Ours
C3540 166 126 112
C5315 165 157 131
C6288 114 114 72
S9234 502 430 320
S15850 877 808 740
S35932 2950 2628 2289
S38417 2892 3611 2018
Total 7666 7874 5682
Comparison þ34.9% þ38.6% 1
International Journal of Electronics 181
 1
出席國際學術會議心得報告 
                                                             
計畫編號 NSC 98-2221-E-024-005 
計畫名稱 MPEG 7 視訊影像系統之軟硬體共同設計 
出國人員姓名 
服務機關及職稱 
國立台南大學資訊工程系高啟洲副教授 
會議時間地點 韓國  江原道鳳凰城公園 2010/ 02/ 07~11 
會議名稱 2010  International Conference on Advanced Communication Technology 
發表論文題目 Chi-Chou Kao*, Jun Wu, and Shih-Chieh Chen, “Energy Efficient Clustering Communication Protocol for Wireless Sensor Network” 
 
(一) 出席目的 
氣候變化已成為世界各地人們共同關心的話題。使用各種遠程服務的基礎設
施，如遠程通訊，視頻會議，遠程醫療服務，以及遠程教育可以減少運輸量，
減少二氧化碳排放量。此外，監測環境變化的系統和救災系統可以降低經濟和
社會環境發生的災害費用。本會議主要在探討通信技術和環境兩觀點之間的關
係，我們稱之為“綠色信息和通信技術”。 
2010 先進通訊技術國際會議 2010 年 2 月 7-11 在韓國江原道鳳凰城公園舉
行，此會議是一個由國際電機電子工程師學會技術合作主辦在通信領域的年度
國際會議，所有的專家來自國內外，在會議中分享在未來的電信時代將實現的
新的想法和遠見。此會議中有 281 篇論文被接受且發表於會議中，論文發表的
形式為口頭報告與張貼部分，4 天的會議中共包含 44 個口報議程與 5 個海報張
貼議程。在口報議程中每位學者均有 15 分鐘的口頭發表時間，包括 12 分鐘的
學術論文報告和 3 分鐘的問題與討論。為了能瞭解並掌握綠色通信相關技術及
 3
的 Dr. Gyu Myoung Leec 針對 Service evolution for next generation network 的議題
進行專題演講。在演講中他對下一代網路的趨勢和服務作了簡要介紹特別是新
的概念，如下一代網路的融合，無處不在的網路進行了介紹。並對家庭網路， 
PTVI 和網路車輛等技術問題進行討論。第三個是邀請來自 KAIST, Korea 的 Prof. 
Munchurl Kim 針對 Technical Evolutions and Challenges with Recent ISO/IEC 
MPEG and ITU-T VCEG Standardization Efforts toward Next-generation 
high-performance Video Coding 的議題進行專題演講。在演講中介紹在視頻編碼
技術和相關國際標準化活動的最新進展，包括對下一代的高性能視頻編碼、移
動視頻以及超高清晰度視頻的內部預測編碼，除預測編碼，變換和量化，插值
和運動估計後過濾等技術。此演講課程對於本年度所執行的計畫有莫大的助
益，可將相關技術用於設計 MPEG7 的軟硬體設計上。 
本人於 2 月 9 日上午在會議中發表  “Energy Efficient Clustering 
Communication Protocol for Wireless Sensor Network”論文。這一個 section 都是
綠色通信技術相關領域的文章，從這一個 section 可以了解現在發展綠色通信技
術現況，本人進一步和與會的各位嘉賓互相切磋討論。 
 
攜回資料： 
  2010 International Conference on Advanced Communication Technology 會議手
冊與論文光碟。 
(PEGASIS) [10], TEEN [12]. The drawbacks of those 
schemes lie on 1) the determination of threshold value will 
affect the sensitivity of the whole system greatly; 2) there is 
no mechanism to distinguish a node which does not sense a 
“big” change from a dead or failed mode. In this paper, we 
will propose an energy efficient clustering communication 
protocol to select the cluster heads in higher density so that 
the cluster members are almost in the transmission range of 
the cluster heads for wireless sensor network.  
The remainder of this paper is organized as follows. In 
Section II, an energy efficient clustering communication 
protocol is introduced. Section III describes the proposed low 
energy consumption cluster-head selection algorithm in 
detail. The experimental results are shown and discussed in 
Section IV. Finally, Section V concludes this paper. 
II. ENERGY EFFICIENT CLUSTERING COMMUNICATION 
PROTOCOL DESIGN 
Assume that the base station is located far from the 
sensors and all nodes in the network are energy constrained. 
In the clustering protocol design, the whole process is 
divided into several rounds and each round is separated into 
two phases: 1) the set-up phase and 2) the steady-state phase 
as shown in Figure 2. The operations of those phases are 
described as follows: 
A. Set-up Phase  
The main activities in this phase are cluster setup. The set-
up phase is constituted by the cluster selection algorithm and 
the cluster formation algorithm. During each setup phase, the 
base station receives information on the current energy status 
from all the nodes in the network. The cluster selection 
algorithm first computes the average energy level of all the 
nodes from the base station, and then chooses a set of nodes, 
denoted S, whose energy levels are above the average value. 
Finally, the cluster selection algorithm will chose cluster 
heads for the current round from the set S, which ensures that 
only nodes with sufficient energy. The proposed low energy 
consumption clustering head selection algorithm will be 
further introduced in Section III. 
After selecting the cluster heads by using clustering head 
selection algorithm, the cluster formation algorithm is used 
to determine which cluster head is a non-cluster head node v 
belongs to. The distance between the source node and the 
destination node is selected as the key factor in our cluster 
formation algorithm. For a non-cluster head node v, a set of 
the distances between v and each cluster head is denoted as 
dis(v). If the distance between the cluster head u and v is 
minimal in dis(v), the non-cluster head node v belongs to the 
cluster whose cluster head is u. 
B. Steady-state Phase 
After partitioning all nodes into clusters, we must sense 
and transmit data of the nodes in a cluster to the cluster head. 
The cluster heads aggregate the collected data and sending 
the data to the base stations steady-state phase. In our design, 
the steady-state phase is divided into many frames. For every 
frame, the cluster members exchange messages with their 
cluster head once in a frame and in order with the slot time. 
The number of exchanging messages with the cluster head is 
the same as the number of the frames. In this steady-state phase, 
all cluster members collect the information from the 
environment and transmit the packets to the cluster head. The 
cluster-head may process some data fusion to reduce redundant 
data avoiding energy inefficient. 
To reduce energy dissipation, each non-cluster head node 
uses power control to set the amount of transmitting power 
based on the received strength of the cluster head advertisement. 
Furthermore, the radio of each non-cluster head node is turned 
off until its allocated transmission time. Since we optimize our 
design for the situation when all the nodes have data to send to 
the cluster head, using a time-division multiple-access (TDMA) 
schedule is an efficient choice of bandwidth and represents a 
low-latency and energy-efficient approach. The cluster head 
must be awake to receive all the data from the nodes in the 
cluster. Once the cluster head receives all the data, it performs 
data aggregation to enhance the common signal and reduce the 
uncorrelated noise among the signals.  
Data is sent from the cluster head nodes to the base station 
using a fixed spreading code and persistent carrier-sense 
multiple access (CSMA) protocol [15]. When a cluster head 
has data to send, it must sense the channel whether anyone else 
is transmitting using the base station spreading code or not. If 
so, the cluster head waits to transmit the data. Otherwise, the 
cluster head sends the data using the base station spreading 
code. This operation is repeated in every round, so the high 
energy dissipation in communication with the base station is 
spread to all sensor nodes and energy is saved extremely due to 
data aggregation in a cluster.  
 
 
(a) 
  
 (b)  
 
(c)  
Figure 2.  Time line (a) clustering communication protocol; (b) set-up 
phase; (c) steady-state phase 
C. Clustering Protocol Flow 
One of the main contributions in this paper is the design of 
the clustering protocol flow. In the traditional clustering 
protocol flow [7-12], if there are nodes that are redeployed, all 
nodes must perform repeat the set-up and the steady-state 
phases. Obviously, the traditional clustering protocols can 
increase latency and causes energy inefficiency in the 
redeployment procedure.  
FND and LND stand for the times at which the first and the 
last node die. HND stands for the time at which half of the 
nodes die. The results show that the proposed protocol can 
improve system lifetime compared with some existing 
approaches. 
 
  
(a) 
 
(b) 
Figure 3.  Number of alive nodes (a) frames = 20; (b) frames = 30 
 
Figure 4.  Energy dissipation of LEACH and improved selection 
method 
V. CONCLUSIONS 
In this paper, an energy efficient clustering 
communication protocol is proposed for wireless sensor 
network. The benefit of clustering protocol is the energy 
consumption can be distributed evenly to all nodes. Using 
the cluster-head selection algorithm in the proposed 
clustering communication protocol to select cluster heads in 
each round, the energy dissipation is reduced and the lifetime 
of wireless sensor network is extended. The experimental 
results demonstrate that the proposed protocol is efficient. 
ACKNOWLEDGMENT 
The authors are grateful to the support of National Science 
Council, Taiwan. The contributions through useful discussions 
with Prof. Yen-Tai Lai at Casdc Laboratory of National Cheng 
Kung University, Tainan are also acknowledged. 
 
Table 1. Timings of Node Deaths 
Energy (J) Protocol FND HND LND 
DIRECT 596 1147 4836 
LEACH 297 1247 2223 
PEGASIS 439 2259 2667 0.25 
PROPOSED 2278 2462 4956 
DIRECT 1192 2293 9672 
LEACH 1036 2927 4362 
PEGASIS 774 4496 5175 0.50 
PROPOSED 4555 4879 9872 
DIRECT 2383 4586 19343 
LEACH 2627 5603 7747 
PEGASIS 1428 9036 10443 1.00 
PROPOSED 8870 9545 19343 
REFERENCES 
[1] A. Manjeshwar, and D. P. Agrawal, “TEEN: A Routing Protocol for 
Enhanced Efficiency in Wireless Sensor Networks,” 1st International 
Workshop on Parallel and Distributed Computing Issues in Wireless 
Networks and Mobile Computing (IPDPS), April 2001.  
[2] Bulusu et al., “Scalable Coordination for Wireless Sensor Networks: 
Self-Configuring Localization Systems,” ISCTA 2001, Ambleside, U.K., 
July 2001.  
[3] Wang A. and Chandrakasan A. P., “Energy-efficient DSPs for Wireless 
Sensor Networks,” IEEE Signal Proceeding Magazine, vol. 19, issue 4, 
pp. 68-78, July 2002.  
[4] Agrawal D. P. and Zeng Q. A., “Introduction to Wireless and Mobile 
Systems,” Brooks/Cole Pacific Grove, CA, 2003. 
[5] Intanagonwiwat C., Govindan R., Estrin D., Heidemann J., and Silva F., 
“Directed Diffusion for Wireless Sensor Networking,” IEEE/ACM 
Transactions on Networking, vol. 11, issue 1, pp. 2-16, Feb. 2003. 
[6] Heinzelman W. B., Chandrakasan A. P., and Balakrishnan H., “An 
Application-specific Protocol Architecture for Wireless microsensor 
networks,” IEEE Transactions on Wireless Communications, vol. 1, 
issue 4, pp. 660-670, Oct. 2002. 
[7] Heinzelman W. B., Chandrakasan A. P., and Balakrishnan H., “Energy-
efficient communication protocol for wireless microsensor networks,” 
IEEE Proceedings of the 33rd Annual Hawaii International Conference 
on System Science, pp. 1-10, Jan. 2000. 
[8] Misra I. S., Dolui S., and Das A., “Enhanced Energy-Efficient Adaptive 
Clustering Protocol for Distributed Sensor Networks,” IEEE 
International Conference on Networks, vol. 1, pp. 16-18, Nov. 2005. 
[9] Liang Y. and Yu H., “Energy Adaptive Cluster-Head Selection for 
Wireless Sensor Networks,” Sixth International Conference on Parallel 
and Distributed Computing, Applications and Technologies, pp. 634-638, 
Dec. 2005. 
[10] Lindsey S. and Raghavendra C., “PEGASIS: Power-Efficient Gathering 
in Sensor Information system,” Proceedings of 2002 IEEE Aerospace 
Conference, pp. 1-6, Mar. 2002. 
[11] Lin T. H., Kaiser W. J., and Pattle G. J., “Integrated Low-Power 
Communication System Design for Wireless Sensor Networks,” IEEE 
Communication Magazine, vol. 42, issue 12, pp. 142-150, Dec. 2004. 
[12] Manjeshwar A. and Agrawal D., “TEEN: A Routing Protocol for 
Enhanced Efficient in Wireless Sensor Networks,” 1st International 
Workshop on Parallel and Distributed Computing Issues in Wireless 
Networks and Mobile Computing, Apr. 2001. 
[13] W. B. Heinzelman, A. P. Chandrakasan, H. Balakrishnan, “An 
Application-specific Protocol Architecture for Wireless Microsensor 
Networks,” IEEE Transactions on Wireless Communications, vol. 1, 
issue 4, pp.660-670, Oct 2002. 
 
98年度專題研究計畫研究成果彙整表 
計畫主持人：高啟洲 計畫編號：98-2221-E-024-005- 
計畫名稱：MPEG 7 視訊影像系統之軟硬體共同設計 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 1 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 3 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 2 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 1 0 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
 
