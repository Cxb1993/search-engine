 
 1 
行政院國家科學委員會專題研究計畫成果報告 
計畫編號：NSC99－2221－E－194－009 
執行期限：99 年 8 月 1 日至 100 年 7 月 31 日 
主持人：黃以文   國立中正大學機械工程學系 
計畫參與人員： 黃建蒼、徐與良 
 
中文摘要 
本研究之目的在於建立一套移動式攝
影的三維彎管重建系統，包含硬體的建置、
移動式攝影的理論推導及重建流程的技術
發展。本研究以先期計畫的技術為基礎，首
先設計一個機構使二台攝影機組可任意一
貣移動以拍攝彎管，其配置包含了背光箱、
校正板、兩台視訊攝影機、視訊定位架和彎
管。其次，推導移動攝影機的投影矩陣和基
本矩陣，由於二台攝影機的位置在變動，無
法產生彎管的絕對座標，故提出彎管重建的
相對參數。本研究所採用的方法以效率為重
點，因此使用擬人導引路徑法搜尋中心線來
增加處理速度，並能有效處理並解決彎管影
像之反光、交叉、急彎等問題。本研究使用
去頭截尾取平均的方法來從數組彎管相對
尺寸中得到最佳彎管相對尺寸，有效解決單
張影像品質不穩定造成彎管尺寸誤差過大
的問題。本研究最後在實驗時採行多角度拍
攝，有效解決單一角度拍攝造成某些彎管尺
寸誤差過大的問題。本研究的貢獻就是使用
優化影像處理來使得影像處理更切於實
際，進而實用於彎管量測。 
 
關鍵詞：移動式攝影機、彎管量測、電腦視
覺、三維重建 
 
Abstract 
The purpose of this research is to develop a 
3-D pipe reconstruction system with movable 
cameras, including establishing the hardware, 
deriving the theory, and implementing the whole 
process.  Based on the previous research, a 
mechanism for moving the cameras is designed 
and manufactured at first.  Next, the projection 
matrix and the fundamental matrix of cameras 
are derived and calibrated.  For reconstructing 
the 3-D pipe, a set of relative parameters are 
defined to present the dimension of the pipe.  
Then, the pictures will be treated with some 
image processes for removing the background, 
finding the border, center lines, and some 
characteristic points of the pipe.  A guidance 
method will be proposed to determine the 
accurate order of the straight pipes and arc pipes 
and solve the problem of the pipe image with 
reflective, cross, and sharp bends.  An 
optimization method is proposed to determine the 
average relative size of the pipe. Finally, the 3D 
pipe will be reconstructed with minimal errors. 
 
Keywords: movable cameras, pipes measurement, 
computer vision, reconstruction of pipes. 
 
 前言 
 
本人在 98 年度獲得國科會研究計畫「發
展電腦視覺系統應用於三維彎管之最佳化
量測技術」經費補助，已建置了一個背部光
源的拍攝場景，可架設二台固定的攝影機，
用以拍攝彎管，並發展了一套影像處理和重
建三維彎管的流程，該計畫之主要目的是克
服複雜管件(管件在照片中有交叉的狀況)的
重建技術，並以最佳化方法降低誤差。但從
該計畫的研究中也發現管件的拍攝角度對
於誤差的影響很大。一個彎管由很多直管和
弧管組成，若其中一段直管的軸線與其中一
台攝影機的視線(z 軸)平行時，該段直管將會
有極大的誤差，亦即拍攝角度不好的照片，
無論有再好的重建流程都無法產生優良的
重建結果，因此拍攝前如何將彎管擺設，以
使彎管中的每一段直管與二台攝影機皆保
持良好的拍攝角度是一個很重要的步驟。但
遇到複雜管件時，可能無法兼顧到每一段直
管的誤差。為解決此問題，本計畫建立一個
移動式的攝影系統，將原本固定式的攝影機
改為移動式，以動態的方式拍攝彎管，如此
可以產生各種角度的照片，可降低重建誤
差。 
 
 3 



















































y
x
m
m
m
m
m
m
m
m
m
m
m
yZyYyXZYX
xZxYxXZYX
33
32
31
24
23
22
21
14
13
12
11
10000
00001
(2)
  
 
使用 9 組對應點可得 
    pp BmA   (3)  
其中 
 











































































999999999
999999999
888888888
888888888
777777777
777777777
666666666
666666666
555555555
555555555
444444444
444444444
333333333
333333333
222222222
222222222
111111111
111111111
10000
00001
10000
00001
10000
00001
10000
00001
10000
00001
10000
00001
10000
00001
10000
00001
10000
00001
ZyYyXyZYX
ZxYxXxZYX
ZyYyXyZYX
ZxYxXxZYX
ZyYyXyZYX
ZxYxXxZYX
ZyYyXyZYX
ZxYxXxZYX
ZyYyXyZYX
ZxYxXxZYX
ZyYyXyZYX
ZxYxXxZYX
ZyYyXyZYX
ZxYxXxZYX
ZyYyXyZYX
ZxYxXxZYX
ZyYyXyZYX
ZxYxXxZYX
Ap
 
且 
   Tp yxyyxyxB 9982211 .....   
 
使用最小平方誤差法求出投影矩陣參
數，即 
 
          pTppTp BAAAm
1
  

  (4)  
 
已知投影矩陣和投影平面上一點 ( x , 
y )，令 x = x’/ w 且 y = y’/ w，則其投影關係
為： 

































1
1
'
'
333231
24232221
14131211
Z
Y
X
mmm
mmmm
mmmm
w
y
x  (5)  
所以 













1
'
1
'
333231
24232221
333231
14131211
ZmYmXm
mZmYmXm
w
y
y
ZmYmXm
mZmYmXm
w
x
x  (6)  
移項後成為 





yZymYymXymmZmYmXm
xZxmYxmXxmmZmYmXm
33323124232221
33323114131211
 (7)  
整理係數後成為 





24332332223121
14331332123111
)()()(
)()()(
myZymmYymmXymm
mxZxmmYxmmXxmm  (8)  
觀察式(8)可以發現這兩條三元一次方
程式代表空間中的兩個相交平面，如果此投
影平面上一點 ( x , y ) 為 2D 特徵點，則此
兩平面交線即為我們所要求的〝視極線〞。 
 
二、硬體設備 
本研究設計的校正板是使用三片黑色
板子垂直組合而成，並使用直徑 1cm 校正
點，如圖二所示。 
 
 
 
圖二 校正板 
使用兩台視訊  (WebCam) 來拍攝影
像，型號為 Microsoft LifeCam VX-700，如圖
三所示。 
 
圖三 視訊攝影機 
進行實驗時頇固定兩台視訊的相對位
置，所以使用視訊定位架來將兩台視訊固定
於兩端，如圖四所示，另外，此視訊定位架
設計成可由使用者任意移動與擺動，以便從
各種角度拍攝彎管的影像。 
 
 
圖四 視訊定位架固定兩台攝影機 
 
本研究所使用的實驗彎管為鐵製三段
粗彎管 (彎管直徑為 22 mm，彎管總長度為
671.17 mm)，如圖五所示，和鋁製四段細彎
管 (彎管直徑為 8 mm，彎管總長度為 750.41 
mm)，如圖六所示。 
 
圖五 鐵製三段粗彎管 
 5 
如圖十二所示，如果將彎管影像的明暗
變化用高低地形來表示，那〝搜尋彎管中心
離散點〞的工作就變成了〝尋找行走路徑〞
的工作。 
     
 
     
圖十二 將明暗圖像轉換成高低落差地形 
此步驟為在一張彎管影像上找出一個
低點(黑點)當成行走路徑的貣點，即圖十三
遮罩值小於 512。 
 
圖十三 尋低點的遮罩 
進行貣點定位 
此步驟的目的為修正初始低點，使其定
位在中心線處，進而使接下來的搜尋行進方
向點可以更順利的進行，如圖十四所示，其
步驟如下： 
 
圖十四 十字搜尋法 
(1) 將初始低點當作十字初始位置。 
(2) 尋找此十字在上下左右方向的〝第一個
白點，並以此白點到十字中心的距離當
做十字長度，以圖十五為例：則其十字
上邊長度(Uc) = 5；十字下邊長度(Dc) = 
4；十字左邊長度(Lc) = 7；十字右邊長
度(Rc) = 9。 
(3) 持續移動十字 (每次往上下左右之一的
方向移動一格的距離) 使之符合： 
 Uc + Dc ≧ Lc + Rc 且 |Lc - Rc| ≦ 1 
或者 
 Uc + Dc ＜ Lc + Rc 且 |Uc - Dc| ≦ 1  
即完成貣點定位的動作。 
 
搜尋行進方向點 
首先使用十六分度移動法來進行移動
方向的判定與記錄，如圖十六所示，即是此
移動步法的分度盤示意圖，並依下列規則來
運作： 
 
圖十五 十六分度遮罩 
(1) 此移動步法就是將半徑 3 的圓周度量化
成十六分度，以便簡化移動程序。 
(2) 以導引路徑來解釋，就是每一步往十六
分度其中之一的方向移動 3 步的距離。 
(3) 每次移動方向跟上一次移動方向相差不
會超過 1，即假如上一次往 5 的方向移
動，那麼本次只能往 4 ~ 6 的方向移動。 
(4) 每次移動皆以 0 ~ 15 紀錄下目前移動方
向與目前最佳移動方向，交替運用目前
移動方向與目前最佳移動方向是此移動
法之精髓。 
(5) 此移動法採行默認直進，意即假如陷入
無所適從情況，那麼將往上一步的移動
方向移動。 
 
藉由縮小半徑來搜尋目前最佳移動方
向，其目的在於找尋目前最佳移動方向，如
獲得移動許可，將以目前最佳移動方向取代
目前移動方向以便完成移動，以圖十七為
例，其步驟為： 
 7 
 
圖二十一 將 2D 特徵點轉換成 3D 視極
線 
 
四、彎管尺寸優化 
在連續拍照的實驗過程中，程式不斷地
得到彎管相對尺寸數據資料，接下來就是將
這些彎管相對尺寸數據資料經過處理，以便
得到彎管相對優化尺寸，如圖二十二所示，
其過程如下： 
(1) 當彎管相對尺寸數據未滿 15 組時，不處
理。 
(2) 當彎管相對尺寸數據剛好 15 組時： 
1. 將各個彎管尺寸數據分別處理。 
2. 將個別彎管尺寸數據由大到小排列。 
3. 去掉頭尾各 3 個數據 
4. 儲存中間 9 個數據當成取樣數據。 
5. 將此 9 個取樣數據取平均成彎管相對
優化尺寸。 
(3) 當彎管相對尺寸數據超過 15 組時： 
1. 將各個彎管尺寸數據分別處理。 
2. 假如第 1 個數據≧最新數據≧排擠閥
值，則將原本第 9 個取樣數據取代成
最新得到的數據，假如第 9 個數據≦
最新數據<排擠閥值，則將原本第 1
個取樣數據取代成最新得到的數據。 
3. 將此 9 個取樣數據取平均成彎管相對
優化尺寸。 
 
圖二十二 數據取樣示意 
 
五、重建實驗結果 
校正 
使用兩台視訊攝影機對著校正板拍攝
以得到投影矩陣，如圖二十三所示。 
 
圖二十三  校正實例 
 
三段粗彎管交叉影像實驗 
以三段粗彎管當做拍攝對象，擷取彎管
影像，如圖二十四所示。以影像處理程序進
行處理，如圖二十五所示。再重建為 3D 彎
管，如圖二十六所示。將重建的 3D 彎管投
影並與原來的影像做比較，求出誤差，如圖
二十七所示。 
  
圖二十四 擷取彎管影像 
  
圖二十五 彎管影像處理驗證結果 
  
  
  
圖二十六 彎管模型重建 
3D 視極線 
3D特徵點 
3D視極線 
 9 
[12] Z. Zhang, “A Flexible New Technique for 
Camera Calibration,” IEEE Transactions on 
Pattern Analysis and Machine Intelligence, 
Vol.22, No.11, 2000. 
[13] H. C. Longuet-Higgins, “A computer 
Algorithm for Reconstructing a Scene from 
Two Projections,” Nature, vol.293, Sept.10, 
pp. 133-135, 1981. 
[14] H. Greenspan, M. Laifenfeld, S. Einav, and 
O. Barnea, “Evaluation of Center-line 
Extraction Algorithms in Quantitative 
Coronary Angiography,” IEEE Transactions 
on Medical Imaging, Vol.20, No.9, 2001. 
[15] U. Bauer, and K. Polthier, “Parametric 
Reconstruction of Bent Tube Surfaces,” 
International Conference on Cyberworlds, 
pp.465-474, 2007. 
 
 計畫成果自評 
本計畫按照原先計畫書的規劃，成功的
發展出一套移動式攝影機重建三維彎管的
系統。本研究包含硬體和軟體的建立，包括
背光式拍攝箱，兩台數位相機，以及 Visual 
Basic 視窗介面程式。 
首先利用兩台相機對校正板進行拍
攝，求得各個相機之投影矩陣以及兩台相機
之間的基本矩陣。再對三維彎管進行移動式
拍攝，利用所提出的影像處理程序將所得之
兩張影像轉化為 3D 彎管，再以所提出的優
化程序，找出最佳的彎管尺寸。本計畫最後
以實例驗證其結果的有效度，並證明本計畫
所提出的方法確實具有可行性，並成功的降
低重建誤差。 
本計畫的部份研究成果已發表於國內
研討會，現在正規劃更深入的研究計畫，未
來將發展成隨機器加工的即時量測，以利加
工的監測。 
 
 
99 年度專題研究計畫研究成果彙整表 
計畫主持人：黃以文 計畫編號：99-2221-E-194-009- 
計畫名稱：應用移動式攝影於三維彎管重建系統之研究 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 1 1 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 2 2 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 2 2 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
