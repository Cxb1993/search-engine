行政院國家科學委員會專題研究計畫成果報告
實現一個新型高效率的音樂合成器--應用 HHT 時頻分析法
Implementation of An New Efficient Music Synthesizer by Using
HHT Time-Frequency Analysis
計 畫 編 號：NSC 98-2221-E-218-030-
執 行 期 限：98 年 8 月 1 日至 99 年 7 月 31 日
主 持 人：趙春棠 南台科技大學 電機工程系
計畫參與人員：蕭逸豪、邱興堯 南台科技大學 電機工程系
摘要
電腦音樂合成在現代音樂創作中，佔有極重
要的地位。一個好的音樂合成法，能讓音樂創作者
在最短的時間內，快速且精準地合成所要產生的樂
音。本論文應用 HHT 時頻分析法，實現一個新型
高效率的音樂合成器。鋼琴、長笛、以及小提琴等
樂器之樂音訊號，作為 HHT 時頻分析法之輸入，
藉以協助找出新型有效率的樂音合成法。實驗發現
只要能針對 HHT 時頻分析法所得之 IMF 及其瞬時
頻率，做有效的合成，即可合成出接近原樂器音色
的品質，本論文之研究成果，將可進一步應用於音
樂壓縮等技術。
關鍵詞：音樂合成、HHT、經驗模態分解、內建模
態函數
Abstract
Synthesizing musical sound plays an
important role on modern music composition.
Composers nowadays can easily take advantage of
powerful and user-friendly personal computers to
produce the desired musical sound with a good music
synthesis method. In this thesis, we will use the HHT
time-frequency analysis method, hoping to
implement an new efficient music synthesizer. By
applying the HHT technique, the original
varying-pitch music signals can be decomposed into
several intrinsic mode functions based on the
empirical mode decomposition. We expect the
synthesized results of the propsed project are very
close to the original tones. Furthermore, the research
results can be applied in advanced music synthesis or
compression in the future.
Keyword: Music Synthesis, HHT, Empirical Mode
Decomposition, Intrinsic Mode Functions
1. 前言
一般電子音樂合成法中，最常被應用的有波表
法（Wave Table），以及調頻法（FM）。然而這兩
種方法，已經不能滿足現今越來越嚴苛的品質要
求。電腦音樂合成在現代音樂創作中，佔有極重要
的地位。一個好的音樂合成法，能讓音樂創作者在
最短的時間內，快速且精準地合成所要產生的樂
音。近年來的音樂合成研究趨勢乃是試圖以實體模
型法（Model-Based Methods）[1]，如數位波導濾
波器 DWF（Digital Waveguide Filter）來模擬實體
樂器的物理特性，如圖 1 可以作為一般樂器的模
型，其中激發單元（Exciter）是非線性的部分，負
責產生振盪訊號源；而共振單元（Resonator）則是
屬於線性的部分，負責將振盪訊號傳導出去。如此
一來，就有許多研究利用類神經網路及最佳化等技
術，去針對不同的樂器，學習出以下的架構參數。
圖2則為IIR(Infinite Impulse Response)合成架構中
的重複性網路型式[2]，其中亦利用了類神經網路
作學習，利用 RNN(recurrent NN)設計預估濾波器
（Prediction Filter）。對於這種設計一良好的模式為
主的合成法，需要適合的激勵輸入方能產生一逼真
的合成音。而事實上，要精確的選擇一個樂器的模
型及參數是困難重重的，且不易控制，尤其在不了
解其非線性驅動的物理意義之下，更難合成出樂器
的原訊號。而且利用類神經網路學習，其費時及使
用大量參數，是可想而知的！
本 論 文 希 望 藉 由 對 希 爾 伯 - 黃 轉 換
(Hibert-Hung Transform, HHT)時頻分析法的了
解，能研發一套更有效率的合成方法。
圖 1. 樂器的非線性預估模型
是一個函數需滿足以下兩個條件：
(1)零點和極值的數量相差在一個以下。
(2)任一處的上包絡線(由局部極大值定義)和下包
絡線(由局部極小值定義)的平均值為零（即對
稱）。IMF 可視為是廣義的傅立葉轉換，隨時間變
化的振幅和瞬時頻率大大提升了計算效率。
2.3.2 EMD
HHT 在非穩態 AM-FM 等信號是一個強有力
的分析工具[7]，輸入信號拆解成簡單的 AM-FM
窄頻信號以至於 AM-FM 信號利用希爾伯特變換
不會干涉其它 AM-FM 信號。
圖7. 線性調頻信號的時頻ω(t) = 300 × 2πt獲得從
(a)HHT和(b)傅立葉變換。
比較HHT頻譜和傅立葉轉換隨時間針對一小
段的線性調頻信號的成分。觀察發現，HHT顯示比
傅立葉轉換有更好的解析度，其中白色代表著比較
高能量。尤其HHT的局部分析能力在更短時間的視
窗讓我們能夠分析隨時間變化的信號。圖7說明在
樂音瞬時音高之的分析上，HHT提供了很好的工
具。
EMD的本意，是一個可以將一訊號分解成數
個IMF和一個剩餘訊號的數學工具。IMF 可視為是
廣義的傅立葉轉換，隨時間變化的振幅和瞬時頻率
大大提升了計算效率，並讓我們可以得到訊號中非
線性和非穩態的特性。計算IMF 時，振幅資訊和
頻率資訊將被分離開來，因此克服了傅立葉轉換中
固定振幅和固定頻率的限制，得到則是隨時間變化
的振幅和頻率關係。EMD 可依據訊號特性將一原
訊號分解為多個子訊號。而 Sifting 是做EMD 計
算時，從訊號中提取IMF， Sifting 的運算流程如
下[8]：
1. 取得一段要處理的訊號s(t)如圖8。找出其局部極
大值所在點，以cubic spline 方法將所有局部極
大值相連，可得此訊號的上包絡線如圖9藍色線
所示。
2. 同樣的找出此訊號的局部極小值以cubic spline
方法相連，可得訊號的下包絡線如圖9紅色線所
示。
3. 計算上包絡線和下包絡線的平均值，可得一平
均線，令此平均線為m(t)如圖10所示。
4. 將原訊號和平均線 m 相減，令相減後所得的訊
號為
  tmtsth  (1)
上述由s(t)減去上下包絡線的平均線，如式(1)，求
得h(t)的過程即為sifting如圖11。式(2)是一個終止
準則來根據停止sifting，就是當成分 tnc 或殘餘訊
號 tnr 訊號過零點個數和極值個數之差小於1 為
止；或殘餘訊號成為單調函數不再可以提取
IMF ， sifting動作就結束。
  


n
i
ni trtcts
0
(2)
圖12、13、14分別為鋼琴A3、小提琴A4及長笛A4
作EMD的結果，影響樂器的音主要是在IMF1到
IMF4，所以我們就利用原音分解過後此4個音來萃
取的重要參數以達到完成合成音樂的依據。
圖8. 原始振動訊號
圖9. 極值上包絡線與下包絡線
圖10. 均值包絡線
圖11. 第一次轉移過程所得分量ht
提升了計算效率。
式(9)使代表振幅和瞬時頻率作為時間的函
數，可以畫成在三維圖上，如圖 15 為鋼琴 A4 的
三維圖，其中振幅可以顯示頻率在時間平面剖面
圖。這種振幅的頻率時間分佈的被指為希爾伯特振
幅頻譜  tH , 。簡單地來說就是希爾伯頻譜。
圖 15. 鋼琴 A4 三維圖
定義了Hilbert頻譜，我們也可以定義邊際頻譜
h 如式(11):
  dttHh
T
,
0
  (11)
邊際頻譜給予了全部振幅的分量（或能源）貢獻於
每個頻率值[9]。圖16也代表了鋼琴A4振幅累計在
整個數據範圍概率意義。
圖 16. 鋼琴 A4 Hilbert 邊際頻譜
訊號經 EMD 後取得數個 IMF，IMF 在定義上，取
平均要接近為零，因此，一個函數若屬於 IMF，分
別代表數個平穩性號，而 IMF 類似於弦波，但是
這些類似於弦波的部分其週期與振幅可以不是固
定，因此我們將解析出的 IMF 再經過 Hilbert 轉換
得到有意義的瞬時振幅(Instantaneous Amplitude，
在 本 論 文 中 ， 以 下 簡 稱 IA) 及 瞬 時 頻 率
(Instantaneous Frequency，在本論文中，以下簡稱
IF)，我們可以從各 IMF 來得到瞬時頻率及瞬時振
幅提取不同聲音的能量特徵向量，可以用來處理非
線性，及非穩態信號。依據瞬時頻率和瞬時振幅這
些數據就可以了解基音、節奏音的主音，使達到音
樂合成的依據來源。圖 17、18、19 分別為鋼琴 A4、
小提琴 A4 及長笛 A4 的瞬時頻率。圖 20、21、22
分別為各樂器採樣的瞬時振幅
圖 17. 鋼琴 A4 之 imf1_2_3_4_IF
圖 18. 小提琴 A4 之 imf1_2_3_4_IF
所分解出來的信號，所以只要重建還原成各 IMF
信號，就可以合成出原音色。在定義上，瞬時頻率
等於相位的微分，觀察 IF、IA 像弦波，可利用 FFT
提取主要係數，而對應的訊號，即可定義訊號的大
小與相位，所以我們可以從各 IMF 所提取出的瞬
時頻率及瞬時振幅來還原 IMF 信號，再把所有還
原後的 IMF 信號相加，就可以合成出原來訊號。
圖 23、24、25 分別為原音尚未考慮壓縮的各 IMF
與重建後的各 IMF。
圖 23.鋼琴 A4 之原 IMF 與重建 IMF
圖 24.小提琴 A4 之原 IMF 與重建 IMF
圖 25.長笛 A4 之原 IMF 與重建 IMF
3.3 減少音色資料方法之討論
為了實現一套有效率的合成方法，勢必要對音
色波形做壓縮，以減少音色數據所需的儲存空間。
我們將使用快速傅立葉轉換方式來壓縮數據係
數，因為分析訊號時，頻譜上之數值可清楚地展現
出訊號的特性，所以一般會將訊號轉換到頻率軸上
分析。又 FFT 是等時間間隔取樣的離散時間傅立
葉轉換，可以大幅減低計算上之複雜度。因離散傅
立葉轉換之時間正比於 2N ，即要做 2N 次乘法，
而 快 速 傅 立 葉 轉 換 之 運 算 時 間 正 比 於
NN 2log ，因此可提高運算效率。此步驟主要將
波形資料轉換為若干種不同的頻率，對重建後的
IMF 保留主頻帶，較小的頻率則因較不重要，可以
被捨棄以減少資料量，如圖 26，並再根據重要的
值恢復持續循環的部分，如圖 27。
頻率(Hz)
0 500 1000 1500 2000 2500 3000 3500 4000
100
200
300
400
500
600
700
800
900
捨棄
保留
圖 26.捨棄保留示意圖
儲存部分 持續循環
圖 27.複製重建訊號
4. 實現合成原音色
本文皆使用信號分析軟體 MATLAB 來完
成，利用法國人 Gabriel.Rilling 與中央大學數據分
析研究所提供的 HHT 程式碼來完成，論文中使用
到 的 副 程 式 碼 如 emd.m 、 emd_visu.m 、
hhspectrum.m、 toimage.m、disp_hhs.m，以下分別
說明如下。
emd.m
對輸入信號進行 EMD 分解。輸入原始訊
號 ts ，輸出可取得 IMF 成分。
hhspectrum.m
執行式(3)，對IMF分量求取瞬時頻率與振
幅。輸入對輸入訊號 ts 進行Hilbert變
換，輸出可得到每個IMF對應的瞬時頻率
與振幅與時間序列數據 ty 。
toimage.m
執行式(9)，對每個 IMF 信號合成求取
Hilbert 頻譜。輸入每個 IMF 瞬時振福
[9] F. Liu; X. Li, and Z. Liang ;,“Short-wave
Aviation Communication Signal Analysis and
Aircraft Classification ” , 2008 International
Multi-symposiums on Computer and
Computational Sciences, Page(s): 114 - 118
[10] http://www.phy.ntnu.edu.tw/java/sound/
[11] EMD 程式碼
http://perso.ens-lyon.fr/patrick.flandrin/emd.html
[12] 中央大學數據分析中心
http://rcada.ncu.edu.tw/research1_clip_program.h
tm
6. 計畫成果自評
眾所周知，傅利葉轉換可以做為一般周期
訊號的頻譜分析及合成。但對於非穩態、時變
訊號，或非線性訊號，傅利葉轉換的結果，並
不能顯示那些頻率在何時出現？亦即無法表
現 資 料 的 時 變 性 。 希 爾 伯 - 黃 轉 換
(Hibert-Hung Transform, HHT) 時頻分析法
是中研院黃鍔院士，依據 Hilbert 轉換之理
論，做更進一步的設計，是做為分析非穩定或
非線性訊號的一個非常理想的分析法。一般的
論文，多是用它來作訊號的分析，鮮少有探討
訊號合成的部分。
本計畫成功的應用目前中央大學數據分
析研究所提供的 HHT 程式碼，以及法國
Gabriel.Rilling 先生所公開的程式碼，完成樂器
音聲的合成，確實發現 HHT 分析法有許多獨到
之處，適合做為非穩態、時變訊號，或非線性
訊號的合成方法。未來應更進一步針對不同的
樂器音聲，及特殊演奏技巧，製做樂音資料
庫，展現 HHT 分析在音樂合成上的效能。
98年度專題研究計畫研究成果彙整表 
計畫主持人：趙春棠 計畫編號：98-2221-E-218-030- 
計畫名稱：實現一個新型高效率的音樂合成器--應用 HHT 時頻分析法 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 1 1 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 2 2 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
 
