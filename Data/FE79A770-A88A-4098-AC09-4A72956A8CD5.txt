 摘    要 
可調式數位濾波器由於在通訊及影像處理上有著廣泛之應用，近幾年相關
設計引起大家相當之重視。所謂可調式濾波器即濾波器相對之頻軸特性可隨某
些參數調整。以可調式FIR 數位濾波器而言，大致可分為兩大類。一為振幅或
截止頻率可隨參數而調變，另一為濾波器之延遲特性可隨參數而調變。在本計
畫中，我們將對上述兩類作廣泛之研究，並尋找更有效或更新之設計方法。本
計畫中我們完成了下列目標： 
1. 利用係數之關係以權重最小誤差均方法設計延遲可調式FIR 數位濾波器。 
2. 將McClellan 轉換法應用於可調式二維數位濾波器之設計。 
3. 以最小誤差均方法設計可調式極平FIR微分器。 
4. 以權重最小誤差均方法設計可調微分階數之微分器及可調積分階數之積分
器。 
5. 延遲可調式FIR 數位濾波器最大誤差最小化之設計。 
6. 以權重最小誤差均方法設計任意複數係數延遲可調式FIR 數位濾波器。 
7. 以權重最小誤差均方法設計複數係數之IIR 全通濾波器，並應用於延遲可
調式IIR 數位濾波器之實現。 
 
關鍵詞：可調式數位濾波器、延遲可調式數位濾波器、FIR數位濾波器、全通
數位濾波器、最小誤差均方法、權重最小誤差均方法、可調微分階數之微分器、
積分器、McClellan 轉換 
 Keywords: Variable digital filter, variable fractional-delay filter, FIR filter, allpass 
filter, least-squares method, iterative weighted least-squares method, minimax 
method, differentiator, integrator, McClellan transformation 
 
 1 
Chapter 1 
WLS Design of Variable Fractional-Delay FIR Filters Using 
Coefficient Relationship 
 
 
Abstract 
 
  In this chapter, a new coefficient relationship is proposed for the design of variable 
fractional-delay (VFD) FIR filters by the weighted least-squares (WLS) method, so that the 
number of filter coefficients to be designed can be approximately halved. To reduce the 
computational cost, closed-form expressions for the elements of related vectors and matrices 
are derived. Several design examples are presented and the comparisons show that the overall 
performance of the proposed method is comparable with that of the conventional method, 
however the number of filter coefficients to be designed for the proposed method is about a 
half of that in the conventional method. 
 
Keywords: Variable fractional-delay FIR filter, weighted least-squares approach, variable 
filter. 
 
 
I . INTRODUCTION 
 
  During the past decade, the design of variable fractional- delay (VFD) FIR filters has 
received considerable attention [1-14] due to their wide applications in comb filter design, 
sampling rate conversion, music instrument modeling and 3D binaural sound systems [15-18], 
etc. The VFD filters belong to a branch of variable digital filters which are applied 
applications in which the frequency characteristics need to be adjustable, and are generally 
implemented by the Farrow structure [1] in which a parameter is used to control the delay 
online without redesigning a new filter. 
  In this chapter, a new coefficient relationship is proposed for the design of VFD FIR filter. 
In [11] and [13], it has been shown that there exist symmetric/antisymmetric properties for the 
filter coefficients, and the number of filter coefficients to be designed can be reduced to about 
a half of the original design [1]. In this chapter, the proposed relationship enables the number 
to further reduce to about a half of that in [13]. For the purpose of comparison, the weighted 
 3 
( ) ( ) ( )2 2 1
0 1
, ,2 ,2 1 (5)
c sM MN N
m n m n
n N m n N m
H z p a n m p z a n m p z− − −
=− = =− =
= + −∑ ∑ ∑ ∑  
where 
2
1
2
, for even ,
(6)
1 , for odd .
M
c s
M
c s
M M M
M M M+
⎧ = =⎪⎨ + = =⎪⎩
 
Also, by the frequency characteristics in (1) with respect to ω , the coefficients ( ),a n m  are  
inherently symmetric as 
( ) ( )( )
, , for even ,
, 0 . (7)
, , for odd ,
a n m m
a n m n N
a n m m
⎧⎪− = ≤ ≤⎨−⎪⎩
 
Furthermore, by substituting 0p =  into (1) and (5), 
( ) 1 (8a)0D =ω,
and 
( ) ( ) (8 ),0 ,0N n
n N
H a z bz n −
=−
= ∑
which result in 
( ) ( ),0 . (9)a n nδ=  
So the frequency response of the designed filter can be written as 
( ) ( ) ( ) ( )
( ) ( )
2
1 1
2 1
1 1
, 1 0,2 2 ,2 cos
2 ,2 1 sin .
c
s
M N
j m
m n
M N
m
m n
H e p a m a n m n p
j a n m n p
ω ω
ω
= =
−
= =
⎡ ⎤= + +⎢ ⎥⎣ ⎦
⎡ ⎤− −⎢ ⎥⎣ ⎦
∑ ∑
∑ ∑
           (10) 
Let ca  and ( ),c ω pc  be ( )1 1c sN M NM⎡ ⎤+ + ×⎣ ⎦  vectors defined by 
( ) ( ) ( ) ( )0,2 , , ,2 , 1,1 , , ,2 1 (11 )Tc c sa a N M a a N M a⎡ ⎤−⎣ ⎦a = " "
and 
( ) ( ) ( ) ( )2 2 12, , , 2 cos , 2 sin , , 2 sin (11 )c s TM Mc ω p p p Nω j p ω j p Nω b−⎡ ⎤− −⎣ ⎦c = " "
Eq.(10) can be represented in vector product form as 
( ) ( ), 1 , (12)j Tc cH e p pω ω= + a c
where the superscript T  denotes a transpose operator. To approximate the desired response 
(1), the objective error function shown below can be used. 
 5 
( ) ( ) ( )2 1
1 1
2 ,2 sin sin . (17)
cM N
m
m n
na n m n p pω ω−
= =
⎡ ⎤ →⎢ ⎥⎣ ⎦∑ ∑   
Comparing (16b) with (17), it is found that there exists a coefficient relationship when 
c sM M=  (i.e. M  is even) namely 
( ) ( ),2 1 ,2 1,2, , , 1,2, , (18)ca n m na n m n N m M− ≅ = =, " "  
which is applied for the design of VFD FIR filters in this section. 
Substituting (18) into (10), Eq. (10) can be formulated into 
     ( ) ( ){ ( ) ( ) ( ) }
( )
2 2 2 1
1 1
, 1 0,2 ,2 2 cos 2 sin
1 ,
cM N
j m m m
m n
T
p p
H e p a m p a n m p n j np n
p
ω ω ω
ω
−
= =
⎡ ⎤= + + −⎣ ⎦
= +
∑ ∑
a c
    (19) 
where pa  and ( ),p ω pc  are ( )1 1cN M+ ×  vectors defined by 
( ) ( ) ( )0,2 , 1,2 , , , 2 (20 )Tp ca a a N M a⎡ ⎤= ⋅ ⋅⋅⎣ ⎦a
and 
( ) ( ) ( ) ( ) ( )2 2 12 2, , 2 cos 2 sin , ,2 cos 2 sin (20 )c c TM Mp p p p j p p N j Np N bω ω ω ω ω− ⎤⎡= − ⋅ ⋅ ⋅ −⎣ ⎦c
In this section, the objective error function becomes 
( ) ( ) ( ) ( )
( )
0.5
2
0.5
, , 1 ,
2 Re
p
p
T
p p p
T T
p p p p p p
e W p D p p dpd
s
ω
ω
ω ω ω ω
− −
= − −
= + +
∫ ∫a  a c
a p a Q a
              (21) 
where p cs s= , 
( )( ) ( )0.5
0.5
, -1 , (22 )
p
p
j p
p pW p e p dpd a
ω
ω
ω
ω ω ω
− −
= − ∫ ∫p  c  
and 
( ) ( ) ( )0.5
0.5
, , , , (22 )
p
p
T
p p pW p p p dpd b
ω
ω
ω ω ω ω∗
− −
= ∫ ∫Q c  c  
in which pp  is a ( )1 1cN M+ ×  vector and pQ  is a ( ) ( )1 1c cN M N M+ × +  matrix. 
Similarly, the optimal solution of the design problem is 
( )-1Re , (23)p p p= −a Q p
and the minimal weighted least-squares error ( )min pe a  can be obtained by substituting (23)  
into (21). 
Notice that the number of coefficients to be determined for even M  in this section is 
 7 
IV. COMPARISONS AND DISCUSSIONS 
Table Ⅰ 
Least-squares error, the maximum absolute error of variable frequency response and the maximum absolute delay error for 6M = , 0.9pω π= . 
Least-squares error 
Maximum absolute error of variable frequency 
response mε  
Maximum absolute 
delay error τε  N 
( )min pe a  ( )min ce a  mineP  ,m pε  ,m cε  meP  , pτε  ,cτε  eP τ  
11 5.6999e-005 5.6984e-005 0.00025019 0.036343 0.036334 0.00023817 0.55442 0.55803 -0.0064686
14 6.8934e-006 6.8923e-006 0.00015734 0.014181 0.014179 0.00013219 0.32017 0.32206 -0.0058637
17 8.6762e-007 8.6752e-007 0.00010834 0.0055276 0.0055271 8.8739e-005 0.17419 0.17511 -0.0052788
20 1.1237e-007 1.1236e-007 8.3719e-005 0.0021607 0.0021607 4.3437e-005 0.090498 0.090932 -0.004779 
23 1.4972e-008 1.4971e-008 0.00010032 0.00085817 0.00085816 1.4319e-005 0.045345 0.045544 -0.0043742
26 2.1457e-009 2.145e-009 0.00033332 0.00035127 0.00035127 -6.0261e-006 0.02207 0.02216 -0.0040715
29 4.295e-010 4.2887e-010 0.0014771 0.00015421 0.00015418 0.00020969 0.010485 0.010526 -0.0038924
32 1.9695e-010 1.9645e-010 0.0025635 9.4744e-005 9.4243e-005 0.005323 0.0048765 0.0048959 -0.0039593
35 1.6513e-010 1.6576e-010 -0.0038218 8.3315e-005 8.267e-005 0.0078047 0.0022202 0.0022303 -0.0045016
38 1.6073e-010 2.8558e-010 -0.43717 7.9585e-005 7.8583e-005 0.012748 0.00098529 0.00098687 -0.0016002
Table Ⅱ 
Least-squares error, the maximum absolute error of variable frequency response and the maximum absolute delay error for 33N = , 0.9pω π= . 
Least-squares error 
Maximum absolute error of variable frequency 
response mε  
Maximum absolute 
delay error τε  M 
( )min pe a  ( )min ce a  mineP  ,m pε  ,m cε  meP  , pτε  ,cτε  eP τ  
2 0.0036052 0.0035818 0.006529 0.17228 0.16842 0.022966 0.071953 0.075553 -0.047649 
4 1.4969e-006 1.4889e-006 0.0053703 0.0056248 0.0055515 0.013212 0.0059139 0.0060949 -0.029698 
6 1.791e-010 1.7876e-010 0.0018942 8.9587e-005 8.9176e-005 0.004598 0.0037608 0.0037765 -0.0041626 
8 1.9086e-011 1.409e-010 -0.86454 3.6659e-005 4.4608e-005 -0.1782 0.0038021 0.0038145 -0.0032551 
Table Ⅲ 
Least-squares error, the maximum absolute error of variable frequency response and the maximum absolute delay error for 9M = , 0.9pω π= . 
Least-squares error 
Maximum absolute error of variable frequency 
response mε  
Maximum absolute 
delay error τε  N 
( )min pe a  ( )min ce a  mineP  ,m pε  ,m cε  meP  , pτε  ,cτε  eP τ  
9 0.00024072 0.00024068 0.0001871 0.06785 0.067934 -0.0012283 0.76676 0.77156 -0.0062221 
12 2.803e-005 2.8027e-005 0.00012053 0.026615 0.026628 -0.00046776 0.46564 0.4682 -0.0054875 
15 3.4415e-006 3.4412e-006 8.7473e-005 0.010394 0.010396 -0.00013005 0.2632 0.26444 -0.0046893 
18 4.3755e-007 4.3752e-007 6.7454e-005 0.0040498 0.0040505 -0.00016244 0.14086 0.14143 -0.0040328 
21 5.7021e-008 5.7018e-008 5.3468e-005 0.0015758 0.0015765 -0.00042421 0.072257 0.072512 -0.0035259 
24 7.5692e-009 7.5688e-009 4.2832e-005 0.00061269 0.00061316 -0.00076547 0.035852 0.035965 -0.0031179 
27 1.0192e-009 1.0193e-009 -8.1257e-005 0.00023813 0.00023833 -0.00083211 0.017324 0.017372 -0.0027352 
30 1.3882e-010 1.4396e-010 -0.035737 9.2605e-005 9.2494e-005 0.0012011 0.0081941 0.0082134 -0.0023505 
33 1.9349e-011 1.3447e-010 -0.85611 3.6164e-005 3.8785e-005 -0.067566 0.003808 0.0038088 -0.0002101 
 9 
for odd M , and the VFD FIR filter can be designed in a similar manner as in Section Ⅲ. 
Here, the total number of filter coefficients to be designed is 
( )( )1 1
2 (30)
N M N+ − +  
which is also much smaller than that in (25). The comparisons for odd M  are tabulated in 
Table Ⅲ with 9 33,N≤ ≤ 9,M =  and 0.9pω π= . 
In TablesⅠ, Ⅱ and Ⅲ, it can be found that the overall performance of the proposed 
method is better for higher-order filter design while the conventional method performs well 
for lower-order filter design. However, the number of filter coefficients to be designed for the 
proposed method is only about a half of that in the conventional method. Furthermore, the 
maximum absolute delay errors of the proposed method are smaller than those of the 
conventional method for all cases. 
 
 
(a) 
 
(b) 
Fig. 2. A VFD FIR filter with 20N = , 6M = , 0.9pω π= . 
(a) Absolute error of variable frequency response. (b) Absolute delay error. 
 
 11 
[11] C.-C. Tseng, “Design of variable fractional delay FIR filter using symmetry,’’ in Proc. ISCAS, 
2004, pp. 477-480. 
[12] H. Zhao and J. Yu, “A simple and efficient design of variable fractional-delay FIR filters,’’ 
IEEE Trans. Circuits Syst. II, Exp. Chapters, vol. 53, no. 2, pp. 157-160, Feb. 2006. 
[13] T.-B. Deng, and Y. Lian, “Weighted-least-squares design of variable fractional-delay FIR 
filters using coefficient symmetry,’’ IEEE Trans. Signal Process., vol. 54, no. 8, pp. 
3023-3038, Aug. 2006. 
[14] T.-B. Deng, “Symmetric structures for odd-order maximally flat and weighted-least- squares 
variable fractional-delay filters,’’ IEEE Trans. Circuits Syst. I, Reg. Papers, vol. 54, no. 12, 
pp. 2718-2732, Dec. 2007. 
[15] S.-C. Pei and C.-C. Tseng, “A comb filter design using fractional sample delay,” IEEE Trans. 
Circuits Syst. II, vol. 45, pp. 649-653, June 1998. 
[16] K. Rajamani, Y. S. Lai and C. W. Farrow, “An efficient algorithm for sample rate conversion 
from CD to DAT,” IEEE Signal Processing Lett., vol. 7, pp. 288-290, Oct. 2000. 
[17] D. B. H. Tay, S. S. Abeysekera, and A. P. Balasuriya, “Audio signal processing via harmonic 
separation using variable Laguerre filters,” in Proc. 2003 IEEE Int. Symp. Circuits Systems, 
May 2003, vol. III, pp. 558–561. 
[18] F. P. Freeland, L. W. P. Biscainho and P. S. R. Diniz, “HRTF interpolation through direct 
angular parameterization,” in Proc. 2007 IEEE Int. Symp. Circuits and Systems, May 2007, 
pp. 1823-1826. 
 
 
 
 13
investigated again. Comparing with [18] and [19], the proposed method designs both variable 2-D 
subfilters and variable 1-D prototype filters. Moreover, they are tunable by the same variable parameter, 
such that the variable characteristics of 1-D prototype filters are coincident with those of 2-D subfilters. 
The chapter is organized as follows. Section Ⅱ deals with the variable structure of 2-D filters 
designed by McClellan transformation, which are modified from the Farrow structure [20]. In Section 
Ⅲ, the design of variable 2-D fan filters is proposed. First, a cut-off frequency orbit function is found 
by solving an overdetermined system; and then both variable 2-D subfilters and variable 1-D prototype 
filters are designed by least-squares approach [21]-[24]. Finally, the coefficients of variable 2-D filters 
can be obtained by using the recurrence relations for Chebyshev polynomial. Following the steps in 
Section Ⅲ, the designs of variable circularly symmetric filters and variable elliptically symmetric 
filters with arbitrary orientation are presented in Section Ⅳ and Section Ⅴ, respectively. Finally, the 
conclusions are given in Section Ⅵ. 
 
II. STRUCTURE OF THE PROPOSED VARIABLE 2-D FIR FILTERS 
 
For a variable zero-phase FIR digital filter, its frequency response is represented by  
 
( ) ( ) ( )
0
cos ,
N
p
n
H a n n
=
ω = ω∑                            (1) 
 
in which ( )spa n  are expressed as the polynomials of p  
( ) ( )
0
, .
M
m
p
m
a n a n m p
=
= ∑                       (2) 
 
Replacing ( )cos nω  in (1) by the thn order Chebyshev polynomial, Eq.(1) becomes  
 
( ) ( ) ( )[ ]
0
cos .
N
p n
n
H a n T
=
ω = ω∑                   (3) 
 
Following the McClellan transformation [1]–[11] and substituting the variable 2-D transformation 
subfilter  
 
( ) ( )
( ) ( ) ( ) ( ) ( ) ( )
1 2
1 2 1 2
0 0 1 1
cos ,
, cos cos , sin sin
q
I J K L
q q
i j k l
F
t i j i j s k l k l
= = = =
ω = ω ω
= ω ω + ω ω∑∑ ∑∑      (4) 
 
into (3), we can obtain the frequency response of the desired variable 2-D filter 
 15
 
Fig. 1. (a) Structure of the proposed variable 2-D FIR filters.( 5N = ) (b) Variable coefficient generator for both variable 1-D 
prototype filters and variable 2-D subfilters. ( ( )pc i  may be as ( )pa i , ( ),pt i j  or ( ),ps i j ) 
 
III. DESIGN OF VARIABLE 2-D FIR FAN FILTERS 
 
For designing 2-D fan filters, the original substitution  
 
( ) ( ) ( ) ( ) ( ) ( ) ( ) ( ) ( )1 2 1 2cos 0,0 1,0 cos 0,1 cos 1,1 cos cost t t tω = + ω + ω + ω ω         (7) 
 
is used in McClellan transformation. To avoid scaling problem, it is desirable to give the following 
constraints: (i) the 1-D frequency origin, 0ω =  , is mapped into the ( )0,π  point of the 2-D 
frequency plane, and (ii) the point ω = π  of the 1-D frequency is mapped into the ( ),0π  point of the 
2-D frequency plane, which result in  
 
( ) ( )0,0 1,1 ,t t=                                   (8a) 
and 
( ) ( )1,0 1 0,1 .t t= +                                (8b) 
 
Hence the transformation becomes  
 
( ) ( ) ( ) ( )( ) ( ) ( ) ( )( ) ( )1 2 1 2 1cos 1,1 1 cos cos 0,1 cos cos cos .t tω = + ω ω + ω + ω + ω       (9) 
( )1 2,pF ω ω ( )1 22 ,pF ω ω ( )1 22 ,pF ω ω ( )1 22 ,pF ω ω ( )1 22 ,pF ω ω
( )0pa  ( )1pa  ( )2pa ( )3pa ( )4pa  ( )5pa
-1 
-1 
-1
-1
(a) 
p
( ),c i M ( ), 1c i M − ( ), 2c i M −  
( )pc i  
( ),1c i ( ),0c i  
(b)
 17
stopband
passband
θ
0 1
0
0.5
0.5
1
Normalized frequency ω1/ π
N
or
m
al
iz
ed
 fr
eq
ue
nc
y 
  ω
2/π
N
or
m
al
iz
ed
 fr
eq
ue
nc
y 
  ω
2/π
 
 
Fig. 2. Specification of a 2-D fan filter within the first quadrant. 
 
 
For a given inclination angle θ  of the 2-D fan filter, the cut-off frequency cω  of the 1-D prototype 
low-pass filter is chosen as follows. For example, if 35°θ = , Fig. 3 presents the error curve of (10) 
when ω  varies in [ ]0, π , in which the errors are computed by substituting 11
2
T Q R−= −  into (10) 
for each ω , and the ω  corresponding to the smallest error is exactly the desired cω = 0.6392π . 
 
 
 
Fig. 3. The error curve of Eq.(10) when ω  varies in [ ]0, π  for 35°θ = . 
 
 
When different values of inclination angle θ  are given for designing 2-D fan filters, the 
corresponding cut-off frequency cω  of the 1-D prototype low-pass filter is also changed according to 
θ . To illustrate the relationship between θ  and cω , Fig. 4(a) shows the cut-off frequency orbit for 
individual design with integer inclination angles in the range 30 45≤ θ ≤D D  marked by “ D ”. 
 
A. Determination of the Cut-Off Frequency Orbit Function 
To further design variable 2-D subfilters and variable 1-D prototype filters, a function ( )c pω , 
which can represent the cut-off frequency orbit shown in Fig. 4(a), should be determined. In this 
chapter, the method for solving least-squares problems, which occur in overdetermined systems [25], is 
applied as follows. 
 19
( ) ( ) ( ) ( ) ( )21,1 1,1,0 1,1,1 1,1, 2 1,1, Mpt t t p t p t M p= + + + +"            (20a) 
and 
( ) ( ) ( ) ( ) ( )20,1 0,1,0 0,1,1 0,1,2 0,1, .Mpt t t p t p t M p= + + + +"           (20b) 
 
To find the subfilter coefficients in the least-squares sense, the objective error function is represented 
by  
 
( ) ( )( ) ( ) ( )
( )2
1
2
1 2 1 1
0
2 2 2
cos cos ,T T C
R T T Q T
u pp
t
p c p
p
t t
p p p
e p p d dp
s
ω
⎡ ⎤= ω − ω − ω ω⎣ ⎦
= + +
∫ ∫
          (21) 
 
where ( )1 1tanp = θ , ( )2 2tanp = θ , 
 
( ) , 0 1 ,
, 1 ,u
p
p
p p
π ≤ ≤⎧ω = ⎨π >⎩
                                 (22a) 
 
( ) ( ) ( ) ( )1,1,0 , , 1,1, , 0,1,0 , , 0,1, ,T tp t t M t t M⎡ ⎤= ⎣ ⎦" "                     (22b) 
 
( ) ( ) ( ) ( ) ( )( )
( ) ( ) ( ) ( )( )
2 1 1 1 1 1
1 1 1 1
, 1 cos cos , , 1 cos cos ,
cos cos , , cos cos
C M
M t
p p p p
p p p
ω = + ω ω + ω ω⎡⎣
⎤ω + ω ω + ω ⎦
"
"
             (22c) 
and  
( )( ) ( )( )2
1
2
2 1 1
0
cos cos ,
u pp
c
p
s p d dp
ω
⎡ ⎤= ω − ω ω⎣ ⎦∫ ∫                             (23a) 
( )( ) ( ) ( )( )2
1
2 1 2 1 1
0
2 cos cos , ,R C
u pp
c
p
p p d dp
ω
⎡ ⎤= − ω − ω ω ω⎣ ⎦∫ ∫                     (23b) 
( ) ( )
( )2
1
2 2 1 2 1 1
0
, , .Q C C
u pp
t
p
p p d dp
ω
= ω ω ω∫ ∫                               (23c) 
 
So the transformation coefficient vector Tp  can be obtained by differentiating (21) with respective to 
A  and setting the result to zero, which results in  
 21
( ) ( )( )( ) ( ) ( )
( )
2 2
1 1
2
1 1 1
0
1 1 1
1 , , ,A A C A C C A
R A A Q A
c
c T
pp p
t t t
p p p
t t
e p d dp p p d dp
s
ω π
ω +ω
= − ω ω + ω ω ω
= + +
∫ ∫ ∫ ∫
       (29) 
where 
( )2
1
1
0
1 ,
c pp
p
s d dp
ω
= ω∫ ∫                                                    (30a) 
( )
( )2
1
1 1
0
2 ,R C
c pp
p
p d dp
ω
= − ω ω∫ ∫                                        (30b) 
and 
( ) ( )
( )
( ) ( )
( )
2 2
1 1
1 1 1 1 1
0
, , , , .Q C C C C
c
c T
pp p
t t
p p p
p p d dp p p d dp
ω π
ω +ω
= ω ω ω + ω ω ω∫ ∫ ∫ ∫      (30c) 
 
Also, differentiating (29) with respect to A  and setting the result to zero, the solution is given by  
 
1
1 1
1 .
2
A Q R−= −                                        (31) 
 
For example, when 17N = , 5M = , 0.1Tω = π , ( )1 tan 30p = D  and ( )2 tan 45p = D , the 
magnitude responses of the variable 1-D prototype low-pass filter are shown in Fig. 4(c). 
 
D. Derivation of Variable 2-D Fan Filters 
Once the variable 2-D subfilter and the variable 1-D prototype filter have been designed, we can 
obtain the coefficients of variable 2-D fan filters by (5) after some mathematic manipulations. Fig. 4(d) 
presents the obtained magnitude responses of the variable 2-D fan filter for ( )tan 30p = D , ( )tan 35D , 
( )tan 40D  and ( )tan 45D . To explicitly illustrate the result of the designed filter, the parameters in B  
and the coefficients in Tp  are tabulated in Table Ⅰ companying with those of other examples. 
 23
 
(d) 
Fig. 4. Design of a variable 2-D fan filter. (a) The cut-off frequency orbit of 1-D prototype low-pass filters. ( D  and solid line: 
individual design, ×  and dotted line: variable design) (b) The isopotential cut-off edge contours for different integer inclination 
degrees from 30D  to 45D . (c) Magnitude responses of variable 1-D prototype low-pass filter. (d) Magnitude responses of 
variable 2-D fan filter for ( )tan 30p = D , ( )tan 35D , ( )tan 40D  and ( )tan 45D . 
 
IV. DESIGN OF VARIABLE 2-D CIRCULARLY SYMMETRIC FILTERS 
 
In this section, the transformation of (7) is used for designing 2-D circularly symmetric filters. Also, 
there are three constraints to be considered: (i) 0ω =  is mapped into ( )0,0 , (ii) ω = π  is mapped 
into ( ),π π , and (iii) ( ) ( )1,0 0.1t t=  due to the symmetric contour, which result in  
 
( ) ( )0,0 1,1t t= −                                 (32a) 
and 
( ) ( ) 11,0 0,1 .
2
t t= =                                        (32b) 
 
So the transformation becomes 
 
( ) ( ) ( ) ( ) ( ) ( )( )1 2 1 21 1cos cos cos 1,1 cos cos 12 2 tω = ω + ω + ω ω −           (33) 
 
 
 
 25
For the design of the variable 1-D prototype low-pass filter, it is similar to that in part C of Section 
Ⅲ except that the cut-off orbit function ( )c pω  in (29) and (30) is replaced by that illustrated in  
Fig. 5(a). For example, when 17N = , 0.1Tω = π , 1 0.35p = π  and 2 0.6p = π , the magnitude 
responses of the variable 1-D prototype low-pass filter are shown in Fig. 5(c). Also, the final magnitude 
responses of the variable 2-D circularly low-pass filter for 0.35p = π , 0.45π , 0.55π  and 0.6π  are 
illustrated in Fig. 5(d), and the root-mean-squared deviation error of the variable cut-off isopotentials is 
computed by 
 
( ) ( ) ( ) ( ) ( )
( ) ( )2 1
1
1
ˆ ˆ 22
2 2
1 2 11
1 0
1
ˆ ˆ 1
ˆ ˆ1 2
1 1 1 ,ˆcos cos cos ,ˆ2 2
1ˆ ˆ, cos , (38)
T C
n
N I
t
rms c i p i nn i
n i
r r
n r i n
N I
i
N I
pp
n
p p π
ε ω ω ωω
ω ωω ω
= =+
−
⎡ ⎤⎛ ⎞= ⎢ ⎥− − −⎜ ⎟−⎝ ⎠⎢ ⎥⎣ ⎦
−− ⎛ ⎞= + = ⎜ ⎟⎝ ⎠
∑∑
 
where 
ncω , ˆ1 n N≤ ≤ , are the cut-off frequencies shown in (35), Nˆ  and Iˆ  are set to be 41 and 100 
respectively in this example, which result in 0.00082956957rmsε = . 
 
 
(a) 
 
(b) 
 27
is used to design variable 2-D elliptically symmetric filters. For an ellipse rotated by an angle θ  with 
respective to 2ω -axis as shown in Fig. 6, it can be described by the curve L  
 
2 2
1 2 1 2
2 2
: 1
A B C
ω ω ω ω+ + =L                                          (40) 
 
in which 
( )
2
2
2
2
,
1 1 sin
aA
a
b
= ⎡ ⎤⎛ ⎞− − θ⎢ ⎥⎜ ⎟⎝ ⎠⎣ ⎦
                                  (41a) 
 
( )
2
2
2
2
,
1 1 sin
bB
b
a
= ⎡ ⎤⎛ ⎞− − θ⎢ ⎥⎜ ⎟⎝ ⎠⎣ ⎦
                                    (41b) 
 
( )
,
sin 2
a bC
b a
a b
= ⎛ ⎞− θ⎜ ⎟⎝ ⎠
                                       (41c) 
 
where a  and b  are semiminor axis and semimajor axis respectively.  
 
θ
Normalized frequency ω1/ π
N
or
m
al
iz
ed
 fr
eq
ue
nc
y 
  ω
2/π
0 10.5-0.5-1
1
0.5
0
-0.5
-1
passband
stopband
N
or
m
al
iz
ed
 fr
eq
ue
nc
y 
  ω
2/π
 
 
Fig. 6. Specification of a 2-D elliptically symmetric low-pass filter. 
 
For designing a 2-D elliptically low-pass filter with arbitrary orientation, there are two constraints to 
be considered: (i) 0ω =  is mapped into ( )0,0  and (ii) ω = π  is mapped into ( ),0π , which result 
in 
 
 29
( ) ( ) ( ) ( ) ( ) ( )0,0,0 , , 0,0, , 1,0,0 , , 1,0, , 1,1,0 , , 1,1, ,T tp t t M t t M s s M⎡ ⎤= ⎣ ⎦" " "     (47a) 
 
( ) ( ) ( )( ) ( ) ( ) ( )
( ) ( ) ( )( ) ( ) ( ) ( ) ( )
2 1 2 2 2 1 1 2
1 1 2 1 2 1 2
, , 1 cos , , 1 cos , cos cos cos , ,
cos cos cos , sin sin , , sin sin (47b)
C M
tM M
p p
p p
ω ω = − ω − ω ω − ω ω⎡⎣
⎤ω − ω ω ω ω ω ω ⎦
" "
"
 
and dl⋅∫
L
 denotes a line integral along the curve of (40) for a given variable parameter p . Fig. 7(b) 
presents the isopotential cut-off edge contours when the variable parameter p  varies from 1p  to 2p  
and 5M = . As to the design of the variable 1-D prototype low-pass filter, the magnitude responses are 
shown in Fig. 7(c) with 17N =  and 0.1Tω = π . The final magnitude responses of the variable 2-D 
elliptically symmetric low-pass filter for 35θ = − D , 0D , 20D  and 35D  are shown in Fig. 7(d). In this 
example, the root-mean-squared deviation error of the variable cut-off isopotentials is given by 
 
( ) ( ) ( ) ( ) ( )( )
( ) 2 2
2 2 2 2 2
1
ˆ ˆ 2
2
1 2 2 1 2
1 0
1
2
1
1 2 1
ˆ ˆ 1
ˆ
θ + -1
180
1 ,ˆcos cos cos , ,
ˆ , , , tan , (48)
T C
n
i i
N I
t
rms c i i p i i n
n i
n i i i i i
N I
A B C i
IB C t A C t A B
n
p
p t t ππ
ε ω ω ω ω ω
ω ω ω
= =+
+ +
⎡ ⎤= ⎢ ⎥− −⎢ ⎥⎣ ⎦
⎛ ⎞ ⎛ ⎞= = = =⎜ ⎟ ⎜ ⎟⎜ ⎟ ⎝ ⎠⎝ ⎠
∑∑
 
where 
ncω , ˆ1 n N≤ ≤ , are shown in (45), Nˆ  and Iˆ  are set to be 71 and 180 respectively, and A , 
B , C  are computed by substituting 1θ θ 1n= + −  into (41). It is noted that 
2 2
2 2 2
1
2
1
i
i
A B
B t A
ω
+
⎛ ⎞= ⎜ ⎟⎜ ⎟⎝ ⎠
  in 
(48) for θ 0°= . After numerical computing, 0.0023465039.rmsε =  From Table.Ⅰ, it is noted that 
part of the parameters and transformation coefficients are identical to zero due to the symmetric 
inclination angle θ  from 35°−  to 35° . 
 
(a) 
 31
 
TABLE Ⅰ  
KEY PARAMETERS AND COEFFICIENTS OF DESIGN EXAMPLES IN SECTIONS Ⅲ, Ⅳ AND Ⅴ. 
Filter type 
Parameter or 
coefficient
0m =  1m =  2m =  3m =  4m =  5m =  
mb  -2.04322328 32.20723380 -88.0508272 113.5059863 -72.1579550 18.1095582
( )1,1,t m 3.02375334 -21.9566855 57.36713194 -73.2552950 46.47093892 -11.64982673Fan filter 
( )0,1,t m -1.03789222 2.33913302 -5.52821493 7.22614574 -4.65412569 1.15497911
mb  -2.19629415 8.26878967 -9.89881179 6.56464429 -2.16181433 0.28267709Circularly 
low-pass filter ( )1,1,t m -2.51484883 9.28178430 -12.3489441 8.16698611 -2.67744830 0.34882319
mb  0.78500497 0 0.26813984 0 0.12663328 0
( )0,0,t m -0.04910226 0 -0.00696770 0 -1.16305050 0
( )1,0,t m 0.75665662 0 -0.83238351 0 0.66070086 0
Elliptically 
low-pass filter 
( )1,1,s m 0 -0.79109034 0 0.114054766 0 -0.18898194
 
 
VI. CONCLUSIONS 
 
In the chapter, the technique of conventional McClellan transformation has successfully been 
extended to design variable 2-D FIR digital filters. Once the cut-off frequency orbit function is 
determined, both variable 2-D transformation subfilter and variable 1-D prototype filters can be 
designed and are adjustable by the same variable parameters. From the presented numerical examples, 
the effectiveness and flexibility of the proposed method have been fully depicted by the presented 
illustrations.  
 
REFERENCES 
 
[1] J. H. McClellan, “The design of two-dimensional digital filters by transformations,” in Proc. 7th Ann. 
Princeton Conf. Information Sci., 1973, pp. 247–251. 
[2] R. M. Mersereau, W. F. G. Mecklenbräuker and T. F. Quatieri, JR., “McClellan transformations for 
two-dimensional digital filtering: Ⅰ―design,” IEEE Trans. Circuits Syst., vol. 23, pp. 405–414, July 1976. 
[3] R. M. Mersereau, W. F. G. Mecklenbräuker and T. F. Quatieri, JR., “McClellan transformations for 
two-dimensional digital filtering: Ⅱ―implementation,” IEEE Trans. Circuits Syst., vol. 23, pp. 414–422, 
July 1976. 
[4] J. H. McClellan and D. S. K. Chan, “A 2D FIR filter structure derived from the Chebyshev recursion, ” 
IEEE Trans. Circuits Syst., vol. 24, pp. 372–378, July 1977. 
[5] M. S. Reddy and S. N. Hazra, “Design of elliptically symmetric two-dimensional FIR filters with arbitrary 
orientation,” Electronics Lett., vol. 23, pp. 964–966, Aug. 1987. 
 33
[24] W.-S. Lu and T.-B. Deng, “An improved weighted least-squares design for variable fractional delay FIR 
filters,” IEEE Trans. Circuits Syst., I:Analog Digit. Signal Process., vol.46, pp.1035-1040, Aug. 1999. 
[25] S. J. Leon, Linear Algebra with Applications, 7E, Pearson Prentice Hall, 2006. 
 
 
 
 
 
 
 35
magnitude error function and the constrained error function, and a weighting constant is used 
to adjust the accuracy of flatness. Moreover, all the elements of related vectors and matrices 
can be represented in closed-form, so that the computational cost can be reduced. The 
presented examples show that the variable design possesses the flat characteristics as the 
independent optimal design in Section Ⅱ. Finally, the conclusions are given in Section Ⅳ. 
 
II. DESIGN OF MAXIMALLY LINEAR FIR DIFFERENTIATORS BY LAGRANGE 
MULTIPLIER APPROACH 
  For designing a full-band linear-phase FIR differentiator, the desired response is given 
by  
( ) ( )2NjdH e j−= − ≤ ≤ωω ω π ω π   (1) 
and the transfer function of the designed filter is characterized by 
( ) ( )
0
N
jn
n
H z h n e ω−
=
=∑  (2) 
where N  is odd and is the filter order. Generally, antisymmetric filter coefficients are 
required for designing a FIR differentiator, hence the frequency response of (2) can be 
represented by 
( ) ( ) ( )2
0
ˆN
N
jj jn
n
H e h n e je Hωω ω ω−− −
=
= =∑  (3) 
where 
( ) ( ) ( )( )12 12
1
ˆ sin
N
n
H a n nω ω
+
=
= −∑  (4) 
in which 
( ) ( ) ( )1 1 12 2 22 2 , 1,2, , .N N Na n h n h n n+ − += − =− + = "   (5) 
Let 
( ) ( ) ( )121 , 2 , , TNa a a +⎡ ⎤= ⎣ ⎦a "  (6a) 
and 
( ) ( ) ( ) ( )32 2 2sin ,sin , ,sin TN⎡ ⎤= ⎣ ⎦s "ω ω ωω  (6b) 
where the superscript T  denotes a transpose operator, Eq.(3) can be represented by  
( ) ( )2 .Njj TH e je ωω ω−− = a s   (7) 
 37
( ) ( ) ( ) ( )( )123 31 13 2 2
1
ˆ
cos 0,
N
np
d H
n a n n p
d
+
==
= − − − =∑
ω
ω
ω   (10d) 
which can be represented in matrix form as 
T =B a g  (11a) 
where p  is the maximally flat frequency, 
( ) ( ) ( ) ( ) ( ) ( )
( ) ( ) ( ) ( ) ( ) ( )
( ) ( ) ( ) ( ) ( ) ( )
2 31 1 1
2 2 2 2 2 2 2
2 33 3 3 33 3 3
2 2 2 2 2 2 2
2 3
2 2 2 2 2 2 2
sin cos sin cos
sin cos sin cos
sin cos sin cos
p p p p
p p p p
Np Np Np NpN N N
⎡ ⎤− −⎢ ⎥⎢ ⎥− −⎢ ⎥= ⎢ ⎥⎢ ⎥− −⎢ ⎥⎣ ⎦
B
# # # #
 (11b) 
and 
 [ ],1, 0, 0 .Tp=g  (11c) 
Hence the design of maximally linear FIR differentiators can be formulated as a quadratic 
programming problem as follow: 
( )Minimize ,
subject to
T T
T
e c⎧ = + +⎪⎨ =⎪⎩
a r a a Qa
B a g
 (12) 
which can be solved by the Lagrange multiplier method [21-23] as 
( ) ( )1 11 1 1 1 112T T T− −− − − − −⎡ ⎤= + −⎢ ⎥⎣ ⎦a Q B B Q B g Q B B Q B B Q I r  (13) 
where I  is a 1 12 2
N N+ +×  identity matrix. 
For example, when 31N = , 3K =  and p  varies from 0.3π  to 0.6π , the magnitude 
errors are shown in Fig. 1(b). 
III. DESIGN OF VML FIR DIFFERENTIATORS 
In this section, the transfer function of the designed variable filter is given by  
( )
0
( , )
N
jn
n
n
H z p h p e ω−
=
=∑  (14) 
where the filter coefficients ( )nh p  are expressed as the polynomials of p which is used to 
adjust the maximally flat frequency online 
( )
0
( , ) .
M
m
n
m
h p h n m p
=
=∑  (15) 
 39
where “→ ” means “approximate”. In Eqs.(21)~(25), 1 2p p p≤ ≤ . 
A. Derivation of the integrated magnitude error 
The approximation problem in (25) is converted into the minimization of an integrated 
square error defined by 
( ) ( ) ( )( )12 2
1
2
1
2
0 10
, sin
Np M
m
m
m np
e a n m p n d dp
+
= =
= − −∑∑∫ ∫a π ω ω ω   (26) 
which is denoted as the integrated magnitude error in this chapter and can be represented in 
vector-matrix form as  
( ) T Tm m m me c= + +a r a a Q a   (27) 
where 
( ) ( )1 12 21,0 , , ,0 , , (1, ), , ( , ) ,TN Na a a M a M+ +⎡ ⎤= ⎣ ⎦a " " "                   (28a) 
( )3 2 13mc p pπ= −  (28b) 
and the elements of the vector mr  and the matrix mQ  are given by 
( ) ( )( )212
1 1
2 1 2 1 ,
1
n m m
m n
p pi
m
+ +−
−
−= +r  (28c) 
( )
ˆ ˆ1 1
2 1
,ˆ, ˆ2 1
ˆ0 .
m m m m
m
p p n ni l m m
n n
π + + + +⎧ − =⎪= ⎨ + +⎪ ≠⎩
Q  (28d) 
In (28c) and (28d), ( )( )1 120 , 1
N Mi l + +≤ ≤ − , 12(  mod  ) 1Nn i += + , 12 ,N im +⎢ ⎥= ⎣ ⎦ 12ˆ (  mod  ) 1Nn l += +  
and 1
2
ˆ N lm +⎢ ⎥= ⎣ ⎦ where (  mod  )x y  denotes the remainder of 
x
y
 and z⎢ ⎥⎣ ⎦  denotes the largest 
integer less than or equal to z . 
B. Derivation of the constrained error 
The approximation problem in (21) is converted into the minimization of the integrated 
square error 
( ) ( ) ( )( )12 2
1
2
1
0 2
0 1
0 0 0
, sin
Np M
m
m np
T T
e p a n m p n p dp
c
+
= =
= − −
= + +
∑∑∫a
r a a Q a
 (29) 
which is denoted as the zero-order constrained error. In (29),  
 41
and 
( ) ( ) ( ) ( )( ) ( )( )2 2
1 1
3 3 ˆ ˆ1 1 1 1
3 2 2 2 2ˆ ˆ ˆ, cos cos 1 .
p p
m m m m
p p
i l n n p n n p dp p n n p dp+ +
⎡ ⎤⎢ ⎥= − − − + + −⎢ ⎥⎣ ⎦∫ ∫Q  (32e) 
Accordingly, the constrained error for the design of a VML differentiator with -thK  order 
flatness (for example, 3K = ) is given by 
( ) ( ) ( ) ( ) ( )0 1 2 3 .ce e e e e= + + +a a a a a   (33) 
C. LS design of VML differentiators 
By the development above, the following objective error function is used for the design of 
a VML FIR differentiator: 
( ) ( ) ( )VML m c ce e W e= +a a a   (34) 
where cW  is a weighting constant and the solution can be obtained by differentiating (34) 
with respect to a  and setting the result to zero, which yields 
( ) ( )11 0 1 2 3 0 12 .m c m cW W−⎡ ⎤ ⎡ ⎤=− + + + + + +⎣ ⎦ ⎣ ⎦a Q Q Q Q Q r r r  (35) 
D. Design examples 
When 31N = , M=3, 3K = , 1 0.3p = π , 2 0.6p = π  and 100cW = , the magnitude response 
and the magnitude error are shown in Fig. 1(a) and (c), respectively. Comparing Fig. 1(c) with 
Fig. 1(b), it is observed that the variable design possesses the flat characteristics as the 
independent optimal design at the desired frequencies, which can be further judged by the 
error curves for 0.3 ,p = π  0.4 ,π  0.5π  and 0.6π  shown in Fig. 2. 
 43
 
(a) (b) 
 
 (c) (d) 
 
Fig. 2. Comparisons of Fig. 1(b) and Fig. 1(c) for (a) 0.3p = π , (b) 0.4p = π , (c) 0.5p = π ,
(d) 0.6p = π . (Solid line: variable design, dotted line: independent design) 
 (a) (b) 
 
Fig. 3. Illustrations of the effect of the weighting constant cW . (a) The integrated magnitude 
error ( )me a . (b) The constrained error ( )ce a . 
 45
[9] J. L. Bihan, “Coefficients of FIR digital differentiators and Hilbert transformers for midband 
frequencies,” IEEE Trans. Circuits Syst. Ⅱ, Analog Digit. Signal Process., vol. 43, no. 3, pp. 
272–274, Mar. 1996.  
[10] S.-C. Pei and P.-H. Wang, “Closed-form design of maximally flat FIR Hilbert transformers, 
differentiators, and fractional delayers by power series expansion,” IEEE Trans. Circuits Syst.Ⅰ, 
Fundament. Theory Appl., vol. 48, no. 4, pp. 389–398, Apr. 2001. 
[11] I. W. Selesnick, “Maximally flat low-pass digital differentiators,” IEEE Trans. Circuits Syst. Ⅱ, 
Analog Digit. Signal Process., vol. 49, no. 3, pp. 219–223, Mar. 2002.  
[12] I. R. Khan and M. Okuda, “A new design of type Ⅳ digital differentiators based on maximal 
linearity constraint applied at 2=ω π ,” in Proc. INMIC 2004, Dec. 2004, pp. 208–213. 
[13] S. Samadi, O. Ahmad and M. N. S. Swamy, “Exact fractional-order differentiators for polynomial 
signals,” IEEE Trans.  Signal Process. Lett., vo1. 11, no. 6, pp. 529–532, Jun. 2004. 
[14] C. C. Tseng, “Digital differentiator design using fractional delay filter and limit computation,” 
IEEE Trans. Circuits Syst. I, Reg. Papers, vol. 52, no. 10, pp. 2248-2259, Oct. 2005. 
[15] I. R. Khan and M. Okuda, “Finite-impulse-response digital differentiators for midband 
frequencies based on maximal linearity constraints,” IEEE Trans. Circuits Syst. Ⅱ, Exp. Briefs, 
vol. 54, no. 3, pp. 242–246, Mar. 2007. 
[16] C. W. Farrow, “A continuously variable digital delay element,” in Proc. ISCAS 1988, May 1988, 
pp, 2641–2645. 
[17] P. Löwenborg and H. Johansson, “Minimax design of adjustable-bandwidth linear-phase FIR 
filters,” IEEE Trans. Circuits Syst. I, Reg. Papers, vol. 53, no. 2, pp. 431–439, Feb. 2006. 
[18] T.-B. Deng, “Noniterative WLS design of allpass variable fractional-delay digital filters,” IEEE 
Trans. Circuits Syst. I, Reg. Papers, vol. 53, no.2, pp.358-371, Feb. 2006. 
[19] T.-B. Deng and Y. Lian, “Weighted-least-squares design of variable fractional-delay FIR filters 
using coefficient symmetry,” IEEE Trans. Signal Process., vol. 54, no. 8, pp. 3023–3038, Aug. 
2006. 
[20] H. H. Dam, A. Cantoni, K. L. Teo and S. Nordholm, “Variable digital filter with least-square 
criterion and peak gain constraints,” IEEE Trans. Circuits Syst. II, Exp. Briefs, vol. 54, no. 1, pp. 
24–28, Jan. 2007. 
[21] G. W. Medlin, J. W. Adams and C. T. Leondes, “Lagrange multiplier approach to the design of 
FIR filters for multirate applications,” IEEE Trans. Circuits Syst., vol. 35, no. 10, pp. 1210–1219, 
Oct. 1988.  
[22] B.-R. Horng and A. N. Willson, Jr., “Lagrange multiplier approaches to the design of two-channel 
perfect-reconstruction linear-phase FIR filter banks,” IEEE Trans. Signal Process., vol. 40, no. 2, 
pp. 364–374, Feb. 1992. 
[23] J.-J. Shyu and S.-C. Pei, “Lagrange multiplier approach to the design of two-dimensional FIR 
digital filters for sampling structure conversion,” IEEE Trans.  Signal Process., vol. 42, no. 10, 
pp. 2884–2886, Oct. 1994. 
 
 47
filters with adjustable magnitude response such as the filters with variable cut-off frequencies and the 
variable fractional-order differentiators [20-24]. The other is the filters with variable fractional-delay 
response [25-29] which are used in music instrument modeling, sampling rate conversion, discrete time 
signal interpolation and time delay estimation.  
In the chapter, an efficient method is proposed for the design of variable fractional-order (VFO) FIR 
differintegrators. The method is originally used to design 2-D FIR digital filters in least-squares sense, 
including quadrantally symmetric/antisymmetric 2-D FIR filters and complex coefficient 2-D filters 
[30-32]. However, in the chapter we don’t intend to derive the closed-forms as in [30-32], and the 
method is modified by incorporating weighting functions such that it can design VFO FIR 
differintegrators in weighted-least-squares sense. Moreover, by applying proper iterative technique 
[33], the peak absolute error of variable frequency response can be reduced drastically. Comparing 
with the existing methods [21,22], there is no need of numerical integrations for deriving the elements 
of related matrices, also there is no need of closed-form formulation as the design of variable 
fractional-delay filters [28,29], and the values of relevant matrices can be obtained just from the given 
specification. The chapter is organized as follows. Section 2 deals with the problem formulation, in 
which the used transfer function is characterized such that the Farrow structure [26] can be applied. To 
demonstrate the effectiveness of the proposed method, several examples, including a VFO 
differintegrator, a pure VFO differentiator and a pure VFO integrator, are given in Section 3, in which 
the weighting function is adjusted by an iterative technique such that the peak absolute error of 
variable frequency response can be reduced as much as possible. Finally, the conclusions are given in 
Section 4. 
 
2. Problem formulation  
  For designing a VFO differintegrator, the desired response is given by  
( , ) ( ) , ,jI p s f s fD p e j p p p
ωω ω ω ωω−= ≤ ≤ ≤ ≤                (1) 
 49
where  
  2
2 2
( , ), 0, 0 ,
( , )
2 ( , ), 1 , 0 ,
N
e
N N
e
h m n m M
a n m
h n m n m M
= ≤ ≤⎧= ⎨ − ≤ ≤ ≤ ≤⎩
                            (10a) 
 
  2 2( , ) 2 ( , ), 1 , 0
N N
ob n m h n m n m M= − ≤ ≤ ≤ ≤                   (10b) 
and 
2 2
0 0 1 0
ˆ ( , ) ( , ) cos( ) ( , ) sin( ).
N NM M
m m
n m n m
H p a n m p n j b n m p nω ω ω
= = = =
= +∑∑ ∑∑　              (11) 
Obviously, 2
NI =  in (1) and (3). 
Let A  and B  be 2( 1) ( 1)
N M+ × +  and 2 ( 1)N M× +  matrices defined by 
 2( , ), 0 , 0
Na n m n m M= ≤ ≤ ≤ ≤⎡ ⎤⎣ ⎦A                                         (12a) 
and 
 2( , ), 1 , 0 ,
Nb n m n m M= ≤ ≤ ≤ ≤⎡ ⎤⎣ ⎦B                                         (12b) 
respectively, the following objective error function is used in the chapter. 
2
0 0
( , ) ( ) ( , ) ( , )A B
p
i
KK
j
i i l l
i l
e W D p H e p
ω ωω ω
= =
= −∑∑  
 
2
0 0
( ) ( )ˆ ˆ( ) ( , ) ( , ) , ,
pKK
f s f s
i i l i l i s l s
i l p
i l p p
W D p H p p p
K K
ω
ω
ω ωω ω ω ω ω
= =
− −= − = + = +∑∑    (13) 
where a ( 1) ( 1)pK Kω + × +  grid is chosen for the error evaluation, and ( )W ω  is a positive weighting 
function. In the chapter, 200pK Kω = =  is used. By Pythagorean law, 
 
2
2
0 0 0 0
( , ) ( ) cos( ) ( , ) cos( )
2
Np
l
KK M
p ml
i i l i
i l n m
pe W a n m p n
ω πω ω ω
= = = =
⎡ ⎤= −⎢ ⎥⎣ ⎦∑∑ ∑∑A B  
          
2
2
0 0 1 0
( ) sin( ) ( , ) sin( ) .
2
Np
l
KK M
p ml
i i l i
i l n m
pW b n m p n
ω πω ω ω
= = = =
⎡ ⎤+ −⎢ ⎥⎣ ⎦∑∑ ∑∑                       (14) 
Eq.(14) can be expressed in matrix form as 
 ( , ) ( ) ( ) ( ) ( )T T T T T Te tr tr⎡ ⎤ ⎡ ⎤= − − + − −⎣ ⎦ ⎣ ⎦A A B BA B D CAP D CAP D SBP D SBP  
 ( ) ( )e e= +A B    (15) 
where ( )tr ⋅  denotes a trace operator, the superscript T denotes a transpose operator, 
 
1
2 ( ) cos( ), 0 , 0 ,
2
lp l
i i p
pW i K l Kω
πω ω⎡ ⎤= ≤ ≤ ≤ ≤⎢ ⎥⎣ ⎦AD                      (16a) 
 51
section. To evaluate the performance, the normalized root-mean-squared error of variable frequency 
response and the maximum absolute error of variable frequency response are defined by 
1
22
2
( , ) ( , )
100%
( , )
f f
s s
f f
s s
p j
p
rms p
p
D p H e p d dp
D p d dp
ω ω
ω
ω
ω
ω ω
ε
ω ω
⎡ ⎤−⎢ ⎥= ×⎢ ⎥⎢ ⎥⎣ ⎦
∫ ∫
∫ ∫                 (22a) 
and  
{ }max ( , ) ( , ) , , ,jm s p s fD p H e p p p pωε ω ω ω ω= − ≤ ≤ ≤ ≤            (22b) 
respectively. To compute the error rmsε , the general trapezoidal rule is used [34] with step sizes 
( ) 200f sω ω−  and ( ) 200f sp p−  for ω -axis and p -axis, respectively. Also, the error mε  is 
computed with the same sampling sizes as above. 
  Example 1: This example deals with the least-squares design of a VFO differintegrator with 40N = , 
5M = , (0.05)sω π= , (0.95)fω π= , 0.5sp = − , 0.5fp =  and ( ) 1W ω = . Fig.1 (a) and (b) 
present the obtained magnitude response and the absolute error of variable frequency response, 
respectively, and the errors 0.60277728%rmsε ≈  and 0.1369375mε = . 
  It is noted that the phase difference between ω π=  and ω π= −  is pπ , which is not a integer 
multiple of 2π  for all p  in the range ,[ ]s fp p , so it is not recommended to set fω π= . However, 
for comparing with the results of [22], the differintegrator is designed again with (0.01)sω π= , 
fω π= . If the computation of integration in [22] is implemented by using the trapezoidal rule with 
step sizes  ( ) / 200f sω ω−  and ( ) / 200f sp p−  for ω -axis and p -axis, respectively, both the 
method of [22] and the proposed method induce the exactly same results : 10.01497046%rmsε ≈ , 
3.11763459mε = .  
 
Example 2: For designing a pure VFO differentiator, 0 s fp p≤ < . For example, a VFO 
differentiator is designed with 30N = , 6M = , 0Sω = , 0.9fω π= , 1Sp = , 2fp =  and 
( ) 1W ω = , the variable magnitude response and the absolute error of variable frequency response are 
shown in Fig.2 (a) and (b), respectively, and the errors 0.166372%rmsε ≈  and 0.03382684mε =  
 53
ˆ ( )( ) , S f
W
WW ωω ω ω ωδ= ≤ ≤                    (27) 
  and go to Step 2. 
  For example, if the specification of the designed VFO differentiator is the same as that stated above, 
and 0.01ε =  is used, the design takes 7 iterations to converge, the absolute error of variable 
frequency responses is shown in Fig.2 (c) and  0.27842619%rmsε ≈ , 0.01215898mε = . To clearly 
show the difference between the results of the first and the seventh iterations, the error curves 
( , )mE pω  are illustrated in Fig.2 (d). Also, the final weighting function is illustrated in Fig.2(e). 
 
  Example 3 : A pure VFO integrator is designed with 60,N = 6,M = (0.05)Sω π= , (0.9)fω π= , 
1.5Sp = − , and 0.5fp = −  in this example. First, a least-squares design is presented, and the variable 
magnitude response and the absolute error of variable frequency response are shown in Fig.3 (a) and 
(b), respectively, where 1.3779794%rmsε ≈  and 0.33681498mε = . By using the method in [22], it 
yields 3.29702665%rmsε ≈  and 0.34745782mε = , which shows that the proposed method is better 
for the design. Also, the iterative method shown in Example 2 can also be applied here, the absolute 
error of variable frequency response after 5 iterations is shown in Fig.3 (c) if 0.01ε =  is used where 
3.05425137%rmsε ≈  and 0.13889478,mε =  and the error curves ( , )mE pω  in the first and last 
iterations are presented in Fig.3(d).  
  Basing on the presented examples above, there are some issues which can be further discussed. 
a. The preassigned ε  in (24) cannot be chosen too small. For example, the trace of the relative peak 
error ratio in Example 3 is illustrated in Fig.4 in which the ratio converges after about 5 iterations 
and varies between 0.001 and 0.002. If 0.002ε =  is preassigned, 8 iterations are needed while 
49 iterations are required for 0.001ε = . But if ε  is smaller, for example, than 0.0005, the 
design will not converge. 
b. Comparing with the existing weighted-least-squares approach such as the method in [22] which is 
also widely used to design variable fractional-delay FIR digital filters, the proposed method 
 55
References: 
[1] K. B. Oldham and J. Spanier, The Fractional Calculus, Academic Press, New York, 1974. 
 [2] K. S. Miller and B. Ross, An Introduction to the Fractional Calculus and Functional Differential 
Equations, Wiley, New York, 1993. 
[3] K. Ogata, Discrete-time Control Systems, Prentice-Hall, Englewood Cliffs, NJ, 1987. 
 [4] I. Podlubny, Fractional Differential Equations, Academic Press, San Diego, CA, 1999. 
 [5] B. Mbodje and G. Montseny, Boundary fractional derivative control of the wave equation, IEEE 
Trans. Automat. Contr., 40 (2) (1995) 378-382. 
 [6] N. Engheta, On fractional calculus and fractional multipoles in electromagnetism, IEEE Trans. 
Antennas Prop., 44(4 )(1996) 554-566. 
 [7] R. Hilfer, Ed., Application of Fractional Calculus in Physics, River Edge, NJ: World Scientific, 
2000. 
 [8] B. M. Vinagre, I. Podlubny, A. Hernandez and V. Feliu, Some approximation of fractional order 
operators used in control theory and applications, Journal of Fractional Calculus and Applied 
Analysis, 4 (2001) 47-66. 
[9] B. Mathieu, P. Melchior, A. Ousaloup and C. Ceyral, Fractional differentiation for edge detection, 
Signal Processing, 83 (2003) 2421-2432. 
[10] Y. Q. Chen, B. M. Vinagre and I. Podlubny, Continued fraction expansion approaches to 
discretizing fractional order derivatives--an expository review, Nonlinear Dynamics, 38 (2004) 
155-170. 
[11] C.-C. Tseng, Design of fractional order digital FIR differentiators, IEEE Signal Process. Lett., 8 (3) 
(2001) 77-79. 
[12] Y. Q. Chen and K. L. Moore, Discretization schemes for fractional-order differentiators and 
integrators, IEEE Trans. Circuits Syst. I, 49 (3) (2002) 363-367. 
[13] Y. Q. Chen and B. M. Vinagre, A new IIR-type digital fractional order differentiator, Signal 
Processing, 83 (2003) 2359-2365. 
 57
[26]. C. W. Farrow, A continuously variable digital delay elements, in Proc. IEEE Int. Symp. Circuits 
Syst., June 1988, pp.2641-2645. 
[27]. J.-C. Liu and S.-J. You, Weighted least squares near-equiripple approximation of variable 
fractional delay FIR filters, IET Signal Process., 1 (2007) 66-72. 
[28]. T.-B. Deng and Y. Lian, Weighted-least-squares design of variable fractional-delay FIR filters 
using coefficient symmetry, IEEE Trans. Signal Process., 54 (8) (2006) 3023-3038. 
[29]. T.-B. Deng, Symmetric structures for odd-order maximally flat and weighted-least-squares 
variable fractional-delay filters, IEEE Trans. Circuits Syst. I, 54 (12) (2007) 2718-2732. 
[30] M. O. Ahmad and J.-D. Wang, An analytical least-square solution to the design problem of 
two-dimensional FIR filters with quadrantically symmetric or antisymmetric frequency response, 
IEEE Trans. Circuits Syst., 36 (7) (1989) 968-979. 
[31]. S.-C. Pei and J.-J. Shyu, General form for designing two-dimensional quadrantally symmetric 
linear-phase FIR digital filters by analytical least-squares method, Signal Processing, 48 (1996) 
165-174. 
[32]. S.-C. Pei and J.-J. Shyu, Fast design of 2-D linear-phase complex FIR digital filters by analytical 
least squares method, IEEE Trans. Signal Process., 44 (12) (1996) 3157-3161. 
[33]. C. Y. Chi and Y. T. Kou, A new self-initiated optimum WLS approximation method for the design 
of linear phase FIR digital filters, in Proc. IEEE Int. Symp. Circuits Syst., June 1991, pp. 168-171. 
[34]. K. E. Atkinson, An Introduction to Numerical Analysis, 2nd Ed., John Wiley & Sons, 1989. 
[35]. K. M. Abadir and J. R. Magnus, Matrix Algebra, Cambridge University Press, 2005. 
 59
 
 
 (a) (b) 
 
 (c) (d) 
 
(e) 
Fig.2 Design of a VFO differentiator with N=30, M=6, 0Sω = , (0.9)fω π= , 1Sp =  and 2fp = . 
(a) Variable magnitude response. (b) Absolute error of variable frequency response 
(least-squares design). (c) Absolute error of variable frequency response (iterative design). (d) 
Absolute errors ( , )mE pω  (solid line: first iteration, dotted line: seventh iteration). (e) Final 
weighting function. 
 61
 
 
 
Fig.4 Trace of the relative peak error ratio in Example 3. 
 
 63
higher-dimensional FIR filters in LS sense[16][17]. However, we do not derive the 
closed-form formulations as in [16] and [17], and the weighting function is incorporated in 
the modified algorithm so that the proposed method can be applied to design VFD FIR digital 
filters in weighted LS sense. Moreover, the minimax design can also be achieved by applying 
a proper iterative process[18]. The proposed method is based on the Farrow structure, which 
is different from [12] where two-stage structure is used. Comparing with the existing 
method[13], there is no misleading problem and the performance of convergence is also better 
for the proposed method. To demonstrate the effectiveness of the proposed method, a design 
example is presented and it is found that the used weighting function depends only on the 
frequencyω , not on the tunable parameter for the minimax design of VFD FIR digital filters. 
 
 
II. PROBLEM FORMULATION AND NUMERICAL EXAMPLE 
 
  For designing a VFD FIR filter, the desired response is given by 
( ) ( )
2
2
( , )
cos sin , , 0.5 0.5 (1)
N
N
j j p
j
p p
D p e e
e p j p p
− −
−
= ⋅
= ⎡ − ⎤ − ≤ ≤ − ≤ ≤⎣ ⎦
ω ω
ω
ω
ω ω ω ω ω  
where N and p are the order and the variable fractional-delay of the designed FIR digital filter, 
respectively. To approximate the desired response in (1), the used transfer function is 
characterized by 
( ) ( )
0
, (2)
N
n
n
n
H z p h p z−
=
=∑  
where the coefficients ( )nh p  are expressed as the polynomials of p  
( ) ( )
0
, , (3)
M
m
n
m
h p h n m p
=
= ∑
hence Eq.(2) becomes 
( ) ( ) ( )
0 0 0 0
, , , (4)
N M M N
m n n m
n m m n
H z p h n m p z h n m z p− −
= = = =
⎛ ⎞= = ⎜ ⎟⎝ ⎠∑∑ ∑ ∑  
which can be implemented by the Farrow structure[1]. In the chapter, only even N is 
considered, and the case for odd N can be developed in a similar manner. By the 
symmetric/antisymmetric properties of (1) with respect to p, Eq.(4) can be divided into two 
sub-functions as follows, 
( ) ( ) ( )2 2 1
0 0 1 0
, , 2 ,2 1 (5)
c sM MN N
n m n m
m n m n
H z p h n m z p h n m z p− − −
= = = =
⎛ ⎞ ⎛ ⎞= + −⎜ ⎟ ⎜ ⎟⎝ ⎠ ⎝ ⎠∑ ∑ ∑ ∑  
where 
 65
( ) ( ) ( ) ( ) ( )
2
2
2
0 0 1 0
cos 1 , cos , (14a)
p c
NKK M
m
i i l l i
i l m n
e W p a n m p n
= = = =
⎡ ⎤⎢ ⎥= − −⎢ ⎥⎣ ⎦
∑∑ ∑∑A ω ω ω ω  
( ) ( ) ( ) ( ) ( )
2
2
2 1
0 0 1 1
sin , sin , (14b)
p s
NKK M
m
i i l l i
i l m n
e W p b n m p n−
= = = =
⎡ ⎤⎢ ⎥= − −⎢ ⎥⎣ ⎦
∑∑ ∑∑B ω ω ω ω  
a ( ) ( )1 1pK Kω + × +  grid is chosen for the error evaluation and ( )W ω  is a positive 
weighting function. In the chapter, 20K Nω =  and 200pK =  are used. It is especially 
noted that the weighting function depends only on the transform-domain parameter ω , not 
on the tunable variable p for the minimax design, which will be shown later. Eq.(14) can be 
expressed in matrix forms as 
( ) ( ) ( )
( ) ( ) ( ) (15a)
TT T
T TT T T T T T
e tr
tr
⎡ ⎤= − −⎢ ⎥⎣ ⎦
⎡ ⎤= − − +⎢ ⎥⎣ ⎦
A A A A
A A A A A A A A
A D CAP D CAP
D D D CAP CAP D CAP CAP
 
and 
( ) ( ) ( )
( ) ( ) ( ) (15b)
TT T
T TT T T T T T
e tr
tr
⎡ ⎤= − −⎢ ⎥⎣ ⎦
⎡ ⎤= − − +⎢ ⎥⎣ ⎦
B B B B
B B B B B B B B
B D SBP D SBP
D D D SBP SBP D SBP SBP
 
where ( )tr ⋅  denotes a trace operator, the superscript T denotes a transpose operator, 
( ) ( )( )12 cos 1 , 0 , 0 , (16a)i i l pW p i K l K⎡ ⎤= − ≤ ≤ ≤ ≤⎣ ⎦AD ωω ω  
( ) ( )12 sin , 0 , 0 , (16b)i i l pW p i K l K⎡ ⎤= − ≤ ≤ ≤ ≤⎣ ⎦BD ωω ω  
( ) ( )12 cos , 0 , 0 , (16c)
2i i
NW n i K n⎡ ⎤= ≤ ≤ ≤ ≤⎢ ⎥⎣ ⎦C ωω ω  
( ) ( )12 sin , 0 , 1 , (16d)
2i i
NW n i K n⎡ ⎤= ≤ ≤ ≤ ≤⎢ ⎥⎣ ⎦S ωω ω  
2 , 0 , 1 (16e)ml p cp l K m M⎡ ⎤= ≤ ≤ ≤ ≤⎣ ⎦AP  
and 
 2 1, 0 , 1 . (16f )ml p sp l K m M
−⎡ ⎤= ≤ ≤ ≤ ≤⎣ ⎦BP  
  For the given objective error function (13), the solution A  can be obtained by 
differentiating ( ),e A B  with respect to A  and setting the result to zero, which yields 
 ( ) ( )1 1 . (17)T T T− −= A A A AA C C C D P P P  
Similarly, 
 67
         ( ) ( )ˆ , 0 p
w
W
W
ωω ω ωδ= ≤ ≤  
         and go to Step 2. 
  To evaluate the performance, the maximum absolute error of variable frequency response 
and the maximum delay error are defined by 
    ( ) ( ){ }max , , , 0 , 0 0.5 (19a)jm pD p H e p pωε ω ω ω= − ≤ ≤ ≤ ≤  
and  
( )max , , 0 , 0 0.5 , (19b)
2 p
N p p pτε τ ω ω ω⎧ ⎫= + − ≤ ≤ ≤ ≤⎨ ⎬⎩ ⎭  
respectively, where ( ), pτ ω  is the actual group-delay of ( ),jH e pω . For the computation of 
(19), the frequency ω  and the variable p are uniformly sampled at step sizes ( )20p Nω  
and 0.5/200, respectively, where N is the order of the designed filter. 
  Example: We consider the design of a VFD FIR filter with N=60, M=9, 0.9pω π=  in the 
example. During the first iteration, it is found that 0.5mp = , 57.91277377 10mε −= × ,           
0.00773737τε =  and the relative peak error ( ) 0.94993493mpρδ = . If 0.001ε =  is used, 
the design process stops at the fifth iteration when 51.92486931 10mε −= × , 0.00359572τε =  
and ( ) 0.00012587mpρδ = . Fig.1(a) and (b) present the final magnitude and group-delay 
responses, while the absolute errors of variable frequency response for the first iteration and 
the fifth iteration are shown in Fig.1 (c) and (d), respectively. From Fig.1 (d), it is found that 
the absolute errors of frequency response for all variable p are almost equiripple, which can 
be further judged by the error curves for 0.5p = , 0.3, 0.2 and 0.1 shown in Fig.2(a), (b), (c) 
and (d), respectively. Also, the curve for the relative peak error ( )pρδ  for 0 0.5p≤ ≤  is 
illustrated in Fig.2(e) which shows the excellent equiripple characteristic of the obtained 
result. For showing the good convergence of the iterative method, Fig.2(f) presents the trace 
of the relative peak error ( )mpρδ  which varies between 610−  and 64 10−× after the sixth 
iteration. 
 
 69
   
           (a) (b) 
   
 (c)  (d) 
   
 (e) (f) 
Fig.2 Minimax design of a VFD FIR digital filter with N=60, M=9 and 0.9pω π= . The error 
curves ( ),E pω  for (a) p=0.5, (b) p=0.3, (c) p=0.2, (d) p=0.1. (e) The relative peak 
error curve ( )pρδ  for 0 0.5p≤ ≤ . (f) Trace of the relative peak error ( )mpρδ . 
 
For comparing with the existing method[13], the VFD filter is designed again with N=20, 
M=5, and the process stops at the fourth iteration when 0.001ε =  is used. Beside the 
maximum absolute error, 0.01725238mε = , is comparable to that in [13] where 
0.017265mε ≈ , there is no misleading problem for the proposed method, and the 
convergence is also better than in method [13] where eight iterations are needed. 
 
 
 71
Lett., vol. 14, no. 10, pp. 688-691, Oct. 2007. 
[12] E. Hermanowicz and H. Johansson, “On designing minimax adjustable wideband fractional 
delay FIR filters using two-rate approach,’’ in Proc. European Conf. Circuit Theory and 
Design, 2005, pp. III/437-440. 
[13] J.-C. Liu and S.-J. You, “Weighted least squares near-equiripple approximation of variable 
fractional delay FIR filters,’’ IET Signal Process., vol. 1, no. 2, pp. 66-72, Jun. 2007. 
[14] P. Löwenborg and H. Johansson, “Minimax design of adjustable-bandwidth linear- phase 
FIR filters,’’ IEEE Trans. Circuits Syst. I, Reg. Chapter, vol. 53, no. 2, pp. 431-439, Feb. 
2006. 
[15] H. H. Dam, A. Cantoni, K. L. Teo and S. Norholm, “Variable digital filter with least-square 
criterion and peak gain constraints,’’ IEEE Trans. Circuits Syst. II, Exp. Briefs, vol. 54, no. 1, 
pp. 24-28, Jan. 2007. 
[16] M. O. Ahmad and J.-D. Wang, “An analytical least square solution to the design problem of 
two-dimensional FIR filters with quadrantally symmetric or antisymmetric frequency 
response,’’ IEEE Trans. Circuits Syst., vol. 36, no. 7, pp. 968-979, Jul. 1989. 
[17] S.-C. Pei and J.-J. Shyu, “Efficient fast design of three- and higher-dimensional FIR digital 
filters by analytical least squares method,’’ IEEE Trans. Circuits Syst. II, Analog Digit. 
Signal Process., vol. 43, no. 4, pp. 339-344, Apr. 1996. 
[18] C. Y. Chi and Y. T. Kou, “A new self-initiated optimum WLS approximation method for the 
design of linear phase FIR digital filters,’’ in Proc. ISCAS, 1991, pp. 168-171. 
 73
matrix inversion. Especially, to avoid ill condition when matrix inversion is to be found, the related 
matrix is represented in a positive-definite Hermitian symmetric matrix which can be decomposed by 
the Cholesky factorization process. To demonstrate the effectiveness of the proposed method, several 
numerical VFD examples including a non-symmetric single-passband filter, a partial-band 
differentiator and a non-symmetric pure delay filter are presented in Section 3. It is noted that all 
elements of matrices or vectors can be represented in closed forms, such that the computation time can 
be effectively reduced. Moreover, the design of symmetric pure VFD filters is also given in Section 3, 
which demonstrates the flexibility of the proposed method. Finally, the conclusions are given in 
Section 4. 
 
2. Problem formulation  
  In this chapter, the desired variable fractional-delay frequency response is given by 
⎩⎨
⎧
∈
<<∈=
−
      　stopbands,                     , 0
,passbands,      ,)(
),( 21
　　　　　
　
ω
ωωω
ω pppeM
pH
pj
d            (1) 
where )(ωM  is the desired pure real or pure imaginary amplitude response, and the variable transfer 
function is characterized by 
　　 ∑
−=
−=
N
Nn
n
n zphpzH )(),(                                           (2) 
where the coefficients )( phn s are generally expressed as the polynomials of p as  
,),()(
0
　　 ∑
=
=
M
m
m
n pmnaph                                           (3) 
in which a(n,m)s are complex-valued coefficients. So the frequency response of the designed system 
can be represented as  
.),(),(
0
∑ ∑
−= =
−=
N
Nn
M
m
jnmj epmnapeH ωω                               (4) 
Define 
[ ] TTNT NT N AAAA "1+−−=                                  (5a) 
and 
[ ]  ),(),(),(),( 1 TTNT NT N pppp ωωωω EEEE "+−−=          (5b) 
where T denotes transpose operator,  
[ ] NnNMnanana Tn ≤≤−=      ,),()1,()0,( "　A              (5c) 
and 
[ ] ,    ,),( NnNeppeep TjnMjnjnn ≤≤−= −−− ωωωω "E      (5d) 
 75
Eq.(5a). 
 
3. Numerical examples and discussions 
  To demonstrate the effectiveness of the proposed method, several examples are presented in this 
section. For simplicity, 1)( =, pW ω  is used in this chapter. To evaluate the performance, the 
normalized root mean squared error 2ε  and the maximum absolute group-delay error τε  are 
defined by   
%100     
%100
),( 
),(),( 
2/1*
2/1
  
2
   
2
2 2
1
2
1
×⎥⎦
⎤⎢⎣
⎡ +++=
×
⎥⎥
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢⎢
⎢
⎣
⎡ −
=
∫ ∫
∫ ∫
s
s
dpdpH
dpdpeHpH
HHT
R
p
p
d
R
p
p
j
d
QAAPAPA
ωω
ωω
ε
ω
                 (12a) 
and 
{ }),(passbands,,max 21 ppppp ∈∈−),(= ωωτετ                (12b) 
respectively, where ),( pωτ  is the actual fractional group-delay of the designed filter defined by  
. )),(arg(, peH
d
dp jωωωτ −=)(                                     (13)  
To compute τε , the frequency ω  and the fractional-delay p  are uniformly sampled at the step 
sizes 
1000
2π
 and 
40
12 pp −  respectively. 
Example 1: In this example, a single-passband non-symmetric variable fractional-delay filter is 
designed with the desired response  
　
　　　　⎪⎩
⎪⎨
⎧
∪−∈
∈∈=,
−
   ).,(),(               ,0
),,(  and ),(         ,
)(
21
21 21
πωωπω
ωωωω
ω
ss
pp
pj
d
pppe
pH           (14) 
The elements of vector P  are given by  
)1,mod(  ,
1
,1)1)(12(0       ,)(
2
1
2
1
+=−⎥⎦
⎥⎢⎣
⎢
+=
−++≤≤−= ∫ ∫ −
MimN
M
in
MNidpdpeei
p
p
p
p
mjnpj
　　　　　　　　　　　　　　　
　　
ω
ω
ωω ωP
      (15a) 
while the elements of matrix Q  are given by  
 77
 
Example 2: In this example, a partial-band variable fractional-delay differentiator is designed and the 
desired response is given by  
　
　　　　　　　　
　　　　
⎪⎩
⎪⎨
⎧
∪−∈        
∈ ∈ =,
−
),(),(,0
, ),(),,(,
)(
21
21 21
πωωπω
ωωωωω
ω
ss
pp
pj
d
pppej
pH            (18) 
in which πωωωω ≤<<<<
2211
0 spps . Also when 1)( =, pW ω , the elements of matrix Q  
are the same as Eq.(16a), and the elements of vector P  can be represented as follows: 
),1,mod(  ,
1
,1)1)(12(0          
,)sin()cos(
1!
)(
2
1
2
1
11
1
1
1
2
0
1
+=−⎥⎦
⎥⎢⎣
⎢
+=−++≤≤
⎥⎥⎦
⎤
⎢⎢⎣
⎡ −++
−≅ ∫∫∑ ++++++
=
+
MimN
M
inMNi
dnjdn
mk
pp
k
ji
p
p
p
p
kk
mkmkK
k
k
　　
ωωωωωω
ω
ω
ω
ω
P
    (19) 
which can be formulated into closed-forms after some mathematical manipulation. Fig.2 (a) and (b) 
illustrate the obtained variable fractional-delay response and magnitude response respectively, when 
N=33, M=7, πω 14.0
1
=s , πω 2.01 =p , πω 9.02 =p , πω =2s , 6.01 −=p , 4.02 =p  are 
used. The obtained normalized root mean squared error %12.0=2ε , and the maximum absolute 
group-delay error 0157.0=τε . 
 
Example 3: An N=33, M=7 pure variable fractional-delay system is designed in this example, and the 
desired frequency response is given by  
　　　　　　　　　　　　　
　　　
).6.0()4.0( 
,92.0)88.0(,)(
21
21
=<<−=
)=(<<−==, −
ppp
epH pp
pj
d πωωπωω ω         (20) 
The obtained variable fractional-delay response and magnitude response are presented in Fig.3 (a) and 
(b) respectively, which result in %0016844.0=2ε  and 0038.0=τε . For symmetric pure 
variable fractional-delay filter design with 
21 pp
ωω −=  and 21 pp −= , it is found that the filter 
coefficients are real, which also reveal the symmetric property  
　　 MmNnmnamna m ≤≤≤≤−=− 1 ,0      ),()1(),(                     (21a) 
and 
　 NnNnna ≤≤−=       )()0,( δ                                        (21b) 
as shown in [1]. For example, when N=33, M=7, πωω 9.0
21
−=−= pp , 5.021 −=−= pp , the 
obtained %00028753.0=2ε  and 0038.0=τε . Comparing with those obtained in [1] in which 
 79
 [6] T.-B. Deng and Y. Nakagawa, SVD-based design and new structure for variable fractional-delay 
digital filters, IEEE Trans. Signal Process., 52 (9) (2004) 2513-2527. 
 [7] H. Zhao and J. Yu, A simple and efficient design of variable fractional-delay FIR filters, IEEE 
Trans. Circuits Syst. Ⅱ, Express Brief., 53 (2) (2006) 157-160. 
 [8] S.-C. Pei, P.-H. Wang and H.-S. Lin, Closed-form design of maximally flat FIR fractional-delay 
filter, IEEE Signal Process. Lett., 13 (7) (2006) 405-408. 
[9] T. I. Laakso, V. Valimaki, M. Karjalainen, and U. K. Laine, Splitting tools for fractional delay 
filter design, IEEE Signal Process. Mag., 13 (1) (1996) 30-60. 
[10] T.-B. Deng, Symmetry-based low-complexity variable fractional-delay FIR filters, in Proc. 2004 
IEEE Int. Symp. Communications Information Technologies. ( ISCIT’04 ), Oct. 2004, pp. 
194-199.  
[11] C.-C. Tseng, Design of variable fractional delay FIR filters using symmetry, in Proc. 2004 IEEE 
Int. Symp. Circuits and Systems, May 2004, pp. 477-480. 
[12] H. Johansson and P. LÖwenborg, Reconstruction of nonuniformly sampled bandlimited signals by 
means of digital fractional delay filters, IEEE Trans. Signal Process., 50 (11) (2002) 2757-2767. 
[13] G.-S. Liu and C.-W. Wei, A new variable fractional sample delay filter with nonlinear interpolation, 
IEEE Trans. Circuits Syst. Ⅱ, Analog Digit. Signal Process., 39 (2) (1992) 123-126. 
[14] F. M. Gardner, Interpolation in digital modems -- Part I: Fundamentals, IEEE Trans. Commun.,  
41 (3) (1993) 502-508. 
[15] K. Rajamani, Y. S. Lai and C. W. Farrow, An efficient algorithm for sample rate conversion from 
CD to DAT, IEEE Signal Process. Lett., 7 (10) (2000) 288-290. 
[16] S.-C. Pei and C.-C. Tseng, A comb filter design using fractional sample delay, IEEE Trans. 
Circuits Syst. Ⅱ, Analog Digit. Signal Process., 45 (6) (1998) 649-635. 
[17] C. W. Farrow, A continuously variable digital delay element, in Proc. ISCAS, 1988, pp.2641-2645. 
[18] C. K. S. Pun, Y. C. Wu, S. C. Chan and K. L. Ho, On the design and efficient implementation of 
the Farrow structure, IEEE Signal Process. Lett., 10 (7) (2003) 189-192. 
[19] T.-B. Deng, Design of complex-coefficient variable digital filters using successive vector-array 
decomposition, IEEE Trans. Circuits Syst. I, Reg. Chapters, 52 (5) (2005) 932-942. 
[20] Z. Lin and Y. Liu, Design of complex FIR filters with reduced group delay error using 
semidefinite programming, IEEE Signal Process. Lett., 13 ( 9) (2006) 529-532. 
[21] S. C. Chan and K. M. Tsui, On the design of real and complex FIR filters with flatness and peak 
error constraints using semidefinite programmimg, in Proc. IEEE Int. Symp. Circuits Systems, 
May 2004, vol. III, pp. 125-128. 
[22] J.-J. Shyu, S.-C. Pei and K.-C. Fu, Complex Lagrange multiplier approach to the design of 
arbitrary complex coefficient FIR digital filters, Signal Processing, 35 (1994) 117-130. 
 
 
 
 81
 
 (a) 
 
 (b) 
Fig.2 Example 2: Design of a partial-band variable fractional-delay differentiator. (a) Variable 
fractional-delay response in passband. (b) Magnitude response. 
 
 83
Chapter 7 
Minimax phase error design of allpass variable 
fractional-delay digital filters by iterative weighted 
least-squares method  
 
 
Abstract 
  In this chapter, an iterative weighted least-squares method is proposed for the 
design of allpass variable fractional-delay (VFD) digital filters, so that the maximum 
absolute phase error can be minimized. Meanwhile, it is found that the range of 
variable parameter will affect overall performance of the designed filter, which will be 
analyzed and discussed in this chapter through several examples designed by 
least-squares and iterative weighted least-squares methods. And the stability of the 
designed filters and the effectiveness of the proposed iterative method are also 
revealed by these presented examples. 
 
Keywords: Variable fractional-delay filter, IIR allpass filter, minimax phase error 
design, iterative weighted least-squares method. 
 
 
1. Introduction 
  For the past decade, variable filter design became one of the most important branches in digital 
signal processing because the self-adjustable ability of a variable filter online by tuning the variable 
parameter. Especially, among variable filters, variable fractional-delay (VFD) digital filters are widely 
used in various signal processing applications such as sampling rate conversion, time delay estimation, 
timing adjustment in digital receivers and comb filter design etc., so they have received considerable 
attention [1-21]. Among the presented structures for VFD digital filters, the hybrid of IIR allpass 
structure and Farrow structure [9-21] seems to be a good choice because its unit magnitude gain is just 
coincident with the nature of VFD filters. 
In this chapter, we will focus on the design of allpass VFD filters. For IIR allpass filter design, the 
 85
  To approximate (2), the used transfer function is given by 
( ) ( )( )
1,
, (3)
,
N
A z p
H z p z
A z p
−
−=  
where 
( ) ( )
1
, 1 (4)
N
n
n
n
A z p a p z−
=
= +∑  
in which the coefficients ( )na p  are expressed as the polynomials of p  
( ) ( )
1
, , (5)
M
m
n
m
a p a n m p
=
= ∑  
hence (3) becomes 
( )
( )
( )
1 1
1 1
1 ,
, (6)
1 ,
N M
m n
N n m
N M
m n
n m
a n m p z
H z p z
a n m p z
− = =
−
= =
+
=
+
∑∑
∑∑
 
which can be implemented by the hybrid of IIR allpass structure and Farrow structure [1] shown in 
Fig.1. The frequency response of (6) can be represented by 
( ) ( )( )
( )
( )
1 1
1 1
1 ,,
, , (7)
, 1 ,
N M
m jn
j
j jN jN n m
N Mj
m jn
n m
a n m p eA e p
H e p e e
A e p a n m p e
ωω
ω ω ω
ω ω
−
− − = =
−
= =
+
= =
+
∑∑
∑∑
 
and due to the unit magnitude gain for allpass filters, the design problem is focused on the phase 
approximation, i.e. the phase of (7) 
( )( ) ( )( )arg , 2arg , (8)j jH e p N A e pω ωω= − −  
will approximate the phase of (2) 
     ( )( )arg , (9)dH p N pω ω ω= − −  
as much as possible over 0 ,pω ω≤ ≤ 1 1 1.p p p≤ ≤ +  So the phase design of ( ),H z p  is equivalent 
to that of ( ),A z p , and the design problem can be expressed by 
( ) ( )
( ) ( )
1 1 1
1 1
1 1
, sin
tan , 0 , 1 (10)
21 , cos
N M
m
n m
pN M
m
n m
a n m p n
p p p p
a n m p n
ω ω ω ω
ω
− = =
= =
− → ≤ ≤ ≤ ≤ +
+
∑∑
∑∑
 
 87
By applying Taylor series expansions of ( )2cos pω  and ( )2sin pω , 
    
( )
( )
( )2 1 2 12 11 1
1
1 11 (17 )
2 2 ! 2 1 2 1
k k kk
p
k
p p
s a
k k k
ω+ ++∞
=
− + −= − + +∑  
and the elements of r  and Q  are given by 
( ) ( )( )
( ) ( )
( )
( )
( ) ( )
2 1 2 1
1 1 2
0
1
2 2 2 2
1 1 2 1
0
0
1 1
cos
2 ! 2 1
1 1
sin , 0 1, (17 )
2 1 ! 2 2
p
p
k m k m k
k
k
k m k m k
k
k
p p
i n d
k m k
p p
n d i NM b
k m k
ω
ω
ω ω ω
ω ω ω
+ + + +∞
=
+ + + +∞ +
=
− + −= − + +
− + −+ ≤ ≤ −+ + +
∑ ∫
∑ ∫
r
 
( ) ( ) ( )( )
( )
( )
( ) ( )( )
( )
( )
( ) ( )( )
ˆ 1 ˆ 1
1 1
ˆ 2 1 ˆ 2 1
1 1 2
0
0
ˆ 2 2 ˆ 2 2
1 1 2 1
0
0
ˆsin11,
ˆ ˆ2 1
1 11 ˆcos
ˆ2 2 ! 2 1
1 11 ˆsin ,
ˆ2 2 1 ! 2 2
0 , 1. (17 )
p
p
m m m m
p
k m m k m m k
k
k
k m m k m m k
k
k
n np p
i l
m m n n
p p
n n d
k m m k
p p
n n d
k m m k
i l NM c
ω
ω
ω
ω ω ω
ω ω ω
+ + + +
+ + + + + +∞
=
+ + + + + +∞ +
=
−+ −= + + −
− + −− ++ + +
− + −+ ++ + + +
≤ ≤ −
∑ ∫
∑ ∫
Q
 
In (17b) and (17c), ( )mod , 1,n i N= +  1,iNm = +⎢ ⎥⎣ ⎦  ( )ˆ mod , 1n l N= +  and ˆ 1lNm = +⎢ ⎥⎣ ⎦  where 
( )mod ,x y  denotes the remainder when the integer x  is divided by the integer y , and z⎢ ⎥⎣ ⎦  
denotes the largest integer less than or equal to the real number z. To compute (17), s , r  and Q are 
approximated by Ks , Kr  and KQ , respectively, where 
    
( )
( )
( )2 1 2 12 11 1
1
1 11 (18 )
2 2 ! 2 1 2 1
k k kkK
p
K
k
p p
s a
k k k
ω+ ++
=
− + −= − + +∑  
and the elements of Kr  and KQ  are given by 
( ) ( )( )
( ) ( )
( )
( )
( ) ( )
2 1 2 1
1 1 2
0
1
2 2 2 2
1 1 2 1
0
0
1 1
cos
2 ! 2 1
1 1
sin , 0 1, (18 )
2 1 ! 2 2
p
p
k m k m kK
k
K
k
k m k m kK
k
k
p p
i n d
k m k
p p
n d i NM b
k m k
ω
ω
ω ω ω
ω ω ω
+ + + +
=
+ + + +
+
=
− + −= − + +
− + −+ ≤ ≤ −+ + +
∑ ∫
∑ ∫
r
 
( ) ( ) ( )( )
( )
( )
( ) ( )( )
( )
( )
( ) ( )( )
ˆ 1 ˆ 1
1 1
ˆ 2 1 ˆ 2 1
1 1 2
0
0
ˆ 2 2 ˆ 2 2
1 1 2 1
0
0
ˆsin11,
ˆ ˆ2 1
1 11 ˆcos
ˆ2 2 ! 2 1
1 11 ˆsin ,
ˆ2 2 1 ! 2 2
0 , 1. (18 )
p
p
m m m m
p
K
k m m k m m kK
k
k
k m m k m m kK
k
k
n np p
i l
m m n n
p p
n n d
k m m k
p p
n n d
k m m k
i l NM c
ω
ω
ω
ω ω ω
ω ω ω
+ + + +
+ + + + + +
=
+ + + + + +
+
=
−+ −= + + −
− + −− ++ + +
− + −+ ++ + + +
≤ ≤ −
∑ ∫
∑ ∫
Q
 
To determine the value of K in (18), Table I lists the normalized truncation errors of Ks , Kr  and 
 89
In this section, an iterative weighted least-squares method is proposed for minimax phase error 
design of allpass VFD filters, such that the maximum absolute phase error can be minimized. Now, the 
objective error function becomes 
  ( ) ( ) ( ) ( )1
1
21
20
sin , (21)p
p p T
p
e W p d dp
ω ωω ω ω+= +∫ ∫a a c  
where ( )W ω  is a positive-valued weighting function. Also, the error function can be represented in 
  ( ) (22)T Te s= + +a r a a Qa  
where 
  ( ) ( )1
1
1 2
20
sin , (23 )p
p p
p
s W d dp a
ω ωω ω+= ∫ ∫  
  ( ) ( ) ( )1
1
1
20
2 sin , (23 )p
p p
p
W p d dp b
ω ωω ω ω+= ∫ ∫r c  
and 
  ( ) ( ) ( )1
1
1
0
, , . (23 )p
p T
p
W p p d dp c
ω ω ω ω ω+= ∫ ∫Q c c  
Before describing the proposed iterative method, some notations are defined as below: 
  ( , )pE pω : the absolute phase error function defined by ( ) 2( , ) arg ( , ) ,pjpE p A e p ωωω = −  
  mp : the variable p where the maximum of ( , )pE pω  occurs for the first iteration, 
iγ : the ith absolute error ripple of ( , )p mE pω  with ripple interval 1( , ]i iω ω−  (except that 
the first ripple interval is 1[0, ]ω ), 
δ : max{ iγ }, 
ρ : min{ iγ }, 
ρδ : the relative peak error ratio defined by .ρ δ ρδ δ
−=  
The proposed iterative method is processed as follows: 
    Step 1 : Initiate the weighting function 
          ( ) 1, 0 . (24)pW ω ω ω= ≤ ≤                   
    Step 2 : Find the coefficient vector by 11 .
2
−= −a Q r  
 91
( , )p mE pω  are illustrated in Fig.2 (d). Also, to illustrate the stability of the designed filter, Fig.2 (e) 
depicts the maximum pole radius for [ 0.5,0.5].p∈ −  For the convergence of the proposed method, the 
trace of relative peak error ratio is presented in Fig.2 (f) in which the relative peak error ratio is reduced 
quickly and varies around 65 10−×  after the eighth iteration. 
 
Example 3: As in Section 2 for LS design, the choice of range of p  will affect the overall 
performance for minimax phase error design. For example, an 30,N = 5,M = 0.9pω π=  allpass 
VFD filter is designed with different values of 1p , and the results are tabulated in Table III. Also, the 
performance for smaller 1p  is better than that for larger 1p  for minimax design. By the presented 
examples, it seems to be a good choice to select 1p  around -0.85. 
 
Example 4: In [14], an algorithm for minimax phase-delay error design of allpass VFD filters is 
proposed, which can be modified to design allpass VFD filters with minimax phase error. But the 
convergence of the modified method is not guaranteed for high values of N and M, which also occurs in 
[14]. For comparison, an 4,N = 2,M = 0.75 ,pω π= 1 0.5p = − allpass VFD filter is designed by the 
proposed method and the method in [14]. The obtained absolute phase errors are shown in Fig.3, and 
the maximum absolute phase errors are 0.07026849 and 0.07028372 for the proposed method and the 
method of [14], respectively, which show that the performance of the proposed method is comparable 
with the method in [14] for lower-order allpass VFD filter design. 
 
Example 5: For further comparison with the existing methods, for example the two-stage approach in 
[18] which is applied to design allpass-like VFD IIR filters in LS sense, an 35,N =  5,M =  
0.9 ,pω π= 1 0.5p = − allpass VFD filter is designed in this example. The obtained errors are given as 
below: 
 93
[3] H. Johansson and P. Löwenborg, On the design of adjustable fractional delay FIR filters, IEEE 
Trans. Circuits Syst. II, Analog Digit. Signal process., 50 (4) (2003) 164-169. 
[4] H. Zhao and J. Yu, A simple and efficient design of variable fractional delay FIR filters, IEEE Trans. 
Circuits Syst. II, Exp. Briefs, 53 (2) (2006) 157-160. 
[5] T.-B. Deng and Y. Lian, Weighted-least-squares design of variable fractional-delay FIR filters using 
coefficient symmetry, IEEE Trans. Signal Process., 54 (8) (2006) 3023-3038. 
[6] T.-B. Deng, Symmetric structures for odd-order maximally flat and weighted-least-squares variable 
fractional-delay filters, IEEE Trans. Circuits Syst. I, Reg. Chapters, 54 (12) (2007) 2718-2732. 
[7] J.-J. Shyu and S.-C. Pei, A generalized approach to the design of variable fractional-delay FIR 
digital filters, Signal Processing, 88 (2008) 1428-1435. 
[8] J.-J. Shyu, S.-C. Pei, C.-H. Chan and Y.-D. Huang, Minimax design of variable fractional-delay FIR 
digital filters by iterative weighted least-squares approach, IEEE Signal Process. Lett., 15 (2008) 
693-696. 
[9] V. Välimäki, Discrete-Time Modeling of Acoustic Tubes Using Fractional Delay Filters, Doctoral 
thesis, Helsinki University of Technology, Espoo, Finland, 1995, Chapter3-4, pp.65-168. 
[10] M. Makundi, T. I. Laakso and V. Välimäki, Efficient tunable IIR and allpass filter structures, 
Electronics Lett., 37 (6) (2001) 344-345. 
[11] M. Makundi, V. Välimäki and T. I. Laakso, Closed-form design of tunable fractional-delay allpass 
filter structures, Proc. 2001 IEEE Int. Symp. Circuits Syst., May 2001, pp.434-437. 
[12] C.-C. Tseng, Eigenfilter approach for the design of variable fractional delay FIR and all-pass 
filters, IEE Proc.-Vis. Image Signal Process., 149 (5) (2002) 297-303. 
[13] C.-C. Tseng, Design of 1-D and 2-D variable fractional delay allpass filters using weighted 
least-squares method, IEEE Trans. Circuits Syst. I, Fundam. Theory Appl., 49 (10) (2002) 
1413-1422. 
[14] J. Yli-Kaakinen and T. Saramäki, An algorithm for the optimization of adjustable fractional-delay 
all-pass filters, Proc. 2004 IEEE Int. Symp. Circuits Syst., May 2004, pp. III/153- III/156. 
 95
[26] K. Rajamani and Y.-S. Lai, A novel method for designing allpass digital filters, IEEE Signal 
Process. Lett., 6 (8) (1999) 207-209. 
[27] J.-J. Shyu, S.-C. Pei and C.-H. Chan, An iterative method for the design of variable 
fractional-order FIR differintegrators, Signal Processing, 89 (2009) 320-327. 
[28] C. Y. Chi and Y. T. Kou, A new self-initiated optimum WLS approximation method for the design 
of linear phase FIR digital filters, Proc. 1991 IEEE Int. Symp. Circuits Syst., June 1991, 
pp.168-171. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 97
Table II. The error energy ( )e a , the maximum absolute delay error τε , the maximum absolute phase 
error pε  and the largest of maximum pole radius maxr  for LS design of an 
30,N = 5,M = 0.9pω π= allpass VFD filter with different values of 1p . 
1p  ( )e a  τε  pε  maxr  
0 71.0158 10−× 0.56715 34.2995 10−× 0.86286 
-0.05 86.2803 10−× 0.48831 33.6589 10−× 0.85986 
-0.1 83.844 10−× 0.41891 33.1093 10−× 0.85677 
-0.15 82.327 10−× 0.35697 32.6195 10−× 0.85358 
-0.2 81.3918 10−× 0.30272 32.1987 10−× 0.8558 
-0.25 98.2151 10−× 0.25553 31.8413 10−× 0.87164 
-0.3 94.7768 10−× 0.21428 31.5318 10−× 0.88407 
-0.35 92.7308 10−× 0.17826 31.2641 10−× 0.89537 
-0.4 91.5317 10−× 0.14712 31.0374 10−× 0.90661 
-0.45 108.4087 10−× 0.12033 48.4595 10−× 0.91752 
-0.5 104.5026 10−× 0.097343 46.8185 10−× 0.92769 
-0.55 102.3407 10−× 0.077814 45.4203 10−× 0.93702 
-0.6 101.1756 10−× 0.06151 44.2668 10−× 0.9456 
-0.65 115.6912 10−× 0.04813 43.36 10−× 0.9534 
-0.7 112.6607 10−× 0.037071 42.6387 10−× 0.96038 
-0.75 111.2061 10−× 0.027559 42.0045 10−× 0.9671 
-0.8 125.3829 10−× 0.019501 41.4366 10−× 0.97422 
-0.85 122.7854 10−× 0.013378 41.0042 10−× 0.98103 
-0.9 122.0774 10−× 0.0097575 58.2405 10−× 0.98658 
-0.95 121.5824 10−× 0.0057956 56.1628 10−× 0.99201 
-1 121.7067 10−× 0.0053282 55.3413 10−× 0.99698 
 99
 
 
Fig.1 Farrow structure of an allpass VFD digital filter ( N=5, M=4 ). 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 101
 
  (d)                                       (e) 
 
(f) 
Fig.2 (Continued). 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 103
行政院國家科學委員會補助國內專家學者出席國際學術會議報告 
                                                                98 年 7 月 12 日 
報告人姓名  
徐忠枝 
 
服務機構
及職稱 
 國立高雄大學 
 電機工程學系 
 教授 
     時間 
會議 
     地點 
 2009 年 6 月 24~26 日 
 
 法國巴黎 
本會核定
補助文號
 
 NSC 97-2221-E-390-028 
會議 
名稱 
 (中文) 2009 年電子、電路與系統國際研討會 
 (英文) ICECSD 2009: International Conference on Electronics, Circuits and 
Systems Design 
發表 
論文 
題目 
 (中文) 可調式分數延遲 FIR 數位微分器之設計 
 (英文) Design of Variable Fractional-Delay FIR Differentiators 
 105
二、與會心得 
 
該次研討會舉辦之地點位於巴黎市中心，或許是物價昂貴，會議場所十分狹窄。相較於國內
近年來舉辦之研討會，位置適中，空間寬敞，加上物價遠較歐美便宜。如能積極作為，應可爭取
更多國際會議來台舉行。 
 
三、考察參觀活動 
 
無。 
 
四、建議 
 
由世界科學、工程及科技學會(World Academy of Science, Engineering and Technology)
所主辦之系列研討會每年數次於各國大都會舉行，與會人士來自世界各國。如能爭取至國內舉
辦，對學術提升及國民外交均有實質幫助。 
 
五、攜回資料名稱及內容 
 
會議論文集光碟版一片，總計約 3500 頁。 
 
六、其它 
 
本人此次赴巴黎參加學術研討會，獲國科會補助相關經費，謹在此表達誠摯謝意。 
 
 
報告內容： 
 
一、參加會議經過 
 
    2009 年電子、電路與系統國際研討會系由世界科學、工程及科技學會(World Academy of 
Science, Engineering and Technology)所主辦。會議期間為 6月 24 日至 6月 26 日，假巴黎市
中心之假日大飯店(Holiday Inn Paris, Montpamasse)舉行。 
 
該次研討會研討主題相當廣泛，函蓋工程各個領域，上述僅為其子題之一。另外還包括： 
- Computer and Instructional Technology 
- Mobile, Ubiquitous and Pervasive Computing 
- Power Electronics and Power Engineering 
- Image and Vision Computing 
- Computational Intelligence and Cognitive Informatics 
- Computer Science 
- Medical Informatics and Biomedical Engineering 
- Cryptography, Coding and Information Security 
- Machine Learning and Pattern Recognition 
發表之論文數約四百篇，分 A、B 兩個場地舉行，合計三十場次。來自臺灣之論文數約二十五篇，
比率相當高。 
 
本人之論文被安排在第一天之下午場。論文題目是” Design of Variable Fractional-Delay 
FIR Differentiators(可調式分數延遲 FIR 數位微分器之設計)”。 可調式數位濾波器之設計，
為數位訊號處理領域近年來重要研究子題之一，其特色為如欲改變濾波器之性能時，僅須改變系
統唯一參數即可，毋須重新設計另一濾波器。依濾波性能，可調式數位濾波器分兩方面。一為所
設計之濾波器在振幅或截止頻率為可調，二為在延遲時間為可調。其中後者應用廣泛，近年來發
表之相關論文相當多。在結構方面，可調式分數延遲濾波器可以 FIR、IIR 或 allpass 之方式實
現，但三者大多採用 Farrow structure。 
 
本人發表之論文內容為有關兼具可調分數延遲及微分功能之 FIR 數位濾波器之設計，所使用
之方法為權重最小均方法(Weighting least-squares method)。論文重點之一是所有相關之矩陣
或向量均可以表示為封閉式(Closed-form)，因此可以大大降低運算量。 
 
會中，與會者提到：此系統是否可以串聯一微分器及一可調分數延遲濾波器即可？此問題本
人也曾深思過，但因前後串聯之系統將造成更大之振幅誤差，且整體延遲時間將因而拉長。故，
仍以本論文所設計之系統為佳。 
 
 



