 2
建立 CIMS 環境下兼有加工參數預測和產
品品質分析功能的製造單元模擬系統[2]，
討論數控程式與如何進行代碼解釋的實現，
並提出一個 NC 加工碼釋執行的方法最後
進行解譯模擬。余世林,朱國寶[3]在數控自
動編程中，將前置處理與後置處理分開設
計，前置處理負責翻譯分析和計算處理等
內容，以產生刀具文件。周沖、錢昆明、
齊昕[4]以數控車床模擬系統為例。闡述數
控模組的設計與實現，並介紹程式輸入顯
示、G Code 編譯、除錯等設計思路，提出
使用二元樹構建 G Code 語法，並建構二十
餘條偵錯檢查規則。也是首次將編譯這個
概念導入 GM 加工碼分析中。范邵寧以
Excellon 碼為例[5]，設計 CNC 控制器之混
合式編譯器，最後實現在 PCB 鑽孔機上。
文中對直譯器、編譯器、混合式編譯器三
種常見之編譯架構進行效率上的比較與優
劣分析 MA Xiong-bo[6]提到如何選擇數控
系統軟件和硬件平台和軟件的方法。以及
如何以靜態建模方法使用開放式架構加工
系統，其中包括面向對象（OO）的編程技
術，動態鏈接庫（DLL）技術和系統模塊
分區進行討論。  
 
三、系統架構與原理 
 
自動化數值加工系統中，在前端
CAD/CAM 軟體的輸出與後端機台運動命
令輸入之間的關鍵部位，需要有一轉譯程
式將 NC 碼轉譯為運動命令。且除了運動
命令外，機台於加工前須利用各種周邊設
備進行加工環境與機台加工條件的初始化。
因此，對於複雜形狀之加工物，往往需要
反覆地進行複雜的加工程序安排。為了使
加工過程更簡易且更具效率，本研究將利
用PC-Based自動化加工系統的開放性將複
雜的加工編輯程序利用圖形化的 Icon 的概
念進行簡化。最後以 Visual Studio2005 做
為開發軟體，進行程式撰寫與發展。圖一
為進行圖形化語言編譯控制系統設計所需
之背景知識圖。 
 
 
   圖一 系統設計所需背景知識圖 
 
3-1系統軟體架構堆疊： 
 
圖二為本研究之系統堆疊架構圖。本
系統架構主要以分層類別之概念建構，每
一層各司其職，各自存取上一層之資料，
藉由此概念可讓後續維護更為便利。每層
所負責之任務職責，分述如下： 
 
1. Graphic Icon NC Language：
此圖形化 NC 加工碼層主要用於產生圖
形化齁加工碼與文字型態之間繫結顯
示，以及對於滑鼠拖曳 icon 所產生的
相關資料傳遞動作。相關圖形化細節可
參閱 3-2 節。 
 
2. Data Event Handler：針對欲
處理之圖形化加工碼訂閱其資料型態
與處理過程。 
 
3. NC Code Analysis：此部分為
前端編譯，也就是將加工碼經由語彙、
語法與語意等字串分析流程，利用旗標
(先行記錄狀態)的方式設定與記錄加工
參數和欲解析出點位資料屬於何種運
動模式。詳細說明可參閱 3-4 節。 
 
4. Motion Command Generation：
利用上述所記錄之結果進行點位資料
之修正，並產生運動命令中間碼。詳細
修正方式過程可參閱 3-5 節。 
 
5. Object Code Generation：目的
碼產生是以直譯的方式將中間碼轉換
為對應的 API 以輸出命令到運動控制
卡。 
 
 4
 Del :  於介面移除 icon 圖樣顯
示。 
 Move :  游標抓住 icon 進行拖
曳。 
 Drop :  游標抓住 icon control 
放入視窗預設框內。 
 Pop :  取下 icon ，控制權交回
游標，icon 跟隨游標。 
 New icon obj : 在主表單內新增
的 icon 。Icon obj 為建立的控制項物
件。 
 Edit :  可針對特定 icon 物件
編輯客制化 GM-code。 
 Attribute : 選擇某些特殊屬性，對
系統作微調整。 
Tool box class： 存放相關 icon 參數。 
 New : 新增 icon 控制項。 
 Die : 移除 icon 控制項。 
 Edit : 編輯 icon 控制項內容的
GM-code 或新增某些屬性。 
 Put : 放置在主表單所建立的 icon
控制項。 
 View : 修改 icon 物件編輯客制
化 GM-code。 
 Get code: 顯 示 icon 包 含 之
GM-code。 
 Cut : 剪下。 
 Put :貼上點選在控制項所建立的
icon 控制項。 
 Set : 修改內部屬性與微調。 
3.3.1 圖形化介面 Icon 列表  
而本研究目前所規劃與使用之圖形化
Icon 加工碼與相對應之參數與格式如表一
所示： 
 
      表一 系統內建 G Icon 列表 
Icon 圖式 功 能說明 
對應文字項
與參數輸入格
式 
1 
 
公制模
式啟動 G20 
2 
 
英制模
式啟動 G21 
3 
 
累增模
式開啟 G90 
4 
 
累增模
式關閉 G91 
5 
 
絕對零
點設定 G92 
6 
 
第一座
標 系 選
擇 
G54 
7 
 
第二座
標 系 選
擇 
G55 
8 
 
程式中
的 分 格
符號 
% 
9 
 
快速定
位 G00XxYyZz 
10 
 
Linear
模式 G01XxYyZz  
11 
 
CW 模
式 G02XxYyIiJj 
12 
 
CCW模
式 G03XxYyIiJj  
13 
 
動作後
停止 t ms G04Xt 
14 
 
刀具高
度補償 G10ZzHh 
15 
 
原點復
歸 G28 
16  
刀具左
補償 - 補
償 所 有
rout 功能 
G41 
17  
刀具右
補償 - 補
償 所 有
rout 功能 
G42 
 
3.3.2 圖形化介面資料傳遞流程 
圖形化介面資料傳遞流程即是將圖形儲
存控制項(Listview控制項)與繪圖顯示控制
項(Picturebox 控制項)所建構出之操作介面，
利用滑鼠事件作為操作介面傳遞資訊之流
程。首先，我們將繪圖顯示控制項根據圖
形化 icon 的寬與長類比為維度[10,N]的矩
陣儲存格，而每一個儲存格內屬性如表二
 6
主要是由重新取得資料儲存格的位置
([Colum , Row])與拖拉之 Icon 種類資料內
容(Icon Data 於 2.2.2 所列之儲存格資料表
中定義)。而計時器則是不停的點閱繪圖以
維持目前所顯示之介面。因此當有新的資
料出現異動實現則介面即重新顯示。
圖七 圖形化介面訊息更新流程圖 
 
四、系統模擬與驗證 
 
本研究之圖形化加工碼編譯器的主要
目標，即是在於將圖形化後之 NC 加工碼
編譯後產生一相對應運動行為之中間碼組
合。而後端的 API 運動函式庫即根據本研
究所產生之中間碼組合產生相對應的運動
命令行為。並根據中間碼所記錄之數值作
為相對運動命令函式之引數。 
為了驗證本研究所解譯出之點位與運動行
為正確，以下將分別對實際運動命令記錄
結果、模擬繪圖結果進行測試。本研究所
開發之圖形化 GM 運動指令編譯器的主要
目標，即是在於產生一連串的運動行為做
為目的碼，而後端的運動控制卡則接收本
研究所產生之目的碼，並以此目的碼為參
考命令進行控制。本研究研究開發之系統
圖形化編譯介面如圖八所示： 
具有拖曳元件(Icon)列表、Icon 繪製區以及
對於圖控程序的一些基本操作行為。 
 
 
圖八 圖控介面概述 
 
 
經由拖曳左方的 Icon 列表至繪製區中，
可產生對應之 Icon 顯示。並當對繪製區內
之 Icon 按下滑鼠右鍵時，左下角之參數設
定欄位將根據 Icon 的種類顯示參數設定項，
並可對不同的 Icon 進行參數設定。 
如圖九與圖十所示，以鑽孔指令為例。利
用圖形化介面拖曳 Icon 與進行參數設定，
其等同於手動輸入與撰寫以下 NC 加工碼 
G90 
G20 
T1 
G81 X50Y20X70Y20  
G82 X15.Y30.X40.Y40. 
 
 
 
圖九 圖控介面 Icon 編輯拖曳動作示意圖 
 
 
圖形化 NC 加工碼 Icon 拖曳欄
加工碼參數設定欄位 
圖形化 NC 加工碼
 8
半徑補償研究”, 電子機械工程, 20(2), 
pp37-39, 2004. 
4. 周沖, 錢昆明, 齊昕, “數控車床彷真系
統中數控內核的設計與實現”, 計算機應
用, 25(2), pp463-465, 2005. 
5. 范邵寧, “CNC 控制器之混合式編譯器原
理研究與發展以 PCB 鑽孔機   Excellon
碼為例”, 國立成功大學製造工程所碩士
論文, 2008. 
6. MA Xiong-bo, HAN Zhen-Yu, Wang 
Yong-Zhang, Fu Hong-Ya, “Development 
of a PC-based Open Architecture 
Software-CNC System”, Chinese Journal 
of Aeronautics 20, pp. 272-281,2007. 
 1 
財團法人成大研究發展基金會 
出  國  結  案  報  告  書 
 
赴第十三屆海峽兩岸機械工程技術
交流會 
＜出  國  案  名  稱＞ 
 
 
 
 
 
經 費 來 源：________________ 
出 差 人：     陳響亮      
出 國 期 間： 2010.09.04~09.11 
出 國 地 點：  湖南,長沙市    
執行長簽核：________________ 
 3 
 
一、 目的 
赴中國大陸湖南省長沙市參加『第十三屆海峽兩岸機械工程技術交流
會』，進行雙邊技術交流並且聽取 2010 年中國機械工程學會工作報告。 
二、 過程 
第一天：2010/09/04 台北長沙  搭機前往 
第二天：2010/09/05 長沙市區觀光, 參訪湖南省張家界景區 
第三天：2010/09/06 參訪湖南省張家界景區 
第四天：2010/09/07 參訪湖南省張家界景區 
第五天：2010/09/08 參訪湖南省長沙大學 
第六天：2010/09/09 第十三屆海峽兩岸機械工程技術交流會 
第七天：2010/09/10 第十三屆海峽兩岸機械工程技術交流會 
第八天：2010/09/11 長沙台北 
 
 
 
 5 
本次會議由台灣與中國大陸之代表團共同舉行。大會由大陸中國
機械工程學會宋天虎 常務副理事長主持，何光運 先生、       陳朝
光 理事長、劉克利 先生、邱鴻興 秘書長等人分別致詞。雙方團長並
代表團隊互贈紀念品與禮物。 
本次交流會除台灣代表外，大陸各省區市學會有關從事智慧製造
技術研發及應用的人員參加踴躍。大會進行的方式有大會報告、現場
討論以及企業參觀的形式，交流研究成果與技術心得。 
   
圖 2 大陸代表致詞 
 7 
 
 
在會議中，何光遠榮譽理事長在致詞中表示，“海峽兩岸機械工程
技術交流會”始於 1996 年，今年已是第十三屆。10 多年來，海峽兩岸
機械工程學會通過輪流在海峽兩岸舉辦此學術活動，逐步擴大和加深
了兩岸機械工程領域學術界和企業界的交往和合作，密切了兩岸學者
和企業間的交流，增進友誼和瞭解，並通過這個途徑展開合作。 
 
圖 5 技術交流會開幕式場景之一 
 
 9 
位專家學者做了報告，分別結合各自在智慧製造及有關領域的實踐，
交流智慧製造在工程設計、工藝過程、生產調度、故障診斷等諸多生
產環節的研發與應用情況，探討新的前進方向。本次大會主辦單位訂
定的會議主題為：智能製造技術研發及應用。 
智能製造是製造技術自動化的發展趨勢，目前，智能製造已經在工程
設計，工藝過程設計，生產調度，故障診斷等諸多生產環節有所應用。
大會希望兩岸學者可以就機械工程學科前沿--智能製造技術的應用和
研發問題進行深入的交流，探究如何將智能製造技術應用於產品製造
和生產管理中，從而推動兩岸機械製造的智能化。  
本次大會主辦單位訂定的會議議題包括：  
    1、智能設計理論、方法及系統  
    2、智能加工、智能檢測與控制  
    3、數字化設計與產品開發  
    4、自動化與現代製造系統  
    5、機器人與智能裝備  
    6、機器人控制系統及執行機構  
    7、數控技術與數字化裝備  
    8、製造信息與知識處理  
    9、先進製造模式與戰略  
 11 
報告人:左培倫，臺灣清華大學動力機械系教授 
5. 報告主題:《焊接製造中的智慧技術》 
報告人:宋永倫，北京工業大學機電學院教授 
6. 報告主題:《智慧化高回應數控機床在高產量生產線的加工應用》 
報告人:陳政雄，中興大學機械系教授 
7. 報告主題:《數值化技術與產品開發》 
報告人:梁小波，湘電集團重型裝備股份有限公司副總經理 
8. 報告主題:《燃料電池金屬雙極板現況與未來發展》 
報告人:李碩仁，元智大學機械系教授 
9. 報告主題:《基於譜方法的複雜時空耦合製造過程神經網路建模研
究》 
報告人:鄧華，中南大學機電工程學院教授 
10. 報告主題:《製造分析法於精密磨料加工制程研發與基板加工之應
用》 
報告人:陳炤彰，臺灣科技大學機械系教授 
11. 報告主題:《分裂導線越障平臺》 
報告人:詹涵菁，湖南大學機械與運載工程學院教授 
 13 
 
圖 10 技術交流會專題報告現場 
 
 
圖 11 技術交流會之台灣代表之一 
 15 
 
 
圖 13 湖南省張家界景區參訪 
 
圖 14 湖南省張家界景區參訪-團長及夫人 
 
98年度專題研究計畫研究成果彙整表 
計畫主持人：陳響亮 計畫編號：98-2221-E-006-060- 
計畫名稱：具圖型化語言編譯能力之 CNC 控制系統研究(II) 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 0%  
研究報告/技術報告 0 1 70%  
研討會論文 0 1 30% 
篇 
 
論文著作 
專書 0 0 0%   
申請中件數 0 0 0%  專利 已獲得件數 0 0 0% 件  
件數 0 0 0% 件  
技術移轉 
權利金 0 0 0% 千元  
碩士生 0 2 50%  
博士生 0 1 50%  
博士後研究員 0 0 0%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 0% 
人次 
 
期刊論文 0 0 0%  
研究報告/技術報告 0 0 0%  
研討會論文 0 0 0% 
篇 
 
論文著作 
專書 0 0 0% 章/本  
申請中件數 0 0 0%  專利 已獲得件數 0 0 0% 件  
件數 0 0 0% 件  
技術移轉 
權利金 0 0 0% 千元  
碩士生 0 0 0%  
博士生 0 0 0%  
博士後研究員 0 0 0%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 0% 
人次 
 
 
