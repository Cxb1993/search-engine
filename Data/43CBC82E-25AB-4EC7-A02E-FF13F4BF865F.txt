 2
行政院國家科學委員會專題研究計畫成果報告 
可逆式資訊隱藏技術及其應用於影像內容驗證與影片智慧財
產權保護 
Reversible Information Hiding Techniques and Its Applications in 
Image Content Verification and Video Intellectual Property Rights 
Protection 
計畫編號: NSC 97-2221-E-324 -008 
執行期限: 97 年 08 月 01 日 至 98 年 10 月 30 日 
主持人: 呂慈純  
E-mail: tclu@cyut.edu.tw 
http://www.cyut.edu.tw/~tclu 
執行機構及單位名稱: 朝陽科技大學 
 
 
一. 中文摘要 
在數位影像軟體的普及下，利用數
位影像的藝術創作已漸漸成為趨勢，隨
之而來的便是智慧財產權、合法權證
明、所有權證明、資料完整性確認等相
關的問題，這方面便需要依賴更可靠的
影像辨識、驗證的相關技術。眾所皆知，
數位影像因為具有體積小，且容易複製
傳播的特性，一旦受到壓縮、切割、旋
轉、放大、縮小等等動作之後，便很容
易讓影像中的數位浮水印受到破壞，而
無法正確辨識。當數位浮水印無法正常
辨識時，很有可能就是遭受破壞或竄
改。因此如何利用數位浮水印驗證媒體
內容即受到高度的重視。 
Celik 等學者於 2006 年提出一個無
失真式數位浮水印[7]技術，用以偵測影
像中那些區域受到破壞或竄改，在驗證
過程中，採用階層式架構來做偵測，以
達到影像內容驗證。然而，Celik 等學者
所提方法無法有效控制影像的失真度；
再者，若欲藏入的秘密資訊只是很簡短
的幾個句話，或者是小商標、小圖示，
這些機密資訊並不會用到整張影像，甚
至可能只會使用到影像的某些部分時，
如何控制偽裝影像的影像品質，就變成
主要追求的目標了。因此，如何安排資
訊藏入的位置，讓偽裝影像的失真度能
夠降到最低，即為本計畫的重點工作。
本計畫提出一個可逆式資訊隱藏技術並
且應用於影像內容驗證，所提方法將資
訊藏匿於複雜度較高的影像區塊中，其
目的是不讓非法第三者得知該圖片中藏
有秘密資訊，如此一來，偽裝影像的品
質會較 Celik 等學者所提出的方法還要
高。 
 
關鍵詞：影像驗證、可逆式資訊隱藏、
變異數、階層式浮水印   
Abstract 
Watermarking is one application of 
information hiding that is used for 
intellectual property right, forgery 
detection, or authorship inference, 
especially for multimedia authentication. 
Watermarking hides an invisible 
ciphertext or watermark in a host medium 
without changing the meaning of the 
 4
眼辨識出來，也就是影像品質有基
本的要求，如此才不致於喪失原始
媒體之價值。 
(2) 強健性(Robustness) 
遭受數位訊號處理攻擊後，其品質
仍在可接受的範圍內時，該數位浮
水印仍然可以被顯示出來。 
(3) 不可偵測性(Undetectable) 
除合法者外，其他人無法偵測出該
影像有數位浮水印的存在，以確保
數位浮水印之安全。 
(4) 安全性(Security) 
與密碼學中的加解密演算法相似，
藏入數位浮水印的演算法必須是公
開的，換句話說，不能把系統的安
全性全然建築在破壞者不知道系統
是如何運作的假設前提下。 
(5) 盲驗證(Blind Detection) 
通常數位媒體需要極大的儲存空
間，為了節省空間，在取出數位浮
水印時，不必藉由原始媒體之輔助
即可完成，也就是不用為了取出浮
水印而須同時儲存兩份媒體。雖然
藏密學及數位浮水印技術都是將資
訊隱藏進入掩護媒體中然後再進行
傳遞，但是藏密學比較趨向於兩方
間之資料通信，因此藏密學的做法
一般來說較不強調具有強健性。例
如隱藏進入影像的資料經過壓縮
後，資料通常無法正確的取出，甚
至造成毀損。而數位浮水印則大為
不同，為保護數位資料的著作權，
需要具有強健性的特性，數位浮水
印可於多人之間傳送，其應用包含
廣播監控、數位指紋及資料驗證與
還原等，以下就上述應用簡要說明。 
(6) 廣播監控 
由於網際網路無遠弗屆，突破時空
上的限制，為消費者帶來相當大的
便利，同時也為企業帶來更大的利
基，使得許多企業為了爭取商機無
不絞盡腦汁升級為「.com」公司以
爭取商機；如線上購物、線上訂票
(位)、線上隨選視訊、線上廣播、…
等。網路雖然方便，但它所同時衍
生出來的安全問題也比一般的媒體
更為複雜，這其中有很多問題可以
用密碼學的相關技術來加以克服，
但有關於線上商業廣告及有價媒體
(如聲音、影像、影片、文件及軟體
等)在網路上傳送之結果，其智慧財
產權或收費認證的問題，就得依靠
數位浮水印相關技術來加以解決。 
(7) 數位指紋 
數位指紋是物件的特性，就如人類
的指紋一樣，可以用來分辨相似物
件。進入數位資訊時代後，傳統以
紙張形式儲存的文件，逐漸轉成數
位的形式儲存，或是在網路上傳
遞。資訊隱藏於文件檔案之技術，
除了可以嵌入浮水印來保障所有者
的智慧財產權之外，也可以將數位
指紋嵌入到文件中，用以追蹤洩密
者。例如：在秘密會議中，每位與
會者的文件都嵌入不同的浮水印
(即數位指紋)，記錄著此份文件發
給那一位與會者。當發生文件洩密
事件時，便可以藉著從文件中取出
的數位指紋，來查出洩密的與會者
了。 
數位指紋並不是設計來展現著作權
和作者間的關係，而是為了確保使
用者是否合法。和密碼學比較，這
種高精確性可能看起來不完整且不
精細，但它的作用只是向使用者宣
示警惕重視著作權的效果。數位指
紋是運用於終點端的數位浮水印，
每一個複製物都擁有一個不同的商
品編號，以證明購買者的擁有權，
並可以作為日後非法複製或散播之
舉證及追查用途。在著作權的保護
上，數位指紋確是一個簡單、質輕
 6
訊，而若藏在較複雜的部份，別人
很難得知該張圖片有資訊的藏入。 
    因此，本計畫擬提出一個可逆式數
水印技術，用以偵測出影像是否有被竄
改，並且可以指出被竄改的區塊範圍。
擬提方法能夠有效改進 Celik 等學者於
影像失真度控制上的缺失，並且能夠達
到可逆還原的目的。 
三. 報告內容 
本計畫針對局部性驗證浮水印技術
L-LAW 的缺點進行改良，提出一個可逆
式數位內容驗證技術，其中包含二個程
序，一個為資訊藏入程序，另一個為資
訊取出及驗證程序。以下我們詳細說明
二個程序的概念。以下為嵌入步驟： 
嵌入步驟 
步驟 1：將原圖切成數個 8×8 的大區塊，
得到區塊 B 。 
步驟 2：每個區塊 B 切為數個 2×2 的小
區塊，可得 b0、b1、b2、b3。 
步驟 3：針對每個小區塊做量化，得到
Q(bi) 及 R 圖，量化公式為
q
q
bbQ ii ×⎥⎦
⎥⎢⎣
⎢=)( ，R 圖則為 bi
與 Q(bi)的差異值。 
步驟 4：計算每個 Q(bi)的變異程度。 
步驟 5：將區塊依變化程度由大至小排
序。若變異程度愈大，代表此區
塊的像素值之間變動得愈劇
烈，因此在本研究稱此區塊為複
雜區塊。用來判斷變化程度的計
算式如下：  
∑
=
−=
N
k
kxN 1
22 )(1 µσ
 
(2) 
其中 2σ 為變異數 (Variance)，
Nk xxxx ,...,, 21= 為區塊像素值，N 代表
像素的個 
數，µ 則是平均值[錯誤! 找不到
參照來源。]。 
步驟 6：取出計算後的變異數前四名所
對應的小區塊的 LSBs，此為欲
藏入的秘密資訊，取出之後將
變異數前四名的原始 LSBs 改
變為 0。 
步驟 7：利用 Lossless G-LSB 方法藏匿
資料。將步驟 6 中取出的 LSB
加上算術編碼，以 G-LSB 法將
值嵌入至變異數第五至十六名
的部份。 
步驟 8：變異數的前 4 名所對應的小區
塊用來藏匿驗證碼。本研究針
對一整個區塊 B 進行 MD5 的
雜湊函數計算，可得到一串亂
碼，再將此亂碼經假定為 16 位
元的 HMAC 計算，得到 16 個
二進制值，即為該區塊 B 的驗
證碼。之後將此驗證碼依序嵌
入至區塊 B 中變異數前四名的
LSBs 中，因為步驟 6 中將變異
數前四名原始的 LSB 置為 0，
因此可將驗證碼嵌入於其中。 
以下我們舉個例子說明，圖六(a)為
一張影像中的某一 8×8 區塊 B，且切成
2× 2 的小區塊，圖六(b)為量化後的結
果，圖六(c)為圖六(a)的像素值減圖六(b)
量化後的像素值之差異量表。 
 
(a) 區塊 B，並切成 2×2 的小區塊 
 8
轉為十進制(0.71127022802829)10，將這
個十進制值投入區間，找出最趨近於它
的值，如下圖所示。 
 
圖 8. G-LSB 區間圖 
 
我們拿變異數為第五名，如圖3(b)
中灰色部份，第一個值 125 加上機密訊
息所對應的區間號碼，即 125+3=128，
第二個值為 90+2=92 ，第三個值為
45+3=48，依此類推即可得偽裝像素。
而變異數前四名的 LSBs 所藏匿的是驗
證碼，因此在其它變異數名次藏完資訊
後，將區塊 B 進行 MD5 的雜湊函數及
HMAC 的計算，將所得的 16 個二進制
值依變異數名次依序放置個別的
LSBs ， 假 設 最 後 得 到
1001001000100010，則變異數的前四名
改變後的值如圖9，為偽裝區塊 B′。 
 
 
圖9. 偽裝區塊 
 
暗色部份深淺即為變異數一至四名所對
應的小區塊，所藏的是驗證碼，框起來
的部份則是變異數第五名，藏匿了部份
的秘密資訊。 
 取出步驟： 
在取出時，必須驗證每個區塊 B′的
驗證碼是否與發送端原先區塊 B 嵌入的
驗證碼相同，如此一來，才能偵測那些
區塊已遭竄改，而那些區塊與原先發送
端所送出的區塊相同，倘若相同則再做
該區塊的復原動作。 
在經量化後，本研究最初在藏入資
訊前的 Q(bi)會等於取出時量化後的
Q( ib′ )，因此可以計算出與發送端在嵌入
資訊前相同的變異數名次。將變異數前
四名的 LSBs 取出後做 MD5 與 HMAC
的計算，將計算後的值與變異數前四名
的 LSBs 做比對，倘若比對不符，則表
示此區塊 B′已遭竄改。 
資訊驗證及取出的步驟如下： 
取出步驟 
步驟 1：將原圖以 8×8 為單位切為數個
大區塊，得到區塊 B′。 
步驟 2：每個區塊 B′切為數個 2×2 的小
區塊，得到 0b′、 1b′、 2b′、 3b′。 
步驟 3：針對每個小區塊做量化，得到
Q( ib′ )及 R′圖。 
步驟 4：計算每個區塊的變異程度。 
步驟 5：將區塊依變化程度由大至小做
排序。 
步驟 6：取出變化程度最大的前四名所
對應的小區塊的 LSBs，形成驗
證碼。  
步驟 7：將整個大區塊做 MD5 及 HMAC
的計算，得到 16 位元的二進制
值。 
步驟 8：將驗證碼與步驟 7 所取出的 16
個二進制值做比對，倘若兩者
相符則表示此小區塊未遭不法
人士竄改，可進行步驟 9；倘若
兩者不同，則可得知此處已遭
竄改，則此區塊 B′就無法還原
 10
 
(a) 39.72 dB 
 
(b) 39.72 dB 
 
(c) 39.70 dB 
 
(d) 39.79 dB 
圖 14. 偽裝影像 
 
根據實驗結果可知，我們的偽裝影
像品質較 Celik 學者的來得好，此外我
們的方法可以有效的偵測出被竄改的區
域為何。 
四. 計畫成果自評 
隨著數位時代的來臨與資訊技術的
進步，網際網路 (Internet) 已然成為生
活的必備工具。在全球網絡相連之下，
任何資訊都可以轉換成數位資料，透過
網路廣泛地傳播、散布。然而，在享受
數位科技帶來的便利與商機時，有些潛
在的問題 卻是值得我們憂心的，例如，
隱私權及智慧財產權侵犯、著作物加以
複製、歪曲、偽造、割裂或篡改、資料
竊取、監聽與偷窺等。因此，如何確保
數位資料在網路上傳輸時的安全，便成
為數位時代不容忽視的重要研究。 
本計畫原擬提出一個可逆式資訊隱
藏技術，並將其應用於影片智慧財產權
保護之機制，原定為三年期之計畫，但
因本計畫只通過為一年期，故先針對影
像媒介做研究，影片內容部分，則留待
下一年計畫再繼續完成。 
本研究所完成之系統具有學術及實
用價值。參與本計畫之研究生學會蒐集
資料，鑽研近年來所提出之各種資訊隱
藏技術，瞭解回顧與檢討研究領域的重
要性，更重要的是能嘗試對於問題提出
見解。 
五. 參考文獻 
[1]陳俊宏，採用浮水印技術之影像驗證，朝
陽科技大學碩士論文，2003。 
[2]張真誠、黃國峰、陳同孝，電子影像技術，
旗標出版股份有限公司，頁碼 233-236，
2003。 
[3]謝仲凱，應用於影像驗證及回復的階層式
浮水印機制，國立中興大學碩士論文，
2004。 
[4]戴顯權，資料壓縮，紳藍出版社，頁碼 
5-28~5-34，2002。 
[5]Bellare, M., Canetti, R., and Krawczyk, 
H., “Keying hash functions for message 
authentication,” Proceedings of 
Cryptology 96, Vol. 1109, pp. 13-14, 
1996. 
[6]Celik, M. U., Sharma, G., Tekalp, A. M. 
and Saber, E., “Lossless generalized-LSB 
data embedding," IEEE Transactions on 
Image Processing, Vol. 14, No. 2, pp. 
253-266, 2005. 
[7]Celik, M. U., Sharma, G., Tekalp, A. M. 
and Saber, E., “Localized lossless 
authentication watermark (LAW),” 
  1
出席國際學術會議心得報告 
                                                             
計畫編號 NSC 97-2221-E-324-008 
計畫名稱 可逆式資訊隱藏技術及其應用於影像內容驗證與影片智慧財產權保護 
出國人員姓名 
服務機關及職稱 
呂慈純 
朝陽科技大學資訊管理系 副教授 
會議時間地點 
時間：2009/9/12 – 2009/9/14 
地點：日本 京都    
會議名稱 The Fifth International Conference on Intelligent Information Hiding and 
Multimedia Signal Processing (IIHMSP2009) 
一、 參加會議經過 
The Fifth International Conference on Intelligent Information Hiding and 
Multimedia Signal Processing (IIHMSP2009) 研討會於 2009年 9月 12日至 9
月 14日於日本京都舉辦，會議為期三天。 
我們於會議前一天抵達日本，隔日辦理註冊並且參與會議。與會的學者專家
有來自德國、波蘭、美國、日本、泰國、英國、澳洲、中國、新加坡、韓國、
埃及、印度、伊朗等國家。會議安排了三場演講  
1. Title:  The state of the art of 3D video technologies – accurate 3D shape and 
motion reconstruction, high fidelity visualization and efficient coding for 3D 
video   
Speaker: Takashi Matsuyama 
2. Title:  Data compression by data hiding 
Speaker: Hyoung Joong Kim 
3. Title:  Multimodal information fusion in the virtual environment and its 
application in produce design  
  3
二、 與會心得 
此次會議是由日本 Ritsumeikan 大學與台灣高雄應用大學合辦， IEEE 
Computational Intelligence Society協辦，會議論文的審查過程相當嚴格，很
榮幸我們的論文能被接受，並有機會參與此次會議，聽取目前最新的研究成
果，相常令人開心。會議報告時認識了許多學者，與學者專家們相談甚歡，
並互留聯絡方式，作為學術交流。在會中瞭解到目前最新的科技發展動脈，
不但可以激發研究靈感，還因此認識了不少相關領域的專家學者，藉著與國
外傑出學者的交流互動的機會，得知論文作者在架構論文及獲得靈感的思考
歷程，這些對以後學術研究上都有相當大的幫助。會議晚宴時，與各國學者
有更多的互動，主辦單位也貼心安排了日本有名的舞蹈及茶道表演，讓參與
的人都相當開心。 
