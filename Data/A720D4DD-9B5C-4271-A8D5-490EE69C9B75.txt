-2- 
 
integrated ultrasound image and biopsy 
diagnosis system. 
This joint project has three sub-projects: 
Project 1:  PC-based Breast Ultrasound 
Scanning and Diagnosis System 
Project 2: The Research and Design of the 
Wearable Ultrasound Scanning Aid 
System 
Project 3: Breast Biopsy Computer-aided 
Diagnosis System. 
In these two years, we complete the PC-based 
ultrasound operation software, whole breast 
tumor computer-aided detection, and wearable 
computer-aided ultrasound system, and breast 
biopsy computer diagnosis system. 
 
一、 緣由與目的 
根據行政院衛生署的統計，乳癌的發
生率與死亡率逐年增加。乳癌好發年齡在
40~50歲之間，較歐美國家的好發年齡約提早
十歲，但任何成年婦女皆有機會罹患此症。
近年來由於醫學進步，經由適當的治療，乳
癌的十年存活率平均達百分之六十，第一期
乳癌的存活率則高達百分之八十，零期乳癌
甚至接近百分之百[1]。乳癌是今日引起婦女
死亡最常見的癌症之一，隨著生活習慣逐年
改變，罹患乳癌的年齡有逐漸下降的趨勢而
且乳癌的發生率也持續增加中。美國統計
1996-2000年乳癌的發生率為每十萬人中有
131.7人罹患乳癌，佔全部罹癌的 31.4% 
(131.7/419.9)，美國預估2004年，將有215,990
罹患乳癌的新病例並且預估約有 40,110 
(15%)的死亡病例。[2] 
早期發現早期治療是降低死亡率的不
二法門。超音波便是用來診斷乳癌的一項利
器。但是通常傳統超音波掃描器，常為醫院
內所使用大型且笨重的裝備，在操作流程上
也相當的繁複，當醫師在操作掃描儀時，必
頇以雙手操縱搖桿與專注在顯示螢幕上，導
致醫師無法全神專注在診斷行為上，也無法
調閱病人的相關資料以為輔助，造成操作上
的相當不便，以及醫師的注意力分散，大幅
降低診斷的效率。為了一些特殊用途如軍事
及急診，也出現了可攜式的超音波(Portable 
Ultrasound)  [3]，本整合型計畫的目的在於
開發一套利用PC-based的可攜式超音波的全
自動乳房掃描系統，並利用可攜式電腦裝備
提供可攜式輔助系統，也結合超音波電腦診
斷及病理電腦診斷完成一整合系統。在總計
畫中，我們將整個系統分成三個子計畫：(一) 
個人電腦為基礎之乳房超音波掃描診斷系
統、(二) 可穿戴式超音波掃描輔助系統的研
究與設計及(三) 乳房腫瘤切片電腦診斷系
統。 
超音波有不少參數可以設定，如果參
數設定有誤將使影像失真造成診斷的錯誤
[4] 。重要的參數有焦距 (Focus) 和增益
(Gain)，通常這些參數是必頇由操作者進行設
定，如果操作者忘了修正，影像品質將會欠
佳，另外有時操作的問題也會產生Artifact，
這些問題電腦可以提供檢查並預防問題發
生；再者，我們的電腦輔助診斷(CAD)系統
目前主要應用於傳統的一般2D超音波及新
一代的3D立體超音波機器，但是這些超音波
都是封閉的系統，我們的電腦輔助系統並沒
有方法嵌入至一般商業化超音波機器內，形
成一個完整的系統，亦即我們的電腦輔助系
統和超音波系統是完成獨立的，電腦輔助系
統是只是取得超音波影像進行分析。所以，
在子計畫一中，我們要將依照美國放射學會
(American College of Radiology, ACR)的標準
[5]，幫操作者進行確認工作，也可以提供自
動設定焦距和增益的功能。在改善影像品質
之後，這些資料將被使用來發展電腦輔助系
統，在本計畫中的系統，不僅提供診斷且具
有自動偵測的能力；即從中找出所有可疑的
-4- 
 
在第二年的成果中，我們主要是完成了
自動增益控制（Automatic Gain Control）及
自動對焦控制（Automatic Focus Control）。
以此來使系統能自動地調整影像品質，並在
此影像樣本上進行腫瘤的自動偵測系統。 
 
(1.1) 自動增益控制的結果 
在自動增益控制方面，我們採用了66個
樣本來進行實驗。在評估效能的方式上，先
制定RC值的範圍為3.6~5.0，且每一次間隔為
0.2。以RC = 3.6的例子來說明，每一個樣本
所有的影像中，找出經由糢糊運算後，RC值
最接3.6的那一張，所有的樣本一共會找出66
張；然後，將這66張影像的增益參數，分別
和放射師針對每一個樣本所設定的增益參數
標準去做比較，看看哪一個RC值時的平均差
異最小。圖一的四條曲線，分別代表了RC = 
3.6、RC = 4.4、RC = 5.0時，各個樣本所使用
的增益參數值，以及放射師所設定的增益參
數。而表格一在中，則詳細地列出了八個不
同RC值，所得到的效能，其中以RC = 4.4時
的效果和放射師設定的最為接近。 
 
(1.2)自動對焦控制的結果 
在自動對焦控制的實驗中，我們採用了
43個樣本。首先對影像做自動增益的控制，
以最佳的結果，做為自動對焦的實驗樣本。
但由於腫瘤有時顏色太深或是和周圍的組織
太過相似，使得在自動對焦後，尋找腫瘤的
效果並不是很好；因此，我們將自動對焦的
過程改成漸近式，也就將增益參數慢慢地向
上增加，且最多可以增加15次，直到能找到
腫瘤為止；圖二中說明了此一流程。利用此
一方式，來自動調整增益參數的設定及自動
對焦，進而找到腫瘤位置的正確性為90.9%，
如表格二。 
 
(1.3)與穿戴式電腦之間的傳輸 
在 Server 端 會 連 接 Terason’s 
SmartProbe，每當一個Frame的資料已經準備
好時，會呼叫到OnFrameReady函式，此時會
將資料Update至Image Buffer中，以供之後
Server傳輸時使用。Server端將會有個Timer
在固定時間內觸發，觸發時將會去檢查Image 
Buffer是否已經被Update，若有，將會將Image 
Buffer的資料透過CSocket使用非同步的方式
傳輸至Client端。而Client端會用CSocket以非
同步的來接收資料，並存入Image Buffer中，
在 接 收 完 整 張 Frame 後 ， 會 呼 叫
OnFrameReady函式，再將此Frame在GUI上面
顯示出來。 
圖三展示了我們所做的自動超音波參
數設定系統和穿戴式電腦間的影像資料傳輸
過程。其中，穿戴式電腦的環境為Linux，參
數設定系統的環境為Windows。 
 
(2)子計畫二 
下列我們將描述子計畫二在第兩年期
間的執行中，所獲得的成果，主要分為下列
幾個部分。 
 
(2.1) Middleware System建置 
在穿戴式電腦端，本計畫基於Linux 
Kernel 2.6.16設計了一個小型的Middleware 
Layer ，包含 Programming APIs ， Channel 
Management，Module Management等三個部
分，從系統感測到穿戴者（醫生）操作下達
的指令（藉由Twiddler2），再根據所接收到
的指令分析，轉換為Middleware內部訊息，
再根據此內部訊息模組化，判斷是否要在本
機處理，或是回傳指令至Server端，然後依照
模組判斷傳達指令給系統應用程式做處理。 
 
(2.2) 無線網路傳輸效能 
基於網路卡設備的限制，我們在網路端
的處理是採用802.11b作AdHoc連接傳輸處
-6- 
 
首先，第一個需要面對的就是Windows 
Socket以及Linux Socket傳輸整合的處理，我
們直接使用socket中最基本的send()與recv()
函式，來簡化程式傳輸的操作，減少loading，
同時避免在winsock與Linux上socket處理的
相容問題。 
 接著為了與子計畫一超音波掃描裝
置處理後的 Frame 檔案做整合，建立了
TransBMP()這個函式，只要將Frame傳入該函
式，即可直接傳送至Client端，避免出整合方
面的問題。而在這個函式中，也有預留一個
命令參數，作為Server端與子計畫一間互相溝
通的機制。 
 
(3)子計畫三 
系統將所有辨識結果判別出來之後，我
們將系統所判別之細胞核辨識結果，與病理
科醫師直接以肉眼觀察影像所得之結果進行
比對，比對結果則如下表格三所示，再依據
表格三之辨識結果計算準確率（Accuracy）、
敏感度（Sensitivity）、與有效性（Specificity）
等參數，對本系統之效能作一評估，如 
表格四。 
接著我們將細胞核之所有特徵參數與
分類結果，進一步以台大資工林智仁教授所
提供之支援向量機程式作分類結果之效能評
估，在SVM[11]實驗方面，本研究以四組隨
機資料分組，每組各有正常細胞核個數樣本
250個及異常細胞核個數樣本950個。將這四
組資料做為訓練資料(Training Data)進行訓
練動作建立模組，再利用四個模組進行交叉
驗證測詴工作，表格五中說明了四種不同交
叉驗證的組合(G1, G2, G3和G4)，而 
表格六到表格九則分別展示了這四種
不同組合的實驗結果。最後將具有最佳辨識
率之結果模組作為本系統之訓練模組，以評
估本系統之效能。 
從實驗結果來看，實驗群組G2的訓練可
以得到最好的辨識結果，因此我們以群組G2
所建立之模組作為本研究所使用之模組，將
所有資料作為測詴資料，導入SVM輸出最後
之分類結果。最後將SVM所產生之輸出結果
與醫師肉眼判讀結果進行分析比對，結果顯
示本系統具有85.96% 之正確率，證實本系統
能有效針對細胞核進行準確之辨識工作，
SVM之執行結果如 
表格十所示，且經過統計之後的效能評
估數據如表格十一所示。我們可於實驗測詴
的結果中發現，敏感度指標會表現出影像品
質的差異，若影像之背景過於複雜、細胞核
過於密集，或細胞核內部之亮度不均皆會導
致敏感度變低，但系統準確性方面仍然有著
89.15%的敏感度。 
在以ROC曲線評估診斷準確率而言，會
如圖八所示，可以發現若將所有特徵參數導
入支援向量機進行分類工作，其效能會比只
使用單一項特徵參數針對細胞核進行分類要
來得好，這項結果說明了若只使用少數特徵
參數對細胞核進行辨識工作，分類之正確率
可能相對下會較低。 
 
三、 計畫成果自評 
在上面的研究成果中，我們實現了當初
在計畫中所規劃的目標： 
子計畫一：了解了PC-based超音波原理及開
發工具、儲存格式、影像品質控
制 方 法 … 等 ； 進 而 改 良 了
PC-based超音波操作軟體，使其
能有自動的增益控制及自動對
焦的功能。同時，我們亦能在這
樣的超音波影像裡，完成了腫瘤
自動偵測的系統。 
子計畫二：研究穿戴式電腦的相關理論，並
建構其基本硬體架構及發展平
台的軟體架構。然後在這些架構
-8- 
 
  
 
圖一、各個樣本的增益參數的分佈圖 
 
       
(a)                       (b)                    (c) 
       
(d)                       (e)                    (f) 
-10- 
 
圖三、影像傳輸的過程 (a) Server端開始傳輸第一張影像 (b)Client端接收到第一張影像，並產
生畫面 (c)傳輸第30張影像 (d)接收第30張影像 (e)傳輸第70張影像 (f)接收第70張影像 (g)傳
輸第100張影像，傳輸完畢 (h)接收第100張影像，接收完成 
 
 
File Type 32 bit File Data 0~1024 bit
File Type： 
‘D’表示傳送資料為檔案內容
‘E’表示出現錯誤，結束程式
‘P’表示傳送成功
‘R’表示要求重新傳輸
‘S’表示傳送資料為檔案大小
‘T’表示改變資料格式
Sub Type：
‘c’紀錄File Data為第幾份檔案區塊
‘n’表示要求上一份檔案
‘r’表示要求上一份File Data
‘+’表示將圖片放大
‘-’表示將圖片縮小
Sub Type 32bit
 
圖四、資料傳輸格式 
 
 
ReadyRead() TypeCheck()
SubType()
Tran() End()
 
圖五、資料格式判斷流程 
 
-12- 
 
 
圖七、實際傳輸Client端顯示影像 
 
Conventional Binormal ROC Curves
0
0.2
0.4
0.6
0.8
1
1.2
0 0.2 0.4 0.6 0.8 1 1.2
FPF
T
P
F
a=1.47 b=0.95 Az=0.8570 SVM
a=1.19 b=0.64 Az=0.8419 Compactness
a=1.01 b=0.67 Az=0.7994 Curvature
a=0.96 b=0.58 Az=0.7959 Area
a=0.71 b=1.08 Az=0.6849 Variance
 
圖八、ROC曲線 
-14- 
 
表格四、以臨界值分類之效能評估結果 
 準確率 敏感度 有效性 
效能 
 
 
81.83% 83.20% 74.61% 
 
表格五、各群組之訓練組與測詴組 
實驗群組 訓練組 測詴組 
G1 1，2，3 4 
G2 1，2，4 3 
G3 1，3，4 2 
G4 2，3，4 1 
 
表格六、群組G1之辨識結果 
 正常細胞核 異常細胞核 
系統判斷為 
正常細胞核 
114 TN 31 FN 
系統判斷為 
異常細胞核 
136 FP 919 TP 
總計 250 950 
 
表格七、群組G2之辨識結果 
 正常細胞核 異常細胞核 
系統判斷為 
正常細胞核 
150 TN 37 FN 
系統判斷為 
異常細胞核 
100 FP 913 TP 
總計 250 950 
 
 
