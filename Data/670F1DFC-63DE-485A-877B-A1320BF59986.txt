 著重在軟體發展工具的開發與支援，其他大型系統如 IBM Cell、Sun Niagara 則是著眼於高速平行化運算。針對嵌入式多核心的系統設計而言，
TI 則有包含 OMAP、DaVinci 等異質多核心的設計，包含了一個或一個以上的微處理器和一個或一個以上的數位訊號處理器。這樣的設計主
要是針對工作性質的分工，利用多核心技術來強化系統之效能、降低成本。在嵌入式系統同質多核心上，ARM 也提出了 MPCore 的架構，利
用多個具備微處理器和數位訊號處理強化指令的同質 ARM 核心，來完成低耗能、高效率之嵌入式系統多核心。本計畫的嵌入式多核心設計，
類似於 ARM 的理念，用多個具備微處理器和數位訊號處理強化指令的同質核心來設計嵌入式多核心系統。反觀國內在多核心處理器的設計
以及研究上目前仍在起步階段。而其中又以協助多核心嵌入式系統晶片發展之系統層發展工具最為缺乏，此部分的技術亦是國內外研究的重
點議題。我們首先簡短說明目前市場上已經在使用的多核心處理器及系統。 
 
I. TI OMAP 
 
OMAP 是由德州儀器（TI）所提出的一種「開放式多媒體應用平台」架構，以支援高速有線和無線通訊應用上。2.5G 和 3G 的無線裝置
上通常都整合了 MP3 音訊和 MPEG4 視訊等多媒體功能，由此可見無線網路家電需要更複雜的行動通訊和和訊號處理能力。而 OMAP（最新
的為 OMAP5912）剛好為 OEM 和 ODM 提供了一套高效率省電的系統架構，包括：一個 ARM RISC 處理器（ARM926EJ-S）、一顆低功率
消耗的高效能 DSP（TMS320C55x)、一個記憶體介面流量控制器、一些專用的多媒體應用週邊設備(MWA)和一個多工介面構成。ARM926 用
於 embedded RISC-based OS 上，而 DSP 用於處理所有多媒體應用。兩個核心放在一個 289 接腳的晶片中，這樣不但節約電路板空間，而且
可以降低功耗和成本，此外 TI 還發展出一套 DSP/BIOS Bridge 架構，讓設計人員把運算工作平均分配給 RISC 和 DSP，使系統發揮最大的運
算效能且不會浪費電力。除此之外還備有各種各樣的週邊設備，使用戶能夠與 USB、UART、Bluetooth 以及 GSM 模組等通用元件介面溝通。 
目前每個核心的最高執行速度都可達到 192MHz，並且都可以隨作業頻率的降低而作出相應改動以節約功耗。ARM 既支援 32 位元也支
援 16 位元(Thumb 模式)指令集。C55x DSP 內有 5 組數據匯流排，在一個周期內允許三次讀取作業和兩次寫入作業。C55x 最獨特的一點就是
它具備雙 MAC 結構，並且其內部具有一個硬體圖形加速器。流量控制器(TC)用於控制對外部記憶體的存取，可以看作儲存資源的守衛用來
決定哪個核心可以存取資源，共提供二個介面：EMIFF、EMIFS。OMAP 內還有 250K 的內部記憶體，由 ARM 和 DSP 共享。但只有 ARM
才能配置 DSP 中的 MMU，因而決定 DSP 應以怎樣的方式存取這些資源。從軟體開發的角度來看，DSP / BIOS Bridge 提供了一個易用的 DSP
介面給軟體人員，透過 API 來使用與控制 DSP 的執行環境，使得開發環境與單核心的開發環境並無不同。 
 
II. IBM Cell 
Cell 是一種微處理器的結構，是由 Sony、Toshiba、IBM 三家公司所共同制定的，Cell 的全名為 Cell Broadband Engine Architecture，可
以簡稱為 Cell BE。Cell 處理器是用於高速運算的處理器，以 RISC 指令系統的 PowerPC 架構來設計的，具有高時脈頻率、高執行效率的特點，
目前主要用在 PlayStation3 和 Blade Server 上面。 
 
 Management Unit），並能夠支援 32/16 位元的指令集架構。其架構主要有 AMBA(Advanced Micro-controller Bus Architecture) 匯流排系統，包
括：AHB（Advanced High-Performance Bus）匯流排，用來連接高速度或需要高頻寬的裝置，如直接記憶體存取控制器（DMA controller）等，
以及 APB（Advanced Peripheral Bus）匯流排，用來連接低功率消耗或低頻寬的裝置，如 Timer、UART 等；專用的 DMA 和 LCD 本地端記憶
體匯流排（local memory bus）等。匯流排可以支援許多常用的介面，包括：SDRAM（400M bytes/sec）、非同步的 SRAM/ROM/Flash、USB2.0
裝置、Ethernet MAC 10/100 等等。其運轉頻率， AHB bus 可以達到 133MHz，而 APB bus 可以達到 50Hz。目前處理器開發的進度為完成軟
體仿真器 (emulator)，可以在其上執行程式，至於 FPGA-based 的處理器也即將完成。 
 
V. Sunplus（凌陽科技） 
S
+
core
™是凌陽開發國內第一顆自主架構之 32 位元內嵌式處理器。這是凌陽科技自行開發的 32 位元精簡指令集處理器。其指令集架構擁有
32/16 位元混合指令模式及平行條件執行的設計。藉由時脈頻率的改良，該處理器可以提供七階的管線（pipeline）架構。處理器提供 low-overhead 
exception handling、configurable cache and local memory、on-chip bus interface for AMBA 2.0 compliant (AHB 2.0 master)，此外可以增加三個協
同處理器（coprocessor）來支援應用所需要的運算。處理器相關的開發環境也相當完整，含 Optimized GNU C/C++ Compiler (STL included)、
GNU Binutils (Assembler, Linker, etc.)、Instruction Set Simulator (ISS)、S+core IDE、GDB 等，並支援 uC/OC-II、eCos、及 Linux kernal。該處
理器已正式商品化於凌陽的遊戲與個人娛樂平台解決方案 SPG290 多媒體單晶片中，用來設計開發電視或掌上型的遊戲。 
  
目前已有若干開發平台強調使用 softcore-based 或 multicore FPGA 來開發系統。以下就簡短的說明這方面的計畫。 
 
VI. RAMP (Research Accelerator for Multiprocessors) 
RAMP 計畫是由美國柏克萊大學、MIT 及多所頂尖大學所主導，目的是在 FPGA 的平台上發展支援高速模擬大型、大量平行多處理器系
統，加速軟、硬體在多處理器研究的創新。計畫的提出是有鑒於 FPGA 可以有效提升硬體系統設計的靈活性、可靠性，以及提高硬體開發速
度。現在已可將 16 個簡單的處理器放在單一 FPGA 上。這也就是說，我們可以以 64 個 FPGA 建造出 1000 個核心的系統，比傳統定製的多
處理器較為便宜且有較低能源損耗。該計畫主要發展 decouple 的機器模型與設計規範，並且以 RDF (RAMP Design Framework)及編譯器，來
自動化分散式溝通元件的週期精確模擬(cycle-accurate emulation)。為了在多樣化的實作平台上實現上述目的，RDF提供 cycle-accurate emulation
與 rapid functional-only emulation 這兩類模擬。RAMP 著重於能將目標的設計 (target designs)自由的移植到不同的主機實作上 (host 
implementation)。因此，它是由鬆散耦合單元(loosely coupled unit)所構成，由數種技術所實作，以及利用定義明確的通道(channel)配合 latency 
insensitive 協定來溝通。(RDF 稱呼被模擬的系統為 target，而運行該模擬的機器，也就是底層的 FPGA，稱為主機 host)。 
 
 
Board: 5 Virtex II FPGAs, 18 banks DDR2-400 
memory, 20 10G/s Ethernet connections 
Box: 10 compute modules in 8U rack mount 
chassis 
 (MPPA)，收集底層系統中的硬體事件及資訊，以幫助程式設計人員分析其程式的效能。(2) 延續 MPPA 的效能量測架構到量測耗能，並發展
一套從軟體至硬體的耗能量測系統。 
1. 多處理器系統單晶片效能量測系統 (MPPA) 
 如圖 1 所示，我們所提出的多處理器系統單晶片效能量測系統，主要的特色為支援多處理器系統，能同時監控所有的處理器以
及其他系統元件。除了資訊偵測電路(information detector)用來收集訊號的電路外，其餘的部份如傳輸效能量測資料網路(profiling data 
transmission network)和資料收集模組(data collecting module)都是屬於獨立的模組，所以可以很容易的拆除或置換。系統運作的流程如
下，資訊偵測電路從元件裡偵測或是經由一些運算得出硬體事件的發生，並將該資訊透過傳輸效能量測資料網路送至資料收集模組。
由於完整的系統資訊是很複雜繁多而且隨時都可能產生，所以傳輸效能量測資料網路通常是個匯流排。在資料收集模組內則通常含有
數個計數器，可針對傳送過來的資料作累加。 
這個輕量級的架構有別於一般的設計需要額外新增硬體指令或特殊硬體溝通介面，MPPA 並不需要大幅修改原始架構，達到精簡
的目的。我們實作這個量測架構，整合 LEON3 開放原始碼嵌入式系統平台，並於 Xilinx ML501 FPGA 實驗板驗證這個多處理器嵌入
式系統。實驗結果顯示我們提出的量測架構確實能取得系統底層硬體事件，幫助程式設計人員更容易地分析了解應用程式行為，並且
在符合精簡、有彈性與小幅修改的需求條件下，提供更多的資訊來找出系統效能瓶頸。 
 
 
▲圖 1 多處理器系統單晶片效能量測系統 
2. 多處理器系統單晶片耗能量測系統 
由於耗能的評估在嵌入系統開發階段非常地重要，因此我們延續 MPPA 的多處理器系統單晶片效能量測架構，實作了一套從軟
體至硬體的耗能量測系統。在硬體部分，我們將 MPPA 延伸且收集更多方面的硬體事件，如處理器、記憶體和匯流排相關的硬體事
件。目的是為了在設計階段時，能提供設計者監測耗能。在軟體部分，我們實作 PAPI 這套定義存取硬體效能計數器標準的 API，如
此一來，應用程式的開發者可以簡單使用此平台而不必熟悉底層的設定。  
有了這一整套的耗能量測系統，開發者可簡單地得到硬體事件的資料，再搭配對應的功耗模型，可算出應用程式在嵌入式系統上
執行的耗能(如圖 2 所示)。更甚者，應用程式開發者還可以使用 PAPI 來針對不同的應用程式開發效能偵測工具。這套系統不但對於
應用程式開發者而言非常簡易使用，並且能夠提供多種元件的耗能資訊(如處理器、記憶體和匯流排)。若日後想要觀測其他元件的耗
能，亦可很容易地新增至耗能量測系統裡。 
  
 競爭快取的資源，但若將執行緒做分組的動作，使得同一組別的執行緒是針對相同的資料區塊，可藉由降低競爭情形來
達到降低快取失誤的目的。 
研究著重於在多核心平台上因應不同的多執行緒架構提出適合的執行模型作為有效降低快取失誤發生的優化方法，然而不單單是
透過提出多執行緒的執行模型來達到優化，更根據執行模型上實體硬體的快取資源分配多寡，對運算執行時的目標資料進行良好的分
配，所以執行模型與實際快取資源多寡相互牽扯。結合兩者提出資料區塊化搭配執行緒分組這個優化技術來降低快取失誤發生的情形。 
 
       圖 4.1 優化前                 圖 4.2 優化後 
                         (資料區塊加執行緒分組) 
 
子計畫三-多核心嵌入式系統效能與耗能分析監測與改善 
1. REALprof 
REALprof 是一個建構在 FPGA 擬真環境上的多核心嵌入式系統晶片之效能與耗能分析與監測硬體擴充模組以及工具(見圖 5)。
如圖 6 所示，REALprof Controller 透過監測系統上匯流排、暫存器內容，以及重要事件發生時所產生的訊號改變，累計其事件發生
的次數到對應的計數器內，如此可以精準且低負擔的提供系統開發人員了解細部系統耗電的數據，以便進行進一步的分析與偵錯。
系統人員可以透過這樣的工具，在系統開發設計的初期，就能夠充分掌握並了解多核心嵌入式系統晶片硬體與軟體的效能與耗能特
性，進而在軟、硬體設計層面加以改進。本計畫所提之方法已在一具有 100 MHz 的四核心仿真 FPGA 環境下完成，精度可達微秒以
下。 
  
▲圖 5. REALprof Emulation Platform ▲圖 6. REALprof 系統架構圖 
  
2. Software Energy Profiling tool, SEProf 
SEProf 是一個建構在開放式作業系統環境上的多核心嵌入式系統處理器晶片之耗能分析與監測軟體擴充模組以及工具。因應現
今處理器多具備可動態調整電壓與執行頻率的需要，基於高階模型為基礎的處理器耗能分析工具必須具備能夠即時記錄下程序執行過
程中，所處環境之電壓與頻率的過程。因此，本計畫提出一個 model-based 高階處理器耗能評估工具，如圖 7 所示，首先，使用者必
須先透過 measurement-based 的方式或是透過 lower level modeling-based 的方式，得到處理器在不同電壓與頻率組合下的耗電值，
透過 SEProf kernel patch 所提供的 system calls 即可將對應耗電值進行註冊的動作，讓 SEprof 能夠使用 power library 儲存的值來評
 研究的初步成果已於 2010 年 I3D 國際會議中以海報發表。 
 
3. 加速高品質全域照明計算之創新技術 
全域照明計算中，計算間接照明(indirect lighting)目前最常用的技術為 instant radiosity。本計劃中所研發提出的創新技術之ㄧ，
在於解決 instant radiosity 中因使用大量虛擬點光源(virtual point lights)所造成的計算效能問題。我們結合繪圖硬體設計中的 interleaved 
sampling 方法和虛擬點光源(virtual point lights)，成為 interleaved shading，以降低 instant radiosity 中所需的計算量，再透過 stratified 
sampling 適當的將虛擬點光源分類，進一步控制使用部分虛擬點光源時可能形成的雜訊。這項成果已於 2010 年 10 月發表於 Computer 
Graphics Forum 期刊中。 
 
  
▲圖 10: 行動裝置上之環境光源照明及柔和陰影效果 ▲圖 11: 高品質全域照明計算之加速 
 
98 年度專題研究計畫研究成果彙整表 
計畫主持人：金仲達 計畫編號：98-2220-E-007-018- 
計畫名稱：系統層級之多核心嵌入式系統發展與驗證環境--總計畫(2/2) 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 4 4 100%  
博士生 4 4 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 5 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 13 0 100% 
篇 其中一篇研討會
論文是發表於領
域頂尖研討會 DAC
之上。 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
