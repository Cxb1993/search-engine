 圖 01: 以連體力學二相流數值方法計算所
得之船舶水面波形圖[1] 
二、研究目的 
如同先前所述，現有的連體力學數值方
法，在處理自由液面問題上遭遇了瓶頸，難
以準確地模擬碎波、浪花、水滴等複雜的物
理現象。本計畫的目的，就是要發展一種截
然不同的數值方法，該方法是以「粒子力學」
為基礎，並且將它用於解析自由液面的相關
問題，以彌補現有連體力學數值方法在碎波
解析上的缺點。相對於以連體力學為基礎的
數值方法，以「粒子力學」為基礎的數值方
法以全新的觀點處理流體問題，以一定數量
的粒子代表整個計算域中的流體，在此類的
數值方法中，並不會遭遇嚴重的數值消散問
題。對於這種數值方法，Birknes [2]認為其
優點為： 
1. 是一種穩健的數值方法 
2. 適合用於處理碎波相關的問題 
3. 易於平行化 
基於以上的原因，粒子力學方法能夠處理某
些傳統連體力學方法所難以處理的問題，因
此，對於船舶工業而言，粒子力學方法是一
種必須重視，而且值得發展的數值方法。 
 
三、文獻探討 
本計劃首先搜尋了造船領域之外的水
面波數值模擬方法，以尋找一種適合處理碎
波問題的全新數值方法。在圖 02 之中，
Irvang G.等人[3]利用 MAC（marker-and-cell）
方法，計算高速艇的非穩態波，從圖中的結
果可以看出明顯的碎波現象。該論文在網格
的處理上與一般作法有所不同，如圖 03 所
示，只在水面與物體表面處，採用較小的方
形網格；其他地方則採用ㄧ個很大的長方形
網格，直達計算域的最上方或最下方。這種
作法是將所有網格集中在水面附近，以求可
以解析出最好的水面波形，至於其他地區的
流場特性，則將其忽略。由於網格都集中在
水面附近，因此在該計算例中，水面的水平
網格高達 1500*300，足以計算出船艉跡流
區域的小渦漩（eddy）。至於圖 04 的水箱中
水潑濺（sloshing）行為模擬，則是 Next Limit 
Technologies [4]利用「粒子法」（particle 
method）所計算而得，從圖中與實驗的比對
照片中可以發現，以該方法計算所得的碎波
行為，與實驗結果相符。除了可以用於模擬
水潑濺行為之外，粒子法還可以用於各種複
雜的水面問題計算，例如：船舶於波浪中的
運動、船艙進水模擬等等。圖 05 就是好萊
塢電影「海神號」（Poseidon）中，利用粒子
法模擬海水淹進郵輪客艙的畫面。除了這部
電影之外，「達文西密碼」（The Da Vinci 
Code）與「冰原歷險記」（Ice Age）、「駭客
任務」（Matrix）、「魔戒」（Lord of the 
Rings）、「X 戰警」（X-Man）系列電影等等，
都有採用粒子法來產生逼真的流體特效畫
面。 
Navier-Stokes 方程式： 
0=∂
∂
t
ρ  　                (1) 
fP
Dt
Du +∇−= ρ
1            (2) 
(1)式為質量守恆方程式，(2)式為動量守恆
方程式，左手邊項代表含對流項的 Lagrange
微分，可透過追蹤粒子運動直接計算，右手
邊項由壓力梯度和外力項組成，在 MPS 法
中所有微分項都離散表示為粒子間的相互
作用。 
2. 核函數 
連續流體假設由分散的粒子組成，每個
粒子都有各自的位置、速度、質量、壓力等
物理量，且在一定範圍內對附近的粒子產生
影響，而粒子間的影響則透過核函數 ω(r)
實現，核函數的數值代表著某一粒子對周圍
粒子影響的程度。核函數 ω(r)定義如下： 
⎪⎩
⎪⎨
⎧
≤
<≤−=
)(0
)0(1)(
e
e
e
rr
rr
r
r
rω        (3) 
(3)式中: r 是粒子 i 和 j 之間的距離 r=|rj-ri|，
re為粒子作用半徑，由(3)式可看出當兩粒子
間的距離 r ≥re 時的粒子相互作用可以忽
略，即粒子僅與位於其粒子作用半徑 re範圍
內有限數目的鄰點粒子發生相互作用。粒子
越接近數值越大，粒子間的影響就越大，當
r→0 時 ω(r→0) →∞，表示粒子間作用無窮
大，該假設可避免兩個粒子間的重合[7]。 
3. 粒子數密度 
某粒子 i 所在點 ri處的粒子數密度 ni定
義為: 
( )∑
≠
−=
ij
iji rrn ω             (4) 
(4)式可解釋為某點受到周圍所有粒子影響
的和，也反映出該點周圍粒子的密集程度。
當粒子間相對位置發生變化時，粒子數密度
會做相應的改變。空間某點處單位體積內粒
子個數可由(5)式算出: 
∫=
V
i
i dvr
nN
)(ω               (5) 
(5)式分母表示單個粒子的核函數在影響範
圍 v 內積分。 
∫==
V
i
ii dvr
mnmN
)(ωρ           (6) 
(6)式中 m 為單一個粒子質量，流體密度等
於單位體積中的粒子數與粒子質量的乘
積。假設各個粒子的質量相等，則由(5)、(6)
式可以證明流體密度與粒子數密度成正
比。對於不可壓縮流體，流體密度保持常數
相當於其粒子數密度維持一個常數，即： 
( )∑
≠
−=
ji
ij rrn
000 ω             (7) 
4. 梯度模型 
兩相鄰粒子 i、j 之間的梯度向量可以表
示為 ( )ij
ij
ij rr
rr
−
−
−
2
φφ ，則 i 粒子的梯度向量就
可以透過與其他粒子的梯度向量加權平均
得到，即： 
( ) ( )ijij
ij
ij
ji
i rrrr
rrn
d −−
−
−∑=∇
≠
ωφφφ 20     (8) 
在(8)式中 d 為空間維度。梯度模型主要是用
在計算控制方程式中的壓力梯度，考慮到驅
使流體流動的是壓力梯度，而不是壓力絕對
值，所以上述的梯度模型可由(9)式取代: 
( ) ( )ijij
ij
ij
ji
i rrrr
rrn
d −−
−
−∑=∇
≠
ωφφφ 2
'
0
    (9) 
在(9)式中 
)min(' ji φφ =               (10) 
5. Laplace 運算元模型 
六、MPS 之計算實例 
在計算實例上，本計劃原先預定計算二
維圓柱的入水問題，但是受限於計畫執行期
限，無法完成圓柱的計算例，僅完成二維水
柱崩塌問題的計算。水柱崩塌的計算是自由
液面流動的基本案例，粒子初始位置如圖
06 所示，圖中的藍色粒子是流體粒子，綠
色與黑色則是固體邊界的粒子。在初始條件
中，所有粒子均靜止於容器的左端，然後水
柱受重力影響下開始倒塌，左側的邊界同時
向右移動。計算中使用到的參數為：初始粒
子間距 lo = 0.008 m，流體密度 ρ = 1000 
kg/m3，重力加速度 g = 9.8 m/s2，根據
Koshizuka 的研究，粒子數密度和梯度計算
中粒子作用半徑取 re = 2.1*lo，而在 Laplace
模型中取 re = 4.0*lo，β 為 0.97，時間增量
∆t 由數值穩定條件決定，根據 Courant 公式： 
⎟⎠
⎞⎜⎝
⎛ ×=Δ −3
max
0 100.1,min v
lt α    (22) 
在(22)式中 α為一係數可取 0.1，vmax為粒子
最大瞬間速度。圖 07 至圖 10 中為水柱開始
倒塌從 t = 0 秒到 t = 0.2 秒的模擬結果，從
圖中可以看到流體粒子受到左側牆壁的推
擠而向右移動，碰到右側牆壁後濺起，與真
實狀況相符。 
 
圖 06: MPS 之水柱崩塌計算，t = 0.0 秒 
 
圖 07: MPS 之水柱崩塌計算，t = 0.05 秒 
 
圖 08: MPS 之水柱崩塌計算，t = 0.10 秒 
 
圖 09: MPS 之水柱崩塌計算，t = 0.15 秒 
 
圖 10: MPS 之水柱崩塌計算，t = 0.20 秒 
 
 
格如圖 16 所示。連體力學方法之計算結果
如圖 17 至圖 21 所示，圖中的綠色代表空
氣，至於紅色則代表水。與粒子法的計算結
果相比，連體力學方法的計算結果中，水面
在接觸到圓柱之前，就因為到達計算網格有
所改變之處，而產生了些許的水面波高變化
（圖 18 與圖 19）。由於高階的數值方法雖
然較為準確，但是卻容易產生震盪的現象，
這種現象最容易產生在壓力之上，而水面波
形又是一種與壓力息息相關的特性，因此，
會對於水面波形有明顯的影響。至於圓柱入
水之後所產生的兩道水柱，由於在本方法中
的黏性效應較高，以致於水柱會緊貼於圓柱
之上。由於本計劃所採用的計算網格與粒子
數量較少，因此無法良好地模擬出兩道水柱
的細部流場。 
 
圖 15: 連體力學計算例之計算域與邊界 
 
圖 16: 連體力學計算例之網格圖 
 
圖 17: 連體力學之計算結果 
 
圖 18: 連體力學之計算結果 
 
圖 19: 連體力學之計算結果 
 
圖 20: 連體力學之計算結果 
