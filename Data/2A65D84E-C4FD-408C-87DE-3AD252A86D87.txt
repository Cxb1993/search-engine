1 
 
行政院國家科學委員會補助專題研究計畫 ■ 成 果 報 告   
□期中進度報告 
 
人工免疫演算法應用於超音波乳房腫瘤影像診斷之研究 
 
計畫類別：■ 個別型計畫  □ 整合型計畫 
計畫編號：NSC－99－2221－E－182－041 
執行期間： 99年 8月 1日至 100年 7月 31日 
 
計畫主持人：吳文傑 
共同主持人：林詩偉 
計畫參與人員：王克勤、劉治元、李政諺 
 
成果報告類型(依經費核定清單規定繳交)：■精簡報告  □完整報告 
 
本成果報告包括以下應繳交之附件： 
□赴國外出差或研習心得報告一份 
□赴大陸地區出差或研習心得報告一份 
□出席國際學術會議心得報告及發表之論文各一份 
□國際合作研究計畫國外研究報告書一份 
 
 
處理方式：除產學合作研究計畫、提升產業技術及人才培育研究計畫、
列管計畫及下列情形者外，得立即公開查詢 
          □涉及專利或其他智慧財產權，□一年□二年後可公開查詢 
          
執行單位：長庚大學資訊管理學系 
 
中   華   民   國 一百 年 十 月 二十九 日 
3 
 
Keyword ： Computer-aided diagnosis, 
Ultrasound image, Texture feature, Shape 
feature, SVM, AIS algorithm 
二、 報告內容 
1. 前言與目的 
由於現代人飲食型態的改變，營養不均
衡及攝取過多高油脂、多添加物的飲食，加
上運動量減少及精神壓力增加，導致國人罹
癌的機率逐漸攀升。乳癌屬於較容易在早期
發現徵兆的癌症，若能及早診斷與治療，不
但有機會保留完整的乳房，存活率也大為提
高。常見的乳癌影像檢測方法有乳房 X 光
攝影、乳房超音波攝影及核磁共振攝影等。
其中乳房超音波攝影具有操作便利，無放射
性，非侵入性及價格相對較低廉等優勢，因
此廣為醫療單位所採用。 
目前用於判斷乳癌腫瘤良惡性的特徵
值以形狀[1]、斑點[2]及紋理[3]資訊為主。
然而斑點資訊往往容易受到超音波掃描儀
的影響，不同的掃描儀所取得的腫瘤影像其
斑點資訊不一定相同，也導致其辨識的正確
率有所差異，因此本研究採用較不易受超音
波影像影響的形狀及紋理特徵作為腫瘤辨
識的主要依據。 
在超音波腫瘤影像中，良性腫瘤和惡性
腫瘤在形狀上往往會有很大的差異[4]。良性
腫瘤的輪廓多半較為平滑且規則，惡性腫瘤
的輪廓則通常較破碎且呈不規則狀，因此可
藉由形狀特徵來辨識腫瘤的良惡性。 
由於超音波腫瘤影像中常會含有與腫
瘤無關的雜訊以及背景[5]，所以在進行腫瘤
辨識之前，得先透過影像處理的方法將影像
中的雜訊消除，並切割出腫瘤本體的影像。
然而單靠傳統的影像切割方法，在超音波腫
瘤影像的分割上難以達到理想的切割效
果，因此有學者提出等位函數法(Level set) 
[6]來解決影像切割的難題，此方法也廣為被
許多涉及超音波腫瘤影像切割的研究所使
用。本研究亦採用此技術切割腫瘤影像，然
後再計算出其六種形狀特徵，並配合腫瘤的
紋理特徵來辨識腫瘤的良惡性。 
最後，本研究選擇使用支援向量機
(Support vector machine, SVM)[7]作為腫瘤
辨識的工具。而為了加強其辨識正確率，我
們利用人工免疫演算法(Artificial immune 
system algorithm, AIS)[8]結合 SVM進行腫
瘤辨識，希望能透過免疫系統中抗體與抗原
親和力提升的過程，提升支援向量機的辨識
正確率。 
2. 研究方法 
(一)腫瘤影像切割 
原始的超音波影像存在許多雜訊以及
斑點，對於影像的切割及後續特徵值的擷取
與計算都會有很大的影響。因此在切割出腫
瘤影像之前，我們會先以非等方性延展濾波
法過濾每張超音波影像上的雜訊和斑點，接
著再利用 Stick 偵測法提高腫瘤輪廓與背景
的對比度，藉以增強腫瘤的邊界資訊，最後
再利用等位函數法切割出腫瘤影像，並計算
其特徵值。腫瘤影像切割結果如圖一所示。 
(二)腫瘤特徵的擷取與計算 
形狀以及紋理特徵，是用來判斷超音波
乳房影像中腫瘤良惡性的重要依據。本研究
分別從超音波腫瘤影像中計算出紋理特徵
Normalized auto-correlation coefficients [3]和
六種形狀特徵[1]，然後形成一個三十維的影
像特徵向量，所有特徵向量的組成 [ ]f i 定義
如下：  
 
[ ][ ] *5
_
[ ] _
j k i j k
Form Factor
Roundess
f i Aspect Ratio
Convexity
Solidity
Extent
γ = +




= 





 
if
if
if
if
if
if
if
 
1 24
25
26
27
28
29
30
i
i
i
i
i
i
i
≤ ≤
=
=
=
=
=
=
 
其中，0 , 4j k≤ ≤ （不包括 0j k= = ）。 
5 
 
本研究將 210 筆受測的超音波乳房腫
瘤影像樣本以隨機的方式分成五組，並輪流
選擇其中一組樣本進行測試，其餘四組則用
來作為支援向量機的訓練樣本。 
系統參數部份：人工免疫演算法預設的
初始抗體數目為 5組。一般抗體的複製率為
10 倍，具有最佳親和力的抗體則會複製 30
倍。在二進位抗體中每 8個位元決定一個實
驗參數。整個人工免疫演算法運算的循環次
數為 500次。支援向量機的參數C及γ 之範
圍分別為 1到 1000及 0.001到 0.999。欲挑
選的特徵共 30個，特徵篩選的比例為 20%。 
在實驗過程中，我們發現使用人工免疫
演算法結合支援向量機對於腫瘤的分類正
確率(Accuracy)可達到 95.24%，其中雖然有
部份實驗結果能達到 95.71%的正確率，但
是在預設的循環次數（500次）內達成的頻
率不高。 
特徵篩選的部份，在正確率達到95.24%
以上的情況下，所篩選出的特徵多為 5至 7
個，顯示本實驗所設計之方法能達到以少量
的特徵值便可達到高分類正確率之目的(如
表一所示)。 
執行次數的部份，由表一亦可以觀察
到，利用本實驗之程式所需要的執行次數皆
遠低於原始方法的執行次數。這是由於原始
的支援向量機僅靠參數C與參數γ 的排列
組合以網格搜尋法(Grid search)來決定，最
多可能需要執行 999000 次（C的範圍介於
1到 1000，每次增加 1；γ 的範圍介於 0.001
到 0.999，每次增加 0.001），再加上使用三
十組特徵所需的計算量非常可觀，所以使得
執行次數又更加龐大。 
分類結果的部份，當使用人工免疫演算
法結合支援向量機對腫瘤進行分類，在正確
率達到 95.24%的情況下，惡性腫瘤的敏感
性指標 (Sensitivity)為 97.78%，預測指標
(Positive predictive value, PPV)為 91.67%；良
性 腫 瘤 的 敏 感 性 指 標 (Specificity) 為
93.33%，預測指標(Negative predictive value, 
NPV)為 98.25% (詳細實驗分類結果列於表
二)。最後，為了證明本研究所採用的方法
能有效提升分類正確率，我們也比較利用主
成份分析方法篩選的特徵和未經過特徵篩
選的效能指標(如表三)，並描繪實驗結果之
接 收 者 操 作 特 徵 (Receiver operating 
characteristic, ROC)曲線於圖四。 
三、 參考文獻 
[1] R.F. Chang, W.J. Wu, W.K. Moon, and 
D.R. Chen, "Automatic ultrasound 
segmentation and morphology based 
diagnosis of solid breast tumors," Breast 
Cancer Res. Treat., vol. 89, no. 2, pp. 
179-185, Jan. 2005. 
[2] Chang, R. F., Wu, W. J., Moon, W. K. 
and Chen, D. R., “Improvement in breast 
tumor discrimination by support vector 
machines and speckle-emphasis texture 
analysis,” Ultrasound Med Biol, vol. 
29(5), pp. 679-686, May 2003. 
[3] Chen, D. R., Chang, R. F. and Huang, Y. 
L., “Computer-aided diagnosis applied to 
US of solid breast nodules by using 
neural networks,” Radiology, vol. 213(2), 
pp. 407-412, November 1999. 
[4] 鄭慶明，《實用影像診斷學》，初版，
臺北市，俊傑，民國九十年。 
[5] Czerwinski, R. N., Jones, D. L. and 
O'Brien, W. D., Jr., “Edge detection in 
ultrasound speckle noise,” Image 
Processing, 1994. Proceedings. ICIP-94., 
IEEE International Conference, vol. 3, 
pp. 304-308, November 1994. 
[6] Osher, S. and Sethian, J. A., “Fronts 
propagating with curvature-dependent 
speed: Algorithms based on 
Hamilton-Jacobi formulations,” Journal 
7 
 
 
 
 
 
 
 
 
Conventional Binormal ROC Curves
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
FPF
TP
F
  Az=0.9657 Proposed method
  Az=0.9519 PCA
  Az=0.9509 All features
 
FPF: False Positive Fraction 
TPF: True Positive Fraction 
圖四、實驗結果之 ROC Curve 
乳房超音波腫瘤影像切割 
以 SVM結合 AIS進行訓練及分類 
 
實驗結果的統計與分析 
結論 
擷取並計算腫瘤紋理與形狀特徵 
圖三、研究方法流程圖 
國科會補助計畫衍生研發成果推廣資料表
日期:2011/10/31
國科會補助計畫
計畫名稱: 人工免疫演算法應用於超音波乳房腫瘤影像診斷之研究
計畫主持人: 吳文傑
計畫編號: 99-2221-E-182-041- 學門領域: 醫學資訊
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
無 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
