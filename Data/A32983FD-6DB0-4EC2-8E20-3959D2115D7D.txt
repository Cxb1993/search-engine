-1- 
 
 
中文摘要 
 
 
淹水範圍推估為水利單位必須去評估的作業，有些障礙物如高速公路有路堤效應會阻
礙水流通過，因此洪氾區不再是依照地表高程固定不變，而可能會因為道路設施而有一些
差異存在，如果可以借重模擬方式找出真正的洪氾區，在做一些配套的管制措施，對於防
災應該有所幫助。本研究計畫希望視窗化計畫主持人修改過的二維綜合淹水模式，使多功
能的模式能有友善的操作介面，進一步推廣使用，建立水利從業人員也可以方便學習的教
學網，提供一個關於淹水方面可以災前規劃、災中處置、災後檢討的必備工具。 
本計畫規劃三年時間來完成上述需求並建置網站及學習平台，將提供使用者更為便利
的水利軟體工具及諮詢管道。模式視窗化除了輸出入資料介面開發及功能規劃建置，以及
使用地理資訊系統開發圖形介面以分析及展示二維的淹水變化圖外，尚包括 3D 虛擬實境
分析及展示空間的淹水變化圖及數位學習網站。本年度已完成的工作項目包括(1).使用 VB
完成視窗功能介面設定、淹水觀測點輸出資料轉入資料庫及繪圖功能。(2).使用 Quest 3D
規劃設計 Demo 範例，主角在淹水位變動的場景游走，可以看到自己被水淹的情形，也可
透過水尺的刻度了解淹水情形，互動操作功能有如玩遊戲。(3).使用 RoboHelp 製作操作手
冊的軟體說明文件，可以將圖資也整合放到文件裡面展示。 
 
關鍵詞：淹水模式，視窗介面，3D 虛擬實境 
 
 
-3- 
一、前言 
淹水範圍推估為水利單位必須去評估的作業，河川治理計畫大多使用洪水位高程，以
計畫洪水水面高程往河川堤防外延伸到地表高程接近洪水位的地方，畫出一塊區域為洪氾
區，也有快速的方法使用 GIS 套配 DTM 高程，就可把洪氾區畫出來，然而一些數據顯示，
當洪水溢堤後往低窪地區竄流，有些障礙物如高速公路有路堤效應會阻礙水流通過，因此
洪氾區不再是依照地表高程固定不變，而可能會因為道路設施而有一些差異存在，如果可
以借重模擬方式找出真正的洪氾區，在做一些配套的管制措施，對於防災應該有所幫助，
本研究計畫希望視窗化計畫主持人修改過的二維綜合淹水模式，使多功能的模式能有友善
的操作介面，進一步推廣使用，建立水利從業人員也可以方便學習的教學網，提供一個關
於淹水方面可以災前規劃、災中處置、災後檢討的必備工具。 
「二維綜合淹水模式」(簡稱為 2DIIM)，已在民國 88 年土木水利電子計算機應用研討
會發表過，該模式已結合了台灣大學許銘熙教授團隊及成功大學蔡長泰教授團隊各自發展
的兩個淹水模式系統的優點，並提供 ARCVIEW 的網格轉換格式，可以將輸入資料及模擬
結果轉成 GIS 網格資料提供必要的套圖，除了可以輸出某些觀測點的淹水歷程外，也可展
現某些控制條件下平面二維淹水深及淹水時間的差異性。 
二、研究目的 
因 NETSTARS 視窗化開發已告一段落，藉這幾年執行計畫的經驗，繼續研提計畫主持
人修改過的二維綜合淹水模式的視窗化三年計畫，目的在強化使用者操作展示介面及 VR
應用，有利此工具的推廣，雖然同類模式 SOBEK 很強，但是要使用其一部分功能通常所
費不貲，即使要推廣應用可能也受限於經費無法支應，因 NETSTARS 從免費推廣出發，所
以目前使用者眾多，許多研究計畫都採用這套模式來執行，所以考量水利從業人員使用的
意願及推廣性，仍採用與 NETSTARS 模式視窗化相同的做法，計畫完分三階段完成後免費
提供使用。 
三、文獻探討 
十幾年前電子計算機運算速度及儲存空間已能負荷大量的計算以後，淹水數值模擬才
開始有人進行研究，十年前工作站如 VAX 被大量使用來做數學運算，繪圖工具也被發展用
來展示成果，直到 PC AT 時代，大型主機才慢慢被其取代，而繪圖工具也轉為 PC 版本。
國內對淹水模擬研究較多的首推成功大學水利系蔡長泰教授及台灣大學農工系許銘熙教
授，蔡長泰教授發展了一個擬似二維淹水模式，主要以地形、水系、道路等來劃分網格，
其網格可為非常不規則形狀，由網格間邊界去計算流通量，在網格內用質量守恆概念保持
水量不會無故消失；許銘熙教授發展了一套二維漫地流淹水模式，求解正方形網格內的水
流動態，利用二維水流的簡化方程式，以有限差分交替方向顯示法(ADE)求解之。然而許
多研究已發現在處理二維的地形資料及網格編碼實在是一件煩人的事，也因十年前 GIS 剛
引進國內不久，台大生工系許銘熙教授先利用 ARCVIEW 處理 DTM 資料及規劃網格，後
來在八掌溪流域的國科會研究計畫也利用成果與相關圖層套疊產生精美的結果圖。近期又
利用二維漫地流淹水模式進行全國淹水潛勢區的模擬，並利用成果與相關單位進行常淹水
區域確認，可提供做為配置防洪措施的參考依據。蔡長泰教授曾用 INTERGRAPH 進行淹
水模式的資料處理與成果展示環境，模式可掛於其中並執行及產出成果。 
計畫主持人曾在民國 77 年至 79 年期間在台大許銘熙教授指導下修改二維漫地流淹水
模式，並應用於琳恩颱風基隆河沿岸的淹水模擬與檢討。二維綜合淹水模式的基礎為國立
台灣大學許銘熙教授發展的二維漫地流淹水模式，計畫主持人曾在民國 87-88 年間執行交
-5- 
Visual BasicV6.0 中文版是 Microsoft 的程式開發工具，現在已有.NET 版本，本研究仍
使用 VB 6.0 的原因是程式的開發免於重覆，使用 NETSTARS 視窗化的版本加以修改，可
以節省許多時間。 
開啟二維綜合淹水模式視窗程式的初始狀況類似 NRTSTARS 視窗化介面。進入視窗系
統後，你必須給一個專案名稱，它紀錄一些有關專案檔名及參考圖形、資料的位置，因此
我們必須先將建置好的二維綜合淹水模式輸出入資料存到一個規劃好的目錄中。再來就可
以在檔案功能選單中選取新專案，進入對話框填入專案的名稱及選取存輸出入檔名資料的
專案檔名及模擬區示意圖的地理位置，按下儲存專案資訊後，同時儲存一些重要的資訊到
工作目錄及安裝目錄中，可提供其他表單必要時的讀取。 
淹水觀測點一維圖形展示將類似 NETSTARS 視窗化繪圖介面。可以在圖下方 Slider 的
拉引處拉引到適當位置，縱橫座標值均會隨著所拉範圍的改變而調整。在滑鼠移動時會改
變右上方的座標位置，此座標位置紀錄滑鼠位置對應的真實座標值。也有輸出到印表機列
印功能。也可抓取所繪圖形到剪貼簿的功能。說明選單的內容文件為二維綜合淹水模式的
理論等技術文件，需要轉換為.WHP 或.chm 等 HELP 格式檔，另外也有類似 NETSTARS 視
窗化秀圖介面展示二維淹水影像動態圖的功能。 
2DIIM 視窗程式功能表依需求，參考 NETSTARS 的操作介面，先規劃為七大項：檔案、
編輯、輸入資料轉換、條件設定與模擬、資料轉入資料庫、繪圖展示、說明。以後可以再
依需求做進一步的擴充。每個工具列的項目都有提示，讓滑鼠移到按鈕的位置就能清楚這
些工具鈕的用途。有關 ICON 大部分為網路所蒐集，只有主程式的水滴圖案是計畫主持人
自行設計的。開啟 2DIIM 視窗程式的初始狀態如圖 1 所示。以下說明各選單子功能項目： 
 
圖 1 開啟 2DIIM 視窗程式的初始狀態 
所規劃的檔案選單包括：新專案、開啟舊檔、存檔、另存新檔、關閉檔案、列印、離開等
七項。 
所規劃的編輯選單包括：Windows 的記事本、簡單編輯器、UitraEdit、Crimson Editor、Editpad 
Lite、使用 WORD 做報告等六項，其中記事本、UitraEdit、WORD 是呼叫 Windows 裡面
的預設程式位置，其它三個均在裝過程中自動放入執行程式的目錄裡面。 
1. 所規劃的輸入資料轉換選單包括：網格資料萃取前處理、萃取資料轉成輸入地形、水
-7- 
依照此視窗系統功能表規劃，由左到右依序操作，分別可以從建立專案、整理模式輸
入檔、其他輸入資料的轉換、計算模擬、將輸出成果轉入資料庫、從資料庫讀取資料繪圖、
3D 互動成果的 Demo、查看使用說明等。這些過程資料將透過存在應用程式端目錄或原始
輸入資料端目錄的固定檔名來交換每支程式所需的資訊。 
資料庫放在應用程式端目錄，專案檔放在原始輸入資料端目錄，許多與資料相關的中
間結果置於原始輸入資料端目錄，所有執行程式安裝在應用程式端目錄，透過應用程式端
路徑及輸入資料端路徑來執行程式並產成成果放置於輸入資料端，資料庫的資料表名稱由
輸出的檔案名稱組合決定，因此每一個模擬案例一該會有不同的資料表產生，繪圖時也會
找到屬於該案例的成果來繪圖。 
資料庫使用 Access 檔案，資料庫名稱為 2diim.mdb，原來沒有資料，根據應用程式的
SQL 語法產生該案例的資料表名稱，及由讀取的檔案內容的對應文字資料設為欄位名稱，
並將對應的紀錄寫入資料表中，通常一個資料表代表模式執行後的一個輸出檔，但也有部
份是分割一個輸出檔為幾個資料表，以作為繪圖比較使用。最後使用 RoboHelp X5 Office
進行說明文件的製作。 
五、淹水計算成果 3D 虛擬實境規劃與製作 
本研究從成果產出的展示著眼，設計一個 Quest3D 互動 Demo 範例來展示淹水動態成
果，並提供身歷其境的操作環境，即是應用 Quest3D 的元件所組成的一個虛擬實境的程式，
使用者操作一個在曾文溪的淹水範圍裏面行走的人物，來模擬出當時淹水的情形。 
模式計算的輸出成果包括模擬區的 thiesms.grd、每小時的淹水深、每小時的淹水位、
每小時洪水到達時間、每小時最大淹水深、每小時降雨量、每小時流速分布，以及淹水觀
測點的淹水歷程線。前者為平面二維資料，可以直接在 Arcview V3.2 裡面載入成為 Raster
資料，提供繼續套圖或計算使用，這些資料除了流速還須特別處理外，基本上都可以套其
他圖檔輸出成影像格式，流速的資料仍需透過 surfer 軟體處理成箭頭資料，再輸出成 DXF
格式，到 Arcview 在入圖檔做套疊。淹水歷程線的檔案由視窗程式讀入檔名，轉為資料表
名稱，讀取檔案的第一行，以空白分開，讀取的資料設定為欄位名稱，然後再使用 SQL 語
法將第二行以後讀取的數據寫到資料表的紀錄裡面，再用其他的視窗程式讀取資料庫的資
料進行視窗的繪圖。在此我們用已開發完成的視窗程式將平面二維輸出格式轉成 3D VRML
格式，並設定誇張化倍數 50 倍突顯淹水位變化的起伏。 
本研究使用研究設備費購置 Quest 3D 軟體，並摸索了解該軟體可達成的功能，此軟體
號稱可以製作線上遊戲，單機互動遊戲應不成問題，然因中文使用手冊不夠明白，摸索階
段仍碰到無法解決的問題，2006 年 8 月份國內代理商艾伯特電通公司舉辦的六日講習，對
於整合的設定才漸熟悉，在 2006 年 9 月底也出版國內第一本中文書，對 Quest 3D 在國內
來講，是進入一個新的旅程碑的開始。由於此軟體使用 channel 的樹狀結構程式方塊構築整
個互動的設定，所以寫程式只是方塊排列組合而已。本研究基於淹水成果要使用 3D 方式
展示，又要可以到處看看淹水的情況，因此採用製作遊戲的概念，操作主角使用第三人稱
視角，我們可以看到主角在場景裡面的狀況，當操作的人物走到淹水區的時候可以看到淹
水的動態，以半透明的物件變化來模擬淹水的變化，主角在固定點可以看到自己的身體被
水淹沒的情況，可以藉由方向鍵操作主角的轉動及移動等方式讓主角游走於場景之中，觀
察各處的淹水狀況，從人物身上可以看到淹水位的半透明物件，操作成果如圖 3 所示。 
我們將模式計算的二維淹水位變動的成果資料，透過轉換程式轉為 3D VRML 格式，
再到 3ds max 將物件 import 進來，並在淹水位物件加上貼圖，讓每一張淹水深物件都有正
確的套圖，再將每一個淹水位物件匯出成.x 的格式，進入 Quest 3D 軟體將所有淹水位物件、
-9- 
站上提供線上互動操作，需要將所有原始檔上傳才能正確使用；後者可以提供下載後到單
機執行，只需複製執行檔就可使用。本互動操作介面主要以納莉颱風在曾文溪畔造成的淹
水情形做設定與展示的內容，此案例包括 16 個淹水觀測點，互動介面以水呎圓柱體搭配
3D 文字置放在場景裡面相對的定點位置，地面有網格分佈及衛星影像兩種貼圖可切換觀
察，還有設定加速及減速觀察起始到終止時間淹水變化的情形，從操作人物到達淹水區就
可以看到淹水位在人物的身上。目前因為地表高程誇張 50 倍，導致模擬區邊緣因為落差太
大而有斷崖的現象，但這對模擬區的掌握是重要的，尤其當人物走進模擬區邊緣時，可能
可以看到最大淹水情況，但需要謹慎操作不讓人物掉到邊緣外面，如果掉到邊緣外可以按
空白鍵回復到原始位置重新操作。如果沒有此類界線，往往不知人物是否還在模擬區內，
而花費許多不必要的操作時間。每小時淹水模型經誇張化的 VRML 格式轉成 Quest 3D 資料
格式的過程，還有經過 3ds max 轉模型格式，轉到 Quest 3D 後，再利用 Morph Object 進行
起始時間與終止時間淹水變化的設定，由互動成果發現淹水變化僅集中在模擬區邊緣，與
模擬成果有較大的差異，在許多水呎觀測點上仍看不到淹水跡象，與調查成果有出入，這
部份尚需進一步檢討因果關係。不過本互動成果及製作流程對未來製作淹水動態的互動內
容應具有示範的作用。 
六、視窗系統建置成果與討論 
6-1 視窗程式與資料庫關鍵技術 
有兩個部份與資料庫有關，其一是淹水歷線輸出資料，這部份透過一支程式將歷線資
料轉入資料庫，有三個步驟依序執行，第一個步驟讀入二維淹水模式觀測點檔名並置放在
視窗的 list 裡面，第二步驟是讀取 list 裡面的檔名，設定資料表名稱，並將結果寫在另一個
list1 裡面，最後再讀取 list1 的資料作迴圈，產生每個淹水觀測點的資料表，繼續讀取歷線
檔的第一行，以空白分開欄位名稱，再寫入相關的資料表欄位名稱，接著讀入第二行記錄
資料，使用 SQL 語法將讀入的字串重新排列成在資料表產生資料錄的格式，執行 SQL 指
令，將資料寫入資料表，執行完成會將完成的資料表名稱寫在 list2 裡面，以監視有無錯誤
發生。此部份已有完整成果如後所述。其二是二維輸出的成果資料，第一步先將表頭資料
轉到資料庫的一個資料表，第二步是 2D 的資料轉入資料庫，資料表名稱由檔名決定，資
料欄位名稱規劃為 ID、X、Y、Z，沒有資料的點不放入資料表，然後使用對話視窗，可以
選取多個輸出檔進行二維點資料轉入資料庫，第三步是由對話視窗選擇要畫圖的檔案特性
去尋找相關的檔案 list 出來，由 list 裡面挑選一個檔，將依據這個檔的資料到資料庫取出對
應的資料表裡面的二維點紀錄，並將 Z 值分類後賦予 RGB 值，在畫布的規劃位置劃線塗上
該顏色，則有資料的點會有不同的顏色，則二維漸層圖就會 show 出淹水深、淹水到達時間
等訊息，當然要在各點上顏色的同時製作 Legend，標示各顏色區間的值範圍，類似折線圖
可以 copy 成果圖做報告。此部份在第二步輸出資料轉資料庫的部份，程式仍有錯誤無法將
資料完整寫入，所以建置成果並未列入。 
6-2 功能表各項子功能建置及說明 
進入視窗系統後，你必須給一個專案名稱，他紀錄一些有關專案檔名及參考圖形、資
料的位置，因此我們必須先將建置好的 2DIIM 模式輸出入資料存到一個規劃好的目錄中。
再來就可以在檔案功能選單中選取新專案，進入對話框填入專案的名稱及選取存輸出入檔
名資料的專案檔名及河川規劃示意圖的位置，按下儲存專案資訊後，將同時儲存 net.dat、
projectname.txt 及 path.txt 三個檔案，將重要相關資訊寫入，提供其他表單必要時的讀取。
若已經建立過專案，可以直接選取開啟專案，已開啟舊有專案，將舊專案內的檔案資訊再
顯示出來近一步作確認動作。按下確定或更新後，將同時儲存 net.dat、projectname.txt 及
path.txt 三個檔案，將重要相關資訊寫入，提供其他表單必要時的讀取。確認專案內容表單
-11- 
資料轉入資料庫的部份，是繪圖展示之前必須要先執行的工作，如圖 7 所示。繪圖展
示的第一個功能為淹水模擬示意圖，這裡將會參考專案選取的圖片連結位置貼到視窗中，
以利隨時觀察，可以使用 Scrollbar 調整圖片顯示的局部區域，如圖 8 所示。 
 
圖 7 歷線資料轉入資料庫執行結果圖示 
 
圖 8 淹水模擬示意圖範例圖示 
-13- 
 
圖 11 操作手冊成果示意圖 
 
圖 12 關於二維淹水模式 V2.0 的視窗示意圖 
6-3 使用者操作及技術手冊軟體說明文件製作 
進入 RoboHelp Starter 可以看到製作的格式可以選擇七種，分別為 WebHelp、WebHelp 
Pro、FlashHelp、HTML Help、WinHelp 2000、WinHelp 4、WinHelp 3，其中以 FlashHelp
製作的成果最漂亮，但也比較難學，本研究使用較容易的 WinHelp 2000 來製作，製作步驟
請參考附錄四。以樹狀展開架構設計章節，使用分頁的方式將文章適當的分離，幾乎不需
拖拉 scrollbar，讓每一個畫面可以一次看完，使用者操作手冊製作成果如圖 13 所示，如有
內容更新，也可直接在專案裡面對應的 word 檔作資料更新，再一次進行編譯就可。技術手
冊因內容太多，全部放入在執行編譯期間無法完成作業，需要分成兩個檔製作。 
-15- 
八、參考文獻 
1. Hui-Ming hsieh, Stanley Shieh and Hong-Yuan Lee, Sep 4, 2001,, "Inundation Simulation and 
Analysis of Tu-Cheng, Pan-Chiao, Chung-Ho and Yung-Ho Areas during Typhoon Herb 
Flooding Event"，Urban Drainage Modeling 2001, Conference Proceeding Paper, ASCE, pp. 
418-430. 
2. Hui-Ming hsieh, Stanley Shieh and Hong-Yuan Lee, 2001, "Inundation Simulation and 
Analysis of Tu-Cheng, Pan-Chiao, Chung-Ho and Yung-Ho Areas during Typhoon Herb 
Flooding Event"，World Water & Environmental Resources Congress, May  Orlando, Florida 
3. 謝慧民、李鴻源、簡子硯、黃建豪、黃淑金，2005,3,”水利模式 NETSTARS 視窗化之研
究”, 銘傳大學 2005 國際學術研討會資訊管理組海報論文，銘傳大學，台北。 
4. 謝慧民，2000，“二維淹水模式與地理資訊系統介面搭配之應用＂，八十八年度電子計
算機於土木水利工程應用研討會論文集，pp.765-773。 
5. 謝慧民、李鴻源，1996，〝賀伯颱風土城、板橋及中永和地區淹水事件之模擬及檢討分析〞，
八十五年度農業工程研討會論文集。 
6. 謝慧民，1998，「二維綜合淹水模式使用者手冊」，國立成功大學防災研究中心 
7. 謝慧民，1990,6，〝台北市低漥地區之淹水模擬〞，國立台灣大學農業工程學研究所碩士
論文。 
8. 許盈松、謝慧民，2004,＂防洪水利設施受損淹水數值模式之研發與應用－子計畫：淹水
監測預警系統規劃研究(2/2)＂(計畫編號：NSC92-2625-Z-035-004- ) ,行政院國家科學委員
會。 
9. 許盈松、謝慧民，2003,＂防洪水利設施受損淹水數值模式之研發與應用－子計畫：淹水
監測預警系統規劃研究(1/2)＂(計畫編號：NSC91-2625-Z-009-001- ) ,行政院國家科學委員
會。 
10. 艾伯特電通網站：http://www.vrcradle.com/ 
11. Quest 3D 官方網站：http://www.quest3d.com/ 
12. RoboHelp X5 官方網站：http://www.adobe.com/products/robohelp/ 
13. 李逢春、黃俊銘、徐世豪，2006，Quest 3D 互動多媒體設計寶典，安全教育推廣協會出
版。 
-17- 
可供推廣之研發成果資料表 
□ 可申請專利  █可技術移轉                                      日期：95 年 10 月 26 日 
國科會補助計畫 
計畫名稱：二維綜合淹水模式功能強化及視窗化研發(I) 
計畫主持人：謝慧民         
計畫編號：NSC 94-2211-E-434 -005 - 學門領域：水利工程 
技術/創作名稱 二維綜合淹水模式視窗程式及 Quest 3D 淹水互動 Demo 程式 
發明人/創作人 謝慧民 
中文： 
2DIIM 是一套可以考意地文條件的二維淹水模式，透過視窗化
將輸入輸出的資訊整合進來，透過這個視窗化介面的操作可以執行
輸入資料的整合建立、修改、存檔，及專案資訊的存檔，資料備妥
後可以使用功能選項執行主程式，跑完後可以透過輸入資料庫的相
關功能將輸入、輸出的必要資訊存到 Access 資料庫，再使用對話
視窗選項的方式呼叫對應的資料庫 record 出來進行圖形的繪製輸
出工作，可以執行淹水觀測點的淹水歷線折線圖展示、淹水深分佈
二維漸層圖、淹水到達時間二維漸層圖、輸出資料轉為 3D VRML
格式做其他加值運用、展示 2D 動畫等視窗功能。輸入、執行、輸
出等處裡程序於視窗介面乃發展程式之趨勢，本年度計完成下列成
果： 
1. 使用 VB 完成視窗功能介面設定、淹水觀測點輸出資料轉入資料
庫及繪圖功能。 
2. 使用 Quest 3D 規劃設計 Demo 範例，主角在淹水位變動的場景
游走，可以看到自己被水淹的情形，也可透過水尺的刻度了解淹
水情形，互動操作功能有如玩遊戲。 
3. 使用 RoboHelp 製作操作手冊的軟體說明文件，可以將圖資也整
合放到文件裡面展示。 
技術說明 
英文： 
For the windows interface development part, besides the development 
of input-output data interface and the planning-establishment of user 
function table, and the establishment of photographical interface using 
geographical information system, which can be used to analyze and 
show the two-dimensional variation diagrams of inundated ranges and 
depths, it still includes the establishment of photographical interface 
using the three dimensional virtual reality of analyzing and showing the 
spatial variation diagrams of inundated areas. For this job, we plan to 
complete a whole set including the operational interface, user’s manual 
and technical handbook of the model in Chinese. We expect all this to 
help a lot for hydraulic relative persons. That is helpful to extend 
application of this model by doing this project. 
