1 
 
整合被動式動態步行與倒立擺模型之仿人機器人步行模式生成 
 
主持人：林麗章 
執行機構：國立中興大學機械工程學系 
執行期間：民國 100 年 8 月 1 日至 101 年 7 月 31 日 
國科會計畫編號：NSC 100-2221-E-005-025 
 
摘要 
  本計畫探討仿被動式步行特性之主動式雙足機器
人步行模式生成與實現。先以 D-H 法定義機器人的連
桿座標系統，再利用齊次轉換矩陣求得正向運動學數
學式，並利用代數法與幾何法推導遊動腳之反向運動
學解析式。步態規劃時先以類圓規式被動機器人的步
態特性，將支撐腳視為一倒單擺作髖部運動軌跡的規
劃，再以多項式內插法規劃遊動腳腳尖與地面的關係。
並以多質點模型推導 ZMP 計算式，以分析步行的穩定
度，其中連桿質心位置、加速度的推導，則由建立雅
可比矩陣求得各連桿質心的絕對速度，再微分以得到
絕對加速度。最後本研究將所規劃的步態軌跡進行電
腦模擬，並將各關節的期望軌跡轉換成實際機器人之
命令軌跡 
，輸入至機器人之控制器，以印證步態規劃的可行性。 
關鍵詞：雙足機器人，仿被動式步行，步態規劃 
 
1.前言 
McGeer [1] 於 1990 年提出二維由重力驅動的雙
足被動式動態行走(passive dynamic walking)機器，其設
計的模型類似圓規狀(compass-like)，於選定特殊的初
始條件後，即可在一緩坡上自然的往下行走，具有穩
定的極限循環(limit cycle)步伐，類似於人類的步伐。 
    人走路時，膝蓋並不須太多的彎曲即可前進，這
與被動式機器人走下斜坡時類似。將這樣的概念，應
用在雙足機器人的步行規劃，使具有被動式機器人的
步態特性，走路方式更像人類，消耗較低的能量。 
為了探討雙足機器人動態行走的穩定性，
Vukobratovic 和 Stepanenko [2] 提出零力矩點(Zero 
Moment Point)的定義[3]，並得到重要的步行穩定性考
慮準則:若 ZMP 點落在腳底板的支撐多邊形範圍內，則
雙足機器人即能穩定的步行[4] 
Kajita 等 [4-7]提出基於線性 3D 倒立擺模式和
ZMP原理的COG(機器人總質心)單質點軌跡規劃法，
於單腳支撐階段限制 COG以等高度或在設定 z 軸截距
的平面內運動的方式，設計出 COG 的解析軌跡，並陸
續提出即時 COG 軌跡產生方法，並由仿人機器人
HRP-2L 來實現所規劃的步行軌跡。 
Sato 等[8]提出了應用於三維雙足機器人單腳支撐
階段的即時步態生成方法，其規劃亦分為兩部分加以
探討。透過軀幹高度固定不變的條件以三質點模型來
規劃軌跡，由 ZMP 方程式與遊動腳軌跡得到軀幹的解
析期望軌跡，在建模方面此法比傳統的三維質心線性
倒擺方法[4-7]較為精確，並將該法延伸應用至對角線
行走(diagonal walking)的情況，並引入雙腳支撐階段，
進一步印證所提軀幹等高度軌跡規劃法的可用性[9]。 
高[10]設計製作一雙足機器人，利用三階軟楔法
(cubic spline interpolation)搭配多項式內插法來規劃步
行軌跡，以及探討步行穩定度，並藉由使用代數法與
幾何法推導反向運動學模式，求得對應的關節軌跡。 
Huang 等[11]提出先規劃一些運動限制參數，藉由
改變參數可獲得適合各種地面的雙足運動軌跡，並提
出結合 ZMP 理論的步態最佳穩定度搜尋法，挑出最具
穩定的步態軌跡。 
Zhu 等[12]提出考慮雙足機器人之側視平面與正
視平面同步化運動的步態設計法，假設機器人質量集
中於質心，且使用 3D 倒擺模型來近似複雜的機器人，
再藉由考慮不同之規劃好的 ZMP軌跡和挑選適當參數 
，便可容易得到一組穩定的質心軌跡。 
Ha 和 Choi [13]提出虛擬高度倒立擺模式，規劃單
腳支撐階段的質心軌跡後，再配合足部軌跡以求得髖
部軌跡，並以 ZMP 原理判斷其穩定性。 
Lee 等[14]藉由讓 ZMP 在支撐腳足部凸包(convex 
hull)內適當變化的方式，提出一能修改步行週期和步長
的演算法，可獲得三維倒擺模式無法獲得的步態。 
本研究將針對 RoboBuilder 所研發的 HUNO 小型
雙足機器人[15]，經由模型簡化，得到簡單的轉動關節
模型，利用 D-H 法推導正向運動學數學式，以及利用
代數法與幾何法求得反向運動學的解析式。再參考被
動式機器人的步態特性，提出將支撐腳視為一倒單擺
的步行規劃方法。最後並將規劃的雙腿期望軌跡，透
過原廠機器人所提供的軟體，進行步態規劃的實現。 
 
2. 雙足機器人之運動學模式 
  本節先使用 D-H 法定義雙足機器人各連桿的座標
系統，並利用齊次轉換矩陣求得正向運動學的數學式，
再由幾何法與代數法求解反向運動學的解析式。 
2.1 雙足機器人之正向運動學   
  本研究考慮的雙足機器人是由 RoboBuilder 公司
[15]所研發，如圖1(a)所示，其下半身主要結構有髖部、
大腿、小腿以及足部，每個部位皆以搭載馬達之連桿
所組成，在髖部與大腿連接之股關節有兩個自由度，
3 
 
中，為了使軀幹維持原先的方向而不傾斜，亦即保持
座標系統{0}的期望方向如下: 
0
0 0 1
0 1 0
1 0 0
B
− 
 
= − 
 
− 
R
 由 5
0 5 0
B B
=T T T 之左右兩矩陣元素(1,3)與(2,1)分別相等，
可得： 234 1,cθ = − 1 5 1 5 0c s s cθ θ θ θ− = 。 
    當右腳為支撐腳時，大小腿打直，故其膝關節 3θ 為
零，所以可得： 
      2 4 1 5,θ θ pi θ θ pi− = = +           (10) 
當左腳為支撐腳時，因其座標系統{5}方向與右腳方向
不同，由相同推導過程，可得左腳之關節角度關係式： 
2 4 1 5,θ θ pi θ θ= − =             (11) 
(10)、(11)式和 3 0θ = ，為支撐腳各關節角度之關係式。        
3. 雙足機器人之步態規劃 
    由正向(forward)運動學數學式可求得支撐腳腳踝
關節相對膝關節的位置向量，亦即座標{5}原點相對座
標{3}原點之關係，將此向量視為一倒立擺，再以倒立
擺模式來進行軌跡規劃。由雅可比矩陣求得各連桿質
心相對世界座標的絕對速度，進一步微分可得到絕對
加速度，再由 ZMP 計算式，即可分析所規劃步態的穩
定性。 
3.1 仿被動式機器人之倒單擺模式 
    由圖 1(b)可知，當右腳為支撐腳時，座標系統{5}
與{B}須保持一定的固定關係，再由正向運動學得到
5
3T = 3 15( )T − ，所以可得： 
5
3 5 3
B B
=T T T  
4 4 4 4
4 5 4 5 5 4 4 5
4 5 4 5 5 4 4 5
0
0 0 0 1
s c l s
c s s s c l c s
c c s c s l c c
θ θ θ
θ θ θ θ θ θ θ
θ θ θ θ θ θ θ
− 
 
− − 
=
 
−
 
 
          (12) 
由(4)式可知座標{3}原點相對座標{B}原點的位置向量，
因為希望大、小腿保持一直線，並視為一倒立單擺，
故 3θ 固定不變，所以倒立擺的長度 r 可延伸至髖部，
亦即
3 4r l l= + ，如圖 2(b)所示。定義 *4 4θ θ= − ，則座標{1}
原點相對於座標{B}原點的位置分量可表示如下: 
* * *
4 4 5 4 5, ,x rs y rc s z rc cθ θ θ θ θ= = =           (13)
 
因此，支撐腳可以由簡單的倒立擺模型表示，如圖 2(b)
所示。倒立擺的運動方程式，可由 Lagrange 方程式推
導，以矩陣型式表示如下： 
5
2 2 * * *2 *
4 4 44 54
*2 2 * 2 * * *
54 54 5 4 5 4 4
0
0
mr c s mgrs cmr
mgrc smr c mr c s
θ θ θ τθ θθ
τθ θθ θ θ θ θ θ
      −  
+ + =       
−
−         
ɺɺɺ
ɺɺ ɺ ɺ
   (14) 
利用回授線性化來消除非線性項，可簡化 4*θ 與 5θ 的運
動方程式為 
* *
4 4 5 5
3 4 3 4
,
g g
l l l l
θ θ θ θ= =
+ +
ɺɺ ɺɺ
               
(15) 
由(15)式可分別求出
4
*θ 與 5θ 的解析運動公式: 
* * *
4 4 4
5 5 5
(t)= (0) cosh( ) (0)sinh( )
(t)= (0)cosh( ) (0)sinh( )
l
l l
l
l l
t tT
T T
t tT
T T
θ θ θ
θ θ θ
+
+
ɺ
ɺ
           
(16) 
其中 *4 5(0), (0)θ θ 為 *4 5θ θ和 的初始角度； *4 5(0), (0)θ θɺ ɺ 為初始速
度； ( )3 4lT l l g+≜ 。將(16)式代入(13)式，可得髖部相對
於座標{B}的運動軌跡。 
3.2 步行軌跡規劃 
  在步行過程中，先不考慮雙足機器人的左右擺動，
亦即 5θ 保持固定不轉動，只考慮 *4θ 往前跨步的動作。
參考圖 3，本節將步行過程分為六個階段：第一階段
(n=1)為起始階段，以右腳當支撐腳，左腳為遊動腳往
前跨完整步伐的一半(
xs )；第二、四階段(n=2,4)為完整
步伐階段，以左腳為支撐腳，右腳為遊動腳往前跨出
完整步伐( 2 xs )；第三、五階段(n=3,5)與第一階段相同
(以右腳為支撐腳)，但遊動腳跨出為完整步伐；最後第
六階段(n=6)為終止階段，右腳為遊動腳踏回以恢復初
始狀態。因此，在運動過程的第一階段(n=1)，倒立擺
由直立姿態往前擺動，使得髖部參考點 Bm 前進 2xs ，
而在第二階段(n=2)時， Bm 點繼續由左腳往前擺動而前
進
xs 的距離，後續分別由第三、四、五階段之倒立擺
往前擺動，而在第六階段時，左腳為倒立擺往前擺動
使 Bm 前進 2xs 的距離，並使機器人恢復至直立姿態 
，如圖 3 所示。            
ys
2 xs
2 xs
2 xs
2 xs xs
xs
 
x
s 2
x
s2xs xs xs xs
1n=
2n =
3n =
4n =
5n =
6n =
     
Bm
 
圖 3  步行參數圖 
    各階段支撐腳往前擺動的軌跡可推導如下。在
1n = 時，右腳為支撐腳，如圖 4(a)所示，由初始角
*(1)
4, (0) 0stθ = ，擺至終止角 *(1) 14, sup 3 4( 2) sin (( 2) ( ))st xT s l lθ −= + ，
再由(16)式，可求得所須之初始角速: 
s up*(1 ) 1
4 ,
3 4
(0 ) s in ( ) ( s in h ( ) )
2 ( ) 2
x
s t l
l
Ts T
l l T
θ −=
+
ɺ
   (17)
          由(16)式，即可獲得n=1時之
*
4 4θ θ= − 角度軌跡方程式： 
sup(1) *(1) *(1)
4, 4, 4,( ) ( ) (0)sinh( ),  0 2st st l st l
Tt
t t T t
T
θ θ θ= − = − ≤ ≤ɺ
  
(18) 
   在 n=2 與 n=4 時，皆為左腳支撐右腳遊動的情況，
所以兩階段之規劃方式一樣。參考圖 4(b)，先定義支
撐腳擺動幅度的半角為 1 3 4sin (( 2) ( ))xs l l−Φ = + ，所以由
* *
4 4 sup(0) , ( )Tθ θ= −Φ = Φ ，以及 (16)式，可求得初始角速
sup sup* * *
4 4 sup 4(0) ( ) (0) cosh( ) ( sinh( ))l
l l
T T
T T
T T
θ θ θ = − 
 
ɺ ，由 (16)
5 
 
sup( ) ,
2f
T
tθ pi≥ = 可得： 
sup3 2
3 2
sup sup
sup
sup
8 4( ) ,   0
23 3
( ) ,                                
2
f
f
T
t t t t
T T
T
t t T
pi piθ pi
θ pi

= − + ≤ ≤



= ≤ ≤

     (28)
 
3.3 由期望軌跡求解遊動腳之關節角度 
依前述所推導的期望軌跡，使用反向運動學方程
式，可得到 2,swθ 、 3,swθ 、 4,swθ 的期望角度軌跡。因為左
右兩腳在座標系{4}的方向定義並不一樣,所以在
n=1,3,5 階段，左腳為遊動腳時，以及在 n=2,4,6 階段，
右腳為遊動腳時，必須分別加以討論。而與 2,swθ 、 3,swθ 、
4,swθ 有關的齊次矩陣 1 4T ，令其與期望軌跡對應的方位
矩陣相等，直接引用 2.2 節所推導之反向運動學公式，
即可求出所需要的關節角度。 
3.4 步行時左右擺動角度之規劃 
    前述支撐腳與遊動腳推導，只考慮在 Sagittal 平面
內沿 X 軸之前進方向，並未考慮在正視平面內沿Ｙ軸
方向的左右擺動。本節繼續考慮與擺動有關之 1θ 、 5θ 部
分， 5θ 決定機器人左右擺動幅度，故先規劃 5θ 的期望
軌跡，再由 2.3 節關節角度關係式，求得 1θ 。而規劃遊
動腳部分，則是在腳底板抬起時，必須保持與地面平
行。為了使軀幹保持正立，以及遊動腳腳底板維持和
地面平行，故遊動腳與支撐腳都須遵守各關節角度的
關係式。而左腳為支撐腳的規劃與右腳為支撐腳的步
驟相同，不同的是在腳底板轉動的方向。 5θ 依多項式
內插法來進行規劃: 
(1) 4 35 5
5 4 3
sup sup
25 5
2
sup sup
1024(10 3) 128(110 27)( )
45 45
128(50 9) 32(10 1)
            
45 45
t t t
T T
t t
T T
θ Φ − Φ −= −
Φ − Φ −
+ −
           (29) 
(2,4) 5 45 5
5 5 4
sup sup
3 25 5
3 2
sup sup
256(10 3) 64(110 27)( )
45 45
128(50 9) 64(10 1)
              
45 15
t t t
T T
t t
T T
θ − Φ − Φ −= +
Φ − Φ −
− +
        (30) 
(3,5) 5 45 5
5 5 4
sup sup
3 25 5
3 2
sup sup
256(10 3) 64(110 27)( )
45 45
128(50 9) 64(10 1)
                
45 15
t t t
T T
t t
T T
θ Φ − Φ −= −
Φ − Φ −
+ −
       (31) 
(6) 4 35 5
5 4 3
sup sup
25 5
2
sup sup
1024(10 3) 128(110 27)( )
45 45
128(50 9) 32(10 1)
             
45 45
t t t
T T
t t
T T
θ − Φ − Φ −= +
Φ − Φ −
− +
         (32) 
4. 雙足機器人之步行穩定分析 
4.1 ZMP 計算式推導 
    本節將雙足機器人簡化為多質點模型，以推導其
ZMP 計算式。參考圖 6(a)，先求出地面反作用力繞世
界座標原點的力矩， 
p= × +τ p f τ                              (33)                                             
其中 [ ]0 TZMP ZMPX Y=p ；    
    0 0 T Tp px py pz pzτ τ τ τ   = =   τ 。 
再由動量(P )變化率等於合力，以及角動量(L)變化
率等於合力矩， 
1
n
i
i
m
=
= +∑P g fɺ
                          
(34) 
1
n
i i
i
m
=
= × +∑L c g τɺ
                        
(35) 
綜合可得：
  
          
(36)
 
由(36)式，因繞 ZMP 點的合力矩為零， 
1 1
( ) 0
x
n n
p x i i z i ZMP
i i
L m gy P m g Yτ
= =
= + − − =∑ ∑ɺ ɺ          
1 1
( ) 0
y
n n
p y i i z i ZMP
i i
L m gx P m g Xτ
= =
= − + − =∑ ∑ɺ ɺ    
所以可得多質點 ZMP 計算式如下： 
           
(37)
 
           
(38)
 
4.2 雅可比(Jacobian)矩陣推導 
由於本研究之雙足機器人關節皆為轉動關節，僅
以關節類型為轉動關節的操作器為例，說明雅可比矩
陣的推導。圖 6(b)為一 N 連桿操作器，由關節變數構
成的向量定義為 1 2[ , , , ]TNθ θ θ=θ … ，因此座標{N }原點
NO 的速度 0 Nv 可表示成 ，其中 vJ 為線速度雅可
比矩陣，維度為 3 N× 。在這個運動鏈中，假設其他所
有的關節固定不動，僅有關節 iθ 在轉動，所以第 i 個關
節角速度
iθɺ對第N 個連桿的線速度貢獻為ω× r ，其中
， ,可得到對應於關節角速度 iθɺ的第 i
個行係數向量
,v iJ : 
,  
上述觀念，各連桿質心相對於世界座標之線速度雅可
比矩陣，以及座標{5}原點相對於座標{0}原點的線速
度雅可比矩陣。 
 
4.3 各連桿質心位置、速度、加速度之計算 
    根據(37)式與(38)式來計算雙足機器人步行時
零力矩點(ZMP)的位置。此兩式內所有變數均相對於
世界座標，利用齊次轉換矩陣的運算，可得到各座標 
1 1
( )
n n
i i i p
i i
m m
= =
= × + × − +∑ ∑L c g p P g τɺ ɺ
1 1
1
( )
( )
n n
i i i i i i i i
i i
ZMP n
i i
i
m z x m z x m gx
X
m z g
= =
=
− +
=
+
∑ ∑
∑
ɺɺɺɺ
ɺɺ
1 1
1
( )
( )
n n
i i i i i i i i
i i
ZMP n
i i
i
m z y m z y m gy
Y
m z g
= =
=
− +
=
+
∑ ∑
∑
ɺɺɺɺ
ɺɺ
0
N v=v J θɺ
θi iω = zɺ −N ir = O O
,
( )v i i= × −N iJ z O O 1, 2,...,i N=
7 
 
 
(a) 
 
        (b) 
圖 9 實際步行結果：(a)側視圖；(b)正視圖。 
 
3. M. Vukobratovic and B. Borovac, “Zero-Moment Point
－Thirty-Five Years of its Life,” Int. J. of Humanoid 
Robotics, Vol.1, No. 1, pp. 157-173, 2004. 
4. S. Kajita, F. Kanehiro, K. Kaneko, K. Yokoi, and H.   
Hirukawa, “The 3D Linear Inverted Pendulum Mode:   
A Simple Modeling for a Biped Walking Pattern    
Generation,” in Proc. IEEE Int. Conf. Intelligent   
Robots and Systems,Vol. 1, pp. 239-246, 2001. 
5. S. Kajita,F. Kanehiro,  K. Kaneko, K. Fujiwara, 
K.Yokoi, and H. Hirukawa, “A Realtime Pattern 
Generator for Biped Walking,” in Proc. IEEE Int. 
Conf. Robotics and Automation, Vol. 1, pp. 31-37, 
2002. 
6. 梶田秀司 編著, 管貽生 譯,仿人機器人, 清華大  
  學出版社, 北京,2007. 
7. K. Harada, S. Kajita, K. Kaneko, and H. Hirukawa,  
“An Analyical Method on Real-time Gait Planning for 
a Humanoid Robot,” Int. J. Humanoid Robotics,Vol. 3,  
No. 1, pp. 1-19, 2006. 
8. T. Sato, S. Sakaino, and K. Ohnishi, “Real-Time   
Walking Trajectory Generation Method at Constant   
Body Height in Single Support Phase for   
Three-Dimensional Biped Robot,” .in Proc. IEEE Int. 
Conf. on Industrial Technology, pp. 1-6, 10-13 Feb. 
2009. 
9. T. Sato, S. Sakaino, and K. Ohnishi, “Real-Time  
Walking Trajectory Generation Method With   
Three-Mass Models at Constant Body Height for   
Three- Dimensional Biped Robots,”. IEEE Trans. on 
Industrial Electronics, pp. 376-383, Feb. 2011.  
10.高琦凱, “雙足機器人的設計製作與步態規劃及嵌入  
式單軸伺服控制器實作”,國立中興大學機械工程學
系碩士論文,民國九十六年. 
11. Q. Huang, K. Yokoi, S. Kajita, K. Kaneko, H. Arai,    
N.Koyachi, and K. Tannie, “Planning Walking Pattern 
for a Biped Robot,” IEEE Trans. Robotics and 
Automation, Vol. 17, No. 3, pp. 280-289, June 2001. 
12. C. Zhu, Y. Tomizawa, and A. Kawamura, ”Bipedal    
Walking Pattern Design Based on Synchronization of 
the Motions in Sagittal and Lateral Planes,” in Proc. 
IEEE/RSJ Int. Conf. Intelligent Robots and Systems, 
pp. 4101-4107, Aug. 2005. 
13. T. Ha and C.-H. Choi, “An Effective Trajectory    
Generation Method for Bipedal Walking,” Robotics 
and Autonomous Systems, Vol. 55, No. 10, pp. 795- 
810, Oct. 2007. 
14. B.-J. Lee, D. Stonier, Y.-D. Kim,  J.-K. Yoo and  J.-H.   
Kim, “Modifiable Walking Pattern of a Humanoid    
Robot by Using Allowable ZMP Variation,” IEEE    
Trans. Robotics, Vol. 24, No. 4, pp. 917-925, 2008. 
15. HUNO robot platform, RoboBuilder Co., Ltd. 
16. J. J. Craig, Introduction to Robotics : Mechanics     
and Control, 3rd Ed., Addison Wesley, 2005. 
 
100 年度專題研究計畫研究成果彙整表 
計畫主持人：林麗章 計畫編號：100-2221-E-005-025- 
計畫名稱：整合被動式動態步行與倒立擺模型之仿人機器人步行模式生成 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 1 0 100%  
研討會論文 0 1 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 2 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 0 1 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 2 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
