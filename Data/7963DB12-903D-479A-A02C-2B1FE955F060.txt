 2
???????????????????? 
??????????????????????? 
A Fuzzy-sliding Control IC Design for Single-stage Photovoltaic Energy 
Conversion Systems                          
????: NSC94-2213-E212-028 
????: 94 ? 8 ? 1 ???? 95 ? 7 ? 31 ? 
?????: ??? ???  ???? ?????? 
 
                                                        
?.???? 
??? TSMC 0.35um ????????
???????????????????
???????????????????
???????????????????
??? Verilog HDL ???????????
???????????????????
???????????????????
???????????????????
???????????????????
???????????????????
???????????????????
??? 110V/60Hz ???????????
???????????????????
???????????????????
??????????????? 1kW ??
??????????????????
???????????????????
??????????? 
 
???????????????????
???????????????? 
 
Abstract 
In this research, a fuzzy-sliding controller 
IC of signal-stage photovoltaic energy 
conversion system is designed by cell-based IC 
design flow. The advantages of the study are to 
reduce the circuit volume and to finish a SoC 
(System on Chip) product. In this study, the 
Verilog HDL code is written, then the code is 
downloaded into FPGA (Field Programmable 
Gate Array) chip in order to verify the functions. 
After the grammar and functions are corrected, 
the prototype chip is finished by TSMC 0.35 
Cell-based Design Flow. Both the stand-alone 
mode and the utility mode are employed into 
the controller chip. The system is developed to 
provide the 110V/60Hz sinusoidal output 
voltage by voltage-controlled mode and deliver 
real power to the load. The excess power is 
supported to utility line with nearly unity power 
factor by current-controlled mode. Finally, 
experimental results of the 1kW PV energy 
conversion system are performed to verify the 
FPGA functions and simulation results of EDA 
(Electronic Design Automation) tool are 
executed to demonstrate the design of digital 
controller chip. 
 
Keywords: cell-based design flow, signal-stage 
photovoltaic energy conversion 
 4
[4,5]????? dP/dV ??? I ??????
??????????????????
[6,7]? 
???????????????? 
   

 −

−= 1exp
AKT
qVIII satg          (1) 
?? gI ??????? satI  ???????
????q  ????????K ?????
?? A?????? p-n ????????T
????????( Ko )??(1)??? 
   )ln(
sat
satg
I
III
q
AKTV
−+=            (2) 
????????????? 
  






 −

−== 1exp
AKT
qVIIVVIP satg   (3) 
???P ???????????????  
  )( III
AKT
q
dV
dIg satgm −+−=≡        (4) 
?? 
  V
dV
dII
dV
dPIb +=≡                  (5) 
    )ln()(
sat
satg
satg I
III
IIII
−+−+−=    (6) 
?? mg ?(5)??????????????
? 
  VgII mb −=                        (7) 
???
dV
dP ( bI )? mg ??? I ???????
????????????????? I ??
???????????????4????
??? dP/dV ? I ??????? 5 ???
????????dP/dV ? I ???????
??????????? dP/dV ??????
??????? Iref???????????
????????????? 6 ??? 
 
 
? 4 ????????? ( 
dV
dP ???V ) 
 
 (b) 
? 5 ????????? ( 
dV
dP ??? I ) . 
 
? 5 dP/dV ??? I ????? 
 
??Vn,In
??
??
dV=Vn-Vn-1
dI=In-In-1
dV=0
dI=0
Iref??
dV>0
dI>0
Vn>InVn>In
dI>0
??Iref ??Iref ??Iref ??Iref
?
?
?
?
?
?
?
?
?
?
?
?
 ? 6 ????????????? 
 
 
 6
???? 
     111ˆ fuzzyeqfuzzy uuu +=             (17) 
??
1fuzzyu ?????7?????? 1ex ??
??
1ex& ???????? 1fuzzyu ??????
?? 
 
 
(a) 
 
(b) 
 
(c) 
 
(d) 
?7 (a)???????, (b) 1ex ? 1ex& ???
??, (c) 1fuzzyu ?????, (d)?????. 
 
 
(a) 
 
(b) 
?8 ?????? (a) ????; (b)???
?. 
 
?? 7, 8 ???????????????
???????????????????
????????????????? 
 8
(5) ????? 
??????????????????
???????????????????
???????????????????
???????????????????
????? 8 ???????? IC ????
17 ???????????? 1 ?????
???8 ?????????? 13 ??? 
Vostart-(1'b0 & Voback & 8'b0)
Esu=0 ?
Iostart-(1'b0 & Ioback & 8'b0)
??
??
??
 
? 13 ?????????? 
 
(6) ????? 
????????????????
???????????????????
??????????: 
1,1,,, 6336.0322.0956.1 −− −−= noutnreenerrnout UVVU
     1,, 6336.0 −−= noutnout UY            (18) 
 (6)?? noutU , ? 1, −noutU ?????????
???????? nerrV , ? 1, −nerrV ??????
???????????????????
????? 14(a)??????
1,, 322.0956.1 −− nreenerr VV ??????????
? outY ????? 14(b)??????
1,, 6336.0 −− noutnout UY ???????????
outU ? 
 
??
?
Esu=0 ?
?
Verr,n*1.956=Verr3,n -Verr,n-1=Verr1,n-1
Verr1,n-1*0.322=Verr2,n-1
-Verr2,n-1 =Verr3,n-1
Verr4,n-Verr4,n-1 = Yout,n
Verr,n = Verr,n-1
??
???1??
??8??
??8??
Verr4,n Verr4,n-1
Yout,n=0
?
????????????????
Verr,n[16]=0?
Verr,n-1*0.322=Verr3,n-1-Verr,n =Verr1,n
Verr1,n*1.956=Verr2,n
-Verr2,n =Verr3,n
Verr,n-1[16]=0?? ??
????????????????
 
(a) 1,, 322.0956.1 −− nreenerr VV ??? 
??
?
Esu=0 ?
Uout,n-1[16]=0?
? ?
Uout,n-1*0.6336 = Uout3,n-1 -Uout,n-1 = Uout1,n-1
Uout1,n-1*0.6336 = Uout2,n-1
-Uout2,n-1 = Uout3,n-1
Yout,n - Uout4,n-1 = Uout,n
Uout,n = Uout,n-1
??
???1??
??8??
??8??
Uout4,n-1
Uout,n = 0
?
????????????????
 
(b) 1,, 6336.0 −− noutnout UY ??? 
? 14 ?????????? 
 
(7) ??????? 
?????????????????
???????????????????
????????? 15 ?????????
???????? 18MHz????????
???????????????????
????????? IC ????? PWM ?
?????? S2 ? S4 ????????
 10
Verilog Design 
& Simulation
( ModelSim 5.7)
FPGA 
Verification
(Xilinx ISE6.1)
Synthesis & DFT
(synopsis Desing 
Vision)
Auto Place & 
Route
(Soc Encounter)
Logic Simulation
(Debussy)
Idea
Replace layout
(Virtuoso)
Post Layout Verification
DRC/REV/LVS/LPE
(Calibre)
Post Layout 
simulation
(Nanosim)
ATPG
(Tetra Max)
ATPG
(Tetra Max)
Test Pattern
(pre-layout )
Test Pattern
(post layout)
Tape Out
.GDS II
Modify
Correct ?
YES
Correct ?
Correct ?
YES
Modify
YES
Modify
 
? 18 ????? IC ???? 
 
 
? 19 IC ????? 
 
(9) ????????? 
?????????? 20 ??????
??? 2 ????????????? FPGA
?????????????????? IC
??????????? 
???
??? Vpv
Cf
Lf
S
S3
S2
S1
LC?????? ????????
???(Power Stage)
????IC
S1 S2 S3 S4IpvVg
Ipv
Ci ??
??
io
Lo
?
?
iL
???? ????? ??
????
voio
????
vs
???(Controller Stage)
Co
???????
is
4
Vg
vo
vs
 
? 20 ???????????????? 
 
? 2 ????????? 
??????  DC 180 V~270 V 
??????  AC 1φ 2W 110 Vrms 
??????  60 Hz 
?????? 18 kHz 
?????? 1 kW 
?????? uFC i 470=  
???? IRFP460 (500V/20A) 
?????? 2   = 3 .7  1 0     0 .3 5
o l
o c
L m H r
C u F r
= Ω
= = Ω
 
 
1.? FPGA ????????????? 
(a)?????? 
? 21 ????????????? ov ?
???? Li ???? 22 ?????????
????????? ov ????? Li ???
? 23 ?????????????????
?????? 93%? 
 
ov
Li
ov Li
 
? 21 ??????? ov ????? Li ?? 
Corner0 
S
can_en 
nIN
TR
 
Ipv[0] 
Ipv[1] 
Ipv[2] 
C
ore V
D
D
1 
Ipv[3] 
C
ore V
S
S
1 
A
dc_cp 
C
ore V
D
D
2 
C
ore V
S
S
2 
Ipv[4] 
C
ore V
D
D
3 
C
ore V
S
S
3 
Ipv[5] 
Ipv[6] 
Ipv[7] 
Corner1
Vpv[0] 
Vpv[1] 
Vpv[2] 
Vpv[3] 
Vpv[4] 
Core_VDD4 
Core_VSS4 
Vpv[5] 
Vpv[6] 
Vpv[7] 
Core_VDD5 
Core_VSS5 
Io[0] 
Io[1] 
Io[2] 
Io[3] 
Io[4] 
Corner2 
Io[5] 
Io[6] 
Io[7] 
C
ore_V
D
D
6 
C
ore_V
SS6 
Vo[0] 
Vo[1] 
Vo[2] 
Vo[3] 
Vo[4] 
C
ore_V
D
D
7 
C
ore_V
SS7 
Vo[5]
Vo[6] 
Vo[7] 
Zeroin
E
su 
Corner3 
Rst 
Io_VDD2 
PWM2  
Io_VSS1  
PMW1  
Io_VDD2  
Tri_cp  
Io_VSS2  
Zeroout 
Core_VDD8 
Core_VSS8 
Cp
nRD 
Io_VDD3 
Io_VSS3  
nCS 
Scan_out 
