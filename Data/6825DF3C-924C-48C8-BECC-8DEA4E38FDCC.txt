instance, while the pathways of steroid biosynthesis, 
steroid hormone biosynthesis, protein kinases and 
glycosaminoglycan biosynthesis all constitute 
prominent features of metazoa-specific physiology, 
their evolution of domain architectures and catalytic 
functions follows distinct patterns.  Steroid 
biosynthesis is enriched with reaction creations but 
retains a relatively conserved repertoire of domain 
compositions and proteins.  Steroid hormone 
biosynthesis has high rates of reaction creations and 
protein duplications but a normal rate of emerging 
novel domain compositions.  Protein kinases retain 
conserved reactions but possess many novel domains 
and proteins.  In contrast, glycosaminoglycan 
biosynthesis has high rates of reaction/protein 
creations and domain recruitments.  Finally we elicit 
and validate two general principles underlying the 
evolution of domain-protein-reaction networks.  These 
results shed new lights on the evolution of metabolic 
systems. 
英文關鍵詞： metabolic networks, evolution, domain architecture, 
catalytic functions, parsimony, reconstruction, max-
product 
 
Project objectives
Originally, our project aims for achieving the following goals. First, we plan to develop computational algorithms
to reconstruct the evolutionary history of domain architectures and catalytic functions of metabolic networks, and
to characterize the evolutionary mechanisms for distinct metabolic subsystems. Second, we plan to build the model
of dependent evolution of multiple components in large-scale networks of protein interactions. Third, we plan to
build a sequence evolution model to measure selection coefficients of motif sequences, and to incur a large-scale
search of sequences with high selection coefficients and to validate their functional implications. Given the limited
time span of one year for the project, we only partially achieved the original goals. For the first sub-project, we
have successfully developed a reconstruction algorithm for the domain-protein-reaction networks and discovered
the process and lineage specific patterns of their evolution. We have completed the analysis works and submitted
them to a journal (PLoS Computational Biology) and a conference (RECOMB). For the third project, we have
established a sequence evolution model to measure the strength of natural selection of motif sequences. This work
has been plublished in a conference (WABI 2010). We have now completed an exhaustive evaluation of the selection
coefficients of 10-nucleotide sequences, and are in the process to validate their biological meaning. We did not carry
out the work of dependent evolution of network components due to the limited time and human resources in my group.
In addition, we collaborate with Alex Yu from National Taiwan University in identifying self-replicating insertion
sequences (IS) in bacterial genomes and metagenomes in rodents’ guts. We have completed genome-wide screenings
and are in the process of analyzing their biological functions. Since the first sub-project is already completed and
has accumulated sufficient results, I will focus on the reconstruction and characterization of domain-protein-reaction
networks in this report.
Introduction
Metabolic systems are the most ancient biotic networks, as the primitive metabolic reactions are likely to arise before
the emergence of proteins (Orgel 2004). Their importance to life, universality and complexity are unequivocal. On
the one hand, the metabolism of many essential nutrients is highly conserved across all life forms on earth. On
the other hand, diverse systems have been tailored to meet the differential metabolic demands in organisms living
in distinct environments. These phenomena have amazed generations of scientists and inspired a great number of
research endeavors in modern biology.
The term metabolic network is overloaded as it encompasses at least three types of relations. First, one can focus
on the metabolites (substrates) of reactions and construct a metabolite-centric network. Second, alternatively one can
focus on the catalytic functions of enzymes and construct an enzyme-centric network. Third, most enzyme proteins
are composed of polypeptide subunits called domains. Each domain possesses a distinct structural and functional
characteristic, and novel proteins can be formed by recombinations of limited domains. Thus one can focus on the
domain architectures of enzymes and construct a domain-centric network. In cellular organisms, the evolution of
metabolic systems is driven by the evolution of enzyme proteins. To study the evolution of metabolic systems, we
Despite the values of these studies, a principled approach to reconstruct the history of metabolic network evolu-
tion and a comprehensive categorization of its underlying mechanisms are yet to be established. Given the domain
architectures and catalytic functions of enzymes – domain-protein-reaction networks – in a number of extant species,
our goals are to (1)reconstruct the evolutionary history of these networks, (2)categorize the mechanisms of metabolic
system evolution in terms of network operations, (3)detect the enriched types of evolutionary mechanisms for each
pathway and relate the enriched evolutionary patterns with the functions of pathways. To fulfill these goals, we
propose an algorithm to reconstruct the domain-protein-reaction networks of ancestral species from observed data
that minimize the total number of network alterations along all lineages in the phylogeny. We confirm the accuracy
of the reconstruction algorithm by simulation studies and cross-validations on the real datasets. By applying the
inference algorithm to the domain-protein-reaction networks of 10 selected species including human, yeast and 8
microbes, we find that prokaryotes and eukaryotes share dominant evolutionary mechanisms in the early stage but
diverge substantially along each clade. Refined analysis indicates heterogeneous patterns of evolutionary mechanisms
for distinct metabolic pathways. For instance, while the pathways of steroid biosynthesis, steroid hormone biosynthe-
sis, protein kinases and glycosaminoglycan biosynthesis all contribute critically to metazoa-specific physiology, their
evolution of domain architectures and catalytic functions follows distinct patterns. Steroid biosynthesis is enriched
with reaction creations but retains a relatively conserved repertoire of proteins and domain architectures. Steroid
hormone biosynthesis has high rates of reaction creations and protein duplications but a normal rate of emerging
novel domain compositions. Protein kinases retain conserved reactions but possess many novel domains and proteins.
In contrast, glycosaminoglycan biosynthesis has high rates of reaction/protein creations and domain recruitments.
Finally we elicit and validate two general principles underlying the evolution of domain-protein-reaction networks.
The results shed new lights on the evolution of metabolic networks.
Methods
Data sources
Metabolic networks of 10 species were downloaded from BioCyc (Krummenacker et al. 2005). These species were
chosen for their relatively rich information about domain architectures and metabolic reactions. They belonged to
tier 2 databases, which were automatically generated and manually reviewed. All but one species are microbes: 7
prokaryotes and 3 eukaryotes including human. The majority of those species are either model organisms (human,
E. coli and S. cerevisiae) or pathogens (B. anthracis, H. pylori, M. tuberculosis, S. flexneri, V. cholerae, and P.
falciparum as malaria parasites). Along the eukaryotic lineage, human and yeast belong to metazoa (animal-fungus
group) and P. falciparum is a protist. Along the prokaryotic lineage, B. anthracis is a firmicute, M. tuberculosis is
an actinobacteria, whereas the remaining 5 species are all proteobacteria. We extracted the taxonomic hierarchies of
the 10 selected species from the NCBI Taxonomy Database
(http://www.ncbi.nlm.nih.gov/Taxonomy/). Intermediate nodes that had only one child in the hierarchies were
collapsed. The collapsed species tree consists of 10 terminal (extant) nodes and 7 ancestral nodes and is shown in
Figure 1.
2. Domain deletion. A domain node appears in the parent species but not in the child species.
3. Protein duplication. A protein in the parent species has multiple children in the child species.
4. Protein creation. A protein in the child species has no parent.
5. Protein deletion. A protein in the parent species has no child in the child species.
6. Reaction creation. A reaction node appears in the child species but not in the parent species.
7. Reaction deletion. A reaction node appears in the parent species but not in the child species.
8. Domain-protein edge addition. A domain-protein edge is absent in the parent species and present in the child
species.
9. Domain-protein edge deletion. A domain-protein edge is present in the parent species and absent in the child
species.
10. Protein-reaction edge addition. Similar to domain-protein edge addition.
11. Protein-reaction edge deletion. Similar to domain-protein edge deletion.
A parsimonious solution minimizes the total number of network changes between each parent-child species pair in
the phylogeny. This problem is difficult due to the diverse types of possible network operations. We cast it as a
constrained optimization problem. For each species, we define discrete variables pertaining to the features of the
evolutionary history H: the parent label of each protein, binary variables indicating whether each protein is valid
and each domain-protein or protein-reaction edge is present or absent, and additional auxiliary variables. The cost
function is the total number of network changes:
C =
∑
(s1,s2)∈TS
(# node creations + # node deletions + # protein duplications + # edge additions + # edge deletions).
(1)
Additional constraints are introduced to specify the relations of variables. For instance, a protein without a parent
is newly created.
To formulate the cost function and constraints, we define the following variables for each species s in the phylogeny:
– lspj : distinct label of protein pj. In this work we fixed l
s
pj
= j.
– aspj : parent label of protein pj . a
s
pj
= 0 if pj has no parent.
– pisdi,pj : a binary variable indicating the presence of a domain-protein edge (di, pj).
– pispj ,rk : a binary variable indicating the presence of a protein-reaction edge (pj , rk).
– vspj : a binary variable indicating that pj is newly created in s.
– µspj : a binary variable indicating that pj is a valid protein in s.
An instantiation of values of all these variables specifies an evolutionary history of DPR networks over a species tree
T . The total number of network changes in an evolutionary history is
C =
∑
(s1,s2)∈T
[
∑
j1∈s1
|
∑
j2∈s2
δ¯(ls1pj , a
s2
pj
)µs2pj2 − 1|µ
s1
pj1
+
∑
j2∈s2
vs2pj2
µs2pj2
+
∑
j2∈s2
vs2pj2
µs2pj2
(
∑
i pi
s2
di,pj2
+
∑
k pi
s2
pj2 ,rk
)+
∑
i,j1,j2
δ¯(ls1pj1 , l
s2
pj2
)δ(pis1di,pj1
, pis2di,pj2
)µs1pj1µ
s2
pj2
+
∑
j1,j2,k
δ¯(ls1pj1 , l
s2
pj2
)δ(pis1pj1 ,rk , pi
s2
pj2 ,rk
)µs1pj1µ
s2
pj2
].
(2)
algorithm was employed to find an approximate solution of maximum likelihood variable configurations of equation
4 (Kschischang, Frey and Loeliger 2001). In brief, message functions were defined over edges in the factor graph.
In each iteration, messages were updated according to the messages incident from neighbors. A variable → factor
message was the product of other messages incident to the variable. A factor → variable message was the max-
marginalization of the product of the factor and other messages incident to the factor. Message updates continued
until all variables converged. The belief function of a variable was the product of all messages incident to the
variable. The optimal configuration was obtained by iteratively fixing variables according to belief functions. Detailed
operations are explained in Kschischang, Frey and Loeliger 2001 and the Supplementary Text S1.
Simultaneous optimization of protein parent labels and edge presence poses a degeneracy problem due to the highly
under-constrained nature of the likelihood function. There exist a large number of optimal/suboptimal configurations,
and most of them are likely unrealistic. To alleviate this problem we partition the variables into two sets – protein
parent labels and edge presence – and iteratively fix one set of variables and infer the other until both converge.
The initial values of protein parent labels are obtained from the template phylogenetic relations of observed proteins
(gene trees) according to their sequences and domain compositions. The reconstruction algorithm is illustrated in
Figure 3 and elaborated in Supplementary Text S1.
The initial gene trees were employed to set the initial values of protein parent labels in the iterative algorithm. We
built initial gene trees with the following process. First, we extracted unique domain compositions from all proteins
and generated their phylogenetic trees. The presence or absence of each domain composition in each ancestral species
was inferred from the observed data in extant species using dynamic programming. We assume that a unique domain
composition arises only once in evolution, similar domain compositions are phylogenetically close, and one domain
composition can derive another if the former arises prior to the latter. Following these assumptions we employed an
incremental tree merging heuristic to build phylogenetic trees of domain compositions. In each (extant or ancestral)
species, we kept the domain compositions which first appeared in the species. Starting from the root of the species
tree, we then incrementally joined domain compositions in a species to the phylogenetic trees of domain compositions
inherited from the parent species.
Second, we collected proteins with each unique domain composition and constructed their phylogenetic tree by a
hierarchical clustering algorithm (Press et al. 2007). To simplify the problem, we defined the pairwise distance between
two proteins as the Hamming distance between their aligned sequences. The protein tree associated with a domain
composition was attached under its node in the domain composition trees. The results were merged phylogenetic
trees of domain compositions and proteins.
Third, the merged phylogenetic trees of domain compositions and proteins were reconciled with the species tree.
To simplify the factor graph model, we collapsed subtrees within a species into flat structures. Consequently, the
species of a parent-child pair in the protein trees were also a parent-child pair in the species tree.
We treated the presence/absence of each domain or reaction in each ancestral species as a binary variable with
hidden values. Parsimony demands that a domain or reaction is created once in the evolutionary history and the
edges, (2)domain-protein pairs that were not edges, (3)protein-reaction edges, (4)protein-reaction pairs that were
not edges. We then removed the information of the test set from the training data and built the factor graph model.
The max-product algorithm imputed the DPR networks in the ancestral species as well as the presence/absence of
these pairs in the test set. Dynamic programming was again employed as the benchmark method. The sensitivity
(# correct predictions on edges/# edges in the test set) and specificity (# correct predictions on non-edges/# non-
edges in the test set) were measured from the outcomes of 100 random trials. To avoid selection bias we equalized the
numbers of positive and negative instances and varied the fraction of test set size with respect to the total number of
edges from 0.1 to 0.5. The experimental procedures of both simulation studies and cross validations are elaborated
in Supplementary Text S1.
Evaluating the contributions of network changes
We proposed two methods to gauge the contribution of each type of network change mechanisms in the evolutionary
history of a DPR subnetwork. The first method hypothesized that each event of network changes followed a multino-
mial distribution, and the probability for each type of network changes was invariant along the species tree. Denote
pi the multinomial probability for type i changes (i = 1, · · · , 11) conditioned on a network change event. Denote l
the index of a branch of T and nli the number of network change events of type i along branch l. The likelihood of
the network change events is
L =
∏
l
(
Nl
nl
1
···nl
11
)∏11
i=1 p
nli
i . (5)
where Nl =
∑11
i=1 n
l
i,
(
Nl
nl
1
···nl
11
)
≡ Nl!Q11
i=1
nl
i
!
, and
∑11
i=1 pi = 1. Differentiating equation 5 with respect to each pi yields
maximum likelihood estimators:
pˆi =
1
N
∑
l n
l
i, (6)
where N =
∑11
i=1
∑
l n
l
i.
The second method hypothesized that the probability for each type of network changes along a branch was
proportional to the product of the branch-specific probability derived from the entire metabolic network and the
branch-independent reweighting factor within a subnetwork:
γli =
rliqiP
11
j=1
rl
j
qj
, ∀i, (7)
where rli denotes the probability of type i changes along branch l of the entire network, qi the reweighting factor
of type i change on the subnetwork, and γli the probability of type i change along branch l of the subnetwork. r
l
i is
proportional to the total number of type i changes along branch l. The optimal reweighting factors qˆi were obtained
by differentiating equation 7 with a normalization constraint
∑11
i=1 qi = 1.
To know whether a specific type of network changes was enriched in a pathway, we quantified the statistical
significance of each pˆi and qˆi conditioned on the distribution from the entire metabolic network. We randomly
sampled reactions with the same size as the target pathway and calculated the contribution probabilities pi and
reweighting factors qi on random sets. The p-value was the fraction of random trials whose pi or qi exceeded the
The bottom part of Figure 4 shows the mean error rates for 4 types of pairs and the aggregate error rates
with varying sizes of test sets. Intriguingly, max-product and dynamic programming exhibit opposite patterns of
mean error rates. Max-product achieves 82-90% sensitivity (accuracy on edges) and 82-88% specificity (accuracy
on non-edges) on domain-protein pairs, and 60-71% sensitivity and 82-87% specificity on protein-reaction pairs. In
contrast, dynamic programming achieves 73-85% sensitivity and 92-95% specificity on domain-protein pairs, and
25-38% sensitivity and near 100% specificity in protein-reaction pairs. Overall, max-product has higher sensitivity
but lower specificity than dynamic programming. However, max-product has less mistakes on negative instances than
dynamic programming on positive instances, resulting in superior overall accuracy rates (78-83% versus 72-78%).
Furthermore, protein-reaction pairs yield substantially worse error rates than domain-protein pairs. The error rates
of both methods are relatively robust against the test set sizes.
Evolutionary history of domain-protein-reaction networks
Table 1 reports the summary information of the DPR networks of the 10 extant species, Figure 1 shows their
phylogenetic tree, and Figure 5 reports the summary of network evolution overlayed on their species tree. The network
sizes of these species are positively correlated with their total numbers of genes (R2 = 0.7365, Supplementary Figure
S3). Human has a considerably larger network and proteome than all the other species. Furthermore, E. coli has a
disproportionally large network but comparable proteome size with other microbes. For instance, the network size
and gene number of E. coli are 7517 and 4200, whereas those of V. cholerae are 4378 and 3828 respectively. Since
gene function annotations in most species are far from complete, the disparity of network sizes is likely due to paucity
of information on other microbes rather than expansion of E. coli networks during evolution.
We applied the max-product algorithm to reconstruct the evolutionary history of the DPR networks of selected
species. Figure 5 summarizes the information of the evolution of the entire networks. The total numbers of network
changes along each branch of the species tree and their contributions among distinct types of changes provide the
following insights regarding the evolution of metabolic networks.
First, the common ancestor of cellular organisms (taxid 131567) possesses a smaller network (network size 3351)
than human (network size 11136), E. coli (network size 7517) and most other extant species. This is sensible since
the network of the eukaryote-prokaryote common ancestor constitutes the conserved core of metabolic systems
(Morowitz 1999, Peregrin-Alves, Tsoka and Ouzounis 2003) and thus should be smaller than its derived descendants.
Moreover, in spite of the disparate gaps of total network sizes, the majority of domains and reactions in eukaryotes
and prokaryotes already appear in their common ancestor. The cellular organism common ancestor contains 797
domains and 930 reactions, whereas human has 1112 domains and 1330 reactions, and E. coli has 960 domains
and 1334 reactions respectively. The network size differences are primarily attributed to proteins, domain-protein
and protein-reaction edges. Concordant with the findings in (Chothia et al. 2003), the results suggest that most
elementary components of metabolic systems (reactions and domains fulfilling certain catalytic functions) arise
before the eukaryote/prokaryote split. Complexity of the systems accrues by protein duplications, recombinations of
domain compositions, and reassignments of catalytic functions to orthologous and paralogous proteins.
enzymes to catalyze multiple reactions (pleiotropic). A similar conclusion was reached in the study by Freilich et al.
(Freilich et al. 2005).
Mechanisms of network evolution in distinct metabolic processes
In addition to the global summary on the evolutionary history of the entire metabolic networks, it is also important
to understand the evolution of the DPR networks of individual metabolic pathways. We are interested in finding
the enriched types of network change mechanisms for individual pathways, conditioned on the global trend from the
entire networks. To fulfill this goal, we developed two methods to quantify the significance of evolutionary mechanism
enrichments on specific pathways. The first method evaluated the contributions of each type of network change
mechanisms. By assuming each event was sampled from a multinomial distribution, we calculated the probability
of each type of network changes that maximized the likelihood over the species tree. The second method calculated
the reweighting factors relative to the contributions derived from the entire metabolic networks. The multinomial
probability for each type of network change mechanisms was the product of the global contribution and the pathway-
specific reweighting factor. The p-values were evaluated by comparing the contributions or reweighting factors of the
empirical data with the results generated by randomly selected reactions. The consensus of enriched network change
mechanisms obtained by both methods were reported.
386 and 750 metabolic pathways were downloaded from KEGG (Kanehisa and Goto 2000) and BioCyc (Krum-
menacker et al. 2005) databases respectively, and their DPR subnetworks on the species tree were extracted. We
identified the enriched evolutionary mechanisms for each pathway and categorized them into six disjoint classes:
1. Protein duplication Protein duplications are enriched, and protein-reaction edge additions are possibly enriched.
Other expansion mechanisms – domain creations, protein and reaction creations, domain-protein edge additions
– are not enriched.
2. Protein deletion Protein deletions are enriched, and none of the expansion mechanisms are enriched.
3. Reaction creation Reaction creations are enriched, and protein-reaction edge additions are possibly enriched.
Other expansion mechanisms (including protein duplications) are not enriched.
4. Protein duplication and reaction creation Protein duplications and reaction creations are both enriched, and
protein-reaction edge additions are possibly enriched. Other expansion mechanisms are not enriched.
5. Novel domain or protein generation Domain creations, protein creations or domain-protein edge additions are
enriched. Reaction creations are not enriched.
6. Novel domain or protein generation and reaction creation Domain creations, protein creations or domain-protein
edge additions are enriched. Reaction creations are enriched.
This categorization reflects a decreasing level of conservation in metabolic pathway evolution. In classes 1 and 2, the
rates of increasing the repertoire of domain combinations and reactions do not exceed the background values of the
entire networks. In class 3, reaction creations are accelerated relative to the background values, but the expansion
of proteins is not. In class 4, accelerated reaction creations are accompanied with frequent protein duplications. In
class 5, there is an increasing rate of generating novel domain compositions, but the rate of reaction creations does
they are involved in the metabolism of environmental toxins (dioxins, polycyclic aromatic hydrocarbons) and other
metabolites (nicotinates and alkaloids).
Supplementary Figure S5 visualizes the DPR subnetwork evolution on nicotinate and nicotinnamide metabolism.
The common ancestor of cellular organisms contains the majority of proteins (21) and reactions (25) in the pathway.
Major protein duplications occur from the common ancestor of cellular organisms to that of prokaryotes (18 protein
duplications) and from the ancestor of the fungus/animal group to human (18 protein duplications). Consequently,
there are 30 proteins in human and 26 proteins in E. coli. Yet the subnetworks shrink considerably in A. tumefaciens
(5 proteins), B. anthracis (5 proteins), H. pylori (4 proteins), and P. falciparum (5 proteins). Thus frequent protein
deletions are observed along these branches.
Class 3 consists of 10 pathways. They have excessive numbers of reaction creations, while the rates of changes on
enzyme proteins and domain compositions do not exceed the background rates. Neofunctionization – novel reactions
are catalyzed by conserved proteins – may explain the patterns on these pathways. Class 3 includes pathways involved
in carbohydrate and lipid metabolism, xenobiotics degradation, and carbon-phosphorous compound metabolism.
Among them steroid biosynthesis is almost restricted to eukaryotes (Ourisson and Nakatani 1994), and sphingolipid
metabolism occurs primarily in eukaryotes (Pruett et al. 2008).
The steroid biosynthesis pathway in Supplementary Figure S6 demonstrates a remarkable example of class 3
patterns. Steroids are precursors of many signaling molecules in animals, plants and fungi. One the one hand, the
majority of reactions are created along the branch from the ancestor of the fungus/animal group to human (43 of 49
human reactions are newly created). On the other hand, most of the enzymes in the human subnetwork have origins
in the common ancestor of cellular organisms. There are 11 proteins in the common ancestor of cellular organisms
and 17 proteins in human. From the root to human, there are only 4 domain creations, 5 protein creations, and 6
protein duplications. By examining the enzymes of steroid biosynthesis in human, we found most of their domains
arose before the eukaryote/prokaryote split. For instance, squalene monooxygenase catalyzes the first oxygenation
step in sterol biosynthesis (Squalene → (S)-Squalene-2,3-epoxide, EC number 1.14.99.7) (Laden, Tang and Porter
2000). It consists of two domains: PF01266 (FAD dependent oxidoreductase) and PF08491 (Squalene epoxidase).
PF01266 also appears in cholesterol oxidase of M. tuberculosis (Bryzostek et al. 2007), suggesting that squalene
monooxygenase may have an ancient origin.
Class 4 consists of two pathways: steroid hormone biosynthesis and retinol metabolism. These pathways have
high rates of protein duplications, reaction creations and protein-reaction edge additions. Retinol is an animal form
of vitamin A, and steroid hormones appear in animals. Hence the majority of the reactions in these pathways arise
along the branch from the fungus/animal group to human. Unlike class 3, these two pathways have frequent protein
duplications along the human lineage.
The steroid hormone biosynthesis pathway in Supplementary Figure S7 provides an illustrative example of class
4 patterns. The subnetwork in human comprises 24 domains, 75 proteins and 27 reactions, whereas the subnetwork
of the common ancestor of cellular organisms comprises 24 domains, 9 proteins and 2 reactions. From the root to hu-
man, there are 2 domain creations, 4 protein creations , 25 reaction creations and 82 protein duplications. Duplicated
reactions of glycans and glycosaminoglycans are highly overlapped and specific in the human lineage. In contrast,
biosynthesis reactions of alkaloids are present in all the species surveyed.
Supplementary Figure S11 visualizes the DPR subnetwork evolution on glycosaminoglycan biosynthesis. The
majority of proteins and reactions arise along the human lineage. There are 6 domains, 4 proteins and 1 reaction
in the common ancestor of cellular organisms, 12 domains, 23 proteins and 25 reactions in human, and 4 domains,
1 protein and 4 reactions in E. coli. From the fungus/animal group ancestor to human, there are frequent domain
creations (6), protein duplications (21), reaction creations (21), domain-protein edge additions (21) and protein-
reaction edge additions (117). Hence the entire apparatus of glycosaminoglycan biosynthesis is established after
the emergence of animals. Glycosaminoglycans form an essential component of connective tissues, and may bind to
proteins to form proteoglycans, which play important roles in cell adhesion and cellular matrix formation, signal
transduction and immune response (Gabius 1997). Diverse varieties of protein kinases and proteoglycans are both
hallmarks of complex multicellular organisms. Metabolism of both families is catalyzed by novel domain compositions.
Yet protein phosphorylations/dephosphorylations involve in a small number of highly conserved reactions, whereas
glycan biosynthesis requires novel reactions arising after the emergence of multicellular organisms.
Principles underlying the evolution of domain-protein-reaction networks
A DPR network consists of two types of information pertaining to enzyme proteins: their domain architectures and
catalytic functions. Intuitively, these two aspects should be tightly coupled. Yet it remains unclear whether this
intuition can be systematically substantiated from the evolutionary history of DPR networks. Here we describe two
quantitative principles linking the evolution of domain architectures and catalytic functions of enzymes.
Protein duplications are a dominant mechanism of network changes. Many proteins have homologous counterparts
with similar or identical domain compositions in multiple species. It is sensible to assume that these duplicated
proteins perform similar functions. To verify this hypothesis, we examined the reactions catalyzed by groups of
homologous proteins. We divided the 8069 enzymes in the 10 species into 891 families. Each family had a disjoint
protein tree from the inferred evolutionary history of the DPR networks, thus consisted of orthologous and paralogous
proteins. We extracted the EC numbers of reactions catalyzed by proteins in each family. Each EC number consisted of
4 digits representing numerical classes of more refined levels. Thus reactions sharing more EC digits were functionally
more similar. For each protein family, we examined the first two EC digits of the catalyzed reactions and identified
the dominant EC subclass containing the largest number of reactions. We then calculated the fraction of reactions
belonging to the dominant EC subclass in each protein family and showed its distribution in the left part of Figure
6. As anticipated, the majority of the protein families were dominated by one EC subclass. Among the 787 protein
families with known EC numbers, 568 of them (72.17%) were dominated by one EC subclass (more than 90% of the
reactions belonged to the same EC subclass). The results confirm functional similarity of duplicated proteins.
Domain creations are less frequent than protein duplications but still comprise a conspicuous portion of DPR
network evolution. Although there are novel domains evolved to catalyze conserved reactions (for instance, kinases
along the eukaryotes lineage), we suspect that the majority of novel domains arise to satisfy new catalytic demands.
transduction, cell-cell communication, and extracellular matrix formation. Intriguingly, multiple pathways involved
in cell-cell communication and signaling possess distinct patterns of evolutionary mechanisms. Steroid biosynthesis
has enriched reaction creations but retains a relatively conserved repertoire of domain compositions and proteins.
Steroid hormone biosynthesis has a high rate of reaction creations and protein duplications. Protein kinases possess
many domain and protein creations but retain conserved reactions. Glycosaminoglycan biosynthesis has a high rate
of protein and reaction creations and domain recruitments.
Certain types of evolutionary mechanisms are excluded from the analysis due to the bias of observed data and
the limitation of the reconstruction algorithm. Human and E. coli have nearly complete annotations of metabolic
networks, whereas the metabolic network information of the remaining 8 species – including S. cerevisiae – is much
more sparse. As negative information (absence of nodes or edges) is not explicitly annotated, it is impossible to
distinguish deletion events from missing links. We suspect that most of the inferred deletion events from a well
annotated network (such as the common ancestor of human and E. coli) to a poorly annotated network (such as
P. falciparum) are probably attributed to missing information. To avoid this confusion we discard deletion events
in most of our analysis. Nevertheless, this exclusion also prevents possible detection of real deletion events. Better
annotations on the metabolic networks of the sampled species are required for a reliable detection of deletion events.
Our reconstruction algorithm hypothesizes that each protein is either newly created or inherited from one protein
in the parent species. This simplified model ignores complex evolutionary mechanisms such as protein fusion and
horizontal gene transfer. A fused protein is inherited from multiple parents thus violates the underlying assumption
of the model. Yet one can treat a fusion event as one protein inheritance event plus one or multiple events of
domain recruitments. For instance, suppose protein C is fused from proteins A and B, which contain domains
d1 and d2 respectively. The fusion event A → C ← B can be replaced by an inheritance event A → C plus a
domain-protein edge addition event d1 + d2 → d1d2. Thus fusion events can be at least partially uncovered from the
reconstructed evolutionary history. Fission events do not violate the model assumption thus can be uncovered from
the reconstruction as well.
Horizontal gene transfers (HGT) pose a greater challenge to reconstruction algorithms. A protein-coding gene
can be possibly transferred from another species which is remotely related to the host species. Hence there is a much
greater degree of freedom in choosing the parent of each protein. Restrictions on the species labels of parent proteins
can be at least in principle relaxed in the factor graph formulation (equation 1) to cover HGTs. However, both
model complexity and computing time will increase drastically, and the problem of model degeneracy will become
more serious. External information such as insertion or plasmid sequences is required in order to narrow down the
candidate sources of HGTs.
The dataset in this analysis is biased toward bacteria (7 of 10 extant species). To acquire a more comprehensive
picture of metabolic network evolution, we plan to include species in archaea and plants and to add more animal
species (vertebrates and mammals in particular) in the extended dataset. Analysis based on the extended dataset
will address important questions such as the evolutionary history of photosynthesis in plants and microbes, anaerobic
respiration in archaea, and a more detailed characterization of the evolution of human metabolic networks.
Publications
Reconstruction of the evolutionary history of domain-protein-reaction networks in metabolic systems. Submitted to
the 16th Annual International Conference on Research in Computational Molecular Biology (RECOMB 2012).
Evolution of domain architectures and catalytic functions of enzymes in metabolic systems. Submitted to PLoS
Computational Biology.
References
1. Apic G., Gough J., Teichmann S.A.: Domain combinations in archaeal, eubacterial and eukaryotic proteomes J.
Mol. Biol. 2001, 310:311-325.
2. Bateman A., Birney E., Cerruti L. Durbin R., Etwiller L, Eddy S.R., Griffiths-Jones S., Howe K.L., Marshall M., Sonnham-
mer E.L.: The Pfam protein families database. Nucleic Acids Res. 2002, 30(1):276-280.
3. Borenstein E., Kupiec M., Feldman M.W., Ruppin E.: Large-scale reconstruction and phylogenetic analysis of
metabolic environments. Proc. Natl. Acad. Sci. U.S.A. 2008, 105:14482-14487.
4. Bryzostek A., Dziadek B., Rumijowska-Galewicz A., Pawelczyk J., Dziadek J.: Cholesterol oxidase is required for
virulence of Mycobacterium tuberculosis. FEMS Microbiol. Lett. 2007, 275(1):106-112.
5. Caetano-Anolles G. and Caetano-Anolles D.: An evolutionarily structured universe of protein architecture.
Genome Res. 2003, 13:1563-1571.
6. Caetano-Anolles G., Yafremava L.S., Gee H., Caetano-Anolles D., Kim H.S. and Mittenthal J.E.: The origin and evolu-
tion of modern metabolism. Intl. J. Biochem. & Cell Biol. 2009, 41:285-297.
7. Chothia C., Gough J., Vogel C., Teichmann S.A.: Evolution of the protein repertoire. Science 2003, 5626:1701-1703.
8. Felsenstein J.: Evolutionary tree from DNA sequences: a maximum likelihood approach. J. Mol. Evol. 1981,
17:368-376.
9. Fong J.H., Geer L.Y., Pachenko A.R., Bryant S.H.: Modeling the evolution of protein domain architectures using
maximum parsimony. J. Mol. Biol. 2007, 366:307-315.
10. Freilich S., Spriggs R.V., George R.A., Al-Lazikani B., Swindells M., Thornton J.M.: The complement of enzymatic
sets in different species. J. Mol. Biol. 2005, 349(4):745-763.
11. Freilich S., Goldovsky L., Ouzounis C.A., Thornton J.M.: Metabolic innovations towards the human lineage. BMC
Evolutionary Biol. 2008, 8:247.
12. Gabius H.L.: Glycosciences: Status and Perspectives. 1997, Chapman & Hall, London, UK.
13. Gu J. and Gu X.: Natural history and functional divergence of protein tyrosine kinases. Gene 2003, 317:49-57.
14. Hein J.: Reconstructing evolution of sequences subject to recombination using parsimony.Math. Biosci. 1990,
98:185-200.
15. Kaessmann H., Zollner S., Nekrutenko A. and Li W.H.: Signatures of domain shuﬄing in the human genome.
Genome Res. 2002, 12:1642-1650.
16. Kanehisa M. and Goto S.: KEGG: Kyoto Encyclopedia of Genes and Genomes. Nucleic Acids Res. 2000, 28:27-30.
17. Kschischang F., Frey B., Loeliger H.: Factor graphs and the sum-product algorithm. IEEE Trans. Inform. Theory
2001, 47:498-519.
39. Yeang C.H. and Baas N.: Evolution of domain compositions in the metabolic networks of human and Es-
cherichia coli. Proc. World Congress in Computer Science, Computer Engineering and Applied Computing (WORLD-
COMP) 2009.
Fig. 3. Schematic of the DPR network reconstruction algorithm. A collection of protein trees are inferred from their
domain compositions and sequences alone. These protein trees set the initial values of protein lineage variables. With
observed DPR networks in the contemporary species as inputs, the max-product algorithm is iteratively applied to
infer the values of one set of variables (e.g., domain-protein and protein-reaction edges) by fixing the values of the
other set of variables (e.g., protein lineages). Iteration continues until all variable values converge. The converged
variable configuration is post-processed to generate the inferred evolutionary history.
Fig. 5. Summary of metabolic network evolution of 10 species. The topology of the phylogenetic tree (shown by
blue lines) is extracted from the NCBI taxonomy. Each node represents a contemporary or ancestral species marked
with its taxnomy name and id. Vertical positions of nodes denote the total sizes of their DPR networks (node
number + edge number). Horizontal distances between two adjacent nodes denote the total numbers of network
change events between the adjacent species pairs. The compositions (contributions) of network change types between
each pair of adjacent species nodes are visualized as pie charts and placed along their edges. Prominent network
change mechanisms include protein duplications (medium blue), protein deletions (light blue), protein-reaction edge
additions (red), domain-protein edge additions (orange), reaction creations (light green), and domain creations (dark
blue).
Fig. 6. General rules relating domains and reactions in the DPR networks. Left: Distribution of the fraction of
reactions in the dominant EC class among all protein family. Horizontal axis: fraction of reactions in the dominant
EC class. Vertical axis: distribution of the reaction fraction among all protein families. Right: Scattered plot of the
numbers of domain creations and reaction creations along each branch of the species tree.
0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
fraction of reactions in the dominant EC class
di
st
rib
ut
io
n
0 50 100 150 200 250 300 350 400
0
100
200
300
400
500
600
# domain creations
# 
re
ac
tio
n 
cr
ea
tio
ns
Table 2. Six categories of metabolic network evolution and their constituent patways
category pathway pathway
protein duplication glycolysis TCA cycle
pentose phosphorylation pyruvate metabolism
propanoate metabolism Entner-Doudoroff pathway
sucrose degradation alanine, aspartate and glutamate metabolism
glycine, serine and threonine metabolism valine, leucine and isoleucine metabolism
lysine metabolism selenoamino acid metabolism
aspartate and asparagine metabolism methionine and homoserine metabolism
citrulline metabolism arginine, putrescine and 4-aminobutyate metabolism
serine-isocitrate lyase pathway fatty acid metabolism
histidine, purine and pyrimidine biosynthesis xenobiotics metabolism by cytochrome P450
colanic acid metabolism folate interversions
formaldehyde assimilation
protein deletion tyrosine & tryptophan biosynthesis naphthalene degradation
electron transport biosynthesis of unsaturated fatty acids
dioxin degradation nicotinate & nicotinnamide metabolism
tropane piperidine/pyridine alkaloid synthesis polycyclic aromatic hydrocarbon degradation
reaction creation pentose & glucuronate interconversions fructose & mannose metabolism
ascorbate & aldarate metabolism steroid biosynthesis
sphingolipid metabolism bisphenol degradation
benzoate degradation xylene degradation
aromatic compound degradation phospnonate & phosphinate metabolism
protein duplication and steroid hormone biosynthesis retinol metabolism
reaction creation
novel domain or C5-branched dibasic acid metabolism phosphatidylinositol signaling system
protein generation methane metabolism riboflavin metabolism
atrazine degradation kinases
mTOR signaling pathway terpenoid backbone biosynthesis
ribose & deoxyribose phosphate degradation tetrahydrofolate biosynthesis
chorismate biosynthesis phosphatidic acid & phospholipid biosynthesis
glycerophospholipid metabolism fatty acid elongation
novel domain/protein biosynthesis of alkaloids glycan/glycosaminoglycan biosynthesis
and reaction creation
Algorithm for reconstructing the domain-protein-reaction networks
A factor graph model for parsimonious reconstruction
We define a domain-protein-reaction network (abbreviated as a DPR network) as a two-layered graph G = (VD ∪
VP ∪ VR, EDP ∪ EPR) consisting of three types of nodes – domain families VD, proteins VP and reactions VR – and
two types of edges – domain-protein edges EDP and protein-reaction edges EPR. A domain-protein pair (d, p) ∈ EDP
is adjacent in G if domain d appears in protein p. A protein-reaction pair (p, r) ∈ EPR is adjacent in G if protein p
catalyzes reaction r.
We define an evolutionary history over a phylogeny TS as a tuple H = {G,Pa}. G ≡ {s ∈ TS |Gs} denotes the
collection of the DPR networksfor all species in TS , whereGs is the DPR network of species s. Pa ≡ (
⋃
s∈TS
VP (Gs))×
(
⋃
s∈TS
VP (Gs) ∪ φ) maps each protein p to its parent Pa(p). Pa(p) = φ if p is newly created and has no parent.
A reconstruction algorithm takes phylogeny TS and contemporary DPR networks {s ∈ S|Gs} as inputs and returns
an evolutionary history H. The following missing information has to be imputed: (1)domains, proteins and reactions
of each ancestral species, (2)domain-protein and protein-reaction edges in the ancestral species, (3)the parents of all
proteins in each species.
A parsimonious principle is employed to minimize the total number of network changes over the evolutionary
history. Between the DPR networks of a parent-child pair in the species tree T , there are 11 types of network changes:
1. Domain creation. A domain node appears in the child species but not in the parent species.
2. Domain deletion. A domain node appears in the parent species but not in the child species.
3. Protein duplication. A protein in the parent species has multiple children in the child species.
4. Protein creation. A protein in the child species has no parent.
5. Protein deletion. A protein in the parent species has no child in the child species.
6. Reaction creation. A reaction node appears in the child species but not in the parent species.
7. Reaction deletion. A reaction node appears in the parent species but not in the child species.
8. Domain-protein edge addition. A domain-protein edge is absent in the parent species and present in the child
species.
9. Domain-protein edge deletion. A domain-protein edge is present in the parent species and absent in the child
species.
10. Protein-reaction edge addition. Similar to domain-protein edge addition.
11. Protein-reaction edge deletion. Similar to domain-protein edge deletion.
Minimization of the total number of network changes is translated into a constrained optimization problem. For a
species s define the following variables:
– lspj : distinct label of protein pj. In this work we fixed l
s
pj
= j.
– aspj : parent label of protein pj . a
s
pj
= 0 if pj has no parent.
– pisdi,pj : a binary variable indicating the presence of a domain-protein edge (di, pj).
In a factor graph formulation, the joint probability function
P (X) =
∏
i fi(Xi) (3)
is represented as a bipartite graph G = (VX ∪ VF , E). Here X denotes the collection of all random variables. fi
denotes the ith factor and Xi ⊆ X denotes the arguments in fi. G consists of variable nodes VX and factor nodes
XF . A variable-factor pair (x, f) is adjacent in G if x is an argument in f .
To translate the constraint-optimization problem into an inference problem of factor graphs, additive terms in the
cost function need to be converted into multiplicative terms in the joint probability function, and cost minimization
is converted to likelihood maximization. This coversion can be achieved by exponentiating the negation of each cost
term. For terms 2-6, this translation is straightforward. For each adjacent species pair (s1, s2) ∈ T , we define the
following factors according to each term.
f
(s1,s2)
3 (v
s2
pj2
, µs2pj2
) = e
−vs2pj2
µs2pj2 .
f
(s1,s2)
4 (v
s2
pj2
, pis2di,pj2
, µs2pj2
) = e
−vs2pj2
pi
s2
di,pj2
µs2pj2 .
f
(s1,s2)
5 (v
s2
pj2
, pis2pj2 ,rk
, µs2pj2
) = e
−vs2pj2
pis2pj2 ,rk
µs2pj2 .
f
(s1,s2)
6 (l
s1
pj1
, as2pj2
, pis1di,pj1
, pis2di,pj2
, µs1pj1
, µs2pj2
) = e
−δ¯(ls1pj1
,ls2pj2
)δ(pi
s1
di,pj1
,pi
s2
di,pj2
)µs1pj1
µs2pj2 .
f
(s1,s2)
7 (l
s1
pj1
, as2pj2
, pis1pj1 ,rk
, pis2pj2 ,rk
, µs1pj1
, µs2pj2
) = e
−δ¯(ls1pj1
,ls2pj2
)δ(pis1pj1 ,rk
,pis2pj2 ,rk
)µs1pj1
µs2pj2 .
(4)
Direct exponentiation of term 1 is inadequate as the factor consists of the parent labels of all proteins in s2 in a com-
plicated form. Instead, we introduce an auxiliary variable γj1,j2 for each pair of proteins pj1 and pj2 in s1 and s2. γj1,j2
indicates that whether pj2 is valid and the parent of pj2 is pj1 . Thus, we introduce a factor f
(s1,s2)
1 (l
s1
pj1
, as2pj2
, µs2pj2
, γj1,j2)
for each protein pair (pj1 , pj2).
f
(s1,s2)
1 (l
s1
pj1
, as2pj2
, µs2pj2
, γj1,j2) =


1 if γj1,j2 = δ¯(l
s1
pj1
, as2pj2
)µs2pj2 .
0 otherwise.
(5)
We then express the total number of deletion or duplications of protein pj1 in s2 in terms of γj1,j2 and exponentiate
the cost term.
f
(s1,s2)
2 (γj1,1, · · · , γj1,M , µ
s1
pj1
) = e
−|(
P
j2
γj1,j2 )−1|µ
s1
pj1 . (6)
In addition to the parsimony cost, we also express constraints in equation 2 as factor terms. A constraint factor
returns 1 if the variables satisfy the constraint and 0 otherwise. Consequently, the three constraints in equation 2
(b) Update a factor → variable message mf→x(x) according to the following equation.
mf→x(x) = maxc∈C(N(f)\x) f(N(f))
∏
y∈N(f)\xmy→f (y). (11)
where N(f) denotes neighbors of f in G. A factor → variable message is the max-marginalization of the
product of the factor function and messages incident to the factor (except the one from the destination
variable).
3. The belief function of each variable is the product of messages incident to the variable.
b(x) ∝
∏
f∈N(x)mf→x(x). (12)
After normalization, the belief function b(x) is the estimated max-marginal probability Pmax(x).
We apply max-product iteratively to find a configuration that maximizes the likelihood function.
1. Leave all variables unfixed.
2. Repeat the following steps until all variables are fixed.
(a) Conditioned on the values of the fixed variables, apply max-product to evaluate the belief function of each
remaining variable.
(b) If the belief function of a variable is biased toward a specific value (b(x = c) > b(x = c′)∀c′ 6= c), then fix the
variable to the biased value (x← c).
Building the initial protein trees
Max-product does not guarantee to find an optimal solution in loopy graphs. Direct application of max-product to
equation 8 yields a degeneracy problem due to the large degree of freedom in the model. There are many unrealistic
configurations that yield optimal or suboptimal likelihood scores. Therefore, the selection of the initial configurations
becomes critical. We want to feed the algorithm with an initial configuration of parent labels (i.e., the gene trees of
observed proteins) that is close to the optimal solution. To achieve this goal we exploit the domain architectures and
sequences of observed proteins and attempt to build reasonable protein trees as the initial configurations.
We build the initial protein trees using a four-stage heuristic. In the first stage we build the phylogenetic trees
of all domain architectures appeared in the observed proteins. In the second stage we build a phylogenetic tree for
each family of proteins with an identical domain architecture. In the third stage we attach the protein tree in each
family under the tree of domain architectures. Finally we reconcile the species tree and protein trees to ensure that
the protein tree topologies respect the species tree topology.
Building the phylogenetic trees of domain architectures A phylogenetic tree of domain architectures should
conform with the following properties.
1. Each domain architecture arises only once in evolution.
Reconciling protein trees with the species tree Conventionally, reconciliation denotes labeling nodes in the
gene tree as a node in the species tree, such that the labeled gene tree topology respects that of the species tree [2].
Here we denote reconciliation as a transformation R : TP → TP ′ to convert a protein tree TP to another protein tree
TP ′ such that the following conditions hold.
1. A parent-child pair (p1, p2) in TP is mapped to either a parent-child pair in TP ′ or a single node in TP ′ .
2. Conversely, a parent-child pair (q1, q2) in TP ′ is inversely mapped to a path in TP . A parent-child pair is a special
case of a path.
3. For each parent-child pair (q1, q2) ∈ TP ′ , the species of q1 is a parent of the species of q2 in the species tree T .
The transformed protein tree has a desirable property for parsimony maximization. It restricts the parent protein
in the parent species of the child protein. Therefore, we can represent the parent of a protein with one number (the
parent label aspj ) without having to specify its species. This simplification drastically reduces the dimension of the
factor graph model. Nevertheless, the price of this simplification is the failure to capture horizontal gene transfers.
We build the transformation R with the following procedures. First, all nodes in the protein tree are given species
labels according to canonical reconciliation algorithms (e.g., [2]). Second, if all nodes of a sub protein tree possess
the same terminal species label, then find the parent of the subtree root. Connect terminal proteins to the parent
of the subtree root and discard all the intermediate nodes in the subtree. Third, if all nodes of a sub protein tree
possess the same intermediate species label, then collapse all nodes in the subtree into the root of the subtree.
Iterative algorithm for reconstruction
Using the template protein trees and the max-product algorithm, we develop an iterative algorithm to reconstruct
the evolutionary history of the DPR networks. Briefly, we divide variables into two groups: parent labels and edge
presence, and alternatively fix one group and optimize another. Iterations continue until all fixed variables are
stablized.
1. Build the template protein trees using domain architectures and sequences of proteins. Use the template protein
trees to set the initial values of protein parent labels.
2. Alternate between the following two optimization procedures.
(a) Fix the parent labels of all proteins. Apply max-product iteratively to fix the variables of edge presence, new
protein and valid protein indicators.
(b) Fix all domain-protein and protein-reaction edges. Apply max-product iteratively to fix the variables of
parent labels, new protein and valid protein indicators.
3. Stop alternations when the evolutionary history of DPR networks derived from the fixed variable values becomes
stationary. In other words, stop when the fixed values of all variables equal to their fixed values in the preceding
step.
4. Convert the inferred variable configuration into the reconstructed evolutionary history of DPR networks.
– Protein-reaction edge additions. Probability 8/52.
– Protein-reaction edge deletions. Probability 8/52.
For each alteration, sample the type of change according to the aforementioned probabilities. Conditioned on
each type of change, random add/remove a node or an edge in the network.
We assume that the observed data are incomplete and noisy. Only the DPR networks of the leaf species are revealed
to the reconstruction algorithm. Furthermore, the initial protein trees to the reconstruction algorithm are generated
by randomly perturbing the simulated protein trees with the following types of changes.
– Reassign the parent of a protein. Probability 16/21.
– Add a “spurious” intermediate protein node and assign its parents and children. Probability 4/21.
– Remeove a protein from the simulated protein trees. Probability 1/21.
The total number of perturbation events along the protein trees is the product of the number of species nodes, the
average number of edges in each species, and a parameter of perturbation rate. The perturbation rate takes values
in 0, 0.01, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9.
As a benchmark we apply dynamic programming to reconstruct the DPR network evolutionary history. The
algorithm takes the perturbed protein trees as the accurate structure and infers the edge presence variable values.
Given a protein tree TP and a domain d, define xi ∈ {0, 1} as a variable indicating whether (d, pi) is a domain-protein
edge for a protein pi ∈ TP . Conditioned on the observed values of xi on leaf proteins in TP , we want to estimate the
hidden values of xi on ancestral proteins. Parsimony demands that the total number of edge additions/deletions is
minimized. Hence we can define a cost function as
C =
∑
(pi,pj)∈TP
δ(xi, xj). (13)
Define a partial cost C(xi) as the minimum number of changes from pi to all its descendants, conditioned on the
value of xi and observed values of x’s on leaf nodes. C(xi) can be expressed as a recursive form:
C(xi) = min
∑
(xi,y)∈TP
[C(y) + δ(xi, y)]. (14)
The minimizer of the total cost C(root) can be calculated by a dynamic programing algorithm such as Felsenstein
[3].
We guage the accuracy of the reconstruction algorithm by the normalized difference between the simulated
evolutionary history and the reconstructed one. The difference of two evolutionary histories is defined as follows.
First we attempt to identify the mappings from the proteins in the reconstructed history to the proteins in the
reference history. The mapping is iteratively constructed from the leaf species toward the root. The mapping of
proteins in each leaf species is well defined. For each protein p in species s of the reconstructed history, we extract
all its children and find their mapped proteins in the reference history. We compare this mapped profile with the
Quantification of contributions of evolutionary mechanisms
We propose two methods to gauge the contribution of each type of network change mechanisms in the evolutionary
history of a DPR subnetwork. The first method hypothesizes that each event of network changes follows a multinomial
distribution, and the probability for each type of network changes is invariant along the species tree. Denote pi the
multinomial probability for type i changes (i = 1, · · · , 11) conditioned on a network change event. Denote l the index
of a branch of T and nli the number of network change events of type i along branch l. The likelihood of the network
change events is
L =
∏
l
(
Nl
nl
1
···nl
11
)∏11
i=1 p
nli
i . (15)
where Nl =
∑11
i=1 n
l
i,
(
Nl
nl
1
···nl
11
)
≡ Nl!Q11
i=1
nl
i
!
, and
∑11
i=1 pi = 1. Differentiating equation 15 with respect to each pi yields
maximum likelihood estimators:
pˆi =
1
N
∑
l n
l
i, (16)
where N =
∑11
i=1
∑
l n
l
i.
The second method hypothesizes that the probability for each type of network changes along a branch is propor-
tional to the product of the branch-specific probability derived from the entire metabolic network and the branch-
independent probability within a subnetwork:
γli =
rliqiP
11
j=1 r
l
j
qj
, ∀i, (17)
where rli denotes the probability of type i changes along branch l on the entire network, qi the reweighting factor
of type i change on the subnetwork, and γli the probability of type i change along branch l on the subnetwork. r
l
i is
proportional to the total number of type i changes along branch l. The optimal reweighting factors qˆi are obtained
by differentiating equation 17 with a normalization constraint
∑11
i=1 qi = 1.
To know whether a specific type of network changes are enriched in a pathway, we have to quantify the statistical
significance of each pˆi and qˆi conditioned on the distribution from the entire metabolic network. To evaluate the
p-value of a contribution probability pi or a reweighting factor qi in a pathway, we randomly sample reactions 100
times from all DPR networks with the same size of the target pathway. The p-value is the fraction of random trials
whose pi or qi exceeds the empirical value from the target pathway. The p-value for each change type i is calculated
from an independent set of random samples. The p-values for all types of changes in pi or qi yield two 11-component
real-number vectors p and q. We then quantize p and q using a threshold 0.1. The quantized vectors pˆ and qˆ are
binary vectors with values 1 if the p-value ≤ 0.1 and values 0 otherwise.
A binary pattern pˆ or qˆ specifies whether certain types of network changes are significantly enriched along a
pathway relative to the background derived from the entire networks. We further categorize these patterns into 6
disjoint classes:
Supplementary Figures
Fig. 1. Error rate distributions on simulated network reconstruction with varying network sizes. Error rates are
the total number of node and edge differences between simulated and reconstructed networks, normalized by the
reconstructed network sizes. The error rate distributions are evaluated among 4 groups with varying total sizes of
simulated networks (# nodes + # edges): 20-100, 100-500, 500-1000 and ≥ 1000. Blue curves indicate the error rates
of the max-product algorithm. Red curves indicate the error rates of dynamic programming.
0 0.1 0.2 0.3 0.4 0.5
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
error rate
fre
qu
en
cy
netsize [20,100]
 
 
max−product
dynamic programming
0 0.1 0.2 0.3 0.4 0.5
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
error rate
fre
qu
en
cy
netsize [100,500]
 
 
max−product
dynamic programming
0 0.1 0.2 0.3 0.4 0.5
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
error rate
fre
qu
en
cy
netsize [500,1000]
 
 
max−product
dynamic programming
0 0.1 0.2 0.3 0.4 0.5
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
error rate
fre
qu
en
cy
netsize >=1000
 
 
max−product
dynamic programming
Fig. 4. Top: Patterns of evolutionary mechanisms on the TCA cycle. Blue lines mark the phylogenetic tree of 10
species. The vertical height of each node denotes the DPR subnetwork size on the selected pathway. Horizontal
distances between two adjacent nodes indicate the total numbers of changes between their DPR subnetworks on
the selected pathway. The contribution of each type of network changes on the selected pathway of each edge is
shown as the pie chart. Bottom: The DPR network of the TCA cycle on human. Triangles: domains, circles: proteins,
squares: reactions. The color of a node or an edge denotes the ancestor where it first appears. Yellow: the common
ancestor of cellular organisms, red: the common ancestor of eukaryotes, blue: the common ancestor of opisthokonia
(animal-fungus group), green: human or the common ancestor of animals.
80 100 120 140 160 180 200 220 240 260 280
100
150
200
250
Homo sapiens (9606)
Escherichia coli K−12 (83333)
Agrobacterium tumefaciens str. C58 (176299)
Saccharomyces cerevisiae S288c (559292)
Bacillus anthracis str. Ames (198094)
Helicobacter pylori 26695 (85962)
Mycobacterium tuberculosis H37Rv (83332)
Plasmodium falciparum 3D7 (36329)
Shigella flexneri 2a str. 2457T (198215)
Vibrio cholerae O1 biovar El Tor str. N16961 (243277)
Opisthokonta (33154) Enterobacteriaceae (543)
Proteobacteria (1224)
Bacteria (2)
Eukaryota (2759)
Gammaproteobacteria (1236)
cellular organisms (131567)
33154−9606
543−83333
1224−176299
33154−559292
2−198094
1224−85962
2−83332
2759−36329
543−198215
1236−243277
2759−33154
1236−543
2−1224
131567−2
131567−2759
1224−1236
 
 
d
crea
ddel
pdup
p
crea
pdel
r
crea
rdel
dp
add
dpdel
pr
add
prdel
Fig. 6. Top: Patterns of evolutionary mechanisms on the steroid biosynthesis pathway. The vertical height of each
node denotes the DPR subnetwork size on the selected pathway. Horizontal distances between two adjacent nodes
indicate the total numbers of changes between their DPR subnetworks on the selected pathway. The contribution of
each type of network changes on the selected pathway of selected edges is shown as the pie chart. Only compositions
along the branches of the eukaryotic clade and that of the cellular organism-bacteria are shown. Bottom: The DPR
network of the steroid biosynthesis pathway on human. Triangles: domains, circles: proteins, squares: reactions. The
color of a node or an edge denotes the ancestor where it first appears. Yellow: the common ancestor of cellular
organisms, red: the common ancestor of eukaryotes, blue: the common ancestor of opisthokonia (animal-fungus
group), green: human or the common ancestor of animals.
20 40 60 80 100 120 140 160 180
−20
0
20
40
60
80
100
120
140
160
180
Homo sapiens (9606)
Escherichia coli K−12 (83333)
Saccharomyces cerevisiae S288c (559292)
Bacillus anthracis str. Ames (198094)
Mycobacterium tuberculosis H37Rv (83332)
Plasmodium falciparum 3D7 (36329)
Opisthokonta (33154)
Bacteria (2)
Eukaryota (2759)cellular organisms (131567)
33154−9606
33154−559292
2759−36329
2759−33154
131567−2
131567−2759
d
crea
ddel
pdup
p
crea
pdel
r
crea
rdel
dp
add
dpdel
pr
add
prdel
Fig. 8. Pathway of steroid biosynthesis. Image downloaded from the KEGG pathway database.
Fig. 10. Top: Patterns of evolutionary mechanisms on the protein kinase pathway. Blue lines mark the phylogenetic
tree of 10 species. The vertical height of each node denotes the DPR subnetwork size on the selected pathway. Hori-
zontal distances between two adjacent nodes indicate the total numbers of changes between their DPR subnetworks
on the selected pathway. The contribution of each type of network changes on the selected pathway of selected edges
is shown as the pie chart. Only compositions along the branches of the eukaryotic clade are shown. Bottom: The DPR
network of the protein kinase pathway on human. Triangles: domains, circles: proteins, squares: reactions. The color
of a node or an edge denotes the ancestor where it first appears. Yellow: the common ancestor of cellular organisms,
red: the common ancestor of eukaryotes, blue: the common ancestor of opisthokonia (animal-fungus group), green:
human or the common ancestor of animals.
0 100 200 300 400 500 600 700 800
0
200
400
600
800
1000
1200 Homo sapiens (9606)
Saccharomyces cerevisiae S288c (559292)
Plasmodium falciparum 3D7 (36329)
Opisthokonta (33154)Eukaryota (2759)
cellular organisms (131567)
evolution time (total number of changes)
n
e
tw
or
k 
si
ze
 (to
tal
 nu
mb
er 
of 
no
de
s a
nd
 ed
ge
s)
33154−9606
33154−559292
2759−36329
2759−33154
131567−2759
d
crea
ddel
pdup
p
crea
pdel
r
crea
rdel
dp
add
dpdel
pr
add
prdel
Report for the visit to University of California, Santa Cruz, September 6th-9th, 2011
I visited Josh Stuart's group at University of California, Santa Cruz, during September 6th-9th, 2011. 
The purpose of this visit was to exchange research ideas on cancer genomic data analysis and to discuss 
potential collaborations.  In a seminar talk, I presented a recent finding on the analysis of the 
glioblastoma (GBM) genomic data on the cancer genome atlas (TCGA).  In this work, we integrated 
the data of mutations, copy number variations, DNA methylations, mRNA and microRNA expressions 
of the GBM data and built association modules from them.  An association module encodes putative 
mechanistic/regulatory relations from the driver events at DNA levels to the passenger gene 
expressions.  We proposed an algorithm to link potential drivers to passengers and combined the driver-
passenger links in modules.  We extracted 85 association modules from the GBM data.  The modules 
associated with trans-acting effects tend to carry more biological relevance than the modules associated 
with cis-acting effects.  First, much more trans-acting modules retain co-expressions in two external 
mRNA expression datasets independent of TCGA data.  Second, much more trans-acting modules are 
associated with the survival durations of the patients than cis-acting modules.  We also found some 
modules were strongly associated with immune responses, cell cycle control, chromatin modification 
and cell adhesion.  The talk triggered interesting responses, as many of the audience also worked on 
cancer genome data analysis.  The feedbacks and suggestions raised after the talk were very useful. 
For instance, one audience suggested to "internalize" some of the external validations on finding 
relevant cancer-related genes and pathways.
Josh Stuart's group is actively involved in building pathway models for cancer genomic data analysis. 
They developed a "PARADIGM" tool, which integrates pathway information and cancer genomic data 
(e.g., copy number variations, gene expressions) in a probabilistic graphical model.  We exchanged 
ideas of extending the models to clinical phenotypes such as drug responses and patitent survival 
durations.  He also suggested possible ways to proceed experimental validation on my predictions.
In addition to Josh Stuart's group I also met Manfred Warmuth to discuss extension of probabilistic 
graphical models on quantum systems.  We exchanged ideas about our recent works.  He developed a 
mathematical formulation to extend Bayes rules in density matrices.  I sticked to a quantum system 
with hidden density matrices and observed binary measurement outcomes and developed a probabilistic 
graphical model on such system.  These two directions seem orthogonal.
99 年度專題研究計畫研究成果彙整表 
計畫主持人：楊振翔 計畫編號：99-2221-E-001-021- 
計畫名稱：分子生物網路內相關聯性演化之分析 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 2 3 100%  
博士生 0 1 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 0 1 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 1 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
