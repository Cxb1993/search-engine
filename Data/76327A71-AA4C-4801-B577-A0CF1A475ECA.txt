use the card scanners to read those questionnaire cards specifically designed for each machine.
Traditional key-in method takes a lot of manpower time and errors occurred from time to time;
and the scanner method not only limits people to choose and format papers, but also costs much
higher since consulting a commercial company is inevitable. Due to the inconveniences
mentioned above, this study set out to find an automatic and vast input method so that the future
designs for questionnaires are no longer limited to paper materials and the question format as
well. The pilot study has been done in the first year to develop a visual program where a single
questionnaire image was captured. By manually locating each checkbox, the result can be
analyzed instantly through image process.
In this year we have completed several research tasks including the construction of image
grabbing module, the development of the visual program to automatically recognize multiple
questionnaires, the building of the paper feeding device by refitting a printer, and the fabrication
of the control circuit board. Under this structure, it is required to manually locate each checkbox
in the first questionnaire initially. The recognition and analysis of multiple completed
questionnaires subsequently take place. The result of recognizing one checkbox is found to take
only 8 ms, which demonstrates that software is capable of fast data recognition and lays the good
basis for the automatic questionnaire input system.
Keywords: Public Safety and Health, Questionnaire, Machine Vision
一、前言
問卷調查係專家學者採用的重要研究方法之一，特別是公共安全衛生的各個領域經常
利用問卷來進行計量性研究，其歷史悠久且應用廣泛，理論的基礎相當成熟[1]。問卷的發
展有其嚴謹的步驟，從設計、製作、初評，到發放、回收，都有一定的過程，為求分析資
料的準確性或代表程度，通常希望回收的問卷數量在一定的數目以上，多則數千或數萬份，
因此問卷輸入成為整個研究流程的重要關卡，不僅要求精確，亦希望能夠快速完成，以便
繼續進入到分析的步驟。為求分析資料的便利性，大部分問卷填答均採用塗滿或勾選空格
的方式進行，問卷輸入即可利用人工鍵入或讀卡機讀取後傳輸至電腦檔案完成。人工作業
工作量非常大，耗時且昂貴，國外有專門的公司訓練員工輸入技巧來承攬此種業務，論問
項多寡計酬，為講求快速，公司希望問卷設計力求整齊以方便目視鍵入資料，或多或少影
響頁面之編排；另外讀卡機輸入者則需使用專用的卡紙，並需委外印刷，問卷回收後研究
者也仍必須租用讀卡機進行讀卡，成本自然增加。因此，若能將問卷從設計、印製、收集
後之資料輸入，都不假他人之手，同時問卷的版面設計及紙張材料亦無任何限制，一定能
降低研究工作的費用，縮短時程，增加效率。因此，研究者能夠在自身研究室完成大量地
自動化輸入，即成為吾人研究之方向。
影像處理發展已經數十年的歷史，在商業、醫療業、自動化及保全業應用非常廣泛，
其應用的例子包括：特徵擷取、診斷、畸形偵測、機械視覺與控制、以及人臉辨識等。影
像分析之流程包含影像輸入、前處理、影像強化、影像區分、特徵擷取及影像描述等部分。
在影像分析之前，為了使影像容易辨識，需要經過多項處理，使得影像資料變得簡易且一
致性。影像前處理過程中，常用的方法如影像二值化（Binarilization) 、濾波（Filtering）
與型態分析（Morphology analysis）[2]，而後者常用之方法為侵蝕（Erosion）、膨脹（Dilation）
與二者之組合。影像在前處理以後，而將物件的輪廓勾勒出來後（即為影像強化），隨而將
圖一 HP DeskJet 610C 印表機外觀與內部機構。
送紙功能會使用之馬達有二只（見圖二），捲送紙張係藉由左側方之步進馬達（PM55L
-048-HP69）帶動捲筒送紙，而捲夾紙張則靠右側下方之 DC 馬達，以時規皮帶驅動墨水匣
座至左側盡頭，擠壓勾桿令離合器齒輪咬合捲筒齒輪，以捲筒力道抬起紙盤並捲夾一頁而
進行送紙。捲夾成功後 DC 馬達隨即反轉使墨水匣座脫離勾桿而放低紙盤，為了使墨水匣
座持續在左側待命，吾人裝置一只長臂極限開關控制其向右位置。
圖二 HP DeskJet 610C 印表機馬達位置。
感應紙張係藉由滾輪上方之感紙槓桿遮蔽光電開關而動作（見圖三）。無紙張
時，光電開關無遮蔽，即為常閉狀態，當紙張通過時，槓桿垂下遮蔽光電開關，則
為開路狀態。此開閉狀態乃作為步進馬達之開關動作控制。
圖三 進紙裝置控制電路板。
上述進紙裝置之二只馬達驅動電路與極限、光電開關之邏輯電路，已整合於印
表機後側之單一控制電路板中，如圖四所示。右圖之接點分別為：A－24VDC 電源；
B－五線式步進馬達接頭；C－極限開關接頭；D－DC 馬達接頭；E－送紙信號輸入；
F－光電開關接頭。裝置中二只馬達均使用 UDN2916B 馬達驅動晶片(IC)來提供動
DC
馬
達
步
進
馬
達
底
視
圖
左
側
圖
極
限
開
關
光電開關
感紙電路板
感紙槓桿
CCD of AVT Guppy F146B，其解析度可達 13921040，所以可供分析之框內區域尺寸增加
了一倍，劃記之筆觸顯示相當清晰，大幅提高了辨識的可行性。圖六為影像擷取模組裝置，
CCD 架設於 Copystand 上，與問卷距離約 30cm。
圖六 問卷影像輸入裝置架構圖。
本研究使用之電腦系統為 DualCore Intel Core 2 Duo E8300, 2833 MHz，配置 NI
PCI-8252 影像介面卡，擷取 IEEE 1394 影像訊號。吾人將影像修正（稍後敘述）嵌入辨識
流程，所開發出來的圖控式人機介面顯示於圖七。
圖七 問卷自動辨識圖控程式。
本研究利用 1394 CCD 攝取問卷影像，針對空格進行辨識輸出填答結果，其系統運作
流程如圖八所示。程式在開啟後先輸入一張空白問卷，作為影像初定位之用，藉由問卷左
可視部份為鏡頭 180 度前半球面範圍（如圖九所示），但是將此半球面的影像投射至平面上
會使影像產生扭曲，使得影像外圍的部份嚴重變形[8]。圖中 H 值為鏡頭與問卷之間的垂直
距離，單位為像素數(pixels)，L1 為問卷影像空格中心至鏡頭的距離，H 軸與 L1 兩線之間的
夾角為，單位為弳度量，角所對應的弧長為 H ，為影像投影面上空格中心至 H 軸的距
離，而實際空格中心至 H 軸的距離應為 tanH ，在此欲將投影距離( H )轉換成實際距離
( tanH )，以達到魚眼修正的效果。
圖九 魚眼效果示意圖。
圖十為實際問卷與魚眼影像之關係圖，C 點為視野中心點，也就是 H 軸垂直於問卷上
的位置，P 點為影像中空格框心的位置，CP 距離就是上圖中角所對應的弧長 H ，而實
際空格框心的距離CP' 長度等於 tanH ，CP 與CP' 兩者之間的關係由下列公式所示：
H
CP
H
CP
CPCP'






tan
.
當一張問卷由進紙裝置送出至 CCD 下方時，會發生偏移和傾斜，使得框心座標會與初
定位實際位置不符，造成問卷辨識上的困擾，如圖十一所示，於是吾人利用旋轉方式來轉
換偏移的框心座標，透過座標轉換將定位座標轉換成參考座標，其方程式如下：



   

cossin
sincos
),(),( yxvu ,
在辨識問卷時必須再將參考座標轉換回來，以符合實際影像座標位置，找出空格框心位置，
座標反轉換公式如下：





  

cossin
sincos
),(),( vuyx .
以上之影像修正一旦嵌入至辨識流程，對於每一張問卷輸入影像，均可自動定位其空
現，因此進行二項實驗，首先以定位準確度反推 H 之最佳值，接著進行多張問卷多重空格
辨識時間之測定。
1. 以定位準確度決定 H 值
當程式在自動辨識問卷時，會將先前影像定位時所定的框心參考座標，透過魚眼效果
還原和座標反轉換，將框心的參考座標轉換成實際影像上的框心座標。鏡頭至問卷的垂直
距離 H 值，會影響魚眼效果還原後影像上的框心位置而產生偏移量，因此吾人以嘗試錯誤
法(Trial and Error)找出合適的 H 值，使得定位後的框心位置最為準確，依照經驗以像素為
單位 H 值將落在 1000 至 4500 之間。實驗前依序定位空白問卷的左上、右上、左下和右
下四個最邊緣的空格（偏移最多處），測試在給定不同的 H 值下，比較同一空格在手動定
位時的框心座標，與程式自動辨識時所找的框心座標，兩座標間位置的差距，當差異為最
小時，此時所用的 H 值為最佳值。
2. 單張問卷多重空格辨識時間之測定
問卷初定位完畢之後，藉由欲辨識的問卷影像進行整頁辨識時間測試，使用的問卷空
格數目為 75 格，空白問卷與填答問卷兩類各 50 張，程式將紀錄每一張問卷辨識所需的時
間，完成後將計算出平均辨識時間，並藉此找出辨識單一空格需要多少時間。
六、結果與討論
1. 以定位準確度決定 H 值
首先在 H=1000 至 H=4500 之間，以每 500 個像素差距分別進行測試，記錄定位後四處
空格的框心座標偏移量（見表一），找出 H 值範圍在 2500 至 3500 之間，各點座標的差距
變化較小（見圖十二）。接著在 H 值為 2500 至 3500 之間，以每 100 個像素差距作測試，
同樣地紀錄定位後四處偏移量（見表二），找出 H 值範圍在 2900 至 3100 之間，各點座標
最為接近（見圖十三）。再來以 H 值為 2900 至 3100 之間，以每 50 個像素差距作測試，表
三記錄各點偏移量，圖十四顯示出 H 值在 2950 至 3050 之間，各點座標的差異較小。最後
以每 10 個像素差距，在 H 值為 2950 至 3050 之間作測試，實驗結果發現當 H 值等於 2990
時，定位框心和辨識框心差距皆為零（見表四與圖十五），故最適當的 H 值定為 2990。
2. 辨識時間測試結果
以空白問卷與填答問卷各 50 張辨識時間測試的結果整理於表五中，結果發現辨識空白
問卷所需的平均時間約為 641 ms，其時間不到一秒鐘，辨識單一空白空格只需 8.54 ms，而
辨識填答問卷則需平均時間 647 ms，辨識單一已填空格需要 8.62 ms，二者差異在 1%以內，
本程式辨識問卷速度可以說是相當快速。
七、結論
本研究在第二年期進行自動化問卷輸入系統之進紙裝置機構開發與影像擷取模組軟體
發展，前者包括印表機機構改裝與控制電路板製作，具有馬達與 IO 控制功能，而後者則以
影像擷取裝置空間特性，推導問卷影像修正流程，使辨識程式得以準確定位多重問卷之空
格。本研究將繼續整合自動進紙與影像擷取裝置等機電系統，完成自動化機器視覺問卷輸
入系統之研發，未來此系統研發完成後，相信可以提供公共安全衛生界與其他領域之使用
問卷的研究者一項有力的工具，能在任何的紙張上編排任意的版面，不會影響回收問卷的
讀取，並得以在自己的研究室即可完成資料輸入。此外本系統欲使用的組件均屬於或是可
取代為便宜之機電裝置，不但有實用性，更相當具有商品化的潛力。
表三 H 值在 2900 至 3100 時，各個框心座標的偏移量（單位：像素）
H值 左上 左下 右上 右下
2900 0.00 2.00 1.00 1.00
2950 0.00 2.00 1.00 1.00
3000 0.00 0.00 0.00 1.00
3050 1.00 2.00 0.00 1.00
3100 1.41 1.41 1.00 2.24
0.00
0.50
1.00
1.50
2.00
2.50
2900 2950 3000 3050 3100
H值
差
距
左上(1)
左下(2)
右上(3)
右下(4)
圖十四 H 值在 2900 至 3100 時，各個框心座標的差距變化圖（單位：像素）。
表四 H 值在 2950 至 3050 時，各個框心座標的偏移量（單位：像素）
H值 左上 左下 右上 右下
2950 0.00 1.00 1.00 0.00
2960 0.00 1.00 1.00 0.00
2970 0.00 1.00 1.00 0.00
2980 0.00 1.00 1.00 0.00
2990 0.00 0.00 0.00 0.00
3000 0.00 0.00 0.00 1.00
3010 0.00 0.00 0.00 1.00
3020 0.00 0.00 0.00 1.00
3030 1.00 0.00 0.00 0.00
3040 1.00 0.00 1.00 1.41
3050 1.00 0.00 1.00 1.41
0.00
0.20
0.40
0.60
0.80
1.00
1.20
1.40
1.60
2950 2960 2970 2980 2990 3000 3010 3020 3030 3040 3050
H值
差
距
左上(1)
左下(2)
右上(3)
右下(4)
圖十五 H 值在 2950 至 3050 時，各個框心座標的差距變化圖（單位：像素）。
