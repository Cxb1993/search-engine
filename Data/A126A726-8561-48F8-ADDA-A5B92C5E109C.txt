significantly. A superior experimental show that the 
proposed filter and prediction method have the 
tracking error bound a small range and the precision 
will be promoted. By above results of study, it 
believes that fire control system automation will set 
in a new development and application in the near 
future. Undoubtedly this thesis plans an the 
beginning of self-own defense and that is one of 
important engineering practicability contributions in 
its research work. 
 
英文關鍵詞： Fire Control； Trajectory Filtering； Tracking of 
Maneuvering Target； projectile trajectory 
 
 2 
三、研究方法 
1.理論建立，包括二大部份： 
(1)第一部份：建立符合真實情況，且儘可能簡單，以便進行即時處理之砲彈運動射表數學
模型。 
(2)第二部份：應用最適當之濾波與預測法則，以建立砲彈運動方程式，使產生砲令、修正
偏差，使誤失距離(Miss Distance)降至最小，提供火砲自動穩定精準追擊可用控制方式。 
2.數學理論方法 
(1)運動射表數學模型部份：本計畫採原廠 40/70 快砲為例，研究這一問題。其方法也適用
於其它中、大口徑砲令射控火砲。濾波和預測的基本條件是：(1)預測區域：延伸 
估測彈道可為直線逼近段。(2)預測範圍：120m (最大斜距離增加量)。(3)量測點數：8~16
點。(4)取樣時間：1/32s。(5)測量誤差(RMS)：斜距 15m。(6)數據處理時間：0.667s。 
在標準狀況下，彈頭出砲口之剎那，亦即內彈道與外彈道間之中間彈道有些狀況是
會影響到彈頭彈道軌跡，且是射表所無法顯示的，這就是垂直定起(Vertical Jump)與側向
定起(Lateral Jump)，其形成原因非常複雜，影響到彈頭出砲口之起始條件，但一般被忽
略。同在標準狀況下，作用在彈頭上之空氣動力、重力、慣性力等均為一標準常數值，
並依此計算出標準彈道。但是，彈頭飛行中有許多狀況會偏離標準彈道，其中主要的影
響力為重力及空氣阻力，其他尚有漂移、陣風、空氣密度等非標準狀況。這些都影響彈
頭軌跡，此非人為之非標準狀況在可視為白色雜訊，在砲令射控中得以使用補償修正方
式予以克服。故建立數學模型必須滿足以下兩個條件：一是模型要準確表達目標運動，
使模型假定引起的誤差(即模型誤差)在允許的範圍內。二是模型要儘可能地簡單，以便
進行即時處理。同時建立目標運動數學模型還要考慮濾波和預測的具體狀況。在取樣速
率一定時，數學模型愈複雜，濾波收斂愈慢，因此，除非進行一定程度的簡化，二自由
度質點彈道方程也很難應用於需即時處理之砲令射控。 
目前比較完整的控制理論均是針對線性系統，其實自然界存在的線性系統非常的稀
少，此討論稱謂的線性系統，通常是非線性系統經過線性化的結果。根據泰勒展開定理，
任一非線性函數，只要其各階導數存在並有限，就可以用一多項式級數的型式充份地逼
近；彈頭的運動軌跡顯然滿足這一條件。 
),,( tuxfx                      (1) 
),,( tuxhy                       (2) 
(1)式為動態方程式、(2)式為量測方程式；今在平衡點 ),( 00 uxP 處做線性化處理[28-33]，
則得出 
BuAxu
u
u
f
x
x
f
tuxfx
uxux








0,00,0
00 ),,(     (3) 
DuCxu
u
u
h
x
x
h
tuxhy
uxux








0,00,0
00 ),,(    (4)  
上式中，是以標準參考彈之彈道軌跡作為平衡點 ),( 00 uxP 選用。設計者射表秉持此一概
念而衍生出來，其建構模型如圖 2；為說明作法，圖 1 中先以二維座標固定方位（迴旋）角
場景表達，原理為獲取標準狀況下彈道軌跡設定平衡點，於戰術環境下實際射擊時，彈道軌
跡雖然偏離標準設定平衡點，但偏離量侷限在一小範圍內，而且可以用砲口初速差異值
(Difference Muzzle Velocity, ΔMV)與彈道係數變量(%BC)，來求出與誤失距離間之線性化關
係，再利用該二項為輸入項(Input)，取涵蓋面之點的彈道數據作外推，外推的方法是採用 5×
5 外推工作表，表示如圖 3；在圖 3 運用中，誤差修正(Error Correction)以 EC(i)表示，分別代
表 EC(1)=AP(Angle of Projection)；EC(2)=APV(Average Projection Velocity)；EC(3)=VH(Vertex 
Height)；EC(4)=DF (Drift)；。今假設 x 變量為彈道係數變量(%BC)，y 變量為砲口初速差異
 4 
（VH）、橫向徧移量（DF）等為應變數，這些應變數就是實際設計者射表數學模型中所需之
數據。所謂 BC 是將大氣環境因素，諸如大氣密度、温度、壓力及濕度合併考慮的一個數值，
BC 愈大表示空氣阻力愈小。所謂 ΔMV 是考慮砲彈射擊的次數與温度對於初速的影響。所謂
合成距離是為了方便找出所適合之曲線擬合來產生全面性涵蓋面所定之參數。(6)式又稱二階
射表，式中 ΔMV、％ BC 係供修正彈著用，且 ΔMV 與％BC 之間存在藕合關係。 
設計者射表是在幾個特定的合成距離與發射角所構成之平衡點來製作，對於使用與原廠
不同的彈藥或配賦其他程式彈藥，即改變了平衡點，要重新製作新平衡點之設計者射表，是
不容易的。利用與設計者射表相同的概念，將穩定區域由終端平衡點改為飛行軌跡；雖然終
端平衡點改變，但若彈藥外型相同、諸元相同、發射藥性穩定，其軌跡均收歛於一軌道內，
符合軌道穩定理論（Orbit Stability）。具體的計算過程是在實際彈道數據中取 8 個點的彈道數
據作為樣本，對斜距離、高低（俯仰）角、方位（迴旋）角三個座標值分別進行擬合，並用
擬合得到的係數進行外推。擬合的誤差作為濾波誤差，外推的值與實際彈道數據的差值作為
預測誤差。擬合所用的數學模型可假設為 m 次多項式， 
m
mxbxbbxp  ...)( 10             (7) 
其中 mbbb ,,, 10  為待定參數，經由量測 n 個數據點，其量測方程式可表為 
vHz

                             (8) 
其中 









































m
m
nn
m
m
n b
b
b
v
xx
xx
xx
H
p
p
p
z 






 1
0
22
11
2
1
;
1
1
1
;  
可應用最小平方估測 (Least squares Estimation) ，而得到最佳的曲線擬合(Curve fitting)
所需之參數。 
  zHHHv TT  1                           (9) 
(2)設計者射表試驗 
火砲射擊目的就是要有效命中目標，但要逹成此目的過程會受到許多因素影響，除非
將這些因素適當補償，否則很難逹到命中目的[34、35]。在使用原廠彈藥射擊#1 號目標的過
程，射擊情形如表 1，吾人觀察，彈道軌跡之誤差被預測及補償。改將原廠彈藥內發射藥脫
出，重新裝填國造 A-1-4 批 40 公厘 PFHE 發射藥[36~39]，其與原廠彈藥差異處僅為發射藥
性能與拔彈力，射擊相同習會#2，目標情形如表 2。由表 2 數據顯示改裝彈藥誤差收斂慢，
顯示補償不易正確。另時有嚴重異常現象出現，亦即有初速標準差差異太大，超出原廠規格
甚多，使彈著未落入雷達目標追蹤閘，無法連續追蹤鎖定射擊，必須重新開始追蹤鎖定射擊。 
表 1 原廠彈藥斜距離、高低角及平衡時間實測模型誤差（設計者射表） 
斜距(單位：m) 高低角(單位：∘) 平衡時間(Sec) 目標 
編號 
彈道 
編號 Predict MD Predict Error Predict Error 
1@#1 3408 19.1 21.36 0.05 15.146 0.1 
2@#1 4288 3.7 22.81 0.02 19.242 0.07 
3@#1 3938 1.2 22.39 0.001 17.59 0.01 
4@#1 4038 0.3 22.39 0.000 18.06 0.005 
#1 
5@#1 3988 0.0 22.39 0.000 17.825 0.000 
 6 
表 4 二階斜距離濾波與預測最大模型誤差（擴增設計者射表） 
二階模型（單位：m） 
擬合點數 斜距 
射角 5∘ 15∘ 30∘ 45∘ 60∘ 75∘ 
濾波 0.00 0.00 0.00 0.00 0.00 0.00 
2000 
預測 0.03 0.02 0.03 0.03 0.02 0.03 
濾波 0.00 0.00 0.00 0.00 0.00 0.00 
3000 
預測 0.01 0.03 0.02 0.03 0.01 0.03 
濾波 0.00 0.00 0.00 0.00 0.00 0.00 
4000 
預測 0.01 0.03 0.03 0.05 0.04 0.03 
濾波 0.00 0.00 0.00 0.00 0.00 0.00 
8 
5000 
預測 0.05 0.02 0.01 0.05 0.05 0.01 
 
表 5 零階方位角濾波與預測最大模型誤差（擴增設計者射表） 
常數模型（單位：∘） 
擬合點數 斜距 
射角 5∘ 15∘ 30∘ 45∘ 60∘ 75∘ 
濾波 0.0013 0.0013 0.0013 0.0013 0.0013 0.0013 
2000 
預測 0.0033 0.0031 0.0031 0.0034 0.0034 0.0031 
濾波 0.0011 0.0011 0.0011 0.0015 0.0015 0.0015 
3000 
預測 0.0010 0.0010 0.0010 0.0010 0.0010 0.0010 
濾波 0.0016 0.0016 0.0016 0.0016 0.0016 0.0016 
4000 
預測 0.0019 0.0019 0.0019 0.0019 0.0019 0.0019 
濾波 0.0018 0.0018 0.0018 0.0018 0.0018 0.0018 
8 
5000 
預測 0.060 0.060 0.060 0.060 0.060 0.060 
 
表 6 橫風 10m/s 方位角濾波與預測最大模型誤差（擴增設計者射表） 
常數模型（單位：∘） 
擬合點數 斜距 
射角 5∘ 15∘ 30∘ 45∘ 60∘ 75∘ 
濾波 0.003 0.003 0.004 0.004 0.006 0.012 
2000 
預測 0.008 0.008 0.009 0.011 0.015 0.029 
濾波 0.004 0.004 0.004 0.005 0.006 0.012 
3000 
預測 0.09 0.09 0.010 0.012 0.017 0.032 
濾波 0.004 0.004 0.004 0.005 0.006 0.012 
4000 
預測 0.010 0.010 0.011 0.013 0.017 0.032 
濾波 0.004 0.004 0.004 0.004 0.006 0.011 
8 
5000 
預測 0.011 0.011 0.012 0.013 0.018 0.034 
 
由上顯示吾人所選用的彈道模型，不僅模型誤差在允許的範圍以內，而且形式簡單，
可簡化算法，將原設計射表擴充，把非標準狀況在可接受之範圍內予以調適、擬合，以對彈
 8 
TC ：時間常數(time constant) 
當目標沒有閃躲時， 值愈來愈小，目標的追蹤就愈來愈平滑，擊中目標的機率也就愈
大，然而  值愈小，追蹤法則究愈來愈不靈敏，此時如果目標閃躲就不容易追隨，因此這個
部份利用誤差訊號的大小來辨別目標是否真的在閃躲，如果目標真的閃躲，則重新修正時間
常數TC 即相當於1 ，來放大系統的分佈，以期望打中閃躲目標。在使用集中  濾波法則時，
搭配使用設計者射表[1, 6]。 
集中  濾波算法中彈丸數學模型： 
2
0 iii btatDD                                           (20) 
ii ct 0                                                (21) 
.0 constqqi                                              (22) 
其中D是斜距， 是仰角， q是迴旋角，吾人可以用數學語言對這一過程進行描述：D是自
變數 t和待定參數 0D 、a、b的函數 
2
0 btatDD                                           (23) 
現給定n對觀測值  ii tD , ，要求確定參數 0D 、a、b的估測值 0Dˆ 、 aˆ、 bˆ，使 
  
2
1
2
0
ˆˆˆ


n
i
iii tbtaDDQ                                 (24) 
為最小，為使Q達到極小，應滿足 


















0
ˆ
0
ˆ
0
ˆ
0
b
Q
a
Q
D
Q
                                                (25) 
即為： 























































i
n
i
i
i
n
i
i
n
i
i
n
i
i
n
i
i
n
i
i
n
i
i
n
i
i
n
i
i
n
i
i
n
i
i
n
i
Dt
Dt
D
b
a
D
ttt
ttt
tt
1
2
1
1
0
1
4
1
3
1
2
1
3
1
2
1
1
2
11
ˆ
ˆ
ˆ
1
                         (26) 
解此線性方程式，即可求得滿足要求的 0Dˆ 、 aˆ、 bˆ，然後代入下式進行運算 
2
0
ˆˆˆˆ ii tbtaDD                                           (27) 
當 ntt  時， Dˆ就是D的濾波值，當 ntt  時， Dˆ就是D的預測值。 
(1)改良最小二乘法濾波法則 
a.斜距濾波及估測之改進算法 
為了再提高濾波和預測的精度，吾人提出改良最小二乘估算法。吾人發現濾波和預測誤
 10 
故知：   





n
i
i
n
i
i tn
b
t
n
a
DDE
1
2
1
00
ˆ                       (38) 
     
n
DEDEDD
2
2
000
ˆˆ                                (39) 
jt 時刻的濾波值為： 
2
0
ˆˆˆˆ jjj tbtaDD                                     (40) 
其平均值為 
     22ˆ ttbttaDDE jjjj                          (41) 
其中 


n
i
itn
t
1
1 ， 


n
i
itn
t
1
22 1  
其變異量：    
n
DEDE jj
2
2ˆˆ                           (42) 
當 nj  時，上式就是預測的平均值和變異量，對於一次預測來說，    22 ttbtta jj 

相當於系統偏差，與模型誤差作用相同。對於多次預測來說，    22 ttbtta jj 

也是一個
隨機變化的量。假設 a 的變異量為 a ， b 的變異量為 b ，二者平均值為 0，則 jDˆ 的平均
值與變異量分別為： 
  jj DDE ˆ                                             (43) 
     22222
2
ˆ tttt
n
DD jbjaj  

                      (44) 
從上式可以看出，只要 2a 、
2
b 足夠小，對 jD 的濾波和預測變異量就越小，但其下限為
2 n 。最小的預測變異量也比 2 n 大，這是樣本數據對預測結果的限制。從(44)式中可以看
出，預測變異量與測量誤差 a、b的估測誤差都有關係。測量誤差已由測試設備確定，這裡
我們討論一下如何對a、b進行估測，其誤差又有多大。比較(23)式與一般的等加速度運動方
程式： 
2
0 2
1
atvtxx                                        (45) 
2
0 2
1
btatDD                                       (46) 
顯然 a 相當於彈丸在 0D 點的徑向速度， b 是彈丸在整個濾波期間的平均加速度的一
半。由於彈丸運動存在隨機散佈因素，因此我們無法事先知道每一次具體射擊的彈道參數。
但是在編製射表時，我們已經掌握了彈丸的平均彈道，並將有關數據編成一個表格，因此，
當射角、初速和環境條件等射擊條件已知時，就可以由射表求出平均彈道上各點運動參數，
包括上述徑向速度和平均加速度。以此作為 a 、 b 的估計值，具有相當高的精度，因為估計
值誤差主要由 0D 的估測誤差、環境測量誤差、初速估測誤差及射表誤差組成，相對火控雷達
 12 
 
3.測評想定一：測試時使用雷達截面積約為 2m², 編號為 FCK(B)空中目標, 在夜間以單機攻擊
飛行, 除驗證雷達性能之外, 亦用以驗証系統的兩門火砲在夜間同時對單一目標的接戰能力。
FCK(B)以 3000 呎高度，由正北方進場，順時鐘方向共飛行五圈，任務分配為該單機由追蹤雷
達及射控系統帶 #1 砲以遙控接戰模式來執行, 同時該機亦由搜索帶追蹤器追蹤而將其指派給
#2 砲以本砲接戰模式使用 OFCS 系統來操作。測評場景如圖 5 所示。 
 
North 
 
 
FCK(B)                      
               Vt =200m/s 
               fd,max=12.67Hz 
 
Inbound 
 
 
 
 
Outbound 
12 浬            8 浬              4 浬                   P (0,0)攻擊目標點 
A1            B1                C1                  #2砲              East 
#1砲 
雷達及快砲(本艦) 
 
22Km  18Km  15Km    10Km  7Km 
2㎡搜索雷達 0.1㎡追蹤雷達 TWS 起追距離 快砲光電偵搜 快砲光電測距 
                              圖 5. 測評想定一之航線圖 
 
由測評想定一課目實測結果，使用標準系統、研改 0-2 等系統在迴旋軸及俯仰軸之散佈界及
偏差量如表 7 所示。 
表 7. 40mm/70 鋼霰彈散佈界驗證性能比較表 
軸向 迴旋軸 俯仰軸 
項目 
散佈界 
(mrad) 
偏差 
(mrad) 
散佈界 
(mrad) 
偏差 
(mrad) 
標準 0.37 0.77 0.72 0.61 
研改 0 脫靶 - 脫靶 - 
研改 1 0.45 1.18 0.92 0.77 
12 浬 
   
A  
   
 
   
   
   
B, 8 浬 
   
   
   
   
   
   
   
C. 4 浬 
   
   
   
 
PATH 1,2,3,4,5, 6,7 
 14 
軸向 迴旋軸 俯仰軸 
項目 散佈界 
(mrad) 
偏差 
(mrad) 
散佈界 
(mrad) 
偏差 
(mrad) 
標準 0.37 0.77 0.72 0.61 
研改 0 脫靶 - 脫靶 - 
研改 1 0.56 1.35 0.94 0.83 
研改 2 0.45 1.05 0.82 0.46 
 
五、結果與討論 
本研究針對砲令射控中對應與原廠不同彈藥或配裝其它程式彈藥狀況，採新平衡點製作擴
增射表，並進行濾波預測法則研析，獲得以下結論： 
1. 原廠砲令無法涵蓋狀況下，現狀系統雖不能完全沿用原廠平衡點理論，但能適用軌道穩定理
論；故可將原設計射表擴充，把非標準狀況在可接受之範圍內，對彈道偏差實施補償，經驗
證，可有效追蹤彈道模型。 
2. 砲令射控中，集中  濾波器配合設計者射表，及改良最小二乘法濾波器配合擴增設計者射
表，可實現射控雷達對彈丸和目標之同時精確追蹤，大幅提升射擊精度，誤失距離(Miss 
Distance)降至最小。 
3. 對於使用國外原廠系統配合國造彈藥之武器系統，可提供一有效方法，使彈丸和目標之間的
偏差量控制在一定範圍內，提升射擊精度。在力求國防自主政策的今天，將提供未來火控自
動化系統之發展與應用參考。 
 
六、謝誌 
本研究由國科會專題計畫編號：NSC 100－2221－E－344－001 補助，僅此致謝。 
 16 
[25]黃振國，雙軸馬達驅動機砲之智慧型追蹤射控系統，國立台灣大學電機研究所碩士論
文，中華民國 85 年。 
[26]陳治宇，以智慧型單眼即時影像追蹤系統與飛機姿態辨識為基礎之目標物武惟軌跡檢
測，國立台灣大學電機研究所碩士論文，中華民國 87 年。 
[27]傅立成、徐志翰、馮蟻剛、顏家鈺、蔡銘昌、郭德盛、劉福晟、謝明益，雙聯裝二 0
機砲砲車伺服控制期末報告，臺灣大學慶齡工業中心，中華民國 84 年 1 月。 
[28]Singer, R. A., and Behnke, K., “Real-time Tracking Filter Evaluation and Selection for 
Tactical Application” IEEE Trans. On Aerospace and Electronic System, Vol. AES-7, NO. 1, 
Jan. 1971. 
[29] Quigley, A., “Tracking and Associated Problems” IEEE conference on radar-present and 
future, London, Oct. 1973 
[30] 毛大喜，”隨機控制系統與數位濾波器之探討”，中華民國 74 年自動控制研討會論文
集，中華民國 74 年，頁 217～227。 
[31] Skolnik, M. I. Introduction to Radar Systems, 2nd ed. New York, McGrow-Hill, 1980, pp. 
183-186.  
[32] 李守誠、王國政、劉正瑜，”國造二 0 公釐雙聯裝機砲滾轉控制迴路設計及模擬”，中
正嶺學報，26 卷，第 2 期，1998，頁 133～146。 
[33] Lee, S. C. and Liu, C. Y., “Preliminary Design of Tracking Loop for Marine-Used Machine 
Gun”, Defense Science Journal, Vol. 49, No. 2, 1999, pp. 81-90. 
[34]趙中行、伍世文、方鵬飛，海軍兵器系統基本原理，海軍總司令部，中華民國 79 年 3
月，第十九章。 
[35]陳積德，火砲射控系統概論，火砲概論（下冊），火砲技術手冊，聯勤第二 0 二廠，中
華民國 76 年。 
[36]楊清龍，”爆彈儀測試對阻燃性發射藥燃燒特性之探討及應用，”技術精進（第一輯），
聯勤第二 0 三廠，中華民國 74 年 9 月。 
[37]周清河，”40/70 HE-T 發射藥測試檢討報告，”技術精進（第二輯），聯勤第二 0 三廠，
中華民國 76 年 5 月。 
[38]方聰然，國造 40 公厘 PFHE 發射藥製造現行標準作業程序手冊，軍備局第二 0 三廠，
中華民國 97 年 1 月。 
[39]方聰然，國造 40 公厘 PFHE 發射藥檢驗現行標準作業程序手冊，軍備局第二 0 三廠，
中華民國 97 年 1 月。 
[40] Lin, C.-F., Modern Navigation, Guidance and Control Processing, Prentice Hall, Sec. 7.1.5, 
pp. 421-414, 1991. 
[41] Dalata, P. R., “The Tracking Index A Generalized Parameter for Alpha-Beta-Gamma Target 
Trackers”, IEEE Trans. Electronic System, Vol. AES-20, pp. 174-182, March 1984. 
[42] 毛大喜，”隨機控制系統與數位濾波器之探討”，中華民國 74 年自動控制研討會論文
集，頁 217-227，中華民國 74 年。 
[43] Skolnik, M. I., Introduction to Radar Systems, 2nd ed. New York, McGrow-Hill, pp. 
183-186, 1980. 
[44] 洪兆宇、趙嘉琦、尹清崗、尹清岩，” 砲令射控中雷達追蹤用彈道模型”，中正嶺學報，
已接受，2008。 
[45] Singer, R. A., and Behnke, K., “Real-time Tracking Filter Evaluation and Selection for 
Tactical Application” IEEE Trans. On Aerospace and Electronic System, Vol. AES-7, NO. 1, 
Jan. 1971. 
[46] Quigley, A., “Tracking and Associated Problems” IEEE conference on radar-present and 
future, London, Oct. 1973. 
[47] Benedict, T. R., “Synthesis of an Optimal set of Radar Track-While-Scan Smoothing 
Equation” IRE Trans. On Automatic Control, Jul. 1962. 
[48] Cantrell, B. H., Trunk, G. V., Queen, F. D., Willson, J. D., Alter, J. J., “Automatic Detection 
and Integrated Tracking System” The Record of the IEEE Faternational Radar Conference, 
New York, Apr. 1975. 
國科會補助計畫衍生研發成果推廣資料表
日期:2012/10/15
國科會補助計畫
計畫名稱: 砲令射控迴路中砲彈運動之即時預測與追蹤法則之研究
計畫主持人: 方淳民
計畫編號: 100-2221-E-344-001- 學門領域: 其他控制科技
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
無 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
