行政院國家科學委員會補助專題研究計畫成果報告
※※※※※※※※※※※※※※※※※※※※※※※※※※
※ ※
※應用粒子群演算法於轉移機台之批量分割之研究 ※
※ ※
※※※※※※※※※※※※※※※※※※※※※※※※※※
計畫類別：■個別型計畫 □整合型計畫
計畫編號：100-2221-E-224-031-
執行期間：100 年 08 月 01 日至 101 年 07 月 31 日
計畫主持人：蘇純繒 教授
計畫參與人員：博士班研究生-兼任助理人員：黃貞元
臨時人員：吳桂蜜
本成果報告包括以下應繳交之附件：
□赴國外出差或研習心得報告一份
□赴大陸地區出差或研習心得報告一份
■出席國際學術會議心得報告及發表之論文各一份
□國際合作研究計畫國外研究報告書一份
執行單位：國立雲林科技大學工業工程與管理學系
中 華 民 國 一 O 一年 八 月 二十三 日
1行政院國家科學委員會專題研究計畫成果報告
應用粒子群演算法於轉移機台之批量分割之研究
A study of lot streaming with delivery time between machines by using
particle swarm optimization
計畫編號：100-2221-E-224-031-
執行期間：100 年 08 月 01 日至 101 年 07 月 31 日
計畫主持人：蘇純繒
計畫參與人員：黃貞元、吳桂蜜
摘要
批量分割能使加工作業重疊，達到縮短完工時間之目
標，因此批量分割的方法已經被廣泛的運用於生產上，而本
研究為針對批量分割應用在考慮作業在轉移機台時有不可忽
略之零工型生產系統時作探討。本研究中使用粒子群演算
法，以最小化總完工時間為目標來求解排程問題，在實驗中，
以隨機的方式產生各種不同的問題規模以及不同製程環境之
問題並進行分析。分析結果顯示，使用批量分割於零工型生
產系統中能有效降低總完工時間，且作業轉移的時間較短
時，比時間較長更適合批量分割，其中改善幅度最大為兩相
等批量分割時之效益最大，改善幅度會隨著分割數的增加而
減緩。
關鍵詞：零工型排程、批量分割、粒子群演算法
Abstract
Using lot streaming can overlap operations to reduce
the makespan. Therefore, lot streaming concept has
been used widely in production. This study
investigates lot streaming in job shop production
systems with delivery time between machines cannot
be omitted more thoroughly. The object of the
problem is minimizing makespan, and solved by
using particle swam optimization in the research.
Some experiments generated randomly in order to
investigate the influence of number of jobs, machines,
sublots, and transfer times in a job shop production
system. The results show lot streaming can reduce
makespan effectively. Lot streaming makes more
benefit when transfer times are short. And two
consistent sublots makes largest benefit. The benefits
are reduced gradually with increasing the number of
sublots.
Keywords：Particle swam optimization; Lot streaming; Job shop
一、前言
現今產業界面臨著各種不同的競爭壓力，準時交貨亦是
產業界對上下游的合作廠商的競爭力評鑑的主要項目之一，
因此，如何在訂單數量較多時運用適當的排程技術，達到有
效的資源配置，減少排程的衝突，自然成為一個重要的課題。
生產排程問題中，零工式排程問題(job-shop scheduling
problem，JSSP) 在產業界裡為常見且較複雜、難以處理的問
題之一，在過去的研究中，求解零工式排程問題的方法大致
可分為三類，第一類為前面提到的派工法則；第二類為最佳
化方法，如整數規劃法，第三類為近似解方法，如基因演算
法(genetic algorithm)、粒子群演算法(particle swarm
optimization)等。
粒子群演算法是由J. Kennedy 及R. C. Eberhart 兩位學
者於1995 年提出的一種進化搜尋的方法，與基因演算法類
似，同樣隨機產生一組初始解，再以進化方式改善最佳值；
粒子群演算法的概念是來自於鳥類群體覓食的行為，每個粒
子(particle)代表一個解，藉由前一個世代中的最佳粒子的經
驗，調整粒子前進的方向及速度朝著最佳粒子前進。粒子群
演算法因為演化的過程及參數都比基因演算法簡單，因此粒
子群演算比起基因演算法能更快速收斂，節省求解的時間。
除了使用演算法求解外，本研究也考慮批量分割(lot splitting)
帶給排程問題的效益，藉由批量分割使作業間能夠產生重疊
(overlapping) 縮短完工時間。批量分割常使用於流程式(flow
shop) 生產環境，而在零工式排程中，因為訂單加工的順序
不同，因此在零工式排程中較少使用批量分割，但是駱景堯
(2004) 提出在零工式排程問題中，批量可以割能有效縮短最
大完工時間。
本研究主要目的是利用粒子群演算法，求解可進行批量
分割的零工式排程問題，以達成最小化總完工時間(makespan)
之目標，本研究具體目的有下例幾項：
1.以最小化最總完時間為目標，並考量批量分割，建構零工
式排程問題模式。
2.針對此排程問題，提出一個粒子群演算法之演算策略。
3標為總完工時間最小化，每個工作經過機台加工的順序及各
作業加工時間如下所示：
工作 經過機台順序 加工時間 到期日
1 M2-M3-M1 30, 40, 20 110
2 M1-M2-M3 50, 60, 30 150
3 M1-M3-M2 30, 50, 60 140
3.2 數學模式
3.2.1符號定義：
b：批量之分割數。
i：工作之代碼(i=1, 2 ,3 , … , n)。
j：作業之代碼(j=1, 2 ,3 , … , m)。
y：批量之代碼(y=1, 2 ,3 , … , b)。
k：機器之代碼(k=1, 2 ,3 , … , m)。
Tmov：子批量轉換機台加工之搬運時間。
Cmax：排程問題中所有工作的最大完工時間(makespan)。
Fi：工作i 的完工時間。
STijyk：工作i 第j 個作業第y 個子批在機台k 的開始加工時間
Pijk：工作i 第j 個作業在機台k 需要被處理的時間
Pijyk：工作i 第j 個作業第y 個子批在機台k 需要被處理的時
間(Pijyk= Pijk /b)
Xijyi’j’y’k：若工作i 第j 個作業第y 個子批與工作i’第j’個作業第
y’個子批都在同一機台k 加工，則Xijyi’j’y’k=1，其它Xijyi’j’y’k=0。
H：表示一個很大的數
3.2.2 目標式：
Min Z= Cmax (3-1)
3.2.3 限制式
有關數學式的意義說明如下：
(3-1)為目標式，目標為最大完工時間(makespan)最小化。
(3-2)表示總完工時間為所有工作的完工時間中最大的一個。
(3-3)為每一個工作的完工時間，等於其工作最後一個作業最
後一個批量的開始時間加上作業加工時間。
(3-4)表示同一個工作中，兩鄰近作業的先後關係。
(3-5)為相同工作相同作業中，分割子批的先後處理關係。
(3-6)及(3-7)表示判斷一機台同時間只能處理一個作業之限制
式。
3.3 演算法求解模式
3.3.1 演算法編碼方式
要成功的求解問題必須有效的定義出問題描述方式及
粒子的世代更新方式，因此，如何將問題的解作編碼自然是
很重要的議題，本節將說明演算法的編碼方式，粒子群的世
代演進將於後面的小節說明。
排程問題的解是屬於離散的組合最佳化型式，並不是連
續實數的最佳化問題，因此，必須將問題解以適當的編碼方
式作處理，Zhigang et al. [2006]運用作業為主的編碼將其運用
在零工式生產的問題上，方式為將同一個工作的所有作業用
同一個整數表示，本研究也是利用類似的方法，再加入批量
的概念來編碼，以下提出一個例子說明編碼方式。n 個工作
m 個機台的問題，每個工作分成b 個子批，
這個問題會產生n×m×b 個位元的粒子，粒子包含由n
個工作的m×b 個子批。因此，粒子中會有m×b 個1,2,…,n。
以2×2×2 的問題為例，則一個粒子會2×2 個1 及2×2，若一
個粒子為[2 1 1 2 1 2 2 1]，粒子中所有的1 代表的是第一個工
作，2 代表第二個工作，解碼後則為[O211 O111 O112 O221
O112 O212O222 O122]，依左至右為指派作業加工之順序，
其中Oijy 代表第i 個工作第j 個作業第y 個子批。編碼中的值
代表工作相對的作業及子批編號，依照此方法將編碼位置的
工作指派至排程表上，這樣一來，粒子產生的排列組合必為
可行解。
3.3.2 演算法演化流程
粒子群演算法的初始粒子群是以隨機的方式產生，經由
迭代進化搜尋來求解。在每一個迭代裡，粒子藉由兩種搜尋
記憶改變搜尋方向，第一種為個體粒子最佳記憶值，記為
pbest，另一種為群體最佳記憶值，記為gbest，演算程序如圖
5。
Step1 需要設定演算法的粒子數、慣性權重、學習因子1、學
習因子2 及演化停止迭代數。
Step 2 為隨機產生初始粒子的位置。
Step 3 的適應性函數是指粒子所代表的解，在本研究中即為
排程的總完工時間。
Step 4 為尋找pbest 及gbest。
Step 5 為對gbest 作兩點交換，例：若gbest = [2 2 3 1 1 3 3 2
1]，隨機找gbest的兩點互換，假設抽到第二個位置和
第五個位置交換，交換後的粒子gbest’ = [2 13 1 2 3 3
2 1]，若gbest’優於gbest，則gbest’取代原gbest，此動作
是為了避免結果陷入局部最佳，因此採用類似基因演
算法的突變方式。
Step 6 為使用演算法公式(2-1)、(2-2)進化粒子群。
Step 7 為修正粒子群，原始的粒子群演算法是設計用來求解
連續型最佳化，而組合最佳化的問題是離散的型式，
因此本研究使用Xia and Wu (2005)提出的一種連續轉
離散的粒子群進化方式來求解排程問題，以四捨五入
的方式調整粒子進化過程中產生的小數點，使粒子維
持在整數的型態，但由於會產生不合理的解，因為完
成四捨五入的動作後，工件數可能發生變動，因而產
生不合理的粒子。例如：S= [0, 1, 3, 1, 0, 2, 0, 1, 3, 2] 的
原始例子各有3 個0、1、2、3，帶入公式後產生新粒
子S = [0.1, 1.4, 2.9,1.5, 1.2, 2, 0.9, 1.5, 2.6, 2.1]，四捨五
入調整後S: [0, 1, 3, 2, 1, 2, 1, 2,1, 2, 3, 2] 少了兩個0
多一個2，因此會產生不合理之解。於是本研究採用隨
機補足的方式，隨機選出多的作業，並將缺少的作業
代入，調整為合理的粒子，調整後S:[0, 1, 3, 0, 1, 2, 1, 2,
3, 0]。
最後，若迭代數在大於演化停止次數之前回到Step 3，
直到迭代數大於演化終止次數之條件。如此不斷演化，求得
近似最佳解。
5係增加，為了確保求解品質，及節省運時間，在田口實驗中
把迭代數分成50、125、200 三種水準。
本研究的田口實驗考慮六個因子，各因子有三個水準，
使用的直交表為L27(313)，每種參數組合進行三個不同問
題，因此每個田口實驗會有27×３共81 個輸出值。以下每個
不同問題規模的田口實驗均考慮慣性權重、最大粒子前進速
度、學習因子1、學習因子2、粒子數、演化迭代次數等六個
因子，表3 為田口實驗設計因子控制表。因為實驗的輸出值
為總完工時間，因此表示得到的結果愈小為愈佳，因此田口
實驗的訊雜音比(Signal-to-Noise ratio，SN 比)選擇望小特
性，公式如下：
表 2 田口實驗設計因子控制表
田口實驗設計１：
田口實驗設計1 為在問題規模為3×3、加工時間為集
中、搬運時間為短、批量分割數量為5 的環境下，對粒子群
演算法進行參數測試，田口實驗考慮的因子及水準如表2，每
種組合有3 個問題，使用L27(313)直交表，共進行27×３共81
次實驗結果。實驗結果如圖2之SN 比因子效應圖，SN 比回
應表請見附錄一，得到的最佳參數組合如下：慣性權重為1、
最大粒子前進速度為0.5、學習因子1 為1.25、學習因子2 為
2、粒子數為100、演化迭代次數為50。
田口實驗設計 2：
田口實驗設計2 為在問題規模為6×6、加工時間為集
中、搬運時間為短、批量分割數量為5 的環境下，對粒子群
演算法進行參數測試，田口實驗考慮的因子及水準如表2，每
種組合有3 個問題，使用L27(313)直交表，實驗結果如圖3 之
SN 比因子效應圖，得到的最佳參數組合如下：慣性權重為
1.5、最大粒子前進速度為1.5、學習因子1 為2、學習因子2 為
0.5、粒子數為60、演化迭代次數為200。
田口實驗設計3：
田口實驗設計3 為在問題規模為9×9、加工時間為集
中、搬運時間為短、批量分割數量為5 的環境下，對粒子群
演算法進行參數測試，田口實驗考慮的因子及水準如表2，每
種組合有3 個問題，使用L27(313)直交表，實驗結果如圖4 之
SN 比因子效應圖，得到的最佳參數組合如下：慣性權重為
0.5、最大粒子前進速度為0.5、學習因子1 為2、學習因子2 為
0.5、粒子數為100、演化迭代次數為200。
田口實驗設計 4：
田口實驗設計4 為在問題規模為12×12、加工時間為集
中、搬運時間為短、批量分割數量為5 的環境下，對粒子群
演算法進行參數測試，田口實驗考慮的因子及水準如表2，每
種組合有3 個問題，使用L27(313)直交表，實驗結果如圖5 之
SN比因子效應圖，得到的最佳參數組合如下：慣性權重為
1.5、最大粒子前進速度為0.5、學習因子1 為2、學習因子2 為
2、粒子數為100、演化迭代次數為200。
田口實驗設計 5：
田口實驗設計5 為在問題規模為12×12、加工時間為集
中、搬運時間為短、批量分割數量為5 的環境下，對粒子群
演算法進行參數測試，田口實驗考慮的因子及水準如表3，每
種組合有3 個問題，使用L27(313)直交表，實驗結果如圖6 之
SN比因子效應圖，得到的最佳參數組合如下：慣性權重為
1.5、最大粒子前進速度為0.5、學習因子1 為2、學習因子2 為
0.5、粒子數為100、演化迭代次數為125。
圖 2 SN 比因子效應圖(3*3)
圖 3 SN 比因子效應圖(6*6)
圖 4 SN 比因子效應圖(9*9)
7圖 8 加工時間與移轉批量方式之改善率
圖 9 批量分割數與移轉批量方式之改善率
在三個圖中可以看到共同之處，就是批量由不分批至二
等批時，改善的幅度為最大，之後，隨著批量數增加改善率
也會增加，但是改善的幅度也隨著批量增加而減緩。另外，
從圖7中可以看得出在大規模的問題中，批量分割帶來的改善
效益會比小問題多。圖8可以看得出，加工時間集中時批量分
割的效益比分散時多。圖9則能夠看得出，搬運時間較短時，
使用批量分割會有較佳的改善效果。
4.5 搬運時間之敏感度分析
為了更進一步的瞭解若調整搬運時間對排程結果之影
響，以及與批量分割之關係，本小節將對搬運時間進行敏感
度分析。進行敏感度分析的問題規模為9×9，各作業加工時間
為Uniform(30,70)隨機產生，調整的搬運時間為0、10、20、30、
40。各種搬運時間對批量分割數的總完工時間及改善率如表6
及表7，並繪製趨勢圖，如圖10 及圖11。
由求解結果可以觀察到，搬運時間愈小則總完工時間也
愈小，反之，搬運時間愈大，總完工時間也愈大。在改善率
方面，搬運時間較小時，批量分割的改善率也較大。換言之，
搬運時間的大小的確會顯響到批量分割時改善的效果，當搬
運時間較短時，使用批量分割帶來的效益的確是大於較長搬
運時間。
表 6 搬運時間進行批量分割之敏感度分析表（總完工時間)
表 7 搬運時間進行批量分割之敏感度分析表（改善率)
圖 10 不同搬運時間進行批量分割之敏感度分析
（總完工時間）
圖 11 不同搬運時間進行批量分割之敏感度分析
（改善率）
出席國際學術會議心得報告
計畫編號 100-2221-E-224-031-
計畫名稱 應用粒子群演算法於轉移機台之批量分割之研究
出國人員姓名
服務機關及職
稱
蘇純繒
國立雲林科技大學工業工程與管理研究所教授
會議時間地點 July 16-19, 2012, Las Vegas, Navada, USA
會議名稱 The 2012 International Conference on Image Processing, ComputerVision, & Pattern Recognition (IPCV’12)
發表論文題目 Depth Map Reconstruction Using Wavelet Analysis
一、參加會議經過
本次The 2012 International Conference on Image Processing, Computer Vision, & Pattern Recognition
(IPCV’12)研討會於100年7月16日至19日在在美國拉斯維加斯市的Monte Carlo Resort舉行。研
討會於7月15日下午3:00到晚上21:00分受理報到手續，7月16日上午08:30進行專題演講，首位致
詞者為University of Georgia的Professor Hamid R. Arabnia，而上午安排三場演講，第一場演講者
是Profesor Professor David A. Patterson，講題是“Teaching Software Engineering for Software as a
Service using Massive Open Online Courses”，他的演講內容兼具學務理論與實務應用，非常精
采，獲得所有與會人士的一致好評。其餘二位演講者分別是Haym Hirsh及Flavio Villanustre。所
有的演講涵蓋產業界與學術界的最新發展與未來趨勢，讓與會人士深感受益良多。下午隨後即
展開1個場次共計有12位的學者進行論文口頭發表，另有10位學者以海報的方式在現場呈現研究
成果，晚上則有正式的歡迎晚宴，讓所有的與會學者可以在輕鬆的氣氛下進行交流與互動。我
們的論文被安排在7月17日上午Session 3-IPCV的場次發表，該場次的時間是 09:00到09:20，
Session 主持人是來自Bowling Green State University的Dr. Jong Kwan "Jake" Lee教授，我們是第
四篇報告的論文，本Session另有一位作者來自台灣清華大學、一位來自馬來西亞、一位來自巴
基斯坦、一位來自中國大陸、一位來自巴西、一位來自約旦、一位來自印度，非常的國際化，
也因為發表的論文研究領域極為不同，但是與會學者都對其他學者發表的研究內容有極高的興
趣，主持人Dr. Jane Dong還與與會人士討論不同論文之特殊貢獻與獨到之處，看法非常精闢，也
引導與會人士發表自己的看法，讓大家有良好的互動，收獲豐富。研討會三天下來，每位與會
人士都覺得收獲豐富，也對主辦單位各項活動的貼心安排極為滿意。
二、與會心得
本次會議在酷熱且乾燥的賭城拉斯維加斯市舉辦，在研討會中碰到許多來自各國的學者，大家
都借助出席研討會來促進學術交流及提昇學術地位，所有與會者能夠聆聽到更多不同領域的文
章，獲益良多。而每一次的國際研討會都有不同的收穫，並且所遇到的專家學者都不盡相同，
各國的學者各有特色，大家一起分享自己的成果，相互知識交流，結交不少業界與學界朋友，
此些專家學者經歷皆非常豐富，未來筆者期望能夠邀請這些學者專家來校與學生演講，期望除
了增加學生的專業知識外更能增加其國際觀。因此，學校與各教育單位應多多鼓勵學生與教師
參與此類國際型之活動。最後，感謝國科會的支持與補助。


100 年度專題研究計畫研究成果彙整表 
計畫主持人：蘇純繒 計畫編號：100-2221-E-224-031- 
計畫名稱：應用粒子群演算法於轉移機台之批量分割之研究 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 1 1 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 1 1 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
