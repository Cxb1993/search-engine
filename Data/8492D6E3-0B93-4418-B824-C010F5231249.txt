 i
?? 
 
?????????????????????????????????
???????????????????????????????????
?????? AFBM (Assured Forwarding Buffer Management)? RTD 
(Responsiveness Throughput Delay)???????????????? N?(?
???)?N ?????????????????????????????
????????????????????AFBM????????????
???????????????????? TCP flows? UDP flows????
?????????????????????????? flows ?????
??AFBM?????? DP?? flow? throughput????????????
????????RTD ????????? delay requirement ? loss 
requirement???????????? UDP? TCP????????????
???????????????????????????????????
?????????? 
 
??????????AFBM?RTD????????????????? 
 iii
?? 
 
????……………………………………….………………………………………i 
????………………………………………………………………………………ii 
??………………………………………………………...…………………………iii 
??……………………………………………………………………………………1 
????………………………………………………………………………………3 
????…………………………………………………………………..…………..4 
????……………………………………………………………………………....6 
??AFBM(Assured Forwarding Buffer Management)[11]???..……... 6 
??RTD (Responsiveness-Throughput-Delay)???..………………….. 9 
?????…………………………………………………………………………..17 
??AFBM(Assured Forwarding Buffer Management)[11]???…. …..17 
A. ? TCP flow………………………………………………..........17 
B. ? UDP flow…………………………………………………….19 
??RTD (Responsiveness-Throughput-Delay)???……………… …..20 
A. Throughput……….……………………………………………..21 
B. Throughput?Loss ratio? utilization..…………………………21 
C. Bandwidth differentiation……..………………………………..24 
D. TCP protection………………………………………………….26 
E. Fairness…………………………………………………………27 
F. Goodput…………………………………………………………27 
????…………………………………………………………………..30 
???????????………………………………………………..30 
????……………………………………………………………………………..31 
??????………………………………………………………………………..34 
????????????………………………………………………………..35 
 
 
 2
????????????????? 
?????????????????????????????????
???????????????????????????????????
???????????????????????(First In First Out, FIFO)??
???????????????????? FIFO ????????(priority 
queuing)???????????????????????????????
???????????????????????????????????
???[8]???????????????????????????????
??(Round Robin, RR)?????????????????????????
???????????????????????????????????
??????????(Homogeneous)??????????(Heterogeneous)??
????????????(Weighted Round Robin, WRR) [9]????????
??????????????????????????? 
?????????????????????????????????
???????????1.?????(Edge Router, ER) 2.?????(Core Router, 
CR) [10]???????????(Ingress)???(Egress)??????????
?(Classification)???(Policing)???(Marking)?????(Remarking)???
(Scheduling)?????????????????????????????
???????????????????????????????????
?????????????????????????? 
????????????????????????????????
???????????????????????????????????
?????????????????? 
 
 4
???? 
 
?????????(node)?????????????????????
???????(?????????)??????????????????
??????????????? 
?????????????????????????????????
???????????????????????????????????
???????????????????????????????????
??????????????????????RED (Random Early Detection, 
RED) [19,20,21,22]?GREEN (Global Random Early Estimation for Nipping, GREEN) 
[10]???????????????????????????WRR (Weight 
Round Robin, WRR) [23]?DRR (Deficit Round Robin, DRR) [24]?WFQ (Weight 
Fair Queue, WFQ) [25]?????????????????????????
????????????????????????????? 
?????????????????????????????????
???????????????????????????????? Drop 
Tail?????????????????????????????????
?????????????????????Random Drop????????
???????????????????????????????????
????????? Drop Tail?????????????????????
?????????? 1? Early Random Drop (ERD)???????????
?????????????????????????????? ERD ??
?????? RED?????? 2???????????????????
???????????????????????????????????
??(exponential weighted moving average)?????????????????
?(Maximum Threshold)??????(Minimum Threshold)?????????
???????????????????????????????????
???????????????????????????????????
??????????????????? 
???????????????????CHOKe [26]?CHOKeW [27]?
CHOKe?????? RED???????“matched drops”?? RED????
??????????????????? Flow ID????????????
???? Flow ID????? Flow ID??????????????????
??????????????????? RED????CHOKe??????
???????“unfriendly”?“unresponsive”? flow ???????????
global synchronization?? TCP flows???????????????????
??????????? 
 
 
? 1  Early Random Drop 
 
 6
???? 
 
??AFBM (Assured Forwarding Buffer Management)[11]??? 
 
RIO (RED with In and Out, RIO)??? RED??????????????
????????????????????????(MinThreshold)?????
???????????????????????????????????
???????????????????????????????????
???????????????????????????????????
????????????????????? RIO ???????????
??????????WRED (Weighted RED, WRED) [17]?WRED????
RED????????????WRED???MaxP??????????(drop 
precedence, DP)?????? DSCP (DiffServ Codepoint, DSCP)???????
??????????????????????(Assured Forwarding, AF)??
???????? RIO?WRED????????????????????
? DP???????????[7]??? AF PHB Group???? AF????
????? AF1~AF4????????????????????????
DP1~DP3? 
AFBM???????????????????????????? burst
???????????????????????????????????
???????????????????????????????????
? AFBM????????????????? Drop Tail?????????
?????????????????????????????????AFBM
??????????????? AF PHB Group? AF??????????
????DP1~DP3???????????????????????????
????? 
???? AFBM (Assured Forwarding Buffer Management, AFBM)????
?????????(Assured Forwarding, AF)??????(Buffer Management, 
BM)?????????? DiffServ?????????(Core Router)????
???????????????????????????????????
?????????? AFBM??????????????????? 
????????????????AFBM????????????????
??????????????????????????? AFBM??? RED
????????????(threshold)??????????????????
?????????????????AFBM???????????????
??????? 
AFBM??????????????????????????????
??????????????????????????????????
???????????????????????????????????
???????????????????????????????????
???????????????????????????????????
?????????????????????AFBM???? 2??????
?????????????????????? 
?????????????????????????????????
 8
 
 
 
 
 
 
 
 
 
? 3  AFBM??? 
 
????? AFBM?????? 3???????????? 4?????
?????? P ???????????????????(3)???????
??????????????????????????????????
??????????????????????? P???(3)??????(2)
?????? P????????????????????????????
????? 
 
P = 2^(– S * N/ K * (DPi))  (3) 
 
 
 
? 2 ???? AFBM???????? 
 
 
 
 
 
 
 
 
Notation Meaning Initial Value 
P ???? 0 
q ????? null 
Pk ????? null 
K ?????? given 
S ???????? null 
DPi flow i? drop precedence null 
N ??? given 
For each packet arrival (for a certain AF) 
{ 
if ((q + Pk)>K) 
  { drop the packet; 
  }  
else { P = 2^(- S/(DPi*mean_pkt_size)) 
  if (random( ) < P) 
{ drop the packet;  
} 
else { accept the packet; 
      } 
} 
 
 10
?????????????????????????? 
??? QoS????????????????? delay??? flows??
?????? delay???????????????? 1????? delay??
?????????????? flow ???(throughput)??????????
????????????????????? 
??????????RTD ????????????????????
??????? RTD?????????????????(threshold)????
?? RED ??????????????????????????????
? RTD????????? 
RTD ????????????????????????????(??
??)?????????????????????????????????
???????????????????????????????????
??????????????????????????????????RTD
? (4)???????????? S????????????(5)??????
?? K????????? q????????????? S??(4)??? P?
????????? 
 
P = 1/ S  (4) 
 
S = K – q  (5) 
 
(2.1)??????????????????????? S???????
???????????????????????????????????
???????????????????????????????????
????????????????????? ?????????????
???????????????????????????????????
???????????????????RTD????????????-??
??????????????????????? 
????????????????(QoS)??????????????
???????????????????????????????????
???????????????????????????????????
???????(delay)???(throughput)?????????????????
???????????????????(responsiveness)?????????
???(unresponsiveness)????????????????????????
???RTD ???????????????????????RTD ????
? IntsServ ???????????? flow ???????????????
???????????????????????????????????
DiffServ????????????????“??”????????????
???????????????????(???)??? 
???????????RTD??????????????????(6)?
???????????????????????????????????
???(throughput ratio)????????????(loss ratio)????(7)???
???????????????????????????????????
???? 
 12
 
? 5 ???????? 
 
?(11)??RTD ???????????????? P?(11)??????
??? q??????? Pk[i]???????? B?????????????
????????????????????????(? 0)????????
???????????(??)?????????? 1??????????
???? 1(??????)???????????????????????
??????????????????????????? 0????????
??????????????? 0(?????)? 
?????????????????????????????????
???????????????????????????????????
???????????????????????????????????
???????????(10)??????????????????????
????????????(12)?????????????????????
????? 
 
P = 1/ E[i]  (12) 
 
??(10)??(12)??????????????????? loss ratio??
????(??)????? loss ratio??? 1??????????? loss ratio?
????????????? 
?????????????????(responsiveness)?????????
TCP/IP?????????????????? TCP? UDP?TCP?????
???????????????????????????????????
??????????? UDP ?????????????????????
?????????????UDP ???????????????????
????????????????????? UDP ???????????
???????????????????????????????????
?????????????? responsive ????? TCP ???unresponsive
???? UDP?????? TCP-friendly rate control (TFRC) [13]??????
???????????? responsive????? TCP???unresponsive??
?? UDP??????????????? TFRC? UDP?????????
????????????? RTD ???????????????
(responsiveness)????????? 
?? TCP?????????? RTD????????????????
???????????????????????????????????
 14
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
? 6  RTD??? 
 
??? RTD ???[11]??????????????????????
??????????? 7??? 
?????????????? flow ????????????????
???????? 
????????? delay ????????????????????
??????? delay ??? delay ???????????????????
Initialization( ); 
while (system up) 
{ for (each packet arrival) 
{ i = the flow of arrival packet; 
 if (q + Pk[i] > K)  P = 1; 
 else 
 { S = K – q; 
   if ((q + Pk[i])/ B > delay[i])  
         P=1;  
      else {  P = loss[i] / (S/ mean_pkt_size[i]); 
if (random( ) < P) 
 P = 1; 
          } 
   if (flow i responsive and P != 1) 
  {  ∆q[i] = q + Pk[i] – q[i]; 
     if (∆q[i] < 0) Cp[i] = 0; 
     else if (∆q[i] > ∆qpre[i]) Cd[i] = S/ ∆q[i]; 
     if (Cp[i] > Cd[i])  P = 1; 
  } 
      } 
 if (P == 1) 
    drop the packet; 
 else {  if (flow i responsive) 
   { q[i] = q + Pk[i]; 
    ∆qpre[i] = ∆q[i]; 
    Cp[i]++; 
   } 
    accept the packet; 
  } 
   } 
} 
 16
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
? 7 ???? RTD??? 
 
 
 
 
 
 
 
 
Initialization( ); 
while (system up) 
{ for (each packet arrival) 
{ 
 if ((q + Pk) > K or (q + Pk)/ B > delay )  DF = 1; 
 else 
 {    S = K – q; 
         P = loss / (S/ K)* N ; 
      if (flow responsive) 
   {   
     if ((1 – (Cp * P)) < =0) DF = 1; 
     else{ P = min(max(P/ (1–Cp * P), 0), 1); 
   } 
if (random( ) < P)  DF = 1; 
      } 
 if (DF == 1) 
{ 
    drop the packet; 
       DF = 0; 
       Cp = 0; 
     } 
 else  
{   
if (flow responsive) 
   { 
    Cp++; 
   } 
   accept the packet; 
  } 
   } 
} 
 18
AFBM TCP Throughput
0
100
200
300
400
500
600
700
800
150 300 450
TCP flows
T
C
P
 
t
h
r
o
u
g
h
p
u
t
DP1 DP2
DP3
 
? 9 ?? TCP flow???? DP? Throughput 
CHOKeW TCP Throughput
0
50
100
150
200
250
300
350
400
150 300 450
TCP flows
T
C
P
 
t
h
r
o
u
g
h
p
u
t
w1 w2
w3
 
? 10 ?? TCP flow???? w? Throughput 
ARED TCP Throughput
0
50
100
150
200
250
300
350
400
150 300 450
TCP flows
T
C
P
 
t
h
r
o
u
g
h
p
u
t
flow1
flow2
flow3
 
? 11?? TCP flow?? Throughput 
 
 
 20
 
ARED Bandwidth differentiation
0
100
200
300
400
500
3 6 9
UDP flows
t
h
r
o
u
g
h
p
u
t
w1
w2
w3
 
? 14 ?? UDP flow?? Throughput 
 
 
 
??RTD (Responsiveness-Throughput-Delay)??? 
 
??????????? RTD?CHOKeW?ARED?Blue?REM?RIO ?
AQM ?????? RTD ??????? NS2 ?????????? ARED?
Blue?REM?RIO?????? NS2???????CHOKeW???????
[31]???????? CHOKeW???????? 
 
 
? 15 CHOKeW??????? 
 
??????????????????? 1Mb/s???????? 500?
????????????? 1 kByte????????????? 10Mb/s??
? links??????? 1 ms? 
?????????? CHOKeW???????? CHOKeW??????
Lth = 100 packets?L- = 175 packets?p+ = 0.002?? p- = 0.001?RED??????
minth = 100 packets?maxth = 200 packets?gentle = true?pmax = 0.02?EWMA 
weight = 0.002?RIO ??????? out traffic ? minth_out = 100 packets?
 22
?? 17??????????????RTD??????? TCP Throughput
???????????? 19???? UDP ? Throughput ??? TCP ?
Throughput??? 18 ???? CHOKeW ? delay ????????????
22??? CHOKeW? UDP Throughput???? 0?????? UDP????
?? 20? RTD???? loss ratio????????????????????
???RTD????????????????????????? TCP flows
? loss?????????????????????? 
 
TCP throughput
40
50
60
70
80
90
100
20 30 40 50TCP flows
t
h
r
o
u
g
h
p
u
t
RTD
Blue
REM
A-RED
 
? 17 ??? TCP flow?? TCP Throughput 
 
UDP average delay time
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
20 30 40 50TCP flows
s
e
c
o
n
d
(
s
)
RTD CHOKEW Blue REM A-RED
 
? 18 ??? TCP flow?? UDP?????? 
 
 
 24
CHOKEW throughput
0
100
200
300
400
500
600
700
800
900
1000
20 30 40 50TCP flows
t
h
r
o
u
g
h
p
u
t
UDP flows
TCP flows
 
? 22  CHOKeW??? TCP flow??? TCP? UDP Throughput 
 
 
C. Bandwidth differentiation 
 
??????????TCP flows 50~200?????????????? loss 
requirement?CHOKeW??? w??? 1, 1.5, 2??????????RTD?
?? loss requirement? 0.5? 0.1???????? 0.3, 0.2? 0.1??????
??? 0.4, 0.3, 0.2? 0.1??? delay requirement???? 5?????????
????? RTD ?? CHOKeW ????????? 23?? 24?? 25?? 26
?? 27?????????RTD???? flow? Throughput????????
CHOKeW????? 
 
RTD Bandwidth differentiation
200
300
400
500
600
700
800
50 100 150 200TCP flows
T
C
P
 
t
h
r
o
u
g
h
p
u
t
loss=0.5
loss=0.1
 
? 23 RTD????????? loss???? TCP flows? Throughput 
 26
RTD Bandwidth differentiation
0
100
200
300
400
500
600
700
75 150 225 300
TCP flows
T
C
P
 
t
h
r
o
u
g
h
p
u
t
loss=0.4
loss=0.3
loss=0.2
loss=0.1
 
? 27 RTD????????? loss???? TCP flows? Throughput 
 
 
D. TCP protection 
 
?? flows? TCP flows 100??UDP flows? 1~10??? CHOKeW???
????w????? loss requirement??? delay requirement???UDP delay 
requirement??? 2?? 3.5??TCP??? 5??? delay requirement? TCP
??????????RTD???? CHOKeW? RIO?????? 28???
CHOKeW? TCP protection??????????????????? UDP?
Throughput???????????????????RIO? TCP protection?
?????????? RTD????UDP flows? delay requirement??? 2?
??UDP? Throughput??? 0???? 3.5?????? 50Mb/s?????
RTD?????? delay requirement?????? UDP? throughput????
TCP protection????? CHOKeW?????? 
 
TCP protection
0
100
200
300
400
500
600
700
800
900
1000
1 2 3 4 5 6 7 8 9 10
UDP flows
T
h
r
o
u
g
h
p
u
t
CHOKEW UDP CHOKEW TCP RIO UDP
RIO TCP RTD delay2s UDPRTD delay2s TCP
RTD delay3.5s UDPRT  delay3.5s TCP
 
圖 28 在不同 UDP flows時的 TCP和 UDP之 Throughput 
 
 28
??????????? delay requirement??????? UDP? Goodput??
????????????????????? 
 
 
 
UDP throughput
0
100
200
300
400
500
600
700
800
900
1000
1 2 3 4 5 6 7 8 9 10UDP flows
t
h
r
o
u
g
h
p
u
t
RTD REM ARED CHOKEW Blue
 
? 30 ?? UDP flows? UDP Throughput 
 
 
 
UDP goodput
0
100
200
300
400
500
600
700
800
900
1000
1 2 3 4 5 6 7 8 9 10UDP flows
G
o
o
d
p
u
t
RTD REM ARED CHOKEW Blue
 
? 31 ?? UDP flows? UDP Goodput 
 
 30
???? 
 
?????????????????????????????????
????????????????????(IntServ)??????(DiffServ)?
?????????????????????????? scalability????
???????????????????????????? QoS? per-class 
QoS??????????????? 
????????????????? scalability???????????
???????????????????????????????????
????????? 
???[11]?????????? DTR (Delay-Throughput-Responsiveness)
???????????????????????????????????
???????????? DTR ????????????????????
????????????????????????????? RTD????
???????????????????????????????????
????????????????????????? delay requirement? loss 
requirement ??? throughput?????????????????????
??RTD ??????????????????????????????
? DTR?????????????????????????????? 
???????????[11]????????????????????
?????????????AFBM (Assured Forwarding Buffer Management)?
???????????????????????????????????
????????????????????????? 
 
 
 
??????????? 
 
?????????????????????????????????
???????????????????????????????????
???????????????????????????????????
????????????????? 
?????????????????????????????????
???????(DiffServ)???????????(AF)??????????
???????????????????????????????????
???????????????????????????????????
???????????????????????????????????
??????????????????????? 
?????????????????????????????????
???????????????????????????????????
?????????(responsive)????????????????-??-??
(RTD)????????????????????????????????
???????????????????????????????????
???????????????????????????????????
???????????????????????????????????
 32
???? 
 
[1] ????,“?? QoS???????,”???? 131?,2002  6?. 
[2] R. Braden, D. Clark, and S. Shenker, “Integrated services in the Internet 
architecture: an overview,” Internet RFC 1633, June 1994. 
[3] S. Blake, D. Black, M. Carlson, E. Davies, Z. Wang, and W. Weiss, “An 
architecture for differentiated services,” Internet RFC 2475, Dec. 1998. 
[4] S. Shenker, C. Partridge, and R. Guerin, "Specification of Guaranteed quality of 
service," Internet RFC 2212, Sep. 1997. 
[5] J. Wrockawski, "Specification of the controlled-load network element service," 
Internet RFC 2211, Sep. 1997. 
[6] V. Jocobson, K. Nichols, and K. Poduri, "An expedited forwarding 
PHB,"RFC2598, Internet Engineering Task Force, June 1999. 
[7] J.Heinanen, F. Baker, W. Weiss, and J. Wrociawski, "Assured forwarding PHB 
group,"RFC2597, Internet Engineering Task Force, June 1999. 
[8] Larry L. Peterson, Bruce S. Davie?, ??? ??,“????,”????, ?
90. 
[9] M. Katevenis, S. Sidiropoulos, and C. Courcoubetis, “Weighted round-robin cell 
multiplexing in a general-purpose ATM switch chip,” IEEE Journal on Selected 
Areas in Communications, vol. 9 8, pp.1265-1279, Oct. 1991. 
[10] Y. Thomas Hou, Zhenhai Duan, Zhi-Li Zhang, and Takafumi Chujo, "Providing 
Scalable Support for Multiple QoS Guarantees: Architecture and Mechanisms," 
IEEE, 2001. 
[11] ????, “????????,”???????????????,? 92?
6?. 
[12] R. Guerin and V. Peris, "Quality-of-service in packet network: basic 
mechanisms and direction," Computer Networks, vol. 31, 1999, pp.169-189. 
[13] L. C. Hwang, C. Y. Ku, S. J. Hsu, and H. Y. Lo, "QoS Buffer Management of 
Multimedia Networking with GREEN algorithm," J. OF Comm. and Networks, 
vol. 3, No. 4, pp. 334-341, Dec. 2001. 
[14] S. Floyd, J. Padhye, J. Widmer, "TFRC, Equation-based congestion control for 
unicast applications: simulation scripts and experimental code," Feb. 2000. 
[15] J. W. Cho, and D. H. Cho, "Dynamic buffer management scheme based on rate 
estimation in packet-switched networks," Computer Networks, vol. 39, 2002, 
pp.769-787. 
[16] D. D. Clark, and W. Fang, "Explicit allocation of best-effort packet delivery 
sevvice," IEEE/ACM Trans, on networking, vol. 6, no. 4, pp. 362-373, Aug. 
1998. 
[17] R. Makkar, R. Lambadaris, I. Salim, J.H. Seddigh, N. Nandy, and B. Babiarz, 
"Empirical study of buffer management scheme for Diffserv assured forwarding 
PHB," Computer Communications and Networks, 2000. Proceedings. Ninth 
International Conference on, 16-18 Oct. 2000 
[18] www.iii.org.tw/ncl/document/Qos_web.htm 
[19] S. Floyd and V. Jacobson, "Random Early Detection Gateways for Congestion 
Avoidance," IEEE/ACM trans. networking, vol.1, no.4, pp.397-413, 1993. 
[20] O. Elloumi and H. Afifi, "Improving RED algorithm performance in ATM 
networks," IEEE GLOBECOM '97, vol.2, pp.1062-1066, 1997. 
[21] R. Guerin and V. Peris, "Quality-of-service in packet network: basic 
mechanisms and direction," Computer Networks, vol. 31, 1999, pp.169-189. 
 34
?????? 
 
????????????????????????????????
???????????????????????????????????
???????????????????????????????????
??????????????????????????????? ns2??
???????????????????????????????????
???????????????????????????????????
???????????????????????????????????
????????????????? 
 
 
 
 
???????????? 
                                                             
???? NSC95-2221-E-214-025 
???? ?????????????????(2/2) 
?????? 
??????? 
??? ?????????? 
?????? 95/11/14 ~ 95/11/17?? 
???? Tencon '06 - IEEE Region 10 Conference 
?????? A Delay Curve with Markovian Recursion for Deadline Calculation in SCED 
 
???????? 
 
Tencon '06 - IEEE Region 10 Conference???????????????????
??????? Tencon?????? plenary sessions? 77??????????? 893
?????? 513??????????????????????????????
??????????? 
?????????(A Delay Curve with Markovian Recursion for Deadline 
Calculation in SCED)?????????????????????????????
??????????????????????????????????????
???????????????????????????????? SCED(???
??????????????)????????????????????????
????????????? Dr. Wang?????????????????????
??????????????????????????????????????
??????????????????????????????????????
??????????????????????????????????????
??????????????????????????????????????
??????????????????????????????????????
???????????????????????????? 
 
 
