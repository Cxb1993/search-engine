use value-added services in e-commerce, service 
providers must provide a secure, efficient, flexible, 
fair, privacy-protected, and available environment. 
By the way, in recent years, bilinear pairings have 
attracted many scholars to investigate its properties 
and applications. Using bilinear pairings in 
cryptographic protocols is another choice in many 
secure value-added e-commerce in the near future. For 
providing a secure, efficient, flexible, fair, 
privacy-protected, available value-added service in 
e-commerce, the value-added service should take the 
following requirements into consideration: (1) 
privacy protection: a participant can protect his/her 
identity privacy if needed； (2) traceability: a 
trusted third party can trace a participant’s real 
identity fairly if needed； (3) authentication: no 
one can pretend an eligible participant to use 
his/her service； (4) unforgeability: the content of 
a real transaction cannot be forged； (5) non-
repudiation: a participant cannot repudiate the real 
transaction； (6) public verification: anyone can 
verify the transaction if needed； (7) transaction 
unlinkability: there does not exist any link among 
any two transactions； (8) low cost: the 
communication and computation cost should be as low 
as possible； (9) single registration: a participant 
only needs to register once and can use all 
services； (10) easy revocation: the manager can 
easily cancel a service request if needed. 
In this project, we design and implement secure, 
efficient, flexible, fair, privacy-protected, 
available value-added services for e-commerce using 
bilinear pairings. We would design and implement 
three value-added services including an auction 
service, a payment service, and an integrated payment 
and auction service in general e-commerce 
environments that satisfy the above ten requirements. 
Through our proposed project, we will give a set of 
good solutions for value-added services in e-commerce 
environments. 
英文關鍵詞： bilinear pairing, cryptographic protocol, e-commerce 
 1
行政院國家科學委員會專題研究計畫成果報告 
計劃名稱: 使用雙線性配對之電子商務安全付費服務之研究 
The research of secure value-added services in e-commerce using 
bilinear pairing 
計畫編號：NSC 99-2628-E 327-003  
執行期限：99 年 08 月 1 日至 100 年 10 月 31 日 
主持人：莊文勝    
執行機構及單位名稱 國立高雄第一科技大學資訊管理學系(所) 
計劃參與人員：許云瑜、邱仁佑、黃政嘉、呂威廷、黃筱鈞、 
              陳明德 
 
一、中文摘要 
由於網路與資訊技術的快速發展與大量應
用，傳統之商務活動諸如：購物、拍賣或付款等
皆可藉由其達成。但網路上與資訊系統內充滿著
各類安全問題，是病毒與駭客之溫床，若沒有適
當之安全防護與管理機制，這些活動將受到嚴重
之抑制與損失。有別於以往的面對面的實體交易
模式，網路上的交易方式，其安全性、公平性、
可用性、隱私性等都必須要額外加以考慮，以讓
使用者可以安心的使用網路加值服務。另外近年
來隨著雙線性配對運算與性質受到學者的普遍
重視，其提供了密碼協定設計上另一個選擇。而
隨者一些學者的研究，最近一些雙線性配對運算
之研究，其運算效能上也有不錯的改進。隨著這
些基本技術的快速發展，未來基於雙線性配對的
安全電子商務加值服務將是迫切需要的加值服
務之一。我們歸納目前相關的研究成果得知，下
列的需求對於安全的電子商務付費服務是相當
重要的：（1）匿名性: 參與者可保護其身份隱私; 
(2) 可追蹤性: 需要追蹤使用者身份時有一公平
的方式得知其身份; (3) 無法陷害: 沒有任何參
與者可以使用別人的身份參與付費服務; (4) 不
可偽造性: 交易內容不能被偽造; (5) 不可否認
性: 參與者無法否認他的交易內容; (6) 公平性: 
所有參與者的爭執，都必須有一公平處理方式; 
(7) 公開驗證: 需要公開驗證時, 能提供此功能; 
(8) 交易間無關聯性: 沒有任何人可以找出同一
個參與者在不同交易上的任何關聯性; (9) 低成
本：計算與通訊成本儘可能低; (10) 單次註冊: 
參與者只要註冊一次，就可多次使用付費服務; 
(11) 易於撤回: 管理者能容易且有效率的撤回
參與者的要求。本計劃中，我們使用雙線性配對
函數設計與實作電子商務上滿足上述基本需求
的安全付費服務。我們計畫設計一般環境下之電
子商務安全付費服務，包含：拍賣服務、付款服
務，整合式安全付費拍賣服務。由我們所提出的
計劃，我們將會在一般與行動平台上，對電子商
務安全付費服務，提供一系列基於雙線性配對技
術之最佳的解決方案。 
 
關鍵詞：雙線性配對、密碼協定、電子商務付費
服務 
 
Abstract 
Due to the fast progress and the huge amount of 
the use of network and information technologies, 
many traditional commerce activities, e.g. shopping, 
auction and payment can be achieved by it. Since 
there are many security problems in the networks 
and hosts, if no proper security and management 
mechanism is provided and used, these activities 
will be strictly inhibited. For attracting potential 
users to use value-added services in e-commerce, 
service providers must provide a secure, efficient, 
flexible, fair, privacy-protected, and available 
environment. By the way, in recent years, bilinear 
pairings have attracted many scholars to investigate 
its properties and applications. Using bilinear 
pairings in cryptographic protocols is another choice 
in many secure value-added e-commerce in the near 
future. For providing a secure, efficient, flexible, fair, 
privacy-protected, available value-added service in 
e-commerce, the value-added service should take the 
following requirements into consideration: (1) 
 3
安全付費服務。 
如前述，首先我們了解到電子商務讓我們可
以方便的上網進行購物和交易，雖然替我們的生
活帶來很大的便利性，相對地也會產生安全上的
問題，例如：在交易過程中可能會發生安全上問
題或一些敏感的個人隱私資料被洩漏。而近幾年
行動商務的模式被提出後，人們也可以透過手機
上網進行購物和交易的功能，更大大地增加生活
中的便利性，但是在無線上網的環境中，安全上
的問題也更加嚴重。 
另外客戶因跨區漫遊時所產生的金鑰管理、認
證、付費代理與服務計費問題也是行動通訊必須
處理的問題。因此經由相關文獻的探討和分析
[8,17,25,33,38]，發現這些付費服務的安全性、功
能性和計算與通訊成本雖然隨著學者們不斷提出
的方法而有所改善，但是我們在仔細的進行分析
與比較過後，仍發現其有可改善的空間與值得深
入探討和研究的議題。另外近年來隨著雙線性配
對運算與性質受到學者的普遍重視，其提供了密
碼協定設計上另一個選擇。而隨者一些學者的研
究，最近一些雙線性配對運算之研究，其運算效
能上也有不錯的改進。隨著這些基本技術的快速
發展，未來基於雙線性配對的安全電子商務加值
服務將是迫切需要的加值服務之一。而本計畫將
會對這些相關議題進行研究並且提出我們的解決
方案。 
我們的目的就是提出一系列高安全性和高效
能性的雙線性配對的付費加值服務，使其可以適
用在PC 上的環境，並且也適用於行動商務的環
境中，因而能夠滿足現代人在網際網路與行動商
務的通訊環境中進行安全的購物、拍賣、交易的
需求，透過我們提出的安全加值服務讓消費者可
以安心的在電子商務中使用各種加值服務。另外
我們也將利用現有的一些密碼元件實作我們的加
值服務。 
由於網際網路環境的不安全性，讓惡意的攻
擊者能夠利用這些漏洞來從事非法的行為，造成
客戶的敏感隱私資料被竊取、偽造顧客的資料去
詐領現金等問題，而這些不法的行為不單單只出
現在一般使用個人電腦的網際網路的環境中；而
智慧型手機作業平台的漏洞也一樣讓惡意的攻擊
者有機可乘，因此在行動商務的交易中也會經常
發生交易糾紛。為了防止上述的問題與糾紛，許
多學者提出有關電子現金付費服務相關的解決方
案[5,7,14,26]。本計劃利用各種密碼技術與方法，
設計與實作出我們在一般PC 環境下的線上電子
現金付費服務方案，而在使用手機的行動付款服
務方面我們將利用前端低成本的密碼技術與方
法，設計與實作出在行動商務上面的行動式電子
現金付費服務方案，以確保使用者不管是使用PC 
或是智慧型手機介面進行網際網路付款之安全性
與隱私性。 
為了解決上述的問題，我們將會使用橢圓曲
線 (Elliptic curves) 實 現 雙 線 性 配 對 (Bilinear 
pairings) 的特性，實作出一個實用且具有彈性的
線上電子現金付費服務方案，它適用於現實世界
中的網際網路環境。為了要達到匿名性的特性，
我們將採用了數位假名結合部分盲簽章的概念，
而顧客是使用相對應的假名私鑰來簽署交易。這
種新的方案，可以降低計算成本和通訊成本，並
且也可以保留可回復性和匿名性的性質。 
我們歸納目前相關的研究成果得知，下列的
需求對於安全的整合式電子商務付費服務是相當
重要的：（1）匿名性: 參與者可保護其身份隱私; 
(2) 可追蹤性: 需要追蹤使用者身份時有一公平
的方式得知其身份; (3) 無法陷害: 沒有任何參與
者可以使用別人的身份參與付費服務; (4) 不可偽
造性: 交易內容不能被偽造; (5) 不可否認性: 參
與者無法否認他的交易內容; (6) 公平性: 所有參
與者的爭執，都必須有一公平處理方式; (7) 公開
驗證: 需要公開驗證時, 能提供此功能; (8)交易
間無關聯性: 沒有任何人可以找出同一個參與者
在不同交易上的任何關聯性; (9) 低成本：計算與
通訊成本儘可能低; (10) 單次註冊: 參與者只要
註冊一次，就可多次使用付費服務; (11) 易於撤回: 
管理者能容易且有效率的撤回參與者的要求。根
據我們的文獻探討，目前並沒有任何研究能同時
滿足上述的需求，其計算與通訊成本也還有改進
的空間，而隨著最近幾年雙線性配對函數的被學
者廣泛的探討，雙線性配對之計算成本也有很多
的改善。本計劃中，我們將使用雙線性配對函數
設計與實作電子商務上滿足上述基本需求的一系
列安全付費服務。 
 
三、研究方法與成果 
本計畫針對目前大眾逐漸普及使用網際網路
進行付費服務的現象，在第一年將著重在一般使
用個人電個人電腦的網際網路的環境中最迫切的
安全付費服務。我們將分為設計與實作兩大部分
來大略描述本計劃提出的安全付費服務之線上電
子現金付費服務。另外其他安全付費服務，諸如：
安全拍賣服務與整合式安全付款與拍賣服務我們
已經有初步的構想，詳細的作法還需國科會經費
的支持以便做進一步的研究。我們下面將以電子
現金付費服務為範例來介紹。 
 5
    我們的部分成果目前已發表或被接受於國際
期刊或會議論文 [ 40,41, 42, 43]。目前網路環境越
來越成熟。未來可想而知網路安全之相關研究與
應用會蓬勃發展。 
 
五、計劃成果自評 
 
1. 研究內容與原計劃相符程度：本研究內容與
原申請計劃完全相符。 
2. 達成預期目標概要：本計劃已設計與完成使
用雙線性配對函數設計與實作電子商務上滿
足基本需求的安全付費服務。 
3. 有效用現有的資訊安全技術來設計安全防護
協定，順利達成目標，並培育出相關的安全
協定設計之研發人才。 
4. 研究成果的學術價值與應用價值：本研究成
果兼顧學術與應用層面，可予國內研究雙線
性配對函數設計與實作電子商務上滿足基本
需求的安全付費服務之相關研究機構參考。 
5. 適合在學術期刊發表或申請專利：本研究之
成果學術部分適合發表於國內外專業期刊，
而應用部分可申請專利。 
6. 綜合評估：本研究在國科會給予足夠之經費
下，已順利完成，其部分成果發表或接受於
於國際期刊或會議論文 [ 40,41, 42, 43]。因此
自評為佳。 
 
參考文獻 
 
[1]   Asokan, N., Janson, P., Steiner, M., 
Waidner, M., 1997. State of the Art 
in Electronic Payment Systems. 
IEEE Computer 30 (9), 28–35. 
[2]   Beuchat, J., Detrey, J., Estibals, N., 
Okamoto, E., Rodriguez-Henriquez, 
F., 2009. Hardware accelerator for 
the tate pairing in characteristic 
three based on Karatsuba–Ofman 
multipliers. In: Proceeding of 
Workshop on Cryptographic 
Hardware and Embedded Systems, 
CHES 2009, Lecture Notes in 
Computer Science, 5747. Springer, 
New York, pp. 225–239. 
[3]   Camenisch, J., Hohenberger, S., 
Lysyanskaya, A., 2005. Compact 
E-cash. In: Cramer,R. (Ed.), 
Advances in Cryptology- 
EuroCrypt’05, Lecture Notes in 
Computer Science, vol. 3494. 
Springer, New York, pp. 302–321. 
[4]   Camenisch, J., Lysyanskaya, A., 
Meyerovich, M., 2007. Endorsed 
E-Cash. In: IEEE Symposium on 
Security and Privacy, pp. 101–115. 
[5]   Chang, C., Lai, Y., 2003. A flexible 
date-attachment scheme on E-cash. 
Computers 684 and Security 22 (2), 
pp. 160–166. 
[6]   Chang, C., Chang, P., and Lin, I., 
2008. A Novel Group Signature 
Scheme Based on Bilinear Pairings 
and Gap Diffie–Hellman Group, 
Studies in Computational 
Intelligence (SCI) 89, pp.117–125. 
[7]   Chaum, D., 1983. Blind signatures 
for untraceable payments. In: 
Advances in Cryptology: 
Proceedings of Crypt’82. Plenum, 
NY, pp. 199–203. 
[8]   Chen T., 2004. An English Auction 
Scheme in the Online Transaction 
Environment, Computer & 
Security 23(5), pp. 389-399. 
[9]   Chen, X., Zhang, F. and Liu, S., 
2007. ID-based restrictive partially 
blind signatures and applications. 
Journal of Systems and Software 
 7
14-17. 
[21]   Joux, A., 2002. The weil and tate 
pairings as building blocks for 
public key cryptosystems. In: 
Proceedings of the 5th 
International Symposium on 
Algorithmic Number Theory, 
LNCS 2369, pp. 20–32. 
[22]   Juang, W., Lei, C., Liaw, H., 2003. 
Privacy and anonymity protection 
with blind threshold signatures. 
International Journal of Electronic 
Commerce 7 (2), pp.145–159. 
[23]   Juang, W., 2003. A practical 
anonymous payment scheme for 
electronic commerce. mputers and 
Mathematics with Applications 46 
(12),pp. 1787–1798. 
[24]   Juang, W., 2005. A practical 
anonymous off-line multi-authority 
payment scheme. ectronic 
Commerce Research and 
Applications 4 (3), pp. 240–249. 
[25]   Juang W., Liaw H., Lin P. and Lin 
C., 2005. The Design of a Secure 
and Fair Sealed-bid Auction 
Service, Mathematical and 
Computer Modelling 41(8-9), pp. 
973-985. 
[26]   Juang, W., 2007. D-Cash: a flexible 
pre-paid E-cash scheme for 
date-attachment. Electronic 
Commerce Research and 
Applications 6 (1), pp. 74–80. 
[27]   Jurisic, A., Menezes, AJ., 1997. 
Elliptic Curves and Cryptography, 
1–13. 
[28]   Koblitz, A., Koblitz, N., and 
Menezes, A., 2009. Elliptic curve 
cryptography: The serpentine 
course. Journal of Number Theory. 
[29]   Kammler, D., Zhang, D., Schwabe, 
P., Scharwaechter, H., Langenberg, 
M., Auras, D., Ascheid, G. Mathar, 
R., 2009. Designing an ASIP for 
cryptographic pairings over 
Barreto–Naehrig curves. In: 
Proceeding of Workshop on 
Cryptographic Hardware and 
Embedded Systems, CHES 2009. 
Lecture Notes in Computer Science, 
5747. Springer, New York, pp. 
254–271. 
[30]   Koblitz, N., Menezes, A., Vanstone, 
S., 2000. The state of elliptic curve 
cryptography. Designs, Codes and 
Cryptography 19, 173–193. 
[31]   Lauter, K., 2004. The advantages 
of elliptic curve cryptography for 
wireless security. IEEE Wireless 
Communications 11 (1), 62–67. 
[32]   Li, Z., Higgins, J., Clement, M., 
2001. Performance of finite field 
arithmetic in an elliptic curve 
cryptosystem. In: Ninth IEEE 
International Symposium on 
Modeling, Analysis, and 
Simulation of Computer and 
Telecommunications Systems 
(MASCOTS’01), pp. 249–256. 
 1
出席國際學術會議心得報告 
                                                             
計畫編號 NSC 99-2628-E-327-003 
計畫名稱 使用雙線性配對之電子商務安全付費服務之研究 
出國人員姓名 
服務機關及職稱 
莊文勝/高雄第一科技大學大學資管系/教授 
會議時間地點 Hangzhou, China, April 13-15, 2011  
會議名稱 2011 年資訊安全國際研討會暨第一屆海峽兩岸資訊安全研討會(CSCIS 2011) 
發表論文題目 A Secure and Efficient Delegation-based Authentication Scheme in Public Clouds 
 
 
一、 參加會議經過 
 
     2011 年資訊安全國際研討會(The 2011 International Conference on 
Information Security) 暨第一屆海峽兩岸資訊安全研討會為亞洲地區資訊安全
國際研討會。今年首屆於大陸杭州舉辦。主要參與之學者有大陸、台灣、韓
國、澳洲亞太等國學者。由於資訊安全的理論與技術越來越成熟，相關的安
全應用也逐漸受到重視。本人因計畫需要撥空參與此盛會，以探討目前熱門
相關的安全議題。此會議論文發表共三天，會議開始前一天晚上有簡單隆重
的會前接待交流。會議第一天共有四個場次的論文發表，會議第二天有兩個
場次的論文發表，會議第三天有四個場次的論文發表。這次參與 2011 年資訊
安全國際研討會暨第一屆海峽兩岸資訊安全研討會會議本人發表一篇論文，名稱
為 “A Secure and Efficient Delegation-based Authentication Scheme in 
Public Clouds＂，另外藉由觀摩此會議的進行與相關議題的探討，對資訊安
全的趨勢發展會有所幫助且對未來協助主辦相關國際會議也會有相當的幫
助。 
 
二、 與會心得 
 
 3
案。 
    一 篇 論 文 題 目 為 “Threshold Signature Scheme with Threshold 
Verification Based on Multivatiate Linear Poynomial＂。其作者為杭州師
範大學的 Zhonghua Shen 學者與浙江理工大學的 Xiuyuan Yu 學者。Zhonghua 
Shen 博士於發表中介紹其所設計的基於多變量之門檻式簽章方案。 
   一 篇 論 文 題 目 為 “Generic Framework for Electronic Anonymous 
Auctions＂。其作者為台灣大學的 He-Ming Ruan, Yu-Shian Chen 兩位學者與
Chin-Laung Lei教授。Chin-Laung Lei 教授於發表中介紹對環境的一些假設對拍賣
系統的實施有相對的一些不錯的性質與效能改進。 
  一篇論文題目為“User Authentication and Key Agreement Scheme with 
User Anonymity for Multiple Servers in Wireless Environment＂。其作者
為台灣科技大學的 Liang-Peng Chang學者，Tzong-Chen Wu，Kuo-Yu Tsai 教
授與長庚大學的 Chien-Lung Hsu 教授。Kuo-Yu Tsai教授於發表中介紹對一無
線網路環境下之多伺服器匿名的使用者認證與金鑰協商方案。 
   另有一篇論文題目為“Identity-Based Key-Insulated Proxy Signature 
Without Random Oracles＂。其作者為上海交通大學的 Jianhong Chen, Kefei 
Chen 學者與淮陰工學院的 Yu Long 學者與現代通訊國家實驗室的 Yongtao Wang 
學者。Kefei Chen 博士於發表中介紹其設計的身分為基礎的代理簽章方案。此方案
其有證明在非神喻模式下可證明安全的。 
參、 結語 
此次赴大陸杭州參加 2011 年資訊安全國際研討會暨第一屆海峽兩岸資訊安全研
討會，有機會與亞太學者一同深入討論密碼學與資訊安全應用研究未來的可能發
展方向。參加此次會議，可以強烈感受到資訊安全研究在亞太地區的蓬勃發展，
令人印象深刻。另外由於資訊安全應用的蓬勃發展, 其所帶來的機會與挑戰也於
會中學者所注意與熱烈討論。而資訊安全應用所面臨的隱私保護,認證等安全問
題也也是推行這些應用所必須面對與解決的迫切問題。 
非常感謝國科會能提供足夠的經費讓本人參加此盛會。對本人而言，目睹亞
太學者在密碼學與資訊安全應用研究工作上的表現，也讓我們能掌握資訊安全應
用的主流研究趨勢。 
 
CSCIS 2011 
 
 
 
 
A Secure and Efficient Delegation-based Authentication Scheme in Public Clouds 
 
Wen-Shenq Juang, Jen-Yu Chiu and Hung-Yi Chang 
Department of Information Management 
National Kaohsiung First University of Science and Technology 
Kaohsiung, Taiwan 
wsjuang@nkfust.edu.tw 
 
Abstract  In recent years, cloud computing becomes more popular in many applications.  Users can use 
the cloud services in any places and at any time via the network.  Since cloud services may be distributed 
in various public clouds, if a user wants to use these services, she/he needs to do the registration in these 
public clouds in advance and then can use these services.  This simple approach is not practical and not 
user-friendly since a user may need to remember many different passwords and manage many accounts for 
these potential used services in different public clouds.  For solving all these problems, we propose a 
secure and efficient delegation-based authentication scheme in public clouds.  In our proposed scheme, a 
user only needs to do registration in her/his home service cloud, and then she/he can use all the services in 
different clouds.  Our proposed scheme can provide mutual authentication and delegation payment 
between a user and a cloud service provider via the help of the home service cloud server of this user.  
Also, our proposed scheme can provide many extra nice properties, e.g., user privacy protection, 
non-overcharge, non-repudiation, and low computation and communication cost. 
 
Keywords:  cloud computing, proxy signature, network security, delegation payment, mutual authentication, 
privacy protection 
1   Introduction 
In cloud computing, service providers can 
provide services and applications through the 
Internet or the intranet [1, 13].  Also, various 
organizations can build their cloud services in their 
clouds for being used by their employees or 
customers.  The major merits of using cloud 
computing are reducing the cost to invest 
information technology facilities and the 
management cost by the centralized management.  
However, these clouds are distributed in different 
places.  Managing accounts will become more 
complex when a user wants to use various services 
in different public clouds.  That is very 
impractical and not user-friendly for users to use 
diffent accounts and passwords in different public 
clouds [1, 8, 13]. 
For reducing the communication and 
computation cost of the authentication scheme in 
personal communication systems, the concept of 
delegation-based authentication was proposed by 
Lee and Yeh in 2005 [14].  Then, Lee et al. and 
Wang et al. pointed out some security problems in 
Lee and Yeh’s scheme and proposed their improved 
schemes [10, 12]. These delegation-based 
authentication protocols [10, 12, 14] use the proxy 
signature technique to reduce the communication 
and computation cost of the offline authentication 
phase in personal communication systems.  The 
major problems in Lee et al.’s scheme are the lack 
of user privacy protection and may cause the 
overcharge situation.  Although the 
delegation-based concept can be used in the 
authentication in cloud computing, the 
communication and computation cost of these 
  
3 
 
she/he updates l = hn-i+1(n1), and the next time 
secssion key Ci+1 = h(l,Ci) and the count i = 
i+1. 
 
3   Primitives used in our proposed scheme 
In this section, we review the primitives of 
proxy signatures [3, 5, 6, 7, 11] and elliptic curve 
cryptosystems [2, 4, 9] used in our proposed scheme. 
3.1   Proxy signature 
In a proxy signature scheme, a user called the 
original signer can delegate her/his signing power 
to the other user called the proxy signer [3].  Then 
the proxy signer can sign the message on the behalf 
of the original signer.  A verifier can verify the 
signature by using the corresponding public key, 
which was generated by the original signer. 
The original signer signs the warrant that 
describes the relative rights and information of the 
original signer and the proxy signer, which called 
delegation by warrant.  The delegation consists of 
three types: full delegation, partial delegation, and 
delegation by warrant defined by Mambo et al. [7].  
In the following, we describe the scheme proposed in 
[3]. 
(1) Initialization phase: Assume that G is a point on 
the elliptic curve, and its order is q. (xo, yo) 
denotes the secret and public key pair of the 
original signer, (xp, yp) denotes the secret and 
private key pair of the proxy signer. 
(2) Proxy delegation: First the original signer O 
randomly selects ko∈R Zq*, and computes ro = 
koG and so = roxoh(mw, ro , IDP) + IDPko, and 
sends it to the proxy signer P. 
(3) Signing and verification: After the proxy signer 
P receives ro and so from the original signer, P 
computes the proxy signature signing key xpr = 
so + xPh(mw, ro, IDP ) (mod q), and its 
corresponding public key ypr = xpr G.  Then P 
can sign the message m with his signing key xpr. 
The signing process is as follows: 
(a) P randomly selects ∈α R Zq*, and computes β 
=αG and α−1mod q.  
(b) P computes σ = α-1(h(m) xprβ) mod q.  
(c) The pair (β,σ) is the proxy signature of the 
message m.  
(d) P sends (m, ro ,β,σ, mw, IDP) to the verifier 
V.  
(e) When V receives (m, ro ,β,σ, mw, IDP ) from 
P, V computes w = σ−1 mod q, u1 = h(m)w mod 
q, and u2 = βw mod q and computes X =u1G + 
u2 ypr..  If X = β holds, V accepts the proxy 
signature and believes P is the valid proxy 
signer. 
3.2   Elliptic curve cryptosystem 
An elliptic curve cryptosystem includes the key 
distribution, encryption, and digital signature 
algorithms which are based on addition of the points 
on a chosen elliptic curve.  An elliptic curve E over 
a Galois field GP(p), where p > 3 and is prime is the 
set of (x,y) that satisfies the equation:  
E : y2 = x3 + ax + b, where ∈a, b  GF(p), and 
4a3 + 27b2 ≠ 0.  
The points on the elliptic curve E are the points 
over GF(p) that satisfy the defined equation.  If the 
set of parameter {a, b, p} are specified, the number of 
relational points on the elliptic curve is determined 
uniquely. 
Define a scalar multiplication k of a point G as 
the operation by the point G added to itself k times, 
which is denoted as kG.  To compute W = kG from a 
given k and G is easy, but it is difficult to compute 
the scalar k from the points W and G. 
4   Our proposed scheme 
In this section, we will descibe our proposed 
USER(Ci) VLR(Ci, l=h
n-i+2(n1)) 
[hn-i+1(n1)]Ci 
Count i = i+1 
Check i<n
Check hn-i+1(n1) = l 
Update l = hn-i+1(n1) and 
Ci+1 = h(l,Ci) 
Fig 1. Off-line authentication of Wang et. al.’s protocol 
  
5 
 
 
The process of the offline authentication phase 
of our proposed scheme is shown in Figure 2. 
5   Security analysis 
We analyze that our proposed scheme is secure 
against all well-known security threats. 
5.1   Mutual authentication 
 In our protocol, mutual authentication 
between the user and VSC is achieved by the help 
of HSC in the on-line authentication process as 
follows. 
a) Upon VLR receiving the message 
(N1,Q,rH ,R, sU, yU, yur ,IDH) in Step (1b), VSC will 
verify the signature is valid or not in Step (2b).  If 
yes, VSC believes the message is sent by the user 
and believes the user is eligible. 
b) Upon the user receiving the message 
(h(N1||Q||yUnew||n2|),n2) in Step (4b), the user will 
verify the hash value is correct or not in Step (5a).  
If yes, the user believes n2 is generated by VSC and 
believes VSC is eligible. 
5.2   User privacy protection 
The public key yU will replaced by yUnew in 
each on-line authentication.  Without the 
knowledge of the private key xU, no one can 
derive the user’s real identify and no one can 
derive the relationship between yU and yUnew. 
5.3   Non-repudiation 
In our scheme, a user cannot deny the signature 
signed by herself/himself since the digital signature 
is signing by the signature key xUr, which is 
generated by xU.  HSC cannot deny the signed 
signature since the signature key is generated by sH, 
and sH is shared by the user and HSC. 
5.4   Preventing the overcharge problem 
According to Wang et. al.’s protocol, if the 
overcharge problem was happened, it will have the 
ability to derive the next identify yUnew.  This 
computation is infeasible since yUnew is generated 
by the secret key xU.  It is shared secretly by the 
user and HSC.  No one, except for the user and 
HSC, can get this secret value. 
6   Efficiency comparison 
  We make a performance comparision among 
our proposed scheme and the related schemes.  We 
also make a capability comparison with the related 
schemes. 
6.1   Communication cost 
We assume that the length of an identify is 32 
bits. If a random number is secret, the length of that 
is 160 bits; otherwise, the length is 64 bits.  The 
output length of a one way hash function is 160 
bits, such as SHA-1, and the output block size of 
the symmetric cryptosystem is 128 bits. 
The communication cost in the on-line 
authentication phase is described in the following.  
Since the user sends the message (N1,Q,rH ,R, sU, 
yU, yur ,IDH ) to VSC in Step (1b), the 
communication cost is of 740 bits. In Step (2c), 
VSC sends the message ([N1||Q||yU||n2]KVH) which 
is of 128bits, and HLR sends the message 
[h(N1||Q||yUnew||n2),C1,l]KVH  which is of 128bits in 
Step (3b).  In Step (4b), VSC sends the message 
(h(N1||Q||yUnew||n2|),n2) to the user which is of 224 
bits.  The total communication cost is of 1236 bits.  
We compare the related protocols [10, 12] with our 
proposed scheme in the online authentication phase 
and summarize the result in Table I. 
 
Table I. The comparison of the communication cost in the 
online authentication phase 
 
 On-line authentication 
Communication Cost 
Our scheme 980 bits 
Lee et. al.’s 
 protocol [12] 
2400 bits 
Wang et. al.’s  
protocol [10] 
1696 bits 
6.2    Computation cost 
We denote that TADD is the time of one 
addition operation, TINV is the time of one inverse 
operation, TCMUL is the time of one multiplication 
  
7 
 
curve cryptosystems. 1997, LNCS 1294: 342-356. 
[5] K. Shum and V. K. Wei. A strong proxy signature scheme 
with proxy signer privacy protection. Enabling 
Technologies: Infrastructure for Collaborative Enterprises, 
2002, 55-56. 
[6] K. Zhang. Threshold proxy signature schemes. 1998, 
LNCS 1396: 282-290. 
[7] M. Mambo, K. Usuda, E. Okamoto. Proxy signature: 
delegation of the power to sign messages. IEICE Trans. on 
Fundamentals, Tokyo, 1996, 1338−1353. 
[8] M. Rahnema. Overview of the GSM system and protocol 
architecture. IEEE Communications Magazine, 1993, 
31(4): 92–100. 
[9] N. Koblitz. Elliptic curve cryptosystem. Mathematics of 
computation,1987, 203-209. 
[10] R. C. Wang, W. S. Juang, and C. L. Lei. A privacy and 
delegation enhanced user authentication protocol for 
portable communication systems. International Journal of 
Ad Hoc and Ubiquitous Computing, Inderscience press, 
Switzerland, 2010, 6(3): 183-190. 
[11] S. Kim, S. Park, and D. Won. Proxy signatures revisited. 
1997, LNCS 1334: 223-232. 
[12] T. F. Lee, S. H. Chang, T. Hwang, and S. K. Chong, 
Enhanced delegation-based authentication protocol for 
PCSs. IEEE Transactions on Wireless communications, 
2009, 8(5): 2166–2171. 
[13] W. A. Warr. Cloud Computing. Wendy Warr & Associates, 
2009. 
[14] W. B. Lee and C.K. Yeh. A new delegation-based 
authentication protocol for use in portable communication 
systems. IEEE Transactions on Wireless Communications, 
2005, 4(1): 57–64. 
 2
 
壹、 前言 
2011年資訊安全國際研討會暨第一屆海峽兩岸資訊安全研討會為亞洲地區資訊安
全國際研討會，今年於大陸杭州舉辦，主要參與之學者有大陸、台灣、韓國、澳
洲亞太等國學者。會議討論議題涵蓋資訊安全的理論及實務應用。2011 年資訊安
全國際研討會暨第一屆海峽兩岸資訊安全研討會今年於大陸杭州舉辦。今年此次會議
有十個場次共 34 篇論文發表。會議主題涵蓋密碼元件, 可證明安全技術, 布林
函數特性, 雲端計算安全, 網路安全應用等。 
 
貳、 論文發表 
本次會議有三天論文發表議程 34 篇論文發表。整體觀之，2011 年資訊安全國
際研討會暨第一屆海峽兩岸資訊安全研討會會議是以密碼學與資訊安全應用議題為
主軸，內容相當多元。 
所接受論文發表包括密碼元件, 可證明安全技術, 布林函數特性, 雲端計算
安全, 網路安全應用等議題。本人於會中發表一篇雲端代理認證主題的論文，名
稱為 “A Secure and Efficient Delegation-based Authentication Scheme in Public 
Clouds＂，以下簡述本人發表論文摘要內容。 
近年來，雲端運算於許多應用中越來越受歡迎，使用者可藉由網路於任何地
方與時間使用雲端服務。而雲端服務可能分散於不同的公開雲內，使用者若要去
使用這些散佈於不同的公開雲內的雲端服務，其將需要事先於這些不同的雲內註
冊，此將造成使用者需要記憶與管理大量的密碼或安全權杖，造成實務上的不方
便。為解決上述問題，我們於雲端運算環境下，提出一安全且有效能的代理認證
服務。在我們我提出的方法上，任何使用者只需於其註冊的家服務雲內註冊一次
便可藉由此雲來存取拜訪的雲服務。我們所提出的方案，提供相互認證、代理付
款、使用者隱私保護、不可否認並且有較低的計算與通訊成本。 
另外本次會議中論文發表皆相當精采。茲選錄如下： 
發表中有一篇論文題目為“Certificateless Message Recovery Signatures 
Providing Girault＇s  Level-3 Security＂。其作者為政治大學的 RayLin Tso 
博士,韓國 Sejong 大學的 Cheonshik Kim 學者與澳洲 Victoria 大學的 Xun Yi 學
者。藉由將系統公開資訊內嵌入系統中作者提出另一個無憑證的數位簽章解決方
 4
肆、 攜回資料 
本次參加會議所攜回之資料有下列三項： 
1. 會議論文集。 
2. 會議參與人員名錄。 
3. 大會議程手冊。 
 
  
2     
 
related schemes is still high [10, 12, 14].  For 
solving all these problems, we propose a secure and 
efficient delegation-based authentication scheme in 
cloud computing. 
In Section 2, we first introduce the related work 
proposed by Wang el. al.  In Section 3, we 
introduce the primitives used in our proposed 
scheme.  In Section 4, our proposed scheme is 
described.  In Section 5, we analyze the security 
of our proposed scheme.  In Section 6, we 
compare the efficiency among our scheme and the 
related schemes and make a comparison among our 
proposed scheme and the related schemes.  
Finally, a concluding remark is given in Section 7. 
2    The related work 
In this section, we will review the related work 
proposed by Wang et. al [10].  Their proposed 
scheme consists of four phases: setup, pre-compute, 
on-line authentication, and off-line authentication 
phases. 
2.1   The setup phase 
Home Location Register, HLR, generates a 
privacy/public key pair (x, v), where x is random 
number and v = gx.  For each registered user, HLR 
selects a random number k and computes K = gk mod 
p and σ = (-k-1xK) mod q, where σ is the secret key 
shared between HLR and the user and K is the 
pseudonym of the user. 
2.2   The pre-compute phase 
The user generates a random number n1 and 
computes a hashing chain h1(n1), h2(n1), …, hn+1(n1) 
= N1, Knew ≡pKh(N1∥σ), r ≡pgt, and 
if (Stemp = NULL) 
Snext ≡q (σ × K-1 × h(N1∥σ)-1 × Knew)  
else Snext ≡q(Stemp × K-1 × h(N1∥σ)-1 × Knew). 
2.3   The on-line authentication phase 
(1) MS (mobile subscriber) sends K to VLR. 
(2) VLR generates a random number n2 and sends 
it with IDV to MS. 
(3) (a) MS generates a signature s for the message 
h(N1, k, n2, k, IDV) and if STemp = NULL, then s 
= (σ + h(N1, k, n2, k, IDV) + t * r) mod q; 
otherwise, s = (STemp + h(N1, k, n2, k, IDV ) + t 
* r) mod q.  
(b) MS sends s with (n2, r, N1, IDH,IDV ) to 
VLR. 
(4) (a) VLR verifies whether the equation 
gh(N1,n2,IDV)rr = (vKKsrr) mod p holds or not. If 
the verification is successful, VLR believes that 
MS is a valid user.  
(b) VLR encrypts the message (N1, n2, K) by 
using the key KVH and sends the encrypted 
result with IDH and IDV to HLR. 
(5) (a) HLR decrypts the message [N1, n2, K]KVH by 
using the key KVH.  HLR computes the session 
key C1 = h(N1, n2, Knew) and replaces K with 
Knew, where Knew = Kh(N1, σ) mod p.  
(b) HLR sends the encrypted message 
[h(N1,Knew, n2, IDV, σ), n2, l, C1]KV H, IDH and 
IDV to VLR, where l = N1. 
(6) (a) VLR decrypts the message [h(N1, Knew, n2, 
IDV, σ),n2, l, C1]KVH.  If n2 and l are same as 
before, VLR sets up the first time session key 
SK = C1.  
(b) VLR stores (C1, l) for the off-line 
authentication.  
(c) VLR sends h(N1, Knew, n2, IDV, σ) and IDV to 
MS. 
(d) MS verifies whether the received hash value 
is the same as h(N1, Knew, n2, IDV).  If yes, MS 
believes that VLR is authenticated by HLR.  
(e) MS computes C1 = h(N1, n2, Knew, σ) and 
sets up it as the current session key SK and 
replaces (K, STemp) with(Knew, SNext). 
2.4   The off-line authentication phase 
(1) The user uses the session key Ci to encrypt the 
message hn-i+1(n1), and sends it to VLR. 
(2) When VLR receives the message from the user, 
VLR uses the key Ci to decrypt the message.  
VLR then checks if hn-i+1(n1) = l holds.  If yes, 
  
4     
 
scheme.  Our proposed scheme consists of four 
phases: the setup phase, the pre-computing phase, the 
on-line authentication phase, and the off-line 
authentication phase. 
4.1   The setup phase 
Home Service Cloud, HSC generates kH ∈R 
Zq* and compute ru = kHG and sH = rHxHh(rH , yU) + 
yUkH (mod q) for each registered user.  Then HSC 
sends rH and sH to the user via a security channel.  
When the user received rH and sH, and then she/he 
computes the privacy/public signature key pair xUr 
= sH + xUh(rH,yU ) and yUr = xUrG. 
4.2   The pre-computing phase 
The user generates a random number n1 and 
computes a hashing chain h1(n1),h2(n1), …,hn+1(n1) , 
and hn+1(n1)= N1. 
4.3   The on-line authentication phase 
(1) (a) The user selects α ∈R Zq*  and computes 
R =αG, α−1 mod q and generates the signature 
sU =α-1 (h(N1||Q) + xUrR) mod q. 
(b) The user sends N1, Q, rH, R, sU, yU, yur, IDH 
to the Visited Service Cloud, VSC. 
(2) (a) VSC computes w = sU−1 mod q, u1 = 
h(N1||Q)w mod q, u2 =Rw mod q and X = u1G 
+ u2yUr for verifying the user. 
(b) VSC verifies whether the equation X=R 
holds or not.  If the verification is successful, 
VSC believes the user is valid. 
(c) VSC encrypts the message (N1, Q, yU, n2) 
by using the key KVH, and sends 
[N1||Q||yU||n2]KVH to HSC. 
(3)  (a) HLR decrypts the message 
([N1||Q||yU||n2]KVH) by using the key KVH  
according to yU.  HSC searches the key xU in 
its database, and then computes the first 
session key C1 = h(N1||Q|n2||xU), l = N1, yUnew 
= h(N1,xU)yU and replaces yU with yUnew. 
(b) HSC sends the encrypted message 
[h(N1||Q||yUnew||n2),C1,l]KVH to VSC. 
(4) (a) VSC decrypts the message 
([h(N1||Q||yUnew||n2),C1,l]KVH) to obtain 
h(N1||Q||yUnew||n2), C1, l.  If  l = N1, then 
VSC sets up the first session key =C1, and 
stores C1, N1, Q for the off-line authentication. 
  (b) VSC forwards the message 
(h(N1||Q||yUnew||n2|), n2) to the user. 
(5) (a) The user computes yUnew = h(N1,xU)yU and 
verifies whether the received hash value is the 
same as h(N1||Q||yUnew||n2|).  If yes, then the 
user believes that VSC is authenticated by HSC. 
 (b) The user computes C1 = h(N1||Q||n2||xU) and 
sets up it as the first session key and replaces yU 
with yUnew. 
4.4   The off-line authentication phase 
In our proposed scheme, we provide a function 
for checking the current available quota for this user.  
In the off-line authentication phase, VSC can check if 
the total used fee is less then the quota or not.  After 
the service is completed, she/he can update the 
available quota of the user.  
(1) The user uses the session key Ci to encrypt the 
message hn-i+1(n1), and sends it to VSC. 
(2) When VSC receives the message from the user, 
VSC uses the key Ci to decrypt the message.  
VSC then checks if hn-i+1(n1) = l, and checks 
total fee < Q holds. If yes, she/he updates l = 
hn-i+1(n1), and the next time secssion key Ci+1 = 
h(l,Ci) and the count i = i+1. Finally when 
services completed VSC update the total fee. 
 
USER(Ci) VSC(Ci, l=h
n-i+2(n1)) 
[hn-i+1(n1)]Ci 
Count i = i+1  
Check i < n 
When services completed 
update total fee
Check hn-i+1(n1) = l and 
total fee < Q 
Update l = hn-i+1(n1) and 
Ci+1 = h(l,Ci) 
Fig 2. Off-line authentication of our proposed scheme 
  
6     
 
operation on the elliptic curve cryptosystem, TH is 
the time of one-way hash function operations such 
as SHA-1, and TSYM is the time of one symmetric 
encrypted/decrypted operation. 
In the setup phase, HSC computes ru = kHG 
and sH = rHxHh(rH , yU) + yUkH (mod q).  The 
computation cost of ru is of 1TCMUL, and sH is of 
1TADD + 4TCMUL + 1TH.  The user computes xUr = 
sH + xUh(rH,yU ) and yUr = xUrG.  The computation 
cost of xUr is of 1TADD + 1TCMUL + 1TH, and yUr is 
of 1TCMUL.  The total cost of the setup phase is of 
2TADD + 6TCMUL + 2TH. 
In Step (1a) of the on-line authentication 
phase, the user computes R =αG, α−1 mod q and sU 
= α-1 (h(N1||Q) + xUrR) mod q.  The cost is of 
1TADD + 1TINV + 2TCMUL + 1TH.  In Step (2a), 
VSC computes w = sU−1 mod q, u1 = h(N1||Q)w 
mod q, u2 =Rw mod q and X = u1G + u2yUr.  The 
cost is of 1TADD + 1TINV + 4TCMUL + 1TH.  In Step 
(3a), HSC computes C1 = h(N1||Q|n2||xU) and yUnew 
= h(N1,xU)yU. The cost is of 1TCMUL + 2TH.  In 
Step (5a), the user verifies whether the hash value 
is the same or not as h(N1||Q||yUnew||n2).  The cost 
is of 1TH.  In Step (5b), the user computes the 
session key C1 = h(N1||Q||n2||xU).  The cost is of 
1TH.  The total computation cost of the on-line 
authentication phase is of 2TADD + 2TINV + 7TCMUL 
+ 6TH.   
 
Table II.  The comparison of computation cost 
 Computation Cost  
 Pre-computing On-line Off-line
Our scheme 2TADD + 6TCMUL 
+ 2TH 
≃  174.4TMUL + 
2TADD 
2TADD + 2TINV 
+ 7TCMUL + 
6TH 
≃  204.2TMUL 
+ 2TADD + 
2TINV 
nTSYM 
≃  
nTMUL 
Lee et. al.’s 
protocol [12] 
1TEXP + 1TMUL + 
11TH  
≃  245.4 TMUL 
4TEXP + 4TMUL 
+ 1TADD + 4TH 
+ 3TSYM 
≃  977.6TMUL 
+ 1TADD 
nTSYM 
≃  
nTMUL 
Wang et. al.’s 
protocol [10] 
2TEXP + 2TINV + 
3TMUL + 12TH  
≃  487.8TMUL + 
2TINV 
4TEXP + 3TMUL 
+ 2TADD + 5TH 
+ 2TSYM 
≃  973TMUL + 
2TADD  
nTSYM 
≃  
nTMUL 
 
We show the computation comparison result 
in Table II.  We also show the capability 
comparision among our proposed scheme and the 
related schemes in Table III. 
7   Conclusions 
In this paper, we have proposed a secure and 
efficient delegation-based authentication protocol 
in cloud computing.  Our proposed scheme can 
provide user privacy protection, mutual 
authentication, non-repudiation and non-overcharge 
properties.  Also, compared with the related 
schemes, the communication and computation cost 
of our proposed scheme is reduced. 
 
Table III.  Capabilities comparison among our proposed 
scheme and the related schemes. 
 Our 
scheme
Lee et. al.’s 
protocol [12] 
Wang et. al.’s 
protocol [10]
Mutual 
authentication 
Yes Yes Yes 
User privacy 
protection 
Yes NO Yes 
No overcharge 
problem 
Yes NO Yes 
Non-repudiation Yes Yes Yes 
Being used in 
cloud computing 
Yes NO NO 
Supporting quota 
function 
Yes NO NO 
Communication 
cost 
Very 
Low 
High Middle 
Computation cost Very 
Low 
Middle Middle 
 
Acknowledgements 
This work is supported in part by National Science 
Council under the Grant NSC 99-2628-E-327-003. 
 
References 
[1] A.Weiss. Computing in the Clouds. Networker, 2007, 11(4):  
16-25. 
[2] A. J. Menezes and S. A. Vanstone. Elliptic curve 
cryptosystems and their implementation. Journal of 
Cryptology, 2002, 6(4): 209-224. 
[3] B. Hu and C. Jin. A secure proxy signature scheme based 
on elliptic curve cryptosystem. Journal of Electronics, 
2006, 23(1): 54-57. 
[4] J. Guajardo and C. Paar. Efficient algorithms for elliptic 
國科會補助計畫衍生研發成果推廣資料表
日期:2012/01/21
國科會補助計畫
計畫名稱: 使用雙線性配對之電子商務安全付費服務之研究
計畫主持人: 莊文勝
計畫編號: 99-2628-E-327-003- 學門領域: 資訊安全
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
無 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
