 1
一、中文摘要 
本研究針對有線及無線 Ad hoc 網路環境，透過橢圓曲線密碼學與 Lagrange 內插多項
式，提出安全且有效率的金鑰建立方法。除了能有效降低整體會議金鑰建立的運算成本外，
也改善過去研究中，於會議金鑰建立時必須存在著會議主席的角色，進而導致成員間資料
運算量的不公平，以及部分成員會比其他成員更早得知會議金鑰的問題。並透過智慧卡的
使用，有效解決 Ad hoc 網路環境中對於行動設備儲存及資料運算量的限制。 
關鍵字：會議金鑰、橢圓曲線密碼學、Lagrange 內插多項式、Ad hoc 網路。 
 
 
二、英文摘要 
This research provides a secure and efficient conference key distributed method integrating 
with Elliptic Curve Cryptography and Lagrange Interpolation for wired and ad hoc networks. 
This method not only can reduce the integral cost of key distributing operation, but can improve 
past researches which needs chairperson on their scheme of key distribution that might conduct 
unfair situation on data or key compute. Furthermore, our method also improves the limitation of 
mobile equipment in storage and data compute efficiently by Smart Card.  
Keywords: Conference Key, Elliptic Curve Cryptography, Lagrange Interpolation, Ad hoc 
Network. 
 
 
三、內容： 
1、緒論 
網路的快速發展，革新了人們的生活方式。隨著網路頻寬越來越大，以及無線網路的興起，許多原本只
有在現實生活才會見到的行為，也慢慢的實現在網路的世界裡。像是電子郵件、線上聊天室、線上視訊會議、
電子投票、公文電子化、線上購物、拍賣等。 
正因為網路發展的便捷與快速，相關的網路犯罪案件也日益增加。資訊安全，特別是「網路安全」也倍
受重視。而透過密碼學的應用及加解密的機制，可加強網際網路中，資訊傳遞的私密性、完整性及不可否認
性。許多國內外的學者，針對不同的線上環境對安全性的需求做研究，提出各種安全且有效的機制。 
在會議金鑰（Conference Key）方面，透過會議金鑰的建立，可讓相互溝通的群體，使用大家共同產生
的金鑰加密傳輸的訊息，確保傳遞的訊息不會遭到駭客或非法使用者篡改。也因為訊息被加密，即便是資料
遭竊聽，若不是合法成員，也無法將訊息還原，而只是一串無意義的資訊。 
過去的許多研究中，學者透過不同的方法來建立會議金鑰，如[2]採用環狀方式產生會議金鑰、
[9][10][11][13]採用樹狀（Tree）方式及[3][5]採用廣播（Broadcast）方式等。但由於過去的研究中，在成員產
生會議金鑰的流程裡存在一些問題，因而可能會遭遇到駭客攻擊，導致最後金鑰無法成功建立，或是非法使
用者透過不正當的手段取得合法成員所產生的金鑰，進而使得會議金鑰失去其應有的安全性。 
本研究主要結合橢圓曲線密碼學與 Lagrange 內插多項式，提出較安全且有彈性的金鑰建立方法。並針對
有線及無線兩種不同的網路環境中，存在著頻寬及運算能力差異上的問題，透過智慧卡（Smart Card）的使
用來輔助其不足的部分。最後整理相關的攻擊法，並驗證本研究所提之架構是否能有效防止相關攻擊，進而
提供一個更安全且彈性的會議金鑰建立機制。 
 
2、文獻探討 
2.1 Ad hoc 網路架構 
一般的有線網路，不論是撥號連線，或是寬頻網路，在資料傳輸至網際網路的時候，都會透過一個固定
的網路設備[2]，類似中央控管的方式幫我們把訊息傳遞出去。此設備可能是集線器，或是路由器等，透過這
樣的網路基礎架構（Infrastructure），有利於網管人員維護網路流量，甚至由於網路上所傳遞的資料，不論是
外部資料傳輸到內部區域網路，或是內部資料要傳輸到外部網路，都必須經由此固定的網路設備傳遞。因此
 3
1 2
12 mod
r rY pα=                              (6) 
 
然後將 Y1、Y2與 Y12一起傳給成員 U3。就這樣和前面的成員一樣一直進行到成員 U4運算出 1 2 4r r rα 、 1 3 4r r rα 、
2 3 4r r rα 、 1 2 3 4r r r rα ，最後把 1 2 4r r rα 、 1 3 4r r rα 、 2 3 4r r rα 利用廣播的方式傳給其他成員。因此每位成員都可計算出最
後的共同金鑰： 
 
1 2 3 4 modr r r rK pα=                              (7) 
 
2.4 橢圓曲線密碼學 
在現行的公鑰基礎建設環境下，大部份的應用皆是採用對稱及非對稱式密碼系統。其系統的安全性是建
構在解離散對數問題（Discrete Logarithm Problem, DLP）的難度下，在有限的時間及合理的運算資源下是無
法破解此系統。但由於該系統是採用指數模數運算，於資料的加解密皆必須花費相當多的運算成本。對於部
份儲存及運算能力有限的硬體設備而言是無法負荷的。因此學者們開始結合橢圓曲線密碼學（Elliptic Curve 
Cryptography, ECC）[1][7]的概念，來改善過去指數模數運算中花費高運算成本的問題。橢圓曲線密碼學的好
處，即是可以使用較短的金鑰長度來達到與指數模數運算（如 RSA）同樣安全的密碼系統。例如採用 160 位
元金鑰長度的橢圓曲線密碼系統，即可達到與使用 1024 位元金鑰長度的 RSA 相等的安全等級。 
在一個有限場 Fq 之橢圓曲線方程式 E，而所有落在此橢圓曲線方程式 E 上的點(x, y)，皆滿足
2 3 mody x ax b p= + + ，且可記為 E(a, b)。其中 p 為一大質數；x、y、a 和 b 都為有限場 Fq之元素，而且 a
和 b 也同時必須滿足 3 2(4 7 ) mod 0a b p+ ≠ 。此外，橢圓曲線方程式 E 包含 E(a, b)與一個無限遠點 O（Point at 
infinity）。 
橢圓曲線加法運算的意義，為橢圓曲線上的相異兩點 P 和 Q 相連接，會與橢圓曲線相交於一點-R，此-R
為 R 的加法反元素。因此 P 點與 Q 點相加等於 R，可記作 3 3( , )P Q R x y+ = = 。例如假設橢圓曲線 E 上的相
異兩點 1 1( , )P x y= 與 2 2( , )Q x y= ，其中 P Q≠ ± 。則 P Q+ 的結果也為橢圓曲線上的一點 3 3( , )R x y= 。此 R
點的 x 與 y 座標分別為： 
 
2
3 2 1 2 1 1 2( / ) modx y y x x x x p= − − − −                    (8) 
3 2 1 2 1 1 3 1( / )( ) mody y y x x x x y p= − − − −                   (9) 
 
橢圓曲線乘法運算的意義，為橢圓曲線上的一點 P，其切線會與橢圓曲線相交於另一點-R。因此兩倍的
P 點等於 R，可記作 3 32 ( , )P R x y= = 。例如假設橢圓曲線上有一點 1 1( , )P x y= ，且 P 點不在 X 座標軸上。則
2P P P R= + = ，且 3 3( , )R x y= 也為橢圓曲線上的一點。此 R 點的 x 與 y 座標分別為： 
 
2 2
3 1 1 1(3 / 2 ) 2 modx x a y x p= + −                      (10) 
2
3 1 1 1 3 1(3 / 2 )( ) mody x a y x x y p= + − −                   (11) 
 
3、本計畫所提之動態會議金鑰分配機制 
本計畫所提之動態會議金鑰分配機制，主要針對無特定網路拓樸（Topology）架構下，使用者在分享秘
密資訊的過程中，採用簽密法[7]的方式並透過廣播來分享，達成重建 Lagrange 內插多項式並計算出成員間共
同的會議金鑰。由於使用橢圓曲線密碼學並使用智慧卡，將部分資訊儲存於其中，有助於分擔資料運算及儲
存的成本。因此可解決 Ad hoc 網路環境中，相關硬體設備可能有資料儲存及運算限制的問題。所以此模式適
用於有線網路及 Ad hoc 網路環境。 
我們將整個會議金鑰建立模式分成五個部分來討論，包括系統初始化階段、金鑰建立階段、成員加入階
段、成員離開階段及會議金鑰使用階段。另外在會議金鑰更新部分，當會議開始前（包含新的會議開始前）、
成員異動及系統門檻值無法接受的範圍下，皆必須更新原會議金鑰。其詳細運作過程介紹如下： 
 
【系統初始化階段】 
在會議開始前，系統必須先定義一個橢圓曲線方程式。選擇一個大質數 q，並設定一個有限場 Fq之橢圓
曲線方程式 E，滿足 2 3 mody x ax b p= + + 。其中 p 也是一個大質數；x、y、a 和 b 都為有限場 Fq之元素，而
且 a 和 b 也同時必須滿足 3 2(4 7 ) mod 0a b p+ ≠ 。此外，橢圓曲線方程式 E 包含 E(a, b)與一個無限遠點 O。最
後在此橢圓曲線上挑選一個秩（Order）為 p 的基準點 G。然後將 p、q、E 和 G 公佈給所有會議成員知道。 
 5
'i iPK S G H P= × + ×                            (20) 
 
步驟四：若 'i iPK PK= 則代表簽密文確實由成員 Ui 所發送，反之則拒絕接送此簽密文，並要求成員 Ui 重新
發送新的簽密文。 
步驟五：利用每位成員所選取之亂數值 ix 及其公開金鑰 jPK ，透過 Lagrange 內插多項式，在門檻值 t = n 的
情況下，重建此內插多項式 ( )L x 。再將此多項式代入 (0)L 求得所有成員的共同會議金鑰π 。其中 Lagrange
內插多項式為： 
 
1 1;
( ) ( / )
tt
i j i ji j j i
L x y x x x x= = ≠= − −∑ ∏                       (21) 
 
【成員加入階段】 
假設成員 Un+1 要加入會議，則成員 Un+1 必須先告知所有會議成員，取得大家的允許後才可加入。接著
由候補者 Un，負責傳送相關的資訊（包括 ( )L x 、t 與共同會議金鑰π ）給成員 Un+1，相關的步驟如下。 
步驟一：候補者 Un選取一隨機亂數值 'nr ，其中
*'n pr Z∈ 。 
步驟二：計算橢圓曲線上的一點 
 
1 2
' ' ( ', ')n n n nP r G z z= × =                             (22) 
 
步驟三：利用成員 Un+1的公開金鑰 1nPK + 計算橢圓曲線上的點 
 
1 1 1 1' ( , )nn n n nn nnK r PK k l+ + + += × =                         (23) 
 
步驟四：將欲傳送的資訊 { ( ) || || }m L x t π= 利用步驟三中所求得之 1nnk + 加密，產生密文 
 
11
( )
nnnn k
Q E m
++ =                                (24) 
 
步驟五：計算驗證資訊 
 
1
' ( || ')nH h m z=                               (25) 
' ' ' modn nS SK H r p= − ⋅                           (26) 
 
步驟六：將簽密文（ 1', , 'n nnP Q S+ ）利用廣播的方式傳送給其他成員 Un+1。 
成員 Un+1收到後，將訊息還原取得共同會議金鑰π 與會議相關資訊。由於新加入的成員和其他原始成員
一樣，必須分享秘密資訊。為了不因為成員加入而導致原始成員必須做大幅度的更新運算，因此當成員 Un+1
收到後候補者 Un 的發送的資訊後，其所分享的資訊必須落於原內插多項式之曲線上。同時更改成員 Un+1 角
色為「候補者」。相關的步驟如下。 
步驟一：利用自己的秘密金鑰 1nSK + 計算橢圓曲線上的點 
 
1 1 1 1' ( , )nn n n nn nnK SK P k l+ + + += × =                        (27) 
 
步驟二：利用 1nnk + 對密文 1nnQ + 解密，得到成員 Un所傳送的訊息m  
 
1 1
( )
nnk nn
m D Q
+ +=                               (28) 
 
 7
1
' ( || ')nH h m z=                              (38) 
' ' ' 'n nPK S G H P= × + ×                           (39) 
 
步驟四：若 'n nPK PK= 則代表簽密文確實由成員 Un所發送，反之則拒絕接送此簽密文，並要求成員 Un重新
發送新的簽密文。 
步驟五：將會議門檻值 t 改為 t + 1，再將原內插多項式 ( )L x 加入候補者所選取之新亂數值 'nx 與 'ny ，更新此
內插多項式為 ( ) 'L x ，最後代入 (0) 'L 求得新的共同會議金鑰 'π 。 
 
【會議金鑰使用階段】 
成員成功建立共同會議金鑰π 後，接著所有成員必須共同決定一個 OTP 值。此 OTP 性質類似 One-Time 
Password 概念，主要確保本次所建立之共同會議金鑰只有在此時的會議中才有效。當新的會議開始，以及成
員異動（包括成員的加入與離開）的時候，皆必須重新更新此 OTP 值。 
因此現在假設成員 Ui要傳送訊息 m 給成員 Uj，則可透過 ( )m OTP π⊕ 方式傳送給 Uj。 
 
4、安全性分析 
本計畫所提之動態會議金鑰分配機制，有效達成金鑰獨立性 [2][6][11][13]，並避免了重送攻擊
[2][3][4][5][6]、猜測攻擊[3][4]、推導私密資訊攻擊[3][4][5]、中間人攻擊[5]、Modification Attacks[6]及聯合攻
擊[13]等安全性的需求。在金鑰獨立性分面，因為在會議開始前及成員異動後，皆會更新原會議金鑰。雖然
在成員加入時，原會議金鑰並不會做更新，但由於在會議金鑰建立完成後，成員實際使用會議金鑰來加密傳
輸訊息時，會搭配新的 One-Time Password 值一起使用，因此仍可達成 Forward 及 Backward Secrecy 之安全性。 
重送攻擊方面，因為當新的會議開始後，成員所選取之資訊皆必須更新，且每次傳送之資訊成員皆會選
取一隨機亂數值，並利用橢圓曲線將傳輸之資訊轉換成簽密文的形式後才傳輸。因此在橢圓曲線解離散對數
困難度的情況下，攻擊者並無法假冒任何資訊、也無法搜集成員過去所傳送的資訊來偽冒下一次的金鑰建立。 
猜測攻擊方面，由於在我們的兩種模式中並不存在共享的通行碼，且成員在金鑰建立或是成員異動時所
選取之分享資訊皆是隨機亂數值，因此攻擊者無法在合理的時間範圍及有限的資源下猜測出成員的任何資訊。 
推導私密資訊攻擊方面，攻擊者無法從成員所傳遞的資訊中推導出任何成員的私密資訊。由於在會議金
鑰建立的過程中，重要的私密資訊皆利用橢圓曲線將資訊轉換成簽密文後才傳送給接收者，只有接收者可將
訊息解密並還原訊息，因此攻擊者並無法得知任何成員的私密資訊。若攻擊者真的竊取到共同的會議金鑰，
也無法從此金鑰中推得任一成員的私密資訊。因為會議金鑰是利用所有成員所提供之亂數值與公開金鑰，透
過 Lagrange 內插多項式運算後產生，即便是會議金鑰被攻擊者得知，也僅能還原 ( )L x 之常數項部分，無法
從中推得任何成員的私密資訊。 
中間人攻擊與 Modification Attacks 方面，因為成員所傳遞的資訊皆利用橢圓曲線將資訊轉換成簽密文後
才傳送給接收者，只有接收者可將訊息解密並還原訊息，因此即使攻擊者偽冒成員發送簽密文給接收者，在
驗證過程中也會被接收者發現，所以可有效避免中間人攻擊。 
聯合攻擊方面，不論是內部或外部攻擊者皆無法進行聯合攻擊。因為會議金鑰建立的過程中，成員所傳
送的訊息皆利用橢圓曲線將資訊轉換成簽密文後才傳送給接收者，任何人皆無法偽冒成員發送簽密文，所以
無法修改其它成員的資訊。另外在會議金鑰更新的部分，由於不論是哪一個模式中，當成員異動時，更新會
議金鑰的方式皆是候補者當時才選取新的隨機亂數值，因此並不會有任何外部非法成員可用舊有的資訊和內
部合法成員共謀，推得過去或是未來的會議金鑰。 
我們將本計畫所提五種金鑰建立模式之安全性，與 Chang [2]及 Chen [5]所提之架構之安全性做比較，並
整理於表 4.1。 
 
表 4.1 本研究、Chang 與 Chen 之安全性分析比較表 
 Chang[3] Chen[6] Our Scheme 
金鑰獨立性 ○ △ ○ 
重送攻擊 △ ○ ○ 
猜測攻擊 △ － ○ 
推導私密資訊攻擊 ╳ ○ ○ 
 9
可供推廣之研發成果資料表 
□ 可申請專利  ; 可技術移轉                                      日期：96 年 8 月 23 日 
國科會補助計畫 
計畫名稱：植基於橢圓曲線之動態會議金鑰分配機制研究 
計畫主持人：廖鴻圖 
計畫編號：NSC 95-2221-E-128-003-   學門領域：資訊安全 
技術/創作名稱 金鑰管理分配機制 
發明人/創作人 廖鴻圖 
中文： 
本機制針對有線及無線Ad hoc網路環境，透過橢圓曲線密碼學
與Lagrange內插多項式，提出安全且有效率的金鑰建立方法。除了
能有效降低整體會議金鑰建立的運算成本外，也改善過去研究中，
於會議金鑰建立時必須存在著會議主席的角色，進而導致成員間資
料運算量的不公平，以及部分成員會比其他成員更早得知會議金鑰
的問題。並透過智慧卡的使用，有效解決Ad hoc網路環境中對於行
動設備儲存及資料運算量的限制。 
技術說明 英文： 
This mechanism provides a secure and efficient conference key 
distributed method integrating with Elliptic Curve Cryptography and 
Lagrange Interpolation for wired and ad hoc networks. This method not 
only can reduce the integral cost of key distributing operation, but can 
improve past researches which needs chairperson on their scheme of 
key distribution that might conduct unfair situation on data or key 
compute. Furthermore, our method also improves the limitation of 
mobile equipment in storage and data compute efficiently by Smart 
Card. 
可利用之產業及 
可開發之產品 
 
1. 可運用於網管的產業 
2. 金鑰管理的產品 
技術特點 
    本研究針對集中式及分散式的金鑰分配協定類型，提出了兩種
會議金鑰建立模式。其概念皆是透過智慧卡的使用，儲存使用者於
