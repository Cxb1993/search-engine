2底函數類神經網路 (radial basis function neural
network, RBFNN)作為分類器。然而，半徑基底函
數類神經網路對於初始中心點的設定相當的敏感
，為了取得較佳的初始中心點，我們提出一個適
應性中心點選擇的方法，使用主成份分析
(principal component analysis)來取得較佳的中心
點，降低訓練複雜度，進而降低RBFNN的訓練時
間。此外，由於單一RBFNN的分類效能有限，為
了使得分類效果更加強健穩定，本計畫更採用
AdaBoost訓練演算法，結合多個RBFNN建構一
RBFNN-based委員會機器(committee machine)使
得人臉辨識的能力更加穩定與強健。
(a) (b) (c)
(d) (e) (f)
圖1 某人在不同光源與表情的影像。 (a) 光源在
右邊，(b) 光源在左邊， (c)正常表情，(d)沉思表
情，(e)開心表情，及(f)驚訝。
圖2 系統架構圖
三、方法
系統架構如圖2所示，其中包含：賈伯小波轉
換(Gabor wavelet transform)、半徑基底函數神經網
路 (RBFNN)、主成份分析 (principal component
analysis)與適應性布斯演算法(AdaBoost)。
(一)賈伯濾波器(Gabor filter)
賈伯小波轉換是傅立葉轉換的一個特例，以
區域傅立葉轉換原理，使用一個局部時間的區域
函數找出傅立葉轉換中的局部資訊。因為維度正
規化和灰階值正規化的兩點特色，使得賈伯小波
轉換在圖形識別中廣泛地被運用。由於正規化後
的維度大小取決於濾波器的大小，加上灰階值正
規化可以減少因光源變化對於影像的影響，使得
後續處理變得容易且方便。賈伯小波濾波器公式
如公式(1)所示：












22
2
2
2
2
22
)(



eee
k
xg xik
xk



(1)
其中    sincos, yxyxx  。標準差()代表賈
伯濾波器的寬(width)且通常被設定為2。式中減去
2
2
e 的原因是為了減緩照明變化 [1,2] 。而
  22 2sk ，代表著核小波中不同的尺度(scale)，
換句話說，k是代表核小波中不同的高頻[3]。變數
代表賈伯小波的相角(orientation)。本計畫採用五
種尺度(0,1,…,4)，與八個不同相角(0, /8, 2/8,
…,7/8)，因此可獲得40個不同尺度(scale)與相角
(orientation)的賈伯濾波器(Gabor filter)如圖3所示
。
圖 3 40 個不同尺度與相角的賈伯濾波器
利用40個不同尺度與相角的濾波器，對原始影像
進行迴旋積運算，可以得到濾波後的結果。可描
述如公式(2)所示：
dxdyyxgyxf
yxgyxfyxG
s
ss
 

),(),(
),(),(),(
,
,,


(2)
其中 f(x,y) 為原始輸入影像，而 * 為迴旋積
(convolution)運算子，gs,(x,y)代表尺度s，相角
的賈伯濾波器(Gabor filter)。經由此式可得到原始
影像在不同尺度與相角的特徵影像，如圖4所示。
為了將40張特徵影像整合成一張特徵影像，
採用平均法(average method)取出平均特徵影像
(average feature image)。平均特徵影像計算方式如
公式(3)所示：

 

4
0
87
0
, ),(
1
),(
s
s yxGN
yxO


 (3)
4得：



n
i
i
j
i
j
n
i
T
j
i
jj
i
jj
T
ZZ
n
IIII
n 11
1
))((
1 (7)
其中 ijI 代表屬於第 j個人 (person)的第 i張影像
，  ni ijj InI 11 表示第 j個人所有影像的平均。
j
i
j
i
j IIZ  代表零平均。因此，第 j個隱藏層神
經元的最適中心點，可由下式計算獲得：
kjxMc jj ,...,2,1,ˆ  (8)
其中，M j是在改良式半徑基底函數類神經網
路第 j個隱藏層神經元的轉換矩陣， jIxx ˆ 。
將n維的原始向量(x)經由式(8)轉換後，可求得
近似於n維原始向量的特徵 (m維的特徵向量
(cj))。
為了方便後續的實現與說明，我們定義第 j
個人的影像集合為
},...,2,1|{ niIS ijj 
也就是說，Sj是由第 j個人的n張人臉影像所組
成的集合。
綜合上述，我們將中心點選擇演算法的
流程描述如下：
Step 1: 從第 j個人的訓練樣本中隨機選取2張
加入集合Sj中， j從1到n。
Step 2: 根據Sj，計算式(7)求得屬於隱藏層第 j
顆神經元的共變異矩陣(Λ j)。
Step 3: 依據式(6)求得轉換矩陣(Mj)且式(6)必
須 同 時 滿 足 下 列 兩 個 條 件 式
( 0...21  njjj  與 1
2
ijm )。
Step 4: 根據式(8)，我們可以將輸入向量透過各
個隱藏層神經元的轉換矩陣(Mj)轉換成
不同的中心點，其中與輸入向量最相似的
中心點，會與輸入向量最為相近且反應值
也會是最大的。
此外，為了加速隱藏層與輸出層之間的
權重更新方式，我們提出了一個應用於隱藏
層的特別競爭學習 (competitive learning)機制
來降低其他因素對於訓練半徑基底函數類神
經網路的影響。競爭學習(competitive learning)
法，正如其名字一樣，在神經網路輸出層中
各神經元彼此競爭，勝利的神經元獲得被激
發 (active)的權利，然而，本研究中特別競爭
學習法是應用於隱藏層而不是輸出層，特別
競爭學習法的示意圖如圖 6 所示。假若第 k
個隱藏層神經元在競爭中成為勝利者，則獲
得被激發的權利並更新輸出層與勝利神經元
()間相連接的權重。改良式半徑基底函數類
神經網路的錯誤成本函式(error cost function)
定義如公式(9)所示：
2
2
1
eJ (9)
其中，e 為神經網路的誤差率(error rate)，其
誤差率(error rate)定義公式(10)所示：
yye  d (10)
其中 yd 為網路的預設輸出(desired output)，y
則是網路的實際輸出 (actual output)。根據特
別競爭學習法，由隱藏層神經元相互競爭，
找出與輸入相似且反應值最大的神經元，稱
為勝利神經元()並定義如式(11)所示：
kiii ,...,2,1maxarg   (11)
依據特別競爭學習法，勝利神經元 ()與
輸出層之間的權重(weight)根據式(12)更新：


 
otherwise)(
if)(
)1(
nw
inw
nw
i
i
i
 e (12)
其中 i 代表隱藏層神經元的索引值，用來標示
第 i 個隱藏層神經元被更新，而代表神經網
路的學習率參數。最後，中心點的更新是根
據輸出層中最大的神經元作更新，定義如式
(13)所示：
mjy jj ,...2,1maxarg  (13)
其中代表輸出層的勝利神經元索引，假若輸
入向量 (x)無法被正確辨識出來，則輸入向量
會被附加到正確的影像集合中，並且再次執
行中心點演算法求得轉換矩陣(Mj)，影像集合
(S)描述如式(14)所示：


 

otherwise)(
if)(
)1(
nS
CxnS
nS
x
x
x
C
xC
C

(14)
其中 Cx 代表輸入向量的類別標籤。
(三)適應性布斯委員會機器(AdaBoost)
適應性布斯委員會機器 (AdaBoost)具有
互補與有效結合弱分類器 (weak classifier)的
優點。訓練過程是有次序的建立弱分類器，
先建立一個弱分類器，之後針對前一個弱分
類器學不好的資料，進行訓練，以此類推。
6使每個人樣本數一致，因此我們只取其中有
超過 10 張影像的 30 個人，換句話說就是對
每一個人取 10 張不同的影像總共 300 張。，
圖 8 為所挑選的 10 個人，圖 9 列示了其中五
位的十張影像，很明顯的，這些影像存有劇
烈光源變化，且表情多樣及髮型相異等現
象。Yale 人臉資料庫包含 15 個人，每個人有
11 張影像，共 165 張灰階的人臉影像。圖 10
為所有 15 個人的代表影像，圖 11 則是其中
三人的 11 張影像，很明顯的，影像中也包含
了劇烈的光源變化、表情變化與配戴眼鏡等
臉部細節。
圖10 Yale 人臉資料庫
圖11 Yale人臉資料庫問題影像樣本
(1) 決定半徑基底函數類神經網路的最佳參
數
在半徑基底函數類神經網路中，有輻率半
徑與學習率兩個參數需要被決定。如果參數
選擇良好的話，可以得到較佳的辨識率。我
們採用PICS彩色人臉資料庫來調整參數，在
PICS人臉資料庫中有30個不同的人，所以將
半徑基底函數類神經網路中的輸出層與隱藏
層均設定為30。實驗樣本共300張，訓練與測
試各150張，其中每人分別取不重複的五張人
臉影像進行訓練與測試。在不同的學習率與
輻率半徑條件下辨識率的結果如表1所示，當
我們將輻率半徑與學習率分別設定為0.15與
0.015，我們可以得到較高的辨識率。因此，
在本計畫中所有的實驗均採用 = 0.15與=
0.015。
表1 在不同的輻率半徑與學習率下的辨識率
輻率半徑學習率
0.2 0.15 0.1
0.05 90.67% 91.33% 89.33%
0.015 90.00% 92.67% 91.33%
0.01 90.00% 92.00% 90.00%
(2) 中心點選擇法與隨機中心點法之訓練時
間複雜度比較
為了驗證本研究所提出的以主成份分析
為基礎的中心點初始化具有提升訓練速度的
優點，我們將與傳統的半徑基底函數類神經
網路進行比較。在傳統的半徑基底函數類神
經網路中初始的中心點是隨機選擇的。本實
驗將採用兩種人臉資料庫來比較訓練時間和
迭代次數。對於每一個人，我們都選擇一半
數量的影像進行為訓練，另一半作為測試。(例
如：每一個人有十張影像，我們將選擇五張
影像作為訓練影像，另五張作為測試影像) 比
較結果如表 2 所示。我們可以從表 2 發現到
訓練時間與迭代次數均少於傳統半徑基底函
數類神經網路。很明顯地，我們提出的方法
在收斂速度上確實比傳統半徑基底函數類神
經網路快。
表 2 比較不同方法的訓練時間與迭代次數
提出方法 傳統 RBFNN
人臉
資料
庫
訓練
時間
(秒)
迭代
次數
訓練
時間
(秒)
迭代
次數
PICS 1161 112 2600 245
Yale 338 130 514 185
(3) 不同方法的識別率比較
為了展示本系統具有良好的人臉辨識能力
，本計畫使用不同的人臉資料庫與各種不同
方法進行識別率的比較。辨識率定義如下所
示：



N
i
i
N
i
i CTR
11
(16)
其中，N代表此資料庫的人數，Ci是第 i個人的
測試樣本數， Ti則是第 i個人正確分類的個
