 1
行政院國家科學委員會專題研究計畫成果報告 
可重組分散式曲面加工服務平台之發展 － 
子計畫二：可重組式多軸曲面加工製程之發展(III) 
Development of the Reconfigurable Distributed Service Platform for 
Surface Machining – Sub-project 2 ： Development of Reconfigurable 
Multi-axis Surface Machining Processes (III) 
計畫編號：NSC 96－2221－E－150－076 
執行期限：96 年 8 月 1 日至 97 年 7 月 31 日 
主持人：佘振華 國立虎尾科技大學 機械與電腦輔助工程系 
計畫參與人員：黃俊豪、鄭宇佑 大葉大學 機械與自動化工程系 
 
一、中文摘要 
 
近年來，由於客製化導向的生產模式、
產品快速變遷和市場劇烈變化，使得製造系
統面臨強大的競爭壓力。如何因應量少樣多
的客製化產品需求，並提高加工效率及快速
上市將是目前製造業最重要的課題。本子計
畫之目的在於建立以智慧型代理人技術為基
礎的可重組式多軸曲面加工製程系統。並規
劃為三年度來執行，所發展的系統可展開各
功能模組，並快速重組出各產業特定功能需
求的曲面加工軟體型態。 
本計畫第三年主要是建立車銑複合特徵
辨識之電腦輔助加工系統，並以代理人開發
工具，使用者可透過代理人機制，進行製程
規劃及數值控制程式產生，並透過各子計畫
之連線測試，實作可重組分散式製造服務平
台。此外，本計畫也延續第二年度之成果，
發展車銑複合工具機之實體切削模擬系統。
在實例驗證方面，本計畫針對一個車銑複合
工件，透過所發展的系統進行特徵辨識，產
生數值控制程式。藉由實體切削模擬軟體驗
證以及實際於 XYZC 車銑工具機切削成品，
證實本計畫所發展系統之可行性。 
關鍵詞：可重組、多軸加工、複合加工機、
代理人 
 
Abstract 
Owing to the trend of enterprise 
globalization and internationalization, “How 
to use the advantage of the multi-axis surface 
machining effectively, and increase the 
machining efficiency and speed up 
time-to-market to accommodate the demands 
of customized products having small 
quantities and various functions” is an 
important issue for the industry. The purpose 
of this subproject is to develop the Intelligent 
Agent Based Reconfigurable Multi-axis 
Surface Machining Processes System which is 
planned for three years. The proposed system 
will decompose the multi-axis machining 
modules into the detailed engineering chains 
to rapidly configure the specific demands of 
surface machining software paradigm for 
various industries. 
The achievement of the third year 
project aims to establish turn/mill feature 
recognition and machining system. The 
computer aided process planning and 
numerical control program can be generated 
and a reconfigurable distributed surface 
manufacturing service platform is established 
via the on-line test implemented by the other 
subproject teams by using the agent-based 
technology. Moreover, this project extends the 
previous achievement to develop a turn/mill 
solid cutting simulation system. A turn/mill 
part has been used as an example and the NC 
code has been generated by the developed 
system. Through the verification by the solid 
cutting simulation software and the trial cut 
on the XYZC turn/mill machine, it confirmed 
the feasibility of the proposed system. 
Keywords ： Reconfigurable, Multi-axis 
Machining, Multitasking Machine, Agent 
 
 3
 
圖2 袋槽特徵辨識示意圖 
 
3.計算出圓柱中心點(C)座標，而若圓柱中心
點與底面中心點(C0)所構成的向量與底面垂
直，則可以辨識為鑽孔特徵，鑽孔特徵辨識
示意如圖3所示。 
 
 
圖3 鑽孔特徵辨識示意圖 
 
(2)NC碼編排方面：車削加工的規劃以XZ
平面為主要加工的平面，以轉折點資料為依
據計算並規劃加工NC碼。1.車削粗加工，以
轉折點資料中X方向位置最大值除以進給深
度可以得到加工道次，若X軸切削末點落於上
一點X位置與下一點X位置之間則Z的位置由
上一點資料的Z為切削末點，而若遇車槽特徵
則以直線連結。2.車削精加工，透過特徵辨
識後，將以辨識出的特徵產生相對的NC碼，
依加工先後順序和特徵位置排列NC碼，先將
工件拆解成各部份特徵後，依照特徵編排相
對應的NC碼，將不連續的特徵以直線方式連
結，再組合成整體工件的加工NC碼。 
銑削特徵 NC 碼的產生是以特徵所組成
的面其點資料經過位置轉換求得，目前針對
銑削特徵在系統中已辨識出六面加工特徵、
袋槽特徵、鑽孔特徵。1. 六面加工特徵，將
欲加工的面旋轉至角度為 0 度的位置，旋轉
角度由特徵中心分別與六面加工每個面的中
心和角度為 0 度的基準點構成向量，利用向
量內積求角度求得，而 X 位置為平面中心至
特徵中心的距離，Y 的移動量為平面邊界 Y
座標的位移，Z 的移動量平面邊界 Z 座標的
位移，加工道次為 Z 位移長度除以加工刀具
半徑。2. 袋槽特徵，計算出特徵中心、圓弧
面起點與終點、旋轉角度。旋轉角度計算方
法與六面加工特徵相同，而 X 移動量為切削
深度，平面點群資料 X 的最大值與最小值之
差；Y 移動量為 Y 邊界距離，由平面點群資
料 Y 的最大值與最小值之差；Z 移動量為 Z
邊界距離，由平面點群資料 Z 的最大值與最
小值之差。3. 鑽孔特徵，計算出鑽孔起點、
旋轉角度、鑽孔深度、鑽孔直徑。鑽孔起點
X為第一個圓的圓心至旋轉軸中心之距離、Y
為 0、Z為第一個圓的圓心 Z值；鑽孔深度為
第一個圓圓心至第十一個圓圓心之距離；鑽
孔直徑任一圓點群資料之 Z 最大值與最小值
之差。 
(3)實體模擬切削方面 [4]：根據第二年
機台模擬功能新增加實體切削演算法，使模
擬功能更完整，在車床切削部分，因粗胚工
件為一圓柱形，產生工件時定義長度 L 及半
徑 R，再利用算圓公式計算密布在工件表面
上的點資料位置，車床模擬時先紀錄刀尖點
的位置，在讀入 NC 碼時，做機台的運動，
而當刀尖點進入工件範圍內時，根據刀尖點
所在位置計算密佈在工件上各點的新位置，
將各點資料重新鋪面完成車床模擬切削，而
在讀取 NC 碼時如讀取到 T 指令時就檢查刀
具種類，如果刀具由車刀轉換為銑刀時，則
結束車床模擬部份，因車銑複合加工機幾乎
都是先車削後銑削的情形，所以在程式中假
設不會有銑削轉車削的情形，此時將已經被
重新處理的點資料依照 STL 檔案格式儲存再
接續做銑床的部分。而在銑床方面利用三角
網格的碰撞判斷，找出要移除的面與要保留
的面，然後將網格移除後所產生的破洞進行
網格重建，最後將保留的面與重建的面合併
儲存，建立出切削後之模型，而實體切削中
刀具網格是使用事先預存的一組刀具網格
面。 
1. 網格保留面中，工件切削後所展現的實體
 5
 
圖 4 網格重建 
 
四、結果與討論 
 
4.1 程式模組實作 
本計畫第三年度所開發之車銑複合特徵
辨識模組依 Ontology 分類可新增於 Toolpath 
Ontology，顯示出模組的可擴充性，分類如
表 1 所示。 
表 1 模組分類 
SpindleTitling(主軸傾斜型)
NonorthogonalTableSpindle
Titling（主軸工作臺傾斜
型）
PostprocessorNonorthogonalTableTitling(
工作臺傾斜型)
PostProcessor_A
gent
PostProcessor
Ontology
FixturePlanning（夾具規
畫）CAPP_AgentCAPP Ontology
PathSimulation（路徑模
擬）
SimulationMachineSimulation(機台模
擬)Simulation_Age
nt
Simulation 
Ontology
Finish(精加工)
SemiFinish(中加工)
PathPlainningRoughCut(粗加工)
Toolpath_AgentToolpath Ontology
DllDllAgentOntology 
 
 
各模組的實作與結果分述如下： 
 
    (1)特徵辨識規劃模組部份，系統為針對
車銑複合工件解析，利用法向量演算法進行
車銑複合之特徵辨識，首先解析出 2-D 剖面
並以轉折點連結線段之法向量演算方式，進
行車削之特徵辨識，同時將辨識出之特徵利
用 OpenGL 顯示於視窗中，亦於表單列出特
徵名稱。第一階段之車削特徵辨識完成後，
進行第二階段銑銷特徵辨識，在解析前必須
先將待辨識之工件平面資料儲存，利用平面
上點資料解析出 3-D 銑削特徵，同時將辨識
出之特徵利用 OpenGL 顯示於視窗中，亦於
表單列出特徵名稱與特徵中心點位置。圖 5、
圖 6、圖 7 為系統中車銑複合工件模型顯示、
車削、銑削特徵辨識結果。 
 
 
圖 5 待辨識之工件模型顯示 
 
 
圖 6 車削特徵辨識與顯示 
 
 
圖 7 銑削特徵辨識與顯示 
 
    (2)NC 程式路徑編排部份，辨識完成之
特徵，並以選項方式讓使用者點選使用刀具
之種類與尺寸，並鍵入加工所需之進給率、
切削深度等路徑編排相關參數分析加工特徵
的資訊得到的點群資料為工件表面的點資
 7
 
圖 13 全部加工完成圖 
 
4.2 車銑複合實例測試 
    為了驗證車銑特徵辨識系統模組的正確
性，實作一車銑複合工件為例，測試模組產
生之特徵辨識與加工程式。 
    由 IGES 檔案讀入開始，利用特徵辨識
模組辨識出車削特徵與銑削特徵，再利用 NC
程式產生模組規劃粗加工與精加工程式產生
NC 檔，使用商用軟體 VERICUT 作驗證，查
看在模擬過程中是否有過切或餘料產生，並
以 VERICUT 內建 X-caliper 量測比對工件尺
寸，圖 14 為 VERICUT 模擬完成畫面，圖
15~16 為刀具補正加工程式模擬完成之比
對，得知圓弧半徑 10.008mm，錐度特徵傾斜
角度 33.6901°，與模型尺寸吻合。 
 
 
圖 14 VERICUT 模擬加工驗證結果 
 
 
圖 15 圓弧切削半徑量測結果 
 
 
圖 16 錐度切削傾斜角度量測結果 
 
    實際加工使用台中精機 Vturn II-20Y 型
四軸車銑複合工具機構型為 XYZC 型，XYZ
三軸線性軸再加上主軸旋轉 C 軸，X 軸行程
為 145+35mm，Y 軸行程為+45~-45mm，Z
軸行程為 355+50mm；主軸 C 軸無角度限制，
分度 0.001 度；本次實體切削各項加工使用
之刀具為：R 角半徑為 0.4mm 外徑車刀(用於
粗車削與精車削)、寬度為 4mm 切槽刀(用於
車槽)、直徑為 10mm 端銑刀(用於六面加
工)、直徑為 5mm 端銑刀(用於袋槽與鑽孔，
並使用本研究開發之車銑複合特徵辨識與加
工系統所產生之 NC 碼並做刀鼻半徑補正
後，進行實際加工，圖 17 為加工完成畫面。 
 
 
圖 17 車銑複合工件加工完成畫面 
 
 
4.4 與其他子計畫間測試關聯 
本計畫在程式的測式加工必須與各子計
畫相互配合，其中子計畫一提供可加工構型
的評估及加工時間預估，再利用子計畫三製
作各子計畫間工程之通訊協定，交由總計畫
做統合各子計畫間的工作。整個計畫是建立
代理人為基之分散式曲面加工服務平台系統
 9
 
圖 20 User_Agent 端 Mobile 的環境 
 
 
五、結論 
 
本計畫第三年主要是建立車銑複合特徵
辨識之電腦輔助加工系統及實體切削模擬系
統，並以代理人開發工具，使用者可透過代
理人機制，進行製程規劃及數值控制程式產
生，並透過各子計畫之連線測試，實作可重
組分散式製造服務平台。此外，針對一個車
銑複合工件，透過所發展的系統進行特徵辨
識，產生數值控制程式。藉由實體切削模擬
軟體驗證以及實際於 XYZC 車銑工具機切削
成品，證實本計畫所發展系統之可行性。 
  
六、結果自評 
 
本計畫在整個三年度的執行中，已經將
部分成果撰稿 7 篇，投稿發表於國際期刊 
[5-11]，此外，另有 3 篇發表於國內及國際研
討會 [12-14]。 
 
七、致謝 
 
本研究承蒙國科會計畫補助，計畫編
號：NSC 96-2221-E-150-076，特此誌謝外，
也感謝國立成功大學博士班林彥宏同學及國
立高雄應用科技大學陳茂盛老師等相關人員
 1
行政院國家科學委員會補助國內專家學者出席國際學術會議報告 
                                                          96 年  10 月 30 日 
報告人姓名 佘 振 華 服務機構 
及職稱 
  國立虎尾科技大學 機械與電腦輔助
工程系 副教授 
    時間 
會議 
    地點 
96年 10月 7日至 11日 
韓國大田 (Daejeon) 
本會核定 
補助文號 
 NSC 96-2221-E-150-076 
會議 
名稱 
 (中文) 第 10屆高等材料與製程技術國際研討會 
 (英文) The 10th International Conference on Advances in Materials and Processing 
Technologies 
發表 
論文 
題目 
 (中文) 以逆向工程製作渦輪葉片之研究 
 (英文) Study of applying reverse engineering to turbine blade manufacture 
 
一、參加會議經過 
此一 2007 年高等材料與製程技術國際研討會，乃是韓國高等科學技術學院 (Korea 
Advanced Institute of Science and Technology)所主辦，大會主席為 Yong Taek Im教授，此次會
議之與會人員，共有 209 篇論文發表，參加的學著專家分別來自台灣、澳大利亞、巴西、中
國大陸、加拿大、克羅埃西亞、法國、德國、香港、印度、伊朗、愛爾蘭、義大利、日本、
馬來西亞、奈及利亞、波蘭、葡萄牙、沙烏地阿拉伯、泰國、英國及美國等，涵蓋工業界及
學術研發單位，進行論文發表以及論壇對話。 
會議於 10月 8日上午開始報到，本次會議的主題包含金屬成形加工與模具製造之相關議
題及應用，分別是 (1) Deformation Processing (2) Forming in Melt or Near Melt Condition (3) 
Powder Forming (4) Laser Processing (5) Processing of New and Advanced Materials (6) Surface 
Engineering (7) Nano Technology (8) Other Related Processes。此外，於會程中也安排有 2篇
Plenary Talk，分別是 Dr. O. J. Kwon (Executive Vice President of POSCO)的 Steel-what we have 
to know about additionally，以及 Dr.-Ing. M. S. Kwon(Senior Executive Vice President of Hyundai 
Motor Comp.)的 Hyundai-Kia Motor Towards Future Global Leadership。 
論文報告於 10月 8日上午揭開序幕，總共分成四個會場同時進行論文之口頭發表。筆者
的論文口頭發表是安排在第二天下午的 Bending & CAD場次，筆者同時也擔任此場次的主持
人，此場次中分別有日本的Murata教授發表 Effect of Hardening Exponent on Tube Bending，
日本的 Imai 教授發表 High-accuracy v-bending system by real time identifying material 
property，英國的 Marco Ryll 發表 Towards an intelligent fixturing system with rapid 
reconfiguration and part positioning，愛爾蘭 Hoque 教授發表 Designing using manufacturing 
feature library，以及同行的雲林科技大學王永成教授發表 Development of automatic regrinding 
program for PC-based tool grinding machine，正修科技大學李政男教授發表 Tool path generation 
method for multi-axis machining of helical milling cutter with specific cross-section profile。 
