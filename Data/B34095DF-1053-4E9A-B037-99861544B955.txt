行政院國家科學委員會專題研究計畫成果報告 
腦部活動之電生理訊號源模型建立、估算、與分析  
Bioelectric Source Modeling, Estimation, and Analysis of Brain Activities 
 
 
中文摘要 
 
傳統以腦電波儀為基礎之腦機介面（EEG-based Brain-Computer Interface）
研究是在受試者的頭皮貼上 EEG 電極，然後利用在電極上所量測到的頭皮電位
波形來進行訊號分類並轉換成控制命令，以操控電腦或機器執行該受試者的意念
所相對應的任務。由於在電極上所量測的電位，是由腦部所有活化區域所誘發的
電生理訊號傳導至該電極位置的整體效應，因此與控制意念或特定事件不相關的
腦部活動將會干擾訊號量測與分析。為了增加腦機介面系統的準確性、穩定度、
與效能，我們在本計畫中開發腦部活動之電生理訊號源模型建立、估算、與分析
技術，以計算與控制意念或特定事件相關之腦部神經元活動時序訊號，並利用這
個腦部活動訊號來進行特徵擷取與訊號分類，以此來開發腦機介面系統。我們利
用 重 疊 球 體 模 型 建 構 出 最 大 對 比 之 光 束 構 成 法  (Maximum Contrast 
Beamformning Method)，並以此方法為基礎建構出一個空間濾波器，訊號經過此
空間濾波器之後能有效率除雜訊，並且拉大訊號在兩種狀態下的強度對比，提高
訊號的訊雜比，使得訊號的形別更容易被腦機介面系統辨識出來。 
 
關鍵詞：腦電波儀、重疊球體模型、腦機介面、光束構成法、空間濾波器 
                 
 
where the definition of cn and the head model can be found
in [4], R = ‖s‖, f = ‖r‖/R, r0 and t0 are the radial
and tangential unit vectors, respectively, θ denote the angle
between r and s, and Pn and P 1n are the Legendre and
associated Legendre polynomials of degree n, respectively.
Typically, the summation term in Equation (1) will be
converged after 200 to 300 iterations, which make this method
inefficient. In [5], Berg et al. presented an efficient way to
calculate the forward model based on multiple-shell spherical
head model. This method uses the true dipole location r to
select three dipole locations along the same radial line. Infinite
summation term in Equation (1) for a single dipole using
the multiple-shell spherical head model can then be replaced
by a summation of these three dipoles using the single-shell
spherical head model. Another approximation method was
introduced by Sun [4]. The main concept of Sun’s method
is to use a polynomial function, whose calculation is more
efficient, to approximate the summation term in Equation (1).
Both of the Berg and Sun’s methods improve the efficiency of
forward calculation at the expense of losing some accuracy.
2) BEM model: BEM model is the most realistic head
model because it uses the triangle meshes to separate tissues
with different conductivities, such as brain, skull, and scalp.
Conductivity can then be well set throughout the head. How-
ever, calculation of BEM model is time-consuming and the
head MRI (Magnetic Resonance Imaging) of the subject is
required to reconstruct the tissue surfaces.
B. Inverse Problem
Inverse solution can be separated as fitting method and
scanning method. Fitting method including focal source and
distributed source solves inverse problem by fitting the mea-
sured surface potential to the predicted surface potential from
the EEG forward model. Scanning method is to scan the whole
brain space and reveal locations having significant neuronal
activation.
1) Fitting method:
a) Focal source: Assume brain source consists of only a
single dipole. Least-square estimation can be used to solve the
inverse problem. If there are multiple dipoles, we can first use
the independent component analysis to decompose the EEG
measured data into several components induced by different
dipoles, then apply least-square estimation for each component
to solve the inverse problem.
b) Distributed source: If we have no prior knowledge
of how many sources in the brain, distributed source estima-
tion method can be used. LORETA (LOw REsolution brain
electromagnetic TomogrAphy) [6] is a widely-used method to
solve the distributed source inverse problem. It find a smooth
area of possible brain activation because the neighboring grid
points have similar activation.
2) Scanning method: Now we introduce a inverse method,
called beamforming, which scans the whole brain space to
reveal possible source locations. The main idea of beam-
forming is to design a special kind of spatial filter that can
linearly combine the recorded EEG data from every sensor to
reconstruct the source activation:
y = wT (r0;q0)x, (2)
where y is the reconstructed moment of the dipole with
location r0 and orientation q0‖q0‖ and w(r0;q0) is an N × 1
vector denoting the spatial filter. In [7], Van Veen et al.
proposed a linearly constraint minimum variance spatial filter
and the solution of w(r0;q0) is:
w =
(C+ αI)−1l
lT (C+ αI)−1l
, (3)
where l is the leadfield, α represent the regularization parame-
ter, and C is the covariance matrix of measured data. We drop
(r0;q0) for w and l for simplicity and clarity. Notice that the
induced surface potential is inversely cubic-proportional to the
source depth [1]. Therefore, if the spatial filter is computed for
a deeper position, the reconstructed neural activation will be
larger. Therefore, we calculate the f statistic of the activation
power:
f =
wTCaw
wTCcw
, (4)
where Ca and Cc denote the covariance matrices estimated
from the measured data in the active and control states
respectively.
C. Brain-computer Interface Systems
Here we introduce some present-day BCI systems, we
mainly introduce two kinds of BCI systems, the ERP-based
BCI and the motor-imagery based BCI.
1) ERP-based BCI: The details about ERP is described
in section II-C.1, because the ERP is evoked by the external
events, this kind of BCI usually depends on the gaze of the
user. We can always detect the ERP as long as we have
enough trials. This kind of BCI has its advantages like the
short training time and high accuracy. The drawbacks are the
transition rate may be slow and the users may habituate to
the system and lower the performance. Here we introduce two
main ERP-based BCI, the P300-based and SSVEP-based BCI.
Farwell proposed a spelling BCI system based on P300 ERP
[8]. In this system, users are gazing at a 6x6 matrix on the
screen. In the matrix there are letters, numbers, and symbols.
When the system starts, it flashes each row and column in
the matrix with random sequence. The user is asked to focus
his attention on the symbo he wants to select and count the
number of time that this symbol is flashed. This is an oddball
paradigm and the there will be an evoked P300 when the
selected symbol is flashed. With enough trials, the system can
predict the selected symbol by detecting the P300 response.
That’s the concept of this BCI system.
The SSVEP is Steady-state Visual Evoked Potential. It is a
response to a visual stimulus with a specific high frequency.
V (s) =
1
2pi
1
σ−j + σ
+
j
∫
G
jp(r)· s− r‖s− r‖3 dv
′
− 1
2pi
m∑
i=1
σ−i − σ+i
σ−i + σ
+
i
∫
Si
V (r)n(r)· s− r‖s− r‖3 dS
′
i, s ∈ Si,
(5)
where σ−i and σ
+
i are the conductivities inside/outside the
ith surface, respectively, jp(r) is the primary current, and
n(r)dS′i is a vector element of surface Si with its direction
aligned to outward surface normal of the surface Si. Primary
current is unrelated to the spherical geometry and can be
dropped. Therefore we can calculate the OS by fitting the
return current contribution term in Equation (5) based on the
spherical model:
m∑
i=1
(
∫
Sre
i
(nre(r)· s− r
re
‖s− rre‖3 )
jref (r)
σ−i + σ
+
i
dS′i
−
∫
Ssp
i
(nsp(r)· s− r
sp
‖s− rsp‖3 )
jspf (r)
σ−i + σ
+
i
dS′i) ∼= 0, (6)
where the superscript re stands for the realistic head, sp stands
for the approximated head, and jf (r) is the secondary current
on each surface:
jf (r) = −(σ−i − σ+i )V (r)n(r) = jf (r)n(r). (7)
Human skull conductivity is about two orders of magnitude
less than the other tissue conductivities, such as brain and
scalp. Therefore, the dominant return current contributions will
come from the innermost skull [15]. Thus, we can simply
evaluate the integral on the innermost skull surface. It has
been shown that true potentials and spherical potentials are not
dramatically different [12], so we simply assume jref = j
sp
f
and rewrite Equations (6) and (7) as:∫
Sre
inner skull
(nre(r)· s− r
re
‖s− rre‖3
−nsp(r)· s− r
sp
‖s− rsp‖3 )j
re
f (r)dS
′ ∼= 0. (8)
To solve Equation (8) we use two dense surface meshes
containing N points to represent the realistic innermost skull
surface and the fitting sphere, respectively. The least-square
fitting problem is simply to minimize the following equation
(cost function):
N∑
i=1
‖nre(i)· s− r
re(i)
‖s− rre(i)‖3 − n
sp(i)· s− r
sp(i)
‖s− rsp(i)‖3 ‖
2, (9)
where rre(i) and nre(i) (i = 1, 2, . . . , N ) denote the lo-
cations and normal orientations of the mesh points on the
innermost skull surface, respectively, and rsp(i) and nsp(i)
are those for the approximating sphere.
Given a sphere {C0, R0}, rsp(i) can be obtained by radially
mapping rre(i) to the surface of the approximated sphere.
Thus we can substitute expressions for rsp(i) and nsp(i) in
terms of the rre(i) and nre(i) as
rsp(i) = R0nsp(i) +C0,nsp(i) =
rre(i)−C0
‖rre(i)−C0‖ . (10)
Therefore, Equation (9) can be written as the final cost
function:
min
R0,C0
N∑
i=1
‖nre(i)· s− r
re(i)
‖s− rre(i)‖3
− r
re(i)−C0
‖rre(i)−C0‖ ·
s−C0 −R0( r
re(i)−C0
‖rre(i)−C0‖ )
‖s−C0 −R0( rre(i)−C0‖rre(i)−C0‖ )‖3
‖2. (11)
Repeating Equation (11) for each EEG sensor yields a set of
overlapping spheres.
3) Calculation of inner skull surface: Assume vertex
i is surrounded with M triangles whose normals are
n1, n2, . . . , nM and superficial measures are a1, a2, . . . , aM
(evaluated by Heron’s formula), respectively. nre(i) can be
estimated by:
nre(i) =
∑M
j=1 ajnj
‖∑Mj=1 ajnj‖ . (12)
Assume that the thickness of scalp and skull is constant
throughout the human head. rre(i) can be estimated by:
rre(i) = s(i)− Tnre(i), (13)
where s(i) is the i-th sensor location, and T denote the average
thickness of human scalp and skull [16], [17].
4) Correction of overlapping spheres: The calculated OS
boundary of each sensor may not perfectly fit the sensor
locations because of the non-linear search procedure in Equa-
tion (11). Two simple ways can be used to adjust the OS to fit
to each EEG sensor location: 1) to translate the sphere center,
and 2) to change the sphere radius. Related assessments of
these two methods will be described in Section IV.
Figure 3 shows the flowchart of the proposed OS forward
model. First, we use Heron’s formula and the weighted normal
to find the inner skull normals nre(i) and evaluate inner skull
mesh locations rre(i) by assuming that the thickness of scalp
and skull is constant. Then, the OS cost function described
in Equation (11) is applied to estimate the sphere radius R0
centered at C0. Finally, we can correct estimated OS by
translating its sphere center C0 to fit the EEG sensor to the
OS boundary.
Fig. 4. Time-frequency map of I01. The map has been normalized to
[0 1] respectively. The dominant frequency is around 10-15Hz and the post-
movement power appears about 1 second later.
position of the brain source. In our methods, we searched
the brain and find the location with maximum contrast
beamformer.
4) Optimal regularization parameter : The regularization
parameter refers to the α in Eq 14. A value of 10−7 is
applied in the general cases.
5) Feature extraction : After the signal was filtered by the
spatial filter, we extract the feature for classification by
calculating the variance of the signal. The variance of
a signal at an instant time is calculated by the nearest
500ms periods.
6) Classification of brain states : We use a threshold to
define the boundary of active state and control state. We
determine that the subject is performing motor related
tasks when the variance is larger than the threshold or
the subject should be resting.
3) Implementation of Spatial Filter: Recent studies show
that cognitive tasks and motor functions are relevant to specific
frequency band of EEG signals [24]. In our methods, it is also
important to decide the dominant frequency band. Details will
be illustrated and discussed in this section.
In order to estimate the dominant frequency band, we
applied continuous wavelet transform (CWT) to EEG signals.
CWT is a time-frequency analysis method in signal processing
procedures and each trials was calculated using morlet wavelet.
In Fig 4, , the frequency with range from 10 to 30 Hz
was illustrated and upper alpha band (10-13 Hz) could be
determined as a dominant frequency band.
In our method, we use 10-15 Hz as the dominant frequency
band for this subject. A band pass filter was applied to the
raw EEG signals before the proceeding calculations.
In maximum contrast beamforming method, trials are used
to calculate the covariance matrix of active and control states.
Thus an appropriate period of signals which can represents
the states is very important. Different ranges of active state
are tested and we found that 0.5 second width (covered by
the red area in the time-frequency map) is the best range for
the maximum contrast. On the other hand, we used 1-second
range for resting state signals. Since the signal of the resting
state is more stable (the subject do nothing with eyes opened),
Fig. 5. X-ray projection of the phantom skull and EEG electrodes. The
32 coaxial cables that form the dipoles were inserted through the skull. The
other ends of the cables were connected with the driver through the source
connector. The EEG electrodes were attached on a conductive latex “scalp”
layer to record surface potential. (Figure source: [16].)
Phantom
source
Forward
model
Predicted
potential
Inverse
estimation
Predicted source
Phantom
potential
Fig. 6. Flowchart of the correctness and accuracy verification on forward and
inverse method. The predicted potential produced from forward model can be
compared with phantom potential to verify the forward model correctness (left
part). The predicted source produced from inverse estimation can be compared
with phantom source to verify the inverse estimation correctness (right part).
the range of resting state didn’t effect the result very much.
IV. EXPERIMENT RESULTS
A. Inverse Estimation
1) Phantom Data: Leahy et al. constructed a EEG/MEG
phantom containing brain, skull, and scalp layers stuffed with
tissues with realistic conductivities [16]. Thirty-two indepen-
dent current dipoles were positioned in the phantom and EEG
/ MEG data were recorded separately for each dipole (Figure
5).
Figure 6 shows the flowchart of correctness and accuracy
assessment of forward model and inverse estimation. By com-
paring the predicted surface potential using our forward model
with measured phantom surface potential, we can evaluate the
accuracy of our forward model. Similarly, by comparing the
estimated source using our inverse method with the ground-
truth phantom source, we can evaluate the accuracy of our
inverse method.
The following equation (normalized correlation) was used
as the comparison criterion:
x′·x
‖x′‖‖x‖ × 100% (17)
Fig. 9. Slice-view of brain activation result. We cut the slices by z-axis,
and interval between slices is 1.5 mm where each slice is 30 mm × 30 mm.
Red color represent location with larger activation while blue color represent
location with smaller activation. Black square denotes phantom ground truth
while blue square denotes our predicted source location. Left figure is dipole
#2 whose localization error is smallest (2.59 mm), and right figure is dipole
#11 whose localization error is largest (12.72 mm) among 32 dipoles.
the localization error of Sun’s method of forward model is
smaller when the OS is used (7.87 mm) than that when the
OS is not used (8.00 mm). Thus, we can conclude that “Sun
method with OS” is the best choice, among these forward
models. Notice that in [16], the localization error using BEM
forward model (the most realistic one) and the MUSIC inverse
method is 7.62 mm. Although our method achieve a little bit
higher error, computation of our method is much more efficient
because our method do not compute the time-consuming BEM.
Figure 9 shows slice-view of two brain activation results.
We cut the slices by z-axis, and interval between slices is 1.5
mm where each slice is 30 mm × 30 mm. Red color represent
location with larger activation while blue color represent
location with smaller activation. Black square denotes phantom
ground truth location (real dipole location) while blue square
denotes our predicted source location using Sun method with
OS as forward model and hierarchical-search beamforming as
inverse estimation. Left figure is dipole #2 whose localization
error is smallest (2.59 mm); right figure is dipole #11 whose
localization error is largest (12.72 mm) among 32 dipoles
(ignoring dipole #5 and #12 because their locations are too
deep in head [16]).
For comparison, the localization error using a public domain
software, EEGLAB [25], [26], is 14.16 mm (Figure 10).
EEGLAB provides an interactive Matlab toolbox for process-
ing continuous and event-related EEG data using ICA, time /
frequency analysis, and other methods including artifact rejec-
tion. Its inverse estimation method uses ICA to separate the
measured EEG data, then do the source localization method
on the separated signal. Our method obviously outperforms
EEGLAB.
2) Real experiment: We also apply our method to esti-
mate the neuronal activity from the EEG data during visual
and audio tasks. Recorded EEG data is first applied some
signal pre-processing procedures, such as baseline-correction
(remove DC-drift), band-pass filter (remove power-line signal),
artifact rejection (reduce eye-moving influence), and synchro-
nized averaging (improve signal-to-noise ratio) using SCAN
4.3 software (Compumedics, NeuroScan Corporation). After
0 5 10 15 20 25 30 35
0
5
10
15
20
25
30
Fig. 10. Source localization error comparison between our method (Sun
method with OS and hierarchical-search beamforming as inverse estimation,
circular patterns) and EEGLAB (cross patterns). X-axis denotes dipole index
in phantom data, and Y-axis denotes localization error (unit: millimeter).
Evidently, localization error using our method is much smaller than using
EEGLAB.
extracting ERP, our proposed source localization technique is
applied to solve the brain source.
The subjects in experiment of visual-evoken potential (VEP)
are two females with 21-year-old (Subject A) and 24-year-old
(Subject B); another subject for experiment of audio-evoked
potential (AEP) is a 22-year-old male (Subject C). During the
experiment of VEP, a white square appeared on the center of
LCD (liquid crystal display) screen once per 0.3 sec as the
visual stimulus. Similarly, during the experiment of AEP, a
monotone with duration 0.05 sec displayed once per 2 sec as
the audio stimulus.
From the visual ERP obtained by averaging trials, as shown
in the bottom part of Figure 11, we found a positive peak at
155 ms for Subject A and another negative peak at 153 ms
for Subject B respectively, where stimulus on-set time is 0
ms. Functional mapping by using the proposed method (Sun
with OS and hierarchical-search beamforming), as well as the
dipole-fitting results, for each of the three peaks are illustrated
in the top part of Figure 11. It is obvious that our method
successfully reveal the region in the occipital area with strong
significance of neuronal activity. Figure 12 shows audio ERP
obtained by averaging trails, as well as VEP, the revealed
region using our method is located in the temporal region with
strong neuronal activity. Notice that the functional mappings
for Subjects A, B, and C all use the same MRI structure, such
that the visualized results may have some bias.
B. BCI Experiments
1) Experiment Paradigm: The experiment paradigm is in
Fig 13. At the beginning of a trial, a fixation cross is shown in
the middle of screen and disappeared at 2s. After the warning
tone, a visual cue (an arrow points to the left or right) will
appear and last for 1.25 seconds. The subject is told to do
the finger movement/imagery task after the cue disappeared.
Left arrow is for left finger lifting task and vice versa. In this
experiment, a session is about 20 minutes and the period of a
Fig. 14. Tomography of data R01. The brain was divided into grids and
each F value was calculated using maximum contrast beamforming methods.
Fig. 15. Topography of data R01. The topography of data R01 (right
hand movement trials) was used to calculate the spatial filter. Notice that the
activation brain source is at the left hemisphere with respect to right hand
movement.
1) Detection of Active State: The flowcharts for recognition
is in the following. In Fig 16, we applied our spatial filter to
EEG signals (8-15Hz). We extracted the feature by calculating
the signal variance and then used a threshold to recognize the
active brain states.
In Fig 17 and Fig 18, we take a look at continuous 20 trials
form data set I02 (left hand finger imagery). Data set I02 is the
most clean data set which has least noise interference. The left
column are the first continuous trials recorded at C4 channel
and the right column is the data filtered by our maximum
contrast filter. In trial 07, the raw data has some noise at 0-
2000 sample points (i.e. 2 seconds before the cue appear).
After applying the spatial filter, the noises were eliminated
and the variance is stable around 5000-7000 sample points.
Similar cases can be found in trial 01, 11 and 19. For trial
Fig. 16. Flowchart - Recognition of Active State.
Fig. 17. Applying filter to raw data. The signals are from data set I02 (trail
1-10), left finger imagery trials. The left column is the raw data recorded at
channel C4, and the right column is the filtered signal.
03, 07, 10, 16, we can see that the variance of the signals is
largely increased.
In contrast to data set I02, we also show the continuous
20 trials from data set R02 which is largely interfered by the
environment and the subject. In Fig 19, we can see the noise
is larger than I02 by observing the signals around 0-3000ms.
After applying our filter, we successfully suppressed the noise.
2) Averaged Variance Ratio: In our method, we extracted
our feature by calculated the signal variance. In order to
evaluate the changes of the signal, we calculated the variance
of the filtered signal by a 500ms-width sliding window. Firstly,
We calculated the signal variance curve and then divided it by
the variance of resting states. We called it the ratio curve
and we used it as our feature. In Fig 20, we illustrates the
averaged ratio for each data sets (right hand tasks). We can
see that the ratio at active states is at least 3 times larger the
resting states (blue curve) which is larger than the ratio of
raw data (red curve). Besides, there are some noises before
the cue in data set R02 and R03. That may be result from the
eye movement or the subject moved his body. Those noises
are largely suppressed and this is also a practical property for
BCI systems.
3) Evaluating ROC Curves: In Fig 21, we used the ratio
curve as our feature. While evaluating the performance, a
threshold was adjusted and the Eq 18 will be calculated. The
classification result was in Fig 22 and Fig 23. The red curve
Fig. 20. Averaged variance of trials. In the figure, the averaged ratio for
each data set is illustrated. The result is from right finger movement/imagery
trials. The x-axis is time and y-axis is the value that the current signal variance
divides the signal variance at resting states. The red line is for raw data
recorded at channel C3, the blue line is for filtered signals.
Fig. 21. Paradigm for sample-by-sample analysis. Sample-by-sample
evaluates the true positive rate (TPR, denotes the accuracy in ”event period”
which is the higher the better) and the false positive rate (FPR, denotes the
error in ”non-event period” which is the lower the better ). The event period
are defined by 2.25-5.0s after the arrow appeared. [27]
method does.
In asynchronous BCI systems, the most difficult problem is
the determination of active periods. Motor related tasks such
as hand, arm or finger movement/imagery are important tasks
in BCI systems. In our work, we proposed a spatial filter
which can efficiently recognizes the active periods of brain
sources. Furthermore, we used maximum contrast beamform-
ing method to calculate the optimal dipole orientation which
can maximize the variance of active and control state signals.
We used continuous wavelet transform to preprocess the
raw EEG signals. After the dominant frequency band and the
ranges of signals were decided, we calculated the spatial filter
and further applied it to EEG signals. The filter successfully
maximized the variance of the signals at active period and
minimized the variance in resting states.
In our method, feature extraction and classification is simple
but effective. We use signal variance as features and we only
use a threshold to classify the brain states.
The major advantages of our filter is as follows.
1) Noise suppression: Our spatial filter can successfully
suppress the noises from other brain areas. And the
optimal brain source can be acquired by searching the
whole brain with beamforming method.
2) Accommodation: For each BCI system users, they may
have their own spatial filters which are adjusted by their
Fig. 22. ROC curves for Data sets R01, R02, I01. Sample-by-sample
evaluates the true positive rate (TPR, denotes the accuracy in ”event period”
which is the higher the better) and the false positive rate (FPR, denotes the
error in ”non-event period” which is the lower the better ). The event period
are defined by 2.25-5.0s after the arrow appeared.
own parameters. We verified the stability of the spatial
filter. Users can only measure the sensor position once
and apply it to proceeding procedures.
3) High recognition rate: In section IV-C, we successfully
increased the signal variance which is important in
recognition of brain states. In our results, the ROC
curves shown the ability of the spatial filter.
However, how to construct asynchronous BCI systems is
still a difficult problem, and we may base on the spatial filter
for more research in future works.
REFERENCES
[1] J. C. Mosher, R. M. Leahy, and P. S. Lewis, “EEG and MEG: For-
ward solutions for inverse methods,” IEEE Transactions on Biomedical
Engineering, vol. 46, pp. 245–259, 1999.
[2] B. N. Cuffin and D. Cohen, “Comparison of the magnetoencephalo-
gram and electroencephalogram,” Electroencephalography and Clinical
Neurophysiology, vol. 47, pp. 132–146, 1979.
[3] Y. Salu, L. G. Cohen, D. Rose, S. Sato, C. Kufta, and M. Hallett,
“An improved method for localizing electric brain dipoles,” IEEE
Transactions on Biomedical Engineering, vol. 37, pp. 699–705, 1994.
[4] M. Sun, “An efficient algorithm for computing multishell spherical
volume conductor models in EEG dipole source localization,” IEEE
Transactions on Biomedical Engineering, vol. 44, pp. 1243–1252, 1997.
[5] P. Berg and M. Scherg, “A fast method for forward computation
of multiple-shell spherical head models,” Electroencephalography and
Clinical Neurophysiology, vol. 90, 1994.
出席國際學術會議心得報告 
                                                             
計畫編號 95-2221-E-009-213- 
計畫名稱 以生理訊號為基礎之人機介面設計與應用─人類操控機器的新模式-子計畫三：腦部活動之電生理訊號源模型建立、估算、與分析(2/2) 
出國人員姓名 
服務機關及職稱 
陳永昇  助理教授 
國立交通大學 資訊工程學系 
會議時間地點 February 12-16, 2007, Innsbruck, Austria 
會議名稱 
The IASTED International Conference on Artificial Intelligence and 
Applications 與 The IASTED International Conference on Biomedical 
Engineering 
發表論文題目 Stabilized Linear Model for Neuromagnetic Source Localization 
 
一、參加會議經過 
在發表論文於 IASTED International Conference on Biomedical Engineering 之前，我們也
在二月 12、13 日參加了 IASTED 協會所舉辦的另一場會議：IASTED International Conference 
on Artificial Intelligence and Applications。從這個會議中可以看出 Genetic Algorithms、Machine 
Learning、Intelligent Agents、Neural Networks、與 Expert Systems 等領域的最新發展，大會
也安排了關於 “Biometrics Intelligent Information Systems and Applications＂的 Tutorial，內容
豐富精采。 
緊接著從二月 14 日至 16 日，我們參與了 IASTED International Conference on Biomedical 
Engineering 會議，並發表了研究論文：“Stabilized Linear Model for Neuromagnetic Source 
Localization”。 
 
圖：論文發表 
 
STABILIZED LINEAR MODEL FOR NEUROMAGNETIC SOURCE
LOCALIZATION
Yong-Sheng Chen1, Chih-Yu Cheng1, Tzu-Jung Lin1
1Department of Computer Science
National Chiao Tung University
Hsinchu, Taiwan
Jen-Chuen Hsieh2,3, Li-Fen Chen3
2Department of Medical Research and Education
Taipei Veterans General Hospital
3Institute of Brain Science
National Yang-Ming University
Taipei, Taiwan
lfchen@ym.edu.tw
ABSTRACT
In MEG studies, head movement during data recording of-
ten causes problems in event-related averaging as well as
source localization accuracy. We propose in this work a sta-
bilized linear model which can solve this head movement
problem by conceptually increasing the sensor number, un-
der the condition that the head movement is known. This
method is particularly beneficial for MEG studies in which
head movement commonly occurs, such as those studies
requiring long experimental duration or those when pa-
tients/children are involved. Phantom studies and studies
of somatosensory evoked field clearly show the effective-
ness and accuracy of the proposed method.
KEYWORDS
Magnetoencephalography, source localization, stabilized
linear model
1 Introduction
Magnetoencephalography (MEG) has the advantage of
excellent temporal resolution and becomes a powerful
method for in vivo noninvasive imaging of neural dynamics
[1]. Considering the source localization problem in MEG
studies, many efforts have been focused on the develop-
ment of accurate and reliable forward models as well as
inverse solutions of neuronal activities [2, 3, 4]. For all
kinds of source localization methodologies, the number of
MEG sensors and the signal-to-noise ratio (SNR) of MEG
recordings are crucial to the accuracy and reliability of the
estimated neuronal activities [5, 6, 7]. According to the an-
alytical analysis in [5], the standard deviation of localiza-
tion error is proportional to the standard deviation of noise
and is inversely proportional to the square root of the num-
ber of MEG channels. Thus, reducing noise in neuromag-
netic measurements and increasing the number of sensors
are two promising ways to enhance the accuracy of neu-
ronal source localization.
Several simulation studies reported that the MEG sys-
tems with more channels have the potential to obtain more
accurate localization results [5, 8, 9, 10]. However, higher
sensor density of the array implies smaller MEG sensing
coils, which will result in lower sensitivity of the MEG sen-
sors [6]. Compromising between the sensor density and the
sensor sensitivity, the current maximum number of sepa-
rating sensing sites in CTF MEG Systems (VSM MedTech
Ltd., Canada) [11] is 275, while the maximum number of
channels in Neuromag MEG systems (Elekta Neuromag
Oy, Finland) is 306. Thus, how to increase sensor density
of an MEG array is still a challenge.
In event-related MEG studies, one can reduce the
interference of the background noise from the corrupted
measurements by using trigger-locked averaging. Trigger-
locked averaging over M consecutive epochs can reduce
the standard deviation of the additive random noise from
ση to
ση√
M
so as to increase the SNR of the average data
by a factor of
√
M . However, head movement will cause
the inter-trial inconsistency on the relative positions be-
tween sensors and neuronal sources. Such inconsistency
will decrease the effectiveness of sensor-signal averaging
as well as localization accuracy. Therefore, head stabiliza-
tion is particularly important for noise reduction by averag-
ing event-type neuromagnetic responses.
To avoid the head movement problem, one can sim-
ply ask the subject to keep his/her head still during the
MEG experiments. However, head motion is unavoid-
able in some circumstances, for example, the studies in
which Parkinson’s patients participate, or experiments with
long signal recording time. Therefore, various approaches
have been adopted to deal with the head movement prob-
lem. Among these approaches, the easiest way is to dis-
card the measurements with large head movements during
data acquisition [12]. The drawback of this approach is
the expense of longer acquisition time, which might induce
other artefact sources, such as fatigue. Another kind of ap-
proaches to attack the head movement problem is to cor-
rect the blurred average data due to head motion [13, 7].
These methods estimate preliminary source signals from
the blurred average data according to proper sensor con-
figuration prior to the reconstruction of the ”virtual sen-
sor measurements” corresponding to the desired reference
head position. Refined sources can then be derived from the
average data of the virtual measurements. The drawback of
these methods is the possibility of information loss while
Q that best approximate M. Usually ES is larger than
N and Equation (3) is an overdetermined system. In this
case the straightforward solution of the inverse problem is
to minimize the following square of the Frobenius norm in
a least-square sense [3]:
{ ˆrqi, Qˆ} = arg minrqi,Q
‖M− LQ‖2F . (4)
The dipole locations can be determined through a nonlin-
ear optimization procedure and the dipole moments can be
obtained by the following equation:
Qˆ = (LTL)−1LTM. (5)
If the subject’s head holds still throughout the data
acquisition period, the lead field matrices Li, i = 1, . . . , E,
for all the epochs will be the same, that is, L1 = L2 =
· · · = LE . Equation (5) can be rewritten as:
Qˆ =


L1
L2
.
.
.
LE

T 
L1
L2
.
.
.
LE


−1 
L1
L2
.
.
.
LE

T 
M1
M2
.
.
.
ME

=
(
L1TL1
)−1L1T
 1
E
E∑
j=1
Mj
 . (6)
Equation (6) states that the least-square solution by using
the proposed stabilized linear model is equivalent to that of
the conventional method when the head holds still and the
averaged data is used for dipole fitting.
3 Experiments
In this work, we used a homogeneous spherical model
as the head conductor model for the two experiments de-
scribed later in this secion. The sources of phantom study
and N20 m somatosensory evoked fields (SEF) were mod-
eled by a single ECD, which has been widely adopted in
the analysis of early evoked somatosensory responses [14].
Nelder-Mead simplex method was used to search the best
dipole location and the dipole moment Q was calculated
from Equation (5). The X, Y, and Z axes of the head co-
ordinate system indicate the orientations from left to right,
posterior to anterior, and inferior to superior, respectively.
Two experiments, phantom and SEF, were conducted
in this work to evaluate the source localization accuracy of
the proposed SLIM method, conventional direct-averaging
(DA) method, and forward correction (FC) method [13].
The magnetic signals were recorded by 204 planar gra-
diometers of a whole-head neuromagnetometer system
(Vectorview system, Neuromag Ltd., Finland).
3.1 Phantom Study
An MEG phantom (Neuromag Ltd., Finland) was used to
evaluate localization accuracy in order to prevent potential
errors due to inappropriate forward modeling and human
intervention. Sixteen fixed current dipoles located on two
orthogonal planes were activated sequentially to generate
the magnetic fields. The peak-to-peak current strength of
each dipole was set to be 50 nAm. Four head position indi-
cator (HPI) coils fixed on the phantom were used to obtain
the position of the phantom with respect to the sensor de-
vice. The reported estimation error of the head position us-
ing HPI is below 0.2 millimeters. After well-positioned, the
phantom was fixed within a session. Then we moved the
phantom 2 millimeters downward to proceed the next ses-
sion. Totally, five sessions of MEG signals were acquired
at five different phantom positions. The first position was 8
millimeters higher than the last one. Within each session,
100 trials of each current dipole were recorded by the MEG
system at a sampling rate of 1000 Hz and then they were av-
eraged according to the activation onset time. The averaged
data were then processed by a bandpass filter (7.5 Hz to 35
Hz) followed by a baseline correction procedure. For each
current dipole, its position was estimated and the distance
between the estimated dipole location and the ground-truth
location of each dipole was calculated. Finally, the aver-
aged distance of all sixteen dipole sources was calculated
as the localization error for each method.
Figure 2 shows the localization errors obtained from
the SLIM, DA, and FC methods. The horizontal axis in
the figure indicates the amount of data sets with different
head poses which were used for source estimation while
the vertical axis indicates the localization error. The dashed
lines with ’◦’, ’’, and ’’ marks indicate the accuracies
of SLIM, FC, and DA methods, respectively. As shown
in Figure 2, the performance of direct averaging decreases
when more than two data sets of different head positions are
used. Although not significant, the accuracy of the SLIM
method is somewhat better than that of the FC method.
The accuracy of both SLIM and FC methods increases pro-
portionally to the square root of the sensor number, which
is equal to the product of 204 and the number of adopted
poses. This finding is consistent with the reports in [5, 6].
3.2 Somatosensory Evoked Fields
In this experiment, somatosensory evoked fields (SEFs) of
three healthy right-handed subjects were measured. Sub-
jects were asked to sit in a comfortable chair with eyes open
in a magnetically shielded room. The right median nerve
of each subject was electrically stimulated every 429 mil-
liseconds with constant pulses (0.3 millisecond duration)
above the motor threshold. Vertical and horizontal elec-
trooculograms (EOG) were recorded to obtain the EOG-
free epoches (which were not contaminated by eye move-
ments and/or blinks.) Four HPI coils, two attached on the
forehead and two behind the ears, were used to locate sub-
jects’ heads with respect to sensor array before data record-
ing in each session.
We collected two categories of data sets. The first
category contained five sessions, each consisted of about
2 3 4
1
2
3
4
5
6
7
8
Accuracy Comparison for Different Movement Direction
Number of poses for combination
st
an
da
rd
 d
ev
ia
tio
n 
of
 fi
tte
d 
di
po
le
 p
os
itio
ns
 (m
m)
DA −rot
FC−rot
SLIM−rot
DA−down
FC−down
SLIM−down
 1000−trial average
Figure 4. Illustration of the influence of motion directions
on the source localization accuracy. The solid curves are
for rotation and the dashed curves are for downward trans-
lation.
curves are from the second data category (downward move-
ment). In general, for the DA method, rotation movement
induces more blurring effect than downward movement,
whereas signals recorded from rotated head pose get higher
SNR than those recorded from downward translated head
pose. One common phenomenon is that the more data are
used, the higher accuracy can we achieve. Comparing the
DA, FC, and SLIM methods, the results shown in Figure 4
demonstrate that (1) for the DA method, rotation movement
results in less performance than downward movement; (2)
for the FC method, no significant differences were found
between the effects of rotation and downward shifting since
the FC method corrected motion effects but it still adopted
corrected average measurement within its procedure; (3)
for the SLIM method, combining signals recorded from
different rotated poses significantly increased the localiza-
tion stability than downward movement did since rotation
movement can be viewed as a means of ”increasing sen-
sor number”. Thus, we concluded that the experimenter
should perform ”rotation” for each session in order to in-
crease sensor number significantly in the MEG experiment
while maintaining similar high SNR.
3.2.3 Evaluation of Fatigue Effect
The benefit of enhancing SNR by averaging more epoches
would be hindered due to fatigue effect when the subject
performs repetitive task/stimulus without taking a rest. Fig-
ure 5 illustrates the fatigue effect along with the experi-
mental time for electric sensory stimulation. The SEF data
set (1000 trials) recorded at a fixed head pose was parti-
tioned into five non-overlapping segments followed by sub-
averaging for each segment. The accuracy of each 200-trial
average was evaluated by means of the DA approach indi-
vidually. This figure shows that the accuracy of the record-
1 2 3 4 5
3
3.2
3.4
3.6
3.8
4
4.2
4.4
4.6
4.8
Fatigue Influence
Index of data sets
st
an
da
rd
 d
ev
ia
tio
n 
of
 fi
tte
d 
di
po
le
 lo
ca
tio
ns
 (m
m)
Figure 5. Illustration of the influence of fatigue effect on
the source localization accuracy.
ings in the last duration (4.62mm) was much worse than
that in the first duration (3.18mm). Such result suggests
that a shorter experimental time is necessary for more ac-
curate source localization.
4 Conclusions
In this work, we proposed a stabilized linear model which
can solve the head movement problem by conceptually in-
creasing the sensor number once the head movement is
known. This method can particularly benefit studies in-
volving patients or children and studies with long experi-
mental duration, in which head movement or fatigue effect
is common or inevitable. Phantom studies and studies of
somatosensory evoked field clearly show the effectiveness
and accuracy of the proposed method.
Acknowledgements
This work was supported in part by National Science Coun-
cil, Taiwan, under Grants NSC94-2213-E-010-003 and
NSC95-2752-B-010-007-PAE.
References
[1] M. Hamalainen, R. H. Risto, J. Ilmoniemi, J. Knuu-
tila, and O. V. Lounasmaa, “Magnetoencephalogra-
phy - theory, instrumentation, and applications to
noninvasive studies of the working humans brain,”
Reviews of Modern Physics, vol. 65, no. 2, pp. 413–
197, 1993.
[2] J. C. Mosher, R. M. Leahy, and P. S. Lewis, “EEG and
MEG: Forward solutions for inverse methods,” IEEE
Transactions on Biomedical Engineering, vol. 46,
no. 3, pp. 245–259, 1999.
