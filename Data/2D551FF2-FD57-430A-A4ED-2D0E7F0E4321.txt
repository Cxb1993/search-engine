 行政院國家科學委員會補助專題研究計畫 ▉ 成 果 報 告   □期中進度報告 
 
 
安全且可信賴的企業數位版權管理系統之研究(第 2年) 
 
計畫類別：■個別型計畫   □整合型計畫 
計畫編號：NSC 98－2218－E－036－003－MY2 
執行期間：   99 年 08 月 01 日至  100 年 07 月 31 日 
 
執行機構及系所：大同大學資訊工程系 
 
計畫主持人：黃國軒 
共同主持人： 
計畫參與人員：李卓蓉、李昆憲、彭宇弘 
 
 
 
成果報告類型(依經費核定清單規定繳交)：□精簡報告  ■完整報告 
 
本計畫除繳交成果報告外，另須繳交以下出國心得報告： 
□赴國外出差或研習心得報告 
□赴大陸地區出差或研習心得報告 
■出席國際學術會議心得報告 
□國際合作研究計畫國外研究報告 
 
 
處理方式：除列管計畫及下列情形者外，得立即公開查詢 
            □涉及專利或其他智慧財產權，□一年□二年後可公開查詢 
 
中   華   民   國    100 年   10 月   31 日 
 
  II
中  文  摘  要 
 
對於企業導向的數位版權管理(DRM)需求，一般 DRM 系統的數位內容存取控
制機制已經不太適合使用，所以發展了許多企業數位版權管理(EDRM)系統來針對
企業的需求，使企業的數位內容也就是數位文件不只能夠規範只有合法使用者能夠
取得以及使用數位內容，並且能夠記錄使用過數位內容的使用者，更進一步能夠讓
各個合法使用者共同編輯或修改數位內容，甚至是跨部門的共同分享編輯使用。本
計畫採用智慧卡的機制來設計我們的 EDRM 系統，使得 EDRM 系統能夠更靈活、
更方便的運用在企業模式下。 
此外，隨著智慧型手機規格與其作業系統版本推陳出新，處理器核心時脈也越
來越快，帶動其應用軟體的發展與進步，而另一方面平板電腦則因為應用技術的突
破以及價格相較於過去較為低廉，綜觀這些因素，行動裝置的使用普及率越來越
高、技術發展更加成熟，因此本計畫亦提出了一個基於行動裝置的階層式 EDRM
系統，讓使用者可以隨時隨地透過使用行動裝置來瀏覽及使用企業內部的文件。 
 
 
關鍵字：數位版權管理系統、企業數位版權管理系統、智慧卡、行動裝置 
  1
第一章 
導論 
1.1  研究背景與動機 
由於數位化產品與網際網路的普及，以往需取得實體的產品，如今能夠在網路
上被輕易地取得，因此數位版權管理就成為了近年來熱門的議題，數位版權管理系
統是透過加密數位內容與合法授權來防止非善意使用者的非法使用與複製的系
統，除了使用次數與複製的權利限制之外，最近更有人投入發展各種使用情境，如：
由 Conrado 等人[1]於 2003 年首先提出的以 Smart Card 為基礎的數位版權管理系
統，以及後續又有人提出改進並應用在電子商務的情境上[2, 3]、數位內容加入電子
商務買賣的行為之後衍伸出權利轉售的問題，因此有了權利轉移的研究[4-6]與內建
驗證模組，故不需透過線上驗證的支援離線使用之 DRM 系統[7]。有別於像
WMRM[8]對於音樂、影片等數位內容的保護，企業文件雖然沒有商業販售的行為，
但內容往往是企業重要的資產，如專案計畫書、合約書、客戶名單等資料。有鑑於
此，於是有了企業數位版權管理系統的產生。相較於 DRM 技術發展越趨成熟之際，
EDRM 的領域相關的系統也有眾家廠商紛紛投入開發，如：Microsoft 的 WRMS[9]、
Adobe 的 Live Cycle[10]、Authentica 的 Active Rights Management(ARM)[11]以及
Intertrust 公司所推出的產品[12]等，但一方面受到系統平台與軟體相容性的限制，
另一方面則視需求不同，許多軟體廠商各自開發屬於自己的 EDRM 系統，太過老
舊的系統不支援跨平台；支援行動裝置的系統，則因為需求需要大量的安全運算；
又例如像：Chen[13]與 Chang 等人[14]所提出的行動式企業數位版權管理系統，雖
然經過 Chang 等人改善 Chen 在一次性秘密金鑰的保管與更新部分存在的安全性疑
  3
行動裝置與 EDRM 系統結合，並利用企業部門位階其階層式的特性，設計一個安
全及可靠的基於行動裝置階層式的 EDRM 系統。 
  5
 
圖 2-1 企業數位版權管理系統架構[17] 
 
從圖 2-1 可以了解 EDRM 系統與傳統 DRM 系統架構大致相同，在系統角色部分一
樣使用 license 管理權利 Right 與加密數位內容的內容金鑰(Content Key, CK)，並透
過認證中心身分的驗證與企業文件使用規範的審核來產生相對應的 license 給使用
者。而在 Client 端則是透過扮演 DRM Controller 的代理人程式(DRM Agent)來存取
受保護的內容，依照上述 EDRM 的架構來設計本研究的系統。以下將介紹在設計
新的 EDRM 系統時必須了解需要哪些安全性需求以及版權描述語言的設計及需要
存放哪些內容等，如此才能設計更安全與實際情境的 EDRM 系統。 
  7
文件，應該記錄 ip 資訊，當作日後追蹤的攻擊者的參考依據。 
4. 使用權利的轉移及針對存取規定做修改：對於數位內容的使用權利，公司應不
只具備將其權利移轉的能力也必須要能夠針對存取權限修改，如：部門調動或
企業間的合作關係而需要暫時開放使用權利給其他部門或其他公司的員工，而
權利也必須要能修改，因為在公司的現實情況中，權利可能會因為使用人的不
同而有所不同。此外，也有可能因為公司的策略或規範的變更而改變權利的設
定。因此 EDRM 系統若能允許後續權利依據規範的變更做更改，將能更符合
實際使用的情境。 
5. 身份驗證及人員管控：員工身分驗證與管控是企業非常重要的一環，在 EDRM
中也是如此，不管是員工離職、調職、升遷、甚至是與合作廠商的合作關係與
控管以及驗證是否為合法員工及數位內容的驗證，都是 EDRM 系統必備的功能
與機制，如此才能保證企業的數位內容資產只能被合法的員工所存取。因此本
研究所提的方法也將會以這幾項安全需求做為主要考量，設計出一個適合在企
業環境運用的數位版權管理系統。 
 
2.1.3 版權描述語言 
    無論是 DRM 系統或是 EDRM 系統，在使用過程中會藉由 license 的中的使用
權利與金鑰去使用受保護的文件，而 license 的權利與其文件資訊的描述等組成稱之
為版權描述語言，版權描述語言是一種以格式為.xml 的可擴充標示語言（Extensible 
Markup Language, XML），其文件儲存的內容可以由系統開發者自訂或是使用目前
主流的版權描述語言 XrML[18]或 ODRL[19]來開發。 
    XrML 的前身為數位財產權利語言(Digital Property Rights Language, DPRL)，是
  9
- 個人數位助理(Personal Digital Assistant, PDA)的出現，行動裝置有了重大的突破與
轉變，即作業系統的競爭。以一般手持行動裝置的系統中 Nokia 的 Symbian、RIM
（Research In Motion）的 BlackBerry、微軟的 Windows Mobile、Apple iPhone 的 iOS
以及 Google 的 Android 系統等，行動裝置的競爭越來越激烈，不只是系統的多元性，
其穩定性也是廠商競爭的焦點。除了撥號與發訊息外，加上網路以及一些廠商開發
的應用程式，讓原本只能在電腦上的應用可以透過手機達成，更甚至在一般電子商
務需求的應用也因為智慧型手機的發展而強大。顯然地，行動裝置的改變與發展已
經間接改變了人們的生活及使用習慣。以圖 2-2 為 Google 推出之搭載 Android 系統
的智慧型手機，其中的 CPU 時脈高達 1Ghz，各種商務的應用跟運算處理能力已經
能夠快速與平穩地運作。 
 
圖 2-2 搭載 Android 系統的新一代智慧型手機 Google Phone – Nexus S[20] 
 
2.2.2Android 系統 
Android 系統一開始是由 Google 與三十四間手機製造商、軟體開發與電信業
者所組成的開放手機聯盟(Open Handset Alliance, OHA)[21]所提出，Android 是一種
以 Linux 為基礎之開放原始碼(Open Source)的作業系統，除了開放原始碼的優點
  11
(Libraries)、Android 執行環境以及 Linux 核心層。其中，應用程式層提供 Android
主要應用程式包含通話功能以及瀏覽功能；應用程式結構層則提供應用程式使用到
的介面與功能做定義，讓後續開發的應用程式能可呼叫或重新定義與元件再利用；
函式庫層包含了一些開發 Android 應用程式會使用到的函式庫其中包含了 Android 
執行環境的 DVM 與核心所需的函式庫等等；最後 Linux 核心層主要包含一些在
Linux 系統中會使用到手機周邊裝置的驅動(Drivers)。一般來說在開發 Android 系統
的應用程式，因為本研究只需要規劃與設計軟體的介面以及功能，所以只需要關注
應用程式結構層、函式庫層與 Android 執行環境，Linux 核心層則是手機廠商針對
產品開發中其裝置的驅動程式與實行系統介面客製化時需要關注的領域。 
 
2.3 密碼學技術 
在 EDRM 系統中，除了在文件保護上會使用密碼學的加解密技術外，在系統
中各角色間的訊息傳送過程與在 license 的傳送過程中也會為了避免遭到攻擊者竊
取有用的資訊做不法之用，也會運用到密碼學的相關技術，如：非對稱金鑰與數位
簽章等，並且也透過密碼學的技術，在訊息傳送過程中避免內容遭到攻擊者竄改偽
造，讓接收者接收到的訊息是有用的而非擾亂的資訊。以下將介紹所提的方法中會
運用到的密碼學技術，如：對稱式密碼系統、非對稱式密碼系統以及數位簽章等等，
並一一說明各技術其相關原理。 
2.3.1 對稱式密碼系統[23, 24] 
對稱式密碼系統的主要特色就是加密及解密內容是使用同一把金鑰，所以內容
的接收者只需知道金鑰與得知使用何種加密演算法來解密受加密的內容，也因此對
稱式密碼系統的運算速度與成本相對非對稱式密碼系統低很多。因為運算成本低，
  13
2.3.3 數位簽章 [28, 29] 
數位簽章是基於非對稱式密碼系統的一種應用，其主要的目的在於確保傳送訊
息來源的完整性以及不可否認性，使用數位簽章需要憑證中心 Certificate Authority, 
CA)即第三方的公正機構或是企業內部架設憑證伺服器 AA 才能實行，且每個系統
內的角色皆需向 CA 申請一組公開金鑰與相對應的私密金鑰。 
有別於非對稱式密碼系統使用公開金鑰加密受保護的內容，在使用數位簽章時
是使用該角色的私密金鑰加密作簽章的動作。除了加密者本身，系統內的其他角色
只能透過 CA 知道該角色的公開金鑰，因此只能使用該公開金鑰去驗證該是否為該
合法使用者所傳送之訊息。 
綜觀上述加密技術，使用表 2-1 來表示這三種技術的優缺點及使用的時機。 
 
表 2-1 加密技術的比較表 
      加密技術 
 
功能比較 
對稱式密碼系統 非對稱式密碼系統 數位簽章 
主要功能 保護內容 保護內容 驗證完整性 
加密對象 檔案、文件 訊息或金鑰 訊息 
運算成本 低 高 高 
使用的密碼系統 AES [30]、DES [31]
和 Triple DES [32] 
E1Gmal [33]、RSA  DSA [34] 、RSA、
E1Gmal 
 
  15
訊增加了洩漏數位內容的風險和計算成本，所以本計畫希望能夠改善相關研究可能
出現的缺陷，讓我們的 EDRM 系統能更適合在公司環境下所使用。 
3.2  角色介紹 
在我們的機制中，我們將利用 Smart Card 來幫助我們驗證提出要求得使用者身
分是否合法，只有合法使用者才能獲取資料。由於 Smart Card 本身具有運算處理的
功能，所以在傳送檔案的過程中，我們可以利用公開金鑰以及私密金鑰來協助我們
達到確保檔案的安全性以及完整性，並且利用 Smart Card 中的受保護記憶體區塊來
儲存我們的一些重要資訊，以確保不會讓惡意攻擊者取得機密資訊。參與角色方面
我們設定了四個角色，分別為文件伺服器、授權伺服器、部門主管以及員工；其各
負責的項目為文件伺服器負責儲存文件以及註冊功能，授權伺服器負責發送和儲存
授權，部門主管負責產生空的文件檔案以及相對應的金鑰和授權，員工則為編輯這
些文件檔案的使用者。而各個角色的詳細介紹如下： 
 文件伺服器( File Server，FS) ： 
文件伺服器主要的功能有(1)公司內所有的加密文件資料都會被存放於此。(2)新進
職員需向文件伺服器做註冊以及申請卡片的動作。(3)認證要求檔案的公司員工或主
管。(4)當員工離職後，文件伺服器會將這些離開公司員工的 Smart Card 編號加入移除
名單內，以防止離職員工還可以向前公司取得資源。(5)文件伺服器負責產生公司的 seed
以及和各部門主管協議產生秘密資訊 B。 
 授權伺服器(License Server，LS) ：  
一個專門存放文件檔案授權的伺服器，在我們的設計中每個部門將擁有一部專屬於
該部門文件的授權伺服器，並且由部門主管管理。主管將產生好的文件檔案授權利用
授權伺服器的公開金鑰加密後傳到伺服器做儲存，之後需要使用文件檔案的員工，經
  17
表 3-1 所提 EDRM 系統符號定義表 
符號 定義 
file 文件檔案 
f_id 文件編號 
M_id 部門主管識別碼 
E_id 員工識別碼 
Usage_Rights 文件檔案使用權限 
A 各部門主管所產生的隨機值 
B 各部門的秘密資訊，依照各部門而有所
不同 
C 認證資訊，用來確認是否經過該部門主
管認可的依據 
license 文件檔案的授權 
sk 文件檔案加密金鑰 
seed 儲存於該公司專屬 smart card 的數值 
revocation list 移除名單 
Esk(.) 使用金鑰 sk 的對稱式金鑰加密演算法 
PKU(.) 使用角色 U 的公開金鑰進行加密，採用
非對稱式金鑰加密演算法 
SignU(.) 使用角色 U 的私密金鑰進行數位簽章，
採用非對稱式金鑰加密演算法 
  XOR 運算符號 
 
3.3 所提機制 
主要的運作流程如下： 
1. 新進職員必須先完成註冊的動作獲得一張 smart card（員工卡或主管卡）。 
2. 想要編輯文件檔案的員工，先向文件伺服器取得部門主管已經建立好的加密文
件檔案，在此過程中，文件伺服器將依照註冊階段所發給員工卡片內的秘密資
訊 B，來分辨要求的檔案是否屬於該員工部門，接著將加密的文件檔案傳送給
員工。 
3. 員工取得加密的文件檔案後，向授權伺服器去取得文件檔案的相對應授權，在
  19
步驟 2：通過 PIN 碼啟動卡片後，建立完成一個空的文件檔案 file 以及該文件檔案
的使用權限 Usage_Rights，並給定一個文件編號 f_id。 
步驟 3：透過 Smart Card 產生一個隨機值 A，並利用 Smart Card 中的 seed 計算文件
檔案加密用的金鑰 sk，其中 sk = seed♁A。 
步驟 4：再透過 Smart Card 對 file 進行加密，產生加密後的文件檔案 Esk( file )，並
對 Esk ( file )進行簽章產生 SignM ( Esk ( file ) )。 
步驟 5：接著將 Esk ( file )、SignM ( Esk ( file ) )和 PKFS ( B )傳送至文件伺服器。文件
伺服器收到資料後，用自己的私密金鑰解密 PKFS ( B )取得秘密資訊 B，透
過秘密資訊 B 確認該使用者是否為公司的部門主管，接著利用該主管的公
開金鑰來驗證 SignM ( Esk ( file ) )，若驗證正確，則將 Esk ( file )存放於資料
庫中；否則，拒絕儲存。 
步驟 6：最後將 A 與 f_id 以及 Usage_Rights 製成 license = {A, f_id, Usage_Rights }，
將 license 進行簽章再利用授權伺服器的公開金鑰加密，得到 M1傳送給授
權伺服器，其中 M1 = PKLS ( SignM { license }, license )。接著授權伺服器利
用自己的私密金鑰解開 M1 ，再利用該主管的公開金鑰來驗證
SignM{ license }，若正確，則將 license 存放於資料庫；反之則拒絕服務。 
  21
list，若存在該 list 中則拒絕服務。 
步驟 3：職員通過驗證後，文件伺服器將相對應的文件檔案 Esk ( file )傳送給職員，
並記錄職員要求，以備查核用。 
步驟 4：取得檔案的職員接著傳送文件編號 f_id 以及 E_id（或 M_id）和 PKLS ( B )
向該文件檔案的授權伺服器要求 license。  
步驟 5：授權伺服器搜尋到相對應的 license，再利用該職員的公開金鑰加密後，將
PKE ( license )傳送給職員。 
步驟 6：職員透過所屬的 smart card 利用私密金鑰將 PKE ( license )進行解密，從
license 內取得 A，然後與卡片內的 seed 計算出文件檔案金鑰 sk=seed♁A，
接著再利用 sk 解開加密的文件檔案 Esk ( file )，得以對文件檔案 file 執行權
限內的使用。 
步驟 7：不論是員工或是部門主管，修改完文件檔案後，都必須透過卡片將文件檔
案再次以相同金鑰加密，並回傳到文件伺服器做儲存的動作。
  23
器要求文件檔案 file 時，由於該文件並不隸屬於部門B，因此文件伺服器
進行驗證時會發現秘密資訊B跟要求檔案的資格不符。所以部門B的職員
必須傳送文件編號 f_id 以及一個存取要求給部門 B 的主管。 
步驟 2：部門 B 的主管收到存取要求 request 並且認同授權後，先產生一個認證資訊
C，接著計算 ) )  ((2 C, T _id,E_id,request, f Sign=PKM ME  傳回給部門B的職員。另
外，計算 }{  ssage_RightA, f_id, Ulicense'=  ，並將 PKLS( idE _ , license' , C)傳給部
門 B 的授權伺服器，等待職員申請。最後，再計算 PKFS ( idE _ , f_id, C, T )
給文件伺服器，作為識別允許部門B的驗證資訊。 
步驟 3：職員收到 M2 後，利用自己的私密金鑰進行解密，再傳送 M3 = PKFS( SignM 
( request, f_id, idE _ , C , T ), request, f_id, idE _  )給文件伺服器要求文
件檔案。 
步驟 4：文件伺服器收到 M3 後，利用自己的私密金鑰解開加密的內容，並核對 Smart 
Card 的職員編號是否存在於 revocation list 中，接著檢查是否有認證資訊
C，並核對是否正確，再驗證其簽章值真偽，若符合，將相對應的 Esk ( file )
傳送給職員，並記錄職員要求。 
步驟 5：職員接著傳送 M4 = PKLS( SignM ( request, f_id, idE _ , C, T ), request, f_id, 
idE _  )給部門 B 的授權伺服器要求相對應 license' 。 
步驟 6：授權伺服器利用自己私密金鑰將 M4 解密取得資訊後，驗證其簽章值真偽以
及對照 idE _ 是否為合法的職員識別碼。若通過，將 license' 利用職員的公開
金鑰加密後 PKE ( license' )傳送給職員。 
步驟 7：職員利用自己的私密金鑰解密 PKE ( license' )後，從 license' 取得隨機值 A，
透過 Smart Card 計算出 sk = seed♁A，再利用 sk 解密 Esk ( file )取得 file。 
  25
沒有交還都必須將該卡片的編號加入，之後每當有職員要求檔案或認證時，都會先
掃描此 revocation list，是否有該卡片的編號，若沒有才繼續之後的動作，否則將停
止服務。 
 
3.4 安全性分析 
在上一節中，介紹了我們所提出的方法，此節中將證明所提方法如何達到一些
安全需求。在一個 EDRM 系統中需具備的安全需求包含：金鑰保護、文件檔案的
保護以及防止惡意攻擊者侵害，以下將針對這三個部份一一討論。 
 金鑰保護： 
在這個安全需求中，首先討論我們產生金鑰的過程，在部門主管產生文件檔案
時，會先利用主管卡產生一個隨機值 A 並且計算 Aseedsk  ，此把 sk 是真正用
來進行文件加密的金鑰。在傳送資料的過程中，並不會直接將 sk 透過網路來傳送，
而只是傳送產生 sk 的部分資訊 A，若想要產生 sk 必須利用合法 Smart Card 內的 seed
進行運算，而這些可以算出金鑰的隨機值會被記錄在授權伺服器上，其他部門或不
相關的人士想要回復這把 sk，也必須透過該部門主管的認可授權後，才有機會拿
到。另外，seed 是直接被存放於公司部門主管或者員工的 Smart Card 中，那些不是
公司的人更不可能計算出金鑰。根據 Smart Card 本身的特性，我們可以知道將 seed
存放在 Smart Card 中是非常安全的。根據文件檔案加密金鑰沒有在通訊過程中被傳
送以及部門主管和員工的 seed 是直接被存放在卡片中的情況下，非法使用者想要非
法獲取這把金鑰是不可能的，因此在金鑰保護安全需求上我們的機制確實有達到金
鑰保護的目的。 
 文件檔案的保護： 
  27
license 裡面含有金鑰產生資訊，B 為部門間跟文件伺服器、授權伺服器的共享秘密
資訊，而 C 則是跨部門存取文件的認證依據，B 和 C 都是用來判斷要求的員工是否
有該部門文件的使用權，所以都屬於較重要的機密性資訊，所以必須確保只有合法
的對方可以取得資訊。而真正可以解密的合法員工則必須持有相對應的 Smart 
Card，利用卡片中的 B 或者 C 向授權伺服器要求相對應的 license，取得計算金鑰的
相關資訊後，才能解開加密的文件檔案進行使用。 
2. 內部攻擊： 
這類攻擊屬於離職員工或者想非法取得非自己部門的文件檔案。不管是離職員
工還是現職員工，在我們的設計下都必須要有合法身份的使用者才能編輯使用所屬
的文件檔案。以離職員工來說，假設離職員工謊報 Smart Card 不見而故意不歸還給
公司，接著想利用這張 Smart Card 來取得公司的文件檔案，這是行不通的，因為在
員工離職後，公司會將這些離職的 Smart Card 編號加入移除名單內，當離職員工向
文件伺服器提出要求的時候，會被檢查 Smart Card 編號是否存在於 revocation list
中，所以我們的機制能有效防範這些不肖離職員工。而對於後種攻擊者，在我們的
設計中，我們在一開始註冊的時候，有將員工所屬部門的秘密資訊放入 Smart Card
內，所以已經將員工的存取權限做了一個部門的限制，所以該部門的員工只能獲取
自己部門的資料，想要要求其他部門的資料則必須經過其他部門主管的授權後，才
能拿取其他部門的文件檔案，在此我們是利用認證資訊 C 來達到開放不同部門授
權，並且僅限於某個文件檔案而不是整個部門的文件都授權，這點也是有別於其他
研究的地方。 
3. 重送攻擊： 
在公司中雖然網路大部分都為對內網路，對外網路的使用比較少，但為了確保
  29
效的。 
對於 EDRM 所必須滿足的條件，在這部分我們也一一滿足： 
 堅固的保護( Persistent Protection )：在我們機制中，我們對於傳送重要檔案或
資訊時，都必須透過加密金鑰或者公開金鑰做加密保護後才傳送出去。而這些
解密金鑰則都必須透過我們的機制認證後才能取得，所以使用者的存取將受到
我們機制的控制。 
 引用( Excerpting )：在此部分，由於我們考慮到公司所接受的案子可能是複合
性的，單靠單一部門可能無法完成，所以我們透過一個其他部門使用階段的機
制來達成。各部門員工可以透過暫時的秘密資訊得到跟其他部門合作的文件檔
案，經由各部門人員合作將一個案子完成，但卻不會去影響到原本各部門的存
取權限的侵害。 
 權限轉移( Transfer of Rights )：在這一點我們以離職員工為例，在我們的機制
中，已經被開除的員工，文件伺服器會將其卡片編號做一個加入移除名單的動
作，當擁有重要資訊的角色，在每次接受存取要求時，皆可以透過查詢名單來
確認是否對象為已經離職的員工，而加以拒絕。 
 DRM 追蹤使用( Track Usage of DRM Works )：每當員工向文件伺服器要求檔
案成功時，伺服器則會將要求存取的使用者的卡片編碼製作成一個紀錄表，所
以每份文件檔案在何時何地被誰使用過都有被記錄下來。 
 簡單的身份辨認( Easy Identification )：在此我們除了透過給每位員工一張唯一
識別碼的 Smart Card 來做身分識別以外，在員工傳送重要資訊時，我們也將其
資訊透過簽章值來確認過程中傳送資料的對象身分。 
 允許對發佈之後的使用權限及存取規定做修改( Allow for Changes to Access 
  31
計算出金鑰，所以攻擊者想獲得文件檔案的解密金鑰則更加艱困。在角色數量的設
定方面，相較於其他機制則無太大的差異，只是我們的數量不希望太過複雜而使得
擁有權限的角色過多，所以採取一個較平均的數量四個。接著是可取得檔案的角色
部分，在我們的機制中，員工取得檔案時，檔案是被直接放入 Smart Card 運作，而
編輯完要儲存時，則是再透過 Smart Card 加密後，經由網路再回傳到文件伺服器做
儲存的動作，所以在我們所設計的機制中，只有文件伺服器能夠取得原始檔案，其
他角色只能做即時的編輯或修改，相較於其他機制能夠讓除了文件伺服器的其他角
色來儲存檔案，這樣的風險會更少一些。 
表 3-2 相關 EDRM 系統比較表 
EDRM 
系統 
系統 
架構 
參與 
角色 
可取得 
檔案角色
金鑰 
產生方式 
金鑰 
保管方式 
DOFS [41] 
Device- 
based 
CP, User, 
CS 
CP, CS Random CS 保管 
Microsoft 
RMS [9] 
Semi- 
Smart 
Card- 
based 
CP, User, 
CS 
CP, User, 
CS 
Random CS 保管 
Authentica  
ARM [11] 
Device- 
based 
CP, User, 
CS, LS 
CP, User, 
CS 
Random CS 保管 
Chen 的方法 
[42] 
Device- 
based 
CP, User, 
AA, CS, 
LS, PS 
CP, User, 
CS, PS 
Random CS 保管 
Lin 等人的方
法 [15] 
Device- 
based 
CP , 
User, CS, 
LS, MS 
User, CS, 
LS, MS 
Random CS 保管 
Chang 等人的
方法 [14] 
Device- 
based 
CP, User, 
AA, CS, 
LS, PS 
CP, User, 
CS, PS 
Random CS 保管 
所提方法 
Smart 
card 
-based 
CP, User, 
FS, LS 
FS 
Seed ♁
Random 
FS 一半 
LS 一半 
  33
第四章 
以行動裝置為基礎的階層式 EDRM 系統 
4.1  簡介 
相較於一般常見的 DRM 系統，EDRM 系統則較少被研究並實作，以目前市面
上的 EDRM 系統來看都有作業系統的限制，或是跟特定軟體結合的特性。而在現
今的 EDRM 系統中，除了像 DRM 一樣權利轉移以及離線使用保護之外，近年來也
有人紛紛針提出各種的 EDRM 系統，讓其應用能更符合企業中的使用情境。而 DRM
系統又分為以裝置為基礎以及以 Smart Card 為基礎，在裝置為基礎方面的特性為限
制只能在特定的裝置使用；而 Smart Card 為基礎方面的特性在於可攜性，可以不用
受到裝置的限制，即在公司以外的地方使用。而本計畫提出以行動裝置為基礎的
EDRM 系統，一來有使用裝置的限制，但是又能結合行動裝置本身可攜的特性，即
結合上述兩種系統的優點來設計，同時兼顧了安全與方便的需求。以下將針對所提
方法的相關文獻作探討。 
 
4.2 相關以手持裝置為基礎的 EDRM 系統 
 2008 年 Chen 的方法：此篇論文中作者提出一個以行動裝置為基礎的企業數位
版權管理系統，顧客的手機可以透過國際行動設備辨識碼(International Mobile 
Equipment Identity, IMEI)的唯一性與互斥及 Hash[35]低運算量的特性，設計出
一套行動企業 DRM 系統，其中結合了公正性單位 (Authorization Authority, AA)
與一次性密鑰的機制來防止攻擊者的攻擊。 
在圖 4-1 的系統流程圖中必須透過封裝伺服器包裝內容，並將之上傳到內容伺
  35
這將會耗費大量的運算成本。 
因此本篇主要為改善 Chen 的方法，主要架構依舊且一樣使用一次性密鑰來防止攻
擊者竊聽。 
 
4.3 相關以階層式架構為基礎的 EDRM 系統 
 2009 年 Lin 等人的方法：在本篇論文中，作者探討企業數位版權管理系統未來
的趨勢-導入階層式的概念，即一個使用者在部門中的工作位階(Level)可以繼承
自較高位階使用者所制定的數位內容，而使用者只能同時擁有一張憑證，但是
可同時擁有不同的權利數個。 
在此 EDRM 系統中包含的角色有：數位版權伺服器(Digital Rights Server, 
DRS)、數位內容伺服器(Digital Content Server, DCS)、安裝在 Client 端的監控軟
體(Monitor Software, MS)與 User 本身，因為是 EDRM 系統的緣故，故未考慮
消費或是權利轉移的功能。 
系統中分為 Uploading Phase、Download Phase、Usage Phase 三個階段。 
Uploading Phase： 
1. 首先企業使用者或部門主管先上傳一數位內容與制定的權利至 DRS 
2. 傳至 DRS 的數位內容與權利會給他們一組系統的 ID 替換原始的 Sno，存放部分
使用者認證的資料後再將數位內容傳至 DCS。 
3. DCS 使用 KCid 做加密並存放在系統資料庫中。 
Download Phase：下載階段則透過 DRS 來控管，同時 DRS 也扮演了驗證使用者的
角色： 
1. 首先使用者提出要求並傳送其憑證證明使用者的合法性，DRS 驗證其部門、位
  37
的 Temporary 資料庫。 
5. 在使用時 MS 會再一次確認使用者的權限，假如正確 MS 將使用第四步驟取得
的 KCid 解開加密的檔案 ECid = EKCid(ContentCid)。 
已知缺點： 
(1)在使用者下載階段提出要求之後認可其使用合法性，但是 DRS 回傳檔案清單，
又需要在驗證一次使用者的傳送，如果建立 SSL 連線，只要確保連線持續建立狀
態，可以省略多餘的驗證過程。 
(2)在此系統的使用階段中使用 MSid 來做驗證，以 EDRM 系統來考量可以達到更安
全的防護效果，但是也會造成無法在其他裝置上使用，即 MSid 是唯一，若以非裝置
為基礎的 DRM 系統則無法應用在其上。 
    以上為各篇方法的流程以及相關階段步驟介紹，並且探討其優缺點，在設計本
研究的方法時，將把這些優點保留，並針對其缺點加以改進。在 4.4 節中將簡述系
統角色與相關概念定義，4.5 節為所提 EDRM 系統描述，4.6 節針對所提出方法進
行安全性分析，第 4.7 為效能分析與討論。 
 
4.4 概念定義 
本計畫提出一個具階層式架構的 EDRM 系統，除了使用部門與位階來區分使
用者的身份之外，同時透過 Right 中的權利使用的次數限制來控管使用者的使用，
在所提系統中包含五個角色：內容提供者、行動使用者、內容伺服器、授權伺服器
以及認證中心。五個角色的介紹如下： 
內容提供者( Content Provider, CP )：此指企業內部的員工，負責產生檔案以及賦予
使用的權利。 
  39
表 4-2 所提 EDRM 系統的符號定義表(續) 
符號 描述 
license 文件的使用授權 
Right 由內容提供者制定並上傳的權利 
TP_Right LS 依據 Right 與 MU 產生相對應的權利 
RK 由 CP 產生用來加密數位內容的金鑰 
CK 由 CS 產生用來加密數位內容的金鑰 
T 憑證截止日期 
IMEI 國際行動設備辨識碼 
Content_list 文件列表 
Revocation_list 憑證廢止清單 
Exception_list 使用在非企業員工權利制定上並儲存在 LS 中的例外清單 
ECK( . ) 使用內容金鑰 CK 的對稱式金鑰加密演算法 
PKU( . ) 
使用角色 U 的公開金鑰進行加密，採用非對稱式金鑰加密演
算法 
SU( . ) 
使用角色 U 的私 金鑰進行數位簽章，採用非對稱式金鑰加
密演算法 
|| 連接運算 
 
4.4.2 憑證資訊與使用權利定義 
在企業架構中除了包含不同的部門組織之外，職務階級的高低也是實現階層式企
業架構的重點，以下為系統中在部門與階層架構的關係示意圖： 
  41
Write”；P 為列印”Print”，每個存取類型會有使用次數的限制 i、j；前者 i 為同
部門的成員對於某項存取類型的使用次數，後者 j 為不同部門成員的使用次
數。此外，-1 表示沒有次數限制。 
    當 MU 向 LS 要求 license 時，LS 根據 CP 制定的 Right 檢查與 MU 的 Dep(x)
與 Lv(y)的資訊並將適當的權利寫入 TP_Right 中。其中 TP_Right 是 LS 發佈給
MU 對於文件存取的權利，結構為：TP_Right=(R(k), W(k), P(k))。若 CP 指定的
使用權利為：Right=(R(10,5), W(10,5), P(10,5))，則非同部門的員工所對應的使
用權利經由權利限縮之後可能為：TP_Right=(R(3), W(3), P(3))。 
    由於 TP_Right 是 LS 給 MU 的專屬權利，所以只需要 k 一種數值，其中 k
為 LS 依照 MU 的 Dep(x)、Lv(y)與 CP 提供的 Right=(R(i,j),W(i,j), P(i,j))檢查後
為 MU 設定。為了避免 CP 制定較寬鬆的權利，在 LS 發佈 license 時也會依據
企業文件使用規範產生文件使用權利限縮 MU 的權利。此外，在非公司員工的
license 核發部分應依照企業文件使用規則給予最低的使用權限，以確保文件的
安全。 
 
4.5 所提出的 EDRM 系統 
在所提方法中分為五個階段：註冊階段、文件產生階段、下載階段、文件使用
階段、例外階段。以下將個別描述每個階段的詳細步驟： 
4.5.1 註冊階段 
在註冊階段中，新進員工一開始進入公司填寫基本資料，通過上級主管及人事
部門的審核通過後，將相關人事資料傳給 AA 進行註冊與申請憑證，其步驟如下： 
步驟 1：企業人事部門將使用者資訊：{ u_id , Dep(x) , Lv(y)}傳給 AA，AA 接收訊
  43
步驟 1：企業員工產生文件 content 以及文件資訊 c_info，並選擇 RK 用來加密 c_info
與 content，接著計算 PKCS(RK)。最後將{ u_id, CertU, PKCS(RK), ERK( c_info 
|| content ) }傳送給 AA。 
步驟 2：AA 驗證其 CertU的合法性，若驗證成功將{ u_id, PKCS(RK), ERK( c_info || 
content ) }轉送給 CS，否則拒絕存取。 
步驟 3：CS 接收自使用者上傳的文件後，解密 PKCS(RK)，使用 RK 解密受加密的
內容並賦予文件一組序號 c_id，並產生秘密金鑰CK加密 content，並將{ c_id, 
c_info, u_id, ECK( content )}存入資料庫中。 
步驟 4：文件加密完成後，CS 將訊息{ sucess_msg, c_id }透過 AA 回傳給使用者。 
步驟 5：CS 使用 LS 的公開金鑰加密此段訊息 PKLS( c_id || c_info || CK )後傳給 LS
使用 PKLS(.)加密訊息其用意是保證其訊息只有 LS 能夠解開。 
步驟 6：使用者收到 CS 回傳的 c_id 後則針對 content 制定其相對應的使用權利
Right，並用 LS 的公開金鑰將 Right 加密之後透過 AA 傳給 LS 儲存，其加
密訊息：PKLS( u_id || c_id || Right )。 
步驟 7：LS 會先收到"步驟 5"中 CS 所傳送的訊息 PKLS( c_id || c_info || CK )，先利
用 LS 的私密金鑰其訊息後，再根據 LS 收到使用者在"步驟 6"傳送的權利
訊息：PKLS( u_id || c_id || Right )，根據比對 c_id 確定為同一個文件後將
{ c_id, c_info, u_id, Right, CK }存入資料庫，提供日後產生 license 使用。 
  45
存取的文件列表 Content_list，其中包含文件識別碼、文件名稱、文件內容
摘要等，並將此訊息傳給 AA 再經由 AA 轉送回傳給 MU。 
步驟 3：MU 接收到 Content_list 後選擇欲下載的文件並提出下載文件的要求{ c_id, 
Download_req }給 AA，AA 再將訊息傳送給 CS。 
步驟 4：當 CS 收到 MU 的 Download_req 訊息後，根據 c_id 將對應的文件經由 AA
轉送下載文件的 URL 回傳給 MU。 
 
圖 4-5 下載階段示意圖 
 
4.5.4 文件使用階段 
假設 MU 取得加密的文件，必須透過 MS 方能進行文件的安全存取。MS 在解
密文件時必須檢查行動裝置中是否有其對應的 license，並依據 license 中 TP_Right
  47
 
圖 4-6 文件使用階段示意圖 
 
4.5.5 例外階段 
 假設企業員工離職，並將其所擁有之行動裝置的 IMEI 從 AA 資料庫中移除，
亦需將其憑證 CertU加入 Revocation_list 中。 
 假設企業員工職務調動，需要重新設定 Dep(x)及 Lv(y)，並跟 AA 申請更新後的
憑證。 
 在企業間的合作關係中，在特定情況下因業務需求，若需開放企業文件給合作
廠商讀取，則非企業員工即合作廠商亦需跟 AA 申請憑證，憑證當中的部門
Dep(x)與位階 Lv(y)的 x 與 y 值皆為 0。LS 依據 Dep(0)與 Lv(0)核發對於文件的
最低使用權利 TP_Right 給非企業員工。此外，AA 負責維護 Exception_list，當
  49
者憑證 CertU中的 Dep(x)及 Lv(y)與 CP 產生的 Right=(R(i,j), W(i,j), P(i,j))比對，並參
考企業文件使用規範產生相對應的使用權利 TP_Right。當 MS 取得 license 後，針對
license 中的 TP_Right 行使權利，當存取類型的使用次數因 MU 對於文件的存取而
遞減至 0 時，則停止該存取類型的使用權利。 
 防止惡意攻擊者的侵害： 
    惡意的攻擊者為了取得非法的利益並對企業造成危害，會試著從各個地方取得
資訊。在此，本研究討論三種最常見的攻擊方法： 
(1)竊聽： 
本研究的方法在角色間傳送的訊息包含了產生金鑰的資訊，為了避免被攻擊者
使用竊聽的方法取得資訊，將利用公開金鑰加密機制來防止與保護訊息安全。 
(2)取得企業員工的行動裝置： 
當攻擊者切許企業員工的行動裝置，必須透過輸入個人識別碼 PIN 碼來啟動裝
置，因為攻擊者不知道 PIN 碼，便無法順利啟動行動裝置。假設使用者在裝置遺失
第一時間向公司回報遺失，管理者可以進入 AA 將憑證 CertU廢止並註銷其裝置的
IMEI，使得攻擊者在下載與文件使用階段會因為憑證已廢止以及 IMEI 已註銷，而
被 AA 拒絕存取請求。 
(3)透過竄改 IMEI 的值取得合法性： 
假設攻擊者竄改其持有的行動裝置的 IMEI 碼，來假冒合法使用者，由於在下
載與文件使用階段中不只需要驗證 IMEI 碼，同時需要使用者的 CertU，即使使用者
竄改 IMEI 資訊，非法的裝置也不會有相對應的 CertU，故還是會被拒絕存取服務。 
 
 
  51
表  4-3 相關 DRM 系統比較表 
DRM 系統 Authentication 
參與 
角色 
檔
案 
加
密 
支援 
行 動
裝置 
階層
式 
允 許
例 外
角 色
存取 
未知內容 
金鑰的角色 
Windows 
Rights 
Management 
System[9] 
Active 
Directory 
U,CP, 
AD,CA O X X X CA 
Lin 等人的方
法[15] Certificate 
U,CA 
CS,LS O X O X CP 
Chen 的方法 
[13] 
Certificate&
IMEI 
MU,MS 
AA,PS,L
S,CS,CP
O O X X CP,CS,AA 
Chang 等人的
方法[14] 
Certificate&
IMEI 
MU,AA 
PS,LS, 
CS,CP 
O O X X CP,CS,AA 
所提方法 Certificate&IMEI 
CP,CS, 
LS,AA, 
MU,MS 
O O O O CP, AA,MU 
CP：內容提供者( Content Provider ) 
CS：內容伺服器 ( Content Server ) 
LS：授權伺服器( License Server ) 
AD ： 目 錄 服 務 伺 服 器 ( Active 
Directory ) 
PS：封裝伺服器( Package Server ) 
AA：認證中心( Authorization Authority ) 
MU / U：使用者( Client User ) 
MS：監控軟體( Monitor Software ) 
 
  53
LS 要求 license，最後使用 license 將下載的檔案解密，並依照 license 中相對應的權
利內容行使權利。 
 
圖 5-1 所提方法的系統架構圖 
 
5.3 License 設計 
    在文件使用階段中使用企業文件必須由 MS 開啟文件先讀取文件檔頭得知該文
件的識別碼(Content_ID, c_id)並針對 c_id 向 LS 要求 license，當 LS 回傳 license 給
MS 後，MS 將 license 的內容加密金鑰 CK 以及相對應的權利 Read 與 Write 的資訊
讀入軟體暫存變數中，以下是本研究所提出的方法中所使用的 license 其內容： 
 
 
  55
5.4 系統實作成果 
    在系統實作中依照系統架構圖分為認證中心、內容伺服器、權利伺服器、行動
裝置的 UI 四個部份來進行。 
5.4.1 系統環境 
    在實作過程中，將使用一台伺服器與一台行動裝置來完成。其中伺服器部分主
要包含認證中心、內容伺服器與授權伺服器三個角色，由使用者透過行動裝置上網
完成會員驗證以及檔案上傳，再由網路方式下載企業文件，最後使用自行開發的行
動裝置監控軟體開啟企業文件。 
 伺服器的開發資訊： 
作業系統版本：Windows 7 Professional 校園版 
網頁伺服器：Apache Web Server 2.5.10 
資料庫：MySQL 5.0.51b 
資料庫管理工具：phpMyAmin 2.10.3 
網頁程式語言：PHP 5.2.6 
 行動裝置的開發資訊： 
模擬系統環境：Eclipse Helios 3.6.2 
Java 開發工具版本：jdk-6u24 
作業系統版本：Android 2.2 
模擬器版本：android-sdk_r10 
儲存裝置容量(SD Card)：512MB 
    在系統中產生 license 的授權伺服器與行動裝置監控軟體皆使用 Java 語言開
發，主要取其 Java 跨平台的特性，主要的不同之處在於 JAVA 使用 JVM 來執行程
  57
驗證步驟後會依照管理者與會員的分別進入不同的功能頁面。如果登入身分是管理
者則可以選擇會員新增與會員管理兩種功能。 
 
 
                                                  驗證失敗 
 
 
                                      驗證成功 
 
 
 
 
 
 
 
 
圖 5-4 註冊階段的流程 
 
    從圖 5-5 中系統管理員可以透過此頁面新增企業員工資訊，其中還包含了部門
資訊、位階資訊與 IMEI，如此新增之後系統可以同時複製一份企業員工清單至授
權伺服器，當行動裝置進入文件使用階段向授權伺服器要求 license 時，這些資訊可
以當作核發 license 的參考依據。 
登入系統 
驗證 
功能選擇
會員新增 會員管理 
結束 
  59
來新增會員，但是管理者只能透過 phpMyAdmin 或 MySQL 來新增，以減少頁面上
安全管理之疑慮。 
 
圖 5-7 新增會員查詢結果 
5.4.3 文件產生階段 
    在圖 5-8 中文件產生階段的流程，並透過會員管理系統驗後為合法企業員工後
方可進行上傳。文件上傳成功之後接著進入設定權利的程序，設定權利成功後即完
成文件產生階段的流程。 
 
                                                  驗證失敗 
 
 
 
 
                                                  格式錯誤 
 
                                        格式符合 
                                          
                                      
 
 
圖 5-8 文件產生階段的流程 
登入系統 
驗證 
上傳檔案 
檢查格式
設定權利 
結束 
  61
    進入到文件上傳頁面後即進正式進入文件產生階段的主軸，主要為上傳企業文
件、檔案及輸入檔案描述外，在上傳的同時也會為檔案建立一個內容辨識碼
(Content_id, c_id)，上傳成功之後將會進入權利設定頁面制定該文件相對應的權利。
此外也可以經由行動裝置上傳企業文件至系統中。 
 
圖 5-11 透過行動裝置模擬器進入文件上傳階段畫面 
    如圖 5-12 所示，在上傳文件成功後將會自動導引到權利設定頁面，上傳者、文
件 ID 與權利 ID 在上傳時即已產生並透過 session 變數傳到權利制定頁面，代表資
訊為固定且不可修改。在權利設定頁面中分別同部門權利與非同部門權利，同部門
為與上傳者相同部門所行使的權利，而非同部門不包含例外階段的非企業內部員
工。在行使權利方面分為讀取、寫入與列印三種使用權利，在行動裝置中的使用權
利以讀取(開啟文件)與寫入(存檔)為主。在次數選取中為避免上傳者訂定較高的次
數，因此以選項為依據，0 表示沒有行使權利；1 代表使用 1 次；5 代表使用 5 次；
-1 則表示沒有權利次數的限制。此外，在非同部門的權利制定上，由於導入企業階
層式的架構來針對企業不同部門間的文件保護，則沒有設計-1 的選項。 
  63
ID(m_id)檔案名稱(c_name)及檔案描述(c_info)，其中檔案名稱可以提供點選下載該
文件。下載後的檔案檔頭 header 包含 c_id，以作為使用階段使用者提取向 LS 要求
license 之依據。 
 
圖 5-14 下載階段使用情境圖 
 
5.4.5 文件使用階段 
在文件使用階段首先必須了解在監控軟體開發過程中如何設定權限及 UI。UI 宣告
的元件必須在主程式裡另行宣告使用。舉例來說：如要宣告使用按鈕結束定義其功
能，必須先宣告：Button exit = (Button)this.findViewById(R.id.exit)，才可使用。在
Android 的應用程式開發上雖然是以 Java 語言為基礎開發。但是，在 UI 的設計與
實作方面由於 JAVA 的 UI 使用 AWT 與 Swing 開發，而 Android 使用 xml 來定義與
描述 UI 的樣貌，這此我們使用以 JAVA 為基礎開發之 Android 的 UI 設計工具
Droiddraw 來設計並產生相對應的 xml 語法並匯入到 Eclipse 的 layout 來調整 UI 的
樣貌以及針對其做修整，其樣貌的內容將定義在 layout 的 main.xml 中。如圖 4-15
所示，若想要設計 Android 應用程式的 UI 可以透過 main.xml 直接編寫，也可透過
Eclipse 開發工具，在圖形化的 UI 開發視窗中設計。 
 
  65
DDMS 觀看檔案是否成功下載並儲存至裝置中。 
 
圖 5-17 在模擬器中透過 DDMS 瀏覽下載至 SD Card 的文件 
    在只有監控軟體才能開啟受保護的企業文件，下圖為 Android 系統平台專用的
監控軟體，主要用來開啟文件之用。在介面的設計中 File 為要求使用者輸入開啟檔
案的檔名以命令監控軟體開啟文件。License 為讀入系統相對應的 license，唯有正
確的 license 才能開啟對應的文件。 
 
圖 5-18 文件相對應的 license 
 
  67
  
圖 5-20 非法存取文件的錯誤訊息圖 
    首先正確的步驟為，先輸入欲開啟文件的 license 於 License 欄位中並點選 XML
讀入 license 至暫存記憶體中，透過 Android 原生支援的 xml 相關的原始碼將 tag 中
的內容取出，如圖 5-21 所示為一個讀取 xml，宣告在 ClickListener 中透過
DocumentBuilder 將 xml 文件讀取進來，設定好樹根後，用迴圈把之後 tag 的內容掃
描出來，最後抓取想要的內容其 read 跟 write 的次數，並轉換型態儲存在全域變數
中。可以由下方的文字顯示區域查看該文件權利剩餘的次數，接著可以順利開啟對
應的文件。 
  
圖 5-21 MS 讀入 license 並開啟相對應的文件示意圖 
  69
中，如圖 5-21 所示經過開啟與存檔的權利使用後，原本讀取與寫入的權利次數為 5
則變為 4，權利使用次數會依照使用者使用的次數扣除直到為 0，使用者便無法再
行使相對應的權利。 
 
 
 
 
 
 
 
 
  71
參考文獻 
[1] C. Conrado, F. Kamperman, G. J. Schrijen and W. Jonker, “Privacy in an 
Identity-based DRM System,” In Proceedings of the 14th IEEE International 
Workshop on Database Experts Systems Applications, pp. 389-395, 2003. 
[2] H.M. Sun, C.F. Hung and C.M. Chen, “An Improved Digital Rights Management 
System Based on Smart Cards,” In Proceedings of the IEEE/IES Conference on 
Digital Ecosystems and Technologies, pp. 308-313, 2007. 
[3] N.Y. Lee and T.Y. Lee, “User Friendly Digital Rights Management System Based on 
Smart Cards,” In Proceedings of the Fifth International Conference on Intelligent 
Information Hiding and Multimedia Signal Processing, pp. 869-872, 2009. 
[4] Y. Liu, N. Yu and Z. Hao, “Rights Sharing Scheme for Online DRM System Using 
Digital Ticket,” In Proceedings of the International Conference on Management and 
Service Science, pp. 1-6, Sept, 2009. 
[5] H.M. Sun, K.C. Yang and K.H. Wang, “Transferable DRM System for Two New 
Business Models,” In Proceedings of the Information Security Conference, June 
9-10, 2005. 
[6] T. Gaber and  N. Zhang, “A Novel Method for Supporting Fairness in Digital 
License Reselling,” In Proceedings of the Fifth International Conference on Internet 
Monitoring and Protection,  pp. 89 - 98, May, 2010. 
[7] E.S. Jeong, C. Sur and K.H. Rhee, “A New DRM System based on Graded Contents 
Sharing and Time-Block Distribution for Home Networks,” In Proceedings of the 
6th IEEE/ACIS International Conference on Computer and Information Science, pp. 
830 - 833, July, 2007. 
[8] Microsoft, Windows Media Digital Rights Management, available at 
http://www.microsoft.com/windows/windowsmedia/TW/drm/default.aspx 
  73
[24] 陳煜文，「以數位權利為基礎的商品交易機制」，世新大學資訊管理學系，碩
士論文，民國 92 年。 
[25] 趙惠美，「個人電子資料保護技術之研究」，中原大學電機工程學系，博士論
文，民國 94 年。 
[26] 陳宜儉，『健保「慢性病治療記錄卡」「醫事卡」安全認證與簽章之應用研究』， 
成功大學工程科學學系，碩士論文，民國 91 年。 
[27] R.  Rivest,  A. Shamir  and  L.  Adleman,  “A  method  for obtaining  
digital  signatures and public-key cryptosystems,” Communications of the ACM, 
Vol. 21, Issue 2, pp.120-126, 1978. 
[28] Federal  Information  Processing  Standards  Publication,  Digital  Signature  
Standard (DSS), 1994. 
[29] 林明慶，「隱匿技術應用於國軍網路申訴制度之研究」，國防大學資訊管理學
系，碩士論文，民國 98 年。 
[30] Federal   Information   Processing   Standards   Publication.   Advanced   
Encryption Standard (AES), 2001. 
http://csrc.nist.gov/publications/fips/fips197/fips-197.pdf . 
[31] Federal  Information  Processing  Standards  Publication.  Data  Encryption  
Standard (DES), 1999. http://csrc.nist.gov/publications/fips/fips46-3/fips46-3.pdf . 
[32] D. Coppersmith, D.B. johnson, and S.M. matyas, “A proposed mode for triple-DES 
encryption,” IBM Journal of Research and Development, pp. 253–261, 1996. 
[33] T. Elgamal, “A public key cryptosystem and a signature scheme based on discrete 
logarithms,” Information Theory,  IEEE Transactions on , Vol. 31, No. 4, pp. 469- 
472, 1985. 
[34] Federal  Information  Processing  Standards  Publication,  Digital  Signature  
 1
國科會補助專題研究計畫成果報告自評表 
請就研究內容與原計畫相符程度、達成預期目標情況、研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）、是否適
合在學術期刊發表或申請專利、主要發現或其他有關價值等，作一綜合評估。
1. 請就研究內容與原計畫相符程度、達成預期目標情況作一綜合評估 
■  達成目標 
□ 未達成目標（請說明，以 100 字為限） 
□ 實驗失敗 
□ 因故實驗中斷 
□ 其他原因 
說明： 
2. 研究成果在學術期刊發表或申請專利等情形： 
論文：□已發表 □未發表之文稿 ■撰寫中 □無 
專利：□已獲得 □申請中 ■無 
技轉：□已技轉 □洽談中 ■無 
其他：（以 100 字為限） 
 
研究成果已發表於 "15th IEEE International Symposium on Consumer Electronics" 以及 
"第二十一屆資訊安全會議"，共計三篇研討會論文。 
 
3. 請依學術成就、技術創新、社會影響等方面，評估研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）（以
500 字為限） 
本計畫提出了一個以智慧卡為基礎的企業化數位版權管理系統，我們設計的機制滿足了我
們所提出的 EDRM 的幾項基本需求，並且在金鑰產生、金鑰保管方法以及輔助的使用工具
上，我們提出了比較不同的新見解。但是在安全性以及權限控制上，也能達到其他機制相
同的需求，在分析比較後，我們的文件檔案的安全性也減少了風險的存在。計畫中亦設計
一個以行動裝置為基礎，透過憑證與授權伺服器驗證來達到階層式架構的 EDRM 系統。所
提方法對於檔案提供者而言能提供比以往 EDRM 系統更靈活的權利修訂機制，對於非本公
司員工我們使用 IMEI 配合 Exception_list 並給予最低的存取文件的權限。且不只考慮企
業內部員工離職的因應亦將員工職務調動的情況納入考量，應更能符合企業在實際運作中
所可能遭遇的實際狀況。最後計畫執行過程中亦針對電子病歷隱私與安全提出探討，一般
而言，我們可以將醫療院所視為企業公司、醫師視為員工、病歷資料視為需保護之企業文
件，計畫之研究成果 EDRM 系統可以應用於分享與管控電子病歷之使用，以確保病患之個
人隱私。 
 
  
Enterprise Digital Rights Management System  
based on Smart Card 
En-Chi Chang1, Kuo-Hsuan Huang1, An-Bang Lu1, Feipei Lai2 
 
1Department of Computer Science and Engineering, Tatung University, Taipei, Taiwan 
2Department of Computer Science and Information Engineering, National Taiwan University, Taipei, Taiwan 
 
ABSTRACT 
Electronic data access control in conventional digital rights 
management (DRM) systems is not suitable for company 
oriented DRM systems. Many enterprise digital rights 
management (EDRM) systems have therefore been developed, 
aiming to fulfill the requirements of companies. Using such 
systems, companies are able to regulate their digital content, 
allowing only authorized users to access and execute digital 
documents.  All access and use of digital documents by such 
users is also logged into history files. This allows multiple 
authorized users to edit and modify shared digital content 
together; even cross departmental sharing and editing of digital 
content is made possible. In this work, we have proposed a 
system that is different to the EDRM system developed by Chen 
et al. [1], Lin et al. [2] and Chang et al. [3]. Our system 
improves upon the systems mentioned previously and 
overcomes their drawbacks. A mechanism based on smart card 
has been used to design the new EDRM system, allowing it to be 
used in company operations with more flexibility and more 
convenience. 
Keywords: Digital Rights Management, Enterprise Digital 
Rights Management, Smart Card, Security 
1. INTRODUCTION 
In recent years, many digital rights management (DRM) systems 
have been developed and improved. Multi-level protection 
methods are used in these systems to protect digital content, and 
to ensure that only authorized users are able to use that digital 
content. In addition, to protect privacy, various security 
mechanisms have been introduced, allowing authorized users to 
select and use digital content with ease. For general multimedia 
commercial activities, these DRM systems satisfy most security 
requirements of users and data providers. However, when these 
DRM systems are used in a company environment, the company 
oriented security requirements for digital content cannot be 
fulfilled completely, since for a company, any data leak can 
significantly affect the interests of the company. One of the 
essential requirements for common DRM systems is to protect 
personal privacy, and this conflict with the security requirements 
of the company as a whole. In general, the upper level 
management of a company should explicitly know what 
important data is being uploaded, downloaded and modified, and 
by which user. If a problem occurs, the upper level management 
would know who is responsible right away and each action can 
be traced back to a user. These are the reasons why Enterprise 
Digital Rights Management (EDRM), or company oriented DRM 
systems have been developed. 
Numerous EDRM systems are available on the market, including 
Rights Management Services (RMS) by Microsoft [4], LiveCycle 
by Adobe [5], Active Rights Management (ARM) by Authentica 
[6] and Display-Only-File-Server (DOFS) by Rether [7]. In 
addition, Chen et al. in 2008, Lin et al. in 2009 and Chang et al. 
in 2010 also proposed their own EDRM system [1-3]. All of the 
systems mentioned above are designed to be company oriented. 
They not only protect digital content, but also offer companies 
the ability to share digital content or transfer access levels. Most 
importantly, they provide a logging history for the usage of the 
digital content, allowing the upper management to monitor the 
current status and to manage the user history of every user 
accessing digital content.  
We found that some of the EDRM systems require many 
unnecessary verification procedures, unnecessary transmission of 
data increasing the risk of a data leak and the high cost for 
calculations needed. We hope to improve upon the drawbacks of 
these EDRM systems and design our EDRM system to be 
suitable for use in company environments. 
2. Proposed EDRM System 
In proposed mechanism, we use smart card to help verify the 
requesting user and only allow authorized users to access data. 
The smart card comes with the ability to perform calculations, 
and we can use encryption, decryption and signature technologies 
during the process of data transmission to ensure the security and 
integrity of the data. Using the protected memory partition in the 
smart card to store important information also ensures that 
secured data is protected against harmful intruders [8]. We have 
designed four components of the EDRM system, namely the File 
Server, the License Server, Department Manager and Employee. 
Details about each participant are given below: 
 
 File Server, FS 
Main functions of the File Server include: (1) The File 
Server stores all the encrypted data files for the entire company 
(2) New Employees are required to register with the File Server 
and apply for new cards (3) The File Server verifies company 
employees and department managers who are requesting access 
to the data (4) When an employee leaves the company, the File 
Server relocates the smart card number associated with the 
employee to the Removal List in order to prevent ex-employees 
from accessing company resources (5) The File Server generates 
the company seed. Together with department manager, it also 
generates secret data B. 
2011 IEEE 15th International Symposium on Consumer Electronics
978-1-61284-842-6/11/$26.00 ©2011 IEEE 363
  
Step 1: After accepting a project, the department manager 
prepares to create data file. The manager must first 
insert his or her smart card into the device, and enters 
the PIN number to activate the smart card 
functionalities. The system would terminate if the wrong 
PIN number is entered.  
Step 2: Once the smart card has been activated by entering the 
correct PIN number, the manger creates an empty data 
file, file and configures the access levels for this data 
file, Usage_Rights and assigns this data file with an 
identification number f_id. 
Step 3: A random value A is generated using the smart card, and 
an encryption key sk for the data file is generated using 
the company seed in the smart card, where sk = seed ⊕ A. 
Step 4: The smart card is then used to encrypt the data file to 
create the encrypted data file Esk(file). Digital Signature 
is performed on Esk(file) to produce SignM(Esk(file) ). 
Step 5:  Esk( file ), SignM( Esk( file ) ) and PKFS( B ) are transferred 
to the File Server and the File Server uses its own 
private key to decode PKFS( B ) in order to obtain the 
Secret Data B. Based on the Secret Data B, the File 
Server verifies if the user is a department manager, and 
then uses the public key of this department manager to 
verify the data file, namely SignM(Esk(file)). If 
verification is successful, the data file Esk(file) is stored 
in the database, and if verification fails, writing of the 
file to the database is disallowed. 
Step 6: Finally, a license is generated using A, f_id and 
Usage_Rights such that license = { A, f_id, 
Usage_Rights }. Digital Signature is performed to 
license and we encrypt this license using the public key 
for the License Server. M1 is then obtained as 
M1=PKLS(SignM(license), license) and it is transmitted 
to the License Server.  The License Server uses its 
private key to decode M1, and uses the department 
manager’s private key to verify SignM(license). If 
verification is successful, the license file license is 
stored in the database, and if verification fails, writing 
the license file to the database is disallowed. 
 Data File Usage Phase 
When employees of the department wish to use the data file 
file, the following procedure must be followed:  
Step 1: The employee searches the data file in the File Server 
using the file identification number f_id, and at the same 
time, E_id᧤or M_id᧥and PKFS(B) are sent to the File 
Server 
Step 2: The File Sever uses its own private key to decode 
PKFS(B) in order to obtain B which is used to verify if 
the employee is valid. The identification number E_id᧤
or M_id᧥is used to verify if the employee or manager is 
on the removal list revocation list. If the employee or 
manager is on the list, service is terminated.  
Step 3: Once verified, the File Server sends the corresponding 
data file Esk(file) to the employee, and records the 
requests made by this employee for auditing purposes.  
Step 4: After the employee obtains the data file, f_id and E_id᧤
or M_id᧥and PKLS(B) are sent to the License Server of 
this data file to request for the license license. 
Step 5: The License Server performs a search to locate the 
corresponding license license and encrypts it with the 
employee’s public key before it sends PKE(license) to 
the employee. 
Step 6: The employee uses his or her smart card to decode 
PKE(license) with his or her own private key and obtains 
random value A from the license license. The key for the 
data file is then calculated using the company seed 
embedded in the smart card using sk=seed ⊕ A. The 
encrypted file Esk(file) is decoded using sk and the 
appropriate access level to the data file file is granted 
according to the usage rights. 
Step 7: Once they have editing, both the employees and 
managers must use their smart card to encrypt the data 
file using the same encryption key before sending the 
data file back to the File Server for storage.  
 Cross Department Usage Phase 
Under certain circumstances, company employees may need to 
access data files from other departments. However, data files in 
different departments may have access restrictions. The 
employees much insert their own smart card into the device, and 
perform the following procedure to execute the files. Suppose 
department dep’ wish to ask department dep for a data file with 
the identification number f_id. 
Step 1: Employee from department dep’ sends out file 
identification number f_id as well as the secret data B’ 
of his department to the File Server requesting data file 
file. Since this data file does not belong to department 
dep’, therefore, during the verification process, the File 
Server finds discrepancies between the Secret Data B’ 
and the requested file. Employee from department dep’ 
must send the file identification number f_id as well as 
a request for access to the manager in department dep. 
Step 2: The manager in department dep receives the request for 
access and agrees to grant a license. He generates an 
authentication token C to calculate    
) )  ((2 C, T _id,E_id,request, f Sign=PKM ME ′′
and sends M2 to employee from department dep’. The 
manager also calculates 
}{  ssage_RightA, f_id, Ulicense'= ′ and sends PKLS(
idE _′ , license' , C) to the License Server in 
department dep, waiting for the employee to apply. 
Finally, PKFS( idE _′ , f_id, C, T ) is calculated for the 
File Server to identify the verification information for 
granting access to department dep’.   
Step 3: When the employee receives M2, he uses his own private 
key to decode it and then sends M3 = PKFS( SignM( 
request, f_id, idE _′ , C , T ), request, f_id, idE _′  ) 
to the File Server to request the data file. 
Step 4: The File Server receives M3 and use its own private key 
to decode the encrypted content. Verifications are 
performed to ensure the employee number in the smart 
card is not on the removal list (revocation list), and that 
the authentication information C is correct. Once the 
Digital Signature is found to be authentic, the 
corresponding file Esk( file ) is sent to the employee and 
the request is logged into the record. 
365
  
outside of their department. Regardless of whether an employee 
is current working in the company, we have designed a system 
that allows only authorized users to edit data files that belongs to 
them. If an ex-employee does not return the smart card when he 
resigns, he will not be able to use his old smart card to access 
company data files. This is because his smart card number is 
added into the revocation list. When this ex-employee requests 
data files from the File Server, the File Server will be able to 
detect that his smart card is in the revocation list and all actions 
will be terminated. Our mechanism therefore successfully 
prevents de-authorized ex-employees from accessing company 
data. On the other hand, for employees who are currently 
working in the company, we have already encoded their 
departments’ Secret Data B in their smart card during the initial 
registration process. This limits the access level for the 
employees; they are only allowed to access data files within their 
own department. When an employee wishes to access a data file 
from another department, this employee must obtain a license 
granted by the manger of the other department in order to obtain 
the cross departmental data file. The authentication data C is used 
to grant licenses to different departments. In addition, one of the 
unique features of our mechanism is that the access level only 
allows the employee to access only a certain data file, instead of 
giving access to all files in the other department.     
(3) Replayed attacks 
An internal web server is often used in companies; the use of 
external web server is often minimized. To prevent important 
company data from leaking out, in addition to encrypting 
important data, our design also includes the use of a Time Stamp 
when transferring data between participants. Some attackers 
continuously collect information transmitted between 
participants and then repeatedly send this information to the File 
Server or License Server, hoping to mislead the servers into 
believing that the attackers are authorized users and send out 
data. We have included the Time Stamp mechanism to prevent 
this. For example, during the cross department usage phase, the 
employee must transmit 
PKFS( SignM( request, f_id, idE _′ , C , 
T ), request, f_id, idE _′ ) to the File Server in order to obtain 
the encrypted data file. Note that we have included the Time 
Stamp, T. When the attackers wish to resend this information, the 
server would detect that PKFS( SignM( request, f_id, idE _′ , C , 
T ′  ), request, f_id, idE _′  )  PKFS( SignM( request, f_id, 
idE _′ , C , T ), request, f_id, idE _′  ) and therefore terminate 
all activates. Thus it is confirmed that in our mechanism, the 
attackers are unable to steal important data through the use of a 
replayed attack. 
 
(4) Spoofing Attacks 
This type of attack forges a combination of the transmitted data 
sent by authorized users and tricks the receiver to believe that 
data sent by the attackers is coming from authorized users. The 
attackers then obtain useful secure data or file. In our 
mechanism, we only store the Secret Data B on to the smart cards 
of authorized users during the initial registration process. The 
Secret Data B is shared between employees, managers and 
servers. This prevents the attackers from obtaining useful 
information by forging the data combination. When requesting a 
data file from the File Server, one must transmit the following 
data to the File Server: PKFS( SignM( request, f_id, E_id, B, T ), 
request, f_id, E_id ). Even though request, f_id and E_id are 
public information, Secret Data B is not, and it is only available 
in the smart cards of authorized employees. It is impossible to 
forge this data without a authorized smart card. Even if the 
attacker successfully obtained the Secret Data B, without the 
correct Digital Signature from the department manger, the 
verification process cannot be completed. Under the multi-
layered protection system  we have described spoofing attacks 
are impossible.
 
4. EFFECTIVENESS ANALYSIS AND 
DISCUSSION 
The differences between our mechanism and other previous 
research are discussed. From Table 2 we can see that our system 
architecture is the only one that is smart card based. RMS by 
Microsoft is semi-smart card based but the smart cards are only 
used for identity authentication. In our mechanism, the smart 
cards are used for identity authentication as well as in key 
generation. This is one of the significant features that distinguish 
our system. In other related research, keys are generated using 
randomly generated data for the encryption key, and sometimes 
the encryption keys are transmitted during data transfer, which 
involves potential risks. In our system we have embedded the 
company seed into the smart cards. During key generation, 
randomly generated data is used as one of the elements to 
generate the encryption key sk where Aseedsk ⊕= . When 
sending out the keys to authorized users, we only send out 
portions of the encryption key which contain the random value A. 
During the data transmission process, the attackers are only able 
to obtain a portion of the encryption key. Without an authorized 
smart card, the attackers are unable to calculate the encryption 
key. Unlike methods proposed by other researchers where the 
entire encryption key can be obtained by the attackers, our 
system involves considerably lower risk. Regarding key storage, 
as mentioned above, we have divided the key into two sections. 
One is stored in the company File System, and the other is stored 
in the company License System. To obtain and calculate the key, 
one must successfully pass the verification process of these two 
servers, which makes it even more difficult for attackers to 
access the encryption key to the data file. In terms of participant 
configuration, our system is very similar to other systems. We 
aim to minimize the types of participants in order to avoid 
unnecessary complexity, therefore only four types of participants 
are configured. For participants who are able to access data files, 
we have configured the system so that when employees obtain 
the file, the smart card is used directly. Once the file is modified, 
the smart card is used again for encryption before the file is sent 
back to the File Server for storage. In our mechanism, only the 
File Server contains the source data, and all other participants can 
only perform modifications or editing in real time. All other 
systems described in relevant research allow participants other 
than the File Server to save the data file. In comparison, our 
mechanism involves fewer risks.   
5. CONCLUSION 
We have proposed a company oriented EDRM system based on 
smart cards and our mechanism satisfies the essential 
requirements for EDRM systems. We have also proposed novel 
367
  
A Secure Electronic Medical Record Sharing Mechanism  
in the Cloud Computing Platform 
 Zhuo-Rong Li1, En-Chi Chang1, Kuo-Hsuan Huang1, Feipei Lai2 
1Department of Computer Science and Engineering, Tatung University, Taipei, Taiwan 
2Department of Computer Science and Information Engineering, National Taiwan University, Taipei, 
Taiwan 
 
ABSTRACT 
Privacy is a very important issue when storing electronic medical 
records. According to the definition set out in the Health 
Insurance Portability and Accountability Act (HIPPA), the 
confidential section of the electronic medical record needs to be 
protected. Thus, a mechanism to protect the patient’s privacy is 
needed during electronic medical record exchange and sharing. 
The privacy protection mechanism can be categorized into four 
types, namely anonymity, pseudonymity, unlinkability, and 
unobservability. In previous research in this area, mathematical 
conversions and cross reference tables have been utilized to 
conceal the confidential part of the electronic medical record to 
achieve privacy protection. However, it is harder to use these 
methods with respect to the unlinkability and unobservability 
mechanisms. Thus, this paper tries to improve on this aspect, and 
improves the unlinkability mechanism between the patient and 
the electronic medical record. Cloud computing is known for its 
fast computation capability and provides large storage space. 
Through cloud computing, the electronic medical record system 
in a hospital can be integrated, to facilitate the exchange and 
sharing of electronic medical records, and to provide smaller 
hospitals or clinics that have fewer resources with adequate 
electronic medical record storage space. 
Keywords: Electronic Medical Record, Cloud Computing, 
Privacy, Security, Anonymity 
1. INTRODUCTION 
With the universal use of computers and advances in information 
technologies, an increasing number of hospitals and clinics have 
computerized the recording and storage of their medical records. 
According to the Medical Records Institute in the US, there are 
five stages involved in the digitization of medical records, 
namely, automated medical record, computerized medical 
records, electronic medical record, electronic patient record, and 
electronic health record [1].Currently most hospitals and clinics 
are at the stage of computerized medical records. In Taiwan for 
instance, currently the government is actively pushing for the 
third stage. The electronic medical record contains 
comprehensive patient medical treatment history, including texts 
and images. On the other hand, there has been a breakthrough in 
the exchange and sharing of electronic medical records in this 
stage, which is very beneficial and convenient for treating the 
patient. 
Many enterprises are now involved in the development of cloud 
computing technology or are providing cloud computing 
services. For example, Amazon’s Elastic Compute Cloud (EC2) 
[2] service, and salseforce.com’s customer relation management 
platform [3] both provide cloud computing services. Cloud 
computing, like the Web 2.0, is not a new technology, but a new 
idea that took birth thanks to the developments in information 
technology. Cloud computing is a distributed technology, and 
through the speed and advancement of web technology, the 
processing procedure can be separated into several smaller units 
to execute concurrent computing and send the final result back to 
the client. One advantage of cloud computing is dynamic 
configuration and expansion based on the demand, as well as the 
fast file search ability. Since cloud computing has the dynamic 
configuration capability, configuration costs are usually lower as 
compared to traditional methods. The technology enables the full 
utilization of resources without wastage. 
Most hospitals and clinics now have their own databases to 
manage electronic medical records. The exchange of electronic 
medical records is easier within the same electronic medical 
record system. However, the exchange of electronic medical 
records slows down between different electronic medical record 
systems [4]. Some of the smaller hospitals or clinics do not have 
the relevant servers to manage their electronic medical records, 
or to provide the electronic medical record exchange capability. 
The cloud platform can provide an exchange platform that all 
hospitals and clinics can use, and can serve as an electronic 
medical record storage center. This can simplify the complex 
electronic medical record exchange procedure between different 
systems, and save the equipment setup expenses for smaller 
hospitals. In addition, through the health care cloud of the cloud 
platform, patients only need one interface to find their complete 
medical history, instead of having to check through different 
hospitals and risk finding only partial medical history. 
With regards the privacy protection on electronic medical 
records, anonymity and pseudonym are the most common 
protection measures in place [5] [6]. The unlinkability between 
patients and medical records can be accomplished through the 
anonymity and pseudonym measures. The definition and 
functions of unlinkability are described in [7]. Regarding the 
method mentioned in [8], the previously used ID is combined 
with the password, and the password is hidden within the ID. A 
new ID is generated through a table look-up and re-arrangement, 
and then the newly generated ID is sent to the medical 
verification host to process the saving procedure. In [9], the 
keyword is initially used to hide information or a standardized 
method is used to modify information, and then the same 
method is used to return to the original state. Anonymity is used 
in the two approaches mentioned above as well as in [10] and 
[11]. The method of pseudonym is used in [12], in which the 
main IDp and the hospital’s ID1 are combined to form IDs1, 
where IDs1 is the patient’s new electronic medical record 
identification in the hospital. The demerit is that the patient has 
the same pseudonym ID in every hospital; thus, linkability still 
exists. 
2011 IEEE 15th International Symposium on Consumer Electronics
978-1-61284-842-6/11/$26.00 ©2011 IEEE 98
  
 Doctor D processes digital signature on 
M. 
2.3 Proposed Mechanism 
The proposed mechanism can be categorized into five stages, 
which can be described as follows: 
 Application Stage 
 Patient 
The patient must first apply to the HCA for a health data 
card. The HCA generates an identity seed SID for the 
patient, and the seed will be used to generate hidden 
identity information in the future. In addition, the HCA 
generates a key seed, KS, to create the key for medical 
record encryption. Both the SID and KS are stored inside 
the patient’s health data card. 
 Doctor 
The doctor must apply to the HCA for the medical 
personnel card, in which the doctor’s private key is stored 
for signing the electronic medical records. 
 Treatment Stage 
In this stage, the patient brings his or her health data card 
to the hospital for treatment. The doctor logs into the 
health care cloud and through the patient’s health data card, 
the hidden identity number (PID) of the electronic medical 
record is generated. After treatment, the hospital name, 
department, treatment time, and treatment serial number 
are saved into the patient’s health data card. The 
processing procedure is as follows: 
Step 1: The patient goes to the hospital for treatment with his or 
her health data card. The doctor logs into the health care 
cloud and starts treatment. Each time the patient receives 
treatment, the doctor generates a treatment serial number 
(SN) and the electronic medical record identity index 
number (index) for the medical record. 
Step 2: The doctor generates a random value R, and through the 
patient’s health data card, the PID is computed as the 
identity number for the current electronic medical record. 
The SID is the identity seed previously stored inside the 
patient’s health data card, and SN is the treatment serial 
number. 
                    (1) 
Step 3: Using the random value R generated in Step 2, and 
through the patient’s health data card, the encryption key 
OTK is computed to encrypt the sensitive or private 
information part. KS is the key seed previously stored 
inside the patient’s health data card, and SN is the 
treatment serial number. 
 !  !"#                    (2) 
$  "%&'                               (3) 
The SMR is that part of the electronic medical record 
which is the sensitive or private section (including 
information that can distinguish/determine the patient’s 
identity). 
Step 4: After a complete electronic medical record is generated, 
the doctor signs on the electronic medical record. 
(  "$                 (4) 
MR refers to the less sensitive or private information 
block in the electronic medical record. 
Step 5: Then the electronic medical record, signature value 
generated using formula (4), and the electronic medical 
record number PID generated using formula (1), are 
uploaded onto health care cloud. 
 ) *$㧦"+$(             (5) 
Step 6: After the electronic medical record is created, the 
treatment information (such as the hospital name 
(HName), treatment department (DName), treatment time 
(ts), and treatment serial number (SN) and random value 
R are saved into the patient’s health data card. The patient 
may connect to the health care cloud and search for his or 
her medical record information in the future. 
  *#,-
#,-
#                  (6) 
 ) 㧦"                               (7)+
Step 7: After being signed, the patient’s identity number IDNO, 
index, and L are sent to the NHI to be saved. 
 ) #*㧦#
.               (8) 
  where .  #
               (9) 
Step 8: The doctor signs and sends "ޔ! and 
the electronic medical record index number (index) to the 
HCA for saving. 
 ) *$/Κ
"!"0     (10) 
Where    0  
"!"     (11) 
 Electronic Medical Record Number Recovery Stage 
If the doctor needs to review a certain electronic medical 
record of a patient, the corresponding PID is required to 
search and download the record from the heath care cloud. 
If the patient’s health data card is available, the PID can be 
recovered through the health data card. The processing 
procedure is the same as that indicated in the patient 
searches electronic medical record stage. If the patient’s 
health data card is not available, the following steps must 
be performed to obtain the electronic medical record 
number and to subsequently obtain the electronic medical 
record. 
Step 1: The doctor sends a request message, including the 
identity number, IDNO, of the patient being searched, to 
the NHI. 
 ) #*Κ"
12
#              (12)+
Step 2: Once the NHI has verified that the message is legitimate, 
it sends the patient’s treatment information list (list) to the 
doctor. The doctor selects the needed treatment record 
choice, and sends it back to the NHI. 
#* ) Κ"
3	              (13)+
 ) #*Κ"
12
	
           (14)+
Step 3: After the NHI receives the required treatment request, it 
sends the corresponding index and L to the doctor. 
#* ) Κ
                  (15) 
Step 4: Once the doctor receives the electronic medical record 
identity number index from the NHI, he/she requests for 
the corresponding " from the HCA. 
 ) *$/㧦"
12

                (16)+
*$/ ) Κ
"              (17)+
Step 5: Through the "  and SN derived from L, the 
doctor computes the electronic medical record number 
PID using formula (1), and uses the PID to download 
"+$( from the heath care cloud. 
 Key Recovery Stage 
There are two types of key recovery situations. If the 
100
  
4. COMPARISONS 
In this section, we analyze and compare the proposed 
method with those investigated in the past research 
literature, and tables have been constructed to compare the 
electronic medical record exchange methods and ID 
anonymity methods separately. In Table 2, the electronic 
medical record exchange systems have been compared. 
Most systems accomplish file encryption and 
interoperability, but not portability, which is inconvenient 
for the patient. In addition, the P2P method is unable to 
collect the entire treatment information of a patient in one 
go from all the hospitals the patient has visited, to 
construct a full medical record. If the files have to be 
requested one by one from all the hospitals where 
treatments were received, the process will be very slow 
and inefficient. Table 3 compares electronic medical 
record ID anonymity methods. The main purpose of ID 
anonymity is to protect the patient’s privacy, to disconnect 
the relation between the patient and the medical record. In 
table 3, it can be found that the connection is still present 
to a certain extent in some methods. The reason is that 
either the anonymity is fixed or the same hospital uses the 
same anonymous name. Thus, a certain connection still 
exists. Most of the methods fail to mention the procedure 
to restore anonymity/key. Although there is a revoking 
mechanism, there are other issues like whether the initial 
anonymity/key is still effective or not or how it can be 
replaced after the old anonymity/key has been revoked 
[13], and these issues deserve further discussion. Thus, 
this paper provides the anonymity/key restoring 
mechanism, to compensate for the inadequacy of the 
revoking mechanism. 
5. CONCLUSION 
In this paper, we proposed a mechanism in which the 
cloud platform is utilized to accomplish electronic medical 
record exchange, and at the same time used to protect the 
patient’s privacy. The electronic medical record numbers, 
generated using the SID in the health data card, random 
value, and treatment serial number, are all different even 
for the same patient for each of his or her electronic 
medical record numbers. It has the unlinkability 
characteristic. In addition, a onetime key is used for 
medical record encryption to enhance the security of the 
encrypted section. The utilization of the cloud platform not 
only allows hospitals with fewer resources to receive the 
electronic medical record service and save electronic 
medical records, but also allows patients to review their 
own medical records at home. With the prevalence of 
mobile devices, in the future cloud technology may be 
used in mobile devices so that medical records may be 
reviewed on mobile devices, instead of the service being 
limited to a sole terminal device such as the computer.  
6. ACKNOWLEDGEMENT 
This work was partially supported by the National Science 
Council, Taiwan, under grant NSC 98-2218-E-036-003-
MY2. 
7. REFERENCES 
[1] Waegemann, C.P., Spotlight on healthcare: document 
imaging in healthcare: one piece of the puzzle in creating 
electronic patient record systems. Inform. v14 i1. Pages 8-
10. 
[2] Amazon Elastic Compute Cloud(Amazon EC2) 
http://aws.amazon.com/ec2 
[3] salseforce.com http://salseforce.com 
[4] R. Zhang and L. Liu, “Security Models and Requirements 
for Healthcare Application Clouds, ”  Proceedings of  
IEEE 3rd International Conference on Cloud Computing, 
2010, pages 268-275. 
[5] R. Clarke, “Identified, Anonymous and Pseudonymous 
Transactions: The Spectrum of Choice ,” Proceedings of 
the User Identification & Privacy Protection : Application 
in Pbulic Administration & Electronic Commerce; Kista, 
Schweden, June 1999;IFIP WG 8.5 and WS 9.6; 
http://www.anu.edu.au/people/Roger.Clarke/DV/UIPP99.h
tml 
[6] A. Pfitzmann and M. Hansen, “Anonymity, Unlinkability, 
Unobservability, Pseudonymity, and Identity 
Management – A Consolidated Proposal for 
Terminology,”web page: 
http://dud.inf.tudresden.de/Anon_Terminology.shtml 
[7] ISO/IEC 15408-2 INTERNATIONAL STANDARD 
Information  technology  - Security techniques  - 
Evaluation criteria for IT security - Part 2: Security 
functional requirements, Oct.2005. 
[8] H. M. Chao , S.H Twu and C. M. Hsu , “A Secure 
Identification  Access Control Scheme for Accessing  
Healthcare  Information  Systems,” Proceedings of the 4th 
Annual IEEE Conf on Information Technology 
Applications in Biomedicine, UK, April 2003, pages 122-
125. 
[9] L.-C. Huang, et al., “Privacy preservation and information 
security protection for patients' portable electronic health 
records,” Proceedings of Computers in Biology and 
Medicine  Volume 39 Issue 9, September 2009. 
[10] Asmaa H.Rashid and Prof.dr . Abd-Fatth Hegazy, “Protect 
Privacy of Medical Informatics using K-Anonymization 
Model,” Proceedings of  2010 The 7th International 
Conference on Informatics and Systems (INFOS) ,March 
2010,pages 1-10. 
[11] G. Ateniese and B. de Mediros, “Anonymous E-
Prescriptions,”  Proceedings of WPES '02 Proceedings of 
the 2002 ACM workshop on Privacy in the Electronic 
Society, November 2002. 
[12] B. Alhaqbani and C. Fidge, “Privacy-Preserving Electronic 
Health Record Linkage Using Pseudonym Identifiers,” 
Proceedings  of  HealthCom 2008 10th International 
Conference on e-health Networking, Applications and 
Services, 2008 , July 2008, pages 108-117. 
[13] C. Gentry, “Certificate-Based Encryption and the 
Certificate Revocation Problem,”  EUROCRYPT'03 
Proceedings of the 22nd international conference on 
Theory and applications of cryptographic techniques: 272-
293, 2003. 
[14] M. Boniface et al., “A Secure Semantic Interoperability 
Infrastructure for Inter-Enterprise Sharing of Electronic 
Healthcare Records, ”  IOS Press Publisher, 2006. 
[15] Guy c. Hembroff and S. Muftic, “Secure Healthcare 
102
基於行動裝置的階層式企業數位版權管理系統 
 
黃國軒 1 李昆憲 2 張恩齊 3 
大同大學資訊工程系 1,2,3 
khhuang@ttu.edu.tw 
1 
kunhsienlee@gmail.com 
2
 
angie.ecchang@gmail.com 
3
 
 
摘要 
 
近 年 來 在 數 位 版 權 管 理 (Digital Right 
Management, DRM)的技術已經越趨成熟之際，企業
數位版權管理(Enterprise Digital Right Management, 
EDRM)的領域也有眾多的廠商紛紛加入開發，但是
這些 EDRM 系統大多數沒有支援在行動裝置上的
使用。如今智慧型手機規格推成出新，核心時脈也
越來越快，因此我們提出了一個基於行動裝置的階
層式 EDRM 系統，讓使用者可以隨時隨地使用無線
裝置瀏覽及使用企業內部的文件，在系統中行動裝
置將透過監控軟體來監控並限制企業文件的使用。
而階層式架構的運用也為企業階層及各部門間的
文件使用達到有效的控管。 
關鍵詞：數位版權管理系統、企業數位版權管理系
統、行動裝置、階層式 
 
1. 簡介 
 
    由於數位化產品與網際網路的普及，以往需取
得實體的產品，如今能夠在網路上被輕易地取得，
因此數位版權管理(Digital Right Management, DRM)
就成為了近年來熱門的議題，數位版權管理系統是
透過加密數位內容與合法授權來防止非善意使用
者非法使用與複製的系統，除了使用次數與複製的
權利限制之外，最近更有人投入發展各種應用情境，
如：由 Conrado 等人[2]於 2003 年首先提出的以
Smart Card 為基礎的 DRM 系統，及後續又有人提
出改進並應用在電子商務的情境上[7,9]，數位內容
加入電子商務買賣的行為之後衍申出權利轉售的
問題，因此有了權利轉移的研究[4, 6,10]與內建驗證
模組，故不需透過線上驗證的支援離線使用之 DRM
系統[5]。有別於像 WMRM[11]對於音樂、影片等數
位內容的保護，企業文件雖然沒有商業販售的行為，
但內容往往是企業重要資產，如專案計畫書、合約 
書、客戶名單等資料。有鑒於此，於是有了企業數
位版權管理系統的誕生。相較於 DRM 技術發展越 
趨成熟之際，EDRM 領域相關的系統，也有眾家廠
商紛紛投入開發，如：Microsoft 的 WRMS[12]、
Adobe 的 LiveCycle[13]、Authentica 的 Active Rights  
 
 
 
 
Management (ARM)[14]以及 Intertrust 公司所推出
的產品[15]等，但一方面受到系統平台與軟體相容
性的限制，另一方面則視需求不同，許多軟體廠商
各自開發屬於自己的 EDRM 系統，太過老舊的系統
不支援跨平台；支援行動裝置的系統，則因為需求
需要大量的安全運算；又例如像 Chen[1]與 Chang
等人[3]所提出的行動式 EDRM 系統，雖然經過
Chang 等人改善 Chen 在一次性秘密金鑰的保管與
更新部分存在的安全性疑慮，如：使用者無法在一
次性密鑰的方法中驗證密鑰的正確性，更無從得知
驗證訊息是否已遭到攻擊者竄改，並將驗證階段的
過程簡化，但整體架構還是稍嫌複雜，且在 EDRM
的領域，由 Lin[8]等人提出的架構，使我們更了解
到階層式管理在 EDRM 中的重要性與實用性。有鑑
於此我們發展出一套以行動裝置為基礎的階層式
EDRM 系統。 
    在新一代智慧型手機蓬勃的發展中除了逐漸
克服運算能力、網路傳輸、電力等問題之外，專為
智慧型手機而設計的應用程式也越來越多，不僅在
使用功能及運算能力上已經漸漸取代傳統桌上型
電腦，傳輸速率與頻寬上也因為 3.5G 行動上網的
普及而獲得了改善。此外，行動裝置也有硬體保護
與限制的特性，提供了硬體的識別與身份驗證等，
若能結合 DRM Agent[16]可以確保使用者無法惡意
散佈之外。在企業文件的使用上，企業員工可以利
用行動裝置的可攜性與便利性，在企業所允許的文
件管控策略上，執行企業內部文件的存取。綜觀這
些優點，我們將行動裝置與 EDRM 系統結合，設計
一個安全及可靠的行動 EDRM 系統。 
    在第二節中將簡述系統角色與相關概念定義，
第三節為所提 EDRM 系統描述，第四節針對所提出
方法進行安全分析，第五節為效能分析與討論，最
後第六節為結論。 
 
2. 概念定義 
 
    本論文中提出一個具階層式架構的 EDRM 系
統，除了使用部門與位階來區分使用者的身分之外，
同時透過 Right 中的權利使用的次數限制來控管使
用者的使用。在所提系統中包含五個角色：內容提
供者、行動使用者、內容伺服器、授權伺服器以及
認證中心。五個角色的介紹如下： 
 內容提供者( Content Provider, CP)：此指企業
內部的員工，負責產生檔案以及賦予使用的權
* 本研究接受國科會編號：NSC 98-2218-E-036-003-MY2 研究
計畫經費補助 
列印"Print"，每個存取類型會有使用次數的限制 i、
j；前者 i 為同部門的成員對於某項存取類型的使用
次數，後者 j 為不同部門成員的使用次數。此外，
-1 表示沒有次數限制。 
    當 MU 向 LS 要求 license 時，LS 根據 CP 制定
的 Right 檢查與 MU 的 Dep(x)與 Lv(y)的資訊並將適
當的權利寫入 TP_Right 中。其中，TP_Right 是 LS
發佈給 MU 對於文件存取的權利，結構為：
TP_Right=(R(k),W(k),P(k))。若 CP 制定的使用權利
為：Right=( R(10, 5), W(10, 5), P(10, 5) )，則非同部
門的員工所對應的使用權利經由權利限縮之後可
能為：TP_Right=(R(3), W(3), P(3))。 
由於 TP_Right 是 LS 給 MU 的專屬權利，所以
只需要k一種數值，其中k為LS依照MU的Dep(x)、
Lv(y)與 CP 提供的 Right=( R(i, j),W(i, j),P(i, j) )檢查
後為 MU 設定。為了避免 CP 制訂較寬鬆的權利，
在 LS 發布 license 時也會依據企業文件使用規範產
生文件使用權利限縮 MU 的權利。此外，在非公司
員工的 license 核發部分應依照企業文件使用規則
給予最低的使用權限，以確保文件的安全。 
 
3. 所提出的 EDRM 系統 
 
在所提方法中分為五個階段：註冊階段、文件
產生階段、下載階段、文件使用階段、例外階段。
以下將各別描述每個階段的詳細步驟： 
 
3.1 註冊階段 
 
  在註冊階段中，新進員工一開始進入公司填寫
基本資料，通過上級主管及人事部門的審核通過後，
將相關人事資料傳給 AA 進行註冊與申請憑證，其
步驟如下： 
步驟 1：企業人事部門將使用者資訊{ u_id , Dep(x) , 
Lv(y) }傳給 AA，AA 接收訊息後將其員工
資訊儲存在資料庫中。 
步驟 2：AA 為該員工產生其憑證 CertU=SAA ( u_id || 
Dep(x) || Lv(y) || T )，並將其憑證傳送給人
事部門。 
步驟 3：人事部門將憑證 CertU 儲存在行動裝置中，
並將裝置核發給員工，其中行動裝置中已
事先安裝了監控軟體 MS。當裝置核發給員
工後再將該裝置的 IMEI 根據 u_id 存入 AA
的資料庫中。 
 
3.2 文件產生階段 
 
  在此階段首先企業員工必頇產生一份企業文
件，並透過 AA 驗證員工身份，假如身份驗證合法
則將文件上傳至 CS 存放，其詳細步驟如下： 
步驟 1：企業員工產生文件 content 以及文件資訊  
c_info)，並選擇 RK 用來加密 c_info 與
content，接著計算 PKCS(RK)。最後將{ u_id, 
CertU, PKCS(RK), ERK( c_info || content ) }
傳送給 AA。 
步驟 2：AA 驗證其 CertU 的合法性，若驗證成功將
{ u_id, PKCS(RK), ERK( c_info || content ) }
轉送給 CS，否則拒絕存取。 
步驟 3：CS 接收自使用者上傳的文件後，解密
PKCS(RK)，使用 RK 解密受加密的內容並
賦予文件一組識別碼 c_id，並產生秘密金
鑰 CK 加密 content，並將{ c_id, c_info, 
u_id, ECK( content ) }存入資料庫中。 
步驟 4：文件加密完成後，CS 將訊息{ success_msg, 
c_id }透過 AA 回傳給使用者。 
步驟 5：CS 使用 LS 的公開金鑰加密此段訊息
PKLS( c_id || c_info || CK )後傳送給 LS，使
用 PKLS(.)加密訊息其用意是保證其訊息只
有 LS 能夠解開。 
步驟 6：使用者收到 CS回傳的 c_id後則針對 content
制定其相對應的使用權利 Right，並用 LS
的公開金鑰將 Right 加密之後透過 AA 傳給
LS 儲存，其加密訊息為 PKLS( u_id || c_id 
||Right )。 
步驟 7：LS 會先收到"步驟 5" CS 傳送的訊息
PKLS( c_id || c_info || CK)，先利用 LS 的私
密金鑰解開其訊息後，再根據 LS 收到使用
者在"步驟 6"傳送的權利訊息 PKLS( u_id || 
c_id || Right )，根據比對 c_id 確定為同一個
文件後將{ c_id, c_info, u_id, Right, CK }存
入資料庫，提供日後產生 license 使用。 
 
3.3 下載階段 
 
    行動使用者 MU 需先輸入個人識別碼
( Personal Identification Number, PIN )來啟動行動裝
置， 並執行以下步驟以獲得 CS 回傳的下載文件之
URL 後，才可將受保護的文件下載至行動裝置中。 
步驟 1：MU 產生下載要求 Download_req，並透過
MS 將訊息{ CertU , IMEI , Download_req }
傳送給 AA。AA 檢查憑證 CertU 是否合法
以及 IMEI 是否已註冊，並檢查 CertU 是否
存在於 Revocation_list，若存在則拒絕服
務。假如通過驗證，AA將訊息轉送給 LS。 
步驟 2：LS 收到 AA 轉送的訊息後，依據 CertU中
的 Dep(x)與 Lv(y)資訊，產生其可存取的文
件列表 Content_list，其中包含文件識別碼、
文件名稱、文件內容摘要等，並將此訊息
傳給 AA 再經由 AA 轉送回傳給 MU。 
步驟 3：MU 接收到 Content_list 後選擇欲下載的文
件 並 提 出 下 載 文 件 的 要 求 { c_id, 
Download_req }給 AA，AA 再將訊息傳送
給 CS 
步驟 4：當 CS 收到 MU 的 Download_req 訊息後，
根據 c_id 將對應的文件經由 AA 轉送下載
文件的 URL 回傳給 MU。 
 
應的CertU故還是會被拒絕存取服務。 
 
5. 效能分析與討論 
 
在這一節中，我們將所提的方法和過去相關研
究進行比較，如表 2。由於 Microsoft 所開發的
WRMS 需要一些廠商專有的服務軟體如：目錄服務
伺服器( Active Directory, AD )雖然支援行動裝置，但是
不支援階層式使用，且在未知內容金鑰的角色中僅有 CA
無法得知；而以階層式的觀點，雖然 Lin 等人所提
出的系統也支援階層式使用，但在權利擴充以及例
外處理的情況中則沒支援；Chen 與 Chang 等人的
方法雖能支援行動裝置但無法達成階層式使用。我
們的方法不僅支援了階層式使用也包含了權利例
外處理的情況，也因為使用更多的資訊加入至驗證
的條件中。因此除了在開啟文件時需要解密運算之
外，其他只是驗證 PIN 碼與傳送文件下載與 license
的請求。而 Chen 與 Chang 等人雖然比我們的方法
多一個角色--封裝伺服器( Package Server, PS )不過
我們將封裝內容的功能整合在 CS 當中，所以參與
角色是一樣的。綜觀上述，可以看出我們所提方法
的確比其他方法有較佳安全性以及符合實際情
境。 
 
6. 結論 
 
在本篇論文中我們設計一個以行動裝置為基
礎，透過憑證與授權伺服器驗證來達到階層式架構
的 EDRM 系統，在系統中以安全分析的角度來看我
們的系統，不只保證了安全性且在實際應用的情境
如：攻擊者竊取行動裝置與竄改 IMEI 方面也能夠
有效防護企業文件。 
    所提方法對於 CP 而言能提供比以往 EDRM 系
統更靈活的權利修訂機制，對於非本公司員工我們
使用 IMEI 配合 Exception_list 並給予最低的存取文
件的權限。且不只考慮企業內部員工離職的因應亦
將員工職務調動的情況納入考量，應更能符合企業
在實際運作中所可能遭遇的實際狀況。 
 
參考文獻  
 
[1] C.L. Chen, “A Secure and Traceable E-DRM 
System based on Mobile Device,” Expert Systems 
with Applications, Vol. 35, Issue 3, Oct, 2008. 
[2] C. Conrado, F. Kamperman, G. J. Schrijen and W. 
Jonker, “Privacy in an Identity-based DRM 
System,” In Proceedings of the 14th IEEE 
International Workshop on Database Experts 
Systems Applications, pp. 389-395, 2003. 
[3] C.C. Chang, J.H. Yang and D.W. Wang, “An 
efficient and reliable E-DRM scheme for mobile 
environments,” Expert Systems with Applications, 
Vol. 37, Issue 9, pp.6176-6181, 2010. 
[4] T. Gaber and  N. Zhang, “A Novel Method for 
Supporting Fairness in Digital License Reselling,” 
In Proceedings of the Fifth International 
Conference on Internet Monitoring and Protection,  
pp. 89 - 98, May, 2010. 
[5] E.S. Jeong, C. Sur and K.H. Rhee, “A New DRM 
System based on Graded Contents Sharing and 
Time-Block Distribution for Home Networks,” 
In Proceedings of the 6th IEEE/ACIS International 
Conference on Computer and Information Science, 
pp. 830 - 833, July, 2007. 
[6] Y. Liu, N. Yu and Z. Hao, “Rights Sharing Scheme 
for Online DRM System Using Digital Ticket,” 
In Proceedings of the International Conference on 
Management and Service Science, pp. 1-6, Sept, 
2009. 
[7] N.Y. Lee and T.Y. Lee, “User Friendly Digital 
Rights Management System Based on Smart 
Cards,” In Proceedings of the Fifth International 
Conference on Intelligent Information Hiding and 
Multimedia Signal Processing, pp. 869-872, 2009. 
[8] C.C. Lin, S.C. Wu, P.H. Chiang and C.C. Chen, 
“Enterprise-Oriented Digital Rights Management 
Mechanism: eDRM,” In Proceedings of the 
International Conference on Availability, 
Reliability and Security, pp. 923-928, 2009. 
[9] H.M. Sun, C.F. Hung and C.M. Chen, “An 
Improved Digital Rights Management System 
Based on Smart Cards,” In Proceedings of the 
IEEE/IES Conference on Digital Ecosystems and 
Technologies, pp. 308-313, 2007. 
[10] H.M. Sun, K.C. Yang and K.H. Wang, 
“Transferable DRM System for Two New 
Business Models,” In Proceedings of 
the Information Security Conference, June 9-10, 
2005. 
[11] Microsoft, Windows Media Digital Rights 
Management, available at  
http://www.microsoft.com/windows/windowsme
dia/TW/drm/default.aspx 
[12] Microsoft available at 
http://www.microsoft.com/zh/tw 
[13] Adobe available at http://www.adobe.com/ 
[14] AUTHENTICA. Authentica delivers next- 
generation enterprise rights management 
platform. Press release, Authentica, 2005. 
[15] Intertrust available at 
http://www.intertrustgroup.com 
[16] OMA-TS-DRM_DRM-V2_0_2-20080723-A, 
Available at 
http://www.openmobilealliance.org/. 
 
 
 1
國科會補助專題研究計畫項下出席國際學術會議心得報告 
                                     日期：100 年 06 月 17 日 
一、 參加會議經過 
ISCE 已舉辦了十四屆，舉辦過的地點有德國不倫瑞搭(2010 年)、日本京都(2009
年)、葡萄牙羅雷(2008 年)等。今年為第十五屆舉辦地點在新加坡的新加坡管理大學。
本次會議共有四天，大會接受了 142 篇論文，共分為 23 場次。其中 8 場為特別議程，
而 15 場為一般議程，並在中午休息階段，展示論文海報。本次會議主題涵括了以下
四大類： 
1. Basic Technologies for Consumer Electronics 
2. Key Entertainment and Information Systems 
3. Consumer Electronics for Health-care & Wellness 
4. Enabling Technologies and Others 
  
    此次口頭報告議呈安排於第一天下午開始至第三天，第一天有六場議程，第二天
和有九場議程，而第三天有八場議程。每位論文報告者有二十分鐘發表研究成果與回
計畫編號 NSC 98－2218－E－036－003－MY2 
計畫名稱 安全且可信賴的企業數位版權管理系統之研究 
出國人員
姓名 李卓蓉 
服務機構
及職稱 大同大學資訊工程系/碩士班學生 
會議時間 100 年 06 月 14 日至 100 年 06 月 17 日 會議地點 新加坡 
會議名稱 
(中文)第十五屆 IEEE 電子消費國際會議 
(英文) 15th IEEE International Symposium on Consumer Electronics 
發表論文
題目 
(中文) 基於雲端平台實現電子病歷交換機制 
(英文) A Secure Electronic Medical Record Sharing Mechanism in the 
Cloud Computing Platform 
寄件人 粽子 shingboa@gmail.com 
收件人 kuohsuan1225@gmail.com 
日期 2011年3月30日下午1:25
主旨 Fwd: ISCE2011: result of review
寄件人 gmail.com
簽署者 gmail.com
 
 
---------- Forwarded message ---------- 
From: <isce2011@ntu.edu.sg> 
Date: 2011/3/28 
Subject: ISCE2011: result of review 
To: shingboa@gmail.com 
Cc: isce2011@ntu.edu.sg 
 
 
Dear Zhuo-Rong Li, 
 
We are pleased to inform you that your following paper has been accepted as full paper for ISCE2011. 
 
TITLE  : A Secure Electronic Medical Record Sharing Mechanism in the Cloud Computing Platform 
AUTHORS: Zhuo-Rong Li, En-Chi Chang, Kuo-Hsuan Huang, Feipei Lai 
 
The camera-ready version of your paper must be uploaded (using the same link given in your initial submissi
2011 through the conference website. The length of the paper should be between 4 to 6 pages, and must str
IEEE PDF eXpress format (Sample can be downloaded via our conference submission web-page). Note that
form is also needed to be submitted (zipped together with the final camera-ready paper) in order for the pape
 
For the paper to be published in the conference proceedings, one of the authors must register for the confere
(please refer to the conference web-page for the registration details, which will be available from 1-April 2011
 
Below contains the comments of the reviewers for your paper. Please do take their comments and proposals
improve the quality of your camera-ready paper. 
 
The Advance and Final programs of ISCE2011 will be announced on the conference web-page soon. 
 
We are looking forward to welcome you in June in Singapore. 
 
 
Best regards 
ISCE 2011 Technical Program Chairs 
 
 
 
 
------------------------ Reviewers Comments ----------------------------- 
 
Reviewer 1 
 
Summary: 
                             I think this is a good quality paper. The method proposed by authors is compared with othe
literature what demonstrates its effectiveness. 
 
Specific Feedback to the Track Chair and Program Chair(s): 
 
 
 
--------------------------------------- 
 
 
Reviewer 2 
 
Summary: 
 
 
Specific Feedback to the Track Chair and Program Chair(s): 
 
 
 
--------------------------------------- 
 
 
Page 1 of 2
  
A Secure Electronic Medical Record Sharing Mechanism  
in the Cloud Computing Platform 
 Zhuo-Rong Li1, En-Chi Chang1, Kuo-Hsuan Huang1, Feipei Lai2 
1Department of Computer Science and Engineering, Tatung University, Taipei, Taiwan 
2Department of Computer Science and Information Engineering, National Taiwan University, Taipei, 
Taiwan 
 
ABSTRACT 
Privacy is a very important issue when storing electronic medical 
records. According to the definition set out in the Health 
Insurance Portability and Accountability Act (HIPPA), the 
confidential section of the electronic medical record needs to be 
protected. Thus, a mechanism to protect the patient’s privacy is 
needed during electronic medical record exchange and sharing. 
The privacy protection mechanism can be categorized into four 
types, namely anonymity, pseudonymity, unlinkability, and 
unobservability. In previous research in this area, mathematical 
conversions and cross reference tables have been utilized to 
conceal the confidential part of the electronic medical record to 
achieve privacy protection. However, it is harder to use these 
methods with respect to the unlinkability and unobservability 
mechanisms. Thus, this paper tries to improve on this aspect, and 
improves the unlinkability mechanism between the patient and 
the electronic medical record. Cloud computing is known for its 
fast computation capability and provides large storage space. 
Through cloud computing, the electronic medical record system 
in a hospital can be integrated, to facilitate the exchange and 
sharing of electronic medical records, and to provide smaller 
hospitals or clinics that have fewer resources with adequate 
electronic medical record storage space. 
Keywords: Electronic Medical Record, Cloud Computing, 
Privacy, Security, Anonymity 
1. INTRODUCTION 
With the universal use of computers and advances in information 
technologies, an increasing number of hospitals and clinics have 
computerized the recording and storage of their medical records. 
According to the Medical Records Institute in the US, there are 
five stages involved in the digitization of medical records, 
namely, automated medical record, computerized medical 
records, electronic medical record, electronic patient record, and 
electronic health record [1].Currently most hospitals and clinics 
are at the stage of computerized medical records. In Taiwan for 
instance, currently the government is actively pushing for the 
third stage. The electronic medical record contains 
comprehensive patient medical treatment history, including texts 
and images. On the other hand, there has been a breakthrough in 
the exchange and sharing of electronic medical records in this 
stage, which is very beneficial and convenient for treating the 
patient. 
Many enterprises are now involved in the development of cloud 
computing technology or are providing cloud computing 
services. For example, Amazon’s Elastic Compute Cloud (EC2) 
[2] service, and salseforce.com’s customer relation management 
platform [3] both provide cloud computing services. Cloud 
computing, like the Web 2.0, is not a new technology, but a new 
idea that took birth thanks to the developments in information 
technology. Cloud computing is a distributed technology, and 
through the speed and advancement of web technology, the 
processing procedure can be separated into several smaller units 
to execute concurrent computing and send the final result back to 
the client. One advantage of cloud computing is dynamic 
configuration and expansion based on the demand, as well as the 
fast file search ability. Since cloud computing has the dynamic 
configuration capability, configuration costs are usually lower as 
compared to traditional methods. The technology enables the full 
utilization of resources without wastage. 
Most hospitals and clinics now have their own databases to 
manage electronic medical records. The exchange of electronic 
medical records is easier within the same electronic medical 
record system. However, the exchange of electronic medical 
records slows down between different electronic medical record 
systems [4]. Some of the smaller hospitals or clinics do not have 
the relevant servers to manage their electronic medical records, 
or to provide the electronic medical record exchange capability. 
The cloud platform can provide an exchange platform that all 
hospitals and clinics can use, and can serve as an electronic 
medical record storage center. This can simplify the complex 
electronic medical record exchange procedure between different 
systems, and save the equipment setup expenses for smaller 
hospitals. In addition, through the health care cloud of the cloud 
platform, patients only need one interface to find their complete 
medical history, instead of having to check through different 
hospitals and risk finding only partial medical history. 
With regards the privacy protection on electronic medical 
records, anonymity and pseudonym are the most common 
protection measures in place [5] [6]. The unlinkability between 
patients and medical records can be accomplished through the 
anonymity and pseudonym measures. The definition and 
functions of unlinkability are described in [7]. Regarding the 
method mentioned in [8], the previously used ID is combined 
with the password, and the password is hidden within the ID. A 
new ID is generated through a table look-up and re-arrangement, 
and then the newly generated ID is sent to the medical 
verification host to process the saving procedure. In [9], the 
keyword is initially used to hide information or a standardized 
method is used to modify information, and then the same 
method is used to return to the original state. Anonymity is used 
in the two approaches mentioned above as well as in [10] and 
[11]. The method of pseudonym is used in [12], in which the 
main IDp and the hospital’s ID1 are combined to form IDs1, 
where IDs1 is the patient’s new electronic medical record 
identification in the hospital. The demerit is that the patient has 
the same pseudonym ID in every hospital; thus, linkability still 
exists. 
2011 IEEE 15th International Symposium on Consumer Electronics
978-1-61284-842-6/11/$26.00 ©2011 IEEE 98
  
 Doctor D processes digital signature on 
M. 
2.3 Proposed Mechanism 
The proposed mechanism can be categorized into five stages, 
which can be described as follows: 
 Application Stage 
 Patient 
The patient must first apply to the HCA for a health data 
card. The HCA generates an identity seed SID for the 
patient, and the seed will be used to generate hidden 
identity information in the future. In addition, the HCA 
generates a key seed, KS, to create the key for medical 
record encryption. Both the SID and KS are stored inside 
the patient’s health data card. 
 Doctor 
The doctor must apply to the HCA for the medical 
personnel card, in which the doctor’s private key is stored 
for signing the electronic medical records. 
 Treatment Stage 
In this stage, the patient brings his or her health data card 
to the hospital for treatment. The doctor logs into the 
health care cloud and through the patient’s health data card, 
the hidden identity number (PID) of the electronic medical 
record is generated. After treatment, the hospital name, 
department, treatment time, and treatment serial number 
are saved into the patient’s health data card. The 
processing procedure is as follows: 
Step 1: The patient goes to the hospital for treatment with his or 
her health data card. The doctor logs into the health care 
cloud and starts treatment. Each time the patient receives 
treatment, the doctor generates a treatment serial number 
(SN) and the electronic medical record identity index 
number (index) for the medical record. 
Step 2: The doctor generates a random value R, and through the 
patient’s health data card, the PID is computed as the 
identity number for the current electronic medical record. 
The SID is the identity seed previously stored inside the 
patient’s health data card, and SN is the treatment serial 
number. 
                    (1) 
Step 3: Using the random value R generated in Step 2, and 
through the patient’s health data card, the encryption key 
OTK is computed to encrypt the sensitive or private 
information part. KS is the key seed previously stored 
inside the patient’s health data card, and SN is the 
treatment serial number. 
 !  !"#                    (2) 
$  "%&'                               (3) 
The SMR is that part of the electronic medical record 
which is the sensitive or private section (including 
information that can distinguish/determine the patient’s 
identity). 
Step 4: After a complete electronic medical record is generated, 
the doctor signs on the electronic medical record. 
(  "$                 (4) 
MR refers to the less sensitive or private information 
block in the electronic medical record. 
Step 5: Then the electronic medical record, signature value 
generated using formula (4), and the electronic medical 
record number PID generated using formula (1), are 
uploaded onto health care cloud. 
 ) *$㧦"+$(             (5) 
Step 6: After the electronic medical record is created, the 
treatment information (such as the hospital name 
(HName), treatment department (DName), treatment time 
(ts), and treatment serial number (SN) and random value 
R are saved into the patient’s health data card. The patient 
may connect to the health care cloud and search for his or 
her medical record information in the future. 
  *#,-
#,-
#                  (6) 
 ) 㧦"                               (7)+
Step 7: After being signed, the patient’s identity number IDNO, 
index, and L are sent to the NHI to be saved. 
 ) #*㧦#
.               (8) 
  where .  #
               (9) 
Step 8: The doctor signs and sends "ޔ! and 
the electronic medical record index number (index) to the 
HCA for saving. 
 ) *$/Κ
"!"0     (10) 
Where    0  
"!"     (11) 
 Electronic Medical Record Number Recovery Stage 
If the doctor needs to review a certain electronic medical 
record of a patient, the corresponding PID is required to 
search and download the record from the heath care cloud. 
If the patient’s health data card is available, the PID can be 
recovered through the health data card. The processing 
procedure is the same as that indicated in the patient 
searches electronic medical record stage. If the patient’s 
health data card is not available, the following steps must 
be performed to obtain the electronic medical record 
number and to subsequently obtain the electronic medical 
record. 
Step 1: The doctor sends a request message, including the 
identity number, IDNO, of the patient being searched, to 
the NHI. 
 ) #*Κ"
12
#              (12)+
Step 2: Once the NHI has verified that the message is legitimate, 
it sends the patient’s treatment information list (list) to the 
doctor. The doctor selects the needed treatment record 
choice, and sends it back to the NHI. 
#* ) Κ"
3	              (13)+
 ) #*Κ"
12
	
           (14)+
Step 3: After the NHI receives the required treatment request, it 
sends the corresponding index and L to the doctor. 
#* ) Κ
                  (15) 
Step 4: Once the doctor receives the electronic medical record 
identity number index from the NHI, he/she requests for 
the corresponding " from the HCA. 
 ) *$/㧦"
12

                (16)+
*$/ ) Κ
"              (17)+
Step 5: Through the "  and SN derived from L, the 
doctor computes the electronic medical record number 
PID using formula (1), and uses the PID to download 
"+$( from the heath care cloud. 
 Key Recovery Stage 
There are two types of key recovery situations. If the 
100
  
4. COMPARISONS 
In this section, we analyze and compare the proposed 
method with those investigated in the past research 
literature, and tables have been constructed to compare the 
electronic medical record exchange methods and ID 
anonymity methods separately. In Table 2, the electronic 
medical record exchange systems have been compared. 
Most systems accomplish file encryption and 
interoperability, but not portability, which is inconvenient 
for the patient. In addition, the P2P method is unable to 
collect the entire treatment information of a patient in one 
go from all the hospitals the patient has visited, to 
construct a full medical record. If the files have to be 
requested one by one from all the hospitals where 
treatments were received, the process will be very slow 
and inefficient. Table 3 compares electronic medical 
record ID anonymity methods. The main purpose of ID 
anonymity is to protect the patient’s privacy, to disconnect 
the relation between the patient and the medical record. In 
table 3, it can be found that the connection is still present 
to a certain extent in some methods. The reason is that 
either the anonymity is fixed or the same hospital uses the 
same anonymous name. Thus, a certain connection still 
exists. Most of the methods fail to mention the procedure 
to restore anonymity/key. Although there is a revoking 
mechanism, there are other issues like whether the initial 
anonymity/key is still effective or not or how it can be 
replaced after the old anonymity/key has been revoked 
[13], and these issues deserve further discussion. Thus, 
this paper provides the anonymity/key restoring 
mechanism, to compensate for the inadequacy of the 
revoking mechanism. 
5. CONCLUSION 
In this paper, we proposed a mechanism in which the 
cloud platform is utilized to accomplish electronic medical 
record exchange, and at the same time used to protect the 
patient’s privacy. The electronic medical record numbers, 
generated using the SID in the health data card, random 
value, and treatment serial number, are all different even 
for the same patient for each of his or her electronic 
medical record numbers. It has the unlinkability 
characteristic. In addition, a onetime key is used for 
medical record encryption to enhance the security of the 
encrypted section. The utilization of the cloud platform not 
only allows hospitals with fewer resources to receive the 
electronic medical record service and save electronic 
medical records, but also allows patients to review their 
own medical records at home. With the prevalence of 
mobile devices, in the future cloud technology may be 
used in mobile devices so that medical records may be 
reviewed on mobile devices, instead of the service being 
limited to a sole terminal device such as the computer.  
6. ACKNOWLEDGEMENT 
This work was partially supported by the National Science 
Council, Taiwan, under grant NSC 98-2218-E-036-003-
MY2. 
7. REFERENCES 
[1] Waegemann, C.P., Spotlight on healthcare: document 
imaging in healthcare: one piece of the puzzle in creating 
electronic patient record systems. Inform. v14 i1. Pages 8-
10. 
[2] Amazon Elastic Compute Cloud(Amazon EC2) 
http://aws.amazon.com/ec2 
[3] salseforce.com http://salseforce.com 
[4] R. Zhang and L. Liu, “Security Models and Requirements 
for Healthcare Application Clouds, ”  Proceedings of  
IEEE 3rd International Conference on Cloud Computing, 
2010, pages 268-275. 
[5] R. Clarke, “Identified, Anonymous and Pseudonymous 
Transactions: The Spectrum of Choice ,” Proceedings of 
the User Identification & Privacy Protection : Application 
in Pbulic Administration & Electronic Commerce; Kista, 
Schweden, June 1999;IFIP WG 8.5 and WS 9.6; 
http://www.anu.edu.au/people/Roger.Clarke/DV/UIPP99.h
tml 
[6] A. Pfitzmann and M. Hansen, “Anonymity, Unlinkability, 
Unobservability, Pseudonymity, and Identity 
Management – A Consolidated Proposal for 
Terminology,”web page: 
http://dud.inf.tudresden.de/Anon_Terminology.shtml 
[7] ISO/IEC 15408-2 INTERNATIONAL STANDARD 
Information  technology  - Security techniques  - 
Evaluation criteria for IT security - Part 2: Security 
functional requirements, Oct.2005. 
[8] H. M. Chao , S.H Twu and C. M. Hsu , “A Secure 
Identification  Access Control Scheme for Accessing  
Healthcare  Information  Systems,” Proceedings of the 4th 
Annual IEEE Conf on Information Technology 
Applications in Biomedicine, UK, April 2003, pages 122-
125. 
[9] L.-C. Huang, et al., “Privacy preservation and information 
security protection for patients' portable electronic health 
records,” Proceedings of Computers in Biology and 
Medicine  Volume 39 Issue 9, September 2009. 
[10] Asmaa H.Rashid and Prof.dr . Abd-Fatth Hegazy, “Protect 
Privacy of Medical Informatics using K-Anonymization 
Model,” Proceedings of  2010 The 7th International 
Conference on Informatics and Systems (INFOS) ,March 
2010,pages 1-10. 
[11] G. Ateniese and B. de Mediros, “Anonymous E-
Prescriptions,”  Proceedings of WPES '02 Proceedings of 
the 2002 ACM workshop on Privacy in the Electronic 
Society, November 2002. 
[12] B. Alhaqbani and C. Fidge, “Privacy-Preserving Electronic 
Health Record Linkage Using Pseudonym Identifiers,” 
Proceedings  of  HealthCom 2008 10th International 
Conference on e-health Networking, Applications and 
Services, 2008 , July 2008, pages 108-117. 
[13] C. Gentry, “Certificate-Based Encryption and the 
Certificate Revocation Problem,”  EUROCRYPT'03 
Proceedings of the 22nd international conference on 
Theory and applications of cryptographic techniques: 272-
293, 2003. 
[14] M. Boniface et al., “A Secure Semantic Interoperability 
Infrastructure for Inter-Enterprise Sharing of Electronic 
Healthcare Records, ”  IOS Press Publisher, 2006. 
[15] Guy c. Hembroff and S. Muftic, “Secure Healthcare 
102
國科會補助計畫衍生研發成果推廣資料表
日期:2011/10/28
國科會補助計畫
計畫名稱: 安全且可信賴的企業數位版權管理系統之研究
計畫主持人: 黃國軒
計畫編號: 98-2218-E-036-003-MY2 學門領域: 資訊安全 
研發成果名稱
(中文) 基於行動裝置的階層式企業數位版權管理系統
(英文) A Hierarchical Enterprise Digital Rights Management System based on Mobile Devices
成果歸屬機構
大同大學 發明人
(創作人)
黃國軒
技術說明
(中文) 本計畫提出了一個基於行動裝置的階層式企業數位版權管理(EDRM)系統，讓使用
者可以隨時隨地透過使用行動裝置來瀏覽及使用企業內部文件。在DRM與EDRM系
統中主要多以Domain與Smart Card技術為基礎來限制使用者使用數位內容，本計
畫使用行動裝置結合EDRM系統，除了能夠兼顧Smart Card其可攜的便利性特性之
外，並使用行動裝置中唯一的國際行動裝置辨識碼與個人數位憑證一起提交給認
證中心做驗證，如此便可達到其安全性的要求。在系統中行動裝置將透過監控軟
體來監控並限制企業文件的使用。而階層式架構的運用也為企業階層及各部門間
的文件使用達到有效的控管與保護。
(英文) This project proposes a hierarchical EDRM system based on mobile device that users can 
browse and use the internal documents of enterprises at anytime and anywhere by using 
mobile devices. The DRM and EDRM systems utilize the technologies of Domain-based 
and Smart Card-based to limit users in using digital content. In this project, the portability 
feature of smart card can be kept by combining mobile devices with EDRM systems; 
besides by sending the unique International Mobile Equipment Identity number 
（IMEI） and the owner certificate to authorization authority for verifying the identity 
that can satisfy the required security requirements. The Monitor Software in the mobile 
devices is used to monitor and limit the use of enterprise documents. The hierarchical 
architecture is used to achieve effective file management and protection between the 
departments in the enterprise.
產業別 資訊服務業
技術/產品應用範圍 企業文件管理系統
技術移轉可行性及
預期效益
確保企業文件安全性
註：本項研發成果若尚未申請專利，請勿揭露可申請專利之主要內容。
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
無 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
