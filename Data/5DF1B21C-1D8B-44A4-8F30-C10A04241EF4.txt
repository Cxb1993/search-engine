developed a handheld pain-warning device, with which 
patients can inform medical staffs or doctors over 
the network in case of unexpected pains. In addition, 
we have developed a positioning system that allows 
doctors to monitor patient’s locations and to 
provide immediate care when necessary. We have also 
built a data mining system to effectively analyze 
patient records stored in the PCA database and to 
extract useful information for providing better 
medical care. In addition, we have further integrated 
3G networks with iPCA to verify the applicability of 
iPCA to telehealth services. This integrated iPCA 
system has been successfully demonstrated in the lab 
of National Chiao Tung University (year 1), in the 
Ward 701 of Changhua Christian Hospital (CCH) (year 
2), and in some patients’ homes for providing 
distant medical care after surgeries (year 3). This 
system has been proven its effectiveness in helping 
medical staff to monitor patients’ health conditions 
and locations, and providing anesthesiologists with 
useful supports for better PCA control to increase 
patients’ satisfactions. 
英文關鍵詞： Wireless sensor network 、Patient-controlled 
analgesia、Integrated information system for PCA、
Data mining 
 
中英文摘要 
    在本計畫三年執行過程中，我們已成功利用國科會及清華大學共同研發之無線感測模組，建
構無線感測網路(Wireless Sensor Networks，簡稱 WSNs)平台，並且開發了一套完善的病人自控止
痛整合資訊系統(Integrated Information System for Patient Controlled Analgesia，簡稱 iPCA)。本計
畫利用資訊網路科技來提供手術後的患者更完善的醫療照護。在此系統中，我們已成功建構一個
即時、可靠之無線感測網路，將患者的用藥與生理狀況（包含患者自控止痛器(PCA)的儲存資訊、
血壓、血氧等）加以收集，並傳回至後端的患者自控止痛管理資料庫。我們也設計一個手持式的 “疼
痛通知裝置＂，當患者無法忍受疼痛時，可使用本裝置透過網路發送請求醫護人員幫助的呼叫。
除此之外，本系統也提供定位之功能，便於醫護人員掌握患者位置，以支援位置相關服務，增加
患者之行動自由空間，並讓醫療人員及時獲得患者的行動資訊。我們於後端建立資料探勘系統，
將資料庫中的數據加以分析，擷取有用資訊並提供給醫護人員 PCA 各項參數設定之建議，以便
提高手術後止痛的醫療及病人生活品質。最後我們更進一步地將 3G 網路整合至 iPCA 系統，以驗
證 iPCA 用於遠距醫療照護的可行性。此系統第一年已在交通大學實驗室測詴，第二年於彰化基
督教醫院七一護理站實地測詴，以及第三年在患者居家實地測詴後，證明我們的系統可實際應用
於一般醫院以及遠距醫療環境。總而言之，本系統能夠有效幫助醫療人員監控患者健康情況以及
所在位置，並且提供麻醉醫師即時的醫療資訊，使麻醉醫師能更妥善的針對患者情況設定適當的
PCA 參數，如此可提高手術後患者的生活品質。 
 
 This integrated project has a 3-year execution period. We have built an Integrated Information 
System for Patient Controlled Analgesia (iPCA) based on the Wireless Sensor Network (WSN), with 
sensor modules developed by NSC and NTHU. The system can provide better medical care to patients 
after surgeries by information network technologies. We have designed and developed a real-time and 
reliable wireless sensor network, which can collect and disseminate sensor data from patients, and these 
data can be easily transferred to the medical center (such as a database) for later analysis. We have also 
developed a handheld pain-warning device, with which patients can inform medical staffs or doctors 
over the network in case of unexpected pains. In addition, we have developed a positioning system that 
allows doctors to monitor patient’s locations and to provide immediate care when necessary. We have 
also built a data mining system to effectively analyze patient records stored in the PCA database and to 
extract useful information for providing better medical care. In addition, we have further integrated 3G 
networks with iPCA to verify the applicability of iPCA to telehealth services. This integrated iPCA 
system has been successfully demonstrated in the lab of National Chiao Tung University (year 1), in the 
ㄧ、計畫目標 
近年來，由於資訊科技與無線網路的發展，使得網路的應用愈趨多元化。資訊技術之發展也從
硬體設備的效能提升，慢慢轉型為服務應用科技之提昇。特別在醫療照護上，如何利用資訊網路
科技來提供使用者一個安全、健康及舒適的醫療環境，並解決醫療資訊及資料的處理問題，進一
步可提供醫療決策支援。輔助醫師做出即時且精確的診斷及正確地依循治療計畫，是目前無線感
測網路技術研發應用的重點之一。 
本計畫利用國科會及清華大學共同研發之無線感測網路(Wireless Sensor Networks，簡稱WSNs)
相關感測器，開發整合技術平台，來建置一套完善的病人自控止痛整合資訊系統 (Integrated 
Information System for Patient Controlled Analgesia，簡稱iPCA)。本系統架構包含三個部分：前端
是以無線感測網路為主的患者用藥與生理狀況監測系統、後端為患者止痛管理資料探勘系統，以
及整合前端與後端的資訊網路系統。本計畫針對以上三個系統，分下列三個子計畫來執行： 
子計劃一： 無線感測網路資料收集、傳遞及位置相關服務整合； 
子計劃二： 患者自控止痛管理資料探勘及分析； 
子計劃三： iPCA 資訊網路整合系統。 
本計畫成員由交通大學資訊工程學系教授與彰化基督教醫院麻醉科主治醫師結合而成的跨領
域研究團隊，交通大學教授們在定位、資料處理、無線網路、感測網路、資料探勘等方面學有專
精，其在各研究領域已有多年研發經驗與豐碩的研發成果，希望將無線感測網路、定位資訊系統、
及無線網路等技術應用在醫療照護領域，尋求醫療與資訊的創新及整合。此創新應用，不但能讓
患者自行控制PCA 給藥，緩解術後傷口疼痛的問題，並解除患者僅能在醫院病床上的束縛，隨時
定位患者所在位置，也能即時通知醫護人員知悉有關患者的健康訊息，保障患者的健康與安全，
並且將患者的生理資訊透過感測器經由無線網路即時地登載於資料庫內，提供醫護人員最即時、
最完整的資料，與更完善的醫療服務品質。本計畫最終目標是推廣本系統至居家照護系統，增加
醫院內病床再使用率，減低患者醫療費用支出，提供患者一個更獨立的生活空間。同時，為確保
醫療資訊在無線網路傳輸過程中之保密性、完整性、身分鑑別、不可否認性，建構安全、即時、
可信賴的醫療環境，亦為本研究計畫發展之重點所在。綜上所述，深信本計畫深具前曕性、創新
性、實務應用發展的潛力，其成果及經驗將可對國內相關之研究帶來莫大的助益。 
 
 
 
 
子計畫二主要的目標是將收集在患者自控止痛管理資料庫中的數據加以分析，擷取有用資訊，
以提供醫護人員有效的設定PCA 各項參數之建議，提高術後止痛的醫療品質。本子計畫將收集與
準備相關文獻與資料以便擷取患者的特徵值，並運用計算技術(如資訊理論)來評估特徵值的質
性。藉由質性的評估，我們即可針對特徵值集合進行精錬(refine)，最後找出適當的病人自控止痛
器資料呈現方式，並評估出可用的資料探勘演算法，完成資料探勘系統的模型。最終我們將整合
並加以驗證資料探勘系統與其它子計畫所開發的系統，以達成醫療品質優化的願景。 
子計畫三：iPCA 資訊網路整合系統(iPCA system integration) 
子計畫三的主要目標是利用資訊網路，來整合前端患者用藥與生理狀況的無線感測網路與後端
患者自控止痛管理資料庫，讓前端患者狀況之相關資料能夠有效的傳送到後端患者自控止痛管理
資料庫。此一資訊網路系統(簡稱iPCA 系統)整合了Octopus、Zigbee，IEEE 802.11 及3G 無線網
路到有線的IP 網路(醫院內部網路)，核心技術包含感測器與Octopus、Zigbee 終端節點的整合，
Octopus、Zigbee/IEEE802.11網路橋接器(Octopus、Zigbee/3G 網路橋接器)實作，以及患者自控止
痛管理資料庫的建置，並提供給子計畫二做患者自控止痛管理資料探勘及分析系統之用。 
 
三、計畫主要內容 
疼痛是一種常見的臨床症狀，很多病理性疼痛本身就是一種嚴重影響患者生活品質的疾病，對
人體的危害往往比其他疾病更大。隨著醫療科學的進步，人們逐漸意識到疼痛的重要性。世界衛
生組織於西元2000 年提出「慢性疼痛是一種疾病」，從而將疼痛歸類於疾病的範疇，被當今醫學
列為繼呼吸、脈搏、血壓、體溫之後的第五大生命體徵，疼痛的重要性逐漸受到國際醫學界的廣
泛關注。 
凡是接受過手術的患者，對於手術帶來的痛楚是很難忘記的。然而，大多數的患者對於術後疼
痛卻認為是理所當然的事情。事實上，術後疼痛對患者的心理及生理上皆造成巨大的影響。在心
理上，疼痛不僅會造成患者的不舒服，也會造成患者的焦慮與恐懼，同時容易伴隨著嚴重的失眠
和食慾不振，甚至低落的情緒常常是醫病關係緊張的導火線。在生理上，疼痛也會影響各種系統
功能的異常，包括呼吸系統、心血管系統、消化系統、泌尿系統、肌肉代謝、神經內分泌代謝等。
疼痛無法有效的紓解，它將會延長患者的復原時間與出院時間。因此，有效的疼痛管理不但可以
降低因疼痛而造成患者合併症的發生，亦能提高術後生活與醫療品質。肌肉注射止痛劑是臨床上
一種常見的術後止痛方式，其最大特色是具有皮下注射快速收的便利性，並提供醫護人員簡單及
方便的執行方式，但是缺點是在劑量的控制上較難達到患者長時間的止痛需要，常會導致劑量不
足和施打間隔缺乏彈性的問題，再者，傳統止痛劑注射程序下，患者必頇等待至少數十分鐘後，
適時與適當地使用患者自控止痛器，將會導致止痛效果不佳的狀況發生。雖然仍有缺點，但其目
前已被廣泛使用，成為術後止痛的新趨勢，不但得到大多數使用患者的滿意反應，而且可減輕護
理人員及看護家屬的工作量。 
雖然患者自控止痛器使得護理人員和患者較容易控制疼痛，但是如果護理人員要收集患者的
止痛劑注射資訊，以決定下一次該給患者多少劑量的止痛劑，他們必頇至各個病床旁使用印表機
將其列印出來。因為患者自控止痛器只支援序列埠傳輸，因而造成醫護人員的不便與醫療時間的
延宕，所以若能運用無線感測網路和WiFi 無線網路的結合傳送所需要收集的資料，勢必可以大
量減少醫療的資源消耗與提昇患者的滿意度。收集的資料包括患者的健康狀態資訊，例如心跳、
血壓，以及患者自控止痛器控制參數(如需要劑量與傳輸率等)。若能有效地分析患者自控止痛資
料庫中的數據，擷取有用資訊以提供醫護人員合理的建議，對於患者自控止痛器的運用將會有大
幅的助益。 
先前相關的研究中，已有學者結合網路科技和醫療設備開發出創新的應用。文獻[7-10]中，作
者運用電腦或PDA 讓醫生可以從遠端監控患者的心電圖；在論文[11]中，其主要開發一個線上虛
擬診所，患者可以經由影像和聲音找醫生看病；論文[12]中，提出一套利用無線射頻辨識系統(Radio 
Frequency Identification，簡稱RFID)對醫護人員做安全認證，並追蹤患者的所在位置之機制。 
本計畫利用國科會與清華大學共同研發之相關無線感測器，開發無線感測網路整合技術平台
以及患者自控止痛器，並利用Octopus、Zigbee 以及IEEE 802.11 無線網路傳輸技術[13]，建置一
套完善的患者自控止痛整合資訊系統。此創新應用，不但能讓患者自行控制PCA 給藥，緩解術後
傷口疼痛的問題，並解除患者僅能在醫院病床上的束縛，隨時定位患者所在位置，也能即時通知
醫護人員知悉有關患者的健康訊息，保障患者的健康與安全，並且將患者的生理資訊(血壓及血氧
濃度)透過無線網路即時的登載於資料庫內，提供醫護人員最即時、最完整的資料，與更完善的醫
療服務品質。本系統最終將推廣至居家照護系統，增加醫院內病床再使用率，減低患者醫療費用
支出，提供患者一個更獨立的生活空間。同時，為確保醫療資訊在無線網路傳輸過程中之保密性、
完整性、身分鑑別、不可否認性，建構安全、即時及可信賴的醫療環境，亦為本研究計畫發展之
重點所在。 
 
 
 
 
 
 
 圖三：Map-based 之室內定位系統示意圖 
在圖三每個紅點的位置，所分別收到角落四個AP 的訊號強度是多少，已預先測量並記錄
在一訊號地圖資料庫中。因此，系統可根據患者所處位置（藍色三角形處）目前所收到的AP’s 
訊號強度資訊，跟資料庫比對出最相近的是哪個(或哪些)紅點，即作為(或計算)該患者位置
之估計值。 
 
第二年：為了使無線網路感測節點有較長的壽命，使整體系統更為穩定，子計畫一第二年設計以
無線感測網路下之高效能叢集式多通道媒介存取控制協定與資料散播技術，以達到高產量，低媒
介存取延遲時間，以及高節能的目標。  
(1) 高效能叢集式多通道媒介存取控制協定     
     我們提出一個在無線多媒體感測網路下之高效能叢集式多通道媒介存取控制協定設計
(EMC-MAC)來達到高產量，低媒介存取延遲時間，以及高節能的目標。我們的方法整合了分
時多工存取與載波感測多重存取，以及碰撞避免協定的優點，以達到讓節點有效地運用所分
配到的頻道與時槽。EMC-MAC也運用一個有效的節能機制來減少需要傳送資料給叢集首的節點
數量，並且利用滑動競爭窗來有效地使用控制頻道。 
(2) 高效能叢集式資料散播(ECDD)技術     
     我們提出一個高效能叢集式資料散播技術來解決能源消耗與延遲時間降低這些問題。在
我們的方法中，除了附加控制訊息到興趣(interest)中來執行隨選式被動叢集，為了幫助感
測節點去選擇下一個到匯集點最少跳躍數的傳輸節點，我們也利用額外的控制訊息來對每一
圖七為血糖機的血糖值以十六進位的方式呈現在終端機上，我們可以看出目前已接收到
兩筆血糖值，分別為"5B 0D"以及"64 0D"，其中，第一個位元組表示血糖值，第二個位元組
(0D)表示換行符號。我們將"5B"以十進位表示會等於"96"，而將"64 "以十進位表示會等於
"100"，患者的兩個血糖值("96"及"100")皆在正常值範圍內。 
圖八為實際人體測詴所得之心電圖，首先我們將心跳頻率偵測器連接至患者身上，透過 
OctopusX 感測節點所形成的感測網路傳送至後端系統上，並以所撰寫之 java 程式使其呈現
心電圖。從圖五，我們可以看出該患者的心電值屬於正常範圍內，並沒有異常情況發生。 
 
             
圖七、 血糖機中的血糖值                           圖八、 心電圖 
 
(2) 適用於無線感測網路之快速且省電之加密演算法，以提高無線感測網路安全性 
最近幾年來，由於無線感測網路廣泛的應用在軍事、環境監控、健康和居家照顧上，這中
間牽涉到私密資料的傳遞，使得其在安全性方面變得越來越重要。加密機制是一個提供安全服
務的基本技術。因為感測節點的資源有限，所以在執行加密時必頇減少計算、通信和記憶體的
負載。橢圓曲線加密機制和其他的加密機制比較，其在通訊、計算和記憶體的使用需求上比較
少。此外，在相同的安全層次上，橢圓曲線加密機制只需要 160 位元的金鑰長度，而 RSA 加
密演算法則需要 1024 位元的金鑰長度(如表一)，所以橢圓曲線加密機制非常適合用在無線感
測網路上。然而，橢圓曲線加密機制的金鑰產生包含許多的純量乘法，使得其應用在感測節點
 圖十: 在不同的質數域底下其包含預先計算時間的平均金鑰產生時間 
 
圖十一: 在不同的窗口大小下包含預先計算時間的平均金鑰產生時間 
 
我們已將本研究所提出的「改良式窗口方法中選擇 essential pre-computed points 的方法」
(詳述如圖十二)完成專利申請。無線行動裝置(如感測節點)如果採用我們所提出的改良式窗口
方法，將可讓每一個無線行動裝置 (如感測節點 )都可以挑選出最少數目的 essential 
pre-computed points，降低預先計算所消耗的時間及加快計算金鑰所需的時間。本發明除了降
低計算時間外，也可以有效地節省能源，使無線行動裝置(如感測節點)的電池壽命增長。 
 
 
 
 
 
 
 
 
外，因為這些 essential pre-computed points 的數目比起傳統採用窗口方法所需要預先計算的
points 數目還要少很多，因此其在預先計算上所耗費的時間也比較短，如此可加快計算金鑰
所需的時間。 
 
2. 子計畫二：患者自控止痛管理資料探勘及分析 
第一年： 針對資料探勘分析與技術部份，第一年，我們計畫收集與準備相關資料以便從醫院紀錄
中篩選適當的患者特徵值，以及訂定資料探勘系統所需產生予醫師的建議資訊。 
(1) 從醫院紀錄中篩選適當的患者特徵值 
    過去幾年來，彰化基督教醫院保存大量的患者記錄，其可提供已接受患者自控止痛器的
患者特徵值。然而，並非所有的特徵值皆與患者自控止痛器治療的研究相關，亦存在著醫師
尚未注意到的特徵值。用以描述患者的特徵值越多，即代表患者自控止痛器的研究更臻完
善。因此，我們藉由相關文獻的研究與透過 PubMed 資料庫的搜尋來找出其他有意義的特徵
值。在相關的文獻中，找出共同的術語作為候選特徵值。隨後，所有的特徵值將會以兩個階
段來檢驗其與患者自控止痛器彼此間的相關性。首先，我們會先諮詢醫師有關的候選特徵值
的重要性，藉此排除不相關的特徵值。此外，透過與領域專家(domain experts)的訪談，我們
也可以依其相關性來排序其餘的特徵值，而特徵值的排名本身也可以作為高階的特徵值
(higher-level feature)。接著，利用儲存於醫院的患者自控止痛器治療結果，我們運用計算技
術(如資訊理論)，來評估特徵值的質性。系統架構圖如圖十三所示。 
 
(2) 訂定資料探勘系統所需產生予醫師的建議資訊 
我們藉由找出適當的特徵值來描述患者以建構患者自控止痛器資料探勘系統，並產生一
個可以給予醫生參考的建議，並用以精錬其運用患者自控止痛器治療的決策。一個基本的患
者自控止痛器的控制至少包括初始載入劑量、需要劑量、鎖定時間、基本注射率，與四小時
限制，資料探勘系統所產生的假設必頇包含上述相關的資訊。我們藉由將患者自控止痛器之
控制手動轉換成一個單一的新特徵值，以避免忽略其他的患者自控止痛器之控制。 
 表二、較多的患者特徵值 
 
(2) 決策樹配合 bagging 的方式達到 PCA treatment 預測 
    我們利用決策樹配合 bagging 的方式以提升準確度達到 PCA treatment 預測之目的(如圖十
四)，現階段已完成麻醉劑量與 PCA 參數是否需重設的預測工作以及完成決策樹學習演算法
的初步評估，麻醉科醫師可參考預測結果，檢視 PCA treatment，藉以提升病患對疼痛治療的
滿意度。 
高分類錯誤的資料權重，反之降低分類正確的資料權重，最後則以有權重的投票方式整合每
次迭代中產生的分類規則。資料探勘在實務的應用上，經常會出現類別不平衡 (class 
imbalance)[20]的問題，此問題指的是大多數的資料都屬於某一類別，稱之為多數類別(majority 
class)，其數量遠大於其他類別，此則稱為少數類別(minority class)。然而在日常生活中，我
們比較關注的通常是比較少發生的現象。這些較少發生的現象大多是比較有趣或重要的，例
如：詐欺偵測(fraud detection)[21]以及漏油偵測(oil spill detection)[22]等，這些在類別不平衡
的資料中做預測之實務，皆是著眼於偵測少數發生的重要現象。在傳統的學習演算法中，對
於在學習類別不平衡的資料時，通常會傾向預測為多數類別(majority class)而忽略了少數類別
(minority class)，這樣的預測傾向，雖然可以有很高的多數類別準確度，但少數類別的準確度
往往會嚴重降低。而且在大多數的領域中，少數類別通常是比較被關注的，因此在遇到類別
不平衡的資料時，我們希望可以透過一些方法來改善少數類別的準確度。過去的文獻中，已
提出一些方法來解決類別不平衡的問題，例如：減少多數類別取樣法(under-sampled examples 
of the majority class)[23]、增加少數類別取樣法 (over-sampled examples of the minority 
class)[24]、結合減少多數類別和增加少數類別取樣法(over-sampled the minority class and 
under-sampled the majority class)[25]、增加少數類別之資料權重，使其學習演算法傾向於少數
類別[26]、利用 boosting 演算法分類少數類別[27]及 DataBoost-IM 演算法[28]等方法。在第三
年的研究中，我們探討各種方法的優缺點，因為本計畫所研究的患者資料為真實資料，其中
內含雜訊(noise)過多，且不同類別的資料相當稀疏且重疊的，有鑑於相同類別的資料通常較
為靠近，我們使用 k-nearest-neighbor 演算法來做資料清理(data cleaning)，針對減少多數類別
取樣法、增加少數類別取樣法和 DataBoost-IM 做實驗分析，同時也與 Random Forest[29]，
stacking[30]做比較。 
 
(2) 實驗設計 
在第三年，我們蒐集了較過去兩年更多的患者資料，總共有 5432 位患者。刪除因 PCA
裝置暫存空間不足而毀損之檔案後，剩餘 4632 位患者，再刪除資料庫中無病歷資料之患者則
剩餘 2586 位患者。此外若該患者的病歷資料不完整的比例太高者也將其刪除，最後可用資料
總共有 2207 位患者，其中使用超過 24 小時的患者有 1655 位，而有 1099 位患者使用 PCA 裝
置超過 72 小時。每一位患者使用 PCA 裝置的狀況不盡相同，所以實驗需要患者的性別和年
齡等生理資料、手術類別和手術時間等手術相關屬性、單位小時成功按壓次數和單位小時失
敗按壓次數等使用 PCA 裝置的情況以及 PCA 裝置參數的設定，像是單位小時的鎖定時間
(lockout)設定等做為預測的依據。從彰化基督教醫院的資料庫中，我們根據患者的病歷和使
包括了透過按壓 PCA 裝置以及經由點滴方式所注射的麻醉藥。在該預測分析上，總計有
1099 筆可用資料，由於要預測的內容為患者使用 PCA 裝置 72 小時的麻醉藥總劑量，因
此患者需要使用 PCA 裝置超過 72 小時，該資料才可用於此預測分析。我們依照總劑量
多寡將所有資料分為三個區間，各區間麻醉藥總劑量的標準差類似，表示三種類別的資
料離散程度相似，將其分為低劑量(low dose)、一般劑量(medium dose)和高劑量(high 
dose)，其中低劑量的資料數量為 399 筆，而一般劑量為 551 筆，高劑量的資料數量較少，
只有 149 筆。而在屬性的選擇上，我們使用了患者的生理資料以及手術相關屬性。除此
之外，由於疼痛是相當主觀的，即使是相同身體狀況的兩人在疼痛的感受上也會有所差
異，因此單純的從身體狀況來進行預測分析是相當困難的，所以除了上述屬性外，我們
也將患者使用 PCA 裝置 24 小時期間的單位小時使用 PCA 情況和 PCA 設定相關屬性用
於此預測分析。學習演算法的部分，我們會比較決策樹(C4.5)、簡單貝氏分類器(Naive 
Bayes Classifier)、類神經網路(Artificial Neural Network)、支援向量機(Support Vector 
Machine)和決策表(Decision Table)五種學習演算法，其中除了決策樹(C4.5)以外，均是使
用 WEKA[31]做為實驗的工具。而在合體學習演算法(ensemble learning algorithm)的部
分，基於分類規則可讀性、學習速度以及預測準確度之考量下，我們以決策樹(C4.5)為
基礎演算法，搭配 bagging、random forest、bagging + stacking、random forest + stacking
和 AdaBoost 共五種合體學習演算法，並加以比較分析。 
 
(ii). PCA 劑量預測： 
PCA 劑量預測和總劑量預測類似，一樣在患者使用 PCA 裝置一段時間之後，透過
患者使用 PCA 的行為模式和患者的生理資料等，預測患者在短期未來之內會經由 PCA
裝置注射的麻醉藥劑量多寡程度，和總劑量預測不同的地方在於，總劑量預測是預測患
者經由點滴方式和透過按壓 PCA 裝置注射的總麻醉藥劑量多寡，而 PCA 劑量預測僅針
對患者透過按壓 PCA 裝置注射的麻醉藥劑量做預測。我們利用患者的生理資料和手術相
關屬性以及患者使用 PCA 裝置 24 小時期間的單位小時使用 PCA 情況和 PCA 設定相關
屬性，用以預測患者使用 PCA 裝置 72 小時的 PCA 劑量多寡程度。因此，患者需使用
PCA 裝置超過 72 小時，該資料才為可用資料，因此和總劑量預測相同，總計會有 1099
筆可用資料。 
 
(iii). PCA 裝置參數設定調整預測： 
PCA 裝置參數設定調整預測的目的則是在患者使用 PCA 裝置一段時間之後，透過
accuracy)為主要評量準則。在 PCA 裝置參數設定調整預測分析上，由於多數患者不需要參數
調整，因此有類別不平衡(class imbalance)的問題，不適合使用整體準確度作為主要評量準則，
其中我們以 positive class 作為少數類別(minority class)，意即 positive class 的患者需要 PCA 參
數的調整。因此，我們以 positive F-score 和幾何平均(geometric mean)做為主要的評量準則。 
 
(i). 總劑量預測結果： 
總劑量預測分別使用五種合體學習演算法(ensemble learning algorithm)之結果。在該預測
分析中，其中表現最好的合體學習演算法為 C4.5 再配合 bagging。我們利用 paired t-test 比較
bagging 和其餘方法的準確度。在整體準確度的表現上，C4.5 配合 bagging (80.9%) 的確優於
其餘的合體學習演算法，而且都有顯著差異。 
 
 
圖十五、 總劑量預測結果比較 
 
(ii). PCA 劑量預測結果： 
使用五種合體學習演算法(ensemble learning algorithm)對 PCA 劑量作預測之結果如圖十
六所示。在整體準確度的表現上，C4.5 配合 bagging 的確優於其餘的合體學習演算法，而且
都有顯著差異 (p < 0.05)。 
 
(b) 資料清理後 
在預測分析中，因有類別不平衡(class imbalance)之問題，我們使用 k-nearest-neighbor
演算法刪除資料中的雜訊(noise)，對資料進行資料清理(data cleaning)。資料清理後，兩
種類別的資料比例，從 81%(negative class)：19%(positive class)降為 65%(negative class)：
35%(positive class)，表示資料清理可改善類別不平衡之程度。由實驗結果觀察，所有的
合體學習演算法資料清理後在 positive F-score 和幾何平均的表現上都優於未做資料清理
的結果。我們的實驗證明，利用 k-nearest-neighbor 演算法執行資料清理(data cleaning)，
對提高分類的準確度確實是有幫助的。 
 
 
圖十八、 資料清理對PCA裝置參數設定調整預測結果之影響比較 
 
 第二部份 
患者屬性分析：由於決策樹學習演算法採行資料分割(data partition)的方法，佐以遞迴的
模式，不斷分割現有的資料集，以期搜尋最佳的分類決策樹。因此，在根部(root)所挑選的
屬性，及其他距離根部較近的節點(node)所挑選之屬性，它們所能參考的資料相較於距離葉
子(leaf)較近的節點而言，其資料量相對較多。換言之，距根部較近(且含根部)的屬性具有較
高之重要性。若以樹根為第一層，我們統計在決策樹中，在前五層中各個屬性被挑選為該階
層屬性的次數，例如：age 在決策樹集合中，被挑選為第一層屬性的頻率為多少。藉此方式
找出在 280 個屬性中，哪些屬性才是較為關鍵之屬性。接著透過統計檢定發掘屬性與預測結
果的相關性。 
-log10(p-value) 之平均，其結果為 113.1。可以證實從決策樹中挑選出的較為重要的三個時間
點的屬性，並非隨機挑選的結果，而是確實有較高之重要性。而 pcadose 的部分，我們一樣
利用單因子變異數分析(One-way ANOVA)，分析 pcadose 所有的時間點和總劑量分類結果之
相關性。決策樹中被挑選到的 pcadose 屬性則有 pcadose_9hr、pcadose_21hr、pcadose_3hr、
pcadose_19hr 和 pcadose_2hr 五個時間點的 pcadose，計算這五個屬性的 -log10(p-value) 之平
均為 11.4。利用蒙地卡羅法，從 24 個時間點中隨機挑選出五個時間點，計算隨機挑選出的時
間點之 -log10(p-value) 之平均，結果為 10.9。因此，從決策樹中挑選出較為重要的五個時間
點之 pcadose 屬性，可以證實並非隨機挑選的結果。 
在過去的文獻中[32-37]，都是以患者的生理資訊，例如，年齡、體重等，來做預測分析，
而在我們的研究中，除了使用患者的生理資訊外，還利用患者使用 PCA 裝置的相關屬性用以
預測分析，而從表二也可以看出，在總劑量預測分析中，這些患者使用 PCA 裝置的相關屬性，
的確也被決策樹挑選為較為重要之屬性。而在過去的研究中，年齡[32-34]、性別[35,36]和體
重[37]常被挑選為較為關鍵之屬性，因此，我們將這三個屬性(age、sex 和 weight)和另外三個
在過去文獻中並未被說明為較為重要之屬性(BP_HIGH、BP_LOW 和 PULSE)，分別和總劑量
分類結果做相關性分析，結果如表四所示，年齡、性別和體重的確與總劑量有較高之相關性，
我們的結果與過去文獻所載相符。 
 
表四、 總劑量預測分析，生理資訊相關 
   屬性與分類結果之相關性分析 
屬性名稱 p-value -log10(p-value) 
age 2.80551E-18 17.6  
sex 5.43466E-10 9.3  
weight 6.5477E-22 21.2  
BP_HIGH 0.768876541 0.1  
BP_LOW 0.193921887 0.7  
PULSE 0.093969073 1.0  
 
(b) PCA 劑量預測屬性分析： 
和總劑量預測分析相同，我們挑選十個分數最高之屬性，如表五所示，這十個較為關鍵
之 屬 性 大 多 為 pcadose( 患 者 經 由 點 滴 所 注 射 之 單 位 小 時 麻 醉 藥 劑 量 ) 屬 性 和
p_timediff_mean(單位小時患者按壓 PCA 裝置時間差之平均)屬性。我們利用單因子變異數分
再次驗證過去文獻的結果。 
整合以上的分析，與其它生理屬性相較，年齡、性別和體重確實與麻醉劑量有較高之相
關性，然而，本研究的實驗結果也證實，其它與 PCA 使用行為相關的屬性，例如
p_timediff_mean 等，其與麻醉劑量的相關性更形重要，我們可由表三與五看出。 
 
 表六、 PCA劑量預測分析，生理資訊相關 
  屬性與分類結果之相關性分析 
屬性名稱 p-value -log10(p-value) 
age 0.030054587 1.5 
sex 0.05039 1.3 
weight 0.000340414 3.5 
BP_HIGH 0.374544425 0.4 
BP_LOW 0.956868575 0.0 
PULSE 0.982779231 0.0 
(c) PCA 裝置調整設定調整預測屬性分析： 
在 PCA 裝置參數設定調整預測之屬性分析上，我們採行同樣的方法，計算各個屬性之重
要性分數並加以排名，十個分數最高之屬性如表七所示。 
 
表七、 PCA裝置調整設定預測分析，十個最為關鍵之屬性與分數 
 屬性名稱 分數 -log10(p-value) 
Top1 p_timediff_var_3hr 307.5 1.3 
Top2 BP_HIGH 273.7 2.8 
Top3 PULSE 178.7 2.1 
Top4 contidose_24hr 104 12.0 
Top5 p_timediff_mean_17hr 101.1 0.5 
Top6 p_timediff_var_8hr 90.9 0.5 
Top7 pcamode_set_24hr 73.4 3.2 
Top8 pcamode_set_14hr 53.2 2.1 
Top9 ansTimeDiff 53 1.2 
Top10 WEIGHT 52.7 1.0 
3. 子計畫三：iPCA 資訊網路整合系統 
第一年：在無線網路閘道器的建構方面，我們利用 RS232 介面整合 super node (coordinator)和 WiFi
網路橋接器，以將患者用藥與生理狀況經由實體 IP 網路轉送到後端的止痛管理系統做處理，並且
整合 iPCA 雛型系統及完成測詴。 
(1) 建立無線網路閘道器 
    在無線網路閘道器的建構方面，我們利用 RS232 介面整合 super node (coordinator)和 WiFi
網路橋接器；Super node 的目的在於接受來自患者用藥與生理狀況監測系統中各 Simple 
node(enddevice)所傳送之資料，並藉由 RS232 介面將資料傳輸到 WiFi 網路橋接器，經由無線
網路 IEEE802.11b 通訊協定傳送至無線區域網路存取點(Access Point，簡稱 AP)，再由實體 IP
網路轉送到後端的止痛管理系統做處理。整體之 iPCA 資訊網路整合系統架構圖如圖十九所
示。我們在無線網路閘道器建立一條通道(tunnel)，將從 Zigbee 端接收到的資料轉送至 802.11
網路介面。此外，有鑑於患者用藥與生理狀況數據之重要，閘道器之可靠度(reliability)非常重
要。我們將暫存閘道器所接收到的數據，以避免因管理系統伺服器發生意外狀況停止運作或
無線網路突然斷線時，產生數據遺失的狀況。等伺服器恢復運作時，再補送之前未成功傳送
的數據資料。 
 
 
圖十九、無線感測網路通訊系統架構圖 
 
(2) 整合止痛管理資料探勘(iPCA)雛型系統並完成測詴 
    止痛管理資料探勘系統包含止痛管理程式、患者自控止痛資料庫以及資料探勘系統。止
痛管理資料探勘系統如圖二十所示；患者疼痛用藥之數據經由無線網路閘道器傳送至管理程
式時，每一個患者對應至一個虛擬的埠口，以增加各患者資料傳輸的穩定度，並對數據做前
置處理，包括辨別數據的種類和依照資料庫欄位分析數據等。之後將處理結果儲存於患者自
控止痛資料庫中，並傳送至計畫二所開發之資料探勘系統並加以分析，醫護人員再經由管理
程式得到分析結果。在設備方面，我們使用 WiFi 基地台和交通大學的實體 IP 網路建構資訊
網路整合系統，並使用個人電腦作為止痛管理資料探勘系統的伺服器。 
(2) 增加資料傳輸的安全性 
    本系統過濾患者用藥與生理狀況監測系統所傳送過來之資訊，只有經止痛管理系統伺服
器認證過的 Simple node 所傳來的資訊才能被轉送，而丟棄其他無法辨識節點所傳送之訊息，
如此能避免接收到錯誤或惡意之資料。患者用藥與生理狀況監測系統之所有裝置必頇經過伺
服器認證，才能夠傳輸資料。考慮到患者病歷隱私權的問題，在 Zigbee 傳輸上，採用 128-bit 
Advanced Encryption Standard(AES)加密方式，而在無線網路閘道器和止痛管理系統伺服器之
間，採用 128-bit wired equivalent privacy(WEP)加密方式，以保證資料傳輸的安全性。 
 
第三年：為了減少患者往返醫院所費之人力與精力，以及避免因長期滯留醫院而引起合併症，並
且希望能提供患者一個更獨立的生活空間，本計畫第三年的主要目標是將iPCA系統推廣至居家照
護。因此我們設計出一3G網路閘道器，讓患者在家中，也能夠將患者用藥與生理資訊透過本系統
傳回至醫院，提供醫護人員最即時與最完整的資料，並透過本系統的分析與預估可提供主治醫師
做下一步醫療規劃。本計畫與彰化基督教醫院合作，在徵詢患者同意後，於居家環境做系統實地
測詴。 
(1) 3G網路閘道器 
因為現有無線網路IEEE 802.11的無線擷取技術連線距離較短，而3G網路涵蓋範圍廣，在
有3G網路訊號的地方，即可連線上網。因此，在第三年度我們設計並實作出一個連結無線感
測網路與3G網路之閘道器(以下稱3G網路閘道器)。透過3G網路閘道器即可將iPCA 系統推廣
至居家照護應用。 
iPCA居家照護架構圖如圖二十二所示，每位需要居家照護之患者，藉著我們所提供的3G
網路閘道器，可使患者於所居住的家中，將醫療裝置(患者自控式給藥裝置)與無線感測網路模
組連接並傳送資料，再經由無線感測網路模組傳送至3G網路閘道器，最後透過3G網路將患者
之用藥數據傳送至後端疼痛管理系統，可讓醫護人員時刻掌握患者最新用藥數據，可提供醫護
人員做進一步醫療規劃。 
 
為了使3G網路閘道器能有效率且可靠的在居家照護中使用，我們設計的3G網路閘道器具
有以下特點： 
(a) 自動監視網路訊號強度：因為3G網路訊號會隨著使用者離基地台遠近或是所處區域建
築屏蔽而有所影響。若訊號強度低於一臨界值，將無法連接至3G網路，使得本系統所
開發之閘道器斷線；但使用者移動到有3G網路訊號時，本系統應該迅速恢復連線。因
此3G網路閘道器必頇能自動監視3G網路訊號強度，在3G網路訊號不好發生斷線之
後，能夠不斷掃描3G網路訊號，在有3G網路訊號之後，系統能自動重新撥號連接上3G
網路。另一方面，我們也確保當3G網路閘道器開機時，能使無線感測網路模組間之網
路處於暢通狀態。 
(b) 圖形化的人機介面資訊顯示：此3G網路閘道器是由患者自行操作，因此在3G網路閘道
器上我們提供一圖形化介面，顯示3G網路閘道器連結狀態。如圖二十四所示，在螢幕
上方有各個裝置的名稱，而在左側之連結圖形代表與患者自控式給藥器連結之無線感
測網路模組與3G網路閘道器之連結情況，右側則為3G網路閘道器與3G網路連接之情
形。若是其中有連結未建立或是斷線，連結圖形會自動更新為斷線符號，讓使用者可
以清楚的掌握各裝置之間的連線情況。在下方則有目前的運作情形，可讓使用者知道
目前所執行的步驟，以及最終資料傳送的成功與否。藉由以上的顯示功能，可讓患者
能正確的進行操作，讓資料能順利的傳到後端疼痛管理系統。 
 
  
               圖二十四、3G網路閘道器顯示介面 
(2) 居家環境實地測詴 
我們與彰化基督教醫院合作，經過醫師提供專業意見後，在符合條件的居家照護患者中進
行挑選，並且經過徵求患者的同意後，讓這些使用自控式給藥器的居家照護患者，利用3G網
路閘道器進行給藥資料的傳送。首先醫護人員除了原先的患者自控式止痛裝置外還會提供患者
3G網路閘道器以及我們所開發之手持式疼痛通知裝置。然後在對患者進行患者自控式止痛裝
五、結論 
 本計畫於三年的執行過程中，已成功利用國科會及清華大學共同研發之無線感測模組建構無
線感測網路平台，並整合了一套完善的病人自控止痛整合資訊系統(iPCA)給手術後之患者使用。
此創新應用不但能讓患者自行控制PCA 給藥用量，緩解術後傷口疼痛的問題，並解除患者僅能在
醫院病床上的束縛，隨時定位患者所在位置，也能藉由無線感測網路平台將感測到的患者生理資
訊(血壓及血氧濃度)透過無線網路即時的登載於資料庫內，並經由資料探勘系統分析及預測，提
供醫護人員最即時、最完整的患者的生理訊息資料，以提供患者更完善的醫療服務品質，以保障
患者的健康與安全。此外，我們更進一步結合3G網路，將此系統成功延伸至遠距醫療照護。此系
統經過第一年於交通大學實驗室測詴，第二年於彰化基督教醫院七一護理站實地測詴，以及第三
年患者居家照護實地測詴後，證明我們的系統可實際應用於一般醫院以及遠距醫療環境。綜合以
上所述，本計畫深具前曕性、創新性，以及具有實務應用發展的潛力，本計畫的研究成果及經驗
將可提升國內之資訊與醫療整合研究之水準。 
 
 
 
 
 
 
 
 
 
 
 
 
 3. 專利申請 
第三年 
 [1] 適用於橢圓曲線加密機制之快速窗口純量乘法演算法，台灣、美國(申請中)。 
 
4. 培育人才 
年度 專任助理 博士後研究員 博士生 碩士生 
97 1 0 4 8 
98 1 0 3 8 
99 1 1 1 12 
合計 3 1 8 28 
 
 
 
 
 
 
 
 
 
 
 
 
 
. 
 
 
 
 
 
[21] Phua, C., Alahakoon, D., Lee, V. Minority Report in Fraud Detection: Classification of Skewed 
Data. SIGKDD Explorations, 6(1), pp. 50-59, 2004. 
[22] Kubat, M., Holte, R.C., Matwin, S. Machine learning for the detection of oil spills in satellite radar 
images. Machine Learning, 30, pp. 195–215, 1998. 
[23] Kubat, M., Matwin, S. Addressing the curse of imbalanced training sets : One-sided selection. 
Proceedings of the 14th International Conference on Machine Learning, pp. 179-186, 1997. 
[24] Ling, C., Li, C. Data Mining for Direct Marketing Problems and Solutions. Proceedings of the 4th 
International Conference on Knowledge Discovery and Data Mining, 1998. 
[25] Chawla, N., Bowyer, K., Hall, L., Kegelmeyer, W. SMOTE: Synthetic Minority Over-sampling 
Technique. J. Artificial Intelligence Research, 16, pp. 321-357, 2002. 
[26] Cardie, C., Howe, N. Improving minority class prediction using case-specific feature weights. 
Proceedings of the 14th International Conference on Machine Learning, pp. 57-65, 1997. 
[27] Joshi, M.V., Agarwal, R.C., Kumar, V. Predicting rare classes: can boosting make any weak learner 
strong. Proceedings of the 8th ACM SIGKDD international conference on Knowledge discovery 
and data mining, pp. 297-306, 2002. 
[28] Guo, H., Viktor, H.L. Learning from imbalanced data sets with boosting and data generation: the 
DataBoost-IM approach. SIGKDD Explorations, 6(1), pp. 30–39, 2004. 
[29] Breiman, L. Random forests. Machine Learning, 45, pp.5-32, 2001. 
[30] Wolpert, D. Stacked generalization. Neural Networks, 5, pp. 241-259, 1992. 
[31] Hall, M., Frank, E., Holmes, G., Pfahringer, B., Reutemann, P., Witten, I.H. The WEKA data 
mining software: An update. SIGKDD Explorations, 11(1):10–18, 2009. 
[32] Macintyre, P.E., Jarvis, D.A. Age is the best predictor of postoperative morphine requirements. 
Pain, 64, pp. 357–364, 1995. 
[33] Ip, H.Y., Abrishami, A., Peng, P.W., Wong, J., Chung, F. Predictors of postoperative pain and 
analgesic consumption：A qualitative systematic review. Anesthesiology, 111, pp. 657–77, 2009. 
[34] Abrishami, A., Chan, J., Chung, F., Wong, J. Preoperative Pain Sensitivity and Correlation with 
Analgesic Consumption. Anesthesiology, 114, pp.445-457, 2011. 
[35] Chia, Y.Y., Chow, L.H., Hung, C.C., Liu, K., Ger, L.P., Wang, P.N. Gender and pain upon 
movement are associated with the requirements for postoperative patientcontrolled iv analgesia: a 
prospective survey of 2,298 Chinese patients. Can J Anaesth, 49(3), pp.249-255, 2002. 
[36] Ng, B., Dimsdale, J.E., Rollnik, J.D., Shapiro, H. The effect of ethnicity on prescriptions for 
patient-controlled analgesia for post-operative pain. Pain, 66, pp. 9–12, 1996. 
[37] Pan, P.H., Coghill, R., Houle, T.T., Seid, M.H., Lindel, W.M., Parker R.L. et al. Multifactorial 
preoperative predictors for postcesarean section pain and analgesic requirement. Anesthesiology, 
104, pp. 417–425, 2006. 
 
 
  
2 
國科會補助專題研究計畫項下出席國際學術會議心得報告 
                                    日期：2011年 6 月 15日 
                                 
一、參加會議經過 
本國際學術會議由 IEEE所贊助，會議地點為匈牙利布達佩斯的 Budapest Marriott 旅館。本會議包
括兩個 Plenaries (主題是 Navigating the Mobile Data Growth - Research Challenges 及 Theoretical and 
Practical Considerations for the Design of Green Radio Networks)、兩個 Panel Sessions (主題是 Funding 
Wireless Research 及 Wireless Futures ...)及十二個 Tracks。我的論文被安排在正式會議第一天的第一
個 session發表。發表論文之後，和與會學者有一些互動。本會議參加人數非常多，我報告的會議室
坐滿了參與的學者。 
二、與會心得 
本會議每年舉辦兩次(春季及秋季)，它是 IEEE Vehicular Technology Society 的旗艦會議，期
能藉此會議與各國學者交流，以提升無線、行動及車載技術等相關領域之研究水準。它的每一篇
submitted 論文皆經由嚴格的評審。本會議的論文集收錄在 IEEE Explore。我對主題演講的綠能無線
網路特別感興趣: 新的更綠能範式包括四個 tradeoffs: deployment efficiency - energy efficiency tradeoff, 
spectrum efficiency - energy efficiency tradeoff, bandwidth - power tradeoff, 及 delay - power tradeoff.。綠
能研究愈來愈受到重視。 
 
 
三、考察參觀活動 
計畫編號 NSC 99－2218－E－009－002－ 
計畫名稱 基於無線感測網路之病人自控止痛整合資訊系統(3/3) 
出國人員
姓名 
王國禎 
服務機構
及職稱 
國立交通大學資訊工程系教授 
會議時間 
2011年 5月 15日至 
2011年 5月 18日 會議地點 匈牙利 布達佩斯 
會議名稱 
(中文) 2011 國際電機電子工程協會第 37屆車載技術會議 
(英文) 2011 IEEE 73rd Vehicular Technology Conference 
發表論文
題目 
(中文) 無線感測網路下之高效能叢集式資料散播技術 
(英文) An Efficient Cluster-based Data Dissemination Scheme in Wireless Sensor Networks 
  
4 
王國楨教授論文被接受發表之大會證明文件 
Acceptance Letter 
 
Regarding the following paper: 
 
Title: An Efficient Cluster-based Data Dissemination Scheme in Wireless Sensor Networks 
Paper: http://vtc2011spring.trackchair.com/paper/48219 
 
Dear Colleague, 
 
On behalf of the Technical Program Committee, I am pleased to inform you that the above paper has 
been conditionally accepted for <ORAL/POSTER> presentation at <CONFERENCE> in <LOCATION>. 
 
All submitted papers have been thoroughly independently reviewed. 
 
This paper is accepted contingent upon: 1) your completion and submission of the camera-ready final 
version of the technical manuscript for the paper, 2) receipt of the signed copyright form, and 3) your 
pre-registration for the conference. All of these items must be done by <FINAL_SUBMISSION_DATE>. 
 
Additionally, the IEEE Vehicular Technology Society requires that each accepted paper be presented 
in-person at the conference site according to the schedule published. It reserves the right to exclude 
from distribution on IEEE Xplore any paper not presented on-site. If none of the authors are able to 
attend, by a qualified surrogate may present the paper, and registrations may be transferred free of 
charge. 
 
Camera ready copy must be submitted to the IEEE Conference eXpress Publishing system, as they will 
be producing the final proceedings. 
 
**** do NOT upload final manuscripts to TrackChair **** 
 
Full details can be found on the conference web site at 
http://www.vtc2011spring.org/final-submission.php 
 
Reviews of your paper can be found on the TrackChair site at the URL at the top of this email, in the 
"Actions" sidebar, under "Reviews". Please take the reviewers comments into account where 
appropriate in preparing your final manuscript. 
 
Note that it is the VT Society policy that each paper must have either a full IEEE member or 
non-member registration (not a student registration). Authors submitting more than one paper must 
pay a full registration for the first paper, plus an extra paper charge for each additional paper.  If you 
only have a paper in a workshop, you may register just for the workshop if you do not wish to attend 
the main conference.  Your registration must be completed before you will be able to upload your 
manuscript to the IEEE Conference eXpress Publishing site. 
 
Thank you for submitting your paper to <CONFERENCE> - we look forward to a reunion with you in 
  
6 
王國楨教授發表之論文全文 
 
  
proposed approach. The proposed ECDD is based on a passive 
clustering mechanism to build and maintain clusters and uses a 
first declaration wins [8][9] mechanism to select cluster heads. 
With the first declaration wins mechanism, a node which first 
claims to be the cluster head will become the cluster head of its 
clustered area (in the radio coverage) and manages nodes in 
this clustered area [8][9]. The proposed ECDD does not use 
waiting periods (to make sure all the neighbors have been 
checked) [8], which is used in all other weight-driven 
clustering mechanisms, to select the best node to be the cluster 
head [8]. Once the cluster formation is finished, all nodes can 
be categorized into three types: cluster head, cluster member, 
and border node. A cluster head has the responsibility to 
manage cluster members and border nodes in its clustered area. 
A border node is a node which is in the communication range 
of two or more different clusters. The main tasks of a cluster 
member are receiving interests from its cluster head and 
forwarding sensed data that match the received interests to its 
cluster head. We make the following assumptions in the 
proposed ECDD: 
y The sink has unlimited memory, processing capability and 
rechargeable battery. That is, the energy of the sink can be 
recharged anytime [14]. 
y All sensor nodes besides the sink have the same 
processing capability. 
y Initially, the hop count of the sink is set to 0 and the hop 
count of each node other than the sink is set to the total 
number of sensor nodes in the sensor field. 
y The cluster formation is complete before any data 
gathering and transmission begins [5]. 
A. Piggybacked control information in an interest 
The piggybacked control information in the interests is used 
to set the hop count of each node for selecting an efficient data 
dissemination path and an energy threshold of each node for 
reconstructing clusters. In the proposed ECDD, we extend the 
piggybacked control information proposed by [11] by adding 
two more fields: HOP_COUNT and 
ENERGY_THRESHOLD, as shown in Figure 1.  
 
 
 Once a sensor node receives an interest, it updates a 
neighbor information table according to the piggybacked 
control information in the interest. The neighbor information 
table contains the following information: NEIGHBOR_ID, 
NEIGHBOR_STATUS, and NEIGHBOR_HOP_COUNT. 
NEIGHBOR_ID is used to identify which neighbor is referred 
by this information record. NEIGHBOR_STATUS keeps track 
of which type of this neighbor is. NEIGHBOR_HOP_COUNT 
represents the total hop counts from this neighbor to the sink. 
According to the neighbor information table, a sensor node 
selects the next forwarding node with the least hop count, and 
thus a shortest data dissemination path to forward sensed data 
back to the sink can be found. 
B. Cluster formation and data dissemination path selection 
If a cluster-based sensor network has not been initialized, 
the cluster formation mechanism will be performed. In the 
proposed ECDD algorithm, we design a novel cluster 
formation mechanism which utilizes hop count information in 
each sensor node. After the cluster formation mechanism is 
finished, the data dissemination path selection process can 
make use of the updated hop count information in each sensor 
node to select a data dissemination path from source to sink 
with low delay. 
1) Cluster formation 
Initially, the hop count of each node is set to the total 
number of sensor nodes in the sensor field. When an interest is 
propagated into the sensor field for the first time, the cluster 
formation mechanism will be performed, and the interest will 
be propagated to all sensor nodes in the sensor field. Before the 
interest is propagated into the sensor field, the HOP_COUNT 
field in a piggybacked interest will be set to the value of the 
hop count stored in the sink plus one. When a sensor node 
receives the interest, the sensor node will compare its hop 
count with the value stored in the HOP_COUNT field of the 
received interest. If the hop count value stored in the sensor 
node is larger than the value of the HOP_COUNT field in the 
received interest, the sensor node updates its hop count by the 
value stored in the HOP_COUNT field of the received interest. 
Otherwise, the interest will be discarded. Then, the sensor 
node checks whether there are more interests coming in or not. 
If the sensor node receives other interests, the sensor node 
must compare the hop count value with the value of the 
HOP_COUNT field in the recently received interests again to 
decide whether the hop count value needs to be updated or not. 
If the sensor node does not receive any more interests, it 
replaces the value of the HOP_COUNT field in the received 
interest with the value of the sensor node’s hop count plus 1. 
Finally, the sensor node sends the updated interest to other 
sensor nodes. When an interest is diffused throughout the 
entire sensor field, each node will be set a new hop count. 
 Figure 2 illustrates flowcharts of the actions taken by cluster 
heads, cluster members, and border nodes. Figure 2(a) shows 
the actions taken by a cluster head. After the cluster formation 
is finished, a cluster head will piggyback its ID, status, and the 
hop count value plus 1 into the NODE_ID, STATUS, and 
HOP_COUNT fields in the received interest. After finishing 
the update of the received interest, the cluster head then 
rebroadcasts the updated interest to its cluster members and 
border nodes. Figure 2(b) illustrates the actions taken by a 
cluster member. If a cluster member receives a modified 
interest, the cluster member will replace its hop count with the 
HOP_COUNT in the modified interest. The cluster member 
also stores NODE_ID, STATUS and HOP_COUNT minus 1 
in the modified interest to the neighbor information table.  
Figure 2(c) depicts the actions taken by a border node. If a 
border node receives a modified interest, the border node will 
compare its hop count with the HOP_COUNT of the modified 
interest. If the HOP_COUNT in the modified interest is larger 
than the border node’s hop count, the border node stores 
NODE_ID, STATUS, and HOP_COUNT minus 1 in the 
modified interest to the corresponding fields in the neighbor 
information table, then discards the interest. Otherwise, the 
 
Figure 1. Piggybacked control information in an interest. 
  
57-byte, 49-byte and 36-byte long for ECDD, ELPC, and DD, 
respectively. The initial energy of a sensor node is 10 J. The 
transmit power is 0.66 W and the receive power is 0.395 W. 
The simulation time is 1000 seconds. We evaluate each 
scheme with the following parameters: average dissipated 
energy, average delay, throughput, and the time till the first 
node death, which are defined as follows. 
 
 
z Average dissipated energy 
The average dissipated energy (Eavg) measures the ratio of 
total dissipated energy of all nodes in the network to the 
number of distinct events seen by the sink [3][4], as defined in 
equation (1). 
n
m
k k
k
avg
EfEi
E
∑
=
−
=
1
)(         (1) 
where Eik is the initial energy of the kth node, Efk is the final 
energy of the kth node, m is the total number of sensor nodes, 
and n is the total number of events. 
z Average delay 
The average delay (Davg) measures the average transmission 
time of events, which indicates the average latency between a 
source that transmits an event and the sink that receives the 
event [14]. The definition of Davg is as follows: 
n
n
i
ii
avg
TeTs
D
∑
=
−
=
1
)(
                            (2) 
where Tsi is the timestamp when the interest of the ith event is 
transmitted from the sink, Tei is the timestamp when the ith 
event is received by the sink, and n is the total number of 
events. 
z Throughput 
This metric indicates the performance of data dissemination 
by the sensor network. 
time elapse Total
packets data receivedly Successful
Throughput =            (3) 
z The time till the first node death (FND) [6] 
The FND represents the timestamp that the first sensor node 
dies due to the depletion of energy [6]. It indicates whether the 
energy consumption of nodes in the sensor field is balanced or 
not. 
B. Comparison of the proposed ECDD with DD and ELPC 
Figure 4 shows the average dissipated energy of DD, ELPC 
and ECDD. Because the ELPC protocol only floods interests 
among cluster heads and border nodes, it consumes less energy 
than DD. However, the ELPC protocol also floods the 
exploratory data messages to find a forwarding path, which 
causes additional energy consumption. The energy 
consumption of ECDD is the lowest because ECDD uses a 
cluster-based scheme to avoid the interests flooding problem 
and uses hop count information to avoid the exploratory data 
message flooding problem. Simulation results show that 
ECDD is 61.30% and 22.33% better than DD and ELPC, 
respectively, in terms of average dissipated energy. 
Figure 5 shows the average delay of each approach. In 
ELPC, the average delay is better than that of DD because 
ELPC uses clusters to reduce the number of flooded 
exploratory data messages. Although the number of flooded 
exploratory data messages in ELPC is decreased, the flooding 
problem still exists and it causes additional overheads. The 
proposed ECDD has the lowest average delay because we use 
hop count information to further eliminate flooding of 
exploratory data messages. Simulation results in Figure 5  
show that in terms of the average delay,  the proposed ECDD is 
57.45% and 23.49% better than DD and ELPC, respectively. 
Figure 6 shows the comparison of throughput. Although 
ELPC reduces the degree of the interest flooding problem by 
using clusters, which makes ELPC better than DD, ELPC still 
must flood exploratory data messages among cluster heads and 
border nodes to find a forwarding path. By piggybacking 
additional control information into interests, ECDD can 
establish clusters by sending interests from the sink. Thus, it 
has the highest throughput. Simulation results show that the 
proposed ECDD is 55.54% and 15.85% better than DD and 
ELPC, in terms of throughput. 
Figure 7 Figure 7 shows the comparison of the time till that 
the first node death (FND) among the proposed ECDD, DD, 
and ELPC. Because both ELPC and ECDD use a cluster-based 
mechanism, cluster heads and border nodes will deplete their 
energy faster than cluster members. In spite of the energy 
consumption of each node is balanced in ELPC, the amount of 
exploratory data messages will increase when the network 
scale increases. Thus, it causes cluster heads and border nodes 
to deplete their energy faster than that of the proposed ECDD. 
Simulation results show that the proposed ECDD is 71.62% 
and 24.40% better than DD and ELPC, respectively, in terms 
of FND. 
 
 
 
Figure 3. An example of how sensed data being transferred toward the sink. 
12 
 
胡毓志教授航班取消證明 
 
因美國颱風 Irene侵襲，原本胡教授前往紐約之行，航班取消，附上航班取消證明。 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
14 
 
胡毓志教授發表之論文全文 
Several studies identified the preoperative predictive factors for postoperative pain 
and analgesic consumption in various patient groups of different genders, ages or 
psychological states [8-11]. In this paper, we investigated the relationship of PCA 
demand behaviors with various patient demographic variables (e.g. age, gender, 
weight), biomedical variables (e.g. pulse, blood pressure), surgical variables (e.g. 
surgery types, duration), and PCA analgesic requirements. We tried to answer 
questions such as “Does age affect one’s PCA demand pattern during the PCA 
therapy?” The analysis of patients’ PCA demand behavior provides other information 
of PCA use than the preoperative factors for postoperative pain and PCA analgesic 
requirements. This type of information, when combined with preoperative predictors, 
can further improve postoperative pain management, and increase patient satisfaction. 
2   Materials and Methods 
2.1   Subjects 
The study was conducted at Changhwa Christian Hospital (CCH) in Taiwan during 
the years from 2005 to 2010. We restricted the study subjects to conscious 
hospitalized patients. All patients were instructed to operate the PCA device 
manufactured by Abbott (Abbott Pain Management Provider, Abbott Lab Chicago, IL, 
USA) prior to the surgery. Instructions were reviewed again before initiating PCA 
therapy. With the assistance of Acute Pain Service, we collected more than 3000 
patient records, each of which contained attributes such as basic health status, age, 
gender, weight, department code, doctor ID, PCA control parameters, amount of 
anesthetics used in different time intervals, etc. Since not all the attributes are relevant 
to our study or have correct values, after consulting the anesthesiologists, we 
discarded irrelevant attributes, e.g. doctor ID and department code, before further 
investigation. We processed thousands of medical charts and PCA log files collected 
at CCH, and obtained 1655 complete records. We divide the attributes into three 
categories: (a) patient demographic attributes, (b) biomedical attributes, (c) operation-
related attributes, and (d) PCA-related attributes. Their values are either symbolic or 
numeric. We summarized the attributes in Table 1. 
2.2   Analysis of PCA Demand Bahavior 
Given the PCA demand frequency within each unit time, we can represent each 
patient’s PCA demand profile as a time course, as illustrated in Figure. 1. The X-axis 
represents the 24-hr time scale, and the Y-axis indicates the PCA demand frequency. 
We first discovered the significant demand patterns from the time courses. By 
applying clustering algorithms, we could identify the patient groups in each of which 
the patients are expected to demonstrate a conserved demand behavior, but different 
between groups. For example, Figure 1 showed three patient groups, each consisting 
of two patients with similar demand patterns.  
**
1: intrathoracic, 2: upper intra-abdominal, 3: lower intra-abdominal, 4: laminectomy, 5: major joints, 6: 
limbs, 7: head & neck, 8: others 
  
 
 
By iterating the value of k from 2 to K, and repeating the same procedure above, 
we got different distributions of the adjusted Rand Index values. We first performed 
ANOVA to determine if there was significant statistical evidence to show at least two 
adjusted Rand Index means differed. We then conducted sequential t-tests corrected 
for multiple comparisons [18] to identify the significant gap between successive 
differences in bootstrapped adjusted Rand Index values. The most significant jump 
indicated the most likely number of clusters in the original data. 
After identifying the PCA demand patterns by the k-medoids algorithm and 
bootstrapped stability tests, we examined the association of demand patterns with 
other patient factors listed in Table 1. We ran the chi-square tests for the dependence 
of the demand behaviors on those patient attributes, and we did the ANOVA analysis 
to test whether there existed significant difference between the means of the attribute 
values among different patient groups of demand patterns.  
 
 
 
 
Fig. 1. Examples of PCA Demand Profiles. Each curve represents the distribution of PCA 
demand frequency for a patient in 24 hours. 
5 0.56(0.12) - - 
6 0.50(0.11) - - 
- - 91.66 <<0.00001 
 
Table 3.  Sequential t-tests for Successive Differences in Adjusted Rand Index Means 
Number of Clusters 
 Adjusted RI 
Mean  
Difference 
t-val p-val 
3 vs. 2 -0.07 3.63 0.00037 
4 vs. 3 -0.12 5.55 <<0.00001 
5 vs. 4 -0.06 3.32 0.00106 
6 vs. 5 -0.06 4.00 0.00009 
 
 
 
 
 
 
Fig. 2. Conserved PCA Demand Pattern 
Table 4.  Chi-Square Independence Tests between Demand Patterns and Patient Attributes, 
and Analysis of Variance in Continuous Attributes 
Attribute Name Chi-Square p-val(DF) ANOVA p-val 
Demographic:   
sex 0.0022(2) - 
age 0.11(2) 0.12 
weight 0.44(2) 0.47 
   
Biomedical:   
bp_high 0.24(2) 0.15 
bp_low 0.21(2) 0.05 
sex - 0.97 
age 0.14 - 
weight 0.16 - 
   
Biomedical:   
bp_high 0.0057 - 
bp_low 0.0010 - 
pulse 0.0092 - 
ASA_class - 0.013 
   
OP-related:   
op_type - << 0.00001 
ans_way - 0.79 
op_time 0.022 - 
urgency - 0.093 
   
PCA-related:   
PCA demand 
pattern 
- << 0.00001 
 
 
 
 
We did the analysis of variance (ANOVA) for those continuous attributes. Table 4 
showed the results of the chi-square tests and ANOVA. The test results of chi-square 
and ANOVA were consistent, except that of the diastolic blood pressure. The 
ANOVA result showed a weak difference in the diastolic blood pressure among 
different demand patterns, but the chi-square test suggested otherwise. This may be 
due to the way we discretized diastolic blood pressure. We observed a significant 
dependence between the PCA demand patterns and gender. Given the close 
relationship between demand patterns and PCA analgesic requirements (see Table 4), 
our result concurred with the previous study that reported gender was a significant 
correlate of PCA morphine consumption [8].  
Several studies have found a significant correlation between age and the dose of 
opioid required in the postoperative period [4,19-21]; however, our study only 
indicated a weak association of age with the PCA demand patterns. The age of our 
study subjects ranged from 10-93 years. As mentioned in [8], the possible causes of 
the discrepancy in the results may be related to the lack of understanding, or the 
misuse of PCA by older and younger patients. Further studies may be required and 
restricted to a narrower range of age, e.g. 20~65 years. 
Like some studies that reported no correlation between analgesic consumption and 
patient’s weight [8,22,23], we could not demonstrate a significant association between 
the PCA demand patterns and patients’ weight either. On the other hand, we noted a 
significant association between the PCA demand patterns and the surgical types and 
also surgical duration. These findings agreed with the lessons learned from pain 
management [24,25], but they conflicted with a number of studies that failed to show 
any correlation between the analgesic consumption and the surgical sites or duration 
[4,8,9]. This inconsistency may be due to the different classifications of operations, 
7.  Hu, Y. et al.: An Application of Sensor Networks with Data Mining to Patient Controlled 
Analgesia. IEEE HealthCom, Lyon, France, (2010)  
8.  Chia, Y., Chow, L., Hung, C., Liu, K., Ger, L., Wang, P.: Gender and Pain upon Movement 
Are Associated with the Requirement for Postoperative Patient-Controlled iv Analgesia: a 
Prespective Survey of 2298 Chinese Patients. Can J Anaesth, 49(3), pp. 249--255 (2002) 
9. Pan, P.H., Coghill R., Houle T.T., Seid, M.H., Lindel, W.M., Parker, R.L., Washburn, S.A., 
Harris, L., Eisenach, J.C.: Multifactorial Preoperative Predictors for Postcesarean Section 
Pain and Analgesic Requirement. Anesthesiology, 104, pp. 417--425 (2006) 
10. Aubrun, F., Bunge, D., Langeron, O., Saillant, G., Coriat, P., Riou, B.: Postoperative 
Morphine Consumption in the Elderly Patient. Anesthesiology, 99, pp. 160--165 (2003) 
11. Gagliese, L., Gauthier, L.R., Macpherson, A.K., Jovellanos, M., Chan, V.: Correlates of 
Postoperative Pain and Intravenous Patient-Controlled Analgesia Use in Younger and Older 
Surgical Patients. Pain Medicine, 9(3), pp. 299—314 (2008) 
12.Reynolds, A.P., Richards, G., Rayward-Smith, V.J.: The Application of K-medoids and 
PAM to the Clustering of Rules. In: Intelligent Data Engineering and Automated Learning, 
Lecture Notes in Computer Science, pp. 173--178 (2004) 
13.Park, H., Jun, C.: A Simple and Fast Algorithm for K-medoids Clustering. Expert Systems 
with Applications, 36(2), Part 2, pp.3336--3341 (2008) 
14.Forgy, E.: Cluster Analysis of Multivariate Data: Efficiency vs. Interpretability of 
Classification. Biometrics, 21, pp. 768--780 (1965) 
15.Dolnicar, S., Leisch, F.: Evaluation of Structure and Reproducibility of Cluster Solutions 
Using the Bootstrap. Market Letters, 21(1), pp. 83--101 (2010) 
16.Efron, B., Tibshirani, R.J.: An Introduction to the Bootstrap. Chapman & Hall, New York 
(1993) 
17.Hubert, L., Arabie, P.: Comparing partitions. Journal of Classification, 2, pp. 193--218 
(1985) 
18.Searle, S.R.: Linear Models. John Wiley & Sons, New York, USA (1971) 
19.Burns, J.W., Hodsman, N.B., McLintock, T.T., Gillies, G.W., Kenny, G.N., McArdle, C.S.: 
The influence of patient characteristics on the requirements for postoperative analgesia: A 
reassessment using patient-controlled analgesia. Anaesthesia, 44, pp. 2--6 (1989) 
20.Egbert, A.M., Parks, L.H., Short, L.M., Burnett, M.L.: Randomized trial of postoperative 
patient-controlled analgesia vs intramuscular narcotics in frail elderly men. Arch Intern Med, 
150, pp. 1897--1903 (1990) 
21.Gagliese, L., Jackson, M., Ritvo, P., Wowk, A., Katz, J.: Age is not an impediment to 
effective use of patient-controlled analgesia by surgical patients. ANESTHESIOLOGY, 93, 
pp. 601--610 (2000) 
22.Major, S.: Women get greater pain relief than men. BMJ, 313, pp. 1168 (1996) 
23.Bellville, J.W., Forest, W.H. Jr., Miller, E., Brown, B.W. Jr.: Influence of age on pain relief 
from analgesics. A Study of postoperative patients. JAMA, 217, pp. 1835--1841 (1971) 
24.Ready, L.B.: Acute pain: lessons learned from 25,000 patients. Reg Anesth Pain Med, 24, 
pp. 499--505 (1999) 
25.Preble, L.M., Guveyan, J.A., Sinatra, R.S.: Patient characteristics influencing postoperative 
pain management. In: Sinatra RS, Hord AH, Ginsberg B, Preble LM (Eds.). Acute Pain 
Mechanisms and Management. St. Louis, MO: Mosby Year Book, pp. 140--144 (1992) 
 
 
   
  
 
99 年度專題研究計畫研究成果彙整表 
計畫主持人：簡榮宏 計畫編號：99-2218-E-009-002- 
計畫名稱：基於無線感測網路之病人自控止痛整合資訊系統(3/3) 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 1 1 100%  專利 已獲得件數 0 0 100% 件  
件數 1 1 100% 件  
技術移轉 
權利金 100 100 100% 千元  
碩士生 12 12 100%  
博士生 1 1 100%  
博士後研究員 1 1 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 1 1 100% 
人次 
 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 4 5 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 1 1 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
