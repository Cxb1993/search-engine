 1
三、前言與研究目的： 
隨著社會經濟的發展與科學技術的進步，人們對安全技術防範的要求也越來越高，視
訊監控系統日益受到重視。國科會九十四年度電信學門發展規劃更將視訊監控系統之研究
列為重點目標之一。主要目的即預期目前單機式之監控系統能逐漸朝向複雜的多鏡頭整合
式及智慧型監控系統發展。另一方面，歸功於數位信號處理與網際網路技術的蓬勃發展，
數位視訊監控系統(DVR)，可即時壓縮多路視訊，錄影資訊以數位形式存放在硬碟上，或
是使用網路監控攝影機(IP camera)即時壓縮視訊，將視訊流透過有線或無線網路進行傳輸，
以進行遠端監控及錄影。本計劃將使用 H.264 編碼技術發展出一套強健性的多鏡頭視訊監
控系統，系統內包含一套最適合多鏡頭視訊監控應用的強健性自動回復抗錯機制。同時提
升對無線網際網路傳送機制的封包損失控制與網路頻寬預測能力，並強化系統整合的整體
效果。此外並在視訊內容之內加上可藉以認證解碼端視訊資料可信度之認證機制，對資料
內容之正確性的保護提出一套方法以偵測視訊內容之可靠度。 
我們的視訊監控影像使用 H.264 做壓縮，一旦某部份壓縮資料受到破壞，極可能影響
到其他影像的解碼，對於還原的視訊影像品質造成傷害。由於視訊在網路上傳送，網路的
特性與服務品質將會影響視訊接收與解碼的正確性。因此，本計劃提出一套在網路品質不
穩定的情況下，適用於 H.264 的自動回復抗錯演算法機制以及提升 H.264 網路提取層的功
能。我們研究如何在多鏡頭的視訊監控中，使用 H.264 的 SP 編碼和 SI 編碼技術，依照網
路現有情況來做視訊的切換，抑制視訊切換時所造成的錯誤。控制 H.264 的任意切片順序，
來減少即時通訊應用的延遲時間並且使用彈性巨集區塊順序以及冗餘切片技術，以提高編
碼位元流的自動回復抗錯能力。此外依據網路與視訊特性，提高 H.264 網路提取層的網路
友善性跟高抗錯性。使即時監控視訊傳輸於網路上時，在接收端能維持較佳的視訊品質。 
因無線環境中包含了許多不可預測的干擾而產生較高的位元錯誤率（BER），而封包
內任一個位元錯誤都將造成整個封包等同漏失，因此，過長的封包長度將會導致較高的封
包錯誤率（PER），另一方面，當多媒體資料改以較短的封包長度來封裝以抵抗惡劣的無
線環境時，過多的封包檔頭（Header）亦同時降低無線網路中有限頻寬的使用率，兩種情
況都對多媒體接收品質造成影響。所以，本計畫提出一套同時考慮無線網路的通道狀況、
封包檔頭的額外負荷、輪詢排程延遲、傳輸延遲與使用人數等因素之封包最佳傳輸機制，
在任何的網路環境無中，均能有效提升無線網路之頻寬使用率。 
當傳輸封包發生錯誤時，目前最常使用的解決方案就是 MAC 中的自動重送機制
（ARQ）。但是當 ARQ 機制應用於即時性多媒體資料時，可能造成多媒體資料之時間延
遲過大，導致封包失效。因此，ARQ 機制並不能無限制地使用於即時性的多媒體應用。本
計畫提出一套共享式自動重送機制，其可依據無線環境的通道現況，動態地分配有限的重
送次數給不同重要性之視訊封包，以提供較高的保護層級給較重要的視訊封包，進而達到
較佳的接收視訊品質。 
第三部份分析視訊監控資料內容之統計特性，提出適用於視訊監控資料內容之認證資
訊。在視訊內容之中加入認證機制以利偵測視訊內容可能遭受的修改攻擊。設計演算法使
認證機制在在網路端可能造成錯誤時仍能有效發揮其保護內容正確性之功能。 
 3
 QoS 監測器(QoS Monitor) 
監測在客戶端收到封包的統計資訊(如：封包遺失率、封包延遲時間)，並將此資訊
傳到回傳控制機制作處理。 
 回傳控制機制(Feedback Control Mechanism) 
將從 QoS 監測器所獲得的資訊，利用 RTCP 協定回傳到視訊伺服端的 TFRC 區塊
並作相關之處理。 
 封包解封裝器(Depacketizer) 
將視訊封包還原成原本之視訊資料。 
 抗錯性解碼器(Error Resilient Decoder) 
具有抗錯機制之視訊解碼器，可對於視訊封包的遺失或錯誤作一些處理，使其仍
可解碼出視訊資料。 
 
第二年針對多鏡頭視訊監控系統發展出一套適用在高錯誤率、可用頻寬高變動性、頻
寬資源有限與欠缺服務品質保證的通信網路中的強健性自動回復抗錯機制，進一步改善視
訊品質，第二部份對資料內容之正確性的保護提出一套方法以偵測視訊內容之可靠度，保
證其作為法律依據之有效性與可行性。第三更將針對強健性網路傳送機制作深入的研究。
不同於一般的資料傳送，視訊監控系統具有即時性的要求，而一般多媒體資料在網路上的
傳送都會利用 RTP 協定來完成。因此，基於以上的討論，我們將使用 RTP/UDP/IP 來傳送
視訊監控系統的資料，並使用 RTCP 當作客戶端的訊息回傳機制，以讓伺服端能針對變動
的網路環境作相對應之處理。以下針對這三項主題的研究成果加以說明： 
 
(一) 多鏡頭視訊監控系統的強健性自動回復抗錯機制 
1.1 資料隱藏應用於錯誤防範 
本計畫中使用資料隱藏技術[1][2]，藏入當錯誤發生時可供解碼參考的資訊，我們分析
應該藏入什麼樣的資料而它對解碼端是有用的，設計一套 NNEC 演算法，用資料隱藏技術
藏入，而解碼端會將這些 NNEC 資料解出，等到有錯誤發生時，會利用 NNEC 資料做錯誤
隱藏。 
1.1.1 資料隱藏方法 
資料隱藏需要做到相容於 H.264 視訊標準，在無法變動位元資料流格式的情況下，必
須將資料隱藏在影像內並同時考量影像品質與位元率的問題。我們提出隱藏位元的法則。
如果要隱藏的位元為 1 ，則要使得係數量化後 LEVELi 總和為奇數，反之若要隱藏的位元
為 0 ，則要使得係數量化後 LEVELi 總和為偶數，並要求以最小的代價達到上述法則。 
為了符合隱藏位元的法則我們必須改變一個 LEVELi 值並且使這樣的改變對於影像品
質的損害最小。亦即改變重建值 RECi 因而產生新量化誤差。我會從 15 個 AC 係數中找到
一係數使得改變 LEVELi 後的新量化誤差最小。 
1.1.2 移動向量分析 
錯誤發生的情況下，錯誤隱藏最常見是利用時域上來做補償，而 H.264 有多張畫面可
參考，更適合拿來做錯誤隱藏，原理是猜測出遺失掉區塊的移動向量。我們分析一個區塊
和臨近區塊的關係，在解碼端利用這些移動向量還原遺失的移動向量。我們利用 inter 區塊
提供的資訊作分析，編碼模式、移動向量差量和係數值，當解碼端完整的解出時，會得到
這一區塊所有的移動向量和參考畫面。  
 5
2. 在模式決策中，記錄最佳的編碼模式、移動向量和參考畫面。 
3. 一張畫面編完，利用記錄的資訊，比對臨近的區塊，找出需要藏入的 NNEC 資料。 
4. 將同一個 slice 的 NNEC 資料轉換成一串二進位流。 
5. 利用資料隱藏的技術，將一個 slice 的二進位流藏入其他的 slice。 
6. 然後假設區塊遺失，去做錯誤隱藏。 
7. 接著每一張像素都要計算，並用之前推導出來的方程式不斷遞迴的更新其值。 
解碼端： 
1. 如果 slice 沒有遺失就照標準的 H.264 解碼流程，解出編碼端藏入的 NNEC 資料。 
2. 假如封包發生錯誤，這個 slice 就跳過不解，並記錄下遺失 slice 的位置。 
3. 當整張解完後，從外往內開始對區塊進行錯誤隱藏。 
4. 假如遺失區塊的 NNEC 資料正確解出，那就用它來還原編碼模式、移動向量和參
考畫面。 
5. 如果 NNEC 資料也不見了，那就用 H.264 進行錯誤隱藏。 
 
(二) 多鏡頭視訊監控系統之無線網路最佳封包長度 
當我們的監控視訊經由 IP camera 壓縮後於無線網路傳輸至 Server 端，由於無線網路
的訊號易受外來雜訊干擾及本身信號衰減的因素而造成封包錯誤的情況。而封包長度不僅
會改變在無線網路上傳送時的錯誤率，同時也會對於有效頻寬使用率造成影響。再加上
MAC 本身檔頭的額外負擔與傳送時所需的等待時間影響實際網路的可用頻寬。本計畫將
提出一套決定最佳封包長度的機制，以使得無線網路的有效頻寬使用率最佳化。 
2.1 無線網路之錯誤模式分析 
無線區域網路通常具有叢集錯誤之特性[3]，而隨機亂數模型並無法描述此狀況。因
此，Gilbert 在[4]中提出 Gilbert 模型（Gilbert Model），因為此模型具有考量叢集錯誤而被
其後許多文獻[3][5]運用於模擬無線區域網路的錯誤型態（Error Pattern）。在文獻[5]中則提
出簡化的 Gilbert 模型（Simplfied Gilbert Model），其分別假設通道良好狀況下無位元錯誤
機率，而通道不良狀況下位元錯誤機率為 1。 
然而 Gilbert 模型中的狀態轉移機率參數並無法直接描述叢集錯誤情形。因此在[6]
中，將原先 Gilbert 模型中的四種參數轉換成平均位元錯誤率（Average Bit Error 
Rate；    ）、平均叢集錯誤長度（Average Burst Length；  ）與平均位於狀態 B 之穩態機
率（Duty Cycle；  ）等，如： 
, ,BER good BER bed
BER
q P p P
P
q p
⋅ + ⋅= +  , 
1b
q
=
 , 
1 ,
pDuty Cycle P
p q
= +          (2.1) 
在[7]中，則提到在簡化的 Gilbert 模型為假設前提下，如何找出平均位元錯誤率、平
均叢集錯誤長度與平均封包錯誤率之間的關係，如： 
( ) ( )
( ) ( )
1
1
1
1 1
      1 1 1
1
P H
BER
P H
BER
BER
BER
p q q pP p
p q p q
PP
P b
+ −
+ −
⎧ ⎫− ⋅⎡ ⎤⋅⎪ ⎪= − + ⋅ −⎨ ⎬⎢ ⎥+ +⎪ ⎪⎣ ⎦⎩ ⎭
⎧ ⎫⎡ ⎤⎪ ⎪= − − ⋅ −⎢ ⎥⎨ ⎬− ⋅⎢ ⎥⎪ ⎪⎣ ⎦⎩ ⎭         (2.2) 
BERP b
1P
 7
( )6 2nb b SIFS bar ba b hHc n n T T T n TR= ⋅ + + ⋅ + + + ⋅    (2.6) 
對封包之資料長度微分並令其為零，化簡後可得到封閉解（Closed-Form） 
( )26 2 6 2 2 6
2
ln ln 4 ln
2 ln
b
opt
b
R c c R c c n c c R
P
n c
− ⋅ ⋅ − ⋅ ⋅ − ⋅ ⋅ ⋅ ⋅= ⋅ ⋅     (2.7) 
此封閉解亦可同時滿足於隨機位元錯誤與叢集位元錯誤的無線網路環境中。但此式只
適用於單使用者的網路環境。而此值亦為減掉 RTP/UDP/IP 層檔頭後的封包長度。 
(三) 基於資料內容之認證 
 視訊資料內容在網路上傳送，除視訊本身可能因為錯誤發生而造成資訊遺失，由於數
位信號易於被修改的特性，亦有可能被蓄篡改。因此如何保護重要的視訊內容之研究相繼
被提出[8][9][10]。 
3.1 視訊監控資料內容分析: 
對於監控系統所取得的視訊資料，可利用 H.264 壓縮標準下所得到的資訊做分析
[11][12]。我們利用所得之移動向量統計特性，提出適用於視訊監控資料內容之認證資訊。 
在計畫中我們統計一張畫面中每個區塊的移動向量，計算所有移動向量之平均值與變
異量。移動向量的平均值可代表單張畫面內物體移動方向的趨勢，當監控視訊的有效內容
遭到修改，如車輛或人物等前景部份往不同方向移動，所得的統計值即不同。此外，我們
計算變異數目的是定義出一張畫面變動量的大小，當有物件被移入或移出單張畫面時，此
變異量就跟著改變，我們即可判定畫面是否遭受的修改。 
3.2 認證資訊 
    針對不同視訊內容我們所得到上述的認證資訊亦不同。但由於視訊資料本身在傳輸與
應用的過程中，即使未遭受任何篡改，亦可能使用以重新計算統計值的資料與原始資料有
所不同。我們所提出的方法，其統計移動向量的平均值與變異量，即使傳輸中造成視訊品
質下降，但只要結合計畫中錯誤隱藏的機制，對於所得的移動向量並無太大影響，因此所
得到的統計特性數值並無太大差異，仍可藉以認證有效的視訊內容。此外，視訊若經過再
壓縮，在不同的量化參數下，壓縮結果所得到的移動向量資訊亦不會有過大的變動，因此
統計移動向量的平均值與變異數，經加密保護後與視訊一起傳送，可在接收端用以對收到
的視訊作有效認證。 
 
 (四) 結論 
     本計畫提出一套適用於無線網路的強健性自動回復抗錯的多鏡頭監控系統。結合資料
隱藏與模式決策技術以達到抗錯功能，編解碼架構圖如圖三。如圖五與圖六所示，我們所
提出的錯誤隱藏機制，在低位元率與不同錯誤率底下，與其它的方法作比較，可達到不錯
的效能。在網路端，我們進一步提出以不同封包長短，來達到降低網路環境不佳所造成的
錯誤影響，並使網路之有效頻寬使用達到最佳。模擬結果如圖八 所示，其表示位元錯誤率
在 2*E-4 及不同叢集錯誤長度的網路環境中，不同長度的封包大小所得到的有效頻寬使用
量。實線部份代表理論分析的結果（〝anal〞）；虛線部份則表示模擬測試的結果（〝sim〞）。
比較理論分析及模擬測試的結果可發現，利用圖七所決定的最佳封包長度將得到最大的有
效頻寬使用量。因此，可驗證本計畫所推導而得之最佳封包長度與實際模擬結果相符合，
並能得到最大的有效頻寬使用量。最後統計視訊資料內的移動向量，作為認證資料，由於
 9
 
圖(一) 視訊監控系統架構及流程圖 
 
圖(二) 模式決策 
 
Transform Quantization
Entropy
coding
Inverse
Quantization
Inverse
Transform
Motion
Estimation
De-Blocking
Expected Decoder
Pixel Distortion
INTRA
INTER
Frame Store
Expected
Decoder Pixel
Mode decision
Motion
Compensation
NNEC
Concealment
NNEC Data
Data Hiding
Record
Coding Mode, 
MV and Ref
NAL
Channel
      
Entropy
coding
Inverse
Quantization
Inverse
Transform
De-Blocking
INTRA
INTER
Frame Store
Motion
Compensation
NNEC Error
Concealment
NNEC DataRestoring by NNEC Data NAL
Intra
Prediction
Channel
 
圖(三)整合資料隱藏與模式決策技術之編解碼架構圖 
 
2007 消費型電子會議 
張寶基 
國立中央大學電機系 
          年    月    日 
會議期間及地點 12-14 January, 2007        Las Vegas, Nevada, USA 
會議名稱 (中文) 2007 消費型電子會議 
(英文) IEEE International Conference on Consumer Electronics 
發表論文題目 (中文) 生物樣板保護: 金鑰混合樣板法 
(英文) Biometric Template Protection: A Key-Mixed Template 
Approach 
 
一、參加會議經過 
 
     2007 年的消費型電子會議於一月十二日至十四日在美國內華達州拉斯維
加斯國際會議中心舉行。此會議為 IEEE之年度盛會，該會舉辦地點與全球最大
之消費電子展 Consumer Electronics Symposium (CES)相同，日期接續於 CES之
隔日，期望能夠吸引參予 CES之參展人員接續與會。  
 
    消費型電子會議，同時有四個平行會議(parallel sessions)舉行，分屬下列十
一個領域 : Image/Video Signal Processing，Image/Video Codecs，Image/Video 
Distribution，Audio，A/V Recording，Human-Computer Interaction，Display 
Devices，RF & Wireless，Networking，Security & Rights Management，Other 
Consumer Technology/Applications。每一個領域各有 1至 4個 sessions，分別在三
日之中進行。由於會議地點位於 CES 相同會議中心，日期接續於該展覽，吸引
眾多參展高科技公司參加，使得整個會場非常熱鬧。整個會議之重點也成為強調
技術、應用、與系統之結合，具有相當之實用性。 
 
    本人主要參加隸屬於 Image/Video Distribution 之  Security & Rights 
Management session。Security 與 User Authentication 隨著生物特徵認證技術與
Internet 應用之大量成長而日形重要。在本會議中針對此有一 Session”User 
Authentication”，共有五篇口頭論文接受並且發表，吸引眾多聽眾。本人在會議
