- 2 -
（Arkun 等人 , 1997；Azimzadeh 等人 ,
2001；Özkan等人, 2003）。本研究之多重
模式只需以簡單的低階、線性模式內插組
合 PID型式的控制器即可。此具有增益排
程（Bisowarno等人, 2003；Rugh與 Shamma,
2000）型式的非線性控制器足以處理如生
化程序強烈非線性的問題。建立多重模式
的分析中也可以獲得一個簡易的控制器設
計規則，以避免計算負擔以及信號回饋的
問題。
三、大腸桿菌發酵程序概述
微生物的生長與產物釋出隨培養環境
的物理因素與化學因素改變。結構化模型
（structured model）乃針對某一特定之有
機物發酵行為作詳細的描述。以控制工程
角度而言，此種模型過於複雜，難以利用。
非結構模型（unstructured model）以細胞
數目、質量或濃度等巨觀地描述生物之動
態關係，此模型通常較簡單，因此經常被
引用於控制器的設計。
本研究欲探討的大腸桿菌生長模式如
（曾彥道, 2005）所引用，以（Åkesson等
人, 1998）所提出之模式，並加入（Xu等
人, 1997）所提出模式之中的醋酸抑制項加
以合併，其生長模式如下:
Sk
Sq
Afq
s
s
s 

max
)( (1)
 mcsm qqq ,min (2)

iak
A
Af
,
1
1


(3)
If critss qq  , then
0paq (4)
 
,max
max
/ /
/
min
c
a
ac
a
o s m o s m o m
o a
q A
k A
q
q q q Y q Y
Y
 
       
  
(5)
  aocamomsomso YqYqYqqq ///  (6)
  axcaoxsxms YqYqq //  (7)
If crits sq q , then
  momsomcritsoo YqYqqqq //max  (8)
0caq (9)
  sacritsspa Yqqq / (10)
    fesxcritssoxsxmcrits YqqYqq //  (11)
其中
S :碳源基質濃度。
A :副產物醋酸濃度。
sk :飽和常數。
mq :維持生存之基質攝取速率。
,a ik :醋酸抑制常數
ak :醋酸飽和常數
sq :碳源攝取速率。
c
aq :大腸桿菌對醋酸的比消耗速率。
,maxc
aq :最大醋酸消耗速率。
p
aq :醋酸的比生長速率。
max
oq :最大氧氣攝取速率
μ:大腸桿菌的比生長速率。
ox
sxY / :在好氧環境下消耗每單位[克]的基質
所生成之單位[克]生物量。
fe
sxY / :在厭氧狀態下消耗每單位[克]的基質
所生成之單位[克]生物量。
/m nY :產率係數，定義為消耗每單位[克]的 n
所生成之單位[克] m。
在此模式中，碳源攝取速率會隨碳源
濃度增加而增加，但是大腸桿菌在攝取碳
源的同時，必須攝取氧氣以代謝基質，然
而大腸桿菌的攝氧率有其極限，定為
max
oq ，在此臨界點所能代謝的最大碳源攝
取速率定為 critsq ，當碳源濃度的供應在臨
界點內時，其碳源攝取速率可以Monod模
式表示，若有多餘的攝氧量，也可代謝副
產物醋酸，使大腸桿菌產率降低。但是如
- 4 -
mass transfer coefficient﹚。
H: 修 飾 亨 利 常 數 (modified Henry’s
constant)。
最適化設計
當基質攝取速率等於 critsq 時為最適
化條件。設定基質攝取速率 crits sq q 代入
(11)式，可求得最適化比生長速率 。 *
代表最適值。
/( )
crit ox
s m x sq q Y  (18)
代入(1)式，可求得最適化基質濃度 S。
max( )
crit
s s
crit
s s
q k
S
q q

 (19)
以穩態觀念處理此系統最適化問題
時，在數學觀念上是所有狀態變數對時間
微分皆為零，也就是(12)式至(17)式皆等於
零。將代入(12)式，可求得最適化稀釋
速率D。
D   (20)
由於(13)式為零，可求得最適化大腸桿菌
濃度 X
( )in
crit
s
S S D
X
q
 
  (21)
由於(15)式為零，可求得最適化體積質傳
係數 LaK 
2
DO o
La
O DO
C D q X
K
HY C
  

 

 (22)
LaK
代入(17)式，可求得最適化氧氣傳遞速
率OTR。
 
2La O DO
OTR K HY C     (23)
由於(16)式為零，可求得最適化通氣氣體
流率Q。
2
( )in O
VRT
Q OTR
PM y Y
 
   (24)
對此連續式系統，茲考慮以下列方式
操作此程序:以稀釋速率控制碳源基質濃
度;體積質傳係數控制溶氧濃度;通氣氣體
流率則用以維持反應器內氣相之含氧分
率。然而，不可能有作動元件可直接改變
體積質傳係數，一般而言，體積質傳係數
主要受攪拌速度以及其他因素影響，但最
主要的操作條件決定於攪拌速度（N），簡
單假設其關係式如下（Åkesson 等人 ,
1998）：
 0NNK La  (25)
0, N 都是常數，因此實際操作溶氧濃度可
考慮為攪拌速度，其最適化設計如下﹕
0
LaKN N


  (26)
控制器設計結果
模擬所用參數、設計值以表一與表三
的值來描述程序，而比生長速率如(1)式至
(11)式表示。假設碳源基質濃度可量測（生
物量仍不可量測時），但存在量測器時間落
後之不確定性，共有兩個一階落後
（first-order lag）的串聯，其時間常數都
是 0.005 小時。溶氧濃度與尾氣組成的量
測則分別只有一個一階落後的量測延遲，
其時間常數皆為 0.001 小時。近似模式之
轉移函數如表四所列。三個環路的設定點
分別為：SSP=0.0113（g/L）、CDOSP=0.001
（g/L）、YO2SP=0.19。選擇 IMC-PI2D控制
器閉環時間常數分別為 CL,S =0.1 小時、
CL,DO =0.01小時以及CL,CO =0.01小時。
圖二是會引起基質雪球效應方向的參數，
可看出程序受到影響程度更為大，大腸桿
菌純度嚴重的劣化。圖三則可了解模式參
數在另一個方向不致造成基質雪球效應。
max
sq 1.0 ak 0.05
sk 0.01 mcq 0.06
iak , 5 N0 150
,maxc
aq 0.2  1.414
crit
sq 0.53
ox
sxY / 0.51
max
oq 0.01
fe
sxY / 0.15
aoY / 0.55 axY / 0.4
moY / 1.07 saY / 0.55
soY / 0.5
表一、穩態值
- 6 -
點附近震盪。至於最後輸出時權重的取
捨，則採取下列的方式:





 R
i
i
R
i
ii
g
pg
p
1
1 (29)
i代表第 i個規則， ip 代表在第 i個規則之
下，所需作動的調整， ig 代表第 i個規則
(配對)的歸屬程度。將上述之模糊邏輯串
級在基質環路之外，以此動態搜尋設定點
的方式以企圖逼進系統的最佳值。
D
-0.0003-0.0002-0.00010.0000 0.0001 0.0002 0.0003

 D

0.0
0.2
0.4
0.6
0.8
1.0
1.2
LN SN Z SP LP
N
-6 -4 -2 0 2 4 6

 N

0.0
0.2
0.4
0.6
0.8
1.0
1.2
LN SN Z SP LP
Sset
-0.040 -0.030 -0.020 -0.010 0.000 0.010

 S
se
t 
0.0
0.2
0.4
0.6
0.8
1.0
1.2
LD MD SD Z I
圖四、 隸屬度函數(membership function)
D
LN SN Z SP LP
LP LD MD Z I I
SP MD SD Z I I
Z Z Z Z Z ZN
SN I Z Z SD MD
LN I I Z MD LD
表五、模糊規則庫(fuzzy rule base)
以下將設計的模糊邏輯規則串級至
基質環路之外，在基質濃度、溶氧濃度及
氣相含氧分率有量測雜訊下，解決基質濃
度設定點的問題。圖五是針對所有會引起
失控反應的模式誤差同時發生的狀況下，
也可以使基質濃度達到在該模式誤差下應
該有的最佳值，同時使得大腸桿菌濃度增
加。在所有另一個方向的模式誤差同時發
生的狀況下，可以使基質濃度更快速的達
到在該模式誤差下應該有的最佳值 (圖
六)。
time(h)
0 5 10 15 20 25 30
S
(g
/L
)
0.004
0.006
0.008
0.010
0.012
0.014
0.016
time(h)
0 5 10 15 20 25 30
X
(g
/L
)
32
34
36
38
40
42
44
46
optimal
PI2D
Fuzzy
time(h)
0 5 10 15 20 25 30
C
D
O
(g
/L
)
0.0008
0.0009
0.0010
0.0011
0.0012
time(h)
0 5 10 15 20 25 30
N
(r
pm
)
1400
1500
1600
1700
1800
1900
2000
time(h)
0 5 10 15 20 25 30
Y
O
2
0.180
0.185
0.190
0.195
0.200
time(h)
0 5 10 15 20 25 30
D
(1
/h
r)
0.12
0.14
0.16
0.18
0.20
0.22
0.24
0.26
0.28
0.30
time(h)
0 5 10 15 20 25 30
 
-0.006
-0.004
-0.002
0.000
0.002
0.004
time(h)
0 5 10 15 20 25 30
 
-140
-120
-100
-80
-60
-40
-20
0
20
40
圖五、 %20 (D), %20 ( critsoxsx qY ,, / )
模式誤差時的閉環響應
- 8 -
[B]/[A]
0.0 0.2 0.4 0.6 0.8
pH
3
4
5
6
7
8
9
10
圖七、各 pH值下的程序增益
pH
3 4 5 6 7 8 9
K
p
0
100
200
300
400
500
600
圖八 pH程序增益
下表七整理了控制環路的設計，其中
前三個環路的控制器調諧法則採用與前述
相同的 IMC-PI2D 控制器，並加入了第四
個環路 pH環路，採用 IMC-PI控制器。
環
路
作動
變數
控制
變數
控制器
型態
1 D S PI2D
2 N CDO PI2D
3 Yin YO2 PI2D
4 Fbase
pH PI
表七、控制器環路
模糊邏輯搜尋
在饋料批次程序中，基質流率與攪拌
速度不像連續式程序會達到一個平穩的
值，不利於模糊控制的設計。此處將只用
一個環路的輸出(pH 環路)來設計模糊邏
輯(如表八)。
Fbase
LN SN Z SP LP
LP Z Z Z LD MD
SP Z SI Z MD SD
Z SI MI MI MD SDFbase
SN SI MI LI MD SD
LN MI LI LI SD Z
表八 模糊規則庫(fuzzy rule base)
其想法為: 若 pH 值小於 7(此時回饋的
Fbase>0)，代表此時系統正在發酵產
酸，亦即代表碳源基質濃度超過最佳值，
設計將碳源基質濃度下降逼近最佳操作
點；若 pH 值大於 7(此時回饋的
Fbase<0)，代表此時系統還在好氧狀
態，亦即代表碳源基質濃度尚未達到最佳
值，設計將碳源基質濃度上升逼近最佳操
作點。而每次回饋的 Fbase之間的差
( Fbase )則用來決定碳源基質濃度變動
的多寡。
圖九、 %20 (F), %20 ( critsoxsx qY ,, / )
模式誤差時的閉環響應
以下將設計的模糊邏輯規則串級至基質環
路之外，在 pH 值有量測雜訊時解決基質
濃度設定點的問題。圖九是針對所有會引
起失控反應的模式誤差同時發生的狀況
tim e(h)
0 5 10 15 20
S
(g
/L
)
0.000
0 .005
0 .010
0 .015
0 .020
tim e(h )
0 5 10 15 20
F
(L
/h
)
0
20
40
60
80
op tim al
P I2D
Fuzzy
tim e(h)
0 5 10 15 20
X
(g
/L
)
0
10
20
30
40
50
60
tim e(h )
0 5 10 15 20
X
V
(g
)
0
2000
4000
6000
8000
10000
12000
14000
tim e(h)
0 5 10 15 20
pH
6.6
6 .8
7 .0
7 .2
7 .4
tim e(h )
0 5 10 15 20
Fb
as
e(
L/
h)
0.0
0 .5
1 .0
1 .5
2 .0
2 .5
3 .0
