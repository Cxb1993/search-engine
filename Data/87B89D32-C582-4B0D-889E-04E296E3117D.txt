支援WiMAX、WLAN、與 3G之異質網路的整合式身分驗證機制之研究 (NSC 95-2221-E-415-004)
2
目錄
1. 前言........................................................................................................................3
2. 研究目的................................................................................................................3
3. 文獻探討................................................................................................................3
4. 研究方法................................................................................................................4
5. 研究成果................................................................................................................6
6. 結論......................................................................................................................10
7. 參考文獻..............................................................................................................11
8. 計畫成果自評......................................................................................................11
支援WiMAX、WLAN、與 3G之異質網路的整合式身分驗證機制之研究 (NSC 95-2221-E-415-004)
4
要重新建置後端的認證系統，利用 EAP-SIM 的方法將可以享有直接運用電信網
路己經建置好的後端認證系統及擁有廣大客戶群的優勢。但使用本方法進行認
證，WLAN系統端必需要有額外的設備與 GSM網路做連結，因此將會提高使用
者與網路端的成本。此外 EAP-SIM 的方法，沒達到有雙向的身份驗證，只能夠
驗證使用者端的身份，無法驗證網路端的身份，因此在安全性上，仍有不足。
3.2 3G
3G 的身份驗證方法是採用 3GPP 所提出的 AKA (Authentication and Key
Agreement Protocol)。其身份驗證方式，主要是沿襲 GSM的架構，利用 USIM卡
來進行身份驗證，但是改進了 GSM原本的單向驗證方式，不僅讓網路系統端驗
證使用者的身份，也讓使用者端可以驗證系統端的身份，藉此也提高了安全性
[4]。然而，為了提高安全性，AKA 的身份驗證方式也較 GSM 需要做更多的計
算，並產生更多的訊息。
3.3 WiMAX
WiMAX的身份驗證機制主要是採用公開金鑰密碼系統，因此需要配合公開
金鑰基礎建設(PKI)的建置，使每一個服務請求者都有一個由設備業者或是系統
業者所提供的使用者憑證。在WiMAX系統中，基地台(Base Station，BS)將會提
供連線和認證服務請求者的服務。因此，BS 會利用使用者的憑證內的公開金鑰
加密要傳送給服務請求者的金鑰，如果服務請求者能夠正確的使用 BS所傳送的
金鑰，則表示服務請求者通過身份驗證。然而在WiMAX的身份驗證方法中，與
EAP-SIM 有同樣的問題，那就是沒有做到雙向的身份驗證，在整個認證的程序
中，只有 BS 認證服務請求者，而服務請求者沒有認證 BS，因此服務請求者將
無法辨識假冒的 BS。此外，WiMAX的身份驗證機制使用到公開金鑰密碼系統，
消耗的計算資源將會較其它方法高[5]。
經由上面的介紹，我們可以了解到，目前無線網路的身份驗證機制，不但沒
有統一的身份驗證方式，其身份驗證的安全強度也不一致，且訊息的交換次數與
消耗資源都不夠精簡，而訊息交換與計算都會增加身份驗證的延遲時間，因此目
前無線網路的身份驗證機制，皆不適合應用於異質多網的環境。
4. 研究方法
接下來將依序就本研究所提出的方法，進行環境假設、研究架構做介紹。
4.1 環境假設
由於目前無線異質網路尚未有良好的整合應用環境，因此本研究將以目前的
發展趨勢為參考，提出研究的環境假設。就目前無線網路硬體通訊技術的發展而
言，現在的情況還是每一種不同的網路接取服務就需要不同的硬體模組，仍未出
現整合多種不同的無線通訊模組的硬體。然而在無線異質多網的環境中，若是要
使用多種不同的網路接取服務，就必需具備所有網路接取服務的通訊界面。因此
本文針對目前的發展趨勢合理的假設：
環境假設一：行動用戶手持裝置的無線通訊模組，有能力存取無線異質多網
支援WiMAX、WLAN、與 3G之異質網路的整合式身分驗證機制之研究 (NSC 95-2221-E-415-004)
6
資料與金鑰交換的訊息都傳送給行動用戶，行動用戶得到這些訊息後，就可以開
始計算共享的金鑰與身份驗證憑證…等。以減少進入新網域後所需花費的計算時
間。
4.2.4身份驗證
行動用戶進到候選網路中的某個新網域(其 AS以 ASni表示)之後，只要提供
足以證明自己身份的身份驗證憑證(Authentication Token，以下簡稱為 AT)，並且
確定 ASni與行動用戶所用的加密金鑰是同一把，這樣就完成身份驗證的程序了。
5. 研究成果
為了要達到無縫的身份驗證，本研究提出預先驗證的方法來縮短身份驗證的
延遲時間。預先驗證的方法，主要是利用 ASo，來幫助行動用戶向候選網域的
AS 做預先驗證，然而並不是所有的情況都能使用預先驗證的方法。例如：行動
用戶剛開機正要連上網路，沒有任何所謂舊網域的身份驗證伺服器(即 ASo)與行
動用戶建立信任的關係，也就沒有 AS幫MN做過預先驗證。因此不同的情境下
需要不同的身份驗證方法，為了要讓系統整體能有相同的安全強度，本研究將提
出兩種身份驗證方法，分別為非預先驗證(Protocol-I)與預先驗證(Protocol-II)這兩
種方法。
5.1 非預先驗證 Protocol-I
本研究所提出的 Protocol-I主要是應用在MN無法找到 ASo協助的情況，可
能是因為MN才剛開機、ASo當機、或是MN最後沒有進入候選網路中。由於目
前所在網域的驗證伺服器 ASn與 MN 都沒有對方的相關資訊而無法確認彼此的
身分，因此本研究將利用 MN 所註冊網路的 ASh來協助 MN 和 ASn之間做身份
驗證與金鑰交換。
以下是 Protocol-I的身份驗證流程(圖一)：
1. MN傳送自己的 IMSI給 ASn。
2. ASn收到後，利用先前假設的 Secure Channel，先用與 ASh共享的金鑰 EKn加
密MN的 IMSI、自己產生的 Diffie-Hellman金鑰交換訊息 ASn_Key_Exchange、
和要給 MN 在這個網域使用的暫時性識別碼 TMSIn。在訊息的前面加上自己
的識別碼 IDASn後，送給 MN註冊網域的 ASh。
3. ASh用 EKn解開訊息內容後，根據 MN的 IMSI找出對應的 HK，並產生一個
亂數 R，接著計算用來驗證彼此身份的金鑰 AKh、用來加密與 ASh通訊資料的
金鑰 SKh、與用來確認訊息完整性的 IKh： AKh=PRF(HK,R||IMSI)、
SKh=PRF(HK,R||AKh)、IKh=PRF(HK, R||SKh)。同時 ASh會產生一個時戳 th。
(PRF(Key, Data) 是一個含金鑰的單向雜湊函式)
4. ASh將會用一個單向的雜湊涵數計算AKh和 IDASn的雜湊值H(AKh||IDASn)做為
ASn的 AT，再計算 AKh和 IMSI的雜湊值 H(AKh||IMSI)做為MN的 AT，再用
SKh加密 IDASn 、TMSIn、ASn_Key_Exchange、H(AKh||IDASn)、 th，再計算訊
息 的 完 整 性 確 認 碼 ， MIC= PRF(IKh,
支援WiMAX、WLAN、與 3G之異質網路的整合式身分驗證機制之研究 (NSC 95-2221-E-415-004)
8
5.2預先驗證 Protocol-II
Protocol-II為完整的預先驗證，主要的應用情境是，MN要從某一個網
路要切換到另一個更適合的網路前，MN可以要求 ASo幫MN向每一個候選網路
的 AS (即 ASn1…ASnx)預先驗證，並且在MN切換到新網路之前就已經做完預先
驗證，ASo將會把所有候選網路的身份驗證資訊轉送給MN。當MN進入到某一
個候選網路後，只要證明自己就是剛剛已完成預先驗證的MN，即可完成MN與
新網域 AS間的身份驗證。
這個安全協定之所以可行是基於ASo與所有候選網路的AS彼此有建立
安全的連線且互相信任(請參閱 3.2.3)，而且MN與目前所在網域的 ASo間也已經
互相驗證過、具有信任關係，因此新網域的 AS與MN可以利用 ASo來協助驗證
彼此的身分。
Protocol-II將身份驗證的流程分為兩個部份，第一個部份是MN還沒切換到
新網域前，要求 ASo幫MN做預先驗證，ASo做完預先驗證後，回傳預先驗證的
資料給MN。第二個部份是MN切換到某一個新網路後，完成剩下的身份驗證流
程。
接下來我們將說明MN尚未切換網路前做預先驗證的訊息明細，由於 ASo
與每一個候選網域的 AS其互動流程是相同的，在這裡我們將以 ASni為例來說明
(圖二)。
M N
T M SIo ||E S K o{A set o f candidate A Ss
||M N _K ey_E xchange}||M IC
E S K o {ID A S n
i||tASo ||A S n
i_K ey_E xchange
||T M SIni} ||M IC
A S o A S n
1… A S nx
A S o
與候
選網
路的
A S
做預
先認
證
利用M N _K ey_E xchange與
A S ni_K ey_E xchange計算 M K ni
A K ni=PR F(M K ni,T M SIni)
SK ni=PR F(M K ni,A K ni)
IK ni=PR F(M K ni,SK ni)
H (A K ni||T M SIni)
H (A K ni||ID A S n
i)
利用M N _K ey_Exchange與
A S ni_K ey_Exchange計算 M K ni
A K ni=PR F(M K ni,TM SIni)
SK ni=PR F(M K ni,A K ni)
IK ni=PR F(M K ni,SK ni)
H (A K ni||TM SIni)
H (A K ni||ID A S n
i)
Secure C hannel
產生 tA So與計算M IC
ID A S o||E E K ni{M N _K ey_Exchange||IM SI}
E E K ni {A S n
i_K ey_Exchange||T M SIni}
1. 2 .
3 .
6 .
7 .
4 .
5 .
圖二、 Protocol-II 預先驗證
1. MN計算完所有的候選網路名單後，MN用與 ASo共享的 SKo將自己產生的金
鑰交換訊息MN_Key_Exchange和候選網路名單(A set of candidate ASs，其內
容為候選網路名單的 ID)加密，並在最前面加上自己的 TMSIo，再利用與 ASo
共 享 的 IKo 計 算 MIC=PRF(IKo, TMSIo||ESKo{A set of candidate
支援WiMAX、WLAN、與 3G之異質網路的整合式身分驗證機制之研究 (NSC 95-2221-E-415-004)
10
MN的 AT(即 H(AKni||TMSIni))，
如果正確無誤，MN即通過身份
驗證。之後 ASni再將自己的 AT
與 MIC=PRF(IKni,
H(AKni||IDASni))傳送給MN。MN
收到後會先檢查 MIC 的值，再
驗證 ASni的 AT是否正確。
圖三 、Protocol-II 身份驗證
6. 結論
本研究所提出的預先身份驗證方法，將身份驗證所需傳送的訊息，與需要計
算的資料都在還沒有切換網路前就先提前做完，因此行動用戶在切換到新的網路
後，身份驗證所需消耗的計算與網路成本都將減致最低，但是依舊可以維持安全
強度。本研究以進入網域之後所消耗的計算與網路成本為評估標的。
(一)、網路成本
在執行身份驗證的過程中，訊息的交換將會消耗網路成本，因此傳送的訊息
次數應該要愈少愈好。而本研究所提出的方法中，Protocol-I 所需傳送的訊息次
數為五次，但是 Protocol-I的使用情境為MN開機後初次登入網路或 ASo已經當
機的例外情況，因此，Protocol-I 不是本研究為了達到無縫的身份驗證所提出的
方法。Protocol-II的使用情境為MN已經連上網路，欲切換到更好的網路接取服
務，且 ASo已幫MN做完完整的預先驗證。Protocol-II所需傳送的訊息次數為兩
次。相較於目前其它無線網路的身份驗證方法，(EAP-SIM需要五次，3G需要五
次、WiMAX需要三次)，Protocol-II的訊息傳送次數減少了許多。
(二)、計算成本
執行整個 Protocol-I 一共需要十五次的雜湊運算、兩次指數運算、三次的對
稱式加解密、與產生一個亂數。執行完整的 Protocol-II一共需要十四次的雜湊運
算、兩次指數運算、四次的對稱式加解密。單就進入新網域的身份驗證討論
Protocol-II一共只需要兩次雜湊運算。相較於其它的驗證方法，本研究所提出的
Protocol-II消耗的網路與計算成本是明顯有比較少的。
為了要讓系統中的每一個環節都具有相同安全強度，本研究所提方法具備了
一致的安全強度所必需要符合的各項需求，包括了：雙向的身份驗證、防止身份
假冒、抗重送攻擊、資料完整性與降低阻斷式服務攻擊。
因此，本研究提出使用預先驗證，能夠縮短執行身份驗證的延遲時間，提供
異質多網的環境下無縫的身份驗證服務。
M N
ASni
1. TM SIni||H (AK ni|| TM SIni)||M IC
2. H (AK ni||ID ASn
i)||M IC
