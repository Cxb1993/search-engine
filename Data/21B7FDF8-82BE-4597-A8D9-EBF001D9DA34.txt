 2
端，當分歧線發生故障，將燒斷連結至分歧
線或變壓器的熔絲，使該區中斷供電，此時
工作人員不必利用到故障現埸查驗故障類
別，即可藉由故障指示器及通信系統提供的
資訊，判別故障原因，本計畫以台中自由變
電所地下配電系統為對象，模擬分歧線多重
故障點情況。專家系統具有邏輯推理能力，
因此已經被廣泛應用於復電排程，故障區域
的判斷，規則庫的評估和電力系統的保護等
相關領域。由於專家系統具有上述特性，因
此本計畫以專家系統為架構、圖資運轉系統
資料庫為基礎，配合由系統操作人員的經驗
而產生之搜尋程序，發展以知識庫專家系統
為架構之用戶來電電話管理系統。 
派翠網路（Petri-Net, PN）為一個強而
有力的推論機制，並且已被應用於區域復電
排程[1][2]、故障評估[3]、評估之規則庫系
統[4]及配電系統防護[5][6]。派翠網路以圖
像的方式模擬系統操作，其包括時間的選擇
及元件的次序，透過平行化及同步化的結構
模型，有系統地表示配電系統資訊及其網路
結構。為了提升搜尋故障設備的速度，必須
發展一套以配電系統資料為基礎，具備高效
率的推論工具，以協助用戶來電電話管理系
統，在本計畫中，提出以彩色派翠網路
(Colored Petri-Net, CPN)推論機為核心的
專家系統。並以台中區處自由變電所地下配
電系統為模擬對象，驗証本計畫提出之用戶
來電電話管理系統之效率。 
 
三. 用戶來電電話管理系統架構 
近年來，地下配電系統之設備數量愈來愈
多，設備種類也愈來愈繁雜，因此要在地下
配電系統中找出故障設備以恢復供電是相當
困難且費時，當意外故障事件發生時，配電
系統操作員必須在最短的時間找出導致意外
故障事件的配電設備，以便系統維修人員搶
修，為了能準確且快速的找出故障點，本計
畫提出以配電運轉系統資料庫為基礎、配合
搜尋程序，並以知識庫專家系統為架構之用
戶來電電話管理系統找尋故障設備。 
本計畫提出之用戶來電電話管理系統的
架構圖，如圖一所示，此系統以規則庫專家
系統架構為基礎，加上配電自動化資料庫
（DAS database）、拓樸分析（Topology 
process ） 及 搜 尋 程 序 （ searching 
procedures）等外部資訊，配合配電自動化
系統資料庫內含有地理位置、特性、配電系
統元件之電氣連結記錄及用戶資料，而知識
庫是由配電自動化系統資料庫擷取的資訊所
組成，並且根據電氣連結記錄及由監控及資
料收集系統所得的開關狀態，利用拓樸分析
建立配電系統網路結構，亦可說是推論機利
用電氣連結記錄及由監控及資料收集系統所
得的開關狀態，建立用戶來電電話管理系統
之配電系統網路模型；搜尋程序包含配電系
統操作員所採用之啟示性搜尋法則，以協助
推論機尋找故障點。在本計畫中，由彩色派
翠網路模型所構成之推論機為用戶來電電話
管理系統的核心，根據停電用戶來電，配合
配電系統網路模型及用戶資料庫，利用搜尋
程序尋找故障的開關保護設備；人機介面則
提供配電系統操作員更新資料庫及操作規則
的介面，使用戶來電電話管理系統在操作應
用上更為簡單、方便。 
 
 
 
 
 
 
 
 
 
A. 配電系統資料庫 
圖二為配電自動化資料庫之架構圖，配電
自動化資料庫是由停電資訊管理系統（OMS）
資料庫、用戶資訊系統（CIS）資料庫、自動
化繪圖及設備管理系統資料庫所構成。 
用戶來電電話管理系統必須先確認來電
用戶之位置，及其所屬之線路變壓器，在配
電系統中線路變壓器經由保護熔絲連接到分
歧線上，而用戶之用電量係根據用戶資訊系
統及台電系統負載特性調查研究成果，建構
出不同類型用戶於不同季節之標準化日負載
曲線，並根據線路變壓器所屬的用戶特性將
所有所有用戶每小時用電加總，即可估算出
線路變壓器的負載需求量及保護設備之電力
潮流。根據停電用戶之來電，用戶來電電話
管理系統可找出停電用戶所屬之饋線，由監
控及資料收集系統可得知故障所造成的饋線
負載變化量，並藉由比較饋線負載變化量及
保護設備之電力潮流，推測出可能的故障設
備。 
知識庫 
彩色派翠網路推論
引擎 
人機介面 
(MMI) 
搜尋程序 
停電報告 
專家系統核心 
配電自動化系統資料
庫 
圖一.  用戶來電電話管理系統架構圖 
拓樸分析 
 4
以（1）式中的第三列為例，保護設備 P1、
P2或 P3 跳脫與否將影響供電區域 SZ3 的供電
正常與否，而保護設備 P4、P5、P6及 P7的跳
脫與否則不影響 SZ3之供電。 
步驟 3.決定停電用戶共同保護設備 
根據停電用戶之來電，尋找用戶地理位置
及追溯網路連結性，找出所有來電用戶上游
路徑之共同保護設備，判斷可能之故障點，
加速工作人員檢查及維修。 
對應(1)式及圖三，如 SZ5及 SZ7的用戶故
障來電，利用上溯法找尋上游保護設備，其
LR 矩陣如(1)式所示，並由(1)式可得知 SZ5
及 SZ7之所有上游保護設備，如下所示： 
SZ5之保護設備 Set1= {SZ5→P5→P3→P2→P1} 
SZ7 之 保 護 設 備 Set2= 
{SZ7→P7→P4→P3→P2→P1} 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
從上列的上溯路徑，交叉比對 Set1 及
Set2，找出共同的上游保護設備，結果如下
所示： 
P3→P2→P1 
因此故障設備可能為 P1、P2或 P3。 
步驟 4.考慮多重故障點的情況 
停電事故並非完全由共同保護設備故障
所導致的，亦可能由多個非共同保護設備所
導致。尤其是當水災、地震或其他大規模災
害發生時，此時並非因為單一保護設備故障
而造成停電事故，而是由多個保護設備同時
故障所造成，因此為了使用戶來電電話管理
系統能處理多重故障點的狀況，本計畫利用
上溯法，從每個來電用戶位置搜尋與用戶相
關的保護設備，直到找到第一個共同保護設
備為止，並根據保護設備及用戶間之拓樸關
係（即 LR 矩陣），推算出合理的組合，這些
保護設備組合及步驟3.所得之共同保護設備
即為導致事故發生的所有可能之原因。 
就前述範例而言，重複追溯程序，其結果如
下： 
SZ5 的 非 共 同 保 護 設 備 Set3= 
{SZ5→P5→P3} 
SZ7 的 非 共 同 保 護 設 備 Set4= 
{SZ7→P7→P4→P3} 
根據 Set3 及 Set4，造成意外事件之故障設
備組合可能為（P5,P7），（P5,P4），（P5, P4,P7）。 
步驟5.增加系統準確度及計算供電區域負載
電流 
當掌握的資訊愈多時，可以使得用戶來電
電話管理系統更為可靠，當有新的用戶來電
時，根據新的資訊重覆步驟 3.及步驟 4.，以
得到新的推論結果，如此不僅能增加推論結
果的可靠度，亦可縮小預測範圍，以便工作
人員偵錯及搶修，所以用戶來電數目的多寡
與系統估測的準確度有相當大的關係。 
為了精確找出故障設備組合，必須估測所
有連結到保護設備的供電區域負載電流總
和，由於在配電系統中保護設備連接到許多
不同的供電區域，所以要利用傳統式的負載
潮流分析，估算負載電流是相當複雜且不切
實際，本計畫利用(2)式對供電區域 SZi作快
速負載預測，先計算將饋線上線路變壓器之
各相額定容量和，然後算出此額定容量和佔
整個饋線容量總和的百分比，並將由監控及
資料收集系統所得之饋線故障前電流乘上此
百分比，即為供電區 SZi 之負載電流的推估
值。 
 
phase  cor b,a,p    
1
=
⎟⎟
⎟⎟
⎠
⎞
⎜⎜
⎜⎜
⎝
⎛
⋅=
∑
=
N
i
p
i
p
ip
FD
p
i
TC
TCISL  (2) 
p
FDI : 饋線故障前，p 相的實際負載電流。 
p
iTC : 供電區域 SZi 之相變壓器額定容量總
和。 
N:饋線上供電區域總數。 
 
茲將變動負載比較程序分述如步驟 6～
步驟 9： 
步驟 6.計算保護設備 k之 p相負載電流 pkI  
將與保護設備 k 有關聯之供電區域各相
M i F d i
Substation D S 
圖.三 地下配電系統範例圖 
L l
P P
P
P
P
P
P
SZ SZ
SZ
SZ
SZ
SZ
SZ
: 四路開關 
：供電區域 
: 保護設備 
 6
 
表二  供電區彩色派翠網路模型之推論結果 
動作前狀態節點之狀態設定 動作後狀態節點之狀態設
定 
供電區 
P1 P2 P3 P1 P2 P3 
轉
移
模
式
SZ1 1000000 NC 1111111 1000000 NC 1111111 2
SZ2 1100000 NC 1111111 1100000 NC 1111111 2
SZ3 1110000 NC 1111111 1110000 NC 1111111 2
SZ4 1111000 NC 1111111 1111000 NC 1111111 2
SZ5 1110100(T) C 1111111 1110100 C 1110100(T) 1
SZ6 1110110 NC 1111111 1110110 NC 1111111 2
SZ7 1111001(T) C 1111111 1111001 C 1111001(T) 1
因為僅有 SZ5 及 SZ7 來電，故 Sa１～ Sa７
中除了 Sa5及 Sa7外，其餘狀態節點之狀態皆
為 ONE，並利用（6）式找出共同保護設備，
如下所示： 
 
 P1    P2    P3    P4    P5     P6    P7
SZ1 
SZ2 
SZ3 
SZ4 
SZ5 
SZ6 
SZ7 
∩ 
1 1 1 1 1 1 1
1 1 1 1 1 1 1
1 1 1 1 1 1 1
1 1 1 1 1 1 1
1 1 1 0 1 0 0
1 1 1 1 1 1 1
1 1 1 1 0 0 1
 1 1 1 0 0 0 0
 
 
 
 
 
 
藉由轉移節點 Tn致能動作，可找出共同路
徑上可能故障之保護裝置（狀態節點 I1～
In），不過意外停電事故有時並非由單一故
障所造成，因此本計畫提出之彩色派翠網路
模型亦考慮到多個故障點的情況，在搜尋程
序步驟 4.中，藉由上溯法得到從每個來電用
戶位置到第一個共同保護裝置間所有可能故
障的設備，並推論出可能造成停電事故的保
護設備組合（狀態節點 CO1～COm），此範例
中單一故障點的情況下，P1、P2 及 P3 為可能
的故障裝置，在多故障點情況下，(P5,P4)、
(P5,P7)為二個合理之故障設備組合，在圖五
中，狀態節點 FD 代表故障之饋線，利用搜尋
程序步驟 8.中（5）式，比較負載預測與饋
線負載變化量（轉移節點 T1～Tn及 Tc1～Tcm），
誤差量△LDk 最小者為最有可能故障之設備
或組合，誤差量最小之狀態節點（I1～In or 
CO1～COm）其對應的轉移節點將被致能動作，
並且傳遞標記到對應的目標狀態節點（Goal 
Place Node），以顯示用戶來電電話管理系
統之推論結果。 
 
三、結果 
  為了驗証本計畫所提出的彩色派翠配電
系統網路模型之專家系統，可有效提升故障
排除系統的效率，本計畫選擇台中地下配電
系統中的自由變電所作為電腦模擬的對象，
圖六所示為自由變電所的實際系統圖。由於
在實際配電系統中設備的種類及數量相當
多，因此在建構網路前便先執行節點減化的
動作，一方面可去除非保護功能的設備，另
一方面也可縮小網路規模及減少資料量。 
當颱風及洪水等天然災害發生時，有可
能導致配電系統大規模的停電，假設圖六中
Z582、Z579、Z575、Z572、Z563、Z561 及 Z587
等供電區域皆有用戶回報停電，而圖七所示
為上述用戶位置及與其相關的保護裝置。利
用上溯法，找出這些供電區之共同的保護裝
置或裝置組合，在單一故障點的情況下，
P611、P613 及 P578 為三個可能故障之設備，
而在多個故障點的情形下，則有 6 種組合為
可能之故障裝置組合，表三所示為由監控及
資料收集系統所收集之饋線故障前後的相電
流。 
若以傳統上溯法所求得之可能故障點為
P611、P613 及 P578。對於大範圍的多重故障
而言，傳統上溯法無法很精確的判斷正確之
故障位置，而本計畫所提出之故障位置偵測
的方法，可以有效地改善傳統上溯法之不
足。表四所示為 I1～I3及 CO1～CO6的誤差量，
誤差量最小的為CO1（P580, P583, P588, P562, 
P574），其△LD 為 12.5。 
 
 
Sa1 San
I1 In CO1 COm
FD
P1 Pn CP1 CPm
Ta1
T1 Tn Tc1 Tcm
Goal place nodes 
圖五  尋找故障點之彩色派翠網路推論引擎 
 8
及由監控及資料收集系統所取得的饋線負載
變化量，利用本計畫提出之啟示性搜尋規則
找出故障設備，將啟示性搜尋規則包含於由
彩色派翠網路模型所構成的推論機中，將配
電系統操作規則納入使用戶來電電話管理系
統，藉由整合系統操作規則及類平行推論能
力，彩色派翠網路可強化用戶來電電話管理
系統，在尋找可能故障之保護設備的效率，
以加強配電系統隔離故障點及恢復供電的能
力。 
為了驗証本計畫所提之用戶來電電話管
理系統效率，在本計畫中以實際的台電配電
系統作為電腦模擬的對象，由結果可發現，
無論是小規模或大規模的停電故障，彩色派
翠網路推論機為核心之規則庫專家系統皆可
有效率地推估可能的故障點。 
五.參考文獻 
[1]. Jaw-Shyang Wu, Chen-Ching Liu, Kan-Lee Liou, and Ron F. Chu, 
"A petri net algorithm for scheduling of generic restoration actions, 
" IEEE Trans. on Power Syst., vol. 12, no. 1, pp. 69-75, Feb. 1997. 
[2]. Jaw-Shyang Wu, "A petri-net algorithm for multiple contingencies 
of distribution system operation, " IEEE Trans. on Power Syst., vol. 
13, no. 3, pp. 1164-1171, Aug. 1998. 
[3]. C.L. Yang, A. Yokoyama, et al., "Fault section estimation of 
power system using color time petri nets, " Proc. of Expert System 
Application to Power Systems, pp. 321-326, 1993. 
[4]. K. Tomsovic, "Evaluation rule-based systems, " Proc. of Expert 
System Application to Power Systems, pp. 2.1-2.3, 1988. 
[5]. L. Jenkins and H.P. Khincha, "Deterministic and stochastic petri 
net models of protection schemes, " IEEE Trans. on Power 
Delivery, vol. 7, no. 1, pp. 84-90, Jan. 1992. 
[6]. F. Wang and J. Tang, "Modeling of a transmission line protection 
relaying scheme using petri nets, " 96 WM 022-4 PWRD, 
IEEE/PES Winter Meeting, Jan. 21-25, 1996 Baltimore, Maryland, 
USA. 
[7]. K. Jensen, Colored Petri Nets-Basic Concepts, Analysis Methods 
and Practice Use, Berlin, Germany: Springer-Verlag, 1992, vol. 1. 
 
 
