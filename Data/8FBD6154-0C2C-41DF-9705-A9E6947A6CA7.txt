In practice, the lognormal variables are 
approximated by a binomial random walk: 
 
 2
The purpose of our proposal is the pricing 
of a path-dependent derivative: the Asian barrier 
option. Exact polynomial-time pricing 
algorithms do not exist for this option; only 
subexponential-time exact algorithsms exist (see 
Dai and Lyuu (2007)). The purpose of this 
proposal is quadratic-time algorithm that 
converges to the true price fast.  
The payoff of an Asian option depends on 
whether the arithmetic average stock price. A 
tremendous amount of research has been carried 
out to attack the pricing problem of such options. 
See Aingworth et al. (2000), Benhamou (2002), 
Bouaziz et al. (1994),  Boyle et al. (1997), Chen 
and Lyuu (2007), Dai, Huang, and Lyuu (2005), 
Dai and Lyuu (2002, 2007), Dewynne and 
Wilmott (1995), Dubois and Lelievre (2005), 
Forsyth, Vetzal, and Zvan (2002),  Fu et al. 
(1998/9), Fusai (2004), Henderson and 
Wojakowski (2002), Hsu and Lyuu (2007), Hull 
and White (1993), Ju (2002), Klassen (2001), 
Lyuu (2002), Milevsky and Posner (1998), 
Nielsen and Sandmann (2003), Schroder (2000), 
Rogers and Shi (1995), Tavella and Randall 
(2000), Thompson (1999), Vecer (2001), Wei 
(1998), and Zhang (2001, 2003). 
As for barrier options, we have reported in 
an earlier report (NSC 94-2213-E-002-088-). 
Basically, barrier options can be efficiently 
priced. The major concern there is convergence 
behavior as we increase n. See Boyle et al. 
(1994), Boyle et al. (1998), Broadie et al. (1997), 
Broadie et al. (1999), Cheuk and Vorst (1996), 
Horfelt (2003a, 2003b), Hull and White (1993), 
Luo (2001), Lyuu (1998), Ritchken (1995), 
Schroder (2000), Toft and Xuan (1998), Wei 
(1998), and Zvan et al. (2000). 
Approximate closed-form formulas have 
been derived under various assumptions for 
Asian options. These formulas have been 
evaluated thoroughly. The general conclusion is 
that all are as good as their assumptions, and 
most lack convergence guarantees. As no simple, 
exact closed-form solutions exist yet, the 
development of efficient numerical algorithms 
becomes an important alternative. First, there are 
the popular Monte Carlo and the related quasi-
Monte Carlo methods. Both the Monte Carlo 
approach and the analytical approach suffer from 
the inability to handle early exercise without bias. 
Although Longstaff and Schwartz have 
developed a least-squares Monte Carlo approach 
to tackle the problem, a convergence proof 
remains elusive. As for barrier options, exact 
formulas are available. 
The third type of approach, the lattice and 
the closely related PDE methods, are more 
general as they can handle early exercise. The 
main challenge with the lattice method in the 
case of Asian options is its exponential nature: 
An exponential number of arithmetic operations 
seem needed for an exact evaluation. This is 
because every price path, which corresponds to a 
state (that is, the average to date, also called the 
running average), leads to a different average 
price, thus payoff as well. To reduce the 
complexity, all known practical lattice 
algorithms keep only a small subset of the states. 
When an option value for a missing state is 
called for in the pricing algorithms, it is 
interpolated from the option values of the 
neighboring states. This successful paradigm is 
due to Hull and White. We will call it the 
interpolation paradigm. The interpolation 
paradigm obviously introduces interpolation 
error, and a major concern is whether the magni 
tude of the interpolation error converges to zero. 
Pricing Asian options with 2-dimensional PDEs 
also tackles the issue of exploding state space 
with the interpolation paradigm. As for barrier 
options, linear-time algorithms are available for 
continuously sampled barrier options and 
quadratic-time algorithms are available for 
discretely sampled barrier options. 
Partition the time to maturity into n periods. 
It is well-known that a binomial lattice with n 
periods contains about  nodes. Let the 
average number of states (running averages) kept 
2 / 2n
and thus two nonlinear iterations per timestep are 
required to solve the PDE.  
三、實驗方法 
The node at time i that results from j down 
moves and  up moves will be denoted by 
. Let 
i j−
( , )N i j ( , , )B i j p  denote the probability of 
getting j heads when tossing a coin i times with p 
being the probability of getting heads. Node 
 can be reached from the root node with 
probability 
( , )N i j
( , , )B i j p . Note that 
( ) (, , 1 ji ji )B i j p p p
j
−⎛ ⎞≡ ⎜ ⎟⎝ ⎠
− . The payoff of an 
Asian option is 
1
1
+
∑=
n
Sn
i i  in discrete time, where 
Si denotes the price at time i. To be more precise, 
the payoff equals ⎥⎥⎦
⎤
⎢⎢⎣
⎡
+
∑ = 0,
1
max 1
n
Sn
i i . Here, X is 
called the strike price and is specified in the 
contract.  
Let  denote the number of states at node 
. Using Lagrange multipliers to minimize 
the errors, we find that  
ijk
( , )N i j
1/3
2 2
1/3
21
( , , )
2 ( , , )
ij
n sI
s t sI
B i j p
Ikn ik
B s t p
s= =−
⎛ ⎞⎜ ⎟⎝ ⎠= ⋅ ⎛ ⎞⎜ ⎟⎝ ⎠∑ ∑
 
The error is only . Here I is the number of 
intraday periods. 
1( )O I −
We will go from trinomial lattices to 
multinomial lattice to avoid the averaging 
problem. See Figure 1 at the end of the report for 
illustration for how to transform a trinomial 
lattice into a multinomial lattice. 
Figure 2 at the end of the report compares 
binomial and trinomial algorithms as I increases. 
There m denotes the interpolation scheme, with 
 denoting a linear scheme and  a 
cubic scheme. It is clear that trinomial lattice 
works better than binomial lattice. Figure 3 
demonstrates clearly that linear scheme matches 
cubic scheme in accuracy, consistent with the 
theory. 
2m = 4m =
Figure 4 compares our algorithm with 
Gruber (1997) and crude Monte Carlo simulation 
when the maturity is one year. Figure 5 does the 
same thing with a maturity of 3 years. Figure 6 
compares our algorithm with Zvan et. al. (1999). 
In all cases, our algorithm matches their results. 
It clearly shows the superior performance of our 
algorithm in terms of convergence and efficiency, 
especially when the volatility is high. 
 
四、結論與討論 
Our quadratic-time algorithm for Asian 
barrier options is a breakthrough in the literature. 
It achieve good convergence with a time bound 
of only ( )2O n . This is optimal. The techniques 
rely on the Lagrange multipliers and only first-
order interpolation. Numerically, it compares 
favorably with many other methods in the 
literature. 
 
五、計畫成果自評 
The results accomplish what the proposal 
set out to do. We designed an algorithm for 
Asian barrier options, analyzed it, and 
programmed it for comparison with other 
existing algorithms. The running time and error 
rate are both optimal. The method is novel and 
can be applied to other options. The comparisons 
with other methods are favorable. 
 
六、參考文獻 
Aingworth, Donald, Rajeev Motwani, and 
Jeffrey D. Oldham. “Accurate Approximations 
for Asian Options.” In Proc. 11th Annual ACM-
SIAM Symposium on Discrete Algorithms, San 
Francisco, 2000. 
Atkinson, K.E. An Introduction to 
Numerical Analysis. 2nd ed. New York: Wiley, 
1989. 
Barraquand, J., and T. Pudet. “Pricing of 
American Path-Dependent Contingent Claims.” 
Mathematical Finance, 6 (1996), pp. 17–51. 
Benhamou, E. “Fast Fourier Transform for 
Discrete Asian Options.” Journal of 
Computational Finance, 6 (1) (2002), pp. 49–61. 
 4
 6
Fusai, G. “Pricing Asian Options via 
Fourier and Laplace Transforms.” Journal of 
Computational Finance, 7, No. 3 (2004), pp. 87–
105. 
Gruber, U.M. Pricing Barrier and Asian 
Options with an Emphasis on Monte-Carlo 
Methods. Master's Thesis, Department of 
Mathematics, Oregon State University, Corvallis, 
Oregon, 1997. 
Haug, Espen Gaarder. The Complete Guide 
to Option Pricing Formulas. New York: 
McGraw-Hill, 1998. 
Henderson, V., and R. Wojakowski. “On 
the Equivalence of Floating- and Fixed-Strike 
Asian Options.” Journal of Applied Probability, 
32 (2) (2002), pp. 391–394. 
Horfelt, Per. “Extension of the Corrected 
Barrier Approximation by Broadie, Glasserman, 
and Kou.” Finance and Stochastics, Vol. 7 
(2003), 231–243. 
Horfelt, Per. “Pricing Discrete European 
Barrier Options Using Lattice Random Walks.” 
Mathematical Finance, 13, No. 4 (2003), 503–
524. 
Hsu, Wei-Yuan, and Yuh-Dauh Lyuu. 
“Convergent Quadratic-Time Lattice Algorithm 
for Pricing European-Style Asian Options.” To 
appear in Applied Mathematics and Computation 
(2007). 
Hull, John C. Options, Futures, and Other 
Derivatives. 4th ed. Englewood Cliffs, New 
Jersey: Prentice-Hall, 1999. 
Hull, John C., and Alan White. “Efficient 
Procedures for Valuing European and American 
Path-Dependent Options.” Journal of 
Derivatives, Vol. 1 (Fall 1993), 21–31. 
Ju, N. “Pricing Asian and Basket Options 
via Taylor Expansion.” Journal of 
Computational Finance, 5 (3) (2002) 79–103. 
Klassen, Timothy R. “Simple, Fast and 
Flexible Pricing of Asian Options.” Journal of 
Computational Finance, 4, No. 3 (Spring 2001), 
pp. 89–124. 
Kwok, Yue-Kuen. Mathematical Models of 
Financial Derivatives. Singapore: Springer-
Verlag, 1998. 
Luo, Lawrence S.J. “Various Types of 
Double-Barrier Options.” Journal of 
Computational Finance, 4, No. 3 (Spring 2001), 
125–138. 
Lyuu, Yuh-Dauh. “Very Fast Algorithms 
for Barrier Option Pricing and the Ballot 
Problem.” The Journal of Derivatives, 5, No. 3 
(Spring 1998), 68–79. 
Lyuu, Yuh-Dauh. Financial Engineering & 
Computation: Principles, Mathematics, and 
Algorithms. Cambridge, U.K.: Cambridge 
University Press, 2002. 
Milevsky, Moshe Arye, and Steven E. 
Posner. “Asian Options, the Sum of Lognormals, 
and the Reciprocal Gamma Distribution.” 
Journal of Financial and Quantitative Analysis, 
33, No. 3 (September 1998), pp. 409–422. 
Nielsen, J., and K. Sandmann. “Pricing 
Bounds on Asian Options.” Journal of Financial 
and Quantitative Analysis, 38 (2) (2003) 449–
473. 
Ritchken, Peter. “On Pricing Barrier 
Options.” Journal of Derivatives (Winter 1995), 
19–28. 
Rogers, L.C.G., and Z. Shi. “The Value of 
an Asian Option.” Journal of Applied 
Probability, 32, No. 4 (December 1995), pp. 
1077–1088. 
Schroder, Michael. “On the Valuation of 
Double-Barrier Options: Computational 
Aspects.” Journal of Computational Finance, 3, 
No. 4 (Summer 2000), 5–33. 
Tavella, D., and C. Randall. Pricing 
Financial Instruments: the Finite Difference 
Method. New York: Wiley, 2000. 
Thompson, G.W.P. “Fast Narrow Bounds 
on the Value of Asian Options.” Working Paper, 
Judge Institute of Cambridge, 1999. 
Toft, and Xuan. “How Well Can Barrier 
Options Be Hedged by a Static Portfolio of 
Standard Options?” Journal of Financial 
Engineering, (1998), 147–175. 
Vecer, J. “A New PDE Approach for 
Pricing Arithmetic Average Asian Options.” 
Journal of Computational Finance, 4 (4) (2001) 
105–113. 
Figure 1: 
  
Figure 2: 
 
 8
Figure 5: 
 
Figure 6: 
 
 
 10
Excess Returns, Risk Aversion and Volatility, International Asset Market Volatil-
ity, Cross Border Mergers and Acquisitions, Stock Repurchases, Corporate Gover-
nance and Pension Funding, Project Expansion, Entry Modes and Executive Op-
tion Contracts, Valuation and Culture, Compensation Incentives, Large Risks, Rat-
ings and Credit Risk, Financial Stability, Banks and Financial System Risks, Pric-
ing, Hedging, and Diversification, Institutional Ownership, Market Quality, Issues in
Takeovers, Equity Issuance, Corporate Governance, Dividend Changes, Correlated
Defaults, Bank Loan Syndication, Spreads and Failure Prediction, Asset Restructur-
ing, Mergers and Banking Efficiency, Retirement and Mutual Funds, Relationships in
Financial Transactions, Liquidity, Global and Cross-Listed Equity, Capital Budget-
ing Decisions, Cross-Border Takeovers and FDI, Banking Structure, Monetary Policy
Effects, Bank Entry and Insurance Guarantees, Board of Directors Issues, Integrated
Credit and Market Risks in Bank Portfolios, Banking Competition and Risk Assess-
ment, Asset Pricing and Valuation Theory, Optimal Portfolio Estimation, Guarantee
Fees, Insurance Purchase and Swap Risks, Trading Volume and Productivity Growth,
Small Business Investment, Valuation, Liquidity Effects and Creditor Concentration,
Bankruptcy Issues, Bank Lending and Firm Performance, Bank Margins, Mutual
Funds and Growth, Efficiency and Discipline in Emergent Banking Markets, Per-
formance in Options and Stock Markets, Decision Making by Portfolio Managers,
Portfolio and Risk Management, Governance and Culture, Volume, Liquidity and
Price Adjustments: International Perspectives, Modeling Spreads and Basis Rela-
tions, Market Quality and Information, Capital Structure, Executive Impacts, IPOs,
Compensation, Creditor Protection and Firm Value, Dividend Policy, Cost of Capital
and Firm Valuation, Bank Merger Costs and Growth, Value and Attitudes Towards
Risk, Earnings, Business Profits, Risk and Optimal Hedges, Venture Capital and
Valuation, Options Pricing, Emerging Markets and Integration, Market Microstruc-
ture Issues, Short Interest, Adverse Selection and Settlement, Earnings Management
and Coverage, Equity Pricing: Registration and Allocation Decisions, Corporate In-
vestment and Operational Risk Management, Entrepreneurs and Investment, Yield
Bonds, Returns and Recovery Rates, Risk and Profitability in Banking, Analysts:
Coverage and Independence, International Markets, Market Integration, Risk and
Country Funds, Volatilities and Risks in Markets, Mutual Funds, Cross-sectional Re-
turns, Hedging, Cross-border Acquisitions: Value and Benefits, R&D Valuation and
Advertising Expenditures, Corporate Management Issues, Corporate Events, Market
Reaction, and Litigation, Bondholder Effects, Asset Analysis, Analysts and Credit,
Currency and Hedge Funds Issues, Investment Styles and Bank Expansion Strategies,
Risk Sharing and Investment Strategy, Sin, Sin Stocks and Market Returns, Market
Impact, Credit Interest Rates and Taxes, Research and Information, Asset Allocation,
Investment Behavior, Joint Ventures, Private Capital Flows and FDI, Real Effects
of Financing, Loan Supply, Charge Offs and Net Margins, Mutual Funds, Pension
Funds and Credit Ratings Agencies, Fairness, Disclosure and Risk Assessment, Man-
agerial Sentiment and Acquisition Decisions, Anomalies Refuted, Trading, Market
2
18. Spain
19. Sweden
20. Switzerland
21. Taiwan
22. Thailand
23. U.K.
24. U.S.A.
There were at least six papers from Taiwan this year.
3 A Glimpse of the Papers
There are many papers in the Proceedings. From the talks and the printed papers,
the techniques used vary widely. Although all papers are interesting, I will focus the
report on topics that I am personally interested in because I am not an expert in
every field.
• “The Slope of Spot Credit Spread Curves”
• “The Pricing of Correlated Default Risk: Evidence from the Credit Derivatives
Market”
• “Analysis of Mortgage Backed Securities”
• “Asymmetric Impact of News on Return Volatility”
• “A Generalized Single Factor Model of Portfolio Credit Risk”
• “Analysis of the Investment Potential and Inflation-Hedging Ability of Precious”
• “Non Gaussian Diversification”
• “Default Dependence: the Equity Default Nexus”
• “Modelling Simultaneous Defaults: A Top-Down Approach”
• “Why Do Banks Securitize Assets?”
• “The Standardized Approach in the U.S.: Credit Risk Mitigation and Other Options”
• “Specification and Calibration Errors in Measures of Portfolio Credit Risk: The Case
of the ASRF Model”
4
• “Whither Finance - Trend of Financial Research in Premier Journals”
• “Estimation and Decomposition of Downside Risk for Portfolios with Non-Normal
Returns”
• “Tradeable Measures of Risk”
4 Recommendations
MFA2008 provides a gathering place for financial academic and practitioners to com-
municate their ideas and to share ideas for the advancement of the teaching and
practice of finance. There are researchers and professors from all over the world.
Every speaker spoke for 20 minutes and had 5 minutes for questions from discussant
and the audience. I found 20 minutes too short in many cases to fully understand
the paper. Some papers are original and represent significant progress in research.
5 Materials Brought Back
Proceedings of the 57th Annual Meeting of the Widwest Finance Association (MFA2008).
6
1 Introduction
A ﬁnancial derivative is a ﬁnancial instrument whose payoﬀ is based on other more
elementary ﬁnancial “assets,” such as stocks, indexes, currencies, commodities, bonds,
mortgages, other derivatives, temperatures, and countless others. The elementary
ﬁnancial instrument in this paper is assumed to be stock for convenience. With the
rapid growth of ﬁnancial markets, more sophisticated derivatives are constantly being
structured by ﬁnancial institutions to satisfy the needs of their clients.
Although ﬁnancial innovations make the markets more eﬃcient, they also give
rise to problems in pricing because only a small subset of ﬁnancial derivatives can
be priced by exact yet simple analytical formulas. Although approximation formulas
may exist for other derivatives, these formulas may potentially lead to large pricing
errors. Those derivatives that can not be valued accurately by analytical formulas
must be priced by numerical methods such as tree models. Take the barrier option for
example. A barrier option is an option whose payoﬀ depends on whether the stock’s
price path ever touches certain price levels called the barriers. Exact yet simple
analytical formulas for single-barrier options exist only when their payoﬀ functions
take certain forms (see Merton (1973) and Reiner and Rubinstein (1991)). For double-
barrier options, no simple, exact closed-form pricing formula is available. The value of
the double-barrier option can be expressed as an inﬁnite series of cumulative normal
distributions. Analytical approximation formulas for the inﬁnite series have been
studied by Kunitomo and Ikeda (1992), German and Yor (1996), Bhagavatula and
Carr (1997), Sidenius (1998), and Luo (2001). Truncation of this inﬁnite series is
necessary in practice, but it can lead to large pricing errors (see Luo (2001)). Besides,
these analytical formulas can not be easily adapted for nonstandard payoﬀ functions.
A tree model is a popular numerical method for pricing options. This approach
is ﬂexible in that an option can be priced with only nominal changes even when its
payoﬀ function is nonstandard, such as power options, for which there may not be
closed-form formulas. A tree divides the time span from now to the option’s maturity
date into n time steps and speciﬁes the stock price discretely at each time step. The
well-known CRR tree model of Cox, Ross and Rubinstein (1979) is a good example. A
simple 3-time-step CRR tree is illustrated in Fig. 1. The stock price of the root node
of the CRR tree is S0. From an arbitrary node with stock price S, the stock price
after one time step equals Su (the up move) with probability p and Sd (the down
move) with probability 1− p, where d < u and ud = 1. The option values priced by
tree models converge to the theoretical option value under the continuous-time model
as n → ∞ (see Duﬃe (1996)). Unfortunately, the convergence may not be smooth
or fast. Worse, for some options like barrier options, the convergence can oscillate
2
exercise price. Although the AMM approach is eﬃcient and fast convergent, it has a
complicated structure, which makes it hard to implement and still harder to tailor to
diﬀerent derivatives.
Barrier option pricing on a CRR tree oscillates signiﬁcantly because of the nonlin-
earity error. To handle this problem, Boyle and Lau (1994) propose using only those
n for which the CRR tree has a layer that is very close to the barrier. This method
reduces the oscillations dramatically, but raising n according to the regime sanctioned
by Boyle and Lau (1994) may not necessarily produce more accurate results accord-
ing to Ritchken (1995). Their method can not be easily adapted to handle multiple
barriers, either. This is because it is impossible to pick an n that will tailor to more
than one barrier. Derman et al. (1995) calculate the value for each hallow node (in
panel (b) of Fig. 2) by adopting L2 (equivalent to moving the barrier L outward) and
L′ (equivalent to moving the barrier L inward) as eﬀective barriers, respectively. The
value for each hollow node is then obtained by interpolating the two values mentioned
above. Hull (2000) calls L′ and L2 the inner barrier and the outer barrier.
Ritchken (1995) proposes a trinomial tree model to alleviate the oscillation prob-
lem. With a stretch parameter to tune the structure of the tree, one layer of the tree
can be made to coincide with the barrier. When pricing double-barrier options, two
separate stretch parameters are required to make two diﬀerent layers of the tree co-
incide with the two barriers. The branching probabilities of Ritchken’s trinomial tree
model can be made valid (i.e., between 0 and 1) by raising n if necessary. The value
of n can be large when interest rates are high, volatilities are low, or, most seriously,
a barrier is very close to the initial stock price (resulting in the so-called “barrier-too-
close” problem). Ritchken’s algorithm is therefore potentially very costly. Figlewski
and Gao (1999) use the AMM to solve this “barrier-too-close” problem. But no eﬀorts
have been made to extend the AMM to price double-barrier options.
To reduce the nonlinearity error, this paper proposes a simple tree model, the
bino-trinomial tree (BTT), that combines a CRR binomial tree structure and a root
node with a trinomial structure. The construction steps are (1) ﬁnding a suitable
length for the time step (∆t) of the CRR tree, (2) properly laying out the CRR
tree, and (3) locating the position of the root node and calculating its branching
probabilities. Let us use the BTT in Fig. 4 to illustrate the ideas. This BTT prices a
double-barrier option with two barriers, L and H, and with time to maturity T . It is
composed of a CRR tree (in shadow) but with the ﬁrst two time steps removed. To
position this truncated CRR tree properly, we need to ﬁx the underlying grid ﬁrst.
Note that the width of each cell of the grid equals the length of a time step of the
CRR tree. The ratio of the height and the width of each cell of the grid is a ﬁxed
4
This algorithm is then used to build an O(n)-time algorithm on BTT. Numerical
results are provided in section 5 to verify the superiority of our methods compared
with many others. Section 6 concludes the paper.
2 Basic Terms and Preliminaries
Let St denote the stock price at time t, where 0 ≤ t ≤ T . St follows the lognormal
diﬀusion process:
St+dt = St · exp[(r − 0.5σ2) dt + σ dWt], (1)
where Wt is the standard Wiener process, r is the risk-free interest rate per annum,
and σ denotes the volatility of the stock price. We assume that the option initiates
at time 0 (with stock price S0) and matures at time T (with stock price ST ). The
exercise price for this option is denoted by X.
A vanilla option gives its owner the right to buy or sell the stock for the exercise
price and does not have other unusual features. The payoﬀs of a vanilla call option and
a vanilla put option at time T are max(ST −X, 0) and max(X − ST , 0), respectively.
A barrier option is an option whose payoﬀ depends on whether the stock’s price
path ever touches certain price levels called the barriers. A knock-in barrier option
comes into existence if the stock price touches the barrier(s) before the maturity
date. On the other hand, a knock-out one ceases to exist if the stock price touches
the barrier(s) before the maturity. A single-barrier option is an option with only one
barrier, whereas a double-barrier option is an option with two barriers.
Consider a single-barrier option with barrier L. Assume that L < S0 for conve-
nience. Deﬁne Sinf = inf0≤t≤T St. The payoﬀ of a knock-out single-barrier call option
is
Payoﬀ =
{
0, if Sinf ≤ L,
max(ST −X, 0), otherwise.
Consider a double-barrier option with two barriers L and H. Assume L < S0 < H
for convenience. Deﬁne Ssup = sup0≤t≤T St. The payoﬀ of a knock-in double-barrier
call option is
Payoﬀ =
{
max(ST −X, 0), if Ssup ≥ H or Sinf ≤ L,
0, otherwise.
Finally, the payoﬀ of a knock-out double-barrier call option is
Payoﬀ =
{
0, if Ssup ≥ H or Sinf ≤ L,
max(ST −X, 0), otherwise.
6
goals.
First, we show how to choose the width of a cell to make the grid hit both H and L.
If the grid has two layers that coincide with H and L, h−
2σ
√
∆t
should be some integer k.
For example, k = 4 in Fig. 5. Suppose that we want to construct an (approximately)
m-time-step BTT. Ideally, the length of each time step is ∆τ ≡ T/m, but in really
h−
2σ
√
∆τ
may not be an integer. So instead we pick a ∆t that is close to, but does not
exceed, ∆τ and that makes h−
2σ
√
∆t
an integer. It is hence natural to pick ∆t =
(
h−
2κσ
)2
,
where κ =
⌈
h−
2σ
√
∆τ
⌉
. Lay out the grid from barrier L upward. Automatically, a layer
coincides with barrier H. Note that the number of time steps of the BTT is  T
∆t

(instead of m) as the truncated CRR tree has
⌊
T
∆t
⌋− 1 time steps. The length of the
ﬁrst time step of the BTT, ∆t′, is the remaining amount of time to make the whole
tree span T years:
∆t′ = T −
(⌊
T
∆t
⌋
− 1
)
∆t.
It is easy to verify that ∆t ≤ ∆t′ < 2∆t.
We still need to select nodes A, B, and C among the light gray vertices to make
the branching probabilities from node S valid. These three nodes are then connected
to node S. Three branches are needed to match the ﬁrst two moments of the loga-
rithmic stock price process; a binomial branch simply does not have enough degrees
of freedom. The mean and the variance of the log-prices at A, B, and C equal
µ ≡ (r − σ2/2)∆t′,
Var ≡ σ2∆t′,
respectively. The log-price for each light gray vertex at time ∆t′ is:{
 + 2jσ
√
∆t, if the CRR tree has an even number of time steps,
 + (2j + 1)σ
√
∆t, otherwise,
(2)
for some integer j. As the diﬀerence between the log-prices of two adjacent light
gray vertices is 2σ
√
∆t , there must exist a unique vertex whose log-price lies in the
interval [µ− σ√∆t, µ + σ√∆t). We select this vertex for node B. For example, the
log-price at node B is  + 3σ
√
∆t in Fig. 5. Denote the log-price at B as µˆ, which is
closest to µ among the log-prices at time ∆t′. The log-prices at nodes A and C are
therefore µˆ + 2σ
√
∆t and µˆ− 2σ√∆t, respectively. Deﬁne
β ≡ µˆ− µ,
α ≡ µˆ + 2σ
√
∆t− µ = β + 2σ
√
∆t ,
γ ≡ µˆ− 2σ
√
∆t− µ = β − 2σ
√
∆t .
8
[µ − σ√∆t, µ + σ√∆t), and this vertex is selected as node B. Denote the log-price
of B as µˆ. The log-prices of the two nodes A and C are selected as µˆ + 2σ
√
∆t and
µˆ− 2σ√∆t, respectively. Deﬁne
β ≡ µˆ− µ,
α ≡ µˆ + 2σ
√
∆t− µ = β + 2σ
√
∆t ,
γ ≡ µˆ− 2σ
√
∆t− µ = β − 2σ
√
∆t .
The valid branching probabilities can be derived by solving Eqs. (3)–(5) again.
Pricing European-style single-barrier options on the BTT can be sped up by the
eﬃcient combinatorial algorithm of Lyuu (1998), which evaluates the option values
at nodes A, B, and C in O(n) time. The ﬁnal pricing result is obtained by applying
Eq. (6), where ∆t′ is replaced by ∆t.
Vanilla Options
To drastically reduce the nonlinearity error, the BTT must hit the exercise price X
at the maturity date. This is because the payoﬀ function of a vanilla option is highly
nonlinear at X at the maturity date (see Figlewski and Gao (1999)). Constructing a
BTT for pricing a vanilla option mimics that for pricing a single-barrier option except
that the underlying grid should have a layer coinciding with X instead of L. The
term “terminal node” refers to a node at the maturity date of the CRR tree. The
value of a call option priced by an n-time-step CRR tree can be eﬃciently calculated
by summing the value contributed by each terminal node:
e−rT
n∑
i=0
(ni )p
i(1− p)n−i max (S0uidn−i −X, 0) . (7)
This formula can be evaluated in O(n) time (see Lyuu (2002)).
4 An O(n)-Time Algorithm for Double-Barrier Op-
tions
An eﬃcient combinatorial algorithm for pricing double-barrier options on the CRR
tree is presented in this section. First, a useful formula derived in Lyuu (2002) and
Dai and Lyuu (2005) is given. This combinatorial formula is then used to build up
the BTT pricing algorithm. We focus on the pricing of knock-in double-barrier call
options. Extension to other types of double-barrier options is straightforward.
10
if this price path hits the barrier (i.e., the barrier option comes into existence). Fur-
thermore, the value contributed by terminal node N(n, j) is
V (j) ≡ (nj )p(j) (11)
if node N(n, j) is above the barrier H (inclusive) or below the barrier L (inclusive).
This is because the number of price paths reaching node N(n, j) is (nj ), and any price
path reaching this node must also hit a barrier.
The algorithms for pricing the knock-in double-barrier call option are now within
reach. Two non-degenerate cases are discussed as follows.
Case 1. L < X < H:
The option value can be decomposed into two parts: (1) the value contributed by
the terminal nodes between X and H (exclusive), and (2) the value contributed by
the terminal nodes above H (inclusive).
The ﬁrst part of the option value is by accumulating the values contributed by
the terminal nodes N(n, j), h < j < a, between X and H. The number of paths that
reach one of the barriers before reaching N(n, j) is N(n−2h, 2j−2h, 2l−2h) as deﬁned
in Eq. (8). The value contributed by such a path is p(j) from Eq. (10). Therefore,
the value contributed by node N(n, j) is N(n− 2h, 2j − 2h, 2l− 2h)p(j). The sum of
the values contributed by the terminal nodes between X and H is therefore
a−1∑
j=h+1
N(n− 2h, 2j − 2h, 2l − 2h)p(j). (12)
The second part of the option value is by accumulating the values contributed by
the terminal nodes N(n, i), 0 ≤ i ≤ h, above the barrier H (inclusive). The value
contributed by N(n, i) is V (i) (see Eq. (11)). Therefore, the second part of the option
value is
h∑
i=0
V (i). (13)
We conclude that the value of a knock-in double-barrier call option is (12)+(13).
Case 2. X ≤ L:
The option value can be decomposed into three parts: (1) the option value con-
tributed by the terminal nodes between L (exclusive) and H (exclusive), (2) the option
value contributed by the terminal nodes above H (inclusive), and (3) the option value
contributed by the terminal nodes between L (inclusive) and X.
The ﬁrst part of the option value is by accumulating the values contributed by
the terminal nodes between L and H as follows:
l−1∑
j=h+1
N(n− 2h, 2j − 2h, 2l − 2h)p(j). (14)
12
It is a well-known hard problem to price a barrier option when the barrier is very
close to the initial stock price: the so-called barrier-too-close problem. Table 1 reveals
this fact. The numerical results of Ritchken’s model in the second column and the
true values listed in the last column are from Ritchken (1995). Each row contains
information about the number of time steps and the computational time required
by each approach to achieve 3-digit accuracy. Indeed, a large number of time steps
is required for Ritchken’s trinomial tree model to ensure that the barrier is exactly
hit. Ritchken’s approach is thus very ineﬃcient in this case. On the other hand,
although a much larger number of time steps is required for the BTT to achieve 3-
digit accuracy, the BTT consumes much less time than Ritchken’s model. This is
because the BTT costs only O(n) time instead of Ritchken’s Ω(n2) time. The AMM
is another algorithm that can eﬃciently solve the barrier-too-close problem. All the
numerical results for the AMM in Table 1 are computed by setting the AMM level to
be 1. (The number of time steps of the AMM is determined by the AMM level.) To
achieve 3-digit accuracy, the AMM again consumes more computation time than the
BTT. We conclude that the BTT is superior to the AMM and Ritchken’s trinomial
tree model when addressing the barrier-too-close problem.
Double-Barrier Options
We ﬁrst compare Ritchken’s model and the BTT in pricing a European-style knock-
out double-barrier call. The numerical results are illustrated in Fig. 11. The x-axis
and the y-axis denote the computational time and the option value, respectively. The
parameters and the accurate value 1.4580 are from Ritchken (1995). Note that both
methods converge well to the accurate value. But the BTT converges much more
smoothly and faster.
Second, the BTT solves the barrier-too-close problem eﬃciently. Numerical evi-
dence for pricing a knock-out double-barrier call is given in Fig. 12. The x-axis and
the y-axis denote the number of time steps and the option value, respectively. The
initial stock price 90.05 is very close to the lower barrier 90. It can be observed that
the BTT converges smoothly and quickly to 10.55.
The AMM eﬃciently solves the barrier-too-close problem when pricing single-
barrier options. When the AMM is applied to pricing double-barrier options without
modiﬁcations, the pricing results are inaccurate, and the experimental results in Table
2 reveal this fact. The ﬁrst column (“Level”) in Table 2 denotes the level of the AMM,
and the second column (n) denotes the number of time steps of the AMM. Note that
n is determined by the AMM level. The third column (“Inner Barrier”) and the
fourth column (“Outer Barrier”) denote the pricing results of the AMM computed by
14
[4] Dai, T.S., Lyuu, Y.D., and Liu, L.M. “Developing Eﬃcient Option Pricing
Algorithms by Combinatorial Techniques.” In Proceedings of the 2006 Interna-
tional Conference on Scientific Computing, Las Vegas, USA. pp. 104–110.
[5] Dai, T.S., and Lyuu, Y.D. “Pricing Double Barrier Options by Combinato-
rial Approaches.” Advances in Soft Computing — Soft Computing as Transdis-
ciplinary Science and Technology, Singapore: Springer-Verlag, 2005, pp. 1131–
1140.
[6] Derman, E., Kani, I., Ergener, D., and Bardhan, I. “Enhanced Nu-
merical Methods for Options with Barriers.” Working Paper, Goldman Sachs,
1995.
[7] Duffie, D. Dynamic Asset Pricing Theory. 2nd ed. Princeton, NJ: Princeton
Univ. Press, 1996.
[8] Figlewski, S., and Gao, B. “The Adaptive Mesh Model: A New Approach
to Eﬃcient Option Pricing.” Journal of Financial Economics, 53 (1999), pp.
313–351.
[9] Geman, H., and Yor, M. “Pricing and Hedging Double-Barrier Options: A
Probabilistic Approach.” Mathematical Finance, 6 (1996), pp. 365–378.
[10] Klassen,T.R. “Simple, Fast, and Flexible Pricing of Asian Options.” Journal
of Computational Finance, 4 (2001), pp. 89–124.
[11] Kunitomo, N., and Ikeda, M. “Pricing Options with Curved Boundaries.”
Mathematical Finance, 2 (1992), pp. 275–298.
[12] Hull, J. Options, Futures, and Other Derivatives. 4th ed. Englewood Cliﬀs,
NJ: Prentice-Hall, 2000.
[13] Luo, L. “Various Types of Double Barrier Options.” Journal of Computational
Finance, 4 (2001), pp. 125–138.
[14] Lyuu, Y.D. “Very Fast Algorithms for Barrier Option Pricing and the Ballot
Problem.” Journal of Derivatives, 5 (1998), pp. 68–79.
[15] Lyuu, Y.D. Financial Engineering & Computation: Principles, Mathematics,
Algorithms. Cambridge, U.K.: Cambridge University Press, 2002.
[16] Merton, R. “Theory of Rational Option Pricing.” Bell Journal of Economics
and Management, 4 (1973), pp. 141–183.
16
B A Useful Combinatorial Formula
The following analysis is based on the grid in Fig. 7. Before counting the number of
price paths from node A to node B and reaching either barrier L or H at least once,
we consider a simpliﬁed problem ﬁrst: How many price paths from node A to node B
will hit barrier H before one hit of barrier L? One such path may hit barrier H ﬁrst
at J and barrier L later at K. We can reﬂect the path ÂJ marked by the solid curve
with respect to the H-axis to obtain path Â1J marked by the dash curve. Each path
from node A to node J maps to a unique path from node A1 to node J , and vice
versa. Thus the number of paths from node A to node J equals the number of paths
from node A1 to node J . This is the celebrated reﬂection principle. So the number
of paths from node A to node B and hitting barrier H equals the number of paths
from node A1 to node B.
The reﬂection principle can be applied more than once. The curve Â1K can be
reﬂected with respect to the L-axis to obtain Â2K. Therefore, the number of paths
from node A1 to node B and reaching barrier L at least once equals the number of
paths from node A2 to node B. In conclusion, the number of paths from node A
to node B and reaching barrier H at least once before reaching barrier L equals the
number of paths from A2 to B.
Assume that x up moves and y down moves are required to move from node A2
(with coordinate (0,−(a + 2s))) to node B (with coordinate (n,−b)). They must
satisfy
x + y = n,
x− y = a− b + 2s,
which yield x = (n+a−b+2s)/2. So the answer to this simpliﬁed problem mentioned
above is (
n
n+a−b+2s
2
)
for even, non-negative n + a− b. (16)
Note that a path counted by Eq. (16) may hit L ﬁrst before hitting H. The point is
that among the hits, one hit of barrier H must appear before one hit of barrier L.
The answer to the number of paths that will hit either barrier L or H before
arriving at node B is now within reach. It is useful to consider a function f that
maps paths to strings. The strings contain the information about the barrier hitting
sequences. For example, f(ÂB) = HHL since the path ÂB hits the barrier H twice
before hitting the barrier L. Next, we deﬁne αi as the set of paths whose f value
contains
i︷ ︸︸ ︷
H+L+H+ · · · with i ≥ 1. Here, L+ and H+ denote a sequence of Ls and Hs,
18
0S
uS0
dS0
p
p−1
2
0uS
3
0uS
0S
2
0dS
3
0dS
uS0
dS0
0 1 2 3
N(0,0)
N(1,0)
N(1,1)
N(2,0)
N(2,1)
N(2,2)
N(3,0)
N(3,1)
N(3,2)
N(3,3)
Time  step
Figure 1: The CRR Tree. The initial stock price is S0. The upward and downward
multiplicative factors for the stock price are u and d, respectively. The upward and
downward branching probabilities are p and 1 − p, respectively. N(i, j) denotes a
node at time step i resulting from j down moves and i− j up moves from time step
0.
20
XFigure 3: Pricing a Vanilla Option by the AMM. The base tree is denoted by thick
lines and solid circles. The ﬁner trees are denoted by thin lines and hallow circles.
The strike price X is also marked.
22
St∆'t∆
T
t∆ t∆
uP
dP
mP
0 't∆
l
t∆+ σ2l
t∆+ σ6l
t∆+ σ4l
t∆− σ2l
t∆+ σ8l (= h)
Time
t∆− σ4l
t∆+ σ10l
t∆t∆
A
B
C t∆+σl
t∆−σl
t∆+ σ3l
t∆+ σ3l
t∆+ σ5l
t∆+ σ7l
t∆+ σ9l
H
L
cell width
cell height
Figure 5: The BTT for Pricing Double-Barrier Options. Two barriers, L and H, are
denoted by thick dashed lines. The root of the BTT is denoted by node S. The CRR
tree (with the ﬁrst two time steps truncated) that comprises the bulk of the BTT is
shadowed. This CRR tree is put on a grid (marked in thin lines). The log-prices for
the nodes at maturity are listed next to these nodes.
24
J
s
K
H
L
A
(0,a)
(0, a)
(0, (a+2s))
B
(n, b)
(0,0)
(0, s)
1A
2A
Figure 7: Paths That Hit H or L. Barrier H is the horizontal line y = 0, and
barrier L is the horizontal line y = −s.
26
nValue
17.78
17.81
200 250 300
17.80
17.79
Figure 9: Oscillations of the CRR, Klassen’s Binomial Model, the AMM,
and the BTT in Valuing Vanilla Call Options. The x-axis denotes the number
of time steps of each tree model. The y-axis denotes the option value. The initial
stock price is 100, the exercise price is 98, the risk-free rate is 10% per annum, the
volatility of the stock price is 30%, and the time to maturity is 1 year. The line that
oscillates signiﬁcantly is the CRR tree model. The line formed by hollow squares
denotes Klassen’s binomial tree model. The thin solid line denotes the AMM with
AMM level 1. The dotted line denotes the AMM with AMM level 2. The thick solid
line denotes the BTT. The analytical option value is 17.7943.
28
Table 1: Ritchken’s Model, the BTT, and the AMM When the Barrier Is
Close to the Initial Stock Price.
Stock Ritchken AMM BTT True
Price n Time Value Time Value n Time Value Value
91 1000 0.110 1.274 0.032 1.274 2000 0.005 1.274 1.274
90.5 4000 1.891 0.642 0.235 0.642 8000 0.023 0.642 0.642
90.4 5000 3.062 0.515 0.562 0.515 11000 0.031 0.515 0.515
A down-and-out single-barrier call option is priced above. The initial stock prices
are listed in the ﬁrst column, the barrier is 90, the exercise price is 100, the risk-
free rate is 10% per annum, the volatility of the stock price is 25%, and the time to
maturity is 1 year. Ritchken denotes Ritchken’s trinomial tree model. AMM denotes
the adaptive mesh model. BTT denotes the BTT. The variable n, Time, and Value
denote the number of time steps, the computational time, and the price of each tree
model, respectively. The true values with 3-digit accuracy are from Ritchken (1995).
30
Value
n
10.4
10.45
10.5
10.55
10.6
0 2000 4000 6000 8000 10000
Figure 12: Convergence of the BTT When the Barrier Is Close to the Initial
Stock Price. The initial stock price is 90.05, the exercise price is 100, the risk-free
rate is 10% per annum, the volatility of the stock price is 25%, the time to maturity
is 1 year, and the two barriers are 140 and 90.
32
