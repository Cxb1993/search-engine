 I 
中文摘要 
本計畫主要目的在配合國科會電力工程學門之規劃方向，於過去三年內分別完成下列
三個子計畫： 
1. 永磁電機驅動器先進電流感測與無轉速感測器之轉子位置估測技術研發。 
2. 實用型永磁交流電機驅動器之強韌性高效率速度控制器研發。 
3. 實用型可調速永磁交流電機之設計。 
於子計畫一中，第一年吾人採用一先進電流感測技術於永磁交流電機驅動，此技術串
接一共地電路於變頻器中，在不影響電機變頻器驅動的同時，加入特定電力開關狀態，引
導電機電流流過變頻器加入之共地電路，由這共地電路提供信號，配合選定之時序，合成
電機電流信號，因此電機驅動控制之脈波寬度調變可與電流感測整合在一起，如此驅動器
在製造上不但可省去高價的霍爾電流感測器，同時驅動器控制電路亦易於積體化製作。第
二年吾人應用一半波式永磁電機控制架構，發展實用型可調速永磁交流電機驅動器，此控
制架構串聯一電力開關於電機線圈，其特點在於控制架構簡單，系統穩定性高，製造成本
低廉，於計畫中吾人發展適用於此控制架構之電機電流感測技術，透過模擬分析與硬體電
路製作實現一實用型可調速永磁交流電機驅動器，同時發展之電機電流亦易於驅動器控制
電路之積體化設計製作。第三年發展一代數演算法則估算永磁電機參數與電機轉子位置，
此方法利用量測變頻器施於電機驅動控制時之脈波電壓、脈波時間及電流響應信號，將電
機動態方程式轉換成以電機參數及轉子信號為變數之代數方程式，利用數值方法求解最接
近方程式目標函數之電機參數及轉子位置變數，作為電機参數及轉子位置估測信號，可用
於任何變頻器驅動之電機控制應用中。 
於子計畫二中，完成永磁直流無刷電動機及永磁交流同步電動機之控制器開發。在永
磁直流無刷電動機控制器之開發方面首先提出一新型可調速、內模鎖相式控制架構，經由
此內模鎖相式控制架構可使控制器更具強韌性及精確度；再者因整合子計畫一之具電流感
測脈波寬度調變之直流無刷驅動器使得整體控制架構更加簡潔。至於永磁交流同步電動機
控制器之開發方面提出一新型相位頻率偵測器(Phase Frequency Detector, PFD)，其輸出視轉
速差很大、稍大於零及等於零時，分別設定為零、線性虛擬相位差及真實相位差，可使全
速調整範圍獲得良好的協調關係。第二，基於前述 PFD，提出一新型可調式精密速度控制
器；其特點是不僅採用單位安培最大轉矩控制策略以獲得快速響應之效果，並且可達更精
準之速率控制精度，其架構則包含雙迴路控制，第一迴路為一 PI控制器，而另ㄧ迴路則為
基於前述 PFD之鎖相迴路之控制，可獲得更佳鎖相控制強韌性。此外，文中並就所提新型
精密速度控制器之設計提出一些準則，俾快速滿足控制器規格。第三點，本論文最後並以
德州儀器公司推出的DSP TMS320F2812結合FPGA實現新型鎖相迴路速度控制器之控制法
 III 
Abstract 
The major purpose of this project is to cope with the suggested research fields planned by 
the Electrical Power Engineering Division of NSC to finish following three subprojects during 
the past three years. 
1. Development of Advanced Current Sensing and Rotor Position Estimation Techniques for 
PMAC Motor Drives.  
2. Development of Robust High Efficiency Speed Controller for Practical PMAC Motor Drives. 
3. Design of Practical Adjustable Speed PMAC Motors. 
For the first subproject：In the first year, one has fulfilled the advanced current sensing 
technique for PMAC motors. First, a motor phase current sensing technique is used to reduce the 
cost and to increase the bandwidth. Then, the proposed current sensing scheme is further  
integrated sophistically with the corresponding PWM control of the PMAC motor drive. It is seen, 
through experimental results, that the resulting PMAC motor drive can not only achieve a cost 
reduction of the entire drive system but also maintain the performance easily. Furthermore, the 
PMAC motor drive is very suitable for integrating into a signal chip for miniaturization. In the 
second year, one develops the motor current sensing techniques for the half-wave controlled 
permanent magnet AC motor drive. The topology of the half-wave controlled motor drive has a 
signal power switch per motor phase, limits the motor drive to half-wave operation, and endows 
feature with high reliability. The proposed techniques of motor current sensing and rotor position 
estimating are used to reduce the manufacture cost. They are integrated sophistically with the 
control circuit of the motor drive and suitable for integrating into an integrating circuit chip 
realization. As a result, the PMAC motor drive can achieve a cost reduction greatly. In the third 
year, one develops an estimation method to calculate the motor parameters as well as the rotor 
position signal. The method measures the signals of the pulse voltage and pulse time of the 
inverter and the corresponding current response of the motor. It uses the measured signals to 
transfer the motor dynamic equations in the controller to the algebraic equations which take the 
motor parameters and rotor position signal as equation variables. A numerical method is adopted 
to solve the algebraic equations. It is subject to an objective function which conducts the 
solutions of the algebraic equations more correctly.  
For the second subproject, two PMAC motor drives have been finished: a robust 
phase-locked loop (PLL) internal model controlled (IMC) speed controller of the permanent 
magnet brushless dc (PMBLDC) motor and a robust high efficient speed controller for interior 
permanent magnet synchronous motor (IPMSM) drive. Major contributions of the first drive 
 V 
目錄 
中文摘要 
英文摘要 
目錄 
圖例說明 
表例說明 
緒論 
子計畫一 
第一章 前言 
第二章 永磁交流電機先進電流感測 
2.1 簡介 
2.2 整合電流感測之直流無刷電機脈波寬度調變技術 
2.3 電路設計與硬體製作 
2.4 實驗量測結果 
2.5 結論 
第三章 半波控制直流無刷驅動器 
3.1 簡介 
3.2 半波式直流無刷驅動 
3.3 半波式永磁交流電機驅動之數值模擬 
3.4 具電流感測及合成之半波式直流無刷驅動器 
第四章 交流電機無轉速感測之轉子位置估測 
4.1 簡介 
4.2 代數方程疊代之電機參數及轉子位置估測方法 
4.3 數值模擬實驗電路製作 
4.4 交流電機先進電流感測與硬體電路製作 
4.5 結論 
第五章  結論 
第六章  計畫成果自評 
子計畫二 
第一章 緒言 
第二章 直流無刷電動機新型內模鎖相迴路控制技術 
2.1 前言 
 VII 
4.1 永磁無刷馬達設計原理                                 
4.2 永磁交流馬達設計原理                                
4.3 VB程式軟體設計 19 
 4.3.1 永磁無刷馬達程式設計                                
 4.3.2 永磁交流馬達程式設計                               
4.4繞組設計                                                  
    4.4.1 極數與槽數的選擇                                   
 4.4.2 線圈跨距的選擇                                     
 4.4.3 每相繞組之相位偏移槽數(phase offset) K0的計算         
 4.4.4 線圈設計之步驟                                      
 4.4.5 繞線程式設計                                        
 4.4.6 程式使用說明                                       
4.5 結果討論                                                 
第五章  計畫成果自評                                         
5.1 論文發表統計                                  
 5.1.1 國內研討會論文  
 5.1.2 國際研討會論文                            
 5.1.3 國外期刊                              
 5.1.4技術報告                                                                        
5.2 人才培育                                           
參考文獻 
 
 IX 
圖 4.9  疊代演算電阻參數發散的情況 
圖 4.10  疊代演算之軸等效電路反電動勢 ( )mE k 與模擬設計之軸反電動勢 ( )me t  
圖 4.11  經過 IIR 濾波器處理之疊代演算估測電阻參數序列 
圖 4.12  經過 IIR 濾波器處理之疊代演算估測電感參數序列 
圖 4.13 估測之電機軸等效電路反電動勢序列 ( )mE k 與模擬設計之軸反電動勢 ( )me t  
圖 4.14  以雙擲開關 , ,Sa Sb Sc表示傳統變頻器開關示意說明 
圖 4.15  鋸齒波調變三相弦波信號產生開關時序形成電壓向量時序示意說明 
圖 4.16  變頻器控制之先進高頻寬電流感測技術實現示意說明 
圖 4.17  計畫進行硬體電路設計製作情況照片 
圖 4.18  先進高頻寬電流感測技術之實現硬體電路照片 
圖 4.19  實驗中實現先進高頻寬電流感測技術電路之量測記錄，波形 1：取樣脈波信號，
波形 4:儀器測量之電機線圈電流信號，波形 3：電路中感測之瞬時線圈電流信號 
圖 4.20  量測 2000rpm時代表電機轉子位置之電機反電動勢波形表示於 d-q軸上 
子計畫二 
圖 2.1 永磁直流無刷電動機之傳統反電動式電壓、相控制電流及對應之驅動器換向訊號
波形圖 
圖 2.2  子計畫一研製之具電流感測之脈波寬度調變直流無刷驅動器 
圖 2.3  以轉速信號 ( )r sw 為輸出之具電流感測脈波寬度調變之直流無刷驅動器方塊圖 
圖 2.4  強韌鎖相式內模速度控制方塊圖 
圖 2.5  內模速度控制之迴授控制架構 
圖 2.6 鎖相迴路之基本架構 
圖 2.7  相位頻率偵測器之輸入輸出關係 
圖 2.8  電壓控制震盪器之輸入輸出關係 
圖 2.9  電壓控制震盪器之輸入輸出關係 
圖 2.10 轉速命令100 / secrad ，轉子轉速90 / secrad 時相位頻率偵測器之輸出與其平均值 
圖 2.11 轉速命令100 / secrad ，轉子轉速90 / secrad 時相位頻率偵測器之輸出與其平均值 
圖 2.12 rf 頻率不同時相位頻率偵測器之平均輸出 
圖 2.13  鎖相方式實現之直流無刷電機內模控制速度控制器 
圖 2.14  相角頻率偵測器(P.F.D.)工作方式示意說明 
圖 2.15  4046PFD 在頻率未進入鎖住範圍時之(a)輸出入特性函數圖(b)以cosq當作輸入時
之輸出波形圖 
圖 2.16  以 D( ew )形式表示之直流無刷電動機新型內模鎖相迴路控制器架構圖 
 XI 
圖 4.8  0 Mf f< D £ D 時將增益( 2
eK
p
)移至相位迴圈內之等效方塊圖 
圖 4.9  將圖 3.15中 ( )sC s 與 ( )pC s 合併之等效方塊圖 
圖 4.10  新型鎖相迴路速度控制器只考慮相位誤差之等效數學  模型 
圖 4.11  新型鎖相迴路速度控制下之轉速響應 
圖 4.12  新型鎖相迴路速度控制系統於 2t 時間內之數學模型 
圖 4.13  新型鎖相迴路速度控制器響應結果  (轉速命令100 / sec  rad ) 
圖 4.14(a)內嵌式永磁同步電動機新型鎖相迴路速度控制系統方塊圖 
圖 4.14(b)內嵌式永磁同步電動機新型鎖相迴路速度控制系統實現架構圖 
圖 4.15  先進電流感測控制系統方塊圖 
圖 4.16  轉速偵測電路 
圖 4.17 隔離驅動電路 
圖 4.18  數位-類比轉換器電路圖 
圖 4.19  各週邊電路與數位訊號處理器之資料傳輸方塊圖 
圖 4.20  程式流程圖 
圖 4.21  內嵌式永磁同步電動機驅動器硬體電路雛型 
圖 4.22  內嵌式永磁同步電動機機電模組 
圖 4.23 轉子座標直軸電流之步階響應( *=3.82Ardsi ) 
圖 4.24 轉子座標交軸電流之步階響應( *=3.82Arqsi ) 
圖 4.25 以線性上升之轉矩命令產生的轉子座標直軸、交軸電流 
圖 4.26  轉速步階響應與轉子座標直軸電流、交軸電流 
 ( 239.7 / secs radw = ， 0N-mLoadT = ) 
圖 4.27  加載下之轉速步階響應與轉子座標直軸電流、交軸電流 
        ( 239.7 / secs radw = ， 1N-mLoadT = ) 
圖 4.28  無載下，轉速命令 500rpm之鎖相結果( sF =833Hz,)  
圖 4.29  無載下，轉速命令 1000rpm之鎖相結果( sF =1667Hz,)  
圖 4.30  無載下，轉速命令 2000rpm之鎖相結果( sF =3333Hz,)  
圖 4.31  無載下，轉速命令 3000rpm之鎖相結果( sF =5000Hz,)  
圖 4.32  有載下，轉速命令 500rpm之鎖相結果( sF =833Hz,)  
圖 4.33  有載下，轉速命令 1000rpm之鎖相結果( sF =1667Hz,)  
子計畫三 
圖 2.1  線形的模型 
圖 2.2  馬達的雛型剖面圖 
 XIII 
表例說明 
子計畫一 
表 2.1  相電流時序及編碼表 
表 2.2  電力開關信號產生表 
子計畫二 
表 3.1  內嵌式永磁同步電動機之參數值表 
表 4.1  速度伺服控制所需之規格 
表 4.2  電腦模擬速度伺服控制所需之規格 
子計畫三 
表 2.1  馬達設計規格 
表 3.1  馬達設計規格 
 
 2 
 
 
 
 
 
 
子計畫一 
 
 4 
第二章 永磁交流電機先進電流感測 
2.1簡介 
由於永磁交流電動機具高功率密度與高效率特性，在變速度驅動產業上愈來愈受歡
迎，永磁交流電機一般都設計成梯形分佈之氣隙磁通密度，電機旋轉時在定子線圈上會感
應出梯形波反電動勢，電機於驅動時借著使用變頻器控制電機定子電流追隨梯形波反電動
勢，如此電機產生之輸出轉矩約與梯形波定子電流之大小成正比，如此永磁交流電機驅動
系統之控制可變得比較容易。目前永磁交流電機之變頻器電流控制中均使用電流感測器來
量測電機電流信號，霍爾電流感測器利用半導體之霍爾效應，借著感測電流產生之磁場強
度來量測電機線圈電流，另如 International Rectifire 公司之電流感測晶片如圖一，其
串接電阻於電機線圈上，感測晶片在高壓側，量得電機線圈電流於串接電阻器上之壓降信
號，晶片將量測信號轉換成數位信號後，借著光耦合之電氣隔離轉換至低壓側供控制電路
使用，霍爾電流感測器或圖 2.1 之電流感測晶片都可提供電氣隔離電流信號，但都比較複
雜且昂貴。低廉之電流感測與驅動如 Unitrode 公司之單石積體電路 UC3620 如圖 2.2，圖
2.3中使用直接接地之二極體並接於變頻器下臂電力開關上，利用串接之電阻 Rs量測電機
電流，雖然此方法不需電氣隔離且製造成本低廉，但變頻器下臂電力開關須並接共地二極
體並不適合高壓驅動應用。另 Texas 公司提供另一種不同之電流感測方法如圖 2.3，圖 2.3
中，變頻器電力開關串接一個電阻器至地，永磁交流電機電流可借著量測電阻器壓降獲得，
此種電流量測方法十分簡單，但所得之電流信號只在電源經變頻器連接至永磁交流電機時
才有效，雖然此信號可用於驅動器中電機過電流保護控制，但此信號之完整性並不足於作
電機電流控制時使用。比較前述各電流感測之優缺點[1-12]，本計畫採用一實用低廉的電流
感測技術，此電流感測技術可提供全時程且完整的永磁交流電機線圈電流信號，且易於整 
 
 
圖 2.1: 線電流感測積體電路 IR2175於電機線圈上二之電流偵測電路 
 6 
流感測器，如此可大大地降低永磁交流電機驅動器製造成本。 
2.2整合電流感測之直流無刷電機脈波寬度調變技術 
為了降低永磁交流電機驅動器製造成本，並獲得完整的電機電流信號，本計畫製作之整合
電流感測之脈波寬度調變控制之永磁交流電機驅動器架構如圖 2.4。基本上整合電流感測之
脈波寬度調變控制永磁交流電機驅動器是由四個方塊組成，其中方塊一是永磁交流電機，
方塊二是變頻器與電流感測電路，方塊三是相電流時序及編碼方塊，方塊四是電力開關信
號產生方塊。首先方塊一中永磁交流電機的三相繞組連接至方塊二變頻器上，而三個電機
轉子位置感測器感測轉子位置信號 uh 、 vh 、 wh  送至方塊三。再者方塊二中可看到三個
電阻 xR 、 yR 、 zR  與變頻器之功率開關串聯形成共地電路用以量測電機線圈電流，其中
適當地控制三個傳輸閘導通來量測電流信號，透過簡單的 RC 濾波電路可合成出電機線圈
電流。另外方塊一產生之轉子位置信號 uh 、 vh 、 wh 經方塊三之相電流時序及編碼產生 u v 
w 和 x y z 信號，方塊三之相電流時序及編碼整理如表 2.1，由表 2.1之相電流時序及編碼
內容可看出 u v w 信號控制著變頻器上臂的三個電力開關，用以產生流入電機線圈電流，
而 x y z 信號控制著變頻器下臂的三個電力開關，用以產生流出電機線圈電流。最後相激
發時序信號 u、v、w 和 x、y、z 與輸入代表電壓大小之脈波寬度調變信號 pwmV 經表 2.2
之變頻器電力開關激發對應表產生激發信號 uS 、 vS 、 wS  和 xS 、 yS 、 zS  控制變頻器電
力開關，同時相激發時序信號 x、y、z 亦加至方塊二之三個傳輸閘上，來合成電機線圈電
流。為清楚說明起見，考慮表二中激發對應表之第一列狀態為例，其中 pwmV 為 1，電機轉
子位置編碼在 u v w(h , h ,h ) (1,0,1)=  ，由表 2.1 得對應 u、v、w、x、y、z 信號狀態為
(u,v,w,x,y,z)=(1,0,0,0,0,1)，再由表 2.2得變頻器開關狀態 u v w x y z(S ,S ,S ,S ,S ,S )  =(1,0,0,0,0,1)，
此狀態等效電路示於圖 2.5，由圖 2.5 可看到量測電流 i 剛好為永磁交流電機之 a、c 相電
流即 a ci i i= - = 。相同地，當 pwmV 為 0 時，由表 2.2激發對應表之第二列可得變頻器開關
狀態 u v w x y z(S ,S ,S ,S ,S ,S )  =(0,0,0,1,0,1)，對應等效電路如圖 2.6，由於電機線圈具有電感性，
a 相電流仍尊循原流動方向，量測電流  i 剛好亦為永磁交流電機之 a、c 相電流即 
a ci i i= - = 。因此不論脈波寬度調變信號 pwmV 是 1 或 0，電機線圈電流信號均可完整地量
測。 
2.3電路設計與硬體製作 
為驗証前述電機驅動與電流感測方法，設計之硬體電路方塊如圖 2.7，圖 2.7中使用六
個 IRFP460功率晶體來製作整合電流感測之脈波寬度調變控制之變頻器，使用三個 0.1W電
阻形成共地電路用以偵測電機電流，三個具浮接通道之閘驅動晶片(IR2110)提供高低壓驅 
 
 8 
 
表 2.1: 相電流時序及編碼表 
uh  vh  wh  u  v  w  x  y  z  
1 0 1 1 0 0 0 0 1 
1 0 0 0 1 0 0 0 1 
1 1 0 0 1 0 0 1 0 
0 1 0 0 0 1 1 0 0 
0 1 1 0 0 0 1 1 0 
0 0 1 1 0 0 0 1 0 
 
 
表 2.2: 電力開關信號產生表 
u v w x y z Vpwm  uS  vS  wS  xS  yS  zS  
1 0 0 0 0 1 1 1 0 0 0 0 1 
1 0 0 0 0 1 0 0 0 0 1 0 1 
0 1 0 0 0 1 1 0 1 0 0 0 1 
0 1 0 0 0 1 0 0 1 0 1 0 0 
0 1 0 1 0 0 1 0 0 0 0 1 1 
0 1 0 1 0 0 0 0 0 0 1 1 0 
0 0 1 1 0 0 1 0 0 1 1 0 0 
0 0 1 1 0 0 0 0 0 0 1 0 1 
0 0 1 0 1 0 1 0 0 1 0 1 0 
0 0 1 0 1 0 0 1 0 0 0 1 0 
1 0 0 0 1 0 1 0 0 0 0 1 1 
1 0 0 0 1 0 0 0 0 0 1 1 0 
 
 
 10 
 
圖 2.7: 硬體電路設計系統方塊圖 
 
 
 
圖 2.8: 整合電流感測與脈波寬度調變永磁交流電機驅動器實體製作照片 
 
動通道用以驅動變頻器電力開關，而 CD4066BE構成之電動傳輸閘，量取共地電路壓降信
號，使用 TL074之運算放大器放大處理，而前述方法中之脈波寬度信號與表 2.1、2.2之時
序信號產生別由 CPLD晶片來完成，CPLD晶片使用 6MHz 脈波，一上下計數計數器計數
脈波後與電流誤差信號作比較產生脈波調變信號 pwmV ，而變頻器閘極控制信號由轉子磁石
位置信號與 pwmV 經查表後產生，由圖 2.7 之硬體電路設計結果可看出，計畫完成之具電流
感測之永磁交流電機驅動器設計十分簡單，只需使用低容量的 CPLD 晶片即可加以完成，
 12 
 
圖 2.10: 電流控制電機電流信號 
 
2.5結論 
本計畫主要目的在參與針對電力工程學門規劃之重點研究方向及產業需求所提出之”
實用可調速永磁交流電機及驅動器設計應用整合型計畫”,並負責永磁電機驅動器先進電流
感測與無轉速感測器速度控制技術研發，在本年度計畫中吾人採用一先進電流感測技術於
永磁交流電機驅動，此技術串接一共地電路於變頻器中，在不影響電機變頻器驅動的同時，
加入特定電力開關狀態，引導電機電流流過變頻器即有或加入之共地電路，由這共地電路
提供信號，配合選定之時序，合成電機電流信號，因此電機驅動控制之脈波寬度調變可與
電流感測整合在一起，如此驅動器在製造上不但可省去高價的霍爾電流感測器，同時驅動
器控制電路亦易於積體化製作。 
 
 14 
低永磁交流驅動器製作成本有明顯助益。計畫中對於半波式永磁交流電機驅動之研究內容
說明安排如下：在章節 3.2 中，吾人先對半波式永磁交流電機驅動之基本原理作一簡單介
詔，為深入了解半波式永磁交流電機驅動器，在章節 3.3 中吾人進行數值模擬，利用數值
模擬結果，對全波式及半波式永磁交流驅動器特點作比較，在章節 3.4 中，吾人提出一半
波式永磁交流電機驅動之電機等效電流感測、合成技術，並設計硬體電路加以實現，進行
部份的實驗結果量測及說明。 
3.2 半波式直流無刷驅動 
半波式永磁交流電機驅動器驅動電基本架構如圖3.2所示，圖3.2中三相永磁電機的三個
線圈串接電力開關連接於具中線之電源上，圖中具中線之電源是由一接於市電之倍壓電路
所提供。圖二中，當激發電力開關T1，C1電容器上電源加至永磁電機的a相線圈，線圈電
流增加，當電力開關截止時，a相線圈電流減小，線圈電流由於電流變化感應之電壓維持線
圈電流經C2電容上電壓及D1二極體繼續流動，此相當於加了C2電容生的反相電壓於a相線
圈，此過程中線圈反電動勢、電流、電壓、氣隙功率與輸入功率如圖3.3所示，圖3.3中 ase 是
永磁電機a相線圈中的反電動勢波形， *asi 與 asi 是a相線圈電流命令與電流波形， ap 代表線圈
上之氣隙功率，而 ip 為線圈之輸入功率，由圖3.3之圖形可看出半波式控制電路架構可維持
線圈電流續流，維持氣隙功率為正，兩線圈於電力開關截上時，施加反相電壓於線圈，產
生負的輸入功率。 
 
 
 
圖 3.2: 半波式變頻器電路 
 16 
 
圖3.4: 半波式永磁交流電機驅動之數值模擬結果 
 
流電機驅動電路中電力開關與二極體可維持電機線圈電流在固定方向流動，建立的電機氣
隙功率均為正，因此電機可輸出穩定的電磁轉矩，另外值得注意的是線圈輸入功率，由模
擬之線圈輸入功率波形之變化出現負值之情況，可看出電機線圈在電力開關截止時，將電
機氣隙能量傳回電源，此現象會產生電機轉矩出現比較大的紋波。由模擬結果整理半波式
永磁交流電機驅動特點如下： 
 
l 每相線圈只使用一個電力開關與二極體加以控制，功率元件數減半，成本下降。 
l 減少電力開關之閘極驅動電路個數，控制電路簡單。 
l 可作四象限運轉，提供高性能控制應用。 
l 每個電力開關均串接著電機線圈，電路操作之穩定性高。 
l 每相線圈由一個電力開關控制，導通時傳導損失小，控制器效率高。 
 
 
 18 
 
圖3.6: 硬體電路製作照片 
 
 
 
圖 3.7: 電機 a相線圈反電動勢信號對應半波式永磁交流電機驅動器 a相輸出電壓波形 
 
 
 20 
第四章 交流電機無轉速感測之轉子位置估測 
4.1 簡介 
在高性能可變速的電機驅動器中，電機軸上一般均安裝有編碼器或轉子位置感測器，
用以量測電機轉子磁場位置。然而於大部份的應用中，由於控制器須對編碼器或轉子位置
感測器提供大量的信號線，使得驅動系統變得複雜且易感染雜訊，可靠度降低。因此進步
之發展趨勢乃在於研發無需電機轉子位置感測裝置之電機驅動器，這方面的研究、方法與
技術，依文獻記載，大概可依循以下方式加以歸類； 
1. 使用狀態估測器估測電機轉子位置 
此類方法利用電機之狀態方程式製作觀測器，以觀測系統狀態變數，再由電機參數，
合成電機轉子信號。此狀態估測器，使用狀態估測理論估測電機轉子位置，一般須先將電
機狀態數學模型作線性化，利用線性的電機數學模型製作狀態估測器，狀態估測器之輸出
與部份可量測得之電機狀態(如電流等)進行比較，修正估測器中之電機數學模型，使估測器
輸出與量測之電機狀態一致，再利用估測器中之電機模型之完整的變數狀態和電機參數計
算電機轉子位置信號 [21-24]，此方法在理論上可行，且可應用於任何種類的電機，但是估
測器之設計須依賴電機參數，同時如果為增進估測器之強健性與適應性，亦需設計特殊濾
波器於估測器中，此大大地增加估測器之數值計算量，常需使用高速的數位信號處理晶片
加以實現。 
另外非線性狀態估測器亦有用於電機轉子位置估測應用[25-26]，其狀態估測器中之狀
態變數為驅動系統中未線性化之機械與電機動態方程式及變數，然而機械系統之動態方程
式參數如轉動慣量、負載轉矩並不易清楚獲得，且電機動態方程式中之參數亦常隨電機運
轉狀況而改變，欲成功地設計製作完成非線性狀態估測器，適用於無轉速感測裝置之電機
驅動器十分困難。 
2. 使用電機相電感變化估測電機轉子位置 
如凸極同步機或內嵌永磁電機，其定子線圈電感隨轉子位置而改變，線圈的電感值是
轉子位置之函數，此特性有被使用於電機轉子位置信號之估測，如參考文獻[27]，利用電機
方程式中電機參數和狀態變數與定子相電感間之關係，計算出電機相電感，利用電機凸極
特性藉著查表方式估測電機轉子位置。 
再者，利用電機結構或磁通飽和對定子線圈電感造成影響而估測出電機轉子位置信號
之方法如參考文獻[28]，其利用電機轉子處於不同位置時，施加電壓向量(Stator Voltage 
Vector)，且觀察電流向量(Stator Current Vector)之差異，計算相電感變化，估測電機轉子位
置。另外，利用相電感變化估測電機轉子位置之方法亦有如參考文獻[29]，其中利用量測電
 22 
2.研發方法量測正常運轉時變頻器施於電機之脈波電壓、脈波時間與電流響應，無額外施
加電壓脈波或注入電流脈波於電機定子線圈，不會干擾電機正常運轉。 
3.研發方法除估測電機轉子位置信號外，亦同時提供及時之電機電感及電阻参數估測，可
作為驅動器之線上電機監控應用。 
4.2 代數方程疊代之電機參數及轉子位置估測方法 
交流電機於暫態分析時使用直交(d-q)軸等效電路作數學描述，以旋轉磁場為參考之交
流電機之直交軸電壓方程式為 
r r r r
qs q qs qs r dsv r i p= + l + w l         (4.1) 
r r r r
ds d ds ds r qsv r i p= + l - w l  (4.2) 
其中 rdsv 、
r
qsv 為直交軸電壓，
r
dsi 、
r
qsi 為直交軸電流，
r
dsl 、
r
qsl 為直交軸磁交鏈， dr 、 qr 為
直交軸電阻， rw 表轉速， p表示微分運算。今考慮永磁交流電機其轉子裝置著永久磁石，
電機磁交鏈表示成 
r r
qs q qsL il =  (4.3) 
r r
ds d ds m frL i L il = +  (4.4) 
 
 
圖 4.1: 磁交流電機軸等效電路 
 
 24 
第n脈波開始施於軸等效電路時軸電流為 0nI ，於週期內
a
ntD 時間之軸電流為
1
nI ，而第 n脈波
結束第 1n + 脈波開始時之軸電流為 0 1nI + 。如圖 4.2變頻器脈波電壓施於電機軸等效電路，等
效電路於 antD 之電流方程式可表示成： 
( )( ) ( ) ( )
m s
di tRi t L e t v t
dt
+ + =   (4.7) 
於第n脈波週期中之 antD 時間內，變頻器施加 sV 電壓於軸等效電路，由於脈波時間很短，等
效電路之反電動勢 ( )me t 可考慮成固定即 ( )
m
m ne t E= ，如以第n週期開始為 0t = ，起始電流
0
nI ，軸等效電路電流響應為 
0( ) ( )
Rm m t
s n s n L
n
V E V Ei t I e
R R
-- -
= - -  (4.8) 
當 ant t= D  時 
1( )an ni t ID = ，(4.8)式變成 
1 0( )
a
n
Rm m ts n s n L
n n
V E V EI I e
R R
- D- -
= - -  (4.9) 
由於 antD 時間很短，(4.9)式中
a
n
R t
Le
- D
項以泰勒級數展開近似成 
1
a
n
R t aL
n
Re t
L
- D
» - D   (4.10) 
方程式(4.9)整理成 
1 0
0 ( ) mn n
n n sa
n
I I LRI E V
t
-
+ + =
D
 (4.11) 
同理，變頻器之電壓第 1n + 、 2n + 、……、n k+ 脈波週期中，發明之電機參數及轉子位置
估測方法獲得以下方程式 
 26 
其中 tC 表示對矩陣C取轉置運算，而 1( )tC C - 表示對矩陣 tC C取反矩陣運算。應用(4.15)式，
估算此時段(數個脈波電壓週期時間內)電機之參數( ,R L )及反電動勢( mE )(轉子位置)。當上
述方法線上(on line)實施於受控電機時，電機參數及反電動勢信號即可依序產主，將這些電
機參數及反電動勢信號序列經濾波器處理後可得穩定的電機參數估測與轉子位置信號輸
出。 
B.第二種代數方程疊代之電機參數及轉子位置估測 
如圖 4.2變頻器脈波電壓施於電機軸等效電路，等效電路於 antD 之電流方程式可表示成： 
( )( ) ( ) ( )m s
di tRi t L e t v t
dt
+ + =  (4.16) 
而在 rntD 時間內時方程式為 
( )( ) ( ) 0m
di tRi t L e t
dt
+ + =  (4.17) 
於第n脈波週期中使用脈波電壓 ( )sv t 、電流響應波形 )(ti 中時間及電流信號量測 antD 、 0nI 、
1
nI 、 1
a
nt +D 、
0
1nI + 、
1
1nI + 、 2
a
nt +D 、
0
2nI + 、
1
2nI + …….，電機動態方程式(4.17)轉換成代數方程
式(4.18) 
0 1 1 0
( ) ( )
2
mn n n n
n sa
n
I I I IR L E V
t
+ -
+ + =
D
  (4.18) 
而電機動態方程式(4.17)轉換成代數方程式(4.19) 
1 0 0 1
1 1( ) ( ) 0
2
mn n n n
nr
n
I I I IR L E
t
+ ++ -+ + =
D
 (4.19) 
利用(4.19)式，於 1k + 個電壓脈波週期中以 R及 L為變數，獲得 1k + 個方程式形成方程組，
透過數值方法求解最接近目標函數之方程組中電機參數 R及 L。另一方面利用估測之電機
参數 R及 L和量測之電流信號 1nI 、 0 1nI + 與時間 rntD ，計算電機反電動勢 mnE 如下式： 
1 0 0 1
1 1( ) ( )
2
m n n n n
n r
n
I I I IE R L
t
+ ++ -= - -
D
 (4.20) 
 28 
對照圖 4.4軸等效電路之反電動勢波形，及模擬規劃之輸入脈波電壓，圖 4.3之軸等效電路
電流響應可預期的。利用這些數值模擬驗証代數方程疊代之電機參數及轉子位置估測方 
 
 
 
圖 4.3: 數值模擬之軸等效電路電流響應 
 
 
 
圖 4.4: 軸等效電路之反電動勢波形 
 
 30 
 
圖 4.7: 應用軸電阻、電感參數透過演算法則估算之軸等效電路反電動勢 ( )mE k 與模擬設計
之軸反電動勢 ( )me t  
 
法之可行性，計畫規劃幾個步驟來作測試驗証。首先吾人先以正確的電機參數代入代數方
程疊代之電機參數及轉子位置估測演算法中，透過模擬數值及估測演算法演算電機參數久
及軸等效電路反電動勢，得圖 4.5、4.6、4.7之模擬結果，圖 4.5 中吾人可看到電機軸等效
電路之軸電阻參數為 2.5R = W，及估測演算法演算之電阻參數 ( )R k ，圖 4.5中 ( )R k 序列數
值緊靠著軸電阻參數為 2.5R = W，只在部份時間偏移但均能再回復接近軸電阻參數，圖 4.6
中吾人可看到電機軸等效電路之軸電感參數為 3.5L mH= 及估測演算法演算之電感參數
( )L k 序列，其中 ( )L k 序列數值緊靠著軸電阻參數為 3.5L mH= ，只在部份時間偏移但均能
再回復接近所設定之軸電感參數值，而應用軸電阻、電感參數透過演算法則估算之軸等效
電路反電動勢 ( )mE k 與模擬設計之軸反電動勢 ( )me t 比較結果如圖 4.7，圖 4.7可看出演算法
則估算之軸等效電路反電動勢與模擬設計之軸反電動勢信號幾乎是相同的。 
進一步，吾人將疊代演算估測所得之軸等效電路之電阻及電感參數代入疊代演算中，
形成迴圈式之疊代演算估測演算，並進行 14次的疊代演算，得發散的數值計算結果，如圖
4.8、4.9、4.10，圖 4.8是疊代演算電阻參數發散的情況，其中可發現在第 14次疊代以後估
算的電機電阻參數開始明顯地偏離模擬之設定值，相同的情況亦發生在估算的電機電感參
數上如圖九，估算發散之軸等效電路反電動勢如圖 4.10。為克服疊代演算發散狀況，吾人
在疊代迴路中將估測之電阻與電感參數分別經 IIR(Infinite Impulse Response) 濾波器處理，
IIR濾波器處理過程如下式： 
 32 
 
圖 4.10: 疊代演算之軸等效電路反電動勢 ( )mE k 與模擬設計之軸反電動勢 ( )me t  
 
 
 
 
圖 4.11: 經過 IIR 濾波器處理之疊代演算估測電阻參數序列 
 
 34 
( ) 0.95* ( 1) 0.05* (1,1)R k R k RL= - +  (4.23) 
( ) 0.95* ( 1) 0.05* (2,1)L k L k RL= - +  (4.24) 
再進一步地利用上式 IIR濾波器處理之估測電阻、電感參數於疊代演算估測法中得圖 4.11、
4.12、4.13之估測結果，圖 4.11是經過 IIR 濾波器處理之疊代演算估測電阻參數序列，由
此估測電阻參數序列變化可看到電阻參數序列在震盪後於模擬設定之電阻參數值( 2.5W )附
近穩定下來，相同狀況亦發生於估測之電感參數序列如圖 4.12，線上估測之電機軸等效電
路反電動勢序列 ( )mE k 與模擬設計之軸反電動勢 ( )me t 比較結果示於圖 4.13，圖 4.13中估測
之電機軸等效電路反電動勢序列 ( )mE k 與模擬設計之軸反電動勢 ( )me t 幾乎完全一致。由圖
4.11、4.12、4.13 得演算之電阻、電感參數與模擬之軸電路電阻、電感值之數值比較結果可
看出演算之估測電阻、電感參數只在某小部份時段產生微小差異，其可正確地估測出電機
軸等效電路方參數，另外估測代表電機轉子位置之軸電路反電動勢與模擬設計之軸電路反
電動勢值極為接近，此結果驗証研發之代數方程疊代之電機參數及轉子位置估測方法於線
上之電機參數與轉子位置估測之有效性。 
4.4 交流電機先進高頻寬電流感測與硬體電路製作 
由前述所提出之代數方程疊代之電機參數及轉子位置估測方法及數值模擬過程，吾人
可發現代數方程疊代之電機參數及轉子位置估測方法之實現，需依賴瞬時電機電流信號，
其可將電機動態方程式轉換成代數方程式，因此計畫研發技術之成功實現與否有賴是否能
偵測瞬間電機電流信號，對此問題吾人於計畫中採用一先進高頻寬電流感測技術於計畫研
發，先進高頻寬電流感測技術說明如圖 4.14，圖 4.14中雙擲開關 , ,Sa Sb Sc為傳統變頻器電
力開關之示意說明，圖中雙擲開關 , ,Sa Sb Sc可切至 1或 0，切至 1表示接至VDC電壓而切
至 0表示接至GND，而變頻器中使用鋸齒波調變三相弦波信號產生開關時序形成之電壓向
量時序如圖 4.15 所示，圖中的電壓向量V(Sa,Sb,Sc)隨三相弦波信號及鋸齒波信號之變化
而改變，觀察這些電壓向量時序可發現零電壓向量V(Sa,Sb,Sc)出現於鋸齒波信號Vp高於
或低於三相弦波信號時，零電壓向量V(0,0,0), V(1,1,1)出現有其週期性，再者對照零電壓向
量於圖 4.14之雙擲開關 , ,Sa Sb Sc表示傳統變頻器開關示意圖可發現，於零電壓向量時變頻
器電力開關將交流電機三相線圈端切至GND或VDC端，形成電機線圈三相短路，此時電
機圈電流將流過短路端，利用此特性吾人採用之先進高頻寬電流感測技術即於短路端點前
串接微小電阻，當變頻器出現零電壓向量時，短路的三相電機線圈電流將流過短路端點前 
 
 36 
 
圖 4.16: 變頻器控制之先進高頻寬電流感測技術實現示意說明 
 
電機線圈電流之取樣信號則由變頻器電壓向量V(Sa,Sb,Sc)解碼產生，因此圖 4.16 中控制
電路偵測變頻器電壓向量V(Sa,Sb,Sc)出現零電壓向量時，除透過Su,Sv,Sw,Sx,Sy,Sz電力
開關估信號導通變頻器下臂電力開關，將電機線圈經電阻Rx,Ry, Rz短接在 GND端點，此
時電機線圈三相電流在電阻Rx,Ry, Rz上產生壓降，另控制電路中的零電壓向量偵測電路送
出一取樣信號，取樣電阻Rx,Ry, Rz上壓降信號並保持做為電機線圈電流信號。 
計畫進行的硬體電路如圖 4.17、4.18 實驗電路照片，圖 4.17 是計畫進行硬體電路設計
製作之情況，照片中吾人使用一 PMAC電機進行實驗，考量實驗研究之方便性實驗電路於
麵包板上製作，而關於數值演算部份則使用 TI 之 TMS320C2812數位信號處理晶片負責，
而關於先進高頻寬電流感測技術之實現硬體電路如圖 4.18照片所示，照片中可看到三個微
小電阻( 0.1 ,2WW )分別串接於變頻器電路之電分開關下，運算放大電路放太大微小電阻之
壓降信號，而類比開關構成之取樣電路取樣壓降信號構成瞬時電機線圈電流。實驗進行中
取樣電機線圈電流信號如圖 4.19，圖 4.19是實驗中實現先進高頻寬電流感測技術電路之量
測記錄波形，其中波形 1為取樣脈波信號，波形 4 為儀器測量之電機線圈電流信號，波形
3為電路中感測之瞬時線圈電流信號，比較波形 3與波形 4可看出些微差異，此仍電路中 
 38 
 
圖 4.19: 實驗中實現先進高頻寬電流感測技術電路之量測記錄，波形 1：取樣脈波信號，波
形 4:儀器測量之電機線圈電流信號，波形 3：電路中感測之瞬時線圈電流信號 
 
之保持電路部份功能未正常動作，電路於改善設計逗進行中，代數方程疊代之電機參數及
轉子位置估測演算法使用 C 語言撰寫，組譯後載入於 TMS320C2812 數位信號處理晶片中
執行，進行中量測 2000rpm 時代表電機轉子位置之電機反電動勢波形於 d-q 軸上之表示如
圖 4.20。 
4.5 結論 
  在本年度的研究計畫中創新地提出以代數方程式取代電機動態方程式，透過數值計算
求解電機參數及變數，估測電機轉子位置。推演實施方式，提出簡易之數值計算演算法，
實現創新之電機狀態估測方法。數值模擬驗証所提方法之可行性。使用先進電流感測技術，
完成廉價高頻寬電機電流感測，進行創新方法之硬體製作。 
 
 
 
 40 
第五章 結論 
本計畫主要目的，即在參與針對電力工程學內規劃之重點研究方向及產業需求所提出
之實用可調速永磁交流電機及驅動器設計應用整合型計畫，並負責子計畫一之永磁電機驅
動器先進電流感測與無轉速感測技術研發。主要研究內容包括永磁交流電機先進電流感
測、廉價之半波控制直流無刷驅動器研製及交流電機無轉速感測之轉子位置估測技術研
發。本研究計畫發展關鍵實用之電機電流感測及無轉速感測之轉子位置估測技術，實現廉
價、實用可調速永磁交流電機驅動器之目的。本計畫第一年的執行期間，主要採用一先進
電流感測技術於永磁交流電機驅動，此技術串接一共地電路於變頻器中，在不影響電機變
頻器驅動的同時，加入特定電力開關狀態，引導電機電流流過變頻器加入之共地電路，由
這共地電路提供信號，配合選定之時序，合成電機電流信號，因此電機驅動控制之脈波寬
度調變可與電流感測整合在一起，如此驅動器在製造上不但可省去高價的霍爾電流感測
器，同時驅動器控制電路亦易於積體化製作。第二年執行期間，吾人應用一半波式永磁電
機控制架構，發展實用型可調速永磁交流電機驅動器，此控制架構串聯一電力開關於電機
線圈，其特點在於控制架構簡單，系統穩定性高，製造成本低廉，適合產業應用。第三年，
本計畫進行無轉速感測器之電機轉子位置估測技術研發。在此研發計畫中，在此年度計畫
中吾人發展一代數演算法則估算永磁電機參數與電機轉子位置，此方法利用量測變頻器施
於電機驅動控制時之脈波電壓、脈波時間及電流響應信號，將電機動態方程式轉換成以電
機參數及轉子信號為變數之代數方程式，利用數值方法求解最接近方程式目標函數之電機
參數及轉子位置變數，作為電機参數及轉子位置估測信號，可用於任何變頻器驅動之電機
控制應用中。本計畫完成原先整合型計畫所規劃之先進電機電流感測與交流電機之無轉速
感測器之電機轉子位置估測技術研發目標，這些研發的實用技術，可有效地應用於高效率
永磁交流電機驅動系統中。相信本計畫之研發成果對國內民生工業之節能技術發展能提供
實際的助益。 
 42 
 
 
 
 
 
 
子計畫二 
 
 44 
第二章 直流無刷電動機新型內模鎖相迴路控制技術 
2.1 前言 
永磁交流電機的設計依應用場合之不同可區分為永磁同步電機與直流無刷電機。永磁
同步電機之氣隙磁通密度分佈設計成弦波，當電機旋轉時，電機線圈感應出弦波電壓，驅
動器配合電機磁場位置輸入弦波電流以驅動電動機。為正確偵測電機磁場位置，通常在電
機上安裝高解析度編碼器，利用編碼器之脈波訊號合成所需之對應電流命令訊號。市面上
販售之永磁同步電機伺服裝置性能優異，可提供轉矩、轉速、位置控制，其中轉速控制頻
寬可達上百 Hz，而位置控制頻寬可達數十 Hz，但價格卻很昂貴。然而直流無刷電機無論
在馬達或驅動器性能設計要求上都比永磁同步電機簡單許多，所以更具價格競爭力，因此
本計畫選擇直流無刷電機來研制一實用型可調速驅動裝置。直流無刷電機之氣隙磁通密度
分佈設計成梯形波形式，因此在驅動時只需偵測磁極極性來控制電機線圈電流流向，故可
排除昂貴之精密編碼器，而改採簡單且便宜之霍爾元件來偵測磁極極性，以產生所需之控
制用電流。另霍爾元件因偵測磁極極性故亦同時提供電機轉子轉速脈波訊號，以方便速度
控制應用。 
本子計畫主要目的在於配合國科會電力工程學門之規劃方向，完成無刷直流電機之鎖
相迴路控制策略研究[8], [12-14]。本計畫依進度研發完成無刷直流電機之強韌性鎖相式內模
控制之速度控制器。在設計直流無刷電機速度控制時，計畫中採用鎖相式控制策略，此速
度控制器利用霍爾偵測器偵測之無刷直流電機速度脈波信號與命令脈波信號之相位差，當
作速度誤差積分信號[15]，配合鎖相控制策略，完成強韌性內模式速度控制器，由於信號以
脈波方式直接處理無需轉換，因此可避免因轉換而伴隨之額外誤差，故可大幅提高速度控
制之精確性。另速度控制器整體之控制架構採內模控制，因此控制器更具強韌性且整體控
制電路簡捷易於實現皆大幅提高本控制器之實用價值。 
2.2 等效於直流有刷電動機的永磁直流無刷電動機之數學模型 
茲考慮一擁有梯形氣隙磁通密度分佈及對稱三相定子繞線之永磁直流無刷電動機
(PMBLDC)，當其被一換流器驅動時，三相定子繞線之各相迴路方程式[16]如(2.1)所示，其
對應之電壓、電流及換相信號波形則繪於圖 2.1。 
 0  0 -    0      0
0   0   0    -    0
0  0   0      0    -
a a a a
b b b b
c c cc
v R i L M i e
dv R i L M i e
dt
R i L M i ev
é ù é ù é ù é ù é ù é ù
ê ú ê ú ê ú ê ú ê ú ê ú= + +ê ú ê ú ê ú ê ú ê ú ê ú
ê ú ê ú ê ú ê ú ê ú ê úë û ë û ë û ë û ë ûë û
   (2.1) 
其中 
 46 
4( ) ( )
3 r
Sc t Sa t p= -
w
    (2.5) 
其中 ( )u t 為步級函數。由圖 2.1 之三相換相信號，吾人亦可定義一轉換方程式以將三相變
數 ( )af t , ( )bf t , ( )cf t 轉換為等效成有刷直流馬達之變數， ( )eqf t ，如下： 
[ ]
( )
( ) ( ) ( ) ( ) ( )
( )
a
eq b
c
f t
f t Sa t Sb t Sc t f t
f t
é ù
ê ú= ê ú
ê úë û
  (2.6) 
將 (2.2)-(2.5) 代入 (2.6), 得等效反電動勢方程式 ( )eqe t 如下： 
( ) 2 ( )eq c re t k t= fw   (2.7) 
設 ( )eqi t 為永磁直流無刷電動機等效於直流有刷電動機之電樞電流，既然 PMBLDC 之
定子電流 ( )ai t , ( )bi t , ( )ci t 經換流器控制成如圖 2.1 所示之三相方波波形，則由(2.6)可得等
效 電樞電流， ( )eqi t ，方程式及對應之電磁轉矩如下： 
[ ]
( )
( ) ( ) ( ) ( ) ( )
( )
a
eq b
c
i t
i t Sa t Sb t Sc t i t
i t
é ù
ê ú= ê ú
ê úë û
 (2.8) 
( ) / 2e a a b b c c r c eqT e i e i e i k i= + + w = f   (2.9) 
同理由(2.8)或(2.9)，一旦電磁轉矩命令或等效電樞電流 ( )eqi t 已知，其對應之三相定子電流
( )ai t , ( )bi t , ( )ci t 可由[ ] [ ]( ) ( ) ( ) ( ) ( ) ( ) ( )
T T
a b c eqi t i t i t Sa t Sb t Sc t i t= × 逆向求得。今考慮 BLDC電
動機之動態方程式如下： 
r
r e l
dJ B T T
dt
w
+ w = -            (2.10) 
其中 lT為負載轉矩， J及 B為電動機之轉動慣量及摩搓係數，由(2.9)及(2.10)可得等效電樞
電流 ( )eqi t 對轉子機械轉速之轉移函數為： 
 48 
 
圖 2.2 子計畫一研製之具電流感測之脈波寬度調變直流無刷驅動器 
 
 
w
 
圖 2.3 以轉速信號 ( )r Sw 為輸出之具電流感測脈波寬度調變之直流無刷驅動器方塊圖 
 
w w
 
圖 2.4 強韌鎖相式內模速度控制方塊圖 
 
 50 
加以實現，其中 /[ ( )]P p S L fk T k Tt= + 而 1/[ ( )]I S L fk k Tt= + ，由 IMC控制法則可輕易決定出 Pk
及 Ik 參數值。 
ww
 
圖 2.5 內模速度控制之迴授控制架構 
2.4鎖相迴路簡介 
鎖相迴路主要原理在於產生一對應系統中受控變數之訊號去追隨一外部參考訊號，讓
該系統訊號與外部參考訊號同步。當兩訊號之頻率相同，而其穩態相位差變為零或只剩下
某固定相位差時，即達到鎖相迴路之目的。鎖相迴路最早運用在通訊系統上[18-19]，在通
訊系統中常用於解調變(Demodulation)、載波同步(Carrier Synchronization)及除頻與倍頻
(Frequency Division and Frequency Multiplication)…等運用，是通訊系統中不可缺少的重要
技術。由於鎖相迴路可以達到精準的訊號追蹤能力，因此鎖相迴路被推廣應用到各種不同
的領域，伺服控制即為其中之ㄧ。 
鎖相迴路的架構基本上是由三個元件所組成： 
(1) 電壓控制震盪器(Voltage Controlled Oscillator, VCO) 
(2) 相位頻率偵測器(Phase Frequency Detector, PFD) 
(3) 迴路濾波器(Loop Filter, LF) 
其結構如圖 2.6 所示，由圖中可看出鎖相迴路基本架構屬於控制系統中的負迴授型態。圖
2.6中 sf 為外部參考訊號，經由相位頻率偵測器檢測參考訊號與系統內部迴授訊號( rf )之頻
率與相角差，輸出至迴路濾波器。不同的相位頻率偵測器具有不同的輸入輸出關係，圖 2.7
所示為一常用相位頻率偵測器之輸入輸出特性，其中 eq 為 sf 與 rf 之相位差，u為相位頻率
偵測器平均輸出。迴路濾波器為一低通濾波器，負責補償系統頻寬，並濾除系統中之高頻
雜訊，而 fu 為迴路濾波器之輸出。電壓控制震盪器根據迴路濾波器輸出訊號大小來調整震
盪器輸出頻率( rf )。電壓控制震盪器輸入輸出關係式如圖 2.8所示，其中 0f 為無輸入訊號時
電壓控制震盪器之輸出頻率。 
 
 52 
rf
fu
0f
 
圖 2.8 電壓控制震盪器之輸入輸出關係 
 
    鎖相迴路應用在電動機定速度控制上之運用，係以回授電動機編碼器訊號取代傳統鎖
相迴路之電壓控制震盪器。一典型的鎖相迴路速度控制器之架構圖如圖 2.9所示。圖 2.9中
*T 為迴路濾波器所產生之轉矩命令， Power Amplifier為功率放大器，負責產生驅動的電動
機所需的電流( si )。  
sf
rf
u *T si
rw
 
圖 2.9 電壓控制震盪器之輸入輸出關係 
 
    由於相位頻率偵測器不只可以偵測到微小的頻率誤差，就算是趨於零的頻率誤差，也
會被視為不斷累積的相位誤差而產生適當的誤差量(u )給迴路濾波器作補償，所以鎖相迴路
 54 
 
圖 2.11 轉速命令100 / secrad ，轉子轉速95 / secrad 時相位頻率偵測器之輸出與其平均值 
 
 
圖 2.12 rf 頻率不同時相位頻率偵測器之平均輸出 
 56 
由” 1”→”0”， 或由”0”→”-1”或由”-1”→”-1”，當 sf 與 rf 兩脈波信號之前緣
交互作用在相角頻率偵測器上時，則輸出狀態便在” 1”,”0”或”-1”變化，輸出狀態信
號波形指示出 sf 與 rf 兩脈波信號間之相角差。圖 2.13中相角頻率偵測器所偵測之相角差 eq
可提供控制器所需之速度誤差積分信號，鎖相控制迴路將與傳統之積分控制迴路 (1 ) /k s-
合併成1/ s，此外，若系統頻率超出鎖相範圍時，則由圖 2.13中速度命令信號 sw 與直流無
刷電機轉速信號 rw 相減產生速度誤差信號 ew ，然後速度誤差積分信號 eq 與速度誤差信號
ew 再依內模控制法則(2.19)，經增益或積分方塊合成電流控制信號 Si ，以消除速度誤差，
快速進入鎖相範圍。由圖 2.13可看出，本計畫提出以鎖相方式實現內模控制之直流無刷電
機速度控制器，此速度控制器以速度命令脈波信號 sf 及電機轉速脈波信號 rf 之相角差作為
速度誤差之積分信號，當速度控制器使用積分信號消除控制迴路之穩態速度誤差時，電機
轉速脈波將追隨速度命令脈波而達鎖相狀態。然則在系統頻率尚未進入鎖相範圍時相角頻
率偵測器(PFD)之非線性特性本計畫將以一描述方程式 ( )D x 實現。因 PFD之平均輸出電壓
對 sf 與 rf 頻率差之圖形如圖 2.15(a)所示，今若以一弦波 ( )x cosq = q當作 PFD之等效輸入訊
號，則根據圖 2.15(a)之輸出入特性可得 PFD之對應輸出 ( )y q 如圖 2.15(b)所示，若只考慮基
本波，則 PFD (IC4046)在暫態下之輸出入關係將為 ( ) ( ) 1.987 ( )dy k x xq @ q = q ，此時系統控制
架構可考慮為圖 2.16之形式。 
  
(a) 
 
(b) 
圖 2.15 4046PFD 在頻率未進入鎖住範圍時之(a)輸出入特性函數圖(b)以 cosq當作輸入時之
輸出波形圖 
 58 
(1 )(1- ) (1- )( ) ( ) [ ( ) ] ( ) [ ]
1
s LI I
P I e p P I d
p
k sk k k kG s H s k kk D G s k kk k
s s T s
- t
= + w + = + +
+
   (2.26) 
若將複數頻率代為 jw則式(2.26)可表示為 
2
2 2
2
2 2
(1- )(1- )( ) ( ) [ ]
1
[ ]
                       [(1- ) - ( )]
1
(1- )                          [- ( ) - (1- )]
(1 )
s LI
p I d
p
s p I d
L p p L
p
s I
p L L p
p
k jk kG j H j k kk k
j j T
k k kk k
T j T
T
k k k T j T
T
wt
w × w = + +
w + w
+
= w t w + t
+ w
+ w + t w t
w + w
 (2.27) 
2
2 2Re{ ( ) ( )} [- ( ) - ]1
s I
L p p d d L p L
p
k kG j H j T T kk kk kT K
T
w × w = w t + + t + + t
+ w
  (2.28) 
2 2
2 2Im { ( ) ( )} [ ( ) 1 ](1 )
s I
p d L d p L p
p
k kg G j H j T kk kk T k T k
T
w × w = - w + t + + t + -
w + w
 (2.29) 
其中Re{ ( ) ( )}G j H jw × w 及 Img{ ( ) ( )}G j H jw × w 分別為迴路增益之實部及虛部部分。由(2.27), 
吾人令 Img{ ( ) ( )}p pG j H jw × w 為零，可得系統之增益邊限, Gm, 為 
1 Re{ ( ) ( )}
( )
p f d L
p p
p f L
T T kk
Gm G j H j
T T
- t
= + w × w =
+ t
 (2.30) 
接著令 ( ) ( ) 1g gG j H jw × w = , 可得系統之相位邊限, Pm , 為 
1 Im ( ( ) ( ))tan ( )
Re( ( ) ( ))
g g
g g
g G j H j
Pm
G j H j
- w × w= + p
w × w
   (2.31) 
式(2.30)及(2.31)中, pw 及 gw 分別為系統之相位交越頻率及增益交越頻率，同時系統穩定時
需滿足 
0
( )
p f d L
p f L
T T kk
Gm
T T
- t
= >
+ t
            (2.32) 
由式(2.32),吾人可再次求得與式(2.25)一致之系統穩定度條件。 
 60 
示，於圖 2.18中 Si 為 4Amp輸入之步階命令，而 rw 為直流無刷電機之速度響應，依參考文
獻[20]，計算得直流無刷驅動器之系統函數如下： 
(1 ) 0.771(1 0.01818 )( )
1 1 0.2
s L
p
p
k s sG s
T s s
- t -
= =
+ +
 (2.33) 
若選擇 
-
0.771( )
1 0.2M
G s
s
=
+
       (2.34) 
及 
1 1 0.2 1( )  ( ) ( )  
0.771 1IMC M f
sG s G s F s
T s-
- += = ×
+
 (2.35) 
將 ( )PG s 代入 ( ) = IC P
kG s k
s
+  可得比例及積分常數為： 
0.2
0.771 (0.01818 )p f
k
T
=
× +
 (2.36) 
1
0.771 (0.01818 )I f
k
T
=
× +
     (2.37) 
 
圖2.19 所提控制系統迴路增益之波德圖 
 62 
 
(a) 
 
(b) 
w
 
(c) 
圖 2.20 “a”相電流及等效電樞電流於電流感測電路中所量得之波形(a)不使用等效電樞電
流控制迴路(b)使用等效電樞電流控制迴路(c)使用等效電樞電流控制迴路及速度控制迴路 
 64 
 
圖2.22 在不同時間常數 pT 下，所提直流無刷電機速度控制器之速度模擬響應結果       (a) 
pT =0.2sec. (b) pT =0.3sec. (c) pT =0.1sec. 
 
為瞭解參數 k 及 fT 變動對系統相對穩定度之影響，吾人利用(2.30)中之增益邊限方程
式，將 k及 fT 值對系統迴路增益穩定度之關係顯示於圖 2.23，於圖 2.23中，吾人可得知，
若為得到較佳之系統穩定度，則應該選擇較大之 fT 值及較小之 k 值。最後對系統進行暫態
量測可得圖 2.24之結果。於圖 2.24中，系統於負載轉矩 4 Nt-m 及 22rf Hz= 運轉下於 t=A
點將速度命令 sf 由 22Hz瞬間提升至 93 Hz，然後在 t=B點將 4 Nt-m負載突然移除一段時
間，再在 t=C點重新加入負載。其對應之 a相電流 ai ， rw 及 rf 響應顯示於圖 2.24(a)中。於
圖 2.24(a)中之響應可知，即使在暫態響應下，系統之速度響應不管在電子電路上及機械轉
動上皆相當平順。為便於觀察，圖 2.24(b)為圖 2.24(a)訊號響應之部分放大圖形。 
 
 
圖 2.23 系統參數 k及 fT 之選擇對直流無刷電動機控制器系統穩定度之影響結果 
 
 66 
第三章 內嵌式永磁同步電動機之數學模型與最大轉矩電流控制技術 
3.1 前言 
內嵌式永磁同步電動機是將永久磁鐵內嵌在轉子內部，機構上較表面黏著式永磁同步
電動機(Surface-Mounted Permanent Magnet Synchronous Motor)有較堅固的機械結構，因此
更適合高轉速之應用場合。由於內嵌磁鐵之安置結構，使磁路不同於表面黏著式永磁同步
電動機，造成 d軸與 q 軸電感量不同，因此內嵌式永磁同步電動機比表面黏著式永磁同步
電動機轉矩多出額外的磁阻轉矩分量。本章第二節首先推導內嵌式永磁同步電動機之數學
模型。第三節則說明本篇計畫所採用之內嵌式永磁同步機轉矩控制策略，內容包含磁場導
向控制理論(Field Oriented Control)與單位電流最大轉矩(Maximum Torque Per Ampere)控制
策略，第四節介紹負載轉矩估測器並模擬加載運作之結果。 
3.2 內嵌式永磁同步機之數學模型 
內嵌式永磁同步機之數學模型包含電氣系統與機械系統兩部分。在推導內嵌式永磁同
步機數學模型之前，先假設以下基本條件： 
1. 永磁同步機一次側為三相平衡繞組 
2. 氣隙(Air Gap)中的磁動勢(MMF)為弦波分佈 
3. 忽略鐵損(Core Loss) 
4. 磁路無磁飽和(Magnetic Saturation)現象 
5. 忽略繞線槽效應(Slot Effect) 
6. 無阻尼繞組(Damper Winding)  
 圖 3.1所示即為三相內嵌式永磁電動機示意圖，其中 a-axis、b-axis及 c-axis分別
表示電動機定子 a、b、c三相繞組之參考軸。d-axis、q-axis為轉子座標之直、交參考軸，
而 rq 為轉子直軸(d-axis)與 a相繞組參考軸(a-axis)所形成的夾角，N 、 S分別表示永久
磁鐵之北極與南極。由於三相繞組之間彼此都有互感存在，而轉子永久磁鐵產生磁場亦會
隨轉子運動在定子繞組產生磁通變化。因此，吾人可以利用耦合電感模型與法拉第定律推
導內嵌式永磁同步電動機之電氣電路模型。假設定子繞組為三相 Y接，則圖 3.1之模型亦
可以圖 3.2 之等效耦合電感與永久磁鐵與各繞組磁產生之磁交鏈表示之。其定子側電壓方
程式，由克希荷夫電壓定律可表示成如下： 
as s as as
dV R i
dt
l= +                                         (3.1) 
 68 
sR
sRsR
aaL
ccLbb
L
baab LL = caac LL =
cbbc LL =
afl
cfl
bfl
csv
bsv
bsi
asv
csi
asi
S
N
S
N
rw
 
圖 3.2 理想三相內嵌式永磁同步電動機等效電路圖 
 
接著，吾人將推導在定子側電壓方程式中的各電感參數： 
1. 定子側各繞組之自感( aaL 、 bbL 及 ccL ) 
以 a相為例，只外加 ai 電流，可求得 a相之磁動勢 asiNF =a ，其中 sN 為每相繞組之有
效匝數。如圖 3.3所示，吾人將 a相之磁動勢 aF 投影至轉子之直軸和交軸，可獲得直軸及
交軸之分量如下： 
da coss as rF N i q=                                          (3.7) 
qa cos( 90 ) sinq q= + = -
o
s as r s as rF N i N i                            (3.8) 
由於磁通量(Flux)f，等於磁動勢與磁導(Permeance) P 之乘積，即表示如下： 
P´= MMFf                                          (3.9) 
因此 a相磁通量 af 在直、交軸之各分量可表示如下： 
da a cosda d r dF Ff q= =P P                                    (3.10) 
 70 
2
a a cos 22 2
d q d q
a s s rN N il f q
+ -é ù
= = +ê ú
ë û
P P P P
                     (3.13) 
則 a相自感 aaL 為： 
2 cos 2
2 2
d q d qa
aa s r
a
N
i
l
q
+ -é ù
= = +ê ú
ë û
P P P P
L                        (3.14) 
1 2 cos 2 rL L q
D
= +                                      (3.15) 
上式中 
2
2
1
qd
sNL
PP +
=
D
，
2
2
2
qd
sNL
PP -
=
D
 
同理可得 b相及 c相之各自感( bbL 及 ccL )為： 
o
1 2 cos(2 120 )q= + +bb rL LL                                 (3.16) 
o
1 2 cos(2 120 )q= + -cc rL LL                                 (3.17) 
由上述之結果可知，任一相的定子自感都含有 rq 變數，且含有隨二倍轉子頻率變化之電感
分量，此乃由於直軸與交軸磁路不同等所造成。 
2. 定子側繞組間之互感( abL 、 acL 、 baL 、 bcL 、 caL 及 cbL ) 
  以 a、b相耦合為例，只輸入 ai 電流，其鏈接至 b相之磁通量 baf 為： 
 o o ocos( 120 ) cos( 90 120 )f f q f q= - + + -ba da r qa r  
 o ocos( 120 ) sin( 120 )f q f q= - - -da r qa r  
       o o[cos( 120 )cos sin( 120 )sin ]q q q q= - + -s a r r d r r qN i P P  
   o[ cos(2 120 )]
4 2
q
+ -
= - + -d q d qs a rN i
P P P P
                   (3.18) 
茲假設定子側三相有效繞組都相等， sscsbsa NNNN === ，則 bl 為： 
 72 
N
S
90orq =
S NSN
0orq =  
                          
圖 3.4 永久磁鐵感應至 a相繞組， rq 位置與 afl 之關係 
 
同理，吾人可得永久磁鐵對 b相及 c相之磁交鏈( bfl 及 cfl )為： 
( )ocos 120l l q= -bf f r                                    (3.25) 
( )ocos 120l l q= +cf f r                                    (3.26) 
吾人將上述三項推導之結果以矩陣型式表示，可表示成： 
 [ ]
aa ab ac af
ba bb cb bf
ca cb cc cf
l
l
l
D
é ù
ê ú= ê ú
ê úë û
L L L
L L L L
L L L
 
  
o
1 2 1 2
o o
1 2 1 2
o
1 2 1 2
1cos 2 cos(2 120 )
2
1 cos(2 120 ) cos(2 120 )
2
1 1cos(2 120 ) cos 2
2 2
q q
q q
q q
é + + - + -ê
ê
ê= - + - + + +
ê
ê
ê- + + - +
êë
l
l
r r
r r
r r
L L L L L
L L L L L
L L L L
 
 74 
0 0( 120 ) ( 120 )2 ( )
3
r r rj j j
as bs csi e e i e i
q q q- - - - += + +                        (3.31) 
再將(3.31)式以直交軸型式表示，可表示成： 
   ( ) ( )o o2 cos sin cos( 120 ) sin( 120 )
3
q q q qé+ = - + - - -ë
r r
ds qs as r r bs r ri ji i j i j  
        ( )o ocos( 120 ) sin( 120 )q q ù+ + - + ûcs r ri j     (3.32) 
吾人從(3.32)式之實數與虛數部份獲得兩個實數方程式： 
o o
o o
2 cos cos( 120 ) (cos( 120 )
3
2 sin sin( 120 ) sin( 120 )
3
q q q
q q q
ì é ù= + - + + ûï ëï
í
ï é ù= - - - - +ë ûïî
r
ds as r bs r cs r
r
qs as r bs r cs r
i i i i
i i i i
             (3.33) 
假設該電動機為三相四線式，且考慮不平衡狀況時，吾人必須考慮下式零相序電流成份： 
( )csbsasos iiii ++= 3
1                                       (3.34) 
接著，吾人可將(3.33)~(3.34)式表示成矩陣型式如下： 
o o
o o
cos cos( 120 ) cos( 120 )
2 sin sin( 120 ) sin( 120 )
3
1 1 1
2 2 2
q q q
q q q
é ù
ê úé ù - + é ù
ê úê ú ê ú= - - - - +ê úê ú ê ú
ê úê ú ê úë ûë û ê ú
ë û
r
ds r r r as
r
qs r r r bs
os cs
i i
i i
i i
           (3.35) 
同理，定子 a、b、c三相之磁通鏈空間向量表示式為： 
( )l l l l= + +v 22
3
s s s s
s as bs csa a                               (3.36) 
 76 
為完整起見，吾人亦可考慮零相序成份如下： 
ososos
e
os iLiL
D
l == l                                        (3.42) 
上式中 osL 稱為零相序等效電感。 
同理可將(3.1)~(3.3)式表示成空間向量： 
s
s
s
ss
s
s dt
diRv l+=                                         (3.43) 
接著，再將(3.43)式兩邊同乘 rje q- 以轉換至轉子座標： 
r r r r
s s s s r s
dv R i j
dt
l w l= + +
uur ur uur uur
                                  (3.44) 
其中wr為轉子電器角速度；然後再將(3.44)式分成實數、虛數部份，表示成果直、交軸座
標分量： 
r r r r
ds s ds ds r qs
dv R i
dt
l w l= + -                                   (3.45) 
r r r r
qs s qs qs r ds
dv R i
dt
l w l= + +                                   (3.46) 
若考慮零相序電壓成分如下： 
osossos dt
diRv l+=                                        (3.47) 
則此電動機之輸入總電功率為： 
in as as bs bs cs csP v i v i v i= + +  
( )3 3
2
r r r r
ds ds qs qs os osv i v i v i= + +                             (3.48) 
由於本計畫內所採用一三相平衡系統，所以吾人將(3.48)式變成： 
 78 
( )( )32 2
r r r
e f qs ds qs ds qs
PT i L L i il= + -                          (3.57) 
由(3.57)式可知，內嵌式永磁同步電動機所產生之電磁轉矩可以由 rdsi 與
r
qsi 控制，若電磁轉
矩採用 0rdsi = 控制策略，則(3.57)式可以寫為： 
3
2 2
r
e f qs
PT il=                                   (3.58) 
因此內嵌式永磁同步電動機之電磁轉矩可直接由 rqsi 控制。 
    將(3.40)與(3.41)式分別帶入(3.45)式及(3.46)式，可得到內嵌式永磁同步電動機於
轉子座標下直軸、交軸之電氣方程式如下： 
r r r r
ds s ds ds ds r qs qs
dv R i L i L i
dt
w= + -                          (3.59) 
( )r r r rqs s qs qs qs r ds ds fdv R i L i L idt w l= + + +                    (3.60) 
其等效電路圖如圖 3.5所示。 
 至於內嵌式永磁同步機之機械系統模式，吾人使用旋轉運動之機械方程式，獲得如下
之結果： 
m
e m load
dT J B T
dt
w
w= + -                                 (3.61) 
其中 
J  ： 轉子慣量 
B  ： 摩擦黏滯係數 
loadT  ： 負載轉矩 
 
 80 
機控制。根據 3.2 節所推導的內嵌式永磁同步電動機在轉子座標下之數學模型，吾人將依
據磁場導向控制理論，控制定子電樞電流之大小與相角來達到內嵌式永磁同步電動機之轉
矩控制。 
由(3.57)式推得之結果，內嵌式永磁同步機之電磁轉矩由定子電樞電流 rdsi 、
r
qsi 決定，而
由(3.59)及(3.60)可知，欲使用 rdsv 、
r
qsv 控制
r
dsi 、
r
qsi ，會因為直軸與交軸之耦合項 
r
r qs qsL iw 與
( )rr ds ds fL iw l+ 互相干擾，使響應結果不如預期。因此吾人採用電壓解耦合方式，先令： 
,
r r
ds ds cmd r qs qsv v L iw= -                                   (3.62) 
( ),r r rqs qs cmd r ds ds fv v L iw l= + +                              (3.63) 
其中 ,
r
ds cmdv 、 ,
r
qs cmdv 分別為控制
r
dsi 、
r
qsi 之電壓命令，將(3.62)式、(3.63)式帶入(3.59)式、
(3.60)式得到：  
,
r r r
ds cmd s ds ds ds
dv R i L i
dt
= +                                 (3.64) 
,
r r r
qs cmd s qs qs qs
dv R i L i
dt
= +                                 (3.65) 
將(3.64)式、(3.65)式改寫為： 
,
1r r rs
ds ds ds cmd
ds ds
Rd i i v
dt L L
= - +                              (3.66) 
,
1r r rs
qs qs qs cmd
qs qs
Rd i i v
dt L L
= - +                              (3.67) 
因此經由電壓解耦合後，(3.59)式與(3.60)式之耦合項已去除，吾人可由 ,
r
ds cmdv 、 ,
r
qs cmdv 控制
r
dsi 、
r
qsi ，進而控制電磁轉矩。 
    依據(3.66)式 、(3.67)式之結果，可設計轉子座標下直軸、交軸電流控制迴路，由於
此電流控制迴路各個控制變數都在轉子座標下，因此所有變數都必須轉換至轉子座標，其
直軸、交軸電流控制迴路之架構如圖 3.7所示。 
 82 
若假設定子電流向量之大小為常數時，也就是 ss ami i=
v
並帶入(3.69)式得： 
( )( )232 2 r r re f qs ds qs am qs qs
PT i L L i i il= + - - ´
                      (3.70) 
將(3.70)式對 rqsi 微分並將結果令為零，也就是： 
0er
qs
dT
di
=
                                              (3.71) 
此運算就物理意義而言，表示在某個固定的定子電流向量下，所能產生之最大電磁轉矩，
而產生此最大電磁轉矩之 rdsi 必須滿足以下之關係式[21]。 
( )
2
2
2  4( )2
f fr r
ds qs
qs dsqs ds
i i
L LL L
l l
= - +
--
                        (3.72) 
得到 rdsi 後，可由(3.68)式得到
r
qsi 。 
2 2r r
qs am dsi i i= -                                          (3.73) 
不考慮弱磁運作時，只需考慮電流限制條件， rdsi 、
r
qsi 必須滿足： 
2 2 2r r
ds qs SMi i I+ £                                          (3.74) 
其中 SMI 為空間向量表示之最大定子電流。 
在電流限制條件下，單位安培最大轉矩軌跡上之 rdsi 與
r
qsi 關係可寫為下式[21]。 
2 2 22( ) 4( ) 0r rqs ds ds f f qs ds qsL L i L L il l- - + + - =                    (3.75) 
由(3.75)式與(3.74)式，可以得到電流限制圓下所能產生之最大轉矩為： 
 84 
將(3.83)帶入(3.75)式可得到在某電磁轉矩命令對應之控制量 *u 與交軸電流命令關係： 
2 2 *4 * * 2 *29 ( ) 12 16 0r rds qs qs tM f qs tMP L L i PK u i K ul- + - =                  (3.84) 
故吾人若有一電磁轉矩命令 *eT ，可由(3.79)式產生對應之控制量
*u ，此控制量 *u 由(3.82)
式與(3.84)式解出直軸、交軸電流命令 *rdsi 、
*r
qsi ，其關係如圖 3.8所示。 
 
*
eT 1
tMK
*u
*r
dsi
*r
qsi
 
圖 3.8 本篇計畫所採用之轉矩控制策略 
 
3.4 內嵌永磁同步電動機驅動器之電流控制迴路設計 
本計畫研發之內嵌永磁同步電動機驅動器於轉矩迴路設計上採用最大轉矩電流比控制
策略，驅動器對於某轉矩命令可分配電機中 d、q 軸電流，d、q 軸電流經電流控制器饋入
至電機中，使電機輸出命令轉矩，獲得高驅動效率。本計畫採用強韌性內模式電流控制器
控制內嵌永磁同步電動機之 d、q軸電流，內模式控制(Internal Model Control，IMC) [5-7]
如第二章已敘述過，是一種強健性控制，依據應用於永磁同步電動機之控制方法，首先將
(3.59)至(3.60)表示為： 
* * * *r r r r
ds s ds ds ds r qs qs
dv R i L i L i
dt
w= + -  (3.85) 
* * * *r r r r
qs s qs qs qs r ds ds
dv R i L i L i
dt
w= + +  (3.86) 
式中 *r rqs qs r mv v w l= - ，假設電氣系統之時間響應遠比機械系統之響應為快，則在電流控制
迴路中，吾人可將 rw 近似為常數，因此其對應之頻域模式為： 
 86 
[ ]1 0
a aa ab a a a
b ba bb b b b
a
b
x F F x G x
u F Gu
x F F x G x
x
y
x
é ù é ù é ù é ù é ù
= + +ê ú ê ú ê ú ê ú ê ú
ë û ë û ë û ë û ë û
é ù
= ê ú
ë û
&
@
&
 (3.92) 
   :
  :
, :
a
b
x
x
u
y
F G
   :
 :
  
其中 可由感測器直接量測訊號之狀態變數
需要估測訊號之狀態變數
輸入
輸出
為已知常數矩陣
 
將(3.92)式展開，則需估測狀態 bx 之方程式為： 
b bb b ba a bx F x F x G u= + +&  (3.93) 
定義 ˆbx 為 bx 之估測值，且令 
ˆb b bx x x= -%  (3.94) 
其中 ˆbx 為估測誤差，接著對(3.94)式兩邊微分： 
( )             
ˆ
ˆ        
b b b
bb b ba a b b
bb ab b
d x x x
dt
F x F x G u x
F lF x
= -
= + + -
-
&% &
&
%@
 (3.95) 
(3.95)式即表示估測誤差之動態方程式，其中 bb abF lF-  為動態方程式之特徵值，因此可由
設計 l值來決定估測誤差之收斂速度，估測誤差趨近於零，意即 ˆb bx x» ，則吾人可得有效之
估測值 ˆbx 。 
將(3.93)式代入(3.95)式： 
 ( )( )ˆ ˆbb b ba a b b bb ab b bF x F x G u x F lF x x+ + - = - -&  (3.96) 
(3.96)式經整理後可得： 
( )ˆ ˆ ˆb bb b ba b aa a ab bx F x F y G u l y F y G u F x= + + + - - -& &        (3.97) 
(3.97)式又可寫為： 
 88 
0 0  , (Nominal Value), ,J B J BD D其中  為標稱值 為變動量。由(3.102)式，吾人可得： 
*m
m e
d a bT b
dt
w
w g= - - +  (3.103) 
其中 
( )
0
0
0
1
  mLoad m
Ba
J
b
J
dT J B
dt
w
g w
=
= -
= + D + D 不確定項之總和
 
在不確定項總和 g 中，由於 JD 與 BD 之變動都不大，所以 LoadT 主導g 之變動。因為 LoadT 的
變動不會在瞬間變化，於是吾人可假設其在很短暫的取樣時間內為常數。由以上之假設，
吾人便可將欲估測之g 與可量測之 mw 代入(3.92)式： 
[ ]
*
0 0 0
1 0
m m
e
m
m
a b bd T
dt
y
w w
g g
w
w
g
- -é ù é ù é ù é ù
= +ê ú ê ú ê ú ê ú
ë û ë û ë û ë û
é ù
= = ê ú
ë û
 (3.104) 
將(3.104)式代入(3.97)式，可得估測器動態方程式為： 
( )*ˆ ˆel y ay bT bg g= + + -& &  (3.105) 
其中 l 為狀態回授增益 
gˆ 表示 g 之估測狀態 
吾人定義g 之估測誤差 gˆ 為： 
ˆg g g= -%  (3.106) 
由於數位控制器的取樣頻率相比， g 變化算是相當緩慢，其微分為零。因此吾人可得此估
測誤差之動態方程式為： 
( )*ˆ ˆed d l y ay bT bdt dtg g g= - = - + + +% &  (3.107) 
 90 
表 3.1 內嵌式永磁同步電動機之參數值表 
極數 6 
轉子電阻 0.15W  
直軸電感 0.3mH 
交軸電感 0.525mH 
反電動勢常數 0.042V/(rad/sec) 
最大相電流 20A 
轉子慣量 19.4m 2N-sec / rad  
摩擦係數 2.57m N-sec / rad  
負載轉矩 1N-m 
 
接著吾人於數位控制器實現時將(3.111)式中之積分項(
1
s
)以後向(Backward)近似法，即： 
1
1
1
1 s
z T
s z
-
-= -
 (3.112) 
其中 sT 為數位控制器之取樣周期，將(3.112)式代入(3.111)式整理後可得差分方程式如下： 
( ) ( ) ( )
( ) ( ) ( )*
ˆ ˆ1 1 ( )
                   1 1 1
s m
s m s e
k lbT k l k
T l a k lbT T k
g g w
w
= - - - +
+ - - + -
 (3.113) 
(3.113)式中， gˆ 即為估測之負載轉矩，在數位訊號處理器相當容易實現。 
    接著吾人為了驗證此負載轉矩前饋控制，將模擬速度控制之內嵌式永磁同步電動機加
載情形，其模擬條件與電動機參數如表 3.1所示，而模擬結果如圖 3.11所示。由圖 3.11(a)
之轉速響應可見，比例積分控制器在無負載轉矩前饋補償時，有較大之轉速誤差，但在加
上負載轉矩前饋補償後，可以有效改善轉速響應結果。圖 3.11(b)為控制器之輸出轉矩，
有負載轉矩前饋補償之比例積分控制器會輸出額外之轉矩，消除負載轉矩造成之干擾，圖
3.11(c)為估測器之轉矩。 
 
 
 92 
第四章 內嵌式永磁同步電動機之鎖相迴路控制技術 
4.1 前言 
鎖相迴路應用在伺服控制可達到更精準的速度控制，因此常用於一些需要精密製程的
產業，例如半導體製程、工具機、生產線之輸送帶及光碟機等。然而這接應用大都屬於定
速控制。就可調速控制而言，由於電動機之摩擦與慣量，使其電磁轉矩對轉速之轉移函數
成為一具有時間延遲之低通濾波器特性。而此存在的時間延遲特性甚易使得控制器產生過
多或過少的轉矩命令，造成鎖相迴路速度控制易發生震盪、暫態響應時間過長，甚至不易
鎖相等問題。針對此問題，本計畫提出ㄧ新型鎖相迴路速度控制器，與傳統鎖相迴路不同
的是，藉由所提出的新型相位頻率偵測器，可以克服電動機慣性與時間延遲不易達到鎖相
的缺點。 
本章首先介紹本計畫所提出新型鎖相迴路控制策略，然後建立新型鎖相迴路的數學模
型，並依據所建立的數學模型提供一新型鎖相迴路速度控制器之設計準則。最後，以一速
度控制器之實例設計並藉由數值分析軟體模擬結果，相互驗證所提控制策略之可行性。 
4.2 新型鎖相迴路控制策略 
本計畫所提之新型鎖相迴路速度控制器架構圖如圖 4.1 所示，係採用速度控制迴路與
鎖相控制迴路之雙迴路控制，再加上負載轉矩前饋補償迴路整合而成。其設計理念是由速
度控制迴路達到快速轉速響應，緊接著以鎖相控制迴路達到精密轉速控制，並以負載轉矩
前饋補償迴路改善加載特性，增加鎖相能力。新型鎖相迴路控制器主要針對傳統鎖相迴路
中的相位頻率偵測器加以改良，以新型相位頻率偵測器取代傳統相位頻率偵測器。新型相
位頻率偵測器之結構如圖 4.2所示，主要由頻率偵測器(Frequency Detector)、虛擬相位產生
器(Virtual Phase Difference Generator)、命令訊號產生器(Command Signal Generator)及相偵測
器(Phase Detector)所構成。新型鎖相迴路控制器中各個元件功用如下所述。 
頻率偵測器 
頻率偵測器輸入訊號有二，其一為電壓控制震盪器根據轉速命令產生之脈波頻率
( sf )，另ㄧ輸入為電動機編碼器脈波訊號頻率( rf )，頻率偵測器比較出 sf 與 rf 之頻率誤差
( fD )，並將頻率誤差傳遞給虛擬相位差產生器。 
虛擬相位差產生器 
虛擬相位差產生器根據頻率偵測器所產生的頻率誤差訊號，決定虛擬相位差( sqD )之大
小。虛擬相位差產生器輸入輸出數學式如(4.1)式所示，其中 1e 為一趨近於零之正實數量，
MfD 為鎖相迴路控制器開始動作時之頻率誤差，而虛擬相位差產生器輸入輸出關係如圖4.10 
 94 
sqD
MfD
Mf-D
12p e-
12p e- +
fD
 
圖 4.3 虛擬相位差產生器之輸入輸出關係 
 
所示。 
1
0            ,
2   ,
0              ,
M
s M
M
M
f f
f f f
f
f f
p e
q
ì D > D
ï
-ïD = D D £ Dí
Dï
ï D < -Dî
                        (4.1) 
命令訊號產生器 
命令訊號產生器會依據虛擬相位差產生器產生之虛擬相位差角( sqD )與編碼器頻率 rf
來決定輸出命令訊號，為明確說明命訊號產生器輸出訊號之產生原理，吾人定義一脈波週
期函數 ( )nE q 如(4.2) 式所示。 
( ) (2 ) (2 ( ))n n nE E ft E f t Tq p p= = +                     (4.2) 
其中 2 ftq p=  
1T
f
=  
因此電壓控制震盪器輸出之脈波訊號可使用脈波週期函數 ( )nE q 表示為：  
(2 ) ( )n s n sE f t Ep q=                                 (4.3) 
其中 2s sf tq p=  
 96 
Mf fD > D 、0 Mf f< D £ D 與 0fD = 三種狀況。當 Mf fD > D 時，新型相位頻率偵測器可視為
沒有動作，理由是當頻率誤差很大時，可利用速度迴路快速減少速度誤差，吾人無須調整
微小相位誤差量去調控速率變化。而當0 Mf f< D £ D 時，新型相位頻率偵測器之數學模型
如圖 4.4 所示，其中頻率偵測器之數學模型即如同減法器，虛擬相位偵測器之數學模型可
由(4.1)式獲得。若考慮脈波訊號 *( )qn rE 與 ( )qn rE 之相角差為為 12p e- 時，相位偵測器輸出
為 dK ，因此在此範圍相位偵測器之數學模型即可視為一常數增益，而其增益值為 2
dK
p
。 
 
sf
rf
sqD qDfD 2
Mf
p
D 2
dK
p
 
圖 4.4 新型相位頻率偵測器於0 Mf f< D £ D 時之數學模型 
 
當 0fD = 時，新型相位頻率偵測器即如同傳統鎖相迴路，其數學模型則如圖 4.5所示。 
接下來依據新型相位頻率偵測器之數學模型，新型鎖相迴路速度控制器同樣可依頻率
誤差( fD )的大小，分成三個工作區段，分別就 Mf fD > D 、0 Mf f< D £ D 與 0fD = 三種狀況
予以探討。 
 
 
 98 
sw wD 1
+Js B
rw
+ps isK s K
s
Tw
( )sC s ( )G s
 
圖 4.6 Mf fD > D 時之系統等效方塊圖 
因此由(4.7)建立之羅斯表為: 
2
0
                                         
                                    
                             
+
is
ps
is
s J K
s B K
s K
 
由羅斯穩定準則可得到此系統若要滿足第一行正負符號不變，則必須滿足(4.8)式 
0
  
is
ps
K
K B
>
> -
                                         (4.8) 
因此基本上只要速度比例積分控制器的增益 psK 及 isK 均大於零，即可達到系統穩定條件。 
2. 0 Mf f< D £ D 之情況 
當0 Mf f< D £ D 時，新型鎖相迴路速度控制器同時結合速度迴路控制器及相位迴路控
制器，因此系統方塊圖可以圖 4.7 表示之，此處相位迴路控制器採用領先補償(Lead 
Compensation)之架構。為方便分析，將圖 4.7的方塊圖予以化簡，首先將圖 4.7中電壓控制
震盪器與編碼器增益(
2
eK
p
)，經由訊號流程圖移到 fD 後方，得到等效方塊圖如圖 4.8。根據
圖 4.8可以得到速度迴路之比例積分控制器為 
( )
+
= ps iss
K s K
C s
s
                                 (4.9) 
相位迴路之領先補償器為 
 100 
sf fD
rf
sq
PT
Twsw wD 1
+Js B
rw
+ps isK s K
s
2
eK
p
2
eK
p
2
Mf
p
D
p
pp
p
S Z
K
S P
+
+2
dK
p
( )sC s ( )G s
rw
sqD
 
圖 4.7 0 Mf f< D £ D 時系統之方塊圖 
 
 
rw
sqD
PT
Twsw wD 1
+Js B
rw
+ps isK s K
s
2
eK
p
2
Mf
p
D
+
+
p
pp
p
s Z
K
s P2
dK
p
( )sC s ( )G s
rw
wD fD
1( )pC s
sq
 
圖 4.8 0 Mf f< D £ D 時將增益( 2
eK
p
)移至相位迴圈內之等效方塊圖 
 
 
因此由(4.13)式建立之羅斯表為： 
 102 
3. 0fD = 之情況 
    當 0fD = 時，命令脈波訊號 ( )qn sE 與編碼器脈波訊號 ( )qn rE 之剩下一相角差，若
假設控制器在縮小相位誤差的過程中 fD 變動量很小，則吾人可以利用重疊原理之觀念，將
系統視為轉速運轉在 sw 工作點上，而只需分析存在的相角誤差即可，其系統方塊圖如圖 4.10
所示。 
 
由圖 4.17可寫出其開迴路轉移函數如(4.15)式所示。 
2 2
( )
LoopGain
4 ( )( )
pp d e p
p
K K K s Z
s P Js Bsp
+
=
+ +
                       (4.15) 
因此這時之閉迴路特性方程式 ( )D s 為： 
3 2
2 2( ) ( ) ( )4 4
e d pp e d pp
p p p
K K K K K K
s Js P J B s P B s Z
p p
D = + + + + +       (4.16) 
因此由(4.16)式建立之羅斯表為： 
3
2
2
2
                                                                                            
4
                                                                         
4
e d pp
p
e d pp
p
K K K
s J P B
K K K
s P J B Z
p
p
+
+
2 2
0
2
( )( )
4 4                    
                                  
4
p
e d pp e d pp
p p p
p
e d pp
p
K K K K K K
P B P B J Z
s
P B
K K K
s Z
p p
p
+ + -
+
 
由於 eK 、 dK 、B及 J都大於零，若要滿足第一行正負符號不變，則相位迴路之比例積分控
制器必須滿足(4.17)式。 
2 2( )( ) 04 4
e d pp e d pp
p p p
K K K K K K
P J B P B J Z
p p
+ + - >                 (4.17) 
此處所建立的新型鎖相迴路速度控制器數學模型，將可做為控制器設計之依據，最後可總
結控制器參數設計滿足(4.8)式、(4.14)式及(4.17)式，則系統可達到穩定條件。 
4.3 控制器設計準則 
本節將提供新型鎖相迴路速度控制器參數之設計準則，並舉以一實際案例根據所提之 
 104 
(1) 速度迴路安定時間( 1t ) 
(2) 鎖相迴路安定時間( 2t ) 
(3) 相位安定時間( 3t ) 
由於新型鎖相迴路速度控制器採用雙迴路控制架構，以速度迴路控制器決定初期
的上升時間，接著以鎖相迴路控制器縮小細微的轉速誤差，最後達到鎖相的目的，
因此吾人可分配速度迴路控制器之安定時間 ( 1t )與相位迴路安定時間( 2 3t t+ )約為
7比 3。系統安定時間( st )等於速度迴路安定時間( 1t )、鎖相迴路安定時間( 2t )及相
位安定時間( 3t )之總合，故可得到安定時間之建議值如(4.18)式與(4.19)式所示。 
1 0.7 st t=                                    (4.18) 
2 3 0.3 st t t+ =                               (4.19) 
因此依據伺服系統所需的安定時間( st )可由(4.18)式、(4.19)式可獲得到新型鎖相迴
路速度控制器之響應規格之建議值。 
步驟三、控制器參數設計 
新型鎖相迴路速度控制器包含速度迴路比例積分控制器( psK 、 isK )、相位迴路領
先補償器( ppK 、 pZ 、 pP )、 MfD 與 LfD 共七個參數。吾人由步驟二制定之規格分別
設計各迴路控制器參數，其設計可分為三部份： 
(1) MfD 與 LfD  
    MfD 與 LfD 的選擇視系統而定，若伺服系統只使用速度控制器的最大穩態
誤差為 SEfD ，則可選擇 M SEf fD ³ D ，確保相位迴路控制器能夠正常運作， LfD 可
由頻率偵測器所能偵測的最小頻率誤差來決定。 
(2)速度迴路比例積分控制器( psK 、 isK ) 
 速度迴路控制器將以速度迴路安定時間( 1t )為設計目標，吾人採用極零點
對消之設計方法，因此速度迴路比例積分控制器可以(4.20)式表示。 
( )+ +
=ps is s
K s K Js Ba
s s
                        (4.20) 
其中 sa 為一速度迴路控制器參數，因此迴路增益 ( )SLGG s 為： 
( ) 1( )
( )
+
= ´ =
+
s
SLG s
aJs BG s a
s Js B s
               (4.21) 
而系統速度閉迴路增益 ( )SCLGG s 為：   
 106 
qD 1
+Js B
+
+
p
pp
p
s Z
K
s P
pT
2
dK
p
sf rw
2
eK
p
rf
rf
fD 2
Mf
p
D
sqD
 
圖 4.12 新型鎖相迴路速度控制系統於 2t 時間內之數學模型 
而圖 4.12之閉迴路增益 1( )PCLGG s 為：   
1
( ) 2( )
1 ( )
2
p
p
D
= =
+
+ +
D
p e d
LG M
PCLG
p e dLG
p
M
a K K
G s fG s a K KG s s P
f
            (4.27) 
因此吾人可由 2t 安定時間決定(4.27)式中的極點位置，而1/( )2
p e d
p
M
a K K
P
fp
+
D
即為
圖 4.12閉迴路系統中的時間常數，若以五倍閉迴路系統時間常數為 2t ，則可
得到(4.28)式。 
25 /( )2
p e d
p
M
a K K
P t
fp
+ =
D
                              (4.28) 
接下來考慮 3t 之時間區間內時，新型鎖相迴路速度控制即可視為圖 4.10，
由(4.15)式之開迴路增益為可得到圖 4.10之閉迴路增益為： 
2
2
2
2
( ) 4( )
1 ( )
4
p
p
= =
+ + +
p e d
PLG
PCLG
p e dPLG
p
a K K
G sG s a K KG s s P s
          (4.29) 
由(4.29)式特性方程式可得到圖 4.10之閉迴路系統極點： 
 
 108 
 
 
 
 
 
 110 
bsv
csv
asv
bsi
asi
rw
asi
bsi
IPMSM
*r
dsv
*r
qsv
*r
dsi
*r
qsi
, ,
    
  ,
as bs cs
ds qs
r
qsi
r
dsi
rq
csi
  ,
    
, ,
ds qs
as bs cs
     IMC
  Current
Controller
1
s
sqD
PT
Tw
sw wD
rf
+ps isK s K
s
2
eK
p
2
Mf
p
D
+
+
p
pp
p
s Z
K
s P2
dK
p
( )sC s
fD
( )pC s
sq
*T MTPA
Control
rwC
G I
G
PG
Current
Sensing
Circuit
csi
2
eK
p
rw
sfVCO
 
圖 4.14(a) 內嵌式永磁同步電動機新型鎖相迴路速度控制系統方塊圖 
 
 
 
1S
2S
3S
4S 6S
5S
Encoder
DCV
+
-
61~SS
61~PWMPWM
TMS320F2812
TMS320F2812  eZdsp
CPU
PWM module
A/D module
QEP module
DSP controller
4. D/A module
ai ci
GPIO
Lattice LFEC10E
FPGA
bi
 
圖 4.14(b) 內嵌式永磁同步電動機新型鎖相迴路速度控制系統實現架構圖 
 112 
向上數;反轉時為b領先a九十度，此時轉速編碼器的計數器為向下數，此外每旋轉一週會
產生一個脈波的方波訊號( z、z )，吾人可藉由 z方波訊號來決定轉子磁極的位置。a、b脈
波訊號提供給數位訊號處理器(DSP)之四象限轉速編碼器(QEP)單元做數位訊號處理，經過
轉速編碼器(QEP)單元後轉子每轉一週在 DSP 內的計數器將從零計數到八千。因為一週有
360 度所以其解析度為 360 除以八千，因此有很高的解析度，然而此三組脈波訊號可能會
因為電動機旋轉磁場的干擾或是類比電路的雜訊影響而造成轉速的估測誤差，這是因為如
果解碼器所產生的方波訊號雜訊過大將會使數位訊號處理器(DSP)之轉速解碼器(QEP)單元
產生誤判而影響轉速估測，所以在解碼器與數位訊號處理器(DSP)之間亦額外增加了一組介
面電路，如圖 4.16所示為a、a這組訊號處理之電路圖，而b、b和 z、 z 也相同。此介面
電路提供轉速解碼器(QEP)所需的 3.3伏特直流電壓，並且使用了三顆高速光耦合 IC-6N137
作為類比電路和數位電路之間的隔離電路，因為隔離了類比端和電動機端的雜訊，所以可
以獲得比較正確的轉速脈波。 
 
6N137
2
3
6
7
A
1K
470
+3.3V
8
5
a
a
0V
 
 
圖 4-16 轉速偵測電路 
 
3. 閘極隔離驅動電路 
在三相反流器驅動電路部分，由於部分開關元件(如 IGBT)不共地，因此以光耦合放大
器 TLP 250做為隔離驅動電路。如圖 4.17所示，因有六組相同原理之電路，故在此只舉一
組驅動電路做為說明。其由 DSP內建之脈波寬度調變模組產生之控制信 61 ~ PWMPWM ，
經光耦合放大器 TLP 250作為隔離驅動，再送至限流電阻以驅動 IGBT之用。 
 
 114 
 
控制器製作 
吾人之新型鎖相迴路控制器將以數位控制實現，數位控制具有下列諸多優點：(1) 系統
的穩定性提高，減少飄移；(2) 整合性強；(3) 使用之零件相對減少，維護容易，可大幅降
低維護成本；(4) 雜訊隔離能力強；(5) 容易更改控制法則，適合應用在開發階段之產品。
且微處理器工作頻率愈來愈快，雖然仍不若類比控制器快，但由於機械的響應緩慢，其應
用在機電整合領域上已將當足夠。 
吾人選用德州儀器公司(TI)之數位訊號處理器 TMS320F2812作為核心單元。其市場定
位於電力電子與電動機控制等領域，因此已內建脈波寬度調變(PWM)模組以及類比-數位轉
換器(ADC)等模組，故僅需簡易設定暫存器即可使用，其具有之特色如下所述： 
 
(1) 屬為 32位元之處理器。 
(2) 最高工作頻率為 150 MHz。 
(3) 有 16組脈波寬度調變(PWM)訊號。 
(4) 具有 16個通道的 12位元類比-數位轉換器。 
(5) 有七個計數器，包含三個 32位元處理器計數器(CPU Timer)與 
 四個 16位元通用計數器。 
(6) 有 6個捕捉單元(Capture Unit)，可切換為兩組 QEP。 
(7) 共有 56個 GPIO介面。 
(8) 具有 40kB的隨機存取記憶體(RAM)。 
(9) 周邊暫存器使用 C語言結構封裝，設定方便。 
 
圖 4.19為各週邊電路與數位訊號處理器之資料傳輸方塊圖，其中電流偵測電路偵測目
前輸入電動機的 a、c相電流大小後，即可透過 TMS320F2812數位訊號處理器內建之 ADC
將 0~3V之類比訊號，轉換成以二進位表示的數位訊號，分別儲存在兩組 12位元數位取樣
結果儲存器(ADCRESULT0、ADCRESULT1)中，以回授給電流控制器。編碼器產生之脈波
訊號經由光耦合電路可得到三組位置脈波訊號，透過數位訊號處理器內建的第一組 QEP，
偵測其中 a、b 相脈波訊號正/負邊緣，產生每轉 8000 次的脈波訊號，並觸發第二計數器
(T2CNT)，依據 a、b兩相脈波訊號超前或滯後關係，來判斷正轉或反轉。接著得到電動機
磁極位置，吾人先量測電動機磁極位置與編碼器 z 相脈波訊號之夾角，得知夾角大小後吾
人便可藉由 z相脈波訊號來矯正電動機之磁極位置，以供轉換參考座標之計算。 
 
 116 
 
圖 4.20程式流程圖 
 118 
量測轉速響應之穩態結果，其結果如圖 4.28、圖 4.29、圖 4.30及圖 4.31所示，圖中由上而下
分別為 sF、 rF與 PFD之輸出訊號，要特別說明的是吾人在此以數位邏輯訊號代表 PFD之輸出。
其結果皆可藉由鎖相迴路達到零頻率誤差。接著測試加載時之穩態轉速響應，吾人將負載電
動機外接電阻當成發電機使用。速度控制器分別下達 500rpm及 1000rpm之轉速命令，其結果
如圖 4.32及 4.33所示，即使在加載的情況下，依然可達到零頻率誤差之效果。 
 
 
圖 4.21 內嵌式永磁同步電動機驅動器硬體電路雛型 
 
 
圖 4.22 內嵌式永磁同步電動機機電模組 
 120 
6A
6A
r
dsi
r
qsi
 
圖 4.25以線性上升之轉矩命令產生的轉子座標直軸、交軸電流 
 
 
sw
200 secm
6A
r
dsi
rw
 239.7 
/ secrad
r
qsi
 
圖 4. 26轉速步階響應與轉子座標直軸電流、交軸電流 ( 239.7 / secs radw = ， 0N-mLoadT = ) 
 
 122 
500 secm
sF
rF
PFD
1-
1667Hz
 
圖 4. 29 無載下，轉速命令 1000rpm之鎖相結果(
sF =1667Hz,)  
 
 
100 secm
sF
rF
PFD
1-
3333Hz
 
圖 4. 30 無載下，轉速命令 2000rpm之鎖相結果( sF =3333Hz,) 
 
 124 
500 secm
sF
rF
PFD
1-
1667Hz
 
圖 4. 33 有載下，轉速命令 1000rpm之鎖相結果(
sF =1667Hz,) 
 
4.5 結論 
內嵌式永磁同步電動機擁有高效率、高功率密度之優點，因此非常適合應用在各種機
械驅動之領域。在加上近年來半導體技術快速發展，使功率半導體元件及數位訊號處理器
之價格不斷下降，性能卻不斷上升，使得實現向量控制控技術所需之硬體花費亦變的符合
經濟效益。精密控制為高科技產業界之基礎之ㄧ，凡舉半導體製程、化學、生物等領域的
生產過程必須依靠高精度之伺服控制，因此吾人選擇以鎖相迴路速度控制器作為本計畫之
研究基礎，並結合負載轉矩估測器作前饋補償，改善加載時之暫態響應，接著以提供一完
整之鎖相迴路速度控制器設計準則，作為實際應用於精密速度控制之解決方案。 
本計畫於第三章推導內嵌式永磁同步電動機之數學模型，並介紹內嵌式永磁同步電動
機之向量控制理論及單位安培最大轉矩控制策略，接著以負載轉矩前饋補償改善加載時之
暫態響應。接著在第四章中以模組化之方式規劃內嵌式永磁同步電動機驅動系統，將其分
為內嵌式永磁同步電動機、反流器及其閘極驅動電路、電流偵測電路、編碼器電路及 FPGA
電路部分，並以 DSP控制器為核心單元，整合各區塊電路之運作，最後針對所完成之實作
雛形系統進行實驗以驗證，以實驗結果驗證本計畫所提控制策略確實可行。 
 126 
第六章 計畫成果自評 
本子計畫除依計畫規劃目標完成強韌型鎖相式內模控制之直流無刷電機速度控制器及
永磁交流同步電動機強韌性高效率控制器外，於計畫執行期間在人才培育方面：參與學生
有碩士班九員已畢業，博士班一員已畢業，就學中博士班兩員。在專利部分：整合子計畫
一共同申請發明專利二件，分別為:『一種電機參數及轉子位置信號估測方法』發明專利申
請，案號：096101364，及『一種鎖相式速度控制裝置』 發明專利申請，案號：094105968。
於著作方面：發表 IEEE 國際期刊論文兩篇、國際研討會論文一篇及國內研討會論文十篇，
另有一篇 IEEE 國際期刊論文已投稿，正接受審稿委員建議修稿中。著作明細如下： 
 
1. Ching-Tsai Pan and Shinn-Ming Sue, “A Linear Maximum Torque Per Ampere Control for 
IPMSM Drives Over Full Speed Range,” IEEE Transactions on Energy Conversion, vol. 20, 
no. 2, pp. 359-366, Jun. 2005. 
2. Shinn-Ming Sue and Ching-Tsai Pan, “Voltage-Constraint-Tracking Based Field-Weakening 
Control of IPM Synchronous Motor Drives,” accepted by IEEE TIE, Sept. 2007. 
3. Ching-Tsai Pan and Emily Fang, “A Phase-Locked Loop Assisted Internal Model Adjustable 
Speed Controller for BLDC Motors,” submitted to IEEE TIE, Aug. 2007.(under revised) 
4. Shinn-Ming Sue, Ching-Tsai Pan, and Yuan-Chuen Hwang, “A New Field-Weakening 
Control Scheme for Surface Mounted Permanent-Magnet Synchronous Motor Drives,” in 
Proceeding of the 2nd IEEE Conference on Industrial Electronics and Applications, May 
2007, pp. 1515-1520. 
5. X. G. Zhong, G. Y. Cai, Z. X. Lin and Ching-Tsai Pan, 2005, “A Novel RFOC Sensorless 
Induction Motor Drive,” Proceedings of the 4th Symposium on Taiwan Power Electronics , 
pp.122-125. 
6. Tai-Long Tang and Ching-Tsai Pan, 2005, “A Fixed Structure Sliding Mode Position 
Controller for Linear Permanent Magnet Synchronous Motors with Load Disturbance 
Feedforward Controller,” Proceedings of the 4th Symposium on Taiwan Power Electronics , 
pp.13-17. 
7. Emily Fang and Ching-Tsai Pan, 2005, “A Novel IPMSM for Speed Sensorless Drives,” 
Proceedings of the 26th Symposium on Electrical Power Engineering, pp.641-645. 
8. Ting-Yu Chang, Emily Fang and Ching-Tsai Pan, 2005, “Implementation of a Speed 
Sensorless Drive for Permanent Magnet AC Motor, ” Proceedings of the 26th Symposium on 
Electrical Power Engineering, pp.342-345. 
 128 
 
 
 
 
 
 
子計畫三 
 130 
第二章 適用於 Split-Type控制器之永磁無刷馬達設計 
本計畫第一年旨在研發適用於 Split-Type控制器之永磁無刷馬達，此馬達設計為表面型
[1-4]，因馬達之功率小，故採用氧化鐵磁石，為配合 Split-Type控制器，定子三相繞組具備
六條引線，為在應用上平滑運轉，必須降低頓轉轉矩及轉矩鏈波[5-12]。本子計畫所研製的
馬達將提供給子計畫一作為Current Sensing及 Speed Sensorless速控與子計畫二作為 PPL速
控等技術研發之用。 
2. 1 馬達的設計基礎 
表面型氣隙之平均磁通密度為 
rg B
C
B
)41(1 lb
f
++
=
           (2.1) 
其中 =rB 永磁材料之剩磁(T)，C A Am gf = / 為磁通集中因素( Flux concentration factor)，Am
及 Ag 分別為磁石及每極氣隙之截面積[1], [2]，b = Â Âg mo/ 為氣隙與磁石之磁阻比[2]，
l =
Â
Â
mo
mm
為磁石間的漏磁比。參考圖 2.1線形的模型，可以計算各項參數如下： 
Â =g
c
o g
k g
Am  (2.2) 
Â =mo
m
o rec mA
l
m m       (2.3) 
其中 0m 為空氣導磁率， recm 為磁石之導磁率， l為鐵心有效軸長，g為氣隙長度， ml 及 mt
分別為磁石的充磁方向之長度及寬度， ck 為卡特係數(Carter’s coefficient)。同時，利用圓弧
直線磁導模型[4]， mmR 可近似為： 
R
gmm o f
=
+
p
m p tl
1
1ln( / )  (2.4) 
故 
l
p t
m p
=
+l lm f
rec m
g
A
ln( / )1
 (2.5) 
如果 gB 和 mB 已經指定，我們可得到磁石的充磁方向之長度 ml 為 
 132 
 
 
圖 2.2 馬達的雛型剖面圖 
2.3 馬達特性分析 
  本計畫應用有限元素法商用軟體 Flux2D作馬達雛型的電磁場分析。圖 2.3為馬達之磁
力線分佈圖。圖 2.4 為磁通密度分佈圖，因使用低能量的氧化鐵磁石，從圖中可以看出鐵
芯各部份均未飽和。圖 2.5為 2000rpm下反電勢波形，均方根值為 8.0伏特。圖 2.6為頓轉
轉矩波形，峰對峰值為 7.86×10-3 N-m，佔平均轉矩的 10.76 %，故此馬達之頓轉轉矩很小。
圖 2.7為平均轉矩波形，轉矩平均值為 0.073N.m。根據圖 2.7可知，穩態轉矩輸出為 0.073 
N.m.，故在 2000 rpm時，其輸出功率為 15.3 W。再經過 Flux 2D模擬結果得知穩態輸入功
率為 20.075 W，故輸出除以輸入得效率約為 76.21%，已經符合 75%之要求規格。圖 2.8為
相電流波形圖。圖 2.9為馬達實作完成照片。 
 
   
 
圖 2.3 磁力線分佈圖                 圖 2.4 磁通密度分佈圖 
 
 
 134 
 
 (a) 外型 
 
 (b) 轉子 
 
 (c) 定子 
圖 2.9 馬達實作完成照片 
 
 
 136 
4Rmo
ψ r /2 Rmm 4Rg
ψ m /2
ψ l /2
ψ g /2
    
4Rm
ψ r /2 4Rg
ψ g /2
 
   圖 3.3 化簡圖二磁路模型          圖 3.4 化簡圖四磁路模型 
其中 Br磁石之剩磁通密度，Ag及 Am 分別為每極氣隙及磁石之截面積，又 gm AAC /=f 為磁
通集中因素[5-9]。磁石之表面磁通密度為 
rm BB )421(1
)42(1
lhb
lhb
+++
++
=
 (3.3) 
磁石之工作點可由磁石之去磁特性曲線來計算磁石之磁場強度 
m rec o m rB H Bm m= +    (3.4) 
其中 recm 為磁石之回復導磁率( Recoil Permeability)。由以上方程式很容易可以計算磁導係數
(Permeance Coefficient，PC)， 
1 1 2 4( 2 4 ) ( )rec rec mo
g ml mm
PC R
R R R
m h l m
b
= + + = + +           (3.5) 
漏磁包括兩部份，兩相鄰磁石間經橋部之漏磁為 
rmm flhb
blf
)421(1
2
+++
=
 (3.6) 
兩相鄰磁石間經橋部上方空氣之漏磁為 
rml flhb
bh
f
)421(1 +++
=
 (3.7) 
磁石之總磁通為氣隙磁通加上兩漏磁，得到  
rm flhb
lhb
f
)421(1
)42(1
+++
++
=
                      (3.8) 
 138 
f
m
b cgk
m
crec
l
=
                         (3.16) 
其中 kc 為卡特係數(Carter coefficient)。 
只考慮磁石在氣隙所產生之基本磁通量，其大小為  
1 1 1 1 (1 2 4 )M g r
C
B k B k Bf
b h l
= =
+ + +
  (3.17) 
其中 )2/sin(/41 app=k 。故每極基本磁通量大小為 
2
sin
)421(1
4
11
ap
lhbp
f
rMM B
C
p
DB
p
D
+++
==F
ll
   (3.18) 
若每相串聯匝數為 phN ，繞組因數(Winding factor)為 1wK ，則每相之開路應電勢為 
fNKE Mphwq 112
2
F=
p
                    (3.19) 
直軸及橫軸之同步電抗為 
l
l
XNk
gp
fD
X phw
d
d +=
22
1"2
06m
  (3.20) 
l
l
XNk
gp
fD
X phw
q
q +=
22
1"2
06m
      (3.21) 
其中 lX 為每相漏抗且 
)421(1
1
1
"
lhb
a
+++
-
=
d
ad
c
d kk
k
gk
g
                (3.22) 
aq
c
q k
gkg
1
"=
                            (3.23) 
p
ap
a
sink ad +=1
， p
appa sin.sin.k aq
-
++=
10101
， 2/
)2/sin(
ap
ap
a =dk   (3.24) 
 140 
3.4 結果討論 
本計畫透過磁路分析設計馬達之雛型，經有限元素法作電磁場分析，以修正原設計，
並如期完成馬達的實作，交其他子計畫做測試應用。 
 
 
圖 3.5 馬達的雛型剖面圖 
 
 
     
圖 3.6 磁力線分佈圖               圖 3.7 6000rpm下反電勢波形 
 
 142 
 
    
             (a) 轉子                         (b) 定子 
 
(c) 定子繞組 
圖 3.12為馬達實作完成照片。 
 
 
 144 
    而 Nph會影響電氣負荷，且電氣負荷定義為轉子表面上之平均磁通密度： 
phase ph phase
m
N N I
ac
t
× ×
=                                      (4.5) 
其中 Nphase為相數，此為三相馬達故 Nphase為 3，Iphase為相電流(A)。因為電氣負荷對馬達內
部溫升與電抗有很大之影響，電氣負荷越大則導致高漏磁效應，同時也提高溫升與銅損。 
    根據上述之馬達特性公式，我們依照相關之電氣與磁氣特性，來決定定子尺寸大小。 
    定子內徑可由 3.1.1節中的極距與極數來決定，如(3.6)式所示： 
m m
in
ND t
p
´
=  (mm)                                (4.6) 
而槽距則可得如(4.7)式所示： 
in
s
s
Dt
N
p ´
=  (mm)                                 (4.7) 
    接下來要決定定子詳細尺寸，而針對不同的矽鋼片，其最大飽和磁通密度也不同，故
在設計時，不可讓定子鐵心有飽和現象出現，則定子之齒部寬 Wtb可由(4.8)式決定： 
s g
tb
tb st
t B
w
B k
´
=
´
(max)  (mm)                             (4.8) 
其中 Bg(max)為氣隙最大磁通密度，Btb為齒部飽和磁通密度約為 1.7~1.8 Tesla，kst為矽鋼片
堆疊係數約為 0.95~0.98之間。 
    而當定子齒部寬度決定後，則定子軛鐵寬度則可由(3.9)式決定： 
1
bi
st bi stk
Φw
2 k B L
=
´ ´ ´
 (mm)                         (4.9) 
其中 Bbi為定子軛鐵磁通密度，一般約介於 1.2~1.5 Tesla。 
    而槽開口寬度則影響繞線之方便性，透過實際繞線之廠商的了解，發現定子槽開口寬
度通常約為 2~3倍之線徑大小： 
( )2 3so coilw ~ D@  (mm)                             (4.10) 
其中 Dcoil為線徑(mm)。 
    氣隙長度對馬達的特性影響甚大，若是氣隙增大，則磁通所行進路徑之磁阻便加大，
進而降低效率，而氣隙太小則會導致定子齒部產生漏磁現象；在表面型馬達應用於高速運
轉下時，通常會在表面磁石外套上非導磁材料，而相對的氣隙長度也會增大，故在設計時
 146 
( )2coil2 D 2ph
A
slot
N π
η
A
´ ´
=                            (4.17) 
其中 Aslot為槽面積(mm2)；此計算方式並未包含絕緣層厚度，故在設計此佔積率時，一般都
將其大小設計低於 0.5。 
4.2永磁交流馬達設計原理 
    永磁交流馬達的主要尺寸是指定子內徑，定子鐵心的有效長度(積厚)和磁石體積。馬達
的主要尺寸決定了馬達的外型輪廓、馬達質量及材料費用，如果主要尺寸設計選擇合理的
話，如此一來設計工作就會有一個初步的準則，再以此準則加以修改，以得理想的設計結
果。因此由文獻可知若馬達的定子內徑為 1r 及積厚為 l主要的尺寸決定後，其他相關尺寸便
可依次決定。 
  永磁交流馬達在穩態運轉時，轉子的轉速是輸入頻率與磁石極數的關係如(4.18)式所
示： 
P
120 fN s =
                                (4.18) 
其中 sN 為同步速度(rpm)， f為頻率。其中永磁同步馬達定子反電動勢(EMF)隨著時間作正
弦變化，所以可以由電磁感應定律得到定子反電動勢E如(4.19)式所示： 
-8
phE 2.22 K f N 10f= ´ ´ ´ ´ ´                  (4.19) 
其中K為定子繞組因數， phN 為定子繞組每相串聯導體數，f為每極磁通量。當氣隙磁通
密度沿著轉子外作正弦分佈時，每極磁通量的關係如(4.20)式所示： 
0.637mg
B =
´ ´l
Φ
τ
                           (4.20) 
其中 mgB 為氣隙磁通密度的峰值，τ為極距， l為積厚。 
  當我們在馬達設計中有一個電磁參數非常重要，這參數是電樞線電流密度(Armature 
line current density)或稱為電氣負荷(Electric loading)，其中電氣負荷定義是沿定子內徑圓周
方向單位長度的安培導體數，如(4.21)式所示： 
1 ph3 4000~5000pa
K N I
J
P
´ ´ ´
= =                    (4.21)                    
 148 
度，藉由這兩項方程式，求得內藏型的轉子直徑，其式如(4.28)式所示：  
giniro 2rr -=                                  (4.28) 
  因為轉子還包含了軸承的部分，然而軸承一般為非導磁材料，所以我們需要計算出轉
子軛鐵的最小高度 rih ，以避免轉子軛鐵的部分有飽和的情形發生，其式如(4.29)式所示[7]： 
r
2
g in
ri
ri
B
h
B
=                                      (4.29) 
其中 Bri為轉子軛鐵磁通密度，其值的選擇與 siB 相同，一般都取低於 1.9 Tesla。所以內藏
型轉軸的直徑 ishr 最大可達： 
r r 2ish iro rih= -                              (4.30) 
    馬達定子槽部大小的設計是非常重要的。由於槽的面積與佔積率和熱密度有關，如果
定子槽部面積大，那麼馬達體積也相對的要增大，但定子槽部面積又不能太小，使得佔積
率超過了繞線所允許的水準。而且定子槽部面積太小，也可能使槽電流密度過大，使線匝
散熱不易，影響可靠度。另外，槽開口的大小也是造成頓轉轉矩的重要因素，如果槽開口
太大頓轉轉矩就會增大，但如果太小入線就會困難，因此在設計上必須要審慎衡量取捨。 
  對於一個氣隙磁通密度大約在 0.5~1.2 Tesla的永磁同步馬達而言，最佳的齒寬對槽寬
的比幾乎等於一，依據這樣的條件可先求出齒寬 tw 和槽寬 Sw 如(4.31)式所示 
s
in
st n
r1.57ww ´==
                            (4.31) 
其中 Sn 為槽數。而槽深 hs也可由(4.32)式計算出： 
sss kh w=   (4.32) 
其中 Sk 為槽深與槽寬之間的比。槽深確定之後，就可分別求得槽底寬度 sbw 及定子軛鐵高
度 sih ，其式如(4.33)式與(4.34)式所示： 
s
stins
sb n
nwDh
w
-+
=
)6.28( p
                        (4.33) 
lsist
si BK
h
2F
=
                               (4.34) 
 150 
 
 
圖 4.1 馬達基本尺寸圖 
 
此為一簡單之馬達設計程式，且具有繪圖功能，我們可直接由程式所計算出之尺寸來
繪圖，也可重新輸入參數來繪製馬達圖形，而其程式主畫面如圖 4.3 所示。在程式左上方
輸入所須計算之參數，然後點選按鈕 “Calc.”，此時便會在輸出參數中跑出結果，並且在右
方顯示圖形，而在此若需改結構參數來觀察馬達圖形，則可直接在結構參數處修改，並點
選按鈕 “Print”，便會於右方顯示；在結構參數下方按鈕 “Picture”，其為馬達結構示意圖，
如圖 4.1所示。 
4.3.2 永磁交流馬達程式設計 
   將前兩節的設計要領與磁路模型，整理成設計流程圖 4.4所示，再以 Visual Basic 6.0
撰寫成交談式程式，包括輸入畫面如圖 4.5 所示，輸入的参數有輸出馬力、轉速、積厚以
及繞線方式….等等，接著經由參數的計算可得如圖 4.6 所示，若所得到的內部參數不滿意
時，使用者可以自行回到輸入畫面作為修改，當內部參數確立之後就可計算出馬達定轉子
的尺寸，如圖 4.7所示有槽口寬，齒部寬以及槽面積…..等等，並顯示出馬達設計的雛形如
圖 4.8所示，至於本章馬達設計的規格與馬達特性分析將在第四章介紹。 
 
 152 
 
圖 4.4 程式設計流程圖 
 
 
 
 
圖 4.5 輸入畫面 
 154 
 
圖 4.8 永磁交流馬達雛形 
4.4 繞組設計 
繞組設計對於任何一種類型的馬達均極為重要，一個馬達的繞組型式會影響馬達的反
電勢(EMF)波形及大小，線圈的自感及互感，轉矩大小，轉矩漣波，以及散熱和溫升。 
    交流電機繞組設計的基本原則，是在 m相的馬達繞組中每相繞組的反電勢振幅相同，
但是相角彼此必須相差 360/m電機角度(°E) ，以三相交流電機為例，三相平衡繞組所產生
的反電勢彼此必須相差 120 度電機角度，亦即是三相繞組在定子槽中的匝數必須相同，而
每相線圈空間中的放置位置，必須彼此相距 120 度電機角度。本計畫將以三相無刷永磁馬
達為對象，來討論馬達繞組設計程序，而所呈現之繞組設計方法將可以應用於其它型式之
交流電機。 
4.4.1極數與槽數的選擇[6] 
三相電流電機的極數與槽數，有著非常多的可能組合，但並非所有的組合均可以用來
繞製三相平衡繞組，平衡繞組之三相馬達的極數(Np)與槽數(Ns)的可行組合必須滿足(4.38)
式 
( )[ ] KNNGCD
N
ps
s 3
,
=                                              (4.38) 
 156 
s
p
s N
EN o180´
=q                                                    (4.31) 
亦即線圈跨距必然是 θs的整數倍，任意選擇線圈跨距的電機角度，在實際繞線時並無法實
現，所以線圈跨距採用槽數 S*來描述較恰當，可以避免所設計的繞組無法實際繞製的情況，
線圈跨距 S*通常以下式來選擇 
ú
û
ù
ê
ë
é
÷÷
ø
ö
çç
è
æ
=* 1,180maxS
s
fix
q
                                              (4.32) 
其 θs是每槽所跨的電機角度， fix(.)是取整數部分，max〔x，y〕是取兩數之最大值，如果
欲採用短節距之繞組，則可選擇(S*-1)槽作為線圈之跨距槽數。 
4.4.3每相繞組之相位偏移槽數 (phase offset) K0的計算 
如前所述，三相馬達中的每一相線圈的反電勢大小及波形必須相同，但是其相位必須
相差 120度電機角度，亦即當 A相線圈設計完成後，順著電機旋轉方向，偏移 120度電機
角度，即是 B相線圈所應放置位置，再將 B相線圈放置位置順著旋轉方向偏移 120度電機
角度，即可得到 C 相線圈之應放置位置，所偏移的 120 度電機角度稱之為相位偏移(phase 
offset) K0，在實際繞線時，必然必須藉由偏移幾個整數槽來完成 A相、B相、C相線圈的
佈置，所以所選擇之電機結構時，其每槽所跨之電機角度 θs，必須是 120 的正因數，否則
將無法提供正確之 120 ﾟ相位偏移，亦即無法製作三相平衡繞組，相位偏移 K0通常是以槽
數來表示 
s
qK
q
oo 360120
0
´+
=     ，q=0、1、2、3…,((Np/2)-1)                    (4.33) 
當所選擇之電機極數 Np與槽數 Ns的組合，無法提供一個正整數 K0槽，作為 120°E之
相位偏移時，則意味著所選用之極數與槽數是一個無法繞製三相平衡線圈的無效組合。值
得注意的是，K0並非是單一解，例如三相 4 極 12 槽的馬達結構，其 K0可已是 2 或 8，但
通常只需選擇最小值即可。 
4.4.4線圈設計之步驟 
文獻有關於電機繞組設計，大部分都僅簡略介紹繞組型式，例如疊繞、波繞、同心繞、
弦波繞組等，對於繞組設計之流程的細節則少有提及，而電機機械教材關於繞組的介紹，
亦常是侷限在以整數槽馬達為討論對象，而對於分數槽馬達所需的繞組設計則討論甚少。
討論繞組設計之前先定義電機每相每極槽數 Spp(slot per pole and per phase)如下： 
php
s
pp NN
NS
´
=                                                    (4.34) 
其中 Ns為定子槽數目，Np為磁極數，Nph為相數。 
 158 
一個線圈的相位角。 
( ) ( ) sc Kk qq ´-= 1  ，k=1,2,3,…,Ns.                                 (3.8) 
其中 θs為每槽所跨之電機角度。 
    當線圈角度超過 360 ﾟ E時，則使用下列函數來校正其角度 
    ( ) ( )( )Ekremk cc °= 360,ˆ qq                                  (3.9) 
    其中 rem(x，y)是取 x/y的餘數 
將 270 ﾟ< θc < 360 ﾟ之間線圈相位角，改以-90 ﾟ< θc < 0 ﾟ來表示，而相位角位於 90 ﾟ< θc 
< 270 ﾟ之間的線圈，則將線圈的頭尾對調，則線圈相位角，將會減 180 ﾟ E，此時所有
之線圈的相位角均落在一、四象限(±90°E)之內。 
8、指定編號 1 的線圈當作 A相的第一個線圈，因為第一個線圈的相位角為 0 度，所以再
選擇(Ncph-1)個相位角最接近 0度的線圈，構成完整之 A相線圈，如此的選擇將可以使
A相繞組之感應反電勢最大化。但是線圈組合通常並非唯一，不同的線圈組合會影響到
馬達繞組感應之反電勢大小、波形、諧波含量，間接影響馬達轉矩的大小及轉矩漣波含
量。 
9、B相線圈及 C相線圈，則可由 A相線圈編號加上 K0及 2 K0分別得到。 
4.4.5 繞線程式設計 
    根據以上的推導與步驟，利用 VB6.0(Visual Basic 6.0)來將其程式化，以便我們在馬達
設計初期，可以快速的將繞線計算出來。在程式中我們利用許多馬達的繞線條件，其條件
為馬達為三相平衡繞組、槽數與極數分別為 3與 2的倍數、及 K0必須存在且為整數。主程
式流程圖如圖 4.9所示，說明如下： 
<1>  首先輸入資料為槽數(Ns)、極數(Nm)。 
<2>  判斷此槽數與極數組合是否符合繞線條件。 
<3>  計算繞線所需之參數 S*、K0、θS。 
<4>  尋找所有可行之繞線組合。 
<5>  將其依照相同之 Kw分類。 
<6>  選擇一種繞線組合。 
<7>  產生 A、B、C三相繞線表。 
<8>  連結至 FEA軟體且計算馬達特性。 
    其中 “Search for possible winding layout sets” 為副程式，此為整個理論之核心，此副程
式之流程圖如圖 4.10所示。 
 160 
START
Create an unvalid winding 
layout table using K0
Select coil number 1 to be 
phase sequence
Does the coil 
number satisfy?
Select next coil number
Reselect coil 
numberYes
Save temporarily
Total coil 
numbers = Ncph?
Save all the 
winding layouts
No
No
Is it the 
final layout?
Is it the same layout 
with previous one?
Yes
No
Reset the selected 
coil number
Yes
No
End
Yes
 
 
圖 4.10 馬達繞線副程式流程圖 
 162 
 
圖 4.13  4極 9槽之繞線程式計算結果圖 
 
 
 
 164 
Magnetization on the Performance of PM Motors,” Proceedings of the 26th Symposium on 
Electrical Power Engineering, pp.161-164, Jung-Li. (NSC 94-2213-E-035-004) 
5.  C. C. Hwang, M. H. Wu, and S. P. Cheng, December 9-10, 2005, “Performance Analysis of 
Permanent Magnet Brushless DC Motor with Different Slot-opening and Pole-arc,” 
Proceedings of the 26th Symposium on Electrical Power Engineering, pp.2187-2190, 
Jung-Li. (NSC 93-2213-E-035-048) 
6.  C. C. Hwang, Ping-Lun Li, Shih-Ping Cheng, and Li-Yang Lyu, December 22-23, 2006, 
“Robust Average Torque Optimization of AFPM Motors Using the Taguchi Methods,” 
Proceedings of the 27th Symposium on Electrical Power Engineering, OC4.5, Hsin-chu. 
(NSC95-2221-E-035-132) 
5.1.2 國際研討會論文 
1.  C. C. Hwang and T. Y. Lin, April 30-May 3, 2006, ”Design Optimization for Cogging 
Torque Minimization of a High-Speed 2-Pole IPM Machine,” Proceedings of the 12th 
Biennial IEEE Conference on Electromagnetic Field Computation (IEEE CEFC2006), pp. 
234, Miami, Floria, USA. (NSC94-2213-E-035-004) 
2.  C. C. Hwang, S. P. Cheng, and M. H. Wu, May 8-12, 2006, “Magnetic Modeling of 
Synchronous Motors with Surface-Mounted Magnets, “Proceedings of the International 
Magnetics Conference(Intermag 2006), pp. 498, San Diego, California, USA. 
(NSC94-2213-E-035-004) 
3.  C. C. Hwang and S. P. Cheng, May 3-5, 2007, “An Automatic Winding Layout Technique 
for Permanent Magnet Machines,” Proceedings of the 2007 IEEE International Electric 
Machines and Drives Conference Record (IEMDC07), pp. 766-769, Antalya, Turkey. 
(NSC95-2221-E-035-132) 
5.1.3國外期刊 
1.  C.C. Hwang, M.H. Wu, and S.P. Chen, September 2006, “Influence of Pole and Slot 
Combinations on Cogging Torque in Fractional Slot PM Motors, “Journal of Magnetism and 
Magnetic Materials, Vol. 304, pp. e430-e432. (NSC93-2213-E-035-048). 
2.  S. P. Cheng and C. C. Hwang, February, 2007, “Design of High-Performance Spindle 
Motors with Single-Layer Concentrated Windings and Unequal Tooth widths,” IEEE 
Transactions on Magnetics, Vol. 43, No. 2, pp.802-804. (NSC 95-2221-E-035-017-132) 
3.  Chang-Chou Hwang and Chuen-Lin Tien, “Magnetic Modeling of Synchronous Motors with 
 166 
參考文獻 
子計畫一 
[1] B. K. Bose, “ Modern power electronic and ac drives, ” Prentice Hall  PTR, ISBN 0-13 
-016743-6, 2001. 
[2] R. Krishnan, “ Electric motor drives modeling, analysis and control, ” Prentice- Hall, ISBN 
0-13-093067-9, 2001. 
[3] P. Pillay and R. Krishnan, ”Modeling, simulation, and analysis of permanent- magnet motor 
drives, part II: the brushless DC motor drive,” IEEE Trans. Ind. Appl., vol. 25, no.2, 
pp.274-279, March/April 1989. 
[4]  M. G. Simoes and P. Vieira, “A high-torque low-speed multiphase brushless machine-a 
perspective application for electric vehicles,” IEEE Trans. on Industrial Electronics, vol. 49, 
no. 5, pp.1154-1164, October 2002. 
[5] S. Bentouati, Z. Q. Zhu, and D. Howe, “Permanent magnet brushless dc motors for 
consumer products,” Ninth International Conference on Electrical Machines and Drive, 
Conference Publication No. 468, pp.118-122, 1999. 
[6] T. F. Chan, L. T. Yan, and S. Y. Fang, “In wheel permanent-magnet brushless dc motor drive 
for an electric bicycle,” IEEE Trans. On Energy Conversion, vol. 17, no. 2, pp.229-233, June 
2002. 
[7]  T. Gopalarathnam, S. Waikar, H. A. Toliyat, M. S. Arefeen, and J. C. Moreira, “Development 
of low cost multi-phase brushless dc motors with unipolar current excitations,” Conference 
Record, IEEE-IAS Annual Meeting, pp. 173-179, 1999. 
[8]  S. J. Park, H. W. Park, M. H. Lee, and F. Harashima, “A new approach for 
minimum-torque-ripple maximum-efficiency control of bldc motor,” IEEE Trans. On 
Industrial Electronic, vol. 47, no. 1, pp. 109-114,February 2000. 
[9] International Rectifier, “IR2175(S) linear circuit sensing IC,” Data sheet, NO.PD60208-A. 
[10] Unitrode Integrated Circuit Corporation, “Switchmode driver for f3  brushless dc motors,” 
Data sheet, pp.5.34-5.38, 1990. 
[11] T. S. Kim, S. C. Ahn and D. S. Hyun, “A new current control algorithm for torque ripple 
reduction of bldc motors,” IECOM’01: the 27th annual conference of the IEEE Industrial 
Electronics Society, pp.1521-1526, 2001. 
[12] Texas Instruments, “Sensorless controlled brushless dc drive using the TMS320c242 DSP 
controller,” Application report, SPRA498, December 1998. 
 168 
synchronous motors,” IEEE Trans. Ind. Electron., vol. 40, pp.307-316, June 1993. 
[26] A. B. Kulkarni and M. Ehsani, “A novel position sensor elimination technique for the 
interior permanent magnet synchronous motor drive,” IEEE trans. Ind. Applicat., vol. 28, 
pp.144-150, Jan./feb. 1992. 
[27] M. Schroedl, “sensorless control of AC machines at low speed and standstill based on the 
“INFORM” method,” in Proc. IEEE-IAS Annu. Meeting, pp.270-277, Oct. 6-10, 1996. 
[28] S. Ogasawara and H. Akagi, ”An approach to real time position estimation at zero and low 
speed for a PM motor based on saliency,” in Proc. IEEE-IAS Annu. Meeting, pp.29-35, Oct. 
6-10, 1996. 
[29] J. C. Moreira, “Indirect sensing for rotor flux position of permanent magnet AC motors 
operating in a wide speed range,” IEEE Trans. Ind. Applicat., vol.32, pp.1394-1401, 
Nov./dec. 1996. 
[30] S. Ostlund and M. Brokemper, “Sensorless rotor-position detection from zero to rated speed 
for an integrated PM synchronous motor drive,” IEEE Trans. Ind. Applicat., vol. 32, 
pp.1158-1165, Sept./Oct. 1996. 
[31] T. Noguchi, K. Yamada, S Kondo, and J. Takahashi, “Initial rotor position estimation method 
of sensorless PM motor with no sensitivity to armature resistance,” IEEE Trans. Ind. 
Electron., vol. 45, pp.118-125, Feb. 1998.  
[32] P. C. Krause and O. Wasynczuk, “ Electro- mechanical Motor Sevices,” McGraw-Hill Book 
Company, ISBN 0-07-100513-7, 1989 
子計畫二 
[1]  S. Rajagopalan, J. M. Aller, J. A. Restrepo, T. G. Habetler and R. G. Harley, 
“Analytical-Wavelet-Ridge-Based Detection of Dynamic Eccentricity in Brushless Direct 
Current (BLDC) Motors Functioning Under Dynamic Operating Conditions,” IEEE Trans. 
Ind. Electron., vol. 54, no. 3, pp. 1410-1419, June 2007. 
[2] C. Cavallaro, A. O. D. Tommaso, R. Miceli, A. Raciti, G. R. Galluzzo and M. Trapanese, 
“Efficiency Enhancement of Permanent-Magnet Synchronous Motor Drives by Online Loss 
Minimization Approaches,” IEEE Trans. Ind. Electron., vol. 52, no. 4, pp. 1153-1160, Aug. 
2005. 
[3] A. A. Aboulnaga, P. C. Desai, F. Rodriguez, T. R. Cooke and A. Emadi, “A Novel, Low-Cost, 
High-Performance Single-Phase Adjustable-Speed Motor Drive Using PM Brush-Less DC 
Machine: IIT's Design for 2003 Future Energy Challenge,” in 2004 Proc. IEEE APEC Conf., 
 170 
[16] P. Pillay and R. Krishnan, “Modeling, simulation, and analysis of permanent magnet motor 
drives. Part Ⅱ: the brushless dc motor drive,” IEEE Trans. Ind. Appl, vol. IA-25, no.2, pp. 
274-279, March/April 1989. 
[17] B. K. Bose, “Modern power electronics and ac drives,” Prentice-Hall Inc., ISBN 
0-13-016743-6, 2001. 
[18] E. V. Appleton, “Automatic synchronization of triode  oscillators,”in Proc. Cambridge Phil. 
Soc., Vol. 21, pt. III ,1922-1923 , p.231  
[19] H. D. Bellescize, “La reception synchorone,”Onde Electr., vol. 11, June 1932 , pp.230-240  
[20] K. J. Astrom and T. Hagglund, “PID Controllers: theory, design and tuning”, Research 
Triangle Park, NC:ISA, 1995. 
[21] C. T. Pan, S. M. Sue “A linear maximum torque per ampere control for IPMSM drives over 
full-speed range,” IEEE Trans. on Eneg. Conv., Vol. 20, NO. 2, June 2005, pp.359 – 36 
[22] G. F. Franklin, J. D. Powell, A. E. Naeini, Feedback control of dynamic systems, 4th edition, 
Prearson press. Pretice Hall, ISBN:0130980412,2003 
子計畫三 
第一年 
[1]  T. J. E. Miller, Brushless Permanent-Magnet and Reluctance Motor Drives, Clarendon Press, 
Oxxford, 1989. 
[2]  J. R. Hendershot, Design of brushless permanent magnet motors, Magna Physics Corp., 
Hillboro, OH, 1991. 
[3]  R. Hendershot and T.J.E. Miller, Design of Brushless Permanent Magnet Motors, Magna 
Physics Publishing., Hillboro, OH, 1994. 
[4]  D. C. Hanselman, Brushless Permanent Magnet Motor Design, McGraw-Hill Book Co., 
New York, 1994. 
[5]  J.F. Gieras and M. Wing, Permanent Magnet Motor Technology, Design and Applications, 
Marcel Dekker, Inc., New York, 1997. 
[6]  Wen-Bin Tsai and Ting-Yu Chang, “Analysis o f Flux Leakage  in a Brushless  
Permanent-Magnet  Motor with Embedded  Magnets,” IEEE Transactions on 
Magnetics, Vol. 35, No. 1, pp. 543-547, January 1999. 
[7]  C. C. Hwang, T. T. Lo, and M. H. Wu, “The Effect of Change the Slot Opening of An 8-pole 
9-slot Permanent Magnet Brushless DC Motor,” Proceedings of the 25th Symposium on 
Electrical Power Engineering, Vol. 2, pp. 979-983, Dec. 19~20, 2004, Tainan. 
