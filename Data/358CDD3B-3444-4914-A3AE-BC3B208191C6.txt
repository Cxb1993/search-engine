 1
行政院國家科學委員會專題研究計畫成果 
 
有限巡行距離下混合收、送貨之車輛途程問題研究 
The Vehicle Routing Problems with Mixed Load under Distance Constraints 
 計畫編號：NSC 94-2213-E-224-009- 
 執行期限： 94 年 8 月 1 日至 95 年 7 月 31 日 
 計畫主持人：黃志剛 
 
摘要 
車輛途程問題於現今實際配送情況，服
務需求點通常具有同時收送貨作業要求，因
而演變成為較複雜的途程問題。而在相關研
究中，傳統目標式均採最短距離或最小距離
成本以決定車輛路線，並無考量車輛於途程
需求點間空車運行成本之浪費，故本研究建
構一除了考量車輛行駛距離成本外，尚考量
途程需求點間空車運行懲罰成本之完整數
學模式，並以禁忌搜尋法建構求解架構與方
法。經設計各類型例題之測試結果顯示：本
研究所提之考慮車輛載貨率之成本模式，其
控制懲罰成本的效果將可有效提高車輛的
載貨率，進而達到縮減途程數(派車數)之效
益。 
關鍵詞：車輛途程問題、空車運行懲罰成     
本、需求點同時收送貨、禁忌搜尋
法 
ABSTRACT 
Vehicle routing problems (VRP) with the 
real world situation, some service point may 
require receiving and delivering goods at the 
same time. 
This research constructs a mathematic 
model which considers both distance cost and 
empty vehicle penalty cost in the objective 
function. It is assumed that any service point 
may require pure receiving goods, or pure 
delivering goods, or both. This research is  
then develop a solution algorithm by using 
Tabu Search. Hopefully, the results can 
increase the vehicle utilization and reduce 
number of routes as well. 
Some numerical examples are also used 
to demonstrate the effectiveness and 
efficiency of the model and solution algorithm. 
The results indicate that the model and 
algorithm proposed in this research can 
increase vehicle utilization and reduce travel 
cost significantly.  
Keywords: Vehicle Routing Problem, Empty 
Vehicle Penalty Cost, Pick up and 
Deliver at same point, Tabu 
Search. 
1. 前言 
產品以物流中心為例，實體配送成本當
中，運輸成本佔46%、倉儲佔26%、存貨佔
10%、裝運驗收佔6%、包裝佔5%…等，以
運輸成本 46%所佔之比例最高 (吳淵齊
1995)。故其運輸配送路線規劃良窳對於流
通業的成本節省有相當的影響，若能從運輸
成本著手改善，其將可提升流通服務業競爭
力與營運能力。 
車輛途程問題所探討的除了一般的收
送貨問題，若以營業者角度考量，希望能以
有限的資源達到最佳的運用，因此在問題範
圍的定義上，會有不同的限制，如時間窗或
車輛行駛距離等。而以作業型態觀之，在單
 3
換法，設計一萬用式啟發式演算法來求解含
時窗限制之可同時收貨、送貨的車輛途程問
題。 
以上混合收送貨之相關研究，主要針對
含時窗限制之問題求解最短路徑，並同時評
估求解效率。以成本評估方面，均僅考慮車
輛行駛距離成本，若以車載容量限制觀之，
對於需求點具備單一收貨、送貨與同時收送
貨作業狀態，無考量車輛各站行駛間之載量
空間使用效率，其在需求點間運送，有可能
出現車載量過少的情況，浪費了車輛空間之
使用率。於時窗限制方面，主要希望車輛能
夠有效率的在有限時間內，完成所有的服務
作業。本研究採取相同效果之車輛行駛長度
限制作為基本假設，針對上述問題，探討車
輛在需求點同時混合收送貨的狀況下，求取
車輛行駛距離成本最少、車輛空間使用率最
高之途程安排。  
2.3 田口方法 
田口方法(Taguchi Methods)乃是由田口
玄一博士所倡導的田口方法，主要以品質損
失函數(Quality Loss Function)來衡量技術的
成本效益，並且利用參數設計 (Parameter 
Design)於實際作業上找出變異性最小的產
品或製程，來提昇和穩定產品品質。故此方
法能在最短的時間、最低的成本及最少的實
驗次數下，完成參數之穩健設計。 
由於禁忌搜尋法在運算過程，參數之設
定對求解品質及效率有所影響，因此，本研
究將利用田口方法概念，探討禁忌搜尋法之
較佳參數組合，以達到運送成本越小越好之
品質目標值(望小品質特性)。 
3. 模式建構 
本研究主要是以每天為時間單位，假設
單一場站(Depot)、車種單一，在容量與距離
限制之下探討車輛途程問題。模式建構概
念，除了以最短距離為評估成本依據之外，
尚考量車輛途程間，各需求點間之空車運行
成本，其性質接近懲罰成本的概念。以下為
本研究之基本假設、參數變數定義及數學規
劃模式介紹。 
3.1 基本假設 
(1)單一場站(Depot)，即指單一收貨、送貨
的集中點，且位置已知。 
(2)需求點個數及所在位置已知。 
(3)單一車種且車輛數未知。 
(4)一車服務一途程。 
(5)車輛的途程由場站出發，最後亦回到場
站。 
(6)單一途程中每個需求點，需被車輛服務過
一次，且僅一次。 
(7)車輛到達需求點 i 也須從需求點 i 離
開。 
(8)相同途程中之需求點，須由同一車輛服
務。 
(9)車輛之容量與最大行駛距離限制已知。 
(10)每輛車之裝載容量不能超過其容量限
制。 
(11)每需求點之載貨量不可超過單一車容
量。 
(12)車輛累積行駛距離不可超過最大行駛距
離。 
(13)需求點可包含收貨、送貨及同時收與送
三種需求之一，需求量已知且固定。 
3.2 參數變數定義 
I：需求點之集合。 
N：I∪{0}。0 代表場站(Depot)，I 代表所有
需求點之集合。 
P：所有需求點之貨物收取量總合。 
D：所有需求點之貨物送出量總合。 
Q ：車輛之最大固定載貨量。 
K：總車輛數，即總途程數。 
k：車輛之標號。k=1, 2, …, K。 
C ：車輛運行每單位距離成本。 
β：空車運行每單位距離之懲罰成本，為一
定值，由經營業者自行決定。 
, 1i il + ：需求點 i 到需求點 i +1 之距離。 
 5
機制，能夠將之前搜尋過的移步，記錄在名
單中以防止重複搜尋、陷入迴圈中。其跳脫
區域解之方式，主要為在演算法執行搜尋
時，會以鄰近搜尋結果所求得之最佳鄰近解
為目前解，一旦發現搜尋的區域，解無法再
改善時，便會依上區域所求得之最佳鄰近解
為新的解，再持續移向鄰近區域搜尋，如此
便可避免區域最佳解狀況，增加搜尋的廣
度，其執行流程如圖3.1所示。 
 
開始
初始解
搜尋鄰域最佳解
(候選名單 )
符合免禁規則
Z<Z *？
存在禁忌名單
中？
新解取代舊解
Z *=Z
結束
進行移步
設定起始參數
記入禁忌名單
N o
Y es
Y es
已達
終止條件？
Y es
N o
進行移步
新解優於舊解
Z<Z*？
Y es
新解取代舊解
Z*=Z
N o
選擇次佳鄰域解
N o
圖3.1 禁忌搜尋法執行流程圖 
本研究禁忌搜尋法的重要參數說明如
下，其中將對於求解品質與速度有影響之移
步方式、候選名單、禁忌名單與迭代次數等
四項參數採直交表實驗設計法，選取最佳參
數值設定，其詳細設定過程及結果將於4.2
節說明之。 
(1) 移步 (Move)  
本研究將採1-0、1-1節點交換法進行移
步，其移步之詳細執行方式，於3.4.2節說
明。本研究禁忌搜尋法之執行方式，主要採
完成單一鄰域交換方式後，依其改善結果作
為下一種鄰域交換方式之初始解，持續進行
改善，以三種鄰域改善法交替執行結束之解
為最終結果。 
(2) 禁忌名單 (Tabu List)  
本研究之禁忌名單設計有兩個，一為記
錄途程間之禁忌移步，其記錄屬性為某一途
程之節點交換至另一途程；另一為記錄途程
內之禁忌移步，其記錄屬性為交換之節線。 
(3) 渴望準則 (Aspiration Level)  
本研究將以優於目前最佳解為渴望準
則，若解優於目前最佳解，則此移步將被釋
放。 
(4) 候選名單 (Candidate List)  
對目標函數值貢獻最大者，進行迭代，
一旦進行迭代，重新進行鄰域解搜尋，其候
選名單即更新。 
(5) 終止條件 (Stopping Criterion)  
本研究將採預設演算最大迭代次數為
本研究之搜尋終止條件。 
3.4.1 起始途程建構 
本研究採 Clark與 Wright (1964)提出
的節省法作為起使途程建構方式。除了原節
省成本值之計算方式，本研究將加入需求點 
i+1 之節省值 ( , 1)Sv i i + ，定義為車輛距離承
載節省成本： 
各式中之 ( , 1)S i i + 為未經修改之原節省
值，表示需求點 i+1 加入途程 i 的途程距
離節省成本；Q為車輛之最大固定載貨量；
iQ 為車輛於需求點 i 之載量； ifQ 為車輛於
需求點 i 之剩餘空間，即納入需求點 i+1 
前的剩餘空間；C 為車輛行駛單位距離成
本。 
分兩種狀況判斷納入需求點對於安排
( )( , 1) 1 1( , 1) i i i iQCSv i i S C d p+ + ++ = − −  
If 1 1i ip d+ +<  且 1 1( )i i ifd p Q+ +− >  
 
 
(3.12) 
( )( , 1) 1 1( , 1) i i i iCSv i i S C p dQ+ + ++ = + −  
If 1 1i ip d+ +< 且 1 1( )i i ifd p Q+ +− ≤ 或
1 1 1ip d+ +>  且 ( )1 1i i ip d Q+ +− ≤  (3.13) 
 7
步驟 3：依現解途程內需求點排序，依序選
取所屬途程
iV 中之一需求點 ,i jV 。 
步驟 4：依現解之途程產生順序，依序選取
下一途程
kV 。 
步驟 5：需求點
,i jV 選擇插入 kV 位置。 
步驟 6：判斷需求點
,i jV 從原途程中移除後與
插入途程
kV 後新途程是否依然滿足
限制條件，即車載容量與車輛行駛
最大距離限制，若滿足，則進入步
驟 7；否則返回步驟 5。  
步驟 7：計算原途程總成本與交換後新途程
總成本之差，計算參見式(3.1)。 
步驟 8：判斷新解是否優於目前最佳解，若
是，更新解並以此為新解；否則紀
錄搜尋過程中最佳之移步。 
步驟 9：途程
kV 是否檢查結束且無改善，若
是，返回步驟 4；否則進行步驟 5。 
步驟 10：途程
iV 是否所有需求點皆檢查結束
且無改善，若是，返回步驟 2；否
則進行步驟 3。 
步驟 11：是否所有需求點皆檢查結束且無
改善，若是，進行步驟 13；否則重
複步驟 2 至 5。 
步驟 12：將所有最佳移步記錄於禁忌名單
中。 
步驟 13：結束途程間 1-0 節點轉移移步。 
(3) 途程內 1-1 節點交換 
此移步概念，主要為選取一條途程，將
途程中的需求點依序做交換前之條件判
斷，即考量車容量及行駛長度限制，符合條
件即進行需求點服務順序交換，詳細執行步
驟如下所示：  
步驟 1：計算原途程之總距離及目標值總成
本，設定為目前最佳解。 
步驟 2：依現解之途程產生順序，依序選取
一途程
iV 。 
步驟 3：依現解途程內需求點排列順序，依
序選取所屬途程
iV 中之二個需求點
,i jV 、 , 1i jV + 。 
步驟 4：判斷兩需求點交換後新途程是否依
然滿足限制條件，即車載容量與車
輛行駛最大距離限制，若滿足則進
入步驟 5；否則返回步驟 3。  
步驟 5：計算原途程總成本與交換後新途程
總成本之差，計算參見式(3.1)。 
步驟 6：紀錄可行解於候選名單，從候選名
單中挑選最佳之移步，判斷新解是
否優於舊解，若是，更新解並以此
為新解；否則紀錄搜尋過程中最佳
之移步。 
步驟 7：途程
iV 所有需求點是否皆檢查結束
且無改善，若是，返回步驟 2，否
則返回步驟 3。 
步驟 8：所有途程及需求點皆檢查結束且無
改善。 
步驟9：結束途程內1-1節點移步。  
4. 例題測試與分析 
    本 研 究 測 試 例 題 主 要 修 改 於
Solomon(1987)並分為大小題型兩種。本研
究送貨與收貨之需求點分佈個數，主要參考
彭冠儒(2002)之機率訂定，以佔總需求點個
數 75％，為具有送貨需求之需求點；佔總
需求點個數 50％，為具有收貨需求之需求
點，其中部分需求點將會產生具有收貨亦有
送貨之需求，其測試題目經整理後列表如表
4.1 所示。 
4.1 參數測試及設定 
本研究希望演算法所求得之解愈小愈
好，即總成本較低者為佳。以田口方法實施
參數設計時，採用望小之品質特性且各控制
因子間不考慮交互作用。 
由於本研究之控制因子中，移步方式為
六個水準數，候選名單、禁忌名單與迭代次
 9
果，主要原因為本研究所提出之目標函數
式，本身多考量一項空車成本；於距離差距
不大的情況下，於大型題型 M、R、C、RC，
小型題型之 R 均可達到縮減途程數之效
果，且各途程之平均空車率均有降低趨勢。 
小型題型之 P、RC 之途程數未減少反
增加，但其平均空車率尚有降低，本研究推
論其可能導致之原因為傳統目標式尋求最
短距離為最佳途程，而本研究多考量空車
率，可能會導致其選擇空車率較低但車輛巡
行距離較長之途程，且本研究並無考量派車
之車輛固定成本，亦可能使其傾向發展距離
較短、車載量高之多途程。綜觀測試結果，
其確實可降低途程空車率，多數可達到縮減
總途程數，即減少派車數之效果，尤其以大
型題型途程數及距離縮減效果甚為顯著。 
5. 結論與未來研究方向 
本研究利用禁忌搜尋法求解考慮車輛服
務各需求點空車運行成本之總巡行成本評
估數學模式，根據其範例測試結果，可以發
現本研究目標式與傳統目標式之驗證比較
結果顯示，本研究所提之目標式，可達到縮
減派車數之效果。本研究建議未來可朝以下
方向進行研究： 
(1)多考慮其他固定成本，如派車成本。 
(2)未來可發展結合提高裝載率之演算法。 
(3)可增加顧客滿意度之評估，考慮需求點服
務時窗限制。 
6. 研究成果自評 
本計畫研究內容符合當初之計畫預期
的目標設定，並且運用模擬方式與傳統車輛
途程問題之成本目標式進行比較確認其執
行成效，讓本計畫之研究成果具有學術及產
業應用之價值。本計畫之成果適合發表於學
術期刊，並將初步執行成果發表於學術研討
會，目前尚在評估進一步發表於有關學術期
刊發表之事宜，此為後續努力的目標。 
參考文獻 
1. 吳淵齊，1995，物流中心運輸成本及短
缺罰金之最佳化模式，國立雲林技術學
院工業工程與管理研究所，碩士論文。 
2. 莊英群，2003，應用禁忌搜尋法於混合
送收貨之車輛途程問題，逢甲大學工業
工程研究所，碩士論文。 
3. 彭冠儒，2002，考量同時送貨及收貨之
車輛途程問題，逢甲大學工業工程研究
所，碩士論文。 
4. Bodin, L., Golden, B., Assad, A., and Ball, 
M., 1983, “Routing and Scheduling of 
Vehicles and Crews,” Computers and 
Operations Research, vol.10, No.2, 
pp.63-211. 
5. Clarke G. and Wright, J. W., 1964, 
“Scheduling of Vehicles from a Central 
Depot to a Number of Delivery Points,” 
Operations Research, vol.12, pp.568-581. 
6. Michel Gendreau, Alain Hertz, Gilbert 
Laporte, 1994,“A Tabu Search Heuristic 
for Vehicle Routing Problem ”, 
Management Science, vol.40, no.10, 
pp.1276-1290. 
7. Ross, Phillip J., 1996, Taguchi Techniques 
for Quality Engineering, McGraw-Hill. 
8. Solmon, M. M., 1987, “Algorithms for 
Vehicle Routing and Scheduling Problems 
The with Time Window Constrains”, 
Operation Research, Vol 35, No. 2, 
pp.254-265.  
9. Sam R. Thangiah, Jean-Yves, Potvin, 
Tong Sun, 1996, “Heuristic Approaches to 
Vehicle Routing with Backhauls and Time 
Windows,” Computers Operations.  
