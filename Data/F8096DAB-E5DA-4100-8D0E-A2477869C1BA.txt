 製程方程式屬於複雜的非線性方程式，而批次控制
預測模式為線性方程式，且由於權重始終如一，致
使批次控制在製程飄移產生或是誤差過大時，沒法
採用適合的權重，使得控制的效果是有限的。 
預測模式由實驗設計所產生，探討批次控制中
影響化學機械研磨的主要因子。本研究探討主要因
子找出關鍵因素，配合權重調整，儘可能使製程輸
出達到好的控制效果。本研究目的如下： 
1. 研究利用歷史資料，利用資料探勘技術，挖掘法
則，預測批次的製程輸出，以了解製程狀況作改
善與調整。 
2. 模式修正的權重是固定的，在製程變異時，控制
效果是有限的本研究以法則預測為依據，建立權
重調整的改善方法，以期能有較佳之控制效果。 
 
本研究報告的結構如下，首先對於研究之背
景、目的進行說明；第二節中對於文獻進行回顧與
了解；第三節為介紹本研究結合法則與控制器所建
立的改善方法；第四節則是說根據模擬情境所進行
的系統實作與驗證；第五節總結本研究之特色與所
獲得之成果。 
 
2. 文獻探討 
 
2.1 化學機械研磨之介紹 
 
化 學 機 械 研 磨 (Chemical Mechanical 
Polishing；CMP)是目前唯一可以達到全域性平坦化
(global planarization)的技術。1987 年國際商業機器
公司(IBM)，首先提出將化學機械平坦概念引進晶
圓平坦化。利用適當的參數調整，修整晶圓表面起
伏，提升後續製程良率。 
化學機械研磨機台如圖 1。其原理為研磨液
(Slurry)與晶圓(Wafer)的化學作用，產生較易被移除
的薄膜，再利用研磨台的作用力，消除表面不平整
的情況。機台由研磨台(Platen)構成，旋轉研磨台帶
動上方的研磨墊(Abrasive Pad)。而研磨墊除了與晶
面產生磨擦，移除晶面不平整的地方，它還具有涵
養研磨液、排出碎屑的功能。研磨方式是利用真空
產生的吸力，將晶圓吸附在研磨台上的研磨頭
(Holder)，藉由研磨液與晶面產生的化學作用，以及
研磨墊與晶面產生物理作用，將原本高低不平的表
面拋光至平滑的表面。 
 
圖 1 化學機械研磨機台 [4] 
 
根據化學機械平坦在批次控制上的應用，
Boning[4]等人指出化學機械研磨重要的批次控制
輸 入 參 數 ， 包 含 轉 台 速 度 (Speed) 、 背 壓 大 小
(Pressure) 、 向 下 力 量 (Force) 、 晶 圓 表 面 情 況
(Profile)，輸出參數包含晶圓拋光速率(Removal)與
晶圓表面不均勻度(Non-uniformity)。移除率為在晶
圓上選取九個位置，測量研磨前與研磨後氧化物薄
膜厚度，再除以固定研磨時間，在晶圓上九個位置
平均移除率組成所謂的移除率輸出。不均勻度輸出
是計算九個位置的平均薄膜厚度差作為標準差的
品質特徵值。 
 
2.2 統計與工程製程管制 
 
統計製程管制(Statistical Process Control；SPC)
通常運用在穩定的系統狀態，代表產品的良莠背後
之機率分配並不隨時間改變。Elasyed [7]指出SPC
透過分析製程輸出品質的特性數據等資料，研判製
程中是否存在造成產生異常狀況的可歸屬原因，經
由分析結果若發覺製程產生異常，則對異常原因進
行改善工作，以去除非隨機變異對製程輸出的影
響，減少不良品的產生。SPC就是以統計方法為基
礎，對製程做長時間的監控，移除可歸屬原因。 
工程製程管制技術為應用回饋控制之原理，藉
由獲得製程輸出值與目標值間之差異進行補償，使
輸出值回歸目標值以降低製程變異進而增進製程
能力[1]，Montgomery[11]認為工程製程管制通常假
設製程的輸出隨著時間呈動態變化，因此可預測下
一時間點之觀測值，另外，製程必須具有可調整之
操縱變數，且輸入與輸出需具有函數關係，才可藉
由參數估計的方式，推估合適的調整操縱變數水
準，對製程狀態隨時進行調節與控制，使製程之輸
出得以符合目標值。 
 
 2
 任一個物件xi，在其Ind（Q）中的單位集合可表示
成： [ ] ( )i Ind Qx 。 
近似界限：粗集合理論進行近似分類時有兩個
基本概念，近似下界（lower approximation）與近似
上界（upper approximation）。分別代表的意義如下
[13][15]：  
1. 近似下界：在全域集合U中有一部份物件子集合
X（ ），A為包含於U的所有屬性集合，
Q為屬性集合，且為A的子集合（ ）。若
是X中物件的對等關係集合，均能夠被X包含，則
稱這些物件為近似下界。近似下界中物件均能夠
明確表達集合X的特性。此區域也稱為positive 
region，符號表示為POS
UX ⊂
Q A⊆
Q(X)。近似下界表示如下
式： 
{ }( )| [ ]i i Ind QQX x U x X= ∈ ⊂  
2. 近似上界：若是 X 中物件的對等關係集合，與 X
交集不為空集合，則稱這些物件為近似上界。近
似上界中只有部分物件可能表達集合 X 的特
性。此區域也稱為 possible region。近似上界表
示如下式： 
{ }( )| [ ]i i Ind QQX x U x X φ= ∈ ∩ ≠  
 
圖 2 粗集合近似空間 
粗集合理論在進行近似推論時，有兩個近似衡
量函數，分別是 γ 係數與 α 係數。若有屬性子集合
P、Q 包含於屬性集合 A，γ 係數表示如下[13]： 
 4
 
γ 函數，近似分類的品質。表示對知識分類的
比率。P→γQ，表示屬性 P 對屬性 Q 的相依性
（dependency），或者是一致性（consistency）程度。
當 γ=1，表示 P→Q 是一致性。當 γ≠1，表示 P→Q
是非一致性，也是不確定性（uncertainty）。 
 
若資訊系統中的屬性，區分為條件屬性以及決
策 屬 性 時 ， 資 訊 系 統 可 稱 為 決 策 表 （ decision 
table）。假設 P, Q 分別決策表中的條件屬性與決策
屬性，R 為 P 中的一組集合，若 R 滿足下式，則稱
為在 P 中為 Q-indispensable[13]。 
{ } ( ) ( )P R PPOS Q POS Q− ≠  
若在 P 中的每個 R 集合都是 Q-indispensable，
則稱 P 是 Q-independent。S P 若稱 S 為 P 的一組
Q-reduct，則 P 須是 Q-independent，且 S 滿足下式： 
⊆
( ) ( )s PPOS Q POS Q=  
所有 Q-reduct 的交集，稱為 Q-core。Q-core 代
表與 Q 關係最強烈的屬性。粗集合理論藉由 reduct
求得在決策表中，能與決策屬性保持一致性的條件
屬性。這些條件屬性與決策屬性構成確定性法則
（ deterministic rules ） 。 符 號 記 為 ， 或
。 
det
P Q→
QP ⇒
 
3. 建立研究之改善方法 
 
化學機械研磨機台會因機台內部元件的磨耗
與老化等因素，造成不可避免的製程飄移而影響品
質。本研究希望利用結合批次控制與資料探勘手
法，從歷史資料中收集任務相關的資料，進行資料
探勘萃取出合適的法則，然後把批次控制和法則結
合、運用，以期在製程飄移或誤差偏差時來預測下
個批次的輸出以控制、調整使製程輸出儘可能接近
目標值。 
 
3.1 收集相關資料 
 
首先分析製程飄移的原因及結果，找出其可控
的因子，並對其分析與探討來選取相關資料做探
勘，之後對要探勘的資料做適當的轉化與切割達成
相關資料收集的任務，以利之後法則萃取的工作。 
 
3.1.1 製程飄移之分析 
 
化學機械研磨屬於複雜且非線性化之半導體
製程，且因時間因素會有元件老化和出現磨損情形
發生，造成機台運轉有飄移現象的產生。在製程尚
未發生飄移時，輸出值應位於目標值之附近，若製
( )   ( )
 
p
P
card POS Q
Q
card U
γ =
 等。而定量變數為數值型資料，包括連續型數值和
離散型數值兩種。研究資料為連續型會因為數值分
佈過廣，必須經過適合之切割才能進行推論。常用
來切割資料的方式有二類，第一種是等量切割，這
種切割資料的方法結合資料密度的考量，比較容易
產生合適的切割間距，第二種為不等量切割，以不
同的區間來切割，此種方法產生的不同決策間距不
容易使用於控制系統，所以研究採取等量切割的方
式來進行。根據法則的樣式，輸出值切割方面以目
標值為起始點，以輸出值的標準差來作為切割區間
如表 2，模式的誤差量以等量的切割間距向正、負
項誤差來切割如表 3。 
 6
 
表 2 輸出值之切割 
 
 
表 3 誤差值之切割 
 
 
3.2 法則之萃取 
 
分析所需的資料經過適當轉換與離散之處理
後，便可使用粗集合理論來萃取法則。挖掘法則的
部分利用可辨識矩陣（discernibility matrix）[15]來
計算決策表中的 reduct 以及 core 進而挖掘出法則及
法則篩選以求得到適當的法則進行控制。 
 
3.2.1 法則挖掘 
 
當資料集整理形成的決策表，如表 4，其中條件
屬性：a1、a2、a3，決策屬性：D。可辨識矩陣就是
決策表中物件與物件之間形成的矩陣，若物件數為
n，可辨識矩陣為n×n矩陣。可辨識矩陣的元素（dij）
則是比較每個物件之間決策屬性的狀態來決定。如
果兩個物件具有一樣的決策屬性，在可辨識矩陣中
對應的元素為空集合。若是兩個物件沒有同樣的決
策屬性，則對應的元素所呈現的是不同狀態值的條
件屬性。  
表 4 決策表 
Object a1 a2 a3 D 
X1 2 1 3 1 
X2 3 2 1 2 
X3 2 1 3 1 
X4 2 2 3 2 
X5 1 1 4 3 
 
矩陣元素（dij）之表示： 
{ }: ( ) ( )    , 1, 2, ,
  ,                              :
ij i j
ij i j
d a A a x a x i j n
d otherwise if d d A
⎧ = ∀ ∈ ≠ =⎪⎨ = ∅ =⎪⎩
L
屬性集合
 
表 5 可辨識矩陣表 
set 1 2 3 4 5
1 -        
2 a1, a2, a3 -      
3 - a1, a2, a3 -    
4 a2 - a2 -  
5 a1, a3 a1, a2, a3 a1, a3 a1, a2, a3 - 
 
可辨識矩陣可利用可辨識函數(discernibility 
function：fA(D))來尋找資料集之reduct，進一步形成
最終決策表可以得到分類法則aki＝> Dj (aki)表條件
屬性ak之狀態值為i，Dj表決屬性狀態值為j 
 
3.2.2 法則之篩選 
 
析資料經過挖掘過程後會產生許多的法則，需
要適當篩選以求出適合的法則來進行控制，以下會
對法則長度、法則可信度作說明。法則長度是指法
則裡面條件屬性的個數，如a1∩a2=>D1則法則長度
為 2，研究之法則樣式，誤差分別包含移除率誤差
與不均勻度誤差因子，還有批次列入考量，且誤差
產生與其模式極相關加上時間因子考量，但法則長
度受限於選取樣式，所以不對法則長度作探討。 
法則可信度表示在所有相同的條件屬性法則
中，決策屬性在特定狀態的機率，若法則可信度為
1 時，法則為確定性法則。法則可信度小於 1 時，
則為不確定法則，法則可信度定義[10]： 
#     ( )
#     
of tuples that have A B DConfidence A B D
of tuples that have A B
∩ ∩∩ ⇒ = ∩
  
圖 7 EWMA 批次控制架構圖[12] 
 
其中 為製程預測輸出值， 為預測截距
值， 為斜率之估計值，由實驗所得， 為製程輸
入，即所謂之處方， 為製程之批次數。在控制過
程中，利用前一批製程輸出找出處方，使輸出值儘
可能接近目標值。在此過程中， 並不隨時間改
變，僅在不同批次估計中改變 ，再計算處方
，其中 T 表製程目標值。 
tY
∧
1ta −
b tu
t
b
1ta −
tu
由於 EWMA 學習權重始終如一，以致製程飄
移或誤差值偏差時，不能有效的調整，效果是有限
的，研究希望經由法則有效預測出輸出並對權重作
適當調整，達到較佳的控制效果。 
根據 EWMA 批次控制架構，配合法則之使用，
建構一個法則配合批次控制的控制流程如圖 8，以
下將對控制流程如何運用法則之步驟作說明。 
 
圖 8 法則加入控制器之控制流程圖 
 
 
 
配合法則之應用，本研究之改善控制流程共分
為六個步驟： 
1. 從資料萃取法則形成法則庫 
2. 根據觀察值，決定目前系統狀態 
3. 搜尋符合驅動條件之法則 
4. 利用法則決定執行方案 
5. 對權重做適合之調整 
6. 產生新製程處方，進行生產。 
第一個步驟：從資料萃取法則形成法則庫。由
原始資料中找出關鍵因子形成探勘挖掘之樣式，然
後粗集合理論進行法則萃取，再對法則篩選找出合
適之法則，形成法則庫以利系統來運用作改善。 
第二個步驟：根據觀察值，判別目前系統狀
態。誤差量可以判別預測模式之準確高低與製程飄
移是否發生，且誤差值的量愈來愈大時，目標差距
值的量也愈來愈大，代表著輸出值品質有所不良遠
離所要達到的目標值。由於 EWMA 權重始終如一，
此種狀況的控制效果是有限的，所以此種狀況發生
時，則找尋法則以作改善。如誤差值偏差發生時：
Er=6、En=6，即尋找法則。 
第三個步驟：搜尋符合驅動條件之法則。如果
法則條件屬性符合目前狀態，則稱這些法則符合驅
動條件。即可從法則庫中選出來作改善與控制。而
控制法則不可能包含所有製程狀況，若找不到可以
驅動的法則，則控制行為仍由 EWMA 來進行。 
表 6 法則狀態表 
 
 
觀察狀態為： 
{ Er(t-1)、En(t-1)、Er(t)、En(t)、run }：{4, 3,6,6,4} 
根據觀察狀態其符合表 6 裡面第一條法則之條件屬
性值，則驅動此法則，此法則預測下個批次的輸出
(t+1)：1、 (t+1)：4，以此決定改善方案。  Yr  Yn
第四個步驟：利用法則決定執行方案。根據法
則可以得到預測下個批次的輸出，有了預測輸出就
可以判別其良莠，並進一步其屬於目標差距之等
級，而改善方案也依此來決定。 
 8
  10
1u
4
2
1 1 2 3 4 1 2
2 2 2
2 3 1 4 1,
1563.5 159.3 38.2 178.9 24.9 67.2 46.2
      19.2 28.9 12 ' 116 ' 50.4 ' 20.4 ' t
y u u u u u u
u u u t u t t t ε
= + − + + − −
− − − + − + +
 
2 1 2 3 4 1 2
2,
254 32.6 113.2 32.6 37.1 36.8 57.3 '
       2.42 ' t
y u u u u u u u
t ε
= + + + + − +
− +
t  
其中  ，批次的影響因素。 ' ( 53) / 52t t= −
1,tε ：移除率的擾亂因素，服從N(0,602)。 
2,tε ：表面不均勻度的擾亂因素，服從N(0,302)。 
1y ：移除速率，目標值為 2000。 
2y ：晶圓表面不均勻度，目標值為 100。 
1u ：轉台對研磨頭相對速度，介於{-1,1}之間。 
2u ：研磨頭施加於晶圓背面壓力，介{-1,1}之間。 
3u ：研磨頭向下壓的壓力，介於{-1,1}之間。 
4u ：晶圓參考面粗糙程度，介於{-1,1}之間。 
t ：拋光墊使用於生產批次編號，每 30 批次更換
拋光墊。 
由於研究使用指數加權移動平均法，所以採用
線性預測模式，其預測模式如下[6]： 
1 1 2 3 41600 150 40 180 25 0.9y u u u u= + − + + − t
t
 
2 1 2 3 4250 30 100 30 35 0.05y u u u u= + + + + +  
實驗之預測方程式的截距交付 EWMA 進行校
正，所得到的截距代入處方方程式產生製程處方，
處方代入式子即可得晶圓之觀察值。經由此動作，
實驗假設共有一百個研磨墊，每個研磨獨立研磨三
十個批次，即可取得 3000 筆的原始資料，接著利
用研究方法建立合適的控制法則。 
 
4.2 模擬控制的情境 
 
實作測試採用模擬方式，利用觀察值距離目標
值產生之 MSE 來評估控制效果。本研究所提出改
善之方法與 EWMA 在以下不同的模擬情境做比
較，分別為： 
1. 模擬機台限制：需要測試控制方法產生的可行
性，由於預測模式是架構在真實機台上，製程處
方需要符合機台的使用限制，例如，處方建議的
轉速不能超過機台的負荷。通過此模擬，才能夠
以此控制方法能運用於實際的機台運作。其後所
有模擬也需要符合機台使用限制。模擬的過程
中，如果控制方法建議的處方超出機台限制，將
以機台的限制做為處方，才可確保此處方能運用
於生產。 
2. 批次大小變更：每個研磨墊可以研磨批次的數
量，可能基於成本和研磨品質的考量，研磨少量
批次時，研磨品質受研磨時間的影響較少，相對
成本也較高，因為每達少量的批次就要更換研磨
墊。而大量的批次，研磨品質受時間影響較大，
相對成本較低，達大批量數才需更換研磨墊。控
制方法將在不同批量數中，進行測試評估其控制
效果。 
3. 機台噪音改變：每部研磨機台之狀況不可能完全
相同，所造成之製程噪音自然相異。此模擬測
試，探討機台噪音的改變也就是在不同的影響環
境對於控制方法的影響。  
 
4.2.1 模擬機台限制 
 
在模擬機台過程中，以處方模式尋產生製程處
方。由於化學研磨機台本身限制，可能無法達到此
處方值，又或其處方值會對於機台使用期限有不良
影響，因此根據機台設備的使用，建立輸入設定之
限制如圖 9 
 
圖 9 輸入限制規則系統[12] 
 
根據機台之輸入限制來決定處方值，如轉台
對研磨頭相對速度超出機台之極限值，即以此極限
  12
磨時間的影響較少，達少量的批次就要更換研磨
墊，成本也較高。而大量的批次，研磨品質受時間
影響也較大，批次大才需更換研磨墊，相對更換成
本也較低。控制方法將在不同批量數中，進行測試
評估其控制效果。 
 
表 12 批次改變之模擬結果 
批次 Model MSE： 顯著性： 
數目  移除率 不均勻度 移除率 不均勻度
EWMA 8056 14195 0.212 0.000720 
批次 本研究 8058 14185   
EWMA 8646 14795 0.750 0.02230 
批次 本研究 8648 14790   
EWMA 9454 14247 0.362 0.01340 
批次 本研究 9456 14243   
EWMA 10549 14367 0.546 0.03750 
批次 本研究 10550 14363 
EWMA 11927 13241 0.164 0.01260 
批次 本研究 11931 13238   
 
由表可得知，在不同批次大小下不均勻度仍有
較 EWMA 之績效，雖然在移除率無顯著改善，檢
定結果也無差異，表示在不同批次數目中，本研究
方法可以在維持同樣的移除速率中，改善不均勻度
的控制效果。 
 
4.2.3 機台噪音改變 
 
在真實生產中，每部研磨機台之狀況不可能完
全相同，所造成之製程噪音自然相異。此模擬測
試，探討機台噪音的改變也就是在不同的影響環境
對於控制方法的影響。研究希望控制方法能夠消除
噪音的影響，只要在噪音變化範圍之內，控制法方
法可以適用。 
本實驗的噪音假設符合常態分配，其變異數分
別為{3600,900}，接著在不同噪音下模擬其控制效
果。噪音變化採用 1/3~3 倍交叉實驗，比較其製程
輸出的差異，實驗結果如表 13。 
 
 
 
表 13 噪音改變之模擬結果 
噪音 控制 MSE： 顯著性： 
 模式 移除率 不均勻度 移除率 不均勻度
EWMA 5787 14548 0.186 0.0006
 (1200,300) 本研究 5788 14542   
EWMA 6185 14860 0.312 0.0023
(1200,900) 本研究 6183 14855   
EWMA 6149 15819 0.938 0.0018
(1200,2700) 本研究 6149 15813   
EWMA 8283 13570 0.642 0.034
(3600,300) 本研究 8284 13566   
EWMA 8646 14795 0.750 0.022
(3600,900) 本研究 8648 14790   
EWMA 8535 17133 0.068 0.004
(3600,2700) 本研究 8540 17126   
EWMA 20156 13535 0.101 0.022
(10800,300) 本研究 20178 13525   
EWMA 17617 15197 0.801 0.389
(10800,900) 本研究 17618 15193   
EWMA 16531 17468 0.761 0.339
(10800,2700) 本研究 16534 17465   
 
由表得知，研究所提出之改善方法在不同噪音
影響下仍有較 EWMA 為佳之控制效果，雖然只有
在不均勻度獲得改善，也表示可以在同樣不同機台
噪音影響狀況下，不均勻度裡面有仍然顯著的控制
效果，唯有在噪音較大為(10800,900)、（10800,2700）
效果並不顯著。 
 
5. 結論與建議 
5.1 結論 
 
研究利用過去歷史資料，配合粗集合理論尋找
批次之間的關係，建立起法則，以預測研磨的結果
來調整權重，期使化學機械研磨製程有較佳的控制
效果。而實驗結果顯示，不論在模擬機台限制、批
次大小變更與噪音大小改變，研究建立的改善方
法，其控制效果與 EWMA 比較起來，不均勻度的
控制效果均有明顯的改善，而移除率的控制效果雖
不顯著，但也不至於變得較差。本研究的方法可以
在維持同樣的研磨速率中，對晶圓表面不均勻度品
質提供較好的控制效果。對於 EWMA 的改善仍有
