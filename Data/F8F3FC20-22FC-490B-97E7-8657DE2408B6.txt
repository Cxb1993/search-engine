 2
以啟發式及平行演算法求解護理人員排班問題暨自動排班系統之
實做開發(I) 
 
摘要 
護理人員班表之規劃，對於護理服務品質有極大之影響。若以人力方式進行排班，通常需花費
極長之時間。本研究首先針對護理人員排班問題(NSP)構建其對應之數學模式，對於人員數少、班
表週期短之小型排班問題求得最佳班表。至於較大型之排班問題，本研究設計遺傳基因演算法來求
解此問題，以期迅速求得令人滿意之班表。最後再以此演算法為核心，設計合適之操作介面，提供
護理排班主管或管理者一可靠且易於使用之自動化排班系統。 
關鍵字：護理人員排班、啟發式演算法、遺傳演算法、自動排班系統 
 
壹、緒論 
一、研究背景與動機 
一般醫療院所護理人員之班表排定，通常皆由護理長或相關行政人員以人工方式考慮大量的限
制條件後自行排定(狀況一)，或者先由護理人員自行排定上班時段及休假日期，再由管理者(護理長
)做最後的統整(狀況二)。前者所有複雜之排班工作皆由護理長獨力完成，耗時費力；更大之問題是
，護理長往往依據過去之經驗及單位內護理人員之共識進行排班工作。當護理長有所異動時，經驗
無法傳承時，排班工作往往受到影響甚或停擺。第二種狀況雖然員工之自主性提高，但是由於班表
的數據資料龐大，考慮的因素又多，因此恐費時費力且不具效益，再加上以人工的方式排定班表，
恐難做到公平公正，甚至影響護理人員的工作效率，進而降低醫療院所之競爭力。 
於護理人員排班問題中(Nurse Scheduling Problem, NSP; Nurse Rostering Problem, NRP)，除須滿
足各國相關法律之規定(勞基法)、連續值班天數之上限、包班天數限制、各級護理人力之需求等眾
多硬性限制(Hard Constraints)外，各家醫院通常會以不同程度之彈性，允許護理人員事先排定欲排
之班別並事先指定某些休假時間，以儘量滿足護理人員需求，而且考慮各護理人員間在不同班別及
休假時間上予以公平分配之軟性限制(Soft Constraints)。在上述軟、硬限制、休假公平性等多重限
制下，各醫療院所所著重之目標亦不相同，有人在乎總成本最小，有人希望員工滿意度最高，亦有
人希望同時能夠達成許多決策目標。如此一來，原本已經非常複雜之護理人員排班問題，隨之變得
更為複雜及難以解決了。事實上，護理人員排班問題類屬於高複雜度之組合最佳化問題
(Combinatorial Optimization Problem)(Miller, 1984)，若以人力排班往往花費極長之時間，且更需每
段期間即重複產生班表，更加重排班人員的負擔。 
二、研究目的 
 4
結構，並善用護理人員排班時之專業知識，透過構建子母體及子母體間之合作，並發展一共同演化
策略。Inoue 等(2003) 提出一 GA 演算法，其特點是在染色體進行交配後，會破壞現有之解答結構，
他們因此透過所提出之啟發式演算法及突變作業，來對染色體進行修補之動作。 
2. 以禁忌搜尋演算法 Tabu Search 求解 NSP 
Berrada 等(1996)提出一多目標禁忌搜尋演算法，然而文中在產生鄰域解時僅將不同人員之上
班日及休假日做一互換而已，其可應用性有限。不同於大多數採用 Tabu Search 之研究不允許不可
行解進入演算過程，Dowsland (1998)透過讓鄰域解在可行及不可行解空間中來回跳動，以強化其搜
尋較佳解之能力。Bellanti 等(2004)先提出一貪心法則之區域搜尋法來避免鄰域解產生不可行之解
答，再將此部分結合於他們所提出之禁忌搜尋演算法，並以之求解義大利之案例醫院。 
參、研究設計及模式建構 
本節首先描述本研究欲解決的護理人員排班問題；其次說明模式；最後詳述如何應用啟發式演
算法 GA 來求解護理人員排班問題。 
一、本研究 NSP 問題定義及數學模式建構 
本研究考慮個案醫院的排班現況，輔以相關文獻回顧，整理出本研究最終使用之決策目標函數
與各項限制式。如同多數 NSP 之研究，各項限制式依其性質劃分為軟性及硬性兩類。硬性限制式
乃指排班過程中，絕對不能違反之限制條件；軟性限制式的定義則為儘可能不要違反的限制條件，
一旦違反，則以各種不同之方式予以「處罰」。本研究所採用之排班班別乃依個案醫院的現況，分
為白班(D，0800~1600)、兩頭班(T，0800~1200；1600~2000)、小夜班(E，1600~2400)、大夜班(N，
0000~0800)及休假(O)五種班別。護理人員等級依其能力、資歷分為 A、B、C 三級。排班週期皆為
四週 28 天，且排班週期起始日為星期一。 
(一) 決策目標及軟性、硬性限制式 
1. 限制式  
此節分述本研究所採用之軟性、硬性限制式及決策目標。下述硬性限制式中，涵蓋類型包括「基
本人力需求限制(H1)」、「工作天數相關限制(H2~H4)」、「休假天數相關限制(H5~H7)」、「大夜班天
數相關限制(H8~H11)」，以及「人員能力等級限制(H12)」等五種型態。 
H1. 滿足排班單位每日基本人力需求； 
H2. 每次連續工作天數的上限為 6 天； 
H3. 兩個星期上班時數不超過 84 小時(勞基法允許 4 個小時的加班)； 
H4. 兩個星期上班總天數不得超過 11 天； 
H5. 每月休假天數至少為當月國定假日天數的總合； 
H6. 一星期至少休假一天； 
H7. 連續休假天數的上限為 3 天； 
H8. 大夜班的隔天只能排定大夜班或休假； 
Dij 1：第 i 個護理人員在第 j 天工作班別為白班；否則為 0 
Tij 1：第 i 個護理人員在第 j 天工作班別為兩頭班；否則為 0 
Eij 1：第 i 個護理人員在第 j 天工作班別為小夜班；否則為 0 
Nij 1：第 i 個護理人員在第 j 天工作班別為大夜班；否則為 0 
Oij 1：第 i 個護理人員在第 j 天工作班別為休假；否則為 0 
D-average 排班週期內，所有護理人員工作班別為白班的平均數量 
T-average 排班週期內，所有護理人員工作班別為兩頭班的平均數量 
E-average 排班週期內，所有護理人員工作班別為小夜班的平均數量 
N-average 排班週期內，所有護理人員工作班別為大夜班的平均數量 
O-average 排班週期內，所有護理人員工作班別為休假的平均數量 
-,i iDd Dd
+  排班週期內，第 i 個護理人員所分配到的白班總數與全體護
理人員平均分配到的白班總數之誤差值。(正值代表超出平均
數，負值代表低於平均數)。 
-,i iTd Td
+  排班週期內，第 i 個護理人員所分配到的兩頭班總數與全體
護理人員平均分配到的兩頭班總數之誤差值。 
-,i iEd Ed
+  排班週期內，第 i 個護理人員所分配到的小夜班總數與全體
護理人員平均分配到的小夜班總數之誤差值。 
-,i iNd Nd
+  排班週期內，第 i 個護理人員所分配到的大夜班總數與全體
護理人員平均分配到的大夜班總數之誤差值。 
,i iOd Od
+ −  排班週期內，第 i 個護理人員所分配到的休假總數與全體護
理人員平均分配到的休假總數之誤差值。 
3. 數學規劃模式 
針對 NSP 問題，本研究所建構之數學模式如下所示： 
     - - - -
1
 Z= 
n
i i i i i i i i i
i
-
iMin Dd Dd Ed Ed Nd Nd Td Td Od Od
+ + + + +
=
+ + + + + + + + +∑  (2) 
-
1
- -      i 
m
ij i i
j
D Dd Dd D average+
=
+ =∑ ∀
∀
∀
∀
∀
 (3) 
-
1
- -        i 
m
ij i i
j
E Ed Ed E average+
=
+ =∑  (4) 
-
1
- -       i 
m
ij i i
j
N Nd Nd N average+
=
+ =∑  (5) 
-
1
- -           i 
m
ij i i
j
T Td Td T average+
=
+ =∑  (6) 
-
1
- -        i 
m
ij i i
j
O Od Od O average+
=
+ =∑  (7) 
1
      
n
ij ij
i
D D
=
=∑ i∀
i∀
 (8) 
1
       
n
ij ij
i
E E
=
=∑  (9) 
 6
(一) 遺傳基因演算法內容 
遺傳演算法 GA 是 John Holland 於 1975 年所提出的一套演算法則，以達爾文「物競天擇，適
者生存，不適者淘汰」的進化法則為其基本架構。藉由演算法本身的演化過程逐步淘汰適合度低的
個體(以護理人員排班問題之說法則是，逐步淘汰不合適的班表)，並由適應度高的個體(合適度高之
班表)再經過複製、交配與突變繁衍出適合度更高的下一代，以達成搜尋最佳解的目的。本研究針
對 NSP 所提出之 GA 演算法之各執行步驟及細節說明如後： 
1. 起始母代個體編碼 
GA 運作的對象通常為能夠表示可行解的字串而非決策變數本身，因此在進行基因演算法之前
必須先透過編碼機制，將問題之決策變數轉換成字串或稱染色體。GA 執行演算法前，必須先建立
一組包含多條染色體的初始族群，每條染色體代表一可行解，再從染色體間多方向的演化產生出較
佳的下一代，組成新的族群。本研究使用兩種方式產生起始解，分別為隨機法(Random)及套版法
(Template)。班表中之染色體編碼採用介於 1~8 之整數，其中 1 為白班(D)、2 為兩頭班(T)、3 為小
夜班(E)、4 為大夜班(N)、5 為休假(O)、6 為強制休假、7 為強制小夜班、8 為強制大夜班。 
在隨機法中，初始母代個體(起始班表)全由亂數產生。上述產生的母體染色體皆先利用修補機
制來產生符合各限制式需求之母代個體，接著才進入演算法機制中進行求解。 
套版法之主要邏輯來自於經過多次嘗試數學模式之求解過程遭遇「不可行解」之產生，以及仔
細觀察現有多項限制式後發現，關於「大夜班」班別指派之相關限制，應是求解過程中最為關鍵處。
若能事先設計某些機制，進而推導出某些「關鍵基因片段」，再貼入染色體中，其效果將遠較使用
隨機指派，而需來來回回經由修補策略以產生可行解之方式來得有效。至於「關鍵基因片段」之內
容，例如圖 1 中之『7-7-8-8-6-6』則需由護理單位人數、各班別每日護理人員需求人數、及排班週
期共同推算而得。以圖 1 中之人員編號 1 為例，當決定出其關鍵基因片段後，由於「公平」是排班
過程中最被在乎的目標之一，因此若每個人皆採用相同之關鍵基因片段，各班別分配公平性目標，
將可輕易被完成。又考量每日需求人數，因此最佳之方式乃是將關鍵基因片段隨著人員編號增加，
逐次延遞一天，便形成圖 1 中之階梯樣式。當關鍵基因片段被貼入染色體中，剩下空餘位置則由演
算法隨機指派班別編號 1、2、3、4 及 5 之班別進入染色體，以符合每日人力需求及其他各項限制，
方形成一完整之套版法起始解。 
 
圖 1 關鍵基因片段之染色體班表 
 8
本研究針對個別限制式所設計之修補策略。 
(1) 滿足排班單位每日基本人力需求(硬性限制式 H1) 
步驟1：由排班週期的第一天起，逐日計算各班別護理人員總數(包含白班、兩頭班、小夜班及
大夜班)，當出現各班別之護理人員總數不等於該班別之每日基本人力需求的現象時，
則進行步驟2；否則進入下一修補策略。 
步驟2：當白班護理人員總數大於每日白班基本人力需求時，則隨機選取多餘的白班護理人員
突變為兩頭班、小夜班、大夜班及休假；當白班護理人員總數小於每日白班基本人力
需求時，則由其餘班別的護理人員中隨機選取所缺乏的人員數突變為白班護理人員。
進入步驟3。 
步驟3：兩頭班之操作策略同白班。不同處在當多餘兩頭班護理人員出現時，多餘的兩頭班護
理人員僅能突變為小夜班、大夜班及休假。進入步驟4。 
步驟4：小夜班之操作策略同白班。不同處在當多餘小夜班護理人員出現時，多餘的小夜班護
理人員僅能突變為大夜班及休假。進入步驟5。 
步驟5：當大夜班護理人員總數大於每日大夜班基本人力需求時，則隨機選取多餘的大夜班護
理人員突變為休假護理人員。判斷是否已達排班週期的最後一天，是則進入下一修補
策略；否則回步驟1，由隔日起計算各班別之護理人員總數。此項修補策略之作業內
容如圖3所示。 
 
圖 3 修補策略示意圖－H1 
(2) 兩個星期上班時數不超過 84 小時及兩個星期上班總天數不得超過 11 天(硬性限制式 H3、H4) 
步驟1：每兩星期計算各護理人員所分配到的休假天數總和。如出現每兩星期之休假天數總和
少於每兩星期之休假天數下限(3天)，則執行步驟2；反之，進入下一修補策略。 
步驟2：針對違反限制式H3、H4之護理人員，將每兩星期之休假天數下限與違反限制時期之休
 10
方法 
隨機法+GA  套版法+GA 數學模式(Lingo) 
單
位
編
號 
目標值
(最佳解) 平均值 
求解時間 
(秒)  
目標值 
(最佳解) 平均值 
求解時間 
(秒) 
目標值 
(解答狀態) 
求解時間 
(秒) 
下界解 
1 17.60 17.84 37.27 17.60 (Feasible) >86400 17.6028.24 208.84  17.60   
 12
2 30.36 36.98 1429.25  12.00 16.22 49.66 12.00 (Feasible) >86400 12.00  
23.20 36.63 24.15 (Feasible) >86400 23.083 48.77 53.85 4559.81  23.08  
4 37.00 58.40 855.56  16.00 20.80 414.91 18.00 (Feasible) >86400 16.00  
37.44 1143.68 33.60 (Feasible) >86400 32.005 77.60 82.96 3729.12  32.00  
觀察表 2 之演算結果可發現：在五題測試例中，若使用數學模式(Lingo)求解，雖然其中兩題
之可行解目標值已與最佳解相同，但其皆無法在一天之內(86400 秒)找到最佳解。由此可再度驗證
NSP 問題之高演算複雜度。套版法+GA 在五題測試例中，由於其最佳結果皆等於下界解，因此可
推論套版法+GA 皆已產生出最佳班表。相較於數學模式所耗費之演算時間，套版法+GA 在三種方
法中具壓倒性之高效率。以例題五為示範，套版法+GA 所求算出之班表如圖 7 所示。 
 
圖 7 套版法+GA 求算出之範例班表 
 (2)多決策目標 
除上節基本模式之演算外，若欲同時考量「排班公平性最大化」及「軟限制違反處罰值總量最
小化」兩大決策目標。此處所考慮三種類型之公平性，分別為(1)護理人員分配到各種班別天數之
公平性；(2)四週 28 天內(排班週期)分配到國定假日(含週六、週日)休假天數之公平性；(3)四週 28
天內分配到完整週末(星期六、日兩天皆休假)之次數。則僅需修改 GA 之適合度函數如下 (32)。 
Min：WG×( 
=
∑5
1i
WG1i×班別 i 之排班公平性＋WG2×國定假日休假公平性 
＋WG3× 完整週末休假排班公平性)+ WS×(
=
∑6
1j
WSi×性限制式 j 之違反次數) (32) 
伍、自動排班系統之實作 
本研究以所提出之 GA 演算法為核心，設計一套 Web-Based 護理人員排班系統，提供個案醫
院使用。排班系統由 ASP、C/C++及 Access 等軟體建構而成，包含了兩大系統：護理人員資料管
理系統以及護理人員排班系統。護理人員資料管理系統用來管理個案醫院內各排班單位的人員資
料，系統介面如圖 8 所示；而護理人員排班系統則經由護理人員資料管理系統將各排班單位的人員
