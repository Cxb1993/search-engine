 2
100 個點所組成的磁場曲線就需要 45 秒（不考慮
探棒移動的時間），而量測 10000 個點所組成的
磁場曲面則要花 75 分鐘，整個量測過程相當費
時，倘若應用 B-Spline 插值技術作磁場量測，只
需 4.5秒量測 10個點就能獲得相當精確的磁場曲
線，原先 75 分鐘的磁場曲面量測則減為 45 秒，
可大幅度縮短磁場量測的時間，有鑑於此，本計
畫投入開發 CNC B-spline 磁場量測技術是有其
重要性。 
近幾年磁場追蹤與磁場定位等議題相當受
到重視，尤其在生物醫學、力學以及臨床診斷等
領域[1,2]。文獻[1]提到目前最小化的針侵入式治
療，以 X 光透視的方式作監控，決定針頭注射藥
劑或置放微小感測器的位置，若利用 Aurora 
magnetic position sensor 搭配磁場追蹤技術，可追
蹤人體內微小感測器之位置，改善傳統針侵入式
治療的醫療環境，增加臨床診斷之便利性。文獻
[2]探討磁場追蹤技術，以兩個獨立激發線圈產生
二維磁場，搭配三維磁場感測器的作用，利用量
測磁場相位與量值的變化達到磁場位置與方位
追蹤的效果。Honeywell 公司在磁場感測器產品
應用介紹中 [3]，舉出以 Anisotropic Magneto 
Resistive (AMR)之原理製作磁場位置感測器。該
感測器分成兩部分，一部份元件置放在移動物本
體，另外一部分相互感應的元件則置放在靜止
端，目前已成為非接觸式定位主要的方法。台灣
HIWIN 公司所開發的 Magi-Encoder Module 中 
[4]，其功能類似光學尺的感測迴授作用，可適用
於如油、水、粉塵及震動等惡劣的工作環境。 
以上說明了以磁訊號作為追蹤與定位訊號的
相關技術與產品發展現況，儘管所利用的磁性元
件其原理不盡相同，但皆可區分成 transmitter 與
sensor 兩部分，並且保有磁場追蹤與定位之最大
特色―沒有 line-of-sight 之限制，即使 transmitter
與 sensor 之間存在非導磁的障礙物，也能不受影
響地進行磁性訊號的傳輸。因此本計畫將投入磁
迴授控制技術之研發，希望能提供業界對運動控
制的新思維，並在未來面臨 line-of-sight 限制的
應用場合，提出有效的解決方案。 
 
二、研究方法與結果討論 
圖一為本計劃所建構之三維磁場自動量測
平台，由個人電腦、DSP卡、三軸伺服平台、三
軸高斯計與三軸量測探棒所組成。其中，個人電
腦提供人機介面與程式開發的環境，DSP卡依照
寫入的演算法即時計算運動命令，並輸出至三軸
伺服平台，使架設在平台上的三軸量測探棒可移
動至指定位置進行量測，最後再透過三軸高斯計
的訊號處理，將磁場量測訊號迴授至DSP卡，以
完成一閉迴路系統。此外，此系統需校正探棒的
量測方向 (Bx,By,Bz) 與伺服平台的運動方向
(X,Y,Z)，如圖二所示，這將有利於開發磁追蹤與
磁定位等相關技術。 
（1）B-spline 磁場分佈重建法 
 B-spline 磁場分佈重建法特色在於：僅量測
少數的取樣點，便可透過 B-spline 插值技術還原
出指定平面的磁通密度分佈。因此，本方法可歸
納為兩個重要關鍵，分別為『集中取樣』與
『B-spline 插值技術』。 
集中取樣 
考量一個充磁均勻的矩形磁鐵如圖三所
示，其中 a=52mm, b=12mm, d=5mm。由於內部
環電流的抵銷作用，可將磁鐵簡化成由好幾個電
流迴路所堆疊而成的模型[5]，其中線電流密度為
6833 10 /J A m= × 。由於矩形磁鐵具有厚度為 d，
則任意一點 ( , , )P x y z 的磁通密度可表示如下
[5,6]： 
( ) ( )1 2 3 3 22 2 21 2 3, ,
i
i
ψψ ψ ψ ψ ψ ψΨ = + +
 ( )1,2,3i =  (1)
  
( )
( )
3 0 00 0
00
3 0 0
, ,
4 , ,
b
x
x a y y z zJdzdB dy
x y y z z
μ
π
Ψ − − −⎡ ⎤= ⋅⎢ ⎥−Ψ − −⎢ ⎥⎣ ⎦∫
 (2)
  
( )
( )
3 0 00 0
00
3 0 0
, ,
4 , ,
a
y
x x y b z zJdzdB dx
x x y z z
μ
π
Ψ − − −⎡ ⎤= ⋅⎢ ⎥−Ψ − −⎢ ⎥⎣ ⎦∫  (3)
  
( )
( )
( )
( )
2 0 00 0
00
2 0 0
1 0 00 0
00
1 0 0
, ,
4 , ,
, ,
4 , ,
a
z
b
x x y z zJdzdB dx
x x y b z z
x y y z zJdz dy
x a y y z z
μ
π
μ
π
Ψ − −⎡ ⎤= ⋅⎢ ⎥−Ψ − − −⎢ ⎥⎣ ⎦
Ψ − −⎡ ⎤+ ⋅⎢ ⎥−Ψ − − −⎢ ⎥⎣ ⎦
∫
∫
 
(4)
  
( )0d x y zB dB i dB j dB k= + +∫ G G G  (5)
其中 0μ 為空氣中的導磁係數。 
 以圖四為例，考量 T1~T34 與 S1~S17 等多條路
徑，沿著該路徑的磁通密度分佈可藉由MATLAB
 4
（3）磁追蹤與磁定位 
 本研究利用磁場迴授訊號，經過適當的命令
產生（磁向量追蹤）與控制理論（磁定位控制架
構），使三軸機台上的探棒可隨著磁鐵的移動而
達到追蹤以及定位的效果。 
磁向量追蹤法 
 磁向量追蹤的目的在使探棒跟隨著磁鐵做
任意的移動，此方法可使探棒達到快速的追蹤響
應，並在感測到指定的磁通密度範圍內時令其靜
止。圖十三為磁向量追蹤的示意圖，其中磁鐵與
探棒僅考慮XY方向的運動。當磁鐵任意移動
時，探棒將沿著PCJJJG的方向追蹤磁鐵，其中P為探
棒量測位置，C為磁鐵中心於指定平面的投影位
置。磁向量追蹤的關鍵在於命令產生，其公式如
(4-6)所示。 
( )d mV K B B= ⋅ −  (7)
(i) if m d tB B B≤ −  & m d tB B B≥ +  
( ) ( )2 2_
Px Cx
Px Cx Py Cy
B BV Vx cmd
B B B B
−=
− + −
 
( ) ( )2 2_
Py Cy
Px Cx Py Cy
B B
V Vy cmd
B B B B
−=
− + −
 
(8)
(ii) if d t m d tB B B B B− ≤ ≤ +   
0_Vx cmd =  
0_Vy cmd =  
(9)
其中V為基底速度，K為比例增益，Bd為指定的磁
通密度，Bm為當下量測到的磁通密度，Bt為可允
許的磁通密度誤差，Vx_cmd與Vy_cmd分別為X軸和Y
軸的速度命令。 
磁定位控制架構 
本研究提出的磁定位，其目的在於使探棒與
磁鐵的相對位置保持固定，即當磁鐵任意移動
時，探棒會經由磁定位控制架構的作用，定位在
最初所定義的相對位置。磁定位控制架構憑藉著
探棒所感測的三維磁通密度(Bx, By, Bz)，在單一磁
源的前提下，利用一組三維磁通密度可唯一決定
一位置的特性，以圖十四的架構進行磁定位的控
制。其中 ( )* * *, ,x y zB B B 為定位點的三維磁通密度，
( )* *,cmd cmdx y 為定位點與磁鐵的相對位置（如圖十三
的dx,dy）， ( ),px pyK K 為X與Y軸的位置控制器，
( ),x yG G 為 X 與 Y 軸的速度迴路轉移函數，
( ), ,xf yf zfB B B 為探棒所感測到的三維磁通密度，
( ),f fx y 為探棒與磁鐵的相對位置， ( ),cmd cmdx y 為
實際輸入馬達的位置命令。另外， Position 
generator是利用距離增加與總磁通密度衰退的關
係，進行曲線揉合後，依照輸入的總磁通密度換
算出對應的距離d，並比照(5)式V轉換為Vx_cmd及
Vy_cmd的比例關係，求得如圖十三的dx與dy，而
Command generator則是將 ( )* *,cmd cmdx y 與 ( ),f fx y 在
每一個取樣時間內的步階誤差，轉換成系統較能
負荷的斜坡命令，使得定位過程更為平順。 
結果與討論 
如圖十五的實驗結果顯示，以磁向量追蹤法
確實可使探棒沿PCJJJG方向運動，並於指定磁通密度
範圍內靜止。在追蹤過程中，由於基底速度V的
設計，當探棒距離磁鐵較遠時，追蹤速度較快，
而在接近指定磁通密度範圍時，追蹤速度則減緩
（減小靜止前的Overshoot現象），如此可使追蹤
兼具快速響應與減少靜止時的穩定時間。 在磁
定位的議題上，經過本研究所提出的磁定位控制
架構，實驗顯示，最終定位點的三維磁通密度
( ) ( ), , 284,307,35xf yf zfB B B = ，與預計定位目標的
( )* * *, , (286,308,37)x y zB B B = 相當接近，經過position 
generator轉換後，可得知X軸的定位誤差為
0.06mm，而Y軸的定位誤差為0.12m。 
 
三、成果自評 
本計畫提出以 B-spline 磁場分佈重建法之磁
場量測技術，可大幅度縮短量測時間，並維持高
量測精度。以等磁曲線作為磁鐵檢測的創新概
念，具有節省檢測時間的優點，而所提出的三點
搜尋法也可精確求出指定的等磁曲線。在磁追蹤
與磁定位上，所提出的磁向量控制與磁定位控制
架構也都具有相當優異的成效。本計畫部分成果
已發表於 JMMM 國際期刊[8]，估計未來可持續
發表 2~3 篇之國際期刊論文及多項專利申請。此
外，在實務應用上，完成架設國內學界第一台三
維磁場自動量測平台，並曾多次以義務性質之方
式，協助國內業界進行相關馬達量測，如威騰新
技、日立及全興工業等多家公司。除了磁場量測
技術的提升，本研究對磁追蹤與磁定位技術的建
立，更進一步提供業界對運動控制的新思維，並
 6
magnet
10
0 m
m
32 mmspecified plane
S17
S1
T1
T34
H
E F
G
1S
projected boundary
x
y
z
(unit: mm.)
1T ( 0 , 0 ~ 32, 2)
34T ( 99 , 0 ~ 32, 2)
( 0 , 0 ~ 100, 2)
32S ( 32 , 0 ~ 100, 2)
{
{
8.5mm
52 mm
( x,     y,     z )
 
圖四 指定的磁通密度量測軌跡 
0 20 40 60 80 100
500
1000
1500
0 10 20 300
500
1000
1500
2000
M
ag
ne
tic
 fi
el
d 
(B
)
Coordination X (mm) Coordination Y (mm)
M
ag
ne
tic
 fi
el
d 
(B
)
EF GH EH FG
S1 ~ S17 T1 ~ T34
                         
圖五 沿指定軌跡的磁通密度分佈 
0
30
100X-axis
Y
-a
xi
s
(a)
0
30
100X-axis
(b)
EF GH
EH
FG
 
圖六 (a)平均分散取樣 (b)集中取樣 
                         
圖七 指定平面上的磁通密度分佈。(a)實驗量測結果 (b)集中取樣法 (c)平均分散取樣 
 8
Step 1
Does optimum point 
satisfy the request?
Step 2
Does optimum point 
satisfy the request?
NO
YES
Measuring gap 
adjustment
YES
NO
Measuring gap 
adjustment
Do optimum points 
form a closed loop?
YES
YES
Measured isomagnetic 
line is acquired
NO
 
圖十一 三點搜尋法流程圖 
magnet
projected rectangle
probe
x
y
z
P
Cdy
dx
d
PC
JJJG ( ), ,cx cy czB B B
( ), ,px py pzB B B
圖十三 等磁曲線的量測結果 
  
 
-5 0 5 10 15 20 25 30 35 40 45
-60
-50
-40
-30
-20
-10
0
10
20
X axis (mm)
Y
 a
xi
s (
m
m
)
Triple-point 
searching
 
圖十二 等磁曲線的量測結果 
 
0 20 40 60 80 100 120-120
-100
-80
-60
-40
-20
0
Initial location of probe
Little overshoot
X position (mm)
Y
 p
os
iti
on
 (m
m
)
P
magnet
C
 
圖十五磁向量追蹤的結果示意圖 
 
 
Position 
generator
*
xB
pxK xG
pyK yG
F.W.BELL 
7030 
Gaussmeter xf
B
yfB
zfB
*
cmdx
*
cmdy
x
y
fx
fy
Command
generator
cmdx
cmdy
*
yB
*
zB
Position 
generator
1
s
1
s
                
 圖十四 磁定位控制架構 
