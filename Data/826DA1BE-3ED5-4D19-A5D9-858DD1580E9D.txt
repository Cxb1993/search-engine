 2
進。由於影像處理系統已經能成熟應用於產業上，如
能在半自動專用機上搭配影像處理系統，將其改為自
動化機械，相信可達成雷射光產品自動化生產的技術。 
目前昕偉公司所開發的半自動對焦機是由操作
人員觀察光點的範圍，並以伺服控制系統上寸動方式
控制進給量，達到所需光點的大小。計畫於原有系統
上增加影像系統，作為對焦光點的回饋，由影像資料
運算出誤差量後，利用伺服控制卡及伺服馬達等設備
自動進給，以達成自動對焦。如此，可減少人員操作
上的缺失，並增加產品品質上的穩定。另外，期望後
續能整合前端的自動境片固定機，以達成整體生產線
自動化的目標。將對焦影像處理及控制系統的研發成
果整合至半自動對焦機上，昕偉公司預估其結果可增
加 30%的產量，提升 50%的良率，並能提昇一倍以上
的產品精度。如能再整合前後端的專用機，預估效益
可提昇一倍以上。此對現有廠商的成本降低及品質提
升具有莫大幫助，並能提高產品在國際上的競爭優
勢。而且此一產品成熟後，可立即投入產業界的生產
行列。 
視覺機器隨著軟硬體技術的不斷進步、社會的需
求與經濟層面的考量，已經在許多領域逐漸取代人工
檢測，廣泛地應用於各種檢測工作上[1-7]。視覺機器
具有快速、不疲勞以及穩定等優點。使用視覺機器自
動檢測技術，不但可以降低人工檢驗的負擔與人為的
疏失，更可以提高檢測速度與可靠性。影像中像素點
之灰階強度值受到諸如 CCD 解析度、曝光時間、焦
點與物體表面真直度問題和表面反射特性等因素之影
響。因此，在二維之真實影像系統中，CCD 會接收
從物體表面(x,y)和相鄰各點反射之光線，而物體表面
與背景反射特性之差異，亦會對影像中邊緣像素點
(x,y)之位置產生影響，越靠近邊緣點其影響度越高。
因此本計畫乃擬使用視覺方式，來偵測雷射光聚焦的
情況，以作為對焦機調整雷射光源焦距之用。 
對於一個良好的雷射光源，通過物鏡所聚焦出來
的光點必須滿足一定的要求。就 DVD 光學讀取頭而
言，通常在資料方向與半徑方向的光點大小（spot 
size），分別為 0.55μm 及 0.57μm 以下，且旁瓣
（side-lobe）光強度須低於中央強度的 10%以下。然
一般而言，影響光點大小及品質有四個參數，分別是
雷射光波長(λ)、聚焦物鏡的數值孔徑、波前像差
（Aberration）和光瞳上的光能量分佈。而雷射光之光
能量分佈則皆以高斯分佈的形式假設之，因此為了確
認光點品質良好，製造廠商必須要求雷射具極佳穩定
功率、高平行性、圓形光束與輸出模態為基本 TEMoo 
模態的高斯光束，使雷射光束經雙焦點透鏡後能聚焦
至最小的光點，以便於能正確地讀取極高密度容量的
資料。如果產生的雷射光束之強度是高斯的空間分佈
形態，則此雷射光束稱為高斯光束，其電場分佈為 
)
)(2
exp()))tan((exp(
)
)(
exp(
)(
),(
2
2
2
0
0
zR
rjk
z
zkzj
zW
r
zW
WEzrE
R
−−−
×−=
（1） 
上式等號後第一項為一振幅因子 (Amplitude 
factor)，其表示振幅隨 r 值而改變的關係；第二項為
光波沿軸向(Longitudinal)z 的相位變化關係；第三項
(c)則為表示光波沿徑向(Radial) r 的相位變化關係。(1)
式中 W0 及λ決定了高斯光束的所有性質。由於光波
之電場變化甚快，因此在檢測上都以光強度的方式處
理。又一般光檢測器量到的都是光的強度分佈而不是
振福，因此由（1）式和其共軛複數相乘積而得光的強
度分佈。因此本計畫，以半自動對焦機整合視覺系統，
發展對焦技術，使視覺機器能透過對焦目標函數，自
主性地評估出最佳對焦位置。 
影像自動對焦方面的研究方面主要有：Nayar[8]
等人，提出外形對焦的方法，經由擷取對焦點附近一
連串的影像，並利用解析度良好的清晰度運算法及深
度估測法(Depth Estimation)，試圖建構出原影像的輪
廓。Baina[9]等人，利用數位化後的影像，對整張影像
進行離散餘弦轉換 (DCT)，再將每一點轉換後的數值
取平方做加總，推導出判斷清晰度尺度的方法。
Kautsky[10] 等人與 Widjaja[11]等人，使用小波轉換
(Wavelet Transform) 的方法，以增強影像邊緣的特
性。經小波轉換後的影像，再根据頻譜和自我校正函
數推導清晰度尺度，據稱會有較高的空間解析度。
Murali[12]等人，說明在實際應用上，同樣的硬體架
構，採用相異的清晰度運算法會得到不同的最佳對焦
位置。採用何種清晰度運算法才能找出實際上最佳對
焦位置且最適合當時的環境，為解決此問題提出
AUM(Autofocus Uncertain Measure) 及 ARMS 
error(Autofocus Root-Mean-Square Error)為對焦距離
的誤差分析，以找出最佳的清晰度尺度。Kesseler[13]
等人，闡述在自動對焦的系統中，最基本的部份乃是
 4
法。對焦清楚與模糊之影像相較，清楚對焦影像可以
提供較正確的影像資訊，這對提高影像處理的精確度
而言是相當有幫助的。 
 
 
圖 3 雷射光源元件裝配機之實體圖 
 
雷射光源元件之裝配設備實體圖如圖 3 所示，其
將雷射二極體推至合適的位置以得到正確地對焦。雷
射光點經由反光鏡投影至螢幕，光點之影像資料經由
具 LMZ45T3 鏡碩之 CV-M1 CCD 攝影機與 Matrox 公
司之 Meteor2-MC/4 擷取卡擷取至主控電腦中。雷射
二極體對焦初期之雷射光點的影像外圈之模糊區的平
均直徑約為 10cm，而內圈之明亮區的平均直徑約為
8cm。對焦中期之雷射光點的影像外圈之模糊區的平
均直徑約為 5cm，而內圈之明亮區的平均直徑約為
1cm。對焦完成之雷射光點的影像外圈之模糊區的平
均直徑約為 1.5cm，而內圈之明亮區的平均直徑約為
3mm。對焦完成雷射光點影像的外圈模糊區十分暗
淡。雖然雷射光點的形狀不真是個圓形，但求取真圓
度之最大-最小方法仍可用來求光點的平均直徑，而光
點的面積可用具此平均直徑之圓的面積近似之。因此
四點定圓的方法[21]可加以擴充至三值影像上使用，
其可用以求取模糊區和明亮區的中心和面積。當模糊
區的面積足夠小時(因為相當暗淡)，即可達成成品。
因此，模糊區與明亮區的面積大小及模糊區與明亮區
間面積大小比值可用作為自動對焦的準則。 
將物件與背景影像區分出來最簡單的方法為閥
值化(thresholding)，本計畫使用像素統計直方圖中最
大谷底法[25]搜尋各個門檻值。首先求得像素統計直
方圖中所有谷底的灰階值，然後將各谷底間之像素數
量累加起來，最後定出三個最大尖峰(peak)間的兩個
谷底為門檻值，如此即達成三值化雷射光點影像，其
結果如圖 4 所示。 
 
 
圖 4 三值化後之雷射光點的影像 
 
三個不共線的點可構成一圓，我們可量測一圓孔輪廓
上的三個點，即可由這三個量測點計算出圓孔的圓心
和半徑。若三點座標分別為 )y,x 11( 、  )y,x 22( 和
)y,x 33( ，則其可構成(3)式之兩條線，而兩條線的交
點即為圓孔的圓心。 
如果我們量測一圓孔輪廓上的四個點，則每三個
量測點可由(4)式計算出一組圓心和半徑，共可求得
443 =C 組圓心和半徑。每組圓心和半徑與另一個量測
可求得每個圓心的最大半徑與最小半徑。根據最小真
圓度原理，我們取最大半徑與最小半徑間之差值為最
小時的圓心為較正確的圓心，而雷射光點的面積則由
其平均半徑計算而得。假設 )y,x( nn 為粗略的圓心，
而 r 為粗略的半徑，我們可由 )/ry,x( nn 2+ 向下掃描
影像直到找到邊界點 )y,x 11( ，然後由 )/ry,x( nn 2−
向上掃描影像直到找到邊界點 )y,x 22( ，同時我們由
)y,/rx( nn 2+ 向 右 掃 描 影 像 直 到 找 到 邊 界 點
)y,x 33( ，然後再由 )y,/rx( nn 2− 向左掃描影像直到
找到邊界點 )y,x 44( 。最後我們可針對模糊區之灰階
值與明亮區之灰階值，分別找出其邊界上的四個點，
然後分別按其所找出之四點以四點定圓法求出其圓心
與半徑。 
表 1. 求取光點面積之各種方法的結果 
方法 面積 (像素) 速度 (1/1000 s)
面積法 34967 312 
三點定圓法 33245 4 
輪廓追蹤法 35240 52 
最小方差法 35020 178 
四點定圓法 34954 5 
圖 4 中雷射光點之四個定圓法量測的結果與面積法、
三點定圓法、輪廓追蹤法及最小方差法的結果如表 1
所示。由表 1 結果可知，此五種方法的準確度均佳，
但面積法及最小方差法的速度較慢。三點定圓法的速
 6
常排除五部份。開機部份用來確認電源(是否為單相
220V)並連接上指示燈，並且確認接地線是否連接，
上下模具是否固定並校準中心；然後啟動進入歡迎畫
面的人機界面並顯示相關錯誤訊息。操作設定部份擬
設計如圖 7 所示。操作設定部份提供歸零操作、校正
起始點操作、寸動鍵微調動作、速度設定、自動校正
模式、自動或手動加工、計數清除歸零、自動計數與
顯示目前座標值等功能。參數設定部份擬設計如圖 8
所示。參數設定部份提供機具安裝工程師設定相關參
數使用。手動模式設定部份擬設計如圖 9 所示。手動
模式設定部份提供加工程式設計人員測試製程程式之
用。最後，異常排除部份則提供當系統發生異常狀態
時，技術人員維修之用。 
 
四、結論 
本計畫使用 ANC302 控制器連接現有之半自動
之雷射光源元件組裝機，而完成一使用影像回授、自
動對焦之全自動雷射光源元件之組裝機。自動對焦控
制器操作設定部份提供歸零操作、校正起始點操作、
寸動鍵微調動作、速度設定、自動校正模式、自動或
手動加工、計數清除歸零、自動計數與顯示目前座標
值等功能。經由此雷射光元件自動裝配控制器之研發
自動對焦機生產的產品，可減少人員操作上的缺失，
並增加產品的品質。 
 
五、參考文獻 
[1] 黃嘉慶，高速被動式自動對焦技術，元智大學機
械工程學系碩士論文，民國九十年。 
[2] 潘嘉偉，變焦測深技術的應用，國立中山大學機
械工程學系碩士論文，民國八十八年。 
[3] 陳伯睿，光纖自動對準組裝技術研發，國立臺灣
大學機械工程學系碩士論文，民國九十年。 
[4] 廖展漣，應用 DVD 探頭及陰影檢測法於精密面
上位移量測系統之研製，國立臺灣大學機械工程
學碩士論文，民國九十一年。 
[5] 徐俊豪，強健之次像素邊緣檢測新技術，國立中
興大學機械工程學系碩士論文，民國八十八年。 
[6] 郭大正，停車場自動監視系統，中華大學資訊工
程系碩士論文，民國九十二年。 
[7] 許懷文，水下動態視覺系統之研究，國立台灣大
學工程科學與海洋工程學系碩士論文，九十二年
度。 
[8] S.K. Nayar and Y. Nakagawa, “Shape from focus,” 
Proceedings of the IEEE Transactions on Pattern 
Analysis and Machine Intelligence, Vol. 4, No. 8, 
pp. 824-831, August 1994. 
[9] J. Baina and J. Dublet, “Automatic focus and iris 
control for video cameras,” Fifth International 
Conference on Image Processing and its 
Applications, pp.232-235, 1995. 
[10] Jaroslav Kautsky, Jan Flusser, Barbara Zitová and 
Stanislava Šimberová, “A new wavelet-based 
measure of image focus,” Pattern Recognition 
Letters, Volume: 23, Issue: 14, pp. 1785-1794, 
December 2002. 
[11] J. Widjaja and S. Jutamulia, “Wavelet 
transform-based autofocus camera systems,” 
Proceedings of the IEEE Asia-Pacific Conference 
on Circuits and Systems, pp. 49-51, 1998. 
[12] M. Subbarao and J.K. Tyan, “Selecting the optimal 
focus measure for autofocusing and 
depth-from-focus,” Proceedings of the IEEE 
Transactions on Pattern Analysis and Machine 
Intelligence, Vol. 20, No. 8, pp. 864-870, August 
1998. 
[13] W. Kesseler and J. Fischer, “Analytical model of 
autofocus systems with CCD camera,” Proceedings 
of the International Society of Optical Engineering, 
International Conference on Sensors, Camera 
Systems for Scientific, Industrial and Digital 
Photography Applications, Vol. 3965, pp. 396-380, 
May 2000. 
[14] N. Kuang Chern, Poo Aun Neow and M.H Jr. Ang,, 
“Practical issues in pixel-based autofocusing for 
machine vision,” Proceedings of the IEEE 
International Conference on Robotics and 
Automation, Vol. 3, pp. 2791-2796, 2001. 
[15] B.K.P. Horn, “Focusing,” Technical Report 
AIM-160, Massachusetts Institute of Technology, 
May 1968. 
[16] E.R. Davies, “Machine vision: theory, algorithms, 
practicalities,” Academic Press Limited, 1990. 
