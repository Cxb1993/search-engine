1中文摘要
對於工程而言，地下水位常影響工程施工進度與難易程度，因此施工時應適當掌握水
位變動以擬定適當策略，但由於地下水位之變化常受各種因素影響，因此預測不易。考慮
地下水位變動屬於時間序列之資料，且變動量呈現週期性隨機變動，因此已有許多研究使
用時間序列的方式預測地下水水位。近年來，類神經網路也逐漸被應用於時間序列之預測
上，多個應用例也皆已說明其為一種實用之時間序列預測工具。其中，又以倒傳遞類神經
網路(back-propagation neural network)最廣為被熟知及應用。然而，倒傳遞類神經網路於訓
練過程中會有許多問題。其中，網路學習速度緩慢以及隱藏層結構不易訂定是其主要缺點。
有鑑於此，本研究將嘗試結合自組織映射圖網路(self-organizing map；簡稱 SOM)與倒傳遞
類神經網路(簡稱 BP)之原理，建立一個時間序列預測模式，稱之為 SOM-BP 模式，並將此
模式應用於彰化地區十個地下水位站之月平均地下水位之預測上（1997 年 7 月至 2004 年
11 月），再與傳統之 ARIMA 模式及 BPN 模式比較。研究結果顯示，SOM-BPN 模式確實
能較客觀地確立網路之隱藏層神經元數目，且預測之精確度較傳統之 ARIMA 模式及 BPN
模式為佳。惟應用多站預測單站之精度並不一定比單站預測單站之精確度為高，蓋因受干
擾(noise)太多所致。故本研究再應用克利金(kriging)之半變異圖(semi-variogram)理論，以選
定影響範圍內之水位觀測站資料作為模式之輸入項，研究結果顯示結合克利金之 SOM-BPN
模式可得到較多站預測單站模式與單站預測單站模式更精確之地下水位預測值。
關鍵詞：倒傳遞類神經網路，自組織映射圖網路，地下水，時間序列分析
Abstract
In recent years, artificial neural networks are often used for time series forecasting. Among
them, the back-propagation network (BPN) is the popular one. The self-organizing map (SOM)
can project high-dimensional input space on a low-dimensional topology so as to allow one to
figure out the number of clusters directly by eyes. In this paper, based on the combination of BP
and SOM, a time-series forecasting model is proposed, named SOM-BPN model. The proposed
model is applied to actual groundwater head data in Chang-hua area. According to the results, it
is found that the multi-site model can not forecast groundwater level more precisely as compared
to the other two models, because the inclusion of irrelevant information adds noises to the
network and undermines the performance of the network. The semi-variogram is applied to
determine the required number of nearby stations whose groundwater level information will be
used as input to the model. The results show that the proposed model is more competent in
modeling and forecasting time series.
Keywords: back-propagation network, self-organizing map network, groundwater, time series
analysis
一、前言
地下水位對於日常生活影響甚多，如農業區之灌溉用水與鄉村區之日常汲水等，對於
工程上則影響著施工的安全性、複雜度與成本等問題等，因此若能瞭解地下水位之變化趨
勢，不僅可供水資源調配與利用之規劃，亦可幫助工程師提出有效之對策。而近年來國內
外已有許多關於地下水之相關研究，整理如下：
1. 蘇苗彬等人(1996)即利用單變量 ARIMA 模式，針對青礐溪、無名溪、松山區等集水區，
求得月水位預測模式。又於(1999)利用多變量 ARIMA 模式，推求降雨量與地下水位之關
3傳遞類神經網路(簡稱 BPN)，為目前應用最普遍之類神經網路。係由 Rumelhart et al.(1986)
所提出的。因類神經網路具有學習及回想之功能，故本研究選擇此模式進行預測。
True value
Onput LayerHidden LayerInput Layer
Σ
圖 1 倒傳遞類神經網路架構圖
BPN 是以監督式的學習來處理輸入與輸出間之非線性映射關係，在過程中利用最陡坡
降法(gradient steepest descent method)之觀念，將誤差函數予以最小化，其誤差函數如下所
示：
])([
2
1
1 1
2
 

M
i
N
j
ijij ydF (1)
其中， ijd 為網路模式之輸出值； ijy 為實際值；M 為訓練資料之數目；N 為輸出層之神經元
數目。於整個網路中，第 k 層中第 j 個神經元之輸出值 kju ，可表示如下：



m
i
k
i
kk
ij
k
j uwu
1
1,1 ( 2 )
其中， kkijw
,1 為連結第 k-1 層中第 i 個神經元與第 k 層中第 j 個神經元之權重；m 為傳遞至第
k-1 層中第 i 個神經元之輸入數目。模式會將結果反饋至隱藏層，經由下式計算其權重係數
改變量：
)()1( ,11,1 nwunw kkij
k
i
k
j
kk
ij
   (3)
其中，n 為回圈數目； 1kiu 為第 k-1 層中第 i 個神經元之輸出；
k
j為第 k 層中第 j 個神經元
之差距量；為學習速度參數；為慣性項(momentum term)。而 kj可經由下式導得：










1
1
1,1)(
)(
km
r
kk
jr
k
rk
j
k
j
l
j
l
j
j
k
j
w
du
udf
du
udf
e

 (4)
其中，f 為神經元之非線性轉換函數； 1km 為傳遞至第 k+1 層中第 r 個神經元之輸入單元數
目； je 為第 j 個神經元之誤差。最常被使用之非線性轉換函數為雙彎曲函數（sigmoid
function）：
)exp(1
1
)( k
j
k
j u
uf

 (5)
於函數中， kju 之範圍為  ，所以 )( kjuf 介於 0 跟 1 之間。
for node j in output layer l
for node j in hidden layer k
5(topology)。此階段的主要功能是要將高維度的輸入樣式(input pattern)轉化為其他維度，原
則上是將高維度的輸入樣式轉化為低維度的樣式。
圖 2 SOM 網路架構圖
SOM 之基本原理可以追溯到人類大腦結構的特性，人類大腦中具有相似功能的腦細胞
會群聚在一起，如大腦中有專管視覺、聽覺、味覺等不同地區塊，亦即大腦神經細胞有物
以類聚的特性。而 SOM 則是模仿此種特性，從問題中取得訓練範例(所有輸入變數值)，從
中學習範例的內在聚類映射規則。當學習完畢之後，其輸出單元會與鄰近單元相互影響而
具有相似的功能，亦即具有相似的連結加權值。而 SOM 之學習過程中包含三個重要的程
序，分別是競爭程序(competitive process)、合作程序(cooperative process)以及調整程序
(adaptive process)。在競爭程序中，網路中所有的神經元彼此相互競爭以得到被激發的權
利；在競爭過程中獲得勝利的神經元則決定了拓樸鄰域(topological neighborhood)的位置，
提供合作程序所需拓樸鄰域的基準；最後一個是鍵結值的調整，在此過程中，神經元的鍵
結值是根據輸入樣式來調整，使得神經元逐漸地適應輸入樣式。重複這三個過程，直到網
路收斂，學習即結束。在每次的學習中，網路中的神經元會漸漸的改變，使得這些神經元
逐漸朝向逼近相對應的輸入樣式的方向，令神經元與其相對應的輸入樣式愈來愈相似。當
網路訓練完成後，即可在輸出層反映出輸入樣式內在的統計特徵。
三、實例應用
3.1 研究區域及資料
濁水溪沖積扇位於台灣之中西部之間，北至烏溪，南以北港溪為界，東鄰八卦山脈、斗
六丘陵區，西瀕台灣海峽。總面積約為 1800 平方公里，主要包括雲林、彰化及南投縣一部
分，為台灣之地下水的主要蘊藏地區。本區地下水資源豐富，永續性出水量（即通稱的安
全出水量）約為每年 15 億噸。據統計，彰化地區目前需水量約 36 萬噸；其中 6 萬噸是由
石岡壩供給，而地下水供給 30 萬噸，顯示境內的用水半數以上皆採自地下水，因此造成此
地區的地下水是超限使用最嚴重的地區之ㄧ。由此可見地下水在此地區的重要性。因此本
研究主要是選定彰化地區之地下水位觀測站為研究對象。
根據設置地下水觀測井時所得之地質資料研判，在此觀測深度內的水文地層，可分為五
層：第一層深度約從 0~50 m 深，第二層約從 50~120 m 深，第三層約從 120~200 m 深，第
四層約從 200~280 m 深，第五層約從 280~350 m 深，其中第二層又可分為兩層：上層約從
50~90 m，下層約從 90~120 m。但以上分法大致以地面為準，但各層之確實邊界，在不同
位置仍有不同。經過挑選後，本研究擬以 F2 富水層(第 2 含水層)與地質剖面線一(田中至線
西)與二(田中至漢寶)等十站之地下水位觀測站作為模式模擬之用，其相對位置如圖 3 所示。
73.3 結果
3.3-1 ARIMA 模式分析
經由 ARIMA 模式之分析後，可以得知每一地下水位觀測站之本月地下水位與前幾月
之平均地下水位存在有相關性。經整理後，如表 1 所示，此結果可以作為類神經網路訓練
資料之輸入依據。
表 1 各地下水位測站之相關月份
地下水位站別 相關月份
田中(1)站 -1、-2、-12
溪湖(2)站 -1、-2、-6、-13
好修(1)站 -1、-11、-12
文昌(3)站 -1、-2、-6、-13
洛津(2)站 -1、-2、-6、-13
漢寶(2)站 -1、-2、-13
員林(3)站 -1、-12、-13
花壇(3)站 -1、-2、-6、-12
東芳(1)站 -1、-12、-13
線西(3)站 -1、-6、-12、-13
3.3-2 克利金之半變異圖模式分析
本模式之主要目的是利用克利金法中之半變異圖理論來求出各地下水位測站在空間軸
上的影響範圍，藉此得知在類神經網路分析時應納入哪幾個地下水位測站作為輸入資料之
依據。在求解之過程中，須先以最小平方法(Method of least squares)去除各個水位觀測站原
始資料的長期趨勢(Trend)，再利用調合分析(Harmonic analysis)過濾出週期效應(Periodicity)
以作為輸入資料，並利用水文資料分析時常使用之指數型模式來進行回歸配套。其配套結
果如圖 4 所示。
0.0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0 5000 10000 15000 20000 25000 30000 35000
Integral Length(m)
va
ri
og
ra
m
圖 4 指數型模式回歸配套結果
9表 4 各地下水位觀測站之驗證資料 CE 值
CE 值_Test ARIMA 單站 BPN 單站 SOM-BPN 多站 BPN 多站 SOM-BPN 結合克利金之 SOM-BPN
田中 0.149 0.733 0.771 0.559 0.729 0.808
溪湖 -0.580 0.007 0.075 -0.043 0.280 0.409
好修 -0.890 -0.508 -0.349 0.039 0.275 0.514
文昌 -1.212 -1.014 -0.936 0.317 0.414 0.620
洛津 -1.623 -0.384 -0.306 -1.237 -0.827 -0.202
漢寶 -0.821 -0.058 -0.050 -0.533 0.105 0.501
員林 -0.453 0.504 0.505 0.388 0.433 0.572
花壇 -0.345 0.192 0.206 0.022 0.302 0.443
東芳 -1.266 0.463 0.514 0.231 0.245 0.572
線西 -0.787 0.312 0.433 0.429 0.484 0.623
表 5 各地下水位觀測站之訓練資料 RMSE 值
RMSE_Train ARIMA 單站 BPN 單站 SOM-BPN 多站 BPN 多站 SOM-BPN 結合克利金之 SOM-BPN
田中 0.470 0.512 0.501 0.088 0.097 0.393
溪湖 0.557 0.673 0.676 0.043 0.067 0.121
好修 0.664 0.671 0.695 0.036 0.054 0.063
文昌 0.651 0.812 0.791 0.033 0.059 0.069
洛津 0.834 0.866 0.860 0.041 0.066 0.097
漢寶 1.285 1.286 1.291 0.074 0.101 0.340
員林 0.646 0.620 0.620 0.098 0.113 0.315
花壇 0.739 0.870 0.870 0.076 0.088 0.200
東芳 0.509 0.730 0.744 0.073 0.083 0.145
線西 0.357 0.362 0.368 0.023 0.048 0.172
表 6 各地下水位觀測站之驗證資料 RMSE 值
RMSE_Test ARIMA 單站 BPN 單站 SOM-BPN 多站 BPN 多站 SOM-BPN 結合克利金之 SOM-BPN
田中 1.709 0.999 0.924 1.322 1.036 0.873
溪湖 0.986 0.824 0.795 0.843 0.701 0.635
好修 1.207 1.112 1.052 0.907 0.789 0.645
文昌 1.386 1.380 1.353 0.804 0.745 0.600
洛津 1.526 1.141 1.109 1.451 1.310 1.063
漢寶 2.412 1.889 1.882 2.273 1.737 1.298
員林 1.257 0.761 0.760 0.845 0.814 0.706
花壇 1.384 1.129 1.119 1.250 1.056 0.944
東芳 1.615 0.842 0.801 1.007 0.998 0.752
線西 0.808 0.532 0.483 0.484 0.461 0.395
