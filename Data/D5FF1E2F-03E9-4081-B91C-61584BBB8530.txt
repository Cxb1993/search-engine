 1
摘  要 
本研究發展一個整合操作系統與觀測系統之地下水營運最佳規劃流程，整個研究主要包含了
抽水系統及觀測系統之最佳規劃，所應用的方法有遺傳演算法、動態規劃、卡門濾波等理論。其
中抽水系統的決策變數為抽水量及抽水井網，而觀測系統的決策變數為觀測井網。有別於以往研
究中，將抽水系統與觀測系統分開考量，本研究則把兩者整合在一起，並考量兩者之交互影響。
本文並以假設的案例進行模擬，由案例分析結果顯示，水位觀測值與模擬值的模式差距越大，越
能突顯觀測成效，也就是在系統描述越不準確之情況下，對於節省抽水操作成本也會越顯著。 
關鍵詞：地下水管理、遺傳演算法、動態規劃、卡門濾波 
Abstract 
This study presents a novel procedure to optimally plan an integrated groundwater system. The 
integrated system comprises a groundwater supply system and a groundwater monitoring system. The 
decision variables for the groundwater supply system include the location, number and pumping rates of 
the pumping wells, while the decision variables for the monitoring system refers to the location of the 
monitoring wells. The Genetic programming (GA), Dynamic programming (DP) and Kalman filtering 
are applied to solve the optimal planning problem. In contrast to a previous study that designed the 
supply system and monitoring system separately, this work considers the two systems holistically, i.e., 
the two systems can influence each other. Numerical results indicate that the increased discrepancy 
between the observed data and model simulation can also increase the extent to which the monitoring 
system influences the design of supply system. Restated, a larger uncertainty of the model simulation 
implies a higher likelihood of applying the proposed procedure. 
Keywords：Groundwater management, Genetic programming, Dynamic programming, Kalman filter. 
一、研究目的 
地下水是人類重要的淡水資源之一，為使寶貴的地下水資源能永續利用，地下水的保育管
理工作實在刻不容緩。如何妥善的規劃抽水井操作佈置並使地下水資源的使用合理且滿足
需求，為一目前重要的課題，因此本研究希望可以提出一兼顧營運與觀測的整合性地下水
營運之最佳規劃模式。 
在過去學者所做的研究中，關於同時考量地下水管理及觀測之研究上，Andricevic and 
Kitanidis(1990)，在應用地下水之污染整治問題上，考量於進行觀測情況下之系統不確定
性，進行地下水污染整治之抽水優選，不過其所解問題為一維，而且是在抽水井位置及觀
測策略給定之條件下，進行抽水井之抽水量之優選。Andricevic (1990)延伸上述之研究，在
給定不同之觀測井網組合及抽水井位已知之條件下，優選即時操作之最佳抽水策略及決定
最佳觀測井網，在其研究中已同時考量最佳之抽水量及觀測井網，不過其觀測井網之組合
僅為 30 組。 
Andricevic (1993)更進一步在地下水水量即時操作管理問題中，考慮隨時間增加，每次遞增
一口觀測井及固定二口抽水井井數之條件下，決定最佳之抽水井位置及抽水量且優選出每
次增加觀測井位之最佳井位，但這樣的做法存在著試誤法的缺點，得到的解有可能會是局
部最佳解。 
在地下水管理系統研究中，有許多學者做過相關研究，其中地下水之水量與水質規劃模式，
雖然有許多方法可資利用如線性規劃[Aquado and Remson, 1974; Molz and Bell, 1977]， 非
線性規劃 [Murtagh and Saunders, 1982; Ahlfeld et al. 1988 a,b]，混合整數規劃[Rosenwald and 
Green]，遺傳演算法[Mckinney and Lin, 1995; Wang and Zheng, 1998]，微分動態規劃 
(Differential Dynamic Programming ,DDP) [Jones et al. 1987]。在這些方法之中，微分動態規
劃的方法可大幅減少地下水非線性問題之維度 [Jones et al. 1987]，且在地下水整治方面對
於非穩態問題，微分動態規劃可大幅降低計算量 [Chang et al. 1992; Culver and Shoemaker 
2.2 地下水流數值模式 
本研究針對地下水拘限含水層水量管理模式之最佳化設計提出討論，在拘限含水層地下水
流數值模式方面，本研究採用 ISOQUA 來模擬，基本上 ISOQUA 是用 Galerkin’s 有限元素
法及隱式有限差分法來處理地下水流控制方程式，本模式所考量之地下水流控制方程式為
一二維、均質、等向拘限含水層程式，其控制方程式如下 
( )
t
hSyxu
y
hK
yx
hK
x sj
jjjyyxx ∂
∂=+⎟⎟⎠
⎞
⎜⎜⎝
⎛
∂
∂
∂
∂+⎟⎠
⎞⎜⎝
⎛
∂
∂
∂
∂ ∑
Ω∈
,δ  (1) 
2.3 抽水系統最佳規劃模式定義 
本研究是以抽水系統總成本最小值為優選模式的目標函數，而總成本包括井的抽水操作成
本與設井之固定成本，並希望求得在滿足用水需求及限制條件之下，總成本為最小的一組
佈井組合及每一口井的最佳操作策略。因此可將此問題表示成如下之優選模式： 
目標函數： 
{ } [ ] ([ ]∑∑∑ = +∈∈∈ −⋅+⋅=
N
t
i
ti
i
t
IiIi
iIiuI
hLuCLCz
i
t 1
1
**
,,
21min )  (2) 
Ω⊂Δ××= ItCC ,32 γ  
限制式： 
{ } [ ] [ ] [ ]{ } { } [ ]{ }⎟⎠⎞⎜⎝⎛ +−Δ⎟⎠⎞⎜⎝⎛ Δ+=
−
+ ththtt uLFht
B
t
BAh ,
1
1
 (3) 
Iiuit ∈,  
Ntdu t
Ii
i
t ,...,2,1, =≥∑
∈
 (4) 
IiNtUuU it ∈=≤≤ ,,.....2,1max,min  (5) 
Nthh t ,.....2,1min =≤  (6) 
2.4 觀測系統最佳設計模式定義 
本研究是以卡門濾波理論為基礎，優選一觀測井網(佈井方案)，使得修正後水位的誤差為最
小，因此評定佈井組合的優劣可以卡門濾波中修正後水位的共變異矩陣做為指標。一般而
言愈多的觀測井數和愈高的觀測頻率，可以得到可靠度較大的預測水位，若模式經過率定
後，在相同的地下水文環境與觀測誤差下，能影響卡門濾波修正後水位誤差的就只剩下觀
測矩陣 C，藉由改變觀測矩陣，即改變觀測井之位置及密度，可以得到不同的卡門濾波修
正水位共變異矩陣（Pt），此 Pt 矩陣代表修正後水位的誤差，亦反映了觀測系統的效率，可
以利用此 Pt 為標準使用遺傳演算法在觀測操作成本花費最少下，找出最有效率的觀測系統
(佈井組合)。共變異矩陣衡量的方式有許多種如：D-Optimal、A-Optimal、E-Optimal、
G-Optimal 等(Silvey, 1980)，一般在井網設計中常用的有 A - Optimal 與 D – Optimal，本研
究採用 A-Optimal 做為量化共變異矩陣之方法，所謂 A-Optimal 即是共變異矩陣的跡(Trace)
值，當跡值愈小，其所代表之意義是各節點的卡門濾波修正水位之變異數的總和愈小，因
此本研究之問題可表示如下之優選模式： 
目標函數為觀測井井數最少： 
 3
 5
}{ 1−+= tTtttTttt RCMCCMK  (15)  
⎭⎬
⎫
⎩⎨
⎧ −+= −−∧ tttttt hCyKhh   (16)                                                
{ } tttt MCKIP −=   (17)     
四、數值算例 
本研究之假設區域，為一非穩態二維拘限、等向含水層，水流區域為 3000*5000 公尺，分
割為 77 個節點(node)，60 個元素(element)，並且有 35 個可設抽水井位如圖 3 所示，模式的
北邊及南邊為不透水邊界(no-flow boundary)，左邊及右邊分別為定水頭邊界，其中定水頭
邊界區域左邊定為 80 公尺，右邊定為 60 公尺。水力傳導係數(Hydraulic conductivity，K)，
儲水係數(Storage coefficient，S)，則根據不同案例給定。 
本研究於觀測系統設計模式中參考 KALMOD 的做法，針對抽水井位置的距離遠近，假設
了系統噪音分區，將整個區域的系統噪音分成 A、B、C、D 四區，其值分別為 0.643、 0.38、 
0.17、 0.063。數值給定方式是假設在抽水井處系統噪音 A 區最大，漸往外層離抽水井越
遠，系統噪音的影響越小，如圖 4 所示。 
 
4.1 第一階段抽水及觀測井位設計 
本研究中分成兩階段考量如圖 5 所示，第一階段先以較粗的時間間距進行系統規劃設計，
以 3 年為總規劃時間，一個時距是 91.25 天，也就是一季，來做觀測更新水位的探討，觀
測真值是假設整個區域的模擬水位加上 1m。3 年共可分成 12 個時刻，進行抽水策略的優
選(1~12 時刻)，並分析只考量抽水系統與同時考量抽水系統加上觀測系統之差異。粗時距
的規劃模式含水層參數假設如表 1 所示，來作 1~12 個時刻抽水策略優選，且經觀測更新水
位後得再重新優選抽水策略，每個時刻都進行觀測，但是每 3 個時刻，回饋更新一次水位。
用水需求方面如圖 6 所示為 12 個時刻之需水量圖，在此條件下，因時刻較長的緣故導致模
式水位會很快呈現穩態(steady state)，水位更新的影響不容易傳遞到後面時刻，因此無法考
量觀測系統的影響呈現，第一階段的計算旨在確定抽水井位與觀測井位，當抽水井位與觀
測井位同時固定之後，才進入第二階段細時距問題的探討。 
4.2 第二階段各案例探討 
第二階段的問題，把總研究時間修改成 1 年，每個時刻為 5 天，因此 1 年可以分成 72 個時
刻來探討。在操作上進行抽水策略的優選(1~72 時刻)，用來分析僅有抽水模式及有配合觀
測系統的抽水管理模式兩者間的差異，並以兩組抽水策略於假設的真實模式中進行地下水
的正向模擬，來就抽水操作成本花費大小及影響的原因做一個比較分析。 
第二階段將僅就第一階段所優選的 5 口抽水井如圖 7 所示，來做抽水量的最佳調配，觀測
井網也由優選得到的 10 口觀測井如圖 8 所示，進行觀測更新。在此前提下，再比較有無觀
測系統(水位更新)下兩者抽水量的不同，並計算比較抽水操作成本的差異，主要是藉由 K
值與 S 值的改變，來比較有觀測系統水位更新加入所得到的抽水策略差異及兩者抽水操作
成本之百分比差異大小，所設計之 12 個 case，其中主要在於真實模式的 K 值是有分區改變，
分為 K 值左右分區及上下分區。而抽水管理模式所面對的是一個簡化的系統其 K 值是假設
整區不變，這樣模式就會分成兩組。有分區這一組就當成真實系統，其模擬所得水位當做
真值，未分區的一組為規劃模式所處理的簡化系統其模擬水位即為系統模擬值。本研究第
 7
到 case4-1 的 US$233583.22 元，因抽水更容易所以省下 US$1719.24 元，有觀測情況下抽水
操作成本從原先的 case4 的 US$235137.68 元，降到 case4-1 的 US$226324.75 元，也是因抽
水更容易所以節省金額為 US$8812.93 元，從這樣的比較可以看出，只因為 S 值的放大，抽
水節省的金額因觀測的影響居然也成長了 5.13 倍。 
4.2.3 加大系統噪音對抽水操作成本的影響 
case6 如果把儲水係數改為 0.1 之外，再把系統噪音值加大，也就是如表 4-5 所示的 case6-2，
藉此增加卡門權重的大小，來把觀測值更新這個效應增強，原來系統噪音值為 0.643、0.38、
0.17、0.063，放大後為 3.0、2.0、1.0、0.5。在這案例下，沒觀測值更新部分的抽水操作成
本花費同為 US$214563.87 元，但是有觀測更新部分從原來的 US$201041.32 元降到
US$200794.66 元，差了 US$246.66 元，case6-2 的省錢百分比達 6.86%，比 case6-1 的 6.73%
又提高了 0.13%，可見增加卡門權重也是凸顯觀測資訊的方式之一。 
由本研究結果的分析可以得到以下結論，主要在影響水位更新的原因可以分成兩個部分：
一、系統轉移矩陣，二、系統噪音。系統轉移矩陣主要是由水力傳導係數(Hydraulic 
conductivity)、儲水係數(Storage coefficient)、模式時間的間距(Time step)三個因素所影響。
如果想要讓水位更新值能發揮影響力，當然系統轉移矩陣需要變大，除此之外系統噪音也
需加大。但是要讓系統轉移矩陣變大，做法上可以把水力傳導係數(Hydraulic conductivity)
減小，儲水係數(Storage coefficient)加大，時間間距縮短。 
五、結論 
1. 本研究主要是成功把抽水系統與觀測系統結合，並探討有無觀測值更新水位下，抽水策
略操作成本花費的差異程度，由結果可以知道有加上觀測，所得到的抽水策略，會比僅
有抽水模式規劃但未加觀測來的省錢，所以加上觀測確實可以提升地下水的管理，使整
個抽水策略規劃能因為觀測值的更新更臻於完善。 
2. 由案例分析結果顯示，水位觀測值與模擬值的模式差距越大，越能突顯觀測成效，也就
是在系統描述越不準確之情況下，對於抽水操作成本省錢的結果也會越顯著。 
3. 研究中可以發現，儲水係數(Storage coefficient)對於有無觀測水位更新之結果的影響，遠
比其他條件的改變更大，但是於實際拘限含水層中，儲水係數並不大，所以觀測水位更
新的問題，對於非拘限含水層而言應更能凸顯其影響程度。 
4. 從結果分析可以知道，影響水位更新效能的原因可以分成兩個部分：一、系統轉移矩陣，
二、系統噪音。系統轉移矩陣主要是由水力傳導係數(Hydraulic conductivity)、儲水係數
(Storage coefficient)、模式時間的間距(time step)三個因素所影響。 
六、參考文獻 
1. 潘禎哲，”改良式降低變異數分析於地下水觀測井網規劃之應用”，碩士論文，(1994)。 
2. 陳宇文，“類神經網路於入滲池最佳化設計之應用”，國立交通大學土木工程研究所碩士
論文，  
3. 薛安聿，“應用遺傳演算法與最佳控制於非拘限含水層之水量管理營運”，國立交通大學
土木工程研究所碩士論文，(2002)。 
4. 蕭金財，“序率最佳控制理論應用於水庫系統之優選操作”， 國立交通大學土木工程研
究所碩士論文，（1994）。 
5. 蕭金財，“動態控制理論與遺傳演算法應用於地下水之管理與污染整治”， 國立交通大
學土木工程研究所博士論文，（2001）。 
6. 葉明生，“濁水溪沖積扇地下水序率數值模擬模式之研究”，國立交通大學土木工程研究
所碩士論文，(1996)。 
 t=0
k=t+1
GA+CDDP
(1)優選抽水系統
h
∧
k
GA+Kalman Filter
+地下水方程式
(2)
C
最佳觀測矩陣
觀測方程式
(3)
優選觀測系統
K值
S值
.
.
.
1−
∧
kh
tU
tZ _
時 刻 Nk tt ~  
tG _
tF _
t = t+1
水位更新
時 刻 Nk tt ~  
 
圖 1 抽水策略與觀測策略關係流程圖 
假設之真實系
統(1) 簡化系統(2)
真實系統數值
模式模擬(6)
抽水及觀測系統規劃設計(4)
抽水系統(5)
觀測水位(8)
觀測系統(7)
水位更新(10)
簡化系統數值模
擬(3)
模擬水位(9)
簡化
 
 
圖 2 水位更新流程圖 
 
圖 3 抽水井可設井位圖            圖 4 系統噪音分區圖 
粗時距抽水管理系統
抽水模式 觀測模式 觀測水位進行水位更新
細時距抽水管理系統
抽水模式 觀測模式 觀測水位進行水位更新
模擬1~72個時刻，總規劃時間1年，
時間間距5天
利用遺傳演算
法
確定抽水及觀
測井位
由粗時距所
優選井位，
來做抽水規
劃調配
模擬1~12個時刻，總規劃時間3年，
時間間距91.25天
 
圖 5 本研究案例抽水管理系統圖 
 
 
 
 
 
 
 
 
 
圖 6 模擬 12 時刻之需水量圖 
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
1 2 3 4 5 6 7 8 9 10 11 12
time step(91.25天)
需水量
(m3/s)
 9
case5 k1=4.31*10E-3 k1=4.31*10E-4 S=0.001 243021.12 243225.3 204.18 0.08%
(上下分區) k2=2.59*10E-4 k2=4.31*10E-4           
case6 k1=4.31*10E-3 k1=4.31*10E-4 S=0.001 214965.31 215675.77 710.46 0.33%
(左右分區) k2=2.59*10E-4 k2=4.31*10E-4           
case7 k1=2.59*10E-4 k1=4.31*10E-4 S=0.001 273875.36 274437.89 562.53 0.21%
(左右分區) k2=4.31*10E-4 k2=4.31*10E-4           
(僅右邊補注)               
 
 
表 3 結果分析表二 
 真實的 K 值 模式的 K 值   
有觀測下抽
水操作成本花費
(US$A)  
沒觀測下
抽水操作成本
花費(US$B) 
兩者差
US$(B-A) 
百分比
(B-A)/A
case4-1 k1=4.31*10E-3 k1=4.31*10E-4 S=0.1 226324.75 233583.22 7258.47 3.21%
(上下分區) k2=4.31*10E-4 k2=4.31*10E-4           
case6-1 k1=4.31*10E-3 k1=4.31*10E-4 S=0.1 201041.32 214563.87 13522.55 6.73%
(左右分區) k2=2.59*10E-4 k2=4.31*10E-4           
case6-2 k1=4.31*10E-3 k1=4.31*10E-4 S=0.1 200794.66 214563.87 13769.21 6.86%
(左右分區) k2=2.59*10E-4 k2=4.31*10E-4           
(增大系統噪音)               
case7-1 k1=2.59*10E-4 k1=4.31*10E-4 S=0.001 276661.35 277099.52 438.17 0.16%
(左右分區) k2=4.31*10E-4 k2=4.31*10E-4           
(僅右邊補注)               
(定水頭 70~65m)               
case7-2 k1=4.31*10E-4 k1=4.31*10E-4 S=0.1 253948.6 255080.14 1131.54 0.45%
(左右分區) k2=4.31*10E-4 k2=4.31*10E-4           
(僅右邊補注)               
(定水頭 70~65m)               
 
 
 11
