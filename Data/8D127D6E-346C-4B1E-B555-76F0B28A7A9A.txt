非最小相系統之適應性評估控制
計畫編號：NSC 97-2221-E-012-002
計畫主持人：林傳凱 教授
海軍軍官學校電機系
摘 要
本研究惟模糊小波網路之適應性評估控制對非最小相系統進行追蹤控制。此適應性評
估控制架構由關聯搜尋網路 (ASN)、適應性評網路 (ACN)、狀態回饋控制器、模糊小波網
路及強健性控制器所組成，可保證追蹤性能。而非最小相系統的零點動態利用線性化設計
狀態回饋控制器確保其穩定性。模糊小波網路則是用於近似未知非線性函數，因此需要強
健性控制器對付近似誤差及不確定項如外部干擾等。而且模糊小波網路所有參數的調整都
是線上(on-line)學習。本研究以李雅普諾夫(Lyapunov)理論證明整個閉迴路系統是穩定的，
最後，除了藉由理論的推導，更進一步予以硬體實現，利用數位信號處理介面卡將控制命
令送給旋轉倒單擺，來驗證所提出適應性評估控制器之性能與實用性。
關鍵詞: 適應性評估控制，模糊小波網路，非最小相系統。
Adaptive Critic Control of a Class of Non-Minimum
Phase Systems
Chuan-Kai Lin
R.O.C. Naval Academy, Taiwan, R.O.C.
Abstract
An adaptive critic tracking control design for a class of nonlinear non-minimum phase
systems using fuzzy wavelet networks (FWNs) is proposed in this paper. The adaptive critic
tracking control scheme, which consists of an associative search network (ASN), an adaptive
critic network (ACN), a state feedback controller, an FWN and a robust controller, is developed
to guarantee uniformly ultimate bounded tracking performance. The zero dynamics of the
nonlinear non-minimum phase systems are linearized and stabilized by the state feedback control.
The FWN is utilized to approximate unknown nonlinear functions, and a robust control technique
is employed to deal with the approximation errors and external disturbances. Furthermore, all
parameters of the FWN including centers and variances of fuzzy wavelet basis functions
(FWBFs), and FWBF-to-output weights can be tuned by on-line update laws. The closed-loop
system stability is guaranteed by the Lyapunov theorm extension. Experiments on a rotary
inverted pendulum system are provided to show the effectiveness of the proposed adaptive critic
tracking control scheme.
Index Terms - Adaptive critic control; Fuzzy wavelet network; Non-minimum phase system.
systems with nonminimum phase and the FWN are presented. The controller structure with
weight tuning algorithms and the stability analysis are addressed in section 3. In section 4, the
proposed FWN-based adaptive control scheme is applied to a rotary inverted pendulum system
for demonstrating the effectiveness. Finally, some conclusions are given in section 5.
2. Preliminaries
2.1. Nonlinear System Dynamics
Consider a class of nonlinear dynamic systems in the form:
( ) ( )( ( ) ( , ))f g u t t  x x x x
( )y h x , (1)
where ( 1) 1
Tn nx x x      x is the state vector; ( )f x and ( )g x are unknown and
smooth functions for every xBx , a ball in n centered at nx 0
(   10 0 0 T nn   0 ); u is the control; and the disturbance ( , )t x is bounded
by ( , )t M x . Assume the nonlinear system (1) has a relative degree r, defining as follows:
1 ( ) 0,kg fL L h
 x and 1 ( ) 0,rg fL L h x xB x , 1, 2, , 1k r  , (2)
where fL and gL denote the Lie derivatives with respect to f and g, repectively.. The reference
signal ry is generated by a smooth exosystem. Furthermore, assume that the gain
1 ( ) 0rg fL L h
 x and there exists a set of coordinate functions:
  ( 1) ( 1)1 2 1 2 TT r n rr n r y y y            , (3)
such that the nonlinear system (1) can be transformed into the following normal form:
1j j  , 1, 2, , 1j r 
 ( ) ( ) ( ) ( , )r u t t      x x x
1k k  , 1, 2, , 1k n r  
 ( ) ( ) ( ) ( , )n r u t t       x x x
1y  , (4)
where  1 2 Tr   ;  1 2 Tn r   ; T T T   x ; ( ) ( )rfL h x x ;
1( ) ( )rg fL L h x x is assumed to be bounded by ( ) 0M m   x with constants M 
and m
 ; ( ) 0g kL x , 1, 2, , 1k n r   ; ( ) ( )f n rL x x , and ( ) ( )g n rL x x
is assumed to be nonzero, i.e., ( ) 0 x . Denote 1  and 1  such that we can obtain the
following dynamics:
 ( ) ( ) ( ) ( ) ( , )r u t t     x x x , (5)
 ( ) ( ) ( ) ( ) ( , )n r u t t      x x x . (6)
Since ( )x is a bounded function, ( )x can be expressed as:
0( ) ( )   x x , (7)
where 0 0 is a known bias constant. Substituting (5) into (6) gets the internal dynamics:
( )
( ) ( )( ) ( )
( )
r
n r    

   xx x
x
. (8)
Specify  as r0 so that the zero dynamics can be written as follows:
      
( ) ,, ,
,r
rn r
r r
r
  



 
0
0
0 0
0
 

, (9)
where  ( ) ,  x ;  ( ) ,  x ;  ( ) ,  x ;  ( ) ,  x , and 1rr 0  is a
vector with all zero elements. The nonlinear system (1) is said to be non-minimum phase if the
zero dynamics are unstable.
2.2. Fuzzy wavelet network
where ( 1)
Tn r
des des des des       is the desired command of the internal dynamics.
Subtracting ( )rdes and ( )n rdes  from (5) and (8), the error dynamics can be obtained as:
 ( ) ( )( ) ( ) ( ) ( , )r rdesu t t        x x x , (17)
 ( ) ( ) ( ), ,n r r n rdesI       , (18)
where  
( )
( ) ( ), , ( ) ( )
( )
r
rI
   

   xx x
x
; ( ) ( ) ( )r r rdes    and ( ) ( ) ( )n r n r n rdes      . The
function  ( ), ,rI   can be expanded in a Taylor series:
   ( ) ( ) ( ) 1, , , ,r r T r Tdes des des rI I k R         k k      , (19)
where
( )( ) 1 21 2
1
, ,rr rr des desdes
T rI I I k k k       
  
     
         k    ;
( )( ) 1 21 2
( ) 1
, ,rr n rn r des desdes
T n rI I I k k k        
   
     
         k    ;
( ) ( )( ), ,
r rr
des desdes
I
rk   

   
 
  
, and 1R is the remainder term. Substituting (19) into (18) yields:
( ) ( )n r T T r
rk          k k  , (20)
where  ( ) ( ) 1, ,r n rdes des des desI R       is assumed to be bounded by M . Next, using
(ˆ )x to estimate the unknown function ( )x , we can obtain:
    ( ) ( )ˆ ( ) ( , )r rdesu t t              x x x x , (21)
where * ˆ( ) ( ) ( )   x x x . The control law is selected as:
( ) c ru t u u  , (22)
where   ( )1 (ˆ )
(ˆ )
T T r
c desu  
      
 x a b
x
  ; (ˆ ) x is the estimate of the unknown function
( ) x ; 1ra ; ( ) 1n r b , and ru is a robust control term to reject the external disturbances
and approximation errors.
Substituting (14) and (22) into (21) gets:
   ( ) ( ) ( ) ( ) ( ) ( ) ( , )r T T r cu u t t                  x a b x x x x  , (23)
where * ˆ( ) ( ) ( )   x x x is the estimation error. Next, substituting (23) into (20) yields:
 ( ) ( ) ( ) ( ) ( ) ( ) ( , )n r r r ck u u t t                 x x x x x
   T Tr rk k       k a k b  . (24)
Define a new error vector
TT T n     e   such that
 1 ( ) ( ) ( ) ( ) ( ) ( , )r cu u t t                e Ae b x x x x x , (25)
where 11 12
21 22
n n    
A AA
A A
; 11 2 3
T r r r r r
r
     A i i i a ; the unit vector 1k kj i
represents that the j-th element is 1 and the other elements are 0;
  ( )12T n r rn r n r n r      0 0 0 A b ;   ( )21T r n rr r r rk      0 0 0 A k a ;
  ( ) ( )22 2 3T n r n r n r n r n rn r rk          A i i i k b ; T T Te   k a b , and 11 n n nr r nk   b i i .
Furthermore, the vectors a and b are chosen in such a way that the eigenvalues of A are all
located in the open left half of the complex plane.
The adaptive critic control consists of two networks: adaptive critic networks (ACN) and
associative search network (ASN). In this paper, the two networks are implemented by FWNs.
The ASN, ˆ ˆ ˆˆ( ) ( , , )T x w x c  and 0ˆ ˆ ˆˆ( ) ( , , )T x + w x c  , determines the control behavior
  2ˆˆˆˆˆ ˆˆ ˆ TTCk r I      w www w   , (33)
  2ˆˆˆˆˆ ˆˆ ˆ
T
T
c Ck u r I
 

  
     
 w w
w
w w   , (34)
    2ˆˆ ˆ ˆˆˆˆ ˆˆ ˆˆ ˆ ˆˆ
T T T
C C c
C
T T T T
C C c c Ck u I

  
       
 w w C C c
w
w w w C C c
      , (35)
  2 ˆˆˆ ˆˆˆ ˆˆ ˆˆ
T
CT T
c Ck u I

    
     
 C ww w C w 

   , (36)
  2ˆˆ ˆˆˆ ˆˆ ˆˆ ˆ
T
c CT T
c c c C ck u I 
     
 cc C w
c
c w w C w  , (37)
where 0k , 0k , 0Ck  , 0k , 0ck  , I , I, CI , I , and cI are denoted as
follows:
    
  
ˆˆ ˆ ˆˆˆ0, if or and 0
ˆˆ ˆˆˆ1, if and 0
T T
W W C
T T
W C
M M r
I
M r
  

 
    
  
w w w w
w w w
 
 
, (38)
    
  
ˆˆ ˆ ˆˆˆ0, if or and 0
ˆˆ ˆˆˆ1, if and 0
T T
W W C
T T
W C
M M r
I
M r
  

 
    
  
w w w w
w w w
 
 
, (39)
      
    
ˆ ˆ ˆˆ ˆˆ ˆ ˆ ˆˆ0, if or and 0
ˆ ˆˆ ˆˆ ˆ ˆ ˆˆ1, if and 0
T T T T T
C W C W c C c
C T T T T T
C W c C c
M M r u
I
M r u
  
  
      
    
w w w w w C C c
w w w w C C c
   
   
,
(40)
    
  
ˆˆ ˆˆ ˆˆ ˆ ˆ0, if or and 0
ˆˆ ˆˆ ˆˆ ˆ1, if and 0
T T T
c C
T T T
c C
M M u
I
M u
    

   
    
  
w w C w
w w C w
    
   
, (41)
    
  
ˆ ˆ ˆˆ ˆˆ ˆˆ0, if or and 0
ˆ ˆˆ ˆˆ ˆˆ1, if and 0
T T T
c c c c C
c T T T
c c c C
M M u
I
M u
 
 
    
  
c c w w C w
c w w C w
  
  
. (42)
The parameters can be projected to the prescribed compact set due to the indicators I, I, CI ,
I , and cI . The following theorem is the main result of this paper.
Theorem 1. If the control law is chosen as (22) for the nonlinear non-minimum system (4) with
update laws (33)–(37) and a robust control term:
1ru k r , (43)
where 1k is a positive constant, then the tracking errors are uniformly ultimate bounded.
Proof. Define a Lyapunov functional candidate as follows:
  0 1 1 1 1 1ln cosh 2 2 2 2 2T T T T T Tr C CC c
M
V
k k k k k     
        k e w w w w w w c c , (44)
where 0k is chosen such that 0 1 0
T k b . Then, using (25), we can obtain:
    0 0 1tanh ( ) ( ) ( ) ( ) ( ) ( , )T Tr r cMV u u t t                 k e k Ae b x x x x x
1 1 1 1 1ˆ ˆ ˆ ˆˆT T T T TC C
C ck k k k k
   
  
          w w w w w w c c . (45)
Since the roots of the Hurwitz polynomial 0s  I A lie strictly in the open left half of the
complex plane, the equation  0 0T   k I A e can be obtained with a minimum positive
constant. According to 0 0T Tk Ae k e , 0 1 0T  k b and 0 2 1T k b , substituting (31) and (32)
into (45) yields
2212 1 2 2 1 2 2 1 2 2 2 22
2 2
2 2 2
cos sin 2 sinm l c m c m c g
m c J
   

  


  , (50)
where 1 is the angle of the arm; 2 is the angle of the pendulum; 1l is the length of the arm;
2l is the length of the pendulum; 1c is the length to arm’s center of mass; 2c is the length to
pendulum’s center of mass; 1 is the angular velocity of the arm; 2 is the angular velocity of
the pendulum; u is the applied torque; 1m is the mass of the arm; 2m is the mass of the
pendulum; 29.8m/sg is the acceleration due to gravity; 1J is the moment of arm inertia, and
2J is the moment of pendulum inertia. In this simulation, the parameters are specified as:
1. a=[106.6308 50.6496]T, b=[357.5696 16.6109] T, k0=[1 5111.34] T, 150rM  , k1=60.
2. n=4, p=20, 2.2k , 2.2k , 1.2k , 1.2ck  , 200M , 10cM  , 20WM  , and
0 1.25 .
The experimental system as shown in Fig. 1 consists of two parts: 1) rotary inverted
pendulum, and 2) personal computers: host PC, target PC, AD/DA cards and control programs.
The rotary inverted pendulum is manufactured by Terasoft Co., which requires two TI
TMS320F240-based AD/DA cards (Model no. MC240 from Terasoft Co.). The program of the
proposed controller written in C language in the Simulink model run on the host computer (Host
PC). The software including Matlab/Simulink software (Relaese 14) with Real-Time Workshop
and xPC Target Toolbox can generate stand-alone real-time applications from the Simulink
model in Host PC to run on the target PC. The Host PC communicates with the Target PC
through network connection under real-time operating system. The torque command with the
amplitude range 10V is also sent to the driver through the AD/DA card.
Fig. 1. Rotary inverted pendulum system.
The experiment results are shown in Fig. 2, which confirms that the FWN-based adaptive
critic control can regulate arm and pendulum angles to zero.
nonlinear systems via output feedback, IEEE Transactions on Automatic Control
45(10) (2000) 1817–1827.
[9] S. Devasia, D. Chen, B. Paden, Nonlinear inversion-based output tracking, IEEE
Trans. Automat. Contr. 41 (7) (1996) 930–942.
[10] S. Gopalswamy, J. K. Hedrick, Tracking nonlinear nonminimum phase systems
using sliding control, International Journal of Control 57(5) (1993) 1141–1158
[11] X. Y. Lu, S. K. Spurgeon, Control of nonlinear nonminimum phase systems
using dynamic sliding node, International Journal of Systems Science 30 (2)
(1999) 183–198.
[12] X. Wang, Z. Chen, Z. Yuan, Center-manifold-based sliding output tracking for
non-minimum nonlinear systems, International Journal of Systems Science 36
(4) (2005) 191–199.
[13] Y.H. Kim, F.L. Lewis, Reinforcement adaptive learning neural-net-based friction
compensation control for high speed and precision, IEEE Trans. Control Systems
Technology 8(1) (2000) 118–126.
[14] O. Kuljaca, F.L. Lewis, Adaptive critic design using nonlinear network structures,
International Journal of Adaptive Control and Signal Processing 17(6) (2003)
431–445.
[15] C.K. Lin, A reinforcement learning adaptive fuzzy controller for robots, Fuzzy Sets
and Systems 137 (3) (2003) 339–352
[16] S. Jagannathan, G. Galan, Adaptive critic neural network-based object grasping
control using a three-finger gripper, IEEE Trans. Neural Netw. 15(2) (2004)
395–407.
[17] C.K. Lin, Adaptive critic autopilot design of bank-to-turn missiles using fuzzy
basis function networks. IEEE Trans. Syst. Man Cybern., Part B 35 (2) (2005)
197–207.
[18] A.G. Barto, R.S. Sutton, W. Anderson, Neuronlike adaptive elements can solve
difficult learning control problems. IEEE Trans. Syst. Man Cybern. 13 (5) (1983)
834–846.
[19] C.C. Lee, A self-learning rule-based controller employing approximate reasoning
and neural net concepts, International Journal of Intelligent Systems 6 (1) (1991)
71–93.
[20] N. Hovakimyan, A.J. Calise, N. Kim, Adaptive output feedback control of a class
of multi-input multi-output systems using neural networks, Int. Control 17 (15)
(2004) 1318–1329.
[21] C.-K. Lin, “H reinforcement learning control of robot manipulators using fuzzy
wavelet networks,”Fuzzy Sets and Syst., vol. 160, no. 12, pp. 1765–1786, June
2009.
[22] S.-D. Wang, C.-K. Lin, Adaptive tuning of fuzzy controller for robots, Fuzzy Sets
and Systems 110(3) (2000) 351–363.
