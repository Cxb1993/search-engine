中文摘要 
本計畫之執行成果已達成主要之預期目標，從實務應用的角度，提出一個完整的
加速公開金鑰密碼系統對冗長訊息加解密安全機制，並能有效抵擋選擇密文攻
擊。使理論與現行社會環境能更相契合，本計畫蒐集並了解目前存在的混合式公
開金鑰加密系統的架構與流程細節，改善針對冗長訊息之加解密速度，相較於過
去的加解密系統，有效的大量提升其速度。所設計出的加解密系統具備的條件包
括演算法及其執行程序所需的運算量及複雜度非常簡單、密文的擴充率極少。實
務上評估度量為所能承受的安全威脅，已達到最高知安全等級－選擇密文攻擊。 
 
關鍵字：公開金鑰加密系統、非對稱型金鑰加密系統、對稱型金鑰加密系統、混
合式公開金鑰加密系統、群體導向密碼系統、可證明安全、隨機神諭、不可辨識
-適應性選擇密文攻擊 
 
英文摘要 
Public-key encryption schemes limit the plaintext space to a particular group, which 
can be restrictive when one wants to encrypt arbitrary message. In this project, an 
efficient conversion from the IND-CPA secure ElGamal encryption scheme to a 
IND-CCA2 secure extension of the ElGamal encryption scheme in the random oracle 
model is presented. In the encryption algorithm of the converted scheme, no matter 
what the length of plaintext space is, only two random numbers are generated for each 
encryption. The result of the converted version of the ElGamal encryption scheme not 
only provides a higher security level but also is more efficient in terms of 
computational complexity and ciphertext expansion than those of the ElGamal 
encryption scheme when encrypting a lengthy plaintext space. An analysis of the 
modified encryption scheme is given to demonstrate its enhanced security. The 
proposed scheme can be also used in the HPKE: KEM/DEM frameworks, make them 
more efficient. 
 
Keywords: asymmetric-key encryption, adaptive chosen-ciphertext attack, 
authenticated encryption, group-oriented cryptographic, hybrid public-key encryption, 
indistinguishablitity, reduction proof, symmetric-key encryption, provably secure, 
public-key encryption, random oracle. 
I 
the security, this scheme is said to be provably secure in the standard model. If
there is, this scheme is provably secure in the random oracle model. Although
security in the random oracle model cannot guaranteed formally when a prac-
tical random-like function (such as SHA-2 [21]) replaces the random oracle, an
random oracle-based technique for security proof is a useful test-bed. They
often outperform the standard model schemes in terms of eﬃciency.
Another special goal is plaintext-awareness (PA). A PKE scheme is PA if
for any ciphertext the adversary produces, she must know the corresponding
plaintext. The notation of PA was ﬁrst suggested by Bellare and Rogaway
[4], and then formalized by Bellare, Desai, Pointcheval and Rogaway [2]. The
diﬀerence is that the later gives the adversary the ability to obtain ciphertexts
via eavesdropping on communications made to the receiver. Bellare, Desai,
Pointcheval and Rogaway [2] proves the following result.
Proposition 1. PA−→IND-CCA2 (NM-CCA2) in the random oracle model.
That is, if a PKE scheme is secure in the PA sense, then it is secure in
the IND-CCA2 (or NM-CCA2) sense in the random oracle model. However, PA
as per [4, 2] is designed for the random oracle model and they leave an open
question as to whether a PA exists in the standard model. After that, Herzog
et al. [16] solved the question via a key registration method. Later, Bellare
and Palacio [3] introduced a new version of PA and removed the need for the
key registration authority in the standard model. Recently, Dent [10] proved
the Cramer-Shoup PKE scheme [7] is secure in the PA sense in the standard
model.
1.2 Relative Works
The pair of models, GOAL-ATK, represent a very important security notation
that captures the security level of PKE schemes. Tsiouns and Yung [30] ﬁrst
showed that IND-CPA of the ElGamal encryption is actually equivalent to the
Decisional Diﬃe-Hellman (DDH) problem. Until now, all proposed schemes [4,
7, 13, 14, 23, 24, 29, 30] strive toward the strongest security protocol IND-CCA2.
Fujisaki-Okamoto’s conversion [13] of probabilistic trap-door one-way func-
tions deserves to be mentioned. They proposed a method to convert existing
probabilistic trap-door one-way functions such as ElGamal, Blum-Goldwasser
[5], and Okamoto-Uchiyama [22] schemes by requiring only one additional ran-
dom function operation. Via Proposition 1, they proved that the converted
schemes are secure in the IND-CCA2 sense in the random oracle model. In all
schemes which meet IND-CCA2, Fujisaki-Okamoto’s scheme is more eﬃcient
than others without considering the hybrid public-key encryption scheme (We
will introduce it below).
However, no matter whether the PKE schemes are deterministic or proba-
bilistic. The plaintext space should be smaller than its group. For example, in
the RSA encryption scheme, the public key e is the exponent of the plaintext
x and x is smaller than the modulus N = p · q where p and q are large primes
(x < N).
y = xe mod N
We can see that each encryption needs one modular exponentiation. There is
no way to reduce the computational complexity.
The ElGamal encryption scheme provides a means of dealing with a plain-
text x that is larger the modulus p. Of course, it should be divided into several
smaller xi’s where each xi is less than p. Then each xi is fed into the encryption
algorithm one by one. For each xi, a random number must be generated as the
exponent of generator and the public key for each encryption. For x1, . . . , xn,
2
bit key size to meet the current demanded security level and provide lower
computational cost.
Hwang et al. [17] proposed an ElGamal-like PKE for encrypting a large
message without any one-time secure DEM. Though their scheme is designed
for encrypting a large message by directly applying ElGamal-like encryption,
we can combine the advantages of hybrid schemes with their scheme. That is,
their scheme is treated as a KEM to eﬃciently encrypt a large SKE key K varies
depending on the length of unrestricted message x and a MAC key mk in the
Cramer-Shoup framework, or treated as a Tag-KEM to encrypt a SKE key K
together with the message x in the Abe-Gennaro-Kurosawa-Shoup framework.
No matter what K is generated by a PRBG or stretched by the block cipher
method, since K is large enough, the one-time secure SKE in the DEM can
encrypt the whole message x as χ ← x ⊕ K. In both frameworks, when the
receiver decrypts the ciphertext of K and then she can directly decrypt the
message x as x ← χ⊕K without applying any PRBG or block cipher method.
Unfortunately, Hwang et al. didn’t give a formal security proof of their scheme.
1.3 Our Results
The extended version of the ElGamal encryption scheme, referred to as ElGamal-
extended, presented here has the following advantages.
• It is only necessary to generate two random numbers. The total number
of modular exponentiations is 4/2 in the encryption/decryption, which
is not be increased by the number of xi’s. Only some low computational
complexity operations such as random function operations and modular
multiplications are needed.
• The ciphtertext expansion is smaller when the plaintext is large enough.
• It is secure in the IND-CCA2 sense, which provides a higher security level
than that of IND-CPA achieved by the ElGamal encryption scheme.
Combining the above advantages, the ElGamal-extended encryption scheme
can be a CCA2-secure KEM in the HPKE: KEM/DEM frameworks [1, 8] which
applications will be presented in Section 6. Furthermore, it is trivial to con-
struct a elliptic curve version of ElGamal-extended encryption scheme. We
omit the construction in this paper.
To demonstrate that the ElGamal-extended scheme is secure using only two
random numbers, a new pair GOAL and ATK is constructed called IND-CPAPAIR.
The diﬀerence from IND-CPA is that, we also provide the adversary with the
knowledge of a pair of plaintext-ciphertext from the encryption oracle. Intu-
itively, this pair does not provide any help for the adversary, since the adversary
has ability to generate any pair she wants by herself in the PKE scheme. This
is the reﬁnement presented here and its purpose is explained later.
1.4 Outline of the Paper
The remainder of our paper is organized as follows. In Section 2, we shall
give some basic deﬁnitions about encryption scheme security. In Section 3, we
shall give a brief review of the ElGmal encryption scheme. At the same time,
the ElGamal-extended encryption scheme is presented. In Section 4, we shall
ﬁrst prove the ElGamal-extended encryption scheme is secure in the IND-CCA2
sense via Proposition 1 when the plaintext is smaller than its group. Then the
reﬁnement of IND-CPAPAIR is explained and, at the same time, we prove the
the ElGamal-extended encryption scheme is secure in the IND-CPAPAIR sense,
4
Deﬁnition 5 (Random Oracle Model). Let Ω be the set of all maps from
the set {0, 1}∗ of finite strings to the set {0, 1}∞ of infinite strings. H ← Ω
denotes as we chose map H from a set of an appropriate finite length {0, 1}a to
a set of an appropriate finite length of {0, 1}b, from Ω at random and uniformly,
restricting the domain to {0, 1}a and the range to the first b bits of output. By
the assumption made in the random oracle model, for fix x ∈ {0, 1}a and
y ∈ {0, 1}b, then Pr[H(x) = y] = 1
2b
. PKE = (Gen,EncH,DecH) denotes the
Enc and Dec in public-key scheme are allowed to access such identical map H,
and we call this encryption scheme is defined in the random oracle model.
Deﬁnition 6 (IND-ATK). Let A = (A1,A2) be a pair of probabilistic algo-
rithms for adversary, PKE = (Gen,Enc,Dec). For ATK={CPA, CCA1, CCA2}
and κ ∈ N, denote the success event of A for PKE by
SuccIND−ATKA,PKE (κ) = [(pk, sk)← Gen(1κ); (x0, x1, ω)← AO11 (pk); b←R {0, 1};
y ← Encpk(xb) : AO22 (x0, x1, ω, y) = b],
where the first two components of a triple (x0, x1, ω) are the plaintexts with the
same length |x0| = |x1|, and the last is state information (including the public
key pk) and some information to be preserved. Here, O1(·),O2(·) are defined
as follows:
- If ATK=CPA then O1(·)=null and O2(·)=null;
- If ATK=CCA1 then O1(·) = Decsk(·) and O2(·)=null;
- If ATK=CCA2 then O1(·) = Decsk(·) and O2(·) = Decsk(·).
In the case of CCA2, we insist that A2 does not ask its oracle to decrypt y.
The advantage of A for PKE is denoted as
AdvIND−ATKA,PKE (κ) = 2 · Pr[SuccIND−ATKA,PKE (κ)]− 1.
We say that PKE is secure in the IND-ATK sense if for any adversary A being
polynomial-time in κ, AdvIND−ATKA,PKE (κ) is negligible in κ.
Deﬁnition 7 (PA). Let PKE = (Gen,Enc,Dec) be a public-key encryption
scheme, let B be an adversary, let P be an polynomial-time plaintext extractor.
For any κ ∈ N define
SuccPAP,B,PKE(κ) = Pr[H ← Ω; (pk, sk) ← Gen(1κ); (hH,C, y)← run BH,Enc
H
pk(pk) :
P(hH,C, y, pk) = DecHsk(y)],
where hH = {(h1, H1), . . . , (hqH , HqH)}, C = {y1, . . . , yqE}, and y ∈ C.
(hH,C, y) ← run BH,EncHpk(pk) denotes run B on input pk, oracles H, and
EncHpk, recording B’s interaction with its oracles. hH denotes the set of all B’s
queries and the corresponding answers of H. C denotes the set of all answers
received as the result of EncHpk. Here, C does not include the the corresponding
queries from B. Finally, B outputs y.
We say that P is a (t, λ(κ))-plaintext extractor if SuccPAP,B,PKE(κ) ≥ λ(κ)
and P runs within at most running time t.
We say that PKE is secure in the sense of PA if PKE is secure in the
sense of IND-CPA and there exists a (t, λ(κ))-plaintext extractor P where t is
polynomial in κ and λ(κ) is overwhelming in κ.
6
- Hash functions H and J :
H : {0, 1}κ0+2κ1 → {0, 1}ι, J : {0, 1}κ → {0, 1}κ.
- Encryption algorithm PKE.Enc:
A large plaintext x is divided into x1, x2, · · · , xn subtexts.
(y′1, y
′
2, y
′
3,i) = Encpk(xi, r1, r2),
1. Concatenate Xi = xi||r1||r2, where xi ∈ {0, 1}κ0, r1, r2 ∈R {0, 1}κ1 ∈
Zq, and || denotes concatenation.
2. Compute Ji = J(i · Y r2 mod p).
3. Compute (y1, y3,i) = Enc
†
pk(Xi||H(Xi), r1) = (gr1 mod p, (Xi||H(Xi))·
Y r1 mod p).
4. Compute (y′1, y
′
2, y
′
3,i) = (y1, g
r2 mod p, y3,i · Ji mod p).
- Decryption algorithm PKE.Dec:
xi = Decsk(y
′
1, y
′
2, y
′
3,i),
1. Compute Ji = J(i · y′s2 mod p).
2. Compute Wi = Dec
†
sk(y
′
1, y
′
3,i · J−1i mod p).
3. Output {
[Wi]
κ0, if H([Wi]
κ0+2κ1) = [Wi]ι
null, otherwise
The notations of [Wi]
a and [Wi]b denote the ﬁrst a-bit and the last
b-bit of Wi, respectively
Finally, the whole plaintext x can be concatenated as x1|| · · · ||xn.
To understand what the ElGamal-extended encryption scheme can achieve
consider the following. The ElGamal encryption scheme is long and involved
and there is an additional random value Ji for each xi. Even if there are
only two random numbers r1 and r2, the hash value Ji still makes the en-
cryption scheme probabilistic. If the adversary can obtain the hash value
J(i ·Y r2 mod p), she is still faced with the of breaking the ElGamal encryption
scheme, i.e. Decsk(y
′
1, y
′
3,i · J−1i mod p) = Wi. It already knows the ElGamal
encryption scheme is IND-CPA secure [30] under the DDH assumption, in which
the adversary cannot obtain any bit about the plaintext Wi = Xi||H(Xi).
Furthermore, to compute the hash value Ji = J(i · gsr2 mod p) with the
knowledge of the public key Y = gs mod p and the value y′2 = g
r2 mod p
is equivalent to solve the CDH assumption in Deﬁnition 2, which is weaker
than the DDH assumption in the same group [27]. If the DDH assumption
is held in the group, then the CDH assumption must be held in that group.
Therefore, the security of the proposed scheme can be solely based on the DDH
assumption.
To reveal other plaintext xj ’s, the adversary cannot compute Jj (∀j = i)
under the assumption of hash function J(·), since the values of Ji and Jj are
nonlinearly related. To meet IND-CCA2, the plaintext xi is protected under
the hash function H(·) to ensure the data integrity and has a data integrity
validating step in the decryption algorithm. Without this validating step,
the adversary could trivially generate ciphertext for which the corresponding
plaintext is unknown. To do this, she just outputs the random strings. In the
next section, we give the analyses of the reduction for proving its securities.
8
Then, the ciphertexts (y∗1, y
∗
3) = PKE
†.Enc†pk(x
∗, r) and (y1, y3) = Enc
†
pk(xb, r)
computed by the encryption oracle Oen, where b ∈ {0, 1} is a random bit and
r ∈ Zq is a random string.
Encryption oracle: Oen(x∗, x0, x1, pk)
r ←R Zq
(y∗1, y
∗
3) ← PKE†.Enc†pk(x∗, r)
b ←R {0, 1}
(y1, y3) ← PKE†.Enc†pk(xb, r)
Return (x∗  (y∗1, y∗3), (y1, y3))
End.
Finally, (x0, x1, ω, x
∗  (y∗1, y∗3), (y1, y3)) are inputted to A2. The aim ofA2 is to output the correct b.
Adversary: A2(x0, x1, ω, x∗  (y∗1, y∗3), (y1, y3))
Y r ← y∗3 · (x∗)−1 mod p
If y3 · (Y r)−1 mod p == x0
Return 0
Else
Return 1
End.
From the speciﬁcation ofA2, since y∗3 = x∗ ·Y r mod p and x∗  (y∗1, y∗3), the
value of Y r is easily revealed by computing y∗3 · (x∗)−1 mod p. Then, since y3 =
xb ·Y r mod p, A2 can determine if y3 · (Y r)−1 mod p is equal to x0. If it is then
outputs 0 otherwise output 1. Thus, A2 always correctly outputs b, that is,
Pr[SuccIND−CPAPAIRA,PKE† (κ)] = 1 and Adv
IND−CPAPAIR
A,PKE† (κ) = 2 · Pr[Succ
IND−CPAPAIR
A,PKE† (κ)]−
1 = 1.
The pair of plaintext-ciphertext x∗  (y∗1, y∗3) is the “cryptanalysis train-
ing” for the adversary. Here, the reason for giving the pair x∗  (y∗1, y∗3) fromOen not generated by the adversary herself is that the adversary cannot gen-
erate the pair x∗  (y∗1, y∗3) using the same random number r. The adversary
also can query its decryption oracle in the IND-CCA or IND-CCA2 sense to
obtain ciphertext-plaintext pairs. However, those queries still cannot capture
the value Y r that the encryption oracle uses to encrypt xb. Hence, the training
is provided by the encryption oracle rather than the decryption oracle.
Obviously, if the encryption oracle chooses a diﬀerent r, this training does
not give any help to the adversary and the scheme is secure in the IND-CPAPAIR
sense. In the following theorem, we show only two random numbers r1, r2 in
the ElGamal-extended encryption scheme is secure in the IND-CPAPAIR sense.
Theorem 4 (PKE: IND-CPAPAIR). If there exists a (t, qH , qJ , )-breaker A =
(A1,A2) for PKE in the IND-CPAPAIR sense in the random oracle model and
the probability Pr[¬SuccPAIRA,PKE(κ)] is non-negligible, then there exists a constant
c and a (t′, 0, 0, ′)-breaker A′ = (A′1,A′2) for PKE† in the IND-CPA sense in
the standard model, where
t′ = t + qH · c + qJ · c and ′ = (− qH
22κ1−2
) · Pr[¬SuccPAIRA,PKE(κ)]− Pr[SuccPAIRA,PKE(κ)].
Proof. The event SuccPAIRA,PKE(κ) will be deﬁned later. Basically, A′1 calls A1 as
a subroutine. The answers for H-query and J-query are the same as in Theo-
rem 2. WhenA1 halts and outputs (x∗, x0, x1, ω),A′1 outputs (x0||γ0||β0, x1||γ1||β1, ω)
10
Adversary: A′2(x0||γ0||β0, x1||γ1||β1, ω, (y1, y3))
r2 ←R Zq; J∗ ←R {0, 1}κ
y∗1, y
′
1 ← y1; y∗2, y′2 ← gr2 mod p; y′3 ← y3 · J∗ mod p
α ←R {0, 1}κ; y∗3 ← α
Run A2(x0, x1, x∗  (y∗1, y∗2, y∗3), ω, (y′1, y′2, y′3))
Do while A2 does not make H-query h and J-query j
Askj ←false
If A2 makes J-query j
If j = 2 · Y r2 mod p
Answer J∗ to A2
Put (j, J∗) on jJ
Askj ←true
Else if j ∈ jJ
J ←R {0, 1}κ
Answer J to A2
Else j ∈ jJ
Answer J to A2 such that (j, J) ∈ jJ
Else if A2 makes H-query h
If Askj =true and h = xb||γb
Stop A2 and output b
Else if h ∈ hH
H ←R {0, 1}ι
Put (h,H) on hH
Answer H to A2
Else h ∈ hH
Answer H to A2 such that (h,H) ∈ hH
A2 outputs b
Return b
End.
From the speciﬁcation of A′2, it simulates the encryption oracle Oen to
generate a pair x∗  (y∗1, y∗2, y∗3) for the cryptanalysis training. If A2 detects
that pair is not valid, the simulation fails. Thus, A′2 cannot make full use of the
A2’s ability to get non-negligible advantage. Let SuccPAIRA,PKE be the event thatA2
detects that pair is not valid. We can rewrite the probability of SuccIND−CPAA′,PKE† (κ)
in the inequality (A.3) as the conditional probability of SuccIND−CPAA′,PKE† (κ) given
¬SuccIND−CPAA′,PKE† (κ).
Pr[SuccIND−CPAA′,PKE† (κ)|¬SuccPAIRA,PKE(κ)] ≥
 + 1
2
− qH
22κ1−1
. (1)
By the law of total probability,
Pr[SuccIND−CPAA′,PKE† (κ)] = Pr[Succ
IND−CPA
A′,PKE† (κ)|SuccPAIRA,PKE(κ)] · Pr[SuccPAIRA,PKE(κ)] +
Pr[SuccIND−CPAA′,PKE† (κ)|¬SuccPAIRA,PKE(κ)] · Pr[¬SuccPAIRA,PKE(κ)].
From the speciﬁcation of A′, we know that
Pr[SuccIND−CPAA′,PKE† (κ)|SuccPAIRA,PKE(κ)] = 0 (2)
12
The following theorem shows that PAIR in the PKE† is at least as hard as the
DDH problem.
Theorem 5 (PAIR of PKE† at least as hard as the DDH). If there exists a
(t, )-breaker A′ = (A′1,A′2) for PKE† in the PAIR sense in the standard model,
then there exists constants c and a (t′, ′)-breaker T solves the DDH problem
with overwhelming probability, where
′ >  and t′ = t + c.
c denotes the time of a coin flipping and some over head.
Proof. We construct a translator T to solve an instance (g,X, Y, Z) of the
DDH problem in Deﬁnition 2 as follows.
Translator: T (g,X, Y, Z)
Run A′1(pk)
A′1 outputs x∗
c0 ← x∗ · Z
c1 ←R {0, 1}κ
b ←R {0, 1}
Output 1 if A′2(x∗  (X, cb), ω) =Yes
End.
Let p1 = Pr[T (g, gr, gs, grs) = 1] and p2 = Pr[T (g, gr, gs, gz) = 1]. By the
assumption of A′, p1 ≥ 1
2
+

2
. If z ←R Zq, x∗ · gz and c1 are both uniformly
distributed over Zp, then we have p2 =
1
2
. Thus, T solves the DDH problem
with advantage
′
2
= |p1− p2| > 
2
. From the speciﬁcation of T , it runs within
time t + c.
Diﬀerent from IND-CPA, IND-CPAPAIR additionally provides a plaintext-
ciphertext for cryptanalysis training. One can well know that the following
proposition.
Proposition 2. IND-CPAPAIR−→IND-CPA.
That is, if a public-key encryption scheme is secure in the IND-CPAPAIR
sense, then it is secure in the IND-CPA in the standard model (or random
oracle model). Obviously, we can construct a plaintext extractor P to extract
a correct plaintext xi from any ciphertext using the same r1, r2 in Theorem 1.
By the Proposition 1 and Proposition 2, we can know that ElGamal-extended
scheme using r1 and r2 for a large plaintext space is secure in the IND-CCA2
sense in the random oracle model.
5 Performance Analysis
In this section, we shall compare the computational complexity and ciphertext
size of the ElGamal-extended encryption scheme with those of the ElGamal
encryption scheme and Fujisaki-Okamoto’s conversion of the ElGamal encryp-
tion scheme [13]. We ﬁrst deﬁne the following notations.
14
T
ab
le
1:
C
om
p
u
ta
ti
on
al
co
m
p
le
x
it
y,
ci
p
h
er
te
x
t
ex
p
an
si
on
am
on
g
th
re
e
en
cr
y
p
ti
on
sc
h
em
es
E
n
cr
y
p
ti
on
D
ec
ry
p
ti
on
C
ip
h
er
te
x
t
ex
p
an
si
on
G
O
A
L
-A
T
K
E
lG
am
al
sc
h
em
e
n
·(
2T
E
X
P
+
T
M
U
L
)
n
·(
T
E
X
P
+
T
M
U
L
+
T
IN
V
)
2
IN
D
-C
P
A
F
u
ji
sa
k
i-
O
ka
m
ot
o
sc
h
em
e
n
′′
·(
2T
E
X
P
+
T
M
U
L
+
T
J
)
n
′′
·(
T
E
X
P
+
T
M
U
L
+
T
IN
V
2
·(
1
+

κ
1
κ
0
+
κ
1
+
ι
)
IN
D
-C
C
A
2
+
T
J
+
T
E
Q
U
)
E
lG
am
al
-e
x
te
n
d
ed
sc
h
em
e
2T
E
X
P
+
n
′ ·
(3
T
M
U
L
+
T
H
+
T
J
)
2T
E
X
P
+
n
′ ·
(3
T
M
U
L
+
T
H
2 n
+
1
+

κ
1
κ
0
+
κ
1
+
ι
IN
D
-C
C
A
2
+
T
J
+
T
IN
V
+
T
E
Q
U
)
∗
w
it
h
th
e
sa
m
e
si
ze
n
·κ
of
a
p
la
in
te
x
t
x
,
n
′ =
n
+
n
·(
2κ
1
+
ι)
κ
0
,
n
′′
=
n
+

n
·κ
0
κ
0
+
κ
1
+
ι
.
16
be compressed by a collision-free hash function or K||x is divided into several
smaller blocks to conform the space restriction, and then each block is fed
into the encryption algorithm one by one. Our proposed PKE scheme gets the
advantages in this situation, not only G is removed in the HPKEAGKS.Dec but
also the PKE.Enc encrypts a lengthy K||x eﬃciently.
7 Conclusions
In this paper, we have proposed an eﬃcient ElGamal-extended encryption
scheme and showed it is secure in the IND-CCA2 sense in the random oracle
model. Not only does the proposed scheme provides higher secure level, but
also the computational complexities of encryption and decryption in the pro-
posed scheme are more eﬃcient than those in the ElGamal encryption scheme
and Fujisaki-Okamoto’s scheme when the plaintext is large enough. On the
other hand, the ElGamal-extended scheme can be used as a KEM for encrypt-
ing a large DEM key (or together with the message) in the HPKE: KEM/DEM
frameworks. Since a DEM key is large enough, the decryption of HPKE can
remove the use of a pseudo-random bit generator or a block cipher method
from a smaller DEM key.
References
[1] M. Abe, R. Gennaro, K. Kurosawa, and V. Shoup, “Tag-KEM/DEM: A
new framewrok for hybrid encryption and a new analysis of Kurosawa-
Desmedt KEM,” in Advances in Cryptology, EUROCRYPT’05, pp. 128–
146, Lecture Notes in Computer Science 3494, 2005.
[2] M. Bellare, A. Desai, D. Pointcheval, and P. Rogaway, “Relations among
notations of security for public-key encryption schemes,” in Advances in
Cryptology, CRYPTO’98, pp. 26–45, Lecture Notes in Computer Science
1462, 1998.
[3] M. Bellare and A. Palacio, “Towards plaintext-aware public-key en-
cryption without random oracles,” in Advances in Cryptology, ASI-
ACRYPT’04, pp. 48–62, Lecture Notes in Computer Science 3329, 1998.
[4] M. Bellare and P. Rogaway, “Optimal asymmetric encryption,” in Ad-
vances in Cryptology, EUROCRYPT’94, pp. 92–111, Lecture Notes in
Computer Science 950, 1994.
[5] M. Blum and S. Goldwasser, “An eﬃcient probabilistic public-key encryp-
tion scheme which hides all partial information,” in Advances in Cryptol-
ogy, CRYPTO’84, pp. 289–299, Lecture Notes in Computer Science 196,
1984.
[6] J. S. Coron, H. Handschuh, M. Joye, P. Pailier, D. Pointcheval, and C. Ty-
men, “Optimal chosen-ciphertext secure encryption of arbitrary-length
messages,” in PKC 2002, pp. 17–33, Lecture Notes in Computer Science
2274, 2002.
[7] R. Cramer and V. Shoup, “A practical public key cryptosystem provably
secure against adaptive chosen ciphertext attack,” in Advances in Cryp-
tology, CRYPTO’98, pp. 13–25, Lecture Notes in Computer Science 1462,
1998.
18
[23] P. Paillier and David Pointcheval, “Eﬃcient public-key cryptosystems
provaly secure against active adversaries,” in Advances in Cryptology,
ASIACRYPT’99, pp. 165–179, Lecture Notes in Computer Science 1716,
1999.
[24] D. Pointcheval, “New public key cryptosystems based on the dependent-
RSA problems,” in Advances in Cryptology, EUROCRYPT’99, pp. 239–
254, Lecture Notes in Computer Science 1592, 1999.
[25] C. Rackoﬀ and D. Simon, “Non-interactive zero-knowledge proof of
knowledge and chosen ciphertext attack,” in Advances in Cryptology,
CRYPTO’91, pp. 433–444, Lecture Notes in Computer Science 576, 1991.
[26] R. L. Rivest, A. Shamir, and L. Adleman, “A method for obtaining digital
signatures and public key cryptosystems,” Communications of the ACM,
vol. 21, pp. 120–126, Feb. 1978.
[27] V. Shoup, “Lower bounds for discrete logarithms and related problems,”
in Advances in Cryptology, EUROCRYPT’97, pp. 256–266, Lecture Notes
in Computer Science 1233, 1997.
[28] V. Shoup, “ISO 18033-2: An emerging standard for public-key encryption
(committee draft),” Abaiable at http://shoup.net/iso, June 3 2004.
[29] V. Shoup and R. Gennaro, “Securing threhshold cryptosystem against
chosen ciphertext attack,” in Advances in Cryptology, EUROCRYPT’98,
pp. 1–16, Lecture Notes in Computer Science 1403, 1998.
[30] Y. Tsiounis and M. Yung, “On the security of ElGamal based encryption,”
in PKC’98, pp. 117–134, Lecture Notes in Computer Science, 1998.
20
Deﬁnition 5, the probability of such Ju is 2
−κ. The conditional probability
Pr[Con1|¬Con2] is qJ · 2−κ.
For Pr[Fail|¬Con1], ¬Con1 is true and P outputs null. That is, it guesses
(y′1, y
′
2, y
′
3) is a invalid ciphertext. Therefore, Fail is true implies B outputs the
valid ciphertext (y′1, y
′
2, y
′
3). For a ﬁxed (y
′
1, y
′
2, y
′
3) and J = J(Y
[[hv]2κ1 ]κ1 mod
p), let Hs be the set of (h,Hv) such that (y
′
1, y
′
3·J−1 mod p) = PKE†.Enc†pk(h||Hv,
[[h]2κ1 ]
κ1). Then since (y′1, y
′
2, y
′
3) ∈ C = {(y′1, y′2, y′3)1, · · · , (y′1, y′2, y′3)qE} and
hence PKE†.Dec†sk((y
′
1, y
′
3 · J−1 mod p)i) = h||H(h) for every (y′1, y′2, y′3)i ∈ C.
For a ﬁxed (y′1, y
′
2, y
′
3) and a ﬁxed h, since B doesn’t ask query h to oracle H(·),
Pr[Fail|¬Con1] = Pr
H←Ω
[H(h) ∈ Hs] = |Hs| · 2−ι,
where |Hs| denotes the number of pairs in Hs. Obviously, |Hs| is small.
We conclude that Pr[Fail] ≤ qJ ·2−κ+|Hs|·2−ι. Hence, λ(κ) = 1−Pr[Fail] =
1− (qJ · 2−κ + |Hs| · 2−ι).
A.2 Proof of Theorem 2
Proof. We construct a breaking algorithm A′ = (A′1,A′2) in the IND-CPA and
standard model setting by using A = (A1,A2) as an oracle.
Firstly, A′ initiates two lists hH and jJ , to empty. Basically, when A asks
query h and j, A′ simulates two random oracles H(·) and J(·) as follows: If h
has not been asked in the list hH , A′ provides a random string H of length ι-
bit, and adds an entry (h,H) to the list hH . Similarly, if j has not been asked
in the list jJ , A′ provides a random string J of length κ-bit, and adds an
entry (j, J) to the list jJ . When A1 halts and outputs (x0, x1, ω), A′1 outputs
(x0||γ0||β0, x1||γ1||β1, ω) where γ0, γ1 are (2κ1)-bit random strings and β0, β1
are ι-bit random strings.
22
Adversary: A′2(x0||γ0||β0, x1||γ1||β1, ω, (y1, y3))
r2 ←R Zq; J∗ ←R {0, 1}κ
y′1 ← y1; y′2 ← gr2 mod p; y′3 ← y3 · J∗ mod p
Run A2(x0, x1, ω, (y′1, y′2, y′3))
Do while A2 does not make H-query h and J-query j
Askj ←false
If A2 makes J-query j
If j = Y r2 mod p
Answer J∗ to A2
Put (j, J∗) on jJ
Askj ←true
Else if j ∈ jJ
J ←R {0, 1}κ
Answer J to A2
Else j ∈ jJ
Answer J to A2 such that (j, J) ∈ jJ
Else if A2 makes H-query h
If Askj =true and h = xb||γb
Stop A2 and output b
Else if h ∈ hH
H ←R {0, 1}ι
Put (h,H) on hH
Answer H to A2
Else h ∈ hH
Answer H to A2 such that (h,H) ∈ hH
A2 outputs b
Return b
End.
The argument behind the proof is as follows: When A2 asks the query
j = Y r2 mod p, A′2 answers J∗ and Askj is set be true. Since the random
string r2 is chosen by A′2, it has the ability to check whether the query j is
equal to Y r2 mod p or not. Once Askj is true and A2 asks a query h = xb||γb, it
is almost equivalent to PKE†.Dec†sk(y1, y3) = PKE
†.Dec†sk(y
′
1, y
′
3 · (J∗)−1 mod p),
since A2 has no clue to γb¯ where b¯ is the complement of bit b. The probability
to ask h = xb¯||γb¯ is 2−(2κ1) which is negligible. Under the condition Askj=true,A′2 can expect that it will output a correct bit b if A2 asks either h = x0||γ0
or h = x1||γ1. If A2 asks neither of them, A′2 can expect that A2 cannot
distinguish (y′1, y
′
2, y
′
3) from a correct ciphertext.
To analyze the success probability ofA′ = (A′1,A′2), we recall the deﬁnitions
of success probabilities of A′ = (A′1,A′2) and A = (A1,A2) in Deﬁnition 6.
Consider the follows events to capture the success probabilities ofA = (A1,A2)
and A′ = (A′1,A′2)
Askj: is true if a J-query j = Y r2 mod p was made by A2.
Askb: is true if a H-query h = xb||γb was made by A2.
Askb¯: is true if a H-query h = xb¯||γb¯ was made by A2.
The probability of SuccIND−CPAA′,PKE† (κ) can be obtained by considering the con-
24
A.3 Proof of Theorem 3
Proof. From the result of Theorem 3, it is found out that the encryption scheme
PKE is secure in the IND-CCA2. The proof is omitted since it is clear from the
following speciﬁcation of adversary A′ combined with the proofs in Theorem 1
and Theorem 2.
Adversary: A′1(pk)
hH , jJ←empty
Run ADec
†
sk,H,J
1 (pk)
Do while A1 does not make H-query h, J-query j,
D-query (y1, y2, y3)
′
If A1 makes J-query j
If j ∈ jJ
J ←R {0, 1}κ
Put (j, J) on jJ
Answer J to A1
Else j ∈ jJ
Answer J to A1 such that (j, J) ∈ jJ
Else if A1 makes H-query h
If h ∈ hH
H ←R {0, 1}ι
Put (h,H) on hH
Answer H to A1
Else h ∈ hH
Answer H to A1 such that (h,H) ∈ hH
Else if A1 makes D-query (y1, y2, y3)′
Run P(hH, jJ, C, (y1, y2, y3)′, pk)
P outputs x′
Answer x′ to A1
A1 outputs (x0, x1, ω)
γ0, γ1 ←R {0, 1}2κ1
β0, β1 ←R {0, 1}ι
Return (x0||γ0||β0, x1||γ1||β1, ω)
End.
Encryption oracle: Oen(x0||γ0||β0, x1||γ1||β1, pk)
b ←R {0, 1}
(y1, y3)← PKE†.Enc†pk(xb||γb||βb, R)
Return (y1, y3)
End.
26
計畫成果自評 
本計畫之執行成果已達成主要之預期目標，從實務應用的角度，提出一個完整的
加速公開金鑰密碼系統對冗長訊息加解密安全機制，並能有效抵擋選擇密文攻
擊。使理論與現行社會環境能更相契合，本計畫蒐集並了解目前存在的混合式公
開金鑰加密系統的架構與流程細節，改善針對冗長訊息之加解密速度，相較於過
去的加解密系統，有效的大量提升其速度。所設計出的加解密系統具備的條件包
括演算法及其執行程序所需的運算量及複雜度非常簡單、密文的擴充率極少。實
務上評估度量為所能承受的安全威脅，已達到最高知安全等級－選擇密文攻擊。 
自評項目 自評內容 
研究內容與原計畫相符程度 本研究的內容與原計畫完全相符。在原計
劃中我們針對傳統公開金鑰加解密速度
之提升，希望提出一個新的公開金鑰加密
系統演算法，可以達成本計劃之目的。而
本研究所提出的ElGamal-Extended，是一
個可以適用於混合式加解密的機制。配合
對稱式密碼系統，有效的加密冗長訊息，
其密文擴充率也達到其水準。另外，在系
統安全性方面，亦達到最高安全等級，抵
擋選擇密文攻擊。 
達成預期目標情況 改善針對冗長訊息之加解密速度及改善
密文的擴充率，其結果如Table 1所示。 
研究成果之學術或應用價值 本研究成果之學術價值在於對加解密安
全、運算複雜度及密文擴充率的研究上，
使用雜湊函數，特別對冗長訊息的加解
密，可大量降低加解密計算的指數運算。
而其應用價值在於冗長資料，如影像、語
音等資料，因此非常適合實際的應用，可
以大量生產，降低成本。 
是否適合在學術期刊發表或申請專利 適合在學術期刊發表。 
主要發現或其他有關價值等 本研究最主要的發現乃是針對在冗長訊
息，加速加解密過程，達到機密性、訊息
完整性。研究過程中發現，Hwang等人及
Zhao等人所提的方法具有安全上的疑
慮，並將結果投稿至國際期刊及IJICIC接
收。另外，本計劃發展之系統，可簡單延
伸至可轉換多重認證加密系統，其成果已
刊登在期刊Information Sciences。 
28 
Keywords:
reviewing the concepts of group-oriented encryption schemes and the merits of Wu
RSA
ipien
ature
Since themessagemust be recovered from the ciphertext, the hash function cannot be used for reducing the size of themes-
sage. If the message is large, the message should be divided into sequence message blocks, with each message individually
signed and encrypted as an authenticated ciphertext block. To efﬁciently generate authenticated ciphertext blocks
containing a large message, Zheng [33] proposed another scheme called signcryption. It employs both asymmetric and
0020-0255/$ - see front matter  2008 Elsevier Inc. All rights reserved.
q This research was partially supported by the National Science Council, Taiwan, ROC, under contract no.: NSC96-2218-E-018-002.
* Fax: +886 4 7211290.
E-mail address: tychang@cc.ncue.edu.tw
Information Sciences 178 (2008) 3426–3434
Contents lists available at ScienceDirect
Information Sciencesdoi:10.1016/j.ins.2008.05.008of the associated message (unforgeability). Furthermore, in order to protect the conﬁdentiality of the message, Authenticated
Encryption (AE) schemes are proposed, which allow a message transmission to conﬁdential as well as authenticated. In these
schemes, a signer generates an authenticated ciphertext signature on the chosen message so that only a designed veriﬁer can
recover and verify the message from the signature. Fundamentally, the AE schemes should satisfy the secure requirements of
unforgeability, conﬁdentiality, and non-repudiation.
Nyberg and Rueppel [20] ﬁrst proposed a signature scheme with message recovery based on the Discrete Logarithm (DL)
problem. In their scheme, the original message does not need to be sent, and any veriﬁer can recover the message from the
signature. Combining the ElGamal encryption scheme with the signature scheme plus message recovery can satisfy the
requirements of AE schemes. Following this ﬁrst proposal, a number of AE schemes and explanations have been proposed
to further reduce the computation and communication costs [9,12,14,21,30,31].Authenticated Encryption
Cryptography
Difﬁe–Hellman problem
Group-oriented encryption
Message recovery signature
Multi-signature
1. Introduction
Digital signature schemes such as
using a secret (private) key. Any rec
signer’s public key. To be exact, signet al.’s scheme. This shows that not only can a multi-authenticated ciphertext signature
be generated by a signing group, but also the message can be recovered and veriﬁed by
a verifying group with multiple veriﬁers. The security of the proposed scheme is based
solely on the DDH problem, which provides higher security conﬁdence than using the
CDH problem in Wu et al.’s CMAE scheme.
 2008 Elsevier Inc. All rights reserved.
[23] and DSA [19] allow a signer to generate a signature on a chosen message by
t can be a veriﬁer to verify the signature together with the message by using the
schemes are used to ensure the authenticity, and prevent forgery of the signatureA Convertible Multi-Authenticated Encryption scheme
for group communicationsq
Ting-Yi Chang *
Department of Business Education, Graduate Institute of e-Learning, National Changhua University of Education, No. 1, Jin-De Road, Changhua City, Taiwan, ROC
a r t i c l e i n f o
Article history:
Received 29 November 2007
Received in revised form 16 April 2008
Accepted 7 May 2008
a b s t r a c t
Recently, Wu et al. proposed a Convertible Multi-Authenticated Encryption (CMAE) scheme,
which allows a signing group with multiple signers to generate a multi-authenticated
ciphertext signature on the chosen message so that only a designated veriﬁer can recover
and verify the message. In case of later dispute, the veriﬁer can convert the multi-authen-
ticated ciphertext signature into an ordinary one that can be veriﬁed by anyone. In this
study, a CMAE scheme for group communications is proposed. This is presented by ﬁrst
journal homepage: www.elsevier .com/locate / ins
2.1. System Initialization Phase
The notation SG ¼ fU ;U ; . . . ;U g is deﬁned as the signing group of n signers and VG ¼ fU ;U ; . . . ;U g is deﬁned as
1 v1 v2 v4
f2 ¼ U
cipher
Uv7 a
ðxvi2R
2.2. Si
Wi
struct
Step 1
Step 2
Step 3
Step 4
3428 T.-Y. Chang / Information Sciences 178 (2008) 3426–3434S ¼
X
Usj2SG
sj modq ð5Þ
and chooses an integer d2RZq to compute
C1 ¼ gd modp; ð6Þ
C2;k ¼ R
Y
Uvi2fk
yvi
0
@
1
A
d
modp;
0
B@
1
CA; ð7Þ
where  denotes the bit-wise exclusive-or operation.
The multi-authenticated ciphertext signature of the message m for the instance fk is ðS;C1;C2;kÞ.
2.3. Message Recovery and Veriﬁcation Phase
After receiving ðS;C1;C2;kÞ, the Uvi’s2 fk can cooperate to recover the messagem and verify the signature. Each Uvi 2 fk per-
forms the following steps:
Step 1. Uvi computes
ti ¼ Cxvi1 modp ð8Þj sj
If Eq. (4) holds, proceed to Step 4; otherwise Usi requests Usj 2 SG n fUsig to resend sj.
. When all ðrj; sjÞ’s are collected and veriﬁed, the clerk who can be any signer in SG, computesgsj9r
rj yR modp: ð4ÞR ¼ m
Usj2SG
r
rj
j
@ A modp; ð2Þ
si ¼ wiri þ xsiR modq ð3Þ
and then sends si to Usj 2 SG n fUsig.
. After receiving ðrj; sjÞ from Usj 2 SG n fUsig, Usi veriﬁesY0 1ri ¼ g modp ð1Þ
and then broadcasts ri to Usj 2 SG n fUsig.
. After receiving rj from Usj 2 SG n fUsig, Usi computeswiv3Uv5, f3 ¼ Uv7. The access structure can be represented as F ¼ Uv1Uv2Uv4 þ Uv3Uv5 þ Uv7. The multi-authenticated
text signature can only be decrypted and veriﬁed with the cooperation of either Uv1;Uv2 and Uv4, or Uv3 and Uv5, or
lone. The secret key and public key pairs of Usi 2 SG and Uvi 2 VG are ðxsi2RZq; ysi ¼ gxsi modpÞ and
Zq; yvi ¼ gxvi modpÞ, respectively.
gnature Encryption Phase
thout loss of generality, assume that SG wants to sign the message m 2 G with redundancy embedded to the access
ure F ¼ f1 þ f2 þ    þ fk in VG, each Usi 2 SG performs the following steps:
. Usi chooses an integer wi2RZq to computes1 s2 sn v1 v2 vl
the verifying group of l veriﬁers. The following system parameters and notations are used throughout the paper.
q a large prime,
p a large prime such that qjðp 1Þ,
G a subgroup of quadratic residue in Zp, that is G ¼ fi2ji 2 Zpg,
g a generator for the subgroup G,
F the access structure F ¼ f1 þ f2 þ    þ fk denoted in the disjunctive normal form, where fi is an access instance.
F is used for determining who in the verifying group can cooperatively recover and verify the message, e.g., f ¼ U U U ,
Assum
Consid
– the 0 a1 a2 al b ða1þa2þþalÞb
Th
for an
Th
Theor
Proof
and R
efﬁcie
B1. W
3430 T.-Y. Chang / Information Sciences 178 (2008) 3426–3434distribution D of ðg ; g ; . . . ; g ; g ; g Þ.
e VDDH problem is hard if there is no polynomial-time algorithm A that satisﬁes
jPr½AðD0Þ ¼ true  Pr½AðR0Þ ¼ truej > 1
PðjqjÞ
y polynomial P, where the probability is over the random choice of ai’s; b and c.
e following theorem shows that the VDDH problem is at least as hard as the DDH problem.
em 3. The VDDH problem is at least as hard as the DDH problem.
. Proof by contradiction: assume that there exists an algorithm A that can efﬁciently distinguish the distributions D0
0, where ai’s;b2RZq and c2RG. We demonstrate that an algorithm B1 can be constructed by using the algorithm A to
ntly distinguish the distributions D and R, where a; b2RZq and c2RG. First, either D or R is the input of algorithm
ithout loss of generality, let ga1 ¼ ga and gb ¼ gb. Then, algorithm B1 computes the following values:jPr½AðDÞ ¼ true  Pr½AðRÞ ¼ truej > 1
PðjqjÞ
for any polynomial P, where the probability is over the random choice of a; b and c.
In order to prove the proposed scheme is secure against chosen-ciphertext attacks under the DDH problem, a variance of
the decisional Difﬁe–Hellman problem (VDDH) is introduced. Then, we shall prove that a polynomial-time reduction from
the DDH problem to the VDDH problem and in the reverse direction are both easily known.
Assumption 2 (VDDH problem). There are several domain parameters p; q; g and G that are the same as those in Section 2.1.
Consider the following two distributions: ai’s; b2RZq for i ¼ 1 to l and c2RG,
– the distribution R0 of ðga1 ; ga2 ; . . . ; gal ; gb; cÞ;– the distribution R of ðga; gb; cÞ;
– the distribution D of ðga; gb; gabÞ.
The DDH problem is hard if there is no polynomial-time algorithm A that satisﬁesption 1 (DDH problem). There are several domain parameters p; q; g and G that are the same as those in Section 2.1.
er the following two distributions: a; b2RZq and c2RG,In this section, the security assumptions and models for the proposed convertible multi-authenticated encryption scheme
for group communications are deﬁned and its performance is evaluated.
3.1. Security analysis
Using the assumptions of the DDH problem and the Nyberg–Rueppel signature scheme, the proposed scheme is demon-
strated to be secure against chosen-ciphertext attacks and existential forgery under the chosen-message attacks.Usj2SG
sj
Usj2SG
sj
¼ m: 
3. Security analysis and performance evaluationUsj2SG Usj2SG
¼ m gS
Y
y
0
@
1
A
R0
@
1
A  gS Y y
0
@
1
A
R0
@
1
AR  gS
Y
Usj2SG
ysj
0
@
1
A
R0
@
1
A
¼ m
Y
Usj2SG
r
rj
j
0
@
1
A  gS Y
Usj2SG
ysj
0
@
1
A
R0
@
1
A; by Eq: ð2Þ
¼ m
Y
gsj yRsj
0
@
1
A  gS Y ysj
0
@
1
A
R0
@
1
A; by Eq: ð4Þ
3432 T.-Y. Chang / Information Sciences 178 (2008) 3426–3434– SE query: For an SE query on a message m chosen by A, B2 chooses an integer wi2RZq and computes ri ¼ gwi modp,
R ¼ m QUsi2SGrrii
 
modp, si ¼ wiri þ xsiR modq for i ¼ 1 to n, S ¼
P
Usi2SGsi modq. Then, B2 chooses an integer d2RZ

q
and computes C1 ¼ gd modp, C2 ¼ R
Q
Uvi2f yvi
 d
modp
 
. The multi-authenticated ciphertext signature
r ¼ ðS;C1;C2Þ is returned as the result of this query.
– MRV query: For an MRV query on a multi-authenticated ciphertext signature r ¼ ðS;C1;C2Þ, B2 computes
R ¼ C2 
Q
Uvi2f  ti modp
 
where ti ¼ Cx

vi
1 modp, and recovers the message m ¼ R  gS
Q
Usj2SGysj
 R 
modp. If the
redundancy of m is valid, B2 returns the result; otherwise, B2 returns the symbol ?.
– SC query: For an SC query on a multi-authenticated ciphertext signature r ¼ ðS;C1;C2Þ, B2 computes
R ¼ C2 
Q
Uvi2f C
x
vi
1 modp
 
and recovers the message m ¼ R  gS QUsj2SGysj
 R 
modp. If ðR; SÞ and its corresponding
m are valid, B2 returns the result; otherwise, B2 returns the symbol ?.
Challenge phase: A chooses two equal-length messages m0 and m1. B2 chooses a bit h 2 f0;1g at random and computes
the challenge multi-authenticated ciphertext signature r ¼ ðS;C1;C2Þ as follows. B2 chooses an integer wi2RZq and com-
putes ri ¼ gwi modp, R ¼ mh
Q
Usi2SGr
ri
i
 
modp, si ¼ wiri þ xsiR modq for i ¼ 1 to n, and S ¼
P
Usi2SGsi modq. With the dis-
tribution either from R0 or D0,B2 treats C1 as the ðlþ 1Þth element gb of the distribution and computes C2 ¼ R Z, where Z
is the last element of the distribution. Finally, r ¼ ðS;C1;C2Þ is sent to A.
Attack phase 2: The simulated results for SE queries, MRV queries, and SC queries as the same those in the Attack phase 1
with the only restriction being that A cannot issue an MRV query or SC query on the challenge multi-authenticated
ciphertext signature r.
If the input comes from D0 ðZ ¼ gða1þa2þþalÞb modpÞ, the simulation ofB2 will be nearly perfect, and soAwill have a non-
negligible advantage in guessing the hidden bit h. Hence, Pr½B2ðD0Þ ¼ true ¼ Pr½h ¼ h0. If the input comes from R0ðZ ¼ cÞ,
then A’s view is essentially independent of h, and hence the probability of it outputs h ¼ h0 is at most 1=2. Therefore, B2’s
advantage AdvðB2Þ ¼ 2 P Pr½h ¼ h0  1=2P 1. Obviously, the running time t2 counts can be in the polynomial-time. Since
the DDH problem and the VDDH problem are equal, it said that the proposed CMAE scheme for group communications is
secure against chosen-ciphertext attacks under the DDH assumption. h
Deﬁnition 2 (Unforgeability). Consider the following game in which the forger F interacts with the challenger C.
Setup phase: C does the same works as those in the Setup phase of Deﬁnition 1. After receiving those parameters,A out-
puts a target Usi’s 2 SG with the public keys ysi’s.
Attack phase: F issues SE queries, MRV queries, and SC queries adaptively to the oracle O.
At the end of the game,F outputs a multi-authenticated ciphertext signature r ¼ ðS;C1;C2Þ that cannot be the result of
previous SE queries.F wins the game if r can be decrypted to a valid multi-signature ðR; SÞ on the message m under the
secret keys of Uvi’s 2 f .
The convertible multi-authenticated encryption scheme for group communications is said to be secure against existential
unforgeability of multi-signature under the chosen-message attacks if there is no polynomial-time adversary with a non-
negligible in the above game.
Theorem 5. The proposed CMAE scheme for group communications is ðt; Þ-secure against existential forgery under the chosen-
message attacks if there is no polynomial-time algorithm that forges a Nyberg–Rueppel signature with ðt3; 3Þ.
Proof. Proof by the reduction to contradiction: assume that there exists an ðt; Þ-forgerF that can break the CMAE scheme
for group communications in the game of Deﬁnition 2, where t is the running time and  is the advantage thatF succeeds.
We demonstrate that an ðt3; 3Þ-algorithm B3 can be constructed by using A to efﬁciently derive a valid Nyberg–Rueppel
signature. The following gives the details of B3’s simulation.
Setup phase: Simulate C in the game of Deﬁnition 2. After receiving those parameters,A outputs a target Usi’s 2 SG with
the public keys ysi’s.
Attack phase: The simulated results for SE queries,MRV queries, and SC queries are the same those in the Attack phase 1 of
Deﬁnition 1.
Finally,F outputs an authenticated ciphertext r ¼ ðS;C1;C2Þ that can be decrypted to a valid multi-signature ðR; SÞ on
the message m with a non-negligible advantage  and a polynomial-time t. B3 has the ability to output a valid Nyberg–
Rueppel signature ðR; SÞ on the message m with respect to the public keyQUsi2SGysi modp. Therefore, B3’s advantage 3 is
at leastF’s advantage , AdvðB3Þ ¼ 3 P . Furthermore, the converted signature ðR; SÞ on messagem can be done only by
the veriﬁer without any computations. It is obvious that the unforgeability implies the non-repudiation. h
[12] P. Horster, M. Michels, H. Petersen, Authenticated encryption schemes with low communication costs, Electronics Letters 30 (15) (1994) 1212–1213.
[13] S.J. Hwang, C.C. Chang, W.P. Yang, Authenticated encryption schemes with message linkages, Information Processing Letters 58 (4) (1996) 189–194.
[14] W.B. Lee, C.C. Chang, Authenticated encryption schemes without using a one way function, Electronics Letters 31 (19) (1995) 1656–1657.
[15] C.M. Li, T. Hwang, N.Y. Lee, Security ﬂaw in simple generalized group-oriented cryptosystems using ElGamal cryptosystem, International Journal of
Informatics 18 (1) (2007) 61–62.
[16] C. Ma, K. Chen, Publicly veriﬁable authenticated encryption, Electronics Letters 39 (3) (2003) 281–282.
[17] W. Mao, Modern Cryptography: Theory and Practice, Prentice-Hall, 2004.
[18] M. Naor, O. Reingold, Number-theoretic constructions of efﬁcient pseudo-random functions, Journal of the ACM 51 (2) (2004) 231–262.
[19] National Institute of Standards and Technology (NIST), The digital signature standard proposed by NIST, Communications of the ACM 35 (7) (1992)
36–40.
[20] K. Nyberg, R.A. Rueppel, Message recovery for signature schemes based on the discrete logarithm, in: Advances in Cryptology, EUROCRYPT’94, 1994,
pp. 175–190.
[21] K. Nyberg, R.A. Rueppel, Message recovery for signature schemes based on the discrete logarithm, Designs, Codes and Cryptography 7 (1–2) (1996) 61–
81.
[22] H. Petersen, M. Michels, Cryptanalysis and improvement of signcryption schemes, IEE Proceedings – Computers and Digital Techniques 145 (2) (1998)
149–151.
[23] R.L. Rivest, A. Shamir, L. Adleman, A method for obtaining digital signatures and public key cryptosystems, Communications of the ACM 21 (1978)
120–126.
[24] J. Shin, K. Lee, K. Shim, New DSA-veriﬁable signcryption schemes, in: ISISC’2002, Springer-Verlag, 2003, pp. 35–47.
[25] Y.M. Tseng, J.K. Jan, H.Y. Chien, Authenticated encryption schemes with message linkages for message ﬂows, Computers and Electrical Engineering 29
(1) (2003) 101–109.
[26] T.S. Wu, C.L. Hsu, Convertible authenticated encryption scheme, The Journal of Systems and Software 62 (3) (2002) 205–209.
[27] T.S. Wu, C.L. Hsu, K.Y. Tsai, H.Y. Lin, T.C. Wu, Convertible multi-authenticated encryption scheme, Information Sciences 178 (1) (2008) 256–263.
[28] Q. Xie, X.Y. Yu, Cryptanalysis of Tseng et al.’s authenticated encryption schemes, Applied Mathematics and Computation 158 (1) (2004) 1–5.
[29] C.C. Yang, T.Y. Chang, J.W. Li, M.S. Hwang, Simple generalized group-oriented cryptosystems using ElGamal cryptosystem, International Journal of
Informatica 14 (1) (2003) 11–120.
[30] J. Zhang, Y. Wang, Method of constructing elliptic curve authenticated encryption scheme, Applied Mathematics and Computation 168 (1) (2005) 146–
151.
[31] J. Zhang, Y. Wang, On the security of a convertible authenticated encryption, Applied Mathematics and Computation 169 (2) (2005) 1063–1069.
[32] Z. Zhang, S. Araki, G. Xiao, Improvement of Tseng et al.’s authenticated encryption scheme with message linkages, Applied Mathematics and
Computation 162 (3) (2005) 1475–1483.
[33] Y. Zheng, Digital signcryption or how to achieve cost (signature & encryption) cost (signature) + cost (encryption), in: Advances in Cryptology,
CRYPTO’97, 1997, pp. 165–179.
3434 T.-Y. Chang / Information Sciences 178 (2008) 3426–3434
2 T. Y. CHANG AND M. L. CHIANG
Araki et al. [2] ﬁrst proposed a convertible limited veriﬁer signature scheme in which
the authenticated encryption signature could be converted into an ordinary one without
revealing veriﬁer’s secret key. However, the conversion of the authenticated encryption
signature requires the signer’s collaboration with the designed veriﬁer. If the signer is
unwilling to cooperate, the situation becomes problematic [5, 24, 25]. To overcome this
concern, Wu and Hsu [21] proposed a convertible AES, in which the veriﬁer can singly
convert the authenticated encryption signature into an ordinary one. A third-party can
then judge the converted signature. Ma and Chen [14] also proposed a convertible AES,
but Chang et al. [5] pointed out that anyone can forge the converted signature for any
message.
On the other hand, since the message is decrypted from the signature in AESs, the
message cannot be hashed to reduce the size of the message. If the message is large,
the message should be divided into a sequence message blocks, so that each message
block is encrypted and signed individually. Therefore, AESs are not eﬃcient when the
message is large. Hwang et al. [12] proposed an AES with message linkages, which allow
authenticated encryption signatures to handle large messages eﬃciently. The messages
blocks can be recovered in the arranged order. Later, Tseng et al. [19] proposed an AES
with message linkages using self-certiﬁed public keys. Unfortunately, Xie and Yu [23]
showed that Tseng et al.’s AES is insecure. A malicious veriﬁer can forge the signature
for any message by substituting his/her secret key into the trusted center. At the same
time, they give a simple method to improve Tseng et al.’s scheme. Since an authenticated
encryption signature in Tseng et al.’s scheme cannot be converted into an ordinary one,
Zhang et al. [26] proposed an AES based on the Meta-message recovery signature scheme
[11] to satisfy convertibility. It is also eﬃcient, in terms of communication cost and
computational complexity. Recently, Tzeng et al. [20] proposed a convertible AES with
message linkages, which has both properties of “convertibility” and “message linkages”
mentioned above.
In this paper, we show that Zhao and Liu’s AES [25] is vulnerable to a universal forgery
attack. That is, any malicious veriﬁer is able to forge the signature of any message. In [25],
their AES is based on the elliptic curve and presents six types of the signature generation
equations, and the corresponding message recovery and veriﬁcation equations. However,
all types in the Zhao-Liu AES are not secure. Two simple methods shall be presented:
one is similar to Xie and Yu’s improvement; another can not only withstand the above
attack but also provide convertibility.
2. Attack and Improve the Zhao-Liu AES. In this section, the Zhao-Liu AES is
brieﬂy reviewed. It is divided into three phases: system initialization phase, signature
generation phase, and message recovery and veriﬁcation phase.
System initialization phase
The system chooses an elliptic curve E over a ﬁnite ﬁeld Fq, where the order of group
of points in E(Fq) is divided by a lager prime p. Choose a public hash function h and
a public base point G ∈ E with order p such that pG = O, where O denotes an inﬁnite
points. Assume that Alice’s public key is PA = aG ∈ E, where a ∈R Z∗p is her secret key,
and Bob’s public key is PB = bG ∈ E, where b ∈R Z∗p is his secret key.
Signature generation phase
Assume that Alice wants to send a message m ∈ Z∗p to Bob in a secure and authentic
way. Alice performs the following steps to create an authenticated encryption signature
for message m.
4 T. Y. CHANG AND M. L. CHIANG
Step 2. Choose an arbitrary message m′ ∈R Z∗p and satisfy the format of redundancy em-
bedded. Compute
r′ = h((R′)x)−1m′ mod p,
b′ = (rb)r′−1 mod p,
s′ = (sb)b′−1 mod p.
Step 3. Compute his new public key P ′B = b
′G and then asks the trusted center to change
PB as P
′
B.
Since the Zhao-Liu AES has no the convertible property, Bob reveals his secret key
b′ to a third party such that it can judge at the signature (r′, s′) via Equation (1) and
Equation (2). The message m′ can be recovered as follows.
X = s′G− r′PA,
= (sb)b′−1G− r′aG.
m′ = h((b′X)x)r′ mod p,
= h((sbG− b′r′aG)x)r′ mod p,
= h((sbG− (rb)r′−1r′aG)x)r′ mod p,
= h(((kb + rab)G− rbaG)x)r′ mod p,
= h((kbG)x)r
′ mod p,
= h((kbG)x) · h((R)x)−1m′ mod p,
= m′ mod p.
It can be seen that the message m′ is recovered by using Diﬃe-Hellman key exchange
kbG. Hence, the six signature generation equations showed in Table 1 have no thing to
do with the message recovery. Obviously, this attack is successful in the six signature
generation equations.
Here, we provide two simple methods to repair the secure ﬂaw as follows.
Method 1 : The signer must send kG together with (r, s) to the veriﬁer in Step 4 of
signature generation phase. In Step 3 of message recovery and veriﬁcation phase, the
veriﬁer (also the third party) additionally checks the following equation.
kG
?
= X. (4)
Since the malicious veriﬁer does not know the value k, he/she cannot compute k′ such
that k′ = (kr′)r−1 to pass Equation (4) as follows.
X = s′G− r′PA,
= (sb)b′−1G− r′aG,
= (sb)((rb)r′−1)−1G− r′aG,
= (sr−1r′)G− r′aG,
= ((k + ra)r−1r′)G− r′aG,
= (kr−1r′ + ar′)G− r′aG,
= kr−1r′G.
This repair is similar to Xie and Yu’s improvement in Tseng et al.’s AES. However, in
case of a later dispute, Bob still needs to reveals his secret key to prove the signature is
generated by Alice.
Method 2 : From the above Method 1, the signer additionally sends kG to the veriﬁer. In
other words, the authenticated signature is (r, s, kG). On the other hand, the veriﬁer not
