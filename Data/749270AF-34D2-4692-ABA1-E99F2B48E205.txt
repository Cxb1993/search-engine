2□國際合作研究計畫國外研究報告書一份
處理方式：除產學合作研究計畫、提升產業技術及人才培育研究計畫、列管計畫
及下列情形者外，得立即公開查詢
□涉及專利或其他智慧財產權，□一年□二年後可公開查詢
執行單位：國立暨南國際大學
中 華 民 國 97 年 10 月 31 日
4Abstract
This research studies the multipath interference and time varing channel effect
due to very high mobility terminals and provides possible solutions.
The critical issues in very high mobility wireless communications are
inter-symbol interference (ISI) due to multipath fading and inter-carrier interference
(ICI) due to oscillator mismatch and high Doppler shift. Two transmission techniques
(orthogonal frequency division multiplexing, OFDM and wideband code division
multiple access, WCDMA) are considered in this report.
In addition to the above mentioned physical-layer techniques, we also study the
link-layer schemes as in a WiMAX system. We propose macro-diversity hand-off
(MDHO) and two-layer system approaches to increase system capacity, to enhance
data transmission rate and to improve call completion rate.
Through surveying literatures, we use statistical and signal processing techniques
to demonstrate our superiorities by computer simulations.
6移動時會面臨的問題。因此本文針對 WCDMA 系統中時槽同步、通道估測、功
率控制和換手的問題加以研究，期望能提供有效的技術達到在高速火車上享受
3G 服務的願望。以下章節皆細分成四大主題，分別為：1.時槽同步 2.通道估測 3.
功率控制 4.換手。其中通道估測的主題又細分成兩個子主題。
在 OFDM 系統，我們首先探討高速移動環境所產生的時變通道(time-variant
channel)的特性，特別是時變通道所帶來的負面效應：振幅衰減、相位旋轉與載
波間交互干擾。接著我們將針對此負面效應提出可能的解決方案，使此負面效應
能在接收端獲得補償，目的是使通訊系統即便在遭遇高速移動環境時，能仍舊能
夠維持良好的服務品質。
同步及通道估測是 OFDM 系統的核心問題，等同等化器設計之於 WCDMA
系統。我們分別以數學分析和電腦模擬來研究都卜勒偏移(Doppler shift)對 OFDM
及 WCDMA 系統效能的影響，並以統計或訊號處理的眼光，提出有效提升同步
及估測準確度的方法。本報告除了以上傳輸層的改善外，亦對於資料鍊結層(data
link layer)有相關的探討。在 WiMAX 規約下，我們提出了巨分集換手(MDHO)
機制和二階層式系統（Two-Layer System），對於系統容量及封包遺失率有顯著
的改進。
三、 文獻探討
WCDMA 系統
在過去的文獻中有關於 WCDMA 系統的時間槽同步所做的討論大多限定在
單一路徑的 Rayleigh 衰減通道，其最大都卜勒偏移值通常都只考慮 200 ~ 300Hz
之間。傳統的時間槽同步(slot synchronization)技術，為利用傳送在主要同步通道
的同步碼其良好的自相關特性，在接收時由已經知道同步碼的匹配濾波器(match
filter)去求出正確的時間槽起使時間。但是對於台灣高速鐵路的環境，我們必須
考慮多重路徑的通道環境且最大都卜勒偏移值為 550Hz，再加上高移動速度的影
8提出實際的作法。在一個 WCDMA 的系統中，通道衰減特性很自然的會形成
frequency selective fading， 因為多重路徑的 delay spread 一般而言會很容易大於
一個 chip time，但 frequency selective fading 會產生 interpath interference(IPI)
[99]，傳統的通道估測方法，都是利用已經解展頻後的領航符號來估測，忽略 IPI
的影響，而造成估測誤差。由於上述的原因，我們才會考慮在接收端解展頻之前，
先做通道估測，也就是在 chip-level 做通道估測，pilot chips 比 pilot symbol 提供
較正確且較多的資訊，可幫助我們改善通道估測的表現。
在 WCDMA 的上鏈 (uplink) 方向，每個時槽一開始都先傳送連續的 pN 個
領航位元(pilot bits)，目的是用來做通道估測。除了領航位元， DPCCH 還會傳
送 Transport Format Combination Indicator，Transmission Power Control bits 和
Feedback Information。因為 DPCCH 的展頻因子固定是 256，所以一個 slot 可以
傳送 10 個控制位元。DPCCH 有六種可能的 slot 架構，其中 pN 可能是 5，6，7
或 8 [100]。根據領航序列在特定的信號區間內去估測通道的線性估測器已經被
廣泛討論， [101] 提供很完整的研究。 典型的線性估測方法有 linear minimum
mean square error(LMMSE)， maximum likelihood(ML)， matched filter， and
correlator 等等。傳統 WCDMA 接收機使用 correlator 來估測通道，這是因為
correlator 最為簡單。上述的通道估測方法都可獲得好的估測值只要通道變化足
夠慢，一般而言， 為了避免 fast fading 所造成的扭曲， coherence time 應該超
過信號區間的 100 倍[97][98]。假設速度是 300 km/hr 而且載波頻率是 1.98 GHz，
很容易計算出 maximum Doppler frequency 約 550 Hz 和 coherence time 約
216
9
df
0.769 ms (約 2953 個 chip duration )。 In a WCDMA uplink， a pilot
bit duration(等於 256 個 chip duration) 並沒有小於 0.01 倍的 coherence time，所
以在一個領航位元傳送的區間內，通道是會變動的。 直覺上有兩個簡單的解決
方式去克服 fast fading 的影響，第一個是縮短 pilot bit duration，也就是 DPCCH
10
展頻碼作區分。在蜂巢的邊緣的 MS2 傳送的訊號功率可能由於路徑損失，相對
於靠近基地站的 MS1 傳送的功率，少了 70dB。再此情形下如果沒有一些機制去
控制 MS1 跟 MS2 的傳送功率使基地站收到相同的功率，MS1 的訊號便有可能輕
易的蓋掉 MS2 的訊號並且佔掉一大部分此蜂巢的資源，造成分碼多工系統中所
謂的近遠效應(near-far effect)。從最大化系統容量的角度來看，最理想的策略便
是讓所有使用者每個位元到達基地台的功率在每一時間都保持相等。
有人曾經想出藉由一些下傳鏈路的信標訊號(beacon signal)來做開環功率控
制(open-loop power control)去做一個對於路徑損失的粗調，但這樣的方法會有點
不正確。主要的原因是由於寬頻分碼多工接取(WCDMA)的分頻多工(FDD)模式
中上傳鏈路及下傳鏈路會相距一段頗大的頻帶，因此快速衰減通道在上傳鏈路跟
下傳鏈路中造成的效應基本上是不相關的。然而，開環功率控制還是在寬頻分碼
多工接取系統中被使用，但僅止於行動端在剛開始連線時做一個初始的功率粗
調。
因此在寬頻分碼多工接取系統中功率控制的解決之道便是快速的閉環功率控
制。在上傳鏈路的閉環功率控制中，基地台頻繁的量測收到的訊號干擾比
(Signal-to-Interference Ratio)並且跟目標訊號干擾比(target SIR)比較。如果測量到
的 SIR 比目標 SIR 高，基地台將會命令行動端降低其傳送功率；如果量測到的
SIR 太低，基地台便命令行動端增加傳送功率。這樣的測量-命令-反應的循環以
一秒 1500 次的速率在每個行動端執行著，甚至超過了任何顯著的路徑損失所帶
來的功率變化，也超過了快速雷利衰減(Rayleigh fading)效應在使用者移動速度較
低時的變化速度。也因此閉環功率控制將可避免在基地台端所收到的上傳鏈路訊
號任何的功率不平衡現象。
相同的閉環功率控制技術也被使用在下傳鏈路中，但是目的稍微不同。再下
傳鏈路環境中由於是基地台對很多使用者的一對多情形，因此不會有近遠效應發
生。此時一個蜂巢中的所有訊號皆由一個基地站產生並傳向所有行動站台。然
12
(6).功率控制的範圍有限制。
考量以上所列的一些導致閉環功率控制不理想的原因中，對於使用者移動速
度較為敏感的該是第(2)項所提到的步階大小受限的問題，因此本文接著將假設
其他的因素為理想，並針對步階大小在使用者不同移動速度時對於功率控制的影
響做更詳細的討論。
OFDM 系統
正交分頻多工 (OFDM) 在高速無線傳輸系統中是一個熱門的研究技術。因
為每個子頻率 (sub-carrier) 彼此正交，有著完美的頻譜使用效率，也連帶使得頻
率同步問題特別是載波偏移 (carrier frequency offset， CFO) 的效應對 OFDM 的
解碼效能有著致命的影響。另外，因為使用者的高速移動性帶來的都普勒
(Doppler) 偏移也造成影響同步的另一個因素。
CFO 是 OFM 系統最先考慮的要素[1]、[3]、 和[5]。 而取樣頻率漂移
(sampling frequency offset， SFO)直到文章[2]才成為研究話題，但是伴隨子載波
數的急遽增加，SFO 成為維持子載波間正交的決定性因子。Shi、Serpedin、and
Ciblat [4] 提出一種直序偵測 (decision-direct)同步機制，可並行估測CFO 和 SFO
且不需額外浮標 (pilot)。
在非時變通道裡，通道估測已有幾種解決方法被提出，例如：針對時變通道
而特別設計的訓練符元[22]，此種訓練符元一方面會以較短的週期來傳送，以使
估測器能在通道的變化還維持線性的時間內再做新的估計，降低變數的數量。另
一方面，為了能有乾淨的訓練符元來做通道估測，訓練符元必需搭配大量的零點
(Null)來傳送。以多重訓練符元估測頻率領域的近似通道響應也被提出[23]，以
上方法皆需要獨立且頻繁傳送的特別訓練符元，將降低系統傳輸效率。[24]假設
通道在一個 OFDM 符元內只變化數次，如此可降低未知參數的數量，此種方式
可使用原有系統的訓練符元或導引取樣，所付出的代價則是較高的複雜度。此
外，[25]把時變通道的相關函數分解成頻率與梯度的函數來完成對時變通道的估
14
[6]。然而，當傳送天線數增加時，這種正交碼不存在進而限約了解碼端的複雜
性。
Foschini et al. [10] 提出一種多層架構，取名 Bell Laboratories Layered
Space-Time (BLAST) ,可以利用線性濾波器原理對特定層的信號做解碼並利用其
他層的判斷結果回授消除來自這些層級訊號的干擾。垂直式 BLAST (V-BLAST)
藉由動態最佳化各個層級間的解碼順序可有效降低錯誤的遞延來增進系統的表
現。這種 VBLAST 線性濾波器可以經由不同的判斷準則有零強制 (zero-forcing,
ZF) 和最小均方差 (minimum mean-square error, MMSE) 兩種。經由 QR-分解
[13]，VBLAST 解碼的複雜度可以被大幅降低。這種依次 (successive) 的解碼方
法，取名為 ZF-SIC 和 MMSE-SIC，其最上層偵測信號有著最佳的解碼效果，
因為依次消除了下層的訊號干擾。Hassibi [7] 提出了利用平方根機制應用在
MMSE-VBLAST 上，可以有效降低解碼複雜度至傳送天線的立方量級；但相較
於我們建議的作法，我們作法的複雜度又可大幅降低。Liu and Sayeed [8] 在依
次干擾消除 (successive interference cancellation, SIC)迴圈上再加入新的遞迴來進
一步改善錯誤波及，他們證明這個作法比傳統 ZF-SIC 表現更好。然而， 在
EXT-ZF-BLAST 和 MMSE-BLAST 間有著很大的落差在，這也是我們要著墨的
地方。
四、 研究方法
在傳統 WCDMA 接收器的架構中，我們透過改變接收用的匹配濾波器、提
出新的浮標(pilot)、新的功率控制機制及換手方法。比較了時變通道下，上行和
下行系統的效率及解調表現。並以台灣高鐵為例，做了詳細的模擬分析。
為了解決時變通道對 OFDM 系統的負面效應，我們先研究 OFDM 系統在時
變通道下的效能，瞭解訊號失真的原因與方式。接著我們設計能估測時變通道的
通道估測器，藉此獲得精確的通道估計值。為了有效的使用這些由通道估計值，
16
c：為主要同步通道的同步碼。
  2 22 2n k n kr m c m r c r c     (1.2)
c：為主要同步通道同步碼。
與之前設計的不同在於此設計的目的是直接想求出接收到信號的能量大小，
因為如果在不考慮通道雜訊的影響，只考慮高移動速度帶來的都卜勒偏移效應，
由同步通道的傳送架構中，傳送信號的時候才有信號的能量傳送，由於本論文考
慮的是超高速的移動環境其最大都卜勒偏移值為 550Hz，表示說接收到的信號的
頻率偏移值在不考慮載波的頻率偏移的情況下大約在 ±550Hz。
由於：
22 2 2 2 2 2cos sinjA e A A A     
(1.3)
如此一來可以忽略信號受到的頻率偏移量，但是此演算法仍然保有傳統演算
法的特性，我們可以看出在(1.2)式中的最後一項為傳統演算法的計算方法，所以
在高的訊雜比中的時間槽同步仍然會有良好的正確率表現。
新的時間槽同步碼傳送格式如圖 1-4 所示。圖 1-4 中前面五個時間槽傳送的
同步碼為原始同步碼，在中間部分插入新的同步碼符元，最後五個時間槽仍傳送
原始同步碼。
圖 1-4 提出的同步碼傳送格式
18
圖 1-6 的模擬實驗環境參數：
1. 單根 Rayleigh 通道 (fd = 550Hz，時速 300km)。
2. 兩個其他的細胞干擾。
3. 不考慮載波頻率偏移。
-25 -24 -23 -22 -21 -20 -19 -18 -17 -16 -15
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Ec/N0
de
te
ct
io
n
pr
ob
.
Rayleigh
Conventional
New pattern
圖 1-6 新傳送格式與傳統傳送格式在 Rayleigh 通道的同步正確率
從模擬結果圖 1-6 可以得知，新的同步碼傳送格式在通道環境為高速的單路
徑環境下，在時間槽同步的正確率表現與傳統的系統設計表現差不多，接下來看
在高速的多重路徑 RA 環境下正確率表現如圖 1-7 所示。
圖 1-7 的模擬實驗環境參數：
1. RA 環境 (fd = 550Hz，時速 300km)。
2. 兩個其他的細胞干擾。
3. 不考慮載波頻率偏移。
20
3. 不考慮載波頻率偏移。
-25 -24 -23 -22 -21 -20 -19 -18 -17 -16 -15
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Ec/N0
de
te
ct
io
n
pr
ob
.
Rural Area
Conventional
Conventional(Known fd)
圖 1-8 傳統架構在已知與未之都卜勒偏移的同步正確率
從模擬實驗圖 1-8 中可以看出，在已知通道都卜勒偏移並補償後比原本不知
道通道狀態下的情況其時間槽同步正確率好了近 2dB，可以看出由於第一根直視
波補償成低速的通道狀況，可以大幅度的提升時間槽同步的正確率
<接收器分集效應>
現在我們考慮利用接收器分集的觀念，比較傳統同步架構與新演算法加上接
收器分集的時間槽同步正確率如圖 1-9 所示。
圖 1-9 的模擬實驗環境參數：
1. 單根 Rayleigh 路徑 (fd = 550Hz，時速 300km)。
2. 兩個其他的細胞干擾。
3. 不考慮載波頻率偏移。
22
成 15 slots，在 DPCH 中，每個 slot 一開始都先傳送連續的 pN 個領航符號，目的
是用來做通道估測。但為了適應高速變化的通道，我們將 pN 個領航符號平均打
散，如此我們需要做內插的時間縮短，通道估測會正確許多。本研究的作法是盡
量均勻打散連續的 pN 個領航符號，也就是目標是希望在一個 slot 裡，兩兩領航
符號之間，間隔時間的最大值越小越好，間隔時間越短，越能對付 highly
time-varying channel。假如領航符號數目達到 WCDMA standard 所規定的最高比
例，則 SF 在 64 以下，領航符號只要均勻打散就可以達到這個目標；而 SF 大於
64，則需要透過特殊安排才能達到這個目標。顯而易見，當 SF 大於 64，要達到
最小化間隔時間的最大值其配置方式，兩個領航符號間隔的最大時間應該是 2
symbol duration。在 WCDMA 的下鏈方向，針對 DPCH 通道，不同展頻因子下，
可採用的領航符號數目和最高比例如下表所示
SF symbols / frame symbols / slot pilots symbol/slot Highest ratio
512 75 5 2 2/5
256 150 10 1，2，4 2/5
128 300 20 2，4，8 2/5
64 600 40 4，8 1/5
32 1200 80 4，8 1/10
16 2400 160 8 1/20
8 4800 320 8，16 1/20
4 9600 640 8，16 1/40
(A)採用 One link 的架構
所謂 one link 是指由地面上基地台(BS)直接傳送資料給手機端，由於手機端
接收機複雜度的限制，所以我們考慮單獨使用者的通道估測演算法，多重使用者
24
(B)採用 Two link 的架構
所謂 two link 是指火車上的基地台先接收由地面上基地台傳送的資料，再傳
送資料到每個使用者，但由於數個使用者資料一起由地面上基地站傳送，並經由
在火車上的接收機接收，這數個使用者使用相同的傳送功率，經過相同的 radio
channel，MAI 的效應 model 成雜訊是不適合的，做通道估測時若以單獨的使用
者來考慮，MAI 的效應會造成誤差。考慮 R 個使用者加成後的領航信號，MAI
效應可以被減輕，當使用者有相同的 SF，若第 k 個傳送 symbol 是領航符號，則
經過加成的 pilot signal 為



R
i
n
iQ
n
iIiQiI
n
p kjCkCkjbkbks
1
,,,, ))()())(()(()( (2.7)
接收的信號為


 
L
i
nn
i
in
p
n
p kkhkskr
1
1 )()()()(  (2.8)
R 個使用者若有不同的 SF，每個使用者的領航符號位置經過適當安排，使
得 R 個使用者合成後的訊號，在每隔一段適當時間，在時域上可以得到數個經
過加成的 pilot chips，如圖 2.1 所示，假設 3 個使用者的 SF 分別是 128，64，32，
而領航符號的使用比例都符合 WCDMA 中所規定的最高比例，即分別是 2/5，
1/5， 1/10。三個有不同 SF 的使用者，深灰色區域的信號相加，即是我們可以
利用來做通道估測的 pilot chips。
26
度下的環境往往是不適用的，所以我們考慮 chip-level 通道估測的作法，我們以 N
個 chip 為一個 block，利用 LS 的準則，估算出通道，其中假設在 N 個 chip time
時間內，channel coefficients h 可視為是常數，因此 N 不能太大，移動速度越高，
N 就越小，但 N 不能選太小，否則資料量不足，將造成嚴重的估測誤差。 N 值
的選擇，直覺地可以想到一個不是很嚴謹的界線是， 





cT
T
NL 0 ，N 值的最佳
選擇不在本研究討論的範圍。我們提出的方法是將每個時槽中原本連續傳送的
pN 個領航符號平均打散，使得內插的間距縮短，增加高度變化通道的估測正確
性。我們使用的 SF 是不小於 N 的，所以每個領航符號可能被分成數個等長的
blocks，再利用 LS 的準則分別估出每個 block 的通道係數 h，即
2minargˆ Shrh
h
 ， (2.11)
其中 11 )](),...,([   NTNip
i
p Ckrkrr ，   121  LTL Chhhh 
LN
LNi
p
Ni
p
Li
p
i
p
C
ksks
ksks
S 














)()(
)()(
21
1



S 是一個 LN 的矩陣( LN  )，若 S 是 full rank，也就是說 rank of S is L，則
LS 的解為大家所熟知的   rSSSh HH 1ˆ  ，雖然一般來說若 N 夠大，經過擾亂碼
的作用在實際上 S 的確是 full rank，但為了適用於較廣泛的情形，我們使用 SVD
的方法
HVUS  ， (2.12)
此處 U 和 V 是 unitary matrices of orders N and L；是 LN matrix， 它
的非對角線元素是 0 且對角線元素 021  L  ， HV 是 complex
conjugate transpose of the matrix V， LS 的解
 rUVrSh H  ， (2.13)
28
圖 2.3：通道估測的系統模型
我們提出的通道估測方法是為了適應 high mobility， 對於低移動速度， 它
可能反而沒有傳統 symbol-level 通道估測好。而在手持裝置端中存在兩套通道估
測器， 根據移動速度去切換是不太可行的。所以在低移動速度時，有兩種簡單
的方式可以提昇我們提出的通道估測方法的 BER 表現。 一種方式是根據移動速
度的不同而改變 N 值，當速度越低時， N 值可以選越大。另一種方式是 N 值依
據最高時速而選定，不因速度變慢而調整，但可以在低速時，利用平均數個 block
的通道估測值去改善通道估測值的品質。我們傾向於第二種方式， 因為第一種
方式， 隨著 N 值增加， SVD 的複雜度也會增加。我們假設手持裝置端有個機
制能測量出目前的速度，使得通道估測器可以決定要平均多少個 block 通道估測
值。如果目前的速度使得在一個符號區間內通道是不變的， 通道估測器就進一
步平均 block 通道估測值去得到更精確的 channel estimate hˆ， 如下圖 4 所示。
30
圖 2.5 ：WCDMA 上鏈傳送端
若 dSF 和 cSF 分別是 DPDCH 和 DPCCH 的 spreading factor，則 )(nCd and
)(nCc 的週期分別是 dSF 和 cSF 。假如 )(kd I 代表 DPDCH 中第 k 個被傳送的 data
bit; )(mdQ 代表 DPCCH 中第 m 個被傳送的 control bit，則 





dSF
n
k ; 





cSF
n
m 。



L
i
i nnhinsnr
1
)()()1()(  (2.19)
為了簡單描述我們的作法，我們首先假設 DPCCH 中的控制位元全部都是領航位
元。WCDMA 系統，傳統的通道估測敘述如下，第 l 個 RAKE finger 解展頻
(despreading)和解擾亂(descrambling) 對於第m 個傳送的領航位元
 
),(
~
)(
)1(
1
)(
)()()()1(
2
1
)(
1)1(
1)1(
mhmjd
lnh
SF
mjd
njCnCnClnr
SF
mR
lQ
mSF
SFmn
l
c
Q
mSF
SFmn
sQsIc
c
l
c
c
c
c







(2.20)
)(
~
mhl 代表第 m 個領航位元的第 l 條路徑的通道平均值。傳統通道估測的做法是
.)(
)()(ˆ mjd
mRmh
Q
l
l  (2.21)
在 300 公里高速移動的環境下，一個 pilot bit 所經歷的通道可能會有變化，這個
估測值將無法反應出通道的變化，所以我們考慮將一個領航位元(pilot bit)看成
32
        FlFllFl shtF
i
shtshish 


1
)1( 1 , tFi ,,1 (2.24)
經過第 l Rake finger 之後的輸出是
    









SF
n
sQsId
Fk
l
d
l njCnCnCF
k
hlnr
SF
kR
1 ),mod(
*
)(1
2
1
(2.25)
我們定義 ),mod( ba 是 remainder of b
a 。特別地， 若 b 整除 a，
bba ),mod( 。 在執行完內插之後，我們也考慮利用所得到的通道估測值去偵測
其他的控制位元，然後把這些已偵測的控制位元當成領航位元一樣，再執行一次
pilot sub-bit 通道估測，這也是所謂的decision feedback。最後使用有maximal radio
combing 技術的 Rake receiver。結合所有 Rake finger 的輸出，得到第 m 個位元的
決定統計量



L
l
d
l kRkD
1
)()( (2.26)
<傳統線性內插法>
利用此方法估測通道在低速環境是一個簡單實用的方法，因為在兩端的領
航字元符號之間的通道變化用直線去逼近已經綽綽有餘，但是面臨高速移動
時，通道在領航字元符號之間的通道變化已經有明顯的變動，此時用直線逼
近會有誤差產生，所以我們如果採用高階的近似逼近去處理內插的問題會有
較好的表現，也比較逼近實際的通道變化。
<提出的二階內插法>
在二階近似的方法中，我們把逼近的方程式擴展成 y=b0+b1x+b2x2 二階方程
式，先觀察在實數軸的處理方式，把實數軸的資料整理成二維的數字，即(時間,
通道在實數軸的值) 。若我們針對第 n 個和第 n+1 個 time slot 去做估測，用 20%
的領航資料比例的規格，則可知 Npilot =2，Nslot=10，可以得到需要的 A,B 矩陣
34
-250 -200 -150 -100 -50 0 50 100 150 200 250
-150
-100
-50
0
50
100
150
real part
im
ag
p
ar
t
detail estimation in Eb/N0=20dB
ideal
2order
linear
圖 2.8：通道估側內插法與實際變化比較，low SNR
我們可以知道在高速移動中，通道變化會變快。如果通道變化劇烈，在領航
字元符號之間如果只用線性去趨近已經不夠精確，所以需要更高階的逼近法去估
測。當信號的功率夠大的時候，可以發覺用二階的內插法可以很準確的抓到通道
變化，因為在都卜勒偏移為 500 的環境下，用二階的曲線去逼近似乎足夠，但是
在信號功率低的時候，因為二階內插法相當依靠的領航字元出現誤差，所以會導
致估測出來的通道表現變差，甚至不如線性內插法，所以在高速移動的環境下如
果通道估測如果要準確，所需求的領航字元信號強度必須要有所提高。如果在信
號強度足夠的情況下，線性內差法會出現 error floor，這種 error floor 就代表估測
法已經跟不上通道的變化，但是如果相同的環境用二階內插法則不會有 error
floor，顯示此法適用於高速移動的環境。
36
一個字元解調出來馬上就可以提供通道資訊給下一個字元使用。
從上面內插法的概念可以得知，二階的近似可以更貼近通道的實際
變化，所以我們也提出了一個新的架構如圖(b)，對於通道估測不只採
用上一個字元解調完的資訊，更加入了之前的通道資訊，而彼此之間也
採用二階的近似曲線，如此一來對於錯誤傳遞比較有所牽制。
5 10 15 20 25 30
10
-3
10
-2
10
-1
10
0
E b /N 0
B
E
R
d ec is io n d irected V S p ro p o sed d d +2o rd er in fd 500 o n e R ay le ig h
d d 128 ch ip s
m o d ified d d 128 ch ip s
d d 256 ch ip s
m o d ified d d 256 ch ip s
d d 64 ch ip s
m o d ified d d 64 ch ip s
圖 2.11：決策回授法在高速移動下的表現
<PADD 架構>
PADD（pilot added decision directed）通道估測架構是一種較為進階的通道
估測系統，他所需要的複雜度比上述的內插法或是信號回授法高，但是由於該架
構彈性很大，有很多對於高速列車通道估測有益的觀念可以加入到該系統中。在
接收器接收到訊號後，跟傳統的通道估測觀念一樣，先做資料區段和領航區段的
分流，取出領航訊號的區段後，再根據截取出的領航訊號去做解展頻，得到領航
字元後，經過適當的濾波器把雜訊濾掉，接著進入內插演算法，傳統可以用線性
內插法，但是此時為了對抗高速，我們可以使用二階近似法去做內插的動作。在
得到粗估的通道資訊後，可以對於資料區段的分流作通道補償，此時搭配最大比
例增益把耙式接收機的其他 finger 集合起來做解調決策。
38
5 10 15 20 25 30
10
-3
10
-2
10
-1
10
0
Eb/N0 dB
B
E
R
PADD structure 256 chips system in RA
2order interpolation
linear interpolation
圖 2.14：256 chips 系統使用 PADD 架構在 RA 通道環境下的表現
<CPICH 輔助通道估測>
在 WCDMA 的系統中，用來估測通道的領航字元存在於 CPICH 與 DPCCH
中，第二章有描述過，前者是連續傳送但沒有功率控制，後者是時間間隔傳送但
常伴隨著功率控制。CPICH 常拿來做控制通道的通道估測，DPCCH 常拿來做資
料的通道估測，但是在 PADD 的架構中，可以把 CPICH 安排在適當的位置，來
幫助 DPCCH 去估測通道的變化。
40
Demux delay delay
FIR 內插 FIR
Sum
*
* *
r(i)
Data r(i)
Pilot r(i)
Reference pilot
symbols From other
fingers
Final channel
estimation
From
CPICH
圖 2.16：CPICH 決策前輔助 PADD 架構簡圖
Demux delay delay
FIR 內插 FIR
Sum
*
* *
r(i)
Data r(i)
Pilot r(i)
Reference pilot
symbols From other
fingers
Final channel
estimation
From
CPICH
圖 2.17：CPICH 決策後輔助 PADD 架構簡圖
<行進方向夾角的討論>
假設基地台設置在高速鐵路附近，這樣可以確保直視波的存在，也進而增
加信號的品質，也可以算是爲了高速鐵路量身打造的一套基地台系統，但是實際
在高速鐵路的環境因為移動速度很大，造成都卜勒偏移也變大，由於這種場景大
多是用Rician通道去模擬，通常Rician中的直視波的角度是由隨機產生的，但是
42
decision-directed (PADD)[105]和 second-order interpolation，其中 second-order
interpolation 是指利用 3 個領航符號的通道估測值，以一個二次函數來近似，估
測出被夾的兩段資料的通道係數。我們所提出的 chip-level 通道估測的 BER 表
現，根據兩個不同的準則 LS 和 LMMSE 也包含在模擬中。 In the one-link
framework， 在不同 SF 和不同速度下的 BER 比較被顯示於圖 2.18–2.21。事實
上對於其他 SF，領航符號的投資不夠， BER 無法降到 310以下，由於篇幅有
限並未列出模擬結果。 從圖 2.20 和圖 2.21， 可以看出對於 one-link framework
在低速下 5.5df ， 我們提出的方法只要加上平均(multi-block averaging)的動
作，BER 表現都會和 symbol-level 通道估測的 BER performance 一樣好。在
two-link framework 下，我們考慮 12 個使用者的資料同時由地面上基地台傳到火
車上的基地台。這些使用者可能有相同的 SF，也可能有不同的 SF，從圖 2.22 到
圖 2.25，我們可以發現，我們所提出的方法在 BER 的表現上都比 symbol-level
為基礎的方法好。這是因為我們在 two-link framework 下，考慮了合成的 pilot
signal，它有效抵抗了 MUI 的影響，再加上考慮的環境有一條是 rician fading
path。這兩個因素使得在 two-link framework 下的表現比在 one-link framework 下
更好。
44
圖 2.20: In the one-link framework, BER comparison in 3-Raleigh fading channel
with SF=128, fd=5.5.
圖 2.21: In the one-link framework, BER comparison in 3-Raleigh fading channel
with SF=64, fd=5.5.
46
圖 2.24: In the two-link framework, BER comparison with different SFs, fd=555.
圖 2.25 :In the two-link framework, BER comparison with different SFs, fd=5.5.
48
圖 2.26: 完全領航位元的 DPCCH, 不同的 SF 下, 使用 pilot bit 的通道估測
圖 2.27: 完全領航位元的 DPCCH, 不同的 SF 下, 使用 pilot sub-bit 的通道估測
50
圖 2.30: 不完全領航位元的 DPCCH , SF=32, 使用 pilot sub-bit 的通道估測
圖 2.31: 不完全領航位元的 DPCCH , SF=128, 使用 pilot sub-bit 的通道估測
52
( 1 )
1
( ) ( ) ( )p
p
nT
r tn T
p
P n P t Q t d t
T 
 
其中 Tp 為功率控制週期，P(t)為傳送功率，Q(t)則是通道之功率增益。此增益包
含了所有多路徑反射對訊號功率的效應。Q(t)亦可以表示為 1 2
0
( ) ( )
L
p
p
Q t a t



其中αp 為耙型接收器第 p 個指針的權重係數。而傳送功率 P(t)在一個功率周期之
間可以視為保持不變，因此
( 1 )
1
( ) ( 1) ( ) ( ) ( 1)p
p
n T
r t tn T
p
P n P n Q t d t n P n
T


 
    
  

又若我們定義
( 1)
1
( ) ( )p
p
nT
n T
p
n Q t dt
T

 ，收到之功率便可以表示為 ( ) ( ) ( 1)r tP n n P n 
左圖表示了標準閉環功率
控制更詳細之方塊圖，行動
站台之傳送功率 P(t)因通道
效應Φ(n)而衰減。而在基地
台處，測量到的接收功率為
Pr(n) (此處我們假定精確無
誤的量測)。然後將接收功率 Pr(n)跟一個希望達到的固定功率 Pd 做比較。定義
誤差 ea(n)為 ( ) ( )a d re n P P n  ，可以同效地表示為 ( ) ( ) ( 1)a d te n P n P n  
然後功率誤差 ea(n)再經過一個單位元量化器做量化，產生功率命令位元(power
command bit)b(n)，以量化器之步階大小(step size)△的一半為單位  ( ) ( )
2 a
b n sign e n

此一功率命令位元接著被傳送至行動站台處，控制行動站台的傳送功率增加或減
少一個固定的大小，如右式 ( )( ) ( 1)b nt tP n P n 
其中α是一個常數(通常為 1~3 之間)。也可以想成，Pt(n)是增加或者減少ΨdB
又 1010log  ，由以上可推得 log ( ) log ( 1) log log ( 1)
2 ( )
d
t t t
P
P n P n sign P n
n   
          
。
這個表示式說明了以對數刻度來看時，Pd 跟 Pt(n)之間的關係會像是一個以
log
( )
dP
n 
 
  
為輸入、 log ( )tP n 為輸出之 delta 調變器，如下圖所示。其中對數函數
+ 
1z
1z
ZOH
User data
( )n
Power
Measurement
( )ae n
( )rP n
dP ( )b n ( )tP n
54
降低；另一個部份則是將功率控制迴路視為 delta 調變器時的量化誤差與功率控
制步階大小的乘積，這部分就跟功率控制步階大小的設定較為相關，因此可透過
功率控制演算法的改進來降低誤差。而從使用者的移動速度方面去考量時，當移
動速度變快，使用者與基地台之間由於速度不同所造成的都普勒效應的影響也加
劇，亦即在相同的功率控制週期時間內通道的變化加快，便會使差值平方的值變
大；除此之外，由於通道的變化加快，此時閉環功率控制會漸漸跟不上通道變化
的速度，造成類似於 delta 調變器中斜率超載(slope overload)的問題，使量化誤差
因而增加，而造成功率控制誤差隨著使用者移動速度加快而上升，而除了斜率超
載的問題外，即使設定夠大的步階大小來跟上通道衰減的速度，此時類似 delta
調變器的功率控制機制仍然會有類似顆粒雜訊(granular noise)的量化誤差。
透過分析，我們可以知道固定步階大小的閉環功率控制之運作機制會因斜率
超載或者是顆粒雜訊而產生量化誤差，在舊有的文獻中減低量化誤差的主要方法
為利用可適性步階大小的 delta 調變器，此方法是根據收到的功率控制命令來隨
時地調整步階大小，當連續收到好幾個同樣往上調整或往下調整的命令時，我們
判斷此時應該是處於斜率超載的情形，便根據此情形將步階大小調大以利追蹤通
道的衰減；而當收到的命令為上、下、上、下時，我們判斷此時步階大小可以追
的上通道衰減的速度，便可將步階大小調低以降低顆粒雜訊所引起的量化誤差。
然而，閉環功率控制迴路之機制乃是透過接收-估測-調整的機制，對於接收
端而言，接收與估測的都是這個時間來的傳送訊號，而調整的則是下個時刻來的
傳送訊號，也就是說功率控制迴路是利用這個時刻收到的通道資訊，來調整下一
個時刻的傳送功率，可以說是這個調整的機制延遲了一個功率時間週期，因此在
較低速的環境中，由於通道的變化程度不太大，這個延遲對效能並不會造成影
響；但在使用者速度極快時，由於通道變化的程度太快，這個延遲對於閉環功率
控制迴路的效能就變成了瓶頸，因此即使是利用可適性步階大小的方法，由於無
法克服此一迴路的延遲問題，可以改善的效能就十分有限。因此，為了降低迴路
56
存器便將前幾個時刻的通道資訊與最佳預測係數做運算後預測第 n+D 個功率控
制週期時間的通道資料，其中 D 是 delay 的功率控制週期時間個數，而接收端便
根據此資料來對傳送端做預測性功率控制演算法的功率控制。
模擬結果與討論
在本節中透過模擬，我們將對之前提出的作法做一些比較跟討論。首先定義
一些模擬的參數，可分為 Rayleigh 以及 Ricean 兩種不同的環境，如下表。
Carrier frequency 1920MHz 1920MHz
Channel model 1-path Ricean (Classic Doppler Spectrum plus one
LOS path)
1-path Rayleigh (Classic Doppler
Spectrum)
Mobile speed 3, 30, 60, 90, 120, 150, 180, 210, 240, 270, 300 km/hr 3, 10, 20, 30, 50, 100, 150, 200, 300 km/hr
PC algorithm Predictive predictive
Shift register taps 5, 10 2, 5, 10, 20
PC command rate
(1/Tp)
1500Hz 1500Hz
PC loop delay 0.667 ms (one PC period) 0.667 ms (one PC period)
PC step size Fixed (1 dB) Fixed (1 dB)
PC command error rate 0 0
PC dynamic range 40dB 40dB
S target 0 dB 0 dB
Signal-to-Noise Ratio 100 dB (noiseless) 100 dB (noiseless)
58
在使用飛機平台支援高速列車的環境中，使用寬頻分碼多工存取（WCDMA）
系統的逆向鏈路系統容量（reverse link capacity），考慮不同 cell 大小的覆蓋情形
（macro cell 以及 micro cell）以及兩種行動端存在，一為在 macro cell 中行駛採
用雙鏈超級行動端（super mobile）形式的高速列車，另一種為在 macro cell 以及
micro cell 中皆會存在的普通使用者，推導出飛機平台支援高速列車的環境中的
逆向鏈路系統容量。
假設每個 macro cell 中有 N1 個普通使用者，每個 micro cell 中有 N2 個普通
使用者，而這些普通使用者在 cell 中皆為均勻分佈；現在考慮高速列車採用 two
link 的架構，把列車看成一個把車內所有需求整合起來，一起對外競爭的超級行
動端（super mobile），由於高速列車軌道為南北向的，所以在考慮高速列車這個
超級行動端時，只會在本身所處的 macro cell 以及其南北兩向的 macro cell 有 M
台高速列車存在。
此外，我們假設功率控制完美（perfect power control），並不會產生功率控制
錯誤，這樣一來，每個普通使用者訊號到達飛機平台上的基地台，都有著相同的
功率 S，而每台高速列車訊號到達飛機平台上的基地台，都有著相同的功率 trainS 。
得 到 由 高 速 列 車 的 觀 點 考 量 所 推 導 出 的 關 係 式 如 下 ：
  











 









 
 macrotomicromacrotomacrour
traintrain
traintraintb
trainb
fx
N
v
F
Mv
x
N
vv
S
WN
NE
RW
__
2
__
10 11)(
(4.1)
其中
 




northsouthj
D
ijijij
GGmacrotomacrour
ddrr
D
F
ijijO
,
2
0 0
2
10
)()(___
1
101
1
, 





 nsJ
j
D
ijijij
GGmacrotomicro
ddrr
D
f
ijijO
1
2
0 0
2
10
)()(__
1
10
1
, 


另一方面 也可依照相同的方法推出marco cell 與micro cell中普通使用者考
60
0 10 20 30 40 50 60 70 80 90
-50
-40
-30
-20
-10
0
10
20
30
40
boresight angle (degree)
A
nt
en
na
G
ai
n
(d
B
)
HAPS antenna radiation pattern mask
Gmax=35
Gmax=30
Gmax=25
Gmax=20
Gmax=15
Gmax=10
Gmax= 5
Gmax= 0
Gmax=35
Gmax=30
Gmax=25
Gmax=20
Gmax=15
Gmax=10
Gmax=5
microtomacrof __ ，我們依照模擬結果討論使用不同的天線場型來達成 macro cell 以及
micro cell 覆蓋的優缺點，選出較適合的天線場型，而後用模擬實驗來決定該用
哪種天線場型（antenna pattern）來達成 macro cell 與 micro cell 的覆蓋，接著利
用決定好的天線場型，進一步安排高速列車與普通使用者之間的數量與發送功率
關係，透過數值結果分析的，驗證是否設計的系統能有效地提升系統容量。
研究問題二：飛機平台支援高速移動列車下的換手機制
依照高速軌道列車與飛機平台的特點，我們針對此環境提出了幾點 handover
的簡化與修改，其中因為高速移動，固定時間內移動的距離較大，所以路徑損耗
也會衰減的比較快，必須讓 handover 機制提早發生，否則會發生在下一個 cell
還沒加入時，原來的信號已經衰減到不敷使用的狀況，另一方面在將 cell 從 active
set 中移開時也需要早點啟動，否則列車速度很快，假如不能及時把之前的 cell
移開，會對現在的 cell 造成很大的干擾。
62
0 1 2 3 4 5 6 7 8 9
0
5
10
15
20
25
distance from cell center (Km)
nu
m
be
r
of
dr
op
pi
ng
ca
lls
add margin = 2dB
add margin = 6dB
overlap region
圖 4.1 dropping call 的發生區間
0 1 2 3 4 5 6 7 8 9
0
5
10
15
20
25
30
35
40
45
50
distance from cell center (Km)
nu
m
be
r
of
ac
tiv
e
se
t
up
da
te
add margin = 2 dB
add margin = 6 dB
圖 4.2 active set update 的發生區間
從圖 4.1 觀察，我們發現 dropping probability 大部分都發生在兩個 cell 重疊
區域的前半段附近，這是因為在重疊區域的後半段通常都是已經有加進新的 cell
而舊有的 cell 也尚未移除，斷線機率相對變小，所以並非完全對稱。
從圖 4.1 與圖 4.2 觀察，我們得知 mean active set update rate 則是大部分分佈
在非誤判時，要開始加入連結的時間點到開始要移除連結的時間點附近，此外可
以看出較大的 add margin，會使得 active set update 提前發生。
64
2.依照估算出來的位置資訊，依照上面的方式調整 T_add
3.假如收到信號的強度在 T 的時間內都比 addT _ 來的強，則便將此 cell 加入
Active Set。
adaptaddSsASBestaddT ,___  (4.4)
4.假如收到信號的強度在 T 的時間內都比 dropT _ 來的弱，則便將此 cell 從
Active Set 移開。
adaptdropSsASBestdropT ,___  (4.5)
模擬結果將從行動端服務品質與系統端資源使用率兩方面來評斷效能，並與固定
式的 add margin 與 drop margin 作為比較。
研究問題一的結果和討論：
針對 macrotomacrourF __ macrotomicrof ___ microtomacrourF ___ macrotomicrourf ___ 變數分析討論
Macro to macro
下圖為只有考慮南北向 macro cell 對 macro cell 的情形
macro cell 示意圖
 




northsouthj
D
ijijij
GGmacrotomacrour
ddrr
D
F
ijijO
,
2
0 0
2
10
)()(__
1
101
1
, 
 (4.6)
66
小
micro cell 與 macro cell 示意圖



 nsJ
j
D
ijijij
GGmacrotomicro
ddrr
D
f
ijijO
1
2
0 0
2
10
)()(___
1
10
1
, 

(4.7)
實際環境需考慮有對應個數的 micro cell 在 macro cell 旁邊，其模擬的總結
果如圖 4.4，原本 Gmax 還可以攀升到還蠻高的位置，但是因為 macro cell 個數
增加導致 interference 變多的影響，導致無法在攀升到之前的位置。另外，在半
徑等於 5km 時，Gmax=25 比 Gmax=20 來的好，可是並不能因此就決定使用
Gmax=25 的天線場型來涵蓋 macro cell，必須也要考慮到 Macro cell 對 micro cell
的影響，依照整體的影響才能作判斷。
68
0 5 10 15 20 25 30
0
10
20
30
40
50
60
macro cell radius (Km)
f
m
ac
ro
to
m
ic
ro
macro to micro
Gmax=35
Gmax=30
Gmax=25
Gmax=20
Gmax=15
Gmax=10
圖 4.5 microtomacrof ___ 與細胞半徑關係圖
之前，micro to macro 的討論中，我們發現在半徑為 5 公里時 Gmax=25 時比
Gmax=20 表現來的好，但是 macro to micro 圖 4.5，半徑為 5 公里時 Gmax=20 時
比 Gmax=25 卻來的好，原因如下：假如在 macro cell Gmax=25、涵蓋半徑 5 公
里時，此時因為在干擾細胞的行動端的 )( ,0 ijG 比較小而 )( ijG 比較大，所以會
使得 macrotomicrof ___ 表現很好，而 microtomacrof ___ 表現很差； macrotomicrof ___ 會好是因為
相對壓縮了 microtomacrof ___ 的結果，相反的， microtomacrof ___ 會好是因為相對壓縮了
macrotomicrof ___ 的結果。
按照服務高速列車優先的原則，應該是要選擇 Gmax=25 的，不過選擇
Gmax=25 有一些缺點，第一、當涵蓋半徑為 5 公里時，邊界的天線增益只剩下
3.7dBi，會對於服務品質有所限制，第二、假如選擇 Gmax=20，列車可以藉由調
70
N1 值，虛線為 macro cell train constraint，實線為 micro cell user constraint，現在
目的要使得 N1+N2 有最大值，N1 的最佳值為何？最佳值也是同樣發生在三條線
同時交叉的時候，我們發現在 N1=100 時，會有最佳值發生，再繼續調降 N1 能
增加的 N2 個數很有限。所以在給定 W/Rb=2 required Eb/Nt=3 以及 M=2，選擇
X=110，N1=100，N2=362 系統 capacity 達到最大值。
下表為依照相同的做法，求出在不同的 required Eb/Nt 所對應的最大 cell
capacityN1 與 N2 的人數。
研究問題二的結果和討論：
下面為依照位置資訊將 add_margin 做可適性調整的效能模擬分析與固定式
的 add_margin 做為比較，可適性的 add_margin 的參數為 6max, add dB，
2min, add dB， 8drop dB； kmRref 3 ， kmR 5 。
之前我們已經知道隨著 add margin 的調高，代表加入 active set 的門檻值
T_add 降低，使得列車的 dropping probability 隨著降低，但是也會伴隨著系統負
載的增加，所以我們以固定式的 add_margin 作為衡量的依據。
72
也有所減輕，達到固定式所為無法達到的效能。
6 6.5 7 7.5 8 8.5 9 9.5 10 10.5 11
1.26
1.28
1.3
1.32
1.34
1.36
1.38
1.4
1.42
m
ea
n
ac
tiv
e
se
t
nu
m
be
r
standard deviation of the shadowing (dB)
add margin=2 dB
add margin=3 dB
add margin=4 dB
add margin=5 dB
add margin=6 dB
adaptive add margin
圖 4.8 adaptive add margin 在 mean active set number 上的表現
6 6.5 7 7.5 8 8.5 9 9.5 10 10.5 11
0.016
0.018
0.02
0.022
0.024
0.026
0.028
0.03
0.032
0.034
standard deviation fo shadowing (dB)
m
ea
n
ac
tiv
e
se
t
up
da
te
ra
te
add margin=2 dB
add margin=3 dB
add margin=4 dB
add margin=5 dB
add margin=6 dB
adaptive add margin
圖 4.9 adaptive add margin 在 mean active set update rate 上的表現
74
其中 s(m)代表第m 個被傳送的OFDM符號 (symbol)， W 是個N x N 大小的
IDFT 矩陣表示如下：















1)-1)(N-j(N1)-j(N
1)-j(Nj
ee1
ee1
111
N
1




W , (5.2)
式中 N/2 . N 表示子載波的個數。
gN 個樣本的迴旋前綴 (cyclic prefix, CP)
加在 IDFT之後的信號前以消除多路徑造成的樣本間干擾 (inter symbol
interference, ISI)。CP長度假定大於最大的延遲漂移(delay draft)。所以，一個OFDM
符號長度等於
gNNM  個樣本。
在接收端，假設CFO 和SFO被完全補償，則未通過傅立葉轉換(discrete Fourier
transform, DFT)的信號如下：
(m)(m)(m) nWHsy  , (5.3)
其中 n(m)表示附加的白高斯雜訊(additive white Gaussian noise， AWGN)， and
H 表示頻域的通道脈波函數 (channel impulse response)。在無線通訊環境，移動
產生的都普勒漂移和傳送機/接收機間的震盪頻率差異，使得系統間遭受 CFO
c 和 SFO s的影響。在移除掉CP後，接收信號表示如下：
(m)(m)(m) )(1 s nHsΦWy   (5.4)
矩陣 )(1 sW 中的每個單元是從相對應的 W 單元做 ( s1  ) 冪次方得來 ,
)e,...,ediag(1, 1)-j(Nj Φ 表示CFO 矩陣，其中 NTsc2 而 sT 是 OFDM 符號的
時間間隔。
76
如後：   HH HHHG 1ZF  and   HNHMMSE HIHHG 12   [11]，而相對的濾波器
輸出：
 
  .~
,~
12
1
ZFZF
xHIHHxGs
xHHHxGs
H
N
H
MMSEMMSE
HH





(5.6)
為了避免式子(5.6)中的反矩陣運算，Shiu and Kahn [12] 為BLAST偵測提供了
一個低複雜度基於QR分解的機制，如以下演算法一所示。
演算法一 [12]: (ZF-SIC)
假設通道矩陣式一個高矩陣或 NM  ，對通道矩陣 H 作QR分解 [13]：
QRH , (5.7)
其中 Q 是 MM 正交矩陣而 R 是 NM 上三角矩陣，格式如下：
.
00
0
][r
,
,11,1
~1
~1,
MxN
NN
N
Nl
Mklk r
rr



















R
在接收向量 x左側乘上 HQ ,，得到下列輸出：
nQRsxQs HHTNss  )~~(~ 1 , (5.8)
其中 nQn HTNnn  )~~(~ 1 是一個 N-變數獨立相同分布的白複數高斯 ( i.i.d.
white complex Gaussian) 雜訊。 因為矩陣R是上三角，
k
kl
llkkkkk nsrsrs
~~
,,  

, for k = 1, …, N. (5.9)
假設完美的消除下，式子 (5.9)中的干擾項可經由減去已偵測的信號
Nkk sss ˆ,,ˆ,ˆ 21  而被消除， 待估測變數變成：
kkkk
kl
llkkk nsrsrsy
~ˆ~~ ,,  

. (5.10)
而這連續偵測順序是從 Nsˆ 到 1ˆs ，或是從下層到上層。
在這些提到的偵測方法中，因為BLAST系統的特性，由於前面信號的干擾被有
效的移除，最後被估測的變數 1ˆs 有著最佳的可靠度。基於這點， Liu [8] 提出多
加一個遞迴來運用減去最後估測的信號 1ˆs 後回饋給下一次遞迴使用，可有效提升
系統的可靠度。如果遞迴過程運作良好，則它可有效消除一個天線的干擾而助於
提高下一次 ZF-SIC 迴圈的效能表現。因為每做一個遞迴動作，會消除一個天線
78
interference, ICI)、信號衰減、和信號相位偏轉，傳送信號因而不能正確被還原。
依文獻 [9], N點DFT被解調的信號方塊中的第m個OFDM符號可以表示如下：
)(ICI)()()( )(2)1( mneemHmsmz k
NmMNjNNj
kkk
gkk    , (5.14)
其中 )(mnk 表示 (m)HnW 像量中的雜訊變數，而
scssck kk   )1( . (5.15)
式子(5.14)右手邊的第一項說明了因CFO和SFO造成的信號衰減和信號相位偏
轉。 因SFO s產生的DFT 視窗位移並未顯示在(5.14) 中。然而當DFT點數 N
夠大時，SFO造成的這個視窗位移會大到不可忽視，例如N=2048 對應歐洲的數
位影像廣播(Digital Video Broadcasting, DVB)。因此，我們必須更準確地估計 c和
s並在信號未通過DFT前將CFO和SFO補償回來，才能有效消除相位漂移和DFT
視窗位移。
同[7]和[9]，兩個相鄰OFDM符號的共軛乘積等於
noisemHmsmsemzmzm kkk
j
kkk
k  2*2* )()1()()1()()(  , (5.16)
其 中 NM ， * 表 示 共 軛 轉 換 ， 我 們 並 假 設 通 道 變 化 緩 慢 或
)1()(  mHmH kk 。
提出的 OFDM 聯合 CFO 和 SFO 補償機制
在式子 (5.15)，當 sc 相較於 c極小時，由 CFO 和 SFO 造成的頻率漂移
總量近似於線性變化，對所有 1-N,0,k 。[7] 和[9] 觀察到這個線性關係並提
出以個別封閉迴圈(closed-loop)的平行補償 CFO 和 SFO 的方法。當 sc 並非小
80
其中 arg[] 表示信號的角度運算子，C(U)=[0,-K/3-1]、C(M)=[N/3,2N/3-1]及
C(L)=[2N/3,N-1] 分別代表上、中、下三部份的子載波參數集合。
為了可靠的估測 (m)sˆk ，我們在粗略同步後，使用嚴格信號判斷規則決定傳
送信號，信號估測錯誤率可經由對式子(5.17)-(5.20)取平均來降低對 CFO 和 SFO
估測的影響。
底下分析效能表現，同[4]， CFO 和 SFO 的均方差 (mean square error, MSE) 如
下：
0s
22c NEN4
1
)ˆMSE(

  , (5.21)
0s
222s NE2)N(N
4
)ˆMSE(



 . (5.22)
由式子(5.15)，可推得 kˆ及 ]ˆ[Eˆ k k 的均方差：
],
2)(N
16
[1
NEN4
1
)]ˆMSE()ˆ[MSE()ˆMSE(
2
2
0s
22
s
2
ck



k
k


(5.23)
],
2)3N(N
1)1)(2N8(N
[1
NEN4
1
]}
2)(N
16
[1
NEN4
1
{E)ˆMSE(
2
0s
22
2
2
0s
22k






 k (5.24)
其中 {}Ek 表示對變數 k 做期望值運算，假設線性關係存在並利用以下事實：
6
1)1)(2NN(NN
1k
2 

k 。
當得到 CFO 和 SFO 的估測量，這個補償量經由封閉迴圈回饋至下一個
OFDM 符號解調，可以用一次線性濾波器來近似這個迴圈濾波如下：
ccloopc,
'
loopc, ˆ  , ssloops,' loops, ˆ  , (5.25)
其中 c和 s分別是 CFO 和 SFO 迴圈增益。[4]推倒了封閉迴圈下的均方差如
82
圖 5.3、 頻率錯誤的均方差(MSE)比較
圖 5.4、位元錯誤率比較
對 MIMO 系統提出的偵測機制
84
經由直接的代數運算，估測的參數可以重複地推導如下：
,1...,2,-1,-),)/(2arg(1
ˆ
~
1
MMm
mm,m
m
λ)f-λ(f
sr
s
f
)(m
df
(m)
d

  (5.31)
1...,2,-1,-),
1
*
11
*
1-
arg(1
ˆˆ
~~
1-
MMm*
m-m,m-m-m,m
mm
λ)p-λ(p
ssrr
ss
p
(m)
dp
)(m
d
 (5.32)
其 中 最 先 估 測 的 參 數 ))/(2)ˆ(
~
arg(
MMM
M sr
s
f
,
(M)
d
 ，
))ˆˆ(
~~
arg( *
1-
*
11
*
1-1-
MM,M-M-M,M
MM)(M
d ssrr
ss
p  ，式子中 )arg( 表示角度運算子，而 m、
(0,1)fλ 、和 (0,1)pλ 分別代表傳送天線的編號、頻率收斂係數和相位收斂係
數。遞迴後的最終估測參數為
)(
dd
ff
1ˆ  ， )(
dd
pp
1
ˆ  (5.33)
在此強調：式子(5.31) 和 (5.32)操作順序是從(m+1)到 (m) 異於一般的遞增順
序，起因於這依序偵測序列是從 Nsˆ 到 1ˆs 。
換言之， 這個估計器可以解譯成已知通道矩陣H、接收向量 x 和偵測向量 sˆ
下，T 的條件期望值或是  sx,H,|TT ˆEˆ 。而偵測器可以解譯成已知通道矩陣
H、接收向量 x和偏移矩陣 Tˆ 下，s的條件期望值或是  xTH,|ss ˆ,ˆEˆ 。這 MIMO
VBLAST 系統的聯合偏移矩陣估測器和信號偵測器，可以表示如演算法三。
演算法三：
定義 



NI
H
H  和 



0
x
x 分別代表延伸的通道矩陣和接收向量。
演算法操作如下：
步驟 1) QR-分解 11RQH .
步驟 2) 對接收向量 x左邊乘上矩陣 H1Q
11 nxRxQs  HTNss 11 )~~(~  .
步驟 3) 對 k = N 到1，重複以下步驟：
甲) 減去信號 Nkk sss ˆ,,ˆ,ˆ 21  帶來的影響：
kkkk
kl
llkkk nsrsrsy
~ˆ~~ ,,  

,
86
許的複雜度。 三) 偏移矩陣在遞迴偵測和估計中被更新，不需額外投資浮標且
可有效降低錯誤傳播。
在此強調我們提出的聯合偵測和估計作法可推廣至其他BLAST 偵測機制(包
含ZF 和 MMSE準則)亦可運用於其他盲目的通道等化器設計。
下面介紹一個效能判斷量，假設 df 和 dp 遠小於 1且應用泰勒級數 (Taylor’s 
series)  0n
n
j
n!
)(j
e
 ，則偏移矩陣的均方差可以近似如下：
),)MSE(232(
6
))MSE(4(
}||{||)MSE(
23222
2
F
dd
T
NM
pN-MNNM-NM
M
fπNM
-E


 
 11TT
(5.34)
其中 }min{},max{ M, NNM, NM   另外， F|||| 表示 Frobenius norm。 而且(5.34)
經由數值模擬顯示會是個好的效能統計量。
QR-分解方式的 MMSE偵測的複雜度不需做反矩陣運算，相較於傳統ZF 或
MMSE，可大幅降低計算複雜度。
模擬結果
底下我們使用 (6, 6) MIMO 當作模擬環境，其中 (M, N) 代表M 個接收天線
和 N 個傳送天線。在傳送端，未編碼的資料信號經 BPSK調變後一BLAST規則
分配置 N個傳送天線。通道矩陣 H 的每個單元依循獨立相同的CN(0,1) 機率分
布並附加白高斯雜訊。在接收端，遞迴式的VBLAST 偵測機制運作如圖5.1所示。
因為假設接收端知道完整的通道資訊，通道單元的高斯分佈假設僅是為了模擬
方便又不失其一般性。
圖5.5顯示在假定沒有頻率偏移情況下，我們的作法(turbo-MMSE-SIC)的優異
性。
loopbackI 從 0 變化到 5。由圖5.5可得，迴授式消除干擾可以獲致顯著的效能
提升，例如：提出的作法在遞迴參數
loopbackI 設成 5 時， 位元錯誤率 -310eP 基
準下，相較ZF-SIC 機制 [8]可以節省SNR大約 2.5 dB， 而且隨著SNR增加，效
88
圖5.6、 頻率偏移( 0.05df 及 0.05dp )下，(6, 6) BPSK EXT-ZF-SIC、
turbo-MMSE-SIC 和sorted-MMSE 系統的效能比較
圖5.7，我們設定估計和補償機制的收斂係數 1/4 pf  ，迴圈頻率增益 0.2fg
及迴圈相位增益 0.1pg 。從圖所示，當補償啟動時，MMSE-SIC 的位元錯誤率
可達到 -310eP 在大約SNR=16 dB時；相對地，補償未啟動時，SNR過了30 dB，
尚無法達到 -310eP 。
90
圖5.8、 tubo-MMSE-SIC BLAST 補償機制啟動與否的MSE效能表現
在圖5.9，我們模擬了不同傳送/接收天線數目下的錯誤率分佈(偏移設定、收斂
係數及迴圈增益值，皆同圖5.7設定)。此圖展示了習知的多功增益與差異增益間
的取捨(trade-off)。圖5.9中，(4, 6) 系統有著同(6, 6) 系統的多功增益但面臨極差
的BER效能表現；然而，(6, 4) 系統犧牲部份多功增益而享有較好的BER效能表
現。
92
結論
這篇報告，第一部份我們提出一個智慧型切換機制來結合CFO和SFO補償器。
透過效能分析及模擬驗證，相較傳統平行作法，這個切換機制可獲致相當的效能
表現並省卻許多的硬體複雜度。並提出一個簡易的判斷量作為校能比較的參考，
模擬結果得出這個判斷量是準確的而且相較直接計算錯誤率更簡易。
第二部分，我們在MIMO BLAST系統中，提出了聯合信號偵測與偏移估計的機
制。 額外增加的遞迴動作可降低錯誤傳播，而在遞迴中加進估計/補償機制可準
確估量偏移量並補償之。最後，這個聯合做法所增加的複雜度經由分析是可容忍
的。
6 A Study on Frame Format Using Orthogonal Frequency Division Multiplexing
techniques in High-Speed Train Environment
引言
在高速移動的環境下，尤其是當移動速度到了 300 km/h 甚至更快時，通訊
便成為了一個難題。以目前 GSM (Global System for Mobile Communication) 為
例，規格上所能達到的最高移動速度為 250 km/h，已不足以在高速移動的環境中
應用，更不用說原本即設計在室內環境中使用的 802.11a/b/g 規格了。即使是針
對移動環境而提出的 802.11a/RA，在高速的環境下也面臨了效率不佳的問題。但
是當我們考慮在高速鐵路上提供乘客多媒體通訊服務時，由於高速鐵路行經的路
徑及列車的速度均具可預測性，因此，配合隨鐵路架設的硬體設施，我們就能夠
針對此特殊環境設計一套適用於此環境的通訊系統。本研究所著重的部分即為針
對高速鐵路上特殊環境的分析，考慮使用者對頻寬的需求，我們將著重於應用於
94
此種架構的優點為整個車廂內的使用者可經由一個匯合的無線通道與車廂
外的基地台連線，可以大幅減少信令負載，且換手過程也簡化為僅剩下集中器本
身對車廂外的基地台。考慮到額外加上的集中器等架構盡量不影響原有的系統運
作，列車上匯合鏈結（Trunked link）對原本的系統（以 MOSTRAIN 為例，即為
UMTS 系統），必須是透明的（Transparent）。在列車外基地台的涵蓋範圍方面，
圖 6.1 中所示的由一個邏輯基地台加上多個收發機（Transceiver）的架構，不但
沒有基地台間換手（Handoff）頻繁的問題，亦沒有頻率規畫問題，可以讓所有
的收發機均使用相同頻率，在列車通過收發機時再切換至適當的收發機即可。
本研究將使用 OFDM 技術建立列車車廂及車廂外基地台間的無線連結，目
標在於提供一個頻寬至少 20 Mbps 之匯合無線通道。經由模擬的方式，我們驗證
了 IEEE 802.11a/g 無線區域網路的系統參數在高速鐵路環境下的可適用性，並對
高速移動所造成的通道同調時間縮短問題提出了頁框格式的修改方案，更進一步
地，我們也針對高速移動的環境提出了合適的頁框格式。經由模擬驗證同時，我
們不但證實了所提出頁框格式在高速鐵路環境下的良好表現，也成功的減少了解
調時所需的運算複雜度，對於應用於高速鐵路的無線通訊問題，本研究提出了一
個可行的解決方案。
結果與討論
1. 高速移動環境下正交分頻多工系統的分析
在高速鐵路環境下的通訊方面，已有將 GSM 通道模型套用至高速鐵路環境
的嘗試[31]，原有的 GSM 規格中所制定的可工作範圍最高速度為 250 km/h，[31]
的作者針對速度為 500 km/h 的高速鐵路環境進行了實際的量測與模擬。在大部
分的鐵路環境下，無線通道均存在直視波，相較於一般無線通道的 Rayleigh 通
道，鐵路環境為較強的 Rician 通道。在通道模型方面，[31]的作者建議以 GSM
96
而在時域方面，都卜勒效應造成的時變通道通常以同調時間（Coherence
time）描述其性質。我們通常經由(6.4)的經驗公式描述通道的同調時間
[33]。
2
9 0.423
16c D D
T
f f
  （6.4）
其中 Df 為都卜勒效應造成的頻移。
在移動速度為 300 km/h 下，我們將 OFDM 系統受高速移動環境的影響
繪製成圖 6.2。圖中左方的縱軸所對應的是以圓形為標記的曲線，右方的縱
軸則為以菱形為標記的曲線。
0 1 2 3 4 5 6
x 10-6
10-5
10-4
10-3
10-2
10-1
S
N
R
Lo
ss
(d
B
)
101
102
103
104
N
o.
of
O
F
D
M
S
ym
bo
ls
C
on
ta
in
ed
in
T
en
th
of
C
oh
er
en
ce
T
im
e
Endurable Delay Spread (sec)
Effects of Different OFDM System Parameters @ 300 km/h
RA TU
802.11a/g 802.11a/RA
圖 6.2 OFDM系統受高速環境的影響
98
的，且由都卜勒效應所產生的 ICI 所造成的影響是可以被忽略的。
2. 802.11頁框格式在高速鐵路環境下系統效能之改進
由於 802.11 原本是為了靜止環境，如室內或是定點下的無線區域網路標準，
因此，在 802.11 的頁框格式中，均假設通道在傳送整個頁框的時間裡為非時變
通道，而通道估測則由每個頁框前的前導（Preamble）所得。由於高速移動環境
所造成的都卜勒效應會造成通道的時變現象，使得通道的同調時間縮短，此時便
限制了通道估測值的有效時間，隨著頁框長度增加，位元錯誤率也將會隨之上升。
針對此問題，可以經由資料驅動（Data-driven）方式對通道估測值進行更新
[34][35]來解決。此方式利用已解調出的資料，將此資料重新加以調變，並利用
此未經通道破壞之重新調變過的符碼進行通道估測。系統架構如圖 6.4 所示。
圖 6.4 以資料驅動方式更新通道估測值之傳送機及接收機方塊圖[34]
與標準的 802.11a/g 的通道估測方式相較，圖 6.4 中的資料驅動方式能夠有
100
Preamble
Long Training
Sequence
Data Data Data Data
64
Point
FFT
Data Data Data
...
...
...
...
...
...
...
...
...
...
12 Symbols
Update CE of subcarrier No. 1
to No. 13
Update CE of subcarrier No. 14
to No. 26
圖 6.6 Pilot Rotation示意圖
輔以圖 6.7 的通道估測流程，我們結合導引次載波所得的通道估測與基於資
料驅動方式的通道估測，讓無論是低 SNR 或是高 SNR 時，均可達到最好的通道
估測結果。
102
0 5 10 15 20 25 30
10-7
10-6
10-5
10-4
10-3
10-2
10-1
100
SNR (dB)
B
E
R
Performance Comparison between Different CE Updating Algorithms
Short Frame (6 OFDM Symbols)
Averaging 4 CE Symbols
Averaging 8 CE Symbols w/ Detection
Proposed Method
圖 6.8 提出的方法與已有的解決方案的比較
3. 適用於高速鐵路環境的頁框格式設計
針對高速鐵路下通道的特性，我們設計了一套適用的頁框格式。這套頁框格
式的目標在於：
1. 低複雜度：由於在第二部分所提出的解決辦法中，通道估測除了在前導
（Preamble）部分外，完全仰賴資料驅動方式，因此，在專為高速移動
而設計的頁框格式中，我們將盡量減少重新調變的次數，減少接收機的
複雜度。
2. 高頻譜效率：雖然改善通道估測值精確度最簡單的方式就是增加已知的
導引載波或是訓練符碼（Training symbol），但是必然導致頻譜效率的降
低。我們將以增加最少量的訓練符碼的前提下，設計出適用於高速環境
的頁框格式。
104
,0mˆH ,9mˆH
(a) Picoframe #1
,9 1mˆ kH 
,10 1mˆ kH 
(b) Picoframe #k（k為奇數）
,10 1mˆ kH  ,10 10mˆ kH 
(c) Picoframe #k（k為偶數）
圖 6.11 位於不同位置微頁框的通道估測法
圖 6.11(a)中，通道估測經由平均二個符碼長的 Preamble 取得，(b)則是
經由平均上一個微頁框的訓練符碼及微頁框間的訓練符碼取得，(c)則
完全經由微頁框中的訓練符碼取得。
Step 2 使用 Step 1取得的通道估測值解調訓練符碼旁的資料符碼
在上一個步驟中，我們經由已知的前導或是訓練符碼取得了通道估測
值，接下來進行訓練符碼旁資料符碼的解調，如圖 6.12 所示。
106
下標。
此處我們採用另一種線性內插的權重計算方式，每一個符碼根據其在微
頁框中的位置，根據 Hanning window 的係數決定 1Hˆ 及 8Hˆ 的權重分配，
長度為n的 Hanning window 的定義如(6.6)。
 1 0.5 1 cos 2 0,1,2,..., 1
1
k
w k k n
n
          
（6.6）
我們以 ˆfrontH 及
ˆ
rearH 處為 Hanning window 的中心點，決定中間六個符碼
的通道估測值，如(6.7)。
  ˆ ˆ ˆm front rearH w n m H w m H   （6.7）
在我們的頁框格式中一次以一個微頁框為內插的處理單元， 13n ， 6m ，
ˆ
frontH 及
ˆ
rearH 則分別為此微頁框前後訓練符碼所得的通道估測值。模擬結果如圖
6.14 所示。
108
在系統的架構方面，我們採用雙鏈的架構，雙鏈的架構在天線及信號處理能
力方面，以列車本身搭載集中器等，對車廂內的使用者提供一個匯合（Trunking）
連線為例，此時在列車上具有較大的空間可以搭載如陣列天線等，而在車廂內則
可經由現有的 802.11 無線網路或是乙太網路（Ethernet）來提供服務。而在基地
台間的換手方面，以減少信令負載方面而言，選擇切換方式較佳。
在高速鐵路環境通道模型的建立方面，由於直視路徑的存在，再加上台灣高
速鐵路行經的區域多為高架路段或是鄉間，因此，我們以 COST 259 RA 通道模
型作為主要考慮的通道模型。我們也探討了 OFDM 系統各項時域參數的選擇在
高速下所受的影響，在高速移動所造成的都卜勒效應方面，主要將造成 OFDM
系統各次載波間的干擾（Inter-Carrier Interference; ICI）及通道同調時間的縮短，
前者使得有效信噪比下降，後者則造成通道估測上的困難。在無線通道的多路徑
干擾方面，為了不使符碼間干擾（Inter-Symbol Interference; ISI）產生，限制了
OFDM 系統中符碼時間的長度。
而 802.11a/g 系統的頁框格式應用在高速下的問題主要源自於規格中對通道
狀態在整個頁框中維持不變的假設。在高速鐵路的環境下，縮短的通道同調時間
使得通道估測必須隨時間而改變，因此，我們討論的重點主要是在不大幅更動
802.11a/g 頁框格式下的改進。經由結合資料驅動技術與導引載波的安排，我們
讓通道估測值可以在頁框的傳輸過程中更新，使得通道的同調時間不再成為頁框
長度的限制。
最後，我們設計出針對高速環境下適用的頁框格式。利用周期性的訓練符碼
（Training symbol）、編碼區塊（Coding block）的設計以及資料驅動的技術，我
們成功地減少了單純採用資料驅動方式的運算複雜度。另外，實作可行性方面，
我們也採用了與 802.11a/g 相同的前置（Preamble），使得 802.11a/g 規格中的載
波／符碼同步均可幾乎不經修改直接套用，大大增加了實作上的可行性。
110
的優異表現[34]，我們試著將渦輪等化器放在高速移動環境。而為了應付時變通
道的問題，我們需要加入通道估測(Channel Estimation)的機制，即時更新我們需
要的通道資訊。而車廂遮蔽的問題，也會讓我們思考用戶是否一定要直接與車窗
外的基地台建立連結(Link)。在本篇報告中，我們使用的系統架構為雙連結
(two-link)。基本上，所有移動速度的效應全都集中在車廂基地台到外部基地台的
連結上，而本篇報告目標就是要提供這條連結可用的物理層(physical layer)。
由於我們探討的是等化的部分，故我們假設有一個同調(coherent)且處理間
隔為一個符碼(symbol-spaced)的接收機前端(receiver front-end)，在對信號相位與
符碼同步均有足夠資訊的情況下，通道可近似成一離散時間線性濾波器，其有限
長度脈衝響應(finite-length impulse response)為
1
,
0
[ ] [ ]
L
k n
k
h n h n k


  (7.1)
其中 L 為通道長度。
不過，列車若要達到平均時速三百公里以上，則行駛路線大部分應該都在平
坦地區。若利用[35]的觀念，沿著軌道建立基地台，對系統而言，通道一直都存
在直視波路徑！這讓我們可以用 COST 259 Rural Area(RA)[36]來模擬通道環境。
另外，由於鐵道路徑的可預測性，在鐵道鋪設完畢後，經由實地測量，我們
應能掌握每段行駛區間內信號最長的延遲時間，如此一來配合已知的符碼時間，
通道長度便可視為已知。故本文的電腦模擬中都把通道長度 L 視為已知。
圖 7.1. 傳送端的架構
傳送端架構如圖 7.1。每 K 個資料位元編成一個區塊(block)送進編碼率(code
rate)為1 2的迴旋編碼器，接著為了抵抗傳送時有可能發生的長時間衰減(相對於
112
CIR。我們使用如圖 7.3 的框架格式(frame format)。

圖 7.3. 框架格式
前導訊號(Preamble)作為框架的開頭，包含了已知的符碼序列。再來是一段
資料符碼(Data)，其長度則須視通道的同調時間[33]來決定。我們的設計是希望
在傳資料符碼的時間裡通道均可視為非時變。跟著的是拿來作通道估測的訓練序
列(Training Segment)。如此資料符碼與訓練序列互相間隔，以確保在每段傳送資
料符碼的時間內，接收端對於 CIR 都有充分的掌握，以順利進行等化的工作。
接收端的通道估測可用圖 7.4 描述。其中 x是我們的傳輸的訓練序列， y 則是接
收端觀測到的通道值。我們的目標就是調整 *( )kw (即 ( )kh )使得 ( )y k 與 (ˆ )y k 的差
( )e k 為最小。我們選擇的方法是遞迴最小平方(Recursive Least Square, RLS)演算
法。
圖 7.4. 通道估測的示意圖
主要的結果和討論
A. 渦輪等化器在高速移動環境下的可行性分析
我們根據圖 7.2 的架構，對整個系統進行電腦模擬分析。從傳送端開始描述，
我們設定一個區塊包含有 2048K bits ； Recursive Systematic Convolutional
(RSC) encoder 如式(7.3)；interleaver 是 nonuniform interleaving；調變方式先從
BPSK 開始；框架格式中，前導包含 100 個符碼，資料區塊包含 32 個符碼，每
段訓練序列包含 64 個符碼；有關 COST 259 RA 的部分，我們設定符碼時間為
114
B. 渦輪等化器在高速移動環境下有效資料傳輸率提升之研究
進一步來分析有效資料傳輸率的表示式
  
2048 1
4096
4096100
s
TrainingSegment
Dat
T
q
q a
 
 
 
有效資料傳輸率
一個區塊所含的資料位元數目 1
傳送一個區塊的資料位元所需的符碼數目 符碼時間
(7.4)
由(7.4)我們可以發現有效資料傳輸率是由三個變數所掌控的，即調變方式、
符碼時間以及框架格式等三個方向。我們先提高調變等級，圖 7.6 是我們提高調
變方式到 16QAM[36]時 BER 對 SNR 的表現。我們發現，渦輪等化器只需要 7.2dB
左右的 SNR，經過四次疊代就能達到 10-4 等級的 BER。此時的有效資料傳輸率
為1.6 / secMbits ，還是不夠我們影音的應用。所以接下來我們要嘗試縮短符碼時
間來提升有效資料傳輸率。
圖 7.6. 在 16QAM 調變下系統 BER 對 SNR 的表現
縮短符號時間主要會付出兩個代價，一個是付出更多的頻寬，一個是加重 ISI
的效應。頻寬的問題以我們鐵路的應用來講比較不嚴重，因為整個系統規劃上就
是只給火車使用的。比較麻煩的問題是隨著符碼時間的縮短，受 ISI 影響的符碼
會變得更多。我們試著將符碼時間縮短到0.1 s，渦輪等化器的表現如圖 7.7。渦
輪等化器還是能在經過五次疊代後，在 SNR=8dB 時達到 3×10-5 等級的 BER。此
時的有效資料傳輸率已達 6.4Mbps。
116
圖 7.8(a)是 BER 對訓練序列長度作圖的結果。可以看到在訓練序列長度達到
八個符碼之後，BER 的收斂值就不會因為訓練序列長度再加長而有明顯的下降，
所以我們將訓練序列長度定為八個符碼。
接下來我們對資料符碼區段作適度的延長。一樣設定 SNR 為 8dB，框架格
式中前導包含 100 個符碼，每段訓練序列包含 8 個符碼，每段資料區塊包含的符
碼數目為可變。圖 7.8(b)是 BER 對資料符碼區段長度作圖。可以發現資料符碼
區超過 64 個符碼之後，渦輪等化的效果就會因為通道資訊在資料符碼區段長度
內不能視為非時變而大打折扣。在不對 BER 發生重大影響的前提下，我們將資
料符碼區段長度定為 64 個符碼。
綜合以上討論得出的訓練序列長度與資料符碼區段長度，現在車廂的有效傳
輸率為
6
2048 1
4096 0.1 10
40964100 8
( )
( )
( )
64 4
/ sec
( ) ( )
16
Useful Data Rate
Mbits
  
  

一個框架所含的資料位元
符碼時間
前導 訓練序列符碼 資料符碼
16Mbps 已可以應付每位乘客(每人 400Kbps)網路瀏覽的需求。若只有一半的
人要收看線上節目，則 16Mbps 也可符合需求。因此有關於有效資料傳輸率的問
題就討論到此，接下來我們要討論有關複雜度的問題。
C. 渦輪等化器在高速移動環境下複雜度之研究
我們估計複雜度的方法是直接檢查演算法的數學式，以此來計數所需要的實
數加法、實數乘法、實數比較、求絕對值的次數等等。我們假設使用德州儀器的
數位訊號處理器(Digital Signal Processor, DSP)， TMS320C6416T-1000，其 cycle
time 為 1ns，實數乘法要 4 cycles，實數加法要 1 cycles。要注意到我們的討論僅
限於硬體延遲時間，我們並沒有討論到有關所需的記憶體空間。
以圖 7.2.的五大區塊來分，需要的 Cycles 數目如表 7.1
118
而簡化過的系統要有相同的表現 SNR 約在 9dB。
圖 10. (a)原系統 BER 對 SNR 的表現；(b)簡化後系統 BER 對 SNR 的表現
所以考慮硬體限制，渦輪等化器有效資料傳輸率變成
 
2048
353
322848 3 836096 4096 978752 4096 1
Kbps
ns

      
於是需要的 DSP 數目也從 356 顆降低成16 / 353 45M K  顆了！
結論
著眼於渦輪等化器在非時變多路徑衰減通道下對於 BER 有著極為出色的表
現，配合通道估測，我們將渦輪等化器應用在高速鐵路環境。我們首先確立在高
速移動環境下的渦輪等化器 SNR 的可行性，接著我們努力將有效資料傳輸率提
升至我們設定的應用服務所需的水準。最後我們以多顆 DSP 平行處理架構，為
列車與地面基地台建立了強壯(對 SNR 優異的表現)而高速率的物理連結。
8 在高速鐵路環境下可適性波束成型技術之研究
引言
高速鐵路系統近年來由於高速度、高乘載以及安全性高等因素，未來可期望
成為主要的大眾運輸交通工具。而可適性波束成型(Adaptive beamforming)技術有
擴充系統容量及消除干擾信號等優點，勢必會成為通訊系統中重要的一環，因此
120
圖 8.1 天線陣列的系統架構圖
在高速鐵路的架構方面，我們採取雙鏈架構(two-link architecture)，亦即在火
車車廂裡的使用者利用 802.11a/b/g 無線網路連接至車廂頂端的中繼站
(Repeater)，接著連接至架設在鐵路旁的地面基地台進行通訊，而使用者可以進
行語音、資訊方面等的應用。
122
圖 8.3 時域寬頻可適性波束成型器
在頻域可適性濾波器方面，將天線陣列的每根天線下接上頻域濾波器，控制
濾波器的權重(weight)，利用離散傅立葉轉換(Discrete Fourier Transform；DFT)
或者是離散餘弦轉換(Discrete Cosine Transform；DCT)，即是先將信號由時域
(Time domain)轉換至頻域(Frequency domain)，接著再利用 DFT-LMS 演算法或者
是 DCT-LMS 演算法計算權重來調整信號，再將信號轉換至時域後做可適性波束
成型。
( )y n
124
是鎖定在 UMTS 以及 HIPERLAN 的標準上，特別是強調在可適性天線(adaptive
antennas)以及方向性通道(directional channels)下的應用。在通道模型方面，我們
使用 COST 259 通道模型，裡面包含了三種環境：Rural area(RA)、Typical
Urban(TU)以及 Hilly Terrain(HT)。
Power delay profileEnviroment
Typical Urban
(TU)
Hilly Terrain
(HT)
Rural Area
(RA)
圖 8.5 COST 259 通道模型的環境以及功率延遲輪廓
利用 QR-RLS 演算法的可適性波束成型器相較於利用 LMS 演算法的可適性
波束成型器有較佳的表現，由於 QR-RLS 演算法比 LMS 演算法有較快的收斂速
度以及有較小的收斂誤差。
126
圖 8.7 時域寬頻可適性波束成型器在 TU 環境下的表現
128
圖 8.10 頻域寬頻可適性波束成型器在 HT 環境下的表現
在估測信號來源方向(DOA)方面，由於 MUSIC 演算法是根據信號的自相關
矩陣做特徵分解(eigen decomposition)來估測信號來源方向，因此多路徑衰減以及
都普勒效應而造成的估測不準確，可藉由空間平均法(Spatial Smoothing)以及
Unitary Transform 方法做補償，在估測方向的表現上皆較沒做過補償的 MUSIC
演算法好。
信號方位估測利用 Unitary MUSIC 演算法在 TU 以及 HT 環境下的表現，可
以看出在振幅響應相較於純粹使用 MUSC 演算法有很明顯的改善，而且比使用
MUSIC 加上前後向平滑演算法在振幅響應上好一點。特別注意的是，信號方位
估測利用 MUSIC 加上前後向平滑演算法在 HT 的環境下， sin 0 的位置無法
精確的判斷，但是信號方位估測利用 Unitary MUSIC 演算法， sin 0 的位置可
以判斷的較為精確。
130
圖 8.12 信號方位估測運用 Unitary MUSIC 演算法在 TU 環境下的表現
圖8.13 信號方位估測運用Unitary MUSIC演算法在HT環境下的表現
結論
本篇論文主要探討在高速鐵路環境中的可適性波束成型系統。在高移動速度
的環境下，由於通道中有多重路徑衰減(Multipath fading)以及都普勒效應(Doppler
effect)的嚴重影響，會造成可適性波束成型器(Adaptive beamformer)所形成的波束
(Beam pattern)在干擾方向零陷點的偏移以及消除干擾的凹陷程度(Notch)會減
少，因此無法有效抑制干擾信號，進而對系統的容量及通訊品質方面會有嚴重的
降低。
因此利用寬頻可適性波束成型器(Wideband adaptive beamformer)以消除多重
路徑衰減以及都普勒效應對於波束的影響，可將波束在干擾方向零陷點的偏移修
正回來，而且可以加深波束在干擾方向的凹陷程度。此外寬頻可適性波束成型器
132
服務，作為改善台灣高速鐵路的通訊品質的一個解決方案。主要探討在實體層利
用渦輪等化器（Turbo Equalization）應用於寬頻分碼多工（Wideband Code Division
Multiple Access, WCDMA）通訊系統與正交分頻多工（Orthogonal Frequency
Division Multiplexing, OFDM）通訊系統，改善在超高速移動環境下所惡化的位
元錯誤率（Bit Error Rate, BER）。
研究的問題
研究動機
在超高速移動環境下通訊系統所面臨的問題，最主要的原因即在於通道的快
速變化。通道的多重路徑所引起的符碼間干擾與在多載波通訊系統的都卜勒偏移
所引起的載波間干擾。這二個嚴重的效應，是本篇論文主要欲解決的問題。
克服通道所引起的信號失真，主要解決方法為在接收端設計等化
（Equalization）架構與演算法，以補償通道失真，使錯誤率下降，近而提升通訊
品質。而本篇論文選擇以渦輪等化器架構，抑制符碼間干擾與載波間干擾。
目前的渦輪等化器的研究，以在多重路徑非時變通道的研究居多。由多篇文
獻可發現，其效能與傳統的等化器比較有明顯的提升。本篇論文將渦輪等化器應
用在多重路徑的快速時變通道，以消除符碼間干擾與載波間干擾效應。在文獻
上，少有渦輪等化器在高速移動環境下的討論。且本篇論文又將渦輪等化器應用
於寬頻分碼多工與正交分頻多工通訊系統，此二種系統為現今主要的通訊架構，
解決實際上高速鐵路可能採用的通訊架構所面臨的通訊問題。效能上的評估，以
系統的位元錯誤率為主要比較基礎，檢視渦輪等化器應用於寬頻分碼多工與正交
分頻多工通訊系統是否可以在超高速移動環境下實現。
渦輪等化器的精神
134
且隨著疊代運算次數增加，其效能極接近使用最大事後機率等化演算法的渦輪等
化器。
aˆ
ˆ( )s b
ˆ( )sb
ˆ( )s c
ˆ( )sc
圖 9.2 使用線性等化器所架構的渦輪等化器。
在渦輪解碼器的架構下，可得知軟式資訊的傳遞可以不止一個方向。當解碼
器處理完反攪亂器輸出的軟式資訊後，對於資料位元序列便產生屬於解碼器的軟
式資訊。而解碼器輸出的軟式資訊可以再經過攪亂器後輸出至等化器。如此一
來，等化器與解碼器間便形成一個迴圈關係，此二個模組便可透過這樣的迴圈關
係，獲得彼此的軟式資訊。此迴圈結構即為渦輪等化器重要的精神。渦輪等化器
最重要的意義即等化器利用解碼器的軟式決策輸出，獲得更多可靠有用的資訊。
在相互疊代運算下交換資訊，使通訊系統的位元錯誤率收斂，而得到效能的提
升。渦輪等化器在同一信號雜訊比（Signal-to-Noise Ratio）的位元錯誤率明顯比
傳統的等化器優秀。本篇論文的基本架構是使用線性最小均方誤差等化演算法的
渦輪等化器，以降低運算複雜度。
渦輪等化器應用於寬頻分碼多工通訊系統之架構
由於超高速移動環境下造成 WCDMA 通訊系統有著更嚴重的符碼間干擾與
136
圖 9.4 時域渦輪等化器應用於正交分頻多工通訊系統的架構圖。
主要的結果和討論
渦輪等化器應用於寬頻分碼多工通訊系統在超高速移動環境下的電腦模擬
參數設定如下：
調變方式：QPSK，
碼片速率：3.84 Mcps，
錯誤控制碼：迴旋碼（1/2），
展頻碼：正交可變展頻因數碼，
展頻數：8，
框架格式：8 個訓練符碼緊鄰 56 個資料符碼依序排列，
遞迴最小平方通道估測：遺忘因子λ=0.95、節制參數δ=0.0005，
等化器總抽頭數： 1 2 1 4 2 1 7N N N     ，
通道環境：COST 259 RA，
都卜勒偏移：555 Hz。
圖 9.5 為電腦模擬結果。由圖 9.5 知，渦輪等化器應用於寬頻分碼多工通訊
系統在信號雜訊比為 4 dB 時，位元錯誤率可以達到
410。在超高速移動環境與
138
渦輪等化器之接收端與耙型接收端在超高速移動環境下的比較
傳統的 WCDMA 通訊系統接收端是使用耙型接收端。探討耙型接收端是否
適用於超高速移動環境，並與使用渦輪等化器的接收端作效能比較。
由圖 9.6 知，相同錯誤率下，使用渦輪等化器的接收端較耙型接收端在改善
將近 1 dB 的效能。現在使用 WCDMA 通訊系統的行動通訊裝置，其位元錯誤率
表現，在超高速移動環境下是比較不可行的。因此無法提供使用者完善的服務，
必須改善行動通訊裝置的接收端架構，而使用渦輪等化器是一可行的解決方案。
0 0.5 1 1.5 2 2.5 3 3.5 4
10
-5
10
-4
10
-3
10
-2
10
-1
10
0
Eb/No (dB)
B
E
R
Rake Receiver
Turbo Receiver
圖 9.6 使用渦輪等化器的接收端與耙型接收端的位元錯誤率分析比較。
提高寬頻分碼多工通訊系統的調變等級
高速下行封包存取的技術，是 3GPP 與 2002 年的 Release 5 中引入了高速下
行封包存取的技術，來作為 WCDMA 通訊系統高速資料傳輸的解決方案。除了
原始的 QPSK 調變技術之外，高速下行封包存取也使用 16QAM 調變技術。
140
0 1 2 3 4 5 6 7 8 9
10
-5
10
-4
10
-3
10
-2
10
-1
10
0
Eb/No (dB)
B
E
R
Iteration 1
Iteration 2
Iteration 3
Iteration 4
Iteration 5
圖 9.7 使用 16QAM 調變的渦輪等化器應用於寬頻分碼多工通訊系統位元錯誤
率。
時域渦輪等化器應用於正交分頻多工通訊系統電腦模擬
利用 WiMAX 中 OFDM 的相關參數，在列車的最高行車速度為每小時 300
公里進行電腦模擬，探討 WiMAX 是否能有效工作，提供使用者寬頻上網的服務。
參數設定如下：
調變方式：QPSK，
頻寬：20 MHz，
錯誤控制碼：迴旋碼（1/2），
快速傅利葉轉換點數：2048，
領航信號投資比例：1/8，
142
現行 WiMAX 的中心載波頻率操作於 2.5 GHz，由都卜勒偏移的計算公式可
知，越高頻的載波，相同移動速度下，卻有著較大的都卜勒。此結果對於現行的
WiMAX 非常不利。若能調整 WiMAX 的中心載波頻率至較低頻率的頻譜使用，
對於超高速移動環境下的 WiMAX 極有助益。
在台灣現今 700 MHz 屬於類比電視廣播頻段，但在國家通訊計劃下，有意
在 2010 年全面回收拍賣，類比電視訊號全面將由數位影像廣播（Digital Video
Broadcasting, DVB）取代。因此未來 WiMAX 能夠使用此 700 MHz 頻段，在超
高速移動環境下的都卜勒偏移為
 6
8
300 1000
700 10
60 60 194
3 10
c
D
vf
f Hz
c
       

都卜勒偏移量相較原先的 694 Hz 降低許多。相信其位元錯誤率表現可以改善不
少。
參數設定如下：
調變方式：QPSK，
頻寬：20 MHz，
錯誤控制碼：迴旋碼（1/2），
快速傅利葉轉換點數：2048，
領航信號投資比例：1/8，
循環字首：1/4，
遞迴最小平方通道估測：遺忘因子λ=0.95、節制參數δ=0.0005，
等化器總抽頭數： 1 2 1 4 2 1 7N N N     ，
通道環境：COST 259 RA，
都卜勒偏移：194 Hz。
144
級，將有效資料傳輸速率再增加，研究其位元錯誤率是否在可接受的範圍。
參數設定如下：
調變方式：16QAM，
頻寬：20 MHz，
錯誤控制碼：迴旋碼（1/2），
快速傅利葉轉換點數：2048，
領航信號投資比例：1/8，
循環字首：1/4，
遞迴最小平方通道估測：遺忘因子λ=0.95、節制參數δ=0.0005，
等化器總抽頭數： 1 2 1 4 2 1 7N N N     ，
通道環境：COST 259 RA，
都卜勒偏移：194 Hz。
觀察圖 9.10，其位元錯誤率表現是在可以接受的範圍，但並不理想。調變等
級的提升引起的符碼間干擾與載波間干擾會較嚴重，因此位元錯誤率的升高是可
以理解的。
有效資料傳輸速率
=
  6 7 120 10 4
8 2
      
=35 Mbps
這樣的資料傳輸速率對於影音多媒體服務是沒有問題的，的確能服務極多數
使用者同時使用網路的需求
146
本篇論文亦提出在 OFDM 系統接收端的時域上實現渦輪等化器，可以減少
通道估測在經過快速傅利葉轉換資訊的失真與線性最小均方誤差等化演算法的
正確性。但快速傅立葉轉換點數為 2048 的正交分頻多工通訊系統利用時域渦輪
等化器架構，其位元錯誤率表現非常不理想。最主要的原因即是嚴重的載波間干
擾，正規化都卜勒偏移計算後有 0.089 之高，遠大於 0.02。且由於 WiMAX 載波
中心頻率操作於 2.5 GHz，即使低速的移動速度也會造成都卜勒偏移量非常大。
也代表了在現行的台灣高速鐵路環境使用 WiMAX 通訊系統，是無法提供令人滿
意的通訊。但是若未來政府釋放 700 MHz 的頻段，根據電腦模擬載波中心頻率
位於 700 MHz 時，使用時域渦輪等化器應用於正交分頻多工通訊系統可以將位
元錯誤率大幅下降。每一列的 83 位使用者至少可以共享 17.5 Mbps 的資料傳輸
速率，極為可觀的傳輸量，對台灣高速鐵路的寬頻上網服務是一大助益。
本篇論文提出渦輪等化器應用於 WCDMA 與 OFDM 系統的架構，的確改善
了在超高速移動環境下的效能表現。且電腦模擬的實體層參數設定皆符合
WCDMA 與 WiMAX 的商用規格，更符合實際應用的結果。而由電腦模擬結果
得知，觀察位元錯誤率的表現後，WCDMA 較 WiMAX 更適合在超高速移動下
的使用。因為 OFDM 在超高速移動下，不僅面臨符碼間干擾，更有其多載波調
變所帶來嚴重的載波間干擾。但是 WCDMA 的資料傳輸速率在使用者增多後，
會有顯著的下降。列車並不會皆以每小時 300 公里的行車速度行駛，台灣高速鐵
路的台北至高雄直達列車，需時 1 小時 36 分，換算為平均行車速度大約為每小
時 200 公里。因此在某些路段的狀況是可以使用 WiMAX 提供較大的傳輸速率。
若是設計接收端可以處理 WCDMA 與 WiMAX 的信號，即雙模架構，則可以依
列車的行車速度與信號品質，在 WCDMA 與 WiMAX 切換使用，讓使用者有良
好的傳輸品質。
148
決定一個無線系統模擬的效能表現分析的有效性，是取決於對通道是否進行
精確且實用的模型建構，因此我們必須考慮對整個系統影響最大的因素。在蜂巢
式無線通訊系統中，其效能受到同頻道干擾（Cochannel Interference）及訊號衰
減行為的影響甚鉅，因此我們考慮這二個效應，以期能建構出效能最高的系統。
我們希望在 WiMAX 802.16e 的環境下建構出一個具備最高的資料傳輸速率的
系統，也希望能夠服務高移動速度的用戶，因此我們考慮複合式系統：802.16e
與 802.16j 共構的系統。802.16j 價值在於能夠提高系統的資料傳輸速率（Data
Rate），而 802.16e 可以降低換手（Handoff）的機率改善通訊品質，所以我們
希望藉由本篇論文以找出最佳的系統設定參數。
相較於其他的傳播模型，Walfish-Ikegami Model 是適合用在較小的細胞，且
IEEE 802.16e Task Group 在 802.16e 的標準中推薦使用它在微型細胞環境中模型
建構。
在無線通訊蜂巢式系統（Cellular wireless communication system）為了在有
限的頻譜中增加使用者的容量，頻道必須重複使用，是為同頻（Co-channel），
也因此出現所謂的同頻道干擾（Co-channel Interference）的問題。重複使用頻率
的距離越短則接收信號強度越佳，但易受干擾；反之距離越長較不易受到干擾，
但相對的，通訊品質便隨之下降，所以必須取得兩者的平衡點。
我們考慮一個均勻分佈的六邊形細胞，基地台（Base Station）使用全向天線
（Unidirectional Antenna），假設忽略多路徑衰減（Multipath Decay）與遮蔽效
應（Shadowing Effect），每個細胞（Cell）的大小皆相同，並使用上一節所提及
的 Walfish-Ikegami Model 的路徑損耗模型。在一個干擾有限的環境下，相較於
干擾的功率，背景雜訊的功率可被忽略，所以使用接收 SIR 取代 SINR，假設具
有 N 個同通道干擾的細胞則使用者的 SIR 可表示為
150
3D N
R

在 IEEE 802.16e 的規格書（Standard）中明確規範欲使用每種調變技術必須
達到其規定的 SIR，下表為 802.16e 規格書中各個調變技術所須達到的 SIR
Modulation Coding rate SNR(dB)
BPSK ½ 3.0
QPSK
½
¾
6.0
8.5
16-QAM
½
¾
11.5
15.0
64-QAM
2/3
3/4
19.0
21.0
表 10.1 WiMAX定義之調變技術所需最小SNR (Andrews)
假設在一個細胞（細胞）內用戶端接收訊號的 SNR 皆大於 21.0 dB 亦即可
使用任何的調變技術。我們先求出 OFDM Duration，再算出不同的調變技術在具
有不同的頻寬下所擁有的資料傳送速率。
結果如下表所示
QPSK QPSK 16-QAM 16-QAM 64-QAM 64-QAM
Code
Rate
BW
1/2 3/4 1/2 3/4 2/3 3/4
152
域，因此我們得到了每種調變技術適合發射的區域佔整個細胞的比例，如下表。
MOD.
N
BPSK
1/2
QPSK
1/2 3/4
16-QAM
1/2 3/4
64QAM
2/3 3/4
3 0.5775 0.2289 0.1207 0.0504 0.0176 0.0024 0.0025
4 0.2431 0.4088 0.196 0.1121 0.03 0.0019 0.0081
7 0.5239 0.3861 0.0611 0.0145 0.0144
12 0.6279 0.2821 0.0459 0.0441
表 10.4 各個調變技術所能發射佔細胞的面積比例 單位：%
我們考慮符合台灣系統廠商所使用的頻寬，目前分配給廠商之總頻寬為
30MHz，在容量計算上以 1.25 MHz 為單位故可使用的頻寬為 1.25 MHz、5 MHz
與 10 MHz 為其標準。 我們將 2.3 節計算出的使用不同調變技術及不同頻寬下所
得到的資料傳送速率乘上其佔整個細胞區域的面積比例，即可得到下列表格 ，
capacity 行為整體的資料傳送速率。
 i i
i
capacity f bps 
其中 if 為該調變技術所能發射佔細胞的面積比例。( )ibps 為該調變技術所擁
有之資料傳送速率。
BW BPSK QPSK QPSK 16QAM 16QAM 64QAM 64QAM capacity
1.25 MHz 0.202 0.16 0.127 0.0706 0.037 0.00672 0.0079 0.61
5MHz 1.01 0.801 0.634 0.353 0.185 0.034 0.094 3.1
10MHz 2.02 1.6 1.27 0.706 0.37 0.067 0.079 6.1
表 10.1 當同頻率重覆使用因子N=3時得到之結果
154
本研究採用多層次系統（Multilayer System）的概念 (Chin, Chang, & Huang,
1997)，分為802.16e與802.16j之二階層系統，概念圖如下圖所示。當有一細胞
（Cell）分配有 S 個通道，這些通道是用於服務來自細胞內的用戶與來自相鄰細
胞的有換手需求之用戶。由於要提供完全無誤的模型是相當困難的，在此我們做
了一些假設，以便產生一個近似的模型：
 假設同階層的所有細胞都是相同。
 假設所有的用戶是均勻分佈（Uniform Distribution）在細胞內。
 各用戶端的移動速度分為高移動速度或低移動速度。
 各用戶端在隨機方向移動。
 須換手通訊的機率為h。
 發話、換手通話與結束通話的優先順序一樣。
圖10.1 二階層系統示意圖
156
決定「新通話進來」（New Call Arrival）、「換手要求」（Handoff Asking）、
「通話結束」（Call Termination）與「無動作」（Do nothing）。當「新通話進
來」時，基地台會先判斷該通話為低移動速度用戶亦或是高移動速度用戶，
若為前者則由其服務，若此時基地台沒有資源可供連線則不接受該通話
（Call Blocking）；若為後者則轉介到802.16e 細胞中由其基地台服務，若此
時基地台沒有資源可供連線則不接受該通話（Call Blocking）。若有通話中用
戶發出「換手要求」，則會先詢問換手目的地細胞之基地台（為802.16j 之細
胞）是否足夠資源可容納該換手通話，若其無足夠資源則產生換手失敗
（Handoff Failed）結果。若為「通話結束」（Call Termination）則結束該通
話並釋放其所使用之資源。「無動作」則表示沒有新通話、既有之通話無換
手要求且繼續通話。
我們定義四個評量系統效能的指標：
 資源使用率（Utilization）
Used Resource
Utilization
Total Resource

 呼叫阻隔率（Call Blocking Rate）
no. of calls rejected by the BS
CCR
no. of arrival callls

 換手失敗率（Handoff Failure Rate）
no. of calls which failed to HO
HFR
no. of arrival callls

 通話成功率（Call completion Rate）
no. of completed calls
CCR
no. of incoming callls

158
去的用戶overflow回來，因為如此一來只是徒增換手的次數，實質上並無任何助
益。
演算法（Algorithm）
 802.16e 細胞演算法
決定「新通話進來」（New Call Arrival）、「換手要求」（Handoff Asking）、
「通話結束」（Call Termination）與「無動作」（Do nothing）。當「新通話進
來」時，基地台會先判斷該通話為高移動速度用戶亦或是低移動速度用戶，
若為前者則由其服務，若此時基地台沒有資源可供連線則不接受該通話
（Call Blocking）；若為後者則轉介到802.16j 細胞中由其基地台服務，若此
時基地台沒有資源可供連線則不接受該通話（Call Blocking），在此我們假設
所低移動速度之用戶恰在我們選擇之802.16j 細胞裡。若有某通話中用戶發
出「換手要求」，則會先詢問換手目的地細胞之基地台是否足夠資源可容納
該換手通話，若無則產生換手失敗（Handoff Failed）結果，overflow策略僅
用在802.16j 將通話overflow至802.16e中。若有某通話中用戶要求「通話結
束」（Call Termination）則結束該通話並釋放其所使用之資源。「無動作」則
表示沒有用戶要求通話、既有之用戶的通話無換手要求且繼續通話。
 802.16j 細胞演算法
決定「新通話進來」（New Call Arrival）、「換手要求」（Handoff Asking）、
「通話結束」（Call Termination）與「無動作」（Do nothing）。當「新通話進
來」時，基地台會先判斷該通話為低移動速度用戶亦或是高移動速度用戶，
若為前者則由其服務，若此時基地台沒有資源可供連線則不接受該通話
（Call Blocking）；若為後者則轉介到802.16e 細胞中由其基地台服務，若此
160
「通話結束」（Call Termination）與「無動作」（Do nothing）。當「新通話進
來」時，基地台會新判斷該通話為高移動速度用戶亦或是低移動速度用戶，
若為前者則由其服務，若此時基地台沒有資源可供連線則不接受該通話
（Call Blocking）；若為後者則轉介到802.16j 細胞中由其基地台服務，若此
時基地台沒有資源可供連線則不接受該通話（Call Blocking），在此我們假設
所低移動速度之用戶恰在我們選擇之802.16j 細胞裡。若有某通話中用戶發
出「換手要求」，則會先詢問換手目的地細胞之基地台是否足夠資源可容納
該換手通話，若其一般資源不足以提供換手通話，則再次詢問其保留之資源
是否足夠，這即為資源保留之概念，亦即換手通話較新通話擁有較高之資源
使用權。若其基地台無足夠資源則產生換手失敗（Handoff Failed）結果。若
有某通話中用戶要求「通話結束」（Call Termination）則結束該通話並釋放
其所使用之資源。「無動作」則表示沒有用戶要求通話、既有之用戶的通話
無換手要求且繼續通話。
 802.16j 細胞演算法
決定「新通話進來」（New Call Arrival）、「換手要求」（Handoff Asking）、
「通話結束」（Call Termination）與「無動作」（Do nothing）。當「新通話進
來」時，基地台會新判斷該通話為低移動速度用戶亦或是高移動速度用戶，
若為前者則由其服務，若此時基地台沒有資源可供連線則不接受該通話
（Call Blocking）；若為後者則轉介到802.16e 細胞中由其基地台服務，若此
時基地台沒有資源可供連線則不接受該通話（Call Blocking）。若有某通話中
用戶發出「換手要求」，則會先詢問換手目的地細胞之基地台是否足夠資源
可容納該換手通話，若其一般資源不足以提供換手通話，則再次詢問其保留
之資源是否足夠，為資源保留之概念。若其基地台無足夠資源則產生換手失
敗（Handoff Failed）結果。若有某通話中用戶要求「通話結束」（Call
162
 802.16j 細胞演算法
決定「新通話進來」（New Call Arrival）、「換手要求」（Handoff Asking）、
「通話結束」（Call Termination）與「無動作」（Do nothing）。當「新通話進
來」時，基地台會新判斷該通話為低移動速度用戶亦或是高移動速度用戶，
若為前者則由其服務，若此時基地台沒有資源可供連線則不接受該通話
（Call Blocking）；若為後者則轉介到802.16e 細胞中由其基地台服務，若此
時基地台沒有資源可供連線則不接受該通話（Call Blocking）。若有某通話中
用戶發出「換手要求」，則會先詢問換手目的地細胞之基地台是否足夠資源
可容納該換手通話，若其資源不足以提供換手通話，則啟動overflow機制，
詢問上層之802.16e細胞之基地台其保留之資源是否足夠，若足夠則overflow
至該802.16e 細胞中，若無足夠資源則產生換手失敗（Handoff Failed）結果。
若有某通話中用戶要求「通話結束」（Call Termination）則結束該通話並釋
放其所使用之資源。「無動作」則表示沒有用戶要求通話、既有之用戶的通
話無換手要求且繼續通話。
圖10.2 混合式略策系統資源使用率模擬圖（802.16e）
164
802.16j 的效能是本模擬系統的瓶頸，當值增加至0.01後呼叫阻隔率已大幅上
升至近0.3，意即平均每10通通話呼叫中，三通會被系統拒絕，相當驚人。
圖10.5 混合式略策系統呼叫阻隔率模擬圖（16j）
採用混合式策略最大的優點在於可維持相當水準之換手失敗率，即便是皆是
值增至 0.02 還是能維持在 0.05 以下。
雖然 802.16e 的換手失敗率在值增加至 0.02 時會上升至 0.05 左右，但
802.16j 的換手失敗率表現優於使用其他策略。
圖10.6 混合式略策系統換手失敗率模擬圖（16e）
166
圖10.9 混合式略策系統通話完成率模擬圖（16j）
本節依據上一節二種策略的優缺點修正為混合式策略，確實能達到第三章小
結的目的，可有效地改善其所提到之問題，亦即802.16j細胞效能不彰之情事。
在本論文中，我們採計了四種評量系統的指標，分別是資源使用率
（Utilization）、通話阻隔率（Call Blocking Rate）、換手失敗率（Handoff Failure
Rate）與通話成功率（Call completion Rate）。分別看這四個指標是無意義，例如
我們只考慮資源使用率，可能會有高資源使用率但其換手失敗率高的系統，用戶
通話常常中斷，這不是一個好的無線通訊系統。因此我們需要全方位來評量一個
系統。本章提出之混合式策略可以有效改善系統的效能，將來若搭配所謂的動態
資源管理，私以為效能會更加優異。
混合式策略結合了Overflow與 Channel Reservation策略的優點，可有效提高
系統效能，其中保留資源方式是採固定式，顯然不符合經濟效益，因為保留的資
源僅提供給欲換手需求的通話，若是處在高新通話要求率（New Call Arrival Rate）
時， 則保留的資源就形同浪費，也導致呼叫阻隔率（Call Blocking Rate）上升。
因此隨著通訊流量的增減適度地改變保留資源數是一個不錯的想法。另外若資源
不足以提供視訊服務，可以考慮降低視訊串流的品質，先建立連線，當系統資源
被釋出後再提高其品質亦是一種好的概念。
168
基地台環境中路由延遲對於各個換手機制均造成很大的效能衰退，所以我們提出
了一個簡單的機制，改善這之中某些換手機制在網狀基地台環境下的換手失敗率
效能。
研究的問題
在網狀基地台網狀網路環境中，我們只採用部分 Mesh mode，而這些部分
Mesh mode 則是只有包含基地台在內而以，在使用者 Mobile Station 上面，我們
依然採用原本的廣播模式 PMP mode，也就是在該基地台管轄範圍內的話，一切
接收訊息的方式依然依照原本 802.16e 所定的廣播模式規則所操作。
我們可以在一個地域內，布建許多的基地台，而這之中分成Mesh BS，以及
System BS；不同於以往一般的設定，每一個細胞內的基地台(BS)服務著當地的
使用者的時候，本身也與後端網路有聯繫的，也就是每個基地台本身都可以透過
存取服務網路(Access Service Network ,ASN)與ASN-Gateway取得相關授權以及
IP的資訊。而在網狀基地台環境下，這一個區域中的Mesh BS與System BS，只有
System BS可以直接透過存取服務網路ASN，與網路上層取得移動台所必須的資
訊包含認證碼、金鑰資訊、以及所被分配到的IP等等，而其他的Mesh BS則是擔
任著跳站(HOP)的功能，其具有與廣播模式基地台的大部分功能，但是若是需要
取得更上層的網路協調相關資訊的時候，Mesh BS便需要在該區域中的基地台中
尋找有連接至ASN-GW的System BS，以向上層網路取得相關資訊，而這跟傳統
只有廣播模式環境的不同在於Mesh BS必須透過重新路由的方式，找到新的資訊
傳遞路徑與System BS達成聯繫，而這一條找到的新路徑，將擔任起之後外部網
路傳遞資訊至此Mesh BS的路徑，所以在傳遞路徑的關係上，我們可以用下式表
示:
170
圖 11.2 換手程序
上圖為換手的程序，每個步驟都有其所需要處理的時間，而這時間在換手步
驟裡面也成為了換手延遲的一部分。
所以我們為了要分析網狀基地台環境所造成的影響，將其相關換手延遲時間
表達成下列參數:
‧ 0LT ：關聯等級0時所需要的換手時間
‧ 1LT ：關聯等級1時所需要的換手時間
‧ 2LT ：關聯等級2時所需要的換手時間
‧ MeshLT _0 ：在網狀基地台環境下關聯等級0時所需要的換手時間
‧ MeshLT _1 ：在網狀基地台環境下關聯等級1時所需要的換手時間
‧ MeshLT _2 ：在網狀基地台環境下關聯等級2時所需要的換手時間
172
動台欲轉換定錨基地台 Anchor BS 的時候，雖然相關安全資訊都已經擁有了，但
是此基地台還是需要與系統基地台連接以取得 CID 與 IP 的配對，所以在網狀網
路環境下，快速基地台轉換 FBSS 依舊會受到重新路由的影響，並產生路由延遲。
因應了 FBSS 此種路由延遲的狀況產生，本研究遂提出一個改善流程，最主
要即為讓分集集合中的基地台可以提早作路由路徑的搜尋，如此若是換手到已經
做過路由搜尋的基地台之時，那路由延遲便會大幅縮減。下面為此改善流程。
提早尋找路徑之快速基地台轉換改善流程
1. 行動台與定錨基地台正在進行資料通訊
2. 定錨基地台提供行動台的安全資訊給分集集合中其他的基地台
3. 分集集合中其他基地台將所建立的連線識別碼傳送給定錨基地台
4. 定錨基地台將其他基地台指定的連線識別碼傳送給移動台
5. 此時分集集合中其他的基地台可以開始路由至系統基地台的路徑
6. 當路由至系統基地台之時，各基地台便知道此路徑，也就是等於回傳
Route-RSP
7. 而後若是行動台轉移定錨基地台時，便不用等待重新路由的時間，而只要等
待短暫的跳站空中傳遞延遲以及網路交換設定的時間
174
基地台做協調，而後將整份報告一次遞送給行動台。
ROUTINGSYNREGAUTHENRNGMeshL TTTTTT _0
ROUTINGSYNREGAUTHENnBSSBSSBSMSMeshL TTTTTTT  _1
ROUTINGSYNAUTHENREGTBSSBSSBSMSMeshL TTTTTTT  _2
上列三式，與前面的三式不同，由於這是在網狀基地台環境下，所以每一個
式子中間均多了一項 ROUTINGT 的時間延遲因素，會有此項時間延遲因素是由於，
當一個移動台需要換手而進行到認證、金鑰交換、取得 IP 的程序的時候，新的
目標 Mesh BS 並不能直接取得應該與行動台互動的資訊，所以必須經由一個路
由的程序才可以與這一區域中與 ASN-GW 連結的 System BS 取得相關資訊，此
時便有了 ROUTINGT 這個延遲的產生
基於以上的假設、討論和分析，並且在不考慮系統容量的前提之下，也就是
每次行動台啟動換手時，我們都假設其目標基地台的資源都足夠此行動台作換手
切換，所以我們的實驗只是單純的考慮換手程序各個延遲時間的影響，我們將各
個程序延遲相加，形成最後的換手延遲，通常各個程序延遲時間為一變數，所以
我們使用 MATLAB 模擬程式利用重覆實驗的方式得出最後換手失敗的機率，我
們的計算換手失敗的方式是:在之前我們經由訊號強度衰減公式並定義出 0.75dB
訊號衰減容忍度，由訊號強度衰減公式的換算，此強度衰減強度可以對應到一定
的距離，大約為 43 公尺，而此距離除以當時行動台所移動的速度，就可以得出
當時移動台所能忍受的換手時間，若是換手程序延遲超過了此換手忍受時間的
話，那麼就判定此次換手為失敗。
實驗參數 數值
176
圖 11.4 硬式換手在傳統環境以及在網狀基地台環境下的換手失敗率比較
在下圖 11.5 中我們控制行動台切換定錨基地台執行快速基地台轉換換手
時，所選到的基地台已經做好路由搜尋的機率當作因子，當機率越高的時候，行
動台切換的目標基地台已經做好路徑搜尋的可能性越大，這麼一來當執行換手的
時候，那路由延遲便可以大大減少，我們在下面的這張圖中，分別做了 50％和
90％的實驗，50％代表執行換手時所切換的基地台有一半的比例已經做好了路徑
搜尋，由下面實驗圖可以看得出來若是有一定的切換成功率的話，那換手失敗率
的比例將會大大的下降，若是將成功率調高至 90％已經可以看到換手失敗率已
經非常接近於 2%，而呈現很好的效能了，我們到目前為止並未考慮到 Mesh BS
以及 System BS 之間溝通訊息時候所耗費的頻寬資源，而只是單純在換手成功率
的效能評比上做比較。
178
能最差，這也是因為關聯等級0所有測距要求均為競爭性的，並且又在網狀網路
環境下，雖然他的機制很簡單，但是其表現在網狀基地台環境下幾乎不能使用，
而硬換手之間的關聯等級1和關聯等級2表現中庸，這是因為他們只少了測距延
遲，但是因為本身系統限制，所以並沒辦法克服需要路由的因素，而軟式換手的
兩種機制：巨分集換手MDHO以及快速基地台轉換FBSS，由於其本身機制設計
的原因，跟硬換手比起來都算是最佳的，但是快速基地台轉換仍然沒有巨分集換
手表現的優秀，原因已經在前述講過了，所以當我們使用預先路由的改善法之
後，快速基地台轉換也可以有效的降低其換手失敗率。在圖11.6我們採用的改善
法條件為選擇目標基地台已經經過預先路由的機會為95％，由圖中也看得出來，
失敗率已經幾乎趨近於0，而與巨分集換手接近了。
結論
在本研究中我們提出了一個簡單的改進方法，並提出在一定的條件限制下，
快速基地台轉換 FBSS 可以逼近巨分集換手的換手效能表現，在實作中，如何能
夠達到所謂我們所設定的一定條件限制呢？我們的條件限制是在於行動台欲轉
換定錨基地台時，其所選到的目標基地台是否已經做過路徑搜尋的機率，路徑搜
尋也就是路由程序，所以在實作中，若是我們隨機選擇分集集合中的一半基地台
做預先路由的程序，這樣一來的話，目標基地台已經做過路徑搜尋的機率便接近
50％，而若是我們令分集集合中所有的基地台都做預先路由程序的話，那麼此機
率便接近 100％了，這麼一來在換手上的表現，快速基地台轉換便可以幾乎與巨
分集換手相同，但是就如我們在之前的章節所提到的，巨分集換手 MDHO 是藉
由行動台與基地台維持多個傳輸連線，來達到他在換手時候的穩定度，此多個傳
輸連線，通常會傳輸一樣的資料，一樣的資料便會造成頻寬的浪費，所以快速基
地台轉換雖然在基地台之間需要許多訊息的交換，但是那也只是在訊息交換的通
180
速鐵路上某些已知的資訊，例如高速移動列車的行進路線已知、通道脈衝響應的
各個多路徑延遲已知，配合隨著鐵路架設的基地台能夠針對此特殊環境設計出一
套適用於此環境的通訊系統，並且能夠降低記憶體使用量與運算的複雜度，領航
符元使用量也能夠因為此特殊環境在相同的錯誤率下使用得更少。
研究的問題
考慮到高速鐵路的超高速移動的環境(300km/h)受到極大的都卜勒效應以及
在高點數 OFDM 傳輸架構下，一個 OFDM symbol 內就會發生通道的變化了，因
此接收端使用了針對時變通道的解調架構(ML 通道估測+時域通道內插改良
+LMMSE 等化器)，根據此架構的模擬結果得到所需要的領航符元比例。
考慮能利用到高速鐵路環境各種部分已知的資訊，例如列車行進路線的可預
測性、通道脈衝響應的各個多路徑延遲已知，還有討論 ML 及 MMSE 通道估測
的通道脈衝響應最長延遲格數設定有誤差時所造成的影響。
在系統的架構方面，因為高速移動造成的惡劣無線通訊環境以及接收機對接
收訊號處理會較為複雜。我們能從列車本身取得電源並且列車本身也能搭載運算
能力較強的接收機，因此選擇雙鏈架構較為有利，而考慮到保留基地台後端骨幹
網路的選擇彈性，使用集中器又比在列車上搭載完整基地台有利。為了減少換手
所造成的負載並且考慮到列車行進路線的可預測性，選擇小涵蓋範圍方式較佳。
主要的結果和討論
182
圖 12.2：每個 OFDM symbol 正中央時間 ML 通道估測值之間用線性內插
如上圖，設 A 點通道估測值為 Aˆh ，B 點通道估測值為 Bˆh ，則 A 點跟 B 點中間的
時間所有內插值為：ˆ ˆ ˆA x A B
N G x x
N G N G
  
 
h h h
其中 x 為 A 點之後第 x 個短時間(short time)，N 為 FFT size，G 為 GI size。
C. 等化器
先做個 DFT 矩陣定義[24]為 0 1[ , , ]NHQ q q  ，再將上一步驟時域通道內插
改良得到通道脈衝響應 ,n lh 轉換成下列的形式：
( )
(0,0) 0 (0,2) (0,1)
(1,1) (1,0) (1,3) (1, 2)
( 1, 1) ( 1, 2) 0 0
( 2,0) 0
0 0 ( 1,1) ( 1,0)
N
h h h
h h h h
h v v h v v
h N
h N h N
 
 
 
 
      
 
  
   
H


    

    
  

(12.2)
我們能將頻域的傳送接收公式寫成  Y GX Z，其中矩陣G寫成
( ) /N H NG QH Q 
若要直接求矩陣G其中一項 ( , )G m s 可以寫成：
1 1
2 ( ) / 2 /
0 0
1
( , ) ( , )
N v
j r s m N j sl N
r l
G m s h r l e e
N
 
 

 
  (12.3)
若使用強制歸零(zero-forcing; ZF)等化器，則公式為： 1ˆ X G Y
184
總頻寬：20MHz。列車時速：300 公里/小時(約 fd=550)。調變方式：16QAM。
領航符元擺放方式：梳狀或塊狀。FFT 大小：分別為 64、256、1024。保護區間
(GI)長度：塊狀為 16。領航擺放比例為從在同調時間或同調頻寬內不影響錯誤率
到比例漸漸少了之後對錯誤率產生嚴重影響為止。
梳狀：FFT size=256
5 10 15 20 25 30
10
-4
10
-3
10
-2
10
-1
10
0
Eb/N0, dB
B
E,
bi
t
comb type, kuo LMMSE, fft=256, cost259RA
1/2
1/4
1/8
1/16
1/32
圖 12.3：使用時變通道解調，fft=256，梳狀，不同領航比例的錯誤率
FFT size=1024
5 10 15 20 25 30
10
-4
10
-3
10
-2
10
-1
10
0
Eb/N0, dB
B
E,
bi
t
horizontal pilot, kuo LMMSE fft=1024, cost259RA
1/16
1/32
1/64
186
範圍內領航符元佔傳送資料的比例，結果如下表：
Fftlen Symbol rate Comb type Block type Pilot 總比重
64 312500 1/2 1/64 1/128
256 78125 1/8 1/16 1/128
1024 19531 1/16 1/4 1/64
表 12.3：不同 FFT 大小所投資領航符元總比重
梳狀排列由於隨著 FFT size 變大使得在同調頻寬內的子載波數變多，領航符
元的密度因此可以降低；塊狀排列隨著 FFT size 變大而一個 OFDM symbol 的時
間也等倍數提昇，因此塊狀排列的領航符元比例也會等倍數提高。在高 FFT size
時在梳狀排列受到頻譜擴散到相鄰的子載波而造成子載波間的干擾，因此相乘後
的領航總密度在大 FFT size 會略微上升。
(二)：不同程度的部分通道已知資訊對效能的改善
一般來說高速移動的路線(高速鐵路、磁浮列車、高速公路)是以直線進行為
主，行進路線跟周圍的地形在一定距離內較為類似，比較不像一般都會區內道路
環境錯綜複雜，因此通道的資訊有較高的可預測性。對高速行進軌道旁的基地台
而言，不同的行動端通常會以類似的路線與速度接近，再以類似的路線與速度離
開，這個特性有助於讓基地台或行動端快速的判斷或估計通道狀況，提高通道估
測的準確度與降低複雜度。過往與行動端通訊的紀錄可用歸納的方式得出通道資
訊內較少變動的參數並加以記錄，在之後的行動端通訊時就只需要估測通道參數
變動的部分，這種方式也將有助於降低接收機的複雜度。
高速移動列車的行進路線已知
188
其中三格為空白，因此 PB 矩陣 PB (m,5)處的公式
2 / Pj mn Ne  可以代入 n=6 也就是
2 / Pj m Ne  *6 ， PB (m,6)=
2 7 / Pj m Ne  * ， PB (m,7)=
2 9/ Pj m Ne  * ，有空白格的就不用算簡
化 FFT 矩陣了以此類推。在解出通道脈衝響應時再移回原來該有的延遲格數位
置。
1( ) ) ( )H HP P P P P P
X B X B X B 由 12* PN 變成 9* PN ，因此每次執行時複雜度減
少 25%。所使用的記憶體也從 PY 矩陣大小( PN *1)跟
1( ) ) ( )H HP P P P P P
X B X B X B 的
矩陣大小(12* PN 9* PN )來看，每次執行時記憶體使用量減少 25%。
圖 12.8：實線：各路徑延遲已知 虛線：原時變通道解調 fft=256
實線的為各路徑延遲已知，虛線的為原本的時變通道解調。圖中可以很明顯的看
出在使用各路徑延遲已知後，能夠使用更少的領航符元來達到所需的錯誤率。
結論
190
以對 PB 矩陣的大小做縮減，在高鐵模擬環境 Cost259 RA 不僅可以減少 25%的運
算量，以 FFT =256 為例，在堪用錯誤率的領航比例還能從 1/12 能夠降低到 1/20。
另外討論時變通道解調加各路徑延遲已知、時變通道解調、傳統解調方式比較。
領航比例一樣是 1/16，SNR=30dB 下時變通道解調有使用各路徑延遲已知的比未
使用改善了 7dB。領航比例在 1/14 時改善了 2.5dB，領航比例在 1/18 時將不能
用改為可用之情況。
13 正交分頻多工系統在超高速移動環境下的通道識別
引言
1.1 台灣高速鐵路的環境
台灣高鐵行經台灣西部14個縣市、77個鄉鎮與32個都市計畫區，全長345公
里，台北縣樹林市至高雄市左營區長約329公里，包含251公里橋梁工程、47公里
隧道工程及31公里路工工程，而台北市南港區至台北縣樹林市有長約16公里之地
下隧道工程；營運初期，共有8個車站提供服務，台北、板橋、桃園、新竹、台
中、嘉義、台南與左營等8個車站，南港、苗栗、彰化與雲林4站預計於2010年加
入，如下為高鐵路線示意圖。
192
訊系統，因此本研究將以高速移動環境為背景，開發具優良性能且低複雜度之新
型無線通訊接收機，以期在高速移動環境下滿足消費者的通訊需求。
為了滿足使用者在任何時間均能擁有良好的服務品質( Quality of Service,
QoS )的網際網路服務，目前最被廣泛討論的OFDM傳輸技術則是最有希望的候
選技術，如圖 13.2 為典型正交多頻分工 ( Orthogonal Frequency Division
Multiplexing；OFDM )系統的基頻傳收機架構。
圖13.2 典型OFDM系統的基頻傳收機架構
在OFMD系統，可用頻寬被分割為N個彼此正交的子頻帶，資訊在錯誤更正
碼編碼後，調變成資料符元，接著資料符元與導引符元( Pilot Symbol )一起傳送，
在無線通訊的環境中，多路徑衰減( Multipath Fading )是不可以避免的，其過程
中因為反射、繞射、折射的因素，有許多不同的路徑，當每個不同路徑的電波到
達接收端後，因為不同時間延遲的訊號相互疊加，組成訊號產生相位偏移，其成
份波相依於某個瞬時的相位，而產生建設性( 相長性 )或破壞性( 相消性的干
涉 )。
為了消除OFDM訊號在多路徑衰減的環境下所遭遇的訊號間干擾
( Inter-Symbol Interference, ISI )，在OFDM訊號傳送出去之前，其尾端的數個取
194
都卜勒效應是高速移動環境的主要特性，示意圖如圖13.3。在無線通訊的環
境下，用戶在移動的時候，會與基地台產生相對移動速度，而產生都卜勒效應。
圖13.3 都卜勒效應
都卜勒效應的另一個重要參數是同調時間(Coherence time) CT 。在同調時間
內，通道可視為是非時變，所以若符元時間比同調時間短，則表示通道狀態在一
個符元時間內是可以看成是幾乎不變的，此通道狀態稱為緩慢衰減( Slow
Fading )，反之若符元時間大於同調時間，則表示在一個符元時間內通道狀態會
產生改變，此通道狀態稱為快速衰變，所以移動速度越快，通道的變動就會愈劇
烈。
b. 時變通道環境之最大概似通道估測與等化器之架構：
由於非時變環境轉換成超高時變環境，主要會衍生出Doppler effect，相對於
OFDM系統來說必定造成嚴重載波間干擾(ICI)問題，所以傳統非時變通道的
OFDM基頻接收機系統將不堪使用，因此我們將利用圖13.4所設計的領航符元輔
助通道估測系統架構來對抗載波間干擾問題。
196
響應格數=512，雖然真實的通道情況我們無法明確知道，但多路徑的數目若等於
512條的情況，除了會造成估測速度變慢和記憶體的浪費並且大多數路徑由於功
率過小，在作通道迴旋積分時並不會造成系統太大的影響。接下來我們將探討通
道未知的情況下，利用功率偵測臨界值識別出最大延遲時間並找出路徑( Path )
與雜訊( Noise )加以區別。
a. 最大延遲與路徑估測：
我們將在 OFDM 系統的接收端加入功率偵測門檻 ( Power Detection
Threshold；PDT )的方式來識別最大通道脈衝延遲格數且判別路徑與雜訊，如圖
13.5 的功率偵測門檻架構圖所示：
圖 13.5 功率偵測門檻架構圖
III. 中心頻率2G與700MHz的比較：
由於高鐵通訊最大的問題在於時速若達到 300km/hr 時,通道便會由原先慢速
衰減環境轉變成快速衰減環境，因此快速衰減環境便是我們主要想解決的問題。
直觀我們可以想到兩種方法，第一是加大系統頻寬，第二是降低中心載波頻率使
通道情況轉變成慢速衰減環境來降低高鐵通訊的困難度。
我們可以清楚看到由於中心頻率的降低，傳遞的波長變長而使都卜勒效應隨
之下降，使最大都卜勒頻率由原先 555MHz 降低至 194HZ，隨之通道的變化情
198
如圖 13.7 所示，假設 P1、P2 兩點利用 MLE 所估測出來的值分別為 1Ph、 2Ph，
我們將利用內插方式找出兩點間所有的值，其值如下式所求得：
1 1 2P t P P
fft CP
h h h
fft CP fft CP
 
 
  size size - t t
size size size size
其中 t 為兩點間的第 t 個時間點，如圖 13.8 為線性內插的通道脈衝響應的均方錯
誤模擬圖。
圖 13.8 使用線性內插的通道脈衝響應的均方錯誤
最後圖 13.9 和 13.10 即為圖 13.7 的系統架構的時變通道解調的均方誤差與
錯誤率的結果
圖 13.9 FFT=256,取樣率=20MHz 時的時變通道解調的均方誤差
200
從學生論文的圖 13.11 至 13.14 模擬圖結果我們可以得到一些經驗法則，即
利用上式所得雜訊功率當作功率偵測門檻設定的基準且根據 SNR大小而加大-20
至-10dB，例如 SNR=30dB 時相對應雜訊功率為-60dB，功率偵測門檻值我們取
-40dB，其估測出現路徑數為 12 的機率情況最好；另一方面我們可以看到當功率
偵測門檻值低於-30dB 時相對 SNR=0，此大功率偵測門檻值所估出的路徑數為
12 的機率情況會隨之便差，因此，我們將-30dB 作為最大功率偵測門檻值的上限
值，以(式 4.5)相對應的雜訊功率作為最低下限值。
下圖是利用延遲估測找出最大通道脈衝響應的格數與實際路徑數，且代入 B
矩陣(式 2.30)的長度 L所得的錯誤率比較。模擬參數：FFT SIZE=512、Sampling
rate=20MHz、V=300km/hr、COST 259 RA、Pilot spacing=
1
16
、CP=
1
16
、L=12、
'L =20 和 'L =11，其中 L 為真實路徑數， 'L 為利用延遲估測所得最長路徑格數。
圖 13.11 延遲估測與位元錯誤率的相對關係
202
圖 13.12 利用路徑偵測的均方誤差比較
 第三部份主要是在討論中心頻率為 2G 與 700MHz 的差異性，結果如下圖所
示：
圖 13.13 SR 為 20MHz 與 Cf 為 700MHz 和 2GHz 均方誤差與錯誤率均方誤差比較
圖 13.14 SR 為 6.25MHz 與 Cf 為 700MHz 和 2GHz 均方誤差與位元錯誤率比較
204
取出相對應於輸入端位置且受到時變通道效應與高斯白雜訊影響的領航符元，再
導入最大概似通道估測，其估測所得通道脈衝響應會在
2
FFT Size
最準確，藉由
此特性結果，我們再將估測所得通道脈衝響應作時域線性內插填滿整個符元時間
的通道變化。最後再將上述方法導入線性最小均方差等化器來補償通道效應恢復
回原訊號模樣。
第二部份，利用雜訊功率來當作功率偵測門檻值的參考點。接著經由模擬分
析結果我們可以看到，當估測出所得最長脈衝響應格數必須要大於實際路徑數，
如果估測出來的脈衝格數少於真實路徑數，就會出現嚴重的位元錯誤率。然而最
長脈衝響應格數大於實際路徑數，系統依然可以保有穩定性，原因是假設MLE
所估測出來的通道脈衝響應很準確，那我們所估出的通道脈衝響應的功率應該會
非常小，所以在作通道迴旋積分時影響量相對小了很多。最後經由模擬分析結果
我們可以得到一個經驗法則，就是利用雜訊功率當作功率偵測門檻設定的基準且
根據SNR大小而加大-20至-10dB，利用此經驗法則即可較準確估測出現路徑數為
12配合路徑偵測更可以降低均方誤差率、系統複雜度和記憶體使用量。
最後我們主要在討論高速鐵路未來可能開放 700MHz的載波頻率與現有 2GHz的
載波頻率系統的模擬分析比較。由於高鐵通訊最大的問題在於時速若達到
300km/hr 時,通道便會由原先慢速衰減環境轉變成快速衰減環境，因此快速衰減
環境便是我們主要想解決的問題。直觀的作法有兩種，第一是加大系統頻寬，不
過無線通訊的頻寬本身是很珍貴且有限，無法大幅度增加，第二就是降低中心載
波頻率，如右式 ,m
C
v c
f
f


  行車速度固定和光速均無法改變，唯一可以改變
只有中心載波頻率，並且代入同調時間的公式(
9
16C m
T
f
 )，我們可以看到當 mf
下降會使同調時間變大，使通道情況轉換成慢速衰減環境來降低高鐵通訊的困難
度。
206
估測的基本方塊圖繪於圖 14.1 所示。
圖 14.1. 數位基頻正交分頻多工通訊系統合併最大概似通道估測的基本方塊圖
首先我們先定義傳送的 OFDM 符碼(symbol)格式如(14.1)式表示，其中我們
使用 2Nα+1 個次載波傳送資料，而其餘的保留為護衛頻帶，而 l 表示為傳送的第
l 個 OFDM 符碼。
( ) ( ) ( ) ( ) ( ) ( ) ( )
0 1 2 1[ , , , ,0,0, ,0, , , , ]
l l l l l l l
N Nc c c c c c c       (14.1)
並將通道假設為具有 L 根多重路徑的通道向量，並表示為如(14.2)式所示
( ) ( ) ( ) ( )[ (0), (1), , ( 1)]l l l l Th h h h L   (14.2)
其中第 l 個 OFDM 符碼，第 n 個次載波的通道頻率響應(channel frequency
response)分量，視為這 L 根多重路徑通道訊號的頻率響應總和，如(14.3)式所示
208
而我們通道估測的目標就是希望由觀測向量 Z 推導而得通道頻率響應 H。
在領航符碼輔助(pilot-aided)通道估測系統中通道頻率響應
 ( ) ;H H n n N  ，由(14.3)式我們可以將其表示為矩陣形式如(14.8)式所示
H Gh (14.8)
其中
2 /
,[ ] , 0 1
j nk N
n kG e n N k L


     
G 矩陣為將時域通道脈衝響應(channel impulse response)訊號轉換到頻域的
完整傅利葉轉換矩陣，因最大概似估測有非時變性質，因此我們可以推廣到通道
估測的形式，其中h為真實時域通道脈衝響應 h的估測值，而其通道頻率響應估
測值
^^
hGH  ，並因為通常領航符碼個數 Np 和通道多重路徑根數 L 不同，因此
我們需要透過對(14.7)式取虛擬反矩陣(pseudo inverse)而推導出估測的通道脈衝
響應為如(14.9)式所示
 1 H
MLEh D B Z (14.9)
其中
HD B B 為一維度 L 的方陣
而我們必須確認領航符碼(pilot symbol)數需大於多重路徑數(L)，且將各領
航符碼取相同間隔(equally spaced)的安插在所採用的傅立葉轉換之中，以確保 D
矩陣存在而得到最小的均方誤差
2
( )MLE
p
L
n
N
  ， 2為其通道雜訊變異數。
210
Maximum channel tap length L=20
表 14.1.系統模擬參數表
圖 14.2.不同通道型態在已知通道條件下的均方誤差表現
212
間取樣點，所以當我們可以判讀出該時間取樣點處無多重路徑存在時，則可將 B
矩陣作相對應的修改，以提升最大概似通道估測準確度。
實際應用功率偵測臨界值於部份通道條件已知估測模擬
在底下的圖 14.4，14.5 中我們模擬的通道型態為叢集式(Cluster case channel
profile)通道型態，其模擬的參數為
圖 14.4.叢集式通道運用功率偵測臨界值之偵測均方誤差表現
214
圖 14.6 兩根多重路徑通道運用功率偵測臨界值之偵測均方誤差表現
216
平均視窗尺度演算法步驟:
1. 設定用於平均的視窗尺度大小(num)
2. 將由快速傅立葉後取得的 num 個觀測向量平均得到一個均值觀測向
量(Y )，並計算此包含通道雜訊之均值觀測向量相對應的通道脈衝響
應( h )訊號功率以為功率基數
3. 可設定初始功率偵測臨界值為上述通道脈衝響應( h )訊號最大根多重
路徑功率位階
4. 在依次往下調整功率偵測臨界值直至其所包含的訊號功率為步驟 2 所
得功率基數的98%以上之相應功率偵測臨界值為我們所求的可適性功
率偵測臨界值
5. 並以所得之可適性功率偵測臨界值為判斷通道脈衝響應( h )訊號各多
重路徑存在與最長通道延遲資訊之依據。
另外，我們亦評估此平均視窗尺度演算法在不同通道模型下的性能表現情
況，並套用我們之前所提的三種通道模型，將其最大通道延遲估測錯誤率繪製於
底下圖 14.8 所示，底下則是我們的模擬參數：
218
15 在高速鐵路環境下正交分頻多工系統使用線性通道估測及通道估測更新技
術之比較與改進
引言
本篇論文主要即是在討論在高速鐵路環境下，列車行進速度為時速300公里
的時候，使用OFDM無線通訊系統，對於通道估測方法的效能比較與改進，對於
子載波間的干擾(Inter-Carrier Interference; ICI)我們則暫不考慮。由於在高移動速
度的鐵路環境中，信號從發送端經通道至接收端，會遭到從頻域及時域的嚴重干
擾與衰減，造成信號嚴重失真使解調出來的信號與原信號相差很大，所以我們需
要較好的通道估測系統，以判斷並消除通道目前的狀態，使所接收的信號能還原
成原來傳送的信號。本篇論文所討論的通道估測主要即為以線性內插的方式以及
利用資料反饋的技術所做的通道估測更新方式等兩種，我們將分別比較其二者之
優缺點，且由於現今我們所需傳送的資料較多，故常常在OFDM系統中，我們需
要提高載波數，以增加系統的傳輸資料量，但卻又因此使得系統所受到的都卜勒
偏移更為嚴重，故我們需要將通道估測的方法改進成能完美克服此一現象，不致
使錯誤率提高，卻又可減少已知信號的使用，以提高傳輸資料的量。
我們所考慮整體系統的架構如下圖15.1所示，高鐵車廂內的旅客可利用行動
電話等設備經匯合(Trunking)或是獨立的連線，再沿著無線通道連接位於鐵路沿
線的基地台，最後連結至後端的骨幹網路。且為了因應高鐵環境本次論文所討論
的主要以雙鏈小涵蓋範圍的系統架構為主。
圖15.1 系統架構
220
圖15.2 OFDM系統方塊圖
我們所使用線性內插做通道估測的方法是，在OFDM所傳送的信號經過加密
擾亂以及調變後，會對應至頻率相互正交的子載波，這時即會形成一個由頻率以
及時間交錯形成的二維的空間，我們在此二維空間利用固定的間隔擺放領航字元
(pilot)，在解調時我們在任兩個利用領航字元所估測出來的通道狀態之間，皆以
線性內插的方式去估算其間通道的値，並去除通道對信號影響的因素，以達到較
好的解調效果。因此方法對於傳統直接用領航字元作通道估測的方法，更能有效
對通道的變化有適應力，在高速鐵路這種通道變化較快的環境，線性通道估測較
能減少領航字元的使用量，以增加傳輸效率。
我們利用高速鐵路以時速300公里行駛在郊區所造成的多重路徑干擾及都卜
勒偏移通道環境為背景，可算出OFDM系統，在不同載波數下的符碼時間和子載
波頻寬，以及在高速移動環境下，其相對應的領航位元的適當時間和頻率的間
隔，如下表15.1。
表15.1 不同載波數的領航位元適當的時間以及頻率間隔
載波數 符碼時間(s) 子載波頻寬
(Hz)
領航位元的適
當時間間隔
領航位元的適
當頻率間隔
64 64 10 60.3125 10 19 1
222
圖15.3 以資料驅動方式作通道估測之傳送機及接收機方塊圖[34]
因資料驅動通道估測所使用的通道估測是拿前面一個或多個已解調之資料
來當作已知信號，從而得到通道即時的狀態，故較能適應通道在時域上的快速變
化，故在高速鐵路環境下，我們可利用資料反饋的通道估測更新技術以取代傳統
線性通道估測，但我們也發現若是在載波數目較高的 OFDM 系統，我們所使用
的領航字元間隔雖可比傳統線性通道估測還的大，但也對於傳輸效率的提升空間
不大，因此我們在這裡討論利用領航字元兩邊夾擠的方式來做資料反饋的通道估
測更新系統。
如下圖 15.4(a)我們所擺放領航位元的方式是每隔特定的一段時間將領航位
元安插在所有子載波中。傳統的通道更新系統皆是以特定時間所擺放的領航字元
為起點，逐一向後方利用資料反饋的技術一個接一個的做通道估測並解調，如此
即可較快的追跡通道的變化，但在領航字元間隔越大的時候，表示每兩領航字元
間的資料量越多，而其中有資料傳送錯誤的機會也增大，通道估測更新技術容易
產生錯誤傳撥的現象，造成其錯誤率會因領航字元間隔越大而越高。我們所提出
224
時間點皆能完美的追跡通道的狀態，以抵抗通道的快速變化。我們也可將圖
15.4(b)之頁框格式應用在資料反饋通道估測更新技術上，並從頻域作資料反饋以
求得通道狀態。
為了要使用從頻域做資料反饋的通道估測更新技術，首先我們需先將整個發
送機與接收機處理資料的順序加以改變，參考圖15.3，我們將S/P往前移，先將
資料經過S/P以對應至不同的子載波，再將其依照不同的子載波分別經過加密以
及打亂，最後再經過種種程序再從天線送入通道中，在接收端也將P/S移至解密
之後，而在Replica generator也類似傳送端將S/P移至第一個。因為若是在頻域做
資料反饋，我們需在解調完前一個子載波上的資料後才能再對下一個子載波上的
資料作解調，若是不改變此作業的順序，依照不同子載波作加密，我們在解密時
即會因資料的順序不同而發生大亂，使系統完全不能運作。
我們仍可利用兩邊領航字元分別向中間作資料反饋的動作以增加通道的追
跡速度。且我們在此可發現，此時我們是在頻域做資料反饋，故利用兩邊夾擠的
方法也是改在頻域完成，這麼一來原本在時域做兩邊夾擠需要一次先接收一段信
號，才能在兩端領航字元分別做資料反饋，如此會浪費解調信號時間的缺點，隨
著從時域轉至頻域已不再存在，也就是說我們在接收第一時間點的信號時，即可
直接解調回來，不需再等待後來的信號。
然而我們卻發現本節所討論在頻域做通道估測更新的方法，有一個基本上的
缺點。因為我們加密所要使用的是基本的碼率為1/2的迴旋碼，在解密的時候我
們可發現，由於加解密機制的關係，通常發生錯誤的資料位元都是集中在後面幾
個，也就是說若是一起送入加密的資料越多，雖然在解密時錯誤的位元數可能會
增加，但因其錯誤皆集中在後面幾個位元，故比較起來其錯誤率會因此而降低，
而我們所使用的在頻域做通道估測更新的技術，要分別在各子載波作加密解密以
及打亂的動作，若是我們想快速的解調出所傳送的信號，我們所使用的頁框長度
226
圖15.5 串連加密擾亂之示意圖
再來因為高速鐵路的路徑和基地台的架設位置都是固定不會改變的，所以我
們還可利用此一特性，來改善無線通訊的傳輸品質。因為高速鐵路大多皆有直視
波的存在，且直視波的能量相對較大，而直視波所受到的都卜勒偏移主要是和列
車行進速度以及列車行進方向與基地台間的夾角θ有關，若通道變化的速度較
快，直視波與鐵路間的夾角角度θ改變，即會對通道的錯誤率有較高的影響，反
之，若在可以追跡的上通道變化速度的系統，夾角的改變不會使錯誤率有所變
動。如果現在列車的行進方向與速度已知，因高速鐵路的路徑與基地台間的相對
位置也可知，故我們可由此知道直視波的夾角，由此我們便可以知道直視波所受
到的都卜勒偏移，進而將其補償至原來中心頻率的位置，如此我們即可將補償過
後的直視波視為在低速移動環境的直視波，可較正確的對其作解調[71]。不過因
要動態的連續補償直視波的偏移，不僅需要先儲存基地台的位置，以判斷列車在
何位置時，直視波的夾角為何，也需要對列車的速度做持續的估測，並持續動態
的推算出直視波所受的都卜勒偏移為多少，如此需要較大的記憶體空間以及較大
的資料運算量，故我們只能使用雙鏈的系統架構，使這些步驟在列車的橋接器中
完成。且由於各列車從前一站到下一站之間的行車速度皆為類似，故我們可用經
驗法則以判斷在各個時間點直視波所受的都卜勒偏移大約為何，並加以修正，以
減少動態判斷都卜勒偏移的運算量。
主要的結果和討論
本篇論文皆是以模擬而得來的結果。下圖15.6即為我們實際去模擬，在高速
移動環境下，利用傳統線性內插的通道估測方法，載波數分別為64、1024時，在
都卜勒位移為550的情況下，利用設定各種不同比例位置的領航位元所跑出來的
228
1024，頁框長度分別定為100個級10個OFDM符碼長度。由圖中我們可知線性通
道估測在領航字元間距遠超過同調時間的1/10時，其追跡通道變化的速度會明顯
降低，使得整個系統無法實際使用。反觀利用資料反饋來進行通道估測更新的方
法，較能適應通道較快的變化，雖然有可能會產生錯誤傳導的現象，使得在SNR
較低的情況下，造成錯誤率較快的上昇，但在高SNR的情況下，只要通道狀態在
兩OFDM符碼間變動不算大，其錯誤率皆能快速下降，故此方法較線性通道估測
更能節省領航字元的用量。由圖15.7中我們也可知道，我們利用平均的方法可有
效降低因雜訊而判斷錯誤的機率，使得在低SNR的情況下能降低其位元錯誤率，
且利用越多筆資料作平均，越能分散因雜訊所做的錯誤的判斷，使得錯誤率越下
降，而效能也越提升，但若在高SNR時，因雜訊能量相對於信號的能量而言較小，
故受雜訊影響而判斷錯誤的機會也較少，使平均所能改善的空間變少，再加上越
多筆資料所做的平均其對通道變化的追跡速度就越慢，造成系統可能會因為所得
到的通道估測值和現有的通道狀態有差異而判斷錯誤，所以過多的平均在較高的
SNR下反而錯誤率會因此而上升。載波數1024的OFDM系統，雖然我們可看出通
道估測更新系統還是比傳統線性通道估測的位元錯誤率低，但其錯誤率在 210時
即有一個error floor，此過高的錯誤率即造成此系統無法在實際上使用。
230
-5 0 5 10 15 20 25 30 35
10
-5
10
-4
10
-3
10
-2
10
-1
10
0
n1024;rn32;cost259;fd550
linear
nd30,fb
nd20,fb
差，即較容易有錯誤的發生，再加上若是有錯誤發生，通道估測更新技術很容易
會產生錯誤傳遞的現象，使得錯誤率更加提高。接下來我們再來看看我們將頁框
長度拉長為 20 個 OFDM 符碼長度，如下圖 15.8(b)，此時會有什麼表現，由圖中
我們可以看出通道估測更新系統確實可因拉長頁框長度以增加解密時的除錯能
力，進而降低錯誤率，但在直到頁框長度一直延長至 30 個 OFDM 長度時，其錯
誤率在 SNR 高如 30 dB 時才會較線性通道估測稍微較低，且在頁框長度拉長後
也會因為使資料從接收到解調出來的時間過長，影響通訊的速度。
-5 0 5 10 15 20 25 30 35
10
-5
10
-4
10
-3
10
-2
10
-1
10
0
n1024;nd10;cost259;fd550
rn32,fb
rn64,linear
rn32,linear
rn64,fb
(a) (b)
圖15.8 載波數1024之線性與頻域通道估測更新在較長及較短頁框時效能比較
232
-5 0 5 10 15 20 25 30
10
-6
10
-5
10
-4
10
-3
10
-2
10
-1
10
0
n1024;rn64;cost259;fd550
str.2side.fb.nd20
linear
str.2side.fb.nd10
-5 0 5 10 15 20 25 30 35
10
-6
10
-5
10
-4
10
-3
10
-2
10
-1
10
0
n1024;rn32;cost259;fd550
str.2side.fb.nd20
str.2side.fb.nd10
rn32,linear
(a) (b)
圖15.9 以新加密方式在頻域領航字元間隔較大及較小通道估測更新的效能表現
下圖15.10(a)為載波數64的OFDM系統，我們在高鐵環境針對已知或未知直
視波的都卜勒偏移所作的不同領航字元時域間隔的模擬比較圖，其中為了不被頻
率間的變動所影響，我們將領航字元在頻率間的間隔設為1，由圖中我們可知，
若在領航字元時域間隔小於同調時間的1/10時，表示此時都卜勒偏移是在系統可
接受的範圍之內，所以在已知與未知直視波的都卜勒偏移，信號皆能完全解調回
來不會受通道的變化而改變，故其效用不大，但是在領航字元在時域的間隔超過
同調時間1/10時，由於通道在領航字元間已有所改變，使錯誤率會快速上升，故
若我們此時已知道直視波的都卜勒偏移，將其加以補償回來，即可使直視波的解
調較為正確，故如此即可使整體信號判斷較為準確，降低整體的錯誤率，且我們
234
-5 0 5 10 15 20 25 30
10
-6
10
-5
10
-4
10
-3
10
-2
10
-1
10
0
n64;nd50;cost259;fd550
linear,know
fb
ave8,fb
linear,unknow
-5 0 5 10 15 20 25
10
-7
10
-6
10
-5
10
-4
10
-3
10
-2
10
-1
10
0
n64;cost259;fd550;linear
nd30,unknown
nd30,known
nd50,known
nd55,known
nd55,unknown
nd50,unknown
nd19,unknown
nd19,known
(a) (b)
圖15.10 (a)載波數64之直視波都卜勒偏移已知線性通道估測時域間隔比較圖
(b)直視波都卜勒偏移已知線性通道估測與通道估測更新之比較圖
結論
本篇論文主要即是在討論高速鐵路的環境下，我們以正交分頻多工(OFDM)
無線通訊的技術，對於通道估測技術的表現作一個比較以及其效能的改善。無線
通道由於存在都卜勒效應(Doppler effect)、多路徑干擾(Multipath fading)、屏蔽
(Shadowing)等效應使得信號常受到通道的干擾而失真，而OFDM技術應用了多載
波並行的資料傳輸方式，使得每個子載波上的符碼時間(Symbol time)相較於傳統
的單一載波系統而言更長，因此像在城市等有很多反射物的地方，OFDM皆能有
效克服多重路徑所造成的干擾，所以OFDM技術便成為大家所熱烈討論的技術，
236
展，上述這幾種運輸方式已不再是少數先進國家所特有，許多已開發與開發中國
家也分別開始興建高速鐵路，目前除了先進國家與已開發國家持續興建高速鐵路
之外，中國甚至打算在 2006 至 2010 年間投資 12500 億人民幣興建長達近 7000km
的高速鐵路。可見高速移動將成為廣大群眾生活的一部份，不僅大幅縮短乘客的
通勤時間，也成為許多新型消費性電子產品的試金石，特別是與通訊環境緊密相
關的無線通訊系統，因此本研究將以高速移動環境為背景，開發具優良性能且低
複雜度之新型無線通訊接收機，以期在高速動環境下滿足消費者的通訊需求。
為了滿足使用者在任何時地均能使用具有良好服務品質(Quality of Service,
QoS)的網際網路服務，我們勢必要使用更好的傳輸方式，所謂的”更好”是指：更
高的傳輸速率、更可靠的傳輸品質與更低的使用價格。而目前最為廣泛討論的
OFDM 傳輸技術則為最有希望的候選者[15]，OFDM 傳輸技術有以下幾項特性：
 可用頻寬被切割成多個子頻帶(Subband)以傳送調變符元，再配合分時傳
送的 OFDM 符元，可大幅增加頻譜資源分配的彈性
 使用循環字首(Cyclic Prefix, CP)以消除 ISI 與維持子頻帶間的正交性，
 一個 OFDM 符元的區間之內，通道必需維持不變(Time-invariant)，
由第三點特性可知，OFDM 系統需要非時變通道(Time-Variant Channel)以維
持正常的運作，在固定的取樣速率下，這表示每個 OFDM 符元的長度將被通道
的同調時間(Coherence Time)所限制，而同調時間反比於都卜勒頻率(Doppler
Frequency)，這也表示在固定的載波頻率下，同調時間正比於移動速度，移動速
度越快則 OFDM 符元長度需要越短。於另一方面，由第二點特性可知我們需要
較長的 CP 以吸收 ISI，在符元長度縮短與 CP 維持不變的情況下，移動速度增加
將使得系統的輸出率將降低，造成頻譜資源的浪費。
因此，如何讓 OFDM 系統在時變通道下順利的運作就變的實際且重要，相
238
接收端在以同步機制獲得 FFT 操作範圍(時間同步)與頻率飄移(Frequency
Offset)的資訊之後，我們通常會先補償頻率飄移，接著去除 CP，再使用 FFT 以
得到接收端調變取樣(Modulation Sample)。這時候的調變取樣多半受到通道與雜
訊的影響，若不加以偵測與補償，將無法正確的還原資訊，所以我們需要對通道
做估測與等化。接收機在通道效應被補償之後對訊號進行解調，接著是經由錯誤
更正碼解碼獲得原有的資訊位元，圖 16.1 為一典型的 OFDM 系統的基頻傳收機
架構。
在瞭解 OFDM 系統的特性之後，我們可以理解為何高速移動環境會對系統
成嚴重的影響。由於高速移動將使一個 OFDM 符元期間的通道產生變化，也就
是所謂的時變通道，其所帶來的都卜勒效應(Doppler Effect)，這包括都卜勒飄移
(Doppler Shift)與都卜勒展延(Doppler Spread)，使子載波之間的正交性消失，不僅
產生相位與振幅的失真，子載波間也會產生所謂的載波間干擾(Inter-Carrier
Interference, ICI)，降低訊號的可識別性[16-17]。根據文獻記載[18-19]，只要最大
都卜勒頻率(Doppler Frequency)達到子頻帶的 5~6%，或是 OFDM 符元長度達到
通道同調時間的 8%，系統的效能就會開始大幅降低。因此本研究將以高速移動
環境下的低複雜度新型接收機為主題，提出新的通道估測與等化器。
240
的能量也無法收集回來，若不加以克服，則每個子載波的訊號對干擾與雜訊比
(Signal-to-Interference and Noise Ratio, SINR)將大幅衰減，降低資料的可偵測性
[15-17]。欲克服時變通道所帶來的失真，則必須使用多權重等化器甚至是結合多
權重等化器與 ICI 消除機制的先進接收機，前者可在資料取樣元尚未解調的情況
下消除部分的 ICI 與收集散逸至其他子載波的能量，等化的結果可直接送入解調
變器，或經由後者進一步提升訊號的可靠度並再進行解調。而為了避免多權重等
化器帶來過於龐大的計算量，單權重等化器搭配 ICI 消除機制也是一種可行的辦
法。
系統模型
而為了分析上的便利，本研究所使用的導引取樣均使用 MPSK 調變，由於
大多數的通訊標準均在導引取樣或訓練符元使用 BPSK，這個假設是合理的。資
訊位元將則被編碼與調變成取樣 ，調變方式則無限制。接著把資料取樣與導引
取樣以下列式子送進 IDFT
其中 為 IDFT 輸出的第 個取樣， 。一個長度大於通道長
度 的 CP 則附加在 IDFT 輸出的前端以形成一完整 OFDM 符元。
已知訊號將被放在特定子載波上以形成導引取樣或是被放在所有的子載波
上以形成一個訓練符元，這兩種情況將被分別定義為導引式傳送(Pilot-Based
Transmission)與訓練式(Training-Based Transmission)傳送。以導引式傳送來說，
個導引取樣， ，將被以等距離的方式放在可用頻寬上，其
中 假設為一正整數。以上假設不僅使分析變的可行，非時變最大概似
242
其中 、 與 分別為接收、發
射與雜訊訊號， 表示對刮號內向量或矩陣做轉置的動作。由於 有
的特性，因此頻域通道矩陣的矩陣元素可表示如下
的特性與其對等化器設計的影響可參考[22][25][27-28].
非時變最大概似通道估計子(Time-Invariant Maximum Likelihood Channel
Estimator, TI-MLCE)
在非時變通道的情況下，若使用被均勻的擺放在子載波上的導引取樣或是使
用訓練符元時，則 TI-MLCE 由於不需要反矩陣運算，因此實做所需複雜度相當
低。在此，我們僅推導導引式傳送的情況，訓練式傳送為其特例。在 OFDM 系
統內，TI-MLCE 可表示如下[20]
(16.1)
其中 為導引訊號的平均功率，而 為一置放導
引取樣於主對角線的對角矩陣。 與 為估計所得 CIR 與接收導引取樣所形成
之行向量， 為根據導引取樣與通道長度縮減的 DFT 矩陣，其元素表示如下
我們也立刻得到果 。在繼續推導之前，我們根據接收的導引
取樣分割與壓縮頻域通道矩陣成為 與 ，其維度分別為 與
244
接下來，我們分析 與 的均方誤差(Mean Square Error, MSE)，我們將證
明相較於一個 OFDM 符元內所有的 ，TI-MLCE 與 有最小的 MSE，我們
因此把 TI-MLCE 視為 的估計子。在導引式傳送的情況下，TI-MLCE 的 MSE
可推導如下
(16.3)
其中我們對資料、CIR 與雜訊做期望值。使用式(16.2), 式(16.3)可簡化如下
其中我們假設資料取樣、導引取樣與雜訊的不相關性。 、 與 分
別為導引取樣間干擾、資料取樣間干擾與雜訊的 MSE。 與 分別推
導如
(16.4)
與
(16.5)
246
接下來我們將證明在一個 OFDM 符元內，TI-MLCE 相對於 有最小的
MSE。我們先推導 與 的 MSE 如下
其中 包含了所有式(16.2)中的有害的效應，其平均功率為
。我們發現 與 TI-MLCE 誤差( )與平均與個別 CIR 間的誤差
( )有關。由於數學上的簡化，以上結果來自於對 CIR 與虛擬隨機導引取
樣取期望值，第三個等式為 與 互不相關的結果。由於其中 與
的不相關並不明顯，因此我們以下列的定理說明之。
定理：基於虛擬隨機導引取樣，在使用 TI-MLCE 之後，來自於其他導引取
樣的干擾與 OFDM 符元內各時間點的 CIR 互相不相關。
證明：略。
我們進一步推導 如下
248
圖 16.2 在不同 與 的情況下所最小取樣頻率
以區段為基礎的時域線性內插(Segment-by-Segment Time-Domain Piece-Wise
Linear Interpolation, STPL)
經過在前一節的討論後，我們瞭解到使用時域內插以增進通道估測的精確度
是可行的，考量複雜度與一般性，我們進一步把 STPL 分成兩個步驟內插與重複。
我們僅在一個 OFDM 符元內選定的位置做 數目的內插，該值可調整以順應規
範的複雜度、通道變化程度與所需的估測精確度，而其餘的點則以重複最近的內
插值來完成。
由於 通常為 2 的冪次，因此我們把 與 皆視為 OFDM 符元內的
中間點，這兩點的 CIR 近乎一樣。為了降低複雜度，我們僅在第 個 OFDM 符元
內的 等距點以第 、與 個 OFDM 符元所得 TI-MLCE 做 CIR 內插，如
圖 16.3 所示。內插的方式可以下列數學式表示之
250
性內插。
為了效能分析，我們僅考慮 OFDM 符元前半段的 CIR，原因是內插的過程
對稱於 OFDM 中間點，所以前半與後半符元的 MSE 是完全相同的，也就是
.下列式子將用於簡化分析
接著我們推導 MSE 如下
其中 為第 個 OFDM 符元中所有包含於式(2)中的有害的效應，平均功率為
。根據上一節所得 的特性與一些代數代數運算，我們可得
其中 僅出現在第三行，由於 與 的距離隨著 增加，因此 也隨著
252
表 16.1 系統參數
表 16.2 多路經衰減模型
觀察式(16.7)與(16.8)， 、 與 均隨著 遞增，所以 TI-MLCE
的精確度隨著 遞減。當 遞增時， 維持不變， 與 則遞減，所
以 遞減。另一方面，當 遞增時， 與 維持不變， 遞減，
因此 遞增。我們的分析解釋了參數所帶給 TI-MLCE 的效應。
由於 與 與連加有關，我們無法觀察這兩個參數與給 、 與
之間的關係，因此我們以圖 16.4 說明之。結果說明 與 無關，但會
隨著 遞增；然而 隨著 遞增並隨著 遞減。主要原因為 由導引取
樣間干擾所組成，因此與 有關。而增加 與固定 表示增加資料取樣，因此增
加了 。
254
小增加時，錯誤地限變的更為明顯。以 而言，由都卜勒效應所產生的
MSE 地限發生在 dB 時。根據式(16.6)，對於不同的 與 ，Channe
A 與 B 之間的效能差異固定在 dB，這個現象也出現在非時變通道[20]。
圖 16.5 使用 與 時， 與 的分析與模擬結果，
與 分別使用實線與點線。
為了瞭解 與 之間的差異，我們已在上一節作了分析，這裡我們將提
供模擬結果以作為驗證。如同圖 16.6 所示，分析與模擬結果一致， 與
之間的差異為 。比較圖 16.7(a)與(b)，由於較嚴重的都卜勒效
應， 會導致較大的差異，此時不僅 ICI 會干擾導引取樣，CIR 也有可能
在一個 OFDM 符元間產生非線性變化，這使 與 之間的差異增加。而差
異也會在使用較多的導引取樣時變的明顯，原因是因為 變小使得
成為主要錯誤來源。
256
我們使用固定導引取樣以驗證虛擬隨機導引取樣的假設，為了觀察不同的導
引取樣是否會產生不同的結果，對每個不同的 ，我們使用 100 個不同的導引
取樣，因而產生不同組曲線。在圖 16.8，我們觀察到不同的導引取樣在
時產生了相同的結果，原因是因為不同的導引取樣僅僅影響
，而根據圖 16.5 我們知道其大小遠小於 。即使 這種導引式
傳送的極端例子，在 時， 與 仍有超過 10 dB 的差距。因
此我們得知對於導引式傳送，使用虛擬隨機導引取樣並不影響我們分析的結果。
然而對於訓練式傳送，當 SNR 遞增時，效能開始變的不一樣。因此我們提供了
平均後的結果，平均後的結果與分析結果吻合，證明了我們分析結果實際上評估
了 TI-MLCE 的平均效能。
圖 16.8 各群曲線為使用 、Channel B 與固定導引取樣的 模擬結
果， 的分析結果則以圓圈表示。
在上一節我們已知 在 有最小值，圖 16.9 驗證了
我們的分析結果。即使 經歷了較嚴重的都卜勒效應，使用更多的導引取
258
圖 16.10 使用 、 與 Channel B 的 分析(符號)與模擬(實線)
結果。在每張圖裡，曲線從上到下分別使用 。
圖 16.10 展示了不同 、 與 SNR 其況下 ，曲線的不規則主要來自於
使用較小 時所引起的重複錯誤。當 SNR 增加時，由於內插錯誤成為主要的誤
差來源，因此這個效應變的更為明顯。 增加可使效能獲得改善，而在
時，我們即可獲得滿意的結果。由於更大的 僅能改善些微的效能，因此額外的
內插可以節省下來以降低複雜度。實際的應用上，在獲得系統參數與期望的通道
環境之後，可藉由分析結果建立查詢表。
比較圖 16.9 與 16.10，所有時間點 CIR 都被提升至與 類似等級的精確
度。當使用較小的 或較大的 SNR 時，也就是 的精確度遠比其他 來的高
時，我們可獲得更大的改善。當使用較大的 或較小的 SNR 時，也就是誤差來
源是雜訊時，相較於 ， 從符元邊界開始增加，並在中間點達到最大
值。原因是因為跨符元的內插產生了減輕雜訊的效果，當使用較小的 或較大
的 SNR 時，因為這時主要誤差來源是內插，這個效果變的不明顯。
另一方面，若我們使用固定導引取樣，我們可觀察到類似於圖 16.8 的現象。
當我們使用導引式傳送或低 SNR 時，我們觀察到一至的結果；當我們在高 SNR
使用訓練式傳送時，我們則觀察到發散的結果。
260
或是數據資料傳輸的服務。無線通訊技術的演進，由過去的 GPRS(General Packet
Radio Service)以至於現在佈建將近完成的 3G 網路，到未來的 WiMAX(Worldwide
Interoperability of Microwave Access)或是 4G 行動通訊，目的都是為了讓使用者
除了使用單純的語音通話服務之外，還能進一步的使用多媒體服務。能夠隨時隨
地的收發電子郵件、瀏覽網頁、甚至是觀賞即時影音已經成為未來無線通訊技術
的基本指標。
但是到了高速移動環境，尤其是移動速度到了 300 km/h 甚至更快的時候，
無線通訊便會遇到另一個難題，以 GSM(Global System for Mobile Communication)
為例，規格上所能達到的最高移動速度為 250 km/h，已不足以在高速移動的環境
中應用。因此我們必須針對 OFDM 系統在高速移動的環境下所面臨的問題來設
計一套通訊系統，使得使用者可以在如此高速移動環境下進行語音甚至多媒體傳
輸。在此我們以台灣高速鐵路的現況為例，來討論高速鐵路的通訊系統架構，之
後討論移動環境下所面臨的一些問題。
本篇論文主要在探討當較少載波時的 OFDM 系統是否可以利用渦輪等化器
來改善隨移動環境越快而更加惡化的位元錯誤率(Bit Error Rate；BER)，進而探
討較多載波時的 OFDM 系統所會面臨到的問題，並利用渦輪等化器來改善之，
之後在使用高速鐵路列車的行徑的路徑與列車速度均具可預測（predictable）性，
以減少投入的資源並能達到一個可接受範圍的錯誤率，針對這樣特殊的環境來設
計一個適用於此環境的通訊系統。
研究的問題
這邊先簡單列出高速移動環境下主要面臨的問題。
1. 都卜勒偏移(Doppler Shift)
262
0.76ms。
當在高速移動環境下所造成的通道快速變化的原因，對 OFDM 系統來說，
都卜勒效應會造成 ICI 效應，而多路徑效應則會造成 ISI 效應，這兩種效應對於
OFDM 系統的表現都有很大的影響，而高速移動環境下以 ICI 效應尤其嚴重，如
何有效克服 ICI對OFDM系統來說是一大難題，因此我們必須想辦法來讓OFDM
系統能夠克服 ICI 效應，而克服 ICI 效應的方法有很多，本篇論文選擇討論在接
收端使用渦輪等化器的方式來幫助 OFDM 系統抑制 ICI 的影響。
目前已有許多 OFDM 系統結合渦輪等化器的研究，這些研究已經證明渦輪
等化器能夠在低速的移動環境下有效幫助 OFDM 系統消除部份 ICI 效應
[45][46]，但是當在高速移動環境下的情形卻鮮少有人討論，所以我們嘗試延續
[44].中的渦輪等化器架設在 OFDM 系統情形下，解決高速移動環境下所衍生的
問題，並利用觀察系統的位元錯誤率(Bit Error Rate；BER)，檢視 OFDM 系統結
合渦輪等化器的架構是否可以在高速移動環境下實現。
主要的結果和討論
由[44]可以知道渦輪等化器在高速移動環境下的表現，所以我們希望能夠延
續[44]討論渦輪等化器是否可以用來改善 OFDM 系統所會面臨到的問題，本篇論
文延續[44]的渦輪等化器架構，加入 OFDM 系統來加以討論之，其基本架構圖如
圖 17.1 所示。其中除了發送端的 OFDM Function 及接收端的 De-OFDM Function
以外，其餘皆是延續[44]王中和學長之架構作微幅更改。
264
0 5 10 15 20 25 30
10
-7
10
-6
10
-5
10
-4
10
-3
10
-2
10
-1
10
0
Symbol Time = 5e-008, Training Bits = 32
MAX Block NO. =2000, N1 = 4, N2 = 2, Rural Area with speed = 300km/h,
Iteration 00
Iteration 01
Iteration 02
圖 17.2 FFT 點數為 64 OFDM pilot 投資比例為 1/12 時 SNR 對 BER 作圖
1. FFT 點數為 256 點，進入 OFDM Function 之前的框架格式為 32 個資料符碼
緊接 32 個訓練序列。
0 5 10 15 20 25 30
10
-7
10
-6
10
-5
10
-4
10
-3
10
-2
10
-1
10
0
Symbol Time = 5e-008, Training Bits = 32
MAX Block NO. =2000, N1 = 4, N2 = 2, Rural Area with speed = 300km/h,
Iteration 00
Iteration 01
Iteration 02
圖 17.3 FFT 點數為 256 OFDM pilot 投資比例為 1/8 時 SNR 對 BER 作圖
2. FFT 點數為 512 點，進入 OFDM Function 之前的框架格式為 32 個資料符碼
266
圖 17.5: FFT 點數為 1024 OFDM pilot 投資比例為 1/2 時 SNR 對 BER 作圖
上面各圖為使用不同 FFT 點數下的模擬結果，我們所設定的目標是使用最
低比率的 OFDM pilot 比例讓位元錯誤率能夠降至 510，如此將可以得到最佳的資
料傳輸率，我們將結果列為下表：
FFT
點數
64 256 512 1024
Pilot 1/12 1/8 1/8 無法到達 510
資料傳輸率 7.42Mbps 7.11Mbps 7.11Mbps 無法到達 510
接下來我們希望能夠利用高速鐵路路徑已知的特性改進位元錯誤率並且降
低訓練序列比例增加資料傳輸率。因為高速鐵路所經過的路徑是固定的，所以我
們假設列車可以利用過去所收到的通道資訊得到一個平均的通道頻率響應
(channel impulse response；CIR)，或是在發車前先派遣一個車廂來進行通道估測
以得到通道頻率響應，並且假設通道變化不大，利用這些通道頻率響應來幫助
OFDM pilot 作通道估測的部份，再來檢視後端渦輪等化器輸出的錯誤率表現。
1. 通道頻率響應已知 FFT 點數為 64 點
268
3. 通道頻率響應已知 FFT 點數為 512 點
0 5 10 15 20 25 30
10
-7
10
-6
10
-5
10
-4
10
-3
10
-2
10
-1
10
0
Symbol Time = 5e-8, Training Bits = 32
MAX Block NO. =2000, N1 = 4, N2 = 2, Rural Area with speed =300 km/h,
Iteration 00(known CIR)
Iteration 01(known CIR)
Iteration 02(known CIR)
Iteration 00
Iteration 01
Iteration 02
圖 17.9 FFT 點數為 512 點通道頻率響應已知情形
4. 通道頻率響應已知 FFT 點數為 1024 點
270
圖 17.11 固定訓練序列長度 32 下資料序列長度對 BER 做圖
因此我們以 FFT 點數為 64 點，OFDM pilot 投資比例為 1/8 下固定訓練序列
長度為 32，以資料序列長度為 256 與 32 對位元錯誤率做圖。
圖 17.12 固定訓練序列長度 32 下資料序列長度對 BER 做圖
此時可以發現其實位元錯誤率並不會有太大的影響，但是對於資料傳輸率將
提升至 14.22Mbps。
結論
本篇論文主旨為討論在超高速移動環境下渦輪等化器結合正交載波多工系
統的可行性，我們可以得到的結論是 FFT 點數有其上限所在，在要求位元錯誤
率在 510的情況下，FFT 點數最多只能到達 512，而在 FFT 點數為 1024 的情況下
位元錯誤率會有嚴重的衰退。再來若是我們可以結合高速鐵路通道已知的特性，
我們將可以大幅改善位元錯誤率，此時 FFT 點數 1024 點的可行性就有討論的空
272
研究的問題與解決
早期的可適性調變局限於單向傳輸，並且假設有一完美通道讓接收端通知發
送端下一次的調變位階資訊。這種假設雖然可以使用相當複雜的編碼技術達成目
標，可是在現實的環境裡，還是會有因為通道條件變的相當的差，而使得調變位
階資訊錯誤的情況發生。
傳統式的 OFDM 可適性調變主要存在著三個不合理的假設
(1) 此種架構只能單方向性傳輸，不符合現今無線通訊的雙方向性傳送。
(2) 帶有調變位階的子載波必須不受時變通道的影響，否則有可能因為時變通道
的衰減，而無法將整個 OFDM 的符碼正確的解調還原成數位資料。
(3) 接收端送回發射端的下一次調變位階訊號必須經過完美通道，換句話說，不
會有錯誤發生，否則無法進行下一次的傳送。
本篇論文使用的方法為利用領航字元(Pilot)的錯誤率改變下一次要傳送出去
的調變位階。而且調變資料當中不需要包含調變位階的訊息，使用的方法為接收
端將領航字元取出後用不同的解調器解調，再計算該錯誤率，取最低的錯誤率的
調變方式就是整個 OFDM 的調變位階。另外也將 OFDM 劃分成不同的區塊，每
一個區塊用不同位階的調變方式調變，這樣可以使得整體的產出量達到最大。
本論文使用雙向性可適性調變改善傳統式的 OFDM 可適性調變，改變的主
要機制是使用 OFDM 的領航字元(Pilot)的調變方式和位元錯誤率。雙向性可適性
調變的架構圖和模擬條件如下。
274
本論文考量的環境是在高速移動下的無線通訊架構，利用 OFDM 的方式傳
送資料。兩個端點的發射器與接收器指的是基地台與高速列車上的天線無線連
結，就是所謂的雙鏈架構(Two link architecture)[30]，如圖 18.2。不考慮使用者獨
自與基地台連線的狀況
圖 18.2 基地台與列車的架構圖
通道的模型是採用 COST 259 RA (Rural Area)[38]的條件進行模擬，該通道模
型目前被 UMTS 標準選用，速度選擇為時速 300 公里。並且假設在一次性的接
收資料與發射資料的期間通道的環境條件不改變。
主要的結果和討論
由圖 18.3 模擬結果所示，雙向性可適性調變的架構確實如前所述，可以利
用領航字元的位元錯誤率達到切換調變位階的目地。因為整個 OFDM 的符碼為
276
圖 18.4 雙向性 OFDM 可適性調變位元錯誤率圖
接下來想要探討的主題是當整個 OFDM 的子載波個數增加時，因為高速移
動而造成的時變通道對於擁有更多子載波的 OFDM 符碼來說傳輸的品質會更加
惡化，如果可以將整個資料的子載波劃分成不同的區塊，如圖 18.5 所示，當某
個區塊有錯誤時，可以降低該區塊的調變位階，如此可以增加整體的產出量。
圖 18.5 區塊式雙向性 OFDM 可適性調變領航字元區塊圖
因為在傳輸資料當中帶有調變位階，會存在著被時變通道影響而無法得知調
變位階的風險。為了避免在傳輸資料當中帶有調變位階的資訊，本架構更改成只
有兩種調變位階的機制，選用的是 QPSK 和 8PSK 兩種調變方式。架構圖和模擬
278
圖 18.7 區塊式雙向性 OFDM 可適性調變產出圖(FFT=1024)
原本 8PSK 的產出量應該要在高 SNR 時超越 QPSK 的產出量，但由圖 18.7
中可以看出當子載波的個數增加時，8PSK 的產出量並沒有超越，這是因為受到
ICI 影響的結果。ICI 的解決問題並不在本篇論文討論故以下不再探討。
在圖中可以看到因為採用了區塊式雙向性 OFDM 可適性調變的演算法，其產出
量會高出固定調變位階的系統。
280
19 正交分頻多工系統在超高速移動環境下的低複雜度載波間干擾消除機制
引言
今日的多媒體服務，仍然以定點的無線接取為主，如學校ˋ捷運車站或是部
份公共空間。在移動式的交通工具，如公共汽車ˋ飛機以及已經通車的高速鐵路
上，仍然無法提供足以應付多媒體服務的頻寬。以GPRS為例，僅有約40 ~ 50 kbps
的速率，3G 的 IMTS-2000，雖然在室內靜止的環境可提供 2 Mbps 的速率，但在
移動時僅有 384 kbps。
智慧型運輸系統( Intelligent Transportation System, ITS )將多媒體通訊的服
務，延伸到移動的行動工具上。而正交分頻多工系統( Orthogonal Frequency
Division Multiplexing, OFDM )不但能提供高資料傳輸量( high data rate )，且對於
屏蔽( Shadowing )有較高的抵抗力，也能利用保護區間( Guard Interval, GI )，有
效地克服相鄰符元間干擾( Inter-Symbol Interference, ISI )，同時具有較高的頻譜
效率( Frequency efficiency )，故已被廣泛地應用在無線傳輸上。但考慮高速移動
的環境，尤其是移動速度超過 300 km/hr 的超高速移動環境，如高速鐵路，原有
的無線通訊架構面臨極大挑戰。以目前 GSM( Global System for Mobile
Communication )為例，規格上所能支援的最高移動速度為 250 km/hr， 已不足以
在超過 300 km/hr 的超高速移動環境中使用。
而考慮以 OFDM 架構來達到高速率的行動式寬頻無線通訊，也由於子載波
間正交性隨著移動速度增加的破壞，使得位元錯誤率( bit error rate, ber )達到無法
容忍的限度。故修正子載波間的正交性，成為以 OFDM 為架構的高速移動式寬
頻無線通訊的重要問題，本論文即在探討低複雜度改善位元錯誤率的方式。
研究的問題
282
OFDM 架構尚足以運作，故本論文的討論著重在高點數的情況下。由於傳統
OFDM 使用的單抽頭等化器（ One-Tap equalizer ）已無法補償 ICI 所造成的錯
誤率，故舊有文獻均提出許多等化矩陣來補償 ICI 現象，但其複雜度均太高，略
低複雜度的機制會帶來 0.5~1 個指數層級錯誤率的上升，且有錯誤累加的問題，
故提出利用等化矩陣的對稱性以及稀疏性( sparse diagonal dominant matrix )，採
用 Jacobi iteration 演算法來取代反矩陣運算，再利用 Cos259RA 環境特性，有效
降低其複雜度且改善錯誤率。
考慮低複雜度系統架構的前提，我們希望不僅只在接收端的等化器提出改良
的設計，還能能更進一步地延伸到通道估測設計上。故利用各種通道估測技術，
探討估測誤差和位元錯誤率之間的關係，從中獲得最佳的通道估測投資比例。而
通道估測方式可分為時域估測以及頻域估測，傳統 OFDM 架構所使用的頻域估
測，在高移動速度時無法有效改善錯誤率，這是由於其未考慮時變通道效應的原
因，故從中我們可以知道在時變通道中應採用時域估測的方法。而用以評估估測
效率的指標為均方根誤差，同時對照在不同點數時利用所提出低複雜度 ICI 消除
機制的位元錯誤率，可前後做一分析討論，進而定出一合理的估測誤差容忍下限。
而我們也可利用鐵道環境中路徑已知資訊再次降低系統的複雜度以及效能
的提升，其中多路徑延遲時間已知可改善通道估測均方根誤差，而都卜勒偏移值
已知的情況，藉由移動速度已知和行進路徑與基地台的夾角已知，補償直視波的
都卜勒偏移。
主要的結果和討論
我們提出的低複雜度 ICI 消除機制如下圖所示：
284
0 5 10 15 20 25 30 35
10
-5
10
-4
10
-3
10
-2
10
-1
fft=64, fd=555, Cost 259 RAx
ebn0
be
r
full matrix
2-iteration
one-tap equalizer
圖 19.2 FFT 點數為 64
0 5 10 15 20 25 30 35
10
-4
10
-3
10
-2
10
-1
ebn0
be
r
fft=512, fd=550, Cost 259 RAx
full matrix
2-iteration
one-tap equalizer
286
0 5 10 15 20 25 30 35
10
-5
10
-4
10
-3
10
-2
10
-1
10
0
ebn0
m
se
fft=64, fd=555, Cost 259 RAx
Method 1
Method 2
Method 3
Method 4
Method 5
圖 19.4 FFT 大小為 64 時，其 MSE 之表現
0 5 10 15 20 25 30 35
10
-6
10
-5
10
-4
10
-3
10
-2
10
-1
10
0
ebn0
m
se
fft=512, fd=555, Cost 259 RAx
Method 1
Method 2
Method 3
Method 4
Method 5
288
0 5 10 15 20 25 30
10
-3
10
-2
10
-1
ebn0
be
r
fft=512, fd=555, Cost 259 RAx
Method 1
Method 2
Method 3
Method 4
Method 5
圖 19.7 FFT 大小為 512 時，其 BER 之表現
首先，無論其 FFT 點數為何，方法五的位元錯誤率的效能始終是最好，此現
象符合其均方根誤差的表現。而在 FFT 大小為 64 點的時候，由於正規化都卜勒
值小，ICI 效應之影響不明顯，故在位元錯誤率的表現上，在高訊雜比時，均能
到達 10^-3 次方甚至更低。但對照其均方根誤差，我們可先將其分組，方法 1 及
方法 3 為一組，方法 2 及方法 5 為一組，方法 4 又為另一組，這三組的表現均有
明顯差異，但此差異卻沒有反應在位元錯誤率的表現上，觀察位元錯誤率的表
現，雖略有差異，但在高訊雜比時，已無明顯區別。
上述現象在 FFT 大小為 512 點的時候更為明顯，同樣我們可以發現除了傳
統 OFDM 架構的估測法之外，其餘方法的位元錯誤率表現幾無差異，反觀其均
方根誤差的表現，可分為 4 組，方法 1 及方法 3 歸類為一組，4 組均方根誤差的
表現均有一個指數層級以上的差異，但在位元錯誤率的表現上，卻沒有同樣程度
的改進表現。
290
0 5 10 15 20 25 30 35
10
-5
10
-4
10
-3
10
-2
10
-1
fft=64, fd=555, Cost 259 RAx
ebn0
be
r
full matrix
2-iteration
one-tap equalizer
fuu matrix( fd )
2-iteration( fd)
one-tap equalizer( fd )
圖 19.8 FFT 點數為 64，路徑延遲有無已知的位元錯誤率表現
0 5 10 15 20 25 30 35
10
-4
10
-3
10
-2
10
-1
fft=512, fd=555, Cost 259 RAx
ebn0
be
r
full matrix
2-iteration
one-tap equalizer
full matrix( fd )
2-iteration( fd )
one-tap equalizer( fd )
292
啟動了 TW4G 的規劃。
在高速鐵路與高流量的網路服務漸漸普及的二十一世紀，如何提供高速鐵路
乘客一個穩定且高速的無線通訊將慢慢變成主要問題之一。以目前的手機 GSM
（Global System for Mobile Communication）系統為例，規格上所能提供的移動
速度約為 250km/hr，仍不足以完全提供高速鐵路之用。在傳輸技術方面，由於
正交分頻多工（Orthogonal Frequency Division Multiplexing; OFDM）不但對多路
徑干擾（Multipath interference）、遮蔽效應（Shadowing）有較高的抵抗力，同時
也擁有較高的頻譜效率（Frequency efficiency），有機會成為未來無線通訊的明日
之星。因此 IEEE 802.11（針對 Wireless Local Area Network, WLAN）、802.16（針
對 Wireless Metropolitan Area Network, WMAN）皆將此項技術列入其最新的標準
當中，此項技術也希望能夠成為未來 4G 的共同規範。但諸如 802.11a/b/g、
802.16/a/c/d 等都是為了定點使用所設計，即使是針對移動環境所提出的
802.11a/RA（Roadside Applications）在高速移動的情況下也面臨了效能不佳的問
題，802.16e 雖然也納入移動的標準，速度也只能達到約 120km/hr。
OFDM 系統在高速移動環境效能有所損失，但值得慶幸的是，在我們目前
所考慮的台灣高鐵環境下，鐵道路徑、列車速度以及周遭地形都是可以事先預測
的，這使得我們容易取得部份通道訊息，將對整體效能有所提昇。因此，本篇論
文將針對此種特殊通訊環境下的 OFDM 技術，特別是採用 802.16d/e OFDM 規格
的可行性，作一連串的效能研究，並提出適用於此環境的參數設計。最後，我們
考慮部份通道資訊已知的效能變化與系統複雜度的分析。
研究的問題
通道模型
294
圖 20.2-
圖 20.2 為雙鏈架構基本圖。其中 GBS 為地面基地台，TBS 為列車收發器，
CBS 為車廂收發器，CBS 可以每個車廂都設置，或是每隔數個車廂設置。若 TBS
與 CBS 只負責多工/解多工（Multiplex/ Demultiplex），基地台功能仍屬地面基地
台 GBS，此種解決方案稱為使用集中器之雙鏈架構。如此一來，TBS 與 CBS 將
會收集列車上的訊息，再經由一個匯合鏈結（Trunked link）與 GBS 連線，因此
可以大量的減少訊號負載，如換手訊息都可以利用較簡易的方式達成。缺點是在
使用 UMTS 競爭機制時會發生問題。如果 TBS 擁有完整的基地台功能，可將列
車分為數個微細胞（Picocell），此時 TBS 對列車上的資源將能夠進行完整的分
配，同一列車上無線設備之間也不需透過地面基地台，只需透過 TBS 即可進行
通訊。但因在列車上規劃可移動的基地台設備將會與現有的地面上 UMTS 網絡
互相影響，所以需要另加額外的非標準設備避免影響原有的系統運作。
另外還有一種被稱為 super mobile option 的解決方案。在此架構中基地台的
功能被分配給 TBS 與 GBS，匯合鏈結將被視為透明的（Transparent），列車裡的
使用者設備將 TBS 當作是他們的基地台，而 GBS 將 TBS 當作是一個會建立許
多通話的 super mobile。GBS 可將匯合鏈結的優先度（Priority）調高，加強連線
的可靠度。匯合鏈結則可對列車內的通話作排程（Scheduling）及對 GBS 要求頻
寬資源，統合之後決定通話的建立與否。
在這些解決方案中，我們在兼顧訊號可靠度與可調性的前提下，建議使用雙
鏈架構下的 super mobile 作為最後的方案，主要是此方案可以解決一次需要傳送
大量換手訊號的問題，傳輸損失與都卜勒偏移也可以利用列車上的硬體作補償，
296
繞射等現象，使得發送端與接收端之間存在不只一條傳輸路徑，因此接收端接收
到的訊號實際上是由許多不同的路徑相互破壞或加強而成。這樣的現象稱為多路
徑效應。我們可將通道的脈衝響應以下列式子來表示：
1
( , ) ( ) ( , )
L
i i
i
h t a t t  

 （20.1）
其中 L 為多路徑所產生的入射波數量， ( )ia t 為每一個路徑波的振幅，機率分佈
為 Rician 分佈或 Rayleigh 分佈，並且每一個入射波都符合古典的都卜勒頻譜
（Classical Doppler spectrum）。而且由於都卜勒效應的影響，入射波會因入射角
度的不同，在頻率上產生變化，使得(20.1)中的 ( )ia t 、 ( , )it  為時變，通道為時
變（Time variant）通道。
在擁有直視波的情況下，此直視波將使得多路徑效應的第一個路徑振幅呈現
Rician 分佈，而其他路徑為 Rayleigh 分佈。如果沒有取得直視波，則所有路經皆
為 Rayleigh 分佈。在 Rician 分佈中，通常我們會定義一個參數，K（Rician factor），
來表示直視波的能量與路徑延遲波能量的比值，如(20.2)。K 越大表示直視波的
能量相對路徑延遲波越強，K 越小則反之。當 0A ，K 時，Rician 分佈
會衰退成 Rayleigh 分佈。
2
2( ) 10 log 2
A
K dB dB

 （20.2）
在通道模型方面，我們採用以 ACTS MOSTRAIN 計畫為範本，此計畫的目
的在於延伸 UMTS 系統至高速鐵路的環境。所以在後續的討論中，我們將選用
可對應 UMTS 標準的 COST 259 作為模擬時的通道模型，並假設中心頻率為與
UMTS 相近的 2GHz。COST 259 的通道模型分為三種，（a）適用於空曠地區，
障礙物較少的 RA，（b）適用於路徑延遲多的都市區域的 TU 及（c）適用於山區，
延遲多且一定時間延遲較大的 HT。圖 20.4 分別為三種通道模型之傳播功率延遲
分佈圖（Power delay profile）。
298
1
5C
B

 , 22    （20.3）
其中 為通道的均方根延遲分佈（rms delay spread），為路徑延遲時間。我們
可計算出 Cost 259 通道模型的同調頻寬分別為 RA：2 MHz，TU：0.4MHz，HT：
0.0658MHz。
同調時間 CT 則是跟相對移動速度有關的估算值，在此時間內，通道的脈衝
響應可以看成是幾乎不變的。同調時間的計算方式如下：
2
9 0.423
16C m m
T
f f
  （20.4）
其中  maxm df f 為最大都卜勒偏移。若符碼時間遠小於同調時間，此通道可被
視為緩慢衰減（Slow fading）。若符碼時間大於同調時間，則為快速衰減 （Fast
fading）。相對時速達到 300 公里時同調時間約為 770s。
IEEE 802.16d/e實體層
IEEE（Institute of Electrical and Electronic Engineers）從 2001 年發佈 802.16
標準到 2005 年完成 802.16e 標準。其中 802.16d 整合了 802.16/a/c 標準，最後發
表的 802.16e 標準則是在 802.16d 的基礎上提供車行速度 120km/hr 的移動性支
援。為了支援移動通訊，802.16e 對於 802.16d 所作的更動大多在媒體存取控制
層（Media Access Control Layer; MAC Layer），包括兩種軟式換手（Soft Handover）
機制：MDHO（Macro Diversity HandOver）、FBSS（Fast BS Switching），與增加
睡眠模式（Sleep mode）的節能機制。在實體層（Physical layer）則主要針對正
交分頻多工多路傳輸技術（Orthogonal Frequency Division Multiple Access;
OFDMA），增加次載波數為 128、512、1024 的支援。
為了應付不同的通道狀況和傳輸需求，802.16d/e 實體層訂定了相對應的標
準。包括在直視波下操作，較短波長的 10-66GHz 的頻段，具有多路徑干擾不明
300
傳子訊框（UL subframe），兩個子訊框之間則以發送轉換間隙（Transmit Transition
Gap; TTG）與接收轉換間隙（Receive Transition Gap; RTG）所隔開，避免訊號
互相重疊干擾並使得基地台/用戶端元件能即時的轉換收發狀態。
圖 20.6
在下傳子訊框當中，第一個欄位為前置碼（Preamble），此前置碼由兩個連續的
OFDM 符碼所組成，作為初始同步、信號增測、通道估測之用。第一個 OFDM
符碼只取索引為四的倍數的次載波作快速傅立葉反轉換，頻域上的產生方式如下
式：
4 64 ( )
2 2 ( ( ))
0
A L L
x k
con j P k
P
  

mod 4
mod 4
0
0
k
k


（20.5）
因此在時域上來看，第一個 OFDM 符碼包含了連續四段相同的片段（Fragment），
每一個片段長 64 點。第二個 OFDM 符碼則取索引為偶數的次載波作快速傅立葉
反轉換，在時域上為接續的兩段相同片段，每一個片段長 128 點，產生方式如下：
( )
2 ( )
0
A L L
E V E N k
P k
P
 

m o d 2
m o d 2
0
0
k
k


（20.6）
此兩個 OFDM 符碼便構成下傳子訊框的前置碼，此前置碼亦稱為長前置碼（Long
preamble），如圖 20.7(a)所示。緊接著長前置碼的為一個 OFDM 符碼長度的 FCH
（Frame Control Header）欄位，使用 QPSK 調變，用來記載後續資料的調變型態
與長度，接收端可利用 FCH 的內容來解析出後面符碼所搭載的訊息。
302
圖 20.9
正交分頻多工（Orthogonal Frequency Division Multiplexing; OFDM）技術為
多載波調變系統之一。一開始的資料經過編碼、擾亂之後，經過基本的調變對應
到星座圖上，接下來利用 N 點的快速傅立葉反轉換 IFFT，將頻域訊號轉成時域
訊號，並對應到 N 個次載波，使得次載波之間的訊號具有正交性。此時，在相
同的傳輸速率下，OFDM 系統的符碼時間為單一載波系統的 N 倍。接著，訊號
將在時域上延展一定比例的保護區間（Guard Interval; GI）以形成一個基本的
OFDM 符碼。通常我們利用週期前置（Cyclic Prefix; CP）的方式產生保護區間，
保護區間的功用是收集多路徑所帶來的干擾，以保持次載波之間的正交性。
OFDM 雖然利用次載波之間正交的特性提昇了頻譜使用效率（Bandwidth
efficiency）。但是相對的，因為正交性對 OFDM 系統如此的重要，使得 OFDM
系統對於載波頻率偏移、取樣頻率偏移、相位雜訊較為敏感。除此之外，由於訊
號是由許多次載波的訊號組合而成，較高的 PAPR（Peak-to-Average Power Ratio）
值也使得功率放大器的線性區間較大，這些都是 OFDM 系統需要解決的問題。
在非時變通道（Time invariant），只要保護區間大於最大延遲時間，的確可
以有效的抵抗 ISI 效應，進而保持次載波間的正交性。然而，在移動環境下，因
為都卜勒效應的影響，通道狀況會隨著時間改變，這時通道特徵會在一個 OFDM
符碼內改變，使得各個次載波之間正交性喪失，此種現象被稱為次載波間干擾
（Inter-Carrier Interference; ICI），將造成載波干擾比（C/I ratio）下降，進而使得
有效的訊雜比（Effective SNR）降低。
304
通道頻寬 20MHz，平均訊噪比為 30dB 的假設下，載波頻率偏移對 SNR 的影響。
結果我們發現系統 SNR 下降 D 約只有 0.0212dB。而 SNR 下降 D 跟次載波數 N
的平方成正比，因此我們可以發現 802.11a/g 與 802.16d/e 因高速移動所造成的載
波頻率偏移，進而產生的 ICI 問題都是可以被忽略的。
傳輸訊號在經過無線通道時會因為多路徑效應、AWGN 等的污染而造成失
真，使得接收到的訊號在相位、振幅發生了改變，為了消除這些無法完全掌握的
通道響應，我們在接收端可利用不同的通道估測與等化器，來補償通道所造成的
干擾。本論文討論的是利用 pilot 輔助式的通道估測法（Pilot-symbol-aided channel
estimation），即在傳送端符碼訊號的同時加入已知的 Pilot 符碼，然後在接收端利
用這些已知的訊號進行通道估測。這邊我們考慮兩種主要的 pilot 排列方式，第
一種如圖 20.10(a)，pilot 在固定的時間佔滿所有次載波，此種 pilot 排列方式稱作
塊狀分佈（Block-type pilot arrangement）。第二種如圖 20.10(b)，pilot 在固定的次
載波被連續傳送，此種 pilot 排列方式稱作梳狀分佈（Comb-type pilot
arrangement）。
圖 20.10 (a)塊狀分佈（Block-type） (b)梳狀分佈（Comb-type）
傳統的通道估測方法，由於較不考慮相對速度的問題，因此在沒有都卜勒效
應的情況下，同調時間理論上是無限大的，因此多採用塊狀排列的方式，固定時
間的通道估測值將沿用至下一時間的 OFDM 符碼。然而，在高速移動的環境下，
同調時間隨著都卜勒頻率的上升而下降，以一般的經驗法則而言，pilot 在時間上
的間隔必須小於同調時間的十分之一，才能有效的解析出通道響應。另外，pilot
306
根據二維（Two-dimension）的取樣定理，pilot 的間距必須滿足(20.12)與(20.13)，
才能正確解析出通道的參數。
1 / 2m s Kf T N  （20.12）
m ax 1 / 2LfN   （20.13）
其中 KN 代表 pilot 在時域上必須間隔的 OFDM 符碼數， LN 代表 pilot 在頻域上
必須間隔的次載波數， mf 為最大都卜勒頻率， max 為通道的最大延遲時間
（Maximum delay spread）， f則為次載波間距。根據經驗法則（Rule of thumb），
若要在效能與實用上複雜度之間取得平衡，(20.12)與(20.13)應分別改為下兩式：
1 / 4m s Kf T N  （20.14）
m ax 1 / 4LfN   （20.15）
從 IEEE 802.16d/e OFDM 的參數，並考慮我們所使用的通道模型為 COST
259 RA，其最大延遲時間 max 為 0.528 s，因此我們分別可以得到 KN 約為 32，
LN 約為 6。若要符合緩慢衰減與平坦衰減的條件，可得到 KN 約為 5， LN 約為 2。
但為了要在我們選擇的高速移動環境下使用，在考慮系統效能與配置之後，我們
實際選擇 KN 為 5， LN 為 5。也就是說，我們在時域上每隔 5 個 OFDM 符碼就插
入一個 pilot，在頻域上每隔 5 個次載波插入一個 pilot。
在原來的 802.16d/e OFDM 下傳子訊框中，長前置碼負責取得通道估測值，
導引次載波的主要功能則是強化系統對頻率偏移及相位雜訊的抵抗力。在這邊，
我們將導引次載波改作為通道估測用，我們並將導引次載波重新排列如階梯狀，
如圖 20.12，將此五種樣式在子訊框中依照樣式一，樣式二，樣式三，樣式四，
樣式五，樣式一，…的順序排列。
308
此外，我們也從相位調整著手。訊號經過通道之後，由於載波頻率偏移或相
位雜訊等因素，在頻域上會有整體的額外相位旋轉，這個效應在通道估測的時候
並不明顯，故在 802.16d/e OFDM 標準中，安排了導引次載波在等化器之後作為
相位調整（Phase modification）之用。而額外相位旋轉量與正規化都卜勒頻率
（Normalized Doppler frequency）相關，這邊我們定義正規化都卜勒頻率如(20.16)
所示，與頻寬、都卜勒頻率有關。圖 20.15(a)與圖 20.15(b)則分別代表在不同的
頻寬與都卜勒頻率下，QPSK 星座圖額外相位旋轉的情況。
,
(256 32)
d normalized d s df f T f BW
    （20.16）
-2 -1.5 -1 -0.5 0 0.5 1 1.5 2
-2
-1.5
-1
-0.5
0
0.5
1
1.5
2
Real
Im
ag
e
BW=20MHz
BW=5MHz
BW=2MHz
-2 -1.5 -1 -0.5 0 0.5 1 1.5 2
-2
-1.5
-1
-0.5
0
0.5
1
1.5
2
Real
Im
ag
e
fd=0
fd=500
fd=800
圖 20.15 (a)頻寬大小之影響 (b)都卜勒頻率對相位旋轉之影響
我們可看出頻寬縮小或是都卜勒頻率變大都會增加整體相位旋轉量，星座點
的集中度也會跟著下降。圖 20.16 則表現出相位調整後對 802.16d/e OFDM 系統
效能的提昇。在我們提出的方法下，導引次載波將被改作為通道估測用，因此相
位旋轉的問題將以高速鐵路環境的可預測性來做補償。我們知道額外相位旋轉量
與正規化都卜勒頻率有相關性，因此在高速鐵路環境頻寬與速度都可預期的情況
下，我們便可利用這些已知的資訊得到正規化的都卜勒頻率，並藉此將已得知的
整體相位旋轉量補償回來。圖 20.16 即是我們利用高速鐵路之路徑可預測性所作
310
0 20 40 60 80 100 120
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
Frame Length (No. of OFDM Symbols)
B
E
R
conventional
proposed
0 20 40 60 80 100 120
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Frame Length (No. of OFDM Symbols)
F
E
R
conventional
proposed
圖 20.19 圖 20.20
從圖 20.19 及圖 20.20 的模擬結果，皆顯示我們所提出的訊框格式在不同的頁框
長度皆優於原系統，且能維持相同的效能。這也是我們的通道估測值更新快速之
故。
最後，我們分別從各種可預測的情況來探討效能之改進方式。
(a) 都卜勒頻率的可預測性
我們所使用的 COST 259 RA 模型，通道的產生方式如下式：
1
2 c o s ( 2 c o s )
0
1 1
[ ]
1 1
s
m s m i s i
N
j f n T j f n T
is
K
h n e e
K K N
    



 
  
（20.17）
其中 K 為 Rician factor，表示直視波與路徑延遲波能量的比值。為行進方向與
訊號傳播方向的夾角， sT 為取樣間隔， sN 為路徑延遲波的數目， i為路徑延遲
波與行進方向之夾角， i為（0,2）之間的隨機變數。
3.6 式右邊第一項與第二項分別為直視波與通道延遲波的產生項，若 K 值不
大，直視波的效應便不明顯。但在我們之前討論的高速鐵路環境，K 值設定為
10dB 時，直視波的重要性便顯現出來。而在高速列車的環境，與列車速度有關
的最大都卜勒頻率 mf 、列車與訊號方向的夾角都可以預測的情況下，接收端
若能將直視波項的指數項消除，便可減緩都卜勒效應對系統效能造成的損失。
312
圖 20.22 (a) (b)
結論
本論文針對在雙鏈架構下，地面基地台與火車收發器之間的無線通道提出問題與
討論。包括在高速移動環境下，使用 IEEE 802.16d/e OFDM 實體層規格面對高速
移動環境所遭遇的問題，並針對訊框格式提出改進的作法。最後討論利用鐵路環
境部份通道資訊可預測的特性，補償多路徑干擾或都卜勒效應的效能損失。根據
這些討論，我們做出了以下幾點結論：
（1）雙鏈架構中的 super mobile 解決方案將是具有彈性與效率的作法。
（2）在高速移動環境的可預測特性之下，選擇多個沿鐵路收發機的小範圍
細胞配置方式不但具有彈性且能有效減少換手次數。
（3）IEEE 802.16d/e OFDM 因都卜勒效應使得載波頻率偏移所造成的 ICI
問題是可以忽略的。
（4）在不同的都卜勒頻率選擇不同的 pilot 排列方式將有助於系統效能，而
IEEE 802.16 d/e OFDM 的塊狀排列訊框格式並不適合使用在高速移動環境。
（5）提出的子訊框格式不會增加 pilot 投資比例，並將有助於提昇系統效能，
訊框長度越長改進幅度越高。相位旋轉問題可利用高速鐵路的可預測性做為補
償。
（6）接收端如能對環境參數預作補償，將對系統效能有所助益。
本論文旨在探討 IEEE 802.16d/e OFDM 系統在高速鐵路環境下的可行性，雖
然我們提出的子訊框格式確實有助於提昇系統效能，但仍有許多相關問題等待解
314
問題描述
利用業界常用於 2G、3G 網路規劃設計與優化調整所使用的測試儀器 TEMS
及 NEMO，於高鐵列車上進行沿線之訊號狀況量測，可得到高鐵沿線的訊號強
度及品質情況，以桃園至苗栗路段為例，由於此路段屬於北部山區地形，正是高
鐵全線路段中地形最複雜的區段，訊號涵蓋難度最高的區域。
圖中自左而右 3 條曲線依序為速度、訊號強度、訊號品質的數據，右側說明
部分量測結果的可能異常現象，同時發現沿線的訊號涵蓋確實較不完整，而且列
車以高速運行時，將對原本涵蓋較差之區域會造成更嚴重的通訊服務影響。
圖 21.1 桃園－苗栗間訊號量測圖
共有以下幾個結論：
1. 高鐵沿線中訊號強度或訊號品質普遍性較差
2. 高鐵移動速度加深對弱訊區品質劣化的影響。
3. 相鄰基地台間的重疊區域設計不良造成，造成 Hand Off 斷話，隧道
區域造成之斷話。
316
高速列車上的設備規劃
基於上述架構，並避免列車車廂之遮蔽效應及高速移動環境下訊雜比劣化的
影響，列車上的訊號改善設備將採以中繼器結合洩波同軸電纜的架構進行討論，
示意圖如圖 21.3。
圖 21.3 列車上的設備規劃示意圖
按上述規劃條件下，為使洩波同軸電纜訊號衰減較平均較平均分配於列車上
（以1/2”線徑之洩波同軸電纜每 100m 衰減值為 13.7dB 來估算），可得到列車上
洩波同軸電纜所造成之鏈路衰減值，如圖 21.4 所示。
318
-90dBm 之間，中南部為-85dBm ~ -95dBm 之間，利用差異化設計，達到最佳化。
傳播路徑損耗模型
1. Okumura-Hata Model：
 kmmeffMHzMSdBmeffMHzdB rhfhchfL loglog55.69.44),(log82.13log16.2655.69  (21.1)
若使用在郊區環境，表示為： 4.5)
28
(log2 2 MHzdBrural
f
LL (21.2)
適用條件：
頻率( MHzf = 150 ~ 1500MHz )、基地台至行動台距離( kmr = 1 ~ 20Km )
基地台天線高度 ( meffh = 30 ~ 200 m )、行動台高度 ( MSh = 1 ~ 10 m )
假設列車運行於 950MHz 系統下： MHzf = 950MHz、 m
effh = 30 m、 MSh = 1.5
m
並分別代入(21.1)、(21.2)式，可得如下(21.3)及(21.4)式：
kmMHzMSdBdB rfhcL log)68.99.44(),(41.2090.7755.69  (21.3)
09.10 dBrural LL (21.4)
2. COST-Hata Model：
 kmmeffmdBMHzMSdBmeffMHzdB rhcfhchfL loglog55.69.44),(log82.13log9.333.46 
其中 )8.0log56.1()7.0log1.1(),(  MHzMSmMHzMHzMSdB fhffhc (21.5)
320
鏈路預算( Link Budget )是無線網路規劃的常用的工具，鏈路預算的結果將
可決定基地台的涵蓋範圍，為使系統能正常運作，上行鏈路和下行鏈路是必須達
到平衡的，以簡單的概念來說明鏈路預算的涵義，可將其表示為：接收端訊號強
度(dBm) = 傳送端訊號強度(dBm) + 所有的增益(dB) –所有的損失(dB)。
為使高速列車沿線訊號環境達到-85dBm 的設計條件，並依前述所建議之高
速列車上之系統架構配置，設計下行/上行鏈路如圖 21.5 所示，鏈路預算如表
21-1。
圖 21.5 下行/上行鏈路設計示意圖
322
(A) (B) (C) (D)
圖 21.6 建議設置基地台之形式
基地台設置的建議值
綜合上述的討論說明，將計算得到的鏈路預算設計結果套用於
Okumura-Hata Model 在 950Mhz 的頻段、COST-Hata Model 在 2000Mhz 的頻段分
別討論於 1 或 2 個 Sector 的涵蓋形式下，基地台設置建議值。
1. Okumura-Hata Model 在 950Mhz 的頻段設計建議值
324
延續前述結果，接著針對兩基地台之間 Hand off 重疊區域的範圍設計進行討
論，Hand off 執行交遞程序所需的時間，同時也稱為相鄰基地台間的重疊區域，
需要做適當的規劃，才能有足夠的範圍及時間，供系統完成所有的執行程序。
Handoff 程序主要分成 3 個階段，包含量測階段、判斷階段、及 Handoff 執
行階段，若詳細區分實際執行所需程序，則包含下列幾項：
1. 手機提供量測報告：一般為每 0.5 秒傳送一次。
2. 估測時間：由於 BS1、BS2 實際訊號強度變化會在一個邊界範圍內變動，故
在進行條件判斷前，會將實際訊號計算以平均量測訊號呈現，約需 2 秒。
3. 交會點到達 Handoff 條件時間：約 1 秒。
4. 執行 Handoff 程序所需時間：約 0.5 秒。
5. 傳輸及延遲時間：約 1 秒
綜上，完成 Handoff 所需時間至少約需 5 秒。
圖 21.9 Handoff 訊號估測
由前述結論，不同傳播路徑損耗模型及頻率下所得之基地台涵蓋範圍建議
值，來討論其 Handoff 重疊區域大小，由於一般重疊區域或稱 Handoff windows
Size，其大小可用衰減值或距離表示，一般而言會依照所需的環境不同，而設計
不同大小的 Windows Size，通常以每 0.5dB 為一個 Step，如 0.5dB、1dB、1.5dB
等，利用列車 300Km/Hour ( 83.33m / sec)的速度估算訊號的衰減得到適當的
326
圖 21.11 COST-Hata Model 在 2000Mhz 的頻段 Handoff 區域設計建議值
綜合上述結果，可以整理成表 21.2，在高速列車時速 300Km/Hour 的情況下，
Okumura-Hata 模型在 950Mhz 頻段的條件下，若 Windows Size 採 1.5dB 的設定
值時，使用 1-Sector 及 2-Sector 其所需的 Handoff 區域分別為( 564M，6.77s )、
( 622M，7.46s )，若在 COST-Hata 模型在 2000Mhz 頻段的條件下，因為高頻訊
號衰減較嚴重，故 Windows Size 採 7.0dB 的設定值時，使用 1-Sector 及 2-Sector
在所需的 Handoff 區域分別為( 452M，5.42s )、( 442M，5.30s )，在此條件下基
地台設置數量在 Okumura-Hata 模型在 950Mhz 頻段的條件，1-Sector、2-Sector
以不同的天線涵蓋北部及中南部區域的非隧道區域，將分別需要 18 及 17 個基地
台，若以 COST-Hata 模型在 2000Mhz 頻段的條件下，基地台的涵蓋區域將縮小，
將分別需要 109 及 105 個基地台。
328
圖 21.12 以 2-Sector 方式直接涵蓋隧道內環境
第二種則是使用洩波同軸電纜直接引進隧道內進行涵蓋，由於其訊號涵蓋將
會較穩定而且也可以涵蓋較長之距離，如圖 21.13 所示，利用前述鍊路預算的估
算，在設計-85dBm 的涵蓋條件下，最大的允許路徑損失為 136.24dBm，並使用
1 5/8”的電纜種類為例，每 100M 損耗為 5.03dB，可知使用洩波同軸電纜約可涵
蓋 3041M。
圖 21.13 以洩波同軸電纜方式直接涵蓋隧道內環境
第三種則是基於第二種方式並輔以 Repeater 或是 Fiber Repeater 延伸隧道涵
蓋長度，雖可使用於大多數的長隧道區域涵蓋，但成本較高，設置上也較為複雜，
如圖 21.14。
330
對無人飛機平台應用而言，本報告考慮不同 cell 大小的覆蓋情形（macro cell
以及 micro cell），推導出我們環境中的逆向鏈路系統容量，並且依照模擬結果討
論使用不同的天線場型來達成 macro cell 以及 micro cell 覆蓋的優缺點，選出了
較適合的天線場型，接著利用決定好的天線場型，進一步安排高速列車與普通使
用者之間的數量與發送功率關係，透過數值結果分析，我們可以發現存在一個最
佳的列車與普通使用者發送功率比例，此外，也針對 macro cell 以及 micro cell
裡面的普通使用者數量做安排，可以驗證設計的系統安排能有效地提升系統容
量。
七、 參考文獻
[1] P. H. Moose, “A technique for orthogonal frequency division multiplexing frequency offset
correction.” IEEE Trans. Commun., vol. 42, pp. 2908-2914, Oct. 1994.
[2] W. Lei, W. Cheng, and L. Sun, “Improved joint carrier and sampling frequency offset estimation 
scheme for OFDM systems.”IEEE GLOBECOM 2003, pp. 2315-2319, 2003
[3] F. Yang, K. H. Li, and K. C. Teh, “A carrier frequency offset estimation with minimum output 
variance for OFDM systems.” IEEE Communication Leters, vol. 8, no. 11, pp. 677-679, Nov.
2004.
[4] K. Shi, E. Serpedin, and P. Ciblat, “Decision-Directed Fine Synchronization in OFDM Systems.” 
IEEE Trans. Commun., vol. 53, no. 3, pp. 408-412, March 2005.
[5] B. Chen, and H. Wang, “Blind estimation of OFDM carrier frequency offset via oversampling.” 
IEEE Trans. Signal Processing, vol. 52, no. 7, pp. 2047–2057, Jul. 2004.
[6] D. Tse, and P. Viswanath, Fundamentals of Wireless Communications. Cambridge Univ. Press,
May 2005.
[7] B. Hassibi, “An Efficient Square-Root Algorithm for BLAST,” in Proc. IEEE Intl. Conf. Acoustic, 
Speech, Signal Processing, Istanbul, Turkey, June 2000, pp. 5–9.
332
[19] Y. Mostofi, D. Coxa nd A. Bahai, "ICI Mitigation for Mobile OFDM Receivers," in Proc. IEEE
Int. Conf. Commun., pp. 3351-3355, May 2003.
[20] M. Moreli and U. Mengali, “A comparison of pilot-aided channel estimation methods for ofdm
systems,” IEEE Trans. Signal Processing, vol. 49, pp. 365-3073, Dec. 2001.
[21] O. Edfors et al., “OFDM Channel Estimation by Singular Value Decomposition,” IEEE Trans.
Commun., Vol. 46, pp. 931-939, July 1998.
[22]X. Cai and G. B. Giannakis, “Bounding Performance and Suppressing Intercarrier Interference in 
Wireless Mobile OFDM,” IEEE Trans. Commun., Vol. 51, pp. 2047-2056, Dec. 2003.
[23] Y. S. Choi, P. J. Voltz and F. A. Cassara, “On Channel Estimation and Detection for Multicarrier 
Signals in Fast and Selective Rayleigh Fading Channels,” IEEE Trans. Commun., Vol. 49, pp.
1375-1387, Aug. 2001.
[24] A. Stamoulis, S. N. Diggavi and N. Al-Dhahir, “Intercarrier Interference in MIMO OFDM,”IEEE
Trans. Commun., vol. 50, pp. 2451-2464, Oct. 2002.
[25]A. Gorokhov and J. Linnartz, “Robust OFDM Receivers for Dispersive Time-Varying Channels:
Equalization and Channel Acquisition,” IEEE Trans. Commun., Vol. 52, pp. 572-583, Apr. 2004.
[26] Y. Mostofi and D. Cox, “ICI Mitigation for Pilot-Aided OFDM Mobile Systems,” IEEE Trans.
Wireless Commun., Vol. 4, pp. 765-774, Mar. 2005.
[27]P. Schniter, “Low-Complexity Equalization of OFDM in Doubly Selective Channels,” IEEE Trans.
Signal Processing, vol. 52, pp. 1002-1011, Apr. 2004.
[28]C. Kuo and J. F. Chang, “Equalization and Channel Estimation for OFDM Systems in 
Time-Varying Multipath Channels,” IEEE PIMRC’04, pp. 474-478, Sep. 2004.
[29]L. Rugini, P. Baneli and G. Leus, “Simple Equalization of Time-Varying Channels for OFDM,” 
IEEE Commun. Lett., vol. 9, pp. 619-621, July 2005.
334
[40]M. Chryssomalis, “Smart Antennas,” IEEE Antennas and Propagation Magazine, Vol. 42, No. 3, pp. 
129-136, June 2000.
[41] S. Haykin, Adaptive Filter Theory. Prentice-Hall, Englewood cliffs, NJ, 2002.
[42] Y.-R. Tsai and J. F. Chang, “Using Spread Spectrum Techniques to Combat Multipath Interference
in Mobile Random Accessed Networks,” IEEE Transactions on Communications, vol. COM-43,
pp.329-337, February/March/April 1995.
[43] J. J.Shynk, “Frequency-domain and multirate adaptive filtering,” IEEE Signal Processing Magazine,
Vol. 9, Issue 1, pp. 14-37, 1992.
[44]王中和，渦輪等化器在超高速移動環境下性能提升之研究，國立台灣大學電信工程學研究所
碩士論文，中華民國九十四年六月。
[45] Koetter, R., Singer, A.C., Tuchler, M., Turbo equalization, Signal Processing Magazine, IEEE,
Volume 21, Issue 1, Jan. 2004, Page(s): 67-80.
[46] Douillard, C., et al., Iterative correction of intersymbol interference: Turbo equalization, Eur.
Trans. Telecomm., vol. 6, pp. 507-511, Sept./Oct. 1995.
[47]林見陽，超高速移動環境下渦輪等化器應用於正交分頻多工系統之研究，國立台灣大學電信
工程學研究所碩士論文，中華民國九十六年七月。
[48] D. P. Agrawal, Introduction to wireless and mobile systems 2nd.
[49] J. G. Andrews, Fundamentals of WiMAX.
[50] S. Catreux,, V. G. Erceg,, & D. Heath, R. J. (2002). Adaptive modulation and
[51] L.-P. Chin,, J.-F. Chang,, & C.-M. Huang, (1997, 1). Performance of a two-layer LEO satellite
communication network. Aerospace and Electronic Systems, IEEE Transactions , pp. 225-231.
[52] L. J. Cimini, (1985). Analysis and simulation of a digital mobile channel using orthogonal
frequency-division multiplexing. IEEE Trans. Commun .
[53] J. F. Kurose,, & Ross, K. W. Computer networking 3rd.
[54] Le-Pond, C. (1995). Performance Ananlysis of Integrated Mobile Communication Systems.
336
[65] W. G. Jeon, K. H. Chang, and Y. S. Cho, “An Equalization Technique for Orthogonal 
Frequency-Division Multiplexing Systems in Time-Variant Multipath Channels” IEEE 
TRANSACTIONS ON COMMUNICATIONS, VOL. 47, NO. 1, JANUARY 1999
[66] H. Harada and R. Prasad, Simulation and Software Radio for Mobile Communications, Artech
House, 2002
[67]莊明道,Performance evaluation on orthogonal frequency division multiplexing system in very
high mobility environment,國立台灣大學電信工程研究所碩士論文, July,2007
[68] S.B. Weinstein and P.M. Ebert, “Data transmission by frequency-division multiplexing using the
discrete Fourier transform,” IEEE Trans. Communication Technology, vol. 19, no. 5, pp. 628-634,
Oct. 1971.
[69] J.-W. Choi and Y.-H. Lee, “Optimum Pilot Patern for Channel Estimation in OFDM Systems”, 
IEEE TRANSACTIONS ON WIRELESS COMMUNICATIONS, VOL. 4, NO. 5, SEPTEMBER
2005
[70]彭馳, “在高速鐵路環境下使用正交分頻多工技術頁框格式之研究”, 國立台灣大學電信工程
研究所, June 2005
[71]袁文浩, “WCDMA通訊系統在超高速移動環境下的通道估測演算法之研究” , 國立台灣大學
電信工程研究所, June 2006
[72] C. Berrou and A.Glavieux, “Near Optimun Correcting Coding and Decoding:
Turbo-Codes”IEEE Trans. Comm.,Vol.44,pp.1264-1271,May 2002.
[73] A. N. Lozhkin, M. Azuma, and T. Taniguchi, “A Low-Complexity Turbo Equalizer for OFDM
Communication Systems.”IEICE Trans. Common,Vol.E89-B,No.1 p.100-117 Jan.2006.
[74] S. Suyama, H. Suzuli, and K. Fukawa, “An OFDM Receiver Employing Turbo Equalization for 
Multipath Environments with Delay Spread Greater than the Guard Interval.”VTC. 2005 IEEE 
62th Volume1.pp.632-636
338
[87] M. Uhlirz, “Concept of a GSM-Based Communication System For High Speed Trains;,” 
Proceedings of the Vehicular Technology Conference, Stockholm, Jun. 8-10, 1994, vol. 2, Jun. 8,
1994, IEEE, pp. 1130-1134.
[88] Propagation Prediction Models. 149. 149. 4.5 Propagation Models for Small- and Micro-Cells.
Dieter J. Cichon, IBP Pietzsch KIH Group, Germany. 4.5.1 General, pp 134-148.
[89] A. Medeisis and A. Kajackas, “On the use of the universal Okumura-Hata propagation prediction
model in rural areas,” Vehicular Technology Conference Proceedings, 2000. VTC 2000-Spring
Tokyo. 2000 IEEE 51st , Volume: 3 , 2000, Page(s): 1815 -1818 vol.3.
[90] COST 231 Final Report, 1999, Digital Mobile Radio: COST 231 View on the Evolution Towards
3rd Generation Systems, Commission of the European Communities and COST
Telecommunications, Brussels.
[91]G. I. Ohta, F. Kamada, N. Teramura and H. Hojo, “5 GHz W-LAN verification for public mobile
applications - Internet newspaper on train and advanced ambulance car”, CCNC2004 IEEE 1st, pp.
569–574, 2004
[92] Y.-P. E. Wang and T. Ottosson, ”Cel Search in W-CDMA”,IEEE Journal Selected areas in 
Communications, Volume 18,pp.1470 -1482, 2000
[93] Y. K. Jeong, O.-S. Shin and K. Bok(Ed) Lee, ”Fast Slot Synchronization for Intercel Asynchronous
DS/CDMA Systems” , IEEE Transaction on Wireless Communications , Volume 1 , pp. 353-360 ,
2002
[94] J. Moon and Y.-H. Lee , “Rapid Slot Synchronization in the Presence of Large Frequency Offset and 
Doppler Spread in WCDMA Systems” IEEE Transaction on Wireless Communications , Volume 4 ,
pp. 1325-1330 , 2005
[95]H. Minn , M. Zeng and V. K. Bhargava , ”On timing ofset estimation for OFDM systems”, IEEE 
Communication Letter ,Volume 4 , pp. 242-244 ,2000
