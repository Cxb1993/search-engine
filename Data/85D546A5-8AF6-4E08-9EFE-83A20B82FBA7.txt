1 
 
樑-旋轉機器結構系統振動力之反向估測 
 
摘要 
本計畫探討新穎模糊估測器有效與強健地估測樑機器系統之振動力。此估測器由模糊
卡爾曼濾波技術及模糊權重最小平方法結合而成，此估測器演算法則係由模糊邏輯系統推
論加速因子以提供強健之濾波技術，再藉模糊權重因子以提供一個介於所需追蹤能力與可
容許受雜訊靈敏度間之合理妥協，以維持較高之估測效率。藉由不同權重、量測共變異量
及初始共變異量等估測方式說明估測器之優越性能。模擬估測結果顯示本計畫所提出模糊
估測演算法則可有效、穩定及精確地估測輸入振動力。 
關鍵詞：模糊估測器、卡爾曼濾波、最小平方法、模糊邏輯。 
 
ABSTRACT 
  This work presents an innovative fuzzy estimator that efficiently and robustly estimates the 
vibratory forces of a beam-machine system. The proposed estimator includes fuzzy Kalman Filter 
(FKF) technology, which is accelerated by the fuzzy accelerating factor and the fuzzy weighting 
recursive least square method (FWRLSM), weighted by the fuzzy weighting factor based on the 
fuzzy logic inference system. The excellent performance of this estimator is demonstrated by 
comparing it with different weighting functions, distinct levels of noise covariance measurement 
and the initial process noise covariance. The simulation results show that the proposed method is 
efficient in estimating input vibration forces, giving this method great stability and precision.  
Keywords: Fuzzy Estimator, Fuzzy Kalman Filter, Least Square Method, Fuzzy logic.  
1. Introduction 
It is a very important task to ensure the availability and reliability of rotating machines and 
estimating the appropriate vibratory forces generated by the machine. The forces transmitted by 
the rotating machine to its foundation will produce undesirable vibrations and cause the material 
fatigue problem. The detection of vibratory forces is the most important procedure in isolation 
design, fatigue analysis, and reliability assessment in rotating machine systems. Force 
identification falls into two categories; direct methods and indirect methods. Direct methods use 
the placement of force transducers into the load paths at the point of force application. In 
practical engineering problems, there are always difficulties in installing the force transducers 
used to measure the forces to the structural system [1]. Indirect methods use other sensor types, 
placed at locations on the structure that may not necessarily correspond to the force input 
locations. One of these methods estimates the vibratory forces by applying the measured dynamic 
responses to the inverse estimation method. 
Inverse problems usually tend to be ill-posed, in the sense that infinitesimally small 
variations in the input data can cause large variations in the results. The problem solution method 
tends to be ill-conditioned, namely, a small noise in the measurements results in erroneous force 
estimations. Inoue et al. [2] used the least square method, which is based on the wiener filtering 
theory, the mean square error, and the singular value decomposition (SVD), to improve the 
estimation precision and obtain optimal estimates. Wang [3] used the weighted total acceleration 
3 
 
oe . A simulation sensor was installed under the middle of the beam to measure the displacement. 
Inversely estimating the vibratory inputs by applying an active reaction in the structural system is 
investigated in this work.  
The mass of the motor and the eccentric rotor, m, the mass of the eccentric rotor, m′  are 
shown in Figure 1. From figures 1(b) and 1(c), the vertical displacement of the eccentric rotor 
mass, 1y  can be shown as 
1 0 siny y e tω= +                                                        (1) 
According to figure 1(b), the force balance conditions in the vertical direction include the 
inertia force in both the non-rotated and unbalanced mass. Therefore, the equations of motion for 
the system are shown as follows  
( ) 1 0m m y m y cy ky′ ′− + + + =&& && &                                              (2) 
Substituting equation (1) in equation (2) gives 
( ) ( )20 sin 0m m y m y e t cy kyω ω′ ′− + − + + =&& && &                                  (3) 
Equation (3) can be rewritten as 
2
0 sinmy cy ky m e tω ω′+ + =&& &                                               (4) 
Dividing by m gives 
2 2
02 sin
my y y e t
m
ζω ω ω ω′+ + =&& &                                           (5) 
where k mω = , 2
c
m
ζ ω=  and the active vibration force input, 
2
0( ) sinF t m e tω ω′= . 
The input estimation algorithm is a calculation method using the state space. Therefore, the 
state equation and the measurement equation must be constructed before applying this method. 
To satisfy this situation, the equality, [ ]( ) ( ) TX y t y t= &  is used to transfer the movement 
equation into the state space form. The continuous-time state equation and measurement equation 
of the structural system is presented as follows [18]:  
( ) ( ) ( )X t AX t BF t= +&                                                    (6) 
( ) ( )Z t HX t=                                                           (7) 
where 
2
0 1
2
A ω ζω
⎡ ⎤= ⎢ ⎥− −⎣ ⎦ , 
0
1B
m
⎡ ⎤= ⎢ ⎥⎢ ⎥⎣ ⎦
, [ ]1 0H = , [ ]1 2( ) TX t X X=  
A  and B  are both constant matrices composed of the nth natural frequency and the inertia 
moment of the structural system. ( )X t  is the modal state vector. ( )F t  is the input dynamic 
load. ( )Z t  is the observation vector and H  is the measurement matrix. Generally speaking, 
noise turbulence always exists in the practical engineering environment. Nevertheless, equations 
(6) and (7) do not take the noise turbulence into account. In order to construct a statistical model 
of the system state characteristics, a noise disturbance term, that can reflect these state statistical 
characteristics, is added into these two equations. For this reason, the continuous-time state 
equation (6) can be sampled with the sampling interval, tΔ , to obtain a discrete-time statistic 
model of the state equation as shown in the following [18]:  
( 1) ( ) [ ( ) ( )]X k X k F k w k+ =Φ +Γ +                                          (8) 
where 
5 
 
[ ]( ) ( 1)s sB k H M k I= Φ − + Γ                                             (17) 
[ ][ ]( ) ( ) ( 1)s a sM k I K k H M k I= − Φ − +                                     (18) 
11 1( ) ( 1) ( ) ( ) ( 1) ( ) ( )T Tb b s s b sK k P k B k B k P k B k S kγ γ −− −⎡ ⎤= − − +⎣ ⎦                    (19)              
[ ] 1( ) ( ) ( ) ( 1)b b s bP k I K k B k P kγ −= − −                                       (20) 
( ) ( 1) ( ) ( ) ( ) ( 1)b sF k F k K k Z k B k F k
∧ ∧ ∧⎡ ⎤= − + − −⎢ ⎥⎣ ⎦                              (21) 
where ( )Z k  is the bias innovation produced by the measurement noise and input 
disturbance, ( )bK k  is the correction gain. ( )B k  and ( )M k  are the sensitivity matrices. γ  is 
the weighting factor. ( )bP k  is the error covariance of the input estimation process and ˆ ( )F k  is 
the estimated dynamic inputs. 
Some filter parameters must be obtained before the filtering process, such as the state 
transition matrix of the structural system,Φ , the measurement matrix, H , the discrete-time 
processing noise covariance matrix, Q  and the discrete-time measurement noise covariance 
matrix, R . The on-line state estimation, ( / 1)X k k −  and state estimation error covariance, 
( / 1)P k k −  of the filter will be acquired when the observation vector is input immediately after 
the initial conditions 0X  and 0P  are drawn into the estimator. ( )aK k  gets smaller as the 
processing noise covariance matrix,Q  and the state filter error covariance get smaller according 
to equations (11) and (14). This indicates that the new measurement is mitigating to the state 
predicted correction. ( )aK k  gets smaller as the measurement noise covariance matrix, R , gets 
larger according to equations (13) and (14). That is to say, the measurement error mitigates the 
state estimation of the estimator. In other words, the Kalman gain ( )aK k depends on vR  and wQ . 
The above-mentioned principle is a key problem that the appropriate vR  and wQ  can be chosen 
in accordance with the system properties and the magnitude of the noise interference in the 
estimation process. vR  can be chosen in accordance with the precision of the measurement 
instrument. wQ  can be chosen in accordance with the modular error in the system. The Kalman 
gain can be slightly corrected with a higher precision measurement instrument, this is, the 
modular error in the system changes from big to small. For this reason, the processing noise 
covariance can be defined as follows: 
( )( 1) ( ) 10 kw wQ k Q k
α+ = ×                                                (22) 
where ( )kα  is the fuzzy accelerating factor chosen in the interval, [ ]1,1− .  
The weighting factor ( )kγ  is another important parameter that affects the estimation 
precision in the estimation process. It also plays the role as an adjustable parameter to control the 
estimator bandwidth or the gain magnitude of the recursive least square estimator. It can operate 
at each step based on the innovation produced by the Kalman filter. In the equations of the 
recursive least square estimator, ˆ ( )F k  is the estimate of the unknown input. ( )bP k  is the error 
covariance of the input estimation process. ( )bK k  is the correction gain. ( )kγ  is the weighting 
factor in the range between 0 and 1. The two functions of ( )kγ  are smoothing and forgetting. 
The forgetting effectiveness depends on the value of ( )kγ . ( )bK k  gets larger as ( )kγ  gets 
smaller according to Equation (19). The forgetting effect becomes more conspicuous according to 
Equation (20). Note that the faster the forgetting effect is, the lower the smoothing effect will be, 
that is, it introduces oscillation. Furthermore, the weighting factor ( )kγ  is employed to 
compromise between the tracking capability and the loss of estimation precision. The fuzzy 
7 
 
characterizing the shape of ( )( )A kθμ .  
The Mamdani maximum-minimum inference engine is used in this paper. The fuzzy 
implication max-min-operation rule of the output variable, ( )kα is shown in the following [20]. 
( )( ) ( )( ) ( ) ( )( ){ }1 1max min , ,j j j
i i
c d
B j i A A B
k k k kμ α μ θ μ θ α= = →⎡ ⎤= ⎣ ⎦                            (25) 
The output variable, ( )kγ  can be similarly shown as following [20]: 
( )( ) ( )( ) ( ) ( )( ){ }1 1max min , ,j j j
i i
c d
B j i A A B
k k k kμ γ μ θ μ θ γ= = →⎡ ⎤= ⎣ ⎦                            (26) 
where c is the fuzzy rule, and d is the dimension of input variables.  
The defuzzifier maps a fuzzy set B  to a crisp point Vα ∈ . The fuzzy logic system with 
the center of gravity is defined as follows [20]. 
( )( )
( )( )1 1( )
n l l
Bl
n l
Bl
y k
k
k
μ αα μ α
=
=
= ∑∑                                               (27) 
The defuzzifier of the output variable, ( )kγ  can be similarly shown as follows: 
( )( )
( )( )* 1 1( )
n l l
Bl
n l
Bl
y k
k
k
μ γγ μ γ
=
=
= ∑∑                                               (28) 
n  is the number of outputs. ly  is the value of the l th output. ( )( )lB kμ α  and ( )( )lB kμ γ  represent the membership of ( )l kα  and ( )l kγ  in the fuzzy set B , respectively. 
Substituting ( )kα  from equation (27) into equation (22) and ( )* kγ  from equation (28) into 
equations (19) and (20) allows us to configure the fuzzy estimator. A design flow chart of the 
fuzzy estimator is given in Figure 2. 
4. Results and discussion 
To verify the practicability and robustness of the presented approach in estimating the 
vibration force, inputs on the beam-machine are used to evaluate the present inverse algorithm. 
The vibration force inputs are generated by the unbalanced rotary machine under nominal 
operating conditions. The beam-machine system used in the numerical simulations is shown in 
Figure 1. The beam structure is modeled as a simple beam composed of two standard steel, 
8 23S × with a total span 5L m= . The cross-section area of the beam at the inertia moment is 
42 1.63 3.26I m= × = . An eccentric rotating machine was mounted upon the middle of the beam 
span. The weight of the machine is 71168 gW k= . The weight of the eccentric rotator is 
177.92 gW k′ = . The machine is excited by the vibratory force generated by an unbalanced 
member, that is the eccentric distance, 0 0.1e m= . The vibration forces of the machine are 
harmonic at a constant frequency of 10 Hz. The viscous damping coefficient of the system is 10% 
critical damping. The vibration forces of the machine are harmonic at a constant frequency of 10 
Hz. The simulation parameters are set as follows. The sensitivity matrix (0)M  is null. The 
sampling interval, 0.001tΔ =  and the total simulation time, 0.5ft s= . The weighting factor, γ , 
is adaptive weighted, fuzzy weighting and constant weighted function respectively. Four different 
levels of the measurement noise covariance, vR , are 
1210− , 1310− , 1410−  and 1510− , and the 
initial process noise covariance, (0)wQ , are 
610 , 1010 , 1410  and 1810 , are considered in 
9 
 
that the proposed estimator gives excellent estimates of the signal when the 13.16SNR ≥ . The 
above simulation results demonstrate that the proposed method has better performance than other 
algorithms. 
5. Conclusions 
This work presented fuzzy Kalman filter technology combined with the fuzzy weighting 
recursive least square method to estimate the vibration force inputs of a machine mounted upon a 
beam under improper initial modeling and measurement noise operating conditions. The fuzzy 
estimator has the properties of fast tracking and efficiency against noise because it is accelerated 
and weighted by the accelerating factor, ( )kα  and weighting factor, ( )kγ  of the presented 
method based on the fuzzy logic inference system. The cases studies presented herein verify the 
applicability of this method. Moreover, the superior estimation capability of the proposed method 
was shown by comparing it with the fuzzy weighting function, the adaptive weighting function 
and the constant weighting factor input estimation method. The results demonstrate that this 
method has the properties of faster convergence in the initial response, better target tracking 
capability, and more efficient noise and measurement bias reduction. The practicalities of this 
work provide great help in on-line condition monitoring and vibration isolation for rotary 
machines. Future works of this study will address the issue of the applications in the optimal 
control scope. 
6. Acknowledgment 
This research was partially supported by the National Science Council in Taiwan through 
Grant NSC 99-2221-E-145-003.  
 
References 
[1]. Yang, Y.B., and Yau, J.D., (1997), ‘Vehicle-Bridge Interaction Element for Dynamic 
Analysis’, Journal of Structural Engineering, ASCE 123, 1512-1518. 
[2]. Inoue, H., Ikeda, N., Kishimto, K., Shibuya, T., and Koizumi, T., (1995), ‘Inverse Analysis of 
the Magnitude and Direction of Impact Force’, JSME Int. J., Series A, 38, 84-91. 
[3]. Wang, M.L., and Kreitinger, T.J., (1994), ‘Identification of force from response data of a 
nonlinear system’, Soil Dynamics and Earthquake Eng., 13, 267-280. 
[4]. Huang, C.H., (2005), ‘A Generalized Inverse Force Vibration Problem for Simultaneously 
Estimating the Time-Dependent External Forces’, Applied Mathematical Modeling, 29, 
1022-1039. 
[5]. Tuan, P.C., Lee, S.C., and Hou, W.T., (1997), ‘An efficient on-line thermal input estimation 
method using Kalman Filter and recursive least square algorithm’, Inverse Problem Eng., 5, 
309-333. 
[6]. Tuan, P.C., and Hou, W.T., (1998), ‘Adaptive robust weighting input estimation method for 
the 1-D inverse heat conduction problem’, Numer. Heat Transfer, 34, 439-456. 
[7]. Liu, J.J., Ma, C.K., Kung, I.C., and Lin, D.C., (2000), ‘Input force estimation of a cantilever 
plate by using a system’, Comput. Methods Appl. Mech. Engrg., 190, 1309- 1322. 
[8]. Ma, C.K., Chang, J.M., and Lin, D.C., (2003), ‘Input forces estimation of beam structures by 
11 
 
ω
m′
oe tω sinoe tω 1 sinoy y e tω= +
k c
y
y
y
m′
oe
( )m m y′− &&
ky cy&
1m y′&&
m
sensor
( )a
( )b ( )c
 
Figure 1: A skeleton diagram (a), mathematics model (b) and free body diagram of the 
beam-machine structure system. 
 
Figure 2: Flowchart of the fuzzy input estimation algorithm. 
 13
 
Figure 5: Comparison of the Estimation Results Using Different Initial Modeling Errors.  
 
 
Figure 6: Comparison of the Estimation Results Using Different Level Measurement Noise
(SNR) 
 
 - 2 - 
道參觀 Korean Bible University，此大學創辦於 1952 年，以人文、執行與專業為該校之教
育理念。 
三、 與會心得 
此次參加 2011 International Conference on Complex, Intelligent, and Software Intensive 
Systems，獲益良多。會中除於會中發表自己的論文外，並聆聽與自己相關領域的論文發表，
了解各國學者的研究趨勢與軟硬體之運用，同時對下一階段的研究進行進一步思考，因此除
了獲得相當多的相關資訊外，對於自己研究上的瓶頸與問題也有新的想法與思維，另外在參
加現場Session的議程時提問與自身重要相關問題，提升自己未來研究改進的方向。在研討過
程中，來自世界各地專家學者所研究之議題相當先進，尤其韓國與日本來的學者所研究之智
慧型軟體系統相當新穎，其研究成果具學術及實用價值。 
主辦單位精心舉辦的歡迎會、茶會及晚宴中，藉由和各國學者交流，亦可開拓國際視野
及人脈，這些亦是在往後研究中所不可或缺的。再者，參觀Korean Bible University，學校
校區不大，每間教室都有學生在看書，尤其圖書館擠滿學生與老師，可感受到學生與老師們
具有充分學習熱情與態度，這值得我們學習的地方。在韓國首爾這段期間中，也實際接觸到
韓國人特有的執著與堅持的特性，人人愛用國貨，馬路奔馳的汽車幾乎是國產車；國家遭受
金融風暴，家家戶戶配合政府政策將私人黃金租借給國家，可充分感受韓國人強烈的愛國心，
這真的值得我們省思的地方，實應證古人所云讀萬卷書，不如行萬里路。 
以往研究只要能在學術網路搜尋下載相關參考文獻，將研究成果撰寫成文稿，進一步投
稿刊登在國際學術期刊上，此一研究過程只重視英文讀與寫之能力，至於口說部分完全無法
磨練；但是，參加本次研討會除可磨練本身的英文表達能力外，體驗直接互動的學術交流方
式，對本人而言極其珍貴。聆聽來自世界各國頂尖之專家學者報告，可學習論文題目的形成、
研究架構的建立、理論邏輯的推演與研究方法的採用等要訣，對於自己研究上的瓶頸與問題
也有新的想法與思維，可說獲益良多。 
四、 建議事項 
一個國家學術名望與國力息息相關，一個學校是否可以稱為世界頂尖大學，其學校學術
地位扮演重要角色，在本次會議中，遇到許多來自日本、韓國及大陸各地專家學者與學生，
Intelligent Estimation Method for the Force Inputs Determination of a Cantilever 
Beam Structural System
Ming-Hui Lee*  
Department of Civil Engineering 
Chinese Military Academy 
Kaohsiung, Taiwan, R.O.C. 
e-mail: g990406@gmail.com 
 
 
Abstract—An intelligent fuzzy weighted input estimation 
method is used to estimate the force inputs of a cantilever 
beam structural system in this study. The Kalman filter 
without the input term and the adaptive weighted recursive 
least square estimator are two main portions of this method. In 
the estimation method, the efficient estimator is weighted by 
the fuzzy weighting factor proposed based on the fuzzy logic 
inference system. By directly synthesizing the Kalman filter 
with the estimator, this work presents an efficient robust 
forgetting zone, which is capable of providing a reasonable 
tradeoff between the tracking capability and the flexibility 
against noises. The input forces of structure sytem can be 
estimated by this method to promote the analysis reliability of 
the dynamic performace. The simulation results are compared 
by alternating between the constant and adaptive weighting 
factors. The results demonstrate that the application of the 
presented method is successful in coping with the dynamic 
system of cantilever beam. 
Keywords-input estimation method; kalman filter; fuzzy logic. 
I.  INTRODUCTION  
In the structural design and reliability assessment, the 
most important procedure is to obtain the values of active 
input forces to the system. However, in the practical 
engineering problem, there are always difficulties in 
installing the load transducers used to measure the active 
loads to the structure system. If the active loads of the 
structure system can be estimated in real time, it will be a 
great benefit on the earthquake resistance design, fatigue 
analyze and reliability evaluation of the structure. 
The input force estimation of the structure system can be 
implemented by taking the product of the inverse of 
frequency response function (FRF) and the dynamic 
responses of the system. This reciprocal operation can be 
called as an inverse problem. However, the inverse problems 
usually tend to be easily affected. That is to say, a small 
variation in the input data and a small noise in the 
measurements can cause serious estimation error [1-2]. In 
order to resolve this problem, there are various researches 
with regard to the input estimation of the structure system in 
recent years. For example, Hillary and Ewins [3] utilized the 
least square technique to estimate the sinusoidal forces acting 
on the both sides of the cantilever and used the experiment 
procedure to examine the estimation results. Furthermore, 
they applied the method to the impact load estimation of the 
airplane turbine blades. Okubo [4] applied the least square 
method and the inverse technique to the input estimation of 
various structure systems. Inoue [5] used the least square 
method, which is based on the wiener filtering theory, the 
mean square error, and the singular value decomposition 
(SVD) to improve the estimation precision and to obtain the 
optimal estimates. Doyle [6] utilized the response obtained 
from the experiments along with the spectrum analysis 
method to construct the Fourier transform of the response 
and its relation with the input loads, and further estimated the 
effects of various types of loads over time by adopting the 
deconvolution and inverse Fourier transform techniques. In 
1996, the impact loads were able to be estimated by adopting 
the wave transmission response [7]. In 1997, the wavelet 
deconvolution was developed to estimate the impact loads of 
the beam and plate structure [8]. Recently, Haung [9] 
adopted the conjugate gradient method (CGM) to estimate 
the force of the one-dimensional mass-spring-damper 
structure with the time-varying system parameters. The 
researches mentioned above used the batch form to process 
the measurement data. This kind of method is time-
consuming and is not an on-line procedure of the input 
estimation. In the actual industrial applications, some 
parameters of this problem must be determined in real time 
rather than processed in batch form. Therefore, Tuan et al. 
[10-12] successfully presented an input estimation approach 
which can recursively solve the IHCPs in real time. Ma et al. 
[13,14] presented an inverse method to estimate the 
excitation forces by analyzing the dynamic responses of 
structure system. The input estimation method is using the 
recursive form to process the measurement data. As opposed 
to the batch process, using the recursive form is an on-line 
process and has higher effectiveness. There is no need to 
store all the data to implement the process, and the quantity 
of memory used can be reduced when dealing with more 
complex systems. 
The overall tracking performance of the estimator will be 
degraded when an inappropriate weighting function is 
chosen in the estimation process. In order to obtain a better 
estimation result, the constant weighting factor is chosen by 
adopting the trial-and-error method. The unknown inputs are 
usually slow or quick time-varying state which cannot be 
predicted. Therefore, it is difficult to choose an adaptive and 
efficient weighting function for any input variation. Tuan et 
al. [12] presented an adaptive robust weighted input 
estimation method for the one-dimensional inverse heat 
conduction problem. Lee et al. [15] utilized the adaptive 
weighted input estimation method to inversely solve the 
2011 International Conference on Complex, Intelligent, and Software Intensive Systems
978-0-7695-4373-4/11 $26.00 © 2011 IEEE
DOI 10.1109/CISIS.2011.28
131
 ( ) ( )T kjE v k v k R , where 2 2V n nR R I   . R  is the 
discrete-time measurement noise covariance matrix. H is the 
measurement matrix. 
III. THE INTELLIGENT FUZZY WEIGHTED INPUT ESTIMATION 
METHOD 
The input estimation method can inversely estimate the 
inputs by applying the active reaction of the structure system. 
This method is composed of the Kalman filter without the 
input term and the intelligent weighted recursive least square 
estimator (RLSE). The Kalman filter can produce the 
residual innovation sequence, which contains the bias or 
systematic error caused by the unknown time-varying inputs, 
and the variance or random error caused by the measurement 
error. The further use of the least square theory is to detect 
the system bias due to the unknown time-varying inputs. 
Therefore, the estimator utilizes the innovation sequence to 
estimate the inputs over time by adopting the intelligent 
weighted recursive least square method. The Kalman filter 
without the input term is shown as follows [10]:  
( / 1) ( 1/ 1)X k k X k k	   	 	                                       ˄6˅ 
( / 1) ( 1/ 1) T TP k k P k k Q	   	 	                                ˄7˅ 
( ) ( ) ( / 1)Z k Z k H X k k 	 	                                            ˄8˅
( ) ( / 1) TS k HP k k H R 	                                             ˄9˅
1( ) ( / 1) ( )TaK k P k k H S k
	 	                                       ˄10˅
( / ) ( / 1) ( ) ( )aX k k X k k K k Z k 	                               ˄11˅
( / ) ( ) ( / 1)aP k k I K k H P k k 	 	                                     ˄12˅
In the equations mentioned above, the superscript, “ˉ”, 
represents the estimation value. ( / 1)X k k 	  denotes the 
predicted state estimate. ( / 1)P k k 	  is the state estimation 
error covariance. ( )Z k  is the bias innovation produced by 
the measurement noise and the input disturbance. ( )S k  is the 
covariance of the residual. ( )aK k  is the Kalman gain. 
( / )X k k  is the filtered state estimate. ( / )P k k  is the error 
covariance of the filtered state. Before implementing the 
filtering procedure, the state transition matrix  , the 
measurement matrix H , the processing noise covariance Q , 
and the measurement noise covariance R  need to be 
determined. When further applying the initial values, 0X  
and 0P , the output of the filter can be obtained in real time as 
the observation vector is continuously inputted. The output 
of the filter contains the state estimate, ( / 1)X k k 	 , and its 
relative estimation error covariance, ( / 1)P k k 	 . The 
intelligent weighted recursive least square algorithm of the 
input estimation method is shown as follows [10]:  
( ) ( 1)s sB k H M k I  	                                                     (13) 
( ) ( ) ( 1)s a sM k I K k H M k I 	  	                                       (14) 
11 1( ) ( 1) ( ) ( ) ( 1) ( ) ( )T Tb b s s b sK k P k B k B k P k B k S k 
		 	  	 	   (15) 
1( ) ( ) ( ) ( 1)b b s bP k I K k B k P k
	 	 	                                        (16) 
( ) ( 1) ( ) ( ) ( ) ( 1)b sF k F k K k Z k B k F k
   
 	  	 	
 
 
                     (17) 
In the equations mentioned above, ( )Z k  is the innovation 
matrix, and ( )bK k  is the correction gain. ( )sB k  and ( )sM k  
are the sensitivity matrices.   is the intelligent fuzzy 
weighting factor. ( )bP k  is the load estimation error 
covariance. ˆ ( )F k  is the vector of the load estimate. 
The intelligent fuzzy weighting factor in this search is 
proposed based on the fuzzy logic inference system. The 
intelligent fuzzy weighting factor can be operated at each 
step based on the innovation from the Kalman filter. It plays 
the role as an adjustable parameter to control the bandwidth 
or gain magnitude of the recursive least square estimator. 
Furthermore, the weighting factor ( )k  is employed as the 
tradeoff between the performances of tracking capability and 
estimation precision. The relation as the following was 
derived by Tuan et al. [10]: 
1 ( )
( )
( )
( )
Z k
k
Z k
Z k

  
 
  

                                             (18) 
The weighting factor, ( )k , as shown in Eq. (18) is 
adjusted according to the measurement noise and the input 
bias. In the industrial applications, the standard deviation   
is set as a constant value. The magnitude of weighting factor 
is determined according to the modulus of bias innovation, 
 !Z k . The unknown input prompt variation will make the 
modulus of bias innovation larger. Under this circumstance, 
the smaller weighting factor is adopted. The estimator 
accelerates the tracking process and produces larger 
vibration. On the contrary, the smaller variation of unknown 
input makes the modulus of bias innovation smaller. Under 
this circumstance, the larger weighting factor is adopted. As 
a result, it is difficult for the estimator to estimate the 
unknown input precisely. To resolve this issue, the inverse 
estimation method with the intelligent fuzzy weighting factor, 
which can efficiently and robustly estimate the time-varying 
unknown input, will be utilized in this research. 
The fuzzy logic system includes four basic components, 
which are the fuzzy rule base, fuzzy inference engine, 
fuzzifier, and defuzzifier. The value of fuzzy logic system 
input,  !k" , may be chosen within the interval, 0,1   . The 
input variable is defined as the following [17]: 
 !
2 2
( )
( )
Z k
k
Z k t
"


  
                                                 (19) 
where ( ) ( ) ( 1)Z k Z k Z k  	 	 . t  is the sampling 
interval. The proposed intelligent fuzzy weighting factor uses 
the input variable  !k"  to self-adjust the factor  !k  of the 
recursive least square estimator. Therefore, the fuzzy logic 
system consists of one input and one output variables. The 
values of input,  !k" , and output,  !k , may be chosen 
within the interval, 0,1   . The fuzzy sets for  !k"  and  !k  
133
1 2 3 4
1
2
3
4
( ) ( ) ( ) ( ) 0, 0.2[sec]
( ) 90 exp( 2 ) ( ), 0.2[sec]
( ) 110 exp( 2 ) ( ), 0.2[sec]
( ) 130 exp( 2 ) ( ), 0.2[sec]
( ) 150 exp( 2 ) ( ), 0.2[sec]
F t F t F t F t t
F t t N t
F t t N t
F t t N t
F t t N t
1
1
1
1
    2
   	 3   	 3
   	 3
   	 3
                (23)  
The active reaction of the cantilever beam structure 
system can be analyzed and applied to the input estimation 
algorithm by using the numerical method. The processing 
noise covariance, 2 2w n nQ Q I   , where 410wQ 	 . The 
measurement noise covariance, 2 2v n nR R I   , where 
2 1410vR 
	  . The estimates for the decaying exponential 
blast load inputs are obtained and plotted in figures 2. The 
estimation results produced by using different sampling 
intervals are shown in figure 2. The four chosen sets of 
sampling inetrvals, t  = 0.01, 0.001, 0.0001, and 
0.00001sec. The estimation results are acceptable when the 
sampling time, t 2 0.001sec, such as in figure 2(c) and (d). 
Figure 2(d) shows that the tracking capability is enhanced 
while the smaller sampling interval is adopted. However, the 
fluctuation phenomenon becomes severer. In order to take 
the estimation precision and calculation time of the estimator 
into account, the sampling interval, t =0.0001 is chosen to 
implement the simulation in this study. Figure 3 shows the 
estimation results by adopting different weighting factors. In 
Example, 410wQ 	  and 1410vR 	  are adopted. An adaptive 
weighting factor or one with smaller value, despite its 
leading to a better transient performance and tracking ability, 
makes the estimator subject to the fluctuations due to the 
unwanted system noise. On the other hand, the estimator is 
less sensitive to disturbances with a larger value of  , but 
has relatively poorer transient performance and overall 
tracking capability. The intelligent fuzzy weighted input 
estimator has better target tracking capability and noise 
reduction effectiveness after all.
Figure 4 shows the estimation results of the intelligent 
fuzzy weighted input estimator with the process noise 
variance fixed ( 410wQ 	 ), and with different measurement 
error variances ( 1210vR 	 , 1410	 , 1610	  and 1810	 ). The 
result shows that when vR  is small, the transient 
performance of the estimator will be better against the noise 
effect. On the other hand, the fluctuation will become severer 
when vR  increases. The transient performance of the 
estimator will be poorer with more influence induced by the 
noise. The smaller vR  indicates that the measurement is 
more precise. The effort made to obtain a more precise 
measurement will be higher. To take the effort required and 
preciseness of the measurement into account, the 
measurement error variances, vR = 1410	  is chosen in this 
study.  In short, the proposed method has the good properties 
mentioned above. Besides, it can deal with the multiple-input 
multiple-output structure system. 
cm cm cm cm
1( )F t 2 ( )F t 3 ( )F t 4 ( )F t
 
Figure 1: Structure system model of the cantilever beam mounted with the 
concentrated masses. 
V. CONCLUSIONS 
This study proposes an intelligent fuzzy weighted input 
estimation method to estimate the input loads of a cantilever 
beam mounted with the concentrated masses. The algorithm 
includes the Kalman Filter (KF) and the recursive least 
square estimator (RLSE), which is weighted by the fuzzy 
weighting factor proposed based on the fuzzy logic inference 
system. The case studies show that the modeling and 
measurement noises are considered during the estimation 
process. The input loads can be estimated by analyzing the 
dynamic response measurements of the structure system. 
This method is effective in the use of estimating the transient 
or time-varying inputs. Since this method adopts the 
recursive mode, which reduces the computational time and 
the usage of memory storage as opposed to the batch mode, 
the on-line estimation process can be implemented. The 
estimation results demonstrate that the presented method is 
an efficient adaptive and robust inverse method, and the 
proposed algorithm is compared by alternating between the 
constant and adaptive weighting factors. The results reveal 
that this method has the properties of better target tracking 
capability and noise reduction effectiveness. Future works of 
this study will address the relevant issues of the applications 
in the optimal control scope. 
ACKNOWLEDGMENT 
This work was supported by the National Science 
Council of the Republic of Chinese under Grant NSC 99-
2221-E-145-003. 
REFERENCES 
[1] J.M. Starkey, G.L. Merrill, On the Ill-conditioned Nature of Indirect 
Force-Measurement Techniques. J of Modal Analysis (1989) 103-108. 
[2] P.K. Lamm, Inverse Problem and Ill-posedness- Inverse Problem in 
Engineering: Theory and Practice, ASME, New York; 1993. 
[3] B. Hillary, D.J. Ewins, The Use of Strain Gauges in Force 
Determination and Frequency Response Function Measurements. 
Proceedings of the 2nd International Modal Analysis Conference, 
Orlando, FL. (1984) 627-634.  
[4] N. Okubo, S. Tanabe, T. Tatsuno, Identification of force generated by 
a machine under operating conditions. Proceedings of the 3rd 
International Modal Analysis Conference, Orlando, Florida, USA. 
(1985) 920-927.  
[5] H. Inoue, N. Ikeda, K. Kishimto, T. Shibuya, T. Koizumi, Inverse 
Analysis of the Magnitude and Direction of Impact Force. JSME Int J 
Series A 38 (1995) 84-91. 
[6] J.F. Doyle, Determining the Contact Force During the Transverse 
Impact of Plates. Experimental Mechanics (1987) 68-72. 
135
 
Figure 3: Estimation results for the decaying exponential input blast loads using different weighting functions. ( 410Qw 	  and 1410Rv 	 ) 
 
Figure 4: Estimation results for the decaying exponential input blast loads using different measurement error covariances. 
137
國科會補助計畫衍生研發成果推廣資料表
日期:2011/09/30
國科會補助計畫
計畫名稱: 樑-旋轉機器結構系統振動力之反向估測
計畫主持人: 李明輝
計畫編號: 99-2221-E-145-003- 學門領域: 結構與振動
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
本計畫提出方法兼具目標快速追蹤與有效抑制雜訊干擾之高效率的逆向估測
法。未來可朝結構系統之實際動態負荷估測結合即時最佳控制方面研究，利用
輸入估測法具備線上即時估測外力負荷之特性，發展出一套線上即時估測與考
慮外力擾動效應下最佳控制智能結構系統，使本估測器之實用性更趨廣泛，此
研究成果可供結構工程師在結構設計之參考 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
