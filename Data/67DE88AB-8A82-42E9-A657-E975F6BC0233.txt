 一、 中文摘要 
 本研究的主要目的，是以本體論概念建置遠距居家照護系統，以解決在
地老化的需求和系統服務的延展性。在系統擴充性方面，本研究以 SOA 架
構將系統服務分成流程與資料，並將同性質的流程歸類為特定任務，藉由任
務本體論以 XML 格式描述各特定任務中需要的代理者和資料，讓系統管理
者可以從 XML 的描述中，輕易增減服務流程需要的功能和資料。在系統完
整性方面，本研究在疾病異常評估的描述上是以 OWL 格式定義疾病的診斷
標準和治療建議，讓健康管理師能在此資料結構上描述各疾病的衛教資訊。
在系統可近性方面，本研究不僅設計了簡易的輸入介面，更以直觀的圖文說
明來協助使用者進行選單操作。 
 為了驗證系統效能及系統滿意度，本研究設計了三個實驗：(1)比較本
體論系統與傳統三層式系統在全部執行時間、生理資料擷取時間和建議時間
的差異；實驗結果顯示，使用本體論建置照護系統，執行時間略高於傳統三
層式系統。(2)在 Intel Core2 Due E8400 的 CPU 環境下，由系統產生多個執
行緒，不斷對本體論的網路服務發出需求，並記錄系統效能的變化；實驗結
果顯示，本研究所開發之系統不僅可以同時服務超過 1500 人，且當人數在
100 人以內，系統能在 1 秒以內給予回應。(3)以 15 名高齡者為實驗對象，
針對操作流程、視覺感受、資訊完整性和需求與價值感四個面向進行滿意度
調查。93%(n=14)的人對於流程和介面設計感到滿意。93%(n=14)的人覺得
這樣的提醒方式可以有效提醒自己吃藥。67%(n=10)的人，認為本系統在建
議上，能協助對於卡路里或運動強度沒有概念的人，改善飲食和運動習慣。
至於購買意願方面，53%(n=8)的人願意付費享用此服務。 
 
關鍵字：居家照護,智慧屋,長期照護 
 
 三、 前言 
 慢性病在國人 10 大死因中所佔比例相當高，包括位居第 2、3 名的腦中
風和心臟病、第 5 名的糖尿病、第 10 名的高血壓，整體死亡率超過 4 成。
此外，根據台灣睡眠醫學會與林口長庚醫院睡眠中心於 2006 年 10~11 月針
對全國 15 歲以上國人進行的「國人睡眠品質調查報告」顯示，超過 480 萬
人有睡眠問題，平均每 10 人就有 1 人罹患慢性失眠。雖然這些慢性病與基
因脫不了關係，但靠著長期健康照護，亦可穩定地控制病情，預防糖尿病、
高血壓等慢性疾病的發生；傳統上老人一直由家庭照顧，雖然歷經時代變
遷，但是民眾對長期照護的態度依然傳統，1994 年社會意向調查顯示，20~64
歲的一般民眾中，約 6 成認為應將老人留在家中照顧；約 3 成認為應送去日
照中心；僅有 1 成的人認為送去機構接受專業療養是最佳的選擇。1993 年
社區老人健康調查亦發現，只有約兩成的老人願意進機構療養。由此可見我
國民眾存在強烈的「在地老化」之需求性。 
 此外，慢性病受多重病因和危險因子的影響，而作用不一，且其潛伏期
長，難以確定其疾病類型，因此在疾病預防上，常以階段性的治療目標為主。
慢性病雖然診斷標準不同，但都以主觀症狀和客觀徵兆為觀察要素，在治療
方面也都是以飲食、運動和藥物為主軸；由此可知，慢性病的照護模式應能
以一綱多本延伸出適合各疾病的照護模式；但現階段的照護服務多半仍以特
定服務為主，且服務模式上也還有改進的空間，因此，本研究希望能提出不
同的模型來作改善。在服務模式方面，以往病患量測完生理參數後，需由健
康管理師線上諮詢方能取得衛教資訊，不僅時間上會受到限制，在人力上也
顯得過度浪費，因此本研究希望改以智慧型諮詢系統，篩選出適合使用者需
求的資訊。在系統建置方面，傳統架構主要分為三層：客戶端系統程式、應
用系統伺服器和資料庫伺服器，而這些系統服務皆是針對特定的疾病照護而
設計，要套用在其他疾病的照護上有一定的困難，因此本研究希望在此傳統
架構中嵌入彈性的框架將遠距居家照護的服務精神囊括，並以抽象的概念，
 四、 研究方法 
A.  本體論系統建置 
 本研究的系統架構是將本體論的概念套用於傳統三層式系統架構 (圖 1)；在
系統服務方面，本研究以代理者和網路服務取代傳統的功能設計，讓服務能方便
置換和擴增；在資料結構方面，則以抽象的概念作描述，讓相同類型的資料可以
在資料結構不變的情況下，不斷地被增加。而就服務面來看，本系統依照客戶端
和伺服器端可分為(1)健康管理閘道：安置於居家端，定期收集高齡者的健康資
訊，並將結果上傳至醫療服務平台提供家屬和醫師作為照護品質的參考依據。當
有異常發生時，會針對情況給予建議。(2)醫療服務平台：建置於後台管理中心，
除了將健康管理閘道傳來的資訊建檔為個人病歷外，同時也提供遠距醫療服務，
讓醫療人員和健康管理師可經由此平台提供醫療諮詢或衛教建議給高齡者。針對
上述的服務架構，本研究歸納了九個軟體需求，下面我們將描述其流程與架構。 
 
圖 1、Ontology 架構圖 
 
  
圖 2、Agent 架構 
 
 了解各個代理者的角色及彼此間傳遞的資料後，根據居家照護的服務目的，
可挑出四個主要的代理者及相關的資料庫。由圖 3 的 SOA 架構可知整個居家照
護服務主要包含了兩種服務(1)生理分析、長期生理分析，由生理量測紀錄分析
高齡者的生理改善情況。(2)衛教建議，彙整近期出現的症狀和衛教服從度，分
析高齡者可能屬於的疾病高危險群，並給予衛教建議作改善。 
 
圖 3、SOA 架構 
 表 1、糖尿病評斷標準 
如何得知糖尿病  
項目  內容  
生理檢查 空腹 8 小時血糖值>=126 mg/dL  
生理檢查 以口服葡萄糖耐受性試驗，兩小時後血漿糖值>=250mg/dL 
生理檢查 隨機血糖值>=200 mg/dL  
婦女  孕婦以或口服葡萄糖耐性試驗來診斷妊娠性糖尿病  
有異常值，等待七天後再複檢，除非病患有嚴重性的代謝異常症狀  
身體症狀 視力模糊  
身體症狀 尿道感染  
身體症狀 皮膚乾癢  
身體症狀 四肢末端麻痺紅腫  
有兩項以上發生，判斷為糖尿病患  
資料來源：糖尿病階段性管理  
 
3. 治療建議，型別為子集，由表 2 可知糖尿病在治療方面，為階段性治療(級
別)，且治療方式主要為藥物治療、運動治療、和飲食治療。而患者在接受
治療後，每個月需要觀察血糖是否達到改善目標(如表 3)，以作為治療方針
的改善依據；因此在治療建議的子集裡，應可再下分為藥物治療、飲食治療、
運動治療和生理改善目標 
表 2、糖尿病階段性治療 
糖尿病治療階段 飯後 mg/dL  隨機 mg/dL  
飲食和運動 <250  <200  
單一口服藥物&多種口服藥物 250-350  200-300  
胰島素治療 >350  >300  
 
表 3、糖尿病自我血糖監測目標 
SMBG(2-4 times/day)  
項目 內容 
Pre meal  70-140 mg/dL  
Post meal  (2 hours after start of meal) <160 mg/dL  
Bedtime  100-160 mg/dL  
 
 在藥物治療方面，由糖尿病 Metformin 的藥物治療(如表 4)來看，可知
藥物的治療劑量需參考前次的劑量，且有服用時間的限制；此外目前市面上
的藥袋上附有的資訊，如藥物名稱、藥物作用、藥物副作用、單次用藥劑量、
 表 5、運動強度換算預估最大心跳 
運動強度 預估最大心跳 
極輕 <35%  
輕 35~54%  
中 55~69%  
重 70~89%  
極重 >=90%  
極限 100%  
 
表 6、運動項目對照攝氧量範例表 
運動項目 MET 範圍 運動項目 MET 範圍 
桌球 3 至 5 騎腳踏車 3 至 8 
羽球 4 至 9 有氧舞蹈 3 至 9 
網球 4 至 9 釣魚 2 至 4 
 
 
圖 4、領域本體論架構圖 
 
  將各個 Task 和資料結構明確定義後，接下來是以本體論的概念實作之。任
務本體論在描述上是以 XML 的格式定義各個步驟需要呼叫的代理者、傳入參數
和回傳參數。經由 XML Parser 解析後，系統會去呼叫相對應的代理者，並針對
要傳入的參數內容發出需求。若系統處於離線狀態，系統會向健康管理閘道內部
的資料庫發出需求；若處於線上狀態，系統則會透過 SOAP(Simple Object Access 
Protocol)，呼叫 OWL Parser 解析醫療服務平台上的領域本體論，並將疾病評斷
標準和衛教資訊回傳(圖 6)。 
 
圖 6、本體論架構 
   
 根據疾病診斷流程，生理評估 Task 會先被 XML Parser 解析，依照內容，系
統會呼叫 Improvement Agent，並發出客觀徵兆的資訊需求；Improvement Agent
透過 Contact Agent 可獲得疾病評估標準的客觀徵兆，進而與 Problem Agent 分析
生理量測紀錄，並計算異常累積數，若有滿足疾病評估標準，則將可疑的清單傳
給下一個疾病評估Task；Contact Agent收到客觀徵兆需求後，會先嘗試透過SOAP
至醫療服務平台以 OWL Parser 解析最新的領域本體論(Domain Ontology)資訊，
若沒有網路或新的客觀徵兆，則從健康管理閘道的資料庫讀取客觀徵兆回應需求
(圖 7)。 
  疾病評估 Task 結束後，會將確定的疾病清單或健康狀況傳至衛教建議
Task，接著經由 XML Parser 解析，依照內容，系統會呼叫 Suggestion Agent，並
發出治療建議的資訊需求；Suggestion Agent 透過 Contact Agent 可獲得疾病的治
療建議，進而分析衛教服從紀錄是否有異常的情況，若有則將該項的治療建議回
傳高齡者；Contact Agent 收到治療建議需求後，會先嘗試透過 SOAP 至醫療服務
平台以 OWL Parser 解析最新的領域本體論(Domain Ontology)資訊，若沒有網路
或新的治療建議，則從健康管理閘道的資料庫讀取治療建議回應需求(圖 9)。 
 
圖 9、衛教建議本體論流程 
 
B. 睡眠評估方法 
 在睡眠分析方面，本研究藉由睡眠時的心電圖資料作為分析資料來源，
利用心律變異率特徵值的變化與不同睡眠階段之間的關連性進行睡眠階段的辨
別，並根據專業醫師的睡眠階段註記與系統辨別結果進行比對，探討各項特徵值
對於睡眠階段辨別的影響程度，建立一套利用心電圖訊號辨別睡眠階段的準則。
同時嘗試建立用於睡眠品質初步評估的指標，當發現使用者可能有睡眠品質不良
的狀況時，給予使用者及時的提醒，以達到睡眠問題預警的功效。 
本研究系統整體流程如圖 10。利用睡眠時期的心電圖資料，輸入睡眠階段
辨別網路進行單夜的睡眠階段辨別，接著根據睡眠階段辨別結果對單夜的睡眠品
  
圖 11、睡眠階段辨識功能架構圖 
 
i. 定義需要使用的資料區段 
本研究所定義的睡眠階段包含甦醒、REM、NREM stage1、NREM stage2、
熟睡(NREM stage3 與 NREM stage4)。由於單一睡眠階段僅能維持數分鐘到數十
分鐘即會切換至另一睡眠階段，所以於後續的頻域分析特徵值的採用以每 5 分鐘
為單位計算的短期紀錄分析較為適宜，且本研究對於睡眠辨別主要考量的情況為
睡眠狀態維持在同一睡眠階段情況下的睡眠辨別，因此本研究從心電圖資料中選
取的資料區段主要以兩個條件規範作為規範： 
(1) 資料長度超過 5 分鐘且可以被 30 秒整除的資料區段。 
(2) 為維持在同一睡眠階段的資料區段。 
本研究後續的分析計算就以根據上述兩項條件所選取的資料區段作為分析
基礎。 
 
 iv. 特徵值計算 
各資料區段的心跳間距序列計算完成之後，接下來的步驟就是取出每段資料
區段的各項特徵值，再利用各項特徵值進行後續的睡眠階段辨別工作。本研究所
採用的特徵值主要分為頻域分析特徵值以及時域分析特徵值兩類。在頻域分析特
徵值的部份，本研究所採用之分析資料區段資料長度為 5 分鐘，因此在頻譜分析
特徵值的部分主要採用短期時間分析特徵值作為分析項目，選用的頻域特徵值如
表 7 所示，選用的時域特徵值如表 8 所示。之間的平衡狀態，藉此推估睡眠階段
的變化。 
表 7、頻域分析特徵值 
特徵值 特徵值說明 
5 min total power 5 分鐘區段內心跳間距轉換為頻譜後所含有的總功率 
VLF 在極低頻頻帶範圍內所含有的功率 
LF 在低頻頻帶範圍內所含有的功率 
LF norm LF 功率/(HF 功率+LF 功率) 
HF 在高頻頻帶範圍內所含有的功率 
HF norm HF 功率/(HF 功率+LF 功率) 
LF/HF LF 功率/HF 功率 
VLF% 極低頻功率佔總功率的百分比 
 
表 8、時域分析特徵值 
特徵值 特徵值說明 
SDNN 心跳間距的標準差 
RMSSD 相鄰心跳間距差值序列的方均根 
SDSD 相鄰心跳間距差值序列的標準差 
NN50 相鄰心跳間距差異大於 50ms 的數量 
pNN50 NN50 數量佔所有心跳間距的百分比 
 
v. 各項特徵值參數於不同睡眠階段之差異顯著性分析與各項特徵值參數相關
性分析 
 本研究用於睡眠階段的辨別方法為利用睡眠中的心電圖資料取出的各項特
  
表 9、各睡眠階段之分析資料區段筆數 
睡眠階段 甦醒 REM stage1 Stage2 
熟睡 
(stage3 + stage4) 
總和 
資料筆數 186 221 107 378 196 1086 
 
(2) 進行 one-way ANOVA 檢定分析 
在本研究中，我們必須確定每一項特徵值參數的數值呈現在各種不同的睡
眠階段之間是否具有顯著差異，透過 one-way ANOVA 檢定分析可以確定各項
特徵值參數對於不同睡眠階段的辨別是否有顯著的影響作用。one-way 
ANOVA 分析結果如表 10 所示。各項特徵值參數於各睡眠階段皆達到顯著差
異，也就是說，各項特徵值參數對於各睡眠階段皆具備一定程度的分辨能力。 
表 10、各項特徵值參數之 one-way ANOVA 分析表 
 單位 
總平均值 
(n=1086) 
甦醒 
(n=186)
REM 
(n=221)
stage1
(n=107)
stage2
(n=378)
熟睡 
(stage3+stage4) 
(n=194) 
F 值 
sig. 
SDNN ms 57.13 59.8 67.06 81.58 50.59 42.5 88.934***
RMSSD ms 36.37 31.89 38.95 57.07 34.51 29.96 74.557***
SDSD ms 23.96 20.76 26.3 40.06 22.45 18.41 81.468***
NN50 count 46.8 39.66 50.56 99.16 39.35 35 81.551***
pNN50 % 0.13 0.11 0.16 0.29 0.12 0.1 78.694***
LF/HF  2.26 2.7 2.47 1.13 1.94 2.85 15.937***
LFnorm % 0.61 0.69 0.64 0.51 0.58 0.58 31.691***
HFnorm % 0.39 0.31 0.36 0.49 0.42 0.4 30.901***
VLF% % 0.5 0.57 0.57 0.56 0.49 0.35 69.117***
TP ms2 316.629 300.853 465.811 587.036 235.412 170.914 71.359***
LF ms2 83.152 81.872 112.429 128.892 66.221 58.793 46.165***
HF ms2 57.209 35.255 69.935 126.616 49.822 39.872 79.777***
VLF ms2 176.267 183.726 283.447 331.528 119.37 72.249 57.532***
註：*** P<.001  
 表 12、各特徵值參數與其具高相關性的特徵值參數 
  具高度相關的特徵值參數 
SDNN RMSSD、pNN50、TP、LF、VLF 
RMSSD SDNN、SDSD、NN50、pNN50、TP、HF 
SDSD RMSSD、NN50、pNN50、HF 
NN50 RMSSD、SDSD、pNN50、TP、HF 
pNN50 SDNN、RMSSD、SDSD、NN50、TP、HF 
LF/HF LF norm、HF norm 
LF norm LF/HF、HF norm 
HF norm LF/HF、LF norm 
VLF% 無 
TP(5 mins total power) SDNN、RMSSD、SDSD、pNN50 
LF SDNN、TP、VLF 
HF RMSSD、SDSD、NN50、pNN50 
VLF SDNN、TP、LF 
 
vi. 利用類神經網路進行睡眠階段的辨別 
本研究以睡眠中的心電圖資料作為訓練與測試資料來源，取出的各項特徵值
依照所屬的睡眠階段預先分類，分類完成之後，各睡眠階段皆挑選屬於此睡眠階
段之單段睡眠資料中段部分的特徵值資料作為訓練資料，其餘的資料為測試資
料，確保訓練出來的網路能夠較為正確的判斷各睡眠階段穩定的部份，各睡眠階
段在改變前後的部份則以各睡眠階段中段的部份為基礎，利用網路聯想能力進行
辨識。在訓練與測試資料確定之後，接著利用類神經網路建立睡眠階段自動辨別
網路，以所選擇的特徵值參數作為網路輸入端，辨別出的睡眠階段作為網路輸出
端。 
本研究採用倒傳遞類神經網路(Back Propagation Network, BPN)作為睡眠階
段自動辨別工具。倒傳遞類神經網路具有適用性廣泛、學習精確度高、回想速度
快、理論簡明、輸出值可為連續值，能處理複雜的樣本識別與高度非線性的函數
合成問題等特性，可應用於樣本識別、分類問題、函數模擬、預測、系統控制、
雜訊過濾、資料壓縮、專家系統等用途，為適合本研究之類神經網路模組。 
網路訓練演算法採用 Bayesian regularization backpropagation，此演算法藉由
  
圖 14 、睡眠階段辨別網路參數設定測試流程圖 
 
(1) 網路相關設定 
資料來源為 MIT/BIH 多項生理訊號資料庫心電圖資料。使用工具為 Matlab 
7.4.0 的類神經網路工具箱。採用之類神經網路模組為倒傳遞類神經網路，所採
用之網路訓練演算法為 Bayesian regularization backpropagation(trainbr)，輸入層輸
出層的轉移函數皆為正切雙彎曲函數，其餘詳細設定如下所示。 
¾ 輸入參數資料包含頻域分析：5 min total power、VLF、VLF%、LF、LF 
norm、HF、HF norm、LF/HF；時域分析：SDNN、RMSSD、SDSD、
NN50、pNN50 共 13 個維度。輸入函數數值範圍介於-1~1。 
¾ 本研究所區分的睡眠階段共有 5 種，因此在輸出參數資料的部份以一個
5 個維度的陣列來代表 5 種睡眠階段；第 1 維代表甦醒、第 2 維代表
REM、第 3 維代表 stage1、第 4 維代表 stage2、第 5 維代表熟睡。其中
 表 13、網路訓練參數設定 
參數項目 參數中文名稱 參數設定值 
epochs 訓練最大循環次數 100000 
goal 性能目標 20、30、40 
max_fail 最大驗證數據失敗次數 5 
mem_reduc 降低記憶體需求量係數 1 
min_grad 最小性能梯度 1e-10(10-10) 
mu μ的初始值 0.005 
mu_dec μ的減少係數 0.1 
mu_inc μ的增加係數 10 
mu_max μ的最大值 10000000000 
time 最大訓練時間 Inf(無限大) 
show 顯示更新間隔 25epochs 
 
¾ 訓練資料筆數與測試資料主要以各單段睡眠資料中段部分切割出來之
分析資料區段所計算出的特徵值資料組作為訓練資料，由其餘的分析資
料區段所計算出的特徵值資料組為測試資料。訓練資料筆數與測試資料
的詳細筆數如表 14。 
 (3) 評估最佳網路參數設定 
將所有的輸入特徵值組進行正規化後，針對前步驟所建立的 45 個網路
進行訓練與測試。所有網路皆訓練與測試完成之後，將各組合的睡眠階段輸
出結果與實際睡眠階段的結果進行二元性的分析並建構混淆矩陣，計算真陽
性、偽陽性、偽陰性以及真陰性。根據依照四種狀態計算各睡眠階段的敏感
性、特異性等評估指標。接著將同種網路架構與性能目標組合下的 5 個網路
輸出數據取平均並計算各睡眠階段的 Youden index 作為最終用來評估的評
估指標，以決定最佳網路參數設定。本實驗根據以下條件作為選擇最符合本
研究要求的網路： 
¾ 以甦醒階段與 REM 階段的 Youden index 皆大於 0.5，其餘睡眠階段
皆高於 0.6 作為最基本的選擇標準。 
¾ 選擇甦醒與 stage 1 的 Youden index 明顯較高者。 
¾ 甦醒與 stage 1 的 Youden index 差距不大的情況下，選擇熟睡與 REM
之 Youden index 明顯較高者。 
由各網路輸出的敏感性、特異性所計算而得的 Youden index 如表 15 所
示。在本實驗中我們決定選擇以隱藏層神經元數目 30、性能目標 20 為最佳
參數設定。選擇原因如下： 
¾ 該網路所有睡眠階段的 Youden index 皆達到最基本的選擇標準。 
¾ 該網路甦醒階段階段的 Youden index 明顯較其他達到最基本的選擇
標準網路的輸出結果為高。 
 
 
 
 
 
 
 5組權重值是否
皆測試完畢
start
隨機建立5組權重值
選擇1組權重值建立睡眠階段辨
別網路
網路訓練與測試
End
是
是
否
否
評估各輸入維度中最佳的網路
決定最合適網路輸入參數組
是
否
設定網路輸入參數
維度目標m
n = n-1
從n維的最佳網路輸入參數中
選出n-1維特徵值參數
作為網路輸入函數
採用的特徵值
參數組合維度n-1是否等於
欲選取維度m
所有n-1維度特徵值
組合是否皆測試完畢
評估n-1維度中最佳的網路決定
n-1維度最佳的網路輸入參數組
 
圖 15、睡眠階段辨別特徵值參數篩選步驟流程圖 
 
(1) 網路相關設定 
資料來源為 MIT/BIH 多項生理訊號資料庫心電圖資料。使用工具為 Matlab 
7.4.0 的類神經網路工具箱。採用之類神經網路模組為倒傳遞類神經網路，所採
用之網路訓練演算法為 Bayesian regularization backpropagation(trainbr)，輸入層輸
出層的轉移函數皆為正切雙彎曲函數，其餘詳細設定如下所示。 
¾ 輸入參數資料包含：5 min total power、VLF、VLF%、LF、LF norm、
HF、HF norm、LF/HF、SDNN、RMSSD、SDSD、NN50、pNN50 共
13 個維度。輸入函數數值範圍介於-1~1。隨著實驗進行會逐步減少輸
 評估指標。採用相同網路輸入參數組合的 5 個網路輸出數據取平均並計算各
睡眠階段的 Youden index 作為最終用來評估的評估指標。 
最佳網路的評估條件如實驗二步驟二，以各睡眠階段的 Youden index
作為主要的評估準則，來決定各維度的最佳網路輸入參數組合。並以最佳的
網路輸入參數組合作為下一個縮減維度的特徵值選擇基礎。 
(4) 評估最佳網路輸入參數組合 
當輸入特徵參數維度縮減達到停止條件之後，本研究針對各網路輸入維
度當中的最佳網路輸入參數組合網路進行評估，找出最符合本研究的網路輸
入參數組合。 
¾ 13 維輸入參數的網路縮減至 12 維輸入參數的網路 
各網路輸出的 Youden index 如表 16 所示。在本實驗中我們決定選擇篩
除特徵值參數 LF。選擇原因如下： 
․ 該網路所有睡眠階段的 Youden index 皆達到最基本的選擇標準。 
․ 該網路與選擇移除特徵值參數LF norm的網路相比，甦醒、REM、stage1
的 Youden index 明顯較高。 
․ 該網路與選擇移除特徵值參數 VLF 的網路相比，在甦醒、stage1 的
Youden index 差異不大，在 REM、stage2、熟睡方面的 Youden index。 
 
 
 
 
 
 
 
 
 表 17、各 11 維輸入參數網路的 Youden index 
 甦醒 REM Stage1 Stage2 熟睡 
移除 SDNN 0.465 0.494 0.856 0.613 0.773 
移除 RMSSD 0.503 0.542 0.877 0.598 0.763 
移除 SDSD 0.537 0.547 0.904 0.573 0.775 
移除 NN50 0.409 0.458 0.893 0.524 0.761 
移除 pNN50 0.431 0.439 0.870 0.502 0.741 
移除 LF/HF 0.545 0.522 0.881 0.624 0.787 
移除 LF norm 0.480 0.491 0.907 0.602 0.757 
移除 HF norm 0.547 0.524 0.893 0.638 0.790 
移除 VLF% 0.494 0.446 0.901 0.569 0.754 
移除 TP 0.545 0.521 0.892 0.570 0.742 
移除 HF 0.553 0.505 0.897 0.596 0.786 
移除 VLF 0.562 0.530 0.903 0.647 0.790 
 
¾ 11 維輸入參數的網路縮減至 10 維輸入參數的網路 
各網路輸出的陽性預測值如表 18 所示。在本實驗中我們決定選擇篩除
特徵值參數 LF。選擇原因如下： 
․ 該網路所有睡眠階段的 Youden index 皆達到最基本的選擇標準。 
․ 該網路與選擇移除特徵值參數 LF norm 與 TP(5 mins total power)的網
路相比，甦醒與熟睡的 Youden index 明顯較高。 
․ 該網路與選擇移除特徵值參數 HF norm 的網路相比，REM、stage 2、
熟睡的 Youden index 明顯較高。 
 
 
 
 
 ¾ 9 維輸入參數的網路縮減至 8 維輸入參數的網路 
各網路輸出的陽性預測值如表 20 所示。在本實驗中我們決定選擇篩除
特徵值參數 LF/HF。選擇原因如下： 
(1) 該網路所有睡眠階段的 Youden index 皆達到最基本的選擇標準，其餘
網路皆未達到最基本的選擇標準。 
表 20、各 8 維輸入參數網路的 Youden index 
  甦醒 REM stage1 stage2 熟睡 
移除 SDNN 0.462 0.497 0.893 0.615  0.755  
移除 RMSSD 0.497 0.542 0.889 0.603  0.759  
移除 SDSD 0.485 0.531 0.879 0.555  0.735  
移除 NN50 0.400 0.492 0.886 0.569  0.726  
移除 pNN50 0.396 0.422 0.865 0.519  0.706  
移除 LF/HF 0.562 0.535 0.912 0.610  0.756  
移除 HF norm 0.487 0.562 0.898 0.637  0.777  
移除 VLF% 0.432 0.464 0.877 0.597  0.748  
 
¾ 8 維輸入參數的網路縮減至 7 維輸入參數的網路 
各網路輸出的 Youden index 如表 21 所示。由於在本實驗中並未出現所
有睡眠階段之 Youden index 皆達選擇標準的網路，因此我們決定於此步驟停
止網路輸入維度的刪減。 
表 21、各 7 維輸入參數網路的 Youden index 
  甦醒 REM stage1 stage2 熟睡 
移除 SDNN 0.466 0.511 0.901 0.611  0.739  
移除 RMSSD 0.489 0.519 0.922 0.600  0.767  
移除 SDSD 0.508 0.530 0.867 0.577  0.740  
移除 NN50 0.471 0.510 0.869 0.545  0.728  
移除 pNN50 0.455 0.451 0.905 0.531  0.727  
移除 HF norm 0.526 0.478 0.867 0.579  0.714  
移除 VLF% 0.447 0.477 0.903 0.585  0.731  
 
 
 們可以設法將較為不必要的特徵值參數加以過濾，減少網路輸入維度，降低網路
複雜度，藉此減少網路訓練時間以及改善睡眠階段辨別的正確率。然而藉由測試
所有組合來找出最佳的特徵值參數組合是非常耗時起不切實際的。因此本研究利
用 Sequential Backward Selection(SBS)此種特徵參數選取方法(feature selection 
method)進行特徵值參數的篩選，經過 Sequential Backward Selection 的步驟，可
大幅降低選取特徵值參數組合所需要的運算次數，同時找到效果不錯的特徵值參
數組合。 
 
B.3 睡眠評估指標建立 
評估睡眠品質的指標包括總睡眠時間(臥床時間)、睡眠潛伏期(真正入睡之前
所花費的時間)、睡眠效率((總睡眠時間－睡眠潛伏期)/總睡眠時間)、夜裡覺醒次
數、快速眼動期與熟睡階段(NREM stage3 與 stage4)持續時間、其他影響睡眠因
素(如睡眠疾病)等六項。以上六項評估指標除了最後一項需專業醫生進行診斷之
外，其餘項目皆可藉由睡眠時期睡眠階段的詳細變化情況得知。本研究嘗試建立
的睡眠品質評估指標包括(A)總睡眠時間、(B)睡眠潛伏期、(C)睡眠效率、(D)夜
裡覺醒次數、(E)快速眼動期與熟睡階段持續時間。 
 
i. 總睡眠時間 
此指標的定義為受測者實際在躺在床上所經過的時間。本研究針對此項指標
會以第一筆心電圖資料輸入作為睡眠開始判定，以輸入最末筆資料為睡眠結束判
定，而相鄰兩筆輸入資料的時間間隔為 30 秒，系統可以藉由計算輸入資料總筆
數取得為輸入資料所涵蓋的時間，此段時間即為系統判定的總睡眠時間。當總睡
眠時間少於 6.5 小時即判斷此指標為睡眠品質不良。 
ii. 睡眠潛伏期 
此指標的定義為受測者從躺在床開始到真正入睡之前所花費的時間。本系統
針對此項指標會從第一筆心電圖資料輸入開始辨別是否有睡眠階段的改變，當系
 所測得的熟睡階段與 REM 階段持續時間為分子，計算熟睡階段以及 REM 階段
持續時間所佔比例，當熟睡或 REM 任一睡眠階段持續時間所佔比例低於 10%
時，即判斷此指標為睡眠品質不良。 
 
  
圖 16、領域本體論架構圖 
 
 
圖 17、領域本體論架構圖 
 
3. 睡眠評估模組測試，本研究以各項心律變異率特徵值作為輸入參數，利用倒
傳遞類神經網路建構睡眠階段辨別網路，為確認各特徵值參數是否具備識別
能力以及找出最佳的網路設定，本研究透過 3 個實驗得到以下結果： 
i. 各項特徵值參數於不同睡眠階段的差異顯著性分析結果：透過 one-way 
 可以發現在「進、退出功能」、「視覺上感到複雜」、「能明白量條式的運動建
議」、「會照著運動建議作改善」等方面，與教育有相關性；而在「能明白運
動建議」、「會照著運動建議作改善」等方面，則與性別有相關性。 
表 23、運動項目對照攝氧量範例表 
題目 很好 好 一般 差 很差 正向百分比(很好+好) 
性別雙
尾檢定 P
教育雙
尾檢定 P
操作上這樣的選單選擇方式會困
難嗎 9 (60%) 5 (33%) 0 (0%) 0 (0%) 1 (7%) 14 (93%) 1 0.07
操作上會進入、退出功能嗎 10(67%) 4 (27%) 0 (0%) 1 (7%) 0 (0%) 14 (93%) 0.625 0.034
操作上再次操作，可以獨立完成嗎
(進入、退出選單) 8 (53%) 6 (40%) 0 (0%) 1 (7%) 0 (0%) 14 (93%) 0.648 0.122
操作上知道怎麼直接回到首畫面
嗎 8 (53%) 6 (40%) 0 (0%) 1 (7%) 0 (0%) 14 (93%) 0.648 0.122
視覺上畫面會很複雜嗎 11 (73%) 3 (20%) 0 (0%) 1 (7%) 0 (0%) 14 (93%) 0.296 0.011
視覺上顯示畫面的字體適中嗎 14 (93%) 0 (0%) 1 (7%) 0 (0%) 0 (0%) 14 (93%) 0.35 0.097
視覺上功能顯示清楚嗎(看得出代
表意義) 14 (93%) 0 (0%) 0 (0%) 1 (7%) 0 (0%) 14 (93%) 0.35 0.097
視覺上排列方式可以接受嗎?或著
常常忽略找不到 14 (93%) 0 (0%) 1 (7%) 0 (0%) 0 (0%) 14 (93%0 0.35 0.097
飲食資訊的清單選擇上，都能滿足
平日需求嗎 7 (47%) 3 (20%) 3 (20%) 2 (13%) 0 (0%) 10 (67%) 0.356 0.487
卡路里的攝取量以量條的表現方
式，能清楚明白飲食熱量該如何控
制嗎 
8 (53%) 2 (13%) 3 (20%) 2 (13%) 0 (0%) 10 (67%) 0.067 0.117
飲食健康資訊這樣的建議方式足
夠嗎 11 (73%) 0 (0%) 4 (27%) 0 (0%) 0 (0%) 11 (73%) 0.327 0.234
飲食健康資訊給的建議會照著做
嗎 10 (67%) 0 (0%) 3 (20%) 2 (13%) 0 (0%) 10 (67%) 0.945 0.639
運動資訊的清單選擇上，都能滿足
平日需求嗎 9 (60%) 0 (0%) 4 (27%) 2 (13%) 0 (0%) 9 (60%) 0.128 0.263
運動強度以量條的表現方式，能清
楚明白運動量該如何控制嗎 8 (53%) 2 (13%) 3 (20%) 2 (13%) 0 (0%) 10 (67%) 0.014 0.023
運動健康資訊這樣的建議方式足
夠嗎  10 (67%) 0 (0%) 4 (27%) 1 (7%) 0 (0%) 10 (67%) 0.264 0.083
運動健康資訊給的建議會照著做
嗎 11 (73%) 0 (0%) 4 (27%) 0 (0%) 0 (0%) 11 (73%) 0.035 0.014
看到藥物提醒的藥物圖片能知道
要吃什麼藥物嗎 14 (93%) 0 (0%) 1 (7%) 0 (0%) 0 (0%) 14 (93%) 0.35 0.097
這樣的用藥提醒方式有效嗎 14 (93%) 0 (0%) 1 (7%) 0 (0%) 0 (0%) 14 (93%) 0.35 0.097
用藥提醒方面是否需要其他的提
醒方式 13 (87%) 2 (13%) 0 (0%) 0 (0%) 0 (0%) 15 (100%) 0.922 0.439
會照著用藥提醒時間服用藥物嗎 14 (93%) 1 (7%) 0 (0%) 0 (0%) 0 (0%) 15 (100%) 0.35 0.097
購買意願 0 (0%) 8 (53%) 6 (40%) 1 (7%) 0 (0%) 8 (53%) 0.448 0.668
 
 
 技術說明 
中文： 
本研究的主要目的，是以本體論概念建置遠距居家照護系統，以解決在地老
化的需求和系統服務的延展性。在系統擴充性方面，本研究以 SOA 架構將系統服
務分成流程與資料，並將同性質的流程歸類為特定任務，藉由任務本體論以 XML
格式描述各特定任務中需要的代理者和資料，讓系統管理者可以從 XML 的描述
中，輕易增減服務流程需要的功能和資料。在系統完整性方面，本研究在疾病異常
評估的描述上是以 OWL 格式定義疾病的診斷標準和治療建議，讓健康管理師能在
此資料結構上描述各疾病的衛教資訊。在系統可近性方面，本研究不僅設計了簡易
的輸入介面，更以直觀的圖文說明來協助使用者進行選單操作。 
為了驗證系統效能及系統滿意度，本研究設計了三個實驗：(1)比較本體論系
統與傳統三層式系統在全部執行時間、生理資料擷取時間和建議時間的差異；實驗
結果顯示，使用本體論建置照護系統，執行時間略高於傳統三層式系統。(2)在 Intel 
Core2 Due E8400 的 CPU 環境下，由系統產生多個執行緒，不斷對本體論的網路服
務發出需求，並記錄系統效能的變化；實驗結果顯示，本研究所開發之系統不僅可
以同時服務超過 1500 人，且當人數在 100 人以內，系統能在 1 秒以內給予回應。
(3)以 15 名高齡者為實驗對象，針對操作流程、視覺感受、資訊完整性和需求與價
值感四個面向進行滿意度調查。93%(n=14)的人對於流程和介面設計感到滿意。
93%(n=14)的人覺得這樣的提醒方式可以有效提醒自己吃藥。67%(n=10)的人，認為
本系統在建議上，能協助對於卡路里或運動強度沒有概念的人，改善飲食和運動習
慣。至於購買意願方面，53%(n=8)的人願意付費享用此服務。 
