中文關鍵詞： wireless local area network (WLAN), wireless 
metropolitan area network (WMAN),wireless personal 
area network (WPAN) 
英 文 摘 要 ： Wireless mesh networks have recently drawn much 
attention and also emerged as a promising design 
paradigm for next generation wireless networks. 
Wireless mesh networks (WMNs) comprise mesh routers 
and mesh clients, where the mesh routers form a 
wireless backhaul and provide the opportunities of 
communication between wired networks and mesh clients 
of wireless mesh network. Because of the promising 
concept of self-organization and auto-configuration, 
wireless mesh networks provide adaptive and flexible 
wireless Internet connectivity to mobile users. The 
concept can be applied to different access 
technologies such as wireless local area network 
(WLAN), wireless personal area network (WPAN) and 
wireless metropolitan area network (WMAN) 
technologies. 
 
    There are lots of potential applications for 
wireless mesh networks including the backhaul of 
cellular networks, home networks, enterprise 
networks, community networks, and intelligent 
transport system networks. Developing wireless mesh 
networking technologies needs to deal with 
challenging architecture and protocol design issues. 
The issues related to wireless mesh network 
architecture and management include network planning, 
network integration, and adaptive and flexible 
network management. The issues related to protocol 
designs include exploiting advanced technologies, 
providing quality of service to different types of 
applications, providing power management, mobility 
support, and mechanisms for efficient encryption, 
authentication, and intrusion detection. 
 
    In our project of first year, we attempt to 
prolong the system lifetime by deploying many mesh 
routers with auto-organization and auto-configuration 
capabilities over wireless mesh network. In the 
行政院國家科學委員會補助專題研究計畫 成 果 報 告   
□期中進度報告 
 
 
 
矛與盾:浮水印移除與防制技術之研究 (2/2) 
Spear and Shell: The Researches on the Technology of Watermark Removing 
and Resisting 
 
 
 
計畫類別： 個別型計畫  □整合型計畫 
計畫編號：NSC 99-2221-E-366 -010 -MY2   
執行期間：99年 08月 01日至 101年 09月 30日 
 
計畫主持人：謝文雄  
 
 
 
 
 
 
 
 
 
 
          
執行單位：樹德科技大學資訊工程系 
 
中   華   民   國  101 年  9  月  30  日 
 3 
研討會論文五篇: 
1.  W.S. Li*, C.W. Tsai, W.S. Hsieh, C.S. Yang, M.C. Chiang, “On Randomly 
Generated Non-trivially Pairwise Key for Group-based Wireless Sensor 
Networks”, International Conference on Applied Material and Electronic 
Engineering (AMEE 2012), Jan. 2012, Hong Kong  
2.  C.Y. Chen*, W.S. Hsieh, W.S. Li*, J.Y. Chiang, “A Novel Dynamic Program 
Update Protocol for Secure Sensor Networks Using Chameleon Hash Function” , 
International Conference on Applied Material and Electronic Engineering 
(AMEE 2012), Jan. 2012, Hong Kong 
3.  C.Y. Chen*, W.S. Hsieh, W.S. Li*, J.Y. Chiang, “A Novel Secure Access Control 
Protocol for Secure Sensor Networks Based on Chameleon Hash Function” , 
International Conference on Applied Material and Electronic Engineering 
(AMEE 2012), Jan. 2012, Hong Kong 
4.  C.W Tsai, W.S. Li*, M.Chen, W.S. Hsieh, C.S. Yang, ”Analysis of Multi-Path 
Random Key Pre-Distribution for Wireless Sensor Networks”, Mobility Modeling 
and Performance Evaluation (MoMoPE) in international Conference on 
Innovative Mobile and Internet Services in Ubiquitous Computing (IMIS 2011), 
July 2011, Korea 
5.  H.T. Wu, L.S. Chen, T.S. Su, W.S. Hsieh,” The Message Authentication Method 
in Sparse RSU-based Vehicular Area Networks”, Conference of Information and 
Communication Technical Management and Applications. June 2011, Kaohsiung, 
( Best Paper Award)  
2as disjoint secure paths or disjoint secure cliques, to achieve a secure cooperation among nodes. The
algorithms designed for secure communication in wired and wireless networks, however, have markedly
different characteristics. This work provides a graph-theoretical model for it, and we will show that an
effective probability analysis can be model the behavior of RKP based techniques. The secure subgraph
embedding supported by the key management scheme are discussed and analytical results are presented.
RKP-based schemes are the most popular probabilistic models used to solve security problems for
large scale sensor networks. It relies on probabilistic key sharing among nodes and uses simple pro-
tocols for shared-key discovery, path-key establishment, and incremental addition of nodes. The key
setup phase generates a key pool of K keys. For each node, k keys are randomly drawn from the
key pool before deployment, and the probability of at least one key are shared between two nodes is
p = 1− (K
k
)(
K−k
k
)
/
(
K
k
)2
, as in [1], [2]. Existing RKP-based schemes analyze the security strength based
on the number of communication links that can be compromised due to compromised sensors in a network.
This motivates us work on the theoretical results of the graph model on security/reliability issues, a topic
extensively studied in the last few decades. Network can be thought of as a large connected graph in which
each edge has a certain probability p of open. In particular, this work is interested in the probability that,
after RKP establishment, the network is still connected or end-to-end connected. Most variation of RKP
[3], [1], [4], [5] are applied by passing information through a secure path, P ` = v1v2...v`, this information
is guaranteed safe in the sense that the path is composed of secure neighbors. For a given pair of nodes
with diameters < `, the main goal is identify the threshold, p0, such that at least one secure path with
length ` between them. This problem can be formulated in a form which is perhaps more convenient to
a graph theorist as follows.
Most graphs share many graph properties. A formal approach is to define a random graph (RG) [6],
that is, a probability distribution over a suitable family of graphs, and then show that events of interest
occur with a high probability (w.h.p.) as the order of the nodes tend to infinity. The theory of random
graphs began in the late 1950s by Erdo¨s and Re´nyi [6]. In contrast to percolation theory, which emerged
from efforts to model physical phenomena, random graph theory was devised originally as a mathematical
tool in existence proofs of certain combinatorial objects. Nevertheless, random graphs are clearly not an
adequate models for networks that are in a geometric space, such as ad hoc wireless sensor networks.
Percolation theories and random geometric graphs have been very influential models of large networks.
The principal difference between random geometric graphs and random graphs is that random graphs
are not constrained by an geometric setting. Despite this key difference, many phenomena in random
geometric graph also occur in random graphs, and the results are seemingly similar. In particular, a
wireless multi-hop network has behaviors that differ from those of random graphs and purely percolation
theories.
Given a arbitrary graph G with n vertices and m edges, the behavior of the RKP sensor network can
be taken as a random subgraph SGp = S(G, p) of G by keeping each edge of G with probability p
independently. The probability that SGp is connected can be expressed as
f(p) = f(SGp) =
m∑
i=n−1
Ai p
i(1− p)m−i (1)
where Ai is the number of sets of edges of cardinality i which contain a spanning tree of G. In particular,
in order to count the number of combinatorial structures in SGp , such as `-vertices subgraph counting
problem, then one can rewrite f as
∑
P (Ai), where i run through the index set of all `-subsets of [n].
Estimating the functions seems to be hard and a vast amount of literature germane to this issue (an
interested reader may refer to [6] for a partial list of references). Several special cases of this problem
have been considered in different areas. For instance, if G is the complete graph on n vertices then SGp
is the classical random graph G(n, p). In this case, the connectivity and the subgraph count problems are
discussed in great details in Balloba´s’ book [6] and the monograph of Janson et al [7]. Another case is
when G is the d-dimension lattice restricted to a compact domain; in this case the connectivity problem
4Generally, the RKP-based schemes [1], [11], [3], [4], [2], which can be stated as following three phases:
1) Key pre-distribution prior to deployment.
2) Shared key discovery after deployment.
3) Path-key establishment when two sensor nodes do not share a key.
In the key setup phase, a large pool of K keys and their identities are generated. For each sensor node,
k keys are randomly drawn from the key-pool without replacement. These k keys and their identities
form a key-chain for a sensor node. The size K of the key pool is important for ensuring both good
connectivity and increased resilience of key management. That is, a smaller size of K makes a key
sharing between two nodes with a higher probability, thereby leading to greater chances of ensuring
connectivity. Conversely, this can also increase the network susceptibility, since by compromising fewer
nodes, an adversary would be able to eavesdrop successfully on a large number of communications
among non-compromised nodes. Note also that when a network is sparse, the probability of key sharing
between two sensor nodes becomes decreases, as shown in [4]. For each node, k keys are randomly
drawn from the key pool before deployment, and the probability of key shared between two nodes is
p = [1− ((K − k)!)2/((K − 2k)!K!)], as demonstrated in [1], [2].
A small K ensures high connectivity, however, it suffers from no resilience against node. Since capture
of a single node compromises the large fraction of communications of a network. The various proposals
differ according to the structure of the key pool, the number of common keys required, their applicability
to a dynamic deployment scenario, and the method of determining the common keys. These schemes offer
network resilience against capture of nodes since a node has very few keys deployed on it. Thus, there
is no need to consider tamper resistant nodes (though note that non tamper-resistant nodes might not be
acceptable in some situations such as military deployments).
Generally, the following three kinds of key commonly used in the key pre-distribution based schemes,
1) pair-wise key [12], 2) path-key, [1], [3], and 3) neighbour-key [5]. The pair-wise key schemes suffer
from heavy resource consumption when k (memory) is increased to achieve connectivity as the number of
nodes increases. In the path-key approaches, one does not need to establish a direct secure link between
a pair of nodes; instead, finding a secure path to forward messages is the principal challenge [3], [13].
Differing from the path-key, a neighbour-key process[5] can achieve the same effect with the assistance
of neighbours to encrypt/decrypt the message for a sender/receiver without the path-finding problem [4].
Another important advantage is that using neighbour-key is particularly efficient for a critical link. We call
a link or an edge is critical if it close will disconnect the network. In the path-key schemes, obviously, to
construct a path between two critical nodes requires a much longer length. Furthermore, a neighbour-key
does not incur overhead when the link is critical. Nodes that discover that they shared a key in their key
rings can then verify that their neighbour actually holds the key via a challenge-response protocol. The
shared key then becomes the key for that link. We will study the threshold function for the neighbour-key
in Lemma 11.
One of the aims is to estimate the probability of key connectivity, one thus can design a key pool
K and key chain k to provide desired connectivity. In [3], the probability of existence a path between
two nodes was calculated directly. Though the situation is more complex when the length increases (See
detail in [5]). If k is growth with an appropriate rate, a precise lower bound can be obtained by Stirling’s
formula. Suppose that k = oKK, where oK → 0 arbitrarily slowly as K → ∞, then for |εK | < CK−1,
the probability of any two nodes has lat least one sharing key is
P1 = 1− ((K − k)!)
2
K!(K − 2k)!
= 1− (K − k)
2(K−k)
KK(K − 2k)K−2k
e−2(K−k)
e−Ke−(K−2k)
· (1 + εK−k)
2
(1 + εK)(1 + εK−2k)
6(although the process is generate limit to the window, one can figure out that inside point process is a
random sampling from an infinite region, that why some nodes may exist ’outside’ the window). Thus,
this will result in a negatively biased estimator of F , which called a bias due to boundary effects. One of
the most common solution is replace window W with the torus model T [10], which is convenient for
analysis, but not for practical application. Others methods, such as border methods, try to eliminate the
boundary effect via an appropriate erosion on window W ( for a survey of corrections for edge effects,
see [14]). Notably, the same problem occurs when one needs to count the subgraph nearing the boundary.
The other reason is that Erdo¨s-Re´nyi random graph have the characteristic of independence or near-
independence between the status of different edges. This is not the case for geometric graphs. In a
geometric context, the triangle property is frequently more realistic than the independence of edges in the
Erdo¨s-Re´nyi model. Consequently, if one can generate a tolerance room of ε to carry these bad effects then
one can then reduce some properties that are difficult to handle. For instance, one can collect boundary
nodes into an exceptional class V0 when apply the Semere´di partition.
Another significant reason is the algorithm aspects of the regularity lemma. The original proof of
the regularity lemma is non-constructive, but later a polynomial time algorithm for finding (ε, k)-regular
partitions have been developed in [15], and the interested reader is refer to [16] for a survey on algorithmic
variants and applications of the regularity Lemma. Recently, a fast O(n) algorithm appear in [17], and
actually has the added advantage of being able to find the smallest regular partition. Another O(1)
randomized algorithm of regularity lemma is developed and is particularly suitable for distributed nature
of wireless networks [18]. These reasons motivate us to make use of the Szemere´di’s regularity lemma.
III. ε-REGULARITY PARTITION
Our aim in this section is to state a variant of the celebrated regularity lemma of Szemere´di [19]. Since
its discovery in the late 1970s, the Szemere´di’s Regularity Lemma is one of the most remarkable results
in modern graph theory [19], having a wide variety of uses and applications. In computer science, such
regularity notions have been used extensively in approximation algorithms [20], [21], [22], [23], distributed
computing [24], [25], property testing [26], [27], [28], [29], [30] and communication complexity [31].
Therefore, there has been a growing interest in studying the properties of such graphs. The following is
the introduction of the regularity lemma [32].
A. Preliminary definition and the regularity lemma
The Regularity Lemma says that any dense graph an be partitioned into a small number of regular
pairs and a few leftover edges [32]. Let G = G(V,E) ∈ WSN be a realization of wireless ad hoc/sensor
network on n nodes and m edges, for any two disjoint sets U,W ⊆ V , a pair of disjoint sets of vertices.
Denote by E(U,W ) the set of all edges between U and W , i.e.,
E(U,W ) = {{u,w}:u ∈ U, w ∈ W}.
The density of the pair (U,W ) is defined by
d(U,W ) =
|E(U,W )|
|U ||W | . (4)
The pair (U,W ) is called ε-regular if
|d(U,W )− d(U ′,W ′)| < ε (5)
for any U ′ ⊂ U and W ′ ⊂ W with |U ′| ≥ ε|U | and |W ′| ≥ ε|W |. We may now state Szemere´di’s
celebrated regularity lemma.
Theorem 1. For every ε > 0 and k0 ≥ 1, there exists an integer K = K(ε, k0) such that any graph G
admits a partition V = V1 ∪ . . . ∪ Vk, where |V1| ≤ |V2| ≤ . . . ≤ |Vk| and k0 ≤ k ≤ K, such that all but
≤ ε(k
2
)
pairs (Vi, Vj) are ε-regular.
8Theorem 4. For any given ε > 0, k0 ≥ 1, and C ≥ 1, there are constants α = α(ε, k0, C) > 0,
K = K(ε, k0, C) ≥ k0, and n0 = n0(ε, k0, C) such that any graph G = Gn with n ≥ n0 vertices that
is (α,C)-upper-uniform with respect to density 0 < p ≤ 1 admits an (ε,G, p)-regular (ε, k)-equitable
partition of its vertex set with k0 ≤ k ≤ K.
Theorem 4 was independently observed by Y. Kohayakawa and V. Ro¨dl, and in fact a simple modification
of Szemere´di’s proof of his lemma gives this result. For applications of this variant of the regularity lemma,
see [32].
Since there is no deterministic embedding lemma for sparse graphs, it is natural to suggest a probabilistic
variant. It turns out that the easiest way to apply sparse setting is to show that the size of the family of
’bad’ event grows ’superexponentially more slowly’ than the size of the family of all graphs. Now let us
give the following definition. More specially, it will turn that we require a probability for the occurrence
of a subgraph is at least as 1− βT for suitable small β.
Definition 1. ([32]) Let B be a family of labeled graphs and suppose β > 0 is a constant. Write B(n, T )
for the graphs in B that have n vertices and T edges. For the sake of definiteness, suppose all graphs
in B(n, T ) have vertex set [n] = {1, . . . , n}. We shall say that B is a β-thin family if there exists an
integer n0 such that, for all 0 ≤ T ≤
(
n
2
)
,
if n ≥ n0, then |B(n, T )| ≤ βT
((n
2
)
T
)
. (7)
In [34] the following conjecture was presented, which resembles the Erdo¨s-Stone theorem. In the
monograph [7] this conjecture was mentioned be one of the most important theorems in random graph.
Conjecture 5. (KLR Conjecture) Let H be a fixed graph. For any β > 0, there exist constants ε0 >
0, C > 0, n0 > 0 such that
|F(H,n, T, ε)| ≤ βT
(
n2
T
)|E(H)|
for all T ≥ Cn2−1/d2H , n ≥ n0, and 0 ≤ ε ≤ ε0, where
d2(H) = max
{ |E(F )| − 1
|V (F )| − 2 : F ⊂ h, |F | ≥ 3
}
. (8)
Generally speaking, the KLR conjecture states that if H can be shown to occur with extremely small
probability as a subgraph in a random ε-regular graphs, then the random H-free graphs are almost (χ(H)−
1)-partite.
Following theorem can be seen as a counting version of the KLR conjecture when H = P `. Notably,
it is a modify version (of Theorem 5.2 in [35]) by replacing the d2 density with the rooted density, and
we will use it in the prove of Lemma 11. The detail of rooted density can see [7].
Theorem 6. For any β, δ > 0, there exist constants ε0 > 0, C > 0, n0 > 0 such that∣∣F(P `, n, T, ε, δ)∣∣ 6 βT(n2
T
)`
(9)
for all T ≥ Cn2−(`−1)/`, n ≥ n0, and 0 ≤ ε ≤ ε0.
Throughout this paper, a random subgraph with constant p is not a very interesting object to study for
our purposes. If p is a constant, the degree, i.e., the number of edges per vertex, grows linearly with n,
while many real networks are much sparser. As we will see, interesting behavior such as packing and
embedding occurs within much sparser RKP graphs. Moreover, we assume the wireless sensor network
is dense, and a RKP subgraph is always sparse.
10
Thus,
|V0| ≤ 2εn+ 2
⌊
k
2
⌋
(dεse+ 1)
≤ 2εn+ k(dεse+ 1) + s
≤ 2εn+ k(εs+ 2) + s
6 3εn+ k + s
6 3εn+K(ε). (13)
Thus, choose η
3
n > 3εn+K(ε), and apply the Blow-Up lemma [36] with d = d/2, ∆ = 2, H = P `, then
there exist εb such that for every ε ≤ εb, and every cluster ⊂
(
R
`
)
contains a P `-packing. Clearly, P ` is
embedded in R(n). So, given d − 2ε ≥ d/2, there is an ε′ such that G, being the (ε′, d/2)-superregular
approximation of R(n).
The constants is choose as follows,
d <
2η
3
, ε = min
{
10
η
,
d
4
, εb(d/2, 2)
}
, n0 >
6K(ε)
ε
. (14)
Remark 8. To see how to match the ’entire’ graph for guarantee perfect matching, see detail in [33]. The
εb is from Blow-Up lemma and depend on structure of the embedding subgraph H [37].
So far, we have already proved that G contains a P `-packing covering almost all of vertices. In next
section, we ask the which RKP probability p will guarantee that there is a security path between any two
nodes with diameter smaller than `.
IV. RKP SUBGRAPH OF ε-REGULAR GRAPH
Here we give a short describe about the RKP subgraphs of sensor networks. We can take a RKP
process as a random subgraph from wireless sensor networkWSN . Hereditary properties is the matter of
concern, since the ’good’ behavior of this random subgraph be generally inherited from a rich structural
graph, ε-regular graph WSN (r). In below section, we will show that RKP subgraph has some hereditary
structure, and then one can use it to apply the sparse regularity lemma. We first show that a RKP subgraph
is (α,C)-bounded w.h.p., thus it admits an (ε, p)-regular partition.
A. Threshold functions for almost nodes
Let P is family of all secure path with length `. In the last section, one can see that the reduced graph
R carries a lot of the structural information of the given graph G, and therefore enables us to deduce
some useful information directly on the number NH(G) of labeled copies of a fixed graph P ` ∈ P(`) in
a large graph G. Now let us first define three Type of paths in P . First, a path in Type I is those secure
paths for which the distance of source and destination is `-hop. Secondly, a path in Type II for which
the distance of source and destination is 1, i.e, one-hop neighbour with a security path ` (see example in
[5]). Then, the remainder paths is contained in the third set.
In lemma 9 and lemma 11 we shall show that the threshold of Type I and Type II is the same (though
with different constant), and subsequently, we argue that the third is similar, since it must ’sandwiched’
between Type I and Type II .
We start by giving the threshold of the first type. Because the property of structure of a graph in
WSN (r) is stronger than the property of random part, the order in which the neighbours and intersections
of neighbours are considered is crucial because dependencies would complicated through the proof strategy.
Hence, to prove the 1-statement, instead of bounding the variance of the events, we shall show that the
RKP random subgraph of an ε-regular graph admits sparse regularity (ε′, p)-regular with high probability.
12
and let ε0 and C be given by Theorem 6 applied with β, and ε′. Then fix ε = min{d/2, ε′/4, ε0}.
Suppose V1, V2, ..., V` are `-partite partition graph from F(P `, n, T, ε′, δ). We shall show that a RKP
subgraph of F that is unlikely to appear in SWSN (r). Since the bipartite subgraph SG(Vi, Vj) contain
at least (d − ε)pn2 edges each. By the definition of F , there is a set W ⊂ V1 with |W | ≤ δn such that
|Γ1(Γ2(...Γ`−1)| ≤ (1− δ)n. Then Theorem 6 infer that there are at most
βT
(
n2
T
)
possibilities for choosing all such subgraph. Now the number of all possible subgraphs in WSN (r) are
at most
|WSN (r)| ≤
∑
T≥(d−ε)pn2
(
N
n
)`+1(
(d− ε)n2
T
)`
.
Hence, the probability that the random subgraph SG ∈ F is bounded from above by∑
T≥(d−ε)pn2
(
N
n
)`+1(
(d− ε)n2
T
)`
× βT
(
n2
T
)`
p2T`
≤
∑
T≥(d−ε)pn2
(
eN
n
)(`+1)n(
e(d− ε)n2p
T
)2T`(
β1/`
e
d− ε
)T`
≤ n2`
(
eN
n
)(`+1)n(
e1/d
(
e
d− ε
)1/2
β1/2`
)2dpn2`
≤ exp(2` log n+ `n logN − 4`n−1−1/`)
→ o(1), (19)
since the choice of β and logN  kn−1/` as N →∞.
The prove of the 1-statement is complete since Claim 10 implies with probability 1 − o(1) that
S(G(r)) admit a sparse (ε′, p)-regular partition, and therefore has the expected copies of P `, provided
with appropriate choice of β, ε and large enough N .
We now prove Claim 10 (see [39]) .
Proof: (of claim 10) Let G(r)p ∈ SWSN (r) and let two non-disjoint sets U,W ⊆ V (G(r)p ) with
|U |, |W | ≥ αn. First, e(U,W ) is a binomial random variable with
E[e(U,W )] = p(d− ε)
(
|U ||W | −
(|U ∩W |+ 1
2
))
. (20)
Clearly, E[e(U,W )] n, since pd 1/n.
P (e(U,W ) > CE[e(U,W )]) 6 exp(−τCE[e(U,W )]) (21)
Summing all possible choices of U,W gives us
P(G is not(α,C)-upper-uniform)
≤
∑
|U |>ηn
∑
|W |>ηn
(
n
|U |
)(
n
|W |
)
exp(−τCE[e(U,W )])
≤ 2n2nexp(−τp(d− ε)n2) = o(1). (22)
, where τ is a carefully choice constant.
14
where i ∼ j if i 6= j, and ith and jth `-hop path have τ common edges. Hence,
∆ ≤ 1
2
`−2∑
τ=1
(
`
τ
)
(`+ τ − 1)!
(Dλ(S)`+τ−1)∑
i=1
p2`−τε
≤ C
2
`−2∑
τ=1
(
e`
τ
Dλ(S)p
−1
ε
)τ
(Dλ(S))` · p2`ε
≤ C
′(`− 2)
2
(
e`
(`− 2)Dλ(S)
)`+1
· p2`−1ε
≤ C ′′(`) ·Dλ(S)`+1p2`−1ε ,
where (n)k = n(n− 1)(n− 2)...(n− k).
If we choose p Dλ(S)−(`−1)/(`), then
P (X = 0)≤ (1− p`ε)(
Dλ(S)
`−1 ) · e ∆2(1−%)
≤ (1− (1 + (`ε)/2)p`)(Dλ(S)`−1 ) · e ∆2(1−%)
≤ exp
(
−(1 + (`ε)/2)Dλ(S)
`−1p`(1− C ′′(1 + (`− 1)ε) ·Dλ(S)2p`−1)
2(1− p`ε)
)
≤ exp
(
−Dλ(S)
`−1p`(1− o(1))
2(1− p`ε)
)
→ o(1). (26)
Next, if we assume that pε = (c+o(1))Dλ(S)−(`−1)/(`), while it is not hard to see that P (X = 0) ∼ e−c
` ,
since the upper and lower bounds of Janson’s inequality yield the same exponential bound.
Now we consider the edges inside Vi. The prove is similar in [40]. Suppose that there are many triangles
occur between two partition V1, V2, then it will contribute large in ∆. We need show that the probability
that this occur is very small. Let X denote the number of triangles in (V1, V2). Then, choose ε ≤ γ/2
and m ∼ T/`
E[X] ≥ 1
2
ein (1− 2ε) (1− γ)np2 ≥ 1− ε
2
ein · m
2
n3
and
∆in ≤
∑
v∈V1
(
degV1(v)
2
)
|V2| · p3
≤ 1
2
min{e2in, einδin} · n · p3
≤ 1
2
(1− ε)(1− 2γ)min{ein, δinp}m
3
n5
≤ 1
2
(1− 2ε)min{ein, δinp}m
3
n5
(27)
(Note that (1− ε
2
)m
n2
≤ p ≤ (1− 3ε
8
)m
n2
.) Recall that m n2−(`−1)/` log n.
Observe that ∆ ≥ E[X], hence, E[X]2/(2∆) is bounded by C · (1 − ε)ein log n ≥ Cein log n, where
C is a constant. Since, there at most 2εpn2 edges inside V1, thus the triangles can make negligible by
choosing ε sufficiently large with respect to p.
16
we let minimum degree δ(S(G)) = (1/4 + η)np, thus there are at most ζ = ((1/4 + η)p)−1 connected
components, Ci, ..., Ck, in S(G).
P(S(G) is disconnected) ≤
(
ζ
2
)
P(Ci = Cj)
≤ (1/4 + η)−2
(
log n
2
)(dn2−(δSn)2−5εn2
T
)(
dn2
T
) (since p 1/ log n)
≤ (1/4 + η)−2(log n)24−((δSn)2+5εn2)
(
dn2
T
)(
dn2
T
)
≤ C exp(−O(T )) (since ε 1/n) (30)
the last inequality due to pn2  n log n and we can choose η such that (δSn)2 is linear with T . Roughly
speaking, since SG is connected, the argument of [41] asserts that nε is sufficiently enough for the average
subgraph degree . We thus complete this prove.
Remark 13. If one replace nr2 →∞ condition by a weaker one nr2(`−1)  (log n)4, it seems still provide
sufficiently dense to prove Lemma 9 and Lemma 11.
V. CONCLUSION AND FUTURE WORK
In this paper, the idea of approximating a random geometric graph by an ε-regularity graph is presented
in Section II-B. By applying the Szemere´di lemma, one can deduce that the any graph can be approximated
by a random-like graph with a tolerance ε, and this makes analysis of the subgraph count of the random
geometric networks simpler. The regularity lemma has an advantage in terms of decomposition of the
underlying graph into such pseudorandom ε-regular structures. Obviously, such a decomposition can be
extremely helpful for proving results on the structure of a graph. Hence standard arguments often suffice
to find certain structures first in the ε-regular pairs or reduce graph and then show the existence of the
subgraph in the original graph.
Section III-C is intended to give an investigation for ensuring with vertex-disjoint copy of secure paths
in a dense wireless sensor networks. Informally speaking, Lemma 7 can be seen as a simpler version of the
classical Edo¨rs-Stone theorem. In Lemma 11, we show that certain ’bad’ structures of the RKP subgraphs
to be counted occur very rarely, provide that the constants are choose appropriately. In Theorem 12, we
also generates results concerning the threshold function of, for any given 0 < ε < 1 and 3 ≥ ` ≤ log n, a
sparse random subgraphs that satisfy EPV, i.e., every pair of vertices of a RKP subgraph lies in a security
path with length `. More precisely, given a RKP threshold probability p0 = n(`−1)/(`)+o(1), if whenever
p = p(n) p0 then sensor network does not satisfy EPV almost always, and whenever p p0 then the
network satisfy EPV almost always. Notably, one can not replace pn(`−1)/(`) → ∞ by pn(`−1)/(`) ≥ C
for a constant C. Further, to be able understand why the o(1) term can not be omitted completely. For
instance, log n/n is the threshold for ` = 1 although p0 = n−1. More precisely, consider the threshold
functions for connectivity, we can first partition the graph G by the regularity lemma, then one can easily
obtain that there exist a C such that for every p ≥ Cn−1 there is no isolated vertex in each bipartite
subcluster with high probability. In this case, the o(1) term is log n. Generally, if G is a random graph,
the o(1) term for subgraph H = K`, i.e., `-vertices cliques, is (log n)1/` [7].
Furthermore, our results can be extended to other RKP-based schemes for which require rather specific
structures such as group-key [42] or disjoint path-key [43] to achieve security cooperation among nodes
(see [44] if the group is a clique ). In addition, it may be worth to mentioned that a RKP subgraph is
neither a purely random geometric graph nor a random graph. In fact, the RKP subgraph can be seen
as a random geometric graph where each edge is kept by the security probability p independently, or as
18
[25] J. Polcyn and A. Rucin´ski, “Short paths in ε-regular pairs and small diameter decompositions of dense graphs,” Discrete Mathematics,
pp. 80–109, 2008.
[26] N. Alon, E. Fischer, M. Krivelevich, and M. Szegedy, “Efficient testing of large graphs,” Combinatorica, vol. 20(4), 2000.
[27] N. Alon, E. Fischer, I. Newman, and A. Shapira, “A combinatorial characterization of the testable graph properties: it’s all about
regularity,” Proc. of STOC.
[28] C. Borgs, J. Chayes, L. Lova´sz, V. T. So´s, B. Szegedy, and K. Vesztergombi, “Graph limits and parameter testing,” Proc. of STOC.
[29] V. Ro¨dl and M. Schacht, “Property testing in hypergraphs and the removal lemma,” Proc. of STOC, pp. 488–495, 2007.
[30] G. Blelloch, V. Vassilevska, , and R. Williams, “A new combinatorial approach for sparse graph problems,” Proc. of ICALP, vol. 1,
pp. 108–120, 2008.
[31] A. Hajnal, W. Maass, and G. Tura´n., “On the communication complexity of graph properties,” Proc. of STOC, vol. 1, pp. 186–191,
1988.
[32] Y. Kohayakawa and V. Ro¨dl, “Regular pairs in sparse random graphs I,” Recent Advances in Algorithmic Combinatorics (B. Reed and
C. Linhares-Sales, eds.), CMS Books Math./Ouvrages Math. SMC, Springer, New York, vol. 11, pp. 289–351, 2003.
[33] D. O. D. Ku¨hn, “Embedding large subgraphs into dense graphs,” Surveys in Combinatorics, Cambridge, pp. 137–167, 2009.
[34] Y. Kohayakawa, T. Luczak, and V. Ro¨dl, “On k4-free subgraphs of random graphs,” Combinatorica, vol. 17, pp. 173–213, 1997.
[35] S. Gerke, Y. Kohayakawa, V. Ro¨dl, and A. Steger, “Small subsets inherit sparse ε-regularity,” Journal of Combinatorial Theory, Series
B, vol. 97, pp. 34–56, 2007.
[36] J. Komlo´s and M. Simonovits, “Szemere´di’s regularity lemma and its applications in graph theory,” Combinatorics.
[37] R. Diestel, “Graph theory,” Springer-Verlag, Heidelberg, 2005.
[38] V. Ro¨dl and M. Schacht, “Regularity lemmas for graphs,” Preprints.
[39] Y. Kohayakawa, V. Ro¨dl, and M. Schacht, “The tura´n theorem for random graphs,” J. Algorithms, vol. 16(1), pp. 80–109, 1994.
[40] A. Steger, “On the evolution of triangle-free graphs,” Combinatorics, Probability, and Computing, vol. 14, pp. 211–224, 2005.
[41] A. Johansson, R. Johansson, and K. Markstro¨m, “Factors of r-partite graphs,” preprint.
[42] S. Rafaeli and D. Hutchison, “A survey of key management for secure group comunication,” ACM Computing Surveys, vol. 35(3), pp.
309–329, 2003.
[43] E. O. Blaß and M. Zitterbart, “An efficient key establishment scheme for secure aggregating sensor networks,” ACM Symposium on
Information, Computer and Communications Security, pp. 300–310, 2006.
[44] T. Schickinger, “Complete subgraphs of random graphs, ph.d. thesis,” Department of Computer Science, Techical University Munich,
Germany, 2002.
[45] Y. Kohayakawa and V. Ro¨dl, “Szemere´di’s regularity lemma and quasi-randomness,” Random Structures and Algorithms, vol. 22(4),
pp. 359–434, 2003.
Journal of Internet Technology Volume 13 (2012) No.4572
Another classical algorithm for reversible watermarking 
is histogram shifting [13-18], which was first proposed 
by Ni et al. [13]. That work first found the maximum 
point h(a) and the minimum zero point h(b) of the image 
histogram. Then, under the assumption that a < b, the pixels 
between h(a) and h(b) were shifted to the right by one unit. 
Finally, the watermark was embedded into the pixels whose 
gray value is a. In [16], Xuan proposed a scheme which 
reversibly embeds watermark bits into image prediction 
errors by using the histogram-pair method only when the 
magnitude of the prediction error is within the predefined 
embedding threshold and fluctuation threshold.
Many reversible watermarking schemes [17-27] that 
use prediction error expansion have been developed in 
recent years, because prediction error expansion exploits 
the correlation inherent in the neighborhood of a pixel 
better than the difference expansion scheme does. Thodi 
and Rodriguez [21] obtained the prediction errors by using 
JPEG-LS. The prediction errors were then embedded with 
watermark bits by using the histogram shifting scheme, 
which combines the prediction error expansion method 
with the variation of the histogram shifting method. 
Sachnev et al. [19] proposed several methods to improve 
the embedding performance, including the rhombus pattern 
prediction scheme, the double embedding scheme and 
the sorting procedure. In this paper, the performance of 
the proposed scheme is compared with that obtained by 
Sachnev. A detailed discussion of both our and Sachnev’s 
approaches will be made in later sections.
The rest of this paper is organized as follows. Section 
2 reviews the reversible watermarking method of Sachnev 
et al. Section 3 then elucidates the proposed reversible 
watermarking scheme. Next, Section 4 summarizes the 
simulation results with respect to performance of the 
watermarking scheme. Conclusions are finally drawn in 
Section 5.
2   Sachnev’s Watermarking Algorithm
Sachnev’s watermarking algorithm [19] first divides the 
original image into two sets, namely the “Cross” set Ic and 
the “Dot” set Id, based on the rhombus pattern. Each pixel 
in the Cross set and its four neighboring pixels that belong 
to the Dot set comprise the prediction pattern, as shown in 
Figure 1.
To embed one bit of watermark into the prediction 
pattern, the center pixel value Ii, j is predicted by computing 
its four neighboring pixel values as
  (1)
The prediction error di, j is then computed as
 di, j = Ii, j − pi, j. (2)
Based on the histogram shifting scheme of Thodi and 
Rodriguez [21], the modified prediction error d'i, j is obtained 
as
  (3)
where Tn and Tp are the negative threshold and positive 
threshold, respectively, and w is the watermarked bit value, 
w ∈ {0, 1}.
In Equation (3), the watermark is embedded into the 
prediction errors between Tn and Tp; the prediction errors 
outside the range of Tn to Tp are shifted and made bins for 
embedding watermark.
After the watermark is embedded, the original pixel 
value Ii, j is changed to I'i, j as
  (4)
During the encoding process, the Cross set is 
altered and the Dot set only is used for prediction; they 
are independent of each other. After the Cross set has 
been embedded with watermark bits, the Dot set can be 
embedded with watermark bits by using the watermarked 
Cross set to predict pixel values. Consecutive usage of the 
Cross embedding scheme and the Dot embedding scheme is 
referred to as the double embedding scheme.
During the decoding process, the sets of encoding 
sequence are reversed. That is, the Dot set is recovered 
first, followed by recovery of the Cross set. To restore the 
original image from the watermarked image, the modified 
prediction error d'i, j is calculated as
  (5)
The original prediction error is computed as
Figure 1 Prediction Pattern
04-Hsu.indd   572 2012/7/22   下午 02:58:49
Journal of Internet Technology Volume 13 (2012) No.4574
Based on the section checking order set m = {5, 6, 4, 7, 
3, 8, 2, 9, 1, 10, 0} and pi, j, a section s ∈ m can be found, 
which first satisfies Ic, s ≤ pi, j ≤ Ic, s + 1, as shown in Figure 4.
,i jp
, 1c sI +
,i jI
,c sI
Section s
[0,255]
Figure 4 pi, j is Located in Section s
According to the experimental  resul ts  of  the 
aforementioned procedure, for example Lena image, the 
probability in which the original pixel value Ii, j satisfies 
the condition Ic, s ≤ Ii, j ≤ Ic, s + 1 is 7.6%. Restated, most of 
the pixels are either in the condition Ii, j ≤ Ic, s or Ii, j > Ic, s + 1. 
Thus, if the pixels are in the former condition, Ic, s is taken; 
otherwise, Ic, s + 1 is taken as the final prediction value p'i, j, 
subsequently leading to a decrease of the prediction errors. 
Therefore, the final prediction value is obtained as
  (12)
According to the prediction as in Equation (12), the 
prediction error of pixels located in Ic, s < Ii, j ≤ Ic, s + 1 is 
similar to the one predicted by pi, j.
Based on the multiple prediction candidates and the 
predicting pixel value, the proposed prediction method is 
referred to herein as a multiple predictions-predicting pixel 
method.
3.2 Watermark Embedding Algorithm
In Equation (12), the final prediction value p'i, j is 
determined using the original pixel value Ii, j. Nevertheless, 
after the histogram shifting algorithm proposed by Thodi 
and Rodriguez [21] is applied to embed the watermark, the 
original pixel value Ii, j is changed to the watermarked pixel 
value I'i, j. Therefore, the watermarking algorithm must be 
modified to ensure that the same final prediction value p'i, 
j can be obtained with two different values Ii, j and I'i, j from 
Equation (12).
As mentioned in Section 3.1, the four sets are embedded 
with watermark bits sequentially, and they are independent 
of each other. Accordingly, the neighboring pixels of the 
embedding pixel Ii, j are the same as the neighboring pixels 
of the watermarked pixel I'i, j. Restated, both Ii, j and I'i, j have 
the same prediction value pi, j. Furthermore, since Ii, j and I'i, j 
must have the same final prediction value p'i, j from (12), 
the following condition must be satisfied: if Ii, j ≤ pi, j during 
the encoding process, then I'i, j ≤ pi, j during the decoding 
process; otherwise, if Ii, j > pi, j during the encoding process, 
then I'i, j > pi, j during the decoding process.
To satisfy the above condition, the prediction error di, j 
is defined as
(13)
(14)
Based on the prediction errors obtained from Equations 
(13) and (14), Figure 5 demonstrates the correspondence 
between the original pixel values and the prediction errors. 
For instance, let Ii, j = Ic, s; the prediction error is calculated 
from Equation (13); and the prediction error di, j = Ii, j - p'i, j 
= Ii, j - Ic, s = 0.
,c sI , 1c sI +,i jp
0 0-1 -111
, ,  [0, 255]i jI
,Prediction error, i jd
Figure 5 Correspondence between Ii, j and di, j
From Figure 5, we can easily infer that the prediction 
errors obtained by Equation (13), shown as a solid line, 
must be expanded or shifted to the left; in addition, the 
prediction errors obtained by Equation (14), shown as a 
dash line, must be expanded or shifted to the right. Then, 
the relationship between Ii, j and pi, j is consistent with that 
between I'i, j and pi, j.
Additionally, two peaks of the prediction error 
histogram obtained by Equations (13) and (14) are with 
di, j = 0. If the watermark is embedded into the prediction 
errors di, j > 0, then many prediction errors di, j ≤ 0 must 
be shifted as well, subsequently degrading the embedding 
performance. Therefore, only the prediction errors di, j ≤ 0 
and those between two thresholds [Ti, b, Ti, e], i ∈ {0, 1} are 
embedded with watermark bits, where “0” and “1” refer 
to the prediction errors obtained by Equations (13) and 
(14), respectively; in addition, Ti, b and Ti, e denote the start 
threshold and the stop threshold, respectively.
,0cI ,11cI,c kI , 1c kI +,1cI ,10cI
Section 0
Section 1
Section k
Section 10
Figure 3 Gray Value [0, 255] is Divided into Eleven Sections
04-Hsu.indd   574 2012/7/22   下午 02:58:50
Journal of Internet Technology Volume 13 (2012) No.4576
4   Experimental Results
Sachnev et al. [19] and Chen et al. [20] indicated that 
the prediction error histogram generally has a Laplacian 
distribution, and the performance of a watermarking 
algorithm depends on the variance of the distribution, i.e., 
the smaller variance, the higher watermarking performance.
Figure 8 shows the prediction error histograms of test 
image Lena obtained by using the algorithms of Xuan [16], 
Sachnev [19], and Thodi [21], as well as the proposed 
algorithm. This figure reveals that the number of prediction 
error d = 0 obtained by the proposed method is 30,829 
larger than that obtained by the algorithm of Sachnev; in 
addition, the histogram variances of the proposed method 
and the method of Sachnev are 14.0 and 25.1, respectively. 
A significant 44.2% improvement is obtained by using the 
proposed method rather than that of Sachnev.
-20 -15 -10 -5 0 5 10 15 20
0
1
2
3
4
5
6
7
x 104
Prediction error
Oc
cu
re
n
ce
 
 
Proposed method
Xuan's method [12]
Sachnev's method [15]
Thodi's method [17]
Figure 8 Histograms of the Prediction Error
Watermarking performance of the proposed method is 
evaluated using four 8-bit gray-level images of size 512 × 
512, as shown in Figure 9. The test watermark is a random 
binary string. The performance of the proposed method is 
compared with that of Sachnev et al. [19], since the latter 
is known as a utilization of novel techniques attempting to 
enhance the embedding performance. Besides, the work of 
Sachnev et al. indicated that their approach performs better 
than those of Kamstra and Heijmans [9], Lee et al. [10] and 
Thodi and Rodriguez [21-22]. Therefore, effectiveness of 
the proposed approach is demonstrated based on the results 
of using obtained by employing Sachnev’s method.
Figures 10 and 11 show the PSNRs of the four 
watermarked images, in which watermark payloads are 
0-0.04 bpp and 0.04-0.5 bpp, respectively. According to 
these figures, the proposed algorithm obviously performs 
better than that of Sachnev. For instance, for the Lena 
image, the mean PSNRs obtained by the proposed method 
are 1.47 dB and 1.1 dB higher than that obtained by 
Sachnev’s method when the watermark payloads are 0-0.04 
bpp and 0.04-0.5 bpp, respectively.
Figures 10 and 11 show the watermark capacities 
ranging from 0 to 0.5 bpp. However, the proposed method 
still performs excellently when the payload exceeds 0.5 
bpp. For instance, for the Lena image, the PSNR obtained 
by the proposed method is 0.17 dB lower than that obtained 
by Sachnev’s method when the watermark capacity is 0.8 
bpp. Still, the proposed method performs better than those 
of [9], [10], [21] and [22]. Overall, the proposed algorithm 
Extraction algorithm 
01 if , ,i j i jI p′ ≤
02    , ,i j c sp I′ =
03    , ,i j i j i jd I p′ ′ ′= − ,
d 2
)
,
04     if , ,i j o ed T′ ≤
05         if , 0, 0,2 1i j b ed T T′ ≥ − −
06             , , 0, 0,( ) / 2i j i j e ed d T T′ = − + 
07             , 0,( ) mo  i j ew d T′= −
08       else 
09             , , 0, 0,( 1i j i j b ed d T T′= − − −
10         endif 
11        , ,i j i j i jI p d′= +
12      else 
13      , ,i j i jI I ′=
14     endif 
15 else 
16     , ,i j c sp I +′ = 1
,
2
)
,
17 , ,( )i j i j i jd I p′ ′ ′= − −
18    if , 1,i j ed T′ ≤
19         if , 1, 1,2 1i j b ed T T′ ≥ − −
20               , , 1, 1,( ) / 2i j i j e ed d T T′ = − + 
21             , 1,( ) mod  i j ew d T′= −
22          else 
23                , , 1, 1,( 1i j i j b ed d T T′= − − −
24           endif 
25             , ,i j i j i jI p d′= −
26        else 
27             , ,i j i jI I ′=
28        endif 
29 endif 
Watermarked
image
Divide image 
into 4 sets
i=3
j = i mod 4
Choose set I j
Sort pixels 
according to 
local variances
 Extract watermark and 
recover image using  
proposed extraction 
algorithm 
Y
N i=i-1
Original
image
End of 
extracting
Location map
Predict pixel value 
using multiple 
predictions -predicting 
pixel method
Overhead information
Extract overhead 
information and 
location map
Two-pass 
testing [15]
Figure 7 Flowchart of watermark extraction.
04-Hsu.indd   576 2012/7/22   下午 02:58:51
Journal of Internet Technology Volume 13 (2012) No.4578
applies the original pixel value as a factor to derive the 
final prediction value, the variance of the prediction error 
histogram reduces greatly. Experimental results demonstrate 
the effectiveness of the proposed algorithm.
References
[1] Der-Chyuan Lou, Sheng-Chih Ho and Chung-Cheng 
Chiu, Hybrid High-Capacity Data Hiding by Pixel-
Value Differencing and Modulus Function, Journal of 
Internet Technology, Vol.12, No.2, 2011, pp.303-312.
[2] I-Ling Chung, Chang-Min Chou and Din-Chang 
Tseng, Multi-layer Reversible Data-Hiding Scheme 
on 3D Mesh Models, Journal of Internet Technology, 
Vol.11, No.5, 2010, pp.609-618.
[3] Nan-I Wu, Kuo-Chien Fu and Chung-Ming Wang, 
A Novel Data Hiding Method for Grayscale Images 
Based on Pixel-Value Differencing and Modulus 
Function, Journal of Internet Technology, Vol.11, 
No.7, 2010, pp.1071-1081.
[4] Wen-Chung Hsieh, Nan-I Wu and Chung-Ming 
Wang, A Novel Data Hiding Scheme for Binary 
Images with Low Distortion, Journal of Internet 
Technology, Vol.11, No.7, 2010, pp.1057-1070.
[5] Jun Tian, Reversible Data Embedding Using a 
Difference Expansion, IEEE Trans. Circuits Syst. 
Video Technol., Vol.13, No.8, 2003, pp.890-896.
[6] Jessica Fridrich, Miroslav Goljan and Rui Du, 
Lossless Data Embedding: New Paradigm in Digital 
Watermarking, EURASIP J. Appl. Signal Processing, 
Vol.2002, No.2, 2002, pp.185-196.
[7] Mehmet U. Celik, Gaurav Sharma, A. Murat Tekalp 
and Eli Saber, Reversible Data Hiding, Proc. Int. 
Conf. Image Processing, Rochester, NY, September, 
2002, pp.157-160.
[8] Adnan M. Alattar, Reversible Watermark Using 
the Difference Expansion of a Generalized Integer 
Transform, IEEE Trans. Image Process., Vol.13, 
No.8, 2004, pp.1147-1156.
[9] Lute Kamstra and Henk J.  A. M. Heijmans, 
Reversible Data Embedding into Images Using 
Wavelet Techniques and Sorting, IEEE Trans. Image 
Process., Vol.14, No.12, 2005, pp.2082-2090.
[10] Sunil Lee, Chang D. Yoo and Ton Kalker, Reversible 
Image Watermarking Based on Integer-to-Integer 
Wavelet Transform, IEEE Trans. Inform. Forensics 
Security, Vol.2, No.3, 2007, pp.321-330.
[11] Hyoung Joong Kim, Vasiliy Sachnev, Yun Qing 
Shi, Jeho Nam and Hyon-Gon Choo, A Novel 
Difference Expansion Transform for Reversible Data 
Embedding, IEEE Trans. Inform. Forensic Security, 
Vol.3, No.3, 2008, pp.456-465.
[12] Ching-Chiuan Lin and Nien-Lin Hsueh, A Lossless 
Data Hiding Scheme Based on Three-Pixel Block 
Differences, Pattern Recognition, Vol.41, No.4, 2008, 
pp.1415-1425.
[13] Zhicheng Ni, Yun-Qing Shi, Nirwan Ansari and Wei 
Su, Reversible Data Hiding, IEEE Trans. Circuits 
Systems for Video Technology, Vol.16, No.3, 2006, 
pp.354-362.
[14] JinHa Hwang, JongWeon Kim and JongUk Choi, 
A Reversible Watermarking Based on Histogram 
Shifting, Proc. IWDW 2006, Jeju Island, Korea, 
November, 2006, pp.348-361.
[15] Guorong Xuan, Qiuming Yao, Chengyun Yang, 
Jianjiong Gao, Peiqi Chai, Yun Q. Shi and Zhicheng 
Ni, Lossless Data Hiding Using Histogram Shifting 
Method Based on Integer Wavelets, Proc. IWDW 
2006, Jeju Island, Korea, November, 2006, pp.323-
332.
[16] Guorong Xuan, Yun Q. Shi, Jianzhong Teng, Xuefeng 
Tong and Peiqi Chai, Double-Threshold Reversible 
Data Hiding, Proc. ISCAS 2010, Paris, May, 2010, 
pp.1129-1132.
[17] Piyu Tsai, Yu-Chen Hu and Hsiu-Lien Yeh, Reversible 
Image Hiding Scheme Using Predictive Coding and 
Histogram Shifting, Signal Processing, Vol.89, No.6, 
2009, pp.1129-1143.
[18] Yongjian Hu, Heung-Kyu Lee and Jianwei Li, 
DE-Based Reversible Data Hiding with Improved 
Overflow Location Map, IEEE Trans. Circuits Syst. 
Video Technol., Vol.19, No.2, 2009, pp.250-260.
[19] Vasiliy Sachnev, Hyoung Joong Kim, Jeho Nam, 
Sundaram Suresh and Yun Qing Shi, Reversible 
Watermarking Algorithm Using Sorting and 
Prediction, IEEE Trans. Circuits Syst. Video Technol., 
Vol.19, No.7, 2009, pp.989-999.
[20] Ming Chen, Zhenyong Chen, Xiao Zeng and Zhang 
Xiong, Model Order Selection in Reversible Image 
Watermarking, IEEE Signal Processing, Vol.4, No.3, 
2010, pp.592-604.
[21] Diljith M. Thodi and Jeffrey J. Rodriguez, Expansion 
Embedding Techniques for Reversible Watermarking, 
IEEE Trans. Image Process., Vol.16, No.3, 2007, 
pp.721-730.
[22] Diljith M. Thodi and Jeffrey J. Rodriguez, Reversible 
Watermarking by Prediction-Error Expansion, Proc. 
IEEE Southwest Symp. Image Anal. Interpretation, 
Lake Tahoe, CA, March, 2004, pp.21-25.
[23] Cheng-Hsing Yang and Meng-Hsuan Tsai, Improving 
Histogram-Based Reversible Data Hiding by 
Interleaving Predictions, IET Image Process., Vol.4, 
No.4, 2010, pp.223-234.
04-Hsu.indd   578 2012/7/22   下午 02:58:52
Journal of Internet Technology Volume 13 (2012) No.4580
Tung-Shih Su received MS degree in 
Department of Computer Science from 
New York Institute of Technology, New 
York City, in 1991 and received PhD 
degree in Department of Computer 
Science and Engineering from National 
Sun Yat-sen University, Taiwan, in 
2010. Currently, he is an assistant professor at Department 
of Information Management of Fortune Institute of 
Technology, Taiwan. His research interests include mobile 
networks (Ad Hoc, Sensors, Mesh networks, MIPv6), 
image processing and network security.
04-Hsu.indd   580 2012/7/22   下午 02:58:53
 Abstract:  
This study proposes a dynamic program update scheme for wireless sensor networks. Using the 
chameleon hash function and the chameleon hash value with a secret key as the basic means for 
constructing an update program authentication procedure avoids time synchronization and limit the 
number of updates. The proposed scheme is not only capable of achieving secure authentication and 
preventing impersonation attacks, but also provides enhanced robust resistance to various attacks. 
Keywords: chameleon hash function, dynamic program update, orthogonality principle, wireless 
sensor networks 
 
1. INTRODUCTION 
Security is a significant issue for program update services in wireless sensor networks (WSNs). 
When programs are updated with over-the-air programming, wireless sensor nodes may face a large 
number of security threats,
 1
 secure protocols are therefore required. Several protocols 
2-5
 have been 
proposed for dynamically updating a program on sensor nodes using a combination of digital 
signatures and hash functions. However, they require a public key infrastructure (PKI) to manage 
highly complex computational problems. A sensor network is an energy-limited environment. In 2006, 
Lee et al. 
6
 proposed a two-phase broadcast mechanism based on a one-way hash chain with low 
computational complexity. In 2008, Das and Joshi 
7
 indicated that the mechanism used by Lee et al. 
suffers from security vulnerabilities. Das and Joshi then consequently applied the orthogonality 
principle to a sensor network to achieve improved security when updating programs. Later in 2009, 
Zeng et al. 
8
 indicated that the protocol used in the study by Das and Joshi was vulnerable when faced 
with impersonation attacks, and consequently improved the protocol. The study by Wang et al.
9
 
 broadcasts the following message to all the nodes for the thj  )1( kj   program update:  
 Tjverpidjverpidjjadv OXXMtjhXXMtjM ),,,,,(,,,,,)(  . 
The factor j  is the order of the message )( jadvM , where jt  is the time required to send the package, 
and  is the column vector randomly selected by the BS and ),,,,( verpidj XXMtjh  
is orthogonal to  .  
When a sensor node receives the message )( j
advM , it performs the following operations: 
• Step-1.Validate j  with the value previously stored. If j is less than or equal to this stored value, 
reject the message; else, proceed to the next step. 
• Step-2. Validate jt  with the local current time clock t . If the inequality ttt j   holds, 
reject the message; otherwise, proceed to the next step. t  denotes the time of the expected 
network delay. 
• Step-3.Calculate ),,,,( verpidj XXMtjh  and compare the result with the hashing value received 
in )( jadvM . If they are equal, proceed to the next step. Otherwise, reject the message. 
• Step-4. Check that  T
j
Tverpid
j OXXMtjh ),,,,(  is 0 , and proceed to the next step.  Otherwise, 
reject the message. 
• Step-5. From T
jO , randomly extract one nonzero row vector, which is denoted as jR . The nodes 
multiply
jR  by iC  which is stored before deployment. If the result is zero, proceed to the next 
step. Otherwise, reject the message. 
• Step-6. Check whether 
jR  is a linear combination of the vectors },..,{ 121 jRRR  stored in the node 
i . If yes, reject the message; otherwise accept the message, store the new value of j , and add 
jR  
to the vector set },..,{ 121 jRRR . Finally, update the program M . 
If an attacker is able to spy on, inject, delay, and intercept the broadcast message 
12-13
 before using 
the open value to forge the message sent to all sensor nodes. 
The attacker obtains the )1(
advM  
from communication channel and randomly extracts the row vector 
jR  
from T
jO  before generating a forged message 'M  and randomly choosing a parameter '  
that 
 This study depicts the proposed scheme as follows (the notations are listed in Table 2): 
Firstly, the BS randomly selects two values *
00 , pZm   calculates 0 with null M , and computes 
the chameleon hash function ),(0 mCH  as in (1). The BS sustains 000 m as the secret keys. The 
value of ),(0 mCH  is long with the hashing function, and installed in the sensor node before 
deployment in the field. 
 
pggmCH
m
mod),( 0000
   .    (1) 
Secondly, when the BS updates a program, says M , the BS chooses a random value *
pj Z , and 
calculates )| || |)(mod( jMpgh jj

  , where j  is a random nonce that is increased in each program 
update, then obtaining
 
jm from jjj mm   000 . 
The BS broadcasts the following message to all the sensor nodes: 
 pgjmMM jjjadv mod,,,)(  . 
When the sensor node i  receives the message )( j
advM , it performs the following operations: 
 
• Step-1: Validate j  in )( j
advM  
with the stored previous value. Reject the message if j  is less than 
or equal to the stored value. Otherwise, proceed to the next step. 
• Step-2: Calculate )| || |)(mod( jMpgh jj

  . 
• Step-3: Calculate   pggmCH jjjmj mod),(

   and, along with the hash function, obtain  ),( mCHh j . 
• Step-4: Check whether the conditions that  ),( mCHh j  equal to the value  ),(0 mCHh , stored in 
the node are satisfied. If holds and updated as a new program, and replaces the value of j .
 
Otherwise, the message is rejected. 
 
4. The Security and Performance Analysis of Proposed scheme 
This section analyzes the performance of the proposed scheme with computational overheads and 
 and j  . When the sensor nodes receive a message, and verifies the received message and checks 
that    ),(),(
0
 mCHhmCHh j .  ),(0 mCHh  is the only stored value in the sensor nodes.  
When an attacker eavesdrops on the communication channel, he can got jg

and calculate 
the )||||)(mod( jMpgh j
j

  , but he cannot retrieve the value of j  from 
jg

 , due to the discrete 
logarithm problem. The attacker can calculate ),( mCH j  with   pgg jjjm mod

 , but again, he cannot 
retrieve the value of  jjjm   from ),( mCH j , owing to the discrete logarithm problem. Therefore, 
he cannot generate a forged message 'M  with corresponding parameters 'jm  and 'j  is equal 
to ),( mCH j  under which jjjjjj mm   ''' or 000'''   mm jjj . 000 m is considered 
as the secret value known only to the BS.  
The proposed dynamic program update scheme can resist impersonation, forgery, and replay attacks. 
The attacks are described below: 
 
4.2.1 Impersonation attacks 
An adversary executing an impersonation attack using the broadcasting message values and certain 
modified values is unfeasible. If an adversary obtains the values of the communication channel and 
tries to impersonate the base station to install their preferred program without jm  ,,, 000 , they 
cannot produce legitimate authentication messages since the corresponding parameter m  is 
computed by solving the equation 
jjjmm   000 . In addition, if the attacker wants to get 
000
m , he must know the value of j ，but it is computational unfeasible to find j  from 
jg

   
based on the discrete logarithm problem and the secret values.  
 
4.2.2 Forgery attacks 
When an attacker espies the communication channel, they can achieve  pgjmM jj mod,,,   and 
calculate )| || |)(mod( jMpgh jj

  . However, they cannot retrieve the value of 
j , due to the discrete 
 The study by Wang et al. indicates that the scheme by Zeng et al. has the decoding secret key 
problems; if an attacker compromises considerable nodes that can generate legitimate secret keys. 
However, the proposed scheme does not have this problem because each node has 
only one chameleon hashing value for message authentication. The secret keys )( 000 m  cannot 
retrieved form ),( mCHi or )),(( 0 mCHh . 
4.3.3 Limited no updating number  
The scheme by Zeng et al. has limitations on the number of updates which is limited by the 
dimension of 1v .The proposed scheme does not have a limit on the number of updates, and can 
update programs any time. 
 
5. Conclusions 
This study proposed a new scheme based on chameleon hashing to defend against impersonation 
attacks. The chameleon hashing value is used for message authentication. Compared to the scheme 
used by Zeng et al., the proposed scheme is more secure and more robust for dynamic program 
updating in WSNs. 
 
References and Notes 
1. J. W. Hui and D. E. Culler, in Proc. Int. Conf. Embedded Networked Sensor Systems, ACM Press, 
pp. 81–94 (2004). 
2. P. K. Dutta, J. W. Hui, D. C. Chu, and D. E. Culler, in Proc. Int. Conf. Information Processing in 
Sensor Networks, ACM Press, pp. 326–333 (2006). 
3. P. E. Lanigan, R. Gandhi, and P. Narasimhan, in Proc. Int. Conf. Distributed Computing Systems 
 Figures and Tables 
Table 1. NOTATIONS. 
Table 2. NOTATIONS. 
 
 Author(s): Cheng-Yeh Chen, Wen-Shyong Hsieh, Wei-Shuo Li, John Y. Chiang 
Title: A novel Dynamic Program Update Protocol for Wireless Sensor Networks using Chameleon 
Hash Function 
Table 2. NOTATIONS. 
notation 
desription 
M  program/ fragment(includes pidX and verX ). 
j
  Random value *pj Z  is choosing by BS. p is a prime number, 
*
p
Z         
is the finite field of mod p . q is generator of *pZ . 
j
  )||||)(mod( jMpgh j
j

  , *pj Z . M is null when 0j . 
jm  0m  is a random value 
*
0 p
Zm  and jm is taken to satisfy 
)(
000
  mm jjj . 
),( mCH
j  Chameleon hash function pggmCH
jjjm
j
mod),(

   
 
 
of the traditional wireless networks cannot be directly applied to WSN because
wireless sensor networks are different from traditional wireless networks in many
respects such as limitation in power, computational capacity, memory, and stor-
age Akyildiz et al. (2002). In order to evaluate the performance of WSN, Tilak
et al. Tilak et al. (2002) presented several metrics to measure its performance,
including energy-efficiency (system lifetime), latency, accuracy, fault-tolerance,
and scalability. Moreover, to help differentiate the research topics of WSN,
some studies Akyildiz et al. (2002) classify WSN based on layers, including the
physical layer, data link layer, network layer, transport layer, and application
layer.
Recently, security of wireless sensor networks has become more and more
important not only because the sensor nodes will be deployed in hostile en-
vironment on military defense applications but also because the information
transmitted on such a network may be very sensitive. Of course, many attacks
have been developed for wireless sensor networks Du and Xiao (2008). To resist
these attacks, several research topics have been discussed such as cryptogra-
phy, secure routing, and intrusion detection Akkaya and Younis (2005); Wang
et al. (2006); Du and Xiao (2008); Chen et al. (2009). Among these research
topics, cryptography is one of the most basic encryption method for security,
which can be divided into the symmetric key cryptography and asymmetric key
cryptography (public key cryptography).
Because of the power consumption issue of sensor device, the symmetric key
cryptography is preferred for the WSN Huang et al. (2004). But this approach
faces the storage problem because the number of sensor nodes is generally very
large. Also, it is generally not suitable to store the key information in a sensor
device. On the other hand, asymmetric key cryptography is infeasible for WSN
because it requires more computation than symmetric key cryptography. To
overcome the storage problem, the na¨ıve solution uses a common key between
every pair of sensor nodes. The problem with this approach is that compromise
of a node will eventually compromise the whole sensor networks. According to
the observation of Chen et al. (2009), even though symmetric key cryptography
faces the storage problem, it is superior to asymmetric key cryptography (public
key cryptography) in terms of the speed and energy cost. For these reasons, key
management has become the core mechanism for the security of WSN, especially
for the symmetric cryptography. More recently, the random key pre-distribution
(RKP) scheme is used to reduce the compromise region to further solve the
problem of each sensor node being compromised.
This paper is aimed at establishing a threshold function for various multi-
path key properties. For a quasi-random regular graph G(n, p), for instance, we
estimate a critical edge probability p0(n) such that the limiting probability that
every pair of nodes contains certain secure paths depends on the asymptotic
ratio p  p0. The thresholds have been established for many random key
pre-distribution based network properties, such as connectivity, covering, and
multi-path keying. However, such precise results for multi-path properties seem
out of hand, when a general technique for settling these questions was introduced
in Li and Hsieh (2009). In this paper, we use a tool that enables us to crack this
nut. It is a regularity lemma for a certain class of graphs, whose edges consist
of link of a fixed underlying dense wireless sensor networks.
The remainder of the paper is organized as follows. Section 2 gives a brief in-
troduction to key management and random key pre-distribution based schemes.
2
..
.
.
.
.
key pool
key chain 1
key chain 2
key chain n
(a) Initialization.
key 1
key 2
key chain 1
node 1
node 2
node 3
key chain 2
key chain 3
(b) Key set-up.
node 1
node 2
node 3
node 4
node 5
node 6
node 7
(c) Path key establishment.
Figure 1: A simple example illustrating how the EG scheme works.
In what follows, we present our previous work Li et al. (2009), a three-hop
key path establishment procedure.
s ⇒ a : Esa[ < s > | < d > | < b > | < ksd > ].
a : Decryption.
a ⇒ s : < d > | < b > || Eab[ < s > | < d > | < b > | < ksd > ].
s ⇒ d : < b > || Eab[ < s > | < d > | < b > | < ksd > ].
d ⇒ b : Eab[ < s > | < d > | < b > | < ksd > ].
b : Decryption.
b ⇒ d : Ebd[ < s > | < d > | < b > | < ksd > ].
d : Decryption.
where Exy denotes encryption by the common key of x and y. Subsequently,
s and d, using session key ksd, perform the security communication. Indeed,
4
The RKP wireless sensor networks is constructed, by first deploying n nodes
randomly and uniformly in the unit square [ 0, 1]2 with a communication radius
r and then making each edge secure with probability p. Thus, the resulting RKP
network can be taken as a random subgraph of WSN. The classic random key
pre-distribution to accomplish this is due to Eschenauer and Gligor Eschenauer
and Gligor (2002). Most of the subsequent literature model the uniform random
intersection graph as a classical random graph G(n, p); however, modeling in
this way is unsatisfactory since the behavior of RKP in a network is sometimes
radically different to G(n, p). For random graphs, the probability that a copy
of length ` (secure) path occurs is p`. Unfortunately, the random geometric
graph is not the case any more, since in random geometric graph, the triangle
property is often more realistic than independence of edges in random graphs.
That is, the triangle inequality implies that the event that the nodes vx and vz
are `-hop neighbors is not independent of the event {(vx, vy) and (vy, vz) are
`-hop neighbors}. Thus, the analysis of RGG is more technically challenging
because of the dependence of the edges. To see the other difficulty, the desired
graph model must exploit the fact that we expect many more triangles in RKP
subgraphs than in G(n, p), especially when k is small. On the other hand, the
right way to model an RKP subgraph is using random intersection graph theory.
One of the fundamental tools in probabilistic graph theory is the well-known
regularity lemma of Szemere´di Szemere´di (1978). Indeed, since its discovery in
the 1970s, the Szemere´di’s Regularity Lemma has been one of the most remark-
able results in modern graph theory Szemere´di (1978), having a wide variety
of uses and applications. In computer science, such regularity notions have
been used extensively in approximation algorithms Bansal and Williams (2009);
Frieze and Kannan (1996, 1999); Coja-Oghlan et al. (2009), distributed comput-
ing Linial and Saks (1993); Polcyna and Rucin´ski (2008), property testing Alon
et al. (2000, 2006); Borgs et al. (2006); Ro¨dl and Schacht (2007); Blelloch et al.
(2008) and communication complexity Hajnal et al. (1988). Therefore, there
has been a growing interest in studying the properties of such graphs. The
following is the introduction of the regularity lemma Kohayakawa and Ro¨dl
(2003). This lemma has been instrumental in the study of the structure of large
graphs. In essence, the regularity lemma tells us that any large graph may
be decomposed into a bounded number of quasi-random multi-partite graphs.
Thus, this lemma is a powerful tool for detecting and making transparent the
random-like behavior of large deterministic graphs. It reveals a powerful quasi-
random structure that enables one to carry out a deep quantitative analysis.
These quasi-random multi-partite graphs that Szemere´di’s lemma uses in its
decomposition are graphs where the edges are uniformly distributed.
Let e(U,W ) be the number of edges between U and W where U,W ∈ V are
two disjoint subsets. Furthermore,
dp(U,W ) =
eG(U,W )
p|U ||W | . (1)
We say that the pair (U,W ) is (ε, p)-regular, if for all U ′ ⊂ U and W ′ ⊂ W
with |U ′| ≥ ε|U | and |W ′| ≥ ε|W |, we have
|dp(U ′,W ′)− dp(U,W )| ≤ ε.
Definition 2. ((ξ, C)-bounded). For ξ > 0 and C > 1, we say that G(V,E)
is a (ξ, C)-bounded graph with respect to density p, if for all U , W ⊂ V , not
6
Let
∆ =
∑
A,B
E(IAIB),
where the sum over all ordered pairs (A,B) with A 6= B but EA ∩B 6= ∅. The
following inequality holds Janson et al. (2000).
Definition 6. (Janson’s inequality). Under the above assumptions, and let
ε = supP (Bi),
∏
i
P(A¯i) ≤ P
(⋂
i
Ai
)
≤ exp
(
1
2(1− ε)
)∏
i
P(A¯i).
Now, let us turn to the proof of Theorem 2. Let G and Gp denote the
original graph and the RKP subgraph, respectively. Denote by Gbad a family of
all possible bad graphs that belong to B. It is easy to see that Gp ∈ Gbad is an
increasing event; thus, one can expect that some thresholds exist.
Theorem 2. Let p0 = (n)−(`−1)/`, then
P
(
Gp ∈ Gbad
)→ {0 if p p0
1 if p p0
To prove Theorem 2, we need the following two lemmas.
Lemma 1. For all d, ε < 1 and a given p, there exists an ε′ > ε such that
Gp ∈ G(`, n, p, ε′).
Lemma 2. Let p0 = (dn)−(`−1)/`, for all u, v ∈ G(`, n, d, ε)
P (X > 0)→

0 if p p0
1 if p p0
1− e−c` if p = (c+ o(1))p0
where
X =
((d±ε)`−1 )∑
j=1
Ij ,
and Ij=1[ jth (`− 1)-hop key path between (u, v)],
Proof. (of the Theorem 2) Suppose that dn2 = O(n2). Now,
P(Gp ∈ Gbad) = P
(
Gp ∈ Gbad ∩Gp is (ε′, p)-reg
)
+ P
(
Gp ∈ Gbad ∩Gp is not (ε′, p)-reg
)
≤ P (Gp ∈ Gbad ∩Gp is (ε′, p)-reg)
+ P
(
Gp is not (ε′, p)-reg | Gp ∈ Gbad
)
P(Gp ∈ Gbad)
≤ P (Gp ∈ Gbad ∩Gp is (ε′, p)-reg)+ o (P(Gp ∈ Gbad))
= P
(
Gp ∈ Gbad | Gp is (ε′, p)-reg
)
P (Gp is (ε′, p)-reg)
+ o
(
P(Gp ∈ Gbad)
)
8
Then, all the possible choices of U,W are∑
a
∑
b
(
n
a
)(
n
b
)
=
∑
a
(
n
a
)2
.
Hence, the probability of the existence of an (ε′, p)-regular partition is bounded
by ∑
a
(
n
a
)2
exp
(
−ε
′2
2
p
(
(d− ε)a
2
))
≤
∑
a
(
n
a
)2
exp
(
−ε
′2
2
(
(ε′3p− ε)a
2
))
≤
∑
a
(
n
a
)2
exp
(
−ε
′2
4
n2p3a2
)
≤
∑
a
exp a2
(
log n− ε
′2
8
n2p3
)
≤
∑
a
(
ε′
2n
)a
where the last inequality is due to the choice of C(ε′) being large enough. Thus,
the probability is at least 1− ε′/2.
Proof. (of the Lemma 2) Let S = b(u, r) ∪ b(v, r) denote the area on the union
of two neighboring vertices with communication radius r, and let Dλ(S) :=
λ(d±ε)n be the average number of vertices inside S. Note also that (d±ε)` ∼ d`
as ε → 0. Denote by ein the number of edges inside the sets Vi, and let each
vertex have at most δin neighbors in the same partition class. We now have
to choose a bipartite graph with T − pein between Vi and Vj . First consider a
random subgraph on Vi ∪ Vj with edges probability pε = (T + pein/k)/(n2) ∼
(1 + ε/2)p. Then, let Bi be the undesirable event that the ith three-hop path
is not selected between (u, v). Since probability P(B¯i) is p`, it follows that
1− P (⋂i∈I Bi) = 1− P(X = 0) means there exist at least one `-hop key path.
The number of expected (`− 1)-hop path is (Dλ(S)`−1 )(1− p`ε). Then,
(Dλ(S)`−2 )∏
i=1
P (Bi) = (1− p`ε)(
Dλ(S)
`−1 ). (4)
Now using the inequality 1− x ≥ e−x/(1−x) and Janson’s inequality, we imme-
diately obtain
P(X = 0) ≥ exp
(
−
(
Dλ(S)
`−1
)
p`ε
1− p`ε
)
. (5)
Observe that p ≤ (1 − 38ε)pε, and therefore P(X = 0) → 1 when pε =
o(Dλ(S)−(`−1)/`).
We give similar exponential upper bounds on P(X = 0). We have
∆ =
∑
i∼j
P
(
B¯i ∩ B¯j
)
(6)
10
5.2 Results
In the following, λ and Dλ denote the number of deployed nodes and the average
node degree, respectively. In practice, the number of nodes (a binomial process)
are fixed. It is well known that the binomial process can be approximated by
Poisson process. For instance, when we deploy 112 nodes in a network, as shown
in Fig. 3, we can obtain Dλ = λpir2 × 10−6 and set the constant c in Lemma 2
to be equal to p0/D
−2/3
λ .
λ Dλ c Estimated P(X > 0) Simulated P(X > 0)
p−1.0 53 4.55 0.60 0.45 0.31
p−1.1 61 5.29 0.67 0.48 0.32
p−1.2 71 6.15 0.74 0.51 0.34
p−1.3 83 7.16 0.82 0.56 0.38
p−1.4 96 8.33 0.90 0.62 0.42
p−1.5 112 9.69 1.00 0.69 0.47
p−1.6 130 11.28 1.11 0.77 0.51
p−1.7 152 13.12 1.22 0.85 0.57
p−1.8 176 15.26 1.35 0.92 0.63
p−1.9 205 17.76 1.50 0.97 0.69
p−2.0 239 20.66 1.66 0.99 0.75
Table 1: Simulation results of setting Dλ to the theoretical values.
λ True Dλ True c Estimated P(X > 0) Simulated P(X > 0)
p−1.0 53 2.59 0.41 0.39 0.31
p−1.1 61 3.02 0.46 0.40 0.32
p−1.2 71 3.44 0.50 0.41 0.34
p−1.3 83 4.04 0.56 0.43 0.38
p−1.4 96 4.69 0.62 0.45 0.42
p−1.5 112 5.51 0.69 0.48 0.47
p−1.6 130 6.44 0.76 0.52 0.51
p−1.7 152 7.47 0.84 0.58 0.57
p−1.8 176 8.68 0.93 0.64 0.63
p−1.9 205 10.11 1.03 0.71 0.69
p−2.0 239 11.79 1.14 0.80 0.75
Table 2: Simulation results of setting Dλ to the “true” values.
As shown in Tables 1 and 2, the estimation of the probability that there
exists a three-hop path is a little larger than the simulation result. The reason
is that the setting of λ in Lemma 2, i.e., the number of nodes, needs to be large
enough. Moreover, Table 2 shows that our estimation is sharp if we know the
true value of Dλ. The influence of the boundary effect may seem quite large;
thus, many points fall outside the window that can not be observed.
6 Conclusion
In this paper, we present and analyze a multi-path scheme that extends the
random key pre-distribution scheme. We also show that it can be applied to
12
Figure 5: Results of 130 nodes. When we increase the exponential by 0.1
(p−1.6), we can see that apart from some nodes with small degree, most nodes
have secure links to connect to their neighbors.
Figure 6: Results of 152 nodes. When we increase the exponential by 0.2 (p−1.7),
we can see that most nodes have secure links to their neighbors. However, there
still exist few isolated nodes due to the boundary effect.
tion power and energy resource of sensor nodes make it undesirable to use public
key algorithms. An important advantage of multi-path-scheme is in that it is
more efficient for critical link result from sparse node density and it seems easier
to extend for non-uniform/sparse deployment by enlarging the scope in Fig. 2.
If the network detects that it is disconnected, sensor nodes could also perform
multi-path scheme process to enhance the connectivity. Note that once the key
14
Chan, H., Perrig, A., and Song, D. (2003a). Random key predistribution schemes
for sensor networks. In Proceedings of the 2003 IEEE Symposium on Security
and Privacy, pages 197 – 213.
Chan, H., Perring, A., and Song, D. (2003b). Random key predistribution
schemes for sensor network. Proceedings of IEEE Symposium on Research in
Security and Privacy, pages 197–213.
Chen, X., Makki, K., Yen, K., and Pissinou, N. (2009). Sensor network security:
a survey. IEEE Communications Surveys & Tutorials, 11(2):52–73.
Coja-Oghlan, A., Cooper, C., and Frieze, A. (2009). An efficient sparse regular-
ity concept. In Proceedings of the twentieth Annual ACM-SIAM Symposium
on Discrete Algorithms, pages 207–216.
Du, W., Deng, J., Han, Y., Varshney, P., and Katz, J. (2005). A pairwise key
predistribution scheme for wireless sensor networks. ACM Transactions on
Information and System Security (TISSEC), 8(2).
Du, W., Deng, J., Han, Y. S., Chen, S., and Varshney, P. K. (2004). A key
management scheme for wireless sensor networks using deployment knowl-
edge. In Proceedings of the Twenty-third AnnualJoint Conference of the IEEE
Computer and Communications Societies (INFOCOM 2004), volume 1, pages
586–597.
Du, X. and Xiao, Y. (2008). A survey on sensor network security. In Li, Y., Thai,
M. T., and Wu, W., editors, Wireless Sensor Networks and Applications,
pages 403–421. Springer US.
Erdo¨s, P. and Re´nyi, A. (1960). On the evolution of random graphs. Publication
of the Mathematical Institute of the Hungarian Academy of Sciences, 5:17–61.
Eschenauer, L. and Gligor, V. D. (2002). A key-management scheme for dis-
tributed sensor networks. In Proceedings of the 9th ACM conference on Com-
puter and communications security, pages 41–47.
Frieze, A. and Kannan, R. (1996). The regularity lemma and approximation
schemes for dense problems. In Proceedings of the Annual IEEE Symposium
on Foundations of Computer Science, pages 12–20.
Frieze, A. and Kannan, R. (1999). Quick approximation to matrices and appli-
cations. Combinatorica, 19(2):175–220.
Gu, W., Bai, X., Chellappan, S., and Xuan, D. (2006). Network decoupling
for secure communications in wireless sensor networks. In Proceedings of 14th
IEEE International Workshop on Quality of Service (IWQoS), pages 189–198.
Hajnal, A., Maass, W., and Tura´n., G. (1988). On the communication com-
plexity of graph properties. In Proceedings of the thirty-eighth annual ACM
symposium on Theory of computing, volume 1, pages 186–191.
Huang, D., Mehta, M., Medhi, D., and Harn, L. (2004). Location-aware key
management scheme for wireless sensor networks. In Proceedings of the 2nd
ACM workshop on Security of ad hoc and sensor networks, pages 29–42.
16
Szemere´di, E. (1978). Regular partitions of graphs. In Proble`mes Combinatoire
et The`orie des Graphes (Colloq. Internat. CNRS, Univ. Orsay, Orsay, 1976)
(Paris), pages 399–401. Colloques Internationaux CNRS No. 260.
Tilak, S., Abu-Ghazaleh, N. B., and Heinzelman, W. (2002). A taxonomy of
wireless micro-sensor network models. ACM SIGMOBILE, Mobile Computing
and Communication Review, 6(2):28–36.
Wang, Y., Attebury, G., and Ramamurthy, B. (2006). A survey of security
numbers in wireless sensor networks. IEEE Communications Surveys and
Tutorials, 8(1-4):2–23.
Yick, J., Mukherjee, B., and Ghosal, D. (2008). Wireless sensor network survey.
Computer Networks, 52(12):2292–2330.
18
 Abstract: 
In order to protect against masquerade attacks and reduce communication overhead, we propose a 
new access control protocol that uses the chameleon hash function in the authentication procedure. 
Our method can achieve mutual authentication between any two nodes, and it allows a network to add 
a new node without recomputing a large number of keys. Furthermore, our analysis based on all 
possible attacks and the computation performance demonstrates its secureness and robustness on the 
wireless sensor networks. 
Keywords: sensor network, access control, authentication, chameleon hash function 
1. INTRODUCTION 
Wireless sensor networks (WSNs) represent a new computing system composed of a large number 
of highly resource-constrained sensor nodes. These nodes are often deployed in their operating 
environments, spread over wide geographic areas, and communicated with each other or base station 
via wireless channel 
1
. After a prolonged time period of operations, certain nodes in the network may 
exhaust their power due to the uneven distribution of traffic load. Therefore, the base station may be 
required to either add a new sensor node or update the existing authentication message for 
establishing the mutual authentication between nodes.   
In 2007, Zhou et al. 
2
 proposed an access control protocol based on an elliptic curve, which is more 
efficient than the RSA based schemes. However, their scheme assumes that each sensor node can 
sustain a tolerance time interval before it is compromised, and thus is inappropriate for real practical 
applications.   
In 2009, Huang et al. 
3
 proposed a new access control protocol based on the elliptic curve joined 
with the hash chain. Their scheme allows adding new nodes easily and is more efficient as compared 
 deﬁned as follows:   rYKKmfrmCH
HK
 ),(, . 
 
3. THE PROPOSED SCHEME 
This section presents the development of the new access control method using a chameleon hash 
function. The idea of the design of the proposed scheme was motivated by 
7-8
, and the proposed 
scheme comprises three phases: 1.Initialization phase, 2.Node authentication and key establishment 
and 3.New node injecting phase.  
3.1. Initialization phase 
The base station setup phase 
(1) Let )( tFE  be an elliptic curve over ﬁnite ﬁeld tF and t be a prime number. Let )(# tFE be the 
number of points of )( tFE , and P  be a point of )( tFE  with prime order q . 
Denote by G  is the subgroup generated by P . Deﬁne cryptographic secure hash function 
qq ZGZf :  , qZGh : . M is the message space, R is a random element of finite 
space .Choose three random elements *,, qR Zxk   and compute kPK  , xPY  , and computes the 
chameleon hash value YCH BS   and preloads in nodes. And computing the trapdoor/hash key pair 
( kPqkx ,mod1 ), and keeps ,, xk  as a secret key. 
(2)  Before deployment, the base station preloads following parameter into each nodes: a random 
number *qRi Z , all chameleon hash value N i iCH Y for all i , and an identity, iID , to node iN . 
(3) In the third step, the base station first selects a random number *qRi Zk   and computes the 
corresponding trapdoor/hash key pair 1( mod , )i ik x q k P for each node iN , where ik  as a secret 
key for iN . Finally, the base station subsequently sends 
1( mod , )i ik x q k P  to node iN and 
publishes YP,  as public information. Note that the value 1x  should be precomputed 
3.2 Authentication and key establishment phase 
 The above mentioned procedure is illustrated in Fig. 2. 
Only 1 modular multiplication of qZ  is required for qxkPkMfr iijii mod),(
1 . The value 
of 1xki  is preloaded in nodes. The proposed value ir  is used only once for signing a challenge 
message jM , while the other public key xPY   can be used repeatedly. 
3.3. New node injection phase 
When the time period of sensor networks operation is prolonged, if certain sensor nodes are lost or 
damaged, new sensor nodes must be added to the sensor networks. When a new node with the identity 
1iN  is added, the processes between 1iN  and the base station are as follows: 
(1) First, the base station chooses a random number *1 qRi Z and computing the chameleon 
hash value YCH iiN 11   . Prior to deploy to the field, the node 1iN  also preloads 
( Pkqxk iii 1
1
11
,mod, 

 ), BSCH  and 1iNCH  for 1....3,2,1  ni .  
(2) After node deployment, the base station computes qkxkPCHhfr
i
Ni mod)),((
1
1


  
 
and 
broadcasts the new information 
1iN
CH  and kPri ,1  to all existing nodes. When the existing 
node receives and computes YrkPkPCHhfCH iNBS
i
1
)),(('
1


, the node accepts the broadcast 
message only if 'BSBS CHCH  . The chameleon hash value list information in the existing nodes 
is subsequently updated. The proposed scheme can be implemented as a dynamic access control 
easily because the dated secret keys and broadcasting messages of the existing nodes do not 
require changes once a new node is added or an old node is damaged. 
 
4. PROPOSED SCHEME ANALYSIS 
4.1 Correctness 
We show that nodes iN  and jN  how to authenticate each other: \ 
 details. 
4.2.1 Legal node masquerading attack 
To authenticate node jN  as a legitimate node by confirming jNCH , only jN  and the base 
station know the secret keys, j and qxk j mod
1
. Only jN  can provide legitimate jr  to pass 
the authentication process. 
Even if an attacker could obtain the commutation values by eavesdropping on the 
communication channel between node iN  and node jN , and if that attacker obtained the 
information of PSki  and PSk j  from the authentication and key establishment phase, deriving 
the legalized session key PSkij  is extremely difficult, due to the ECDLP. Therefore, the 
proposed scheme can prevent a legal node masquerading attack. 
4.2.2 Forgery attack 
It is not feasible for an adversary to make a forgery message. Suppose that an adversary 
obtained the commutation values by eavesdropping on the communication channel, and then the 
adversary tried to make a legitimate authentication message from in .(3). 
             
)),'((),((' 1211
1
112 PkMfPkMfxkrr 

                     
(3) 
The value of '2r  cannot be computed without secret key
1xki . 
4.2.3 New node masquerading attack 
When certain sensor nodes are damaged or have exhausted power, new sensor nodes must be 
deployed. When a new node ID is 1iN , once the base station preloads the secret keys 
1
1

 xki , 
Pki 1 , BSCH , and generates PCH iiN 11    to be 1iN ’s chameleon hash value, the base station 
broadcasts the new information 
1iN
CH
 
to all existing nodes to update the verified table. In this 
scenario, an attacker is only required to forge broadcast message, which generates the message 
 This paper presents a new access control scheme for sensor networks based on the chameleon hash 
function. The proposed scheme is not only satisfies mutual nodes authentication and also adding new 
nodes securely to sensor networks. Moreover, it can also prevent malicious nodes against masquerade 
attacks. Furthermore, the proposed scheme analyzes all possible attacks and performances, 
demonstrating its secureness and robustness for wireless sensor networks. 
References and Notes 
1. I. F. Akyildiz, W. Su, Y. Sankarasuramaniam, and E. Cayirci, vol. 40, no. 8, 2002, pp. 102–114. 
2. Y. Zhou, Y. Zhang, Y. Fang, Ad Hoc Networks 5 (2007). pp. 3–13.  
3. H. F. Huang, Computer Standards & Interfaces 31 (2009). pp. 272–276.  
4. H. S. Kim, S. W. Lee, Vol. 55, No. 2, MAY 2009. pp. 492–498. 
5. Jian Shen, Sangman Moh, and Ilyong Chung , IEEE Transactions on Consumer Electronics, Vol. 
56, No. 3, August 2010. pp. 2019–2011. 
6. Peng Zeng, Kim-Kwang Raymond Choo, and Da-Zhi Sun, IEEE Transactions on Consumer 
Electronics, Vol. 56, No. 2, May 2010. pp. 566–569. 
7. Chen X, Zhang F, Susilo W, Mu Y. Applied Cryptography and Network Security-ACNS ’07, 
LNCS 4521; 2007. pp. 18–30. 
8. Lin, D.-R., 2010, Article in Press. pp. 12–19.  
9. V.  Miller, Lecture Notes in Computer Science, vol. 218, Springer-Verlag, 1986, pp. 417–426. 
10. N. Koblitz, 48, 1987, pp. 203–209. 
 Author(s): Cheng-Yeh Chen, Wen-Shyong Hsieh, Wei-Shuo Li, John Y. Chiang 
Title: A novel Secure Access Control Protocol for Secure Sensor Networks based on Chameleon Hash 
Function  
The node iN The base station 
chooses the elliptic curve 
q
E
generates  secret key *,,
qR
Zkx 
chameleon hash value YCH
BS

preloads
BSiiii
CHkPkqxk ,,,mod, 1
niYCH iN
i
,..,2,1, 
generates 
iqRi kZ ,
*
computes
Pkqxk
ii
,mod1
computes public key xPY 
YCH iiN 
YP,and
computes kPqkx ,mod1
 
Fig. 1. Initialization phase. 
 
 Author(s): Cheng-Yeh Chen, Wen-Shyong Hsieh, Wei-Shuo Li, John Y. Chiang 
Title: A novel Secure Access Control Protocol for Secure Sensor Networks based on Chameleon Hash 
Function  
Table 1. The computation of schemes. 
 Phase  
Base Station Node  
Initialization )13(3 mulmm TTenTe   n/a 
Authentication and 
key establishment 
n/a mulm TTef 132   
New node injection 
mulm
TTef 111   
m
Tef 21   
m
Te :time cost for one multiplication computation over an elliptic curve. 
f :time for cryptographic secure hash function. 
mul
T :time cost of performing the modulus multiplication operation. 
2large amount of storage. In other words, though a maximal
intersecting system, i.e., a system to which one cannot add
any non-repeated set without making it non-intersecting, could
have various structures, it also requires a large amount of
storage (k ∼ Ω(n)). In contrast, if k is too small, the resulting
intersecting family is likely to be trivial, i.e., all the k-sets
contain one fixed element, and therefore the resilience is low.
Thus, we investigate various ranges of k and p for a random
intersecting system. Note that by compromising a single node,
the entire network cannot loses all its security properties, since
the keys used to establish a secure link may consisted of many
keys.
In our node deployment model, there are three types of keys.
The first type is used for the in-group communication while
the second type is for the cross-group communication. We call
them the in-group and cross-group keys, respectively. Note that
these two sets of keys may be non-disjoint. The last type is
used for the group-wise key. For each secure communication,
each pair of nodes may use one (pairwise) key or some shared
keys (for example, using the Shamir threshold key agreement
or just adding them together to form a security key).
The remainder of the paper is organized as follows. Sec-
tion II gives a brief introduction to some intersecting proper-
ties. Section III discusses and defines the problem we aim to
solve in this paper. The notations and main results are also
given in this section. The conclusion and future works are
drawn in Section IV.
II. PRELIMINARIES AND NOTATIONS
A fundamental question in combinatorial theory deals with
a family of k-subsets of [n]. The famous example is the Erdo¨s-
Ko-Rado theorem [6], [7], [8].
Theorem 1. (EKR) Let k ≤ n/2 and let A ⊂ ([n]k ) be an
intersecting family. Then |A| ≤ (n−1k−1).
The classical Erdo¨rs-Ko-Rado (EKR) theorem states that if
we choose a family of subsets, each of size k, from a fixed
set of size n (n > 2k), then the largest possible pairwise
intersecting family has size t =
(
n−1
k−1
)
. A family of pairwise
intersecting k subsets is called an EKR family. Obviously,
the equality in EKR theorem is attained when all the k-sets
contain some {i}. It has been recognized that it is quite natural
to consider the edge connectivity problems by the minimum
pairwise requirement of EKR, i.e., the minimum k such that
the key system in wireless sensor networks (WSN) is an EKR
family.
In order to find a method to achieve both group and
pairwise-based secure communication, we propose an ex-
tended EKR property.
Definition 1. (EEKR) For u > 0, a family A of k-set has an
extended EKR (EEKR) if and only if each Ai ∈ A satisfies
1) (group-wise)
⋂
i∈I
Ai 6= ∅, and
2) (in-group) Ai
⋂
Aj
⋂
k A¯k 6= ∅, for all i 6= j with k ∈
I \ {i, j}.
The first condition is to guarantee that each node in a
group can communicate securely by group keys. The second
condition is an additional condition for each pair of nodes that
can establish a secure link by using different keys from their
group keys. Roughly speaking, each node contains k different
keys and provides a two-way secure communication with each
other: one for the group to which it belongs and some of the
rest for the other nodes. For example, assume that the group
contains three nodes, we desire a situation in which any two
of any three nodes can have a secure link with no fear of the
third party eavesdropping, and yet all the three nodes are able
to establish a secure communication if necessary. Any two of
the three nodes have a common friend who is a stranger to
the third while there also exists a node who is a mutual friend
of all the three.
III. RANDOM DESIGN METHOD
The following problem about an intersection family ob-
tained by a random choice of k-subsets of a n-element set
was studied in [9], [7], [1], [10],[11],[12],[13].
A. Cross-Group
In this section, we concern the random design method
[11],[12],[13] on cross-group key systems [6], [14]. Two
families A and B will be called cross-intersecting if each
member of A intersects every member of B. Suppose that there
are u groups in the network, and there is a need for nodes to
be able to communicate to nodes that belong to other groups.
Following result could be used to determine thresholds for
which any two cross-group nodes can communicate with each
other.
Consider a set of disjoint groups Γp = {Γ1+Γ2+ · · ·+Γu}
where each member of Γi is obtained by randomly and inde-
pendently choosing each k-subsets of the [n] with probability
p = t/(
(
u
2
)(
n
k
)
).
Theorem 2. For u > 0, let Q denote a family of all possible
collection of sets that are cross-intersecting family. Then, with
t0 =
√(
u
2
)(
n
k
)
/
(
n−k
k
)
,
P(Gp(k) ∈ Q)→
{
0 if t t0,
1 if t t0.
Following inequality will be used to prove this theorem.
Definition 2. (Janson’s inequality). Under the above assump-
tions, and let ε = supP (Bi), then∏
i
P(A¯i) ≤ P
(⋂
i
Ai
)
≤ exp
(
1
2(1− ε)
)∏
i
P(A¯i).
Proof: Let b1, b2, . . . , b(nk) be all the possible k-sets
and create a random collection A by selecting each k-set
bi independently with probability p. Thus, the number of
members in A is a binomial random variable with expectation
t. Our goal is to determine the probability that the chosen
member admits a cross-intersecting property. Let Bi be the
event that occurs if and only if the ith disjoint pair of k-sets is
selected. Thus, the probability P(Gp(k) ∈ Q) can be denoted
4Simple computation give
E(X) ≤ 4k
(
k(
t−1
j−1
))t−1(n
k
)
pt
→ o(1)
if p  n−k/tk−(t−1j−1)+1. Finally, this is proved by Markov’s
inequality and the fact that there are
(
u
2
)
cross groups.
Lemma 3. (Large k, non-trivial intersecting) Denote by ENT
be a collection of non-trivial intersecting family. If k = cnn1/2
and p (n−1k−1)−1n−m with m = ek2/(2n), then
P(Gp(k) ∈ ENT )→

0 if cn → 0
e−e
−c
if cn → c
1 if cn →∞
Proof: First note that when k is close to the threshold t0
in Theorem 2, the probability that each cross-group in Gp(k)
fail to form an intersecting family is at most(
m
2
)(n−k
k
)(
n
k
) ≤ u2
2
m2
2
exp
(
−r
2
n
)
≤ u
2
4
exp
(
− r
2
2n
)
Now, for any vertex v, we show that the probability of all k-
sets contain v is o(1), and therefore are an non-trivial family.
Let A ∈ ([n]k ) be the set of collection of ordered pairs
consisting v. For each Ai ∈ A, conditioning on Gp(k) is
intersecting, the probability of exist a vertex has degree m is
at most
n
((n−1
k−1
)
m
)
pm.
Then, by the union bound, our goal is make the following
expression vanish,
1
2
exp
(
− k
2
2n
)
+ n
((n−1
k−1
)
m
)
pm
≤ O
(
exp
(
− k
2
2n
))
+ n
(
n− 1
k − 1
)m
pm
≤ e−c
provide that p (n−1k−1)−1n−m with m = ek2/(2n).
Thus,
P(Gp(k) ∈ ENT )→ e−e−c
if cn → c.
Now assume that cn → 0, Theorem 2 states the the family
is not intersecting.
B. In-Group
Intuitively, one asks that for appropriately chosen values of
n and k, a small number of randomly chosen k-sets would
allow the EKR property to hold with high probability; but
even a slightly larger collection would cause the pairwise
intersection property to be ruined. However, this is not the
case in EEKR, since the conditions in EEKR are not both
increasing in some intervals.
Consider n by m arrays whose entries are letters from
an alphabet of size q, i.e., 0, 1, ..., q − 1. Fix an integer t,
1 < t ≤ n, then choose any set of t columns. A t-letter
word is made up of the entries (from left to right) across
any one row of the selected t columns. Recall that an array
is said to be t-covering if every set of t columns contains,
amongst its rows, each of the qt possible words of length t.
Let A ⊂ {0, 1, . . . , q − 1} be a partial t-covering array and
C(n, q, t, A, λ) be an m×n array satisfying the property that
for any choice of t rows, each of the q-ary t-tuples in the
ensemble A appears at least λ times among the rows of the
selected columns. In the case the size of Λ is 3, the m × n
incidence matrix is a partial C(n, 2, 3, A, 1) covering array
with A = (0, 1, 1) ∩ (1, 0, 1) ∩ (1, 1, 0) ∩ (1, 1, 1)) with the
weight of each row being k.
We start by using a relaxation where each column of the
m×n array is allowed to have expected weight k and therefore
allow one to remove the condition of fix weight k. Particularly,
let q = 2. Then, the process is to randomly place a 1 in any of
the mn places with probability p = k/n and a 0 in any of the
mn places with probability 1 − p. A set of three columns is
said to be bad if the rows do not contain vectors (1, 1, . . . , 1),
and (1, 1, 0, . . . , 0), (1, 0, 1, . . . , 0), . . . , (0, . . . , 0, 1, 1) among
their columns. The following lemma uses the probabilistic
method to prove that the probability of existence of an EEKR
family is positive. First, the definition of the Lova´s local
lemma (LLL) is provided
Lemma 4. (Lova´sz Local Lemma) Let A1, A2, . . . , An be
events in an arbitrary probability space. Suppose that each
event Ai is mutually independent of all but at most d of the
other events and that P(Ai) < p for all 1 < i < n. If
ep(d+ 1) < 1, (7)
then P (
⋂
i A¯i) > 0.
Theorem 3. Let Q be the collection of subsets of all m× n
arrays that satisfy EEKR. Let Γp be a random m × n array
each entry of which is chosen independently to be a 1 with
probability p and to be a zero with probability 1− p. Then,
P(Γp ∈ Q) > 0, (8)
provided that n ≤ 2e1/(g−1)P(Bi)−1/(g−1).
Proof: We apply the LLL to prove this theorem. First, we
set
X =
(ng)∑
i
Bi,
where Bj = 1[the jth select group is bad]. Then, X is the
number of groups that form a bad member of EEKR and
therefore P(Γp ∈ Q) = P(X = 0). Hence,
P(Bi) ≤ P((1, 1, . . . , 1) is missing)
+ P((1, 1, 0, . . . , 0) is missing)
= (1− p)m +
(
g
2
)
(1− p2(1− p)(g−2))m.
The dependence number d satisfies that
d+ 1 ≤
(
g
2
)(
n− 1
g − 1
)
≤ 1
2
(en)
g−1
gg+1 (9)
After online publication, subscribers (personal/institutional) to this journal will have
access to the complete article via the DOI using the URL:
If you would like to know when your article has been published online, take advantage
of our free alert service. For registration and further information, go to:
http://www.springerlink.com.
Due to the electronic nature of the procedure, the manuscript and the original figures
will only be returned to you on special request. When you return your corrections,
please inform us, if you would like to have these documents returned.
Dear Author
Here are the proofs of your article.
• You can submit your corrections online, via e-mail or by fax.
• For online submission please insert your corrections in the online correction form.
Always indicate the line number to which the correction refers.
• You can also insert your corrections in the proof PDF and email the annotated PDF.
• For fax submission, please ensure that your corrections are clearly legible. Use a fine
black pen and write the correction in the margin, not too close to the edge of the page.
• Remember to note the journal title, article number, and your name when sending your
response via e-mail or fax.
• Check the metadata sheet to make sure that the header information, especially author
names and the corresponding affiliations are correctly shown.
• Check the questions that may have arisen during copy editing and insert your
answers/corrections.
• Check that the text is complete and that all figures, tables and their legends are included.
Also check the accuracy of special characters, equations, and electronic supplementary
material if applicable. If necessary refer to the Edited manuscript.
• The publication of inaccurate data such as dosages and units can have serious
consequences. Please take particular care that all such details are correct.
• Please do not make changes that involve only matters of style. We have generally
introduced forms that follow the journal’s style.
• Substantial changes in content, e.g., new results, corrected values, title and authorship are
not allowed without the approval of the responsible editor. In such a case, please contact
the Editorial Office and return his/her consent together with the proof.
• If we do not receive your corrections within 48 hours, we will send you a reminder.
• Your article will be published Online First approximately one week after receipt of your
corrected proofs. This is the official first publication citable with the DOI. Further
changes are, therefore, not possible.
• The printed version will follow in a forthcoming issue.
Please note
http://dx.doi.org/10.1007/s11042-011-0792-3
AUTHOR'S PROOF
and communication with security against attacks. Efficiency analysis and 
comparison with related works demonstrate that the proposed scheme is a 
superior message authentication method for VANET. 
28 Keywords 
separated by ' - ' 
VANET - Privacy - Security - Vehicular communications 
29 Foot note 
information 
Page 2 of 2Testsite
4/1/2011file://D:\Programs\Metadata\temp\MTA10792.htm
AUTHOR'S PROOF
UN
CO
RR
EC
TE
D
PR
OO
F
JrnlID 11042_ArtID 792_Proof# 1 - 31/03/11
Multimed Tools Appl
information [9, 21]. VANET can enhance traffic safety and improve traffic efficiency20
[5, 19] by transmitting messages containing information about traffic and road21
conditions. Hence, accidents or traffic jams can be significantly diminished. Since22
inexpensive wireless devices are available, typical wireless devices are installed at23
various roadside units (RSUs), such as road signs and traffic lights. Two communica-24
tions, Vehicle-to-vehicle communication (IVC) and RSU-to-vehicle communication25
(RVC), can take place in VANET. RSUs can also link to a network backbone to26
provide many diversified services.27
The primary objective of VANET is to provide real-time exchange of mes-28
sages between vehicles to ensure driver safe. However, the security of VANET is29
important because messages can be tampered with or counterfeited by malicious30
nodes during transmission [1, 16]. Several types of attacks are possible: (1) bogus31
information attack, (2) message replay attack, (3) message modification attack,32
(4) impersonation attack, and (5) RSU replication attack. If affected by malicious33
attacks, VANET may cause traffic jams or even jeopardize vehicle safety. If potential34
attacks are not addressed, use of VANET could endanger vehicles. Therefore, it is35
important to maintain network security in VANET through message authentication.36
Many studies have examined the use of RSA for source authentication and37
message encryption. However, the large overhead associated with RSA calculation38
can become a serious burden for each vehicle, especially during heavy traffic flows.39
Consequently, a traditional public key infrastructure (PKI) is unsuitable for a40
VANET. This paper proposes an authentication method based on roadside units41
(RSUs). Since most network messages are sent in real time, the delay times for42
encryption, decryption, and authentication must be decreased. In addition, messages43
transmitted between vehicles in heavy traffic are often prone to problems such as44
collision and data loss when vehicle density is high. This research uses the Diffie–45
Hellman key-establishment protocol [18] and Hash-based Message Authentication46
Code (HMAC) [14] to meet the criteria above. HMAC is a fast, effective approach47
to message authentication that is suitable for VANET security.48
The paper also addresses the following problems present in [22] and [3]. The49
first problem arises because common session keys between each vehicle and RSUs50
are different, the validity of messages cannot be verified when two vehicles within51
range of different RSUs are communicating, because each RSU lack common session52
keys for each vehicle within different ranges. That is, vehicles use different common53
session keys in different RSUs, message authentication for vehicles within different54
ranges is possible. Second, because VANET is characterized as short-range wireless55
communication and hand-off executes within the ranges of different RSUs while56
vehicles are in transition. In this case, the efficiency of source authentication and57
common session key negotiation are essential. The long-term exposure of certificates58
is also a concern. In addition to addressing these problems, the security mechanisms59
proposed in this paper also satisfy security requirements for source authentication,60
message integrity, non-repudiation, and anonymity.61
2 Related work62
Research on VANET security is abundant [3, 6, 8, 10, 11, 13, 17, 22, 23]. As [6] and63
[17] demonstrate, PKI encryption and decryption are very complicated and create64
AUTHOR'S PROOF
UN
CO
RR
EC
TE
D
PR
OO
F
JrnlID 11042_ArtID 792_Proof# 1 - 31/03/11
Multimed Tools Appl
t1.1 Table 1 Notation used in this paper
t1.2 Vi The i-th vehicle (1≤ i ≤ n, n is the total number of vehicles in the networks).
t1.3 R j The j-th RSU (1≤ j ≤ m, m is the total number of RSUs in the networks).
t1.4 RI D j R′js identity.
t1.5 V I Di V′i s identity.
t1.6 Mi The message sent by Vi.
t1.7 PUVi PUVi is the public key of Vi.
t1.8 PUR j PUR j is the public key of R j.
t1.9 PRVi PRVi is the private key of Vi.
t1.10 PRR j PRR j is the private key of R j.
t1.11 CVi CVi is V
′
i s certificate included the real ID (V I Di) of Vi.
t1.12 Zq Zq is the finite field of mod q.
t1.13 q The q is prime number.
t1.14 HMACx{.} A keyed-hash message authentication code with key x.
t1.15 XA The XA is the random number chosen by Vi, where XA ∈ Zq
t1.16 and XA < q, Zq =0,..,q-1.
t1.17 XB The XB is the random number chosen by R j, where XB ∈ Zq
t1.18 and XB < q, Zq =0,..,q-1.
t1.19 YA The YA is the V′i s public value of the Diffie–Hellman
t1.20 key-establishment protocol. YA = gXA mod q
t1.21 YB The YB is the R′js public value of the Diffie–Hellman
t1.22 key-establishment protocol. YB = gXB mod q
t1.23 Ks The secret key between vehicle and RSU,
t1.24 Ks= (YB)XA mod q or Ks= (YA)XB mod q.
t1.25 Ki,1 ∼ Ki,m The common session key between vehicle and RSU (R1 ∼ Rm).
t1.26 H A one-way hash function such that SHA-1.
t1.27 F A one-way hash chain function.
t1.28 Hag Aggregation of hash.
t1.29 SI Di The SI Di is the pseudo identity of Vi.
t1.30 TSi The TSi is a timestamp in the Mi.
t1.31 Ti, j The Ti, j is the expire time of common session key between vehicle and RSU.
t1.32 ‖ The message concatenation operation, which appends several
t1.33 messages together in a special format.
Initially, vehicles perform source authentication and secret key negotiations with107
the RSU, as shown in (1). The vehicle (Vi) and the RSU (R j) conduct source108
authentication cooperatively. First, vehicle Vi selects a random number XA. After109
calculating YA, V ′i s PRVi is used to encrypt YA. The certificate of Vi(CVi ) and110
the signed YA are encrypted using R′js public key (PUR j) and sent to R j. After111
R j receives the packet, decrypts the message using R′js private key and performs112
authentication on CVi . PUVi , which belongs to Vi, is used in decryption to see YA.113
Next, an ID is randomly selected for this vehicle’s anonymity ID (SID). The SID114
Issue table saves the vehicle’s anonymity ID (SID), VID, CV, and expiration time.115
The vehicle and RSU then negotiate the secret key (Ks). Equations 2 and 3 show116
that R j uses the common secret key (Ks) obtained through negotiation with Vi to117
calculate an HMAC for message authentication. Then, R j sends SI Di ‖ RI Dj ‖ YB118
‖ HMACKs { SI Di ‖ RI Dj ‖ YB } to Vi. After receiving the packet, Vi obtains119
its own anonymity ID and authenticates the integrity of the message. If message120
authentication is successful, Vi sends another packet to R j, which authenticates its121
integrity. If this authentication succeeds, negotiation of the secret key is successful.122
AUTHOR'S PROOF
UN
CO
RR
EC
TE
D
PR
OO
F
JrnlID 11042_ArtID 792_Proof# 1 - 31/03/11
Multimed Tools Appl
Fig. 2 SID-Key table
SID of
Vehicle
Common
session Key
Expire time
of key
SID2 K2,1 T2,1
SID6 K6,1 T6,1
SID4 K4,1 T4,1
SIDi Ki,1 Ti,1
SIDn Kn,1 Tn,1
... ... ...
Informed by
RSU
RID1
RID1
RIDm
RID3
RID2
...
Figure 2 shows that its columns include SI D of vehicle Vi, the common session key145
of Vi, R j, the RSU that sent the key, and the key expiration time. In addition to the146
SID key table, the RSUs that have issued secret key with Vi restore a record of a SID147
issue tables including four fields: SI Di, V I Di, certificate of vehicle and expire time148
of secret key for validation (Fig. 3).Q1 149
3.3 Intra-RSU message broadcast and message authentication150
When a vehicle Vi, which is within the range of R j, broadcasts the packet151
RI Dj‖SI Di‖Mi‖T Si‖H{RI Dj‖SI Di‖Mi‖T Si} where T Si is the timestamp used to152
prevent replay attacks. After all the vehicles within R j range receive the package,153
Fig. 3 SID-Key table
SID of
Vehicle
Expire time
of key
SID1 T1,j
SIDi Ti,j
SID6 T6,j
SIDk Tk,j
... ...
SIDn Tn,j
Certificate of
Vehicle
...
ID of
Vehicle
VID1
VIDi
VID6
VIDk
...
VIDn
SID5 T5,jVID5
1VC
5VC
iVC
6VC
kVC
nVC
AUTHOR'S PROOF
UN
CO
RR
EC
TE
D
PR
OO
F
JrnlID 11042_ArtID 792_Proof# 1 - 31/03/11
Multimed Tools Appl
within communication range of Rb , V j determines whether its own RID matches the187
RID of the message. If it matches, the sender and receiver are within the same RSU188
communication range, and the receiver can simply wait for the RSU’s authentication189
result. If it does not match, as shown in Fig. 5, V j returns the following request190
message to Vi:191
Requestmessage :RI Db‖SI Di‖T S j (4)
When Vi receives V j’s request, it searches for a common session key with192
Rb , Ki,b , in its RID key table and resends the packet RI Db‖SI Di‖Mi‖T Si‖193
HMACKi,b {RI Db‖SI Di‖Mi‖T Si} to V j, which then sends the packet to Rb for194
authentication.195
3.5 Hand-off problem196
VANET standard 802.11P [7] focuses on the Dedicated Short-Range Communica-197
tion (DSRC) protocol. Because communication occurs at short range, vehicles need198
hand-off with different RSUs when moving between different RSUs. This causes two199
problems. First, during each hand-off, each vehicle entering a RSU must transmit its200
certificate to perform source authentication with the RSU. Second, a new common201
session key also needs to be negotiated by the vehicle and the RSU. The method202
used in this research increases the authentication efficiency and decreases certificate203
exposure.204
This article proposes authentication of a common session key between a vehicle205
and an entering RSU during vehicle hand-off, since the vehicle uses different206
common session key when it is in different RSUs, and only the vehicle and RSUs207
know their common keys respectively. Therefore, common session keys are used208
for cross-source authentication, as shown in (5). Vehicle Vi uses a common ses-209
sion key (Ki,k) with RSU Rk from the RID key table and sends SI Di‖RI Dk‖210
HMACKi,k{SI Di‖RI Dk} to Rk. When Rk receives the packet, it uses a common211
session key with Vi from the SID key table and authenticates the message’s integrity.212
Next, as shown in (6), Rk returns a packet to Vi, which examines its integrity. If213
authentication succeeds, cross-authentication is finished.214
Vi → Rk:SI Di||RI Dk||HMACKi,k {SI Di||RI Dk} (5)
Rk → Vi:RI Dk||SI Di||HMACKi,k {RI Dk||SI Di} (6)
Fig. 5 The solution of the
inter RSUs communicationQ2
AUTHOR'S PROOF
UN
CO
RR
EC
TE
D
PR
OO
F
JrnlID 11042_ArtID 792_Proof# 1 - 31/03/11
Multimed Tools Appl
4. Anonymity: Since each vehicle receives a temporary anonymity ID each time244
it negotiates a secret key, and since that anonymity ID changes at fixed time245
intervals, the real identity of the vehicle is not exposed. In case of emergencies246
(e.g., accidents), R j can search for the real identity of SI Di (V I Di) by going to247
the RSU recorded by SI Di according to the SID key and issue tables.248
4.2 Efficiency analysis249
This research compares the efficiency of the methods in [3, 22], and [8] using the250
encryption/decryption time in Table 2 [12] and the packet length. Table 3 defines251
the bit size of each parameter. The public and private keys are both 1,024 bits252
long; the certificate is 1,500 bits, and the HMAC is 160 bits after hashing. Table 4253
t4.1 Table 4 The efficiency comparison of the proposed method and the other methodsQ3
t4.2 Method
t4.3 [22] [3] [8] Proposed
t4.4 method
t4.5 Need for RSU support YES YES NO YES
t4.6 for authentication
t4.7 Use of aggregation YES NO NO YES
t4.8 Ability of vehicle NO NO RSU is not YES
t4.9 communication in available.
t4.10 inter RSUs
t4.11 Use of message Total length Total length Total length Total length
t4.12 calculation time of a message: of a message: of a message: of a message:
t4.13 during initial identity 6,232 (bit) 2,496 (bit) 3,548 (bit) 4,092 (bit)
t4.14 authentication Encryption or Encryption or Encryption or Encryption or
t4.15 between vehicle hash of hash of hash of hash of
t4.16 and RSU calculation calculation calculation calculation
t4.17 time: 0.57 (ms) time: 0.38 (ms) time: 0.38 (ms) time: 0.384 (ms)
t4.18 Vehicle broadcast Total length Total length Total length Total length
t4.19 message of a message: of a message: of a message: 256 of a message:
t4.20 512 (bit) 512 (bit) + 210
(i−1)
+ 210
(i−1)
512 (bit)
t4.21 + 210
(m−i−1)
+ 1,500
t4.22 Encryption or Encryption or Encryption or Encryption or
t4.23 hash of hash of hash of hash of
t4.24 calculation calculation calculation calculation
t4.25 time: 0.002 time: 0.002 time: 210
(i−1)
time: 0.002
t4.26 (ms) (ms) ∗ 0.19 (ms) (ms)
t4.27 Exchange of common Total length Total length NA Total length
t4.28 session keys and of a message: of a message: of a message:
t4.29 authentication 6,232 (bit) 2,496 (bit) 448 (bit)
t4.30 during hand-off
t4.31 of vehicles in
t4.32 different RSUs
t4.33 Encryption or Encryption or Encryption or
t4.34 hash of hash of hash of
t4.35 calculation calculation calculation
t4.36 time: 0.57 (ms) time: 0.38 (ms) time: 0.004 (ms)
AUTHOR'S PROOF
UN
CO
RR
EC
TE
D
PR
OO
F
JrnlID 11042_ArtID 792_Proof# 1 - 31/03/11
Multimed Tools Appl
4. Dedicated Short Range Communication (DSRC) [Online]. Available: http://grouper.ieee.org/296
groups/scc32/dsrc/index.htmlQ5 297
5. Hartenstein H, Laberteaux KP (2008) A tutorial survey on vehicular ad hoc networks. IEEE298
Commun Mag June:164–171299
6. Hubaux J-P, Capkun S, Luo J (2004) The security and privacy of smart vehicles. IEEE Secur Priv300
2(3):49–55301
7. IEEE P802.11p/D6 (20098) Draft amendment for wireless access in vehicular environments302
(WAVE)303
8. Kounga G, Walter T, Lachmund S (2009) Proving reliability of anonymous information in304
VANETs. IEEE Trans Veh Technol 58(6)Q6 305
9. Lee S, Pan G, Park J, Gerla M, Lu S (2007) Secure incentives for commercial ad dissemination306
in vehicular networks. In: Proc. ACM int symp. MobiHoc, pp 150–159307
10. Lin X, Sun X, Ho P-H, Shen X (2007) GSIS: a secure and privacy preserving protocol for308
vehicular communications. IEEE Trans Veh Technol 56(6):3442–3456309
11. Lin X, Sun X, Wang X, Zhang C, Ho P-H, Shen X (2008) TSVC: timed efficient and secure310
vehicular communications with privacy preserving. IEEE Trans Wirel Commun 7(12):4987–4998311
12. Long M, Chwan-Hwa JW, Irwind JD (2008) Reducing communication overhead for wireless312
roaming authentication: methods and performance evaluation. Int J Netw Secur 6(3):331–341313
13. Lu R, Lin X, Zhu H, Ho P-H, Shen X (2008) ECPP: efficient conditional privacy preserva-314
tion protocol for secure vehicular communications. In: Proc. IEEE INFOCOM, Phoenix, AZ,315
pp 1229–1237316
14. NIST (2002) The keyed-hash message authentication code (HMAC). FIPS PUB 198317
15. Perrig A, Canetti R, Tygar JD, Song D (2002) The TESLA broadcast authentication protocol.318
RSA Crypto 5(2):2–13Q7 319
16. Pl??l K, Nowey T, Mletzko C (2006) Towards a security architecture for vehicular ad hoc320
networks. In: Proc. 1st int. conf. availab., rel. security, Vienna, Austria, pp 374–381Q8 321
17. Raya M, Hubaux J-P (2005) The security of vehicular ad hoc networks. In: Proceedings of the322
3rd ACM workshop on security of ad hoc and sensor networks (SASN ’05), Alexandria, VA,323
USA, pp 11–21324
18. Stingson DR (2005) Cryptography: theory and practice, 3rd edn. CRC, Boca Raton325
19. Toor Y, Muhlethaler P, Laouiti A (2008) Vehicle ad hoc networks: applications and related326
technical issues. In: IEEE communications surveys & tutorials, pp 74–88327
20. Tung B (1999) Kerberos: a network authentication system. Addison-Wesley, Reading328
21. U.S. Dept. Transp. (2006) Nat. highway traffic safety admin. Vehicle safety communications329
project330
22. Zhang C, Lin X, Lu R, Ho P-H, Shen X (2008) An efficient message authentication scheme for331
vehicular communications. IEEE Trans Veh Technol 57(6):3357–3368332
23. Zhang C, Lu R, Lin X, Ho P-H, Shen X (2008) An efficient identity-based batch verification333
scheme for vehicular sensor networks. In: Proc. IEEE INFOCOM, 2008, Phoenix, AZ, pp 246–250334
Hsin-Te Wu received the M.S. degree in computer science engineering from Shu-Te University,335
Taiwan, in 2006. He is currently working toward the Ph.D. degree. His areas of interest are wireless336
network, speech compression and multimedia system.337
AUTHOR'S PROOF
UN
CO
RR
EC
TE
D
PR
OO
F
JrnlID 11042_ArtID 792_Proof# 1 - 31/03/11
AUTHOR QUERIES
AUTHOR PLEASE ANSWER ALL QUERIES
Q1. Missing citation for Fig. 3 was inserted here. Please check if
appropriate.
Q2. Figures 4 and 5 contain pixelated texts and lines. Please
provide better quality figures. Otherwise, please confirm if it
is okay to proceed with the current figures.
Q3. Please check Table 4 if presented correctly.
Q4. Reference item [2] was not cited in text. Please provide
citation, otherwise, delete from the reference list. Also, please
check page range if captured correctly.
Q5. Reference item [4] was not cited in text. Please provide
citation, otherwise, delete from the reference list.
Q6. Please provide page range.
Q7. Please provide correct abbreviated journal title.
Q8. Please provide correct surname for Pl??l.
Q9. Photo of Wen-Shyong Hsieh is of poor quality. Please provide
better quality image. Otherwise, please confirm if it is okay to
proceed with the current photo.
2 Hsin-Te Wu and Wen-Shyong Hsieh
1 Introduction
Many studies (Kuo et al., 2001; Wu et al., 2009;
Ming-Hsing Chiu and Mostafa A. Bassiouni, 2000; De
Rango, F. et al., 2009; Wen-Tsuen Chen and Li-Chi
Huang, 2000; Young-uk Chung and Dong-Ho Cho,
2006; G.S. Asstt et al., 2006; Feng He and Furong
Wang, 2008; AbdulRahman Aljadhai and Taieb F.
Znati, 2001; S. Choi and K. G. Shin, 2002; W.-S.
Soh and H. S. Kim, 2001; Wee-Seng Soh, and Hyong
S. Kim, 2006; Duan-Shin Lee and Yun-Hsiang Hsueh,
2004) have developed multimedia network applications
for fast-moving vehicles. In real-time applications,
such as multimedia streaming and Voice over IP
(VOIP), improper hand-offs by BSs may interrupt data
transmission due to insufficient reserved bandwidth. The
methods proposed in this work accurately predict vehicle
movement. Based on predicted vehicle movement and
GIS map information, a BS can predict when and where
a vehicle may move in the region covered by another
BS, and inform the respective BS to conduct a hand-
off procedure to reserve resources. It can decrease the
drop rate and prevent other BSs from reserving resources
unnecessarily. Correctly predicting vehicle movement is
the main goal in this work.
Most studies predicting vehicle movement focused on
handoff detection. (G.S. Asstt et al., 2006; Feng He and
Furong Wang, 2008; AbdulRahman Aljadhai and Taieb
F. Znati, 2001; S. Choi and K. G. Shin, 2002; W.-S.
Soh and H. S. Kim, 2001; Wee-Seng Soh, and Hyong S.
Kim, 2006; Duan-Shin Lee and Yun-Hsiang Hsueh, 2004)
assume all vehicles are equipped with GPS, and GPS
information is sent to BSs periodically. (Feng He and
Furong Wang, 2008) (AbdulRahman Aljadhai and Taieb
F. Znati, 2001) calculated GPS data with geometric
concepts to estimate vehicle movement. However, these
approaches frequently resulted in prediction errors due
to different road conditions. (Wee-Seng Soh, and Hyong
S. Kim, 2006) (Duan-Shin Lee and Yun-Hsiang Hsueh,
2004) assumed BSs can accommodate GIS data, and BSs
calculate GPS data using probability theory to predict
vehicle movement. However, probability calculations
are extremely complex, as many factors, such as
road status, road design, and vehicle speed, must be
considered. Consequently, using probability theory to
predict vehicle movement cannot entirely respond to real
traffic conditions.
Depending on road models and whether intersections
have traffic signals, this work proposes the following
three methods: the Vehicle Mechanics Mobility
Prediction (VMMP) method (Section 4.2); Traffic Signal
Mobility Prediction (TSMP) method (Section 4.4);
and, TSDMP method, which combines the TSMP and
VMMP methods (Section 4.5). The VMMP method uses
changes in vehicle speed to predict vehicle movement;
that is, deceleration when moving in a straight line differs
from that when turning based on vehicle mechanics.
The TSMP method utilizes change in vehicle speed
to determine traffic signal patterns at intersections,
and then predicts vehicle movement according to the
behaviors of vehicles and traffic signals at intersections.
For instance, vehicles traveling in a straight line must
brake at red lights. These vehicles typically brake
at different distances from an intersection to avoid
collisions. When a traffic light turns green, vehicles
accelerate and then maintain their speed. The TSDMP
method uses vehicle mechanics to detect whether
traffic signals exist or not in an intersection. If yes,
TSMP predicts the vehicle movement according to
the behaviors of vehicles and traffic signals at an
intersection; otherwise, vehicle movement is predicted
by the VMMP approach. Furthermore, when a vehicle
decreases its speed to turn, the local BS can determine
whether the vehicle is turning left or right based on
vehicle location, as indicated on a GIS map. Simulation
results indicate that the proposed method TSDMP is
highly accurate. To accommodate information exchange
and communication, this study utilizes Session Initiation
Protocol (SIP) (IETF, 1999) as the communication
protocol between BSs and vehicles. The SIP is a standard
issued by the Internet Engineering Task Force. Using SIP
can earn the flexibility of information communication
and the expandability of the communication message.
The remainder of this paper is organized as
follows. Section 2 explores relevant literature. Section
3 introduces the system model. Section 4 describes
the proposed algorithm. Section 5 presents simulation
results, and Section 6 gives conclusions.
2 Related Work
According to (Ming-Hsing Chiu and Mostafa A.
Bassiouni, 2000) (G.S. Asstt et al., 2006), a BS divides
its coverage region into two areas. The first area is that
closest to the center of the BS communication range,
and the second area is the cell boundary. A BS initiates
vehicle movement detection and predicts a vehicle’s next
destination in the cell boundary. An excessively large
cell boundary leads to low bandwidth utilization by
target cells due to time delays. Conversely, a small cell
boundary may result in incomplete hand-offs for vehicles.
Therefore, cell boundary coverage should be determined
based on vehicle speed. In (Feng He and Furong Wang,
2008; AbdulRahman Aljadhai and Taieb F. Znati, 2001)
(W.-S. Soh and H. S. Kim, 2001) (Floriano De Rango,
Peppino Fazio, and Salvatore Marano, 2009; Dusit
Niyato, Ekram Hossain, Dong In Kim, and Zhu Han,
2009), BSs use geometric concepts to detect vehicle
movement. When a BS acquires a vehicle’s position and
movement direction, it calculates the movement angle
and position to predict where this vehicle will go in
the next cell. Nevertheless, vehicle movement is limited
by the probability of turning, which frequently causes
prediction error. For example, a vehicle may turn into
a region covered by another BS at an intersection (Fig.
1). All predictions are based on positions indicated by
GPS data, which are sent periodically to BSs by vehicles.
4 Hsin-Te Wu and Wen-Shyong Hsieh
Figure 1 The regions covered by a BS
Figure 2 Intersection
pattern prediction is used to detect whether traffic lights
are installed at an intersection and to determine traffic
light patterns.
Section 4.1 utilizes vehicle mechanics to analyze
vehicle movement. In Section 4.2, the VMMP algorithm,
which utilizes vehicle mechanics, is applied to predict
vehicle movement. Section 4.3 uses vehicle mechanics
to detect whether an intersection has a traffic signal.
In Section 4.4, the TSMP approach utilizes changes in
vehicle speed to identify traffic signal patterns at an
intersection, and predicts vehicle movement according to
vehicle behaviors at traffic signals. Section 4.5 discusses
the TSDMP algorithm, which using vehicle mechanics to
detect whether a traffic signal exists at an intersection.
If a traffic signal exists, the TSMP approach predicts
vehicle movement according to vehicle behaviors at
traffic signals; otherwise, predicts vehicle movement in
that same manner as the VMMP.
4.1 Vehicle Mechanics
Generally, all vehicles at an intersection may 1) go
straight on a green light, 2) brake to a stop at a red light
or stop sign, 3) slow down to turn, or 4) speed up from
a stop. Distance l (meters) of a vehicle braking derived
is as follows (Wang Wen ed., 1980):
l =
(V1 − V0)2
2DV
× 0.278 (3)
where V1 is speed before braking or slowing down, V0
is zero while braking, or a steady speed when slowing
down (the unit for V1 and V0 is kilometers per hour
(KPH) and Dv is deceleration in KPH per second
(KPHPS).
The time when a vehicle encounters a red light (TR)
is derived as follows:
TR = TReaction + TBraking + TWaiting (4)
where reaction time, TReaction, is about 1 sec from
when the traffic light is seen to braking; braking time,
TBraking, is V1/Dv sec, and TWaiting is the time waiting
for a traffic light to change.
When a vehicle makes a turn, the allowable turning
speed (Vturn) is derived as follows (Wang Jing-yuan,
2006):
h
w
=
1 + V
2
turn
g∗Rturn × e
2×
(
V 2turn
g∗Rturn − e
) (5)
where h is the height of the barycenter, w is vehicle
width, the h/w ratio is 0.667, Rturn is the turning
radius, g is gravity, and e is superelevation rate. Different
vehicles have different Vturn values, which is maximum
turn speed before a vehicle turns over.
4.2 Vehicle Mechanics based the Movement
Prediction Algorithm (VMMP)
When a vehicle enters the CSR (ACSR) region,
sequential GPS data will be acquired by a BS to record
vehicle speed, and determine whether the vehicle is in
the prediction region, Apred. If a vehicle is in Apred,
the BS explores the road section (Ri) the vehicle is
within, and checks the end of this road section. If the
end of road section is not in Apred, the vehicle will
move out Apred, and may return the CSR region or
move outside the coverage region of the BS within a few
minutes, which depends on the vehicle speed. A hand-off
process will be initiated and the neighboring BS is then
informed. If the end of the road section is in Apred. The
VMMP algorithm predicts where a vehicle will go based
on its speed (V ), average deceleration (Da), maximum
turn speed (Vturn), minimum deceleration (Dc), which
is the minimal deceleration needed to prevent a collision
with the front vehicle or to stop at the front of an
intersection, and the vehicle’s lane where the vehicle is
in, the movement prediction will be done as the following
Vehicle Movement Prediction (VMMP) algorithm to
predict where the vehicle will go.
Minimum deceleration (Dc) is derived as follows:
Dc =
V 2limit
2× la × 0.278 (6)
where la is the distance between two neighboring
vehicles. The VMMP algorithm is as follows.
6 Hsin-Te Wu and Wen-Shyong Hsieh
Step 3 (Tyellow start):Before Tred start, there is a
constant seconds for yellow light to warn a traffic
sign changing.
Tyellow start = Tred start − C (8)
where Tyellow start is the start time of a yellow light
period, and C is a fixed duration (sec). Because the
yellow light is used to inform vehicles passing the
intersection quickly, some omit this phase in the
phase in the following discussion.
Step 4 (Tturn start):Many roads have left-turn signals
after the green light ends. This step identifies the
duration of the left-turn period. One can determine
if a traffic signal has a left-turn signal by checking
whether any vehicle in inner lane speeds up from a
stop while many vehicles in middle or outer lane
brake to a stop. If a traffic signal has a left-turn
light, then the start time of this phase can be
estimated as Eg.8, but for the vehicles in inner
lane. The end time of this phase is red start time.
Turnflag =

true, if Da< 0, for the vehicles in
inner lane, and Da > 0 for the
vehicles in the middle lane.
false , otherwise
(9)
Turnflag indicates whether turn phase is installed,
if Turnflag is false, Tturn start will be equal to
Tred start.
To determine whether an intersection has a traffic light.
The answer lies in the regular period is traffic sign
pattern. Since traffic lights change regularly, if the
deviation in the duration of a green light is smaller than
a small value α, Trafficflag is true; that is, a traffic
light exists.
Trafficflag =

true, if
∣∣∣∣∣∣∣
(Tgreen start − Tred start)
- (Tnext green start
−Tnext red start)
∣∣∣∣∣∣∣<α
flase, otherwise

where Tnext green start and Tnext green start are the
start time of a green light and red light in a sign cycle,
respectively. The BS will periodically check whether a
traffic signal cycle matches the predicted pattern; if not,
the BS will make another traffic signal prediction.
4.4 Traffic-Light-Based Movement Predict
Algorithm (TSMP)
The limitations of the VMMP algorithm can be
overcome by adopting the concept of a traffic light
pattern as vehicles typically move according to traffic
lights. For instance, vehicles brake at red lights, speed
up on green turning lights, move in a straight line
on green lights, and decelerate at green lights before
turning. Thus, one can predict vehicle movement based
on traffic signal patterns. The steps proposed in Section
4.3 can be applied to determine the start time of each
traffic signal pattern-Tgreen start, Tturn start, Tred start,
Tnext green start and Tnext turn start. Notably, Tturn start
may equal Tred start when Turnflag is false. On a
yellow light, a vehicle may move into the intersection
quickly, such that the cycle will ignored in the following
discussion. By combining vehicle mechanics and traffic
signal patterns, one can predict vehicle movement
precisely using the following TSMP algorithm.
When a vehicle reaches a road section within the
prediction region, the BS will check whether it covers
the end of the road section. If not, the vehicle is
definitely moving straight, and the hand-off process will
be completed before the vehicle leaves the region covered
by the BS. If the BS covers the end of the road section,
the vehicle will remain in the Apred region; thus, the
vehicle may move straight, turn left, or turn right in
the intersection at the end of the road section. With
the TSMP method, if a traffic light is currently green,
movement is predicted is the same way as with the
VMMP method. If the traffic light is red, the vehicle
may stop, brake, or turn right if turning right on a red
light is allowed. If the traffic signal has a turn signal,
the vehicle may turn left or turn right by speeding up
from the stop state. If the TSMP method returns Rl,
Rr or Rs, the BS may prove after the vehicle has passed
through the intersection and add the new road section to
the GIS map as a new Ri. If the return message is CSR,
the BS releases the vehicle from the TSMP method. If
hand-off (V ,D) is returned, the BS will start the hand-off
process and inform neighboring BSs to reserve resources
according to the values of V and D, where V is a vehicle’s
current speed, and D is distance to the BS boundary.
4.5 Traffic-Sign-Detection-Based Movement
Prediction (TSDMP)
To make a precise movement prediction, this work
combines the VMMP and TSMP methods into the
TSDMP method. In the TSDMP approach, each
intersection at the end of a road section in Apred is
identified to determine whether traffic lights are installed
in the intersection based on the measured deviation of
the signal pattern. If a traffic signal is installed, the
traffic flag is set as true, and the traffic light cycle is
counted. When a vehicle is on a road section in Apred,
the TSDMP method is applied for movement prediction
as follows:
TSDMP:Traffic Sign Detection Based Movement
Predication:
if the status of traffic-flag of the intersection at front
of road section where the vehicle moving on is true.
perform TSMP algorithm
else
perform VMMP algorithm
end
8 Hsin-Te Wu and Wen-Shyong Hsieh
North
South
West East
RNS
RNS
RWE RWE
Red 
light
Green
light
Red 
light
Green
light
Red 
light
Green
light
Red 
light
Green
light
Turn left light
Tgreen_start
Tturn_start Tred_start 
Tnext_green_start Tnext_turn_start 
Traffic Signal Cycle of RNS
Traffic Signal Cycle of RWE
Tgreen_start
Tturn_start
Tred_start 
Tnext_green_start 
Turn left light
Turn left light Turn left light
Figure 3 Mobile behaviors at traffic signals
5 Simulation
Obtaining a real GIS region is not easy. In a
real region, vehicles transmit GPS information to
BSs periodically. However, the PC-crash program
(Datentechnik, 2001), an accident reconstruction
program developed by Datentechnik, can be applied to
simulate a road map with different intersections, road
speeds, and vehicles with different driving states. The
PC-crash program can draw a road map (a region with
many roads and intersections that may be one of three
intersection types). The database in PC-Crash contains
data for over 20,000 vehicles (e.g., cars, trucks, vans, or
buses with different weights, widths and heights). The
software program can set driving states (e.g., speed,
location, direction, and time) for each vehicle, and other
information, such as road speed limit, distance, braking
speed, and traffic signal pattern, and other states based
on vehicle mechanics.
5.1 Simulation Environment
This work utilizes the PC-Crash program to design
a region with 16 intersections, 256 vehicles, a 50-Km
speed limit, and three traffic states. The intersections
may have three lanes, two lanes, or be a T intersection.
The vehicles may be cars, trucks, vans, or buses. The
traffic states in the region may be traffic jam, smooth
traffic, or little traffic. Via the simulation environment,
vehicle states (speed, time, location, direction, and
acceleration) are captured every second. MATLAB
is then applied to process data using the proposed
algorithms for movement prediction. Simulation results
will be compared with method results in (Wee-Seng Soh,
and Hyong S. Kim, 2006) and (Duan-Shin Lee and Yun-
Hsiang Hsueh, 2004).
Table 1 shows the simulation environment for the
proposed algorithms. Table 2 compares the environments
for the proposed algorithms and methods in (Wee-Seng
Soh, and Hyong S. Kim, 2006; Duan-Shin Lee and Yun-
Hsiang Hsueh, 2004).
5.2 Simulation Results
In the simulation environment, vehicle traffic
information by PC-Crash is collected as input for
the proposed algorithms processed in MATLAB under
the following three traffic signal environments: all
intersections have a traffic signal; all intersections
lack a traffic signal; and, some intersections have a
traffic signal. Table 3, 4, and 5 show the movement
prediction accuracy using the VMMP, TSMP, and
TSDMP algorithms, respectively.
The reason for the low accuracy of the VMMP
algorithm for the case of some intersections without
traffic signals may be that 1) vehicles entering the
waiting lane decelerate to brake, 2) vehicles brake slowly
when the distance to the front vehicle is long, or 3)
vehicles decelerate when approaching an intersection,
even when the intersection has no traffic signal. The
TSMP algorithm is false to predict when the intersection
lacks a traffic signal (Table 4). With the TSDMP
algorithm, traffic flags are detected to determine whether
to use the VMMP or TSMP algorithm. Analytical results
show that the average accuracies of vehicle movement
predictions by the TSDMP algorithm are 96.6%, 84.16%
and 90.16%. The methods in (Wee-Seng Soh, and Hyong
S. Kim, 2006) and (Duan-Shin Lee and Yun-Hsiang
Hsueh, 2004) are applied to the simulation environment.
Table 6 shows simulation results, indicating that the
proposed method is superior to the methods of (Wee-
Seng Soh, and Hyong S. Kim, 2006) and (Duan-Shin Lee
and Yun-Hsiang Hsueh, 2004) in the propose simulation
environment and the simplify traffic environment that
stated in the two articles.
6 Conclusion
The environment in this work, the GIS map covered
by a BS and vehicle GPS information are used to predict
vehicle movement. Based on vehicle mechanics and the
determined traffic signal pattern, one can accurately
predict which road section to which a vehicle will travel.
This work uses the PC-Crash program to generate a
simulation road map with 16 intersections, 256 cars,
10 Hsin-Te Wu and Wen-Shyong Hsieh
Table 6 simulation results of (Wee-Seng Soh, and Hyong S. Kim, 2006; Duan-Shin Lee and Yun-Hsiang Hsueh, 2004)
method
(Wee-Seng Soh, and Hyong S.
Kim, 2006) (%)
(Duan-Shin Lee and Yun-Hsiang
Hsueh, 2004) (%)
Cross 90 78
T shape 86.7 73
` shape 85 83
Average 87.2 78
Original paper (average) 95 90
and 3 traffic states. The driving states of each car are
generated by the PC-Crash program. The performance
of the proposed VMMP, TSMP and TSDMP algorithms
are measured by the MATLAB program with input
information from the PC-Crash program under three
intersections, each with a different traffic signal status.
Simulation results show that the prediction accuracy of
behaviors of vehicles is good and superior to that in
(Wee-Seng Soh, and Hyong S. Kim, 2006) and (Duan-
Shin Lee and Yun-Hsiang Hsueh, 2004).
If movement prediction results are utilized to reserve
resources for communication hand-offs, the ”hand-off”
return message will inform the BS to conduct a hand-off
operation and inform the next BS to reserve resources
for the new communication according to vehicle speed
and distance to the BS coverage boundary. The ”hand-
off” message is returned only when a vehicle reaches the
end of a road section that is outside the coverage of the
BS. Based on GIS and GPS information, the ”hand-off”
return message is always correct. Thus, the proposed
algorithms are helpful for communication hand-offs.
References
Geng-Sheng Kuo, Po-Chang Ko and Min-Lian Kuo
(2001) ‘A Probabilistic Resource Estimation and Semi-
Reservation Scheme for Flow-Oriented Multimedia
Wireless Networks’, IEEE Communications Magazine,
pp.135–141.
Shiow-yang Wu, Jungchu Hsu, and Chieh-Ming Chen
(2009) ‘Headlight Prefetching and Dynamic Chaining for
Cooperative Media Streaming in Mobile Environments’,
IEEE Transactions on Mobile Computing, Vol. 8, No. 2,
pp.173–187.
Ming-Hsing Chiu and Mostafa A. Bassiouni (2000)
‘Predictive Schemes for Handoff Prioritization in
Cellular Networks Based on Mobile Positioning’, IEEE
Journal on Selected Areas in Communications, Vol. 18,
No. 3, pp.510–522.
De Rango, F., Fazio, P. and Marano, S. (2009) ‘Utility-Based
Predictive Services for Adaptive Wireless Networks
with Mobile Hosts’, IEEE Transactions on Vehicular
Technology, Vol. 58, No. 3, pp.1415–1428.
Wen-Tsuen Chen and Li-Chi Huang (2000) ‘RSVP Mobility
Support: A Signaling Protocol for Integrated Services
Internet with Mobile Host’, in Proceedings of the IEEE
Informcom, pp.1283–1292.
Young-uk Chung and Dong-Ho Cho (2006) ‘Enhanced
Soft-Handoff Scheme for Real-Time Streaming Services
in Intelligent Transportation Systems Based on CDMA’,
IEEE Transactions on Intelligent Transportation
Systems, Vol. 7, No. 2, pp.147–155.
G.S. Asstt, A.P. Singh, R.B. Singh and B.S. Sohi (2006)
‘IAPP Modifications for a Location based Fast hand off
Technique in wireless networks’, IEEE Communication
System Software and Middleware, First International
Conference, pp.1–7.
Feng He and Furong Wang (2008) ‘Position Aware Vertical
Handoff Decision Algorithm in Heterogeneous Wireless
Networks’, WiCOM ’08. 4th International Conference
on Wireless Communications, Networking and Mobile
Computing, pp.1–5.
AbdulRahman Aljadhai and Taieb F. Znati (2001)
‘Predictive Mobility Support for QoS Provisioning
in Mobile Wireless Environments’, IEEE Journal on
Selected Areas in Communications, Vol. 19, No. 10,
pp.1915–1930.
S. Choi and K. G. Shin (2002) ‘Adaptive bandwidth
reservation and admission control in QoS-sensitive
cellular networks’, IEEE Trans. Parallel Distrib. Syst.,
Vol. 13, No. 9, pp.882–897.
W.-S. Soh and H. S. Kim (2001) ‘Dynamic guard bandwidth
scheme for wireless broadband networks’, in Proc. IEEE
Infocom, Anchorage, AK, pp.572–581.
Wee-Seng Soh, and Hyong S. Kim (2006) ‘A Predictive
Bandwidth Reservation Scheme Using Mobile
Positioning and Road Topology Information’,
IEEE/ACM Transactions on Networking, Vol. 14, No. 5,
pp.1078–1091.
Duan-Shin Lee and Yun-Hsiang Hsueh (2004) ‘Bandwidth-
Reservation Scheme Based on Road Information for
Next-Generation Cellular Networks’, IEEE Transactions
on Vehicular Technology, Vol. 53, No. 1, pp.243–252.
‘The National Marine Electronics Association’.
Datentechnik (2001) ‘PC-Crash6.2 Technical Manual’,
Macinnis Engineering Associates.
IETF (1999) ‘RFC-2543: SIP: Session Initiation Protocol’,
IETF.
Nilanjan Banerjee, Arup Acharya and Sajal K. Das
(2006) ‘Seamless SIP-Based Mobility for Multimedia
Applications’, IEEE Network, pp.6–13.
Behcet Sarikaya and Xiao Zheng (2008) ‘SIP Paging and
Tracking of Wireless LAN Hosts for VoIP’, IEEE/ACM
Transactions on Networking, Vol. 16, No. 3, pp.539–548.
1 
 
A New Watermark-Removal Method based on Eigen-Image Energy 
Te-Cheng Hsu1, Wen-Shyong Hsieh1,2 , Tung-Shih Su1 and John Y. Chiang1 
1Department of Computer Science and Engineering, National Sun Yat-sen University, 80424, Kaohsiung, Taiwan, R.O.C. 
2Department of Computer Science and Information Engineering, Hsu-Te University, 82445, Kaohsiung, Taiwan, R.O.C. 
E-mails: 
tedhsu@cse.nsysu.edu.tw, wshsieh@mail.stu.edu.tw, tomjunk@ms37.hinet.net and chiang@cse.nsysu.edu.tw 
ABSTRACT 
This work presents a new watermark-removal approach based on the energy distribution of eigen-images of an image. 
Most watermark-removal methods consider watermarks as noise and apply denoising approaches to remove watermarks. 
However, when watermark energy is removed by denoising methods from a watermarked image, the energy of the original 
image is simultaneously removed. Therefore, it causes the predicted image of the original image either retain too much energy 
of the watermark or lose too much energy of the original image. To solve this problem, the relationships among the energies of 
the original image, the watermark and the watermarked image are first determined from their stochastic models. Then, the 
energy of the watermark is estimated using just-noticeable-distortion (JND). Finally, based on the characteristic of energy 
distribution of eigen-images of an image, the watermark energy is removed from the watermarked image. The experimental 
results show that the proposed method yields the average peak signal-to-noise ratio (PSNR) of the predicted image 3.4dB 
higher than that obtained using the adaptive Wiener filter, and the average normalized correlation (NC) value of the watermark 
extracted from the predicted image is 0.44 lower than that obtained using the adaptive Wiener filter. Clearly, the proposed 
method is a very effective watermark-removal method. 
3 
 
attacks and protocol attacks [4]. Each method applies a particular strategy to interfere with a watermarked image to make the 
extracted watermark, which is obtained by the watermarking method, cannot verified by the owner of the watermarked image. 
Removal attacks [4]-[6], in the spatial domain, treat the watermark ܅ as noise that is added to the original image ۷ to yield 
the watermarked image ܇. The relevant relations are 
܇ ൌ ۷ ൅ ܅.  (1) 
Based on this assumption, watermark-removal algorithms apply a denoising method to remove the watermark to yield the 
predicted image ۷ሚ and the predicted watermark ܅෩ . Furthermore, they may use remodulation approaches to change the signs 
of part of the predicted watermark and add this predicted watermark to the predicted image to yield the final attacked image ۷መ. 
Figure 1 presents the flow chart for removing the watermark and remodulation. 
Two objectives must be considered in the removal of a watermark. The first is to remove the watermark energy from the 
watermarked image; the second is to retain the energy of the original image in the watermarked image. 
In fact, a trade-off exists between these two aims, because when attackers wish to remove a watermark from a 
watermarked image, they know nothing about the watermark, the original image and the watermarking algorithm. As most of 
watermark-removal methods, such as denoising filtering or image compression (or quantization) methods, removing 
watermark energy also leads to remove partial original image energy at the same time. Therefore, to obtain a high-quality 
predicted image, the amount of watermark energy as a fraction of total removed energy must be maximized. Furthermore, the 
more correctly predicted image can also increase remodulation efficiency. However, the literature indicates that most 
watermark-removal schemes were suffered with such problems. 
5 
 
۷ ൌ ܃܁܄்,  (2) 
where ܃ is an ݉ ൈ  ݊ orthogonal matrix; ܄ is an ݊ ൈ ݊ orthogonal matrix and ܁ is an ݊ ൈ ݊ diagonal matrix with 
ݏூభ ൒ ݏூమ ൒ ڮ ൒ ݏூ೙ ൒ 0. ݏூ೔ሺ1 ൑ ݅ ൑ ݊ሻ are the singular values of ۷, and the columns of ܃ and ܄ are the left and right 
singular value vectors, respectively. 
The rank of ۷ is ݎ ሺݎ ൑ ݊ሻ, and is the number of nonzero singular values: 
ݏூభ ൒ ݏூమ ൒ ڮ ൒ ݏூೝ ൐ ݏூೝశభ ൌ ڮ ൌ ݏூ೙ ൌ 0. (3) 
Then Eq. (2) can be written as 
۷ ൌ ෍ ݏூ೔܃ூ೔܄ூ೔
்
௥
௜ୀଵ
 
ൌ ݏூభ܃ூభ܄ூభ
் ൅ ݏூమ܃ூమ܄ூమ
் ൅ ڮ ൅ ݏூೝ܃ூೝ܄ூೝ
்  
ൌ ۷ଵ ൅ ۷ଶ ൅ ڮ ൅ ۷௥,  (4) 
where ܃ூ೔ and ܄ூ೔ are the ݅th columns of ܃ and ܄, respectively.  ۷࢏ ൌ ݏூ೔܃ூ೔܄ூ೔
் represents the eigen-images. Accordingly, 
an image can be decomposed into ݎ eigen-images and the total energy of ݎ eigen-images is exactly equal to the energy of the 
image. It can be shown as: 
ԡ۷ԡଶ ൌ ෍ ෍ ܫ௜௝ଶ
௡
௝ୀଵ
௠
௜ୀଵ
ൌ ෍ԡ۷࢏ԡଶ.                                    ሺ5ሻ
௥
௜ୀଵ
 
Since the square of the Frobenius-norm of ۷ is defined as, 
ԡ۷ԡଶ ൌ ෍ ݏூ೔
ଶ
௥
௜ୀଵ
 .                                                                 ሺ6ሻ 
7 
 
the filtered matrix is defined as ۷ሚ ൌ ܃௒܁ூሚ܄௒். 
3.2. Adaptive Wiener Filter 
The authors of two earlier studies [6][12] modeled watermarking based on the stochastic distribution of images and used 
such proposed schemes as the adaptive Wiener filter, soft-shrinkage in the wavelet domain and reweight-least-squares (RSL) to 
remove watermarks from watermarked images. They treated original images as either locally independent identically 
distributed (i.i.d.) non-stationary Gaussian (nG) or globally i.i.d. stationary Generalized Gaussian (sGG) images, and regarded 
watermarks as i.i.d. random variables with Gaussian distributions of zero mean and variance ߪௐଶ . 
One of the cited works [6] employed the well known adaptive Wiener or Lee filter to remove watermarks. The filter is 
given as follows: 
ܫሚ௜௝ ൌ ܫ ҧ௜௝ ൅
ఙ಺೔ೕ
మ
ఙ಺೔ೕ
మ ାఙೈ
మ ൫ ௜ܻ௝ െ ܫ ҧ௜௝൯,  (9) 
where ܫ ҧ௜௝ and ߪூ೔ೕ
ଶ  are local mean and local variance, respectively. 
4. Proposed Method 
The watermarking equation ܇ ൌ ۷ ൅ ܅  demonstrates that regardless of the algorithm adopted for embedding a 
watermark, the watermarked image can always be separated into the original image and the watermark in the spatial domain, 
and each pixel is represented by ௜ܻ௝ ൌ ܫ௜௝ ൅ ௜ܹ௝. 
To establish the energy relations among three images, the aforementioned assumptions in section 3.2 concerning the 
stochastic distribution of images are made, namely, the original image is modeled as a global i.i.d. sGG, and the watermark is 
i.i.d. ௜ܹ௝~ܰሺ0, ߪௐଶ ሻ. For simplicity, pattern ܅ is assumed to be uncorrelated with image ۷: covሺ۷, ܅ሻ ൌ 0. 
9 
 
In Eq. (13), although the energy of the watermarked image is not precisely divided into the energy of the original image 
and that of the watermark, most of the energy of each of the three images must be concentrated in only the first few 
eigen-images. Therefore, the energy of each eigen-image of a watermarked image is intuitively assumed to be almost equal to 
the sum of the energy of the eigen-image of the original image and the watermark of the same rank: 
ԡ܇௜ԡଶ ൎ ԡ۷௜ԡଶ ൅ ԡ܅௜ԡଶ.         (14) 
Hence, Eq. (14) can be rewritten as 
ฮ۷ሚ௜ฮ
ଶ ൌ ԡ܇௜ԡଶെฮ܅෩௜ฮ
ଶ, (15) 
where ฮ۷ሚ௜ฮ
ଶ
 and ฮ܅෩௜ฮ
ଶ
 represent the energy of the ith eigen-image of the predicted image and the predicted watermark, 
respectively. 
From Eq. (7), the energy of each eigen-image equals the square of its singular value. Therefore, Eq. (15) can be rewritten 
as 
ݏூሚ೔ ൌ ቀݏ௒೔
ଶ െ ฮ܅෩௜ฮ
ଶቁ
ଵ ଶ⁄
. (16) 
To obtain the energy of the predicted watermark ฮ܅෩௜ฮ
ଶ
, the characteristic of JND is used and the stochastic distribution 
of the watermark is assumed. 
Each pixel in an image has a JND value and the JND value is the maximum gray level that may be changed at the 
particular pixel without changing the gray levels of the other pixels. A change in the value of the gray level of a particular 
pixel to below JND value cannot be observed by the human visual system. Therefore, several imperceptible watermarking 
11 
 
ฮ܅෩௜ฮ
ଶ ൌ ߣ · ݉݊ߪଶ ·
ԡ܇௜ԡം
∑ ԡ܇௜ԡം௥௜ୀଵ ,
                                       ሺ20ሻ 
where ߣ is the percentage of the removal energy of the predicted watermark, ԡ܇೔ԡ
ം
∑ ԡ܇೔ԡംೝ೔సభ
 is the prediction function and ߛ is the 
function parameter. 
The energy of each eigen-image of the predicted watermark ฮ܅෩௜ฮ
ଶ
 is constrained to be less than the energy of the 
eigen-image of the watermarked image ԡ܇௜ԡଶ: if ฮ܅෩௜ฮ
ଶ ൐ ԡ܇௜ԡଶ, then ฮ܅෩௜ฮ
ଶ ൌ ԡ܇௜ԡଶ. Therefore, ԡ܇௜ԡଶ െ ฮ܅෩௜ฮ
ଶ ൒ 0.  
According to Eqs. (16) and (20), every singular value of the predicted image is represented as 
ݏூሚ೔ ൌ ൭ݏ௒೔
ଶ െ ߣ · ݉݊ߪଶ ·
ݏ௒೔
ఊ
∑ ݏ௒೔
ఊ௥
௜ୀଵ
൱
ଵ ଶ⁄
.                                      ሺ21ሻ 
Finally, the predicted image can be reconstructed from the singular values of the predicted image and the singular value 
vectors ܃௒, ܄௒ of the watermarked image: ۷ሚ ൌ ܃௒܁ூሚ܄௒் 
5. Experimental results 
In this section, four watermarking algorithms are adopted to embed an original watermark in an original image. Then, the 
watermark is removed from a watermarked image using the four watermark-removal methods to obtain the predicted images; 
finally, the PSNR of each predicted image is computed from the predicted image and the original image, and also the similarity 
between the extracted watermark and the original watermark is computed. The proposed method uses parameters ߣ ൌ 1, 
γ ൌ 3 2⁄  in Eq. (21). 
The degree of similarity, NC, between the original watermark ܆ and the extracted watermark ܆כ can be determined by 
performing a correlation test. Their two-dimensional correlation coefficient is calculated directly using 
13 
 
of the original image of the adaptive Wiener filter is locally i.i.d. nG and the assumption of the proposed method is globally 
i.i.d. sGG.  
After removing watermarks from the watermarked images whose watermarking algorithms are employed by Cox, Huang, 
Maity and Lee, the predicted images can be obtained and the corresponding performances of these watermark removal 
methods (SVD 1, SVD 2, Wiener, Eigen) are listed from Table 2 to 5. 
Figure 5 presents the predicted images by removing the watermarks from the watermarked images, using Maity’s 
watermark embedding algorithm and also the watermark-removal method of the adaptive Wiener filter. Figure 6 presents 
watermarks extracted from the predicted images in Fig. 5. Figure 7 is obtained by the same way as in Fig. 5 except using the 
watermark-removal method of the proposed method. Figure 8 presents watermarks extracted from the predicted images in Fig. 
7. Due to the page limit imposed, only the results performed by using Maity’s embedding watermark algorithm, and the 
watermark removal method of the adaptive Wiener filter and the proposed method are presented. 
In Fig. 9, each diamond on the curve “watermarked” represents the mean PSNR of the watermarked images, which is 
given in Table 1, obtained by applying four watermarking algorithms to each original image. The mean PSNR can be 
determined from the information provided in Tables 2 to 5. For instance, for the image Barbara and the watermark-removal 
method ‘SVD 1’, the mean PSNR is derived from the four values of row ‘SVD 1’ and column ‘PSNR’ from Tables 2 to 5. As 
presented in Fig. 10, the NC values of the extracted watermarks, before watermark-removal methods are applied, are all 1.0. 
The mean NC values can also be calculated in the same way as the mean PSNR, except when these calculations refer to the 
‘NC’ columns. 
15 
 
benchmark’, Signal Processing, June 2001, vol. 81, pp. 1177-1214 
[3] Solachidis, V., Tefas, A., Nikolaidis, N., Tsekeridou, S., nikolaidis, A., and Pitas, I.: ‘A benchmarking protocol for 
watermarking methods’. IEEE Int. Conf. on Image Processing, Oct. 2001, vol.3, pp. 1023-1026 
[4] Kutter, M., Voloshynovskiy, S., and Herrigel, A.: ‘The watermark copy attack’. IS&T/SPIE’s 12th Annual Symposium, 
Electronic Imaging 2000: Security and Watermarking of Multimedia Content II, SPIE Proc., San Jose, CA, USA, Jan. 2000, 
vol. 3971, pp. 23-28 
[5] Craver, S., Memon, N., Yeo, B. L., and Yeung, M.: ‘Resolving rightful ownerships with invisible watermarking techniques: 
limitations, attacks, and implications’, IEEE Journal on Selected Areas in communications, May 1998, vol. 16, pp. 573-586 
[6] Voloshynnovskiy, S., Pereira, S., Herrigel, A., Baumgartner, N., and Pun, T.: ‘Generalized watermarking attack based on 
watermark estimation and perceptual remodulation’ In Proceedings of SPIE: Security and Watermarking of Multimedia 
Content II, San Jose, CA, USA, Jan. 2000 
[7] Chou, C. H., and Li, Y. C.: ‘A perceptually tuned subband image coder based on the measure of just- noticeable-distortion 
profile’, IEEE Trans. Circuits Syst. Video Technol., Dec. 1995, vol. 5, no. 6, pp. 467-476 
[8] Konstantinides, K., and Yao, K.: ‘Statistical analysis of effective singular values in matrix rank determination’, IEEE Trans. 
Acoustics, Speech, and Signal Processing, May 1988, vol. 36, pp. 757-763 
[9] Wongsawat, Y., Rao, K. R., and Oraintara, S.: ‘Multichannel SVD-Based Image De-Noising’. IEEE International 
Symposium on Circuits and Systems, ISCAS 2005, May 2005, vol. 6, pp. 5900-5993 
[10] Lu, W.: ‘Adaptive Noise Attenuation of Seismic Image Using Singular Value Decomposition and Texture Direction 
Detection’. International Conference on Image Processing, Sep. 2002, vol. 2, pp. II-465-II-468 
17 
 
 
Removing
Watermark + Remodulation +
Y I~
+
− W~ ++ Iˆ
 
Fig. 1 Removing watermark and remodulation flow chart. 
 
 
 
Fig. 2 Energy distribution of eigen-images of an image. 
 
 
Fig. 3 Original images: Barbara, Lena, Baboon and Peppers. 
 
 
 
 
 
Fig.4 Original watermarks 
 
0
1E+09
2E+09
3E+09
4E+09
1 51 101 151 201 251 301 351 401 451 501
En
er
gy
Eigen-images
19 
 
Fig. 5 Predicted images obtained from four different watermarked images by 
applying Maity’s watermarking algorithm to four original images and using the 
watermark-removal adaptive Wiener filter to the four watermarked images. 
 
 
Fig.6 Four watermarks extracted from the four predicted images in Fig. 5 
 
 
Fig.7 Predicted images obtained from four different watermarked images by 
applying Maity’s watermarking algorithm to four original images and using the 
proposed watermark-removal method to the four watermarked images. 
 
98.04.06 更新 
樹德科技大學專任教師出席國際會議發表論文參加情形報告書 
姓 名 徐德成 服務系所 資工系 職 稱 兼任助理教授 
論文發表方式或任
務 
□Keynote Speaker    □Invited Speaker   □Session Chairman 
Oral       □Poster     □Other(請註明) 
出差時間 自 2012 年 07月 01日至 2012 年 07月 06日 
出差地點 （國家／城市）日本/札幌 
會議主辦機構名稱 
International Business Academics Consortium Academy of Taiwan Information 
Systems Research 
國際會議正式名稱 International Conference on Business and Information 
發表論文名稱 
Copyright protection using multiple prediction values of reversible data hiding 
algorithm 
參加國際會議概況 
商業與資訊國際研討會(BAI 2012, International Conference on Business and 
Information)是由臺灣資訊系統研究(TISR, Taiwan Information Systems 
Research)的國際商業學術聯合學會(IBACA, International Business Academics 
Consortium Academy)所舉辦的年度研討會。會議自 7 月 3 日 14:00 起至 7 月
5 日 17:00 止，共計三天。 
這次的會議，共計有八個主題，分別是 A. Strategy、B. Marketing、C. 
Accounting and Finance、D. Management Information Systems、E. Technology 
and Innovation Management、F. Operation Management and Industrial 
Engineering、G. Organization Behavior and Human Resource Management、H. 
Multidisciplinary Articles。80 個 sessions (79 個 parallel sections，1 個 poster 
session)、3 個 award (Contribution award、Best reviewer award 及 Best paper 
award) 的 presentations。 
來自於全世界 42 個國家共計 1110 篇的投稿中，共有 645 篇論文接受並發表。
我們所發表的「Copyright protection using multiple prediction values of 
reversible data hiding algorithm」論文，被列為Management Information Systems
裡的 Section [B2]，也就是 7月 3日 16:10~18:00在 Renaissance Sapporo 
Hotel的 Venezia廳報告。 
本次 Session 共有 5 位學者報告。每位發表約 15 分鐘。第一位是來自韓國
Sungkyunkwan University 報告關於支援鏈的管理問題。首先她介紹了陪同她
前來的兩位老外老師。由於她的英語表達非常流利，使我誤以為她是留學海
外的韓國留學生。接著是明志科技大學經營管理系暨服務與創新管理研究所
教授兼管設學院院長馬教授成珉的研究所學生報告，題目是臺灣中小企業的
e化需求。再者是由成功大學的王逸琳教授報告的臺灣公眾自行車租借系統
的重新分布模型。其後，有學者提問該分布模型，是否適用於世界其它城市
的公眾自行車系統，如法國。王教授答因數據的取得是來自臺灣公眾自行車
系統，因此，不確定是否適用於其它城市的自行車系統。接著由個人報告所
98.04.06 更新 
樹德科技大學專任教師出席國際會議發表論文參加情形報告書 
姓 名 徐德成 服務系所 資工系 職 稱 兼任助理教授 
論文發表方式或任
務 
□Keynote Speaker    □Invited Speaker   □Session Chairman 
Oral       □Poster     □Other(請註明) 
出差時間 自 2012 年 07月 01日至 2012 年 07月 06日 
出差地點 （國家／城市）日本/札幌 
會議主辦機構名稱 
International Business Academics Consortium Academy of Taiwan Information 
Systems Research 
國際會議正式名稱 International Conference on Business and Information 
發表論文名稱 
Copyright protection using multiple prediction values of reversible data hiding 
algorithm 
參加國際會議概況 
商業與資訊國際研討會(BAI 2012, International Conference on Business and 
Information)是由臺灣資訊系統研究(TISR, Taiwan Information Systems 
Research)的國際商業學術聯合學會(IBACA, International Business Academics 
Consortium Academy)所舉辦的年度研討會。會議自 7 月 3 日 14:00 起至 7 月
5 日 17:00 止，共計三天。 
這次的會議，共計有八個主題，分別是 A. Strategy、B. Marketing、C. 
Accounting and Finance、D. Management Information Systems、E. Technology 
and Innovation Management、F. Operation Management and Industrial 
Engineering、G. Organization Behavior and Human Resource Management、H. 
Multidisciplinary Articles。80 個 sessions (79 個 parallel sections，1 個 poster 
session)、3 個 award (Contribution award、Best reviewer award 及 Best paper 
award) 的 presentations。 
來自於全世界 42 個國家共計 1110 篇的投稿中，共有 645 篇論文接受並發表。
我們所發表的「Copyright protection using multiple prediction values of 
reversible data hiding algorithm」論文，被列為Management Information Systems
裡的 Section [B2]，也就是 7月 3日 16:10~18:00在 Renaissance Sapporo 
Hotel的 Venezia廳報告。 
本次 Session 共有 5 位學者報告。每位發表約 15 分鐘。第一位是來自韓國
Sungkyunkwan University 報告關於支援鏈的管理問題。首先她介紹了陪同她
前來的兩位老外老師。由於她的英語表達非常流利，使我誤以為她是留學海
外的韓國留學生。接著是明志科技大學經營管理系暨服務與創新管理研究所
教授兼管設學院院長馬教授成珉的研究所學生報告，題目是臺灣中小企業的
e化需求。再者是由成功大學的王逸琳教授報告的臺灣公眾自行車租借系統
的重新分布模型。其後，有學者提問該分布模型，是否適用於世界其它城市
的公眾自行車系統，如法國。王教授答因數據的取得是來自臺灣公眾自行車
系統，因此，不確定是否適用於其它城市的自行車系統。接著由個人報告所
國科會補助計畫衍生研發成果推廣資料表
日期:2013/02/25
國科會補助計畫
計畫名稱: 矛與盾:浮水印移除與防制技術之研究
計畫主持人: 謝文雄
計畫編號: 99-2221-E-366-010-MY2 學門領域: 視訊與影像分析
無研發成果推廣資料
Dynamic Program Update 
Protocol for Secure 
Sensor Networks Using 
Chameleon Hash 
Function＇＇＇＇ 
Accepted by Sensor 
Letter, June 2011 (SCIE)
[4] W.S. Li, C.W Tsai, 
W.S. Hsieh, C.S. Yang, 
M.C. Chiang,＇＇＇＇ A 
Key Management Scheme 
for Dense Wireless 
Sensor 
Networks＇＇＇＇, 
Information Journal, 
International 
Interdisciplinary 
Journal, in Vol.14, 
No.7, pp.2459~2470, July 
2011 (SCIE) 
[5] C.Y. Chen, W.S. 
Hsieh, W.S. Li, J.Y. 
Chiang, ＇＇＇＇A Novel 
Secure Access Control 
Protocol for Secure 
Sensor Networks Based on 
Chameleon Hash 
Function＇＇＇＇ 
Accepted by Sensor 
Letter, June 2011 (SCIE)
研究報告 /技術報
告 0 0 100%  
研討會論文 5 5 100% [1] W.S. Li, C.W. Tsai, 
W.S. Hsieh, C.S. Yang, 
M.C. Chiang, ＇＇＇＇On 
Randomly Generated 
Non-trivially Pairwise 
Key for Group-based 
Wireless Sensor 
Networks＇＇＇＇, 
International 
Conference on Applied 
Material and Electronic 
Engineering (AMEE 2012),
成果，目前已被成功應用至稀疏網路上的隨機預先分配金鑰系統中。 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
