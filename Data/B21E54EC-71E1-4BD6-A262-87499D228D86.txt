ABSTRACT
The SWAN (Surveillance, Watch, Autonomous flight and Navigation) project includes three
phases. The major objectives include the promotion of the autonomous flight capability and the
application of GPS/DGPS to achieve flight path tracking and accurate navigation. The first phase
studies how to find a best flight path for an air vehicle that flies between two points by using fast
graph-search algorithm. We start by constructing a virtual terrain as a searching space above the
real terrain to take into account real flight conditions and limitations of vehicle’s performance in 
flight path planning problem. The idea of virtual terrain could also eliminate a significant amount
of searching space from 3-Dimension to 2-Dimension which takes much lesser running time, and
proposes a post process to overcome this problem and it just takes less than a second without
extra computation load. The second phase deals with the autopilot control refinements. The goal
of this phase is to design the engine speed and velocity control for small unmanned aerial vehicle
(UAV). The experimental data was analyzed to obtain a nonlinear model with the engine time
delay. Besides, system parameters identification methods were used to obtain the engine linear
model for PID controller design. The velocity control used in SWAN UAV contains 2-loop
feedback structure. The outer loop converts velocity error to desired engine RPM and feeds
desired engine RPM into the inner loop. The inner loop controls RPM via throttle area. The third
phase focuses on the application of Global Position System (GPS)/Differential GPS (DGPS) in
flight control and navigation for UAV. The ground based augmentation systems are commonly
composed of one or more accurately surveyed ground stations, which take measurements
concerning the GPS, and one or more radio transmitters, which transmit the correction
information directly to the UAV. The pseudo-attitude is synthesized from the aircraft trajectory
and the acceleration of vehicle estimated from the velocity output of GPS by the Kalman filter. In
contrast to traditional attitude and heading reference system (AHRS), which is referenced to the
aircraft body axes, pseudo-attitude provides the practical attitude that suppresses the serious noise
from the environment especially for UAVs. All the studies are demonstrated and verified on the
SWAN UAV and the results are consistent with the desired goals.
Keywords: Unmanned aerial vehicle (UAV), autonomous flight, Beyond Visual Range (BVR),
Dynamic Programming, Virtual Terrain, Multi-resolution terrain, Fast Searching Method, PID
controller, system identification, Differential Global Positioning System (DGPS), Ground Based
Augmentation System (GBAS), Kalman Filter, Pseudo-attitude, Attitude and Heading Reference
System (AHRS)
CONTENTS
ABSTRACT..................................................................................................................................... 2
中文摘要.......................................................................................................................................... 3
CONTENTS..................................................................................................................................... 4
1 INTRODUCTION ................................................................................................................... 5
1.1 Background .................................................................................................................. 5
1.2 Motivation and Objectives ........................................................................................... 6
1.3 Report Outline.............................................................................................................. 6
2 Dynamic Programming in Flight Path Programming Optimization ........................................ 6
2.1 Problem Statement ....................................................................................................... 7
2.2 Basic Solution Methodology........................................................................................ 8
2.3 Algorithm Improvement............................................................................................. 11
2.4 Experimental Results ................................................................................................. 12
3 The Engine Speed and Velocity Controller Development for Small UAV ........................... 15
3.1 Characteristics and Identification of Engine Model................................................... 15
3.2 Velocity Controller of SWAN .................................................................................... 20
3.3 Flight test validation................................................................................................... 22
4 The Development of Ground Based Augmentation System (GBAS) for UAV ..................... 23
4.1 Ground Based Augmentation System (GBAS) .......................................................... 23
4.2 Current Landing / Recovery Approaches of UAVs ................................................... 24
4.3 The Setup and Application of Ground Based Augmentation System ........................ 25
5 The Implementation of Pseudo-Attitude for UAV ................................................................. 28
5.1 Pseudo-Attitude for Fixed Wing Aircraft .................................................................. 29
5.2 The Combination of Pseudo-Attitude and Attitude Measured from Gyroscopes ...... 30
5.3 System Overview ....................................................................................................... 31
5.4 Result and Discussion ................................................................................................ 34
6 CONCLUSION...................................................................................................................... 35
6.1 Conclusion on Dynamic Programming in Flight Path Programming Optimization.. 35
6.2 Conclusion on the Engine Speed and Velocity Controller Development .................. 36
6.3 Conclusion on the Implementation of Pseudo-Attitude ............................................. 36
1.2 Motivation and Objectives
In order to have a complete UAV system, which can reach the accurate position and execute
the assigned missions exactly, the next step of RMRL is to develop a fully autonomous autopilot
and an accurate navigation system with the help of DGPS for the SWAN UAV. The fully
autonomous autopilot should be capable of the capabilities of the flight path programming and
vehicle velocity control. And the accurate navigation system should be suitable for UAV. That
means this system should be small and uncomplicated. Hence, the major objectives of this project
are described bellow:
‧ Development of a fully autonomous autopilot system for SWAN UAV
‧ Development of an accurate navigation system with the help of DGPS for UAV
And the main tasks of this project are described bellow:
‧ The development of dynamic programming in flight path programming for UAV
‧ The engine speed and velocity controller development for SWAN UAV [20]
‧ The development of Ground Based Augmentation System (GBAS) for UAV
‧ The implementation of pseudo-attitude (PA) for UAV
After the accomplishments of the above tasks, the complete UAV system will be setup and capable
of the flight path programming, flight path tracking, velocity control and accurate navigation
capabilities. And the developed GBAS with DGPS will suitable for all GPS navigation vehicle in the
region which the broadcasted correction information could reach.
1.3 Report Outline
The overall system in this research can be considered as the integration of the development
of a fully autonomous autopilot system and an accurate navigation system with the help of DGPS
for UAV. The processing of the fully autonomous autopilot system consists of the dynamic
programming in flight path programming optimization and the engine speed and velocity
controller development for small unmanned aerial vehicle in Chapter 2 and Chapter 3,
respectively. Chapter 4 presents the development of Ground Based Augmentation System (GBAS)
for UAV. In Chapter 5, it introduces the implementation of pseudo-attitude for UAV and contains
the integration of PA and gyroscopes for UAV attitude estimation. In Chapter 6, the concluding
remarks of this project are listed.
2 Dynamic Programming in Flight Path Programming Optimization
The method, namely dynamic programming (DP) which rests on the principle of optimality
[8], is one of well-known methods of finding the shortest flight path. The applications of the
dynamic programming have been widely used in economics, finance, operations management,
circuit design, robot’s motion and path planning, flight route planning of airplanes and ships, and
the like. In addition, the DP method has been proved to provide a globally optimal solution if a
feasible solution exists [9]. According to the feature of providing a globally optimal solution, a
whole field of extremals has to be computed so that the computation time is tremendously high
and expensive. Therefore, a new scheme in constructing the searching space of those extremals
should be as minimal as possible to reduce the calculation time.
2.2 Basic Solution Methodology
We begin with a uniform discretization of the 3-D space of spatial positions. The discretized
flight path is made up with straight line segments passing through the grid points. Without doubt,
the actual flight path could be smoothed by such as B-spline curves. As we said in previous
section, we replaced the 3-D searching space with 2-D space for reducing runtime. The
eliminated third dimension, altitude z , have to be limited to the artificial surface  ,z i j which is
a virtual terrain we will discuss later.
We can determine the spatial position in an abscissa x , an ordinate y and altitude z
separately with x x j , y y i and the corresponding altitude  ,z z i j , as shown in Fig. 2-2.
After the transformed real terrain is obtained, the next step is then to construct the virtual
terrain  ,z z i j .
Fig. 2-1 DTEM transformed into XYZ grids data. Fig. 2-2 Real terrain on xyz coordinates
Besides the advantage of taking less runtime, there is another great benefit of virtual terrain.
This is particularly adequate to be applied in civil aviation with stringent safety caution. That is,
the fly-over altitude defined as Hc could be considered to make a complete safe and secure
altitude for flying over obstacles.
It does necessary to take into account not only the maximum climbing rate but also the
vertical safety altitude for flying over obstacles and the horizontal safety distance for passing by
obstacles. For example in Fig. 2-3 if there is the possibility of intersection between path and
terrain, the path BC will turn out to be inadmissible.
After the virtual terrain has been established, the following step is to apply the dynamic
programming method to determine the minimal flight path which shall conform to the additional
constraints imported. To conduct the calculation in the beginning, one should define the cost
tensor, related functions and additional constraint functions.
Fig. 2-3 The path BC is not admissible for intersection happened, namely path BC under the real terrain line D’G’
Extended Cost Tensor and Optimal Move Tensor
On the way to destination point  ,d di j , a minimum cost for point  ,i j and its
corresponding move m and r in its first frontier and second frontier, would be recorded
separately in extended cost tensor  , ,C i j m and optimal move tensor  * , ,r i j m at each updating
process. Initially, the extended cost tensor is set as following:
       0, if , ,For every point , , let , , 1 ~ 8
, otherwise
d di j i ji j C i j m
      
(4)
where  , ,C i j m  indicates that the point  ,i j by move m can not reach the destination
point  ,d di j or has not been updated yet. Before running the dynamic programming method, the
start and the destination points should be given as inputs and then the algorithm works backwards
from the destination point to calculate the minimum cost for grid points in expanding frontier on
virtual terrain until all points have been processed and a minimum cost of the start point
 , ,s sC i j m is determined.
Dynamic Programming Method
After the relative functions are well defined, we can write down our basic algorithm as
following:
   
   
   
 
Set , , for all points except , , 0
For every point , in the -th frontier of point , at step
For , , find , ,
If , , is not empty
d d
d d
m r
r
C i j m C i j m
i j n i j n
m S i j S i j m
S i j m
 
 
           
           
           
1 2
, ,
1 2
, ,
*
1 2
, ,
If min , , , , , , , , , ,
, , min , , , , , , , ,
, , arg min , , , , , , , ,
r
r
r
r S i j m
r S i j m
r S i j m
D i j m C L i j m L i j m r C i j m
C i j m D i j m C L i j m L i j m r
r i j m D i j m C L i j m L i j m r



 
 
 
It is proceeded in the manner for 1,2,3,...n until the cost of start point has been updated,
i.e.  , ,s sC i j m , and then the optimal path with minimum distance cost can be found by the
following procedure. Otherwise, no feasible solution exists if  , ,s sC i j m  for all move m .
   
   
   
      
 
* *
*
1,...,8
* *
* * * * * * * *
1 2
* * * * *
, ,
arg min , ,
While , ,
, , , , , ,
, ,
End
s s
s s
m
d d
i j i j
m C i j m
i j i j
i j L i j m L i j m
m r i j m






where the grids indices and the corresponding move of the shortest path from the start point to the
destination point are recorded in array  * *,i j and *m , respectively.
Direction Limitations of Take-off & Landing
The direction limitation of landing mt can be implemented by setting the cost of destination
point  , , 0d dC i j m  only if m mt , otherwise  , ,d dC i j m . On the other hand, the direction
Fig. 2-6 Illustration of the multi-resolution scheme Fig. 2-7 Searching space
Path Smoothing (Curve Fitting)
In practice the result flight path should not be made up with straight line segments. There are
many kinds of curve fitting method such as cubic spline curve, Bezier curve and B-spline curve
etc. which can be apply to smooth our result path. The runtime of curve fitting does base on the
order of curve fitting function. The lower order takes fewer runtime, however the smoothness will
go down. The acceptable lowest order in practice is second order which satisfies the position and
velocity continuity. In this report we use third-order B-spline curve fitting function to smooth
result path due to its smoothness (with less deviation.)
Fuel Consumption Ratio
Besides considering the cost of shortest distance of flight path, also the cost of fuel
consumption can be taken into account. Consider going through an obstacle, the fuel
consumption of the way by taking a climbing should be more than taking a level turn. A
dimensionless factor of fuel consumption ratio taken between these two ways can be defined as
/Kdh FCC FCLT , where FCC is the fuel consumption of climbing and FCLT is the fuel
consumption of level turn. Therefore the cost function can be redefined as
           1 2, ,, , min , , , , , , , ,rr S i j mC i j m Kdh dh D i j m C L i j m L i j m r    , where       1 2, , , , , ,dh z i j z L i j m L i j m  .
In addition, by enlarging this factor the result path could prefer to find the way between valleys
for the map with a lot of mountains. Also the frequent changing altitude could be improved
because the extra changes of altitude will cause a large increase of cost.
2.4 Experimental Results
At the beginning of simulation experiments, we are going to demonstrate the virtual terrain
concept used in our algorithm by conducting a simulation followed by comparing the
performance and effect of the proposed improvement. The issues we consider include: (1)
performance of basic 2-D DP with post-processing compared to 3-D DP; (2) basic 2-D DP
varying turn angle limits with restricted take-off and landing directions; (3) Multi-resolution
scheme and heuristic improvement; (4) effect of fuel consumption and path smoothing. The
DTEM which was used to conduct our simulation is a 2122 90km map of north Taiwan and will
be sampled to a 101×151 matrix  ,rz i j . Its corresponding longitude and latitude of bottom left
is (N24°00', E120°41') and of top right is (N24°48', E121°56'). The virtual terrain is in Fig. 2-8.
D S
Without heuristic
With heuristic
Searching space:
reach the destination. For a very large 50Kdh , a result path flying at the cruise altitude without
altitude changing can be obtained if needed.
Finally the line segments path can be smoothing by post-processing of curve fitting which is
B-spline curve fitting with parameter of order 3. It can be seen in Fig. 2-14. The smoothed path
should be more practical for real flight.
Fig. 2-11 Hierarchical 2-D DP (the searching space is shown in left figure)
Fig. 2-12 The effect of fuel consumption ratio Kdh
Fig. 2-13 With 10Kdh we can have a path flying through valleys, and with a very large 50Kdh we can have a
path flying at cruise altitude without altitude changing
50Kdh , Cost=166.2302km, runtime=89.719s, 5Kdh , Cost=111.0182km, runtime=89.281s
10Kdh , Cost=122.7976km, runtime=88.844s, 0Kdh , Cost=109.2138km, runtime=89.016s
Result path of coarser map (runtime: 26.6s); the first step of hierachical planning ( 2res , 2EG )
Result path of finer map (runtime: 9.75s); final result path of hierachical planning
(Total runtime of hierachical 2-D DP is 36.3s, speed-up: 2.2, cost degradation: 0.33％)
Basic 2-D DP (runtime: 80.3s): for a reference
20Kdh
10Kdh
0Kdh
experiments have been conducted in wind tunnel to model the engine thrust and RPM in steady
state. The final results are shown in Fig. 3-2 and 3-3. Fig. 3-2 shows the relationship between
throttle area and RPM for different free-stream velocities, and the larger the throttle area, the
more the RPM, but the slopes of every curve are not constant. When the throttle area is larger
than 80%, the RPM doesn’t increase as much as it does for smaller throttle area. This is the
nonlinear phenomenon of the engine. Fig. 3-3 shows the engine thrust for various velocities vs.
RPM. For the same throttle setting, the maximum thrust decreases as velocity increases, and for
the same amount of throttle area increment, the thrust increment is much smaller as velocity
increases.
1500 1510 1520 1530 1540 1550 1560 1570 1580 1590 1600
0
50
100
150
200
250
300
Time (s)
Altitude and Velocity
Altitude(m)
Velocity (km/hr)
3000
4000
5000
6000
7000
8000
9000
10000
11000
0 20 40 60 80 100
% Aarea
R
PM
Speed 0 m/s
Speed 10 m/s
Speed 15 m/s
Speed 20 m/s
Speed 25 m/s
Speed 30 m/s
To model the engine thrust under diferent circumstances, “advanced ratio” is introduced. The 
dimensionless “advanced ratio”, J, is defined as:
v
J
nD
 (5)
Where “v” is the free-stream velocity in meters per second, “n” is propeler rotating speed in 
RPS (revolutions per second), “D” is the diameter of propeler in meters. The airplane advances 
v/n after propeller rotates one revolution, thus the physical meaning of advanced ratio is the ratio
of the distance of the airplane “advances” to the propeler diameter. 
The thrust of engine can be characterized as the “thrust coeficient”. For a specific propeler, a 
specific engine, and a fixed advanced ratio, the thrust coeficient is a constant. The “thrust 
coeficient” is defined as 
2 4
T
Ct
n D
 (6)
Where “ρ” is air density, “T” is thrust of engine. Thrust Coeficient is a combination factor 
that combines the design of the propeller, the Advance Ratio J, and the Reynolds number of the
advancing blade. After some experiments, the thrust coefficient for different advanced ratio of
SWAN is obtained and is shown in Fig 3-4. The resultant engine thrust model is shown in Fig.
3-5. The engine RPM and free-stream velocity is the model inputs and is converted to advanced
ratio, then find the corresponding thrust coefficient, finally the thrust can be obtained.
Fig. 3-1 The altitude and velocity affect with each
other
Fig. 3-2 Relationship between throttle area and RPM for
different free stream velocity
Table 1 Reference flight conditions
Airspeed 80 km/h
Altitude 300 m
AoA -0.6 degree
Side slip angle 0 degree
Roll angle 0 degree
Elevator -1 degree
Rudder 0 degree
Aileron 0 degree
Table 2 Aircraft longitudinal derivatives
uX -0.0707
wX 0.27004
uZ -0.882
wZ -5.2855
uM 0
wM -2.1793
wM  -0.0814
qM -6.6027
e
X 0
e
Z 8.55121
e
M -89.072
Fig. 3-5 The engine thrust model
Fig. 3-6 The complete longitudinal simulation architecture
3.2 Velocity Controller of SWAN
The goal of the velocity controller is to accelerate from about 50 km/hr to 70 km/hr in 25
seconds and to maintain the velocity within 5 km/hr variation compared with desired velocity and
the altitude controller holds the altitude within 10 meters variations compared with desired
altitude.
Concepts of Velocity Control
The controlling of altitude and velocity via elevator and throttle together is the best way to
control the UAV under acceleration / deceleration or climb / descending motions. But it is hard to
design a MIMO (Multi-input Multi-output) controller. Thus the simpler SISO (Single-input
Single-output) control is considered first.
Throttle controls the energy of the aircraft, which means that throttle controls kinetic energy
(speed) and potential energy (altitude) of the aircraft. When a high thrust-to-weight ratio aircraft,
whose excess power is high, is accelerating, pitch angle changes a lot, and climb rate increases. In
such situation, throttle is used to control altitude. But for a low thrust-to-weight ratio aircraft,
whose excess power is low, in accelerating, the increase of pitch angle is slower and can be
compensated by the pitch angle controller, and thus the climb phenomenon is not clear. Therefore
for low thrust-to-weight ratio aircraft, control altitude via elevator and control velocity via throttle
is a better way. SWAN, whose sea-level thrust-to-weight ratio is only 0.61, is a low
thrust-to-weight ratio UAV, and it is better to control altitude via throttle and control altitude via
elevator.
Throttle regulates fuel / air ratio and controls power output of engine. At a given altitude, the
higher the RPM the higher the power output of the engine. For aircraft with a fixed pitch
propeller, the throttle controls the engine RPM. The proposed velocity controller block diagram is
shown in Fig. 3-11. The outer-loop calculates differences between desired airspeed and current
airspeed, and sends this value into PID (Proportional, Integral, Derivative) controller, then
controller calculates desired RPM difference, plus trim RPM, pass the RPM saturation limit, and
then send desired RPM into inner loop. The inner loop calculates the difference between desired
RPM and current RPM then sends this information into PID controller, controller calculates
desired throttle, pass through throttle saturation limit then send throttle command to the servo.
The reciprocating engine is a slow plant, therefore the speed variation is very slow after throttle
position changed, with the RPM-control inner loop, and the engine power output can be
200 220 240 260 280 300 320 340 360 380 400
-3000
-2500
-2000
-1500
-1000
-500
0
500
1000
1500
2000
Time
D
el
ta
rp
m
Measured and simulated model output
Flight test
ID result
-20 -15 -10 -5 0 5 10 15 20
-0.2
-0.1
0
0.1
0.2
Autocorrelation of residuals for output rpm
-20 -15 -10 -5 0 5 10 15 20
-0.1
-0.05
0
0.05
0.1
Samples
Cross corr for input rthr and output rpm resids
Fig. 3-9 Comparison between simulated RPM and
real flight test data
Fig. 3-10 Auto-correlation and cross-correlation
3.3 Flight test validation
Engine RPM control
To validate inner-loop RPM controller, a flight test took place on June 22, 2006. The
experimental processes included the pilot operations to control the UAV in low speed at a level
flight, and then engaged the autopilot in the mode of heading control, altitude control, and RPM
control. The trims of the control surfaces are: T_thr=80%, t_ele=3 degrees, t_ail=-0.5 degree,
t_rud=0 degree. Autopilot settings are: the desired altitude is 250 meters, the desired heading is 0
(north), and the desired RPM is 8000 RPM. The flight data is shown in Fig. 3-16 and 3-17. The
flight test results indicated that the RPM controller can maintain the engine RPM at desired
values. The settling time is 8.5 seconds (initially UAV is climbing), and oscillation in steady state
is found but it is mainly due to the tachometer noises.
Velocity Control
After the RPM controller was validated, the next flight was conducted to validate the whole
velocity controller. The date of experiment was still June 22, 2006 and the experimental processes
included the pilot operations to control the UAV in low speed at a level flight, and then engaged
the autopilot in the mode of heading control, altitude control, and velocity control. The trims of
the control surfaces are: T_thr=80%, t_ele=3 degrees, t_ail=-0.5 degree, t_rud=0 degree. And the
autopilot settings are: the desired altitude is 250 meters, the desired heading is 180 (south), and
the desired velocity is 70 km/hr. The flight data is shown in Fig. 3-18 and 3-19. The flight data
indicated that initially the aircraft is lower than the desired altitude, thus the aircraft is climbing,
which result in the decrease of velocity. Therefore, the velocity controller increased the desired
RPM thus increased the throttle to gain more power. When the altitude reached a steady state, the
altitude is maintained and the velocity controller also controlled the velocity within 3 km/hr
compared with the desired velocity. The velocity controller indeed meets the requirements.
1.686 1.687 1.688 1.689 1.69 1.691 1.692 1.693 1.694
x 10
5
2.5556
2.5558
2.556
2.5562
2.5564
2.5566
2.5568
2.557
x 10
6
Initial position
2D Flight Path in TM2 (2-degree Transverse Mercator) for WGS84
XTM2 Coordinate (Meter)
Y
TM
2
C
oo
rd
in
at
e
(M
et
er
) 755 760 765 770 775 780 785 790 795 800 805 810
5000
6000
7000
8000
Rpm vs. time
rp
m
760 770 780 790 800 810
60
70
80
A
sp
(k
m
/h
r)
750 760 770 780 790 800 810
0
50
100
OBC Time (sec)
R
C
sw
itc
h
an
d
rt
hr
real rpm
desired rpm
Fig. 3-16 Flight trajectory during engine RPM control Fig. 3-17 RPM and velocity response during engine
RPM control
Fig. 4-1 The United States’Local Area Augmentation System (LAAS) [16]
4.2 Current Landing / Recovery Approaches of UAVs
Typical landing profile of a fixed wing aircraft consists of the different stages. From the
cruise altitude, an aircraft will descend to a loiter altitude. Loitering nearby the airport, once the
runway is cleared for landing, the aircraft will enter the approach phase. During approach, the
aircraft flies in certain glide slope, a 3° glide slope angle for a commercial aircraft [17]. The
aircraft will fly in a curve trajectory during the flare phase, before touch down and taxi. The
phases that needed high accuracy navigation are approach phase and flare phase.
The Practical Landing / Recovery Approaches
Since UAVs are unmanned, eliminating the fatal risk of the crew, great varieties of methods
to land / recover a UAV have been developed. The proper landing method for a given UAV is
chosen mainly due to its size and mission. UAVs as large as the Global Hawk and the Predator
have no choice but to use the autonomous runway landing (Fig. 4-2 and 4-3).
To provide high accuracy navigation data during autonomous runway landing, the GBAS is
used. The widely used system is LAAS. Such method is efficient and accurate, but expensive.
Application of the Instrument Landing System (ILS) on UAV landing is possible for large UAVs
but it has never been tried. The reason is that using the ILS means landing can only be performed
in a well equipped runway, restricting the operation range of a UAV. Besides, the ILS is rather
obsolete.
Fig. 4-2 Predator Landing Fig. 4-3 Global Hawk Landing
The Novatel ProPack receiver (Fig. 4-9) was chosen to be the DGPS of ground station and
the AeroComm ConnexLinkTM 4790 (Fig. 4-10) was selected to broadcast the position
correction information to SWAN UAV.
Fig. 4-9 Novatel ProPack receiver Fig. 4-10 AeroComm ConnexLinkTM 4790
The Accurate Position Survey of Ground Station
This GBAS was setup near the runway of the flight field in Sigang, Tainan County, as shown
in Fig. 4-11 and 4-12. Before the application of DGPS, the accurate position of ground station
need to survey. And it will take long time up to 24 hours to survey the accurate position. The
accurate position survey was accomplished in 2008/03/17. The results of the ground station are
described bellow:
‧ Date: 2008/03/16~17
‧ Experience time: 24hour
‧ Position: 23.10577816601°N,120.21100401664°E
‧ Height: 6.189774319m (MSL)
‧ Standard Deviation: Latitude=10.71cm, Longitude=10.38cm, Altitude=23.33cm
‧ 2DRMS: 0.298m (receiver estimated)
‧ 2DRMS of last 4 hour: 0.1737m (from data)
Fig. 4-11 Sigang Flight Field Fig. 4-12 GPS Antenna of the Ground Station
In Fig 4-13 showed the 2D position trajectory of the accurate position survey proceeding,
one can see that the trajectory of the position converges to a small region in the figure. This result
is consistent with the standard deviation in Fig. 4-14. From Fig. 4-14, one can get the information
that the vertical standard deviation (Alt Std.) is larger then the horizontal standard deviation (Lat
and Lon Std.). This result reflects the well-known fact the horizontal dilution of precision (HDOP)
of GPS is better then vertical dilution of precision (VDOP) and this is due to the geometry of
meters. It shows that GBAS with DGPS can greatly improve the navigation accuracy near flight
field. From the standard deviation plots, whether the DGPS are engaged or not one also can see
the peak points which are caused by SV update.
Fig. 4-16 First Level Flight Path Standard Deviation Plot
without DGSP
Fig. 4-17 Second Level Flight Path Standard Deviation
Plot without DGPS
Fig. 4-18 First Level Flight Path Standard Deviation Plot
with DGPS
Fig. 4-19 Second Level Flight Path Standard Deviation
Plot with DGPS
5 The Implementation of Pseudo-Attitude for UAV
In practice, the attitude sensor is seriously affected by the vibration originated from the
engine. The vibration causes the measurement for the roll angle and the pitch angle to drift and be
inaccurate. Fig. 5-1 shows the attitude measurement data of the attitude heading reference system
(AHRS) which is collected from a flight test. In the flight test, the aircraft flied counterclockwise
and the pilot didn’t control the aircraft to roll right. It can be observed from the yaw angle.
Theoretically, the aircraft should only roll left. It means that the roll angle was supposed to be a
negative value, but the roll read from the sensor jumped irregularly. This problem causes the
The pseudo-roll is determined from the known aircraft acceleration ag and the gravitational
acceleration g as shown in Fig. 5-3. The force diagram in this figure shows an aircraft flying a
coordinated turn. Consequently, the pseudo-roll angle is determined as followed. First, a
pseudo-lift acceleration vector l
~
is defined as the vector difference of nga
~ and ng~ , the
components of ag and g perpendicular to the aircraft velocity vector vg, respectively. That is
nn
g gal
~~~  (15)
The tilde (~) is used to distinguish these quantities from the ones used in the synthesis of
attitude in wind axis. The pseudo-roll ~ is then determined as the complement of the angle
between the pseudo-lift vector and a local horizontal reference p~
)~~
~~
sin(
~
pl
pl
a

 (16)
where the local horizontal reference is defined by
g
n
g vgvgp  ~~ (17)
Fig. 5-2 Illustration of Pseudo-Attitude Fig. 5-3 Determination of Pseudo-Roll
5.2 The Combination of Pseudo-Attitude and Attitude Measured from
Gyroscopes
To synthesize the pseudo-attitude presented previously, we need to estimate the resultant
acceleration of the vehicle. The acceleration is estimated from the GPS velocity measurements by
means of Kalman filtering. Although 3-D acceleration is needed, it has been divided into three
individual components to reduce the dimensions of matrix. Too large matrix could be a burden
to the onboard computer.
In the process flow, the Kalman filter is used to estimate the acceleration so that it leads to a
lag problem when determining the attitude. Therefore, for compensating the lag disadvantage, the
gyroscope is used to provide the information of the angular rate. The pseudo-attitude and the
angular rate are synthesized as the attitude by the complementary filter. Fig 5-4 illustrates the
attitude determination system.
can login the onboard computer to execute programs or monitor the condition of the onboard
computer from the laptop of the ground control station via wireless local area network (WLAN).
Fig. 5-9 and Fig. 5-10 shows the PCM-3370 and the WLAN stick.
Fig. 5-1 System hardware architecture
Fig. 5-2 Onboard system configuration Fig. 5-3 Test vehicle-SWAN
Fig. 5-4 Onboard computer-PCM-3370 Fig. 5-5 WLAN stick
5.4 Result and Discussion
In order to verify the practical value of pseudo-attitude, two flight test was executed with the
fuzzy logic controllers in the Sigang flight field. In flight test 1, the original heading is
approximately 330 degree, and the desired heading is 90 degree. The original altitude is
approximately 180 meter, and the desired altitude is 150 meter. As shown in Fig. 5-15, the fuzzy
controller has the capability of maintaining the turn rate of 3.4 deg/s approximately and the
descend rate of 3.5 m/s.
In flight test 2, the desired heading is 270 degree, and the desired altitude is 150 meter. The
subject is to maintain the altitude during turning. As shown in Fig. 5-16, the error between the
altitude and the desired attitude is within 4 meter, and the mean error is approximately -1.1meter.
The heading is controlled smoothly to 270 degree with the turn rate of 4 .67 deg/s. The controller
holds the altitude well for the aircraft.
-100 0 100 200 300 400 500 600 700 800
0
100
200
300
400
500
600
700
800
900
1000
1100
GPS Position
N
(m
)
E (m)
0 50 100 150 200 250 300 350 400 450
-5
0
5
10
15
Sensor Data
Time (0.1 sec)
P
se
ud
o
R
ol
lA
ng
le
(d
eg
) Pseudo Roll
Desired Roll
0 50 100 150 200 250 300 350 400 450
-6
-4
-2
0
2
4
Time (0.1 sec)
P
se
ud
o
P
itc
h
A
ng
le
(d
eg
) Pseudo Pitch
Desired Pitch
0 50 100 150 200 250 300 350 400 450
0
100
200
300
400
Time (0.1 sec)
H
ea
di
ng
(d
eg
)
Heading
Desired Heading
0 50 100 150 200 250 300 350 400 450
140
160
180
200
Time (0.1 sec)
A
lti
tu
de
(m
)
Altitude
Desired Altitude
Fig. 5-15 The result of flight test 1
The results of flight tests examine the performance and the capability of the attitude
estimation system with the integration of pseudo-attitude and attitude measured from gyroscopes
by complimentary filtering. By applying the complementary filter, advantages of the
pseudo-attitude and the gyroscope are fused to attain better results. In the same time, both the
drawbacks of the pseudo-attitude and the gyroscopes have been diminished. For the rate
gyroscope, it always produces biased attitude after integrating the angular rate. The bias of the
integrated attitude could be unbounded and grows with time, and this is the main problem of the
gyroscope when used alone. Nevertheless, the gyroscope has higher bandwidth than the
considering both the vertical and horizontal safeties; it makes the flight path more credible. The
consideration of fuel consumption ratio and the post-processing make it possible to find a flight
path more comfortable or save more fuel without up-down moving frequently. Furthermore, for
satisfying any addible constraints which make the simulation more realistic, the cost function of
the DP method is allowed to be multi-variable and then easy to be implemented.
6.2 Conclusion on the Engine Speed and Velocity Controller Development
The longitudinal controller design and implementation for SWAN UAV is presented in this
report. The controller design is a typical controller design procedure and can be divided into 4
tasks: deriving model, design controllers, implement the controllers, and finally perform flight
test validation. Through this research, some significant conclusions can be remarked as:
1. Linear engine model is obtained from system identification method and nonlinear engine
models are obtained from several experiments. The linear model is used to design a
controller; while the nonlinear models are used for simulation and can simulate the engine
thrust and RPM under different free-stream velocity and aircraft responses under different
circumstances.
2. A 2-loop feedback altitude controller and velocity controller using PID control method has
been designed for the longitudinal motion. The outer loop of altitude controller converts
altitude error to desired pitch angle and fed it into inner loop. The inner loop controls pitch
angle via elevator. The outer loop of velocity controller converts velocity error to desired
engine RPM and fed it into inner loop. The inner loop controls engine RPM via throttle. Such
two-loop control scheme can monitor the engine RPM to sense the engine power output and
improve control efficiency.
3. The longitudinal controller design containing the velocity control and altitude control has
been successfully validated in flight testing. In steady state, the altitude control error is
within 4 meters and the velocity control error is within 3 kph from experiment data. This
shows the longitudinal controller indeed meets the requirement and improves the flight
efficiency of UAV.
4. After the longitudinal autopilot is added, combined with lateral controller, the autopilot
architecture for SWAN UAV is more complete. The complete autopilot architecture includes
altitude autopilot, heading autopilot, and velocity autopilot, therefore three axis of UAV, that
is, x-axis (velocity autopilot), y-axis (heading autopilot), and z-axis (altitude autopilot), is
under control and the UAV can carry out its missions autonomously.
6.3 Conclusion on the Implementation of Pseudo-Attitude
The study has shown the feasibility of an alternative approach to develop a low cost and
simplified attitude and heading reference system. Using the existing GPS receiver with single one
antenna could reduce the weight and complexity of the system, and also save onboard space that
is crucial for miniature unmanned helicopters. Moreover, the architecture with pseudo-attitude
might be simpler, more efficient, or more robust. It is simpler because no accelerometer is needed
if someone has no commercial AHRS and has to build one. It is more efficient because the
originally positioning sensor, i.e., the GPS, has been utilized as part of the attitude system in the
same time. If the UAV has equipped a commercial AHRS, the pseudo-attitude can still offer the
redundant attitudinal information that makes the overall system more robust.
可供推廣之研發成果資料表
□ 可申請專利 ■ 可技術移轉 日期：98 年 01 月 23 日
國科會補助計畫
計畫名稱：無人飛行載具(UAV)偵查監視自主飛行與導航(SWAN)
系統之研發(3/3)
計畫主持人：蕭飛賓 教授
計畫編號：96－2221－E－006－177－ 學門領域：航太工程
技術/創作名稱 無人飛行載具(UAV)偵查監視自主飛行與導航(SWAN)系統
發明人/創作人 蕭飛賓
中文：本計劃主要的技術如下: 使用動態規劃於飛行路徑規劃、研
發適用於小型無人飛行載具的引擎轉速控制與飛行速度控制、應用
GPS/DGPS 於 UAV 的飛行控制與導航、建立適用於 UAV 的陸基衛星
導航系統、將單顆 GPS 解算得到的虛擬姿態應用在 UAV 的導航控制
上
技術說明
英文：The major technologies of this project are as followed: the
development of dynamic programming in flight path planning, the
development of the engine speed and velocity control for small UAV,
the application of Global Position System (GPS)/ Differential GPS
(DGPS) in flight control and navigation for UAV, the setup of the
ground based augmentation system suitable for UAV, the implement
of pseudo-attitude based on single GPS receiver to the flight navigation
of UAV
可利用之產業
及
可開發之產品
具備視距外自主飛行能力的無人飛行載具
無人飛行載具速度控制器
姿態航向參考系統
陸基衛星導航系統
技術特點
動態規劃應用於飛行路徑規劃
適用於小型無人飛行載具的引擎轉速控制與飛行速度控制
應用 GPS/DGPS 於 UAV 的飛行控制與導航
適用於 UAV 的陸基衛星導航系統
虛擬姿態應用在 UAV 的導航控制
推廣及運用的價值
本研究獲得的各項成果將可應用至其他無人導航領域（無人水面/
水下載具、無人車、大學等級微衛星等等），尤其即時動態DGPS，
更提高各種無人載具的導航便利性，同時降低系統成本
※ 1.每項研發成果請填寫一式二份，一份隨成果報告送繳本會，一份送 貴單位
研發成果推廣單位（如技術移轉中心）。
※ 2.本項研發成果若尚未申請專利，請勿揭露可申請專利之主要內容。
※ 3.本表若不敷使用，請自行影印使用。
門只有一水之隔，感觸很深。中國學生比台灣學生普遍認真是不爭的事實，我們
學生確實應更加努力的。 
2. 廈大航空系恢復設系不到 20 年，許多設備與研究方向都沒有確立，經費不足
與校方不重視都是原因，就現況發展要與北航或是南航競爭，甚至到國際上評
比，仍有許多要努力的地方。 
四、攜帶資料 
 
無 
五、致謝 
本次行程補助由國科會補助，計畫編號 NSC 96-2221-E-006-177，特此致謝。 
 
門只有一水之隔，感觸很深。中國學生比台灣學生普遍認真是不爭的事實，我們
學生確實應更加努力的。
2. 廈大航空系恢復設系不到 20 年，許多設備與研究方向都沒有確立，經費不足
與校方不重視都是原因，就現況發展要與北航或是南航競爭，甚至到國際上評
比，仍有許多要努力的地方。
四、攜帶資料
無
五、致謝
本次行程補助由國科會補助，計畫編號 NSC 96-2221-E-006-177，特此致謝。
