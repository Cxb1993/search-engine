2行政院國家科學委員會專題研究計畫成果報告
Preparation of NSC Project Reports
計畫編號：NSC 95－2221－E－033－043－
執行期限：95年 8月 1日至 96年 7月 31日
主持人：宮大川 中原大學工業工程系 教授
一、中文摘要
本研究針對必須快速回應顧客、互相分享
資訊、有協同合作之必要之上下游企業；或遇
到產品特性為生命週期短、需求變動幅度大與
產品多樣性之創新性產品，發展一個協同規劃
預測補貨機制，以減少需求預測不準確、需求
變動頻繁、經常性庫存過多或缺貨等問題。並
且以影音事業當中的唱片公司與唱片行銷通
路為對象，規劃出唱片之銷售預測建議值、多
產品的訂購點與定購量之安排，期望能透過完
整的協同規劃預測補貨機制，提供唱片業者面
對難以掌握的市場時，可以精確的瞭解市場對
於唱片產品的需求，且在發生異常事件時擁有
即時回應之能力。
關鍵詞：音樂產業、創新性產品、銷售預測、
協同規劃預測補貨
Abstract
The objective of this research is to develop
a collaborative planning, forecasting, and replen-
ishment analysis mechanism for music record in-
dustry. The concerning areas are mainly on the
necessity of the collaborative between upstream
and the downstream or the inaccuracy of the de-
mand forecast, the frequency of the demand
changes, unable to control the sales of the short
life cycle innovation product. At the end, we also
argue the obtained result will be a good reference
to accurately control the uncertainly market and
quickly respond to the exception events for a mu-
sic record enterprise.
Keywords: Music record industry, Innovation
product, Sales forecasting, CPFR
二、緣由與目的
在全球資訊科技與網路快速發展下，市場
轉為高度競爭的環境，產品生命週期縮短，顧
客的需求導向更為重要，企業為了在快速變動
的市場中成長，在產品的生產上，必須持續創
新，符合市場環境、消費者偏好與社會價值系
統；在商業模式上，自 90 年代初期，供應商
管理存貨(VMI)和持續補貨等初步協同供應鏈
管理方法被證實具有效益後，敵對的企業關係
已慢慢減緩，取而代之的是協同合作商務時代
的來臨，而進階的協同合作概念之協同規劃預
測 補 貨 ， 即 CPFR(Collaborative Planning,
Forecast, and Replenishment)就由此而生。
CPFR[7]已經證實在許多產業有良好的功效，
但並不適用於任何的產業且有其限制，欲以完
整的 CPFR流程來套用於不同的產業，必定有
其困難之處，故本研究選擇以唱片產業為實證
分析對象。Aaker[6]認為唱片產業屬於熱門產
業(hit industry)，主要業務是取得、生產和利用
某一生命週期較短的產品，這也說明了音樂唱
片本身具有其特殊的性質，從產品製造面來
看，唱片的特性在於固定成本低、變動成本
高、具創新性、與科技有密切關係、以專案為
基礎(project-based)的網路關係、屬於時尚產
品、產品生命週期短等，但具備可重新組裝及
再次出售等特質；從消費面來看，唱片產品具
有可替代性低，無論是實際差異或心理差異，
每張流行音樂產品彼此之間皆不盡相同、市場
需求不確定性大等特性[1]。
唱片產業為影音事業中的一部分，且產品
類型以及資料分析所使用的因子相似，由於影
音事業產品市場資訊蒐集不易，所以本研究改
採唱片產業為例子。由於唱片產業範圍廣大，
針對其獨特性與問題點，本研究將問題界定為
上下游企業必須快速回應顧客、互相分享資
訊、有協同合作之必要，或遇到產品特性為生
命週期短、需求變動幅度大與產品多樣性之創
新性產品，造成需求預測不準確、需求變動頻
繁、經常性庫存過多或缺貨問題的企業，期許
能發展一套適用於符合以上問題特性的協同
規劃預測補貨機制，提供唱片業當中的唱片公
司與唱片行銷通路面對多變的市場時，可以精
準的瞭解市場需求，且在發生異常事件時擁有
即時回應問題之能力。
主要的研究目的有：(1)針對唱片產業特性
與作業流程，發展出一符合協同規劃、預測與
補貨之機制。(2)研析影響唱片在市場上的銷售
因子，建構唱片銷售預測模式，並發展銷售預
測調整模式，作為調整銷售預測值的參考值。
(3)根據協同銷售預測值，建構出一套協同訂單
規劃與補貨機制。期望透過 CPFR協同平台反
覆實行緊密的商務協調與互動，可以有效率且
及時的反應銷售預測值的改變，作為合作夥伴
雙方生產或訂購數量決策之依據。
4由於唱片具有生命週期短與市場需求不
確定性大兩大特性，為了達到充分掌握銷售精
準度的目標，在唱片公司與唱片行銷通路相互
分享資料後，本研究建立以下三銷售預測模式
作為唱片公司與唱片行銷通路之銷售預測建
議值，而受限於資料收集的困難，本預測模式
當中將考量口碑影響力、唱片銷售趨勢、歌手
等級、唱片類型與假日效應因素，以下將會介
紹模式中，各變數所代表的涵義：
1. 反應變數說明
ijn 代表為第 i張唱片在發片後第 j週之購
買人數。
2. 銷售因子說明
口碑影響力， ijN 為在發片後第 j週前購
買第 i張唱片的累積人數。Takada & Jain[10]
探討產品的擴散型態，發現高脈絡文化社會體
系(如東方國家)通常較集體主義，此時人際溝
通與口碑效果對於產品的採用相當重要；而低
脈絡文化社會體系(如西方國家)通常較個人主
義，此時刊物與大眾媒體對產品的採用說服則
較有效果。
唱片銷售量趨勢， ip 代表為第 i張唱片之
創新係數； iq 代表為第 i張唱片之模仿係數； i
代表為第 i張唱片之銷售量下降率。
唱片類型與明星等級， xAT 代表該唱片為
歌手之新專輯或精選輯，分別以 1AT 與 2AT 表
示之； ySR 代表該歌手之等級，分為十級，以
1SR 至 10SR 表示之。Ryan[9]曾指出為了降低不
確定性，音樂產業會採取強化消費者概念中的
「明星」價值，提供較高的預算或知名的製作
班底，因為明星較能保持一定的銷售量。
社會體系結構本質， im 代表為第 i張唱片
之市場潛量； i代表為第 i張唱片之首期銷售
量； zHD 代表唱片的發片日是否在重要假日，
1z為唱片發行當週為假日， 2z 為唱片發行
一個月內有假日， 3z 為無假日效應。產品銷
售量表現會隨著季節變遷或連續假日影響，如
冷氣機、飲料、電影等等，唱片也會有此效應，
如暑假時期與過年時間，因為消費者的生活習
慣會深深影響其購買行為。因此本研究加入假
日效應來探討產品的銷售情形。
3. 預測模型
模式一 Bass 擴散模式＋多變量迴歸模式
[1][2]
步驟一：使用統計軟體 SPSS之非線性最
小平方評估法，以直接數值搜尋方法中的
Gauss-Newton 法，估計出 Bass 擴散模式中協
同資料庫中各唱片在市場銷售的創新係數、擴
散係數與市場潛量三個參數。Bass連續型擴散
模式： ( )( )iij i ij i ij
i
q
n p N m N
m
   ，步驟二將步
驟一估計出的組新產品創新係數、擴散係數與
市場潛量估計值，構建出以下的迴歸方程式體
系(Systems of Regression Equation)，a、b與 c
為迴歸係數：
2 10 3 2 10
1 1 3 13 16
1 1 1 1 1
2 3 10 3 2 10 3
36 42 72
1 1 1 1 1 1 1
i x x y y z z x y x y
x y z x y
x z x z y z y z x y z x y z
x z y z x y z
p a a AT a SR a HD a AT SR
a AT HD a SR HD a ATSR HD
   
    
  
      
         
   
   
  
2 10 3 2 10
1 1 3 13 16
1 1 1 1 1
2 3 10 3 2 10 3
36 42 72
1 1 1 1 1 1 1
i x x y y z z x y x y
x y z x y
x z x z y z y z x y z x y z
x z y z x y z
q b b AT b SR b HD b AT SR
b AT HD b SR HD b ATSR HD
   
    
  
      
         
   
   
  
2 10 3 2 10
1 1 3 13 16
1 1 1 1 1
2 3 10 3 2 10 3
36 42 72
1 1 1 1 1 1 1
i x x y y z z x y x y
x y z x y
x z x z y z y z x y z x y z
x z y z x y z
m c c AT c SR c HD c ATSR
c AT HD c SR HD c ATSR HD
   
    
  
      
         
   
   
  
並以多變量迴歸方程式估計出整個體系的影
響係數，之後即可利用此迴歸模式預測出具有
不同銷售因子的新唱片之銷售預測值。
模式二 Exponential Decay 模式+多變量
迴歸模式，在李心嵐[2]的研究中提及 Krider
和 Weinberg 在 1998 年提出電影的每週票房
趨勢會服從一個 exponential decay 模式，即首
週票房為α且每週票房下降率皆等於1 e ，本
研究利用此模式來研究唱片的銷售預測值，並
將下降率作為之後調整銷售預測之參數。步驟
一：將過去的唱片資料建立出多個 exponential
decay 模式數學式，並以非線性最小平方評估
法估計出每張唱片迴歸式的 i與 i兩個參
數。第 j週票房 = ( 1)i ji e
  步驟二：將步驟
一估計出的唱片之與兩個估計值構建出
以下的迴歸方程式體系(Systems of Regression
Equation)，並以多變量迴歸方程式估計出整個
體系的影響係數，之後即可利用此迴歸模式預
測出具有不同銷售因子的唱片之銷售預測
值， e與 f為迴歸係數。
2 10 3 2 10
1 1 3 13 16
1 1 1 1 1
2 3 10 3 2 10 3
36 42 72
1 1 1 1 1 1 1
i x x y y z z x y x y
x y z x y
x z x z y z y z x y z x y z
x z y z x y z
e e AT e SR e HD e ATSR
e ATHD e SRHD e ATSRHD
    
    
  
      
        
   
   
  
2 10 3 2 10
1 1 3 13 16
1 1 1 1 1
2 3 10 3 2 10 3
36 42 72
1 1 1 1 1 1 1
i x x y y z z x y x y
x y z x y
x z x z y z y z x y z x y z
x z y z x y z
f f AT f SR f HD f ATSR
f ATHD f SRHD f ATSRHD
    
    
  
      
        
   
   
  
模式三 對數線性迴歸模式，將收集的唱
片資料的各期銷售量(Y)構建為同一個對數線
性迴歸模式，其模式如下，並利用非線性最小
平方評估法估計出每個因子的係數(β)，α截
距項。
61 3.322 logg m 
1 1
m m
i i
i i
Max A Min A
d
b
 
         
 
透過分好的組距與組數可繪製出次數分
配表，用來了解出現頻率最高之 ia ，利用組距
間中點的概念來決定新唱片相同類別之安全
庫存量設定如下式所示。其中， Gd 與 1Gd 表
示出現次數最多之間距。
1
1
10%
2
m
G G
i
i
d d
A 

  
步驟二：利用批量動態調整模式求得多產品訂
購點與訂購量
利用步驟一方法，可找到不同唱片分類之
安全庫存量設定值，在得知各類產品之安全庫
存量後，接下來就是利用批量動態調整模式考
量共同補貨之設置成本、採購單位成本、持有
單位成本、數量折扣緊急訂單以及因預測落差
過大造成產品生命週期結束後仍有過多庫存
而衍生的處罰成本，來決定各產品之訂購點與
訂購量之決策。相關假設、符號與模式列舉如
下：
模式基本假設：
1. 假設每個規劃週期需求率固定。
2. 規劃期間內，對於唱片公司產能限制不設
限。
3. 規劃期間內，對於發行通路商倉儲容量不
設限。
4. 不允許訂單後補狀況，意味著當缺貨情況
發生，會產生銷售損失。
5. 假設產品由唱片公司壓製運送到發行通
路商之前置時間為 1個週期。
6. 緊急訂單之產品前置為 0個週期。
符號說明：
i：產品項目數，任意 1,2,...,i m 。
j：有限規劃時間內週期數，任意 1,2,..., ij T 。
iˆjn ：產品 i在第 j期之預測需求量。
ijn ：產品 i在第 j期之實際銷售量。
S
ijI ：產品 i在第 j期期初庫存量。
E
ijI ：產品 i在第 j期期末庫存量。
S：設置成本。
c：單位採購成本。
oc ：緊急訂單單位採購成本。
h：單位持有成本。
P：單位處罰成本。
i：產品 i安全庫存之設定值。
ijSS ：產品 i在第 j期之安全庫存量。
a：產品訂購批量限制。
B：實際銷售量與預測銷售量誤差之容忍值。
n：數量折扣率， 1,2n 。
nq ：數量折扣範圍， 1,2n 。
  1 0
0
ij
ij
if X
X
otherwise



 
1
1 1 2
2 2
1 ij
ij ij
ij
for X q
f X for q X q
for X q


 
  
 
決策變數：
ijX ：產品 i在第 j期之生產批量。
批量動態調整數學模式：
 
   
 
2
1
1 1 , 0 0, 0
1 1 0
1 1
,
ˆ2 2
i
S E S E
ij ij ij ij
E i
i
S E STm
ij ij ij
ij ij ij
i j ijI I I I
m m
E E
i i o iT z BI
i i
Min C i j
I I I
X S h X c f X
n
I SS c I P

    
 

              
   

 
………………………………………………(1)
Subject to:
1 1 ˆ
E E
ij ij ij ijI X I n    …………………………(2)
1ij i jSS F LT   ……………………………(3)
ijX a ，a為任意正整數之倍數。…………(4)
E
ij ijI SS ………………………………………(5)
1 1
S E
ij ij ijI I X   ………………………………(6)
1 1
1
i i
i
R F
B
R
 …………………………………(7)
0ijX  ………………………………………(8)
  1 0 1,2,... ; 1,2,...
0
ij
ij i
if X
X i m j T
otherwise

  

……(9)
模式中(1)為目標函數，目的在求取固定週
期內多品項訂購點與訂購量之成本最小化問
題，考量產品採購所衍生出的設置成本、庫存
持有成本、每期訂購數量之單位採購成本、由
於實際販售狀況大於預測值所衍生的緊急訂
購成本以及產品在生命週期結束後庫存過多
所產生的處罰成本。(2)為需求平衡限制式，上
期期末庫存加期初訂購量減去期末庫存量會
等於當其需求量。(3)不同產品每期安全庫存量
之公式。(4)表示最小訂購批量限制式。(5)表示
在規劃期間內期末庫存需大於安全庫存設定
值。(6)期初庫存與期末庫存相關限制式。(7)
實際銷售量與預測值之誤差。(8)表示每期之訂
購量需為正整數。而(9)為二元變數，當 j期 i產
品之訂購數量大於零所衍生出的設置成本。
83.Aiko
0
50000
100000
150000
200000
250000
300000
350000
1 2 3 4 5 6 7 8
實際銷售值 模式一 模式二 模式三
4.湘南乃風
0
50000
100000
150000
200000
250000
1 2 3 4 5 6 7 8
實際銷售值 模式一 模式二 模式三
5.AI
0
50000
100000
150000
200000
250000
1 2 3 4 5 6 7 8
實際銷售值 模式一 模式二 模式三
圖 3 銷售預測值與實際銷銷售量對比圖
表 1 銷售預測模式综合比較
1 2 3
首週 APE 35.82% 9.63% 17.23%
首週 AD 42405.162 17879.83 20434.336
各週MAPE 173.48% 1797.54% 51.41%
各週MAD 13040.671 10786.6 8402.906
各週 RMSE 21017.346 13530.89 12278.404
總銷售 APE 37.42% 26.84% 23.08%
總銷售 AD 86048.662 63071.75 53051.56
經由表 1的觀察，三個模式的預測誤差總
和比較的觀察下，首先觀察在首週 APE與首週
AD 中，模式三為第二準確的預測模式，但不
論在各週與總銷售的五個預測指標下，模式三
仍表現出最小的預測誤差，故本研究選定模式
三為銷售量的預測機制。
3.5.3 執行階段
步驟一：找出相對應之安全庫存量設定值
為簡化說明，利用過往產品資料且分類等
級皆為：新專輯、歌手等級 2與無假日效應來
推估產品 AI 歌手之安全庫存量設定值。透過
實際銷售量與預測銷售量之差異可求出不同
產品之 TBM 值如表 2 所示，為了簡化此處只
舉一個產品來作說明。
表 2 TBM計算方式
藉由 k值的提升，相對應的 Recouped Lost
Sales與安全庫存數量變化如表 3所示。在此的
Recouped Lost Sales是針對安全庫存量的設定
所救回因實際銷售量大於預測銷售量所產生
的銷售損失，故當 k值不斷的增加，會因實際
銷售量與預測銷售量的數量差異而有一定的
限制。考量成本因素可得相對應 k=1.6 如圖 4
所示。
表 3不同 k值對應的 Recouped Lost Sales與安
全庫存數量之變化
0
2000000
4000000
6000000
8000000
10000000
12000000
14000000
16000000
0.0 0.4 0.8 1.2 1.6 2.0 2.4 2.8 3.2 3.6 4.0 4.4 4.8 5.2 5.6 6
lost profit recouped cost of carrying safety stock
圖 4根據 Profit Maximization決定 k值
以此類推可求出其他產品 k與 TBM 值，
透過標準化後並利用 Sturge’s Rule將資料分類
分群，選取出現次數頻率最高者，來當作未來
歌手 AI之安全庫存量設定值為 0.142。
步驟二：利用批量動態調整模式求得多產品訂
購點與訂購量
接續預測模式三之結果並根據步驟一求
出不同產品之安全庫存設定值再利用批量動
態調整模式，以決定多品項之訂購點與訂購批
量之決策。由於批量動態調整模式會依據實際
銷售狀況而有所變更，故透過基因演算法不斷
的演化以求出較佳的解，求出本範例成本最低
化較佳之解。而多品項之較佳訂購點與訂購批
量如圖 5所示。
