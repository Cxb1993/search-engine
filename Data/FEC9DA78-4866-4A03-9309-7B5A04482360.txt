proposed protocol is able to find the malicious sender’s cheating and ensure the
receiver’s privacy.
Keyword: Information security, Cryptography, Oblivious transfer, Verifiable,
Same message attack
一、 前言
隨著網路以及電腦技術的蓬勃發展，電腦及網路的普及，越來越多的交易與
資料傳輸發生在公眾的網路上，然而電腦犯罪的產生，暴露了網路上資料傳輸的
危險性，因此人們對於資訊安全越來越重視，進而對密碼技術要求也越來越高。
1981年Rabin[1]首先提出模糊傳送協定(Oblivious transfer)，並利用此一協定達成
交換秘密(Secret exchange)之目的。此一協定主要具有通訊雙方：傳送方S 及接
收方R，其中傳送方S 擁有一秘密訊息m，並且要以接收機率為1/2的方式傳送給
接收方R。而接收方R不想讓傳送方S知道是否接收到此一訊息。
隨後在1985年Even[2]等人提出另一型態之模糊傳送：2 選1 模糊傳送協定
(1-out-of-2 Oblivious Transfer)。在這個協定中，傳送方S 擁有2個秘密訊息m0、
m1，而且傳送方S 只要將其中1個訊息傳送給接收方R，另一方面，接收方R並不
想讓傳送方S知道其所獲得之訊息為何。此概念不同於Rabin 所提出之模糊傳
送，但從另一個角度而言，接收方R 接收到m0或m1的機率都是1/2，而且無論R 收
到的是m0或m1，他/她對另一個訊息是完全不知道的。
在2001 年Naor 和Pinkas[3]兩位學者提出有效能的模糊傳送協定(efficient
oblivious transfer protocol)，其中先提出2選1模糊傳送協定，然後再將其擴大應
用，並提出了一個n選1模糊傳送協定，此一協定允許傳送方S傳送n個訊息給接收
方R，而接收方R只獲得其中1 個訊息，並沒有辦法得知其他訊息。
另外Tzeng[4]也在同年提出一有效能的模糊傳送架構，其中也提出了n選1模
糊傳送架構，在這些n選1的模糊傳送協定中，傳送方S對於接收方R 所獲得之資
訊並不知情，而接收方R 亦無法得知其他傳送方S 所傳送之資訊。在Tzeng的架
構中，Tzeng並利用此一架構，提出利用平行處理的方式達成n 選t 模糊傳送。
訊息攻擊法，本計畫進一步研究並提出新型的「可驗證之模糊傳送協定」。在此
類型之模糊傳送協定，誠實的接收方R可以經由數學式的演算與比對來驗證傳送
方S是否使用傳送相同訊息攻擊給他，但又不影響其他模糊傳送協定的特性。
四、 結果與討論
相同訊息攻擊法之所以對以上四個協定得以攻擊成功，主要是因為接收方R
無法對傳送方S 所傳送之訊息加以驗證，這一點將與模糊傳送的其中一個特點—
傳送方的隱私互相矛盾，接收方R 只可以知道他/她所選擇的訊息，對其他訊息
並無法得知，因此要利用驗證傳送方S 所傳送之訊息，絕不可能直接利用訊息本
身，所以本計畫便從用來加密的金鑰著手，找出驗證之方法。
1. 修正Naor - Pinkas 之協定
我們修改Naor-Pinkas的協定以抵擋相同訊息攻擊，在此協定中傳送方的輸入
為 0 1,..., nm m 而接收方的秘密訊息為  0,..., 1n  。
圖 1：修正 Naor - Pinkas 之協定
其步驟如下：
步驟 一： ：傳送方S先選擇n-1 個亂數常數。 1 1,..., nC C 然後
計算 rg ，隨後將 1 1,..., nC C 與
rg 傳送給接收方R。
步驟 二： 接收方R選擇一個亂數k ，並計算 kPK g ，當α
證傳送方S 所傳送之訊息是否相同。因此吾人改進此一協定，使其具有可以驗證
傳送方S所傳送訊息是否相同的能力。
圖 2：修正 Tzeng 之協定
此一協訂依承Tzeng 的協定，協定中有三個系統參數( g，h，Gq )，Gq為一
秩為q的交換群，q為一大質數，g、h分別為Gq的生成子。另外還有一個單向雜
湊函數H，此處我們將H定義為一個Random Oracle。此一協定中傳送方S同樣擁
有n個秘密訊息m1，…，mn，接收方R擁有一秘密訊息  1,...,n ，步驟如下：
步驟 一：接收方R首先選擇亂數 qr Z 計算 ry g h ，並將y送
給S。
步驟 二：當傳送方 S接收到 y， S選擇一亂數 qk Z ，計算
2, , 1,...,
k k
i i ii i
y y
E m H V H i n
h h
                        
，
然後傳送方將 1, , ,
k
ng c c ，傳送給接收方R，其中
ci=(Ei，Vi )。
步驟 三：當接收方R 接收到 1, , ,
k
ng c c ，R首先取出cα=(Eα，V
α)並利用計算式子   rkm E H g   獲得m。
圖 4：修正 Kurosawa 和 Duong 之協定 - 傳輸階段
步驟 一： R首先選擇亂數 qr Z ，然後計算 iry g h ，並將y送給S。
步驟 二：當S 接收到y，S選擇一個隨機字串Ci，計算 jM 與 jV 其中
, ,
k
j j ijk
y
M m H C j
h
    
 
， 2 , ,
k
j ijk
y
V H C j
h
   
 
然 後 將
0 1, ,...,i nC E E 傳送給R，其中  ,j j jE M V 。
步驟 三：當 R 接收到 S 所傳送之訊息 0 1, ,...,i nC E E  ， R首先取出
 ,E M V   ，並計算  , ,i i r i im E H C     ，獲得 im。
步驟 四：當接收方R 獲得
i
m之後，驗證  ? , ,i r i iV H C   ，如果不
相等，表示傳送方S 沒有依照協定傳送正確的Vα，否則，如果相
等，接收方R 接著隨機挑選 1,...,l n ，且 l≠α，然後驗證
 ?l lV H M m  ，如果相等，則表示傳送方S 利用相同訊息攻
擊法欺騙接收方R。如果不相等，則可以確定傳送方S 並無利用
相同訊息攻擊。
五、 計畫成果自評
