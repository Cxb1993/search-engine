1 
 
生物玻片影像登錄與立體重構之研究 
 
陳淵琮2,傅耀賢3,黃信榮1,葉元傑1 
 
1崑山科技大學 數位生活科技所系 台南 台灣 
2崑山科技大學 資訊傳播系 台南 台灣 
3高雄醫學大學 生物醫學暨環境生物學系 高雄 台灣 
 
摘要 
過去傳統生物切片標本主要都是對生物中的器官或組織進行切片製作，但經解剖製
成玻片標本後同時失去整個生物體的立體原貌。另外利用3D電腦斷層掃描3D電腦斷層
掃描與立體重構技術，所建構之立體影像雖為精準但電腦斷層掃描的立體影像皆為黑白
灰階影像，對於生物解剖學習與教學上並不是非常適用。本研究透過生物快速冷凍包埋
技術與顯微切片製作生物玻片，在冷凍切片機中進行切片，並於切片過程中進行連續式
的切面影像擷取，其中所擷取之影像為真實彩色影像。執行上利用所擷取之連續影像進
行影像前處理、影像強化、影像分割、影像登錄、立體影像重構與成像。除此之外，本
研究建構一多樣化顯示模式，提供對於生物巨觀解剖構造之判斷、微觀組織形態與組織
之間的關聯性進而提高學習的效益。 
 
關鍵字:影像處理、影像登錄、立體重構、生物組織 
Abstract 
The traditional biological slides are meaning organ or tissue slides, and these slides are 
loss overall structure after dissection. In addition to 3D computer tomography and 
reconstruction technology use to construct object, although the reconstruct objects are best but 
these are gray object. This approach is not suitable for learning and teaching of biological 
anatomy. The research use of biological frozen technology and micro-slide technique captured 
continuous images that slice of biology. The captured images were true color image then 
using image preprocessing, enhancement, segmentation, registration and reconstruction to 
render. In addition, the research develop diversified display mode, it provided better learn for 
overall morphology and tissue structure, and improve the correlation of biological 
organization. 
 
Keyword:Biological slide, Color Image, Image Registration, Reconstruction, Biological 
tissue 
 
1. 前言 
 每一種生物影像因拍攝儀器之成像原理不同，所顯現出來的資訊則有著各種不同的
影像特性，單從生物影像中獲取的資訊往往非常有限，且有其硬體的限制條件存在，如
下圖(2)所示，例如電腦斷層掃描影像對於骨骼結構有較好的顯像能力，但對於生物軟組
織或是肌肉組織卻無法明確的顯示出來，而核磁共振影像特性恰好與電腦斷層影像相反，
它對於生物軟組織、血管與肌肉組織可以顯示出比電腦斷層影像較好的對比，但對於骨
骼結構的顯示卻變得比較不明顯。傳統生物切片透過防腐劑與染劑讓玻片更容易讓使用
者觀察學習，但由於切片技術的進步且目前有許多自動化處理系統製作具備一致性玻片，
另外透過冷凍固化的特性讓生物組織結構、顏色更忠實的保留下來；本研究透過生物冷
凍切片特性進行影像擷取，經由影像處理、登錄對位，重構出生物組織之彩色立體影像，
最後透過原生物體相關形體資訊進行評估。在執行上，生物影像資訊要隨著實際需求選
3 
 
以至無法還原出完整的生物資訊。因此本研究透過生物體組織切片影像來重構出生物組
織之立體影像。 
 
    在影像擷取過程中，由於各種環境因素造成影像不如預期：如偏移、比例大小變化、
溫濕度變化、冷凍包埋劑與切鋼刀磨損…等等相關因素，因此對於生物影像的立體建構
都需進行相關之影像處理，其中影像前處理的主要目的是用來消除影像上之雜訊；透過
邊緣檢測主要尋找相對應之生物體邊緣以去除切片影像中的冷凍包埋劑之背景來擷取
出生物影像；影像追蹤主要影像登錄利用特徵點進行距離編碼與特徵點對位，以消除影
像擷取過程中因不可抗力因素而造成的偏移，讓切片影像能夠重構出完整且正確的立體
資料。最後透過結合Web3D的呈現方式提供給使用者進行教學、觀察與實驗。 
2.3 Wed3D 與電腦醫學的關係 
     Web3D技術已經被應用於各個領域，虛擬現實、三維仿真、它在醫學方面也作出
了突出的貢獻。通過Web3D技術可以建立虛擬的人體模型，借助於各種輔助工具，學生
可以更容易的了解到人體內的各個器官和結構。在國外也透過Web3D技術來進行虛擬外
科手術模擬和遠程醫療。通過虛擬外科手術模擬其實就是一種虛擬手術，即利用各種醫
學影像數據和虛擬現實的技術在電腦中建立一種虛擬的環境，然後在虛擬的環境中完成
手術，對於複雜的手術，可以提前規劃、模擬，有效的減少了手術中的危險發生，這項
技術的發明對於訓練沒有經驗的醫生來講也是非常重要的。它的另一個比較重要的應用
就是遠程醫療，即通過突破了傳統的面對面的醫療模式，醫生在外地就可以通過 Web3D
技術傳遞信息來醫治病人，這使得高水平的醫療服務能夠在更廣泛的範圍的得到享受，
同時也能夠提高其他人員的視野和經驗。把web和虛擬技術結合起來完成遠程手術，使
一些專家在外地出差也可以進行手術的指導等，手術後還可以指導一些病人的生活恢複
狀況等。 
2.4 最大 RGB 值法 
    假設影像中一定有白點存在，白點的定義為RGB 三通道值總和最大的點，再將此
白點校正成純白（255, 255, 255），其它顏色也隨之調整。做法是以此白點當做估計光源，
再以近似von Kries 的色適應模型調整影像，公式如下：。 
 
 
 
其中，  Rmax 、 Gmax 、 Bmax 為整張影像三通道最大值，R、G、B 為影像像素，
R'、G'、B'為調整後三通道像素，k 為調整參數。 
2.5 影像分割 
影像分割是利用演算法找出最適合的臨界值(Threshold Value) ，將影像區分成目的
物以及稱為背景之其它物體。一般是根據影像的灰階特性，進行統計與分類以得到一幅
稱為直方圖的灰階統計圖，因此直方圖又稱為灰階統計圖。根據直方圖中像素灰階的分
佈情況，可以得知影像的相關性，作為分割的參考技術發展至今，至今已三十多年的歷
史。自從L.G. Roberts於1965年推出著名的Roberts Cross Operator以來，影像切割相關的
研究與技術開發仍然不斷的在進行，每年也有無數的演算法被發表於世。影像切割主要
可以區分為四大類：Thresholding、Edge-Based、Region-Based和Watershed等四種方法。 
5 
 
 
雜訊過濾 
與影像切割 
影像座標轉換虛擬空 
間座標與顯示 
影像增強 
影像對位與裁切 
影像擷取 
圖6 研究流程圖 
 
光達座標體系下的三維座標以及點位的反射值，或稱強度值(Intensity)，強度資訊的獲取
是雷射掃描儀接受裝置採集到的回波強度，將每個掃描點的回波強度進行正規化之後所
得到的數值即為強度值，用以代表掃描點位的反射強度。通常強度值範圍為0~255，數
字越大回波強度越強。此強度資訊與目標的表面材質、粗糙度、入射角方向，以及儀器
的發射能量、雷射波長有關。一般而言，點雲資料內容為(X,Y,Z,I)。此種資料在展示平
台上所呈現的點，顏色為漸層的灰白色，如下圖所示：。 
 
圖5 光達點雲示意圖 
 
3. 研究方法 
3.1 研究流程 
影像擷取過程中許多外力因素而造成影像中的資訊不連貫等皆會影響影像重構後
之精確性，故須針對來源影像作一系列影像處理，下圖為本研究針對來源影像處理流程，
在此先對本研究個步驟簡單說明之。 
 
步驟一、是將生物體經過麻醉後以製冷機與冷凍包埋劑來固定生物體型態，並在冷凝劑
的邊緣置入自動鉛筆筆芯以作為影像對位之標記點。再透過數位單眼相機以及生物冷凍
切片機來擷取高畫質生物切片序列影像。 
 
步驟二、透過影像中標記位置差異獲得影像偏移值來進行影像對位，再經手動輸入裁切
參數進行批次裁切後取得用於建構的生物切片影像。 
步驟三、將前後兩張影像進行影像平均取得新的影像以得到影像強化的效果。 
 
步驟四、使用 Otsu 的最佳臨界點節取技術取得最佳閥值，再結合 Canny 邊緣切割演算
法來設計一濾波器去除藍色膠背景得到生物體本體的物件重構影像。 
 
步驟五、將步驟四中所得之影像轉換為虛擬空間座標與座標色彩資訊並透過套件來呈現
重構結果。 
 
 
 
 
 
 
 
 
 
 
 
 
7 
 
 
 
    將影像中標記物之區域取出後，透過公式A與公式B來進行水平方向與垂直方向的
灰階像素累加 
 
 
 
圖 10 標記影像示意圖 
 
    透過統計出垂直與水平灰階像素累加最大值來找出其垂直中心線與水平中心線，並
取得兩直線之交點座標，如上圖10所示，將序列影像中的水平線與垂直線交會點與前一
張影像的交會點座標座比較，若比對影像與參照數值有差異，程式便會將影像先往X軸
方向校正後在往Y軸方向校正，每次校正量為1 像素，值到座標與前一張一樣為止。 
 
    影像對位完成後，再經由人工輸入裁切參數之後對影像進行批次裁切。透過人工方
式選擇裁切範圍可以更準確的裁切出用來重構的影像，且不受來源影像中的物件限制。
而本研究有別於傳統在影像前處理之前先進行影像對位步驟的原因是因為本研究所採
用的方法是透過額外置入的對位標記，來進行影像對位。因標記本身較難因為外力因素
影響且也不需要透過影像中的生物體特徵來進行對位，故透過這種方法可以有效提高對
位的準確率與效率，但由於標記本身會對本研究後續影像處理步驟之結果產生若干之影
響，為避免重構完成之結果造成影響，所以在影像對位之後則對其結果進行裁切，透過
手動輸入裁切數值將影像邊緣以及對位標記等對之後影像處理以至於重構沒有幫助的
部分去除，以提高後續影像處理步驟之效益。 
3.4 影像增強 
 為了使切片影像在影像切割的時候能夠取得更準確且完整的結果，且在影像擷取
過程中，切片會因為溫度回升而造成沾黏、所使用的刀片也伴隨著使用次數越多而使得
銳利度下降，使的切片上會產生刀痕，擷取設備也因為外力因素而產生雜訊，而雜訊對
於重構結果之影響是為莫大。故針對前一節中裁切之後的影像做影像增強： 
本研究採取影像平均方式來實現影像增強，將連續玻片影像 G1(x,y),G2(x,y)互疊加
後取平均而形成一幅新的影像 G(x,y)，即 
G(𝑥, 𝑦) =
𝐺1(𝑥, 𝑦) + 𝐺2(𝑥, 𝑦)
2
 
其中假定在每一對座標(x,y)處雜訊互不相關且具有零平均值，透過將先後兩個影像
9 
 
Points.js 儲存影像之虛擬空間座標陣列 
Colours.js 儲存虛擬空間座標點之色彩陣列 
表2 套件之各部件功能表 
     由於套件設計的方式，儲存於 Points.js 的座標資料之解析度最大上限位階為二十四
位階，而我們在座標轉換時為了保留緩衝空間，於是我們的轉換位階選擇為二十位階，
至於儲存於 Colours.js 中的顏色資料格式為 RGB 三種色系，其範圍為 0~255 之間。 
    透在前一小節中，經過影像切割之後的影像並無法直接透過套件來完成重構，需將
影像空間座標域轉換至虛擬座標系統，下圖11為影像座標轉換流程圖，首先將圖檔載入
後分析其解析度，接著擷取影像作標以及Pixel Data，將每一個Pixel Data中，紅色的係
數未大於50的Pixel過濾，而剩下來的Pixel透過下列公式C來進行座標轉換： 
 
[
 
 
 
 
 
𝛼
𝑥⁄
2
+ 𝑑
𝛽
𝑦⁄
2
+ 𝑑
𝛾
𝑧⁄
2
+ 𝑑]
 
 
 
 
 
= [
𝑥′
𝑦′
𝑧′
]---------------------------公式 C 
 
x、y、z為來源影像之解析度 
α、β、γ為虛擬空間之x、y、z軸之最大值 
x'、y'、z'為虛擬空間座標  d為位移補償 
 
     
經過座標轉換公式轉換之後將所得的虛擬座標陣列儲存於Points.js中，並在座標轉換過
程中，同時取出座標點的色彩資訊並且將座標的色彩資訊陣列儲存至Colours.js中，座標
資料與色彩資料儲存格式如下圖12： 
 
 
圖11座標轉換流程圖 
 
圖12座標資料與色彩資訊儲存格式示意圖 
11 
 
 
表4 影像分割前後結果比較表 
    表 5 是從序列影像中抽取出來之兩組影像分割前後的影像比較表，透過座標轉換之
資料量可以發現到，演算法中採用高斯平滑濾波器也來過濾雜訊，並透過影像分割之技
術將藍色背景去除以取得生物體本身之影像，減少了背景對於座標轉換結果之影響，單
純轉換生物體本身影像之資料點，能夠使得套間在重構出生物體之結果更為有效率且精
細準確。 
 
表5 影像分割前後結果比較表 
4.3 影像空間座標轉換虛擬空間座標與顯示之成果 
     將影像分割完之後的影像轉換成虛擬空間座標，我們可以得到完整序列影像的虛
擬空間座標以及座標點的顏色資訊總共 195436 筆，下圖為部分截圖： 
13 
 
Radiotherapy, Radiosurgery and Threatment Planning(Medical Science), Taylor & 
Francis, January 1993 
[2] J. F. Canny, A computational approach to edge detection. IEEE Trans Pattern Analysis 
and Machine Intelligence, 8(6):679-698, Nov 1986. 
[3] P. A. van den Elsen, E-J. D. Pol, and M. A. Viergever, “Medical image matching - A 
review with classification,” IEEE Eng. Med. Biol., pp. 26-38, Mar, 1993 
[4] J. B. A. Maintz and M. A. Viergever, “A survey of medical image registraction,” 
Medical Image Analysis, vol. 2, pp. 1-36, 1998. 
[5] N. Otsu. A threshold selection method from gray-level histograms. IEEE Transactions on 
Systems, Man Cybernetics, 9(1):62-66, 1979. 
[6] T. J. Fan, G. Medioni, and G. Nevatia, “Recognizing 3-D objects using surface 
descriptions,” IEEE Trans. Pattern Recognit. Machine Intell., vol. 11, pp. 1140–1157, 
Nov. 1989. 
[7] D.-S. Jang and H.-I. Choi, “Active models for tracking moving objects, ”Pattern 
Recognit., vol. 33, no. 7, pp. 1135–1146, 2000. 
[8] S. Wesolkowski, “Color Image Edge Detection and Segmentation: A Comparison of 
the Vector Angle and the Euclidean Distance color Similarity Measures, ” Master’s 
thesis, Systems Design Engineering, University of Waterloo,Canada, 1999. 
100 年度專題研究計畫研究成果彙整表 
計畫主持人：陳淵琮 計畫編號：100-2221-E-168-027- 
計畫名稱：生物玻片影像登錄與立體重構之研究 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 2 2 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 2 2 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
