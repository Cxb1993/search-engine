  
以及批次良率為目標變數進行良率分析。然而利用迴歸樹與批次製程資料進行分析，在少量
多樣化生產的環境之中，由於良率的變異性較大且良率目標的製程資料有限的狀況之下，
直接使用利用迴歸樹參數分析有可能無法直接找出製程參數的目標值。因此，本研究將針
對在少量多樣化生產、有限的製程參數模型及建置時間環境下，利用 決策分類樹
(Classification Tree)演算法，迅速針對決策規則修改製程參數範圍，以找尋到 CNC 製程中最
佳良率。 
2.  背景知識 
Cover Lens 為觸控面板的主要元件之一，但大部份的供應商為過去傳統產業手錶玻璃
或眼鏡玻璃的生產者轉型而成，而這兩大生產者大部份集中在中國大陸深圳與蘇州等地，
而本研究以國內最早投入 Cover Lens 研發生產的國內廠商葛雷思光學在蘇州的 Cover Lens
廠為主要研究對象。本研究針對位於中國大陸蘇州的台資企業工廠 Cover Lens 廠內 CNC
的玻璃切割製程所提供玻璃切割生產資料集進行分析探討。 
2.1 CNC 璃璃切割製程簡介 
本研究所採用的玻璃 CNC 機台是由一組電腦控制下由可替換刀頭的一個加工模組所
組成。CNC切割 原理是利用鑽石刀或烏剛刀頭的硬度比玻璃高，由高轉速碼達帶動刀輪產
生對玻璃的分子衝擊，使玻璃分子經由碰撞產生分裂，使玻璃體表面分離，倘 若 刀 輪 與 輪 軸 
轉 速 配 合得宜，使得玻璃固體表面分離平整則為直線切割，若玻璃體表需產生除直線以外之
線條或者為孔狀的外觀，統稱為異型切割。而直線切割因速度容易控制在加工上斷面平整，
而異型切割不論刀輪速度或刀頭選擇都比直切斷需要更精確的參數調整才能生產外觀斷面
平整的產品。(圖一為本研究所使用的玻璃 CNC 異型切割機)。 
CNC 切割機台的任務是在玻璃基板上依照治具及 Auto CAD 所輸出的資料，將 CNC
機台中的玻璃窗基板切割成外型與治具相同的外觀。而本研究案例中，將CNC-1和 CNC-2
兩部機台模組分別為置放不同的切割工具。其中，CNC-1 提供了鑽石刀頭及人工鑽石刀頭
兩種不同的刀具，可分別提供玻璃切割。而 CNC-2 則提供了烏剛刀為單一切割刀具。在產
品切割製程中首先將玻璃母片使用開料 CNC 做直線切割，而每張玻璃母片為
370mm*470mm，本次研究以 3.5 吋基板為研究樣本。每張玻璃母片可裁成 12 小片再將 12
小片分別提供給 CNC-1 及 CNC-2 依續放入 CNC 切割機進行外觀製程及開洞製程，而在製
程中玻璃基片放置及拿取皆由人工控制，並非全線自動化製程，而 CNC 轉速及母片夾壓
力調整部份由 CNC 電腦調控，亦可使用人工調控夾片，而製程現場並非在無塵室完成，
而 CNC 切割機的外門僅為單純隔音及防塵使用。 
 
  
在建立分類模型之前必須先指定所要觀察的類別屬性。決策樹演算法是一種簡單但卻廣泛
使用的分類技術。 
2.3.1 決策樹演算法 
決策樹是一棵樹，樹的根節點是整個資料集合空間，每個分節點是對一個單一變數 的測
試，該測試將資料集合空間分割成兩個或更多塊。每個葉節點是屬於單一類別的記 錄。首
先，通過訓練集生成決策樹，再通過測試集對決策樹進行修剪。決策樹的功能是 預言一個
新的記錄屬於哪一類。而決策樹的建構過程是通過遞迴分割的方式，其步驟如下： 
 
1. 尋找初始分裂，整個訓練集作為產生決策樹的集合，訓練集每個記錄必須是已經 分
好類的。決定哪個屬性（Attribute）域作為目前最好的分類指標。一般的做法是窮
盡所有的屬性，對每個屬性分裂的好壞做出量化，計算出最好的一個分裂。量化的
標準是計算每個分裂的多樣性（diversity）指標 GINI 指標。 
2. 樹增長到一棵完整的樹，重複第一步，直至每個葉節點內的記錄都屬於同一類。 
3. 資料的修剪，去掉一些可能是 Noise 或者異常的資料。 目前常見的決策樹演算法
及比較整理如表 1。 
 
表 1  決策樹的比較 
演算法 資料屬性 分類/迴歸樹 分割規則 修剪樹規則 
ID3 離散型資料 分類樹 Information Gain No Pruning 
C4.5 連續型資料 迴歸樹 Information Gain Predicted error rate 
CHAID 類別資料 分類樹 Ghi-Square test No Pruning 
CART 連續型資料 分類迴歸樹 Cini index Entire error rate 
2.3.2 決策樹的分類－分類樹與迴歸樹 
決策樹在資料處理型能上可區分為分類樹和迴歸樹兩種，分類樹對離散變數做決策樹，
迴歸樹對連續變數做決策樹。 
分類樹的目是一種用於類別預測（Class  prediction）的決策樹。其應用於一個歷史 資
料且在此歷史資料中存在一個已知的離散型資料為分類目標，利用分類樹可建立分類 模型。
利用此分類模型可以用於預測包含新屬性值的記錄的分類。分類樹的分類模型對 資料的基
本分佈提供了簡明的描述，基於大型資料庫中屬性個數和訓練例子數，該演算 法能很好地
進行換算。 
迴歸樹是一種用於數值預測（Number  prediction）的樹就像普通的決策樹，但在樹 葉
節點所儲存的是代表樹葉節點的預測數值平均值。迴歸樹是由 Breiman 等(1984 年)在 
CART 中介紹的。通常在使用 CART 進行料分析時，可將資料屬性分為連續型與離散型兩
種，連續型資料可應用於預測，而離散型資料則可應用於分類。換言之，CART 能同步處
理連續型與離散型資料；而在其處理連續型資料時所使用的演算法為迴歸樹，而處理離散
型資料時則使用分類樹。這與 C4.5 很像，但 C4.5 是 Quilian(1993)改善其所發展出來的 
ID3 演算法，主要改進的是 ID3 不能處理連續型數值的問題。 
  
 
了解生產製造問題 
 
定義良率與缺陷 
 
確認 
定義 
 
 
確認良率與 
缺陷改善 
 
檢視目前生產資料 
 
檢測不良率與缺陷
可能發生問題 
 
確認是否為可分析
資訊 
 
設計分析變數 
 
資料預處理 
 
建置決策規則 
 
決策規
則解讀 
 
建立決策規則 
資料庫 
 
選擇其他欄位 
建置規則 
 
建立規則資料庫 
 
更新企業產品 
製造模型 
 
圖2 研究架構圖 
  
 
定
義
資
料
探
勘
流
程 
  
表 2.  玻璃切割參數欄位 
欄位類型 欄位名稱 
玻璃批號資料 
批號 
製程式號 
製程名稱 
啟始人員 
完成人員 
投入數量 
報廢數量 
產出數量 
投入時間 
產出時間 
所花時數 
機台名稱 
報廢原因 
備註 
缺陷資料 
批號 
玻璃編號 
製程式號 
缺陷原因 
玻璃測試片資料 
玻璃外觀精度公差 
崩口值(Å)_L1（CNC-1 崩口值） 
崩口值(Å)_L2（CNC-2崩口值） 
玻璃產品標準資訊 
崩口值(Å)_L1 標準值範圍 
崩口值(Å)_L2 標準值範圍 
 
 
 
 
製程機台資料 
刀輪維護日期 
刀輪位置 
刀輪剩餘厚度 
轉速功率 KW值 
功率 1(±5%)kw（CNC-1 第1  組轉輪） 
功率 2(±5%)kw（CNC-1 第2  組轉輪） 
功率 3(±5%)kw（CNC-2 第 1 組轉輪） 
功率 4(±5%)kw（CNC-2 第 2 組轉輪） 
鑽石刀頭 CNC-1（ 機台氣體流速電壓） 
鑽石刀頭 CNC-2（ 機台氣體流速電壓） 
烏鋼刀頭CNC-1（機台氣體流速電壓） 
烏鋼刀頭CNC-2（機台氣體流速電壓） 
Speed (±1%)m/m(載台速度) 
  
 
表 3.  製程生產管理資訊(一) 
 
表 4 .  製程生產管理資訊(二) 
批次 
號碼 
鑽石刀頭 
CNC-1 
鑽石刀頭 
CNC-2 
烏鋼刀頭
CNC-1 
CNC-1鑽石輪
KW 
CNC-1烏鋼輪
KW 
 
CNC-2鑽石輪
KW 
CNC-2烏鋼輪
KW 
 
1810005 106 125 62/53 1866 1234 1856 1978 
1810006 106 125 62/53 1263 1964 1467 2583 
1810007 106 125 62/53 1358 1064 1498 1758 
1810039 140 95 37/80 1688 1386 2013 2850 
1810041 140 95 37/80 1578 1454 2495 3279 
 
除此之外，統計製程管制系統所記錄的相關資料則如表 5 所示。 
 
 
 
 
 
批次 號碼
(LotNo) 
投入時間 產出時間 功率 
1 
功率 
2 
功率 
3 
功率 
4 
輸入 
數量 
缺陷 
數量 
輸出 
數量 
1810005 2010/11/25 
08:26:30 
2010/11/25 
12:50:19 
3.5 2.65 4.28 3.5 185 3 182 
1810006 2010/11/28 
14:23:21 
2010/11/28 
17:48:59 
3.5 2.65 4.28 3.5 195 9 186 
1810007 2010/11/29 
21:22:01 
2010/11/29 
02:14:05 
3.5 2.65 4.28 3.5 179 8 171 
1810039 2010/12/03 
16:43:26 
2010/12/03 
19:53:46 
3.5 2.68 4.39 3.98 179 20 159 
1810041 2010/12/10 
16:31:47 
2010/12/10 
21:54:50 
3.5 2.68 4.39 3.98 213 25 188 
  
表 6-1 轉換後資料(一) 
 
表 6-2.轉換後資料(二) 
 
透過上述的方式將少量的製程資訊，得以原始以批次為基礎資料型態轉換成實際通過
製程的玻璃片數。其優點在於將資料筆數放大到足以利用決策樹進行分類運算，除此 之外，
分析資料也會因為處理良率變異較大所產生，使得實際進入每個製程階段的玻璃 數量的變
異也較大。使雖有相同的良率，但因實際進入製程數量的不同而有不同的意義。而這個問
題也會在透過將資料經由轉換成較低階的玻璃資料得到部份修正。如前所述以往在進行良
率提昇的研究中，大多是利用各別製程階段的良率來產生各別製程階段的良率模型建置。 
 
玻璃號碼 
(Class  No) 
批次 號碼 
(Lot No) 
批次同日生產 工作時間 投入 
速 度 
 
功率 1 
 
功率 2 
 
功率 3 
 
功率 4 
缺陷 
原因 
181000501 1810005 Y 263 3.34 3.5 2.65 4.28 3.5  
181000502 1810005 Y 263 3.34 3.5 2.65 4.28 3.5  
181000503 1810005 Y 263 3.34 3.5 2.65 4.28 3.5  
     3.5 2.68 4.39 3.98  
181000543 181005 Y 263 3.34 3.5 2.68 4.39 3.98 白霧 
     3.5 2.65 4.28 3.5  
181000579 1810005 Y 263 3.34 3.5 2.65 4.28 3.5 白霧 
1811000601 1810006 Y 263.4 3.47 3.5 2.65 4.28 3.5  
玻璃號碼 
(Class  No) 
批次 號碼
(Lot No) 
鑽石 
刀頭 
CNC-1 
鑽石 
刀頭 
CNC-2 
烏鋼刀頭
CNC-1 
CNC-1 鑽
石輪 KW 
CNC-1 烏
鋼輪 KW 
 
CNC-2 鑽
石輪 KW 
CNC-2 烏
鋼輪 KW 
 
良率 
旗標 
181000501 1810005 40 100 60/55 1366.3 1034.9 1757 1976.5 Y 
181000502 1810005 40 100 60/55 1366.3 1034.9 1757 1976.5 Y 
181000503 1810005 40 100 60/55 1366.3 1034.9 1757 1976.5 Y 
         Y 
181000543 1810005 40 100 60/55 1366.3 1034.9 1757 1976.5 N 
         Y 
181000579 1810005 40 100 60/55 1366.3 1034.9 1757 1976.5 N 
181100061
1 
1810006 40 100 60/55 1283.7 928.9 1567.8 1525 Y 
  
製程階段
良率旗標
Y:458
N:169
平均良率 75%
製程階段
良率旗標
Y:1639
N:192
平均良率 89.5%
製程階段
良率旗標
Y:2097
N:361
平均良率 86%
製程階段
良率旗標
Y:836
N:130
平均良率 85.6%
製程階段
良率旗標
Y:803
N:31
平均良率 96%
批次生產當日完成批次生產隔日完成
工作時間 >=180 工作時間 <180
 
圖 3 分類樹良率分析---工作時間 
 
首先圖 5 是針對第一次切割製程階段，分析同一批次可以階段處理的時間。圖 5 分 
類樹第一個分支的意義，若一批次在切割製程階段發生跨日生產時，則此切割製程會較 差。
此規則說明若批次已進入了切割程階段，則必需於當日完成切割工作，若將批次放置至隔
日才完成切割，則可能發生污染等問題，而造成良率的損失。因此，此規則可設定為製程
良率分類規則的反向規則。 
If  切割跨日處理   
then  良率預測=75% 
除此之外，此分類樹建立了一個反向的規則之外，另一個分類樹分支可建立一個正 向
分類規則。 
If  切割同日處理 and  工作時間  < 180 
then  良率預測=96% 
  
而所建立的反向規則如下： 
 
If  功率 1 <= 3.524 and CNC1 Ti 功瓦小時  >= 258 
Then  良率預測為 56.2% 
If 功率 1 Between 3.524 and4.281 and CNC1 Ti 功瓦小時  >= 687.3 
Then  良率預測為 75.2% 
本研究經由上述的步驟將有效找出影響玻璃切割製程良率的重要因子，並建
立製程良率的正向規則與反向規則。且案例工廠中，其生產的型態是以少量
且多樣的方式進行，透過本研究的獲得玻璃切割製程參數上的分析成果，進而協
助製程工程師找出於真實的生產線上影响良率的重要因子。 
 
5.  結論與未來研究 
近年來光電產業在產官學的大量投資之下，已經成為現今快速發展工業的主
流產業 之一。在此情形之下，如何能夠加速投入資金的回收是業者所關注的議
題。工廠如果無法以大量生產方式進行量產，就必須以少量且多樣化的方式進行
市場劃分。在此多重生 產壓力環境之下，部份的工廠必需能夠以多樣化產品、速
度投入量產，以及快速建置以高良率的製程模型等方式才能在此環璄下生存。然
而在此類型的生產模式架構之下，往 往不見得有大量且完整的製程資訊可供收
集與分析。本研究所提之分析架構與方法，提 供一個良率改善有效的分析流程，
其主要特點如下： 
 能在少量的資料筆數下建立模型。 
 在不同欄位發生的缺漏值時，同樣能夠建立模型。 
 建立明確且清晰的良率模型。 
 快速提供製程良率改善模型架構。  
未來研究則考慮將缺陷類型與製程參數，先行建立相關的缺陷發生原
因類型叢聚後，再進行製造模型良率改善分析，藉此提昇分析的準確度。此外，
在本次研究中發現分類樹進行分類時，會產生不相關值與遺失分支的問題，而
此問題會增加利用反向規則監控異常現象的成本與難度。同時發現，部份分類
樹的分支並未包含所有特徵值，如果 這些未出現之特徵值正好是控制製程之
參數，則會對部份正向規則產生影响，進而造成 在設計良率模組之困難度，所
以未來我們將整合不同製程階段的良率改善模組，建置完 整的製造提示系統
改善線上生產的良率。 
認研究設計方式及程式是達到要求的。並且可有效瞭解到整體 CNC
的運作，雖然經費只夠以一組 CNC 機臺為實驗組但在過程直中以隱
約可以看到 CNC 的運作規則，而此發現有利於未來的分析，且對製
程良率的改善是有幫助的。 
二、 研究成果 
此次在廠內最大的收獲在於與 CNC並聯後系統可正常運作為最大收
獲,雖然在系統設計上已經考慮過能與 CNC設備連動，但由於設備商
不願意提供系統核心，所以我們在合作廠商葛雷思光學的協助下自
行分析了 CNC系統，並結合研究團隊所設計的新系統，此舉大幅度
的提升設備的能力並且在資料的收集上有更準確且有利於分析的數
據資料。 
三、 建議 
整體而論，此次實地與業界合作是對研究有最直接的幫助，但礙於
經費不足無法讓研究人員有更充分的時間與現場技師溝通，更缺乏
了讓設備與系統能有長時間的整合，若未來有延續計劃應將經費調
整讓研究人員有更充分的時間能與現場技師溝通也更能展現研究效
能。 
四、其他 
 
 
99 年度專題研究計畫研究成果彙整表 
計畫主持人：葛煥昭 計畫編號：99-2221-E-032-062- 
計畫名稱：多點式觸控面板線上監控與製程改良系統架構與良率相關技術研發 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 1 0 100%  
博士生 3 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
