行政院國家科學委員會專題研究計畫成果報告 
 
計畫名稱： LCD 廠薄膜電晶體元件工程網路動態學習與線上診斷維護系統 
– 子計畫三： 
利用視覺及資料探勘技術於製程設備故障診斷系統之發展(3/3) 
計畫編號：    NSC NSC 95-2218-E-033-004 
執行期限：    95 年 8 月 1 日至 96 年 7 月 31 日 
計畫主持人：  中原大學機械系 劉益宏  助理教授 
計畫參與人員：中原大學機械系 黃鈺凱 鄧凱元 研究生
中文摘要 
薄膜電晶體液晶平面顯示器(TFT-LCD)在陣
列電路工程中主要分為五道光罩的製程，每一
道光罩製程中皆會產生不種類的瑕疵。本計劃
在前兩年已完成第一道光罩中的瑕疵辨識系
統 、 第 二 道 光 罩 ( 島 狀 半 導 體 光 罩
Semiconductor Electrode)及第三道光罩(源/汲
電極光罩 Source & Drain Electrode)的瑕疵分
別發展瑕疵偵測及種類辨識的系統，達到即時
的線中檢測目的。在第三年中，本計劃已經成
功的利用影像處理技術、圖形識別、類神經網
路等理論，發展了瑕疵辨識系統，其分別可以
對接觸孔洞光罩中產生的 7 種不同的瑕疵，及
對畫素電極光罩中產生的 6 種不同的瑕疵進
行即時的辨識。由面板廠所提供瑕疵的照片來
進行實驗，本計劃在第三年所發展的兩個瑕疵
辨識系統，可達到超過 96%以上的高辨識率。 
關鍵詞: 薄膜電晶體液晶平面顯示器、陣列電
路工程、瑕疵辨識、圖形識別、類神經網路。 
 
Abstract 
The manufacturing process of TFT-LCD in array 
engineering consists of five processes of masks 
and in each mask process produces different 
kinds of defects. In the first year, this project has 
accomplished the task of defect recognition for 
the first mask’s process. In this year, the second 
year, this project continues to develop the defect 
recognition systems for the second mask 
(Semiconductor Electrode, SE) and the third 
mask (Source & Drain Electrode, SD), 
respectively, for achieving the goal of real-time 
inline inspection of array engineering. In this 
year, based on the image processing techniques, 
pattern recognition methods, and neural 
networks, the project has successfully studied 
and developed two systems by which nine 
different kinds of defects in the masks of CH 
and PE can be classified, respectively. By using 
pictures that contain defects as the experimental 
recourse provided by the LCD manufacturer, the 
results show that the developed two defect 
recognition systems for the two different masks 
are able to achieve more than 96%’s high defect 
recognition rate. 
Keywords: TFT-LCD, array engineering, defect 
recognition, pattern recognition, neural network. 
 
一、 前言及背景介紹 
薄膜電晶體液晶平面顯示器（TFT.LCD）[1]的陣
列電路製程技術大致上可區分為陣列電路工程（Array 
Engineering）、面板工程（Cell Engineering）和模組工
程（Module Engineering）三種；其中陣列電路工程是
 2-4 源電極斷路（Source Line Open） 
源電極斷路發生於SD光罩，屬於前道製程瑕疵的
一種。發生情形為SD光罩所形成之源電極線斷裂或是
破裂，如圖2-5所示。 
 
圖2.5 『源電極線斷路』瑕疵影像 
 
2-5 接觸孔洞異常（Abnormal Contact Hole） 
接觸孔洞異常發生於CH光罩，一般正常的接觸孔
洞其定義為接觸孔洞的範圍需被包覆於汲電極區內，
發生情形可分為接觸孔洞未形成以及接觸孔洞偏移，
如圖2-6所示。此外，接觸孔洞偏移的異常狀況為機台
的參數設定及機台異常，造成面板進行微影工程時產
生定位偏移的情形，因此造成接觸孔洞的偏移，如圖
2-7所示。 
 
圖2.6 接觸孔洞未形成 
 
 
圖2.7 接觸孔洞偏移 
 
2-6 刮傷 (Scratch) 
刮傷意指玻璃基板被機械手臂、碎玻璃或是尖銳
的東西碰觸或摩擦，導致玻璃基板上出現刮痕，通常
會出現大面積的線性刮痕，使得基板上的圖案出現變
形或消失，如圖2.8所示。造成刮傷的原因眾多，但多
數的刮傷形狀屬於線性分佈。 
 
圖2.8 刮傷瑕疵影像 
 
2-7 異物 (Foreign Object) 
異物意指進行製程時有異物掉落，其發生的地點
相當的多，可在成膜製程前、曝光後或是中間的流程
都有可能有異物掉落，如圖 2.9 所示。 
 
圖2.9  異物瑕疵影像 
 
三、 接觸孔洞光罩瑕疵影像辨識系統分
析流程 
為了精準且快速的分類『GE殘』、『SE殘』、『源
/汲電極短路』、『源電極斷路』、『接觸孔洞異常』、
『刮傷』、『異物』，七種瑕疵影像以及『正常』之
沒瑕疵影像，在本計劃提出了『接觸孔洞光罩中微影
製程瑕疵影像辨識系統』來處理及分類上述的各種瑕
疵，藉由使用各式的影像處理方法如影像前處理、類
神經網路等理論設計出一個架構式系統，以分類出光
微影製程中的各式各樣瑕疵影像。 
此系統為階層式架構，共分為六個步驟，每一個
步驟皆可以粗分或細分幾類不同的瑕疵，一張測試影
分類的門檻值，將 AR_T 超過門檻值的瑕庛：GE 殘、
SE 殘、源/汲電極短路歸為一類，其他的瑕疵則歸為另
外一類，即可先分離出擁有大面積瑕疵區塊的影像。 
Area
_AR_T AreaWhite=          （3.3） 
 
B. 步驟二 
第一層: 進行瑕疵影像之色彩空間轉換 
將步驟一中判定為有瑕疵的瑕疵影像的位置抓出，將
瑕疵影像轉換到 HSV 色彩空間以及 CMY 色彩空間，
分別對 H、S、V 以及 C 色彩平面、灰階影像的處理後，
每類瑕疵區塊影像就會得到五種不同形式的影像。 
表 3-1、欲抽取特徵值的瑕疵影像比較表 
 GE殘 SE殘 源/汲電極短路 
灰
階 
影
像    
H
平
面 
   
S
平
面 
   
V
平
面 
   
第二層: 瑕疵區塊影像之特徵值擷取 
 在此層中分別對瑕疵區塊影像進行特徵值擷取，
紋理分析的方法分為三類，首先分別對 H、S 和 V 色
彩平面利用色彩動差計算出一階動差和二階動差，因
此，一個色彩平面的影像就會得到兩個特徵值，三個
色彩平面就會得到六個特徵值；接著藉由統計 C 色彩
平面中的灰階統計直方圖，可求出統計型紋理特徵的
灰階平均值、二階矩、均勻度和平均等四筆特徵值。
再對 C 色彩平面使用共生矩陣進行紋理特徵值抽取，
位移向量 )0,1(=dv ，計算出熵、能、對比、同次性和
相異性等五筆特徵值，由上述的方法，一個瑕疵區塊
影像就會得到十五筆特徵值。  
第三層: 利用倒傳遞類神經網路分類 
 在此採用三層的神經網路：第一層輸入層神經元
數目為十五（特徵值數目），第二層隱藏層神經元數
目為九，第三層輸出層神經元數目為三（分類數目），
輸出為『GE 殘』、『SE 殘』、『源/汲電極短路』等
三類。此外學習速率採用自動調整，學習循環次數設
為 30000。 
第四層：由分類結果對整張測試影像進行判定 
 此步驟將第三層倒傳遞類神經網路所得的訓練參
數，帶入類神經網路的回想過程，其回想過程可依照
第三層訓練參數對整張影像進行判定，並將前道製程
殘『GE 殘』、『SE 殘』、『源/汲電極短路』分門別
類。 
C. 步驟三 
經由前述的步驟處裡後已經可以過濾出含有大面
積瑕疵的瑕疵影像，為了方便之後針對其他類別的瑕
疵進行分析，必須先將影像進行分割，將影像中的各
區域：源電極區、汲電極區和畫素電極區等位置給劃
分出來，如圖 3-6 所示。 
 
圖3.5  瑕疵影像分割區域示意圖 
 在此將利用 Otsu 演算法所得的二值化影像做一
個 9×9 方形遮罩的膨脹以填補線段中間的空洞，接著
將膨脹過後的二值化影像分別對 X、Y 兩軸做投影，利
用步驟一中的方法，即可得知測試影像中源電極和汲
電極的數目、線寬以及每條源電極和汲電極中心位置。 
D. 步驟四 
其範圍框選出來，如圖 3-14 所示，可觀察到經由前述 
 
圖3.13  框選接觸孔洞 
的影像處理後所框選出正常接觸孔洞電路圖案，其範
圍內並不會接觸到黑色背景，反之，若接觸孔洞的位
置產生偏移時，其所框選的接觸孔洞範圍內將包含黑
色背景，由於黑色背景其灰階值可以很明顯的在灰階
統計圖觀察到是屬於灰階值較低的部份，因此，可設
定二值化門檻值作為檢查範圍，因此，當所框選的範
圍內的灰階值小於門檻，即代表接觸孔洞已偏移，藉
由此判定方式可將接觸孔洞位置異常判別出來。 
F. 步驟六 
    由於此步驟的瑕疵測試影像並無法用上述的步驟
辨別，但是由肉眼觀察測試影像仍然可以發現瑕疵的
存在；另一方面，觀察測試影像可發現測試影像內畫
素電極區的面積加總起約占整張影像的八成，所以畫
素電極區內發生瑕疵的機率也比其他區域高，故在此
步驟中藉由檢查畫素電極區即可辨別出大部分的瑕
疵，此步驟可再細分為四層，以下將就各層分別說明
之。 
第一層：畫素電極區切割暨色彩空間轉換 
 藉由從步驟三得到畫素電極區的四個頂點座標分
別對 H、S 和 V 色彩平面以及 CMY 中 C 的色彩平面、
灰階測試影像；經過前述的影像處理後，每個畫素電
極區域就會得到五種不同形式的影像，另一方面，由
於部分瑕疵在畫素電極區中所顯現出來的特色雷同，
故在此依畫素電極區影像所顯現的樣式將其分為五
類，如表 3-2 所示。 
表3-2、畫素電極區瑕疵影像前處理 
 正 常 畫素區GE殘 畫素區SE殘 異 物 刮 傷 
原始影像    
灰階影像    
H平面    
S平面    
V平面  
C平面  
第二層：畫素電極區之特徵值擷取 
 在此層中分別對畫素電極區的各類型影像做特徵
值擷取，首先分別對 H、S 和 V 色彩平面利用色彩動差
計算出一階動差和二階動差，故一個色彩平面的影像就
會得到兩個特徵值，三個色彩平面就會得到六個特徵
值；接著藉由統計 C 色彩平面中的灰階直方圖，可得
到 C 色彩平面影像的平均值、二階矩、均勻度和平均
熵等四筆特徵值。由上述的特徵值擷取雖然可以得知畫
素電極區影像內色彩分佈的情形，但是並沒有辦法得知
像素相互間相對位置的資訊，所以再對灰階測試影像使
用灰階共生矩陣進行紋理特徵值抽取，位移向量
)0,1(=dv ，計算出熵、能、對比、同次性和相異性等
五筆特徵值，由上述的方法，一個畫素電極區影像就會
得到十五筆特徵值，使得每個畫素電極區影像都會用十
五筆特徵值來描述。 
第三層：利用倒傳遞類神經網路分類 
對步驟二所得到的十五筆特徵值進行正規化，使
得每筆特徵值皆介於 0 到 1 之間，再將特徵值輸入至
倒傳遞類神經網路進行學習訓練，在此採用三層的神
經網路：第一層輸入層神經元數目為十五(特徵值數
目)，第二層隱藏層神經元數目為十，第三層輸出層神
經元數目為五(欲分類別的數目)，輸出為『正常』、『GE
殘』、『SE 殘』、『異物』、『刮傷』等五類。在此
要強調的是，類神經網路是針對畫素電極區影像進行
分類，所以分類結果為正常只是代表整張測試影像中
的畫素電極區影像為正常。此外學習速率採用自動調
整，學習循環次數設為 100000。待訓練完畢後再將神
經網路的參數存下來，直接拿來做線上分類用。 
第四層：由各個畫素電極區分類結果對整張測試影像
進行判定 
 規則一： 
在實際測試後可以發現一張影像中大多會有判斷
成瑕疵和『正常』的畫素電極區影像，先扣掉判斷成
『正常』的畫素電極區影像，如果只剩一種瑕疵則可
以把該張影像判成該種瑕疵，如圖3-15所示，一張含有
刮傷的瑕疵影像共可切割出十八塊畫素電極區影像，
瑕疵 
名稱 
測試影像張數 
分類正確 
張數 
分類錯誤 
張數 
分類率
（%）
GE 殘 80 76 4 95 
SE 殘 74 73 1 98.6 
SD 殘 68 66 2 97.05
異物 409 401 8 97.44
PE2 連 113 107 6 94.69
源電極 
斷裂 
58 55 3 94.8 
正常 40 40 0 100 
總張數 842 818 24 97.14
 ※ 此表中影像單位為整張瑕疵影像 
 
實驗結果證明此系統具有高辨識率(97%)、高速(3
秒內)的特性。此外我們用 Borland C++撰寫此系統的演
算法，並設計一個人機介面，讓使用者可以快速利用
它。 
 
參考文獻 
[1] 顧鴻壽，光電液晶平面顯示器-技術基礎及運用，
新文京開發出板股份有限公司，中華民國九十三年三
月二版。 
[2] 陳同孝、張真誠、黃國峰，數位影像處理技術，旗
標出版股份有限公司，2004。 
[3] N. Otsu, “A Threshold Selection Method from 
Gray-Level Histograms,”IEEE Trans. System Man 
Cybernet, Vol. 9, No. 1, pp. 62-69, 1979. 
[4] 鍾國亮，影像處理與電腦視覺，東華書局， 中華
民國九十三年二月二版。 
[5] Ramesh Jain, Rangachar Kasturi, Brain G. Schunck, 
Machine Vision, McGRAW-HILL INTERNATION 
EDITIONS. 
[6] 楊武智， 影像處理與辨識，全華科技圖書股份有
限公司，2001 
[7] 繆紹綱， 數位影像處理，普林斯頓國際有限公司，
2004。 
[8] 葉怡成，應用類神經網路，儒林圖書公司，1997. 
[9] 葉怡成，類神經網路模式應用與實作，儒林圖書 
2003 八版 
[10] F. Markowetz, Support Vector Machines in 
Bioinformatics, Mathematics Department of 
Ruprecht-Karls University Heidelberg, April 2001. 
 
