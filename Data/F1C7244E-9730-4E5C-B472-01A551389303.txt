智慧型機器人室內與戶外導航之研究(I) 
The Study of Navigation of an Intelligent Robot Indoors and Outdoors (I) 
 
計畫編號：NSC 96-2221-E-167-025- 
執行時間：96/08/01~97/07/31 
主持人：黃國興 國立勤益科技大學 電子工程系 
計畫參與人員：蘇家弘、鐘毅宏 國立勤益科技大學 電子工程系 
 
摘 要 
    執行了有關 GPS 載波相位導航定位之研究後，
再加上車用型電子導航實務專題研究，以此研究技
術應用在智慧型機器人之行走定位上，應該是一項
很直得研究的題目。本研究計畫題目為「智慧型機
器人戶外室內導航之研究」就是針對此種可移動式
的機器人無論在戶外或室內都能很準確地達到定位
的功能，當機器人在戶外走動，可藉由即時動態 GPS
執行導航任務，若進入室內，則切換改由雷射導引
定位、超音波感測及影像識別，以便完成智慧型機
器人無障礙空間。本研究著重在利用 GPS 載波相位
觀測定位技術，發展智慧型機器人戶外導航定位功
能，隨時都能得到自身的位置、方向，既周圍環境
的認知，進而從事該機器人所欲完成的工作，例如
撿網球、高爾夫球、割草⋯等服務性質的工作。本
研究包括系統數學模型的建立、推導模糊控制演算
法修正行走路徑、軟硬體之建置與相關實務技術，
本研究使用擴充式卡爾曼濾波器融合即時動態 GPS
導航技術、雷射定位，應用模糊推論修正路徑，提
升行動服務機器人在戶外室內的定位精確度與可靠
性。 
關鍵詞: 即時動態GPS、智慧型機器人 
 
Abstract 
    After performing a study of vehicle navigation 
using GPS Carrier phase and practice project, we 
propose the research on the positioning and navigation 
of an intelligent Robot. It should be worth in this study 
topic. This subject of the research proposal is “A study 
of navigation indoor/outdoor of intelligent mobile 
Robot,” which is due to achieve the functions of 
positioning and navigation either indoor or outdoor for 
the mobile Robot. When Robot is moving outside, it is 
used of GPS to perform the mission of navigation. If 
the Robot enters into indoor, it is switching a Laser 
detector for its navigation in order to perform no 
obstacle space for intelligent Robot. Therefore, this 
proposal is addressed in development and application 
of GPS carrier phase measurement technology for 
outdoor navigation of the mobile Robot in the first year. 
The Robot can know its position and direction in real 
time and understand the enclosure environments, then 
to finish its task for instance pick up tennis, golf ball 
cut off the grass and so on service task. This proposal is 
presented to promote the accuracy and reliability of 
positioning and navigation of the intelligent mobile 
Robot indoors and outdoors by using extended Kalman 
filter, fusing RTK GPS, Laser guide positioning, 
technology with fuzzy reasoning to modify the path 
plan. 
 
Key words: KGPS, Intelligent Robot 
 
一、前言 
本計畫的研究目標是以KGPS載波相位
觀測技術及雷射掃瞄導引技術應用在可移
動式智慧型機器人上，執行精確的定位導航
功能。分別發展新的演算法則，並融合此兩
種導航系統，能使機器人無論在戶外或室內
均能做到精確的定位，認知其位置，方向及
週遭環境達到無障礙空間導航定位的目的。 
    目前使用上，GPS與慣性導航的整合系
統是一個非常有效的導航系統。由於即時動
態定位(Real-Time Kinematic，簡稱RTK)的
技術進步[2-3]，其不但擁有高精度的動態定
位，更能提供即時性的定位座標，其特性是
迅速而且便宜。而在導航方面，為了有高精
度的定位點通常使用DGPS[4-6]，一般DGPS
的定位方法，是將基站所觀測得到的各個
GPS衛星訊號分別算出其修正量，再將修正
量透過無線電傳送機或電標傳送到使用者
(移動站)提供參考，並修正移動站的位置，
達到更高的精度，其複雜的解算過程大部份
由基站來完成，移動站所扮演的角色只是更
新位置而已。在週波偵測與修正方面，A. 
Leick在1995年的發表中，利用L1/L2 雙頻
解整數未定值，二次差分寬巷法，靜態定
位，二次差分，三次差分觀測方程式，週波
脫落偵測與修正等，並使用虛擬距離或載波
相位甚至兩者合併的方法搜尋空間，嘗試決
定整數週波未定值，即可定位[12][13]。 
 
i
mn
i
mn
i
mn
i
mn
mn
i
mn
i
mn
TI
f
cN
tct
f
ct
Φ++−⋅
+⋅+=⋅Φ
ε
δρ )()()(
 (3-1) 
如(3-1)式為地面一次差，地面一次差即
為是某一時刻，兩個接收儀對同一顆衛星的
觀測量做相減，由於衛星時錶誤差項對此兩
接收儀的效應近乎相同，故地面一次差可消
去衛星時錶誤差項 )(tiδ 。與地面一次差類
似，只要接收儀同時接收兩顆衛星的觀測
量，則接收儀時錶誤差的效應在此兩觀測量
上是完全相同，故此差分可以消去接收儀時
錶誤差 )(tmδ ，而空中一次差觀測量如下[4]: 
ij
m
ij
m
ij
m
ij
m
ijij
m
ij
m
TI
f
cN
tct
f
ct
Φ++−⋅
+⋅−=⋅Φ
ε
δρ )()()(
 (3-2) 
在某一時刻，可以結合其地面一次差及
空中一次觀測量形成二次差觀測量形成二
次差觀測量，即可同時消去衛星時錶誤差
)(tiδ 及接收儀時錶誤差 )(tmδ 。若基線在十
公里以內，對流層與電離層影響對兩接收儀
m、n 與兩衛星 i、j 可視為相似，差分後其
值極小可忽略之，故組成之二次差觀測量模
式如下: 
ij
mnf
cNt
f
ct ijmn
ij
mn
ij
mn Φ+⋅+=⋅Φ ερ )()(    
 (3-3) 
其中 )(timΦ 為接收儀 m、n 至第 i、j 顆衛
星的載波相位觀測量  
)()()( ttt imn
j
mn
ij
mn ρρρ −= 為接收 m、n分別觀
測第 i顆與第 j顆衛星幾何距離二次差。 
ij
mnN  : 為接收儀 m、n至第 i、j顆衛星的週
波未定值  
i
mΦε  : 載波相位測量雜訊 
將 (3-3)式線性化並忽略載波相位測量雜
訊，則可寫成下式 
)()(
)]()([)(
][
][
][
][
tNXX
S
S
S
S
c
f
Ntt
c
ft
ij
mnmne
i
e
i
e
j
e
j
ij
mn
i
mn
j
mn
ij
mn
+−
⎥⎥⎦
⎤
⎢⎢⎣
⎡ −
=+−=Φ ρρ
 
(3-4) 
其中
][
][
e
j
e
j
S
S
為參考點對第 j 顆衛星之單位向
量。 
][
][
e
i
e
i
S
S 為參考點對第 i顆衛星之單位向量。 
[ ]nnnn zyxX     = 為移動站的位置。 [ ]mmmm zyxX     = 為基站的位置。 
ij
mnΦ 為二次差載波相位觀測值，可經由接收
儀計算得到，而 ijmnN 為未得週波未定值
T
m
T
n XX − 為基線向量，先將由 GPS接收儀解
算得到的基線向量當已知，解得未定週波
值，再利用精確的基站點位代入，能得移動
站的點位，以疊代的方法求得高精度的點
位。(3-4)式為 KGPS的調整方程式，可利用
系統狀態方程式來表示，量度方程式如下： 
                            
)()( kvxhz +=                     (3-5) 
狀態向量 [ ]ijmnn NXx =  
[ ]Tmnmnmnnnn NNNzyx 141312=  
[ ]Tmnmnmnz 141312     ΦΦΦ=  
3.2整數最小平方法 
    利用整數最小平方法來估算基線
位置座標及二次差週波未定值，由於 
( ) ( )
[ ])1(ˆ)1()1(
1ˆ11ˆ
+−++
++=++
kzkzkK
kkxkkx
 
( )
( )[ ] ( )kkPkHkKI
kkP
x 1)1(1
11
+++−
=++
 
其中 )1( +kK 為卡爾曼濾波器增益，依
據下式計算 
( )
( ) 1
)1(
)1(1)1(
)1(1)1(
−
⎥⎦
⎤⎢⎣
⎡
++
+++
++=+
kR
kHkkPkH
kHkkPkK
T
xx
T
x
 
於此 )1( +kR 為量測雜訊 )1( +kv 的協
方差，過濾後的狀態 ( )11ˆ ++ kkx 即可得到，
相對地移動站位置 ( )nnnn zyxX ˆ,ˆ,ˆˆ 及週波未
定值 Nˆ 即可求得。 
Step 4. 由於矩陣週波未定值N ，只允
許為整數的元素，故每一過濾後的元素估算
的週波未定值 Nˆ 一般均須選擇其最接近的
整數。 
四、智慧型機器人路徑規劃法 
自主式機器人的導航及路徑規劃是智
慧型機器人研究的重要課題之一，而移動式
機器人的最佳路徑規劃是指在有障礙物的
環境中，尋求一條最適合的路徑，使機器人
能順利的從起點避開所有的障礙物，並到達
目標點。利用GPS計算機器人本身座標，並
利用以下演算法來規劃機器人的行走路徑。 
4.1 最短切線路徑演算法 
首先要先確認從機器人到目標終點是
否存有障礙物，如圖二.所示。設移動機器
人及障礙物為A點及B點，目標終點為G點，
座標可以表示為 ),( AA yx 、 ),( BB yx 及 ),( GG yx ，其
中障礙物所圍成的外圓半徑為 Br ，我們可以
下式算出 AG直線方程式: 
 
                                 (4.1) 
 
將上式改寫成 0=++ cbyax 標準式: 
0)()()( =−+−+− AGGAAGGA yxyxyxxxyy  (4.2) 
設障礙物到直線的距離為d，可由下式表示: 
                                   
(4.3) 
 
其中 ,, AGGA xxbyya −=−= AGGA yxyxc −= ， 
若 AB rrd +> 表示機器人可沿(4.1)式直線方程
式到達目標點而不會發生碰撞，此時B點不
為障礙物；若 AB rrd +< 表示機器人沿(4.1)式
直線方程式行走可能會發生碰撞，此時B點
可能為障礙物。若B點為障礙時，我們得求
最出以B點為圓心，半徑為 AB rr + 所構成之圓
稱為碰撞圓，其中 Br 為障礙物之外切圓，其
方程式為： 
222 )()()( ABBB rryyxx +=−+−        (4.4) 
設經過A點並與碰撞圓之圓相切線方程式
為： 
)()( 1 AA xxmyy −=−                 (4.5) 
與經過G點，並與碰撞圓之圓相切方程式
為： 
)()( 2 GG xxmyy −=−                (4.6) 
1m 、 2m 為待求斜率，由(4.4)~(4.6)式解聯立
方程式可求得點c1及c2，由圖二可得知兩條
路徑，A→c1→G及A→c2→G，並比較兩條
路徑選擇最短為最佳路徑。 
 
 
 
 
 
 
 
圖二.最佳路徑規劃圖 
假設在行進的過程中，有發現另一障礙
物加入時，此時可以用該障礙物的座標代替
原障礙物，並重新求得必須經過的中途點
(c1或c2)，若沒有新障礙物加入，則中途點
不變。若有多障礙物時，在抵達第一個中途
G
c2 
Ar
A
B 
c1 
Ar
22 ba
cbyax
d BB +
++=
GA
GA
A
A
xx
yy
xx
yy
−
−=−
−
KGPS之功能。首先，我們使用以下硬體設
備執行我們所需要的結果： 
1. GPS L1載波相位NovAtel 衛星定位儀×2 
2. 數位無線電收發器×2 
3. 筆記型電腦×2 
4. 電源供應器×2 
5. GPS天線×2 
2. 測試平台機器人×2 
 
 
圖八、實驗測試設備環境 
 
圖九、系統示意圖 
5.1 定位測試 
    首先，透過系統示意圖將所有實驗設備
架設完成之後，等待 NOVATEL GPS 衛星
接收器接收到衛星訊號，衛星訊號燈呈現綠
燈。接下來，利用 GPS SOLUTION 軟體輸
入吾人所需要的 RTCM 指令，當基站接收
到訊號而秀出目前基站所在的位置後，將正
確的基站 POSITION輸入，再來利用 RTCM
指令將和衛星接收到的差值傳到移動站進
行修正，接下來再移動站輸入接收 RTCM修
正指令，從 position視窗中即可得到目前移
動站所在位置的座標以及誤差值 50cm~ 
80cm。最後將座標轉換後的座標位置和實
際的移動站位置座標作比對，實際誤差值確
實 50cm~80cm 區間中即可驗證吾人所得到
的座標。 
 
圖十、實際測試七點座標位置 
 
 
 
圖十一、NOVATEL GPS 接收器 
  
圖十五、移動站 (2~6點測試) 
5.2 導航測試 
有了定位座標後，再將事先建立好的地
圖做資料比對，就能計算出載具(機器人)目
前所在的座標，經過連續的定位點將其連成
線，就達到我們所要行進的路徑。經由上述
的演算法及 KGPS 定位可計算出機器人的
行走路徑，圖十六為實際機器人在室外所行
走的路徑圖，可以明顯的看出機器人由 A
點行走至 B點，經過多次實驗後，可發現機
器人的路徑誤差在 50cm~80cm 之間，而這
個誤差值是因為吾人所使用的 GPS 接收器
僅為單頻 L1 載波相位接收器，所產生的誤
差量。 
 
圖十六、機器人導航路徑圖 
六、結論 
在這一份研究成果報告中，本實驗室所
開發的關鍵技術利用 KGPS定位技術，應用
於戶外可移動式智慧型機器人系統可提昇
其定位導航精度與智慧。若能將現在使用的
單頻 L1 載波相位 GPS 接收器汰換為雙頻
L1/L2載波相位 GPS接收器，則可將目前的
定位導航精度 50cm~80cm 提昇到 2cm，只
是雙頻 GPS 接收器比較昂貴。所研發的系
統軟硬體建置與相關實務技術，不但有助於
現今可移動式智慧型機器人的定位，同時可
推廣應用於其他的家庭、教育、旅館服務、
戶外室內娛樂休閒、博物館、甚至市場行銷
等領域之服務機器人研發。根據時代雜誌等
多項市場調查顯示可移動式服務機器人產
業將會像汽車、個人電腦、手機等產品一
樣，成為個人化產品，也將可能是未來機器
人的系統 IC晶片需求來源。 
影響 GPS 定位及時間的校準方面的因
素，我們只考慮 GPS 時鐘與衛星時鐘之間
時間差及整數未定值，由於吾人考慮的因素
有限，所以在定位及時間的校準精度有限。
若是能把多路徑效應、軌道誤差、及傳送延
遲誤差等其他影響 GPS 的因素再加以考量
的話，對 GPS 定位及時間的校準精度都會
大大的提昇。 
六、參考文獻 
[1] J. C. Juang, G. S. Huang, 1997, “Development of 
GPS-Based Attitude Determination  Algorithms,” 
IEEE Transactions on Aerospace Electronic 
Systems, Vol.33, No.3, pp.968-976, July 1997. 
[2] T. Wang, “Stochastic Modeling for Real-Time 
Kinematic GPS/GLONASS Positioning,” Journal 
of the Institute of Navigation, Vol.46, No.4, pp. 
297-305 Winter 1999-2000.  
[3] R. Hatch and H. J. Euler, “Comparison of Several 
AROF Kinematic Techniques,” Proceedings of 
ION GPS-94, pp. 363-370, Salt Lake City, UT, 
September 1994 
[4] J. Farrell and T. Givargis, “Differential GPS 
Reference Station Algorithm - Design and 
Analysis,” IEEE Transactions on Control Systems 
Technology, Vol.8, No.3, pp. 519-531, May 2000. 
[5] M. Pachter “Stochastic Modeling Based DGPS 
附錄一 
表一WGS-84經緯度 
Point 
Name 
Φ λ h 
1030 24°08'39.43452"N 120°43'43.68689"E 155.362m
g2 24°08'39.43125"N 120°43'43.75772"E 156.410m
g6 24°08'39.48545"N 120°43'43.79619"E 155.400m
g7 24°08'39.37738"N 120°43'44.76573"E 159.811m
TCBA 24°08'10.65002"N 120°40'25.55315"E 141.897m
g4 24°08'39.42751"N 120°43'43.82863"E 155.344m
g5 24°08'39.48915"N 120°43'43.72553"E 155.389m
g1 24°08'39.43119"N 120°43'43.75780"E 155.399m
表二WGS-84 轉換 XYZ 
Point 
Name 
x y z 
1030 -2951318.98958384 5023494.98049615 2586837.70969787
g2 -2951320.10273655 5023495.45332938 2586838.10429379
g6 -2951319.84885361 5023494.24892062 2586838.24020958
g7 -2951330.63676881 5023493.14808004 2586838.94742099
TCBA -2948588.86556604 5025234.52460315 2586541.14310851
g4 -2951320.24003655 5023494.26354001 2586837.63146731
g5 -2951319.21577291 5023494.58981395 2586838.27313521
g1 -2951319.63603318 5023494.65733914 2586837.69112363
 
第三點測得座標 
N                E              H 
24.14429771 120.7288494 137.112
24.14430127 120.7288489 137.413
24.14430231 120.7288487 136.002
24.14430728 120.7288481 136.001
24.14429875 120.7288486 136.445
24.14430827 120.7288491 137.112
24.14430729 120.7288497 137.413
24.1442981 120.728849 136.002
24.14430139 120.7288483 136.001
24.14430814 120.7288493 136.445
第四點測得座標 
N             E           H 
24.14430021 120.7288083 136.209
24.14430007 120.7288084 136.369
24.14430008 120.7288093 136.545
24.1442998 120.7288087 136.792
24.14429923 120.7288092 136.73
24.14429916 120.7288082 136.209
24.14430113 120.7288084 136.369
24.14429656 120.7288086 136.545
24.14431026 120.7288077 136.792
24.14429599 120.7288088 136.73
第五點測得座標 
N             E           H 
24.14431467 120.7288241 137.407
24.14431521 120.7288242 136.206
24.14432097 120.7288242 137.448
24.14431987 120.728825 137.589
24.14431765 120.7288251 137.101
24.14432121 120.7288247 137.407
24.14431869 120.7288241 136.206
24.14431729 120.7288241 137.448
24.14431862 120.7288252 137.589
24.14431747 120.7288241 137.101
第六點測得座標 
N            E            H 
24.14431672 120.7288521 137.891
24.14431701 120.7288489 136.668
24.14431094 120.7288525 137.421
24.14431509 120.7288526 136.331
24.14431682 120.7288528 137.444
24.14431642 120.7288514 137.891
24.14431723 120.7288519 136.668
24.1443162 120.7288527 137.421
24.14431521 120.7288529 136.331
24.14431643 120.7288512 137.444
距離十公尺所測得座標 
N             E            H 
24.14429291 120.7289304 133.669
24.1442934 120.7289315 135.816
24.1442942 120.7289327 134.908
-2983034.61 5019467.955 
距離基站10公尺座標轉換(m) 
X              Y 
-2983040.677 5019462.372 
-2983041.767 5019463.988 
-2983041.433 5019463.192 
-2983040.664 5019461.499 
-2983040.767 5019461.954 
-2983040.754 5019462.373 
-2983040.859 5019462.946 
-2983041.416 5019463.708 
-2983041.965 5019463.987 
-2983041.65 5019463.2 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
