小節討論睡眠階段判讀的程序，3.1節討論眼動訊號之
特徵變數的建立，3.2節討論類神經分類器的建立，3.3 
節使用類神經分類器進行整夜睡眠階段判讀工作，接
著在 3.4 節討論使用鄰居法則修正 3.2 節所建立的分
類器，再重新進行 3.3節的睡眠階段判讀。 
 
 
圖 3.1 眼動訊號量測實際狀況 
 
 
圖 3.2 雙眼眼動頻道訊號 
 
3.1建立眼動訊號之特徵變數 
根據 R&K法則[6]，睡眠分期是以每頁 30秒為基
準，亦即每 30秒進行一次睡眠階段的判讀。因此本文
對眼動訊號做訊號分析時，也是依照睡眠分期的規
則，對整夜眼動訊號依序每 30秒建立一組對應的特徵
變數。接著在以下小節介紹本文所使用的各種特徵變
數。 
 
3.1.1 越零點數目 
越零點(Zero-Crossing Points)指的是訊號通過零
點的位置，故越零點數目即為訊號通過零點的次數，
它也是一種表示訊號響應速度(Speed of Response)的
指標。本文中越零點數目特徵的建立方法如下。 
1.將 30秒眼動訊號切割成 30個不重疊的 1秒子視窗
訊號。 
2.每個子視窗訊號減去其平均值後，計算訊號由正轉
負或由負轉正的次數。 
3.計算 30個子視窗的越零點總數。 
3.1.2 越零點加權面積 
在討論越零點加權面積之前，必須先介紹越零點
面積和越零點間距。所謂越零點面積即為前後越零點
間的面積，而越零點間距則為前後越零點間的距離。
越零點加權面積便是將越零點面積乘上越零點間距當
作加權，它也是一種表示訊號強弱(振幅大小)的指
標。本文中越零點加權面積特徵的建立方法如下。 
1.同 3.1.1 節的步驟 1.。 
2.同 3.1.1 節的步驟 2.找出越零點，並記錄所有越零
點的位置。 
3.計算前後兩兩越零點間取樣點的平方和，即為越零
點面積。 
4.計算前後兩兩越零點間取樣點的個數，即為越零點
間距。 
5.計算 30 個子視窗的越零點加權面積總和，並除上
越零點面積的總數。 
 
3.1.3 能量 
能量指的是訊號的總能量。本文中能量特徵的建
立方法為將 30秒眼動訊號減去其平均值後，計算訊號
取樣點的平方和。 
 
3.1.4 頻帶能量 
頻帶能量指的是訊號在頻域上某段頻率範圍的絕
對能量或相對能量(絕對能量除上總能量)。在此本文
開發一種搜尋頻帶能量的方法，找尋最佳的頻帶能
量，使欲進行分類的兩組睡眠階段之類 別有最好的分
類精度(測試分類精度的方法於下段文中介紹)。本文
中搜尋頻帶能量特徵的建立流程如下。 
1.將 30 秒眼動訊號透過快速傅立葉 (Fast Fourier 
Transform, FFT)轉換至頻域。 
2.設定搜尋頻帶範圍(以 Hz 為搜尋的單位)的下限值
(以 i 代表)與上限值(以 j 代表)。其中下限值從 1
開始(i=1)，上限值從下限值開始往後搜尋(j=i+1)。 
3.每次累加上限值(j=j+1)，直到上限值達到頻譜的最
大頻率(j>50)後，即完成此下限值下所有可能的頻帶
範圍搜尋。接著累加下限值(i=i+1)，更新上限值從
新的下限值開始往後搜尋(j=i+1)。 
4.重回步驟 3，直到所有可能的頻帶範圍搜尋完畢。每
次得到不同的頻帶能量，就使用門檻值切割方法測
試分類精度，找出最佳的頻帶能量。門檻值切割方
法的方法是將個人整夜所有 epoch 的頻帶能量排
序，設定門檻值進行兩類別的分類問題。門檻值從
最小的頻帶能量掃描到最大的頻帶能量，比門檻值
小的 epoch 歸為類別一，比門檻值大的 epoch 歸為
類別二。兩類別各代表的睡眠階段，依照往後不同
的分類問題做設定；再以睡眠技師的標註結果為標
準答案，計算分類精度。在 62個人資料庫中，以總
精度最佳的門檻值切割結果，當作此頻帶能量的最
佳分類精度。最後找出所有可能的頻帶能量中，分
類精度最好的頻帶能量當作特徵。 
3.2.2 建立四階段分器 
本文使用類神經網路作為各階段的分類器[1]，由
於類神經網路具有學習、優異的容錯能力及引申能
力，其非線性運算架構，透過訓練法則的調整，可更
有彈性的模擬真實世界資料間的複雜映射關係。所以
本研究採用可做為一般用途的多階層感知器
(Multilayer Perceptron, MLP)類神經網路[3]為分類器。 
使用 3.2.1節介紹挑選特徵變數的方法，各階段挑
選 3維單點值特徵和 5維直方圖特徵當作類神經網路
的輸入建立各階段分類器。 
 
3.3 進行整夜睡眠階段判讀作 
使用訓練完成的類神經分類器進行個人整夜睡眠
階段的判讀工作，如圖 3.3 所示，其判讀流程如下。
首先使用第一階段分類器將慢波睡眠期判別出來，如
圖 3.4 所示。接著進入第二階段分類器將其它睡眠期
切割成清醒期與睡眠第一期一群，快速動眼期與睡眠
第二期一群，如圖 3.5 所示。最後，再分別使用第三
階段分類器區分出清醒期與睡眠第一期，第四階段分
類器區分出快速動眼期與睡眠第二期，如圖 3.6與 3.7
所示。 
 
 
圖 3.4 建立第一階段分類器之流程圖 
 
 
圖 3.5 建立第二階段分類器之流程圖 
 
圖 3.6 建立第三階段分類器之流程圖 
 
 
圖 3.7 建立第四階段分類器之流程圖 
 
3.4 鄰居法則修正 
所謂「鄰居法則」的方法[2]為先將整夜眼動訊號
送進 3.2 節訓練完成的各階段分類器進行測試，將測
試結果(即網路輸出值)記錄起來。接著將該階段欲進
行分類的所有 epoch，各自對應睡眠記錄的位置找出
前後 epoch，選取此三個 epoch於之前記錄的網路輸出
值，當作輸入變數訓練新的分類器，本文稱之為鄰居
法則分類器。 
 
四、結果與討論 
本研究的實驗資料來源為中國醫藥大學附設醫院
睡眠檢查室 2005~2006年的睡眠檢查資料。從中選取 
62 名受測者當作實驗資料庫，選取標準為睡眠效率
(Sleep Efficiency)大於 75%以上，睡眠呼吸障礙指數
(Respiratory Disturbance Index, RDI) 小於 10以下，其
中睡眠效率定義為全部睡眠時間 佔全部記錄時間的
比例，睡眠呼吸障礙指數定義為睡眠中每小時發生呼
吸中止與淺呼吸的次數。62名受測者的資料整理於表
一中。 
 
 
國科會補助計畫衍生研發成果推廣資料表
日期:2011/10/16
國科會補助計畫
計畫名稱: 以單頻道眼動圖為依據的睡眠階段判讀技術
計畫主持人: 嚴成文
計畫編號: 99-2221-E-110-073- 學門領域: 生醫技術及自動化
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
無 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
