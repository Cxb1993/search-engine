 2
研究目的 
本研究目的是利用有效的切割技術來開發一個電腦輔助診斷系統，以期改善
現有的特徵萃取技術，增加為來自動診斷的準確率。同時藉由視覺化工具描繪腫
瘤之 3D圖像，以協助醫護人員觀測。本計畫的結果，將有助於突破現行三維超
音波乳房影像處理技術的瓶頸，未來更希望可利用此技術回頭改良星狀體、微鈣
化等偵測方法，並再引入更多的特徵，以改善目前三維超音波乳房影像診斷的準
確率。研究方法之流程圖如圖一所示。 
 
圖一 流程圖 
文獻探討 
目前的電腦輔助偵測系統（CAD）通常都是從 2D 或 3D 的超音波影像中切割
出異常的部分，如腫瘤，再針對該異常來評估其良惡性；因為超音波影像通常解
析度較低，而且訊雜比(SNR)也較低，因此在切割的問題上就顯得格外複雜。在
超音波醫學影像，前處理中常遭遇的挑戰除了須降低大量的雜訊之外，還必須消
除超音波影像中特有的「陰影」（acoustic shadow或 shadowing effect）。目前
乳癌研究的腫瘤切割問題已有不少研究來加以探討[9-11]。現階段最常被提出的
切割技術則是使用 active contour model；早期的發展有「snake」，或「balloon」
等[12;13]；近年來則有越來越多的切割技術都和等階集合法（level set method）
有關[14]。使用等階集合法有能力去處理尖銳的端點與內凹角，同時最後仍能產
生一封閉曲線的腫瘤輪廓；然而，要找出最佳的參數解實屬不易，使得此方法的
強健性（robustness）不足，這是未來在技術發展過程中，需要進一步解決的。 
研究方法 
1. 影像擷取 
3D 超音波影像由奧地利 Kretztechnik AG 公司所生產的 Voluson 730超音
波儀器來取得。包括良性腫瘤 110 筆、惡性腫瘤 111筆，共 221筆資料。所擷取
的影像由該儀器自動以檔案的方式來儲存，並且使用該公司所開發的 3D View 
2000 將原始影像先轉存成笛卡兒座標系（Cartesian Coordinate System，又稱
直角座標系）之後，再根據縱切面的方向（Transverse View）來擷取資料體的
2D 切面。 
 
2. 影像前處理 
 4
為了強化影像當中腫瘤的邊界，我們採用統計的方法來增強影像。我們的方
法基於一個區域範圍 Sxyz來進行。對於三維影像中某一點位於(x, y, z)的像素
而言，我們計算 Sxyz內其區域的變異數（local variance） 2Lσ ，計算的結果 rescale
到 0至 255 之間後，再做直方圖均值化（histogram equalization）。由於位於
邊界上的像素處於灰階變化較為劇烈的地帶，因此區域變異數比起其他灰階變化
和緩的地帶來得大，將像素灰階以區域變異數來指定的結果，將使邊界部分的亮
度明顯提高。本研究區域變異數的計算乃考慮一個三維範圍，因此更可以突顯空
間中邊緣的資訊。由於區域變異數使得背景與腫瘤內部同時變暗，為提高背景的
亮度，因此最後，影像的灰階 f(x, y)再以區域平均數（local mean）mL 來做以下
的調整： 
),(),(ˆ yxfmyxf L ×= α  (2) 
其中，α為常數（本實驗採用 0.5 作為α值）。 
 
3. 光譜色彩表對應 
一般來說，並不是所有乳房的組織都會發生腫瘤的變異；腫瘤最主要的發生
位置在於乳房內部的乳腺區域（Mammary Zone）。超音波掃瞄身體內部後其影像
是以灰階的方式來呈現，利用灰階影像來觀察並記錄結構的變異經常會因此遺漏
一些重要的影像資訊。本計畫經由透過光譜色彩表的轉換後，可給予灰階影像更
多色階上的層次變化，即可從原來影像中去觀察到在極亮與極暗的區域內部灰階
變化的情況。 
在彩色影像中低灰階的部分由紫色（範圍自 R:255，G:0，B:255至 R:100，
G:0，B:255）與藍色（範圍自 R:101，G:0，B:255至 R:0，G:145，B:255）所組
成，在本研究中所提出的切割方法中，將低灰階區塊定義成紫色與藍色的區域兩
部分。紫色區域的輪廓作為初始輪廓，並連續擴增範圍，再未接觸陰影的情況下
逼近藍色區域。如圖四所示，圖四(a)至(d)分別代表一個 3D 影像中的連續切面，
畫面中呈現藍色與紫色的部分對應於腫瘤或陰影的部分。如果持續追縱圖四(a)
中的區塊 A，可以發現至(c)圖為止，其外圍的輪廓都是漸漸變化的，直在(d)圖
中，腫瘤與下方陰影合併的時候，輪廓從突然延伸至影像的下緣。當區塊擴張的
同時如發現的其所佔的範圍驟昇時，便可因此找到受陰影干擾的影像。 
    
(a) (b) (c) (d) 
  
圖四 光譜色彩表對應後之結果。圖(a)至(d)為連續切面。 
 6
像中的機率分佈，因此， 10 ≤≤ iP  且 11 =∑ =
k
i i
P ，當中的 k是影像的總像素
[16;17]。 
(2) 平均灰階：因為腫塊的灰階分佈通常較低，所以將區塊的灰階分佈除以影
像之灰階分佈，再做正規化，取得區塊的平均灰階值。 
(3) 面積比：通常在影像中，腫塊的區域會比陰影區塊來得大，因此利用區塊
的像素個數與影像總像素之比值，若得到的值越大就越有可能為腫瘤。 
(4) 區域比：區塊的像素個數與框住區塊的最小矩形面積之比值，期望區塊盡
量能夠為實心的。 
(5) 長寬比：找到框住區塊的矩形長寬越接近時，表示區塊越接近圓形，因此
較可能為腫塊。 
(6) 中心距離：通常在影像中，腫塊的位置較接近影像的中心位置，因此，利
用區塊的重心與影像中心的距離，當區塊越接近影像中心，越有殼能為腫
塊。 
(7) 圓弧性(circularity)：利用區塊中心到區塊邊界之距離做為區塊的半徑，
將區塊半徑作正規化，計算出它的標準差[18]，當標準差越小，越有可能
為腫塊。 
,...,N,,,   i
id
-Yiy-Xix
id 321))((max
))(())(()(
2
0
2
0
=
+
=   (4) 
 式(2)中， )( 00 , YX 和(x(i) , y(i))分別為區塊的中心和它的邊界的像素值。 
 而正規化的半徑平均值定義為： 
∑
=
=
N
i
id
N
d
1
avg )(
1
 (5) 
 則正規化的半徑標準差計算式如下： 
2
1
avg)(1
1
∑
=
−
=∂
N
i
)-di(d
N
  (6) 
 
5. 區塊追蹤比對 
從參考影像所圈選的腫瘤區塊與背景區塊，可作為鄰近影像用以切割腫瘤的
依據。首先，在彩色影像中找出藍色圍繞的低灰階區域（臨界值 R:0，G:145，
B:255）。此區域先分別與前一張的腫瘤區塊與背景區塊做比對，找出與腫瘤和背
景有重疊的部分之後，如發現為同一連通區域 C，代表影像中可能受陰影所影
響，導致腫瘤與背景部分相連。如此一來，則向紫色區域（R:100，G:0，B:255）
逐步縮減邊緣，以將腫瘤與背景區塊分離。如果縮減至紫色區域仍無法有效分
離，便直接找出原影像中與腫瘤參考區塊以及與背景的交集。將區塊依腫瘤部分
和背景部分分開以後，令其分別以 T0與 B0表示。接下來，以 T0與 B0作為初始化
 8
模型來預測，其結果將得到一個介於 0與 1 之間的數值，以代表此區塊為腫
瘤的機率。我們挑選最大機率的區塊其所在的影像，作為參考影像。針對 23
筆良性病例、71筆惡性病例資料，其預測結果在良性中有 11個病例預測正
確，惡性中 45預測正確，在惡性病例中所預測的準確率較高；主要由於在惡
性病例中之腫瘤通常較大、且特徵較為明確。反之，在良性腫瘤的病例中，
由於腫瘤通常較不明顯，或特徵不夠突出，因此容易將背景區塊誤判為腫瘤
區塊。另外，在表一中可以發現，七個特徵中除了長寬比與圓弧度以外，大
部分的特徵其 p-value 皆小於 0.01，顯示其腫瘤與背景區塊的型態特徵具有
統計上的差異；而長寬比與圓弧度的 p-value 則大於 0.01，表示腫瘤與背景
區塊的型態特徵無顯著差異，可能也是因此造成預測準確率下降的原因之一。 
 
2. 切割結果 
以下為利用本研究針對一惡性病例所進行切割的結果： 
   
(a) (b) (c) 
   
(d) (e) (f) 
 
 
 
圖六 (a)原圖（編號 80）；(b)利用類神經網路自動找出之腫瘤參考影
像；(c) 背景參考影像；(d)～(f) 切割結果與前處理結果疊合之影像（編
號 81、編號 126 以及編號 156） 
 
圖七為利用 VTK 將切割結果以 3D視覺化重建的結果；在本病例中，原圖受陰
影干擾的情況較為輕微，因此切割效果效果十分良好。目前切割的結果仍以
主觀判斷來驗證其切割效果的優劣。如陰影干擾嚴重，則會影響參考影像的
判讀，並進而降低切格的準確率。 
