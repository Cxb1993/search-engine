行政院國家科學委員會補助專題研究計畫成果報告 
高性能與多功能之數位多媒體驗證技術之研究 
High-performance and multi-purpose authentication techniques for 
digital multimedia 
計畫編號：NSC 95-2221-E-415-009-MY3 
執行期限：95 年 8 月 1日至 98 年 10 月 31 日 
主持人： 陳宗和 
E-mail: thchen@mail.ncyu.edu.tw 
Http://web20.ncyu.edu.tw/thchen 
執行機構及單位名稱：國立嘉義大學資訊工程系 
 
 
摘要 
由於網際網路頻寬的快速成長，讓整批
式大量靜態影像的傳輸及分享變得普及大
量的資訊傳輸越趨頻繁。然而保密性及驗證
性一直是多媒體安全的兩個主要的議題。一
般而言，影像的檔案大小一向遠大於文字檔
案，所以以傳統數位簽章來驗證影像太過於
耗時。由於上述的這些原因，於本研究中我
們提出一個結合影像的壓縮與驗證的方法
來達到批次影像驗證。影像壓縮部分，採用
向量量化(VQ)技術的原因著眼於安全的前
提上提供可接受的影像品質。我們使用一種
針對批次影像傳輸量身訂做的驗證方法，其
植基於偵測惡意修改被保護影像的浮水印
技術。主要部分不只包含高壓縮率與安全
性，而且傳輸頻寬的要求較低，並且適用於
低運算能力的硬體裝置。 
關建字：批次影像驗證，影像壓縮,向量量
化  
Abstract 
Because of the rapid growth of Internet, 
the large amount of information transmission 
is frequent, and the security of the information 
is always one of the main concerns. However, 
it is widely known that the image size is larger 
than text file in general. For these reasons 
mentioned above, we propose a novel scheme 
that combines image compression with image 
authentication to achieve the batch-image 
authentication in this research project. On 
image compression, Vector Quantization (VQ) 
is a method which offers acceptable quality of 
image compression. On security, we use a 
tampering authentication scheme based on 
watermarking techniques to protect the 
rightful ownership and detect malicious 
manipulation over the protected images. The 
main contribution of the proposal scheme 
includes not only high compression ratio and 
security, but also low transmission bandwidth 
and light-weighted hardware device 
requirement. 
Keywords: Image compression, batch image 
authentication, Vector Quantization 
 
1. Introduction 
Multimedia transmitted via the Internet 
which has grown rapidly is more popular. 
People usually send their digital pictures to 
others via e-mail and make good use of an 
online file transfer service to share their 
pictures in the way of batch-of-image 
transmission over the public network. The 
integrity, most current image authentication 
techniques were aimed to encrypt a single 
image rather than a batch of images. That is, 
the existing research neglects the fact that 
distributing digital images in the way of batch 
transmission is becoming popular among 
people going about their daily lives, as well as 
people in electronic commerce. 
In addition, the other inevitable fact 
should be taken into account simultaneously. 
Due to limited communication bandwidth, 
almost all images transmitted over the public 
networks are in a compressed form to save 
transmission time and storage space.  
To the best of our knowledge, the schemes 
in Ref. [3][12][16] are the first to provide the 
approach to encrypt a batch of images by 
means of combing the VQ and a encryption 
method. Unhappily, there is no batch image 
authentication presented so far.  
The two above-analyzed requirements in 
practice signal the dawn of spectacular new 
opportunities to combine compression and 
authentication to a batch of images.  
Inspired by Ref. [11], the authors present a 
novel batch authentication scheme combining 
with VQ compression and the improvement of 
Li et al.’s scheme. In the literature, this is the 
first attempt to achieve the goal of batch 
image authentication. The VQ compression 
technique is facilitated to compress a batch of 
images and then further extract the feature, 
used for later authentication by SHA-256, 
from the indices. The extracted authentication 
bits are watermarking into the protected 
images. Image integrity is guaranteed by 
demonstrating the capability of tamper 
detection in the experimental results. 
 
2. Proposed scheme 
The proposed scheme is consisted of two 
phases: embedding and detection phases. The 
operations are illustrated in Figures 2 and 3.  
2.1 Embedding phase 
Step E1. According to the original images 
xO (x=1…p for p  images), a VQ 
codebook is obtained, which is 
generated by the well-known LBG 
algorithm [20]. Then, upon 
compressing xO  by using the VQ 
codebook, VQ indices xI  of each 
original image is obtained. All xI  
are shuffled in a pre-defined way, 
which may be public or kept secret, 
to form an index table I. Finally, the 
index table is divided into the 
overlapping blocks each with 3×3 
indices in size. Every block 
overlaps with its neighboring blocks 
and is two-index apart, illustrated in 
Figure 1(a). The structure of an 
overlapping block is illustrated in 
Figure 1(b). 
Step E2. Select a block yb as shown in 
Figure 1(b) with size of 3 x 3 
indices from I. Compute 
)2mod( 00
ryy PPm −= . To decide 
the parameter r of folding, 
compute 
( ) 8/(
8
1
8mod1 ⎟⎠
⎞⎜⎝
⎛ −= ∑
=
+
i
y
i
y
i PPσ . To 
limit the distortion introduced from 
embedding, the parameter r  may be 
2, 3, and 4 for 
255 and ,,0 2211 ≤≤<≤<≤ σσσ tttt
, and the thresholds of 1t and 2t  is 
8 and 16.  
Step E3. Compute the feature of each index 
block by the keyed hash function 
)|||||...||( 821 SKIDMmPPPH
yyy  
where H is the hash function using 
tamper, irrelevant logos are inserted into those 
images as tampered images, illustrated in the 
left column of Figure 6. The detection results 
are given in the right column of Figure 6. 
Table 1 shows the quality of the protected 
images which are measured by 
Peak-Signal-to-Noise Ratio (PSNR). The 
authentication operation decreases the visual 
quality of protected images about 2 to 4 dB 
.  
4. Discussion 
The discussions in terms of compression 
and authentication are presented to highlight 
the advantages of the proposed scheme. 
Compression: With valuable advantages such 
as high compression ratio and simple 
implementation hardware, VQ is a good 
candidate for lossy compression with 
acceptable image quality. The proposed 
scheme combines two techniques, image 
compression and authentication, to form a 
novel batch image authentication.  
Authentication: The experimental results 
above-mentioned illustrate feasibility of 
tamper detection of all protected images. The 
main advantages of the proposed scheme are 
highlighted below.  
(1) Sensitivity to tamper attack: The proposed 
scheme can ensure integrity of a batch of 
images. 
(2) Localization accuracy: Localization 
accuracy of block-based authentication is 
bound by the block size. It accurately 
detects the alterations as small as 3x3 
image blocks. 
(3) Imperceptible watermarking: The 
proposed fragile watermarking scheme 
introduces imperceptible distortion to the 
protected images. 
 
5. Conclusion and future work 
In this research project, we propose a 
novel scheme of batch authentication that 
combines Vector Quantization and the 
improvement of Li et al.’s scheme. Because 
the distortion of image is acceptable for 
human’s vision, using VQ compression can 
offer high performance with calculating and 
has low hardware structure required. On 
detection, it does not need the original image 
to find the modified. When the batch images 
transmitted, the user can only send the batch 
index file to save the bandwidth. The 
experimental results illustrate the proposed 
scheme is sensitive when the indices have 
been modified. It is the future work to extend 
the proposed scheme to have the capability of 
tamper recovery. 
 
Reference 
[1] Ahmed, N, Nataraian, T, Rao, K, R, 
“Discrete Cosine Transform” Computers, 
IEEE Transactions on, Vol. C-23, 
pp.90-93,1974. 
[2] A. Gersho, R.M. Gray, ”Vector 
Quantization and Signal Compression.” 
Boston, MA: Kluwer, 1993. 
[3] Chang C. C., Hwang M. S., Chen T.S., 
“A new encryption algorithm for image 
cryptosystems,” The Journal of Systems 
and Software, Vol. 58, No. 2, pp.83-91, 
September 2001. 
[4] C. C. Chang and C. Y. Lin, “Reversible 
steganography for VQ-compressed 
images using side matching and 
relocation,” IEEE Transactions on 
Information Forensics and Security, Vol. 
1, No. 4, pp. 493-501, December 2006.  
[5] C. C. Chang and W. C. Wu, “Fast 
planar-oriented ripple search algorithm 
for hyperspace VQ codebook,” IEEE 
Transactions on Image Processing, Vol. 
16, No. 6, pp. 1538-1547, June 2007. 
 
Figure 1: (a) The diagram of choosing blocks; (b) each chosen index block. 
 
 
Figure 2: The procedure of batch image authentication  
 
 
 
Shift two indices
Shift 
Two 
indices b1 b2 
Block:  
(a)
(b) 
  
   
   
yb
yP3 yP2
yP1
yP0yP4
yP5
yP6 yP7
yP8
Original 
Images Vector Quantization
Feature 
Extraction 
Folding 
  VQ 
Indices
Embedded 
Images 
modify 
indices 
Embedded 
image Inverse of VQ
  Embedded 
Indices 
Embedding 
Into LSB 
Embedded 
images 
(a) (b)  
(c) (d)  
Figure 5: The four decoded images (a) Spaceman, (b) Pepper, (c) Lena and (d) F16. 
 
  
(a) The tampered Spaceman and the result of detection. 
 Table 1. The PSNR values after vector quantization and embedding 
Image Lena F16 Pepper spaceman 
After VQ 30.70(dB) 29.14(dB) 31.04(dB) 30.89(dB) 
After Embedding 27.48(dB) 26.69(dB) 27.94(dB) 28.41(dB) 
 
 
研究成果自評 
本研究計畫在三年內研究許多適用於現有多媒體驗證技術的通用型架構，可應用於現有的
多媒體驗證技術，保留原有技術的優點，同時提供更多的彈性來加強其現有之功能。本研
究計畫研發的多媒體驗證技術符合現有多媒體世界的發展、傳輸及使用趨勢，頗具有實用
的價值。在研究過程中藉著多樣化的文獻研讀，也激發研究人員產生各式各樣的想法，進
而發表一些期刊以及會議論文，其中更不乏國際一流期刊，此研究不僅提升我國之學術水
準，同時也提升我國在國際上之學術地位。由於網路的蓬勃發展，有越來越多的數位內容
透過線上傳輸的方式散播，而多媒體驗證系統 無論對於線上音樂、隨選視訊以及公司內
部的檔案控管皆扮演關鍵的角色，預期此技術更加成熟之後，未來將可吸引更多的人員參
與，並可開發更多新的應用，因此我們的計畫非常具有實用價值和前瞻性，對於提升我國
資訊產業之國際競爭力，必定有相當大的幫助。 
 
論文發表 
期刊論文 
[1] Tzung-Her Chen, and Chang-Sian Wu, (2008) "Integrated Batch Encryption to Still 
Images," Journal of Chung Cheng Institute of Technology, Vol. 37, No. 1, pp. 81-88. (EI) 
[2] Tzung-Her Chen, (2009) "An Authentication Protocol with Billing Non-Repudiation to 
Personal Communication Systems," International Journal of Innovative Computing 
Information and Control, Vol. 5, No. 9, pp.2657-2664. (SCI impact factor: 2.791, ranking: 
13%)  
[3] Du-Shiau Tsai, Gwoboa Horng, Tzung-Her Chen*, and Yao-Te Huang, (2009) "A novel 
secret image sharing scheme for true color images with size constraint,"Information 
Sciences, Vol. 179, Iss. 19, pp. 3247-3254 . (SCI impact factor: 3.095, ranking: 8%) 
會議論文 
Multimedia Signal Processing (IIHMSP-2009), Kyoto, Japan, Sep.12-14, 2009. 
[13] Tzung-Her Chen, Yan-Ting Wu, and Yue-Rong Lin, "Medical Video Encryption Based on 
H.264/AVC with Near-Lossless Compression," International Conference on Intelligent 
Information Hiding and Multimedia Signal Processing (IIHMSP-2009), Kyoto, Japan, 
Sep.12-14, 2009. 
 
 
參與人員獲得之訓練 
1) 學習收集及整理及分析資料的步驟及方法 
2) 獲得論文之文獻研究，問題發掘，方法的研發，實驗的驗證及分析與論文撰寫等 
3) 瞭解設計批次多媒體驗證的困難處及關鍵點 
4) 學習數理分析的技巧，由現有的資訊及所學的知識，解決未知的問題，創造出更有效率
及更實用之方法 
5) 由實驗中瞭解實作將可能會遭遇的瓶頸及解決方式，進而建立實作的自信心 
6) 從實際的研究經驗及實驗過程中獲得的寶貴經驗。 
 
Security)。 
以下簡單介紹這次會議上的論文。 
Chen and Lee 提出一個基於隨機網格(random grid)的視覺秘密分享法，並且加
上 friendly management 和 progressive visual quality 兩個功能， 並解決了
傳統視覺密碼學所會造成的像素擴張(pixel expansion)問題。這次會議中有許
多關於「data hiding」 的論文，Sun et al. 提出一個方法達到增加秘密影藏的容
量基於 EMD (exploiting modification direction)系統上。Lin et al. 提出的「data 
hiding」方法應用數獨(sudoku)的特性，並且利用在資訊影藏上。此外，還有
Lossless information hiding…等相關的議題以及應用。 
唯該會議上對 video 及 H.264 的議題非常少，所以我們的第二篇論文顯得比較少
有人提出問題。 
七、與會心得 
會中國內兩位教授無法順利完成報到手續，後來才確定是日本方面主辦單位的疏
失，這讓我重新對日本人的作事態度有了一些修正。 
日本京都對文化遺產之保護不遺餘力，市區很少看到大興土木的現代化工
程，直覺想到台南府城。 
期間遇到兩對來自美國加州的七十歲老先生及老太太對台灣的資訊產品十
分讚賞，直問 Acer 是不是最好的品牌，他也買了一台灣製的 video camera， 但
是牌子我們沒有聽過，但是聽到外國人熱愛我們的產品，也是一件十分榮耀的事。 
智慧型資訊隱藏與多媒體訊號處理國際研討會(IIHMSP-2009)已是第五屆
辦理，第三屆在高雄舉辦我們也曾參加並發表論文，其所舉辦了有關資訊安全、
多媒體安全以及多媒體訊號…等許多研究議題的研討會對多媒體安全研究領域
的學者來說是最具有代表性及重要性的會議之一，特別是對台灣、日本及大陸的
學者。這次會議中，聽到許多新的問題以及議題的發表，由這些可以粗略瞭解目
前及未來的走向。 
八、攜回資料名稱及內容 
