I 
中文摘要 
由於經濟快速成長與生活水準提高，致使夏季尖峰時期冷氣負載
急遽增加，造成負載因素持續惡化，需求面管理乃成為電力公司營運
的重要策略，以有效利用現有發電設備並緩和電源開發之壓力。然
而，近年來各項負載管理措施實施成效趨於平緩，進行各項負載管理
措施特別是空調直接負載控制之績效評估，即成為電力公司據以參考
改善相關負載管理策略與訂定未來負載管理目標值之重要手段。 
本計畫以網路監測技術，開發一遠端電能使用監測系統，可藉由
網際網路與萬用串列匯流排（USB）介面為基礎之虛擬儀表監控和收
集參與空調直接負載控制或節約能源措施用戶用電資料。遠端虛擬用
電監控系統所收集用電資料提供自動分類直接負載控制曲線系統作
實施分類，鑑別實施效果不彰與實施狀況良好之負載。對於實施狀況
良好之用戶而言，本計畫遵循國際成效量測與驗證規範（International 
Performance Measurement and Verification Protocol, IPMVP），擬定績
效評估模式，以估算其抑低負載量與轉移用電量；對於實施效果不彰
之用戶則予以剔除。 
計畫內為有效達成直接負載控制曲線之分類目標，首要工作在於
負載特徵之擷取。是故，本計畫探討以非線性主要成份分析與週期性
分析兩種特徵擷取方法，擷取各負載之重要特徵，其中非線性主要成
份分析法應用對偶式類神經網路技巧擷取其負載特徵，而週期性分析
則擷取其週期性特徵，以供各負載分類之重要依據。 
為驗證所提直接負載控制曲線分類系統與績效評估之可行性，本
計畫實際測試於台電夏季實施中央空調負載管理措施資料，其中包含
中央空調週期性暫停用電、中央空調遙控降載週期性暫停用電與儲冷
式空調系統等負載管理措施。 
為有效達成監測與自動分類直接負載控制曲線，並達到有效之中
央空調負載管理績效評估之目的，以估算其抑低負載量與轉移用電
III 
ABSTRACT 
Owing to rapid growth of economy and living standards on Taiwan, 
the summer peak loads, mainly resulted from the air-conditioner loads, 
have increased drastically faster than the average loads. As a result, the 
load factors become worse and worse, a fact that makes the demand side 
management (DSM) evitable for the utilities. The DSM provides 
solutions to efficient utilization of existing power apparatus and reduction 
of the pressure of installing new one for the utilities. However, in recent 
years the effectiveness of DSM strategies is slowing down. Performance 
valuation of the existing DSM strategies, particularly for the 
air-conditioner direct load control (DLC), would be an important 
approach to further improving the DSM strategies and determining the 
targets for the future DSM. 
The project aims at developing the virtual instrument 
power-remote-monitoring system for energy use. Through internet web 
and USB interface based virtual instrument, the system collected the data 
for the electricity consumption of the customers that were involved in the 
programs of demand management or energy conservation. The data 
remotely collected for the DLC curves were then classified by an 
automatic classification system. Through the system, identified are either 
the DLC curve that complies with the control model of a specific DLC 
program or the other one that does not. For the one complying with the 
DLC model, the evaluation models based on International Performance 
Measurement and Verification Protocol (IPMVP) have been developed to 
evaluate the performance of the DLC program, i.e., the amounts of load 
reduction or shifting of the customers that commit the DLC programs. 
The load curve that does not comply with the DLC model was excluded 
from the database and not taken into account in the performance 
evaluation. 
V 
related load management strategies were then evaluated for the 
efficiency of load reduction and transfer of the customers. 
Accordingly, the DLC strategies and energy conservation 
programs can be improved expectedly. 
 
Keywords: remote monitoring system, direct load control, feature 
extraction, performance evaluation, artificial neural networks 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
VII 
2.2.3 週期性分析 .........................................................................24 
2.2.4 綜合結論 .............................................................................26 
2.3 直接負載控制曲線之分類方法..................................................26 
2.3.1 自我組織映射網路分類系統架構 .....................................27 
2.3.2 基本自我組織映射網路 .....................................................29 
2.3.2.1 網路架構 ....................................................................30 
2.3.2.2 網路演算法則 ............................................................33 
2.3.3 批次自我組織映射網路 .....................................................36 
2.3.3.1 網路演算法則 ............................................................37 
2.3.4 聚類整合與資料分析 .........................................................40 
2.3.4.1 聚類整合 ....................................................................41 
2.3.4.2 資料分析 ....................................................................44 
2.3.5 聚類整合適切性分析 .........................................................45 
2.3.6 綜合結論 .............................................................................48 
2.4 直接負載控制之績效評估模式..................................................48 
2.4.1 中央空調週期性暫停用電之績效評估模式.....................49 
2.4.1.1 抑低負載量績效評估模式 ........................................49 
2.4.1.2 減少用電量績效評估模式 ........................................52 
2.4.2 儲冷式中央空調績效評估模式 .........................................53 
IX 
3.2 第二年度......................................................................................87 
3.2.1 測試資料說明 .....................................................................89 
3.2.2 分類結果討論 .....................................................................90 
3.2.2.1 中央空調週期性暫停用電 ........................................90 
3.2.2.2 中央空調遙控降載週期性暫停用電 ........................94 
3.2.2.4 結果比較與討論 ........................................................99 
3.3 第三年度....................................................................................102 
3.3.1 績效評估數值計算 ...........................................................102 
3.3.2 結果比較與討論 ...............................................................105 
肆、參考文獻.........................................................................................106 
伍、計畫成果自評.................................................................................109 
陸、附錄……………………………………………………………… 111 
 
 
 
 
 
 
 
 
 
 
 
 
XI 
圖 2.20 自我組織映射網路的網路模型.................................................30 
圖 2.21 自我組織映射網路之網路拓撲.................................................32 
圖 2.22 神經元所受刺激強度與距離之關係圖[29]..............................33 
圖 2.23 基本自我組織網路之訓練流程圖.............................................35 
圖 2.24  Voronoi 集合之示意圖 ............................................................38 
圖 2.25 批次自我組織映射網路演算法則之流程圖 ............................39 
圖 2.26 自我組織映射網路之聚類分析示意圖.....................................41 
圖 2.27 聚類分析之樹狀結構圖.............................................................43 
圖 2.28 群內與群間之距離示意圖.........................................................47 
圖 2.29 反饋現象之例.............................................................................50 
圖 2.30、用電監測虛擬儀表方塊圖[1] ..................................................56 
圖 2.31 12 位元類比數位轉換器功能方塊圖.........................................57 
圖 2.32 AN2131S 架構圖.........................................................................57 
圖 2.33 USB 之核心 .................................................................................59 
圖 2.34 巨量傳輸.....................................................................................62 
圖 2.35 控制傳輸.....................................................................................63 
圖 2.36、中斷傳輸...................................................................................63 
圖 2.37 等時傳輸.....................................................................................64 
圖 2.38 巨量傳輸.....................................................................................65 
XIII 
...........................................................................................................96 
圖 3.18 遙控降載週期性暫停用電之階層式聚類分析圖 ....................96 
圖 3.19 遙控降載週期性暫停用電之 DB 適確性指標結果 .................97 
圖 3.20 儲冷式中央空調系統之樹狀聚類分析圖.................................98 
圖 3.21 儲冷式中央空調系統之 DB 適確性指標結果 .........................99 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
1 
壹、計畫緣由與目的 
隨著經濟快速成長與生活水準提高，國人對於電力之需求愈為
殷切，導致夏季時期尖峰負載持續攀升，造成台電發生供電不足問
題。加上台灣地區產業型態改變，致使尖離峰負載差距逐年加大，
在夏季尖峰負載時期，冷氣負載約佔總用電負載的 1/3 至 1/4，且逐
年增加，因此造成夏季用電急遽增加，進而導致夏季供電短絀。 
由於電力是一種無法大量儲存的產品，所以在電力生產時必須同
時消費，亦即供給與需求是瞬間達成的，縱使可以儲存電力成本亦非
常高，僅侷限於特殊用途。一般用電習性其用電時間有集中之趨勢，
因此用電時間便有尖離峰時間的劃分，如何設定最佳發電容量乃是電
力供應者重要問題之一。此外，再加上電源開發因土地取得不易、環
保抗爭與民眾阻饒之壓力，以致使電廠設置工程屢遭延滯，並且在土
地成本逐年高漲的情況下，使得電廠設置困難，因而導致電力供應無
法與經濟發展同步成長。因此，增建足夠電廠不再是唯一解決之道，
於是積極推動負載管理措施，亦即需求面的負載管理策略已成為電力
公司營運的重要策略，以求有效利用現有發電設備緩和電源開發之壓
力。 
負載管理措施[1-3]係為了提昇電力使用效率，對用戶調節其用
電負載結構的措施，其基本方法是尖峰時段用電者，須付出較高之
電價；可減少尖峰用電或移轉用電至離峰者，則享有較便宜的用電
成本。如此雙方均能獲得好處，進而提昇用電效率，並避免不必要
之限電，而電力公司也能節省開發新電廠成本、避免高負載時之高
運轉成本與提升服務品質。因此，電力公司實施負載管理措施主要
目的在於抑低尖峰負載與減少用電量，提高電力系統之利用率，減
少成本昂貴之機組運轉時間，以及延緩新電廠之新建。 
3 
類系統需要能具有依照輸入資料分佈特性進行分類的能力，也就是
在篩選空調負載管理用戶實施績效時，該分類系統可自動將實施不
彰之用戶予以剔除不納入績效評估模式內，而保留實施狀況良好之
用戶，據以由計算機程式實施績效評估之計算。因此，擬定各項空
調負載管理措施績效評估模式，以獲得各空調負載管理措施之實施
績效，亦即可瞭解各參與用戶之尖峰用電抑低效果或轉移成果。因
此，本計畫透過所建立之績效評估系統，一方面，提供我國空調管
理措施之績效評估模式；另一方面，提供我國空調管理措施的改善
參考，據以進一步提昇負載管理成效，改善我國電力系統負載因
素，減少不必要之機組發電容量投資。歸納本計畫所提出之直接負
載控制之分類系統與績效評估模式的貢獻有： 
1. 以 USB 介面與網路監測技術，開發一近端與遠端電能使用之
監測系統，藉由網際網路監控和收集參與空調直接負載控制
或節約能源措施用戶用電資料。 
2. 本分類系統可正確檢測中央空調負載管理措施實施狀況不彰
之用戶，並可精確提供績效評估模式所需負載管理實施狀況
良好之用戶，以進行績效評估。 
3. 本計畫所提出的兩種直接負載控制曲線特徵擷取方法，能夠
保有原資料之特性並且降低資料之維度。在非線性主要成份
特徵擷取方面，它能夠處理非線性系統之特徵擷取問題並有
效減少資料維度。週期性分析法特徵擷取方面，則可擷取具
有週期特性之負載資料特徵，以有助於分類週期特性之負
載。 
4. 本計畫所提出之批次自我組織映射網路演算法不僅可以改進
原自我組織映射網路所遭遇之參數依賴與收斂之問題，更由
5 
行，並且在土地成本逐年高漲的情況下，使得電廠設置更加困難，導
致電力供應無法與經濟發展同步成長。因此，增建足夠電廠不再是唯
一解決之道，是故台電積極推動負載管理措施以有效利用現有發電設
備並緩和電源開發之壓力。 
為確保供電可靠度與提高經營效率，自民國 68 年起台電公司推
動負載管理措施，已經陸續實施時間電價、可停電力、季節電價、儲
冷式中央空調系統、中央空調暨箱型冷氣週期性暫停用電及北部地區
中央空調遙控降載等措施，產生初步之成果。但是，近年來各項負載
管理措施之成效趨於平緩，並處在用電量持續顯著成長和電力供應擴
增不易之情形。本章即針對台電目前各項中央空調負載管理措施之參
與用戶概況與行為特性來詳細說明，以便建立各項措施之績效評估模
式。 
2.1.1 負載管理措施 
「需求面管理」係指透過負載管理措施，包括設置汽電共生設
備、調整用電時段及推廣節約能源，以改善用戶的負載型態，進而達
成均衡電力系統負載，提高發電設施利用率，改善系統負載為目標的
策略。一般而言，推行負載管理措施是為了達到改善系統負載型態，
提高負載因數，以達到抑低尖峰負載與拉高離峰負載為目標。因此，
改善用戶負載型態之目標可分述如下[11]： 
 負載移轉(Load-shifting)：藉由長期蒐集與觀察相關訊息，而研判
出某些定期性的尖峰負載發生情形，一般可以利用蓄電池或改變
用戶用電模式加以解決。 
 拉高離峰(Valley-filling)：於離峰時，由於負載之需求量大量的減
少，勢必造成許多機組停機，若藉由特定機組或特殊需求，以提
高該時段負載，則可以減少機組因啟動或停機期間，所造成不必
7 
2.1.3 中央空調週期性暫停用電 
所謂「中央空調週期性暫停用電」(Central air conditioning duty 
cycling control)係指中央空調冷凍主機施以週期性暫停運轉，以節省
中央空調冷氣用電量。冷凍主機暫停運轉時，冷凍主機空調系統之送
風扇或冷卻水循環泵浦則繼續運轉供應冷氣，藉由冷凍主機之暫停運
轉而達到抑低負載與節約用電之目的。此一措施主要係藉由輪流關閉
冷氣機來抑低電力系統的尖峰負載，由於國內窗型及箱型冷氣機容量
小、數量龐大，不易直接控制，故以裝置中央空調用戶為暫停冷氣用
電策略之對象。根據過去主要針對大型辦公大樓、商業大樓及醫院等
建築物所做的調查發現[12]，在尖峰時刻冷氣空調小時停機或卸載
10~20 分鐘，並不會對大樓內人員產生不舒服感覺，但對抑低尖峰負
載卻有極大的幫助。 
中央空調週期性暫停用電，針對空調主機 20 馬力以上之用戶實
施時間為每日 10 ~ 18 時，日期為每年 6 月 1 日至 8 月 31 日(星期六、
日及例假日除外)，而實施方式係將用戶大約依主機容量平分為 A, B, 
C, D, E 五組並輪流實施每次運轉 60 分鐘，暫停 15 分鐘之暫停作業。
圖 2.1 為中央空調週期性暫停用電之控制方式示意圖，其中採運轉 60
分鐘，暫停 15 分鐘，每日暫停 6 次之方式。 
 
. . . 
60分
10 時
15 分
18 時
 
圖 2.1 中央空調週期性暫停用電之受控方式示意圖 
9 
0
50
100
150
200
250
300
00
:00
01
:00
02
:00
03
:00
04
:00
05
:00
06
:00
07
:00
08
:00
09
:00
10
:00
11
:00
12
:00
13
:00
14
:00
15
:00
16
:00
17
:00
18
:00
19
:00
20
:00
21
:00
22
:00
23
:00
時間
負
載
(k
W
)
 
圖 2.4 某實施中央空調週期性暫停用電之用戶負載曲線 
同。中央空調暫停實施績效不彰之原因，台電公司曾派人加以追蹤檢
討，其原因可能為本措施之實施壓縮機組暫停時可能因室內環境因
素，易造成部份用戶室內溫度昇高，而將參與之機組不常開機以致使
暫停績效顯示不彰。 
2.1.4 中央空調遙控降載週期性暫停用電 
中央空調遙控降載週期性暫停用電(Paging system in central air 
conditioner duty cycling control)係引進國外通訊遙控技術，在夏月期
間每日用電最高峰時段，以無線電控制用戶空調冰水主機，使冰水主
機於短暫期間內降低運轉容量，達到抑低尖峰負載之目的。基本上與
上述中央空調週期性暫停用電措施相似，主要係藉由夏季尖峰時期，
週期性控制空調主機負載為半載，以達到抑低系統尖峰用電。 
本項措施之適用對象是以中央空調系統主機容量一百馬力以上
非生產性質之綜合用電用戶可選用，台電公司於空調主機回路加裝負
載控制模組及無線電傳呼系統信號接收器。圖 2.5 為中央空調遙控降 
11 
之週期性控制。另外，觀察圖 2.7 為某用戶實施遙控降載週期性暫停
用電之負載曲線，負載曲線為非週期性暫停，而與遙控降載受控方式
並未一致，表示該用戶未按照該實施辦法進行遙控降載週期性暫停用
電。表 2.1 為簡述中央空調負載管理措施實施週期性暫停用電之辦
法，以降低系統尖峰負載並舒緩限電壓力為目標。 
0
20
40
60
80
100
120
140
160
180
200
00
:0
0
01
:1
5
02
:3
0
03
:4
5
05
:0
0
06
:1
5
07
:3
0
08
:4
5
10
:0
0
11
:1
5
12
:3
0
13
:4
5
15
:0
0
16
:1
5
17
:3
0
18
:4
5
20
:0
0
21
:1
5
22
:3
0
23
:4
5
時間
負
載
(k
W
)
 
圖 2.7 某實施遙控降載週期性暫停用電之用戶負載曲線 
表 2.1 中央空調負載管理措施實施週期性暫停用電方式簡介 
項目 中央空調週期性暫停用電 中央空調遙控降載 
空調主機 20 冷凍頓以上 主機容量 100 馬力以上 
適用對象 
非生產性質場所之綜合用戶 
每日 10～18 時 每日 10~12 時及 13～17 時 
控制期間 
每年 6 月 1 日至 8 月 31 日(星期六、日及例假日除外) 
運轉 60 分鐘，暫停 15 分鐘 運轉 45 分鐘，暫停 15 分鐘 
控制方式 
每日暫停 6 次 每日暫停 6 次 
 
13 
0
200
400
600
800
1000
1200
00
:0
0
01
:1
0
02
:2
0
03
:3
0
04
:4
0
05
:5
0
07
:0
0
08
:1
0
09
:2
0
10
:3
0
11
:4
0
12
:5
0
14
:0
0
15
:1
0
16
:2
0
17
:3
0
18
:4
0
19
:5
0
21
:0
0
22
:1
0
23
:2
0
時間
負
載
(k
W
)
 
圖 2.9 某實施儲冷式中央空調之用戶負載曲線圖 
0
100
200
300
400
500
600
700
800
00
:0
0
01
:1
0
02
:2
0
03
:3
0
04
:4
0
05
:5
0
07
:0
0
08
:1
0
09
:2
0
10
:3
0
11
:4
0
12
:5
0
14
:0
0
15
:1
0
16
:2
0
17
:3
0
18
:4
0
19
:5
0
21
:0
0
22
:1
0
23
:2
0
時間
負
載
(k
W
)
 
圖 2.10 某實施儲冷式中央空調之用戶負載曲線圖 
表 2.2 所列為儲冷空調之運轉模式，其中全量儲冰系統之冷凍主
機於離峰或非空調時段運轉儲冷，並於尖峰或空調時段完全停止運
轉，由儲冷設備提供空調能力，而實施對象為空調負載大且使用時間
短的建築物，如教堂、展覽館、會議室等較適用。另外，分量儲冰系
統之冷凍主機於離峰或非空調時段運轉儲冷，於尖峰或空調時段除由
儲冷設備提供空調能力外，同時運轉冷凍主機分擔部分空調負載，各 
15 
與人力且缺乏效率。故為了減少時間與人力的消耗，應採用計算機程
式自動篩選的方式，以自動化檢測各參與直接負載控制措施用戶之實
施狀況，再進一步進行績效評估模式之研究與分析是比較可行的方
法。 
2.2 直接負載控制曲線之特徵擷取 
擷取資料特徵的主要目的在於探勘資料之潛在特性，並且從資料
中尋找有用的特徵以做為資料分類之依據。通常擷取資料特徵所採取
的方式為將高維度資料空間映射至低維度特徵空間上，但同時保存資
料原屬特性與降低資料的維度。在許多資料特徵擷取方法中，主要成
份分析法[14-17]在統計學中為一相當普遍的分析方法，它乃利用少數
潛在成份而能有效代表許多彼此有關變項之結構，作法上是將幾個有
關變項予以線性組合，經由線性組合而得的成份其變異數最大時，則
可做為資料主要之特徵。然而，由於主要成份分析法是由多個有關變
項所建構出之最佳線性組合，所以主要成份分析法在處理非線性問題
的能力較弱，並容易忽略資料中重要的資訊。 
本計畫提出非線性主要成份分析[18-20]與週期性分析做為直接
負載控制曲線之特徵擷取方法。其中非線性主要成份分析法是採用對
偶多層式類神經網路(Dual Multi-layer Neural Network, DMNN)處理
非線性系統之問題，其主要目的在於將高維度負載資料空間透過映射
方式映射至低維度的特徵資料空間上，並盡可能保有原資料之特性。
另外，週期性分析法乃利用統計學中標準差的概念，以判斷該筆資料
是否具有週期特性，此一方法係將資料依據取樣週期分別取樣出各個
資料點，再依據所取樣資料計算其標準差。假若所計算之標準差值趨
近於零時，則表示該筆資料在相同取樣週期中所取樣的資料其分散程
度小，則可顯示此資料具有週期性；反之，若標準差值大，則表示該
筆資料在相同取樣週期所採樣資料點其分散程度大，顯示該筆資料為
17 
了變數間分布相關性的多寡。所以藉由計算共變異數矩陣之特
徵值及特徵向量，便可瞭解資料點之分布情形。 
步驟二：對於一個共變異數矩陣 xC ，可以藉由 (2-2) 式之特徵方程式
得到其特徵值λ  
 0=− ICx λ  (2-2) 
其中 I 為單位矩陣(Identity matrix)， ⋅為行列式。 
步驟三：藉由(2-2)式特徵方程式所得到特徵值λ，可從(2-3)式求出相
對於各個特徵值的特徵向量 
 iix eeC λ=     ni ,...,1=  (2-3) 
其中 ie 為特徵向量。 
步驟四：設矩陣 A是由所有特徵向量 ie 所組成的特徵向量矩陣，則原
始資料 [ ]nxxxX ,...,, 21= 可藉由(2-4)式轉換為主成份座標軸上
的投影座標，而其中主成份座標軸為特徵向量所建構之座標
軸。 
 )( xXAy μ−=  (2-4) 
步驟五：此時可以利用矩陣 kA 表示第 k 個特徵向量矩陣，則原始資料
可轉換為第 k 個主成份座標軸上的投影座標 
 )( xK XAy μ−=  (2-5) 
上述所得到的主成份座標軸可以解釋多資料變異量的另一組正
交座標。  
主要成份分析的概念就是盡量保持資料變異量的情況下，以縮減
這組資料之維度，而使所得之主要成份盡可能保有原始資料的資訊。
如圖 2.11 所示，假設資料中具有 1x , 2x 兩個交互相關的變數，而主成
份分析就是找出如圖 2.11 中之主成份座標軸，使得 1x , 2x 兩個相關變 
19 
×
×
× ×
×
×
×
×
×
×
×
××
×
×
× ×
× ×
× ×
× ×
×
××
×
×
×
×
×
×
×
×
×
×
× × ×
×
×
×
×
×
×
×
× ×
×
×
×
×
×
×
主成份座標軸
1x
2x
 
圖 2.12 主要成份分析法應用非線性資料之示意圖 
對非線性資料之處理存在遺漏資料特性的問題。因此，本計畫為了避
免主要成份分析法進行資料特徵擷取時所造成資料訊息遺漏之缺
憾，因而採用非線性主要成份分析法進行資料特徵擷取，並彌補主要
成份分析法在處理非線性系統問題上的缺失。下一節將詳細說明非線
性主要成份分析法在資料特徵擷取上的演算法則與優點。 
2.2.2 非線性主要成份分析 
在進行聚類分析(Cluster Analysis)時，採用適當的特徵擷取方法
能夠幫助資料達到有效之分類，所以選擇適當且有用的特徵擷取方法
更顯重要。因此，本計畫採用非線性主要成份分析法[21]期將變數間
非線性關係擷取出來，並保留原本資料特性。所採用方法乃是利用對
偶多層次類神經網路架構[18]處理非線性系統之問題，其目的在於將
高維度資料空間透過映射方式映射至低維度特徵資料空間上，並且此
21 
. . .
輸出層
隱藏層
輸入層
. . .
. . .
 
圖 2.14 非線性主要成份分析法之子網路架構 
 輸入層 
用以表現網路的輸入變數，其處理單元數目依照資料問題而訂
定。針對映射網路而言，其輸入變數為資料本身之維度；但針對反映
射網路而言，其輸入變數即為映射網路之輸出變數。另外，本網路之
輸入層通常所採用的轉換函數為線性轉換函數，如 ( ) xxf = 。 
 隱藏層 
用以表現輸入處理單元間的交互影響，其處理單元數目並無標準
方法可以決定，經常需要以試驗方式得到最佳之數目。以非線性主要
成份分析法之網路架構而言，其所包含兩個子網路的隱藏層處理單元
數目相等，並且採用轉換函式為非線性轉換函數，如雙彎曲線函數
(sigmoid function)。 
 輸出層 
用以表現網路輸出變數，其處理單元數目依照資料問題而訂定。
以映射網路說明，其輸出單元即為資料本身之特徵；但以反映射網路
23 
1
0
1
-1
0
   
(a)                                  (b) 
圖 2.15 (a) 雙彎曲線函式 (b) 線性轉換函式 
hh bw , 分別為隱藏層與輸入層間的權值與閥值； 
x為輸入變數；H 為隱藏層處理單元數目；T 為轉置運算子； 
f 為轉換函數(Transfer Function)； 
運算(2-7)式所得到之 ( )xu 為映射網路的輸出變數，也就是經由非
線性主要成份分析網路學習過程而得到的資料特徵向量。另外，在映
射網路的輸入輸出函數中，隱藏層所採用的轉換函式為雙彎曲線函數
(Sigmoid Function)，如(2-8)式所示。 
 xe
xf −+= 1
1)(  (2-8) 
此轉換函式在自變數趨近於正、負無限大時，函數值趨近於常數
且介於[0,1]之間如圖 2.15(a)所示;另外，以映射網路的輸入及輸出層
而言，其轉換函數為線性轉換函式 ( ) xxf = ，如圖 2.15(b)所示。 
同理，對於反映射網路而言，整個網路架構與映射網路相同，也
就是隱藏層所採用的轉換函數為雙彎曲線函數，而輸入及輸出層則是
以線性函數為轉換函數。根據上述說明可以得知如圖 3.3 所示之整個
非線性主要成份分析網路架構中以第一、三層採用雙彎曲線函數為其
轉換函數，而第二、四層及輸入層則採用線性函數。 
25 
期特性。針對週期性資料而言，其判斷方式可以從圖 2.16 觀察得知，
依照相同取樣週期取樣出如圖所示之 4 個資料點，再藉由該 4 個取樣
點計算其大小標準差
kx
σ 。若標準差值
kx
σ 趨近於零時，表示該筆資料
在相同取樣週期中所取樣資料的分散程度小，則可顯示此資料具有週
期特性；反之，如圖 2.17 所示之非週期性資料例子而言，因為依照
相同取樣週期所取樣資料點的大小差異大，則計算出標準差值也相對
變大，即表示該筆資料在相同取樣週期下所取樣資料點的分散程度
大，可顯示該筆資料為非週期性或週期性不明顯資料。 
.. . .
j
kx取樣點
時間
負
載
取樣週期T
 
圖 2.16 應用週期性分析於週期性資料之示意圖 
取樣週期T
... .
取樣點 jkx
時間
負
載
 
圖 2.17 應用週期性分析於非週期性資料之示意圖 
27 
 .
原始資料 拓撲結構 聚類分析
. ..
.
.
..
. .
.
.
.
.
.
.
.
.
.
.
.
.
..
.
 
圖 2.18 自我組織映射網路進行資料聚類分析示意圖 
元會依照輸入資料的特徵，以有意義的拓撲結構(Topological Structure)
展現在輸出空間中，由於所產生的拓撲結構可以反應輸入資料本身的
特徵，因此稱為自我組織映射網路[24]。圖 2.18 為自我組織映射網路
進行資料聚類分析的示意圖，其映射網路乃採用特徵映射的方式，將
任意維度的輸入向量映射至二維或低維度的映射網路圖上。換句話
說，此種特徵映射可以視為一種將輸入資料空間以非線性的投影 
(Projection)法轉換至特徵空間上。因此，本計畫應用自我組織映射網
路之拓撲結構以反映輸入資料分佈型態，進行資料聚類分析以確切反
應資料內部特性，  
本計畫將首先介紹自我組織映射網路分類系統架構與演算法
則，並闡述批次自我組織映射網路演算法如何改進原自我組織映射網
路之缺點。此外，詳細說明如何應用聚類整合與資料分析的方式進行
資料聚類分析，並介紹適切性分析方法，以獲得資料之最佳分類數目
[25]。 
2.3.1 自我組織映射網路分類系統架構 
自我組織映射網路具有學習能力，可依據輸入資料的特性，經由
網路訓練過程，而使得權值向量能依照輸入資料的分佈型態而擁有特
定的權值向量。因此，在資料的分析過程中，可以利用已訓練之網路
進行聚類分析，故以自我組織映射網路演算法進行資料分析時，可區
29 
自我組織映射網路訓練階段
自我組織映射網路聚類整合階段
訓練參數初始化
更新權值
映射網路學習
模擬映射網路輸出
自我組織映射網路資料分析階段
測試已訓練映射網路輸出
鑑別分類新輸入資料
聚類整合適切性DB指標分析
 
圖 2.19 自我組織映射網路資料分析 
2.3.2 基本自我組織映射網路 
Kohonen 在 1973 年提出自我組織映射網路或稱為自我組織特徵
映射網路(Self-Organizing Feature Map, SOFM)[26-29]，它是一種非監
督式學習(Unsupervised learning)的類神經網路，可從輸入資料中發掘
資料本身的特徵與關連性，並且將學習結果於輸出層來展現，當網路
學習完畢後，輸出層的神經元相鄰近者則具有相似的功能，也就是具 
31 
 didiii Rxxxx ∈= ],...,,[ 21 ,  ni ,...,2,1=  (2-12) 
其中 ix 為第 i筆向量資料；n為總資料的筆數；m 為資料向量的維度。 
輸出層：用以表現網路的輸出變數，它是利用拓撲結構以呈現輸入資
料的分佈狀況。 
權值向量：為每個輸出層神經元與輸入層相互連結關係所構成的權值
向量(Weight Vector) jw ，當網路訓練完後，其輸出神經元
相鄰近者會具有相似的權值向量。 
 [ ] djdjj Rwww ∈= ,...,1 ,  kj ,...,1=  (2-13) 
其中 jw 為第 j 個輸出層神經元； k 為輸出層的神經元數目；d 為權值
向量的維度亦是資料向量的維度。 
根據上述自我組織映射網路架構可以得知，映射網路的輸出層會
依據輸入資料的特性以有意義的拓撲結構展現，所顯示的拓撲結構可
以反映出輸入資料的分佈。因此，以下分別介紹在自我組織映射網路
中網路拓撲與拓撲座標的概念[30-33]。 
網路拓撲：在自我組織映射網路中，輸出層神經元的相對位置能夠反
映輸入資料的分佈狀況。實際上網路拓撲可以由任意形狀
及任意維度的網路拓撲所組成，而通常網路拓撲模式如圖
2.21 所示，通常以二維矩型形式居多，它不僅可以反映資
料的分佈狀況，也可藉由圖形顯現資料的分類情形。 
拓撲座標：拓撲座標意指輸出層神經元在網路拓撲上的位置座標，如
圖 2.21 所示，以二維形式的網路拓撲而言，每一個輸出
神經元具有二維的拓撲座標。 
 
33 
 
神經元所受之刺激強度
強
0
弱
近 遠遠
 
圖 2.22 神經元所受刺激強度與距離之關係圖[29] 
2.3.2.2 網路演算法則 
自我組織映射網路演算法則所採用的方式乃藉由特徵映射將高
維度的輸入資料映射至低維度的特徵空間上。換句話說，此種非線性
投影的方式是透過權值向量的學習，而使得輸出神經元能夠保有資料
之間的鄰近關係，並以二維或低維的拓蹼網路表示其資料之分佈。本
演算法為一個疊代過程，其輸入向量 ],...,,[ 21 idiii xxxx = 連接至輸出層的
神經元，第 j 個神經元的權值向量可以表示為 [ ]jdjj www ,...,1= 。在初始
網路訓練時，隨機給予初始權值向量 jw ，分別計算資料向量與權值向
量間的距離，再藉由所計算的距離找出輸入向量 ix 與權值向量 cw 之最
短距離，亦即當輸入資料向量為 ix 時，具有最強輸出的神經元 c，如
(2-14)式所示。 
35 
輸入訓練資料
設定參數
篩選優勝單元
取得鄰近神經元
更新權值向量
結束
t >T*
是
否
 
*註：T 為最大疊代次數。 
圖 2.23 基本自我組織網路之訓練流程圖 
步驟： 
步驟一：輸入訓練資料。依序將訓練資料輸入至自我組織映射網路中
以訓練整個網路。 
步驟二：設定參數。設定網路所需的學習參數，例如隨機設定初始權
值 jw 、鄰近函數 )(, th jc 、學習速率 )(tα 與執行次數T 等。 
步驟三：篩選優勝單元。計算輸入資料與所有權值向量的歐幾里德距
37 
Training Algorithm)[26, 35]中所採用更新權值方式是以資料分佈狀況
為導向，也就是經由疊代方式使得最後所得的權值向量達到定值，並
滿足目前資料分佈情形。如前所述，上一節中所描述之基本映射網路
修正權值方式為(2-15)式所示，即 
)]()[()()()1( , twxthttwtw jjcjj −+=+ α      
假設在 ∞→t 的理想網路訓練情況下，其權值向量 ( )tw j 與 ( )1+tw j
應相等，也就是說，在理想訓練網路的情況下必須滿足(2-17)式。 
 ( )[ ]{ } 0 )(    , *, =−∀ twxthEj jjc  (2-17) 
其中 {}⋅E 為期望值。因此，在理想情形下，基本映射網路的更新權值
法則可以經由(2-17)式而改為(2-18)式。 
 ∑
∑
=
t
jc
t
jc
j h
txh
w
,
,
*
)(
 (2-18) 
其中 *jw 表示修正之權值； jch , 表示鄰近函數。 
由於(2-18)式其更新權值法則與鄰近函數 jch , 有關，但在取得鄰近
函數 jch , 前必須先決定優勝單元 c，以更新(2-18)式中之權值 *jw 。因此，
在執行更新權值法則前必須藉由(2-14)式決定優勝單元 c，以獲得初
始權值 *jw 。最後，再經由疊代的過程而使修正權值 *jw 趨近於定值。 
2.3.3.1 網路演算法則 
如前所述，由於批次網路演算法則是以輸入資料的分佈情形作為
整個網路更新權值之依據，也就是經由網路不斷的循環學習，最後使
所得之權值向量達到一個定值，並滿足目前資料分佈情形。此外，在
詳細說明批次網路演算法則之前，必須先介紹 Voronoi 集合的定義
[26]。 
39 
輸入資料
是
否
初始權值
計算資料在
  的平均值
jV
計算權值 *jw
判斷權值是
否趨於定值
輸出權值
 
圖 2.25 批次自我組織映射網路演算法則之流程圖 
以上述概念為基礎，針對批次自我組織映射網路演算流程圖可分
為以下四個步驟，分別說明於後。 
步驟一：初始權值向量 *jw 。本計畫所採用初始權值向量 *jw 乃是利用
輸入資料與鄰近函數之間的關係，藉由(2-18)式以得到初始
權值，其中必須先利用(2-14)式，以決定優勝單元 c，進而
使初始權值向量能夠約略接近網路所需之權值向量。  
步驟二：計算輸入資料 ( )tx j 的平均值 jx ，其中輸入資料 ( )tx j 是位於集
合 jV 中的資料點。 
41 
×
×
×
×
×。 ×
× ×× ×。
×
×
×
××。 ×××。
×
× ×× ××
×
×
×
××××
×
×
×××
××
×
××
×。×××
××
×
×：資料向量 。：資料中心  
圖 2.26 自我組織映射網路之聚類分析示意圖 
於後說明資料聚類整合與資料分析兩個階段，以達到資料聚類分析
之目的。 
2.3.4.1 聚類整合 
在自我組織映射網路的訓練過程中將資料向量輸入至映射網路
時會激發某一特定的神經元，而此神經元便可以視為該資料向量的
資料代表，而資料向量激發神經元的動作可視為一種資料分類的行
為。  
圖 2.26 說明資料聚類分析之示意圖，因為資料向量與權值向量
的維度相同，若將資料向量與權值向量投射到同一個座標空間上
時，便可將權值向量視為資料向量的資料中心。因此，在進行聚類
分析時，各個資料向量會因為鄰近關係而對應到不同的資料中心，
因而產生相對應的資料子集合。所產生資料的子集合可以視為輸入
資料所呈現的分類狀況，故本研究可以藉由自我組織映射網路執行
資料聚類分析。 
接下來將詳細的說明自我組織映射網路進行聚類分析的方法。
首先，在分類的過程中採用分類索引 indexC 表示資料向量與聚類之間
的關係，也就是透過資料向量與權值向量之間最小距離，使得資料
43 
2
距
離
資料中心
● ●●● ●● ● ●
5 8 1 3 6 4 7
0.6
 
圖 2.27 聚類分析之樹狀結構圖 
合併後的群聚與其他群聚間的距離，不同方法採用不同的距離計算
方式[33]： 
方法一：單一連結法(Single linkage)：所謂單一連結法是求出群
聚 kC 與 lC 兩者之中最接近的距離，定義如下： 
 { }jijis xxd −= ,min  (2-22) 
其中 ki Cx ∈ 與 lj Cx ∈ 。 
方法二：完整連結法(Complete linkage)：所謂完整連結法是求出
群聚 kC 與 lC 兩者之中最遠的距離，定義如下： 
 { }jijico xxd −= ,max  (2-23) 
45 
ni  ,...,2 ,1= 為資料向量的數目。接下來將資料向量 ix 放入已訓練聚類
整合之網路，可測試該網路是否能夠反應原或新的資料之分佈型
態，亦即可利用已訓練完成之網路對新資料作鑑別分類。 
2.3.5 聚類整合適切性分析 
在聚類分析中主要是探討如何依照收集的資料特性由自我組織
映射網路所得資料群聚予以進一步分群。使得群內個體間具有高度
的同質性，且不同群體間具有高度的異質性。由於在進行聚類分析
時尚不知道手上資料可以聚分為若干，所以在進行聚類分析時，必
須找出最適合資料本身特性之分類數目。因此，本計畫利用一個非
模糊型的分類適切性指標[25]，稱為 DB 指標，它是利用資料間的幾
何原理進行運算，且DB指標能夠確切的掌握分類之兩大幾何方向，
即不同群之間的資料點差異能夠愈大愈好而同群內的資料點差異能
夠愈小愈好，所以本計畫採用分類適切性DB指標以點出資料本身之
最佳群數。 
如前所述，在定義適切性指標時必須遵循以下兩個幾何原理：
一為群與群之間的距離能夠愈大愈好，亦即隸屬於群與群之間的資
料點能夠愈分離愈好，亦表示兩群之間的相似度及關連性愈小。二
為同一群聚之內部資料點距離能夠愈小愈好，亦即隸屬於該群內的
資料點其相似程度大且關連性強。此外，同一群內的資料點愈集中
則表示群內的點擴散程度低，變異程度也小。因此，在考慮適切性
指標的使用時必須以這兩個幾何方向進行，才能明確的指出何種分
類適合於資料本身之特性。 
本計畫所使用的DB指標不僅遵循上述兩大幾何原理，並且能夠
明確指出資料所屬之最佳分類狀況。基本上DB指標就是透過群間與
群內的變異程度而定義出來的適切性指標。 
設(2-26)式定義第 i群內之變異程度為 
47 
。
。。
。
。 。。
。
。。
。
。
。。
。。
。。iv jv
‧ ‧ji
d ,
iS jS
 
圖 2.28 群內與群間之距離示意圖 
取與群聚 i具有最大相似性之群聚，以當作群聚 i 與其他群聚之間的
最大相似性量測值 iR 。而後將所有聚群之 iR 值加以平均，以當作度
量最佳聚類數目之 DB 指標。   
從圖 2.28 的群內與群間的距離示意圖，可瞭解到資料在聚類整
合分析時各個群聚之間的關係。如圖 2.28 所示，假若先計算 i 及 j 兩
個群聚間之群內距離 iS 與 jS ，其計算方式是以各群聚質心 iv 及 jv 為
中心，分別計算群內各個資料點到質心之標準偏差(如(2-26)式)之等
效平均距離並視為群內距離。另外，再分別計算各個群聚的質心間
距離當做群間距離。因此，當 DB 指標(如(2-28)式)能夠滿足群間距
離愈大而群內距離愈小，亦即分子部份愈小且分母部份愈大時， 
DB 指標數值即愈小。是故，假若在 DB 指標最小情況下，則表示該
聚類為資料分類最佳之狀態，也就可以得到最佳之群數分類參考。
換句話說，假若DB指標值愈小，則代表各聚內資料其分散程度小且
聚間的距離大，意指為最佳之聚群數目。因此，若能在某一固定聚
類數目之情形下，得到最小的DB指標，則代表此聚類數目為該資料
之最佳聚類數目，而達到最佳化聚類之目的。 
自我組織映射網路進行聚類整合的過程中，由於各個資料向量
會因為鄰近關係而對應到不同網路拓撲之神經元，因而產生相對應
的資料子集合。所產生各個子集合可視為數個群聚，先透過聚類整
合分析將各個群聚依其相鄰關係由下而上產生階層式聚類樹。再經
由不同聚群數目計算其DB指標，以找出資料之最佳聚類數目，即可
49 
另外，儲冷式空調系統其運作方式採冷凍主機離峰時間運轉製冰
並將冷能儲存起來，而儲存之冷能於尖峰時間釋放出來，以供應空調
系統之所需，其功能為移轉尖峰時間用電量至離峰時間上，以平衡電
力負載，所以，建立儲冷式中央空調系統之績效評估模式是為了瞭解
此項措施的轉移用電量與抑低負載量。 
透過本計畫所建立之績效模式，一方面，提供台電公司空調管理
措施之績效評估準則；另一方面，提供台電公司空調管理措施的改善
依據及目標，因而進一步提昇各方案的成效，以改善台電公司的系統
負載狀況。 
2.4.1 中央空調週期性暫停用電之績效評估模式 
實施中央空調週期性暫停用電對電力系統之效益為週期性暫停
用電可預期達到抑低負載與減少用電量之效果，故應分別建立抑低負
載量與減少用電量之績效評估模式，以作為檢討實施中央空調暫停用
電措施之參考依據。由於中央空調遙控降載方式與中央空調暫停近
似，唯在控制期間（10-12 時及 13-17 時）及方式（每運轉 45 分鐘遙
降 15 分鐘）有所不同，故乃引用相近似之績效評估模式，只需改變
其相對應之相關參數，加以計算其措施的抑低負載量與減少用電量，
以助於瞭解該措施之實施情況。另外，應強調的是由於部份實施中央
空調週期性暫停用電之狀況不佳與預期之暫停用電型態多所不合，因
此本計畫係利用所建立之直接負載控制分類系統將實施不彰之負載
予以剔除，再經由所擬訂之績效評估模式進行績效評估，俾獲得較精
準之評估結果。 
2.4.1.1 抑低負載量績效評估模式 
在擬定中央空調週期性暫停用電之抑低負載量績效評估模式之
前，需先行了解負載的反饋（pay-back）現象，也就是說其空調負載
值回復用電時會有遠高於未實施暫停前之空調負載值的現象，如圖 
51 
步驟 3： 將每 75 分鐘週期內，取樣負載高於週期之平均負載值 LAvekn,j
者標示為 0，低於 LAve,kn,j標示為 1；前者代表該週期空調非
暫停運轉之負載，後者則代表該週期空調暫停運轉之負載。 
步驟 4： 計算標示為 0 之平均值，並令為 AAve,kn,j及計算標示為 1 之
平均值 BAve,kn,j。 
步驟 5：重複步驟 4 之運算過程，在上述尖峰評估時段內分別求出 3
個 AAve,kn,j及 3 個 BAve,kn,j值。 
步驟 6：利用步驟 5 之結果，求出尖峰三小時中，空調非暫停運轉之 
負載 AAve,kn及空調暫停運轉之負載 BAve,kn： 
 3
3,2,1,
,
knAveknAveknAve
knAve
AAA
A
++=  (2-30)  
 3
3,2,1,
,
knAveknAveknAve
knAve
BBB
B
++=  (2-31) 
步驟 7：計算該抽樣用戶之抑低負載量 Ckn, 
 knAveknAvekn BAC ,, −=  (2-32) 
步驟 8：以於表 5-13 之分組抽樣佔比率 Rk( k= A, B, C, D, E )，作為推
估整體之績效評估模式： 
 ∑
=
= N
n
knk CS
1
 (2-33) 
 ∑
=
= E
Ak k
k
T R
SS  (2-34) 
其中 kS 為第 k 分組之抑低負載和； TS 為總體在尖峰時段之抑低負載
量； 
本計畫所建立之抑低負載量績效評估模式不僅透過去除暫停負
53 
其中 knQ 為第 k 個分組，第 n個負載之減少用電量； jI 為在第 j 個 75 分
鐘週期內，標示為 1 之負載總數；J 為 75 分鐘週期數(就中央空調暫
停用電而言，J = 6)； 605 為 5 分鐘瓩換算為瓩小時(度)數之參數； 
步驟 6：計算整體減少用電量 
 ∑
=
= N
n
knk QQ
1
 (2-36) 
 ∑
=
= E
Ak k
k
T R
QQ  (2-37) 
在中央空調遙控降載減少用電量評估模式方面，只需將中央空調
減少用電評估模式之暫停時段更改為 10-12 時與 13-17 時，即可求出
中央空調遙控降載之減少用電量。 
綜合而言，本計畫所建立之績效評估考慮到分組輪流暫停的影
響、反饋的現象之去除與摒除用戶績效不彰的方式，使所計算出之抑
低負載量值與減少用電量值更趨於合理。 
2.4.2 儲冷式中央空調績效評估模式 
由於台灣地區主機容量 100 馬力以上之中央空調用電成長快
速，所以為了有效抑低冷氣負載，儲冷式中央空調系統之推廣刻不容
緩。儲冷式中央空調之目的在於抑低負載與轉移尖峰及半尖峰用電量
至離峰時間使用。本計畫試擬之儲冷式中央空調績效評估模式，首先
選取年尖峰發生日所在之該週的工作日負載，再分別針對每日進行抑
低負載量與轉移用電量之計算，其方式如後所述。 
 抑低負載評估模式 
 ni
ikn
ikn
ikn
H
N
D
MaxD ×=
,
,  (2-38) 
其中 knD  為第 k 類行業別，第 n個抽樣戶之抑低負載量； iknD , 為評估
55 
中央空調績效評估模式可以計算此項措施之抑低負載量與轉移用電
量，並可瞭解此項措施實際對於抑低尖峰負載量之成效，以做為未來
實施此項措施的參考依據。 
2.4.3 綜合結論 
本章建立各項空調負載管理措施之績效評估模式，可幫助瞭解各
參與用戶負載管理措施之實施成效。中央空調週期性暫停用電與遙控
降載週期性暫停用電績效評估模式分別考慮到分組輪流暫停之影
響、反饋現象之去除與摒除績效不彰之用戶三個因素，期使績效評估
值趨於合理。另外，儲冷式中央空調績效評估模式，不僅考慮到實施
狀況不彰之影響，並且採用分量儲冰比率以作為計算負載轉移量。 
透過本計畫所建立之績效模式可提供台電空調管理措施績效評
估之準則與改善之參考依據，以進一步提昇各方案的成效。下一章將
應用本計畫所提出之自我組織映射網路及績效評估模式，於台電公司
89 年實測之中央空調負載管理措施資料上，以實際驗證本計畫所提
方法之可行性與有效性。 
2.5 電能監測系統 
於本計畫完成之用電監測測系統部分之方塊圖，如圖 2.30 所示。
主要分為硬體、軟體和韌體架構三部分，以下為各部分架構詳述如下： 
2.5.1 硬體電路架構 
硬體電路架構又分多重通道輸入之類比數位訊號取樣與調整電
路與 Cypress EZ-USB 周邊控制器來分析： 
(1) 多重通道輸入之類比數位訊號取樣與調整電路 
經由多方收集資料，評估市場普及率與硬體成本，本計畫中之多 
57 
 
圖 2.31 12 位元類比數位轉換器功能方塊圖 
 
圖 2.32 AN2131S 架構圖 
元之數位訊號，一共分為 4 個高位元與 8 個低位元邏輯訊號；撰寫韌
體於 EZ-USB 中以接收由 CYGNAL 為控制器取樣之數位電壓電流訊
號訂定兩者之間通訊協定規範依序將數位訊號送出至序列阜（Port 
2），此協定可保證訊號傳送無錯誤。 
(2) Cypress EZ-USB 周邊控制器 
59 
 
圖 2.33 USB 之核心 
憶體（RAM）取代非揮發性記憶體（ROM）；內部記憶體可供程式碼
與資料儲存，USB 裝置可透過 USB 傳輸線將韌體由主機下載至內部
記憶體中。序列介面引擎擁有額外的邏輯運算功能可以執行列舉
（Enumeration）的動作，因為每個 USB 裝置均擁有其裝置的硬體描
述描述符號（Descriptors），裏頭包括 USB 裝置所設定之必要條件與
容量需求，所以可靠序列介面引擎完成以上溝通動作。 
(2) Cypress USB 列舉的程序 
當使用者將 USB 裝置插入至主機的 USB 序列阜中，主機立即開
始執行下列程序： 
 首先，主機端會發出一獲取裝置端描述之請求封包。 
 裝置端會針對此請求封包回覆一 ID 資料封包，告知主機端此
裝置的種類。 
 主機端會給予此裝置一個位置以便識別其裝置。 
 然而主機端會發出”Get_Descriptor”請求，徵詢更多有關 USB
61 
表 2.3 EZ-USB 端點 
 
（IN07VAL, OUT07VAL register）可致能所選擇之端點進行資料傳
輸，至於控制端點 0（CONTROL endpoint zero）於預設值已被設定為
啟動的狀態。以巨量傳輸為例，無論欲傳送或接收到的資料均存於內
部記憶體中，每個端點均有 64 位元組的資料緩衝儲存空間，而資料
緩衝儲存區裏頭資料存放大小可由位元計數（Byte Counter）暫存器
來記錄之；另外控制與狀態（Control and State）暫存器則是被用來顯
示端點緩衝區是否可被存取的狀態。 
(5) USB 資料傳輸模式 
USB 介面規範了巨量傳輸（Bulk Transfer）、控制傳輸（Control 
Transfer）、中斷傳輸（Interrupt Transfer）、等時傳輸（Isochronous 
Transfer）四種傳送模式。以下針對各個傳送模式的特徵來加以說明。 
z 巨量傳輸 
63 
 
圖 2.35 控制傳輸 
 
圖 2.36、中斷傳輸 
1.頻寬低 。 
2.無同步以及週期性的傳送。 
3.單向傳送，僅能夠做輸入(USB 1.0)。可適用於全速傳輸、
慢速傳輸。 
4.全速傳輸的資料淨載量(Payload)為 64 位元組，慢速傳輸為
8 位元組。 
z 等時傳輸 
「等時傳輸」或是一種即時 (real-time)的資料傳輸方式；往往
需要固定的資料傳輸率。 
1.頻寬被限定。 
65 
 
圖 2.38 巨量傳輸 
片上，發展初期便於程式修改除錯，節省燒錄韌體所花費的時間。控
制面版提供裝置端核心在獲取韌體程式組態的設定值與裝置識別
（VendorID, ProductID）並完成列舉動作後主機即可辨識此裝置的種
類並加以驅動；經由控制面版”Bulk/Int”按鈕與資料顯示區可直接將
所接收到之資料內容顯示於主機螢幕上，比對 DSP 發展板上所送出
邏輯訊號，給予測試人員立即進行資料錯誤辨別與韌體程式之修改。
圖 2.39 為整個控制面版之操作介面。 
(7) 資料接收程式架構 
當主機對電力儀表下達命令，則進入該資料接收子程式。此子程
式負責接收由電力儀表傳送的電壓電流訊號。其中資料在傳遞進行中
經過兩個介面，一是主機端與 USB 裝置端間之 USB 傳輸介面，另一
為 USB 發展電路與 Cygnal 發展板之間訊號交握傳輸（Handshaking）
介面。 
67 
其他USB設備
主機控制器之驅動器
USB堆疊
USB裝置種類
驅動器
其餘USB設備
之裝置種類驅
動器
虛擬儀表電力
監測虛擬儀表
USB之主機控制器
具通用序列功
能之電力監控
介面
同步性
整批式
中斷式
控制
應用層
裝置種類驅動器層
通用序列匯流排推疊層
主機控制之驅動器層
硬體
USB
 
圖 2.40 虛擬儀表軟體程式架構圖 
時取樣的電壓電流訊號經由 I/O 阜送出，此時由 Cypress EZ-USB 第
二組 I/O 阜接收每一位元組資料，USB 核心電路將每一資料封包儲存
於端點緩衝區重複接收直到 64 位元組填滿緩衝區，此時 USB 核心設
定該緩衝區位元計數暫存器之值等於 64（IN2BC＝64），即 USB 核心
進入繁忙狀態（BSY＝1），等待主機端發出請求訊息封包給 USB 裝
置電路，將資料封包即時傳送至主機端。由此通訊協定可即時接收電
壓電流訊號，進而達成電力訊號監控與分析。 
2.5.3 軟體程式架構 
軟體程式架構則分虛擬儀表應用程式層與設備分類驅動層與
USB 堆疊層兩部份來分析說明： 
(1) 虛擬儀表應用程式層 
本計畫內需進行在於個人電腦開發虛擬儀表介面程式，架構如圖
69 
表監控和收集參與空調直接負載控制或節約能源措施用戶用電資
料。遠端虛擬用電監控系統所收集用電資料將提供自動分類直接負載
控制曲線系統作實施分類，鑑別實施效果不彰與實施狀況良好之負
載。對於實施狀況良好之用戶而言，本計畫並遵循國際成效量測與驗
證規範（ International Performance Measurement and Verification 
Protocol, IPMVP），擬定績效評估模式，以估算其抑低負載量與轉移
用電量；對於實施效果不彰之用戶則予以剔除。 
本計畫藉由個人電腦配合簡單的硬體類比訊號取樣電路組合，即
可進行負載用電量監測，並可擷取大量數位信號儲存於個人電腦硬碟
內，再進行分析判斷。然而虛擬儀表(virtual instrument, VI)是建構於
電腦上結合軟體和硬體的功能與能力的一種量測系統。虛擬儀表可以
簡單的使用圖控式程式語言(如 LabVIEWTM)[37-40]或一般視窗程式
設計語言來設計。所有資料的獲得、處理、顯示和資料庫管理，都可
以藉由具有虛擬儀表的電腦來執行。虛擬儀表的實現不僅較為經濟，
更增加了量測的方便性、效率、適應性、與自動化技術的能力。另一
方面，可降低硬體開發成本，且兼具各項功能，乃為勢在必行之趨勢。 
本計畫所開發之電能監測系統結構主要分為軟體程式、硬體電路
和韌體程式設計三部分，硬體部分主要包括負載監測系統之訊號調整
和取樣、數位類比轉換以及訊號傳送等電路設計，硬體電路如圖 3.1。
在軟體設計方面，為 C++ Builder 建立在個人電腦上的虛擬儀表程式
人機介面設計。韌體程式則藉由 Cypress EZ-USB 整合模組，並撰寫
組合語言控制 USB 資料傳輸控制介面。Cypress EZ-USB 整合模組是
以 8051 微處理器（microprocessor）為控制核心，作為 USB 介面發展
之用。 
電能監測系統具有資料擷取、處理、顯示和資料庫管理等功能，
可增加在電力量測工作上的效率與便利性。然而傳統虛擬儀表系統採 
71 
位轉換處理期間一直改變，則會造成不正確數位訊號輸出。因此，通
常在 ADC 前必須加入取樣保持電路（sample and hold circuit, S/H），
並藉由控制取樣和保持狀態，確保類比/數位轉換處理期間能夠保持
ADC 的類比輸入訊號。 
電壓電流類比訊號經由 S/H 和 ADC 電路而輸出數位訊號，並由
中央處理器（central process unit, CPU）接收儲存，接著把資料傳送
到個人電腦作進一步處理。經由多方收集資料，評估應用普及率與硬
體成本，本計畫採以 ADC0804 積體電路（integrated circuit, IC）作為
ADC 處理，該 IC 具 8 位元解析度和最小 100 us 類比/數位轉換時間。
為了同步擷取電壓和電流訊號和確保類比訊號正確的轉換為數位訊
號，在類比訊號作 ADC 之前加入整合 S/H 電路之 LF398 IC 作為前置
處理電路，並以 CPU 控制電路取樣和保持狀態，如此可以將類比電
壓和電流訊號同步且正確的擷取至 CPU 儲存作進一步處理。詳細控
制流程將於 負載監測系統韌體程式架構章節作說明。 
3.1.1.2 LF398 取樣保持整合電路 
LF398 是一個取樣保持放大器 IC，利用 FET 的開關切換來隔離
電容充放電狀態，具有高速訊號擷取和低速電壓下降率特性。該 IC
共有 8 根腳位，其功能接腳如圖 3.2[41]。取樣和保持狀態控制由第八
根腳位輸入邏輯訊號控制，當輸入電壓大於 1.4 伏特，電路則為取樣
狀態，此時在第五根腳位輸出電壓會隨著第三根腳位輸入電壓大小而
變化。若邏輯訊號輸入低於 1.4 伏特，所取樣的電壓會儲存在電容並
且維持輸出當時取樣時間點的電壓值。通常在下保持狀態命令之後，
在經歷 150ns~200ns 時間之內，輸出電壓就不再受到輸入電壓影響，
接著輸出端經歷一段穩定時間（settling time）而輸出穩定電壓，對於
LF398 的穩定時間大約為 0.8us。所謂穩定時間是指在下保持命令後
一直到輸出端電壓變動在 1mV 以內之該段時間稱之。 
73 
 
圖 3.3 ADC0804 IC 功能接腳圖 
特性。另外，可以針對不同電壓輸入範圍來設定電壓參考值，使其輸
入電壓跨越 8 位元解析度最大與最小的輸出。其功能接腳如圖
3.3[42]，共有 20 根腳位。其中 CS、RD 和 WR 三根腳位為數位控制
輸入符合 TTL 邏輯電壓準位，三根腳位都是低準位動作(active-low)，
DB0~DB7 為轉換完成之 8 位元數位輸出。腳位 CS 為代表晶片選擇
（chip selection, CS）的控制，當需要兩個 ADC0804 透過一多工器
（multiplexer）共用 CPU 的資料匯流排（data bus）將訊號送到 CPU
時，可以先將兩個 ADC 之 CS 腳位分別設定為 1 和 0，亦即一個 ADC
停止訊號輸出，另一個正常動作將訊號傳送至 CPU，如此輪流將訊
號傳送至 CPU。若是 ADC 可以直接將訊號傳送至 CPU，不共用資料
匯流排，則直接將 CS 腳位接地即可。另外，CPU 可藉由 WR 和 RD
腳位控制 ADC 轉換啟動和訊號輸出。 
3.1.1.4 萬用序列埠介面簡介 
資料傳輸介面的相容性為個人電腦週邊設備開發階段重要考量
因素，一個周邊設備介面的選擇必須要具備傳輸穩定性、介面開發成
本低、低電力消耗、高傳輸速度、方便使用和作業系統支援等特性。
然而 USB 即是符合上述所有條件之資料通訊介面，USB 不僅設計簡
單，而且使用效率高。目前許多不同種類之週邊設備，例如滑鼠、鍵
盤、掃描器、外接式硬碟和印表機等，都已經使用 USB 介面作資料
通訊。相對的 USB 在目前個人電腦已經列為標準介面，大部分的作 
75 
表 3.1 USB 接頭和插座不同型式之功能 
種類 功能 
A 型公插頭  接向主機端或集線器輸出埠 
A 型母插座  安裝於主機端或集線器輸出埠 
B 型公插頭  接向設備端或集線器輸入埠 
B 型母插座  安裝於設備端或集線器輸入埠 
 
圖 3.5 USB 纜線 
器會在每一個星狀排列網路中央，每一條連接線代表主機端和週邊設
備或集線器抑或集線器和集線器或週邊設備之點對點（point-to-point）
連線。 
USB 傳送資料的匯流排實體介面分為機械和電氣部分，機械部
分指的是纜線和接頭型式，為了避免不合法的網路拓樸出現，根據主
機端和設備端不同，分別定義 A 和 B 型的公插頭和母插座，如表 3.1
所列。電氣規格方面，USB 透過四條線傳送訊號和供給電源，分別
是紅色 VBUS、白色 D-、綠色 D+和黑色 GND 四種顏色區別，D+和
D-為一對雙絞線（twisted pair）作為資料傳輸，主機端透過 VBUS 和
GND 接地提供 5 伏特電源給設備端，如圖 3.5 所示。USB 使用 D+和
D-的差動（differential）電壓作為訊號編碼，並依高速和全速/低速模
式定義「差動 1」和「差動 0」，如表 3.2 所列[43]。USB 採用不歸零
就反向（non return to zero invert, NRZI）編碼方式，當傳送資料為 1
時，維持「差動 0」或「差動 1」狀態；傳送資料為 0 時，「差動 0」 
77 
擁有 USB 介面的週邊設備可以在開機狀態直接連接或移除於電
腦主機端，作業系統可以自動偵測 USB 週邊裝置是否有連接，以及
是否安裝完成。 
z 擴充性佳 
單一主機端可以擴充至 127 個 USB 週邊裝置，相對於無法擴充
之 RS-232 和平行埠（parallel port）等傳統介面，其擴充性優勢使得
漸漸取代傳統介面。 
z 高速傳輸 
USB 介面依據不同設備特性可以選擇低速、全速和高速三種傳
輸速度，最高可以達到 480 Mb/s，因此一般要求傳輸速度的週邊設備
均優先考量 USB 介面。 
z 安裝便利 
USB 介面連接埠為外接式，週邊設備連接主機端時，並不需要
將主機外殼打開進行安裝。當電腦偵測有 USB 週邊設備連接，作業
系統自動安裝設定，並不需要像傳統介面需要調整設定通訊埠位址或
是中斷要求(Interrupt Request, IRQ)編號等繁雜步驟。 
z 電源供給 
USB 週邊裝置可以直接使用主機端或集線器所提供 5 伏特的電
源，設備無須另外供給電源。一般而言，主機端供給總電流 500mA
給所有 USB 週邊設備共用。 
(3) USB 資料傳輸模式 
USB 通訊傳輸包括裝置組態設定和資料交換兩大類型，裝置組
態設定通常發生在主機開機或連接/拔除設備期，所傳輸之內容以設
79 
訊，直到問題解決為止。 
在控制寫入（control write）的傳輸中，在資料階段的資料是由主
機端流向裝置端，稱為下行傳輸（downstream）。相反的，上行傳輸
（upstream）為執行控制讀取（control read）狀態的資料傳輸由裝置
端流向主機端。然而，上行和下行傳輸為 USB 資料傳輸的通用定義。 
z 巨量傳輸（bulk transfer） 
巨量傳輸適合使用在不考慮時間因素的大量資料傳輸，可以大量
傳輸資料而不會阻塞匯流排，主要是該傳輸型態會讓其它傳輸先執
行，等待匯流排空閒再開始傳輸。使用該傳輸型態包括由主機傳送資
料給印表機、由掃描器傳送影像資料給主機、以及外接式磁碟讀/寫
等。在一個常閒置的匯流排中，相當適合使用巨量傳輸，僅有高速與
全速裝置支援該傳輸型態。 
巨量傳輸包含一個或多個方向 IN 或 OUT 封包交易，該傳輸是單
一方向，所有交易封包必須全部為方向 IN 或是 OUT。巨量傳輸同樣
也有 CRC 偵測錯誤，並使用資料交替位元（data toggle bit），來確
認無資料遺失。 
z 中斷傳輸（interrupt transfer） 
中斷傳輸為巨量傳輸型態中的一種特例，所有傳輸架構皆相同。
唯一差異為中斷傳輸的端點具有輪循間隔（polling interval），這代表
主機在某一段固定時間會和裝置進行通訊，以獲得目前裝置狀態訊
息。一般應用包括鍵盤、滑鼠、以及搖桿等簡單電腦輸入週邊設備。 
z 等時傳輸（isochronous transfer） 
等時傳輸適用需要考慮資料傳送時間之應用，但可以容忍少量錯
誤的資料傳輸，一切以大量且快速傳輸為主。一般應用主要為影像和
81 
進而將資料存放在 CPU 記憶體緩衝區。第二部分負責把緩衝區中取
樣所得的資料立刻傳送至個人電腦。程式架構完成一次循環則同步擷
取電壓電流兩週期。 
程式首先初始化系統參數設定，包括設定欲使用之輸入/輸出
埠。在開始取樣動作前先偵測記憶體緩衝區是否處於忙碌狀態，所謂
忙碌狀態是指當緩衝區正在送資料至個人電腦之狀態，若緩衝區處於
閒置狀態，則 CPU 先後下達取樣和保持之命令，接著類比訊號開始
藉由 ADC 轉換為數位訊號，最後 CPU 偵測到轉換完成之訊號後，立
刻將訊號讀入記憶體緩衝區，如此完成取樣單點電壓和電流訊號。 
相同的流程直到完成取樣兩週期的電壓和電流資料填入緩衝
區。最後設定緩衝區忙碌旗標（busy flag），接受個人電腦端之應用
程式讀取資料命令進行資料傳輸，將緩衝區資料傳送至個人電腦。資
料傳送完成後會清除忙碌旗標，重複以上動作繼續取樣新的資料。韌
體程式架構流程如圖 3.6。 
3.1.2.2 萬用序列埠介面驅動程式 
主機端驅動程式的撰寫通常是開發 USB 週邊設備必要步驟，撰
寫驅動程式不僅先要瞭解該硬體設備的架構，更要熟悉主機端作業系
統驅動程式的介面規格以及開發知識，然而相同的設備隨著不同作業
系統核心，驅動程式的開發隨之而異。目前微軟（Microsoft）公司針
對不同作業系統來提供設備驅動程式工具套件（device driver kit, 
DDK），方便設計者開發設備驅動程式。但由於使用 DDK 需要具有
作業系統（operation system）底層運作方式的基礎，且步驟過程繁雜。
因此對於沒有相關基本知識的入門學習者，無法在短時間內完成驅動
程式之開發。 
基於 DDK 使用上的不便利，目前 Jungo 公司已經提供一套驅動 
83 
 
圖 3.7 選擇欲產生驅動程式之設備畫面 
程式開發工具 WinDriver，設計者只要有基本概念就可以利用它在最
短的時間內開發出驅動程式，而且所開發完成的程式原始碼也可輕易
移植到其他不同系統平台，達到一次開發跨平台使用之目的。本計畫
即以 WinDriver 作為負載監測系統驅動程式之開發軟體，它是一個擁
有圖形發展環境介面、診斷和除錯工具、以及基本範例的開發工具，
幫助開發高效能的驅動程式。 
以下將本計畫電能監測系統為例，簡單敘述 WinDriver 產生驅動
程式過程，首先將硬體設備接上電腦，然後開啟 WinDriver 軟體並新
增專案，會出現連接在主機上所有介面的設備，如圖 3.7。點選所連
接 USB 設備，並按下按鈕「Generate .INF file」以產生驅動程式資訊
檔。儲存資訊檔之前，可以先設定相關資訊，如圖 3.8。接著會自動
幫該設備對作業系統註冊，使得作業系統能夠正確驅動該設備。回到
畫面如圖 3.7，按下按鈕「Next」進入設備資料通訊測試畫面，可以
對該設備進行簡單資料讀/寫的動作，如圖 3.9。如果設備測試沒有問
85 
 
圖 3.10 應用程式語言專案樣板產生之畫面 
3.1.3 軟體程式 
3.1.3.1 電能監測系統人機介面架構 
主機端應用程式主要負責負載監測系統的虛擬儀表介面，本系統
以 C++ Builder 6 作為圖形使用者界面（graphics user interface, GUI）
設計之工具。虛擬儀表應用程式開發是以上述 WinDriver 所產生之
C++ Builder 專案樣板檔為基礎架構，並使用 WinDriver 所提供之 API
函式作為和負載監測硬體設備資料通訊。 
虛擬儀表主畫面即時顯示電壓和電流波形以及相關電力參數，包
括電壓和電流均方根值、實功（active power）、虛功（reactive power）、
視在功率（apparent power）、以及功率因數（power factor）。當使
用者按下主畫面按鈕「設備連線」，開始與負載監測設備連線，連線 
87 
 
圖 3.12 主視窗電壓和電流波形顯示之畫面 
擷取之電壓電流訊號轉換為數位訊號透過 USB 核心電路建立傳輸介
面將資料封包傳送至主機端。主機端將利用程式語言開發之人機界面
視窗畫面，如圖 3.12 所示，將所有接收資料波形即時顯示於人機介
面。在功能列表中，於檢視裏可以選擇其他不同數據分析功能的顯示
畫面。 
3.2 第二年度 
本計畫第二年度為建構一自動分類直接負載控制曲線之系統，以
鑑別實施效果不彰與實施狀況良好之負載。所謂實施效果良好是指參
與用戶基本上遵循負載控制策略，其餘沒有符合控制策略之用戶則歸
類於實施不佳。圖 3.13 為本計畫所提出自動化負載曲線分類系統架
構圖。負載曲線先經過特徵擷取步驟，以降低資料維度並減少原始資
料之雜訊。再經由自動化分類系統，剔除實施不佳之用戶。最後，將
實施良好之用戶進行績效評估，以瞭解該用戶參與負載控制措施之成 
89 
三種空調負載管理措施的分類結果。 
3.2.1 測試資料說明 
本年度計畫以台電實測資料作為所提出之分類系統效能數值驗
證。直接負載控制曲線自動化分類系統利用 Matlab 軟體程式撰寫實
現，績效評估模式計算則是以 Borland C++ Builder 視窗軟體程式建立
完成。本計畫所使用之測試資料台電 89 年於夏季實施各項中央空調
負載管理措施之記錄資料，其中包含中央空調週期性暫停用電、中央
空調遙控降載週期性暫停用電與儲冷式中央空調系統，以及 91 年中
央空調遙控降載週期性暫停用電紀錄資料。整個直接負載控制資料為
89 年和 91 年 6 月至 8 月期間，每日每隔五分鐘所記錄之負載資料，
並且其尖峰日為 7 月 26 日與尖峰時為 15 時。本計畫擷取各用戶於
89 年尖峰週前後各一週，總共三週之負載資料做為訓練及測試資料，
其時間範圍為 89 年 7 月 17 日至 8 月 4 日之工作日，總共 15 個工作
天。 
自動化負載曲線分類系統的效能驗證包含分類準確率以及一般
化（generalization）的能力。因此，本研究把針對每一用戶分成訓練
和測試資料集合，分別為 12 個和 3 個工作天負載資料。此外，本研
究對於 89 年中央空調遙控降載週期性暫停用電紀錄資料作為訓練資
料集合，而 91 年紀錄資料則作為測試資料，使用不同方式來證明自
動化分類系統具有一般性。 
表 3.3 為實施各項中央空調負載管理措施之參與用戶資料分配數
目。89 年中央空調週期性暫停用電、遙控降載週期性暫停用電與儲
冷式中央空調系統暫停用電的實施戶數分別為 15、32 和 11。每一個
實施用戶均擷取 15 個工作天，並按照訓練與測試資料之分配比例進
行資料分配。另外，91 年中央空調遙控降載週期性暫停用電的資料
亦詳列於表中。 
91 
輸 
表 3.4 中央空調週期性暫停用電負載曲線之週期性特徵值 
 週期性分析之標準差值 
符合控制策略之用戶 0.0333 0.0593 0.0699 0.0333 0.0593 0.0699 
不符合控制策略之用戶 0.7546 0.7915 0.8083 0.7546 0.7915 0.8083 
入層則採用 60 個節點、隱藏層取 32 個節點而輸出層取 10 個節點。
同理，在反映射網路之輸入層為 10 個節點、隱藏層為 32 個節點而輸
出層為 60 個節點。另外，在映射網路與反映射網路中其隱藏層皆採
用雙彎曲函數為其轉換函數，而其輸入輸出層則採用線性函數為其轉
換函數，以進行網路訓練。故利用非線性主要成份分析法進行資料特
徵擷取，每筆資料可分別得到 10 個特徵值，以代表該負載曲線的特
徵向量。 
(2). 週期性分析 
週期性分析的主要目的在於擷取各負載曲線之週期特徵，在此可
輔助判別該負載是否明確實施週期性暫停用電。觀察圖 3.14(a)為符合
負載控制策略之參與用戶，分別依照控制週期分別取出 4 個資料點計
算其標準差值。同理，重複選取計算 6 個週期性特徵值，其結果如表
3.4 所示。表中所顯示週期性特徵值趨近於零，表示所取樣的資料點
其分散程度小。反之，觀察圖 3.14(b)為不符合控制策略負載曲線圖，
其週期特徵值會趨近於 1，並且其特徵值會比符合控制策略之用戶為
大。故此一指標可以代表所取樣資料其分散程度與週期性。由以上說
明可知本計畫所提之週期性特徵擷取法可以判斷該負載是否具有週
期之特性，足以作為負載曲線之特徵向量成份。 
(3). 分類結果 
中央空調週期性暫停用電應用自我組織映射網路進行資料分
93 
0.1
0
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
Cutoff=13
20 26 19 25 8 13 14 2 7 3 9 15 21 27 1 4 5 6 11 10 16 22 28 12 17 18 23 24 29 30
歐
基
里
得
距
離
資料中心  
圖 3.15 中央空調週期性暫停用電之樹狀聚類分析圖 
0 5 10 150.6
0.7
0.8
0.9
1
1.1
1.2
1.3
1.4
分類數目
最佳分類數目=13
 
圖 3.16 中央空調週期性暫停用電之 DB 適確性指標計算結果 
95 
每日暫停 6 次之方式。本研究擷取工作日 13 時至 17 時，共 4 個控制
週期。 
(1). 非線性主要成份分析 
該控制措施之負載曲線進行非線性主要成份分析特徵擷取過
程，如同前一節所述。故直接將所有資料列表，如表 3.5。 
(2). 週期性分析 
由於中央空調遙控降載週期性暫停用電之負載特性與中央空調
週期性暫停用電之特性相似，其差異只在於控制週期之不同，所以在
進行週期性分析時所擷取資料週期特徵之方式相同。其數值計算結果
如表 3.6，分別對照圖 3.17(a)實施狀況良好與(b)實施狀況不彰之負載
曲線。 
(a)
0
10
20
30
40
50
60
0 50 100 150 200
時間 (min)
負
載
 (k
W
)
(b)
0
100
200
300
400
0 50 100 150 200
時間 (min)
負
載
 (k
W
)
 
97 
D
B
 指
標
 
圖 3.19 遙控降載週期性暫停用電之 DB 適確性指標結果 
(1). 非線性主要成份分析 
本計畫在進行儲冷式空調系統於非線性主要成份分析時，由於單
筆資料有 288 個資料點，相對於前兩種負載控制措施，網路維度較大
訓練不易。因此，考量負載實際運作特性，以 25 分鐘為一取樣點，
因而每一筆資料為 58 個資料點。非線性主要成份分析網路架構相關
資料如表 3.7。 
表 3.7 儲冷式空調系統進行非線性主要成份分析資料列表 
資料筆數 單筆 資料點 映射網路 反映射網路 
輸入層 隱藏層特徵層特徵層隱藏層 輸出層165 58 
58 32 10 10 32 58 
99 
D
B
 指
標
 
圖 3.21 儲冷式中央空調系統之 DB 適確性指標結果 
表 3.8 分類系統之分類結果比較表 
本計畫特徵資料 
與自我組織網路 
原始資料 
與自我組織網路 
本計畫特徵資料
與倒傳遞網路 
原始資料 
與倒傳遞網路 
    分類系統 
 
 
控制措施 
訓練 
資料 
測試 
資料 
訓練 
資料 
測試 
資料 
訓練 
資料 
測試 
資料 
訓練 
資料 
測試 
資料 
中央空調週期性
暫停用電 100% 98.89% 83.33% 82.20% 100% 95.50% 100% 88% 
遙控降載週期性
暫停用電 98.96% 96.88% 95% 81.25% 100% 95.83% 99.40% 92.70%
儲冷式中央空調
系統 100% 96.97% 99.24% 96.96% 100% 96.97% 100% 93.93%
3.2.2.4 結果比較與討論 
本計畫使用傳統倒傳遞類神經網路與自我組織映射網路分類系
統作結果比較，並同時將原始負載曲線資料由分類系統直接進行分
類，以驗證前置特徵擷取處理之有效性。所有分類結果如表 3.8。 
由表 3.8，前兩種不同組合分類系統主要顯示資料前置特徵處理
101 
 
圖 3.22 易造成各項空調負載管理措施誤分類之負載曲線 
因而造成週期性之標準差特徵過大，所以在分類過程易歸類於
實施情形不佳之負載。 
 負載未按照受控週期實施之影響：觀察圖 3.22(c)為中央空調遙
控降載週期性暫停用電之用戶負載曲線，由於此負載並未按照
空調負載管理措施採運轉 45 分鐘暫停 15 分鐘之受控週期，但
是其負載特性仍具週期之特性，因而造成在特徵擷取時擷取出
此負載週期之特性。因此，在分類過程中容易將此負載誤歸類
於實施狀況佳之負載，因而造成所建構之分類系統的分類準確
率下降。 
 夜間儲冰時間過短之影響：觀察圖 3.22(d)為中央空調儲冷式空
調系統之用戶負載曲線，此負載在夜間實施儲冰運轉時間過
短，因而造成在分類過程中容易將此負載誤歸類於實施狀況不
佳之負載。 
103 
遙 
表 3.10 中央空調週期性暫停用電抑低負載量與減少用電量 
組       別 戶   名 抑低 負載量
減少 
用電量 
抽樣 
比例( % )
A 大統百貨 93.946 121.72 28.95 
B 中和公所 76.822 154.942 21.89 
金屬工業 202.035 425.034 C 
台南監理站 71.423 156.508 
30.50 
89 年之抑低負載量(kW) 524 
89 年之減少用電量(kWh) 3,035 
資料來源：台電負載量測資料，台電公司業務處負載管理課提供，民國 89 年。 
表 3.11 中央空調遙控降載抑低負載量與減少用電量 
組       別 戶   名 抑低 負載量 
減少 
用電量 
抽樣 
比例(% )
湯成開發 117.804 162.078 A 東華育樂 30.531 67.522 69.89 
桃園醫院 79.07 386.342 B 海馥建設 52.21 20.206 50.48 
C 環保署 188.45 258.628 75.55 
D 
鴻禧 
育樂公司 31.565 42.136 68.52 
89 年之抑低負載量(kW) 192.52 
89 年之減少用電量(kWh) 1,537.7 
105 
資料來源：電話訪問調查結果，民國 89 年。 
表 3.13 儲冷式中央空調系統抑低負載量與轉移用電量 
行   業   別 戶     名 抑低 負載量
轉移 
用電量 
抽樣 
比例(%)
統一企業 2,590.11 6,907 食品業 
黑松公司 6,033.14 7,491 38.7597
公共行政機關 大安行政中心 4,017.55 3,013.11 5.492
合勤科技 4,572.9 6,724.99 
華航修護 6,070.48 9,339.2 
台積電 4,884.543 615.65 
旺宏電子 11,471.91 8,603.93 
電子、電機、機械等業 
台裕橡膠 2,323.6 2,129.98 
43.4844
中國信託 3,609.65 2,707.24 工商大樓 
中港晶華 15,882.3 26,470.53 
40.45
89 年之抑低負載量
(kW) 211,020 
89 年之轉移用電量
(kWh) 228,580 
3.3.2 結果比較與討論 
本計畫依據實測空調負載資料考慮分組輪流暫停之影響、反饋現
象之去除與剔除實施績效不彰之用戶三個因素所訂定績效評估模
式，應可獲得較精準之評估，但抽樣用戶因而過少，為其缺點。本計
畫透過實測之負載資料分別進行中央空調週期性暫停用電、中央空調
遙控降載週期性暫停用電與儲冷式空調系統之績效評估，分別獲得如
前所列之數值結果。由各項空調負載管理措施績效評估的結果顯示其
各項措施之實施情況並未能達到預期之成效，也就是無法獲得較高的
抑低尖峰用電量與減少用電量。因此，本計畫針對各項負載管理措施
之建議如下： 
對參與中央空調與中央空調遙控降載週期性暫停用電之用戶，應  
107 
[11] 陳孟誼, 台灣電力系統整體資源規劃, 中原大學電機工程學系碩士論文, 
2001. 
[12] 大樓空調系統節約用電設計效益評估研究, 台灣電力公司，民國八十四年。 
[13] 儲冷式中央空調系統及套裝式儲冰空調系統措施, 台灣電力公司，民國八
十九年。 
[14] J. Edward and Jackson, A User’s Guide to Principal Component, New York, 
1991. 
[15] J. Luo, B. Hu, X.T. Ling, and R.W. Liu, “Principal Independent Component 
Analysis,” IEEE Trans. On Neural networks, Vol. 10, no. 3, July 1999. 
[16] P. Laguna, G. B. Moody, and R. G. Mark, “Analysis of The Cardiac 
Repolarization Period using the KL Transform: Applications on the ST-T 
Database,” Comput. Cardiol., pp.223-236, 1994. 
[17] D. K. Kim and N. S. Kim, “Speaker Adaptation Using ProbabilisticPrincipal 
Component Analysis,” IEEE Trans. Signal Processing, Vol. 8, no. 6, June 
2001. 
[18] T. Stam, K. Diam, N. Mag, and M. Str, “ECG Analysis Using Nonlinear PCA 
Neural Networks for Ischemia Detection,” IEEE Trans. On Signal Processing, 
Vol. 46, pp. 3058-3066, Nov. 1998.  
[19] E. Oja, “The Nonlinear PCA Learning Rule and Signal 
Separation-Mathematical Analysis,” Helsinki Univ. Technol., Rep. A26, Aug. 
1995. 
[20] F. D. Frate and G. Schiavon, “Nonlinear Principal Component Analysis for 
Radiometric Inversion of Atmospheric Profiles by Using Neural Networks,” 
IEEE Trans. On Geoscience And Remote Sensing, Vol. 37, pp. 2335-2341, Nov. 
1999. 
[21] K. I. Diamantaras and S. Y. Kung, Principal Component Neural Networks: 
Theory and Applications, On Adaptive and Learning Systems for Signal 
Processing, Communications and Control, New York: Wiley, 1996. 
[22] M. A. Kramer, “Nonlinear Principal Component Analysis Using 
Autoassociative Neural Networks,” AIChE J., Vol. 37, pp. 233–243, 1991. 
[23] J. Han and M. Kamber, Data Mining: Concepts and Techniques, San Francisco, 
2001. 
109 
[39] T. S. Key, “Diagnosing Power Quality-Related Computer Problems,” IEEE 
Transactions on Industry Applications, Vol. IA-15, No. 4, pp. 381-393, 
July/August 1979. 
[40] L. Cristaldi and A. Ferrero, “A Method and Related Digital Instrument for the 
Measurement of the Electric Power Quality,” IEEE Transactions on Power 
Delivery, Vol. 10, No. 3, pp. 1183-1189, July 1995. 
[41] “ LF398 Monolithic Sample-and-Hold Circuits Datasheet,” National 
Semiconductor, July, 2000. 
[42] “ADC0804 8-bits A/D Converters Datasheet,” Intersil, August, 2002. 
[43] “ Universal Serial Bus Specification Revision 1.1,” http://www.usb.org, 
September, 1998. 
[44] “EZ-USB AN21XX Technical Reference Manual,” Cypress Semiconductor, 
August, 2002. 
 
伍、計畫成果自評 
本計畫於第一年之執行期限內，採用系統架構整體規劃，其中分
為軟體、硬體和韌體三部分相互配合進行，並依照計畫訂定目標循序
執行，進而順利達成計畫預定之目標。 
本計畫中，虛擬儀表程式介面設計於個人電腦，可即時顯示紀錄
用戶用電量，虛擬儀表與網際網路使用結合，完成遠端監測和用戶用
電資料收集的實現不僅較為經濟，更增加了量測使用的方便性、效
率、適應性。使用 USB 傳輸介面可增加資料的傳輸速度且具熱插拔
之特性，已成為個人電腦標準傳輸介面，並逐漸取代傳統介面；再加
上將前期計畫完成之非侵入式監測功能結合於虛擬儀表系統中，可降
低硬體開發成本，且兼具所需各項電力監測功能。 
此外，第二年度之執行期限內，本計畫提出直接負載控制曲線分
類系統的設計方法，採用非線性主要成份分析與週期性分析兩種特徵
 111
陸､附錄 
A. 行政院國家科學委員會補助國內專家學者出席國際學術會議報告  
                                             96年 5 月 27 日 
報告人 
姓名 
楊宏澤 服務機構
及職稱 
中原大學 電機系 教授 
     時間 
會議 
     地點 
96年 5月 27日起至 96
年 5月 29日 
本會核定
補助文號
95-2221-E-033-083 
專題研究計畫  
會議 
名稱 
 (中文) 第六屆WSEAS 國際電機工程應用學術研討會 
 (英文) 6th WSEAS International Conference on 
Applications of Electrical Engineering (AEE '07)  
發表 
論文 
題目 
 (中文) 應用改良式田口法於自備發電機用戶契約容量
訂定最佳化  
 (英文) Improved Taguchi Method Based Contracted Capacity 
Optimization for Power Consumer with Self-Owned Generating 
Units 
報告內容應包括下列各項： 
一、 參加會議經過 
二、 與會心得 
三、 建議 
四、 攜回資料名稱及內容 
 
 
 113
Athens 大學，Professor Frangiskos V. Topalis主講。 
z PLENARY LECTURE 3 之「The International Scientific Dialogue in 
Electrical Engineering」，由希臘Military Inst. of University Education，Prof. 
Nikos E. Mastorakis主講。 
主題演講者有備而來，內容精闢，尤其是光感測器系統應用於節能
自動化系統技術現況與實際成效之介紹，令人印象深刻。 
午餐後參加 Session: Power Systems I之議程，由 Dr. Malihe M 
Farsangi 與本人共同主持，參與論文之發表與討論，包括“Improved 
integration-reset controlled single phase unity power factor boost 
rectifier with lower distorsion”，“Curved Space Optimization for 
Allocation of SVC in a Large Power System”，“Analysis of the effects 
of magnetizing inrush current on power transformer differential 
protection”，與本人及研究生之“Improved Taguchi Method Based 
Capacity Contract Optimization for Power Consumer with Self-Owned 
Generating Units”，“Hybrid Fuzzy LFC Design by GA in a Deregulated 
Power System”，“Optimal Reconfiguration of Distribution System by 
PSO and GA using graph theory”，以及” The influence of the Corona 
Current to the Ground and the Polarity Effect of Small Air Gaps”，發表
論文者來自羅馬尼亞、伊朗、印度、美國、土耳其及台灣，皆能充
分準備，與會者亦充分發言，達到技術與意見交流之目的。本議程
 115
Controlled Series Capacitor”, “A Comparative Approach  for Contour 
Detection  of Brain Tumors by Using Image Correlation Techniques on 
tomography images”，等八篇論文之發表及討論。 
二、與會心得 
本次三項會議共有論文近 150篇之多,其中台灣發表的論文約有
4 篇,台灣前往會議的人士包括大學教授、研究生共約 4 餘人左右,台
灣電力方面的論文發表數目在歐洲，因地處遙遠，未來亦應持續鼓
勵國內學者廣為參與歐洲地區國際學術研討會議。 
從本次的會議中可以看出論文品質有很大的提升;在分組討論
中可以看出新的研發方向,特別在電力品質與再生能源方面有相當多
的討論。在本次會議中能認識其他國家的人士,彼此能交換心得,對於
開拓視野、提升研究品質有莫大的幫助。 
三、建議 
鑑於參加歐洲地區國際會議國內學者日益減少的趨勢，應盡可
能鼓勵國內學者多積極參與，以增加國際學術地位，並藉以開拓視
野、提升研究品質。 
四、攜回資料名稱及內容 
計相關論文光碟與紙本論文集一份。 
 


apparatus of the generating unit consist of boiler 
system, air pollution treatment system, and cooling 
system. The expenses for power consumption include 
costs of TPC bill and the self-owned generating unit 
operations which involves the constant cost and 
variable cost.  
 
2.1 Expenses for Power from TPC  
In the current tariff structures of TPC, the electrical 
power expenses are composed of those for base load, 
variable load, regulated power factor, and excessive 
load over contracted capacity. The load demand over 
the contracted capacity would be charged 
additionally for over-capacity penalty.  
To avoid over-capacity penalty, auxiliary power 
sources, like the self-owned generating units, can be 
used to supply the load demand over the contracted 
capacity with extra capital and operational costs 
needed. Therefore, an optimal contracted capacity 
exists with minimal total expenses of power 
consumption.  
The electrical power expenses can be expressed 
as follows. 
 
1. Base power expenses jB  
2 ,1 , jjj BBB +=   (1) 









<×+−
×+−×+
×+×
=
05.0)(           ,  0
otherwise  ,                                         
]5.0)([  
2 ,1 ,3 ,
2 ,1 ,3 ,3 ,
2 ,2 ,1 ,1 ,
1 ,
jjj
jjjj
jjjj
j
YYY
YYYX
YXYX
B  
where 1 ,jB  is the regular load tariff in jth month; 
, 1 , 2 , 3,  ,  and j j jX X X  are the tariff of the peak, 
semi-peak, and off-peak contracted capacities in jth 
month; 3 ,2 ,1 ,  , , jjj YYY  are peak, semi-peak, and 
off-peak contracted capacities in jth month;  
 15.01 ,2 , ×= jj BB  (2) 
where 2 ,jB  is the reserve capacity fees. 
 
2. Variable power expenses ( jS ) 
Variable power expenses are based on real power 
consumption in peak and semi-peak load periods, 
Saturday non-peak period.  
 
3. Regulated power factor expenses ( jR ) 
 









>
−××+
≤
−××+
=
8.0                               
),8.0(0015.0)(
8.0                               
, )8.0(003.0)(
average
jj
average
jj
j
pf
pfSB
pf
pfSB
R  (3) 
where pf  is the power factor. 
 
4. The penalty of excessive load ( jF ) 
 




×≥×
×≤<×
=
k ,
k ,k ,
1.1     ,  3
1.1     ,  2
jjj
jjjj
j
YDB
YDYB
F  (4) 
where jD  is the highest load demand in jth month. 
 
5. Contracted capacity expenses ( jP ) 
Based on the original capacity contracted with the 
utilities, the consumers can also adjust it subject to 
adjusting charge per the capacity adjusted, except 
shifting the peak contracted capacity to the off-peak 
one [11]. The shifting of the peak contracted capacity 
to the off-peak is actually encouraged as mentioned 
before. 
 
2.2 Expenses for Power from Self-Owned 
Generating Units 
To avoid the over-capacity penalty, the self-owned 
generating units can be employed to supply the load 
demand over the contracted capacity with extra 
capital and operational costs needed, which are 
further illustrated below.  
 
1. Constant cost ( conG ) 
The constant costs needed for self-owned generating 
units are given in Table 1 with depreciation of twenty 
years. The monthly cost items encompass 
infra-structure needed, generation equipment, and 
constant operation and maintenance (O&M) costs. 
For example, the monthly constant cost of one 
self-owned generating unit is NT$ 730.79M in 
average of 7 units. 
 
2. Variable cost ( varG =sum{U1,n+ U2,n}) 
The variable costs of generating units are the fuel cost 
and the variable O&M costs. Fuel costs are calculated 
according to Eqs. (5), (6), and (7). 
 
 
max,Gi
Gi
P
P
x =  (5) 
Proceedings of the 6th WSEAS International Conference on Applications of Electrical Engineering, Istanbul, Turkey, May 27-29, 2007      72
e.g., each level of each column in Table 4 
appears 27 times. 
2. Each combination of factors between any two 
columns appears the same number of times, e.g., 
each pair between every two columns in Table 4 
appears once.  
With the orthogonal matrix built up, different total 
costs (e.g., J1 - J81) for different contracted capacity 
combinations can be calculated by (8).  
 
 
3.2 Integrated Search Scheme 
In search scheme, the PSO method is used to create 
the next trial values of decision variables for 
contribution of levels in the traditional Taguchi 
Method. The mathematical form is shown below. 
 mov
oldnew VLL +=  (9) 
 )()( 21
old
b
old
bmov LTcLJcV −×+−×=  (10) 
where 
oldL  the last contracted capacity in the 
iteration; 
 
newL  the new contracted capacity; 
 movV  the size of movement; 
 bJ  the lowest-cost combination of 
contracted capacity in this iteration; 
 bT  the lowest-cost combination of 
contracted capacity so far; 
 21  , cc  the random numbers between 0 and 1. 
 
Each iteration of the optimization would have a 
combination of contracted capacity with a calculated 
total power expenses. It is noted that contribution of 
each level is the summation of expenses of the same 
level number. The contribution of levels has six 
kinds of level combinations as shown below [7, 8]: 
1. 
)3(
 ,
)2(
 ,
)1(
 , kjkjkj VVV >>  
2. 
)1(
 ,
)2(
 ,
)3(
 , kjkjkj VVV >>  
3. 
)2(
 ,
)3(
 ,
)1(
 , kjkjkj VVV >>  
4. 
)2(
 ,
)1(
 ,
)3(
 , kjkjkj VVV >>  
5. 
)3(
 ,
)1(
 ,
)2(
 , kjkjkj VVV >>  
6. 
)1(
 ,
)3(
 ,
)2(
 , kjkjkj VVV >>  
 
Table 3. The example orthogonal matrix )3( 2181L  
Test factor  
(capacity contracts of each month) 
cost 
Experiment  
1 ,1Y  … 2 ,4Y  … 3 ,7Y   
1 1 … 1 … 2 
1J  
2 1 … 2 … 3 
2J  
3 1 … 3 … 1 
3J  
…
 
…
 
…
 
…
 
…
 
…
 
 
79 3 … 2 … 1 
79J  
80 3 … 3 … 2 
80J  
81 3 … 1 … 3 
81J  
Contribution 
of Level 1 
(1)
1 ,1Y  … 
(1)
2 ,4Y  … 
(1)
3 ,7Y   
Contribution 
of Level 2 
(2)
1 ,1Y  … 
(2)
2 ,4Y  … 
(2)
3 ,7Y   
Contribution 
of Level 3 
(3)
1 ,1Y  … 
(3)
2 ,4Y  … 
(3)
3 ,7Y   
 
In a new iteration, values of contracted capacities 
can be created through Eqs. (9) and (10), and 
contribution combinations of levels above. On the 
other hand, two different columns are exchanged to 
generate different orthogonal matrix. The purpose is 
to decrease the probability of trapping into local 
optimization. The search algorithm would terminate 
if either of the two stopping rules is satisfied.  
1. Maximum of 1000 iteration; 
2. No significant change occurs for a total 100 
iterations. 
 
 
4  Numerical Results 
To verify the effectiveness of the proposed method, 
this paper employed the real data collected from an 
optoelectronics factory with self-owned generating 
units in September, 2004 to March, 2005. The data 
include the operation costs of the self-owned 
generating units, the predicted power load demands, 
and the purchase cost of power from utilities. The 
results obtained from the proposed method are 
compared with that currently adopted by the factory 
for the power dispatching and contracted capacity 
setting. The studies consist of the following steps for 
performance comparison of the proposed and the 
existing methods: 
Proceedings of the 6th WSEAS International Conference on Applications of Electrical Engineering, Istanbul, Turkey, May 27-29, 2007      74
