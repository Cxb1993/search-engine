 目錄 
一、摘要........................................................................................................................2 
二、前言與目的............................................................................................................2 
三.、文獻探討...............................................................................................................3 
四、僵屍病毒之數位解藥研發與管理平台的建立................................................................4 
五、案例驗證................................................................................................................5 
六、結論........................................................................................................................6 
七、計畫自評................................................................................................................6 
八、參考文獻................................................................................................................6 
 
 3
本研究透過國家高速網路中心取得相
關惡意程式樣本，運用行為交叉分析表
(Cross Reference Table)，透過情節法則
(Episode rules) 的探勘，整理歸納出病毒
的共同特徵，建立「病毒特徵資料庫」
及行為決策樹(Decision Tree)，並完成開
發一套僵屍病毒之「數位解藥」及其「監
控管理平台」，透過特徵比對分析出變
種病毒的共同特徵，製作數位解藥，以
增加製作及偵測病毒的速度。 
數位解藥已研發完成，經線上使用者
測試驗證，證明可有效檢測出已知及變
種的病毒，以強化組織內部對僵屍網路
之防護。數位解藥之特色，採用集控式
管理方式，除自動更新版本、自動防護
(疫苗功能)與解毒功能外，解藥會對電
腦系統檔案自動進行備份，並回傳主機
的系統資訊，達到即時通報與監控目
的，可大幅降低對僵屍病毒的威脅。 
監控管理平台之研發可強化網路安全
防護，降低網路管理人員的負擔，主要
系統功能包括：1.異常流量監控 2. 數位
解藥派送 3.自動化監視病毒感染與緊
急斷線 4.標示區網內受感染主機位置5.
描繪僵屍網路之攻擊來源。 
 
三.、文獻探討 
3.1 病毒檢驗法 
現今已知的病毒檢驗法方可歸納為以
下六種技巧: (1)病毒碼比對法(Matching 
Virus Definition Patterns) 、(2)完整性檢
查法(Check Sum)、(3)即時輸入輸出掃描
法(Real Time I/O Scan) 、(4)虛擬機器模
擬法(Virtual Machine Simulation)、(5)先
知 掃 描 法 (Virus Instruction Code 
Emulation, VICE)、  (6)人工智慧陷阱
(Rule-based)。(賴榮滄、蔡秉欣，民 89；
陳奕明、劉順德，民 90；吳鼎武、林修
遠，民 92) 
(1)病毒碼比對法 
「病毒碼(pattern)」意指病毒中具有特
色的一段程式碼，在病毒碼挑選時，必
須 注 意 病 毒 碼 的 長 度 及 合 理 性
(Legitimate) ，因為病毒碼長度將影響病
毒掃描比對的時間，合理性可以降低病
毒偵測誤報的機率(陳奕明、劉順德，民
90)。目前，市面上所售之防毒軟體大部
份皆採用病毒碼比對法來檢測病毒，因
為此方法可以較準確地檢測已知的病
毒，但缺點是無法偵測出未知或變種病
毒。另外，病毒的變種的速度往往比病
毒碼更新的速度還要快，導致必須時時
更新病毒碼，當病毒碼資料庫的資料越
來越多時，將降低病毒掃描的速度。 
(2) 完整性檢查法 
利用特定演算法來判斷檔案的完整
性，即可判斷是否有遭受到惡意竄改或
病毒攻擊，可用來偵測未知病毒。但缺
點是須先建立檢查碼資料庫，若檔案更
新或修改時，必須重新建置檢查碼，將
造成用戶的負擔。 
(3) 即時輸入輸出掃描法 
針對電腦輸入及輸出的所有資料流進
行掃描，在病毒尚未完成其破壞或修改
動作時即可偵測出病毒是否存在。目
前，許多防毒廠商已將此方法應用於防
毒程式中，如趨勢科技、賽門鐵克。但
缺點是必須掃描所有程式執行前的輸入
及輸出資料流，將造成系統的負擔。 
(4) 虛擬機器模擬法 
主要是用來偵測多型技術或變體引擎
(Mutation Engine)來生不同的程式碼產
生的變種病毒；多型技術是指當病毒在
感染檔案時，會先產生與原先不同的程
式碼，再將程式碼複製到受感染的檔案
中，產生不同程式碼的技術 (吳鼎武、
林修遠，民 92)。當病毒進行感染時，病
毒碼以亂數方式進行加密，並用覆蓋或
嵌入方式隱藏於受感染的檔案中，傳統
病毒碼比對法無法偵測出此類病毒。偵
測病毒的方法就是模擬 CPU ，並在虛
擬機器內假執行程式碼，經過解密後，
安全地將多型病毒體解開，再利用傳統
的掃描方式進行掃描。其缺點是將耗費
大量的系統資源，導致掃描的速度減慢。 
(5) 先知掃描法 
虛擬機器模擬是模擬 CPU 動作並假
執行程式以解開病毒本體，以進行掃
描。而 VICE 是由虛擬機器模擬法所衍
生出來的偵測技術，工程師用來判斷程
式是否存在病毒碼的方法，經過分析歸
納後，建置成專家系統知識庫，再利用
軟體仿真技術(Software Emulation) 仿
真執行新的病毒，即可分析出新的病毒
碼。 
(6)人工智慧陷阱 
人工智慧陷阱的目的是以常駐程式的
方式偵測電腦中惡意程式之行為，主要
 5
針對 2010 年研發之第一代解藥系統，
無法與監控管理平台整合，本年度搭配
agent 導入並改良資料庫之資料結構，增
加「回報訊息機制」及「病毒碼自動更
新」，並能接收監控平台發送之「中斷網
路連線」的指令，並且會「自動彈出警告
視窗」提醒使用者要備份重要資訊，精進
為第二代數位解藥，如圖 3(修改部份如紅
字部份)。 
監控管理平台實做是參考 Ntop 開放源
程式碼，使用 C#.Net 並搭配 JADE 軟體代
理人，將病毒行為/動作關連表(如表 1)
轉換為網路監控準則(detection rules)，監
控準則例如開啟特定 Port 與查詢特定網
址，或短時間內產生大量攻擊封包，並將
這些規則納入至監控平台之偵測準則，當
區網內電腦出現異常行為並觸發準則，則
可對該電腦之 IP 進行連線封鎖，並發信通
知管理員，直到該電腦之網路行為獲得改
善方解除封鎖，監控管理平台監控示意
圖，如圖 4。 
4.3 病毒樣本的蒐集 
病毒樣本來源是由「國家網路高速中
心」及「國家資通安全會報技術服務中心」
之惡意程式交流平台所提供，部份樣本重
複並許多無法重新執行的現象，雖提供病
毒特徵 XML 檔案，因無法重新執行樣本
以確認其正確性，將相關病毒樣本去除。
統計至 99.8.10 共蒐集 318 項樣本，本實
驗室重新確認病毒的行為歷程分析，去除
無法重新執行及部份具反偵測的病毒樣
本虛擬作業系統及自我隱藏性，並從樣本
庫中挑選具代表性的 90 隻僵屍病毒，包
含 IRC 、P2P 、混合型、HTTP 等四類
型態病毒進行分析，統計如表 2。 
另外，利用防毒軟體 Clam Anti Virus、
Avira AntiVir 及 Virustotal 分析網站針對
所分析之病毒進行病毒命名及判別，完成
後即可建立僵屍病毒特徵資料庫。 
 
五、案例驗證 
本研究實證將透過案例，模擬真實網
路環境的電腦感染僵屍病毒後，利用數位
解藥系統之監控管理平台進行系統監控
防護。第一階段測試於崑山科技大學資訊
系統應用與服務實驗室以虛擬機器模擬
工具 VMware 測試案例的可行性，確認僵
屍病毒解毒與了解網路監控的情況；第二
階段測試將運用成功大學資通安全測試
平台(TestBed@TWISC) 進行 Bot 數位解
藥測試驗證如圖 5。以下將透過二個測試
案例，驗證本研究之可行性，是否能達
到預期的功效。 
5.1 測試案例 A－僵屍病毒偵測 
本研究挑選一個近期取得之 IRC 型
態的僵屍病毒進行模擬驗證，實驗時並
不知此病毒之行為特徵是否列入特徵資
料庫中，利用本研究開發之偵測系統，
針對主機行為特徵及網路行為特徵進行
掃描分析，掃描完成後，系統將自動顯
示其掃描結果。本測試案例透過以下實
驗流程如圖 6，進行病毒檢測，測試病
毒資訊及詳細說明如下： 
(1) 病毒編號：Sample 8 IRC 僵屍病毒 
(2) 病毒名稱：TR/Downloader.Gen，由
防毒軟體 Clam AV 定義 (3)病毒來源：
國家網路高速中心(TWAREN) (4)取得
日期：2009 年 10 月 20 日。 
實驗程流主要有以下四個步驟： 
步驟 1. 本工具安裝檔為 Scan.exe 自解安
裝檔，點擊安裝檔後，按下「安裝」按鈕，
即可由預設目錄 C:\下執行 BotScan.exe 掃
描工具。 
步驟 2. 執行病毒編號為 Sample 8 的 IRC 
Bot 病毒，當病毒執行後，執行檔將自動
隱藏。 
步驟 3. 開啟偵測系統(BotScan.exe) 後，
點擊「系統掃描」，將開始偵測比對並記
錄本機行為特徵與網路行為特徵。 
步驟 4. 掃描結果如圖 7，顯示系統已感
染 僵 屍 病 毒 ， 病 毒 名 稱 為 TR/ 
Downloader.Gen ，由 Clam AV 掃描引
擎定義，並顯示信心度與支持度及相關
異常特徵。由圖 7 得知偵測系統的掃描
結果為 IRC 型態的僵屍病毒，病毒名稱
為 TR/Downloader.Gen ， 由 Clam 
Antivirus 定義。偵測之信心度為 71%、
支持度為 53%。 
偵測系統發現異常行為特徵共有以下五
項： (1)下載 myreceve.com 並新增至
C:\WINDOW \System32\目錄下 (2)修改
系 統 登 錄 檔 HKEY_LOCAL_ 
 7
八、參考文獻 
1. 楊中皇、丁光立，「殭屍網路活動偵測工
具研發」，國立高雄師範大學資訊教育研究
所未出版碩士論文，民國 99 年。 
2.李倫銓，「利用攻擊資訊整合分析在 ISP 端
進行 Botnet 的行為偵測技術」，資訊安全通
訊，第十五卷四期，民國 98 年，111-121
頁。 
3. 朱潮昌，「僵屍網路之威脅與應對」，資
訊安全通訊，第十五卷四期，民國 98 年， 
92-110 頁。 
4.蘇民揚、葉生正、林呈俞、張瑞德, “植基
於模糊關聯規則的網路入侵偵測系統 ,＂ 
Journal of Internet Technology, Vol. 8, No. 2, 
2007, pp. 221-228 
5.田筱榮、吳孟徽 整合環境風險之入侵警報
量化評估  中原大學資訊工程研究所未出
版碩士論文，民國 93 年。 
6.賴溪松、王榮祥，「僵屍網路偵測方法之研
究與實作」，電腦與通信工程研究所未出版
碩士論文，民國 97 年。 
7.陳嘉玫、鄭炳強、蔡育洲，「使用 Flow 資
訊偵測以網頁為基礎之殭屍網路」，國立中
山大學資訊管理研究所未出版碩士論文，民
國 97 年。 
8.鄭憲宗、曾瑞瑜，「以活動關連為基礎的 IRC
殭屍網路偵測」，國立成功大學資訊工程研
究所未出版碩士論文，民國 98 年。 
9.陳奕明、劉順德，「以樹狀關聯式架構偵測
電子郵件病毒之探討」，國立中央大學資訊
管理學系未出版碩士論文，民國 90 年。 
10. 王平，李奇軒， 僵屍電腦監控平台之研
發，第 22 屆國際資訊管理學術研討會
(ICIM2011),100.5.21, 朝陽科技大學。 
11.曾黎明、陳天豪，「透過封包分析偵測並
瓦解僵屍網路」，國立中央大學資訊工程研
究所未出版碩士論文，民國 98 年。 
12.李中彥、鄭家憲，「以 VBScript 病毒行為
知識發展 API 病毒偵測」，中國文化大學資
訊管理研究所未出版碩士論文，民國 94 年。 
13.曹偉駿、柯文元、林明孝，「模糊關聯與
情境法則探勘於入侵偵測」，2005 年全國
計算機會議，台南: 中華民國電腦學會，民
國 94 年。 
14.王 平、王榮祥、蘇浩儀、郭溥村，「殭屍
網路的感染途徑重建與分析」， TANET 
2008 臺灣網際網路研討會，高雄: 教育部
電子計算機中心，民國 97 年。 
15.王平、郭溥村、王子夏、王清平，「殭屍
網路的攻擊路徑分析模式」，第二十屆資訊
安全會議研討會(CISC2010)，新竹: 教育部
電子計算機中心，民國 98 年。 
16.王子夏，王平，林輝堂，賴溪松，改良式
蟻群演算法應用於殭屍網路控制中心溯源
分析，「第二十一屆資訊安全會議研討會
(CISC2011) 」 ， 國 立 虎 尾 科 技 大 學 , 
100.5.26~27。 
17. 賽門鐵克，“北市殭屍電腦 全球最「駭」
城 市 ＂ 2011, source from: 
http://tw.myblog.yahoo.com/major_technolog
y/article?mid=843&next=841&l=d&fid=9 
18. AgentLand,“What's an agent.＂ , 2001, 
from:http://www.agentland.com/ 
19. Binkley J., Massey B., "Ourmon and 
Network Monitoring Performance", 
Freenix/ USENIX ’05, April 13, 2005. 
20. Mannila, H., Toivonen, H. and Verkamo, I. 
A. (1997), “Discovery of Frequent Episodes 
in Event Sequences,” Data Mining and 
Knowledge Discovery, 1(3):259-289. 
21. Ntop.org, “ NetFlow-lite and sFLOW 
based Open Source Network Traffic 
Monitoring. ＂ 2011, from:  
http://www.ntop.org/news.php 
22. Qin, M. and Hwang, K. (2004), “Frequent 
Episode Rules for Internet Anomaly 
Detection,” In Proceedings of Third IEEE 
International Symposium on the Network 
Computing and Applications, August 30, 
Los Angeles, CA, USA, 161-168.  
23. Wang, P., Sparks, S., and Zou, C.C. (2007), 
“An Advanced Hybrid Peer-to-Peer 
Botnet,” In Proceedings of the USENIX 
Workshop on Hot Topics in Understanding 
Botnets (HotBots’07), April 10, Berkeley, 
CA, 2-2. 
24. Lai G.H., Chen C.M., Jeng, B.C., and Chao 
W., "Ant-based IP traceback", Expert 
Systems with Applications, Nov. 34, No.4, 
2008, pp.3071–3080. 
25. Mannila, H., Toivonen, H. and Verkamo, I. 
A., “Discovery of Frequent Episodes in 
Event Sequences,” Data Mining and 
 9
3. 王平，陳裕禎，張原豐，邵子宣，銀髮族
醫療輔具及創新服務之專利分析，電子商
務研究學報。 
會議論文 
1. Ping Wang,  Tzu Chia Wang,   Pu-Tsun Kuo, 
Chin Pin Wang, An Analysis Model of 
Botnet Tracking based on Ant Colony 
Optimzation Algorithm, NCM2010, 
pp.606~609, 16~18 Aug, 2010, Seoul, 
Korea.  
2.王平, 葉俊吾, 謝欣學,行動化數位學習平台
設計與實作 -以 Android 作業系統為
例,  景文科技大學，2011 資訊管理學術與
實務研討會,100.5.24. 
3. 王平，王子夏，曾生元，郭溥村，殭屍網
路控制中心之溯源分析，「TANET 2010 
臺灣網際網路研討會」，國立台南大學，
99.10.23。 
4.王平，李奇軒， 僵屍電腦監控平台之研發，
第 22 屆國際資訊管理學術研討會
(ICIM2011),100.5.21, 朝陽科技大學. 
5. 王子夏，王平，林輝堂，賴溪松，改良式
蟻群演算法應用於殭屍網路控制中心溯
源分析，「第二十一屆資訊安全會議研討
會 (CISC2011)」，  國立虎尾科技大學 , 
100.5.26~27。(本篇論文榮獲第二十一屆資
訊安全會議學生論文佳作) 
6.王平，蔡雅雯，呂育華， 網路殭屍病毒攻
防實驗工具之開發，「Uhome 2010 資訊
研討會」，崑山科技大學， 99.11.04。 
7. 王平，沈英謀，樊鈺承，謝欣學，數位儀
表之設計與實現－以企業戰情室為例，
Uhome 2010 資訊研討會，崑山科技大學， 
99.11.04。 
8. 王平，張原豐，互動式遊戲之專利分析，
「Uhome 2010 資訊研討會」，崑山科技
大學， 99.11.04。 
9.王平，盧永翔，雲端服務之資安監控－軟體
代理人的應用，Uhome 2010 資訊研討
會，崑山科技大學， 99.11.04。 
10. 王平，李奇軒，呂育華，黃財德，王清平，
變種僵屍病毒數位解藥的研發，第十六屆
資訊管理暨實務研討會(IMP2010)，國立
雲林科技大學，99.12.11。 
 
 
 
 
 
 
 
 
 
 
 11
 
 
圖 2 數位解藥製作流程 
 
 
圖 3 第二代數位解藥之佈署及運作流程 
 13
 
圖 7 系統掃描結果 
 
 
圖 8. 數位解藥(疫苗)啟動主機自動監控 
 
 
圖 9 系統修復結果 
 
 15
 
圖 12 病毒碼更新 
 
 
 
圖 13 異常流量查詢 
圖
 
 
 
 
 
國科會補助計畫衍生研發成果推廣資料表
日期:2011/09/10
國科會補助計畫
計畫名稱: P2P僵屍病毒之偵測與防護
計畫主持人: 王平
計畫編號: 99-2219-E-168-001- 學門領域: 應用服務(網通國家型)
無研發成果推廣資料
期刊論文 2 1 100% 
1. Ping Wang, Kuo-Ming 
Chao, Chi-Chun Lo and Ray 
Farmer, Pu-Tsun 
Kuo ,’’’’’’’’An 
evidence-based scheme 
for web service 
selection’, 
Information Technology 
and Management 
(ITEM),Vol.12, No.2, 
pp.161~172, 4 May 2011, 
Springer. (SSCI) 
 
2 Ping Wang, H-T,
Lin ,Tzu Chia Wang, 
Pu-Tsun Kuo, A new 
approach for solving the 
IP traceback problem for 
Web services, 
International Journal on 
Advances in Information 
Sciences and Service 
Sciences, Vol.3, No.2, 
pp.46-59,  Mar 31, 2011. 
(EI) 
 
研究報告 /技術報
告 0 0 100%  
研討會論文 1 1 100% 
篇 
Ping Wang,  Tzu Chia 
Wang,   Pu-Tsun Kuo, 
Chin Pin Wang, An 
Analysis Model of Botnet 
Tracking based on Ant 
Colony Optimzation 
Algorithm, NCM2010, 
pp.606~609, 16~18 Aug, 
2010, Seoul, Korea. 
論文著作 
專書 1 0 100% 章/本
Ping Wang, Chih-Chiang 
Ku,  Tzu Chia Wang, A New 
Authentication Scheme 
for Cloud Computing 
Security , Biometrics, 
InTec, 2011. (ISBN: 
978-953-307-488-7) 
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
國外 
技術移轉 件數 0 0 100% 件  
 
