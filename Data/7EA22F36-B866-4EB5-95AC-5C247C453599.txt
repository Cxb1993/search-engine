混合測試回應壓密--結合空間壓密器與未知值阻擋多重輸入位移儲存 
“A Hybrid Scheme for Compacting Test Responses with Unknown Values ” 
計畫編號：NSC96-2221-E-009-233 
執行期間：97 年 8月 1 日 至 98 年 7 月 31 日 
主持人：趙家佐 交通大學電子工程系助理教授 
 
一、 中文摘要 
在輸入圖樣壓縮（input-stimulus compression）
被廣泛研究之後，測試回應壓密（test-response 
compaction）技術逐漸變成掃描測試中，測試資料縮
減的瓶頸。測試回應壓密中最主要的障礙，是在於處
理模擬結果中的未知值。在本計畫中，我們提出了一
個混合式、可容忍未知值的壓密系統，此系統中包含
了一個空間壓密器，以及一個阻擋未知值的多重輸入
位 移 暫 存 器 （ MISR: Multiple-Input-Signature- 
Register）。首先，此混合壓密系統是獨立於自動測試
圖樣產生器（ATPG）之外的，任合自動測試圖樣產生
器所產生之測試集合都可以當做此混合壓密系統之輸
入。其次，此混合壓密系統可以保證，其目標錯誤模
型的覆蓋範圍會跟沒有壓密之前一樣。再者，此混合
壓密系統可以由使用者任意調整其測試回應所被觀察
到之比率，進而使得未被模型化錯誤之覆蓋範圍可以
受到控制。為了要決定多少比率之測試回應該被觀察
到，本計畫亦將研發一個具體量化的方法，來求出應
被觀察比率之最低門檻，並保證未被模型化錯誤之覆
蓋範圍在一可接受之值以上。最後，一個依據此混合
壓密系統所設計之偵錯辦法將會被提出。本計畫亦會
實做一系列之實驗，來證明此混合壓密系統之有效
性，不論在壓縮比率、額外面積負擔、各類模型化錯
誤之覆蓋範圍、以及偵錯之解析度，都會和只用空間
壓密器或只用阻擋未知值的多重輸入位移暫存器做比
較。 
 
 
 
 
 
 
 
英文摘要 
After the intensive study on input-stimulus 
compression, test-response compaction gradually 
becomes the bottleneck of the overall test-data reduction 
in scan-based testing. The key barrier to effective 
test-response compaction is the presence of unknown 
values in the simulation result. In this project, we propose 
a hybrid, unknown-tolerated scheme for test-responses 
compaction, which comprises a space compactor and an 
unknown-blocking MISR (Multiple Input Shift Register). 
First, the proposed hybrid scheme is ATPG-independent, 
taking any test set generated by any ATPG tool as input 
for compaction. Second, the proposed hybrid scheme can 
guarantee no coverage loss for the target fault model 
without requiring any extra pattern. Third, the proposed 
hybrid scheme can be tuned to observe any user-specified 
percentage of responses for controlling the coverage of 
un-modeled faults. In order to determine the fraction of 
responses that should be made observable, a quantitative 
approach will be developed to identify the threshold of 
this observable percentage that can ensure an acceptable 
level of coverage loss. Last, a diagnosis method will be 
proposed based on the proposed hybrid compaction 
scheme. A series of experiments will be conducted to 
justify the effectiveness of the hybrid scheme in terms of 
the compaction ratio, the area overhead, the coverage loss 
for various fault models, and the diagnosis resolution. We 
will also compare the experimental results with those of 
using a space compactor or an unknown-blocking MISR 
alone. 
 
二、計畫緣由、目的、研究方法與實驗結果 
1. Introduction 
The increasing number of scan cells in modern 
designs challenges the scan-based testing on both test data 
volume and test application time. In order to reduce the 
test data volume as well as the number of required 
channels on the ATE, researchers have been actively 
pursuing new solutions to input stimulus compression and 
output response compaction. For output response 
compaction, the presence of unknown values (or 
unknowns) among the good-circuit test responses has 
control signal Si. If Si = 0, the response from chaini 
propagates to the MISR. If Si = 1, the response is blocked 
and a 1 will be applied to the MISR. With this blocking 
logic, we can block all unknowns and observe responses 
critical to fault-detection by assigning proper values to 
the control signals (0 for observing, 1 for blocking). Here, 
we define those critical responses with guaranteed 
observation by a 0 at the control signal as must-observe 
responses. For responses other than unknowns and 
must-observe responses, the value at the control signal is 
a ”don’t-care”. In [5], [6], [7], and this project, the 
must-observe responses are chosen to insure there is no 
coverage loss for the modeled faults. 
u
MISR
S1
u
S2
u
S3
m
m
123
S1
4
10xx
xx1x
cycle
S2
x1x0S3
(a) (b)
u: unknown value      m: must-observe response
chain2
chain1
chain3
 
Fig 1. An example of the unknown-blocking MISR. 
 
In practice, only a very small fraction of the responses 
have an unknown value or must be observed for fault 
detection. As a result, most control signals of the blocking 
logic are ”don’t cares”. [5], [6], and [7] utilize these 
don’t-cares for optimization to achieve high encoding 
efficiency. However, after decoding, some of the 
don’t-cares will be specified as 1; thus, a fraction of the 
non-critical responses with a known value will be 
blocked. 
 
We conducted the following experiments to evaluate 
the potential coverage loss for the un-modeled faults due 
to the loss of observability for non-critical responses. We 
used the stuck-at test patterns for this experiment. Two 
metrics are used to measure the coverage for the 
un-modeled faults: the transition fault coverage and the 
BCE [16], which quantifies the effect of multiple 
detection on a stuck-at fault and approximates the 
coverage of pair-wise bridging faults. The BCE proposed 
in [16] is defined as: 
 



Ff
N fF
BCE ),
2
1
1(
1
                    (1) 
where Nf is the number of detecting patterns for each 
fault f and |F| is the total number of faults. 
 
Four larger ISCAS and ITC benchmark circuits, each 
of which contains more than 1,000 flip-flops, are used for 
the experiment. We first generate ATPG patterns for the 
stuck-at faults. From these patterns, we identify a minimal 
set of must-observe responses. For responses other than 
those identified must-observe responses, we observe them 
randomly according to a specified percentage (which is 
called observable percentage and is denoted as obs_p). 
Based on the selected observation of responses, we then 
simulate the same stuck-at- fault patterns for the transition 
faults and for the BCE calculation. 
 
Table I shows the statistics of each circuit. Columns 2 
and 3 list the total number of stuck-at-fault patterns and 
the total number of flip-flops, respectively. Column 4 lists 
the ratio of the must-observe responses to the total 
responses. Column 5 lists the number of transition faults. 
Columns 6 and 7 list the number of detected transition 
faults and the BCE, respectively, assuming all responses 
are observed. Table II and Table III shows the coverage 
loss for the transition faults and for the BCE, respectively, 
according to each obs_p. 
 
 
Table I:  % of must-observe responses, transition-fault 
coverage, and BCE for stuck-at-fault patterns. 
 
 
Table II:  Transition-fault coverage loss for different obs_p 
 
 
Table III:  BCE loss (in %) with respect to different obs_p 
 
The results in Table II and Table III indicate that 
observing a large percentage of responses is necessary for 
maintaining a high test quality. On average, observing 
only the must-observe responses results in a 22.67% loss 
of the original transition-fault coverage and a 19.10% loss 
of the original BCE, even though the stuck-at-fault 
coverage is not compromised. This implies a potential 
test-quality loss of using selective compactors [2] [3], 
which basically observe only the must-observe responses. 
For an encoding scheme like LFSR reseeding [8], roughly 
50% of the responses cannot be observed due to the 
(denoted by space_obs_p) using the following equation: 
 
1__2__  pobshybridpobsspace          (2) 
 
The rationale behind Equation 2 is that the LFSR for 
the unknown-blocking MISR generates the control signals 
which results in roughly 50% observable responses. For 
example, if hybrid_obs_p = 0.9, we should design a space 
compactor to observe 80% of the responses and an 
unknown-blocking MISR to observe half of the remaining 
20%. Jointly, the overall observable percentage would be 
90%. 
 
Step 2: Generate ATPG patterns for the modeled 
faults and run logic simulation with these pattern to 
derive the percentage of unknowns among all responses 
(xp). 
 
Step 3: Based on space obs_p, M, and xp, design a 
space compactor that supports a maximal number of scan 
chains (S) while achieving space obs_p. 
 
Step 4: Divide the scan cells into S scan chains whose 
outputs are connected to the inputs of the space 
compactor. 
 
Step 5: Run fault simulation for the modeled faults 
using the ATPG patterns. The circuit model used for fault 
simulation includes both the circuit-under-test (CUT) and 
the space compactor. That is, a fault is considered 
detected only if its fault effect appears at an output of the 
space compactor. Because the space compactor only 
observes space_obs_p of the responses, some faults 
detected at the CUT outputs become undetected at the 
space compactor outputs. Record those undetected faults. 
 
Step 6: Identify the must-observe responses based on 
the simulation results of those undetected faults. Generate 
LFSR seeds for supplying the control signals of the 
unknown-blocking MISR, which will be used to observe 
those must-observe responses and to block all unknowns. 
In our experiment, we apply the method proposed in [17] 
to minimize the number of LFSR stages LS required. 
 
Step 7: Build the blocking logic and the LFSR with 
LS stages. In the above procedure, Steps 3 and 6 are two 
keys to maximizing the compaction ratio and achieving 
the target observable percentage. Regarding Step 3, a 
single-weight space compactor is chosen in our hybrid 
compaction scheme. X-Compactor [9] is the 
representative of single-weight space compactors. 
However, the construction rules for our XOR matrix are 
different from those of the X-Compactor, for which each 
column has an unique combination of output connection 
and the weight (i.e. the number of XOR gates in each 
XOR-matrix’s column) has to be an odd number. These 
two rules, while minimizing the error masking probability 
(a.k.a. aliasing probability), do not necessarily reduce the 
probability of unknown-induced masking. For a space 
compactor, the unknown-induced masking impacts more 
on the fault detection than the error masking does [15]. 
Therefore, to minimize the unknown-induced masking 
probability, we allow the use of identical columns and an 
even weight. 
 
When applying a single-weight space compactor, its 
corresponding observable percentage depends upon the 
values of the following four parameters: (1) S, the number 
of scan chains connecting to the compactor, (2) M, the 
number of outputs of the compactor, (3) W, the number of 
XOR gates in each XOR-matrix’s column, and (4) xp, the 
probability that a response has an unknown value. Among 
these four parameters, S, M, and W relate to the 
configuration of the space compactor. xp relates to the 
given CUT and test patterns. Figure 3 uses a 20-to-6 
single-weight space compactor to illustrate these 
parameters. In this example, S = 20, M = 6, and W = 3. 
 
S : # of scan chains
M : # of 
outputs
W : # of Xor gate per column
xp : unknown %
among responses  
 Figure 3. An Example single-weight space compactor. 
 
To construct a space compactor supporting a maximal 
number of scan chains while achieving space_obs_p 
(Step 3), we rely on Equation 3 (derived in [15]) to 
predict its observable percentage. The equation of this 
predicted observable percentage (OP) is: 
 




W
j
S
M
W
jM
WW
j
j xpxpOP
0
)1
)(
)(
()()1(1  (3) 
 
Using this equation for fast prediction, we can 
efficiently list the predicted observable percentage with 
respect to each unique combination of both the weight 
and the number of scan chains for the given M and xp. 
We then search for the configuration with the largest 
number of scan chains (S) that achieves the target 
observable percentage space_obs_p. This search is 
that observing a higher percentage of the responses does 
not necessarily require more test data. The hybrid scheme 
achieves an even greater compaction ratio than when 
using the unknown-blocking-MISR-only scheme for 
circuits s35932 and s38584. This is because the use of a 
space compactor reduces the number of must-observe 
responses for the unknown-blocking MISR, and in turn 
reduce the number of specified bits for the LFSR control 
signals. This reduction in the number of specified bits for 
the unknown-blocking MISR could be more than the 
number of additional storage bits required for the added 
space compactor. 
 
This phenomenon of achieving a better compaction 
ratio will become more significant if the unknown 
percentage decreases. This is because a space compactor 
cannot reduce the number of specified bits for blocking 
unknowns. If the majority of the specified bits of the 
LFSR control signals are for blocking the unknowns, 
adding a space compactor could only modestly help 
improve the compaction ratio. In Table XII, we apply 
different unknown percentages and observe the changes 
in compaction ratios for both the hybrid scheme and 
x-block. Take s35932, for example. When the unknown 
percentage drops from 0.5% to 0.1%, the compaction 
ratio for the hybrid scheme increases from 22.0 to 41.8; 
however, for x-block, the increase of the compaction ratio 
is modest - from 8.3 to 9.2. For the other three circuits, a 
similar trend is observed. 
 
 
 Table VII. Compaction ratio with respect to different 
unknown %s. 
 
4.2 Hybrid vs. Space Compactor alone 
Table VIII compares the hybrid compaction scheme 
with X-Compact [9]. For a fair comparison, we designed 
an X-compactor for each circuit that achieves the same 
compaction ratio as that of the hybrid scheme. Column 4 
lists the number of required ATE channels. We attempted 
to design the X-compactor by using the same number of 
ATE channels as that of the hybrid scheme; however, no 
such X-Compact can achieve the target compaction ratio. 
Thus, Table VIII reports the results of X-Compact that 
uses the fewest number of ATE channels to achieve the 
same compaction ratio as that of the hybrid scheme. 
 
Columns 5, 6, and 7 in Table VIII list the coverage 
loss for the stuck-at faults, the transition faults, and the 
BCE, respectively. The results show that the X-Compact 
incurs some coverage loss for the stuck-at faults while the 
hybrid scheme has no loss at all. The hybrid scheme also 
achieves less coverage loss for the transition faults and 
the BCE for most circuits, save for s35932. Note that 
X-Compact uses more ATE channels than the hybrid 
scheme. This experiment demonstrates that the hybrid 
scheme can provide better test quality than when a space 
compactor alone is used, given the same test data volume 
and the same number of ATE channels. 
 
4.3 Industrial Design 
We conducted further experiments on two industrial 
designs. Table IX lists the statistics for these two designs. 
For this experiment, we used a space compactor with 
eight outputs. The target observable percentage is set at 
90% and the unknown percentage is 0.3%. 
 
 
 Table VIII. Coverage loss of the hybrid compaction 
scheme and X-compact with 0.5% unknowns. 
 
Table X lists the actual observable percentage 
(Column 3), the coverage loss for the transition faults 
(Column 4), the BCE loss (Column 5), the number of 
supported scan chains (Column 6), and the compaction 
ratio (Column 7). Again, the results validate that our 
hybrid scheme can meet the target observable percentage 
and can thus limit the loss of test quality for large 
industrial designs. 
 
 
 Table IX. Characteristics of two industrial designs. 
 
function: 
 
nff DN
f
n
f
DN
nf aanNob
 )1()()(}{Pr       (6) 
 
In the proposed hybrid compaction scheme, however, 
the responses are not observed pure-randomly. For a fault 
not detected by the space compactor, we will specify a 
control signal for the unknown-blocking MISR to detect it. 
This implies that the number of detecting patterns for any 
fault can never be 0. Thus, we need to move the 
probability of Nf = 0 in Equation V to the probability of 
Nf = 1. Therefore, the probability density function 
Prob{Nf = n} becomes: 
 
1:)1()1(
2:)1()()(
{
1 



naaaDN
DNnaa
ff
nff
D
f
DN
fff
f
DN
ff
DN
n
   
 
The above probability density function represents a 
lesser estimation of the Nf because observing a response 
for detecting a previously undetected fault may detect 
some other detected faults as well. A lower bound of the 
expectation of the BCE function (denoted as BCE_Lf ) is 
obtained based on the above density function: 
 
  


fDN
n
fnf
nNobLBCEE
1
}{Pr)
2
1
1(_  
ff DN
f
DNf
a
a
)1(
2
1
)
2
1(1      (7) 
 
Then, we derive an upper bound of the BCE function 
by moving the probability of N = n to the probability of  
N = n + 1 for each n. The expectation of the BCE_Uf is: 
 
  



1
1
}{Pr)
2
1
1(_
fDN
n
fnf
nNobLBCEE  
fDN
fa )1(
2
1
1                  (8) 
 
This upper bound BCE_Uf is too loose, however, 
because Nf = DNf + 1 can never happen – even if all 
responses are observed. So we set the probability of Nf = 
DNf + 1 to 0 and normalize the probabilities of other 
values of Nf such that the summation of this probability 
density function is 1. The revised probability density 
function becomes (for 1 < n <DNf ): 
 
,
)(1
)1(
)()(}{Pr
1
1
1
f
nf
f
DN
f
DN
fn
f
DN
nf
a
a
anNob





   (9) 
 
With this density function, we obtain a tighter upper 
bound for the BCE function (denoted as BCE_EUf ) as 
follows: 
 
  


fDN
n
fnf
nNobUBCEE
1
}{Pr)
2
1
1(_  
})
2
()
2
1{(
)(22
1
1 ff
f
DNfDNf
DN
f
aa
a


     (10) 
 
Our experimental results show that the actual BCE is 
closer to the BCE_EU, rather than the BCE_L. We use an 
empirical weighted function (denoted as BCE_W) to 
approximate the BCE: 
 
LBCEEUBCEBCE _
4
3
_
4
1
              (11) 
 
Figure 4 shows the values of BCE_L, BCE_EU,  
BCE _W, and the actual BCE for different observable 
percentages for circuit s35932. The results indicate that 
the actual BCE is well-bounded by BCE L and BCE EU, 
and can be roughly approximated by BCE_W. Also,  
BCE _U is a much looser upper bound than BCE_EU. 
 
 
 Fig 4. BCE prediction for s35932. 
 
13. J. Rajski, C. Wang, and S. M. Reddy, Convolutional 
Compaction Of Test Responses, IEEE International Test 
Conference, pp. 745-754, 2003. 
14. M. Arai, S. Fukumoto, and K. Iwasaki, Analysis of 
Error-Masking and X-Masking Probabilities for 
Convolutional Compactors, IEEE International Test 
Conference, paper 24.1, 2005. 
15. M. C.-T. Chao, K. T. Cheng, S. Wang, S. T. Chakradhar, 
and W. L. Wei, Unknown- Tolerance Analysis and 
Test-Quality Control for Test Response Compaction 
Using Space Compactors, ACM/IEEE Design Automation 
Conference, pp. 1083-1088, 2006. 
16. B. Benware, C. Schuermyer, N. Tamarapalli, K. Tsai, S. 
Ranganathan, R. Madge, J. Rajski, and P. Krishnamurthy, 
Impact ofMultiple-Detect Test Patterns on Product 
Quality, IEEE International Test Conference, 
pp.1031-1040, 2003. 
17. S. Wang, K. Balakrishnan, and S. T. Chakradhar, Efficient 
Unknown Block Using LFSR Reseeding, ACM/IEEE 
Design, Automation and Test in Europe, pp.1-2, 2006. 
18. Design Compiler, Synopsis Inc., 
http://www.synopsis.com/. 
