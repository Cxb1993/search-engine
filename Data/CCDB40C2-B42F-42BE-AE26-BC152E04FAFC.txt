 -2-
Abstract 
According to American Cancer Society (ACS) statistics, breast cancer is the most common cancer among 
women in USA. It is the second leading cause of cancer death in women. Tumor vascularization has been 
proved to be an important factor that correlated with tumor malignancy. Angiogenesis is widely accepted as a 
process for the growth of cancers. In this project, high-definition flow (HDF) power Doppler ultrasound (US) 
is performed to investigate blood flow and solid directional flow information in breast tumors. The 
vascularization of tumor would be used as a factor to estimate the effect of the neo-adjuvant chemotherapy 
prior to surgery. This project aims to evaluate vascularity changes in three-dimensional (3D) HDF power 
Doppler ultrasound images during neo-adjuvant chemotherapy of breast cancer in patients. The proposed 
method utilizes 3D Gaussian lowpass filter to reduce the noise and speckles and applies a 3D thinning 
algorithm for extracting vascularity centerlines. The color of voxel within the HDF Doppler sonography 
indicates the direction information of blood flow in the vascular centre-line. In this project, six vascularity 
quantization features, three morphological features and two vascular direction features are extracted for 
evaluate the correlation between the vascularity changes and neo-adjuvant chemotherapy effect. 
 
Keywords: Breast tumor, tumor vascularization, Angiogenesis, Neo-adjuvant chemotherapy, HDF power 
Doppler ultrasound, 3D thinning 
  -4-
approach as such to various image processing problems. Mathematical morphology has already been widely 
used in image processing and provides two basic operations, i.e. dilation and erosion. This project utilized 3D 
binary mathematical morphology to enhance the 3D HDF Doppler ultrasound imaging. The morphological 
operators are derived from two-dimensional (2D) binary mathematical morphology.  
 
 
Figure 1. Flowchart of the proposed scheme 
 
The thinning methods attempt to obtain a centerline by iteratively removing points, which fit at least one 
of a sequence of structure elements, from the boundary of an object in images. The thinning operator set out to 
from the object’s boundary and continues inward until no more simple points can be removed. This project 
utilized a parallel 3D 6-subiteration thinning algorithm [6] to thin the 3D HDF Doppler ultrasound imaging. 
The detailed descriptions about the 3D 6-subiteration thinning are given in following section. 
 
3. Materials and Methods 
Data Acquisition  
Patients and chemotherapy 
Patients were recruited into this study consecutively from July 2007 to Oct 2010. Thirty two consecutive 
  -6-
average filter which based on Gaussian function (which also expresses the normal distribution in statistics) for 
calculating the weighted from the voxels in the mask. The output value of each voxel was generated by its 
connection neighborhoods. Then a thresholding procedure was performed to convert the HDF Doppler signals 
into a binary vascular image.  
 
Figure 2. The tumor contour that manually sketched with 30o by experienced physician 
 
Figure 3. (a) B-mode (tumor intensity) channel; (b) blood vessels intensity channel; (c) the direction of blood 
flow channel; (d) the composed image by using 4D View (slice number 120 of case#13 at period N0) 
 
The binary vascular imaging always contained some cavities on the surface or within the vessels by noise, 
and some disconnected parts which only one or two voxels between each other (These disconnected regions 
may a connection blood vessel that only be masked by shadow). The noises and disconnected parts would 
cause the following 3D blood vessel thinning to generate error skeletons. The proposed method utilized a 
(a)                                 (b) 
(c)                                 (d) 
  -8-
Moreover, the color of voxel in 3D HDF power Doppler ultrasound imaging represented the direction 
(0-127 represented that the blood flow moved toward the probe and 129-255 represented that the blood flow 
moved away the probe) and the intensity represented the speed of blood flow (values of the intensity father 
away 128 represented the faster speed). Thus the direction information of blood flow would annotate to each 
point in the vascularity.  
 
3D Vascular Centre-lines Extraction 
Several methods have been proposed for extracting centerline form 3D objects, such as skeletons [11], 
Potential Field [12], and thinning operators [6,13,14]. The 3D thinning operators attempt to produce a 
centerline by iteratively removing simple points from the boundary of an object. A simple point is an object 
point which can be removed without changing the topology of the object. The thinning operator set out to 
from the object’s boundary and continues inward until no more simple points can be removed. The vessel 
centerline of the 3D vascularity object will be obtained after 3D thinning operator. 
This project utilized the parallel 3D 6-subiteration thinning algorithm proposed by Palagyi et al. [6] to 
thin the noise-reduced 3D HDF Doppler ultrasound images. The advantages of the thinning algorithm are that 
can achieve excellent efficiency and implement easily. By the algorithm the voxel with value 1 is denoted the 
black point, and the voxel with value 0 is denoted the white point. The algorithm defined a new value of each 
black points depends on its 3×3×3 neighborhoods. The deletion condition assigned to a subiteration is 
described by a set of masks or matching templates. A black point is to be deleted if and only if its 3×3×3 
neighborhood matches at least one element of the given set of masks. The 3D 6-subiteration thinning 
algorithm produces either curve skeletons or surface skeletons from 3D binary objects in (26, 6)-connectivity 
by repetitive iterations until no more points need to be removed. In this project, the algorithm directly 
extracted vascular centre-lines from elongated 3D binary objects and provided good results and preserved 
topology. After the thinning algorithm, we deleted the skeleton blood vessels that contained less than four 
voxels. Figure 5 shows the result of vascular centre-line extraction in a 3D HDF Doppler imaging. 
 
Vascular feature extraction 
Six vascularity quantization features, three morphological features and two vascular direction features 
are extracted for evaluate the correlation between the vascularity changes and neo-adjuvant chemotherapy 
effect. 
Vascularity Quantization features 
To quantify the HDF Doppler signal, three indices were evaluated from 3-D power Doppler ultrasound. 
Vascularization index[15,16] denoted VI, the ratio between the color voxels (with power Doppler signal). Let S 
denoted the set of all slices in a 3-D power Doppler ultrasound imaging, the VI is defined as 
∑
∑
∈
∈=
Ss
Ss
sN
sP
VI
)(
)(
,                             (1) 
where P(s) is the number of voxels with power Doppler signal and N(s) is the number of total voxels in the 
specific area of the slice s. Flow index (denoted FI), the mean energy per color voxel, represents the average 
  -10-
connection in the (26, 6)-connectivity was regarded as a branching point j; j = 1 when 2)( =iAdj ; otherwise, 
j = 0. The value of )(iAdj  is the total number of the points in )(iAdj . The NB is defined as the number of 
connect region at j = 1. The shortest distance between vessels and the center of tumor (denoted SDVC) was the 
shortest distance between the vascular centerline and the barycenter of tumor. The SDVC is defined as: 
min( (Xi-x)2 + (Yi-y)2 + (Zi-z)2 ),                             (5) 
where (x, y, z) was the coordinate of barycenter and imCi∈∀  (Xi, Yi, Zi) was the coordinate of point i. The total 
number of tree (denoted NT) was the number of vascularity centerlines in Cm. A connecting region in Cm was 
regarded as a vascularity centerline. 
Vascular direction features  
 In a vascular direction channel, the value 128 is represented the back ground or the direction that 
perpendicular to the probe, value 1 to 127 represented the speed of flow away the probe and value 129 to 255 
represented the speed of flow close to the probe. All the flow direction values in the xy slice were made from 
the intensity histogram statistics (range 1-255). This project calculated the value of histogram to extract 
vascular direction feature [5]. 
 Let z is a random variable indicating intensity, p(z) is the histogram of the intensity levels in a specific 
region. The mean intensity μ is shown as  
∑
=
=
L
i
ii zpz
1
)(μ  ,                                     (6) 
and the standard deviation DE in the image channel is defined as 
   
∑
=
−=
L
i
ii zpzDE
1
2 )()( μ  .                               (7) 
Finally the entropy EN is a measure of disorder (the higher the entropy, the higher the disorder) for vascular 
direction. EN is defined as 
)(log)( 2
1
i
L
i
i zpzpEN ∑
=
−=  .                              (8) 
 
4. Result 
RECIST Definitions of Tumor Response 
The chemotherapy treatment effect of the 32 patients was evaluated by the clinical tumor response. The 
clinical tumor response was classified as complete response (CR), partial response (PR), stable disease (SD) 
or progressive disease (PD)[17] described as followed: 
z Complete response (CR) is defined as the disappearance of all target lesions. 
z Partial response (PR) is defined as a ≥ 30% decrease in the sum of the longest dimensions of the target 
lesions taking as a reference the baseline sum longest dimensions. 
  -12-
Table 1. The RECIST results of the patients 
Patient case # Tumor Size(CM) Ratio  
 D1 D2 D3 Pathology decrease RECIST 
1 4.71 3.01 3.67 2.7 42% PR 
2 3.4 2.25 2.74 2.1 38% PR 
3 2.7 2.16 3.16 2.5 7% SD 
4 2.96 1.46 2.92 0 1 CR 
5 2.03 1.41 2.17 2.5 -23% PD 
6 3.9 2.9 4.12 0 100% CR 
7 4.67 1.62 3.84 4 14% SD 
8 4.81 2.19 3.3 0.5 90% PR 
9 4.15 1.64 2.6 4.7 -13% SD 
10 3.08 1.64 2.46 0 100% CR 
11 4.11 2.81 3.37 0.6 85% PR 
12 4.23 1.5 3 1.2 72% PR 
13 2.53 1.56 3.02 1.8 40% PR 
14 4.72 2.92 3.79 2.5 47% PR 
15 4.29 3.42 3.72 3.2 25% SD 
16 3.63 1.72 2.94 1.1 70% PR 
17 3.24 2.56 3.49 0.2 94% PR 
18 3.7 1.71 3.05 2.5 32% PR 
19 1.68 1.6 1.65 0.6 64% PR 
20 2.38 2.44 3.54 4.9 -105% PD 
21 4.03 2.07 3.17 0 100% CR 
22 2.35 2.09 2.55 2.5 -6% SD 
23 2.03 0.99 2.95 2.5 -23% PD 
24 2.85 1.52 2.77 0.8 72% PR 
25 1.9 1.97 1.77 1.5 21% SD 
26 4.12 2.49 2.07 0.8 81% PR 
27 1.41 1.27 1.71 0 100% CR 
28 2.43 1.47 2.29 0 100% CR 
29 2.53 1.24 2.31 0 100% CR 
30 2.67 1.28 1.9 0.2 93% PR 
31 2.61 1.93 1.93 1.5 43% PR 
32 2.82 2.21 3.01 0 100% CR 
Responder: 23 
Nonresponder: 9 
Total: 32 
*The tumor size includes the length of tumors before chemotherapy (D1, D2 and D3) and the pathology length after chemotherapy. 
The clinical tumor response was classified as CR, PR, SD and PD. Patients were classified into two groups: the responder, which 
was classified as CR or PR, and the nonresponder, which was classified as SD or PD. 
 
5. Discussion and Conclusion 
Over the last decade, the use of neo-adjuvant chemotherapy has emerged as the standard of medical care 
  -14-
treatments. Early prediction using the 3D HDF power Doppler ultrasound could diminish the unnecessary 
chemotherapy treatments for the patient whose poor response to certain chemotherapy strategies. Thus, it is 
suggested more cases and more features in the future will be helpful to increase prediction accuracy. 
 
  
Figure 6. The result of ROC curves 
 
6. 計畫成果自評 
原計畫之構想為發展穩定可靠的三維立體都卜勒超音波乳癌電腦輔助診斷系統，期
程原以二年為限，研究目標為第一階段(第一年)之進行收集數位三維高解析血流都卜勒
超音波影像病例，完成影像資料庫的程序，進行三維都卜勒立體乳房超音波影像特性分
析，建構量化腫瘤血流與血管特徵，並建立自動化三維 B-mode 影像腫瘤輪廓描繪模組；
第二階段(第二年)之整合三維立體超音波影像的腫瘤紋路、形態學特徵，評估並整合有
效診斷腫瘤之超音波影像特徵，發展穩定可靠的三維立體都卜勒超音波乳癌電腦輔助診
斷系統。但由於本計畫核定時縮減為一年期之研究計畫，因此將研究目標設定為利用高
解析血流都卜勒超音波技術，進行血管新生現象的研究，透過腫瘤周圍的血流資訊所構
建出的三維血管模型，來計算化療前後的血管特徵，並利用這些特徵在早期的療程之後
就能預測化療最終的成效。本計畫中利用血流資訊的量化特徵、形態學特徵和血流方向
統計量，比較各個階段的化療階段變化，所得之實驗結果與數據已達成計畫之預期目
標。本計畫之研究成果在惡性腫瘤血管新生理論上有相當的重要性，因此同時具備學術
上與應用上的價值，已著手整理準備於學術期刊發表，並延續此一研究成果於下一年度
之研究計畫 (乳癌前置化療之高解析血流都卜勒超音波影像評估系統研究 , NSC 
100-2221-E-029-001)，希望在這個研究領域能有更大的貢獻。 
  -16-
 [17]  M.J. Byrne and A.K. Nowak, "Modified RECIST criteria for assessment of response in malignant 
pleural mesothelioma," Annals of Oncology, vol. 15, no. 2, pp. 257-260, Feb. 2004. 
 [18]  J.A. Hanley and B.J. McNeil, "The meaning and use of the area under a receiver operating 
characteristic (ROC) curve," Radiology, vol. 143, no. 1, pp. 29-36, Apr. 1982. 
 [19]  J.A. Hanley, "Receiver operating characteristic (ROC) methodology: the state of the art," Crit Rev. 
Diagn. Imaging, vol. 29, no. 3, pp. 307-335, 1989. 
 [20]  E.P. Mamounas, "Overview of National Surgical Adjuvant Breast Project neoadjuvant chemotherapy 
studies," Semin. Oncol., vol. 25, no. 2 Suppl 3, pp. 31-35, Apr. 1998. 
 [21]  P.C. Clahsen, C.J. van de Velde, J.P. Julien, J.L. Floiras, T. Delozier, F.Y. Mignolet et al., "Improved 
local control and disease-free survival after perioperative chemotherapy for early-stage breast cancer. 
A European Organization for Research and Treatment of Cancer Breast Cancer Cooperative Group 
Study," J. Clin. Oncol., vol. 14, no. 3, pp. 745-753, Mar. 1996. 
 
 
 -2-
一、 參加會議經過 
國際電腦輔助放射醫學會議（Computer Assisted Radiology and 
Surgery International Congress, CARS）每年皆有一個定期的年會，是目
前針對電腦輔助診斷大型的國際會議之一， 2011 年 CARS 包含 25th 
International Congress and Exhibition on Computer Assisted Radiology, 
15th Annual Conference of the International Society for Computer Aided 
Surgery, 29th International EuroPACS Meeting, 13th International 
Workshop on Computer-Aided Diagnosis, 17th Computed Maxillofacial 
Imaging Congress, 12th CARS / SPIE / EuroPACS Joint Workshop on 
Surgical PACS and the Digital Operating Room, 3rd EPMA / IFCARS 
Workshop on Personalized Medicine and ICT，此會議結合所有關於電腦
輔助放射醫學領域的研究者聚集一堂 ，針對當年度最新發展或研究做
研討，會議主題包括: 
1. Medical Imaging 
2. Computed Maxillofacial Imaging 
3. Image Processing and Visualization 
4. PACS and IHE 
5. Telemedicine and E-Health 
6. Computer Aided Diagnosis 
7. Computer Assisted Radiation Therapy 
8. Image and Model Guided Therapy 
9. Personalized Medicine 
10. Surgical Navigation 
11. Surgical Robotics and Instrumentation 
 -4-
  
圖二、2011 CARS 國際會議地點-柏林 Estrel Hotel 
6月 22日至 CARS2011會場報到(圖三)後的會議是由 Tutorial on 
Medical Workstations and Model-guided Medicine的專題課程開始，由
來自 Univ. of Chicago Medical Center的 Michael W. Vannier主講，專
題課程之後才開始小部份論文之發表與討論，直到下午。其中有個
Session: Medical Robotics, Instrumentation, and Modelling有部份研究
相當有趣，如由 The Univ. of British Columbia, Vancouver 的 T. Adebar 
等學者報告題目為 A robotic system for intra-operative trans-rectal 
ultrasound and ultrasound elastography in radical prostatectomy與來自
Univ. Pittsburgh 的 G. Stetten 等學者報告題目為 Hand-held force 
magnier for surgical instruments，皆相當出色，在展示區與其相關展示
設備如圖四。 
 -6-
Invited Speech，今年邀請的是 Max Planck Institute of Molecular 
Genetics, Berlin 的 Professor Hans Lehrach 主講“Genomics, patient 
modelling and IT”，如圖五所示。  
 
圖四、Invited Speech之場景 
6月 23日至 25日三日有各領域論文的發表，整個會議分成五個大
型演講廳同時進行，我選取較興趣的 Computer Assisted Radiology與
Computer-Aided Diagnosis的主題聆聽，早上張貼好論文海報後(圖六)
便仔細於會議海報展示區(圖七)觀看，並且聆聽更多議程之論文發表
與討論，主題有 Special Session on Breast CAD – BCAD與 Special 
Session on Breast and Thoracic CAD –BTCAD，令人印象深刻的有: 
 -8-
 
圖六、筆者論文海報張貼之情形 
  
圖七、CARS2011會議海報展示區   
在與會期間，我選擇有興趣的研究論文題目聆聽，其餘時間便於
會議 Poster區域與其它與會學者討論，發現許多內容與品質皆佳的研
究，如圖九。今我感覺受益良多，回國後要好好將其相關資料進行研
讀，可能對未來的研究有所影響。 
 -10-
二、與會心得 
參與國際會議的過程不管是聆聽論文報告或是與其它學者討
論，讓我受益良多。許多創新電腦輔助放射醫學的研究結果啟發了我
對於醫學相關領域未來的方向，建議國內相關單位的研究人才應踴躍
參與此類型的學術活動，提昇台灣在電腦醫學研究的能見度，而且台
灣的醫學與醫療水準相當高，也有不錯的成就。也希望台灣政府應鼓
勵國內的學校及學術機構大力爭取舉辦類似的大型國際性會議，並鼓
勵老師、學生多多參與類似的大型國際性會議，經由與會的經驗來了
解先進資訊技術的脈動，進而開拓更寬闊的視野，以期產生更高水準
的研究及成果，並提昇國家的醫療科技產業的競爭力。 

國科會補助計畫衍生研發成果推廣資料表
日期:2011/08/22
國科會補助計畫
計畫名稱: 高解析血流都卜勒超音波影像乳房腫瘤血管新生電腦輔助評估研究
計畫主持人: 黃育仁
計畫編號: 99-2221-E-029-031- 學門領域: 影像處理
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
本計畫之研究成果在惡性腫瘤血管新生理論上有相當的重要性，因此同時具備
學術上與應用上的價值，已著手整理準備於學術期刊發表，並延續此一研究成
果於下一年度之研究計畫(乳癌前置化療之高解析血流都卜勒超音波影像評估
系統研究, NSC 100-2221-E-029-001)，希望在這個研究領域能有更大的貢獻。
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
