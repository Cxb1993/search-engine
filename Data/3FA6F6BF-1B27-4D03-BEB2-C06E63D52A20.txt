 1
基於曲折繞接線變壓器及特定諧波消除之三階層反流器削減諧波 
Harmonic Reduction for Three-Level Inverter based on zig-zag Connected  
Transformer and Selective Harmonic Elimination 
 
計畫編號： NSC 94 – 2218 - E011 – 015 
執行時間： 94 年 8 月 1 日至 95 年 7 月 3 1日 
計畫主持人：    楊宗銘                        
計畫參與人員：  巫昇峰 
執行單位： 國立台灣科技大學電機工程系 
 
摘要 
    本文主要利用曲折繞接線輸出變壓器
(zig-zag transformer)及選擇諧波消除脈波寬度
調變(selective harmonics elimination PWM, she 
PWM)來控制三階層反流器系統。因輸出變壓
器之特性，其脈波寬度調變波形被設計成四分
之ㄧ對稱波形，該波形利用牛頓-瑞福森法
(Newton-Raphson method)求開關之切換角度
精確解曲線，再將曲線利用最小平方差法
(least squares solutions)來獲得曲線近似方程
式。由於曲線的近似使得處理器可做即時運算
來控制基本波大小及改變系統頻率。最後，本
文將實驗證明該系統。 
關鍵字: 選擇諧波消除、三階層反流器、牛頓
-瑞福森法、最小平方差法 
  
Abstract 
  This paper applies the zig-zag transformer and 
the selective harmonics elimination PWM (she 
PWM) scheme to control a three-level inverters 
system. The PWM is designed to a quarter 
symmetry wave due the transformer’s 
characteristics. The wave applies the 
Newton-Raphson method to solve the exact 
curves, and then used the least squares solutions 
to obtain curve fitting equations. Due to the 
curve fitting enable the digital signal processor 
to make operation to control the fundamental 
value and change systematic frequency 
immediately. Finally, Experimental results 
confirm the system. 
 
Key words: selective harmonics elimination, 
three-level inverters, newton-raphson method, 
least squares solutions. 
一、前言 
     目前運用靜態式反流器 (Static inverter, 
SIV)之電力電子裝置及連接輸出變壓器曲折
繞接線[1]來獲得一多階層電壓以供應交通工
具的電源已有一段時間，但由於所有的關鍵技
術、動力車輛、設備裝置及維修規範均掌握於
少數幾家供應廠商手中，也因如此，台灣在維
修與保養上無法有效的累積經驗以及更進一
步的來加以改良。 
    而目前該交通工具所用的靜態式反流器
脈波寬度調變策略，在輸出變壓器的輸出端電
壓波形中，其諧波分量佔較大的分別為基本波
的第十一、十三次諧波，而第十一次諧波也是
該系統輸出變壓器輸出端的最低次電壓諧
波，故輸出變壓器之輸出端之後所要接的濾波
器，因為需獲得較好的基本波電壓波形，使得
濾波器元件本身的體積相對比較大。此外，該
電源設備利用的反流器架構為兩組傳統二階
層反流器，該反流器為利用六個功率開關，其
在輸出諧波含量以及耐壓上皆比多階層反流
器(multilevel inverter)大。 
    基於上述本文提出利用兩組三階層反流
器[2]，該架構利用了比傳統二階層多一倍的
功率開關作為電力轉換，因為階層的增加，使
得反流器輸出電壓的諧波含量減少，再利用三
階層反流器配合原本使用的輸出變壓器。該輸
出變壓器具有抵消基本波的第三、五及七次…
等相關之奇次諧波，針對此變壓器特性設計一
半波奇對稱之波形，其利用脈波寬度調變的技
巧來控制基本波大小以及選擇消除特定諧波
[3]-[5]，以消除原系統中原本存在的最低次諧
表一 三階層反流器電路中相電壓及開關狀態之關係 
單相開關狀態 輸出電壓 
xGv  
1
 
xS 2xS  3  xS 4xS  
dcV2
1  1 1 0 0 
0 0 1 1 0 
dcV2
1−  0 0 1 1 
 3
1Ux = , ,W  1V 1
 
三、脈寬調變策略 
    任何週期性波形皆可由(6)之傅立葉級數
所合成， 
{∑∞
=
++=
1
0 )sin()cos(2
1)(
h
hh thbthaatf ωω } 
 (6) 
∫= π ωωπ
2
0
)()cos()(1 tdthtfa h   ,…,0=h ∞   
 (7) 
∫=
π
ωωπ
2
0
)()sin()(1 tdthtfbh   ,…,1=h ∞  
 (8) 
∫= π ωπ
2
0
0 )()(2
1
2
1 tdtfa  (9) 
其中
02
1 a 為波形的平均值， 為 的諧波含
量 
h )(tf
，即 為該波形之基本波分量。 1=h
     由輸出變壓器之特性，本文設定一多階反
流器開關觸發波形，如圖四所示。 
 
 
圖四 半波且奇對稱波形圖 
 
     圖四為ㄧ半波奇對稱之波形，該波形即為
開關觸發訊號波形亦是圖三中三階層反流器
輸出對G 點電壓波形，V 為直流電壓值，而
1α 、 2α 及 3α 為三個自由角度，其三個自由角
度變化可改變基本波大小以及消除兩個特定
諧波數，進而改善。而圖四中 )( tf ω 由(6)、(7)、
(8)和(9)之傅立葉分析可得(10) 
     (10) ∑∞
=
=
1
)sin()(
h
h thbtf ωω
而 ∫= 2/
0
)()sin()(4
π
ωωωπ tdthtfbh   ,…,1=h ∞  
  (11) 
hbV
hhh
4
)cos()cos()cos( 321
πααα =+−  
1=h ,…,∞  奇數  (12) 
     該非線性方程式(11)中，本文將帶入圖四
內可得到(12)，其中令 it αω = ， i =1,2,3， 僅
含奇次諧波數。且由於該波形有三個自由角度
變數，故三個變數則需三個方程式，令其一方
程式為控制基本波大小，剩下二方程式為消除
特定諧波之諧波數。由於輸出變壓器已將第
三、五、七及九次諧波消除，令消除特定諧波
數分別為 =11、13 之諧波等於零，且限制
h
h
23
πα <21 αα << 。基於上述可得到三個非線性
方程式，為了求解出三個自由角度解，本文利
用數值分析中的牛頓-瑞福森法來求解非線性
聯立方程式。 
 
四、數值分析 
    本文利用牛頓-瑞福森法並且利用Matlab
程式軟體寫程式，其利用(13)來求得角度之聯
立方程式。 
 
     (13) )())(( 1'1 ppp FF αααα −+ −=
其中 p 表疊代次數， F 為(12)之聯立方程式矩
陣， [ ]T321 αααα = 矩陣。本文將基本波設定
為 1且第十一、十三次諧波設為 0，經求解後
我們可得到α 之角度解。由基本波大小為 1(標
么化)時所求解出之α 角度作為起點，將α 角
度當初值並微調基本波大小，進而可得到另一
α 角度解，重複上述動作，微調基本波大小範
圍由 0-1.24 所得之所有角度，將所有得到的資
料整理後，即可得到三條曲線之曲線圖，該曲
線圖如圖五所示，α 角度隨著基本波的變動而
變動。 
表四 3α 角度隨基本波值變化之方程式表 
基本波大
小 
(標么化) 
3α 角度對應方程式 
0-0.3 892.8913.18674.28)(3 2 +−−= aaad  
0.3-0.4 517.82637.4728.167)(3 2 ++−= aaad  
0.4-0.6 844.91008.47195.10)(3 2 +−= aaad  
0.6-0.7 554.2852.17527.185)(3 2 ++−= aaad
0.7-0.8 04.18586.28875.158)(3 2 +−= aaad  
0.8-0.9 947.082.17305.132)(3 2 ++−= aaad  
0.9-1.0 35.202245777.84)(3 2 +−= aaad  
1.0-1.1 929.4741.2283.138)(3 2 −+−= aaad  
1.1-1.16 05.29573.71237.374)(3 2 −+−= aaad  
1.16-1.24 35.105835.4725.16)(3 2 +−−= aaad  
 5
註: a 為自變數基本波值, 為應變數角度值 3d
 
     
 
圖六 1α 曲線之角度最大誤差圖 
 
 
圖七 2α 曲線之角度最大誤差圖 
 
圖八 3α 曲線之角度最大誤差圖 
    由表二、表三及表四之近似曲線方程式與
圖五精確曲線的誤差分別為圖六、圖七及圖
八，其圖中顯示的皆為各曲線最大誤差區段，
而曲線之最大誤差不超過開關週期的 0.25 度
左右，本文將上述各表格方程式寫入數位訊號
處理器中利用基本波值來判斷開關切換控制。 
   
六、實作結果 
     本文依據圖二之系統架構並且在濾波器
輸出端回授電壓經整流訊號處理在其利用數
位處理器做類比轉數位之處理，利用處理器為
核心控制其 24 顆開關切換時間，使得改變輸
出電壓及系統頻率，其輸入直流電壓值為 147
伏特，在系統頻率為 60Hz 時，其開關角度之
間隔約為 0.07 度。 
    圖九為原電源設備系統之輸出變壓器輸
出端電壓(電壓衰減 20 倍)波形圖，其第十一
次諧波量佔基本波量約為 22%，其次為第十三
次諧波量佔基本波量約為 31.3%，總諧波失真
約為 31.5%。 
    圖十為基本波分量為 1 時量測三階層反
流器之實際相電壓波形圖，圖十一則為圖十波
形的的諧波分析，由圖十一中可看出第十一次
及第十三次諧波接近於 0。 
    圖十二為本文利用特定諧波消除脈波寬
度調變技巧且基本波為 1(電壓為 440 伏特)時
所得到的輸出變壓器輸出端電壓波形圖，其波
形為一多階層之電壓輸出波形。 
    圖十三中的立體圖是利用 Matlab 軟體分
析基本波大小範圍為 0.8-1.24 之實際量測諧
波立體圖，即圖十二之整合圖。由立體圖看出
除基本波外最低次諧波即為第二十三次諧
波，且諧波量隨著基本波大小變化而呈現一波
浪形狀。 
    圖十四為圖十三的總諧波失真曲線圖，可
看出其失真度皆低於 22%，皆低於原系統的
31.5%。 
    圖十五為開迴路系統濾波器輸出端電壓
波形圖，其濾波器為三角接電感值約 ，
電容值為
mH5.1
Fμ80 ，該波形總諧波失真約為 0.6%。 
    圖十六為輸出負載瞬間加入系統之電壓
波形圖，其變動時間約為 1 秒，圖十七為輸出
負載瞬間加入系統之電壓波形圖，其變動時間
約為不到 1 秒。 
    圖十八為控制系統頻率由 60Hz 改變至
120Hz 之暫態圖，量測變壓器輸出端。圖十九
 
(a) 
 
(b) 
 
 
(c) 
 
(d) 
 
 
圖十七 負載瞬間切離系統之電壓波形圖 
 
 
圖二十一 改變基本波之電壓空間狀態向量變化圖. (a) 
         基本波為 0.1 時之空間向量變化圖. (b)基本 
         波為 0.5 時之空間向量變化圖. (c)基本波為 
         1.0 時之空間向量變化圖. (d)基本波為 1.09 圖十八 系統頻率由 60Hz 變化至 120Hz 之波形暫態圖          時之空間向量變化圖.  
 
 
七、狀態向量分析 
    本文利用選擇諧波消除脈波寬度調變來
控制其波形，由於開關狀態波形為週期性變
化，故本文將其中一三相反流器三相開關狀態
所示。圖二十為三階層電壓空間向量圖，其中
SNjSPjMjLj VVVV =>> ， ， 且62,1 L=j
0321 === zerozerozero VVV ，而不同的基本波相對的
切換角度也會不同，使得三相開關狀態也會改
變，如圖二十一所示。可發現狀態的變化是隨
著基本波的加大而空間狀態所呈現的變化也
是漸往外圍擴散的變化，在附錄中本文將其整
理成表。 
圖十九 系統頻率由 60Hz 變化至 40Hz 之波形暫態圖 
 
 
 
八、結論 
   本文之系統利用數位信號處理器為主要控
制核心，完成實體架構及軟體程式。因為曲線
的近似化，使得在軟體程式中控制其基本波的
份量較細、也較準確。並證實且完成了在閉迴
路電路中，可控制其基本波大小、系統頻率的
變化(目前範圍為 40Hz ~120Hz)以及負載變動
之輸出電壓穩定。
圖二十 三階層電壓空間向量圖 
 7
