 2
行政院國家科學委員會專題研究計畫成果報告 
 
建構可動態管理、編修之產品虛擬原型之研究（3/3） 
Dynamically managed and edited virtual prototype for 
production design 
 
計 畫 編 號：NSC 95-2221-E-155-003-MY3 
執 行 期 限：97 年 8 月 1 日至 98 年 7 月 31 日 
主 持 人：孫天龍   元智大學工業工程與管理系（所） 
共同主持人： 
計畫參與人員：鍾珮元、洪達民、謝沛修、陳立凡/元智大學工業工程與
管理所 
 
 
一、中文摘要 
 
台灣產業近年來逐漸從 OEM 經營模式轉
型升級到 ODM 甚至 OBM 經營模式，產
品設計對台灣的企業越來越重要，而以人
為本的考量是產品設計中很重要的一環，
產品設計時除了考量功能外觀外，更需考
量使用者操作之安全、便利與效率。近年
來，隨著 3D 數位內容軟硬體技術逐漸成
熟，使用數位化的虛擬原型來進行產品設
計之人因評估亦逐漸變得可行。過去已有
許多學者探討使用含人模的虛擬場景輔助
產品設計之人因評估、工業安全、績效評
估等。過去學者發展的虛擬人因評估系統
雖然功能強大，但價格昂貴、操作複雜、
學習困難，而且虛擬人模只能與場景物件
簡單互動，無法進行進階互動如抓取等。
因此目前的虛擬人因評估軟體只有大企業
能負擔，對中小企業而言，由於預算有限，
同時又希望能客製化設計虛擬場景，因此
雖然知道 3D 虛擬技術的好處，但往往心
有餘而力不足。為解決此一問題，本計畫
以三年時間，整合現有的商業 3D 軟體發
展一低成本 (low-cost)與可彈性客製化
(flexible customization)的 3D 虛擬人因評
估環境，本計畫前兩年與中科院產品設計
部門與人因工安部門合作，探討產品原型
在設計研發流程中扮演的角色，同時研究
與整合建構虛擬原型所需之 VR 軟硬體技
術。第三年我們以派翠網發展高階互動設
定介面，協助人因專家快速設定互動虛擬
場景，針對場景物件互動姿勢擷取的控制
邏輯以兩類型的派翠網表示，第一種類型
的派翠網表示每物件的互動擷取姿勢邏
輯；第二類型的派翠網表示與監控雙手或
單手是否正確碰到物件的狀態並且抓取或
放開物件。藉由這兩類型的派翠網設計一
參數設定界面，讓領域專家可自行修改參
數，包含選擇雙手或單手抓取、運動限制
式、擷取頻率、擷取目標、接觸點的座標
與範圍等，讓非 VR 的領域專家能夠輕易
的改變互動設計。 
關鍵詞：產品虛擬原型、產品設計、人因
評估 
 
Abstract 
 
Virtual design ergonomic evaluation is 
useful at early design stage where the 
physical design mock up is not available but 
human-centered design must be considered. 
The interactive virtual ergonomics 
evaluation approach integrates a digital 
human model (DHM) with a product’s 
digital mock up to form a DHM-included 
virtual environment (VE). The DHM is 
interactively puppeteered by a human player 
who wears motion capture devices. Posture 
 4
為解決此一問題，本計畫以三年時間，整
合現有的商業 3D 軟體發展一低成本
(low-cost) 與 可 彈 性 客 製 化 (flexible 
customization)的 3D 虛擬人因評估環境，
本計畫前兩年與中科院產品設計部門與人
因工安部門合作，探討產品原型在設計研
發流程中扮演的角色，研究建構虛擬原型
所需之 VR 軟硬體技術。第三年我們持續
與中科院合作，以派翠網發展高階介面，
協助人因專家快速設定互動虛擬場景。 
 
三、文獻探討 
 
3.1.  虛擬人因評估之研究 
 
Rajan 等人(1999)結合虛擬實境與人因評
估的技術，發展一套元件組立與夾具設計
之人因評估系統，並應用於航空工業，評
估作業姿勢與作業流程的可行性。
Chryssolouris 等人(2000)認為過往使用的
人體模型（mannequin）之人因評估軟體無
法提供有效且精確的人體模擬動作，既無
法模仿人類直覺的自然動作，又不能在組
裝過程中隨意地進行組件安裝，作者因此
提出一操作人員與虛擬場景互動並結合人
因評估的方法，以有效進行生產線產品組
裝效率評估與人因評估。Chedmail 等人
(2003) 利 用 黑 板 架 構 （ Blackboard 
architecture）發展了一種分散式的方法來
解決人模在虛擬環境中可見性(Visibility)
與可及性(Access)的問題。Duffy 等人(2003)
發展一套線上設施規劃系統 IVLS(Internet 
virtual facility layout system)，結合心理物
理學(Psychophysical)方法，探討受測者在
虛擬環境中的感知與虛擬環境提供的刺激
（如聲音、光線、設施規劃方式以及自動
化設施運轉速率等因素）之間量化的關
係，並比較受測者在虛擬環境與現實環境
中進行實驗的差異。Reuding 與 Meil
（2004）建立一套汽車內裝虛擬場景（不
含方向盤與座椅），以真人進行測試，欲比
較人在虛擬原型與實體原型中進行人因評
估的差異。Chu 與 Kuo (2005)建構一透過
網際網路之汽車內裝客製化與人因評估平
台，讓在遠端的使用者能憑藉著網際網路
的便利性與 CAD 的視覺效果呈現，在實
體汽車尚未量產前即可參與汽車內裝構造
設計，結合生物力學模型，針對終端使用
者所做的選項進行靜態人因評估，即在使
用者保持固定姿勢下，計算各關節點的壓
力與受力，以利使用者進一步了解自身進
入客製化車內後之空間佈局。Zülch 與
Grieger（2005）發展一套數位工廠模組
ADAMO，希望在此數位工廠中，以宏觀
的人因方法（Macro-ergonomic approach）
來預知並防止工業傷害的發生。Jayaram
等人(2006)發展兩套虛擬實境系統，希望
能在虛擬系統中連續且及時地進行量化的
人因評估，亦即當受測者仍在虛擬環境中
進行測試時即可進行人因評估，若受測者
在虛擬環境中之動作有違反人體工學的動
作發生時，系統可以即時發出緊告訊息，
避免當作業人員上線作業後發生某些不必
要的傷害。Kuo 和 Wang（2007）以動作
捕捉器捕捉頭戴顯示器使用者的動作即時
驅動人模，讓使用者模擬操作場景中的砲
彈發射車內部面板，以操作時人模關節的
參數做上肢人因評估，再根據評估結果對
需修改的內部設計做變更。 
 
3.2.  派翠網(Petri Net)介紹 
 
派翠網 (Murata, 1989)為一種有向網路
圖，此網路圖可用五種變數值組(5-tuple)
表示，即 PN={P, T, F, W, M0}，其中 P 為
一組有限的 Places 集合，即 P={p1, p2,…, 
pm}，T 為一組有限的 transitions 集合，即
T={t1, t2,…, tn}，F 為一組表示資料流程關
係的 Arcs 集合，即 F⊆ (P×T) (T×P)∪ ，W
表示 arc 的權重函數，即 W：F→{1, 2, 
3,…}，以 W(p, t) 表示 Place 節點連接至
Transition 節點之 Arc 權重，反之則以 W(t, 
p)表示，而 M0 表示一個 Petri Net 的初始
狀態。 
Place 與 Transition 為兩種不同的節點，
Place 代表不同的條件、資源以及儲存空
間；Transition 則為事件、處理程序或任
 6
人員即可穿著動作捕捉器來即時驅動數位
人模。操作人員藉由頭戴型顯示器觀看虛
擬場景並執行動作，此時人體姿勢由動作
捕捉器擷取後傳送至人因分析工具如
RULA、NIOSH 等進行分析以發現可能的
產品設計問題並加以更改。 
 
 
Figure 1. 互動虛擬人因評估 
 
4.2 虛擬人因評估場景建構 
 
虛擬人模建構 
 
虛擬人模包含動作驅動之骨架以及外貌模
型兩部份，骨架系統用於驅動人模動作，
外貌模型加在骨架上，讓人模看起來更真
實。本研究使用 3ds Max 軟體內建之骨骼
系統 Biped (Autodesk Inc., 2005)，Biped 人
模骨架如 Figure 2 所示。骨骼系統架設完
畢後還需在骨骼外層加上外貌模型，讓虛
擬人物更逼真，Figure 3 為我們建構的一
個簡單的海軍士兵外貌模型。 
 
虛擬人模與場景物件整合 
 
本研究以 Virtools 4.1 (Dassault systems, 
2008)商業虛擬實境軟體將虛擬人模與產
品數位原型整合在同一個虛擬場景中，如
Figure 4 為將虛擬人模與船艙控制室場景
整合之結果。 
 
以動作捕捉系統即時驅動虛擬人模 
 
本研究使用的動作捕捉器為 Moven 
inertial motion capture (Xsens Technologies 
B.V, 2009)，操作人員可利用 Moven 即時
驅動數位人模，此動作捕捉器以微型慣性
感應器(MTx)和無線 Xbus 系統為基礎，結
合符合生物力學限制的高效感應器，定義
一個具 22 個關節(joints)，共 23 個骨架
(segment)且符合生物力學的 3D 人物模
型，Moven 能即時捕捉人體全方位 6 個自
由度(6DOF)的慣性運動資料，包含位置、
速度、加速度、角度、角速度與角加速度
等資料，Moven 擷取的人體姿勢資料可以
及時傳送到 Virtools 驅動虛擬人模。Figure 
5 為穿著 Moven 動作捕捉器的操作者，虛
擬人模將會跟隨著此操作者移動。 
 
 
Figure 2. Biped 人模骨架 
 
 
Figure 3. 簡單的海軍士兵外貌模型 
 8
 
z
x
y
z
x
y
 
Figure 7 物件運動限制示意圖 
 
4.5 以派翠網控制互動之設計 
 
本研究以兩類型的派翠網表示與控制虛擬
人模抓取物件的互動過程，第一類型派翠
網為主要控制模型如 Figure 8 所示，表示
成 PN1，PN1 包含兩類 normal transition，
第一類為表示物件互動狀態的 place 間的
transition 節點，包含 t1、t4 與 t5，第二類
為物件互動狀態 place 與溝通 place 間的
transition 節點，包含 t2 與 t7，這些節點的
觸發條件細節見(鍾佩元 2009)。PN1 的 t3
與 t6 為 automatic transition 會自動觸發。 
 
Figure 8 控制物件互動與姿勢擷取之派翠
網 
當 PN1 被加到場景中某一物件來控制虛擬
人模抓取此物件之互動，在該物件尚未被
虛擬人模抓取前，token 會在 start place，
當該物件被虛擬人模以正確姿勢抓取後，
transition t1 會被觸發將 token 由 start 移到
grasped，此時該物件會成為虛擬人模手的
子物件，在限制式下隨者手動。 
當物件被抓取時其位移與旋轉量或系統模
擬時間達到 t2 設定之擷取頻率條件，即會
觸發 t2 讓 token 移至 place 節點 Record 輸
出一筆虛擬人模姿勢資料，當 token 進入
place 節點 Record 後 t3 會自動觸發，讓
token 回到 place 節點 Grasped，如此反覆
觸發 t2 直到物件態達到 t4 設定的最終擷取
條件，此時 t4 被觸發將 token 移至 place
節點 Finish，代表物件狀態為結束，停止
擷取姿勢。 
若 token 反覆觸發 place 節點 Grasped 的
時，手的姿勢錯誤，例如手放開物件，即
觸發 t5，物件會達到 Abnormal，由於 t6 為
自動觸發，token 會從 Abnormal 到達 place 
節點 WRecord，系統會提示姿勢錯誤訊
息，並且停止記錄姿勢資料，系統自動將
物件回到預設位置，並且觸發 t7，重新開
始姿勢擷取。 
第一類派翠網 PN1 中的 normal transition 
t1 與 t5 的觸發條件是由第二類派翠網控
制，第二類型派翠網可分為單手與雙手之
「抓取」與「未抓取」4 種，單手與雙手
之「抓取」派翠網用於 PN1 中的 normal 
transition t1 觸發條件，而單手與雙手之「未
抓取」派翠網用於 PN1 中的 normal 
transition t5 觸發條件。Figure 9 為控制雙
手「抓取」操作之第二類型派翠網，以 PNbg
表示，PNbg 之組成節點與 PNsg 類似，不
同之處在於將 place 節點 None 與 Touch，
分成左右兩手，而 place 節點 Grasp 為雙手
都要抓到，PNbg 的 place 節點定義及
transition 節 點 說 明 請 參 考 ( 鍾 佩 元 
2009)。其他第二類型的派翠網設計亦請參
考(鍾佩元 2009) 
 
 10
 
人因評估專家將以上參數設定完成後，設
定資料將會儲存於一文字檔(.txt)中，並且
將此文字檔傳到 Virtools 中變更這些資
料，如 Figure 13 所示，變更設計互動完
成後，即可開始讓操作者穿著動作捕捉器
與物件互動，並且擷取姿勢資料，細節及
應用範例請參考(鍾佩元 2009)。 
 
Figure 13  參數設定檔與 Vitools溝通範
例 
 
五、結果與討論 
 
過去學者發展的虛擬人因評估系統雖然功
能強大，但價格昂貴、操作複雜、學習困
難，而且虛擬人模只能與場景物件簡單互
動，無法進行進階互動如抓取等。因此只
有大企業能負擔，對中小企業而言，由於
預算有限，同時又希望能客製化設計虛擬
場景，因此雖然知道 3D 虛擬技術的好處，
但往往心有餘而力不足。 
 
本計畫以三年時間，整合現有的商業 3D
軟體發展一低成本(low-cost)與可彈性客
製化(flexible customization)的 3D 虛擬人
因評估系統，幫助台灣中小型企業在預算
有限的情狀下，建構互動 3D 虛擬場景進
行產品設計人因評估。 
 
本研究目前僅以手部碰到的時間長短作為
抓取的手部辨識，此部分未來需改善。另
外，本研究目前沒有考慮力回饋裝置，因
此無法考慮到負荷的問題，也會讓姿勢擷
取時會有一些問題，未來若有力回饋裝
置，可更確實的擷取到更豐富且完整的人
因資料。同時本研究目前只考慮手部的抓
取，未來可考慮更多身體部位與物件的互
動，例如腳踢、腳踩、手肘碰觸、頭頂等，
讓產品設計的人因評估可評估更多樣化的
操作動作。 
 
六、計畫成果自評 
1. 研究內容與原計畫相輔程度說明（如低於 50，請
將不符處說明於後） 
95 
2. 本研究達成預期目標概要（請從報告中指出其最
主要的項目，複選） 
創新之發現 ■實驗原型或系統之建立
■理論之推導或模式建立 ■人才培育 
■技術水準之提升 其他(請說明) 
新技術在國內之再現 未獲具體成果(請說明)
3. 本研究成果之學術參考價值 
極高 ■高 中 普通 低 
請列示應送參考機構名稱: 工業工程與管理、人因
工程、設計等相關研究單位 
4. 本研究成果之應用推薦價值： 
極高 ■高 中 普通 低 
如可能，請建議送交那些單位或業者參考：製造業
設計部門、人因部門等產業 
■可立即推薦  尚需進一步研究   不宜推薦
5. 本研究成果可申請專利項目之說明： 
可 發明 新型 新式樣 
不可，請說明： 
因本計畫之研究方法，屬產品設計模式建立及實例
驗證，並無適當專利可申請。 
6. 本研究成果發表之建議： 
否：機密性 成果層次尚須再加強 
■是，且刊載何種刊目為宜？ 
