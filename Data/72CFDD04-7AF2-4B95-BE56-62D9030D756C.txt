Non-repudiation Mechanism of Agent-based Mobile Payment
Systems: Perspectives on Wireless PKI
Abstract. Non-repudiation of a mobile payment transaction ensures that when a
buyer (B) sends some messages to a seller (S), neither B nor S can deny having
participated in this transaction. An evidence of a transaction is generated by wireless
PKI mechanism such that B and S cannot repudiate sending and receiving the
purchase order respectively. The broker generates a mobile agent for B which carries
encrypted purchase order to the seller. One trusted third party acts as a lightweight
notary for evidence generation. One advantage of this agent-based non-repudiation
protocol is to reduce inconvenience for mobile clients such as connection time; it
causes difficulty for fair transaction for mobile payments.
1. Introduction
The security has been a concerned issue for mobile payment for a long time. For example, dispute
of a transaction is a common problem that could jeopardize the mobile commerce [1]. The
purpose of non-repudiation is to collect, maintain, make available and validate irrefutable
evidence concerning a claimed event or action in order to resolve disputes on the occurrence or
non-occurrence of the event or action [2], [3]. However, in the real world situation, lots of mobile
stock brokerage services and mobile banks have already been promoted but without any
non-repudiation mechanisms.
Mobile applications need to be user-friendly and convenient for mobile clients via their
mobile handsets; this investigation leads to the research of agent-based mobile applications. The
digital signature-based authentication proves to be implemented efficiently within 3G
communications [4]. This can be regarded as a preliminary experiment for mobile agent-based
non-repudiation mechanism which also relied on digital signature mechanisms.
Non-repudiation services must ensure that when buyer B sends message to seller S over a
network, neither B nor S can deny having participated in a part or the whole of this transaction.
The basic idea is the following: an evidence of origin (EOO) is generated for buyer B and an
evidence of receipt (EOR) is generated for seller S. In general, evidences are generated via
PKI-based digital signatures. Our mobile payment structure is as follows. First buyer sends out
encrypted purchase order to the broker, which is a trusted server. Then this broker generates a
mobile agent which carries this encrypted purchase order to the seller, which decrypts this order.
The use of a broker between the wired and the wireless network can ease the access to web
information from the mobile devices, and it can also alleviate some of these security constraints
[5].
Mobile agents are considered to be an alternative to client-server systems mobile commerce
where mobile devices and communication have limited computing resource. A mobile agent of
This NSC report is basically rearrangement and short version from the paper presented in KES-AMSTA 2007; this
paper is published in LNCS No. 4496, pp298-307.
provide certificate management service to ensure the validity of certificate. These entities would
continue WPKI operations if and only if related certificates are valid.
Mobile Client. We suggest that a mobile client be a USIM-based 3G mobile equipment for
efficient signature generation and verification. A USIM stores only necessary WPKI components
due to the possible limitation of a USIM resource affordable to PKI operations. In our
non-repudiation protocol described in the following subsection, the USIM stores the TTP’s server
certificate andsubscriber’stwo private keys. These public-key certificates are all issued by some
CA within this WPKI. Private keys should be generated in USIM and contained in it afterwards.
Trusted Third Party (TTP). The trusted third party here is a notary server which simply generates
necessary evidences for buyers and sellers. TTP needs to perform WPKI operations according to
the non-repudiation protocol described in the next section. Therefore TTP needs to access CA’s
repository to retrieve necessary certificates of buyers’(sellers’) and verify digital signatures. TTP
will store evidences in its public directory from which buyers and sellers may fetch evidences.
wireless
Network
BROKER
SELLER
LDAP
Repository
CA
BUYER
TTPHoRA
Internet
Mobile agent
(Carried purchase
order)
Certificate
retrieval
Fetch evidence
from TTP
Fetch evidence
from TTP
Purchase
order
Fig. 1. Architecture of WPKI based Non-repudiation
Host Revocation Authority (HoRA). HoRA issues host certificates (HC) to merchant servers;
these certificates bind mobile agent execution capability to the merchant host identity. When a
merchant server acts maliciously, HoRA only needs to revoke this server’s HC to prevent the
broker from sending agents to it [8]. HoRA issues the host revocation List (HRL), which is a
digital-signed list of revoked HCs. The broker needs to update HRL periodically.
2.3 Broker
The broker acts as a mediator between the mobile users in the wireless network and the merchant
servers in the Internet, see Figure 1. The Broker must distinguish malicious servers from the
honest ones according to HRL to avoid sending agents to them. It is possible that honest server
become malicious before HRL is updated. Esparza et al. [8] provides solutions to solve this
mobile agent security.
5. TTP ←  S : fCON, B, S, L, T, tB, tS, K, EOR_C, con_K
“B →Broker→{A} S: M” means B sends message M to broker, then broker will generate an
agent {A} for B; message M will be carried by this agent {A}to S; “TTP ←B”means B fetches
messages from TTP. The basic idea is that buyer B is able to send K, sub_K to TTP in exchange
for con_K; on the other hand, seller S sends EOO_C, EOR_C and tS to TTP in step 3. In step 1, S
needs to verify EOO_C by retrieving B’s (signature) public key from the corresponding CA’s
repository. In step 1, S needs to verify EOO_C by using B’s (signature) public key; EOO_C is
saved as an evidence of origin for S. In step 2, after receiving sub_K, TTP keeps it in its private
directory and delete it after tB time units or until con_K is generated and published. In step 3,
after receiving EOO_C, EOR_C and tS from S, TTP needs to verify EOR_C using S’s (signature)
public key and compare EOO_C with the one sent by B in step 1. If either one is not true, TTP
concludes that at least one party is cheating and it will not generate con_K. We call {fCON, B, S, L,
T, tB, tS, K, EOR_C, con_K } the evidence of this purchasing order M. If steps 1-3 are shown
positive results, TTP starts to generate con_K with time stamp T attached. In step 4, buyer B
fetches K and con_K from TTP. In step 5, seller S fetches con_K from TTP to prove that K is
available for S.
3.2 Security of Non-repudiation Protocols
The most important security issue of a non-repudiation protocol is the dispute resolution. We
analyze the generated evidences of step 4-5 in the above non-repudiation protocol, dispute
resolution mechanisms of buyer and seller to see whether non-repudiation can be reached. A
trusted arbitrator will help solve the dispute according to submitted evidences.
Dispute of Origin
When buyer B denies having sent purchasing order M to seller S, S may present EOO_C, EOR_C
and con_K to the arbitrator in the following way:
S→ arbitrator : EOO_C, EOR_C, con_K, sSS(EOO_C, EOR_C, con_K), L, K, M, C
The arbitrator first verifies the signature of S, sSS(EOO_C, EOR_C, con_K); if the
verification is positive, the arbitrator checks the following five steps:
step 1: if EOO_C is equal to sSB(fEOO, S, L, C).
step 2: if EOR_C is equal to sSS(fEOR, B, L, tS, C).
step 3: if con_K is equal to sSTTP(fCON, B, S, L, T, tB, tS, K, EOO_C, EOR_C).
step 4: if L is equal to H(M,K).
step 5: if M is equal to dK(C).
If step 1 is checked positive, this arbitrator concludes that buyer B has sent seller S the encrypted
purchase order C. If step 2 is checked positive, arbitrator concludes that S has sent all the correct
payment information to TTP. For all 5 steps being checked positive, this arbitrator finally
concludes that B has sent S the purchase order M, which is encrypted by K and presented to be C.
Dispute of Receipt
When seller S denies receiving the purchase order M from buyer B, buyer may present EOO_C,
EOR_C, con_K to the arbitrator in the following way:
出席國際學術會議心得報告
計畫編號 95-2221-E-424-003-
計畫名稱 植基於 WPKI 之無線安全機制與其在 3G 交易之應用
出國人員姓名
服務機關及職稱
歐崇明
開南大學資訊管理學系助理教授
會議時間地點 波蘭 Wroclaw (2007.5.31-6.1)
會議名稱 The 1
st KES International Symposium on Agent and Multi-Agent Systems :
Technologies and Applications (KES-AMSTA 2007)
發表論文題目 Non-repudiation Mechanism of Agent-based Mobile Payment Systems:Perspectives on Wireless PKI
一、參加會議經過
本人於 5/30 日下午經德國慕尼黑飛抵波蘭 Wroclaw 後住進與會議舉行相同之旅館
Hotel Panorama ，傍晚和幾位來自中國大陸的研究人員共進晚餐，也瞭解目前中國在代理人
研究上的情形，順便在其廣場參觀具東歐特色之古蹟。
隔天就起了大早，大概是有些時差，我先享受豐盛早餐後就參加 5/31 之會議；早上開
始的 keynote speaker 是 Prof. Paolo Giorgini，題目是「An Agent-Oriented Software Engineering
Methodology」，因為在學校從事軟體工程的研究，對於代理人在這方面的應用非常有興趣，
也得到許多在後續研究上的啟發。接下來，會議分為幾個主軸 (Track)同時進行，包括代理人
之方法論、代理人與 Web 應用、行動代理人和本體論，多重代理人之資源分配、代理人之交
涉、代理人之安全問題等，本人對後者研究興趣濃厚，也在該主軸上打頭陣先發表一篇論文
是有關行動通訊安全服務與代理人之安全問題，約 20 分鐘；許多學者提出其看法，都認為
使用行動裝置對於商務應用上非常重要，而且代理人非常適合行動商務的特性。接下來根據
議程，在各種主軸中遊走，和其他與會人員討論。除了安全問題以外我較多的時間在聆聽有
關代理人與 Web 應用的問題。晚宴則和各國研究人員聊天，交換意見
第二天仍起了大早，先到廣場呼吸新鮮空氣且拍照，回旅館吃完早餐後聆聽 Prof. Paul
Davidson 為 keynote speaker 的演講，其主題為「On the Integration of Agent-Based and
Mathematical Optimization Techniques」 深深引發我這位從事數學多年的學子；除了找些時間
散步到 Wroclaw 最著名的幾個景點參觀外，其餘時間以參與代理人之應用主軸為主， 下午
約 3:30 會議結束，program committee 針對這第一屆的會議邀請與會人員一起提出看法，因
為只有我來自台灣，且明年 KES-AMSTA 2008 會在韓國舉行擴大到三天，所以趁晚上到慕
尼黑班機尚早的情形下，便和大家一起討論如何使明年第二屆會議更順暢，我也獲邀加入明
年的 Program Committee。
當晚回程時先拜訪慕尼黑 Dr. Gerhard，我們共同在 Iowa State University 攻讀學位；在慕
尼黑停留三天，參觀許多景點也爬了德南的小山；參觀慕尼黑博物館對於德國人做事的科學
性格再次感受深刻，於星期一搭乘德航返回台灣，結束此次收獲豐富的國際學術會議之旅。
