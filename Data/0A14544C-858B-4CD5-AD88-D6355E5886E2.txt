  
Abstract 
Segmentation plays an important role in interpreting and analyzing medical 
images. Erroneous or premature segmentation results may irrelevantly lead the 
ensuing analyses of the whole process. The fuzzy connectedness approach has drawn 
great attentions and well advanced in recent years. Its primary goal is to defer crisp 
decision of regions of interest (or ROIs) and carry the fuzzified information along 
until it is no longer possible. The conventional algorithm needs, however, to 
determine the threshold at the final stage of the segmentation process, and the choice 
of the threshold values significantly affects the efficacy of the segmented result. 
Besides, fuzzy-oriented approaches are typically time-consuming, especially for 
gigantic three-dimensional medical images. In this study, by exploiting the 
characteristics of the fuzzy connectedness method we propose an improved fuzzy 
connectedness segmentation method by employing an adaptive thresholding technique 
that incorporates an entropy-guided process. We evaluate the accuracy and robustness 
of the proposed algorithm, by using images from BrainWeb as the test dataset, and 
perform comprehensive comparisons with the popular Otsu’s approaches. The 
research work has been applied in many medical such applications as brain tumor 
extraction, surgical planning for funnel chests, semi-automatic identification of tooth 
neural canal. 
Keywords: Medical imaging, Region-based segmentation, Fuzzy-connectedness, 
Tooth, Funnel chest. 
 
摘要 
影像分割的處理程序在醫學影像的分析和詮釋的正確性扮演著非常重要的角
色。錯誤的或過與武斷的影像分割往往易導致後續分析的錯誤。影像切割的目的
在於將一數位影像區格為互不重疊的目標群域。此步驟在影像分析上是為最關鍵
的處理程序。不正確的群域切割導致稍後影像資訊的萃取和分析變得沒有價值。
於眾多影像切割演算法中，以群域成長理論為基礎的技術受到最廣泛的重視。而
在醫學影像的應用上，群域成長切割技術尤其適用於以 X 光電腦斷層掃描、核
磁共振取像、或正子射出斷層掃描技術所取得的影像。然而，傳統群域成長切割
演算法一直存在著潛藏的問題：切割後目標領域的範圍和特性與切割過程中初始
成長點 (initial growing points) 的選擇、成長的方向、影像中各點被檢視的順序
有著密不可分的關係。醫學影像檢視人員通常能夠由影像中約略的標識出欲觀察
的影像區塊或群域，但對於影像切割程序的初始成長點，未必每次均能指定在相
  
1. Introduction 
 In recent years, medical imaging 
techniques have been extensively and 
significantly improved along with the 
development of rapid and relatively inexpensive 
computational resources. Various imaging 
modalities have been developed to deal with 
certain medical applications. The research of 
medical imaging involves multidisciplinary 
efforts and can applied to many areas, such as 
radiology, computer-assisted surgery, surgical 
planning, interactive segmentation and 
visualization, multi-modality fusion, image 
registration, and quantitative assessment. 
 Image segmentation is a process of 
partitioning an image space into non-overlapping 
homogeneous regions. The success of an image 
analysis system heavily depends on the 
performance of segmentation. In a 3D medical 
image system, segmentation is the pivotal task.  
Many factors, however, complicate the 
image-segmentation issue. Image acquiring 
systems often do not generate ideal images for 
computational segmentation, due to partial 
volume effect, spatial inhomogeneity, random 
noises, etc.; therefore, the acquired “ill-defined” 
data need to be carefully taken care of.  
 Fuzzy image segmentation techniques 
have been introduced to cope with the imprecise 
or ill-defined data [1-3]. The Fuzzy 
Connectedness (FC) algorithm, apart from most 
of the other “crisp” segmentation techniques, 
captures the idea of “hanging togetherness” of 
image points [4]. Here, if it is necessary to make 
clear, we refer the 2D image points as pixels and 
3D image elements as voxels. Hanging 
togetherness is a grouping property that can 
depict the grouping state among image points. 
The algorithm analyzes the image and assigns a 
strength of connectedness to every possible pair 
of image points to represent the intensity 
features and patterns of intensity variations. It 
assumes the user has the appropriate domain 
knowledge to select a suitable threshold value in 
order to produce the final segmentation result. 
The quality of the final result, therefore, heavily 
depends on the threshold selection. 
The major shortcoming of simple 
thresholding approaches is that they typically 
does not take into account the spatial 
characteristics of an image and connectivity 
among image points, and thus sensitive to noise 
and intensity variations within a region. For 
example, when the intensities of a region 
continuously degrad along certain direction, the 
threshold-based methods might separate the 
region into many [5-8]. We propose in this paper 
a threshold selection scheme that applies entropy 
fuzzy measures to enhance conventional fuzzy 
connectedness segmentation approaches [12]. 
 The remainder of this paper is organized as 
follows. In Section 2, we give a brief description 
of “fuzzy connectedness.” In Section 3 we 
propose the fuzzy connectedness threshold 
selection scheme. Finally, we present the 
experimental results and comparisons with the 
popular Otsu’s approaches. We also discuss the 
validation protocol we used to evaluate the 
proposed method. 
 
2. Fuzzy Connectedness Method 
 The theory of fuzzy connectedness was 
first introduced by Rosenfeld [[8]]. Udupa et al. 
incorporated the concept of fuzzy connectedness 
with the image segmentation algorithm to 
deliver the notion of “hanging togetherness” 
[3,4]. The overall idea is to construct fuzzy map 
of connectedness of every image points and their 
  
End  
Then apply threshold to obtain final result. 
 
3. Threshold selection 
As mentioned above, the goodness of the 
final result of the fuzzy connectedness 
segmentation algorithm depends on the selection 
of the threshold value; therefore, a robust 
selection criterion is needed. Otsu’s thresholding 
method is commonly used to obtain optimal 
threshold value automatically [11]. Otsu’s 
method performs exhaustive search of potential 
thresholds that can maximize between-class 
variance of pixel intensity to achieve image 
segmentation. However, histogram information 
can be easily contaminated by the noises. Instead 
of choosing a threshold values in early steps of 
segmentation, we first apply fuzzified 
measurements, in corporation with the “entropy” 
of the image, to assist in later threshold 
selection. 
The entropy involved uses Shannon’s 
function to measure the fuzziness of an image so 
that the threshold can be determined by 
minimizing the entropy measure [12]. The 
entropy of a fuzzy image X as defined by De 
Luca and Termini is: 
1
( ) ( ( ))
ln 2 X mnm n
H X E x
MN
μ∑∑=  
 with the Shannon’s function 
 
( ( )) ( ) ln ( )
             (1 ( )) ln(1 ( ))
1, 2...,  , 1, 2, ...,
X mn X i X mn
X mn X mn
E x x x
x x
m M n N
μ μ μ
μ μ
= − −
− −
= =
 
 The term ( )H X , 0 ( ) 1H X≤ ≤ , 
measures the fuzziness in X on the basis of 
Shannon’s function. E  is monotonically 
increasing in the interval [0,0.5] and 
monotonically decreasing in the interval [0.5,1]. 
E  reaches its maximum of fuzzy measure at 
0.5.  
In order to keep minimum user 
interference, the following fuzzification method 
is employed [9]: 
 
1
, if 
1 | | /
( )
1
, if 
1 | | /
mn
mn
X mn
mn
mn
x t
x Kbx
x t
x Kf
μ
μ
μ
≤
+ −
=
>
+ −
⎧⎪⎪⎨⎪⎪⎩
 
where K is a constant value such that 
1 2 ( ) 1X mnxμ≤ ≤  and 
 1 1
1 1
( ) ( )
,  .
( ) ( )
T L
l l T
b fT L
l l T
l h l l h l
h l h l
μ μ= = +
= = +
× ×
= =
∑ ∑
∑ ∑
 
 For a given threshold T, any spel in the 
input image should belong to either the 
foreground or the background. Thus it is 
expected that membership value of any pixel 
should be no less than 1/2.  
 In order to shape our system more robust, 
we proposes a modified entropy method. It 
utilize the information of mean of spel intensity 
values m which are in the object of interest as 
the weight of Xμ : 
 1 11 2
1 1
( ) ( )
,  .
( ) ( )
T L
l l T
b fT L
l l T
l h l l h l
h l h l
μ ϖ μ ϖ= = +
= = +
× ×∑ ∑
= =
∑ ∑
&& &&  
where )]1/([1 +−= Lmlϖ  and 12 1 ϖϖ −= . 
This allows more accurate result because 
when the threshold approaches to the optimal, 
fμ&&  value weighted by 2ϖ  is getting larger 
and bμ&&  weighted by 1ϖ  is getting smaller. 
Finally, substitute the entropy membership 
function fμ  and bμ  with fμ&&  and bμ&& . The 
formula rewrite as follow: 
  
(b)
 
Figure 2: (a) The fuzzy scene resulted from 
Figure 1(a); (b) Unimodal histogram from (a). 
 
 In contrast to Otsu’s method, the proposed 
modify entropy method can deal with the 
unimodal histogram effectively, as shown in 
Figure 3. 
 
5. Conclusion 
 This paper proposes an adaptive threshold 
method for fuzzy connectedness segmentation.  
By utilizing the information as the weight the 
intensity mean of the regions of interest, and 
through the comparison of results of the 
proposed approach against that of the popular 
Otsu’s method, we have empirically shown that 
improvement can be made by the proposed 
algorithm. 
 
6. Acknowledgments 
 This work was partially supported by 
National Science Council (NSC), Taiwan, R.O.C. 
grants NSC-90-2314-B-182-093 and NSC–91– 
2213-E-182-020. More detailed discussions 
appear in Ref. [[10]].  
 
Table 1 
Each of the entry represents FOM measures which are resulted from 
Otsu, Entropy (Ent), Modify Entropy (MEnt) thresholding method. 
 INU: 0% INU: 20% INU: 40% 
 Otsu Ent MEnt Otsu Ent MEnt Otsu Ent MEnt 
N0: σ=0 98.27 95.88 97.53 96.40 92.67 98.29 92.76 92.12 96.06 
Thr Lev 0.4392 0.3164 0.6172 0.4275 0.3359 0.5703 0.4118 0.3945 0.5195 
N1: σ=0.001 98.87 96.44 97.69 95.15 90.73 97.80 93.51 92.52 96.01 
Thr Lev 0.4196 0.3477 0.6055 0.4118 0.3281 0.5430 0.4078 0.3750 0.4883 
N2: σ=0.003 96.65 89.01 98.02 93.55 88.94 97.67 91.04 89.56 95.03 
Thr Lev 0.3922 0.2405 0.5859 0.3922 0.2852 0.5313 0.3726 0.3281 0.4883 
N3: σ=0.005 97.54 93.88 97.31 88.77 87.00 94.20 94.81 90.79 97.14 
Thr Lev 0.3765 0.2617 0.5547 0.3608 0.2813 0.5078 0.3843 0.2735 0.5469 
N4: σ=0.007 93.59 87.01 97.76 95.24 88.57 97.30 88.39 86.56 90.57 
Thr Lev 0.3804 0.1914 0.5703 0.3608 0.1836 0.5625 0.3569 0.2070 0.4570 
Note: Intensity non-uniformity (INU) increases along rows and the noises (N) increases with the σ 
values along columns. 
 
 
  
1995. 
12. A. De Luca, S. Termini, “A definition of non 
probabilistic entropy in the setting of fuzzy 
sets theory,” Inform. And Contr., vol. 20, pp. 
301-312, May 1972. 
13. http://www.bic.mni.mcgill.ca/brainweb/. 
14. C. A. Cocosco, V. Kollokian, R. K. S. Kwan, A. 
C. Evans, “BrainWeb: Online Interface to a 3D 
MRI Simulated Brain Database,” NeuroImage, 
vol. 5, no. 4, part 2/4, S425, 1997 – 
Proceedings of 3rd International Conference on 
Functional Mapping of the Human Brain, 
Copenhagen, May 1997. 
15. R. K. S. Kwan, A. C. Evans, G. B. Pike,“MRI 
simulation-based evaluation of 
image-processing and classification methods,” 
IEEE Transactions on Medical Imaging, vol. 
18, no. 11, pp. 1085-97, Nov 1999. 
16. R. K. S. Kwan, A. C. Evans, G. B. Pike,“An 
Extensible MRI Simulator for Post-Processing 
Evaluation,” Visualization in Biomedical 
Computing (VBC'96), Lecture Notes in 
Computer Science, Springer-Verlag, vol. 1131, 
pp. 135-140, 1996. 
17. D. L. Collins, A. P. Zijdenbos, V. Kollokian, J. 
G. Sled, N. J. Kabani, C. J. Holmes, A. C. 
Evans, “Design and Construction of a Realistic 
Digital Brain Phantom,” IEEE Transactions on 
Medical Imaging, vol. 17, no. 3, pp. 463-468, 
June 1998. 
18. Jung-Tai Chen, “Adaptive Threshold Selection 
of Fuzzy Connectedness Segmentation,” 
Master Thesis, Chang Gung University, Aug. 
2003. 
 
  
Fig. B: The type of the funnel chest. It can be divided 
into the smooth type and the sinking type in 
accordance with the sinking condition. It can be 
divided into the symmetric type and the asymmetric 
type in accordance with the symmetric condition. 
 
1.2. Types of the funnel chest 
The funnel chest can be categorized as 
symmetric and asymmetric type in accordance 
with the size of thorax at both sides. It can be 
further divided into the funnel chest and 
saucer-shaped chest in accordance with the 
sinking degree. It is shown in the Fig. B. 
 
In this work, we shall focus on the 
symmetric funnel chest. There are the three 
kinds of main operations for the medical 
treatment of the funnel chest: 
1. Japanese Hotan’s rib turnover operation 
2. American Ravitch’s costal cartilage cutting 
operation 
3. The Nuss operation (proposed by American 
Dr. Nuss in 1988) 
Japanese Hotan’s rib turnover operation: 
The whole front chest wall shall be sawn and 
turned 180° over to change the curvature. It is 
difficult for the recovery of big wound. 
    American Ravitch’s costal cartilage 
segmenting operation: It has to excise 6 to 8 or 
even more sunken ribs. Then the sternum is cut 
and raised. After the rib is excised, the rib 
membrane remains, so it can grow again after 
several months. The result of this method is 
good, but an about 10 cm scar will be left on 
the chest certainly after the operation. It is a 
bid disadvantage for the patient who likes 
beauty. After the operation, the chest is very 
fragile because it lacks the support of sternum. 
It has to reduce the violent sports. And many 
patients still have the possibility of relapsing 
after the operation. 
The Nuss operation (proposed by 
American Dr. Nuss in 1988): It is a kind of 
micro operation, which uses the auxiliary 
laparoscope system to open about 2 cm of hole 
at both sides of chest, plant into one to two 
correction boards in the thorax, in order to 
correct the sinking situation of sternum 
without excising a large number of ribs. 
 
1.3 Haller index  
In medical science, the Haller index is 
used to judge the severity of the funnel chest. 
At the same time, this index can be used to 
judge the therapeutic effect. 
The definition of Haller index: a/b (a is 
the longest distance of axis in the thorax, b is 
the distance between the ensiform process and 
vertebra). 
 
A. The index of normal people: 2.5 
B. If the index is greater than 3.25, then the 
treatment is required. 
So, it is hoped the index shall be close to 2.5 
after the treatment. 
 
 
Fig. C: Haller index 
  
    Analyze the distance between the sternum 
and vertebra, the longest distance of the thorax, 
and more reference data, such as the Haller 
index (greater than 3.25, the treatment is 
required; about 2.5, it is normal without any 
treatment). 
    There is no specific shape of the 
correction board before the operation, so it has 
to design a fictitious curve, and utilize this 
fictitious curve to revise the curvature of 
correction board. It is used to raise the costal 
cartilage, and make the sunken sternum going 
up. And utilize the fictitious curve to simulate 
the chest shape after the operation. 
 
Table 1: Averaging-up filter 
2
/16 
2
/16 
2
/16 
2
/16 
4
/16 
2
/16 
2
/16 
2
/16 
2
/16 
 
 
2-2. Preprocessing 
The averaging-up filter as shown in Table 1 
and the median filter were employed to remove 
the noise while brighten the chest [1-3]. 
Adaptive thresholding and region-based 
segmentation were used interchangingly to 
extract the chest contents. As for identifying 
skeleton fringe, a simple Sobel operator was 
utilized to determine the edge of the elliptical 
shape of the chest.  
 
2-3. Feature and elliptical curve extraction 
for the funnel chest 
 
 
1 In the thorax, find out the maximum 
distance, a, in X axis. 
2 In Y axis, find out the distance, b, 
between the ensiform process and 
vertebra. 
3 In order to satisfy about 2.5 of the Haller 
index, a/(b+x)=2.5. If a/b does not equal 
to 2.5, x will be the correction value. The 
extended point of x is C. 
4 The linear equation can be used to get the 
coordinate of c. 
5 Select the fixed points P, Q at both ends 
of rib, these two points will be used to fix 
the correction board. 
 
6 Use the ellipse equation to simulate the 
curvature of correction board. It is 
divided into left curve is from C to P, and 
the right curve is from C to Q. 
7 P and C can be seemed as the end point of 
long axis and short axis. The curve 
between (XP, YP) and (XC, YC) can be got. 
The ellipse equation: 1
22
=+
m
y
n
x
 
  
(Fig. 3.1 The distribution condition of 
grayscale pixel) 
3.2. Linear distribution condition of bone 
 
(Fig. 3.2 The original picture of single image) 
    According to the distribution condition of 
the bone and muscle tissue, it is able to display 
the rib part clearly. And it is able to calculate 
the Haller index. Then the Haller index is used 
to evaluate the required correction value. 
 
(Fig. 3.3 The red part is the muscle tissue, and 
the white part is the bone tissue) 
 
(Fig. 3.4 The red part is the muscle tissue, and 
the white part is the bone tissue) 
The image of Fig. 3.3 can be obtained 
from the pixel distribution of Fig. 3.2. But it is 
found that the image of heart part in Fig. 3.3 is 
higher. So the heart part shall be separated 
manually. Now, the region growing technology 
is used to select several points on the heart part 
and judge it as the muscle tissue, so the heart 
part becomes red. Fig. 3.4 shows the result 
after using the region growing. Fig. 3.5 shows 
the result after removing the muscle tissue. 
From this figure, it is able to calculate the 
distance between the ensiform process and 
vertebra. From Fig. 3.4, it is able to calculate 
the longest distance of X axis in the thorax. So 
the Haller index can be used to determine 
whether the chest shape is abnormal or not. 
 
(Fig. 3.5 The display of the bone tissue) 
 
(Fig. 3.6 The display of the bone tissue 
and soft tissue (skin and muscle)) 
3.3. Simulation for the curve of the 
correction board 
Upon carrying on the simulation of 
correction board, it has to measure the Haller 
index in the thorax first. So it is necessary to 
the distance of X axis in the thorax and the 
distance of Y axis between the ensiform 
process and vertebra. During the measurement 
process, because it can not use a single point to 
  
    The proposed and developed 
computer-aided system can help the physicians 
perform surgical planning and make 
adjustment interactively. Before the operation, 
the proper curve of correction board can be 
calculated first, and let the patient to know the 
result after the operation, and whether the 
normal activity will be influenced by the 
operation. This system can not simulate the 
chest shape to meet the aesthetics and medical 
requirement. The physician can use of this 
system to know the chest shape before and 
after the operation, in order to raise the 
successful opportunity of operation. 
 
Acknowledgments 
 The work is financially supported in part 
by National Science Council Grants NSC- 
94-2213-E-182-018 3 and NSC- 
95-2221-E-182-047. Dr. Chih-Chun Chu in the 
Pediatric Surgery Division of Tri-Service 
General Hospital granted the usage of the 
funnel chest images. 
 
References 
1. W.K. Pratt, “Image Enhancement,” in 
Digital Image Processing 3ed. New York: 
John Wiley & Sons, 2002, pp.243-298. 
2. M. Petrou and P. Bosdogianni, “ Image 
Enhancement,” in Image Processing: the 
fundamentals New York: John Wiley & 
Sons, 2001, pp. 125-154. 
3. R.C. Gonzalez and R.E. Woods, “Image 
Enhancement in the Spatial Domain,” in 
Digital image processing 2ed. 
Massachusetts: Addison Wesley, 2002, 
pp. 75-146. 
4. Sobel Operator Gonzalez and Woods, 
"Digital Image Processing 2nd Edition", 
Book ISBN Number: 0201180758. 
Prentice Hall. 2002 
5. T. Pavlidis and Y.T. Liow, “Integrating 
Region Growing and Edge-Detection,” 
Ieee Transactions on Pattern Analysis 
and Machine Intelligence, Vol. 12, no. 3, 
pp. 225-233, Mar. 1990. 
6. R.Jones and I. Svalbe, “Algorithms for 
the Decomposition of Gray-Scale 
Morphological Operations,” Ieee 
Transactions on Pattern Analysis and 
Machine Intelligence, vol. 16, no. 6, pp. 
581-588, June 1994. 
7. G. Anelli, A. Broggi, and G. Destri, 
“Decomposition of arbitrarily shaped 
binary morphological structuring 
elements using genetic algorithms, “ Ieee 
Transcations on Pattern Analysis and 
Machine Intelligence, vol. 20, no. 2, pp. 
217-224, Feb. 1998. 
8. P. Sussner and G.X. Ritter, 
“Decomposition of gray-scale 
morphological templates using the rank 
method, “ IEEE Transcations on Pattern 
Analysis and Machine Intelligence, 
vol.19, no. 6, pp. 649-658, June 1997. 
 
  
then it will be a very bad news to the patient. 
Under the development of modern information 
engineering, 3D visual display and recognition 
system can be used to simulate the structure of 
human body. The actions such as Rotate, 
Translate, and Scale etc. can be achieved in 
accordance with the therapeutic requirement of 
medical personnel. Even the actual condition 
can be simulated to give the physical nature of 
the system. It will also demonstrate the final 
result faithfully while including the fail at the 
same time. 
 
1-3. Purpose of Research 
    When the dentist installs the denture for the 
patient, the steel nail has to be installed into the 
lower jawbone. The attention shall be paid so as 
not to hurt the tooth nerve. Otherwise the tooth 
nerve will most likely to necrosis because of 
injuring. It is important to put the steel nail deep 
enough, and it will not hurt the tooth nerve in 
just right position. It is the key point for the 
success of denture operation. In the past 
traditional medical science, the dentist can only 
depend on the X-ray picture to judge the 
position of tooth nerve in accordance with the 
clinical experience. Though the X-ray picture 
can offer XY axis, YZ axis of 2D picture, it only 
has a limited assistance to the doctor. So, in 
order to solve this problem, the best way is to 
reconstruct 2D X-ray picture to 3D visual 
image. 
 
    Though the skeleton and soft tissue of the 
human body can be displayed on the X-ray 
picture visually, the very small tissue can not be 
displayed. The key component of “tooth neural 
canal” is under this awkward classification. The 
tooth neural canal is a layer of tubular skeleton 
with lower thickness. So the complete tubular 
structure can not be displayed on each X-ray 
picture. The position of tooth neural canal is 
different for every patient. So, how to utilize the 
image processing technology to reconstruct the 
information of picture and remove the noise is 
the key research of this paper. 
 
2. Related Research Method 
2-1  3D Image Modeling 
    The development of 3D visual display 
technological field has been already quite 
mature. Two major mainstreams used mainly in 
the industry at present are: OpenGL and DirectX. 
OpenGL is an Open Source, which can be added 
or revised in accordance with the demand of 
user, so it is often adopted in the academic 
research. 
 
The VTK (Visual Toolkit) applied in this 
paper adopts OpenGL as the basic scheme of 3D 
image Library. The function of VTK has higher 
level compared with OpenGL. So its adoption 
rate is higher in the field for the treatment of 
medical image. The user can construct 3D 
model promptly and effectively, after DICOM is 
transferred into raw file and the relevant 
components and required parameters are set. It 
also provides a lot of algorithms on image 
processing, I/O interface, and visual display etc. 
It can help the designer to avoid the 
development of lower level structural 
components, which can save lots of study time. 
It is a great pity that there is almost no 
discussion zone of VTK in our country and 
foreign countries. Even it is not described 
clearly in the official documents. This is the 
  
quickly and effectively. It not 
only can remove the noise, but 
also can strengthen the 
required information 
characteristics at the same 
time. But the information of 
tooth neural canal is stored in 
the original picture, and it 
might have significant 
similarity with the skeleton 
information inside the teeth. 
The interference situation 
might be occurred, so it has to 
use the other auxiliary 
algorithm to solve this 
problem. 
 
 
We can find that the highest peak is located 
at 54~77 in the above histogram of brightness. 
The brightness at this interval is the soft tissue 
shown in Fig. 3. So the value of 77 is used as the 
Threshold to carry out binary digitization to get 
the result of Fig. 4. It is found that the tooth 
neural canal becomes much clearer. 
     
 
 Edge detection, object characterization 
After the picture is 
digitized, although it becomes 
easier to recognize the tooth 
neural canal, the hard tissue 
of tooth root still becomes the 
noise of judgment, so the edge 
detection, object 
characterization have to be 
used to retrieve the 
information. The edge 
detection is mainly used to 
separate the search 
component from the 
background of the picture. 
The principle of algorithm is 
using the brightness value of 
image as the basis of judgment. 
If the disparity of the 
brightness value of two pixels 
is very large, it means these 
two pixels represent different 
components. It also gets the 
additional information of each 
component, such as position, 
size, and shape etc. 
There are many kinds of algorithm for edge 
detection. The “Derivative filter” is used most 
frequently at present. It is mainly used to sharp 
the change of grayscale. The various operators 
can be used for the processing, such as Sobel, 
 (Fig. 3) (Fig. 4) 
  
¾ Region GrowingRegion Growing is often 
used for the recognition of image. Normally, the 
user designates a pixel in the picture, then 
searches 8 pixels adjacent the said pixel to 
determine they meet the “characteristics” of the 
said pixel. If it is, then they are sorted as the 
same block, otherwise they are excluded. The 
“iteration” way is applied to search from inside 
to outside continuously, until the satisfied 
“characteristics” can not be found. But it has to 
pay a special attention to this! If the said simple 
“iteration” is applied for the operation, the bug 
of “infinite iteration” will be occurred due to the 
corresponding relationship of “left and right”, 
“up and down” mutually. So in order to solve 
this awkward situation, a “Stack” is added for 
the comparison. When a pixel is added, it will be 
compared with the pixel recorded in the “Stack” 
for the judgment. If the pixel has not been added, 
it will be add into the “Stack”, and the search is 
continued. If the pixel exists in the “Stack”, the 
“iteration” will be ended by a “Return” 
immediately. However, because all pictures of 
this study have already been treated by the 
“binary digitization”, so only white pixels have 
to be searched, the user does not have to make 
the special designation. An execution result of 
Region Growing is shown in the following 
figure. 
 
 
¾ MorphologyMorphology is applied for 
the classification of the biological species 
originally. Upon applying in the information 
engineering, it is used to analyze the structure of 
the image. The Erosion and Dilation operators 
are used to combine the broken or incomplete 
parts of the image to increase the recognition 
rate. As for its principle, the dilation operator is 
used to expand all pixels outward first. The 
incomplete parts in the figure can be connected. 
But the other parts will be dilated too, which 
will cause the judgment error. So the erosion is 
used to balance it. Though the target block will 
be contracted slightly by the erosion, it will not 
be broken to the original state, because the target 
block has been fused together by the dilation. 
The times of erosion should be the same as the 
times of dilation. But in this study, the other 
parts are not required except the tooth neural 
canal, so one more erosion is made to remove 
the other parts as the noise, in order to increase 
the recognition 
rate.
 
¾ The positioning for the mouth of tooth 
neural canal 
The tooth neural canal of the lower jaw 
will penetrate out from the adjacent of canine 
tooth. Then it will distribute evenly in the soft 
tissue of lower jawbone. The tooth nerve in this 
block will not disturb the installation of denture. 
If this block can be isolated from the operation, 
it can reduce tremendous unnecessary operation. (Region Growing) 
  
want to make the diagnosis more effectively and 
accurately, the fine tissue of human body is still 
unable to be displayed correctly in the original 
picture. This is the key point of this study: 
“Tooth neural canal”. The tooth neural canal 
penetrates out from the bottom of molar tooth to 
the end of canine tooth through the tubular 
skeleton of lower jaw. The image of the tubular 
skeleton is not clear on X-ray picture, because 
its thickness is very thin and the distribution and 
shape is inconsistent. So it has to be recognized 
and positioned by the image processing 
technology. Then 3D display function of VTK is 
combined to display correct and accurate 
module of tooth neural canal for the medical 
diagnosis. 
 The denture operation can be simulated 
in advance 
    This is the biggest benefit of this thesis on 
the medical science substantially. Upon 
installing the denture, the depth of steel nail is 
very important. If the depth is not enough, the 
denture will loose and peel off. But if the depth 
is too deep, probably the tooth nerve will be 
injured. If it is more severe, even the tooth nerve 
will be dead. This system can simulate the depth 
of steel nail, and detect its distance with the 
tooth neural canal automatically at the same 
time. In addition, an alarm system is set. The 
user can set a threshold value. If the distance 
between steel nail and denture is over the 
threshold value, an alarm will be sent out 
automatically to remind and warn the user. 
 The embodiment of system operation 
 
Recognizing and displaying the actual position 
of tooth neural canal. 
 
Adjusting the transparent level arbitrarily in 
accordance with different requirements of the 
user. 
 
Setting the parameters and adjusting the 
variance of Rotate, Translate finely in 
accordance with the requirements of the user. 
 
Using Zoom In and Zoom Out and other 
parameters freely to provide the complete 
information to the user. 
 
Acknowledgments 
 The work is financially supported in part 
  
 
 
SYMMETIRC FUZZY-CONNECTEDNESS SEGMENTATION ON MEDICAL IMAGES 
 
 
ABSTRACT 
 
Segmentation plays an important 
role in interpreting and analyzing 
medical images. Erroneous or 
premature segmentation results may 
irrelevantly lead the ensuing analyses 
of the whole process. The fuzzy 
connectedness approach has drawn 
great attentions and well advanced in 
recent years. Its primary goal is to 
defer crisp decision of regions of 
interest (or ROIs) and carry the 
fuzzified information along until it is 
no longer possible. Fuzzy-oriented 
approaches are typically, however, 
time-consuming, especially for 
gigantic three-dimensional medical 
images. In this paper, by exploiting the 
characteristics of the fuzzy 
connectedness method we propose an 
efficient variant – symmetric 
fuzzy-connectedness (SymFC) 
segmentation. The theoretical and 
experimental aspects are explored. 
The images and segmentation results 
are packaged in the SCORM 
(sharable content object reference 
model) compliant format to potentially 
serve as E-learning materials.  
 
 
 
1. INTRODUCTION 
 
The goal of medical image processing is to assist 
the human expert in identifying and interpreting 
information embedded in the image. Segmentation plays 
a pivotal role in the processing and analysis procedure 
in that it partitions an image into homogeneous regions 
(or ROIs) [1]-[2]. Noise or phantom effects inherently 
introduced from the scanners, due to their spatial and 
temporal limitations, however, complicate the 
segmentation process. By means of traditional image 
enhancement techniques, we are able to eliminate 
known and obvious erroneous effects from the images. 
Though, “normal” intensity variations and gradations 
within an image and ambiguities exist. Such 
uncertainties serve as the rationale of taking fuzzy 
approaches into account. Compared with hard 
segmentation, the process of fuzzy segmentation is 
considered more resilient and closer  the thinking of 
mankind, via various membership functions (that depict 
the membership grade for certain feature) and 
compounds of fuzzy relations [3]-[5]. 
On the other hand, a physician consults his/her 
clinical experience and relevant domain expertise to 
make interpretation during the medical diagnosis. It is 
also true for medical image examination. It is beneficial 
to store the experience, (or the segmentation results in 
the context of this paper) and the domain knowledge in 
a well-accepted public format.  
The aims of this paper are thus to (1) propose a 
fuzzy image segmentation method that incorporates 
fuzzy connectedness and symmetric region growing 
algorithms, and to (2) develop a SCORM-compliant 
format and a software system to store the 
original/segmented images, and diagnostic results 
[3],[6]-[7].  
First, fuzzy connectedness intrinsically employs 
dynamic programming to reach optimal solution and on 
symmetric region growing, on the contrary, exploits the 
characteristics of the symmetric relation within a region 
to accelerate the process. In this paper we attempt to 
bridge the differences between these two approaches to 
perform a robust while efficient segmentation. 
Furthermore, reusability and accessibility of the 
diagnostic data motivate the second aims of this work. 
The original and segmented images are stored and 
packaged to conform to SCORM [7]. The SCORM 
standard, promoted by the Department of Defense of 
USA for applications in electronic learning (or 
E-Learning) environments, is used to encapsulate 
studied diagnostic data. 
Figure 4 illustrates the flowchart-like architecture 
of the proposed system with four stages. First, the 
system loads the original image data that can be of such 
image formats as {bmp, gif, jpg, png, tif} or 3D medical 
image formats like ANALYZE and DICOM. The user 
may choose to bypass the second stage (image 
segmentation) and manually make annotation or resort 
to the semi-automatic segmentation in the second stage 
  
Likewise, the object-feature affinity member function 
can be defined as: (Please refer to Ref. [3] and [10] for 
detailed derivation.) 
 
min
  
_max _max
  
_ _max
( , ) ,  
[ ( , ), ( , )] ( , )
( , )      if  ( ( ), ( ) ( ) 0
0, if ( ) ( ( ), ( ))
o
i
b b o
i i
r l
i i
r max l
W c i
Max W c i W f i W c i
c i Max f x f x f c
f c Max f x f x
φμ
⎧⎪ +⎪⎪
= ≥ ≥⎨⎪
>⎪⎪⎩
 
(3)
 
oW  and bW  denote the object and background 
intensity distributions, respectively, and are modeled as 
bell distribution: 
 
( )
2 
min
 
min
1( , )
( )
1
( ) ( )
o
i
ii i
l r
W c i
f c
Max f f
f
fx x
=
−
+
+ −
(4)
 
( ) ( )( )
( ) ( )( ) ( )
2
  
_ _
  
_ _
1( , )
( ) ,
1
, ( ), ( )
b
i i
l Max r Max
i i i i
l Max r Max l r
W c i
f c Max f f
Max f f Max f
x x
x x x x
=
−
+
−
(5)
 
2.2. SymFC: symmetric fuzzy-connectedness 
 
The traditional ( )RG ψ  represents a 
region-growing algorithm governed by the growing 
criteria ψ . A denotes the seed set which contains M-1 
seed, and each seed grows a region. I is the original 
image. 
 
1
( , ( ), )
M
i
i
S I RG A Rψ
=
=U  (6)
 
In order to avoid confusion, we denote iε , instead 
of ψμ , to express these criteria which obtain from 
multiple scan-lines across an object. Each scan-line 
contains a seed set iA  to grow the region. We redefine 
Eq. (6) as:  
 
( , ( ), ) ,i i i iS I RG A F Bε = U  (7)
 
F and B denote the foreground and background regions, 
respectively.  
 
( )( , )
iRGg p q True p qε= ⇒ ⎯⎯⎯⎯→  (8)
 
g(p,q) denotes a Boolean growing function between p 
and q. For any ip F I∈ ⊂ , a neighbor q will be 
included in iF  ( , )iff g p q True= . Further, if 
( , ) ( , ),  ,g p q g q p p q I= ∀ ∈ , the ( )RG ψ  is symmetric, 
represented as ( )SymRG ψ . The following examples 
show whether a g(.,.) is symmetric. Here, ( )N pμ  
denotes the average gray-level value of point p’s 
neighbors, ( )R pμ  represents the average gray-level 
value of points constituting p’s member region, 1 6~σ σ  
are constants [6]. 
 
1 2( , ) ( ) ( )g p q f p f qσ σ≡ ≤ − ≤  symmetric
3 4( , ) ( )g p f pσ σ⋅ ≡ ≤ ≤ symmetric
( ) 5( , ) ( ) N pg p f p μ σ⋅ ≡ − ≤  symmetric
( ) 6( , ) ( ) R pg p f p μ σ⋅ ≡ − ≤  not symmetric
    
 Above equations suggest that the symmetric criteria 
are not be affected by the growing sequence. In this 
work, we use SymRG to initially filter out the noticeable 
region repeatedly to more stringent segmentation. Eq. (9) 
denotes the nth segmentation toward ith object 
 
( , ( ), ) ,i i i in n nS I RG A F Bε = U  (9)
 
The segmentation result is then:  
 
11
...i i ini F FF F ∧ ∧=  (10)
   
 Now we are ready to compute ψμ . The original idea 
is find the homogeneity between two pair of spels. We 
revise the relation into the homogeneity between any 
spel and the desired object. Here, each spel c consists 
the feature that present the homogeneity within a fixed 
radius r. When the spel is inside of the neighboring 
region of an object, the value of D(c) should be smaller 
than that are on the boundary.  
 
( ) ( ) ( ) ,  where ( )D c f c f e e I c e r c= − ∈ ∧ − <∑ (11)
 
The next step of importance is to determine the 
applicable intensity values to separate the foreground 
from the background. We shall cover this issue in Sec. 
4. 
After we get the continuous spels on the across 
line and compute the corresponding ( ),i ix σ , we use 
bell form here again. The form is listed as following:  
 
2
1( , )
( )1 i
i
c i
D c x
ψμ
σ
=
−
+
(12)
 
  
 
Figure 8. Phantom image 1. 
Range of circle intensities: 
60-68. Ring-colored 
background: 100-250. 
Image size: 200x200. 
Figure 9. Phantom image 2. 
Range of circle intensities: 
60-68. Ring-colored 
background: 50-200. Image 
size: 200x200. 
 
4. RESULTS 
 
To validate the efficacy of the 
proposed method, in addition to scanned 
medical images we create phantom 
images on which traditional thresholding 
or region-based approaches exhibit 
difficulties in acquiring satisfactory 
segmentation performance.  
 
4.1. Phantom images 
 
The phantom images are so created that the regions 
of interest are recognizable by human eyes. Figure 8 and 
Figure 9 illustrates two of the phantom images 
automatically generated. Gaussian noise and blurring 
effects are added to further obscure the phantom images. 
Please refer to Ref. [10] for more details. 
 
4.2. Test and Results 
 
We use region growing and our approach to test 
above images. Five points are selected to be seed point 
individually in order to represent the variation of users’ 
selection of designating the object in our consideration. 
In region growing method, the seed points set at center 
(100,100) / left (75,100) / right (125,100) / top (100, 75) 
/ bottom (100,125) in the object (as shown in Figure 10). 
In our approach, the arguments are extracted from the 
scan-lines which pass through these points.  
In order to simplify the procedure of determining 
the α-cut for ( , )c iκμ , we set the threshold value equal 
to 0.5. The next step is to compare these segmented 
images with the ground truth. A simple figure of merit 
(FOM) computation is used as a measure to evaluate the 
correspondence between the segmented image and the 
ground truth. 
( )GI  denotes the binary image of the 
ground truth and 
( )SI denotes binary image the 
segmentation result. ⊗  represents the exclusive-OR 
operation between binary images. 
( ) ( )G SI I⊗  denotes 
the number of spels whose value equal 1(while 
segmentation result matches the ground truth). 
( )GI  
denotes the total spels of ground truth. 
Figure 10. Pre-specified seeds and scan-lines. 
 
 
( ) ( )
( )
1 100G S
G
I I
FOM
I
⎡ ⎤⎛ ⎞⊗⎢ ⎥⎜ ⎟= − ×⎜ ⎟⎢ ⎥⎝ ⎠⎣ ⎦
 
(13)
 
 
Besides, we give the average of FOM and the 
corresponding standard deviation for each test image. 
Finally, the SCORM Conformance Test Suite 1.2.4 is 
employed to valid the packaging results. Details 
regarding SCORM packaging can consult Ref. [7]. 
Table 2. lists the result of the proposed method. The 
mean and standard deviation is computed by six 
experiments. 
 
Table 2. Result of the proposed approach. Test image: 
Figure 10; first row in each entry: mean; second row in 
each entry: standard deviation. 
 Noise 1 Noise 2 Noise 3 Noise 4 
Blur 
1 
98.16708 
0.359073 
98.64833 
0.166806 
98.70667 
0.412488 
81.14833 
0.10645 
Blur 
2 
97.17042 
0.345968 
97.92208 
0.499899 
98.24083 
0.302306 
97.77042 
0.199358 
Blur 
3 
96.20625 
0.448622 
96.56583 
0.426156 
97.48875 
0.509109 
97.60958 
0.308539 
Blur 
4 
95.07125 
0.731218 
94.96625 
0.576942 
95.85292 
0.643241 
96.47708 
0.616604 
  
6. REFERENCES 
 
[1] Benoit M. Dawant and Alex P. Zijdenbos, Handbook of 
Medical Imaging, Volume 2, Medical Image Processing 
and Analysis, Chapter 2： Image Segmentation, SPIE 
Press, 2000 
[2] Matthew S. Brown and Michael F. McNitt-Gray, 
Handbook of Medical Imaging, Volume 2, Medical 
Image Processing and Analysis, Chapter 7：Medical 
Image Interpretation , SPIE Press, 2000 
[3] P. K. Saha, J. K. Udupa, and D. Odhner, “Scale-based 
fuzzy connectedness image segmentation: Theory, 
algorithms, and validation,” Computer Vision and Image 
Understanding, vol.77, pp.145-174,2000 
[4] J. K. Udupa, P. K. Saha, and R. A. Lotufo, “Relative 
fuzzy connectedness and object definition: Theory, 
algorithm, and applications in image segmentation,” 
IEEE Transactions on Pattern Analysis Machine 
Intelligence, vol.24, pp.1485-1500, 2002 
[5] J.-S. R. Jang, C.-T. Sun, and E. Mizutani, “Neuro-fuzzy 
and soft computing: a computational approach to 
learning and machine intelligence”, Prentice-Hall, Inc., 
1997 
[6] Shu-Yen Wan and William E. Higgins, Symmetric 
Region Growing, IEEE Transactions on Image 
Processing, vol.12, no. 9, pp. 1007-1015, Sept. 2003 
[7] Advanced Distributed Learning, http://www.adlnet.org 
[8] A. Rosenfeld, “Fuzzy Digital Topology,” Information 
Control, vol. 40, no. 1, pp.76-87, 1979. 
[9] Shu-Yen Wan, Jung-Tai Chen, and Shu-Hung Yeh, 
“Efficient Fuzzy-Connectedness Segmentation Using 
Symmetric Convolution and Adaptive Thresholding,” in 
2004 IEEE International Conference on Image 
Processing (ICIP2004), Oct. 24-27, 2004, Singapore. 
[10] Shu-Hung Yeh, “Study of Medical Image Segmentation 
and implementation base on SCORM standard,” Master 
Thesis, Chang Gung University, Aug. 2004
