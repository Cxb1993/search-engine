中 文 摘 要 
動脈硬化對於人體健康有極大的影響，然而目前動脈硬化的診斷主要在於侵入式的
心導管量測，但相對會造成受測者的諸多不便及危險性；有鑑於此，本計畫目的在於透
過人體資訊的偵測與應用，基於本實驗室既有之動脈血管硬化程度量測儀研發基礎，進
一步提出兩年研究計畫，並著重於以下兩大研究重點: 
(1)設計一應用於動脈硬化程度檢測之脈波特徵點(如：起搏點 pacemaker、主波峰頂點
percussion wave peak、重搏切跡 dicrotic notch與重搏波頂點 dicrotic wave peak)定位系
統，經由準確的脈波特徵點定位演算法可計算出脈波傳導速率、硬化指數與反彈指數
等動脈硬化程度檢測參數，透過這些數據，將可提供醫師在診斷動脈硬化程度上的輔
助。 
(2)自行研製設計乙套嵌入式人體資訊處理作業系統平台系統。先將本實驗室已完成之動
脈硬化量測儀 PC介面由 RS-232改成 USB介面，再加入手持開放式多媒體應用開發
平台，並研究 PC 端與嵌入作業系統平台之間的資料傳輸與誤碼更正，最後嘗試達成
傳輸無線化、系統體積縮小化目標。本計畫預定完成之實作系統擬提供國立成大醫院
與中國醫藥大學進行臨床實驗，以驗證本計畫創新之雙通道脈波量測方式與高準確性
之脈波特徵點定位技術，能有效的達成動脈硬化程度檢測目的。 
關鍵詞：數位容積波、人體資訊、脈波傳導速率、脈波特徵點、開放式多媒體應用開發平
台 
 
第 一 章 緒 論 
 前 言 
由於全球生活水準不斷提昇，醫療科技不斷進步，使全球人口逐漸趨於高齡化，復以
預防觀念亦逐漸興起，未來醫療器材市場將非常可觀。美國商務部預測，2010 年前全球
將產生十大新興醫療器材市場﹐要是由美國、歐洲及日本所主導。另外，根據歐洲醫療
科技協會（European Medical Technology Association, EuroMed）統計，2000年全球醫療器
材市場總值達 1,600億歐元，其中美國市場占 41.5%，歐洲占 24.5%，日本占 15%，其他
地區合計占 19%。而台灣方面，由於快速增加的老化人口，使得心肺疾病、糖尿病、神
經疾病將不斷增多，以及居家自我保健的觀念提昇,還有未來十大新興市場的興起及國內
高齡化社會的來臨，再加上醫療器材產業必需結合微機電技術、通訊技術、材料技術及
生化科技等前瞻技術，融合成已有產業技術，故醫療器材的研究發展是迫在眉睫。 
在臺灣近年來，冠心病案例件數顯著增加，且案例亦有年輕化的趨勢。根據衛生署統
計資料顯示，1963至 1981年間，腦中風皆是台灣地區十大死因之首。而對於診斷心血管
系統疾病的方法，西方醫學科技直至目前為止，可說是琳瑯滿目，舉凡心電圖、血管攝
影術、超音波造影術、侵入式導管血壓波形的量測等方式，皆是相當具有說服力及具科
學的方法，唯其設備都相當昂貴，且常需侵入人體測量，會造成病人不適或感染等諸多
問題；故本計畫主持人及其所帶領之學生團隊共同研發了一套動脈血管硬化程度健康量
測儀，如表 1。目的在於透過人體資訊的應用，提供有心血管疾病的病人使用，以降低就
診不便與縮短時間成本，強調人體資訊應用的重要性，以喚起大眾對於醫療器材研發的
重視。 
表 1  獲獎紀錄與相關成果發布之論文 
獲獎紀錄 
1.作品名稱：紅外線血管硬度健康分析系統 
2003年第三屆旺宏金矽獎：應用組優等獎 
2.作品名稱：脈象訊號手錶 
2003年極限創意教育部全國大專院校創意競賽：非設計組最佳創意獎 
3.作品名稱：雙通道脈波傳導速度量測 
2003年教育部第一屆全國大專院校應用信號處理器技衠專題製作競賽暨國際
名校邀請觀摩競賽榮獲研究生組第一名 
論文發表 
1.“Non-invasive finger pulse measurement system design”, Conference on 
Biomedical Engineering Technology, Kaoshiung I-Show University, D97-99, 2002, 
Dec. 
2.“New System for Detection of Pulse Wave Velocity”, Workshop on Consumer 
Electronics, National Cheng Kung University, Ses. 3-10, 2003, Nov. 
3. "A New Dual Channel Pulse Wave Velocity Measurement System", Fourth IEEE 
Symposium on BioInformatics and BioEngineering, Taichung, Taiwan, pp17-21. 
2004, May. 
4.”A Novel Method for Measurement of Pulse Wave Velocity by Dual-Channel 
Photoplethysmography ”, IEEE International Conference on Biomedical Circuits & 
Systems, Singapore, pp S2.6_8-10. 2004, Dec. 
中。其他在血管內層中的變化還有包括如血管平滑肌增生移行、細胞外間質堆積等。
在血管內層的這些堆積物交互作用及壞死，導致動脈粥狀硬化(Atherosclerotic plaque)
產生，逐漸增大的動脈硬化斑將會破裂。另外由血小板聚集(Aggregation)所引起的血栓
(Thrombosis)，最後則造成臨床上急性心血管疾病或中風的發生[1-4]。人體中大動脈為
發生動脈硬化機率最高的部分，如主動脈、頸動脈等。圖 2 為動脈硬化形成過程之示
意。 
 
圖 2 動脈硬化形成過程 
 
表 2  研究系統架構圖組件功能敘述 
項目 軟體組件名稱 組件功能敘述 
1 脈波波形量化 將連續訊號轉為離散訊號 
2 
FIR數位濾波器 
演算法 利用數位訊號處理去除高頻雜訊使輸入訊號失真更少 
3 
脈波特徵點定位 
演算法 
由一階與二階導函數方式，定位出標準脈波波形之主波
峰頂點與重博波(反彈波)頂點。 
4 
血管硬化指數 
演算法 
利用二波峰頂點之時間差及高度比值，求得血管硬化指
數 (Stiffness Index , SI)與脈波反彈指數 (Reflection 
Index , RI)。 
5 
嵌入式作業系統 
設計 
配合嵌入式系統硬體，自行撰寫應用程式及相關硬體驅
動程式界面(Application Program Interface,API) 
6 
軟體通訊協定 
演算法 
設計一通訊協定做為嵌入式作業系統與PC端資料庫系
統間資料傳遞及控制 
7 
PC端資料庫系統 
設計 
自行設計 PC端使用使用者介面及資料庫系統，可依醫
生或使用者喜好設計。 
 
項目 硬體組件名稱 組件功能敘述 
1 
四階 Butterworth 
濾波器設計 使用 Butterworth濾波器受鏈波影響最小 
2 
類比轉數位訊號 
電路設計 
將接收到的類比訊號 
連接到 DSP數位訊號處理器 
3 
DSP數位訊號處理器 
電路設計 整合不同輸出入裝置搭配 DSP數位訊號處理器 
4 USB 介面電路設計 使用 USB介面連接嵌入式裝置與訊號輸入裝置 
5 
OMAP-嵌入式系統 
硬體平台設計 整合個種輸出入裝置於 OMAP嵌入式平台上 
6 
無線通訊發射 / 接收 
模組設計 
設計一無線發射模組搭配 OMAP嵌入式平台 
設計一無線接收模組搭配 PC處理平台 
7 
無線模組結合PC端 
通訊界面電路設計 設計無線接收模組與 PC傳輸介面 
 
項目 組件名稱 組件功能敘述 
1 
軟體、硬體 
系統整合 將所有軟體、硬體做系統整合並測試穩定度 
2 
嵌入式 
人體資訊處理平台 
實現 
研發 
嵌入式人體資訊處理平台完成 
 
 
本論文實作系統經國立成大醫院所進行臨床實驗證實，確實能以簡易創新之雙通道脈
波量測方式與高準確性之脈波特徵點定位技術，達到有效的動脈硬化程度檢測目的。 
 
本計畫
自由軟體
技術
軟 / 硬體技術 硬體技術
軟 / 硬體技術 誇領域學習技術
軟體技術軟 / 硬體技術
USB介面技術
無線傳輸技術
開放式多媒體
應用平台技術
醫師
專業知識
SMD電路板
縮小化技術
 
圖 5 本計畫技術研發產出示意圖 
 
 
表 4  上圖組件功能敘述 
項目 組件名稱 組件功能敘述 
1 本計畫 嵌入式人體資訊處理平台實現 
2 USB介面技術 藉由本計畫可學習 USB介面技術，使用 USB介面將可使裝置間的溝通更加便利應用更為廣泛。 
3 無線傳輸技術 無線傳輸技術可學習資料的編碼、解碼、除錯及資料壓縮技術，使用無線技術可增加產品使用上的便利性。 
4 
開放式 
多媒體應用平台技術 
多媒體應用平台技術整合無線通訊及影像處理，遵循自
由軟體設計規範，將使平台資源共享於開放式架構下。
5 
SMD電路板 
縮小化技術 
使用 SMD電子零件可將成品體積縮小 3倍以上，利用
此技術將增加產品攜帶便利性及實用性。 
6 醫師專業知識 
整合不同知識領域人員，藉由醫師專業知識結合資訊工
程人員實作精神，整合不同技術及知識，將理論得以實
現及驗證。 
7 自由軟體技術 
自由軟體技術主張所開發軟體可資源共享並可流通於
國際間，軟體開發人員可由本計畫學習自由軟體設計技
術及相關軟體技術搜尋。 
 
31. 吳賢財、謝文哲、林榮三等著，”省電型 16 位元單晶片 MSP430 入門實務”，滄海書
局，2003。 
32. 林傳生編著，”Matlab之使用與應用”，儒林出版社，2003。 
33. 蒙以正著，”以 Matlab透視 DSP”，碁峰資訊股份有限公司，1999。 
34. 張智星著，”Matlab程式設計與應用”，清蔚科技股份有限公司，2000。 
35. 沈明來編著，”生物統計學入門”，九州圖書文物有限公司，2001。 
36. 汪叔遊等著，”中醫脈診脈象圖形化之研究（一）”，科學發展月刊，5(8)，688:697，
1977。 
37. 汪叔遊等著，”中醫脈診脈象圖形化之研究（二）”，科學發展月刊，6(9)，94:109，
1978。 
38. 魏凌雲，”針灸科學與技術”，中華出版社，台北，1987。 
39. W.K. Wang, Y.Y. Lo, Y. Chieng, T.L. Hsu and Y.Y. Wang Lin, “Resonance of Organs 
with the Heart, Advances in Biomed. Eng”, Washington, DC:Hemispere, (in press), 1988. 
40. Y.K. Chen, H.T. Wu, C.K. Chi, W.C. Tsai, J.Y. Chen and M.C. Wang, “A New Dual 
Channel Pulse Wave Velocity Measurement System”, 4th IEEE Bioinformatics and 
Bioengineering, 17-21, 2004. 
41. 黃世林、孫明異等著，”中醫脈象研究”，人民衛生出版社，1995。 
42. 王傳禎，”脈搏訊號之時頻域分析”，碩士論文，台灣大學機械工程研究所，2001。 
43. 賈元勳，”使用離散小波轉換特徵的心電圖病症辨識系統”，碩士論文，中正大學電機
工程研究所，2002。 
圖 10  Innovator™ Development Kit for the Texas Instruments OMAP™ Platform 
 
德州儀器公司提供所有相關軟硬體設備的訓練課程，台灣區目前以開設 C55x 
Workshop、C54xWorkshop 、C6x Workshop、DSP/BIOS Workshop、OMAP™ Design 
Workshop 等高級實用課程。本計畫主持人實驗室已派學生接受 C55x、DSP/BIOS 及
OMAP™等相關專業課程訓練，可說是已具備本計畫執行能力。 
 
OMAP硬體架構 
第 一 章Dual core Processors 
OMAP5910包含了一顆 32 bit RISC 架構的 TIARM 925T MCU(Micro Control Unit)，
及一顆 TMS320C55x DSP(Digital Signal Processor)，如圖 11。 
 
圖 11 OMAP™ Processor architechture 
表 10  Core Processors feature 
 
Numerous communication interface 
UART、USB、GPIO、IrDA、McBSP、Camera Interface、LCD control、MMC、SD  
Full support popular OS 
支援市面上大多數的嵌入式作業系統  
 WinCE3.0、WinCE .NET 
 Linux 
 Symbian  
 Palm  
 Nucleus 
ARM 925 TMS320C 55X 
z 32/16bit instruction set 
z 8k bytes D-Cache 
z 16k bytes I-Cache 
z MMU 
z 24kB I-Cache 
z 1 Program/5 Data bus  
z 2 Multiply per cycle 
z 64k bytes Dual access RAM 
z 96k bytes Single access RAM 
z 32k bytes on chip ROM 
z hardwar accelerator 
動脈硬化程度檢測之脈波特徵點定位演算法 
主波峰頂點偵測 
主波峰頂點為單一週期波中的最高峰，係由心臟收縮的壓力直接傳導至量測端所形
成，反映了心臟收縮時，大量血液唧射入動脈，管內壓力迅速上升，管壁急速擴張下，
動脈內容積與血流量的最大值，其生理關係與心電圖的 R波類似，故於數位容積波中成
為最具代表性之特徵點。本研究所提出的主波峰頂點定位法則包含有平滑處理、微分運
算及二階段動態閥值調整等三個程序，如圖 14所示。 
 
 
 
 
圖 14 主波峰頂點定位法則方塊圖 
（1）平滑處理 
雖然 200Hz的訊號擷取頻率，可觀察出訊號中的細微變化部分，不過對於後續訊號的
微分運算，可能會因為這些過於細微的變化，而造成突波的產生，增加分析上的困擾。
因此，於微分之前先對訊號做平滑處理，採用五點取樣點平均的算法，以方程式[ 1 ]來實
現。 
( ) ( ) ( ) ( )[ ]4...1
5
1
0001 +++++= nxnxnxnx ，         [ 1 ] 
（2）微分運算 
因主波峰為脈波訊號之最大振幅波，同理可知，波峰形成前的上升階段亦為訊號中變
化最大的部分，故以一階微分方程式對其運算，如方程式[ 2 ]所示，將可描繪出脈波訊號
中斜率變化最大的位置。 
( ) ( ) ( )[ ]10
10
1
11 +−= nxnxnyP ，             [ 2 ] 
（3）二階段動態閥值調整 
由於每位受測者的脈波訊號振幅都不盡相同，即使是同一個受測者於不同的時間下量
測，其振幅也會有所差異，所以必須利用適應性的動態閥值調整，針對各種不同振幅的
波形做適當的變化，如此才不致於發生特徵點定位誤判或遺漏的現象。經平滑處理與微
分後的訊號，只要透過適應性的動態閥值設定，便可定位出主波峰頂點的位置，如圖 15 主
波峰頂點定位機制圖所示。首先，對微分後的訊號數列 ( )ny p ，執行由小至大的排序整理
( )( )nysort P ，再取其後一百點的平均值，作為第一階閥值，如方程式[ 3 ]所示： 
DVP 訊號 
[ ]
dt
d[ ]∑
55
1
 
0 200 400 600 800 1000 1200 1400 1600 1800 2000
0.4
0.6
0.8 (a)
0 200 400 600 800 1000 1200 1400 1600 1800 2000
-5
0
5
10
x 10
-3
A
m
pl
itu
de
(V
)
(b)
0 200 400 600 800 1000 1200 1400 1600 1800 2000
-5
0
5
x 10-4
time in sapmles
(c)
 
圖 16 不規則脈波及其微分圖（a）原始脈波 
（b）一階微分波形（c）二階微分波形 
 
因此，本研究藉由小波轉換可對脈波訊號做不同頻率的分析，具有探測脈波訊號局部
變化平緩或劇烈程度的特性，針對重搏切跡的頻率作偵測，進一步定位出重搏波頂點。
主要的分析法則有鏡射（reflect）、小波轉換、階數判斷、微分及重搏波定位等五個部分，
如圖 17所示，茲針對各分析過程做如下說明。 
 
 
 
 
 
圖 17 重搏波頂點定位法則方塊圖 
（1）鏡射 
因為小波轉換的多層解析空間理論，其階梯函數的逼近能力是 ⎟⎠
⎞⎜⎝
⎛Ο j2
1 。j為階數，假若
輸入訊號的長度（本系統原始為 1000點）並非正好是 2的整數次方，如此將會增加小波
轉換時的複雜性，因此我們於小波轉換前，以鏡射的方式將訊號長度延展至 2的整數次
方（1024點），鏡射實現方式如圖 18 所示，之後便可開始做小波轉換。 
DVP 訊號
並將各矩陣擴展開來，可得： 
=> 
1212
3
2
1
0
2210
10
10
3210
3210
1212
12
1
1
0
0
2
1
1
1
×−×
×−
− ⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎦
⎤
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎣
⎡
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎦
⎤
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎣
⎡
=
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢
⎣
⎡
−
−
jjjj
jj
j v
v
v
v
v
cc
dd
cc
dddd
cccc
w
u
w
u
w
u
MM
LL
LL
LL
LL
M
 
方程式[ 6 ]中，C為濾波器係數矩陣，v為輸入訊號向量，則 U矩陣即為小波分解後
的結果。但此演算法則尚存在著一個問題，那就是係數矩陣的最後幾列並不能按照這種
每列向右邊移兩項的方式構成，原因為非零係數 kc 會落到矩陣的邊界外面，例如 C的最
後三列形式如下： 
765432
7654
76
10
3210
543210
cccccc
cccc
cc
cc
cccc
cccccc
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢
⎣
⎡
 
這些落在矩陣邊界外的係數，對應於式（5）中 k+2n超出 0,…., 12 −j 範圍的 nkv 2+ ，所
以必須對係數矩陣做週期化的動作。其方法為某一列的非零係數落到矩陣的邊界外面
時，把它們折回來放到此列向量的前面，如此 C的最後三列將變成如下形式： 
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢
⎣
⎡
10765432
32107654
54321076
cccccccc
cccccccc
cccccccc
 
在程式實現上，我們把濾波器係數分為低頻係數向量 c[k]與高頻係數向量 d[k]，並將
輸入訊號（v[n]）的第 1筆數值至第 k-2筆數值，銜接於最後一筆輸入訊號之後，則可等
同濾波器係數矩陣的週期化動作；接著將低頻係數向量乘上輸入訊號便可得到低頻分量
（
2
nu ），而把高頻係數向量乘上輸入訊號則可得到高頻分量（
2
nw ），執行完 j2 筆資料運
算後，只要將 u儲存在 v的上半段，而 w儲存在 v的下半段，若要往下分解，就把 j換
成 j-1，v換成 u，即可再做一次小波分解，依此類推，直至最低階，整體的小波轉換程式
流程如圖 20 所示。在分解階數的限制上，因為輸入訊號的個數不能小於係數個數，否則
會導致運算錯誤，本研究輸入訊號長度為 1024點，故可由 j=log2(length(x1[n]))=10分解至
j=4階，最後再把每一次分解後的高頻分量（w）擴展至原始輸入個數的 1024點，如圖
21所示。 
 
 
 
 
由圖 21的觀察中，可以發現每一次的小波分解都能得到不同的結果，這是因為每經
歷一次的分解，小波函數的時間尺度就會增大，但頻濾範圍卻會因此縮小，例如第 10階
分解至第 9階後，小波函數由原始的中心頻率 100Hz、頻寬 200Hz，變成中心頻率 50Hz、
頻寬 100Hz，再一次的分解，中心頻率與頻寬便再相對的減半，如圖 22 所示。 
 
 
 
 
 
 
 
（a）                               （b） 
圖 22 （a）小波函數的脹縮（b）相對應的小波函數頻譜 
 
因此，透過每一次的小波分解，頻率探測範圍相應的縮小，便可觀察脈波訊號於不同
的頻率下，其較高頻率（相對於 1~2Hz低頻）的訊號分佈情況，故小波轉換具有在連續
數次的分解後，能以高頻分量（w）的較大值來找出訊號中短時間內發生急遽變化位置的
特性。利用此特性，我們每次都以連續二個階數（ j2 與 12 −j ）的分解來作判斷，並在每一
階的分解後，設定一個新的判斷閥值，而高頻分量（w）必須大於此判斷閥值（較大值），
才能保留否則設定為 0；此判斷閥值如式（7）所示： 
jWthreshold max5.03 ×= ，                 [ 7 ] 
其中，0.5為本研究依經驗所得之數據， jW 代表第 j階時所有高頻分量的集合。接下
來我們先後比較經閥值判斷後，兩階數各週期中高頻分量之數目及位置，若每個週期中
的高頻分量數目比較相差在 1個（ 1± ）範圍內，且每個週期中的高頻分量位置相差於 20
個取樣點（ s1.0± ）之內，則代表此兩階數之高頻分量能有效表現出重搏切跡的位置，也
代表了重搏切跡之頻率介於此兩階數的探測範圍附近；經實際分析後發現，此兩階數分
別為第 7階及第 6階，如圖 23 所示。相反的，若各週期中高頻分量的數目及位置兩條件
有一不符，則再往下判斷二個階數，依此類推直至最低限制階數（j=4）為止；隨後，將
符合條件的兩階數高頻分量合併，並依據實際分析經驗，同一週期中若有 2個高頻成分，
則取第二個高頻成分（較接近重搏切跡或重搏波），而若於一週期中無任何高頻成分，則
以前一週期的高頻成分加上週期數來替補，如此即完成重搏切跡附近區域之偵測目的。
整體的小波階數判斷軟體流程如圖 24所示。 
 
 
( (
（4）微分 
因合併後之高頻成分尚未能定位出重搏切跡的真正位置，必須針對高頻成分所在位置
往後的脈波資料，進行微分運算，並利用斜率變化量的判斷，來定位出重搏切跡與重搏
波的真正位置。微分運算以方程式[ 8 ]來實現，其中 n的起始數值（ 1n ）為每一週期的高
頻成分位置。 
( ) ( ) ( )[ ]10
10
1
11 +−= nxnxnyd ，                 [ 8 ] 
（5）重搏切跡與重搏波定位 
由於構成重搏波前的凹陷處即為重搏切跡，因此只要能找出重搏切跡的位置，便可定
位出重搏波頂點。然而，合併後的高頻分量，其位置只能接近於重搏切跡但並非重搏切
跡的真正位置，故需使用微分運算針對高頻分量的位置進行分類，再由各分類中定位出
重搏切跡與重搏波頂點。依據脈波的波形，本研究以微分後的數值將高頻分量位置分為
三類，並搭配圖 25作說明： 
a. 第一種情況， ( ) 01 >nyd ： ( )1nyd 為高頻分量位置的脈波資料與其後 10點資料的斜率
值。若大於零，代表高頻分量位於位置 1（如圖 25（a）），此位置在重搏切跡及重搏波
之前，因此繼續往下做微分運算，當微分運算值小於或等於零時（ ( ) 0≤nyd ），找出其
中 10點最小值，即為重搏切跡（如圖 25（a）虛線處）；接著再由重搏切跡位置往後進
行微分運算（同方程式[ 8 ]），當微分值大於零時，找出其中 10點最大值，即為重搏波
頂點（如圖 25（b）虛線處）。 
b. 第二種情況， ( ) 01 ≤nyd ：代表高頻成分位於位置 2（如圖 25（c）），此位置可能在重
搏切跡之前或之後，因此首先往前 20個取樣點（ 2011 −= nn ）做微分運算（參照方程
式[ 8 ]），當微分值大於零時，找出其中 20點最小值，即為重搏切跡（如圖 25（c）虛
線處）；接著再由重搏切跡往後進行微分運算（同方程式[ 8 ]），當微分值大於零時，找
出其中 10點最大值，即為重搏波頂點（如圖 25（d）虛線處）。 
c. 第三種情況主要受限於波形的影響，由圖 25（e）中可發現此種波形之重搏切跡並非凹
陷狀而是呈現平滑落下的狀態且重搏波亦不明顯，屬於較難判斷之種類。其 ( ) 01 >nyd 且
往後之微分值都是大於零的狀態，所以我們設定一個點數的限制閥值，若超過高頻成
分位置後 40點（ 401 +n ），微分數值仍是固定保持大於零的狀態，則尋找之前所做微
分數值中的最小值，即為此段訊號中較平滑處，亦為有發生微小變化之處，並定位此
點為重搏切跡，而其後五點則為重搏波頂點（如圖 25（e）虛線處）。 
 
 
 
 
 
 
醫療分析軟體開發 
醫療分析軟體開發[12-14]是一件非常浩大的工程，難度在於要了解硬體之間的溝通方
式，及溝通的方法模組化，例如：記憶體的配置，傳輸介面的協定及開發後的除錯動作。
完成系統開發後，開發者可以很輕易的編輯相關的應用程式，像是記事本、瀏覽器、java
應用紅外線同步傳輸[15]等等，不需在乎硬體之間的溝通方式，因為作業系統已經將硬體
的溝通方式模組化，形成一個類似函式庫的觀念，使用者要做的事只需呼叫函式庫，依
照公定函式庫的模式設定硬體(例如 UART、USB、IrDA 等等)使用者不需自行配置記憶
體，也不用在乎資料傳輸方式的不同，只要呼叫函式庫，設定模式，接下來就等函式庫
將週邊硬體所傳回來的資料重新封包，傳回資料，縮短程式的開發時間，也減少開發嵌
入式系統的困難度。在這種種有力的因素下，自由軟體的風氣才能從個人電腦衍生至嵌
入式系統上，促進自由軟體的風氣。本計畫初步研發系統雛型，請參考圖 26。 
 
 
圖 26 系統雛型 
系統整合等三個階段進行 
在軟硬體整合之後，最後一步就是測試整合度。冗長的程式碼，以及眾多的週邊，在
控制的時候容易發生錯誤，因此最後還要進一步偵錯，德州儀器公司提供了一個整合性
軟體開發套件 CCS(code composer studio)，可以單獨軟體模擬程式，也可以利用 ACE 
JTAG(Softronics 公司)，作硬體模擬，使得開發出來的程式碼更為完整，最後本計畫將整
合實現嵌入式脈波醫療系統，作為本計畫之驗證依據。 
 
 
人體資訊處理平台
（四）完成之工作項目及成果 
4.1 第一年計畫工作進度及成果 
z 將本實驗室已完成之動脈硬化量測儀 PC介面由 RS-232改成 USB介面 
z 熟悉MasterIA OMAP EVM開發平台 
z 將嵌入作業系統載入至開發平台上 
z 探討有線傳輸能力最佳化 
z 熟悉嵌入作業系統指令語法、系統環境及配置 
z PC端與嵌入作業系統平台使用有線傳輸方式傳送資料 
z PC端與嵌入作業系統平台之間的資料傳輸與誤碼更正 
z 人體資訊處理原理與實現 
z 後端人體資訊處理軟體分析程式設計 
z 圖 35第一階段系統方塊圖 
 
 
圖 35 第一階段系統方塊圖 
 圖 36 第二階段系統方塊圖 
 
表 23  第二階段系統架構組件功能敘述 
項目 組件名稱 組件功能敘述 
1 受測者 通常為病人，量測時須平躺於床上並放鬆心情 
2 紅外線感應器測試線 一組由二條測試線所組成，每一條測試線包含一個紅外線發射器及一個紅外線接收器 
3 動脈硬化量測儀 主要做為人體資訊處理平台並將資料運算後傳送至PDA / PC端 
4 資料傳輸 可使用 RS-232、USB或 PC MCIA等 I/O介面送資料 
5 PDA 主要為人體資訊平台顯示及功能輸入及輸出 
6 無線傳輸 使用無線傳輸方式將資料由 PDA傳送至 PC 
7 儀器操作人員 通常為醫護人員 
8 資料分析伺服器 
可收集 PDA傳送之資訊，將大量資料儲存於 HD內，
日後可藉由資料庫分析系統，分析出可用資訊提供給醫
護人員參考。 
