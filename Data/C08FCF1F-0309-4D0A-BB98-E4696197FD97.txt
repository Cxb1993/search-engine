thermal field embedded with complex solid object is 
also proposed. The viscous dissipation 
rate is obtained by computing the second-order 
moments of non-equilibrium distribution 
function, which avoids the discretization of the 
complex gradient term, and can be easily 
implemented. The present formulation is scrutinized 
by computing 2D and 3D flows to 
assess its capability. The order of accuracy of the 
present method is also examined by 
comparing with existing analytical solutions. 
Finally, natural convection in a square cavity 
will be used to evaluate the thermal and fluid 
interaction capability. 
英文關鍵詞： thermal lattice Boltzmann method, accurate boundary 
condition, complex geometry, viscous heat dissipation
 
2 Report submitted to National Science Council 2013-07-31
1 Introduction
Explicit, easy to implement, and natural to parallelize are the major advantages of
Lattice Boltzmann method (LBM), which has been successfully applied to vari-
ous isothermal hydrodynamic and engineering problems [Yu, Mei, Luo, and Shyy
(2003); Chen, Chang, and Sun (2007); Han, Feng, and Owen (2007); Mishra, Paik,
and Atluri (2009)]. However, its direct extension to the thermal flows is not straight-
forward, because of the numerical instability for thermal models [McNamara, Gar-
cia, and Alder (1995)]. In general, the thermal lattice Boltzmann model (TLBM)
can be categorized into two types [He, Chen, and Doolen (1998)]. The first one is
the multi-speed approach and the second one is the passive scalar model. The multi-
speed approach is a straightforward extension of the lattice Boltzmann isothermal
models in which only the density distribution function is used. On the other hand,
the passive scalar approach utilizes the fact that the macroscopic temperature satis-
fies the same evolution equation as a passive scalar, which is advected by the flow
velocity but does not affect the flow fields. The major advantage of the passive
scalar model over the multi-speed approach is the enhancement of the numerical
stability and is thus commonly adopted.
In the passive scalar thermal lattice Boltzmann models, a separate distribution func-
tion is used to solve for the temperature distribution and the distribution function
may be similar to its hydrodynamic counterpart[Shi, Zhao, and Guo (2004); Li, He,
Wang, and Tang (2008)] or different [He, Chen, and Doolen (1998); Peng, Shu,
and Chew (2003); Tang, Tao, and He (2005)]. For example, a double-distribution-
function model was proposed by He, Chen, and Doolen (1998). This model has
a better numerical stability than the multispeed approach, and the viscous heat
dissipation and compression work done by the pressure can be solved implicitly.
However, the major drawback of this thermal model is the complex discretization
to obtain the viscous dissipation rate, which includes a complicated gradient term
involving temporal and spatial derivatives of the macroscopic flow variables. An-
other thermal model with viscous dissipation rate was proposed by Shi, Zhao, and
Guo (2004), however complex discretization of the velocity gradient is still needed.
To model the incompressible thermal flows without viscous heat dissipation, Peng,
Shu, and Chew (2003) proposed a simplified thermal lattice Boltzmann model,
where the complicated gradient term in this model is neglected. However, Li, He,
Wang, and Tang (2008) indicated that this direct neglecting of the gradient term
may affect the original conduction equation. To overcome this, Li, He, Wang,
and Tang (2008) proposed an improved thermal lattice Boltzmann model for flows
without viscous heat dissipation and compression work. Based on the work of He,
Chen, and Doolen (1998), Tian, Zuo, Liu, Liu, Guo, and Zheng (2006) proposed a
simpler implementation of the viscous dissipation term. However, the second order
4 Report submitted to National Science Council 2013-07-31
the force is discretized using the simple forward difference scheme as,
∂Fi(~x, t)
∂ t
= [Fi(~x, t)−Fi(~x, t−4t)]/4t (3)
The term Fi represents the effect of viscous heating and Fi can be determined by
[Deng, Shi, and Wang (2005)],
Fi = ωi
Φ
cv
[1+
~ei ·~u
C2s
τg−1/2
τg
] (4)
cv is the specific heat at constant volume. The viscous heating term Φ can be
expressed as follows:
Φ= 2µSαβSαβ −
2µ
3
(5·~u)2 (5)
where the strain rate tensor Sαβ can be defined as:
Sαβ =
1
2
(
∂uα
∂xβ
+
∂uβ
∂xα
)
Sαβ can be expressed by the momentum fluxes Qαβ , which can be obtained by
computing the second-order moments of non-euilibrium distribution function [Hou,
Sterling, Chen, and Doolen (1996)].
Sαβ =
−1
2ρC2s τ
Qαβ ,Qαβ = ∑
i
eiαeiβ ( fi− f eqi ) (6)
The macroscopic variables can be evaluated as the moment of the distribution func-
tion:
∑
i
fieq = ρ (7)
∑
i
~eiα f
eq
i = ρ~u (8)
∑
i
gieq = ρT (9)
∑
i
eiαgieq = ρuαT (10)
∑
i
eiαeiβg
eq
i = ρuαuβT +C
2
s ρTδi j (11)
6 Report submitted to National Science Council 2013-07-31
and f8 = f ∗8 +ω8(Qx−Qy). Therefore, the macroscopic velocity and density at the
node using Eqs. 7 and 8, in conjunction with Eq. 15, can be expressed as,
ρ = f0+ f1+ f2+ f3+( f ∗4 −ω4Qy)+ f5+ f6
+ [ f ∗7 −ω7(Qx+Qy)]+ [ f ∗8 +ω8(Qx−Qy)] (16)
ρu = f1+ f5+[ f ∗8 +ω8(Qx−Qy)]− f3− f6− [ f ∗7 −ω7(Qx+Qy)] (17)
ρv = f2+ f5+ f6− ( f ∗4 −ω4Qy)
− [ f ∗7 −ω7(Qx+Qy)]− [ f ∗8 +ω8(Qx−Qy)] (18)
If velocities u and v are known at the boundary, Eq. 16 to 18 can be used to
solve for ρ , Qx, and Qy, and then f4, f7, and f8 are obtained. For simplicity,
f ∗p(~x,~ep, t) = fp(~x,−~ep, t) are adopted. The explicit forms of the unknown particle
density distribution functions are shown as below.
ρ =
1
1+ v
[ f0+ f1+ f3+2( f2+ f5+ f6)]
f4 = f2− 23ρv
f7 = f5+
1
2
( f1− f3)− 12ρu−
1
6
ρv
f8 = f6− 12( f1− f3)+
1
2
ρu− 1
6
ρv (19)
For boundary does not coincide with the lattices, special treatment has to be taken
to model the solid-fluid boundary, such as those in [Chen, Lin, and Lin (2007)]
and [Yang, Chang, and Lin (2009)], which are based on the immersed boundary
methods in [Su, Lai, and Lin (2007)] and [Liao, Chang, Lin, and McDonough
(2010)], respectively.
3.2 Thermal boundary conditions
Here, similar to its hydrodynamic counterpart, a consistent thermal boundary con-
dition is introduced [Liu, Lin, Mai, and Lin (2010)]. The unknown particle energy
distribution function at the plane boundary is assumed to be,
gp(~x,~ep, t) = g∗p(~x,~ep, t)+ωpGc (20)
where Gc is the correction to enforce the internal energy.
For instance, consider a node at the top boundary as shown in Fig. 1, where the
unknown particle energy distribution functions are (g4, g7, g8) and (g4, g8, g9, g12,
8 Report submitted to National Science Council 2013-07-31
g14) are obtained for D2Q9 and D3Q19 models. The explicit forms of the unknown
particle energy distribution functions are shown below.
For the D2Q9 model,
T ∗ =
1
ρ
(g0+g1+g2+g3+g∗4+g5+g6+g
∗
7+g
∗
8)
g4 = g∗4+
2
3
ρ(T −T ∗)
g7 = g∗7+
1
6
ρ(T −T ∗)
g8 = g∗8+
1
6
ρ(T −T ∗) (27)
For the D3Q19 model,
T ∗ =
1
ρ
(g0+g1+g2+g3+g∗4+g5+g6+g7+g
∗
8+g
∗
9+g10
+ g11+g∗12+g13+g
∗
14+g15+g16+g17+g18)
g4 = g∗4+
1
3
ρ(T −T ∗)
g8 = g∗8+
1
6
ρ(T −T ∗)
g9 = g∗9+
1
6
ρ(T −T ∗)
g12 = g∗12+
1
6
ρ(T −T ∗)
g14 = g∗14+
1
6
ρ(T −T ∗) (28)
For simplicity, the formulation of g∗p = g
eq
p (~x,~ep, t) is adopted here. Other forms
have been explored such as, g∗p(~x,~ep, t)= gp(~x,−~ep, t) and g∗p(~x,~ep, t)= gp(~x,~ep, t−
4t), and influences were found to be marginal on the predicted results as shown in
Liu, Lin, Mai, and Lin (2010).
4 Numerical results
4.1 2-D thermal Poiseuille flow
Fully developed flow in a channel is a typical case to examine the accuracy of
boundary conditions. Here, the two-dimensional Poiseuille flow with constant wall
temperature Tt is considered. The Reynolds number is defined as Re =U0H/ν in
a channel of height H, and U0 is the maximum velocity. The effect of viscous heat
10 Report submitted to National Science Council 2013-07-31
(T-Tb)/(Tt-Tb)
Y
/H
0 0.3 0.6 0.9 1.2 1.5 1.80
0.2
0.4
0.6
0.8
1
Exact Br=5 Pr=0.7
Present Br=5 Pr=0.7
Exact Br=10 Pr=0.7
Present Br=10 Pr=0.7
Figure 4: The temperature profiles of
2-D Couette flow with Re= 10, 5×41
grid, and τ f = 0.9.
Grid Size
Er
ro
r
0.01 0.02 0.03 0.04 0.05
10-7
10-6
10-5
2nd order accuracy Br=5 Pr=0.7
Present Br=5 Pr=0.7
2nd order accuracy Br=10 Pr=0.7
Present Br=10 Pr=0.7
Figure 5: Maximum predicted tem-
perature relative errors of 2-D Couette
flow.
temperature Tb. The Reynolds number is defined as Re = UtH/ν in a channel
of height H. The major control parameters are the Prandtl number and the Eckert
number Ec=U2t /(Cv4T ), where4T is the temperature difference between the hot
and cold walls. The effect of viscous heat dissipation is controlled by the Brinkman
number Br = PrEc. The analytical solution for this temperature field is expressed
as,
Texact(y) = Tb+
y
H
[1+0.5Br(1− y
H
)]4T (31)
Velocity boundary conditions and the proposed Dirichlet thermal boundary condi-
tions are applied along the channel walls, and the periodic boundary condition is
applied at the inlet and outlet. Fig. 4 shows the temperature profiles in compar-
ison with the analytic solution for different Brinkman numbers while the Prandtl
number is fixed. Five different lattice densities in the y direction are adopted, (21,
41, 81, 161, and 321), to determine the convergence rate in space. To examine the
convergence, Eq. 30 is also used to determine the maximum relative error using
different lattices. Fig. 5 shows the predicted results and the second-order accuracy
is achieved.
4.3 3-D thermal Poiseuille flow in a square duct
Here, the capability of the proposed thermal boundary conditions to model 3-D
problems is examined. A pressure driven 3-D square duct flow with constant wall
12 Report submitted to National Science Council 2013-07-31
Y
U
0 0.0005 0.001 0.0015 0.002-1
-0.5
0
0.5
1
Figure 8: The velocity profiles of 3-D
Poiseuille flow in a square duct along
the vertical wall bisectors at x/L =
0.5..
T
Y
0 2E-07 4E-07 6E-07 8E-07 1E-06-1
-0.5
0
0.5
1
Figure 9: The temperature profiles of
3-D Poiseuille flow in a square duct
along the vertical wall bisectors at
x/L= 0.5..
Avila (2009); Liu, Lin, Mai, and Lin (2010)]. Here, focus is directed to the natu-
ral convection in a square cavity, where the flow is driven by the buoyancy force
due to the differential temperature of the sidewalls. The left wall is at the higher
uniform temperature Tl and the right wall is at the lower uniform temperature Tr.
Both the top and bottom walls are adiabatic. With the Boussinesq approximation,
the buoyancy term is assumed to depend linearly on the temperature as,
ρ~G= ρβg(T −Tm)~j (32)
where β is the thermal expansion coefficient, g is the acceleration due to gravity,
Tm = (Tl+Tr)/2 is the average temperature, and ~j is the vertical direction opposite
to that of gravity. To account for this Buoyancy induced force, an extra forcing
term Fi is added to Eq. 1 and is expressed as [He, Zou, Luo, and Dembo (1997)],
Fi = 3ωi
~G ·~ei
C
(33)
The major control parameter is the Rayleigh number Ra = βg4TH3Pr/ν2 asso-
ciated with the heat transfer within the fluid, where H is the height or width of the
cavity. For the Rayleigh number investigated, the influence of the viscous dissipa-
tion is negligible. However, the present section serves to examine the applicability
of the present thermal model under such conditions by comparing with previous
14 Report submitted to National Science Council 2013-07-31
(b) Ra=104
(d) Ra=106(c) Ra=105
(a) Ra=103
Figure 10: The streamline profiles of
2-D natural convection in a square
cavity.
(d) Ra=106(c) Ra=105
(b) Ra=104(a) Ra=103
Figure 11: The isotherm profiles of 2-
D natural convection in a square cav-
ity.
5 Conclusion
A thermal BGK lattice Boltzmann model for flows with viscous heat dissipation is
proposed, where a separate distribution function is adopted to solve for the tem-
perature field. The thermal lattice Boltzmann equation is modeled through the
convection-diffusion equation with a viscous dissipation source term, and the tem-
perature is regarded as a scalar quantity. Proposed thermal equilibrium distribu-
tion function is similar to its hydrodynamic counterpart, except that the leading
quantity is temperature. The viscous dissipation rate is obtained by computing
the second-order moments of non-equilibrium distribution function, which avoids
the discretization of the complex gradient term, and can be easily implemented.
The proposed thermal lattice Boltzmann model is scrutinized by computing two-
dimensional thermal Poiseuille flow, thermal Couette flow, natural convection in
a square cavity, and three-dimensional thermal Poiseuille flow in a square duct.
Numerical simulations indicate that the second order accurate LBM scheme is not
degraded by the present thermal BGK lattice Boltzmann model. Also, the pre-
dicted natural convection results compare favorably with the existing benchmark
solutions.
16 Report submitted to National Science Council 2013-07-31
automata. In: Lawniczak AT, Kapral R, editors Pattern formation and lattice gas
automata. Fields Inst Commu, vol. 6, pp. 151–166.
Hwang, C. B.; Lin, C. A. (1999): A low Reynolds number two-equation kθ -ε˜θ
model to predict thermal fields. International Journal of Heat and Mass Transfer,
vol. 42, no. 17, pp. 3217–3230.
Hwang, C. B.; Lin, C. A. (2000): Low-Reynolds number k-ε˜ modelling of flows
with transpiration. International Journal of Numerical Methods in Fluids, vol. 32,
no. 5, pp. 495–514.
Li, Q.; He, Y. L.; Wang, Y.; Tang, G. H. (2008): An improved thermal lattice
Boltzmann model for flows without viscous heat dissipation and compression work.
Int. J. Mod. Phys. C, vol. 19, pp. 125–150.
Liao, C. C.; Chang, Y. W.; Lin, C. A.; McDonough, J. M. (2010): Simulating
flows with moving rigid boundary using immersed-boundary method. Computers
& Fluids, vol. 39, no. 1, pp. 152–167.
Liu, C. H.; Lin, K. H.; Mai, H. C.; Lin, C. A. (2010): Thermal boundary
conditions for thermal Lattice Boltzmann simulations. Computers & Mathematics
with Applications, vol. 59, no. 7, pp. 2178–2193.
McNamara, G. R.; Garcia, A. L.; Alder, B. J. (1995): Stabilization of thermal
lattice Boltzmann models. J. Stat. Phys., vol. 81, pp. 395–408.
Mishra, S. K.; Paik, J. K.; Atluri, S. N. (2009): Modeling of the Inhibition-
Mechanism Triggered by ’Smartly’ Sensed Interfacial Stress Corrosion and Crack-
ing. CMES: Computer Modeling in Engineering & Sciences, vol. 50, no. 1, pp.
67–96.
Nicolas, A.; Bermudez, B.; Baez, E. (2009): Effects of the Rayleigh Number and
the Aspect Ratio on 2D Natural Convection Flows. CMES: Computer Modeling in
Engineering & Sciences, vol. 48, no. 1, pp. 83–105.
Peng, Y.; Shu, C.; Chew, Y. T. (2003): Simplified thermal lattice Boltzmann
model for incompressible thermal flows. Phys. Rev. E, vol. 68, no. 026701.
Shi, Y.; Zhao, T. S.; Guo, Z. L. (2004): Thermal lattice Bhatnagar-Gross-Krook
model for flows with viscous heat dissipation in the incompressible limit. Phys.
Rev. E, vol. 70, no. 066310.
Su, S. W.; Lai, M. C.; Lin, C. A. (2007): An immersed boundary technique for
simulating complex flows with rigid boundary. Computers & Fluids, vol. 36, no.
2, pp. 313–324.
18 Report submitted to National Science Council 2013-07-31
where Di = ∂/∂ t+~ei ·O and Fi is,
Fi = ωiF [1+
~ei ·~u
C2s
τg−1/2
τg
] (37)
It is clear that Fi satisfies the following equations.
∑
i
Fi = F,
∑
i
~eiFi = ((τg−0.5)/τg)~uF (38)
From Eq. 36, we can get the following equation
(4t)0 : Digeqi =−
1
τg
g(1)i +Fi+O(4t) (39)
Substituting Eq. 39 into the lefthand side of Eq. 36, we can rewrite Eq. 36 as,
Dig
eq
i +4t(1−
1
2τg
)Dig
(1)
i +
4t
2
~ei ·5Fi =− 1τg (g
(1)
i +4tg(2)i )+Fi+O(4t2) (40)
Summing Eq. 39 over i and applying Eq. 9, we can obtain
∂ρT
∂ t
+~u ·5ρT =∑
i
Fi+O(4t) (41)
If, F is defined as
F =
Φ
cv
(42)
and applying Eq. 39 and Eq. 41 to Eq. 40, then we take summation of Eq. 40 over
i, we can obtain the macroscopic conservation equation of energy:
∂T
∂ t
+O · (~uT ) = k
ρcv
O2T + Φ
ρcv
(43)
and the thermal conductivity coefficient is determined as k = ρcvC2s4t(τg−1/2).
Available online at www.sciencedirect.com
Procedia Engineering 00 (2013) 000–000
Parallel Computational Fluid Dynamics Conference (ParCFD2013)
Simulations of three-dimensional cavity flows with multi relaxation
time lattice Boltzmann method and graphic processing units
Hung-Wen Changa, Pei-Yao Honga, Li-Song Lina, Chao-An Lina,∗
aDepartment of Power Mechanical Engineering, National Tsing Hua University, Hsinchu 30013, TAIWAN
Abstract
Three-dimensional square cavity flows are simulated using multi-relaxation lattice Boltzmann method and graphic processing units.
It was found that transition takes place between 1700 < Re < 2000. Parallel computations are conducted on a single node multi
graphic processing unit (GPU) system, consisting of three nVIDIA M2070 or GTX560 devices using OpenMP. Results show that
the speedup performance is strongly dependent on problem size and the precision adopted. For single precision computation with
2403 grid density, about 159 times speedup can be obtained, while for double precision computation, this is slightly degraded to
112. Both are achieved with three Tesla M2070.
c© 2013 The Authors. Published by Elsevier Ltd. Selection and/or peer-review under responsibility of the Hunan University and
National Supercomputing Center in Changsha (NSCC).
Keywords: multi relaxation time (MRT); lattice Boltzmann model; graphic processing unit (GPU); three dimensional lid-driven cavity flow;
high Reynolds number flows.
1. Introduction
Three-dimensional cavity flows were frequently investigated both by experiments and numerical simulations. For
example, Iwatsu et al.[1], Guj and Stella[2] and Mei et al.[3] adopted different numerical schemes to simulate cubic
cavity flows, where steady solution was shown to exist at Reynolds number being Re = 2000. Using Chebyshev-
collocation technique, Albensoeder and Kuhlmann[4] presented solutions for cavity flows at various aspect ratio at
Reynolds number up to 1000. Feldman et al.[5] also investigated numerically the critical Reynolds number for cubic
cavity and showed that the oscillatory instability occurs at Re ≈ 1914. This result was later on supported by a PIV
measurement[6], which concluded that the critical Reynolds number locates in region 1700 < Re < 1970.
On the other hand, lattice Boltzmann method (LBM)[7, 8, 9, 10] has been successfully applied to various hydrody-
namic problems and the major advantage of the LBM is explicit formulation. Thus, the present study aims to examine
the range of critical Reynolds number on a square cavity using multi-relaxation lattice Boltzmann model due to its
enhanced stability at high Reynolds number flows. Also, as an explicit numerical scheme with intensive local com-
putation, the LBM algorithm is very suitable for parallelization. This can be achieved using the Graphical Processing
Unit (GPU) through the Compute Unified Device Architecture (CUDA). The computation platform is a single node
multi-GPU system consisting of three nVIDIA M2070 devices with OpenMP framework and its performance relative
to CPU will also be addressed.
∗ Corresponding author. Tel.: +886-3-574-2602 ; fax:+886-3-572-2840.
E-mail address: calin@pme.nthu.edu.tw
H.W. Chang et al. / Procedia Engineering 00 (2013) 000–000
1st Primary vortex
Z
The plane of symmetry
X
Y
Lid velocity U_T = 0.1
2nd Primary vortexK
1
1
h
Fig. 1. Geometric setup of 3D cavity flow
CPU Thread N-1
cudaSetDevice(N-1)
CPU Thread 0 CPU Thread 1
deviceMem =
NX*NY*(NZ/N)*sizeof()
cudaSetDevice(0) cudaSetDevice(1)
Collision<<<>>>()
Streaming<<<>>>()
Boundary<<<>>>()
MacroCompute<<<>>>()
deviceMem =
NX*NY*(NZ/N)*sizeof()
deviceMem =
NX*NY*(NZ/N)*sizeof()
Collision<<<>>>()
Streaming<<<>>>()
Boundary<<<>>>()
MacroCompute<<<>>>()
Collision<<<>>>()
Streaming<<<>>>()
Boundary<<<>>>()
MacroCompute<<<>>>()
P2P MemcpyP2P Memcpy P2P Memcpy
free(f_h), free(u_h), ..., free(rho_h)
Post process
CPU Thread 0
Write data
init(f_h, u_h,..., rho_h)
malloc(f_h), malloc(u_h),..., malloc(rho_h)
CPU Thread 0
hostMem = NX*NY*NZ*sizeof()
Fig. 2. The simulation procedure for multi-GPU implementation
Here, the relaxation matrix S is a diagonal matrix, i.e.,
S = diag[0, s1, s2, 0, s4, 0, s4, 0, s4, s9, s10, s9, s10, s13, s13, s13, s16, s16, s16] (7)
where the kinematic viscosity is given by
ν =
1
3
(
1
s9
− 1
2
) =
1
3
(
1
s13
− 1
2
) (8)
The relaxation parameters for density and momentum are set equal to zero in order to conserve mass and momentum,
and the rest of the relaxation parameters are chosen to be 0.7 to enhance stability at high Reynolds number.
For the present lid driven cavity shown in Fig. 1, two types of boundary conditions are adopted. The first one is
used for the top lid boundary which moves at a constant velocity, while the second one is applied on the stationary
boundary along the remaining five walls. Boundary conditions proposed in [13, 14, 15] are employed to determine
the unknown particle density distribution functions along the boundary, which are expressed as a combination of the
local known value and a corrector,
fi(x⃗, t) = f (x⃗,−e⃗i, t) + ωiC e⃗i · Q⃗ (9)
where Q⃗ is the force like corrector to enforce the required momentum. This resembles the modification of momentum
due to the presence of a body force, though this only applies to the unknown particle density distribution functions
along the boundary. On the other hand, the equilibrium distribution functions with a constant density are imposed
along the top moving lid as suggested by Hou et al.[16].
3. GPU Implementation
The focus of the present study is the first step towards the multi graphic processing unit(GPU) computations. There
are several possibilities to enable the multi-GPU computational capability, such as Message Passing Interface (MPI)
or POSIX threads programming. Here, the Open Multiprocessing (OpenMP) is adopted for single node multi-GPU
implementation consisting of three GPUS. There are two types of GPU adopted, i.e. nVIDIA Tesla M2070 and
Geforce GTX560 Ti. Each Tela M2070 has 6G GDDR5 memory with 448 CUDA cores and Geforce GTX560 Ti has
1G GDDR5 memory with 384 CUDA cores.
Fig. 2 shows the simulation procedure for current LBM computations. First, variables including microscopic
distribution functions f and macroscopic quantities, such as density and velocities, are declared and initialized in the
host end. A set of variables which will be used for computation on GPU are then allocated in the global memory by
each device. Because of the presence of multiple GPUs, each device only needs to compute a portion of the original
H.W. Chang et al. / Procedia Engineering 00 (2013) 000–000
4. Numerical results
The geometric setup of three-dimensional cavity is shown in Fig. 1. Here, W is the width in the x direction, L is
the length in the z direction and H is the depth in the y direction. The ratios between W and L and W and H are fixed
to one. The cavity Reynolds number is defined as Re = UlidW/ν. Firstly, grid sensitivity test is conducted to ensure
the simulation is grid independent. Cubic cavity flow at Reynolds number being 1000 is simulated and the results are
compared with the solutions presented by Albensoeder et al.[4]. As shown in Fig. 3, LBM solutions become grid
independent with grid density 1283 and 1603, and the results are in good agreement with the benchmark solutions.
Therefore, in the following simulations, 128 × 128 × 128 grid density is adopted.
One of the issue addressed in the present study is to explore the region of the critical Reynolds number where
the first Hopf bifurcation takes place. This is achieved by monitoring the time history of the horizontal velocity
components at the location (x,y,z)=(0.2,0.2,0.5). Fig. 4 shows the time evolutions of the horizontal velocity inside
the cubic cavity. At Reynolds number 1000 and 1700, the velocity profiles remains unchanged as time proceeds,
indicating that steady solutions have reached. When the Reynolds number increases to 2000, the time evolution
pattern becomes periodic and the flow field is unsteady.
5. Parallel performance
The performance of current GPU implementation is addressed here. Cubic cavity flow at Reynolds number being
100 is used as the test problem. Each examined case will run 5000 iterations and the required computational times
are documented and used to investigate the performance. The speedup performance as well as the scalability of multi-
GPU implementation are studied. Three different sets of grid density are selected, i.e. 963, 1923, and 2403. The
multi-GPU platform is made up of three M2070 or three GTX560 Ti graphics processing units. The compared CPU
counterpart is the Intel Core-i7 990 processor. The CUDA program is compiled using nvcc 4.2 version, while the CPU
program is compiled with the gcc and icc.
Figs. 5 and 6 show the acceleration of computational time with different problem sizes with single and double
precision, respectively. For single precision computation with 963 grid density, about 138 times speedups can be
obtained using three GTX560 GPUS, and 135 times speedups are obtained with three M2070 devices. By increasing
the problem sizes, the Tesla M2070 outperforms GTX560 due the larger on card memory size. For problem size
equals to 2403, this value is enhanced to 159 usimg three M2070 devices. On the other hand, double precision
computation results show a slightly degraded performance compared with the single precision counterpart, and 112
times acceleration is achieved under the biggest examined problem size using M2070. It should be noted that more
GTX560 devices are required to accommodate the memory requirements as the problem size increases.
6. Conclusion
The multi-relaxation lattice Boltzmann model is adopted to simulate three-dimensional cubic cavity flows. It was
found that transition takes place between 1700 < Re < 2000, which is consistent with the results published by Liber-
zon et al.[6]. Also, the computations of the present study are conducted on a single node multi-GPU system, where
three nVIDIA M2070 or GTX560 devices execute simultaneously using OpenMP. Results show that the speedup per-
formance is strongly dependent on problem size and the precision adopted. For single precision computation with
2403 grid density, about 159 times speedup can be obtained, while for double precision computation, this is slightly
degraded to 112. Both are achieved with three Tesla M2070. GTX560’s performance is compatible with Tesla M2070.
It should be noted that more GTX560 devices are required to accommodate the memory requirements as the problem
size increases.
Acknowledgments
The authors gratefully acknowledge the supports by the Taiwan National Science Council and Low carbon energy
research center of National Tsing Hua University and the computational facilities provided by the Taiwan National
Center for High-Performance Computing.
行政院國家科學委員會補助團隊參與國際學術組織會議報告 
                                                年  月  日 
 
報告人姓名 
 
林昭安 
 
服務機構
 
清大動機系 
 
職稱 
 
教授 
 
會議正式名稱 
中文：4 屆亞洲計算熱傳與流體會議 
英文：The 4th Asian Symposium on Computational Heat Transfer and Fluid 
Flow 
會 議 時 間       3-6 June 2013 地點（國、州、城市） 
 
Hong Kong 
報告內容應包括下列各項： 
 
一、 參加會議經過 
ASCHT is the biannual international conference devoted to the discussion of recent developments of 
computational heat transfer and fluid flow. There were more than 100 participants.  
The meeting started with the invited talks and three parallel sessions. My presentation was scheduled to 
talk on Wednesday. My title was on the Numerical simulation of laminar natural and mixed convection 
from a confined elliptic cylinder at different aspect ratios and inclinations. There were several exchanges 
regarding the implementation of the boundary conditions.  
On Wednesday, I also attended the international advisory committee, where the local organizers 
reported to the members of the conference organization. Also, the 2015 conference organizer also briefed 
the committee of the preparation of the conference which is to be taken in India. 
二、 與會心得 
This symposium is good platform where researchers came together to exchange research out come and 
discussed the future trend. Another good side is to meet old friends. 
三、 考察參觀活動（無是項活動者省略） 
No. 
四、 建議事項 
 
五、 其他 
 
 
C.-C. Liao, C.-A. Lin 
 n-2 The Asian Symposium on Computational Heat Transfer and Fluid Flow, Hong Kong SAR, China, 2013 
 
The remainder of this paper is organized as follows. The present methodology is first validated with 
flows induced by natural convection in the annulus between concentric circular and square cylinders, and the 
grid-function convergence tests are also examined. Natural convection induced by isothermally elliptic 
cylinder is further investigated and the influence of the outer enclosure was considered as well. The 
parameters investigated in the study include Rayleigh number, axis ratio and inclination angle of the elliptic 
cross-section. Local and average heat transfer characteristics are fully studied around the surfaces of both 
inner cylinder and outer enclosure. Finally, mixed convection in a square enclosure with an active rotating 
elliptic cylinder is considered and the heat transfer quantities of the system are obtained for different rotating 
speeds. 
 
2. Methodology of the immersed-boundary technique 
2.1 Mathematical formulation 
Consider the problem of a viscous incompressible fluid with thermal convection in a two-dimensional 
rectangular domain Ω=[0,L]×[0,H] containing an immersed massless boundary in the form of a simple 
closed curve Γ, as shown in Fig.1. The immersed boundary is tracked in parametric form, X(s), 0≦s≦Lb, 
where s is an arclength parameter associated with the (immersed) boundary Γ, and Lb is the length of Γ. It is 
clear from this figure that few, if any, of the points composing Γ coincide with grid points. 
The governing equations of this fluid-structure interaction system with thermal condition are 
0                                                               (1)u∇ ⋅ =  
+ ( ) +                   (2)M
u Rauu p u T f
t Pr
∂
∇ ⋅ = −∇ ∆ + +
∂  
1+ ( )                                  (3)E
T uT T f
t Pr
∂
∇ ⋅ = ∆ +
∂  
Here, x ( , ),  (x, )x y u t= , is the fluid velocity with components u  and v , and (x, )p t  is the fluid 
pressure. ∆ and∇ are the usual Cartesian-coordinate gradient and Laplacian. Ra is the Rayleigh number, 
which is defined as 
3( )s og T T LRa β
να
−
=  with the gravitational acceleration g , the thermal expansion 
coefficient β , the temperatures of the immersed object sT  and the outer enclosure oT , characteristic length 
L , kinematic viscosity ν  and thermal diffusivity α . Pr is the Prandtl number, which is defined as Pr ν
α
= . 
It is noted that the Cartesian coordinates x, time t , velocity ( , )u x t , temperature T and pressure ( , )p x t  are 
normalized with L , 2 /L ν , / Lν , 0sT T− and 
2 2/ Lρν , respectively. 
Note that the discrete-time momentum forcing ( , )Mf x t  is applied to satisfy the no-slip condition on the 
immersed boundaries, as in [19]. In the present study, the discrete-time energy forcing ( , )Ef x t  is used to satisfy 
the prescribed thermal conditions on immersed boundaries. Both momentum forcing and energy forcing are 
applied only at the nodes adjacent to the immersed boundary in an Eulerian grid system. 
 
2.2 Numerical scheme 
The numerical procedure used herein consists of a finite-volume method discretized in Cartesian coordinates 
with a staggered-grid arrangement of dependent variables.  This procedure is based on the integration of the 
transport equations over arbitrary control volumes, leading to the conservation of mass and the balance of 
momentum and any scalar flow property over each such volume. Spatial derivatives are approximated using 
second-order centered differencing, and a fractional-step (projection) method implemented with a combination of 
the Adams--Bashforth and Crank—Nicolson methods for advective and diffusive terms, respectively, is used for 
temporal discretization. Here, the four-step time-advancement formulation [18, 20] is employed for the 
momentum equations due to its storage economy and straightforward implementation of boundary conditions. 
The discrete form of this algorithm is embodied in the following sequence of equations: 
1 1 13 1 3 1 1( ) ( ) + ( )                  (4)
2 2 2 2 2
n
n n n n n n n
h h h h M
u u Ra Rauu uu T T p u u f
t Pr Pr
− − +− = − ∇ ⋅ + ∇ ⋅ − −∇ + ∆ + +
∆


 
*
                                                     (5)nh
u u p
t
−
= ∇
∆

 
*
1=                                                    (6)n hh
up
t
+ ∇ ⋅∆
∆  
C.-C. Liao, C.-A. Lin 
 n-4 The Asian Symposium on Computational Heat Transfer and Fluid Flow, Hong Kong SAR, China, 2013 
 
experiments show that solid body forcing is required for velocity computations and is not needed for the 
calculation of temperature [23]. 
 
3. Numerical results  
3.1 Natural convection in the annulus between concentric circular and square cylinders Mathematical 
formulation 
Flows induced by natural convection in the annulus between concentric circular and square cylinders 
have been reported in recent years and are adopted here to validate the capability of the present method. 
Consider a horizontal concentric annulus between a heated circular inner cylinder and a square outer cylinder 
as shown in Fig. 3, where no-slip and isothermal boundary conditions are imposed on both cylinders. The 
flows are considered to be steady and laminar, and flows within the annulus are driven by the temperature 
difference. Air is used to be the working fluid and the Prandtl number is fixed at 0.71. The aspect ratio L/D is 
selected to 2.5 and three Rayleigh numbers (Ra=104-106) are adopted here. 
Grid-function convergence tests are first conducted using four uniform grids of 200×200, 300×300, 
400×400 and 600×600 cells, when Ra=105. The local and surface-averaged Nusselt numbers are defined as 
2
0
1, , (17), , , (18)
2wall Local Mean
T hS hSh k and Nu h h d and Nu
n k k
π
θ
π
∂
= − = = =
∂ ∫  
where n is the normal direction along the boundary and the characteristic length S is defined as the perimeter 
of the circular cylinder and square enclosure. Table 1 shows the comparisons of NuMean for different 
uniform grids with those of Moukalled and Acharya [2] and Shu et al. [3]. It is noted that the characteristic 
length S is defined as half of the perimeter of the circular cylinder in above two references. All simulated 
surface-averaged Nusselt number are consistent with literature data and the difference by using the coarsr 
200×200, 300×300, 400×400 and finest grids (600×600) are about 0.6%, 0.1% and 0.1%. Therefore, the 
uniform grid resolution of 300×300 cells is adopted in the following simulated cases. 
The isotherms and streamlines in the annulus at three Rayleigh numbers (Ra=104-106) are shown in Fig. 
4, where all the contour values are normalized and range from 0.05 to 1.0. As depicted in Figs. 4(a), 
conduction dominates the flow field and a relatively weak convective flow can be observed in the annulus at 
the lower Rayleigh number. As the Rayleigh number increases, the strength of the convective flow grows 
and the center of recirculation eddy changes its position. Also, the two prevailing vortices at Ra=104 are now 
merged into one vortex. When Ra=106, a relatively stronger convective flow dominate the fluid field and 
higher temperature gradient can be observed, as indicated in Fig. 4(c). Table 2 shows a comparison of the 
surface-averaged Nusselt number with reference data [2,3]. It is clear that the present predictions are 
consistent with literature data, and the capability of the present method for dealing with natural convection in 
the annulus is ascertained. 
Table 1. Comparisons of the simulated surface-averaged Nusselt number for different uniform grids with 
those of Moukalled and Acharya [2] and Shu et al. [3] for grid-function convergence tests. 
 
Table 2. Comparisons of present surface-averaged Nusselt number with those of Moukalled and Acharya [2] 
and Shu et al. [3] for natural convection in the annulus between concentric circular and square cylinders. 
 
 
 
3.2 Natural convection in a rectangular enclosure with heated elliptic cylinder  
The present section is concerned with investigating the natural convection of a heated elliptic cylinder 
within a square enclosure. As shown in Fig. 5, an elliptic cylinder with major axis 2a and minor axis 2b is 
used here and the major axis is inclined at an angle φ with respect to the horizontal line. The aspect ratio of 
the elliptic cylinder is defined as AR=b/a, and elliptic cylinders with different AR examined are designed to 
have fixed perimeter, which can be approximated as [3( ) (3 )( 3 )]a b a b a bπ + − + +  Two issues will be 
addressed here, i.e. the influences of the aspect ratios and the cylinder inclination angle φ on the heat transfer. 
C.-C. Liao, C.-A. Lin 
 n-6 The Asian Symposium on Computational Heat Transfer and Fluid Flow, Hong Kong SAR, China, 2013 
 
The overall influences of φ and aspect ratio of the cylinder can be observed in Fig. 16 showing the 
comparisons of (a) surface-averaged Nusselt number (NuMean) and (b) the difference between the locally 
maximum and minimum Nusselt numbers (NuDifference). Since at steady state, the surface-averaged Nusselt 
number along the inner and outer walls are the same and need not to be listed separately. 
Here, the growth of φ leads to the increase of NuMean on both inner and outer walls. By increasing the 
inclination angle φ from 0o to 90o, the NuMean increases 3.1%, 8.2% and 14.3% with AR being 0.75, 0.5 and 
0.25, respectively. Therefore, as the major axis varies from horizontal to vertical setting, the surface-
averaged Nusselt number with lower AR increases more than that with higher AR, which agrees with the 
experimental results of [14] for free convection heat transfer from an elliptic cross-section in an open domain. 
It is also noted that the aspect ratio shows different influence on the NuMean at φ greater or smaller than 45o. 
Forφ< 45o, NuMean increases in tandem with the increase of cylinder aspect ratio. While at φ> 45o, increase of 
aspect ratio causes the decrease of NuMean. 
The difference between the maximum and minimum Nusselt number can be observed from Fig.16(b) 
showing the distributions of NuDifference. Along the inner cylinder, NuDifference is in general elevated by the 
increase of φ and the decrease of cylinder aspect ratio. However, along the outer wall, NuDifference decreases as 
φ increases. Influence of the aspect ratio is only significant at φ< 45o, where the increase of NuDifference is in 
line with the aspect ratio. 
In summary, the slender elliptic cylinder generates high NuMean and NuDifference when comparing with the 
circular case. Although the NuMean of the outer enclosure was enhanced by the slender elliptic cylinder, the 
NuDifference of the enclosure was found to equal or less than that of the circular case, i.e., the uniformity of the 
local heat transfer rates was not degraded. 
 
3.3 Mixed convection in a square enclosure with an active rotating elliptic cylinder 
Mixed convection in enclosures due to the presence of a rotating object was studied by few studies [18-
21], and most of the investigations concentrated mainly on the influence of the rotating circular object. Here, 
the mixed convection in a square enclosure with an active rotating elliptic cylinder is studied with Ra=105 
and AR=0.5. The Reynolds number (Re) and Richardson number ( maxRe 2 /V a ν= ) at corresponding 
rotational velocity are listed in Table 3. All simulations are conducted with at least eight revolutions to 
ensure periodic solutions. 
Table 3. List of Rayleigh number (Ra), Reynolds number (Re) and Richardson number (Ri) at corresponding 
rotational velocity when AR=0.5. 
 
Detailed surface Nusselt number distributions can be referred to Figs. 17 and 18 showing the isotherms 
and local Nusselt numbers along the cylinder and enclosure at inclination angle being 0o and 90o, 
respectively. As the elliptic cylinder reaches the horizontal position, the maximum Nusselt number locations 
migrate from θ=0o and 180o to θ=120o and 300o in tandem with the increase of the rotational speed of the 
cylinder. These can be observed from the isotherms, and the asymmetric distributions of the isotherm also 
reflects the influence of the rotation of the cylinder. At the same rotational speed, the absence of the buoyant 
force hinders the heat transfer along the cylinder surface. Also, as expected, the Nusselt number distributions 
along the enclosure walls exhibits periodic patterns without the gravitational force. Similar observations can 
also seen from Fig. 18, as the elliptic cylinder reaches the vertical positions. Here, the maximum Nusselt 
number locations changes from single peak atθ=270o to twin peaks atθ=30o and 210o with the increase of the 
rotational speed of the cylinder. 
Finally, relationship between the time-averaged thermal quantities and the system parameters are further 
examined. A normalized Nusselt number is defined as the ratio of the surface averaged Nusselt numbers 
between the time-averaged NuMean of the rotating cylinder during one revolution and NuMean of the natural 
convection with stationary cylinder, as shown in Fig.19. In Ghaddar and Thiele [19], the rotation of the 
isoflux circular cylinder was found to enhance the heat transfer in the enclosure as compared with the fixed 
C.-C. Liao, C.-A. Lin 
 n-8 The Asian Symposium on Computational Heat Transfer and Fluid Flow, Hong Kong SAR, China, 2013 
 
using DQ method, Int. J. Heat Mass Transf. 47 (2004) 797--808. 
[9] A.K. De, A. Dalal, A numerical study of natural convection around a square, horizontal, heated cylinder placed 
in an enclosure, Int. J. Heat Mass Transf. 49 (2006) 4608--4623. 
[10] X. Xu, Z. Yu, Y. Hu, L. Fan, K. Cen, A numerical study of laminar natural convective heat transfer around a 
horizontal cylinder inside a concentric air-filled triangular enclosure, Int. J. Heat Mass Transf. 53 (2010) 345--
355. 
[11] Z.T. Yu, L.W. Fan, Y.C. Hu, K.F. Cen, Prandtl number dependence of laminar natural convection heat transfer 
in a horizontal cylindrical enclosure with an inner coaxial triangular cylinder, Int. J. Heat Mass Transf. 53 (2010) 
1333--1340. 
[12] F.N. Lin, B.T. Chao, Laminar free convection over 2-dimensional and axisymmetric bodies of arbitrary contour, 
J. Heat Transf.-Trans. ASME, 96 (1974) 435--442. 
[13] J.H. Merkin, Free convection boundary layers on cylinders of elliptic cross section, J. Heat Transf.-Trans. ASME, 
99 (1977) 453--457. 
[14] S.Y. Huang, F. Mayinger, Heat transfer with natural convection around elliptic tubes, Warme-Und 
Stoffubertragung, 18 (1984) 175--183. 
[15] H.M. Badr, K. Shamsher, Free convection from an elliptic cylinder with major axis vertical, Int. J. Heat Mass 
Transf. 36 (1993) 3593--3602. 
[16] H.M. Badr, Laminar natural convection from an elliptic tube with different orientations, J. Heat Transf.-Trans. 
ASME, 119 (1997) 709--718. 
[17] M. Corcione, E. Habib, Multi-Prandtl correlating equations for free convection heat transfer from a horizontal 
tube of elliptic cross-section, Int. J. Heat Mass Transf. 52 (2009) 1353--1364. 
[18] W.S. Fu, C.S. Cheng, W.J. Shieh, Enhancement of natural convection heat transfer of an enclosure by a rotating 
circular cylinder, Int. J. Heat Mass Transfer 37 (1994) 1885--1897. 
[19] N.K. Ghaddar, F. Thiele, Natural convection over a rotating cylindrical heat source in a rectangular enclosure, 
Numer. Heat Tranf. A-Appl. 26 (1994) 701--717. 
[20] N.K. Ghaddar, Natural convection over rotating cylindrical heat source in an enclosure, J. Thermophys. Heat 
Transfer 10 (1996) 303--311. 
[21] V.A.F. Costa, A.M. Raimundo, Steady mixed convection in a differentially heated square enclosure with an 
active rotating circular cylinder, Int. J. Heat Mass Transfer 53 (2010) 1208--1219. 
[22] C.C. Liao, Y.W. Chang, C.A. Lin, J.M. McDonough, Simulating flows with moving rigid boundary using 
immersed-boundary method, Comput. Fluids 39 (2010) 152--167. 
[23] C.C. Liao, C.A. Lin. Simulations of natural and forced convection flows with moving embedded object using 
immersed boundary method, Comput. Methods Appl. Mech. Eng. 58 (2012) 213--216 
[24] J. Mohd-Yusof, Combined immersed boundary/B-Spline method for simulations of flows in complex geometries 
in complex geometries CTR annual research briefs, NASA Ames/Stanford University,1997. 
[25] H. Choi and P. Moin, Effects of the Computational Time Step on Numerical Solutions of turbulent flow, J. 
Comput. Phys. 113 (1994) 1--4. 
 
C.-C. Liao, C.-A. Lin 
 n-10 The Asian Symposium on Computational Heat Transfer and Fluid Flow, Hong Kong SAR, China, 2013 
 
 
Fig. 7. Isotherms and streamlines for different aspect ratios of (a)AR=1.00, (b)AR=0.75, (c)AR=0.50 and (d)AR=0.25 when Ra=105 and inclination 
angleφ=0o, dotted and solid lines denote negative and positive contours. 
 
Fig. 8. Isotherms and streamlines for different aspect ratios of (a)AR=1.00, (b)AR=0.75, (c)AR=0.50 and (d)AR=0.25 when Ra=106 and inclination 
angleφ=0o, dotted and solid lines denote negative and positive contours. 
 
Fig. 9. Comparison of local Nusselt number distribution along the surface of the (a) inner cylinder and (b) outer enclosure at different AR for Ra=104. 
 
C.-C. Liao, C.-A. Lin 
 n-12 The Asian Symposium on Computational Heat Transfer and Fluid Flow, Hong Kong SAR, China, 2013 
 
 
Fig. 14. Isotherms and streamlines for different inclination angle of (a)φ=0o, (b) φ=30o, (c) φ=45o, (d) φ=60o and (e) φ=90o when Ra=105and 
AR=0.5, dotted and solid lines denote negative and positive contours. 
 
Fig. 15. Comparisons of local Nusselt number distribution along the surface of the (a) inner cylinder and (b) outer enclosure at different inclination 
angle (φ) for Ra=105 and AR=0.5. 
 
Fig. 16. Comparisons of (a) surface-averaged Nusselt number (NuMean) and (b) the difference between the locally maximum and minimum Nusselt 
numbers (NuDifference) for different inclination angles (φ) when AR=0.25, 0.5, 0.75, and 1.0. 
C.-C. Liao, C.-A. Lin 
 n-14 The Asian Symposium on Computational Heat Transfer and Fluid Flow, Hong Kong SAR, China, 2013 
 
 
Fig. 19. The relationship between the normalized Nusselt number and Ri at Ra=105 and AR=0.5. 
 
99年度專題研究計畫研究成果彙整表 
計畫主持人：林昭安 計畫編號：99-2221-E-007-030-MY3 
計畫名稱：熱晶格波茲曼法發展 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 3 3 100%  
研究報告/技術報告 3 3 100%  
研討會論文 4 4 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 3 3 100%  
博士生 2 2 100%  
博士後研究員 1 1 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
