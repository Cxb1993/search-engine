 1
 Cognitive-Cooperative Multiple Access with Distributed Coding (2/3) 
 
 
英文摘要 
The next generation wireless networks will integrate several application scenarios and provide a wide 
spectrum of services. To accommodate this and maintain seamless wireless access, the user devices will 
become smarter than ever and capable of sensing the surrounding environment and seizing available 
wireless resource whenever needed. In this project, we investigate distributed coding for such dynamic 
wireless networks. The goal is to provide space diversity through user cooperation without the need of 
multiple antennas. In the second year of this project, we focus on cooperative communications by using 
relays to help forward information. We look beyond the known results of the relay channels and consider 
the interaction between the relay mechanisms and two other popular common techniques in modern 
wireless networks, namely, adaptive modulation and coding (AMC) and hybrid automatic repeat request 
(HARQ) that provide time diversity. By using the proposed adaptive throughput maximization algorithm, 
it is shown that combining AMC, HARQ and relay can highly improve the communication performance 
and network coverage. 
 
Keywords: Cognitive radio, relay, cooperative transmission, adaptive modulation and coding (AMC), 
hybrid automatic repeat request (HARQ). 
2I. INTRODUCTION
The next generation wireless networks will integrate several application scenarios and provide a wide
spectrum of services. In order to support seamless wireless access for data-rate hungry applications such as
multimedia and gaming, the communication bandwidth will be very wide, and the area spectral efficiency
will have to be highly increased. To accommodate these needs, the computation of wireless networks
will become more and more distributed, and moving from infrastructure toward terminals/devices. The
end-user devices will become smarter than ever and capable of inspecting the surrounding environment
and seizing enough wireless resource whenever needed. In addition, in order to be highly portable, the
end-users devices will have to be small in size, with low power consumption, and utilizing most globally
available spectra. Hassle free upgrade for the end-users is also an important feature. Thus, the new devices
should be backward compatible to the existing popular wireless services (such as the wireless local area
networks (WLAN)), and a new multiple access mechanism has to be defined for these new devices.
There are two recent developments in communication theory that might help to achieve the aforemen-
tioned new user device requirements. One is dynamic resource allocation based on Shannon’s water-filling
concept. This helps the user devices seize as much useful wireless resource (e.g., spectrum) as possible.
In order to accomplish a good resource allocation, the devices first need to be environment-aware and able
to accurately sense and understand the surrounding environment. This calls for an intelligent, or cognitive
radio (CR) device [1]. The resource allocation mechanism will be network-wide, but possibly distributed
to the individual devices (namely, autonomous) to achieve good spectrum pooling [2].
The other helpful concept is diversity which appears in many forms. It can help lower the power
consumption for a given performance requirement. Frequency and time diversities in general can be
obtained through good channel coding and modulation design, as well as good resource allocation. Space
diversity needs the deployment of multiple antennas which the new small-size devices may not afford.
Fortunately, as the new wireless networks will be packed densely in space to achieve high frequency
reuse and low power consumption, the end-user devices will likely find many other user devices placed
nearby. In this scenario, the user devices can help relay each other’s data to obtain space diversity through
cooperation [3] [4] [5] [6]. The channel coding and modulation design for this scenario will be distributed
as opposed to the conventional space-time coding for which the multiple coded data streams are generated
and emitted from the same user on its different antennas.
In this project, we investigate issues pertaining to cognitive-cooperative multiple access (C2MA), and
propose solutions to facilitate it. In the second year, we focused on the cooperative feature of the C2MA
by using intelligent relays. While the theoretical capacity and spatial diversity achievable by a channel
with a relay, namely a relay channel, have been extensively studied [7], the more practical but advanced
design aspects of relay channels such as adaptive modulation and coding (AMC) and hybrid automatic
repeat request (HARQ) are not as well discussed and understood. Thus, we considered relay channels
with AMC and HARQ, and proposed new designs. As AMC and HARQ are considered the common key
techniques that highly improve the performance of the recent and coming future wireless networks, we
hope our results can help the deployment of relays in future wireless networks with AMC and HARQ.
This report is organized as follows. We first summarize the relay-based cooperative communication
systems in Section II. In Section III, we summarize the HARQ technique and apply it to the relay systems.
In Section IV, we show how the AMC technique works by using the adaptive throughput maximization
algorithm and apply this technique to the relay-HARQ systems. The system simulations for the relay-
based cooperative communication systems with HARQ and AMC are discussed in Section V. Lastly, we
present the conclusions in Section VI.
II. RELAY-BASED COOPERATIVE COMMUNICATION SYSTEMS
A. Cooperative Communication
In a cooperative communication system, each wireless user is assumed to transmit data as well as act as
a cooperative agent for another user. Fig. 1 shows an example for the cooperative communication [8]. The
4sources, relays and destinations is described in Fig. 3. Without loss of generality, we consider the simplest
relay channel model which consists of three nodes: source, relay, and destination, as shown in Fig. 4,
where S is the source, R is the relay, D is the destination, and hsr, hsd , hrd are the corresponding channel
gains of link S→ R, S→D, and R→D, respectively. These nodes communicate with one another to form
cooperative communication.
S
D
R D
DR
R
S
S
.
.
.
.
.
.
.
.
.
Fig. 3. General relay system model.
S D
R
h
sr
h
rd
h
sd
Fig. 4. The simplest relay system model.
C. Relaying Protocols and Algorithms
1) Relaying Protocols: In general, based on the schemes of utilizing communication resources, there
are two main relaying protocols in the relay-based cooperative communication systems. The first one is
based on full duplex relaying, and the second one is based on half duplex relaying. In the full duplex
relaying protocol, the relay can receive and transmit data simultaneously by using the same communication
resource, such as time, frequency, or code. While in the half duplex relaying protocol, the relay can not
receive and transmit data simultaneously using the same communication resource. To be more detailed,
there are two main protocols in the half duplex relaying: (1) Time Division Duplex (TDD), (2) Frequency
Division Duplex (FDD).
The relay receives and transmits data at different time slots when using TDD half duplex. The relay
receives and transmits data on different frequency bands when using FDD half duplex. In this projet, we
consider the more practical relay communication system based on the TDD half duplex protocol. It can
6where hsd and hsr are the corresponding channel gains of link S→D and S→ R, respectively. nd,1 and nr,1
∼CN(0,N0) (zero mean complex Gaussian distribution with variance N0) are the additive white Gaussian
noises (AWGN) at the destination and the relay in the first time slot, respectively.
The AF relay amplifies the received signal yr,1 by the factor β and then retransmits the signal to the
destination in the second time slot. The destination receives the signal transmitted by the relay in the
second time slot according to
yd,2 = hrd(βyr,1)+nd,2 (3)
= hrdβ(hsrx1+nr,1)+nd,2
= hrdβhsrx1+hrdβnr,1+nd,2 (4)
β≤
√
P
|hsr|2P+N0 (5)
where hrd is the channel gain of link R→ D, nd,2 ∼CN(0,N0) is the AWGN at the destination in the
second time slot, and P is the average signal power for both S and R. Note that (5) is imposed to satisfy
the power constraint.
The input-output relation in the AF operation can now be summarized as
yAF =HAFx1+n (6)
where yAF = [ yd,1 yd,2 ]T is the received signal vector, HAF = [ hsd hrdβhsr ]T and
n= [ nd,1 hrdβnr,1+nd,2 ]T
are the corresponding 2×1 channel matrix and noise vector, respectively.
2) Channel and Signal Models in the DF Operation: In this section, we discuss the channel and signal
models for the TDD Protocol 2 in the DF operation. The signals received at the destination and the relay
in the first time slot are given by yd,1 and yr,1 respectively, the same as in the AF case in (1) and (2). The
DF relay demodulates and decodes the signal received from the transmitter in the first time slot to get the
estimated information. Then the DF relay re-encodes the information and transmits to the destination in
the second time slot. The destination receives the signal transmitted by the relay in the second time slot
according to
yd,2 = hrd xˆ1+nd,2. (7)
Assume that the information in x1 can be correctly decoded by the relay (i.e., xˆ1 = x1). Then the input-
output relation in the DF operation can be summarized as
yDF =HDFx1+n (8)
where yDF = [ yd,1 yd,2 ]T is the received signal vector, HDF = [ hsd hrd ]T and n= [ nd,1 nd,2 ]T are
the corresponding 2×1 channel matrix and noise vector, respectively.
3) Discussions for Channel and Signal Models: From the above results of channel and signal models,
we conclude that the relay system with TDD Protocol 2 can be viewed as the effective (1× 2) single-
input-multiple-output (SIMO) system. It allows the same diversity gain as the multiple-antenna systems.
In other words, it shows the important result that the source and relay create a virtual SIMO channel to
generate the spatial diversity via the cooperative transmission.
There are more discussions for the relations between the cooperative and MIMO communication systems
in [9]. It was concluded that the relay-based cooperative communication systems with TDD Protocol
1 and Protocol 3 can be associated with the MIMO and MISO communication systems, respectively.
Furthermore, the different TDD Protocols were discussed according to the information-theoretic analysis.
From the capacity point of view, the performance of TDD Protocol 1 is the best among the three protocols
8From the above results, we conclude that the AF operation in the fixed relaying case has diversity
benefit, while the DF operation in the fixed relaying does not have the diversity benefit. In order to
improve the performance in the DF operation, we will consider the selective DF relaying algorithm next.
(3) Selective relaying algorithm
In the selective DF operation, the relay transmits data to the destination only when the data received from
the source is correctly decoded by the relay. If the relay can not decode the message correctly, the source
will repeat its transmission. For the assumption of Rayleigh fading channel (i.e., |hi j|2 is exponentially
distributed with parameter σ−2i j ), the outage probability for the selective DF relaying algorithm at high
SNR is [13]
Pout,SDF(SNR,R)≈ ( 12σ2SD
σ2SR+σ
2
RD
σ2SRσ
2
RD
)(
22R−1
SNR
)2 (13)
and the corresponding diversity order d(R) = 2.
This result shows that we can get diversity benefit in the DF operation by using the selective relaying
algorithm.
(4) Incremental relaying algorithm
The source and the relay cooperate with each other to make the transmission more reliable by adjusting the
system data rate in the incremental relaying algorithm. Here we assume that the system in the incremental
AF relaying algorithm operates at rate R when the S to D transmission is successful and at rate R/2 when
the relay repeats the source transmission, respectively. For the assumption of Rayleigh fading channel
(i.e., |hi j|2 is exponentially distributed with parameter σ−2i j ), the outage probability for the incremental AF
relaying algorithm at high SNR approximation derived is [13]
Pout,IAF(SNR,R)≈ ( 12σ2SD
σ2SR+σ
2
RD
σ2SRσ
2
RD
)(
2R−1
SNR
)2 (14)
R=
R
2
[1+ exp(−2
R−1
SNR
)] (15)
where R is the average transmission rate (or spectral efficiency), and the corresponding diversity order
d(R) = 2.
This result shows that we can get diversity benefit in the incremental AF relaying operation. Furthermore,
notice the fact that R≤ R gives the lower outage probability (or error probability) than the other relaying
algorithms. This is the main idea of the incremental relaying algorithm that we can get the improvement
in error probability by decreasing the average transmission rate.
III. RELAY-BASED COOPERATIVE COMMUNICATION SYSTEM WITH HYBRID RCPT/ARQ
A. Introduction to Error Control Systems
1) Forward Error Correction: In forward-error-correction (FEC) systems, the messages are encoded
with channel codes at the transmitter before sent to the receiver. The noisy channel may induce some
errors in the messages. However, a good channel code can automatically correct the errors after decoding
at the receiver. In 1948, Shannon proposed the capacity theorem: there exist channel codes (and decoders)
that make it possible to achieve reliable transmission, with as small an error probability as desired, if the
transmission rate R<C, where C is the channel capacity [15].
In order to achieve this goal (approaching the Shannon bound), people aim for designing channel codes.
There are two main categories of channel codes: (1) Block codes and (2) Convolutional codes. In recent
years, turbo codes (based on convolutional codes) and low density parity check (LDPC) codes (based on
block codes) have been shown to approach the Shannon bound very closely [16]. In addition, both turbo
10
the transmission sequence number.
2. The receiver does not need large buffers to store the packets successfully received in previous trans-
missions.
3. The average throughput is higher than SW-ARQ.
The name, ”Go-Back-N”, is derived from the fact that when the transmitter receives NACK, it will go
back to the preceding N packets buffer and restart to transmit packets from there.
Fig. 6. An example for Go-Back-N ARQ.
(3) Selective-repeat ARQ (SR-ARQ)
In SR-ARQ system shown in Fig. 7, the transmitter transmits packets in a continuous stream like GBN-
ARQ system. When an error packet is detected, the transmitter only retransmits this requested packet.
After transmitting this requested packet, the transmitter then returns to the location at which it stopped
and restarts to transmit new packets. So in SR-ARQ system, every packet needs overhead to indicate
the sequence number. These features of SR-ARQ system make it be able to achieve higher throughput.
However, it needs large buffers at the transmitter and receiver.
3) Hybrid-ARQ: Hybrid-ARQ (HARQ) is a technique which combines FEC and ARQ. For the transmit-
ter, the source bits are encoded in two steps. The first step is to do error-detection-encoding which makes
the packet error-detectable by appending parity-check bits. The second step is to do channel encoding
which makes the packet error-correctable. In other words, a transmitted packet is generated from the two
steps mentioned above, and the first step is to implement ARQ technique while the second step for the
FEC technique.
At the receiver, a packet will be error-corrected and error-detected. The receiver uses the channel
coding decoder to correct the error patterns and then utilizes the parity-check bits to determine whether
the decoding result is error-free or erroneous. If the packet is erroneous, the receiver will transmit a NACK
information to the transmitter which makes the transmitter know this packet is received unsuccessfully.
Otherwise, the receiver will transmit an ACK information to the transmitter which makes the transmitter
know this packet is received successfully by the receiver.
The transmitter can transmit new or the previously transmitted information bits according to the feedback
information. If ACK is received or the number of the retransmission exceeds the maximum number of
retransmissions, the transmitter transmits a packet carrying the new information bits. Otherwise, it transmits
a packet carrying the previously transmitted information bits.
12
and these symbols carrying the same messages can be combined by using MRC or EGC at the receiver.
In the IR scheme, the received symbols (could be different versions of parity bits) pertaining to the same
message are combined by using MRC or EGC.
B. Hybrid-ARQ System with RCPT Codes
1) Basic Principle of Turbo Coding: Turbo codes were first proposed in 1993 by Berrou, Glavieux
and Thitimajashma. They showed an amazing coding gain in turbo codes [19]. The encoder structure
is shown in Fig. 8. Two component codes are used to code the same input bits, while an interleaver is
placed between the encoders. To achieve the near-capacity performance, recursive systematic convolutional
(RSC) codes are usually used as the component codes. The outputs from the two component codes are
then punctured and multiplexed. In the original turbo code, the coding rates of both component RSC
codes were 1/2 (i.e., giving one parity bit and one systematic bit output for every input bit). To have an
overall coding rate of 1/3, we may transmit all the systematic and parity bits from the first RSC encoder
and all the parity bits from the second RSC encoder.
Interleaver
RSC Encoder
RSC Encoder
Input Bits Output Bits
(An example for RSC encoder) 
Fig. 8. The encoder structure of turbo codes.
The decoder structure is shown in Fig. 9. Two component decoders are linked by interleavers in a
structure similar to the encoder. From Fig. 9, we can see that each decoder takes three inputs: (1) the
systematically encoded channel output bits, (2) the parity bits transmitted from the associated component
encoder, and (3) the information from the other component decoder about the likely values of the concerned
bits. The information from the other decoder is referred to as a-priori information. The decoders use both
the inputs from the channel and this a-priori information for decoding. In addition, the decoders provide
the soft outputs for the decoded bits. This means that the decoders give the associated probabilities for
each bit it decoded. The soft outputs are usually called log likelihood ratios (LLRs). The sign of the LLR
gives the sign of the bit, and the amplitude of LLR gives the reliability of the decision.
14
Fig. 10. The encoder structure of RCPT codes.
Fig. 11. The system block diagram of Hybrid RCPT/ARQ system.
to obtain the combined diversity gain, we apply the hybrid RCPT/ARQ technique to the relay-based
cooperative communication systems. Again, we use the two-phase TDD-based relaying protocols. Each
terminal (source, relay, and destination) is designed with the hybrid RCPT/ARQ transceiver (transmitter
and receiver) architecture shown in Fig. 11.
Now, we interpret the system operation procedure based on the TDD-based relaying Protocol 2. In phase
I (the first time slot), the source transmits new data to the destination and the relay. If an error packet
occurs at the destination, the relay will retransmit old data to the destination in phase II (the second time
slot). By the process, the destination can use the HARQ technique to decode the data packets received
from the source and the relay to get the combining diversity (space and time) gain during two time slots.
Furthermore, according to different designs for the relay terminal, we classify the relay terminal to the
following different operation modes:
(1) Normal mode
The relay operating in normal mode does not buffer any data packet received from the source. In other
16
In modern wireless communications, we always need a high data rate or spectrally efficient transmission
for a mass data transferring. Transmission techniques which do not adapt to the fading channel require
a fixed link margin or coding to maintain an acceptable performance (or the quality of service) in deep
fades. Therefore, the systems are always designed for the worst-case channel conditions. This results in
inefficient utilization of the full channel capacity [22]. However, if the channel conditions are known at
the transmitter, we can achieve the full channel capacity theoretically by adjusting the transmit power,
data rate, and coding scheme to adapt to the fading channel. This idea is well known as the water-filling
technique, and the corresponding systems are named as adaptive modulation and coding (AMC) systems.
AMC systems have been widely adopted in modern communication standards. Besides, AMC technique
is also called as the link adaptation technique in many literatures and applications. In the next section, we
will introduce a simple adaptive throughput maximization algorithm for AMC systems with HARQ [23].
B. Adaptive Throughput Maximization Algorithm for AMC Systems with HARQ
1) System Model and Problem Description: In AMC systems, there are different modulation and
coding schemes (MCSs). The main challenge in AMC systems is to select the MCSs appropriately.
In single-antenna systems, the transmitter usually select the MCSs according to the SNR information
received from the receiver. In other words, the transmitter has to determine which MCS to be used for
the next transmission in the corresponding SNR range. Therefore, determination of the SNR thresholds
for switching MCS is very important. We show the performance difference between the systems with
correct and incorrect SNR thresholds in Fig. 12. The systems with correct SNR thresholds can achieve
higher throughput than the others with incorrect SNR thresholds. However, the process in determining
SNR thresholds is very complicated. It requires the knowledge of the relation of each MCS’s performance
on factors such as SNR, channel time-varying rate, system configuration and impairments, etc. So the
analytical solution for determining the SNR thresholds is very difficult. In addition, as the channel statistics
may vary with time, the optimal thresholds also change with time. Hence, we need an adaptive threshold
adjustment algorithm for AMC systems. Now, we introduce a simple adaptive threshold adjustment
algorithm for AMC systems with HARQ [23].
We consider the closed loop single-antenna system with HARQ mechanism. The receiver keeps measur-
ing the received SNR and feeds the SNR and ACK/NACK information back to the transmitter. Assume that
the transmit power is constant, while the transmitter can select different MCSs for different transmission
time intervals (TTIs) according to the feedback SNR. Let there be M available MCSs with nominal
transmission rates R1, . . ., RM, in increasing order. For simplicity, we assume a constant TTI, ξ, for all
MCSs, new transmission, and retransmission. The retransmissions of a frame use the same MCS as the
new transmission. For the ith MCS denoted MCSi, assuming that the ACK/NACK feedbacks are error-free,
the average throughput Γi can be calculated by the following:
Γi = lim
Ni→∞
NAiRiξ
Niξ
(18)
where Ni is the total number of TTIs used by MCSi, NAi is the number of ACKs generated for these Ni
TTIs. Because MCS is selected based on the feedback SNR, we define the feedback SNR as the parameter
γ. Then the average probability of successful decoding for any MCSi can be calculated by the following:
PAi(γ) = limNi,γ→∞
NAi,γ
Ni,γ
(19)
By using PAi(γ), the average throughput for MCSi can be alternatively written as
Γi = Ri
∫ ∞
−∞
PAi(γ)dF(γ) (20)
18
Ri
P(Aii)
P(Bii)
≈ Ri+1
P(Aii+1)
P(Bii+1)
(23)
where Bii is the event that a TTI using MCSi occurs with its corresponding frame’s SNR γ in the ith TB,
Bii+1 is the event that a TTI using MCSi+1 occurs with its corresponding frame’s SNR γ in the ith TB,
Aii is the event that an ACK is generated from B
i
i, and A
i
i+1 is the event that an ACK is generated from
Bii+1.
To make this algorithm more efficient based on the criterion (23), we set P(Aii) = P(A
i
i+1) technically
and adjust the thresholds by observing P(Bii) and P(B
i
i+1) (corresponding to the event B
i
i and B
i
i+1). When
the event Bii occurs, the right-hand-side of (23) will be larger than the left-hand-side of (23), and we
adjust the threshold λi by decreasing a step size δBii . On the contrary, when the event B
i
i+1 occurs, the
left-hand-side of (23) will be larger than the right-hand-side of (23), and we adjust the threshold λi by
increasing a step size δBii+1 . As an additional remark, we explain how to make P(A
i
i) = P(A
i
i+1) as the
following: When the event Aii occurs, all the following new frames with SNR γ in the ith TB will use
MCSi+1, until the next event Aii+1 occurs. On the contrary, when the event A
i
i+1 occurs, all the following
new frames with SNR γ in the ith TB will use MCSi, until the next event Aii occurs. This MCS selection
policy makes sure that Aii and A
i
i+1 occur in turn, thus they will have the same probability.
Finally, we illustrate the design of step size (δBii and δBii+1) such that the up and down adjustments for λi
will balance out. To achieve the above statement, the following equation must be established:
P(Bii+1)δBii+1 = P(B
i
i)δBii (24)
Comparing (23) and (24) given P(Aii) = P(A
i
i+1), we need
δBii+1
δBii
=
Ri
Ri+1
(25)
This shows that the step size is reversely proportional to the transmission rate.
C. Relay-based Cooperative Communication Systems with HARQ and AMC
S D
R
srγ
sdγ
rdγ
rdγ,
sdγ,
Fig. 14. The relay-HARQ-AMC system model.
We focus on the system with one source, one relay, and one destination as shown in Fig. 14. The main
feature of this system is the combination of different links (i.e., various channel combinations). In other
words, the transmitter (source or relay) in the relay system can obtain the channel information of different
links (S→D, S→R, and R→D) via the feedback transmissions (D→ S, R→ S, and D→R). Therefore, to
maximize the average sum-throughput at the destination, the source and relay should implement the AMC
algorithm based not only on their own channel quality to the destination (SNR γsd and γrd , respectively)
20
MCS MCS1 (Rc=1/2, QPSK), MCS2 (Rc=1/2, 16QAM),
MCS3 (Rc=3/4, 16QAM), MCS4 (Rc=3/4, 64QAM)
ARQ Stop-and-Wait ARQ
FEC Turbo Codes
HARQ Type-I, Type-II (IR)
Relaying Protocol TDD-based Protocol 1, 2
Relaying Algorithm Fixed, Selective
Operating Mode Normal, Smart
Channel Rayleigh fading + AWGN
TTI 2 ms
TABLE II
SIMULATION SETTINGS
B. Simulation Results
1) Fixed Relaying Algorithm: According to the above simulation settings, we first give the simulation
results in Fig. 16 to 19 for the use of fixed relaying algorithm with TDD-based relaying Protocol 2. To
observe the effect of link S→ R, we fix the SNR pair (γsd , γrd) and adjust the SNR γsr for different
MCSs in Fig. 16 to 19, where we give an 10dB gain for γrd (i.e., the relay is placed closer to the
destination than the source to the destination). It is shown that when we use the fixed relaying algorithm,
the system performance will be affected by the link S→ R severely. For different MCSs, the SNR γsr
must exceed a certain value such that the fixed relaying system outperforms the system without relay
(direct transmission case), even if the SNR of γrd is relatively high. This is the intrinsic drawback of
cooperative communication that the individual terminals have to cooperate through noisy links. When the
relay receives a signal suffering from a bad channel link S→ R, it will retransmit a more terrible signal
to the destination and result in an interference rather than an assistance.
In addition, we show another important result when comparing the AF relaying with the DF relaying. At
relatively low SNR of link S→ R, the AF relaying outperforms the DF relaying. A reversed result occurs
at relatively high SNR of link S→ R. We set an SNR switch point for the divide between them. Note
that the relatively low SNR and high SNR depend on different MCSs. This result gives us a conclusion
that the DF relaying is affected by the link S→ R more severely than the AF relaying. The reason is
that the DF relaying performs the decode and re-encode process. When the relay can not decode the
message correctly, it will re-encode the wrong message and result in a more terrible message sent to the
destination. On the contrary, the AF relaying performs the amplify and forward process. This effect is not
as severe as in the DF relaying.
Furthermore, we compare the normal mode with the smart mode. From Fig. 16 to 19, it is very clear
that the smart mode outperforms the normal mode in the corresponding AF or DF relaying. The additional
cost of the relay operating in the smart mode is the additional buffers to store the received packets.
2) Selective Relaying Algorithm: To improve the performance of DF relaying, we may use the selective
DF (SDF) relaying. In the SDF operation, the relay transmits data to the destination only when the data
received from the source is correctly decoded by the relay. Fig. 20 to 23 show the simulation results for
the SDF relaying with TDD-based relaying Protocol 2, where the simulation parameters are the same as
Fig. 16 to 19.
The deficient performance of the fixed DF relaying at relatively low SNR of link S→ R disappears
when we use the SDF relaying. The worst performance of SDF relaying is equal to the direct transmission
case. Comparing the SDF relaying with the fixed AF or DF relaying (all of them operate in the smart
mode) from Fig. 20 to 23, we conclude that the SDF relaying has the best performance among these
relaying algorithms.
3) Throughput Maximization Algorithm: We give the simulation result for the relay-HARQ-AMC
system in Fig. 24. In this simulation, we assume that the average of γsd , γsr, and γrd are the same
and set as γ. The source performs the adaptive throughput maximization algorithm based on γ (calculated
22
−20 −15 −10 −5 0 5 10 15 20 25 30
0
2
4
6
8
10
12
14
x 104
SNR (dB)
Av
er
ag
e 
Th
ro
ug
hp
ut
 (b
ps
)
MCS3 (−4dB, 6dB)
 
 
Normal AF
Normal DF
Smart AF
Smart DF
Direct
Fig. 18. The simulation result for fixed relaying (MCS3, Protocol 2).
−20 −15 −10 −5 0 5 10 15 20 25 30
0
0.5
1
1.5
2
2.5
3
x 105
SNR (dB)
Av
er
ag
e 
Th
ro
ug
hp
ut
 (b
ps
)
MCS4 (2dB, 12dB)
 
 
Normal AF
Normal DF
Smart AF
Smart DF
Direct
Fig. 19. The simulation result for fixed relaying (MCS4, Protocol 2).
24
−20 −15 −10 −5 0 5 10 15 20 25 30
0
2
4
6
8
10
12
14
x 104
SNR (dB)
Av
er
ag
e 
Th
ro
ug
hp
ut
 (b
ps
)
MCS3 (−4dB, 6dB)
 
 
Smart AF
Smart DF
Selective DF
Direct
Fig. 22. The simulation result for selective relaying (MCS3, Protocol 2).
−20 −15 −10 −5 0 5 10 15 20 25 30
0
0.5
1
1.5
2
2.5
3
x 105
SNR (dB)
Av
er
ag
e 
Th
ro
ug
hp
ut
 (b
ps
)
MCS4 (2dB, 12dB)
 
 
Smart AF
Smart DF
Selective DF
Direct
Fig. 23. The simulation result for selective relaying (MCS4, Protocol 2).
26
−20 −15 −10 −5 0 5 10 15 20 25 30
0
1
2
3
4
5
6
7
8
9
10
x 104
SNR (dB)
Av
er
ag
e 
Th
ro
ug
hp
ut
 (b
ps
)
MCS2 (−6dB, 4dB)
 
 
Normal AF
Normal DF
Smart AF
Smart DF
Direct
Fig. 26. The simulation result for fixed relaying (MCS2, Protocol 1).
−20 −15 −10 −5 0 5 10 15 20 25 30
0
2
4
6
8
10
12
14
x 104
SNR (dB)
Av
er
ag
e 
Th
ro
ug
hp
ut
 (b
ps
)
MCS3 (−4dB, 6dB)
 
 
Normal AF
Normal DF
Smart AF
Smart DF
Direct
Fig. 27. The simulation result for fixed relaying (MCS3, Protocol 1).
28
−20 −15 −10 −5 0 5 10 15 20 25 30
0
1
2
3
4
5
6
7
8
9
10
x 104
SNR (dB)
Av
er
ag
e 
Th
ro
ug
hp
ut
 (b
ps
)
MCS2 (−6dB, 4dB)
 
 
Smart AF
Smart DF
Selective DF
Direct
Fig. 30. The simulation result for selective relaying (MCS2, Protocol 1).
−20 −15 −10 −5 0 5 10 15 20 25 30
0
2
4
6
8
10
12
14
x 104
SNR (dB)
Av
er
ag
e 
Th
ro
ug
hp
ut
 (b
ps
)
MCS3 (−4dB, 6dB)
 
 
Smart AF
Smart DF
Selective DF
Direct
Fig. 31. The simulation result for selective relaying (MCS3, Protocol 1).
average SNRs of link S→D and link R→D are the same and the SNR of link S→ R has an 20dB gain
over link S→D and link R→D (i.e., the source and relay are placed close to each other such that they are
more like the two-antenna system). For the system with type-I HARQ, the normal AF relay outperforms
the direct transmission, and the selective DF relay outperforms the normal AF relay. We get the benefit of
space diversity by using the cooperative transmission. For the system with type-II HARQ (IR mode), we
also have similar results as the type-I HARQ case. But the space diversity gain is reduced when operating
in type-II HARQ (IR mode). The reason is that the system reliability of direct transmission is dramatically
increased by the type-II HARQ (IR mode). In summary, we get the diversity combining gain in space
30
−20 −15 −10 −5 0 5 10 15 20 25 30
0
1
2
3
4
5
6
7
x 104
SNR (dB)
Av
er
ag
e 
Th
ro
ug
hp
ut
 (b
ps
)
MCS1 (−10dB, 0dB)
 
 
Smart AF (Protocol 2)
Smart DF (Protocol 2)
Smart AF (Protocol 1)
Smart DF (Protocol 1)
Direct
Fig. 34. The simulation result of (fixed relaying, MCS1) with different protocols.
−20 −15 −10 −5 0 5 10 15 20 25 30
0
0.5
1
1.5
2
2.5
3
x 105
SNR (dB)
Av
er
ag
e 
Th
ro
ug
hp
ut
 (b
ps
)
MCS4 (2dB, 12dB)
 
 
Smart AF (Protocol 2) 
Smart DF (Protocol 2)
Smart AF (Protocol 1)
Smart DF (Protocol 1)
Direct
Fig. 35. The simulation result of (fixed relaying, MCS4) with different protocols.
relaying algorithms were analyzed case by case. The most common solution is the fixed relaying algorithm.
When using the fixed relaying algorithm, we have to avoid operating at low SNR of the link S→ R. If
the relay is smart enough, we may choose another solution that is the selective relaying algorithm. When
using the selective relaying algorithm, we do not need to care about the SNR of link S→ R.
In addition, the adaptive throughput maximization algorithm worked successfully in the relay-HARQ-
AMC system. When using the adaptive throughput maximization algorithm, we have to consider the
channel information of different links (S→ D, S→ R, and R→ D), then make the MCS selection and
threshold adjustment based on the combined SNR of γsd , γsr, and γrd . Furthermore, we compared the
relay-HARQ-AMC sytem with different TDD-based protocols. Protocol 1 outperforms the Protocol 2 in
32
−10 −5 0 5 10 15 20 25 30
0
2
4
6
8
10
12
x 105
SNR (dB)
Av
er
ag
e 
Th
ro
ug
hp
ut
 (b
ps
)
Diversity Gain (Type−II HARQ, IR, MCS4)
 
 
Direct
Normal AF (Protocol 2)
Selective DF (Protocol 2)
Selective DF (Protocol 1)
Fig. 38. The simulation result of combination diversity gain (Type-II HARQ, IR mode).
general. However, the practical implementation of Protocol 1 will result in an additional cost on the receiver
complexity and the transmission power. Therefore, we may choose Protocol 2 in the TDMA system while
choosing Protocol 1 in the CDMA system. Finally, from the simulation results, we conclude that we
get the diversity combining gain successfully. Our simulation results are all based on the parameters of
HSDPA which may be easily extend to LTE. So these results may be useful for practical applications.
Compared to the work items we had specified in the proposal for the second year, our progress is
slightly behind in the compress-and-forward (CF) relaying scheme, although we had fulfilled all the other
tasks. This is because so far there is no practical but effective CF coding method that can be applied to
HARQ in relay channels. Together with distributed coding, designing a CF coding scheme will be the
main focus of the third year.
REFERENCES
[1] J. Mitola III, “Cognitive radio: An integrated agent architecture for software defined radio,” Ph.D. Thesis, KTH Royal Inst. Technology,
Stockholm, Sweden, 2000.
[2] T. A. Weiss and F. K. Jondral, “Spectrum pooling: An innovative strategy for the enhancement of spectrum efficiency,” IEEE Commun.
Mag., vol. 42, no. 3, pp. 8–14, Mar. 2004.
[3] A. N. T. Hunter and A. Hedayat, “Cooperative communication in wireless networks,” IEEE Communications Magazine, vol. 42, no. 10,
pp. 74–80, Oct. 2004.
[4] O. S. Shin, A. Chan, H. Kung, and V. Tarokh, “Design of an OFDM cooperative space-time diversity system,” to appear in IEEE
Trans. on Vehicular Technology.
[5] P. Mitran, H. Ochiai, and V. Tarokh, “Space-time diversity enhancements using collaborative communications,” IEEE Trans. Inform.
Theory, vol. 51, no. 6, pp. 2041 –2057, Jun 2005.
[6] H. Ochiai, P. Mitran, H. Poor, and V. Tarokh, “Collaborative beamforming for distributed wireless ad hoc sensor networks,” IEEE
Trans. Signal Processing, vol. 53, pp. 4110–4124, 2005.
[7] B. Wang, J. Zhang, and A. Host-Madsen, “On the capacity of MIMO relay channels,” IEEE Trans. Inform. Theory, vol. 51, no. 1, pp.
29 –43, Jan 2005.
[8] A. Nostratinia, “Cooperative communication in wireless networks,” in IEEE Comm. Magazine, 2004, pp. 74–80.
[9] R. U. Nabar, H. Bolcskei, and F. Kneubuhler, “Fading relay channels: Performance limits and space-time signal design,” IEEE J. Select.
Areas Commun., vol. 22, no. 6, pp. 1099–1109, Aug. 2004.
[10] T. M. Cover and A. A. E. Gamal, “Capacity theorems for the relay channel,” IEEE Trans. Inform. Theory, pp. 572–584, Sept. 1979.
[11] H. Ochiai, P. Mitran, and V. Tarokh, “Variable rate two phase collaborative communication protocols for wireless networks,” IEEE
Trans. Inform. Theory, vol. 52, no. 9, pp. 4299–4313, Sept. 2006.
[12] F. H. Fitzek, Cooperative in Wireless Networks: Principles and Applications, 1st ed. Springer, Inc., 2006.
 1
 
國科會補助專題研究計畫項下出席國際學術會議心得報告 
                                     日期： 99 年 10 月 5 日 
一、參加會議經過 
9 月 26 日由台灣出發，於 9月 27 日清晨抵達伊斯坦堡開始 PIMRC 2010 的正式議程
（9 月 26 日為短期課程）。除了在 9 月 27 日至 9月 29 日聽取其他研究人員的研究成
果外，並分別於 9月 28 日下午 3:10 及 9 月 29 日上午 11:40 報告我們的論文” A 
計畫編號 NSC 99-2219-E-002-019 
計畫名稱 無線感知式協同型網狀網路之研究--子計畫三：無線感知式協同型多
工存取之分散式編碼架構(2/3) 
出國人員
姓名 蘇炫榮 
服務機構
及職稱 台大電信工程研究所 
會議時間 99年 9月 26日至 99 年 9 月 29 日 會議地點 土耳其伊斯坦堡 
會議名稱 
(中文)IEEE 2010 個人、室內及行動通訊研討會 
(英文)IEEE PIMRC 2010 
發表論文
題目 
(中文)1. ALOHA 網路的預防作弊及增加傳輸成功率的機制 
2. 多用戶多天線系統的多區段降低通道回饋頻寬方法 
(英文)1. Throughput Improvement in ALOHA Networks with Power 
Capture and a Cheat-proof Access Control 
2. A Multi-threshold Scheme for Feedback Load Reduction in 
Multiuser MIMO Broadcast Channel 
附件四 
Throughput Improvement in ALOHA Networks
with Power Capture and a Cheat-proof Access
Control
Fu-Te Hsu and Hsuan-Jung Su
Graduate Institute of Communication Engineering
Department of Electrical Engineering
National Taiwan University, Taipei, Taiwan
Email: f96942059@ntu.edu.tw, hjsu@cc.ee.ntu.edu.tw
Abstract—In this paper, we consider the problem of power
level selections under an average power constraint in slotted
ALOHA networks. In the network, each node chooses a power
level from a pre-determined power level set based on a probability
for each access attempt. The derivation of the probability for
maximizing the throughput is difficult. In addition, nodes may
not always obey the given algorithm in a distributed network
because a misbehaving node might gain better performance at
the expense of the others. To prevent the potential of misbehavior,
we derive a cheat-proof algorithm based on game theory, which
will make no nodes in the network want to deviate from the
algorithm. Further, we show the throughput loss of the cheat-
proof algorithm compared to the optimal one, and show the
occurrence of unjust situation if the property of cheat-proof is
not taken into account.
I. INTRODUCTION
In this paper, we study improving the throughput of
ALOHA networks [1][2] by power capture. ALOHA networks
and its variants have been well studied over more than thirty
years, and many methods were proposed to improve the
efficiency of ALOHA networks. The use of multiple power
levels to artificially introduce power capture is a simple and
effective method for increasing the throughput of ALOHA
networks, and was first proposed and analyzed by Metzner
[3]. It was shown that by simply dividing nodes into two
classes with one transmitting at high power level and the other
transmitting at low power level, the throughput of a slotted
ALOHA can be increased from 0.368 to about 0.53. Later on,
[5][6] proposed to let each node transmit with different powers
from a set of pre-selected power levels according to a given
probability distribution, to avoid the unfair treatment in [3]
of the class of nodes that were assigned lower power level.
A detailed work in formulating the throughput optimization
problem was done in [4]. The authors of [4] studied a finite
number of nodes in a slotted ALOHA system, where each node
randomly chooses one of the power levels during each access
attempt. The optimal probability for choosing each power level
was presented in a recursive form, and the values of power
This work was supported by the National Science Council, Taiwan, R.O.C.,
under grant NSC 98-2219-E-002-016, and the Industrial Technology Research
Institute (ITRI) under grant 99-EC-17-A-05-01-0626.
levels to maximize the throughput were also discussed. In
addition, the maximum throughput derived under a saturation
assumption (i.e., nodes always have packets whenever they
take an access attempt) was shown to be the same as Metzner’s
result from a Poisson traffic model.
However, the works mentioned above only considered
throughput as the performance measure. The power budget
was taken into account in [7], and a search method was
adopted to obtain the optimal probability for choosing each
power level due to the nonlinear optimization problem. In [8],
the power-throughput characteristics of the optimum power
level selection algorithms in conjunction with the exponential
backoff retransmission scheme in ALOHA networks were
addressed.
Recently, the issue that a misbehaving node in a network
might gain better performance at the expense of honest par-
ticipants has been paid attention to. There have been many
researches on detecting the misbehaving nodes and analyzing
the resulting performance in the MAC layer, for example,
[9]–[14]. A useful tool to analyze such distributed networks
with self-configuring nodes is the game theory, and Nash
equilibrium (named after John Nash) is a solution concept of
a game. We refer the readers to [15] and [16] for the details.
All the above mentioned power selection algorithms have
not considered the potential problem of misbehavior in a
distributed network. This motivates us to study whether it is
possible to design a cheat-proof algorithm such that no node
will want to deviate. And if such a cheat-proof access control
exists, what is the performance loss compared to the optimum?
In this paper, we will deal with these questions, and show that
they are related to the notion of Nash equilibrium.
In this paper, we consider the problem of power level
selections under an average power constraint in an ALOHA
network which consists a finite number of nodes. Through
analysis, we find a cheat-proof power level selection solution
for the set of linearly equi-spaced power levels and logarith-
mically equi-spaced power levels, and compare the resulting
throughputs with the optimal throughput. In addition, the
conventional ALOHA without exploiting power capture is also
considered for comparisons. Our previous work [17], which
2010 IEEE 21st International Symposium on Personal Indoor and Mobile Radio Communications978-1-4244-8016-6/10/$26.00 ©2010 IEEE 1447
variables 𝑥𝑖 for 𝑖 = 0, . . . ,𝐾 has solution (𝑥0, . . . , 𝑥𝐾) =
(?˜?0, . . . , ?˜?𝐾):
minimize : −𝜏 = −
𝐾∑
𝑖=1
𝑥𝑖
⎛
⎝𝑖−1∑
𝑗=0
?˜?𝑗
⎞
⎠
𝑛−1
(6)
subject to :
⎧⎨
⎩
∑𝐾
𝑖=0 𝑥𝑖 = 1,∑𝐾
𝑖=0 𝑔(𝑖)𝑥𝑖 = 𝑐,
𝑥𝑖 ≥ 0 ∀ 𝑖.
(7)
Note that the equality constraint is considered for the average
power. This is because if (𝑥0, 𝑥1, . . . , 𝑥𝐾) is a solution to
the optimization problem without the equality in the average
power, we may increase the probabilities of high power levels
and decrease the probabilities of low power levels to achieve a
higher throughput, which contradicts the fact that the solution
is optimal.
By the theory of convex optimization, for (𝑥0, . . . , 𝑥𝐾) =
(?˜?0, . . . , ?˜?𝐾) to be the solution, the following Karush-Kuhn-
Tucker (KKT) conditions are necessary and sufficient for
(𝑥0, . . . , 𝑥𝐾) = (?˜?0, . . . , ?˜?𝐾) since constraints are affine
functions [20]:
∂(−𝜏)
∂𝑥𝑖
+ 𝛾1 + 𝑔(𝑖)𝛾2 ≥ 0, 𝑖 = 0, 1, . . . ,𝐾. (8)
?˜?𝑖 ⋅
(
∂(−𝜏)
∂𝑥𝑖
+ 𝛾1 + 𝑔(𝑖)𝛾2
)
= 0, 𝑖 = 0, 1, . . . ,𝐾. (9)
𝐾∑
𝑖=0
?˜?𝑖 = 1. (10)
𝐾∑
𝑖=0
𝑔(𝑖)?˜?𝑖 = 𝑐. (11)
?˜?𝑖 ≥ 0, 𝑖 = 0, 1, . . . ,𝐾, (12)
where 𝛾1, 𝛾2 ∈ R, the partial derivative ∂(−𝜏)∂𝑥0 = 0, and
∂(−𝜏)
∂𝑥𝑖
= −
(∑𝑖−1
𝑗=0 ˜𝑗
)𝑛−1
for 𝑖 = 1, . . . ,𝐾 .
We need to find (?˜?0, . . . , ?˜?𝐾) satisfying all the above
conditions. First, we have 𝛾1 = 0 since ?˜?0 > 0. In [17], we
have shown that when 𝑛 = 2, the solution of (?˜?0, . . . , ?˜?𝐾) is
unique, and that there exists an index 𝐿 such that ˜𝑖 > 0 for
𝑖 = 1, . . . , 𝐿 and ?˜?𝑖 = 0 for 𝑖 > 𝐿. In this work, we find a
solution of (?˜?0, . . . , ˜𝐾) with ?˜?𝑖 > 0 for 𝑖 = 1, . . . , 𝐿 and
?˜?𝑖 = 0 for 𝑖 > 𝐿. In this case, (8) and (9) become⎧⎨
⎩
(∑𝑖−1
𝑗=0 ?˜?𝑗
)𝑛−1
= 𝑔(𝑖)𝛾2, 𝑖 = 1, . . . , 𝐿(∑𝑖−1
𝑗=0 ?˜?𝑗
)𝑛−1
≤ 𝑔(𝑖)𝛾2, 𝑖 = 𝐿+ 1, . . . ,𝐾
˜𝑖 > 0, 𝑖 = 1, . . . , 𝐿
˜𝑖 = 0, 𝑖 = 𝐿+ 1, . . . ,𝐾.
(13)
Using (13) and ∑𝐾𝑖=0 ?˜?𝑖 = 1, we have
˜𝑖 = (𝑔(𝑖+ 1)
1
𝑛−1 − 𝑔(𝑖) 1𝑛−1 )𝛾
1
𝑛−1
2 , 𝑖 = 0, . . . , 𝐿− 1 (14)
˜𝐿 = 1− 𝑔(𝐿) 1𝑛−1 𝛾
1
𝑛−1
2 . (15)
0 0.2 0.4 0.6 0.8 1
0.35
0.4
0.45
0.5
0.55
0.6
x
f ’
 (x
)
Fig. 1. The plot of function 𝑓 ′(𝑥) =
(
1
3
)𝑥
ln 3 +
(
2
3
)𝑥
ln 3
2
− 1
(𝑥+1)2
.
Using (13) with 𝑖 = 𝐿 + 1 and ˜𝐿 > 0 given by (15), we
obtain the relations about the integer 𝐿 as follows:
1
𝑔(𝐿+ 1)
≤ 𝛾2 < 1
𝑔(𝐿)
. (16)
In the following, we will study two cases of power level
distributions. Other power level distributions can be similarly
derived.
A. Case study 1: linearly equi-spaced power levels
In this subsection, we will derive the Nash equilibrium for
a set of linearly equi-spaced power levels {𝑔(1), . . . , 𝑔(𝐾)} =
{1, 2, . . . ,𝐾}. Substituting (14) and (15) into the average
power constraint
∑𝐿
𝑖=1 𝑔(𝑖)?˜?𝑖 = 𝑐, we have
𝛾2 =
(
𝐿− 𝑐∑𝐿
𝑖=1(𝑖)
1
𝑛−1
)𝑛−1
. (17)
One goal of the paper is to study the throughput improve-
ment with power capture over the conventional one under an
average power constraint. In order to make fair comparisons,
we will study the case 𝑐 = 1𝑛 in this work since in the
conventional ALOHA, the throughput limit is obtained when
nodes transmit with probability equal to 1𝑛 .
For 𝑐 = 1𝑛 , by (16) and (17), we have
𝐿−
∑𝐿
𝑖=1(𝑖)
1
𝑛−1
(𝐿)
1
𝑛−1
<
1
𝑛
≤ 𝐿−
∑𝐿
𝑖=1(𝑖)
1
𝑛−1
(𝐿+ 1)
1
𝑛−1
(18)
Note that 𝐿 −
∑𝐿
𝑖=1(𝑖)
1
𝑛−1
(𝐿)
1
𝑛−1
is increasing in 𝐿. When 𝐿 = 3,
the left inequality in (18) becomes
3− 1 + 2
1
𝑛−1 + 3
1
𝑛−1
3
1
𝑛−1
<
1
𝑛
. (19)1449
2 2.1 2.2 2.3 2.4 2.5 2.6 2.7
0.041
0.042
0.043
0.044
0.045
0.046
0.047
0.048
a
th
ro
ug
hp
ut
n=10, c=1/n, g(x)=ax−1
the two cheaters
 the victims
opt. sol
Fig. 4. The results when two cheaters in the network deviate from the
mandated access scheme (the optimal solution).
?˜?1 = (𝑎
1
𝑛−1 − 1) 𝑎− 𝑐
1 + (𝑎− 1)𝑎 1𝑛−1
,
?˜?2 = (1− 𝑎 2𝑛−1 ) 𝑎− 𝑐
1 + (𝑎− 1)𝑎 1𝑛−1
.
We use brute force search to find the optimal solution of the
optimization problem. The results of the transmission proba-
bilities are shown in Fig. 2, and the resulting total throughput
in the network are shown in Fig. 3. The throughputs of
the conventional ALOHA and the optimal solution without
considering the average power constraint [4] are also included
for comparison.
In Fig. 4, we show that if there are two cheaters in the
network that deviate from the mandated access scheme (the
optimal solution), aiming to maximize their own throughputs
by the linear programming for (3), the throughput of the
two cheaters can be improved significantly, at the cost of
performance loss of the other nodes (victims).
Our figures show that the ”real” improvement is not that
much as presented in [3][4] compared to the conventional
ALOHA when a fair comparison is made. Besides, the Nash
equilibrium solution improves the throughput of conventional
to about 0.39 ∼ 0.44 when 𝑎 ∈ [2, 2.5], and the difference
to the optimal solution is smaller when 𝑎 decreases to 2.
Moreover, we also show that an unjust situation may occur
when the property of cheat-proof is not taken into account in
the access scheme.
V. CONCLUSION
In this paper, the problem of power level selections under
an average power constraint in slotted ALOHA networks
was studied. To prevent misbehavior in the network, we
derived an access control taking the property of cheat-proof
into account for the set of linearly equi-spaced power levels
and logarithmically equi-spaced power levels. For the set of
linearly equi-spaced power levels, we presented a cheat-proof
(Nash equilibrium) solution that uses no larger than two power
levels. For the set of logarithmically equi-spaced power levels,
we showed that if the power step 𝑎 in the set is much greater
than 2.5, then the conventional ALOHA that uses only one
power level is a cheat-proof (Nash equilibrium) solution.
One direction for our future work is to consider SIR
capture model. Another challenging direction is to consider an
asymmetric network in which each node may have a different
power constraint.
REFERENCES
[1] N. Abramson, “The throughput of packet broadcasting channels,” IEEE
Trans. Commun., vol. COM-25, pp. 117–128, 1977.
[2] L. G. Roberts, “ALOHA packet system with and without slots and
capture,” Comput. Commun. Rev., pp. 28–42, Apr. 1975.
[3] J. J. Metzner, “On improving utilization in ALOHA networks,” IEEE
Trans. Commun., vol. 24, pp. 447–448, 1976.
[4] R. O. LaMaire, A. Krishna, and M. Zorzi, “On the randomization of
transmitter power levels to increase throughput in multiple access radio
systems,” Wireless Networks, vol. 4, pp. 263–277, 1998.
[5] N. Shacham, “Throughput-delay performance of packet swithching
multiple-access channel with power capture,” Performance Evaluation,
pp. 153–170, 1984.
[6] C. C. Lee, “Random signal levels for channel access in packet broadcast
networks,” IEEE J. Sel. Areas Commun., vol. 5, pp. 1026–1034, July
1987.
[7] Y.-W. Leung, “Mean power consumption of artificial power capture in
wirelss networks,” IEEE Trans. Commun., vol. 45, pp. 957–964, Aug.
1997.
[8] B. Khoshnevis and B. H. Khalaj, “Optimum power selection algorithms
in Aloha newtowks: ranodm and deterministic approaches,” IEEE Trans.
Wireless Commun., vol. 6, pp. 3124–3136, Aug. 2007.
[9] P. Kyasanur and N. H. Vaidya, “SelfishMAC layer misbehavior in
wireless networks,” IEEE Trans. Mob. Comput., vol. 4, no. 5, pp. 502–
516, 2005.
[10] M. Cagalj, S. Ganeriwal, I. Aad, and J.-P. Hubaux, “On cheating in
CSMA/CA ad hoc networks,” in Proc. IEEE INFOCOM, 2005.
[11] P. Serrano, A. Banchs, and J. Kukielka, “Detection of malicious pa-
rameter congurations in 802.11e EDCA,” in Proc. IEEE GLOBECOM,
2005.
[12] A. L. Toledo and X. Wang, “Robust detection of selfish misbehavior
in wireless networks,” IEEE J. Sel. Areas Commun., vol. 25, no. 6,
pp. 1124–1134, 2007.
[13] A. A.Ca´rdenas, S. Radosavac, and J. S. Baras,“Evaluation of detec-
tion algorithms for MAC layer misbehavior: theory and experiments,”
IEEE/ACM Trans. Netw., vol. 17, no. 2, pp. 605–617, Apr. 2009.
[14] S. Szott, “Assuring QoS in wireless mesh networks with misbehaving
users,” in Proc. IEEE INFOCOM, 2009.
[15] A. B. MacKenzie and S. B. Wicker, “Game theory and the design of self-
configuring, adaptive wireless networks,” IEEE Commun. Mag., pp. 126–
131, Nov. 2001.
[16] M. J. Osborne and A. Rubinstein, A Course in Game Theory, The MIT
Press, 1994.
[17] F.-T. Hsu and H.-J. Su, “Cheat-proof and optimal access controls in a
pairwise interaction network,” in Proc. IEEE WCNC, 2010.
[18] E. Altman, I. Menache and A. Sua´rez, “Team and noncooperative
solutions to access control with priorities,” in Proc. IEEE INFOCOM,
2009.
[19] G. B. Dantzig and M. N. Thapa, Linear Programming: Introduction,
Springer-Verlag, 1997.
[20] S. Boyd and L. Vandenberghe, Convex Optimization, Cambridge Uni-
versity Press, 2004.1451
Fig. 1. Multiuser MIMO downlink system model.
there are 𝐾 receivers each having single receive antenna.
According to the ORB strategy for multiuser transmission, the
BS uses a precoding matrix W = [w1,w2, ...w𝑀 ], where
w𝑖 ∈ ℂ𝑀 , 𝑖 = 1, 2 ⋅ ⋅ ⋅𝑀 , are random orthogonal vectors
generated from isotropic distribution [6]. The received signal
at the 𝑘-th user can be mathematically described as:
𝑟𝑘 = h𝑘W𝑠+ 𝑛𝑘 (1)
where h𝑘 is the complex Gaussian channel vector between the
BS and the 𝑘-th user with independent identically distributed
(i.i.d.) complex Gaussian random entries having zero mean
and unit variance. The vector s ∈ ℂ𝑀 is the transmitted
signal vector, and 𝑛𝑘 ∈ ℂ is the additive white Gaussian noise
(AWGN) at the 𝑘-th receiver with zero mean and variance
𝜎2. It is assumed that the feedback channel is error-free and
delay-free. The total transmitted power is a constant 𝑃𝑡 so that
𝔼{s𝐻s} = 𝑃𝑡. Each beam is equally allocated with power
𝑃𝑡/𝑀 .
III. USER SELECTION AND POST-SCHEDULING SINR
STATISTICS
According to the system model described in Section II,
the received signal for user 𝑘 when beamformer vector w𝑖
is desired can be re-written from (1) as:
𝑟𝑘,𝑖 = h
𝑇
𝑘w𝑖𝑠𝑖 +
𝑀∑
𝑗=1,𝑗 ∕=𝑖
h𝑇𝑘w𝑗𝑠𝑗 + 𝑛𝑘, 𝑖 = 1, 2 ⋅ ⋅ ⋅𝑀 (2)
where 𝑠𝑖 is the transmitted symbol on the 𝑖-th beam. The last
two terms in (2) are the interference and noise terms, and the
corresponding SINR is
𝑆𝐼𝑁𝑅𝑘,𝑖 =
∣h𝑇𝑘w𝑖∣
2
𝑀
𝜌 +Σ
𝑀
𝑗=1,𝑗 ∕=𝑖∣h𝑇𝑘w𝑗 ∣2
=
𝑍𝑖
𝑀
𝜌 +𝑊𝑖
(3)
where 𝜌 = 𝑃𝑡𝜎2 . Since the channels are assumed to be i.i.d.
Rayleigh and the precoder W is a unitary matrix, the variables
𝑍𝑖 = ∣h𝑇𝑘w𝑖∣, 𝑊𝑖 = Σ𝑀𝑗=1,𝑗 ∕=𝑖∣h𝑇𝑘w𝑗 ∣2 are independent
chi-square distributions, 𝑍𝑖 ∼ 𝜒(2), 𝑊𝑖 ∼ 𝜒(2𝑀 − 2),
respectively [7]. Then the probability density function (PDF)
and cumulative density function (CDF) of the SINR, ∀𝑘, 𝑖, can
be derived as [11]
𝐹𝑆𝐼𝑁𝑅(𝑥) = 1− 𝑒
−𝑥𝑀
𝜌
(1 + 𝑥)𝑀−1
, (4)
𝑓𝑆𝐼𝑁𝑅(𝑥) =
𝑒
−𝑥𝑀
𝜌
(1 + 𝑥)𝑀
{
𝑀
𝜌
(1 + 𝑥) +𝑀 − 1
}
. (5)
The scheduling method at the BS is to select the best SINR
in each beam direction in order to maximize the sum rate.
Hence, for beam direction 𝑖, the scheduler selects the active
user 𝑘 satisfying
𝑘∗𝑖 = arg max
𝑘=(1,2⋅⋅⋅𝐾)
𝑆𝐼𝑁𝑅𝑘,𝑖, 𝑖 = 1, 2 ⋅ ⋅ ⋅𝑀. (6)
Theorem 1: Let 𝑋(1) ≤ 𝑋(2) ≤ ⋅ ⋅ ⋅ ≤ 𝑋(𝐾) be the order
statistics of i.i.d. continuous random variables 𝑋1, 𝑋2, . . . ,
𝑋𝐾 , with the common PDF 𝑓 and CDF 𝐹 . Then 𝐹(𝑘) and
𝑓(𝑘), the PDF and CDF of 𝑋(𝑘), respectively, are given by
[12]:
𝐹(𝑘)(𝑥) =
𝐾∑
𝑖=𝑘
𝐾!{𝐹 (𝑥)}𝑖{1− 𝐹 (𝑥)}𝐾−𝑖
(𝑖)!(𝐾 − 𝑖)! ,−∞ < 𝑥 <∞,
𝑓(𝑘)(𝑥) =
𝐾!𝑓(𝑥){𝐹 (𝑥)}𝑘−1{1− 𝐹 (𝑥)}𝐾−𝑘
(𝑘 − 1)!(𝐾 − 𝑘)! ,−∞ < 𝑥 <∞.
From the above theorem, the CDF of the best 𝑆𝐼𝑁𝑅𝑘,𝑖 can
be expressed as:
𝐹𝑆𝐼𝑁𝑅∗𝐾 (𝑥) = (𝐹𝑆𝐼𝑁𝑅(𝑥))
𝐾 =
{
1− 𝑒
−𝑥𝑀
𝜌
(1 + 𝑥)𝑀−1
}𝐾
. (7)
By differentiating (7), the corresponding PDF is given as:
𝑓𝑆𝐼𝑁𝑅∗𝐾 (𝑥) = 𝐾
𝑒
−𝑥𝑀
𝜌
(1 + 𝑥)𝑀
{
𝑀
𝜌
(1 + 𝑥) +𝑀 − 1
}
×
{
1− 𝑒
−𝑥𝑀
𝜌
(1 + 𝑥)𝑀−1
}𝐾−1
. (8)
Finally, the sum rate 𝑅 can be derived as follows:
𝑅 ≈ 𝔼
{
𝑀∑
𝑖=1
𝑙𝑜𝑔2(1 + max
1≤𝑘≤𝐾
𝑆𝐼𝑁𝑅𝑘,𝑖)
}
= 𝑀𝔼
{
𝑙𝑜𝑔2(1 + max
1≤𝑘≤𝐾
𝑆𝐼𝑁𝑅𝑘,𝑖)
}
= 𝑀
∫ ∞
0
𝑙𝑜𝑔2(1 + 𝑥)𝑓𝑆𝐼𝑁𝑅∗𝐾 (𝑥)𝑑𝑥. (9)
IV. MULTI-THRESHOLDS STRATEGIES
For the purpose of scheduling, the users need to feedback
their CSI to the BS. In the system in consideration, the CSI is
the SINRs of all beams. Considering that with the maximum
sum rate criterion, the scheduler rarely selects the user whose
SINR is relatively low, it is obviously that allowing the users
with low SINRs to feedback may result in system inefficiency
in terms of reducing the feedback load. Thus, in order to
reduce the feedback load, we propose to divide the possible516
0 10 20 30 40 50 60 70 80 90 100
2
3
4
5
6
7
8
9
10
Number of users
Su
m
 ra
te
(bp
s/H
z)
 
 
Full CSI
simulation in eq (16)
approximation in eq (16)
Fig. 3. Comparison of sum rates obtained by the mathematical approximation
and simulation when B = (0, 0, 0, 3) (𝜌 = 20dB).
B. Bit Allocation
The natural question to ask is how to allocate bits to these
𝑁 regions. Due to the symmetric assumption that the users
suffer from i.i.d. Rayleigh fading, all the users will have the
same probability 1𝐾 of being ranked 𝑗, 𝑗 = 1, 2 ⋅ ⋅ ⋅𝑁 , on
their strongest beam directions. Thus, the expected number of
feedback bits required in addition to the rank bits is
∑𝑁
𝑗=1
𝑏𝑗
𝐾 .
Dropping the constant, the bit assignment problem for a given
beam 𝑚 becomes
max
B
𝑅𝑞(B)
s.t.
𝑁∑
𝑗=1
𝑏𝑗 = 𝐵𝑄, 𝑏𝑗 ∈ ℤ+. (17)
1) Optimal Bit Allocation: (17) can be solved by allocating
one bit at a time according to the contribution of one additional
bit to the sum rate in each region. At the s-th single bit
allocation stage, the sum rate difference between using 𝑏𝑙,𝑠−1
bits and 𝑏𝑙,𝑠−1 + 1 bits in region 𝑙 can be expressed as
△𝑅𝑙(𝑠) = 𝑅𝑙𝑏𝑙,𝑠−1+1(𝑠)−𝑅𝑙𝑏𝑙,𝑠−1(𝑠), 𝑙 = 1, 2 ⋅ ⋅ ⋅ , 𝑁 (18)
where 𝑏𝑙,𝑠−1 is the number of bits used to quantize region
𝑙 at the (𝑠 − 1)th bit allocation stage, and 𝑅𝑙𝑏𝑙,𝑠−1(𝑠) is the
sum rate of region 𝑙 using 𝑏𝑙,𝑠−1 bits to quantize at the s-
th single bit allocation stage. The region which results in the
maximum sum rate increment is the best choice for the s-th
bit. According to this method, the algorithm needs to record
the allocations of the previous bits until the total number of
quantization bits (𝑠 = 𝐵𝑄) are all allocated.
2) Fast Bit Allocation Method : Given that the sum rate
expression (16) can not be simplified, we alternatively aim
to minimize the total quantization error variance as a simple
suboptimal solution. The probability density function in region
𝑗 for a given beam 𝑚 is
𝑓ℜ𝑗 (𝑥) =
𝑓𝑆𝐼𝑁𝑅(𝑥)
𝑃 (𝑆𝐼𝑁𝑅𝑘,𝑚 ∈ ℜ𝑗)
= 𝐾𝑓𝑆𝐼𝑁𝑅(𝑥) (19)
and the signal variance in region 𝑗 can be expressed as
𝜎2𝑥,𝑗 =
(∫
ℜ𝑗
𝑥2𝑓ℜ𝑗 (𝑥)𝑑𝑥
)
−
(∫
ℜ𝑗
𝑥𝑓ℜ𝑗 (𝑥)𝑑𝑥
)2
.
Thus, the variance of quantization error using 𝑏𝑗 bits can be
bounded by [14]
𝜎2𝑒,𝑗 ≤ 𝜖2
𝜎2𝑥,𝑗
2𝑏𝑗
(20)
where the constant 𝜖 is source dependent. For example, 𝜖 = 1.0
is used for uniformly distributed sources and 𝜖 = 2.17 for
Gaussian source. Furthermore, we relax the constraint of the
quantization bits in (17) from being a positive integer to being
a positive real number. Again, dropping the constant, the bit
allocation problem can be formulated based on minimizing
the upper bound of the average quantization error variance,
according to (20), as
min
B=(𝑏1,⋅⋅⋅ ,𝑏𝑁 )
𝑁∑
𝑗=1
𝜎2𝑥,𝑗
2𝑏𝑗
s.t.
⎧⎨
⎩
∑𝑁
𝑗=1 𝑏𝑗 = 𝐵𝑄
0 ≤ 𝑏𝑗 ≤ 𝐵𝑄, 𝑗 = 1, ⋅ ⋅ ⋅ , 𝑁
𝑏𝑗 ∈ ℝ+
. (21)
Since the optimization problem in (21) is convex, we can apply
the Karush-Kuhn-Tucker (KKT) conditions to solve it [15]. To
simplify the expression in (21), we let
𝐿(B, 𝜆, 𝜈1, ⋅ ⋅ ⋅ 𝜈𝑁 , 𝛿1, ⋅ ⋅ ⋅ , 𝛿𝑁 )
= 𝑓0(B) + 𝜆𝑓1(B) +
𝑁∑
𝑗=1
𝜈𝑗ℎ𝑗(B) +
𝑁∑
𝑗=1
𝛿𝑖𝑞𝑗(B) (22)
where ⎧⎨
⎩
𝑓0(B) =
∑𝑁
𝑗=1 𝜎
2
𝑥,𝑗2
−𝑏𝑗
𝑓1(B) =
∑𝑁
𝑗=1 𝑏𝑗 −𝐵𝑄
ℎ𝑗(B) = −𝑏𝑗
𝑞𝑗(B) = 𝑏𝑗 −𝐵𝑄
Since 𝑓𝑜, 𝑓1, ℎ𝑗 , 𝑞𝑗 are differentiable, the KKT conditions for
this problem are shown below:⎧⎨
⎩
∂𝐿(B, 𝜆, 𝜈1, ⋅ ⋅ ⋅ 𝜈𝑁 , 𝛿1, ⋅ ⋅ ⋅ 𝛿𝑁 )
∂𝑏𝑗
= 0, 𝑗 = 1, ⋅ ⋅ ⋅ , 𝑁∑𝑁
𝑗=1 𝑏𝑗 = 𝐵𝑄
𝜆 ∕= 0
𝜈𝑗ℎ𝑗(B) = 0, 𝛿𝑗𝑞𝑗(B) = 0, 𝑗 = 1, ⋅ ⋅ ⋅ , 𝑁
𝜈𝑗 ≥ 0, 𝛿𝑗 ≥ 0, 𝑗 = 1, ⋅ ⋅ ⋅ , 𝑁
(23)
From ∂𝐿(B, 𝜆, 𝜈1, ⋅ ⋅ ⋅ 𝜈𝑁 , 𝛿1, ⋅ ⋅ ⋅ 𝛿𝑁 )
∂𝑏𝑗
= 0, we have
𝜈𝑗 = (−2 ln 2)2−2𝑏𝑗𝜎2𝑥,𝑗 + 𝜆+ 𝛿𝑗 . (24)
Substituting (24) into the fourth condition in (23), we have to
consider the (𝜈𝑗 = 0, 𝛿𝑗 = 0, 0 < 𝑏𝑗 < 𝐵𝑄), (𝜈𝑗 = 0, 𝛿𝑗 >
0, 𝑏𝑗 = 𝐵𝑄) and (𝜈𝑗 > 0, 𝛿𝑗 = 0, 𝑏𝑗 = 0) cases separately.518
0 10 20 30 40 50 60 70 80 90 100
3
4
5
6
7
8
9
10
Number of users
Su
m
 ra
te
 (b
ps
/H
z)
 
 
Full CSI
Type-I (BR+bi=2 or 5)
Type-III
Type-II
Type-IV
Fig. 4. Comparison of the sum rates of various feedback schemes with equal
feedback load (𝜌 = 20dB).
0 10 20 30 40 50 60 70 80 90 100
3
4
5
6
7
8
9
10
Number of users
Su
m
 R
at
e(b
ps
/H
z)
 
 
Full CSI
BR=2,BQ=5 (Optimal)
BR=2,BQ=6(Optimal)
BR=2,BQ=7(Optimal)
BR=2,BQ=5(Fast algorithm)
BR=2,BQ=6(Fast algorithm)
BR=2,BQ=7(Fast algorithm)
Fig. 5. Comparison of sum rates for different bit allocation methods (𝜌 =
20dB).
[2] H. Weingarten, Y. Steinberg, and S. Shamai, “The capacity region of
the Gaussian multiple-input multiple-output broadcast channel,” IEEE
Trans. on Inf. Theory, vol. 52, no. 9, pp. 3936 – 3964, Sep. 2006.
[3] T. Yoo and A. Goldsmith, “On the optimality of multiantenna broadcast
scheduling using zero-forcing beamforming,” IEEE J. Select. Areas
Commun, vol. 24, pp. 528–541, Mar. 2006.
[4] N. Jindal, “MIMO Broadcast Channels With Finite-Rate Feedback,”
IEEE Trans. on Inf. Theory, vol. 52, no. 11, pp. 5045–5060, Nov. 2006.
[5] N. J. T. Yoo and A. Goldsmith, “Multi-Antenna Downlink Channels with
Limited Feedback and User Selection,” IEEE J. Select. Areas Commun,
vol. 25, no. 7, pp. 1478–1491, Sep. 2007.
[6] T. Marzetta and B. Hochwald, “Capacity of a mobile multiple-antenna
communication link in Rayleigh flat fading,” IEEE Trans. on Inf. Theory,
vol. 45, pp. 139–157, Jan. 1999.
[7] M. Sharif and B.Hassibi, “On the capacity of MIMO broadcast channel
with partial side information,” IEEE Trans. on Inf. Theory, vol. 51, no. 2,
pp. 506–522, Feb. 2005.
[8] D. Gesbert and M. Alouini, “How much feedback is multi-user diversity
really worth?” IEEE Int. Conf. on Commun.(ICC), vol. 1, pp. 234–238,
Jun. 2004.
[9] D. G. V. Hassel, M.S. Alouini and G. Oien, “Exploiting multiuser
diversity using multiple feedback thresholds,” IEEE VTC, vol. 2, pp.
1302–1306, May 2005.
0 10 20 30 40 50 60 70 80 90 100
0
50
100
150
200
250
300
350
400
450
500
Number of users
To
ta
l f
ee
db
ac
k 
lo
ad
 
 
BR=5 ,BQ=1
BR=4 ,BQ=2
BR=3 ,BQ=3
BR=2 ,BQ=4
BR=1 ,BQ=5
Fig. 6. Comparison of feedback loads for different pairs of (𝐵𝑅, 𝐵𝑄) subject
to the same maximum number of per user feedback bits 𝐵𝑇 = 𝐵𝑅 + 𝐵𝑄
(𝜌 = 20dB).
0 10 20 30 40 50 60 70 80 90 100
3
4
5
6
7
8
9
10
Number of users
Su
m
 ra
te
(bp
s/H
z)
 
 
Full CSI
BR=5 ,BQ=1
BR=4 ,BQ=2
BR=3 ,BQ=3
BR=2 ,BQ=4
BR=1 ,BQ=5
Fig. 7. Comparison of sum rates for different numbers of region bits based
on the same 𝐵𝑇 (𝜌 = 20dB).
[10] R. Zakhour and D. Gesbert, “A Two-Stage Approach to Feedback
Design in Multi-User MIMO Channels with Limited Channel State
Information,” IEEE PIMRC, vol. 24, pp. 1–5, Sep. 2007.
[11] C. Anton-Haro, “Optimal Quantization Schemes for Orthogonal Random
Beamforming-A Cross-Layer Approach,” IEEE ICASSP, vol. 3, pp. 637–
640, Apr. 2007.
[12] S. Ghahramani, Fundamentals of probability with stochastic processes,
3rd ed. prentice-Hall, 2005.
[13] D. Sharma, “Design of Absolutely Optimal Quantizers for a Wide Class
of Distortion Measure,” IEEE Trans. on Inf. Theory, vol. 24, no. 6, pp.
693–702, Nov. 1978.
[14] H. Hang and J. Chen, “Source Model for Transform Video Coder and Its
ApplicationXPart I: Fundamental Theory,” IEEE Trans. on Circuits and
Systems for Video Technology, vol. 7, no. 2, pp. 287–298, Apr. 1997.
[15] S. Boyd and L. Vandenberghe, Convex Optimization. Cambridge
University Press, 2004.520
99 年度專題研究計畫研究成果彙整表 
計畫主持人：蘇炫榮 計畫編號：99-2219-E-002-019- 
計畫名稱：無線感知式協同型網狀網路之研究--子計畫三：無線感知式協同型多工存取之分散式編碼
架構(2/3) 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 4 4 100%  
博士生 3 3 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 5 2 100%  
研究報告/技術報告 0 0 100%  
研討會論文 4 3 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
 
