  
                                                               1 
壓電致動器系統描述 
本計畫針對壓電致動器系統設計反覆學習控制器，應用在重複性的工作任務上，壓電致
動器實驗平台包含壓電致動器、應變規感測器，和功率放大器、感測放大器。壓電致動器之
移動距離為 8 mµ− 到40 mµ ，輸入電壓為 −30 V 到 +150 V。壓電致動器附有應變規（strain 
guage），作為位移感測器，經電子單元之感測放大器處理位移應變後，輸出感測電壓（+0.2 V 
到 −1 V）。電子單元之功率放大器，從資料擷取卡之數位類比轉換器輸入電壓（−1 V 到 +5 
V），放大 30 倍後，輸出電壓（ −30 V 到 +150 V）以驅動壓電致動器。本計畫的控制法則
擬實現在個人電腦平台上，經由資料擷取卡之類比數位轉換器，擷取電子單元感測放大器的
感測電壓，輸入給電腦控制程式。控制程式則是以 MATLAB 語言撰寫，執行於 Windows 系
統。 
狀態補償反覆學習控制器介紹 
本計畫考慮一個能夠在時間區間[0, ]N 之內重複控制動作的的離散時域非線性系統，假設
其受控系統動態方程式為： 
 
( 1) ( ( ), ) ( ( ), ) ( ) ( )
( ) ( ( ), ) ( ) ( )
i i i i i
i i i i
x n f x n n B x n n u n w n
y n C x n n x n nξ
+ = + +
= +
 (1) 
其中 i  代表反覆學習次數，n  代表離散時間， ix  代表於第 i次學習的系統狀態， iy  代表於
第 i次學習的系統輸出， iu  代表於第 i次學習的系統輸入， ( , )f ⋅ ⋅ 、 ( , )B ⋅ ⋅ 和 ( , )C ⋅ ⋅  為時變函數，
( )iw n  和 ( )i nξ  分別為輸入干擾和輸出干擾。對於非線性系統(1) ，本計畫提出一個反覆學
習控制器 
 ( ) ( ) ( )b fi i iu n u n u n= +  (2) 
其中， ( )fiu n 為前饋控制器: 
 
1 1
( ) ( ) ( ) ( 1)
i m i mf
j j j ji
j i j i
u n G u n L n e n
− −
= − = −
= + +∑ ∑  (3) 
而 ( )biu n 為回授控制器，取決於 
 
( 1) ( ( )) ( ( )) ( )
( ) ( ( )) ( ( )) ( )
i i i i
b
i i i i
z n p z n q z n e n
u n r z n s z n e n
+ = +
= +
 (4) 
於方程式(3)中， ( 1)je n + 代表受控系統於第 j 次學習時間 1n + 的輸出誤差， jG 代表遺忘因
  
                                                               3 
然而 model-based 反覆學習控制器需建立系統的 IIR 模式，並不具有 ILC 之 model-free 的
優點。若控制法則(5)的遺忘因子 jG 和 jL 假設為 1，同時控制法則(5)的前饋學習改採用一階
學習，並且系統估測模式(6)簡化為一階之 IIR，則 model-based 反覆學習控制法則(5)可以簡化
為 
 [ ]1 1 1( ) ( ) ( 1) ( ) ( )i i i i iu n u n L e n K e n e n− − −= + + + −  (8) 
其中K 之理論值為 1 1/a b− 。控制法則(8)稱為狀態反覆學習控制（State Compensated Iterative 
Learning Control，SCILC）法則， L和 K 分別為兩個學習調整機構（時間軸和反覆軸二個學
習機構）的學習增益，此增益可以是固定增益、time-varying 增益、iteration-varying 增益或
time and iteration-varying 增益；為方便起見， 1( 1)iL e n− + 簡稱為 L term（誤差學習項），
[ ]1( ) ( )i iK e n e n−− 簡稱為 K term（狀態補償項）。狀態補償項的設計基本上是實現一種學習軸
差分的觀念，它用來補償壓電致動器系統在每次反覆學習過程，也就是充放電過程中動態特
性的可能改變。這個額外的補償力量並不會大幅增添控制器的複雜度，尤其和現存的相關文
獻比較，其控制結構實在簡單許多，且 L term 與 K term 的學習增益選擇不必倚靠任何精確
的壓電致動器數學模型，因此基本上也將是非常簡單，其值可由實驗平台相關參數決定和調
整。於 SCILC 控制法則(8)中，K term 的功能是用來補償系統於第 i次學習和第 1i − 次學習之
間的系統狀態差異，L term 的功能是根據第 1i − 次學習的輸出誤差值而校正第 i 次學習的輸入
值，SCILC 控制法則可以解讀為先行彌補系統狀態差異、再進行誤差學習。根據初步實驗結
果，在 L term 與 K term 的學習增益採用固定增益的情況下，學習控制結果尚令人滿意，與原
來只有 L term 的傳統反覆學習控制法則相比較，其追蹤誤差控制精度顯著改善。不過從實驗
的觀察與分析過程中，我們發現量測雜訊對於學習性能有一定的影響，尤其當學習誤差進入
較小範圍、貼近系統背景雜訊範圍時，雜訊的特性就很容易被突顯出來，這時我們的實驗常
會出現學習誤差先收斂後突然又增加的現象，此問題稱為 long term instability。 
 
反覆學習控制器濾波考量 
基於上述的觀察與討論，學習誤差的濾波是解決 long term instability 的有效對策。當學習
誤差的大小接近系統背景雜訊的水平時，透過適當的濾波可以防止控制器因錯誤學習外來雜
訊而造成問題。在反覆學習控制設計的領域中，典型的濾波器設計為零相位(zero phase)濾波
器，例如 FIR (finite impulse response)濾波器和小波轉換(wavelet transform，WT)濾波器等。計
畫主持人先前已將 FIR 和 WT 濾波器導入狀態反覆學習控制法則(8)設計，完成理論分析和壓
  
                                                               5 
（instantaneous frequency），以進行頻率調適濾波設計。WVD 分析有幾個基本公式和本研究
相關，陳述如下。 
一個訊號 ( )x t 的 WVD ( , )xW t F ，定義為 
 
* 2( , ) ( ) ( )
2 2
j F
xW t F x t x t e d
pi τ
τ
τ τ
τ
∞
−
=−∞
= + −∫  (11) 
其中 t代表連續時間， F 代表連續頻率，符號*代表共軛（conjugate）。 
一個訊號 ( )x t 的 SPWVD ' ( , )xW t F ，定義為 
 
' * 2( , ) ( ) ( ) ( ) ( )
2 2
j F
xW t F w v t t x t x t dt e d
pi ττ ττ τ
∞ ∞
−
∞ −∞
 
′ ′ ′ ′= − + −  ∫ ∫
 (12) 
其中 ( )w i 和 ( )v i 是濾波窗框函數如 Hamming window。 
一個訊號 ( )x t 的能量密度頻譜(energy density spectrum) 2( )X F ，可由如下公式獲得： 
 
2( ) ( , )xX F W t F dt
∞
−∞
= ∫  (13) 
一個訊號 ( )x t 的瞬間頻率(instantaneous frequency) ( )xF t ，可由如下公式獲得： 
 
( , )
( )
( , )
x
x
x
W t F FdF
F t
W t F dF
∞
−∞
∞
−∞
=
∫
∫
 (14) 
式(14)之 ( )xF t 於離散時域，可以轉化為 ( )xf n ，其中 st nT= ， sT 為取樣時間。 
因此，經由 WVD 方法分析反覆學習過程之輸出誤差，可以獲得任一學習週期所有時刻
輸出誤差之瞬間頻率。為方便計，假設此次學習週期為 i ，並令上一次學習週期為 j
（ 1j i= − ），則對於上一學習週期 j 時間n之輸出誤差 ( )je n ，經由 WVD 分析公式(14)可以獲
得該學習週期於時間n 之瞬間頻率，以下文章以符號 ( )jf n 代表輸出誤差於學習週期 j 時間n
之瞬間頻率。圖一顯示一個壓電致動器反覆學習系統於某一學習週期 j 之輸出誤差 WVD 分
析，其中(a)代表輸出誤差量測值 ( )je n ，(b)代表輸出誤差瞬間頻率 ( )jf n 估算值，(c)顯示輸出
誤差能量密度頻譜圖，(d)顯示輸出誤差 SPWVD 分析圖。 
基於 WVD 分析所獲瞬間頻率 ( )jf n ，可以設計頻率調適濾波器 ( )jh n ，於時間n 具有截
止頻率 ( )jf n 。為簡單計，濾波器 ( )jh n 設計方式可採窗框法（windowing method）。根據數位
訊號處理（DSP）窗框法設計理論，首先可以設計一個截止頻率為 ( )jf n 之理想低通濾波器，
具有脈衝響應為 
  
                                                               7 
 
1
sin 2 ( ) ( )2 2( , ) ( , ) ( ) 0.54 0.46cos , [0, 1]11 ( )
2
jlp d
jj
Nk f nkh n k h n k w k k NNN k
pipi
pi
−
−
 
= = − ∈ − 
−
− 
−
 (17) 
 ( , ) ( , ) ( ) 0, [0, 1]lp djjh n k h n k w k k N= = ∉ −  (18) 
式(17)-(18)之 ( , )lpjh n k 代表於學習週期 j 時間n之“線性相位（linear phase）有限脈衝響應（finite 
impulse response，FIR）”濾波器響應方程式。 ( , )lpjh n k 濾波器具有線性相位特性，亦即 ( , )
lp
jh n k
濾波器具有固定響應延遲時間 ( )1 2N − ，經 ( , )lpjh n k 濾波之輸出訊號會較輸入訊號延遲
( )1 2N − 的時間。對於控制系統而言，經常希望濾波器之輸出訊號與輸出訊號具有零相位
（zero phase）或零延遲（zero delay）特性，稱為零相位濾波（zero-phase filtering）。將 ( , )lpjh n k
脈衝響應左移 ( )1 2N − ，可得零相位濾波器響應 
 
1( , ) ( , )
2
lp
j j
Nh n k h n k −= +  (19) 
亦即，式(19)之 ( , )jh n k 代表於學習週期 j 時間n 之“零相位（zero phase）” FIR 濾波器脈衝響
應方程式。將式(19)代入式(17)-(18)可得 
 
sin 2 ( )2( , ) 0.54 0.46 cos ,
1
j
j
kf nkh n k
N k
pipi
pi
pi
  
= − +  
−  
 
1 1[ , ]
2 2
N Nk − −∈ −  (20) 
 ( , ) 0,jh n k =  
1 1[ , ]
2 2
N Nk − −∉ −  (21) 
其中 1j i= − ，因此，零相位頻率調適之 FIR 濾波器脈衝響應方程式，可表示為 
 
1
1
sin 2 ( )2( , ) 0.54 0.46cos ,
1
i
i
kf nkh n k
N k
pipi
pi
−
−
 
= + 
− 
 
1 1[ , ]
2 2
N Nk − −∈ −  (22) 
 1( , ) 0,ih n k− =  
1 1[ , ]
2 2
N Nk − −∉ −  (23) 
將 1( , )ih n k− 作 z-轉換，可得零相位頻率調適濾波器之轉移函數 
 1( , )iH n z−  1( , ) ki
k
h n k z
∞
−
−
=−∞
= ∑   
  
                                                               9 
圖三為 FT-SCILC 控制器追蹤該二典型目標軌跡之誤差收斂圖：(a) 追蹤10 Hz / 32 mµ 單
頻軌跡，(b) 追蹤10 Hz / 32 mµ 雙頻軌跡，從圖三(a)可看出追蹤誤差於幾次學習週期就會收
斂，並且穩態收斂誤差 RMS 值大約為追蹤振幅的 0.16%，同樣地於從圖三(b)可看出追蹤誤差
也會快速收斂，而穩態收斂誤差 RMS 值大約為追蹤振幅的 0.21%，相反地，圖三(c)為使用傳
統的 ILC 控制器追蹤10 Hz /32 mµ 單頻軌跡，追蹤誤差發散的圖形，圖三(d)為使用傳統的 ILC
控制器追蹤10 Hz / 32 mµ 雙頻軌跡，追蹤誤差發散的圖形。圖四為 FT-SCILC 控制器追蹤不同
頻率和振幅之單頻軌跡，追蹤誤差收斂的圖形。圖五為 FT-SCILC 控制器追蹤不同頻率和振
幅之雙頻軌跡，追蹤誤差收斂的圖形。綜合以上實驗，FT-SCILC 控制器能達成快速學習和準
確控制的效果。 
 
 
 
 
 
 
 
 
 
 
0 0.02 0.04 0.06 0.08 0.1
−5
0
5
10
15
20
25
30
35
Time  (second)
A
ct
ua
to
r d
is
pl
ac
em
en
t  
(m
icr
om
ete
r)
 
 
 
圖二 目標軌跡: 單頻軌跡（實線）和
雙頻軌跡（虛線）. 
0 10 20 30 40 50
0.00
0.50
1.00
1.50
2.00
2.50
Iteration index
R
M
S 
er
ro
r (
%)
(a)
0 10 20 30 40 50
0.00
0.50
1.00
1.50
2.00
2.50
Iteration index
R
M
S 
er
ro
r (
%)
(b)
0 10 20 30 40 50
0.00
0.50
1.00
1.50
2.00
2.50
Iteration index
R
M
S 
er
ro
r (
%)
(c)
0 10 20 30 40 50
0.00
0.50
1.00
1.50
2.00
2.50
Iteration index
R
M
S 
er
ro
r (
%)
(d)
 
 
圖三 追蹤誤差RMS值: (a) FT-SCILC
追蹤單頻軌跡, (b) FT-SCILC追蹤雙頻軌
跡, (c) 傳統ILC追蹤單頻軌跡, and (d) 傳
統ILC追蹤雙頻軌跡. 
