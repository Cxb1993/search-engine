 摘要 
 
    在本計畫中，我們建立了人頭電磁模擬環境，包括電磁數值模擬平台建立並將
人頭模型整合入模擬平台。因為計算電磁是非常複雜的計算，所以在第一年我們致
力發展出無條件穩定時域有限差分法，即隱式交替方向的時域有限差分法
（ADI-FDTD：Alternating-Directional Implicit) 以增加快運算時間，ADI-FDTD 
數值方法也是這幾年來非常熱門的計算電磁的數值方法。而在第二年中，我們將藉
由後設材料的電磁特性，應用於行動通訊產品以減低對於人體特定吸收效率。且我
們將利用FDTD 數值方法來模擬後設材料的電磁現象，以瞭解其物理與電磁特性。藉
由適當設計後設材質置於行動通訊設備，藉此觀察減低人體特定吸收效率的成效。
隨著個人行動通訊產品普遍使用，造成人體暴露於電磁環境中。大眾逐漸關心電磁
波對於人體的影響。在常用通訊產品中，由於手機使用時最接近人體，也因此最受
重視。一般手機電磁規範，主要是量測特定吸收效率值(SAR)，藉而得知人體組織所
吸收電磁輻射強度。  
不僅如此我們也利用我們所提出的改良 ADI-FDTD 數值方法且加上完美匹配層
PML(Perfect Matched Layer)吸收邊界的 conductivity profile（電磁導率的分
佈），使得 ADI-FDTD 數值方法加上 PML 吸收邊界時能更加穩定和收斂，再加以應
用於模擬電感這種耗時的模擬問題上。最後，我們又加以分析 ADI-FDTD數值方法加
上不同的吸收邊界，分別為 Mur 和 PML吸收邊界來模擬微帶線低通濾波器的效能差
異較。 
電磁數值分析方法-ADI-FDTD 可以大幅的減少電腦的運算負擔由於 ADI-FDTD 之
時間步階 (time-step)不再受限於 Courant-Friedrich-Levy 穩定條件
(Courant-Friedrich-Levy stability condition)。 
ADI-FDTD 可以應用在超大型積體電路(VLSI)及印刷式傳輸線之信號傳輸及完整
性（signal integrity）之精確的電磁特性分析。當此方法配合 split-field
完美吸收層 (Perfect matched layer)作為吸收邊界 (Absorbing boundary 
condition)以模擬一開放區域時，完美吸收層會導致 ADI-FDTD不穩定；有基於
此，我們提出一修正型完美吸收層-藉由修正此完美吸收層之導電係數
(conductivity)，以改善不穩定之現象。 
並由此方法來分析數個例子-超大型積體電路間之連接、射頻電感和 via在印刷
式電路板的效應，看出所提出之 ADI-FDTD的效率及精確度。 
 
關鍵詞：無條件穩定時域有限差分法、特定吸收效率值、隱式交替方向的時域有限
差分法、split-field完美吸收層、後設材質、完美匹配層、Mur吸收邊界、電磁
導率的分佈、微帶線 
conductivity profile, microstrip line 
  時域有限差分法目前已廣泛應用於了解人頭特定吸收效率，其方法可以提供準
確可靠的結果。不過由於時域有限差分法以時域下的馬克斯威爾方程式推導而
出，數值結果必須等到時域波形收斂，所以往往須較久的運算時間，本計畫即提
出 ADI-FDTD演算法，並將其應用於人頭特定吸收效率的計算，以加快運算時間。
ADI-FDTD是 Implicit形式的 FDTD，其演算法為無條件穩定，故可以選擇任意時
間步階以改善計算時間，與一般的套裝軟體相比，此演算法可以提供更快速計算
電磁場的方法。 
 在研究手機天線對於特定吸收效率的影響，研究包括利用放置高阻抗面材質
(High Impedance surface)於天線與人頭間，以降低人頭中特定吸收效率。高阻
抗面材質利用週期性排列六邊型金屬產生一截止頻帶，進而減低金屬接地面表面
電流，以達到降低特定吸收效率的效果。雖然放置高阻抗面材質於天線時，會影
響天線原本全方向性(omin-directional)的天線場型，不過由於手機基地台的廣
泛設立，高阻抗面材質對於手機的收訊影響並不大，放置高阻抗材質並可增加相
對方向的增益。在本計畫中，即利用此想法，將放置高阻抗面材質改為另一新興
的電磁物質-後設材質，並加以探討後設材質對於降低人頭中特定吸收效率的成
效。 
最近，後設材質(Metamaterials)的電磁特性引起廣大興趣。後設材質為人
造物質，其電磁特性不同於一般自然界常見的物質。藉由適當週期性排列細金屬
片分離式環形共振器，可使物質的介電係數(u)與導磁係數(e)為負值。當物質的
介電係數或導磁係數為負值時，將會產生一截止頻帶，當物質的介電係數和導磁
係數同時負值時，可以藉此製造完美透鏡。 
後設物質主要為具有特殊電磁特性的人造物質，並非自然材質。最近，符合
左手定則的後設物質(Left –handed metamaterials)引起廣泛研究。目前相關
於後設物質的研究，主要有加州大學聖地牙哥分校(UCSD)，首先提出實驗驗證左
手定則的後設物質，而麻省理工學院(MIT)也隨後做出實驗加以驗證。加州大學
洛杉磯分校(UCLA)則提出利用傳輸線理論方法(Transmission line theory)加以
  在本計畫中，藉由時域有限差分法(Finite-Difference Time-Domain)，我
們將建立 SAR模擬的環境。在模擬中，我們使用偶極天線以及人頭模型作為 SAR
值計算。人頭模型主要依據核磁共振圖形(Magnetic Resonance Image MRI)建立
而成。所計算而得結果將和既有文獻作比較，以驗證所計算的吸收效率的準確性。 
 
1. 時域有限差分法與特定吸收效率計算 
 
1.1模擬天線與激發源 
在此模擬中，我們使用二分之一波長的偶極天線，並且利用細線演算法實現 
圓柱型偶極天線，細線演算法主要是模擬半徑小於網格的細金屬線。由於天線為
金屬所構成，在模擬中我們以完美導體(perfect conductor)來表示。在模擬激
發源方面，我們在兩金屬導體中當做激發網格，激發處電場表示式為 
( )
z
VkjiE
n
n
z D
=,,         (1.1) 
其中 Vn為激發電壓源，Dz為 z方向網格大小。 
 
1.2 人頭模型 
人頭模型主要是由核磁共振圖形(Magnetic Resonance Image MRI)建立而
成， MRI 圖形是由 The Whole Brain Altas 網站取得，解析度為
3.0 ´ 3.0 ´ 3.0mm。人頭模型主要由六種組織所構成，包括骨頭(bone)、腦
(brain)、肌肉(muscle)、眼球(eye)、脂肪(fat)與皮膚(skin)。圖 1.1 和圖
1.2分別為 MRI圖形和 FDTD計算所使用人頭模型，圖 1.1為水平切面的人頭模
型。人頭中六種組織在頻率 900MHz和 1800MHz的導電係數(s  conductivity)，介
電係數(er  dielectric constant)與組織密度(r mass density)如表 1.1所示，為從
文獻所獲得的相關數值。 
 
 
 1.4 特定吸收效率模擬結果 
 
圖 1.3為本研究天線與人頭模擬圖，其中天線擺放位置平行於人頭，天線人
頭距離為為 3cm。在計算 SAR值，天線輸出功率為 600mW。SAR值計算結果也和
[5, 6]做比較，如表 1.2所示。雖然在不同文獻中，所使用的人頭和天線模型是
不同的，如圖 1.3b所示，我們所計算的穩態 SAR值為 2.43W/kg，和文獻相比較，
可以發現結果相當接近。 
 
cm3
 
圖 1.3a天線與人頭模擬圖。 
 
0 500 1000 1500 2000 2500 3000 3500 4000 4500 5000
Time step
0
0.5
1
1.5
2
2.5
3
3.5
4
SA
R
(W
/k
g)
 
圖 1.3b 模擬 SAR值。 
 
表 1.2 SAR值比較。 
Frequency Tissue [5] [6] This 
work 
900MHz Whole 
head 
2.17 2.28 2.43 
045
90
135
180
225
270
315
-5
-5
-10
-10
-15
-15
-20
-20
-25
-25-30
x
y
 
圖 1.5天線場型圖 v 
 
在第一部份研究中，我們成功利用時域有限差分法建立特定吸收效率(SAR)
平台，並與既有文獻結果作比較，結果相當吻合，由於時域有限差分法在計算
SAR較費時，故我們將在下一步發展 ADI-FDTD，以增快模擬運算時間。 
 
2. 發展 ADI-FDTD電磁數值方法 
 
2.1 簡介 
 
時域有限差分法(Finite-Difference Time-Domain) 已廣泛用於電磁數值
模擬。不過由於 FDTD為顯式(explicit)中央差分演算法，其時間步階須符合穩
定法則。當應用 FDTD模擬細微結構時，由於時間步階受限於網格大小，故將增
加運算的時間。 
最近，無條件穩定的 FDTD被提出，無條件穩定的 FDTD主要將任意方向隱式
演算法(alternating-direction implicit)應用於 FDTD中。在 ADI-FDTD中，時
間步階將不受穩定法則限制，時間步階選取主要依據模擬數值準確度。 
在模擬開放空間時，我們需在邊界處應用吸收邊界。常用的吸收邊界包括
Mur 吸收邊界和完美匹配層(Perfectly matched layer)。當應用吸收邊界於
ADI-FDTD時，會造成數值穩定度問題。在本研究中，我們將分析 ADI-FDTD結合
Mur 吸收邊界和完美匹配層(Perfectly matched layer)的穩定度。由理論分析
和數值模擬發現，ADI-FDTD結合吸收邊界會造成數值不穩定，我們亦提出方法，
以改善數值穩定度的問題。 
 
2.2 二維 TM波 ADI-FDTD數值方法 
 
一般而言，二維 TM波 ADI-FDTD可以寫成下面形式 
nn XX L=+1                (2.5) 
在這表示式中，空間中的電磁場量都經傅利業轉換(Fourier Transform)到
空間頻域(spatial domain)，藉由檢查L特徵值(eigenvalue)，就可以知道這系
統是否穩定。假如特徵值的強度小於或等於一，即表示系統是穩定的。若特徵值
其中一元素大於一，即表示系統是不穩的。分析方法如下： 
假設沿著空間 x, y, z方向的頻率為 kx, ky, kz，因此場量可寫為 
)(
,
yjkxikjn
z
n
jiz
yxeEE D+D-=            (2.6a) 
))
2
1((
2
1,
yjkxikjn
x
n
ji
x
yx
eHH
D++D-
+
=           (2.6b) 
))
2
1((
,
2
1
yjkxikjn
y
n
ji
y
yx
eHH
D+D+-
+
=            (2.6c) 
將這表示式分別帶入(2.1)中，即可得 
n
x
yn
y
xn
zx
n
z H
yk
y
tjHxk
x
tjEE ×÷÷
ø
ö
çç
è
æ D
×
D
D
+×÷
ø
ö
ç
è
æ D×
D
D
-=
++
2
sin
2
sin 2
1
2
1
ee
     (2.7a) 
n
z
yn
x
n
x E
yk
y
tjHH ×÷÷
ø
ö
çç
è
æ D
×
D
D
+=
+
2
sin2
1
m
          (2.7b) 
2
1
2
1
2
sin
++
×÷
ø
ö
ç
è
æ D×
D
D
-=
n
z
xn
y
n
y E
xk
x
tjHH
m         
(2.7c) 
同理將這表示式分別帶入(2.2)中，即可得 
12
1
1
2
sin
2
sin +
++ ×÷÷
ø
ö
çç
è
æ D
×
D
D
+×÷
ø
ö
ç
è
æ D×
D
D
-= nx
yn
y
xn
zx
n
z H
yk
y
tjHxk
x
tjEE
ee   (2.8a) 
12
1
1
2
sin +
++ ×÷÷
ø
ö
çç
è
æ D
×
D
D
+= nz
yn
x
n
x E
yk
y
tjHH
m
         (2.8b) 
2
1
2
1
1
2
sin
+++ ×÷
ø
ö
ç
è
æ D×
D
D
-=
n
z
x
n
y
n
y E
xk
x
tjHH
m
         (2.8c) 
我們定義在空間中頻域下場量為 
ú
ú
ú
û
ù
ê
ê
ê
ë
é
=C
n
y
n
x
n
z
n
H
H
E
              (2.9) 
因此第一步關係式可寫為 
nn PM C=C
+
1
2
1
1              (2.10) 
me
memew
2222
2
2
tan yxyx
WWWWt ++
=÷
ø
ö
ç
è
æ D
         (2.17) 
其中 ÷÷
ø
ö
çç
è
æ D
D
D
=÷
ø
ö
ç
è
æ D
D
D
=
2
sin  
2
sin
yk
y
tW
xk
x
tW yy
x
x  
 
2.4數值模擬結果 
 
我們模擬一個簡單二維結構以展現上述 ADI-FDTD方法。我們假設模擬結構
介質為真空且使用均勻網格。在數值模擬中，ADI-FDTD模擬結果將和 FDTD模擬
結果作比較。模擬空間大小為 42 ´ 42 且邊界處為完美金屬導體(perfect 
conductor)。網格大小為Dx = Dy = 1mm，根據穩定法則，最大時間步階
Dtmax=2.35ps。在 ADI-FDTD中，時間步階分別取為Dtmax 、2Dtmax和 4Dtmax，饋入
波源為 Hx，位置於計算空間中央處。 
   模擬結果如圖 2.1 所示，模擬結果顯示 FDTD 和 ADI-FDTD 模擬結果相當符
合。表 2.1顯示模擬時間的比例，由於 ADI-FDTD較傳統的 FDTD複雜，當 ADI-FDTD
的時間步階為 4Dtmax時，跟傳統的 FDTD比較，電腦運算時間是差不多的。 
 
0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5
-0.4
-0.2
0
0.2
0.4
0.6
0.8
1
FDTD
ADI-FDTD(dt)
ADI-FDTD(2dt)
ADI-FDTD(4dt)
 
圖 2.1 FDTD和 ADI-FDTD模擬比較圖。 
 
            表 2.1 FDTD和 ADI-FDTD運算時間比較。 
 FDTD ADI-FDTD 
(Dt) 
ADI-FDTD 
(2Dt) 
ADI-FDTD 
(4Dt) 
CPU time 
ratio 
1 3 1.666 1 
 
 3.2  ADI-FDTD結合 Mur吸收邊界的穩定度分析  
 
我們將探討 ADI-FDTD 結合 Mur 吸收邊界條件的穩定度。主要以二維 TM 波
ADI-FDTD在邊界網格處 y = jmax-1為例。根據, 場量 Hx, Hy和 Ez在第一步表示式為 
( )n jizn jizn jixn jix EEy
tHH 1max, max, 2/1max, 
2/1
2/1max, 2 --
+
- -D
D
-=
m        
(3.1a) 
( )2/1 1max, 2/1 1max,1 1max,2/1 2/1 1max,2/1 2
+
-
+
-+-+
+
-+ -D
D
+= n jiz
n
jiz
n
jiy
n
jiy EEx
tHH
m
                          (3.1b) 
( ) ( )n jixn jixn jiyn jiyn jizn jiz HHy
tHH
x
tEE 2/3max, 2/1max, 
2/1
1max,2/1 
2/1
1max,2/1 1max, 
2/1
1max, 22 --
+
--
+
-+-
+
- -D
D
--
D
D
+=
ee
     (3.1c) 
而在第二步表示式為 
( )1 1max, 1 max, 2/1 2/1max, 1 2/1max, 2
+
-
++
-
+
- -D
D
-= n jiz
n
jiz
n
jix
n
jix EEy
tHH
m
         (3.2a) 
( )2/1 1max, 2/1 1max,1 2/1 1max,2/1 1 1max,2/1 2
+
-
+
-+
+
-+
+
-+ -D
D
+= n jiz
n
jiz
n
jiy
n
jiy EEx
tHH
m
                          (3.2b) 
( ) ( )1 2/3max, 1 2/1max, 2/1 1max,2/1 2/1 1max,2/1 2/1 1max, 1 1max, 22
+
-
+
-
+
--
+
-+
+
-
+
- -D
D
--
D
D
+= n jix
n
jix
n
jiy
n
jiy
n
jiz
n
jiz HHy
tHH
x
tEE
ee
    (3.2c) 
Mur吸收邊界是應用在 y = jmax邊界處，Mur演算法主要依據,在執行第一步
時，Mur波動方程式主要為 
4/1
, max
4/1
, 2/1max2/1max
++
-- ¶
¶
=
¶
¶ n
jiz
n
jiz Ey
vE
t
           (3.3) 
從(3.3)，Ez電場量在邊界處 y = jmax可以寫為 
( )n jizn jizn jizn jiz EEytv
ytvEE max,  
2/1
1max,  
max
max
1max,  
2/1
max,  2
2
-÷÷
ø
ö
çç
è
æ
D+D
D-D
+= + --
+         (3.4) 
另一方面，Mur波動方程式在第二步可以寫為 
1
, max
4/3
, 2/1max2/1max
++
-- ¶
¶
=
¶
¶ n
jiz
n
jiz Ey
vE
t
           (3.5) 
從(3.5)可知，Mur吸收邊界結合 ADI-FDTD可以化成三角對角矩陣，在 y =jmax
電場量 Ez可以寫為 
( )2/1 max,  2/1 1max,  max1 1max,  max1 max,   11 ++ -+ -+ +=÷÷
ø
ö
çç
è
æ
D
D
-+÷÷
ø
ö
çç
è
æ
D
D
+ n jiz
n
jiz
n
jiz
n
jiz EEy
tvE
y
tvE      (3.6) 
由於在邊界處使用了 Mur吸收邊界，我們將(3.6)的電場量 Ez表示式分別帶入
(3.1a)和(3.2a)中，場量 Hx變成 
( ) ÷÷
ø
ö
ç
ç
è
æ
÷÷
ø
ö
çç
è
æ
D+D
D
++÷÷
ø
ö
çç
è
æ
D+D
D
-
D
D
-= - -
-
--
+
- tvy
yEE
tvy
yE
y
tHH n jiz
n
jiz
n
jiz
n
jix
n
jix
max
2/1
1max, 
2/1
max, 
max
1max, 2/1max, 
2/1
2/1max, 
2
2m
 
    (3.7a) 
( ) ÷÷
ø
ö
ç
ç
è
æ
÷÷
ø
ö
çç
è
æ
D+D
D
++÷÷
ø
ö
çç
è
æ
D+D
D
-
D
D
-= + -
++
-
+
-
+
- tvy
yEE
tvy
yE
y
tHH n jiz
n
jiz
n
jiz
n
jix
n
jix
max
2/1
1max, 
2/1
max, 
max
1
1max, 
2/1
2/1max, 
1
2/1max, 
2
2m
  
(3.7b) 
ú
ú
ú
ú
ú
ú
ú
ú
ú
ú
ú
û
ù
ê
ê
ê
ê
ê
ê
ê
ê
ê
ê
ê
ë
é
÷÷
ø
ö
çç
è
æ
D+D
D
÷÷
ø
ö
çç
è
æ D
D
D
-
+÷÷
ø
ö
çç
è
æ
D+D
D
D
D
÷÷
ø
ö
çç
è
æ D
D
D
-
=
D-
100
01
2
cos
2
2
0
2
sin1
max2
max
1 x
m
m
e
tvy
yyk
y
t
e
tvy
y
y
t
yk
y
tj
P
y
yjk
y
y
 
  第一步階的放大因子為L1的特徵值，而x為矩陣L1的一個元素。同樣的方法
可以應用於第二步階的公式，其關係式也可以寫成矩陣形式 
2
1
2
2
1
2
1
2
1 ++-+ CL=C=C
nnn PM              (3.13) 
其中 
ú
ú
ú
ú
ú
ú
ú
ú
û
ù
ê
ê
ê
ê
ê
ê
ê
ê
ë
é
÷÷
ø
ö
çç
è
æ
D+D
D
D
D-
÷÷
ø
ö
çç
è
æ D
D
D
=
D-
100
012
2
0
2
sin1
2
max
2
yjk
y
y
e
tvy
y
y
t
yk
y
tj
M
m
e
 
ú
ú
ú
ú
ú
ú
ú
û
ù
ê
ê
ê
ê
ê
ê
ê
ë
é
÷
ø
ö
ç
è
æ D
D
D
÷÷
ø
ö
çç
è
æ
D+D
D
÷÷
ø
ö
çç
è
æ D
D
D
-
÷
ø
ö
ç
è
æ D
D
D
=
10
2
sin
01
2
cos
2
sin01
max
2
xk
x
tj
tvy
yyk
y
t
xk
x
tj
P
x
y
x
m
m
e
 
 
其中放大因子x即可藉由計算L2的特徵值得知。藉由合併兩時間步階，可得 
nnn XXX L=LL=+ 21
1
            (3.14) 
 
在本研究中，我們先求L2的特徵值以得x，得到x便可以得知L。藉由計算L
的特徵值，當 1£Ll ，此演算法便可以穩定。由於L矩陣複雜，故無法得到L特徵
值的解析解。特徵值便藉由 Matlab數值計算而得。由於L矩陣的元素含有波數
 (wavenumber) ，因此需考慮波所有行進方向。如圖 3.1所示，我們假設波數
kx= ksinf, ky = kcosf而 22 yx kkk += ，其中f為入射波的角度。 
 3.3數值模擬 
 
在本研究中，為了觀察該演算法的不穩定問題，我們利用三維 ADI-FDTD結
合 Mur吸收邊界作穩定度分析。在數值模擬中，網格大小為Dx = Dy = Dz = 1.0 
mm，而最大時間步階為Dtmax= 121092.1 -´ s。計算空間為 42 ´ 42 ´ 42。Mur吸收邊界分
別應用於六邊界上。激發源為高斯波，激發位置為(21, 21, 21)而觀察位置為(21, 
20, 21)。 
  不同時間步階比值(CFLN)對數值模擬結果如下。首先，我們取 CFLN=1，從
理論分析得知在這狀況下演算法有不穩定問題。如圖 3.3所示，數值模擬結果並
沒有不穩定問題。我們將模擬時間步階增加到 100000不過數值模擬仍為穩定。
這是由於當 CFLN=1時，最大特徵值只要比一稍微大一點，這表示需很長的時間
步階才會使數值不穩定。 
0 1000 2000 3000 4000 5000
Time step
-0.5
-0.3
-0.1
0.1
0.3
0.5
Ez
CFLN=1
 
圖 3.3   三維 ADI-FDTD結合 Mur吸收邊界的數值模擬結果(CFLN=1)。 
 
當使用 ADI-FDTD時，CFLN必須夠大此演算法才有效率優勢。圖 3.4和圖 3.5
分別為此演算法在 CFLN =3和 CFLN = 5的結果。由圖可知，此演算法分別在 1300
步階和 600步階將會變的不穩定。由模擬結果可知，當 ADI-FDTD結合 Mur吸收
邊界且使用大的 CFLN時，此數值方法會變的不穩定。 
( )
( )
( ) 2,2
1
,11,
2
1
,12,1,
2
1
,
,2/12,,2/11,
,
2,
2
1
,11,
2
1
,12,1,
2
1
, 1
bxbx
n
jizybxbx
n
jizybxbxbxbx
n
jizy
n
jiyax
n
jiyaxbx
n
jizxax
bxbx
n
jizxbxbx
n
jizxbxbxbxbx
n
jizx
DCEDCEDCDCE
HDHDC
EC
DCEDCEDCDCE
+
-
+
+
+
-+
+
-
+
+
+
+++-
×-××+
×=
--++
     
(4.1b) 
)(
,,1,1,1,
2
1,
1,
2
1
2
1,
n
jizy
n
jizx
n
jizy
n
jizxby
n
ji
xay
n
ji
x EEEEDHDH --+×-×= +++
+
+
     
(4.1c) 
)( 2
1
,
2
1
,
2
1
,1
2
1
,11,,
2
11,
2
1
,
2
1
+++
+
+
+
+
+
+
--+×+×=
n
jizy
n
jizx
n
jizy
n
jizxbx
n
ji
yax
n
ji
y EEEEDHDH      (4.1d) 
其中 
e
s
e
s
4
1
4
1
t
t
C
s
s
as D
+
D
-
=
e
s
e
4
1
2
t
s
t
C
s
bs D
+
D
D
=
m
s
m
s
4
1
4
1
*
,
*
,
,
t
t
D
ns
ns
nas
D
+
D
-
=
m
s
m
4
1
2
*
,
,
t
s
t
D
ns
nbs
D
+
D
D
= s= x, y; n= 1, 2 
s*x,1= s*x i+1/2,j, s*x,2 = s*x i-1/2,j, s*y,1 = s*y i,j+1/2, s*y,2 = s*y i,j-1/2 
 
由於PML中的電導與磁導會用多項式分佈以獲得最佳吸收效果，故電導與磁
導和位置有關。在此研究中，所推導的場量表示式為實際疊代公式以呈現電導與
磁導的效應。 
 
同樣的，在第二時間步階場量表示式為 
)( 2
1
,
2
1
2
1
,
2
1
2/1
,
1
,
+
-
+
+
++ -×+×=
n
ji
y
n
ji
ybx
n
jizxax
n
jizx HHCECE
        
(4.2a) 
( )
( )
( ) 2,11,1,11,2,1,1,
2/1
2/1,2,
2/1
2/1,1,
2/1
,
2,
1
1,1,
1
1,2,1,
1
,
1
byby
n
jizybyby
n
jizxbybybyby
n
jizx
n
jixay
n
jixayby
n
jizyay
byby
n
jizybyby
n
jizybybybyby
n
jizy
DCEDCEDCDCE
HDHDC
EC
DCEDCEDCDCE
+
-
+
+
+
+
-
+
+
+
+
-
+
+
+
+++-
×-××-
×=
--++
      
(4.2b) 
)( 1
,
1
,
1
1,
1
1,1,
2/1
2
1,
1,
1
2
1,
+++
+
+
+
+
+
+
+
--+×-×= n
jizy
n
jizx
n
jizy
n
jizxby
n
ji
xay
n
ji
x EEEEDHDH   (4.2c) 
)( 2
1
,
2
1
,
2
1
,1
2
1
,11,
2/1
,
2
11,
1
,
2
1
+++
+
+
+
+
+
+
+
--+×+×=
n
jizy
n
jizx
n
jizy
n
jizxbx
n
ji
yax
n
ji
y EEEEDHDH
     
(4.2d)   
 
把兩步驟結合可得 
nnn XXPMPMX L== --+ 1
1
12
1
2
1             (4.6) 
藉由檢查L的特徵值(eigenvalue)，就可以知道這系統是否穩定，穩定條件需要
1£Ll 。 
我們考慮一二維42´ 42的計算空間。 網格大小為Dx = Dy = 1.0 mm而FDTD最
大時間步階Dtmax=2.35 ps。10層PML分別用在邊界處，PML中參數設定請參考文
獻。其中電導磁導參數為 
s
m
opts D
+
»=
p
ss
150
)1(
max  
m
m
s
s
d
ss
s 0max)(
-
=
s
s  s= x, y, z          (4.7) 
其中d為PML的厚度，Ds為網格大小而s0表示邊界位置。在此研究中，為了得到最
佳吸收效率，我們設定m = 4和smax = 10.61S/m。 
  為了驗證所提出的穩定矩陣，我們分別計算s = s* = 0和PML均勻電磁導
s = smax兩種狀況。時間步階設定為5Dtmax，如表4.1所示，在這兩種狀況下，所
有特徵值偕小於等於一 
 
表 4.1 真空和均勻 PML電磁導。 
 Free space 
s = 0 
PML medium 
s = smax 
 
|lL| 
1.0000000e+000 
1.0000000e+000 
1.0000000e+000 
1.0000000e+000 
8.7121313e-001 
8.7121313e-001 
4.8417857e-001 
4.8417857e-001 
 
然後，我們在PML中引用傳統的電導分佈PML(4.7)，由於電導分佈隨不同位置
有所不同，故所計算的特徵值也會隨不同位置而異。所計算4個不同電導參數的
位置如圖4.1所示，位置1在真空中，位置2在於真空與PML交接處，所對應的磁導
值為s*y i,j+1/2 = 0 和s*y i,j-1/2 = 30.1592，位置3位於第1層PML，所對應的磁導值為s*y 
i,j+1/2 = 30.1592 和s*y i,j-1/2 =934.9371，位置4在第8層PML，所對應的磁導值為s*y 
i,j+1/2 = 481372.0127 和s*y i,j-1/2 = 792615.6173。4個位置的x方向電導sx = sx*= 0。 
藉由研究，我們發現PML電磁導分佈會影響ADI-FDTD結合分離寺完美匹配層
(split-field PML)的穩定度，如表4.2所示，在位置4所有的特徵值皆小於1，我
們發現要有兩個條件可改善此演算法的穩定度。第一個條件為PML中連續的電磁
導比值必須小，第二條件為PML中的電磁導值須夠大。由於PML中電導值由邊界處
漸增，我們發現穩定條件為電磁導比值在PML交接處需小於1.3，而在靠近外邊金
屬導體處需小於1.5。 
  我們將探討PML電磁導分佈對於此演算法的穩定度影響，因此提出兩個改善
的PML電磁導分佈，在第一個電磁導分佈中，我們設定smax = 10.61S/m，而電磁
導分佈為 
layer) 3 layer to l (From   3.1 rdst*
1,
*
2,
*
1,
*
2, ==
y
y
x
x
s
s
s
s
 
layer) 5 layer to 4 (From    4.1 thth*
1,
*
2,
*
1,
*
2, ==
y
y
x
x
s
s
s
s
 
layer) 10 layer to 6 (From    5.1 thth*
1,
*
2,
*
1,
*
2, ==
y
y
x
x
s
s
s
s
         (4.8) 
  由於(4.8)中電磁導比值不是常數，因此當使用(4.8)PML的電磁導分佈，PML
的吸收效率會受影響。因此在第二個PML的電磁導分佈中，我們使用固定電磁導
比值，在第二個電磁導分佈，我們利用多項式電磁導分佈，其中smax= 21.22S/m
和m=2 
2
2
0max)(
d
ss
s ss
-
=
s
s  s= x, y, z         (4.9) 
在(4.9)中，相對應的反射係數為 24108.6 -´ ，此反射係數比傳統的值小，圖
4.2為3個不同電磁導分佈的示意圖 
 
0 1 2 3 4 5 6 7 8 9 10
PML layer
0
5
10
15
20
25
El
ec
tr
ic
 C
on
du
ct
iv
ity
conventional conductivity profile (Eq.4.7)
1st modified conductivity profile  (Eq.4.8)
2nd modified conductivity profile (Eq.4.9)
 
圖4.2 PML電磁導分佈。 
我們考慮同樣的二維模擬結構，其中時間步階為5Dtmax.，所得的不同位置，
不同電磁導分佈的特徵值如表4.3所示，首先，我們使用均勻的電導s = 10.61。
波中，所記錄的磁場分別為Hx和Hz，所計算而得的相對反射係數分別呈現於圖
4.3a和圖4.3b。在PML公式中，在Hy的公式，我們使用sy*而在 Hzx和Hzy公式中，
使用sx*和sy*。因此，TE和TM波所計算而得反射係數將會些許不同。當使用第一
個改善的PML電磁導分佈，跟最佳的PML電磁導分佈相比，我們發現PML效率會減
低22dB左右，當使用第二個改善的PML電磁導分佈，以TM波為例，我們發現PML
效率會減低12dB左右。考慮PML吸收效率時，使用第二個改善的PML電磁導分佈會
比使用第一個改善的PML電磁導分佈好。雖然可以藉著增加PML厚度來改善吸收效
率，其對應的電導會變小，如此將會使此演算法更不穩定。使用第一個改善的PML
電磁導分佈時，較差的PML吸收效率會使反射波在邊界處放大，進而影響數值穩
定度。 
 
0 400 800 1200 1600
Time (ps)
-150
-120
-90
-60
-30
0
R
ef
le
ct
io
n 
fr
om
 P
M
L(
dB
)
TM CFLN=5
conventional conductivity profile
1st modified conductivity profile
2nd modified conductivity profile
 
圖 4.3a TM波反射係數。 
0 400 800 1200 1600
Time (ps)
-150
-120
-90
-60
-30
0
R
ef
le
ct
io
n 
fr
om
 P
M
L(
dB
)
TE CFLN=5
conventional conductivity profile
1st modified conductivity profile
2nd modified conductivity profile
 
圖 4.3b TE波反射係數。 
 
0 3000 6000 9000 12000 15000
Time step
-0.005
-0.0025
0
0.0025
0.005
Hx
 
圖 4.5 使用改良 PML電導的 Hx場值。 
 
4.4 ADI-FDTD模擬特殊吸收效率 
 
我們將改良型的 PML電導用於 ADI-FDTD方法，用於 SAR值得模擬。由表 2.1
可知，當時間步階為 4Dt時，計算速度才會比 FDTD快。不過由於模擬 SAR時，
網格大小Dx=Dy=Dz=3mm，約為 1/10波長。根據 2-4節所討論結果，當時間步階
放大時，數值色散會很嚴重，所模擬的結果和 FDTD會有相當相異，如表 4.4所
示。不過當模擬細微結構時(如第二年計畫中的後置材質 metamaterials)，
ADI-FDTD就會有計算效率上的優勢 
 
表 4.4 ADI-FDTD模擬 SAR值。 
 FDTD ADI-FDTD(2Dt) ADI-FDTD(3Dt) ADI-FDTD(4Dt) 
SAR (W/kg) 2.43 2.22 1.37 0.96 
 
4.5 ADI-FDTD 於 VLSI 與印刷電路板 的電磁模擬 
 
由於超大型積體電路(VLSI)之時脈(Clock-rate)的增加，電磁效應亦顯重要
因為超大型積體電路之特性將受電磁效應的影響而明顯的不同，所以在一超大型
積體電路之設計之中，電磁效應-耦合(coupling)、失真(distortion)、傳輸延
遲(propagation delay)，之分析亦日漸重要。然而，電路間之連接效應，例如：
在一高速數位電路內，via 在多層印刷式電路板(Multi-layered PCB)內會導至
訊號失真，因此，建立電磁數值模型及分析方法以分析如此複雜的電路及信號傳
輸之完整性並提供高效率及高精確度是相當重要之課題。 
時域有限差分法(FDTD)被廣泛運用以分析印刷式電路板上之電磁效應。此方
欲了解超大型積體電路及印刷式電路板的訊號完整性，在此以 ADI-FDTD 結合
split-field 完美吸收層並配合所提出之導電系數資料進行數值計算以分析此
電路之電磁行為及時間步階在 ADI-FDTD及 FDTD之間的差別。並以此方法來分析
超大型積體電路間之連接、射頻電感和 via在印刷式電路板的效應，看出所提出
之 ADI-FDTD之效率及精確度。 
 
4.6對於 ADI-FDTD法的 unsplit 形成 PML 
在此研究 unsplit-field PML是基於文獻以改進，其中 unsplit 形成 PML
方程式為 
( ) eoeot EEHE
rrrr
ss
e
s
ee
~~1~1~1 ---Â=¶                            (4.11a) 
( ) ooeet HHEH
rrrr
ss
e
s
em
~~1~1~1 -+-Â-=¶                              (4.11b) 
eeeet EHE
rrr
s
ee
~1~1 -Â=¶                                        
 (4.11c) oooot HEH
rrr
s
em
~1~1 -Â-=¶                                     
 (4.11d) 
上式中的 u¶ 代表對於 u方向的部分微分，e與m 代表介電係數與導磁係數，E
r
與 H
r
代表電場與磁場， eE
r
與 oH
r
代表兩個輔助場。 
÷÷
÷
÷
ø
ö
çç
ç
ç
è
æ
¶¶-
¶-¶
¶¶-
=Â
0
0
0
~
xy
xz
yz
 , e o % % %  
   
00
00
00
~
÷
÷
÷
ø
ö
ç
ç
ç
è
æ
¶
¶
¶
=Â
x
z
y
e
÷÷
÷
÷
ø
ö
çç
ç
ç
è
æ
¶-
¶-
¶-
=Â
00
00
00
~
y
x
z
o  
   
00
00
00
~
÷
÷
÷
ø
ö
ç
ç
ç
è
æ
=
x
z
y
e
s
s
s
s
÷÷
÷
÷
ø
ö
çç
ç
ç
è
æ
=
y
x
z
o
s
s
s
s
00
00
00
~
                      (4.12) 
(4.11)式可以寫成簡潔的形式如下， 
( ) ( )tt Tt yy
rr
Â=¶
~
               (4.13) 
在此 ( )tyr 式混合直角坐標係之相量， 
( )Tozoyoxezeyexzyxzyx HHHEEEHHHEEE=yr       (4.14) 
÷
÷
÷
÷
÷
ø
ö
ç
ç
ç
ç
ç
è
æ
÷÷
÷
÷
÷
÷
÷
÷
ø
ö
çç
ç
ç
ç
ç
ç
ç
è
æ
+
÷
÷
÷
÷
÷
÷
÷
ø
ö
ç
ç
ç
ç
ç
ç
ç
è
æ
Â
D
-
Â
D
Â
D
-
=
n
o
n
e
n
n
e
e
H
E
H
E
T
I
I
It
ttI
r
r
r
r
~
~0
~
0
~
0
~
0
~~0
~
0
~
0~0~~~
2
0~0~~
2
~
4
~ 22
m
eme
          (4.20) 
相同的作法，對於第二更新步階(4.19)之場量可以表示成如下， 
÷
÷
÷
÷
÷
ø
ö
ç
ç
ç
ç
ç
è
æ
÷÷
÷
÷
÷
÷
÷
÷
÷
÷
ø
ö
çç
ç
ç
ç
ç
ç
ç
ç
ç
è
æ
+
÷÷
÷
÷
÷
÷
÷
÷
÷
÷
ø
ö
çç
ç
ç
ç
ç
ç
ç
ç
ç
è
æ
Â
D
-
Â
D
Â
D
-
Â
D
Â
D
-
=
÷
÷
÷
÷
÷
ø
ö
ç
ç
ç
ç
ç
è
æ
÷÷
÷
÷
÷
÷
÷
÷
ø
ö
çç
ç
ç
ç
ç
ç
ç
è
æ
+
÷
÷
÷
÷
÷
÷
÷
ø
ö
ç
ç
ç
ç
ç
ç
ç
è
æ
Â
D
ÂÂ
D
+
+
+
+
+
*
*
*
*
2
2
1
1
1
1
2
~
~0
~
0
~~
2
0
~~~
2
0
~
0
~
0
~~~
2
0
~
0
~~
2
~
4
~
~
~0
~
0
~
0
~
0
~~0
~
0
~
0
~
0
~~~
2
0
~
0
~
0
~~~
4
~
n
o
n
e
n
n
o
e
o
o
n
o
n
e
n
n
e
oe
H
E
H
E
V
It
It
It
ttI
H
E
H
E
U
I
I
It
tI
r
r
r
r
r
r
r
r
m
e
m
eme
m
me
                          (4.21) 
 
從文獻中可找到對於 12´ 12 矩陣 S~ , T~ , U~ , 與V~的表示式。這些矩陣取決
於時間步數增加Dt，PML 導電率s。在系統方程式(4.20)與(4.21)，假設 PML 導
電率為均勻分布。由於 PML導電率的比例是為了較小的反射能量，實際上利用擷
取有效的 PML 導電率，推導出電場更新程式。從方程式(4.18)結合(4.16)與
(4.17)，對於第一更新步階 Ex、Hz與 Eex場量可表示如下: 
( )
( ) n kjexizn kjexiyn kjyin kjyi
n
kjzi
n
kjzi
n
kjxiz
n
kjxi
EtEtHH
z
t
HH
y
tEtE
,,2/1
*
,,2/12/1,,2/12/1,,2/1
*
,2/1,2/1
*
,2/1,2/1,,2/1
*
,,2/1
222
22
1
++-+++
-+++++
D
+
D
--
D
D
-
-
D
D
+÷
ø
ö
ç
è
æ D-=
s
e
s
ee
e
s
e    (4.22) 
( )
( )
( )
n
kjozi
y
yxyx
n
kjyi
n
kjyi
n
kjxi
n
kjxi
y
n
kjzix
n
kjzi
Ht
tt
EE
x
t
EEt
y
t
HtH
,2/1,2/1
2
2
,2/1,,2/1,1
*
,,2/1
*
,1,2/1,2/1,2/1
*
,2/1,2/1
2
1
42
2
 
2
1
2
2
1
+++++
+++++++
÷
÷
÷
÷
ø
ö
ç
ç
ç
ç
è
æ
D
+
D
+-
D
+-
D
D
-
-
D
+
D
D
+÷
ø
ö
ç
è
æ D-=
s
e
ss
e
ss
e
m
s
e
ms
e
  (4.23) 
( )* ,2/1,2/1* ,2/1,2/1,,2/1* ,,2/1
2
1
2
2
1
1 n
kjzi
n
kjzi
y
n
kjexi
y
n
kjexi HHt
y
t
EtE -+++++ -D
+
D
D
+
D
+
=
s
e
e
s
e
    (4.24) 
( )
( ) 1 2/1,,* 2/1,,1 2/1,2/1,1 2/1,2/1,
*
2/1,,2/1
*
2/1,,2/1
*
2/1,,
1
2/1,,
2
1
2
2
1
2
2
1
2
2
1
2
2
1
1
+
++
+
+-
+
++
+-+++
+
+
D
+
D
+
D
+
D
--
D
+
D
D
-
-
D
+
D
D
+
÷
ø
ö
ç
è
æ D+
=
n
kjezi
y
y
n
kjezi
y
x
n
kjxi
n
kjxi
y
n
kjyi
n
kjyi
y
n
kjzi
y
n
kjzi
E
t
t
E
t
t
HH
t
y
t
HHt
x
t
E
t
E
s
e
s
e
s
e
s
e
s
e
e
s
e
e
s
e
   
(4.26) 
( )
( )
( )
*
2/1,2/1,
2
2
1
2/1,,
1
2/1,1,
*
,2/1,
*
1,2/1,
*
2/1,2/1,
1
2/1,2/1,
2
1
42
2
1
2
2
2
1
1
n
kjoxi
y
zyzy
n
kjzi
n
kjzi
y
n
kjyi
n
kjyi
n
kjxi
y
n
kjxi
H
t
tt
EE
t
y
t
EE
z
tH
t
H
++
+
+
+
++
+++++
+
++
÷÷
÷
÷
÷
ø
ö
çç
ç
ç
ç
è
æ
D
+
D
--
D
+-
D
+
D
D
-
-
D
D
+
D
+
=
s
e
ss
e
ss
e
s
e
m
ms
e
 (4.27) 
( )* 2/1,,2/1* 2/1,,2/1* 2/1,,1 2/1,, 221
n
kjyi
n
kjyi
n
kjezix
n
kjezi HHx
tEtE +-+++
+
+ -D
D
+÷
ø
ö
ç
è
æ D-=
e
s
e
   (4.28) 
 
 
把(4.27)與(4.28)式帶入(4.26)式，對於場量 1+nzE 之真實更新程式可以表示成: 
nn PM C=C 1
*
1               (4.31) 
*
2
1
2
nn PM C=C +                                            (4.32) 
分別對應於n* and n+1時間步階。注意當對於PML導電層多項式增加，從真
實更新程式如(4.25)與(4.29)式擷取有效的PML導電磁資訊可獲得整體矩陣M 與
P。 
一對半時間步階可以結合成一個時間步階， 
nnn XXPMPMX L== --+ 1
1
12
1
2
1           (4.33) 
在此的L為12´ 12維度之方陣。穩定性的依據需要在單位圓上或圓內其L的特徵
值，例如: 1£Ll ，嘗試去找出L的特徵值。然而由於擴大矩陣L的複雜度，對於
特徵值有難度去取得簡單分析表示式。此特徵值是利用數值方法由MatlabÒ由所
計算出來的，擴大矩陣 為離散波數的函數。由於穩定度是與波傳播的角度不相
關，因此對於所有的角度都需考慮。我們找出最大的特徵值發生於
12sin =÷ø
öç
è
æ Dsks ，s = x, y, z.。研究一個包含42´ 42´ 42 個空間步階之三維區域，
並在x、y與z方向有10層的PML。使用空間步階的Dx = Dy = Dz = 1.0 mm，與FDTD
時間步階Dtmax=1.92 ps，Dt/Dtmax定義為CFL數(CFLN)。 
 
A. 均勻 PML導電層 
 
第一，對於帶著 PML導電率sx = s y=s z=10.66S/m之均勻的 PML導電層，計
算其L的特徵值。時間步階尺寸可以個自選擇Dtmax、2Dtmax與 5Dtmax。在文獻中
可以比較 unsplit 形式 PML的理論穩定分析，其結果顯示在表 4.5中。由於對
於兩種 unsplit-field 與 split-field PML形式的最大特徵值遠小於單位矩
陣，因此當 CFLN=1時，這兩種形式都具有穩定性。在文獻中可知，當使用均勻
的 PML導電層，對於 ADI-FDTD法的 split-field PML具有穩定性。在使用較大
的時間步階(CFLN)，且 split-field PML的特徵值遠仍然小於單位矩陣，從表
4.5可知 unsplit 形式 PML的特徵值遠大於單位矩陣。當使用較大的時間步階
(CFLN)，這表顯示用均勻的 PML導電層之 unsplit-field PML將會出現不穩定特
性。 
 
表 4.5  PML介質之特徵值s = 10.66S/m。 
 CFLN=1 CFLN=2 CFLN=5 
Unsplit-field 
PML 
1.0000000e+000 
8.7747147e-001 
8.7747147e-001 
8.7747147e-001 
1.0000000e+000 
1.0000000e+000 
1.1404158e+000 
1.1404158e+000 
1.0000000e+000 
1.0000000e+000 
1.8425689e+000 
1.8425689e+000 
不穩定的特性。此外由於在 PML區域中，unsplit-field PML之特徵值遠大於
split-field PML，因此 unsplit形式的 PML比 split-field還更不穩定。 
 
表 4.6 一個刻度化 PML導電層之特徵值 (CFLN=2) 
 第 1 PML層 第 2 PML層 第 7 PML層 第 8 PML層 
Unsplit  
PML 
1.0000000e+000 
1.0000000e+000 
1.0000000e+000 
1.0000000e+000 
9.9999458e-001 
9.9999458e-001 
9.9999458e-001 
9.9999458e-001 
1.0001102e+000 
1.0116309e+000 
9.8861176e-001 
1.0000000e+000 
1.0000000e+000 
1.0000000e+000 
9.9997381e-001 
9.9997369e-001 
9.9997381e-001 
9.9997369e-001 
1.0391331e+000 
9.6318931e-001 
1.0010885e+000 
9.9965145e-001 
9.9944584e-001 
1.0000000e+000 
1.0000000e+000 
1.0000000e+000 
1.0263849e+000 
1.0278798e+000 
1.0263849e+000 
1.0278798e+000 
1.0950059e+000 
7.4157019e-001 
7.5975297e-001 
7.4157019e-001 
7.5975297e-001 
1.0000000e+000 
1.0000000e+000 
1.0000000e+000 
1.0503975e+000 
1.0530700e+000 
1.0503975e+000 
1.0530700e+000 
1.0502266e+000 
6.1057624e-001 
6.0672960e-001 
6.1057624e-001 
6.0672960e-001 
1.0000000e+000 
split 
PML 
9.9999497e-001 
9.9999922e-001 
9.9999497e-001 
9.9999922e-001 
1.0041994e+000 
9.9582829e-001 
1.0000000e+000 
1.0000146e+000 
1.0000000e+000 
9.9999997e-001 
1.0000000e+000 
1.0000000e+000 
9.9984845e-001 
9.9986432e-001 
9.9984845e-001 
9.9986432e-001 
1.0231412e+000 
9.7729609e-001 
9.9943971e-001 
1.0004888e+000 
9.9999997e-001 
1.0000000e+000 
1.0000000e+000 
1.0000000e+000 
9.3294548e-001 
9.1282644e-001 
9.3294548e-001 
9.1282644e-001 
6.2869631e-001 
9.2032400e-001 
7.5120690e-001 
7.5120690e-001 
9.9999998e-001 
9.9999997e-001 
1.0000000e+000 
1.0000000e+000 
8.8979186e-001 
8.5278382e-001 
8.8979186e-001 
8.5278382e-001 
5.8182452e-001 
5.6774843e-001 
5.8182452e-001 
5.6774843e-001 
1.0000000e+000 
1.0000000e+000 
9.9999998e-001 
1.0000000e+000 
 
C. 修改 PML導電層 
 
PML導電層將影響 unsplit形式 PML之穩定性。利用修正 PML導電層去改善
PML區域的穩定性。為了改善此流程的穩定性，我們找到連續的磁導率且在 PML
區域中的導電域應要非常小。在圖 4.6中，比較與研究這兩種修正導電層。對於
第一層的 PML導電層修正，選擇導電率smax = 0.2 S/m 且 m = 1.5， 
 
1.0000000e+000 
9.9976693e-001 
9.9976979e-001 
9.9976693e-001 
9.9976979e-001 
1.0805555e+000 
1.0047093e+000 
9.2980200e-001 
1.0000000e+000 
 1.0105824e+000 
 1.0104100e+000 
 1.0105824e+000 
 1.0623003e+000 
  8.7402322e-001 
  8.9906505e-001 
  8.7402322e-001 
  8.9906505e-001 
 1.0000000e+000 
1.0311377e+000 
1.0306567e+000 
1.0311377e+000 
1.0216302e+000 
7.3258587e-001 
7.3631743e-001 
7.3258587e-001 
 7.3631743e-001 
1.0000000e+000 
第二修正型
PML層 
 
1.0000000e+000 
1.0000000e+000 
1.0000000e+000 
1.0000000e+000 
9.9988331e-001 
9.9988404e-001 
9.9988331e-001 
9.9988404e-001 
1.0023656e+000 
1.0559803e+000 
9.4922602e-001 
1.0000000e+000 
 1.0000000e+000 
 1.0000000e+000 
 1.0051621e+000 
 1.0052103e+000 
 1.0051621e+000 
 1.0052103e+000 
 1.0604829e+000 
  9.4866470e-001 
  9.2172679e-001 
  9.4866470e-001 
  9.2172679e-001 
 1.0000000e+000 
1.0000000e+000 
1.0000000e+000 
1.0151767e+000 
1.0153401e+000 
1.0151767e+000 
1.0153401e+000 
1.0288398e+000 
 8.4684167e-001 
 8.5748415e-001 
 8.4684167e-001 
 8.5748415e-001 
1.0000000e+000 
 
 討論在 3 維空間中一樣的問題。在表 4.7 中顯示針對不同 PML 層，修正其
unsplit流程之特徵值計算。Unsplit形式 PML之不穩定性是不可避免的，但可
將其改善。當使用修正 PML導電層，且與傳統 PML導電層比較，由於最大的特徵
值將變成較小的，在 PML區域中的穩定性是可以被證明出來的。從理論可知，對
於 ADI-FDTD法之 unsplit形式 PML是不穩定的且能夠利用修正 PML之導電層來
改善。之後會利用數值模擬來驗證。 
 
I. 數值模擬 
在之前所探討主題，理論穩定性分析中，理論穩定性分析是基於Von Neumann
法。Von Neumann法是假設波傳播在沒有邊界的區域。當計算unsplit形式PML之
特徵值遠大於單位矩陣，這代表在均勻的區域中，利用這些PML係數其電磁場將
會出現不穩定現象，也就是ADI-FDTD流程使用這些PML係數會有不穩定性。為了
避免使用unsplit-field PML 之ADI-FDTD的不穩定性，一個解決方式為，計算包
含自由空間與PML層的整個計算區域之擴大矩陣。然而整個擴大矩陣區域非常複
雜且不適用其他的問題。利用數值模擬來完成較簡單分析計算區域之擴大矩陣穩
定性。在此呈現出利用unsplit-field PML之ADI-FDTD方法的模擬測試。利用
與 4.9b分別顯示出第一修正 PML導電層與第二修正導電層之 Hx場時間步階模
擬。對於利用第一修正型 PML導電層之 unsplit形式 PML流程，在 1000個時間
步階後，會呈現不穩定狀態。對於利用第二修正型 PML導電層之 unsplit形式
PML流程，呈現出不穩定狀態的時間步階拉長了，在 1500個時間步階才出現不
穩定狀態。兩個修正型 PML導電層改善對於 ADI-FDTD法之 unsplit形式 PML的
穩定性。利用第二修正型 PML導電層，其 unsplit-field流程之穩定性優於利用
第一修正型導電層。 
 
0 250 500 750 1000 1250 1500
Time steps
-0.2
-0.15
-0.1
-0.05
0
0.05
0.1
0.15
0.2
H x
 F
ie
ld
1st modified PML profile 
 
圖 4.9a利用第一修正型導電層之 Hx分量(CFLN=2)。 
0 400 800 1200 1600 2000
Time steps
-0.2
-0.15
-0.1
-0.05
0
0.05
0.1
0.15
0.2
H x
 F
ie
ld
2nd modified PML profile 
 
圖 4.9b 利用第二修正型導電層之 Hx分量(CFLN=2)。 
 
 在此流程中，討論利用修正形導電層之 PML性能。不同高斯脈波作為 Hx場。
在(21, 21, 21)空間中產生激發源，其觀測位置在離激發源 10單元之後。相對
PML之反射誤差計算如下: 
÷
÷
ø
ö
ç
ç
è
æ -
=
||max
log20 10 t
ref
t
ref
t
H
HH
R                              (4.37) 
 
 
圖 4.11 Mur吸收邊界條件的反射誤差。 
 
圖 4.12 PML吸收邊界條件的反射誤差。 
 
為了要驗證我們的數值模擬的正確性，我們把它們應用在計算微帶線低通濾
波器的計算上，其結構如圖 4.13所示，經過我們的模擬後發現，ADI-FDTD方法
利用 Mur 吸收邊界條件它的反射誤差並不會比 PML 吸收邊界條件差太多，且
ADI-FDTD 方法利用 Mur 吸收邊界條件它所花的 CPU 時間也比較少，所以我們的
結論是在利用 ADI-FDTD方法模擬微帶線結構時加上 Mur吸收邊界條件會比較實
際和可行的。 
 
圖 4.13 微帶線低通濾波器的幾何結構。 
( )
( )
( ) 2,2
1
,11,
2
1
,12,1,
2
1
,
,2/12,,2/11,
,
2,
2
1
,11,
2
1
,12,1,
2
1
, 1
bxbx
n
jizybxbx
n
jizybxbxbxbx
n
jizy
n
jiyax
n
jiyaxbx
n
jizxax
bxbx
n
jizxbxbx
n
jizxbxbxbxbx
n
jizx
DCEDCEDCDCE
HDHDC
EC
DCEDCEDCDCE
+
-
+
+
+
-+
+
-
+
+
+
+++-
×-××+
×=
--++
    
(4.38b) 
)( ,,1,1,1,
2
1,
1,
2
1
2
1,
n
jizy
n
jizx
n
jizy
n
jizxby
n
ji
xay
n
ji
x EEEEDHDH --+×-×= +++
+
+
      
(4.38c) 
)( 2
1
,
2
1
,
2
1
,1
2
1
,11,,
2
11,
2
1
,
2
1
+++
+
+
+
+
+
+
--+×+×=
n
jizy
n
jizx
n
jizy
n
jizxbx
n
ji
yax
n
ji
y EEEEDHDH
   
    (4.38d) 
e
s
e
s
4
1
4
1
t
t
C
s
s
as D
+
D
-
=
e
s
e
4
1
2
t
s
t
C
s
bs D
+
D
D
=
m
s
m
s
4
1
4
1
*
,
*
,
,
t
t
D
ns
ns
nas
D
+
D
-
=
m
s
m
4
1
2
*
,
,
t
s
t
D
ns
nbs
D
+
D
D
= s= x, y; n= 1, 2 
s*x,1= s*x i+1/2,j, s*x,2 = s*x i-1/2,j, s*y,1 = s*y i,j+1/2,  s*y,2= s*y i,j-1/2 
 
由上式 (4.38b)發現其等號左邊其矩陣為一對角矩陣 (tri-diagonal 
matrix)，而此矩陣亦非常容易解出；由於完美吸收層內之導電係數s(electric 
conductivity)與導磁係數s*(magnetic conductivity)是為了將入射波進行衰
減並產生很小的反射，所以完美吸收層內之導電係數與導磁係數將與位置有所關
聯。 
第二步驟，將上述之電磁場表示如下： 
)( 2
1
,
2
1
2
1
,
2
1
2/1
,
1
,
+
-
+
+
++ -×+×=
n
ji
y
n
ji
ybx
n
jizxax
n
jizx HHCECE
         
(4.39a) 
( )
( )
( ) 2,11,1,11,2,1,1,
2/1
2/1,2,
2/1
2/1,1,
2/1
,
2,
1
1,1,
1
1,2,1,
1
,
1
byby
n
jizybyby
n
jizxbybybyby
n
jizx
n
jixay
n
jixayby
n
jizyay
byby
n
jizybyby
n
jizybybybyby
n
jizy
DCEDCEDCDCE
HDHDC
EC
DCEDCEDCDCE
+
-
+
+
+
+
-
+
+
+
+
-
+
+
+
+++-
×-××-
×=
--++
      
(4.39b) 
)( 1
,
1
,
1
1,
1
1,1,
2/1
2
1,
1,
1
2
1,
+++
+
+
+
+
+
+
+
--+×-×= n
jizy
n
jizx
n
jizy
n
jizxby
n
ji
xay
n
ji
x EEEEDHDH
      
(4.39c) 
)( 2
1
,
2
1
,
2
1
,1
2
1
,11,
2/1
,
2
11,
1
,
2
1
+++
+
+
+
+
+
+
+
--+×+×=
n
jizy
n
jizx
n
jizy
n
jizxbx
n
ji
yax
n
ji
y EEEEDHDH
      
(4.39d) 
0 1 2 3 4 5 6 7 8 9 10
PML layer
0
5
10
15
20
25
Electric C
onductivity
conventional conductivity profile
modified conductivity profile 
 
圖 4.15   完美吸收層內之導電係數之資料。 
 
完美吸收層之特性會受到導電係數之資料的影響，而我們所提出之方法
在完美吸收層內提供了相當好的穩定性；而傳統的完美吸收層特性要比修正
型來的好，因此，對於穩定度及完美吸收層之特性必須有所取捨；為避免修
正型完美吸收層方法帶來的不穩定，當設計比例係數 m與最大的導電係數smax
時最大的時間步階、總時間步階與所需要的完美吸收層特性皆需要考慮。 
 
圖 4.16為分析一電路時 ADI-FDTD時間步階之設計流程圖 
 
l 定義 ADI-FDTD單元大小之係數Dx、Dy 與Dz，根據 CFL條件計算最大的
時間步階Dtmax，並定義時間步階之大小Dt以及 CFLN = Dt/Dtmax。 
l 使用修正型完美吸收層的導電係數資料，定義比例係數 m與最大的導電
係數smax以改進此方法的穩定度。 
l 計算公式(1)和(2)內之係數 Ca、Cb、Da 與 Db，並訂亦須模擬之結構之
ADI-FDTD單元。 
l 以相鄰的場量計算電、磁場在第(n + 1/2)個時間步階，使用完美吸收層作
為計算空間以模擬一無限大空間。 
l 以相鄰的場量計算電、磁場在第(n + 1)個時間步階，使用完美吸收層作為
計算空間以模擬一無限大空間。 
 Ａ.VLSI中的多層交錯連接 
 
多層交錯已經被分析。結構是參考文獻「9」並且呈現於圖三中。在雙層交
錯的結構中在每層有兩個導體。這個導體是寬 1μm厚 1μm的銅。五層二氧化矽
的厚度均是 1μm，介電係數是 3.9並且被上下兩個接地金屬所包覆。線的長度
與間隔分別為 30.8μm及 1μm.。 
 
x
z
Ground Conductor
Level 1
Level 2
 
1um
30.8um
Level 2
1 2
3 4
1um
30.8umLevel 1
6
5 7
8
 
圖 4.17 多層交錯結構。 
 
在 ADI-FDTD的模擬中，計算的區域是用大小為 x =  y =  z= 0.2  m. 
的單元來切割。在 CFL條件下最大的時間步大小為 0.38 fs. 十層的 PML吸收邊
接條件用來縮小計算的區域。總共的計算區域為 174 x 174 x 45。在 ADI-FDTD
的模擬中時間步的大小在 CFLN=10 及 CFLN=20的時候分別為 3.8fs 與 4.6fs 。 
 
圖 4.18為模擬的結果。傳統的 ADI-FDTD結合 split-field PML已被探討。
如 4.18a所示，可以發現在跑了 4800個時間步後，數值結果變得不穩定。藉由
引入修改過的 PML參數 m = 1.5 及 max = 21.22S/m ，在這個結構中，不穩定的
情況可以被改善。如圖 4.18b所示我們已經延伸時間步到 10000次並且沒有不穩
定的狀況產生。 
 
時間步的大小，總共的時間步數目及處理器的時間比值呈現於表格 4.10。
由於時間步的大小是設定為 10，幾乎是 FDTD方法的 20倍大，所以總共的時間
步數可以減少。因為在更新階段額外加入了電磁元件，ADI-FDTD對記憶體的需
求大約是傳統 FDTD的 1.9倍。當 CFLN = 10 及 CFLN = 20 時，CPU的時間約可
減少 56.1%及 26.9%。 
 
表 4.10 多層交錯結構的模擬。 
  Dt Steps CPU Time Ratio 
FDTD 0.38fs 10000 1.000 
ADI-FDTD (10Dtmax) 3.8fs 1000 0.561 
ADI-FDTD (20Dtmax) 7.6fs 500 0.269 
 
 
B. 射頻電感 
 
五圈的環形電感也被 ADI-FDTD探討。電感一部份的剖面圖呈現於圖 4.20。
外徑是 250μm，最上面微帶線的導體寬度是 8μm，導體間的距離是 2.8μm，內
部空間中偶合線的間距是 150μm。 
 
250 um
150 um
Port 1 Port 2     
1h
2h
3h
4h
5h
Si
2SiO
 
圖 4.20  h3-h5 = 1.3 um, h2 = 3.6 um, h1= 200 um, h4= 2.07 um, and h5= 
0.84 um.電感的佈線及剖面圖。 
 
在單埠饋入中，第二埠是接地的。電感Ｑ值的定義為 
 
                          
(4.40) 
 
其中 Zinput是等效的串聯輸入阻抗。 
 
在 ADI-FDTD的模擬中，單元的大小Dx =Dy = 1.35 mm。在 z方向上，我們
Q =
2pfL
Re Zinput[ ]
10cm
8cm
4cm20mils
80mils
Power
planes
Via
structures
20mils
Port1
Port2
 
圖 4.22 受測的印刷電路板的結構。 
 
在 ADI-FDTD模擬中，我們用不均勻的單元大小來分割灌孔與微帶線的結
構。空間分個的細節呈現於圖 4.23中。40 mils 寬的微帶線在 y方向被分割成
四個單元，偶合的區域以大小為Dx1 = Dy1 = Dz = 20 mils 及 Dx = Dy = 10 mils的
單元來作分割。滿足 CFL穩定條件，最大的時間步大小是Dtmax = 0.5 ps 。在這個
研究中 ADI-FDTD的時間步是 5ps以及 CFLN為 10。 
 
dxdx1 dx1
dy1
dy1
dy
port1 via
port2
 
圖 4.23 受測的印刷電路板的空間分割。 
 
 
圖 4.24 在四層 PCB板，經由槽孔傳輸的電壓。 
 
由埠一(port1)所激發的的激發脈衝(excitation pulse)為一梯形函數，其
上升時間與下降時間(rise time and fall time)為tr = tf = 1 ns，平坦時間(on time)
為ton =1 ns，其結果如圖 4.19所示；而完美吸收層之導電係數資料將會受單元大
小的影響，當我們使用非均勻的單元時，相鄰完美吸收層內之導磁係數的比例將
condition)之限制；然而，若 ADI-FDTD使用 Berenger’s完美吸收層作為吸收
邊界時，會導致 late-time不穩定(late-time instability)；有鑑於此，提出
一修正型之完美吸收層-完美吸收層配合導電系數資料所構成，以改善此方法。
以一多層交錯式超大型積體電路、射頻電感及 via在印刷式電路板內之效應作為
例子，將所提出之方法與傳統 FDTD做比較，明顯地，計算時間大幅的縮減；雖
然修正型之完美吸收層之導電系數資料會影響到完美吸收層之特性，但大致上其
分析之結果與參考基準之比較相當吻合。此提出之方法提供一高效率並精確的電
磁數值模擬分析，以分析超大型積體電路間之連接及印刷式電路板的效應。 
 
 
近幾年發表論文如下: 
1. J.-N. Hwang and F.-C. Chen, "A Modified PML Conductivity Profile for the 
ADI-FDTD" , IET Microwave, Antennas & Propagation, vol. 1, no. 5, pp. 
1071-1077, Oct.  2007.  (EI, SCI). 
2. J.-N. Hwang and F.-C. Chen, "Stability Analysis of the Murs Absorbing Boundary 
Condition in the Alternating  Direction Implicit Finite-Difference Method", IET 
Microwave, Antennas & Propagation, vol. 1, no. 3, pp. 597-601, June 2007. (EI, 
SCI) 
3. Jiunn-Nan Hwang and Fu-Chiarng Chen, “Reduction of the peak SAR in the 
human head with metamaterials”, IEEE Trans. on Antenna and Propagation, 
vol.54, pp. 3763-3770. Dec. 2006.  
4. T.-Y. Tzou and F.-C. Chen, "New 0.18-μm CMOS Pulse Generator for Impulse 
Radio Ultra-Wideband Communication Systems", Microwave and Optical 
Technology Letters, Vol. 49, No. 2, pp. 342-345, Feb. 2007  (EI, SCI) 
5. D.-Y. Lai and F.-C. Chen, "A Compact Dual-Band Dual-Polarized Patch Antenna 
for 1800/5800 MHz Cellular/WLAN Systems", Microwave and Optical 
Technology Letters, Vol. 49, No. 2, pp. 345-349, Feb. 2007  (EI, SCI) 
6. Y.-F. Wu, C.-H. Wu, D.-Y. Lai, and F.-C. Chen, "A Reconfigurable 
Quadri-Polarization Diversity Aperture-Coupled Patch Antenna", IEEE Trans. on 
Antennas and Propagation, Vol. 55, No. 3, pp. 1009-1012, Mar. 2007  (EI, SCI) 
7. S.-Y. Wang, D.-Y. Lai and F.-C. Chen, " A Low-Profile Switchable 
Quadripolarization Diversity Aperture-Coupled Patch Antenna", IEEE Antennas 
and Wireless Propagation Lett., Vol.8, 2009. 
8. P.-C. Hsieh, and F.-C. Chen, " A New Spatial Correlation Formulation of 
Arbitrary AoA Scenarios", IEEE Antennas and Wireless Propagation Lett., Vol.8, 
2009. 
9. T.-H. Liao, P.-C. Hsieh, and F.-C. Chen, " Subwavelength Target Detection Using 
Ultrawideband Time-Reversal Techniques With a Multilayered Dielectric Slab", 
IEEE Antennas and Wireless Propagation Lett., Vol.8, 2009. 
12. Jiunn-Nan Hwang and Fu-Chiarng Chen, "Numerical Performances of Absorbing 
Boundary Conditions for ADI-FDTD Method" , IEEE Antenna and Propagation 
Symposium/URSI meeting, Albuquerque New Mexico, USA., July 2006.  
13. Chun-Hsien Wu and Fu-Chiarng Chen, "A Compact Reconfigurable 
Quadri-Polarization Diversity Patch Antenna" , IEEE Antenna and Propagation 
Symposium/URSI meeting, Albuquerque New Mexico, USA., July 2006. 
14. Yuan Tzou and Fu-Chiarng Chen, "A PPM Higher Order Derivative Gaussian 
Pulse Transmitter for Ultra-Wideband Communication" , IEEE Antenna and 
Propagation Symposium/URSI meeting, Albuquerque New Mexico, USA., July 
2006. 
15. Don-Yen Lai Fu-Chiarng Chen, "A Dual-Band Dual-Polarization Diversity Patch 
Antenna" , IEEE Antenna and Propagation Symposium/URSI meeting, 
Albuquerque New Mexico, USA., July 2006. 
16. T. H. Liao, P. C. Hsieh and F. C. Chen, "Target Detection Using Ultrawide-band 
Time Reversal Techniques with Multilayer Dielectric Slabs" , IEEE Antenna and 
Propagation Symposium/URSI meeting, Albuquerque New Mexico, USA., July 
2006. 
17. Wun-Bi Lin, Ying-Te Liu and Fu-Chiarng Chen, "A New 
Ultra-Wideband Monocycle Pulse Generator using Second-Order 
Transcient Circuit”, in proc. 30th European Microwave Conf., pp. 
1585- 1588, Oct. 2008.  
18. J.-T. Chuang and F.-C. Chen, “Comparison of MIMO spatial 
correlation approximations under large angular spread”, IEEE 
Antennas Propag. Symp. San Diego,California, July. 2008. 
19. Po-Chuan Hsieh and Fu-Chiarng Chen, "The Relation of TARC-based 
Radiation Efficiency and Port Termination for Multiple Antenna 
Systems," IEEE Antennas Propag. Symp. San Diego,California, July. 
2008. 
20. Jui-Ting Chuang and Fu-Chiarng Chen,  "Comparison Study on 
Several Spatial Correlation Formulations under Arbitrary AoA 
Scenarios," IEEE Asia Pacific Wireless Commun. Symp. Sendai,Japan, 
Aug. 2008. 
 
 
 
 
 
 
[12] Y. Yang, R. S. Chen, W. C. Tang, K. Sha, and E. K. N. Yung, “Analysis of 
planar circuits using an unconditionally stable 3D ADI-FDTD method,” 
Microwave Opt. Technol. Lett., vol.46, no.2, pp.175-179, July, 2005. 
[13] T. Namiki and K. Ito, “Numerical simulation of microstrip resonators and filters 
using ADI-FDTD method,” IEEE Trans. Microwave Theory Tech., vol. 49, no. 4, 
pp. 665-670, Apr. 2001. 
[14] J. P. Berenger, “A perfectly matched layer for the absorbing of electromagnetic 
waves,” J. Comp. Phys., vol. 114, pp. 185-200, Oct, 1994. 
[15]  G. Liu and S. D Gedney, “Perfectly matched layer media for an unconditionally 
stable three-dimensional ADI-FDTD method,” IEEE Microwave Guided Wave 
Lett., vol. 10, no. 7, pp. 261-263, July 2000.  
[16]  C. C.-P. Chen, T.-W. Lee, N. Murugensan, and S. C. Hagness, “Generalized 
FDTD-ADI: an unconditionally stable full-wave Maxwell’s equations solver for 
VLSI interconnect modeling,” in Proc. Int. Conf. Computer-Aided Design, San 
Jose, CA, Nov. 2000, pp. 156-163. 
[17]  M. H. Kermani and O. M. Ramahi, “Instable 3D ADI-FDTD open-region 
simulation”, in IEEE Antennas Propagat. Symp. Dig., Washington DC, July, 2005, 
pp. 142-145. 
[18]  R. G. Rubio, S. G. Garcia, A. R. Bretones, and R. G. Martin, “An unsplit 
Berenger-Like PML for the ADI-FDTD method”, Microwave Opt. Technol. Lett., 
vol.42, no.6, pp. 466-469, Sep, 2004. 
[19] J.-N. Hwang and F.-C. Chen, “A rigorous stability analysis of instability in 
ADI-FDTD method with PML absorber,” in IEEE AP-S Int. Symp. Dig., July 
2006, pp. 1739-1742. 
[20] G. D. Smith, Numerical Solution of Partial Difference Equations, Oxford, U.K.: 
Oxford Univ. Press, 1978. 
[21] A. Talflove, Computational Electrodynamics: The finite-Difference 
Time-Domain Method. Norwood, MA: Artech House, 1995. 
[22] M. Okoniewski and M. A. Stuchly, “A study of the handset antenna and human 
body interaction,＂ IEEE Trans. Microwave Theory Tech.,vol. 44, no. 10, pp. 
1855-1863, Oct. 1996. 
[23] A.Hirata, S. Matsuyama, and T. Shiozawa,“Temperature rise in the human eye 
exposed to EM waves in the frequency range 0.6-6GHz,＂  IEEE Trans. 
Electromagn. Compta., vol. 42, no. 4, pp. 386-392, Nov. 2000. 
[24] M. Danesh and J. R. Long, “Differentially driven symmetric microstrip 
inductors,”IEEE trans. Microwave Theory Tech., vol. 50, pp332-341, Jan. 2002 
                         
 
出席國際會議報告 
 
 
報告人姓名 陳富強 報告日期 2009/8/18 2009/8/21 
系所 國立交通大學電信工程研究所 
聯絡電話 03-5712121-54562 電子信箱 fchen@mail.nctu.edu.tw
會議期間 2009/8/18~2009/8/21 會議地點 莫斯科/俄羅斯 
會議名稱 (中文)電磁研究發展研討會 (英文）Progress in Electromagnetic Research Symposium 
發表論文題目 A New Eigenvalue Based Radiation Efficiency Analysis for Multiple Antenna Systems 
 
報告內容包括下列各項： 
 
一、參加會議經過 
 
二、與會心得 
 
三、建議 
 
四、攜回資料名稱與內容 
 
五、其他 
 
 
 
 
一 、參加會議經過 
