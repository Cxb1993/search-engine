concern to engineers. This study then utilizes the 
developed mathematical descriptions to both estimate 
the effects of manufacturing defects and alignment 
errors on the change of OPL and exit ray, 
respectively, and establish the permissible tolerance 
limits on each of the independent variables within 
the system based on the worst case method. Compared 
with existing methods, the major advantage of the 
proposed tolerance design method is that it is based 
on an optical geometry gradient matrix and therefore 
provides means of obtaining the allowable tolerance 
limits of all the independent variables in the 
optical system simultaneously. The results show that 
the developed approach is apparently more systematic, 
efficient, and accurate. 
 
英文關鍵詞： optical path length, gradient matrix, tolerance 
analysis, tolerance allocation 
 
 II
 
行政院國家科學委員會專題研究計畫進度報告 
使用光程差在光學系統的靈敏度分析與裕度
分配 
 
The tolerance analysis and tolerance allocation based on the optical path 
length difference  
計畫編號：NSC 99－2221－E－006－023-MY2 
執行期限： 99 年 08 月 01 日至 101 年 07 月 31 日 
主持人：林昌進教授     國立成功大學機械工程學系 
 
一、中文摘要 
光程差的重要性在於其可作為評估光學系統性能的評價標準。因此，本研究乃利
用歪斜光線追蹤法，致力於發展光學系統全參數變化對光程影響的梯度矩陣。因為探
討光學系統全參數變化對光程的影響時，目前的光學軟體多利用有限差分法，其計算
概念是分別追蹤參數未變化前與參數有微變後的兩種光程，再使用有限差分法計算光
程梯度。本研究的光程梯度矩陣法因使用微分概念避開有限差分法因分母微變量極小
的問題，而且本研究在計算效率上僅需追蹤一次光線，優於目前有限差分法的多次光
線追蹤。在完成光學系統設計後進入加工製造之前，光學設計者必須考慮系統公差問
題，並給予參數合理的公差範圍。因此公差分析與公差分配問題是光學設計者所關心
的重要議題。本研究今年已將光程梯度矩陣法應用在公差分析，其可計算元件之製造
誤差與組裝誤差對光學系統的光程影響。結果顯示，本理論因利用光程梯度法，在公
 IV
TABLE OF CONTENTS 
Chapter 1 INTRODUCTION ·················································································1 
    1.1 Statement of the Problems········································································1 
    1.2 Literature Review ·····················································································2 
    1.3 Basic Principles of Geometrical Optics ····················································9 
1.4 Overview of Sections ·············································································13 
Chapter 2 SKEW RAYTRACING METHOD ·····················································14 
2.1 Raytracing ······························································································14 
    2.2 Homogeneous Coordinate Transformation·············································15 
    2.3 Generation of Boundary Surfaces and Normals ·····································19 
    2.4 Skew Raytracing at Boundary Surfaces ·················································21 
Chapter 3 OPTICAL PATH LENGTH GRADIENT MATRIX OF 
AXISYMMETRIC OPTICAL SYSTEM·············································26 
    3.1 Notations Applied in Modeling an Axisymmetric Optical System·········26 
    3.2 OPL Gradient with respect to Incoming Ray and Boundary Variables···31 
       3.2.1 OPL Gradient with respect to Incoming Ray·································31 
       3.2.2 OPL Gradient with respect to Boundary Variables ························32 
    3.3 OPL Gradient of Lens with respect to Its Independent Variables ···········33 
    3.4 OPL Gradient of Optical System with respect to Its Variables ···············37 
3.5 Illustrative Example - Petzval Lens························································38 
    3.6 Summary ································································································42 
 VI
    6.1 Conclusions ····························································································87 
    6.2 Future work ····························································································89 
APPENDIX A ······································································································90 
APPENDIX B ······································································································91 
APPENDIX C ······································································································92 
APPENDIX D ······································································································94 
APPENDIX E·······································································································97 
REFERENCE·······································································································98 
 
 
 
 
 
 
 
 
LIST OF FIGURES 
Fig. 1.1 Cross-sectional diagram of a single lens reflex camera·····························4 
Fig. 1.2 Schematic diagram of a binocular ·····························································5 
Fig. 1.3 Cross-sectional diagram of a monocular ···················································5 
Fig. 1.4 The rectilinear propagation of light···························································9 
Fig. 1.5 The rectilinear propagation of light in a pinhole camera·························10 
Fig. 1.6 Law of reflection·····················································································11 
 VIII
Fig. 4.3 Cross-sectional diagram of a right-angle prism [48] ·······························47 
Fig. 4.4 Schematic diagram of porro prisms [48] ·················································47 
Fig. 4.5 Schematic diagram of a roof prism [48]··················································48 
Fig. 4.6 Schematic diagram of a dove prism [48]·················································49 
Fig. 4.7 Schematic diagram of a penta prism [48]················································49 
Fig. 4.8 Schematic diagram of an illustrative pechan prism·································51 
Fig. 4.9 Percent deviation of FD results relative to constant solution of 
10.988e1 e1zOPL     obtained using proposed method for various 
values of e1z ·······················································································61 
Fig. 4.10 Cross-sectional diagram of an image intensifier camera [58] ···············62 
Fig. 4.11 Cross-sectional diagram of a sniper scope [59]·····································63 
Fig. 5.1 jth element with jL  boundary surfaces and exit ray 0 0j j
T
m m
  P  ······68 
Fig. 5.2 Optical system containing dove prism and source ray ····························70 
 
LIST OF TABLES 
Table 3.1 Variables of Petzval lens system (see Fig. 3.1) (units: radian for an   
        angle and millimeter for else) ·······························································39 
Table 3.2 Comparison of results obtained for system e1OPL X  using FD   
        method and proposed method, respectively(units: radian for an   
        angle and millimeter for else) ·······························································40 
Table 3.3 Results obtained from FD method for system e1xOPL   as function of 
 1
Chapter 1 
INTRODUCTION 
1.1 Statement of the Problems 
At some point in the process of designing an optical system, the designer must 
decide whether the design is good enough for the application. Of all the properties of an 
optical system, the optical path length (OPL) is one of the most important since it 
determines not only the phase of the light, but also its interference and diffraction. 
Accordingly, the literature contains many proposals for calculating the OPL and for 
determining its sensitivity to changes in the design parameters of the corresponding 
element or system [1,2]. Determining the OPL difference is of fundamental importance 
when designing an optical system from fine tuning the performance of an existing system. 
Many of the OPL evaluation methods presented in the literature are based on raytracing 
techniques. For example, Stone and Forbes [3] had developed a matrix formulation to 
calculate and describe a ray traveling through inhomogeneous optical elements by using 
Finite Difference (FD) ray trace. However, in literature [4], whilst the numerical results 
were found to be in good agreement with those obtained by using a raytracing approach, 
the model was only capable of analyzing the effects of a limited number of variables, i.e. 
the radius of the refracting surface, separation of each refracting surface and refractive 
index of the medium. Moreover, traditional FD method has numerical precision problems 
when subtracting two large performance numbers to determine a small difference with two 
raytracing operations, and therefore yields a substantial improvement in the accuracy and 
computational efficiency. 
 3
presented by Purnet et al. [6], they proposed a birefringent interferometer based on two 
identical Wollaston prisms and analyzed its performance in calculating the OPL difference.  
Most fundamental research in optical design has revolved recently around the topic of 
optimization. The idea of optimization is very simple, but the mathematics involved can 
become very complex. Meiron [7] demonstrated the automatic optimization of optical 
systems utilizing a raytracing approach based upon 25 skew rays and three different merit 
functions, namely the mean square value of the OPL difference, the variance of the OPL 
difference, and the variance of an MTF-based function, respectively. Bokor and Papp [8] 
proposed the optimization of kinoform lenses based on the Monte Carlo method and used a 
correlation function that characterizes the image fidelity of the computer-generated 
holograms as a merit function for optimization procedures. Klemens and Fainman [9] 
presented an optimization-based method of calculating the performance of nonlinear 
process in a resonator. Besides, many other commercial optical design programs use 
various forms of the damped least-squares method for optimization purpose. Dobson and 
Cox [10] developed a new software based on the Damped Least Squares (DLS) method 
that maximizes the relative modulation transfer function (MTF) by minimizing an 
image-quality merit function (1 minus the approximate relative MTF). In addition, several 
recent efforts have focused on the understanding of merit functions, such as the wavefront 
variance, rms spot size [11-13], and so on. More specifically, when optimizing optical 
systems using a merit function defined in terms of the OPL, the OPL should be related to 
the individual variables in some way such that the effects of variable changes can be 
systematically explored. Conventionally, this is performed by utilizing FD approximation 
methodology to determine the change in OPL by tracing the original optical system and the 
small change of it individually. However, such an approach is computationally inefficient 
since it requires two raytracing operations to be performed to determine the change in the 
 5
objective lens 
porro prisms 
pechan prism 
 
 
 
 
 
 
 
Fig. 1.2 Schematic diagram of a binocular [16] 
 
 
 
 
 
 
 
 
 
 7
reflection from the base is in the total internal reflection (TIR) mode. It is well known that 
errors in the base angles result in deviation, dispersion, and so on. Accordingly, this report 
deliberately chooses the pechan prism and dove prism for illustration purposes in verifying 
the feasibility of the proposed non-coplanar system modeling approach and the tolerance 
problems in Chapter 4 and Chapter 5, respectively. 
 Note that an optical system design is not truly complete until the designer has 
defined a set of tolerances. The simplest answer of this problem is because of the cost. A 
design may be too expensive for manufacturing if small variations in the optical system 
parameters result in significant performance. Therefore ever since dimensional tolerances 
were first introduced, the problems of tolerance analysis and tolerance allocation have been 
a matter of great concern to engineers. The complex process of defining system tolerances 
is often simply called tolerancing. The term “tolerance analysis” describes the process of 
predicting the effects of manufacturing defects and alignment errors on the performance of 
the designed system, while the term “tolerance allocation” describes the process of 
determining the tolerances of the individual system variables in some rational way given 
knowledge of the total tolerance budget for the system. Of the two problems, the tolerance 
allocation problem is of particular importance to engineers in attempting to enhance the 
overall product quality and robustness. However, the problem of allocating suitable 
tolerances to each of the independent variables in an optical system is highly challenging, 
and thus the existing literature focuses mainly on the tolerance analysis problem more than 
the tolerance allocation problem. Ozkan et al. [37] utilized a Monte Carlo method to 
analyze the tolerance sensitivity of free-space optical interconnects and to identify the 
tolerances having the greatest effect on the system performance. Rimmer [38] proposed a 
method for evaluating the wavefront aberration due to a small parameter perturbation and 
utilized the variance of the wavefront as a tolerancing criterion. Ghodgaonkar and Tewari 
 9
source 
shadow 
screen 
as the basis for a new worst case based methodology aimed at solving both the tolerance 
analysis problem and the tolerance allocation problem for general optical systems.  
1.3 Basic Principles of Geometrical Optics 
Geometrical optics describes light propagation in terms of rays which can be used to 
predict the path of light. A light ray is a ray that is perpendicular to the light's wavefronts 
(and therefore collinear with the wave vector). Light rays bend at the interface between 
two dissimilar media. This section introduces the basic principles of geometrical optics in 
the following： 
1. Rectilinear propagation of light： (see Fig. 1.4) 
The rectilinear propagation of light is the technical terminology applied to the 
principle that “light travels in straight lines.” In a homogenous transparent medium, 
light travels in a straight line. A slightly more rigorous definition of a light ray 
follows from Fermat's principle which states that the path taken between two points 
by a ray of light is the path that can be traversed in the least time. For the 
interpretation of rectilinear propagation of light, we also illustrate another well 
known case which is pinhole camera (see Fig. 1.5). 
 
 
 
 
 
 11
medium i-1 
reflected ray 
i i
medium i 
incident ray 
 
normal 
boundary surface 
 
medium i-1 
refracted ray 
i
i
medium i 
incident ray 
 
normal 
boundary surface 
 
    Note that i-1ξ  and iξ  represent the refractive index of medium i-1 and medium i 
with respect to vacuum, respectively. This experimental result, together with the 
observation that the incident and refracted rays and the normal all lie in the same plane, is 
called the law of refraction or Snell’s law. 
 
 
 
 
 
 
 
 
Fig. 1.6 Law of reflection 
 
 
 
 
 
 
 
 13
 
 
1.4 Overview of Sections 
    This report includes six chapters, whose respective outlines are as follows: 
    Chapter 2 briefly reviews the concept of homogeneous coordinate transformation and 
the skew raytracing method because skew ray is the most general ray path. Moreover, this 
chapter also contains the introduction of the generation of common optical boundary 
surfaces. 
    Chapter 3 investigates optical path length gradient matrix of axisymmetric optical 
system. It begins with a notations introduction and then leads to the gradient matrix 
method modeling. The last part of this chapter presents a demonstration of the proposed 
method.  
    Chapter 4 introduces several common prisms and the notions of a prism model in the 
beginning. Section 4.3 presents the OPL gradient matrix model of prism with respect to its 
independent variables. In the end of this chapter, this report utilizes a Pechan prism as an 
example for verification purpose. 
Chapter 5 reviews the gradient matrix concept and demonstrates its use in analyzing 
the effects of changes in the independent variables of an optical system on the OPL and the 
exit ray, respectively. This chapter also presents two algorithms for solving the general 
tolerance allocation problem using a computer-aided scheme and for identifying the 
optimal tolerance allocation which minimizes the production cost of the optical system, 
respectively.  
    Chapter 6 summarizes the accomplishment of this report and proposes possible future 
work based on the developed gradient matrix approach. 
 
 15
the oblique meridional ray through the center of the aperture of a lens system is called the 
chief ray.  
Axial and meridonal rays can be traced by simple trigonometric formulas or even 
graphically if low precision is required. However, meridional rays are usually traced as a 
special case of a skew raytracing. Note that the application of the term “skew” is usually 
restricted to rays which are not meridional rays. In this study, a skew ray is defined in three 
coordinates x, y, and z, instead of just z and y as in the case of meridional rays. 
 
 
Fig. 2.1 Schematic illustration of axial ray, paraxial ray, chief ray, and skew ray 
 
2.2 Homogeneous Coordinate Transformation 
The homogeneous coordinate representation of a vector in three space is a 
four-space entity such that a particular perspective projection recreates the three space. 
This can be viewed as the addition of an extra coordinate (scale factor) for each vector 
such that the vector would have the same meaning if each component, including the scale 
factor, were multiplied by a constant. In this report, the ith position vector ix iy izP P P i j k  
 17
Fig. 2.6). Each of the four terms in Eq. (2.1) is defined in Appendix A.  
 
 
 
Fig. 2.2 Physical meaning of the homogeneous transformation matrix 0
i A  
 
 
 
xi 
zi 
yi 
x0 
y0 
z0 
( ixt , iyt , izt ) 
referred to (xyz)i 
xi 
zi 
yi 
x0 
y0 
z0 
[tix tiy tiz 1]T 
[Iix Iiy Iiz 0]T 
[Jix Jiy Jiz 0]T 
[Kix Kiy Kiz 0]T 
 19
Fig. 2.5 Rotation homogeneous transformation matrix (rotates about the yi axis) 
     
Fig. 2.6 Rotation homogeneous transformation matrix (rotates about the zi axis) 
2.3 Generation of Boundary Surfaces and Normals 
    One important feature of typical optical elements is that their boundary surfaces, at 
which the reflection and refraction processes occur, are surfaces of revolution. 
Consequently, the proposed methodology first studies the boundary surfaces in terms of 
revolution geometry and then establishes the skew ray paths via the tracing technique. A 
boundary surface i ir   can be obtained by rotating its generating curve 
 ( ) 0 ( ) 1 Ti i i ix z S  in the xz plane about its optical z axis (see Fig. 2.7). That is,  
 
0 0 ( )
0 0 0
( , ) S ( ) ( ) ( ) 1
0 0 1 0 ( )
0 0 0 1 1
i i i
Ti ii i
i i i i i i i i
i
C S x
S C
Rot z x C x S z
z
  
      
                    
r , (2.2) 
iz
x0 
xi 
yi 
zi 
y0 
z0 
iziz
  
 21
2.4 Skew Raytracing at Boundary Surfaces 
This section presents the basic principles of the skew ray tracing approach.  
Figures 2.8 and 2.9 show the skew raytracing of a ray originating at point 
1 1 1 1 1
T
i i x i y i zP P P      P  and traveling along a unit directional vector 
1 1 1 1 0
T
i i x i y i z          until it is reflected/refracted at the ith boundary surface. 
For convenience, only the two most basic boundary surfaces are discussed here, namely (a) 
a spherical boundary surface  1 Ti i i i i i i i i iR C C R C S R S    r  with a unit normal 
 0 Ti i i i i i i is C C C S S    n  (see Fig. 2.8) and (b) a flat boundary surface 
 0 1r Ti i i i i iC S      with a unit normal vector  0 1 0 0 Ti i is n  (see Fig. 
2.9). Note that in the definitions of the unit normal vectors, is  is set to either +1 or -1 as 
required to ensure that the cosine of the incident angle has a value greater than zero, i.e. 
0iC  . Note also that i in  is expressed with respect to the boundary coordinate 
frame ( )ixyz . Finally, the pose of the world coordinate frame 0( )xyz  with respect to 
coordinate frame ( )ixyz  is given by Eq. (2.1).  
    The unit normal in  relative to coordinate frame 0( )xyz can be obtained by 
transforming i in  to coordinate frame 0( )xyz  via the following transformations:  
0 1
00 ( )
0
T i i i
i ix iy iz i i i i ix i i iy i i iz i
T
ix i i iy i i iz i ix i i iy i i iz i
n n n s I C C I C S I S
J C C J C S J S K C C K C S K S
    
         
         
    
n A n A  n
      
, (2.4a) 
 0 100 ( ) 0
T Ti i i
i ix iy iz i i i i iy iy iyn n n s I J K
            n A n A  n , (2.4b) 
 23
     
     1 1 1 1 1 11 1 1 1 1 1
P P P
arctan
P P P
iy i x i x i iy i y i y i iy i z i z i iy
i
ix i x i x i ix i y i y i ix i z i z i ix
I J K t
I J K t
     
     
     
               
  
   , 
     1 1 1 1 1, 1P P Parcsin iz i x i x i iz i y i y i iz i z i z i izi
i
I J K t
R
                  
  
. 
Note that these incident point parameters are of no interest for the flat boundary surface 
shown in Fig. 2.9 since the reflection / refraction process is independent of the location of 
the incident point on the boundary surface. 
The incident angle on boundary surface i is given by 
 
   
1 1
1 1
T
i i i i i x ix i i iy i i iz i
i y ix i i iy i i iz i i z ix i i iy i i iz i
C s I C C I C S I S
J C C J C S J S K C C K C S K S
     
         
 
 
     
      
 n 
 

, (2.7a) 
 1 1 1 1Ti i i i iy i x iy i y iy i zC s I J K          n     . (2.7b) 
The refraction angle i  of a ray passing through the interface between two 
different optical media is defined by Snell’s law as follows:  
  1i i i i i iS S N S      , (2.8) 
where i  is the refractive index of medium i and 1i i iN    is the relative refractive 
index of medium i-1 with respect to medium i.  
According to Snell's Law, the unit directional vector of the refracted ray can be 
expressed as 
 25
 
   Fig. 2.9: Skew raytracing at flat boundary surface. 
 
 
 
 
 
 
 
 
 
flat boundary 
surface ri 
zo 
yo 
xo 
Pi-1 
xi 
zi
i
i
li
li-1
medium i
medium i-1
Pi
 27
 1
T
i ix iy iz ix iy iz i i it t t R       X , (3.1) 
as the independent variables of the ith boundary surface, where  , , , ,ix iy iz iz iyt t t      and 
ix  are the pose parameters in Eq. (2.1), 1i   and i  are the refractive indices of 
medium 1i   and medium i, respectively, and Ri is the radius of boundary surface i (see 
Fig. 2.8). The equations of skew raytracing when a ray is refracted by a flat boundary 
surface (see Fig. 2.8) are demonstrated by Eqs. (2.4b), (2.5) and (2.6b). Note that the 
number of independent variables of it within Eq. (3.1) has to be reduced to just five, 
namely 1, , ,iy ix iz it        and i ; even so, we also use Eq. (3.1) to designate the boundary 
variables of a flat boundary surface for modeling in order to be consistent with the 
boundary variables of the spherical boundary surface. 
Figure 3.2 illustrates the passage of a ray through a generic lens. Assume that this 
lens is the jth element in an optical system and has two optical boundary surfaces, 2 1jr  
and 2 jr . In order to be consistent with our previous nomenclature, hereafter a lens will be 
referred as an element. In 3D space an element coordinate frame ( )ejxyz  is needed to 
define the pose of this jth element. The pose of coordinate frame 0( )xyz  with respect to 
coordinate frame ( )ejxyz  can be given by (see Eq. (2.1)) 
 0 ( , , ) ( , ) ( , ) ( , )
ej
ejx ejy ejz ejz ejy ejxTrans t t t Rot z Rot y Rot x  A . (3.2) 
The feature of parameters used for an element is that we always use “e” to lead the element 
number ”j”. Thus, the independent variables of the jth element include the six pose 
parameters ejxt , ejyt , ejzt , ejx , ejy  and ejz , the refractive indices 2 2 2j j air     and 
 29
 
0
0
0 0 0
0 0
0 0 0 0 0 0 0
0
0 0 0 0
0
0
1 0 0 0 0
P
0 1 0 0 0
P
0 0 1 0 0
P
0 0 0
0 0 0
0 0 0 0
x
y
zS C C S
S S C C
C
        
                                          
P P X
X
X  . (3.5) 
The derivations performed in this report make frequent use of the following Jacobian 
matrix: 
 ( , )
( , )
f f
f g u v
g gu v
u v
             
, (3.6) 
where Eq. (3.6) is known as the Jacobian matrix of f  and g  with respect to u  and v . 
An example of Jacobian matrix is given in Eq. (3.17). 
 
 
 
 
 
 
 
 
 
 31
3.2 OPL Gradient with respect to Incoming Ray and Boundary Variables 
This section formulates the gradient matrix of iOPL  with respect to the boundary 
variables iX  and the incoming ray  1 1 Ti i P  (see Fig. 3.3). Note that in optics the 
optical path length between points 1iP  and iP  is defined as the product of the geometric 
length i  between these two points and the refractive index 1i  . That is 1i i iOPL   .  
3.2.1 OPL Gradient with respect to Incoming Ray 
 Equations (2.6a) and (2.6b) show that the geometric lengths i  associated with a 
spherical boundary surface and a flat boundary surface, respectively, vary as a function of 
the incoming ray vector  1 1 Ti i P  . Thus, iOPL  is influenced by the vector of the 
incoming ray 1 1 Ti i P  . The change in iOPL  induced by change in the incoming ray 
can be derived by taking the first-order differentiation of the formulation for iOPL , i.e. 
 1 11 1
1 11 1 1 1
i ii i i i
i i i i
i ii i i i
OPL OPLOPL      
    
                              
P P
P P   , (3.7) 
The entries of  1 1i i i iOPL OPL    P  , the OPL gradient with respect to the 
incoming ray, can be obtained directly by differentiating 1i i iOPL    with respect to its 
incoming ray. The differential equations are attached in the Appendix B from Eq.(B1) to 
Eq.(B18). 
 
 
 
 33
 
Fig. 3.3: The OPL between two points is the product of their geometric length and the  
refractive index. 
 
 
3.3 OPL Gradient of Lens with respect to Its Independent Variables 
As shown in Fig. 3.2, a lens (denoted hereafter as the jth element) possesses two 
optical boundary surfaces, 2 1jr  and 2 jr . Here the optical path length ejOPL  of a ray is 
defined as the summation of optical path lengths between points 2 2jP  and 2 jP , i.e. 
2 1 2ej j jOPL OPL OPL  . Thus, the change in ejOPL  is given by 
 2 1 2ej j jOPL OPL OPL     . (3.10) 
2 1jOPL   and 2 jOPL in Eq. (3.10) are obtained from Eq. (3.9) by setting 2 1i j   and 
2i j , respectively, given as  
 2 22 1 2 1 2 12 1 2 2 2 1 2 2 2 2 2 1
2 22 2 2 2 2 1
jj j j
j j j j j j
jj j j
OPL
            
  
                   
P
X
P X , (3.11) 
1iP
1i
iP i
medium i-1 
medium i 
R i
yi
zi
1i i
boundary 1ir  
boundary ir  
i
 35
 2 1 6 6 6 3 6 2
3 6 3 3 3 2
j
ej
   
  
      
X I 0 0
0 I 0X
. (3.16) 
2 j ej X X  is addressed in Appendix D and has the form shown in Eq. (3.17). 
 
2,9 2,10 2,11
2
1 0 0 0 0 0 0 0 0 0 0
0 1 0 0 0 0 0 0
0 0 1 0 0 0 0 0 0 0 0
0 0 0 1 0 0 0 0 0 0 0
0 0 0 0 1 0 0 0 0 0 0
0 0 0 0 0 1 0 0 0 0 0
0 0 0 0 0 0 0 1 0 0 0
0 0 0 0 0 0 1 0 0 0 0
0 0 0 0 0 0 0 0 0 1 0
j
ej
c c c
                
X
X
. (3.17) 
We also have the following equations: 
  2 2 1 6 1 41j air ej       0 0 X , (3.18) 
  2 1 1 7 1 31j ej ej       0 0 X . (3.19) 
After substituting Eqs. (3.14), (3.16) and (3.18) into Eq. (3.11), we can further express Eq. 
(3.11) in another form given by Eq. (3.20)  
 
 2 22 1 2 1 2 1 6 6 6 3 6 22 1 2 2 2 1 1 6 1 4 2 2
2 2 3 6 3 3 3 22 2 2 2 2 1
1
X
jj j j
j j j ej j ej
jj j j
OPL
              
     
                        
P I 0 0
0 0 X X
0 I 0P 
2 22 1 2 1 2 1
2 2
2 22 2 2 2
               jj j jj ej
jj j ej
OPL    
 
                
P
X
P X . (3.20) 
 37
The further application of this developed mathematical model is that the change in 
the OPL for an optical system can be determined simply by summing the changes in the 
OPLs of neighboring elements. It is obvious that there is potential for the developed 
gradient matrix to be a compact tool for quickly analyzing an axisymmetric optical system. 
3.4 OPL Gradient of Optical System with respect to Its Variables 
An optical system considered contains k elements (an example is shown in Fig. 3.1). 
The change in the OPL of the system can be obtained by adding the sum of ejOPL (Eq. 
(3.22)) for all elements from 1j   to 1j k   and 2 1kOPL   (Eq. (3.20) by setting 
j=k), i.e.  
 
1
2 1
1
1 1
2 2 2 22 1 2 1 2 2
2 2 2 1 2 1
2 2 2 21 12 2 2 2 2 1 2 1
2 1 2
j k
system ej k
j
j k j k
j jj j j j
j j j
j jj jj j j j
j j
ej ej
OPL OPL OPL
OPL OPL
    
 


     
  
     

    
                              
        

 P PMP P
X
X X
  
1
2 22 1 2 1 2 1
2 2
1 2 22 2 2 2
2 2 2 22 1 2 1 2 2
2 2 2 1 2 1
2 2 2 21 2 2 2 2 2 1 2 1
j k
kk k k
ej k ek
j kk k ek
j k
j jj j j j
j j j
j jj j j j j
OPL 
    
    

  
   
  
     
              
                            


P
X
P X
P P
M
P P

  
1
1
j k
j
 


   
1
2 1 2
1 1
         
j k j k
j ej j ej
system system
j jej system ej system
OPL OPL  
 
          
X X
X X
X X X X
. (3.23) 
As described in Section 3.3, 2 2 2 2
T
j j    P   (j=2,…,k) is the change of exit ray of the  
(j-1)th element. It is given by (Eq. (18) of [44]) 
 2 2 2 4 2 2 2 22 2 2 3 2 2
2 2 2 4 2 2 2 2
j j j j
j j j
j j j j
   
  
   
                       
P P P X
M M X
X   . (3.24) 
 39
Table 3.1: Variables of Petzval lens system (see Fig. 3.1) (units: radian for an angle and 
millimeter for else) 
 
The change in OPL caused by changes in any of the system variables can be 
obtained from Eq. (3.23) with k=6, i.e.  
 
6 5
2 2 2 22 1 2 1 2 2
2 2 2 1 2 1
2 2 2 21 12 2 2 2 2 1 2 1
j j
j jj j j j
system j j j
j jj jj j j j
OPL
    
   
  
     
                                
P P
M
P P      
6 5
2 1 2
1 1
                 
j j
j ej j ej
system system
j jej system ej system
OPL OPL 
 
          
X X
X X
X X X X
. (3.25) 
In this study, the solution accuracy and speed of the developed method was benchmarked 
against that of the conventional FD method. In the comparative trials, the two methods 
were used to calculate the gradient matrix system e1OPL X  of the system shown in Fig. 
3.1 (with an assumed source ray vector  0 0 TP  =  T0 0 10 0 1 0 ) on a 
conventional personal computer (CPU = 2 GHz Pentium) using a program coded with 
Visual Fortran 6.5 (Compaq, USA) with double precision. Significantly, solving the 
gradient matrix using the FD method involved two raytracing operations (i.e. one operation 
using the variables listed in Table 3.1 and a second operation using the same variables but 
j  ejxt  ejyt  ejzt  ejx ejy ejz air ej  2 1jR   2 jR  jq  
1 0   38.222 0 0 0 0 1 1.6500 38.222  56.086 15.850
2 0  -40.191 0 0 0 0 1 1.7174 56.086 590.682  5.969
3 0  24.886 0 0 0 0 1 1.0000 － －  7.620
4 0  -2.889 0 0 0 0 1 1.5258 41.796  29.345  2.515
5 0 106.896 0 0 0 0 1 1.6500 63.564  56.866  6.096
6 0 105.074 0 0 0 0 1 － － － － 
 41
geometrically exact numeric value of system 0.242e1xOPL     obtained using the 
developed method. It is observed that for different values of e1x  but otherwise identical 
system parameters, the results obtained by the FD method for system e1xOPL    deviate 
by between -100% to +115.29% from the more exact solution obtained using the 
developed approach. In FD, the division operation is highly sensitive to the size of the 
denominator relative to the numerator. When an inappropriate value of e1x  is selected, 
the value produced may have great error. 
With regard to the computational efficiency of the two schemes, the CPU times for 
the FD method and the developed method while calculating the gradient matrix 
system  e1xOPL   of the system shown in Fig. 3.1 were found to be 0.042sec  and 
0.022sec , respectively. In other words, the proposed method achieves a reduction of 
around 90% in the computational processing time compared to that of the FD method. The 
greater computational time of the FD method is the result of its requirement for two 
raytracing operations and the need for an additional subtraction operation to obtain the 
numerator term to calculate its OPL gradient. 
 
 
 
 
 
 
 
 
 
 43
computational time relative to that of the FD method. Moreover, the proposed method 
yields reliable and accurate predictions for the change in the OPL induced by changes in 
the design variables, whereas the accuracy of the FD solutions depends fundamentally 
upon the size of the denominator term. Overall, the numerical results confirm that the 
method presented in this study represents a suitable basis for analyzing the OPL of an 
axisymmetric optical system. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 45
sophisticated scientific instruments including interferometers, spectrophotometers, and so 
on. Therefore the specific tolerances of prism variables and exact angles have been a 
matter of great concern to engineers. Actually, prisms can be roughly divided into three 
general categories: reflecting prisms, polarizing prisms, and dispersion prisms. The former 
are useful for redirecting light beams while the latter can be employed to separate light into 
its component colors. However, the most common use of prisms is to output an image with 
an orientation that is changed relative to the input image. Thus several common used 
prisms are introduced in the following [48-51]: 
(1) Dispersion 
The phenomenon known as dispersion of a triangular prism is to separate light or 
radiation according to different wavelengths. This causes the light of different colors to be 
refracted differently and to leave the prism at different angles (see Fig. 4.1). Examples of 
the use of these refractive prisms include spectroscopy, and the spectrophotometer. Though 
this report did not consider the phenomenon in modeling, we still gave a description for the 
property for introduction purpose.  
 
 
 
 
Fig. 4.1 The dispersion of white light as it travels through a triangular prism [48] 
red light  
purple light  
white light  
 47
 
Fig. 4.3: Cross-sectional diagram of a right-angle prism [48] 
(4) Porro prism 
There are two basic types of porro prisms and both used in pairs, forming a double 
Porro prism. One of the two types is that the second prism, rotated 90° with respect to the 
first, is placed such that the beam will traverse both prisms. Another type is a beam parallel 
to but displaced from its original direction, with the image rotated 180°. (see Fig. 4.4) 
 
 
Fig. 4.4: Schematic diagram of porro prisms [48] 
 49
 
Fig. 4.6: Schematic diagram of a rotational dove prism [48] 
(7) Penta prism 
The function of a penta prism is to deviate the direction of a light beam by 90° via 
twice reflection. The deviation angle of 90° is independent of any rotation of the prism 
about an axis parallel to the line of intersection of the two reflecting faces. (see Fig. 4.7) 
 
Fig. 4.7: Schematic diagram of a penta prism [48] 
 51
e1h
P0 
x0   
y0   
e1g
P3 3i 
6i 
P6 
e1gap
9i 
P9   
x6   
x9   
z9   
y6 
5i 
4i 
P4   
P5   
P8 
P2 
2i 
8i 
7i P7   y7    x7   
P1 
1i 
x3    
y3   
x2   
y2 
x1   xe1    
y4 
x4 
y5,y8    
x5,x8 
0
y1 
ye1 
The ray refracted from the exit surface of the element shown in Fig. 4.8(b), 
i.e.  Te1 e1P  , is denoted as P P P Te1x e1y e1z e1x e1y e1z     . (Note that 
 
1 1
TT
1 1e e L L   P P  .) The differential change of  T0 0P  can be obtained from 
Eq.(3.6).  
 
(a) misalignment sketch of a prism with L1=9 boundary surfaces. 
 
 
 
 
 
 
    
       (b) cross-sectional diagram of a modeled prism 
Fig. 4.8 Schematic diagram of an illustrative pechan prism 
ejgap
ejy
ejz
1i 
2, 4i 
1 9i L 
ejx
3i 
1L
x
0
1L

jth element 
ej
air
1air L
 
22.5
22.5
0P
ejh
ej
ejg
0y0z
0x
1L
y
1L
P
 53
where iM  (Eq. (23) in [58]) is designated as the sensitivity matrix. Equation (4.2) 
includes all independent variables of a boundary surface to calculate the OPL change.  
    This section constructs the gradient matrix of e1OPL  with respect to the source ray 
 0 0 TP   and the independent variables of the prism, e1X . As described in Section 4.1, a 
prism has 1L  flat boundary surfaces, designated as 1i   to 1i L , respectively. 
Therefore, the OPL of a ray traveling through the prism is obtained by summing the OPLs 
associated with each of its boundary surfaces, i.e. 
 
1 1
1 2 3 +1 +2
1
...
          ...  
e1 i i i
L L
OPL OPL OPL OPL OPL OPL OPL
OPL OPL
      
   . (4.4) 
Similarly, the overall change in the OPL of the prism caused by changes in any of its 
independent variables is given by 
 
1 1
1 2 3 +1 +2
1
...
              ...  
e1 i i i
L L
OPL OPL OPL OPL OPL OPL OPL
OPL OPL
             
     . (4.5) 
Equation (4.5) can be solved by utilizing Eq. (4.2) to compute iOPL  for each boundary 
surface 1i   to 1i L , i.e.      
0 11 1 1 2 2 2
1 2
0 10 0 1 1 1 2
23 3 3
3
22 2 3
             ...
e1
i
OPL OPL OPL OPL OPL OPLOPL
OPL OPL OPL OPL
                                                  
                      
P P
X X
P X P X
P
X
P X
  

1
11 1
11 1 1 2 2 2
1
11 1 1 2
             
ii i
i
ii i i
i ii i i i i i
i
i ii i i i i i
OPL OPL
OPL OPL OPL OPL OPL OPL

 
     

   
                 
                                        
P
X
P X
P P
X
P X P X

  
11 1 1
1
11 1 1
11 1 1
1
11 1 1
2
21 1 1
1
22 2 1
1
11 1
             ...
             
i
LL L L
L
LL L L
LL L L
L
LL L L
OPL OPL OPL
OPL OPL OPL

  

  

 
     
                      
                 
X
P
X
P X
P
X
P X

                                                                          (4.6)
     
 55
 
1
1 1
1
1 1 1 1
1 1 1
1 1 1 1
2 0 0 1 1
2 1 0 2 2 1
0 0 1 12
3 3 2 2
2 3 2
3 3 2 2
L
L L
L
L L L L
L L L
L L L L

 

   
  
   
                          
                     
P P X P X
M M X M M X
X X
P X P X
             M X X
X X
 
 
, (4.13) 
1
1 1
1
1 1 1 1
1 1 1 1
1 1 1 1
1 0 0 1 1
1 1 0 1 2 1
0 0 1 11
2 2 1 1
1 1 1 2
2 2 1 1
...L L L
L
L L L Li i
L i i L L L
i i L L L L

 

   
    
   
                           
                               
P P X P X
M M X M M X
X X
P X P XP X
M M X M X X
X X X
 
   1
. (4.14) 
Substituting Eqs. (4.7) ~ (4.14) into Eq. (4.6), the following expression for 1eOPL  is 
obtained: 
 
1 1
1 1
1 1
1 1
1 1
11 2
1 2 1
1 2 1
1 1 2 2
1 1 1
0 0 1 1 1 1
1 1
...
  
     
L L
e1 L L
L L
i i
i
i i
L L
L L
OPL OPLOPL OPLOPL
OPL OPLOPL OPL OPL OPL
OPL OPL




 
 
              
                           
      
X X X X
X X X X
M M M
P P P
P
  
 1
1 1
1
1 1
0 0
1 1 0
0 0
3 32 2 i
2 1 2
1 1 2 2 1 1
1 1
1 2 1
1 11 1
  
     
L
i
i
i i
L L
L
L L
OPL OPL OPLOPL OPL OPL
OPL OPL


 

 
        
                            
                   
P X
M M X
X
M M M
P P P
P X
M M X
XP

  

1 11 1 1 1
1 1
1 11 1 1 1
1 11 1
1 11 1
2 21 1
1 2
2 22 2 1 1
1 1
1 11 1
  ...
  
    
L LL L L L
L L
L LL L L L
L LL L
L LL L
OPL OPL OPL OPL
OPL OPL
  
 
    
 
  

                                     
                 
P X
M X
XP P
P X
XP
 
 1 1L X
  
 57
thus a total of 12 L  refractive indices are used in Eq. (4.15). Clearly, the dependent 
boundary variables ( iX , 1i   to 1i L ) must be related in some way to e1X , i.e. the 
independent variables of the prism. The relationship between the two sets of variables can 
be obtained via the chain rule  i i e1 e1    X X X X . Thus, e1OPL , i.e. the overall 
change in the OPL of the element shown in Fig. 4.8(b), can be further expressed as 
1 1
1
1 1
1 1 2 2
1 1 1
0 0 1 1 1 1
0 0
1 1 0
0 01 1
    
     
   
e1
e1 e1
e1
i i
i
i i
L L
L
L L
i
i
OPLOPL
OPL OPLOPL OPL OPL OPL
OPL OPL
OPL

 

 
  
                           
                   
 
X
X
M M M
P P P
P X
M M X
XP
X
  

1 1
1 1
1 1
= = 2
+1 +1 +2 +2
+1
1 0 +1 +1
L
1 2 +2 +1
1 1
...
    ...
   
i ii L i L
i i i i i
e1 i
i ie1 i i i i
L i i i
L L i i e1
i iL L e1
OPL OPL OPL OPL
OPL OPL
OPL

 
 
 
                    
                   

 X X MX P P
P X XM M M M X
XP X
 

1 11 1 1
1 11 1
1 1 1
1 11 1
L LL L L
e1
L LL L e1
OPL   
  
                 
P X X
X
XP X
 (4.16) 
Each entry of the Jacobian matrix i e1 X X  ( 1i   to 1i L ) in Eq. (4.16) represents 
a partial derivative specifying the rate of change of one boundary variable of iX  with 
respect to one element variable of e1X . The pose matrix 0
i A  given can be reformulated 
as 0 0
i i e1
e1A A A , where i e1A  is a matrix defining the pose of ( )e1xyz  with respect to 
( )ixyz . It is easily shown that i e1 X X  has the following general form: 
 59
0 (0, 20,0)
e1 Trans A  (4.18)  
1
4 4e1 A I   
2 ( ,135 )e1 Rot zA    
3 ( , 22.5 ) (0, ,0) ( , 90 )e1 e1Rot z Trans h Rot z A     
4 ( , 45 )e1 Rot z A    
5 8 (0, ,0) ( , 45 )e1 e1 e1Trans gap Rot z   A A    
6 ( ,180 ) ( 2, (22.5 ) (45 ),0)e1 e1 e1 e1Rot z Trans h g C gap C   A      
7 ( ,67.5 ) ( (22.5 ) (45 ), (22.5 ) (45 ),0)e1 e1 e1 e1 e1Rot z Trans g S gap S g C gap C  A +       
9 ( 2, (22.5 ) (45 ),0)e1 e1 e1 e1Trans h g C gap C   A    
In this simulation, the independent variables of the prism were specified as e1 1.5  , 
1air glue   , e1 30 mmg  , e1 21.976 mmh  and e1 1 mmgap  . Thus, from Eqs. (4.1) 
and (4.18), the element variables were formulated as 
  0 20 0 0 0 0 1 1.5 1 30 21.976 1 Te1  X . (4.19) 
In performing the simulations, the source ray  0 0 TP   entering the pechan prism was 
given as  2 0 0 0 1 0 Te1h , yielding source ray variables of 
 0 10.9835 0 0 0 90
T   X   . (4.20) 
 61
 
Fig. 4.9 Percent deviation of FD results relative to constant solution of 
10.988e1 e1zOPL     obtained using proposed method for various values of e1z . 
 
Table 4.1 Percent deviation of FD results relative to results obtained using proposed 
method for Xe1 e1OPL  . (units: radian for an angle and millimeter for else) 
  
 
Variables FD Our method Deviation( %) 
e1 e1xOPL t   0.000 0.000 0 % 
e1 e1yOPL t   -1.000 -1.000 0 % 
e1 e1zOPL t   0.000 0.000 0 % 
e1 e1xOPL    0.008 0.000   
e1 e1yOPL    0.000 0.000 0 % 
e1 e1zOPL    -10.980 -10.988 -0.072% 
e1 airOPL    20.000 20.000 0 % 
e1 e1OPL    104.429 104.429 0 % 
e1 glueOPL    1.000 1.000 0 % 
e1 e1OPL g   3.346 3.346 0 % 
e1 e1OPL h   2.561 2.561 0 % 
e1 e1OPL gap   1.000 1.000 0 % 
 
 63
 
Fig. 4.11 Cross-sectional diagram of a sniper scope [60] 
 
4.5 Summary 
This chapter has presented a computationally-efficient modeling approach for 
determining the gradient matrix of the optical path length (OPL) of a prism relative to all 
its independent variables. The proposed approach enables the OPL change induced by 
small changes in the multiple variables of the prism to be evaluated in a one-pass process 
rather than on a variable-by-variable basis as in the conventional FD method. Utilizing a 
Pechan prism for verification purposes, it has been shown that the proposed modeling 
method yields a substantial reduction in the computational time relative to that of the FD 
method. Moreover, the proposed method provides single geometrically exact numeric 
values for the gradient of the OPL relative to each of the independent variables, whereas 
the solutions obtained from the FD method depend upon the size of the denominator term. 
In conclusion, the simulation results show that the proposed mathematical model is not 
only faster than the conventional FD approach, but also more accurate. As a result, it 
 65
Chapter 5 
TOLERANCE ANALYSIS AND TOLERANCE 
ALLOCATION BASED ON OPTICAL PATH 
LENGTH GRADIENT MATRIX 
Many commercial optical design software packages have the ability to perform a 
tolerance analysis; however, the algorithms used for tolerancing may differ. FD and Monte 
Carlo are the two common algorithms for the tolerance analysis. While considering the 
tolerance allocation applications, the problem of allocating suitable tolerances to each of 
the independent variables in an optical system is highly challenging, and thus the existing 
literature focuses mainly on the tolerance analysis problem more than the tolerance 
allocation problem. Accordingly, a methodology based on the worst case approach is 
proposed for solving the tolerance analysis and tolerance allocation problems for optical 
systems in attempting to enhance the overall product quality and robustness. Regarding the 
comparison between existing methods and the developed methodology in this report, the 
proposed tolerance allocation method has more advantages [61].  
This chapter starts with the review of the gradient matrix concept presented in [4, 
14, 44, 45] and the demonstration of its use in analyzing the effects of changes in the 
independent variables of an optical system on the OPL and the exit ray, respectively. Two 
algorithms for solving the general tolerance allocation problem using a computer-aided 
scheme and for identifying the optimal tolerance allocation which minimizes the 
production cost of the optical system are then introduced respectively.  
 67
the order in which the rotation and translation matrices in Eq. (3.2) are applied is important 
since matrix multiplication is not a commutative operation. Significantly, this property also 
implies that the six pose parameters defined by Eq. (3.2) are unique for a given element in 
3D space. 
The independent variable vector ejX  of the j
th element includes the six unique pose 
parameters in Eq. (3.2), the refractive index of air air , the refractive index of the optical 
material of the element ej , and any other necessary dimensional variables (e.g. the width 
ejg , the angles e1 and e1 , and so on). That is, ejX  has the form 
 
T
ej ejx ejy ejz ejx ejy ejz air ej ej ej ejX t t t ω ω ω g γ ...      . (5.2) 
As mentioned above, the jth element in an optical system is a block of optical material, 
the relative pose of the ith boundary surface with respect to the corresponding element can 
be represented as ej iA  and obtained by referring to Eq.(3.2). The independent variable 
vector systemX of an optical system can be constructed by collecting all the variables within 
the vectors ejX ( j=0 to j=k) and then deleting those variables which appear more than 
once (e.g. air ), i.e. 
T0 0 0 0 0 0 0 0 0
system 0x 0y 0z 0 0 ejx ejy ejz ejx ejy ejz air ej ej ej ejX P P P t t t ω ω ω g γ ...       
1 2 3 system rm..... X ( )x x x x x    , (5.3) 
where rx  (r=1 to r= m is the total number of independent variables in the system) denotes 
any one variable within systemX . 
 69
 0 0 0e1 e1x e1yTrans( t , t ,0)A , (5.4) 
 e1 1 e1Rot(z, (90 ))  A  , (5.5) 
 e1 2 Rot(z, 90 )A -  , (5.6) 
 e1 3 e1 e1Trans(0,g ,0)Rot(z,90 - )A  . (5.7) 
The independent variable vectors of the prism (j=1) and the overall optical system are 
given respectively by 
T0 0 0 0 0 0
e1 e1x e1y e1z e1x e1y e1z air e1 e1 e1 e1X t t t ω ω ω g γ      . (5.8) 
system system r
T0 0 0 0 0 0 0 0 0
0x 0y 0z 0 0 e1x e1y e1z e1x e1y e1z air e1 e1 e1 e1
X X ( )
P P P t t t ω ω ω g γ
x
    

   
 (5.9)  
In addition, the positional and directional errors of the source ray are given by 
( 0 0 00x 0y 0zP ,  P ,  P   ) and ( 0 0,     ), respectively, while the differential change in the 
refractive index of air is given by air . Finally, the assembly errors of the source ray / 
prism system and the manufacturing errors of the prism are given by 
( 0 0 0 0 0 0e1x e1y e1z e1x e1y e1zt , t , t ,  ω ,  ω ,  ω      ) and ( e1 e1 e1 e1 e1,  g , h , γ ,       ), 
respectively.  
 
 
 
 
 71
5.1.2 Tolerance analysis based on change in OPL 
In geometrical optics, the optical path length (OPL) between two points i-1P  and iP  
is equal to the product of the geometric length i  between them and the refractive index 
i-1 . That is, i i-1 iOPL   . The total OPL of the ray traveling through the optical system 
(element) shown in Fig. 5.2 is given by 
 
i=3
system i 1 2 3
i=1
OPL OPL OPL OPL OPL    . (5.10) 
According to Table 5 in [28] (see Appendix E), the ideal values of the system variables for 
the dove prism considered in the present illustrative example are given by (see Table 5.1) 
 
T
systemX 0 0 0 0 90 7.5 50 0 0 0 0 1 1.701 87 65 65       . (5.11) 
 
Table 5.1: The ideal values of the system variables for the dove prism shown in Fig. 5.2. 
(units: radian for an angle and millimeter for else) 
 
variable e1xt  e1yt  e1zt  e1xω  e1yω e1zω air  e1  e1g  e1γ  e1
value 7.5 50 0 0 0 0 1 1.701 87  65  65
 
 
Utilizing a self-developed FORTRAN program, it can be shown that the change in the 
system OPL ( systemOPL ) induced by changes in the independent variables of the system 
( systemX ) (see Fig. 5.2) can be expressed as Eq.(5.12) (units: radian for an angle and 
millimeter for else) 
 73
in a number of ways, e.g. as a simple factor, or as a percentage of the ideal value (i.e. the 
maximum permissible deviation from the ideal value), or as an explicit range of 
permissible values. In applying the worst case method to the tolerance analysis problem, 
each variable rx  is assumed to possess its maximum permissible value, i.e. r limitx , and 
thus systemOPL also has its worst possible value. In practice, the tolerance value of a 
variable rx  can have any negative or positive value within the range r limitx  to r limitx . 
However, in applying the worst case method, if the leading sign of the sensitivity of any 
variable rx  is negative, the maximum negative value of the tolerance r limitx is applied, 
and vice versa. To demonstrate the applicability of Eq. (5.13) to the tolerance analysis of a 
shearing component, the worst possible changes e1 e1γ 0.35 arc sec    are taken from 
Table 5 of [28] ((see Appendix E)) and substituted into Eq. (5.13), yielding the following 
worst case value of systemOPL : 
systemOPL (21.381 14.519) (0.35/3600) ( /180) mm 0.061 m       . (5.14)  
Equation (5.14) shows that a dove prism with tolerances 
e1 e1γ 0.35 arc sec    exhibits a maximum change in OPL of 0.0962  when 
illuminated by a light source with a central wavelength of 633 nm. It is noted that this 
value is in good agreement with that of 0.095  reported in [28].  
5.1.3 Tolerance analysis based on change of exit ray 
The literature contains many different merit functions extracted from the exit rays of 
an optical system, including the root-mean-square radius of the focus spot and various 
combinations of the first order of the Seidel aberrations, point spread function, and so on. 
 75
keeping 0 e1xt = 7.5 mm ,
0
e1yt = 50 mm , and
0 0
e1x e1zω ω 0   , while varying 0 e1yω  from 0 
~ 360°. The sub-matrix, 0 3  , of Eq. (17) describes the image orientation change due to 
the changes of variables when a bunch of parallel rays exit the dove prism. The sensitivity 
0 0
3x e1zω 2      indicates that when the present dove prism is rotated through an 
angle of 0 e1zω , the image is inverted and rotated by 0 e1z2 ω . The image orientation after the 
ray exits the element is described by the sub-matrix in Eq. (5.15). 
Note that the sign of each variable change in Eqs. (5.12) and (5.15) has a specific 
physical meaning since each variable is referred to the world coordinate frame 0( )xyz . 
However, in solving tolerance analysis and tolerance allocation problems using the worst 
case method, these leading signs should be carefully considered since the allowable 
tolerance limits are not known in advance and can be either the maximum negative 
permissible limit r limitx  or the maximum positive permissible limit r limitx .  
In practice, the individual limits should be chosen in such a way that they can be 
easily attained and do not violate any other requirements. To solve the tolerance analysis 
and tolerance allocation problems using the gradient matrix approach, the signs of each 
rx  in the gradient matrix should be modified in accordance with the following two rules:  
(1) If the sign of the sensitivities of rx  are the same (either positive or negative) in Eqs.  
(5.12) and (5.15), the positive signs are retained while the negative signs are replaced 
by positive signs. (Note that this sign change is required since if the original sign is 
negative for rx , the lower allowable tolerance limit, r limitx , will result in the 
worst case. However, the present analysis considers the maximum upper allowable 
limit r limitx , and thus the positive sign must be used.)  
 77
for tolerance allocation schemes capable of assisting the designer in distributing the 
available tolerance budget amongst all the variables in the assembly in a systematic, 
feasible and cost-effective manner. In applying the worst case method to the tolerance 
allocation problem, each variable rx  is assumed to be at its maximum or minimum 
tolerance limit, i.e. r r limitx x   (where r limitx  is a positive number), such that the worst 
possible assembly tolerance is obtained. Mathematically, this can be expressed as follows: 
 
r=m
system
worst r limit
r=1 r
= x
x
      , (5.17) 
where system is a given merit function. system
r

x , which is the tolerance analysis using the 
gradient matrix approach [4, 14, 44, 45], represents the absolute value of the sensitivity of 
system . 
     This section of the chapter presents a methodology for establishing the tolerances 
r limitx  which ensure that the worst possible change in the merit function worst  of an 
optical system does not exceed the specified tolerance spec . As discussed in Section 5.1.3, 
it is possible that multiple merit functions, e.g. system system=OPL  or system system=rms  (the 
root-mean-square image spot size), need to be considered simultaneously in the tolerance 
allocation problem. When the OPL change is taken as the merit function, the constraint has 
the form 
 
 2r=m
system2 2 2
1 worst spec r limit spec
r=1 r
OPLψ = ( OPL ) ( OPL ) = ( OPL ) 0x
x
           . (5.18a) 
 79
5.2.1 Computer-aided tolerance allocation scheme 
It will be recalled that an optical system has m  independent variables. For simplicity, 
assume that all of the tolerances, r limitx (r=1,2,3,…, m ), are expressed in terms of a 
single effective tolerance ex  and m  different weighting factors r  [64], i.e. 
r limit r e x x   , ( r 1, 2,3....m ). (5.19) 
Equation (5.19) represents each tolerance r limitx  as a product of a positive weighting 
factor r  and a common factor ex , and therefore reduces the m  unknown tolerances 
to one unknown only, i.e. ex . The weighting factor, r , can be specified in a number of 
ways. However, the effective tolerance, ex , must be determined by the pre-defined 
constraint(s). In literature [65], it was proposed that the user simply specify a set of 
arbitrary values for the weighting factor r . However, in this report, the weighing factors 
are assigned in accordance with the results of the OPL [45] or exit ray [4] gradient matrix 
and a proportionality constant rf . Specifically, r  is defined as being inversely 
proportional to the absolute value of the system sensitivity to variable rx , i.e. system rx  , 
where system rx   is the sensitivity coefficient obtained from the gradient matrix given 
in Eq. (5.12) or Eq. (5.15). In other words, r  is defined as  
 
r
system r
system rr
system r
f 0
0
x
x
x

          
. (5.20) 
 81
Equation (5.23) indicates that the smallest value obtained from Eqs. (5.22a), (5.22b) and 
(5.22c) should be taken as the required tolerance r limitx  for variable rx . 
Table 5.2 indicates the tolerance allocation results for the dove prism system shown in 
Fig. 5.2 when using the constraint defined in Eq. (5.18a) and assigning the proportionality 
constant as rf 1  and the effective tolerance as e =0.0304585 mx  . As shown, the 
tolerances of e1γ  and e1  are e1γ 0.293 arc sec   and e1 0.432 arc sec  , 
respectively, for a specified OPL tolerance of specOPL 0.0962   (at 633 nm 
wavelength). It is noted that these results are different from those reported in [28]. It is 
obvious that the more sensitive the variable change, the less effect it will have on  
systemOPL  during tolerance allocation in the proposed approach. Therefore, the proposed 
approach provides a reasonable means of obtaining the allowable tolerance limits. 
 
Table 5.2: Tolerances for the dove prism. 
method r variable rf  ex  system rOPL x   r limitx  
1 e1γ  1 0.030 m  21.381 m  e 1γ e 1γ e1γ e1γ =0.293 arc secComputer-ai
ded tolerance 
allocation 2 e1
  1 0.030 m  14.519 m  e1=0.432 arc sec
1 e1γ   21.381 m  e 1γ e 1γ e1γ e1γ =0.329 arc secOptimal 
tolerance 
allocation 2 e1
   14.519 m  e1=0.377 arc sec
1 e1γ   e 1γ e 1γ e1γ e1γ =0.35 arc secHerrera and 
Strojnik, [6] 2 e1   e1=0.35 arc sec  
 
 
 
 
 83
  2 2 21worst spec1ψ = ( OPL ) ( OPL ) ( ) 0s     , (5.25a) 
  2 2 22worst spec2ψ = ( rms ) ( rms ) ( ) 0s     , (5.25b) 
  2 2 23worst spec3ψ = ( ) ( ) ( ) 0s     , (5.25c) 
where 1 2,  s s   and 3s  are all real-valued variables. If 1 0s  , Eq. (5.25a) implies that 
1ψ 0  and 1 0s  , Eq. (5.25a) implies that 1ψ 0 , and so on. The Lagrangian function 
of the Lagrange multiplier method for optimization can be expressed as 
 
 2 2 2
1 2 3 1 2 3 1 1r limit worst spec
2 2 2 2 2 2
2 2 3 3worst spec worst spec
L( , , , , , , ) = $ + ( OPL ) ( OPL ) ( )
+ ( rms ) ( rms ) ( ) + ( ) ( ) ( )
x s s s s
s s
   
 
      
             
       
    , (5.26) 
where variable i (i 1 ~ 3)   called the Lagrange multiplier. Note that the above 
Lagrangian function satisfies the following stationary conditions:  
   
31 2
1 2 3
r limit r limit r limit r limit r limit
ψψ ψL $= + + 0
x x x x x
           
   ,        r=1,2,…, m  (5.27)  

2 2 2
1worst spec
1
L = ( OPL ) ( OPL ) ( ) 0s
     
 , (5.28a)  

2 2 2
2worst spec
2
L = ( rms ) ( rms ) ( ) 0s
     
 , (5.28b)  

2 2 2
3worst spec
3
L = ( ) ( ) ( ) 0s
     
 , (5.28c)  
 85
its two base angles, the following nonlinear equations can be obtained from this approach 
while 1 2 1 2 1u u v v     used for estimate the cost function $  (see Eq.(5.24)). 
1
1 1 2 2
1 limit 1 limit
1= + =1+
( ) ( )
vc u
x x   , 
2
2 2 2 2
2 limit 2 limit
1= + 1+
( ) ( )
vc u
x x
     
1 1 limit 2 limit3
1 limit
2 21.381069339 (21.381069339 14.519246543 ) 0
( )
x x
x
      
    
1 1 limit 2 limit3
2 limit
2 14.519246543 (21.381069339 14.519246543 ) 0
( )
x x
x
      
 ,   
 2 3 2 2
11 limit 2 limit1ψ = (21.381069339 14.519246543 ) (0.0608946 10 ) ( ) 0x x s          
1 12 s 0   ,   
2
1 1 limit1g 0t x   ,   
2
2 2 limit2g 0t x   .   
Solving these equation simultaneously, the upper allowable tolerance limits for the 
dove prism are found to be e1 2 limit 0.377arc secx     and 
e1 1 limitγ 0.329arc secx    . Comparing these values with those obtained using the 
computer-aided tolerance allocation method (see Table 5.2), it is found that provided an 
appropriate cost function $  is chosen, the optimal tolerance allocation method provides a 
reasonable means of obtaining the allowable tolerance limits.  
 
 87
Chapter 6 
CONCLUSIONS AND FUTURE WORK 
In this report, the study of OPL gradient matrices modeling, the tolerance analysis, 
and the tolerance allocation are accomplished. This chapter concludes the contributions of 
this study and provides several interesting topics for future works. 
6.1 Conclusions 
By reviewing the whole study presented in this report, the contributions are 
concluded as follows: 
1. The literature those are relevant to the OPL calculation, OPL sensitivity analysis, and 
the tolerance problems are surveyed in detail. 
2. This report has presented a computationally-efficient modeling approach for evaluating 
the gradient matrix of the OPL of an optical system and a prism relative to their all 
design variables, respectively. The leading coefficient, which represents the weight by 
which each parameter change contributes to the overall change in the OPL of the 
system, indicates the sensitivity of the corresponding parameter. 
3. The proposed approach enables the OPL change induced by small changes in the 
multiple variables of an optical system comprising lenses and prisms to be evaluated in 
a one-pass process rather than on a variable-by-variable basis as in the conventional FD 
method. Moreover, the proposed method provides single geometrically exact numeric 
values for the gradient of the OPL relative to each of the independent variables, 
 89
In conclusion, the simulation results show that the proposed mathematical model is 
not only faster than the conventional FD approach, but also more accurate. As a result, it 
provides an ideal solution for evaluating the OPL changes caused by changes in the 
multiple independent variables of an optical system comprising lenses and prisms during 
the early design stages of its design process. Moreover, the results also confirm that the 
proposed tolerance analysis and tolerance allocation methods are suitable tools for the 
initial design stage of general optical systems. 
 
 
 
 
 
 
 
 
 
 
 
 91
Appendix B 
(a) For a spherical boundary surface 
  2 1/ 21 1 1 1 1( ) ( )i i x i i x i i x i x ix ix iy iy iz iz i iOPL P D P t I t I t I D E                  (B1) 
  2 1/ 21 1 1 1 1( ) ( )i i y i i y i i y i y ix ix iy iy iz iz i iOPL P D P t J t J t J D E                  (B2) 
  2 1/ 21 1 1 1 1( 2 ) ( )i i z i i z i i z i z ix ix iy iy iz iz i iOPL P D P t K t K t K D E                 (B3) 


1 1 1
2 1/ 2
1
( )
                                ( ) ( )
i i x i ix ix iy iy iz iz i x
i ix ix iy iy iz iz i x i i
OPL t I t I t I P
D t I t I t I P D E
  

      
      

 (B4) 


1 1 1
2 1/ 2
1
( )
                               ( ) ( )
i i y i ix ix iy iy iz iz i y
i ix ix iy iy iz iz i y i i
OPL t J t J t J P
D t J t J t J P D E
  

      
      

 (B5) 


1 1 1
2 1/ 2
1
( )
                                ( ) ( )
i i z i ix ix iy iy iz iz i z
i ix ix iy iy iz iz i z i i
OPL t K t K t K P
D t K t K t K P D E
  

      
      

 (B6) 
where iD  and iE  are given in Chapter 2. 
(b) For a flat boundary surface 
1 1 -1 -1 -1( )i i x i iy iy i x iy i y iy i zOPL P I I J K          (B7) 
1 1 -1 -1 -1( )i i y i iy iy i x iy i y iy i zOPL P J I J K          (B8) 
1 1 -1 -1 -1( )i i z i iy iy i x iy i y iy i zOPL P K I J K          (B9) 
2
1 1 1 1 1 -1 -1 -1( ) ( )i i x i iy iy i x iy i y iy i z iy iy i x iy i y iy i zOPL I I P J P K P t I J K                (B10) 
2
1 1 1 1 1 -1 -1 -1( ) ( )i i y i iy iy i x iy i y iy i z iy iy i x iy i y iy i zOPL J I P J P K P t I J K                (B11) 
2
1 1 1 1 1 -1 -1 -1( ) ( )i i z i iy iy i x iy i y iy i z iy iy i x iy i y iy i zOPL K I P J P K P t I J K                (B12) 
 93
     
   
1 1 1 1 1 1
1
1 1
1(
i iz
ix iy ix iz i x i y iy iz i x iz i y iy ix iz i x iz i y
i
iz iy iz iy ix iz i x iy iz iy ix iz i y
ix iy ix iz i x
i
OPL
t S S C C S C t C C S
t S S C S C S C C S S
t S S C
D

                  
  
     

 

  
                        

     
 
   
   
 
1 1 1 1 1 2 1/ 2
1 1
1 1 1
) ( )
( )
    
i y iy iz i x iz i y iy ix iz i x iz i y
i i
iz iy iz iy ix iz i x iy iz iy ix iz i y
ix iy ix iz i x i y iy iz i x iz
C S C t C C S
D E
t S S C S C S C C S S
t S S C P P C S P C
     
         
     
    
 
  
                     
  
    
 

   
   
1 1 1 2 1/ 2
1 1
( )
                                                                         
i y iy ix iz i x iz i y
i i
iz iy iz iy ix iz i x iy iz iy ix iz i y
P t C C P S P
D E
t S S C S C P S C C S S P
  
         
  
 
                      
                                                                                         (C6)
2 1 2
1 ( )i i i i iOPL D D E                               (C7) 
0i iOPL                                (C8) 
2 1 2
1 ( )i i i i i iOPL R R D E                                  (C9) 
, where iD  and iE  are given in Chapter 2. 
(b) For a flat boundary surface 
 1 -1 -1 -11 ( )i iy i iy i x iy i y iy i zOPL t I J K                                     (C10) 
   

1 1 1 1 1 1 1 1 1
2
1 1 1 -1 -1 -1                   ( ) ( )            (C11)
i ix i iz i z i x i x i z iz i z i y i y i z
ix iz i x iz i y ix i z iy iy i x iy i y iy i z
OPL S P P C P P
S S C C t I J K
   
   
        
  
       
      
   
     
 

2
1 1 1 1 1 1 1 1
2
1 1 1 1 1 -1 -1 -1
( )
( ) ( ) ( )
                        
i iz i ix i y i x i x i y ix ix i z iz i x iz i y
ix ix iz i y iz i x i z ix iz i x iz i y iy iy i x iy i y iy i z
OPL C P P C S C P S P
C S S C P C C S t I J K
      
      
       
    
       
       
  
      
                                                                                                                          (C12)
 1 -1 -1 -1 -1 -1 -1( )                              (C13)i i iy i x iy i y iy i z iy iy i x iy i y iy i zOPL I P J P K P t I J K           
0                                     (C14)i ix i iz i iy i i i iOPL t OPL t OPL OPL OPL R               
                            
 95
The entries 2,9c , 2,10c  and 2,11c  in matrix 2 j ej X X  in Eq. (3.17) are given in the 
following defined in accordance with nine possible lens types: 
(1) 2 2 1ej j ej jd R q R     for lenses in which i=2j-1 and i=2j are both convex spherical 
boundary surfaces (Fig. 4 of [78]); 2,9 2,10 2,11 1c c c    . 
(2) 2 2 1ej j ej jd R q R      for lenses in which i=2j-1 and i=2j are convex and concave 
spherical boundary surfaces, respectively, (Fig. 5 of [78]); 2,9 2,10 2,11 1c c c     . 
(3) 2 1ej ej jd q R     for lenses in which i=2j-1 and i=2j are convex and flat boundary 
surfaces, respectively, (Fig. 6 of [78]); 2,9 2,11 1c c   and 2,10 0c  .  
(4) 2 2 1ej j ej jd R q R     for lenses in which i=2j-1 and i=2j are concave and convex 
spherical boundary surfaces, respectively, (Fig. 7 of [78]); 2,9 2,10 2,11 1c c c     .  
(5) 2 2 1ej j ej jd R q R      for lenses in which i=2j-1 and i=2j are both concave spherical 
boundary surfaces (Fig. 8 of [78]); 2,9 2,10 2,11 1c c c      .  
(6) 2 1ej ej jd q R     for lenses in which i=2j-1 and i=2j are concave and flat boundary 
surfaces, respectively, (Fig. 9 of [78]); 2,9 2,11 1c c    and 2,10 0c  .  
(7) 2ej j ejd R q   for lenses in which i=2j-1 and i=2j are flat and convex spherical 
boundary surfaces, respectively, (Fig. 10 of [78]); 2,9 0c   and 2,10 2,11 1c c   .  
 97
Appendix E 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 99
9. G. Klemens and Y. Fainman, “Optimization-based calculation of optical nonlinear 
processes in a micro-resonator,” Opt. Exp. 14, 1494-1505 (1968). 
10. S. J. Dobson and A. Cox, “Fast image-quality-based optimization of optical systems,” 
Appl. Opt. 37, 8008-8011 (1998). 
11. C. J. Progler and D. M. Byrne, “Merit Functions for Lithographic Lens Design,” J. 
Vac. Sci. Technol. B 14, 3714-3718 (1996). 
12. A. Yabe, “Optimal selection of aspherical surfaces in optical design,” Opt. Exp. 13, 
7233-7242 (2005). 
13. S. Barbero and S. Marcos, “Analytic tools for customized design of monofocal 
intraocular lenses,” Opt. Exp. 15, 8576-8591 (2007). 
14. C. C. Hsueh and P. D. Lin, “Computationally-efficient gradient matrix of optical path 
length in axisymmetric optical systems,” Appl. Opt. 48, 893-902 (2009). 
15. http://en.wikipedia.org/wiki/Single-lens_reflex_camera (June, 2011) 
16. http://en.wikipedia.org/wiki/Binoculars (June, 2011) 
17. http://en.wikipedia.org/wiki/Monocular (June, 2011) 
18. E. J. Galvez and C. D. Holmes, “Geometric phase of optical rotators,” J. Opt. Soc. Am 
A 16, 1981-1985 (1999). 
19. W. Mao, “Adjustment of reflecting prisms,” Opt. Eng. 34, 79-82 (1995). 
 101
29. D. A. Flickinger, R. N. Coffee, G. N. Gibson, and T. C. Weinacht, “Bichromatic, 
phase compensating interferometer based on prism pair compressors,” Appl. Opt. 45, 
6187-6191 (2006). 
30. G. Garcia-Torales, G. Paez, and M. Strojnik, “Simulations and experimental results 
with a vectorial shearing interferometer,” Opt. Eng. 40, 767-773 (2001). 
31. Donald L. Sullivan, "Alignment of Rotational Prisms," Appl. Opt. 11, 2028-2032 
(1972). 
32. A. N. de Oliveira, S. P. Walborn and C H Monken, “Implementing the Deutsch 
algorithm with polarization and transverse spatial modes,” J. Opt. B: Quantum 
Semiclass. Opt. 7, 288–292 (2005). 
33. J. Leach, M. J. Padgett, S. M. Barnett, S. Franke-Arnold, and J. Courtial, “Measuring 
the Orbital Angular Momentum of a Single Photon,” Phys. Rev. Lett. 88, 257901 
(2002). 
34. R. Zambrini and S. M. Barnett, “Quasi-Intrinsic Angular Momentum and the 
Measurement of Its Spectrum,”Phys. Rev. Lett. 96, 113901 (2006). 
35. N. Gonzalez, G. Molina-Terriza, and J. P. Torres, “How a Dove prism transforms 
the orbital angular momentum of a light beam,＂ Opt. Exp. 14, 9093-9102 (2006). 
36. S. K. Gupta and R. Hradaynath, “Angular tolerance on Dove prisms,” Appl. Opt. 22, 
3146-3147 (1983). 
 103
46. D. F. Feder, “Differentiation of ray-tracing equations with respect to construction 
parameters of rotationally symmetric optics, ” J. Opt. Soc. Am. 58, 1494-1505 (1968). 
47. Lin Psang Dain and Te-Tan Liao, “Skew-Ray Tracing and Sensitivity Analysis of 
Geometrical Optics, ” Transactions of the ASME Journal of Manufacturing Science 
and Engineering 122, 338-349 (2000). 
48. W. J. Smith, Modern Optical Engineering (3rd ed., Edmund Industrial Optics, 
Barrington, N.J., 2001). 
49. E. Hecht, Optics (3rd edition, Addison Wesley Longman, Inc., New York, 1998). 
50. M. LAIKIN, LENS DESIGN  (Marcel Dekker, 1995), Chapter 5, page72. 
51. F. A. Jenkins, H. E. White, Fundamentals of Optics (4rd ed., WcGraw-Hill, 1981). 
52. M. Atsushi and S. Nobuo, “Design of a Four-element, Hollow-cube Corner 
Retroreflector for Satellities by Use of a Genetic Algorithm,” Appl. Opt. 37, 438-442 
(1998). 
53. N. Shojiro and K. Jun, “Retroreflector Using Gradient-index Rods,” Appl. Opt. 30, 
815-822 (1991). 
54. L. Z. James, “Cube Corner Retroreflector Test and Analysis,” Appl. Opt., 15, 445-452 
(1976). 
 105
64. P. D. Lin and K. F. Ehmann, "Inverse Error Analysis for Multi-axis Machines," ASME 
Journal of Engineering for Industry 118, pp.88-94 (1996). 
65. B. Benhabib, R. G. Fenton, and A. A. Goldenberg, " Computer-Aided Joint Error 
Analysis of Robots," IEEE Journal of Robotics and Automation RA-3, 317-322 
(1987). 
66. M. F. Spotts, "Allocation of Tolerances to Minimize Cost of Assembly," ASME J. 
Engng Ind, 95, 762-764 (1973). 
67. K. W. Chase, and W. H. Greenwood, "Computer-Aided Tolerance Selection," CATS 
User guide. ADCATS Report No.86-2, Brigham Young University (1986). 
68. F. H. Speckhart, "Calculation of Tolerance Based on a Minimum Cost Approach," 
ASME J. Enging. Ind , Vol.94, No.2,pp. 447-453 (1972). 
69. M. P. Kothiyal and C. Delisle, “Shearing interferometer for phase shifting 
interferometry with polarization phase shifter,” Appl. Opt. 24, 4439-4442 (1985). 
70. H. Kadono, N. Takai, and T. Asakura, “New common-path phase shifting 
interferometer using a polarization technique,” Appl. Opt. 26, 898-904 (1987). 
71. H. Schreiber and J. Schwider, “Lateral shearing interferometer based on two Ronchi 
phase gratings in series,” Appl. Opt. 36, 5321-5324 (1997). 
 107
 
國科會補助專題研究計畫成果報告自評表 
請就研究內容與原計畫相符程度、達成預期目標情況、研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）、是否適
合在學術期刊發表或申請專利、主要發現或其他有關價值等，作一綜合評估。
1. 請就研究內容與原計畫相符程度、達成預期目標情況作一綜合評估 
□V 達成目標 
□ 未達成目標（請說明，以 100 字為限） 
□ 實驗失敗 
□ 因故實驗中斷 
□ 其他原因 
說明： 
 
2. 研究成果在學術期刊發表或申請專利等情形： 
論文：□V 已發表 □未發表之文稿 □撰寫中 □無 
專利：□已獲得 □申請中 □無 
技轉：□已技轉 □洽談中 □無 
其他：（以 100 字為限） 
 
本研究成果已有 8篇英文論文(見 108 頁)，已登出於國際期刊，且都有用本計畫的編號作致
謝辭。 
 
 
3.請依學術成就、技術創新、社會影響等方面，評估研究成果之學術或
應用價值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可
能性）（以 500 字為限） 
 
傳統的幾何光學都用向量方法推導光線追蹤方程式，向量方法只能考率
位置變化，無法處理座標系的轉換，因此對非軸對稱光學系統的建模甚
困難。吾人以齊次座標法，建構一種新的歪斜光線追蹤方法，將光學系
統的數學模型以矩陣形式表現，不但可以應用於軸對稱光學系統，也可
應用於非軸對稱光學系統中，使得幾何光學的研究能更深入更有效。本
附件二 
 109
subject category： 
Optics 
年度 
2011 
Ranking: 
25/77=32.46 ％ 
Impact factor: 
1.748 
7. Psang Dain Lin and Chung-Yu Tsai, “Determination of First-Order Derivatives of 
Skew-Ray at Aspherical Surface,” Journal of the Optical Society of America A, Vol. 
29, No.6, PP.1141-1153, 2012 (6 月 SCI, EI) (NSC 99-2221-E-006-023-MY2)  
subject category： 
Optics 
年度 
2011 
Ranking: 
30/77=38.96 ％ 
Impact factor: 
1.562 
8. Yu-Bin Chen and Psang Dain Lin “Second-order Derivatives of Optical Path Length of 
Ray with Respect to Variable Vector of Source ray,” Applied Optics, Vol. 51, No. 22, 
PP.5552-5562, August 2012. (SCI, EI) (NSC 99-2221-E-006-023-MY2)  
subject category： 
Optics 
年度 
2011 
Ranking: 
25/77=32.46 ％ 
Impact factor: 
1.748 
 
 
99年度專題研究計畫研究成果彙整表 
計畫主持人：林昌進 計畫編號：99-2221-E-006-023-MY2 
計畫名稱：使用光程差在光學系統的靈敏度分析與裕度分配 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 1 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 2 0 100%  
博士生 1 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 8 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
