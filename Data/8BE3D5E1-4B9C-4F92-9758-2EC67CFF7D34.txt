 1
???????????????????? 
????????????????????????? 
Higher Order Finite Difference Modal Analysis for Isotropic 
and Non-isotropic Material 
?????NSC 95?2221?E?005?127? 
?????95? 8? 1??  96? 7? 31? 
?????????  ?????? ?????? 
 
?????? 
????????????????
?????????????????
???????????????????
???????????????????
??????????????????
???????????????????
??????????????????
???????????????????
??????????????????
???????????????????
??????????????????
???????????2002?IEEE/OSA 
Journal of Lightwave technology?????
??????????????????
2007?IEEE MTT-S??????? 
????????????????
??????????????????
???????????????????
??????????????????
???????????????????
???????????????????
??????????????????
???????????????????
???????????????????
???????????????????
???????????????????
???????????????????
??????? 
 
???? 
This project is going to derive higher 
order finite difference modal analysis method 
and extend valid formula for more materials 
with non-isotropic dielectric constant. ?Note: 
The formula for non-isotropic material is 
originally assigned as the task of the second 
year, but this project was only passed for one 
year’s budget. Thus we just finished the 
high-order formulas for isotropic materials.? 
To overcome the precision limitation using 
gradual-index approximation, we have 
provided a new scheme for dealing with 
step-index interfaces: by properly matching 
boundary conditions, we can obtain a new set 
of finite difference formula. The scheme 
dealing with transverse fields has been 
published in IEEE/OSA Journal of Lightwave 
technology, 2002. And the vertical field 
formula have been presented in 2007 IEEE 
MTT-S International Microwave Symposium. 
Compared with those traditional gradual- 
index formulas with 0–order to 1st–order 
precision, our previous works are of 
2nd–order precision with uniform meshes. But 
we may need to use non-uniform meshes in 
some cases, such as corner problems, our 
formula will have only 1st-order precision. 
Thus we still have large number of meshes, 
and higher order schemes will be needed. In 
this project, we have obtained the higher order 
schemes in the first year of this project, and 
we have applied the high-order formulas in 
the calculation of band diagrams of photonic 
crystals. We have verified the accuracy and 
efficiency of the high-order scheme. 
 
???????????????????
?? 
 
Keywords ? finite difference method, 
step-index interface, photonic crystal 
 
 3
???????????????????
???????????????????
???????????????????
???????????????????
????????????????
(Weekly guided)????????????
??(Strongly guided)?????????
??????????????? 
 
????????????????????φ ?
?????????? 
?????????????????
??????(m,n)??????????
???????????????????
???????????????????
??????????????????
???????????????????
???????????(m,n)?????
???????????????????
????????????????
(m+1,n+1)??????? 
????????????????
(m+1,n+1)?????????φ|R? 
???????????????????
????? rˆ?θˆ??????? 
???????????????????
??????????????φ|L ? rˆ −θˆ
?????????? 
???????????????????
? xˆ − yˆ??? 
???????????????????
?????(m,n)????????????
??????????? 
?????????????????
????(m,n)?????????????
??????????? 
DM ⋅=Φ  
??Φ?????????????
????D????(m,n)????????
?????????? M???????
???????????????????
????????????????
Φ⋅= −1MD ?????????????
????????? 
????????????????
????????????(a)?????
???????????????????
???????????????????
???????????????????
???????????????????
?(b)? 9 ??????????????
???????????????????
??????????? 
 
    (a)         (b)              (c) 
???????????????(?????)?
(a)?? 5 ????(b)?? 9 ????(c)?? 21
???? 
????????????????
??????(b)? 9 ?????????
?????????(c)? 21 ?????
???????????????????
???????????????????
?????????????????
???????????????????
???????????????????
??????????????????
???????????????????
???????????????????
???????????????????
???????????????????
)1 ,1( ++ nmφ)1 ,( +nmφ)1 ,1( +− nmφ
) ,1( nm+φ) ,( nmφ) ,1( nm−φ
)1 ,1( −+ nmφ)1 ,( −nm
φ
)1 ,1( −− nmφ θ
θˆ rˆ
xˆ
yˆ
R
φ
L
φ
Rx∆
Ry∆
Ly∆
Lx∆
R
O′
Lε
Rε
 5
????????????????
???????????????????
???????????????????
???????????????????
????? 
PBC1? ( ) ( ) ( )yxajkayx y ,exp, φφ −=+  
PBC2? ( ) ( ) ( )yxajkyax x ,exp, φφ −=+  
?????????????????
?????????????? εr = 8.9 ?
???? r = 0.2a??? a???????
(?????)???(a)?(b)??????
???????????????????
???????????(???????
??128X128 ??)??????????
????????(40X40 = 1600 ???
?)????????????? 
 
       
0
0.2
0.4
0.6
0.8
1
N
or
m
al
iz
ed
 fr
eq
ue
nc
y 
(ω a
/2
π c
)
this method
PWE method 
TE mode 
 
0
0.2
0.4
0.6
0.8
1
N
or
m
al
iz
ed
 fr
eq
ue
nc
y 
(ω a
/2
π c
)
this method
PWE method 
TM mode 
 
????????????????????(a)TE
???(b)TM??? 
?????????????????
???????????????????
????? Huang Yu David Yang ???
IEEE-MTT ? ? ? (pp. 2688—2695 ?
1996)????????(a)?(d)?????
???????????????????
??????????????????
???????????????????
??????????????????
???????????????????
????????????? Yang???
??????????????????
???????????????????
???????????????????
?? 500???????????????
??????????????? 1%?
????????????? 225????
??(15X15)???????????
0.25%????????????????
??????????????? 
0 500 1000 1500 2000 2500
-8
-6
-4
-2
0
2
4
6
8
Number of grid points
R
el
at
iv
e 
er
ro
r (
%
)
TE first band 
method of [8] 
this work 2nd order
this work 4th order
 
    (a) 
0 500 1000 1500 2000 2500
-6
-4
-2
0
2
4
Number of grid points
R
el
at
iv
e 
er
ro
r (
%
)
TM first band 
method of [8] 
this work 2nd order
this work 4th order
 
    (b) 
Γ            X            M          Γ    
Γ            X            M           Γ    
     M    
Γ    X    
(a)
(b)
Yang 
Yang 
???????????? 
                                                             
???? NSC 95-2221-E-005-127 
???? ????????????????????????? 
?????? 
??????? 
??? 
?????? ?????? ???? 
?????? 
96.06.03?96.06.08 
??????????(????)?????? 
???? (??) 2007? IEEE MTT-S ??????(IMS2007) 
(??) 2007 IEEE MTT-S International Microwave Symposium 
?????? 
(??)?????????????????????? 
(??) Improved Finite-Difference Frequency-Domain Scheme for the Analysis 
of 2-D Photonic Crystals 
 
???????? 
96/06/03 14:30???????? CI0002??????? 
96/06/03 05:55(???????)??????????????? shuttle bus?????? 
? 
        09:00??????????????????????????????????
????????????????????????????????????
?????????????????????? 
96/06/04 ?????????????????????????(Waikiki)???????
??????????????????????? 
????????????????(?? IMS2007?RFIC? ARFTG???)? 
96/06/05 10:10?11:50?? Plenary Session?????????????????? IEEE?
??? Fellow ???????????? QualComm ?????????? Anil 
Kripalani ????????????????????????? Ryuji Kohno ?
???????????????????????? 
????? IMS TU3A?power amplifier?RFIC RTU4C??????????RFIC
???????????? 
96/06/06 ???? IMS WE1C?WE2C??? RF MEMS????WEP1? Interactive Forum 
??????WE3D?WE4D?????????????????WEP2? Inter- 
active Forum 
96/06/07 ??????????? TH1P Interactive Forum???????????????
??????? 
?????? TH3A? TH4B????????????? 
96/06/08 ??? 6:40 check out?????? shuttle bus??????????? CI0017?
????????????????????????? 
 Improved Finite-Difference Frequency-Domain Scheme for the 
Analysis of 2-D Photonic Crystals 
Yen-Chung Chiang1, Yih-Peng Chiou2, and Hung-Chun Chang2,3 
1Department of Electrical Engineering, National Chung-Hsing University, 402, Taichung, Taiwan 
2Department of Electrical Engineering and Graduate Institute of Electro-Optical Engineering, National 
Taiwan University, 106, Taipei, Taiwan 
3Graduate Institute of Communication Engineering, National Taiwan University, 106, Taipei, Taiwan 
 
Abstract  —  An improved finite-difference frequency-domain 
approach was developed for the analysis of two-dimensional 
photonic crystals. This newly proposed finite-difference scheme 
can deal with piecewise homogenous structures with slanted 
interfaces, thus provide the capability to analyze the structures 
with arbitrary shapes. We utilized this scheme to calculate the 
band diagrams of 2-D photonic crystals with the square lattice. 
Only one unit cell area need be calculated with proper periodical 
boundary conditions. We also demonstrated the convergence 
behavior to verify the efficiency of adopting the improved scheme. 
Index Terms — Electromagnetic propagation, finite difference 
methods, frequency domain analysis, photonic crystals, step-
index waveguides. 
I. INTRODUCTION 
The mechanism of a conventional dielectric waveguide is to 
confine the fields within a region bounded by the interfaces 
between high and low refractive indices. The photonic crystals 
(PCs) provide another mechanism for guiding microwave or 
optical waves. Since there are photonic band gaps in which 
wave propagation is forbidden at some frequency ranges, we 
may then guide waves by introducing defects between 
properly designed periodic structures. Thus the calculation of 
the band structures is a fundamental task for analyzing the PCs. 
Many numerical methods have been proposed for this purpose. 
Among these the most commonly used are the plane-wave 
expansion (PWE) method [1] and the finite-difference time-
domain (FDTD) method [2]. 
The finite-difference frequency-domain method was also 
proposed for calculating the band structures of 2-D PCs [3]. 
Due to the simplicity of its implementation and the sparsity of 
its resultant matrix, this method becomes an efficient and 
attractive one for analyzing the band structure of 2-D PCs. 
But the original finite-difference schemes provided in [3] 
only fits such structures whose interfaces are parallel to the 
axes. For the structures with linearly slanted or curved 
interfaces, the calculated result will converge very slowly by 
using the formula in [3]. Some modified finite difference 
schemes were proposed by introducing the staircase or the 
graded-index [4] approximations. They can be used to some 
degree of accuracy in the weakly guiding structures, but these 
approximations cannot properly treat such structures with high 
contrast step-index interfaces which are common in PCs. 
To overcome the difficulty of adopting finite-difference 
method in those structures with slanted interfaces, we have 
developed a systematic procedure for deriving a suitable finite 
difference scheme. As indicated in [3], the formulas for 
analyzing the photonic crystals can be categorized into two 
sets: (a) out-of-plane propagation, (b) in-plane propagation. 
We have proposed our formulas for out-of-plane propagation 
in [5], and the formulas for in-plane propagation will be given 
in the following section. 
II. FORMULATION 
The cross-section of a 2-D photonic crystal consisting of 
cylindrical dielectric rods is shown in Fig. 1 for the square 
lattice case, where a is the lattice distance, and r is the radius 
of the dielectric rods. When we calculate the band structures 
of the 2-D PCs, we may apply the periodic boundary 
conditions, 
                    ( ) ( ) ( ),,exp, yxajkyax x Φ−=+Φ               (1) 
                   ( ) ( ) ( ),,exp, yxajkayx y Φ−=+Φ               (2) 
and we only need to calculate the problem over a unit cell area 
(the area surrounded by dashed lines in Fig. 1).  
 
 
 
Fig. 1. The cross-sectional view of a 2-D photonic crystal. 
 
As indicated in [3], the final equation in matrix form that we 
need to solve is as following, 
a
r
 3
                                 
L
z
R
z
t
E
t
E
2
2
2
2
∂
∂=∂
∂                           (14) 
Similarly, the equations for the TE modes (φ = Hz) are given 
as the following. 
 
                                     
LzRz
HH =                              (15) 
                                
L
z
L
R
R
z
n
H
n
H
∂
∂=∂
∂
ε
ε                          (16) 
                                  
L
z
R
z
t
H
t
H
∂
∂=∂
∂                            (17) 
                  
LzRL
L
z
R
z Hk
n
H
n
H )(202
2
2
2
εε −+∂
∂=∂
∂            (18) 
                              
L
z
L
R
R
z
tn
H
tn
H
∂∂
∂=∂∂
∂ 22
ε
ε                        (19) 
                                 
L
z
R
z
t
H
t
H
2
2
2
2
∂
∂=∂
∂                        (20) 
 
For a linear slanted interface, the only error in our 
derivation of finite-difference formula is the truncation of 
higher order derivatives. 
III. NUMERICAL RESULTS 
We consider the 2-D PC with the cross section as shown in 
the middle inset of Fig. 3, formed by parallel alumina rods in 
the air. The relative permittivity of the alumina is εAl = 8.9 and 
that of the air is εair = 1. The radius of the alumina rod is r = 
0.2a, where a is the lattice distance. Each point along the 
boundary of the first Brillouin zone shown as the right inset in 
Fig. 3 determines the values of kx and ky we use in (1) and (2), 
and thus in (3). 
The calculated band diagrams of the TE and TM modes are 
plotted in Figs. 3 and 4. The band structures marked with red 
circles are the results obtained using our improved finite-
difference scheme with 30 x 30 grid points, and the solid blue 
lines are the results obtained using the MIT Photonic-Bands 
(MPB) package [6] based on the PWE method with 128 x 128 
resolution. It can be shown that they match each other quite 
well for both polarizations. The required CPU time is just a 
few minutes for both methods on a Pentium IV 1.7GHz 
personal computer. As indicated in [3], the resultant matrix is 
quite sparse (quasi-band diagonal), thus it is easy to be 
implemented with direct QR procedure and it also reduces the 
memory requirement. 
0
0.2
0.4
0.6
0.8
1
N
or
m
al
iz
ed
 fr
eq
ue
nc
y 
(ω a
/2
π c
) TE mode 
This method
PWE method 
 
Fig. 3. The band diagram of the TE modes for the 2-D PC formed 
by square-arranged alumina rods. 
 
0
0.2
0.4
0.6
0.8
1
N
or
m
al
iz
ed
 fr
eq
ue
nc
y 
(ω
a/
2π
c) TM mode
This method 
PWE method 
 
Fig. 4. The band diagram of the TM modes for the 2-D PC formed 
by square-arranged alumina rods. 
 
To examine the efficiency of our new scheme, we fix the 
wavenumber vector k at the M point in the first Brillouin zone 
as in the right inset of Fig. 3, i.e. k = (π /a, π /a, 0), and search 
the eigen frequencies using different numbers of grid points. 
We also use the scheme provided in [3] to calculate the 
convergence behavior under the same conditions for 
comparison. 
The computed results are plotted as shown in Figs. 5 to 8. 
The relative error here refers to the difference between the 
result and the reference result obtained with the grid points 
being 2500. It shows that as the number of total grid points is 
larger than 1000, all four bands of our method can achieve a 
relative error less than about 0.5%. Compared with the method 
of [3], our method can provide better convergence behavior. 
Since we do not use any approximation such as index-average 
assumption in our derivation, the only error will be the 
truncation errors. 
Γ                       X                        M                        Γ  
         M  
Γ       X        
Γ                       X                        M                       Γ  
