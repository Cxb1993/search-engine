  1 
 
 
行政院國家科學委員會專題研究計畫成果報告 
新型低失真多媒體隱藏術之研究 
計畫編號：NSC 96－2628－E－005－008－MY2 
 
計畫主持人：蔡垂雄 中興大學資訊管理學系教授 
共同主持人： 
計畫參與人員：王宗銘 中興大學資訊科學與工程學系教授 
              吳男益、李志強、劉又齊、張均東、盧宏文  
              中興大學資訊科學與工程學系研究生 
 
中文摘要 
本計畫的第一年期研究工作中，
針對灰階影像資訊隱藏技術，提出了
一個全新型且具有最少失真性的連鎖
反應式 LSBs (Least Significant Bit 
substitution)嵌入技術。本研究方法所
產生的效果，均可改善目前有關以
LSB-based 為主的藏密學技術所產生
的失真性。一般而言，傳統的 LSB嵌
入技術，在嵌入 1個位元至像素值時，
其每個像素的平均修改率為 0.5。利用
本研究計畫所提出的新方法，可使每
個像素的平均修改率降低至 0.333。由
實驗結果顯示，新型的連鎖反應式
LSB 技術其 PSNR 值均比目前諸多的
LSB 技術來的好，因此可以證明本研
究計畫所研發的新方法具有極高的可
行性。 
第二年期研究工作中，主要是將
第一年所研發的連鎖反應式 LSBs 技
術，移植至其它常用的數位多媒體訊
號，以證明新研發的技術不僅能減少
灰階影像的失真性，也減少其它數位
多媒體訊號的失真性。本研究中以黑
白二元影像、調色盤影像及 JPEG壓縮
影像作為本研究主要實驗檔案媒介，
發展出一個新型可適性之高影像品質
的資料隱藏技術。實驗結果證明，本
研究計畫所提出的新技術，其在資料
隱藏的可適性及有效率性皆有出色的
表現。不論在資料隱藏量及藏後影像
品質上，皆是令人非常滿意的。 
關鍵詞：資訊隱藏、偽裝術、最低位
元嵌入法、最低位元匹配式嵌入法、
二元影像、調色盤影像、JPEG影像 
Abstract 
In this report, we present a novel LSB 
matching steganographic algorithm, 
which provides the minimal degradation 
of the cover image when embedding the 
secret message. In addition, we develop 
a novel image steganographic method 
that utilizes linkage LSBs embedding 
technique which is proposed in the first 
year of this study to implement to 
different image formats. Binary image, 
palette image and JPEG image are 
applied to this study for implementation. 
Experimental results show that the 
proposed scheme has reliable security, 
high embedding capacity and better 
image quality for the stego-image. 
Keywords: Information hiding, 
steganography, least-significant-bit 
substitution (LSBs), LSB matching, 
binary image, palette image, JPEG 
image 
1. 計畫緣由與目的 
由於網際網路頻寬的成長以及多
媒體技術蓬勃的發展，數位媒體如聲
音、影像、影片漸漸地成為網際網路
中熱門的交換內容。人們可容易地透
過網際網路上的數位媒體進行學習並
吸收最新的知識及資訊。因此，網際
網路與數位媒體科技的相輔相成明顯
  3 
 
 
  簡易型 LSBs 嵌入技術最早應用
於灰階影像，此種技術的特色是嵌入
過程簡單且容易實作，因此，我們稱
它為簡易型 LSBs技術。此技術主要是
利用像素值中最不重要的位元，其變
動性具有對人類視覺比較無感知性的
特點，進而將訊息直接覆蓋至像素值
中的最不重要位元裡，以完成攜帶訊
息的目的。假設灰階影像原本的十進
制像素值為 G(10)，對電腦而言 G(10)則
是由八個位元的二進制值所組合而
成，即 G(10)=d8d7d6d5d4d3d2d1(2)。例如，
G(10)=28(10) ， 則 二 進 制 表 示 為
00011100(2)。如果要嵌入的四位元的秘
密訊息 0010(2)，則把最後四位元的
1100 直接變成 0010 即可，原本的二進
制 像 素 值 由 00011100(2) 變 成 了
00010010(2)，得到新的十進制像素值為
G(10)=18(10)。依此類推，要嵌入 n個位
元，就從最右邊 n 個位元開始覆蓋。
當要取出秘密訊息時，只須要知道整
張影像是以幾個 LSBs 來藏入秘密訊
息，再讀取每個像素最右邊 n個位元，
即可得到所嵌入的秘密訊息。基本
上，在本文中所謂的 1-LSBs是指 n=1
時，即每一個像素值只攜帶 1 個位元
的訊息，而 2-LSBs是指 n=2時，即每
一個像素值被嵌入 2 個位元的訊息，
以此類推，n-LSBs 是指一張影像每一
個像素值都將被嵌入 n個位元的訊息。 
 
2-2  最佳化 LSBs 嵌入技術 
    使用簡易型 LSBs嵌入技術，當所
要嵌入的訊息量較多時，其失真性也
會同樣增大，例如使用 4-LSBs時，其
偽裝圖的 PSNR值會低於 40dB以下。
因此，為了減少使用簡易型 LSBs的失
真性，最佳化 LSBs 嵌入技術[2,8,12]
就相繼地被提出。在簡易型 LSBs嵌入
過程中，當訊息嵌入到像素後，所產
生的偽裝像素值只有固定一個而已;然
而，最佳化 LSBs 在訊息的嵌入過程
中，會產生三個偽裝像素值，而這三
個之中有一個是失真性最少的，即其
像素值與原始像素值最接近的，因
此，用失真性最少的偽裝像素值來攜
帶訊息，將可以使偽裝圖的品質大大
地提昇。接下來，我們將以實際的例
子來說明最佳化 LSBs 嵌入技術的運
作方式： 
假設原始像素值 G(10) =28(10)，當要嵌
入 4 個 (即 k=4)二進制秘密訊息
0010(2)，首先先計算 G(10)的餘數值
R:  
(10) mod 2
kR G= .  
此時可以求出 R = 12，計算秘密
訊息 0010(2) = 2(10)，接著調整 G(10)值，
直到餘數等於秘密訊息 2。首先把訊息
直接嵌入，則 原始像素值 28(10) 
=00011100(2) ， 將 會 變 成
18(10)=00010010(2)，此時 18(10) (18(10) 
mod 24=2)是第一個選擇。接著作上下
加減 2k 的動作，即 18(10)+ 2k 以及
18(10)-2k，分別得到 34(10) (34 mod 24=2)
與 2(10) (2 mod 24=2)另外兩種選擇，所
以一共會有三種選擇。顯然地，以這
個例子而言，必須選擇向上加 2k的動
作，它的失真幅度只有 6(34-28=6)，在
以上三個選擇中失真幅度是最小的，
所以 34(10) 將會是最佳選擇。如果採用
簡易型 LSBs技術直接嵌入的話，將只
有 18(10)可供 選擇，失真幅 度為  
10(28-18=10)。由此可知最佳化 LSBs
嵌入技術確實可以減少簡易型 LSBs
表一：簡易型與最佳化 LSBs嵌入技
術 PSNR值的比較結果 
影像 
名稱 
n-LSBs 
(隱藏量為 
512×512×n) 
PSNR值 
(單位：dB) 
簡易
型
LSBs 
最佳
化
LSBs 
Lena  
n=1 51.12 51.12 
n=2 44.02 46.37 
n=3 37.86 40.72 
n=4 31.28 34.84 
 
Baboon 
n=1 51.14 51.14 
n=2 44.02 46.37 
n=3 37.86 40.72 
n=4 31.33 34.78 
  5 
 
 
為 a1 。二進制值 P1最右邊的第一個位
元為 b0、第二個位元為 b1 。二進制值
P2最右邊的第一個位元為 c0、第二個
位元為 c1 。 
 二進制位元值 
←MSB位元         LSB位元→ 
P0 a7 a6 a5 a4 a3 a2 a1 a0 
P1 b7 b6 b5 b4 b3 b2 b1 b0 
P2 c7 c6 c5 c4 c3 c2 c1 c0 
 
步驟二：由於 3 個像素值在嵌入訊息
過程中，只會被+1或-1而已，而在±1
的變動範圍內只會影響這 3 個像素值
的二進制值的最右邊二個位元而已，
因此，我們將利用最右邊二個位元之
間的變化特性，來產生 3 個位元的原
始特徵值，定義為位元 A、位元 B 以
及位元 C，3個位元的原始特徵值產生
的過程如步驟三所述。 
 
步驟三：利用步驟一所定義的最右邊
二個位元來進行碰撞，以產生 3 個位
元的原始特徵值 A、B與 C，其碰撞公
式如下： 
   
0 1 0A a c c= ⊕ ⊕ ， 
公式(1)
 0 1 0B a a b= ⊕ ⊕ ， 
 
1 0 0C b b c= ⊕ ⊕ 。 
觀察公式(1)中的位元碰撞關係，可以
發現，若位元 a0 變動時，則位元 A與
B也會同時受改變;若位元 a1變動時，
則只有位元 B 會受變動;若位元 b0 變
動，則位元 B與 C會同時受改變;若位
元 b1 變動，則只有位元 C 會受變動;
若位元 c0 變動，則位元 A與 C會同時
受改變;若位元 c1 變動，則只有位元 A
會受變動。針對上述的變動關係之對
應，可得到表三的結果。 
表三：原始特徵值與位元相對應關係
位置     
步驟四：比較 3 個位元秘密訊息 S0、
S1、S2與 3個位元的原始特徵值 A、B、
C 是否相同，若全部相同，則代表不
需要修改任何像素值，即可嵌入訊息;
相反地，只要有任何一組不一樣時(如
S0≠A或 S1≠ B或 S2≠C)，則必須修改其
中一個像素值，來達到嵌入訊息的目
的，其詳細的比較演算法如下所述： 
 
Algorithm: 
If  (A=S0) and (B=S1) and (C=S2) 
     不做任何的修改 
Else If  (A≠S0) and (B=S1) and (C=S2) 
     If P0 mod 2 == 0  
          P0 = P0-1 
   Else 
        P0 = P0+1 
     End 
Else If  (A=S0) and (B≠S1) and (C=S2) 
     If P1 mod 2 == 0 
         P1 = P1-1 
   Else 
        P1 = P1+1 
     End 
Else If  (A=S0) and (B=S1) and (C≠S2) 
    If P2 mod 2 == 0 
         P2 = P2-1 
   Else 
        P2 = P2+1 
     End 
Else If  (A≠S0) and (B≠S1) and (C=S2) 
    If P0 mod 2 == 0 
          P0 = P0+1 
   Else 
        P0 = P0-1 
     End 
Else If  (A≠S0) and (B=S1) and (C≠S2) 
    If P2 mod 2 == 0 
         P2 = P2+1 
   Else 
        P2 = P2-1 
     End 
Else If  (A=S0) and (B≠S1) and (C≠S2) 
     If P1 mod 2 == 0 
         P1 = P1+1 
   Else 
        P1 = P1-1 
     End 
Else If (A≠S0) and (B≠S1) and (C≠S2) ; 
   If P0 mod 2 == 0 
          P0 = P0+1 
   Else 
        P0 = P0-1 
     End 
         If P2 mod 2 == 0 
         P2 = P2-1 
   Else 
        P2 = P2+1 
     End 
End 
 
經過上述演算法處理之後，訊息已被
嵌入至 P0、P1、P2中。日後，若要從
P0、P1、P2中取出 3 個位元的訊息，
P0 P1 P2 
a1 a0 b1 b0 c1 c0 
B AB C BC A AC 
  7 
 
 
引起視覺上的失真性。 
    因此，為了要讓訊息嵌入黑白影
像之中，不會引起顯著的失真性，則
必須選擇黑白相間的子影像區塊來隱
藏訊息，此外，在做修改的同時，還
必須考量到該點週遭像素值的同性質
與否。接下來，介紹本研究計畫研發
的低失真性黑白影像資訊隱藏技術，
方法與步驟如下所述： 
步驟一： 對一張黑白影像進行切
割動作，將其切割成一連串的 3×3
子影像區塊，並且篩選黑白相間
的子影像作為要嵌入訊息的對
像。 
步驟二： 找出子影像區塊中哪一
個像素，在變動之後，所引起的
失真性是最少的。此時，必須透
過一個評估方式，來衡量每一個
像素的可變性。在本研究計畫
中，是以週遭同性質點數的多寡
做為評分的方式，即該像素在變
動之後，與它週遭相同性質像素
值的總量為基準。一個簡單例子
如下圖所示，如果是要減少白色
點數的總量，則以中間像素(位置
為(2,2))從白色變為黑色之後，其
同性質的點數最多，該點變為黑
色之後，其週遭黑色的點數，共
有 4個。相對地，最右下角(位置
為(3,3))的像素值其同性質的像素
最少，該點變成黑色之後，其週
遭同為黑色的總點數為 0 個。故
如果選擇最右下角的像素值來減
少白色點的話，則最容易引起視
覺上的失真性。另外一方面，如
果是要減少黑色點數的總量，則
以最右上角(位置為(1,2))的像素
值最適合，該點變成白色之後，
其週遭相同的顏色為白色的共有
3個，若是選擇位置為(1,1)的，則
變為白色之後，週遭為白色的僅
僅只有 1 個，因此，該點是最不
理想的候選人。 
 
   
   
   
 
步驟三： 一次選取三個黑白相間
的子影像作為嵌入秘密訊息的對
像，每一次要嵌入 3 個位元的秘
密訊息，即每一個子影像要嵌入 1
個位元的秘密訊息。令三個子影
像的黑色像素值總和分別為 b0、
b1 和 b2，舉個簡單的例子，假設
這 3 個子影像的黑色像素值，都
剛好有 4 個的話，則 b0=4、b1=4
與 b2=4。 
步驟四： 將步驟三所得到的 b0、
b1與 b2值視為灰階像素值，並使
用連鎖反應式 LSBs技術，將 3個
位元的訊息嵌入至這三個子影像
中。嵌入的過程當中，若是需要
加 1 時，則增加該子影像的黑點
像素總量，即選擇白色像素來更
改成黑色像素;若是需要減 1 時，
則選擇黑色像素來更改成白色像
素。至於要選擇那一個像素來做
修改才不會引起顯著的失真性，
則必需使用步驟二中的方式，找
到一個同性質最佳的位置。 
步驟五： 檢查判斷修改完之後的
子影像黑白相間的數目，是否符
合當初設定的門檻值，如果不符
合的話，則放棄這一組子影像，
將這一組所嵌入的訊息，再重覆
地嵌入下一組。如此一來，在擷
取的時候，可避免累積性誤判的
發生。 
日後，要擷取訊息時，也必須對已藏
有訊息的影像進行相同大小的子影像 
切割動作，並且再利用嵌入時的門檻
值來選取出黑白相間的子影像。接
著，以三個子影像為一組，然後執行
步驟三(嵌入時的步驟)，得到每一個子
影像的 b0、b1與 b2值，最後再使用連
  9 
 
 
設計必須經由眾多的實驗求得。日
後，要擷取出資料時，則必須使用相
同的掃瞄方式與相同的門檻值，找到
屬於有隱藏秘密訊息的子影像，之
後，再利用連鎖反應式 LSBs技術，將
已嵌入的訊息擷取出來。 
3-2-3 節  基於連鎖反應式 LSBs 技術
的 JPEG 壓縮影像資訊隱藏技術 
JPEG 壓縮影像是目前數位影像格
式中最為廣泛使用的影像壓縮檔，其
主要原因是它的檔案容量很小，可以
將原始無失真影像檔壓縮至 10 倍以
上，而且壓縮後的影像品質，是人類
視覺所能接受的。一般的彩色影像
JPEG壓縮流程如下圖所述，其中，只
有取樣與量化時會造成失真，其餘的
皆屬無損的轉換過程，而量化時所使
用的量化表，乃是國際學術界上共同
採用的標準值。 
    傳統上的 JPEG 影像資訊隱藏技
術，大約可以區分為二種型態—量化
前嵌入資料與量化後嵌入資料。量化
前嵌入資料比較能控制影像品質，但
比較不實用。而量化後嵌入資料則具
有高實用性，但影像品質比較難於控
制，因為，對已量化後的係數做調整
的話，其失真性的大小，會依照量化
表中的數值等倍數的放大性失真，例
如，如果量化表中所對應的數值為
32，則對量化後係數加 1 的話，則其
失真性就放大為 32倍。 
    
 
由於目前大多數的 JPEG檔案都是
已經過量化壓縮後的影像，因此，基
於實用性的考慮，本研究計畫擬要研
發的 JPEG資訊隱藏技術，是以量化過
後的係數作為嵌入訊息的對像，如此
一來，任何一張 JPEG壓縮影像都可以
採用本研究所研發的新技術。此外，
新技術有另外二個優點，第一、在嵌
入資料之後，並不會改變原始檔案的
大小，目前諸多的 JPEG 資訊隱藏技
術，在嵌入訊息之後，會將原始檔案
變大，若是 JPEG檔案會變大，則就失
去了壓縮的功能。第二、由於採用了
連鎖反應式 LSBs技術，因此，整體的
失真性又可以大大的降低。本研究計
畫的新式 JPEG 資訊隱藏技術其方法
與步驟如下所述： 
步驟一： 讀取一張 JPEG 影像壓
縮檔，反向解碼至無損編碼的階
段，得到每一個以 8×8 為單位的
已量化後係數值。在一個 8×8 的
區塊中，第 1個值為 DC值，其於
63個值為 AC值。AC值又可分佈
為三種頻率域的屬性，即低頻、
中頻與高頻。其中，低頻的值是
最重要的，中頻次之，高頻則是
屬於不重要的量化係數。一般而
言，量化完之後的高頻區域的
值，幾乎都為 0 比較多，但如果
在高頻區域嵌入訊息的話，則會
導致原始壓縮檔案變大。因此，
本研究計畫將不會對高頻區域嵌
入任何訊息，以免影響原始的壓
縮率。 
步驟二： 計算每一個區塊已量化
完後的非零係數值的個數總量，
若非零係數值的個數愈多，代表
該區塊的原始影像內容複雜度比
較高 (即屬於較邊緣的地方 );反
之，若為非零係數的個數非常地
少，則代表該區塊的原始影像內
容的複雜度比較低(即屬於較平滑
的地方)。因此，可設一個非零係
數總量的門檻值，來判斷該區塊
是否要嵌入 3 個或 6 個位元的秘
密訊息，若區塊非零的係數值大
  11 
 
 
而 LSB 匹配方法可以把影像的品質
提升約 1.2至 1.3dB左右，平均的PSNR
值約為 52.4dB。而我們所提出的方法
又再度把影像品質提升 0.5dB，每張偽
裝圖的 PSNR值約為 52.9 dB。證明了
在藏入相同的容量以及資料下，我們
的新技術確實會擁有比較好的影像品
質。最後，我們也比較新方法與現有
技術的實際程式執行時的計算花費，
在現存方法[2,8,12]中，每嵌入一個位
元到一個像素值，至多只要 1 個的邏
輯運算子操作，故若嵌入 n 個位元的
訊息量，其整體的時間複雜度為
O(n)；而在現在方法[3]中，每嵌入一
次，需要執行 4個的邏輯運算子操作，
平均嵌入一個位元訊息需要 2 個邏輯
運算子操作，故整體的時間複雜度為
O(2n)，即等於 O(n);而我們的新方法，
每一次需要 8 個的邏輯運算子操作，
平均嵌入一個位元訊息而要 2.66 的邏
輯運算子操作，故整體的時間複雜度
為 O(2.66n)，即等於 O(n)，由此可知，
新方法所需要增加的計算花費，與現
在的方法相比較，有相同的時間複雜
度。 
4-2 節 第二年期計畫方法 
根據本研究計畫所提之新方法，
首先，先針對 JPEG影像進行資訊藏入
處理。所比較之對象為 Chang 等學者
於 2002 年所提出之修改 DCT 量化表
之 JPEG影像偽裝藏密術。接著再以調
色盤影像作為下一個實驗，所比較之
實驗對象為 Tzeng 等人於 2004年提出
之以色彩順序及對映之可適性調色盤
影像偽裝術。此外，本實驗採用了
PSNR 公式來比較新方法與其方法的
偽裝圖品質，若 PNSR 值愈高，則代
表偽裝圖的影像內容與原圖愈相似;反
之，則代表兩者之間差異性愈大，故
PSNR值愈高，則表示其失真性愈少。 
基本上，我們使用超過一百張以
上的影像來測試本報告書所提出的新
方法，在此，列出五張比較具有代表
性的測試影像(大小皆為 512×512，以
及使用我們所提供的新方法藏入秘密
訊息後的偽裝圖，每張偽裝圖的隱藏
量皆為 50,000 位元，每張偽裝圖的影
像品質 PSNR 值如表五及表六所示，
皆保有非常良好之影像品質。從實驗
結果可知，本計畫所研發的新方法，
其所有產生的偽裝影像，即使和原始
影像放置在一起，還是非常難以察覺
有任何失真性。本計畫書的新研發方
法也與現存知名的方法作比較，我們
可以發現在嵌入相同的資料後，本計
畫中在 JPEG 影像實驗之影像品質
PSNR值約為 48dB左右，而 Chang 等
學者所提出之方法平均約為 35dB。在
調色盤影像中，本計畫提出之方法偽
裝圖品質約為 44dB左右，而 Tzeng 等
學者所提出之方法約為 34dB左右。因
此本計畫所提出之方法除了提昇影像
品質之外，其每張偽裝圖的影像品質
皆為穩定。證明了在藏入相同的容量
以及資料下，本計畫所提出之新技術
確實會擁有比較好的影像品質。 
 表五、在相同的隱藏量之下，本論
文於 JPEG影像中新方法與前人方法
其 PSNR值的比較結果。 
影像名稱 
影像品質 (PSNR值) 
Chang 等人
方法[17] 
本計畫 
新方法 
Lena  34.84 48.325 
Jets  36.52 48.334 
Baboon 27.63 47.048 
Pepper 38.48 48.412 
Boat 33.29 48.323 
