用者睡眠時的心率、身體晃動以及睡眠時間。在
量測結束後，透過一些簡單的問卷調查以及初步
訪談的結果來加以綜合分析。 
 
三、硬體系統架構設計 
 
本 裝 置 擷 取 光 體 積 描 記 法
(Photoplethysmography, PPG)與身體晃動信號，
「PPG 裝置」原理是藉由 LED 光源打入皮膚組織
內，會被不同物質所吸收，例如皮膚、骨骼、動
脈及靜脈血液後，再將接受到光強度的變化量轉
換為電壓信號。身體晃動信號則是藉由「三軸加
速計」將人體翻身的加速度信號轉換為數位信
號，進行儲存。 
圖 1 所示為睡眠監測裝置韌體流程圖，主要
分為三個部分，首先針對微處理器及記憶卡內部
的暫存器進行初始化的動作，此後判斷記憶卡與
PPG 裝置是否存在，之後睡眠裝置進入待機狀態
(Idle mode)，透過腳位中斷，將睡眠裝置轉換至開
始模式(Start mode)，並將生理資訊寫入記憶卡
中，記錄一晚 6 小時的睡眠生理資訊約 3M byte
資料量，睡眠裝置一直記錄到使用者清醒後將裝
置切換至(Idle mode)結束，上述三個流程部分是睡
眠裝置主要實體功能設計。 
 
 
圖 1  主程式流程圖 
 
四、系統演算法設計 
 
睡眠階段的判定演算法採用灰色適應共振網
路。首先透過使用者在居家睡眠監測裝置所記錄
的資料，將 PPG 信號與體動信號分別處理，灰色
適應共振網路只針對心率頻譜的樣版來分類睡眠
的階段，因此很容易將使用者部份的睡眠狀態誤
判為覺醒階段。本研究額外加入睡眠身體晃動的
信號，來協助判斷使用者目前睡眠狀態是覺醒或
睡著的階段。 
 
1. 體動信號處理流程 
由於人類在入睡之後幾乎是停止動作，所以
可以利用偵測身體晃動的狀況來評估使用者目前
的狀態。使用者將本文所設計的裝置配戴在手腕
上，將三軸加速規的數據儲存在記憶卡中。 
三軸加速度的取樣頻率為 75 Hz，在量測到三
軸加速度的數值後，必須將所量測之加速度轉換
為能量的變化量，主要是參考[5]所提出來的體動
信號偵測演算法。整體演算法的架構分為三大部
分：信號濾波、計算各個軸向的能量強度以及睡
眠清醒週期。由於人體在晃動中的頻譜座落範圍
為 0.5 到 10 Hz，因此三軸加速度信號必須經過帶
通濾波器(Band pass filter)將高頻雜訊與低頻準位
移除。 
演算法的第二步驟就是分別求取 X、Y、Z 軸
的能量強度，由於必須知道使用者睡眠時睡眠等
級的變化情形，因此必須獨立計算每一頁(Epoch)
的能量強度，為計算過後的結果，計算各軸向的
方式如 1 式所示： 
 
∑=
+epoch 2)()(
j
j
bpfx xnI             (1) 
 
最後一個步驟是透過每一個軸向所算出的能
量，以門檻值(TR)來作為判斷的依據，各軸的計
算方法為 2 式所示，若運算的結果為 D(n)>0，意
味著在此頁(Epoch)的活動量足以表視為“覺醒”
的階段；D(n)<0，則意味著睡眠階段在“睡著”
的階段。 
))(sgn()( ixx TRnInD −=        (2) 
  
2. 心率信號處理流程 
擷取到 PPG 信號後，必須將此生理信號轉變
為心率，轉換的方式是參考“So and Chan ”峰值偵
演算法[6]來進行心率的計算。藉由偵測各個點的
斜率來找出峰值來推算出心率，此演算法最主要
分為兩部分：計算各點斜率、偵測峰點。 
先必須要計算每一點的斜率，計算斜率的方
式如式所示： 
2)X(n1)X(n(n-1)-2X(n-2)-Xslope(n) ++++= 2     (3) 
 
斜率的閥值(threshold)為 4 式： 
 
maxi
16
amthresh_par
shslope_thre ×=        (4) 
 
斜率的閥值參數(thresh_param)可以設定為
2、4、8、16，本篇論文將此參數設定為 8，當連
續兩個點的斜率大於斜率閥值時，意味著信號的
五、結果與討論 
 
1. 演算法測試 
在測試階段，將先前透過樣板訓練階段，將
MIT/BIH的心電圖樣板(ECG template data)資料當
作比較序列，而 MIT/BIH 內的連續動脈壓(Blood 
pressure,BP)與心電圖的資料當作測試資料的輸入
源，並透過灰色共振適應網路分類出最相近的樣
板，評估全部的睡眠階段後，分別計算透過心電
圖與連續動脈壓求出的心率所估算出的睡眠階
段，與實際睡眠階段比對正確性，在此階段不會
有任何新增或刪除樣板的動作產生。 
在測試結果中，使用 BP 與 ECG 的心率來當
作灰色關聯度的比較序列，並依流程依序計算出
彼此睡眠階段，並依照相對睡眠資料庫內的睡眠
等級來計算正確率，計算正確率的公式為式 6 所
示，Na 為分類出的正確的數目，Ntotal 為全部要被
分類的數目： 
%100×=
total
a
N
NAccuracy            (6) 
測試結果的準確度如表 1  不同生理信號的
在ρ=0.95 時的正確率所示，而分別評斷出的睡眠
階段，會影響判別正確率因素為：(1)經過 So and 
Chen 方法後心率信號是否夠有突波的情形產生(2)
經過 STFT 方法完所獲得的時頻能量不同的ρ值
也會導致正確率有所差別。 
 
表 1  不同生理信號的在ρ=0.95 時的正確率 
Record Name Type of Signal Accuracy 
Slp48 BP 69.81% 
ECG 70.13% 
Slp59 BP 69.21% 
ECG 72.92% 
Slp61 BP 74.37% 
ECG 78.59% 
Slp62 
BP 74.44% 
ECG 82.72% 
 
MIT-BIH 資料庫內的資料，若心電圖或連續
脈動壓受到肌電信號或基線飄移的干擾，導致在
計算心率結果突然大變量變化，也就是會有突波
的情形，使得此心率進入短時傅立葉轉換運算
後，變成 VF、LVF、HF 頻段中皆有能量座落的
情形產生，以致於誤判此睡眠階段為覺醒情形。 
其次是 STFT 所選定的頻譜範圍，若是選擇 0
至 0.5 Hz 的頻譜範圍，會因為極低頻信號的能量
過於強大，在經過灰色適應共振網路時，高頻成
分的樣板特徵值不夠明顯，進而無法判別出實際
量測結果的睡眠階段。因此，本論文採用美國心
臟協會所定義的頻帶範圍，將頻譜範圍設定在
0.003 至 0.5 Hz。 
由於連續脈動壓是透過氣壓感測的方式來獲
得信號，因此更容易受到肌電信號的干擾，造成
經過 So and Chen 演算法後所獲得的心率較無心
電信號好，進而導致連續脈動壓的所評斷出睡眠
階段結果沒有心電信號所評估出來的佳。 
透過以上的測試，可以得知不同使用不同信
號計算出的心率結果皆是可相互取代來作為運
算，而也有研究顯示，PPG 與連續脈動壓皆為循
環系統中作用下的產物，每當心臟收縮將血液傳
送至全身，血壓也會呈現收縮的週期變化。由於
血管富有彈性，因此當血壓週期性的變化，會使
得通過當為截面積的些流量呈現週期性的訊號波
形，此即為血管容積的週期變化[9]，因此也可以
藉由 PPG 所計算出的心率，來帶入此樣板，進而
計算睡眠階段。 
 
2. 演算法測試 
實際運作與測試睡眠監測裝置的實際效能，
徵求受試者的同意在睡眠中攜帶睡眠監測裝置量
測心率與身體晃動信號。在使用者監測完睡眠階
段後，填寫睡眠評量表，透過匹茲堡睡眠評量表
(Pittsburgh sleep quality index, PSQI)作為驗證的機
制，整體流程架構如圖所示，在灰色適應共振網
路中的比較序列樣板，是以 MIT-BIH 睡眠資料庫
訓練連續脈動壓的生理資訊得來，故評定結果可
能會有不準確的問題，但本裝置的重點是在驗證
能否偵測出有睡眠問題，也就是達到事前篩檢的
動作，例如：睡眠品質差的人與正常人的差別，
並評斷出整體的睡眠階段與所占比例。 
 
圖 3 驗證與評估睡眠階段步驟 
 
受試者 001透過PSQI評量表計算出的分數總
計為 5 分，分數低於 8 分，所以自我評估的睡眠
情況為良好；而透過睡眠監測裝置所分析出來的
睡眠階段如圖 4 所示， 表 2 為本系統的睡眠檢查
報告。 
 
表 5  整體受測者的睡眠品質表 
 
五、結論 
 
過去判斷睡眠階段的裝置最主要是以 PSG 儀
器或透過腦波波段的不同來分析使用者的睡眠階
段，但是這些方式皆不適用於居家量測中。因此，
本論文提出了一套睡眠監測的量測裝置，並透過
灰色適應共振網路的方式來自動分析出睡眠階
段。本論文所提出的居家裝置特色為： 
(1)非侵入式的監測方式 
本裝置的監測系統透過血氧儀器來量測 PPG
信號，以三軸加速度來計算睡眠時身體晃動的情
形，因此使用者不會有因黏貼電極片而產生任何
睡不安穩的情形。 
(2)少量化生理信號 
原本需要 12 道信號才能評估睡眠狀態的形
式，簡化成只需要量測心率與身體晃動信號，讓
使用者在接受睡眠測試更加的舒適，也免去需專
業人員或醫師才能操作的問題。 
(3)外掛式的設定 
簡單的外掛式設定使得組裝的工作更加的便
捷，使用者只需要在睡眠時攜帶睡眠監測裝置即
可，在睡醒後將睡眠裝置卸除，不必像腕動計整
天攜帶在手腕上來作為監控。 
(4)自動化睡眠等級分類 
將記錄到的生理參數透過灰色共振網路來進
行睡眠階段的分類，並透過睡眠階段自動分類的
結果，來評斷使用者睡眠品質或是否有睡眠障礙
的問題，當睡眠品質或效率嚴重到一定程度時，
再前往醫院做進一步的檢查，不但可以簡化篩檢
失眠症狀的流程，而且可以大幅提高睡眠醫學檢
查室的使用效率。 
本論文實作出一個符合居家睡眠監測的裝置
系統雛形，透過後端電腦分析出整體的睡眠階
段。透過計算深層睡眠的比例與睡眠參數的方式
來計算使用者的睡眠品質，達到提供醫生及睡眠
障礙的人一個準確與方便的評估系統，並可以長
期的讓使用者在居家環境中自行操作使用，當分
析出的睡眠品質低落，將所解析的睡眠階段與參
數資訊透過網路傳輸給醫生來做為參考的依據。 
演算法的核心是透過共灰色適應共振網路來
達睡眠分類，優點是只需簡易的計算方式即可達
到，然而學習不同的樣板會影響到最終解析出的
睡眠階段，若學習錯誤的樣板，則會導致睡眠階
段結果正確率的降低，因此樣板的擷取是非常的
重要，最好的方式是透過獨立樣板方式來進行評
估，則準確率會大幅的提升。 
本論文在演法驗證的部分，整體正確率約 70 
%，雖然無法與 PSG 睡眠分析精準的結果相比，
但以篩檢使用者是否有睡眠障礙的前提下，已經
可以滿足此條件，未來可以針對演算法進行研究
以減少誤判的情形產生，以提升整體睡面監測裝
置的效率。 
 
誌謝 
本論文由國科會計畫補助，計畫編號為 NSC 
98-2221-e-027-006-。 
 
七、參考文獻 
[1]C. D. Rodgers, D. H. Paterson, D. A. Cunningham, E. 
G. Noble, F. P. Pettigrew, W. S. Myles, and A. W. 
Taylor, "Sleep deprivation: Effects on work capacity, 
self-paced walking, contractile properties and 
perceived exertion," American Academy of Sleep 
Medicine, vo1. 18, no. 1, 1995, pp. 30-38. 
[2]行政院主計處，94 年社會發展趨勢調查報告－健康
安全，行政院原住民委員會，2006。 
[3]梁秀鴻譯，天天好眠，活到老：教你睡好覺，台灣，
時報出版，2004。 
[4]S. L. Himanen and J. Hasan, "Limitations of 
Rechtschaffen and Kales," Sleep Medicine Reviews, vol. 
4, no. 2, 2000, pp. 149-167. 
[5]B. H. Choi, J. W. Seo, J. M. Choi, H. B. Shin, J. Y. Lee, 
D. U. Jeong, K. S. Park, "Non-constraining sleep/wake 
monitoring system using bed actigraphy," Med Biol 
Eng Comput, vol. 45, no. 1, 2007, pp. 107-114. 
[6]R. G. Lee, C. C. Chen, P. Y. Tsai, and K. Y. Yang, "A 
Portable Tele-Emergent System Supporting 
Electrocardiogram(ECG) Discrimination," Journal of 
National Taipei University of Technology, vol. 37, no. 1, 
2003. 
[7]S. Grossberg, "Adaptive pattern classification and 
universal recoding, I: Feedback, expectation, olfaction, 
and illusions," Biological Cybernetics, vol. 23,         
pp. 187-202, 1976. 
[8]C. Wen, M. F. Yeh, and K. C. Chang, "ECG Beat 
Classification Using the GreyART Network," Signal 
Processing, IET, vol. 1, no. 1, 2007, pp. 19-28. 
[9]J. Ando, A. Kawarada, M. Shibata, K. I. Yamakoshi, 
and A. Kamiya, "Pressure-volume relationships of 
finger arteries in healthy subjects and patients 
withcoronary atherosclerosis measured non-invasively 
by photoelectric plethysmography," Japanese 
circulation journal, vol. 55, no. 6, 1991, pp.567-5 
 
 
測試者編號 次數 PSQI LightSleep Q 
001 1st 5 61 % 26 % 
001 2nd 5 59 % 19 % 
001 3rd 5 67 % 21 % 
001 4th 5 62 % 23 % 
002 1st 6 61 % 27 % 
002 2nd 6 63 % 25 % 
002 3rd 6 70 % 20 % 
003 1st 15 73 % 16 % 
003 2nd 15 71 % 15 % 
表 Y04
報告內容應包括下列各項：
1、 參加會議經過
本次參加福建省醫療器械和醫藥技術第一屆學術委員會議是由福州大學所舉辦，今
年在福州市舉行，所含括的領域有：(1) 醫療器械 (2) 中草藥技術，會中有來自世界各
地研究人員發表專題演講，大會共分為三天進行 Oral 及分組討論。.
2、 與會心得
本次會議前後共 3 天,會議由 9:00AM 開始到 17:00PM 結束,因此有很長的時間可以
觀摩各界發展的近況,以我所參加的 Session: Medical Instruments 有三位教授發表專題演
講，包括中醫器械設計，視覺化控制技術與資通訊技術在醫療照護之應用等主題。整體
而言，參與本次會議獲得很好的知識累積及學習的經驗. 其中 Keynote speech 是邀請英
國 Brunel 大學學者談視覺化控制技術在醫學上的應用，正好是本人的研究主題有關，收
穫不少！
3、 考察參觀活動(無是項活動者省略)
無
4、 建議
感謝國科會支持參與本次會議. 參觀與討論是研究很重要的方法之一.希望這樣的
補助能持續進行.也希望能提高技職體系老師參加的意願, 透過國際會議的參與,提高
學術研究得能量並練習語言表達. 尤其是本土畢業的學者.
5、 攜回資料名稱及內容
(1) 會議手冊
(2) 論文投影片
6、 其他
無
98年度專題研究計畫研究成果彙整表 
計畫主持人：李仁貴 計畫編號：98-2221-E-027-006- 
計畫名稱：居家型睡眠品質監測與評量系統之研製 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 1 1 100%  
研討會論文 1 1 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 2 2 100%  
博士生 1 1 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 1 1 100%  
研究報告/技術報告 1 1 100%  
研討會論文 1 1 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
 
