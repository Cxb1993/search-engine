中文摘要 
近年來無線通訊以及行動電話應用越來越普及，使用者對於信號頻寬或資
料傳輸速率的需求也各有不同，許多不同的無線通訊規格也應運而生，例如第二
代的GSM，二點五代的GPRS，第三代CDMA2000/WCDMA (UMTS)，無線網路
802.11a/b/g/n，藍芽(Bluetooth)等。而這麼多種的系統規格，各有不同的傳輸速
率及不同的傳輸頻段，因此需要使用不同的傳收機(Transceiver)。 
軟體定義無線電(Software-Defined Radio, SDR)之構想便是希望藉由發展單
一傳收機來適用於數種無線通訊傳輸規格，而本子計畫之重點便是在於研究接收
機中適用於多規格的類比數位轉換器， 使用連續時間三角積分調變器是一個在
權衡解析度，頻寬和功率下，一個不錯的選擇。 
在連續時間三角積分調變器中，主要有幾個造成錯誤的來源，比方過迴路延
遲(excess loop delay)和時脈抖動(clock jitter)。第一個提出的方法，是來改善時脈
抖動對於整個調變器效能的影響。在不需要大量增加積分器的增益頻寬積下，也
就是保持一定的功率消耗，採取一個多階形式的DAC電流波形做迴授，既解決
時脈抖動帶來的問題，也不會大量的增加功率消耗 
針對過迴路延遲這個非理想效應，數位微分和數位濾波器可以改善此非理想
效應。首先，再輸出使用數位微分器下，可以用較少的DAC作為迴授，來改善
過迴路延遲的問題，再者因為使用較少的DAC可以省下電流和面積，若是需要
使用DEM，也可採用較為簡單的數位邏輯來實現。而從數位濾波器的觀點來看，
由於過迴路延遲，產生了一個與理想所不同的轉移函數，此迴路延遲可以使用esτ
來表示，若使用數位濾波器則可以消除此非理想效應，來完成迴路延遲補償。 
最後，採用連續時間四相位帶通三角積分調變器(Continuous-Time Quadrature 
Bandpass ΔΣ Modulator)來實現此一類比數位轉換器。在目前無線通訊接收機的技
術中，低中頻(Low-IF)以及零中頻(Zero-IF)接收機被廣為採用。然而，在連續時
間 四 相 位 帶 通 三 角 積 分 調 變 器 轉 換 資 料 的 過 程 中 ， 四 相 位
I/Q(In-phase/Quadrature-phase) 通道中的類比電路元件存在著mismatch的效應，
使得在進入調變器之前負頻的其他干擾和quatization noise填進頻帶，降低了系統
的訊號雜訊比(SNR)。另一方面，輸入信號也會反射至負頻產生所謂的鏡像信號
(Image signal)。 
針對上述之需求，我們提出了適用於 GSM-EDGW/Bluetooth/WCDMA 的四
相位帶通(Quadrature Band-pass)以及四相位低通(Quadrature Low-pass)的三模式
連續時間三角積分器來達到系統所要求的 SNR 值。而在連續時間低通或是帶通
三角積分器裡，基於低功率考量，利用後端提出具備 I/Q 不匹配修正技術之數位
電路來協助修正類比-數位轉換器(Analog-to-Digital Converter, ADC)的操作。數位
電路校正技巧可以在不影響類比電路操作下，改善 I/Q 通道不對稱的現象。因此
使用提出之數位校正技巧，不僅可校正迴授信號 DACs 不對稱的問題，還可以提
升 SNR 和 IRR。 
 
 
 
 
3
mismatch effect without affecting the operation of the analog circuit. Then with the 
proposed calibration scheme which not only reduced the I/Q mismatch from feedback 
DACs but also increased SNR and IRR of this work.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
5
2 利用延遲時脈運算、多階回授降低時脈抖動敏感性之數位輔助連
續時間型三角積分調變器  
 
2.1 研究動機與設計目標 
2.1.1 研究動機 
隨著3G時代來臨，從短距離到動輒數百公里的無線電資料與語音傳輸技術
不斷的進展，使的無線行動通訊在人類生活中扮演相當重要的角色。由於高輸入
動態範圍，高傳輸速度及低功率的需求，使的設計類比數位轉換器(ADCs)也必
須達到較高解析度、寬頻與低功率的規格方能滿足嚴苛條件外，也可放寬前端類
比接收器的設計需求。為符合現今高速低功率之通訊需求，各種形式中的ADCs
中，其中又以能達到低功率和高解析度(high resolution)，利用超取樣 (oversample) 
和雜訊濾波 (noise shaping )兩種方法的三角積分(delta-sigma modulator)調變器被
廣泛的使用和討論。 
三角積分調變器的發展從離散時間型三角積分調變器 (discrete-time 
delta-sigma modulator)開始，這對於達到高解析度(high resolution)有很好的提升，
但僅適用於頻寬小的信號。離散型時間型三角積分調變器實現上是以切換式電容
電路為主，然而受限於在調變器輸入端訊號取樣時，時脈注入與取樣失真無法被
負回授削減，且取樣精準度被（電荷 settling 到電容）限制住，一般需要放大器
的頻寬為取樣頻率四到十倍方可達到精準的 settling。另外，取樣電容也能夠很
大去滿足雜訊的要求，但卻會造成放大器功率的消耗。相對於離散時間型調變
器，連續時間調變器是在量化器前方被取樣，所以產生的失真會經由調變器雜訊
移頻移往高頻，且對於放大器的頻寬要求比較寬鬆，故可以操作在更高的取樣頻
率與低功率消耗。 
連續時間型三角積分調變器 (continuous-time delta-sigma modulator)，可以達
到高速操作、低功率和寬頻信號的需求。除此之外，附有濾波器 (Inherent anti-alias 
filtering) 的功能在裡頭，我們可以更簡化整個接收端(Rx)的電路，降低整體功
率。因此目前的研究多是以連續時間型的三角積分調變器，及其應用為主流。 
  雖然在目前高速低功率需求下連續型時間型三角積分調變器是個很好的
選擇，但是連續時間型調變器，會因真實電路先天的非理想性，而有無法避免的
內部迴路延遲 (excess loop delay)和時脈抖動(clock jitter)問題存在，的影響會使
得調變器性能大大下降。因此如何有效的提出方法降低此二非理想效應對連續時
間型效能的影響，是在設計連續時間型三角積分調變器之重大關鍵。本次研究主
 
 
7
   
 
利用超取樣技術可降低原本在訊號頻寬內的雜訊功率，且其訊號雜訊比每提高一
倍的取樣頻率，可增加3dB的解析度，相當約0.5有效位元。 
   而雜訊移頻，參考下面示意圖 
               
 
其中 STF(z)為訊號轉移函數（signal transfer function） ， NTF(z)為雜訊轉移函
數(noise transfer function)。雜訊會被高通性質的NFT推往高頻，而使的在頻
寬FBW，內的雜訊能量減少。但對輸入訊號而言其經過為低通性值得STF調變
後，不受影響，所以可以有效使在頻寬內之訊號雜訊比提高。 
 
2.2.2 時脈抖動之非理想效應 
 
¾Pulse position jitter: 
clock jitter  introduces sampling errors  
at the quantizer input
¾Pulse width jitter:
feedback charge error at the DAC
N-bit  Quantizer
clkDAC
X(t)
Y[n]Σ Loop FilterH(s)
DAC
clkADC
 
Fig. 2 時脈抖動對系統影響 
 
上圖為一連續型三角積分調變器受時脈抖動影響之示意圖。時脈抖動的
話會在其整個系統的兩個地方造成誤差。第一個是對訊號的取樣時間，由於
每此時脈的抖動，造成量化器在取樣時提前或延後取樣，而不是理想的週期
性取樣。另外是數位類比轉換器(DAC)回授時，由於時脈的抖動，造成每個
週期回授的起始時間不同，因而使每次回授時間不固定而造成一不固定量回
授之隨機誤差。又因在量化器取樣造成的誤差，本來就與量化器量化產生之
誤差一起產生，依此都會經過NTF之雜訊濾波，對頻寬內的雜訊影響不大。
但是時脈抖動在數位類比轉換器輸出造成的隨機誤差，會直接回授到信號輸
 
 
9
另一解決時脈抖動的問題是改以多位元量化器跟多位元數位類比轉化器做
回授。如 Fig. 4 所示，因為是多位元，又因量化器是做過取樣，所以每次量化器
輸出變化較小，相隔每次的回授電流改變較小，因此當有時脈抖動的時候，造成
的誤差回授量也較小。但是一個多位元回授的系統，又會有數位類比轉化器線性
度的考量。 
FIR DAC scheme  
Fig. 5  FIR 濾波器回授示意圖 
 
另一種也是降低每次回授電流量差值大小的方法是在數位類比轉換器之後
加上一個 FIR 濾波器運算後再回授。如 Fig. 5 所示。雖此方法可以用一位元量化
器和數位類比轉換器達到相同於多位元受時脈抖動影響較低的好處，但其因有延
遲回授，所以有系統穩定度考量的疑慮。 
 
2.2.4 本研究提出之多階回授波形 
本次研究提出的方法，是用一個多階的回授波形來作為回授。其波型及波型
產生方式如下圖: 
(d1)
(d2)
(d3)
(d4)
8
T
(d5)
(d6)
(d7)
8
T
8
T
8
T
8
T
8
T
8
T
(d0)
(d1)
(d2)
(d3)
(d5)
(d6)
(d7)
(d4)
0 T8
7T___6T
8
___
8
___5T
8
___4T
8
___3T
8
___2T
8
T__
I
 
Fig. 6 多相位延遲時脈 
 
 
 
11
回授誤差。如果抖動大於八分之一個周期時，因為是階梯狀波形，其產生的誤差
量也是最低階電流量較小的誤差。因此可以有效減低時脈抖動對整個連續型三角
積分調變器的影響。 
又為比較多階回授與用相同邏輯運算但只用一組延遲時脈產生的單階回授之
優點，我們從真實電路實現的兩個方面來探討。 
Multi-step current waveform with clock jitter
8
T__
8
7T___0 T
Ι
8
T__
8
T__
ΙΔ
0 8
T__
8
7T___ T
Ι __16T__16T
ΙΔ__712
More sensitive to clock jitter
0 8
T__
8
7T___ T
Ι
ΙΔ__512
__
16
3T__
16
3T
More power consumption
 
Fig. 9 時脈抖動對單階與多階回授波形影響 
 
如上Fig. 9 所示，在同樣回授量前提下，也就是回授波形的面積量是一樣。
對單階回授的波形而言，因為只要時脈抖動一大過預留給抖動的時間時，如下右
圖分別是十六分之一周期或是十六分之三個週期，其誤差的量就會很大，是整個
最高的電流值。所以如果要好的對時脈抖動敏感性低的話，就要預留較多的時間
給抖動，則在一個週期內能回授的時間較短，所以回授的電流值要較大，如此要
在短時間內迅速的完成回授，其積分器是必要花較多的功率，所以單階回授會有
功率與消耗與時脈抖動敏感性的相互衝突。 
 
 
13
500MHzSampling Frequency
17Over-Sampling Ratio 
2nd-order 1-bitArchitecture
15MHzSignal Bandwidth
46dBSNDR 
-
Adder
+ −
DAC1
+ −
DAC1
+−
+−
+ −
DAC1
+ −
DAC2
+−
+− 2Vi
Vo
fs=500MHz
8k 4k
105k
0.8p 1p 
1Bit
Quantizer
+
-
z-1/2
106 107 108
-100
-90
-80
-70
-60
-50
-40
-30
-20
-10
0
10
Frequency (Hz)
M
ag
ni
tu
de
 (d
B
)
Without Calibration
 
 
0
20ps
40ps
80ps
200ps
Without proposed technique
P_to_P Jitter
M
ag
ni
tu
de
 (d
B
)
106 107 108
-100
-90
-80
-70
-60
-50
-40
-30
-20
-10
0
10
Frequency (Hz)
M
ag
ni
tu
de
 (d
B
)
With Calibratin
 
 
0
20ps
40ps
80ps
200ps
With proposed technique
P_to_P Jitter
M
ag
ni
tu
de
 (d
B
)
 
Fig. 11 時脈抖動對傳統與多階波形回授模擬 
 
從模擬圖可以看出，傳統的NRZ回授，在受到時脈抖動影響時，其頻寬內背
景雜訊(noise floor)值上升許多，其雜訊移頻後的notch也被填補掉。而採用提出
多階回授方法的系統，在時脈抖動不太大時，仍然可以保持原本的雜訊頻譜，但
時脈抖動大到一定程度，其頻寬內的雜訊頻譜才被填高，但仍比傳統的回授方式
的雜訊量小。由上面模擬，可以驗證本提出方法能有效降低時脈等動對連續型三
角積分調變器之影響。 
 
2.3 系統架構設計 
2.3.1 系統架構選取 
為驗證此提出方法可行，本次研究設計採取一可達高解析度的，又對時脈抖
動敏感的系統架構，規格表如下表所示: 
 
 
15
又因真時電路實現時，量化器的輸出經過數位類比轉換器之後，再回授到入
端，需要花時間去實現，也就是所謂的迴路延遲(excess loop delay)。因本架構取
樣頻率較高，又為維持系統穩定性，我們預留半個週期時間給迴路延遲，原本的
迴路可以等效如下: 
0.5T
 
Fig. 13 系統預留半週期迴路延遲 
 
我們把原本的迴路函數透過Matlab的運算，先經過半週期的d-to-d轉換，然後提
出半個週期之延遲。 
2
1 2
0.79851( 1.6461 0.6964)( )
( 1)( 1.998 1)
Z ZL Z
Z Z Z
− − += − − +
d2d by MATLAB
(sampling time Ts => 0.5TS )
2
0.5 1
1 3 2
0.4319  0.7925 0.3663( ) ( 0.3663 )
2.998 2.998 1
Z ZL Z Z
Z Z Z
− − − + −= − + − + −  
最後因為要在連續時間型實現架構，因此把離散時域(Z domain)對連續時域
(S domain)做轉換 
2
3 14 2 -15
0.7965 0.2623 0.04561
1.428 10 0.008001 8.654 10
S S
S S S−
− − −
+ × + − ×
2
0.5 1
1 3 2
0.4319  0.7925 0.3663( ) ( 0.3663 )
2.998 2.998 1
Z ZL Z Z
Z Z Z
− − − + −= − + − + −
d2c 
 
 
在函數中分母S的二次方項和常數項，因為集數跟其他兩項相差太多，所以
忽略該項，而前面化虛線部分為實現迴路延遲。 
 
 
 
17
f2路徑(紅色路徑)在實現上，則是把它往前拉到積分器之前，但是改以電容方式
連接，如此便可利用電容比例形成的加法器與第三級積分器共用一顆Op_amp，
而不需要在第三級加法器後再做加減。又因實現resonator之回授(綠色路徑)電阻
值通常很大，可以利用Rp與Rn反接的方式去等效實現。 
 
0.18V
+0.18V
+−
+−
+−
+−
ADC
(1bit)
Output+−
+−
+
−
R1 = 10 KΩ
R1 = 10 KΩ
R2 = 10 KΩ
R2 = 10 KΩ
R3 = 10 KΩ
R3 = 10 KΩ
Rrn = 49 KΩ
Rrn = 49 KΩ
C1 = 0.5 pF
C1 = 0.5 pF
C2 = 2 pF
C2 = 2 pF
C3 = 0.5 Pf 
C3 = 0.5 pF
FS = 400 MHz
M
U
X Vref 
Excess loop delay
+ −
DAC1
τ = 1.25 nsIDAC1=73μA
Rf = 14 KΩ
Cf = 0.55 pF
Rf = 14 KΩ
Cf = 0.55 pF
Rrp = 59 KΩ
Rrp = 59 KΩ
M
U
X 
M
U
X 
M
U
X 
 
Fig. 16 迴路函數電路系統圖 
上圖是電路系統圖，其中回授和前饋路徑的係數以Active-RC積分調變器實
現。上述已經說明把其一前饋路經改以電容可以提到第三級積分器之前省掉一個
加法器，關於迴路延遲補償所需的回授路徑，採用一簡單的電路機制可以達到此
回授目的，而不需用加法器去實現。在第三級積分器之後、進入量化器前去做一
路回授相加減，等效上就是把進入量化器的電壓訊號，根據前一次量化器輸出之
結果去加或減ㄧ電壓值。又假設是對訊號做一加電壓動作，等效上可以視為把量
化器內的比較氣參考電壓準位減ㄧ個電壓值。運用此原理，我們可以根據此系統
單位元量化器輸出做一個邏輯去決定比較器的參考電壓，而等效做到迴路延遲補
償路徑回授之功用。透過上訴兩個方法，就可以不必在第三級積分器後面還要去
實現一個加法器了。 
 
2.4.1 全電路實現 
 
 
 
19
 
Fig. 18 Active-RC 積分 
 
Gain
Frequency
High gain 
path
High speed 
path
VDD
VCOM
B0
B0
B2
B2
B2
VIP VINM1 M2
M3 M4
M5 M6
M7 M8
M9
M11
M10
M12
M13
M14
VON VOP
Cf Cf
VDD
B0
B2
VCM
VCOM
VON
VOP
CMFB
900mV
 
Fig. 19  雙路徑 Op_amp 電路及其共模回授電路 
 
Op_amp的電路實現，如上圖所示。其信號放大路徑主要可分成高增益與高
頻寬兩路。高增益路逕由兩級放大器所組成，其中第一級放大器透過簡單的MOS
疊加可以更有效提供增益。外部由大電流的高頻寬路徑所實現，其路徑相加的效
果，使的在中低頻有高增益路徑的特性。但當高頻時，高增益路徑頻寬不夠，當
增益逐漸變小時，則此時換高頻寬路徑的特性展現出來，兩個路徑相加便可得到
高增益與高頻寬的特性。根據在三級積分器上所看到的負載不同，及其補償電容
的不同，分別對三的的積分器及其不同負載模擬如下: 
 
 
21
2.4.4 電流型數位類比轉換器 
本次採用的DAC因為包含傳統NRZ回授和多階回授，固分別採兩種方式實
現 
Active RC integrator with current-steering 
DAC ( NRZ )
Active RC integrator with differential 
current-mode DAC  (RZ)
+ −
+−
Vin+
−Vin
Icom Icom
Idac
BoBo
+ −
+−
Vin+
−Vin
Idac-
Idac+
BoBo
BoBo
 
Fig. 22 兩種形式之電流型數位類比轉換器 
 
   傳統的NRZ會授採用一般差動操作的Current-Steering DAC，其中電流源以
cascode MOS方式達到較高的穩定度。為了避免開關切換，glitch的效應影響到除
在每一個開關下方加入了一個dummy transistor，來減低transient時產生的chare 
injection，而在設計NMOS switch時，考慮切換不完全對於瞬間產生的glitch將無
法改善因此設計 high crossing point。 
Integrator
Current Source
Current Source
VD
D
D1
N
D1P
T
Control signal
V
1.8
0
27u/10u
18u/10u
1u/10u
5u/5u 1u/15u
45u/10u
1u/20u
 
Fig. 23 傳統 Current-steering DAC 
 
    在多階波形回授時，因為每一階為RZ回授方式，所以採用有三組態的RZ回
授型DAC 
 
 
23
比較器參考電壓由量化器輸出結果控制開關切換對一電阻串分壓取電壓值。 
2.5 模擬結果 
2.5.1 全系統電路模擬 
對於整個電路系統的模擬，如線面的幾張圖表所示: 
(a) Fig. 28 是兩種不同回授方式(傳統&多階回授波形)，在不同模擬環境下
的 pri – simulation 頻譜圖: 
105 106 107 108
-140
-120
-100
-80
-60
-40
-20
0
Frequency (Hz)
M
ag
ni
tu
de
 (d
B
)
Continuous-time Delta-Sigma ADC Output Spectrum
 
 
TT27
SS80
FF0
Without proposed technique With proposed technique
105 106 107 108
-140
-120
-100
-80
-60
-40
-20
0
Frequency (Hz)
M
ag
ni
tu
de
 (d
B
)
Continuous-time Delta-Sigma ADC Output Spectrum
 
 
TT25
SS80
FF0
Fin: 3.8 MHz
Condition SNR
TT_27 79.2 dB
SS_80 77.4 dB
FF_0 80.2 dB
Fin: 3.8 MHz
Condition SNR
TT_27 79.4 dB
SS_80 77.1 dB
FF_0 78.2 dB
 
Fig. 27 兩種回授模態在不同 corner 模擬 
 
(b) Fig. 28 是兩種不同回授方式(傳統&多階回授波形)，的 Pre-sim v.s. 
Post-sim 
   頻譜圖 : 
105 106 107 108
-140
-120
-100
-80
-60
-40
-20
0
Frequency (Hz)
M
ag
ni
tu
de
 (d
B
)
Continuous-time Delta-Sigma ADC Output Spectrum
105 106 107 108
-140
-120
-100
-80
-60
-40
-20
0
Frequency (Hz)
M
ag
ni
tu
de
 (d
B
)
Continuous-time Delta-Sigma ADC Output Spectrum
10
5
10
6
10
7
10
8
-140
-120
-100
-80
-60
-40
-20
0
Frequency (Hz)
M
ag
ni
tu
de
 (d
B
)
Continuous-time Delta-Sigma ADC Output Spectrum
105 106 107 108
-140
-120
-100
-80
-60
-40
-20
0
Frequency (Hz)
M
ag
ni
tu
de
 (d
B
)
Continuous-time Delta-Sigma ADC Output Spectrum
Fin: 5 kHz
Pre-simulation
SNDR :75.3dB
Without proposed technique With proposed technique
Fin: 5 kHz
Pre-simulation
SNDR :76.7dB
Fin: 3.8 MHz
Pre-simulation
SNDR :79.2dB
Post-simulation
SNDR :73.1dB
Fin: 3.8 MHz
Pre-simulation
SNDR :79.4dB
Post-simulation
SNDR :76.5dB  
Fig. 28 全電路系統 Pre-sim v.s. Post-sim 
 
 
25
2.5.3 時脈抖動對全電路系統模擬 
另外，我們亦對整個設計的電路系統，做時脈抖對對整個系統效能的模擬。
其在 Matlab Simulink 的環境模擬下，結果如 Fig. 30 所示。從模擬結果可以看
出，本研究提出的方法，的確能有效降低時脈抖動對連續型時間型三角積分調變
器的影響。 
52.40 34.14 200.0 
73.58 40.52 100.0 
75.60 43.24 80.0 
80.24 49.05 40.0 
83.20 54.20 20.0 
84.25 60.64 10.0 
84.85 62.42 8.0 
85.51 68.20 4.0 
86.24 74.81 2.0 
86.37 78.51 1.0 
85.13 80.58 0.8 
85.50 83.53 0.4 
86.04 83.75 0.2 
85.60 84.37 0.1 
86.08 86.03 0.0 
Without 
proposed 
technique 
SNDR(dB)
Without 
proposed 
technique  
SNDR(dB)
Jitter 
Standard 
Deviation 
(ps)
1 10 100
30
40
50
60
70
80
90
 
SN
R
 (d
B
)
Jitter Standard Deviation (ps)
 W/O proposed technique
 W/I proposed technique
 
Fig. 30 全系統時脈抖模擬 
2.6 佈局平面圖 
VC
O
M
VD
D
E_
D
el
ay
VS
SE
_D
el
ay
C
LK
_o
ut
_D
8
C
LK
_o
ut
_D
0
C
LK
_o
ut
VS
SE
_C
LK
_o
ut
VD
D
E_
C
LK
_o
ut
Vout_P
Vout_N 
VDDE_CLK_in
VSSE_CLK_in
D_FF_reset
VDDE_Vout
VSSE_Vout
CLK_in
SIPO
O
P_
B
IA
S1
O
P_
B
IA
S3
O
P_
B
IA
S2
DAC_BIAS1
DAC_BIAS2
Vin_N
Vin_P
VDDE_DAC
VSSE_DAC
DAC_Mode
VDDE_D_logic
VSSE_D_logic
Delay_BIAS1
VS
SE
_I
N
T1
VS
SE
_I
N
T1
VD
D
E_
IN
T2
VD
D
E_
IN
T2
S_CLK_in
S_DOUT
S_
D
AT
A
VS
SE
_L
O
G
IC
VD
D
E_
LO
G
IC
VS
SE
_I
N
T3
VD
D
E_
IN
T3
CLK_control
LOGIC
SIPO
INTEGRATOR
DAC Quantizer
VC
O
M
VD
D
E_
D
el
ay
VS
SE
_D
el
ay
C
LK
_o
ut
_D
8
C
LK
_o
ut
_D
0
C
LK
_o
ut
VS
SE
_C
LK
_o
ut
VD
D
E_
C
LK
_o
ut
O
P_
B
IA
S1
O
P_
B
IA
S3
O
P_
B
IA
S2
VS
SE
_I
N
T1
VS
SE
_I
N
T1
VD
D
E_
IN
T2
VD
D
E_
IN
T2
S_
D
AT
A
VS
SE
_L
O
G
IC
VD
D
E_
LO
G
IC
VS
SE
_I
N
T3
VD
D
E_
IN
T3
Chip Size :
1.2 x 1.2mm2  (40 PAD)
Sampling frequency:
400MHz
SIPO
op op op
R
_1
0K
 
R
_1
0K
 
R
_1
0K
 
R
_4
9K
 
R
_5
9K
  
R_14K 
C
500f
C
550f
C
500f
C2p
NRZ-DAC
Multi-step
DAC
Q 
Delay cell Cap
Delay cell 
Control logic
R
_1
0K
 
R
_1
0K
 
R
_1
0K
 
R
_4
9K
 
R
_5
9K
  
 
Fig. 31 全電路佈局 
 
 
27
3. 利用數位微分技巧減少 DAC 數量及補償迴路延遲之多位元連續
時間型三角積分調變器 
 
3.1  研究動機 
近來發展的趨勢是使用軟體定義無線電(Software Defined Radio, SDR)來操
作不一樣的無線通訊傳輸規格，而且只使用一個在接收機中的類比對數位轉換
器，此類比對數位轉換器，將採用連續時間型的三角積分調變器(Continuous-Time 
Delta-Sigma Modulator)。 
三角積分器有分為連續時間型和離散時間型，在此選取連續時間型，主因是
在高速的取樣頻率下，離散時間型需要在 0.2 個週期內讓積分器的輸出穩定，若
是取樣週期越短，積分器的安定時間則必須越短，因此積分器需要極高的頻寬和
迴轉率(Slew Rate)，造成積分器的高電流消耗，而階數越高，需要更多的積分器，
會造成更大的功率消耗，因此，在高速資料轉換率的需求下，連續時間型是個較
好的選擇。此外，連續時間型在架構上本身就具有抗失真（anti-aliasing）的性質，
故可替接收機省略一個抗失真的濾波器。 
如前段所述，三角積分調變器的發展從離散時間型的三角積分調變器 
(discrete-time delta-sigma modulator)開始，這對於達到高解析度(high resolution)
有很好的提升，但僅適用於頻寬小的信號，接著又演進到連續時間型的三角積分
調變器 (continuous-time delta-sigma modulator)，如此可達到高速操作、低功率和
寬頻信號的需求，除此之外，連續時間型的三角積分調變器 (continuous-time 
delta-sigma modulator) 附有濾波器 (Inherent anti-alias filtering) 的功能在裡頭，
我們可以更簡化整個接收端(Rx)的電路，降低整體功率。 
而連續時間型三角積分調變器，目前一般普遍提出的架構皆以低通三角積分
調變器 (lowpass delta-sigma modulator)為主，已被廣泛的被研究和使用，其操作
方法如下圖，信號經過LNA、BPF，降頻到DC，接著在基頻(baseband)做數位化。 
BPF
Low-IF RX with baseband A/D conversion
LNA
LP 
ΔΣ ADC
LP 
ΔΣ ADC
I
Q
DSP
BasebandFront end Digital domain
Mixer
tcos oω
tsin oω
 
Fig. 32 傳統接收器(Rx)架構圖 
 
利用超取樣(oversample)和雜訊濾波(noise shaping)兩種方法的三角積分調變
器，算 SNR 的公式如下， 
 
        
        N : 量化器的位元數(Number of quantizer bits) 
2 2 1
2
3 2 110log( 2 ) 10log( )
2
N L
peak L
LSNR OSRπ
++= + ×
 
 
29
INPUT + +
‐‐
OUTPUT
1.5 Bit
DAC
LP
Filter
1.5 Bit
DAC
LP
Filter +
‐
4-Bit Flash 
ADC
Digital 
Differentiator 
LP
Filter
 
Fig. 33 二階四位元連續時間型三角積分調變器 
 
我們先把單一路徑的三角積分調變器參數轉換成連續時間的參數，設計流程
如下： 
[步驟一] 根據通訊規格，定義所需要的系統參數 
    本計畫中，除了驗證提出之架構可正常運作之外，也設計符合Bluetooth的通
訊規格，根據規格所需要的SNR和Signal Bandwidth，決定order、Quantizer bit數，
定義出此系統的規格如下表所示： 
 
表 5 系統規格表 
                                                   
有了上述系統規格後，使用MATLAB模擬軟體，輸入synthesizeNTF指令
H=synthesizeNTF(2,32,0,2,0)後產生雜訊轉移函數(NTF) 
2
2
( 1)
0.7639 0.2361
zNTF
z z
−= − +  
由於訊號走過的路徑和雜訊走過的路徑不同，如下圖所示： 
Loop
Filter
L0
L1
Q
U
Y
V
E
 
Fig. 34  DSM 示意圖 
 
 
31
 
Fig. 36 脈衝波形(a)迴路延遲 td; (b)目前有迴路延遲的脈衝波 
(c)平移至下一個取樣週期的脈衝波形 
 
經由上述提及的非線性現象，會造成整個系統穩定性的改變，延遲回路會造
成理想的離散時間三角積分調變器 NTF 的極點位置隨著延遲時間的增加，而逐
漸向單位圓外移動，直接的影響系統的穩定程度還有訊號雜訊比，因此若要維持
系統在運作中能夠保持穩定，迴路延遲時間的設計會是相當重要的。 
    在[1]中提出補償延遲迴路的方法，主要是在訊號進入量化器前，多一路回
授路徑做相減，補償延遲回授訊號，如下圖所示： 
X(s) + + + +
--
sf
s
sf
s
1k 2k fk
dτ
E(z)
Y(z)
-
 
Fig. 37 補償延遲迴路 
 
因此我們在設計系統的 Loop Filter Transfer function 時，必須也要把多加入
的這條路徑參數也考慮進去，如下面式子所示： 
 
 
 
 
 
 
 
可以得到新的
2
'
1 2 2
1 1.236 0.7639 1.7081 1.2361 1.236
2 1 2 1
z z zL
NTF z z z z
− + − += − = = − +− + − +  
我們假設系統可容許 0.5 個週期的延遲迴路效應，使用 MATLAB 指令”d2d”將 z-1
n 1
n 1 1 0
Loop n n 1
n 1 1 0
-1
n 2
1 n 1 1 0
Loop _ delay n n 1
n 1 1 0
n 1
1 n 1 1 0
f n
b z b z b1 NTF( z )H ( z )
NTF( z ) z a z a z a
the existence of loop delay z
b z b z b zH ( z ) z
z a z a z a
b ' z b ' z b '                    = z ( k
z
−
−
−
−
− −
−
−
−
− −
+ + +−= = + + + +
+ + += + + + +
+ + ++ +
L
L
L
L
L
n 1
n 1 1 0
)
a z a z a−− + + +L
 
 
33
 
Fig. 40 規模係數的調整 
 
們可以調整的倍數，此外，在調參數的過程中，我們必須分析動態範圍、
quantization noise以及Thermal noise對系統造成的影響，決定出最適當的電路參
數。在決定好適當的電阻值後，我們借由scaling的調整可以得到整個系統的電路
圖。 
[1]所提出的補償延遲迴路方法是先經由公式推導，在量化器前多增加一路
回授路徑做補償，但是如此一來，便會需要多一個DAC，且在量化器前也需要
多增加一個Summing Amplifier。因此[1]也提出了一個解決此問題的方法，將多
增加的這一路回授路徑往前一個積分器提，這樣便可以省掉Summing Amplifier，
但是由於回授訊號(kf)會比原本走過的路徑多經過一個積分器(1/s)，所以回授訊
號(kf)在進入第二級積分器前，必須要先經過一次微分(s)，如下圖所示： 
+ + + +
--
sf
s
sf
s
1k 2k fk
dτ
E(z)
Y(z)
-
X(s)
+ + +
--
sf
s
sf
s
1k 2k
fk
dτ
E(z)
Y(z)-X(s)
s
 
Fig. 41 補償延遲迴路之改善方法 
 
對類比訊號做微分在實際電路實作上並不容易，因此我們用數位微分(1-z-1)
的方法來取代，在頻率相對低的情況下，1-z-1可近似為s。數位微分的方法是將
前一次的資料先暫存起來，再與現在的資料做相減(比較大小)。由於這樣的技巧
用在量化器輸出端，可以大幅減少輸出code的範圍(在相鄰兩次週期內，量化器
的輸出結果相差僅一個位元)，也就是減少DAC回授量。我們將整個數位微分器
往外提至量化器的輸出端，在k1(k2)回授路徑加上一個積分器維持和原本路徑一
樣，系統電路如下圖所示： 
 
 
35
 
Fig. 44  積分調變器 unit-gain frequency 對於不同積分調變器增益以及 Opamp 
unit-gain frequency 之變化 
 
以發現，如果要使得系統中積分調變器的 unit-gain frequency(fu)大於 90%以上(接
近理想的積分調變器)，那麼當積分調變器增益(k)越小時，Opamp 的 GBW 要求
則越低，系統相對也就省功率，但是帶小會造成 input-referred noise 因增益過小
無法被有效減少，不過因為關於 noise 分析在之前已經分析過，所以這樣的參數
設計是合理的推斷。因此，在本系統的 Opamp 設計上，我們取積分調變器增益
最大的值為 0.9，那麼理論上 Opamp 的 fu 則應該是 fs 的 3 至 4 倍，因此我們可以
初步推算 Opamp 的規格，詳細的設計將會在後面做討論。 
透過以上的系統參數設計，使用 MATLAB Simulink 做初步的模擬結果如下： 
Proposed ADC
SNR = 75 dB
10-2 10-1 100 101
-200
-180
-160
-140
-120
-100
-80
-60
-40
-20
0
Frequency (MHz)
M
ag
ni
tu
de
 (
dB
)
Continuous-time Delta-Sigma ADC Output Spectrum
10- 2 10- 1 100 101
-200
-180
-160
-140
-120
-100
-80
-60
-40
-20
0
Frequenc y (MHz)
M
ag
ni
tu
de
 (
dB
)
Continuous-time Delta-Sigma ADC Output Spectrum
SNR = 76dB
Conventional ADC
 
Fig. 45  MATLAB Simulink 模擬結果 
     
    由上圖可知，此計畫所提出的架構實現結果和傳統架構在相同規格下所模擬
的結果大致相同。而四位元量化器的輸出經過數位微分器(1-z-1)的結果如下圖所
示，變化範圍在-1,0,1 之間，等效上是用 1.5-Bit 來控制接下來的 DAC。 
 
 
37
VCMFB
VBIAS1
VBIAS1
Vinp Vinn
Voutn Voutp
VDD
High Gain Path
Gain
Frequency
High Speed Path
Gain
Frequency
Inner path realizes the
high DC gain
Outer path assures the 
high frequency operation
70μA
890μA
30/0.5
M=3
40/1
0.5pF
5k
12/2
M=2
10/1
35/1
M=4
28/1
M=6
VOP
VON
B0
Voutn
Voutp
 
Fig. 48  2-stage Opamp with RC compensation and CMFB 
 
   在此Feedforward放大器架構中，內側路徑為主要高增益的來源，而高頻寬路
徑主要是外側路徑提供，output swing，大概1.2V左右。圖十八為三種模擬環境
以及電流消耗。 
Specification
Supply 1.8V
gain 60 dB
GBW 240 MHz
PM 89
Loading(C/R) 4 pF/4kO
power 1.9 mW  
表 6  Opamp 規格列表 
 
 
Fig. 49  Opamp 在不同 corner 模擬圖  
 
 
39
Vin>Vref
tt270
429ps
 
Vin>Vref
ss800
589ps
 
Vin>Vref
ff00
297ps
 
Fig. 51 動態比較器在不同 corner 模擬值 
 
 
41
 
state D0 D1 Output current (Iout+)
-1 0 1 -10♠A
0 0 0 0
1 1 0 10♠A
 
 
Fig. 54  1.5-Bit DAC 三種狀態 
 
 
Fig. 55  DAC 輸出共模電壓 (亦即回授積分器的輸入共模電壓) 
 
每一個 current source 皆採用 Cascode 的方法來增加等效輸出阻抗，來維持
current level 的穩定性，關於 DAC bias MOS 大小的決定，主要受制於整個 ADC
的 resolution 以及不同製程的要求，以及考慮 thermal noise 的效應。 
關於switch的MOS大小也必須要設計得當，由圖二十二中，每一次切換開關
的同時，為了避免glitch的效應過影響到系統問定度，我們考慮了以下幾個要素。
在每一個開關下方加入了一個dummy transistor，來減低transient時產生的glitch，
另一方面switch的crossing point點也必須要注意，否則切換不完全對於瞬間產生
的glitch將無法改善。 
 
 
 
43
3.3.4  數位微分器(1-z-1) 
  此塊數位電路主要是先用DFF記錄前一次量化器輸出，以及現在的量化器輸
出，之後再做相減的動作。傳統上相減的做法是用XOR的邏輯閘來判斷兩次輸
出比較，若是相同(表示此次與前次的輸出結果一樣)，則輸出為0；若是不同(表
示此次與前次的輸出結果有變化)，則輸出為1。但是在我們的架構中，除了要判
斷此次與前次的輸出結果是否有變化之外，還要判斷是變大(1)或變小(-1)，因此
我們把XOR的邏輯運算拆開來看，假設前一次量化器的輸出資料叫做A，這一次
量化器的輸出資料叫做B，則當A’B的結果為1，表示B比A大，此時AB’的結果是
0；同理，當A’B的結果為0，表示A比B大，此時AB’的結果是1，如下表所示： 
當A<B A’B AB’ 
A(3) 0000 0000 0000 111 
B(4) 0000 0000 0001 111 
0000 0000 0001 000 0000 0000 0000 000 
 
當A>B A’B AB’ 
A(5) 0000 0000 0011 111 
B(4) 0000 0000 0001 111 
0000 0000 0000 000 0000 0000 0010 000 
透過A’B和AB’這兩個訊號，可以幫助我們判斷前一次和現在的量化器輸出結果
相差多少，也可以判斷是變大或變小，詳細電路圖如下所示： 
4-Bit
Quantizer
15
Q
Q
D
CK
Q
Q
D
CK
..
.
Fs (CKQ=64MHz)
B0
B14
A0
A14
A　
A14
B14
A　
A0
B0
... D0
AB
A14
B14
AB
A0
B0
... D1
A  Bank　
AB?Bank  
Fig. 58 數位電路架構圖 
 
3.4 模擬結果與電路佈局圖 
3.4.1  Transistor Level 模擬 
進行完電路分析，我們觀察實際電路模擬的頻譜圖，首先先看全電路系統模
擬在重要的corner環境下的結果，如下圖所示： 
 
 
45
3.4.2 電路佈局圖 
主要分為三個power domain，分別為Analog domain、Digital domain、Buffer 
domain，共使用了34個PAD，Chip Size 為1.25 x 0.97 mm2，佈局如下圖所示： 
LP 
Filter1
LP 
Filter2
LP 
Filter3
DAC1
DAC2
Digital
Circuit
4‐Bit
Quantizer
Clock
Buffer
O
P 
B
ia
s3
OP Bias1
VIP
VIN
VCM
VDDA
GNDA
C
A
P_
1
C
A
P_
2
C
A
P_
3
C
A
P_
4
C
A
P_
A
C
A
P_
D
C
A
P_
B
C
A
P_
C
VD
D
A
G
N
D
A
D3
D2
D1
D0
CLK_OUT
VDDB
GNDB
D
A
C
1_
PB
ia
s
D
A
C
1_
N
B
ia
s
D
A
C
2_
PB
ia
s
D
A
C
2_
N
 B
ia
s
G
N
D
A
VD
D
D
G
N
D
D
CL
K_
IN
VC
TR
L
OP Bias2
 
Fig. 60  Floor Plan 
 
 
Fig. 61  Full Chip Layout 
 
 
47
好前面數位電路的計算時間，那麼就會使整個系統的SNDR降低。 
105 106 107
-120
-100
-80
-60
-40
-20
0
Frequency (Hz)
M
ag
ni
tu
de
 (d
B
)
Continuous-time Delta-Sigma ADC Output Spectrum
0 0.5 1 1.5 2 2.5 3
x 107
-120
-100
-80
-60
-40
-20
0
Frequency (MHz)
M
ag
ni
tu
de
 (d
B
)
Continuous-time Delta-Sigma ADC Output Spectrum
 
(a) Pre-layout simulation 
0 5 10 15 20 25 30
-140
-120
-100
-80
-60
-40
-20
0
Frequency (MHz)
M
ag
ni
tu
de
 (d
B
)
Continuous-time Delta-Sigma ADC Output Spectrum
10
-1
10
0
10
1
-140
-120
-100
-80
-60
-40
-20
0
Frequency (MHz)
M
ag
ni
tu
de
 (d
B
)
Continuous-time Delta-Sigma ADC Output Spectrum
 
(b) Post-layout simulation 
Pre-sim Post-sim
SNDR (dB) 74 71
Parameter Value
Input signal 300 kHz
Sampling frequency 64 MHz
FFT 2048 points
 
Fig. 63 全電路系統 Pre-sim v.s. Post-sim 
 
 
49
4 具被動延遲迴路補償技術之連續時間三角積分調變器 
4.1 研究動機 
 由於連續時間三角積分調變器是以Active-RC的方式實現loop filter，相較於
離散時間三角積分調變器中的運算放大器，必須對電容充放電，連續時間三角積
分調變器可以操作在比較低的功率以及高的速度，但是也產生了新的問題，叫做
過迴路延遲(excess loop delay)，因為操作的頻率比較高，所以電路反應的時間對
系統的影響便不能忽視，隨著操作頻率逐步提升，此問題也越來越嚴重，在此研
究當中，便提出了一個與以往不同的方式補償電路所造成迴路的延遲。 
4.2 問題描述與解決方法 
在我們所提出的架構，在 Fig. 64中，使用數位的濾波器來消除excess loop 
delay effect，這樣使用靜態的數位邏輯電路來代替移掉在靜態操作的的補償DAC
和summing amplifier，最後達成降低功率消耗的目的。  
當類比電路設計完成以後，電晶體層次設計都完成，也達到設計規格時，再
把後端的數位電路一起加進來模擬，當數位電路很大時，使用RTL code來加入電
路圖來進行整合型的模擬，若是數位電路很小時，Gate level的寫法會比較節省邏
輯閘，也就是會節省功率面積等等。 
 
3-Bit
Qx(t)
y(n)1b
S
DAC
1a 2a
Σ Σ 2bS
Correction Circuit  
 
Fig. 64 在迴路使用數位校正電路來修正迴路延遲效應 
而在Fig. 65中，loop delay用e-sτ來表示，若我們可以製造出esτ的數位電路的話則，
DAC waveform可以看到完美的H(s)，由此方法可以消除loop delay所製造出來的
問題。 
 
H(s)esτ y[n]y(t)e
-sτ
Loop DelayCompensated 
circuit
τ 1+τ0
1
 
Fig. 65 含有迴路延遲和補償的系統方塊圖 
 
 
51
2048FFT Point
0.5 cycleDelay
16OSR
55.2 dBSNDR
10 MHzSignal Bandwidth
300 mVPeak Amplitude
320 MHzSampling Frequency
 
 Fig. 68 效能總結 
4.4 結論 
                   面對連續時間型三角積分器所遇到的excess loop delay非理想效應，我
們提出了有別於傳統加上位於quantizer之前的DAC和summing amplifier的技術，
來降低excess loop delay非理想效應對loop的影響，移除了這兩個主動元件，可以
有效的降低功率消耗，達成我們所想要的高速寬頻且低功率的需求，亦即有效降
低Figure of Merit (FoM)，這個項目評比指標。 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
53
fRF
Wide Band for RFSliding Low-IF
DVB-T GSM-EDGE
 
Fig. 70 三角積分調變器運用於可調整式數位低中頻取樣無線接收機 
 
    在功率調整的技術上，我們考量到 opamp 的調整機制，透過三種不同的操
作頻率之下我們使用三種切換檔位來讓整個系統的 FoM 最佳化，詳細的介紹將
在報告後面作分析。 
 
Fig. 71 可調整檔位之運算放大器示意圖 
 
  在此計畫中，主要是針對三種不同的規格下，不但能達到很好 IRR(>50dB)，
更希望可以讓每一種規格的 FOM(pJ/conv)低於 1 pJ。達到功率最佳化的效果。 
 
5.2 GSM/WCDMA/DVB-T 三模式調變器架構介紹以及選擇 
    本節中開始將雙模式三角積分調變器的架構設計作一個分析。本研究中，
採用了連續時間(Continuous-time)單一回路(single-loop)、四位元(4 multi-bit)量化
器以及切換不同中心頻段cross-coupling的開關來作為模態的轉換。連續時間的選
擇，主要是因為傳統離散時間(Discrete-time)在積分調變器的功率消耗上，會比連
續時間三角積分調變器高出二至三倍，為了降低功率消耗，因此選擇連續時間的
架構。對於調變器階數的選擇，本研究針對兩種模態都選擇兩階作為架構，一般
來說，三階以上的調變器對穩定度的要求比較嚴格，同時也因為會運用到較多積
分調變器，相對而言會比較耗電。針對GSM/WCDMA/DVB-T三種規格來說，兩
階多位元的架構就可以滿足規格上的要求，在下列數學式子中可以推得各項系統
參數對於SNR的關係 
 
 
 
55
1M~10M 1M~10M
4-
Sw
itc
h
D
A
C
1
4-
Sw
itc
h
D
A
C
1
INPUT
4-BIT Flash
ADC
4b
Pseudo-random
Quadrature
Mismatch 
Shaping
Wide Range Central Frequency
DEM
 
Fig. 72  GSM/WCDMA/DVB-T 連續時間四相位雙模式三角積分調變器系統圖 
    上圖中，我們先按照前一節的方式把單一路徑的三角積分調變器參數轉換
成連續時間的參數，接下來我們靠著圖6.13的C1以及C2不同的電阻組合開關來作
切換低中頻位置。在低中頻的模式中，我們將頻帶選擇在不同的中心頻段位置，
而相對應的交互耦合係數則如下式以及圖6.13所示 
 
                                    
 
 
Fig. 73 交互耦合係數 C1 以及 C2 的選擇 
 
    在所有系統參數設計完成後，接下來進行實際電路的參數轉換(包含電阻、
電容、DAC回授電流)。本次研究中，我們所選擇的積分調變器為Active-RC積分
調變器圖6.14，相較於gm-C積分調變器，Active-RC積分調變器的線性度是由
Opamp輸出端的動態範圍所控制，只要Opamp設計得當，系統的穩定度相對較容
易達成，此外對於每一級的輸入端都可視為虛接地(Virtual ground)，對於DAC回
授信號的穩定度影響也最小。 
    積分調變器的型式選定後，在所有係數轉換成電阻電容以及回授電流量值
時，我們必須考慮每一級輸出的動態範圍是否在設計的範圍內，使得整個系統可
 
 
57
VDD
VNB0VP
VON VOP
B0
B1
VCMFB
B2
B3 B3
A B
       
VOP
VON
B0
 
Fig. 75 2-stage Opamp with RC compensation 
最大電流量的兩倍(DAC unit=4uA, total current=60uA)[ref.]，在此Feedforward放
大器架構中，內側路徑為主要高增益的來源，藉由Cascoded P/MOS 如下圖
High Gain Path
VDD
VNB0VP
VON VOP
B0
B1
VCMFB
B2
B3 B3
A B
 
Fig. 76 高增益以及高頻寬路徑示意圖 
 
藍色路徑所示，而高頻寬路徑主要是由紅色線條提供，為了府合不同規格操作在
不同曲樣頻率條件下，我們提出了三個stage在外側的路徑上作模態的切換，如下
圖所示 
 
 
59
tt 27 GSM WCDMA DVB-T
Gain 
(dB) 92.49 97.85 100.8
PM (°) 66 77 88
GBW 
(Hz) 69 M 180 M 340M
GSM (Fs=51.2MHz)
WCDMA (Fs=160MHz)
DVB-T (Fs=240MHz)  
(a) 
ff 0 GSM WCDMA DVB-T
Gain 
(dB) 90.8 95.92 98.6
PM (°) 65 72 89
GBW 
(Hz) 75 M 200 M 370M
GSM (Fs=51.2MHz)
WCDMA (Fs=160MHz)
DVB-T (Fs=240MHz)  
(b) 
ss 80 GSM WCDMA DVB-T
Gain 
(dB) 88.93 94.31 97.25
PM (°) 70 78 89
GBW 
(Hz) 57 M 150 M 300M
GSM (Fs=51.2MHz)
WCDMA (Fs=160MHz)
DVB-T (Fs=240MHz)  
 (c) 
 
Fig. 78 Opamp 在不同模態以及不同 corner 模擬值  
(a)tt 27 (b)ff 0 (c)ss 80 
 
 
61
 
Fig. 80 動態比較器在不同 corner 模擬值 
 
5.4.1.3  Current-Steering DAC 
 
Fig. 81   4-Stage current-steering DAC 
 
每一個 switch 皆採用 Cascode 的方法來增加等效輸出阻抗，來維持 current 
level 的穩定性，透過 Thermometer code 將 4-bit 信號透過 DAC 回授至每一級
Opamp 的輸入端，關於 DAC bias MOS 大小的決定，主要受制於整個 ADC 的
resolution 以及不同製程的要求，考慮 mismatch 以及 thermal noise 的效應，決定
出 Bias MOS 的 Size 大小如下式 
7~11 μA 
7~11 μA 
 
 
63
Q_NI_N Q_P
Vbias1
Vbias2
I_P
Control signal at low 
Crossing point
 
Fig. 83  DAC switch 使用 low crossing point 控制電路 
 
5.4.2 數位校正電路 
  系統後端的數位校正電路部分，主要設計目標是能夠讓回授DAC經過一連
串的單位選擇後，透過I/Q路徑的 Quadrature Mismatch Shaping 的效果，來達成
提升IRR的效果。如圖6.30所示，下面為設計說明 
Complex
DACs
Quadrature
Bandpass
Loop Filter
H(s)
DEMi
4 YI,DEM [n]
YQ,DEM [n]
XI (t)
XQ (t) DEMq
4
Pseudo-random
Quadrature 
Mismatch 
Shaping
Yswapped, I (t)
Yswapped, Q (t)
Complex 
I/Q DAC unit
Selection
YI,PQMS [n]
YQ,PQMS [n]
Complex
DACs
 
Fig. 84 系統後端數位校正電路 
 
5.4.2.1  Quadrature Mismatch Shaping 之技術  
    本節中我們將介紹如何實現 I/Q 通道選擇演算法以及數位電路實現。首先
我們設計兩種信號來控制4-stage switch的開關，透過經由IDWA輸出的信號產生
Selection(S)信號，如下表所示 
 
表 12 經由 IDWA 產生的 Selection 信號 
 
    接下來為了能夠讓 I/Q 通道選擇平均化，設計一組 clock 信號 C 如下圖
能夠隨著每次一碰到取樣信號的 rising 時，即改變控制信號。 
 
Fig. 85 隨著取樣信號改變的控制信號 C 
 
 
65
在整個I/Q 通道選擇的過程中，大概需要500ps 來作運算，也合乎對於延遲
回路的設計範圍。經由運作如下分析：
    
藉由平均化的過程中夠將電路中造成I/Q DAC 造成的不匹配效應達到很好的消
除效果。 
 
5.5 模擬結果 
5.5.1 Transistor Level 模擬結果 
進行完電路分析，我們觀察實際電路模擬的頻譜圖，可以發現Pre-sim和
Post-sim的誤差並不大，除了有些諧次波影響外，基本上在in-band的想並不大。
事實上類比電路的部分除了DAC對於系統的影響較大之外，後端數位電路的延
遲也需要注意，在本次設計上控制在0.25～0.2 Ts的loop delay，由後端許多驅動
信號的 DFF作同步的動作，倘若一個rising時間點並未估計好前面數位電路的計
算時間，那麼整個系統的SNR就會降低，因此時間點的設計的調整將變得相當重
要。 
I/Q 路徑存在之誤差 
 
 
67
Pre-simulation
WCDMA  Mode for Fin=4MHz BW=5MHz 
with 2048 points FFT
SNR=65 dB IRR>50dB
Post-simulation
WCDMA  Mode for Fin=4MHz BW=5MHz 
with 2048 points FFT
SNR=63 IRR>50dB
0 2 4 6 8 10 12 14 16
x 106
-120
-100
-80
-60
-40
-20
0
Frequency (MHz)
M
ag
ni
tu
de
 (d
B)
Continuous-time Delta-Sigma ADC Output Spectrum
0 2 4 6 8 10 12 14 16
x 106
-120
-100
-80
-60
-40
-20
0
Frequency (MHz)
M
ag
ni
tu
de
 (d
B
)
Continuous-time Delta-Sigma ADC Output Spectrum
105 106 107 108
-120
-100
-80
-60
-40
-20
0
Frequency (MHz)
M
ag
ni
tu
de
 (d
B)
Continuous-time Delta-Sigma ADC Output Spectrum
105 106 107 108
-120
-100
-80
-60
-40
-20
0
Frequency (MHz)
M
ag
ni
tu
de
 (d
B
)
Continuous-time Delta-Sigma ADC Output Spectrum
-8 -6 -4 -2 0 2 4 6 8
x 107
-120
-100
-80
-60
-40
-20
0
Frequency (Hz)
M
ag
ni
tu
de
 (d
B)
Continuous-time QBP Delta-Sigma ADC Output Spectrum
-8 -6 -4 -2 0 2 4 6 8
x 107
-120
-100
-80
-60
-40
-20
0
Frequency (Hz)
M
ag
ni
tu
de
 (d
B
)
Continuous-time QBP Delta-Sigma ADC Output Spectrum
 
Fig. 89  WCDMA Fs=160MHz Mode Pre-sim v.s. Post-sim 
 
 
 
69
GSM/WCDMA
DVB-T
ΔΣ ADC modulator 
chip
Quadrature
Signal
Generator
(Agilent 
81150A)
0°
90°
180°
270°
Sampling
Clock Generator
(Agilent E4438C)CLK=51.2MHz
CLK=160MHz 4-bit-streams
I-path
Q-path
Logic 
Analyzer 
(Tektronix 
TLA5203B)
Supply and reference
voltage generator 
(Agilent E3646A)
MATLAB
FFT
65536 point
VD
D
G
N
D
VC
O
M
VR
EF
Sampling
Clock for LA
Sampling Rate SwitchState Standard
51.2 MHz S1 ON GSM
160 MHz S2 ON WCDMA
240 MHz S3 ON DVB-T
CLK=240MHz
 
Fig. 91  量測儀器架設: 四相位差動輸入量測裝置 
 
頻率以及開關的切換，用邏輯分析儀Tektronix TLA5203B 量得數位I/Q 4-bit信號
後最後透過MATLAB運算最後得到第一種量測環境下輸出的頻譜。 
 
Fig. 92 量測儀器架設: 四相位差動輸入量測裝置 
 
為了量測調變器的線性度，觀察其他干擾信號對於in band的distortion影響，
我們必須作two-tone 的量測。Inter-modulation distortion(IMD)經由換算之後可以
 
 
71
Spec. GSM-EDGE UMTS DVB-T
Channel 
Bandwidth 200kHz 5 MHz 8 MHz
Sampling 
Frequency 51.2 MHz 160 MHz 240 MHz
SNR 83 dB 63 dB 62 dB
Power
Opamp 01.2m
DAC 0.67m
Comp 0.37m
Digital 0.45
Current 2.7mA
Power 4.9mW
Opamp 2.4m
DAC 0.65m
Comp 1.1m
Digital 1.2m
Current 5.4mA
Power 9.63mW
Opamp 3.2m
DAC 0.65m
Comp 1.77m
Digital 1.85m
Current 7.5mA
Power 13.5mW
IRR >50 dB
FOM
(pJ/conv) 1.06 (51.2) 0.82 (160)                        0.8 (240)
 
表 13 Performance Summary (GSM/WCDMA/DVB-T Mode) 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
73
參考文獻(Reference) 
[1] Stephen A. Jantzi,Kenneth W. Martin, Adel S. Sedra, “Quadrature Bandpass 
Modulation for Digital Radio,” IEEE J. Solid-State Circuits, vol. 32, no. 12, Dec 
1997. 
[2] James A. Cherry, W. Martin Snelgrove, “Excess Loop Delay in Continuous-Time 
Delta–Sigma Modulators” IEEE Trans. Circuits Syst. II, Anal. Digit. Signal 
Process.,vol. 46, no. 4, Apr 1999. 
[3] Frank Henkel, Ulrich Langmann, André Hanke, Stefan Heinen, Elmar Wagner 
“A 1-MHz-Bandwidth Second-Order Continuous-Time Quadrature Bandpass 
Sigma–Delta Modulator for Low-IF Radio Receivers,” IEEE J. Solid-State 
Circuits, vol. 37, no. 12, Dec 2002. 
[4] Jesus Arias, Peter Kiss, Vladimir Prodanov, Vito Boccuzzi, Mihai, David Bisbal, 
Jacinto San Pablo, Luis Quintanilla, and Juan Barbolla, “A 32-mW 320-MHz 
Continuous-Time Complex Delta-Sigma ADC for Multi-Mode Wireless-LAN 
Receivers,” IEEE J. Solid-State Circuits, vol. 41, no. 2, Feb 2006 
[5] M.-C. Tsai and T.-H. Lin, “Design of a Continuous-Time 3rd-Order Delta-Sigma 
Modulator with Incremental Data Weighted Averaging,” IJEE, vol. 14, no. 3, pp. 
157-165, June 2007.  
[6] Stijn Reekmans, Jeroen De Maeyer, Pieter Rombouts, Ludo Weyten, ” 
Quadrature Mismatch Shaping for Digital-to-Analog Converters,” IEEE Trans. 
Circuits Syst. I.: REGULAR PAPERS, vol. 53, no. 12, Dec 2006 
[7] Lucien J. Breems, Eise Carel Dijkmans, Johan H. Huijsing, “A Quadrature 
Data-Dependent DEM Algorithm to Improve Image Rejection of a Complex ΔΣ 
Madulator," IEEE J. Solid-State Circuits, vol. 36, no. 12, Dec 2001 
[8] Chi-Tung Ko, Kong-Pang Pun, “A DEM Scheme for I/Q Mismatch 
Compensation in Multi-Bit CT ΔΣ Modulator, ” Circuits and Systems, 2007. 
ISCAS 2007. IEEE International Symposium on 27-30 May 2007 Page(s):245 - 
248  
[9] Richard Schreier, “An Empirical Study of High-Order Single-Bit Delta-Sigma 
Modulators,” IEEE Trans. Circuits Syst. II, Anal. Digit. Signal Process, vol. 40, 
no. 8, Aug 1993 
[10] Yi Ke, Jan Craninckx, Georges Gielen, “A Design Approach for 
Power-Optimized Fully Reconfigurable ΔΣ A/D Converter for 4G Radios, ” 
IEEE Trans. Circuits Syst.—II: EXPRESS BRIEFS, vol. 55, no. 3, Mar 2008 
[11] Samid, L., Volz, P., Manoli, Y., “A dynamic analysis of a latched CMOS 
comparator,” 2004 ISCAS '04. Proceedings of the 2004 International Symposium 
on Volume 1, 23-26 May 2004 Page(s):I-181-4 Vol.1  
[12] F. Gerfers, M. Ortmanns, Y. Manoli, “A 1.5-V 12-bit Power-Efficient 
 
 
75
[23]  J. De Maeyer, P. Rombouts, and L. Weyten, “Nyquist-criterion based design of 
    a CT ΔΣ-ADC with a reduced number of comparators,” in Proc. IEEE ICECS, 
  2006, pp. 411–414. 
[24]  T. Song, Z. Cao, and S. Yan, “A 2.7-mW 2-MHz continuous-time ΔΣ  
Modulator with a hybrid active-passive loop filter,” IEEE J. Solid-State 
Circuits, vol. 43, no. 2, pp. 330–341, Feb. 2008 
[25]  L. H. Corporales, E. Prefasi, E. Pun, and S. Patón, “A 1.2-MHz 10-bit 
Continuous-Time Sigma–Delta ADC Using a Time Encoding Quantizer,” IEEE 
TCAS-II, vol. 56, no.1, Jan. 2009. 
[26] M. Z. Straayer and M. H. Perrott, “A 12-Bit, 10-MHz Bandwidth, 
Continuous-Time ΔΣ ADC With a 5-Bit, 950-MS/s VCO-Based Quantizer,” 
IEEE J. Solid-State Circuit, vol. 43, pp. 805-815, Apr. 2008. 
[27] Lukas Dörrer et al., “A 3-mW 74-dB SNR 2-MHz Continuous-Time 
Delta-Sigma ADC With a Tracking ADC Quantizer in 0.13-um CMOS,” IEEE 
J. Solid-State Circuit, vol. 40, pp. 2416-2427, Dec. 2005. 
[28] S. Ouzounovl, R. van Veidhoven, C. Bastiaansen, K. Vongehrl, R. van Wegberg, 
G. Geelen, L. Breems, A. van Roermund,“A 1.2V 121-Mode CT DS modulator 
for wireless receivers in 90nm CMOS,” in IEEE ISSCC Dig. Tech. Papers, pp. 
242–243, Feb. 2007.  
[29] Hairong Chang and Hua Tang , “A simple technique to reduce clock jitter effects 
in continuous-time delta-sigma modulators,” IEEE International Symposium on 
Circuits and Systems, pp. 1870-1873, May. 2008. 
[30] P. M. Chopp and A. A. Hamoui, ” Analysis of clock-jitter effects in 
continuous-time DS modulators using discrete-time models ,” IEEE Trans. 
Circuits Syst. I, Reg. Papers, vol. 56, pp.1134-1145, Jan. 2009. 
[31] J. A. Cherry and W. M. Snelgrove, ”Excess loop delay in continuous-time 
delta-sigma modulators”, IEEETrans. Circuits Syst. II, vol. 46, no. 4, pp. 
376-389, Apr. 1999. 
[32] H. Farkhani, M. Meymandi-Nejad, and M. Sachdev, “A fully digital ADC using a 
new delay element with enhanced linearity,” IEEE Symp. Circuits Syst., pp. 
2406–2409, May 2008. 
[33] Sheng-Jui Huang, Yung-Yu Lin, "A 1.2V 2MHz BW 0.084mm^2 CT sigma-delta 
ADC with -97.7dBc THD and 80dB DR using low latency DEM", in IEEE 
ISSCC Dig. Tech. Papers, February 2009. 
[34] M. Z. Straayer and M. H. Perrott, “A 12-Bit, 10-MHz bandwidth, 
continuous-Time ΔΣ ADC with a 5-bit, 950-MS/s VCO-based quantizer,” IEEE J. 
ISCAS’2010
5 30 6 2
International Symposium on Circuits and Systems (ISCAS)
ISCAS
(Advanced Data Converter Design)
(SNR)
(Headroom)
(Body Biasing Technique)
A 5-GHz Fractional-N Phase-Locked Loop With Spur
Reduction Technique in 0.13- m CMOS
Wei-Hao Chiu, Chien-Yuan Cheng, and Tsung-Hsien Lin
Graduate Institute of Electronics Engineering and Department of Electrical Engineering
National Taiwan University, Taipei, Taiwan
ABSTRACT-This work proposes a fractional phase error
compensation approach for a classical fractional-N phase-
locked loop (PLL) to reduce fractional spurs. The proposed
corresponding-phase compensation technique incorporates a
divider array and an auxiliary charge pump pair to overcome
the fractional phase error. The main advantage of the
proposed fractional-N PLL is that it only uses a constant
compensation ratio when being a desired divide ratio. This
PLL is fabricated in the TSMC 0.13- m CMOS process. The
total power consumption is about 17 mW. The measured
results show that, with the proposed corresponding-phase
compensation technique, the fractional spurs are reduced
under classical fractional-N PLL.
I. INTRODUCTION
PLLs are widely utilized in various communication
systems. With the demand among different applications,
PLL must offer the main capabilities of fast-settling time,
good noise performance, and accurate frequency resolution.
Usually, due to the tradeoff between better frequency
resolution and loop bandwidth, fractional-N PLL is a better
candidate than integer-N PLL. Fractional-N PLL is able to
accommodate high frequency resolution under various
reference frequencies. Moreover, it often has a wider loop
bandwidth since the higher reference frequency does not
impact frequency resolution seriously. Thus, the settling
time is decreased.
A classical fractional-N PLL is shown in Fig. 1 whose
concept is to replace a fractional divide ratio by the average
of different integer divide ratios. Unfortunately, serious in-
band spurs occur in this concept. As mentioned in [1], even
this loop had averaged integer divide ratio, a varied voltage
ripple on loop filter (LPF) occurs because the divider could
not produce a fractional divide ratio in each reference cycle.
This periodical voltage ripple then leads to be in-band
fractional spurs on the output spectrum. An intuitional
solution to deal with this problem is utilizing a higher order
modulator [2]. Via the dithering, modulator achieves
a substantial reduction on fractional spurious tones and
shapes the quantization noise to high-frequency offsets;
hence the low-frequency in-band signal-to-noise ratio (SNR)
is improved. However, this structure is often sensitive to the
non-linearity effect. If non-linearity exists in a
fractional-N PLL system, the quality of noise shaping is
corrupted. The modulated quantization noise will be folded
back to lower frequencies, and degrades the SNR [2].
Additionally, this loop still suffers from the elevated
quantization noise once the loop uses a large bandwidth.
This makes the loop can not eliminate quantization noise.
N/N+1
FREF Fout
FDIV
VCTRL
UP
DN CP/LPFPFD
Accumulator
Channel Selection
Total averaged charge is zero
FREF
FDIV
FOUT
ICP
VCTRL
4 4 4 5 4 4 4 5 45
Periodical charge is non-zero
Fig. 1 A classical fractional-N PLL structure
Under this consideration for noise-bandwidth tradeoff,
an alternative is to compensate the periodical phase error
directly [1], [3-4]. As shown in Fig. 2, a digital-to-analog
converter (DAC) is adopted to produce a proper charge for
cancelling unwanted error charge in each reference cycle.
Since the error charge is mitigated, the periodical voltage
ripple is avoided.
N/N+1
FREF FOUT
FDIV
VCTRL
UP
DN LPFPFD
Accumulator
Channel Selection
CP
DAC
IDAC
ICP
Fig. 2 A DAC compensation fractional-N PLL structure
Nevertheless, in particular, this approach is also
sensitive to the linearity of DAC and the accuracy of
prediction charges because the periodical phase error is
continuously accumulated by fractional phase error. That
causes the phase error to be varied in each reference cycle.
So, the compensation circuit must produce different charges
in different reference cycle to cancel the error charge. Once
mismatch occurs in either DAC or prediction table, it would
fail to address the in-band fractional spurs. To avoid
mismatches, several works point out that auxiliary
calibration approach can be adopted to solve the mismatches
Here, due to the operating principle of the pulse-swallow
counter, this prescalar must provide the divided signals on
different divide ratio for each pulse-swallow counter.
Besides, this prescalar should support the corresponding
phase for the proposed concept. The way to do so in this
work is constructing a synchronized prescalar which is
depicted in Fig. 6. This synchronized prescalar contains a
phase generator and phase selection module. The phase
generator is designed as Fig. 7, it generates five signals on
different phases, and there is an interval of one VCO cycle
time between each phase. In this work, these signals are
utilized to realize a frequency divider with providing
different divide ratio.
Phase Generator
FOUT
5
1
Divided by 5: Does not shift
Divided by 6: 1 2 3 4 5 1
1
5
Shift-Register-I
DIV(SYN) 1
5
Shift-Register-II
DIV(N) 1
5
Shift-Register-III
DIV(N+1)
SYN(DIV)
MUX MD(SYN) MUX MD(N) MUX MD(N+1)
Fig. 6 The circuit structure of synchronized divider
FOUT
35241
FOUT FOUT FOUT FOUT
FOUT FOUT FOUT FOUT FOUT
Fig. 7 The design of phase generator
5 5
FOUT
1
4
2
5
3
DIV
MD
SR 1 2 3 4 5
6 6 6 6
Fig. 8 The timing diagram of the changing divide ratio operations
As shown in Fig. 8, when one of the following pulse-
swallow counters sets the mode signal (MD) into logical
shift register always chooses the same phase from the phase
generator. It results in a divided-by-5 signal on the output of
5-states MUX (DIV). Otherwise, when the pulse-swallow
output of 5-states MUX (DIV) to trigger the shift register.
Hence, the shift register processes shifting operation each
DIV cycle time. The shift register chooses the phases in the
order: 1 2 3 4 5 1 2
generator. It causes a divide-by-6 signal on the output of 5-
states MUX. Via such operations, this synchronized
prescalar can provide the different divide ratio from the
phase generator at the same time. The divider array then
sends the demanded corresponding phase.
When the accumulated phase error is too large, it may
exceed a reference cycle time (2 ), which causes the loop to
deviate from the locked state. For avoiding this problem, a
control circuit is built to restrain the phase error. Its operating
principle is described as follows. The control circuit
separately counts each cycle number of reference clock and
FDIV(SYN). Here, a desired cycle number M is decided by the
cycle number of FDIV(SYN) which is utilized to produce an
averaged fractional divide ratio. Under this desired cycle
number, the control circuit will send a synchronous signal to
reference gating circuit (SYNREF) once it reaches M
reference cycles. The loop then skips one reference cycle by
gating circuit. Similarly, the control circuit will send a
synchronous signal to divider array (SYNDIV) since it reaches
M FDIV(SYN) cycles. During this period, it stops sending
divided signals to PFD pair one time by freezing the pulse-
swallow counters on N and N+1. In addition, the data of
shift-register-II and shift-register-III are synchronized to
shift-register-I. Thus, these shift-registers choose the same
phase from phase generator now. No until the FDIV(SYN) rises
does control circuit restore the operations of pulse-swallow
counters on N and N+1. The loop continues the operations
using the regenerated corresponding phase.
Synchronous cycle
Time difference ratio: k:(1-k)
FREF(IN)
FDIV(SYN)
FOUT
ICP(total)
VCTRL
4 4 4 5 4 4 4 55
VCB
FDIV(N+1) 5
FDIV(N) 4 4 4 44 44
5 5 5 5 55
Error is cancelled by current ratio: (1-k):k
FREF
(1-k)
k
Sample
Fig. 9 An example of proposed fractional-N PLL (NAVG =4.25)
Fig. 9 demonstrates a timing diagram of the operating
example. In this example, the pulse-swallow counters are
removed for illustrating this example simply. The output
frequency is divided into FDIV(N), FDIV(N+1), and FDIV(SYN) by
the synchronized prescalar, and these divided signals are
transferred to the following pulse-swallow counters. Once
Dual-Mode Continuous-Time Quadrature Bandpass
Modulator with Pseudo-random Quadrature Mismatch
Shaping Algorithm for Low-IF Receiver Application
Chen-Yen Ho1, Yung-Yu Lin2, and Tsung-Hsien Lin1
1Graduate Institute of Electronics Engineering,
National Taiwan University, Taipei, Taiwan
2MediaTek Inc.,
Hsin-Chu, Taiwan
ABSTRACT-This work presents a 2nd-order, multi-bit Continuous-
time Quadrature Bandpass Delta-Sigma (CT QBP ) modulator
with a Pseudo-random Quadrature Mismatch Shaping (PQMS)
algorithm for GSM-EDGE/Bluetooth Low-IF receiver. CT QBP
modulator is vulnerable to mismatches between its in-phase and
quadrature ( ) paths that can dramatically degrade its Signal to
Noise-plus-Distortion Ratio (SNDR) and image-rejection ratio
(IRR). This modulator incorporates a proposed PQMS to mitigate
the main mismatch source from multi-bit DAC units to
improve IRR. The CT QBP modulator is fabricated in a
0.18- m CMOS process. With the proposed PQMS, the modulator
achieves a dynamic range of 82/69 dB in 200 kHz/1 MHz,
respectively. The IRR is better than 65 dB with -4 dBFS input level
and the whole CT QBP modulator consumes less than 8.5 mW
in both modes from a 1.8-V supply voltage.
I. INTRODUCTION
Continuous-time Quadrature Bandpass Delta-Sigma Analog-
Digital Converter (CT QBP ADC) is employed in highly
integrated digitally intensive multi-standard RF transceiver
systems. In the system as shown in Fig. 1, the low-intermediate
frequency (low-IF) receiver architecture combines the
advantages of heterodyne receivers and direct conversion
receivers. The CT QBP modulator must satisfy many design
requirements to ensure a high communication quality including
signal-to-noise ratio, dynamic range, and image-rejection ratio
etc. The QBP modulator maintains many of the advantages
of the low-pass modulator. Unlike a real BP modulator,
the complex poles and zeros of QBP
transfer function (NTF) are not symmetric at dc, but rather
around the low-IF. Thus, it provides twice the noise shaping as a
real BP modulator of the same order. The tradeoff of the
complex
between the in-phase (I) and quadrature (Q) paths.
In this paper, the proposed CT QBP modulator is
comprised of a 2nd-order complex loop filter with non-return-
to-zero (NRZ) I/Q complex DACs and the proposed PQMS
circuit. Although several methods have been proposed to
mitigate mismatch effects in a complex modulator, there still
exists some limitations. A dynamic-element matching (DEM)
algorithm improves the image-rejection ratio (IRR), but applies
only to single-bit DAC mismatches and return-to-zero (RTZ)
pulse shape [1]. In [2] with I/Q channel multiplexing technique,
the aliasing of image interference is cancelled. But, this
approach only operates in a discrete-time (DT) system.
LNA
I
Q
(This work)
Mode
0
90
LO
I
Q
RF
Filter
Fig. 1 Dual-mode GSM-EDGE/Bluetooth Low-IF receiver architecture.
The PQMS algorithm proposed in this paper takes advantages
of digital processing power to compensate for analog
non-idealities. The main I/Q mismatch source in feedback I/Q
complex DACs can be eliminated. Thus, this digital algorithm
improves the IRR performance in CT QBP modulator.
This paper is organized as follows: in section II, the proposed
dual-mode CT QBP modulator architecture with PQMS
algorithm is introduced. Section III describes the circuit
implementation. The measurement results are presented in
section IV, with a conclusion given in section V.
II. PROPOSED DUAL-MODE MODULATOR ARCHITECTURE
A. Modulator Topology
The architecture of the proposed CT QBP modulator is
shown in Fig. 2 (a). A chain of integrators with distributed
feedback (CIFB) complex loop filter as shown in Fig. 2 (b) is
implemented with two complex active-RC integrators, two 4-bit
quantizer, complex DACs, incremental dynamic weighted
averaging (IDWA) [3] and the proposed PQMS circuit. For
low-IF receivers, the non-conjugate zeros are located in the
position a few times over channel bandwidth, which is given by
the product of cross-coupling resistors RC1,2 and integrator
capacitors CINT1,2. By tuning the integrator capacitor array, the
low-IF can be adjusted from 500 kHz to 1 MHz. The sample
frequencies in the GSM-EDGE/Bluetooth modes are 51.2/60
MHz, respectively. The quantization-to-DAC delay in this
modulator design is controlled less than 0.25 TS (TS is the
sampling period) in order to keep the system stable at both
sampling frequencies. The complex DAC utilizes pseudo-
randomized I/Q bit-streams to average mismatch errors exist in
multi-bit DACs.
The digital logic only contributes about 500 ps propagation
delay. Therefore, the addition of PQMS logic does not affect the
stability of whole modulator.
Compare to the algorithm in [5], the amount of hardware and
power consumption can be reduced significantly. Finally, the
distinct advantage of the proposed PQMS is that it not only
works like conventional DEM algorithm but also suppresses the
leakage from I/Q mismatch noise and improves the IRR.
D. 4-Stage Switch Current Steering DAC
The most critical component of CT QBP modulator is the
feedback DACs because any leakage noise or non-linearity
occurred in DACs will directly degrade the modulator
performance. The I/Q complex DACs are implemented with a
4-bit NRZ which has low clock jitter sensitivity. The current
steering DAC unit and the switch structure are shown in Fig. 5.
Cascode devices are employed in the current mirrors to enhance
the output impedance and improve the precision of DAC
currents. To minimize the glitch energy generated by the clock
feedthrough effect, the dummy capacitors are added to each
switch path to get improvement. In addition, glitches may be
also caused by PMOS current switch devices being turned off
momentarily. The principle of asymmetrical switch control in
I/Q differential switches is to avoid simultaneously turning off
the differential switching transistors (M1 to M4 in Fig. 5)
completely, but allow two switches simultaneous turn-on for a
short period of time. Compared to the traditional 2-stage switch
structure, the proposed 4-stage switch would contribute more
glitch power if no control mechanism is built in the system.
With the two NMOS control transistors before I/Q switch
signals, the voltage output has shorter falling time and longer
rising time as a result a transistor sizing shown in Fig. 5. It helps
to keep a constant current of complex DAC unit during the
switching transition and reduces glitch substantially.
0.8
2.0
0.8
2.0
D
CK
Q
Q
_
CKDAC
D
CK
Q
Q
_
VDD
D
CK
Q
Q
_
D
CK
Q
Q
_
VDD
QDAC QDAC IDAC IDAC
Vbias1
Vbias2
B1
B2
M1 M2 M3 M4
Fig. 5 Implementation of low-crossing point control circuits and 4-stage switch
current steering DAC.
Fig. 6 illustrates the timing of major clock phases and fully
differential I/Q switch signals with low-crossing point
waveforms. Once falling edge of the clock for quantizer, CKQ,
is triggered, the operation cycle starts. The system allows an
operation time 0.25 Ts) for all the digital logics, including
comparators, IDWA, and PQMS. This ensures that the
modulator stability is not degraded by the excess loop delay [7].
ON
CKDAC
CKQ
YI,PQMS
point
CKPQMS
ON
ON
ON
OFF
OFF
OFF
OFF
OFF
OFF
OFF
YI,PQMS
YQ,PQMS
YQ,PQMS
Fig. 6 Timing waveforms of I/Q low-crossing point switch and clock phases of
the modulator.
IV. EXPERIMENTAL RESULTS
The chip is fabricated in a 0.18- m CMOS process. In
addition, in order to reduce the I/Q mismatch from complex
integrators, the chip layout places all cross-couplings resistors
and integrator capacitors symmetrically between in-phase and
quadrature channels.
Power consumption of the complex modulator is 8.2 mW in
GSM-EDGE mode and is 8.5 mW in Bluetooth mode from a
1.8-V supply. At full-scale input signals with frequencies of
800 kHz/1 MHz for GSM-EDGE/Bluetooth mode, the peak
SNDR is 81.7/69.8 dB with a bandwidth of 200 kHz/1 MHz
based on 65536 FFT calculations. The measured output spectra
are shown in the left of Fig. 7 and Fig. 8. It can be observed that
in both modes, the IRR is over 65 dB with -4 dBFS input level
when the proposed PQMS is enabled. The intermodulation
distortion (IMD) measurement is shown in the right of Fig. 7
and Fig. 8. The measured IM3 is better than 67/66 dB in both
modes for two tones test with -10/-12 dBFS input level.
The measured SNDR versus input power level is shown in
Fig. 9. This shows dynamic range of GSM-EDGE/Blutooth
mode are 82 (80) and 69 dB. The chip micrograph of this
dual-mode CT QBP modulator is shown in Fig. 10. Finally,
the measured performance is summarized in Table I.
V. CONCLUSIONS
Complex modulators can digitize analog signals at
Low-IF with excellent bandwidth/power efficiency, which
makes them good candidates for DSP based receivers. A new
2nd-order 4-bit CT QBP modulator fabricated in a 0.18 m
CMOS process with PQMS algorithm is presented in this paper.
The modulator has demonstrated a robust quadrature DEM to
counteract the main mismatch source from DACs between I and
Q channels. Moreover, this high IRR property and high-
resolution dual-mode CT QBP modulator reduces the
amount of pre-filtering and AGC required in front of the ADC
and thus enables a low-cost highly integrated receiver for
telecom applications.
