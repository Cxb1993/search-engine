 I 
摘  要 
匝道儀控為高速公路交通管理的重要方法之一，其控制之目的在於有效平衡高
速公路主線上下游及入口匝道之交通需求，期在不影響高速公路主線之服務水準
下，使匝道進入車輛數最大，以有效疏解平面道路交通，並緩和高速公路壅塞，預
防衍生交通事故。本計畫利用基因模糊邏輯控制（genetic fuzzy logic controller, 
GFLC）建構兩類匝道儀控策略，分別為：獨立型與整合型。獨立型的基因模糊邏
輯匝道儀控（GFLC-RMIS）策略，係以主線平均行駛速度及上匝道等候車輛數為
狀態變數，以匝道儀控率作為控制變數；而整合型之控制策略（GFLC-RMIT）則
考量上游匝道儀控對於車流之影響，於獨立型策略基礎下另增設一項上游匝道儀控
率作為第三個狀態變數。同時然為能綜合比較本模式之有效性，亦將兩類常見之匝
道儀控策略：最佳定時儀控（GOP-RM）與模糊邏輯匝道儀控（FLC-RM）納入比
較考量範圍。最後，透過例證應用分析控制結果，並比較匝道不實施儀控、
GFLRC-RMIS、GFLC-RMIT、GOP-RM 及 FLC-RM 模式之績效，發現整合型的基
因模糊邏輯匝道儀控效率較其他控制策略為佳，同時於實際路網應用方面亦可得到
相似之結果。 
另外，為能因應交通資訊之動態變化與模式計算時間需求，本計畫也提出一短
期交通資訊之滾動灰預測模式（RGM(1,1)）建構高速公路短期交通資訊（交通量、
平均速度及佔有率）之預測模型，並與 ARIMA 模型進行比較分析，藉以驗證本模
型之準確率。並探討不同滾動時階（4~8 階）及預測長度（1~5 筆）之預測績效。
結果顯示，RGM(1,1)模型具有滾動時階愈少，預測長度愈短，準確度愈高之趨勢。
以表現最佳之 4 個滾動時階模型為例，其預測後 1 筆交通量之誤差率為 8.86%，平
均速度為 2.33%，佔有率為 16.74%。顯示在 RGM(1,1)在預測交通量及平均速度具
有相當高之準確度，但在預測佔有率則尚待改善。惟相較於 ARIMA 模型，RGM(1,1)
模型仍明顯較佳，且具有預測長度愈長，表現差距愈大之趨勢。 
為進一步提昇匝道儀控模式績效及檢視不同儀控策略對交通衝擊之程度，本計
畫亦建構獨立型及整合型之兩階段模糊邏輯控制（fuzzy logic control, FLC）高速公
路匝道儀控模式。其中，第一階段 FLC 之原理係依據即時偵測得之交通資訊判斷
主線之車流型態（分為自由流、輕微同步流、強烈同步流、大範圍擁擠流）及其隸
屬度，獨立型及整合型模式均相同；第二階段 FLC 則在決定當時最適之儀控率，
惟獨立型及整合型模式分別有不同之考量因素。獨立型模式考量第一階段 FLC 輸
出之車流型態判斷隸屬度及匝道等候長度，整合型模式則進一步考量上游匝道之儀
控率，以發揮上下游連鎖效果。為驗證模式並深入探索匝道儀控點附近車流之時空
特性，本文亦發展細胞自動機(cellular automata, CA)模擬模式，並與定時儀控及
ANCONA 儀控方式（Kerner, 2005）進行績效比較。經由一 15.5 公里之雙車道高速
公路測試路段（涵蓋三處交流道）模擬結果發現，在不同交通量情境下，整合型模
式比不實施匝道儀控可較減少 2.16%至 6.66%之總旅行時間，且均優於其他儀控方
式。進一步觀察匝道附近地區之車速時空變化發現，本文所建構之獨立型及整合型
模式皆可提高平均車流速率，降低速率變化，且有效避免擁塞車流向上游擴散，具
實用價值。在應用上，當交流道間距較大時（如郊區），建議可採獨立型匝道儀控
模式；當交流道間距較小時（如都會區），則以整合型模式為佳。 
關鍵詞：匝道儀控、基因模糊邏輯控制、灰預測模式、細胞自動機 
 III 
practical application, the isolated FLC ramp metering is recommended in rural area where the 
interchanges are normally sparsely located; in contrast, the integrated FLC ramp metering is 
recommended in urban area where the interchanges are oftentimes closely located. 
Keywords: Ramp metering, genetic fuzzy logic controller, grey prediction model, cellular 
automaton 
 V 
5.1 細胞自動機模式 ······················································································· 46
 5.1.1 CA 之基本組成 ········································································ 46
 5.1.2 交通變數定義 ··········································································· 47
 5.1.3 CA 規則 ···················································································· 50
5.2 兩階段模糊邏輯匝道儀控模式································································ 53
 5.2.1 第一階段車流型態判斷 ··························································· 53
 5.2.2 第二階段匝道儀控率之決定 ··················································· 56
第六章 模式驗證······································································································ 59
6.1 RGM(1,1)及 RGM(1,N)之驗證 ································································ 59
 6.1.1 單元數列模式驗證 ··································································· 59
 6.1.2 多元數列模式驗證 ··································································· 65
 6.1.3 小結··························································································· 70
6.2 GFLC 適應性匝道儀控模式驗證····························································· 71
 6.2.1 背景說明··················································································· 71
 6.2.2 模式參數分析及設定 ······························································· 72
 6.2.3 結果分析··················································································· 73
 6.2.4 情境分析··················································································· 79
6.3 兩階段 FLC 匝道儀控模式驗證 ······························································ 81
 6.3.1 背景說明··················································································· 81
 6.3.2 參數設定··················································································· 82
 6.3.3 車流模擬模式驗證 ··································································· 82
 6.3.4 瓶頸路段車流型態分析 ··························································· 83
 6.3.5 車流型態驗證 ··········································································· 84
 6.3.6 績效評比··················································································· 87
 6.3.7 情境分析··················································································· 89
第七章 結論與建議·································································································· 91
7.1 結論 ··········································································································· 91
 7.1.1 交通資訊之灰預測 ··································································· 91
 7.1.2 GFLC 適應性匝道儀控模式 ···················································· 92
 7.1.3 兩階段 FLC 匝道儀控模式 ······················································ 92
7.2 建議 ··········································································································· 93
第八章 計畫成果自評部份 ······················································································ 94
參考文獻 ··················································································································· 97
 VII 
表 6.25 交配率、突變率參數分析 ················································································ 73
表 6.26 族群數參數分析································································································ 73
表 6.27 最佳定時儀控(多時段)之控制績效 ································································· 74
表 6.28 最佳定時儀控(1 段式)之儀控率組合······························································· 75
表 6.29 最佳定時儀控(4 段式)之儀控率組合······························································· 75
表 6.30 獨立型 GFLRC 模式之最佳邏輯規則組成······················································ 75
表 6.31 情境一模式績效比較表···················································································· 79
表 6.32 情境二模式績效比較表···················································································· 80
表 6.33 情境三模式績效比較表···················································································· 81
表 6.34 模式績效之彙整表···························································································· 81
表 6.35 車流型態判斷 ··································································································· 86
表 6.36 驗證儀控績效比較表························································································ 88
表 6.37 各情境儀控績效彙整與比較表 ········································································ 89
 
 IX 
圖 6.9 獨立型 GFLRC 模式之演化尋優過程 ······························································· 77
圖 6.10 整合型模式之主線平均速度最佳隸屬函數示意圖········································· 78
圖 6.11 整合型模式之匝道等候車輛數最佳隸屬函數示意圖 ····································· 78
圖 6.12 整合型模式之上游匝道儀控率最佳隸屬函數示意圖····································· 78
圖 6.13 整合型模式之匝道儀控率最佳隸屬函數示意圖············································· 79
圖 6.14 背景示意圖 ······································································································· 82
圖 6.15 流量-密度關係圖(cell/秒) ················································································· 83
圖 6.16 流量-密度關係圖(輛/小時)··············································································· 83
圖 6.17 純小型車車流速率時空變化圖 ········································································ 83
圖 6.18 純大型車車流速率時空變化圖 83
圖 6.19 混合車流瓶頸路段車流型態圖(交流道間距=2km) 84
圖 6.20 純小型車車流速率時空變化圖(交流道間距>2km) 84
圖 6.21 純大型車車流速率時空變化圖(交流道間距>2km) 84
圖 6.22 混合車流速率時空變化圖(交流道間距>2km) 84
圖 6.23 車流型態驗證時空軌跡圖 86
圖 6.24 第五分鐘車流型態分析圖 86
圖 6.25 第六分鐘車流型態分析圖 86
圖 6.26 第七分鐘車流型態分析圖 86
圖 6.27 第八分鐘車流型態分析圖 86
圖 6.28 第九分鐘車流型態分析圖 86
圖 6.29 第十分鐘車流型態分析圖 86
圖 6.30 第十一分鐘車流型態分析圖 86
圖 6.31 第十二分鐘車流型態分析圖 86
圖 6.32 第十三分鐘車流型態分析圖 86
圖 6.33 第十四分鐘車流型態分析圖 86
圖 6.34 三相車流理論流量-密度關係圖 87
圖 6.35 整合型 FLRC 車流速率時空變化圖 88
圖 6.36 獨立型 FLRC 車流速率時空變化圖 88
圖 6.37 ANCONA 車流速率時空變化圖 88
圖 6.38 定時儀控車流速率時空變化圖 88
圖 6.39 不實施儀控車流速率時空變化圖 89
圖 7.1 預測型模糊邏輯匝道儀控系統架構圖 91
 
 2 
1. 回顧國內外模糊邏輯匝道控制及基因模糊邏輯推論相關文獻，了解其基本理論、變
數選定、控制績效評估指標及參數校估機制，作為本研究模式構建之學習與參考。 
2. 藉由細胞自動機的文獻評析，了解其基本理論、參數設定、模式型態，俾據以探討
其應用於匝道儀控之可行性。 
3. 將蒐集完成之偵測器資料，以 GM(1,1)模型及滾動模型（RGM(1,1)）分別建構高速
公路短期交通資訊（交通量、平均速度及佔有率）之預測模型。 
4. 建構適應性匝道儀控模式，在模糊邏輯控制部份，確立狀態變數與控制變數，經由
模糊推論及解模糊化程序，輸出控制結果；第二階段為基因演算法之應用，以總旅
行時間作為基因演化之適合度值，挑選出最佳邏輯規則及校估隸屬函數參數。 
5. 依據控制時段建置最佳定時儀控模式，應用基因演算法進行總旅行時間最小化問題
求解，搜尋最佳儀控率組合。 
6. 建構車流模擬模式，在細胞自動機模式上確定參數設定、模式型態、輸出變數；在
車流型判斷模式上確定狀態變數、控制變數、模糊規則、隸屬函數設定；在匝道儀
控模式上確定狀態變數、模糊規則、隸屬函數設定，以細胞自動機和車流型態判斷
模式輸出之變數透過模糊邏輯控制決定匝道儀控率。 
7. 利用簡例和實例應用，分析所構建之匝道儀控模擬模式與策略績效及其實用性。 
1.3 研究內容與流程 
本研究之研究內容可分述如下： 
1. 界定研究目的與範圍 
本研究之分析對象為國道一號出、入口匝道，根據主線速度及匝道交通狀況，首先
建立適應性儀控系統(Adaptive Ramp Metering System)，由原先之獨立型匝道擴充為整合
型匝道以考量整體路網績效，藉由 GAs 校估模糊邏輯控制參數，期使控制結果達最佳。
接續以細胞自動機結合模糊邏輯控制建構一兩階段模糊邏輯匝道儀控策略，並應用細胞
自動機模擬車流型態時空關係轉變，以高速公路主線車流型態與匝道等候車輛數透過模
糊邏輯控制達到控制目的，分析獨立型及整合型匝道儀控系統，實例應用擬以國道一號
中部路段包含三組出、入口匝道之路段，評估整體系統控制績效。在高速公路之交通參
數預測部分，則擬以 GM(1,1)模型及滾動模型（RGM(1,1)）分別建構高速公路短期交通
資訊（交通量、平均速度及佔有率）之預測模型。 
2. 回顧相關文獻 
(1) 灰預測模式 
回顧過去灰色理論在各領域中應用與研究結果，了解灰色理論之研究方法，分析灰
預測模型之預測績效以作為本研究之參考依據。回顧國內外研究學者應用相關之研究方
法進行短期交通量預測，包括傳統統計方法、時間序列分析、混沌理論及類神經網路等，
最後整合相關文獻以選定一適合模式與灰預測模式進行精確度驗證。 
(2) 匝道儀控演算法 
回顧匝道儀控演算法之相關文獻，主要著重於模糊邏輯控制演算法之回顧，以了解
 4 
(2) GFLC 適應性匝道儀控模式驗證 
利用含括4個上下匝道口路網之簡例，依據流量高低設計三種不同情境，以總旅行
時間作為系統控制後績效評估指標，進行匝道不實施儀控、最佳定時儀控、獨立型GFLRC
及整合型GFLRC模式之績效比較。 
(3) 兩階段 FLC 匝道儀控模式驗證 
蒐集台灣地區中部路段高速公路主線與匝道之偵測器車流資料，以實際車流資料進
行不同匝道儀控策略之績效評比，了解本研究所提模式應用於實際道路之實用性。 
5. 結論與建議 
綜合上述之研究成果提出結論與建議。 
本研究之研究流程如圖 1.1 所示。 
界定研究目的與範圍
相關文獻回顧
模糊邏輯匝道
儀控文獻
基因及基因模糊
邏輯推論文獻
灰預測模型相
關文獻
模式建構
GFLC適應性
匝道儀控模式
建構
交通資訊之灰
預測模式建構
模式驗證
結論與建議
兩階段FLC儀
控模式建構
細胞自動機
相關文獻
車流模擬模式
(細胞自動機)
巨觀車流模式
與等候理論
 
圖 1.1 研究流程圖 
 
 6 
灰預測方法是在找出某一數列中間各個元素之未來動態狀況，在表 2.1 中列出了傳
統上做預測的方法及灰色預測的特點。 
表 2.1 傳統上的預測方法及其限制 
數學的方式 所需最少之
數據 
數據之型態 數據之間
隔 
準備時間 數學需求 
簡單指數型 5 至 10 個 等間距 短間隔 短 基本 
olt’s 指數型 10 至 15 個 同趨勢 短或中間
隔 
短 稍高 
Winter’s 指數
型 
至少 5 個以
上 
同趨勢且具
規律性 
短或中間
隔 
短 中等 
迴歸分析法 10 或 20 個
以上 
同趨勢且具
規律性 
短或中間
隔 
短 中等 
Causal 迴歸
法 
10 個以上 可各種型態
相互混合 
短、中及
長間距 
長 高等 
時間序壓縮
法 
2 個峰值以
上 
同趨勢、具
規律性且可
自我調整 
短或中間
隔 
短 
（稍長） 
基本 
Box Jenkins
法 
50 個以上 等間距 短、中及
長間距 
長 高等 
灰色預測法 4 個 等間距及非
等間距 
短、中及
長間距 
短 基本 
資料來源：張偉哲、溫坤豊、張廷政（2000） 
1982 年鄧聚龍提出灰色系統理論分析(grey system theory）後，經由各界學者積極研
究努力下，今已被廣泛應用於各個領域並得到有效的論證與預測，茲以下列各應用領域
進行說明。 
Wang et al.(2004)應用灰關聯分析對航空站進行績效評估，主要討論有關於台灣地區
主要航空站營運績效之評定與比較，並著力於四大重點去衡量，1.航空站，2.旅客，3.
航空公司，4.防火服務。而其中為了克服小樣本數量的限制，選擇用灰關聯分析來分類
初始的評估指標，同時選擇最能代表性的指標。 
曹文建（2003）以灰預測 GM(1,1)、GM(1,N)針對航空運輸需求製造業及運輸倉儲
關連產業產值預測與迴歸預測模型進行比較，研究結果顯示，GM (1, 1)模型達 90％以上
的精確度，優於迴歸預測模型，研究認為預測模型之優劣並無絕對，端視研究對象以及
研究特性來選去適合之預測模型。 
吳嘉斌(2003)在物流運輸之應用領域中，以灰色理論來做為研究基礎，對未來物流
中心的運量做預測與設計配送路線的車輛途程問題(Vehicle Routing Problem，VRP)首先
是根據歷史資料來預測未來需求，建構出灰色預測之 GM 模式，對現有數據進行預測，
以求得數列中各數據元素之未來動態發展狀況；再來是根據需求點的屬性，綜合各項實
際
 8 
黃光宇（2004）對澎湖箱網養殖產量進行灰色模式 GM(1,N)建模固定以平均背景值
方式組成 Z( )(K)可以得到適正結果。利用 GM(1,N)灰模式，將相關因素及各構面都納入
系統中考量，推估產量預測方程式求解市場簡化期望最佳產量目標，以解決決策數據上
的限制。然而，對於離散數列所隱含規律變化，有時對澎湖生產數量產量進行預測，無
法由平均背景值的建模方式充分顯現，所以會形成 GM(1,N)模式的誤差，但是仍為可以
接受範圍，誤差值為 10.57％。 
黃仲達 (2003) 以灰預測來進行已少量數據預測來年國內農產銷售量，經過實務驗
證的結果，灰預測在預測精確度、模型的等級評定及使用的樣本數等多方面的整體表現
優於時間序列分析及統計的線性迴歸分析。從實證中兩產品的預測準確度來看，可以推
論數值越大，越能偵測到產品銷售量走勢變化，使得預測值越精確。在預測方法比較上，
研究發現較多的歷史觀察值並無法提供給模式一個穩定的衰退比例，所以，時間上距離
預測值越遠的歷史觀察值，對於預測模式無太大的助益，這也就是導致迴歸預測能力發
揮不如灰預測的主要原因。移動平均法之預測能力未達水準的主要原因在於，年銷售量
資料具有趨勢性，造成對資料走勢中「異常觀測值」的反應不靈敏，同時也因為觀察值
日數太少，導致誤差的穩定度較差。單一指數平滑法中之平滑常數通常界於 0.2 到 0.3，
當 α值越大，越適合有趨勢的預測，亦越能反應出最近的觀測結果。Winter 指數平滑模
式同時具有趨勢性及季節性。研究認為「突發事件的異常數據」，乃是影響灰預測方法
之預測準確度最大的因素。 
溫修慧（2004）利用 GM(1,N)模型及 GM(0,N)模型、GM(1,2)模型針對焚化廠之環
境背景因子進行建模預測，依「預防及減輕開發行為對環境不良影響對策摘要表」之施
工期間影響程度進行量化，以探討預測各焚化廠環境因子之間影響程度，嘗試將同一類
別之環評案件做橫向比較。研究結果顯示，以 GM(1,N)模型綜合分析，環境因子在地形、
地質與土壤等、陸域動植物、空氣品質、水域動植物、水文及水質及廢棄物等方面，其
平均殘差値分別為 9%、16%、12.5%、28.5%、9.5%、19%，與環境影響評估對策摘要
表評估之影響程度相當符合。另焚化廠背景因子以 GM(1,N)模型對環境因子影響分析部
分，結果顯示設計處理量(公噸/日)影響性最為顯著。因僅針對一項背景因子作建模比
較，獲得結果均會較以 GM(1,N)模型將所有背景因子一同進行建模預測有更佳之預測效
果。 
周裕然、鍾秉勳、歐陽橋暉等(2004)以好氧－缺氧－好氧（OAO）生物除氮程序之
水質數據進行灰關連分析、模式建構與水質預測，於進行灰建模前，均以各獨立之好氧、
缺氧生物反應槽為控制體積（control volume），針對每一槽體做局部性灰關聯分析，尋
求操作參數與水質參數間之關聯性，再以灰關聯性較高之各項控制因子建立 GM(1,N)
水質預測模式，以預測 SRT＝15 天、HRT=10 小時、Q1：Q2=0.8：0.2 操作時之各項放
流水營養鹽濃度，獲致氧－缺氧－好氧（OAO）生物除氮成序之水質預測模型。研究結
果得知，以 GM(1,N)理論預測都市污水處理廠處理水回收特性時，預測 COD、PO4 濃
度可獲致較準確的結果。GM(1,N)水質預測模式於預測 OAO 生物除氮程序放流水水質
時，預測值與實測值變化趨勢具一致性，顯示 GM(1,N)水質測驗模式可描述本程序硝
化、脫硝、磷代謝及 COD 等生化反應，且預測處理水 COD、PO4 濃度可獲致較準確的
結果。故水質預測模型可作為程序動態控制策略擬定之參考依據。 
2.2 匝道儀控演算法之相關研究 
 10 
高速公路車流資料，並依據 Payne’s 巨觀車流模式推估總旅行時間，以最小化總旅行時
間為控制目標。比較未控制與線性規劃控制結果，結果顯示適應性模糊邏輯控制系統不
僅可減少總旅行時間，且可提升主線平均速度及節省燃料耗費量。 
Taylor et al.（1998）應用模糊邏輯構建西雅圖 I-5 高速公路數個匝道之儀控系統，
根據即時交通狀況推估每二十秒為週期之儀控率，使用主線匯入處及下游的佔有率及速
率、主線上游佔有率、入口匝道等候佔有率、入口匝道等候車輛是否回堵至平面道路之
佔有率等七個狀態變數，語意等級為五之三角形隸屬函數；控制變數為儀控率，計使用
十七條規則，依據規則型態給予不同之權重。設計六種不同之車流情境，使用 FRESIM
模擬軟體模擬儀控績效，結果顯示模糊控制之績效均較定時控制、需求-容量控制及速
率控制為佳，惟交通量近似容量時顯示速率控制較佳。 
Sasaki et al.（1988）提出以模糊邏輯推理來描述交通管理者判斷的過程及一交通控
制系統以推估上匝道自動化控制模式，建構一符合真實管理過程之模糊控制系統，除能
減少管理者每次做決策時之負擔，且有助於發展一更具效率之管理程序。以實際 Hanshin
高速公路 Osaka-Sakai 路線之上匝道控制為例，應用模糊邏輯控制構建匝道控制系統，
以主線擁擠長度及預期交通需求量為狀態變數，語意等級皆為三，規則數為五，參數校
估之方式係依據一評估指標採取反覆地測試；控制變數為儀控等級，結果顯示此控制與
管理者實際判斷行為是相近的。此外，可藉著修改語意變數、增減規則數，使得控制結
果達到最佳化。 
Lee et al.（2000）應用模糊邏輯構建一高速公路匝道儀控系統，主要包含模糊邏輯
系統與決策函數兩部分，前半部以主線平均速度及平均速度變化率為狀態變數，等級為
五，第一、五等級之隸屬函數型態為梯形，餘為三角形；控制變數為號誌轉換機率，等
級為五之明確隸屬函數。後半部係訂定一門檻值，並比較前半部之轉換機率，決定是否
變換燈號，結果顯示模糊匝道儀控系統確實能有效穩定主線車流行進狀況。 
Papageorgiou et al.（2002）彙整分析定時儀控、交通感應式調節器及非線性最佳控
制等儀控方法，並以大規模（阿姆斯特丹之外環道，長 32 公里，銜接四條高速公路，
計 21 個上匝道口、20 個下匝道口）之例子加以驗證此非線性最佳匝道儀控方法於交通
之改善程度，最後將其儀控結果與未控制時在總旅行時間上作比較，發現可改善 36.6 %。 
Bellemans et al.（2004）應用預測型控制模式（MPC）及動態交通指派模式建構預
期型（anticipative）匝道儀控系統，利用 METANET 作為預測模式，將駕駛者因控制而
產生之自發重新選擇路線行為納入考量。目前存在著多個推估駕駛者最佳路線之方法，
係依據 Wardrop’s 原理推導而得，在此引用之方法為連續平均法(Method of the Successive 
Average)，其為一反覆型靜態均衡交通指派法，係考量車流影響之節線成本。假設情境
為主線四線道，中間路段分支為各兩線道之雙道路，一為長 6 公里之主車道，其中端含
一匝道口，主車道下游於上午 5 點 30 分為施工期間，因此車道須由原本二線道縮減為
單線道；另一為長 8 公里之次要車道，模擬結果與無匝道控制比較，顯示總花費時間分
別為 3781 veh.h 與 4886 veh.h，改善了 22%。 
魏健宏與吳耿毓（1997）以具時空特性之類神經網路學習控制策略，根據交通參數
資料求出適合的儀控率，配合自我修正模式之專家系統，評估先前時段儀控之績效，研
擬修正控制策略，並產生修正訓練範例，提供時空類神經網路做線上回饋訓練之用，據
 12 
為三、二、二，皆為梯形隸屬函數，而控制變數為儀控率，語意等級為五。以服務水準
為績效指標，結果顯示模糊控制較未控制與定時控制為佳。 
張堂賢與莊國欽（2004）在 Payne 離散方程式之基礎下，以泰勒展開式及連鎖率推
導出二階之非線性速率方程式，考量上匝道流量、上匝道佇列以及兩公路匯流之匝道佇
列等限制方程式，以主線流量最大化為目標，構建非線性之整合型匝道儀控模式。另以
林貴璽所推導之車流模式為基礎，校估本身所採用之流量－速率模式。進行晨昏峰各為
三小時之模擬，計算週期為 20 秒，控制績效與匝道未控制作比較，顯示除可維持主線
較高流量外，亦可提升行駛速率、降低車流密度，並有效紓解主線壅塞。 
茲就上述有關匝道儀控系統之相關文獻概分為模糊邏輯匝道儀控與匝道儀控演算
法兩部分加以彙整如表 2.2 與表 2.3 所示。 
表 2.2 模糊邏輯控制於匝道儀控系統之文獻彙整 
作者 
（年份） 
狀態變數 
與控制變數 
隸屬函數型態
與等級數 
設定
方式 
應用地區 
(適用性) 
主線擁擠長度、預期交
通量 等級三 Sasaki et al. （1988） 
儀控率等級 － 
主觀 
日本
Osaka-Sakai
高速公路 
壅塞程度、壅塞程度變
化率、控制地帶、事故、
無事故、控制地帶等候
時間 
前二項等級分
別為六與五 
Chen,L. et al. 
（1990） 儀控率、維持等候時間
之流量變化率、縮減等
候時間之流量變化率 
儀控率之等級
為八 
主觀 舊金山 -奧克蘭海灣大橋 
主線匯入處及其下游之
佔有率及速率、上游佔
有率、匝道等候佔有
率、匝道等候車輛回堵
至平面道路之佔有率 
三角形，等級
五 Taylor et al. （1998） 
儀控率 － 
主觀 西雅圖 I-5 高速公路 
主線流量、速率 Gaussian 曲線，等級三 Bogenberger et al. 
（2000） 儀控率 Gaussian 曲線，等級三 
客觀 慕尼黑 A9 高速公路 
主線平均速度、平均速
度變化率 
等級一、五梯
形 ， 餘 三 角
形，等級五 
Lee et al. 
（2000） 
號誌轉換機率 垂直線，等級
五 
主觀 高速公路匝道
儀控系統 
Keller et al. 
（2001） 
主線上游速率、密度、
佔有率、入口匝道等候
佔有率、駛入佔有率、
前 三 項
Gaussian 曲線
等級三，後四
客觀 慕尼黑 A9 高
速公路 
 14 
之概況描述，對於車輛行為以密度、速率、流量之平均數值來處理，並不模擬個別車輛
間之運作，如 FREQ、CORFLO、FREFLO 模式等。(2)中觀模式，著重於車隊間之推進
處理，如 INTEGRATION 模式。(3)微觀模式，著重於車輛與車輛間之個別運作處理，
如 FRESIM、CORSIM 模式等。 
藉由表 2.3 可知除傳統幾種儀控演算法外，近幾年來亦有許多研究發展新的演算法
來構建匝道儀控系統，依據研究所需選擇適合之車流模擬軟體，模擬所需之車流資料，
進行模式之構建與績效評估。而模擬軟體的運用除可免去實際資料調查之人力、財力及
時間，亦可捕捉一些較不易獲得之交通狀況。 
2.3 基因演算法之相關研究 
張立偉(2001)於大規模災害搶修程序上，應用基因演算法(GAs)求解搶修工程隊之最
佳排程及各災點搶修順序，以搶修單位之旅行時間最小化、災點搶修時間最小化及災點
搶修風險最小化構建多目標式，作為基因演化運算之適合度，考量具時窗限制之車輛繞
徑問題(Vehicle Routing Problem)作為解題架構。於世代演化過程中，保留一半前世代中
較佳之母代染色體，另一半則另以隨機方式產生以擴大搜尋空間。族群內各染色體透過
蒙地卡羅轉盤進行篩選；針對整體群體最佳解作考量，採群體位元交配(Population Byte 
Crossover)方式，族群內之染色體係以整體位元方式進行交換；初始突變率設定為 0.1，
爾後每經過一世代之演化則減少 0.01。進行案例測試，顯示求解結果與原例題正確最佳
解相同且求解效率尤佳。 
彭浚忠(2002)擬於大規模災害發生時，規劃災後人員疏散與指派構建一區位指派模
式(Location-Allocation Model)，以達成在疏散時間限制、有限避難空間及人員之擁擠程
度等限制下，將人員公平指派進行疏散，基於上述三項因素構建一模糊多目標疏散指派
模式，針對三個目標式相對應之總目標達程度，作為適合度進行基因演算法(GAs)之運
作。以台中市進行實例分析，區分為 223 個里與 113 個避難所，所建立染色體之長度為
223，族群數為 30，採取單點交配，突變技巧係自母代染色體隨機產生 6 個點，並從 113
個避難所中隨機取 6 個避難位置進行突變以產生一組新的染色體。分析結果顯示以旅行
距離為 1 公里而擁擠度為 3 人/m2 時，所求得之整體滿意度為最佳，且求解所得之旅行
時間亦符合所設定時間內。 
吳心琪(2002)探討於地震災害發生後，擬規劃國內公路網搶修之最適排程，伴隨災
點搶修工作陸續完成進而恢復完整公路網，用路人之旅行時間亦可獲得減少，故本文以
單位時程內之累積節省旅行時間作為排程最佳化指標，應用簡單基因演算法(SGA)來處
理災點搶修順序之問題。族群數為 20，以整數值表各災點進行編碼，為盡量保留搶修順
序特性而採用 OX(Order crossover)交配方式，採反轉(Inversion)運算方式完成突變之運
作。以 8 個災點、3 個工作站之受災路網為例，運用窮舉法求出最佳解後，與 SGA 解法
進行求解績效比較，顯示可求得不錯之最佳近似解。另以 8 個路段、4 處交流道共 12
個災點之實例加以驗證，結果顯示族群數 30 經 50 世代尋獲近似最佳解，此外，由原先
6 個搶救工作隊增加為 7 隊時，可縮短總搶通之時程。 
蘇恆磊(2002)應用基因演算法於零工式生產排程系統問題(Job-Shop Scheduling 
Problem)，用以求解最適生產排程，以總完工時間為績效衡量標準，即總完工時間最小
化為目標。採用 Operation-based representation 方式進行編碼，假設 n 個工作及 m 台機
器設備，則染色體長度為 n×m ，交配方式為研究重點，可分為 Partial-mapped 
 16 
糊集合之波峰點來調整規則庫，輸入變數為所有模糊集合之波峰點，以向量形式表之，
規則庫之「推論輸出」與「需求輸出」間差異達最小化為目標。起先以傳統 PD 控制系
統進行二階系統定位控制之設計，使用九條規則，每個波峰點以 12 個基因表之，計 11
個模糊集合，故每一條染色體有 132 個基因，族群數為 20，突變率為 0.02，經 30 世代
尋優最佳之波峰點，結果顯示系統經調整後，雖反應速度稍慢，但並無超越(overshoot)
且穩定狀態之誤差極小。 
其次，以鐘擺系統為例，使用九條規則，每個波峰點以 12 個基因表之，為使波峰
位置之型態為一對稱分配，故此處將調整參數之數目由 11 個減為 7 個，故每一條染色
體有 84 個基因，族群數為 20，突變率為 0.015，經 40 世代尋優最佳之波峰點，結果顯
示系統經調整後，雖反應速度稍慢，但並無超越、穩定狀態之誤差及震盪(oscillation)行
為產生。 
Homaifar et al.（1995）應用基因演算法同步校估隸屬函數及邏輯規則兩部分，除與
單純使用模糊邏輯控制作比較外，亦考量單一校估邏輯規則而隸屬函數不予校估時之控
制績效。初以車輛控制（Cart Controllers）為例，狀態變數為速度與位置，等級為五，
產生 1600 種組合初始狀況，每條染色體以 35 個基因表之，採 1~5 實數編碼，將結果與
惟校估邏輯規則作比較，顯示同步校估隸屬函數及邏輯規則之控制績效較佳且所需時間
亦較少。另以車輛逆行（Truck-backing）為例，狀態變數為位置與角度，等級為五與七，
產生 32400 種組合初始狀況，每條染色體以 54 個基因表之，比較類神經網路控制顯示
時間可節省約 6.34%。 
邱裕鈞與藍武王（2001）發展一套反覆演化之基因演算法，以整體性隸屬函數為基
礎，進一步改良 Karr[1991]及 Kinzel et al.[1994]在處理邏輯規則選擇與隸屬函數校估等
兩層次問題時，缺乏反覆回饋求解機制之缺點，以使適應性模糊控制系統能達到自動學
習之目標。此外，針對 GAs 在校估語意變數之實數編碼與限制條件甚多之問題，進而
研提一套編解碼及運算方法加以克服。為驗證其應用性與精確性，以 GM 跟車模型所產
生之跟車資料為例，結果顯示所建立之 GFLC 模式能夠精確地預測跟車行為。 
茲就上述有關基因模糊邏輯推論之相關文獻彙整如表 2.3 所示。綜觀上述文獻，可
知基因演算法之運用已能客觀地構建模糊邏輯控制之兩大核心部分，且顯示經調校後之
控制績效良好。參數方面可單獨針對隸屬函數或邏輯規則進行校估，亦可同步校估上述
兩部分參數，根據相關文獻可知同步校估方式顯示的控制績效較佳。同時，藉由文獻之
回顧亦能了解到 GAs 進行參數校估時之編解碼與運算元運作方式，以作為本研究模式
構建之參考與學習。 
 18 
x1 
y 
NL NS ZE PS PL 
NL      
NS      
ZE      
PS      
x2 
PL      
g1 g13 g25g2 ‧‧‧ ‧‧‧
  0  → Not included 
  1 → Y = NL 
  2 → Y = NS 
  3 → Y = ZE 
  4 → Y = PS 
  5 → Y = PL      
c1l 
=cmin
1
NL NS ZE PL
μ
PS
0
c2l c1r c3l c4l c5l c2r c3r c4r c5r 
=cmax
r2 r3 r4 r5 r6 r7r1 r8 r9
sf
g1 g2 ‧‧‧
註：  gi  =  0 ~ 9
g3 g4‧ g5 g6 g7 g8‧ g33 g34 g35 g36‧‧‧‧
 
圖 2.1 邏輯規則編解碼方式示意圖    圖 2.2 隸屬函數編解碼方式示意圖 
資料來源：邱裕鈞、藍武王（民 90） 
於隸數函數編解碼部分，如圖 2.2 所示，語意變數為等級五之三角模糊數，假設第
1 及 5 等級模糊數均分別為左傾及右傾之直角三角形，即 c1l = c1c =cmin 及 c5c= c5r=cmax，
其中 c1l及 c1c為第 1 等級三角模糊數之左底角及頂點座標值，而 c5c及 c5r代表第 5 等級
三角模糊數之頂點及右底角座標值，cmin 及 cmax 則分別為該變數之最小值及最大值。第
2~4 等級模糊數均呈等腰三角形，即 ckc=( ckr+ckl)/2，k=2, 3, 4。因此，對於一個語意變
數為等級五之三角模糊數所需校估之參數，包括第 1 及 5 等級模糊數之右底角及左底
角、第 2~4 等級模糊數之左右底角共 8 個，其相對大小關係如式(2.1)所示。 
min2
1
3
2
4
3
5
4max ccc
c
c
c
c
c
cc lr
l
r
l
r
l
r ≥≥≥≥≥≥                                      (2.1) 
其中，c5l與 c3r、c4l與 c2r及 c3l與 c1r之相對大小未定。 
    針對此 8 個參數值進行校估，以 r1~r9等 9 個位置變數代表其相對大小
位置，而此 8 個參數值之估算方式如式(2.2)~(2.9)所示。 
      sfrccl ×+= 1min2                                             (2.2) 
      sfrcc lr ×+= 221                                                   (2.3) 
      sfrcc ll ×+= 323                                                  (2.4) 
      sfrccc lrr ×+= 4312 },max{                                           (2.5) 
      sfrccc lrl ×+= 5314 },max{                                           (2.6) 
      sfrccc lrr ×+= 6423 },max{                                            (2.7) 
      sfrccc lrl ×+= 7425 },max{                                           (2.8) 
      sfrccc lrr ×+= 8534 },max{                                           (2.9) 
其中，
∑
=
−= 9
1
minmax )(
i
ir
ccsf  。 
 20 
    運用反覆演化方式進行邏輯規則之選擇與隸屬函數之校估時，其基本觀
念類似二階層數學規劃，上層係在下層求解所得之隸屬函數下，求解邏輯規則之
最佳組成；下層則是在上層求解所得之邏輯規則下，求解隸屬函數之最佳參數。
整個反覆演化之流程敘述如下： 
Step 0：任意設定隸屬函數之起始參數值。 
Step 1：邏輯規則之選擇 
step 1-1：隨機產生 n 個染色體之起始族群。 
step 1-2：以現有隸屬函數參數為基礎，計算各染色體之適合度。 
 step 1-3：選擇。 
 step 1-4：交配。 
 step 1-5：突變。 
 step 1-6：令族群中各染色體最大適合度= fsr*，s 表演化世代數。 
 step 1-7：測試停止條件(在此設定為成熟率達到 80%)是否成立。若是則至 Step 
2；若否則再回到 step 1-3。 
Step 2：隸屬函數之校估 
step 2-1：隨機產生 n 個染色體之起始族群。 
step 2-2：以現有邏輯規則組成為基礎，計算各染色體之適合度。 
step 2-3：選擇。 
step 2-4：交配。 
step 2-5：突變。 
step 2-6：令族群中各染色體之最大適合度 = fsd*。令 fs  = fsd*。 
step 2-7：測試停止條件(成熟率達到 80%)是否成立。若是則至 
         Step 3；若否則再回到 step 2-3。 
Step 3：測試反覆演化之停止條件(設定為目標函數值之改善程度變動不大，即
(fs+1-fs)≦ε，ε 為設定之極小數值)是否成立。若是則停止演化，表示已尋
得最佳之邏輯規則與隸屬函數；若否則再回到 Step 1。 
藉上述相關文獻之回顧，由國外實證經驗可知 FLC 於匝道儀控系統之應用確實可
行且具有效性，控制結果之評估大多以主線旅行時間及匝道等候延滯時間之加總作為績
效衡量指標，至於績效比較分析之對象諸如匝道未實施儀控、定時儀控、線性規劃控制
等儀控策略或現存控制系統，適應性匝道儀控系統(FLRC)除可節省用路人之旅行時間
外，亦可有效提升主線行車速度、節省燃料耗費量等，同時紓解高速公路主線交通壅塞。
FLRC 為一種模仿管理者控制行為之策略，有助於減少管理者每次做決策時之負擔，達
到更具效率之管理程序。許多研究依據控制目標，選定控制變數再確立狀態變數，並採
主觀方式挑選幾條邏輯規則同時設定語意變數進行控制，確實亦能達到決策者所設定控
制之目標，而為了進一步提升整體控制之績效，陸續有相關之研究透過資料訓練之方
式，挑選最佳之邏輯規則及校估隸屬函數建構 FLRC，此種方式除了可反映出一些人為
較為困難或無法判斷之結果，同時可具體提昇其控制績效。 
 22 
距較小。當交通組成是混合車流時，車間距會比同質車流大，且當快車在慢車後面時最
大。此外從交互相關函數中看出混合車流和同質車流都有很大的關聯性，在自由流和擁
擠流狀況下的交叉相關係數大約是 1；同步流下大約是 0.1。然而不同交通組成對於交通
型態轉變的分析中可以觀察到，當交通組成全部是快車時同步流型態維持時間較全部是
慢車來的短。此外同步流型態在混合車流中的維持時間會隨著起始狀態不同而改變。 
Jiang and Wu(2003)改善 Knospe et al.(2000)所提出的 BL 模式，BL 模式在考慮駕駛
人平穩且舒適的駕駛行為下的更新規則。然而本研究目的在改善 BL 模式無法描述輕微
的同步流型態，因而以完全靜止車輛和減速車輛加速敏感度不同重新定義模式。改善後
模擬結果顯示，可以清楚的觀察到車流中產生輕微的和強烈的同步流型態。在對完全靜
止時間定義的敏感度分析上可以看出當流量到達最大後，密度會隨著靜止時間而增加。
意含駕駛人能保持較久的敏感度下，強烈的同步流型態能被持續的較久。 
除了以上所述利用時間序列分析車流型態外，Kerner et al.(2004)利用模糊邏輯控制
判斷車流型態。以速度、流量、速度變化率、流量變化率、速度/流量變化率為狀態變數，
速度語意等級為四，流量語意等級為三，後三者語意等級皆為二，隸屬函數型態皆為梯
形；車流型態為控制變數，車流型態區分為自由流、同步流、大範圍擁擠流。本文章在
考量流量、速度外加入兩者的變化率與相對變化率，目的在考慮車流型態的時間動態轉
變。從德國黑森 A67 快速道路實測結果來看，能有效精準預測每分鐘車流型態的轉變。 
除了模擬同步流型態的研究外，有更大部分的研究在以 CA 模式觀察道路上車流型
態的傳遞與轉變。Pottmeier et al.(2002)分析 BL 模式中局部擾動(Localized defect，Pd)設
定對交通型態的影響，觀察在 Pd≦P、Pd≒P、Pd≧P 三種狀況下交通型態的改變。以
較小的 Pd 模擬結果發現對於擾動較敏感，因而減少亞穩定狀態(Metastable states)持續的
時間，所謂亞穩定狀態乃指在某一穩定車流狀態下，增加些微的擾動車流型態將轉變為
擁擠流；減少些微的擾動將轉變為自由流。車輛在經過由單股大範圍擁擠流(Single wide 
jam)和自由流所組成的擁擠流型態時，不會受到擾動影響而產生擾動。因為這種車流型
態和在 VDR(Velocity-Dependent Randomization)模式下沒有擾動的擁擠流型態是一樣
的，因此作者將這種型態定義為 VDR 型態。以較大的 Pd 模擬的結果引起高密度車流，
這種車流型態為停止-前進型態，然而在 VDR 模式中沒有擾動時卻無法發現這種車流型
態。以 Pd≒P 模擬結果發現一種跨越現象，大範圍擁擠流會產生向後傳遞的現象，且輕
微而短暫的擁擠流型態會產生。 
Barlovic et al.(1998)以 N-S 模式為延申加入減速-起動(Slow-to-start)規則，企圖模擬
車流的磁滯現象(Hysteresis effects)和密度的亞穩定狀態。以三種減速-起動規則作試驗，
結果發現以 Vmax=1 的 T2 規則和 VDR 模式下可產生亞穩定狀態。作者發現在這兩個模
式中，因為降低擁擠駛出(Outflow regime of a jam)的密度是產生亞穩定狀態的重要因
素。反觀傳統 N-S 模式由於尋航速度的限制且擁擠駛出密度無法降低，因而無法觀察到
亞穩定狀態。 
在模式的完整性上，開放式路網和多車道模式的發展讓模式更完整。Knospe et 
al.(1999)針對雙車道上考慮不同變換車道行為，及慢車在低車流密度下對車流造成的影
響作分析。採用 Rickert et al.(1996)所提出的對稱性變換車道規則進行修正，以對稱性變
換車道在同質車流下進行模擬的結果顯示在較小的煞車參數(P)下變換車道的機率會降
低，且大約在流量最大下的密度時機率最低。再以此模式分析對混合車流(5%的慢車)
的影響，在單車道和雙車道下車流都受慢車支配，且慢車又因為和前車間距長無法觸動
變換車道規則而增加影響時間。此外本研究也針對只有一台慢車對車流造成的影響作模
 24 
除了匝道車流型態造成的影響與改變外，匝道設計也有以 CA 模擬為方法的研究。
Li et al.(2007)以 Jiang et al.(2002)為基礎，但在主線和匝道上同時佈置交通號誌，分析交
通號誌對車流造成的影響。並提出主線和匝道上接近交織區域前面臨紅、綠燈時不同的
車輛更新規則。模擬結果顯示本模式較 Rui 模式可增加主線容量、維持自由流型態且不
會造成匝道上擁擠，並減少車速因為車輛無次序通過交織區域而造成的擾動，甚至避免
Rui 模式中交織區出現的車輛碰撞情形。因此作者認為同時在主線和匝道上佈置交通號
誌對高速公路車流有正面的影響。 
Jiang and Wu(2006)延伸 Jiang et al.(2002)匝道模式中考慮主線和匝道車流的交互影
響，將兩者的影響範圍從一個網格擴展到一個區域。當影響範圍逐漸擴大時主線容量也
隨之增加，但當影響範圍過大時將產生第一階的型態轉變，由自由流轉變為擁擠流。影
響範圍過大時，在主線到達率未達到臨界值前駕駛人可以自由變換車道直到到達交織區
域，但當到達率超過臨界值時因為駕駛人突然煞車而產生擁擠現象。 
Jia et al.(2005)使用 CA 模式分析加速區域設計長度對主線車流造成的影響，模式中
變換車道規則分為充許向左變換和充許向左、向右變換兩種。本研究模擬結果發現第一
種變換車道規則相較第二種變換車道規則有益，且隨著加速區域越長主線容量越大。此
外第二種變換車道規則下加速區域對系統會產生負效果，比無加速區域下的容量還低。
因此適當的加速區域長度和變換車道規則對主線容量有增加的效果。 
綜觀CA發展從早期N-S模式開始，許多修改模式相繼產生，因此Knospe et al.(2004)
以單車道同質車流的高速公路，比較 N-S、VDR、TOCA(the Time-Oriented CA)、
ER(Emmerich and Rank)、HS(Helbing and Schreckenberg)、BL 和 KKW(Kerner, Klenov, and 
Wolf)七種模式的限制與真實性。以微觀模擬得到的單一車輛車間距分佈圖、最佳速度
函數，比較七種模式的真實性。模擬結果發現 ER、HS 這兩種修正距離規則的模式較不
能呈現合理的流量-密度關係圖，且可能造成交通事故發生。其餘五種模式對於模擬高
速公路的車流型態都相當具真實性，其中又以 BL 模式最佳。由於 BL 模式考慮的駕駛
人加速行為較仔細，因此可以清楚呈現車流的三種不同型態。此外本研究提出要更接近
現實的呈現車流型態，可透過仔細描述駕駛人行為達到目的。 
茲就上述有關細胞自動機之相關文獻加以彙整如表 2.5 所示。 
表 2.5 細胞自動機文獻彙整 
作者 年份 模式型態 適用範圍 模式驗證 
Nagel and 
Schreckenberg 1992 N-S 模式 
封閉圓環與瓶
頸路段 時空軌跡圖 
Barlovic et al. 1998 VDR 模式 封閉圓環 流量 -密度關係圖 
Knospe et al. 1999 N-S 模式 雙車道高速公路 
流量 -密度關
係圖、密度-變
換車道頻率圖 
Neubert et al. 1999 － 三車道高速公路 
車 間 距 分 佈
圖、最佳速度
函數、平均速
度分佈圖、交
叉相關函數 
Knospe et al. 2000 BL 模式 封閉圓環 流量 -密度關
 26 
第三章 交通資訊之灰預測模式 
 
依據前章文獻評析結果，本研究選定用以預測交通量之方法為灰預測模式，並細分
為單元數列預測模式與多元預測模式兩類，單元數列預測模式用以預測具時間序列特性
之交通量、平均速度及佔有率等資料，多元預測模式則是針對系統中各種流量、密度及
速率間的關係，藉由微觀（microscopic）的分析，找出變數彼此間之關係，茲分述如后。 
3.1 單元數列預測模式 
3.1.1 GM(1,1)模式 
灰預測模型(Grey Forecasting Model，Grey Model，GM)，詳細說就是將離散不規則
的原始數據轉換成具指數規律的累加生成數，據此建立微分方程式，並由樣本數值產生
微分方程組求解係數，據以進行預測。GM(1,1)屬於單元數列之預測，即依據數列資料
的發展變化進行下一時階之數值預測，因此又稱為 GM(1,1)模式。 
灰預測理論包括於灰色系統理論之中，其建構模式為假設 GM 模式為ㄧ階線性常微
分方程式，透過對生成數據進行一階微分方程式求解，建立 GM 模式，再以累減生成還
原，即為灰色預測模式。 
根據灰色系統理論的定義，GM(h,N)模型的灰微分方程式定義為： 
)(
2
)1(
0
)(
)1(
1
)(
kxb
dt
xda
N
j
jj
h
i
i
i
i ∑∑
==
=
                                        （3-1） 
其中： 為係數和 ji ba ； 10 =a ； 為標準序列:)()1(1 kx ； 為比較序列)(
)1( kx j ； 
⎟⎠
⎞⎜⎝
⎛= ∑ ∑∑
= ==
2
1 1
)0()0(
1
1
)0()1( )(,),(),(
k
n
kk
kxkxkxx L
。                          （3-2） 
代入 h=1 及 N=2，可以得到 GM(1,1)模型的灰微分方程式為： 
2
)1(
11
)1(
1 bxa
dt
dx =+
                                               （3-3） 
根據 GM 模型的推導： 
)()1(, )1(1
)1(
1
)1(
1
)1(
1 kxkx
dt
dx
dt
dx −+→可轉化成前後項的差
。 
而經由逆累加運算(IAGO)，得知 )1()()1(
)0(
1
)1(
1
)1(
1 +=−+ kxkxkx 。 
再由背景值 )()1(5.0)(5.0)(,)(
)1(
1
)1(
1
)1(
1
)1(
1
)1(
1 kzkxkxtxtx =−+→的定義 。 
綜合上述，得出 GM(1,1)模型的灰差分方程式為： 
( ) ( ) 2)1(11)0(1 bkzatX =+                                             （3-4） 
亦即具有一個及一階變量的灰色模型即稱為 GM(1,1)模型。而 2
)1(
11
)1(
1 bxa
dt
dx =+
稱為
源模型，從數學觀點而言是利用序列建立近似的微分方程式。將源模型簡化得出（3-5）
 28 
( ) ( ) ( ) ( ) ( )( ) ( ) n1k ,         100%1kx
1kxˆ-1kx1ke 0
00
≤+×+
++=+
                 （3-13） 
GM(1,1)的滾動檢驗誤差為： 
( )∑
=
+=
1-n
4k
%1ke
4-n
1e
                                           （3-14） 
GM(1,1)的滾動檢驗精度為： 
( )%e-1=ε                                                    （3-15） 
3.2 多元預測模式 
3.2.1 GM(1,N)模式 
GM(1,N)模型表示：一階微分，輸入變數為 N 個，如果在序列 
( )kX i )0( Ni ,...3,2,1= 中， 
( )kX )0(1 為系統的主要行為，而 
( )kX i )0( Ni ,...4,3,2=   為影響主行為之因子，則可利用 GM(1,N)模型做分析，首先
建立原始序列 
( ) ( ) ( ) ( ){ }
( ) ( ) ( ) ( ){ }
( ) ( ) ( ) ( ){ }
( ) ( ) ( ) ( ){ }
nk
kXXXXX
kXXXXX
kXXXXX
kXXXXX
NNNNN
,...,3,2,1
,...,3,2,1
..................................................................
,...,3,2,1
,...,3,2,1
,...,3,2,1
)0()0()0()0()0(
)0(
3
)0(
3
)0(
3
)0(
3
)0(
3
)0(
2
)0(
2
)0(
2
)0(
2
)0(
2
)0(
1
)0(
1
)0(
1
)0(
1
)0(
1
=
=
=
=
=
 
建立 AGO 序列（累加生成序列） 
( ) ( ) ( ) ( ){ }
( ) ( ) ( ) ( ){ }
( ) ( ) ( ) ( ){ }
( ) ( ) ( ) ( ){ }
nk
kXXXXX
kXXXXX
kXXXXX
kXXXXX
NNNNN
,...,3,2,1
,...,3,2,1
..................................................................
,...,3,2,1
,...,3,2,1
,...,3,2,1
)1()1()1()1()1(
)1(
3
)1(
3
)1(
3
)1(
3
)1(
3
)1(
2
)1(
2
)1(
2
)1(
2
)1(
2
)1(
1
)1(
1
)1(
1
)1(
1
)1(
1
=
=
=
=
=
 
寫出標準式 
仿照 GM(1,1)的型式，將 AGO 後之數是組合成 
( ) ( ) ( )kxbkaZkX iN
i
i
)1(
2
)1(
1
)0(
1 ∑
=
=+
                                   （3-16） 
其中 
( ) ( ) ( )15.05.0 )1( 1)1( 1)1(1 −+= kXkXkZ       k=2,3,…,n                  （3-17） 
求解 
 30 
建立 AGO 序列（累加生成序列） {
{
{
{
nk
kXXXX
kXXXX
kXXXX
kXXXX
NNNN
,....4
)}(),...2(,)1(
.....................................................
)}(),...2(,)1(
)}(),...2(,)1(
)}(),...2(,)1(
)1()1()1()1(
)1(
3
)1(
3
)1(
3
)1(
3
)1(
2
)1(
2
)1(
2
)1(
2
)1(
1
)1(
1
)1(
1
)1(
1
≥
=
=
=
=
 
寫出標準式 
仿照 GM(1,1)的型式，將 AGO 後之數是組合成 
( ) ( ) ( )kxbkaZkX iN
i
i
)1(
2
)1(
1
)0(
1 ∑
=
=+
                                   （3-19） 
其中 
( ) ( ) ( )15.05.0 )1( 1)1( 1)1(1 −+= kXkXkZ      k=2,3,…,n                   （3-20） 
求解 
利用（3-20）式，並帶入各生成後的數值，可以得到： 
( ) ( ) ( ) ( )
( ) ( ) ( ) ( )
( ) ( ) ( ) ( )nxbnxbnaZnX
xbxbaZX
xbxbaZX
NN
NN
NN
)1()1(
22
)1(
1
)0(
1
)1()1(
22
)1(
1
)0(
1
)1()1(
22
)1(
1
)0(
1
...
........................................................................
3...333
2...222
++=+
++=+
++=+
 
再將上列之方程組轉乘矩陣的型式： 
( )
( )
( )
( ) ( ) ( )
( ) ( ) ( )
( ) ( ) ( ) ⎥⎥
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢⎢
⎢
⎣
⎡
⎥⎥
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢⎢
⎢
⎣
⎡
−
−
−
=
⎥⎥
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢⎢
⎢
⎣
⎡
NN
N
N
b
b
a
nXnXnZ
XXZ
XXZ
nX
X
X
MMM
2
)1()1(
2
)1(
1
)1()1(
2
)1(
1
)1()1(
2
)1(
1
)0(
1
)0(
1
)0(
1
*
...
3...33
2...22
3
2
 
根據最小平方法，令 
=NY
( )
( )
( )⎥⎥
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢⎢
⎢
⎣
⎡
nX
X
X
)0(
1
)0(
1
)0(
1
3
2
M
; 
( ) ( ) ( )
( ) ( ) ( )
( ) ( ) ( ) ⎥⎥
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢⎢
⎢
⎣
⎡
−
−
−
=
nXnXnZ
XXZ
XXZ
B
N
N
N
)1()1(
2
)1(
1
)1()1(
2
)1(
1
)1()1(
2
)1(
1
...
3...33
2...22
M
; ⎥
⎥⎥
⎥⎥
⎦
⎤
⎢⎢
⎢⎢
⎢
⎣
⎡
=
Nb
b
a
a
M
2ˆ
 
求解，得出： 
( ) NTT YBBBa 1ˆ −=  
在灰色理論中滾動檢驗所使用的符號定義為： 
( ) ( ) ( )                                         ba,ki; x: AGO MˆG 0P →•                 （3-21） 
( ) ( ) ( )( ) ( ) ( ) bkaZkxki;x: AGO MˆG 100m =+→•                        （3-22）  
 32 
第四章 GFLC 適應性匝道儀控模式 
本章分四個小節做說明，首先介紹本研究控制績效之評估準則，即高速公路用路人
之總旅行時間，而總旅行時間之估算包括行駛於主線之旅行時間及匝道等候車輛延滯時
間。第二節介紹適應性匝道儀控模式(FLRC)。第三節為本研究之核心部分，說明基因模
糊邏輯匝道儀控模式(GFLRC)整體架構及其建構流程。第四節介紹應用基因演算法建置
最佳定時匝道儀控模式(Optimal single ramp metering)之程序，並與本模式作控制績效比
較與分析。 
4.1 模式績效之計算 
於車流模擬部份，各時段高速公路主線及各上下匝道之交通量為已知資訊，本研究
於巨觀車流基本概念下，自行設計流量－速度轉換式，依據主線已知流量透過轉換式迅
速得知主線之行車速度，作為模糊控制系統之輸入變數以推估匝道各時段之儀控率，同
時計算各匝道下游子路段車輛之旅行時間及匝道等候車輛延滯時間。 
模式績效計算方面，主要包括高速公路主線旅行時間之計算及匝道等候車輛之延滯
時間，兩者時間之加總作為本模式之績效評估指標，即總旅行時間。而當用路人所花費
之旅行時間越少時，代表著匝道儀控系統之控制績效越佳，此為一求解最小化之問題，
故本研究係以總旅行時間之倒數作為基因演化之適合度，以總旅行時間最小化為目標，
進行模糊控制系統參數之校估。以下茲先介紹巨觀車流模式基本概念，如圖 4.1 所示，
之後針對主線旅行時間及匝道等候延滯時間之計算方式做說明。 
當需求流率小於容量時，可稱車流為一穩定狀況，亦即駕駛者可於路段速限規範下
行駛而保持主線車流順暢，當車流量逐漸增加時，主線之平均行駛速率亦隨之降低；若
需求流率很接近或等於容量時，主線車流則呈現為一半穩定狀態，隨後而來之主線交通
量將嚴重影響行車速度，造成行車速度明顯急劇降低；一旦需求流率大於容量時，則主
線車流係處於不穩定或壅塞情況。而在 2001 年台灣地區公路容量手冊針對了高速公路
單車道容量及自由行車速率做些探討與分析，而有以下兩點建議： 
 
圖 4.1 流量－速度巨觀車流型態 
1. 建議容量 
內側車道＝2300 pcu/ph/pl 
外側車道＝2000 pcu/ph/pl 
 34 
st  為模擬時段 
在匝道等候車輛延滯部份，當匝道需求交通量超過匝道儀控率時，即產生上匝道等
候現象。本研究之匝道等候車輛延滯時間係於每分鐘計算之，故圖 4.2 中之 T 為模擬時
間 1 分鐘，到達率為每分鐘到達之車輛數，儀控率為每分鐘允許上高速公路之車輛數，
當到達率大於儀控率即產生 BC 段，此為一分鐘之累積車輛數，而△ABC 所圍之面積即
為延滯時間。 
 
 
圖 4.2 匝道等候延滯示意圖 
Adolf. D May 運用確定性等候理論（Deterministic Queuing Theory）建立了上匝道等
候模式，此模式不考慮實際等候線長度，只是將等候之車輛加以累積，如圖 4.3 所示，
用以估算上匝道等候累積車輛數與等候延滯時間。 
本研究即以圖 4.3 說明經一段時間之模擬後匝道等候延滯時間估算方式，由圖中可
知第 3 分鐘至第 4 分鐘時顯示到達率大於儀控率，此時在上匝道處即開始產生等候車
輛，持續這種情況造成等候車輛數逐漸累加，延滯時間亦增多，最後在第 9 分鐘至第 10
分鐘剛好疏散匝道之等候車輛，此後再由第 10 分鐘開始比較到達率與儀控率，檢視是
否有等候車輛之產生，以作為估算延滯時間之依據。 
0
5
10
15
20
1 2 3 4 5 6 7 8 9 10 11 12
每分鐘為間隔
累積車
輛數
到達率
儀控率
 
圖 4.3 多時段匝道等候延滯示意圖 
 36 
(2) 依據控制人員之控制行為與習慣來訂定規則 
(3) 經由對該領域之專家進行訪談後，所獲得之知識及經驗法則 
(4) 藉由現有狀態輸入與輸出決策之實際資料建構而得 
(5) 結合第三、四種方式，初以實際資料建構，再經由專家進行增減 
(6) 藉著案例學習之方式來訂定規則 
3. 模糊化 (Fuzzification) 
當輸入變數為ㄧ明確之數值時，為了解其觸動哪幾條規則，而且觸動多大之程度，
因此必須透過隸屬函數計算其隸屬度，此即為模糊化之過程。 
4. 模糊推論 (Fuzzy inference) 
邏輯規則一般以交集（AND）、聯集（OR）或補集作為各狀態變數間之連結運算元，
而模糊推論即用來決定各邏輯規則運算之方式。其中，取決隸屬度最小值為主的即為
AND 之運算方式，而 OR 之運算方式係採用隸屬度最大者。 
5. 解模糊化 (Deffification) 
由於同ㄧ筆輸入資料可能同時觸動數條規則，解模糊化之程序即是將各邏輯規則之
推論結果予以綜整並將輸出之模糊數轉換為明確數值，亦即藉著解模糊函數轉換成適當
之非模糊數，再經由比例應對輸出，方能據以控制系統。而一般常用之解模糊化方法有
最大隸屬度法（maximum-membership method)、加權平均法(weighted average method)、
面積法(area method)、重心法（center of gravity method）等。 
本研究係依據已知交通資訊作為模糊控制系統之輸入，建置適當知識庫，透過模糊
化、模糊推論及解模糊化等運算機制推估匝道控制系統各時段之儀控率，以構建具即時
反應特性之適應性匝道儀控系統(FLRC)。本研究採取主線平均速度及匝道等候車輛數作
為狀態變數，控制變數為匝道儀控率，以交集「AND」作為各狀態變數間之連結運算元，
主觀設定邏輯規則(Logic rules)與隸屬函數(Membership function)，而解模糊化之方法採
用面積法(Area method)，以下茲就 FLRC 於邏輯規則、隸屬函數建構以及解模糊化方法
敘述如下： 
1. 邏輯規則 
本研究係依據主線速度「很快」且匝道等候車輛數「很多」而匝道儀控率「很高」
之基本原理建構模糊控制系統之規則庫，亦即以右上角至左下角為對角線，由對角線越
往右下角其控制變數之語意等級越高，而越往左上角則越低，計採用 25 條規則，如表
4.2 所示。 
 38 
0
0.2
0.4
0.6
0.8
1
0 200 400 600 800 1000 1200
匝道儀控率 (pcu/小時)
隸屬度
 
圖 4.7 匝道儀控率之隸屬函數型態 
3. 解模糊化 
本研究係採用面積法針對輸入值所觸動之規則進行解模糊化動作，以便輸出明確之
數值來進行控制。經輸入值觸動各個規則前件部之隸屬度取其較小值，再計算各個規則
後件部隸屬度下之面積及重心，最後以面積法加權求解綜整後之重心位置，亦即輸出之
決策，面積法之示意圖及其計算方式如圖 4.8 所示。 
 
圖 4.8 面積法解模糊化之示意圖 
其中，ZA 為 FLC 經面積法解模糊化後之明確數值，Ai為第 i 條規則推論結果所圍成
之面積，ci為該面積之重心位置，m 則為所觸動之規則數。 
4.3 基因模糊邏輯匝道儀控模式(GFLRC) 
本模式主要可分為兩種形式，一為獨立型匝道儀控模式，其二為整合型匝道儀控模
式。獨立型模式主要係以主線及匝道交通狀況為基礎，直接決定單一匝道之儀控率，與
其它匝道並無互動性，而本研究即以主線平均行駛速率及匝道等候車輛數推估各時間匝
道之儀控率，最終目標在於該控制路段所有駕駛者之總旅行時間達最小；而整合型模式
即在獨立型模式基礎下，另增加一項交通控制變數用以推估匝道儀控率，亦即上游匝道
儀控率，與獨立型模式之差異在於僅非以個別匝道為考慮對象，而係同時兼顧上下游之
匝道來推估儀控率，故上游匝道之儀控結果將影響下游儀控率設定決策，尤其現階段之
 40 
主線速度
儀控率 很慢 慢 普通 快 很快
很少
少
普通
多
匝
道
車
輛
數 很多
g1 g13 g25g2 ‧ ‧ ‧ ‧ ‧ ‧
  0  → 規則不予挑選
  1 →  儀控率 = 很低
  2 → 儀控率 = 低
  3 →  儀控率 = 普通  
  4 → 儀控率 = 高  
  5 →  儀控率 = 很高  
圖 4.9 GFLRC 之邏輯規則編解碼示意圖 
模式於隸屬函數之建立及編解碼部分，皆以語意等級為五之三角型態設定之，以三
角模糊數為例，其參數為 rkc 、 ckc 及 lkc ，分別代表著 k 語意等級之右底角座標、頂點座標
及左底角座標，若一個狀態（或控制）變數語意等級為五時，則此變數所須校估之參數
為 15 個。由於各等級模糊數之參數間尚有一些相對大小之關係須先加以釐清，如將這
些限制條件皆納入模式中的話，對於模式尋優之績效勢必有一定程度的影響，故本研究
運用邱裕鈞與藍武王[2001]所提出一套隸屬函數參數校估之方式，對於 FLRC 模式中兩
個狀態變數及一個狀態變數，針對語意等級二至四等三個模糊數之左右底角、等級一之
右底角以及等級五之左底角等 8 個參數進行校估，利用 9 個位置變數（ 91 ~ rr ）代表其
相對大小位置關係，而目標函數為總旅行時間最小化，上述 8 個代估之參數估算方式如
式(4-3)~(4-10)所示。 
sfrccl ×+= 1min2                                                      (4-3) 
sfrcc lr ×+= 221                                                       (4-4) 
sfrcc ll ×+= 323                                                      (4-5) 
sfrccc lrr ×+= 4312 },max{                                               (4-6) 
sfrccc lrl ×+= 5314 },max{                                               (4-7) 
sfrccc lrr ×+= 6423 },max{                                                (4-8) 
sfrccc lrl ×+= 7425 },max{                                               (4-9) 
sfrccc lrr ×+= 8534 },max{                                              (4-10) 
其中，
∑
=
−= 9
1
minmax )(
i
ir
ccsf  
上述 9 個位置變數皆以 4 個整數基因代表之，以主線平均速度此狀態變數為例可由
圖 4.10 示之，使求解之參數值其精確度可達到小數點後兩位，即各位置變數最大值為
99.99，而最小值則為 0。而本研究採用兩個狀態變數及一個控制變數，其皆為語意等級
五之三角模糊數，故染色體長度為 3×9×4＝108 個，當各位置參數依據染色體做調整後，
 42 
 
圖 4.11 蒙地卡羅轉盤示意圖 
其中，ni代表第 i 個染色體，f(ni)表第 i 個染色體之適合度，P(ni)表第 i 個染色體被選中
之機率，而 n 為族群數。 
2. 交配 (Crossover) 
交配係自成對之母代染色體中隨機產生交配點，交換彼此位元資訊，以組成兩條新
的子代染色體，藉由基因交換之動作，使得新產生之子代染色體可同時擁有母代雙方之
優良基因，進而組成更具適應能力之染色體，調整使得子代染色體之適合度較母代為優。 
經過複製程序篩選出之成對染色體，以隨機方式產生 0~1 之亂數值，若低於交配率
則進行交配，以新的子代取代母代，反之則不進行交配，直接將成對母代置回新的族群
內。針對基因交配方式，本研究除了採用雙點交配法，同時納入 Max-min-arithmetical
交配方式，點交配方式如圖 4.12 所示，第一個交配點左半部基因與第二個交配點右半部
之基因不做變動，僅是染色體中間段做基因交換動作。而 Max-min-arithmetical 交配之
運作方式如式(4-11)~(4-14)所示。 
G1t+1  = aGwt + (1-a)Gvt                                             (4-11) 
G2t+1  = aGvt + (1-a)Gwt                                             (4-12) 
G3t+1 with g3kt+1=min{gwkt, gvkt}                                       (4-13) 
G4t+1 with g4kt+1=max{gwkt, gvkt}                                       (4-14) 
其中，Git+1(i=1~4)代表產生之子代染色體，gikt代表該染色體之第 k 個基因。 
Gwt及 Gvt為獲選之母代染色體，gwkt及 gvkt代表染色體之第 k 個基因。 
a 為一設定之參數，在此設定為 0.35。 
t 代表演化之世代數。 
 
圖 4.12 雙點交配示意圖 
藉由上述兩種交配運算機制，每次交配運作時將由 2 個母代染色體產生 8 個子代染
色體，再依據染色體適合度值挑選出最佳的 2 個，置回族群中。 
 44 
 
圖 4.13 GFLC 之反覆演化運作示意圖 
4.4 最佳定時儀控模式 
定時儀控（pre-timed ramp metering）所使用之號誌週期係按不同時日事先予以設
定，為疏解重現形壅塞所實施之預防性交通控制。定時儀控可分為 Fixed－time 及 Time 
of Day/Day of week 兩種，其中 Fixed－time 運作上係採單一儀控率；而 Time of Day/Day 
of week 係當匝道實施儀控時針對不同時段來指定不同之儀控率，故本研究於上述儀控
率設定概念下，設計最佳定時儀控(Optimal single ramp metering)。 
為比較本模式與其它控制模式於兩個小時控制後之績效，本研究於傳統定時儀控策
略觀念下，擬應用基因演算法(GAs)尋求在總旅行時間最小化，各匝道其最佳儀控率組
合，此即為本研究所採取之最佳定時儀控策略，又可分為 1 段式及多段式。本研究所謂
之一段式係指在滿足兩小時控制之下，上匝道各自以一套固定儀控率進行控制；而多段
式係依據控制時段給予不同之儀控率來進行控制，以 2 段式且第一個匝道為例，即該匝
道於第一個小時內每分鐘之儀控率皆相同，第二個控制小時則以另一儀控率來做控制，
於此小節則以採取 2 段式之最佳定時儀控策略進行說明，主要包括其編解碼方式及遺傳
運算法則之運作。 
 
圖 4.14 最佳定時儀控(2 段式)之編解碼示意圖 
 46 
第五章 兩階段模糊邏輯匝道儀控模式 
本章分為 2 節說明模式建構。如圖 5.1 模式架構圖所示，第 1 節包含介紹各細胞自
動機模式，並提出本研究改良之細胞自動機模式以建構車流模擬模式，包含模式定義、
交通變數定義、模式規則之說明。第 2 節為兩階段模糊邏輯匝道儀控模式，包含第一階
段旨在判斷車流型態，以及第二階段決定匝道儀控率。茲說明如後： 
 
圖 5.1 模式架構圖 
5.1 細胞自動機模式 
自 Nagel and Schreckenberg (1992)提出第一篇以細胞自動機（CA）模擬高速公路車
流行為的研究以來（稱為 N-S 模式），由於其能以離散格位推移概念，利用簡單的跟車
及車道變換規則，能夠迅速真實模擬車流行為，甚至包括擁塞車流停停走走
（stop-and-start）狀況及擁塞車流及自由車流間之遲滯現象（hysteresis），因此，吸引相
當多學者投入研究，並提出改良模式，如 VDR 模式（Barlovic et al., 1998）、TOCA 模式
(Brilon and Wu, 1999)、E-R 模式(Emmerich and Rank, 1997)、H-S 模式(Helbing and 
Schreckenberg, 1999)、B-L 模式（Knospe et al., 2000)）、KKW 模式(Kerner et al., 2003)、
J-W 模式（Jiang and Wu, 2003），以及 L-H 模式（Lan and Hsu, 2005, 2006）。其中，L-H
模式係以 J-W 模式為基礎進一步修改車輛更新規則與變換車道規則，以適用於異質混合
車流之模擬，並藉由基本單元之界定及一般化交通變數之定義，使能更精確描述混合車
流環境中車流之時空特性。本文以 L-H 模式之 CA 規則為基礎，進一步加入匝道車輛併
入規則，俾能模擬車輛進出高速公路匝道之車流行為。本研究 CA 之基本組成、交通變
數定義，以及 CA 規則（含車輛更新規則、變換車道規則、匝道車輛併入主線規則）分
述如下。 
5.1.1 CA 之基本組成 
本研究將混合車流(mixed traffic)定義為不同種類的車輛，例如在高速公路上依車輛
 48 
將上述時間軸擴展到加總整段時間軸(T)，則車流密度變為圖 2 粗線所圍成方形的時
空範圍(A)，車輛在上面所花費的時間(t(A))，表示如式(5-2)。 
A
At
tL
ttn
Ak
t
t )(
)(
)( =Δ
Δ
= ∑
∑
Δ
Δ   (5-2) 
同樣地，傳統交通流量定義係在特定的觀測點(x)，經過一段觀測時間(T)所通過的
車輛數(m(x))，稱為流量，表示如式(5-3)前段。上下分母各乘一段很短的距離(Δx)，代表
車輛在圖 5.3 虛線所圍成橫向細條長方形的時空範圍內所行走的距離，表示如式(5-3)後
段。 
xT
xxm
T
xmxq Δ
Δ== )()()(  (5-3) 
將上述空間軸擴展到加總整段空間軸(L)，則交通流量變為圖 2 粗線所圍成方形的時
空範圍(A)，車輛在上面所行走的距離(d(A))，表示如式(5-4)。 
A
Ad
xT
xxm
Aq
x
x )(
)(
)( =Δ
Δ
= ∑
∑
Δ
Δ  (5-4) 
將式(4)與式(2)相除，得到時空範圍 A 的空間平均速率(space mean speed)，如式(5-5)
前段；上下消去 A 後，得到在時空範圍 A 車輛所行走距離除以所花費時間，表示如式(5-5)
後段。 
)(
)(
)(
)()(
At
Ad
Ak
AqAv ==  (5-5) 
上述是交通變數在二維時空的定義，對於系統整體流量、密度、速率等變數衡量，
係以車輛數為單位，如流量的量測係以單位時間，通過特定地點的車輛數，無法反映出
大小車輛對交通系統造成的影響。在真實的交通環境中，大車佔用車道範圍較大，相對
影響整體交通也較大，也會降低道路的服務水準，故以異質交通為研究背景時，傳統交
通變數顯然無法精確呈現真實交通情況。 
2. 一般化交通變數之定義 
Lan and Hsu(2005、2006)提出新的一般化交通變數定義，用來說明三維空間上車輛
細胞在道路格位隨時階動態位移的特性，可精確表現整體交通在三維空間的行為。CA
模式中新的交通變數，應包含道路的縱向、橫向二軸，加上時間軸所構成三維時空範圍
( TWL ×× )，取代原本以車輛為單位的定義，改以更細緻的基本單元細胞與格位，故原
先密度的定義改採為某一特定時間路段佔有率( )(tρ )，即以觀測路段總格位數(N)為分
母，在該時間被車輛佔有的細胞數(No(t))為分子(式(5-6)後段)，而路段上佔有的細胞數則
由每一個橫斷面該時間佔有數(NoΔy(t))加總。 
N
tN
N
tNt y
yo
o
∑
Δ
Δ
==
)(
)()(ρ  (5-6) 
以式(5-6)重複式(5-1)與式(5-2)的推導過程，可得到在三維時空範圍(S)的一般化佔有
率定義可表示如式(5-7)，代表車輛在該時空所花費的時間(t(S))。 
 50 
⎪⎪
⎪⎪
⎪⎪
⎪
⎩
⎪⎪
⎪⎪
⎪⎪
⎪
⎨
⎧
≤−≥−
>×+−
≤−≥−
≤≥
<−
≤≥×−
<−>×
×
+−=
otherwise                                     0
)1( and )1( and                                       
))(( if      )1(
)1( and )1( and                                       
 )(T and )( if                                 
)1( and                                       
 )( and )( if            
)1( and )( if                        
)1()( i
mstTmstH
mstT
W
VW
(t)v
(t)Tms
mstTmstH
mstmstH
W
VW
mstH
mstTmstH
W
VW
(t)v
ms(t)H
mstHmstT
(t)vW
VWVL
tOtO
ii
i
i
i
ii
i
i
ii
i
i
ii
i
(5-10) 
⎪⎪
⎪⎪
⎩
⎪⎪
⎪⎪
⎨
⎧
≤−≥−
>×+−
≤−≥−
≤≥×
<−
≤≥×−
<−>×
+−=
otherwise                                     0
)1( and )1( and                                       
))(( if       )1(
)1( and )1( and                                       
 )(T and )( if                      )(
)1( and                                      
 )( and )( if          )(
)1( and )( if                         
)1()( i
mstTmstH
mstTVW(t)Tms
mstTmstH
mstmstHVWtv
mstH
mstTmstHVWms(t)H
mstHmstTVWVL
tqtq
ii
ii
ii
ii
i
iii
ii
 (5-11) 
WtO
tqtv
)(
)()( =                                                 (5-12) 
5.1.3 CA 規則 
本研究發展開放式高速公路路段之混合異質車流 CA 模擬模式，除考慮 L-H 模式之
車輛更新與變換車道規則為基礎外，另加上匝道車流併入主線規則。說明如下： 
1. 車輛更新規則 
步驟 1：決定車輛干擾項的隨機值 
Pb 代表前方不遠的車輛煞車；P0 代表交通擁擠下游車輛的延滯啟動；Pd 代表其他
狀況。 
⎪⎩
⎪⎨
⎧
≥=
<−=
=
+
+
 casesother  allin     :
   and     0 if    :
   and   1 if    :
))(,,),(( ,0
 1
1
d
ckstn
shnb
nshn
p
ttvp
ttSp
tStttvp                       (5-13) 
其中 )(/ tvdt nnh = , )),(min( kns htvt = ，tst 代表車輛停止的時間必須超過一段設定的
時間 tk,c 才會讓駕駛變得較不敏感。th 代表本車等速行駛到前車後方所需的時間，dn 為
本車與前車間距，vn(t)代表本車在本時階的速度，hk 代表本車道會受前面車煞車影響的
範圍，Sn+1代表前車狀態，k 代表車輛種類。 
步驟 2：加速 
如果前方車輛沒有煞車，本車也沒有煞車或與前者之車頭距還很長，則代表本車在
 52 
(3)檢視前方車間程(distance gap） 
推估下一時階本車前方的車間程。若車間程太短，則判斷本車欲變換的目標車道下
一個時階前方車間程，是否大於本車所在車道下一個時階前方的車間程。若是，則代表
目標車道讓駕駛人有較大的空間前進，更會刺激其變換車道。 
(4)檢視安全間距 
推估欲變換之目標車道前後車下一時階之車間距。若該車間距大於前車速度，則表
示本車變換到目標車道時，不致影響後車，以確保安全。 
(5)隨機項 
由於實際狀況下，即便前述規則均符合時，部分車輛也不會進行變換車道的行為。
因此，本文設定有一定機率比例（隨機項，Pc）的車輛（較保守的駕駛人），即便前述
變換車道規則均符合時，仍會維持在原車道上行駛。 
 
(資料來源：Lan and Hsu, 2005) 
圖 5.4 二車道道路車輛變換車道行為示意圖 
以一輛左方車道欲變換至右方車道之車輛為例，依照前述條件，變換車道規則可寫
為： 
若 )()( ,, tvtv nlnl >  and )()( , tvtv nln >  
and ))1(,min()(, +> tvdtg neffnr nl                                             (5-19) 
and ))1(,min()( ,,, +> tvdtg r nbeffnbr nb                                            (5-20) 
則 進行車道變換 
其中，g 為車間程，下標 b 代表目標車道上游鄰近的車輛；l 代表下游鄰近的車輛，上標
+代表目標車道。 
3. 匝道車輛併入主線規則 
匝道併入規則為匝道上車輛只需檢視主線車間程是否達到可併入之安全間距，符合
此條件，匝道車輛即併入主線，否則在匝道等候，直到安全間距出現為止。併入規則之
執行步驟說明如下： 
步驟 1：檢視匝道是否有等候車輛。若有（即 Q(t) > 0），則執行步驟 2。否（即 Q(t) = 0），
則更新時階 t=t+1，並令 Q(t)=RA(t)，並繼續執行步驟 1，直到有車輛到達匝道
為止。其中，Q(t)表時階 t 匝道等候車輛長度（輛）。RA(t)為時階 t 之匝道到達
車輛數。 
步驟 2：檢視主線車道安全間距。檢視主線外側車道上游鄰近的車輛與下游鄰近的車輛
之車間程是否大於可接受最小間距。即：若 min,. )()( onnbnl gtxtx >− ++  則執行步驟
 54 
流。 
(5) If 「主線車流速度」=中 and 「主線車流量」=高，then 「車流型態」=輕微同步
流。 
(6) If 「上一個時階車流型態」≠大範圍擁擠流 and 「主線車流速度」=低 and 「主線
車流量」=低 and 「速度變化率」=負 and 「流量變化率」=負 and 「速度變化率
/流量變化率」=低，then 「車流型態」=大範圍擁擠流。 
(7) If 「上一個時階車流型態」=自由流 and 「主線車流速度」=中 and 「主線車流量」
=高 and 「速度變化率」=負 and 「流量變化率」=負 and 「速度變化率/流量變化
率」=低，then 「車流型態」=輕微同步流。 
(8) If 「上一個時階車流型態」≠大範圍擁擠流 and 「主線車流速度」=中 and「主線
車流量」=高 and 「速度變化率」=負，then 「車流型態」=輕微同步流。 
(9) If 「上一個時階車流型態」≠大範圍擁擠流 and 「主線車流速度」=中 and 「主線
車流量」=高 and 「流量變化率」≠負，then 「車流型態」=輕微同步流。 
(10) If 「上一個時階車流型態」≠大範圍擁擠流 and 「主線車流速度」=低 and 「主線
車流量」=低 and 「速度變化率」≠負，then 「車流型態」=強烈同步流。 
(11) If 「上一個時階車流型態」≠大範圍擁擠流 and 「主線車流速度」=低 and 「主線
車流量」=低 and 「流量變化率」≠負，then 「車流型態」=強烈同步流。 
(12) If 「上一個時階車流型態」=大範圍擁擠流 and 「主線車流速度」=低 and 「主線
車流量」=低 and 「速度變化率」=正 and 「流量變化率」=正 and 「速度變化率
/流量變化率」=低，then 「車流型態」=強烈同步流。 
(13) If 「上一個時階車流型態」=大範圍擁擠流 and 「主線車流速度」=低 and 「主線
車流量」=低 and 「速度變化率」=正 and 「流量變化率」=正 and 「速度變化率/
流量變化率」=高，then 「車流型態」=大範圍擁擠流。 
(14) If 「上一個時階車流型態」=大範圍擁擠流 and 「主線車流速度」=低 and 「主線
車流量」=低 and 「速度變化率」≠負，then 「車流型態」=大範圍擁擠流。 
(15) If 「上一個時階車流型態」=大範圍擁擠流 and  「主線車流速度」=低 and  「主
線車流量」=低 and 「流量變化率」≠負，then 「車流型態」=大範圍擁擠流。 
 
(資料來源：Jiang and Wu, 2003） 
圖 5.5 車流型態分布圖 
2. 隸屬函數 
強烈同步流 
輕微同步流 
大範圍擁擠流 
密度 
自由流 
流量 
 56 
 
)1()(       
)(
))((min)(
)1()(       
))((max
))((max)(
)(
⎪⎪⎩
⎪⎪⎨
⎧
−>−
−≤−
=
Δ
Δ
Δ
tvtvif
tv
tvtv
tvtvif
tv
tvtv
td
t
t
t
v                          (5-24) 
)(
)()(
td
tdtc
q
v=                                                     (5-25) 
其中 t 為決策點，t-1 為上一個決策點，dq(t)為流量變化率，dv(t)為速度變化率，c(t)為速
度變化率/流量變化率。 
3. 解模糊化 
本研究採用最大隸屬度法，針對輸入值所觸動之規則進行解模糊化動作，以便輸出
明確之判斷結果，主要觀念係以具有最大可能性的推論結果作為模糊輸出。最大隸屬度
法係以所有觸動規則中，觸動程度最大者其輸出模糊結果之中心值作為輸出結果，此種
解模糊化方法計算較為簡便。 
5.2.2 第二階段匝道儀控率之決定 
第二階段旨在決定匝道儀控率。獨立型及整合型模式之隸屬函數及解模糊化方法均
相同，僅狀態變數及模糊規則不同。以下分別說明此兩種模式之邏輯規則、隸屬函數設
定及解模糊化方法。 
一、獨立型模式 
1. 邏輯規則 
依據主線車流型態愈趨向「自由流」且匝道等候車輛愈多，則儀控率愈高之原則下，
進行模糊規則設計，如表 5.1 所示。原則上，以右上角至左下角為對角線，由對角線越
往右下角其控制變數之語意等級越高，而越往左上角則越低，共計採用 20 條規則。 
表 5.1 獨立型模式之規則庫 
主線車流型態 儀控率 
(pcu/小時) 自由流 輕微同步流 強烈同步流 大範圍擁擠流
很少 普通 低 很低 很低 
少 高 普通 低 很低 
普通 高 高 低 低 
多 很高 高 普通 低 
匝道等候
長度(輛) 
很多 很高 很高 高 普通 
2. 隸屬函數 
獨立型模式考量二個狀態變數（主線車流型態、匝道等候長度）及一個控制變數（匝
道儀控率）。匝道等候長度與匝道儀控率皆為語意等級五之三角模糊數，首先針對語意
變數之最大值作設定，再以均等分方式決定各模糊數三個點之座標值，如圖 5.7 所示。 
 
 58 
少 普通 普通 低 很低 
普通 普通 高 普通 很低 
多 高 高 普通 低 
長度 
(輛) 
很多 高 很高 高 低 
(d)上游儀控率高 
車流型態 儀控率 
(pcu/小時) 自由流 輕微同步流 強烈同步流 大範圍擁擠流
很少 普通 低 低 很低 
少 高 普通 低 很低 
普通 高 高 普通 很低 
多 很高 高 普通 低 
匝道等候
長度 
(輛) 
很多 很高 很高 高 低 
(e)上游儀控率很高 
車流型態 儀控率 
(pcu/小時) 自由流 輕微同步流 強烈同步流 大範圍擁擠流
很少 普通 低 低 低 
少 高 普通 低 低 
普通 高 高 高 低 
多 很高 高 高 普通 
匝道等候
長度 
(輛) 
很多 很高 很高 高 普通 
 
 60 
不同分析預測一筆、二筆、三筆至五筆等之預測績效，由於預測時只校估一次參數，應
此稱為靜態模式。滾動模型則於分析時自動剔除先前筆數資料，只保留近期筆數資料進
行預測，透過滾動始終使用最近期之歷史資料，滾動模型分為 4、5、6、7、8 等 5 種時
階，每滾動一次便執行參數校估一次，因此又稱為 RGM(1,1)模式（即每 4、5,…,8 筆資
料校估參數一次，再進行預測），探討不同滾動學習時階之模式預測精確度變化。 
交通量、平均速度及佔有率之時間序列數值，可建立 RGM(1,1)一階單變數的灰色
模型，以最少 4 筆連續時間之交通資訊之預測為例，其系統如圖 6.1 所示。輸入資料最
少需要 4 筆，預測第 1 筆之結果與真實資料相減結果百分比即為預測之誤差，亦可以預
測 後 續 更 多 筆 數 ， 但 其 預 測 績 效 需 加 以 檢 視 。 在 灰 預 測 的 模 式 中( ) [ ]1,0,~ ∈⊗−⊗+⊗=⊗ αα AAAA ，使用α作為權重值，由於α值的調整可以降低預測誤
差結果，通常以試誤法調整權重值，以求達到模式最佳化，而一般均採等權重方式將α
設定為 0.5 進行模式績效預測，本研究以權重方式將α設定為 0.5，分別針對交通量、平
均速度，以及佔有率等三項交通資訊進行預測模型之建構、驗證與比較。 
 
 
圖 6.1 RGM(1,1)灰預測系統 
 
1.交通量 
將 5 日之樣本資料，以 1 分鐘及 5 分鐘為單位，分別建構不同滾動時階之 RGM(1,1)
模型及不滾動之 GM(1,1)模型，結果如表 6.1、6.2 所示。由表 6.1 知，一分鐘單位資料，
以 5 日之平均預測誤差而言，預測結果顯示滾動時階愈長績效反而愈差。此與傳統統計
模型，資料樣本愈多愈精確之特性明顯不同。而 GM(1,1)模型（不滾動）之預測誤差則
高達 42.30%，誤差極為嚴重，顯示滾動機制之重要性。表 6.2，五分鐘單位資料之平均
預測誤差顯示，預測結果明顯優於一分鐘單位資料，就模式特性而言，顯示資料單位愈
大，預測精確度愈高，就滾動時階而言，同樣顯示滾動時階愈長，預測績效有愈差之趨
勢。 
由交通量平均預測誤差結果得知靜態 GM(1,1)模型（即不滾動）之預測誤差則高達
42.30%（一分鐘單位資料），五分鐘單位資料之預測誤差亦高達 35.22%，誤差極為嚴重，
顯示靜態之 GM(1,1)模型在長期預測績效並不理想，透過滾動機制，將預測筆數減少至
4 筆時，能凸顯灰預測之績效，就滾動時階之平均預測誤差來看，一分鐘單位資料預測
誤差為 12.38%，五分鐘單位資料誤差為 5.94%，顯示滾動灰預測模式在短期交通量上有
良好之預測能力。 
表 6.1 不同滾動時階之交通量平均預測誤差 
RGM(1,1)之滾動時階 不滾動 資料日期 
4 5 6 7 8 GM(1,1) 
D1 14.43% 18.94% 21.27% 22.38% 23.82% 35.83% 
D2 10.66% 14.57% 16.50% 17.86% 18.78% 44.33% 
 62 
2.交通量 
以相同 5 日之樣本資料分別建構平均速度在不同滾動時階之 RGM(1,1)模型及不滾
動之 GM(1,1)模型，一分鐘單位資料及五分鐘單位資料預測結果分別如表 6.5、6.6 所示。
由表 6.5 知，一分鐘單位資料，以 5 日之平均預測誤差而言，顯示滾動時階愈長，預測
績效反而愈差，不過，各滾動時階之預測誤差相距不大，均在 0.5%以下，顯示以 RGM(1,1)
預測平均速度較預測交通量之績效更好。而 GM(1,1)模型（不滾動）之預測誤差為
3.48%，準確率已較預測交通量時大幅改善。表 6.6，五分鐘單位資料之平均預測誤差顯
示，預測結果明顯優於一分鐘單位資料，顯示資料單位愈大，預測精確度愈高，但預測
誤差差距不大，僅在 1％左右。 
在 RGM(1,1)不同預測長度之績效表現方面(D1)，平均速度預測之後 5～25 分鐘之
資料（即預測後 1～5 筆），結果如表 6.7、6.8 所示。由表知，以各滾動時階之平均誤差
而言，具有預測長度愈長，誤差率有愈高之趨勢，不過，誤差率增加幅度不大，顯示
RGM(1,1)預測平均速度方面具有穩定的預測精確度。 
表 6.5 不同滾動時階之平均速度平均預測誤差 
RGM(1,1)之滾動時階 不滾動 資料日期 
4 5 6 7 8 GM(1,1) 
D1 2.23% 2.78% 3.15% 3.22% 3.35% 4.87% 
D2 1.79% 2.26% 2.51% 2.66% 2.87% 3.28% 
D3 1.42% 1.80% 2.02% 2.12% 2.20% 2.88% 
D4 1.60% 2.06% 2.34% 2.49% 2.60% 3.17% 
D5 1.64% 2.11% 2.37% 2.55% 2.65% 3.17% 
平均 1.74% 2.20% 2.48% 2.61% 2.73% 3.48% 
（資料單位：1 分鐘一筆，預測長度＝1 筆） 
表 6.6 不同滾動時階之平均速度平均預測誤差 
RGM(1,1)之滾動時階 不滾動 資料日期 
4 5 6 7 8 GM(1,1) 
D1 0.91% 1.13% 1.23% 1.30% 1.32% 1.71% 
D2 0.86% 1.00% 1.10% 1.15% 1.18% 1.61% 
D3 0.79% 0.95% 1.06% 1.14% 1.20% 1.55% 
D4 0.68% 0.90% 1.01% 1.08% 1.15% 1.67% 
D5 0.92% 1.15% 1.26% 1.34% 1.36% 1.79% 
平均 0.83% 1.03% 1.13% 1.20% 1.24% 1.67% 
（資料單位：5 分鐘一筆，預測長度＝1 筆） 
表 6.7 不同預測長度之平均速度平均預測誤差 
RGM(1,1)之滾動時階 預測長度 
4 5 6 7 8 
平均誤差 
1 筆 1.74% 2.20% 2.48% 2.61% 2.73% 2.35% 
2 筆 2.11% 2.66% 2.94% 3.26% 3.34% 2.86% 
3 筆 2.36% 3.12% 3.48% 3.53% 3.61% 3.22% 
 64 
（資料單位：5 分鐘一筆，預測長度＝1 筆） 
平均佔有率在 RGM(1,1)不同預測長度之績效表現方面(D1)，平均佔有率預測之後 5
～25 分鐘之資料（即預測後 1～5 筆），結果如表 6.11、6.12 所示。由表知，以各滾動時
階之平均誤差而言，具有預測長度愈長，誤差率有愈高之趨勢。以表 6.11 為例，預測後
1 筆之平均誤差為 6.18%，預測後 5 筆之平均誤差增加至 9.81%；表 6.12 預測後 1 筆之
平均誤差為 12.41%，預測後 5 筆之平均誤差增加至為 16.87%。 
表 6.11 不同預測長度之平均佔有率平均預測誤差 
RGM(1,1)之滾動時階 預測長度 
4 5 6 7 8 
平均誤差 
1 筆 6.18% 7.46% 8.39% 8.60% 8.98% 7.92% 
2 筆 6.96% 8.46% 9.59% 9.75% 9.86% 8.92% 
3 筆 7.83% 9.51% 10.61% 10.77% 10.98% 9.94% 
4 筆 8.69% 10.62% 11.73% 11.80% 11.87% 10.94% 
5 筆 9.81% 12.03% 12.54% 13.08% 13.76% 12.24% 
（資料單位：1 分鐘一筆，預測長度＝1 筆） 
表 6.12 不同預測長度之平均佔有率平均預測誤差 
RGM(1,1)之滾動時階 預測長度 
4 5 6 7 8 
平均誤差 
1 筆 12.41% 15.75% 17.73% 18.88% 19.80% 16.91% 
2 筆 13.22% 16.21% 18.15% 19.28% 20.76% 17.52% 
3 筆 14.51% 17.43% 19.38% 20.65% 21.11% 18.62% 
4 筆 15.47% 18.17% 20.19% 21.43% 22.52% 19.56% 
5 筆 16.87% 19.02% 20.89% 22.21% 23.62% 20.52% 
（資料單位：5 分鐘一筆，預測長度＝1 筆） 
 
4.小結 
由以上各小節之比較分析可知，RGM(1,1)模型明顯優於不滾動之 GM(1,1)模型，且
RGM(1,1)模型具有滾動時階愈少、預測長度愈短，其準確度愈高之特性。不過，GM(1,1)
模型於交通量預測方面則明顯表現不佳，但在平均速度及佔有率預測方面，也具有不錯
的預測績效。 
而原始資料單位的使用，交通量及平均速度預測結果顯示，資料單位愈大，其預測
精確度愈準確，其中，以滾動時階為 4 之模型，其預測結果最佳，一分鐘單位資料分析
結果，預測後 1 筆交通量之誤差率為 12.38%，平均速度為 1.74%，五分鐘單位資料其預
測後 1 筆交通量之誤差率為 5.94%，平均速度為 0.83%。而在平均佔有率方面，原始資
料則為單位愈小預測準確度愈高，一分鐘資料分析結果，誤差率為 6.18%，五分鐘資料
誤差率為 12.41%。 
就預測長度而言，滾動時階為 4 之模型不論在一分鐘或五分鐘單位資料上，其預測
後 5 筆交通資訊之誤差率，交通量分別為 17.51%、8.31%，平均速度為 3.46%、2.49%，
佔有率為 9.81%、16.87%。以 MAPE 績效指標等級分析而言，RGM(1,1)模型屬於高精
確度的預測模式。 
 66 
灰關聯序列 t=1 t=2 t=3 t=… t=1440
比較序列
3= )()0(3 tx  
26 17 28 … 35 
比較序列
4= )()0(4 tx  
31 33 16 … 43 
比較序列
5= )()0(5 tx  
24 21 32 … 29 
比較序列
6= )()0(6 tx  
20 23 17 … 27 
以辨識係數 ζ＝0.5，等權重進行灰關聯分析，得出各比較序列與參考序列之關聯
度大小排序依序為序列 4>序列 3>序列 6>序列 5>序列 1>序列 2，即下游後一支偵測器
之交通量資料關連度最高，上游前一支偵測器之交通量資料次之，各比較序列之灰關聯
係數如表 6.14 所示。此關連度分析結果將作為構建 GM（1,N）模式，變數選取優先順
序的依據。 
表 6.14 交通量預測變數灰關聯係數表 
比較序列 1 2 3 4 5 6 
灰 關 聯 係
數 
0.6
839 
0.5
804
0.8
073
0.8
176
0.7
245 
0.7
476 
 
2.平均速率 
以滾動時階 4 之 RGM（1,1）模式 Day-3 之平均速度原始序列資料作為灰關聯分析
之參考數列即 )()0(0 tx ，比較數列依序為同一偵測器之交通量資料（ )()0(1 tx ），同一偵測器
之佔有率資料（ )()0(2 tx ），觀測路段上游前一支偵測器之平均速度資料（ )()0(3 tx ），觀測
路段下游後一支偵測器之平均速度資料（ )()0(4 tx ），前一日同一偵測器之平均速度資料
（ )()0(5 tx ），前一週同一偵測器之平均速度資料（ )()0(6 tx ）等六項。其序列資料如表 6.15
所示。 
表 6.15 平均速度預測變數灰關聯序列表 
灰關聯序列 t=1 t=2 t=3 t=… t=1440
參 考 序 列
= )()0(0 tx  
99.78 103.89 96.89 … 99.67 
比 較 序 列
1= )()0(1 tx  
31 21 27 … 30 
比 較 序 列
2= )()0(2 tx  
4.33 3.00 3.33 … 4.00 
比 較 序 列
3= )()0(3 tx  
101.11 98.78 93.67 … 98.67 
比 較 序 列
4= )()0(4 tx  
101.22 99.44 99.22 … 97.33 
比 較 序 列
5= )()0(5 tx  
99.44 103.78 102.56 … 101.89 
 68 
分析比較，顯示歷史資料與參考序列有較高之關連度，各比較序列之灰關聯係數如表
6.18 所示。此關連度分析結果將作為構建 GM（1,N）模式，變數選取優先順序的依據。 
 
表 6.18 佔有率預測變數灰關聯係數表 
比較序列 1 2 3 4 5 6 
灰關聯係數 0.6
13
7 
0.3
42
0 
0.9
87
0 
0.9
80
3 
0.9
79
2 
0.9
75
7 
 
二、RGM（1,N）模式 
以交通量、平均速度及佔有率資料分別建立具滾動特性之 RGM（1,N）模式。首先
將全部因子帶入建立 RGM（1,6）模式，計算預測精確度，再依據灰關聯分析之模式中
變數之關聯性排序，剔除相關係數最低之因子，依序建立 RGM（1,5）、RGM（1,4）…RGM
（1,1）等模式，在 RGM（1,N）模式中找出預測精確度最高之最佳多階灰預測模式。 
 
1.交通量 
建立 GM（1,N）模式首先選定原始序列，原始序列包含下列 7 項： 
(1) 參考序列：路段觀測之偵測器交通量資料。 
(2) 比較序列 1：同一偵測器之平均速度資料。 
(3) 比較序列 2：同一偵測器之佔有率資料。 
(4) 比較序列 3：上游前一支偵測器交通量資料。 
(5) 比較序列 4：下游後一支偵測器交通量資料。 
(6) 比較序列 5：前一日同一偵測器之交通量資料。 
(7) 比較序列 6：前一週同一偵測器之交通量資料。 
將原始序列進行累加生成，進行參數運算，在 RGM（1,6）模式中得出 rolling1 之
參數為： 
a 32.5311    
b1 3.8554  b1/a 0.1185
b2 -82.3037  b2/a -2.53
b3 10.0816  b3/a 0.3099
b4 3.9197  b4/a 0.1204
b5 8.9398  b5/a 0.2748
b6 1.3131  b6/a 0.0403
帶入微分方程式可得： 
)1(
66
)1(
55
)1(
44
)1(
33
)1(
22
)1(
11
)1(
0
)1(
0 XbXbXbXbXbXbaX
dt
dx −−−−−=+      ( 5 . 1 ) 
微分方程的函數為： 
)()()()()()(
))()()()()()()1(()(ˆ
)1(
6
6)1(
5
5)1(
4
4)1(
3
3)1(
2
2)1(
1
1
)1(
6
6)1(
5
5)1(
4
4)1(
3
3)1(
2
2)1(
1
1)0(
0
)1(
0
tX
a
btX
a
btX
a
btX
a
btX
a
btX
a
b
etX
a
b
tX
a
b
tX
a
btX
a
b
tX
a
btX
a
bXtX at
++++++
−−−−−−= −  ( 5 . 2 ) 
 70 
3.佔有率 
操作方式亦同交通量。將原始序列進行累加生成，進行參數運算，在 RGM（1,6）
模式中得出 rolling1 之參數為： 
a 2985.325    
b1 764.911  b1/a 0.2562
b2 -11.8323  b2/a -0.0039
b3 264.676  b3/a 0.0886
b4 -1332.94  b4/a -0.4465
b5 -2503.52  b5/a -0.8386
b6 508.8029  b6/a 0.1704
RGM（1,6）模式序列總計 rolling1436 次，將 1436 筆預測資料以平均百分誤差
（MAPE）計算精確度，取其平均值得出佔有率 RGM（1,6）模式預測精確度為 95.56%。
剔除關聯性最低之比較序列 2（同一偵測器之佔有率資料），建立 RGM（1,5）模式，得
出預測精確度，由表 6.21 知，佔有率 RGM（1,5）模式之預測績效屬於高精確度之預測
模式，預測準確度高達 98.95%，優於單元預測模式 RGM（1,1）之預測精確度 95.09％
（預測誤差 4.91%）；而在多元預測模式中發現，準確度不具有隨著輸入變數減少而遞
減的趨勢，而是呈現不規則的組合，RGM(1,6)之預測準確度 95.56%低於 RGM(1,5)，
RGM(1,3)次之為 93.96%，預測準確率最低為 RGM(1,1)75.11%。 
 
表 6.21 佔有率 RGM（1,N）模式之預測精確度彙整表 
RGM(1,N) 準確度％ 
RGM(1,6) 95.56% 
RGM(1,5) 98.95% 
RGM(1,4) 81.18% 
RGM(1,3) 93.96% 
RGM(1,2) 89.79% 
RGM(1,1) 75.11% 
 
6.1.3 小結 
依據 6.1.1 節之 RGM（1,1）模式，其就本身資料序列進行預測結果顯示，其預測
精確度具有不錯的水準，且具有單位時間越長、滾動時階越短，預測精確度越高的趨勢。
此節係考慮整體環境中，有許多因素會影響預測序列資料的變化，即以 RGM（1,1）最
佳預測模式-五分鐘單位資料，滾動時階 4 之模式，進一步構建多元預測模式-RGM（1,N）
模式，探討其預測精確度；應用同一偵測器之交通量、速度、佔有率資料，以整合方式
同時進行預測，其變數包括三者間之關連變數、上下游偵測器資料、前一日、前一週歷
史資料等。GM（1,N）模式構建初期，先以灰關聯方法分析模式中變數與預測準確度之
相關係數，找出影響預測準確值之主因變數，最後以滾動設計構建 RGM（1,N）模式，
在 RGM（1,N）模式中找出最佳多階灰預測模式，研究結果顯示如后。 
就多元預測模式 RGM（1,N）而言，在資料單位一分鐘一筆之預測結果中，交通量
以 RGM（1,6）表現最佳，預測後一筆之準確度為 94.56%，平均速度以 RGM（1,6）表
現最佳，預測後一筆之準確度高達 99.95%，佔有率以 RGM（1,5）表現最佳，預測後一
筆之準確度為 95.56%。與單元預測模式 RGM（1,1）之結果比較，不論在交通量、平均
 72 
0
200
400
600
800
1000
1 3 5 7 9 11 13 15 17 19 21 23 25 27 29 31 33 35
時段
流量(pcu/時)
(單車道)
 
圖 6.4 上匝道之流量型態 
各時段上匝道流量推估係利用流量變動範圍乘以（隨機值－0.5）再加上圖 6.4 中各
時段流量平均值，在此假設流量變動範圍為 800，而所產生之隨機值則介於 0~1 之間。
藉由上述主線上游端及上匝道流量推估方式產生 36 個時段之車流量，各時段以五分鐘
為單位，而該時段內每分鐘流量固定相同，再依比例分配建立 36 個 O-D 表，取得各時
段各下匝道之流量，以作為車流狀況模擬之依據，本研究之高速公路 O-D 資料如表 6.23
所示，在此所呈現係為時段二之 O-D 表。 
表 6.23 驗證中時段二之 O-D 表 
 1 2 3 4 5 6 下匝道 
1 － 29 36 15 7 10 97 
2  － 12 15 4 8 39 
3   － 13 25 10 48 
4    － 18 26 44 
5     － 59 59 
6      － 0 
上匝道 0 29 48 43 54 113 287 
由上述 36 個 O-D 表設計流量資料情境二，依據情境二之流量加減 10%產生情境ㄧ
及情境三，如表 6.24 所示，故本研究所構建之匝道儀控模式即在此三種模擬情境下評估
各模式之控制績效並做比較。 
表 6.24 情境設計表 
 流量變動範圍 
情境ㄧ －10% 
情境二 － 
情境三 ＋10% 
6.2.2 模式參數分析及設定 
基因演算法整個演化過程中，於參數設定上主要包括族群數、交配率、突變率及成
熟率，隨著參數值之變化，其達到收斂之世代數、時間或尋優之結果等亦有所不同，故
此小節即以情境ㄧ為例，調整族群數、交配率及突變率等參數值，如表 6.25 及表 6.26
所示，以了解、說明模式參數對整體尋優結果之影響。 
 74 
此種儀控策略係採主觀方式設定模糊控制系統之參數，依據主線行車速度及匝道等
候車輛數推估匝道儀控率，於兩個小時之實施結果顯示總旅行時間為 4963.83 小時。 
三、最佳定時儀控模式 
本研究應用基因演算法所構建之最佳定時儀控模式，於族群數＝80、交配率＝0.7、
突變率＝0.01、成熟率＝80%等參數值設定下，以最佳定時儀控(1 段式)設計概念，依據
控制時段建置最佳定時儀控(多段式)模式，以情境一為例，比較分時段控制之儀控績效，
茲列舉如表 6.27 所示。由該表可知以最佳定時儀控(4 段式)之控制績效為最佳，即總旅
行時間為最小，依據時段控制之績效呈現一開口向上之凹曲線，如圖 6.5 所示。 
表 6.27 最佳定時儀控(多時段)之控制績效 
 總旅行時間(小時) 
1 段式 4894.31 
2 段式 4790.24 
4 段式 4777.08 
6 段式 4782.15 
8 段式 4777.73 
10 段式 4786.73 
12 段式 4791.02 
20 段式 4798.33 
24 段式 4820.48 
30 段式 4819.39 
4700
4750
4800
4850
4900
4950
1 2 3 4 5 6 7 8 9 10
控制模式
總旅行時間
(小時)
 
圖 6.5 最佳定時儀控(多時段)之控制績效 
圖 6.5 顯示上匝道於兩個小時內僅採用單一儀控率時之控制績效最差，當匝道採取
2 段式時之控制績效則明顯變佳，而採取 4 段時之控制結果最佳，隨著採取多段式其績
效皆顯示比 4 段式差，說明了採取多段式之最佳定時儀控雖能有效減少總旅行時間，然
因染色體之長度隨著段式之遞增而增加，故造成基因演化尋優結果不佳。藉由上述之績
效比較以 4 段式為最優，故本研究於後續模式績效比較將以單一儀控率及最佳定時儀控
(4 段式)與其它儀控模式進行比較分析，以下茲就最佳定時儀控於情境一之控制結果作
說明。 
1.最佳定時儀控(1 段式) 
 76 
匝道車輛紓解率則較低。然表中所列之邏輯規則卻並非完全呈現此種趨勢，原因其一在
於模式於基因演化尋優過程當中，係因某個匝道設定之儀控率普遍較低，而其它匝道之
儀控率較高情況下，所求得之總旅行時間為最小，故上述即為各匝道儀控率綜整推估下
之結果，不同一般主線速度越快且匝道等候車輛數越多時，而儀控率越高之趨勢；其二，
並不能僅就上述之規則直接推估匝道儀控率，以最右下角之規則而言，當主線速度越快
且匝道等候車輛越多時所推估之儀控率很低基本上並不適用，原因在於本研究係應用基
因模糊邏輯建構匝道儀控系統，納入模糊之概念，不同於一般邏輯控制系統僅就單一條
規則直接推估儀控率，本模式儀控率之推估係透過好幾條規則綜整所得之結果。 
(2) 各語意變數之最佳隸屬函數如圖 6.6、圖 6.7、圖 6.8 所示。 
0
0.2
0.4
0.6
0.8
1
0 25 50 75 100
主線平均速度 (公里/小時)
隸屬度
 
圖 6.6 獨立型模式之主線平均速度最佳隸屬函數示意圖 
0
0.2
0.4
0.6
0.8
1
0 5 10 15 20
匝道等候車輛數 (pcu)
隸屬度
 
圖 6.7 獨立型模式之匝道等候車輛數最佳隸屬函數示意圖 
 78 
4770.53 小時，所挑選之規則數為 100 條，各變數之最佳隸屬函數如圖 6.10、6.11、6.12、
6.13 所示。 
0
0.2
0.4
0.6
0.8
1
0 25 50 75 100
主線平均速度 (公里/小時)
隸屬度
 
圖 6.10 整合型模式之主線平均速度最佳隸屬函數示意圖 
0
0.2
0.4
0.6
0.8
1
0 5 10 15 20
匝道等候車輛數 (pcu)
隸屬度
 
圖 6.11 整合型模式之匝道等候車輛數最佳隸屬函數示意圖 
0
0.2
0.4
0.6
0.8
1
0 200 400 600 800 1000 1200
上游匝道儀控率 (pcu/小時)
隸屬度
 
圖 6.12 整合型模式之上游匝道儀控率最佳隸屬函數示意圖 
 80 
1.匝道不實施儀控時，模擬兩小時之總旅行時間為 6182.17 小時。 
2.FLRC 模式於兩個小時模擬後，總旅行時間為 6154.25 小時。 
3.匝道採最佳定時儀控(1 段式)時，其染色體長度為 12，達到收斂之世代數為 17，最佳
染色體為 042310420622，模擬兩小時之總旅行時間為 5884.78 小時。 
4.匝道採最佳定時儀控(4 段式)時，其染色體長度為 48，達到收斂之世代數為 35，模擬
兩小時之總旅行時間為 5736.10 小時。 
5.獨立型 GFLRC 於模擬兩個小時後，總旅行時間為 5753.69 小時，所挑選之規則為
1112121100000005511133101 共 17 條，經 150 世代達到收斂，反覆演化次數為三次。 
6.整合型 GFLRC 於模擬兩個小時後，總旅行時間為 5699.85 小時，挑選之規則數為 70
條，經 227 世代達到收斂，反覆演化次數為三次。 
表 6.32 情境二模式績效比較表 
儀控策略 總旅行時間(小時) 改善程度(%) 
不實施儀控 6182.17 － 
FLRC 模式 6154.25 0.45 
最佳定時(1 段式) 5884.78 4.81 
最佳定時(4 段式) 5736.10 7.22 
獨立型 GFLRC 5753.69 6.93 
整合型 GFLRC 5699.85 7.80 
三、情境三：（各模式之比較如表 6.33） 
1.匝道不實施儀控時，模擬兩小時之總旅行時間為 8143.33 小時。 
2.FLRC 模式於兩個小時模擬後，總旅行時間為 7886.18 小時。 
3.匝道採最佳定時儀控(1 段式)時，其染色體長度為 12，達到收斂之世代數為 19，最佳
染色體為 010323430723，模擬兩小時之總旅行時間為 6934.16 小時。 
4.匝道採最佳定時儀控(4 段式)時，其染色體長度為 48，達到收斂之世代數為 38，模擬
兩小時之總旅行時間為 6844.12 小時。 
5.獨立型 GFLRC 於模擬兩個小時後，總旅行時間為 6795.38 小時，所挑選之規則為
0010110101411000101140100 共 13 條，經 138 世代達到收斂，反覆演化次數為三次。 
6.整合型 GFLRC 於模擬兩個小時後，總旅行時間為 6751.21 小時，挑選之規則數為 75
條，經 187 世代達到收斂，反覆演化次數為三次。 
以下茲就上述模式控制結果彙整如表 6.34 所示。 
 82 
 
圖 6.14 背景示意圖 
針對高速公路各路段流量進行設計，流量設計可分為主線上游端進入流量、上匝道
併入流量與下匝道匯出流量三個部份，主線與上匝道的到達率為 20 輛/分鐘；下匝道離
開率為 4 輛/分鐘，依據到達率與離開率設定進行兩個小時模擬。將小型車與大型車的車
種比例設定為 9:1，符合大部分高速公路路段的車種比例。 
6.3.2 參數設定 
車流模擬模式參數設定上，符合台灣高速公路速限設定小型車的最大速度為
31cells/sec(110 公里/小時)、大型車的最大速度為 25cells/sec(90 公里/小時)。小型車的加
速度為 3cells/sec2(3 公尺/秒 2)，車長為 6 公尺。大型車的加速度為 2cells/sec2 (2 公尺/秒
2)，車長為 12 公尺。小型車的 t,c和 h 設定為 6，大型車為 8。模式的 Pb為 0.94、P0為
0.5、Pd為 0.1、Pc為 0.4，gapsafety設定為 10。 
車流型態判斷模式設定上，從模擬時間第五分鐘開始，蒐集前五分鐘內每分鐘的速
度、流量、速度變化率、流量變化率與速度變化率/流量變化率進行車流型態判斷，車流
型態判斷更新周期為一分鐘。 
匝道儀控模式設定上，ANCONA模式根據Kerner et al.(2005)設定方式，qon1為360輛
/小時、qon2為600輛/小時，vcong為85公里/小時，偵測器位置佈設於上匝道上游200公尺處。
獨立型與整合型FLRC模式，偵測器位置則佈設於上匝道下游100公尺處。此外，除了定
時儀控模式儀控率為固定外，ANCONA、獨立型與整合型FLRC模式儀控率更新週期為
一分鐘。 
6.3.3 車流模擬模式驗證 
進行車流模擬模式驗證，以系統整體交通參數透過巨觀車流理論的流量-密度關係
圖驗證車流模擬模式的真實性，以驗證之流量設計在不實施匝道儀控下進行模擬。圖
6.15 為模式模擬之結果，換算為傳統交通變數的單位如圖 6.16。從圖 6.16 分析結果發現
在純小型車模擬下流量最大，約為 2,200 輛/小時/車道，略低於 2000 年公路容量手冊所
估算的 2,400 輛/小時/車道。在混合車流模式中(小型車:大型車，80:20)，最大的流量約
為 1,500 輛/小時/車道。純大型車模擬下最大流量約為 750 輛/小時/車道，較其他車流組
合下來的低，此仍是因為大車的車長較長，因而所能通過的最大流量較低。但從原本車
流模擬所計算的流量(cell/秒)來看，因為大車所佔有的網格數是小型車的三倍，因而從
相同的衡量單位來看，純大型車模擬下的最大流量高於混合車流與純小型車。 
從以上不同車流組合模擬下，可以發現當匝道上不實施任何儀控策略時，主線的流
 84 
(交流道間距=2km) (交流道間距=2km) 
 
圖 6.19 混合車流瓶頸路段車流型態圖(交流道間距=2km) 
然而當兩組匝道間距拉長，模擬路段亦增長後，主線車流密度降低，主線瓶頸路段
上車流型態向上游傳遞情形會較為平緩。從圖 6.20 至 6.22 觀察在不同車流組成模擬下，
瓶頸路段上車流型態由原本的自由流轉變為同步流，並在一段時間後逐漸向上游傳遞。
由此可知，匝道間距和車流密度會影響到瓶頸路段上車流型態傳遞情形，在匝道間距較
短，車流密度較高的路段下，瓶頸路段上車流型態傳遞速度較快，傳遞情形較明顯。反
觀匝道間距較長，車流密度較低的情境下，瓶頸路段上車流型態傳遞速度較慢，傳遞情
形也較平緩，擁擠現象的上游會固定在上匝道處緩慢的向上游傳遞 
圖 6.20 純小型車車流速率時空變化圖
(交流道間距>2km) 
圖 6.21 純大型車車流速率時空變化圖
(交流道間距>2km) 
 
圖 6.22 混合車流速率時空變化圖(交流道間距>2km) 
6.3.5 車流型態驗證 
 86 
  
圖 6.26 第七分鐘車流型態分析圖 圖 6.27 第八分鐘車流型態分析圖 
  
圖 6.28 第九分鐘車流型態分析圖 圖 6.29 第十分鐘車流型態分析圖 
  
圖 6.30 第十一分鐘車流型態分析圖 圖 6.31 第十二分鐘車流型態分析圖 
  
圖 6.32 第十三分鐘車流型態分析圖 圖 6.33 第十四分鐘車流型態分析圖 
 
表 6.35 車流型態判斷 
模擬時間 5 6 7 8 9 10 11 12 13 14 
車流型態 F F F F LS J J HS F F 
速率 
(km/hr) 105 103 93 100 49 19 27 21 97 102 
流量 
(pcu/hr/ln) 360 600 1260 960 1200 1020 1200 780 1020 1080
 88 
旅行時間為 4547.5 小時。 
表 6.36 驗證儀控績效比較表 
儀控策略 總旅行時間(小時) 改善程度(%) 
不實施儀控 4657.8 － 
定時儀控 4599.9 1.24 
ANCONA 4597.2 1.30 
獨立型 FLRC 4551.2 2.29 
整合型 FLRC 4547.5 2.37 
 
此外，圖 6.35 到 6.39 為在五種不同控制策略下，第二組交流道上匝道處上、下游 1
公里內的時空速率變化圖。圖形上 X 軸代表空間，上匝道位置在圖上 1000 處；Y 軸代
表時間，觀測時間為開始實施匝道儀控後十五分鐘到四十五分鐘間；Z 軸代表速率，從
0 到最大速限 110 之間。比較五種控制策略下對瓶頸路段上車流型態的影響，可以看到
不實施儀控下，匝道上車輛大量的擁入主線，因此造成主線下游產生嚴重的大範圍擁擠
流，但並未向上游傳遞。相反的實施 ANCONA 模式時，減少了匝道車輛併入主線的流
量，因而主線下游車流型態仍然維持在自由流與輕微同步流之間，但卻增加了匝道車輛
的延滯時間。介於此兩種現象之間的整合型 FLRC、獨立型 FLRC 和定時儀控下，在瓶
頸路段上車流型態轉變介於輕微同步流與強烈同步流之間，其中以整合型 FLRC 下游車
速較高。 
圖6.35 整合型FLRC車流速率時空變化圖 圖6.36 獨立型FLRC車流速率時空變化圖
圖6.37 ANCONA車流速率時空變化圖 圖 6.38 定時儀控車流速率時空變化圖
 90 
不具有實行 ANCONA 模式的意義。 
二、比較獨立型與整合型 FLRC 模式可知，此兩種模式在總旅行時間上改善程度雖然差
異不大，但在三種情境下整合型 FLRC 控制績效均優於獨立型 FLRC。 
三、以不實施匝道儀控作為基準，整合型 FLRC 在各種情境設計下儀控績效最佳，其次
為獨立型 FLRC、ANCONA、定時儀控。由情境三顯示，整合型 FLRC 模式之改善
程度為 6.66%、獨立型 FLRC 為 6.46%、ANCONA 為 5.60%、定時儀控為 4.87%。 
四、流量設定較低時，整合型 FLRC 對於總旅行時間之改善程度為 2.16%，流量設定為
中等流量時為 2.37%，而流量設定為高流量時之改善程度 6.66%，由此可知，當高
速公路車流量越大時，整合型 FLRC 之控制績效顯示越佳。 
 
 92 
時階愈少，預測長度愈短，其預測準確度愈高之趨勢。以最佳時階模式為例，其預
測後 1 筆 5 分鐘單位資料交通量之誤差值為 5.94%，平均速度為 0.83%，1 分鐘單
位資料佔有率之誤差值為 6.18%。顯示在 RGM(1,1)在短期交通資訊之預測上具有相
當之準確度。 
2. 應用 1 分鐘單位資料，滾動時階 4 之 RGM（1,1）模式，進一步構建多元預測模式
GM（1,N）模式，應用同一樣本資料，以整合方式同時進行預測，蒐集同一偵測器
之 3 項交通資訊、觀測路段之上下游偵測器資料、以及觀測路段偵測器之前 1 日、
前 1 週歷史資料等，作為模式之訓練驗證資料。 
3. GM（1,N）模式構建首先以灰關聯方法，分析模式中變數與預測準確度之相關係數，
找出交通量灰關聯分析其關聯度大小排序依序為序列 4>序列 3>序列 6>序列 5>序列
1>序列 2，即下游後一支偵測器之交通量資料關連度最高，上游前一支偵測器之交
通量資料次之；平均速度灰關聯分析之關聯度大小排序依序為序列 5>序列 4>序列
3>序列 6>序列 1>序列 2，即前一日同一偵測器之平均速度資料關連度最高，下游後
一支偵測器之平均速度資料次之；佔有率灰關聯分析之關聯度大小排序依序為序列
3>序列 4>序列 5>序列 6>序列 1>序列 2，即上游前一支偵測器之佔有率資料關連度
最高，下游後一支偵測器之佔有率資料次之。 
4. 以交通量、平均速度及佔有率資料分別建立具滾動特性之 RGM（1,N）模式，以實
驗資料進行訓練驗證。在資料單位一分鐘一筆之預測結果中，交通量以 RGM（1,6）
表現最佳，預測後一筆之準確度為 94.56%，平均速度以 RGM（1,6）表現最佳，預
測後一筆之準確度高達 99.95%，佔有率以 RGM（1,5）表現最佳，預測後一筆之準
確度為 95.56%。 
7.1.2 GFLC 適應性匝道儀控模式 
1. 獨立型 GFLRC 模式之編碼係以 25 及 108 個基因分別代表邏輯規則及隸屬函數參
數，而整合型 GFLRC 模式係分別以 125 及 144 表之，基於染色體長度，故整合型
GFLRC 模式於演化過程之尋優收斂世代稍多。於反覆演化尋優技巧方面，下層係
在上層尋優結果下求得一近似最佳解，收斂過程會呈現向右傾斜之趨勢，最後達到
收斂。而在最佳定時儀控模式部份，4 段式因分時段進行儀控，其控制績效較佳且
染色體長度較 1 段式為長，故尋優世代較多。 
2. 模式驗證分析結果顯示，匝道實施 FLRC 模式對於總旅行時間之改善程度並不顯
著，顯示主觀設定模糊邏輯控制系統之參數推估匝道儀控率其績效仍具改善空間，
故本研究應用基因演算法校估此控制系統之參數，有助於提升其控制績效。 
3. 本研究依流量高低設計三種不同情境，於情境一之分析顯示，FLRC 模式之改善程
度為- 0.51%、最佳定時儀控(1 段式)為 0.89%、最佳定時儀控(4 段式)為 3.27%、獨
立型 GFLRC 為 2.58%、整合型 GFLRC 為 3.40%，整體而言，顯示本模式的確能夠
改善用路人之總旅行時間，且整合型模式優於獨立型模式。此外，當主線交通量較
高時，其總旅行時間之改善程度亦較佳。 
7.1.3 兩階段 FLC 匝道儀控模式 
1. 用細胞自動機之特性分析車流型態之轉變，進而建立車流型態判斷之模式，以車流
型態作為匝道儀控中主線車流狀況衡量的主要依據。 
2. 利用細胞自動機建構模擬二車道高速公路路段之車流模擬模式，與模糊邏輯控制建
 94 
第八章 計畫成果自評部份 
本計畫為兩年期計畫。主要工作項目，係利用基因模糊邏輯控制（GFLC）及基因
螞蟻模糊邏輯控制（GAFLC）建構匝道儀控系統，並加以驗證，再利用所建構之短期交
通量灰預測模型（RGM(1,1)及 RGM(1,N)）進行下一時階之交通狀態預測。 
 
由於原模式係利用巨觀車流模式（流體近似法）進行延滯與等候長度估算，並將車
流總體變數輸入控制模式中。此一方法無法反應微觀車流變化，也難以進一步整合短期
交通量預測模式。而且，原規劃本模式與 Paramics 微觀車流模擬軟體之整合部份，也發
現其 API 界面難以寫入 GFLC 控制規則，而模擬時間也過長，無法於有效時間內完成模
式自動學習之機制。因此，本研究乃進一步引入流體近似法（fluid approximation）及細
胞自動機（cellular automaton, CA），作為模式績效評估之模擬平台，並觀測匝道儀控瓶
頸處之微觀車輛行駛軌跡圖，俾了解不同匝道儀控策略之交通衝擊程度。除此之外，其
他各項所列工作項目均已如期完成。 
 
此外，本計畫之主要研究成果已分別發表或投稿國際期刊 4 篇文章[1~4]、國際研
討會 11 篇文章[5~15]、國內研討會 4 篇學術論文[16-19]。此外，本計畫以之前本人指導
之 4 篇碩博士論文為基礎（即[20-23]），用以指導 3 名碩士生進行論文寫作[24~26]及 1
名博士生進行論文寫作[27]，碩士研究生均已順利畢業。相關研究成果之發表狀況條列
如下： 
 
1. International Journal Paper 
 
[1] Chiou, Y.C., Chiou, Y.C. and Ai, C.M. (2007) “Rolling Grey Forecasting Models for 
Short-term Traffics,” Journal of Eastern Asia Society for Transportation Studies, Vol.7, 
pp.2486-2501. 
[2] Hsu, CC., Lin, Z.H, Chiou, Y.C. and L.W. Lan (2007) “Exploring traffic features with 
stationary and moving bottlenecks using refined cellular automata,” Journal of the 
Eastern Asia Society for Transportation Studies, Vol.7, 2502-2516. (Winner of Yasoshima 
Prize, the Best of the Best Paper Award out of 507 accepted papers) 
[3] Chiou, Y.C. and Y.H. Lai (2008) “An integrated multi-objective model to determine the 
optimal rescue path and traffic controlled arcs for disaster relief operations under 
uncertainty environments,” Journal of Advanced Transportation, Vol.42, No.4, 
pp.493-519. (SCI, EI, Impact factor: 0.731). 
[4] Chiou, Y.C., Hsu, CC., Lin, Z.H, and L.W. Lan (2008) “Two-stage fuzzy logic control for 
ramp metering with cellular automaton modeling,”, submitted to Transportation Research 
Part. C: Emerging Technologies. (SSCI, SCI, EI, Impact factor: 0.767) 
 
2. Internation Conference Paper 
 
[5] Chiou, Y.C. and Y.C. Wang (2005) “Development of genetic fuzzy logic controller-based 
ramp metering strategies,” presented at the 10th International Conference for Hong Kong 
Society of Transportation Studies, Hong Kong, Dec.10~12. 
[6] Chiou, Y.C., Chen, Y.L. and M.T. Wang (2006) “Genetic Fuzzy Logic Controller-Based 
Freeway Incident Detection Systems,” presented at the INFORMS Hong Kong 
International Conference, Hong Kong, June.25~28. 
[7] Chiou, Y.C., Wang, M.T. and W.L. Lan (2006) “Genetic Fuzzy Logic Transit Preemption 
 96 
用」，交通大學交通運輸研究所，博士論文，民國 94 年。 
[22]陳怡霖，「應用基因模糊邏輯控制建構事件偵測系統」，逢甲大學交通工程與管理所，
碩士論文，民國 94 年。 
[23]范智超，「用於起迄交通量預估之車牌辨識系統區位規劃模式」，逢甲大學交通工程
與管理所，碩士論文，民國 94 年。 
[24]邱妍菁，「高速公路短期交通資訊之灰預測模型」，逢甲大學交通工程與管理學系，
碩士論文，民國 95 年。 
[25]蔡佩珊，「基因螞蟻分群演算法之建構與驗證」，逢甲大學交通工程與管理所，碩士
論文，民國 95 年。 
[26]鐘仁傑，「模糊邏輯匝道儀控模式-細胞自動機之模擬分析」，，交通大學交通運輸研
究所，博士論文，民國 96 年。 
[27]黃彥斐，「整合型高速公路交通管理系統」，交通大學交通運輸研究所，博士論文（進
行中），民國 97 年。 
 98 
Jiang, R. and Wu, Q.S. (2003), “Cellular automata models for synchronized traffic flow,” 
Journal of Physics A: Mathematical and General, Vol.36, pp.381-390. 
Kerner, B.S. (2005) “Control of spatiotemporal congested traffic patterns at highway 
bottlenecks,” Physica A, Vol.355, pp.565-601. 
Kerner, B.S. and Klenov, S.L. (2003), “Microscopic theory of spatial-temporal congested 
traffic patterns at highway bottlenecks,” Physical Review E, Vol.68, pp.036130. 
Kerner, B.S., Rehborn, H., Aleksic, M. and Haug, A. (2004) “Recognition and tracking of 
spatial–temporal congested traffic patterns on freeways,” Transportation Research Part C, 
Vol.12, pp.369-400. 
Kerner, B.S., Klenov, S.L., Hiller, A., and Rehborn, H. (2006) “Microscopic features of 
moving traffic jams,” Physical Review E, Vol.73, pp.046107. 
Kirby, H.R., Watson S. M., and Dougherty, M.S. (1997) Should we use neural networks or 
statistical models for short-term motorway traffic forecasting?”, International Journal of 
Forecasting, Vol. 13, 43-50. 
Knospe, W., Santen, L., Schadschneider, A., and Schreckenberg, M. (2000), “Towards a 
realistic microscopic description of highway traffic,” Journal of Physics A: Mathematical 
and General, Vol.33, pp.477-485. 
Lan, L.W. and Hsu, C.C. (2005), “Using cellular automata to explore spatiotemporal traffic 
patterns,” Proceedings of the 10th International Conference of Hong Kong Society for 
Transportation Studies, pp.210-219. 
Lan, L.W. and Hsu, C.C. (2006), “Formation of spatiotemporal traffic patterns with cellular 
automaton simulation,” Transportation Research Board, 85th Annual Meeting, 
Washington, DC, in CD-ROM. 
Lee, S. and Fambro, D.B. (1999) Application of subset autoregressive integrated moving 
average model for short-term freeway traffic volume forecasting, Transportation 
Research Record, No. 1678, 179-188. 
Nagel, K. and Schreckenberg, M. (1992) “A cellular automaton model for freeway traffic,” 
Journal Physica. I France, Vol.2, pp.2221-2229. 
Okutani, I. and Stephanedes, Y.J. (1984) Dynamic prediction of traffic volume through 
Kalman filtering theory, Transportation Research Part B, Vol. 18, 1-11. 
Okushima, M., Takihi, Y. and Akiyama, T. (2003) Fuzzy traffic controller in ramp metering of 
urban expressway. Journal of Advanced Computational Intelligence and Intelligent 
Informatics 7, pp.207-214. 
Papageorgiou, M. and Kotsialos, A. (2002) “Freeway ramp metering: An overview,” IEEE 
Transactions on Intelligent Transportation Systems, Vol.3, pp.271-281. 
Pushkar, A., Hall, F.L., and Acha-Daza, J.A. (1995) Estimation of speeds from single-loop 
freeway flow and occupancy data using cusp catastrophe theory, Transportation Research 
Record, No. 1457, 149-157. 
Schwarz, G. (1978) Estimating the dimension of a model, Annals of Statistics, Vol. 6, 
461-464. 
Smith, B.L., Billy M.W., and Oswald, R.K. (2002) Comparison of parametric and 
nonparametric models for traffic flow forecasting, Transportation Research Part C, Vol. 
10, 303-321. 
Stathopoulos, A. and Karlaftis, M.G. (2003) A multivariate state space approach for urban 
traffic flow modeling and prediction, Transportation Research Part C, Vol. 11, 121-135. 
Van Der Voort, M., Dougherty, M., and Watson, S. (1996) Combining Kohonen maps with 
ARIMA time series models to forecast traffic flow, Transportation Research Part C, Vol. 
4, 307-318. 
Van Arem, B., Kirby, H.R., Van Der Vlist, M.J.M., and Whittaker, J.C. (1997) Recent 
advances in the field of short-term traffic forecasting, International Journal of 
表 Y04                                         第 1 頁
行政院國家科學委員會補助國內專家學者出席國際學術會議報告 
                                                             97年 10月 8日 
報告人姓名  邱裕鈞 
 
服務機構
及職稱 
交通大學交通運輸研究所 
副教授 
     時間 
會議 
     地點 
2007/9/24-2007/9/27 
 
中國大陸大連市 
本會核定
補助文號
NSC 95-2221-E-009-368-MY2 
會議 
名稱 
(中文) 第七屆東亞運輸學會 
(英文) The 7th International Conference of Eastern Asia Society for 
Transportation Studies 
發表 
論文 
題目 
(中文) 短期交通量之滾動灰預測模式 
(英文) Rolling Grey Forecasting Models for Short-term Traffics 
(中文) 利用改良式細胞自動機探析穩定及移動瓶頸之交通特性 
(英文) Exploring Traffic Features with Stationary and Moving Bottlenecks 
using Refined Cellular Automata 
(中文) 同時衡量運輸效率與效果之整合資料包絡分析模式 
(英文) Integrated Data Envelopment Analysis Models for Measuring Transport 
Efficiency and Effectiveness 
 
一、參加會議經過 
 
東亞運輸學會創建於 1984年 11月，會員國包括我國、日本、澳洲、南韓、越南、
中國大陸、香港、澳門…等十五個國家(地區)，旨在促進運輸領域理論研究及實務經驗
的提昇與交流。所有論文將依審查結果分為刊登於期刊、刊登全文於論文集及刊登摘要
於論文集等三等級，具有相當之學術地位。本次會議除安排論文研討外，也排定數場專
題演講以及技術考察行程。本次會議由大連海事大學主辦，大連市政府及大連交通大學
協辦。全部活動於 2007年 9月 24日至 9月 28日共 5天，在大連海事大學大會堂舉行。
本次研討會共計有 766篇全文投稿，最後接受 507篇。其中，289篇收錄在期刊中，其
餘 218篇收錄於研討會論文集。此外，今年又分為理論文章及實務文章兩大類。 
 
論文發表與研討會議一連舉辦四天（9/24-9/27），包含開、閉幕典禮及歡迎與歡送
酒會。第一天開幕典禮邀請中國大陸國家發展與改革委員會 Qingyun Wang教授，主講
Current and Future Transportation in Taiwan。另外也邀請普渡大學教授（International 
Transportation Engineering, ITE）主編及 EI資料庫審查委員：Kumares C. Shinha教授進
行專題演講，演講題目為：Are Transportation Studies a Scientific Endeavor?。此外，也舉
辦一場圓桌會談，主題是”Asian Integration and Transport- What should we do”，由新加坡
大學 Tien Fang Fwa擔任主席，邀請大陸清華大學教授、大連海事大學教授南洋大學教
授等六人擔任與談人。下午即開始進行分組報告與討論。我國參與發表超過 80篇論文，
與會人數接近百人，成為本屆會議與會人數最多、發表文章最多，且文章品質最佳的會
員國。而由國內積極參與本會，也顯示本會已成為我國運輸領域最重要的國際運輸研討
會。 
 
 
附件三
 
表 Y04                                         第 3 頁
之上，國內運輸學界應持續努力保持。本所除本人與榮譽退休教授藍武王博士與會外，
尚有馮正民教授、汪進財教授與會。而本所博士班學生也有六人與會，參與人數應屬
全國之冠。 
4.本次會議於中國大陸大連市舉行，大連市區街道規劃完整，街容頗為整齊清潔。尤其，
全市管制機車牌照，機車十分少見。此外，由於街道因位於山區，起伏明顯，亦少見
腳踏車，以致道路車流較為齊質（大多為小客車），交通管理較為便利。此外，亦設有
公車、電車及輕軌捷運系統等大眾運輸系統（票價 1元人民幣）提供服務。雖有如此
先天條件，但大連街道尖峰時段仍十分擁塞。究其原因，可能有三：大連小客車雖多，
但多屬老舊，且駕駛習慣不良，導致車流動線混亂。第二是路口交通管制號誌時制設
計不佳，幹線上不少重要路口形成嚴重交通瓶頸。第三則是大連市內設有許多廣場（即
公園），多以圓環方式連接多條重要幹道，造成交通管理之困難。相較之下，台灣各城
市之運輸系統及交通管理，顯然仍較為先進。 
 
三、建議 
 
1.東亞運輸學會每兩年舉辦一次，至今雖僅舉辦六屆，但各屆會議之規模均相當可觀，
且發表之學術論文均具國際水準，內容雖以運輸為主，但運輸相關課題，如管理、環
境、都市規劃建設等均可接受投稿發表。因此，建議本校相關相關科系教授與學生可
積極參加此一學會，以了解各國各領域之發展現況，俾拓展個人的學術視野與人際關
係，俾利學術研究水準之提昇。也建議校方多補助及鼓勵校內師生參加此類會議，以
增加本校學術研究之知名度。 
2.國內每年舉辦之運輸學會已歷二十一屆，為國內運輸領域之最重要會議，每次會議也
都能吸引數百篇論文投稿，研討場次數十場，十分盛大。惟可惜的是，其性質仍屬國
內研討會，未能進一步與國際接軌。在國際化發展潮流中，未來運輸學會主辦校系實
有必要考慮邀請國際學者或廣邀國際文章，短期也許可考慮分為國內及國際兩個場
次，未來再逐漸改以國際研討會方式進行。此舉也能鼓勵未來碩博士研究生培養以英
文撰寫論文及發表文章的能力。今年運輸學會（二十二屆）由本校主辦，為推動本學
會之國際化，已開創先例，邀請七位國外永續運輸之學者來台專題演講，並接受英文
投稿與發表，目前已超過 20篇文章投稿。未來仍可繼續朝國際化方向前進。 
3.EASTS 期刊目前正積極申請加入 SCI 及 EI 資料庫。目前國內運輸領域的相關期刊：
運輸學刊及運輸計劃季刊，雖已獲 TSSCI資料庫收錄，但建議考慮改以英文出刊，以
鼓勵國內學者以英文方式撰述論文，未來方有可能列為 SCI或 SSCI期刊。 
 
 
四、攜回資料名稱及內容 
1.EASTS論文集光碟 
2.會議議程彙編 
3.日本 ITS簡介 
 
五、其他 
本次出國機票、註冊費及生活費用承蒙國科會補助(計畫編號：NSC95-2221-E-009 
-368- MY2)，本人特此感謝。 
 
 
表 Y04                                         第 5 頁
studies employ various methods to tackle this issue, such as statistical time-series or regression 
models (e.g. Van Der Voort et al., 1996; Kirby et al. 1997; Chang and Miaou, 1999; Lee and 
Fambro, 1999; Smith, et al. 2002), sequential learning (Chen and Grant-Muller, 2001), artificial 
neural network (e.g. Van Der Voort et al., 1996; Kirby et al. 1997; Dougherty and Cobbett, 1997; 
Dia, 2001), Kalman filtering model (e.g. Okutani and Stephanedes, 1984; Stathopoulos and 
Karlaftis, 2003), and cusp catastrophe theory (Pushkar, et al., 1995).. A fine review of earlier 
methods used in short-term traffic flow prediction can be found in Van Arem et al. (1997). However, 
most of these methods are rather complex in model building with considerable amount of data 
required. In contrast, grey forecasting model (GM) proposed by Deng (1989) is an extremely simple 
model in calibration and computation. Its performance has been proven in many application fields. 
Especially, since it only requires very few observations to construct the model, GM can be 
efficiently reconstructed itself whenever a new observation rolls in for taking advantage of the latest 
information in updating a forecasting model. This rolling-horizon trained GM(1,1) model, 
abbreviated as rolling GM (RGM), is expected to perform better than unrolling GM model (e.g. 
Chang et al., 2005). 
 
Moreover, the traffic information detected by loop detectors includes flow, speed and occupancy, 
which are mutually correlated at a traffic flow relationship. The traffic information detected by 
upstream or downstream loops is more likely to be highly correlated to each other. Besides, the 
traffic pattern also seems to repeat itself day after day, so it could be traceable based on historical 
data. Therefore, it is reasonable to construct a RGM(1,N) to predict specific traffic information with 
the consideration of other available traffic information. Based on this, this paper aims to develop 
and validate these two types of RGM models, RGM(1,1) and RGM(1,N), to predict short-term 
traffics including flow, speed and occupancy, respectively. For comparison, two commonly used 
short-term traffic prediction models: statistical time-series model (ARIMA) and artificial neural 
network (ANN), are also developed and compared. 
 
The rest of this paper is organized as follows: brief introductions to the methodologies adopted in 
this paper are given in Section 2. In Section 3, we formulate univariate models, including RGM(1,1) 
and ARIMA, and analyze their performances. As to the developments and performances of 
multivariate models, including RGM(1,N) and ANN, are given in Section 4. Comparisons of the 
best performances of these four models are provided in Section 5. Finally, the concluding remarks 
and suggestions for future studies follow. 
 
 
2. METHODOLOGIES 
 
The short-term traffic forecasting models are developed in this paper, including RGM(1,1), 
RGM(1,N), ARIMA, and ANN. Brief introductions to these methods are respectively given below. 
 
2.1 RGM(1,1) 
 
GM(1,1) aims to predict a total of m (i.e. n+1th, n+2th,…, n+mth) periods of sequence based on its 
historical and primitive n time-series data: }1 ),({ )0()0( nkkxX ≤≤= , where )()0( kx  is the time 
series data at time k. GM(1,1) has three basic operations (Deng, 1982, 1986, 1989): accumulated 
generation operation (AGO), inverse accumulated generation operation (IAGO), and grey modeling. 
AGO is used to generate a new sequence: }1 ),({ )1()1( nkkxX ≤≤= , where ∑
=
=
k
i
ixkx
1
)0()1( )()( , for 
k=1, 2,…, n. The first-order differential equation for the model is: 
baX
dt
dX =+ )1(
)1(
                                                                 
表 Y04                                         第 7 頁
X01 2 n
GM (1,1)
3 ...
r
r
r
Primitive sequence
1 2 n3 ...
Predicted sequence 0
Xˆ
r
)1(ˆ0 +rx
GM (1,1)
GM (1,1)
GM (1,1)
... ...
)2(ˆ0 +rx )(ˆ0 irx + )(ˆ0 nx
 
Figure 1 Concept of rolling-horizon trained GM(1,1) 
 
Table 1 Grades of forecasting accuracy 
Grade MAPE 
Excellent < 10% 
Fair 10~20% 
Qualified 20~50% 
Unqualified > 50% 
 
2.2 RGM(1,N) 
 
The GM(1,1) grey model can be extended to a GM(1,N) grey model, so as RGM(1,1) and 
RGM(1,N). Note that the second index in the GM(1,N) represents for N data sequences 
( )0()0(2
)0( ,...,,1 NXXX ), where 
)0(
1X  is the reference sequence and )0()0(3
)0(
2 ...,, NXXX  are the 
compared sequences. The differential equation can be expressed as follows: 
∑
=
−=+
N
i
ii XbaXdt
dX
2
)1(
1
)1(
)0(
1
1                                                           
                                  (8) 
where, )1(iX  is the AGO sequence of ith primitive sequence. a, b1, b2,…, bN-1 are unknown 
parameters which can be determined by: 
N
TT
N YBBBbbbaA
1
121 )(]ˆ,...,ˆ,ˆ,ˆ[
−
− ==                                                   
                          (9) 
where, 
⎥⎥
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢⎢
⎢
⎣
⎡
=
)(
)3(
)2(
)0(
)0(
)0(
nx
x
x
YN M
, 
⎥⎥
⎥⎥
⎦
⎤
⎢⎢
⎢⎢
⎣
⎡
−+−
+−
+−
=
)()()1()((5.0
)3(
)3())2()3((5.0
)2()2())1()2((5.0
)1()1(
2
)1(
1
)1(
1
)1(
)1(
2
)1(
1
)1(
1
)1()1(
2
)1(
1
)1(
1
nxnxnxnx
x
xxx
xxxx
B
N
N
N
L
L
MM
L
 
The forecast of future values in sequence is calculated as follow: 
∑∑
=
−−
=
− +++−=+
N
i
i
iak
N
i
i
i kx
a
bekx
a
bxkx
2
)1(1
2
)1(1)0(
1
)1(
1 )1())1()1(()1(ˆ                              
    (10) 
RGM(1,N) based on GM(1,N) employs the similar rolling concept depicted in Figure 1 to 
reconstruct itself whenever a new observation rolls in. The performance of RGM(1,N) is also 
measured by MAPE (Eq. (7)). 
 
2.3 ARIMA 
 
The autoregressive integrated moving average (ARIMA) model is first introduced by Box and 
Jenkins (1976). The ARIMA model has been one of the most popular approaches to forecasting, 
表 Y04                                         第 9 頁
variations under various daily traffic patterns. For comparisons, each day is referred as Monday, 
Tuesday, Wednesday, Thursday and Friday, respectively. Besides, to avoid of manifestation of zero 
value, which are frequently found on every 20-second traffic, 1-minute and 5-minute data are 
further aggregated from 20-second data and used to develop and validate the traffic prediction 
models. The performances of prediction models are examined as follows, respectively. 
 
3.1 RGM(1,1) 
 
The performances of RGM(1,1) with various rolling intervals and prediction periods on 1-minute 
and 5-minute traffic data are analyzed as follows. 
 
3.1.1 Flow 
 
There are a total of 1440 1-minute data and a total of 288 5-minute data for a whole day. Taking 
RGM(1,1) with 4 rolling interval for instance, the model reconstructs itself for a total of 1436 times 
and 284 times for 1-minute and 5-minute data, respectively. Each of them predicts next 1-minute or 
5-minute flow. The MAPE of RGM(1,1) with various rolling intervals on 1-minute and 5-minute 
flow are respectively reported in Table 2 and Table 3. For 1-minute flow, average MAPE over five 
consecutive days of RGM(1,1) with various rolling intervals range from 12.38% to 20.13%, 
indicating the fair accuracy grade of RGM(1,1) according to Table 1. Also notice that the model 
with fewer rolling interval performs better. As shown from Table 3, the MAPE of RGM(1,1) on 
5-minute flow are largely curtailed in comparing to that on 1-minute flow data. They range from 
5.94% to 8.90%, indicating the excellent prediction performance of RGM(1,1). Consistent results 
can also be identified that the model with fewer rolling interval performs better. 
 
Table 2 MAPE of RGM(1,1) with various rolling intervals on 1-minute flow data 
Rolling interval Weekday 4 5 6 7 8 Average 
Monday 14.43% 18.94% 21.27% 22.38% 23.82% 20.17% 
Tuesday 10.66% 14.57% 16.50% 17.86% 18.78% 15.67% 
Wednesday 12.77% 16.18% 17.77% 18.64% 19.42% 16.96% 
Thursday 11.24% 14.45% 16.39% 17.16% 17.89% 15.43% 
Friday 12.81% 16.45% 18.39% 19.80% 20.76% 17.64% 
Average 12.38% 16.12% 18.06% 19.17% 20.13% 17.17% 
 
Table 3 MAPE of RGM(1,1) with various rolling intervals on 5-minute flow data 
Rolling interval Weekday 4 5 6 7 8 Average 
Monday 6.69% 7.77% 8.60% 9.16% 9.57% 8.36% 
Tuesday 5.49% 7.19% 7.49% 7.85% 8.18% 7.24% 
Wednesday 5.07% 6.31% 6.89% 7.40% 7.76% 6.69% 
Thursday 5.63% 7.42% 8.23% 8.72% 9.07% 7.81% 
Friday 6.80% 7.81% 8.82% 9.46% 9.89% 8.56% 
Average 5.94% 7.30% 8.00% 8.52% 8.90% 7.73% 
 
Moreover, the prediction performances for various weekdays show that the RGM(1,1) performs 
better on middle days of weekday, i.e. Thursday, Tuesday, and Wednesday, and performs worse on 
both ends of weekdays, i.e. Friday and Monday. To investigate why, the MAPE and coefficient 
variation (CV) of these five consecutive days are depicted in Figure 2. Note that the MAPE is 
highly and positively correlated with CV of the data. It implies that the lower variation of traffics is; 
the higher accuracy can be achieved. Figure 3 depicts the predicted values of RGM(1,1) with 4 
rolling intervals and real flow values. Notice that only a larger deviation of predicted and real 
表 Y04                                         第 11 頁
which are superior to that on 1-minute speed data. It also illustrates the excellent prediction grade of 
RGM(1,1). 
 
Table 6 MAPE of RGM(1,1) with various rolling intervals on 1-minute speed data 
Rolling interval Weekday 4 5 6 7 8 Average 
Monday 2.23% 2.78% 3.15% 3.22% 3.35% 2.42% 
Tuesday 1.79% 2.26% 2.51% 2.66% 2.87% 1.91% 
Wednesday 1.42% 1.80% 2.02% 2.12% 2.20% 2.22% 
Thursday 1.60% 2.06% 2.34% 2.49% 2.60% 2.26% 
Friday 1.64% 2.11% 2.37% 2.55% 2.65% 2.35% 
Average 1.74% 2.20% 2.48% 2.61% 2.73% 2.42% 
 
Table 7 MAPE of RGM(1,1) with various rolling intervals on 5-minute speed data 
Rolling interval Weekday 4 5 6 7 8 Average 
Monday 0.91% 1.13% 1.23% 1.30% 1.32% 1.18% 
Tuesday 0.86% 1.00% 1.10% 1.15% 1.18% 1.06% 
Wednesday 0.79% 0.95% 1.06% 1.14% 1.20% 1.03% 
Thursday 0.68% 0.90% 1.01% 1.08% 1.15% 0.96% 
Friday 0.92% 1.15% 1.26% 1.34% 1.36% 1.21% 
Average 0.83% 1.03% 1.13% 1.20% 1.24% 1.09% 
 
Besides, the prediction performances for various weekdays also show that the RGM(1,1) performs 
better on middle days of weekdays than two ends of weekdays, which can be investigated from 
Figure 4, of which MAPE is positively correlated with coefficient variation (CV) of the data. The 
predicted values of RGM(1,1) with 4 rolling intervals and real values of speed data on Thursday are 
depicted in Figure 5, which illustrates the precision of predicted values. 
 
0.00%
0.20%
0.40%
0.60%
0.80%
1.00%
Monday Tuesday Wednesday Thursday Friday
M
A
PE
0
1
2
3
4
5
6
7
CV
MAPE
CV
 
Figure 4 MAPE of RGM(1,1) and CV of 
speed data for various weekdays 
 
60
70
80
90
100
110
1 11 21 31 41 51 61 71 81 91 101 111 121 131 141 151 161 171 181 191 201 211 221 231 241 251 261 271 281
Time click (every 5 minutes)
Sp
ee
d
Primitve sequence
Predicted sequence
Figure 5 Predicted and real speed sequences on 
Thursday 
 
 
The MAPE of RGM(1,1) with 4 rolling intervals for various prediction periods are analyzed in 
Table 8 and Table 9, respectively. Similar to the trend of performance in predicting flow, the MAPE 
of RGM(1,1) on speed data slightly increases as the prediction period increases. Even for 5 
prediction period, the MAPE of RGM(1,1) are still lower than 5% and 3% averagely on predicting 
1-minute and 5-minute speed data. 
 
Table 8 MAPE of RGM(1,1) with various rolling intervals for various prediction periods  
(1-minute speed data on Thursday) 
Rolling interval Prediction 
period 4 5 6 7 8 Average 
1 1.74% 2.20% 2.48% 2.61% 2.73% 2.35% 
2 2.11% 2.66% 2.94% 3.26% 3.34% 2.86% 
表 Y04                                         第 13 頁
0.00%
1.00%
2.00%
3.00%
4.00%
5.00%
6.00%
7.00%
8.00%
Monday Tuesday Wednesday Thursday Friday
M
A
PE
0
0.5
1
1.5
2
2.5
3
CV
MAPE
CV
 
Figure 6 MAPE of RGM(1,1) and CV of 
occupancy data for various weekday 
0
2
4
6
8
10
1 11 21 31 41 51 61 71 81 91 101 111 121 131 141 151 161 171 181 191 201 211 221 231 241 251 261 271 281
Time click (every 5 minutes)
O
cc
up
an
cy
Primitve sequence
Predicted sequence
Figure 7 Predicted and real occupancy 
sequences on Monday 
 
 
The MAPE of RGM(1,1) with 4 rolling intervals for various prediction periods are summarized in 
Table 12 and Table 13. Similar to the trends in predicting flow and speed, the MAPE of RGM(1,1) 
on occupancy data slightly increases as the prediction period increases. 
 
Table 12 MAPE of RGM(1,1) with various rolling intervals for various prediction periods 
(1-minute occupancy data on Monday) 
Rolling interval Prediction 
period 4 5 6 7 8 Average 
1 12.38% 15.92% 17.60% 18.89% 19.68% 12.41% 
2 12.37% 16.08% 17.73% 19.13% 20.33% 17.13% 
3 12.58% 16.30% 18.41% 19.29% 20.34% 17.73% 
4 13.11% 16.52% 19.35% 19.50% 20.82% 17.86% 
5 13.28% 16.94% 19.54% 20.76% 21.82% 19.80% 
 
Table 13 MAPE of RGM(1,1) with various rolling intervals for various prediction periods 
(5-minute occupancy data on Monday) 
Rolling interval Prediction 
period 4 5 6 7 8 Average 
1 6.18% 7.46% 8.39% 8.60% 8.98% 7.92% 
2 6.96% 8.46% 9.59% 9.75% 9.86% 8.92% 
3 7.83% 9.51% 10.61% 10.77% 10.98% 9.94% 
4 8.69% 10.62% 11.73% 11.80% 11.87% 10.94% 
5 9.81% 12.03% 12.54% 13.08% 13.76% 12.24% 
 
3.2 Rolling ARIMA 
 
In order to compare the performances of RGM(1,1) in various prediction periods, average MAPE of 
rolling ARIMA model on three traffics are also computed, as shown in Table 14 and Table 15. 
Since ARIMA need considerable datasets in building model, rolling interval is set as 50. Since the 
primitive traffics are nonstationary sequences, 1 order of differencing technique is applied. The 
parameters of (p, q) are identified according to the figures of ACF and PACF. Finally, the 
parameters of ARIMA are respectively set as (2, 1, 1) for flow and speed sequences and (1, 1, 1) for 
occupancy sequence, which holds unchanged in their rolling processes. 
 
Table 14 MAPE of ARIMA on 1-minute traffics 
Prediction period Flow Speed Occupancy 
1 24.59% 2.97% 28.63% 
2 29.32% 3.02% 33.10% 
3 37.43% 5.72% 48.37% 
4 38.88% 11.03% 50.85% 
表 Y04                                         第 15 頁
 
The MAPE of RGM(1,N) with 4 rolling interval for N=1~6 on 1-minute and 5-minute are reported 
in Table 16 and Table 17, respectively. As shown from Table 16, RGM(1,6) outperforms on 
predicting flow and speed with MAPE values of 5.44% and 0.05%, respectively, suggesting the 
excellent prediction grade of the model. In predicting occupancy, RGM(1,5) outperforms with the 
MAPE=4.44%, also suggesting its excellent prediction grade. As to the 5-minute traffics, RGM (1,6) 
is still the best performing model in predicting flow and speed with MAPE of 4.18% and 0.05%, 
while RGM (1,5) performs best in predicting occupancy with MAPE of 1.02%. 
 
Table 16 MAPE of RGM(1,N) with 4 rolling interval on 1-minute traffics 
RGM(1,N) Flow Speed Occupancy 
RGM(1,6) 5.44%* 0.05%* 4.44% 
RGM(1,5) 25.16% 5.75% 1.05%* 
RGM(1,4) 13.86% 3.05% 18.82% 
RGM(1,3) 38.73% 6.13% 6.04% 
RGM(1,2) 37.68% 6.73% 10.21% 
RGM(1,1) 39.20% 13.67% 24.89% 
Note: * indicates the best model. 
 
Table 17 MAPE of RGM(1,N) with 4 rolling interval on 5-minute traffics 
RGM(1,N) Flow Speed Occupancy 
RGM(1,6) 4.18%* 0.05%* 3.21% 
RGM(1,5) 22.57% 5.01% 1.02%* 
RGM(1,4) 10.26% 3.02% 15.22% 
RGM(1,3) 32.87% 5.92% 5.74% 
RGM(1,2) 31.66% 6.07% 8.79% 
RGM(1,1) 35.14% 12.62% 23.51% 
Note: * indicates the best model. 
 
4.2 Rolling ANN 
 
To validate the prediction performance of RGM(1,N), rolling ANN models are developed with same 
explanatory variables, as depicted in Figure 11 (taking flow for instance). ANN software of 
NeuroSolutions is employed to train and validate the models. After several trials, the sigmoid 
threshold transfer function and linear transfer function are set as activation functions between input 
layer and hidden layer and between hidden layer and output layer, respectively. BTW, since ANN 
model is sensitive to the size of training samples, the rolling interval of ANN is set as 100. Results 
on three traffics under various numbers of hidden neurons are reported in Table 18 and Table 19. 
 
表 Y04                                         第 17 頁
Speed 1.74% 2.97% 0.05%* 8.23% 
Occupancy 12.41% 28.63% 1.05%* 16.73% 
Average 8.84% 18.73% 2.18%* 13.43% 
Note: * indicates the best performing model. 
 
As shown from Table 21, RGM(1,N) still outperforms with average MAPE of 1.75%, followed by 
RGM(1,1) with average MAPE of 4.32%. ARIMA performs better than ANN with average MAPE 
of 9.75%. 
 
Table 21 Best performances of four models on 5-minute traffics 
Univariate model Multivariate model Traffics RGM(1,1) ARIMA RGM(1,N) ANN 
Flow 5.94% 11.70% 4.18%* 12.17% 
Speed 0.83% 3.41% 0.05%* 6.18% 
Occupancy 6.18% 14.13% 1.02%* 14.37% 
Average 4.32% 9.75% 1.75%* 10.91% 
Note: * indicates the best performing model. 
 
 
6. CONCLUDING REMARKS 
 
It is necessary to predict a short period ahead for real-time traffic control and traffic information 
provision. However, it remains challenging, because the traffic information usually remarkably 
varies from time to time. This paper aims to develop two types of rolling grey forecasting models 
(RGM) to predict short-term traffics: RGM(1,1) and RGM(1,N). To investigate and validate the 
accuracy and applicability of proposed models, two time horizons of short-term traffics of 1-minute 
and 5-minute are applied, respectively. For comparison, two commonly used short-term traffic 
prediction models: statistical time-series model (ARIMA) and artificial neural network (ANN), are 
also developed. The accuracies in term of mean absolute percent error (MAPE) of various rolling 
intervals (4-8 intervals) and prediction periods (1-5 periods) of the proposed model are also 
compared. The results show that both of RGM(1,1) and RGM(1,N) perform better at fewer rolling 
interval and prediction period. Besides, RGM(1,6) remarkably outperforms in forecasting three 
traffics, followed by RGM(1,1). 
 
Some directions for future studies can be identified. Firstly, although the prediction performances of 
RGM(1,N) and RGM (1,1) are obviously superior to that of ANN and ARIMA, the rolling intervals 
of latter two models are remarkably larger, because of larger samples required, making their 
prediction performances being adversely affected by out-of-date information. A closer investigation 
to comparison of their performances deserves to be conducted. Secondly, this paper measures the 
performances of these prediction models only by MAPE, which ignores the complexity of the 
model. To further consider the complexity of the models, Schwarz’s (1978) Bayesian criterion (SBC) 
can be adopted to determine the best performing model. Thirdly, the performances of RGM for 
short-term traffics are validated on the data detected by a specific loop detector in this paper. The 
prediction performances for short-term traffics of other loops located at diverse environments might 
be worthy of analysis. Last but not least, comparisons to other models, such as Kalman filtering 
mode and cusp catastrophe theory, are also worthy of exploring. 
 
 
ACKNOWLEDGEMENTS 
 
This study was sponsored by the National Science Council of the Republic of China under Contract 
表 Y04                                         第 19 頁
EXPLORING TRAFFIC FEATURES WITH STATIONARY AND MOVING 
BOTTLENECKS USING REFINED CELLULAR AUTOMATA 
 
Chih-Cheng HSU 
Ph.D. Candidate 
Institute of Traffic and Transportation, 
National Chiao Tung University 
4F, 118 Sec.1, Chung Hsiao W. Rd. 
Taipei 10012 Taiwan, ROC 
E-mail: charles.tt92g@nctu.edu.tw 
Zih-Shin LIN 
Ph.D. Student 
Institute of Traffic and Transportation, National 
Chiao Tung University 
4F, 118 Sec.1, Chung Hsiao W. Rd. Taipei 10012 
Taiwan, ROC 
E-mail: simon.tt93g@nctu.edu.tw 
 
Yu-Chiun CHIOU 
Associate Professor 
Institute of Traffic and Transportation 
National Chiao Tung University 
4F, 118 Sec.1, Chung Hsiao W. Rd. 
Taipei 10012 Taiwan, ROC 
Fax: +886-2- 2349-4940 
E-mail: ycchiou@mail.nctu.edu.tw 
Lawrence W. LAN 
Professor and Dean 
College of Management, MingDao University 
Emeritus Professor of National Chiao Tung 
University 
369 Wen-Hua Rd., Peetow, Changhua 52345 
Taiwan, ROC 
Fax: +886-4-887-6659 
E-mail: lawrencelan@mail.nctu.edu.tw 
 
Abstract: This paper proposes refined cellular automata (CA) rules, including anticipation effect, 
slow-to-start, lane change, and interaction among vehicles to explore the fundamental traffic 
features. Generalized definitions of traffic variables, in spatiotemporal sense, and a new concept of 
common unit (CU) for gauging non-identical vehicle sizes and various lane widths are presented. 
The simulation experiments are tested on a two-lane highway context. The effects of both stationary 
and slow-moving bottlenecks on global traffic are also examined. Vehicular trajectories, 
flow-occupancy, and spatiotemporal traffic patterns under deterministic and stochastic conditions 
are displayed. The results reveal noticeable traffic patterns with free flow, wide moving jam and 
synchronized flow phases. This study has demonstrated that the proposed refined CA models are 
capable of capturing the essential features of traffic flows. 
 
Key Words: cellular automata (CA), moving bottleneck, stationary bottleneck 
 
 
1. INTRODUCTION 
 
Recently, cellular automaton (CA) simulation has been widely used to explicate the behaviors of 
traffic flows. A CA model has a number of identical cells, each interacting with a few nearby 
neighbors by simple rules, either deterministic or stochastic. Each cell is in one of a small number 
of discrete states. Time advances in distinct steps and the cell states are updated either 
synchronously (all at once) or asynchronously (either randomly or sequentially). The dimensions of 
CA model are not restricted; however, most of previous research focused on one-dimensional 
model, which is the simplest CA model for simulating a single line flow. 
 
For example, Nagel and Schreckenberg (1992) first proposed a CA model (known as NaSch model) 
to reproduce the basic features of real traffic. In their model, the road is divided into squared cells of 
7.5×7.5 meters. Each cell can either be empty or occupied by at most one vehicle (namely, the size 
of a vehicle is also 7.5×7.5 meters). The space, speed, acceleration and even the time are treated as 
discrete variables. The state of the road at any time-step is derived from one time-step ahead by 
applying acceleration, braking, randomization and driving rules for all cars at the same time (i.e., 
synchronously-updated dynamics). Obviously, such a “coarse” description is an extreme 
表 Y04                                         第 21 頁
 
 
2. DEFINITIONS OF CELLS, SITES AND TRAFFIC VARIABLES 
 
2.1 A Common Unit for Cells and Sites 
 
The concept of “common unit” (CU) was first introduced by Lan and Hsu (2005, 2006) to describe 
different vehicle types and their required clearances for safe movement in the contexts of various 
widths of lanes or roadways. In consideration of the facts that a standard freeway lane has a width 
of 3.75 meters (12 feet) but a narrow street lane may only have a width close to 2.5 meters and that 
the operational widths of different vehicle types are varied, Lan and Hsu (2005, 2006) defined a 
squared grid of 1.25×1.25 meters as the common unit for cells and sites. For safe movement with 
acceptable clearances, based on their observations on the field in Taiwan, a motorcycle was 
represented by a particle of 1×2 cells, always taking up 2 sites of road space. A car was represented 
by a particle of 2×6 cells, always occupying 12 sites of road space. A bus was represented by a 
particle of 3×12 cells, always taking up 36 sites of road space. 
 
To further reflect the situations for Taiwan freeways where speed limit is 110 kph, this study 
continues to use the concept of CU proposed by Lan and Hsu, but will reduce the CU size to a grid 
of 1.25×1.0 meters. Therefore, the maximum speed of CA simulations can be set equal to 
31sites/sec (111.6 kph), very close to the speed limit (110kph), and the incremental speed for 
vehicles is 1 meter per time-step (3.6 kph). Since each “site” will also be exactly occupied or 
unoccupied by a “cell,” the dimension of a “site” in this study must be defined as a grid of 1.25×1.0 
meters. A 3.75-meter (12-feet) standard freeway lane is equivalent to a lane width of “three sites.” 
Likewise, a 2.5-meter urban narrow street can be regarded as a lane width of only “two sites.”  
 
Compact cars and a twin-truck will be used in this study, of which a car is defined as a median-sized 
particle of 2×6 cells whereas a twin-truck is defined as a super large-sized particle of 3×24 cells. Of 
course, other types of vehicles, such as motorcycle, bus, and single-unit truck can also be defined in 
terms of different common units of cells, but these vehicles will not appear in the present paper. 
 
2.2 Traffic Variables in Spatiotemporal Domain 
 
Following Lan and Hsu (2005, 2006), this study defines the traffic variables on site or cell basis. 
The instantaneous occupancy ( )(tρ ), a proxy of instantaneous density, is defined as: 
 
N
tNt o )()( =ρ  (1) 
where the denominator N stands for the total number of sites in road and the numerator N0(t) 
represents the total number of sites occupied by cells (vehicles) at the instantaneous time t. Thus, 
N-N0(t) is the instantaneous total number of empty (unoccupied) sites in road. In a spatiotemporal 
domain S enclosed by TWL ×× , where L denotes the longitudinal length and W denotes the 
transverse width of roadway, and T is the observed period of time, a generalized definition of 
occupancy over this spatiotemporal domain S, )(Sρ , can be defined as: 
 
S
St
tN
ttNS )()()( 0 =Δ∑
Δ∑=ρ  (2) 
where t(S) is the total time spent by all cells in S; ∑ Δ= ttNSt )()( 0 . S represents the ‘volume’ of 
this spatiotemporal domain S. Likewise, a generalized definition of flow in the spatiotemporal 
domain S can be defined as: 
表 Y04                                         第 23 頁
 
Step 4: Randomization. In real situations, not all drivers or vehicles of the same type are identical. 
Therefore, in stochastic CA simulations, we assume with probability p that determined in step 1, the 
velocity of a vehicle will not accelerate or with smaller acceleration at the next time-step. 
if ( prand <() ) then )0,1)1(max()1( −+=+ tvtv nn  (8) 
 
Step 5: Determination of vehicle status identifier Sn(t) in next time-step. 
)(1)(t  if
)(1)(t  if
)(1)(t  if
1
0
1
)1(
tvv
tvv
tvv
tS
nn
nn
nn
n
<+
=+
>+
⎪⎩
⎪⎨
⎧
−
=+  (9) 
 
Step 6: Determination of time (tst) stuck inside the jam. 
⎩⎨
⎧
>+
=+
=
+==
0)1(  if
0)1(  if
0
1
tv
tv
t
tt
t
n
n
st
stst
st  (10) 
 
Step 7: Update position. Move vehicle in accordance with the calculated velocity. 
)1()()1( ++=+ tvtxtx nnn  
 
3.2 Lane-change Rules 
 
The fundamental principles of the lane-change rules proposed by Lan and Hsu (2006) is used in this 
study, which contains the following five steps. 
 
Step 1: Vehicle orientation. For example, if a vehicle is on the left lane of a two-lane road, the 
possible lane-changing scenarios are 1→2→3, 2→3, and vice versa, depending on its original and 
final locations, as demonstrated in Figure 1. 
 
Step 2: Check incentive criterion. Determine whether the vehicle in front on the other lane moves 
with higher speed than that of the vehicle in right front. If yes, the vehicle has incentive to change 
lane. 
 
Step 3: Check gap ahead. Estimate the front gap at the next time-step. If the front gap is too small, 
then check the gap between the vehicle and its downstream vehicle on the other lane to determine if 
it allows for a not-decreasing movement when performing a lane-change in the next time-step. 
 
Step 4: Check safety criterion.  Estimate the gap between the vehicle and its upstream vehicle on 
the other lane at the next time-step. If the gap on the other lane is larger than its upstream vehicle’s 
velocity, it means that a safe lane-change can be performed without cutting in someone else’s way.  
 
Step 5: Randomization. In real situations, not all drivers will make the lane changes even if the 
above lane-change rules are satisfied. Thus, in stochastic CA simulations, this paper assumes that 
with probability R=0.4 the drivers will remain in-lane provided all lane-change rules are met. 
 
表 Y04                                         第 25 頁
m/sec2.  For clearer description, the flow rate q(S) is converted from cells into number of vehicles 
and occupancy ρ(S) is converted into vehicle per kilometer, as the flow-density relations shown in 
Figure 2(b). It is noted that, for deterministic model, the max flow rate can reach approximately 
5,670 veh/hr, or 2,836 veh/hr/lane, which is higher than 2,400 veh/hr/lane in HCM2000. A 
reasonable interpretation for this is that the randomization effect, representing the heterogeneity 
among drivers, has been completely ignored throughout the deterministic simulations, thus 
significantly diminishing the perturbations between vehicles and leading to such a theoretical 
maximum flow rate. In other words, this derived maximum flow rate may be deemed as the 
envelope for the following stochastic simulations. As for stochastic simulations, due to the 
randomization effect, maximum achievable flow rate is reduced to about 4,480 veh/hr, or 2,240 
veh/hr/ln. This is consistent with the empirical data (for example, Chapter 13, HCM2000). 
 
Secondly, from global point of view, the shape of our simulated flow-density result is neither a 
linear line nor a curve but in a form of coarsely dispersion within a certain area. Repeated 
simulations are conducted and it reveals that deterministic CA simulations always outcome with 
identical results. However, due to randomization effect, slight difference always exists for each 
separate CA stochastic simulations, even with completely identical parameters settings. 
 
Thirdly, we also check the average vehicle speeds throughout the entire simulations and find it 
reasonably acceptable. For example, in free stream regime where occupancy is low, vehicles are 
sparely dispersed and thus can move with maximum speeds. The calculated slopes of Figure 2 in 
this regime imply the maximum speeds, i.e., 109.07kph, which locates in the ballpark of the preset 
one, as mentioned above. 
 
Figures 3(a-1), (b-1), (c-1), (d-1) and (e-2) demonstrate the space-time trajectories of vehicles of 
our stochastic modeling, in which Y-axis represents the vehicles moving from bottom to top and 
X-axis represents the time advancing from left to right. Figures 3(a-2), (b-2), (c-2), (d-2) and (e-2) 
are the associated spatiotemporal speed patterns. As shown in Figures 3(a-1) and (a-2), when with 
low occupancy, vehicles are sparely distributed, only few interactions among vehicles are expected. 
Accordingly, free-flow traffic pattern prevails. However, aware that due to stochastic effect, 
vehicles will occasionally decrease speeds; henceforth, a small region of perturbation can be found. 
This is so-called “synchronized flow phase” where vehicles may travel at various speeds from high 
speed (stable state) to low-speed (metastable state). This synchronized traffic region will gradually 
enlarge and reoccur intermittently downstream and become much clearer as long as occupancy 
increases, as shown in Figures 3(b-1) and (b-2). 
 
As the occupancy (density) increases, furthermore, the platoon preset at t=0 will become more 
difficult to disperse because vehicles in the upstream will arrive more frequent the rear of platoon to 
maintain a jammed queue. Quite complex behaviors with noticeable propagation of backward shock 
waves, or the so-called “wide moving jams,” can be observed.  Figures 3(c-1) and (c-2) has clearly 
depicted this phenomenon. Note that the upstream and downstream front of wide moving jam are in 
the form of parallel lines, moving upstream with the same speed vg =15.6 kph, again very close to a 
well-known empirical speed-15 kph evidenced by Kener (2004). Also note that upstream speed of 
the downstream front of wide moving jam keep almost identical even when the occupancy 
continuously increases, as can be seen in Figure 3(d-1) and Figure 3(e-1). The major traffic pattern 
change coupled with increasing occupancy is that the considerable extension of both synchronized 
flow and moving jam region. 
表 Y04                                         第 27 頁
 
This paper further explores more interesting and diversified traffic patterns by introducing a slowly 
moving vehicle into simulation. We deliberately add one twin-truck into different occupancies. To 
initiate the simulation, this twin-truck is placed near the middle of the right lane and it will keep 
remaining on the right lane throughout the simulation (i.e., no lane-change for this twin-truck). In 
the following, the maximum speeds of this twin-truck will be set equal to zero to represent a 
stationary bottleneck and equal to 10 and 20 sites/time-step (36kph and 72kph), respectively, to 
serve as moving bottlenecks. The simulated fundamental diagrams are enclosed as in Figure 4 to 
show the impact arouse since. As anticipated, this slow moving vehicle impairs the whole traffic 
capacity and as a consequence noticeably decreases the maximum flow rate. It is due to the fact that 
a bottleneck would inevitably restrain the road capacity.  Besides, one may tell that along with 
lower twin-truck speed, the achievable maximum flow rate also declines. When a fix bottleneck is 
set on the middle of the road, the traffic capacity would reduce to only about 1,000 veh/hr/lane, 
namely, about 55% of the capacity would be lost. 
 
(a) counted in cells/time-step (b) counted in vehicles/hour 
Figure 4 Impacts of stationary and moving bottlenecks 
 
Another point worthy mentioning is that when introducing a bottleneck, stationary or moving, there 
is a plateau existent in the fundamental diagrams in the neighborhood of the optimum flow point, 
with densities ranging from 20 to 90 veh/km. A more detailed check of our simulation data reveals 
that the lane-change rate will be increased, as shown in Figure 5.  It is obvious that when noticing 
a bottleneck in front, the drivers will tend to overtake that bottleneck if possible. 
 
 
 
Figure 5 Variation of lane-changing rate with moving bottlenecks 
 
The impacts of moving bottlenecks to the originally formed synchronized flow and moving jam can 
表 Y04                                         第 29 頁
 
(a-1) (a-2) 
(b-1) (b-2) 
(c-1) (c-2) 
(d-1) (d-2) 
(e-1) (e-2) 
Figure 6 Vehicular trajectories and traffic patterns with a moving bottleneck of speed 36 kph (a) 
=)(Sρ 0.020, (b) =)(Sρ 0.113, (c) =)(Sρ 0.200, (d) =)(Sρ 0333, (e) =)(Sρ 0.400 
 
表 Y04                                         第 31 頁
 
REFERENCES 
 
Barlović, R., Santen, L., Schadschneider, A., and Schreckenberg, M. (1998) Metastable states in 
cellular automata for traffic flow, European Physical Journal B 5, 793–800. 
Bham, G.H. and Benekohal, R.F. (2004) A high fidelity traffic simulation model based on cellular 
automata and car-following concepts, Transportation Research C 12, 1-32. 
Chowdhury, D., Wolf, D.E. and Schreckenberg M. (1997) Particle-hopping models for two-lane 
traffic with two kinds of vehicles: effects of lane-changing rules, Physica A 235, 417-439. 
Jiang, R. and Wu, Q.S. (2003) Cellular automata models for synchronized traffic flow, J. Phys. A: 
Math. Gen. 36, 381–390. 
Kerner, B.S., Rehborn, H. (1996) Experimental features and characteristics of traffic jams, Physical 
Review E 53, R1297-R1300. 
Kerner, B.S., Klenov, S.L. (2002) A microscopic model for phase transitions in traffic flow, Journal 
of Physics A 35, L31-L43. 
Kerner, B.S., Klenov, S.L. and Wolf, D.E. (2002) Cellular automata approach to three-phase traffic 
theory, Journal of Physics A 35, 9971-10013. 
Kerner, B.S., Klenov, S.L. (2004) Spatio-temporal patterns in heterogeneous traffic flow with 
variety of driver behavioural characteristics and vehicle parameters, Journal of Physics A 37, 
8753-8788. 
Kerner, B.S. (2004) The Physics of Traffic, Springer-Verlag Berlin Heidelberg. 
Knospe, W., Santen, L., Schadschneider, A. and Schhreckenberg, M, (2000) Towards a realistic 
microscopic description of highway traffic, Journal of Physics A 33, 477-485. 
Knospe, W., Santen, L., Schadschneider, A. and Schreckenberg, M. (1999) Disorder effects in 
cellular automata for two-lane traffic, Physica A 265, 614-633. 
Lan, L.W. and Chang, C.W. (2003) Moving behaviors of motorbikes in mixed traffic: particle 
hopping model, Journal of the Eastern Asia Society for Transportation Studies, Vol. 5, 23-37. 
Lan, L.W. and Chang, C. W. (2005) Inhomogeneous cellular automata modeling for mixed traffic 
with cars and motorcycles, Journal of Advanced Transportation 39 (3), 323-349. 
Lan, L. W. and Hsu, C. C. (2005), Using cellular automata to explore spatiotemporal traffic patterns, 
Proceedings, 10th International Conference of Hong Kong Society for Transportation 
Studies, 210-219. 
Lan, L. W. and Hsu, C. C. (2006) Formation of spatiotemporal traffic patterns with cellular 
automaton simulation, Transportation Research Board, 85th Annual Meeting, Washington, 
DC, in CD-ROM. 
Lárraga, M.E., del Río, J.A., Alvarez-lcaza, L. (2005) Cellular automata for one-lane traffic flow 
modeling, Transportation Research C 13, 63-74. 
Nagel, K. and Schreckenberg, M. (1992) A cellular automaton model for freeway traffic, Physics I 
2, 2221-2229. 
Nagel, K. (1996) Particle-hopping models and traffic flow theory, Physical Review E 53, 
4655-4672. 
Nagel, K. (1998) From particle-hopping models to traffic flow theory, Transportation Research 
Record 1644, 1-9. 
Nagel, K., Wolf, D. E., Wagner, P. and Simon, P. (1998) Two-lane traffic rules for cellular automata: 
A systematic approach, Physical Review E 58, 1425-1437. 
Pottmeier, A., Barlovic, R., Knospe, W. and Schadschneider, A. (2002) Localized defects in a 
cellular automaton model for traffic flow with phase separation, Physica A, 308, 471-482. 
Rickert, M., Nagel, K., Schreckenberg, M. and Latour, A. (1996) Two lane traffic simulations using 
cellular automata, Physica A, 231, 534-550. 
Transportation Research Board (2000) Highway Capacity Manual, National Research Council, 
Washington D.C. 
Wang, B.H., Wang, L., Hui, P.M. and Hu, B. (2000) The asymptotic steady states of deterministic 
表 Y04                                         第 33 頁
INTEGRATED DATA ENVELOPMENT ANALYSIS MODELS FOR 
MEASURING TRANSPORT EFFICIENCY AND EFFECTIVENESS 
 
Yu-Chiun CHIOU 
Associate Professor 
Institute of Traffic and Transportation,  
National Chiao Tung University 
4F, 118 Sec.1, Chung-Hsiao W. Rd. 
Taipei, Taiwan 10012 
Fax: +886-2-2349-4940 
Email: ycchiou@mail.nctu.edu.tw 
 
Lawrence W. LAN 
Professor and Dean 
College of Management, MingDao University 
Emeritus Professor of National Chiao Tung 
University 
369 Wen-Hua Rd., Peetow, Changhua, Taiwan 
52345 
Fax: +886-4-887-9013 
E-mail: lawrencelan@mdu.edu.tw 
Tzu-Hui YEN 
Ph.D. Student 
Institute of Traffic and Transportation 
National Chiao Tung University 
4F, 118 Sec.1, Chung-Hsiao W. Rd. 
Taipei, Taiwan 10012 
Fax: +886-2-2214-0911 
E-mail: barbara.tt94g@nctu.edu.tw 
 
 
Abstract: This paper proposes integrated data envelopment analysis (DEA) models to jointly 
evaluate the transport efficiency and effectiveness by measuring the efficiency scores under three 
aspects of technical efficiency, service effectiveness, and technical effectiveness simultaneously. 
The underlying reason for requiring joint evaluation is that when the transport services are produced 
and a portion of which are not consumed, the technical effectiveness would be less than the 
technical efficiency. A case study on 15 bus companies in Taipei is conducted. Results show that the 
number of efficient companies determined by the proposed models is fewer than that determined by 
conventional two-stage DEA models. It indicates a superior benchmarking power of the proposed 
models. 
 
Key Words: integrated DEA model, technical efficiency, service effectiveness 
 
 
1. INTRODUCTION 
 
Data envelopment analysis (DEA) has been widely used to evaluate the technical efficiency or 
technical effectiveness of decision making units (DMUs). Numerous applications of DEA can be 
found in various transport fields, such as airline (e.g. Schefczyk, 1993; Charnes et al. 1996; 
Sengupta, 1999; Alder and Golany, 2001; Chiou and Chen, 2006), airport (e.g. de La Cruz, 1999; 
Joseph, 2000; Martin and Roman, 2001; Adler and Berechman, 2001), maritime transportation (e.g. 
Tongzon, 2001; Cullinane, et al., 2006), transit (e.g. Viton, 1998; Odeck and Alkadi, 2001; 
Karlaftis, 2004), and railway (e.g. Oum and Yu, 1994; Chapin and Schmidt, 1999; Cowie, 1999; 
Lan and Lin, 2003). Most of these studies only evaluate the transport industries from the aspect of 
technical-efficiency. Thus, measures of technical efficiency (a transformation of productions from 
input factors) and service effectiveness (a transformation of consumptions from productions) by 
DEA technique for ordinary storable commodities are essentially the same because the commodities, 
once produced, can be stockpiled until consumed. However, technical efficiency and service 
effectiveness for non-storable commodities, such as transport services, usually represent two 
distinct measurements for production and sales departments, respectively. When such commodities 
are produced and a portion of which are not consumed right away, the technical effectiveness (with 
表 Y04                                         第 35 頁
2. CONVENTIONAL MODELS 
 
Data envelopment analysis (DEA) is a method for measuring the relative efficiency of decision 
making units (DMUs) that perform similar tasks. For the cases of constant returns to scale, Charnes, 
Cooper and Rhodes (hereafter, CCR model) generalized the single output/single-input ratio 
efficiency measure for each DMU to multiple-output/multiple-input situations by establishing a 
linear combination of outputs and inputs (Charnes, et al., 1978).  For the cases of variable returns 
to scale, Banker, Charnes and Cooper (hereafter, BCC model) further revised the CCR model by 
adding the convexity constraint (Banker, et al., 1984). For transport services evaluation, to avoid 
proposing conflict improvement suggestions, Lan and Lin (2003) proposed two-stage DEA models, 
which employ input-oriented DEA (either CCR or BCC model) to evaluate the relative technical 
efficiency of a DMU by choosing factor variables as inputs and production variables as outputs, 
then employ output-oriented DEA (either CCR or BCC model) to evaluate the relative service 
effectiveness of a DMU by choosing production variables as inputs and consumption variables as 
outputs. These conventional CCR, BCC and two-stage DEA models are briefly narrated below. 
 
2.1 CCR Model 
 
K DMUs are assumed to be evaluated. The primal problem of the input oriented CCR model can be 
formulated as follows: 
[CCR-I] 
vu
Max
,
 
∑
∑
=
== m
j
kjj
s
r
krr
k
xv
yu
h
1
1                                                      
                                               
s.t.   1
1
1 ≤
∑
∑
=
=
m
j
ijj
s
r
irr
xv
yu
, ni ,,2,1 L=                                                    
                                    
0≥jv , mj ,,2,1 L=                                                               
                                
0≥ru , sr ,,2,1 L=                                                                
                          (1) 
where, ykr denotes the rth outputs of the kth DMU. xkj represents the jth inputs of the kth DMU. λl is 
the virtual multiplier of the lth DMU. n, m, s are the number of DMUs, inputs and outputs, 
respectively. The value of hk solved by [CCR-I] represents the relative input efficiency (IE) of kth 
DMU. vj and ur are virtual multipliers corresponding to inputs and outputs. 
 
[CCR-I] can be transformed into an ordinary linear problem as follow: 
[CCR-I-LP]  
vu
Max
,
 ∑
=
=
s
r
krrk yuh
1
                                                  
                                          
s.t.   0
11
≤−∑∑
==
m
j
ijj
s
r
irr xvyu , ni ,,2,1 L=                                             
                       
1
1
=∑
=
m
j
kjj xv ,                                                                    
表 Y04                                         第 37 頁
[BCC-I]       Min  z                                                          
                                                     
s.t 
∑
=
≥
K
l
ljlkj xzx
1
λ  ,  j=1,2,…,J                                                
                                        
∑
=
≤
K
l
lilki yy
1
λ  ,  i=1,2,…, I                                                 
                                          
1
1
=∑
=
K
l
lλ                                                                
                                                    
 
Kll ,...,1　,0 =≥λ                                                          
                                         (5) 
 
Likewise, the output oriented BCC model can be formulated as follows: 
[BCC-O]     Max  h                                                           
                                                    
s.t.  
1
1
=∑
=
K
l
lλ                                                                
                                                 
 
∑
=
≥
K
l
ljlkj xx
1
λ  ,  j=1, 2,…,J                                               
                                        
∑
=
≤
K
l
lilki yhy
1
λ  , i=1, 2,…, I                                               
                                        
Kll ,...,2,1　,0 =≥λ                                                       
                                       (6) 
 
In evaluating the relative efficiency of transport organizations, the abovementioned DEA models 
can be separately applied to evaluate relative efficiency of each DMU from any one aspect of 
technical-efficiency, service-effectiveness, and technical-effectiveness under analytical framework 
depicted in Figure 1. However, conflict improvement suggestions might be proposed, since these 
three models are solved independently. 
 
2.3 Two-stage DEA Model 
 
The two-stage DEA model can be formulated as follows (taking CCR as an example): 
 
[Stage 1: CCR-I] for evaluating technical-efficiency: 
vu
Max
,
 
∑
∑
=
== m
j
kjj
s
r
krr
k
xv
yu
h
1
1                                                            
                                              
表 Y04                                         第 39 頁
[ICCR]   
wvu
Max
,,
  
⎟⎟
⎟⎟
⎟
⎠
⎞
⎜⎜
⎜⎜
⎜
⎝
⎛
+
⎟⎟
⎟⎟
⎠
⎞
⎜⎜
⎜⎜
⎝
⎛
=
∑
∑
∑
∑
=
=
=
=
s
r
krr
p
q
kqq
m
j
kjj
s
r
krr
k
yu
lw
xv
yu
H
1
1
1
1                                        
                            
s.t.    ∑∑
==
≤
m
j
ijj
s
r
irr xvyu
11
, ni ,,2,1 L=                                               
                           
∑∑
==
≤
s
r
irr
p
q
iqq yulw
11
, ni ,,2,1 L=                                                     
                     
0≥jv ,   mj ,,2,1 L=                                                            
                             
0≥qw ,   pq ,,2,1 L=                                                            
                             
0≥ru ,   sr ,,2,1 L=                                                            
                        (9) 
where, Hk ]2,0[∈ represents the overall efficiency score of the kth DMU. If Hk equals to two, the 
DMU is efficient; on the contrary, the DMU is inefficient. 
 
In order to conduct slack analysis, slack variables are added onto each variable. [ICCR] can 
therefore be reformulated as follow: 
[ICCR-S]   
wvu
Max
,,
  
⎟⎟
⎟⎟
⎟
⎠
⎞
⎜⎜
⎜⎜
⎜
⎝
⎛
+
⎟⎟
⎟⎟
⎠
⎞
⎜⎜
⎜⎜
⎝
⎛
=
∑
∑
∑
∑
=
=
=
=
s
r
krr
p
q
kqq
m
j
kjj
s
r
krr
k
yu
lw
xv
yu
H
1
1
1
1                                     
                               
s.t.    ( )∑∑
==
−≤
m
j
kjkjj
s
r
irr sxvyu
11
, ni ,,2,1 L=                                        
                        
( ) ∑∑
==
≤+
s
r
irr
p
q
kqkqq yuslw
11
, ni ,,2,1 L=                                              
                 
0≥jv ,   mj ,,2,1 L=                                                          
                               
0≥qw ,   pq ,,2,1 L=                                                          
                               
0≥ru ,   sr ,,2,1 L=                                                           
                       (10) 
 
With a given production iry , [ICCR-S] can be expressed as: 
[ICCR-S]   ⎟⎟⎠
⎞
⎜⎜⎝
⎛
⎟⎟⎠
⎞
⎜⎜⎝
⎛+⎟⎠
⎞⎜⎝
⎛⎟⎠
⎞⎜⎝
⎛= ∑∑∑∑
====
m
j
kjj
p
q
kqq
s
r
krr
s
r
krrku,v,w
xvlwyuyuHMax
1111
                          
              
表 Y04                                         第 41 頁
0≥ru ,   sr ,,2,1 L=                                                            
                            (12) 
 
 
4. CASE STUDY 
 
To investigate the applicability of the proposed models and to further compare the results of 
proposed models with the conventional two-stage DEA models, a case study on the 15 bus 
companies in Taipei is conducted. 
 
4.1 Data 
 
In this paper, we take the Taipei bus transit as the case study. Currently there are 15 bus operators, 
all privately-owned, serving for over six-million people inhabited in the Taipei metropolitan area. 
With 287 routes and 3,877 buses, these 15 operators provided 255,802 thousand vehicle-kilometers 
carrying 616,105 thousand passenger-trips in the year of 2006. 
 
Our data set is drawn from Annually Statistical Reports of Transportation in Taipei City, 2006, 
published by the Department of Transportation, Taipei City Government. We select number of 
vehicles, liter of fuel, and number of employees as three factor variables, vehicle-kilometers as the 
production variable, and passenger-kilometers as the consumption variable. The percentages of 
these variables are reported in Table 1. 
 
4.2 Efficiency Scores 
 
The optimal virtual multipliers corresponding to all variables are determined by the proposed 
models. The efficiency scores of three aspects under constant returns to scale and variable returns to 
scale are reported in Table 2 and Table 3, respectively. For comparison, the two-stage DEA models 
that separately determine the optimal virtual multipliers and efficiency scores of technical efficiency 
and service effectiveness are also carried out; wherein the overall efficiency is simply represented 
by the sum of the efficiency scores of two aspects. 
 
In the case of CRS as shown in Table 2, we note that none of the bus companies are evaluated as 
overall efficient by the proposed ICCR model, although one company (No. 14) is evaluated with 
technical efficiency and another one (No. 1) is evaluated with service effectiveness. In contrast, 
there is one bus company (No. 14) evaluated as overall efficient by the two-stage CCR model, 
revealing that the proposed ICCR model has more benchmarking power than the two-stage CCR 
model. In the case of VRS as shown in Table 3, also notice that only one bus company (No. 1) is 
evaluated as overall efficient by the proposed IBCC model, while four bus companies (No. 1, No. 
12, No. 13, and No. 14) are evaluated with overall efficiency by the two-stage BCC model. Again, 
the proposed IBCC model has superior benchmarking power to the two-stage BCC model. 
 
Table 1 Data of 15 bus companies in Taipei (in %) 
Factor variables Production variable Consumption variableBus 
company Vehicle Fuel Employee Vehicle-km Passenger-km 
1 0.181 0.207 0.203 0.181 0.33200 
2 0.097 0.099 0.112 0.102 0.08746 
3 0.082 0.067 0.058 0.061 0.03063 
4 0.059 0.054 0.064 0.058 0.03010 
5 0.063 0.044 0.048 0.050 0.02112 
6 0.131 0.123 0.128 0.130 0.16190 
7 0.100 0.135 0.121 0.130 0.16219 
表 Y04                                         第 43 頁
Table 3 Overall and separate efficiency scores for each bus company under VRS 
IBCC model Two-stage BCC model Bus 
company Overall 
efficiency 
Technical 
efficiency 
Service 
effectiveness
Overall 
efficiency 
Technical 
efficiency 
Service 
effectiveness
1 2.000* 1.000* 1.000* 2.000* 1.000* 1.000* 
2 1.045 0.249 0.795 1.367 0.882 0.485 
3 0.383 0.106 0.277 0.776 0.540 0.236 
4 0.385 0.099 0.286 0.688 0.479 0.209 
5 0.338 0.105 0.234 0.518 0.357 0.161 
6 0.784 0.103 0.680 1.784 1.000* 0.784 
7 1.559 1.000* 0.559 1.861 1.000* 0.861 
8 1.512 0.955 0.557 1.559 0.955 0.604 
9 0.328 0.108 0.220 0.327 0.198 0.129 
10 0.331 0.103 0.229 0.321 0.188 0.133 
11 0.023 0.013 0.011 0.115 0.058 0.057 
12 1.100 0.100  1.000* 2.000* 1.000* 1.000* 
13 0.313 0.300 0.013 2.000* 1.000* 1.000* 
14 1.211 1.000* 0.211 2.000* 1.000* 1.000* 
15 0.237 0.152 0.085 0.240 0.154 0.086 
 
In the proposed IBCC model, we further examine the sign of 0u  and 1u  to identify the returns to 
scale under the aspects of technical efficiency and service effectiveness. The DMU would be 
increasing returns to scale if 0*0 <u  ( 0*1 <u ) under the aspect of technical efficiency (service 
effectiveness). If *0u >0 ( 0
*
1 >u ), the DMU would be decreasing returns to scale and if *0u =0 
( 0*1 =u ), the DMU would be constant returns to scale. The results are summarized in Table 4. It is 
found that most of the Taipei bus companies need to downsize the scales in their productions 
(represented by technical efficiency). However, most of the companies are at optimal scales in their 
sales (represented by service effectiveness), implying that the bus operators have rather good 
experiences arranging the fleet frequencies to cope with the variations of passenger demand. 
 
表 Y04                                         第 45 頁
Table 5 Slack values of factor and consumption variables under CRS 
ICCR model Two-stage CCR model 
Factor variables Service variable Factor variables Service variableBus company 
Vehicle Fuel Vehicle Passenger-km Vehicle Fuel Vehicle Passenger-km
1 0.214 0.200 0.000 0.000 0.177 0.206 0.199  0.000  
2 0.042 0.000 0.000 0.057 0.093 0.098 0.108  0.245  
3 1.381 1.003 0.000 0.000 0.078 0.066 0.054  0.301  
4 0.053 0.000 0.000 0.000 0.055 0.053 0.060  0.302  
5 1.518 0.000 0.043 0.000 0.059 0.043 0.044  0.311  
6 0.250 0.000 0.115 0.076 0.127 0.122 0.124  0.170  
7 1.134 1.000 0.000 0.036 0.096 0.134 0.117  0.170  
8 0.018 0.000 1.000 0.045 0.102 0.112 0.114  0.213  
9 1.621 1.000 0.000 0.000 0.040 0.036 0.036  0.315  
10 1.669 1.000 0.000 0.006 0.045 0.038 0.038  0.314  
11 1.669 1.000 0.000 0.006 0.033 0.033 0.028  0.332  
12 0.462 1.000 0.000 0.000 0.002 0.001 0.003  0.332  
13 0.001 0.003 0.000 0.003 0.003 0.003 0.001  0.332  
14 0.000 0.000 0.000 0.057 0.000 0.000 0.000  0.317  
15 1.632 1.000 0.000 0.062 0.039 0.040 0.021  0.326  
 
 
5. CONCLUDING REMARKS 
 
The efficiency and effectiveness for transport services represent two distinct measurements because 
when the transport services are produced and a portion of which are not consumed, the technical 
effectiveness (with combined effects of both technical efficiency and service effectiveness) would 
be less than the technical efficiency. Therefore, it would be more reasonable and more impartial to 
simultaneously evaluate the performance of any transport services than to separately or 
independently evaluate the performance from the aspects of technical efficiency, service 
effectiveness and technical effectiveness. This paper has developed integrated DEA models that can 
jointly determine the efficiency scores under these three aspects. From the case study of Taipei bus 
transit and the comparisons with conventional two-stage DEA models, we have verified that the 
proposed integrated DEA models have higher benchmarking capability than the conventional DEA 
approaches. 
 
Some directions for future studies can be identified. Firstly, the rationality and uniqueness of the 
virtual multipliers determined by the proposed integrated models should be further verified. 
Secondly, the proposed integrated DEA models take an additive form of technical efficiency and 
service effectiveness with equal weight, measurement with different weights for the efficiency and 
effectiveness terms can be further attempted. Finally, an extension of multi-objective integrated 
DEA model deserves further exploration; and more applications to other cases in comparison with 
other conventional DEA models are also worthy of exploring. 
 
 
ACKNOWLEDGEMENTS 
 
This research is partially granted by National Science Council, Republic of China (NSC 
95-2221-E-009-368-MY2) 
 
