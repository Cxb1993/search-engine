摘 要 
 
在本研究中我們發展出系統化的設計方法來同步合成(1)可直接和間接換熱之熱交換網路
和(2)多溶質水分配及熱交換網路。具體而言，我們採用了改良式的狀態空間(State-Space)
表示法去描述上述網路之結構特性，並據以建構以最小年度費用(TAC)為設計目標的混合
整數非線性規劃(MINLP)模式。為了改善求解之品質及效率，我們也提出引入隨機擾動
的初值產生步驟來幫助確定型最適化計算的收斂，另外也使用聚類分析(cluster analysis)
和人工互動的方式來增進求得最適解的機率，並發展出有效率的演算法來求取具有高可
信度的MINLP 全局最適解。最後，在本報告中也提供數個例題來驗證提出方法的有效性
及優點。 
關鍵詞：同步最佳化、程序整合、水分配網路、熱交換網路、混合型搜尋策略 
 
Abstract 
 
A systematic design methodology is developed in this work for simultaneously synthesizing (1) 
the direct and indirect heat-exchange network and (2) the multi-contaminant water-allocation 
and heat-exchange network (WAHEN) in any chemical process. Specifically, a modified 
state-space representation is adopted to capture the structural characteristics of integrated HEN 
or WAHEN, and a mixed-integer nonlinear program (MINLP) is formulated accordingly to 
minimize the TAC of the network design. To enhance the solution quality and efficiency, a 
stochastic perturbation procedure is introduced to generate reliable initial guesses for the 
deterministic optimization procedures, and cluster analysis and artificial interaction are applied 
to improve the solution. Also, an efficient algorithm is developed to obtain the global optimum 
of this MINLP model with high creditability. Several examples are presented in this report to 
demonstrate the validity and advantages of the proposed approach. 
Key Words: Simultaneous Optimization; Process Integration; Water-Allocation Network; 
Heat-Exchange Network; Hybrid Search Strategy. 
 
 
備 註 
本研究成果己發表在 Chemical Engineering Science 63 (2008) 3664 – 3678 (附件五) 
 
 
 
 
 
 
I 
1. Introduction  
Water and energy are two of the most essential resources for running chemical 
processing plants. The former is needed not only as a solvent in mass-transfer processes but 
also as a heat-transfer medium in heat exchangers. Specifically, various organic and 
inorganic contaminants in another phase can often be removed with process water. Thus, 
clean water is widely considered as an effective mass-separating agent in washing or 
separation operations (such as absorption and extraction). In addition, the aerated and 
purified water is consumed in the utility systems to produce steam and/or cooling water for 
use as heat carriers. After the aforementioned usages, the resulting wastewaters must be 
treated to lower the contaminant concentrations. Some of them can then be recycled and 
reused, while the others discharged to the environment. Bagajewicz (2000) presented a 
comprehensive review of the available design procedures for water networks and the 
potential research opportunities on heat integration. 
Although the water and energy management issues in every chemical process are 
always highly related, the design problems of water allocation networks (WANs) and heat 
exchanger networks (HENs) have been considered separately in the past (Takama et al., 1980; 
Linnhoff and Hindmarsh, 1983; Yee and Grossmann, 1990; Wang and Smith, 1994a,b; 
Alva-Argaez et al., 1998; Huang et al., 1999; Karuppiah and Grossmann, 2006). The former 
networks were synthesized with nonlinear programming (NLP) models, while the latter were 
designed with mixed-integer nonlinear programs (MINLP). However, since the water-using 
units and wastewater-treatment units are often required to be operated at different 
temperatures, a strong interaction does exist between the corresponding WAN and HEN 
designs.  
Savulescu and Smith (1998) and Savulescu et al. (2005a,b) proposed a conceptual 
design method, i.e., the water-energy pinch analysis, to solve the combined WAN-HEN 
optimization problem. The so-called separate system approach was adopted to create the 
overall network design with a graphic tool - the two-dimensional grid diagram. Although 
both direct and indirect heat-exchange options have been considered in their work (Savulescu 
et al., 2002), it is still very difficult to incorporate all possible network configurations and to 
identify an optimal solution with the minimum total annualized cost (TAC) using this 
heuristic approach. On the other hand, Bagajewicz et al. (2002) tried to solve the same 
problem with mathematical programming models. They developed a series of transshipment 
formulations on the basis of the optimality conditions for water-using networks (Savelski and 
Bagajewicz, 2000). In these models, the process-to-process connection streams were allowed 
to be heated/cooled with heat exchangers. However, since the original nonlinear functions in 
NLP and MINLP models were linearized, the true optimal design may not be identifiable by 
using this method. Notice also that the aforementioned two approaches are really not 
applicable to the multi-contaminant problems that usually encountered in the process 
industries and, more importantly, both are in essence sequential procedures. Their common 
main drawback is that the trade-offs between capital investments and operating costs, i.e., 
those associated with freshwater and heating and cooling utilities, cannot be properly 
balanced. To circumvent this problem, Du et al. (2004) studied a multi-contaminant 
WAN-HEN design problem by repeatedly solving MINLP models via adaptive simulated 
annealing and genetic algorithms (GA/SA). Although a simultaneous optimization strategy 
was adopted in this work, the required computation load was extremely heavy and the direct 
 1
concentrations at every source and its highest supply rate, (4) the maximum allowable 
temperature, discharge rate and contaminant concentrations at every sink, (5) the temperature 
levels of the hot and cold utilities, and (6) the heat capacities of all water streams and the 
estimates of overall heat-transfer coefficients in all heat exchangers. 
The resulting WAHEN design should include: (1) the throughput of every water-using 
unit, (2) the number of wastewater-treatment units and their throughputs, (3) the number of 
heat exchangers and their duties, (4) the consumption rates of freshwaters, and the hot and 
cold utilities, (5) the discharge rates of wastewaters and their temperatures and contaminant 
concentrations at the sinks, and (6) the complete network configuration and the flow rate of 
each branch stream.  
3. Model Formulation 
The state-space superstructure was proposed by Bagajewicz and Manousiouthakis 
(1992) and Bagajewicz et al. (1998) as an alternative representation of the mass- and 
heat-exchange networks. Bagajewicz et al. (2002) applied this concept to integrate a 
water-using network with a heat-exchanger network in order to minimize the freshwater and 
energy consumption rates of the combined system. This original structure has been improved 
in the present work to incorporate additional design options, e.g., the distributed 
wastewater-treatment and direct heat-exchange operations. More specifically, the WAHEN is 
viewed as a system of two interconnected blocks (see Figure 1). One is referred to as the 
distribution network (DN), in which all mixers, splitters and the connections between them 
are embedded. The other is the so-called process operator (OP), which can be further divided 
into two sub-blocks, i.e., OP-WAN and OP-HEN. All water users and potential 
wastewater-treatment units are placed in the former sub-block, while all indirect 
heat-exchange opportunities are provided in the latter. Their inner stream connections and the 
corresponding mathematical models are described in the sequel: 
3.1. Distribution Network  
Only the freshwater streams and the cold and hot utility streams can be considered as 
the external inputs to DN block, while the recycle streams from the OP block are treated as 
the internal inputs. Every input is split into several branches and each of them is connected to 
a mixer at the exit leading to one of the OP sub-blocks or to the environment. These splitters 
and mixers are divided into three groups depending upon their original identities or their 
connections with the units in the OP block. In the following equations, the subscript  is 
used to represent a water source or sink, while w
w
 and ware used to represent water streams 
connected to the water-using or wastewater-treatment units in OP_WAN; subscript i  
denotes a hot utility stream, while i and i are the labels of hot process streams connected 
to the heat exchangers in OP_HEN; subscript j  denotes a cold utility stream, while j and 
are the labels of cold process streams connected to the heat exchangers in OP_HEN. 
Notice that, at every splitter and mixer, the water, contaminant and energy balances must all 
be satisfied, i.e.,  
j
1 1 2 2 1 2
1, 1, , 1, , 1, , 1, , 1
1 1 1 1
                                 1,2, ,
out out out out out outM N M N W W
IN in
w w l w k w g w h
l k g h
F f f f f w
 
   
        L W        (1) 
 3
1 1 2 2 1 2
2, 2, , 2, , 2, , 2, , 2
1 1 1 1
                               1,2, ,
out out out out out outM N M N W W
IN in
w w l w k w g w h
l k g h
F f f f f w
 
    
   
        L W
M
       (13) 
1 1 2 2 1 2
2, 2, , 2, , 2, , 2, , 2
1 1 1 1
                                1,2, ,
out out out out out outM N M N W W
IN in
i i l i k i g i h
l k g h
F f f f f i
 
    
   
        L        (14) 
1 1 2 2 1 2
2, 2, , 2, , 2, , 2, , 2
1 1 1 1
                            1,2, ,
out out out out out outM N M N W W
IN in
j j l j k j g j h
l k g h
F f f f f j
 
    
   
        L N
W
       (15) 
1 1 2 2 1 2
2, 1, , 1, , 2, , 2, , 1, , 2, , 2
1 1 1 1 1 1
          1,2, ,
in in in in in inM N M N W W
OUT out
w k w l w k w l w g w h w
k l k l g h
F f f f f f f w
     
            L         (16) 
1 1 2 2 1 2
2, 2, 1, , 1, 1, , 1, 2, , 2, 2, , 2, 1, , 1, 2, , 2,
1 1 1 1 1 1
   
                                                         
in in in in in inM N M N W W
OUT OUT IN IN IN IN IN IN
w w k w k l w l k w k l w l g w g h w h
k l k l g h
F T f T f T f T f T f T f T
     
          
2                                                                   1,2, ,
outw W L
        (17) 
1 1 2 2 1 2
2, 2, , 1, , 1, , 1, , 1, , 2, , 2, , 2, , 2, , 1, , 1, , 2, , 2, ,
1 1 1 1 1 1
   
                                           
in in in in in inM N M N W W
OUT OUT IN IN IN IN IN IN
w w s k w k s l w l s k w k s l w l s g w g s h w h s
k l k l g h
F C f C f C f C f C f C f C
     
          
2                                                                  1,2, ,              1,2, ,
outs S w W L L
      (18) 
1 1 2 2 1 2
2, 1, , 1, , 2, , 2, , 1, , 2, , 2
1 1 1 1 1 1
            1,2, ,
in in in in in inM N M N W W
OUT out
i k i l i k i l i g i h i
k l k l g h
F f f f f f f i
     
            L M        (19) 
1 1 2 2 1 2
2, 2, 1, , 1, 1, , 1, 2, , 2, 2, , 2, 1, , 1, 2, , 2,
1 1 1 1 1 1
   
                                                         
in in in in in inM N M N W W
OUT OUT IN IN IN IN IN IN
i i k i k l i l k i k l i l g i g h i h
k l k l g h
F T f T f T f T f T f T f T
     
          
2                                                            1,2, ,
outi M L
       (20) 
1 1 2 2 1 2
2, 2, , 1, , 1, , 1, , 1, , 2, , 2, , 2, , 2, , 1, , 1, , 2, , 2, ,
1 1 1 1 1 1
   
                                           
in in in in in inM N M N W W
OUT OUT IN IN IN IN IN IN
i i s k i k s l i l s k i k s l i l s g i g s h i h s
k l k l g h
F C f C f C f C f C f C f C
     
          
2                                                      1,2, ,                   1,2, ,
outs S i L L M
N
     (21) 
1 1 2 2 1 2
2, 1, , 1, , 2, , 2, , 1, , 2, , 2
1 1 1 1 1 1
           1,2, ,
in in in in in inM N M N W W
OUT out
j k j l j k j l j g j h j
k l k l g h
F f f f f f f j
     
            L         (22) 
1 1 2 2 1 2
2, 2, 1, , 1, 1, , 1, 2, , 2, 2, , 2, 1, , 1, 2, , 2,
1 1 1 1 1 1
   
                                                         
in in in in in inM N M N W W
OUT OUT IN IN IN IN IN IN
j j k j k l j l k j k l j l g j g h j h
k l k l g h
F T f T f T f T f T f T f T
     
          
2                                                               1,2, ,
outj N L
        (23) 
 5
 sink2,      or OUTq qT T q i    j
s w
                   (33) 
sink
2, , ,
OUT
w s w sC C                               (34) 
where, , and  respectively represent the upper bounds of the flow rate, 
temperature and concentration of contaminant at the wastewater sink ; denotes the 
temperature of heating or cooling utility at sink 
sink
wF
sink
wT
sink
,w sC
sink
qT 
q . 
3.2. Process Operator 
The energy balance round each exchanger in OP_HEN can be written as 
( ) ( ) 0      in out out ini i i i j j j j H CFCp T T F Cp T T i j                  (35) 
where, H  and  denote respectively the sets of process streams coming from the 
hot-stream and cold-stream mixers of DN block;  and  denote the flow rates of hot 
and cold streams respectively;  and  are the corresponding specific heats. The heat 
transfer area needed for each match can be calculated according to the following equation: 
C
iF jF
iCp jCp
,, ,( ) 0      
out in
i jj j j j i j i j H CF Cp T T U A T i j
                     (36) 
where,  is the overall heat-transfer coefficient; ,i jU ,i jA  is the heat-transfer area;  is 
the log-mean temperature difference in the exchanger. Finally, notice that the above two 
equations are valid only when the corresponding match is active. This requirement can be 
described by introducing binary variables into the inequality constraints established 
according to the second law of thermodynamics, i.e. 
,i jT

 , ,1in outj i i j i jT T M z      Hi , Cj                (37) 
, ,(1 )
out in
j i i j i jT T M z     Hi , Cj                 (38) 
0out ini iT T    Hi                           (39) 
0in outj jT T    Ci                           (40) 
where,  is a binary variable reflecting whether or not the match between streams  and ,i jz i
j  exists; ,i jM  and ,i jM   are two large enough positive constants. Notice that, in this 
model, every hot stream is allowed to be matched with more than one cold stream and vice 
versa. This practice is adopted to improve the search efficiency in solution process 
(Papalexaddri and Pistikopoulos, 1994; Dong et al., 2007).  
The water-using operations in OP_WAN are assumed to be always present. The mass 
balance for every water-using unit can thus be formulated without using a binary variable, 
 7
denoted as .  Thus,  ( )Tsize 
   int UW size size T                          (45) 
where,  represents the total number of existing water-using units.   Usize 
On the other hand, it is also imperative to place additional interior junctions to 
provide enough opportunities to match the hot and cold streams in the sub-block OP_HEN. 
Since the numbers of hot and cold streams in WAHEN cannot be determined in advance, the 
corresponding junction numbers can only be estimated heuristically by enumeration. In this 
study, it has been found that these numbers should be chosen within the following ranges: 
      22 U int U Tsize M size size                       (46) 
      22 U int U Tsize N size size                       (47) 
The upper and lower bounds here can be obtained by counting all possible 
connections between water-using and/or wastewater-treatment units. The optimal WAHEN 
can be identified by the selecting the numbers of interior junctions for hot and cold streams 
and then solving the corresponding MINLP model in a trial-and-error fashion. The values of 
intM  and should be increased one-at-a-time from their lower limits. intN
4. Interactive Solution Strategy  
 Engineering optimization problems are often formulated as non-convex 
mixed-integer nonlinear programs. Recent developments on the stochastic and deterministic 
algorithms for solving MINLP models have been thoroughly reviewed by Pardalos et al. 
(2000) and Floudas et al. (2005). It is well recognized that none of the available generic 
methods can be applied successfully to all chemical process synthesis problems without the 
aid of case-specific insights. The proposed WAHEN optimization algorithm includes three 
distinct components. The first is designed to produce feasible solutions with randomly 
generated initial guesses; the second is used to improve the candidate solution(s) with 
perturbation techniques; the third is aimed to produce alternative network structures (mainly 
HEN) evolutionarily by shifting heat loads in loops and along utility paths. The detailed 
solution steps are given in the flowchart shown in Figure 2. The DICOPT solver 
(Viswanathan and Grossmann, 1990) in GAMS is used in this procedure to solve the 
MINLP models and it is interfaced with MATLAB (Ferris, 2005) for executing various 
initiation and perturbation steps in the first and second components. Also, to improve the 
preliminary HEN structure in the integrated WAHEN, heat loads are shifted around loops 
and along paths to reduce exchanger number (Su and Motard, 1984) in the third component. 
Aspen’s Engineering Suite is adopted in this work to implement the needed evolutionary 
procedure. Notice that, although the solution steps within each component can be performed 
automatically, the above optimization strategy still has to be executed interactively between 
different components at locations A, B, C and D so as to monitor the solution performance 
and to judicially interfere and/or control the solution process. 
Before carrying out the proposed solution procedure, it is helpful to first determine 
 9
introducing random perturbations into the initial feasible solutions. In addition, the original 
MINLP model is also modified by fixing the freshwater and utility levels at those in the 
selected initial solution. This modified model is then solved with the perturbed initial guesses 
to search for improved solutions. More specifically, the initial split ratios are adjusted 
according to the following equation: 
 , , , , , ,1Ip q r p q r p q r                            (50) 
where, denotes the split ratio in the component-1 solution; , ,
I
p q r , ,p q r is a randomly 
generated perturbation in the interval  ,    and usually 0.05  . On the other hand, the 
binary variables are adjusted one-at-a-time. Each time one of the binary variables is selected 
randomly. Its value is then changed from 0 to 1 or vice versa.  
As mentioned previously, the HEN structure is improved in the 3rd component by 
breaking heat load loops. Since this evolutionary technique is well known, a detailed 
description of the implementation steps is omitted for the sake of brevity. With the help of 
case-specific insights, the solution process can be made more efficient by driving the search 
to a much more restricted region, which cannot otherwise be discovered with an automatic 
computer algorithm.  
 
5. Application Examples  
Following examples are presented to illustrate the capabilities of the modified 
state-space model and the effectiveness of the proposed solution strategy. Examples 1 was 
originally solved with a sequential procedure based on the pinch analysis by Savulescu and 
Smith (1998) and Savulescu et al. (2005a,b), or with the mathematical programming models 
by Bagajewicz et al. (2002). Example 2 was studied by Bagajewicz et al. (2002) without 
considering the wastewater-treatment options. Example 3 is a multi-contaminant water 
network design problem adopted from Mann and Liu (1999). This system was later integrated 
with HEN by Du et al. (2004), but the direct heat-exchange opportunities were ignored 
completely.  
A set of common model parameters are used in all three examples. Specifically, the 
unit prices for the primary and secondary waters are chosen to be 0.375 and 0.45  
respectively; the inlet and outlet temperatures of cooling water are set at 10  and 20℃ ℃ 
respectively, and its cost is 189 USD ; the temperatures of low- and 
medium-pressure steams are assumed to be 120 and 150℃ respectively, and the 
corresponding costs are 377 and 388 USD ; the overall heat transfer coefficient is 
assumed to be 0.5 ; the annualized capital-cost model for a conventional 
shell-and-tube heat exchanger is 8000 , where the heat-transfer area is in 
 (Ahmad et al., 1990; Linnhoff and Ahmad, 1990). Finally, the annual interest rate is set 
at 10% and the plant is assumed to be operated continuously for 8000 hours a year. 
-1USD ton
,i jA
-1 -1kW  yr
-1 -1kW  yr
0.6
, 1200 i jA
2 okW/m C
,i jz 
2m
 
 
 11
In Case I of the present example, the sequential solution procedure suggested by 
Bagajewicz et al. (2002) is followed to integrate the water-using network with a 
heat-exchange network. More specifically, a NLP model is solved first to synthesize a water 
network with minimize freshwater usage and then a MINLP model is solved accordingly to 
obtain a heat-exchange network with minimum utility cost. The resulting network structure is 
shown in Figure 5, in which 4 heat exchangers, 1 cooler and 2 heaters are included. Its TAC 
and the corresponding capital investment were found to be 2,742,198.4 and 
406,290.8 respectively. The freshwater flow rate in this design is 77.3 , while 
the consumption rates of cold and hot utilities (LP steam) are 491 and 3,736.2 kW 
respectively.  
-1USD yr
-1kg s-1USD yr
The same WAHEN design problem is solved in Case II with simultaneous solution 
strategy. Specifically, a single state-space MINLP is solved to obtain the design with 
minimum TAC. The resulting network structure is presented in Figure 6, in which 2 heat 
exchangers and 2 heaters are used. Its TAC and the corresponding capital investment were 
found to be 2,631,805.4  and 305,913.3  respectively. The freshwater flow 
rate in this design is 87.2 , while the consumption rate of hot utility (LP steam) is 
3,671.4 kW.  
-1USD yr
-1kg s
-1USD yr
A comparison of the key features of the above two designs is summarized in Table 3. 
It can be concluded that the simultaneous optimization strategy is clearly superior to a 
sequential one.  This is due to the fact that the trade-off issues in WAHEN design can be 
better addressed with the former approach. Specifically, although the consumption rate of 
freshwater in Case I is less than that in Case II, the utility consumption level and the capital 
investment in the former case are both drastically reduced so as to lower TAC significantly in 
the latter case.  
To demonstrate the capability of state-space superstructure for incorporating the 
wastewater-treatment options in WAHEN design, an additional case study (Case III) is 
performed by imposing an extra upper bound of 20 ppm on the contaminant concentration at 
the sink. In addition, it is assumed that two classes of wastewater-treatment processes are 
available for the present system, their removal ratios are 95% and 90% respectively, and their 
operating temperatures are both required to be maintained at 30 . ℃ The cost models of these 
treatment units are adopted from Kuo and Smith (1998). The capital costs ( ) are 
determined according to the formulas and , while the corresponding 
operating costs ( ) are calculated with the formulas and respectively. In 
these formulas, the symbol represents the throughput of treatment unit  in . The 
state-space superstructure for this case is shown in Figure 7. Notice that, although all splitters 
and mixers are connected in the DN block, the connecting branches are not shown in this 
figure for the sake of legibility. The labels OP_WUN and OP_WTN are used to represent the 
process operators for water-using and wastewater-treatment networks respectively, while 
OP_HEN is used to denote the operator for heat-exchange network. The darkened circles are 
the units eventually chosen in the optimal design. By including the aforementioned 
wastewater-treatment options in the state-space superstructure and solving the resulting 
model, an optimal WAHEN design can be obtained (see Figure 8). Notice that, other than the 
water-using units, there are 1 wastewater-treatment unit, 4 heat exchangers, 1 cooler and 2 
-1USD hr
1ton hr
0.716800 tF
0.712600 tF
tF
-1USD hr 0.76 tF
ttF
 13
Nomenclature 
,i jA          the heat-transfer area in an heat exchanger between the i th hot stream 
and j th cold stream. 
,
IN
p iF ,     the products of heat capacity and mass flow rate of the i th hot stream 
and
,
IN
p jF
j th cold stream entering DN block from environment ( 1p  ) and from 
OP block ( ) respectively. 2p 
,
OUT
p iF ,   the products of heat capacity and mass flow rate of the th hot stream and ,
OUT
p jF i
j th cold stream leaving from DN block to the OP block ( 1p  ) and to the 
environment ( ) respectively. 2p 
, ,p q rf          product of heat capacity and mass flow rate associated with a branch from 
the splitter on the th hot , cold or water stream entering from environment 
( 1
q
p  ) and from OP block ( 2p  ) respectively to the th outlet mixer  r
extM ,    the numbers of exterior junctions on the DN block for the hot and cold streams 
respectively from (or to) the environment. 
extN
intM ,     the numbers of interior junctions on the DN block for the hot and cold 
streams respectively from (or to) the OP block. 
intN
IN
pM ,     the numbers of inlet splitters for hot and cold streams on the DN block from 
environment (
IN
pN
1p  ) and from OP block ( 2p  ) respectively. 
OUT
pM ,   the numbers of outlet mixers for hot and cold streams on the DN block to the 
OP block (
OUT
pN
1p  ) and to the environment ( 2p  ) respectively.  
im ,         the numbers of interior junctions associated with exterior hot stream i  and 
exterior cold stream 
jn
j  respectively. 
m ,          the numbers of interior junctions associated with hot streams and cold 
streams in general. 
n
in
wT ,      the water-stream temperatures at the inlet and outlet of water using unit amd 
treatment unit (  respectively. 
out
wT
)w
in
iT ,      the hot-stream temperatures at the inlet and outlet of exchanger  
respectively. 
out
iT ( , )i j
in
jT ,      the cold-stream temperatures at the inlet and outlet of exchanger  
respectively. 
out
jT ( , )i j
 15
References  
Ahmad, S., Linnhoff, B., & Smith, R.,( 1990). Cost optimal heat exchanger networks-2 
targets and design for detailed capital cost models. Comput. & Chem. Engng., 14, 
751-767. 
Alva-Argaez, A, A. Kokossis, & Smith, R., (1998). Wastewater Minimization of Industrial 
System using an Integrated Approach. Comput. & Chem. Engng., 22 (Suppl.), S741 
-S744 
Bagajewicz, M., (2000). A review of recent design procedures for water networks in 
refineries and process Plants. Comput. & Chem. Engng., 24, 2093-2113. 
Bagajewicz, M. J., & Manousiouthakis, V., (1992). On the mass/heat exchanger network 
representations of distillation networks. AIChE J. 38, 1769. 
Bagajewicz, M., Pham, R., & Manousiouthakis, V., (1998). On the state space approach to 
mass/heat exchanger network design. Chem. Eng. Sci., 53, 2595-2621.  
Bagajewicz, M. J., Rodera, H., & Savelski, M. J., (2002). Energy efficient water utilization 
systems in process plants. Comput. & Chem. Engng., 26, 59-79.  
Chang, C. T., & Li, B. H., (2005). Improved optimization strategies for generating 
practical water-usage and -treatment network structures. Ind. Eng. Chem. Res., 44, 
3607-3618. 
Chang, C. T., & Chen, L. C., (1997). The use of mixers in heat recovery system design. 
Chem. Eng. Sci., 52, 183-194. 
Dong, H.G., Lin, C. Y., & Chang, C. T., (2007). Simultaneous optimization strategy for 
synthesizing heat networks with multi-stream mixers, Chem. Eng. Res. Des. (in press) 
Du, J., Meng, X. Q., Du, H. B., Yu, H. M., Fan, X. S., & Yao, P. J., (2004). Optimal 
design of water utilization network with energy integration in process industries. 
Chinese J. Chem. Eng., 12(2), 247-255. 
Ferris, M. C., 2005, MATLAB and GAMS: Interface optimization and visualization 
software, http://www.cs.wisc.edu/math-prog/matlab.html. 
Floudas, C. A., Akrotirianakis, I. G., Caratzoulas, S., Meyer, C.A., & Kallrath, J., (2005). 
Global optimization in the 21st century: Advances and challenges. Comput. & Chem. 
Engng., 29, 1185-1202.   
Huang, C. H., Chang, C. T., Ling, H. C., & Chang, C. C., (1999). A mathematical 
programming model for water usage and treatment network design. Ind. Eng. Chem. 
Res., 38, 2666-2679. 
Karuppiah, R., & Grossmann, I. E., (2006). Global Optimization for the Synthesis of 
 17
Comput. & Chem. Engng., 8, 67-80. 
 
Takama, N., Kuriyama, T., Shiroko, K., & Umeda, T., (1980). Optimal water allocation in 
a petroleum refinery. Comput. Chem. Eng., 4, 251-258. 
Viswanathan, J., & Grossmann, I. E., (1990). A combined penalty function and outer 
approximation method for MINLP optimization. Comput. & Chem. Engng., 14, 
769-782. 
Wang, Y. P., & Smith, R., (1994a). Wastewater minimization. Chem. Eng. Sci., 49, 
981-1006. 
Wang, Y. P., & Smith, R., (1994b). Design of distributed effluent treatment systems. 
Chem. Eng. Sci., 49, 3127-3145. 
Yee, T. F., Grossmann, I. E., & Kravanja, Z., (1990). Simultaneous optimization model for 
heat integration – І: Area and energy targeting and modeling of multi-stream 
exchangers. Comput. & Chem. Engng., 14, 1151-1164. 
Yee, T. F., & Grossmann, I. E., (1990). Simultaneous optimization model for heat 
integration – ІI: Heat exchanger network synthesis. Comput. & Chem. Engng., 14, 
1165-1184. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 19
Table 1: Process data of Example 1.  
Unit (u) -1 (g s )um  -1(mg l ) inuC  -1(mg l ) outuC  -1lim (kg s ) uf  0( ) uT C  
1 2 0 100 20 40 
2 5 50 100 100 100 
3 30 50 800 40 75 
4 4 400 800 10 50 
Temperature of primary water = 20℃; Maximum wastewater temperature = 30℃ 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Table 2: Process data of Example 2. 
 
Unit (u) -1(g s ) um  -1(mg l ) inuC  -1(mg l ) outuC  -1lim (kg s ) uf  0( ) uT C
1 5 50 100 100 100 
2 30 50 800 40 75 
3 50 800 1100 166.7 100 
Temperature of primary water = 20℃; Maximum wastewater temperature =30℃. 
 
 
 
 
 
 
 
 
 21
Table 5: Process data of Example 3.  
 
Unit (u) Contaminant (s) -1, (g s )u sm  in -1, mg l( )u sC  -1, mg l( )outu sC  0( )uT C  
1 
A 
B 
C 
3.0 
2.4 
1.8 
0 
0 
0 
100 
80 
60 
100 
2 
A 
B 
C 
4.0 
3.0 
3.6 
50 
40 
15 
150 
115 
105 
75 
3 
A 
B 
C 
1.5 
0.6 
2.0 
50 
50 
30 
125 
80 
130 
35 
Temperature of secondary water = 80 ; ℃ Maximum wastewater temperature = 60℃ 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 23
OP_HEN
DN_WAN-HENF1,iIN
F1,jIN
F 2
,iO
U
T
F 2
,jO
U
T
F1,iOUT
F1,jOUT
F 2
,iI
N
F 2
,jI
N
F 2
,w
O
U
T
F 2
,w
＇
IN
F1,w＇OUT
F1,jOUT
F1,iOUT
F1,w＂OUT
F 2
,iI
N
F 2
,jI
N
F 2
,w
＂
IN
OP_WAN
F1,wIN
 
 
 
Figure 1 
 
 
 
 
 
 
 
 
 
 25
 4e+006
 6e+006
 8e+006
 1e+007
 1.2e+007
 1.4e+007
 1.6e+007
TA
C
Radar Graph
Fresh Water Cost (US$)
Utility Cost (US$)
Investment (US$)
-1e+007 -5e+006  0  5e+006  1e+007
-1e+007
-5e+006
 0
 5e+006
 1e+007
 
Figure 3  
 
 
 
 
 
 
60℃
5.714 kg/s
2.449 kg/s
3.265 kg/s5.714 kg/s
67.142℃
18.286 kg/s
6.123 kg/s
77.142℃34 kg/s 50℃92℃82℃40℃
16 kg/s
50 kg/s
[100] [800]
[50]
[100]
[100]
[800]
20 kg/s Unit1
40℃
Unit2
100℃
Unit3
75℃
90 kg/s  20℃
20 kg/s
90 kg/s  30℃
Fresh Water Waste Water
14.286 kg/s
Unit4
50℃
3780kW
H
7980kW
3120kW
5.714 kg/s
5.714 kg/s
240kW
7560kW
1.714 kg/s
 
Figure 4 
 27
 
 
WUTN_OP
OP_WUN
OP_WTN
OP_HEN
DN_WUTN-HENF1,i
IN
F1,jIN
F 2
,iO
U
T
F1,j＇OUT
F 2
,w
O
U
T
F 2
,w
＇
IN
F1,w＇OUT
F1,jOUT
F1,w＇OUT
F 2
,w
＇
IN
F1,wIN
F1,w＇OUT
F1,w＂OUT
F 2
,w
＇
IN
F 2
,w
＂
IN
F1,jOUT
F 2
,iI
N
F 2
,iI
N
F 2
,iI
N
F1,jOUT
F1,jOUT
F1,jOUT
F1,iOUT
F1,iOUT
F1,iOUT
F1,iOUT
F1,w＂OUT
F1,iOUT
F1,i＇OUT
F 2
,w
＂
IN
F 2
,iI
N
F 2
,iI
N
F 2
,i＇
IN
F 2
,jI
N
F 2
,jI
N
F 2
,jI
N
F 2
,jI
N
F 2
,jI
N
F 2
,j＇
IN
F 2
,jO
U
T
 
Figure 7  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 29
86.42℃
8.5 kg/s
27.8 kg/s
[1100]
Unit1
100℃
Unit2
75℃
Unit3
100℃
4250 kg/s  20℃ 4250 kg/s  20.21℃
[118.7]
[100]
[800]
Fresh Water Waste Water
[28.6]65℃
11.1 kg/s
2.7 kg/s
38.8 kg/s
9.4 kg/s
50 kg/s
H
5254.2kW
16570kW
3388kW
H
284kW
4162.8 kg/s
 
Figure 9 
 
 
 
 
 
 
 
 
 
 
840kW
[100,80,60]
[125,95,105]
[125,70,130]
30 kg/s
30 kg/s
3780kW
Unit1
100℃
Unit2
75℃
Unit3
35℃
70 kg/s  80℃
10 kg/s
70 kg/s  60℃
[50,40,30]
Fresh Water Waste Water
[25,20,15]
10 kg/s
10 kg/s
1260kW
1260kW
C
2100kW
2520kW
C
C
H
 
Figure 10 
 31
工系黃孝平教授、清大化工系鄭西顯教授、及兩位教授之研究生與會。 
 本研討會的分組主題共六個，茲分別說明如下： 
1. Process Modeling and Identification 
2. Advanced Process Control Strategies  
3. Process and Control Monitoring 
4.  Plantwide Control 
5. Process Control Applications 
6. Emerging Methods and Technologies 
一般而言，在會期中每天上午第一場皆會安排全體出席之 Plenary 演講(一
小時)，每天上下午皆會安排各兩場之 Keynote 演講(30 分鐘)，而一般議程
則分三組平行進行，每天會安排三個時段，即：11:00-12:40, 14:40-15:40, 
16:00-17:00，每一口頭報告時間長度為 20 分鐘，另外在十三、十四兩天下
午 17:00 以後也有壁報展示。本人之口頭報告論文(Systematic Development 
of Automata Generated Languages for Fault Diagnosis in Continuous Chemical 
Processes)被安排在 7月 13日 下午 14:40開始的議程 A.6 (Session A.6: Fault 
Detection and Diagnosis)中發表，由本人親自宣讀。 
 
 
 
 
7. Fragkoulis, D., et al., “Sensor Fault Detection and Isolation Observer Based 
Method for Single, Multiple and Simultaneous Faults: Application to a 
Waste Water Treatment Process” (poster session PB.2); 
 
8. Escobar, M., et al., “Operational Flexibility of Heat Exchanger Networks” 
(poster session PB.2); 
 
9. Cinar, A., et al., “Monitoring, Analysis, and Diagnosis of Distributed 
Processes with Agent-Based Systems” (session C.5); 
 
10. Hasenauer, J., et al., “Guaranteed Steady-State Bounds for Uncertain 
Chemical Processes” (session C.5). 
 
 
三、 建議： 
除了 ADCHEM 以外，由國際自動控制聯盟(IFAC)主辦的其他兩個與程序
控制相關的系列研討會(DYCOPS 與 IFAC World Congress)水準也很高。另
外，包含程序控制議題的世界性的程序系統工程(PSE)系列研討會，在美國
以三年為周期輪流舉辦的 FOCAPO、FPCAPD 及 CPC 系列，每年一次的歐
洲 ESCAPE 研討會，兩年一次的亞洲 PSE 研討會，以及國內的 PSE 
Symposium(隔年由各大學舉辦)，都是以 PSE 為主題且相當具水準的國際
研討會，建議國內有興趣從事相關研究的學者及工業界人士踴躍參加。另
外也建議儘量爭取在上述研討會主辦或組織特定研究議題議程之機會，以
期能更有效交流，並增加國內研究成果曝光率。 
 
四、 攜回資料：ADCHEM 2009 Preprint (光碟片) 
附件三 - 計畫成果自評 
本研究內容與原提出三年計畫之前兩年幾乎完全相同，由於
貴會僅核定兩年，因此已達成預期目標。而本研究在學術上
貢獻在於發展出過去從未嘗試的將水/熱整合網路設計同步
最佳化數學模式及其求解方法，研究成果己彙整成學術論文
並已在 Chem. Eng. Sci. 發表(見附件五)，由於尚未爭取到
適當合作對象，本研究之應用價值尚待驗證。 
    
Systematic Development of Automata Generated Languages for Fault Diagnosis 
in Continuous Chemical Processes  
Chuei-Tin Chang. Jung-Yang Chen 
 
National Cheng Kung University, Tainan, Taiwan 70101, 
ROC  (Tel:886-6-275-7575 ext. 62663; e-mail: ctchang@mail.ncku.edu.tw). 
Abstract: A SDG-based simulation procedure is presented in this study to qualitatively predict all 
possible effects of one or more fault propagating in a given process system. All possible state evolution 
behaviors are characterized with an automaton model. By selecting a set of on-line sensors, the 
corresponding diagnoser can be constructed and the diagnosability of every fault origin can be 
determined accordingly.  Furthermore, it is also possible to construct a formal diagnostic language on the 
basis of this diagnoser.  Every string (word) in the language is then encoded into an IF-THEN rule and, 
consequently, a comprehensive fuzzy inference system can be synthesized for on-line diagnosis.  The 
feasibility of this approach is demonstrated with a simple example in this paper.  
Keywords: fault diagnosis, automata, signed directed graph, formal language, fuzzy logic. 
 
1. INTRODUCTION 
The fault diagnosis methods have been widely recognized as 
indispensable tools for enhancing process safety. Generally 
speaking, they could be classified into three distinct groups, 
i.e., the model based approaches, the knowledge based 
approaches, and the data-analysis based approaches 
(Venkatasubramanian et al., 2003a, b). However, in order to 
carry out these strategies on-line, it is usually necessary to 
first analyze the historical data and/or operational 
experiences obtained during every serious accident.  This 
requirement cannot always be satisfied in practice.  
To circumvent the above drawbacks, a qualitative cause-and-
effect model, i.e., the signed directed graph (SDG), is used in 
the present study to characterize fault propagation 
mechanisms.  The advantage of this modelling approach is 
mainly due to the fact that the causal relations in process 
systems can always be established according to generic 
engineering principles without any quantitative knowledge. 
On the other hand, it should be noted that such causal models 
are basically static in nature. Many SDG-based fault 
identification techniques were therefore implemented on the 
basis of the steady-state symptoms only, e.g., Maurya et al. 
(2006). Since the effects of fault(s) and/or failure(s) usually 
propagate throughout the entire system dynamically in 
sequence, a series of intermediate events may occur before 
the inception of catastrophic consequences. Thus, the 
performance of a qualitative diagnosis scheme should be 
evaluated not only in terms of its correctness but also its 
timeliness.   
To enhance diagnostic efficiency, it is obviously necessary to 
consider the precedence order (in time) of various fault 
propagation effects derived from the qualitative models. 
Extensive studies have already been carried out to develop 
effective diagnosis strategies by incorporating both the 
eventual symptoms and also their occurrence order into a 
fuzzy inference system (FIS). This approach has been 
applied successfully to a number of loop-free processes  
(Chang et al., 2002) and also to systems with feedback 
and/or feed forward control loops (Chang and Chang, 2003; 
Chen and Chang, 2006; 2007).  
Despite the fact that diagnostic performance can be 
significantly improved with the aforementioned technique, 
the representation, analysis and synthesis of inference 
systems are still very cumbersome. In particular, many 
different versions of the symptom occurrence orders can 
often be deduced from a single fault origin on the basis of 
SDG model. Manual enumeration of all such scenarios for 
all origins may become intractable even for a moderately 
complex system. Furthermore, the diagnosability issues 
concerning the resulting FIS have never been systematically 
addressed in the past. Thus, there is a definite need to 
develop a unified theoretical framework to extract the 
intrinsic features of dynamic fault propagation mechanisms.  
Our concern here is primarily with the sequence of system 
states visited after the occurrence of fault origin(s) and also 
the associated events causing the state transitions. A 
systematic procedure is proposed in this paper to construct 
automata and language models for the purpose of 
representing these sequences accurately and succinctly. As a 
result, additional insights can be revealed and, also, more 
compact inference rules can be produced accordingly.  A 
simple example is provided at the end of this paper to 
demonstrate the feasibility and effectiveness of the proposed 
procedures for FIS synthesis and for fault diagnosis. 
    
reaching a larger one of the same variable. Thus, the 
automaton in Figure 2 can be revised to incorporate this 
requirement (see Figure 3).  
Table 1. System states in Figure 2.
State d x y z u 
0 0 0 0 0 0 
1 +1 0 0 0 0 
2 +1 +1 0 0 0 
3 +1 +1 +1 0 0 
4 +1 +1 +1 -1 0 
5 +1 +1 0 0 +1 
6 +1 +1 +1 0 +1 
7 +1 +1 +1 -1 +1 
Fig. 3. The automaton resulted from ( 10)d +  in Figure 1 
2.3  Diagnoser and Diagnisability 
In realistic applications, the fault origins (i.e., failures or 
upsets) and some of the process variables cannot be 
monitored on-line.  Thus, the event set of an automaton 
model can be further divided into the observable and 
unobservable event subsets, i.e., o uo=    . To check 
diagnosability of each fault origin and also facilitate 
diagnostic inference with the available sensors, the system 
automaton   should be converted to a diagnoser diag , 
which is in essence a transformed automaton with the 
observable subset o as its event set. Although a systematic 
construction procedure has already been developed by 
Sampath et al. (1996) for the discrete event systems in 
general, the diagnosers for the present applications are built 
with an intuitive but more convenient alternative approach. 
Specifically, if a state is reached immediately after an 
unobservable event, then this state is merged with its 
predecessor(s) in the original automaton model.  For 
example, let us assume that ( 1)d +  is the fault origin and 
( 1)y +  is not observable in Figure 2.  The corresponding 
diagnoser can be easily obtained by applying the 
aforementioned principle (see Figure 4).  The numerical 
node labels here are the same as those in Figure 2, while the 
subscript of each label is used to reflect whether or not the 
fault origin has occurred at the corresponding state.  
Fig. 4. The diagnoser obtained by assuming ( 1)y +  in 
Figure 2 is unobservable. 
It should be noted that this construction method is applicable 
even when multiple scenarios are possible. For example, let 
us consider the SDG model in Figure 5 and assume that there 
are two measured variables, i.e., y and z , and four potential 
fault origins, i.e.,  (1) ( 1)xd + ,  (2) ( 1)yd + , (3) ( 1)zd +
and (4) ( 1)ud + .  
Fig. 5. A SDG model with negative feedback loop 
The automaton model of this system and the corresponding 
diagnoser can be found in Figures 6(A) and 6(B) respectively.   
Obviously, the issue of diagnosability becomes important in 
this situation. Although the formal necessary and sufficient 
conditions of system diagnosability has also been derived 
and proven rigorously by Sampath et al. (1995), the 
identifiability of each fault origin in our studies can be 
determined simply by inspecting the diagnoser. In particular, 
the diagnosability of a fault origin can be established if it is 
the unique cause of at least one diagnoser state. Otherwise, 
the corresponding on-line symptoms should be 
indistinguishable from those of one or more scenarios caused 
by other origins. It can be determined on the basis of this 
criterion that fault origins (3) and (4) are both diagnosable, 
while the observable event sequences in scenarios (1) and (2) 
are identical and thus cannot be differentiated from one 
another. 
The feasibility of this simple checking procedure is 
attributed mainly to the fact that the automata used in the 
present applications form a special subclass of those for 
modelling the discrete event systems. More specifically, 
since the continuous chemical processes are considered in 
this work, the corresponding automata can be characterized 
with the following unique features: 
1. The initial automaton state is always associated 
with the normal system condition. 
2. Every initial state transition is triggered by 
    
4. FUZZY INFERENCE SYSTEM 
Every string in ( )diag   is encoded with an IF-THEN rule 
in this work.  These rules can be incorporated in a fuzzy 
inference system to evaluate the existence potential of the 
corresponding fault origin. In particular, if at least one event 
sequence in the marked sublanguage ( )iFdiag   can be 
confirmed, then it is highly possible that they are caused by 
the corresponding fault origin iF . To assert such a belief, the 
fuzzy conclusion “ ics  is OCR” is adopted in the inference 
rule, where OCR is the linguistic value of the occurrence 
index ics  reflecting the highest confidence level in 
confirming the existence of iF . More specifically, this rule 
can be written as 
( )IF   THEN OCRiFo diag is cs∈ = 
where os  denotes the observed event string.  
On the other hand, it is certainly reasonable to disregard the 
possibility of a fault if none of the corresponding event 
strings in ( )iFdiag   can be observed. Thus, the diagnosis 
for this scenario should be “ ics  is NOC”, where NOC is the 
linguistic value representing the lowest level of confidence. 
In other words, 
( )IF   THEN NOCiFo diag is cs∉ = 
The diagnostic conclusion for each of the remaining strings 
should be UCT , i.e., uncertain with confidence level  . In 
particular, this rule can be written as 
( ) ( )IF \   THEN UCTi iF Fo diag diag is cs∈ =   
In this study, the confidence level   in confirming the 
existence of the root cause(s) is assumed to be proportional 
to the string length.  The highest possible confidence level is 
of course assigned to the strings in ( )iFdiag  . 
Finally, it should be noted that the aforementioned IF-THEN 
rules can be implemented with the two-layer fuzzy inference 
framework developed by Chen and Chang (2006).  
5.  CASE STUDY 
Let us consider the level control system presented in Figure 
7 and the corresponding SDG model in Figure 8. All on-line 
signals, i.e., 5s - 8s , are assumed to be available for fault 
diagnosis in this example. For illustration convenience, only 
two possible scenarios are considered here, i.e., (1) a 
moderate (controllable) increase in the flow rate of stream 3 
while control valve CV-01 sticks and (2) an uncontrollable 
increase in the flow rate of stream 3.  
Fig. 7.  A level-control system. 
Fig. 8. The SDG model of level-control system. 
The diagnoser for these two fault origins can be found in 
Figure 9. Notice that this automaton is presented in two parts 
for clarity. States 0  and 0′  are used to represent the 
combined states of the normal condition and the system 
conditions reached immediately after the occurrence of fault 
origin in scenario 1 and scenario 2 respectively. These two 
states, i.e., 0  and 0′ , should be lumped into a single one in 
the actual diagnoser.  
Part 1
Part 2
Fig. 9.  The diagnoser used  for level-control system 
 
 
 
 
 
 
 
 
 
 
附件五 – 
國際期刊論文 
Chemical Engineering Science  
63 (2008) 3664 – 3678 
Author's personal copy
Chemical Engineering Science 63 (2008) 3664 -- 3678
Contents lists available at ScienceDirect
Chemical Engineering Science
journal homepage: www.e lsev ier .com/ locate /ces
Simultaneous optimization approach for integratedwater-allocation and
heat-exchange networks
Hong-Guang Donga, Chih-Yao Linb, Chuei-Tin Changb,∗
aSchool of Chemical Engineering, Dalian University of Technology, Dalian 116012, Liao Ning, PR China
bDepartment of Chemical Engineering, National Cheng Kung University, Tainan 70101, Taiwan, ROC
A R T I C L E I N F O A B S T R A C T
Article history:
Received 29 June 2007
Received in revised form 15 February 2008
Accepted 24 April 2008
Available online 3 May 2008
Keywords:
Simultaneous optimization
Process integration
Water-allocation network
Heat-exchange network
Hybrid search strategy
A systematic design methodology is developed in this work for simultaneously synthesizing the multi-
contaminant water-allocation and heat exchange network (WAHEN) in any chemical process. Specifically,
a modified state-space representation is adopted to capture the structural characteristics of the integrated
WAHEN, and a mixed-integer nonlinear program (MINLP) is formulated accordingly to minimize the total
annualized cost (TAC) of the network design. In the proposed mathematical programming model, not
only all possible water reuse and treatment options are incorporated, but also the direct and indirect
heat-exchange opportunities are considered as well. To enhance the solution quality and efficiency, a
stochastic perturbation procedure is introduced to generate reliable initial guesses for the deterministic
optimization procedures and also, an interactive iteration method is developed to guide the search toward
a potential global optimum. Three examples are presented in this paper to demonstrate the validity and
advantages of the proposed approach.
© 2008 Elsevier Ltd. All rights reserved.
1. Introduction
Water and energy are two of the most essential resources for
running chemical processing plants. The former is needed not only
as a solvent in mass-transfer processes but also as a heat-transfer
medium in heat exchangers. Specifically, various organic and inor-
ganic contaminants in another phase can often be removed with
process water. Thus, clean water is widely considered as an effective
mass-separating agent in washing or separation operations (such
as absorption and extraction). In addition, the aerated and purified
water is consumed in the utility systems to produce steam and/or
cooling water for use as heat carriers. After the aforementioned us-
ages, the resulting wastewaters must be treated to lower the con-
taminant concentrations. Some of them can then be recycled and
reused, while the others discharged to the environment. Bagajewicz
(2000) presented a comprehensive review of the available design
procedures for water networks and the potential research opportu-
nities on heat integration.
Although the water and energy management issues in every
chemical process are always highly related, the design problems
of water-allocation networks (WANs) and heat-exchange networks
∗ Corresponding author. Tel.: 88662757575x62663; fax: 88662344496.
E-mail addresses: donghg@mail.ncku.edu.tw (H.-G. Dong),
ctchang@mail.ncku.edu.tw (C.-T. Chang).
0009-2509/$ - see front matter © 2008 Elsevier Ltd. All rights reserved.
doi:10.1016/j.ces.2008.04.044
(HENs) have been considered separately in the past (Takama et al.,
1980; Linnhoff and Hindmarsh, 1983; Yee and Grossmann, 1990;
Wang and Smith, 1994a, b; Alva-Argaez et al., 1998; Huang et al.,
1999; Karuppiah and Grossman, 2006). The former networks were
synthesized with nonlinear programming (NLP) models, while
the latter were designed with mixed integer nonlinear programs
(MINLP). However, since the water-using units and wastewater-
treatment units are often required to be operated at different tem-
peratures, a strong interaction does exist between the corresponding
WAN and HEN designs.
Savulescu and Smith (1998) and Savulescu et al. (2005a, b) pro-
posed a conceptual design method, i.e., the water-energy pinch
analysis, to solve the combined WAN--HEN optimization problem
The so-called separate system approach was adopted to create the
overall network design with a graphic tool---the two-dimensional
grid diagram. Although both direct and indirect heat-exchange
options have been considered in their work (Savulescu et al., 2002),
it is still very difficult to incorporate all possible network configu-
rations and to identify an optimal solution with the minimum total
annualized cost (TAC) using this heuristic approach. On the other
hand, Bagajewicz et al. (2002) tried to solve the same problem with
mathematical programming models. They developed a series of
transshipment formulations on the basis of the optimality conditions
for water-using networks (Savelski and Bagajewicz, 2000). In these
models, the process-to-process connection streams were allowed to
be heated/cooled with heat exchangers. However, since the original
Author's personal copy
3666 H.-G. Dong et al. / Chemical Engineering Science 63 (2008) 3664 -- 3678
OP_HEN
DN_WAN-HENF1,iIN
F1,jIN
F 2
,
iO
U
T
F 2
,
jO
U
T
F1,iOUT
F1,jOUT
F 2
,
iIN
F 2
,
IN
j
F 2
,
w
O
U
T
F 2
,
w
’I
N
F1,w’OUT
F1,jOUT
F1,iOUT
F1,w”OUT
F 2
,iI
N
F 2
,
jIN
F 2
,
w
”
IN
OP_WAN
F1,wIN
Fig. 1. State-space representation of WAHEN.
F IN1,w =
Mout1 +Nout1∑
l=1
f1,w,l +
Mout2 +Nout2∑
k=1
f1,w,k +
Wout1∑
g=1
f1,w,g
+
Wout2∑
h=1
f1,w,h, w = 1,2, . . . ,W in1 (1)
F IN1,i =
Mout1 +Nout1∑
l=1
f1,i,l +
Mout2 +Nout2∑
k=1
f1,i,k +
Wout1∑
g=1
f1,i,g
+
Wout2∑
h=1
f1,i,h, i = 1,2, . . . ,Min1 (2)
F IN1,j =
Mout1 +Nout1∑
l=1
f1,j,l +
Mout2 +Nout2∑
k=1
f1,j,k +
Wout1∑
g=1
f1,j,g
+
Wout2∑
h=1
f1,j,h, j = 1,2, . . . , Nin1 (3)
FOUT1,w′ =
Min1∑
k=1
f1,k,w′ +
Nin1∑
l=1
f1,l,w′ +
Min2∑
k=1
f2,k,w′
+
Nin2∑
l=1
f2,l,w′ +
W in1∑
g=1
f1,g,w′ +
W in2∑
h=1
f2,h,w′ ,
w′ = 1,2, . . . ,Wout1 (4)
FOUT1,w′ T
OUT
1,w′ =
Min1∑
k=1
f1,k,w′T
IN
1,k +
Nin1∑
l=1
f1,l,w′T
IN
1,l
+
Min2∑
k=1
f2,k,w′T
IN
2,k +
Nin2∑
l=1
f2,l,w′T
IN
2,l
+
W in1∑
g=1
f1,g,w′T IN1,g +
W in2∑
h=1
f2,h,w′T
IN
2,h,
w′ = 1,2, . . . ,Wout1 (5)
Author's personal copy
3668 H.-G. Dong et al. / Chemical Engineering Science 63 (2008) 3664 -- 3678
FOUT2,i =
Min1∑
k=1
f1,k,i +
Nin1∑
l=1
f1,l,i +
Min2∑
k=1
f2,k,i
+
Nin2∑
l=1
f2,l,i +
W in1∑
g=1
f1,g,i +
W in2∑
h=1
f2,h,i,
i = 1,2, . . . ,Mout2 (19)
FOUT2,i T
OUT
2,i =
Min1∑
k=1
f1,k,iT
IN
1,k +
Nin1∑
l=1
f1,l,iT
IN
1,l
+
Min2∑
k=1
f2,k,iT
IN
2,k +
Nin2∑
l=1
f2,l,iT
IN
2,l
+
W in1∑
g=1
f1,g,iT
IN
1,g +
W in2∑
h=1
f2,h,iT
IN
2,h,
i = 1,2, . . . ,Mout2 (20)
FOUT2,i C
OUT
2,i,s =
Min1∑
k=1
f1,k,iC
IN
1,k,s +
Nin1∑
l=1
f1,l,iC
IN
1,l,s
+
Min2∑
k=1
f2,k,iC
IN
2,k,s +
Nin2∑
l=1
f2,l,iC
IN
2,l,s
+
W in1∑
g=1
f1,g,iC
IN
1,g,s +
W in2∑
h=1
f2,h,iC
IN
2,h,s,
s = 1,2, . . . , S, i = 1,2, . . . ,Mout2 (21)
FOUT2,j =
Min1∑
k=1
f1,k,j +
Nin1∑
l=1
f1,l,j +
Min2∑
k=1
f2,k,j
+
Nin2∑
l=1
f2,l,j +
W in1∑
g=1
f1,g,j +
W in2∑
h=1
f2,h,j ,
j = 1,2, . . . , Nout2 (22)
FOUT2,j T
OUT
2,j =
Min1∑
k=1
f1,k,jT
IN
1,k +
Nin1∑
l=1
f1,l,jT
IN
1,l
+
Min2∑
k=1
f2,k,jT
IN
2,k +
Nin2∑
l=1
f2,l,jT
IN
2,l
+
W in1∑
g=1
f1,g,jT
IN
1,g +
W in2∑
h=1
f2,h,jT
IN
2,h,
j = 1,2, . . . , Nout2 (23)
FOUT2,j C
OUT
2,j,s =
Min1∑
k=1
f1,k,jC
IN
1,k,s +
Nin1∑
l=1
f1,l,jC
IN
1,l,s
+
Min2∑
k=1
f2,k,jC
IN
2,k,s +
Nin2∑
l=1
f2,l,jC
IN
2,l,s
+
W in1∑
g=1
f1,g,jC
IN
1,g,s +
W in2∑
h=1
f2,h,jC
IN
2,h,s,
s = 1,2, . . . , S, j = 1,2, . . . , Nout2 (24)
where F INp,w , F
IN
p,i
and F IN
p,j
(p = 1,2) represent, respectively, the mass
flow rates of thewth water stream, the ith hot stream and the jth cold
stream entering DN for the pth time; FOUTp,w , F
OUT
p,i
and FOUT
p,j
(p= 1,2)
denote, respectively, the mass flow rates of the wth water stream,
the ith hot stream and the jth cold stream leaving DN for the pth
time; fp,q,r (p=1,2) is the flow rate of a branch from the qth splitter
to the rth mixer; W INp , M
IN
p and N
IN
p (p= 1,2) represent the numbers
of inlet splitters for the water, hot and cold streams, respectively,
entering the DN for the pth time; WOUTp , M
OUT
p and N
OUT
p (p = 1,2),
respectively, represent the numbers of outlet mixers of the water,
hot and cold streams. Notice that, for a given design problem, the
numbers of exterior junctions to and from environment are fixed,
i.e.,W IN1 =WOUT2 =Wext, MIN1 =MOUT2 =Mext and NIN1 =NOUT2 =Next
are constants. On the other hand, the numbers of interior junctions
to and from the OP block are adjustable parameters, i.e.,Wout1 =W in2 =
Wint, M
out
1 = Min2 = Mint and Nout1,j = Nin2,j = Nint should be chosen by
the designer(s). Consequently,
FOUT1,w = F IN2,w = Fw (25)
FOUT1,i = F IN2,i = Fi (26)
FOUT1,j = F IN2,j = Fj (27)
Finally, there are of course additional constraints imposed at the
sources, i.e.,
F IN1,q6F
source
q (q = w, i or j) (28)
T IN1,q = Tsourceq (q = w, i or j) (29)
CIN1,w,s = Csourcew,s (30)
where Fsourceq denotes the upper flow limits of the supply rate at
source q, Tsourceq is the temperature at source q, C
source
w,s is the con-
centration of contaminant s at source w. A set of similar constraints
can also be imposed at the sinks, i.e.,
FOUT2,w 6F
sink
w (31)
TOUT2,w 6T
sink
w (32)
TOUT2,q′ = Tsinkq′ (q′ = i or j) (33)
COUT2,w,s6C
sink
w,s (34)
where Fsinkw , T
sink
w and C
sink
w,s , respectively, represent the upper
bounds of the flow rate, temperature and concentration of contami-
nant s at the wastewater sink w and Tsink
q′ denotes the temperature
of heating or cooling utility at sink q′.
3.2. Process operator
The energy balance round each exchanger in OP_HEN can be writ-
ten as
FiCpi(T
in
i − Touti ) − FjCpj(Toutj − T inj ) = 0,
i ∈ H, j ∈ C (35)
where H and C denote, respectively, the sets of process streams
coming from the hot-stream and cold-stream mixers of DN block, Fi
and Fj denote the flow rates of hot and cold streams, respectively and
Cpi and Cpj are the corresponding specific heats. The heat-transfer
Author's personal copy
3670 H.-G. Dong et al. / Chemical Engineering Science 63 (2008) 3664 -- 3678
F
F
F
Start
Solve MINLP 
Solution converged?
T
F
Produce initial guesses by
rounding the binary
variables in RMINLP
solution   
F
End
Generate initial
guesses randomly
Solve RMINLP 
Solution converged?
T
F
Tune  real
variables 
Improve Solution 
exists ?
Adjust  binary 
variables
Improve Solution 
exists ?
T
T
Identify candidate
region  
Combine units by
shifting heat load 
Calculated TAC
value
Identify heat load loops 
and
paths in HEN networks 
k = 0
Kperturb = 100
Ktarget = 10000
for m = 1,2,…,
Kperturb
for n = 1,2,…,
Kperturb
T
Fk
T
TAC improve ?
k = k+1
A
B
C
D
Solve MINLP with 
fixed freshwater and 
utility
Solve MINLP with 
fixed freshwater and 
utility
k=0
Ktarget
Fig. 2. Interactive solution strategy.
Author's personal copy
3672 H.-G. Dong et al. / Chemical Engineering Science 63 (2008) 3664 -- 3678
 4e+006
 6e+006
 8e+006
 1e+007
 1.2e+007
 1.4e+007
 1.6e+007
TA
C
Radar Graph
Fresh Water Cost (US$)
Utility Cost (US$)
Investment (US$)
-1e+007 -5e+006  0  5e+006  1e+007
-1e+007
-5e+006
 0
 5e+006
 1e+007
Fig. 3. Radar graph showing distributions of TAC, freshwater cost, utility cost and capital investment.
5.714 kg/s
2.449 kg/s
3.265 kg/s5.714 kg/s
67.142°C
18.286 kg/s
6.123 kg/s
77.142°C
34 kg/s
50°C82°C40°C
16 kg/s
50 kg/s
[100] [800]
[50]
[100]
[100]
[800]
20 kg/s Unit1
40°C
Unit2
100°C
Unit3
75°C
90 kg/s  20°C
20 kg/s
90 kg/s  30°C
Fresh Water Waste
Water
14.286 kg/s
Unit4
50°C
3780kW
H
7980kW
3120kW
5.714 kg/s
5.714 kg/s
240kW
7560kW
1.714 kg/s
92°C
60°C
Fig. 4. An optimal WAHEN design in Example 1.
consumes the smallest amount of freshwater (90kg s−1). There is 1
cooler and 1 heater in this network, but no exchangers are needed.
The TAC and the annualized capital investment of this system are es-
timated to be 2,769,314 and 50829USDyr−1, respectively. The cor-
responding consumption rates of cooling water and hot utility (MP
steam) are 485 and 4265kW, respectively On the other hand, with
the mathematical programming models, Bagajewicz et al. (2002)
synthesized another WAHEN which requires the same freshwater
supply rate. Three heat exchangers and one heater are needed in
this design. The estimated TAC and annualized capital investment in
this case are 2,711,555 and 314495USDyr−1, respectively. The cor-
responding consumption rate of hot utility (LP steam) is 3780kW.
A total of 441 different optimal WAHEN designs have also been
generated for this example on the basis of the proposed state-space
model. The distribution of their TACs, as well as the corresponding
freshwater cost, utility cost and capital investment, can be visual-
ized through a radar graph (see Fig. 3). It can be observed that the
freshwater and utility expenditures are themain contributors of TAC,
while the capital investment plays a relatively minor role. Notice
also that the smallest TAC obtained with the proposed approach is
approximately the same as those mentioned above. One of the net-
works is presented in Fig. 4, in which four heat exchangers and one
heater are used. The TAC and the annualized capital investment in
this case were found to be 2738107.4 and 341,047.4USDyr−1, re-
spectively. Notice that the corresponding consumption rates of the
hot utility (LP steam) and freshwater, i.e., 3780kW and 90kg s−1 are
the same as those estimated for the design reported in Bagajewicz
et al. (2002).
Although the minimum TACs achieved with different approaches
are roughly the same in the present example, it is still more advanta-
geous to follow the modeling and solution strategies proposed in this
work. This is due to the fact that multiple design alternatives can be
Author's personal copy
3674 H.-G. Dong et al. / Chemical Engineering Science 63 (2008) 3664 -- 3678
86.42°C
8.5 kg/s
27.8 kg/s
[1100]
Unit1
Unit2
75 ?
Unit3
100°C
87.2 kg/s  20°C 87.2 kg/s  30°C
[118.7]
[100]
[800]
Fresh Water Waste Water
[28.6]65?
11.1 kg/s
2.7 kg/s
38.8 kg/s
9.4 kg/s
50 kg/s
H
5254.2kW
16570kW
3388kW
H
284kW
100°C
Fig. 6. Optimal WAHEN design for Case II in Example 2.
Fig. 7. State-space superstructure used for Case III in Example 2.
Author's personal copy
3676 H.-G. Dong et al. / Chemical Engineering Science 63 (2008) 3664 -- 3678
86.42°C
8.5 kg/s
27.8 kg/s
[1100]
Unit1
100°C
Unit2
75°C
Unit3
100°C
[118.7]
[100]
[800]Fresh
Water WasteWater
[28.6]65°C
11.1 kg/s
2.7 kg/s
38.8 kg/s
9.4 kg/s
50 kg/s
H
5254.2kW
16570kW
3388kW
H
284kW
4162.8 kg/s
4250 kg/s  20°C 4250 kg/s  20.21°C
Fig. 9. Optimal WAHEN design for case IV in Example 2.
Table 4
A comparison between Cases III and IV in Example 2
Case III (with treatment units) Case IV (without treatment units)
TAC (USDyr−1) 6,555,774.1 47,590,645.4
Capital investment (USDyr−1) 410,069.6 305,913.3
Freshwater consumption rate (kg s−1) 0 4250
Cold utility consumption rate (kW) 4,818.6 0
Hot utility consumption rate (kW) 4,818.6 3671.4
Treatment cost (USDyr−1) 3,418,318.3 0
Equipment requirements 2 heaters, 1 cooler, 3 heat exchangers 2 heaters, 0 cooler, 2 heat exchangers
Table 5
Process data of Example 3
Unit (u) Contaminant (s) mu,s(g s−1) C¯ inu,s(mg l−1) C¯outu,s (mg l−1) T¯u(◦C)
A 3.0 0 100
1 B 2.4 0 80 100
C 1.8 0 60
A 4.0 50 150
2 B 3.0 40 115 75
C 3.6 15 105
A 1.5 50 125
3 B 0.6 50 80 35
C 2.0 30 130
Temperature of secondary water=80 ◦C; maximum wastewater temperature
=60◦ C.
the resulting MINLP, one can then generate the optimal struc-
ture in Fig. 10. It can be observed that this network is assem-
bled with two heat exchangers, three coolers and one heater.
From the optimal solution of the proposed model, the minimum
TAC and the corresponding capital cost can also be obtained, i.e.,
2,905,307.4 and 173,627.4USDyr−1. In this design, the consump-
tion rates of secondary water, and the cold and hot utilities (LP
steam) can be determined to be 70kg s−1, 7140 and 1260kW, re-
spectively. On the basis of the designs produced in this example,
it can be concluded that the proposed method is indeed suit-
able for applications in multicontaminant systems. In fact, this
issue has never been properly addressed in any of the previous
studies
6. Conclusions
The state-space superstructure has been modified in this study
to formulate a MINLP model for one-step optimization of WAHEN
designs with single- or multi-contaminant water streams. The ad-
vantage of this approach is that all possible design options, e.g., the
wastewater-treatment units, the direct and indirect heat exchang-
ers, can be easily incorporated in the model formulation. A hybrid
optimization strategy has also been developed in this work to guar-
antee the solution quality and efficiency By interactively applying
the deterministic and stochastic search techniques in this strategy,
the global optimum can almost always be identified in all case stud-
ies presented in this paper.
Author's personal copy
3678 H.-G. Dong et al. / Chemical Engineering Science 63 (2008) 3664 -- 3678
p,q,r the split ratio of a branch leaving the splitter
on the qth hot (or cold) stream entering the
DN block from environment (p = 1) and from
OP block (p=2), respectively, to the rth mixer
leaving the DN block
Subscripts
ext external
int internal
Superscripts
in exchanger inlet
out exchanger outlet
IN DN inlet
OUT DN outlet
Acknowledgment
This work was supported by the National Science Council of the
ROC government under Grant NSC 95-2221-E-006-421.
References
Ahmad, S., Linnhoff, B., Smith, R., 1990. Cost optimal heat exchanger networks-
2 targets and design for detailed capital cost models. Computers & Chemical
Engineering 14, 751--767.
Alva-Argaez, A., Kokossis, A., Smith, R., 1998. Wastewater minimization of industrial
system using an integrated approach. Computers & Chemical Engineering 22
(Suppl.), S741--S744.
Bagajewicz, M., 2000. A review of recent design procedures for water networks
in refineries and process plants. Computers & Chemical Engineering 24,
2093--2113.
Bagajewicz, M.J., Manousiouthakis, V., 1992. On the mass/heat exchanger network
representations of distillation networks. A.I.Ch.E. Journal 38, 1769.
Bagajewicz, M., Pham, R., Manousiouthakis, V., 1998. On the state space approach
to mass/heat exchanger network design. Chemical Engineering Science 53,
2595--2621.
Bagajewicz, M.J., Rodera, H., Savelski, M.J., 2002. Energy efficient water utilization
systems in process plants. Computer & Chemical Engineering 26, 59--79.
Chang, C.T., Chen, L.C., 1997. The use of mixers in heat recovery system design.
Chemical Engineering Science 52, 183--194.
Chang, C.T., Li, B.H., 2005. Improved optimization strategies for generating practical
water-usage and -treatment network structures. Industrial & Engineering
Chemistry Research 44, 3607--3618.
Dong, H.G., Lin, C. Y., Chang, C. T., 2008. Simultaneous optimization strategy for
synthesizing heat networks with multi-stream mixers. Chemical Engineering
Research & Design 86, 299--309.
Du, J., Meng, X.Q., Du, H.B., Yu, H.M., Fan, X.S., Yao, P.J., 2004. Optimal design of
water utilization network with energy integration in process industries. Chinese
Journal of Chemical Engineering 12 (2), 247--255.
Ferris, M.C., 2005, MATLAB and GAMS: interface optimization and visualization
software 〈http://www.cs.wisc.edu/math-prog/matlab.html〉.
Floudas, C.A., Akrotirianakis, I.G., Caratzoulas, S., Meyer, C.A., Kalrath, J., 2005.
Global optimization in the 21st century: advances and challenges. Computers &
Chemical Engineering 29, 1185--1202.
Huang, C.H., Chang, C.T., Ling, H.C., Chang, C.C., 1999. A mathematical programming
model for water usage and treatment network design. Industrial & Engineering
Chemistry Research 38, 2666--2679.
Karuppiah, R., Grossmann, I.E., 2006. Global optimization for the synthesis of
integrated water systems in chemical processes. Computers & Chemical
Engineering 30, 650--673.
Kuo, W.-C.J., Smith, R., 1998. Designing for the interactions between water-use and
effluent treatment. Transactions of the Institution of Chemical Engineers Part A
76, 287--301.
Linnhoff, B., Ahmad, S., 1990. Cost optimum heat exchanger networks-1: minimum
energy and capital using simple model for capital cost. Computers & Chemical
Engineering 14, 729--750.
Linnhoff, B., Hindmarsh, E., 1983. The pinch design method for heat exchanger
networks. Chemical Engineering Science 38, 745--763.
Mann, J.G., Liu, Y.A., 1999. Industrial Water Reuse and Wastewater Minimization.
McGraw-Hill, New York.
Papalexaddri, K.P., Pistikopoulos, E.N., 1994. A multi-period MINLP model for the
synthesis of flexible heat and mass exchange network. Computers & Chemical
Engineering 18, 1125--1139.
Pardalos, P.M., Romeijn, H.E., Tuy, H., 2000. Recent developments and trends in global
optimization. Journal of Computational and Applied Mathematics 124, 209--228.
Savelski, M., Bagajewicz, M., 2000. On the optimality conditions of water utilization
systems in process plants with single contaminants. Chemical Engineering
Science 55 (21), 5035--5048.
Savulescu, L.E., Smith, R., 1998. Simultaneous energy and water minimization.
In: AIChE Annual Meeting, Miami.
Savulescu, L., Sorin, M., Smith, R., 2002. Direct and indirect heat transfer in water
network systems. Applied Thermal Engineering 22 (8), 981--988.
Savulescu, L.E., Kim, J.K., Smith, R., 2005a. Studies on simultaneous energy and
water minimization---Part I: systems with no water re-use. Chemical Engineering
Science 60, 3279--3290.
Savulescu, L.E., Kim, J.K., Smith, R., 2005b. Studies on simultaneous energy and
water minimization---Part II: systems with maximum re-use of water. Chemical
Engineering Science 60, 3291--3308.
Su, J.L., Motard, R.L., 1984. Evolutionary synthesis of heat-exchanger networks.
Computers & Chemical Engineering 8, 67--80.
Takama, N., Kuriyama, T., Shiroko, K., Umeda, T., 1980. Optimal water allocation in
a petroleum refinery. Computers Chemical Engineering 4, 251--258.
Viswanathan, J., Grossmann, I.E., 1990. A combined penalty function and outer
approximation method for MINLP optimization. Computers & Chemical
Engineering 14, 769--782.
Wang, Y.P., Smith, R., 1994a. Wastewater minimization. Chemical Engineering
Science 49, 981--1006.
Wang, Y.P., Smith, R., 1994b. Design of distributed effluent treatment systems.
Chemical Engineering Science 49, 3127--3145.
Yee, T.F., Grossmann, I.E., 1990. Simultaneous optimization model for heat
integration---I: heat exchanger network synthesis. Computers & Chemical
Engineering 14, 1165--1184.
工系黃孝平教授、清大化工系鄭西顯教授、及兩位教授之研究生與會。 
 本研討會的分組主題共六個，茲分別說明如下： 
1. Process Modeling and Identification 
2. Advanced Process Control Strategies  
3. Process and Control Monitoring 
4.  Plantwide Control 
5. Process Control Applications 
6. Emerging Methods and Technologies 
一般而言，在會期中每天上午第一場皆會安排全體出席之 Plenary 演講(一
小時)，每天上下午皆會安排各兩場之 Keynote 演講(30 分鐘)，而一般議程
則分三組平行進行，每天會安排三個時段，即：11:00-12:40, 14:40-15:40, 
16:00-17:00，每一口頭報告時間長度為 20 分鐘，另外在十三、十四兩天下
午 17:00 以後也有壁報展示。本人之口頭報告論文(Systematic Development 
of Automata Generated Languages for Fault Diagnosis in Continuous Chemical 
Processes)被安排在 7月 13日 下午 14:40開始的議程 A.6 (Session A.6: Fault 
Detection and Diagnosis)中發表，由本人親自宣讀。 
 
 
 
