摘要 
隨著社會不斷發展與進步，能源的需求
量也日益快速增加，世界各國都面臨資源短
缺的問題，因此，節約能源已成為國內外近
年來一個重要的研究議題。本計畫針對建置
一個節能系統來探討，主要在探討在校園中
運用支援 Zigbee 協定的無線感測網路裝置，
蒐集環境中的資料，並將各種環境與人員等
情境資料(context data)，以 XML 的格式儲
存，再運用情境感知推理技術(實作上運用
Jess engine 來進行)，由系統透過設備控制中
介軟體，自動來處理控制當下環境中的各項
設備，達到自動化的校園節能目的。所開發
的系統主要包括 3 大模組：環境感測服務模
組、情境感知推理模組與設備控制模組。透
過本計畫的執行，參與的人員與廠商建立建
教合作關係，深入探討無線感測網路的相關
技術，包括環境感測、ZigBee 協定及相關應
用程式之開發設計等，同時對情境感知系統
的建置與運用、Zigbee 於應用層上的開發等
也會有深入的了解，這些主題都非常實用且
極具研究與產品開發的價值。 
 
關鍵字：Zigbee 協定、無線感測網路、情境
感知、節能 
 
1. 計畫背景及目的 
在世界各國為求進步與發展的條件下，
資源的消耗和使用勢必是一大問題，在全球
資源有限且現階段並無其他替代能源方案
的條件下，如何節省能源就成為目前所關心
的議題。然而現階段節能僅能由人性自發來
實作，或在有獎勵的情況下提倡實施節能。
因此，如何利用先進技術，來讓節能自動化、
智慧化，是一重要課題。在本計畫中使用無
線感測網路技術（Wireless Sensor Network, 
WSN）在節能的應用中取得先機，進而融
入我們的日常生活中之各式應用，而為了要
更加接近人的行為模式，我們導入情境感知
應用的基礎讓設備能夠擁有類似人類的行
為模式，進一步達到自動化的目的。 
在教育部積極提倡校園節能之下，相關
單位不斷的佈建電力控管設備至各級學校，
也將節能的觀念帶入校園，不過事實上學校
的節能仍有很多地方可以改善的。我們發現
大專院校學生約占全國學生人數的四分之
一，用電量卻占全國各級學校用電量六成，
而在教育部推動校園節能減碳方案報告書
中也指出在學校的用電成長原因中，學生空
調設備增加佔五成的用電成長量。另外在教
育部校園電力管理資化輔導團計畫執行成
效中[1]也提到，以現行的用電量，加以執行
改善後，全國各級學校節能效益為 2 億 4003
萬度/年，總節能費用 14,557.9 萬元/年、節
能比率 12.75%，推估全國各級學校節能效
益為 9 億 7389 萬元/年。另外，依財團法人
台灣綠色生產力基金會(綠基會)歷年至學校
節能輔導案例統計，若落實電力、照明、空
調、事務設備等方面節能改善服務，總節能
量約有 7.5 %之節能潛力、約有 16.2%節省
電費之潛力。而這樣的數據更讓我們警覺到
校園節能的重要性。 
而我們學生的角度出發，發現校園中其
實有許多的地方是很浪費能源的，例如可能
學生下課後忘記關教室裡的空調或冷氣，造
成設備不停的消耗能源；走廊上的燈光雖然
沒有人走過卻一直開著；廁所雖然沒有人在
用可是沒有人想到把燈光與抽風機暫時關
起來等等。以上都是由於人為因素而導致能
源不斷的被浪費。當然不僅僅在於課堂上，
在學生宿舍、圖書館等校園建築中，浪費能
源的例子更不勝枚舉。也因此我們針對學生
所較易忽略的部分，在學校的用電節能方面
提出一個可行的解決方法。 
因此，本計畫利用 WSN 的特性，配合
情境感知應用來達到校園的自動化節能系
統，利用情境感知推理機制來判斷當下的環
境所屬的情境，並作出適當的回應，進而達
到節能的目的。在教室的情境中，我們會利
用感測元件來感測教室內部的溫濕度，並配
合情境感知系統來決定教室內部的燈光、空
調開啟的狀況；學生下課後若是忘記關燈光
冷氣，感測元件會自動感測教室裡是否還有
學生，若沒有學生則關閉燈光冷氣，避免不
必要的浪費。 
由於本實驗室先前已有 ZigBee 無線感
Monitor…等感應器。 
情境資訊最後都將傳送給情境感知系
統。使用者的行動裝置上也可備有一些感應
器裝置(例如麥克風、相機等等)，也可以讓
使用者本身也提供一些情境資訊給系統，來
增加系統推理的正確性，當使用者連接無線
網路登入此系統時，情境感知服務系統可以
透過感應接收器來偵測使用者的情境當這
些情境滿足條件時，系統便會通過啟動情境
服務推理機制，來提供適當的服務給使用者。
如下圖二所示。 
 
圖二、情境感知系統應用範例 
 
3. 研究方法 
前面已詳述了 ZigBee 無線感測網路與
配合情境感知應用對於國家發展及產業界
的重要性，因此，這節將介紹我們的研究方
法，首先我們將實做具有推理機制的情境感
知應用平台，其次我們利用 ZigBee 回傳的
資料做分析、預測，並對當下的情境做進一
步的分析做出最適當的回應，以達到節能的
目的。 
 
3.1 自動化節能平台之設計 
本計畫以 ZigBee 無線網路建構而成的
實驗性校園網路概觀，主要提供校園節能與
控制自動化。由符合 ZigBee 規範的相關裝
置，如電燈、電風扇和空氣清淨機、入侵偵
測、煙霧感測和瓦斯感測器所組成，以達成
自動化節能之目的。在其中我們將此平台分
為三個元件，分別為環境感測服務模組、情
境感知推理模組與設備控制模組，其中環境
感測服務模組泛指所有的環境感知儀器，包
括溫度、濕度、光源、壓力感測元件等。而
情境感知推理模組則是利用情境感知技術
及推理機制，將感測元件所收集到的數據資
料採集後加以分析，歸納出其規則並加以應
用；例如當情境感知推理模組收集到足夠的
濕度樣本，根據收集到的資料去判斷周遭的
環境是否需要啟動相對應的解決方法。又例
如當環境太過於乾燥的時候，情境感知推理
平台會啟動相對應的回應，啟動灑水器直到
溼度升高。而情境感知推理模組分析之後的
資料經過轉換後，再傳送給設備控制模組，
進行設備的控制，以達成自動化的效果，在
不同環境情境之下做出最適當的處理。 
接下來則說明本計畫的三個元件與各
模組，如圖三所示。各個功能模組在系統架
構上扮演著支援 ZigBee 裝置不同角色、處
理 ZigBee 感測資料與作出適當回應。 
 
圖三、自動化節能平台之運作流程 
 
3.2 環境感測服務模組 
環境感測服務模組主要在進行環境感
測的服務，感測項目包括：日光、溫濕度、
壓力等，有關於環境的訊息都會經由本模組
採集後，回傳至後端系統進行分析。在本模
組中，系統會因應不同的環境建置不同的感
測元件。例如：在一般的教室中我們只需要
控制燈光空調時，本模組只裝載日光與溫濕
度感測模組。在其他不同環境下，會依據環
境裝載不同的感測元件進行應用。 
下圖四為本計畫所採用與設備溝通，並
回傳至資料處理模組作進一步分析之開發
設備。而圖五為負責感測環境資訊的裝置。 
 
利用 SQL 內部的快取優化與 LINQ 來快速
的查詢資料。 
本計畫在實現教室自動化前，必須累積
環境感測的實驗數據，藉以分析建立不同的
情境，而以課堂中為例，要判斷教室內部的
空調開關作業，首先必須確定教室是否有人
在，而確定教室有人在的方法除了可以預先
輸入課表外，還可以藉由感測裝置來實現，
例如：利用紅外線感測裝置來判斷室內是否
有人，若有人的話可配合課表進行進一步的
分析；可得知教室內大概的人數，配合室內
的濕度來決定空調的大小。當然空調或日光
的優先權是學生，當學生主動去控制燈光空
調時本模組便將控制權交還給學生，直到感
測裝置偵測學生離開教室為止，若是其中學
生不控制燈光空調，其主控權將完全由此模
組來實行。 
本計畫在情境感知系統的實作上，將蒐
集足夠的樣本數，因此，會在系統運轉 2 個
月前佈建環境感測模組，以蒐集足夠的樣本
數。有足夠的樣本數分析後，使本系統收斂
至符合人類行的行為模式，其中會有各種不
同的權重來平衡各種不同的狀況，以達到最
相似人類行為的結果，本計畫所採用的架構
如圖六所示。 
 
圖六、自動化控制平台系統架構 
本模組在本系統中極為重要，為實現自
動化，設備內部的溝通也經由本模組發出，
例如：前上述章節提及之，在極端狀況下系
統將發出停止訊號使設備進入休眠，而條件
的判斷則是由本模組分析獲得的資訊，當本
模組接受足夠的訓練之後，可判斷當時的環
境下是要讓設備進入休眠，除了使用者可預
先輸入在夜晚或是假日時候的休眠行為之
外，系統也能判斷若是期中考時教室提早使
用完畢，系統可以提早進入休眠狀態以節省
能源損耗。 
當我們收集到足夠的資料，我們將會統
整歸納出不同情境，進一步轉成 Java Expert 
System Shell (Jess) [10]的語言，Jess 可以將
資料轉成規則，推理引擎進一步推理、歸納
出不同情境，利用測詴後建立的規則或條例
[9]，配合環境感測模組所收集到的資料，傳
送到推理引擎進行推理，最後再將歸納或推
理出的資料送至資料庫儲存，以便於往後可
以進行資料統計與分析。下圖七為情境感知
推理的架構與流程。 
 
圖七、情境感知推理架構與流程 
 
根據原本建立的條件，推理引擎內已有
建立好規則可以使用，而使用者也可以自行
新增情境規則，使用者可以自行輸入和定義
規則到推理引擎中，例如新增某堂課的教室
空調設備情境，當然也可以透過環境感測模
組收集到的資訊，將資料輸入推理引擎，最
後將推理結果以 JessML 的形式，儲存到資
料庫裡。使用者資料包含了使用者和設備之
間的關係，環境情境設備所提供的資訊例如
教室裡燈光在沒有課或無人使用情況下，可
將電燈自動控制關閉，達到省電的效果，而
在推理引擎內則分成兩部分，一部份是已建
立好的規則，讓系統可以自行判斷條件去控
制，另一部份則是使用者或環境感測模組新
增的規則，本研究主要探討環境感測或使用
者增加的規則，我們以 XML 的語法標示，
如下圖八。 
 
4. 研究成果 
本計畫的成果主要是實作一套以校園
為主的自動化節能服務平台，依照上面章節
所規劃的三個模組來實作一個系統。透過這
個系統來自動化控制校園電器設備，以達到
節能的目的。 
本計畫所實作出的系統主要功能包括
設定、監控及查詢功能。系統會依照不同使
用者登入而做不同的設定，下圖十是登入系
統的畫面，根據不同登入的使用者，給予不
同的控制權限，以避免讓其他人修改到系統
的設定。 
 
圖十、系統登入圖 
此外，系統除了依照不同使用者設定的
進行自動化控制，也可以手動選擇要控制單
位的電器設備，讓臨時需要控制設備時，可
以利用此功能去控制。下圖十一即為本系統
的監控介面。 
 
圖十一、監控介面圖 
本系統還有一個查詢的功能，如下圖十
二，讓系統管理者可以隨時透過網頁得知各
設備的開關，以達到節能的目的。 
 
圖十二、使用中的房間狀態 
由於本計畫與業界廠商合作，因此我們
利用廠商提供之設備，配合本計畫所開發的
情境感知系統，開發出應用於校園內的自動
化節能系統。故本計畫可以成功地利用網頁
程式，透過我們自訂之指令，達成與 ZigBee
設備溝通，進一步控制校園家電設備。 
 
5. 參考文獻 
[1] 教育部校園電力管理資化輔導團計畫
執 行 成 效 , 
www.tgpf.org.tw/upload/publish/publish_23/
教育部校園電力管理資化輔導團計畫執行
成效.pdf 
[2] 教 育 部 校 園 節 能 推 廣 手 冊 , 
http://www.edu.tw/files/download/E0001/data
970603-01.pdf 
[3] A. Harter, A. Hopper, P. Steggles, A. 
Ward, and P. Webster, “The Anatomy of a 
Context-Aware Application,” Proceedings of 
the 5th annual ACM/IEEE international 
conference on Mobile computing and 
networking, pp.59–68, 1999 
[4] A. K. Dey, “Understanding and Using 
Context,” Personal and Ubiquitous 
Computing, Vol 5, No 1, pp.4-7, 2001 
[5] A. Roy, S K. Das and K. Basu, “A 
Predictive Framework of Location-Aware 
Resource Management in Smart Homes,” 
IEEE transactions on Mobile Computing, 
Vol.6, No 11, pp. 1270-1283, Nov.2007. 
[6] B. N. Schilit, D. M. Hilbert and J. Trevor, 
“Context-Aware Communication,” IEEE 
Wireless Communications, Vol 9, No 5, pp. 
46-54, 2002. 
[7] D. Lymberopoulos, Q. Lindsey and A. 
Savvides, “An Empirical Analysis of Radio 
Signal Strength Variability in IEEE 802.15.4 
6. 計畫成果自評 
國科會補助專題研究計畫成果報告自評表 
請就研究內容與原計畫相符程度、達成預期目標情況、研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）、是否適
合在學術期刊發表或申請專利、主要發現或其他有關價值等，作一綜合評估。 
1. 請就研究內容與原計畫相符程度、達成預期目標情況作一綜合評估 
 達成目標 
□ 未達成目標（請說明，以 100 字為限） 
□ 實驗失敗 
□ 因故實驗中斷 
□ 其他原因 
說明： 
 
2. 研究成果在學術期刊發表或申請專利等情形： 
論文：□已發表 ▓未發表之文稿 □撰寫中 □無 
專利：□已獲得 ▓申請中 □無 
技轉：□已技轉 ▓洽談中 □無 
其他：（以 100 字為限） 
 
 
3. 請依學術成就、技術創新、社會影響等方面，評估研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）（以
500 字為限） 
    本計畫利用情境感知配合 ZigBee 無線感測網路，達成校園的自動化節能
等機制，同時 ZigBee 無線感測網路是產學界的熱門研究議題，因此本計畫也
希望藉創新的思惟來帶動產業界對於情境感知與ZigBee無線感測網路研究的
熱忱與研發，藉以提升台灣這領域中所擁有的影響力。 
    本計畫主要是以 ZigBee及情境感知系統技術為主，合作企業對於 ZigBee
無論在技術及產品開發上其能力以足夠，但是無法建構出完成之應用系統，
雖具有車隊管理系統研發能力，但與 ZigBee 應用領域是截然不同的。因此，
本計畫將提昇合作企業利用情境感知系統，使企業能利用情境感知系統技
術，配合節能產品以情境方式控制，以更人性化更節能的方式來建置節能控
制情境服務系統，使節能產品由設備銷售轉為整套系統銷售，也不在只是銷
售硬體設備而是節能解決方案，將可為合作企業增加銷售能力。 
 
98年度專題研究計畫研究成果彙整表 
計畫主持人：陳永昇 計畫編號：98-2622-E-152-001-CC3 
計畫名稱：運用無線感測網路建置校園情境感知節能系統 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 1 1 100%  
研究報告/技術報告 1 1 100%  
研討會論文 2 2 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 1 0 80%  專利 已獲得件數 0 0 100% 件  
件數 0 1 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 2 2 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 1 1 100%  
研究報告/技術報告 1 1 100%  
研討會論文 2 2 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 1 1 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 2 2 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
 
