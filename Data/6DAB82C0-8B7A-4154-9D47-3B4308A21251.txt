行政院國家科學委員會專題研究計畫期末報告 
 
資料探勘應用於區域負載預測（1/2） 
Data mining applies in the region load forecast(1/2) 
計畫編號：NSC 96-2221-E-019 -049 
 執行期限：96 年 08 月 01 日至 97 年 07 月 31 日 
主持人：陸臺根  國立台灣海洋大學電機工程學系  助理教授 
計畫參與人員：張文奇、黃國欣、許立翰、張原賓  研究生
摘要 
近年來，電業解構，民營化、自由化的趨勢已
在全球各地如火如荼地進行。要隨時隨地因應市場
的變化，開發適宜的電力商品，勢必須對用戶用電
行為有所認知，並建立適合的典型負載型態作為研
擬方案的基礎。用戶負載型態分析可產生各行各業
用戶的代表型態。本文使用小波轉換分析用戶負載
資料，以分析其趨勢及變動性：接著使用叢集技術
進行負載曲線及用戶分類。 
本文除對序列叢集所需的前置處理及各種叢集
方法加以比較說明，並使用訊號分析方法 ACF 與
CCF 函數分析序列，以及說明小波解析應用於負載
序列分析的特性及進行叢集的效果。根據模擬結
果，建立一基於 ACF 函數與 CCF 函數分析的快速
分類演算流程。本文的演算流程可應用於實際資料
的分析上作為負載型態分類之參考，進而產生有代
表性的負載序列。 
 
關鍵詞：  
Abstract 
In recent years, the electrical industries are 
deregulated, the trend of privatization and 
liberalization like a raging fire has carried on in 
global. The suitable electric power commodity is 
developed according to the market change anytime 
and anywhere to the user. Planner must have 
cognition of the behavior of the load, and establish 
suitable typical load pattern for program planning as 
the foundation. The load pattern analysis may 
produce all representative pattern of the various 
trades and occupations. This thesis uses the wavelet 
transform to analyze user’s load curve, to analyze its 
tendency and the mobility, then uses clustering 
technology to carry on the load curve and the user 
classification. 
This thesis shows and compares pre-process and 
each kind of clustering method which the pattern 
clustering needs. The signal analysis method ACF and 
CCF function are used to analyze the load pattern, as 
well as shows the characteristic and the clustering affect 
when wavelet analysis is applied in the load pattern 
analysis. According to the above results, establishes one 
fast classified algorithm based on the ACF function and 
the CCF function analysis. This algorithm may be 
applied in the actual material as the reference of the 
load pattern classification, to produce the representative 
load sequence. 
一、 緒論 
1.1 研究動機與目的 
電力公司常依據不同季節、不同時段、不同行業
的負載型態來制定電價結構。譬如，台電公司依據夏
日、非夏日訂定季節電價，依據不同時段的負載型態
訂定三段式或二段式時間電價。同時，也依用電電壓
等級區分低壓、高壓和特高壓等不同費率結構。此外，
電力公司亦需根據負載型態來研擬各種不同的可停電
力方案，來協助系統進行經濟安全的運轉。 
近年來，電業解構、民營化、自由化的趨勢已在
全球各地如火如荼地進行。臺灣也在 84 年起不斷討論
臺灣電業民營化、自由化的腳步，目前最新版的電業
法已送行政院審核中，將開放電業競爭。其中配電業
和電力經銷商要如何擬定各種不同的費率結構商品供
消費者選擇是一項重要的工作[1]。要隨時隨地因應市
場的變化，開發適宜的電力商品，勢必須對用戶用電
行為有所認知，並建立適合的典型負載型態作為研擬
方案的基礎。 
 1
料採購，都需要負載預測結果作為分析的輸入參
數。負載預測根據預測時間長短，可分為短期負載
預測、中期負載預測和長期負載預測。而根據預測
區域範圍分類，可分為系統負載預測與區域負載預
測。由於負載預測準確率對電力系統的運轉擴建有
很大的影響，所以各國電力工業都相當重視負載預
測模式的修正以提高預測的準確性。尤其是面對未
來電力自由化的趨勢，用戶用電行為會因價格波動
而有所改變，此種改變將對傳統負載預測模式的準
確性帶來嚴重的挑戰。 
近年來，電力自由化的風潮襲捲了全球各國，
將獨占性的電業解構為發電業、輸電業、配電業和
電力行銷商，並讓彼此競爭以提高電業的效率、降
低成本，以及增加社會福利與鼓勵私人進行電業投
資。在一個完全競爭的市場機制下，電力商品的價
格會因供需狀況而有所變動，而使用者的用電行為
也會因價格的波動而有所變化。如此一來，因市場
價格而產生的負載變動將比傳統固定電價情形更難
以預測。同時配電公司會根據用戶喜好與需求提供
不同費率及組合的電力商品。在不同商品組合基礎
下，用戶的使用習慣會因其選擇的電力商品不同而
有所差異，並展現在實際的負載曲線上。配電公司
也可以藉由費率的調整改變用戶的用電行為。在此
狀態下，傳統負載預測方法的準確性將面臨更大的
挑戰。傳統區域負載預測的統計模式方法，在面對
電力自由化所帶來的用電隨機性，其預測的準確率
將會下降，甚至無法將預測模式應用於實際作業
中。雖然模擬法需要耗費大量運算資源，但其分析
負載成因的方式，對於這些變動可進行進一步的分
析與解釋，以建立一動態模式來進行預測。配電公
司也可利用這些預測資料來決定最佳的產品組合及
費率。 
在模擬法中，最終消費模型代表一個”由下而
上”的負載模型。最終消費模型使用客戶類別、每一
客戶類別的終端使用類別、每一終端使用類別用電
器具分類等多個層次的負載曲線對負載成因進行分
析，甚至可整合氣候敏感度分析於每一類別的負載
曲線中。多次分層的結果雖然耗費運算資源，但是
預測更加準確。因此，我們可以利用所收集的實際
用戶負載資料進行分類，找出各式各樣的用戶類別
及其代表的負載曲線。 
用戶類別對於配電系統規劃及電價費率結構都
是一項重要的因素。在電力自由化之前，電力公司
就已經將用戶類別作為費率設計之參考，對不同類
別的用戶收取不同的用電費率。例如，台電公司根
據契約容量及類型將用戶分為 9 個不同類別： 
1. 表燈非營業 
2. 表燈營業 
3. 低壓綜合非營業 
4. 低壓營業 
5. 低壓電力 
6. 高壓綜合非營業 
7. 高壓綜合營業 
8. 高壓電力 
9. 特高壓電力 
其中，類別 1~5 為低壓用戶，其餘為高壓用戶。類別
1 為住宅型態用戶，類別 2、3、4、6 為商業型態用戶，
類別 5、7、8、9 為工業型態用戶。而每個類別之下又
區分為不同的行業別。此種傳統的用戶分類方法，僅
單純地利用簡單的用戶屬性進行分類，如電壓、契約
容量等。並且利用這些分類資訊對不同類別用戶收取
不同的費率。如進一步深究，這些類別的用戶因用電
器具的不同、工作時間長短不同、所在區域不同等因
素，還可再細分為多個用戶類別。若能找出各類別的
代表性負載曲線，則不僅可做為非紀錄型電表用戶的
計價基準，亦可做為負載預測的基本建構單元。因此，
本文將著重在用戶負載型態的分類方法，期能建立一
快速分類的演算法則。 
2-2 負載型態分類所需考慮的因素 
由於資訊設備的進步及電力自由化的影響，對於
用戶的實際量測資訊越來越容易取得，如何有效利用
此資料是未來重要的議題。負載型態分類所需考慮的
因素包括：（1）取樣頻率的一致性，（2）資料遺失修
補，（3）資料減維、（4）負載序列時間平移、（5）負
載序列絕對值和（6）相似度判斷準則等。以下將分別
說明這些重要考慮因素。 
1. 取樣頻率的一致性 
由於負載序列因取樣時間及取樣頻率的不同，會
有不同的資料長度。原始資料必須經由前置處
理，才能做為叢集使用。叢集方法採用距離值計
算比較時，必須以同資料點數的序列進行計算才
有相同的比較基礎。 
2. 資料遺失修補 
負載資料收集時難免因各種因素造成序列資料的
遺失，此遺失值會影響距離值計算結果而造成分
類結果的錯誤，所以序列須進行資料修補。 
3. 資料減維 
經由實際量測的資料來進行負載型態分類時，由
於用戶數太多，且每一用戶的負載序列常達數萬
點，若要對每一對應時間都計算其距離值後再進
行相似度比較，將大量消耗計算機的運算時間而
不實用。故須分析電力用戶的負載特性，並利用
 3
3.搜集用戶的相關資料 
在進行相關負載型態的研究時，除了搜集電力
的使用量之外，對於用戶的屬性也要進行搜集，這
些屬性包括用戶的用電類別(工業、商業或住宅)、用
戶的契約容量、工業分類別等。 
4.發展樣本用戶的負載型態 
基於所搜集到的資料進行分析，研究用戶屬性
與電力使用量的關係。然後，發展出一個一般化用
戶負載型態，此負載型態代表相關用戶屬性的電力
使用方式。 
5.發展母體的負載型態 
最後，研究所有用戶的相關屬性，根據上一步
驟所分析的結果，決定每個用戶的代表性負載型
態。之後的相關研究，即可以此負載型態代表該用
戶的特性。對於無法量測或資料不足的用戶，也可
藉由搜尋過去的相關負載型態，代表該用戶進行研
究。 
由於本文的重點在於負載型態的分類，所以接
下來的理論描述將只專注於分類的方法。 
 
圖 3-2 分類流程圖 
完整的用戶序列分類流程如圖 3-2 所示，共分
為五個步驟，第一步驟為序列正規化做為小波轉換
之 前 置 處 理 。 第 二 步 驟 為 自 我 相 關 函 數
(Autocorrelation Function,ACF)鑑定，以 ACF 函數決
定序列之代表性週期值。當鑑定出顯著之週期時，
進行序列之切割，並且以切割序列的平均值序列作
為 代 表 序 列 。 第 三 步 驟 為 交 叉 相 關 函 數
(Cross-Correlation Function,CCF)鑑定，計算同週期兩
序列之位移相關性，決定計算距離值之位移期數。
第四步驟，當 ACF 函數鑑定沒有顯著之週期，以正
規化序列做為輸入，計算小波係數。第五步驟以階
層式演算法進行序列叢集，有顯著週期之序列以其
代表序列經 CCF 調整之距離值作為輸入，無顯著週
期之序列以計算序列間小波係數距離值作為輸入。 
3-3 ACF 函數 
ACF 為 BOX-JENKINS 模式中鑑定殘差隨機性
的函數。BOX-JENKINS 模式中，假設現在的結果受
到過去結果的影響，而 ACF 即為分析時間序列是否
擁有此特性的工具。 
假設我們有 等觀測值，其相隔 k 時期
之 ACF 為[34]： 
1 2, ,..., NY Y Y
 
( )( )
( )1 21
N k
i i ki
k N
ii
Y Y Y Y
Y Y
γ
−
+=
=
− −= −
∑
∑        (0.3) 
使用 ACF 主要的目的為鑑定時間序列的隨機性，當一
時間序列為非隨機性，則該數列有一個或多個自我相
關係數會顯著地不為零。假如此數列為隨機性，則該
數列的自我相關係數不論在任何時期皆會接近零。當
我們分析一個含有顯著週期性的訊號時，使用 ACF 函
數可以鑑定出此訊號的週期頻率。例如：當我們計算
y=sin(x)之 ACF 函數時，可以看出 ACF 函數表示出被
分析函數的週期為 2π，如圖 3-3 所示。當我們計算隨
機數值的 ACF 函數時，可以看出並沒有顯著的相關係
數值，如圖 3-4 所示。因此，我們可以利用 ACF 函數
的特性對訊號進行初步分析，來鑑定其是否含有週期
性特性，並且初步計算出其週期頻率，如圖 3-5 和 3-6
所示。 
 
圖 3-3 sin 函數之 ACF 函數 
 
 
圖 3-4 隨機序列之 ACF 函數 
 
圖 3-5 週期 7 序列之 ACF 函數 
 
 
圖 3-6 週期 24 序列之 ACF 函數 
 5
表 3-1 曲線 A 正規化後之值 
-0.75472 -0.63861 -0.63861 -0.75472
-0.87083 -0.87083 -0.75472 -0.63861
-0.63861 -0.63861 -0.5225 -0.40639
-0.29028 -0.17417 -0.058056 0.058056
0.17417 0.29028 0.40639 0.5225 
0.63861 1.1031 2.4964 2.9608 
 
表 3-2 曲線 B 正規化後之值 
-0.7749 -0.7749 -0.4428 -0.1107 
0.2214 1.8819   
 
3-6 小波理論 
小波解析為利用小波轉換將一序列資料切割成
許多不同頻率的子序列，對於每個子序列，可以使
用適合於該子序列的方法進行研究。小波解析對於
研究含有非連續性或波形尖突的序列上優於傳統傅
立葉轉換方法。 
 
小波轉換使用一符合某些數學條件的母函數來
擬合資料序列，這樣的概念與傅立葉轉換類似。不
同的是，傅立葉轉換使用 sin 與 cos 函數擬合資料序
列。小波轉換所使用的母函數不限於 sin 函數與 cos
函數，只要符合以下的數學條件即可。 
假設一函數 ( )tψ 為小波母函數，則 ( )tψ 擁有以下
特性[35]： 
1.     (0.6) ( ) 0t dtψ∞−∞ =∫
2.
2( )t dtψ∞−∞ < ∞∫     (0.7) 
 
若一函數 ( )f t 為 square integrable，其小波轉換
的定義如下式： ( , )W a b
dt
a
bt
a
tfbaW )(1)(),( −≡ ∗∞∞−∫ ψ  (0.8) 
小波解析應用於原始序列分析上可以進一步分析兩
序列間不同頻段的相似性，而得到不同頻段的相似
叢集，此叢集結果可作為後續資料探勘之輸入變
數，進行後續之分析。圖 3-12 列出數個常用的小波
母函數[35]。 
 
 
圖 3-12.a HAAR 母函數 
 
圖 3-12.b DB2 母函數 
 
圖 3-12.c Morlet 母函數 
 
圖 3-12.d Mexican Hat 母函數 
 
接下來，本文以表 3-1 的序列 A 和表 3-2 序列 B
為例說明小波轉換的應用。兩曲線欲進行相似度比較
時，需利用到小波解析運算縮減取樣(downsampling)
特性使兩條曲線在相同取樣率之下進行比較。 
在應用小波轉換之前，需先將序列之長度填補至 2 的
N 次方，N 為整數，以符合小波轉換的基本要求。如
曲線 A 含有 24 個元素，則須填補 8 個 0 至 32 個元素。 
我們採用 HAAR母函數和 db2 母函數來進行小波
轉換，俾能比較不同母函數間的差異。 
1. HAAR 母函數 
HAAR 母函數為[0.5 0.5]及[-0.5 0.5]。每次取出序
列中之二元素進行運算，運算後位移二元素繼續下一
運算，每一次的計算可以得到一近似係數 與一差值
係數 。近似係數代表二運算元素之近似值，差值係
數代表二元素之差異。即一含有 N 個元素之序列：
(
ia
id
0 ,......, nS S 1− )，其 HAAR 小波轉換係數為： 
 7
 
圖 3-13 HAAR 與 db2 母函數之近似係數 
 
 
圖 3-14 HAAR 與 db2 母函數之差值係數 
 
為了處理 db2 函數及其他小波母函數之邊緣問
題，首先假設該序列具有循環性的特性，並在序列
邊緣填補足夠的元素，將最前端的序列元素填補至
最後端，以及將最後端元素填補至最前端。現假設
序列 A 為循環性之序列，如圖 3-15，則將上方正規
化序列 A 之前後各填補 2 元素，使其成為如表 3-8
的序列，當進行小波轉換時，小波係數在此兩端會
有相同的係數值，捨棄其他多餘的小波係數，只擷
取 1 週期的小波係數(如表 3-9 所示)，以解決邊緣遺
失值問題。近似係數也依此方式處理可得到下一層
小波轉換之資料序列，重複以上步驟以計算出下一
層之小波係數。以此方式計算出的小波係數可去除
邊緣效應之影響。 
 
表 3-8 曲線 A 正規化後前端與後段各填補二元素 
2.4964 2.9608 -0.75472 -0.63861 
-0.63861 -0.75472 -0.87083 -0.87083 
-0.75472 -0.63861 -0.63861 -0.63861 
-0.5225 -0.40639 -0.29028 -0.17417 
-0.058056 0.058056 0.17417 0.29028 
0.40639 0.5225 0.63861 1.1031 
2.4964 2.9608 -0.75472 -0.63861 
 
圖 3-15 序列 A 循環序列 
 
表 3-9 序列 A 之第一層 db2 小波轉換差值係數與一週
期係數 
週期
擷取
前 
[-0.20111,-0.92604,0.050278,-0.039653,-0.01
0625,0.010625,-0.010625,0,0,0,0,-0.11896,0.
23222,-0.92604,0.17028,0] 
週期
擷取
後 
[0.050278,-0.039653,-0.010625,0.010625,-0.
010625,0,0,0,0,-0.11896,0.23222,-0.92604] 
 
3-7 叢集理論 
叢集的目的是將一大群資料分成多個類別，每一
個類別中的物件彼此相似度高，而不同類別間的物件
彼此相似度低。叢集問題在各種領域是非常常見的。
叢集的方法可分為分割式方法、階層式方法、密度式
方法、網格式方法、模式化方法。此五種方法為使用
資料的實際量測值進行叢集分類，選取資料集中數個
欲比較之屬性，進行量化分析以及相似度量測。相似
度量測需定義兩物件間之距離函數，或是描述相似程
度之相似函數，以此為基礎進行物件之分類；距離函
數越小或相似函數越大之兩物件代表其相似程度越
大。由於本文採用階層式叢集技術，所以本節後續說
明將著重於此。 
階層式叢集法使用樹狀結構表現叢集後的叢集結
果。階層式叢集的方法從叢集方向來分可分
為”Agglomerative”與”Divisive”兩種不同的類型。假設
我們有 N 個資料物件進行階層式叢集，Agglomerative
階層式方法含有 N 個初始叢集，每個叢集中有一個資
料物件，接著不斷的進行叢集結合，直到成為一含有
N 個資料物件的叢集為止。Division 方法的初始叢集
則含有 N 個資料物件，不斷進行分割，直至每個叢集
只包含一個資料物件為止。圖 3-16 為聚合式階層叢集
演算法之流程圖。 
 
( )2,x y i i
i
d x= −∑ y    (0.13) 
其中， ,x yd 為兩序列之距離值 
      ,i ix y 為序列 x 與序列 y 之第 i 個元素值 
 
 9
 0
1000
2000
3000
1 4 7 10 13 16 19 22 25 28 31 34 37 40 43 46 49 52 55 58 61 64 67 70 73
圖 4-1 序列 A 之圖形 
0
1000
2000
3000
1 4 7 10 13 16 19 22 25 28 31 34 37 40 43 46 49 52 55 58 61 64 67 70 73
圖 4-2 序列 B 之圖形 
 
圖 4-3 序列 A 之 ACF 函數 
 
圖 4-4 序列 B 之 ACF 函數 
序列 A 和序列 B 之 ACF 函數如圖 4-3 及圖 4-4
所示。在傳統時間序列分析中，ACF 係數是否顯著
的判斷原則是分析序列前後相關係數之大小，即某
期數之係數大於所有係數之兩倍標準差，則判斷其
係數為顯著。由圖 4-3 和圖 4-4 可看出週期 5 呈現顯
著的正相關，而週期 2 與週期 3 則呈現顯著的負相
關。代表此 2 序列之顯著週期為 5，而週期內有間隔
2 或 3 之短序列。由此可知 ACF 函數可用來判斷一
長序列是否有週期特性及其週期為何。而圖 4-5 則
是利用式(3-4)計算出兩序列之 CCF 函數，其圖形在
間隔時期 2 與間隔時期-3 有顯著係數，代表序列 A
右移間隔 2 或左移間隔 3 時，兩序列有顯著相關性。
另外，圖 4-6 為實際模擬一用電曲線，其 ACF 圖形如
圖 4-7 所示。由圖 4-7 可看出，在 24 及 48 等 24 倍數
之時期有顯著的係數，且在時期 168 之係數較所有 24
倍數之係數大，由此可判斷原序列之週期為 168。 
 
0
1000
2000
3000
4000
5000
1 34 67 100 133 166 199 232 265 298 331 364 397 430 463 496 529 562 595 628 661
圖 4-6 模擬實際用電曲線 
 
圖 4-5 序列 A 和 B 之 CCF 函數圖形 
 
圖 4-7 模擬序列之 ACF 函數 
 
4-2 CCF 係數設定選擇 
本文使用表 4-1 之五組測試序列，來計算兩兩序
列之交叉相關係數，其相關係數如表 4-2 所示。其中，
篩選出相關係數大於 0.8 者且為所有係數中最大值
者，代表其在該係數所對應之相隔期數擁有最大的相
關性。此例說明如何在序列位移時判斷其位移期數。
在進行後續序列距離運算時，將根據此位移期數調整
後再進行距離運算。譬如：由表 4-2 可知，在序列 1
和序列 3 的 CCF 函數值最大為 0.92，其對應位移期數
 11
 
圖 4-10 HAAR 小波係數， (b)差值係數 
 
(a) 
                               
(b) 
圖 4-11 db2 小波係數，近似係數(a)，差值係數(b) 
 
(a)  
             
(b) 
圖 4-12 db3 小波係數，近似係數(a)，差值係數(b) 
 
4-4 序列正規化 
序列正規化將使兩變化趨勢相似，但量差異大
的序列可歸於同一負載型態類別中。本文以序列 C
及 D 來說明序列如何進行正規化運算與正規化後之
結果。 
圖 4-13 表示兩序列 C、D，其值如下： 
序列 C 
[700,735,720,800,935,1000,1625,1675,1925,2000,200
0,1825,2050,1925,1825,1750,1550,1500,1600,1550,10
00,875,725,700] 
序列 D 
[500,525,525,500,475,475,500,525,525,525,550,575,6
00,625,650,675,700,725,750,775,800,900,1200,1300] 
 
0
500
1000
1500
2000
2500
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
序列A
序列B
 
圖 4-13 未進行正規化之原始序列 C、D 
 
由圖 4-13 可看出序列 C 和 D 的波形，實際值有
所不同但走勢卻非常相似。若使用原始序列直接進
行比較可能會造成錯誤的計算結果，為了解決此現
象，本文使用正規化的技巧解決此一問題，兩序列
進行正規化後之圖形如圖 4-14 所示。當兩序列之變
動行為相似但實際值有使用量之差別時，使用正規
化序列計算距離值可更正確表示兩序列之相似度。 
-2
-1
0
1
2
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
序列A
序列B
第一層 
 
第二層 
 
第三層 
第一層
 
第二層
 
第三層
第一層 
 
第二層 
 
第三層 
第一層 
 
第二層 
 
第三層 
第一層 
 
第二層 
 
第三層 
 13
數都擁有將原始序列分類的能力，但因為各階層的
解析度不同，在進行分類時，使用相同的門檻值設
定規則會有不同的分類結果。小波轉換可將原始序
列解析為不同解析度的多階層序列，當解析的階層
越高，則其解析度越低，反之解析階層越少，解析
度越高，但在進行距離值計算時，解析度越高則計
算時間越長。小波係數每階層皆有近似係數與差值
係數，近似係數可代表負載曲線的平滑曲線，而差
值係數則為其在平滑曲線上的變動。欲進行分類時
可計算出每一階層各叢集的小波係數型態序列，並
可將各階層的小波係數型態序列還原為一標準型
態序列。在此範例中，若將門檻值設定為標準差
*0.5，可成功將範例分成原始 5 個樣本叢集。其叢
集時間如表 4-6 所示。其中，小波叢集的時間包含
近似係數叢集與差值係數叢集，較直接叢集耗時，
但小波係數的叢集可將序列分為代表平滑特性的
近似係數叢集與代表變動特性的差值係數叢集。 
 
直接叢集與小 時間比較 
係數階層 1 至階層 3 叢集結果 
層 1： 
 
表 4-6 波係數叢集
叢集方法 叢集時間 
直接叢集 0.024478s 
小波階層 1 0.074499s 
小波階層 2 0.065613s 
小波階層 3 0.055689s 
1.使用近似
階
 
圖 4 42 
4-7 係數叢集結果 
集編號 
4 15 
 21 22 23 24 25 
階層 2： 
-18 階層 1 近似係數叢集 thd=1.10
表 階層 1 近似
叢 序列編號 
1 6 7 8 9 10 
2 11 12 13 1
3 1 2 3 4 5 
4 16 17 18 19 20 
5
 
 
圖 4
4 叢集結果 
集編號 
9 20 
 1 2 3 4 5 
階層 3： 
-19 階層 2 近似係數叢集 thd=0.9782 
表 -8 階層 2 近似係數
叢 序列編號 
1 6 7 8 9 10 
2 21 22 23 24 25 
3 11 12 13 14 15 
4 16 17 18 1
5
 
 
圖 4-20 階層 3 近似係數叢集 thd=0.8730 
4 叢集結果 
集編號 
4 25 
11 12 13 14 15 
 
 
 
 
表 -9 階層 3 近似係數
叢 序列編號 
1 6 7 8 9 10 
2 21 22 23 2
3 1 2 3 4 5 
4 16 17 18 19 20 
5 
 15
表 4-14 階 數叢集結果 thd=1.96 
集編號 
 16 17 18 19 20 
 1 2 3 4 5 
 
 階 數叢集結果 thd=1.75 
集編號 
4 25 
 18 19 20 
階層 3 差值係數叢集結果，如表 4-16
4-18 所示 
 
 階 數叢集結果 thd=1.00 
集編號  
 25 
 16 17 18 19 20 
 
 階 數叢集結果 thd=1.15 
集編號 
 18 19 20 
4 15 
 21 22 23 24 25 
 
 階 數叢集結果 thd=1.15 
集編號 
 18 19 20 
 1 2 3 4 5 21 22 23 24 25 
4-9 
，每條序列的資料點數為 8760 點，進行模擬比較。 
直接叢集結果，
共分成 14 個叢集如圖 4-28 所示。 
層 2 近似係
叢 序列編號 
1 21 22 23 24 25 
2 11 12 13 14 15 
3 6 7 8 9 10
4
表 4-15 層 3 近似係
叢 序列編號 
1 21 22 23 2
2 1 2 3 4 5 
3 6 7 8 9 10 16 17
4 11 12 13 14 15 
使用階層 1 至
至
表 4-16 層 1 差值係
叢 序列編號
1 1 2 3 4 5 
2 21 22 23 24
3 6 7 8 9 10 
4 11 12 13 14 15 
5
表 4-17 層 2 差值係
叢 序列編號 
1 6 7 8 9 10 16 17
2 11 12 13 1
3 1 2 3 4 5 
4
表 4-18 層 3 差值係
叢 序列編號 
1 6 7 8 9 10 16 17
2 11 12 13 14 15 
3
 
模擬序列叢集 
本節比較直接叢集與 ACF-CCF 序列叢集的結
果。所用的樣本序列為十組週期為一週之序列(如
圖 4-24 所示)、十組週期為一天(如圖 4-25 所示)之
序列、二組週期為八小時之序列(如圖 4-26 所示)。
每條序列皆加入隨機變化，加入隨機值變化的方
式，當平均值以上時隨機值為正，平均值以下時隨
機值為負值。每個序列加入隨機一至十條長度一至
七十二小時不等之遺失值序列，每條序列之遺失列
之發生時間為隨機序列點，當判定遺失值發生時即
將該段序列數值歸零。週期為一周及一日之樣本各
產生四十條序列，週期為八小時之樣本各產生五十
條序列，再加上 100 條完全隨機序列，共 1000 條序
列
 
使用不同的叢集方式進行叢集: 
1.直接叢集，設定門檻值為 32.9016，叢集所需時間
為 1026.4s，圖 4-27 為模擬序列分類
 
圖 4-27 模擬序列分類直接叢集結果 
2.經 ACF 切割，計算其平均值作為代表序列，並根
據 CCF 調整距離值再進行叢集。其叢集時間如表
4-19 所
序列 叢集時間 
 
 
 
序列叢集 
計 96.7749 
二組
4-30 所示，門檻值為距離值標準差
1.0505。
示。 
表 4-19 模擬 ACF-CCF
ACF 序列切割 42.9370s
週期 168 序列叢集 31.775s 
週期 24 序列叢集 20.812s 
週期 8 1.2509s 
總
 
序列叢集可分為三個週期，週期 8、週期 24 和週期
168，其中週期 8 之叢集如圖 4-29 所示，共有
叢集如圖
 17
0
500
1000
1500
2000
1 3 5 7 9 11 13 15 17 19 21 23
0
500
1000
1500
2000
1 3 5 7 9 11 13 15 17 19 21 23
 
(a)樣本序列 11 (b)樣本序列 12 
0
500
1000
1500
2000
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 
0
500
1000
1500
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 
(c)樣本序列 13 (d)樣本序列 14 
0
500
1000
1500
2000
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 
0
500
1000
1500
2000
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 
(e)樣本序列 15 (f)樣本序列 16 
0
500
1000
1500
2000
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 
0
500
1000
1500
2000
2500
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 
(g)樣本序列 17 (h)樣本序列 18 
0
200
400
600
800
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 
0
200
400
600
800
1000
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 
(i)樣本序列 19 (j)樣本序列 20 
圖 4-25 十組一日為週期之序列樣本 
0
500
1000
1500
2000
1 2 3 4 5 6 7 8
0
500
1000
1500
2000
1 2 3 4 5 6 7 8
(a)樣本序列 21 (b)樣本序列 22 
圖 4-26 二組八小時為週期之序列樣本
 19
 
圖 4-29 週期 8 叢集結果 
 
週期 24 的叢集結果如圖 4-31 所示，共有 4 組叢集，
如圖 4-32 所示，門檻值為距離值標準差 1.9466。 
 
圖 4-31 週期 24 叢集結果 
(a)週期 8 叢集 1 (b)週期 8 叢集 2 
圖 4-30 週期 8 之叢集 
  
(a)週期 24 叢集 1 (b)週期 24 叢集 2 
(c)週期 24 叢集 3 (d)週期 24 叢集 4 
 
圖 4-32 週期 24 叢集 
 21
=0.9733，則可以分成 9 個叢集(如圖 4-35 所示)， 叢集結果較明確。 
 
(a)週期 24 叢集 1 (b)週期 24 叢集 2 
©週期 24 叢集 3 (d)週期 24 叢集 4 
(e)週期 24 叢集 5 (f)週期 24 叢集 6 
(g)週期 24 叢集 7 (h)週期 24 叢集 8 
 
(i)週期 24 叢集 9  
圖 4-35 週期 24 叢集，門檻值為 1/2 距離值標準差 
 
五、結論與未來研究方向 
5-1 結論 
由於資訊設備的進步及電力自由化的影響，對
於用戶的實際量測資訊越來越容易取得，如何有效
利用此資料是未來重要的議題。由於負載序列因取
樣時間及取樣頻率的不同，而有不同的資料長度。
 23
manuf-9.pdf. 
[10] C. S. Chen, J. C. Hwang, and C. W. Wuang, 
"Application of Load Survey Systems to Proper 
Tariff disign," IEEE Transactions on Power 
Systems, vol. 12, pp. 1746-1751, 1997. 
[11] H.-C. Cuo and Y.-Y. HSU, "Distribution System 
Load Estimation And Service Restoration Using 
a Fuzzy Set Approach," IEEE Transactions on 
Power Delivery, vol. 8, pp. 1950-1957, 1993. 
[12] G. Chicco, R. Napoli, and F. Piglione, "Load 
Pattern Clustering for Short-Term Load 
Forecasting of Anomalous Days," in IEEE Porto 
Power Tech Conference, 2001. 
[13] M.Y.Cho and Y.W.Chen, "Fixed/switched Type 
Shunt Capacitor Planning of Distribution 
Systems by Considering Customer Load Patterns 
and Simplified Feeder Model," IEE Proceeding 
Cenference Transmission and Distribution, vol. 
144, pp. 533-540, 1997. 
[14] S.-S. Lee, J.-K. Park, S.-I. Moon, and Y.-T. Yoon, 
"Northeast Asia Interconnection, and Power Flow 
Considering Seasonal Load Patterns," IEEE 
Power Engineering Society General Meeting, pp. 
2904-2909, 2005. 
[15] J.-Y. Boivin and Y. Anguill, "Efficiency Home 
Automation For the Future," 
http://tdworld.com/mag/power_efficiency_home
_automation/index.html, 1996. 
[16] Y.-L. Ke, "Distribution Feeder Reconfiguration 
for Load Balancing and Service Restoration by 
Using G-Nets Inference Mechanism," IEEE 
TRANSACTIONS ON POWER DELIVERY, vol. 
19, pp. 1426-1433, 2004. 
[17] C.-H. Lin, C.-S. Chen, H.-J. Chuang, and C.-Y. 
Ho, "Heuristic Rule-Based Phase Balancing of 
Distribution Systems by Considering Customer 
Load Patterns," IEEE Transactions on Power 
Systems, vol. 20, pp. 709-716, 2005. 
[18] R. Lamedica, L. Santolamazza, G. Fracassi, G. 
Martinelli, and A. Prudenzi, "A Novel 
Methodology Based on Clustering Techniques 
for Automatic Processing of MV Feeder Daily 
Load Patterns," IEEE Power Engineering Society 
Summer Meeting, pp. 96-101, 2000. 
[19] B. D. Pitt and D. S. Kirschen, "Application of 
Data Mining Techniques to Load Profiling," in 
Proc. 21st IEEE Int. Conf. Power Ind. Comput. ,  
pp. 131-136, 1999. 
[20] V. Figueiredo, F. Rodrigues, Z. Vale, and J. B. 
Gouveia, "An Electric Energy Consumer 
Characterization Framework Based on Data 
Mining Techniques," IEEE Transactions on Power 
Systems, vol. 20, pp. 596-602, 2005. 
[21] D. Gerbec, S. Gašperič, I. Šmon, and F. Gubina, 
"Allocation of the Load Profiles to Consumers 
Using Probabilistic Neural Networks," IEEE 
Transactions on Power Systems, vol. 20, pp. 
548-555, 2005. 
[22] A. Cagni, E. Carpaneto, G. Chicco, and R. Napoli, 
"Characterisation of the Aggregated Load Patterns 
for Extra-Urban Residential Customer Groups," in 
IEEE MELECON, pp. 951-954, 2004. 
[23] H. Liao and D. Niebur, "Load Profile Estimation 
in Electric Transmission Networks Using 
Independent Component Analysis," IEEE 
Transactions on Power Systems, vol. 18, pp. 
707-715, 2003. 
[24] D. Gerbec, S. Gašperič, I. Šmon, and F.Gubina, 
"An Approach to Customers Daily Load Profile 
Determination," in Proc. IEEE Power Eng. Soc. 
Summer Meeting, pp. 587-591, 2002. 
[25] "ELECTRICITY TARIFF RESTRUCTURING," 
National Energy Policy Office, 2001. 
[26] J. Han and M. Kamber, Data Mining Concepts 
and Techniques: Morgan Kanufmann. 
[27] S. L. Lauritzen, "The EM Algorithm for Graphical 
Association Models With Missing Data," 
Computational Statistics and Data Analysis, vol. 
19, pp. 191-201, 1995. 
[28] M. Ester, H.-P. Kriegel, J. Sander, and X. Xu, "A 
Density-Based Algorithm for Discovering Clusters 
in Large Spatial Databases with Noise," Published 
in Proceedings of 2nd International Conference on 
Knowledge Discovery and Data Mining 
(KDD-96). 
[29] M. Ankerst, M. Breunig, H.-P. Kriegel, and J. 
Sander, "OPTIC:Ordering points to identify the 
clustering structure," in ACM-SIGMD Int. Conf. 
Management of Data, pp. 49-60, 1999. 
[30] J. Y. Wei Wang, Richard Muntz, "STING: A 
Statistical Information Grid Approach to Spatial 
Data MINING," Proceedings of 1997 
 25
