  
一、摘要 
 
ABSTRACT 
     (This is the paper we are preparing for PRL) 
The nano-area electron diffraction (NED) regime of TEM allows us to obtain an oversampled 
diffraction pattern from individual erroded faceted-MgO nano-particle, which is sufficient for 
determination of the exit surface wave function at atomic resolution as well as sample shape 
function. There has been a argument of lack of uniqueness in solution from the electron 
diffractive imaging. In order to improve the uniqueness of solution an averaging of many 
estimations was adopted and we used iterative algorithms with shrink-wrap and guiding-HIO 
methods. The standard deviation map of retrieved exit wave can be used as the uniqueness 
criterion in coherent scattering imaging technique. The standard deviaion map give us the 
confidence level in quantitatively analyzing atomic structure of defect from the retrieved exit 
wave. 
 
 
中文摘要： 
  (This is the paper we are preparing for PRL) 
 
利用透射電鏡可使我們能夠從單顆侵蝕面氧化鎂納米粒子獲得超衍射強度，這
是足夠使我們利用繞射影像演算法求得在原子分辨率下的出口波函數以及採樣形狀
函數。 電子衍射成像一直有缺乏獨特解的說法。我們通過使用迭代算法平均每場
的許多估計解並利用引導-HIO 方法改善的沒有獨特解的電子衍射成像。由我們方
法得到標準偏差影像可作為出口波函數唯一解標準。該標準偏差影像給我們從回復
的出口波定量分析缺陷的原子結構的信心水平。 
 
 
關鍵字： 
  
   電子繞射影像、引導-HIO 方法、標準偏差影像、氧化鎂納米粒子。 
  
in the real space. For nano-crystalline containing multiple domains, electron diffraction pattern 
reflects the superposition of all domains orientations. The relative positions of domains are 
encoded in interference pattern between corresponding Bragg reflections from different domains. 
The missing of this information leads to many identical reconstruction results that have different 
relative positions of the domains and differ only by their phases in reciprocal space. This problem 
is avoided for noncrystalline sample or for nanoparticle with one crystalline domain. Therefore, 
the imaging of individual nanoparticle from single electron diffraction pattern at atomic 
resolution seems to be attractive in this respect. 
In this paper, we perform an experimental study of the phase recovery by inverting of 
electron diffraction patterns from a nano-MgO single crystalline particle. Low resolution image 
of the shape function were retrieved from the oversampled intensity pattern around one Bragg 
peak.  Information about shape was used to carry out exit surface wave function at atomic 
resolution. We explore the issues of uniqueness of solution by estimating cross-correlation of the 
different estimates initiated by different random phases. For this purpose, based on translation-
invariant error metric [23], measure of reproducibility of solutions can be used [24]. Since, 
dynamical scattering of electrons within relatively thin sample cannot be ignored, complex-
valued exit surface wave function must be considered [8, 25]. Recovering of the complex objects 
requires sufficiently tight and accurate support [26]. Due to the distortions of objective lens and 
low contrast, practical determination of tight support from TEM image is problematic (We need 
to discuss the “wording” of this sentence) (I think the lens aberration causes the delocalization of 
the images, such that accurate support at atomic resolution is difficult to determination. I will 
give your the reference.). Therefore, support was dynamically improved during reconstruction 
procedure of the shape from one diffuse peak [13, 27-29]. The estimation of the new support was 
determined by thresholding operation. However, it was found that atomic resolution phase 
recovery with dynamic support often stagnates and leads to the uncorrelated results. Therefore, 
recovered low resolution shape function was used as a priory knowledge for the phase retrieval at 
atomic resolution. To obtain unique and reproducible result we used proposed method [30] which 
is based on the averaging of many estimates when algorithm enters a steady state regime.  
 
Reconstruction procedure 
 
Algorithm 
In TEM the incident electron wave illuminating the sample interacts with electrostatic 
field generated by the Coulomb potential of the sample. In general, as the incident wave 
propagates through the sample, both the phase and amplitude are modified diverising the 
complex-valued wave  at the exit surface of the object (  is the two-dimensional position 
vector in the exit surface plane). Diffracted wave  in the back focal plane (BFP) of the 
objective lens can be expressed by the Fourier transform of the exit wave-function. Spherical 
aberration and defocus of the objective lens change only the phase of the wave function at the 
BFP. Hence the recorded diffraction pattern is not affected by the lens aberraction functions and 
is given by 
  (2) 
where  is the component of the reciprocal vector and  represents Fourier transform. For 
weakly scattering thin sample, the kinematical approximation is satisfied and far-field diffraction 
pattern is proportional to the square of magnitude of the Fourier transform of Coulomb potential 
[9]. However, multiple and dynamical scattering of electrons inside the sample complicates 
relation between exit wave function and potential. Here we aim to recover the complex exit wave 
function  from the diffraction intensity  only. The phase component of  cannot 
be directly obtained, therefore an indirect phase recovery methods are required for the exit wave 
function determination. Gerchberg and Saxton in 1972 proposed first phase recovery algorithm, 
which requires diffraction intensity and the real space image of the sample [11]. Modified by 
Fienup [12] iterative hybrid input-output (HIO) method, instead of image utilizes the boundary of 
the sample or support constraint. The phase recovery in this work was initiated with advanced 
difference map (DM) algorithm [14, 31] since it works well with the complex-valued objects [30, 
  
function. In the charge-flipping (CF) [28] algorithm dynamic support is defined by threshold 
value , while in [29] by the number of nonzero pixels in the image. It has been shown that 
combination of CF and HIO greatly improved performance [27]. The advantage of algorithms 
with dynamical support is the fact that phase recovery procedure does not require a prior 
knowledge of the support. The combination of HIO and dynamic support requires only two input 
numbers, feedback parameter  and threshold value . In this work we applied thresholding 
operation that sets wave function to zero if its modulus is below the given value . It can be 
written in terms of projections as 
  (8) 
It should be noted that tightening of support by thresholding operation can be applied for high-
contract specimen that have sharp edges, such as crystalline nanoparticles. It was reported [25] 
that the phase recovery with dynamic support from simulated electron diffraction pattern of small 
Au nanoclusters leads to a much faster convergence. However, convergence could be unstable 
with specimen having soft edges [22]. Correctly determined threshold value gives accurate tight 
support . Generally, feedback  the threshold  could be used as parameters for obtaining 
optimal and unique solution. These two parameters were varied to define their range for which 
algorithm converges. Convergence was monitored using DM error given by Eq. (7) and by 
measure of reproducibility of solution as described below . The values of threshold were chosen 
as a fraction of modulus of autocorrelation function. In this work we applied dynamic value of 
 was constant during each iteration. However, it can be adjusted using guessed fraction of 
pixels with value above  [27]. Here we used thresholding operation at each iteration using Eq. 
8 to recover shape function from intensity around one Bragg peak. In the case of phase recovery 
at atomic resolution thresholding only does not give successful and unique solution.  Initiated by 
random phases reconstructions often stagnate and lead to the uncorrelated results . However, 
retrievals initiated by the constant phases are always successful and correlate with each other. 
Therefore, exact support is required to obtain optimal solution at atomic resolution. For this 
purpose we used appropriately scaled support, determined from recovered low resolution shape 
of the nanoparticle. 
 
Uniqueness 
Basically, question of uniqueness in diffraction microscopy is follows: is there more than 
one phase function that gives another image  with the same diffraction intensity distribution? 
Therefore, condition of uniqueness of obtained image requires that no other image exists which 
can be recovered from the same diffraction intensity. It was shown that an image having compact 
support can be determined uniquely from its continuous diffraction intensity if dimension of the 
image two at least two [34, 35] and sampling rate of intensity is equal or higher than the Nyquist 
frequency [36]. Actually, for the given intensity in Fourier space  there are trivial 
ambiguous solutions for any real-space function . First, a constant phase shift  
gives the same intensity. Second, referred as “twin images”, is  and third is related to 
the shift in real space . Therefore constant phase shift and change in orientation and 
position of the object in real space cannot be determined by CDI. 
 Generally, if solutions are only within these three ambiguous solutions one may say that 
solution is unique [37]. It has been shown that there is no guaranty for unique solution in the case 
of inversion of one-dimensional function but in two or more dimensions multiplicity of solutions 
is “pathologically rare” [35].  
The practical way to test uniqueness of solution based on the idea [37] that if multiple 
solutions exist, than many reconstruction attempts tend to find all of them. These reconstructions 
must be initiated by the different sets of random phases. To measure agreement between two 
  
crystal [46]. Interference fringe patterns or flares of intensity, with the maximum distribution 
perpendicular to the {100} faces of the nano-particle are clearly observed.   Sampling in 
reciprocal space  was calibrated using [100] diffraction intensity of silicon thin film. For the 
camera length of 200 cm the size of one pixel is 0.0005 Å-1. Corresponding field of view is 200 
nm defined as . Therefore, image pixel size is 15.62 Å, obtained by , where  
pixels. For all diffraction pattern with  pixels the corresponding resolution is 0.97 Å. 
In the case of camera length of 100 cm calibration procedure gives pixel size of 0.001 Å-1. 
Corresponding resolution for  is 0.97 Å. 
 Secondly, for the nanoparticles supported on a thin amorphous carbon film, which is 
usually used in an electron microscopy, scattering from the substrate itself makes contribution to 
the total diffraction pattern. During long exposure time, required to collect signal from relatively 
small sample, this contribution is significant and cannot be directly subtracted. >>>>> 
 
Diffractive imaging technique is strongly correlated with the coherence properties of the 
incident illumination. The spatial or transverse degree of coherence in TEM depends on the size 
of the condenser aperture. The condenser aperture of 10 μm in diameter defines the illumination 
semi-angle  of the incident beam at about 0.05 mrad [9, 40]. The distance over which the 
illumination is spatially coherent is 8 nm, calculated as  [42], where  is the de 
Broglie wavelength of the electron. At an acceleration voltage of 200 keV, the relativistic 
wavelength is 0.00251 nm. The incoherence width determines the distance above which the 
illumination is completely incoherent and can be defined as  [42]. For the semi-angle 
of 0.05 mrad  is 50 nm. The illumination in the specimen plane over distances between  
and  is partially coherent. On the other hand, the strong Fresnel fringes over the beam cross-
section (see Fig. 1(a) due to the scattering from the edge of condenser aperture can be produced if 
the beam is sufficiently coherent. The transverse coherence width in the condenser aperture plane 
is approximately equal to the distance over which Fresnel fringes are observed [42, 43]. The 
transverse coherence widths in the condenser aperture and specimen plane are related by the 
demagnification of the condenser system [44]. The estimation taken from the image of electron 
probe gives about 55 nm. The spatial coherence condition for diffractive imaging is , 
where  is the lateral dimension of the object [45]. Hence, the size of the MgO smoke cube 
satisfies this condition. The temporal coherence length  can be estimated from the relation 
between energy of the electron beam  and the energy spread  as . The 
 of FEG is about 1 eV and relative energy spread . Therefore,  is 
significantly larger than the sample thickness and condition of the temporal coherence is satisfied 
  
result is also examined. As the first step in this work, the phase retrieval was applied to recover 
the low-resolution shape function from diffraction pattern near (200) Bragg peak (Fig. 2). The 
centered at the origin area with the size of 128 by 128 pixels was selected. The phase recovery 
procedure was performed using dynamic support as described above. In order to obtain the 
unique solution we used the averaging method during the iteration of HIO procedure. modulus of 
the recovered shape determined by averaging of 50 Fourier estimates  taken in a single run 
after 200th iteration. The distance between each average was 50 iterations. 
Figure 3(a) shows modulus of the recovered shape determined by averaging of 50 Fourier 
estimates  taken in a single run after 200th iteration. The distance between each average 
was 50 iterations. Insets (b, c) in Fig. 3 are enlarged images of the modulus and phase of the 
shape function. Instead of the phase distribution the modulus of shape is not uniform within the 
central area of the nano-particle. The possible reason is the effects of the non-parallel 
illumination incident on the sample. To eliminate this effect, the beam subtracting procedure was 
adopted at the each iteration [49]. Parameters of the beam, such as Gaussian amplitude 
distribution and wave front phase curvature were determined from additional measurement. For 
this purpose, the NED experiment was performed using another almost perfect MgO cube 
immediately after preparation. Obtained experimental intensity patterns were fitted assuming 
perfect cubic shape of the sample and converged incident wave function. Finally, determined 
parameters of the incident beam were used for the phase recovery presented here. Figure 3(d) 
shows modulus of the recovered shape function unaffected by the incident illumination. The 
contract decay at the edges of the nano-particle corresponds to the thickness variations of faceted 
MgO. Figure 3(e) shows tight support of the recovered shape function. >>>>>> 
For precise determination of the threshold  and feedback  the convergence map 
(Fig. 4) was calculated using Eq. 4. The averaging of error  was performed with   
and varying  and  from 0.35% to 1.35% and 0.1 to 2.5, respectively. In this example the 
DM algorithm was reduced to HIO.  
It was found that  of the order of 0.2 or less indicates converged and reproducible 
solution. The region of convergence has a narrow range of both parameters. The range of  
where convergence is successful is between 1.7 and 2, whereas range of threshold is 
. Precise values of parameters where error is minimal can be determined by 
finding global minimum of convergence map which is about 0.18 for  and . 
Inset in Fig. 4 shows the DM error calculated for 30 runs initiated by the different random phases 
when optimal values of  and  were used. Sharp drop of the error and further small 
fluctuations around its mean value in steady-state regime indicates convergence. In contrast of 
  
by a factor 5 to 50 and corresponds to inelastic scattering events such as excitation of collective 
electron oscillations (plasmons), excitation of electrons from the inner-shells of atoms and 
excitation of lattice vibrations (phonons) [36, 48]. Figure 5(a) shows the real part of the recovered 
exit wave function, which corresponds to the distribution of electrostatic part of potential. 
However, recovered exit wave from the diffraction pattern without central beam does not include 
the mean inner potential. Figure 5(d) shows cross section plot of the real and imaginary part of 
the exit wave, which was recovered with initial zero phase, integrated along the rectangular 
selection in (a). The ratio between imaginary and real part is about 10%. Enlarged image of the 
edge of nano-particle (see Fig. 5(b) shows lattice fringes with resolved interatomic distances of 
MgO equal to 0.21 nm. High resolution TEM image of the sample prepared under similar 
condition (see Fig 5(c) shows characteristic structure of the sample and is in the agreement with 
the recovered exit wave by diffractive imaging technique. 
Similarly as for shape recovery, the convergence of phase recovery was monitored by the 
DM error metric and error based on the correlation of different solutions. Since support was fixed, 
only one parameter  must be defined. To determine feedback  the reconstruction 
procedure was performed 10 times with different initial random phases. Figure 4S in the 
Supplementary Information shows the averaged error  calculated using equation 4. Ten 
different solutions were compared with each other after 200 iterations of DM. Minimum of the 
error at  corresponds to the optimal feedback parameter. Inset shows DM error 
metrics of 10 different runs at  as a function of iterations. In order to determine the 
unique solution 15 estimates were averaged. Each estimate was taken after 10 iterations in the 
steady-state regime of the reconstruction procedure. The steady-state regime starts approximately 
before 50th iteration when algorithm tends to converge to a stable solution.  
In summary, the unique solution at atomic resolution can be obtained if tight support can 
be deduces. Support can be estimated from either a high contrast TEM image or by determination 
of the optimal threshold value used for dynamical improvement of the support during 
reconstruction procedure. The sufficiently tight support from TEM image may not be feasible due 
to the delocalization of the sample boundary caused by the lens aberration. Therefore dynamical 
support was adopted to determine the shape from the intensity around one Bragg peak. The 
known tight shape function of the nano-particle allows obtaining the exit wave at atomic 
resolution. The uniqueness and reproducibility of the solution were checked for the range of 
parameters  and . The optimal values of parameters were determined by calculating the 
convergence map using cross-correlations between solutions. The final unique solution was 
obtained by averaging of several estimates. We believe that the described methodology of the 
phase recovery can be utilized with different radiation and could become a powerful tool for an 
automatic diffraction microscope with the computational lenses. 
  
[48] J. Cowley, Diffraction physics (Elsevir Science Publishers B.V., New York, 1981). 
[49] H. M. Quiney, K. A. Nugent, and A. G. Peele, Opt. Lett. 30, 1638 (2005). 
 
  
 
FIG. 1 
 
FIG. 2 
 
附件二 
 
  
 
FIG. 5 
References 
 
[1] J. Miao et al., Nature 400, 342 (1999). 
[2] I. K. Robinson et al., Physical Review Letters 87, 195505 (2001). 
[3] J. Miao et al., Proceedings of the National Academy of Sciences of the United States of 
America 100, 110 (2003). 
[4] D. Shapiro et al., Proceedings of the National Academy of Sciences of the United States of 
America 102, 15343 (2005). 
[5] M. A. Pfeifer et al., Nature 442, 63 (2006). 
[6] H. N. Chapman et al., Nat Phys 2, 839 (2006). 
[7] C. Song et al., Physical Review Letters 100, 025504 (2008). 
[8] U. Weierstall et al., Ultramicroscopy 90, 171 (2002). 
[9] J. M. Zuo et al., Science 300, 1419 (2003). 
[10] D. Sayre, Acta Crystallographica 5, 843 (1952). 
[11] R. W. Gerchberg, and W. O. Saxton, Optik 35, 237 (1972). 
[12] J. R. Fienup, Appl. Opt. 21, 2758 (1982). 
[13] S. Marchesini et al., Physical Review B 68, 140101 (2003). 
出國學術研究心得報告 
                                                             
計畫編號 NSC 96-2221-E-007-018 
計畫名稱 三維原子分辨率繞射 Tomography 理論與技術之研究發展(3/3) 
出國人員姓名 
服務機關及職稱 
 陳福榮 
國立清華大學工程與系統科學系 教授 
時間地點 
97 年 4 月 23 日至 97 年 5 月 3 日  
美國柏克萊國家實驗室 
 
    本人於 4 月 23 日搭乘長榮航空班機於下午 3 點多抵達舊金山機場，Dr. Roar Kilaas
專程至機場接機後載送我至旅館休息。 
第二天(4 月 24 日)一大早，Dr. Roar Kilaas 來接我至柏克萊國家實驗室(Lawrence 
Berkeley National Laboratory)與 Prof. Christian kisielowski 討論，在這短短訪問期間，我
們應做那些研究，並且是能延續以往的研究；在這過程中 Prof. Christian kisielowski 希
望能延續以往 CS Corrected 電子顯微鏡的合作研究。基上討論出四個題目，原則上美
國柏克萊國家實驗室已安裝高階的球面相差校正器，Prof. Christian kisielowski 也顯示
他們取得的數張一流影像，這些影像的解釋必需要有新理論來配合，基本上我必須發
展這些理論。 
有四個理論是我們要發展的: 
1.非線性出口波的重構 
2.彈性動力學散射的回復，彈性動力學散射的回復有兩種方式：這部份將與比利時
Prof. Dr. Dirk Van Dyck 及 Ms. Amy Wang 合作。 
3.由於球面相差修正完之後，出射波基本上仍無法定量，那是因為試片的變形，使
得每一束的聚焦都不一樣，都必需發展理論和方法來修正欠焦的變化，我們叫
做欠焦的相位板。 
4.3d 結構恢復理論 
結束之後，與以前實驗室的學生謝文國博士一起用午餐，談論他未來的去留，下
午與 Dr. Roar Kilaas 開始進行程式的發展；接連幾天都和 Dr. Roar Kilaas 密切合作的進
行實質理論與程式發展研究 
自民國九十七年四月二十三日出國至民國九十七年五月三日返國，前後共計十一
日。基本上寫了四個初步程式:來解決如何解釋由先進電子顯微鏡球面相差做出的影像
