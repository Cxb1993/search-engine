for yielding better current control and reduced 
torque ripple and vibration, etc. 
This three-year project is devoted to develop the 
performance enhancement technologies and to explore 
the applications of PMSM. Three major topics lie in: 
(i) First year: Development of a condensing plant 
including a position sensorless sine-wave PMSM driven 
compressor, a position sensorless square-wave PMSM 
driven and a common switch-mode rectifier (SMR) 
front-end. The digital controls of all power stages 
are realized in a common DSP. The developed sine-wave 
sensorless control methods include high-frequency 
injection, extended back-EMF and hybrid methods. 
Moreover, some key issues for enhancing the 
performance of a PMSM drive are also studied. These 
issues include robust current controlled PWM, 
commutation shift, field excitation tuning, and DC-
link voltage boosting control, etc.； (ii) Second 
year: Development of PMSM/PMSG drive with front-end 
DC-DC converter for flywheel systems； and (iii) 
Third year: Development of PMSM drive with front-end 
DC-DC converter for EV having the integrated 
functions of driving, charging (grid-to-vehicle, G2V) 
and discharging (Vehicle-to-home, V2H) with 
uninterruptible power source output. The operation 
performance of the position sensorless EV PMSM drive 
is also explored experimentally. 
 
英文關鍵詞： PMSM, BDCM, current control, speed control, robust 
control, DSP, position sensorless control, high-
frequency injection, extended back-EMF, hybrid 
method, commutation instant tuning, excitation 
tuning, tuning, DC-link voltage boosting, DC/DC 
front-end converter, switch mode rectifier, PFC, 
application exploration, condensing plant, fan, EV, 
energy storage system, flywheel, battery, G2V 
charging, V2H discharging, micro-grid. 
 
 
 
1
永磁同步電動機驅動系統之關鍵調控技術及應用研究(3/3) 
(Key tuning control technology and application studies for permanent-magnet  
synchronous motor drive (3/3)) 
計畫編號： 99-2221-E-007-124-MY3 
執行期限：99年08月01日至102年07月31日 
(第一年至第三年：99年08月01日 至 102年07月31日) 
主持人： 廖聰明 教授   國立清華大學電機系 
計畫參與人員：黃俊豪、林泓鑫、周科甫、胡凱維、林柏辰、陳正岳、葉名哲、 
        林育賢、曾嘉宏、王榮崎、易沛勳、葉子豪、傅泰龍等
摘 要 
永磁同步馬達(Permanent magnet synchronous motor, PMSM)
具有許多優點而已廣泛被採用，但為得良好之負載驅動特性，
必須適當考量一些課題，如：馬達型態選擇、各組成部件之適
當設計、系統組成元件間之適當匹配、關鍵參數之適宜調整
等。此外亦須同時兼顧節能效益。PMSM 驅動系統之關鍵事務
含換相調控、激磁與弱磁調控、直流鏈增壓、切換調制技術以
得較佳電流控制並降低轉矩漣波與振動等。 
本三年期計畫旨在從事PMSM之關鍵調控技術開發及應用
研究。包括：(i)第一年：開發一冷凍系統，含一無位置感測弦
波 PMSM 驅動壓縮機、一無位置感測方波 PMSM 驅動風扇及
一共用切換式整流器前級。所有電力電路之數位控制以一共同
DSP 為之。其中，所開發之壓縮機弦波 PMSM 驅動系統之無
位置感測，包括高頻注入法、延伸型反電動勢法、及結合兩者
之混合控制機構。並從事 PMSM 驅動系統之效能增進關鍵事
務研習，如強健電流控制 PWM、換相調控、激磁調控、及直
流鏈升壓控制等；(ii)第二年：開發一具 DC/DC 前端轉換器之
永磁同步馬達/永磁同步發電機，以做為整合式啟動馬達/發電
機和飛輪系統，計畫中將以飛輪系統為主要控制對象；及(iii)
第三年：開發一配有 DC/DC 轉換器前級之電動車用 PMSM 驅
動系統，具馬達驅動、充電(G2V)及放電(V2H,不斷電系統輸出)
整合性功能，無位置感測 EV PMSM 驅動系統之操控性能亦與
以探究。 
關鍵詞：永磁同步馬達、直流無刷馬達、電流控制、速度控制、
強健控制、DSP 控制、無位置感測控制、高頻注入法、延伸型
反電動勢法、混合控制法、換相調控、激磁調控、直流鏈升壓、
DC-DC 前級轉換器、切換式整流器、功率因數校正、冷凍系
統、風扇、電動車、儲能系統、飛輪、電池、G2V 充電、V2H
放電、不斷電系統、微電網。 
Abstract: Permanent-magnet synchronous motor (PMSM) 
possesses many merits and has been widely employed. However, 
to yield satisfactory load driving performance, the following 
issues should be properly considered: choice of right motor type, 
proper designs of constituted parts, proper match between system 
components, proper tuning for key variables. In addition, the 
energy saving must also be pursued simultaneously. The key 
issues of PMSM drive include commutation shift, field excitation 
and field weakening, DC-link voltage boosting, switching method 
for yielding better current control and reduced torque ripple and 
vibration, etc. 
This three-year project is devoted to develop the performance 
enhancement technologies and to explore the applications of 
PMSM. Three major topics lie in: (i) First year: Development of a 
condensing plant including a position sensorless sine-wave 
PMSM driven compressor, a position sensorless square-wave 
PMSM driven and a common switch-mode rectifier (SMR) 
front-end. The digital controls of all power stages are realized in a 
common DSP. The developed sine-wave sensorless control 
methods include high-frequency injection, extended back-EMF 
and hybrid methods. Moreover, some key issues for enhancing the 
performance of a PMSM drive are also studied. These issues 
include robust current controlled PWM, commutation shift, field 
excitation tuning, and DC-link voltage boosting control, etc.; (ii) 
Second year: Development of PMSM/PMSG drive with front-end 
DC-DC converter for flywheel systems; and (iii) Third year: 
Development of PMSM drive with front-end DC-DC converter 
for EV having the integrated functions of driving, charging 
(grid-to-vehicle, G2V) and discharging (Vehicle-to-home, V2H) 
with uninterruptible power source output. The operation 
performance of the position sensorless EV PMSM drive is also 
explored experimentally. 
Keywords: PMSM, BDCM, current control, speed control, robust 
control, DSP, position sensorless control, high-frequency injection, 
extended back-EMF, hybrid method, commutation instant tuning, 
excitation tuning, tuning, DC-link voltage boosting, DC/DC 
front-end converter, switch mode rectifier, PFC, application 
exploration, condensing plant, fan, EV, energy storage system, 
flywheel, battery, G2V charging, V2H discharging, micro-grid. 
 
1. 研究動機及目的 
相較於其他常用馬達，永磁同步馬達  (Permanent 
magnet synchronous motor, PMSM) [1-3]具有高功率密
度、高轉矩產生能力、高轉換效率等優勢。又由於馬達
設計、功率元件、電力電子技術、數位信號處理器(Digital 
signal processor, DSP)等之進展，使以 PMSM 建構之直流
無刷馬達(Brushless DC motor, BDCM)驅控性能逐漸精
進，因此近年來，PMSM 已逐步廣泛地應用於多種設備，
如空調機、家電設備、電梯、電動車輛、軍事設備、資
訊及電腦周邊設備、綠能系統發電機等。以家電設備及
空調機之應用為例，綜合比較齒隙轉矩、效率及損失、
成本等特性，內置磁石式同步馬達比感應馬達、同步磁
阻馬達、表面貼磁石式同步馬達等具有折衷最優之特
性。近來變頻壓縮機已漸採弦波電流驅動控制之永磁同
步馬達，以得較優之負載驅動性能及較低之運轉噪音。
更且亦已逐漸採行無位置感測控制。 
   然而有別於感應馬達，對於一 PMSM 驅動系統或直
流無刷馬達，並非將變頻器直接與馬達組接即可，欲獲
得較優之驅控效能，有賴於其特定實務之妥善處理，有
關事務有：(1)適當永磁同步馬達型式之選擇[2,3]，應依
位置伺服或速度驅動應用、速度範圍等選用適當型式之
PMSM；(2)馬達與變頻器及其 PWM 技術之搭配[1-3]；
(3)馬達等效電路及動態模式及其參數之估測[4,5]，馬達
參數可供驅動控制機構之分析與設計，以及從事無位置
感測控制；(4)以 DSP 為主之數位控制機構，需有得宜之
週邊及控制法則實現技巧；(5)電流、轉矩與速度控制
[6-13]，在[11,12]中提出完整之 PMSM 驅動系統之動態
控制設計策略；(6)換相時刻調整[14-19]，有關研究可參
閱[14,15]；(7)激磁調控與弱磁調控[20,21]；(8) 良好之
PWM 控制[22-26]；(9) 直流鏈紋波效應[23]；(10) 可升
壓控制之直流鏈 [27-30]； (11)前級轉換器及其控制
[22-26] ； (12) 具高入電電力品質之切換式整流器
(Switch-mode rectifier, SMR)前級[27-30]；(13)無位置感測控
制[31-39]，其中[38,39]係有關 EV 之應用研究；(14) 隨
機切換技術 PWM [40-43]，有關 PMSM 驅動系統之應用
研究可參考[43]；(15)應用推廣，如：(a)家用電器，如空
調機、冰箱、洗衣機等[44,45]；(b)EVs, HEVs 及軌道車
輛 [46-50]；(c)整合式啟動馬達/發電機系統(Integrated 
starter/generator) [51,52]； (d)反應輪與飛輪儲能系統
[53-55]；(e)風力發電機[56]；(16)以及馬達設計[57-59]。 
除此之外，近年來亦有一些研究係有關結合 EV 為移
動式儲能源之微電網[60-63] 操作控制，以從事電網對
EV (Grid-to-vehicle, G2V)之功率因數校正電池充電操
作、EV 對電網(Vehicle-to-grid, V2G)放電操作、EV 對家
庭(Vehicle- to-home, V2H)不斷電系統放電操作等。這些
操控均需構裝適當之雙向轉換器或充電器[64-74]，有些
甚至係整合式電路，利用馬達驅動系統固有之電力電子
組件構成之。 
  3
a
faf
IL
IL
1
22
1
2
1
8
32
sin
φφβ −+= − , 21
dq LLL
−=Δ          (2) 
換相前移具有等值弱磁之效應，以及可適度增進轉矩
產生能力。但實際上，隨工作情況變化，適當之換相前
移 β 角不同：有一些研究將換相移位角 β 角表成對轉速
之概略關係，於實際驅動控制中線上查表決定。然自動
之換相角調整始可得較佳之特性，尤其是在無轉子位置
感測控制下之 PMSM。 
B. 激磁調控及弱磁調控 
由(1)式觀之，對於 IPMSM 而言，因 dq LL ≠ ( dq LL > )
而存在磁阻轉矩，故不令 dsi =0，由 d-軸電流之設定，
施以適當之激磁控制可產生較大之轉矩。於額定轉速
內，可由適當設定 dsi 得到最大轉矩。而 dsi 調控與換相
性時刻移位之等值性與操控特性之比較實測評估可參
考[27]。 
在弱磁控制方面，主要考量事務有：(i)在考慮電流
及電壓限制下，合適設定直軸磁場電流命令；(ii)追求較
佳之轉矩產生能力；(iii)考慮轉子永久磁鐵之去磁等。
此外，因為增加直軸電流成份導致整體效率降低亦需審
慎考量。一個 IPMSM 之電流及電壓限制主導方程式如
下： 
2 max,222ˆ sdsqsas IiiI ≤+=                       (3) 
2max,222ˆ sdsqsas VvvV ≤+=                     (4) 
如圖 1 所示之 IPMSM 電流限制圓與電壓限制橢圓，
(3)式之電流限制為一與速度無關之圓；而(4)式電壓限制
為一隨速度增加而萎縮之橢圓。弱磁控制方法之規劃均
需於此兩限制下為之，且依特定應用需求及速度範圍，
研擬動態及穩態自動弱磁控制策略。此方面之有關技術
及操控性能比較評定可參考前期報告 
 
qsi'qsi
dsi
)(
,,
2
2'
ii
rrdsi αα ωω= =
rbrr ωωω == 1 2rr
ωω =
)( 12 rrrm ωωω >>
)(
,,
1
1'
ii
rrdsi αα ωω= =
'qsi
),( 1212 iirr ααωω <>
2iα 1iα
rmr ωω =
∞=rω
 
圖 1：IPMSM 之電流限制圓與電壓限制橢圓。 
 
2.4 PMSM 之直流鏈升壓及前端轉換器 
雖然變頻器之 PWM 控制具有變頻變壓控制能力，
但在變頻器之前端加裝一 DC/DC 轉換器或 AC/DC 切換
式整流器以建立直流鏈電壓，更具調壓彈性，可得良好
之高速驅動特性，及提升入電之電力品質。如將 PWM
佐以 PAM，應可得較佳之控制彈性及性能。一般於高速
操控下，可令變頻器工作於方波或修正式方波變頻模
式，變壓由其前端轉換器以 PAM 為之。如此可得較高
轉換效率而不損及高速驅動性能。 
切換式整流器可概分為：(i)單級式或多級式；(ii)升
壓型、降壓型或升壓-降壓型；(iii)隔離式或非隔離式；
(iv)單象限或多象限；(v)單相或三相。隔離式切換式整
流器亦可利用各式隔離式轉換器組成。對於單相升壓非
隔離式切換式整流器，可採無整流器型(Bridgeless)以提
升轉換效率。 
SMR 之控制可分為：(i)電壓隨耦型(Voltage follower 
control)，只有電壓迴授迴路，僅部份 SMR 工作於 DCM
下可行此型控制；(ii)低頻切換式整流器，具有低切換頻
率、高轉換效率、控制簡易等優點；但其控制性能較差、
電力品質較差、所需儲能元件值較大；(iii)高頻切換式整
流器，需有內電流控制迴路及外電壓控制迴路。在電流
控制 PWM 上，常採下列方式：(i) 磁滯電流控制 PWM 
(Hysteresis current-controlled PWM, HCCPWM)，其控制
特性強健但切換頻率不固定；(ii) 斜率比較電流控制
PWM (Ramp-comparison current-controlled PWM, 
RC-CCPWM)； (iii)基於 SVPWM 之預測電流控制
(Predictive current control)等。具切換式整流器前級之
PMSM 驅動系統，值得研究事務有：(i)不當組成電路元
件值及控制器增益所產生之非線性現象；(ii)入電電力品
質之控制；(iii)輸出直流電壓之調控；(iv)與後級 PMSM
驅動系統之協調控制。 
 
2.5 PMSM 之無轉子位置感測控制 
PMSM 之無位置感測控制技巧分類詳如圖 2 所示。大
致上無位置感測驅動控制方法可概略歸類成反電動勢
(Back EMF)法及磁凸極(Magnet saliency)法。反電動勢法
不適於零及低速操作情況，因反電動勢與速度成正比。
而 IPMSM 因具有凸極特徵，可採行磁凸極法。 
為兼得此兩類策略之優點可採混合法 (Hybriid 
method)。因反電動勢與速度成正比，故此類方法不適於
極低速驅動應用場合，需先以同步馬達啟動再切至直流
無刷操控模式。而高頻信號注入法，雖有優良之極低速
驅動性能，但隨轉速上升而操控性能漸漸降低，且有較
大之轉矩漣波及可聽噪音。因此，可採行混合法[36,37]，
例如：(1)先以低解析之位置感測器控制，再切至反電動
法直流無刷馬達操控模式；(2)高頻注入法結合反電動勢
法[36,37]，如圖 3。本計畫第一年所開之結合高頻注入
法[33-35]及延伸反電動勢法[32]之 PMSM 混合型無位置
感測控制機構如圖 4。起初以高頻信號注入無位置感測
法令馬達啟動至一適當速度(約 300rpm)，再切至 EEMF
法令馬達於高速下運轉。 
 
操控程序如下： 
PMSM 以 HFI 方法啟動，同時以 EEMF 方法估測速
度，當速度命令高於 300rpm，且 EEMF 法與 HFI 法估
測之速度相同時，直接將速度及位置切換至 EEMF 法之
估測值。 
由於啟動時 HFI 機構注入一 1kHz 之高頻訊號，故將三
相電流經轉子框轉換得到的 d軸( dsi′ )及 q軸( qsi′ )迴授電
流將具有 1kHz 的成份。其所得之 d- 及 q-軸電流將影響
EEMF 法所得之結果，因此在 HFI 估測方式下做 EEMF
法速度估測時，須先以低通濾波器將此高頻成份濾掉得
1dsi′ 及 1qsi′ ，再用以進行 EEMF 之速度估測。 
當速度命令達 300rpm 時，先將速度及位置切換至 EEMF
估測之值，此時 HFI 方法注入之高頻先不移除，待至切
換穩定後(約 305rpm)再將此高頻訊號移除，以降低高頻
訊號之噪音及提高效率。 
而 EEMF 法由高速降低至 300rpm 轉換回 HFI 時，先
於 305rpm 將高頻訊號注入，使 1qsi′ 具有高頻成份以進行
速度及位置估測，在轉速於 300rpm 時再將速度及位置
切換至 HFI 估測之值。依不同應用，所設定之切換轉速
可由 300rpm 改變之。 
 此結合 HFI 及 EEMF 之 PMSM 混合型無位置感測控
制機構亦應用於第三年所欲開發之電動車用 PMSM
驅動系統，探究其應用可行性。 
  5
因所用DSP所具有之PWM通道不足，於此單相SMR
前級之PWM切換機構使用類比IC電路(TL-494)為之。 
bNv cNvaNv
iP
sR
sR
sR
sL
sL
sL
ase
bse
cse
N
1Q
2Q
3Q
4Q
5Q
6Q
iP
asi
bsi
csi
sR
sR
sR
sL
sL
sL
ase
bse
cse
dcV
Di
aci
acv
dC
dcP
N
1T
2T
3T
4T
5T
6T
LP
LR
Li
si
dcP
L D
acP
asi
bsi
csi
dV
M1
n1
k100
k100
k100
aNv
N
bNv
cNv
μ1
n3.3
k20
nav ′′
N
N
n′M1
M1
n1
n1
 
cont,av
triv
1T
2T
3T
4T
5T
6T
*qsi
*
dsi
)(sGci*rω )(sGcω
asi′
triv
triv
cont,bv
cont,cv
iK
iK
ωε
rθˆ
rθˆ
)(sGci
hω
'dsi 1
'qsi 1
tsin hω−
r
iθ~∫
rωˆ
1dsv'dsi 1
'qsi 1
dshv
dsv
qsv
hω
injV
)( tcosVv hinjdsh ω=
rωˆ asi
bsi
rθˆ
*qsmi
dsv
qsmv
dsmv
)(sGcθ1
ˆrω rˆqshi
bsi′
csi′
dsi′
qsi′
)(sGcv
acv LifK iKvK
vε *Li iε
Li′
contv
)(sGci*dcV
LIˆ
dcV ′ )(ts
dcV
S
contv
LPF
*rω )(sGcω
ωε qsv
qsmv
β
rω′
cont,av
triv
1Q
2Q
3Q
4Q
5Q
6Qtriv
triv
cont,bv
cont,cv
rθˆ
dsv
1ˆrθ
1Q
2Q
3Q
4Q
6Q
5Q
rsθˆ rbθˆ nav ′′
 
圖 7：具共同 SMR 前級無位置感測 PMSM 驅動壓縮機及風扇
系統組成及其控制機構。 
 
Li
acv dC
acP
LR dV
F0.01μcont
v
F22μ
k1
k5
k10
k10
dP
1S 2S
L5.0
L5.0
aci
)(sGcv
acv LifK iKvK
vε *Li iε
Li′
contv
)(sGci*dcV
LIˆ
dcV ′ )(ts
dcV
contv ),( 21 SS
S
),( 21 SS
S
 
圖 8：所建 Bridgeless SMR 之電力電路及混合控制機構。 
 
sd RsL +
1
sd RsL +
γ
γ
gs
g
+
γe
γeˆ
riγrvγ
r
qr iL δωˆ
1γv
sd RsL +
1
δ
δ
gs
g
+
δe
δeˆ
riδrvδ
r
qr iL γωˆ
1δv
⎟⎟⎠
⎞
⎜⎜⎝
⎛−= −
δ
γθ
e
e
r ˆ
ˆ
tan~ 1
'asi
'bsi
'csi
)( 'qsi
)( 'dsi
γeˆ δeˆ
rvγ rvδ
)
ˆ
ˆ
(tan 1
δ
γ
e
e−−
γeˆ
δeˆrθ~
riγ
riδ
rωˆ r
θˆ)( dsv )( qsv
sd RsL +
 
圖 9：基於估測延伸反電動勢之 PMSM 轉子位置估測機構。 
 
2.8.2 PMSM 等效電路參數之估測 
A. 測試用 PMSM 
(a) 反電動勢(Back-EMF)     
 back-EMF constant: krpm/V42 peak=ek . 
 Flux linkage established by rotor permanent magnets: 
Wb20054.0' =rmλ . 
(b) 線圈電阻及電感  
f = 100Hz: Ω3341.Rs = , dL =3.055mH, qL =3.36mH, 
mH2075.3)(5.0 =+= qds LLL  
f = 20kHz: dL =2.265mH, qL =2.83mH, 
mH54752)(50 .LL.L qds =+=  
因 dL 與 qL 相差很少，故所採之馬達屬SPMSM。  
 
B. 壓縮機 PMSM 
(a) 反電動勢(Back-EMF)     
 back-EMF constant: krpmV7711 peak /.ke = . 
(b) 線圈電阻及電感  
Ω880.Rs = , dL =7.5mH, qL =13.8mH, 
mH6510)(50 .LL.L qds =+=  
C. 風扇 PMSM 
(a) 反電動勢(Back-EMF)  
 back-EMF constant: )V/krpm(66.13=ek . 
(b) 線圈電阻及電感 
f = 100Hz: Ω3556.Rs = , dL =12.03mH, qL =9.67mH, 
mH85.10)(5.0 =+= qds LLL . 
f = 15kHz: dL =8.49mH, qL =7.07mH, 
mH78.7)(5.0 =+= qds LLL . 
因 dL 與 qL 相差很少，故所採之馬達屬SPMSM。  
 
2.8.3 PMSM 驅動系統組成元件之額定及規格 
(a) AC input: (1) Rectifier: φ1 AC, HzV 60220 ; (2) SMR: φ1 AC, HzV 60110 . 
(b) 測試用PMSM及PMSG (野力公司, YBL90-160E.Z, W33φ , 4P, Y-connected ): 1kW, 100Hz, 3000rpm, 3.23N-m,  
5.3A (rms)/7.5A (peak). 
(c) 壓縮機 PMSM (Mitsubishi Company, TNB220FLBM1, 
W33φ , 4P, Y-connected): 1.3kW, 120Hz, 3600rpm, 9.7A 
(rms). 
(d) Fan PMSM: Sanyo, Model 65BM007H- E00, W33φ , 4P, 
Y-connected, 180W, maximum speed: 3000rpm, High-speed 
continuous torque= mN5880 ⋅. , maximum continuous 
torque= mN961 ⋅.  
(e) PMSM drive inverter intelligent power module:  
Toshiba: PS21265-P/AP, 600V/20A. 
(f) SMR power circuit components and devices:  
   (1) Energy storage inductor 21 LLL += =4.14mH (60Hz); 
21 LLL += =3.898mH (25kHz). 
   (2) Switch: MOSFET IXFK44N80P (IXYS) (800V, ID= 44A 
  7
(b) 無位置感測方波及弦波 PMSM 驅動散熱風扇 
所提之散熱風扇無位置感測方波及弦波 PMSM 驅動
系統之控制架構分別顯示於圖 13(a)及圖 13(b)，先以同
步馬達啟動至約 300rpm，再切換至無位置感測直流無刷
馬達運轉模式，應用感測且低通濾波(濾波電路顯示於圖
7)之 a-相端電壓 nav ′′ 之零交越點從事 BDCM 操控，由於
濾波延遲效應所造成之性能劣化，可由換相移位獲得導
正改善。 
令 AC/DC 轉換器前級為整流器，且交流入電電源為
Hz/VVac 60220= ，圖 15 顯示弦波無位置感測 PMSM 驅
動散熱風扇系統之實測結果：(上)：風扇以同步機啟動
至 300rpm 時切換至 Sensorless-mode；(中)：於 2000rpm
時之 a 相 Hall 位置信號 aH 、估測 a 相 Hall 位置信號 aHˆ
及 nav ′′ ；(下) 於 2000rpm 時，適當之換相前移使 asi 對
齊於 aH ，實測之 a 相 Hall 位置 aH 及 a 相電流波形 asi 。 
   於 2000rpm 下，在 asi 對齊於 aH 後，再繼續換相移位
( β 正值為前移； β 負值為後移)，量測所得之交流入電
功率 acP 比較於圖 14，結果顯示於 o8.1=β 時， WPac 1.88=
為最小值，非常接近表 1 所示標準控制 PMSM 驅動散熱
風扇系統之交流入電功率。如僅係相 PWM 控制電壓與
aHˆ 對齊而未施以適當之換相前移，無法獲得良好之轉矩
產生能力。 
 
  
*rω
rω′
aH
asi
aH
asi
*
rω
aH
asi
rω′
aH
asi
 
圖 11：量測之風扇速度動態響應(2000rpm→ 2100rpm)，及於
2000rpm 穩態下( o0=β (上)及 o8.10=β (下))之( aH , asi )：(a)
方波；(b)弦波驅動。 
(rpm)rω
acP
(W)
0.88
2.88
4.88
6.88
8.88
0.89
2.89
4.89
6.89
8.89
500 1000 1500 20000  
圖12：散熱風扇標準方波及弦波PMSM驅動系統於不同轉速下
之交流入電功率 
 
contv
triv
*rω )(sGcω
ωε
cmv
β
rω′
1Q
2Q
3Q
4Q
5Q
6Q
1Q
2Q
3Q
4Q
6Q
5Q
aHˆ
61 ~ qq
LPF nav ′′
LPF
*rω )(sGcω
ωε qsv
qsmv
β
rω′
cont,av
triv
1Q
2Q
3Q
4Q
5Q
6Qtriv
triv
cont,bv
cont,cv
rθˆ
dsv
1rˆθ
1Q
2Q
3Q
4Q
6Q
5Q
rsθˆ rbθˆ
nav ′′
 
圖 13：所提散熱風扇無位置感測方波及弦波 PMSM 驅動系統
之控制架構：(a) 方波 PMSM；(b) 弦波 PMSM。 
0 55−10− )(°β
acP
(W)
0.88
2.88
4.88
6.88
8.88
0.89
2.89
4.89
6.89
8.89
°= 8.1β
W1.88=acP
 
圖 14：弦波無位置感測 PMSM 驅動散熱風扇於 2000rpm 下，
在 asi 對齊於 aH 後，再繼續換相移位( β 正值為前移； β 負值
為後移)，量測所得之交流入電功率 acP 比較。 
  9
操控程序： 
PMSM 以 HFI 方法啟動，同時以 Extended-EMF 
(EEMF)方法估測速度，當速度命令高於 300rpm，且
EEMF 法與 HFI 法估測之速度相同時，直接將速度及位
置切換至 EEMF 法之估測值。 
由於啟動時 HFI 機構注入一 1kHz 之高頻訊號，故將
三相電流經轉子框轉換得到的 d軸( dsi′ )及 q軸( qsi′ )迴授
電流將具有 1kHz 的成份。其所得之 d- 及 q-軸電流將影
響 EEMF 法所得之結果，因此在 HFI 估測方式下做
EEMF 法速度估測時，須先以低通濾波器將此高頻成份
濾掉得 1dsi′ 及 1qsi′ ，再用以進行 EEMF 速度估測。 
當速度命令達 300rpm 時，先將速度及位置切換至
EEMF 估測之值，此時 HFI 方法注入之高頻先不移除，
待至切換穩定後(約 305rpm)再將此高頻訊號移除，以降
低高頻訊號之噪音及提高效率。 
而 EEMF 法由高速降低至 300rpm 轉換回 HFI 時，先
於 305rpm 將高頻訊號注入，使 1qsi′ 具有高頻成份以進行
速度及位置估測，在轉速於 300rpm 時再將速度及位置
切換至 HFI 估測之值。 
依不同應用，所設定之切換轉速可由 300rpm 改變
之，細節值得進一步探究。 
 
(a) 測試用 PMSM 之無位置感測控制啟動特性 
   圖 19 至圖 21 顯示測試用 PMSM 驅動系統(PMSG 之負載
電阻 Ω= 7.44LR )之無位置感測控制啟動特性(500rpm/s 啟動
加速率)，含( rr θθ ˆ, ),( rr ωω ˆ,* ),( qsqs ii ′,* )：(a) HFI 法啟動至
300rpm 切換至 EEMF 法(混合法)；(b) SM 啟動至 300rpm 切換
至 EEMF 法(全程 EEMF 法)；(c)全程 HFI 法。 
圖 22(a)至圖 22(c)顯示測試用PMSM驅動系統(PMSG之負
載電阻 Ω= 7.44LR )之無位置感測控制啟動特性(4000rpm/s 與
500rpm/s 啟動加速率之比較)：(a) HFI 法啟動至 300rpm 切換至
EEMF 法(混合法)；(b) SM 啟動至 300rpm 切換至 EEMF 法(全
程 EEMF 法)；(c)全程 HFI 法。 
  
rωˆ*rω
*qsi qsi′
°180
rθˆrθ
rr θθ ˆ−
°40
 
圖 19：測試用 PMSM 驅動系統(PMSG 之負載電阻 Ω= 7.44LR )之無位置感測控制啟動特性 (500rpm/s 啟動加速率 )，含
( rr θθ ˆ, ),( rr ωω ˆ,* ),( qsqs ii ′,* )：HFI 法啟動至 300rpm 切換至 EEMF
法(混合法)。 
°180
rθˆrθ
rr θθ ˆ−
°180
*rω
*qsi qsi′
rωˆ
 
圖 20：測試用 PMSM 驅動系統(PMSG 之負載電阻 Ω= 7.44LR )之無位置感測控制啟動特性 (500rpm/s 啟動加速率 )，含
( rr θθ ˆ, ),( rr ωω ˆ,* ),( qsqs ii ′,* )：SM 啟動至 300rpm 切換至 EEMF
法(全程 EEMF 法)。 
 
  
rωˆ
*rω
*qsi qsi′
°180
rθˆrθ
rr θθ ˆ−
°40
 
圖 21：測試用 PMSM 驅動系統(PMSG 之負載電阻 Ω= 7.44LR )之無位置感測控制啟動特性 (500rpm/s 啟動加速率 )，含
( rr θθ ˆ, ),( rr ωω ˆ,* ),( qsqs ii ′,* )：全程 HFI 法。 
 
 
  11
  
AH
*
asi
asi′
AH
*asi
asi′
°=Δ 43rθ
AH
*asi
asi′
°=Δ 5.30rθ
AH
*asi
asi′
 
圖 24：標準控制 PMSM 驅動系統：(a) V300=dcV , *dsi =0, β =0 
(3190rpm) ； (b) V300=dcV , *dsi =-3.45A, β =0(3600rpm) ；
(c) V300=dcV , *dsi =0, β = °30.5 (3600rpm)； (d) V350=dcV , *dsi =0, β =0 (3600rpm)。 
 
2.8.5 結論與討論 
本計劃第一年完成下列工作：(1) 比較探究 PMSM 型
態、方波及弦波驅動及其應用；(2) 探究馬達驅動冷凍
系統之 PMSM 特性及趨勢；(3) PMSM 等效電路及動態
模式建立、及馬達關鍵參數估測；(4) 探究既有 PMSM
無位置感測控制方法；(5) 開發弦波 PMSM 高頻注入法
及延伸型反電動法無位置感測控制技術，及結合高頻注
入法及反電動法之混合控制機構，並從事其於壓縮機系
統之應用與效能評估；(6) 開發所提弦波及方波 PMSM
無位置感測控制技術，以及其於風扇之應用與效能評
估；(7) 開發共通切換式整流器前級，其控制採外加類
比 PWM 電路之混合式機構，以解決 DSP PWM 通道數
不足之限制；(8) 開發強健電流 PWM 及隨機 PWM 機
構；(9) 開發換相調控及激磁調控策略及其比較性能評
定；(10) 開發直流鏈升壓控制策略及其比較性能評定。 
 
        
AH
*asi
asi′
AH
*asi
asi ′
°=Δ 5.19rθ
AH
*asi
asi ′
 
圖 25：HFI 無位置感測控制 PMSM 驅動系統：(a) V300=dcV , *dsi =0, β =0 (3578rpm)；(b) V300=dcV , *dsi = -1.12A, β =0 
(3600rpm)；(c) V350=dcV , *dsi =0, β =0 (3600rpm)。  
AH
*asi
*asi
asi′
°=Δ 9.24rθ
AH
*asi
asi′
°=Δ 5.19rθ
AH
*asi
asi′
asi′
AH
 
圖 26：EEMF 無位置感測控制 PMSM 驅動系統： (a) 
V300=dcV , *dsi =0, β =0(3190rpm)；(b) V300=dcV , *dsi = -1.36A, β =0 (3600rpm)；(c) V300=dcV , *dsi =0, β = °19.5  (3600rpm)；
(d) V350=dcV , *dsi =0, β =0 (3600rpm)。 
  13
speed command change of rpm100 at the condition 
( rpm,10000 =rω V30=dcV ) are used to estimate the 
mechanical parameters of /radsmN022516.0 2⋅⋅=J  and 
4109701.1 −×=B s/radmN ⋅⋅ .  
(ii) Control Scheme 
The designed controllers are listed below. The desired 
tracking response is defined by a first-order reference 
model: 
=)(sHdω
67.0
67.0)( +=+= srs
rsH m                 (9) 
The feedback and robust controllers are: 
ss
KKsG IPcb
00018.002036.0)( +=+= ωωω           (10) 
s
WsW ω
ωω τ+= 1)( , ωω πτ cf2
1= , 10 <≤ ωW          (11) 
Similarly, the weighting factor ωW  is used to determine 
the extent of robust error cancellation, and the low-pass 
process )1(1 sωτ+ is arranged to reduce the effects of 
high-frequency contaminated noise on the closed-loop 
control behavior. For the relatively lower dynamic response 
speed, Hz10=ωcf  is adopted here. And the weighting 
factor 75.0=ωW is chosen.  
For larger magnitude of speed command change, the 
step command is replaced by ramp command with suitable 
ramping rate R to avoid long duration of control effort 
(q-axis current command) saturation.  
 
triv
acontv ,
bcontv ,
ccontv ,
rθ
1S
3S
5S
4S
6S
2S
*asi
'asi
*bsi
'bsi
*csi
'csi
*qsi
*dsi
*rω
asi
bsi
csi
ase
1S 3S 5S
4S 6S 2S
a
b
c
dcI
sR L
eT rω
'asi 'bsi 'csi
sR
sR
triv
triv
rθ
L
L
bse
csedcC
rωωε eT1≈
*rω
rω′
)(sGcbω
qsi
tK
*rmω
Σ
LT
BJs +
1
)(sWω
*qsi
Σ
*rrω
*
1rω
rω
rω′
Σ
ΣΣ iε
)(sGir
'si
*sri
*1si
ibv
)( asd ee
sv sicontv
)(sGp
Σ
sRsL+
1
iK
imv
rω
*si Σ PWMK)(sGib
)(sGim
)(sHmω
L
D
dC
pvV dcV
triv
contv
Li
LidcV
S
*rω *dcV
'dcV
'Li
'dcV 'Li
*dcV
'dcV
Σ
S
bS
idKvdK
contv
)(sGdibΣ
*Li
Li
)(sGdvbΣ
*dcmV
'dcV
Σ
)(sWv*drV
* 1dcV
ωK
dε iε
*rsω
)(sWi
pvP dc
P
)(sHmv
*dcV
D1
D2
Si
Di
P1
P2
bS
bR
qLL =iK
'Li
dcVvK
vbε
 
Fig. 29. The developed PMSM driven reaction wheel: (a) system configuration equipped with DC/DC front-end boost converter; (b) 
DC/DC front-end converter control scheme; (c) per-phase PMSM winding current control scheme; (d) PMSM drive speed control scheme. 
 
III. Front-end DC/DC Boost Converter  
The developed front-end DC/DC boost converter is 
shown in Fig. 29(a). Their common features and 
assumptions are: (i) Operated in CCM; (ii) PV DC input 
voltage range pvV = 22~38V, DC output voltage range 
dcV =22~60V, rated output power oP = dcP =150W; (iii) 
Switching frequency sf = 50kHz; (iv) The control 
scheme is shown in Fig. 29(b), wherein the voltage 
current sensing factors are set to be V/V0.1=vK  and 
V/A0.1=iK ; (v) The case assumed for circuit 
component rating derivation is ( pvV =22V, dcV =60V, 
dcP =150W), hence the duty ratio is 6333.0=D . 
And Ω== 24150602dcR  denotes an equivalent converter 
load resistance viewing from DC-link to the followed 
PMSM drive.  
A. Power Circuit  
y Energy storage inductor: By specifying the inductor 
current ripple be 0.15 of its rated average value, i.e., 
A,023.115.0 ==Δ LaL Ii the energy storage 
inductance can be found as H5.272 μ=L . The 
inductor is wound using a toroidal core T175-26 
(Micrometals Corp.) with 55 turns of AWG#18. The 
measured inductance of the wound inductor is 
H76.297 μ=L  (@50kHz) using the LCR meter 
(Hioki 3532-50). 
y Output voltage ripple factor: 
 
2
dc
dc
sdcdc
dc
V
P
fC
D
V
V =Δ                        (12) 
By choosing V200/4000 FCdc μ= , the voltage ripple 
factor is found to be 0.0132%.  
According to the rating derivation, the power 
MOSFET IRFP250 (STMicroelectronics Corp., 200V, 
33A) and the power diode DSEP 29-03A (IXYS Corp., 
300V, 30A) are adopted for realizing the power devices of 
the DC/DC boost converter. 
B. Control Scheme 
(i) RC-CCPWM scheme 
=+=
s
KKsG IdiPdidib )( s
35.610336.0 +        (13) 
  
15 
 
  The designed control schemes [11-12, 78] are listed as 
follows:  
(1) Voltage control scheme: 
y Voltage feedback controller: 
s
sGcv
85.124.0)( += , V/V1.0=vK  
y Robust voltage error controller: 
ss
WsW
v
v
v 31059.11
55.0
1
)( −×+=+= τ
 
(2) Current control scheme: 
y Resonant feedback controller: 
22
100)(
r
im s
ssG ω+=
  
y PI controller: 
s
sGib
61.2839.0)( +=  , V/V0.1=iK  
y  RECC )(sGir : 
1102.159
763.0
6 +×= − sWi
 , kHz1=cif  
The loads of the 1P3W inverter are set as Ω= 0ABR , 
Ω== 900BA RR , and the main source of DC microgrid is 
suddenly removed and the flywheel storage discharging is 
initiated simultaneously. The measured input voltage fv , 
common DC bus dcv and inverter output voltage 
waveform ( AAB vv  , ) are shown in Figs. 32(a) and 32(b). 
The results indicate that within a short time period, the 
microgrid can be supported energy from the flywheel 
quickly and the load inverter output waveform quality is 
maintained. 
 
(b)
(a)
50V3
V20
00V4
s1
fv
dcv
ABv Av
V0518V4
50V3
V20
00V4
ms100
fv
dcv
ABv Av
V0518V4
Flywheel storage discharge start
Flywheel storage discharge start
 
Fig. 32. Measured results of the flywheel storage discharging 
characteristics when the main source of DC microgrid is 
suddenly removed: (a) DC-link voltage dcv , input voltage fv  
and two output voltage ),( AAB vv of inverter at Ω== 900BA RR ; 
(b) the results of (a) with expanded. 
 
2.10 研究成果- 階段 2：PMSM 驅動之飛輪 
2.10.1 System Configuration and Problem Statements 
System configuration of the studied microgrid is 
shown in Fig. 33. The 400V common DC bus is 
established from the PV cell via interleaving boost 
DC/DC interface converter and the wind generator 
(PMSG) via three-phase Vienna switch-mode rectifier 
(SMR). The energy storage devices consist of battery 
bank, super-capacitor bank and flywheel, each device is 
interfaced to the common DC bus through its individual 
bidirectional DC/DC converter. Detailed schematic of Fig. 
33 is drawn in Fig. 34(a).  
In performing the flywheel energy storage system 
studies arranged in this project, the specific circuits 
consisting of the PMSM driven flywheel and the 1P3W 
inverter in the DC microgrid are shown in Fig. 34(b). A 
commercial DC power supply is employed to charge the 
PMSM driven flywheel, and its discharging is made to 
power the DC microgrid 1P3W inverter.  
 
Vienna
switch-mode
rectifierWind
PMSG
Common
DC bus (400V)
Bidirectional
DC/DC
converter
Super-
capacitor
Bidirectional
DC/DC
converter
Li-ion 
battery
1P3W
DC/AC
converter
AC
loads
DC/DC
converterDC source 
(PV)
1P3WAC 
source
(utility grid)
SW
PMSM
PMSG
DC-AC
DC-DC
converters
Flyweel
PMSG
 
Fig. 33. System configuration the studied DC micro-grid. 
 
2.10.2 PMSM Driven Flywheel System 
A. Flywheel 
The photos and dimensions of the manufactured 
PMSM driven flywheel are shown in Fig. 35, and Table 5 
lists its key calculated parameters.  
B. PMSM Drive 
  The employed PMSM possesses the following key 
specifications and estimated equivalent circuit parameters: 
y Specifications: Ye-Li motor YBL 13S-160, three-phase 
Y-connected, 8-poles, 2000W, 2000rpm, belongs to 
SPMSM. 
y Estimated parameters: From the measured phase   
back-EMF waveform and the measured line-to-line 
inductance )( rabL θ of the employed PMSM under 
150Hz, the motor parameters are estimated as:  
 Web14585.0' =rmλ , /krpmV2.43 rms=ek . 
 mH4911.1=qL , mH2506.1=dL . 
 Phase winding resistance: Ω= 8.0sR Hz).150( =f   8751.014585.0)483(43 ' =××== rmt PK λ m/AN ⋅ . y Inverter: It is formed using the intelligent power 
module (IPM) PS21265, (Mitsubishi Electric, Japan) 
( A20=CI (DC), A40=CI (peak), V600=CEV ). 
 
  
17 
 
D. Control Scheme of PMSM Drive 
Fig. 36 shows the proposed control schemes of the 
PMSM-driven flywheel system. The control strategies are 
proposed as: 
(i) Charging mode: the PMSM driven flywheel speed is 
established under the proposed speed and current 
controls. The inverter DC-link voltage is established 
by the microgrid bidirectional DC/DC converter in 
buck mode with the proposed control strategies. It is 
worth noting that, for the employed PMSM having the 
estimated back-EMF of /krpmV2.43 rms=ek , the 
inverter DC-link voltage established from the 
micro-grid with 400VDC can be changed over wide 
range with the speed to enhance the flywheel driving 
performance.  
(ii) Discharging mode: The control is emphasized on the 
regulating inverter DC-link voltage. The DC-link 
voltage command *dv  is generated according the flywheel speed and the desired PMSM driving 
performances, and the proper q-axis current command 
is generated to let the sensed 'dv  to follow its 
command.  
All speed, voltage and current control schemes adopt PI 
feedback controls. And the direct-duty PWM switching 
mechanism is used for the PWM inverter. The designed 
controllers are listed as follows:  
 
ss
KKsG IPc
75.515.34)( +=+= ωωω              (16) 
ss
KKsG IiPici
20015)( +=+= , V/A0428.0=iK      (17) 
ss
KKsG IvPvcv
3002)( +=+= , V/V0.002=vK       (18) 
 
triv
acontv ,
bcontv ,
ccontv ,
rθ
1S
3S
5S
4S
6S
2S
*qsi
*dsi
Rotor 
position
and speed 
detection
scheme
A,B
HA,HB,HC
+
-
+
-
+
-
triv
triv
rω′
dq/abc
transfor-
mation
-1
dv
EC
Σ
+*dv )(sGcvv
ε
'dv
asibsicsi
ωε+*rω
-
rω′
)(sGcω
Speed control scheme
*qsiΣ
Ramp limiter
*rsω
Excitation
tuning
-
C
D
*qsi
DC-link voltage  
control scheme
ciG
Current
controller
dsv+
dsmv
dsiε
ciG
Current
controller
'qsi
qsv+
qsmv
qsiε
'dsi
abc/dq
transfor
mation
'asi
'bsi
'csi
'qsi 'dsi
DSP TMS320F28335
 
Fig. 36. The proposed control schemes of the PMSM-driven 
flywheel system. 
 
E. Control Scheme of DC/DC Interface Converter 
Fig. 37 shows the proposed control schemes of the 
bidirectional DC/DC interface converter shown in Fig. 
34(b). The designed control schemes are listed below.   
Σ
dcv′
+
−Σ
+
)(sWv
vε*dv*
dcv )(sGcv
*
drv+
Σ+ −Σ
+
)(sWi
idε*Ldi
*
Lrdi
contv+
)(sGci
*Li
3Li′
ik
2Q
3Li
−Σ
+ vcε∗
dv )(sGcv −Σ
+ icε*Li
1Q
DA /dv vk
DA /
'dv
DA /
dcv
vk
ik3Li DA /
contv)(sGci
3Li′
sawv
sawv
 
Fig. 37. The proposed control schemes of the bidirectional 
DC/DC interface converter. 
(1) Buck DC/DC converter during charging mode 
(a) Voltage control scheme (sampling rate = 3kHz) 
y Voltage feedback controller:  
s
sGcv
755.0)( += , V/V0.05=vK  
(b) Current control scheme (sampling rate = 30kHz)   
y Current feedback controller:  
,0.155.0)(
s
sGci +=  V/A1.0=iK   
(2) Boost DC/DC converter during discharging mode 
(a) Voltage control scheme (sampling rate = 3kHz) 
y Voltage feedback controller:  
s
sGcv
2.678.0)( += , V/V0.0064725=vK  
y Robust voltage error controller:  
ss
WsW
v
v
v 31059.11
92.0
1
)( −×+=+= τ
 
Here, =vW 0.92 and =vτ 31059.1 −× (low-pass 
cut-off frequency = Hz10021 =vπτ ) . 
(b) Current control scheme (sampling rate = 30kHz) 
y Current feedback controller:  
,0.31.0)(
s
sGci +=  V/A06.0=iK   
y Robust voltage error controller:  
ss
WsW
i
i
i 3100318.01
25.0
1
)( −×+=+= τ
 
Here, =iW 0.25 and =vτ 3100318.0 −×  (low-pass 
cut-off frequency = kHz521 =vπτ ). 
 
2.10.3 Single-Phase Three-Wire Load Inverter 
A. Power Circuit 
For the 1P3W inverter shown in Fig. 34(b), its power 
circuit is formed using the three inverter legs of an IGBT 
module CM100RL-12NF (Mitsubishi). The voltage 
bipolar sinusoidal PWM (SPWM) switching mechanism is 
adopted with switching frequency as 30kHz, and the 
measured output filter inductance using HIOKI 3532-50 
LCR meter is μH/30kHz62.401=oL  and μF/400V10=oC . 
The isolation amplifier AD202 (Analog Devices) is used 
to construct the isolated voltage sensing mechanism. And 
Good inverter output voltage waveform tracking control 
under lamp load is achieved via the proposed simple 
robust control scheme. 
B. Control Scheme  
Fig. 38 depicts the proposed control schemes of the 
1P3W inverter. The parameters of PI feedback controller 
are first determined trial-and-error experimentally to let 
the tracking error be minimized as far as possible. Then 
further reduction of tracking error is achieved by robust 
control. The designed controllers are listed as followed. 
(a) Master DM control scheme 
  The waveform control for ABv  generated from the 
outer two IGBT module legs is handled by the master 
differential mode (DM) control scheme. 
 Feedback controller: 
s
sGcv 35103.1)( +=  
  
19 
 
rω′
fv
fi
Discharging mode 
(Voltage mode)
fv
dcv
ABv Av
s20
2A
100V
500rpm
rpm1000
V300
V400
V300
s3
400V
Discharging mode 
1t
(a)
(b)
200V
ms120
400V
fv
dcv
ABv Av
ms5
100V
*
ABv
ABv
Bv
Av
%491.4 %,584.4%,297.7 === BvAvABv THDTHDTHD
(c)
(d)
100V
 
Fig. 39. Measured discharging characteristics of the PMSM- 
driven flywheel when the main source of DC microgrid is 
suddenly removed: (a) speed rω′ , voltage fv  and current fi  
of flywheel system; (b) DC-link voltage dcv , input voltage fv  
and two output voltage ),( AAB vv  of inverter at AZ (rated 
60W), BZ (rated 60W) and ABZ (rated 100W); (c) results of (b) 
with expanded time scale at the time instant 1t ; (d) expanded 
waveforms of the output voltage ABv  (220V), its command 
*ABv  and two 110V output voltages ( Av , Bv ) at a particular time 
instant. 
 
 
 
 
 
 
 
2.11 第三年研究成果 
2.11.1 System Configuration of the Developed Electric 
Vehicle PMSM drive 
System configuration of the developed DSP-based EV 
PMSM drive is shown in Fig. 40(a). Its power circuit 
consists of a one-leg half bridge bidirectional DC/DC 
front-end converter and a three-phase inverter. The major 
functions and power flows of the developed motor drive 
labeled in Fig. 41(a) are summarized as follows: 
(1) Driving mode: The switch SW is placed at position . 
The boosted DC-link voltage (400V) is established 
from the low and varied battery voltage (144V). 
Thanks to the boosted DC-link voltage, the rating 
utilizations of battery and motor drive can be increased, 
and the high-speed driving performance is improved. 
In regenerative braking operation, the charging control 
can be conducted using the same frond-end being 
operated as a buck converter based charger. 
(2) Idle mode: By letting the switch SW at position , 
the developed EV PMSM drive is rearranged to form 
the schematic as indicated in Fig. 40(b). The on-board 
battery bank is regarded as a storage device. In V2H 
operation, a single-phase three-wire (1P3W) inverter is 
constructed to generate the 60Hz 110V/220V AC 
sources for domestic appliance use. Obviously, the 
schematic shown in Fig. 40(b) can also be controlled 
to yield the three-phase AC source. As to the G2V 
operation, a single-phase SMR or a three-phase SMR 
can be formed. And the front-end DC-DC converter is 
operated as a buck converter based charger.  
Fig. 41(a) shows the power circuit of the developed EV 
PMSM drive. Fig. 41(b) and Fig. 41(c) respectively are 
the standard control scheme and the hybrid position 
sensorless control scheme combining extended-EMF 
observer and HFI approaches. All the controls of the 
established EV PMSM drive are realized fully digitally 
using the DSP TMS320F28335 (Texas Instruments). The 
operation control of the EV PMSM drive is arranged as 
follows: 
z Motoring mode 
The positive torque current command *qsi  generated 
from outer speed loop together with the properly set field 
excitation current command *dsi  let the PMSM to yield high developed torque for achieving speed tracking 
control. The improved generated torque can be further 
obtained by commutation advanced shift. 
z Regenerative braking mode 
As the speed commend is reduced, the tracking error 
ωε  and hence the torque current command *qsi  will 
become negative automatically. The motor developed 
power is reversed and backs to the DC-link. The recovered 
motor developed power lets the DC-link voltage be >dcv  
)V400( * =dcv . And the negative values of )( ** bL ii =  and 
Li  will let the DC-link voltage be maintained at 400V 
with the maximum charging current being set by *bmi of the current limiter. In the developed EV PMSM drive, 
*bmi =7A  is set.  
2.11.2 EV PMSM Drive 
A. Power Circuits 
(a) PMSM drive 
  The employed PMSM is rated as three-phase, 4-pole, 
100Hz, 3000rpm, 1kW, 5.3A, 3.23N-m. The measured key 
motor parameters at 100Hz using the HIOKI 3532-50 
LCR meter are: ,334.1 Ω=sR  55mH,0.3=dL  mH,36.3=qL  
mHLLL dq 305.0=−ΔΔ . And back-EMF constant 
krpm42V(peak)/=ek , Wb2.0' =rmλ . 
  
21 
 
           
            
Fig. 41. The developed EV PMSM drive system: (a) power circuit; (b) standard control scheme; (c) hybrid position sensorless control 
scheme combining extended-EMF observer and HFI approaches. 
 
asi
bsi
csi
dcv
1T 3T 5T
4T 6T 2T
c
b
a
dcC
bv
L Li
)(SSb
)(SSa
Battery
bank
12Vx12 )(D
Da
)(D
Db
1D 3D
5D
4D 6D 2D
PMSG
LP
LR
Dynamic load
sL
sL
sL
sR
sR
sR
ase
bse
cse
LT
eT rω
InverterBatterybank
ECEncoder
Hall
Hall 
sensor
bP
(a)
Front-end 
DC/DC  
converter
PMSM
rω
dcP
cont,av
triv
1T
2T
3T
4T
5T
6T
+
Speed 
controller Currentcontroller*qsi
*dsi
)(sGci)(sGcω
*rω
'asi
'bsi
'csi
DSP TMS320F28335
A
/
D
P
W
M
U
N
I
T
S
triv
triv
cont,bv
cont,cv
ωε
abc/dq
transfor
mation
dq/abc
transfor-
mation
)(sGci
Current
controller
'qsi
'dsi
'dsi
'qsi
*dsv
+
+
Commutation 
shifting 
scheme
A
B
Z
Rotor position 
detection scheme
rθβ Δ=
rθ QE
P
+
+
rω′
dtd /
rθ
dsmv
qsmv*qsmi
qiε
diε
ΣΣ
Σ
Σ
Σ
(b)
asi
bsi
)(sKi
)(sKi
1T
2T
3T
4T
5T
6T
abcH
P
W
M
cbv
swv
bS
Li′
Σ
iε
aS
)(sGci
cbmv
)(sGcv
vε
Σ
∗
LiΣ
)(swv
*qsv
*
bmi
*
bmi−
dcv′
∗
dcv
*
dcrv
*
1dcv
)( ∗bi
A
/
D )(sKi
)(sKv
Li′ Li
dcvdcv′
Current
controller
Voltage
controller
PMSM drive control scheme
Front-end DC/DC converter control scheme
bi
Excitation and 
field-weakening 
control
I
/
O
cont,av
triv
1T
2T
3T
4T
5T
6T
)(sGcω
asi′
triv
triv
cont,bv
cont,cvωε
rθˆ
rθˆ
hω
'dsi 1
'qsi 1
thωsin−
r
iθ~∫
rhωˆ
1dsv
'dsi 1
dshv
dsv
qsv
hω
injV
)cos( tVv hinjdsh ω=
rωˆ
*qsmi
dsv
qsmv
dsmv
)(sGcθ
1ˆrω rqshi ˆ
bsi′
csi′
dsi′
qsi′
)( 1'qsi
)( dsv)( qsv
reωˆrωˆ
)(
  
rθ
βΔ
rhθˆ
1ˆrθ
rωˆ
1ˆrθ
2T
3T
5T
6T
1T
4T
reθˆ
rhωˆ
rθˆ
qsi′rvγˆrv ˆδ
reθˆ
)( 1'dsi
riγˆ
ri ˆδ
re ˆγˆ
)
ˆ
ˆ
(-
tan
ˆ
ˆ
1
r
r
e
e
δ
γ
−
rθ~
)(sGcθ ∫
1ˆrω
re ˆδˆ
re ˆδˆ
re ˆγˆ
*
dsi
ciG
diε
'qsi 1
*qsi
ciG
iqε
asi
bsi
)(sKi
)(sKi
*rω
  
23 
 
ss
wsw
v
v
v 41031.51
8.0
1
)( −×+=+= τ           (39) 
with the low-pass cut-off frequency = )2/(1 vcvf πτ= .  
Within the main dynamic frequency range, vv wsw ≈)( , 
one can derive to yield that the original tracking error vε  
can be reduced to vvw ε)1( − . However the choice of vw  
should consider the effects of magnified system noise and 
control signal. 
 
C. Sensorless Control Schemes 
(a) High-frequency signal injection method  
In the high-frequency signal injection (HFI) control 
scheme shown in Fig. 41(c), a high-frequency (1kHz) 
voltage signal with suited amplitude is injected into the 
d-axis voltage control command: 
tVv hinjdsh ωcos=                     (40) 
Then the sensed q-axis current qsi′  is processed by band-pass filtered, multiplied by ( thωsin− ) then low-pass 
filtered to yield the following DC current component 
r
iθ% : 
rr
qh
r
dhh
diffinjr
qshmr LL
LV
iLPFi θωθ
~2sin
4
)( ˆ~ ==          (41) 
where 
r
diff
avgrdh
z
zz θ~2cos
2
  ˆ +Δ , rdiffavgrqh
z
zz θ~2cos
2
  ˆ −Δ , 
2
 
r
qh
r
dh
avg
zz
z
+
Δ , rqhrdhdiff zzz −Δ           (42) 
For the very small estimation error of rθ~ , one has 
rr θθ ~2~2sin ≈ , hence (41) can be approximately expressed 
as: 
rerrrr
qh
r
dhh
diffinj
r KLL
LV
i θθωθ
~  ~
2
~ Δ≈ , r
qh
r
dhh
diffinj
err LL
LV
K ω2  Δ
  (43) 
Eq. (43) shows that riθ~  is proportional to the rotor position error rθ~  by a factor errK . An estimated rotor 
speed is obtained by a PI controller, and the estimated 
rotor position rθˆ  is then obtained via an integration 
process. A rotor position and speed estimation scheme 
developed based on the above methodology is shown in 
Fig. 43(a) and its equivalent block diagram is shown in 
Fig. 43(b). 
The PI controller is expressed as: 
s
KKsG IPc ωωθ ˆˆ)( +=                    (44) 
And closed-loop tracking transfer function is found form 
Fig. 43(b) as: 
errIerrP
errIerrP
r
rd KKsKKs
KKsKKsH ωω
ωωθ θ
θ
ˆˆ2
ˆˆˆ)( ++
+==       (45) 
Comments: 
¾ For an IPMSM, it possesses saliency, thus the HF 
signal injection method is directly applicable. As to the 
SPMSM, although its saliency is negligibly small, the 
saturation effects caused by permanent-magnet rotor 
flux will make the winding inductance vary with rotor 
position. It follows that the HF signal injection 
approach can also be employed for SPMSM. 
¾ The motor parameters are not required for this 
sensorless control method. 
¾ From (45), one has ,1)0( =θdH hence the steady-state 
rotor position estimation error is zero. 
¾ Under the main position dynamic low frequency range, 
it is reasonably to have 
1)(
ˆˆ
ˆˆ =+
+≈
errIerrP
errIerrPd KKsKK
KKsKKsH ωω
ωωθ          (46) 
¾ However, the value of errK for a SPMSM is much 
smaller than those of IPMSM. Hence the larger P-gain 
ωˆPK  is suggested to yield higher dynamic response 
for the observed rotor position error rθ~ , and thus the 
quicker torque response of the sensorless controlled 
SPMSM drive. However, the effects of system noises 
should also be considered. Taking theses compromised 
considerations, the PI controller is chosen as: 
s
sGc 402)( +=θ                      (47) 
'qsi
r
qshi
ˆ
thωsin− rθˆ
rωˆ
r
iθ~
1ˆrω
)(sGcθ
rθ errKr
θ~
rθˆ
s
KK IP ωω ˆˆ + 1
ˆrω
rθˆ
riθ~
Hz)100( =cf
Hz)5( =cfr
qshmi
ˆ
s
KK IP ωω ˆˆ +
s
1
s
1100  
1kHz0 ==Qf
 
Fig. 43. Rotor position and speed estimation scheme based on 
d-axis high-frequency voltage injection approach: (a) estimation 
mechanism; (b) equivalent estimated rotor position tracking 
control block diagram. 
All the other parameters and controllers of the HFI 
sensorless control scheme are listed below: 
(i) Injected d-axis voltage 
(V) cos tVv hinjdsh ω= , V45=injV , 
rad/s 2000πω =h (1kHz)              (48) 
(ii) Filters 
LPF of 1dsi′  and 1qsi′ : )100159.0/(1 +s , cf =100Hz 
LPF of riθ~ : )100159.0/(1 +s , cf =100Hz 
LPF of rωˆ : )10318.0/(1 +s , cf =5Hz 
BPF of rqshi
ˆ : 
272020
0
83.6210948.3
83.62
)/(
)/(
ss
s
ssQ
sQ
++×=++ ωω
ω  
           of = 1kHz, 100=Q             (49) 
For the employed PMSM, its rated electric fundamental 
frequency is Hz100,1 =ratedf . The mechanical rotor 
position and velocity dynamic response speeds will be 
much lower than 100Hz, hence the low-pass filtering 
cut-off frequencies listed above are chosen accordingly to 
reduce the high-frequency noise effects. 
(b) Observed extended-EMF based method 
Fig. 41(c) shows the control scheme of the developed 
observed extended-EMF based sensorless PMSM drive. 
An estimated rotor δγ − frame is assumed for estimating 
the PMSM extended-EMF and the rotor position. 
The d-q axis voltage equations of a PMSM in rotor 
reference frame can be expressed as: 
⎥⎦
⎤⎢⎣
⎡+⎥⎦
⎤⎢⎣
⎡
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢
⎣
⎡
+
−+
=⎥⎦
⎤⎢⎣
⎡
exrqs
r
ds
dsqr
qrds
rqs
r
ds
Ei
i
L
dt
dRL
LL
dt
dR
v
v 0
ω
ω      (50) 
where 
  
25 
 
)(SSa
dcvdcC
1T 3T
4T 2T
5T
6T
1D
4D
3D
6D 2D
+
bSb
v
Li
aD acPoL
oC
oL
bi
bC
bP
Di 
5D
Si asi
)(DDb
oL
oC
oC
bsi
csi
cont,av
triv
1T
2T
3T
4T
5T
6T
*qsi)(sGcv
cont,bv
cont,cv
vε
eθ
'qsi
dsv
qsv
bsi
*qsmi qsmv
dsmv
'bsi
'csi
'qsi
'dsi
eθ
triv
trivdcv′
*
dcv
'asi
3/1
)(sGpll
vpε
uqev′
udev′
s
1
eθ
n
anv
bnv
cnv
abv
bcv
cav
bcv′
abv′
bnv′
cnv′
anv′
cav′
dcP
ai
bi
ci
3/1
3/1
Σ
∗Li
Li′
iεLi )(sGci cb
v
swv
∗
bv Σ )(sGcv
cI
bmb vv >b
v′
bv b
v′
Li′
aS
aSvε)(sKi
)(sKv
1T
2T
3T
4T
5T
6T
dcv
asi
)(sKv
)(sKi
)(sKv
)(sKi
)(sKv
)(sKv
*dsi )(sGci
iε
)(sGci
iε
πω 120=e0* =dev
 
Fig. 45. Schematic and control scheme of the established EV 
PMSM drive in idle G2V charging operation mode with 
three-phase AC input: (a) schematic; (b) control scheme. 
(a) Differential-mode  
s
sGcbi 36001)( += , 9.0)( =sGcfi , ssKi 51006.11
125.0)( −×+=
(59) 
s
sGcbv 108004)( += , 1)( =sGcfv , ssKv 31065.21
004.0)( −×+=
 (60) 
(b) Common-mode 
s
sGcb 75.00005.0)( += , 1.1)( =sGcfv , ssKv 31065.21
004.0)( −×+=
 (61) 
As to the DC-DC front-end converter, its voltage 
boosting control scheme and current control scheme 
shown in Fig. 46(d) have been designed in Sec. 
2.11.2.B.(b).   
2.11.4 Experimental Performance Evaluation 
A. Driving Mode Operation 
(a) Standard PMSM drive 
The measured ( '*, rr ωω ) and ( '* , qsqs ii ) of the 
established standard PMSM drive powered by 
bidirectional DC/DC front-end converter at ( 142.2Vbv = , 
400Vdcv = , LR = 150Ω ) starting from 0 to 2000rpm 
with two ramping rates are shown in Fig. 47. The smooth 
starting process is seen.  
The effects of field-weakening, commutation shift and 
voltage boosting are observed experimentally. Fig. 48(a) 
shows the measured results at ( 138.6Vbv = , 300Vdcv = , 
150LR = Ω , =*rω 3600rpm , rω = 3230rpm, 0* =dsi , 0=β ). 
The existed speed tracking error is due to the insufficient 
DC-link voltage for the PMSM under higher speed. This 
problem can be overcome via the following approaches: 
 
Σ
∗asi
asi′
iε )(sGcbi∗ABv Σ )(sGcbv
ABv′
aS
dcvdcC
1T 3T
4T 2T
5T
6T
1D
4D
3D
6D 2D
+
)(SSbb
v
Li
)( DD a oL
oC
oL
bi
bC
bP
Di 
5D
Si 
bD
oL
oC
ABv
ANv
NBv
A
B
N
)(sGcfi
Σ
)(sGcfv
Σ
*asfi
*asbivε
contfv
contbv
oC
ABZ
nZ
nC
BZ BZ
AZ
dcP LP Li
cbv
triv
asi ,1T 2T
,4T 5T
ABv
ABv′
asi′
)(sKi
)(sKv
Σ
∗
Li
Li′
∗
dcv Σ )(sGcv
dcv′
iε )(sGci cbv
swv
bSb
Svε
cbv∗ABv5.0 Σ )(sGcb
NBv′
NBv
triv 3T
6T
Σ
)(sGcf
vε
contfv
contbv
dcv )(sKi)(sKv Li )(sKv
 
Fig. 46. The established EV PMSM drive in V2H discharging mode: (a) schematic; (b) differential-mode voltage control scheme and 
current control scheme of inverter; (c) common-mode voltage control scheme of inverter; (d) control scheme of DC/DC boost front-end 
converter. 
  
27 
 
synchronous motor mode from standstill to 300rpm, then 
the operation is changed to the BDCM mode using the 
estimated rotor position.  
The EEMF observer based sensorless PMSM drive 
powered by bidirectional DC/DC front-end converter due 
to two ramp speed commands are shown in Fig. 51. And 
the measured steady-state ( rr ωω ˆ,* ),( '* , asas ii ) at 
( =*rω 2800rpm, 141.2Vbv = , 400Vdcv = , 150LR = Ω ) 
are shown in Figs. 52(a) and 52(b). 
(iii) Hybrid method 
Fig. 53 shows the measured ( rr ωω ˆ,* ) and ( qsqs ii ′,* ) of 
the developed hybrid sensorless method controlled PMSM 
drive powered by bidirectional DC/DC front-end 
converter during starting period ( rpm20000* →=rω ) due 
to the speed changing rates of 1200rpm/s and 4800rpm/s 
at ( V8.138=bv , V400=dcv , Ω= 150LR ). One can find 
that the PMSM drive can be normally operated applying 
the developed hybrid sensorless control method.  
 
*rω
*qsi
qsi′
rωˆ
)4800(rpm/s
*rω rωˆ
*qsi qs
i′
)1200(rpm/s
)4800(rpm/s
)1200(rpm/s
 
Fig. 49. Measured ( rr ωω ˆ,* ) and ( '* , qsqs ii ) of the developed 
HFI sensorless PMSM drive during starting period ( →= 0*rω  
2000rpm) due to the ramp speed commands with the changing 
rates of 1200rpm/s and 4800rpm/s at ( 139.2Vbv = , 400Vdcv = , 
150LR = Ω ). 
 
*rω rωˆ
*asi
asi′
 
Fig. 50. Measured results of the developed HFI sensorless 
PMSM drive powered by bidirectional DC/DC front-end 
converter at ( =*rω 2800rpm, 141.2Vbv = , dcv = 400V, Ω= 150LR ): (a) ( rr ωω ˆ,* ); (b) ( '* , asas ii ). 
 
 
1000
rpm
*rω
500ms
*qsi qsi′
1A
rωˆ
)4800(rpm/s
*rω rωˆ
*qsi qs
i′
)1200(rpm/s
)1200(rpm/s
)4800(rpm/s
 
Fig. 51. Measured ( rr ωω ˆ,* ) and ( '* , qsqs ii ) of the developed 
EEMF observer based sensorless PMSM drive powered by 
bidirectional DC/DC front-end converter during starting period 
( →= 0*rω 2000rpm) due to the ramp speed commands with the 
speed changing rates of 1200rpm/s and 4800rpm/s at 
( 138.8Vbv = , 400Vdcv = , 150LR = Ω ). 
 
*rω rωˆ
*asi
asi′
 
Fig. 52. Measured results of the developed EEMF observer based 
sensorless PMSM drive powered by bidirectional DC/DC 
front-end converter at ( =*rω 2800rpm, bv = 141.2V , dcv = 400V, 
LR =  150Ω ): (a) ( rr ωω ˆ,* ); (b) ( '* , asas ii ). 
 
*rω
*qsi
qsi′
rωˆ
)4800(rpm/s
*rω
rωˆ
*qsi
qsi′
)1200(rpm/s
)1200(rpm/s
)4800(rpm/s
 
Fig. 53. Measured ( rr ωω ˆ,* ) and ( qsqs ii ′,* ) of the developed 
hybrid sensorless method controlled PMSM drive powered by 
bidirectional DC/DC front-end converter during starting period 
( rpm20000* →=rω ) due to the speed changing rates of 
1200rpm/s and 4800rpm/s at ( V8.138=bv , V400=dcv , Ω=150LR ). 
 
 
 
  
29 
 
400V
140V 10V
5A
2000
rpm
20V
2s
dcv
bv
bi
rω
1200rpm/s -2000rpm/s
(a)
400V
140V
dcv
bv
bi
1800rpm/s -1800rpm/s
rω
10V
5A
2000
rpm
20V
2s(b)
400V
140V 10V
10A
3000
rpm
20V
2s
dcv
bv
bi
rω
1800rpm/s -1800rpm/s
(c)
 
Fig. 56. Measured ( rω , dcv , bv , bi ) of the developed HFI 
sensorless EV SPMSM drive powered by bidirectional DC/DC 
front-end converter due to the programmed speed rate profiles: (a) 
(1200rpm/s ↔ -2000rpm/s); (b) (1800rpm/s↔ -1800rpm/s); (c) 
reversible operation with the speed rates of (1800rpm/s ↔  
-1800rpm/s). 
 
sμ20
ABv
ABi
bi
bv
 
Fig. 57. Measured results of the established single-phase SMR 
based charger at ( === C26.0* cL II 3.64A, V400* =dcV ,VAB= 220V/ 60Hz): (a) ( vAB , ABi ); (b) ( vb , ib ). 
Table 7: Measured steady-state characteristics of the established 
single-phase SMR based charger at ( *LI = cI = 0.26C = 3.64A, 
V400* =dcV , V/60Hz220== acVVAB ) 
*LI (A) dcV (V) bv (V) bI ( A ) aciTHD PF  
3.64 401.1 148 3.59 4.99% 0.985 
acP (W) dcP (W) bP (W) 1η (%) 2η (%) η (%) 
637.45 573.77 531.32 90.01% 92.60 83.34%
 
bv
bi
sμ20
ai
anv
 
Fig. 58. Measured results of the established three-phase SMR 
based charger at ( === C26.0* cL II 3.64A, V400* =dcV , =abV 220V/ 60Hz): (a) ( anv , ai ); (b) ( vb , ib ). 
 
Table 8: Measured steady-state characteristics of the established 
three-phase SMR based charger at ( *LI = cI = 0.26C = 3.64A, 
V400* =dcV , V/60Hz220=abV ) 
 
 ai  bi  ci  dcV (V) bv (V) bI ( A )
iTHD  7.58% 7.95% 7.49% 
PF  0.989 0.992 0.991 
399.4 148 3.58 
acP (W) dcP (W) bP (W) 1η (%) 2η (%) η (%) Power and 
efficiency 627.27 567.74 530.84 90.51% 93.5% 84.63%
 
Comments: 
(i) The battery charging current ripples existed in Figs. 
57(b) and 58(b) is mainly due to the low internal 
battery resistance. One can add a small filtering 
inductor in series with the battery to reduce the ripples 
if necessary.  
(ii) The SMR based charger using the PMSM winding as 
the integrated energy storage inductors is explored. For 
a PMSM having isolated neutral, only the single-phase 
schematic is achievable. Fig. 59 shows the established 
single-phase SMR and its control scheme with AC 
110V/60Hz input, wherein mH.21.3== so LL  The 
current and voltage controllers are set as: 
s
sGci 1185058.1)( += , ssGcv
2501)( +=        (85) 
  
31 
 
(a)
(b)
*
ABv
ANv
Li
ABv
120V
5ms
5ms
120V
2A
560W460W →=LP
 
Fig. 63. Measured output voltages of the established 1P3W 
inverter by PI feedback and feedforward controls due to a step 
power change of =LP 460W to 560W at ( 400* =dcV V, =ABV 220V/60Hz, == NBAN VV 110V/60Hz): (a) ( ABAB vv ,* ); (b) ( ANv , Li ). 
 
2.11.5 Conclusions and Discussions 
This third-year project report has presented the 
development of an EV PMSM drive incorporating with 
G2V and V2H operation functions. Its power circuit 
consists of a one-lag bidirectional front-end DC/DC 
converter and a three-phase inverter. This front-end 
converter can boost the battery voltage for the followed 
inverter in discharging operations. And it can be operated 
as a buck converter to charge the battery from the mains 
and the motor when making regenerative braking.  
The experimental evaluation showed that in driving 
mode, the established standard and position sensorless 
controlled PMSM drives possess satisfactory starting, 
acceleration, dynamic and regenerative braking operating 
characteristics. In addition, the DC-link voltage boosting, 
the commutation instant tuning and the field weakening 
approaches can further enhance the performance under 
higher speeds. Since an EV must go through the frequent 
accelerating and decelerating operations under various 
terrains, the observed EEMF and hybrid methods are not 
suited for the changeover actions. Hence it is suggested 
that the HFI method is applied for EV propulsion.  
In idle condition, the power circuit of the developed 
PMSM drive is rearranged to perform the G2V PFC 
charging and the V2H inverter discharging operations. The 
good operating performances under these two modes have 
also been verified experimentally. In G2V mode, good 
charging performance and line drawn power quality are 
obtained. As to V2H mode, the 1P3W 60Hz 220V/110V 
AC outputs with good waveform and regulation 
characteristics are yielded for domestic use. In addition, 
the experimental studies indicated that the SMR in G2V 
with motor windings as energy storage inductor possesses 
better current waveform quality, but the energy conversion 
efficiency will be lower. The similar comments can also be 
made for the V2H operation with the armature windings 
being acted as the inverter output filtering inductors. For 
the established EV PMSM drive, the V2G is also 
applicable.  
 
3. 結論與討論 
本三年期計畫旨在從事 PMSM 之關鍵調控技術開
發及應用研究。已完成並提報於本期末報告之各分年工
作簡列如下： 
(1) 第一年：開發一冷凍系統，含一無位置感測弦波  
PMSM 驅動壓縮機、一無位置感測方波 PMSM 驅
動風扇及一共用切換式整流器前級。所有電力電路
之數位控制以一共同 DSP 為之。其中，所開發之
壓縮機弦波 PMSM 驅動系統之無位置感測，包括
高頻注入法、延伸反電動法、及結合兩者之混合控
制機構。並從事 PMSM 驅動系統之效能增進關鍵
事務研習，如強健電流控制 PWM、換相調控、激
磁調控、及直流鏈升壓控制等。此結合HFI及EEMF
之 PMSM 混合型無位置感測控制機構亦應用於第
三年所欲開發之電動車用 PMSM 驅動系統，探究
其應用可行性。 
(2) 第二年：開發一具 DC/DC 前端轉換器之永磁同步  
馬達/永磁同步發電機，以做為整合式啟動馬達/發
電機和飛輪系統，計畫中將以飛輪系統為主要控制
對象。計畫先使用反應輪替代，再從事較實際
PMSM 驅控飛輪系統之建構及操控。實測評估均驗
證所建兩階段儲能系統之可行性及操控效能測。 
(3) 第三年：開發一配有 DC/DC 轉換器前級之電動車
用 PMSM 驅動系統，具馬達驅動、充電(G2V)及放
電(V2H,不斷電系統輸出)整合性功能。標準控制及
無位置感測控制均已從事。實測性能評估所建具
DC-DC 前端轉換器 PMSM 驅動系統除驅動與再生
煞車基本功能外，尚具下列附屬操作能力：(a) 具
功率因數校正電池充電模式(G2V)；(b)不斷電系統
放電模式(V2H)。值得再探究之處含：再生煞車操
控性能改善及 V2G 之實作及操控。 
4. 自我評估 
截至目前，本三年期計劃所擬之各年度工作已完
成，結果提報於此期末報告各章節中。 
發表文獻  
[1] J. H. Huang, C. Y. Chen and C. M. Liaw, “An Air- 
conditioning system with sensorless PMSM driven 
compressor and cooling fan powered by common front-end 
switch-mode rtectifier,” R.O.C. 32th Symposium on Electrical 
Power Engineering, 2011, December 2-3, Taipei, Taiwan, pp. 
1593-1602. 
[2] Y. W. Lin, B. C. Lin and C. M. Liaw, “Development of a 
home microgrid with multiple sources and energy storage 
devices,” R.O.C. 32th Symposium on Electrical Power 
Engineering, 2011, December 2-3, Taipei, Taiwan, pp. 
433-441. 
[3] M. C. Chou and C. M. Liaw, “Dynamic control and 
diagnostic friction estimation for a PMSM driven satellite 
reaction wheel,” IEEE Trans. Ind. Electron., vol. 58, no. 10, 
pp. 4693-4707, October 2011. 
[4] B. C. Lin, K. W. Hu, J. H. Tseng and C. M. Liaw, “On a DC 
micro-grid with wind permanent-magnet synchronous 
generator and photovoltaic source,” R.O.C. 33th Symposium 
on Electrical Power Engineering, 2012, December 7-8, 
Taipei, Taiwan, pp. 2804-2811. 
[5] C. Y. Cheng, Y. S. Lin and C. M. Liaw, “Electric vehicle 
permanent-magnet synchronous motor drive incorporating 
with grid-to-vehicle and vehicle-to-home operation 
  
33 
 
[40] T. G. Habetler and D. M. Divan, “Acoustic noise reduction in 
sinusoidal PWM drives using a randomly modulated carrier,” 
IEEE Trans. Power Electron., vol. 6, no. 3, pp. 356-363, 1991. 
[41] C. M. Liaw, Y. M. Lin, C. H. Wu and K. I. Hwu, “Analysis, 
design, and implementation of a random frequency PWM 
inverter,” IEEE Trans. Power Electron., vol. 15, no. 5, pp. 
843-854, 2000. 
[42] B. J. Kang and C. M. Liaw, “Random hysteresis PWM inverter 
with robust spectrum shaping,” IEEE Trans. Aerospace and 
Electronic Systems, vol. 37, no. 2, pp. 619-629, 2001. 
[43] J. Y. Chai, Y. H. Ho, Y. C. Chang and C. M. Liaw, “On acoustic 
noise reduction control using random switching technique for 
switch-mode rectifiers in PMSM drive”, IEEE Trans. Ind. 
Electron., vol. 55,  no. 3, pp. 1295-1309, March 2008. 
[44] H. Murakami, Y. Honda, H. Kiriyama, S. Morimoto and Y. 
Takeda, “The performance comparison of SPMSM, IPMSM and 
SynRM in use as air-conditioning compressor,” Conf. Rec. IEEE 
IAS, 1999, vol. 2, pp. 840-845.  
[45] Y. Honda and Y. Takeda, “Technical evolution of permanent 
magnet synchronous motors for home appliances,” IEEJ Trans. 
Elect. Elctron. Eng., vol. 2, no. 2, pp. 118-124, 2007. 
[46] A. Emadi, Y. J. Lee and K. Rajashekara, “Power electronics and 
motor drives in electric, hybrid electric, and plug-in hybrid 
electric vehicles,” IEEE Trans. Ind. Electron., vol. 55, no. 6, pp. 
2237-2245, 2008. 
[47] E. Sato, “Permanent magnet synchronous motor drives for 
hybrid electric vehicles,” IEEJ Trans. Elect. Elctron. Eng., vol. 
2, pp. 162-168, 2007. 
[48] KAWAI Hirotoshi, SUNOHARA Teruhiko, TASAKA Yosuke 
and FUKASAWA Shingo, “Permanent-magnet synchronous 
motor propulsion system for Tokyo metro Ginza line trains,” 
Toshiba Review, vol. 63, no. 6, pp. 45-49, 2008. 
[49] K, Kondo and M. Kondo, “Design of the parameters of 
permanent magnet synchronous motors for railway vehicle 
traction,” The Fifth International Conference on Power 
Electronics and Drive Systems (PEDS), vol. 2, pp. 992-997, 
2003.  
[50] G. Pellegrino, A. Vagati, B. Boazzo and P. Guglielmi, 
“Comparison of induction and PM synchronous motor drives for 
EV application including design examples,” IEEE Trans. Ind. 
Appl. vol. 48, no. 6, pp. 2322-2332, 2012. 
[51] L. Chedot, G. Friedrich, J. M. Biedinger and P. Macret, 
“Integrated starter generator: the need for an optimal design and 
control approach. application to a permanent magnet machine,” 
IEEE Trans. Ind. Appl., vol. 43, no. 2, pp. 551-559, 2007. 
[52] P. Zhang, and S. S. Williamson, “Recent status and future 
prospects of integrated starter-generator based hybrid electric 
vehicles,” in Proc. IEEE VPPC, 2008, pp. 1-8. 
[53] S. Talebi, B. Nikbakhtian, A. K. Chakali and H. A. Toliyat, 
“Control design of an advanced high-speed FESS for pulsed 
power applications,” in Proc. IEEE IECON, 2008, pp. 
3358-3363. 
[54] B. Vafakhah, M. Masiala, J. Salmon and A. Knight, “Emulation 
of flywheel energy storage systems with a PMDC machine,” in 
Proc. IEEE ICEM, 2008, pp.1-6. 
[55] T. Siostrzonek and S. Pirog, “The flywheel energy storage with 
brushless DC motor the practical results1,” Power Electron. and 
Motion Control Conference, EPE-PEMC, 12th International,
2006, pp.1541-1545. 
[56] M. Van Dessel and G. Deconinck, “Power electronic grid 
connection of PM synchronous generator for wind turbines,” in 
Proc. IEEE IECON, 2008, pp. 2200-2205. 
[57] M. Yoneda, M. Shoji, K. Yongjae and H. Dohmeki, “Novel 
selection of the slot pole ratio of the PMSM for auxiliary 
automobile,” in Proc. IEEE IAS, 2006, vol. 1, pp. 8-13.  
[58] G. Sooriyakumar, R. Perryman and S. J. Dodds, “Cogging 
analysis for fractional slot/pole permanent magnet synchronous 
motors,” in Proc. UPEC, 2007, pp. 188-191. 
[59] R. Islam, I. Husain, A. Fardoun and K. McLaughlin, 
“Permanent-magnet synchronous motor magnet designs with 
skewing for torque tipple and cogging torque reduction,” IEEE 
Trans. Ind. Appl., vol. 45, no. 1, pp. 152-160, 2009. 
[60] B. Kramer, S. Chakraborty and B. Kroposki, “A review of 
plug-in vehicles and vehicle-to-grid capability,” in Proc. IEEE 
IECON, 2008, pp. 2278-2283. 
[61] S. Haghbin, S Lundmark, M Alakula and O Carlson, 
“Grid-connected integrated battery chargers in vehicle 
applications: review and new solution,” IEEE Trans. Ind. 
Electron., vol. 60, no. 2, pp. 459-473, 2013. 
[62] D. P. Tuttle and R. Baldick, “The evolution of plug-in electric 
vehicle-grid interactions,” IEEE Trans. Smart Grid, vol. 3, no. 1, 
pp. 500-505, 2012. 
[63] E. S. Dehaghani and S.S. Williamson, “On the inefficiency of 
vehicle-to-grid (V2G) power flow: potential barriers and 
possible research directions,” in Proc. IEEE ITEC, 2012, 1-5. 
[64] F. Caricchi, F. Crescimbini, F. G. Capponi and L. Solero, “Study 
of bi-directional buck-boost converter topologies for application 
in electrical vehicle motor drives,” in Proc. IEEE APEC, 1998, 
vol. 1, pp. 287-293.     
[65] Omar Hegazy, Joeri Van Mierlo and Philippe Lataire, “Design 
and control of bidirectional DC/AC and DC/DC converters for 
plug-in hybrid electric vehicles,” in Proc. POWERENG, 2011, pp. 
1-7. 
[66] Yu Du, S. Lukic, B. Jacobson and A. Huang, “A review of high 
power isolated bi-directional DC-DC converters for PHEV/EV 
DC charging infrastructure,” in Proc. IEEE ECCE, 2011, pp. 
553-560. 
[67] O. C. Onar, J. Kobayashi, D. C. Erb and A. Khaligh, 
“Bidirectional High-power-quality grid interface with a novel 
bidirectional noninverted buck-boost converter for PHEVs,” 
IEEE Trans. Veh. Technol., vol. 61, no. 5, pp. 2018-2032, 2012. 
[68] D. C. Erb, O.C. Onar and A. Khaligh, “An integrated 
bi-directional power electronic converter with multi-level 
AC-DC/DC-AC converter and non-inverted buck-boost converter 
for PHEVs with minimal grid level disruptions,” in Proc. IEEE 
VPPC, 2010, pp. 1-6. 
[69] M. A. Khan, I. Husain and Y. Sozer, Y, “Integrated electric motor 
drive and power electronics for bidirectional power flow between 
electric vehicle and DC or AC grid,” in Proc. IEEE ECCE, 2012, 
pp. 3403-3410. 
[70] Omar Hegazy, J. Van Mierlo, Philippe Lataire and M. El 
Baghdadi, M, “Integrated power electronics interface for plug-in 
hybrid electric vehicle applications,” in Proc. CIPS, 2012, pp. 
1-6. 
[71] Saeid Haghbin, Kashif Khan, Shuang Zhao, Mats Alak¨ula, Sonja 
Lundmark and Ola Carlson, “An integrated 20-kW motor drive 
and isolated battery charger for plug-in vehicles,” IEEE Trans. 
Power Electron., vol. 28, no. 8, pp.4013-4029, 2013. 
[72] F. R. Islam, H. R. Pota and  M. S. Ali, “V2G technology for 
designing active filter system to improve wind power quality,” in 
Proc. AUPEC, 2011, pp. 1-6. 
[73] R. Smolenski, M. Jarnut, G. Benysek and A. Kempski, 
“AC/DC/DC interfaces for V2G applications- EMC issues,” IEEE 
Trans. Ind. Electron., vol. 60, no. 3, pp. 930-935, 2013. 
[74] M. Yilmaz and P. Krein, “Review of the impact of vehicle-to-grid 
technologies on distribution systems and utility interfaces,” IEEE 
Trans. Power Electron., to appear, 2013. 
[75] J. H. Huang, C. Y. Chen and C. M. Liaw, “An Air-Conditioning 
System with Sensorless PMSM Driven Compressor and Cooling 
Fan Powered by Common Front-End Switch-Mode Rectifier,”
R.O.C. 32th Symposium on Electrical Power Engineering, 2011, 
December 2-3, Taipei, Taiwan, pp. 1593-1602. 
[76] Y. W. Lin, B. C. Lin and C. M. Liaw, “Development of a Home 
Microgrid with Multiple Sources and Energy Storage Devices,”
R.O.C. 32th Symposium on Electrical Power Engineering, 2011, 
December 2-3, Taipei, Taiwan, pp. 433-441. 
[77] M. C. Chou and C. M. Liaw, “Dynamic control and diagnostic 
friction estimation for a PMSM driven satellite reaction wheel,” 
IEEE Trans. Ind. Electron., vol. 58, no. 10, pp. 4693-4707, 
October 2011. 
[78] B. C. Lin, K. W. Hu, J. H. Tseng and C. M. Liaw, “On a DC 
micro-grid with wind permanent-magnet synchronous generator
and photovoltaic source,” R.O.C. 33th Symposium on Electrical 
Power Engineering, 2012, December 7-8, Taipei, Taiwan, pp. 
2804-2811. 
[79] C. Y. Cheng, Y. S. Lin and C. M. Liaw, “Electric vehicle 
permanent-magnet synchronous motor drive incorporating with 
grid-to-vehicle and vehicle-to-home operation capabilities,”
R.O.C. 33th Symposium on Electrical Power Engineering, 2012, 
December 7-8, Taipei, Taiwan, pp. 2772-2779. 
[80] K. W. Hu and C. M. Liaw, “A permanent-magnet synchronous 
motor driven flywheel storage system and its application to DC 
microgrid,” R.O.C. 33th Symposium on Electrical Power 
Engineering, 2012, December 7-8, Taipei, Taiwan, pp. 2713-2720.
 
99 年度專題研究計畫研究成果彙整表 
計畫主持人：廖聰明 計畫編號：99-2221-E-007-124-MY3 
計畫名稱：永磁同步電機驅動系統之相關節能及驅控性能增進技術開發--子計畫二：永磁同步電動機
之一些典型應用效能增進研究 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 1 1 100%  
研究報告/技術報告 1 1 100%  
研討會論文 5 5 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 12 0 100%  
博士生 1 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 1 1 100%  
研究報告/技術報告 0 0 100%  
研討會論文 1 1 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
