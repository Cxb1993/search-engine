 2
二維不規則排版系統排版參數之效益分析 
 
摘要 
本研究藉由架構於 AutoCAD 平台之二維不規則形排版系統來研究相關問題。所謂二維不規則排版
問題是一種在母材上盡量排置夠多的二維型材的程序，目標為提高母材的使用率。母材指的是原物料，
型材指的是欲切出的形狀。這是一種普遍存在於許多產業的問題，如皮革業，紙業以及造船業等。本
排版系統以點陣圖來描述不規則形狀之型材，採用最常用的 B-L-F 演算法進行排版，每種型材先進行
多種角度嘗試排版，並採最佳角度排置。本文針對排版結果的各種影響參數如單位旋轉角度、點陣圖
尺度、型材複雜度設計多種測試例進行系列探討，並歸納出一些論述提供該系統使用者參考，並希望
有助於進一步研究。 
 
關鍵字：不規則形排版、AutoCAD、B-L-F 演算法 
Abstract 
The paper focuses on the parameter analysis of two-dimensional irregular nesting problem by a nesting system 
based on the AutoCAD platform. The problem of two-dimensional irregular nesting is a kind of process to nest the 
most patterns onto a material sheet. The objective is to make the size of integral rest of the material sheet as large as 
possible when nested patterns have been cut out. This is a common problem commonly existing in many kinds of 
industry such as leather industry, textile industry, papermaking industry and ship-building industry etc. All material 
sheets and patterns are defined by bitmap representation. The B-L-F algorithm is adopted to proceed the layout of 
patterns on the material sheet. Every pattern will be laid with the best rotation to achieve the objective as far as 
possible. Several examples are tested for analyzing many parameters which apparently affect nesting results. 
According to the results, some phenomena or trends which are useful to users and helpful to further studies are 
discussed. There is still many works to do for further research.   
 
Keywords: Irregular nesting, AutoCAD, B-L-F algorithm 
 
1. 緒論 
所謂排版問題是一種在母材上盡量排置夠多的二維型材的程序，目標為提高母材的使用率。母材
指的是原物料，型材指的是欲切出的形狀。這是一種普遍存在於許多產業的問題，如皮革業，紙業以
及造船業等。二維不規則排版問題是在一已知幾何形狀及大小的物料版材(簡稱母材)上，將特定數量的不規
則形狀構件(簡稱型材)在母材上安排切割位置，並且適當地調整型材位置以緊密排列，使得母材切割後之完
整餘料面積最大。而母材使用率的高低取決於型材排置於上的緊密度，若以經驗法則及人工處理排置問題，
要排出較緊密的型材佈置版面，隨著型材與母材的外形之複雜度與數量增加，其排版之困難度越大，而現今
資訊軟硬體執行效率快速且低價的時代，隨著型材數量增多，單靠人力以經驗法則越不易排出滿意版面，因
此針對已開發的以 AutoCAD 為平台的自動排版系統，為了能瞭解本系統的性能，本研究特別設計多種測試
例進行測試，試著調整各參數來提高排版效果，更設計不同的經驗法則來瞭解其效果。 
針對型材外形，根據文獻 Hinxman[8]，可大致區分為兩類：1)矩形型材(規則型材)：可細分剪床加工用，
例如造紙、玻璃加工業[14]與非剪床加工用的[7]；2)非矩形型材(不規則型材)包括中空之型材，常用火焰切
割進行之加工業[15]。本文中所採用的自動排版系統係由作者之一所設計並與業者合作開發完成的系統，建
置於 AutoCAD 系統平台上，其功能可處理不規則與中空形的母材或型材，具即時顯示的視覺效果等功能。
所探討的排版問題，有以下幾項限制條件： 
1. 母材面積需大於所有型材面積總和，由於大塊餘料可供再使用，因此排版目標是希望型材能越緊密排列越
好。 
2. 型材必須完全置於母材外形內，方可視為排定，且排定後的型材之間不得有重疊（overlap）。 
3. 型材內簍空部份，即中空型材，可置入其他更小之型材。母材內簍空部份，即中空母材，視為破損狀況，
不得置入任何型材。 
排版問題最主要評估項目有：1)描述型材幾何形狀之精確度，2)母材使用率之排版效果，與 3)排版花費
時間。由此，型材及母材幾何形狀之描述與其在排版中是否會產生失真，以及與排版效益密切相關之排版機
制等為此排版問題的最關鍵因素。經由蒐集之相關文獻所述綜合歸納如下： 
(1)幾何形狀之描述 
描述母材及型材幾何形狀的方式大致有兩種，一種為屬 Burke[2]以及 Kim[13]使用之數學方程式描述，
 4
之前置作業，其利於排版時的位移判定以增進排版效率。於選取所需的母材、型材外形及其數目後，依型材
選取的先後做為排版順序進行排版作業，其中採用 B-L-F 演算法為排版機制。每一型材完成定位後，立即繪
製於畫面上，具有即時的視覺化效果。當排版系統於完成所有型材安排或母材無法再容納任何型材時，便結
束排版系統運作，最後顯示排版結果並輸出時間、使用率及每一型材之定位座標。本系統除適用於不規則形
母材與型材，中空型母材與型材也適用。 
2.2 幾何外形之描述 
本系統對型材及母材幾何外形的描述係以點陣圖表示法，對於曲線形狀，係先以直線逼近法在允許的誤
差下，產生一近似原圖形之多邊形，再以點陣圖表示此多邊型之外形與所包圍的區域。 
2.2.1 直線逼近法 
直線逼近法係對圓弧曲線進行直線逼近的方法，用一連串的直線線段來替代圓弧曲線，使圓弧曲線之幾
何外形轉換成一近似原圖形的多邊形如圖 1 所示。多邊形的頂點到原弧的最短距離，稱為弧的最大誤差距離
e。 
2.2.2 點陣圖表示法 
點陣圖表示法係使用許多＂點＂以矩陣方式排列來描述母材與型材的外形和所包圍區域，如圖 2(a)所示
為原始圖形，圖 2(b) 則為其點陣圖。因此，若採用的點陣圖單位越小，解析度越高，則圖面的垂直與水平
分割越密集，越能近似原圖形外形，但會增加排版過程中的處理時間。 
2.3 排版機制 
開始排版前，本系統會先執行型材旋轉機制並記憶之；在排版中，對每個型材的各種旋轉角度依據型材
重疊之判定及移動法則來確定排版位置。以下將各別詳細說明。 
2.3.1 型材之旋轉機制 
型材於母材內排版時的旋轉機制，採用任意給定之單位旋轉角度 θ，以此旋轉角度為倍數進行旋轉，型
材及其旋轉後之點陣表示圖，如圖 3 所示。因此，於排版時，得共進行 360/θ 次旋轉機制，如型材的單位旋
轉角度設定為 90 度，則有 4 個不同旋轉角度之型材排置測試，分別為 90，180，270 以及 360 度。由於本系
統採用離線方式之圖形幾何資料庫處理，因而先行得到所有預定旋轉角度的圖形，經點陣圖表示後分別儲存
於圖型幾何資料庫中。對每一型材於排版時，本系統會將所有預定旋轉角度的圖形型材試圖排置，再找出排
置後能讓邊際使用率最佳的旋轉角度，當做該型材最佳排置的位置，亦即是該型材的最佳旋轉角度 θ，下圖
4(b)即為最佳旋轉角度排置結果。 
2.3.2 型材之重疊判定及移動法則 
排版時，於含有型材之母材如圖 5(a)，欲排置之型材如圖 5(b)，於母材內移動法則為：對兩型材間之垂
向條狀點陣圖進行其空間大小比較，計算出每一垂向條狀點陣圖的重疊程度，以其中重疊最大程度的距離，
做為垂向移動的位移量，如圖 6 所示。 
2.3.3 型材排置法則 
本系統採用改良於 B-L(Bottom-Left)演算法(如圖 7 所示)之 B-L-F(Bottom-Left-Fill)演算法(如圖 8 所示)。
B-L 排置演算法以左下角為優先排置的排版模式。B-L-F 排置演算法則以左下角並具有填空功能排置的排版
模式，以增進排版母材之使用率。視型材幾何圖形左下角點為定位基準點，對應置入於母材之可行點中，如
圖 8 之左圖內粗圓點所示。對於不規則型材時，則以最左邊之條狀點陣圖之左下角點為型材定位基準點，以
置入於母材可行點中。排版時，當重疊發生，則循上一節移動法則處理，以及依上節旋轉機制做該型材最佳
排置的位置。最後向左、向下進行緊靠，則採用邊界描述法於型材，以點對它線及線對它點交叉方式，精密
地計算其間之碰撞距離，取最小距離進行型材之緊靠移動，將型材排置於母材中。 
2.4 效益評估準則 
排版系統的效益視其對母材之使用率，其內型材之間緊密程度為評估準則。本文以邊際使用率ϕ做為排
版效益之評估準則，使用率定義如下： 
tu LL /=ϕ  
若母材可排置所有型材時以此使用率為評估法則。如圖 9， uL 為型材已使用母材之水平方向的板長， tL
 6
文獻之 1/6.25，文獻中母材尺寸為 2500×1000。排列結果如圖 13(a)所示。圖 13(b)為文獻[2]排版結果。 
例 5：本例參考文獻[2]測試例 Profile9，十六種不規則形與中空形型材於規則形母材中排版。母材尺寸 1000
×500 為文獻之 1/9，文獻中母材尺寸為 3000×1500。排列結果如圖 14(a)所示。圖 14(b)為文獻[2]排版結
果。 
由例 3、4、5 知，使用密度低於文獻[2]約 2%~5%，比例放大實際大小相同後，邊際長度差約 20~90 單
位，結果大致上可接受。 
 
z 不規則形母材： 
基於業者常有餘料再利用的情形，因此設計本類測試例。由於母材的切割邊不規則，特定義排版後的使
用密度為：不規則形母材使用密度=所有排入型材的總面積/(母材總面積－(母材水平長度－邊際長度)×母材
垂向長度)。 
 
(1)規則形型材之排版： 
例 6：五種正方形型材於不規則形母材中排版，排列結果如圖 15 所示。型材可依母材不規則部分，排置 30
度倍數之旋轉角，因此此類排版單位旋轉角度可設定在 90 度以下。由圖 15 可看出，本系統充分運用
母材的每個角落。 
例 7：矩形型材於不規則形母材中排版，排列結果如圖 16 所示。狹長之規則形型材，排版時最佳方位僅有 0
度及 90 度兩種選擇，對於單位旋轉角度設在 30~90 度之間，會造成邊際長度過大而結果較差，因此本
例中單位旋轉角度可設為 90 度。 
 
(2)不規則形型材之排版： 
例 8：排列結果如圖 17 所示。 
例 9：排列結果如圖 18 所示。 
 
從例 1 到例 9，可看出本系統不論規則形或不規則形的母材或型材，都可進行排版，其結果就實用角度
看，也令人滿意，而排版所費時間也很短。其中例 5 和例 9 是因為型材中空部分沒有夠小的型材可排入而無
法再利用，致使使用密度低。 
3.2 單位旋轉角度對於排版的影響 
本節試圖瞭解單位旋轉角度與型材形狀的關係，以下特別設計三種型材：(1)較接近圓形，(2)狹長形(長
寬比≧2)，(3)極端不規則形。並以圓形母材來測試型材在曲線邊緣之排版。 
例 1：型材為內接圓半徑(20AutoCAD 單位)之正五邊形型材，排置於一半徑 400AutoCAD 單位圓形母材中。
對型材個數為 50、100、150、200 與 250 五種，以及使用 360、90、60、30、15、5 與特殊角 108 度等
七種單位旋轉角度，進行測試並分析結果，分別繪出其排版時間及其效益圖，如圖 19、20 所示。 
由圖 19 的資料顯示，型材個數與排版時間近呈線性正比關係，而單位旋轉角度越小其排版花費時間
曲線線段斜率越大；由圖 20 顯示，接近圓形之正五邊形其單位旋轉角度於 60 度以下稍佳且相近，但總
體來看 108 度為最佳，因正五邊形內角為 108 度，型材與型材間較能緊密間排列，因此較接近圓形之型
材可以 30~60 度或觀察其外形找尋特殊角為單位旋轉角度。 
例 2：此例型材為模仿鞋墊之不規則形如圖 21，其型材面積大小接近於上例正五邊形型材，排置於一半徑
400AutoCAD 單位圓形母材中。所有參數設置同上例，僅改變型材形狀，方便比對兩例測試結果。 
由排版時間圖 22 得知型材數量與排版時間近呈線性遞增關係，若單位旋轉角度之取用越小，此線性
關係函數斜率越大。對於近似於圓形的正多邊形，若單位旋轉角度越小，其效益差距越不明顯且排版時
間更多，適當的旋轉角度以本文測試例效益圖 23 顯示，以 30 度為最適當。而較狹長之鞋墊形狀於單位
旋轉角度 30~90 度時，不同型材數之使用率近呈水平無太大變化，排版時間也相當接近，代表此區間之
單位旋轉角度倍數不適用於排列較狹長型材，僅試圖排置，但因邊際使用率較差而跳過此角度之倍數角；
15~30 度微調對於此類型材較有作用，但 15 度時排版時間較 30 度甚多，因此建議每此旋轉角度以 30 度
為較恰當，30 度以上之大旋轉角度較無作用也無須考慮。 
例 3：此例挑選一較複雜之不規則形型材，為 Profile9 中型材“h＂，其形狀較為狹長，型材面積大小接近於
例 1 之正五邊形型材，排置於一半徑 400AutoCAD 單位圓形母材中。所有參數設置同上例，僅改變型材
形狀，方便比對兩例測試結果。 
由圖 24 得知排版時間如上兩例近呈線性發展，但因形狀複雜影響排版時間皆偏高，且 5 度時型材
100 塊排版時間就已超出一分鐘，較上兩例多出許多，而使用率方面，如圖 25 也因型材關係，以 5 度為
最佳，但以排版時間與使用率兩相權衡下，建議以 15 度為較佳。 
 8
3.6 造船排版實例測試 
本測試以兩種船廠排版實例來進行，測試時搭配禁制搜尋法(tabu search)進行簡單優化，結果如圖 32 和圖 33。
各圖中的最上層顯示近乎完美的人工排版結果；中層圖所示為優化前先人工排定的大塊型材，以免結果太
差；而下層圖所示為優化後的排版結果。由這兩例看出優化結果不如人工排版結果好，主因在本排版系統的
目標函數是邊際長度愈短愈好，使得排版時盡量將型材豎起擺放，不會選擇水平橫放，加上受限母板高度(垂
向長度)，因此結果不理想。 
4. 討論與未來展望 
4.1 討論 
經由一系列測試後，對於本排版系統的性能分述如下︰ 
1. 不論母材或型材為規則形或不規則形，都能有令人滿意的結果。 
2. 針對大量的單種型材，單位旋轉角度設定與其外形有關。以大量的單種型材正五邊型為例，以其內角設為
單位旋轉角度，效果最好。單位旋轉角度設定太小會增加排版時間。 
3. 點陣圖尺度越小越能精確描述原圖形但會增加排版時間，而測試結果顯示點陣圖尺度並非越小越好。這是
因為本系統在排版時，每個型材的局部最佳排置不一定會導致全排版的最佳結果，也是大多數排版機制的
特性。 
4. 形狀複雜度高(外形鋸齒狀複雜或有中空)的型材，排版時間較長，可以適度簡化形狀或組配方式來縮短排
版時間及達到理想排版結果。 
5. 各種排版經驗法則中，根據測試以型材面積由大到小做為排版順序的排版結果最好，並且排版順序對排版
結果的影響很明顯。 
6. 船廠的二維排版問題，不同於其他業界，不僅型材有大到接近母材或是長度超果母板垂直高度的長條形
狀，使得本排版系統無法自動排出滿意的結果，需利用人工組配經驗以產生較好的排版結果。 
7. 本系統因建置於 AutoCAD 系統平台上，排版完成後可輸出 DXF 圖形檔案格式，便於後續加工處理，有助
於本系統與其他軟體的銜接與搭配。 
4.2 未來展望 
研究過程中，測試二維不規則排版系統時，亦遭遇一些問題，為未來改善的方向及展望： 
1. 型材排版順序對排版結果影響很大，未來考慮以 VBA(Visual Basic Application)為本系統開發遺傳演算法
(genetic algorithms)或禁制搜尋法(tabu search)來優化型材排版順序。 
2. 造船廠的二維排版問題，部份型材長度接近母材長度，讓其先手動安排固定後，才使用本系統讓其餘型材
由面積大到小依序排入結果較接近完全手動排版結果，但效果仍較後者差，有待後續討論分析。 
5. 參考文獻 
1. Bennel, T.A., K.A. Dowsland, W.B. Dowsland,”The Irregular Cutting-stock problem-A new Procedure for 
Deriving the No-fit Polygon”, Computers and Operations Research, Vol. 28, pp. 271-287(2001). 
2. Burke,E.K., R.S.R. Heller, G. Kendall and G. Ehitwell,”A New Bottom-Left-Fill Heuristic Algorithm for the 
Two-Dimensional Irregular Packing Problem”, Operations Researsh Vol.54, pp.587-601 (2006). 
3. Dagli, C. H. & Poshyanonda, P. (1997). New approaches to nesting rectangular patterns. Journal of Intelligent 
Manufacturing 8: 177–190. 
4. Davis, L. (1985). Applying adaptive search algorithms to epistatic domains. In Proceedings of the 9th 
International Joint Conference on Artificial Intelligence, 162–164. Los Angeles. 
5. Dyckhoff, H. (1990). Typology of cutting and packing problems. European Journal of Operational Research 44: 
145-159. 
6. Fujita K., Akagji, S. & Kirokawa, N. (1993). Hybrid approach for optimal nesting using a genetic algorithm and 
a local minimisation algorithm. In Proceedings of the 19th Annual ASME Design Automation Conference 1: 
477–484. Albuquerque, NM, USA. 
7. Healy, P.M. Creavin, A. Kuusik,”An Optimal Algorithm for Rectangle Placement”, Operation Research Letters, 
Vol. 24, pp. 73-80 (1999). 
8. Hinxman, A. I. (1980). The trim loss and assortment problems. European Journal of Operational Research 5: 
8-18. 
9. Hopper, E. & Turton, B. C. H. (1999). A genetic algorithm for a 2D industrial packing problem. Computers in 
Engineering 37: 375–378. 
10. Hopper, E. & Turton, B. C. H. (2000). An Empirical Investigation of Meta-heuristic and Heuristic Algorithms 
for a 2D Packing Problem. European Journal of Operational Research 128(1): 34–57 
 10
    
 允許弧最大之誤差值
 
 
 
 
 
 
 
 
 
 
 
                                                           (a)                     (b) 
 
圖 1 圓弧直線逼近之允許誤差示意圖                   圖 2 型材之點陣圖表示分割示意圖 
                                 
 
      (a)             (b)                                    (a)            (b) 
                                                      圖 5 已排置型材之母材與欲排置之型材 
 
     (c)           (d) 
圖 3 原型材及其旋轉後之點陣圖表示                      圖 6 型材於母材內移動法則 
 
        
圖 7  B-L 演算法示意圖 
      (a)                 (b)                  
 
      (c)                 (d)                            圖 8  B-L-F 演算法示意圖 
圖 4 最佳旋轉角度排置示意圖 
 12
60
65
70
75
80
85
90
95
100
0 0.5 1 1.5 2 2.5 3 3.5 4
解析度(log)
邊
際
使
用
率
(%
)
0
1
2
3
4
5
6
7
8
0 0.5 1 1.5 2 2.5 3 3.5 4
解析度(log)
時
間
(秒
)
 
圖 21 單位旋轉角設為 5 度，250 個型材的排版結果 
 
 
 
圖 25 單位旋轉角設為 5 度，250 個型材的排版結
果 
0
5
10
15
20
25
30
35
40
50 100 150 200 250
型材個數
花
費
時
間
(秒
)
360度
90度
60度
30度
15度
5度
 
圖 22 不同型材個數與單位旋轉角度之排版時間 
                                                   圖 26 不同的解析度與排版效率 
10
20
30
40
50
60
70
5 15 30 60 90 360
單位旋轉角度(deg)
邊
際
使
用
率
(%
) 50個
100個
150個
200個
250個
 
圖 23 不同型材個數與單位旋轉角度之邊際使用率 
 
圖 27 不同的解析度與排版時間 
 
0
50
100
150
200
250
300
350
50 100 150 200 250
型材個數
花
費
時
間
(秒
)
360度
90度
60度
30度
15度
5度
 
圖 24 幾種不同型材個數與旋轉角度之排版時間 
 
 
 14
圖 32 船廠實例一及優化結果 
 
 
 
圖 33 船廠實例二及優化結果 
 
 
 
 
 
