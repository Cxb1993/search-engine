determination of a stroke. Finally, we will realize a 
new generation of AVerPens with the two innovative 
functions: (1) compensation of pen-holding postures 
and 2) determination of the start and end points of a 
stroke in a two-dimensional writing plane. To 
accomplish the aforementioned objectives, four 
research topics were executed in this year: 1) 
develop a portable inertial-sensing system for 
detecting handwriting motions and compose it with 
advanced hybrid design theories and approaches of 
single chip microcontrollers to extend the overall 
efficiency. 2) Develop pen-holding posture 
compensation algorithm in two-dimensional space with 
high accuracy and performance. 3) Develop start/end 
point determination algorithm in two-dimensional 
space with high accuracy and performance. 4) Realize 
an interactive digital pen which is capable of 
writing in two-dimensional space without any external 
device or writing ambit limitations. 
英文關鍵詞： Handwriting motion detection, inertial sensing, pen-
holding posture compensation algorithm, start/end 
point determination algorithm, human-computer 
interaction, AVerPen 
 
                                                                                      共 8 頁  第 1 頁 
研究摘要： 
本計畫旨在由圓展科技股份有限公司之研發人員及本計畫主持人之研發團隊共同合作開發以慣
性感測元件為基礎之手寫技術，用以改善圓展公司之互動式電子筆產品(AVerPen)中現有的技術缺點。
此技術開發之主要目的為整合慣性感測技術及開發相關慣性訊號演算法，使得 AVerPen 成為具有握筆
姿態補償及提筆斷字偵測功能。本年度計畫的首要工作為整合慣性感測系統與單晶片系統形成具即時
運算功能之互動式電子筆；其次，我們將利用該電子筆研發高運算效率之軟韌體混合設計方法實現高
效能、低誤差的握筆姿態補償及提筆斷字偵測演算法。針對上述工作目標，本年度計畫之執行重點為
(1)開發手部動作感知之可攜式慣性感測系統，並結合單晶片系統之高階的軟硬體混合設計理論與方法
來提升整體效能、(2)開發高效能、低誤差之握筆姿態補償演算法、(3)開發高效能、低誤差之提筆斷字
偵測演算法及(4)實現具二維平面書寫握筆姿態補償及提筆斷字偵測之互動式光學/慣性電子筆。最後，
我們希冀藉由此產學計畫案的執行，有效整合學術界與產業界的研發能力，共同開發具市場競爭力之
創新技術，以開創國內在相關手寫輸入裝置技術獨步領先全球之技術，同時也為國內相關產業培養人
才、加速產業之技術升級，增加產品附加價值。 
 
人才培育成果說明： 
因本計畫旨在經由電路硬體架構、理論開發及實際應用三個階段來設計開發以人體手部動作慣性
感測整合現階段市售手寫輸入裝置之人機互動介面。在人才培育成果方面，本計畫主持人之研發團隊
已經培養出 1 名博士、2 名碩士，服務於學術界與業界；另有 1 名博士後研究員、2 名博士班學生及 4
名碩士班學生正在本研究團隊當中進行以慣性感測技術為基礎之手寫技術開發；而在圓展科技公司方
面，包含了 1 名副理、3 名工程師亦參與本產學合作計畫之相關產品開發。其研發人員可獲得之訓練
將涵蓋: 
1. 慣性感測技術之手寫技術理論開發： 
本計畫執行至今已成功研發以慣性感測訊號為基礎之握筆姿態補償與提筆斷字偵測演算法，並將其
應用於互動式電子筆(AVerPen)當中。 
2. 研究成果結合實務需要： 
在研究方法與理論完成驗證與模擬後，可將相關人體手部動作相關慣性感測演算法整合於互動式
電子筆(AVerPen)，並可在開發不同實務應用及產品化時可快速地將本計畫之研究成果與實務需要進
行整合。 
3. 提升參與計劃工作人員之電路設計技術： 
經由本計畫相關技術的探討及實際電路設計，將可培養出慣性感測電路設計、演算法開發、單晶片
系統設計、慣性訊號處理、人機互動介面及手寫輸入裝置設計之人才，進而達到有效提昇所有參與
計劃之研發人員素質，並累積後續以硬體實踐人體手部動作慣性感測系統之技術開發及手寫輸入裝
置產品化設計能量。 
 
技術研發成果說明： 
本研究團隊花費了 8個月的努力完成開發第二代互動式電子筆(AVerPen II)及以慣性感測技術為基
礎的握筆姿態補償與提筆斷字偵測兩項技術，在進度上大幅地超前原先所預估的進度(原先預估約需
12~15 個月方可完成)。在握筆姿態補償方面，第二代互動式電子筆可以有效地克服因為使用者握筆姿
態的偏斜導致光學景深高度的問題，進而將變形書寫軌跡加以補償；補償後的書寫軌跡將不受使用者
握筆姿態之影響，完整地呈現使用者所書寫之軌跡。在本技術驗證方面，我們利用Windows 7內建Tablet 
PC 手寫辨識系統進行書寫文字辨識，其辨識率可高達到 99.3%。在提筆斷字偵測方面，第二代互動式
電子筆可以有效地克服因提筆而離開二維平面造成螢幕游標無法因手部移動而產生移動的問題，進而
                                                                                      共 8 頁  第 3 頁 
表 1 本年度計畫之進度自評 
 100 年度 備註 
第 
1 
月 
第
2
月 
第
3
月 
第
4
月 
第
5
月 
第
6
月 
第
7
月 
第
8
月 
第
9
月 
第
10
月 
第
11
月 
第
12
月 
A 可攜式慣性感
測電路製作 
預定             較原預定進度超前 2 個月完成。 
   
完成             
 
B 書寫軌跡重建
演算法開發 
預定             較原預定進度超前 4 個月完成。 
  
完成             
 
C 握筆姿態補償
演算法開發 
預定             較原預定進度超前 3 個月完成。 
  
完成             
  
D 提筆斷字偵測
演算法開發 
預定             較原預定進度超前 3 個月完成。 
  
完成             
  
E 互動式光學/慣
性電子筆之握筆
姿態補償功能實
現 
預定             較原預定進度超前 3 個月完成。 
  
完成             
  
F 互動式光學/慣
性電子筆之提筆
斷字偵測功能實
現 
預定             較原預定進度超前 3 個月完成。 
  
完成             
  
G 人機互動介面
開發 
預定             較原預定進度超前 3 個月完成。 
  
完成             
 
H 互動式光學 /
慣性電子筆之產
品設計開發 
預定             較原預定進度超前 3 個月完成。 
  
完成             
  
I 期中報告書撰 預定             較原預定進度超前 3 個月完成。 
                                                                                      共 8 頁  第 5 頁 
2 之結果呈現，當互動式電子筆為結合握筆姿態補償技術時，其光學感測器會因為使用者握筆姿態的
偏斜導致光學景深高度的問題，進而造成書寫軌跡的變形。然而當互動式電子筆加入握筆姿態補償技
術後，其補償後之書寫軌跡將不受使用者握筆姿態之影響，完整地呈現使用者所書寫之軌跡，進而大
幅改進互動式電子筆在移動或文字書寫上的便利性。 
 
 
 
 
(2) 提筆斷字偵測技術 
    提筆斷字偵測演算法分為以下兩個階段：(1)慣性/光學感測訊號收集：透過可攜式慣性感測系統
的客戶端將慣性訊號及光學訊號傳輸至電腦接受端進行訊號處理及運算及(2)提筆斷字偵測演算法：透
過可攜式慣性感測系統的電腦接收端進行慣性感測器校正、慣性感測訊號濾波、提筆偵測、姿態估測、
座標轉換與重力補償、軌跡重建等六個階段來進行提筆斷字偵測並獲得位移變化量，如圖 3 所示。圖
4 為互動式電子筆提筆斷字書寫之範例說明，其中使用者自由握持互動式電子筆進行依序書寫數字
1(左上) 2(中下) 3(右上) 4(右下) 5(中上) 6(左下)的二維平面書寫與提筆斷字/換行移動之任務，
當互動式電子筆進行二維平面書寫時，會利用握筆姿態補償技術進行書寫軌跡的補償；而當提筆換行
移動時，則是利用提筆斷字偵測技術來加以估測電腦滑鼠游標位移變化量，形成螢幕游標的移動位移。
當互動式電子筆未使用提筆斷字偵測技術進行書寫時，我們看到其書寫軌跡(數字 1~6)皆可以利用握
筆姿態補償技術進行軌跡補償而獲得真實書寫軌跡；但是其書寫軌跡會因為互動式電子筆中光學感測
器無法偵測滑鼠移動的距離而重疊在一起，進而造成使用者書寫上的不便，如圖 5 所示。若互動式電
 
圖1 握筆姿態補償演算法流程圖。 
 
 
圖 2 互動式電子筆二維平面書寫數字 2 軌跡示意圖。 
                                                                                      共 8 頁  第 7 頁 
 
 
可利用之產業及可開發之產品： 
第二代電子式互動筆包含感測器端及電腦接收端。為了達到方便使用者手寫時慣性與光學訊號記
錄及後端分析的目的，在感測器端硬體端結合了三軸加速度計、三軸陀螺儀、三軸磁力計與光學感測
器，配合單晶片內建之 I2C 介面取樣加速度計、陀螺儀和磁力計的慣性訊號以及光學感測器所產生的
光學訊號，再透過單晶片內建無線射頻收發器發送。同時電腦接收端透過由單晶片所控制的無線射頻
收發器接收，經由 USB 介面連接至個人電腦，以此方式進行資料傳輸。在本計畫中有關手寫慣性訊
號及光學訊號記錄實現於單晶片的過程主要有下列二個步驟：(1)慣性訊號和光學訊號來源與微控制器
訊號處理：為了準確獲得書寫時所需要的取樣率，在計畫所開發的可攜式慣性感測系統以單晶片內建
的 CPU 所提供的計時器(Timer)設計出所需要的取樣率。當每一次的系統取樣週期到來時，系統的 I2C
介面將加速度計、陀螺儀與磁力計以及光學感測器的訊號取樣，並透過晶片內建的無線射頻收發器輸
出。(2)傳輸模式：感測器端利用單晶片內建無線射頻收發器將資料即時輸出，然後由電腦接收端利用
單晶片控制無線射頻收發器即時接收，經由 USB 介面傳輸至電腦進行即時性的握筆姿態補償與提筆
斷字偵測演算法之運算。圖 7 為第二代互動式電子筆。其可用應於會議簡報、課堂教學、視聽娛樂、
家電遙控等相關產業。 
 
 
 
 
圖 6 互動式電子筆使用提筆斷字偵測演算法技術之書寫結果。 
 
圖 7 第二代互動式電子筆。 
表 C012A-3                                                                                      共 5 頁  第 1 頁 
計畫查核點自評表（請逐年填列） 
一、本表為本計畫重要審查資訊，本表之期程可視產學合作計畫執行情況予以設定。(例如按月別、季別、半年別等均可)。 
（第一年） 
重要
工 
作項
目 
查核內容概述（力求量化表示） 廠商參與情形概述 
期程一 
(第1-3
月) 
期程二 
(第4-7月) 
期程三 
(第7-11月) 
期程四 
(第11-12月) 
期程一 
(第1-3月) 
期程二 
(第4-7月) 
期程三 
(第7-11月) 
期程四 
(第11-12
月) 
A 
可攜式慣
性感測電
路製作 
   
提供可攜式
慣性感測電
路製作技術 
   
A1 
第1月─慣
性感測電
路製作 
   
協助慣性感
測電路布局
與製作 
   
A2 
第2月─光
學感測電
路製作 
   
協助慣性感
測電路布局
與製作 
   
A3 
第3月─可
攜式感測
電路製作 
   
協助可攜式
慣性感測電
路布局與製
作 
   
A4 
第4月─應
用程式開
發 
   
提供應用程
式開發軟體 
   
B  
書寫軌跡重建演算法開
發(以10公分*10公分手寫
範圍為例，總誤差約為
15%) 
   
協助書寫軌跡重建演算
法實驗與驗證，並提供市
場需求以改善演算法之
精確度 
  
C  
握筆姿態補償演算法開
發(軌跡偏移角度誤差約
15%或書寫文字辨識率提
升20%) 
   
協助握筆姿態補償演算
法實驗與驗證，並提供市
場需求以改善演算法之
精確度 
  
D  
提筆斷字偵測演算法開
發(提筆換行以10公分*10
公分為例，總誤差約為
15%) 
   
協助提筆斷字偵測演算
法實驗與驗證，並提供市
場需求以改善演算法之
精確度 
  
表 C012A-3                                                                                      共 5 頁  第 3 頁 
A 
互動式慣性電子筆之
書寫軌跡重建演法實
現(以 10 公分*10 公
分*10 公分之三維
空間手寫範圍為
例，相對誤差約為
25%) 
      
協助互動式慣性
電子筆書寫軌跡
重建演算法實驗
與驗證，並提供
市場需求以改善
演算法之精確度 
      
B  
三維空間資料
處理演算法開
發 
      
協助互動式慣性
電子筆三維空間
資料處理演算法
實驗與驗證，並提
供市場需求以改
善演算法之精確
度 
     
B1  
第 2月─三維
空間資料降維
演算法開發
(資料量降低
約50%) 
      
協助互動式慣性
電子筆三維空間
資料降維演算法
實驗與驗證，並提
供市場需求以改
善演算法之精確
度 
     
B2  
第 2月─三維
空間虛擬平面
配適演算法開
發 (配適平面
角度誤差約為
15%) 
      
協助互動式慣性
電子筆三維空間
虛擬平面配適演
算 法 實 驗 與 驗
證，並提供市場需
求以改善演算法
之精確度 
     
C   
室內
定位
系統
開發 
      
協 助
建 構
室 內
定 位
系統 
    
D    
軌 跡
重 建
投 影
系 統
開發 
      
協 助
建 構
軌 跡
重 建
投 影
系統 
   
E     
文字符號
辨識系統
開發 ( 辨
      
協 助
建 構
文 字
  
表 C012A-3                                                                                      共 5 頁  第 5 頁 
1. 手持光學感測裝置之書寫字型矯正方法。 
2. 手持光學感測裝置之書寫位移技術。 
本計畫在第二年執行期間預計產生之發明專利如下： 
1. 慣性與光學感測之混合手寫輸入系統。 
2. 凌空手寫軌跡重建方法及其裝置。 
3. 互動式數位教學裝置及其系統。 
本計畫開發之握筆姿態補償技術、提筆斷字偵測技術更可與其他感測技術之手寫輸入裝置進行整合，配合本產學計畫所產出之專利，相信可以增加
相當可觀的產值。更進一步地，本產學計畫所開發之慣性感測技術更可應用於會議簡報、課堂教學、視聽娛樂、家電遙控及家庭看護中，我們希冀
其可提供更多的商業價值。 
 
待本計畫執行完成後，所建構之以慣性感測為基礎之互動式電子筆及其人機互動介面，可成為具有下列多功能的研究或產業平台。 
1. 結合本計畫所開發出之慣性感測電路模組，可進行各種形式的人體動作慣性感測之相關研究。 
2. 此可攜式慣性感測系統平台同時具有整合慣性感測元件與光學滑鼠感測器之嵌入式系統及人體動作慣性感測演算法之電腦端，任何有關人體動
作慣性感測的新應用皆可快速地以軟體或硬體的方式建構在此系統平台上，以此人體動作慣性感測系統進行測試和驗證。 
3. 透過本計畫所開發與發佈的人體動作慣性感測演算法函式庫，有利於將來從事相關研究與教學之研究人員與工程師的使用，並加速相關領域的
技術發展及產品實現。 
4. 透過本計畫所開發之第二代互動式電子筆：“互動式光學/慣性電子筆”，除具有第一代互動式電子筆(AVerPen)之功能，同時整合電子白板、投票
系統、無線手寫板及無線簡報筆等教學科技相關領域；其更可讓使用者在二維平面任意書寫時具有握筆姿態補償與提筆斷字偵測之功能。此產品
為目前市場中前所未有且同時整合慣性感測與光學感測技術之手寫輸入裝置，相信對於產業界開發人機互動介面相關技術方面是一大進展。 
5. 透過本計畫所開發之第三代互動式電子筆：“互動式慣性電子筆”，除具有第一代互動式電子筆(AVerPen)之多功能，亦具有第二代互動式光學/慣
性電子筆之握筆姿態補償與提筆斷字偵測之功能；其更讓使用者在三維空間中可任意進行書寫，並藉由慣性感測軌跡重建技術將使用者手部在三
維空間的運動軌跡加以重建。在目前市場中尚未有此類手寫輸入裝置的產品，相信對於產業界開發人機互動介面相關技術方面是一個新世代的突
破。 
6. 台灣目前在教育領域方面正朝向數位化教學的目標前進，相信透過本計畫所開發之互動式電子筆並結合台灣本身具有 3C 產品製造能力的優勢，
其能夠加速國家在數位化教學方面的腳步，希冀有朝一日能夠取代現行之雷射筆、電子白板等教學器材，提供學童在會議簡報、課堂教學上更人
性化的人機互動介面。 
7. 本計畫研發之相關人機互動介面加以整合及產品化，希冀有朝一日能夠取代現存的鍵盤、滑鼠及手等人機介面輸入裝置，提供人類在視聽娛樂、
家電遙控及家庭看護等的人機互動介面的新思維。 
國科會補助計畫衍生研發成果推廣資料表
日期:2012/03/06
國科會補助計畫
計畫名稱: 互動式電子筆：以慣性元件為基礎之手寫技術開發(1/2)
計畫主持人: 王振興
計畫編號: 100-2622-E-006-025-CC2 學門領域: 系統整合與工業應用 
研發成果名稱
(中文) 手持光學感測裝置之書寫字型矯正方法
(英文)
成果歸屬機構
國立成功大學 發明人
(創作人)
王振興,鄭秉恩,許煜亮
技術說明
(中文) 目前市場較消費者青睞的電子筆為光學式手寫筆，其主要是利用光學滑鼠中的光
學感測器來進行手寫筆在書寫平面上的位移偵測，其原理與光學滑鼠一致且不須
開發任何人機介面軟體即可非常容易地將移動軌跡資訊轉換為操控滑鼠鼠標的訊
號；但卻因為每個使用者的握筆姿態皆不同，而嚴重影響到光學感測器中LED照
射到平面的景深與感測器座標軸向，造成位移解析度的不同及軌跡在角度上的偏
差，進而造成書寫文字的變形。本技術利用一姿態感測模組所感測之訊號來對光
學感測器所感測之光學訊號因每個使用者握筆姿態不同，進而造成書寫文字變形
的情況，來進行書寫時握筆的姿態補償，使光學式手寫筆在使用上變得更自由與
直觀。
(英文) This know-how presents an inertial-sensor-based technology to compensate for pen-
holding postures.
產業別 資訊服務業
技術/產品應用範圍 課堂教學、會議簡報、多媒體娛樂系統、互動式輸入介面、手寫輸入裝置
技術移轉可行性及
預期效益
未來可技轉對象為圓展科技(AVerMedia)、羅技公司(Logitech)、蒙恬科技、安諾拓科技
公司(Anoto)、地球種子應用科技(BENEVO Technology Co., Ltd.)、Wacom公司
註：本項研發成果若尚未申請專利，請勿揭露可申請專利之主要內容。
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
1.原計畫預定 100 年度產出兩篇專利、一篇 SCI 期刊論文與兩篇國際研討會論
文。 
2.本計畫 100 年度產出三篇 SCI 期刊論文、兩篇國際研討會論文與一項既有成
果授權，另有兩篇專利預計於 101/5 送審。 
3.實際產出較原預計產出多產出兩篇 SCI 期刊論文與一項既有成果授權。 
4.既有成果授權：圓展科技股份有限公司，權利金新台幣 100 萬元整。 
 
 
 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
