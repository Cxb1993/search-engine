 I
中文摘要 
在本計劃中，我們探討與極寬頻 (Ultra-wideband, UWB) 通訊系統與正交分
頻多工 (Orthogonal Frequency Division Multiplexing, OFDM)／正交分頻接取 
Orthogonal Frequency Division Multiple Access, OFDMA) 系統相關的技術問題，
並發展出相關的模擬工具與效能提升技術。IEEE 802.15.SG3a 所提出的 UWB 通
道模型可以做為模擬學術研究上所提出新理論的測試環境，或是作為實際硬體製
作的系統效能測試環境。在本計劃中，我們深入了解 UWB 通道模型與其特性，
並在 DSP 板上實現此通道模型。此 DSP 通道模擬器將提供一個硬體通道模型，
有助於硬體製作過程的系統效能測試。針對極寬頻通訊系統，我們提出一個利用 
Kasami 序列來提高傳輸速率與降低干擾的新理論；和其他利用直序展頻序列作
調變的系統相比，我們所提出的方法可獲得較佳的頻寬使用效能。另外針對
MB-OFDM 與傳統 OFDM/OFDMA 系統，我們研究數個與無線傳輸效能改善與
優化的相關議題，包括通道增益估測、載波頻率偏移估測、訊號峰均功率比值降
低、具干擾消除的頻率偏移估測、及軟性交遞之訊號分集等議題。我們利用時域
冗餘特性的引入，我們提出具適應性選擇與取代之通道增益估測方法，可以部份
或是完全的消除時域上的干擾訊號，適用於存在多重接取干擾的環境，並大幅度
提升通道估測的效能。在載波頻率偏移估測問題上，我們提出一個新的資料載波
協助式頻率偏移估測方法，可以改善載波頻率偏移估測的準確性。訊號峰均功率
比值偏高一直是OFDM系統的一個重要問題，基於部分傳輸序列 (partial transmit 
sequence, PTS) 技術，我們提出一個採用非均勻式相位序列以降低訊號峰均功率
比值的技術，有效進一步降低訊號峰均功率比值。透過結合載波間干擾 
(inter-carrier interference, ICI) 消除的技術，我們提出一個新的頻率偏移估測方
法；此方法可以逐步改善估測效能，逼近無載波間干擾情況下的最佳效能。最後，
我們提出一個針對軟性交遞之分集結合技術，透過選擇適當的取樣頻率與 DFT 
(discrete Fourier transform) 的大小，不同頻段的訊號可以結合，實現軟性交遞的
接收。  
 
關鍵詞：Saleh-Valenzuela 模型，通道模型，Kasami 序列，直序展頻序列，正交
分頻多工，極寬頻，通道估測，載波頻率偏移，峰均功率比值，載波間干擾，軟
性交遞 
 
 III
目        錄 
 
1. Introduction............................................................................................1 
2. UWB Channel Model ............................................................................4 
2.1 Path loss model................................................................................4 
2.2 Multipath model...............................................................................4 
2.3 Channel characteristics desired to model .......................................7 
3. UWB Channel Emulator......................................................................12 
4. Kasami Code-Shift-Keying Modulation for Ultra Wideband 
Communication Systems .....................................................................15 
4.1 Preliminaries...................................................................................16 
4.2 Modulation and Demodulation Schemes ........................................21 
4.3 System Performance .......................................................................26 
5. Adaptive Channel Estimation for MB-OFDM Systems in Multi-access 
Interfering Environments.....................................................................42 
5.1 System and Channel Models..........................................................42 
5.2 Adaptive Channel Estimation Schemes .........................................47 
5.3 Performance Analysis....................................................................51 
5.4 Performance Evaluation................................................................57 
6. Data-carrier Aided Carrier Frequency Offset Estimation for OFDM 
Systems ................................................................................................64 
6.1 System and Channel Models ...........................................................65 
6.2 Data-subcarrier Aided CFO Estimation ........................................67 
6.3 Performance Evaluation .................................................................71 
6.4 Numerical and Simulation Results..................................................80 
7. PTS with Non-uniform Phase Sets for Peak-to-average Power Ratio 
Reduction in OFDM Systems..............................................................89 
7.1 System and Channel and Background ............................................89 
7.2 PTS with Non-uniform Phase Set ...................................................92 
 V
圖表目錄 
 
Fig. 2-1.  Saleh-Valenzuela model. ...................................................................5 
Fig. 2-2.  Realizations of CM1.......................................................................10 
Fig. 2-3.  Realizations of CM2.......................................................................10 
Fig. 2-4.  Realizations of CM3.......................................................................11 
Fig. 2-5.  Realizations of CM4.......................................................................11 
Fig. 3-1.  Daytona TMS320C6701 EVM.........................................................13 
Fig. 3-2.  The interface of the channel emulator................................................14 
Fig. 4-1.  The generator of a large set of Kasami sequences................................19 
Fig. 4-2.  Structure of the three-stage demodulation receiver ..............................23 
Fig. 4-3.  Structure of the α -matched filter ....................................................25 
Fig. 4-4.  The bit error probability errorP  versus 0NEb  for Kasami M-CSK and 
other M-CSK modulations with 6=n  in an AWGN channel...............................30 
Fig. 4-5.  The bit error probability errorP  versus 0NEb  for the single-user 
environment with several values of n  in an AWGN channel. .............................31 
Fig. 4-6.  The bit error probability errorP  versus 0NEb  for the single-user 
environment with several values of n  in an UWB channel.................................33 
Fig. 4-7.  The bit error probability errorP  versus 0NEb  for the two-user 
environment with 6=n  and 1=ζ  in an AWGN channel. ................................36 
Fig. 4-8.  The bit error probability errorP  versus 0NEb  for the two-user 
environment with 6=n , 8 and 10 in an AWGN channel. ....................................37 
Fig. 4-9.  The bit error probability errorP  versus 0NEb  for the three -user 
environment with 6=n , 8 and 10 in an AWGN channel. ....................................38 
Fig. 4-10.  The bit error probability errorP  versus 0NEb  for the two-user 
environment with 6=n , 8 and 10 in an UWB channel. ......................................39 
Fig. 4-11.  The bit error probability errorP  versus 0NEb  for the three-user 
environment with 6=n , 8 and 10 in an UWB channel. ......................................40 
Fig. 4-12.  The bit error probability errorP  versus 0NEb  for the Kasami M-CSK 
modulation and BPSK modulation in an AWGN channel with narrow-band 
interference. .................................................................................................41 
 VII
Fig. 7-1.  The distribution of ( )ikθΔ  for different peak samples in an OFDM symbol 
with 128N =  and 4M = .............................................................................91 
Fig. 7-2.  The distribution of the phase adjustments that minimize the 1-st peak 
amplitude for 128N =  and 4M = , and the determination of the non-uniform phase 
factors for PTS..............................................................................................92 
Fig. 7-3.  The complementary cumulative distribution function of the PAPR for 
interleaved partition. ......................................................................................94 
Fig. 7-4.  The complementary cumulative distribution function of the PAPR for 
adjacent partition...........................................................................................95 
Fig. 8-1.  MSE performance of the PTAW scheme and the PTA-IE scheme for the 
1-st iteration with 0.1fδ =  under ITU-3 channel model. .................................107 
Fig. 8-2.  MSE performance improvement obtained via multiple iterations for the 
PTA-IE scheme with 0.1fδ =  under ITU-3 channel model..............................108 
Fig. 8-3.  MSE performance improvement obtained via multiple iterations for the 
PTA-IE scheme with 0.25fδ =  under ITU-3 channel model............................109 
Fig. 8-4.  MSE performance of the PTA-IE scheme with 0.1fδ =  and the preset 
initial CFO estimation ˆ 0.25fδ = −  under ITU-3 channel model. .......................110 
Fig. 8-5.  MSE performance of the PTA-IE scheme with 0.25fδ =  and the preset 
initial CFO estimation ˆ 0.1fδ = −  under ITU-3 channel model. .........................111 
Fig. 8-6.  MSE performance of the PTA-IE scheme by using different preset values 
of ˆfδ  with 0.1fδ =  and SNR = 50 dB under ITU-3 channel model.................112 
Fig. 8-7.  BER performance comparison for 0.1fδ =  under ITU-3 channel model.
.................................................................................................................113 
Fig. 9-1.  The block diagram of the proposed soft handoff scheme. ...................118 
Fig. 9-2.  The diversity combining concept applied in the proposed soft handoff 
scheme. .....................................................................................................120 
Fig. 9-3.  The proposed soft handoff strategy for OFDMA-based cellular systems.
.................................................................................................................123 
Fig. 9-4.  Examples illustrate how a suitable NΔ  is determined for subband-based 
channel allocation scheme with 1 2 ( 1)k k C K≤ + − ...........................................125 
Fig. 9-5.  Examples illustrate how a suitable NΔ  is determined for subband-based 
and interleaved channel allocation schemes. ....................................................126 
Fig. 9-6.  The bit error probability versus γ  for BPSK modulation with the 
 1
1. Introduction 
In the first year of this project, we focus on the study of the UWB channel model 
proposed by IEEE 802.15.SG3a task group, and implement an UWB channel emulator based 
on the digital signal processing (DSP) platform. The main purpose for IEEE 802.15.SG3a task 
group to offer this channel model is to help the performance evaluation of the physical (PHY) 
layer proposals submitted to the IEEE 802.15.3a task group. Furthermore, this channel model 
may also help researchers to develop some new theories for the UWB applications or to 
investigate the system performance of hardware prototypes. The proposed UWB channel 
model consists of two parts – the path loss model and the multipath model. The major focus 
of this hardware implementation is the multipath model, since it is the core of the UWB 
channel model. This hardware implementation can be applied as a channel emulator to the 
performance evaluation of other UWB baseband hardware implementation. The correctness 
and accuracy of our implementation algorithms have been evaluated and examined via the 
UWB channel model software platform. It is found that our hardware implementation can 
emulate the characteristics of the UWB channel very well. In addition, the concept of M-ary 
code shift keying (M-CSK) was introduced into direct sequence spread spectrum (DSSS) 
systems to achieve higher rates. In this work, we propose an M-CSK modulation technique 
based on the large set of Kasami sequences since it possesses good code properties, including 
a large code set size and low cross-correlations. The modulation and demodulation schemes 
are developed, and the system performance in additive white Gaussian noise (AWGN) and 
UWB channels exposed to multiple user interference is investigated thoroughly. It was found 
that the Kasami M-CSK modulation is superior to other M-CSK modulation schemes in the 
bandwidth efficiency, and therefore a higher data rate can be achieved. Furthermore, based on 
our proposed demodulation scheme, the hardware complexity of receivers can be greatly 
reduced to )( 31MO , and the implementation of receivers for a very large M  becomes 
feasible. 
In the second year of this project, the main focus is to study the performance 
optimization techniques for the MB-OFDM systems, as well as for the traditional OFDM 
systems. Two important issues have arisen in wireless OFDM-based systems – the channel 
gain estimation and the carrier frequency offset (CFO) estimation. For most OFDM systems, 
each data frame is generally led by some preamble symbols used for timing synchronization, 
carrier frequency and sampling frequency adjustment, and channel estimation. However, if 
 3
we proposed a novel diversity combining technique for soft handoff in OFDMA cellular 
systems. By applying the appropriate sampling rate and discrete Fourier transform (DFT) size, 
diversity combining can be realized between two different frequency bands, both for the 
subband-based and interleaved channel allocation schemes, for an MS in soft handoff. The 
major cost is to slightly increase the applied sampling rate and DFT size. The theoretical BER 
performance is also derived, and the simulation results are provided for performance 
investigation. 
 5
For the investigation of the multipath model, IEEE 802.15.SG3a task group has 
examined several existent wireless channel models, such as the modified IEEE802.11 model, 
the modified K−Δ  model, and the Saleh-Valenzuela (S-V) model. According to the 
clustering phenomena observed in realistic UWB channels, IEEE 802.15.SG3a task group 
finally proposed a modified S-V model as the UWB multipath channel model. As shown in 
Fig. 2-1, all the multipath components are grouped into multiple clusters with multiple paths 
within each cluster. The multipath impulse response is  
∑∑−
=
−
=
−−=
1
0
1
0
,, )()(
L
l
K
k
lkllk TtXth τδα ,                    (2-2) 
where L is the number of multipath clusters, K is the number of multipath components within 
a cluster, lk ,α  is the multipath gain coefficients corresponding to the k-th multipath 
component of the l-th cluster, lT  is the group delay of the l-th cluster, lk ,τ  is the delay of 
the k-th multipath component relative to the l-th cluster arrival time lT , and X represents the 
log-normal shadowing. 
 
Time
Signal Strength
Γ
γ
Λ λ
Cluster 0
Cluster 1
Cluster 2
 
Fig. 2-1  Saleh-Valenzuela model. 
 
Besides, the proposed model parameters are defined in the following: 
z lT  = the arrival time of the first path of the l-th cluster; 
 7
.20
)10ln()(
)10ln(
/10/10)ln(10 22
2
1,0
,
σσγτμ +−−Γ−Ω= lkllk T                  (2-7) 
In (2-4), lξ  reflects the fading associated with the l-th cluster, and lk ,β  corresponds to the 
fading associated with the k-th ray of the l-th cluster. 
Finally, since the log-normal shadowing of the total multipath energy is captured by the 
term X , the total energy contained in the terms { lk ,α } is normalized to unity for each 
realization. This shadowing term is characterized by the following: 
),0(Normal)(10log20 2xX σ∝ .                     (2-8) 
 
2.3. Channel characteristics desired to model 
Following are the key parameters that must be defined in the model:  
z Λ = cluster arrival rate; 
z λ = ray arrival rate; 
z Γ = cluster decay factor; 
z γ = ray decay factor; 
z 1σ = standard deviation of the cluster lognormal fading term (in dB units). 
z 2σ = standard deviation of the ray lognormal fading term (in dB units). 
z xσ = standard deviation of the lognormal shadowing term for total multipath realization 
(in dB units).  
These parameters for the UWB channel model are obtained by trying to match the 
measured characteristics of the UWB channels. The main characteristics of the UWB 
channels that are used to derive the above-mentioned model parameters were chosen to be the 
following [2]:  
z Mean excess delay; 
z RMS delay spread; 
 9
Table 2-1  Channel characteristics and parameters. 
Target Channel 
Characteristics CM 1 CM 2 CM 3 CM 4 
Mean excess delay 
(nsec) ( mτ ) 5.05 10.38 14.18  
RMS delay (nsec) ( rmsτ ) 5.28 8.03 14.28 25 
NP10dB   35  
NP (85%) 24 36.1 61.54  
Model parameters     
Λ (1/nsec) 0.0233 0.4 0.0667 0.0667 
λ (1/nsec) 2.5 0.5 2.1 2.1 
Γ 7.1 5.5 14.00 24.00 
γ 4.3 6.7 7.9 12 
1σ  (dB) 3.3941 3.3941 3.3941 3.3941 
2σ  (dB) 3.3941 3.3941 3.3941 3.3941 
xσ  (dB) 3 3 3 3 
Model Characteristics CM 1 CM 2 CM 3 CM 4 
Mean excess delay 
(nsec) 4.9 9.4 13.8 26.8 
RMS delay (nsec) 5 8 14 26 
NP10dB 13.3 18.2 25.3 41.4 
NP (85%) 21.4 37.2 62.7 122.8 
Channel energy mean 
(dB) -0.5 0.1 0.2 0.1 
Channel energy std 
(dB) 2.9 3.3 3.4 3.2 
 
Shown in Fig. 2-2 – Fig. 2-5 are some realizations produced by the UWB multipath 
channel model released by IEEE 802.15 SG3a task group. Each figure shows 100 realizations 
of the UWB multipath channel.  
 
 11
0 50 100 150 200 250
-1.5
-1
-0.5
0
0.5
1
Impulse response realizations
Time (nS)
 
Fig. 2-4  Realizations of CM3. 
 
0 50 100 150 200 250 300 350 400
-0.6
-0.4
-0.2
0
0.2
0.4
0.6
0.8
Impulse response realizations
Time (nS)
 
Fig. 2-5  Realizations of CM4. 
 13
 All instructions conditional 
z Instruction set features  
 Hardware support for IEEE single- precision instructions  
 Hardware support for IEEE double- precision instructions  
 Byte-addressable (8, 16, 32-bit data)  
 8-Bit overflow protection  
 Saturation  
 Bit-field extract, set, clear  
 Bit-counting  
 Normalization 
By using this channel emulator, we can generate a specific transmitted signal as input to 
emulate the received UWB signal. The received signal is the convolution of the transmitted 
signal and the UWB channel impulse response. Fig. 3-2 shows the interface of the channel 
emulator.  
 
 
Fig. 3-1  Daytona TMS320C6701 EVM. 
 
 15
4. Kasami Code-Shift-Keying Modulation for Ultra Wideband 
Communication Systems  
Lately the issue of ultra wideband (UWB) systems has seen a sharp increase in 
investigation activities [6]-[9]. UWB communication systems are applied to short-range 
wireless communications because of their great advantages, such as their ability to coexist 
with narrowband systems, low probability of interception, low power density, and diversity 
gain of multipath resolution. Impulse radio (IR) technology, which uses ultra-short (< 1n sec) 
duration pulses and thus spreads the energy of the radio signal from near DC to a few 
gigahertz, was originally proposed for UWB systems [10]-[11]. However, in order to reduce 
the interference from other multiple access users, spread spectrum techniques were also 
applied to UWB systems.  
Some studies regarding UWB systems can be found in the literature [12]-[23]. Owing to 
the nature of pulse position modulation (PPM), the time-hopping spread spectrum (THSS) 
technique was introduced for multiple access environments [17]-[18]. In [19], a 
pseudo-chaotic time hopping technique was developed in order to form a noise-like spectrum. 
For the purpose of achieving higher rates or supporting multiple access capability, direct 
sequence spread spectrum (DSSS) UWB systems were proposed in [20]-[22], where multiple 
pulses corresponding to a certain pseudo-noise (PN) code are transmitted to represent each 
symbol. In addition, an UWB system based on the frequency hopping spread-spectrum (FHSS) 
multiple access technique was proposed recently [23]. In the past few years, two major 
proposals were proposed to the standard body IEEE 802.15.3 for the application of wireless 
personal area networks (WPANs). One is the multi-band OFDM (MB-OFDM) system [24], 
and the other is the direct-sequence UWB (DS-UWB) system [25]. 
To achieve higher rates, the concept of M-ary code shift keying (M-CSK) was introduced 
to the DSSS systems [26]-[28]. M-CSK is an M-ary modulation scheme, which uses M  
different codes to represent the M  possible symbols, and therefore )(log2 M  bits are 
transmitted per code period. There are many choices of code sets to be used, such as 
orthogonal code sets, bounded correlation code sets and random codes. Especially, the 
concept of using bounded correlation code sets, including Gold and Kasami sequences, for 
M-ary code shift keying has been proposed in [26]. However, no detailed modulation and 
demodulation scheme, nor any detailed performance has been investigated in the literature. In 
this work, we make use of Kasami sequences as the alphabet set to increase the constellation 
 17
code set size is defined as the number of available code sequences in a code set. For an 
orthogonal code set with length L , the code set size is L , and maxθ  is equal to 0; whereas, 
for a quasi-orthogonal code set, such as m-sequences, Gold sequences, Gold-like sequences 
and Kasami sequences, the code set size may be larger than L , and maxθ  will not be 0. Table 
4-1 shows the related parameters for different types of PN codes.  
 
Table 4-1.  Parameters for different types of pseudo-random sequences. 
Code Type Sequence Length 
Constraint   
of n  
Code 
Set Size max
θ  
Orthogonal sequences n2  no n2  0 
Gold sequences 12 −n  4mod0≠n  12 +n  2/12 n−≈
Gold-like sequences 12 −n  4mod0=n  n2  2/12 n−≈
Large Kasami 
sequences 12 −n  n  even 2/32 n≈  2/12 n−≈
Small Kasami 
sequences 12 −n  n  even 2/2n  2/2 n−≈  
 
In practical applications, it is important to distinguish a binary code sequence and the 
corresponding signal waveform. The term binary code sequence is used to indicate the output 
of a binary shift-register generator, and each element takes on a value of { }1,0 . The 
corresponding signal waveform is used to represent the consecutively transmitted polar 
waveform. The relation between a binary code sequence [ ]110 ,,, −= Laaa "a  and the 
corresponding signal waveform )(tφ  can be represented as  
( ) ( ) sL ca TtTtpt ≤≤−−=∑−
=
0,1)(
1
0A
AAφ ,                   (4-2) 
where cT  is the chip duration, cs LTT =  is the symbol duration, and )(tp  is the unit pulse 
shaping function beginning at 0 and ending at cT . The signal waveform can be represented in 
the signal vector form with elements taking on values of { }1,1 −+ . For the sake of 
convenience, we define a function )(•χ  to represent the translation from a binary code 
sequence to the corresponding signal vector, i.e.  
( ) AA aa 1)( −=χ ,                              (4-3) 
 19
Hence the code set size of )(uK  is   
)12(2 2/ +=×= nnGCK SSS .                         (4-8) 
In addition, the large set of Kasami sequences can be expressed by generator polynomials. Let 
)(xh , )(xh′  and )(xh ′′  denote the generator polynomials of u , [ ])(ntu  and [ ])(nsu , 
respectively, and the generator polynomial of )(uK  is )()()()( xhxhxhxf ′′′= . Fig. 4-1 
shows the generator of a large set of Kasami sequences. The cross-correlations between any 
two code sequences in )(uK  take on the values in the set  
[ ] [ ]{ }LntLnsLLnsLnt )(,)(,1,2)(,2)( −−−−−=ℜ ,            (4-9) 
and [ ] Lnt 2)(max −=θ .  
 
Kasami
sequence 
output
1)( 56 ++= xxxh
1)( 2356 ++++=′ xxxxxh
1)( 3 ++=′′ xxxh
]0,...,0,1[=h
[ ]110 ,,, −=′ nddd "h
[ ]15.11 ,,, −+=′′ nnn ddd "h
(an arbitrary nonzero vector)
 
Fig. 4-1  The generator of a large set of Kasami sequences. 
 
C. Channel Models 
In this work, two channel models are considered in the performance evaluation, the 
AWGN channel and the ultra-wideband multipath channel [1]. 
1) AWGN Channel Model 
 21
4.2. Modulation and Demodulation Schemes 
In this section we propose the modulation and demodulation schemes for M-CSK 
modulation based on the large set of the Kasami sequences. Although we focus mainly on the 
applications of the baseband DSSS UWB systems in which the transmitted signal does not 
modulate a carrier, the results can be easily extended to a system with a carrier.  
 
A. Modulation Scheme 
In the M-CSK modulation, there are M  different possible symbols, and the transmitter 
groups the input data stream into k-bit ( Mk 2log= ) symbols with a symbol duration sT , 
which is k  times the bit duration. Since the code set size )12(2 2/ += nnKS  of )(uK  is 
not a power of 2, we select 232 nM = , which is a power of 2 and slightly smaller than KS , 
and then we have nk 5.1= . According to the input symbol, a signal waveform is selected 
from a set of M-ary alphabets { }1,,1,0,0),( −=≤≤ MiTtt si "φ  and then transmitted, 
where the signal waveform has a length L  chips and the chip duration is cT .  
We propose a systematic method for the selection and mapping of sequences since only 
232 n  code sequences are selected from )12(2 2/ +nn  Kasami sequences. The input data 
sequence in a symbol duration is denoted as [ ]15.1110 ,,,,,, −−= nnn ddddd ""d , where id  is 
binary and takes on values of { }1,0 . As in Fig. 4-1, the initial state of the shift registers 
corresponding to )(xh  is fixed to an arbitrary nonzero value, such as [ ]0,,0,1 "=h , and 
the initial states corresponding to )(xh′  and )(xh ′′  are set to [ ]110 ,,, −=′ nddd "h  and 
[ ]15.11 ,,, −+=′′ nnn ddd "h . Consequently, the output code sequence corresponding to the input 
data d  is a Kasami sequence of )(uK .  
Since the initial state corresponding to )(xh  is an arbitrary nonzero value, the generated 
Gold sequences set ),(~ uu ′G  in Fig. 4-1 will be the complete set of ),( uu ′G  with the code 
sequence u′  excluded, and from this it follows that 12~ +== LS nG . Besides, if we define  
( ) { } { }LmDDDV mLL ,,0,,,,,, 12 "" ==′′′′=′ − vuuuu0u ,               (4-14) 
then the generated Gold sequence set is composed of u  and an element of ( )u′V , i.e.  
 23
4-2, we partition the demodulation process into three stages. The effect of code sequence u  
is eliminated in the first stage. In the second stage, there are a total of )2( 2/nCS =  
α -matched filters, which are used to deal with the effects of ( )u ′′C  and ( )u′V  sequentially. 
The local maximum correlation output of each α -matched filter is then sent to the third stage. 
Finally, the global maximum is determined from the CS  local maximums inputted to the 
third stage, and then the estimation of a received symbol can be determined.   
 
Pick
the
largest
one
Stage 3
Decision 
result
00 ,mμ
11
, LL mμ
11,mμ
r
)(tr∫ dt
cT
cT
1
sampling per      secondscT
Stage 1
0r1−Lr 1r
)( 0uχ)( 1−Luχ )( 1uχ
0y1−Ly 1y
...
...
...
filter
matched−α
Stage 2
filter
matched−α
filter
matched−α
•
•
•
∑−
=
−
1
0
)(
L
i
ciTtp
 
Fig. 4-2.  Structure of the three-stage demodulation receiver. 
 
Let [ ]110 ,,, −= Lrrr "r  denote the received signal vector in chip level. The element ir  
is the outcome of integrating the received signal in the i -th chip duration, i.e.  
10,)()(1
)1( −≤≤−×= ∫ + LidtiTtptrTr cc
Ti
iT c
c
i .                 (4-17) 
In Stage 1, the received signal vector r  is multiplied by )(uχ  “element-by-element”, and 
the result is denoted as [ ]110 ,,, −= Lyyy "y , i.e.  
 25
jz
Pick the 
largest one
1 1
)'( 1−Luχ )'( 1uχ )'( 0uχ )'( 1−Luχ )'( 2uχ )'( 1uχ
1
∑
∑
1
""
""
"
Lmmj ,,2,1,, "=μ
jj m,μ0,jμ
0y
)( 0,jcχ
0,jz
1y
)( 1,jcχ
1,jz
1−Ly
)( 1, −Ljcχ
"
"
"
y
L/1
L/1
1, −Ljz
 
Fig. 4-3.  Structure of the α -matched filter. 
 
For example, let’s assume that the transmitted Kasami code sequence is the exclusive- 
OR output of [ ]110 ,,, −= Luuu "u , [ ]1,ˆ1,ˆ0,ˆˆ ,,, −= Lmmmm vvv "v  and [ ]1,ˆ1,ˆ0,ˆˆ ,,, −= Ljjjj ccc "c . 
If the channel is assumed to be noiseless, then we have the received signal vector 
( ) ( )[ ]1,ˆ1,ˆ10,ˆ0,ˆ0 ,, −−− ⊕⊕⊕⊕= LjLmLjm cvucvu χχ "r . After the processing of Stage 1, the 
output is ( ) ( )[ ]1,ˆ1,ˆ0,ˆ0,ˆ ,, −− ⊕⊕= LjLmjm cvcv χχ "y . In the jˆ -th α -matched filter of Stage 2, 
y  is multiplied by )( jˆcχ  to obtain ( ) ( )[ ]1,ˆ0,ˆˆ ,, −= Lmmj vv χχ "z , and we have 1ˆ,ˆ =mjμ . 
For any mm ˆ≠ , mj ,ˆμ  is the cross-correlation of jm ˆˆ cvu ⊕⊕  and jm ˆcvu ⊕⊕ , i.e. mj ,ˆμ  
is the cross-correlation between two different large-set Kasami sequences, and therefore mj ,ˆμ  
takes on values in the set ℜ . As a result, the output parameters of the jˆ -th α -matched 
filter are 1ˆ =jμ  and mm j ˆˆ = . In other α -matched filters, jjmj ˆ,, ≠μ , is the 
cross-correlation between two different large-set Kasami sequences, jm ˆˆ cvu ⊕⊕  and 
jm cvu ⊕⊕ , so mj ,μ  takes on values in the set ℜ . In other words, we have 
[ ] jjLntj ˆfor,12)(max ≠<−=≤ θμ . Finally, in Stage 3, the global maximum jˆμ  is 
 27
isi WTR +Ω= .                             (4-21) 
Since the signal waveforms are not orthogonal to each other, the noise components in the 
decision variables are not independent, and therefore all the decision variables 
110 ,,, −MRRR "  are dependent random variables. It should be noted that there are 
( ) 21 , jiL ρ+×  chips having the identical value for )(tiφ  and )(tjφ , and that the channel 
noise contributes the same amount to iR  and jR . For the other ( ) 21 , jiL ρ−×  chips having 
the opposite values, the channel noise contributes the same amount, but with an opposite sign 
to iR  and jR . We define the parameter as 
( ) jisjijiji WTRRR ,,, 1 +−Ω=−= ρ ,                     (4-22) 
where jiji WWW −=,  is a Gaussian random variable with a zero mean and the variance 
( ) sji TN0,1 ρ− . The random variable jiR ,  can be modeled as a Gaussian random variable with 
the mean ( ) sji T,1 ρ−Ω  and the variance ( ) sji TN0,1 ρ− . 
Let jiP ,  denote the probability of an error decision from symbol i  to symbol j , i.e. 
the probability of 0, <jiR , then we have  
( ) ( )γρρ ×−=−Ω= )1()1( ,0,, jijisji QNTQP ,                  (4-23) 
where 0NTsΩ=γ  is the symbol energy to total noise power density ratio, and 
dxxZQ
Z∫∞ −= )2exp(21)( 2π . By applying the union bound we have the average symbol 
error probability, on the condition that symbol i  is transmitted, upper bounded by 
∑−
≠=
≤
1
,0
,
M
ijj
jii PP , for 1,,1,0 −= Mi " .                   (4-24) 
Assuming that all symbols are equiprobable, we have the average symbol error probability as  
∑−
=
=
1
0
1 M
i
is PM
P .                           (4-25) 
It should be noted that the cross-correlation ji,ρ  of the large set of Kasami sequences 
 29
m-sequences for 6=n  [31], denoted by 0u , 1u , 2u , 3u , 4u  and 5u , and the generator 
polynomials are 156 ++ xx , 16 ++ xx , 1456 ++++ xxxx , 1256 ++++ xxxx , 
1346 ++++ xxxx , and 12356 ++++ xxxx , respectively. Each m-sequence can be used to 
generate a large set of Kasami sequences, and these 6 different sets of large Kasami sequences 
are denoted by )( 0uK , )( 1uK , )( 2uK , )( 3uK , )( 4uK , and )( 5uK . The corresponding 
reduced sets of large Kasami sequences can be obtained and denoted by )(~ 0uK , )(
~
1uK , 
)(~ 2uK , )(
~
3uK , )(
~
4uK , and )(
~
5uK . Furthermore, the cross-correlation between any two 
sequences in one large Kasami set takes on values in the set 
{ }6317,639,631,637,6315 −−−=ℜ . Via computer experiment we found that the 
cross-correlation properties are the same for all 5~0),(~ =iK iu , and we have ,01 =β  
,967682 =β  ,1290243 =β  ,35844 =β  and 322565 =β . Therefore, we can conclude that 
these 6 reduced sets of large Kasami sequences are equivalent and lead to the same system 
performance.  
1) AWGN Channel Model 
Fig. 4-4 shows the bit error performance errorP  versus 0NEb  with 6=n  for the 
Kasami M-CSK modulation and other M-CSK modulations in an AWGN channel. The code 
length for each modulation scheme is 63=L , except that the code length is 64=L  for the 
case using orthogonal sequences. However, the symbol alphabet sizes are different for various 
modulation schemes. For the proposed Kasami M-CSK modulation we have 512=M , for 
the M-CSK modulation using orthogonal or Gold sequences we have 64=M , and we have 
63=M  for M-CSK modulation using m-sequences. The numerical and simulation results 
show that the Kasami M-CSK modulation outperforms other M-CSK modulations, and the 
improvement in 0NEb  is about 1 dB. We also found that the M-CSK modulation schemes 
using orthogonal sequences, Gold sequences or m-sequences have a nearly identical 
performance, since they have almost the same constellation size M . Furthermore, the 
numerical result obtained from (4-27) shows good accuracy for a large value of 0NEb . 
More important, our simulation results verify that the performances are the same for 
demodulation Scheme A and demodulation Scheme B. It must be noted that using bounded 
correlation code sets, such as Gold and Kasami sequences, to increase the constellation size 
may not improve the maximum allowable user number for an interference-limited system, as 
 31
The corresponding code lengths are 15=L , 63=L , 255=L  and 1023=L , respectively, 
and the primary polynomials are 1)( 34 ++= xxxh , 1)( 56 ++= xxxh , 
1)( 4568 ++++= xxxxxh  and 1)( 710 ++= xxxh , respectively. According to the 
above-mentioned results the corresponding Kasami code sets and the implementation of the 
modulator and demodulator can easily be obtained. Fig. 4-5 shows the simulation results of 
the proposed scheme for the single-user environment in an AWGN channel with different 
values of 4=n , 6, 8 and 10. The performance of the M-CSK modulation using orthogonal 
sequences is also provided as a reference. The results show that the increase of M , i.e. the 
increase of n , will effectively enhance the BER performance, i.e. enhance the power 
efficiency. The results also show that our proposed scheme is better than the M-CSK 
modulation with orthogonal codes for any fixed values of n . Furthermore, for our proposed 
scheme, the increase of n  from 4 to 6 can achieve an improvement of 1.5 dB in 0NEb , 
and an improvement of 1 dB in 0NEb  can be obtained for the increase from 6=n  to 
8=n .   
 
)dB(/ 0NEb
Bi
t 
Er
ro
r 
Pr
ob
ab
ili
ty
errorP
10
8
6
4
=
=
=
=
n
n
n
n
Orthogonal
Kasami
1 1.5 2 2.5 3 3.5 4 4.5 5 5.5 6
10-4
10-3
10-2
10-1
10-5
 
Fig. 4-5.  The bit error probability errorP  versus 0NEb  for the single-user environment 
with several values of n  in an AWGN channel. 
 
 33
modulation, although it has a worse signal waveform cross-correlation than that of the PPM 
modulation, it has a larger constellation size, n5.12 . The minimum distance of the Kasami 
M-CSK modulation gets larger than that of the PPM modulation as n increases. Therefore, the 
proposed Kasami M-CSK modulation will outperform the PPM modulation if the value of n  
is large enough. 
 
errorP
Bi
t 
Er
ro
r 
Pr
ob
ab
ili
ty
)dB(/ 0NEb
Kasami
Gold or Goldlike
PPM
10
8
6
=
=
=
n
n
n
1 2 3 4 5 6 7 8 9
10-4
10-3
10-2
10-1
 
Fig. 4-6.  The bit error probability errorP  versus 0NEb  for the single-user environment 
with several values of n  in an UWB channel. 
 
Although the proposed Kasami M-CSK modulation may be inferior to other schemes for 
the case with 6=n , it must be noted that the proposed scheme is always superior to other 
schemes in the bandwidth efficiency with a gain of 50 % as shown next.  
 
C. Bandwidth Efficiency 
The bandwidth efficiency Bη  is defined as the ratio of the transmission bit rate to the 
channel bandwidth no matter what channel model is applied. For the Kasami M-CSK 
modulation we have the bandwidth efficiency  
 35
 
E. Multiple Access Environments 
It is possible that two or more users use the same radio channel simultaneously, and thus 
the multiple access interference (MAI) must be taken into consideration. It should be noted 
that there are multiple sets of large Kasami sequences for each n , and the number of different 
sets depends on the number of primitive polynomials for the degree n , e.g. there are 6 
different sets for 6=n . Hence we can use different reduced sets of large Kasami sequences 
for multiple access applications. In other words, different users in the same radio channel will 
be assigned different reduced sets of large Kasami sequences.  
Assume that )(, tidφ , corresponding to an element of )(~ dK u , and )(, tjIφ , 
corresponding to an element of )(~ IK u , are the transmitted signal waveforms of the desired 
user and the MAI user, respectively. After being transmitted through an AWGN channel, the 
received signal in the receiver front end of the desired user can be written as  
scjIIcjIIidd TttnTlLtlTtttr ≤≤+−−Ω++Ω+Ω= ′ 0),())(()()()( ,,, φφφ ,  (4-32) 
where dΩ  and IΩ  are the received desired signal power and the received MAI signal 
power, respectively; l  ( Ll <≤0 ) is the relative chip delay between the desired signal and 
the MAI signal; and )(tn  is the received channel noise. Here we introduce an interfering 
power ratio defined as the ratio of the MAI signal power to the desired signal power, i.e. 
dI ΩΩ= /ζ . The UWB communication systems are generally used in applications of low 
user density and short range transmission, such as indoor applications [24]-[25]. Nearby users 
form a piconet to share the radio resource via the TDMA (time division multiple access) 
scheme [32], and multiple access interferences only come from the nodes in other piconets far 
away from the desired receiving node. Therefore, we may conclude that the power ratio ζ  is 
generally smaller than 1. 
Due to the existence of MAI, the system performance will be degraded with the 
degradation depending on the asynchronous cross-correlation between the desired signal and 
the MAI signal. We found that the distributions of the asynchronous cross-correlations are 
almost the same for different pairs of [ ])(~),(~ ji KK uu . This implies that the performance for 
multiple access environments is almost irrelevant to the selection of large Kasami sequences 
 37
signal-to-noise ratio. The saturation phenomenon occurs when the received signals, including 
the desired signal and the MAI, contribute a larger or equal correlation result at an erroneous 
correlator than that at the correct one for any possible combination of the desired signal and 
the interfering signal. Considering the code correlation properties of Kasami sequences sets, 
the saturation phenomenon will occur at a very high signal-to-noise ratio for 1=ζ . However, 
the BER performance will be degraded but not saturated for 1<ζ . 
 
10
8
6
0
5.0
1
=
=
=
=
=
=
n
n
n
ζ
ζ
ζ
)dB(/ 0NEb
errorP
Bi
t 
Er
ro
r 
Pr
ob
ab
ili
ty
1 2 3 4 5 6 7 8 9
10-4
10-3
10-2
10
-1
 
Fig. 4-8.  The bit error probability errorP  versus 0NEb  for the two-user environment with 
6=n , 8 and 10 in an AWGN channel. 
 
If the number of multiple access users is three, the BER performance will degrade further. 
Fig. 4-9 shows the simulation results for the three-user environment with 6=n , 8 and 10 in 
an AWGN channel. The power ratios for the second user to the desired user and the third user 
to the desired user are assumed to be the same, and the values of ζ  are 1.0, 0.5 and 0, 
respectively. In comparison with Fig. 4-8, the BER performance degrades further, and the 
saturation phenomena occurs in a small value of 0NEb , especially for the case with 6=n  
and 1=ζ .  
 39
Bi
t 
Er
ro
r 
Pr
ob
ab
ili
ty
errorP
)dB(/ 0NEb
10
8
6
0
5.0
1
=
=
=
=
=
=
n
n
n
ζ
ζ
ζ
1 2 3 4 5 6 7 8 9
10-4
10-3
10-2
10-1
 
Fig. 4-10.  The bit error probability errorP  versus 0NEb  for the two-user environment 
with 6=n , 8 and 10 in an UWB channel.  
 
Fig. 4-11 shows the simulation results for the three-user environment with 6=n , 8 and 
10 in the UWB channel. The BER performance is severely degraded and saturated for the 
cases with 1=ζ  and 5.0=ζ . This implies that the power ratio ζ  should be much smaller 
than 1 for the case with three users simultaneously coexisting in the same environment. 
 
 41
simulation results show that the proposed Kasami M-CSK modulation can actually reduce the 
impact of narrow-band interference. 
 
Bi
t 
Er
ro
r 
Pr
ob
ab
ili
ty
errorP
)dB(/ 0NEb
CIR = 0dB
CIR = 3dB
CIR = 10dB
BPSK_AWGN
Kasami_AWGN
1 2 3 4 5 6 7 8 9
10-4
10-3
10-2
10-1
100
 
Fig. 4-12.  The bit error probability errorP  versus 0NEb  for the Kasami M-CSK 
modulation and BPSK modulation in an AWGN channel with narrow-band interference. 
 
 
 43
different piconets. Two types of TFCs are defined: one type interleaves the coded information 
over three bands, and is referred to as time-frequency interleaving (TFI); and the other type 
transmits the coded information in a single band, and is referred to as fixed frequency 
interleaving (FFI). As in Band Group 1, four TFCs using TFI and three TFCs using FFI are 
defined, providing support for up to seven channels. The TFCs used in Band Group 1 are 
shown in Table 5-1 [45].  
 
Table 5-1. Time frequency codes for Band Group 1. 
TFC Number BAND_ID for TFC 
TFC #1 1 2 3 1 2 3 
TFC #2 1 3 2 1 3 2 
TFC #3 1 1 2 2 3 3 
TFC #4 1 1 3 3 2 2 
TFC #5 1 1 1 1 1 1 
TFC #6 2 2 2 2 2 2 
TFC #7 3 3 3 3 3 3 
 
Let’s assume that there is another asynchronous SOP using the band group the same as 
the desired piconet. The interfering pattern strongly depends on the TFCs pairs used by these 
two piconets. To evaluate the symbol collision between two piconets, TFCs can be classified 
into two categories. They are: the two symbols transmitted in the same band are separated by 
two other symbols, i.e., TFCs #1 - #2; and two symbols are successively transmitted in the 
same band, i.e., TFCs #3 - #4. It must be noted that the main concern in this work is a piconet 
using TFCs #1 - #4, since there are only two preamble symbols available for channel 
estimation in a band. On the other hand, if the desired piconet uses TFC #5 - #7, then there 
will always be more than two symbols available for channel estimation. Furthermore, if the 
interfering piconet uses TFC #5 - #7, the two symbols available for channel estimation in the 
interfering band will always be corrupted by the interference. Since our schemes are proposed 
to improve the channel estimation performance for symbols that are partially interfered, the 
scenarios using TFC #5 - #7 will not be discussed in this work.  
According to Table 1, the collision between two different TFCs can be classified into 
 45
 
B. Channel Estimation 
The transmission of MB-OFDM is divided into two phases, the preamble phase and the 
data transmission phase. The preamble signal contains packet synchronization sequences, 
frame synchronization sequences and channel estimation sequences. For channel estimation, 
six channel estimation symbols are available, each of which contains some predefined 
sequences allocated in the frequency-domain. According to the TFCc defined in Table 1, there 
are two symbols available in each band for piconets adopting TFCs #1 - #4, and there are up 
to six symbols available for piconets adopting TFCs #5 - #7. Assume that the total number of 
sub-carriers in a transmission band is N , and that the preamble sequence of a OFDM symbol 
with a symbol duration T  is { }[ ], 0,1, , 1S k k N= −" . By IFFT (inverse fast Fourier 
transform), the sample values of the preamble symbol in the time-domain can be represented 
as  
1
2
0
1[ ] [ ] , 0,1, , 1
N
j nk N
k
s n S k e n N
N
π−
=
= × = −∑ " .                  (5-1) 
Before serially transmitting the time-domain samples, a cyclic prefix (CP) is generally added 
in front of an OFDM symbol to mitigate inter-symbol-interference (ISI) and to restore the 
orthogonality among different sub-carriers. However, for MB-OFDM systems, a zero padded 
suffix (ZPS) rather than a CP is appended at the rear of an OFDM symbol, which can also 
mitigate ISI. To restore the orthogonality among different subcarriers, the receiver will copy 
the received ZPS samples and then add it to the front of the OFDM symbol [47]. Adding a 
ZPS can achieve almost the same performance as adding a CP, but it slightly increases the 
received noise power. The length of the CP or ZPS is assumed to be N . 
The time-domain signal ( )s t  then passes through the propagation channel with an 
impulse response ( )h t . Since UWB channels vary very slowly and the symbol duration is 
very short, it is assumed that the two or six channel estimation symbols transmitted in the 
same band suffer almost the same channel-selectivity fading. At the receiving end, a received 
symbol in the time-domain can be represented in a vector form as  
= ⊗ + + = ⊗ +y s h w m s h v ,                        (5-2) 
where ⊗  denotes the circular convolution operator; s  is the signal vector, h  is the 
 47
line-of-sight (LOS) (0-4 m) measurements, CM2 is based on non-line-of-sight (NLOS) (0-4 m) 
measurements, CM3 is based on NLOS (4-10 m) measurements, and CM4 represents an 
extreme NLOS multipath channel with a 25 nsec RMS delay spread. For CM1, the fading 
characteristics of adjacent sub-channels are highly correlated; whereas the fading 
characteristics are highly frequency-selective for CM4.  
 
5.2. Adaptive Channel Estimation Schemes 
A. Time Redundancy Property 
Based on the interference collision scenarios shown in Fig. 5-1, one intuitive 
consideration is to let the channel estimation symbols have a time-domain diversity property 
to resolve the damage caused by asynchronous interference. Frequency-domain decimation, 
sacrificing the resolution in the frequency-domain, is an efficient way to provide the TR 
property [50]. If all sub-carriers are decimated by a factor of 2, we may decimate all the 
odd-numbered sub-carriers or all the even-numbered sub-carriers. Assuming that only the 
even-numbered sub-carriers are used (i.e., the odd-numbered sub-carriers are set to zero), we 
have, according to (5-1), the OFDM symbol in the time-domain being  
1
4 2
even
0
1[ ] [2 ] , 0,1, , 1
2
M
j nk M
k
s n S k e n N
M
π− ′
′=
′= × = −∑ " ,               (5-7) 
where 2M N= . It must be noted that the last half of even[ ]s n  is the duplication of the first 
half, since 
1
2 ( )2 2
even
0
1
4 2 2
even
0
1[ ] [2 ]
2
1 [2 ] [ ], 0,1, , 1.
2
M
j n M k M
k
M
j nk M j k
k
s n M S k e
M
S k e e s n n M
M
π
π π
− ′+
′=
− ′ ′
′=
′+ = ×
′= × × = = −
∑
∑ "
       (5-8) 
On the other hand, if only the odd-numbered sub-carriers are used, we have the OFDM 
symbol in the time-domain being  
1
2 (2 1) 2
odd
0
1[ ] [2 1] , 0,1, , 1
2
M
j n k M
k
s n S k e n N
M
π− ′+
′=
′= + × = −∑ " .             (5-9) 
It is noted that the last half of odd[ ]s n  is the minus duplication of the first half, since 
 49
interference is available, the desired receiver can take the un-interfered time-domain samples 
to replace the redundant samples which have been interfered. In this way, all or part of the 
interference power can be eliminated. This timing information can be obtained by examining 
the statistic of the received signal; moreover, even when the timing information cannot be 
precisely obtained, the timing error will only slightly degrade the interference elimination 
performance. Case A shows that the desired symbol, excluding CP or ZPS, is overlapped by 
the interfering symbol in more than half of the symbol duration. As a result only part of the 
interference can be eliminated. On the other hand, in Case B the overlapping interval is 
smaller than half of the symbol duration, and thus the interference can be completely 
eliminated.  
 
Desired preamble:      ; Channel noise:      ; Repeated noise:  ; Interference:
Case A
Case B
Time-domain
Redundancy
Copy and replace
Copy and replace
T The same
The same
D samples
N-D
samples
D
samples
CP
CP
CP
CP
0
TI
0
TI
D
samples
N-D
samples
D
samples
 
 (a) Case for employing CP 
 51
degrades the estimation performance of each decimated sub-carrier. If there are two preamble 
symbols available for the same band, then we can have one symbol for the estimation of even 
sub-carriers and the other one for the estimation of odd sub-carriers, while still maintaining 
the TR property. This scheme, referred to as Time-domain Redundancy with Even/Odd 
sub-carriers (TREO) estimation, is very suitable for a highly frequency-selective fading 
channel, since no linear interpolation is required.  
 
5.3. Performance Analysis 
The criterion of performance evaluation is based on the normalized mean square error 
(NMSE) of channel gain estimation, defined as 1 12 2
0 0
ˆ| [ ] [ ] | | [ ] |N N
k k
H k H k H k− −= =−∑ ∑ . For the 
conventional LSE scheme, each sub-carrier transmits a pilot signal with the average received 
signal power on each sub-carrier assumed to be P , and the received channel noise power and 
the received interference power on each sub-carrier are assumed to be 2Wσ  and 2Mσ , 
respectively. We thus define the signal-to-noise power ratio (SNR) as 2W WR P σ=  and the 
signal-to-interference power ratio (SIR) as 2M MR P σ= . In the desired receiver, assuming 
that the interval of the desired symbol, excluding CP or ZPS, overlapped by the interfering 
symbol is D  samples, we have the average total received noise plus interference power as 
2 2
W MN Dσ σ+ . After FFT in the receiver, the received signal-to-interference plus noise power 
ratio (SINR) on each sub-carrier equals ( )2 2W MP D Nσ σ+ . Consequently, the NMSE of 
conventional LSE on each sub-carrier is  
( ) ( ) ( )2 2 1LSE W M W MD D N P R D N Rε σ σ= + = + × .              (5-12) 
By using the sample time as the basic unit and taking the arrival time of the desired 
preamble symbol as the reference 0, the arrival time of the interfering symbol IT  must be 
within ( 1), 1N N N N⎡ ⎤− + − + −⎣ ⎦  , otherwise the desired symbol will not be interfered. First 
we examine the case using CP in preamble symbols. According to Fig. 5-2(a), the value of D , 
depending on IT , can be obtained as 
 53
can be represented as  
[ ] [ ]3 (0) 2 (2) ( 2) 4 (1) ( 1) 2
2,
O IP E
E
ε ρ ρ ρ ρ ρ ε
ζ ε
− ≅ + + − − + − +
= +             (5-17) 
where ( )iρ  is the correlation coefficient between a specific odd sub-carrier and the i -th 
adjacent sub-carrier; [ ] [ ]3 (0) 2 (2) ( 2) 4 (1) ( 1)ζ ρ ρ ρ ρ ρ= + + − − + − ; and Eε  is the 
estimation NMSE on even sub-carriers. Finally, we have the average NMSE of TRLI-LSE 
estimation as 
( ) ( )
( ) ( )
2
2 3 8 3 8 .
CP CP
TRLI LSE E LSE O IP
W M
D
R D N R
ε ε ε
ζ
− − −= +
= + + ×                 (5-18) 
Hence, according to (5-13), the average NMSE of TRLI-LSE on each sub-carrier is 
( ) ( )2 3 8 3 16CPTRLI LSE W MR Rε ζ− ≈ + + .                   (5-19) 
If ZPS is employed, the channel noise will be enhanced by a factor of ( )N N N+   and 
the average NMSE of TRLI-LSE on each sub-carrier is  
( ) ( ) ( )2 3 8 3 16ZPSTRLI LSE W MN N NR Rε ζ− ≈ + + + .               (5-20) 
 
B. One symbol: TRLI-EGC scheme 
Since the preamble symbol has the TR property, we may directly combine (by the equal 
gain combining (EGC) concept) the first and second halves, sample-by-sample, and then 
repeat the resultant for the two halves before FFT. It must be noted that the received noise and 
interference power can be reasonably assumed to be equally located on even and odd 
sub-carriers due to the white assumption of the noise plus interference. By EGC, the noise and 
interference components on odd sub-carriers will be canceled due to the TR property shown 
in (5-10). As a result, repeating the combined samples in the two halves will not lead to noise 
or interference enhancement. Consequently, the received SINR on each even sub-carrier is 
( )2 22 W MP D Nσ σ+ , and the NMSE of TRLI-EGC on each even sub-carrier is 
( ) ( )CP CPTRLI EGC TRLI LSED Dε ε− −= . Finally, we have the average NMSE of TRLI-EGC estimation 
the same as (5-19) and (5-20). 
 55
If ZPS is employed, then the channel noise will be enhanced due to the copying and 
adding process of ZPS. However, by applying ASR, the first N  samples may be replaced by 
other un-interfered samples. As a result, the amount of enhanced noise depends on the value 
of D . According to Fig. 5-2(b) and (5-13), the total amount of enhanced noise in the 
preamble symbol is assumed to be 2Wασ , where we have   
, for ( 1)
, for
0, for 2
2 , for 2 2
for 2 2
2 , for 2 2
0 for 2 1
I
I I
I
I I
I
I I
I
N N N T N
N N T N T N N
N N T N
N T N T N N
N N N T N
N N T N T N N
N N T N N
α
⎧ − + − ≤ ≤ −⎪ − − − < ≤ − +⎪⎪ − + < ≤ −⎪= + − < ≤ − +⎨⎪ − + < ≤⎪⎪ + − < ≤ +⎪ + < ≤ + −⎩
 
 


 
 
 
.              (5-24) 
For example, when 2IN N T N− + < ≤ − , the first N  samples will be replaced by other 
un-interfered redundancy samples, and thus the amount of enhanced noise is 0. When 
2 2IN N T N− + < ≤ , the first N  samples (due to the copying and adding of ZPS) and the 
samples from ( 2 1)N + -th to ( 2 )N N+  -th will both be interfered and no replacement in the 
first N  samples will be carried out. Thus, the amount of enhanced noise is 2WNσ . Finally, 
according to (5-13), (5-22) and (5-24), we have the average NMSE of TRLI-ASR estimation 
with ZPS being 
2 23(6 6 2 3 ) 1 3( 2 ) 1 .
2 16 (2 2 1) 16(2 2 1)
ZPS
TRLI ASR
W M
N NN N N N N N
N N N R N N R
ζε − + − + − += + × + ×+ − + −
   
       (5-25) 
 
D. Two symbols: TRLI-EGC scheme 
In MB-OFDM systems there are two preamble symbols used for channel estimation in a 
band. Since channel variation in the time-domain is very slow for UWB environments, these 
two preamble symbols experience almost the same channel response, and thus can be directly 
combined to improve estimation performance. By using the TRLI-EGC scheme for one 
symbol, each symbol combines the first and second halves and repeats the resultant in the two 
halves. These two symbols are then equally combined for channel estimation. Assuming that 
both of these two symbols suffered the interfering signal from the same piconet (such as in 
 57
two symbols, each of which has the TR property and can apply ASR to eliminate the 
interfering signal, to individually estimate the even and odd sub-carriers without the need of 
linear interpolation. This scheme is referred to as the TREO-ASR scheme. We have the 
NMSE of the TREO-ASR scheme the same as that of the TRLI-ASR scheme with one symbol 
except for the interpolation error. In other words, for the case with CP, the NMSE is  
3 2 1 1 2 1 .
2(2 2 1) 4(2 2 1)
CP
TREO ASR
W M
N N N N
N N R N N R
η − + − += × + ×+ − + −
 
               (5-32) 
and for the case with ZPS, the NMSE is 
2 26 6 2 3 1 2 1 .
4 (2 2 1) 4(2 2 1)
ZPS
TRLI ASR
W M
N NN N N N N N
N N N R N N R
η − + − + − += × + ×+ − + −
   
          (5-33) 
It must be noted that the performance for other scenarios shown in Fig. 5-1 can be easily 
obtained by modifying the previously derived results. 
 
5.4. Performance Evaluation 
The system performance is evaluated via simulation with the channel model assumed to 
be CM1 or CM4 of the UWB systems. Numerical results are provided for comparison with 
the correlation coefficients ( )iρ  obtained from the corresponding UWB channel models. For 
CM1, the corresponding correlation coefficients are ( 2) 0.93 0.23iρ − = − , 
( 1) 0.98 0.12iρ − = − , (1) 0.98 0.12iρ = +  and (2) 0.93 0.23iρ = + ; while the correlation 
coefficients for CM4 are ( 2) 0.03 0.45iρ − = − − , ( 1) 0.42 0.64iρ − = − , (1) 0.42 0.64iρ = +  
and (2) 0.03 0.45iρ = − + . Furthermore, it is assumed that the number of sub-carriers is 
128N = , the length of CP or ZPS is 32 samples, and the number of preamble symbols used 
for channel estimation is one or two. Two interfering scenarios are investigated: one assumes 
that SIR is equal to 9 dB, corresponding to a mildly interfered case; and the other assumes 
SIR = -3 dB, corresponding to a severely interfered case. Four estimation schemes are 
investigated: conventional LSE, TRLI-LSE, TRLI-ASR, and TREO-ASR, where the 
TREO-ASR scheme only applies to the case with two preamble symbols. The performance of 
conventional LSE is regarded as a baseline performance.  
Fig. 5-3 shows the average NMSE of one preamble symbol versus SNR for an 
 59
Fig. 5-4 shows the average NMSE of one preamble symbol with CP versus SNR for SIR 
= 9 dB. The numerical results fit the simulation results very well. The estimation performance 
is saturated by interference for very high SNR. Comparing TRLI-LSE and TRLI-ASR, the 
results show that TRLI-ASR outperforms TRLI-LSE only for high SNR, which is mainly due 
to the fact that TRLI-ASR can eliminate full/part of the interference, but at the cost of AWGN 
enhancement. According to (5-23), the NMSE performance crossovers at SNR = 12 dB for 
SIR = 9 dB.  
 
SNR (dB)
N
or
m
al
iz
ed
 M
ea
n 
Sq
ua
re
 E
rr
or
 (N
M
SE
)
Simulation
LSE:    CM1,    CM4
TRLI-LSE:    CM1,    CM4
TRLI-ASR:    CM1,    CM4
Numerical
LSE
CM1,        CM4
TRLI-LSE
TRLI-ASR
0 2 4 6 8 10 12 14 16 18
10 -1
10 0
10 -2
 
Fig. 5-4. Performance of one symbol estimation with CP versus SNR for SIR = 9 dB. 
 
Fig. 5-5 shows the average NMSE of one preamble symbol with CP versus SNR for SIR 
= -3 dB, i.e. the interference power is two times the received signal power. It is found that the 
performance of conventional LSE is severely degraded by the interference. Although the 
performance of TRLI-LSE and TRLI-ASR is also degraded by the interference, it is still far 
better than that of conventional LSE both for CM1 and CM4. Compared to TRLI-LSE, 
TRLI-ASR is superior even for low SNR. This is mainly due to the fact that the interference 
can be efficiently eliminated by the ASR scheme. In addition, as shown in Fig. 5-2, the ASR 
scheme considers the interfering signal having a finite symbol duration T  and only 
eliminates the interference in a symbol duration. In other words, the delay spread of the 
interfering signal is not considered in the ASR scheme, and part of the interference cannot be 
 61
SIR (dB)
N
or
m
al
iz
ed
 M
ea
n 
Sq
ua
re
 E
rr
or
 (N
M
SE
)
Simulation
LSE:    CM1,    CM4
TRLI-LSE:    CM1,    CM4
TRLI-ASR:    CM1,    CM4
Numerical
LSE
CM1,        CM4
TRLI-LSE
TRLI-ASR
-6 -4 -2 0 2 4 6 8 10 12
10 -1
10 0
10 -2
 
Fig. 5-6. Performance of one symbol estimation with CP versus SIR for SNR = 9 dB. 
 
Fig. 5-7 shows the average NMSE of one preamble symbol with ZPS versus SNR for 
SIR = -3 dB. Compared with Fig. 5-5, we found that the estimation performance with ZPS is 
slightly worse than that with CP for a low SNR, since the copy and add process of ZPS 
introduces more channel noise. However, the performance is dominated by interference for 
high SNR, and thus this degradation disappears for the cases with a high SNR.  
 
 63
SNR (dB)
N
or
m
al
iz
ed
 M
ea
n 
Sq
ua
re
 E
rr
or
 (N
M
SE
)
Simulation
LSE:    CM1,    CM4
TREO:    CM1,    CM4
TRLI-LSE:    CM1,    CM4
TRLI-ASR:    CM1,    CM4
Numerical
LSE
TREO
CM1,        CM4
TRLI-LSE
TRLI-ASR
0 2 4 6 8 10 12 14 16 18
10 -1
10 0
10 -2
 
Fig. 5-8. Performance of two symbol estimation with ZPS versus SNR for SIR = 9 dB. 
 
Fig. 5-9 shows the average NMSE of two preamble symbols with ZPS versus SNR for 
SIR = -3 dB. Since the interference power is very large, both TRLI-ASR and TREO-ASR 
outperform the conventional LSE and TRLI-LSE with EGC. This is again due to the fact that 
the interference can be efficiently eliminated by the ASR scheme.  
 
SNR (dB)
N
or
m
al
iz
ed
 M
ea
n 
Sq
ua
re
 E
rr
or
 (N
M
SE
)
Simulation
LSE:    CM1,    CM4
TREO:    CM1,    CM4
TRLI-LSE:    CM1,    CM4
TRLI-ASR:    CM1,    CM4
Numerical
LSE
TREO
CM1,        CM4
TRLI-LSE
TRLI-ASR
0 2 4 6 8 10 12 14 16 18
10 -1
10 0
 
Fig. 5-9. Performance of two symbol estimation with ZPS versus SNR for SIR = -3 dB. 
 65
To utilize the CFO information embedded in data subcarriers, we propose novel 
data-subcarrier aided CFO estimation algorithms based on the PTA and CPB schemes, 
without the need of an iterative process, for M-PSK data modulated OFDM systems. The 
proposed algorithms can significantly improve the CFO estimation performance at the cost of 
an increase in computational complexity. In addition, the Cramer-Rao lower bound (CRLB) is 
generally used for analytical performance evaluation of estimation. The CRLB of the CPB 
scheme has been investigated in [59]. However, the CRLB of the PTA scheme has not been 
studied yet in literature. In this work, we also derive the approximated CRLB of the 
PTA-based schemes and the approximated lower bounds, based on the mean square error 
(MSE) sense, of the proposed schemes for performance evaluation.  
 
6.1. System and Channel Models 
In this section, we introduce the OFDM system model carrying a fractional CFO and the 
channel model employed for simulation.  
 
A. OFDM System Model 
Let [ ]mX n  denote the modulated data on subcarrier n in the m-th OFDM symbol, where 
0 1n N≤ ≤ −  and N is the OFDM inverse fast Fourier transform (IFFT) size. After IFFT, we 
have, in the time-domain, the transmitted OFDM symbol with CP represented as  
1 2
0
1[ ] [ ] , for 0 1
,
[ ] [ ], for 0 1
N j nk N
m CP mn
m m CP
x N k X n e k N
N
x k x k N k N
π−
=
⎧ + = × ≤ ≤ −⎪⎨⎪ = + ≤ ≤ −⎩
∑             (6-1) 
where CPN  is the length of CP. The received samples of the m-th OFDM symbol, excluding 
the CP, can be represented as  
( )[ ] [ ] exp [ ] [ ], 0 1m CP m m my N k z k j k w k k Nφ+ = × + ≤ ≤ − ,             (6-2) 
where mz  is the circular convolution of mx  and the channel impulse response mh ; 
[ ] 2 ( )m CP CPk mN mN N k Nφ πε= + + +  is the phase shift due to the normalized CFO ε  
which is defined as the ratio of the carrier frequency offset to the subcarrier spacing fΔ ; and 
 67
6.2. Data-subcarrier Aided CFO Estimation  
In this section, we briefly introduce the conventional PTA and CPB estimation schemes, 
and then propose the data-subcarrier aided CFO estimation algorithms for M-PSK modulated 
OFDM systems. 
 
A. Conventional Pilot Tone - Aided CFO Estimation 
PTA is a frequency-domain approach utilizing the information on each pilot subcarrier 
for CFO estimation. The PTA with weighing (PTAW) scheme is proposed by assigning 
different weights based on the received signal power on each pilot subcarrier. Let there be 
PN  pilot subcarriers in each OFDM symbol, and P  denote the set of indices corresponding 
to all pilot subcarriers. Considering two received OFDM symbols, symbol m  and symbol 
( )m ξ+ , the CFO estimation of the PTAW scheme can be represented as [52] 
1ˆ Angle [ ]
2PTA PnCP
N V n
N N
ε πξ ∈
⎧ ⎫= × × ⎨ ⎬+ ⎩ ⎭∑P ,                   (6-7) 
where { }Angle •  denotes the operation taking the phase angle in radian, the decision 
variable ( )( )[ ] [ ] [ ] [ ] [ ]P m m m mV n Y n Y n C n C nξ ξ∗ ∗+ += , and [ ]mC n  and [ ]mC nξ+  are the 
corresponding pilot signals transmitted in symbol m  and symbol ( )m ξ+ , respectively.  
 
B. Conventional Cyclic Prefix – Based CFO Estimation 
The CPB scheme is carried out in the time-domain instead of in the frequency-domain. 
Considering an OFDM symbol, the CFO estimation of the CPB scheme can be represented as 
[57] 
[ ]
0
1ˆ Angle
2
CPN L
CPB C
l
V lε π
−
=
⎧ ⎫= × ⎨ ⎬⎩ ⎭∑ ,                      (6-8) 
where the decision variable [ ] [ ] [ ]1 1C m CP m CPV l y N l y N N l∗= − − × + − − , and 1L ≥  is the 
channel delay spread in sample length. It is noted that the samples corrupted by inter-symbol 
interference (ISI) have been discarded, and only the last 1CPN L− +  samples of the CP are 
 69
CPB CFO
estimator
FFT
Data-carriers
aided
CFO estimator
Data
sub-carriers
refΨ
Final CFO
estimation
ˆMCPBε
Received
signal
[ ]y k
 
(b) Modified cyclic prefix based CFO estimation 
Fig. 6-1.  Block diagrams of the proposed data-carrier aided CFO estimation. 
 
According to the PTAW approach, the decision variable corresponding to data subcarrier 
n  can be determined as  
( )( )[ ] [ ] [ ] [ ] [ ]D m m m mV n Y n Y n C n C nξ ξ∗ ∗+ +=   ,                     (6-9) 
where [ ]mC n  and [ ]mC nξ+  are the data signals transmitted in symbol m  and symbol 
( )m ξ+ , respectively. Since the exact values of [ ]mC n  and [ ]mC nξ+  are not available yet in 
the receiver, there are M  possible values of ( )[ ] [ ]m mC n C nξ∗ +   for M-PSK data modulation. 
In other words, there are M  possible decision variables, each of which has a phase 
consisting of the phase rotation caused by CFO and a possible modulation phase difference, 
for each data subcarrier. Subsequently, the decision variable with a phase closest to the 
reference phase refΨ  is chosen as the presumed decision variable for this data subcarrier. 
Finally, the CFO estimation is determined based on the decision variables of all subcarriers, 
including pilot subcarriers and data subcarriers.  
Assume that the number of data subcarriers is DN  and D  denotes the set of indices 
corresponding to all data subcarriers. The details of the MPTA scheme are shown as follows. 
Step 1: According to (6-7), find the reference CFO ˆPTAε  by using the PTAW scheme. 
Moreover, the reference phase corresponding to ˆPTAε  is determined as 
 71
available for CFO estimation; thus the estimation performance is severely degraded. In the 
proposed MCPB scheme, the signals of data subcarriers in the frequency-domain are used to 
improve the estimation performance. The concept of this scheme is similar to that of the 
proposed MPTA scheme except that the initial reference CFO is obtained by using the CPB 
scheme. Details of the MCPB scheme are shown as follows.  
Step 1: According to (6-8), the reference CFO ˆCPBε  is obtained by using the CPB scheme. 
Moreover, the equivalent frequency-domain reference phase corresponding to ˆCPBε  is 
determined as 
( )2ˆ CPref CPB N NN
πξε +Ψ = × .                       (6-15) 
Step 2 - Step 4: Similar to Step 2, Step 3 and Step 4 of the MPTA scheme.  
Step 5: Based on ˆ [ ]DV n  ( n∈D ) obtained in Step 4, the final CFO estimation is given by 
1 ˆˆ Angle [ ] .
2MCPB DnCP
N V n
N N
ε πξ ∈
⎧ ⎫= × × ⎨ ⎬+ ⎩ ⎭∑D                  (6-16) 
 
6.3. Performance Evaluation  
CRLB is widely used for analytical performance evaluation of estimation. The CRLB for 
the CPB scheme has been investigated in [59]. However, the CRLB for the PTA scheme is 
still absent in literature. In the following, we derive the approximated CRLB for the PTA 
scheme and the approximated lower bounds for the proposed MPTA and MCPB schemes, 
based on the mean square error (MSE) sense, for performance evaluation.  
 
A. Performance of PTA-based Schemes 
Let 1,1 1,2 1, 2,1 2,2 2,[ ]P P
T
N NY Y Y Y Y Y=Y " "  be a collection of the received signals 
corresponding to the pilot subcarriers in two desired OFDM symbols, where 
1,1 1,2 1,[ ]P
T
NY Y Y"  and 2,1 2,2 2,[ ]P TNY Y Y"  are the received pilot signals in symbol m  
and in symbol ( )m ξ+ , respectively. Each received pilot signal is a complex number 
 73
noted that , ,[ ] 0, for i n i nE Y Y n n
∗
′ ′× = ≠ , and 
2 2
, , ,
2 2
, , ,
[ ] [ ]
[ ] [ ]
m n m n m n n n
m n m n m n n n
E E
E E
ξ α
ξ α
α α α ϕ σ ϕ
α α α ϕ σ ϕ
∗ ∗ ∗ ∗ ∗
+
∗
+
⎧ × = Ω = Ω⎪⎨⎪ × = Ω = Ω⎩
. 
In addition, the log-likelihood function corresponding to Y  can be expressed as 
( ) ( ) 1( ; ) ln ( ; ) 2 ln ln det( ) HPL f Nε ε π −= = − − −Y YY Y R Y R Y .           (6-20) 
For simplicity, assuming that the CFO is small enough (e.g. 0.2 0.2ε− ≤ ≤ ), we have 
1β ≈  which is independent of ε . Hence, only 2ησ  and ϕ  are functions of ε . 
Consequently, according to (6-20), the CRLB of the PTA-based schemes can be represented 
as [69] 
2 2 2
1 2
2 2 2
1 1
( ; ) ( ; ) ( ; )PTA
CRLB
LE E Eε ε εε ε ε
−= =⎡ ⎤ ⎡ ⎤ ⎡ ⎤∂ ∂ Λ ∂ Λ+⎢ ⎥ ⎢ ⎥ ⎢ ⎥∂ ∂ ∂⎣ ⎦ ⎣ ⎦ ⎣ ⎦
Y Y Y
,         (6-21) 
where ( )1( ; ) ln det( )εΛ = YY R  and 12 ( ; ) Hε −Λ = YY Y R Y .  
As shown in (6-20), the covariance matrix YR  can be rewritten as 
⎡ ⎤= ⎢ ⎥⎣ ⎦
1 2
Y
3 4
R R
R
R R
, 
where iR , 1, , 4=i " , are all diagonal matrices. By applying some related lemmas [71], the 
determinant of the covariance matrix YR  can be obtained as 
( ) ( ) ( )
( ) ( ) ( )
( )
1
4 22 2 2 2 2 2 4
2 2
2 2 2
det det det
=
= 2 ,
P
P
P
P
P
N
NN
N N
α
α η α η α η α
α η
α η η
σσ σ σ σ σ σ σσ σ
σ σ σ κ
−⎡ ⎤= × −⎣ ⎦
⎡ ⎤ ⎡ ⎤+ + − = + −⎢ ⎥ ⎢ ⎥⎣ ⎦+⎢ ⎥⎣ ⎦
⎡ ⎤+⎣ ⎦
Y 1 4 3 1 2R R R R R R

       (6-22) 
where ( )2 2 2= 2 α η ηκ σ σ σ+ . After some derivation, we have  
 75
2 2 2
1
2
1
2
1
2 2 2
P
P
N
N
α η α
α
α
α α η
σ σ σ ϕ
κ κ
σ ϕ
κ
σ ϕ
κ
σ ϕ σ σ
κ κ
∗ ∗
∗ ∗
−
⎡ ⎤+ − Ω⎢ ⎥⎢ ⎥⎢ ⎥⎢ ⎥⎢ ⎥− Ω⎢ ⎥⎢ ⎥ ⎡ ⎤= ⎣ ⎦⎢ ⎥− Ω⎢ ⎥⎢ ⎥⎢ ⎥⎢ ⎥− Ω +⎢ ⎥⎢ ⎥⎣ ⎦
Y ijR a
0 0
0 0
0 0
0 0

% %
%
%
% %
.        (6-26) 
Then the function 2 ( ; )εΛ Y  can be rewritten as  
1,1
1
2 1,1 2,
2,
1, 1, , 2, 1, , 1, 2, , 2, 2, ,
1 1 1 1 1 1 1 1
( ; )
.
P
P
P P P P P P P P
P P P P
H
N
N
N N N N N N N N
i n i n i n N i n i n i N n i n N i N n
i n i n i n i n
Y
Y Y
Y
Y Y a Y Y a Y Y a Y Y a
ε − ∗ ∗
∗ ∗ ∗ ∗
+ + + +
= = = = = = = =
⎡ ⎤⎢ ⎥⎡ ⎤ ⎡ ⎤Λ = = ⎢ ⎥⎣ ⎦⎣ ⎦ ⎢ ⎥⎣ ⎦
= + + +∑∑ ∑∑ ∑∑ ∑∑
Y ijY Y R Y a" #
(6-27) 
Substituting (6-26) into (6-27), we have  
( )2 2 2
2 1, 1, 2, 2, 2, 1, 1, 2,
1 1 1 1
( ; ) .
P P P PN N N N
i i i i i i i i i i
i i i i
Y Y Y Y Y Y Y Yα η α
σ σ σε ϕ ϕκ κ
∗ ∗ ∗ ∗ ∗ ∗
= = = =
+ ⎡ ⎤ ⎡ ⎤Λ = + − Ω + Ω⎢ ⎥ ⎢ ⎥⎣ ⎦ ⎣ ⎦∑ ∑ ∑ ∑Y     (6-28) 
Consequently, after some derivation we have  
( )2 22 22
1, 1, 2, 2,2 2 2 2 2
1 1
2 2 2 2
2, 1, 1, 2,2 2 2 2 2 2 2 2
1 1
( ; )
(2 )
(2 ) (2 )
P P
P P
N N
i i i i
i i
N N
i i i i i i
i i
E E Y Y Y Y
E Y Y E Y Y
α η
α η η
α α
α η η α η η
σ σε
ε ε σ σ σ
σ ϕ σ ϕ
ε σ σ σ ε σ σ σ
∗ ∗
= =
∗
∗ ∗ ∗
= =
⎡ ⎤+ ⎡ ⎤⎡ ⎤∂ Λ ∂⎢ ⎥= +⎢ ⎥⎢ ⎥∂ ∂ +⎢ ⎥⎣ ⎦ ⎣ ⎦⎣ ⎦
⎡ ⎤ ⎡ ⎤⎡ ⎤ ⎡∂ ∂− Ω − Ω⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢∂ + ∂ +⎢ ⎥ ⎢ ⎥⎣ ⎦ ⎣⎣ ⎦ ⎣ ⎦
∑ ∑
∑ ∑
Y
22 2 2
1 2 32 ,
η ησ σκ κ κε ε
⎤⎥⎦
⎛ ⎞∂ ∂= + +⎜ ⎟⎜ ⎟∂ ∂⎝ ⎠
(6-29) 
where 
4 2 2 4
1 2
4 (2 2 )PN α α η ησ σ σ σκ κ
+ += , 
2 2
2
2 ( )PN α ησ σκ κ
+= −  and 
4 2 2 2
3 2
8 ( )P CPN N N
N
ασ π ξκ κ
+= . 
 
 77
data modulation phase difference on data subcarrier n  as Θ ; then we have the mean of nθ , 
consisting of Θ  and the phase shift due to CFO, being  
2 ( )
n CP
N N Nθμ πξε= Θ + + = Θ + ΔΦ ,                   (6-33) 
where 2 ( )CPN N NπξεΔΦ = + . Assuming that the reference phase refΨ  provides an 
acceptable accuracy, ref ref′Ψ = Ψ +Θ  will be close to nθμ . If the outcome of nθ  is within 
the interval ( )ref n refM Mπ θ π′ ′Ψ − ≤ ≤ Ψ + , such as ,1nθ  shown in Fig. 6-2, the presumed 
phase nˆθ , after removing the presumed data modulation phase difference, will be determined 
as nˆ nθ θ= −Θ  since it is closest to refΨ  for all possible data modulation phase differences. 
On the other hand, if the outcome of nθ  is within the interval 
( )3ref n refM Mπ θ π′ ′Ψ + ≤ ≤ Ψ + , such as ,2nθ  shown in Fig. 6-2, the data modulation 
phase difference will be wrongly determined as 2 MπΘ +  and the presumed phase nˆθ  will 
be determined as ˆ ( 2 )n n Mθ θ π= − Θ +  since it is closest to refΨ  for all possible data 
modulation phase differences. Consequently, we have the approximated distribution of the 
presumed phase nˆθ , conditioning on refΨ , as 
( ) ( )2 2, ,ˆ exp 2 2 2 ,
n ref
Q Q ref ref
i
f x x i M x
M Mζ ζθ
π ππ σ πσ∞Ψ =−∞
⎡ ⎤= − − ΔΦ + Ψ − ≤ ≤ Ψ +⎣ ⎦∑ ,(6-34) 
where 2 2 4, ,Q Qζ ζ ασ σ σ=  is the normalized variance. Subsequently, according to (6-26) we 
have the conditional mean and the conditional variance of nˆθ  as 
( )ˆ ˆref
n ref n refref
M
M
x f x dx
π
θ θπμ
Ψ +
Ψ ΨΨ −= ∫  and ( )2 2 2ˆ ˆ ˆrefn ref n ref n refref MM x f x dxπθ θ θπσ μΨ +Ψ Ψ ΨΨ −= −∫ , 
respectively. 
 
 79
Taking average over refΨ , we have MSE for the estimation of ε  by using all data 
subcarriers as 
( )
refrefDATA
MSE MSE f y dyε ΨΨ= ×∫ ,                     (6-37) 
where 2 2( ) exp ( ) 2 2
ref ref ref
f y y σ πσΨ Ψ Ψ⎡ ⎤= − − ΔΦ⎣ ⎦  is the distribution of refΨ  modeled as 
Gaussian distributed with the mean ΔΦ  and the variance 
( ) 22 2
ref PTA CP
CRLB N N Nσ πξΨ ⎡ ⎤= × +⎣ ⎦ .  
Finally, by applying the CRLB for the pilot subcarriers and the MSE for the data 
subcarriers, we have the approximated MSE lower bound for the MPTA scheme as  
1
1 1
MPTA
PTA DATA
MSE
CRLB MSE
−⎛ ⎞= +⎜ ⎟⎝ ⎠
.                    (6-38) 
 
C. Performance of the MCPB Scheme 
In [59], the CRLB of the CPB-based scheme has been proposed, and the final result can 
be simply represented as  
2 2 2
2 4
(2 )
8 ( 1)
z w w
CPB
CP z
CRLB
N L
σ σ σ
π σ
+= − + ,                      (6-39) 
where 22 ( )z mE z kσ ⎡ ⎤= ⎣ ⎦  and 
22 ( )w mE w kσ ⎡ ⎤= ⎣ ⎦  are the average received signal power and 
the average received noise power in the time-domain, respectively.  
For the proposed MCPB scheme, the approximated performance can be obtained by a 
process similar to that for the MPTA scheme. Finally, the approximated MSE lower bound for 
the MCPB scheme can be represented as  
( )
refrefMCPB
MSE MSE f y dyε ΨΨ= ×∫ ,                    (6-40) 
where the equivalent reference phase refΨ  corresponds to the reference CFO obtained via 
the CPB scheme in Step 1, and the distribution ( )
ref
f yΨ  corresponds to the equivalent 
estimation phase obtained by applying the CPB scheme, which is modeled as Gaussian 
 81
estimation performance when data modulation is either QPSK or 8-PSK; while this statement 
is no longer sustained for data modulation being BPSK. It is noted that the CRLB obtained in 
Section IV is based on the assumption that ICI can be modeled as a complex Gaussian RV. If 
data modulation is QPSK, 8-PSK or other higher level M-PSK, this complex Gaussian 
approximation is good enough, and thus the proposed CRLB is a strict lower bound. However, 
if data modulation is BPSK, ICI mainly contributes to the in-phase component of the pilot 
signal. The interference in the in-phase component has only minor impact on the phase of the 
received pilot signals. In other words, ICI has only limited impact on the CFO estimation for 
BPSK data modulation. As a result, the simulated MSE performance is even better than the 
CRLB for BPSK data modulation with high SNR. On the other hand, for the MPTA scheme, 
the derived estimation performance is still found to be a lower bound for data modulation 
being QPSK or 8-PSK. For BPSK data modulation, the simulated MSE performance is still 
better than the derived estimation performance for high SNR. Comparing the performance of 
the MPTA scheme with different data modulation schemes, it is found that the case with low 
level data modulation outperforms that with high level data modulation. This is mainly due to 
that the data modulation phase ambiguity will impact the estimation performance especially 
for high level data modulation. In addition, the estimation performance improvement 
achieved by applying the proposed MPTA scheme, for example at 15 dBγ = , is about 15 dB 
for BPSK data modulation, 10 dB for QPSK data modulation, and 3 dB for 8-PSK data 
modulation. Specifically for BPSK data modulation, the gain is about the ratio of the numbers 
of available subcarriers for estimation, i.e. ( ) 15 dBP D PN N N+ ≈ , since the data modulation 
phase ambiguity has a negligible effect on the CFO estimation.  
 
 83
M
ea
n 
Sq
ua
re
 E
rr
or
 (M
SE
)
0 2 4 6 8 10 12 14 16 18 20
SNR (dB)γ
10-2
10-3
10-4
10-5
10-6
MSE bound for MPTA - BPSK
MSE bound for MPTA - QPSK
MSE bound for MPTA - 8PSK
Simulation for MPTA - BPSK
Simulation for MPTA - QPSK
Simulation for MPTA - 8PSK
CRLB for PTAW
Simulation for PTAW - BPSK
Simulation for PTAW - QPSK
Simulation for PTAW - 8PSK
 
Fig. 6-4  MSE performance of the PTAW and MPTA schemes with 0.01ε =  under ITU-5 
channel model. 
 
Fig. 6-5 shows the MSE performance of the CPB and MCPB schemes with 0.1ε =  
under ITU-5 model. For the CPB scheme, the estimation performance is only degraded by 
channel noise if only the samples uncorrupted by ISI are used for estimation. Since ITU-5 
model with a delay spread 15L =  is employed, only the last 50 samples of the CP are used 
for estimation. Therefore, the estimation performance of the CPB scheme will not be 
saturated for very high SNR. Moreover, as a time-domain estimation scheme, the 
performance is independent of the applied data modulation scheme. On the other hand, the 
MCPB scheme will be impacted by ICI, and thus the performance is saturated by ICI for very 
high SNR. Similarly, the performance degrades for the case with a high level data modulation 
scheme. In addition, the estimation performance improvement achieved by applying the 
proposed MCPB scheme, for example at 15 dBγ = , is only about 10 dB for BPSK data 
modulation, 7 dB for QPSK data modulation, and 3 dB for 8-PSK data modulation.  
 
 85
M
ea
n 
Sq
ua
re
 E
rr
or
 (M
SE
)
0 2 4 6 8 10 12 14 16 18 20
SNR (dB)γ
10-2
10-3
10-4
10-5
10-6
MSE bound for MCPB - BPSK
MSE bound for MCPB - QPSK
MSE bound for MCPB - 8PSK
Simulation for MCPB - BPSK
Simulation for MCPB - QPSK
Simulation for MCPB - 8PSK
CRLB for CPB
Simulation for CPB - BPSK
Simulation for CPB - QPSK
Simulation for CPB - 8PSK
 
Fig. 6-6.  MSE performance of the CPB and MCPB schemes with 0.01ε =  under ITU-5 
channel model. 
 
Fig. 6-7 shows the performance of the MPTA scheme versus the number of data 
subcarriers used for CFO estimation with 0.05ε =  and 15 dBγ =  under ITU-5 model. The 
performance of the PTAW scheme is shown as a reference. It is found that the performance is 
always improved for applying the PTAW scheme, no matter how many data subcarriers are 
used for CFO estimation. Intuitively, when more data subcarriers are used for CFO estimation, 
better estimation performance can be obtained at the cost of an increase in computational 
complexity. Moreover, the improvement will gradually decrease for the increase of the 
number of used data subcarriers. Hence, if the computational complexity is a major concern, 
limited number of data subcarriers should be used to obtained an acceptable performance but 
with limited complexity.  
 
 87
0 50 100 150 200 250
10-4
10-5
10-6
Simulation CPB - BPSK
Simulation CPB - QPSK
Simulation CPB - 8PSK
Simulation MCPB - BPSK
Simulation MCPB - QPSK
Simulation MCPB - 8PSK
M
ea
n 
Sq
ua
re
 E
rr
or
 (M
SE
)
Number of data subcarriers used for CFO estimation  
Fig. 6-8.  MSE performance of the MPCB scheme versus the number of data subcarriers 
used for CFO estimation with 0.05ε =  and 15 dBγ =  under ITU-5 channel model. 
 
Finally, we focus on the impact of applying different channel models on the CFO 
estimation performance. Fig. 6-9 shows the performance of the four schemes with 0.05ε =  
and QPSK data modulation scheme under ITU-5 and ITU-6 models. For ITU-5 model, the 
last 50 uncorrupted samples of CP are used for CPB estimation; while, for ITU-6 model, the 
whole 64 samples of CP are used for CPB estimation, since the channel delay spread is larger 
than CP length. When ITU-5 model is applied, the CPB-based schemes outperform the 
PTA-based schemes, because that there is no ISI introduced into the CPB estimation. On the 
other hand, when ITU-6 model is applied, the performance of the CPB-based schemes is 
severely degraded by ISI since it is very sensitive to ISI. Although ISI also introduces ICI that 
will degrade the performance of the PTA-based schemes, the degradation is not very severe. 
Thus the PTA-based schemes become to outperform the CPB-based schemes. This implies 
that the PTA-based schemes are more robust for the propagation channel with a large delay 
spread. 
 
 89
7. PTS with Non-uniform Phase Sets for Peak-to-average Power Ratio 
Reduction in OFDM Systems  
In OFDM systems, peak-to-average power ratio (PAPR) reduction is a very important 
issue in order to improve the efficiency of the transmitter power amplifier. Numerous 
techniques have been proposed to reduce the PAPR of OFDM signals in the time-domain. 
Partial transmit sequence (PTS), as one of the effective and uncomplicated methods, has 
caught much attention and is believed to be one of the promising methods for PAPR reduction 
[76]-[80].  
The original frequency-domain data sequence is divided into multiple disjoint sub-blocks, 
which are then weighted by a set of phase sequences to create a set of candidates. Finally, the 
candidate with the lowest PAPR is chosen for transmission. There are several ways for the 
partition of the data sequence into multiple sub-blocks, including adjacent partition, 
interleaved partition and pseudorandom partition [77]. The phase factors in the weighting 
sequences are chosen from a pre-determined phase set, which has the available elements 
assumed to be uniformly distributed within [0, 2 )π .  
However, employing uniformly distributed phase factors in PTS may not be the best 
strategy. By carefully investigating the phase distribution of OFDM signals, we found that 
there exists some non-uniformly distributed phase factors achieving better performance. In 
this work, we investigate the optimal phase factors for the proposed PTS scheme and the 
corresponding performance improvement in PAPR reduction.  
 
7.1. System and Channel and Background 
Consider an OFDM system with N  subcarriers. The frequency-domain data sequence 
[ ]kX=X  for 0, , 1k N= −" , is equally divided by means of a certain kind of partitioning 
scheme into M  disjoint sub-blocks, each of which contains N N M=  subcarriers. For 
sub-block i , 1 i M≤ ≤ , the corresponding time-domain signal after N -point IDFT is 
denoted as ( ) ( )[ ]i inx=x  for 0, , 1n N= −" . Without applying PTS, the overall output signal 
can be represented as  
( )
1
[ ] , 0, , 1M in nix x n N=⎡ ⎤= = = −⎣ ⎦∑x " .                    (7-1) 
 91
Pr
ob
ab
ili
ty
 d
en
si
ty
 fu
nc
tio
n 
(p
df
)
-3 -2 -1 0 1 2 3
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
0.45
1-st Peak
4-th Peak
8-th Peak
16-th Peak
32-th Peak
Relative phase (radian)  
Fig. 7-1.  The distribution of ( )ikθΔ  for different peak samples in an OFDM symbol with 
128N =  and 4M = .  
 
To reduce the amplitude of a high power sample, one straightforward means is to adjust 
the phases of some chosen sub-blocks to the reverse of the reference phase, i.e. ( )pkθ π+ , and 
to keep the phases of the other sub-blocks unchanged. Thus the amplitude of the composed 
signal vector in this sample can be substantially reduced. Based on this conceptual means, we 
observe the distribution of the phase adjustments. Fig. 7-2 shows the distribution of the phase 
adjustments that minimize the amplitude of the 1-st peak sample for 128N =  and 4M =  
via simulation. It is found that the phase adjustments of these M  sub-blocks are not in 
uniform distribution. The distribution contains a delta function at zero, corresponding to the 
probability of maintaining the original phase in a sub-block, and a Gaussian-like distribution 
with the mean π . This outcome is quite reasonable. According to Fig. 7-1, the distribution of 
the relative phases tends to be Gaussian distributed for a high power sample. In other words, 
the M  signal vectors, corresponding to these M  sub-blocks, of the high power sample 
tend to have phases adjacent to each other. To reduce the amplitude of this high power sample, 
some signal vectors will retain their original phases, and some tend to rotate their phases with 
an amount close to π  for signal canceling. Consequently, we can infer that the optimal phase 
set for PTS should be non-uniform and fit in with the distribution shown in Fig. 7-2. 
 93
where η  is the probability of maintaining the original phase and σ  is the standard 
deviation that fit in with the Gaussian-like distribution. Assume that the set of chosen phase 
factors is [ ]iφΦ =  for 0, , 1i W= −" . Due to the existing of the delta function, 0 0φ =  is 
chosen as a phase factor. The other 1W −  factors are chosen to fit in with the Gaussian-like 
distribution. Based on the MMSE sense, we define the error function as  
0
1
1
2 2 2
00
2 2 2 2
0
1
2 2 2
1
( ) exp ( ) 2
( 2 ) exp ( ) 2
( ) exp ( ) 2 ,
W
i
i
h
h
W h
ih
i
J d
d
d
π
ϕ φ ϕ π σ ϕ
ϕ π φ ϕ π σ ϕ
ϕ φ ϕ π σ ϕ
−
−
−
=
⎡ ⎤= − − −⎣ ⎦
⎡ ⎤+ − − − −⎣ ⎦
⎡ ⎤+ − − −⎣ ⎦
∫
∫
∑∫
                 (7-7) 
where 1( ) 2i i ih φ φ+= +  for 0, , 2i W= −" , and 1 0 1(2 ) 2W Wh π φ φ− −= + + . For a specific set 
of ih , the phase factors that minimize the error function J  are 
1 1
( ) ( )i i
i i
h h
i h h
f d f dφ ϕ ϕ ϕ ϕ ϕ
− −
= ∫ ∫ , 1, , 1i W= −" .               (7-8) 
By iterative calculations, we can figure out the optimal set of phase factors that minimizes J .  
As in Fig. 7-2, the approximation parameters applied in (7-6) are 0.487η =  and 
0.92σ = , which fit in with the simulation results very well. Subsequently, according to (7-7), 
we have the non-uniform phase factor sets with 4W =  and 8 being 
{ }4 0, 0.64 , , 1.36π π πΦ =  and { }8 0, 0.43 , 0.68 , 0.85 , ,1.15 ,1.32 ,1.57π π π π π π πΦ = , 
respectively. The phase set Φ  for a specific W  can be determined in advance without 
increasing the computational complexity in the transmitter and receiver. Then the standard 
PTS process is performed based on the acquired non-uniform phase set Φ . It must be noted 
that the required side information is the same as the conventional PTS. 
 
7.3. Performance Comparison 
The performance improvement of our proposed scheme is evaluated via simulation. The 
number of subcarriers is assumed to be 128N = , and the applied signal modulation is 
16-QAM. Three scenarios are investigated: ( , ) (4, 4)M W = , (4, 8) and (8, 4) in the order of 
computational complexity, i.e. the scenario with ( , ) (4, 4)M W =  has the smallest 
 95
 
Fig. 7-4 shows the ccdf of the PAPR for adjacent partition. It is found that the proposed 
PTS scheme still outperforms the conventional PTS scheme with an improvement of 0.4 – 
0.25 dB in PAPR reduction for different scenarios. The improvement in the PAPR outage 
probability is also about a factor of 10. Furthermore, compared to Fig. 7-3, the PTS scheme 
with adjacent partition achieves better PAPR reduction performance than the same scenario 
applying the interleaved partition [80].  
 
C
om
pl
em
en
ta
ry
 d
is
tri
bu
tio
n 
fu
nc
tio
n 
(c
cd
f)
4 5 6 7 8 9 10
100
10-1
10-2
10-3
10-4
Normal
Conventional PTS
Modified PTS
M = 4, W = 4
M = 4, W = 8
M = 8, W = 4
PAPR0 (dB)  
Fig. 7-4.  The complementary cumulative distribution function of the PAPR for adjacent 
partition.  
 
 97
improve the CFO estimation performance and can almost attain the best achievable CFO 
estimation performance without ICI. This scheme can improve not only the CFO estimation 
performance but also the demodulation performance of the data subcarriers. Furthermore, the 
proposed scheme has low computational complexity without the need of matrix inversion 
computation. Thus it can be applied to real-time applications. 
 
8.1. System Model 
In this section, we introduce the OFDM system model carrying a fractional CFO and 
briefly describe the PTA-based CFO estimation schemes.  
 
A. OFDM System Model 
Let [ ]X n  denote the modulated data on subcarrier n  of the m -th OFDM symbol, 
where 0 1n N≤ ≤ −  and N  is the number of subcarriers. After the inverse discrete Fourier 
transform (IDFT), we have the transmitted OFDM signal in the time-domain as  
1 2
0
1[ ] [ ] , for 0 1
,
[ ] [ ], for 1
N j nk N
n
CP
x k X n e k N
N
x k x N k N k
π−
=
⎧ = × ≤ ≤ −⎪⎨⎪ = + − ≤ ≤ −⎩
∑                (8-1) 
where CPN  is the length of CP. The received time samples of the m -th OFDM symbol, 
excluding CP, can be represented as  
( )[ ] [ ] exp [ ] [ ], 0 1y k z k j k w k k Nφ= × + ≤ ≤ − ,                  (8-2) 
where [ ]z k  is the circular convolution of [ ]x k  and the channel impulse response [ ]h k ; 
[ ]w k  is the complex additive white Gaussian noise (AWGN); 
[ ] 2 ( )f CP CPk mN mN N k Nφ πδ= + + +  is the phase shift due to CFO; and fδ  is the 
normalized carrier frequency offset. Since only fractional frequency offset is considered in 
this work (by assuming that the integral part has been estimated and compensated beforehand), 
we have 0.5fδ ≤ .  
Passing the N  received samples into an N -point DFT block, we have the data on the 
 99
where ,n k N Nϖ ×⎡ ⎤= ⎣ ⎦F  is the DFT matrix with entries [ ], 1 exp 2 ( 1)( 1)n k j n k NNϖ π= − − − , 
for 1 ,n k N≤ ≤ .  
 
B. Pilot Tone - Aided CFO Estimation 
PTA is a frequency-domain CFO estimation approach utilizing the information on each 
pilot subcarrier. According to (8-4) and temporarily ignoring the ICI, the phase shift due to 
CFO can be divided into two parts: the fixed phase shift term  
[ ]2 ( 1)f CPN N Nπδ + −  
and the linear incremental phase shift term 
[ ]2 ( )f CPm N N Nπ δ + . 
The estimated CFO is calculated by comparing the phases of a specific pilot subcarrier in two 
symbols, for example symbol m  and symbol ( )m ξ+ . Let there be PN  pilot subcarriers 
in each OFDM symbol and P  denote the set of indices corresponding to all pilot subcarriers. 
By assuming that the channel response does not change for these two symbols, we have a 
decision variable corresponding to the phase difference between symbol m  and symbol 
( )m ξ+  as ( ) ( )1[ ] [ ] [ ] [ ] [ ]m m m mV n Y n C n Y n C nξ ξ+ += , where [ ]iY n  and [ ]iC n  are the 
received signal and the transmitted pilot signal in symbol i , respectively. Finally, by 
averaging the phase differences on all pilot subcarriers, we have the PTA CFO estimation as  
, 1
ˆ Angle [ ]
2 ( )f PTA nCP
N V n
N N
δ πξ ∈
⎧ ⎫= × ⎨ ⎬+ ⎩ ⎭∑P ,                   (8-8) 
where { }Angle i  denotes the operation taking the phase angle in radian. 
To further improve the estimation performance, the PTA with weighing (PTAW) scheme 
is proposed by assigning different weights based on the received signal power on each 
subcarrier. The CFO estimation of the PTAW scheme is represented as [52]  
, 2
ˆ Angle [ ]
2 ( )f PTAW nCP
N V n
N N
δ πξ ∈
⎧ ⎫= × ⎨ ⎬+ ⎩ ⎭∑P ,                   (8-9) 
 101
 [ ]1 1 exp[ 2 ] exp[ 2 ( 1) ] Ti j i N j i N NN π π= − − −u "              (8-12) 
and corresponding eigenvalues iλ , for 0, , 1i N= −" , and can be expressed in the form 
H=A UΛU , where U  has the eigenvectors as columns in order, HU  denotes the conjugate 
transpose of U , and Λ  is a diagonal matrix with the diagonal elements being the 
eigenvalues of A , i.e. diag( )iλ=Λ . 
 
 Lemma 3: Matrix inversion lemma (Woodbury matrix identity) [84] 
The matrix inversion lemma states that  
1 1 1 1 1 1 1− − − − − − −−(A + BCD) = A A B(DA B + C ) DA .                 (8-13) 
where A, B, C  and D  are matrices of appropriate sizes. 
 
It is noted that Φ  is a diagonal matrix. By applying Lemma 1, we can define IFΦF  in 
(8-7) as 
0 1 1
1 0 2
1 1 0
N
N N
N
−
− −
−
Ω Ω Ω⎡ ⎤⎢ ⎥Ω Ω Ω⎢ ⎥= ⎢ ⎥⎢ ⎥Ω Ω Ω⎣ ⎦
IFΦF Ω
"
 # % #
"
,                   (8-14) 
where Ω  is a circulant matrix and 
( ) ( )
sin( ( ))
exp 1
sin ( )
f
k
f
k
j j k N N
N k N
π δ θ ππ δ
+Ω = + −⎡ ⎤⎣ ⎦+  
for 0 1k N≤ ≤ − . Substituting (8-14) into (8-10), we can rewrite the refined signal vector as 
= = +Y ΨY ΨΩHX ΨFw .                          (8-15) 
The entry kΩ  in Ω  can be rewritten as k kα βΩ = × , where 1 exp( )jNα θ=  is a common 
 103
applications. 
 
1) Find the inverse of Γ  
The matrix Γ  can be approximated and decomposed as  
1 1
0
1 2
0
1 1
0ˆ
0 ˆ
ˆ
0
N
N N
N
−
− −
−
Γ Γ⎡ ⎤⎡ ⎤Γ ⎢ ⎥Γ Γ⎢ ⎥ ⎢ ⎥≈ + = +⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥Γ⎣ ⎦ Γ Γ⎣ ⎦
Γ Γ Γ
0
0
"
% # % #
"
.              (8-18) 
Since Γ  is a circulant matrix, we can apply Lemma 2 to decomposed Γ  into H=Γ UΛU . 
Thus the inverse of matrix Γ  can be approximated as  
( ) 11 Hˆ −− ≈ +Γ Γ UΛU ,                           (8-19) 
where [ ]0 1N −=U u u"  is an N N×  unitary matrix with each column vector 
, 0, , 1i i ku k N⎡ ⎤= = −⎣ ⎦u "  defined in (8-12), and ( )0 1diag , , Nλ λ −=Λ "  is a diagonal matrix 
with iλ  being the eigenvalue corresponding to iu . According to (8-12) and (8-18), we have 
the eigenvalue iλ  as  
[ ]
( ) [ ]
( )
( )
1
,
1
1
1
1
1
exp
exp 2
sin
exp 2 1
.
sin
N
i k i k
k
N
k
N
k
N u
j k N
j ik N
k N
j k i N
k N
λ
π ππ
π
π
−
=
−
=
−
=
= × Γ ×
−= × −
− +⎡ ⎤⎣ ⎦=
∑
∑
∑
                  (8-20) 
Subsequently, according to (8-19), we can apply Lemma 3 to obtain  
1 1 1 H 1 1 1 H 1ˆ ˆ ˆ ˆ( )− − − − − − −≈ − +Γ Γ Γ U U Γ U Λ U Γ .                    (8-21) 
It is noted that ( )1 1 10 1diag , , Nλ λ− − −−=Λ "  and ( )1 1 1 10 0 0ˆ ˆ ˆ ˆdiag , ,− − − −= Γ Γ = ΓΓ I" , where I  is 
the N N×  identity matrix. Then we have the central part in (8-21) expressed as 
 105
uniquely determined based on the value of ˆfδ , which can be obtained via the traditional 
PTA-based schemes (e.g. the PTAW scheme) or by using an arbitrary preset value. 
Furthermore, this ICI elimination process can also eliminate the ICI on all data subcarriers. 
Hence, the data demodulation performance can also be significantly improved.  
 
C. PTA-IE CFO estimation algorithm 
According to (8-10), the received signal vector Y  is multiplied by matrix Ψ  
intending to eliminate the ICI caused by CFO. After the ICI elimination process, the refined 
received signal vector Y  is used for further CFO estimation. Due to that the applied 0Γˆ  is 
an approximation of 0Γ , ICI cannot be completely eliminated. However, the ICI elimination 
performance can be further improved by using a more accurate ˆfδ , and the CFO estimation 
performance can then be improved by enhanced ICI elimination performance. Consequently, 
by using an iterative process, the ICI elimination performance, as well as the CFO estimation 
performance, can be gradually improved. The algorithm of the proposed PTA-IE scheme is 
shown as follows.  
 
PTA-IE CFO Estimation Algorithm 
Step 1: Based on the received signal vector Y , find a coarse CFO estimation ,ˆf Cδ  by using 
the PTAW scheme, i.e. (8-9), and set ,ˆ ˆf f Cδ δ= . If the PTAW scheme is not applied, ˆfδ  is 
set to be a preset value.  
Step 2: According to (8-24) and (8-25), find the desired ICI elimination matrix Ψ . It must be 
noted that the values of iλ , for 0, , 1i N= −" , have been determined beforehand without 
increasing the real-time computational burden.  
Step 3: Multiply Y  by Ψ  obtained in Step 2 to obtain the refined received signal vector 
Y .  
Step 4: Based on the refined signal vector Y , find a more accurate CFO estimation ,ˆf Aδ  by 
using (8-9).  
 107
smaller than 30 dB.  
 
M
ea
n 
Sq
ua
re
 E
rr
or
 (M
SE
)
PTAW, BPSK
PTAW, QPSK
PTAW, 8PSK
PTA – IE, BPSK
PTA – IE, QPSK
PTA – IE, 8PSK
PTAW – ICI Free
Signal to Noise Ratio (dB)
0 5 10 15 20 25 30 35 40 45 50
10-2
10-3
10-4
10-5
10-8
10-7
10-6
 
Fig. 8-1.  MSE performance of the PTAW scheme and the PTA-IE scheme for the 1-st 
iteration with 0.1fδ =  under ITU-3 channel model. 
 
Since a higher order data modulation scheme results in a worse CFO estimation 
performance, the applied modulation scheme in the data subcarriers is thereby assumed to be 
16-QAM in the following simulation. Fig. 8-2 shows the performance improvement obtained 
via multiple iterations. The normalized CFO is assumed to be 0.1fδ = , and the applied initial 
CFO estimation ˆfδ  in the PTA-IE scheme is the result obtained via the PTAW scheme. It is 
found that multiple iterations can progressively improve the estimation performance since the 
ICI can be more accurately determined and eliminated. However, there is still a performance 
floor that cannot be overtaken for a very high SNR. In other words, the improvement 
achieved by more than 3 iterations is limited. 
 
 109
M
ea
n 
Sq
ua
re
 E
rr
or
 (M
SE
)
PTAW
PTA – IE, 1st iteration
PTA – IE, 2nd iteration
PTA – IE, 3rd iteration
PTAW – ICI Free
Signal to Noise Ratio (dB)
0 5 10 15 20 25 30 35 40 45 50
10-2
10-3
10-4
10-5
10-8
10-7
10-6
 
Fig. 8-3.  MSE performance improvement obtained via multiple iterations for the PTA-IE 
scheme with 0.25fδ =  under ITU-3 channel model. 
 
The applied initial CFO estimation ˆfδ  plays an important role in the PTA-IE scheme. 
This initial value can be a coarse estimation obtained via other CFO estimation algorithms, 
such as the conventional PTAW scheme. However, if a coarse CFO estimation is not available, 
an arbitrary preset value can be used as a substitute. Fig. 8-4 shows the performance of the 
PTA-IE scheme by using a preset initial CFO estimation ˆfδ . The normalized CFO is 
assumed to be 0.1fδ = , and the preset initial CFO estimation is ˆ 0.25fδ = − . Because that 
the preset ˆfδ  far departs from the actual CFO, the estimation performance of the 1-st 
iteration PTA-IE is worse than that obtained via the conventional PTAW scheme. However, 
the estimation performance is greatly improved by multiple iterations. For the 2-nd iteration, 
the performance is even better than that of the conventional PTAW scheme. For the 4-th 
iteration, the performance almost achieve the performance floor, which is the same as 
performance floor shown in Fig. 8-2. This implies that applying a preset initial CFO ˆfδ  will 
not degrade the best achievable performance of the proposed PTA-IE scheme  
 111
M
ea
n 
Sq
ua
re
 E
rr
or
 (M
SE
)
PTAW
PTA – IE, 1st iteration
PTA – IE, 2nd iteration
PTA – IE, 3rd iteration
PTA – IE, 4th iteration
PTAW – ICI Free
Signal to Noise Ratio (dB)
0 5 10 15 20 25 30 35 40 45 50
10-2
10-3
10-4
10-5
10-8
10-7
10-6
 
Fig. 8-5.  MSE performance of the PTA-IE scheme with 0.25fδ =  and the preset initial 
CFO estimation ˆ 0.1fδ = −  under ITU-3 channel model.  
 
To further investigate the stability of our proposed scheme applying a preset initial CFO 
estimation ˆfδ , we show the estimation performance for different applied preset values. Fig. 
8-6 shows the performance improvement of the PTA-IE scheme by using different preset 
values of ˆfδ  with 0.1fδ =  and SNR = 50 dB. It must be noted that this preset value cannot 
be set to  ˆ 0fδ = , which leads to an invalid value of ( )0 ˆˆ 1 sin f NπδΓ = . It is found that 
even when the preset ˆfδ  greatly deviates from the actual fδ , our proposed scheme still 
performs very well for multiple iterations. When the preset ˆfδ  greatly deviates from the 
actual fδ , the performance of the 1-st iteration could be worse than that obtained via the 
conventional PTAW scheme. For the case with more than 3 iterations, the estimation 
performance can almost achieve the corresponding performance floor. Moreover, it is found 
that a smaller deviation of the preset ˆfδ  leads to a better estimation performance for the 
same number of iterations. If the preset ˆfδ  is set to be the actual CFO fδ , the performance 
 113
 
B
it 
Er
ro
r R
at
e 
(B
ER
)
Original
PTAW
PTA – IE, 1st iteration
PTA – IE, 2nd iteration
PTA – IE, 3rd iteration
PTAW – ICI Free
Analytical Result
Signal to Noise Ratio (dB)
0 5 10 15 20 25 30 35 40
100
10-1
10-2
10-3
10-5
10-4
 
Fig. 8-7.  BER performance comparison for 0.1fδ =  under ITU-3 channel model. 
 
 115
work, a novel technique for diversity combining is proposed so that soft handoff can be 
implemented. We call it Strategy III. In Strategy III, the receiver has a similar operation as in 
Strategy II during the non-handoff state. Once the soft handoff mode is initiated, the diversity 
combining can be solved by using a new sampling rate and applying the Alamouti space time 
code (STC). Compared to Strategy I, Strategy III has a smaller sampling rate and a smaller 
DFT size. Compared to Strategy II, Strategy III will need only one DFT block despite having 
only a slightly higher sampling rate and DFT size. 
 
9.1. System and Channel Models 
A. System Model 
In this work, an OFDMA-based cellular system with a reuse factor β  is considered. 
The total available bandwidth is β ×Ω , and the bandwidth allocated to each cell is Ω  
corresponding to N  subcarriers. In OFDMA systems, there are two major subcarrier 
assignment schemes, the subband-based scheme and the interleaved scheme [100]-[103]. 
Let’s assume that every mobile station (MS) occupies one subchannel, corresponding to M  
subcarriers, in a cell. There are /K N M=  subchannels available in each cell. In the 
subband-based scheme, the k-th subchannel, 1~0 −= Kk , occupies the kM -th to the 
)1)1(( −+ Mk -th subcarriers. In the interleaved scheme, the k-th subchannel occupies the 
( )k mK+ -th subcarriers, 0 ~ 1m M= − . 
All base stations (BSs) are assumed to be synchronized with each other through a 
backbone network or some other timing systems. When an MS is near the boundary of two 
neighboring cells, it can receive both signals coming from the two corresponding BSs, BS1 
and BS2, simultaneously. Define ( )x t  the transmitted time-domain signal from BS1, nX  
the corresponding data on the n-th subcarrier, and ( )xh t  the channel impulse response from 
BS1 to the MS. ( )y t , nY  and ( )yh t  have similar definitions except that the corresponding 
BS is BS2. The applied carrier frequencies in BS1 and BS2 are 1f  and 2f , respectively. The 
cyclic prefix (CP) based OFDMA systems are considered, and the maximum delay spread of 
the channel impulse response is assumed to be less than the CP duration cpT . The subcarrier 
spacing is fΔ , and the OFDM symbol duration is 1/T f= Δ . The transmitted signal from 
BS1 can be represented as 
 117
Considering the IEEE 802.16e standard with 1024N = , one OFDM symbol occupies 
102.9 sμ  including the CP duration of 11.4 sμ  [104], [105]. If the path difference is 1.5 km, 
corresponding to 5t sμΔ = , and the maximum delay spread for a typical urban channel is 
5 sμ  [2], then the inequality 11.4 5 5s s sμ μ μ> +  holds implying no inter-symbol 
interference (ISI) introduced into the received signal ( )xyr t . As long as cpT  is larger than tΔ  
plus the maximum delay spread of ( )yh t , then the received signal component 
( ), 0yr t t t T− Δ ≤ ≤ , is a circular shift version of ( ), 0yr t t T≤ ≤ , and therefore no distortion 
occurs. This implies that there is no distortion or only little distortion induced by tΔ  in most 
communication scenarios.  
 
B. Channel Model 
The ITU multipath fading channel model is adopted in this work [106]. There are six 
types of ITU channel models with different parameters, called ITU-1 ~ ITU-6. The channel 
impulse response for ITU-i can be expressed as 
 
1
, , ,0
( ) ( )i
L
ITU i i l i ll
h t tϕ δ τ−== × −∑ ,  1 6i≤ ≤ .                    (9-6) 
where iL  is the tap number; and ,i lτ  and ,i lϕ  are the relative delay and the channel gain 
coefficient with average power ,i lη , respectively, all corresponding to the l -th path. Since 
mobility is considered in this work, ITU-5 model (vehicular environment channel model A) is 
adopted in the simulation. The related parameters of ITU-5 are summarized as  
5,0 5,1 5,2 5,3 5,4 5,5
5,0 5,1 5,2 5,3 5,4 5,5
[ ] [0 310 710 1090 1730 2510] nsec
[ ] [0 1 9 10 15 20] dB
τ τ τ τ τ τ
η η η η η η
=⎧⎨ = − − − − −⎩
. 
 
9.2. Diversity Combining Scheme for Soft Handoff 
In this section, the soft handoff combining mechanism in the receiver is addressed. Fig. 
9-1 shows the block diagram of our proposed scheme in the receiver. The received signal 
( )xyr t  is passed through a down-converter with the oscillator frequency 1f , followed by a 
bandpass filter. The signal is sampled with the rate fNNf s ΔΔ+= )( , and then an 
 119
tΔ , the channel gain ,Y nH  turns into 22 ( / 2 ) /, j n N f T t TY nH e π− − + Δ . However, this does not affect 
system performance. For the sake of convenience, 22 ( / 2 ) /,
j n N f T t T
Y nH e
π− − + Δ  is replaced by 
,Y nH ′  in the followings, and (9-7) is re-written as 
2 1
1 1
2 ( )2 ( / 2) / 2 ( / 2) /
, ,
0 0
( ) ( ).
N N
j f f tj n N t T j n N t T
x n X n y n Y n
n n
r t E X H e E Y H e e w tππ π
− − −− −
= =
′= + × +∑ ∑     (9-8) 
Without loss of generality, 2f  is assumed to be larger than 1f . Moreover, for 
non-overlapping band allocation, the carrier frequencies 1f  and 2f  are generally designed 
to satisfy the relationship 2 1 ,f f C N f− = × Δ  where C is an integer and 1 1C β≤ ≤ − . 
By adjusting the sampling rate from sf N f= Δ  to fNNf s ΔΔ+= )(  and applying an 
)( NN Δ+ -point DFT, the signals coming from the two desired BSs can be directly diversity 
combined to enhance the receiving performance, where NΔ  is a parameter depending on the 
subcarrier allocation of ( )x t  and ( )y t . For example, as shown in Fig. 9-2, the number of 
subcarriers in a sub-band is 8=N , the desired data subcarriers from BS1 and BS2 are 
0 1( , )X X  and 2 3( , )Y Y , respectively. If the sub-band separation parameter 1C =  (i.e. the 
two desired sub-bands are adjacent bands) and 2NΔ = , then the applied DFT size is 
10N N+ Δ = . Consequently, we have the received signal in the frequency-domain as 
0 9
0 ,0 1 ,1 2 ,2 3 ,3 4 ,4 5 ,5 6 ,6 7 ,7
2 ,2 3 ,3 4 ,4 5 ,5 6 ,6 7 ,7 0 ,0 1 ,1
0 1 2 3 4 5 6 7 8 9
[ ]
0 0
0 0 ,
X X X X X X X X
Y Y Y Y Y Y Y Y
R R
X H X H X H X H X H X H X H X H
Y H Y H Y H Y H Y H Y H Y H Y H
W W W W W W W W W W
⎡ ⎤⎢ ⎥+ + + + + + + + + +⎢ ⎥′ ′ ′ ′ ′ ′ ′ ′⎢ ⎥= ⎢ ⎥+ + + + + + + + + +⎢ ⎥⎢ ⎥⎣ ⎦
"
 
where iW  denotes the channel noise on subcarrier i . In this way, 0X  and 2Y , as well as 
1X  and 3Y , are combined on a subcarrier without any other undesired signal. Fig. 9-2 
presents the concept of choosing NΔ  in the frequency domain for the above example. After 
down-converting, we have 0X  on the frequency 0 4Xf f= − Δ , 1X  on the frequency 
1
3Xf f= − Δ , 2Y  on the frequency 2 6Yf f= Δ , and 3Y  on the frequency 3 7Yf f= Δ . 
According to the sampling theory, when sampling rate 10sf f= Δ  is employed, the signal on 
 121
, 0 ~ 1m m m mR A B W m N N= + + = + Δ − ,                    (9-10) 
where the noise terms , 0 ~ 1mW m N N= + Δ −  are the DFT values of 
[ ], 0 ~ 1sw kT k N N= + Δ − , , , for 0 ~ 10, for ~ 1
x m X m
m
E X H m NA
m N N N
⎧ ′ = −⎪= ⎨ = + Δ −⎪⎩
 and  
( ) mod( ) ,( ) mod( ) , for ( )mod( ) 1
0, for ( )mod( ) 1
y m CN N N Y m CN N N
m
E Y H m CN N N N
B
m CN N N N
− +Δ − +Δ⎧ ′ ′ − + Δ ≤ −⎪= ⎨ − + Δ > −⎪⎩
. 
The detailed derivation of (9-10) is shown as follows. According to (9-9), the sampled signal 
can be rewritten as  
[ ] [ ] [ ] [ ]s sr kT a k b k w kT= + + , for 0, , 1k N N= + Δ −" , 
where
1 2 ( / 2)
,
0
[ ]
kN j n N
N N
x n X n
n
a k E X H e
π− − +Δ
=
= ∑ and 1 2 ( / 2) 2,
0
[ ]
k CNkN j n N j
N N N N
y n Y n
n
b k E Y H e e
π π− − +Δ +Δ
=
′= ∑ . 
After applying an )( NN Δ+ -point DFT, the frequency-domain outcome corresponding to 
[ ]a k , for 0, , 1k N N= + Δ −" , is 
1 2 ( / 2)
0
1 1 2 ( )
,
0 0
,
,
[ ]
( ) for 0 ~ 1
0 for ~ 1
for 0 ~ 1,
0 for ~ 1
kN N j m N
N N
m
k
kN N N j n m
N N
x n X n
n k
x m X m
x m X m
A a k e
E X H e
E N N X H m N
m N N N
E X H m N
m N N N
π
π
+Δ − − − +Δ
=
− +Δ − − +Δ
= =
=
=
⎧ + Δ = −⎪= ⎨ = + Δ −⎪⎩
⎧ ′ = −⎪= ⎨ = + Δ −⎪⎩
∑
∑ ∑
 
where ( )x xE E N N′ = + Δ . 
Similarly, the frequency-domain outcome corresponding to [ ]b k , for 
0, , 1k N N= + Δ −" , is 
 123
Frequency domain on              
the     -th  subchannel
In the l-th symbol interval:
In the (l+1)-th symbol interval:
BS1 BS2
Information
source Modulator
MS
Backbone Network
(1) (1) (1) (1)
,0 ,1 , 1[ ]l l l l MX X X −=X "
(2) (2) (2) (2)
,0 ,1 , 1[ ]l l l l MX X X −=X "
Frequency domain on                      
the     -th  subchannel
In the l-th symbol interval:
In the (l+1)-th symbol interval:
1k
(1)
lX
(2)*
l−X (1)*lX
(2)
lX
2k
 
Fig. 9-3.  The proposed soft handoff strategy for OFDMA-based cellular systems. 
 
According to the channel allocation scheme, subband-based or interleaved, a different 
criterion for deriving a suitable NΔ  is required.  
(a) Subband-based Channel Allocation 
Assume that the desired MS uses the 1k -th subchannel in BS1 and the 2k -th subchannel 
in BS2. Specifically, BS1 transmits (1),l mX  and 
(2)*
,l mX−  on the )( 1 mMk + -th subcarrier in the 
l-th and the (l+1)-th OFDM symbols, respectively; and BS2 sends (2),l mX  and 
(1) *
,l mX  on the 
)( 2 mMk + -th subcarrier in the l-th and the (l+1)-th OFDM symbols, respectively. Every pair 
of desired subcarriers used for diversity combining has the same frequency separation of 
( )2 1( )k CK M k M f+ − Δ . The parameter NΔ  depends on the values of 1k , 2k , and C , but 
with the constraint that the sampling rate sf  must be larger than the minimum allowable rate 
N fΔ  (i.e., 0NΔ ≥ ). 
Case 1: 1 2 ( 1)k k C K≤ + −  
In this case, the frequency separation ( )2 1( )k CK M k M f+ − Δ  is larger than N fΔ . In 
 125
fΔ
1 2
General parameters:
8, 2, 4,
0, 1
N M K
k k
= = =
= =
( ) 1, 10 , 2sa C f f N= = Δ Δ =
( ) 2, 18 , 10sb C f f N= = Δ Δ = ( ) 2, 9 , 1sc C f f N= = Δ Δ =
( )2 1( )k CK M k M f+ − Δ ( )2 1( )k CK M k M f+ − Δ
( )2 1( )k CK M k M f+ − Δ
(1)
,0lX
(1)
,1lX
(2)
,0lX
(2)
,1lX
: frequency on DC
: frequency on  f2 - f1*
f
f*16 fΔf
f
*16 fΔ
f
f
*8 fΔ
 
Fig. 9-4.  Examples illustrate how a suitable NΔ  is determined for subband-based channel 
allocation scheme with 1 2 ( 1)k k C K≤ + − . 
 
Case 2: 1 2 ( 1)k k C K> + −  
In this case, the frequency separation ( )2 1( )k CK M k M f+ − Δ  is smaller than N fΔ . 
Thus, setting ( )2 1( )sf k CK M k M f= + − Δ  cannot reconstruct the frequency-domain signals. 
To prevent the desired signals on the 1k -th subchannel from being interfered by the signals 
coming from BS2, we must have 1(2 )sf N k M f≥ − Δ . On the other hand, to prevent the 
desired signals on the 2k -th subchannel from being interfered, we must have 
2( ( 1) )sf N k M f≥ + + Δ . Consequently, the appropriate NΔ  can be obtained as 
 { }1 2max ( ) , ( 1)N K k M k MΔ = − + .                    (9-13) 
According to (9-10), the concerned frequency-domain signals in the l-th and in the (l+1)-th 
symbol intervals are 
 127
Case 1: 1 2 ( 1)k k C K≤ + −  
By similar arguments, we have the optimal NΔ  as  
2 1( )min for any positive integer s.t. is a positive integerC n N k kN n
n
α α⎧ ⎫− + −Δ = =⎨ ⎬⎩ ⎭ . (9-15) 
After )( NN Δ+ -point DFT, the concerned frequency-domain signals in the l-th and in the 
(l+1)-th symbol intervals are 
1 1 2 1
1 1 2 1
(1) (2)
, 1 , 1, 2 , 2, ,
(2)* (1) *
1, 1 , 1, 2 , 2, 1,
l k mK l m k mK l m k mK l k mK
l k mK l m k mK l m k mK l k mK
R E X H E X H W
R E X H E X H W
+ + + +
+ + + + + +
⎧ ′ ′= + +⎪⎨ ′ ′= − + +⎪⎩
, for 0, , 1m M= −" . (9-16) 
By applying the standard Alamouti STC decoding process, (1)lX  and 
(2)
lX  can be obtained 
with a diversity order 2. As shown in Fig. 9-5(b), if 1 0k =  and 2 2k = , we have 2NΔ = . 
Furthermore, (1) (2),0 ,0andl lX X  coexist on the same subcarrier, and so do 
(1) (2)
,1 ,1andl lX X . 
Case 2: 1 2 ( 1)k k C K> + −  
In this case, NΔ  can be obtained by similar arguments as 
2 1N K k kΔ = + − .                           (9-17) 
After )( NN Δ+ -point DFT, the concerned frequency-domain signals in the l-th and in the 
(l+1)-th symbol intervals are 
1 1 2 1
1 1 1
2 2 2
1 1
(1) (2)
, 1 , 1, 2 , 1 2, ( 1) ,
(1)
, ( 1) 1 , 1 1, ( 1) , ( 1)
(2)
, 2 ,0 2, ,
(2)*
1, 1 , 1, 2
, for 0, , 2l k mK l m k mK l m k m K l k mK
l k M K l M k M K l k M K
l N k l k l N k
l k mK l m k mK l
R E X H E X H W m M
R E X H W
R E X H W
R E X H E X
+ + + + + +
+ − − + − + −
+ +
+ + +
⎧ ′ ′= + + = −⎪⎪ ′= +⎨⎪ ′= +⎪⎩
′ ′= − +
"
2 1
1 1 1
2 2 2
(1) *
, 1 2, ( 1) 1,
(2) *
1, ( 1) 1 , 1 1, ( 1) 1, ( 1)
(1)*
1, 2 ,0 2, 1,
, for 0, , 2m k m K l k mK
l k M K l M k M K l k M K
l N k l k l N k
H W m M
R E X H W
R E X H W
+ + + + +
+ + − − + − + + −
+ + + +
⎧⎪⎪⎪⎪⎪⎨⎧ + = −⎪⎪⎪⎪ ′= − +⎪⎨⎪⎪ ′= +⎪⎪⎩⎩
"
. 
(9-18) 
Similarly, (1)lX  and 
(2)
lX  can be obtained with a diversity order 2. As shown in Fig. 9-5(c), 
if 1 2k =  and 2 0k = , we have 2 1 2N K k kΔ = + − = . Moreover, (1) (2),0 ,1andl lX X  coexist on 
 129
6 0,1,2,3,4,5,6,7 6 0,2,4,6 
7 0,1,2,3,4,5,6,7 7 1,3,5,7 
 
 
9.3. System Performance 
In this section, we determine system performance of the proposed scheme in both the 
soft handoff and non-handoff states. When the MS is in the non-handoff state, we have the 
desired signal as 
1
2 ( / 2) /
,
0
( ) ( ),
N
j n N t T
x n X n
n
r t E X H e w tπ
− −
=
= +∑                       (9-19) 
where ( )w t  is the filtered complex AWGN with the auto-correlation function 
0( ) sinc( )wR N N f N fτ τ= Δ Δ . By sampling ( )r t  at the rate N fΔ  and applying DFT, we get 
, , for 0, , 1m x m X m mR E X H W m N′= + = −" ,                  (9-20) 
where the noise power can be determined as 
 
*
1 12 ( / 2) 2 ( / 2)*
0 0
2
0
[ ] ( ) ( )
.
k kN Nj m N j m N
N N
m m
k k
E W W E w k e w k e
N N f
π π− −− − − −
= =
⎡ ⎤⎛ ⎞⎛ ⎞⎢ ⎥= ⎜ ⎟⎜ ⎟⎢ ⎥⎝ ⎠⎝ ⎠⎣ ⎦
= Δ
∑ ∑           (9-21) 
As a result, we have the signal to noise power ratio (SNR) for the non-handoff state as 
2 22 2
, ,
2
0 0
x m X m x m X m
NHO
E X H E X H
SNR E E
N N f N f
⎡ ⎤ ⎡ ⎤′⎢ ⎥ ⎢ ⎥= =Δ Δ⎢ ⎥ ⎢ ⎥⎣ ⎦ ⎣ ⎦
.               (9-22) 
On the other hand, when the MS is in the soft handoff state, the desired signal is 
2 1
1 1
2 ( )2 ( / 2) / 2 ( / 2) /
, ,
0 0
( ) ( )
N N
j f f tj n N t T j n N t T
x n X n y n Y n
n n
r t E X H e E Y H e e w tππ π
− − −− −
= =
= + × +∑ ∑ .     
(9-23) 
By applying the sampling rate ( )N N f+ Δ Δ , in the frequency-domain, the signals on the two 
subcarriers corresponding to BS1 and BS2 may be directly combined on the same subcarrier 
 131
2
1 1 1( ) 1 2
4 1 2 / 1 2 /Ala
P γ γ γ
⎛ ⎞ ⎛ ⎞= − +⎜ ⎟ ⎜ ⎟⎜ ⎟ ⎜ ⎟+ +⎝ ⎠ ⎝ ⎠
   ,                    (9-26) 
where 0bE Nγ =   is the average overall bit energy to noise power density ratio. 
Correspondingly, if the MS is in the 2-way soft handoff state and the Alamouti STC decoding 
rule is applied in the receiver, we have b x yE E E= + . Specifically, assuming that 
x y bE E E= =  and taking the noise enhancement phenomenon into consideration, the BER 
performance can be expressed as  
_ ( ) (2 / 2) ( )HO A Ala AlaP P Pγ γ γ= = .                    (9-27) 
On the other hand, if the MS is in the 2-way soft handoff state and the MRC combining rule 
is applied in the receiver, we have the BER performance expressed as [2] 
2
_
1( ) 1 2
4 1 1HO M
P γ γγ γ γ
⎛ ⎞ ⎛ ⎞= − +⎜ ⎟ ⎜ ⎟+ +⎝ ⎠ ⎝ ⎠
.                     (9-28) 
Consequently, the average BER performance for the MS in the soft handoff state can be 
represented as 
1 _ 2 _( ) ( ) ( )HO HO A HO MP p P p Pγ γ γ= × + × ,                 (9-29) 
where 1p  denotes the proportion of applying the Alamouti STC decoding rule, and 2p  
denotes the proportion of applying MRC combining rule. 1p  and 2p  depend on the 
subcarrier assignment, as well as the parameters 1k , 2k , C  and K . For example, in the 
subband based channel allocation with 1 2 ( 1)k k C K≤ + − , we have 1 1p =  and 2 0p = . The 
values of 1p  and 2p  will be further discussed in Subsection IV. B. 
 
B. Simulation and Numerical Results 
To further study the performance of our proposed scheme, we investigate the BER 
performance for some specific cases over the ITU-5 channel model via simulation. The 
system parameters are assumed to be 1024N = , 10.93 kHzfΔ = , 1C = , the OFDM symbol 
duration equals to 102.9 sμ  including the CP duration 11.4 sμ , and the data modulation is 
 133
10-4
10-3
10-2
10-1
100
Bi
t 
Er
ro
r 
Pr
ob
ab
ili
ty
0 5 10 15
(dB)γ
Non-handoff state  Analytical
Soft handoff  state  Analytical  “k1=k2” & “M=N”
Subband based “k1=k2” Simulation
Interleaved “k1=k2” Simulation
“M=N” Simulation
 
Fig. 9-6.  The bit error probability versus γ  for BPSK modulation with the condition 
1 2k k=  and M N=  over the ITU channel model. 
 
(c) General case for subband-based channel allocation 
For Case 1 of subband-based channel allocation, the Alamouti STC decoding rule is 
employed on all subcarriers, and then we have 1 1p =  and 2 0p = . Therefore the theoretical 
BER is _ ( )HO AP γ . On the other hand, for Case 2 of subband-based channel allocation, the 
MRC combining rule is employed on all subcarriers, i.e. 1 0p =  and 2 1p = , and we have 
the theoretical BER being _ ( )HO MP γ . The simulation results are shown in Fig. 9-7. It is 
assumed that the number of subcarriers in one subchannel is 64M =  and two scenarios are 
investigated: the scenario with 1 5k =  and 2 10k =  corresponds to Case 1, and the scenario 
with 1 10k =  and 2 5k =  corresponds to Case 2. The simulation results still fit in very well 
with the theoretical results. When compared with the non-handoff case, a gain of 5.5 dB or 
8.5 dB in SNR can be obtained at 2BER 10−=  via applying the proposed soft handoff 
scheme. 
 
 135
Compared with the non-handoff case, a gain of 5.5 dB - 6.5 dB in SNR can be obtained at 
2BER 10−=  via applying the proposed soft handoff scheme.  
 
0 5 10 15
10-4
10-3
10-2
10-1
100
Bi
t 
Er
ro
r 
Pr
ob
ab
ili
ty
Analytical   Simulation 
:  Scenario I
:  Scenario II
:  Scenario III
:  Scenario IV
: Analytical non-handoff state
(dB)γ  
Fig. 9-8.  The bit error probability versus γ  for the interleaved channel allocation scheme 
with BPSK modulation over the ITU channel model. 
 
C. Strategy I & II & III Comparison 
As mentioned in Section I, Strategy I requires a sampling rate of sf N fβ= × Δ  and a 
DFT size of Nβ ×  at all times [99], which will dramatically increase the hardware 
complexity. The BPSK BER performance of Strategy I for an MS in the non-handoff and soft 
handoff states is 
_
_ _
( ) ( ), in non-handoff state
( ) ( ), in soft handoff state
I NHO NHO
I HO HO M
P P
P P
γ γ
γ γ
=⎧⎨ =⎩
                    (9-30) 
For Strategy II, it needs a sampling rate of sf N f= Δ  and a DFT size of N  at all times; 
however two receivers are required when the soft handoff is activated. The BPSK BER 
performance of Strategy II for an MS in the non-handoff and soft handoff states is the same as 
 137
10. Conclusions 
In this project, we study the UWB channel model and implement a UWB channel 
emulator based on the DSP platform - TMS320-C6x EValuation Module (EVM) combined 
with 167MHz Floating-Point Digital Signal Processor TMS320C6701. By using this channel 
emulator, we can generate a specific transmitted signal as input to emulate the received UWB 
signal. Users can test their new algorithms for UWB communication systems to determine the 
performance. We also devise a novel M-CSK modulation technique based on the large set of 
Kasami sequences for the applications of DSSS UWB communications. The modulation and 
demodulation schemes are developed, and the system performance based on power efficiency, 
bandwidth efficiency and hardware complexity is thoroughly investigated. For the aspect of 
bandwidth efficiency, the proposed Kasami sequences M-CSK modulation outperforms other 
schemes with a gain of 50 %. For the aspect of power efficiency, the proposed scheme is 
found to outperform other schemes with an improvement of 1dB in bit energy-to-noise power 
spectral density ratio under an AWGN channel; however the power efficiency is found to be 
almost equivalent under the UWB channel. 
In addition, we develop multiple performance enhancement techniques for 
OFDM/OFDMA-based systems, including channel estimation, CFO estimation, PAPR 
reduction, CFO estimation with ICI elimination, and diversity combining for soft-handoff. In 
the channel estimation issue, we propose TRLI-LSE, TRLI-ASR and TREO-ASR schemes for 
the channel estimation in MB-OFDM systems. By applying the proposed methods, the 
estimation performance can be significantly improved when there is a strong interference. 
Even when there is no interference, the proposed methods can still improve the estimation 
performance in a low frequency-selective channel. In the CFO estimation issue, we propose 
two modified algorithms for CFO estimation based on the conventional PTA and CPB 
methods. The key idea of our algorithms is exploitation of the CFO information embedded in 
data subcarriers for CFO estimation without the necessity of decoding data first. Compared to 
the conventional schemes, we conclude that the proposed schemes, including the MPTA and 
MCPB schemes, can significantly improve the estimation performance at the cost of an 
increase in computational complexity. In the PAPR reduction issue, we have proposed a 
modified PTS scheme by applying pre-determined non-uniform phase sets for PAPR 
reduction in OFDM systems. The optimal phase factors for PTS and the corresponding 
performance improvement for both interleaved partition and adjacent partition have been well 
investigated. It is found that an improvement of 0.8 – 0.25 dB in PAPR reduction for different 
 139
11. References 
[1] J. R. Foerster, Ed., “Channel Modeling Sub-committee Report Final,” IEEE 
P802.15-02/368r5 SG3a contribution. 
[2] G. L. Stuber, “Principles of Mobile Communication,” 2nd Ed., Kluwer Academic 
Publishers, 2001. 
[3] “TMS320C6000 CPU and Instruction Set Reference Guide.” 
[4] http://www.numerix-dsp.com/dspintro.html. 
[5] http://focus.ti.com/docs/prod/folders/print/tms320c6701.html.  
[6] K. Siwiak., “Ultra-wide band radio: introducing a new technology,” in Proc. IEEE 
Vehicular Technology Conf. (VTC), vol. 2, pp. 1088-1093, 6-9 May 2001. 
[7] K. Siwiak, P. Withington, and S. Phelan, “Ultra-wide band radio: the emergence of an 
important new technology,” in Proc. IEEE Vehicular Technology Conf. (VTC), vol. 2, pp. 
1169-1172, 6-9 May 2001. 
[8] R. F. Martin, “Ultra-wideband (UWB) rules and design compliance issues,” in Proc. 
IEEE International Symposium on Electromagnetic Compatibility, vol. 1, pp. 91-96, 
18-22 Aug. 2003. 
[9] D. Porcino and W. Hirt, “Ultra-wideband radio technology-- potential and challenges 
ahead,” IEEE Commun. Magazine, vol. 41, pp. 66-74, July 2003. 
[10] M. Z. Win and R. A. Scholtz, “Impulse radio: how it works,” IEEE Commun. Lett., vol. 2, 
pp. 36-38, Feb. 1998. 
[11] H. Lee, B. Han, Y. Shin, and S. Im, “Multipath characteristics of impulse radio 
channels,” in Proc. IEEE Vehicular Technology Conf. (VTC), vol. 3, pp. 2487-2491, 
15-18 May 2000. 
[12] M. Z. Win, “A unified spectral analysis of generalized time-hopping spread-spectrum 
signals in the presence of timing jitter,” IEEE J. Select. Areas Commun., vol. 20, pp. 
1664-1676, Dec. 2002. 
[13] C. A. Corral, S. Sibecas, S. Emami, and G. Stratis, “Pulse spectrum optimization for 
ultra-wideband communication,” in Proc. IEEE Conf. on Ultra Wideband Systems and 
 141
impulse radio,” IEEE J. Select. Areas Commun., vol. 20, pp. 1652-1663, Dec. 2002. 
[24] “MERGED PROPOSAL #1,” 
 http://grouper.ieee.org/groups/802/15/pub/TG3a_CFP.html 
[25] “MERGED PROPOSAL #2,” 
 http://grouper.ieee.org/groups/802/15/pub/TG3a_CFP.html 
[26] A. G. Burr, “Capacity improvement of CDMA systems using M-ary code shift keying,” 
in Proc. IEEE Sixth International Conf. on Mobile Radio and Personal Commun., pp. 
63-67, 9-11 Dec. 1991. 
[27] A. G. Burr, “Spherical codes for M-ary code shift keying,” in Proc. Second IEE National 
Conf. on Telecommunications, pp. 67-72, 2-5 Apr. 1989. 
[28] A. G. Burr, “Coded M-CSK for CDMA systems,” IEE Colloquium on Spread Spectrum 
Techniques for Radio Commun. Systems, pp. 2/1 -2/6, 4 June 1992. 
[29] D. V. Sarwate and M. B. Pursley, “Crosscorrelation properties of pseudorandom and 
related sequences,” Proc. IEEE, vol. 68, pp. 593-619, May 1980. 
[30] T. Kasami, “Weight distribution formula for some class of cyclic codes,” Coordinated 
Science Lab., Univ. Illinois, Urbana. Tech. Rep. R-285(AD 632574), 1966. 
[31] R. L. Peterson, R. E. Ziemer and D. E. Borth, Introduction to spread spectrum 
communications, Prentice Hall International Editions, New Jersey, 1995. 
[32] IEEE standard 802.15.3-2003, “Part 15.3: Wireless Medium Access Control (MAC) and 
Physical Layer (PHY) Specification for High Rate Wireless Personal Area Networks,” 
Sep. 2003. 
[33] B. M. Sadler and A. Swami, “On the performance of UWB and DS-spread spectrum 
communication systems,” in Proc. IEEE Conf. on Ultra Wideband Systems and 
Technologies, pp. 289-292, 21-23 May 2002. 
[34] J. D. Choi and W. E. Stark, “Performance analysis of ultra-wideband spread-spectrum 
communications in narrowband interference,” in Proc. IEEE Conf. on Military 
Communications, pp. 1075-1080, vol.2, 7-10 Oct. 2002.  
[35] M. Morelli and U. Mengali, “A Comparison of Pilot-Aided Channel Estimation Methods 
 143
[47] A. Batra et al., “Multi-band OFDM Physical Layer Proposal for IEEE 802.15 Task 
Group 3a,” IEEE P802.15-03/268. 
[48] S. Coleri, M. Ergen, A. Puri and A. Bahai, “Channel estimation techniques based on pilot 
arrangement in OFDM systems,” IEEE Trans. Broadcasting, vol. 48, no. 3, pp. 223–229, 
Sep. 2002. 
[49] J. M. Mendel, Lessons in Estimation Theory for Signal Processing, Communications and 
Control, New Jersey, Prentice-Hall, 1995. 
[50] A. V. Oppenheim, R. W. Schafer and J. R. Buck, Discrete-time Signal Processing, 2nd 
Edition, New Jersyey, Prentice-Hall, 1999. 
[51] J. Kim, J. Park and D. Hong, “Performance Analysis of Channel Estimation in OFDM 
Systems,” IEEE Signal Processing Letters, vol. 12, no. 1, pp. 60-62, Jan. 2005. 
[52] P. Moose, “A technique for orthogonal frequency division multiplexing frequency offset 
correction,” IEEE Trans. Commun., vol. 42, pp. 2908-2914, Oct. 1994. 
[53] J. Lei and T. S. Ng, “A consistent OFDM carrier frequency offset estimator based on 
distinctively spaced pilot tones,” IEEE Trans. Wireless Commun., vol. 3, pp. 588-599, 
March 2004. 
[54] W. Zhang, X. G. Xia, and P. C. Ching, “Clustered pilot tones for carrier frequency offset 
estimation in OFDM systems,” IEEE Trans. Wireless Commun., vol. 6, pp. 101-109, Jan. 
2007. 
[55] S. Kapoor, D. J. Marchok, and Y.-F. Huang, “Pilot assisted synchronization for wireless 
OFDM systems over fast time varying fading channels,” in Proc. IEEE Vehicular 
Technology Conf. (VTC), vol. 3, pp. 2077-2080, 18-21 May 1998. 
[56] W. Lei, W. Cheng, and L. Sun, “Improved joint carrier and sampling frequency offset 
estimation scheme for OFDM systems,” in Proc. IEEE Global Telecommunications 
Conf., 2003 (GLOBECOM '03), vol. 4, pp. 2315 – 2319, 1-5 Dec. 2003. 
[57] H. Chen and G.J. Pottie, "A comparison of frequency offset tracking algorithms for 
OFDM", in Proc. IEEE Global Telecommunications Conf., 2003 (GLOBECOM '03), 
vol.2, pp. 1069-1073, 1-5 Dec. 2003. 
[58] P. Liu, B. B. Li, Z. Y. Lu, and F. K. Gong “A new frequency synchronization scheme for 
 145
[70] K. Shi, E. Serpedin, and P. Ciblat, “Decision-directed fine synchronization in OFDM 
systems,” IEEE Trans. Commun., vol. 53, pp. 408-412, Mar. 2005. 
[71] K. Shi, E. Serpedin, and P. Ciblat, “Decision-directed fine synchronization for coded 
OFDM systems,” in Proc. IEEE International Conf. on Acoustics, Speech, and Signal 
Processing. (ICASSP’04), vol. 4, pp. 365-368, 17-21 May 2004. 
[72] “Channel Models and Performance Metrics for IEEE 802.16j Relay Task Group,” IEEE 
802.16j Relay Task Group. 
[73] Steven M. Kay, Fundamentals of Statistical Signal Processing: Estimation Theory, 
Prentice Hall. 
[74] IEEE Standard for Local and metropolitan area networks Part 16：Air Interface for Fixed 
Broadband Wireless Access Systems. 
[75] S. Boyd and L. Vandenberghe, Convex Optimization, Cambridge University Press. 
[76] S. H. Muller, and J.B. Huber, “OFDM with reduced peak-to-average power ratio by 
optimum combination of partial transmit sequences,” Electron. Letters, vol. 33, no. 5, pp. 
368-369, Feb. 1997.  
[77] S. G. Kang, J. G. Kim, and E. K. Joo, “A novel subblock partition scheme for partial 
transmit sequence OFDM,” IEEE Trans. Broadcast., vol. 45, no. 3, pp. 333-338, Sep. 
1999.  
[78] L. J. Cimini, Jr., and N. R. Sollenberger, “Peak-to-average power ratio reduction of an 
OFDM signal using partial transmit sequences,” IEEE Commun. Letters, vol. 4, no. 3, 
pp.86 - 88, Mar. 2000. 
[79] A. Alavi, C. Tellambura, and I. Fair, “PAPR reduction of OFDM signals using partial 
transmit sequence: an optimal approach using sphere decoding,” IEEE Commun. Letters, 
vol. 9, no. 11, pp. 982 - 984, Nov. 2005. 
[80] G. Lu, P. Wu and C. Carlemalm-Logothetis, “Enhanced interleaved partitioning PTS for 
peak-to-average power ratio reduction in OFDM systems,” Electron. Letters, vol. 42, no. 
17, pp. 983-984, Aug. 2006. 
[81] C. R. N. Athaudage, K. Sathananthan and R. R. V. Angiras, “Enhanced frequency 
synchronization for OFDM systems using timing error feedback compensation,” in Proc. 
 147
specifications,” IEEE Std 802.11g-2003, 2003. 
[92] “IEEE Standard for Local and Metropolitan Area Networks Part 16: Air Interface for 
Fixed Broadband Wireless Access Systems,” IEEE Std 802.16-2004 (Revision of IEEE 
Std 802.16-2001), 2004. 
[93] M. Shen, G. Li and H. Liu, “Effect of traffic channel configuration on the orthogonal 
frequency division multiple access downlink performance,” IEEE Trans. Wireless 
Commun., vol. 4, pp. 1901-1913, July 2005. 
[94] D. Kivanc, G. Li and H. Liu, “Computationally efficient bandwidth allocation and power 
control for OFDMA,” IEEE Trans. Wireless Commun., vol. 2, pp. 1150-1158, Nov. 2003. 
[95] Y. Xu, Q. L. Ding and C. C. Ko, “Impact of handoff protection strategies on cellular 
mobile system capacity,” IEEE Trans. Wireless Commun., vol. 3, pp. 1076-1087, July 
2004. 
[96] R. S. Chang and S. J. Leu, “Handoff ordering using signal strength for multimedia 
communications in wireless networks,” IEEE Trans. Wireless Commun., vol. 3, pp. 
1526-1532, Sep. 2004. 
[97] J. Lee, C. Kim and J. Kim, “On subcarrier allocation for soft hand-over in 
OFDMA-based cellular systems,” in Proc. IEEE Vehicular Technology Conf. (VTC), vol. 
5, pp. 3087-3091, 30 May-1 June 2005. 
[98] G. Lupo, R. Cautelier, M. Benedetto and F. Malena, “Dynamic resource allocation with a 
soft handover procedure for application in a broadband system,” in Proc. IEEE Vehicular 
Technology Conf. (VTC), vol. 4, pp. 2111-2115, 19-22 Sep. 1999. 
[99] H. Wang, C. C. Woo, and D. Hong, “A new subcarrier oriented handover scheme in 
downlink OFDMA cellular systems,” in Proc. IEEE Vehicular Technology Conf.(VTC), 
vol. 3, pp. 1618-1622, 25-28 Sep. 2005. 
[100] Z. Cao, U. Tureli, and P. Liu, “Optimum subcarrier assignment for OFDMA 
uplink,” in Proc. The Thirty-Seventh Asilomar Conference on Signals, Systems and 
Computers, vol. 1, pp. 708-712, 9-12 Nov. 2003. 
[101] G. Parsaee and A. Yarali, “OFDMA for the 4th generation cellular networks,” in 
Proc. Canadian Conf. on Electrical and Computer Engineering, vol. 4, pp. 2325-2330, 
 149
12. Self-evaluation 
The major goal of this project is to study the performance enhancement techniques for 
OFDM wireless communication systems. Several essential techniques, relating to modulation, 
channel gain estimation, CFO estimation, PAPR reduction, CFO estimation with ICI 
cancellation and handoff, have been proposed, which can significantly improve the 
transmission and receiving performance of UWB/OFDM wireless communication systems. 
These outcomes, including algorithms, theoretical results and simulation results, have been 
accepted or submitted to international journals and conferences for publication. Currently, two 
journal papers and five conference papers have been accepted and published.  
 
 151
  iy=iv[0]; 
 } 
 k = (*idum)/IQ; 
 *idum = IA*(*idum-k*IQ)-IR*k; 
 if (*idum < 0)  
  *idum += IM; 
 j = iy/NdIV; 
 iy = iv[j]; 
 iv[j] = *idum; 
 if ((temp=AM*iy) > RNMX)  
  return RNMX; 
 else return temp; 
} 
 
int main (void) 
{  
 int uwb(int channel,int SEEd);  
 int SEEd =12; // initialize state of function for repeatability 
 int channel=1; //選擇通道環境 
 volatile double *y;//channel response 
 volatile double *s;//輸入信號(input) 
 volatile double *s_re; 
 volatile double *h_temp; 
 volatile double *s_r; //接收信號(output) 
 
 #define y      (volatile double*) 0x02153400  
  
 #define s     (volatile double*) 0x02365400  
 #define s_re   (volatile double*) 0x02375400  
 #define h_temp (volatile double*) 0x02385400 
 #define s_r    (volatile double*) 0x02485400  
  
 int len_h; 
 int i,t; 
 for(int pp=0;pp<1;pp++) 
 { 
  len_h=uwb(channel,SEEd);  
//呼叫 uwb 函式產生 channel impulse response 
  double x1,x11,s1,*noise1,ran1,ran2; 
  int sigma=1; 
  long *idum; 
  idum = (long *)malloc(sizeof(long)); 
  *idum = SEEd;  
  noise1=(double*)calloc(2,sizeof(double)); 
   
  int k,len_s=5; 
 153
   double val=0; 
   for(t=0;t<len_s;t++)//----------product 
   {  
    val=val+*(h_temp+t+i)**(s_re+t); 
   } 
   *(s_r+i)=val; // 接收信號 
  }//----------------------------------------------------------- 
  FILE *fp6; //------------------ 儲存接收信號 
  fp6=fopen("s_r.txt","w"); 
  for(i=0;i<len_h+len_s-1;i++) 
  { 
   fprintf(fp6,"%f\n",*(s_r+i)); 
  } 
  fclose(fp6); //---------------------------------------- 
 }  
} 
#############################uwb 
#include<stdio.h> 
#include<math.h> 
#include <stdlib.h> 
#include<time.h> 
#include<ftc6x.h> 
 
#define IA 16807 
#define IM 2147483647 
#define AM (1.0/IM) 
#define IQ 127773 
#define IR 2836 
#define NTAB 32 
#define NdIV (1+(IM-1)/NTAB) 
#define EPS 1.2e-7 
#define RNMX (1.0-EPS) 
 
int num_channels=1;  //通道脈衝響應的個數  
double ts = 0.167; //取樣時間(nsec) 
//------------------------------------------------------------------------變數宣告 
//-----------------------------------------------------通道參數設定 
double Lam,lambda,gamma,Gam,std_ln_1,std_ln_2,std_shdw; 
int nlos; 
//-----------------------------------------------------連續時間模型 
double *h_2,*t_2,t0_2;//,*rand1,*rand2,*rand3 
int np_2,h_len_2; 
//-----------------------------------------------------離散時間模型 
int N_3,h_len_3,*t_Nfs;//; 
double *hN_3; 
//-----------------------------------------------------kaiser filter 
 155
  } 
  else 
  { 
   *idum = -(*idum); 
  } 
  for (j=NTAB+7;j>=0;j--) 
  { 
   k = (*idum)/IQ; 
   *idum = IA*(*idum-k*IQ)-IR*k; 
   if (*idum < 0)  
    *idum +=IM; 
   if (j < NTAB)  
    iv[j] = *idum; 
  } 
  iy=iv[0]; 
 } 
 k = (*idum)/IQ; 
 *idum = IA*(*idum-k*IQ)-IR*k; 
 if (*idum < 0)  
  *idum += IM; 
 j = iy/NdIV; 
 iy = iv[j]; 
 iv[j] = *idum; 
 if ((temp=AM*iy) > RNMX)  
  return RNMX; 
 else return temp; 
} 
//----------------------------------------------------------------- 
 
int uwb(int channel,int SEEd) //channel 選擇通道環境, SEEd 決定隨機便輸初始值 
{ 
 /*--------------------------------------------------------------通道參數設定 
    Lam      Cluster arrival rate in GHz (avg # of clusters per nsec) 
    lambda   Ray arrival rate in GHz (avg # of rays per nsec) 
    Gam      Cluster decay factor (time constant, nsec) 
    gamma    Ray decay factor (time constant, nsec) 
    std_ln_1 Standard deviation of log-normal variable for cluster fading 
    std_ln_2 Standard deviation of log-normal variable for ray fading 
    nlos  Flag to specify generation of Non Line Of Sight channels 
    std_shdw  Standard deviation of log-normal shadowing of entire impulse response*/ 
 
 if (channel==1)/*based on TDC measurements for LOS 0-4m*/ 
 { 
  Lam=0.0233; 
  lambda=2.5; 
  Gam = 7.1; 
  gamma = 4.3; 
 157
 double Tr=0,t_val=0,mu=0,ln_beta=0; 
 double h_val=0,sort_t=0,sort_h=0,energy=0; 
 double fac=0,ran1=0,ran2=0,ran3=0; 
 double ran4=0,ran5=0,ran6=0; 
 int z=0,h_r=0,k=0; 
 int ngrow=1000,path_ix=0; 
 int pk=0; 
 //int rr=0; 
 double x1,x11,s1,*noise1; 
 noise1=(double*)calloc(2,sizeof(double)); 
 double x2,x22,s2,*noise2; 
 noise2=(double*)calloc(2,sizeof(double));  
 double x3,x33,s3,*noise3; 
 noise3=(double*)calloc(2,sizeof(double)); 
 double sigma=1; 
  
 long *idum; 
 idum = (long *)malloc(sizeof(long)); 
 *idum = SEEd;  
 h_len_2=1000; 
 for (z = 0; z < h_len_2; z++) 
 { 
     *(h_2+z)= 0.0; 
 } 
 for (z = 0; z < h_len_2; z++) 
 {   
     *(t_2+z)=0.0; 
 } 
 for(k=0;k<num_channels;k++)  //loop over number of channels 
 {    
  //-------------------------------------------generate N(0,1) 
  do 
  { 
   x1 = ranx(idum); 
   x11 = ranx(idum); 
   x1 = 2*x1-1; 
   x11 = 2*x11-1; 
   s1 = x1*x1+x11*x11; 
  }  
  while (s1 >= 1.0); 
  { 
     *(noise1) = sigma*x1*sqrt(-2*log(s1)/s1); 
     *(noise1+1) = sigma*x11*sqrt(-2*log(s1)/s1); 
  } 
  ran1=*(noise1); 
  ran2=*(noise1+1); 
  //------------------------------------------------- 
 159
      } 
     ran5=*(noise3); 
    ran6=*(noise3+1); 
    //------------------------------------------- 
    t_val=(Tc+Tr); // time of arrival of this ray 
    mu=(-10*Tc/Gam-10*Tr/gamma)/log(10)-mu_const; 
    ln_beta=mu+std_ln_2*ran5; 
    if(ran6>0) 
    { 
     pk=1; 
    } 
    else 
    { 
     pk=-1; 
    } 
    h_val=pk*pow(10,((ln_xi+ln_beta)/20));   
// signed amplitude of this ray 
    path_ix=path_ix+1; // row index of this ray 
    if(path_ix>h_len_2) 
//grow the output structures to handle more paths as needed 
    {   
     h_len_2=h_len_2+ngrow;  
    } 
    *(h_2+path_ix-1)=h_val; //path 大小 
    *(t_2+path_ix-1)=t_val; //path arrival time 
    Tr=Tr+pow(std_lam*ran5,2)+pow(std_lam*ran6,2); 
   } 
   Tc=Tc+pow(std_L*ran3,2)+pow(std_L*ran4,2); 
  } 
  np_2=path_ix; // number of rays (or paths) for this realization 
   
  //------------------------------------------------------ sort in ascending time order 
  for(int y=np_2-1;y>0;y--) 
  { 
   for(int x=y;x>0;x--) 
   { 
    if(*(t_2+y)<*(t_2+x)) 
    { 
     sort_t=*(t_2+y); 
     *(t_2+y)=*(t_2+x); 
     *(t_2+x)=sort_t; 
 
     sort_h=*(h_2+y); 
     *(h_2+y)=*(h_2+x); 
     *(h_2+x)=sort_h; 
    } 
   } 
 161
 for(k3=0;k3<num_channels;k3++) 
 {  
  np_k=np_2; // number of paths in this channel 
  // t_Nfs is the vector of quantized time indices for this channel 
  for(p3=0;p3<np_k;p3++) 
  { 
   *(t_Nfs+p3)=1+static_cast<int>(floor(*(t_2+p3)*Nfs)); 
   //將路徑抵達時間指定到對應的時槽 
  } 
  for(n=0;n<np_k;n++) 
  { 
   *(hN_3+*(t_Nfs+n))=*(hN_3+*(t_Nfs+n))+*(h_2+n); 
   //依照 t_Nfs 將 hN_3 分配到對應的時槽 
  } 
 } 
 //---------------------------------------------------------------------- 
  
 //--------------------------------------------- Kaiser filter 
 int beta=5; 
 int L=2*10*N_3+1;//10=N 
  
 int nw,nk,i,xind,w1_r,odd,kk; 
 double k_c=1.0,k1_c; 
 double bes=0;//*xi=0,*w=0,*w1=0 
 nw=(int)L; 
 for(kk=1;kk<20;kk++) 
 { 
  k_c=k_c*kk; 
  bes=bes+(pow(1.0/4*pow(beta,2),kk))/pow(k_c,2); 
 } 
 bes=fabs(bes+1);//第一項 
 //bes=(fabs(exp(1.0/4*pow(beta,2)))); 
 odd=nw%2; 
 xind=static_cast<int>(pow(nw-1,2)); 
 nk=(int)((nw+1)/2); 
 //xi=(double*)calloc(nk,sizeof(double)); 
  
 for(i=0;i<nk;i++) 
 { 
  *(xi+i)=i+1.0/2*(1-odd); 
  *(xi+i)=4*pow(*(xi+i),2); 
 } 
 //w=(double*)calloc(nk,sizeof(double)); 
 for(i=0;i<nk;i++) 
 { 
  *(w+i)=0; 
 } 
 163
 } 
 
 Len=(N-1)/2; 
 for(x=0;x<Len;x++) 
 { 
  *(kf+x)=0; 
 } 
 for(x=0;x<Len;x++) 
 { 
  *(kf+x)=(x+1)+0.5; 
  k_pre=k_pre+*(kf+x)* *(kf+x); 
 } 
 b0=0; 
 // b=(double*)calloc(Len+1,sizeof(double)); 
 for(x=0;x<nk;x++) 
 { 
  *(b+x)=0; 
 } 
 double sinc0,sinc1; 
 for(int s=0;s<4;s=s+2) 
 { 
  m=(*(M+s+1)-*(M+s))/(*(F+s+1)-*(F+s)); 
  b1=*(M+s)-m**(F+s); 
  //printf("6=%f\n",b1); 
   
b0=b0+(b1*(*(F+s+1)-*(F+s))+(m/2)**(F+s+1)**(F+s+1)-*(F+s)**(F+s))*abs( po
w(*(W+s/2),2));    
  for(x=0;x<Len;x++) 
  { 
  
*(b+x+1)=*(b+x+1)+(m/(4*pi*pi)*(cos(2*pi**(kf+x)**(F+s+1))-cos(2*pi**(
kf+x)**(F+s)))/k_pre)*abs(pow(*(W+s/2),2)); 
   //printf("7=%f\n",*(b+x+1)); 
   if(*(kf+x)**(F+s)==0) 
   { 
    sinc0=1; 
    sinc1=(sin(2**(kf+x)**(F+s+1)*pi)/(2**(kf+x)**(F+s+1)*pi)); 
   } 
   else if(*(kf+x)**(F+s+1)==0) 
   { 
    sinc0=(sin(2**(kf+x)**(F+s)*pi)/(2**(kf+x)**(F+s)*pi)); 
    sinc1=1; 
   } 
   else if(*(kf+x)**(F+s)==0 && *(kf+x)**(F+s+1)==0) 
   { 
    sinc0=1; 
    sinc1=1; 
 165
 { 
  if(y<nz) 
  { 
   *(h_filter1+y)=0; 
  } 
  else 
  {  
   *(h_filter1+y)=*(h_filter0+y-nz); 
  } 
 } 
 
 Lhalf=Lhalf+nz; 
 delay=static_cast<int>(floor(ceil(Lhalf)/q)); 
 int nz1=0; 
while(static_cast<int>(ceil(((Lx-1)*p+L+nz+nz1)/q)-delay)<static_cast<int>(ceil(Lx*p/
q))) 
 { 
  nz1=nz1+1; 
 } 
 //h_filter=(double*)calloc(L+nz+nz1,sizeof(double)); 
 for(y=0;y<L+nz+nz1;y++) 
 { 
  if(y<L+nz) 
  { 
   *(h_filter+y)=*(h_filter1+y); 
  } 
  else 
  {  
   *(h_filter+y)=0; 
  } 
 } 
 h_len=L+nz+nz1;  //filter_len 
 Ly=static_cast<int>(ceil(Lx*p/q)); 
 //---------------------------------------------------------- 
 //----------------------------------------------------------upfirdn 
//let hN_3 convolution with lowpass FIR filter 
//hN0_4 is upfirdning output 
 hN0_len=1+static_cast<int>(floor((h_len_3+h_len-1)/N_3)); 
 for(y=0;y<hN0_len;y++) 
 { 
  *(hN0_4+y)=0; 
 } 
 h_len_4=Ly; 
 for(y=0;y<h_len_4;y++) 
 { 
  *(hN_4+y)=0; 
 } 
 167
  fclose(fp5); 
   
  hN4_len = (Ly);  //output length 
  return hN4_len; 
} 
 
 169
紹，討論的時間也不會受到限制，不外乎也是種學術交流的好形式。 
 
26 日和 27 日的 session 也多少都和我的研究領域有相關，不能錯過這個激發靈感的
好機會。議程最後在 27 日下午五點結束，我在 28 日於波士頓機場搭機返回台灣，結束
了這趟旅程。 
 
二、與會心得 
 
    在發表論文結束之後，感謝與會學者提出問題和看法，可惜的是當時我的回答不夠
完善，應該是因為本人英文表達能力還有待加強，一股腦兒的話要馬上用英文回答還不
行，未能和與會學者進行流利的意見交流，實為可惜。許多學者在聽完演講後都能提出
一針見血的問題，本人期許將來能達到這種境界。 
 
三、考察參觀活動(無是項活動者省略) 
無 
 
四、建議 
無 
 
五、攜回資料名稱及內容 
ICUWB 2006 論文光碟一份 
 
六、其他 
無 
 
 171
另外，這幾天趁空檔聽了一些 oral speech 以及看了些 poster。在聽 oral speech 時，
可惜自己吸收了解的速度仍不夠快，收穫較少一點；不過在 poster session 就可以直接面
對面和作者做意見的交流，目前對我來說反倒是收獲較大。 
 
最後在 5/15 中午搭飛機回台灣。 
二、與會心得 
    此行遇到些大陸朋友，聊了一些，發現大陸的論文產量十分驚人，投入大量的人力
精神實在是值得學習的地方。但他們由於經費問題，能出國發表論文的人數較少，因此
每個人都要幫同學報告幾篇論文，相較之下，在台灣就比較幸福一點，在此感謝國科會
以及通訊所的補助。 
 
三、考察參觀活動(無是項活動者省略) 
無 
 
四、建議 
無 
 
五、攜回資料名稱及內容 
(1)會議簡介一份 
(2)會議論文光碟片一份 
 
六、其他 
無 
 
 
 173
Networks (PAEWN2008) 
z International Workshop on Network-based Virtual Reality and Tele-existence 
(INVITE2008) 
z IEEE International Workshop on Service Oriented Architectures in Converging 
Network Environments (SOCNE2008) 
z Workshop on Security in RFID and it’s Industrial Applications (RFID2008) 
z IEEE Symposium on Mining And Web (MAW2008) 
z International Workshop on Applications of Ad hoc and Sensor Networks 
(AASNET2008) 
z IEEE International Workshop on Opportunistic Networking (WON2008) 
z International Workshop on Disaster and Emergency Information Network Systems 
(IWDENS2008) 
z IEEE Workshop on Bioinformatics and Life Science Modeling and Computing 
(BLSMC2008) 
z International Symposium on Ubiquitous Application & Security Service (UASS2008) 
z International Workshop on Telecommunication Networking, Applications and Systems 
(TeNAS2008) 
z International Workshop on Data Management for Wireless and Pervasive 
Communications (DMWPC2008) 
z IEEE International Workshop on Bio Computing (BioCom2008) 
我們的論文是在 IEEE AINA 2008 會議中以口述發表 (Oral presentation) 的方式
來進行論文發表，此次 IEEE AINA 2008 共有 469 篇論文投稿，只接受了 147 篇論
文，接受率僅僅只有 31%，可以說是相當低的論文接受率，也顯見我們發表的論文有
較高的論文品質。此外，部分落選的論文則被建議改投至其他同時舉行的相關領域學
術會議，其論文的接受率則為較高的 48% (投稿 623 篇，接受 298 篇)。因此，整個
會議共有 445 篇論文進行發表。 
由於學校教學課程時間的緣故，我於三月二十五日 (星期二) 當天早上才出發前往
日本沖繩縣，抵達那霸市機場之後，還必須坐約一小時的巴士前往會場所在的宜野湾
市，報到參加一連四天的會議議程。對於我而言，比較有興趣的相關議題為： 
z Mobile Applications 
z Mobile Communication Networks  
z Ad-Hoc Networks 
z Wireless LAN Technology 
z Wireless Sensor Networks 
z Communication Protocols 
因此參加這些議題相關的發表會議，了解到了許多相關領域的研究方向與研究現況。
我們論文則在三月二十七日 (星期四) 的 “Session 5E : Wireless Sensor Networking and 
Control” 中發表。 
 
 175
Appendix C – List of Published Papers 
 
Journal Papers: 
1. Yuh-Ren Tsai and Xiu-Sheng Li, “Kasami Code-Shift-Keying Modulation for Ultra 
Wideband Communication Systems,” IEEE Transactions on Communications, vol. 55, 
no. 6, pp. 1242-1252, June 2007. (SCI, EI)  
2. Yuh-Ren Tsai and Sin-Jhih Huang, “PTS with Non-uniform Phase Factors for PAPR 
Reduction in OFDM Systems,” IEEE Communications Letters, vol. 12, no. 1, pp. 20-22, 
Jan. 2008. (SCI, EI)  
 
Conference Papers: 
1. Yuh-Ren Tsai and Xiu-Sheng Li, “Kasami Code-Shift-Keying Modulation for Ultra 
Wideband Communication Systems,” in Proc. of IEEE 2006 International Conference on 
Ultra-Wideband (ICUWB 2006), pp. 37 – 42, Massachusetts, USA, Sep. 2006. (EI) 
2. Yuh-Ren Tsai, “Correlative M-ary Spreading-Code-Phase-Shift-Keying Modulation for 
Multiple Access Environments,” in Proc. of IEEE 2006 Vehicular Technology Conference 
(VTC-2006 Fall), pp. 1 – 5, Montréal, Canada, Sept. 2006. (EI) 
3. Xiu-Sheng Li and Yuh-Ren Tsai, “Soft-Handoff Strategies for MB-OFDM Systems,” in 
Proc. of IEEE 2007 Vehicular Technology Conference (VTC-2007 Spring), pp. 2722 – 
2726, Dublin, Ireland, April 2007. (EI)  
4. Yuh-Ren Tsai, Chin-Chou Wang, and Xiu-Sheng Li, “Adaptive Channel Estimation for 
MB-OFDM Systems in Multi-access Interfering Environments,” in Proc. of IEEE 2008 
Vehicular Technology Conference (VTC-2008 Spring), pp. 918-922, Singapore, May 
2008. (EI)  
5. Yuh-Ren Tsai, Xiu-Sheng Li, and Chih-Yu Wei, “Data-carrier Aided Carrier Frequency 
Offset Estimation for OFDM Systems,” in Proc. of IEEE 2008 Vehicular Technology 
Conference (VTC-2008 Spring), pp. 898-902, Singapore, May 2008. (EI)  
 
 
 
TSAI AND LI: KASAMI CODE-SHIFT-KEYING MODULATION 1243
TABLE I
PARAMETERS FOR DIFFERENT TYPES OF PSEUDO-RANDOM SEQUENCES
modulation is superior to other -CSK modulation schemes
in the bandwidth efficiency, and therefore a higher data rate can
be achieved.
The remainder of this paper is organized as follows. Section II
introduces the channel model and the generation of Kasami se-
quences. Section III proposes the modulation and demodulation
schemes. Section IV concentrates on the investigation and the
comparison of system performance. Finally, we draw our con-
clusions in Section V.
II. PRELIMINARIES
A. Pseudo-Random Sequences
For the DSSS there are many choices of spreading sequences,
such as orthogonal sequences (Walsh sequences), maximum
length sequences (m-sequences), Gold sequences, Gold-like
sequences, and the large set or small set of Kasami sequences
[24], [25]. In particular, the sequence length, the cross corre-
lation and the code set size are major properties concerning
the spreading sequences. The sequence length, denoted by ,
is available only for some specific values. For example, the
sequence lengths of Walsh sequences are only available for
, where is an integer; while for m-sequences, Gold
sequences, Gold-like sequences and Kasami sequences, the se-
quence lengths are only available for . Furthermore,
for any two binary code sequences and
, the discrete periodic cross correlation
function is defined as [26]
(1)
We define as the maximum value of all possible cross cor-
relations in a code set. The code set size is defined as the number
of available code sequences in a code set. For an orthogonal code
set with length , the code set size is , and is equal to 0;
whereas, for a quasi-orthogonal code set, such as m-sequences,
Gold sequences, Gold-like sequences and Kasami sequences,
the code set size may be larger than , and will not be 0.
Table I shows the related parameters for different types of PN
codes.
In practical applications, it is important to distinguish a bi-
nary code sequence and the corresponding signal waveform.
The term binary code sequence is used to indicate the output
of a binary shift-register generator, and each element takes on a
value of {0, 1}. The corresponding signal waveform is used to
represent the consecutively transmitted polar waveform. The re-
lation between a binary code sequence
and the corresponding signal waveform can be represented
as
(2)
where is the chip duration, is the symbol dura-
tion, and is the unit pulse shaping function beginning at 0
and ending at . The signal waveform can be represented in the
signal vector form with elements taking on values of .
For the sake of convenience, we define a function to rep-
resent the translation from a binary code sequence to the corre-
sponding signal vector, i.e.,
(3)
and
(4)
B. Kasami Sequences
In this work, the large set of Kasami sequences is employed as
the symbol alphabet set since it possesses good code properties,
including a large code set size and low cross correlations be-
tween different sequences. In the construction of the large set of
Kasami sequences with length , the parameter must
be an even integer. Furthermore, for , the code set
size is , while the code set size is
for .
In the following, we briefly describe the Kasami sequences
for the case with . Details can be found in [24] and
[25]. Let and form a preferred pair of binary m-sequence
vectors of degree with period , where is a binary
m-sequence vector and is a decimation of with
. In addition, for ,
forms another m-sequence with period
. Then we have a set of Gold sequences
(5)
where denotes the operator which shifts the code phase of a
sequence vector cyclically by one unit, and denotes the ex-
clusive-OR operator. Furthermore, we define a set of cover se-
quences as
(6)
where is an all-zero sequence with length ; denotes the
union of sets; and is the repetition of
by times.
TSAI AND LI: KASAMI CODE-SHIFT-KEYING MODULATION 1245
of the shift registers corresponding to is fixed to an
arbitrary nonzero value, such as , and the
initial states corresponding to and are set to
and .
Consequently, the output code sequence corresponding to the
input data is a Kasami sequence of .
Since the initial state corresponding to is an arbitrary
nonzero value, the generated Gold sequences set in
Fig. 1 will be the complete set of with the code se-
quence excluded, and from this it follows that
. Besides, if we define
(14)
then the generated Gold sequence set is composed of and an
element of , i.e.,
(15)
We, therefore, have the set of selected large Kasami code se-
quences, referred to as the reduced set of large Kasami code
sequences, as
(16)
and .
B. Demodulation Schemes
In this work we propose two demodulation schemes: one is
the traditional optimal receiver, and the other is the three-stage
demodulation scheme which can substantially reduce the hard-
ware complexity.
1) Scheme A: Optimal Matched Filters: For the -CSK
modulation scheme, the optimum demodulator is a bank of
correlators matched to the specific signal waveforms, i.e.,
. The received signal
is first correlated with the correlators, and then the estimated
symbol is determined by picking out the correlator with the
largest correlation value. In this demodulation scheme, cor-
relators are needed, and the hardware complexity is .
This optimum demodulation scheme suffers from hardware
complexity, so the modulation level is limited. Hence, we
propose a new demodulation scheme which can greatly reduce
the hardware complexity while retaining an equivalent system
performance.
2) Scheme B: Three-Stage Demodulation: It should be noted
that each transmitted Kasami code sequence is the exclusive-OR
output of three elementary code sequences, including , an el-
ement of and an element of . To determine the
transmitted Kasami code sequence, we must determine the cor-
responding elements of and . In this scheme, we
sequentially make use of these three elementary sequences to
Fig. 2. Structure of the three-stage demodulation receiver.
determine the transmitted symbol. As shown in Fig. 2, we par-
tition the demodulation process into three stages. The effect of
code sequence is eliminated in the first stage. In the second
stage, there are a total of -matched filters, which
are used to deal with the effects of and sequen-
tially. The local maximum correlation output of each -matched
filter is then sent to the third stage. Finally, the global maximum
is determined from the local maximums inputted to the third
stage, and then the estimation of a received symbol can be de-
termined.
Let denote the received signal vector
in chip level. The element is the outcome of integrating the
received signal in the th chip duration, i.e.
(17)
In Stage 1, the received signal vector is multiplied by
“element-by-element”, and the result is denoted as
, i.e.,
(18)
In Stage 2, the vector is imported into parallel
-matched filters with the configuration as shown in Fig. 3. Each
-matched filter corresponds to an elementary code sequence of
. In the th -matched filter , the vector
is first multiplied by “element-by-element”, and the
resultant sequence is denoted as ,
i.e.,
(19)
Subsequently, is passed through a matched filter corre-
sponding to to evaluate the correlations between and
, . The matched output in the th chip
interval is denoted as . Recalling (14), it is noted that
corresponds to the element in , i.e., .
TSAI AND LI: KASAMI CODE-SHIFT-KEYING MODULATION 1247
applying the union bound we have the average symbol error
probability, on the condition that symbol is transmitted, upper
bounded by
(24)
Assuming that all symbols are equiprobable, we have the av-
erage symbol error probability as
(25)
It should be noted that the cross correlation of the
large set of Kasami sequences only takes on values in the
set
. The -CSK modulation
is a quasi-orthogonal modulation scheme that can be ap-
proximated as an orthogonal modulation scheme. Therefore,
according to (24) and (25), the bit-error rate (BER) can be
approximated as
(26)
The term is the sum of (the proba-
bility of an erroneous decision from symbol to symbol ) cor-
responding to all possible signal waveforms pairs ,
, . Furthermore, the erroneous deci-
sion probabilities and for different pairs of and
will be the same if and have
the same value of cross correlation. Hence, according to (26),
the BER can be represented as
(27)
where , denotes the number of signal waveforms
pairs , for any , , whose
cross correlation is equal to . It should be noted that the
values of , show the cross correlation property
of the entire reduced set of large Kasami sequences, and thus
depend only on and on the Kasami sequences set applied.
To determine the upper bound of , the values of ,
should be determined. However, there is cur-
rently no solution to solve the problem of finding the values
of . Through exhaustive searching aided by computers, the
exact values of can be determined, and the bound of
can be easily obtained from (27).
B. Power Efficiency
First, we take the case with as an example for dis-
cussion. There are 6 m-sequences for [26], denoted
by , , , , and , and the generator polynomials
are , , ,
, , and
, respectively. Each m-sequence
can be used to generate a large set of Kasami sequences, and
these 6 different sets of large Kasami sequences are denoted
by , , , , , and . The
corresponding reduced sets of large Kasami sequences can
be obtained and denoted by , , , ,
, and . Furthermore, the cross correlation between
any two sequences in one large Kasami set takes on values in
the set . Via com-
puter experiment we found that the cross correlation properties
are the same for all , , and we have ,
, , , and .
Therefore, we can conclude that these 6 reduced sets of large
Kasami sequences are equivalent and lead to the same system
performance.
1) AWGN Channel Model: Fig. 4 shows the bit error per-
formance versus with for the Kasami
-CSK modulation and other -CSK modulations in an
AWGN channel. The code length for each modulation scheme
is , except that the code length is for the case
using orthogonal sequences. However, the symbol alphabet
sizes are different for various modulation schemes. For the
proposed Kasami -CSK modulation we have , for
the -CSK modulation using orthogonal or Gold sequences
we have , and we have for -CSK modula-
tion using m-sequences. The numerical and simulation results
show that the Kasami -CSK modulation outperforms other
-CSK modulations, and the improvement in is about
1 dB. We also found that the -CSK modulation schemes
using orthogonal sequences, Gold sequences or m-sequences
have a nearly identical performance, since they have almost the
same constellation size . Furthermore, the numerical result
obtained from (27) shows good accuracy for a large value of
. More important, our simulation results verify that the
performances are the same for demodulation Scheme A and
demodulation Scheme B. It must be noted that using bounded
correlation code sets, such as Gold and Kasami sequences, to
increase the constellation size may not improve the maximum
allowable user number for an interference-limited system, as
addressed in [21].
In addition, for PPM-UWB systems, the power efficiency
is the same as that of the -CSK modulation using orthog-
onal code sequences. Therefore, according to the results shown
in Fig. 4, we can conclude that the power efficiency of
the Kasami -CSK modulation is better than those of other
-CSK modulations and the PPM-UWB systems in an AWGN
channel, i.e.
(28)
The subscripts , , and represent the -CSK modulations
using orthogonal sequences, Gold sequences, and m-sequences,
respectively, and the subscript is used to represent the
PPM-UWB systems.
To investigate the scalability of the proposed Kasami -CSK
modulation, we examined four different cases, with the polyno-
mial degrees being , , and . The
corresponding code lengths are , ,
and , respectively, and the primary polynomials are
, ,
and , respectively. According
TSAI AND LI: KASAMI CODE-SHIFT-KEYING MODULATION 1249
a worse signal waveform cross correlation than that of the PPM
modulation, it has a larger constellation size, . The min-
imum distance of the Kasami -CSK modulation gets larger
than that of the PPM modulation as increases. Therefore, the
proposed Kasami -CSK modulation will outperform the PPM
modulation if the value of is large enough.
Although the proposed Kasami -CSK modulation may be
inferior to other schemes for the case with , it must
be noted that the proposed scheme is always superior to other
schemes in the bandwidth efficiency with a gain of 50% as
shown next.
C. Bandwidth Efficiency
The bandwidth efficiency is defined as the ratio of the
transmission bit rate to the channel bandwidth no matter what
channel model is applied. For the Kasami -CSK modulation
we have the bandwidth efficiency
(29)
where the approximation sustained for is large enough. For
example, the approximation error is less than 2% for .
For other -CSK modulation schemes we have the bandwidth
efficiency
Orthogonal Sequences
Gold Sequences
m-sequences
(30)
where the approximation sustained for is large enough. In
addition, for the PPM-UWB systems, the bandwidth efficiency
is generally limited to
(31)
From (29), (30), and (31), we conclude that the bandwidth
efficiency of the Kasami -CSK modulation is 1.5 times
better than that of other -CSK modulation schemes or that
of the PPM-UWB systems, i.e.,
.
D. Hardware Complexity
The increase of will effectively enhance the BER perfor-
mance for -CSK modulations at the cost of increasing the re-
ceiver hardware complexity. The optimal receiver structure, like
demodulation Scheme A, uses a bank of correlators matched
to all possible signal waveforms. Therefore, the receiver hard-
ware complexity is . Take as an ex-
ample, there should be 4096 correlators implemented in the re-
ceiver, and this makes demodulation Scheme A infeasible for
a large value of . When the demodulation Scheme B is ap-
plied, the implementation of receivers becomes feasible for a
large value of . In this instance, only -matched
filters are required, and the receiver hardware complexity is sub-
stantially reduced to .
E. Multiple Access Environments
It is possible that two or more users use the same radio
channel simultaneously, and thus the multiple access inter-
ference (MAI) must be taken into consideration. It should be
noted that there are multiple sets of large Kasami sequences for
each , and the number of different sets depends on the number
of primitive polynomials for the degree , e.g., there are six
different sets for . Hence, we can use different reduced
sets of large Kasami sequences for multiple access applications.
In other words, different users in the same radio channel will
be assigned different reduced sets of large Kasami sequences.
Assume that , corresponding to an element of ,
and , corresponding to an element of , are the
transmitted signal waveforms of the desired user and the MAI
user, respectively. After being transmitted through an AWGN
channel, the received signal in the receiver front end of the de-
sired user can be written as
(32)
where and are the received desired signal power and the
received MAI signal power, respectively; is
the relative chip delay between the desired signal and the MAI
signal; and is the received channel noise. Here we introduce
an interfering power ratio defined as the ratio of the MAI signal
power to the desired signal power, i.e., . The UWB
communication systems are generally used in applications of
low user density and short range transmission, such as indoor
applications [19], [20]. Nearby users form a piconet to share the
radio resource via the time-division multiple access (TDMA)
scheme [28], and multiple access interferences only come from
the nodes in other piconets far away from the desired receiving
node. Therefore, we may conclude that the power ratio is gen-
erally smaller than 1.
Due to the existence of MAI, the system performance will be
degraded with the degradation depending on the asynchronous
cross correlation between the desired signal and the MAI
signal. We found that the distributions of the asynchronous
cross correlations are almost the same for different pairs of
. This implies that the performance for multiple
access environments is almost irrelevant to the selection of large
Kasami sequences sets. Fig. 7 shows the simulation results
of versus with and in an AWGN
channel for different pairs of . The results
confirm that a similar performance can be obtained regardless
which large Kasami sequences set is applied.
Fig. 8 shows the simulation results for the two-user environ-
ment with 6, 8 and 10 in an AWGN channel. The values of
are 1.0, 0.5 and 0, where corresponds to the case of
the single-user environment. Different users employ different
large Kasami sequences sets generated by using different pri-
mary polynomials. The results show that the BER performance
is inversely proportional to the power ratio , and that the per-
formance is severely degraded for . However, if the power
ratio is much smaller than 1, the impact is negligible. In addi-
tion, a larger value of leads to a better BER performance. In
addition, it was found that the impact of the MAI on the BER
TSAI AND LI: KASAMI CODE-SHIFT-KEYING MODULATION 1251
Fig. 11. Bit-error probability P versus E =N for the three-user environ-
ment with n =6, 8, and 10 in an UWB channel.
Fig. 12. Bit-error probability P versus E =N for the Kasami M -CSK
modulation and BPSK modulation in an AWGN channel with narrow-band in-
terference.
as an additional Gaussian noise spread over the entire transmis-
sion bandwidth if the signal waveform length is large enough.
In other words, the channel may be approximated as the orig-
inal channel with a raised noise floor. Then, the degradation can
be evaluated according to the interference power, the spreading
factor and the transmission bandwidth [16], [29], [30]. In gen-
eral, in order to resist the narrow-band interferences, a Kasami
sequences -CSK modulation system with a large signal wave-
form length and a large transmission bandwidth is prefer-
able. To verify the ability of narrow-band interference rejec-
tion, we show the performance of the proposed Kasami -CSK
modulation in an AWGN channel with a narrow-band interfer-
ence existing. Fig. 12 shows the BER performance of the pro-
posed Kasami -CSK modulation with and a carrier-
to-interference power ratio (CIR) of CIR dB, 3 dB and
10 dB, respectively. In the case of CIR dB, the received
carrier power is equal to the interference power. The perfor-
mance of the narrow-band BPSK modulation is also provided
as a baseline. The simulation results show that the proposed
Kasami -CSK modulation can actually reduce the impact of
narrow-band interference.
V. CONCLUSION
In this work, we have proposed an -CSK modulation
technique based on the large set of Kasami sequences for the
applications of DSSS UWB communications. The modulation
and demodulation schemes were developed, and the system
performance based on power efficiency, bandwidth efficiency
and hardware complexity was thoroughly investigated. For the
bandwidth efficiency, the proposed Kasami sequences -CSK
modulation outperforms other schemes with a gain of 50%.
For the power efficiency, the proposed scheme was found to
outperform other schemes with an improvement of 1 dB in bit
energy-to-noise power spectral density ratio under an AWGN
channel; however, the power efficiency was found to be almost
equivalent under the UWB channel.
In addition, an increase of the alphabet size will enhance
the transmission data rate, but it will also dramatically increase
the hardware complexity. By using the proposed demodula-
tion Scheme B, the hardware complexity can be substantially
reduced to , and as a result the implementation
of receivers for a very large value of becomes feasible.
Furthermore, the proposed Kasami -CSK modulation can
also be applied to asynchronous multiple access environments,
and an acceptable BER performance can be obtained if the
number of users is small. In conclusion, the proposed Kasami
-CSK modulation substantially enhances power efficiency
and bandwidth efficiency, and is therefore quite suitable for
the applications of UWB communications or other wireless
communications.
REFERENCES
[1] K. Siwiak, “Ultra-wide band radio: Introducing a new technology,” in
Proc. IEEE Vehicular Technology Conf. (VTC), May 2001, vol. 2, pp.
1088–1093.
[2] K. Siwiak, P. Withington, and S. Phelan, “Ultra-wide band radio: The
emergence of an important new technology,” in Proc. IEEE Vehicular
Technology Conf. (VTC), May 2001, vol. 2, pp. 1169–1172.
[3] R. F. Martin, “Ultra-wideband (UWB) rules and design compliance
issues,” in Proc. IEEE Int. Symp. Electromagnetic Compatibility, Aug.
2003, vol. 1, pp. 91–96.
[4] D. Porcino and W. Hirt, “Ultra-wideband radio technology—Potential
and challenges ahead,” IEEE Commun. Mag., vol. 41, no. 7, pp. 66–74,
Jul. 2003.
[5] M. Z. Win and R. A. Scholtz, “Impulse radio: How it works,” IEEE
Commun. Lett., vol. 2, pp. 36–38, Feb. 1998.
[6] H. Lee, B. Han, Y. Shin, and S. Im, “Multipath characteristics of
impulse radio channels,” in Proc. IEEE Vehicular Technology Conf.
(VTC), May 2000, vol. 3, pp. 2487–2491.
[7] M. Z. Win, “A unified spectral analysis of generalized time-hopping
spread-spectrum signals in the presence of timing jitter,” IEEE J. Sel.
Areas Commun., vol. 20, no. 12, pp. 1664–1676, Dec. 2002.
[8] C. A. Corral, S. Sibecas, S. Emami, and G. Stratis, “Pulse spectrum
optimization for ultra-wideband communication,” in Proc. IEEE Conf.
Ultra-Wideband Syst. Technol, May 2002, pp. 31–35.
[9] K. Eshima, Y. Hase, S. Oomori, F. Takahashi, and R. Kohno, “M-ary
UWB system using Walsh codes,” in Proc. IEEE Conf. Ultra-Wideband
Syst. Technol, May 2002, pp. 37–40.
[10] M. Sabattini, E. Masry, and L. B. Milstein, “A non-Gaussian approach
to the performance analysis of UWB TH-BPPM systems,” in Proc.
IEEE Conf. Ultra-Wideband Syst. Technol, Nov. 2003, pp. 52–55.
[11] T. Ezaki and T. Obtsuki, “Diversity gain in ultra wideband impulse
radio (UWB-IR),” in Proc. IEEE Conf. Ultra-Wideband Syst. Technol,
Nov. 2003, pp. 56–60.
20 IEEE COMMUNICATIONS LETTERS, VOL. 12, NO. 1, JANUARY 2008
PTS with Non-Uniform Phase Factors for
PAPR Reduction in OFDM Systems
Yuh-Ren Tsai, Member, IEEE, and Sin-Jhih Huang
Abstract— Partial transmit sequence (PTS) is one of the
effective and uncomplicated PAPR reduction methods for OFDM
systems. The phase factors applied in the weighting sequences
are assumed to be uniformly distributed within [0, 2π). By care-
fully investigating the phase distribution of OFDM signals, we
proposed a modified PTS scheme outperforming the conventional
PTS scheme in PAPR reduction performance. The process of the
proposed scheme is the same as the conventional PTS, except
for applying the new non-uniform phase factors. The required
side information is the same as the conventional PTS applying
uniform phase factors.
Index Terms— Orthogonal frequency division multiplexing
(OFDM), peak-to-average power ratio (PAPR), partial transmit
sequence (PTS).
I. INTRODUCTION
IN OFDM systems, peak-to-average power ratio (PAPR)reduction is a very important issue in order to improve
the efficiency of the transmitter power amplifier. Numerous
techniques have been proposed to reduce the PAPR of OFDM
signals in the time-domain. Partial transmit sequence (PTS), as
one of the effective and uncomplicated methods, has caught
much attention and is believed to be one of the promising
methods for PAPR reduction [1]–[5].
In PTS, the original frequency-domain data sequence is
divided into multiple disjoint sub-blocks, which are then
weighted by a set of phase sequences to create a set of candi-
dates. Finally, the candidate with the lowest PAPR is chosen
for transmission. There are several ways for the partition of
the data sequence into multiple sub-blocks, including adjacent
partition, interleaved partition and pseudorandom partition
[2]. The phase factors adopted in the weighting sequences
are chosen from a pre-determined phase set, which contains
elements uniformly distributed within [0, 2π).
However, employing uniformly distributed phase factors in
PTS may not be the best strategy. By carefully investigating
the phase distribution of OFDM signals, we found that there
exists some non-uniformly distributed phase factors achieving
better performance. In this work, we investigate the non-
uniform phase factors for the proposed PTS scheme and the
corresponding performance improvement in PAPR reduction.
II. SYSTEM MODEL AND BACKGROUND
Consider an OFDM system with N subcarriers. The
frequency-domain data sequence X = [Xk] for k =
Manuscript received September 12, 2007. The associate editor coordinating
the review of this letter and approving it for publication was J. van de Beek.
This work was supported in part by the National Science Council, Taiwan,
R.O.C., under Grant NSC 96-2219-E-007-006.
Y.-R. Tsai (corresponding author) and S.-J. Huang are with the Institute of
Communications Engineering, National Tsing Hua University, Hsinchu 30013,
Taiwan (e-mail: yrtsai@ee.nthu.edu.tw).
Digital Object Identifier 10.1109/LCOMM.2008.071514.
0, · · · , N −1, is equally divided by means of a certain kind of
partitioning scheme into M disjoint sub-blocks, each of which
contains N˜ = N/M subcarriers. For sub-block i, 1 ≤ i ≤ M ,
the corresponding time-domain signal after N -point IDFT is
denoted as x(i) = [x(i)n ] for n = 1, · · · , N − 1. Without
applying PTS, the overall output signal can be represented
as
x = [xn] =
[∑M
i=1
x(i)n
]
, n = 0, · · · , N − 1. (1)
Let

∆= argmax
0≤n≤N−1
{∣∣∣∣∑Mi=1 x(i)n
∣∣∣∣}, (2)
the PAPR of an OFDM symbol is defined as
PAPR =
∣∣∣∑Mi=1 x(i) ∣∣∣2
E[|xn|2]
. (3)
Since the average power of an OFDM symbol is fixed, the
purpose of PAPR reduction is to reduce the peak power value,
i.e.
∣∣∣∑Mi=1 x(i) ∣∣∣2. The sample with the peak power, i.e. the -th
sample, can be re-written as∑M
i=1
x
(i)
 =
∑M
i=1
∣∣∣x(i) ∣∣∣× exp(jθ(i) ), (4)
where θ(i) is the phase of sub-block i corresponding to the
-th time-domain sample. For sample , taking the phase of
the sub-block with the maximum amplitude as a reference, we
define a set of relative phases as
∆Θ =
[
∆θ(i)
]
=
[
θ
(i)
 − θ(p)
]
, 1 ≤ i ≤ M, i = p, (5)
where p = argmax
1≤i≤M
{∣∣∣x(i) ∣∣∣} is the index of the sub-block
with the maximum amplitude in sample . Fig. 1 shows
the distribution of ∆θ(i) for different peak samples in an
OFDM symbol with N = 128 and M = 4, including the 1-
st, the 4-th, the 8-th, the 16-th and the 32-th peaks in the
power ordering. For a high power peak (such as the 1-st
peak), the corresponding phases of different sub-blocks are
more concentrated to compose a large amplitude. Hence, the
distribution of ∆θ(i) is more concentrated for the samples with
higher power.
To reduce the amplitude of a high power sample, one
straightforward means is to adjust the phases of some chosen
sub-blocks to the reverse of the reference phase, i.e. θ(p) +π,
and to keep the phases of the other sub-blocks unchanged.
Based on this conceptual means, we observe the distribution
of the phase adjustments. Fig. 2 shows the distribution of the
phase adjustments that minimize the PAPR for N = 128 and
1089-7798/08$25.00 c© 2008 IEEE
22 IEEE COMMUNICATIONS LETTERS, VOL. 12, NO. 1, JANUARY 2008
PAPR0 (dB)
Co
m
pl
em
en
ta
ry
 d
ist
rib
u
tio
n 
fu
nc
tio
n
 
(cc
df
)
4 5 6 7 8 9 10
100
10-1
10-2
10-3
10-4
Normal
Conventional PTS
Modified PTS
M = 4, W = 4
M = 4, W = 8
M = 8, W = 4
Fig. 3. The complementary cumulative distribution function of the PAPR
for interleaved partition.
Co
m
pl
em
en
ta
ry
 
di
str
ib
u
tio
n
 
fu
n
ct
io
n
 (c
cd
f)
4 5 6 7 8 9 10
100
10-1
10-2
10-3
10-4
Normal
Conventional PTS
Modified PTS
M = 4, W = 4
M = 4, W = 8
M = 8, W = 4
PAPR0 (dB)
Fig. 4. The complementary cumulative distribution function of the PAPR
for adjacent partition.
The complementary cumulative distribution function (ccdf),
defined as the probability that the PAPR value is larger than a
specific value PAPR0, is generally used to evaluate the PAPR
reduction performance for different schemes. Fig. 3 shows the
ccdf of the PAPR for interleaved partition. The PAPR ccdf
of the normal OFDM system is also provided as a baseline.
It is found that the proposed PTS scheme, by applying the
non-uniform phase factors, can achieve an improvement of
0.5 - 0.8 dB in PAPR reduction for different scenarios than
the conventional PTS scheme with uniform phase factors. If
a specific PAPR threshold is desired, the outage probability
can be improved by a factor of 10. Particularly, the PAPR
performance of our proposed PTS scheme with (M,W ) = (4,
4), is almost the same as that of the conventional PTS scheme
with (M,W ) = (4, 8), but having much lower computational
complexity. This also shows the superiority of our proposed
PTS scheme.
Fig. 4 shows the ccdf of the PAPR for adjacent partition.
It is found that the proposed PTS scheme still outperforms
the conventional PTS scheme with an improvement of 0.25
- 0.4 dB in PAPR reduction for different scenarios. The
improvement in the PAPR outage probability is also about
a factor of 10. Furthermore, compared to Fig. 3, the PTS
scheme with adjacent partition achieves better PAPR reduction
performance than the same scenario applying the interleaved
partition [5].
V. CONCLUSION
In this work, we have proposed a modified PTS scheme by
applying pre-determined non-uniform phase factors for PAPR
reduction in OFDM systems. The applied phase factors and the
corresponding performance improvement for both interleaved
partition and adjacent partition have been well investigated.
It is found that an improvement of 0.25 - 0.8 dB in PAPR
reduction for different scenarios can be obtained when com-
pared with the conventional PTS scheme with uniform phase
factors. Equivalently, the outage probability can be improved
by a factor of 10 for a specific PAPR threshold. It must
be noted that the applied phase factors can be determined
in advance based on system parameters, without increasing
the computational complexity in the transmitter and receiver.
Furthermore, the required side information is the same as the
conventional PTS scheme with uniform phase factors.
REFERENCES
[1] S. H. Muller and J. B. Huber, “OFDM with reduced peak-to-average
power ratio by optimum combination of partial transmit sequences,”
Electron. Lett., vol. 33, no. 5, pp. 368-369, Feb. 1997.
[2] S. G. Kang, J. G. Kim, and E. K. Joo, “A novel subblock partition
scheme for partial transmit sequence OFDM,” IEEE Trans. Broadcast.,
vol. 45, no. 3, pp. 333-338, Sept. 1999.
[3] L. J. Cimini, Jr., and N. R. Sollenberger, “Peak-to-average power ratio
reduction of an OFDM signal using partial transmit sequences,” IEEE
Commun. Lett., vol. 4, no. 3, pp.86-88, Mar. 2000.
[4] A. Alavi, C. Tellambura, and I. Fair, “PAPR reduction of OFDM signals
using partial transmit sequence: an optimal approach using sphere
decoding,” IEEE Commun. Lett., vol. 9, no. 11, pp. 982-984, Nov. 2005.
[5] G. Lu, P. Wu, and C. Carlemalm-Logothetis, “Enhanced interleaved
partitioning PTS for peak-to-average power ratio reduction in OFDM
systems,” Electron. Lett., vol. 42, no. 17, pp. 983-984, Aug. 2006.
Xr(@) to represent the translation from a binary code sequence
to the corresponding signal vector, i.e.
,y(a, ) = (-1)a,, X(a) aoa(1 ,(1 ,( )L-1 ]. (3)
B. Kasami Sequences
In this work, we employ the large set of Kasami sequences
as the symbol alphabet set since it possesses good code prop-
erties, including the large code set size and low
cross-correlations. In the construction of the large set Kasami
sequences with the length L = 2n _-1, the parameter n must
be an even integer. In this work, we mainly focus on the case
of n = 2 mod 4, and we briefly introduce how to construct the
large set of Kasami sequences below [10].
Let u represent a binary m-sequence vector of the degree
n with the period L = 2n- 1, D denote the operator which
shifts the code phase of a sequence vector cyclically by one
unit, and ® denote the exclusive-OR operator. For
q =t(n) 1+ 2(n+2) 2, u' u[t(n)] forms another m-sequence
with the period L, and consequently we have a set of Gold
sequences
G(u, u') - li , u', u3u, u (SDu', u(3DU I..., u (3 D U-u'.(4)
It is noted that G(u,u') contains SG =L+2=2n +1 code
sequences with the period L . In addition, for
q = s(n) _ 1+ 2n12 X u" = u[s(n)] forms another m-sequence
with the period L= 2n12 -1. Now we define a cover sequence
c = [c0, cl, , CL-1] , which is the repetitions of u , i.e.
[CO+jL' C1+jL'' C(L4-1)+jL] is equal to u" for I0,.,2n2. We
then define a set of cover sequences as
C(U")-OL U[UIJ 1Di-l C] Cj, j=0., ,LI }, (5)
where U denotes the union of sets, and 0L is an all-zero
sequence with length L . It is noted that there are
Sc =L1+1=2 2 elements in C(u").
Each element ofthe large set Kasami sequences, denoted by
K(u), is the exclusive-OR output of an element in G(u,u')
and an element in C(ud). It is noted that the code set size of
K(u) iS SK = SC XSG = 2'/2 (2' + 1). The large set of Kasami
sequences can also be expressed by generator polynomials. Let
h(x) = X6 +X5 +1
h = [1,0,... ,0] (an arbitrary nonzero vector) Kasami
sequence
output
h'(x) =x6+X5+x3+x2+1
h'= [do' dl,.. ,dn-l]I
V = [dn n dn+n h"(x) = x3+x+1
h(x), h'(x) and h'(x) denote the generator polynomials of u,
u[t(n)] and u[s(n)], respectively. Fig. 1 gives an example ofthe
large set Kasami sequences generator.
C. Channel Models
In this work, we consider two channel models, one is additive
white Gaussian noise (AWGN) channel model, and the other is
ultra-wideband multipath channel model with T =1 nsec [11].
In addition, a RAKE receiver with the finger number 16 is ap-
plied for the UWB channel.
III. MODULATION AND DEMODULATION SCHEMES
We propose in this section the modulation and demodulation
schemes for M-CSK modulation based on the large set of Kasami
sequences.
A. Modulation Scheme
In the M-CSK modulation, there are M (M = 2k) different
possible symbols, and the transmitter groups the input data stream
into k-bit (k=log2M) symbols with a symbol duration T. Since
the code set size SK =2 n12 (2n + 1) of K(u) is not a power of 2,
we select M = 23nl2, and then we have k = 1.5n. We now pro-
pose a systematic method for sequences selection and mapping.
The input data sequence in a symbol duration is denoted as
d = [do, dl, , ddn 1 dn, , dl55 l], where d, E {0,1}. In Fig. 1, the
initial state of h(x) is fixed to an arbitrary nonzero value, such
as h =[1, 0, 0], and the initial states of h'(x) and h"(x) are
set to be h' [do,dl, , dn-l] and h" [dn,d +,., di5n l]. The
output code sequence is consequently a Kasami sequence of
K(u).
The generated Gold sequences set G(u,u') in Fig. 1 is the
complete set of original Gold sequences with the code sequence
u' excluded, and it follows that SG 2n = L +1. Besides, if we
define
V(U') ={OL,U, Du', D U,s,D U=}{vm I m O,.,L}, (6)
the generated Gold sequence set is composed of u and an ele-
ment from V(u'), i.e.
G(u, u') = u 03 VWu) (7)
{u,uG u',uG Du', uG3 D2u',, iuG DL-u .
We therefore have the set of selected large Kasami code se-
quences, referred as the reduced set of large Kasami code se-
quences, being
K(u) = G(u,u )U [U I {Dj c G(u,u')}] ,(8)
where DjcO)G(u,u') denotes the set {D'jcGg:ge G(u,u')},
and Sk =2 x22=232
B. Demodulation Schemes
We propose two demodulation schemes to demodulate the re-
ceived signal. One is the traditional optimal receiver, and the
other is the three-stage demodulation scheme, which can greatly
reduce the hardware complexity.
Fig. 1. Large set Kasami sequence generator.
38
,
being transmitted, upper bounded by
Pi<E Pifor iO,1,, M-1, (13)j=o aX#i
It is noted that the Pi of the large set Kasami sequences
takes values in the set 9t {p= ,P2,P3,P4,P5}=
{ [t(n) - 2]/L, [s(n) - 2]/L, -1/L, - s(n)/L, - t(n)/L }. Ac-
cording to (12), (13), and assuming that all symbols are
equiprobable, we then have the BER Perro. upper bounded by
1
Perror< M _ Em xQ((1-pm)xr) (14)2(M -1)mt1
where 1< m < 5 deotes the number of signal wave-
forms pairs Qi(t), (t) , for any i.i, O<i,j<M-1,
whose cross-correlation is equal to Pm E 91.
To figure out the upper bound of Perror, the values of 86m,
m =1, *-, 5 should be determined. However, there is currently
no solution to solve /3m. By exhaustive searching aided by
computers, the exact values of /3m can be determined and the
bound of Perror can be easily obtained from (14).
B. Power Efficiency
First, we take the case with n= 6 as an example for dis-
cussion. There are 6 m-sequences for n = 6, denoted by uo,
Ul, U2, U3, U4 and U5, and the generator polynomials are
6 +X5 +1 X6 +X+1, X6 +X5 +x4 +x+, x6 +x5 +x2 +x+1
x6 +x4 +x3 +x+1, and X6 +X5 +x3 +x2 +1, respectively.
Each m-sequence can be used to generate a large set of Ka-
sami sequences, and these 6 different sets of large Kasami
sequences are denoted by K(uO), K(ul), K(u2), K(U3 ,
K(u4), and K(u5). The corresponding reduced sets of large
Kasami sequences can be obtained and denoted by K(uo),
K(ul), K(u2), K(u3), K(u4), and K(u5). Furthermore, the
cross-correlation between any two sequences in one large
Kasami set takes on values in the set
9i = { 15/63, 7/63, - 1/63, - 9/63, - 17/63 }. Via computer
experiment, we found that the cross-correlation properties are
the same for all k(ui), i= 0 5, and we have fi= 0,
2 = 96768, ,83 = 129024, /34 = 3584, and ,85 = 32256
Therefore, we conclude that these 6 reduced sets of large Ka-
sami sequences are equivalent and lead to the same system
performance.
1)AWGN Channel Model
Fig. 4 shows the bit error performance Perror versus
Eb/No with n= 6 for the Kasami M-CSK modulation and
other M-CSK modulations in an AWGN channel. The code
length for each modulation scheme is L = 63, except that the
code length is L = 64 for the case using orthogonal se-
quences. However, the symbol alphabet sizes are different for
various modulation schemes. For the proposed Kasami
M-CSK modulation we have M = 512, for the M-CSK
modulation using orthogonal or Gold sequences we have
M = 64, and we have M = 63 for M-CSK modulation using
m-sequences. The numerical and simulation results show that
the Kasami M-CSK modulation outperforms other M-CSK
modulations, and the improvement in Eb /N, is about 1 dB. We
also found that the M-CSK modulation schemes using orthogo-
nal sequences, Gold sequences or m-sequences have a nearly
identical performance, since they have almost the same constel-
lation size M. Furthermore, the numerical result obtained from
(14) shows good accuracy for a large value of Eb N0. More
important, our simulation results verify that the performances are
the same for demodulation Scheme A and demodulation Scheme
B.
In addition, for PPM-UWB systems, the power efficiency is
the same as that of the M-CSK modulation using orthogonal
code sequences. Therefore, according to the results shown in Fig.
4, we can conclude that the power efficiency 7iP,K of Kasami
M-CSK modulation is better than those of other M-CSK modula-
tions and the PPM-UWB systems in anAWGN channel, i.e.
77P,K > 77P,O l7P,PPM /7P,G '7P,m . (15)
The subscripts 0, G, and m represent the M-CSK modula-
tions using orthogonal sequences, Gold sequences, and
m-sequences, respectively, and the subscript PPM is used to
represent the PPM-UWB systems.
To investigate the scalability of the proposed Kasami M-CSK
modulation, we examined four different cases with the polyno-
mial degrees being n =4, n =6, n =8 and n=10 . The cor-
responding code lengths are L = 15, L = 63, L = 255 and
L = 1023 , respectively, and the generator polynomials are
h(x)=x4 +X3 +1, h(x)=X6 +X5 +1, h(x)=X8 +x6 +X5 +x4 +1
and h(x) = xl+ +l , respectively. According to the
above-mentioned results the corresponding Kasami code sets and
the implementation of the modulator and demodulator can easily
be obtained. Fig. 5 shows the simulation results of the proposed
scheme for the single-user environment in an AWGN channel
with different values of n = 4, 6, 8 and 1O.The performance of
the M-CSK modulation using orthogonal sequences is also pro-
vided as a reference. The results show that the increase of M,
i.e. the increase of n, will effectively enhance the BER per-
formance, i.e. enhance the power efficiency. It is also shown that
our proposed scheme is better than M-CSK modulation with
orthogonal codes for any fixed values of n. Furthermore, for
our proposed scheme, the increase of n from 4 to 6 can
achieve an improvement of 1.5 dB in Eb /No, and an im-
provement of 1 dB in Eb/No can be obtained for the increase
from n = 6 to n = 8.
2) UWB Multipath Channel Model
In the simulation for the UWB multipath channel, the chip
duration is assumed to be T7 = 1 n sec To overcome the mul-
tipath propagation effect, the M-CSK receiver is assumed to be a
RAKE receiver with the finger number being 16, similar to that
adopted in the DS-UWB system [7]. Fig. 6 shows the Perror
versus Eb/No with n =6, 8 and 10 for the Kasami M-CSK
modulation and other M-CSK modulations in the UWB multi-
path channel. For the case with n = 6, the performance of the
Kasami M-CSK modulation is slightly worse than that of other
schemes. This is mainly due to the fact that the multipath inter-
ference degrades the system performance, especially for the
40
For the bandwidth efficiency, the proposed Kasami sequences
M-CSK modulation outperforms other schemes with a gain of
50 %. For the power efficiency, the proposed scheme was
found to outperform other schemes with an improvement of
1dB in bit energy-to-noise power spectral density ratio under
an AWGN channel; however the power efficiency was found
to be almost equivalent under the UWB channel.
In addition, the increase of the alphabet size M will en-
hance the transmission data rate but it increases the hardware
complexity dramatically. By using the proposed demodulation
Scheme B, the hardware complexity can be greatly reduced to
o(M 3), and as a result the implementation of receivers for a
very large value of M becomes feasible. Furthermore, the
proposed Kasami M-CSK modulation can also be applied to
asynchronous multiple access environments, and an accept-
able bit error rate performance can be obtained if the number
of users is small. In conclusion, the proposed Kasami M-CSK
modulation substantially enhances power efficiency and
bandwidth efficiency, and is therefore quite suitable for the
applications of UWB communications or other wireless
communications.
REFERENCES
[1] K. Siwiak, P. Withington, and S. Phelan, "Ultra-wide band radio: the
p 10-
eIrrorX
10
0
1 0- 0---- PM
A0=1
m~~~Ksm
1 2 3 4 5 6 7
Eb No (dB)
Fig. 6. The bit error probability Perror versus Eb /No for the single-user
environment with several values of n in the CM1 UWB channel.
emergence of an important new technology," in Proc. IEEE Vehicular
Technology Conf (VTC), vol. 2, 6-9 May 2001, pp. 1169-1172.
[2] D. Porcino and W. Hirt, "Ultra-wideband radio technology-- potential and
challenges ahead," IEEE Commun. Magazine, vol. 41, pp. 66-74, July
2003.
[3] M. Z. Win and R. A. Scholtz, "Impulse radio: how it works," IEEE Com-
mun. Lett., vol. 2, pp. 36-38, Feb. 1998.
[4] J. R. Foerster, "The performance of a direct-sequence spread ul-
tra-wideband system in the presence of multipath, narrowband interference,
and multiuser interference," in Proc. IEEE Conf on Ultra Wideband Sys-
tems and Technologies, 21-23 May 2002, pp. 87-91.
[5] V. S. Somayazulu,, "Multiple access performance in UWB systems using
time hopping vs. direct sequence spreading," in Proc. IEEE Wireless Com-
mun. and Networking Conf (WCNC), vol. 2, 17-21 March 2002, pp. 522
-525.
[6] "MERGED PROPOSAL #1," http:Hgrouper.ieee.org/groups/802/15/
pub/TG3a CFP.html
[7] "MERGED PROPOSAL #2," http:Hgrouper.ieee.org/groups/802/15/
pub/TG3a CFP.html
[8] A. G. Burr, "Capacity improvement of CDMA systems using M-ary code
shift keying," in Proc. IEEE Sixth International Conf on Mobile Radio and
Personal Commun., 9-11 Dec. 1991, pp. 63-67.
[9] A. G. Burr, "Spherical codes for M-ary code shift keying," in Proc. Second
IEE National Conf on Telecommunications, 2-5 Apr. 1989, pp. 67-72.
[10] D. V. Sarwate and M. B. Pursley, "Crosscorrelation properties of pseudo-
random and related sequences," Proc. IEEE, vol. 68, pp. 593-619, May
1980.
[ 11] 02490rOP802-15_SG3a-Channel-Modeling-Subcommittee-Report-Final.do
c.
p 10
error
o-210
10-3
o100
0J
I._
05-(10
Lu
mL
10
10-
0 2
= 0.5
= 0.3
0.1
=0
4
V S k AWGN, 2 users
--- AWGN, 3 users
.UWB,CM1,2users
- - UWB,CM1,3users|
6 8 10 12 14 16 V
Eb No (dB)
Fig. 7. The bit error probability Perror versus Eb/NO for multiple ac-
cess with n = 6 and several values of g .
42
bits for correlative M-SCPSK modulation and m–(L+1)k bits 
for user addressing. For a specific user, the pattern of the 
m–(L+1)k user addressing bits is fixed; whereas the other 
(L+1)k bits are assigned the values corresponding to the (L+1) 
successive input symbols.  
It is assumed that the code length per symbol N is far 
smaller than the m-sequence period NP. According to the 
shift-and-add property of m-sequences [1], the signaling code 
corresponding to an output signaling waveform is a partial 
period version of the m-sequence with a specific code phase 
inspired by the code mask. Assuming that the code sequence 
generated by the conventional m-sequence generator is c(t), 
there is a certain code-phase offset between the output signal-
ing waveform and c(t), which is determined by the contents of 
the code mask. As shown in Fig. 2, if code mask i is used, the 
corresponding signaling waveform φi(t) is inspired with the 
code-phase offset Oi. By applying different code masks, dif-
ferent signaling waveforms can be extracted for the correlative 
M-SCPSK modulation. It must be noted that the shift-register 
contents vary with time; and therefore the signaling waveform 
set Φ will vary on a symbol-by-symbol basis. 
The most recent (L+1) input symbols are denoted as 
[ ]01,,, ddd L −−= "d , where 0d  is the latest symbol. As 
shown in Fig. 1, the symbol 
jd−  is stored in the memory 
“Symbol(–j)” corresponding to the bits from (j+1)k–1 to j×k in 
the code mask. Initially, the bits from (L+1)k–1 to 0 are all 
assigned the value ‘0’, and the m–(L+1)k user addressing bits 
are assigned the pattern corresponding to this user. In the start 
of a symbol, previous stored symbols are sequentially shifted 
to the left-hand side memory, and the current input symbol is 
assigned to the right-most k bits. In other words, the contents 
in memory “Symbol(–j)” are shift to memory “Symbol(–j–1)” 
for j = 0,…, L – 1, and the current input symbol is set to mem-
ory “Symbol(0)”. This code mask is then used to generate the 
signaling waveform for the modulation of the current symbol. 
For multiple access environments, different users are distin-
guished by the m–(L+1)k user addressing bits; hence different 
users will employ distinct signaling waveform sets. 
Since the size of the signal constellations is M and the 
memory size is L, there are a total of LM=S  possible states, 
corresponding to the 1+LM  possible output signaling wave-
forms at each epoch (i.e., a symbol interval). At epoch q, the 
output signaling waveform depends on the code-mask contents 
at time Tqtq ×= , i.e., the symbol vector [ ]qd . The transmit-
ted signal can be represented as 
( ) ( ) ( ) ( )tfqTtpqTtts cq qt πφ α 2cos0 ,¦∞= −−= ,       (1) 
where 
cf  is the carrier frequency; p(t) is a unit amplitude 
pulse of duration T  starting at time zero; )(, tqαφ  is the 
N -chip output signaling waveform at epoch q; and the sub-
script α  ( 10 1 −≤≤ +LMα ) denotes the contents of the (L+1)k
bits in the code mask at epoch q, including the memory and 
current input symbol, i.e., ¦
=
−
×=
L
i
i
i Md0α
.
B. Correlative M-SCPSK Demodulation 
In the receiver, it is assumed that the receiving carrier phase 
and the m-sequence generator are well synchronized to the 
received signal. Since the memory size is L, there are 1+LM
possible output signaling waveforms for a symbol. The cor-
relative M-SCPSK receiver consists of a bank of 1+LM  cor-
relators matched to all possible signaling waveforms. Similar 
to Fig. 1, these correlators can be obtained by using an 
m-sequence generator and a set of code masks corresponding 
to all possible combinations of the L+1 symbols. The received 
signal is first multiplied by a synchronous local carrier, and 
then the sampled values of those N chips in a symbol interval 
are obtained. Subsequently, these sampled values are corre-
lated with these correlators, and the outputs of all correlators 
are obtained for each symbol interval.  
Since the correlative M-SCPSK modulation is a memory 
system, the maximum-likelihood sequence detection can be 
applied to the demodulation. The Viterbi algorithm is applied 
to the demodulation of the correlative M-SCPSK signals. In 
each epoch of the receiving trellis, there are LM=S  states, 
representing the L symbols stored in memory, and there are 
1+LM  branches, representing all possible signaling waveforms. 
The branch metrics are assigned the correlator outputs, and 
then the path metric of each surviving symbol sequence is 
MSB                        Modulo-2 Addition                          LSB
m-bit code mask
1: (L+1) k bits for
correlative SCPSK 
modulation
2: m - (L+1) k bits
for user addressing
xm
gm-1 gm-2 gm-3
…
… g2 g1
xm-1 xm-2 x3 x2 x
…
Conventional
m-sequence
generator
(a) Signaling waveform generator 
Code mask
operation
Signal point mapping  0 → +1, 1 → -1
Signaling waveform )(tiφ
c(t): Output sequence of conventional m-sequence generator
AND gates
(b) m-bit code mask for correlative M-SCPSK modulation
(L+1)k bits used for correlative M-SCPSK modulation 
m - (L+1) k bits used
for user addressing
…m-2 m-3 …m-1 (L+1)k 0k-1k2k-1 …Lk(L+1)k-1 … …
Symbol (0)Symbol (-1)Symbol (-L)
Memory: L symbols Current input
…
Modulo-2
addition
Signaling code
Fig. 1.  The signaling waveform generator and m-bit code mask. 
The spreading code
(period                    )12 −=
m
PN
)(tjφ )(tiφ
…101 00100…01011 11…
…111 00101…11001 00…
…000 11110…11000 10…
Oi
Oj
N chips
Code mask j
)(tc
Code mask i
N chips
i
j
Time
: Code phase of the conventional m-sequence generator
: Code phase corresponding to code mask i
: Code phase corresponding to code mask j
: signaling waveform corresponding to code mask i
: signaling waveform corresponding to code mask j
: code-phase offset for code mask i
: code-phase offset for code mask j
i
j
)(tjφ
)(tiφ
iO
jO
Corresponding to Corresponding to
Fig. 2.  Signaling waveforms and code-phase offsets. 
the erroneous path is a Gaussian RV with the mean 
¦
=
′
λ ρ
1
2 2
i i
TA  and the variance 
2
Ωλσ .
The demodulator will choose the erroneous event Ș′  only 
when Γ′>Γ. The normalized cross-correlation between these λ
consecutive received signaling waveforms and the λ correla-
tors in the erroneous path is λρρ λ¦
=
′=′
1i i
. Therefore, the 
pairwise error probability λP  between the correct path and 
the erroneous path, conditioning on ρ′ , is 
( )( ) ,1 γλρρλ ×′−=′ QP             (11) 
where πχχ 2)2exp()( 2 dZQ
Z³
∞
−= , and  
( ) ( )
»
¼
º
«
¬
ª
−
+=»¼
º
«¬
ª −
+=
N
K
ME
N
N
K
TA
N
b 3
12
log
1
3
122
1
2
0
2
0γ    (12) 
with ( )MTAEb 22 log2=  being the energy per bit. If λN >> 0, 
the value of ρ′  can be approximated as zero, and according 
(11) we have the pairwise error probability λP  becomes 
( )γλλ QP ≈ .                (13) 
E. Number of Erroneous Paths 
Because the memory size is L, the minimum value of λ is 
L+1. Hence, we have the range of λ being ∞<≤+ λ1L . The 
exact value of the number of erroneous paths δλζ ,  for spe-
cific values of λ and δ can be obtained via computer-aided 
search. Finally, according to (10) and (13), we have the aver-
age symbol error probability bounded by 
( ) ( ) 1,)1()1(
2 2
, ≥
∞
++−≤ ¦ ¦
+=
−
=
LQLQMP
L
L
error
λ
λ
δ
δλ γλζδγ .(14) 
If L = 0, corresponding to the original M-SCPSK modulation, 
the average symbol error probability is bounded by  
( ) 0for,)1( =−≤ LQMPerror γ .          (15) 
IV. NUMERICAL AND SIMULATION RESULTS
Simulation and numerical results are presented for per-
formance evaluation and comparison. In the simulation results, 
a practical m-sequence with period 1242 −=PN  is employed 
and the chosen characteristic polynomial is [8] 
.
1)(
42353331272625222119
18171610765321
xxxxxxxxxx
xxxxxxxxxxxg
+++++++++
+++++++++++=  (16) 
The performance comparison is shown in symbol error prob-
ability 
errorP  versus bit energy to noise power spectral density 
ratio 
0NEb .
Fig. 3 shows the performance comparison among coherent 
M-FSK, original M-SCPSK and correlative M-SCPSK modu-
lation schemes. The spreading factor is set to N = 128 and the 
number of users is assumed to be K = 1. The original 
M-SCPSK performs slightly worse than coherent M-FSK since 
it is a quasi-orthogonal modulation scheme. For the correlative 
M-SCPSK with L = 1, a significant improvement with a gain 
of 2.7 dB in 
0NEb  is obtained. The main cost of the correla-
tive M-SCPSK is an increase in the receiver complexity.  
Fig. 4 shows 
errorP  versus 0NEb  for N = 128, K = 1 and 
M = 4 or 8. It shows that the performance is greatly improved 
with the increase of memory size L. For M = 4, L = 1, 2 and 3 
correspond to state numbers S = 4, 16 and 64; whereas L = 1 
and 2 correspond to state numbers S = 8 and 64 for M = 8. The 
improvement in 
0NEb  is about 1.5 dB for L being increased 
from 1 to 2. For memory size L being increased from 2 to 3, 
the improvement in 
0NEb  is about 1 dB.  
One important metric of a modulation scheme is the band-
width efficiency, which is defined as the transmission bits per 
second per hertz (bits/s/Hz). Assuming that the spreading code 
chip rate is fixed to 
cR , the transmission bandwidth is about 
cRB = . Since the symbol rate is NRR cs = , the bandwidth 
efficiency of an M-SCPSK system can be expressed as 
S
y
m
b
o
l 
E
rr
o
r 
P
ro
b
ab
il
it
y
errorP
(dB)0NEb
1 1.5 2 2.5 3 3.5 4 4.5 5
10 -1
10 -2
10 -3
10 -4
10 -5
Numerical Results
Simulation Results
Correlative SCPSK
Correlative SCPSK
Correlative SCPSK
Correlative SCPSK
Correlative SCPSK
1,4 == LM
1,8 == LM
3,4 == LM
2,8 == LM
2,4 == LM
Fig. 4.  The symbol error probability 
errorP  versus 0NEb  for K = 1 and 
M = 4 or 8. 
S
y
m
b
o
l 
E
rr
o
r 
P
ro
b
ab
il
it
y
errorP
(dB)0NEb
1 1.5 2 2.5 3 3.5 4 4.5 5
10 -1
10 -2
10 -3
10 -4
10 -5
Coherent FSK
Coherent FSK
Numerical Results
Simulation Results
Original SCPSK
Original SCPSK
Correlative SCPSK
Correlative SCPSK
0,4 == LM
0,8 == LM
1,4 == LM
1,8 == LM
4=M
8=M
Fig. 3.  Performance comparison among coherent FSK, original SCPSK and 
correlative SCPSK modulations. 
Soft-Handoff Strategies for MB-OFDM Systems 
Xiu-Sheng Li and Yuh-Ren Tsai*  
Institute of Communications Engineering, National Tsing Hua University 
101, Sec. 2, Kuang-Fu Rd., Hsinchu 300, Taiwan 
yrtsai@ee.nthu.edu.tw 
 
Abstract —Multi-band OFDM (MB-OFDM) UWB system 
was proposed for the applications of wireless personal area net-
works (WPANs). If the user mobility is concerned, handoff from 
a piconet to neighboring piconets is unavoidable. There are only 
few works considering soft handoff in OFDM systems. In this 
work, a novel soft handoff strategy for the MB-OFDM system is 
proposed. The system performance is analyzed and simulations 
are performed. Two receiving schemes, FixedFilter and Dy-
namicFilter, are considered. Both FixedFilter and DynamicFilter 
improve the system performance. DynamicFilter is a little more 
complicated, but it provides larger performance gain. Finally, 
soft handoff can be achieved in the MB-OFDM system. 
Index Terms —Ultra Wideband (UWB); Orthogonal Fre-
quency Division Multiplexing (OFDM); Space Time Code (STC); 
I. INTRODUCTION 
Recently, the investigation activities on the issue of ultra 
wideband (UWB) systems grow up rapidly. Generally speak-
ing, UWB communication systems are applied to short-range 
wireless communications for their great advantages, such as 
coexisting with narrowband systems, low probability of in-
terception, low power density, and diversity gain of multipath 
resolution. In recent years, two major proposals were pro-
posed to the standard body IEEE 802.15.3 for the applications 
of wireless personal area networks (WPANs). One is the 
multi-band OFDM (MB-OFDM) system, and the other is the 
direct-sequence UWB (DS-UWB) system. The UWB systems 
are proposed to support radio transmissions in WPANs. The 
communication range in a piconet is normally confined to a 
small area around people or objects that typically cover at 
most 10 ~ 20 m. If the user mobility is concerned, handoff 
from a piconet to neighboring piconets is unavoidable.  
When a communicating handset moves from one cell (or 
piconet in UWB) to another, the channel in the serving cell 
(or piconet) has to be changed to a new channel in the target 
cell (or piconet). The process is called handoff. Handoff can 
be categorized into hard handoff and soft handoff. Soft hand-
off enhances the system performance through diversity com-
bining. Because of the nature of CDMA systems, soft handoff 
is easily implemented [1]; however it is more difficult to ap-
ply soft handoff in OFDM systems. There are only few works 
considering soft handoff in OFDM systems [2][3]. In [2], the 
system is combined with TDMA technique, and soft handoff 
can be implemented by occupying two different time slots. In 
[3], the serving and the target cell (or piconet) have to share 
the common channel for the user, and apply space time codes 
(STCs). Many systems do not combine TDMA technique or can 
not have the common channels in the serving and the target cell 
(or piconet). The MB-OFDM system is an example. The purpose 
of this work is to develop a novel soft handoff scheme for the 
MB-OFDM system. 
The remainder of this paper is organized as follows. Section II 
introduces the related MB-OFDM specification, the system 
model and the channel model. We propose the complete soft 
handoff strategy for MB-OFDM in Section III. Section IV con-
centrates on the system performance and simulation result. Fi-
nally, conclusions are drawn in Section V. 
II. SYSTEM AND CHANNEL MODELS 
The MB-OFDM system is concerned in this work. We will in-
troduce the related MB-OFDM specifications, the system model 
of MB-OFDM, and the applied channel models in this section. 
The soft handoff issue will also be drawn out. 
A. Related MB-OFDM Specification 
The basic element of the MB-OFDM system is a piconet, 
which is a collection of one or more logically associated devices 
that share a single identifier with a common coordinator. Coor-
dinators have similar function as base stations in cellular systems. 
Fig. 1 presents the scenario. There are three piconets in the fig-
ure, and each piconet has one coordinator in it. 
The channelization for different piconets is achieved by dif-
ferent time-frequency codes (TFCs). There are seven TFCs for 
Band Group 1 as follows [4] 
1 [1 2 3 1 2 3] 5 [1 1 1 1 1 1]
2 [1 3 2 1 3 2] 6 [2 2 2 2 2 2]
3 [1 1 2 2 3 3] 7 [3 3 3 3 3 3]
4 [1 1 3 3 2 2]
TFC TFC
TFC TFC
TFC TFC
TFC
= =
= =
= =
=
.       
There are 3 frequency bands in Band Group 1, called Band#1, 
Band#2, and Band#3. Carrier frequencies of Band#1, Band#2, 
and Band#3 are 1 3432Hzf = , 2 3960Hzf = , and 3 4488Hzf = , 
respectively, and every frequency band has bandwidth 528M Hz. 
In addition, one OFDM symbol in the MB-OFDM system occu-
pies 312.5 ns including Zero Padding (ZP) interval 70.08 ns. 
B. System Model 
We consider the scenario that all piconets perform similarly as 
the cellular systems, and all coordinators are synchronized with 
each other through a backbone network. When the desired re-
ceiver is near the boundary of two piconets, say Piconet A and 
Piconet B, the receiver receives signals from Coordinator A and 
This work was supported in part by the National Science Council, Taiwan, 
R.O.C., under Grant NSC 95-2219-E-007-006. 
1550-2252/$25.00 ©2007 IEEE  2722
where 128N =  and 528MHz /128f∆ = . Under the rela-
tionship, if the receiver samples ( )r t  by the original OFDM 
sampling rate fNfs ∆= , the sampled sequence becomes 
1
2 ( / 2) /
,
0
1
2 ( / 2) /
,
0
( )
( ),
N
j n N k N
s n X n
n
N
j n N k N
n Y n s
n
r kT X H e
Y H e w kT
π
π
−
−
=
−
−
=
= +
+
∑
∑
        (10) 
where 1/s sT f=  is the sampling duration. An N-point DFT 
is then applied on 1~0),( −= NkkTr s , and we will obtain 
nnYnnXnn WHYHXR ++= ,, ,            (11) 
where nW  is the DFT value of 1~0),( −= NkkTw s . Fig. 2 
shows the diversity combining concept applied in this work. 
When the received signals are down-converted to the base-
band, data 0 1 1[ ]NX X X −i i i  center around DC, and data 
0 1 1[ ]NY Y Y −i i i  center around the frequency y xf f− . After 
sampling the received signals by the sampling rate fNfs ∆= , 
0 1 1[ ]NX X X −i i i  and 0 1 1[ ]NY Y Y −i i i  are mixed up to-
gether as equation (11). This is equivalent to a 
multi-input-single-output (MISO) system [6], and therefore 
we can apply Alamouti STC in our soft handoff scheme to 
achieve diversity combining. 
B. Receiving Schemes 
When the receiver is in the non-handoff state, we need only 
a lowpass filter whose bandwidth is fN∆  (from 2/fN∆−  
to 2/fN∆ ), and the noise variance of w  in (10) is 0N fN∆ . 
In the soft handoff state, half the desired signals center around 
DC and the other half signals center around frequency 
y xf f− . We apply two receiving schemes for our soft handoff 
strategy in the MB-OFDM system. In the first receiving 
scheme, when soft handoff is activated, the receiver oscillator 
frequency is set to be 2f , and the lowpass filter applied has 
bandwidth fN∆×3  (from 2/3 fN∆−  to 2/3 fN∆ ). We call 
the above situation the FixedFilter case. In the second re-
ceiving scheme, during soft handoff state the receiver oscilla-
tor frequency is set equal to the serving coordinator carrier 
frequency. The scheme needs three filters, filter#1, filter#2, 
and filter#3, where the filter#1 is a lowpass filter whose 
bandwidth is fN∆  (from 2/fN∆−  to 2/fN∆ ), the filter#2 
is a lowpass filter whose bandwidth is fN∆×2  (from 
2/3 fN∆−  to 2/fN∆  or from 2/fN∆−  to 2/3 fN∆ ), and 
the filter#3 is a filter whose passband is from 2/fN∆−  to 
2/fN∆  combined with passband either from 2/3 fN∆  to 
2/5 fN∆  or from 2/5 fN∆−  to 2/3 fN∆− . Depending on 
TFCs at that time, the receiver determines which filter is used 
to leave the desired bandwidth only. For example, consider 
the situation that the serving piconet is using TFC = [1 2 3 1 2 
3] and the target piconet is using TFC = [1 3 2 1 3 2]. In the 
first TFC pattern, the serving piconet uses Band#1, and so 
does the target piconet. After the received signals are 
down-converted to baseband, the signals are within band-
width from 2/fN∆−  to 2/fN∆ . Therefore we apply fil-
ter#1 at the first symbol time. Which filter should be applied at 
the following symbol time can be derived in the same way. We 
name the receiving scheme DynamicFilter. 
The most difference between FixedFilter and DynamicFilter 
is the noise variance. The noise variance of w  in (10) under 
FixedFilter is 03 N fN× ∆ , three times the noise variance in the 
non-handoff state. The noise variance under DynamicFilter is 
dynamic. The noise variance for filter#1 is 0N fN∆ , and the 
noise variance for filter#2 or filter#3 is 02 N fN× ∆ . We regard 
the phenomenon as time domain noise enhancement. Since nW  
in (11) is the DFT value of 1~0),( −= NkkTw s , the frequency 
domain noise enhancement can be also derived. Noise enhance-
ment phenomenon will be considered when we analyze the sys-
tem performance. 
C. Proposed Soft Handoff Strategy 
In the sub-section, we propose the soft handoff strategy for 
MB-OFDM systems. The serving and the target coordinator can 
communicate through the backbone network, and cooperate to 
send information to the desired receiver. We will introduce how 
the coordinators collaborate with Alamouti STC and how the 
desired receiver decodes the Alamouti STC in the following. 
1) In the Coordinators 
TFCs repeat in every six symbols in MB-OFDM systems. We 
use the l-th symbol and the (l+6)-th symbol to combine with 
Alamouti STC, where qpl +×=12 , with ",2,1,0=p  and 
6,5,4,3,2,1=q . Let ,0 ,1 , 1[ 1 1 1 ]l l l l NX X X −=X1 "  and 
,0 ,1 , 1[ 2 2 2 ]l l l l NX X X −=X2 "  be the original data in non-handoff 
state corresponding to the l-th and the (l+6)-th symbols, respec-
tively, where ,1l nX  and ,2l nX  are modulated symbols on the 
n -th subcarrier. In the soft handoff state, we want to transmit 
lX1  and lX2  combining Alamouti STC to obtain diversity 
gain. According to 2×1 Alamouti STC, lX1  is transmitted in 
the l-th symbol time and *l−X2  is sent in the (l+6)-th symbol 
time at Coordinator A, where *)(•  means its complex conjugate. 
lX2  is transmitted in the l-th symbol time and *1lX  is sent in 
the (l+6)-th symbol time at Coordinator B. 
2) In the Desired Receiver 
The desired receiver receives signals from Coordinator A and 
Coordinator B at the same time. From (11), the received signals 
in the l-th symbol duration and in the (l+6)-th symbol duration 
on the n-th subcarrier are  
, , , , , ,
* *
6, , , , , 6,
1 2
2 1
l n l n A n l n B n l n
l n l n A n l n B n l n
R X H X H W
R X H X H W+ +
= + +
= − + +
,        (12) 
where nAH ,  and nBH ,  are the n-th subcarrier channel gain 
from Coordinator A and Coordinator B, respectively. Finally 
nlX ,1  and nlX ,2  can be obtained by STC decoding. 
IV. SYSTEM PERFORMANCE 
A. Analytical System Performance 
In the non-handoff state, the uncoded BPSK bit error prob-
ability (BER) over Rayleigh fading channel is 
 2724
REFERENCES 
[1] D. Wong, T. J. Lim, “Soft handoffs in CDMA mobile systems,” IEEE 
Personal Commun., vol. 4, issue 6, pp.6-17, Dec. 1997. 
[2] G. Lupo, R. Cautelier, M. G. Di Benedetto, F. Malena, “Dynamic re-
source allocation with a soft handover procedure for application in a 
broadband system,” in Proc. IEEE Vehicular Technology Conf. (VTC), 
vol. 4, pp. 2111-2115, 19-22 Sep. 1999. 
[3] E. Zeevy, A. Freedman, “Using space time codes on FDMA/TDMA 
based system with soft and hard handoff algorithm,” in the 22th Con-
vention of Electrical and Electronics Engineers in Israel, pp. 218-220, 1 
Dec. 2002. 
[4] Standard ECMA-368, “High Rate Ultra Wideband PHY and MAC 
Standard”. 
[5] 02490r0P802-15_SG3a-Channel-Modeling-Subcommittee-Report-Final
.doc. 
[6] B. Vucetic, J. Yuan, Space-Time Coding, Wiley   Book 
[7] A. Vielmon, Y. Li, J. R. Barry, “Performance of Alamouti transmit 
diversity over time-varying Rayleigh-fading channels,” IEEE Trans. 
Wireless Commun., vol. 3, issue 5. pp.1369-1373, Sep. 2004. 
 
0 5 10 15 20 25 3010
-4
10-3
10-2
10-1
100
Bi
t 
Er
ro
r 
Pr
ob
ab
ili
ty
errorP
(dB)γ
CM1                   CM4
non-handoff state
FixedFilter
DynamicFilter 0 collision
DynamicFilter 2 collision
DynamicFilter 3 collision
DynamicFilter 6 collision
Fig. 4  The bit error probability errorP  versus γ  for BPSK modulation 
over UWB channel models CM1 and CM4.  
After down-converted to baseband
After sampling
f∆ 2
N f∆
2
N f∆
−
xy ff −DC f
Sampling
, , ,
0 1
X n n Y n nH X H Y
n N
+
≤ ≤ −
DC
f∆
f
i i i
2
N f∆
− 2
N f∆
i i i
, ,
0 1
X n nH X
n N≤ ≤ −
i i i
, ,
0 1
Y n nH Y
n N≤ ≤ −
 
Fig. 2  Diversity combining concept applied in the proposed soft handoff 
scheme. 
Coordinator A
Device 1
Device 2
Coordinator C
Coordinator B
Device 3
Device 4
Backbone
Network
Piconet A
Piconet B
Piconet C
( )xh t
( )yh t
( )x t
( )y t
 
Fig. 1  The UWB environment considered in this work. 
0 2 4 6 8 10 12 14 16 18
10-5
10-4
10-3
10-2
10-1
100
Bi
t 
Er
ro
r 
Pr
ob
ab
ili
ty
errorP
(dB)γ
S           A            : non-handoff state
S           A            : FixedFilter
S           A            : DynamicFilter 0 collision
S           A : DynamicFilter 2 collision
S           A            : DynamicFilter 3 collision
S           A            : DynamicFilter 6 collision
S:Simulation A:Analytical
Fig. 3  The bit error probability errorP  versus γ  for BPSK modulation 
over Rayleigh fading channel model. 
0 2 4 6 8 10 12 14 16 1810
-4
10-3
10-2
10-1
100
Bi
t 
Er
ro
r 
Pr
ob
ab
ili
ty
errorP
(dB)γ
non-handoff state
FixedFilter
DynamicFilter
0rε =
0.2rε =
0.1rε =
 
Fig. 5  The bit error probability errorP  versus γ  for BPSK modulation 
under inter-carrier interference over UWB channel model CM1. 
 2726
channel estimation in a band. In such a scenario, each preamble 
symbol may be partially overlapped by an interfering symbol.  
Assume that the total number of sub-carriers in a transmis-
sion band is N, and that the preamble sequence of a OFDM 
symbol with a symbol duration T is {S[k], k = 0, 1,…, N – 1}. 
By IFFT (inverse fast Fourier transform), the sample values of 
the preamble symbol in the time-domain can be represented as  
1 2
0
1[ ] [ ] , 0,1, , 1N j nk N
k
s n S k e n N
N
π−
=
= × = −¦ " ,         (1) 
Before serially transmitting the time-domain samples, a cyclic 
prefix (CP) is generally added in front of an OFDM symbol to 
mitigate inter-symbol-interference (ISI) and to restore the or-
thogonality among different sub-carriers. However, for MB-
OFDM systems, a zero padded suffix (ZPS) rather than a CP is 
appended at the rear of an OFDM symbol, which can also miti-
gate ISI. To restore the orthogonality among different subcarri-
ers, the receiver will copy the received ZPS samples and then 
add it to the front of the OFDM symbol [13]. Adding a ZPS 
can achieve almost the same performance as adding a CP, but it 
slightly increases the received noise power. The length of the 
CP or ZPS is assumed to be N .
B. Channel Estimation
The time-domain signal s(t) passes through the propagation 
channel with an impulse response h(t). Since UWB channels 
vary very slowly and the symbol duration is very short, it is 
assumed that the preamble symbols transmitted in the same 
band suffer almost the same channel-selectivity fading. At the 
receiving end, a received symbol in the time-domain can be 
represented in a vector form as 
= ⊗ + + = ⊗ +y s h w m s h v ,                      (2) 
where ⊗ denotes the circular convolution operator; s is the sig-
nal vector, h is the channel response vector, w is the channel 
noise vector assumed to be additive white Gaussian noise 
(AWGN), and m is the multi-access interference vector coming 
from other SOPs, all in the time-domain; and v = w+m. For the 
frequency equivalent description, we have the received vector 
= × + + = × +Y S H W M S H V ,                    (3) 
where S = diag(S[0], S[1],…, S[N – 1]) is a diagonal matrix; H
is the frequency-domain channel response vector; W and M are 
the frequency-domain noise and interference vectors, respec-
tively; and V = W+M. By using the least-square criterion and 
assuming, for the sake of simplicity, the interference M to be a 
zero mean Gaussian process, we have the least-square estima-
tion for H being [14], [15] 
1ˆ ( )LS H H−= ×H S S S Y ,                           (4) 
where SH is the Hermitian matrix of S. Since S is a diagonal 
matrix, we have the estimated channel gain of sub-carrier k
being [14] 
ˆ [ ] [ ] [ ]LSH k Y k S k= ,                            (5) 
where S[k] and Y[k] are the transmitted and received signals of 
sub-carrier k, respectively. 
C. Channel Model
In this work, the ultra-wideband (UWB) multipath channel 
model is employed, which can be expressed as [16] 
1 1
, ,
0 0
( ) ( )j l l j l
l j
h t tχ ϕ δ τ
Γ− Λ−
= =
= × − ∆ −¦¦ ,                  (6) 
where ∆l is the group delay of the l-th cluster; ϕj,l and τj,l are the 
channel gain coefficient and the delay relative to ∆l, respec-
tively, all in relation to the j-th multipath in the l-th cluster; Γ is 
the cluster number; Λ is the multipath number in a cluster; χ
represents the log-normal shadowing; and δ(•) is the delta 
function. With different parameters, four typical environments 
are defined: CM1, CM2, CM3 and CM4. 
III. ADAPTIVE CHANNEL ESTIMATION SCHEMES
A. Time Redundancy Property 
Based on the interference collision scenario, one intuitive 
consideration is to let the channel estimation symbols have a 
time-domain diversity property to resolve the damage caused 
by asynchronous interference. Frequency-domain decimation, 
sacrificing the resolution in the frequency-domain, is an effi-
cient way to provide the TR property [17]. If all sub-carriers 
are decimated by a factor of 2, we may decimate all the odd-
numbered sub-carriers or all the even-numbered sub-carriers. 
Assuming that only the even-numbered sub-carriers are used 
(i.e., the odd-numbered sub-carriers are set to zero), we have, 
according to (1), the OFDM symbol in the time-domain as 
1
4 2
even
0
1[ ] [2 ] , 0,1, , 1
2
M
j nk M
k
s n S k e n N
M
π
−
′
′=
′= × = −¦ " ,    (7) 
where M = N/2. It must be noted that the last half of seven[n] is 
the duplication of the first half, since  
1
2 ( )2 2
even
0
1
4 2 2
0
even
1[ ] [2 ]
2
1 [2 ]
2
[ ], 0,1, , 1.
M
j n M k M
k
M
j nk M j k
k
s n M S k e
M
S k e e
M
s n n M
π
π π
−
′+
′=
−
′ ′
′=
′+ = ×
′= × ×
= = −
¦
¦
"
          (8) 
On the other hand, if only the odd-numbered sub-carriers are 
used, we have  
1
2 (2 1) 2
odd
0
1[ ] [2 1] , 0,1, , 1
2
M
j n k M
k
s n S k e n N
M
π
−
′+
′=
′= + × = −¦ " .(9) 
Similarly, it is noted that the last half of sodd[n] is the minus 
duplication of the first half. Therefore, we have the TR prop-
erty for the channel estimation symbols. 
B. Time Redundancy with Linear Interpolation Estimation 
Based on the TR property, we propose a channel estimation 
scheme – Time Redundancy with Linear Interpolation (TRLI) 
estimator to improve the channel estimation performance. In 
the transmitter, the preamble symbols use only all the even sub-
carriers or all the odd sub-carriers in order to obtain the TR 
property. To simplify the explanation of our proposed schemes, 
919
Authorized licensed use limited to: National Tsing Hua University. Downloaded on October 5, 2008 at 23:59 from IEEE Xplore.  Restrictions apply.
interfered case. Four estimation schemes are investigated: con-
ventional LSE, TRLI-LSE, TRLI-ASR, and TREO-ASR, 
where TREO-ASR scheme only applies to the case with two 
preamble symbols. The performance of conventional LSE is 
regarded as a baseline performance.
Fig. 2 shows the average NMSE of one preamble symbol 
versus SNR for an interference-free channel, where TRLI de-
notes the TRLI-LSE scheme. Because that the power on each 
even sub-carrier of TRLI is doubled when compared with con-
ventional LSE, the estimation performance on even sub-
carriers of TRLI is far better than that of conventional LSE; 
however, interpolation errors on odd sub-carriers may deterio-
rate the overall average estimation performance of TRLI. Since 
the correlation between two adjacent sub-carriers is very high 
for CM1 and is very low for CM4, we have very small interpo-
lation errors for CM1 and large interpolation errors for CM4. 
Thus TRLI outperforms conventional LSE for CM1, whereas 
the NMSE performance of TRLI is worse than that of conven-
tional LSE due to the degradation of interpolation errors. 
Moreover, due to that the copy and add process of ZPS will 
introduce more channel noise, the estimation performance with 
ZPS is slightly worse than that with CP. 
Fig. 3 shows the average NMSE of one preamble symbol 
with CP versus SNR for SIR = 9 dB. The estimation perform-
ance is saturated by interference for very high SNR.  A channel 
with a delay-spread larger than the CP length, such as CM4, 
will introduce inter-carrier interference (ICI) and ISI, resulting 
in performance degradation. Comparing TRLI-LSE and TRLI-
ASR, the results show that TRLI-ASR outperforms TRLI-LSE 
only for high SNR, which is mainly due to the fact that TRLI-
ASR can eliminate full/part of the interference, but at the cost 
of AWGN enhancement.  
Fig. 4 shows the average NMSE of one preamble symbol 
with CP versus SNR for SIR = -3 dB, i.e. the interference 
power is two times the received signal power. It is found that 
the performance of conventional LSE is severely degraded by 
the interference. Although the performance of TRLI-LSE and 
TRLI-ASR is also degraded by the interference, it is still far 
better than that of conventional LSE both for CM1 and CM4.  
For UWB systems, there are two preamble symbols avail-
able for channel estimation. Fig. 5 shows the average NMSE of 
two preamble symbols with ZPS versus SNR for SIR = 9 dB. 
Because the interpolation error is very large for CM4, the per-
formance of TRLI-ASR with EGC is worse than that of con-
ventional LSE with EGC for CM4. By using the TREO-ASR 
scheme, linear interpolation is not required and no interpolation 
error is introduced; hence, a performance better than that of 
conventional LSE with EGC is obtained both in CM1 and 
CM4. Nevertheless, the performance of TREO-ASR in CM1 is 
worse than that of TRLI-LSE and that of TRLI-ASR, since the 
interpolation error is very small in CM1.  
Fig. 6 shows the average NMSE of two preamble symbols 
with ZPS versus SNR for SIR = -3 dB. Since the interference 
power is very large, both TRLI-ASR and TREO-ASR outper-
form the conventional LSE and TRLI-LSE with EGC.  
V. CONCLUSIONS
In this work, we have proposed TRLI-LSE, TRLI-ASR and 
TREO-ASR schemes for the channel estimation of OFDM 
SNR (dB)
N
or
m
al
iz
ed
 M
ea
n 
Sq
ua
re
 E
rr
or
 (N
M
SE
)
0 2 4 6 8 10 12 14 16 18
10 0
10 -1
10 -2
Simulation
LSE, CP:    CM1;    CM4;
LSE, ZPS:    CM1;    CM4;
TRLI, CP:    CM1,    CM4;
TRLI, ZPS:    CM1,    CM4;
Fig. 2. NMSE of one symbol estimation versus SNR in an interference-free 
channel. 
SNR (dB)
N
or
m
al
iz
ed
 M
ea
n 
Sq
ua
re
 E
rr
or
 (N
M
SE
)
0 2 4 6 8 10 12 14 16 18
10 0
10 -1
10 -2
Simulation
LSE:    CM1,    CM4
TRLI-LSE:    CM1,    CM4
TRLI-ASR:    CM1,    CM4
Fig. 3. NMSE of one symbol estimation with CP for SIR = 9 dB. 
SNR (dB)
N
or
m
al
iz
ed
 M
ea
n 
Sq
ua
re
 E
rro
r (
N
M
SE
)
0 2 4 6 8 10 12 14 16 18
10 0
10 -1
Simulation
LSE:    CM1,    CM4
TRLI-LSE:    CM1,    CM4
TRLI-ASR:    CM1,    CM4
Fig. 4. NMSE of one symbol estimation with CP for SIR=-3 dB. 
921
Authorized licensed use limited to: National Tsing Hua University. Downloaded on October 5, 2008 at 23:59 from IEEE Xplore.  Restrictions apply.
Data-carrier Aided Carrier Frequency Offset Estimation           
for OFDM Systems 
Yuh-Ren Tsai*, Xiu-Sheng Li, and Chih-Yu Wei 
Institute of Communications Engineering, National Tsing Hua University 
101, Sec. 2, Kuang-Fu Rd., Hsinchu 300, Taiwan  
yrtsai@ee.nthu.edu.tw
Abstract—In order to prevent inter-carrier interference (ICI), 
carrier frequency offset (CFO) estimation is essential and crucial 
for OFDM systems. Conventional fractional CFO estimation can 
be classified into two categories: the pilot tone-aided (PTA) 
schemes and the cyclic prefix-based (CPB) schemes. In addition 
to the subcarriers dedicated for channel/frequency estimation, 
data subcarriers are also candidates that may be potentially used 
to improve the CFO estimation. In this work, we propose novel 
data-subcarrier aided CFO estimation algorithms, without the 
need of demodulating the data in advance, for M-PSK data 
modulated OFDM systems. According to the simulation results, it 
is found that the proposed algorithms can significantly improve 
the CFO estimation performance at the cost of an increase in 
computational complexity. 
Keywords—Carrier frequency offset (CFO); cyclic prefix (CP); 
inter-carrier interference (ICI); orthogonal frequency division 
multiplexing (OFDM); pilot tone. 
I. INTRODUCTION
Recently, orthogonal frequency division multiplexing 
(OFDM) has attracted widespread attention for future wireless 
communications. In order to prevent inter-carrier interference 
(ICI), maintaining orthogonality among all subcarriers is essen-
tial for OFDM systems. Both the frequency oscillator mis-
match between the transmitter and the receiver and Doppler 
effects for mobile users will lead to the carrier frequency offset 
(CFO) problem, destroying the orthogonality among all subcar-
riers. The normalized CFO, defined as the carrier frequency 
offset divided by the subcarrier spacing, can be partitioned into 
the integral part and the fractional part. The integral CFO 
causes subcarrier cyclic shifting; while the fractional CFO re-
sults in not only ICI, but also the amplitude reduction and 
phase rotation of the desired signal, thus severely degrading the 
receiving performance. To maintain an acceptable performance, 
the receiver must estimate and compensate the receiving CFO. 
The integral CFO can be easily estimated and compensated 
by the receiver; hence, in this work, the performance of frac-
tional CFO estimation is the major concern. Conventional frac-
tional CFO estimation can be classified into two categories: the 
pilot tone-aided (PTA) schemes [1]-[5] and the cyclic prefix-
based (CPB) schemes [6]-[9]. Furthermore, various blind CFO 
estimation schemes have been proposed and investigated [10]-
[14]. Since those schemes are generally with much higher 
complexity and implementation cost, we focus only on the 
PTA and CPB schemes in this work. For the PTA-based 
schemes, known pilot symbols are transmitted periodically on 
some specific subcarriers. The CFO estimation is then obtained 
by comparing the phases corresponding to a specific pilot sub-
carrier in two received OFDM symbols. The CPB-based 
schemes employ the correlation between the cyclic prefix (CP) 
and the corresponding samples of the received signal in the 
time-domain to evaluate CFO. Moreover, data subcarriers are 
also candidates that may be potentially used to improve the 
CFO estimation. After data demodulation, if the data symbols 
have been correctly decoded, the phase errors on the data sub-
carriers may be used to improve the CFO estimation [15]-[16]. 
However, coarse demodulation on the data subcarriers is essen-
tial before CFO estimation, and an iterative process is neces-
sary in order to obtain better performance; otherwise, this 
scheme can neither benefit the demodulation of current symbol 
nor resist a sudden change of CFO. 
To utilize the CFO information embedded in the data sub-
carriers, we propose novel data-subcarrier aided CFO estima-
tion algorithms based on the PTA and CPB schemes, without 
the need of demodulating the data in advance, for M-PSK data 
modulated OFDM systems. The proposed algorithms can sig-
nificantly improve the CFO estimation performance at the cost 
of an increase in computational complexity. The remainder of 
this paper is organized as follows. Section II illustrates the sys-
tem and channel models. Section III proposes the data-
subcarrier aided CFO estimation algorithms. Section IV pre-
sents the simulation results for performance evaluation. Finally, 
the conclusion is drawn in Section V. 
II. SYSTEM AND CHANNEL MODELS
A. OFDM System Model  
Let Xm[n] denote the modulated data on subcarrier n of the 
m-th OFDM symbol, where 0 1n N≤ ≤ −  and N is the OFDM 
IFFT size. After IFFT, we have the transmitted OFDM symbol 
with CP in the time-domain being 
1 2
0
1[ ] [ ] , for 0 1
,
[ ] [ ], for 1
N j nk N
n
CP
x k X n e k N
N
x k x N k N k
π−
=
­
= × ≤ ≤ −°
®
° = + − ≤ ≤ −¯
¦    (1)
where NCP is the length of CP. The received samples of the m-
th OFDM symbol, excluding the CP, can be represented as  
( )[ ] [ ] exp [ ] [ ], 0 1m CP m m my N k z k j k w k k Nφ+ = × + ≤ ≤ − , (2) 
where zm is the circular convolution of xm and the channel 
impulse response hm; [ ] 2 ( ) /m f CP CPk mN mN N k Nφ πδ= + + +
is the phase shift due to CFO; wm is the complex additive white 
This work was supported in part by the National Science Council, Taiwan, 
R.O.C., under Grant NSC 96-2219-E-007-006.
978-1-4244-1645-5/08/$25.00  ©2008 IEEE 898
Authorized licensed use limited to: National Tsing Hua University. Downloaded on October 6, 2008 at 0:0 from IEEE Xplore.  Restrictions apply.
CFO is chosen as the presumed decision variable for this data 
subcarrier. Finally, the final CFO estimation is determined 
based on the decision variables of all subcarriers, including 
pilot subcarriers and data subcarriers. 
Assume that the number of data subcarriers is ND and D de-
notes the set of indices corresponding to all data subcarriers. 
The details of the MPTA scheme are shown as follows. 
Step 1: According to (8), find the reference CFO 
,
ˆ
f PTAWδ  by 
using the PTAW scheme. Moreover, the reference phase corre-
sponding to 
,
ˆ
f PTAWδ  is determined as 
( ),ˆ 2ref f PTAW CPN N Nδ πξΨ = × + .                (11) 
Step 2: For each data subcarrier, the M possible decision 
variables are determined as 
* 2[ , ] [ ] [ ] , for 1, , ,j i MD m mV i n Y n Y n e i M n
π
ξ+= × = ∈ D" ,   (12) 
where 2 ,  1, , ,j i Me i Mπ = "  denote the M possible values of 
phase rotation due to data modulation. 
Step 3: According to the M possible decision variables, 
determine the M possible phases for each data subcarrier, i.e., 
{ }[ , ] Angle [ , ] , for 1, , ,Di n V i n i M nΨ = = ∈ D" .      (13) 
Step 4: Compared to Ψref, the presumed decision variable on 
data subcarrier n is determined as the one with a phase closest 
to Ψref, i.e., 
( )1, ,ˆ [ ] arg min [ , ] , ,D D refi MiV n V i n n n=ª º= Ψ − Ψ ∈« »¬ ¼ D" .      (14) 
Step 5: Based on VP2[n] (n ∈ P) and ˆ [ ]DV n  (n ∈ D), the final 
CFO estimation is given by 
, 2
1ˆ ˆAngle [ ] [ ]
2f MPTA P Dn nCP
N V n V n
N N
δ
πξ ∈ ∈
­ ½
= × × +® ¾
+ ¯ ¿
¦ ¦
P D
.  (15) 
D. Modified Cyclic Prefix – Based CFO Estimation  
The second proposed scheme is referred to as the modified 
CPB (MCPB) scheme since the reference CFO is obtained by 
using the CPB method. Due to the influence of AWGN, the 
number of samples that are taken for estimation is crucial for 
estimation accuracy. In the conventional CPB, there are only 
1CPN L− +  samples, which do not suffer from ISI, used for 
CFO estimation. However, when L is too large, there will be 
only limited number of samples available for CFO estimation; 
thus the estimation performance is severely degraded. In the 
proposed MCPB scheme, the signals of data subcarriers in the 
frequency-domain are used to improve the estimation perform-
ance. This method is similar to that of the proposed MPTA 
scheme except that the initial reference CFO is obtained by 
using the CPB scheme. Details of the MCPB scheme are 
shown as follows. 
Step 1: According to (9), the reference CFO 
,
ˆ
f CPBδ  is obtained 
by using the CPB scheme. Moreover, the equivalent frequency-
domain reference phase is determined as  
( ),ˆ 2ref f CPB CPN N Nδ πξΨ = × + .                (16) 
Step 2 – Step 4: Similar to Step 2, Step 3 and Step 4 of the 
MPTA scheme. 
Step 5: Based on ˆ [ ]DV n  (n ∈ D) obtained in Step 4, the final 
CFO estimation is given by  
,
1ˆ ˆAngle [ ] .
2f MCPB DnCP
N V n
N N
δ
πξ ∈
­ ½
= × × ® ¾
+ ¯ ¿
¦
D
          (17) 
IV. SIMULATION RESULTS
In the simulation, 4 CFO estimation schemes, including the 
PTAW, MPTA, CPB and MCPB schemes, are investigated 
with the MSE taken as the performance criterion. The FFT size 
is N = 256, the transmission bandwidth is 5.76 MHz, the length 
of CP is NCP = 64 samples, and the sampling time is 173.6 ns 
[18]. In addition, the average received signal-to-noise ratio 
(SNR) per subcarrier γ  is defined as the ratio of the average 
received symbol energy to the one-sided power spectral density 
of the channel noise. Two successive symbols are used for 
CFO estimation, i.e., ξ = 1. For the PTA-based schemes, the 
number of pilot subcarriers is assumed to be NP = 8; while the 
number of data subcarriers is assumed to be ND = N – NP = 248. 
The M-PSK data modulation is assumed to be BPSK, QPSK or 
8-PSK. The employed channel models are ITU-5 and ITU-6 
with the delay spread lengths are 2.51 µs (equivalent to 15 
samples) and 20 µs (equivalent to 116 samples), respectively. 
Since the CP length is 11.11 µs, the delay spread length is 
smaller than the CP length for ITU-5 model and is larger than 
the CP length for ITU-6 model. 
It is noted that the CPB scheme is a time-domain estimation 
method, the MCPB scheme is a hybrid (both in the time-
domain and in the frequency-domain) estimation method, and 
both of the PTAW and MPTA schemes are the frequency-
domain estimation methods. Basically, the ISI will degrade the 
MSE performance of the time-domain estimation methods, 
while the ICI will degrade the MSE performance of the fre-
quency-domain estimation methods. Hence, it is expected that 
the estimation performance will be dominated by the ISI and 
the ICI for the time-domain and the frequency-domain estima-
tion methods, respectively. It must be noted that, however, if 
the channel delay spread is larger than the CP length, the or-
thogonality among different subcarriers will be destroyed by 
the multipath interference, and the ICI will be thus introduced. 
Fig. 1 shows the performance of the PTAW and MPTA 
schemes with δf = 0.05 under ITU-5 model. Comparing the 
performance of the MPTA scheme with different data modula-
tion schemes, it is found that the case with low level data 
modulation outperforms that with high level data modulation. 
This is mainly due to that the data modulation phase ambiguity 
will impact the estimation performance especially for high 
level data modulation. In addition, the estimation performance 
improvement achieved by using the data subcarriers, for exam-
ple at 15 dBγ = , is about 15 dB for BPSK data modulation, 10 
dB for QPSK data modulation, and 3 dB for 8-PSK data modu-
lation. Specifically for BPSK data modulation, the gain is about 
the ratio of the numbers of available subcarriers for estimation, 
900
Authorized licensed use limited to: National Tsing Hua University. Downloaded on October 6, 2008 at 0:0 from IEEE Xplore.  Restrictions apply.
On the other hand, when ITU-6 model is applied, the perform-
ance of the CPB-based schemes is very sensitive to the ISI and 
is severely degraded by the ISI. Although the ISI in ITU-6 
model also introduces the ICI that will degrade the perform-
ance of the PTA-based schemes, the degradation is not very 
severe. Thus the PTA-based schemes become to outperform 
the CPB-based schemes. This implies that the PTA-based 
schemes are more robust for the propagation channel with a 
large delay spread. 
V. CONCLUSIONS
In this work, we propose two modified algorithms for CFO 
estimate based on the conventional PTA and CPB methods. 
Compare to the conventional schemes, we conclude that the 
modified schemes, including the MPTA and MCPB schemes, 
can significantly improve the estimation performance at the 
cost of increase the computational complexity. Moreover, we 
should employ different CFO estimation scheme under differ-
ent propagation environments. If the multipath delay spread is 
much smaller than CP length, the MCPB scheme will be the 
best method because it can provide excellent MSE performance 
with its robustness to the ICI and modulation size M. However, 
when there is a strong ISI with a delay spread exceeding CP 
length, we should utilize the MPTA scheme since it is more 
tolerant to the ISI. 
REFERENCES
[1] P. Moose, “A technique for orthogonal frequency division multiplexing 
frequency offset correction,” IEEE Trans. Commun., vol. 42, pp. 2908-
2914, Oct. 1994. 
[2] W. Lei, W. Cheng, L. Sun, “Improved joint carrier and sampling 
frequency offset estimation scheme for OFDM systems,” , in Proc. IEEE 
Global Telecommunications Conf., 2003 (GLOBECOM '03), vol. 4, pp. 
2315 – 2319, 1-5 Dec. 2003. 
[3] S. Kapoor, D. J. Marchok, and Y.-F. Huang, “Pilot assisted 
synchronization for wireless OFDM systems over fast time varying 
fading channels,” in Proc. IEEE Vehicular Technology Conf. (VTC), 
vol. 3, pp. 2077-2080, 18-21 May 1998. 
[4] C. R. N. Athaudage, K. Sathananthan and R. R. V. Angiras, ”Enhanced 
frequency synchronization for OFDM systems using timing error 
feedback compensation,” in Proc. IEEE International Symposium on 
Personal, Indoor and Mobile Radio Communications 2004 (PIMRC 
2004) , vol. 3, pp. 1988-1992, 5-8 Sep. 2004. 
[5] W. Xiang and T. Pratt, “A simple cascade carrier frequency and 
sampling clock offsets estimation method for OFDM systems,” in Proc. 
IEEE Consumer Comm. and Networking Conf. 2004 (CCNC 2004), pp. 
718-720, 5-8 Jan 2004. 
[6] H. Chen and G.J. Pottie, "A comparison of frequency offset tracking 
algorithms for OFDM", in Proc. IEEE Global Telecommunications 
Conf., 2003 (GLOBECOM '03), vol.2, pp. 1069-1073, 1-5 Dec. 2003. 
[7] P. Liu, B. B. Li, Z. Y. Lu, and F. K. Gong “A new frequency 
synchronization scheme for OFDM,” IEEE Trans. Consumer 
Electronics., vol. 50, pp. 823-828, Aug. 2004. 
[8] Y. S. Choi, P. J. Voltz, and F. A. Cassara, “ML estimation of carrier 
frequency offset for multicarrier signals in rayleigh fading channels,” 
IEEE Trans. Veh. Technol., vol. 50, pp. 644-655, March. 2001. 
[9] N. Lashkarian and S. Kiaei, “Class of cyclic-based estimators for 
frequency-offset estimation of OFDM systems,” IEEE Trans. Commun., 
vol. 48, pp. 2139-2149, Dec. 2000. 
[10] U. Tureli, H. Liu, and M. Zoltowski, “OFDM blind carrier offset esti-
mation: ESPRIT,” IEEE Trans. Commun., vol. 48, pp. 1459-1461, 
Sep. 2000.” 
[11] M. Ghogho, A. Swami, and G. B. Giannakis, “Optimizing null-
subcarrier selection for CFO estimation in OFDM over frequency-
selective fading channels,” in Proc. GLOBECOM, Nov. 2001.” 
[12] B. Chen, “Maximum likelihood estimation of OFDM carrier frequency 
offset,” IEEE Signal Process. Lett., vol. 9, pp. 123-126, April 2002. 
[13] B. Chen and H. Wang, “ Blind estimation of OFDM carrier frequency 
offset via oversampling,” IEEE Trans. Signal Process., vol. 52, 
pp.2047--2057, July 2004.
[14] D. D. Lin, R. A. Pacheco, T. J. Lim, and D. Hatzinakos, “Joint estima-
tion of channel response, frequency offset, and phase noise in OFDM,” 
IEEE Trans. Signal Process., vol. 54, pp.3542--3554, Sep. 2006.
[15] K. Shi, E. Serpedin, and P. Ciblat, “Decision-directed fine 
synchronization for coded OFDM systems,” in Proc. IEEE International 
Conf. on Acoustics, Speech, and Signal Processing. (ICASSP’04), vol. 4, 
pp. 365-368, 17-21 May 2004. 
[16] K. Shi, E. Serpedin, and P. Ciblat, “Decision-directed fine 
synchronization in OFDM systems,” IEEE Trans. Commun., vol. 53, pp. 
408-412, March 2005.  
[17] “Channel Models and Performance Metrics for IEEE 802.16j Relay Task 
Group,” IEEE 802.16j Relay Task Group. 
[18] IEEE Standard for Local and metropolitan area networks Part 16㧦Air 
Interface for Fixed Broadband Wireless Access Systems. 
0 50 100 150 200 25010
-6
10-5
10-4
DN
CPB - BPSK
CPB - QPSK
CPB - 8PSK
MCPB - BPSK
MCPB - QPSK
MCPB - 8PSK
M
ea
n 
Sq
ua
re
 E
rr
or
 (M
SE
)
Fig. 4  MSE performance of MCPB versus the number of data subcarriers 
used for CFO estimation with δf = 0.05 and γ  = 15 dB under ITU-5 model. 
M
ea
n 
Sq
ua
re
 E
rr
or
 (M
SE
)
0 5 10 15 20 25 30
10-2
10-3
10-4
10-5
10-6
ITU-5   ITU-6
Simulation PTAW
Simulation MPTA
Simulation CPB
Simulation MCPB
(dB)γ
Fig. 5  MSE performance comparison for ITU-5 and ITU-6 channel models 
with δf = 0.05 and QPSK data modulation scheme. 
902
Authorized licensed use limited to: National Tsing Hua University. Downloaded on October 6, 2008 at 0:0 from IEEE Xplore.  Restrictions apply.
ocean or in the forests, a well planned deployment may not
be feasible, and thus sensor nodes are deployed randomly
over the entire desired area. In general, the uniform deploy-
ment strategy with the same density over the entire sensing
area can achieve the best network sensing coverage in the
initial phase. However, under the assumption that all nodes
are homogenous with the same available energy, uniform
deployment is not the optimal strategy in the viewpoint of
network lifetime. Those nodes located at an area with high
energy consumption will run out of available energy and
die off quickly. Therefore, in an early phase, the network
sensing coverage may lose in some area and even the net-
work may become disconnected. This implies that the ap-
plied node deployment strategy is crucial for network per-
formance, and must be well designed according to the ap-
plied message delivery mechanism. In [11–19], the energy-
hole effect in randomly distributed WSNs is revealed, and
some node deployment strategies were proposed to mitigate
this effect and to improve system performance. An analyt-
ical model for this effect is presented in [11] for a sensing
area being partitioned into a set of concentric rings with the
data sink locating at the center. The authors also showed
that both assistant-node deployment and data compression
can diminish the energy-hole effect in a uniformly deployed
sensor network. In [12], several design criterions were pro-
posed for the avoidance of energy holes in a WSN with uni-
form node deployment.
In [13–18], non-uniform node deployment is exploited as
an alternative manner to get over the effect of non-uniform
energy depletion. The basic concept is that different node
densities are assigned to different sub-regions trying to bal-
ance the communication load of each sub-region. Some
works specifically consider the scenario for concentric sub-
regions (rings); the node density of a ring is determined
based on the number of hops to the data sink, which is
roughly approximated to be the same for all locations in
a ring In [13–16]. In [17], the imbalanced energy utiliza-
tion of a WSN was analyzed based on the hop counts, and
the authors accordingly proposed a non-uniform node dis-
tribution depending on the hop-count to improve the long-
term connectivity. In [18], the energy-hole problem was
discussed in a more general form for a rectangular sens-
ing area with multiple data sinks at different locations. The
maximum progress concept for multi-hop transmission is
adopted to exploit the average hop length for the balance of
energy consumption in each sub-region. However, some en-
ergy consumption, such as that in the sensing process, has
not been taken into consideration, and some results strongly
depend on an arbitrarily chosen parameter which is not the-
oretically proven to be optimal. Moreover, the impact of lo-
cal sensing coverage on the message generation is also not
considered. Another approach, heterogeneous deployment,
overcomes the communication load unbalance problem by
using two types of sensors, low energy sensors and high
energy sensors, to construct a hierarchical network struc-
ture [19]. However, this scheme raises the deployment and
implementation complexity and cannot be easily applied.
In this work, we focus on the node deployment problem
for large-scale randomly distributed WSNs. Since the en-
ergy consumption is location dependent, the applied node
deployment strategy should be non-uniform fitting to the
energy consumption distribution in order to achieve good
network lifetime and network sensing coverage. For a lo-
cation with high energy consumption, nodes shall be de-
ployed with a high density; whereas, a low density for a
location with low energy consumption. Based on the en-
ergy consumption distribution of multi-hop based routing
protocols, we devise the optimal node density distribution
that achieves the best network performance. The sensing
coverage, message forwarding and energy consumption is-
sues are well examined and taken into consideration in our
proposed deployment strategy. The information flow accu-
mulation (IFA) based node deployment strategy is proposed
in order to achieve the best sensing coverage performance.
The remainder of this paper is organized as follows. Sec-
tion 2 illustrates the system and energy consumption mod-
els. Section 3 illustrates the proposed IFA-based deploy-
ment strategy for multi-hop routing WSNs. In Section 4 the
numerical and simulation results are presented to verify the
superiority of our proposed strategy. Finally, the conclusion
is drawn in Section 5.
2. Preliminaries
2.1. System Model
The desired sensing area is assumed to be a rectangle
with length L and width W , i.e. the area is A = L ×W .
There are N sensor nodes randomly and independently de-
ployed within this area. All nodes are assumed to be ho-
mogenous, i.e. with the same sensing ability and the same
energy. Suppose that the sensing radius of a node is R, the
available sensing area of a node is πR2. The sensing event
occurrence is also assumed to be homogenous in the sensing
area, i.e. equiprobable for different locations, with a density
of δ events per unit area per unit time. When a sensing event
occurs at a location, one and only one node, which is closest
to this location, will forward a unit of information to the BS
if this location is covered by at least one node. The required
routing information is assumed to be available after the net-
work initialization phase, and is therefore not discussed in
this work.
The data sink is assumed to be a line BS locating beside
an edge of the sensing area, as shown in Fig. 1. The trans-
mission power of each node is assumed to be a constant
corresponding to the maximum communication range 2R
518
Authorized licensed use limited to: National Tsing Hua University. Downloaded on October 5, 2008 at 23:57 from IEEE Xplore.  Restrictions apply.
Moving
direction
along a belt
Sensing
circle
Arrival
node iDeparture
node
d∆
R
On service
node
is
js
ir
jr
Arrival
node j
Reference
indicator
∆A
Figure 2. The arrival and departure processes
of nodes for a reference indicator moving
across the sensing area along a belt.
a Poisson process. The service time has a distribution that
will be determined late. Thus, we can model this queueing
system as an M/G/∞ queue, where the number of parallel
servers, corresponding to the maximum number of nodes
that could be accommodated within the sensing circle, is
approximated to be infinity [21].
In Fig. 2, assuming that the velocity of the reference
indicator is v, the moving distance after a fraction of time
∆t is ∆d = v × ∆t, and the incremental area ∆A swept
over by the sensing circle is
∆A = 2R×∆d = 2Rv ×∆t. (4)
By approximating the average node density around belt-l as
ρ(l), the arrival process is a Poisson process with the arrival
rate Λ(l) = ρ(l)∆A/∆t = 2Rvρ(l), and the probability
mass function (PMF) of K nodes existing in the area ∆A
can be expressed as
Φ(K, l) = e−ρ(l)∆A [ρ(l)∆A]K
/
K!. (5)
The departure process depends on incident location of a
sensor node. As shown in Fig. 2, the two arrival nodes, node
i and node j will cross the sensing circle with the strings
being si and sj , respectively. Then the service time τi is
defined as the time interval for node i staying within the
sensing circle, i.e.,
τi = si/v. (6)
If the string sj is larger than si, the service time τj is larger
than τi. The minimum distance between the string si and
the reference indicator is denoted as ri, 0 ≤ ri ≤ R.
Then we have ri uniformly distributed within (0, R), since
nodes are reasonably approximated to be uniformly dis-
tributed in the belt. The relation between si and ri is
ri =
√
R2 − (si/2)2. Subsequently, we have the proba-
bility density function (pdf) of si as
fs(si) = fr(ri)× si
4
√
R2−(si/2)2
= si
4R
√
R2−(si/2)2
, 0 ≤ si ≤ 2R, (7)
where fr(ri) = 1/R is the pdf of ri. Accordingly, the pdf
of the service time τi is
fτ (τi) = fs(si)× v = τiv
2
4R
√
R2 − (τiv/2)2
. (8)
Furthermore, we can derive the cumulative density function
(cdf) of the service time τi as
Fτ (τi ≤ x) = 1−
√
1− (xv/2R)2, 0 ≤ x ≤ 2R/v. (9)
Subsequently, we can obtain the average service time as
1
µ =
∫ 2R/v
0
[1− Fτ (τi ≤ x)] dx
= Rv
[
xv
2R
√
1− ( xv2R)2 + sin−1 ( xv2R)]∣∣∣∣2R/v
0
= Rv ×
(
sin−1 1− sin−1 0) = πR2v , (10)
where µ = 2v/πR is the service rate and
∫ √
a2 − x2 dx =
1
2
[
x
√
a2 − x2 + a2 sin−1 x|a|
]
. It is noted that the service
rate is independent of the node density.
According to the well known results of an M/G/∞
queueing system, the steady-state probability that there is
no user in the queueing system, or equivalently the proba-
bility that the reference indicator is not covered by any sen-
sor node, is [21]
p0(l) = exp (−Λ(l)/µ) = exp
(−πR2ρ(l)) . (11)
In other words, in belt-l, the percentage of the area that
is covered by at least one node is 1 − p0(l) = 1 −
exp (−Λ(l)/µ). Consequently, we have the origination in-
formation density per unit breadth in belt-l as
IO(l) =
[
1− exp (−πR2ρ(l))]Wδ. (12)
3.2. Relay Information Density
In this work, the average relay information depends on
the progress of message forwarding, which is assumed to
be in the positive direction toward the BS. As shown in
Fig. 3, considering that a reference node located at belt-
y intends to forward a message to the BS, it can success-
fully forward this message if at least one node exists within
the left half side of its communication range, i.e. within
the relay region Φ(y) having an area of 2πR2. By ap-
plying the minimum hop routing concept, the node with
the maximum forwarding progress is chosen as the relay
520
Authorized licensed use limited to: National Tsing Hua University. Downloaded on October 5, 2008 at 23:57 from IEEE Xplore.  Restrictions apply.
originated in the rear region (i.e. it depends on the node den-
sity in the rear region), the optimal node distribution cannot
be obtained directly. However, the optimal node distribution
can be obtained by applying the iterative algorithm shown
as follows.
IFA-based Node Deployment Algorithm
Step 1: Set an arbitrary initial node distribution ρ0(l), e.g.
ρ0(l) = N/A for uniformly distributed.
Step 2: According to (14), calculate the distribution of for-
warding progress fZ(y, z).
Step 3: According to (12), calculate the origination infor-
mation density IO(l) in each belt.
Step 4: According to (16), calculate the relay information
density IR(l) in each belt.
Step 5: Based on IO(l) and IR(l) obtained in Step 3 and
Step 4, and according to (19), calculate the average energy
consumption E(l,∆t) in each belt.
Step 6: Based on E(l,∆t) obtained in Step 5 and accord-
ing to (21), calculate the node density ρ(l) in each belt.
Step 7: If the node density does not converge, then go to
Step 3.
Finally, the converged node density is the optimal node den-
sity for deployment.
4. Results and Discussions
To evaluate the performance of the proposed node de-
ployment strategy, we examine system performance via
simulation. It is assumed that the desired sensing area is
a rectangle with L = 250 m and W = 50 m. The sensing
range is R = 10 m, i.e. the communication range is 20 m.
The initial available energy in a node is 1 Joule, and the
parameters related to energy consumption are Eelec = 50
nJ/bit, εamp = 100 pJ/bit/m3, k = 300 and β = 3. We further
introduce an energy relay ratio η, which is defined as the
ratio of the energy consumption of relaying a message to
the energy consumption of transmitting an origination mes-
sage. This energy relay ratio describes the distribution of
energy consumption in a node, including message recep-
tion, message transmission and event sensing, and impacts
on the resolved optimal node density distribution. The en-
ergy consumption of relaying a message is ERx+ETx(2R),
and the energy consumption of transmitting an origination
message is ESen + ETx(2R). Consequently, we have
η =
ERx + ETx(2R)
ESen + ETx(2R)
. (22)
Fig. 4 shows the optimal node density distribution ob-
tained via the IFA-based deployment strategy for different
node numbers with η = 1.125. The number of node is as-
sumed to be N = 200, 300, 400, 500 or 1000. For compar-
ison, the Y-axis is denoted as the normalized node density,
which is defined as ρ(l)/N . When the number of node is
large enough, the deployed node can almost cover the en-
tire sensing area. Consequently, the origination information
generated on each belt is almost the same, irrelevant to the
distance l, and the relay information is linearly proportional
to the accumulation distance. Thus the optimal deployed
node density ρ(l) approximates to be linearly proportional
to L − l. When the number of node is limited, however,
the deployed node density that fits to the energy consump-
tion distribution cannot achieve good coverage on the far-
end area. Therefore, the origination information generated
within a belt farther away from the BS is much less than that
generated within a belt in the near area. As a result, a very
high percentage of nodes are deployed in the near-end area,
and the optimal deployed node density ρ(l) is no longer to
be linear.
N
or
m
al
iz
ed
 n
od
e 
de
ns
ity
Distance to the line BS (m)
N = 200
N = 300
N = 400
N = 500
N = 1000
0 50 100 150 200 250
0
0.2
0.4
0.6
0.8
1.0
1.2
1.4
1.6
1.8
2.0
×10 -4
Figure 4. The IFA-based node density distri-
bution for different node numbers N with η =
1.125.
Fig. 5 shows the optimal node density distribution for
different energy relay ratios η with N = 200. The energy
relay ratio is assumed to be η = 1.0, 1.125, 1.5 or 2.0. For a
small value of η, the optimal node density distribution tends
to be linear. On the other hand, for a large value of η, the en-
ergy consumption of relay information is much larger than
that of origination information. Accordingly, more nodes
must be deployed in the near area in order to overcome the
message relay burden.
Fig. 6 shows the normalized sensing coverage, defined
as the percentage of the entire desired area that can be cov-
ered by the network, versus time steps for the uniform de-
ployment strategy and the IFA-based deployment strategy
with η = 1.125 and N = 200 or 500. For the uniform deploy-
ment strategy, a better sensing coverage can be achieved
in the initial phase. However, in the early phase, some
522
Authorized licensed use limited to: National Tsing Hua University. Downloaded on October 5, 2008 at 23:57 from IEEE Xplore.  Restrictions apply.
N
um
be
r 
o
f a
ct
iv
e/
iso
la
te
d 
n
o
de
s
Time steps (Rounds)
Active nodes
Isolated nodes
Active nodes
Isolated nodes
IFA-based
Uniform
Uniform
IFA-based
0 50 100 150 200 250 300 350 400 450 500
0
50
100
150
200
250
300
350
400
450
500
Figure 7. The number of active/isolated
nodes versus time for the uniform and the
IFA-based deployment strategies with η =
1.125 and N = 500.
[6] R. Madan and S. Lall, ”Distributed Algorithms for
Maximum Lifetime Routing in Wireless Sensor Net-
works,” IEEE Trans. Wireless Commun., vol. 5, no. 8,
pp. 2185-2193, Aug. 2006.
[7] L. Subramanian and R. H. Katz, ”An Architecture
for Building Self Configurable Systems,” in Proc.
IEEE/ACM Wksp. Mobile and Ad Hoc Networking
and Computing, pp. 63-73, Aug. 2000.
[8] L. Li, and J. Y. Halpern, ”Minimum-Energy Mobile
Wireless Networks Revisited,” in Proc. IEEE Interna-
tional Conference on Communications (ICC), vol. 1,
pp. 278-283, June. 2001.
[9] M. J. Handy, M. Haase and D. Timmermann, ”Low
Energy Adaptive Clustering Hierarchy with Determin-
istic Cluster-Head Selection,” in Proc. Int’l. Wksp.
Mobile and Wireless Communications Network, pp.
368 - 372, Sep. 2002.
[10] Y.-R. Tsai, ”Coverage-Preserving Routing Protocols
for Randomly Distributed Wireless Sensor Networks,”
IEEE Trans. Wireless Commun., vol. 6, no. 4, pp.
1240-1245, April 2007.
[11] J. Li and P. Mohapatra, ”An Analytical Model for the
Energy Hole Problem in Many-to-One Sensor Net-
works,” in Proc. IEEE Vehicular Technology Confer-
ence (VTC), pp. 2721-2725, 2005.
[12] S. Olariu and I. Stojmenovic, ”Design Guidelines for
Maximizing Lifetime and Avoiding Energy Holes in
Sensor Networks with Uniform Distribution and Uni-
form Reporting,” in Proc. IEEE International Confer-
ence on Computer Communications (INFOCOM), pp.
1-12, Apr. 2006.
[13] S.-C. Liu, ”A Lifetime-Extending Deployment Strat-
egy for Multi-Hop Wireless Sensor Networks,” in
Proc. IEEE Communication Networks and Services
Research Conference, pp. 53-60, May 2006.
[14] D. Wang, Y. Cheng, Y. Wang and D. P. Agrawal, ”Life-
time Enhancement of Wireless Sensor Networks by
Differentiable Node Density Deployment,” in Proc.
IEEE International Conference on Mobile Adhoc and
Sensor Systems (MASS), pp. 546 - 549, Oct. 2006.
[15] X. Wu, G. Chen and S.K. Das, ”On the Energy Hole
Problem of Nonuniform Node Distribution in Wire-
less Sensor Networks,” in Proc. IEEE International
Conference on Mobile Adhoc and Sensor Systems
(MASS), pp. 180-187, Oct. 2006.
[16] G. Chen, S. K. Das and X. Wu, ”Avoiding Energy
Holes in Wireless Sensor Networks with Nonuniform
Node Distribution,” IEEE Trans. Parallel and Dis-
tributed Systems: Accepted for future publication,
2007.
[17] Y. Liu, H. Ngan and L. M. Ni, ”Power-Aware Node
Deployment in Wireless Sensor Networks,” in Proc.
IEEE International Conference on Sensor Networks,
Ubiquitous, and Trustworthy Computing (SUTC), pp.
128-135, June 2006.
[18] J. Lian, K. Naik, and G. Agnew, ”Data Capacity Im-
provement of Wireless Sensor Networks Using Non-
Uniform Sensor Distribution,” International. Journal
of Distributed Sensor Networks, vol. 2, no. 2, pp. 121-
145, April-June 2006.
[19] J.-J. Lee, B. Krishnamachari and C.-C. J. Kuo, ”Im-
pact of heterogeneous deployment on lifetime sensing
coverage in sensor networks,” in Proc. IEEE Confer-
ence on Sensor and Ad Hoc Communications and Net-
works (SECON), pp. 367-376, Oct. 2004.
[20] G. L. Stuber, Principles of Mobile Communication,
2nd Edition, Boston, Kluwer Academic Publishers,
2001.
[21] D. Gross and C. M. Harris, Queueing Theory, 3rd Edi-
tion, New York, John Wiley & Sons, 1998.
[22] T.-C. Hou and V. Li, ”Transmission Range Control
in Multi-hop Packet Radio Networks,” IEEE Trans-
actions on Communications, vol. 34, pp. 38-44, Jan.
1986.
524
Authorized licensed use limited to: National Tsing Hua University. Downloaded on October 5, 2008 at 23:57 from IEEE Xplore.  Restrictions apply.
z International Workshop on Network-based Virtual Reality and Tele-existence 
(INVITE2008) 
z IEEE International Workshop on Service Oriented Architectures in Converging 
Network Environments (SOCNE2008) 
z Workshop on Security in RFID and it’s Industrial Applications (RFID2008) 
z IEEE Symposium on Mining And Web (MAW2008) 
z International Workshop on Applications of Ad hoc and Sensor Networks 
(AASNET2008) 
z IEEE International Workshop on Opportunistic Networking (WON2008) 
z International Workshop on Disaster and Emergency Information Network Systems 
(IWDENS2008) 
z IEEE Workshop on Bioinformatics and Life Science Modeling and Computing 
(BLSMC2008) 
z International Symposium on Ubiquitous Application & Security Service (UASS2008) 
z International Workshop on Telecommunication Networking, Applications and Systems 
(TeNAS2008) 
z International Workshop on Data Management for Wireless and Pervasive
Communications (DMWPC2008) 
z IEEE International Workshop on Bio Computing (BioCom2008) 
我們的論文是在 IEEE AINA 2008 會議中以口述發表 (Oral presentation) 的方式
來進行論文發表，此次 IEEE AINA 2008 共有 469 篇論文投稿，只接受了 147 篇論
文，接受率僅僅只有 31%，可以說是相當低的論文接受率，也顯見我們發表的論文有
較高的論文品質。此外，部分落選的論文則被建議改投至其他同時舉行的相關領域學
術會議，其論文的接受率則為較高的 48% (投稿 623 篇，接受 298 篇)。因此，整個
會議共有 445 篇論文進行發表。 
由於學校教學課程時間的緣故，我於三月二十五日 (星期二) 當天早上才出發前往
日本沖繩縣，抵達那霸市機場之後，還必須坐約一小時的巴士前往會場所在的宜野湾
市，報到參加一連四天的會議議程。對於我而言，比較有興趣的相關議題為： 
z Mobile Applications 
z Mobile Communication Networks  
z Ad-Hoc Networks 
z Wireless LAN Technology 
z Wireless Sensor Networks 
z Communication Protocols 
因此參加這些議題相關的發表會議，了解到了許多相關領域的研究方向與研究現況。
我們論文則在三月二十七日 (星期四) 的 “Session 5E : Wireless Sensor Networking and 
Control” 中發表。 
 
四、心得 
Non-uniform Node Deployment for Lifetime Extension
in Large-scale Randomly Distributed Wireless Sensor Networks ∗
Yuh-Ren Tsai†, Kai-Jie Yang and Sz-Yi Yeh
Institute of Communications Engineering
National Tsing Hua University
Hsinchu 30013, Taiwan
yrtsai@ee.nthu.edu.tw
Abstract
Network sensing coverage and network lifetime are the
two major performance metrics for WSNs. Different data
forwarding/routing mechanisms lead to different amounts
and different distributions of energy consumption in a net-
work. Moreover, nodes at different locations will suffer
from different message forwarding burdens, either due to
the amounts of forwarding messages or due to the required
transmission power. In this work, we focus on the node
deployment problem for large-scale randomly distributed
WSNs, and proposed a non-uniform node deployment strat-
egy, the IFA-based deployment strategy, for the multi-hop
routing scenario. The sensing coverage, message forward-
ing and energy consumption issues are well examined and
taken into consideration in our proposed deployment strat-
egy. The iterative algorithm that figures out the optimal
node density distribution fitting to the energy consumption
distribution has been devised. Simulation results show that
the proposed IFA-based deployment strategy can signifi-
cantly improve the sensing coverage performance of a WSN.
1. Introduction
Wireless sensor networks (WSNs) have been widely ap-
plied to the applications such as environmental surveillance
and remote parameters detection. To gather the measured
information for further processing, all nodes have to col-
lect and to forward the measured data in a collaborative
way. Various types of routing protocols have been pro-
posed for the applications of message delivery in WSNs.
According to the network structure, routing protocols can
∗This work was supported in part by the National Science Council,
Taiwan, R.O.C., under Grant NSC 96-2752-E-007-003-PAE.
†: Corresponding author
be classified into two major categories: flat-based routing
and hierarchical-based routing [1]. For flat-based routing,
each node plays the same role and is typically assigned the
same functionality. The message forwarding is achieved
via multi-hop transmission [2–6]. For hierarchical-based
routing (also known as clustering-based routing), nodes
self-organize themselves into several local clusters, each of
which has one node serving as the cluster-head. A cluster-
head collects all the messages in that cluster and then for-
wards an aggregate message to a remote base station (BS)
[7–10].
Network sensing coverage, defined as the percentage of
the entire area covered by a network, and network life-
time, defined as the time duration maintaining a specific
network performance, are the two major performance met-
rics for WSNs. Since the energy available in a node is lim-
ited, network sensing coverage will be degraded gradually
when some nodes die off as time goes on. In order to im-
prove network performance, some energy-efficient strate-
gies have been devised for data sensing, message routing
and data processing. However, it is inevitable that nodes
must consume considerable energy in forwarding either the
self-measured data or the data coming from other nodes dur-
ing the data gathering process. Different data forwarding
mechanisms lead to different amounts and different distri-
butions of energy consumption in a network. Moreover,
nodes at different locations will suffer from different mes-
sage forwarding burdens, either due to different amounts of
forwarding messages or due to different required transmis-
sion power. In other words, the energy consumption due
to the data gathering process is non-uniform over the entire
sensing area. For multi-hop routing protocols, those nodes
closer to the data sink must relay plenty of information gen-
erated by other nodes, and thus they may use up their scarce
energy quickly, which is also referred to as the energy-hole
problem [11].
In some applications, such as on the battlefield, on the
22nd International Conference on Advanced Information Networking and Applications
1550-445X/08 $25.00 © 2008 IEEE
DOI 10.1109/AINA.2008.55
517
Authorized licensed use limited to: National Tsing Hua University. Downloaded on October 5, 2008 at 23:57 from IEEE Xplore.  Restrictions apply.
which is twice as large as the sensing range R. Every node
forwards the sensing results to the BS via the relay of other
nodes, unless it can reach the BS directly. Furthermore, the
applied routing protocol is assumed to be a minimum hop
routing protocol.
Line BS
W
L
l
Sensor
Belt-l
Figure 1. The system model for the multi-hop
routing scenario.
2.2. Energy Consumption Model
The major energy consumption of a node includes the
energy for message reception, for message transmission,
and for event sensing. The energy for event sensing is gen-
erally linearly proportional to the time period of operation
and is assumed to be ESen(∆t) = ESen×∆t, where ESen
is the average power consumption and ∆t is a time inter-
val. The energy for message reception depends only on the
number of received messages. For the energy for message
transmission, it depends not only on the number of trans-
mitted messages but also on the radio propagation model.
In this work, we applied a simple propagation loss model
expressed as [20]
L(d) = L(d0) + 10β log10(d/d0), (1)
where d denotes the transmission distance; L(d) (in dB
units) denotes the propagation loss; L(d0) (in dB units) is
the propagation loss at a reference distance d0; and β de-
notes the path loss exponent. We also adopt the energy con-
sumption model stated in [9] with the parameters Eelec, rep-
resenting the energy dissipated to operate the transmitter or
receiver circuitry per bit (in nano-Joule), and εamp, denot-
ing the energy dissipation of the transmitter power amplifier
for transmitting a bit to a receiver with a distance of d = 1
unit away in order to achieve an acceptable quality. By as-
suming that each sensing message contains k bits, we have
the energy dissipation for transmitting a message to a re-
ceiver with a distance d away being
ETx(d) = k(Eelec + εampdβ). (2)
Specifically, the transmission power is a constant corre-
sponding to the communication range d = 2R. In the re-
ceiver, the energy dissipation for receiving a message is
ERx = kEelec. (3)
3. IFA-based Deployment Strategy
For the multi-hop routing scenario, all nodes must for-
ward the messages originated by it, and also have the re-
sponsibility of relaying the messages originated by other
nodes farther away from the BS. The burden (i.e. the aver-
age energy consumption) of a node depends on the amount
of messages forwarded by this node. As in Fig. 1, under
the line BS assumption, different locations in a belt bear the
same amount of average message forwarding load, and thus
the node density in a belt can be reasonably assumed to be
uniform and depends only on the distance between the BS
and this belt, i.e. the node density in the belt with a dis-
tance l to the BS is denoted as ρ(l). To find the average
energy consumption in a belt, we have to analyze the av-
erage origination information density and the average relay
information density on a specific belt.
3.1. Information Origination
As shown in Fig. 1, consider the belt, which is thereafter
denoted as belt-l, with a unit breadth and having a distance
l to the BS. The amount of information generated in belt-l,
denoted as I(l), depends on the percentage of the area in
this belt covered by this network. First we determine the
network sensing coverage within this belt. Assuming that
a reference indicator moves across the sensing area along
belt-l, this indicator is only sensed by those nodes having
a relative distance to this indicator smaller than the sens-
ing range R, i.e. inside the sensing circle centered at the
indicator and with a radius R. As the reference indicator
moves, some nodes originally existing within the sensing
circle may become to be outside the sensing circle, and can
detect the indicator no more. On the other hand, some sen-
sor nodes may enter the sensing circle, and can then detect
the indicator for a certain period of time. As shown in Fig.
2, a node exiting from the sensing circle is defined as a de-
parture, a node entering the sensing circle is defined as an
arrival, and the time interval between the arrival and the de-
parture of a node is defined as the service time. The sensing
coverage in belt-l can be resolved by modeling it as a queue-
ing system. Due to that all nodes are independently and ran-
domly deployed, the arrival process can be approximated as
519
Authorized licensed use limited to: National Tsing Hua University. Downloaded on October 5, 2008 at 23:57 from IEEE Xplore.  Restrictions apply.
2R
Reference
node
Other
node
Relay region
Φ(y) = Φ1(y, z)+Φ2(y, z)
Selected node
(with the maximum
forwarding progress) 
Φ1(y, z)
Φ2(y, z)
z
Forwarding direction
(toward the BS)
Figure 3. The maximum forwarding progress
for multi-hop routing.
node [22]. If there is no node located within Φ1(y, z) and
there is at least one node located within Φ2(y, z), then
the forwarding progress will be less than z. Due to ran-
dom deployment, the node distribution can be regarded
as a two-dimensional Poisson point process. The aver-
age number of nodes located within Φ1(y, z) is η1(y, z) =∫ 2R
z
2
√
4R2 − r2ρ(y − r)dr, and the probability that there
is no node located within this region is exp (−η1(y, z)). On
the other hand, the average number of nodes located within
Φ2(y, z) is η2(y, z) =
∫ z
0
2
√
4R2 − r2ρ(y − r)dr, and the
probability that there is at least one node located within this
region is 1 − exp (−η2(y, z)). As a result, the cdf of the
progress Z (0 < Z ≤ R ), conditioning on the occurrence
of a forwarding, can be expressed as
FZ(y, z) =
exp
(
−
∫ 2R
z
2
√
(2R)2−r2×ρ(y−r) dr
)
1−exp
(
−
∫ 2R
0
2
√
(2R)2−r2×ρ(y−r) dr
)
− exp
(
−
∫ 2R
0
2
√
(2R)2−r2×ρ(y−r) dr
)
1−exp
(
−
∫ 2R
0
2
√
(2R)2−r2×ρ(y−r) dr
) . (13)
By partially differentiating FZ(y, z) by z, we can obtain the
pdf of the forwarding progress Z as
fZ(y, z) =
∂FZ(y,z)
∂z
=
exp
(
−
∫ 2R
z
2
√
4R2−r2×ρ(y−r)dr
)
×[2
√
4R2−z2×ρ(y−z)]
1−exp
(
−
∫ 2R
0
2
√
4R2−r2×ρ(y−r)dr
) .
(14)
For a specific belt, the average total forwarding informa-
tion flow IT is the sum of the average origination informa-
tion IO and the average relay information flow IR in this
belt, i.e., for belt-l
IT (l) = IO(l) + IR(l). (15)
The average relay information in belt-l is accumulated from
the rear region that may forward message to this belt. Thus,
according to (14) and (15), we have the relay information in
belt-l as
IR(l)=


∫ 2R
2R−l IT (l + z)fZ(l + z, z)dz, 0 < l < 2R∫ 2R
0
IT (l + z)fZ(l + z, z)dz, 2R ≤ l ≤ L− 2R,∫ L−l
0
IT (l + z)fZ(l + z, z)dz, L− 2R < l ≤ L
(16)
where the accumulating region is 2R except for the belts
near the boundaries, i.e. 0 < l < 2R and L− 2R < l ≤ L.
It is noted that the nodes in a belt with a distance 0 < l <
2R can forward messages directly to the BS and contribute
no information flow to other belts.
3.3. Energy Consumption
Based on the applied energy consumption model and IT ,
we can evaluate the average overall energy consumption in
belt-l. For a time interval ∆t, the energy consumption for
event sensing is ESen(∆t). The energy consumed for mes-
sage reception can be expressed as
ERx(l,∆t) = IR(l)×∆t× ERx. (17)
On the other hand, the energy consumed for message trans-
mission can be expressed as
ETx(l,∆t) = IT (l)×∆t× ETx(2R). (18)
It must be noted that ERx(l,∆t) depends on the average
relay information IR(l) and ETx(l,∆t) depends on the av-
erage total forwarding information IT (l). Then the average
total energy consumption in belt-l can be expressed as
E(l,∆t) = ESen(∆t) + ERx(l,∆t) + ETx(l,∆t). (19)
Accordingly, we have the ratio of the average energy
consumption in belt-l to the average energy consumption
of the entire system as
Θ(l) = E(l,∆t)
/∫ L
0
E(x,∆t)dx. (20)
To distribute system energy according to the average energy
consumption in a belt, we must deploy in belt-l with the
node density as
ρ(l) = N ×Θ(l)/W. (21)
3.4. Optimal Node Deployment
The goal of the proposed IFA-based node deployment
strategy is to extend the lifetime of a WSN, and thus the
node density must be proportional to the average energy
consumption in a belt. Since the average energy consump-
tion in a belt depends also on the amount of information
521
Authorized licensed use limited to: National Tsing Hua University. Downloaded on October 5, 2008 at 23:57 from IEEE Xplore.  Restrictions apply.
N
o
rm
al
iz
ed
 n
od
e 
de
n
sit
y
Distance to the line BS (m)
η = 1.0
η = 1.125
η = 1.5
η = 2.0
0 50 100 150 200 2500
0.4
0.8
1.2
1.6
2.0
2.4
2.8
×10 -4
Figure 5. The IFA-based node density distri-
bution for different energy relay ratios η with
N = 200.
nodes close to the BS have used up their own energy and
died off quickly due to heavy relay burden, and the net-
work becomes disconnected. Thus, the sensing coverage
is degraded rapidly. On the other hand, for the IFA-based
deployment strategy, the sensing coverage is worse in the
initial phase due to the non-uniform deployment. However,
the sensing coverage is degraded slowly and smoothly, and
still achieves an acceptable performance in the middle and
final phases. This shows the superiority of the proposed
IFA-based strategy. Furthermore, if good sensing coverage
in the initial phase is essential, the available node number
must be large enough in order to overcome the non-uniform
node distribution property.
We further examine the number of active nodes, defined
as the nodes that can successfully forward messages to the
BS, and the number of isolated nodes, defined as the nodes
that are still alive but cannot successfully forward messages
to the BS. Fig. 7 shows the number of active/isolated nodes
versus time with η = 1.125 and N = 500. The number of
dead nodes can be obtained by N minus the number of
active nodes and the number of isolated nodes. For the
uniform deployment strategy, there are a large amount of
isolated nodes which induce significant degradation in the
sensing coverage. While, for the proposed strategy, the
number of isolated nodes is well controlled and minimized.
5. Conclusion
In this work, we have proposed a non-uniform node de-
ployment strategy, the IFA-based deployment strategy, for
large-scale randomly distributed WSNs. Based on the en-
ergy consumption distribution, the iterative algorithm that
N
o
rm
al
iz
ed
 
se
n
sin
g 
co
v
er
ag
e
Time steps (Rounds)
Uniform
IFA-based
N = 500
N = 200
N = 500
N = 200
IFA-based
Uniform
0 50 100 150 200 250 3000
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Figure 6. The normalized sensing coverage
for the uniform and the IFA-based deploy-
ment strategies with η = 1.125.
figures out the optimal node density distribution achieving
the best sensing coverage performance has been devised.
Simulation results show that the proposed node deployment
strategy can significantly improve the sensing coverage per-
formance of a WSN.
References
[1] J. N. Al-Karaki and A. E. Kamal, ”Routing techniques
in wireless sensor networks: a survey,” IEEE Wireless
Communications, vol. 11, pp. 6-28, Dec. 2004.
[2] C. Schurgers and M. B. Srivastava, ”Energy Efficient
Routing in Wireless Sensor Networks,” in Proc. IEEE
MILCOM Communications for Network-Centric Op-
erations: Creating the Information Force, pp. 357-361,
Oct. 2001.
[3] S. Servetto and G. Barrenechea, ”Constrained Ran-
dom Walks on Random Graphs: Routing Algorithms
for Large Scale Wireless Sensor Networks,” in Proc.
ACM Int’l. Wksp. Sensor Networks and Applications,
pp. 12-21, Sep. 2002.
[4] J.-H. Chang and L. Tassiulas, ”Maximum Lifetime
Routing in Wireless Sensor Networks,” IEEE/ACM
Trans. Networking, vol. 12, no. 4, pp. 609-619, Aug.
2004.
[5] S. Kulkarni, A. Iyer, and C. Rosenberg, ”An Address-
Light, Integrated MAC and Routing Protocol for
Wireless Sensor Networks,” IEEE/ACM Trans. Net-
working, vol. 14, no. 4, pp. 793-806, Aug. 2006.
523
Authorized licensed use limited to: National Tsing Hua University. Downloaded on October 5, 2008 at 23:57 from IEEE Xplore.  Restrictions apply.
