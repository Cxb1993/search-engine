 II
 
圖表索引 
圖 1、流程圖 ......................................................................................................................................4 
圖 2、手持異物流程圖 ......................................................................................................................5 
圖 3、手持異物流程圖 ......................................................................................................................6 
圖 4、安全帽偵測流程圖 ..................................................................................................................7 
圖 5、安全帽偵測流程-像素取樣.....................................................................................................8 
圖 6、「口罩偵測」流程圖　 ............................................................................................................9 
圖 7、臉部特徵強化 (a)原始資訊 (b)強化後資訊(n = 3) (c)強化後資訊(n = 6) .......................11 
圖 8、人眼幾何外型比 ....................................................................................................................12 
圖 9、眼部和嘴部之間的相對位置與幾何外型比 ........................................................................13 
圖 10、手持異物偵測實驗 ..............................................................................................................14 
圖 11、遺留物品偵測--實驗一 .......................................................................................................16 
圖 12、遺留物品偵測--實驗二 .......................................................................................................17 
圖 13 安全帽偵測之實例：(a)原始影像；(b)物體邊界資訊；(c)圓弧資訊；(d)安全帽偵測結果
....................................................................................................................................................18 
圖 14、男性正面沒戴口罩(a)輸入之影像 (b)分析後 (c)輸出之訊息 ........................................19 
圖 15、女性正面沒戴口罩(a)輸入之影像 (b)分析後 (c)輸出之訊息 ........................................19 
圖 16、頭部旋轉沒戴口罩(a)輸入之影像 (b)分析後 (c)輸出之訊息 ........................................20 
圖 17、頭部低下之影像(a)輸入之影像 (b)分析後 (c)輸出之訊息 ............................................20 
圖 18、頭部歪斜沒戴口罩(a)輸入之影像 (b)分析後 (c)輸出之訊息 ........................................20 
圖 19、配戴眼鏡之影像(a)輸入之影像 (b)分析後 (c)輸出之訊息 ............................................21 
圖 20、低頭的影像(a)輸入之影像 (b)分析後 (c)輸出之訊息 ....................................................21 
圖 21、監視器拍攝的影像(a)輸入之影像 (b)分析後 (c)輸出之訊息 ........................................22 
圖 22、監視器拍攝的影像(a)輸入之影像 (b)分析後 (c)輸出之訊息 ........................................22 
 
 2
 
貳、 研究背景與目的 
 
意圖犯罪的人行動時，或多或少都有些異於常人的行為。因此本計劃一開始，便利用影
像中的人體追蹤技術(person tracking technique)，使得人的範圍能夠從影像中切割出來，並且
持續追蹤。 
 
而後，我們將結合本主持人先前所研發出來的手持異物偵測、安全帽偵測、遺留物偵測
與口罩偵測技術，對被追蹤的人檢測是否屬不正常行為或戴有遮敝物。一個成功的人臉口罩
偵測或安全帽偵測系統的市場應用，例如門禁管理、金融業務、犯罪偵察與電腦認證。並且
在最近幾個月來的提款機盜領事件中，我們也可以發現到盜領者總是會利用口罩或衣物來掩
蓋自己的臉部資訊，在這種情況下將會增加偵辦人員的破案困難度。我們利用蓋伯濾波器來
建立影像中的人臉特徵，接著利用影像強化[1](image enhancement)技術來將特徵強化，再把
強化後的結果進行二值化處理。最後將二值化後的影像進行區塊標記[2](component labeling)
以方便利用臉部特徵幾何分析法[3-5]，來達成判斷此人是否有配戴口罩之目的。並結合圓弧
偵測技術以達成安全帽偵測[6]。 
 
常見之恐怖份子在一些重要的場合放置爆裂物的事件，類似的事件往往造成社會上重大
的傷害，更凸顯一個具有安全維護之監視系統之重要性。而非法的歹徒則容易手持具攻擊性
的物品以造成一般民眾之生命財產的傷害。本計劃亦使用遺留物偵測與手持異物偵測技術，
以便應用在事件發生的同時發出警告訊息(on line)，或者也可應用於事發之後的視訊檢索
(content-based video retrieval ,CBVR)的延續應用(off line)。 
 
期望本計劃之成果能使現今日之監視系統不再只是監視，利用預警方式，使得警備或保
安人員能夠第一時間地提高警覺且注意到異常之部位；若真的有犯罪行為發生，也能在第一
時間內反應而真正達預防犯罪的效果。
 肆、 研究方法 
本計劃之流程圖如圖 1所示；而所謂的「可疑犯罪行為偵測」，乃依據第一年計劃之成果，
繼續完成。本計劃於第一年，利用影像中的移動偵測技術(moving tracking)，使得人的範圍能
夠從影像中切割出來，並且持續追蹤。本計劃初期完成人體模型的建立與影像中人體檢測技
術之開發。同時利用邊界與區塊的技術，來得到影像中身體的位置。 
 
由於本計劃宗旨乃預防犯罪事件發生前之「可疑犯罪行為偵測」示警，在此將此些示警
動作分為 2 類： 
 
a. 不正常之行為偵測： 
引起全球注意的恐佈攻擊事件，恐怖份子或歹徒易於在一些重要的場合放置爆裂物，
不但凸顯安全維護之監視系統之重要性，更可預知其足以造成社會上重大的傷害。故
在此亦設定「手持異物偵測」與「遺留物偵測」為可疑犯罪行為發生前之重要特徵。 
 
b. 人體遮敝物偵測： 
如同一般犯罪發生後的監視影帶中，歹徒往往將自身之外在特徵包得密不透風(戴手
套、口罩或安全帽…等)，故在此設定「安全帽偵測」與「口罩偵測」為可疑犯罪行
為發生前之重要特徵。 
 
圖 1、流程圖 
 4
 
如圖 3所示；紅框處即為移動人體。綠框處即為發現手部舉起動作。下一步即分析綠框
處附近的區域，若判定存在其它的顏色區塊，則判斷為手持異物之行為。 
 
 
 
圖 3、手持異物流程圖 
 
1.2. 遺留物偵測 
 
    首先定義何謂遺留物；從影像的角度，除了背影以外的差異即為遺留物(差分影像)，因
此利用差分影像不僅可找出移動物體，亦可找出疑似遺留物。而遺留物會保持固定之面積與
周長；不同於移動物體的面積與周長屬變動狀態。 
 
因此引用一數學參數[15]：緻密性(compactness)；其定義可代表一物件的緊密程度以及似
圓性，其數學表示式如下: 
                     Λ=
2φscompactnes                                   (9) 
其中φ為物件的周長，本實驗中為移動物體二值影像之輪廓(周長)，Λ為物件之面積，本實驗
中為移動物體之二值影像之面積。 
 
當影像中之移動物體為遺留物品時，其緻密性、面積以及周長的變化非常小，本計劃則
利用此特性來做為判斷移動物體是否為遺留物品的依據。 
 
 6
z Step 1. 
 
如圖 5所示，利用水平方向為取樣方位(即y方向)，且每條取樣方位相隔相同的區間(即d)。 
z Step 2. 
利用 Step 1.之結果，任意取其中的二個點，並合理的尋找第三點。 
 
z Step 3. 
此三點即可決定一個圓弧或圓形。並對該圓弧或圓進行投票(決定是否為候選圓弧或圓，
即 Step 4.) 
 
z Step 5. 
若該圓弧或圓的圓周數(像素)達預定的門檻值以上，即偵測出圓弧或圓。 
 
(a) (b) 
圖 5、安全帽偵測流程-像素取樣 
 
 8
 (1) 蓋伯濾波器(Gabor filter)與特徵強化 
 
在文獻中所提到的的蓋伯濾波器已被應用於許多特徵的建立，在本計劃中則利用它來建
立臉部特徵。蓋伯濾波器之特色在於蓋伯濾波器是一個利用 2D 高斯函數（Gaussain function）
為基礎所構成的濾波器，其波形為一正弦曲線。它同時具備了下列三項令人滿意的優點：  
 
 蓋伯濾波器在頻域中具有高度的選擇性，可以呈現出此物體在空間中的位置。 
 蓋伯濾波器具有搜尋物體邊界的功能。 
 蓋伯濾波器是帶通濾波器(band-pass filter)，它可以讓我們在所需要的頻帶中選取特
定的方位和中心頻率。因此，它可被設計成從影像的特定頻帶中擷取出該頻帶中的
資訊。 
 
經由這個空間域和頻域的位置雙重限制，產生了具有對抗因為影像之光源變化、平移、
旋轉與縮放的能力。 
蓋伯濾波器之核心運算數學模型如 Eq. (1)所示(第 j 個資訊)。 
( ) ( ) ( )' 'j jJ I= Ψ −∑x x x x ， 0,...,39j =                   (1) 
( , )Tx y=x 為座標向量， 為摺積運算後的影像灰階， 為輸入的影像灰階，( )jJ x ( )I x ( )jΨ x
表示蓋伯濾波器的基底函式(basis function)。蓋伯濾波器的數學模型如 Eq. (2)所示。 
( )
2 2 2 2
2 2exp( ) exp( ) exp( )2 2
j j
j ji
σ
σ σ
⎡ ⎤Ψ = − ⋅ − −⎢ ⎥⎣ ⎦
K K x
x K x          (2) 
i 表示 norm 的運算；i 表示複數運算；σ為蓋伯濾波器波形的寬度與波長之間的比率； jK 表
示每一個濾波器的特性頻率，如 Eq. (3)所示。 
　 　 
cos
sin
v u
j
v u
K
K
ϕ
ϕ
⎛ ⎞= ⎜ ⎟⎝ ⎠
K ， maxv v
KK
f
= ，
8u
uπϕ = ，                  (3) 
0,..., 7u = 表示蓋伯濾波器的八個方位（orientation）； 0,..., 4v = 表示蓋伯濾波器的頻率
（frequency）， 為最高中心頻率；f 表示空間因子(spacing factor)。在我們的方法中使用蓋
伯濾波器能量的部份來進行特徵擷取。 
maxK
 10
 (2) 區塊特徵分析 
 
在區塊特徵分析方面，我們採用文獻中所提出的臉部元件之幾何特徵來建立出我們所認
定的臉部幾何條件。此外，我們假設如果雙眼區塊同時存在的情況，而嘴部區塊卻不存在時，
我們就認定此人有配戴口罩的行為，反之則無配戴口罩。我們分為下面兩部分來說明。 
 
z 眼部區塊： 
我們可以從眼睛部份(眼部)的幾何外型來找出它的特徵，在此利用圖 8來輔助說明。圖
上A為眼睛的寬，B為眼睛的高，C為兩眼中心的距離。 
 
3.2.1. 蓋伯濾 3.2.1. 蓋伯濾波器眼睛特徵搜尋波器眼睛特徵搜尋 3.2.1.
蓋伯濾波器眼睛特徵搜尋 
A 
C
B 
 
圖 8、人眼幾何外型比 
 
因此我們定義出下面 3 個幾何條件： 
a) 滿足眼部區塊的質心必須在區塊內部。 
b) 1 .0 1 .5
A
B
≤ ≤ 。 
c) 1 .0 5.0
C
A
≤ ≤ 。 
如果區塊同時符合這 3 個條件，我們就認定它為眼睛並且計算它們之間的傾斜度及兩區
塊中心之距離，反之則排除它為眼部區塊的可能性。 
 12
 伍、 實驗 
 
1. 手持異物偵測實驗 
 
圖 10為沒有攜帶頭罩或者的安全帽的人進行分析，圖 10 (a)為背景影像，圖 10 (b)為新進影
像，圖 10 (c)為偵測區域及計算結果得知此移動物體為人並經由肢態分析我們可以找到 p
點，由圖 10 (d)偵測結果可以看出手部區域有被框線框出即為偵測到手部動作，圖 10 (e)為
輸出結果，我們可以清楚地看到物品位置被偵測出來且有手持物品訊息。 
 
 
(a)背景影像 
 
(b)新進影像 
  
(c)偵測區域並判定手部舉起 (d)分析膚色區塊 
 14
圖 10、手持異物偵測實驗 
                
  
2. 遺留物實驗 
 
圖 11為一人皮夾掉落之影像序列，利用遺留物品偵測之方法，也可以找出影像序列中之遺留
物品，經由遺留物品偵測之結果如圖 11 (k)(l)所示，紅色框線部分為遺留之物品。 
 
 
(a)frame 1 (b)frame 4 (c)frame 7 (d)frame 10 
 
(e)frame 13 (f)frame 16 (g)frame 19 (h)frame 21 
 
(i)frame 24 (j)frame 27 (k)frame 30 (l)frame 33 
圖 11、遺留物品偵測--實驗一 
 
 16
3. 安全帽偵測實驗 
 
　圖 13是實際ATM影像，圖 13 (b)為經過高通濾波器後所得之邊界點，圖 13 (c)為使用圓形
偵測結果及圖 13 (d)為安全帽偵測輸出。本實驗結果顯示，成功的實現了單張實際影像之安
全帽偵測。 
 
 
(a) (b) 
(c) (d) 
圖 13 安全帽偵測之實例：(a)原始影像；(b)物體邊界資訊；(c)圓弧資訊；(d)安
全帽偵測結果 
 
 18
 
(a) 
  
(b) (c) 
圖 16、頭部旋轉沒戴口罩(a)輸入之影像 (b)分析後 (c)輸出之訊息 
 
 
(a) 
  
(b) (c) 
圖 17、頭部低下之影像(a)輸入之影像 (b)分析後 (c)輸出之訊息 
 
 
(a) 
  
(b) (c) 
圖 18、頭部歪斜沒戴口罩(a)輸入之影像 (b)分析後 (c)輸出之訊息 
 
 20
 
4.3 實際監視攝影機所拍攝之影像 
 
在此輸入由監視攝影機所拍攝之影像來進行測試，從實驗結果中，可以證明我們的方法
能夠正確地判斷出此人是否有配戴口罩的行為(圖 21~圖 22)。 
 
 
(a) 
  
(b) (c) 
圖 21、監視器拍攝的影像(a)輸入之影像 (b)分析後 (c)輸出之訊息 
 
 
(a) 
 
(b) 
 
 
(c) 
圖 22、監視器拍攝的影像(a)輸入之影像 (b)分析後 (c)輸出之訊息 
 22
 24
  
References 
 
1 R.C. Gonzalez, R.E. Wood, ”Digital Image Processing Second Edition”, Prentice 
Hall (2002). 
2 R. Jain, R. Kasturi, B. Schunck, ”Machine Vision”, McGraw-HILL International 
Editions (1995). 
3 J. Park, J. Seo, D. An, S. Chung, ”Detection of human faces using skin color and 
eyes”, Multimedia and Expo, ICME 2000, 2000 IEEE International Conference, 
Vol.1, 30, July, pp. 133-136(2000). 
4 K.W. Wong, K.M. Lam, W.C. Siu, “An efficient algorithm for human face 
detection and facial feature extraction under different conditions”, Pattern 
Recognition, Vol.34, Issue: 10, October, pp. 1993-2004(2001). 
5 S.H. Jeng, Y.M.L. Hong, C.H Chin, Y.C. Ming, T.L. Yao, ” Facial feature 
detection using geometrical face model: an efficient approach”, Pattern 
Recognition, Vol.31, Issue:3, March, pp. 273-282(1998). 
6 Wen, C.-Y., The Safety Helmet Detection Technology and Its Application to the 
Surveillance System, Journal of Forensic Science, Vol. 49, No. 4, 2004. 
7 Goolkasian, P., “Processing Visual-Stimuli Inside and Outside the Focus 
Fattention,” Bulletin of the Psychonomic Society, Vol. 29, No. 6, 
pp.510-515(1991). 
8 Eriksen , C. W. and T. D. Murphy, “Movement of Attentional Focus Across the 
Visualfield: A Crotical Look at the Evidence,” Percept Psychophys, Vol. 42, No. 
3, pp.103-105(1987). 
 26
計畫成果自評 
 
z 開發可疑行為與人體遮敝物之視覺偵測； 
 
z 移動偵測(第一年成果)之即時性佳； 
 
z 可成功進行可疑行為偵測，包含「手持異物偵測」與「遺留物偵測」； 
 
z 可成功進行人體遮敝物偵測，包含「安全帽偵測」與「口罩偵測」； 
 
z 「手持異物偵測」可視為防範預防歹徒利用刀械武器來進行犯罪，具預警效果。 
 
z 「遺留物偵測」之演算法簡單且容易實現； 
 
z 「安全帽偵測」演算法乃改善傳統的圓弧偵測技術，可有效應用於即時監視系統； 
 
z 「口罩偵測」演算法強健性高，可適用於較暗光源或複雜紋理的口罩； 
 
z 可使傳統監視系統演變為具預警式之監視系統。 
 
