行政院國家科學委員會專題研究計畫成果報告 
 
實現以容積為基礎的骨骼肌肉系統之自動診斷, 
手術計劃擬定及手術模擬 
 
Realization of Volume Based Feature Recognition, Surgery Planning 
and Surgery Simulation for Musculoskeletal System 
 
計畫編號：NSC 94－2213－E－033－028, 95－2213－E－033－065 
 
執行期限：94 年 8 月 1 日至 96 年 7 月 31 日 
 
主持人：蔡明達   中原大學資訊工程學系  tsai@ ice.cycu.edu.tw 
共同主持人：謝銘勳 台北醫學大學附設醫院  shiemin@tmu.edu.tw 
計畫參與人員：馬敏  中原大學電子工程所博士生  
 
 
一、中文摘要 
 
容積模型術現在不僅應用於視覺化及模擬
等，也由於其線性的演算複雜度，以近似
方式處理複雜形狀，及電腦硬體的進步使
處理大量容積素也可達互動或即時速度。
本計劃之前的計劃開發了骨骼肌肉系統的
手術模擬系統，發展了辨識容積形狀特徵
(可表現病症的解剖結構) 及自動診斷的方
法，及計算手術此特徵(病變)過程所發生
的各項幾何及物理資訊，以得適切之手術
計劃。也完成力回饋功能於手術模擬系統
中，使系統能執行虛擬的力回饋觸感互
動。本計畫提出容積內剛性實體（骨頭）
的三維特徵辨識法使解剖結構不受斷層方
向也可辨識，並開發評估此特徵以選擇適
當之手術計劃的方法。也分析相同組織不
同緻密度的抵抗力係數。力回饋觸感方面
也探討因力距而彎曲或弄斷刀具，導致切
削量的改變，進而再影響到切削量及切削
抵抗力等問題。也提出表現容積內軟組織
局部變形的即時表面重建、具方向性可變
形實體與皮膚肌肉與韌帶縫合的方法，使
我們的骨骼肌肉系統手術模擬與手術計劃
評估也能完整的包含剛性骨頭與可變形軟
組織。 
 
關鍵詞：容積特徵模型術、容積模型術、
手術模擬、幾何與物理拘束、觸感互動 
 
Abstract 
 
Volume modeling has shown high potential-
ity not only in visualization and surgical 
simulations but also in the areas that have 
been applied by conventional solid models 
such as CSG or B-rep models. The reasons 
are volume models can achieve linear com-
putation complexity, solve complex geome-
try problems by approximations and obtain 
real-time or at least interactive responses be-
cause of rapid improvements of computer 
hardware. However, feature modeling that is 
well used in traditional solid modeling for 
computer aided design and manufacturing is 
still not developed in volume modeling. In 
the previous projects, we develop the surgery 
 3
統，用以訓練臨床醫生及學生更有效果。 
但是其中仍有問題:一是我們的技巧
乃是在個別的斷層片辨識二維的形狀特
徵，然後藉由這些特徵的性質，例如解剖
結構的中心位置。這些技巧僅能適用於解
剖結構與斷層片方向接近垂直時，例如脊
椎，如果角度差異大，二維斷層的形狀便
不具解剖意義。二是我們使用的力量計算
模型乃是假定刀刃所切除細微骨片所遇抵
抗力和此骨片的體積成正比，然後加算各
刀刃的各細微處的力量或刀具所遇的抵抗
力。但是骨頭的性質因緻密程度的關係，
抵抗力會因骨頭的位置等有關係。三是力
量計算模型應計算力距(torque)，因力距會
彎曲刀具容易弄斷刀具，也會導致切削量
的改變，進而再影響到切削量及切削抵抗
力(如[Ko 99])。如手握不緊時，情況更嚴
重。這種震動回路可能導致切削量變大
（chatter vibration）影響必須評估才能準確
計算切割骨頭的力量。另外由於我們重點
都在剛性實體的骨頭，但是如能加上切割
軟組織時所引起的變形之視覺化及力回饋
之功能，更具真實感。 
所以我們在本計畫第一年“容積內剛
性實體三維特徵辨識及顧慮力距因素的切
削力計算模型之研究＂以骨頭為對象，提
出容積內剛性實體（rigid solid, 主要是骨
頭）的三維特徵辨識法使斷層方向與結構
方向呈任意角度的解剖結構也可適用我們
的方法，並依此三維特徵開發評估特徵性
質以選擇適當手術計劃的方法。另外我們
也將開發方法分析相同組織不同緻密度的
抵抗力係數，及探討因力距會彎曲刀具容
易弄斷刀具，也會導致切削量的改變，進
而再影響到切削量及切削抵抗力等問題。
第二年“為模擬骨骼肌肉系統手術的容積
可變形實體的切割縫合與即時顯像之研
究＂以軟組織為對象，提出表現容積內軟
組織局部變形的即時表面重建、具方向性
可變形實體與皮膚肌肉與韌帶縫合的方
法，以完整模擬骨骼肌肉系統的手術(含剛
性實體與可變形軟組織)。 
總之本計劃以先前年度計劃所開發的
視覺虛擬實境的手術模擬系統為基礎，以
醫學容積為對象，發展容積形狀特徵(代表
或可表現病症的解剖結構)的辨識方法，並
發展自動診斷及計算手術此特徵過程所發
生的各項幾何及物理資訊，以得適切的手
術計劃。最後結合力回饋裝置發展具有力
回饋的虛擬實境手術模擬系統使系統能在
具觸感的虛擬實境環境下執行力回饋的觸
感互動。可讓臨床醫師容易地對斷層掃瞄
片所構成的容積資料，執行幾何與物理因
素都考慮的自動診斷與虛擬實境手術模
擬。由於具有虛擬實境的視覺及力回饋，
是更真實的模擬系統，用以訓練臨床醫生
及學生更有效果。 
 
  
三、研究方法 
 
第一年我們計劃“容積內剛性實體三
維特徵辨識及顧慮力距因素的切削力計算
模型之研究＂  
1. 開發容積內剛性實體的三維特徵辨識
法 
我們將以肩膀（shoulder）為例。因為
肩膀關節各項解剖結構如肩胛骨等形狀較
為自由，所以二維斷層片上的形狀難以形
成有意義的特徵，必須整體三維地解析
（resolve）這解剖結構的斷層片，一起分
析才能得有意義的形狀特徵。在本計畫中
我們以鄰近斷層片的資訊整體計算後推導
出形狀較自由的肩關節形狀特徵。 
2. 開發評估三維特徵性質以選擇適當之
手術計劃的方法 
評估所得三維特徵特性(如厚、寬、
高、特徵間距離角度等)的方法，將這些特
徵比對至的各項病變，藉以得到病變的各
種特性。以該病症如果正常時其應有之值
做比較，推論可能之術式及對應的手術步
 5
得之樣點套上線性轉換 Affine transforma-
tion，以得非整列容積之表面重建，在此計
劃中我們得知，如果被轉換的樣點，彼此
位相(topology)關係不變的話，可得良好的
結果。由於彈性變形甚至切開實體之容積
性變形彼此之位相關係應該不變，所以可
嘗試開發轉換公式於受壓擠之容積或樣點
上。由於 MC 演算法在一開始即已經完全
建構好三角模型以重建表面，僅部分受彈
力的點的位移計算，則應僅消耗極少數時
間，而得即時的計算，以達和力回饋一致
的視覺感覺。因此在本計畫中我們也嘗試
用線性轉換 Affine transformation，以得變
形後的樣點位置以即時重建表面和顯像。 
2. 容積內具方向性可變形實體的精確表
現 
容積內具方向性的可變形實體的幾何
表現軟組織有脂肪、肌肉、韌帶、血管、
神經幹及管等，其中有些在 2 維的斷層資
料上就很容易表現出方向性如血管、神經
幹及管，但是有一些乃是斷層片上無法辨
別其方向性，如肌肉、韌帶，而有一些是
不具方向性，如脂肪。由於肌肉、韌帶在
骨骼肌肉系統中的比例高，雖然在功能
上，尤其在手術計畫上往往並不是重點，
但是在整個系統所表現的真實度上，如能
確切的表現則很有意義，由於在二維斷層
片上，無肌肉的方向性可擷取，我們只能
利用相鄰及相關的結構(如關節)來推斷它
的形狀及方向性。如肌肉往往是鐘紡形，
而其端點連結於兩關節上。有關軟組織變
形力的研究雖然不少，如摘除器官時的力
阻抗模型與縫合血管時的抵抗力[O’Toole 
99]，但沒有像我們這次所需的具方向性軟
組織的切削力模型。解剖結構的方向性尋
找出來後，即可賦予變形或者切割後位能
突然消失後的變形力等，在本計畫中我們
探討這方面的模型及其參數。我們嘗試賦
予這些具方向的組織不同方向不同的彈性
係數，撕裂時的力阻抗係數以得其彈性力
模型及切割力模型。重建表面以達即時顯
像方法則可套上一項的結果。 
3. 容積內皮膚肌肉與韌帶縫合的表現 
皮膚肌肉與韌帶縫合於手術中也是一
個重要的步驟。雖然這步驟不會影響骨骼
的功能，但對於一個手術模擬系統而言也
是重要的，因為它可提供訓練一個實習醫
師及學生一個良好的系統，尤其是一個具
有力回饋的模擬系統。在[O’Toole 99]提出
了血管縫合，說明類似此系統可提供良好
的訓練，但有關骨骼肌肉系統手術模擬所
需要的皮膚、肌肉與韌帶的縫合，則尚未
具有類似報告。由於皮膚、肌肉與韌帶與
血管的抗尖銳縫針的彈塑性雖有一樣是有
所不同[Frank 01]，在本計畫中我們將探討
以提出這些軟組織個別縫合的力阻抗模型
與模型參數以及即時視覺顯像。使我們的
手術模擬系統能夠模擬皮膚、肌肉與韌帶
的縫合。 
4. 以力回饋裝置與實際切割縫合來驗證
修改並配合台北醫學大學的實際臨床
例測試以上各項軟組織切割縫合模型 
我們用 PHANToM 力回饋裝置，來產
生電腦的虛擬觸感，並與實際切割縫合感
覺是否一致來驗證是否正確。計劃共同主
持人所領導的臨床醫生以實際臨床例，施
以手術模擬以測試以上各項軟組織切割縫
合模型與參數是否合宜。 
 
 
四、結果與討論 
 
研究內容與原計畫相符。本計畫研究
成果可應用於骨科臨床，應用價值可期
待。已提出申請的專利(分別申請美國與台
灣)如附件。已接受期刊有附件一、二、三
([Hsieh 06][Tsai 07] [Tsai 08])。會議論文有
([Tsai 05a] [Tsai 06] [Tsai 06a])。 
 
 
五、參考文獻 
 7
Surgery Planning”, IEEE Engineering in 
Medicine and Biology, 1996, pp. 60-64. 
[Treacy 91] Treacy, P., Ochs, J.B., Ozsoy, 
T.M. and Wang, N. 1991, “Automated 
Tolerance Analysis for Mechanical As-
semblies Modeled with Geometric Fea-
tures and Rational Data Structures”, 
Computer Aided Design, Vol. 23, No. 6, 
pp.444-453. 
[Tsai 01] Tasi, M.D., Hsieh, M.S.and Jou, 
S.B., 2001, “ Virtual Reality Orthopedic 
Surgery Simulator”, Computers in Biol-
ogy and Medicine, Vol.31, No.5, 
pp.333-351.  
[Tsai 02] Tsai, M.D., Chang, W.C., Hsieh, 
M.S., 2002, Three-dimensional Land-
marking Based Maxillomandibular De-
formity Diagnosis Using 
Three-dimensional Computer Tomogra-
phy, Journal of Medical and Biological 
Engineering, Vol.22, No.3, pp.129-138. 
[Tsai 02a] Tsai, M.D., Jou S.B. and Hsieh, 
M.S., 2002, “Three-Dimensional Geo-
metric Constraint Evaluation and Analy-
sis for Determining Commercial Knee 
Prosthesis”, Journal of Medical and Bio-
logical Engineering, Vol.22, No.3, 
pp.139-145. 
[Tsai 02b] Tsai, M.D., Jou S.B. and Hsieh, 
M.S., 2002, “A New Method for Lumbar 
Herniated Inter-Vertebral Disc Diagnosis 
based on Image Analysis of Transverse 
Sections”, Computerized Medical Imag-
ing and Graphics,Vol.26, No.6, 
pp.369-380. 
[Tsai 03] Tsai, M.D., Yeh, Y.D. and Hsieh, 
M.S., 2003, “Feature Recognition and 
Evaluation of Volumetric Solid Using 
Boundary Pointers”, ChungYuan Journal, 
Vol. 31, No.3, pp.251-261. 
[Tsai 04] Tsai, M.D., Yeh, Y.D., Hsieh, M.S. 
and Tsai, C.H., 2004, Automatic Spinal 
Disease Diagnoses Assisted by 3D Un-
aligned Transverse CT Slices, Computer-
ized Medical Imaging and Graphics, 
Vol.28, No.6, pp307-319.  
[Tsai 05] Tasi, M.D., and Hsieh, M.S., 2005, 
“Volume manipulations for simulating 
bone and joint surgery”, IEEE Transac-
tion on Information Technology in Bio-
medicine, Vol.9, No. 1, 139-149.  
[Tsai 05a] Tasi, M.D., Ma M. and Yeh,Y.D., 
2005, “An Image Analysis Method for 
Gleno-humeral Joint Morphology Using 
CT Transverse Sections to Automate Di-
agnoses and Surgery Managements”, 
Proc. of 18th CVGIP (Computer Vision, 
Graphics and Image processing) 
pp.369-380. 
[Tsai 06] Tsai, M.D., Chung, C.C. and Hsieh, 
M.S., 2006, “An Amputation Simulator 
with Bone Sawing Haptic Interaction”, 
Computer Graphics Workshop. 
[Tsai 06a] Tasi, M.D., Chung, C.C., Hsieh, 
M.S., Chen C.H., and Yeh, Y.D., 006, 
“Bone Drilling Haptic Interaction for 
Orthopedic Surgical Simulator”, Proc. of 
19th CVGIP (Computer Vision, Graphics 
and Image processing) pp.369-380. 
 [Tsai 07] Tasi, M.D., Hsieh, M.S. and Tsai, 
C.H., 2007, “Bone Drilling Haptic Inter-
action for Orthopedic Surgical Simula-
tor”, Computers in Biology and Medicine, 
Vol.37, No.12, pp.1709-1718.  
[Tsai 08] Tasi, M.D., Yeh,Y.D. Hsieh, 
M.S.and Ma M., 2008, “Glenoid and 
Humerus Bone Analysis Using CT Trans-
verse Sections to Automate 
Gleno-humeral Joint Diagnoses and Sur-
gery Managements”, Computerized 
Medical Imaging and Graphics, 
page-proofed and will appear in 2008. 
 
 
可供推廣之研發成果資料表(二) 
申請專利中   (中華民國)                                     日期：95 年 12 月 24 日 
國科會補助計畫 
計畫名稱：實現以容積為基礎的骨骼肌肉系統之自動診斷, 手術計
劃擬定及手術模擬 
計畫主持人：蔡明達         
計畫編號：NSC 95-2213-E-033-065 學門領域：圖形識別 
技術/創作名稱 提供觸感之骨鋸手術模擬方法  
發明人/創作人 蔡明達  謝銘勳 
中文：一種觸感檢知方法及系統。首先，取得一觸感裝置
之一維度資訊。依據觸感裝置之維度資訊計算一鋸子之一
位置、一姿態與一速度。依據鋸子之位置、姿態與速度計
算鋸子相對應一預設骨頭之一接觸抗力。之後，將接觸抗
力回饋至觸感裝置，以致使觸感裝置依據接觸抗力進行力
量回應。 
技術說明 英文： Haptic detection and response methods and systems are 
provided. First, dimensional information comprising position and 
attitude of a haptic device is obtained. A position, an attitude, and a 
speed of a saw are calculated according to the dimensional information 
of the haptic device. A touch resistance of the saw sawing a predefined 
bone is calculated according to the position, the attitude, and the speed 
of the saw. Thereafter, the touch resistance is fed back to the haptic 
device to render force responses accordingly. 
可利用之產業 
及 
可開發之產品 
自動醫療診斷軟體 
技術特點 可辨識肩膀關節各部分的幾何特徵，診斷病變，進而規劃手術計劃
推廣及運用的價值 
可結合於三維模型重建系統， 或結合於三維手術模擬系統 
※ 1.每項研發成果請填寫一式二份，一份隨成果報告送繳本會，一份送 貴單位
研發成果推廣單位（如技術移轉中心）。 
※ 2.本項研發成果若尚未申請專利，請勿揭露可申請專利之主要內容。 
※ 3.本表若不敷使用，請自行影印使用。 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
   附件  一 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
230
BIOMEDICAL ENGINEERING-
APPLICATIONS, BASIS & COMMUNICATIONS
17
current primary training method [17]. However,
training of sawing on a virtual patient with complex
bone geometric changes as sawing on real human is
required [18]. Therefore, a computer simulator for the
amputation surgery is expected to demonstrate all
geometric changes and provide haptic bone sawing
feeling. 
This paper introduces a computer system for
amputation surgery that adds the sawing haptic
functions on our reported orthopedic simulator [19].
This simulator manipulate volume data (constituted
from parallel tomographic, such as CT or MRI slice) to
recognize new separate bones carved out from saw-
swept surfaces and then to delete, reposition and fuse
separate bones. These haptic functions represent force
responses when using a saw to touch or saw a bone.
The system uses a haptic device with 6D (three
positions and three angles) input data to simulate the
saw position and attitude and to calculate whether the
saw touches or immerses into any bone. The (volume
manipulated) geometric information about bone
touching and immersing is then used to calculate the
touch resistance and the sawing force for 3D-rendering
the haptic device (letting the device generate 3 forces
along the three primary axes of the haptic device). The
effectiveness of the simulator was evaluated by
simulating an amputation surgery from CT transverse
sections of a knee amputation patient.
2. SUBJECT AND METHODS
2.1 System Structure 
Figure 1 shows the system architecture. A haptic
device with 6D input and 3D output abilities is
attached to the system to provide the tactile
environment. The input 6D information of the haptic
device together with the saw data are used to calculate
the saw position, attitude and speed as described in
Section 2.2. The saw position, attitude and speed data
together with the patient volume data are used to
compute the saw touch resistance (described in Section
2.3) and cutting forces (described in Section 2.4). The
touch resistance is used to prevent the saw penetration
into bones when it is not in sawing (oscillating).
The patient volume is converted as the data
structure that the prototype system can manipulate
[19]. The isosurfaces for any specific tissue or
structure is generated using the marching cubes
algorithm [20]. The triangulated isosurfaces and the
dynamic saw are then rendered through the OpenGL
libraries. When changing the perspective, the
isosurface reconstruction is not required, thus real-time
re-rendering can be achieved. Currently, the
simulations for orthopedic procedures such as
osteotomy, ostectomy, and bone reposition and fusion
can achieve interactive responses because isosurface
reconstruction is involved.  Therefore, the patient
volume is not refreshed during the sawing process to
achieve real-time re-rendering for the saw oscillation
and the new position. The isosurface reconstruction for
the sawing process is implemented after the sawed
bone is judged to separate to remove.
Currently, the system is implemented on a dual
CPU P-IV 3.0G with the graphics card of
QUADRO4_980_XGL (by NVIDIA Inc.) to achieve
the real-time haptic rendering (over 1000 HZ) and the
saw rendering (over 30HZ). The system uses the
Phantom Desktop haptic device (by Sensable Inc.) that
can provide 3D positional forces and 6D positional
sensing more than 1100 dpi resolution. Therefore,
real-time visual and smooth haptic responses for the
amputation surgery can be achieved with our prototype
system.
2.2 Saw Position, Attitude and Speed
Computation
The pen-like haptic device attached with a saw (as
illustrated in Fig. 2(A)) is used to simulate a real saw
attached hand-piece (Fig. 2(B)). The saw attitude, the
q-axis of the saw coordinate system is set as
perpendicular to the haptic device attitude, the x-axis
of the haptic device coordinate system. Therefore, the
q-axis coincides to the z-axis of the haptic device
coordinate system as illustrated in Fig. 2(C). The s-axis
and t-axis are the other two saw primary axes, parallel
to the x-axis and y-axis of the haptic device coordinate
system, respectively. The saw oscillates about the t-
axis (the qs-plane). The haptic device primary axes, the
x-axis, y-axis and z-axis are three directions the
calculated touch resistance and sawing force act along.
The difference of the two vectors q and q (the
attitude of the previous instant) becomes the rotation of
the device attitude and the difference of the deviceFig. 1.  System architecture.
232
BIOMEDICAL ENGINEERING-
APPLICATIONS, BASIS & COMMUNICATIONS
19
2.3 Touch Resistance Computation
To prevent bone penetration from a still (non-
oscillating) saw, we also use the immersed information
to calculate the force to prevent the penetration in
haptic responses. The computation first transforms the
device coordinates of the sample points (as the dot
points in Fig. 3) on the saw surfaces into the volume
coordinate as described in the above subsection. These
sample points are in one voxel interval. Whether every
sample point is inside a bone voxel is check. If it is,
that means the saw has immersed (already touched)
into the bone at this point. The resistance is than
proportional to the number of the immersed points
(inside the bone voxel). The direction of the touch
resistance herein is set as the reverse of the saw
movement direction to oppose against the saw moving
into the bone and pushes back the saw to the bone
surface. 
2.4 Sawing Force Computation
This system calculates the load on the saw teeth to
obtain the sawing force as the method described in the
machining theorem [21-23]. In our model, every saw
tooth is judged as cutting the bone if inside any bone
voxel (as A illustrated in Fig. 4). That means the
position of every tooth is transformed into the volume
coordinate to check if in any bone voxel. If it is, this
tooth is in sawing. The system then calculates the load
for removing the bone chip on the tooth to sum up the
sawing force. 
For example, the area Ai of the i-th tooth
(represented by the point at the tooth tip as T in Fig. 4)
is calculated as w p f/u.  is 1 if this tooth is
inside a bone voxel (i.e., in sawing), otherwise it is 0.
w is the width of tooth blade. p, the tooth pitch, is the
distance between any two teeth and can be considered
constant. u is the frequency of the of the saw
oscillation. The load acting on the i-th tooth can be
represented as three following components as
illustrated in Fig. 4,
Fnormal, the normal cutting force acts along the
sawing direction. Fradial, the radial force is radial to the
tooth face. Flateral, The lateral force acts along the
oscillating direction. Fx, Fy and Fz are the forces
rendered to the x-, y- and z- axes (as illustrated in Fig. 
2(C)) of the haptic device. Fy is equal to          , 
meaning summated from Fradial of all the teeth. In
actual, the neighboring saw teeth are designed as
facing opposite sides (as illustrated in Fig. 4) to cancel
the radial forces generated from the neighboring teeth.
However, Fx and Fy are determined from Fnormal and
Flateral of all the teeth using the following equations.
i, representing the angle of the i-th tooth
regarding to the t-axis, is determined by the method
described in Subsection 2.2. Because the saw oscillates
about the t-axis, i changes and then Fx and Fz. are
cyclic according to the oscillation frequency.
Meanwhile, because the angles of the saw teeth are
small, Fz, the force against the saw feeding, is
composed most of the normal forces and part of lateral
forces acting the saw teeth. Similarly, Fx, the force
against the oscillation, is composed most of the lateral
forces and part of normal forces. Fy, the force pushing
the saw sideways, is composed from the radial forces
ii AKF laterallateral  Ǵ
ii AKF radialradial  Ǵ
ii AKF normalnormal   
Fig. 4.  Sawing force computation.
¦
i
iFradial
Fig. 3.  Touch resistance computation.
)sin(cos lateralnormal¦  FFF iiz TT .
¦  )cos(sin normallateral FFF iix TT .
234
BIOMEDICAL ENGINEERING-
APPLICATIONS, BASIS & COMMUNICATIONS
21
saw teeth, is small during the whole cut because most
of the radial forces generated from the neighboring
teeth cancel to each other. Because the feed rate is kept
nearly the same, the remained radial force from one
and sometimes two teeth has nearly the same value as
shown in Fig. 6(C).
4. DISCUSSION
The sawing resistances in orthopedic surgery
usually violently oscillate to let the surgeon difficultly
feed the saw and grasp the hand-piece, thus bring
unstable sawing interface to lead bad healing. In this
study, we have added haptic functions to precisely
simulate the sawing process to our orthopedic surgical
simulator so that not only geometric changes but also
tactile bone sawing feeling can be provided for the
amputation surgery simulations. The combination of
the sawing haptic functions into our geometric surgery
simulator that has been developed for visual
verification, diagnoses and surgical planning provides
a use of training interns and students with both tactile
and visual interaction. 
The proposed sawing force mode, modified from
the metal sawing theorem, calculates the normal,
lateral and radial forces on every tooth and then sums
up these forces into the 3 positional forces for
rendering the haptic device. Although the simulated
forces provide the tactile feeling that resembles the real
sawing, the force coefficients in our models are
simplified to neglect the effects of the saw rake angle,
point angle, helix angle, cutting velocity and feed rate.
To achieve higher predicted accuracy, these
coefficients should be studied to vary according to
given specification (including age, sex, race and so
forth) under statistically meaningful number of cases. 
Other procedures in the amputation surgery such
as soft tissue incision and suture should be realized
into the haptic interaction simulator. Some suturing
simulator provides haptic interaction but no geometric
changes or deformations during surgery [24]. Our
future work focuses on implementing these incision
and suture procedures with both haptic and geometric
responses. Therefore, the combination of the sawing
haptic functions into our geometric surgery simulator
provides successful simulations with both tactile and
visual interaction.
5. CONCLUSION
Surgical simulation system allows surgeons to
experience surgical procedures and haptic interfaces,
thus to enable perception and delicate tactile sensations
required in surgery. Therefore, combination of the
sawing haptic functions into the orthopedic surgical
simulator for training amputation surgery is important
and has not yet developed until now. The proposed
system manipulates the volume data of any specific
patient to simulate the changes of bone geometry
during amputation surgery and then uses the force
computation models to simulate the haptic responses in
Fig. 6. Sawing forces from the saw entering and
leaving the cortical bone.
(A) Force along the z-axis (saw attitude or normal
direction) of the haptic device.
(B) Force along the x-axis (device attitude or
oscillating direction) of the haptic device.
(C) Force along the y-axis (radial direction) of the
haptic device.
236
BIOMEDICAL ENGINEERING-
APPLICATIONS, BASIS & COMMUNICATIONS
23
ACM SIGGraph Computer Graphics, Addision
Wesley press, 1987; 163-169.
21. Ko TJ and Kim HS: Mechanistic cutting force
model in band sawing. International Journal of
Machine Tools & Manufacture 1999; 39: 1185-
1197.
22. Henderer WE, Boor JD, Holston JR: Estimation of
cutting forces in band sawing metals. Trans of
NAMRC 1996; 24: 33-38.
23. Chandrasekaran H, Thoors H, Hellbergh H and
Johansson L: Tooth chipping during band sawing
of steel, Annals of the CIRP 1992; 41: 107-111.
24. O Toole RV, Playter RR, Krummel TM, Blank
WC, Cornelius NH, Roberts WR, Bell WJ, Raibert
W: Measuring and developing suturing technique
with a virtual reality surgical simulator, J Am Coll
Surg 1999; 189(1): 114-127.
Computers in Biology and Medicine 37 (2007) 1709–1718
www.intl.elsevierhealth.com/journals/cobm
Bone drilling haptic interaction for orthopedic surgical simulator
Ming-Dar Tsaia, Ming-Shium Hsiehb,∗, Chiung-Hsin Tsaic
aInstitute of Information and Computer Engineering, Chung Yuan Christian University, Chung Li 32023, Taiwan, ROC
bDepartment of Orthopaedics and Traumatology, Taipei Medical University Hospital, Taipei Medical University, 252, Wu Hsing Street,
11031 Taipei, Taiwan, ROC
cDepartment of Mechanical Engineering, Lunghwa University of Science and Technology, 300 Wan-shou Rd., Sec.1, Kueishan Taoyuan, Taiwan, ROC
Received 23 January 2006; received in revised form 8 March 2007; accepted 11 April 2007
Abstract
Drilling procedure is widely used in orthopedic surgery to position reduced fractured bones and prosthetic components. However, successful
execution of bone drilling requires a high level of dexterity and experience, because the drilling resistance is large and sometimes vibrates
violently to difﬁcultly grasp the hand-piece or even break the slender drill. This paper introduces haptic functions that are added to a volume
based surgical simulator to simulate the drilling process. These haptic functions compute drilling forces and torques based on reliable metal
removing theorem. Therefore, accurate prediction for the drilling process can be obtained to provide effective surgery training and rehearsal.
A simulation example of screw and plate surgery for positioning the hip trochanter fracture illustrates the practicality and versatility of the
proposed method.
 2007 Elsevier Ltd. All rights reserved.
Keywords: Drilling force and torque computation; Screw and plate surgery; 3D image reconstruction and surgical simulation
1. Introduction
Screw and plate modalities play an important role in a lot
of surgical procedures such as positioning reduced fractured
bones and prosthetic components [1–4]. Producing a correct
hole for the ﬁxation is primarily governed by the drilling pro-
cess. However, the drilling operations are blind in nature with
unknown hole depth and required surgeons’ skill. In addition,
bone drilling resistance is large and vibrates to difﬁcultly grasp
the hand-piece or even to break the slender drill [5–8]. Mea-
suring drilling force or torque changes to control the feed is a
novel method that can reduce abruptly increased drilling forces
and torques to avoid dangers and thus produces correct drilled
holes [9]. Automatic drilling such as using robot based on
the measurements provides high-quality drilling [10]. However,
∗ Corresponding author. Tel.: +886 2 2737 2181 3118;
fax: +886 2 2737 5618.
E-mail addresses: tsai@ice.cycu.edu.tw (M.-D. Tsai),
shiemin@tmu.edu.tw (M.-S. Hsieh), chtsai@mail.me.lhu.edu.tw (C.-H. Tsai).
0010-4825/$ - see front matter  2007 Elsevier Ltd. All rights reserved.
doi:10.1016/j.compbiomed.2007.04.006
manual drilling is a cheap, fast and feasible method and thus
has been widely used.
Successful execution of manual drilling requires a high level
of dexterity and experience, [11–13]. Drilling on synthetic
bones or real bones (obtained from sectioned frozen bones)
is the current primary training method. However, the former
provides limited reality and the latter associates the risks of
transmitting diseases. Moreover, drilling on a patient involved
with complex bone geometry is required to train or rehearse.
Therefore, a computer simulator for the screw and plate modal-
ity is expected not only to demonstrate all geometric changes
in the surgical procedures but also to provide a haptic bone
drilling feeling. Such a simulator can realistically mimic a
patient-speciﬁc operating environment and therefore signiﬁ-
cantly contributes to the improvement of surgical rehearsing
and training.
Over the past year, many researchers have developed 3D
graphics techniques to provide surgical simulations for various
patient data that may be video data (for simulating endoscopic
or laparoscopic surgery [14]), or X-ray projections (for bone
surgery [15]), or transversal tomographic slices (i.e., volume
M.-D. Tsai et al. / Computers in Biology and Medicine 37 (2007) 1709–1718 1711
osteotome edge from two tool positions and angles determines
an edge swept surface that is used to simulate bone cutting. If
one or more swept surfaces form a closed surface inside a bone,
seed ﬁlling changes the closed voxels as a new bone or null
to simulate a bone separation or removal [19]. Conversely, the
seed in a bone structure can be used to ﬁll voxels until reaching
the boundary of another bone to simulate a postoperative bone
fusion and regeneration. A bone reposition writes the contents
of all solid voxels into the ones in new positions. A Boolean
operation between a bone with a solid simulates a subtraction
between a bone with a drill or an insertion (addition) of a pros-
thetic component or a bone graft into a bone [19]. The drill solid
is determined by the position, angle and size of the chosen drill.
These 6D inputs of successive haptic intervals are used to
calculate linear and rotational drill speeds. The force computa-
tion process then uses the drill position and speed to compute
the touch resistance or the drilling force and torque. The touch
resistance and drilling force are used for haptic rendering. Dur-
ing the drilling process simulation, the geometric changes of
bones are not computed (i.e., no isosurface reconstruction) un-
til the process is ﬁnished. Therefore, the real-time visual re-
fresh requirement (30 Hz) can be achieved for rendering bones
and the drill at the new drill position. Meanwhile, the system
summates the forces from sample points on a drill to calculate
the touch resistance or the drilling force and torque. Therefore,
the sample point interval determines the computation accuracy
and speed. The small interval leads high accuracy but lower
the speed. Therefore, the interval is set as achieving the highest
accuracy but can satisfy the requirement of 1000 Hz haptic re-
sponses even under the largest bone applied drill. Under such
haptic responses, every revolution in general rotation numbers
(500–1500 rpm) can traverse 40–120 haptic intervals that are
enough to represent the cyclic drilling forces and torques.
3. Tool position and speed computation
The pen-like haptic device attached with a drill (as shown
Fig. 2(A)) is used to simulate a real drill attached hand-piece
Fig. 2. Position and angle calculation for the virtual drill: (A) Haptic device for simulating a drill attached hand-piece; (B) A real drill attached hand-piece and
(C) Drill position and angle determination using 6D data of haptic origin. P , C, O: origins of haptic device, drill coordinate system and volume coordinate
system.
(as illustrated in Fig. 2(B)). The drill axis is set as the q-axis of
the drill coordinate system. The q-axis also matches the haptic
pen direction, the z-axis of the haptic device coordinate system
as illustrated in Fig. 2(C). The s-axis and t-axis are the other
two primary axes of the drill coordinate system, meaning that
the st-plane is parallel to the xy-plane and rotates as the drill
rotates. The difference of the two vectors q and q ′ (the drill axis
of the previous instant) becomes the rotation of the drill axis
and the difference of the device positions P and P ′ becomes
the drill translation. The rotation and translation dividing the
haptic sample frequency determine the linear v and rotational 
velocities at P. The component of v along the drill axis direction
(or q-axis) is deﬁned as the feed speed, fq. The position and
the velocities at P are then used to calculate the position and
the linear velocity at every point of the drill. For example, the
velocity at the drill origin C is equal to v −× l. l denotes the
length from C to P.
The above haptic device coordinate (in real size) can be
transformed into the volume coordinate (in voxel size) through
the following concatenating transformations:
[
X
Y
Z
]
= SXZSY T R
[
x
y
z
]
.
The scaling SXZ corresponds to the inverse of the pixel width
in the slices and is uniform for all tomographic slices that con-
stitute the volume. The pixel width is obtained from FOV (ﬁeld
of view) dividing the voxel number in the slice wide. The scal-
ing SY equals the inverse of the slice thickness. The transla-
tion T means the distance from the haptic device origin to the
volume coordinate system origin. The rotation R corresponds
to the angle between the volume and the haptic device coordi-
nate systems and is constituted by three primary haptic device
(x-, y- and z-axes) axes represented in the volume coordinate.
Similarly, the volume coordinate can be transformed into the
haptic device coordinate through the inversions of the above
transformations.
M.-D. Tsai et al. / Computers in Biology and Medicine 37 (2007) 1709–1718 1713
 is 1 if this element is inside a bone voxel (i.e., in drilling), oth-
erwise it is 0. The above load components are then transformed
and summated into the forces in tangential, trust (i.e., axial)
and radial directions (Fig. 4). Therefore, the tangential (Ftang),
trust (Ftrust) and radial (Fradius) forces contributed by the cut-
ting lip elements can be calculated by the following equations:
Ftang =
∑
i,j
(FHi,j ),
Ftrust =
∑
i,j
⎛
⎜⎝cos(i,j ) · FTi,j +
√
(r2i,j − b2)
ri,j
sin(i,j ) · FVi,j
⎞
⎟⎠ ,
Fradius =
∑
i,j
⎛
⎜⎝
√
(r2i,j − b2)
ri,j
sin(i,j ) · FTi,j − cos(i,j ) · FVi,j
⎞
⎟⎠ .
The area of a chisel edge element (as B in Fig. 4) is calculated
as dw × f . Because the radius of the chisel edge element to
the drill axis is small, the effect of the feed rate change caused
by the drill rotation is small to be neglected. Therefore, f is
herein set as f q/pps. Then, the trust force on this element is
calculated as FCj = KC · dw · f . j denotes the jth divided
surface element.  is 1 if this element is inside a bone voxel,
otherwise it is 0. By summing up the trust forces of all chisel
edge elements, the trust force contributed by the chisel edge is
calculated as Ftrust =∑j (FCj ).
Fx , Fy and Fz are the forces rendered to the x-, y- and z-
directions, the three primary axes (as illustrated in Fig. 3) of
the haptic device, and therefore are the ones the user feels.
Fz is equal to Ftrust because the trust force acts along the q-
axis of the drill, i.e., the z-axis of the haptic device. Fx and
Fy are determined from Ftang and Fradius using the following
equations:
Fx = cos Fradius − sin Ftang,
Fy = sin Fradius + cos Ftang.
 represents the angle of the st-plane regarding the xy-plane.
Because the st-plane (the drill) rotates, this changing  brings
the cyclic Fx and Fy . Meanwhile, the force coefﬁcients KC ,
KH , KV and KT actually depend on many variables such as the
drill rake angle, point angle, helix angle, cutting velocity and
feed rate, the bone density, and the radius from the drill axis
to the element etc. Herein, KH , KV and KT are set as linear
functions of the radius from the surface element to the q-axis.
Other variables regarding the drill geometry, bone types (can-
cellous or cortical) are determined empirically corresponding
to the types of drills and bones.
5.2. Drilling torque computation
Ftang and Fradius from the cutting lip elements generate the
torques Ttang and Tradius, simultaneously. Ttang works against
the drill rotation and thus lets the hand-piece do the work for
the drilling. Tradius bends the drill and thus brings a danger of
drill breakage. Ttang and Tradius are calculated by the following
equations:
Ttang =
∑
i,j
(ri,j · FHi,j ),
Tradius =
∑
i,j
⎛
⎜⎝li,j ·
⎛
⎜⎝
√
(r2i,j − b2)
ri,j
sin(i,j ) · FTi,j
− cos(i,j ) · FVi,j
⎞
⎟⎠
⎞
⎟⎠ .
li,j denotes the distance from each element to the haptic point
(the rotational center for this bending). Ftrust from the cutting
lip elements also generates the torque Ttrust to let the machine
oscillate around the q-axis. Ttrust from the chisel edge can be
neglected because of the small radius from the chisel edge to
the q-axis. Therefore, Ttrust is calculated as
Ttrust =
∑
i,j
⎛
⎜⎝ri,j ·
⎛
⎜⎝ cos(i,j ) · FTi,j
+
√
(r2i,j − b2)
ri,j
sin(i,j ) · FVi,j
⎞
⎟⎠
⎞
⎟⎠ .
The PHANToM Desktop used in this system cannot output
torques. However, the system represents Ttrust as a cyclic force
adding to Ftrust that acts along the q-axis, because Ttrust gives
the user a feeling of oscillating around the q-axis. Meanwhile,
Fradius is proportional to Tradius (in a ratio of li,j ) and thus gives
the user a similar sense as Tradius. Moreover, the user may make
no sense about Ttang because it works against the drill rotation.
Therefore, the system does not represent Ttang and Tradius.
5.3. Resistance against drilling sideways
The feed speed fq is the component of the drill velocity v
along the feeding direction (as the q-axis shown in Fig. 4).
However, the velocity component perpendicular to the q-axis
(i.e., on the st-plane) brings a resistance to prevent the drill
moving sideways (inclining to any direction on the st-plane)
and thus to lead the drill moving along the q-axis direction. The
system calculates this resistance as the following procedures.
First, sample points (spaced in one voxel interval) on the drill
surface except on the chisel edge and cutting lips are checked
for any bone voxel inside. If a point (as E in Fig. 4) is in a bone
voxel and the dot product of the surface normal at this point
with fs (the velocity component on the st-plane) is positive,
a force proportional to the dot product occurs at this point.
Therefore, the resistance that prevents the drill to move side-
ways is summated from the forces acting on the sample points.
6. Case study
Any series of CT slices following the DICOM (Digital Imag-
ing and Communications in Medicine) protocol can be the
M.-D. Tsai et al. / Computers in Biology and Medicine 37 (2007) 1709–1718 1715
Fig. 5. Surgical simulations with haptic environment. (A) 3D reconstruction of bone surface before surgery. Frontal view. Solid arrow: fractured and
angle-deviated right femur neck. Hollow arrow: protruded-out lesser trochanter. (B) 3D reconstruction of bone surface after correcting the trochanter fracture.
Frontal view. Through each icon, one dialog interface can be opened. The red ellipse shows the chosen drill in the interface dialog. (C) The drill (light blue)
has touched the bone with a resistance against the drill moving into the bone. Oblique view. (D) The drill (light red) is drilling the bone with cyclic forces
and torques against the drilling. (E) Drilled hole has been shown. Oblique view. (F) All four drilled holes have been shown. Oblique view. Screws (red and
blue) and plate (yellow): ﬁxing the repositioned stem and neck. Oblique view.
Drilling theorems have been developed in machining ﬁeld for
many years and obtain conﬁdences in their force computation
models. Bone drilling resembles the metal drilling, therefore
we adopted their models that calculate and then sum up the
loads on divided surface elements on the cutting lips and chisel
edge to obtain the tangential torque, and the trust, tangential
M.-D. Tsai et al. / Computers in Biology and Medicine 37 (2007) 1709–1718 1717
surfaces. The sample point interval herein is set as one voxel
width to ensure no bone voxels are in-between any two sam-
ple points. Moreover, because the drill is usually moved under
10 cm/s (0.1 mm per haptic interval) in the non-drilling state,
the haptic interval is much smaller than the sample point in-
terval to give the user a real-time touch response when the
drill begins immersing bone voxels. However, the sample point
method leads to an aliasing problem, meaning that the num-
ber of immersed sample points may increase several immersed
points at one time. Thus, the resulting touch resistance may not
change smoothly. The resistance is not large, therefore will not
give so uncomfortable haptic feeling.
Although a set of CT or MRI slices as the hip example pro-
vides voxels in 1 mm resolution level, the use of distance-level
(256 levels in a voxel) determines the triangulated isosurface
vertices in a sub-voxel level accuracy and provides ﬁne 3D
images by rendering the triangulated isosurfaces. Different hu-
man parts that are smaller than the hip possess smaller FOV
(representing the size of each slice); therefore, ﬁner resolution
and then better 3D images can be expected. However, ﬁner res-
olution lowers accuracy of the force and torque computation.
Currently, the sample point interval for calculating the drilling
forces and torques is set as a constant of 0.1 mm to achieve the
haptic real-time. The sample point resolution equals 10 times
the voxel resolution in the hip case. The same sample point
resolution for a case with smaller FOV results in fewer sample
points inside a voxel; thus, the resulting accuracy for drilling
forces and torque computation becomes lower.
Meanwhile, the haptic interactions about the drilling force
are usually felt stable. The reasons can be considered as follows.
First, the haptic sample frequency (1000 Hz) by the PHAN-
ToM Desktop is far above the drill rotation frequency (about
1000 rpm) to not violate the Nyquist criteria and thus correctly
simulate the rotation of the drilling force. The exerting force
and the workspace ranges of the PHANToM Desktop are af-
fordable for interactions between the user and the haptic inter-
face. Second, the force computation can be real-time to provide
stable simulations because our system just checks if sample
points on the drill immersing into bone voxels rather uses time-
consuming object intersection and penetrated depth computa-
tion to calculate the drilling force. Third, the touch resistance
can notify the user that the drill is already on the bone to pre-
vent a large feed during the beginning of drilling. Therefore,
suddenly increased impedance that usually causes the instabil-
ity in the haptic interactions can be usually avoided [42].
The prototype system provides a more economic, safe and
convenient bone drilling training platform than by using syn-
thetic bones or sectioned frozen bones or drilling on real pa-
tients. However, the validation of the prototype system should
be evaluated by a number of experienced surgeons to compare
the realism, precision, ease of use and help to surgery between
using the simulation system and the traditional methods of us-
ing synthetic bones, sectioned frozen bones and real patients.
This validation evaluation is our future work. Meanwhile, the
haptic functions of the proposed system for extending are re-
alizing a haptic device affordable to output the drilling torque
and equipping the system with the second haptic device to sim-
ulate any guiding tool. Then, guided drilling that is also widely
used in orthopedic surgery can be simulated using the pro-
posed drilling force and torque model. The haptic functions for
simulating other orthopedic surgery tools such as reaming and
tapping bones as well as cutting, deforming and suturing soft
tissues should also be our future works.
8. Summary
Successful execution of bone drilling requires high-level
dexterity and experience because the drilling resistance is large
and vibrates violently to difﬁcultly grasp the hand-piece or even
to break the slender drill. Therefore, combination of the drilling
haptic functions into the orthopedic surgical simulator for
training is important and has not yet developed until now. The
proposed system manipulates the volume data of any speciﬁc
patient to simulate the changes of bone geometry during ortho-
pedic surgery and then uses the force and torque computation
model to simulate the haptic responses in the drilling process
based on the manipulated volume data.
Our force and torque computation model calculates and then
sums up the loads on divided cutting lips and chisel edge el-
ements to obtain forces and torques along the trust, tangen-
tial and radial directions. These forces are used to render the
haptic device that provides the user tactile feeling. The calcu-
lated torques are used to evaluate the required work for drilling,
the drill bend and the hand-piece oscillation during the drilling
process.
A simulation example of screw and plate surgery demon-
strates changes of bone geometry for several procedures and
the calculated torques and forces during the drilling process
of a hole breakthrough on the trochanter. The simulated forces
and torques resemble the ones in real drilling and thus show
the effectiveness of the drilling force and torque computation
model.
Acknowledgment
This study was partially sponsored by the National Science
Council (NSC), Taiwan/ROC; Grant nos. NSC-94-2213-E-033-
028, NSC-95-2213-E-033-065.
References
[1] M.A. Karunakar, K.A. Egol, R. Peindl, M.E. Harrow, M.J. Bosse, J.F.
Kellam, Split depression tibial plateau fractures: a biomechanical study,
J. Orthop. Trauma 16 (2002) 172–177.
[2] M.E. Müller, M. Allgower, R. Schneider, H. Willeneger, Manual of
Internal Fixation, third ed., Springer, Berlin, Heidelberg, New York,
1991 pp. 598–600.
[3] A.D. Steffee, R.S. Biscup, D.J. Sitkowski, Segmental spine plates with
pedicle screw ﬁxation, Clin. Orthop. Rel. Res. 203 (1986) 45–53.
[4] G.D. Carlson, J.J. Abitbol, D.R. Anderson, et al., Screw ﬁxation in the
human sacrum, Spine 17 (1992) S196–S203.
[5] A. Marti, C. Fankhauser, A. Frenk, J. Cordey, B. Gasser, Biomechanical
evaluation of the less invasive stabilization system for the internal ﬁxation
of distal femur fractures, J. Orthop. Trauma 15 (2001) 482–487.
[6] M.J. Prayson, D.K. Datta, M.P. Marshall, Mechanical comparison of
endosteal substitution and lateral plate ﬁxation in supracondylar fractures
of the femur, J. Orthop. Trauma 15 (2001) 96–100.
 
 
 
 
 
 
 
 
 
 
 
 
   附件  三 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
RPlease cite lysis
joint diagn
ARTICLE IN PRESS+ModelCMIG 799 1–12
2 M.-D. Tsai et al. / Computerized Medical Imaging and Graphics xxx (2007) xxx–xxx
trial and errors to avoid uncertainties and compensation impossi-54
ble procedures [20,21]. Moreover, the surgical result is difficult55
to be optim56
fortable wi57
component58
evaluations59
[22–24].60
Over the61
real-time v62
or MRI sec63
ments [25]64
pathologica65
agements.66
and featur67
and autom68
three-dime69
geometric70
evaluate th71
example, a72
The struct73
considered74
estimate th75
[26]. Simil76
to classify77
ticula [27]78
determine79
structure pr80
nize abnorm81
may not b82
However, r83
ations from84
diagnose.85
We hav86
techniques87
tebral discs88
CT or MR89
etry to ma90
section (su91
properties92
properties93
radius) or94
bone struc95
ture prope96
estimated t97
automate d98
surgical m99
simulator th100
surfaces on101
dures [29].102
bones are o103
a prosthesi104
[32,33].105
In this106
joint diagn107
transverse C108
phology. T109
contact joi110
vex and hole features on these structures. These features on the 111
successive sections are integrated to indicate abnormalities of 112
fract
re pr
he g
uctu
radi
tact
n be
essed
re a
utom
the
n a p
re th
edic
desc
join
red
diag
vene
anag
thod
heor
. 1(A
int o
sfer
dista
noid
ty. S
lt in
le, a
large
n (o
insi
ured
1(C
et of
meru
ig. 1
s re
ing
ction
es the
tact
le, th
the f
es th
s to
Sect
uctur
ature
nts.
on thUN
CO
RR
EC
TE
D 
P
this article in press as: Tsai M-D, et al., Glenoid and humerus bone ana
al. For example, whether the GH joint is com-
th a recovered humeral head position or prosthetic
s cannot be expected by the trial-and-errors if no
about the glenoid and humerus bone morphology
past few years, computer graphics techniques enable
isualization and interactive surgical simulation for CT
tions to assist diagnoses and verify surgery manage-
. Meanwhile, feature recognition techniques extract
l characteristics to help diagnoses and surgery man-
Especially, three-dimensional anatomic structures
es provide spatial information to enable accurate
ate diagnoses and surgery managements. Current
nsional recognition methods use prior (preset) 3D
data to search fit structures in 2D sections and then
e 3D structure properties by the fit 2D shapes. For
n ellipsoid was used as a prior of a femoral head.
ures on sections with ellipse-like shapes are then
as belonging to the femoral head and are used to
e femoral head properties such as the head radius
arly, local curvedness of various 3D shapes was used
priors of colonic polyps, folds, mucosa or diver-
. Then, analysis of structure curvatures on sections
the classification of the structures and estimate the
operties. Such methods are actually difficult to recog-
al shapes. For example, the femoral head on sections
e ellipse-like because of breakage or compression.
ecognizing abnormal cases and estimating the devi-
the abnormalities to the normality are important to
e developed three-dimensional feature recognition
for the musculoskeletal system including interver-
, spinal bones and hip structures for 2D transverse
I sections [28–30]. Instead of using a prior geom-
tch, we search some initial properties on every 2D
ch as centers of separate bone structures). These
were then used to decide structures and structure
on 2D sections (such as ellipse-like structure and its
to integrate into 3D properties (such as axes of the
tures). Spatial information of structures and struc-
rty deviations about the normal values were then
o determine pathological characteristics and thus to
iagnoses and surgery managements. The managed
odalities can be simulated by our reported surgery
at recognize new bones generated from the cut swept
bones to enable various orthopedic surgical proce-
The simulation results can demonstrate surgeons how
pened, corrected or repositioned, closed and fused,
s is inserted, and screws and plate are positioned
study, we extend our method to automatic GH
oses and surgery managements that uses successive
T sections to evaluate the humerus and glenoid mor-
his method identifies the humeral stem, tubercle and
nt as well as the glenoid to recognize concave, con-
spurs,
structu
joint, t
the str
ter and
the con
ties ca
compr
structu
then a
reduce
positio
dures a
orthop
We
the GH
compa
tions,
effecti
and m
2. Me
2.1. T
Fig
tact jo
to tran
ratios,
the gle
stabili
to resu
examp
it has
positio
stably
a fract
in Fig.
A s
the hu
A in F
section
depend
ple, Se
resolv
the con
tuberc
In
analyz
section
tures.
2D str
and fe
ageme
basedoses and surgery managements, Comput Med Imaging Graphics (2007), doOO
F
using CT transverse sections to automate gleno-humeral
ures and tumors and their positions and volumes. The 113
operties on the sections such as radius of the contact 114
lenoid or the humeral stem are then used to calculate 115
ral spatial properties such as the contact joint cen- 116
us, the glenoid attitude, the boundary plane between 117
joint and tubercle, and the stem axis. These proper- 118
used to evaluate whether a structure is dislocated or 119
or the humeral stem axis is sheared. Based on these 120
nd feature evaluations, the surgical procedures are 121
atically managed to dissect tumors and bone grafts, 122
dislocated humerus and compressed structures and 123
rosthesis or screws and plate. These surgical proce- 124
en simulated for verification and rehearsal using our 125
surgical simulator. 126
ribe sample cases with various shoulder diseases in 127
t. The results of image-analyses by our method were 128
with data obtained by traditional clinical investiga- 129
nosis and operative findings. These results suggest 130
ss of this method in promoting the diagnostic rate 131
ing accurate surgical procedures. 132
s 133
y study 134
) shows an idealized GH joint, at which the con- 135
f the humeral head rotates inside the glenoid cavity 136
the load on the humeral stem to the glenoid. The 137
nces and angles among the contact joint, the stem and 138
must be in normal ranges to maintain the GH joint 139
ome diseases change the ratios, angles or distances 140
abnormalities in the rotations or the stability. For 141
dislocated humerus results in an instability because 142
deviation from the contact joint center to the ideal 143
n the glenoid attitude vector) thus it cannot rotate 144
de the glenoid cavity as shown in Fig. 1(B), and 145
segment obstruct the humerus rotation as shown 146
). 147
CT or MRI transverse sections may be used to resolve 148
s and glenoid. The most inferior sections (Section 149
(A)) resolve only the humeral stem. More superior 150
solve the tubercle or the contact joint or the glenoid 151
on the section position and the arm attitude. For exam- 152
B in Fig. 1(A) resolves only the tubercle, Section C 153
contact joint and the tubercle and Section E resolves 154
joint and the glenoid; while Section D resolve all the 155
e contact joint and the glenoid. 156
ollowings, Section 2.2 introduces our method that 157
e humerus and glenoid morphology on transverse 158
recognize anatomic structures and associated fea- 159
ion 2.3 introduces the method that integrates these 160
es and features to obtain three-dimensional structure 161
properties useful for diagnoses and surgery man- 162
Section 2.4 introduces surgery management method 163
ese properties.i:10.1016/j.compmedimag.2007.08.010
RPlease cite
joint diagn
ARTICLE IN PRESS+ModelCMIG 799 1–12
4 M.-D. Tsai et al. / Computerized Medical Imaging and Graphics xxx (2007) xxx–xxx
Fig. 3. Three ed fro
2D features o contaQ7
areas: contact nce o
between two bound
Meanwhile211
determined212
from the s213
joint areas214
boundary b215
2.3.1. Hum216
The reco217
bases on o218
shape of th219
sections ar220
tance betw221
large, a she222
Thus, two223
arate hume224
illustrated225
arate featu226
the 3D pos227
(fracture, s228
2.3.2. Con229
To calcu230
contact join231
to regress t232
stem axis. T233
theorem is234
center (Fig235
d2i + r2i =236
r2i − r2j =Q2237
R is the 3D238
contact joi239
are the 2D240
respectivel241
center to th242
the ith sect243
between th244
ri and rj to245
solution fo246
wit
e u
n. T
ntac
ncav
ing t
sitio
n fe
3D
ed a
ragin
glen
set
l gap
d atti
tions
pos
Rec
foll
n th
ansv
+ czRE
CT
ED
 P
-dimensional structure and feature property calculations. (A) Stem axis regress
n transverse sections. Blue lines: transverse sections. (B) Determination of 3D
joint. R: 3D contact joint radius. ri and rj: 2D radii on sections. di and dj: Dista
sections. (C) Determination of the (red) boundary plane, regressed by (yellow)
, the 3D features of the contact joint and glenoid are
by the centers of the 2D contact joint areas obtained
uperior sections. The boundary lines of the contact
on these superior sections also determine the 3D
etween the tubercle and the contact joint.
eral stem recognition
gnition of the humeral stem and associated features
ur previous work that processed similar geometric
e femur [30]. First, the canal centers on the inferior
e used to regress to the humeral stem axis. If the dis-
een the centers of two neighboring sections is too
ar dislocation is considered existing inside the stem.
respective centerlines are used to regress to the sep-
ral stem axes at the two sheared parts of the stem as
in Fig. 3(A). The 2D concave, convex, hole and sep-
res at these sections are then integrated to calculate
ition and volume for each 3D pathological feature
pur, tumor or cyst, and avulsion).
tact joint and glenoid recognition
late the 3D contact joint center, the centers of the 2D
t areas obtained from the superior sections are used
o an axis passing this center as the regression for the
hen, the following equation based on the Pythagoras
used to determine the position of the contact joint
section
joint. W
positio
this co
2D co
resolv
3D po
avulsio
The
describ
by ave
on the
is then
norma
glenoi
the sec
the 3D
2.3.3.
The
betwee
rior tr
ax + byUN
CO
R
this article in press as: Tsai M-D, et al., Glenoid and humerus bone analysis
oses and surgery managements, Comput Med Imaging Graphics (2007), do
. 3(B)).
d2j + r2j = R2;
d2j − d2i = c(2di − c) (1)
contact joint radius and assumed uniform from the
nt center to any point on the joint surface. ri and rj
average radius at the ith section and the jth section,
y. di and dj are the distances from the 3D contact joint
e calculated 2D centers of the contact joint areas at
ion and the jth section, respectively. c is the interval
ese two sections. The unknown di can be solved by c,
determine the position of the contact joint center. One
r the position can be obtained from the most superior
ATAW =
W =
(X1, Y1, Z1
the bounda
boundary e
one bounda
equation by
from the suOO
Fm stem centers and feature position and volume integrated fromct joint center and radius. Blue planes: transverse sections. Grayf the regressed 2D centers (dot points) to the 3D center. c: Interval
ary lines on transverse sections. Blue planes: transverse sections.
h each of the other sections resolving the contact 247
se the average of all the solutions to determine the 248
hen, R is determined as the average of the radii from 249
t joint center to all pixels on the contact joint. The 250
e, convex, hole and separate features at the sections 251
he contact joint are then integrated to calculate the 252
n and volume for fracture, spur, tumor or cyst, and 253
atures. 254
glenoid center is determined by the method as 255
bove. Then, the glenoid attitude vector is determined 256
g the vectors from the glenoid center to all the pixels 257
oid. The normal position of the contact joint center 258
as the addition of R, the contact joint radius with the 259
between the contact joint and the glenoid along the 260
tude vector. The 2D concave, and convex features at 261
resolving the glenoid are then integrated to calculate 262
ition and volume for fracture and spur features. 263
ognition of tubercle and contact joint boundary 264
owing equation is used to regress the boundary lines 265
e tubercle and the contact joint areas on the supe- 266
erse sections to the boundary plane (assumed as 267
= d) between the tubercle and the contact joint. 268
⎡
⎢⎢⎢
X1 Y1 Z1
X2 Y2 Z2
⎤
⎥⎥⎥using CT transverse sections to automate gleno-humeral
i:10.1016/j.compmedimag.2007.08.010
0(2), in which A = ⎢⎢⎢⎣
X3 Y3 Z3
X4 Y4 Z4
· · · · · · · · ·
⎥⎥⎥⎦
, 269
⎡
⎢⎣
a
b
c
⎤
⎥⎦ Q3(2) 270
), (X2, Y2, Z2), (X3, Y3, Z3), (X4, Y4, Z4), etc., are 271
ry lines on the sections (Fig. 3(C)). (a, b, c) in the 272
quation is determined by the above equation. Then, 273
ry line can determine a solution of d in the boundary 274
the (a, b, c). We use the average of all the solutions 275
perior sections resolving the glenoid to determine d.
UNCORRECTED PROOF
Please
cite
this
articlein
press
as:TsaiM
-D
,et
al.,G
lenoid
and
hum
erusbone
an
alysis
u
sing
CT
transv
erse
sections
to
autom
ategleno-hum
eral
jointdiagnoses
and
su
rgery
m
an
agem
ents,Com
putM
ed
Im
aging
G
raphics(2007),doi:10.1016/j.compmedimag.2007.08.010
A
RTICLE IN PRESS
+M
odel
CM
IG
7991–12
6
M
.-D
.Tsai
et
al./Com
puterized
M
edicalIm
aging
a
nd
G
raphics
xxx(2007)
xxx–
xxx
Table 1
Outcomes and parameter of patients, image analysis and operative findings
Subject No. Age (year) Sex Automated diagnosisa Automated surgical
managementb
Confirmation of diagnosis by
operative findings
Satisfaction condition under
our method
Follow up post-operation Clinical results Follow up
post-operation
Clinical results
Saved time/total time in
operation (Min)
Value of preoperative simulation Morphology + size of implant
selection
Case 1 43 M Fracture dislocation of H
head, R
ORIF with plate and screws,
A
Confirmed 16/78 +++ +++ 1Y5M E
2 38 M Fracture dislocation of H
head, L
ORIF with plate and screws,
A
Confirmed 16/78 +++ +++ 1Y3M E
3 46 F Fracture dislocation of H
head, R
ORIF with T-plate and
screws, A
Confirmed 18/78 ++++ +++ 1Y1M E
4 58 F Four parts fr of head, R Hemiarthroplasty with
shoulder prosthesis, B
Confirmed 18/110 +++ +++ 1Y8M E
5 62 F Four parts fr of head, R Hemiarthroplasty with
shoulder prosthesis, B
Confirmed 20/110 +++ +++ 1Y3M G
6 83 M Four parts fr of head, R Hemiarthroplasty with
shoulder prosthesis, B
Confirmed 16/110 +++ +++ 1Y1M E
7 44 M Four parts fr of head, L Hemiarthroplasty with
shoulder prosthesis, B
Confirmed 12/110 +++ +++ 1Y2M G
8 73 M Four parts fr of head, L Hemiarthroplasty with
shoulder prosthesis, B
Confirmed 14/110 ++++ +++ 1Y2M E
9 28 F Four parts fr of head, R Hemiarthroplasty with
shoulder prosthesis, B
Confirmed 14/110 ++++ +++ 1Y2M E
10 32 M Four parts fr of head, L Hemiarthroplasty with
shoulder prosthesis, B
Confirmed 18/110 +++ +++ 1Y11M E
11 81 F H head tu with fr., R Hemiarthroplasty with
shoulder prosthesis, B
Confirmed 22/102 ++++ +++ 1Y E
12 84 F H head tu with fr, L Hemiarthroplasty with
shoulder prosthesis, B
Confirmed 16/102 +++ +++ 10M E
13 86 F H head tu with fr, L Hemiarthroplasty with
shoulder prosthesis, B
Confirmed 20/102 +++ +++ 1Y1M G
14 39 M Avulsion fr of H head, L ORIF with screw and washer,
B.
Confirmed 14/76 +++ +++ 1Y7M E
15 32 M Avulsion fr of H head, R ORIF with screw and washer,
B
Confirmed 14/76 +++ +++ 1Y5M G
16 47 F Avulsion fr of H head, L ORIF with screw and washer,
B
Confirmed 18/76 ++++ +++ 1Y3M E
17 55 M Avulsion fr of H head, R ORIF with screw and washer,
B
Confirmed 16/76 ++++ +++ 1Y E
18 29 M Avulsion fr of H head, L ORIF with screw and washer,
B
Confirmed ++++ +++ 1Y1M E
19 55 M H head glenoid fr, R Conservative 2Y1M G
20 50 M Benign tu of h head, R Conservative 1Y1M G
21 16 M Benign tu of, h head, L Conservative 1Y1M G
ORIF, open reduction with internal fixation; Min, minute; ++++, strong valuable; +++, moderate valuable; ++, valuable; +, loss valuable; −, no valuable; M, male; F, female; H, humerus; fr, fracture; tu, tumor; E, excellent; G, good; R, right; L, left.Q8
a Automated diagnoses based on image analysis of transverse sections.
b Automated surgery management based on image analysis of transverse sections including yhree types of surgeries: A, ORIF; B, arthroplasty; C, conservative treatment.
R
F
Please cite
joint diagn
ARTICLE IN PRESS+ModelCMIG 799 1–12
8 M.-D. Tsai et al. / Computerized Medical Imaging and Graphics xxx (2007) xxx–xxx
Fig. 4. Images of isosurface reconstruction and analysis for a humeral head fracture and dislocation. (A) 3D reconstruction of bone surface. Oblique view: solid
arrows, turned out fractured segment. Green, blue and red lines: primary axes of volume. (B) A transverse section with (left) head dislocation and fractures, and (right)
normal stem. Yellow curve: approximated B-spline canal boundary. Yellow point: regressed contact joint center. Solid arrows: fractures. Red centerline: glenoid
attitude vector projecting onto this section. (C) A transverse section with normal humeral head. Yellow point: contact joint center. Blue line: boundary line between
tubercle and contact joint. Red centerline: glenoid attitude vector.
Fig. 5. Surgic . (A)
(B) Reduction rus (p
bone fragmen
ment was r383
a 90◦ rotat384
recognized385
location an386
positions)387
ment onto388
fractured f389
to the calcu390
4.2. Hemi-391
communica392
This 58393
der pain w394
the ground395
ination: lim396
right shoul397
head was o398
the r
e.
was
con
B an
ctive
ecau
later
c pe
Fig. 6. Image
by tumor. (B)
contact joint.
hole tumor. YTE
D 
Pal simulations for reduction of head fracture and dislocation. Near frontal viewof the fractured bone segment (light gray). (C) Reduction of dislocated humet.
epositioned onto the head in a translation following
ion. Fig. 5(C) shows the left humeral head has been
and repositioned near to the glenoid to reduce the dis-
d finally the calculated screw and T-plate (sizes and
has been used to fix the repositioned fractured frag-
the humeral head. Because the repositions of the two
ragments and the humeral head were in accordance
lations of the system, the reductions were suitable.
tive of
fractur
CT
a 3D re
Fig. 6(
a respe
hole. B
in the
specifiUN
CO
RR
EC
this article in press as: Tsai M-D, et al., Glenoid and humerus bone analysis
oses and surgery managements, Comput Med Imaging Graphics (2007), do
arthroplasty for humeral head with tumor and
te fractures
-year-old female (Case 4) suffered from right shoul-
ith motion limitation following a falling down to
. Abnormalities were noted during physical exam-
ited external rotation and local tenderness of the
der. A comminuted fracture over the right humeral
bserved on the X-ray. These findings were indica-
can be cle
indicate the
The ima
large radiu
humeral he
required. T
determine t
shows part
on the feat
s of isosurface reconstruction and analysis for a head tumor and fracture. (A) 3D re
Image analysis result on humeral heads. Solid arrows: hole tumor. Yellow point: co
Red centerline: glenoid attitude vector. (C) Image analysis result on humeral heads.
ellow point: contact joint center. Blue line: boundary line between tubercle and contaOO
Cut swept surface (red) on a turned out fractured segment (blue).
ink) and screw (blue) and T-plate (yellow) on reduced fractured
ight humeral head: a benign tumor with comminuted 399
400
performed in 67 transverse sections. Fig. 6(A) shows 401
structed image for a tumor on the right humeral head. 402
d C) shows a respective transverse section resolving 403
hole that is considered generated by the same tumor 404
se the outside cortical bone was only little fractured 405
al side, we can only observe this pathology from a 406
rspective (Fig. 6(A)). However, this pathology hole 407using CT transverse sections to automate gleno-humeral
i:10.1016/j.compmedimag.2007.08.010
arly analyzed at the superior transverse sections to 408
tumor position and volume. 409
ge analysis result indicates one large hole tumor (with 410
s change) in each section resolving the superior right 411
ad. Because of this tumor, the hemi-artroplasty is 412
he calculated boundary plane is also calculated to 413
he base plane for inserting the prosthetic head. Fig. 7 414
s of the simulations of the hemi-arthroplasty based 415
ure recognitions, evaluations and surgical manage- 416
construction of bone surface. Frontal view: solid arrow, fracture
ntact joint center. Blue line: boundary line between tubercle and
This section is 6 mm superior to the section above. Solid arrow:
ct joint. Red centerline: glenoid attitude vector.
RPlease cite
joint diagn
ARTICLE IN PRESS+ModelCMIG 799 1–12
10 M.-D. Tsai et al. / Computerized Medical Imaging and Graphics xxx (2007) xxx–xxx
Fig. 9. Image or. (
glenoid fractu rom th
point: the gle ixels
using multipl the tu
intersections
during phy463
of motion.464
a small ben465
the image a466
tumor reve467
5. Discuss468
Three-d469
tumors as470
tant factors471
surgical pr472
are mainly473
[1–6], obse474
fits of qual475
glenoid bo476
that analyz477
estimate th478
in the hume479
surgical pr480
reduction a481
Our me482
stem canal483
structures a484
features on485
cal features486
radii of th487
verse sectio488
and centers489
head disloc490
ical feature491
properties492
feature pro493
joint surge494
location an495
volumes an496
prosthetic c497
Three-d498
visualizatio499
tive to visu500
t eas
geo
le, th
died
e th
bring
reco
res a
these
pro
s and
imat
t join
tion
s bas
ee s
last
noid
sed a
ical
is dia
l sim
ng a
hus
o proRE
CT
ED
 P
analysis results and 3D isosurface for a glenoid fracture and a head benign tum
re. (B) An image anaylsis result for a glenoid fracture: using changes of radius f
noid center on this section. Solid arrows: radii from the glenoid center to the p
e (green) intersections on a vector from the center to bone boundaries to detect
of the bone boundaries with the vector.
sical examination: local tenderness with limited range
These clinical findings and X-ray were indicative of
ign tumor over the humeral head. Fig. 9(C) shows
nalysis of a transverse section resolve a small benign
aling only closed observation is required.
ion
imensional geometric estimation for fractures and
well as the humeral head dislocations are impor-
in deciding the appropriate diagnostic modality and
ocedures for GH joint diseases. Current techniques
based on clinical experiences, analyses of X-rays
rvation on MRI or CT sections without the bene-
itative and quantitative analyses of 3D humerus and
ne morphology. In this study, we proposed a method
es the 3D geometry of humerus and glenoid bones to
e humeral head dislocation, and fractures and tumors
rus and glenoid. As the result, precise diagnoses and
ocedures for tumor dissection and bone graft, open
nd artroplasty can be automatically determined.
thod uses radial B-spline curves to approximate the
, the humerus head and the glenoid as ellipse-like
t every transverse section. Concave, convex or hole
these structures are then recognized as pathologi-
it is no
precise
examp
the stu
becaus
val to
the 3D
structu
grates
feature
as line
the est
contac
disloca
uation
Thr
arthrop
and gle
diagno
pholog
that th
surgica
planni
ment. T
can alsUN
CO
R
this article in press as: Tsai M-D, et al., Glenoid and humerus bone analysis
oses and surgery managements, Comput Med Imaging Graphics (2007), do
such as fractures, spurs or tumors. The centers and
ese ellipse-like structures obtained from the trans-
ns are used to determine 3D structure axes, attitudes
to evaluate structural deformities such as humeral
ation or compression. Three-dimensional patholog-
position and volume are integrated from feature
on the transverse sections. These 3D structure and
perties are used to determine the parameters in GH
ry including reduced distances of the humeral dis-
d fractured fragments, dissecting and bone grafting
d positions for tumors, and sizes and positions of
omponents or screws and plate.
imensional reconstructed isosurfaces by volume
n techniques let surgeons choose a suitable perspec-
alize pathological characteristic on bones; however,
for reductio
volume for
our method
errors of fit
tools can b
be used to
occurrence
Twenty-
this study
were consis
diagnoses a
as well as
were also
also reduce
and guidinOO
FA) 3D reconstruction of bone surfaces. Frontal view: solid arrow,e glenoid pixel to the center to detect the glenoid fracture. Yellowon the glenoid. (C) An image analysis result for a benign tumor:
mor. Yellow point: the humeral contact joint center. Green points:
ily used to observe interior tumor and cannot provide 501
metry when the section number is not enough. For 502
e humeral heads in the reconstructed images of all 503
cases seem shorter (about 0.8–0.9 times) than normal 504
e head height is about 10 times to the section inter- 505
maximum 20% of resolution miss. Different from 506
nstruction approach, our method analyzes anatomic 507
nd associated features in 2D sections and then inte- 508
2D structures and features to obtain 3D structure and 509
perties. Although simple 3D geometric entities such 510
planes are used to evaluate the structure properties, 511
ions using these entities (e.g. the distance between the 512
t and glenoid attitude vector to estimate the humeral 513
) are near to the general values. That means the eval- 514
ed on these simplified 3D entities are acceptable. 515
uccessful simulation cases of open reduction and 516
y based on the 3D morphology analysis of humerus 517
bones shows that GH joint diseases can be accurately 518
nd managed to operate and achieve the GH joint mor- 519
stability. These successful simulations also indicate 520
gnostic and managing tool can be combined with the 521
ulation tool for use in automated diagnosis, surgical 522
nd verification, prognosis assessment and manage- 523
, our method provides not only accurate diagnosis but 524
vide detailed surgical parameters including distances 525using CT transverse sections to automate gleno-humeral
i:10.1016/j.compmedimag.2007.08.010
n, sizes of prosthetic components, and position and 526
opening and dissecting and grafting bones. Uses of 527
can save surgical time because the need for trial and 528
ting template prostheses and uses of various guiding 529
e avoided. Meanwhile, the use of the simulator can 530
train the interns and students because of the seldom 531
in non-conservative GH joint surgery. 532
one patients with GH joint diseases participated in 533
were compared with the intraoperative findings and 534
tent at more than 1-year postoperative follow-up. The 535
nd managed surgical modalities, dislocated distance 536
the positions and volumes of fractures and tumors 537
confirmed intraoperatively. The operation time was 538
d in the trial and errors of using template prostheses 539
g tools. However, these examples do not include all 540
