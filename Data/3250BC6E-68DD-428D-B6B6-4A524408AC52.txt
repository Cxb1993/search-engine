type of device used to print the material in question 
would provide a valuable aid for law enforcement and 
intelligence agencies. 
 
We propose to develop two strategies for printer 
identification based on examining a printed document. 
The first strategy is passive. It involves 
characterizing the printer by finding intrinsic 
features in the printed document that are 
characteristic of that particular printer, model, or 
manufacturer＇s products. We refer to this as the 
intrinsic signature. The second strategy is active. 
We embed an extrinsic signature in a printed page. 
This signature is generated by modulating the process 
parameters in the printer mechanism to encode 
identifying information such as the printer serial 
number and date of printing. The proposed 3-years 
research includes: (1) printer characterization (2) 
intrinsic signature development (3) extrinsic 
signature embedding. 
 
So far, we have developed a laser printer model that 
incorporates the laser intensity with a stochastic 
dot interaction model to estimate the reflectance of 
an images printed on a known halftone pattern. We 
also developed techniques that use the print quality 
defect known as banding in laser printers as an 
intrinsic signature to identify the model and 
manufacturer of the printer. We showed that different 
printers have different sets of banding frequencies 
which are dependent upon brand and model. This 
feature is relatively easy to estimate from documents 
with large mid-tone regions. For text document, we 
used graylevel co-occurrence texture features to 
classify various printers and got promising results. 
In the future, we will extend this technique to work 
with multiple font size, font type, and different 
characters. In addition, we will develop techniques 
to embed extrinsic signatures in the document at the 
hardware level of the printer. 
 
 
 Extrinsic Signatures Embedding and Detection in 
Electrophotographic Halftone Images through Laser Intensity 
Modulation 
Pei-Ju Chiang  
Department of Mechanical Engineering, Chung Cheng University 
NSC 100-2221-E-194 -009 
 
Abstract 
In this paper, we demonstrated the feasibility of embedding 
unperceivable code sequence by modulating dot gains through 
laser intensity modulation for halftone images. From a 
communication systems point of view, a printer and a document 
scanner form the physical layer of a communication channel, 
where information can be hidden in halftone images and reliably 
transmitted and extracted. In the proposed approach, we will 
leverage our previous results in embedding unperceivable banding 
signals to halftone images and develop an integrated embedding 
and detection algorithm to embed and extract information with 
high payload capacity. Specifically, we will characterize the 
embedding capacity and detection rate associated with the 
proposed algorithm. Preliminary experimental results will be 
presented. 
Introduction 
Printed material is a direct accessory to many criminal and 
terrorist acts. The ability to identify the device or type of device to 
print the material in question and the authentication of the printed 
material would provide a valuable aid for law enforcement and 
intelligence agencies. 
To identify the printing device or authentication of the 
document, intrinsic signatures [1-7] and extrinsic signatures [8-11] 
of printers have been investigated. Intrinsic signatures involve 
tracing the intrinsic features in the printout that are characteristic 
of that particular printer, model or manufacture's products. 
Extrinsic signatures are specific information embedded into the 
printed document through modulating the printing process 
parameters. In our previous work, we have presented the 
techniques of modulating the exposure of the electrophotographic 
(EP) process through laser intensity modulation to embed 
unperceivable banding into half-toned images [9]. We have 
proposed embedding and decoding techniques for text documents 
without image quality degradation [8,10,12]. For half-toned 
images, we have proposed to embed multiple frequency banding 
signals and apply DFT to extract the embedded signals [11]. Sine 
the resolution of DFT depends on the extracted data length, the 
approach proposed in [11] will constrain the applicable image size 
and decoding performance. In this work, we propose improved 
embedding and detection algorithms for half-toned images to 
increase the payload capacity.  
Since the embedded data can be extracted from images with 
different gray-level and from anywhere of the image, its exact 
phase configuration within the image is lost. To retrieve the 
embedded code, we exploit the properties of pseudo-random 
binary sequence (PRBS) or pseudo-random noise (PN) sequences 
to develop our embedding and detection algorithms. To embed 
extrinsic signatures without image quality degradation and human 
perception, we modulate the embedded code to higher frequency 
band according to the previous results in embedding unperceivable 
banding signal [9]. An HP color laserjet 4500 is used as the 
experimental platform for this study. 
This paper is organized as follows. The embedding and 
detection algorithms for half-toned images without human 
perception will be discussed in the next section followed by the 
presentation and discussion of preliminary experimental results. 
The conclusions are given in the last section. 
Information Embedding and Extraction 
The process of embedding and decoding extrinsic signatures 
in halftone images is outlined in Fig. 1. Through modulating the 
laser intensity, a specific PN sequence is embedded in a half-toned 
image. After scanning the printed image by a calibrated scanner, 
the scanned image is projected to the process direction to obtain a 
1-D data sequence. After normalization, correlation between the 
data sequence and the set of all possible PN sequences is applied 
to identify the sequence with the maximum correlation value. 
Different segments from the same printed image are extracted and 
processed, a majority vote from all the extracted images of its 
correlated PN sequence will determined the embedded sequence. 
 
 
Figure 1. Process block diagram for embedding and decoding extrinsic 
signatures of halftone images 
Encoding and Embedding Algorithm: Pseudo-
Random Binary Noise Sequence 
In this section we will propose a coding and embedding 
algorithm to embed a unique sequence repeatedly along the 
process direction of a half-toned image. We do not assume prior 
  
is about a quarter of an inch at 600 dpi printer resolution. For the 
subsequent experiments, Ts = 5 will be used. Note that for this 
coding sequence, the theoretical maximum payload capacity is 
about 20 bits per inch. Of course, the achievable and reliable 
payload capacity will be less. 
Table 3 shows the detection rate P1 for different modulation 
amplitudes ∆V. It is obvious to note that higher modulation 
amplitude implies higher energy of the embedding signal that will 
translates to higher detection rate.  
Although with high detection rate, the square gratings 
associated with the PN sequence is visible even with modulation 
amplitude that is fall below the human visual threshold. As 
discussed in the previous section, one possible solution to reduce 
the visibility of the embedded code is to modulate the sequence to 
higher spatial frequencies, see Eq. (1). Table 4 shows the detection 
rate P1 of the modulated code sequence where the original code is 
modulated to spatial frequencies 60 and 120 cycles per inch, 
respectively. From Table 4, the detection rate decreases as the 
modulation frequency increase because of the limited MTF of the 
printing system. However, with 33 candidate sequences, 46.86% of 
the extracted data voted for sequence 1, the correct choice, is a 
sufficient high percentage. Figure 2 shows the Pk values for all the 
33 candidate sequences. From Fig. 2, except for sequence 1, none 
of the other 32 sequences received more than 5% of the vote, with 
an average voting rate of 100/33=3.03% that is associated with an 
uncorrelated noise sequence.  
Table 5 shows the majority vote result P for the two 
modulation frequencies and two modulation amplitude ∆V 
=0.1/0.05 [V], respectively. As can be seen, the majority vote 
result are 5/5 for both modulation frequencies at the modulation 
amplitude of 0.1 volt. Figures 3 and 4 compare a unmodulated 
printed image with one that is printed with a coded sequence with 
a modulation frequency of 120 cycles/in and laser intensity 
modulation of 0.1 volt. Comparing Figures 3 and 4, there are no 
visible degradation of image quality or visible indication of an 
coded message.  
Table 2: Percentage Pk values for different Ts with k=1, n=5 and 
∆V=0.1V 
P1 Ts=1 Ts=3 Ts=5 
n=5  1.14% 91.38% 96.57% 
Table 3: Percentage Pk values for different ∆V with k=1, n=5, 
and Ts=5 
P1 ∆V=0.1(V) ∆V=0.05(V) ∆V=0.025(V) 
n=5, Ts=5  96.57% 40.57% 5.71% 
Table 4: Percentage Pk for different ∆V and Fs with k=1, n=5, 
and Ts=5 
P1 Fs=60 (cycles/in) Fs=120 (cycles/in) 
∆V=0.1 (V) 86.86% 46.86% 
∆V=0.05 (V) 20% 8% 
 
Table 5: Majority vote result P for different ∆V and Fs with k=1, 
n=5, and Ts=5 
P Fs=60 (cycles/in) Fs=120 (cycles/in) 
V=0.1 (V) 5/5 5/5 
V=0.05 (V) 4/5 1/5 
0 20 400
20
40
60
Index of Sequencies
Pe
rc
en
ta
ge
s 
of
 v
ot
e 
(%
)
 
Figure 2. Percentage of votes for the 33 candidate sequences 
 
Figure 3. Printed image without any modulation 
 
Figure 4. Printed image modulated with ∆V=0.1, Fs=120 cycles/in, n=5 and 
Ts=5 
國科會補助專題研究計畫項下出席國際學術會議心
得報告 
                                    
日期： 101  年 08 月 03 日 
計畫編號 NSC100-2221-E-194-009 
計畫名稱 印表機辨識之研究與系統開發 
出國人員
姓名 
林怡君 
服務機構
及職稱 
國立中正機械工程所碩士班 
會議時間 
2012年7月24日至 
2012年7月26日 
會議地點 
 
 泰國普吉島(Phuket, Thailand) 
 
會議名稱 
(中文)2012 年計算智能與通訊系統國際會議 
(英文) CICSyN2012 : Computational Intelligence, Communication Systems 
and Networks. 
發表論文
題目 
(中文)影像處理技術於血管定量之判斷 
(英文) Quantitative Analysis of Vascular Structures Using Image Processing 
 
 
 
 
筆者有幸參與此次會議之論文發表，口頭報告的題目為”Quantitative 
Analysis of Vascular Structures Using Image Processing” 。本研究是用影像
處理的方式對血管進行定量，並提供多種參數。這些參數有總管長、總迴
路數、總管面積、匯流區域總面積、匯流區域個數、分支點結構數，可供
定量。此外，並對迴路數與管長與人工定量結果去做比較。由實驗結果指
出迴路最高平均 hit rate 為 90.3%且最高平均 False alarm rate 是 6.675% ，
且管長定量結果可落於人工定量的誤差範圍內。 
在筆者演講結束後，非常感謝有學者提出些許疑問與建議，啟發了筆
者可以用不同的角度來觀看同ㄧ件事物，著實受益良多。 
 
上圖是筆者對於影像處理技術於血管定量之判斷的研究成果發表 
 
二、 與會心得 
計 算 智 能 與 通 訊 系 統 國 際 會 議 (Computational 
Intelligence, Communication Systems and Networks)至今已舉辦4屆，會議中
聚集許多各種不同領域之專家學者，筆者對於國科會協助得以前往與會並
發表論文由衷表示謝意。近年來影像處理技術逐漸受到重視，影像處理發
展至今，除了開發出許多不同功能的影像處理軟體外，這些技術也應用於
主旨： [CICSyN2012] Conference Venue, ISBN and page numbers
寄件者﹕ CICSyN2012 (cicsyn2012-chairs@edas.info)
收件者： pchiang@ccu.edu.tw;
日期： 2012/7/8 (週日) 3:31 AM
Dear Author of Published paper Ms. Pei-Ju Chiang,
Paper ID: #1569630197
Paper Title: "Quantitative Analysis of Vascular Structures Using Image Processing"
Kindly see our website cicsyn2012.info for full information about the conference venue, hotel
name, address, phone number etc.
Also new on our website is the Table of Content (ToC) of the proceedings, click on Table of
Content and find the page numbers for your paper.
The ISBN is also on our website, click on ISBN and scroll down about half way down the page
to see it.
You may now add your paper details to your CV, congratulations!!
There are still vacancies for session co-chairs. Kindly look at our website, click on Published
Papers and choose a session you are willing to co-chair, e.g. Wed.pm1.A (which means
Wednesday morning after lunch) and email your choice to david.al-dabass@ntu.ac.uk ASAP.
Your response by return is greatly appreciated. A certificate of Merit will be issued to session
chairs to mark our appreciation of your contribution to the success of the conference.
See you at the conference!!
On behalf of CICSyN22012 Chairs
列印 http://tw.mg30.mail.yahoo.com/neo/launch?.rand=901tjrnul1h77
1 of 1 2012/10/30 上午 11:17
 
Figure 1.  The image of endothelial cell tubes. 
 
Figure 2.  The entropy image of Fig. 1 
 
Figure 3.  Binary image of Fig. 2 
 
Figure 4.  De-noise of Fig. 3 
 
The gradient magnitude of the entropy image in Fig. 2 
using Sobel is then computed. The histogram using only the 
pixels with gradient magnitude greater than 99.7% of the 
gradient image is then computed. Based on the computed 
histogram, Otsu’s method is used to segment Fig. 2 and the 
result is shown in Fig. 3. 
As can be seen from Fig. 3, the segmented image is noisy. 
The noise manifests itself as light elements on a dark 
background and as dark elements on the vascular structures. 
In addition, since the quantitative analysis is only for tubular-
like cell network, the isolated cells should be removed. To 
remove the isolated cells and the light elements on the dark 
background, the area and circularity factor of each white 
connected component are calculated. The circularity factor is 
defined as follows: 
2
4
P
AfactoryCircularit 	 

where A is the area, and P is the perimeter. The circularity 
factor ranges from zero to one, and is one for a circle. Since 
the isolated cells and light elements on the background are 
small and like circles, any component with area less than 400 
pixels and circularity factor greater than 0.6 is considered as 
noise and removed. In addition, for the noise on the vascular 
structures, the black connected components with area smaller 
than the manually selected loop are removed. The resulting 
image is shown in Fig. 4.  
B. Skeleton of vascular structures 
In this paper, we used tube length and loops to quantify 
the vascularisation. To measure the tube length, the vascular 
structures is morphologically thinned. Figure 5 shows the 
frame of the blood vessels after thinning. As can be seen in 
Fig. 5, slight irregularities in a boundary will lead to spurious 
spurs in the final image which will affect the quantification 
of the tube length. De-spurring or pruning can be carried out 
to remove spurs of less than a certain length but this is not 
always effective since small perturbations in the boundary of 
an image can lead to large spurs in the skeleton[16]. To 
resolve this problem, in this wok, an average filter is applied 
279
 
Figure 9.  Images of confluent areas and nodal structures where the 
confluent area is presented in red and nodal structures are presented in blue. 
III. EXPERIMENTAL RESULTS 
To quantify the formation of blood vessels, the following 
parameters are measured automatically from the processed 
images: 
1. Total tube length: 
2. Total number of loops  
3. Total tube area  
4. Total confluent areas 
5. The number of confluent area 
6. The number of nodal structures 
The measurements of these 6 parameters for Fig. 1 are listed 
in Table I. To evaluate the performance of our automatic 
vascular quantification system, we had 4 experts in biology 
to count the number of loops manually in the image, and the 
number they got is taken as the real number of loops that 
exist in the image. Then we used the proposed automatic 
vascular quantification system to count the loops and 
compared the results with the real numbers. Here, we used 
hit rate and false alarm rate defined in the follows to present 
the performance of our system: 
loops ofnumber  Total
countedcorrectly  are that loops ofNumber rateHit  
loops ofnumber  Total
countedy incorrectl are that loops ofNumber rate alarm False    (4) 
Therefore, false alarm rate gives the fraction of loops 
counted that were observed to be non loops. Eight images 
taken from different blood vessels were used to test our 
system. The results are shown in Table II. From Table II, the 
highest hit rate is 100%. In this case, all loops can be counted 
correctly without any error. The lowest hit rate is 90.3%. The 
highest false alarm rate is 6.675%, and the lowest false alarm 
rate is 0%. 
TABLE I.  QUANTIFICATION OF THE VASCULAR STRUCTURE IN FIG. 1 
Parameters Measurements 
Total tube length 7983 pixels 
Total number of loops 31 
Total tube area  193554 (pixels) 
Total confluent areas 74197 pixel 
The number of confluent area 1 
The number of nodal structures 38 
 
In addition, we have the same four people draw the 
skeleton of the blood vessels manually on the computer and 
calculate the number of pixels on the skeleton as the tube 
length. The measurements are compared with the automatic 
system and shown in Fig. 10 and Table III. In Table III, the 
first column is the image index, the second column is the 
average tube length for each image measured by four people, 
the third column is the standard deviation, and the fourth 
column is the tube length measured by the proposed 
automatic quantification system. From Fig. 10, it is obvious 
that the tube length obtained by automatic system falls 
within the normal distribution of manual measurements. 
However, if the blood vessels come along with other 
substances such as Figs. 11 and 12 shown, the automatic 
system will mistakenly take the impurities as blood vessels 
which will cause the quantification fail.   
 
TABLE II.  PERFORMANCE EVALUATION 
  A B C D Average 
1 
Hit 
rate 100% 100% 100% 93.3% 98.3% 
False 
rate 0% 0% 0% 0% 0% 
2 
Hit 
rate 100% 100% 100% 100% 100% 
False 
rate 0% 0% 0% 0% 0% 
3 
Hit 
rate 100% 100% 100% 100% 100% 
False 
rate 0% 0% 0% 0% 0% 
4 
Hit 
rate 100% 94.1% 100% 94.1% 97.05% 
False 
rate 0% 0% 0% 0% 0% 
5 
Hit 
rate 96.5% 90.3% 96.5% 93.3% 100% 
False 
rate 0% 0% 0% 0% 3.7% 
6 
Hit 
rate 97.2% 97.2% 100% 97.3% 
97.925
% 
False 
rate 9.1% 2.7% 8.1% 7.8% 6.675% 
7 
Hit 
rate 97.2% 93.75% 94.1% 
93.75
% 94.7% 
False 
rate 14.2% 6.25% 0% 6.25% 6.675% 
8 
Hit 
rate 100% 100% 100% 100% 100% 
False 
rate 0% 0% 0% 0% 0% 
 
281
[5] ImageJ :  http://rsbweb.nih.gov/ij/index.html 
[6] NIH image :  http://rsbweb.nih.gov/nih-image/ 
[7] Robert Auerbach, Rachel Lewis, Brenda Shinners, Louis Kubai, and 
Nasim Akhtar, “Angiogenesis Assays: A Critical Overview” ,Clinical 
Chemistry vol.49,no.1 ,pp32–40 ,2003 
[8] Guidolin D, Vacca A, Nussdorfer GG, et al.,”A new image analysis 
method based on topological and fractal parameters to evaluate the 
angiostatic activity of docetaxel by using the Matrigel assay in vitro”,  
MICROVASCULAR, Vol. 67, p.p117-124, 2004 
[9] Lamberti, Fabrizio , Montrucchio, Bartolomeo,” SEGMENTATION 
OF IN-VITRO ENDOTHELIAL CELL NETWORKS”, 2004 2nd 
IEEE International Symposium on Biomedical Imaging: Macro to 
Nano, v 1, p 129-132, 2004 
[10] Lamberti, Fabrizio; Montrucchio, Bartolomeo; Gamba, Andrea ,” 
Quantitative analysis of vascular structures geometry using neural 
networks”, IEEE Workshop on Signal Processing Systems, SiPS: 
Design and Implementation, v 2005, p 378-383, 2005 
[11] Merks RMH, Brodsky SV, Goligorksy MS, et al.” Cell elongation is 
key to in silico replication of in vitro vasculogenesis and subsequent 
remodeling”, DEVELOPMENTAL BIOLOGY   Vol. 289   p.p 44-
54  ,2006 
[12] Lvzhen Huang, Wenzhen Yu, Xiaoxin Li, Yongsheng Xu, Lanjun 
Niu, Xiangjun He, Jianqiang Dong, Zheng Yan1,”Expression of 
Robo4 in the fibrovascular membranes from patients with 
proliferative diabetic retinopathy and its role in RF/6A and RPE 
cells”, Molecular Vision 2009; 15:1057-1069 
[13] Guidolin D, Albertin G, Sorato E, et al.,“Mathematical Modeling of 
the Capillary-Like Pattern Generated by Adrenomedullin-Treated 
Human Vascular Endothelial Cells In Vitro”, DEVELOPMENTAL 
DYNAMICS  Vol.23   p.p.1951-1963 ,2009 
[14] US 2010/0255528 A1,”Method of Monitoring angiogenesis and 
metastasis in three dimension co-cultures”, Zudaire Enrique, Cuttitta 
Frank, Fang Changge. 
[15] Rafael C. González, Richard Eugene Woods,” Digital image 
processing”, Prentice Hall, 2008 
[16] J. ANGULO, S. MATOU, ”Application of mathematical morphology 
to the quantification of in vitro endothelial cell organization into 
tubular-like structures”, Cellular and Molecular Biology ,Vol.53, 
pp22-35, 2007 
 
 
 
 
 
 
 
 
283
100年度專題研究計畫研究成果彙整表 
計畫主持人：江佩如 計畫編號：100-2221-E-194-009- 
計畫名稱：印表機辨識之研究與系統開發(II) 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 1 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
