2and Correlation Coefficient. The
recognition correctness rate can achieve
91.8%. The processing time is about 3.3 to
3.8 seconds.
Keywords: Banknote, Optical Inspection,
Security Features Recognition
二、緣由與目的
目前國內交易方式幾乎是以有價證劵
的交易方式為主，一般民眾最常使用的莫
過於鈔劵交易，但隨著電腦科技不斷的進
步，越來越多的不法之徒嘗試製作及使用
偽鈔，對於國內經濟影響甚鉅，過去中央
銀行發行的舊式鈔劵其安全防偽功能，逐
漸可以藉由電腦繪圖軟體加以複製描繪出
來，甚至可以製作出跟真鈔極為相似的偽
鈔。中央銀行所發行的新台幣歷經多次改
版，目的即是製作更多、更精細、更難以
偽造的安全防偽功能，雖然許多金融機構
提供信用卡的功能，但是絕大部分的人還
是習慣使用鈔劵來進行各項交易活動，除
了因為鈔劵具有較高的通用性及流動性
外，最重要的是信用卡的安全機制仍然不
夠健全，還有待開發，為了保障鈔劵交易
安全、杜絕偽鈔擾亂國家經濟。因此，鈔
劵必須擁有多種極為精細的安全防偽功
能，然而新印製出來的鈔劵要在市面上流
通之前，必須經過嚴格的品管，除了避免
在交易時真鈔被誤判為偽鈔外，更重要的
是要確保發行的每張鈔劵都擁有正確無誤
的安全防偽功能，方便民眾交易時容易辨
別出真偽鈔，除能確認各項安全防偽功能
的正確性外，另一方面檢測過程還必須迅
速有效率，本研究目的是利用機器視覺的
技術檢測鈔劵安全防偽功能是否存在瑕
疵。鈔劵安全防偽功能主要瑕疵類型有未
印製、斷裂、歪斜、偏移、數字有誤。
本文提出一套應用於單張鈔劵安全防
偽功能瑕疵檢測的技術。在單張鈔劵中，
安全防偽功能的瑕疵多半是因為印刷或鑲
入安全功能時所產生的，由於所產生的瑕
庛和正確的鈔劵可能會極為相似或差異極
小(如圖 1，為有瑕疵的鈔劵，框線所圍部
分為瑕疵所在處)，在檢測防偽功能時，必
須要針對其可能的瑕庛做通盤性的檢測以
降低其判斷上的誤差，在影像擷取進入系
統後，利用空間域的高通濾波[1]強化邊
緣，並搜尋鈔劵邊框做系統的校正，進而
判斷是否滿足鈔劵的尺寸規格，再利用收
集的數張鈔劵找出各個防偽功能容許的誤
差範圍，而定位切割的方式將欲檢測之區
域框選出來，最後再利用圖像比對及像素
統計判斷其是否滿足所收集的正確鈔劵的
容許誤差量。
圖 1 安全防偽功能有瑕疵之鈔劵
三、研究方法
3.1鈔劵結構介紹
各國的鈔劵皆擁有極具複雜且精細的
安全防偽功能。鈔劵的印刷防偽技術基本
上可以分為顯性及隱性兩部分。所謂的顯
性乃是紙張的材料、印刷所用的油墨及鈔
劵上的圖案部分，在進行交易的同時也較
容易辨識，例如新台幣千元鈔劵在正面右
方有條感光安全線，一般民眾可以藉由此
感光安全線來辨識真偽，感光安全線的產
生是因為在製造紙張的同時，就把螢光纖
維絲置入其中，並且使用全像圖(Hologram)
的技術，讓其難以仿造。至於隱性部份則
是無法藉由肉眼辨識，而需要藉由特殊儀
器或是特殊方式辨識其真偽，例如新台幣
的正面右下方有一排微字體(如圖2，為千
元鈔劵微字體的位置及放大圖)的防偽印
刷，是運用奈米光罩製程在鈔劵上製作微
字體，必須藉由放大鏡才能看見。一張鈔
劵擁有數十種安全防偽技術，然而從製造
鈔劵的紙張、油墨印刷的紋路、油墨顏色
的調理、安全防偽功能的設計、製版到印
4圖 3 鈔劵的圖案水印
相關係數法乃是計算待測影像與標準
影像的相關係數值，做為圖像相似度的指
標，若相關係數值＝1，則表示待測影像
與標準影像完全相同，若相關係數值＝
0，則表示待測影像與標準影像無任何的相
似處，由此可知相關係數值越大，代表待
測影像越相似於標準影像，反之亦然。若
),( yxPs 代表標準影像各點的像素值，設定
其標準影像視窗大小(mn)， su 為標準影像
的平均數(Mean)，其定義為：
su ＝  
1 1
=0 =0
1
,
n m
s
y x
P x y
m n
 
 （3）
同樣的對於待測影像 ),( yxPt 同樣取
(mn)的視窗大小，待測影像的平均值 tu ，
其定義為：
tu ＝  
1 1
=0 =0
1
,
n m
t
y x
P x y
m n
 
 （4）
待測影像與標準影像的相關係數值
，計算如下式：
＝    
   
1 1
=0 =0
1 1 1 1
2 2 2 2
=0 =0 =0 =0
, ,
, ,
n m
s t s t
y x
n m n m
s s t t
y x y x
P x y P x y m n u u
P x y m n u P x y m n u
 
   
    
          
  

 
(5）
其中 11   。
鈔劵經定位與影像校正後可取得各圖
案水印，進行相關係數計算。本研究經由
多樣實際測試正確圖案水印與瑕疵圖案水
印，決定出適合的相關係數門檻值
(Correlation Threshold)，由此便可判斷待測
圖案水印是否為正確圖像。
3.4瑕疵影像
本文在鈔劵安全防偽功能針對圖案水
印、數字水印(如圖 4，為千元鈔劵數字水
印的位置及放大圖)、窗式安全線(如圖 5，
為千元鈔劵圖窗式安全線的位置及放大圖)
的部份做檢測。
圖 4 鈔劵的數字水印
圖 5 鈔劵的窗式安全線
圖 6(a)為具正確圖案水印，可能的瑕
疵有圖 6(b)未印製到圖案水印、圖 6(c)印製
非正確圖案水印。
(a)正確圖案 (b)未印製 (c)非正確圖案
圖 6 鈔劵的圖案浮水印的正確及瑕疵圖
圖 7(a)為具正確數字水印，可能的瑕
疵有圖 7(b)未印製到數字水印、圖 7(c)數字
水印位置偏移、圖 7(d)數字水印歪斜、圖
7(e)數字水印的數字錯誤。
(a)正確圖案 (b)未印製 (c)位置偏移
(d)歪斜 (e)數字錯誤
圖 7 鈔劵的數字浮水印的正確及瑕疵圖
圖 8(a)為具正確窗式安全線，可能的
瑕疵有圖 8(b)未印製到安全線、圖 8(c)安全
線斷裂、圖 8(d)安全線位置偏移及圖 8(e)
安全線內部窗式框框數字有誤。
(a)正確圖案 (b)未印製 (c)斷裂
6體檢測的速度，另一方面也可以針對鈔劵
上想要檢測的某個防偽功能可能有瑕疵
而直接進行檢測。本系統各模組間有其檢
測順序，則是依據製程的先後來安排的，
其順序為圖案水印、數字水印、窗式安全
線、盲人線，最後則是光影變化箔膜，之
所以做此安排是為了達到節省開銷的目
的，系統未來的最終檢測模式將是每個製
程後就做一次檢測，只要檢測有瑕疵存在
便可將其剔除，而不需要再繼續接下來的
製程，以節省不必要的花費，不過目前現
階段系統是以鈔劵完成品（單張鈔劵）來
做檢測。
本文針對圖案水印、數字水印、
窗式安全線、盲人線及光影變化箔膜做瑕
疵檢測，分為五個檢測模組。
本研究共測試 85 張樣本，其中 35 張
正確無誤的鈔劵為標準樣本，另外自製 50
有瑕疵的鈔劵影像為測試樣本，分別針對
數字水印、圖案水印、窗式安全線、盲人
線及光影變化箔膜等項模組做實驗測試，
其測試之結果如表 1。
表 1 實驗測試結果
數量
檢測
成功數
檢測
失敗數
標準樣本 35 35 0
測試樣本 50 43 7
各檢測模組所花費的平均檢測時間
如表 2。
表 2 系統各模組檢測平均時間
平均時間(sec)
數字水印模組 0.461
圖案水印模組 2.57
窗式安全線模組 0.172
盲人線模組 0.078
光影變化箔膜模組 0.572
由系統測試結果可以發現，在測試樣
本中會發生把有瑕疵的鈔劵誤判成正確
鈔劵。由於系統在檢測都會給予一個合理
容許的誤差量，假若瑕疵的偏移量小於容
許誤差量時，就會被誤判成正確鈔劵，而
整個系統的設定的容許誤差量則是用實
際正確無誤的鈔劵統計出來的，由於盲人
線及窗式安全線寬的像素點定位切割後
變得相當的少，如果有些許的歪斜，經過
計算所得的長寬比則會在標準的誤差
內，加上窗式安全線其位置剛好與條碼水
印的防偽功能相疊，當進行影像分離時，
則無法完全將窗式安全線擷取出來，故會
造成誤判的現象。
五、結論與未來期許
本研究利用機器視覺技術針對鈔劵安
全防偽功能印製時進行瑕疵檢測，主要目
的是開發自動化光學瑕疵檢測機台，由此
取代國外檢測鈔劵的核心技術，並針對在
製程順序來區分優先檢測的模組，以減少
尋找瑕疵的時間增加效益。現階段只針對
安全防偽功能中的數字水印、圖案水印以
及窗式安全線、盲人線及光影變化箔膜來
做檢測。在光學瑕疵檢測方面，主要瑕疵
能分辨類型有未印製、斷裂、歪斜、偏移、
數字有誤，在 85 個樣本中(35 個標準樣
本、50 個測試樣本)會有 7 個誤判情況，
檢出成功率 91.8%，其中分析誤判的樣本
是在窗式安全線及盲人線的偏移及歪斜
部分，乃是由於盲人線及窗式安全線在
定位切割後，其像素點已經是相當的
少，如果有些許的歪斜，經過計算所得
的長寬比則會在標準的誤差內，加上窗
式安全線其位置剛好與條碼水印的防偽
功能相疊，當進行影像分離時，則無法
完全將窗式安全線擷取出來，故會造成
誤判的現象。而檢測的時間會因為各安全
防偽功能瑕疵的不同而有所差異，如果就
正確無誤的標準樣本來說，整體檢測時間
為 3.3~3.8 秒之間。
