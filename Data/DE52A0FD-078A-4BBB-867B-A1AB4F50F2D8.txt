 2
of multimode interference (MMI) devices based on the photonic wire. In the topic of the 
development and applications of the finite-difference time-domain (FDTD) method model, 
more general material dispersion models have been established for facilitating simulations of 
metallic structures, and the models have been applied to simulate and study various plasmonic 
and photonic-crystal problems. In the topic of the development of the pseudospectral 
frequency-domain (PSFD) method, a new formulation involving weak boundary-condition 
matching for waveguide analysis has been formulated and high numerical accuracy 
demonstrated, and a PSFD mode solver has been implemented with uniaxial PMLs for leaky 
waveguide analysis. Finally, in the topic of the applications of the established Legendre 
pseudospectral time-domain (PSTD) method model, light scattering by 2-D plasmonic 
nanoparticle square arrays and that by arrays of dielectric coated silver nanowires have been 
investigated and simulated with high accuracy. 
Keywords: Nanophotonics, Plasmonics, finite-difference frequency-domain method, finite- 
difference time-domain method, pseudo-spectral time-domain method, pseudo- 
spectral frequency method, optical waveguides, anisotropic waveguides, photonic 
crystals, surface plasmon waveguides 
This report contains many different topics. The Introduction, Research Purposes, 
Literature Survey, and Results and Discussion for each topic can be found in the 
corresponding Appendix. 
I. Development of the FDFD Method for Anisotropic Optical Waveguide Analysis 
We have developed a new finite-difference frequency-domain (FDFD) method based 
eigenvalue algorithm for analyzing anisotropic optical waveguides with an arbitrary 
permittivity tensor [1], [2]. Yee's mesh is employed in the FD formulation along with 
perfectly matched layer (PML) absorption boundary conditions. A standard eigenvalue 
matrix equation is successfully derived through considering simultaneously four transverse 
field components. The new algorithm is first applied to the mode solution of a 
proton-exchanged LiNbO3 optical waveguide and the results agree with those obtained using 
a full-vectorial finite-element beam propagation method. Then, the algorithm is used to study 
modes on a liquid-crystal optical waveguide with arbitrary molecular director orientation. 
This arbitrary orientation may cause the loss of transverse-axis symmetries of the waveguide 
with symmetric background structure. Asymmetric mode-field profiles under such situations 
are clearly demonstrated in the numerical examples. Guide modes on SiO2-Si V-groove 
filling with liquid crystal (LC) optical waveguide have also been solved and disscussed in [3]. 
Please refer to Appendix I [1] for the detail. 
II. FDFD Study of Terahertz Waveguides 
Most of current THz systems are large in size because of the usage of free space for THz 
wave propagation. The major difficulty for THz waveguiding is due to the lack of low-loss 
materials at the THz range, since there are strong absorption loss in dielectrics and high 
skin-depth loss in metals. To minimize the absorption loss occurring in dielectrics, it is 
popular to design waveguides with low power fraction within the lossy material and majority 
of the power transmitted through the air. One of current trends is the air-core type, which is 
essentially an air-core fiber surrounded by a structured cladding, and the THz wave is 
confined in the air-core region by successive reflections at the core-cladding interface. In this 
research, we collaborated with Prof. Chi-Kuang Sun and worked with a much simpler 
cladding structure, the tube waveguide [4], [5], [6]. The tube waveguide is simply a dielectric 
circular tube and is available from the pipe industry such as water or air pipes, and is a 
promising candidate for THz transmission. Modal characteristics of the THz tube waveguide 
 4
eigenvalue problem for computing guided band diagrams for the metal wire with 
sub-wavelength grooves. Both the effective dielectric slab mode guided between two grooves 
and the surface plasmon mode guided along the top and bottom of the grooves can be 
obtained [10]. The method has also been applied to analyze one-rod and two-row silver 
nanorod arrays [11]. The method has been generalized to the 3-D structures, including the 
3-D sub-wavelength slit arrays [12], [13], [14]. Please refer to Appendix VI [13] for the 
detail. 
VI. Development of a New Pseudo-Spectral Waveguide Mode Solver 
    In order to study eigenmode characteristics of optical waveguides with high accuracy, as 
demanded in the study of plasmonic waveguides, 2D waveguide mode solver is developed 
with new electromagnetic formulations that combine Maxwell's curl and divergence equations 
to derive the eigenvalue problem. New penalty-type boundary conditions are derived to work 
with new formulations, and the pseudo-spectral Legendre method is adopted to perform 
spatial discretization for its accurate approximation property. For a square dielectric 
waveguide, the calculated modal index is seen to converge to the order of 10−11. Please refer 
to Appendix VII [15] for the detail. 
    Furthermore, the previously developed full-vectorial optical waveguide eigenmode 
solvers using pseudospectral frequency-domain (PSFD) formulations for optical waveguides 
with arbitrary step-index profile is further implemented with the uniaxial perfectly matched 
layer (UPML) absorption boundary conditions for treating leaky waveguides and calculating 
their complex modal effective indices. The role of the UPML reflection coefficient in 
achieving high-accuracy mode solution results is particularly investigated. A six-air-hole 
microstructured fiber is analyzed as an example to compare with published high-accuracy 
multipole method results for both the real and imaginary parts of the effective indices. It is 
shown that by setting the UPML reflection coefficient values as small as on the order of 10−40 
~ 10−70, relative errors in the calculated complex effective indices can be as small as on the 
order of 10−12. Please refer to Appendix VIII [16] for the detail. 
VII. Electromagnetic Simulations of Plasmonic Problems Using the Legendre Pseudo- 
spectral Time-Domain Method 
We have applied the developed 3D Legendre pseudospectral time-domain (PSTD) scheme [17] to 
study optical properties of 2D plasmonic nanoparticle square arrays with different gap sizes [18], [19]. 
Since denser mesh grids appear near the interface, this high-accuracy numerical scheme is especially 
suited for dealing with metal-dielectric interfaces in plasmonics problems. Although most literatures 
used the Drude model to approach the dielectric constants of noble metals at optical frequencies, the 
deviation induced by the bound electrons is often obvious. In our study, the additional Lorentz terms 
are included in the material model to reduce such deviation. Such more precise Drude-Lorentz model 
provides a better material model and thus more accurate calculation in the wavelength region from 
visible to the near infrared. Please refer to Appendix IX [18] for the detail. 
We have used the multiple scattering method to calculate the extinction, scattering, and 
absorption cross sections for light scattering by finite arrays of dielectric coated silver 
nanowires in the 300–500-nm wavelength range, and observed the dependence on the number 
of nanowires in the array of the scattering properties. We have also analyzed the 
corresponding infinite arrays with different inter-nanowire gap widths using the PSTD 
scheme within one period of the array, and compared the scattering properties with those of a 
single nanowire. The redshift of the peak in the scattering cross section with reduced 
inter-nanowire gap width is observed, and the peak wavelengths for the gap widths of 5 nm 
and 25 nm are found to be consistent with those obtained in the finite arrays. Please refer to 
Appendix X [20] for the detail. 
 6
[10] M. Y. Chen and H. C. Chang, “Finite-Difference Frequency-Domain Method Analysis of Surface Plasmon 
Modes on Metal Wires with Sub-Wavelength Grooves,” in International Conference on Optics and 
Photonics in Taiwan ’08 (OPT ’08) Proceedings (CD-ROM), paper Fri-P1-109, Taipei, Taiwan, R.O.C., 
December 5–6, 2008.  
[11] M. Y. Chen and H. C. Chang, “Finite-Difference Frequency-Domain Method Analysis of Periodic 
Nano-Plasmonic Waveguides,” in Proceedings of the International Symposium on Antennas and 
Propagation (ISAP 2008) (CD-ROM), paper 1645307 (Session TP-B08) (4 pages), Taipei, Taiwan, R.O.C., 
October 27–30, 2008. 
[12] M. Y. Chen and H. C. Chang, “Dispersion Band Diagram Calculation for Periodic Nano-Plasmonic 
Waveguides Using a Finite-Difference Frequency-Domain Eigenmode Solver,” in Abstracts Book, 
PECS-VIII: The 8th International Photonic & Electromagnetic Crystal Structures Meeting (CD ROM), p. 
186 (paper 161), Sydney, Australia, April 5–9, 2009. 
[13] M. Y. Chen and H. C. Chang, “Finite-Difference Frequency-Domain Method Analysis of Surface Plasmon 
Modes on Three-Dimensional Sub-Wavelength Slit Arrays,” in Optics and Photonics Taiwan ’09 (OPT ’09) 
Proceedings (CD-ROM), paper BO125, Taipei, Taiwan, R.O.C., December11–12, 2009. 
[14] M. Y. Chen and H. C. Chang, “Determination of surface plasmon modes and guided modes supported by 
periodic subwavelength slits on metals using a finite-difference frequency-domain method based 
eigenvalue algorithm,” submitted for publication, 2011. 
[15] S. F. Chiang, B. Y. Lin, C. H. Teng, and H. C. Chang, “A Novel Pseudospectral Frequency-Domain 
Electromagnetic Formulation for Optical Waveguide Modes,” in OSA 2010 Integrated Photonics Research, 
Silicon and Nano Photonics (IPR 2010)  Technical Digest (CD ROM), paper IWH8 (3 pages), Monterey, 
California, July 25–28, 2010. 
[16] P. J. Chiang and H. C. Chang, “A High-Accuracy Pseudospectral Full-Vectorial Leaky Optical Waveguide 
Mode Solver with Carefully Implemented UPML Absorbing Boundary Conditions,” (OSA) Optics Express, 
Vol. 19, No. 2, pp. 1594–1608, 17 January 2011. 
[17] C. H. Teng, B. Y. Lin, H. C. Chang, H. C. Hsu, C. N. Lin, and K. A. Feng, “A Legendre Pseudospectral 
Penalty Scheme for Solving Time-Domain Maxwell’s Equations,” Journal of Scientific Computing, Vol. 
36, pp. 351–390, September 2008. 
[18] B. Y. Lin, C. H. Teng, and H. C. Chang, “Analysis of Optical Properties of 2D Ordered Plasmonic 
Nanoparticle Systems Using a 3D Pseudospectral Time-Domain Scheme,” in Proceedings of the 
International Symposium on Antennas and Propagation (ISAP 2008) (CD-ROM), paper 1645353 (Session 
TP-B06) (4 pages), Taipei, Taiwan, R.O.C., October 27–30, 2008. 
[19] B. Y. Lin, C. H. Teng, and H. C. Chang, “Electromagnetic Simulations of Nanophotonic Problems Using 
the Legendre Pseudospectral Time-Domain Method,” in The First International Workshop on Theoretical 
and Computational Nano-Photonics (TaCoNa-Photonics 2008) Abstract Booklet, p. 17, Bad Honnef, 
Germany, December 3–5, 2008. 
[20] B. Y. Lin and H. C. Chang, “Analysis of Dielectric-Coated Metallic Nanowire Arrays by the Multiple 
Scattering Method and a Pseudospectral Time-Domain Scheme,” in Proceedings of the 2nd International 
Workshop on Theoretical and Computational Nanophotonics (TaCoNa-Photonics 2009) (AIP Conference 
Proceedings 1176), pp. 121–123, Bad Honnef, Germany, October 28–30, 2009. 
[21] C. H. Lai, C. K. Sun, and H. C. Chang, “Investigations of Subwavelength-Fiber Based THz Couplers,” in 
Optics and Photonics Taiwan ’09 (OPT ’09) Proceedings (CD-ROM), paper BO136, Taipei, Taiwan, 
R.O.C., December11–12, 2009. 
[22] Y. S. Pai and H. C. Chang, “Design of Silicon-on-Insulator Photonic Wire Multimode-Interference 1 x 2 
Power Splitters,” in Optics and Photonics Taiwan ’09 (OPT ’09) Proceedings (CD-ROM), paper BP037, 
Taipei, Taiwan, R.O.C., December11–12, 2009. 
 
 
8. T. Ando, H. Nakayama, S. Numata, J. Yamauchi, and H. Nakano, “Eigenmode analysis of optical waveguides
by a Yee-mesh-based imaginary-distance propagation method for an arbitrary dielectric interface,” J. Lightwave
Technol. 20, 1627–1634 (2002).
9. Z. Zhu and T. G. Brown, “Full-vectorial finite-difference analysis of microstructured optical fibers,” Opt. Express
10, 853–864 (2002). http://www.opticsexpress.org/abstract.cfm?URI=OPEX-10-17-853.
10. C. P. Yu, and H. C. Chang, “Yee-mesh-based finite difference eigenmode solver with PML absorbing bound-
ary conditions for optical waveguides and photonic crystal fibers,” Opt. Express, 12, 6165V-6177 (2004).
http://www.opticsinfobase.org/abstract.cfm?URI=oe-12-25-6165.
11. L. Thylen and D. Yevick, “Beam propagation method in anisotropic media,” Appl. Opt. 21, 2751–2754 (1982).
12. C. L. Xu, W. P. Huang, J. Chrostowski, and S. K. Chaudhuri, “A full-vectorial beam propagation method for
anisotropic waveguides,” J. Lightwave Technol. 12, 1926–1931 (1994).
13. C. L. D. S. Sobrinho and A. J. Giarola, “Analysis of biaxially anisotropic dielectric waveguides with Gaussian-
Gaussian index of refraction profiles by the finite-difference method,” IEE Proc.-H 140, 224–230 (1993).
14. P. Lu¨sse, K. Ramm, and H.-G. Unger, “Vectorial eigenmode calculation for anisotropic planar optical waveg-
uides,” Electron. Lett. 32, 38–39 (1996).
15. A. B. Fallahkhair, K. S. Li, and T. E. Murphy, “Vector finite difference modesolver for anisotropic dielectric
waveguides,” J. Lightwave Technol. 26, 1423–1431 (2008).
16. K. Saitoh, and M. Koshiba, “Full-vectorial finite element beam propagation method with perfectly matched layers
for anisotropic optical waveguides,” J. Lightwave Technol. 19, 405–413 (2001).
17. F. L. Teixeira and W. C. Chew, “General closed-form PML constitutive tensors to match arbitrary bianisotropic
and dispersive linear media”, IEEE Microwave Guid. Wave Lett. 8, 223V-225 (1998).
18. R. Mittra and U. Pekel, “A new look an the perfectly matched layer PML concept for the reflectionless absorption
of electromagnetic waves,” IEEE Microwave Guid. Wave Lett. 5, 84–86 (1995).
19. P. Yeh and C. Gu, Optics of Liquid Crystal Displays (John Wiley and Sons, Inc., New York, 1999).
1. Introduction
Solving full-vector modes of optical waveguides has been an essential task in developing and
designing state-of-the-art waveguide devices and lightwave circuits. Among different numerical
solution methods, the finite-difference (FD) method is attractive due to its advantage of simple
formulation and numerical implementation. The FD algorithm can be formulated either through
the wave equations [1] or the Helmholtz equation [2]. Also high-accuracy algorithms have been
pursued [3–6]. Besides the traditional approach in which either the electric field components
or the magnetic field components are considered at grid points, such as in the above-mentioned
algorithms, schemes based on the Yee’s mesh, as in the finite-difference time-domain (FDTD)
method [7], and derived directly from Maxwell’s equations have been formulated [8–10]. Such
schemes have the advantage that the obtained mode fields can easily be cast into the FDTD com-
putation. We name such Yee-mesh-based FD approach the finite-difference frequency-domain
(FDFD) method.
Relatively fewer FD works deal with structures including anisotropic materials [11–14]
and they at most considered anisotropy in the transverse plane, i.e., in the waveguide cross-
section. Most recently, Fallahkhair et al. [15] developed a more rigorous vector FD mode solver
based on the traditional approach for anisotropic waveguides, but again assuming non-diagonal
anisotropy only in the transverse plane. In this paper, we present an FDFD method for solv-
ing full-vector modes of optical waveguides with arbitrary permittivity tensor, i.e., with gen-
eral three-dimensional (3-D) anisotropy. In the finite-element formulations, mode solutions for
such general waveguides have been reported by Saitoh and Koshiba [16] but based on the beam
propagation approach. Here, we derive a matrix standard eigenvalue problem from the FDFD
method, which is easier to solve for the modes. As in [16], we incorporate perfectly matched
layers (PMLs) for anisotropic media [17] into our formulation as the absorbing boundary condi-
tion at the outer boundaries of the computational domain. In so doing, leaky waveguide modes
having complex propagation constants can also be analyzed.
After presenting the derivation of the new eigenmode solution algorithm in Section 2, nu-
merical examples are presented in Section 3. The algorithm is first applied to solve a proton-
#106781 - $15.00 USD Received 28 Jan 2009; revised 18 Mar 2009; accepted 18 Mar 2009; published 30 Mar 2009
(C) 2009 OSA 13 April 2009 / Vol. 17,  No. 8 / OPTICS EXPRESS  5966
− jωμxHx =∂Ez∂y + jβEy (3)
− jωμyHy =− jβEx− ∂Ez∂x (4)
− jωμzHz =∂Ey∂x −
∂Ex
∂y (5)
jωDx =∂Hz∂y + jβHy (6)
jωDy =− jβHx− ∂Hz∂x (7)
jωDz =∂Hy∂x −
∂Hx
∂y . (8)
Applying the Yee’s mesh, as depicted in Fig. 2, and the central difference scheme, Eqs (3)–(8)
become
− jωμxHx,(i, j+ 12 ) =
Ez,(i, j+1)−Ez,(i, j)
y + jβEy,(i, j+ 12 ) (9)
− jωμyHy,(i+ 12 , j) =− jβEx,(i+ 12 , j)−
Ez,(i+1, j)−Ez,(i, j)
x (10)
− jωμzHz,(i+ 12 , j+ 12 ) =
Ey,(i+1, j+ 12 )−Ey,(i, j+ 12 )
x −
E
x,(i+ 12 , j+1)−Ex,(i+ 12 , j)
y (11)
jωD
x,(i+ 12 , j) =
Hz,(i+ 12 , j+ 12 )−Hz,(i+ 12 , j− 12 )
y + jβHy,(i+ 12 , j) (12)
jωDy,(i, j+ 12 ) =− jβHx,(i, j+ 12 )−
Hz,(i+ 12 , j+ 12 )−Hz,(i− 12 , j+ 12 )
x (13)
jωDz,(i, j) =
Hy,(i+ 12 , j)−Hy,(i− 12 , j)
x −
H
x,(i, j+ 12 )−Hx,(i, j− 12 )
y (14)
which can be written in the matrix form as
− jωμ0
⎡
⎣
μxHx
μyHy
μzHz
⎤
⎦ =
⎡
⎣
0 jβ I Uy
− jβ I 0 −Ux
−Uy Ux 0
⎤
⎦
⎡
⎣
Ex
Ey
Ez
⎤
⎦ (15)
jω
⎡
⎣
Dx
Dy
Dz
⎤
⎦ =
⎡
⎣
0 jβ I Vy
− jβ I 0 −Vx
−Vy Vx 0
⎤
⎦
⎡
⎣
Hx
Hy
Hz
⎤
⎦ . (16)
In Eqs. (15)–(16), I is the identity matrix, Ux, Uy, Vx and Vy are the matrices given as below
Ux =
1
x
⎡
⎢⎢⎢⎢⎢⎢⎢⎢⎣
−1 1
−1 1
.
.
.
.
.
.
.
.
.
.
.
.
−1 1
−1
⎤
⎥⎥⎥⎥⎥⎥⎥⎥⎦
(17)
#106781 - $15.00 USD Received 28 Jan 2009; revised 18 Mar 2009; accepted 18 Mar 2009; published 30 Mar 2009
(C) 2009 OSA 13 April 2009 / Vol. 17,  No. 8 / OPTICS EXPRESS  5968
and (i, j), respectively, which are the locations of Dx, Dy, and Dz, respectively. By substituting
the Hz and Ez expressions from Eqs. (26) and (29), respectively, into Eqs. (24), (25), (27), and
(28), an eigenvalue matrix equation for the four transverse field components can be derived as
in the following form:
β
⎡
⎢⎢⎣
Ex
Ey
Hx
Hy
⎤
⎥⎥⎦ =
⎡
⎢⎢⎣
A11 A12 A13 A14
A21 A22 A23 A24
A31 A32 A33 A34
A41 A42 A43 A44
⎤
⎥⎥⎦
⎡
⎢⎢⎣
Ex
Ey
Hx
Hy
⎤
⎥⎥⎦ (30)
where the sub-matrices Aij (i, j = 1, · · · ,4) are defined as below:
A11 =− j
(
εzx
εzz
)
Ux (31)
A12 =− j
(
εzy
εzz
)
Ux (32)
A13 =−
(
1
ωεzz
)
UxVy (33)
A14 =
(
1
ωεzz
)
UxVx +ωμyI (34)
A21 =− j
(
εzx
εzz
)
Uy (35)
A22 =− j
(
εzy
εzz
)
Uy (36)
A23 =−
(
1
ωεzz
)
UyVy−ωμxI (37)
A24 =
(
1
ωεzz
)
UyVx (38)
A31 =−ωεyxI+
(
1
ωμz
)
VxUy +
εyzωεzx
εzz
I (39)
A32 =−ωεyyI−
(
1
ωμz
)
VxUx +
εyzωεzy
εzz
I (40)
A33 =− j
(
εyz
εzz
)
Vy (41)
A34 = j
(
εyz
εzz
)
Vx (42)
A41 =ωεxxI+
(
1
ωμz
)
VyUy− εxzωεzx
εzz
I (43)
A42 =ωεxyI−
(
1
ωμz
)
VyUx− εxzωεzy
εzz
I (44)
A43 = j
(
εxz
εzz
)
Vy (45)
A44 =− j
(
εxz
εzz
)
Vx. (46)
For the considered problem involving non-diagonal permittivity tensor, we adopt the more
general PML for anisotropic media proposed by Teixeira and Chew [17] as the absorbing
#106781 - $15.00 USD Received 28 Jan 2009; revised 18 Mar 2009; accepted 18 Mar 2009; published 30 Mar 2009
(C) 2009 OSA 13 April 2009 / Vol. 17,  No. 8 / OPTICS EXPRESS  5970
Fig. 3. Computational domain and structure parameters for the LN waveguide with PE-LN
core.
Fig. 4. Calculated effective index as a function of the crystal angle for the LN waveguide
of Fig. 3.
are seen to agree very well with the solid line obtained using the FE-BPM method. The effective
index is defined as β/[ω(μ0ε0)1/2]. Compared with the BPM, the developed standard eigen-
value algorithm has the advantage of directly obtaining solutions from available eigenvalue
matrix equation solvers without needing to examine the dependence of numerical convergence
on the beam propagation distance [16]. For the case of θc = 50◦, we plot the calculated effec-
tive index versus the FDFD grid size Δx = Δy in Fig. 5. It is seen that with Δx = Δy = 0.4 μm
the calculated effective index has reaches three converged digits after the decimal point. The
number of field-component unknowns corresponding to Δx = Δy = 0.4 μm is 1904, and the
computation time based on an Intel Core 2 Duo 1.86-GHz personal computer is 11.24 seconds.
When Δx = Δy is reduced to 0.05 μm, the number of unknowns increases to 114400 and the
computation time becomes 908.3 seconds. Please note that in this work we use the simple
stair-case approximation for modelling the permittivity discontinuity across the dielectric inter-
face. As studied in [10], for the grid sizes used here, the numerical accuracy in the calculated
effective index could be at most on the order of 10−4 under such approximation. To improve the
numerical accuracy, more elaborate treatment of the field continuity conditions across the inter-
face, such as the index-averaging scheme or the proper boundary-condition matching scheme,
as detailed in [10], could be employed. Since the main goal in this work is to provide a solu-
tion method for analyzing waveguides with a more general permittivity characteristic, and for
practical application purposes, the above-mentioned accuracy would be good enough, the issue
of further numerical accuracy improvement will not be investigated. The mode-field profiles of
#106781 - $15.00 USD Received 28 Jan 2009; revised 18 Mar 2009; accepted 18 Mar 2009; published 30 Mar 2009
(C) 2009 OSA 13 April 2009 / Vol. 17,  No. 8 / OPTICS EXPRESS  5972
Fig. 8. Schematic definition of rotation angles for the LC molecular or director.
Fig. 9. |Ex| and |Ey| mode-field profiles for modes 1 and 2 of the LC waveguide with
θc = 0◦.
relative permittivity tensor of the nematic LCs are given as
εxx/ε0 =n2o +(n
2
e −n2o)sin2θc cos2φc (56)
εxy/ε0 =εyx = (n2e −n2o)sin2θc sinφc cosφc (57)
εxz/ε0 =εzx = (n2e −n2o)sinθc cosθc cosφc (58)
εyy/ε0 =n2o +(n
2
e −n2o)sin2θc cos2φc (59)
εyz/ε0 =εzy = (n2e −n2o)sinθc cosθc sinφc (60)
εzz/ε0 =n2o +(n
2
e −n2o)cos2θc (61)
where no = 1.5292 and ne = 1.7072 are, respectively, the ordinary and extraordinary refractive
indices of the nematic LCs, θc is the angle between the crystal c-axis and the z-axis, and φc is
the angle between the projection of the crystal c-axis on the x-y plane and the x-axis, as defined
in Fig. 8. The waveguide and computational-domain parameters, w, t, Wx, Wy, and d, shown
in Fig. 7, are considered to possess the same values as in the above LN waveguide case. The
wavelength is taken to be 1.55μm.
Based on the fact that the LC molecules can be rotated through an applied voltage on suitably
designed electrodes, making the change of the permittivity tensor in the LC-core region, we
calculate and investigate the guided modes under different LC-rotated situations. We consider
θc = 0◦, 30◦, 60◦, and 90◦, and at each θc the angle φc is varied from 0◦ to 90◦.
For θc = 0◦, it is obvious that different φc’s correspond to the same situation and we obtain
two modes with the effective indices of 1.504400 (mode 1) and 1.504382 (mode 2). Note that
no spurious-mode problem was encountered in the analysis, including the situations to be dis-
cussed in the following. The mode-field profiles of the moduli of the two transverse electric
field phasor components, |Ex| and |Ey|, for the two modes are shown in Fig. 9. The presentation
#106781 - $15.00 USD Received 28 Jan 2009; revised 18 Mar 2009; accepted 18 Mar 2009; published 30 Mar 2009
(C) 2009 OSA 13 April 2009 / Vol. 17,  No. 8 / OPTICS EXPRESS  5974
Fig. 12. Calculated effective indices versus φc for the first seven modes of the LC waveguide
with θc = 60◦.
Fig. 13. |Ex| and |Ey| mode-field profiles for the first four modes of the LC waveguide with
θc = 60◦ at φc = 0◦, 30◦, 60◦, and 90◦.
The calculated effective indices for different φc’s for the obtained four modes are shown in Fig.
10. The |Ex| and |Ey| profiles of these four modes for φc = 0◦, 30◦, 60◦, and 90◦ are illustrated
in Fig. 11. Except for φc = 90◦, which corresponds to both structure geometry and permittivity
tensor symmetries, the field profiles appear to possess asymmetric characteristics of various
degrees. For mode 1, it is almost x-polarized at φc = 0◦ and 30◦, and changes to be almost y-
polarized at φc = 60◦ and 90◦. For modes 2 and 3, the |Ex| component is more significant than
the |Ey| component at φc = 0◦ and 30◦, and the |Ey| component becomes more significant than
the |Ex| component at φc = 60◦ and 90◦. For mode 4, such polarization significance situation
reverses at the corresponding φc’s.
The results for θc = 60◦ are given in Figs. 12–14. Seven modes are obtained as seen in Fig.
#106781 - $15.00 USD Received 28 Jan 2009; revised 18 Mar 2009; accepted 18 Mar 2009; published 30 Mar 2009
(C) 2009 OSA 13 April 2009 / Vol. 17,  No. 8 / OPTICS EXPRESS  5976
Fig. 16. |Ex| and |Ey| mode-field profiles for the first four modes of the LC waveguide with
θc = 90◦ at φc = 0◦, 30◦, 60◦, and 90◦.
Fig. 17. |Ex| and |Ey|mode-field profiles for modes 5–7 of the LC waveguide with θc = 90◦
at φc = 0◦, 30◦, 60◦, and 90◦.
#106781 - $15.00 USD Received 28 Jan 2009; revised 18 Mar 2009; accepted 18 Mar 2009; published 30 Mar 2009
(C) 2009 OSA 13 April 2009 / Vol. 17,  No. 8 / OPTICS EXPRESS  5978
Modal characteristics of antiresonant reflecting 
pipe waveguides for terahertz waveguiding 
Chih-Hsien Lai,1,2 Borwen You,3 Ja-Yu Lu,3 Tze-An Liu,4 Jin-Long Peng,4 
Chi-Kuang Sun,1,5,6 and Hung-chun Chang1,5,7,* 
1Graduate Institute of Photonics and Optoelectronics, National Taiwan University, Taipei, 10617, Taiwan 
2Department of Electronic Engineering, Hwa Hsia Institute of Technology, Taipei, 23568, Taiwan 
3Institue of Electro-Optical Science and Engineering and Advanced Optoelectronic Technology Center,  
National Cheng Kung University, Tainan, 701, Taiwan 
4Center for Measurement Standards, Industrial Technology Research Institute, Hsinchu, 30011, Taiwan  
5Department of Electrical Engineering, National Taiwan University, Taipei, Taiwan 10617, Taiwan 
6Research Center for Applied Sciences, Academia Sinica, Taipei, 115, R.O.C. 
7Graduate Institute of Communication Engineering, National Taiwan University, Taipei, 10617, Taiwan 
*hcchang@cc.ee.ntu.edu.tw 
Abstract: Modal characteristics of the THz pipe waveguide, which is a thin 
pipe consisting of a large air core and a thin dielectric layer with uniform 
but low index, are investigated. Modal indices and attenuation constants are 
calculated for various core diameters, cladding thicknesses, and cladding 
refractive indices. Numerical results reveal that the guiding mechanism of 
the leaky core modes, which transmit most of the power in the air-core 
region, is that of the antiresonant reflecting guiding. Moreover, modal 
patterns including modal intensity distributions and electric field vector 
distributions are shown for the fundamental and higher order modes. 
Experiments using time-domain spectroscopy with PMMA pipes also 
confirm the antiresonant reflecting guiding mechanism. 
©2009 Optical Society of America 
OCIS codes: (130.2790) Guided waves; (230.7370) Waveguides; (260.2110) Electromagnetic 
optics; (999.9999) Terahertz waveguides. 
References and links 
1. M. Tonouchi, “Cutting-edge terahertz technology,” Nat. Photonics 1(2), 97–105 (2007). 
2. D. Abbott, and X.-C. Zhang, “Scanning the issue: T-ray imaging, sensing, and retection,” Proc. IEEE 95(8), 
1509–1513 (2007). 
3. G. Gallot, S. P. Jamison, R. W. McGowan, and D. Grischkowsky, “Terahertz waveguides,” J. Opt. Soc. Am. B 
17(5), 851–863 (2000). 
4. R. Mendis, and D. Grischkowsky, “Undistorted guided-wave propagation of subpicosecond terahertz pulses,” 
Opt. Lett. 26(11), 846–848 (2001). 
5. K. Wang, and D. M. Mittleman, “Metal wires for terahertz wave guiding,” Nature 432(7015), 376–379 (2004). 
6. R. Mendis, and D. Grischkowsky, “Plastic ribbon THz waveguides,” J. Appl. Phys. 88(7), 4449–4451 (2000). 
7. H. Han, H. Park, M. Cho, and J. Kim, “Terahertz pulse propagation in a plastic photonic crystal fiber,” Appl. 
Phys. Lett. 80(15), 2634–2636 (2002). 
8. M. Goto, A. Quema, H. Takahashi, S. Ono, and N. Sarukura, “Teflon photonic crystal fiber as terahertz 
waveguide,” Jpn. J. Appl. Lett. 43(No. 2B), L317–L319 (2004). 
9. L.-J. Chen, H.-W. Chen, T.-F. Kao, J.-Y. Lu, and C.-K. Sun, “Low-loss subwavelength plastic fiber for terahertz 
waveguiding,” Opt. Lett. 31(3), 308–310 (2006). 
10. H.-W. Chen, C.-M. Chiu, C.-H. Lai, J.-L. Kuo, P.-J. Chiang, Y.-J. Hwang, H.-C. Chang, and C.-K. Sun, 
“Subwavelength dielectric-fiber-based THz coupler,” J. Lightwave Technol. 27(11), 1489–1495 (2009). 
11. J. A. Harrington, R. George, P. Pedersen, and E. Mueller, “Hollow polycarbonate waveguides with inner Cu 
coatings for delivery of terahertz radiation,” Opt. Express 12(21), 5263–5268 (2004), 
http://www.opticsinfobase.org/oe/abstract.cfm?URI=OPEX-12-21-5263. 
12. B. Bowden, J. A. Harrington, and O. Mitrofanov, “Silver/polystyrene-coated hollow glass waveguides for the 
transmission of terahertz radiation,” Opt. Lett. 32(20), 2945–2947 (2007). 
13. T. Ito, Y. Matsuura, M. Miyagi, H. Minamide, and H. Ito, “Flexible terahertz fiber optics with low bend-induced 
losses,” J. Opt. Soc. Am. B 24(5), 1230–1235 (2007). 
14. T. Hidaka, H. Minamide, H. Ito, J.-I. Nishizawa, K. Tamura, and S. Ichikawa, “Ferroelectric PVDF cladding 
terahertz waveguide,” J. Lightwave Technol. 23(8), 2469–2473 (2005). 
15. M. Skorobogatiy, and A. Dupuis, “Ferroelectric all-polymer hollow Bragg fibers for terahertz guidance,” Appl. 
Phys. Lett. 90(11), 113514 (2007). 
(C) 2010 OSA 4 January 2010 / Vol. 18,  No. 1 / OPTICS EXPRESS  309
#118829 - $15.00 USD Received 21 Oct 2009; revised 16 Dec 2009; accepted 16 Dec 2009; published 23 Dec 2009
Recently, the low-index pipe waveguide was proposed and experimentally demonstrated 
for THz waveguiding [19]. Much different from all previously reported air-core THz 
waveguides which bear high reflection materials or periodic dielectric structures to provide 
high cladding reflection, structure of the THz pipe waveguide is very simple and it is only a 
thin pipe consisting of a large air core (with a diameter greater than the wavelength) and a thin 
dielectric layer (with a thickness much smaller than the core diameter) with uniform but low 
index. The pipe waveguide is also different from the one utilizing low-index discontinuity 
[20], in which a subwavelength air core as well as a small air-core-diameter to cladding-
thickness ratio are assumed and the THz waves are guided by the mechanism of total internal 
reflection (TIR). Guiding mechanism of the pipe waveguide is similar to that of the 
antiresonant reflecting optical waveguide (ARROW) [21], but is realized with a single low-
index dielectric layer. Using commercially available Teflon air pipes up to 3 meters long as 
the example pipe waveguides, it was experimentally confirmed that THz waves can be 
successfully guided in the central air core with excellent mode qualities, high coupling 
efficiency (as high as 80%), and controllable bandwidth, while the measured attenuation 
constants can be as low as 0.0008 cm−1 [19]. 
Similar pipe structure has ever been seen for infrared (IR) transmission and the leakage 
loss has been approximately estimated [22,23]. Besides, it has been pointed out that in similar 
but more complicated photonic bandgap (PBG) optical waveguides, the guiding mechanism 
could be PBG guiding or antiresonant reflecting guiding [24–26]. However, no detailed modal 
analysis giving modal patterns, modal indices, and attenuation constants, which are important 
for waveguide applications, were conducted for the pipe waveguides in the above-mentioned 
works, especially for THz band. 
In this paper, we focus on the theoretical aspect of the THz pipe waveguides, by 
illustrating the guiding mechanism and providing the modal analysis. Modal characteristics of 
the pipe waveguides are numerically investigated by the finite-difference frequency-domain 
(FDFD) mode solver [27]. Modal indices and attenuation constants of the leaky core modes 
are calculated for various core diameters, cladding thicknesses, and cladding refractive 
indices. Results are compared with the resonance-frequency formula derived from the Fabry-
Perot etalon and the antiresonant reflecting guiding mechanism is theoretically indentified. 
The effect of material absorption is then examined. Modal patterns of the fundamental mode 
and several higher-order modes are also presented. At last, through the experiments utilizing 
time-domain spectroscopy [28,29] with PMMA (polymethylmethacrylate) pipes, the guiding 
mechanism of the THz pipe waveguides is experimentally confirmed to be that of the 
antiresonant reflecting guiding. A ray-optics analysis is provided in the appendix, which 
shows consistency with the FDFD simulations. 
2. Guiding mechanism of the core modes 
Transverse cross-section of the pipe waveguide is shown in Fig. 1(a). It has a large air-core 
(n1 = 1) with diameter D and a thin ring cladding with thickness t. The medium outside the 
cladding is also the air. Material of the cladding is assumed to be dielectric with a uniform 
low refractive index n2. 
The pipe waveguide supports cladding modes for which fields are confined within the 
cladding region. These modes are guided based on the TIR owing to the higher refractive 
index of the cladding. However, the cladding modes attenuate rapidly since high material 
absorption losses are encountered. Alternatively, the pipe waveguide also supports core 
modes 
(C) 2010 OSA 4 January 2010 / Vol. 18,  No. 1 / OPTICS EXPRESS  311
#118829 - $15.00 USD Received 21 Oct 2009; revised 16 Dec 2009; accepted 16 Dec 2009; published 23 Dec 2009
specified, we assume the parameters of the pipe waveguide are: core diameter D = 9 mm, 
cladding thickness t = 1 mm, and cladding refractive index n2 = 1.4. Modal index and 
attenuation constant of the guided core mode are defined as Re(β)/k0 and −2Im(β), 
respectively, where β is the complex propagation constant and k0 is the free-space 
wavenumber. Numerical results are obtained utilizing the FDFD mode solver [27]. For the 
calculations, the computational window size is 14 mm by 14 mm, the grid size is ∆x = ∆y = 
0.025 mm, and the perfectly matched layer (PML) is placed at the outmost to surround the 
computational window [27]. 
We first investigate the effect of core diameter by considering D = 7 mm and 9 mm, 
respectively. Modal indices and attenuation constants of the fundamental (the lowest) core 
mode are shown in Figs. 2(a) and 2(b), respectively. It is observed that there are 
discontinuities in Fig. 2 and the discontinuity frequencies repeat periodically. At these 
frequencies, no core modes can be found by the mode solver, and fields of the obtained 
guided modes are confined either almost or at least with a significant ratio in the cladding. 
Substituting m = 2, 3, 4, and 5 into Eq. (2), the obtained resonant frequencies are 306, 459, 
612, and 765 GHz, respectively, which coincide with the discontinuity frequencies in Fig. 2. 
In fact, the discontinuities correspond to the resonance conditions of the cladding under which 
core modes of the pipe waveguide do not exist [26]. It is obvious that the discontinuity 
frequencies are independent of the core diameter, which can also be implied from Eq. (2). 
 
Fig. 2. (a) Modal indices and (b) attenuation constants of the fundamental core mode of the 
pipe waveguide for D = 7 mm and 9 mm. 
Just as in the conventional microwave hollow-core metallic waveguides where Re(β) < k0, 
Re(β)’s of the leaky core modes in the pipe waveguide are smaller than k0, leading to modal 
index, which is defined to be Re(β)/k0, being less than 1, as can be seen in Fig. 2(a). The 
incident angle θ1 at the core-cladding interface shown in Fig. 1(b) can be derived from the 
modal index by taking the inverse sine operation. For example, from Fig. 2(a), modal index 
for the D = 9 mm structure is from 0.9910 to 0.9996, meaning that θ1 is from 82.3° to 88.4°, 
which confirms glancing reflections assumed previously in deriving Eq. (2). From the trend of 
the modal index shown in Fig. 2(a), it can be interpreted that the incident angle θ1 is larger for 
higher frequencies and larger core diameters. 
From Fig. 2(b), the attenuation constant of the D = 9 mm structure is found to be smaller 
than that of the D = 7 mm one. That is to say, pipe waveguides with larger core diameter 
suffer less waveguide losses. This is reasonable and can be explained as follows. For pipe 
waveguides with larger core diameter, the distance between two consecutive reflections at the 
core-cladding interface is larger than that of the waveguides with smaller core diameter. 
Moreover, the more important is, as mentioned above, larger core diameter results in larger 
θ1, i.e., the wave propagates more parallel to the core-cladding interface. Therefore, there are 
not only less number of reflections under the same waveguide length but also higher 
(C) 2010 OSA 4 January 2010 / Vol. 18,  No. 1 / OPTICS EXPRESS  313
#118829 - $15.00 USD Received 21 Oct 2009; revised 16 Dec 2009; accepted 16 Dec 2009; published 23 Dec 2009
 Fig. 4. (a) Modal indices and (b) attenuation constants of the fundamental core mode of the 
pipe waveguide for n2 = 1.4 and 1.6. 
Previous discussions assume that the refractive index of the cladding is real. In other 
words, material absorption is not considered. Here, the effect of material absorption is 
examined by assuming the refractive index of the cladding is n2 = 1.4 – j0.0015. Modal 
indices and attenuation constants obtained with and without material absorption are shown in 
Figs. 5(a) and 5(b), respectively. Figure 5(a) shows that modal indices are practically 
unaffected under such material absorption. As for the attenuation constants, the effect of 
material absorption is not obvious in the lower frequency region (e.g., lower than 400 GHz), 
as can be seen from Fig. 5(b). However, as the frequency increases, the attenuation constant 
magnitude will be increased and the increment is more significant at higher frequencies. 
 
Fig. 5. (a) Modal indices and (b) attenuation constants of the fundamental core mode of the 
pipe waveguide obtained with and without material absorption. 
4. Modal patterns of the fundamental and higher order modes 
The first twelve lowest guiding modes of the pipe waveguide are solved at the frequency of 
380 GHz. Figure 6 shows the loci of the complex propagation constant β normalized to k0 of 
the twelve lowest modes. Mode numbers are labeled according to the ranking of the modal 
index, i.e., Re(β)/k0. Note that the imaginary part of the complex propagation constant is 
negative. Hence the larger the Im(β)/k0 of the guiding mode is, the smaller the attenuation 
constant will be. It is clear the lowest mode (mode 1), or the fundamental mode, has the 
smallest attenuation constant at the simulated frequency and it becomes the dominant mode 
for the pipe waveguide investigated here. 
(C) 2010 OSA 4 January 2010 / Vol. 18,  No. 1 / OPTICS EXPRESS  315
#118829 - $15.00 USD Received 21 Oct 2009; revised 16 Dec 2009; accepted 16 Dec 2009; published 23 Dec 2009
 Fig. 7. (a) Modal intensity distributions and (b) electric field vector distributions of the first 
twelve lowest modes of the pipe waveguide at 380GHz. 
(C) 2010 OSA 4 January 2010 / Vol. 18,  No. 1 / OPTICS EXPRESS  317
#118829 - $15.00 USD Received 21 Oct 2009; revised 16 Dec 2009; accepted 16 Dec 2009; published 23 Dec 2009
also shown for comparison. It is clear that the transmission minima and the resonant 
frequencies match very well, indicating that guiding mechanism of the pipe waveguides is 
indeed that of antiresonant reflecting guiding. At the resonant frequencies, transmissions 
significantly drop because there are no core modes to deliver the THz powers. Note that the 
two absorption peaks of water vapor, 558 GHz and 753 GHz [32], can also be observed in 
Fig. 10, as pointed out by arrows. 
 
Fig. 10. Normalized transmission spectra (solid lines) of the PMMA pipes with (a) D = 8 mm 
and t = 1.0 mm and (b) D = 4 mm and t = 2.0 mm. Resonant frequencies of the cladding 
(dotted lines) obtained from Eq. (2) are also shown for comparison. The arrows correspond to 
the frequencies of the absorption peaks of water vapor. 
6. Conclusion 
The pipe waveguide is promising for THz waveguiding owning to its low-loss feature and 
simple structure. In this paper, modal characteristics of the leaky core modes of the pipe 
waveguide are investigated in the THz range. Utilizing the FDFD mode solver, modal indices 
and attenuation constants of the core modes which are frequency dependent are calculated for 
different core diameters, cladding thicknesses, and cladding refractive indices. It is found that 
at certain frequencies no core modes can exist. Comparing these frequencies with the resonant 
frequencies of the cladding reveals that the guiding mechanism of the core modes is that of 
the antiresonant reflecting guiding. Calculated results also suggest that, to have a low-loss and 
high-bandwidth pipe waveguide, large core diameter, thin cladding thickness, and low 
refractive index are desired. The effect of material absorption is also examined, which shows 
that the attenuation constant magnitude will be increased and the increment is more 
significant at higher frequencies. Moreover, modal patterns are shown for the fundamental 
mode and the higher order modes, including modal intensity distributions and electric field 
vector distributions. It is observed that modal patterns of the core modes of the pipe 
waveguide resemble those of the guided modes of the step-index fiber. From the spectrum of 
the attenuation constant, it shows that the fundamental mode (HE11-like) has the smallest 
attenuation constant and is the dominant mode for the pipe waveguide investigated. Using 
time-domain spectroscopy to measure the transmission spectra of PMMA pipes, guiding 
mechanism of the pipe waveguides was experimentally confirmed to be that of antiresonant 
reflecting guiding. 
Appendix 
In previous sections, the attenuation constants of the pipe waveguides, defined as −2Im(β), are 
obtained directly from the FDFD mode solver [27]. In this appendix, we show that the 
attenuation constants are consistent with those obtained by an alternative approach in which 
the derivation starts from the modal indices, i.e., Re(β)/k0. 
(C) 2010 OSA 4 January 2010 / Vol. 18,  No. 1 / OPTICS EXPRESS  319
#118829 - $15.00 USD Received 21 Oct 2009; revised 16 Dec 2009; accepted 16 Dec 2009; published 23 Dec 2009
where L is the propagation distance, R is the reflectivity, and N is the number of 
reflections at the core-cladding interface within the distance L. Knowing 
that 1/ ( tan )N L D θ= , one can obtain from Eq. (8) that 1ln / ( tan )R Dα θ= − . Hence for TE 
and TM modes, the attenuation constants are respectively 
 
1
ln
tan
TE
TE
R
D
α
θ
= −  (9) 
 
1
ln
.
tan
TM
TM
R
D
α
θ
= −  (10) 
Moreover, the attenuation constants for the hybrid modes, i.e., HE and EH modes, are 
obtained by taking the arithmetic average of those of TE and TM modes [22]. 
 .
2
TE TM
HE EH
α α
α α
+
= =  (11) 
Note that Eq. (11) holds when the TE, TM, HE, and EH modes have the same θ1. In short, 
after calculating the incident angle θ1 from the modal index, the attenuation constants of the 
leaky core modes of the pipe waveguide can be obtained via Eqs. (5)−(7) and (9)−(11). Note 
that θ1 has significant influence on the attenuation constant, as can be observed from Eqs. (9) 
and (10) where not only the tangent but also RTE and RTM terms are strongly dependent on θ1. 
To validate the Fabry-Perot-based procedure mentioned above, the attenuation constants 
of the four lowest order modes (HE11, TM01, HE21, and TE01) of the pipe waveguide are 
calculated from the modal indices. The case with core diameter D = 9 mm, cladding thickness 
t = 1.0 mm, and cladding refractive index n2 = 1.4 is considered for validation. Starting from 
 
Fig. 12. Comparison of the attenuation constants of the pipe waveguide obtained directly by 
the FDFD mode solver (denoted as “FDFD”) and by the Fabry-Perot-based procedure (denoted 
as “FP”). (a) The fundamental mode. (b) The first set of higher order modes. 
the modal indices shown in Fig. 8(a), the incident angles θ1 are calculated by applying Eq. 
(4). Two sets of θ1 will be obtained. The first set of θ1 includes larger angles for the HE11 
mode and the second set of θ1 includes smaller angles for the TM01, HE21, and TE01 modes. 
Then, following the procedure described above, the attenuation constant αHE11 of the HE11 
mode can be obtained utilizing the first set of θ1, and αTM01, αHE21, and αTE01 can be obtained 
utilizing the second set of θ1, with αHE21 = (αTM01 + αTE01)/2. These results obtained according 
to the procedure (denoted as “FP”) are shown in Fig. 12, and are compared with the 
attenuation constants calculated directly from the FDFD mode solver (denoted as “FDFD”). 
As can be seen in Fig. 12, results obtained by the two approaches almost match each other. 
This match reveals several facts. First, the practicality of the procedure to derive the 
(C) 2010 OSA 4 January 2010 / Vol. 18,  No. 1 / OPTICS EXPRESS  321
#118829 - $15.00 USD Received 21 Oct 2009; revised 16 Dec 2009; accepted 16 Dec 2009; published 23 Dec 2009
  
Effect of perfectly matched layer reflection 
coefficient on modal analysis of leaky waveguide 
modes 
Chih-Hsien Lai
1,2
 and Hung-chun Chang
1,3,*
 
1Graduate Institute of Photonics and Optoelectronics, National Taiwan University, Taipei 10617, Taiwan 
2Department of Electronic Engineering, Hwa Hsia Institute of Technology, Taipei 23568, Taiwan 
3Department of Electrical Engineering and Graduate Institute of Communication Engineering, National Taiwan 
University, Taipei 10617, Taiwan 
*hcchang@cc.ee.ntu.edu.tw 
Abstract: The reflection coefficient is one important parameter of the 
perfectly matched layer (PML). Here we investigate its effect on the modal 
analysis of leaky waveguide modes by examining three different leaky 
waveguide structures, i.e., the holey fiber, the air-core terahertz pipe 
waveguide, and the gain-guided and index-antiguided slab waveguide. 
Numerical results reveal that the typical values 10
8
 ~10
12
 are inadequate 
for obtaining the imaginary part of the complex propagation constant, and 
the suggested reflection coefficient would be much smaller, for example, 
10
50
 or 10
100
. With such a small coefficient, both the computational 
window size and the PML thickness can be significantly reduced without 
loss of stability. Moreover, in some cases, the modal field profiles can only 
be accurately obtained with such a small coefficient. 
©2011 Optical Society of America 
OCIS codes: (000.4430) Numerical approximation and analysis; (050.1755) Computational 
electromagnetic methods; (230.7370) Waveguides. 
References and links 
1. G. R. Hadley, “Transparent boundary condition for beam propagation,” Opt. Lett. 16(9), 624–626 (1991). 
2. J. P. Berenger, “A perfectly matched layer for the absorption of electromagnetic waves,” J. Comput. Phys. 
114(2), 185–200 (1994). 
3. W. C. Chew, and W. H. Weedon, “A 3-D perfectly matched medium from modified Maxwell’s equation with 
stretched coordinates,” Microw. Opt. Technol. Lett. 7(13), 599–604 (1994). 
4. C. M. Rappaport, ““Perfectly matched absorbing boundary conditions based on anisotropic lossy mapping of 
space,” IEEE Microw. Guid. Wave Lett. 5(3), 90–92 (1995). 
5. A. Taflove, and S. C. Hagness, Computational Electrodynamics: The Finite-Difference Time-Domain Method, 
3rd ed. (Artech House, 2005). 
6. W. P. Huang, C. L. Xu, W. Lui, and K. Yokoyama, “The perfectly matched layer boundary condition for modal 
analysis of optical waveguides: leaky mode calculations,” IEEE Photon. Technol. Lett. 8(5), 652–654 (1996). 
7. Y. Tsuji, and M. Koshiba, “Guided-mode and leaky-mode analysis by imaginary distance beam propagation 
method based on finite element scheme,” J. Lightwave Technol. 18(4), 618–623 (2000). 
8. C.-P. Yu, and H.-C. Chang, “Yee-mesh-based finite difference eigenmode solver with PML absorbing boundary 
conditions for optical waveguides and photonic crystal fibers,” Opt. Express 12(25), 6165–6177 (2004), 
http://www.opticsinfobase.org/oe/abstract.cfm?URI=OPEX-12-25-6165. 
9. W.-P. Huang and J. Mu, “Complex coupled-mode theory for optical waveguides,” Opt. Express 17(21), 19134–
19152 (2009), http://www.opticsinfobase.org/oe/abstract.cfm?URI=OPEX-17-21-19134. 
10. P. L. Ho and Y. Y. Lu, “A mode-preserving perfectly matched layer for optical waveguides,” IEEE Photon. 
Technol. Lett. 15(9), 1234–1236 (2003). 
11. B. Chen, D. G. Fang, and B. H. Zhou, “Modified Berenger PML absorbing boundary condition for FD-TD 
meshes,” IEEE Microw. Guid. Wave Lett. 5(11), 399–401 (1995). 
12. P.-J. Chiang, and Y.-C. Chiang, “Pseudospectral frequency-domain formulae based on modified perfectly 
matched layers for calculating both guided and leaky modes,” IEEE Photon. Technol. Lett. 22(12), 908–910 
(2010). 
13. T. P. White, B. T. Kuhlmey, R. C. McPhedran, D. Maystre, G. Renversez, C. M. de Sterke, and L. C. Botten, 
“Multipole method for microstructured optical fibers. I. Formulation,” J. Opt. Soc. Am. B 19(10), 2322–2330 
(2002). 
#137010 - $15.00 USD Received 21 Oct 2010; revised 22 Dec 2010; accepted 22 Dec 2010; published 4 Jan 2011
(C) 2011 OSA 17 January 2011 / Vol. 19,  No. 2 / OPTICS EXPRESS  562
  
imaginary part, to which the leakage loss is related, a larger computational window size or a 
thicker PML thickness is required to obtain the converged magnitude. The ideal R value for 
calculating the imaginary part of β is found to be much smaller than the typical ones and 
would be as small as, for example, 10
50
 or 10
100
. With such a small R value, both the PML 
thickness and the computational window size can be significantly reduced to minimum 
degrees to obtain the converged magnitude without loss of stability. Moreover, it is shown 
that in some cases the modal field profiles can only be accurately obtained with such a small 
R value 
2. The case of holey fiber 
We first investigate the holey fiber with a ring of six air holes symmetrically arranged around 
the core. The structure is shown in Fig. 1, with the hole diameter D=5 μm, the hole pitch 
Λ=6.75 μm, and the refractive indices ns=1.45 and na=1. The computational window size is 
denoted as W and the PML thickness is denoted as d. For the FDFD simulation, the grid sizes 
Δx=Δy=0.05 μm and λ=1.45 μm are assumed. 
 
Fig. 1. Structure of the six-hole holey fiber. 
We calculate the complex effective index neff, defined as neff=β/k0, where k0 is the free-
space wavenumber. Calculated results of Re(neff) and Im(neff) of the fundamental mode are 
shown in Figs. 2(a) and 2(b), respectively, as a function of W with a fixed d=1 μm. Obviously, 
results using R=10
8
 are the least stable because they vary and oscillate with W most 
seriously, and the oscillation amplitude becomes smaller when W increases. However, results 
of Re(neff) are consistent over the whole simulation range of W with up to the first eight digits 
(1.4453975), while those of Im(neff) differ even in the first digit. Hence the typical value 
R=10
8
 might be acceptable to calculate Re(neff), but is inadequate for Im(neff). The latter is so 
highly affected by the computational window size that it is difficult to decide what size of W 
should be adopted to obtain the reasonable converged magnitude. (Of course a very large 
computational window size far above those shown in Fig. 2 might lead to the converged 
result, but it is unpractical if the limited computing resource is taken into account.) Results 
using R=10
12
 show similar characteristics but vary with a less significant oscillation. In 
general, as the value of R decreases, the variation and oscillation become gradually 
diminished. In the case of R=10
50
, it is clear both Re(neff) and Im(neff) are extremely 
consistent over the whole W range. Note that in Fig. 2, W starts from 20 μm, which is very 
close to the required minimum computation window size 18.5μm in this case (2Λ + D, the 
distance between the outmost boundaries of the two air holes located in the central horizontal 
line). In other words, if a sufficiently small value of R like 10
50
 is used for simulation, only a 
small W near the minimum size requirement would be enough to obtain the converged 
magnitude of neff, which significantly saves the computation cost in terms of memory and 
time. 
#137010 - $15.00 USD Received 21 Oct 2010; revised 22 Dec 2010; accepted 22 Dec 2010; published 4 Jan 2011
(C) 2011 OSA 17 January 2011 / Vol. 19,  No. 2 / OPTICS EXPRESS  564
  
μm.) What we aim to emphasize here is the effect of R, as discussed above and in the 
following, which is illustrated in this work using the finite difference method. This effect 
would be general to other numerical techniques as long as the PML is employed for leaky-
mode analysis. 
 
Fig. 4. Im(neff) of the holey fiber as a function of R with W=24 μm and d=1 μm. 
3. The case of air-core pipe waveguide 
The second leaky structure is the air-core pipe waveguide recently proposed for THz 
waveguiding [14]. It consists of a large air core and a thin low-index dielectric cladding, as 
shown in Fig. 5, and its guiding mechanism is similar to that of the antiresonant reflecting 
optical waveguide (ARROW) [18,19]. 
 
Fig. 5. Structure of the air-core pipe waveguide. 
By assuming the core diameter D=9 mm, the cladding thickness t=1 mm, the refractive 
indices n1=1 and n2=1.4, Δx=Δy=0.025 mm, and the operating frequency being 840 GHz, we 
calculate neff of the fundamental mode by changing W and d, respectively. Since Re(neff) is 
usually much easier to converge, only the results of Im(neff) are shown in Figs. 6(a) and 6(b), 
respectively. Calculated results exhibit the same characteristics as that of the previously 
discussed holey fiber. For larger R such as 10
10
, significant variation and oscillation occur, 
and the oscillation becomes smaller as W or d increases; therefore, a larger W or a thicker d is 
required to obtain the converged Im(neff). While for R=10
100
, calculated Im(neff)’s are stable 
over the simulation range, so that both W or d can be significantly reduced to obtain the 
converged magnitude without loss of stability. From Fig. 7, which shows Im(neff) as a function 
of R, it is clear Im(neff) converges if R is smaller than the threshold value of 10
100
. 
#137010 - $15.00 USD Received 21 Oct 2010; revised 22 Dec 2010; accepted 22 Dec 2010; published 4 Jan 2011
(C) 2011 OSA 17 January 2011 / Vol. 19,  No. 2 / OPTICS EXPRESS  566
  
 
Fig. 8. Im(neff) of the gain-guided and index-antiguided slab waveguide as a function of R. (a) 
g=0 (IAG case). (b) g=1 cm1 (GG + IAG case). 
We then examine the modal field profiles. Calculated modal field distributions for g=0 
and g=1 cm
1
 are shown in Figs. 9(a) and 9(b), respectively. Clearly, for both cases, using the 
typical R value 10
10
 is unable to obtain the correct modal profiles. R must be sufficiently 
small so that the stable and converged modal fields could be solved, even though there is gain 
in the waveguide core. Here, R should be at most 10
200
. 
 
Fig. 9. Fundamental TE modal field profiles of the gain-guided and index-antiguided slab 
waveguide. (a) g=0 (IAG case). (b) g=1 cm1 (GG + IAG case). 
5. Conclusion 
In conclusion, we have investigated the effect of the reflection coefficient of PML on the 
modal analysis of leaky waveguide modes. By examining three different leaky structures, it 
reveals that the typical values of the reflection coefficient 10
8
 ~10
12
 are inadequate for 
leaky-mode analysis, and the satisfactory coefficient should be much smaller. Using such a 
small coefficient, both the computational window size and the PML thickness can be 
significantly reduced to minimum degrees to obtain the converged complex propagation 
constant. Moreover, in some cases, the modal field profiles can only be accurately obtained 
with such a small coefficient. Note that the threshold value of the reflection coefficient is case 
dependent and could be as small as 10
100
 or 10
200
; thus we suggest assigning the coefficient 
as small as possible under the constraint of the computer software. The software we used in 
this study is the MATLAB, and the ARPACK program which is accessible via the function 
eigs() is employed to solve the complex eigenvalue problems. The smallest R value 
acceptable in this study is about 10
320
, and applying such a small R value to computation 
does not increase additional CPU time and memory space. Finally, although our simulation is 
#137010 - $15.00 USD Received 21 Oct 2010; revised 22 Dec 2010; accepted 22 Dec 2010; published 4 Jan 2011
(C) 2011 OSA 17 January 2011 / Vol. 19,  No. 2 / OPTICS EXPRESS  568
  
The Plasmon-Forbidden Deep Sub-wavelength 
Transmission With The TE Polarization 
Minfeng Chen and Hung-chun Chang† 
Graduate Institute of Photonics and Optoelectronics  
National Taiwan University, Taipei, Taiwan 10617, R.O.C. 
†also with the Department of Electrical Engineering and the Graduate Institute of  
Communication Engineering, National Taiwan University 
d93941018@ntu.edu.tw 
Abstract: As is well-known, the sub-wavelength transmissions and 
field enhancement are related to the surface plasmon excitation. Here 
we demonstrate that in two-layer metallic gratings the deep sub-
wavelength transmissions is supported with the TE polarization where 
the surface plasmon mode is forbidden. The new mechanism to the sub-
wavelength transmission is discovered to be completely different from 
the findings in the literatures. we propose a simple resonance condition 
to classify the resonance types which are responsible for those sub-
wavelength transmissions and confirm with numerical simulations. To 
give a complete explanation of underlying physics, we inspect the near-
field phenomenon within the grating slits. 
© 2009 Optical Society of America 
OCIS codes: (050.6624) Subwavelength structures; (240.6680) Surface plasmons; 
(260.2110) Electromagnetic optics. 
References and links 
1. T. W. Ebbesen, H. J. Lezec, H. F. Ghaemi, T. Thio, and P. A. Wolff, “Extraordinary optical transmission 
through sub-wavelength hole arrays,” Nature 391(6668), 667–669 (1998). 
2. E. Altewischer, M. P. van Exter, and J. P. Woerdman, “Plasmon-assisted transmission of entangled 
photons,” Nature 418(6895), 304–306 (2002). 
3. H. J. Lezec, A. Degiron, E. Devaux, R. A. Linke, L. Martin-Moreno, F. J. Garcia-Vidal, and T. W. Ebbesen, 
“Beaming light from a subwavelength aperture,” Science 297(5582), 820–822 (2002). 
4. S. M. Williams, A. D. Stafford, T. M. Rogers, S. R. Bishop, and J. V. Coe, “Extraordinary infrared 
transmission of Cu-coated arrays with subwavelength apertures: Hole size and the transition from surface 
plasmon to waveguide transmission,” Appl. Phys. Lett. 85(9), 1472–1474 (2004). 
5. S. S. Akarca-Biyikli, I. Bulu, and E. Ozbay, “Resonant excitation of surface plasmons in one-dimensional 
metallic grating structures at microwave frequencies,” J. Opt. A 7, S159 (2005). 
6. F. J. Garcia de Abajo, “Full transmission through perfect-conductor subwavelength hole arrays,” Rev. Mod. 
Phys. 79, 1267 (2007). 
7. L. Martín-Moreno, F. J. García-Vidal, H. J. Lezec, K. M. Pellerin, T. Thio, J. B. Pendry, and T. W. 
Ebbesen, “Theory of extraordinary optical transmission through subwavelength hole arrays,” Phys. Rev. 
Lett. 86(6), 1114–1117 (2001). 
8. S. Ramo, J. R. Whinnery, and T. V. Duzer, Fields and Waves in Communication Electronics (John Wiley & 
Sons, Inc., New York, 1994). 
9. R. Petit, Electromagnetic Theory of Gratings (Springer-Verlag, Berlin, Heidelberg, New York, 1980). 
10. J. A. Porto, F. J. Garcia-Vidal, and J. B. Pendry, “Transmission Resonances on Metallic Gratings with Very 
Narrow Slits,” Phys. Rev. Lett. 83(14), 2845–2848 (1999). 
11. S. Collin, F. Pardo, R. Teissier, and J.-L. Pelouard, “Strong discontinuities in the complex photonic band 
structure of transmission metallic gratings,” Phys. Rev. B 63(3), 033107 (2001). 
12. S. Collin, F. Pardo, R. Teissier, and J. L. Pelouard, “Horizontal and vertical surface resonances in 
transmission metallic gratings,” J. Opt. A 4, S154 (2003). 
13. M. Chen, S. Lin, H. C. Chang, and A. S. P. Chang, “Physical origin of the resonant mode deep inside the 
stop band of a metallodielectric photonic crystal,” Phys. Rev. B 78(8), 085110 (2008). 
14. A. S. P. Chang, Y. S. Kim, M. Chen, Z. P. Yang, J. A. Bur, S. Y. Lin, and K. M. Ho, “Visible three-
dimensional metallic photonic crystal with non-localized propagating modes beyond waveguide cutoff,” 
Opt. Express 15(13), 8428–8437 (2007), http://www.opticsinfobase.org/oe/abstract.cfm?URI=oe-15-13-
8428. 
15. M. Fox, Optical Properties of Solids (Oxford Univ. Press, New York, 2006). 
16. A. Taflove, and S. C. Hagness, “Computational Electrodynamics: The Finite-Differece Time-Domain 
Method”, (Artech House, Boston/London, 2005). 
17. S. Fan, W. Suh, and J. D. Joannopoulos, “Temporal coupled mode theory for Fano resonances in optical 
resonators,” J. Opt. Soc. Am. A 20(3), 569–572 (2003). 
#111835 - $15.00 USD Received 29 May 2009; revised 2 Jul 2009; accepted 14 Jul 2009; published 28 Jul 2009
(C) 2009 OSA 3 August 2009 / Vol. 17,  No. 16 / OPTICS EXPRESS  13953
  
 
Fig. 1. Schematic of the two-layer gratings. The plane-waves are incident from the top 
with electric fields oriented along the grating lines. Given this polarization, the surface 
plasmon is no longer excited. 
The FDTD-computed spectrum is shown in Fig. 2(a), where many resonant peaks are 
observed. Figure 2(b) is the zoom-in diagram for cases of the asymmetric lineshapes. In 
addition to the resonance formed in the vertical direction [13], we observed that the 
periodicity of the gratings provides an alternative resonance medium where the similar 
idea have been demonstrated in the 2-D hole arrays [1] and photonic crystal slabs [17,18]. 
Since the two-layer structure opens the possibility for a variety of resonances, we propose 
a momentum matching condition to estimate the resonance frequencies: 
 res v ai j= + ,k k k  (1) 
where ( )i j,  is the mode index, and vk  and ak  are defined as 
 
0 0
2 2
2v a
k k
n L n a
π π
= ; = .
/
 (2) 
Equation (2) reveals that the vertical momentum matching condition requires the integer 
number of vk  while the horizontal one obeys the multiple of ak . Combining both the 
vertical and horizontal conditions result in Eq. (1), which predicts the resonance 
frequencies. The resonance wavelengths are thus given by 
 
1 22 2
0 0
2
res
i j
n L n a
λ
− /
    
 = +   
     
 (3) 
The predicted wavelengths as well as FDTD simulated wavelengths are tabulated in Table 
1. The under-estimated values from the theoretical prediction are the consequence of 
neglecting the tunneling effect in the slits, which contributes some phases. This issue has 
been discussed in Ref [13]. To overcome the tunneling phases, one can decrease the slit 
width ( w ) or the ratio of slit width to grating period ( w a/ ). In observation of the 
resonance lineshapes, one can find that modes of (1 0), , (2 0), , and (3 0),  are symmetric 
while (1 1), , (2 1), , and (3 1),  are asymmetric. 
Figure 3 visualizes the resonance mode profiles with 1j = . The red and blue colors 
denote the positive and negative field values, respectively. Clearly, the mode indices i  
and j  represent the resonance orders for vertical and horizontal directions, respectively. 
For example, the (1 1),  mode suggests one peak along z -axis ( 1)i =  and one propagation 
wavelength along x -axis within a grating period ( )a . At those resonances, the incident 
waves are generated from 
#111835 - $15.00 USD Received 29 May 2009; revised 2 Jul 2009; accepted 14 Jul 2009; published 28 Jul 2009
(C) 2009 OSA 3 August 2009 / Vol. 17,  No. 16 / OPTICS EXPRESS  13955
  
 
Fig. 3. (Color online) The yE  mode profiles of Fano resonances. The Fano resonances 
occur when the resonant fields have horizontal components, e.g. 0j ≠ . The color 
denotes the field strength. The red and blue represent the positive and negative maxima, 
respectively. 
 
Fig. 4. (Color online) The yE  mode profiles of Fabry-Perot resonances. The Fabry-Perot 
resonances occur when the resonant fields do not have horizontal components, meaning 
0j = . 
By far, two resonance types associated with the two-layer gratings are distinguished. 
Without the resonance related to the periodicity ( 0j = ), the two-layer gratings behave as 
a vertical cavity. The Fabry-Perot resonance is then realized. If the periodicity ( 0j ≠ ) is 
involved, the standing waves are formed with equal forward and backward propagations 
in the x -direction. This interaction picture is an analogue to 2-D photonic crystal slab, of 
which the detailed description was provided by Fan et al. [18]. Instead of the two-layer 
structure, the resonance is mediated by waveguide modes within the slab, which is known 
as the guided resonance. In the spectrum of photonic crystal slab, light is excited from the 
top of slab and a number of asymmetric resonance peaks are observed. The lattice 
momenta of the crystal are closely related to our 
a
k . In addition, the guided wave within 
the slab has to satisfy the standing wave boundary condition in the vertical direction, 
which is conceptually equivalent to our vk  in some senses. When the lattice momenta 
and standing-wave boundary condition are both met, the resonances are obtained just like 
our case. 
The tunneling strength can be controlled by the slits as they directly leak the 
electromagnetic energy into the two-layer structure. By decreasing the slit width ( )w , slit 
to period ratio ( )w a/ , or grating thickness ( )h , the tunneling strength is reduced. This 
leads to the narrower full-width-at-half-maximum (FWHM), longer time to reach the 
steady-state, and the resonances closer to results of the proposed formula. Figure 5(a)(b) 
are the collective plots of FDTD-computed resonances with respect to a variety of slit 
widths for (2,0)  and (1,1) modes, respectively. As is seen, the resonance wavelengths 
#111835 - $15.00 USD Received 29 May 2009; revised 2 Jul 2009; accepted 14 Jul 2009; published 28 Jul 2009
(C) 2009 OSA 3 August 2009 / Vol. 17,  No. 16 / OPTICS EXPRESS  13957
Light Transmission through Two-Dimensional Photonic Quasicrystals 
 
Han-Chih Chang1and Hung-chun Chang2 
 
1Graduate Institute of Photonics and Optoelectronics, National Taiwan University, Taipei, Taiwan 10617, R.O.C., 
E-mail: hcchang@cc.ee.ntu.edu.tw 
 
2Department of Electrical Engineering, Graduate Institute of Photonics and Optoelectronics, and 
Graduate Institute of  Communication Engineering, National Taiwan University, Taipei, Taiwan 10617, R.O.C., 
E-mail: hcchang@cc.ee.ntu.edu.tw 
 
Abstract 
 
 Light transmission through two-dimensional photonic-quasicrystal (PhQC) slabs fabricated from multiple 
exposure techniques is numerically studied using the finite-difference time-domain (FDTD) method simulation. The 
observed semi-forbidden band gaps are compared with band gaps of periodic photonic-crystal (PhC) structures having 
identical average refractive indices. It is demonstrated that the same argument of multiple reflections can be extended 
from PhCs to PhQCs to predict the location of the semi-forbidden band gaps of the PhQCs. 
 
1. Introduction 
 
 The photonic crystal (PhC) refers to any structure periodically composed of materials of different dielectric 
constants, which features totally forbidden frequency bandgaps (named as photonic bandgaps (PBGs)), for no light can 
propagate through the crystal in this frequency range [1]. Traditional crystals are with translational symmetries. 
Althrough the study of three-dimensional (3D) space symmetry indicates that all normal crystals can be described by 
230 space groups, in 2D structures only two kinds of lattice, either square or hexagonal, are available. Penrose [2] 
proposed a scheme to fully cover a plane using two different types of tiles in 1974; since then, the concept of quasi-
crystals has been enthusiastically studied and has found applications in different areas including optics [3-6]. Aside 
from curiosity about those novelties, one reason to study on quasicrystals is to find better PBG materials. The 
underlying mechanism for PBGs has been known to be due to multiple reflections/refractions from the periodic 
structure. In order to have PBGs, the structure must provide total reflections in all directions for the forbidden frequency 
--- the discrete translational symmetries are associated with total reflections and the rotational symmetries are associated 
with angular degeneracies. Under this premise, the lattice is actually providing the first-order dominance over the PBGs; 
and indeed the lattice determines the fundamental features of the band diagram: only a hexagonal lattice can support a 
total PBG for both transverse-magnetic (TM) and transverse-electric (TE) modes. However, although there are only two 
kinds of perfect crystals in 2D space, there exist innumerable quasicryatals: they have no translational symmetries at all, 
but with more rotational symmetries instead. The combining effects are still unclear, but there are reports of promising 
results. In this paper, we study light transmission through 2D photonic-qusaicrystal (PhQC) slabs of different 
symmetries and compare its spectrum with a PhC slab case having an equivalent refractive index. 
 
2. PhQC Structures and Analysis Method 
 
 Following [5], we consider PhQCs fabricated from multiple exposure techniques, which are more compatible 
with integrated optics. The 2D quasicrystal is assumed to be uniform in the z direction. The PhQC structure is generated 
from the diffraction pattern of optical beams with different incident angles, and the optical exposure causes the variation 
of the refractive index as: , where 0( ) [ ( )]n R n n I R= − Δ
JG JG 1 1
2 2
0
0 0
( ) | ( ) | | | | exp[ ( )] |
N N
i i i
i i
I R E R E j k R
− −
= =
≈ = ×∑ ∑ 2JG JG JG JG , with ( , )R x y=JG  
and . The number of the optical beams, N, determines the 
desired rotational symmetry of the quasicrystal. The wavelength of the optical beams, Λ, is set to 430.55 nm, and the 
refractive index of the substrate, n0, is set to be 3.4. For simplicity, all E0i’s are set to be equal. The function Δn should 
be determined by empirical measurements. Due to the lack of this information, it is simply set in the linear form: Δn = 
(n0 － nair)I/Imax for an optical-burnt air holes when illuminated with the peak intensity, Imax. Resulting patterns of five, 
six, seven, and eight beams are demonstrated in Fig. 1. 
(2 / )(cos(2 , ,ik i Nπ π= Λ = ⋅
JG
/ ),sin(2 / )),  0N iπ 1i N⋅ ⋅ −
 
 
[1] J. D. Joannopoulos, R. D. Meade, and J. N. Winn, Photonic Crystals: Molding the Flow of Light. Princeton 
University Press, NJ, 1995. 
[2] R. Penrose, “The role of aesthetics in pure and applied mathematical research,” Bull. Inst. Maths. Its Appl., 10, 1974, 
pp. 266-271. 
[3] S. S. M. Cheng, L. M. Li, C. T. Chan, and Z. Q. Zhang, “Defect and transmission properties of two-dimensional 
quasiperiodic photonic band-gap systems,” Phys. Rev. B, 59, 1999, pp. 4091-4099. 
[4] X. Zhang, Z. Q. Zhang, and C. T. Chan, “Absolute photonic band gaps in 12-fold symmetric photonic 
quasicrystals,” Phys. Rev. B, 63, 2001, 081105. 
[5] R. C. Gauthier and K. Mnaymneh, “Photonic band gap properties of 12-fold quasicrystal determined through FDTD 
analysis,” Opt. Express, 13, 2005, pp. 1985-1998. 
[6] B. Freedman, G. Bartal, M. Segev, R. Lifshitz, D. N. Christodoulides, and J. W. Fleischer, “Wave and defect 
dynamics in nonlinear photonic quasicrystals,” Nature, 440, 2006, pp. 1166-1169. 
[7] A. Taflove and S. C. Hagness, Computational Electromagnetics: The Finite-Difference Time-Domain Method, 3rd 
edition. Artech House, MA, 2005. 
 
 
 
 
  
Fig. 1. Patterns of refractive indices for five-, six-, seven, and eight-beamed PhQCs. 
 
              
Fig. 2. (a) A TM plane wave normally incident upon a 2D PhC. (b) The geometrical structure of the five-beamed PhQC slab. 
Finite-Difference Frequency-Domain Method Analysis of Surface 
Plasmon Modes on Three-Dimensional Sub-Wavelength Slit Arrays 
Ming-yun Chen and Hung-chun Chang1 
Graduate Institute of Photonics and Optoelectronics, National Taiwan University, 
Taipei, Taiwan 10617, R.O.C. 
1also with the Department of Electrical Engineering and the Graduate Institute of 
Communication Engineering, National Taiwan University 
(hcchang@cc.ee.ntu.edu.tw, NSC97-2221-E-002-043-MY2) 
Abstract --- A finite-difference frequency-domain (FDFD) method based standard eigenvalue 
equation for the calculation of dispersion diagrams for three-dimensional surface plasmonic waveguides 
with one-dimensional periodicity and involving real metal is derived. The formulation is easy and the 
method is efficient for obtaining the guided mode characteristics. The surface plasmon modes on a 
sub-wavelength slit array are clearly determined with the mode fields confined to the surface of metallic 
film blocks. 
Keywords: Finite-difference frequency-domain (FDFD) method, surface plasmons, plasmonic 
waveguides, periodic waveguides. 
 
INTRODUCTION 
Surface plasmons are collective charge oscillations that occur at the interface between metals and 
dielectrics. They can take various forms, ranging from freely propagating electron density waves along 
metal surfaces to localized electron oscillations on metal nanoparticles. Their unique properties enable a 
wide range of practical applications, including sub-wavelength slits with one-dimensional (1-D) periodic 
arrangement [1–3], and guiding along metallic nanowires [4], V-shape grooves, and nanoparticle arrays [5]. 
Calculating band diagrams for periodic metallic structures including real metal effects with 
frequency-dependent permittivity can be a difficult problem because the solution of a nonlinear eigenvalue 
problem may be encountered. The finite-difference time-domain (FDTD) method based on the Yee mesh 
has been a popular tool for calculating such band diagrams due to the flexibility and easiness of the method 
in dealing with dispersive materials [6]. However, the conventional FDTD method may require more 
complicated mathematical algorithms in treating material interfaces in order to have high enough numerical 
accuracy and mode-finding resolution in the band-diagram calculation [7–8]. In this paper, we derive a 
FDFD method based standard eigenvalue equation to compute dispersion diagrams for 3-D sub-wavelength 
slit array structures. We successfully obtain surface plasmon modes on such 3-D structures and compare 
the results with related 2-D structures recently reported in [9]. 
 
FORMULATION 
The FDFD formulation starts from Maxwell’s curl equations in frequency domain: 
0
0 r
E j H
H j E
ωμ
ωε ε
∇× = −
∇× =
K K
K K  (1) 
where ω is angular frequency, μ0 and ε0 are the permeability and permittivity, respectively, of free space, 
and εr is the relative permittivity for the concerned medium. In the present study, we only consider 
free-electron model for lossless real metal with the frequency-dependent relative permittivity expressed as 
(2) 
(3) 
2
21
p
r
ωε ω= −  
where ωp is the bulk plasma frequency. We substitute (3) into (1) and (2) to obtain the six component 
equations: 
for the surface plasmon modes in Fig. 3, from which we clearly observe the first and second surface 
plasmon modes are even modes and third and fourth surface plasmon modes are odd modes in the y-z and 
x-z planes. 
 
 
 
 
 
 
 
 
 
 
 
Fig. 2. The dispersion diagram of guided modes for the 3-D sub-wavelength slit array of Fig. 1. 
 
 
 
 
 
 
 
 
 
 (a) (b)
Fig. 3. Ex-field distributions at kx = π/d for the first to fourth surface plasmon modes in the metal block side 
surface cross-sections in the (a) x-z and (b) y-z planes. 
 
CONCLUSION 
We have derived an FDFD method based standard eigenvalue equation for calculating band diagrams of 
3-D plasmonic waveguide structures with 1-D periodicity. We applied the method to analyze the 3-D 
sub-wavelength slit array composed of metal blocks and carefully identified the surface plasmon modes 
and dielectric modes on it. The proposed algorithm is efficient in obtaining eigenmode solutions. 
 
REFERENCES 
[1] J. T. Shen and P. M. Platzman, “Properties of a one-dimensional metallophotonic crystal,” Phys. Rev. B, 
vol. 70, 035101, 2004. 
[2] Y. Takakura, “Optical resonance in a narrow slit in a thick metallic screen,” Phys. Rev. Lett., vol. 86, 
5601, 2001. 
[3] F. J. García-Vidal and L. Martín-Moreno, “Transmission and focusing of light in one-dimensional 
periodically nanostructured metals,” Phys. Rev. B, vol. 66, 155412, 2002. 
[4] J. C. Weeber, A. Dereux, C. Girard, J. R. Krenn, and J. P. Goudonnet, “Plasmon polaritons of metallic 
nanowires for controlling submicron propagation of light,” Phys. Rev. B, vol. 60, pp. 9061–9068, 1999. 
[5] S. A. Maier, P. G. Kik, and H. A. Atwater, “Optical pulse propagation in metal nanoparticle chain 
waveguides,” Phys. Rev. B., vol. 67, 205402, 2003. 
[6] T. Ito and K. Sakoda, “Photonic bands of metallic systems. I. Principle of calculation and accuracy,” 
Phys. Rev. B, vol. 64, 045117, 2001. 
[7] Y. Zhao and Y. Hao, “Finite-difference time-domain study of guided modes in nano-plasmonic 
waveguides,” IEEE Trans. Microwave Theory Tech., vol, 55, pp. 3070–3077, 2007. 
[8] A. Mohammadi and M. Agio, “Contour-path effective permittivitites for the two-dimensional 
finite-difference time-domain method,” Opt. Express, vol. 13, pp. 10367–10381, 2005. 
[9] P. B. Catrysse, G. Veronis, H. Shin, J. T. Shen, and S. Fan, “Guided modes supported by plasmonic 
films with a periodic arrangement of subwavelength slits,” Appl. Phys. Lett., vol. 88, 031101, 2006.
2. The Legendre pseudospectral penalty scheme
Using the multidomain approach [4], the computational domain is divided into four subdomains, as illustrated
in Fig. 1(b). In any one of the four subdomains with relative permittivity r, normalized Maxwell’s equations
with the magnetic field multiplied by the intrinsic impedance of the free space give the following six equations,
four from the six scalar eqations of the curl equations and two from the divergence equations:
∂Ex
∂z
= −1
c
∂Hy
∂t
+
∂Ez
∂x
,
∂Ey
∂z
=
1
c
∂Hx
∂t
+
∂Ez
∂y
,
∂Ez
∂z
= −∂Ex
∂x
− ∂Ey
∂y
,
∂Hx
∂z
=
r
c
∂Ey
∂t
+
∂Hz
∂x
,
∂Hy
∂z
= −r
c
∂Ex
∂t
+
∂Hz
∂y
,
∂Hz
∂z
= −∂Hx
∂x
− ∂Hy
∂y
where c is the speed of light in free space. Introducing qˆ = [rEx, rEy, Ez , Hx, Hy, Hz]T , where the su-
perscript T represents transpose, and then qˆ(x, y, z, t) = q(x, y, z)e−iωt for time-harmonic fields, the above
equations lead to the following one in the matrix form:
Az
∂q
∂z
= −ik0Atq +Ax ∂q
∂x
+Ay
∂q
∂y
(1)
where k0 = ω/c is the wave number in free space and Az, At, Ax, and Ay are matrices with constant
elements. Define A(n) = nxAx + nyAy with n = (nx, ny) denoting the outward pointing unit normal
vector at the subdomain boundary. Since A(n) = AT (n), there exists a unitary matrix S(n) such that
S∗A(n)S = Λ = diag(λ1, λ2, λ3, λ4, λ5, λ6), λ1 = λ6 = −1, λ2 = λ5 = 1, λ3 = λ4 = 0. Further, we
define the characteristic state vector R = S∗q. The explicit expressions of S and R are given below:
S(n) =
1√
2

nx nx
√
2ny 0 0 0
ny ny −
√
2nx 0 0 0
−1 1 0 0 0 0
0 0 0
√
2ny nx nx
0 0 0 −√2nx ny ny
0 0 0 0 1 −1
 , R(n) =

R1
R2
R3
R4
R5
R6
 =
1√
2

r(n ·E‖)− ez ·E⊥
r(n ·E‖) + ez ·E⊥
−√2rez · (n×E‖)
−√2ez · (n×H‖)
(n ·H‖) + ez ·H⊥
(n ·H‖)− ez ·H⊥

(2)
where ez is the unit vector along the z direction, E‖ is the transverse electric field and E⊥ is the electric
field perpendicular to the x-y plane, and likewise for the similar notations for H.
The Legendre pseudospectral method is introduced briefly in the following. Let I be the interval [−1, 1]
and N be a non-negative integer. The Legendre pseudospectral method is based on the Legendre-Gauss-
Lobatto (LGL) collocation points ξi for 0 ≤ i ≤ N . These points, ordered as −1 = ξ0 < ξ1 < ξ2 <
· · · < ξN = 1, are roots of the polynomials (1 − ξ)P ′N (x) where the prime denotes the differentiation.
Associated with a set of LGL grid points is a set of quadrature weights ωi for 0 ≤ i ≤ N and an integration
quadrature rule
∑N
i=0 f(ξi)wi =
∫ 1
−1 f(ξ)dξ, provided that f is a ξ-polynomial of degree at most 2N − 1.
To approximate a function f defined on I, we seek a polynomial fN of the Lagrange interpolation form
fN (ξ) =
∑N
j=0 lj(ξ)fj , lj(ξ) = −(1− ξ2)P ′N (ξ)/[N(N + 1)(ξ − ξj)PN (ξj)], and fj = f(ξj), where lj are the
Lagrange interpolating functions and fj are the collocated field values. Consequently, the approximation
of f ′(ξi) is achieved by f ′(ξi) ≈ f ′N (ξi) =
∑N
j=0 l
′
j(ξi)fj . For structural domains such as quadrilaterals
in the present formulation, the multi-dimensional setting of the pseudospectral method can be established
through tensor product formulation. We define the integer sets Iξ = {1, 2, ..., Nξ} and Iη = {1, 2, ..., Nη},
denote I2 = [−1, 1]2, and term the coordinates ξ = (ξ, η), ξ ∈ I2. We will consider the sets of grid points
Ξξ(Nξ) = {ξi|i ∈ Iξ} and Ξη(Nη) = {ηj |j ∈ Iη}, where ξi and ηj are the Nξ+1 and Nη+1 LGL grid points
along the ξ-axis and η-axis, respectively.
A one-to-one correspondence between the considered subdomain in the x = (x, y) coordinate system
and I2 is established using the transfinite blending interpolation method [4,5] to construct a coordinate
mapping ξ = Ψ(x) and its inverse x = Ψ−1(ξ). Using the coordinate transformation and the chain rule of
differentiation, Eq. (2) is rewritten as
A z
∂q
∂z
= −ik0A tq +A ξ ∂q
∂ξ
+A η
∂q
∂η
(3)
A high-accuracy pseudospectral
full-vectorial leaky optical waveguide
mode solver with carefully implemented
UPML absorbing boundary conditions
Po-jui Chiang1 and Hung-chun Chang2,∗
1Department of Electronic Engineering, National Kaohsiung University of Applied Sciences,
Kaohsiung 840, Taiwan
2Department of Electrical Engineering, Graduate Institute of Photonics and Optoelectronics,
and Graduate Institute of Communication Engineering, National Taiwan University, Taipei
10617, Taiwan
∗hcchang@cc.ee.ntu.edu.tw
Abstract: The previously developed full-vectorial optical waveguide
eigenmode solvers using pseudospectral frequency-domain (PSFD) formu-
lations for optical waveguides with arbitrary step-index profile is further
implemented with the uniaxial perfectly matched layer (UPML) absorp-
tion boundary conditions for treating leaky waveguides and calculating
their complex modal effective indices. The role of the UPML reflection
coefficient in achieving high-accuracy mode solution results is particularly
investigated. A six-air-hole microstructured fiber is analyzed as an example
to compare with published high-accuracy multipole method results for both
the real and imaginary parts of the effective indices. It is shown that by
setting the UPML reflection coefficient values as small as on the order of
10−40 ∼ 10−70, relative errors in the calculated complex effective indices
can be as small as on the order of 10−12.
© 2011 Optical Society of America
OCIS codes: (000.4430) Numerical approximation and analysis; (050.1755) Computational
electromagnetic methods; (060.4005) Microstructured fibers; (230.7370) Waveguides.
References and links
1. G. R. Hadley, “High-accuracy finite-difference equations for dielectric waveguide analysis I: Uniform regions
and dielectric interfaces,” J. Lightwave Technol. 20, 1210–1218 (2002).
2. G. R. Hadley, “High-accuracy finite-difference equations for dielectric waveguide analysis II: Dielectric corners,”
J. Lightwave Technol. 20, 1219–1231 (2002).
3. N. Thomas, P. Sewell, and T. M. Benson, “A new full-vectorial higher order finite-difference scheme for the
modal analysis of rectangular dielectric waveguides,” J. Lightwave Technol. 25, 2563–2570 (2002).
4. Y. C. Chiang, Y. P. Chiou, and H. C. Chang, “Improved full-vectorial finite-difference mode solver for optical
waveguides with step-index profiles,” J. Lightwave Technol. 20, 1609–1618, (2002).
5. M. Koshiba and Y. Tsuji, “Curvilinear hybrid edge/nodal elements with triangular shape for guided-wave prob-
lems,” J. Lightwave Technol. 18, 737–743 (2000).
6. P. J. Chiang, C. S. Yang, C. L. Wu, C. H. Teng, and H. C. Chang, “Application of pseudospectral methods
to optical waveguide mode solvers,” OSA 2005 Integrated Photonics Research and Applications (IPRA ’05)
Technical Digest (Optical Society of America, 2005), paper IMG4.
7. P. J. Chiang, C. L. Wu, C. H. Teng, C. S. Yang, and H. C. Chang, “Full-vectorial optical waveguide mode solvers
using multidomain pseudospectral frequency-domain (PSFD) formulations,” IEEE J. Quantum Electron. 44, 56–
66 (2008).
8. B. Yang, D. Gottlieb, and J. S. Hesthaven, “Spectral simulations of electromagnetic wave scattering,” J. Comput.
Phys. 134, 216–230 (1997).
#138233 - $15.00 USD Received 16 Nov 2010; revised 7 Jan 2011; accepted 9 Jan 2011; published 13 Jan 2011
(C) 2011 OSA 17 January 2011 / Vol. 19,  No. 2 / OPTICS EXPRESS  1594
The application of the pseudospectral method to solve electromagnetics problems is a rela-
tively new approach compared to in the area of fluid dynamics. The method is attractive owing
to its high-order accuracy and fast convergence behavior over traditional methods. It has been
successfully employed to solve scattering problems in time domain [8–13]. As for frequency-
domain problems, the pseudospectral frequency-domain (PSFD) method was formulated in
[14] for solving the nonhomogeneous (nonzero-source) Helmholtz equation in a rectangualr-
shape problem and in [6] and [7] into eigenvalue equations for eigenmode analysis of optical
waveguides with arbitrary step-index profile. Full-vectorial formulations with the eigenvectors
containing two transverse field components was developed in [6] and [7] for obtaining vec-
tor waveguide modes. A simpler scalar formulation has also been established for solving the
Helmholtz equation in the analysis of two-dimensional (2-D) photonic-crystal band diagrams
along with the required periodic boundary conditions [15]. In [6], [7], and [15], the multido-
main Legendre or Chebyshev collocation method were employed. Spectral polynomials such
as Legendre or Chebyshev polynomials were used to develop differential matrices for approx-
imating differential operators in the Helmholtz equation over nonuniform Legendre-Gauss-
Lobatto or Chebyshev-Gauss-Lobatto grid points and forming the matrix eigenvalue problem.
We have found that the Chebyshev collocation method performs more efficiently than the Leg-
endre one. The multidomain approach combined with the curvilinear mapping technique [16]
can efficiently treat general multiple material structures having curved dielectric interfaces and
properly fulfill field continuity conditions across the interface, i.e., suitable Dirichlet-type and
Neumann-type boundary conditions (DBCs and NBCs), which is essential for achieving high-
accuracy solutions along with the inherent high-order scheme of the pseudospectral method.
Recently Huang et al. [17] have also employed the multidomain pseudospectral method to for-
mulate a dielectric-waveguide mode solver but only for waveguides with rectangular-shaped
cross-section.
We have further generalized the PSMS for treating waveguides with leakage properties, such
as microstructured optical fibers [18, 19] and photonic crystal fibers [20] for which the mode
power could leak into the cladding region and the mode index or ne f f would become complex,
by applying the perfectly matched layer (PML) [21, 22] absorbing boundary conditions (ABCs)
to the boundaries of the computational domain [23]. The detailed formulation will be given in
this paper. The anisotropic or uniaxial PML (APML or UPML) proposed in [22] will be used
and implemented into the ABC layer to absorb the outward leaky waves with the DBCs and
NBCs rederived, forming the more general PSMS-UPML solver. In the implementation, the
reflection coefficient and thickness of the UPML are important parameters for controlling the
numerical accuracy. PMLs have been popularly employed in waveguide mode solvers using
conventional numerical methods, e.g., the FDM [24] and the FEM [25]. One characteristic ob-
served in these conventional methods was that the calculated ne f f would show oscillatory vari-
ation in the typically used PML reflection coefficient range of 10−7 ∼ 10−12. In this paper, we
particularly investigate the role of the UPML reflection coefficient in achieving high-accuracy
effective-index results. We will consider a six-air-hole microstructured fiber as an example,
which was studied in [18] and [19] using a high-accuracy multipole method analysis, and com-
pare our PSMS-UPML calculation with that of [18] and [19] for both the real and imaginary
parts of the complex ne f f ’s. We will show that by setting the UPML reflection coefficient values
as small as on the order of 10−40 ∼ 10−70, taking the advantage of the unprecedented accuracy
of the PSMS, relative errors in the calculated complex ne f f ’s can be as small as on the order
of 10−12. This issue regarding using small PML reflection coefficients was recently briefly dis-
cussed in [26] for one mode of the six-air-hole microstructured fiber, where PMLs based on
stretched complex coordinates [27] were employed. In this paper, detailed examinations will be
given with different PML parameters and for more modes.
#138233 - $15.00 USD Received 16 Nov 2010; revised 7 Jan 2011; accepted 9 Jan 2011; published 13 Jan 2011
(C) 2011 OSA 17 January 2011 / Vol. 19,  No. 2 / OPTICS EXPRESS  1596
where the differential operators in the matrix are defined as
PxxHx = k20εyµxHx + εy
{ ∂
∂y
[
1
εz
(∂Hx
∂y
)]}
+
∂
∂x
{
1
µz
[∂ (µxHx)
∂x
]}
, (9)
PxyHy =−εy
{ ∂
∂y
[
1
εz
(∂Hy
∂x
)]}
+
∂
∂x
{
1
µz
[∂ (µyHy)
∂y
]}
, (10)
PyyHy = k20εxµyHy + εx
{ ∂
∂x
[
1
εz
(∂Hy
∂x
)]}
+
∂
∂y
{
1
µz
[∂ (µyHy)
∂y
]}
, (11)
PyxHx =−εx
{ ∂
∂x
[
1
εz
(∂Hx
∂y
)]}
+
∂
∂y
{
1
µz
[∂ (µxHx)
∂x
]}
. (12)
Now considering an interface of arbitrary shape between two different material regions, a
and b, as shown in Fig. 1. With the x-y coordinate system defined in the figure, the available
boundary conditions (DBCs and NBCs) are, respectively, expressed as
[
Hax
Hay
]
=
[
−ny nx
µax nx µay ny
]−1 [
−ny nx
µbx nx µby ny
][
Hbx
Hby
]
, (13)
and
nx
∂ µax Hax
∂x +ny
∂Hax
∂y =
nx
[
−
∂ µay Hay
∂y +
(µaz
µbz
)(∂Hbx
∂x +
∂Hby
∂y
)]
+ny
[
∂Hay
∂x −
εaz
εbz
(
∂Hby
∂x −
∂Hbx
∂y
)]
, (14)
nx
∂Hay
∂x +ny
∂ µay Hay
∂y =
ny
[
−
∂ µax Hax
∂y +
(µaz
µbz
)(∂Hbx
∂x +
∂Hby
∂y
)]
+nx
[
∂Hax
∂y +
εaz
εbz
(
∂Hby
∂x −
∂Hbx
∂y
)]
, (15)
where nx and ny are the x- and y-components of the normal unit vector at the interface in Fig.
1 and the superscripts a and b refer to regions a and b, respectively. Of course, all quantities in
Eqs. (13)–(15) are evaluated at the interface.
3. The PSMS-UPML Formulation
We discuss the required conditions and materials for the UPML. Assume the material in region
a has the relative permeability and permittivity tensors:
[µ ] =


µx 0 0
0 µy 0
0 0 µz

 ,
[ε] =


εx 0 0
0 εy 0
0 0 εz

 ,
where µx, µy, µz, εx, εy, and εz are constants, and that in region b (considered as the UPML
region) has the corresponding tensors as [µ ]UPML and [ε]UPML.
#138233 - $15.00 USD Received 16 Nov 2010; revised 7 Jan 2011; accepted 9 Jan 2011; published 13 Jan 2011
(C) 2011 OSA 17 January 2011 / Vol. 19,  No. 2 / OPTICS EXPRESS  1598
value of R approaches to zero) at the inner interface of the UPML, the maximum values of αx
and αy can be determined as
αmax(x) =
(m+1)λ
4pindx
ln 1
R
, (22)
αmax(y) =
(m+1)λ
4pindy
ln 1
R
, (23)
where λ is the wavelength corresponding to ω and n =
√
min(εi) with min(εi) being the small-
est of εx, εy, and εz of the anisotropic material region interfaced to the UPML. Note that
n =
√
min(εi) is a good choice to guarantee that the values of both αmax(x) and αmax(y) are
large enough corresponding to R, as for the isotropic material region case [21], for unknown
polarized directions in the anisotropic material. With m = 2, sx and sy in Eqs. (18) and (19)
become
sx = 1− j 3λ4pindx
(ρx
dx
)2
ln 1
R
, (24)
sy = 1− j 3λ4pindy
(ρy
dy
)2
ln 1
R
. (25)
By substituting Eqs. (16) and (17) into Eqs. (9)–(12), we obtain
Pxx ¯Hx = k20εyµx ¯Hx +
εy
εzsy
[
s′y
∂ ¯Hx
∂y +
1
sy
∂ 2 ¯Hx
∂y2
]
+
µx
µz
{[
(s′x)
2 +
s′′x
sx
]
¯Hx +
(
3s′x
sx
) ∂ ¯Hx
∂x +
(
1
sx
)2 ∂ 2 ¯Hx
∂x2
}
, (26)
PxyHy =−
εy
εzsy
(
s′y
∂Hy
∂x +
1
sy
∂ 2Hy
∂y∂x
)
+
µy
µzsy
(
s′y
∂Hy
∂x +
1
sy
∂ 2Hy
∂x∂y
)
, (27)
PyyHy = k20εxµyHy +
εx
εzsx
[
s′x
∂Hy
∂x +
1
sx
∂ 2Hy
∂x2
]
+
µy
µz
{[
(s′y)
2 +
s′′y
sy
]
Hy +
(3s′y
sy
) ∂Hy
∂y +
(
1
sy
)2 ∂ 2Hy
∂y2
}
, (28)
PyxHx =−
εx
εzsx
(
s′x
∂Hx
∂y +
1
sx
∂ 2Hx
∂x∂y
)
+
µx
µzsx
(
s′x
∂Hx
∂y +
1
sx
∂ 2Hx
∂y∂x
)
, (29)
where s′x = ∂ (1/sx)/∂x, s′y = ∂ (1/sy)/∂y, s′′x = ∂ 2(1/sx)/∂x2, and s′′y = ∂ 2(1/sy)/∂y2.
Utilizing the pseudospectral Legendre or Chebyshev method, as formulated in [7], Eq. (8)
will lead to a matrix eigenvalue equation of the form, ¯¯A ¯H = β 2 ¯H, with ¯H = [ ¯HTx , ¯HTy
]
, where
the superscript T denotes transpose, ¯Hx and ¯Hy are vectors composed of Hx and Hy values,
respectively, at Legendre or Chebyshev collocation points, and ¯¯A is the operator matrix. The
eigenvalues can be solved by applying the shift inverse power method (SIPM). The computa-
tional domain will be divided into several subdomains of curvilinear quadrilateral shape. Each
subdomain will be mapped into a square region [−1,1]× [−1,1] in the general curvilinear coor-
dinates (ξ ,η). Each subdomain, including the four interfaces, would contain (M+1)×(N+1)
grid points if Legendre or Chebyshev polynomial of degree M is employed in the ξ direction
and that of degree N is employed in the η direction. With both Hx and Hy values to be deter-
mined at each grid point, there are 2(M + 1)(N + 1) unknowns in a single subdomain. So for
#138233 - $15.00 USD Received 16 Nov 2010; revised 7 Jan 2011; accepted 9 Jan 2011; published 13 Jan 2011
(C) 2011 OSA 17 January 2011 / Vol. 19,  No. 2 / OPTICS EXPRESS  1600
In the general multidomain situation, if the computational domain is divided into p subdo-
mains, the matrix eigenvalue equation before imposing boundary conditions across the sub-
domain interfaces would be similar to that of Eq. (27) of [7], with the operator matrix being
a 2pk× 2pk one. The adjacent subdomains are connected by imposing DBCs and NBCs on
the matrix elements, corresponding to the interface grids of the subdomains, in this 2pk×2pk
matrix eigenvalue equation. How such modification of the matrix equation is conducted can
be referred to the Appendix in [15]. When we implement the UPML into an arbitrary leaky
waveguide problem of Fig. 2, regions I and II have the normal vectors parallel to the x-axis
and y-axis, respectively, and regions III are the four corner regions. The sx and sy values for
different regions are listed in Table 1.
Table 1. Definition of sx and sy values in the UPML and non-UPML regions.
Region sx sy
I 1− j 3λ4pindx
(
ρx
dx
)2
ln 1R 1
II 1 1− j 3λ4pindy
(
ρy
dy
)2
ln 1R
III 1− j 3λ4pindx
(
ρx
dx
)2
ln 1R 1− j 3λ4pindy
(
ρy
dy
)2
ln 1R
Non-UPML region 1 1
4. Numerical example: analysis of a six-air-hole microstructured fiber
As a numerical example, we consider a six-air-hole microstructured fiber, or a triangular ho-
ley fiber with one ring of six air holes symmetrically arranged around the core, to assess our
PSMS-UPML. This structure has been analyzed with high numerical accuracy using the multi-
pole method in [18, 19]. It should be noted that with the multipole method, the complex ne f f ’s
of the modes would be obtained by searching zeros of a complex function resulting from the
determinant of a large complex matrix corresponding to a derived homogeneous system of
equations. Achievement of the solutions of high accuracy requires special techniques and care-
ful procedures [18, 19]. Our formulation, however, gives a standard eigenvalue matrix equation
and the eigen solutions are easy to obtain. The first ten modes for the six-air-hole fiber were
solved in [18]. Then, in [19], after discussing in more detail numerical aspects of the formula-
tion, guaranteeing accurate results, and doing numerical verification, more accurate results for
the (nondegenerate) sixth (p = 1) mode were provided, with the imaginary part of ne f f pushed
down to 10−11. We thus compare first our analysis of this sixth mode with that of [19].
d
L
I
II III
Wx
W
y
d y
dx
(a) (b)
Fig. 3. (a) The cross-section of the triangular holey fiber with one ring of six air holes. The
computational domain with UPML regions I, II, and III is shown to contain a quarter of the
cross-section. (b) Mesh division profile of the computational domain.
#138233 - $15.00 USD Received 16 Nov 2010; revised 7 Jan 2011; accepted 9 Jan 2011; published 13 Jan 2011
(C) 2011 OSA 17 January 2011 / Vol. 19,  No. 2 / OPTICS EXPRESS  1602
R values are within 10−6 ∼ 10−12 when analysis methods of limited accuracy are employed
since they could not achieve sufficiently low TREr values to reach better numerical conver-
gency. The maximum number of unknowns used in Figs. 4 and 5(a) is 28224, corresponding
to M = N = 20. For this enough high polynomial degree, the TREr(ne f f ) versus R is plotted
in Fig. 5(b), which shows the decrease of TREr(ne f f ) with decreasing R until R = 10−40, in
consistent with the PML principle that R → 0 for the ideal PML.
Table 2. Real and imaginary parts of the effective index of the sixth mode of the holey
fiber of Fig. 3 obtained using R = 10−70 and different numbers of unknowns.
M = N # of unknowns Re[ne f f ] Im[ne f f ]
8 5184 1.43836460149460 1.43126800×10−6
10 7744 1.43836499203764 1.41439798×10−6
12 10816 1.43836492951038 1.41672907×10−6
14 14400 1.43836493435664 1.41642906×10−6
16 18496 1.43836493418106 1.41648324×10−6
18 23104 1.43836493417833 1.41647509×10−6
20 28224 1.43836493417887 1.41647611×10−6
Table 3. Real and imaginary parts of the effective index of the sixth mode of the holey
fiber of Fig. 3 obtained using 28224 unknowns and different values for the UPML
reflection coefficient.
R Re[ne f f ] Im[ne f f ]
10−6 1.43836506808185 1.41901243×10−6
10−7 1.43836502602347 1.41628611×10−6
10−9 1.43836497960868 1.41371977×10−6
10−10 1.43836496671370 1.41345903×10−6
10−15 1.43836494089064 1.41492053×10−6
10−17 1.43836493782073 1.41548794×10−6
10−20 1.43836493564707 1.41601515×10−6
10−40 1.43836493418305 1.41647478×10−6
10−50 1.43836493417921 1.41647593×10−6
10−60 1.43836493417896 1.41647603×10−6
10−70 1.43836493417887 1.41647611×10−6
The calculated Re[ne f f ]’s and Im[ne f f ]’s corresponding to the R = 10−70 results in Fig. 5(a)
are listed in Table 2 for different polynomial degrees and numbers of unknowns. In Table 2
and the following Tables, the digits of each effective index are shown down to the place of
10−14. It can be seen that our results with M = N = 18 have already agreed with the obtained
value of [19], i.e., the agreement is good to 10−9 for Re[ne f f ] and to 10−11 for Im[ne f f ]. The
calculated Re[ne f f ]’s and Im[ne f f ]’s with M = N = 20 using different Rs from 10−6 to 10−70,
corresponding to Fig. 5(b), are listed in Table 3. We also examine the effect of the distance
between the six air-holes and the UPML layers, or the size of the computational window. With
fixed dx = dy = 2 µm, Wx = Wy in Fig. 3 is varied from 13 to 15.75 µm. The number of un-
knowns is taken to be 28224 and M = N = 20. The obtained (Re[ne f f ] − 1.438364934) and
Im[ne f f ] are shown in Figs. 6(a) and (b), respectively, versus Wx =Wy for R = 10−7 and 10−70.
It is seen that both Re[ne f f ] and Im[ne f f ] for R = 10−70 almost do not vary with Wx =Wy under
the scales shown while those for R = 10−7 show significant variations. The ranges of variation
for both Re[ne f f ] and Im[ne f f ] values for R = 10−7 are almost on the same order and are about
2× 10−7. And it is interesting to observe that for R = 10−7, when Re[ne f f ] reaches the most
#138233 - $15.00 USD Received 16 Nov 2010; revised 7 Jan 2011; accepted 9 Jan 2011; published 13 Jan 2011
(C) 2011 OSA 17 January 2011 / Vol. 19,  No. 2 / OPTICS EXPRESS  1604
0.5 1 1.5 2 2.5 3
x 10
4
10
-14
10
-12
10
-10
10
-8
10
-6
Number of unknowns
e
ff
T
o
ta
l
re
la
ti
v
e
e
rr
o
r
in
n
Wx=Wy=15.75
R=10
-70
Wx=Wy=13.75 mm
mm
Fig. 7. Total relative errors in the effective index of the sixth mode in the holey fiber of
Fig. 3 versus the number of unknowns for two different computational domain sizes, Wx =
Wy = 13.75 µm and Wx =Wy = 15.75 µm.
Table 4. Real and imaginary parts of the effective index of the fundamental mode of
the holey fiber of Fig. 3 obtained using 28224 unknowns and three different values for
the UPML reflection coefficient.
R Re[ne f f ] Im[ne f f ]
10−50 1.44539525694578 3.194406×10−8
10−60 1.44539525694807 3.194660×10−8
10−70 1.44539525694857 3.194695×10−8
Table 5. Real and imaginary parts of the effective index of the fundamental mode of
the holey fiber of Fig. 3 obtained with R = 10−70 and different numbers of unknowns.
# of unknowns Re[ne f f ] Im[ne f f ]
5184 1.44539517743614 3.199201×10−8
7744 1.44539527661862 3.192259×10−8
10816 1.44539525482869 3.194883×10−8
14400 1.44539525701175 3.194700×10−8
18496 1.44539525691598 3.194693×10−8
23104 1.44539525694432 3.194696×10−8
28224 1.44539525694857 3.194695×10−8
Table 6. Real and imaginary parts of the effective indices and losses of the first six
modes of the holey fiber of Fig. 3 obtained using 28224 unknowns and R = 10−70.
p Re[ne f f ] Im[ne f f ] Loss (dB/m)
3 1.44539525694857 3.194695×10−8 1.2024
4 1.44539525694852 3.194693×10−8 1.2024
2 1.43858364729137 5.3107865×10−7 19.9887
5 1.43844483196661 9.7308505×10−7 36.6249
6 1.43844483196658 9.7308502×10−7 36.6249
1 1.43836493417887 1.41647611×10−6 53.3132
is 1.445395256948− j3.1947× 10−8. We then list in Table 6 the calculated Re[ne f f ]’s and
Im[ne f f ]’s, with the corresponding loss values in dB/m, of the first six modes which are the p =
3, 4, 2, 5, 6, and 1 modes in sequence designated in [18] using M =N = 20 and R= 10−70. Note
that p = 3 and p = 4 modes are twofold degenerate, and so are p = 5 and p = 6 modes. The
loss in dB/m is obtained by multiplying Im[ne f f ] by (20/[ln(10)])(2pi/λ )×106 [18], where λ
is in micrometers. Although the numerical accuracy of the results in [18] is not as high as those
in [19], the loss values in dB/m for the first six modes listed in Table 1 of [18], i.e., 1.2, 20, 37,
#138233 - $15.00 USD Received 16 Nov 2010; revised 7 Jan 2011; accepted 9 Jan 2011; published 13 Jan 2011
(C) 2011 OSA 17 January 2011 / Vol. 19,  No. 2 / OPTICS EXPRESS  1606
by the differential matrix operation under the pseudospectral theory. In Fig. 8, for each mode,
the |Ez|, |Hz|, |Ex|, and |Hy| mode-field profiles are shown, with the maximum of each profile
set to be unity. The |Ez| and |Hz| profiles for the first three modes (p = 3, p = 4, and p = 2) are
found to be consistent with those shown in Figs. 4 and 5 of [18]. One interesting observation
is worth mentioning in the following. Note that |Hx| and |Hy| profiles of the p = 2 and p = 6
modes appear to have very little differences but their |Ez| and |Hz| profiles have obvious dif-
ferent features. The same can be observed between the p = 5 and p = 1 modes. Moreover, it
can be seen that the |Hx| (|Hy|) profile of the p = 2 mode resembes the |Hy| (|Hx|) profile of the
p = 5 mode, and the same feature exists between the p = 6 and p = 1 modes. Such fact should
not be surprising since these four modes actually possess very close Re[ne f f ]’s with the same
leading digits, 1.438, as seen in Table 6. And more noticeable differences appear in the |Ez| and
|Hz| profiles.
5. Conclusion
We have reported the implementation of UPML absorbing boundary conditions into our pre-
viously developed full-vectorial optical waveguide eigenmode solver using pseudospectral
frequency-domain (PSFD) formulations for waveguides with arbitrary step-index profile. With
UPMLs around the computational domain in this PSMS-UPML solver, leaky waveguides can
be treated and their complex modal effective indices determined. The solver is derived under
the Hx-Hy formulation by considering the Helmholtz equations. The spatial derivatives in the
equations are approximated at collocation points by utilizing Chebyshev-Lagrange interpolat-
ing polynomials, leading to a matrix eigenvalue equation with the squared complex propaga-
tion constant as the eigenvalue. We have shown other field components can be determined with
high accuracy from the obtained Hx and Hy (eigen vector) with the required spatial derivatives
treated by the same approximation at collocation points. The high-accuracy performance of the
PSMS-UPML is demonstrated by using a six-air-hole microstructured fiber as an analysis ex-
ample, with the comparison made with published high-accuracy multipole method results [19]
for both the real and imaginary parts of the effective indices. In particular, the role of the UPML
reflection coefficient, R, in achieving high-accuracy mode solution results is investigated in de-
tail. It is shown that by setting the values of R as small as on the order of 10−40 ∼ 10−70, relative
errors in the calculated complex effective indices can be as small as on the order of 10−12.
Acknowledgments
This work was supported in part by the National Science Council of the Republic of China
under grants NSC97-2221-E-002-043-MY2 and NSC97-2221-E-151-055-MY2, in part by the
Excellent Research Projects of National Taiwan University under grant 98R0062-07, and in
part by the Ministry of Education of the Republic of China under ”The Aim of Top University
Plan” grant. The authors would like to acknowledge the National Center for High-Performance
Computing in Hsinchu, Taiwan for providing useful computing resources.
#138233 - $15.00 USD Received 16 Nov 2010; revised 7 Jan 2011; accepted 9 Jan 2011; published 13 Jan 2011
(C) 2011 OSA 17 January 2011 / Vol. 19,  No. 2 / OPTICS EXPRESS  1608
 
2. Material Model and Polarizability of Systems 
 
 The relative permittivity formula of the Drude-Lorentz (D-L) model is expressed as 
2 2
2 2
1
( )
( ) ( )
k
p j
DL
j
p
j j
f
i i
ω ωε ω ε ω ω τ ω ω ω∞ == − ++ − − Γ∑                             (1) 
where ε∞  is the high-frequency limit of the dielectric constant, pω  is the plasma frequency, τ  is 
the life time, and k is the number of oscillators with oscillator j characterized by frequency jω , 
strength jf , and the damping constant jΓ . To obtain the values of these parameters, we combine 
two optimization schemes to carry out the curve-fitting action on the measured data of silver 
provided in [7]. Firstly, we define an objective function 
( ) ( )( ) ( ) ( )( ){ }2 2exp expRe Im
j
j DL j j DL j
ω
ε ω ε ω ε ω ε ω⎡ ⎤ ⎡Ψ = − + −⎣ ⎦ ⎣∑ ⎤⎦                          (2) 
ε 3.07∞ = 1283996.63335 10pω = ×
rad sec -120.01485 10 secτ = × 1 0.065f = 121 7793.80694 10 rad secω = × 1 37116.08Γ = ×
12
2 42502.97395 10 rad secω = × 2 0.124f =1210 rad sec 122 5730.73812 10 rad secΓ = ×
where expε  and DLε represent measured data and the D-L model values, respectively. The jω ’s are 
the set of discrete frequency values for getting the relative permittivities. The parameters to be 
determined are then refined by employing the genetic algorithm and the nonlinear least squares 
method alternately until good results are obtained. However, for relieving the computational loading 
and not effecting the results, we manually modify the parameters and get rid of the redundant 
Lorentz terms at the same time. The parameters obtained are:         ,           
                                              ,                                                              ,                            ,
                                                                ,            
 ,           ,          
       ,               and 
. Figure 1 shows the comparison between the measured relative permittivity values (black lines) and 
the obtained D-L model values (red lines) in the wavelength region from 0.2 μm to 1.1 μm. Good 
agreement is seen for wavelengths larger than 0.3 μm.  
 
                                                       (a)                                                            (b) 
Figure 1: The permittivity of silver in the optical wavelength region.  
(a) The real part. (b) The imaginary part. 
 
 The scenario of our simulation is depicted in Fig. 2 (a) which shows a 2D nanoparticle 
square-lattice array extended to infinity in the x-y plane with an incident polarized electromagnetic 
wave propagating along the direction of the minus z-axis. We consider the structure of a square unit 
cell with periodic boundary conditions (PBCs) parallel to the z-axis, as shown in Fig. 2 (b). The 
particle is taken as a sphere with the fixed diameter, D = 25 nm and various sizes of gap, W = 25, 20, 
15, 10, and 5 nm are considered. The lattice constant is a = D + W.  The relative permittivities for 
air and the silver are 1 1ε = and ( )2 DLε ε ω= , respectively. 
 The estimation of the effective polarizabilities of the 2D systems by the dipole model [4] is 
described as follows. The dipole moment ip
G
induced in particle  at is given i ir
G
 
found to be about 20 nm. 
              
                 
                                                (a)                                                         (b) 
Figure 3:  (a) The comparison between the normalized reflectance from the dipole model and the 
normalized monostatic RCS from PSTD simulations. (b) Enlargement of (a) for viewing the peaks. 
4. Conclusion 
 
 We have applied the 3D Legendre pseudospectral time-domain scheme to study the optical 
properties of 2D plasmonic nanoparticle square arrays with different gap sizes. Numerical 
simulation results have been compared with a theoretical dipole model which provides quick 
analysis, and good agreement was obtained. The high-accuracy numerical scheme is especially 
suited for dealing with metal-dielectric interfaces in plasmonics problems. The more precise Drude-
Lorentz model has been introduced to provide a better material model and thus more accurate 
calculation in the wavelength region from visible to the near infrared. 
Acknowledgments 
 This work was supported in part by the National Science Council of the Republic of China 
under grant NSC96-2221-E-002-097, in part by the Excellent Research Projects of National Taiwan 
University under grant 95R0062-AE00-06, and in part by the Ministry of Education of the Republic 
of China under “The Aim of Top University Plan” grant. 
  
References 
 
[1]  M. Fleischmann, P. J. Hendra, A. J. Mcquillan, “Raman spectra of pyridine adsorbed at a silver 
electrode”, Chem. Phys. Lett., vol. 26, pp. 163-166, 1974. 
[2] S. Nie and S. R. Emory, “Probing single molecules and single nanoparticles by surface-
enhanced Raman scattering”, Science, vol. 275, pp. 1102-1106, 1997. 
[3] H. H. Wang et al., “Highly Raman-enhancing substrates based on silver nanoparticle arrays with 
tunable sub-10 nm gaps”, Adv. Mater., vol. 18, pp. 491-495, 2006. 
[4] B. N. J. Persson and A. Liebsch, “Optical properties of two-dimensional systems of randomly 
distributed particles”, Phys. Rev. B, vol. 28, pp. 4247-4254, 1983. 
[5] J. S. Hesthaven and D. Gottlieb, “A stable penalty method for the compressible Navier-Stokes 
equations. III. Multidimensional domain decomposition schemes,” SIAM J. Sci. Comput., vol. 
20, pp. 62-93, 1998. 
[6] C. H. Teng, B. Y. Lin, H. C. Chang, H. C. Hsu, C. N. Lin, and K. A. Feng, “A Legendre 
pseudospectral penalty scheme for solving time-domain Maxwell's equations”, J. Sci. Comput., 
2008. (in press). 
[7] David W. Lynch and W. R. Hunter, ``Comments on the optical constants of metals and an 
introduction to the data for several metals," in Handbook of optical constants of solids, E.D. 
Palik, ed., pp. 350-357, Academic Press, Orlando, Fla., 1985. 
Cext = −(4/k)Re{∑+∞q=−∞ bq( j)q exp( jqΘinc)}, and
Cabs =Cext −Csca, where k is the wavevector and Θinc is
the incident angle. The PSTD method developed is based
on the multidomain approach and Legendre polynomials
such that field continuity conditions across the material
interfaces can be properly fulfilled through rigorous
treatment between adjacent subdomains. High-accuracy
calculation is thus possible even for plasmonic problems
involving metal-dielectric interfaces [8]. For application
to the infinite-array problem, only a period of the array
needs to be analyzed. And for numerical calculation of
the various cross sections, those definitions in integral
form in [7] are directly used.
RESULTS AND DISCUSSION
To verify the MSM, comparison with two results calcu-
lated by the FDTD method [5] is first conducted. Fig-
ure 2(a) and (b) present calculated cross sections for two
and four coated metallic nanowires, respectively, from
the two methods. The solid and dashed lines are from [5]
and the rest are obtained using the MSM. Each nanowire
is composed of a silver core with radius a = 25 nm and
a dielectric shell of width s = 5 nm. The relative per-
mittivity of the dielectric shell is ε1 = 2.25 and the inter-
nanowire gap is W = 2.5nm. As for the permittivity prop-
erty of silver, the same Drude model as used in [5] is
employed here. However, the Drude-Lorentz model con-
structed in [8] will be used in later calculations. We can
see that both methods predict similar behaviors qualita-
tively, but differences in values are obvious. It can be un-
derstood that for such narrow inter-nanowire gap, high-
accuracy FDTD calculation could be difficult because
very fine mesh is required.
We use the MSM to calculate cross sections for arrays
of Fig. 1 for N from 10 up to 160. Here, each nanowire
is assumed to be composed of a silver core with radius
a = 10 nm and a dielectric shell of width s = 2.5 nm,
with the relative permittivity of the dielectric shell being
ε1 = 3. The results are given in Fig. 3(a) and (b) for
W = 25 nm and 5 nm, respectively. It is seen in Fig.
3(a) that for N ≥ 20, the results do not change much
with N. In Fig. 3(b), which is for much smaller W ,
although the cross sections still vary with N for N ≥ 40,
the variation is slow. It is observed that for a given N, the
cross sections are larger for the smaller-W array.
We then study the scattering by an infinite array using
the PSTD method. The computational domain is one
period of the structure, as shown in Fig. 4(a), where
PBCs are assigned at the left and right boundaries and
the perfectly matched layers (PMLs) are employed on
the top and bottom of the domain. Figure 4(b) illustrates
a portion the PS mesh including the nanowire region.
FIGURE 2. The optical spectra of (a) two and (b) four
dielectric-coated silver nanowires. The lines with and without
symbols are calculated by the MSM and from [5] by the FDTD
method, respectively.
0
200
400
600
C
ab
s
/n
m
0
200
400
600
C
sc
a
/n
m
λ (nm)
0
400
800
300 400 500
N=10
N=80
N=100
N=60
N=40
N=20
C
ex
t/n
m
N=10
N=80
N=100
N=60
N=40
N=20
N=10
N=80
N=100
N=60
N=40
N=20
∗∗
∗
∗
∗
∗
∗
∗
∗
∗
∗
∗
++
+
+
+
+
+
+
+
+
+
+
1000
2000
0
+ N=160
∗ N=140 N=10
N=80
N=100
N=60
N=40
N=20
N=120
∗ ∗
∗
∗
∗
∗
∗
∗
∗
∗
∗
∗
∗
+ +
+
+
+
+
+
+
+
+
+
+
+
0
500
1000
1500
0
200 ∗ ∗
∗
∗
∗
∗
∗
∗
∗
∗
∗
∗
∗
+ +
+
+
+
+
+
+
+
+
+
+
+
400
λ (nm)
300 400 500
N=10
N=80
N=60
N=40
N=20
N=100
+ N=160
∗ N=140
N=120
+ N=160
∗ N=140N=10
N=80
N=100
N=60
N=40
N=20
N=120
(a) (b)
FIGURE 3. The calculated cross sections of silver nanowire
arrays of Fig. 1 for different Ns. The inter-nanowire gap widths
are (a) W = 25 nm and (b) W = 5 nm, respectively.
It can be seen that the mesh grids are designed to be
fine enough in this region to assure numerical accuracy.
The calculated scattering and absorption cross sections
for W = 5 nm up to 25 nm are shown in Fig. 5(a)
and (b), respectively, along with the cross sections for
a single manowirw (the dotted lines) obtained using the
analytical scattering method. The nanowire parameters
are the same as those considered in Fig. 3. The cross
Investigations of Subwavelength-Fiber Based THz Couplers 
Chih-Hsien Lai,1,2 Chi-Kuang Sun,1,3 and Hung-chun Chang1,4,*  
1Graduate Institute of Photonics and Optoelectronics and Department of Electrical 
Engineering, National Taiwan University, Taipei, 10617, Taiwan 
2Department of Electronic Engineering, Hwa Hsia Institute of Technology, Taipei, 23568, 
Taiwan 
3Research Center of Applied Sciences, Academia Sinica, Taipei, 10617, Taiwan 
4Graduate Institute of Communication Engineering, National Taiwan University, Taipei, 
10617, Taiwan 
(hcchang@cc.ee.ntu.edu.tw, NSC-97-2221-E-002-043-MY2, NSC-97-2221-E-002_047-MY3, 
NSC-96-2628-E-002-043-MY3, NSC-98-2120-M-002-001) 
Abstract --- Due to the far-extension nature of the subwavelength THz fibers, the so-formed THz couplers 
behave differently from the conventional fiber-optic ones. We theoretically investigate the characteristics of 
such THz couplers. Numerical results show that, when the fiber separation is small, cutoff of the odd system 
mode occurs. Moreover, because the x-polarized even system mode has a more confined field distribution than 
that of the y-polarized one, which is similar to the behavior of a slot waveguide, the difference between the 
excited modal powers can be up to 17%. 
Keywords: Fiber couplers, terahertz devices, subwavelength fiber structures. 
INTRODUCTION 
Terahertz (THz) technology has attracted growing attentions with its promising potential for applications in 
sensing, imaging, and spectroscopy [1]. To build a compact and robust THz system, it is essential to develop 
low-loss THz waveguides. Recently, subwavelength dielectric fiber [2] was proposed for THz waveguiding. 
Because fields of the guided modes extend far into the surrounding air, material loss is substantially minimized 
and low attenuation constants less than 0.01 cm-1 [2] was reported. Utilizing such THz waveguides, THz 
imaging systems such as endoscopes and microscopes were demonstrated [3,4]. Moreover, owing to the 
far-extension nature, THz couplers, one important device for THz communication and imaging systems, can be 
easily formed when two such THz waveguides are placed in close proximity [5]. However, unlike conventional 
fiber-optic couplers, experiments showed that the subwavelength-fiber based THz couplers exhibit less 
dependence on not only the operating frequency but also the overlapped length of the two THz waveguides [5]. 
For conventional coupler applications, for example, the one consisting of two identical and parallel 
single-mode optical fibers, the guided mode of one isolated fiber ψ1 is launched into the coupler. The even and 
odd system modes ψ+ and ψ− of the coupler are almost equally excited, i.e., the excited modal powers are |a+|2 ≈  
|a−|2 ≈ 50%, where a+ and a− are the normalized modal amplitudes of ψ+ and ψ−, respectively. Because phase 
velocities of the two system modes are different, beating of ψ+ and ψ− causes the power to transfer periodically 
from one fiber to another.  
In this work, we theoretically investigate the characteristics of the subwavelength-fiber based THz couplers 
by using the finite-difference frequency-domain (FDFD) method [6]. Numerical results indicate that, when the 
separation between the two subwavelength fibers is not large enough, cutoff of the odd system mode ψ− occurs 
and only the even system mode ψ+ is guided in the coupler with |a+|2 far above 50%. Moreover, for small 
separations, field distributions of the x-polarized ψ+ are more confined than that of the y-polarized one, leading 
to a significant difference, which can be up to 17%, between the excited modal powers |a+|2 of the two 
polarizations. 
NUMERICAL ANALYSIS 
Figure 1 shows the longitudinal cross-section of the subwavelength-fiber based  THz coupler, which 
consists of two identical and parallel subwavelength fibers with core diameter d and separation s. The 
subwavelength fibers are assumed to be with PE cores (nc = 1.52) and air claddings (na = 1) [2], and the 
fundamental HE11 mode is the only guided mode [2]. Here we assume d = 270 μm and f = 320 GHz (λ = 937.5 
μm). Like conventional coupler applications, the fundamental mode of one such fiber ψ1 is launched into the 
coupler. However, according to our calculation, when s < 1,700 μm, cutoff of the odd system mode ψ− will 
discontinuity occurs at the interfaces, causing the x-polarized even system mode ψ+ strongly confined in the air 
region between the two subwavelength fibers. Therefore, field profile of the x-polarized ψ+ is more confined 
than that of the y-polarized one, which makes the attributes of the two polarizations very different for small 
separations. Figure 4 shows the enlarged magnitude contours of the major electric field component (Ex) for the 
x-polarized ψ+ for s = 0, 135, 270, 405, 540, 675, and 810 μm, respectively, with d = 270 μm and f = 320 GHz, 
while Fig. 5 shows the amplitudes of Ex along the line (x-axis) joining the two fiber centers. It is obvious that for 
small separations, field distributions of the x-polarized ψ+ resemble that of a slot waveguide. The similarity is 
lost when s becomes larger. 
 
Fig. 4. Enlarged magnitude contours of Ex for the 
x-polarized even system mode ψ+ with some s values 
of (a) 135 μm, (b) 270 μm, (c) 405 μm, (d) 540 μm, (e) 
675 μm, and (f) 810 μm. The black circles indicate the 
positions of the subwavelength fibers. 
Fig. 5. Amplitudes of Ex for the x-polarized even system 
mode ψ+ along the x-axis (y = 0) with some s values of 
(a) 135 μm, (b) 270 μm, (c) 405 μm, (d) 540 μm, (e) 675 
μm, and (f) 810 μm. The black dashed lines indicate the 
boundaries of the subwavelength fibers. 
 
CONCLUSION 
In conclusion, we have investigated the characteristics of the subwavelength-fiber based THz couplers. For 
small fiber separations, odd-mode cutoff occurs and no beating takes place since only the even system mode is 
guided, with the excited modal power far above 50%. Because the x-polarized even system mode has a more 
confined field distribution than the y-polarized one when the fiber separation is small, similar to the behavior of 
a slot waveguide, the amounts of the excited modal power for the two polarizations are different. The maximum 
difference can be up to 17% and this value occurs when the two subwavelength fibers touch each other. 
REFERENCES 
[1] D. Abbott and X.-C. Zhang, “Scanning the issue: T-ray imaging, sensing, and retection,” Proc. IEEE, vol. 95, 
pp. 1509−1513, 2007. 
[2] L.-J. Chen, H.-W. Chen, T.-F. Kao, J.-Y. Lu, & C.-K. Sun, “Low-loss subwavelength plastic fiber for 
terahertz waveguiding,” Opt. Lett., vol. 31, pp. 308−310, 2006. 
[3] J.-Y. Lu, C.-M. Chiu, C.-C. Kuo, C.-H. Lai, H.-C. Chang, Y.-J. Hwang, C.-L Pan, and C.-K. Sun, “THz 
scanning imaging with a subwavelength plastic fiber,” Appl. Phys. Lett., vol. 92, 084102, 2008. 
[4] C.-M. Chiu, H.-W. Chen, Y.-R. Huang, Y.-J. Hwang, W.-J. Lee, H.-Y. Huang, and C.-K. Sun, “All-terahertz 
fiber-scanning near-field microscopy,” Opt. Lett., vol. 34, pp. 1084−1086, 2009. 
[5] H.-W. Chen, C.-M. Chiu, C.-H. Lai, J.-L. Kuo, P.-J. Chiang, Y.-J. Hwang, H.-C. Chang, and C.-K. Sun, 
“Subwavelength dielectric-fiber-based THz coupler,” J. Lightwave Technol., vol. 27, pp. 1489−1495, 2009. 
[6] C.-P. Yu and H.-C. Chang, “Yee-mesh-based finite difference eigenmode solver with PML absorbing 
boundary conditions for optical waveguides and photonic crystal fibers,” Opt. Express, vol. 12, pp. 
6165−6167, 2004. 
[7] V. R. Almeida, Q. Xu, C. A. Barrios, and M. Lipson, “Guiding and confining light in void nanostructure,” 
Opt. Lett., vol. 29, pp. 1209−1211, 2004. 
The x-z plane view of the 1 × 2 power splitter is shown in Fig. 2. Parameters of this structure are as follows: 
Win (width of the input waveguide) is 0.5 μm, WMMI (width of the multimode waveguide) is the parameter to be 
varied, gap means the distance between the centers of the two output ports, and z means the two-fold imaging 
length. The output coupling efficiency will be improved through choosing gap and z. 
 
Figure 2. The top view of the MMI power splitter structure. 
 
We arrange simulated results with different widths of the multimode waveguide. Figure 3(a), (b), (c), and (d) 
shows contour fields with WMMI = 1, 1.5, 2, and 3 μm, respectively. We find the case with WMMI = 1 μm cannot 
form the two-fold image, due to that the excited coefficient of the second even mode is too small. In light of the 
multimode waveguide, suitable condition for the imaging mechanism appears only in the case of having more 
than two excited modes by the input field. For the case of WMMI = 1 μm, although it can support three modes, 
two even modes and one odd mode, the excited coefficient of the odd mode is almost equal to zero (because of 
symmetric interference), and the excited coefficient of the second even mode is small compared with that of the 
fundamental mode. Because WMMI is too small and close to Win, the excited coefficient of the fundamental mode 
is larger than that of the second order mode relatively. For the case with WMMI = 1.5 μm, it also supports two 
even modes. But because the excited coefficient of the second even mode is larger than that in the case of WMMI 
= 1 μm, it could form the two-fold image. 
 
     
   
Figure 3. (a)~(d) Contours of the major field for WMMI = 1, 1.5, 2, and 3 μm, respectively. 
     
  
 
 出席國際學術會議報告 
民國 98 年 7 月 31 日 
 
會議名稱：2009年積體光電與奈米光電研究與應用研討會 (2009 OSA Integrated 
 Photonics and Nanophotonics Research and Applications (IPNRA ’09) Topical 
 Meeting ) 
時    間：2009年7月12日至7月15日 
地    點：美國夏威夷州檀香山市 
發表掄文：1. C. H. Lai, C. K. Sun, and H. C. Chang, “Analysis of THz Antiresonant 
Reflecting Tube Waveguides” 
2. M. Y. Chen and H. C. Chang, “A Full-Vectorial Finite-Difference Eigenmode 
Solver for Anisotropic Optical Waveguides with Arbitrary Permittivity Tensor” 
3. P. J. Chiang, N. H. Sun, and H. C. Chang, “The Effect of Choosing PML 
Reflection-Coefficient Value on Numerical Accuracy in the Pseudospectral 
Leaky Waveguide Mode Solver” 
出席人：  張宏鈞  臺大光電所／電機系教授 
 
（一）參加會議經過 
 
筆者由本校邁向頂尖大學優勢重點領域拔尖計畫下經費與國科會專題研究計畫補助
旅費前往美國夏威夷州檀香山市參加由美國光學學會(Optical Society of America)所主辦
之「2009年積體光電與奈米光電研究與應用研討會(2009 OSA Integrated Photonics and 
Nanophotonics Research and Applications (IPNRA ’09) Topical Meeting)」，筆者為三篇口
頭報告論文的共同作者。筆者7月12日上午離開台北，於7月12日上午飛抵檀香山，傍晚
前先至會場所在的Hilton Hawaiian Village Beach Resort &Spa領取會議資料。筆者的兩位
博士生，賴志賢與陳明昀，亦出席會議親自發表論文。 
IPNRA研討會原名稱為IPR，2005年起加了Applications字眼，2007年與另一新的
Nanophotonics Topical Meeting整合，又多了Nanophotonics字眼，筆者多年前曾參加過三
次，停了好多年後，2004年受邀發表了一篇邀請論文，感覺研討會有許多論文內容和筆
者目前研究興趣相近，因此有興趣連續第六年與會。前年起亦受邀擔任三年的Technical 
Subcommittee Member。IPNRA研討重點有四大項目：Active waveguide devices, Passive 
waveguide devices, Modeling, numerical simulation and theory, Nanophotonic devices and 
applications。今年的新安排是IPNRA與另外兩個Topical Meetings同時同會議地點舉行，
 1
  
 
 
 3
OSA上層希望將Silicon Photonics名稱置入IPR名稱之中，以避免另闢一Silicon Photonics
的Topical Meeting，大家有許多不同意見，討論許久，一直無法獲得對於研討會新名稱
的一致認同，只好建議再以電子郵件調查方式做最後確定。 
14日晚上七時至十時為Conference Luau晚宴，品嚐夏威夷著名的luau餐，同時有精
彩的波里尼西亞歌唱舞蹈文化表演，讓與會者留下難忘回憶。筆者於16日中午搭機飛日
本成田機場，轉機於17日晚間返抵台北。 
 
（二）與會心得與建議 
 
本次IPNRA研討會有135位註冊與會者，來自臺灣有8位。IPNRA的研討內容和筆者
個人的研究興趣以及目前的研究題目相符，因此收穫很多，Slow and Fast Light與
Nonlinear Optics場次也有許多關於photonic crystals, plasmonics與metamaterials方面的精
彩論文，由不少著名學者的邀請論文可獲得許多新近研究趨勢的資訊。 
IPNRA算是在optical waveguide numerical modeling領域重要的國際研討會，和筆者
熟識的此領域著名學者，多會與會發表新近研究成果，得以有機會有更多交流。筆者已
擔任三年的“Modeling, Numerical Simulation and Theory”課題的Technical Subcommittee 
Member，本次研討會中受邀擔任明年此一Technical Subcommittee的Chair。 
 
（三）攜回資料名稱及內容 
 
1.  Advances in Optical Sciences: OSA Optics & Photonics Congress 2009, Conference 
Program, 共84頁。 
2.  Advances in Optical Sciences: OSA Optics & Photonics Congress 2009, Technical Digest 
CD-ROM一片。 
3.  Postdeadline Papers, Advances in Optical Sciences: OSA Optics & Photonics Congress 
2009, 共73頁。 
antiresonant conditions of the cladding, i.e., at the frequencies away from the resonant ones, considerable reflections 
at the core-cladding interface cause the core modes to appear resulting from the fact that waves bounce back and 
forth inside the core region. In the regime of glancing reflections, the resonant frequencies can be derived as 
                                                                
2
1 2 1
,     1, 2,3,
2 ( / ) 1
m
mcf m
n t n n
= =
−
…                                                        (1) 
3. Modal characteristics of the fundamental mode and the higher order core modes 
Modal characteristics of the tube waveguide are numerically examined for the structure of core diameter D = 9 mm 
and cladding thickness t =1.0 mm. Modal index and attenuation constant of the core mode are defined as Re(β)/k0 
and −2Im(β), respectively, where β is the complex propagation constant and k0 is the free-space wavenumber. 
Numerical results are obtained utilizing the FDFD mode solver [6]. For the calculations, the computational window 
size is 14 mm x 14 mm, the grid size is Δx = Δy = 0.025 mm, and the perfectly matched layer (PML) is placed at the 
outmost to surround the computational window. 
 
 
(a) 
 
(b) 
Fig. 2. (a) Modal intensity distributions and (b) electric field vector distributions of the four lowest modes at 380 GHz. 
Modal intensity distributions and electric field vector distributions of the first four lowest modes at 380GHz are 
shown in Fig. 2. These patterns resemble those of a conventional step-index fiber, therefore, following the 
designation of a step-index fiber, the four modes are labeled as the HE11, TM01, HE21, and TE01 modes, respectively.  
 
(a) (b) 
Fig. 3. (a) Modal indices and (b) attenuation constants of the four lowest modes. 
Modal indices and attenuation constants of the first four lowest modes are calculated over the frequency range 
between 200 and 900GHz and are shown in Fig. 3. It is observed that there are discontinuities in the spectrum. At 
the discontinuity frequencies, no core modes can be found. In fact, these frequencies coincide with the resonant 
frequencies of the cladding predicted by Eq. (1), indicating that guiding mechanism of the tube waveguides is 
A Full-Vectorial Finite-Difference Eigenmode Solver
for Anisotropic Optical Waveguides with Arbitrary
Permittivity Tensor
Ming-Yun Chen and Hung-chun Chang∗
Graduate Institute of Photonics and Optoelectronics
National Taiwan University, Taipei, Taiwan 10617, R.O.C.
∗also with Department of Electrical Engineering and Graduate Institute of
Communication Engineering, National Taiwan University
E-mail: hcchang@cc.ee.ntu.edu.tw
Abstract: A finite-difference frequency-domain (FDFD) method based full-vectorial eigen-
mode solver is developed for analyzing anisotropic optical waveguides with arbitrary per-
mittivity tensor. Guided modes on liquid-crystal-filled optical waveguides with different
liquid-crystal molecular orientations are solved and discussed.
c©2009 Optical Society of America
OCIS codes: (230.3720) Liquid-crystal devices; (230.7370) Waveguides; (260.2110) Electro-
magnetic optics.
1. Introduction
The finite-difference (FD) method is attractive in establishing optical waveguide mode solvers due to its
advantage of simple formulation and numerical implementation. However, relatively fewer FD works deal
with structures including anisotropic materials [1–4] and they at most considered anisotropy in the transverse
plane, i.e., in the waveguide cross-section. Recently, Fallahkhair et al. [5] proposed a more rigorous vector FD
mode solver for anisotropic waveguides, but again assuming non-diagonal anisotropy only in the transverse
plane.
In this paper, we present a finite-difference frequency-domain (FDFD) method for solving full-vector
modes of optical waveguides with arbitrary permittivity tensor, i.e., with general three-dimensional (3-D)
anisotropy. The FDFD method particularly refers to the FD approach based on the Yee mesh as popularly
used in the finite-difference time-domain method. We derive a matrix standard eigenvalue problem for
the FDFD method, which is easier to solve for the guided modes. We also incorporate perfectly matched
layers (PMLs) for anisotropic media [6] into our formulation as the absorbing boundary condition at the
outer boundaries of the computational domain. As numerical examples, we discuss the guided modes on a
liquid-crystal-filled optical waveguide with arbitrary liquid-crystal (LC) molecular director orientation.
2. Formulation
In the frequency domain, Maxwell’s curl equations can be written as the following equations:
−jωµxHx =∂Ez
∂y
+ jβEy, jωDx =
∂Hz
∂y
+ jβHy (1)
−jωµyHy =− jβEx − ∂Ez
∂x
, jωDy =− jβHx − ∂Hz
∂x
(2)
−jωµzHz =∂Ey
∂x
− ∂Ex
∂y
, jωDz =
∂Hy
∂x
− ∂Hx
∂y
(3)
where µx, µy, and µz represent diagonal elements of the diagonal permeability tensor and β is the modal
propagation constant. For the general anisotropic dielectric medium, the relation between ~E and ~D is written
at each spatial point by
Dx = ²xxEx + ²xyEy + ²xzEz (4)
Dy = ²yxEx + ²yyEy + ²yzEz (5)
Dz = ²zxEx + ²zyEy + ²zzEz. (6)
By arranging the Yee’s mesh in the computational domain over the waveguide cross-section, using the central
difference scheme to convert Eqs. (1)–(3) into difference equations, and including Eqs. (4)–(6), the following
where no = 1.5292, ne = 1.7072, θc is the angle between the crystal c-axis and the z-axis, and φc is the angle
between the projection of the crystal c-axis on the x-y plane and the x-axis, as defined in Fig. 1 (b). The
LC molecules can be rotated through an applied voltage to change the permittivity tensor in the LC-core
region. We calculate and examine the guided mode under different LC-rotated situations. Here we consider
θc = 0◦ and 30◦, and at each θc the angle φc is varied from 0◦ to 90◦.
For θc = 0◦, it is obvious that different φc’s correspond to the same situation and we obtain two modes
with the effective indices of 1.504400 (mode 1) and 1.504382 (mode 2). It is found that modes 1 and
2 are basically y- and x-polarized, respectively. Then, we consider the situation when θc = 30◦. Now,
different φc corresponds to different core property. It should be noted that, although the waveguide is with
symmetric background structure, the θc = 30◦ orientation has caused the loss of transverse-axis symmetries
of the problem and we have to include the whole cross-section as shown in Fig. 1(a) in the computation.
Asymmetric mode-field profiles are obtained as will be presented below. The calculated effective indices for
different φc’s for the obtained four modes are shown in Fig. 1(c). The |Ex| and |Ey| profiles of modes 1
and 2 for φc = 0◦, 30◦, 60◦, and 90◦ are illustrated in Fig. 2. Except for φc = 90◦, which corresponds to
both structure geometry and permittivity tensor symmetries, the field profiles appear to possess asymmetric
characteristics of various degrees. For mode 1, it is almost x-polarized at φc = 0◦ and 30◦, and changes to
be almost y-polarized at φc = 60◦ and 90◦. For mode 2, |Ex| component is more significant than the |Ey|
component at φc = 0◦ and 30◦, and |Ey| component becomes more significant than the |Ex| component at
φc = 60◦ and 90◦.
Figure 2: |Ex| and |Ey | mode-field profiles for the first two modes of the LC waveguide with θc = 30◦ at φc = 0◦, φc = 30◦,
φc = 60◦, and 90◦.
4. Conclusion
We have developed a new FDFD method based eigenmode solver for computing guided modes of anisotropic
optical waveguides with arbitrary permittivity tensor. All four transverse field components are included
in the formulation. The PML is utilized as the absorption boundary condition in this solver. Using the
solver, we have calculated and studied the guided modes on a LC-filled optical waveguide with arbitrary LC
molecular director orientation. The calculated effective indices were presented for different θc and φc of the
director orientation. It is seen that the arbitrary director orientation may cause the loss of transverse-axis
symmetries of the waveguide with symmetric background structure.
5. References
[1] L. Thylen and D. Yevick, “Beam propagation method in anisotropic media,” Appl. Opt. 21, 2751–2754 (1982).
[2] C. L. Xu, W. P. Huang, J. Chrostowski, and S. K. Chaudhuri, “A full-vectorial beam propagation method for anisotropic
waveguides,” J. Lightwave Technol. 12, 1926–1931 (1994).
[3] C. L. D. S. Sobrinho and A. J. Giarola, “Analysis of biaxially anisotropic dielectric waveguides with Gaussian-Gaussian
index of refraction profiles by the finite-difference method,” IEE Proc.-H 140, 224–230 (1993).
[4] P. Lu¨sse, K. Ramm, and H.-G. Unger, “Vectorial eigenmode calculation for anisotropic planar optical waveguides,” Electron.
Lett. 32, 38–39 (1996).
[5] A. B. Fallahkhair, K. S. Li, and T. E. Murphy, “Vector finite difference modesolver for anisotropic dielectric waveguides,”
J. Lightwave Technol. 26, 1423–1431 (2008).
[6] F. L. Teixeira and W. C. Chew, “General closed-form PML constitutive tensors to match arbitrary bianisotropic and
dispersive linear media, ” IEEE Microwave Guid. Wave Lett. 8, 223V-225 (1998).
  
 
 
 2
“Integrated Optics”場次第三篇，由筆者報告，內容為有關以我們所發展的可分析含有任
意各向異性材質光波導的有限差分模態解法研究填充液晶的V槽形矽波導模態特性。 
研討會於9月3日閉幕，筆者於9月4日搭機返國。 
 
（二）與會心得與建議 
 
筆者參與和自己研究課題相近的 Photonic Crystal, Plasmonics, Nanophtonics, 
Integrated Optics, Waveguides等領域場次，聆聽了不少邀請論文報告，瞭解更多新近的研
究題目與方向，有不錯的收穫。 
在此大型研討會，見到許多各國老友，也新認識一些大陸學者，瞭解大陸新近學術
情況。 
 
（三）攜回資料名稱及內容 
 
1.  Final Program, the 8th Pacific Rim Conference on Lasers and Electro-Optics 
(CLEO/Pacific Rim 2009), 共118頁。 
2.  Proceedings of the 8th Pacific Rim Conference on Lasers and Electro-Optics 
(CLEO/Pacific Rim 2009), CD-ROM一片。 
 
  
  
  
  
  
  
  
  
 Fig. 4. |Ex| mode-field profiles for the first three modes for θ = 60° 
and φ = 90° on the LC waveguide of Fig. 2. Fig. 2. The computing domain for the waveguide of Fig. 1. 
  
 The computing domain shown in Fig. 2 is 20 μm × 20 μm 
in size and the structure and material parameters considered 
are w = 10 μm, h = 1.5 μm, d = 2 μm, the refractive index of 
silicon nSi = 3.45, the refractive index of glass ng = 1.56, and 
the refractive index of silicon dioxide nSiO2 = 1.45. The 
permittivity tensor elements for the LC are given as: 
 
 
 
 
 
 ( )
( )
( )
( )
( )
( )
2 2 2 2 2
0
2 2 2
0 0
2 2
0 0
2 2 2 2 2
0
2 2
0 0
2 2 2
0
/ cos ( )sin ( )
/ / sin ( )sin( ) cos( )
/ / sin( ) cos( ) cos( )
/ sin ( )sin ( )
/ / sin( ) cos( )sin( )
/
xx o e o
xy yx e o
xz zx e o
yy o e o
yz zy e o
zz o e o
n n n
n n
n n
n n n
n n
n n n
ε ε ϕ θ
ε ε ε ε θ ϕ ϕ
ε ε ε ε θ θ ϕ
ε ε ϕ θ
ε ε ε ε θ θ ϕ
ε ε
= + −
= = −
= = −
= + −
= = −
= + − 2cos ( )θ
    
(5)
(6) 
(7)
(8) 
(9)
(10) 
 
Fig. 5. |Ex| mode-field profiles for the first three modes for θ = 60° 
and φ = 30° on the LC waveguide of Fig. 2. 
 
axis, the mode-field profiles are seen to possess similar 
symmetry. However, for φ = 30°, the LC orientation is no 
longer symmetric with respect to the y-axis and thus the field 
patterns shown in Fig. 5 lose such symmetry either. 
4. CONCLUSION 
where no=1.5, ne=1.69, θ is the tilt-angle between the crystal 
c-axis and the z-axis, and φ is the twist-angle between the 
projection of the crystal c-axis on the x-y plane and the x axis, 
as denoted in Fig. 1. The LC molecules can be tilted and 
twisted depending on applied voltage. The calculated 
effective refractive indices of the first three guided modes 
versus θ on the LC waveguide are shown in Fig. 3(a) and (b) 
for φ = 90° and 30°, respectively. 
We have used the FDFD method based eigenmode solver 
we recently developed for anisotropic optical waveguides 
with an arbitrary permittivity tensor [6] to calculate guided 
modes on an E7-nematic-LC optical waveguide in SiO2-Si 
V-groove [4–5]. It is shown that the mode-field profiles 
would become asymmetric when the LC molecules are 
twisted to orientate along a general direction. 
 
REFERENCES  
[1] L. Sirleto, G. Coppola, G. Breglio, G. Abbate, G. C. Righini. and J. M. 
Oton, “Electrooptical switch and continuously tunable filter based on a 
Bragg grating in a planar waveguide with a liquid crystal overlayer,” 
Opt. Eng., vol. 41, pp. 2890–2898, 2002. 
 
 
 
 [2] J. R. Winnery, C. Hu, and Y. S. Kwon, “Liquid-crystal waveguide for 
integrated optics,” IEEE J. Quantum Electron., vol. QE-13, pp. 
262–267, 1977. 
 
 
[3] D. Yin, D. W. Deamer, H. Schmidt, J. P. Barber and A. R. Hawkins, 
“Integrated optical waveguides with liquid cores,” Appl. Phys. Lett., vol. 
85, pp. 3477–34479, 2004.  
 
              (a)                         (b) 
Fig. 3. The effective refractive indices of the first three guided 
modes versus θ for (a) φ = 90° and (b) φ = 30° on the LC waveguide 
of Fig. 2. 
[4] A. d’Alessandro, B. Bellini, D. Donisi, R. Beccherelli, and R. Asquini, 
“Nematic liquid crystal optical channel waveguides on silicon,” IEEE J. 
Qunatum Electron, vol. 42, pp. 1084–1090, 2006. 
 [5] B. Bellini and R. Beccherelli, “Modeling, design and analysis of liquid 
crystal waveguides in preferentially etched silicon grooves,” J. Phys. D: 
Appl. Phys., vol. 42, 045111, 2009. 
The guided modes can be cut-off as the θ is smaller than 
about 30° and Fig. 3 shows that the effective refractive index 
gradually increases as the tilt-angle is raised. The calculated 
|Ex| mode-field profiles for the first three modes are exhibited 
in Fig. 4 for θ = 60° and φ = 90° and in Fig. 5 for θ = 60° and 
φ = 30°. The major electric field is found to be Ex. The results 
of Fig. 4 are consistent with those given in [4–5]. For φ = 90°, 
since the LC orientation is symmetric with respect to the y- 
[6] M. Y. Chen, S. M. Hsu, and H. C. Chang, “a finite-difference 
frequancy-domain method for full-vectorial mode solutions of 
anisotropic optical waveguides with an arbitrary permittivity tensor,” 
Opt. Express, vol. 17, pp. 5956–5979, 2009. 
[7] F. L. Teixeira and W. C. Chew, “General closed-form PML constitutive 
tensors to match arbitrary bianisotropic and dispersive linear media,” 
IEEE Microwave Guid. Wave Lett., vol. 8, pp. 223–225, 1998. 
 
  
 
 
Meeting同時同會議地點舉行，會期為7月25日至28日，兩個會有共同的Plenary Sessions
與Poster Session。 
兩個研討會於26日上午8:30共同開幕，筆者準時赴會。8:45至10:25的Joint Plenary 
Session I由美國HP公司的Dr. Terry Morris演講“Future Computing Systems”以及史丹福大
學的Prof. Mark Brongersma演講“Recent Advances in Plasmonic Device Technologies”。
11:00起分場次研討，最多有四個平行場次。本次IPR共發表136篇論文，包括Plenary talks
外之25篇邀請論文，81篇口頭報告論文與25篇壁報論文，與5篇Postdeadline論文。 
Subcommittee 3論文場次是由筆者安排的，分為“Modeling and Simulation I, II, III, IV, 
V”，筆者親自主持了27日下午2:00至4:00的“Modeling and Simulation II: Nanophotonics 
and Plasmonics＂場次。筆者和江舜凡同學、林邦彥博士與鄧君豪博士合著的“A Novel 
Pseudospectral Frequency-Domain Electromagnetic Formulation for Optical Waveguide 
Modes”論文，安排在28日Postdeadline場次之前的最後一場次的最後一篇論文(下午
6:15-6:30)，由筆者報告，發表我們以譜方法建立的極精準光波導模態解析法，可以提
供具90度尖角介質波導的高精準度等效折射率計算結果，隨後和曾以有限差分法研究此
問題的光波導領域的前輩Dr. Hadley有些進一步討論。另一篇論文，和筆者過去學生，
目前在國立高雄應用科大學任教的江柏叡老師合著的“Accurate Analysis of Plasmonic 
Structures Using the Multidomain Pseudospectral Frequency-Domain (PSFD) Method”論文
則由江老師發表。 
筆者主要參與五個Modeling and Simulation場次，另外也聽了 “Special Symposium on 
Optomechanics”場次以及27日8:45至10:25由PS邀請的Joint Plenary Session II，由美國Intel
公司的CTO, Dr. Justin Rattner, 演講“The Future of Silicon Photonics”以及日本名古屋大
學的Prof. Ken-ichi Sato演講“The Path to Energy Efficient Optical Networking”。前者並現場
首次公開展示其 Integrated 50Gbps Receiver Chip。28日中午12:30至2:00出席 IPR的
committee meeting，主要討論明年6月12至16日訂於加拿大多倫多和其他六個Topical 
Meetings聯合組成Advanced Photonics Congress的議題。 
27日晚上的晚宴，在臨近鄉下的一個酒莊舉行。筆者於29日由舊金山搭機返國。 
 
（二）與會心得與建議 
 
本次研討會有超過200位註冊與會者，來自臺灣有4位以上。IPR的研討內容和筆者個
人的研究興趣以及目前的研究題目相符，總是收穫很多。和PS一起開會，瞭解一些
photonics in switching的專注課題。由不少著名學者的邀請論文可獲得許多新近研究趨勢
 2
Improved Analysis of Rectangular Dielectric Waveguides
Based on a Legendre Pseudospectral Penalty Scheme
Shun-Fan Chiang,1 Bang-Yan Lin,1 Chun-Hao Teng,2 and Hung-chun Chang1
1Department of Electrical Engineering, Graduate Institute of Photonics and
Optoelectronics, and Graduate Institute of Communication Engineering,
National Taiwan University, Taipei, Taiwan 10617, R.O.C.
2Department of Applied Mathematics and Center of Mathematical Modeling and
Scientific Computing,
National Chiao Tung University, Hsinchu, Taiwan 30010, R.O.C.
E-mail: hcchang@cc.ee.ntu.edu.tw
Abstract: A Legendre pseudospectral method with penalty scheme is established in frequency
domain for high-accuracy waveguide mode analysis. For a square dielectric waveguide, the cal-
culated modal index is seen to converge to the order of 10−11.
c© 2010 Optical Society of America
OCIS codes: (130.2790) Guided waves; (230.7370) Waveguides; (260.2110) Electromagnetic optics
1. Introduction
As an academic problem, the accurate calculation of the effective index (neff), or modal index, of the square
channel dielectric waveguide, as shown in Fig. 1(a), has been devoted efforts over the past years by improving
different waveguide mode solver formulations. Figure 1(a) presents the computational domain for analyzing
the fundamental transverse-electric (TE) like mode with suitable perfect electric or magnetic conductor
(PEC or PMC) boundaries and involving a quarter of the cross-section of the square waveguide having 1-µm
side width making use of its structure symmetry. The neff of this mode with relative error below 10−7 was
calculated by Hadley [1] using a full-vectorial finite-difference (FD) method and dealing with the points
near the dielectric corners by a series expansion involving Bessel functions. Lu and Yevick [2] employed a
boundary element method with a novel series approximation for fields at dielectric corners and demonstrated
some better accuracy for the same problem. More recently, Thomas et al. [3] presented a new higher order
FD scheme for rectangular dielectric waveguides by incorporating new difference equations for mesh points
near dielectric interfaces and corners and achieved third-order convergence better than [1]. In [3], with a
mesh size of 0.005 µm, relative errors in neff close to 10−8 were shown.
Recently, the authors’ team has reported the formulation of a multidomain pseudospectral mode solver for
achieving high-accuracy calculations of full-vector modes of optical waveguides [4]. One feature of the method
lies in that field continuity conditions can be conveniently fulfilled across the general curved interface between
subdomains. Moreover, a Legendre pseudospectral time-domain method with penalty scheme was developed
for solving time-domain Maxwell’s equations with high accuracy [5]. In this paper, we apply the Legendre
pseudospectral penalty scheme and formulate a novel waveguide mode solver. The solver performance is
found to be superior to that of [4]. Without separate treatment of the sharp corners, accuracy of 10−8 in
neff can be easily obtained with mesh size on the order of 0.1 µm for the above-mentioned square waveguide,
and converged result down to 10−11 is achieved.
PEC
PE
C
PMC
PMC
εr
εr
= 2.25
=1
εr =1
εr =1
1 µm
0.
5
µm
X
Y
X
Y
-0.5 -0.4 -0.3 -0.2 -0.1 0 0.1 0.2 0.3 0.4 0.5
-0.5
-0.4
-0.3
-0.2
-0.1
0
0.1
0.2
0.3
0.4
0.5
Mesh size (µm)
N
R
e
la
tiv
e
e
rr
o
r
0.05 0.1 0.15 0.2 0.25
2712172227323742
10-11
10-10
10-9
10-8
10-7
10-6
10-5
10-4
10-3
0.02
(a) (b) (c)
Fig. 1. (a) Sketch of a quarter of the cross-section of the square channel waveguide. (b) Mesh division for
the structure of (a) for N = 12. (c) Relative error in neff for the fundamental TE like mode of the channel
waveguide of (a), as compared to that calculated with N = 44, versus N and the corresponding mesh size.
where q (ξ, t) = q(Ψ−1(ξ), t), A z = Az , A t = At, A ξ = Ax ∂ξ∂x +Ay
∂ξ
∂y , and A η = Ax
∂η
∂x +Ay
∂η
∂y .
The numerical scheme for solving Eq. (3) is as follows. Let qij denote the numerical state vector at the
grid points (ξi, ηj) satisfying the collocation schemes
Az
∂qij
∂z
=− ik0Atqij +Aξ
∂qij
∂ξ
+Aη
∂qij
∂η
− τ
2
4∑
ν=1
P
(ν)
ij (4)
where P(1)ij = (δi0/ω
ξ
i )[SB]
−ξˆ
ij (Rij(−ξˆ)−RBCij ), P(2)ij = (δiNξ/ωξi )[SB]ξˆij(Rij(ξˆ)−RBCij ), P(3) = (δj0/ωηj )[SB]−ηˆij
(Rij(−ηˆ) − RBCij ), and P(4)ij = (δjNη/ωηj )[SB]ηˆij(Rij(ηˆ) − RBCij ), with [SB]−ξˆij = Sij(−ξˆ)Bij(−ξˆ) and likewise
for the other similar notations. Note that the new Sans Serif matrix and vector symbols also come from
coordinate transformation. It is shown in Eq. (4) that the boundary conditions are enforced into the scheme
weakly through the characteristic variables. By conducting a discrete energy-like estimate, it can be shown
that if we take τ = 1 and Bij(n) = Λ(n), the scheme has a discrete energy estimate mimicking the continuous
one. The described penalty scheme bears similar idea as proposed in [5].
To seek eigenmode solutions of the waveguide propagating along the z direction, the solution is written
to be of the form q(ξ, η, z) = qˆ(ξ, η)eiβz , where β is the modal propagation constant, with β/k0 being the
effective index or modal index. Substitution of this expression into Eq. (4), employing the explicit field-
component expression of RBCij through Eq. (2), and packing all subdomain matrices [4], the wave fields over
the transverse plane of a waveguide can be formulated as an eigenvalue problem of the form A¯Q = iβB¯Q
where β is the eigenvalue, Q is the eigenvector composed of the collocated state vectors, and A¯ as well as
B¯ are matrices. By solving the eigen system, we obtain β and the corresponding mode field components. A
complete presentation of the formulation and scheme of this section can be found in [6].
3. Numerical results
The analysis results for the fundamental TE like mode of the square channel waveguide of Fig. 1(a) are
presented in Fig. 1(c). The channel is with  = 2.25 surrounded by air. The operating wavelength is taken to
be 1.5 µm as in [1–3]. The mesh division illustrated in Fig. 1(b) as an example is for Legendre polynomials of
degree N = 12. The calculations were done for N from 2 to 44. Using the obtained neff = 1.27627403771648
for N = 44 as the reference, the relative error versus N is shown in Fig. 1(c). Note that the related value
reported in [1] is 1.27627404±10−8. The corresponding mesh size, i.e., the smallest mesh size in a subdomain,
is also indicated in Fig. 1(c). It is seen that the accuracy quickly gets to 10−8 and it is as small as 10−11
when N = 42 with the mesh size on the order of 0.01 µm. A useful calculation result is given as follows. In
the analysis of the fundamental vector mode for a step-index air-cladded circular fiber with r = 8 and core
radius of 0.6 µm at 1.5-µm wavelength, the obtained neff is 2.6840193216091506 using N = 15. The exact
solution is found to be 2.684019321609156 and the difference is less than 10−14!
4. Conclusion
A Legendre pseudospectral method with penalty scheme has been successfully established for high-accuracy
waveguide mode analysis. In the analysis of a square dielectric waveguide, it is shown that the effective-index
accuracy of 10−8 is easily obtained with low polynomial degrees and the convergence to the order of 10−11
has been achieved.
Acknowledgments: This work was supported by the National Science Council of the Republic of China
under grant NSC97-2221-E-002-043-MY2.
References
1. G. R. Hadley, “High-accuracy finite-difference equations for dielectric waveguide analysis II: Dielectric corners,” J. Light-
wave Technol. 20, 1219–1231 (2002).
2. T. Lu and D. Yevick, “Comparative evaluation of a novel series approximation for electromagnetic fields at dielectric
corners with boundary element method applications,” J. Lightwave Technol. 22, 1426–1432 (2004).
3. N. Thomas, P. Sewell, and T. M. Benson, “A new full-vectorial higher order finite-difference scheme for the modal analysis
of rectangular dielectric waveguides,” J. Lightwave Technol. 25, 2563–2570 (2002).
4. P. J. Chiang, C. L. Wu, C. H. Teng, C. S. Yang, and H. C. Chang, “Full-vectorial optical waveguide mode solvers using
multidomain pseudospectral frequency-domain (PSFD) formulations,” IEEE J. Quantum Electron. 44, 56–66 (2008).
5. C. H. Teng, B. Y. Lin, H. C. Chang, H. C. Hsu, C. N. Lin, and K. A. Feng, “A Legendre pseudospectral penalty scheme
for solving time-domain Maxwell’s equations,” J. Sci. Comput. 36, 351–390 (2008).
6. S. F. Chiang, B. Y. Lin, H. C. Chang, and C. H. Teng, “A novel pseudospectral frequency-domain electromagnetic
formulation for optical waveguide modes,” in preparation (2010).
97 年度專題研究計畫研究成果彙整表 
計畫主持人：張宏鈞 計畫編號：97-2221-E-002-043-MY2 
計畫名稱：發展有限差分數值模型以研究奈米光電與電漿子元件(I)(II) 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 1 1 100%  
研討會論文 8 8 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 7 7 100%  
博士生 4 4 100%  
博士後研究員 1 1 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 5 4 100%  
研究報告/技術報告 0 0 100%  
研討會論文 15 10 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
 
