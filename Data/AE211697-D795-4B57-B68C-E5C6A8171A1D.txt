行政院國家科學委員會補助專題研究計畫 ■ 成 果 報 告   □期中進度報告 
 
新型三相交流對直流升/降壓電源轉換器之分析與研製 
 
計畫類別：■ 個別型計畫  □ 整合型計畫 
計畫編號：NSC 95－2221－E－006－453－MY3 
執行期間： 95 年 8 月 1 日至 98 年 7 月 31 日 
 
計畫主持人：   梁從主 教授 
共同主持人： 
計畫參與人員： 楊隆生、曾偉菁、洪士恆、湯博文、陳文鐘、李茂順、
洪啟明、徐良杰、李弘俊、陳柏佐、洪于婷、陳雅君、陳昱勝 
 
成果報告類型(依經費核定清單規定繳交)：□精簡報告  ■完整報告 
 
本成果報告包括以下應繳交之附件： 
□赴國外出差或研習心得報告一份 
□赴大陸地區出差或研習心得報告一份 
■出席國際學術會議心得報告及發表之論文各一份 
□國際合作研究計畫國外研究報告書一份 
 
 
處理方式：除產學合作研究計畫、提升產業技術及人才培育研究計畫、
列管計畫及下列情形者外，得立即公開查詢 
          □涉及專利或其他智慧財產權，□一年□二年後可公開查詢 
          
執行單位：國立成功大學電機工程學系 
 
中    華    民    國   9 8  年  1 0  月  1 2  日
 
Abstract 
The purpose of this project is to investigate a novel three-phase power factor correction 
(PFC) AC-DC buck-boost converter and the single-stage three-phase PFC buck-boost converter 
cascading a DC-DC converter.  The first year of this project is to study a novel three-phase 
AC-DC buck-boost converter.  There are only four active switches, driven by only one control 
signal, used in the proposed converter.  The proposed converter is operated in discontinuous 
conduction mode (DCM) by using the pulse-width modulation (PWM) technique and the control 
scheme is very easy and simple to achieve step-up/down output voltage.  The input phase 
current is controlled with sinusoidal waveform and is in phase with the input phase voltage to 
achieve almost unity power factor and low total harmonic distortion of input current (THDi).  
Also, the proposed converter provides constant average current to output capacitor and load in 
each switching period.  Thus, the sixth harmonic component will not appear in the DC output 
voltage.  Therefore, only smaller output capacitor is needed for the proposed converter.  
Moreover, the steady-state analysis, voltage gain and boundary operating condition are presented.  
Finally, a hardware circuit with simple control logic is implemented to illustrate the theoretical 
analysis.  The second year of this project is to research a single-stage three-phase AC-DC 
step-down converter.  The front semi-stage, which is the three-phase AC-DC buck-boost 
converter, is operated at discontinuous conduction mode (DCM) to achieve pure sinusoidal input 
current, low total harmonic distortion of input current (THDi), and unity power factor.  The rear 
semi-stage, which is a DC-DC buck converter, is operated at continuous conduction mode (CCM) 
at heavy load and is operated at DCM at light load to achieve step-down voltage conversion.  
Also, the proposed converter has low voltage stress across the DC-link capacitor.  Furthermore, 
the steady-state analysis of voltage gain and boundary condition are discussed.  Finally, the 
hardware circuit is implemented to verify the theoretical analysis.  The third year of this project 
is to study a single-stage three-phase AC-DC converter.  The front semi-stage of the proposed 
converter, which is operated in discontinuous conduction mode (DCM), is utilized for power 
factor correction and the rear semi-stage of the proposed converter, which is operated in 
continuous conduction mode (CCM) at heavy loads and in DCM at light loads, is employed for 
step-down voltage conversion.  The proposed converter can achieve almost unity power factor, 
low total harmonic distortion of input current (THDi), and adjustable DC output voltage.  
Moreover, the steady-state analyses of voltage gain and the boundary operating condition are 
discussed.  Finally, a prototype circuit is implemented to verify theoretical analysis. 
Keywords: Step-down/up converter, buck converter, SEPIC power converter, PWM, CCM, 
DCM, THDi. 
 II 
 
1. First year: Novel three-phase AC-DC buck-boost converter 
1.1 Preface 
A novel three-phase AC-DC buck-boost converter is studied.  The following statements 
include research purpose, literatures survey, research method, research results and discussion. 
1.2 Research purpose and literatures survey 
In industrial applications, AC-DC power conversion has many uses, including DC power 
supplies, battery chargers, uninterruptible power supplies and inverters.  Traditionally, the 
diode bridge rectifier or thyristor rectifier are used [1.1].  However, these rectifiers suffer some 
problems, such as pulsating input current, high total harmonic distortion of the input current 
(THDi), high electromagnetic interference (EMI) and low power factor.  In recent years, the 
power semiconductor technology, applied for GTOs, MOSFETs and IGBTs, has matured rapidly.  
These power semiconductor devices can be operated in higher switching frequency: the ability 
allows the AC-DC power converter to adopt a pulse-width modulation (PWM) technique to 
overcome the above drawbacks and to provide adjustable output voltage. 
Many three-phase AC-DC power converters have been presented [1.2]-[1.16].  These 
converters can achieve almost unity power factor, purely sinusoidal input current and adjustable 
output voltage.  Some of the topologies are suitable only for step-up voltage conversion 
[1.2]-[1.6].  When step-down voltage conversion is required, an additional power stage must be 
added, which will result in an increase in circuit components and cost.  Some papers have also 
discussed step-down voltage conversion, but these converters are not suitable for step-up voltage 
conversion [1.7]-[1.11].  Other converters have been presented for step-up/down voltage 
conversion [1.12]-[1.16].  However, the control strategies of the three-phase AC-DC 
buck-boost converters are rather complicated [1.12]-[1.13].  Also, these converters are operated 
in continuous conduction mode (CCM) and include a larger inductor, which results in low power 
density.  The three-phase AC-DC SEPIC and CUK converters are presented [1.14]-[1.15].  
However, more inductor and capacitor are used.  Pan proposes a different three-phase AC-DC 
buck-boost converter with discontinuous conduction mode (DCM) operation [1.16].  But these 
converters suffer the problem of the sixth times line frequency ripple component of the output 
voltage [1.14]-[1.16].  Moreover, in the AC-DC-AC power conversion applications 
[1.17]-[1.18], the ripple component of sixth times line frequency appears in the DC-link voltage.  
Thus, a bulk capacitor must be used to eliminate this ripple component. 
A novel three-phase AC-DC converter is studied.  Fewer passive devices are used, and a 
simple control scheme is applied to achieve almost unity power factor, purely sinusoidal input 
current, low THDi and step-up/down voltage conversion.  When the four switches are triggered, 
the three inductors are connected as a Y-connection, and the energies stored in the three 
inductors are increased.  While the four switches are turned off, the energies stored in the three 
inductors are discharged by parallel.  Thus, it is faster that the energies release to the output 
 1 
 
(2) Steady-state analysis: 
Owing to the symmetrical characteristics of the three-phase system, the following analysis is 
presented for .  For simplicity, the effectiveness of the input filter is ignored and it 
is assumed that the three input phase voltages are given as follows: 
o0 t  o30
ο
ο ο
( ) ( ) sin 2 sin
( ) ( ) sin( 120 ) 2 sin( 120 )
( ) ( ) sin( 240 ) 2 sin( 240 )
a a m rms
b b m rms
c c m rms
e t v t V t V t
e t v t V t V t
e t v t V t V t
 

 
             
ο                      (1.1) 
where Vm and Vrms are the amplitude and the RMS value of the input phase voltage. 
Because the switching frequency fs (fs = 1/Ts) is much larger than the line frequency f1, the 
three input phase voltages can be considered as a piecewise constant during each switching 
period.  Assuming n is the switching number within the time interval [0o, 30o], then n is equal to 
fs/12f1.  The following analysis is considered during the switching period [kTs, (k+1)Ts], where k 
= 0, 1,..., n-1.  While the four switches, Sa/Sb/Sc/Sd, are triggered, the following equations are 
given by 
1
( )( )
( )( ) ,           
( )( )
a ka
b kb
s k
c kc
e tdi t
dt L
e tdi t kT t t
dt L
e tdi t
dt L
   
                                        (1.2) 
From (1.2), the three inductor currents are derived 
1
( )
( ) ( )
( )
( ) ( ) ,           
( )
( ) ( )
a k
a s
b k
b s s
c k
c s
e t
i t t kT
L
e t
i t t kT kT t t
L
e t
i t t kT
L
       
k                                  (1.3) 
When t is equal to tk1, the peak value of the three inductor currents can be determined as follows: 
 3 
 
,,
,
( )
( )
( )
a k
ar k s
o
b k
br k s
o
c k
cr k s
o
e t
t D
V
e t
t
V
e t
t D
V
   
T
DT
T
  .                                                 (1.8) 
A.  Voltage Gain 
Fig. 1.1 shows that current iD7 through output diode D7 is zero when the four switches, 
Sa/Sb/Sc/Sd, are triggered, and iD7 is equal to the summation of ia, ib and ic while the four switches 
are OFF.  Therefore, the average current of iD7 during one switching period [kTs, (k+1)Ts] can be 
obtained as follows: 
, , , , , ,
7, 2
ap k ar k bp k br k cp k cr k
D k
s
i t i t i t
I
T
                                           (1.9) 
Substituting (1.1), (1.4) and (1.8) into (1.9) yields 
2 2 2 2
2 2 ο 2 ο
7,
3[sin sin ( 120 ) sin ( 240 )]
2 4
s m m
D k
o s o
D T V D VI t t t
LV Lf V
                    (1.10) 
The above equation depicts that the average current of iD7 is constant during each switching 
period, which means that the proposed converter provides a constant average current to the 
output capacitor and load in each switching period.  In other words, the output voltage ripple is 
only affected by the switching period.  Thus, the ripple component of sixth times line frequency 
will not appear in the output voltage, and so a smaller output capacitor can be used. 
Since the average current of ico through output capacitor C is zero during each switching 
period at steady state, the average current of io during each switching period can be derived as 
2 2
7,
3
4
m
o D k
s o
D V VI I
Lf V R
   o                                                (1.11) 
Now, the normalized inductor time constant is defined as 
s
L
Lf
R
                                                              (1.12) 
Then, the voltage gain M is derived as 
23
4 2
o
m s L
V D R DM
V Lf
3
                                                (1.13) 
 5 
 
22 2 2
( 3 )
4
o
o s
V DR Lf M
V CLf R M
  s                                                 (1.19) 
Therefore, in order to ensure that the output voltage ripple satisfies its specification, the output 
capacitor must be selected to satisfy the following inequality: 
2
2 2 2
( 3 )
4
s o
s o
DR Lf M VC
Lf R M V
                                                 (1.20) 
C.  Selection of Input Filter Lf-Cf 
Since the harmonic components of input current are distributed around the multiples of the 
switching frequency, three sets of input filters can be used to easily filter out the harmonic 
components.  The cutoff frequency of the input filter is much lower than the switching 
frequency.  The cutoff frequency of the input filter is determined to be 
1
2c f f
f
L C                                                       (1.21) 
1.4 Research results 
To verify the performance of the proposed converter, a prototype circuit has been built in 
the laboratory.  The system block diagram of the proposed converter is shown in Fig. 1.8.  
There is only one PWM controller, which is used to control the four switches, Sa/Sb/Sc/Sd, 
simultaneously.  The step-up and step-down voltage conversion can be realized by using a very 
simple control scheme.  The circuit parameters are chosen as Vrms = 120 V (Vm = 170 V), f1 = 
60 Hz, fs = 36 kHz, L = 115 μH, C = 660μF, Lf = 1 mH, Cf = 1μF. 
A.  Step-up Voltage Conversion 
The output voltage and output power are designed at Vo = 250 V and Po = 800 W.  Fig. 1.9 
shows some waveforms for step-up voltage operation.  Input phase current isa is almost in 
phase with input phase voltage ea as shown in Fig. 1.9(a).  From Fig. 1.9(b), it is seen that the 
three input phase currents are purely sinusoidal.  The waveforms of three inductor currents are 
shown in Fig. 1.9(c), which illustrates that the proposed converter is operated in DCM.  The 
DC output voltage and its ripple are shown in Fig. 1.9(d).  One can see that the output voltage 
is controlled at 250 V, and its ripple component is rather small.  In addition, the measured 
power factor, THDi and efficiency are shown in Fig. 1.10.  It is apparent that the measured 
power factor is almost unity, the measured THDi is less than 4%, and the measured efficiency is 
84.5% at heavy load.  
 7 
 
[1.6] Y. Jang and M. M. Jovanovic, “A novel robust harmonic injection method for 
single-switch three-phase discontinuous-conduction-mode boost rectifiers,” IEEE Trans. 
on Power Electronics, vol. 13, no. 5, pp. 824-834, Sep. 1998. 
[1.7] S. B. Han, N. S. Choi, C. T. Rim and G. H. Cho, “Modeling and analysis of static and 
dynamic characteristics for buck-type three-phase PWM rectifier by circuit DQ 
transformation,” IEEE Trans. on Power Electronics, vol. 13, no. 2, pp. 323-336, March 
1998. 
[1.8] R. Itoh, “Steady-state and transient characteristics of a single-way step-down PWM GTO 
voltage-source convertor with sinusoidal supply currents,” IEE Proc. B, vol. 136, no. 4, 
pp. 168-174, July 1989. 
[1.9] T. C. Green, M. H. Taha, N. A. Rahim and B. W. Williams, “Three-phase step-down 
reversible AC-DC power converter,” IEEE. Trans. on Power Electronics, vol. 12, no.2, 
pp. 319-324, March 1997. 
[1.10] S. Y. R. Hui and H. Chung, “Paralleling power factor converters for AC-DC step-down 
power conversion with inherent power factor correction,” IEE Proc. Electric Power 
Applications, vol. 146, no. 2, pp. 247-252, March 1999. 
[1.11] L. S. Yang, T. J. Liang and J. F. Chen, “Three-phase AC/DC buck converter with 
bidirectional capability,” IEEE PESC, 2006. 
[1.12] R. Itoh and K. Ishizaka, “Three-phase flyback AC-DC convertor with sinusoidal supply 
currents,” IEE Proc. B, vol. 138, no. 3, pp. 143-151, May 1991. 
[1.13] V. F. Pires and J. F. Silva, “Three-phase single-stage four-switch PFC buck-boost-type 
rectifier,” IEEE Trans. on Industrial Electronics, vol. 52, no. 2, pp. 444-453, April 2005. 
[1.14] H. Oishi, H. Okada, K. Ishizaka and R. Itoh, “SEPIC-derived three-phase sinusoidal 
rectifier operating in discontinuous current conduction mode,” IEE Proc. Electric Power 
Applications, vol. 142, no. 4, pp. 239-245, July 1995. 
[1.15] J. A. Pomilio and G. Spiazzi, “High-precision current source using low-loss, single 
switch, three-phase AC/DC converter,” IEEE Trans. on Power Electronics, vol. 11, no. 4, 
pp. 561-566, July 1996. 
[1.16] C. T. Pan and T. C. Chen, “Step-up/down three-phase AC to DC converter with 
sinusoidal input current and unity power factor,” IEE Proc. Electric Power Applications, 
vol. 141, no.2, pp. 77-84, Mar. 1994. 
[1.17] B. R. Lin, “High power factor AC/DC/AC converter with random PWM,” IEEE Trans. 
on Aerospace and Electronic Systems, vol. 35, no. 3, pp. 935-944, July 1999. 
[1.18] B. T. Ooi, J. W. Dixon, A. B. Kulkarni and M. Nishimoto, “An integrated AC drive 
system using a controlled-current PWM rectifier/inverter link,” IEEE Trans. on Power 
Electronics, vol. 3, no. 1, pp. 64-71, Jan. 1988. 
1.7  Appendix 
Equation (1.10) shows that the average current of iD7 is a constant during each switching 
 9 
 
  
 
ea
eb
ec
isa
isb
isc
va
vb
vc
Lf
Lf
Lf
Cf Cf Cf
ia'
ib'
ic'
ia ib ic
Sa Sb Sc
Sd
D1 D2 D3
D7
D4 D5 D6
Da1
Da2
Db1
Db2
Dc1
Dc2
R
+
-C Vo
iD7
ico ioL L L
 
Fig. 1.1  Circuit configuration of the proposed converter. 
 
 
 
ea eb ec
0
30o 60o 90o 120o 150o 180o 210o 240o 270o 300o 330o 360o
 
Fig. 1.2  Three input phase voltages. 
 11 
 
va
vb
vc
Sa Sc
Sd
D1 D3
D5
Da1
Db2
Dc1 R
+
-C Vo
L L L
 
Fig. 1.4  Equivalent circuit when Sa/Sb/Sc/Sd are triggered during time interval [0o, 30o]. 
 
ia ib ic
D1 D2 D3 D7
D4 D5 D6
R
+
-C VoL L L
  
(a) 
        
ib ic
D2 D3 D7
D5 D6
R
+
-C VoL L
 
(b)  
Fig. 1.5  Equivalent circuit when Sa/Sb/Sc/Sd are OFF during time interval [0o, 30o]. 
 13 
 
 CCM
DCM
0
0.2
0.20 0.4
0.4
0.6
0.6
0.8
0.8 D
LB
 
Fig. 1.7  Boundary condition of the proposed converter. 
 
 
+
-
ea
eb
ec
R
R1
R2
Vo
Proposed Converter
Power Stage
Drive
Circuit
PWM
Comparator
Isolated
Amplifier
PI
Controller  +
-
+
-
Vref
Sa Sb Sc Sd
 
Fig. 1.8  System block diagram of the proposed converter. 
 
 
 15 
 
  
 
ia/ib/ic: 10 A/div, Time: 5 ms/div
ia
ib
ic
2
3
4
 
(c) 
Vo
Vo,ripple
Vo: 100 V/div, Vo,ripple: 10 V/div, Time: 2 ms/div  
(d) 
Fig. 1.9 (Continued) 
 17 
 
 ea: 60 V/div, isa: 2 A/div, Time: 5 ms/div
ea
isa
 
(a) 
isa/isb/isc: 2 A/div, Time: 5 ms/div
isa isb isc
 
(b) 
Fig. 1.11  Some waveforms for step-down voltage operation. 
(a) Input phase voltage ea and input phase current isa, 
(b) Three input phase currents, 
(c) Three inductor currents, 
(d) Output voltage and its ripple. 
 19 
 
Vrms=108 V
Vrms=120 V
Vrms=132 V
72 144 216 288 360
PF
0.9
0.92
0.94
0.96
0.98
1.0
Po (W)
 
(a) 
Vrms=108 V
Vrms=120 V
Vrms=132 V
THDi(%)
0
1
2
3
4
72 144 216 288 360
Po (W)
 
(b) 
Vrms=108 V
Vrms=120 V
Vrms=132 V
Efficiency (%)
65
70
75
80
85
Po (W)
72 144 216 288 360
60
 
(c) 
Fig. 1.12  Some measured results for step-down voltage operation. 
(a) Power factor, (b) THDi, (c) Efficiency. 
 21 
 
2. Second year: Single-stage three-phase AC-DC step-down converter 
2.1 Preface 
A single-stage three-phase AC-DC step-down converter is researched.  The research 
purpose, literatures survey, research method, research results, and discussion are included in this 
report. 
2.2 Research purpose and literatures survey 
The DC source is used in many applications, such as DC power supply, battery charger and 
intermediate DC link voltage of inverter.  Thus, the AC-DC converter is very important for DC 
source applications.  Due to the rapid progress of power semiconductor device, the pulse-width 
modulation (PWM) technique is widely used for three-phase power-factor-correction (PFC) 
AC-DC power converter to achieve purely sinusoidal input current, low THDi and unity power 
factor [2.1]-[2.17].  Some boost converters are presented for step-up voltage conversion 
[2.1]-[2.7].  However, when the step-down voltage conversion is required, these boost 
converters must cascade with a DC-DC converter.  This will result in higher cost.  Thus, some 
papers propose the single-stage three-phase AC-DC converter to increase efficiency and reduce 
cost [2.8]-[2.10].  But the DC-link voltage of these single-stage converters is too high.  For 
step-down voltage conversion applications, the buck type and buck-boost type are proposed 
[2.11]-[2.15].  Nevertheless, the control strategy is more complicated.  Also, because larger 
inductor is used, it will result in low power density.  Moreover, some literatures present the 
boost-derived converter with high frequency isolation by using the current-fed method 
[2.16]-[2.17].  Since the input current is operated in CCM, the input filter is not need.  And 
the topologies adopt the current-fed method, thus the DC-link capacitor can be eliminated.  
However, more control signals, such as input voltage, output voltage and inductor current, are 
used, it will result in higher cost. 
In this report, a single-stage three-phase AC-DC step-down converter is studied.  The 
front semi-stage is a three-phase PFC AC/DC buck-boost converter, which is operated in DCM.  
The rear semi-stage is a DC-DC buck converter, which is operated in CCM at heavy load and is 
operated in DCM at light load.  There is only one PWM controller is used to control both the 
front semi-stage and the rear semi-stage to achieve unity power factor, purely sinusoidal input 
current, low THDi and step-down voltage conversion.  Also the DC-link voltage is usually kept 
below 450 V.  In addition, the sixth times line frequency ripple component of DC-link voltage 
can be eliminated.  Thus, smaller capacitor can be used to replace the bulky capacitor. 
2.3 Research method 
(1) Operating principle: 
The circuit configuration of the proposed converter is shown in Fig. 2.1.  Four 
synchronous active switches are used in this converter, and a simple PWM control strategy is 
used to generate a fixed duty ratio for triggering the four switches.  Fig. 2.2 shows that the 
 23 
 
voltages can be considered as a piecewise constant during each switching period.  Assuming m 
is the switching number within [0o, 30o], namely n = fs/12f1.  Also, the following analysis is 
considered during the switching period [kTs, (k+1)Ts], where k = 0, 1,….., n-1.  When Sa, Sb, Sc 
and Sd are triggered, the following equations can be obtained as 
1
( )( )
( )( ) ,          
( )( )
a ka
b kb
s k
c kc
e tdi t
dt L
e tdi t kT t t
dt L
e tdi t
dt L
   
   (2.2) 
Solving (2.2), the three currents ia, ib and ic can be derived as 
1
( )
( ) ( )
( )
( ) ( ) ,          
( )
( ) ( )
a k
a s
b k
b s s
c k
c s
e t
i t t kT
L
e t
i t t kT kT t t
L
e t
i t t kT
L
       
k  (2.3) 
At t = tk1, the three peak values of ia, ib and ic are found as 
,
,
,
( ) ( )
( ) ( )
( ) ( )
a k a k
ap k on s
b k b k
bp k on s
c k c k
cp k on s
e t e t
i t
L L
e t e t
i t
L L
e t e t
i t
L L
      
DT
DT
DT
 (2.4) 
where ton = DTs and D is the switching duty ratio. 
While Sa, Sb, Sc and Sd are turned off, one can get the following equations 
1
1 2
1
1
1
1 3
( ) ,          
( ) ,          
( ) ,          
a c
k k
b c
k
c c
k k
di t V t t t
dt L
di t V t t t
dt L
di t V t t t
dt L
            
4k  (2.5) 
Solving (2.5), the following equations of ia, ib and ic can be written as 
 25 
 
B.  Voltage gain 
From Fig. 2.1, one knows that iD is equal to the summation of ia, ib and ic while Sa, Sb, Sc and 
Sd are turned off, and iD8 is equal to zero when Sa, Sb, Sc and Sd are triggered.  Also, the 
waveform of iD is shown in Fig. 2.4.  Thus, the average current of iD during the switching period 
[kTs, (k+1)Ts] can be derived as follows: 
, , , , , ,
, 2
ap k ar k bp k br k cp k cr k
D k
s
i t i t i t
I
T
   (2.10) 
Substituting (2.1), (2.4) and (2.8) into (2.10) yields 
2 2 2 2
2 2 ο 2 ο
,
1 1
3[sin sin ( 120 ) sin ( 240 )]
2 4
s m m
D k
c s c
D T V D VI t t t
LV f LV
         (2.11) 
From the above equation, one knows that the average current of iD is constant during each 
switching period.  It means that the ripple component of Vc1 is not related to the phase angle of 
input voltage, it is only affected by the switching period.  Thus, the ripple component of sixth 
times line frequency of Vc1 can be eliminated, the smaller capacitor C1 can be used to replace the 
bulky capacitor. 
The average current of ic1 during each switching period can be derived as 
2 2
1
1
3
4
Lo on m
c D
s s c
I t D V
LoI I T f LV
    DI  (2.12) 
where ILo is the average current of iLo during each switching period. 
Under steady state, Ic1 is equal to 0 and ILo is equal to Io.  Thus, (2.12) can be rewritten as 
follows 
2 2
1
3
4
m
Lo o
s c
D V DVDI DI o
f LV R
    (2.13) 
The normalized inductor time constant of the front semi-stage is defined as 
s
L
Lf
R
   (2.14) 
Since the rear semi-stage is operated in CCM, the voltage gain of the rear semi-stage can be 
known as 
2
1
o
c
VM D
V
   (2.15) 
Substituting (2.14) and (2.15) into (2.13), the voltage gain of the front semi-stage is derived as 
 27 
 
When LoI  is equal to 2Io, the rear semi-stage is operated in BCM.  Thus, the boundary 
normalized inductor time constant of the rear semi-stage can be derived as 
1
2LoB
D   (2.23) 
From (2.23), the curve of LoB  is plotted in Fig. 2.6(b).  One can see when Lo  is larger than 
LoB , the rear semi-stage is operated in CCM. 
(3) Selections of Inductor, Capacitor and Input Filter: 
A. Selection of inductors L and Lo 
To ensure the front semi-stage is operated in DCM and the rear semi-stage is operated in 
CCM at heavy load and is operated in DCM at light load.  The appropriate LB  and LoB  can 
be obtained from (2.20) and (2.23).  Then, L and Lo need to satisfy the following inequality. 
LB
s
RL
f
  (2.24) 
o
s
RL
f LoB
  (2.25) 
B.  Selection of DC-link capacitor C1 
From Fig. 2.4, the discharged energy of C1 is computed as follows 
1 1 1
o
c c Lo s o s
VQ C V I DT I DT DT
R
      s  (2.26) 
Substituting (2.15) into (2.26), the ripple percentage of Vc1 is obtained as 
2
1
1 1
c
c s
V D
V C f
 
R
 (2.27) 
C.  Selection of output capacitor Co 
From Fig. 2.4, the charged energy of Co is computed as follows  
1
2 2 2
Lo s
co o o
I TQ C V      (2.28) 
Substituting (2.21) into (2.28), the ripple percentage of Vo is derived as 
2
2
(1 ) 1
8 8
o s
o o o o o
V D T D
V C L C L
   
sf
 (2.29) 
Therefore, to ensure that the ripple percentage of Vo satisfies the specification, the Co needs to 
meet the following inequality. 
 29 
 
2 2
1
1
1
0.37 1 38 F
36k 5 2%
c
s c
VDC
f R V
     
Thus, C1 is chosen to be 68 F . 
Under the conditions Vrms = 115.5 V, Vo = 50 V, and Po = 500 W, some experimental results 
are shown in Figs. 2.7 – 2.9.  Fig. 2.7 shows that the input phase current is in phase with the 
input phase voltage.  It is seen from Fig. 2.8 that the three input phase currents are purely 
sinusoidal waveform.  Fig. 2.9 shows the waveforms of the inductor currents ia, ib and ic, one 
can see that the front semi-stage is operated in DCM at full load.  Moreover, the measured 
power factor, THDi, efficiency and Vc1 are shown in Fig. 2.10.  One can see that the measured 
power factor is almost unity, the measured THDi is less than 4.3% and the measured efficiency 
is about 80% at heavy load.  Also, the measured Vc1 is less than 280 V. 
2.5 Discussion 
A single-stage three-phase AC/DC step-down converter is presented in this report.  The 
proposed converter is combined with a three-phase AC/DC buck-boost converter and a DC-DC 
buck converter to achieve unity power factor, low THDi and adjustable DC output voltage.  
Also the ripple component of sixth times line frequency of Vc1 can be eliminated, smaller DC-link 
capacitor is required.  For steady-state analysis, voltage gain and boundary condition are 
discussed in detail.  Also, the design of inductors and capacitors are presented.  Finally, 
simulated and experimental results are supplied to verify the theoretical analysis.  The pure 
sinusoidal waveforms of three input currents, unity power factor and low THDi are achieved.  
Also the measured Vc1 is less than 450 V. 
2.6 References 
[2.1] R. Wu, S. B. Dewan, and G. R. Slemon, “A PWM ac-to-dc converter with fixed switching 
frequency,” IEEE Trans. on Industry Applications, vol. 26, no. 5, pp. 880-885, 1990, pp. 
880-885. 
[2.2] J. W. Kolar and F. C. Zach, “A novel three-phase utility interface minimizing line current 
harmonics of high-power telecommunications rectifier modules,” IEEE Trans. on 
Industrial Electronics, vol. 44, no. 4, pp. 456-467, 1997. 
[2.3] J. W. Dixon and B. T. Ooi, “Series and parallel operation of hysteresis current-controlled 
PWM rectifiers,” IEEE Trans. on Industry Applications, vol. 25, no. 4, pp. 644-651, 1989. 
[2.4] A. R. Prasad, P. D. Ziogas, and S. Manias, “An active power factor correction technique 
for three-phase diode rectifiers,” IEEE Trans. on Power Electronics, vol. 6, no. 1, pp. 
83-92, 1991. 
[2.5] Y. Jang and M. M. Jovanovic, “A novel robust harmonic injection method for 
single-switch three-phase discontinuous-conduction-mode boost rectifiers,” IEEE Trans. 
on Power Electronics, vol. 13, no. 5, pp. 824-834, 1998. 
 31 
 
 
 
 
+ -
+
-
Lf
Lf
Lf
Da1
Da2
Sa
L L L
D1
Db1
Db2 D2
Sb
Dc2
Dc1
Sc
D3
D4 D5 D6Cf Cf Cf
Sd
C1
D7
Lo
Co R
Io
ea
eb
ec
isa
isb
isc
va
vb
vc
ia ib ic
ic1
Vc1
Vo
iLo
ico
iD
 
Fig. 2.1  Circuit configuration of the proposed converter. 
 
 
Fig. 2.2  Three input phase voltages. 
ea eb ec
0
30o 60o 90o 120o 150o 180o 210o 240o 270o 300o 330o 360o
 
 
 
 
 
 33 
 
Gate
signal
Inductor
current
iLo
ico
0
0
0
0
0
Phase
voltage
kTs tk1 tk2 tk3 (k+1)Ts
ton tar,k
tcr,k
tbr,k
ts,k
Ts
ec(tk)
iap,k
eb(tk)
ea(tk)
icp,k
ibp,k
ia ic ib
ILo
ic1
-ILo
0
tk4
iap,k+ibp,k+icp,k
0
iD
2
sT
iap,k+ibp,k+icp,k
1cQ
coQ
2
LoI
 
Fig. 2.4  Some typical waveforms in one switching period for . o o0 3t  0
 
 35 
 
 (c) Mode III 
L L
D2 D3
D5 D6
D7ib ic
+ -
 +
-
C1 Lo
Co R
L
D2
D5
D7ib
+ -
 +
-
C1 Lo
Co R
 
(d) Mode IV 
D7  +
-
Lo
Co R
 
(e) Mode V 
Fig. 2.5  (Continued) 
 37 
 
ea: 60 V/div, isa: 2 A/div, Time: 5 ms/div
ea
isa
 
Fig. 2.7 Input phase voltage ea and input phase current isa. 
isa/isb/isc: 2 A/div, Time: 5 ms/div
isa isb isc
 
Fig. 2.8 Three input phase currents. 
 
ia/ib/ic: 10 A/div, Time: 5 ms/div
ia
ib
ic
2
3
4
 
Fig. 2.9 Three input inductor currents.
 39 
 
  
 
Vrms=104V
Vrms=115.5V
Vrms=127V
46.08 76.8 115.2 230.4 307.2 460.8
Efficiency (%)
60
55
65
70
75
80
85
50 Po (W)
 
(c) 
Vrms=104V
Vrms=115.5V
Vrms=127V
46.08 76.8 115.2 230.4 307.2 460.8
0
50
100
150
200
250
300
Po (W)
Vc1 (V)
 
(d) 
Fig. 2.10  (Continued) 
 
 41 
 
(i) Mode I [kTs, tk1]: The four switches are triggered.  Since ea is positive and eb/ec are negative 
in this interval, Sa and Sd are turned on.  Meanwhile, the three input 
inductors are charged from the line source, the energy stored in C1 is 
released to Lo, and the energy stored in Co is transferred to the load.  The 
equivalent circuit is shown in Fig. 3.4(a). 
(ii) Mode II [tk1, tk2]: The four switches are turned off.  The energies stored in La, Lb, and Lc are 
released to C1, Co, and the load.  The energy stored in Lo is also transferred 
to Co and the load.  The equivalent circuit is shown in Fig. 3.4(b). 
(iii) Mode III [tk2, tk3]: The four switches are turned off and ic equals 0.  The energies stored in 
La and Lb are transferred to C1, Co, and the load.  The energy stored in Lo 
is released to Co and the load.  The equivalent circuit is shown in Fig. 
3.4(c). 
(iv) Mode IV [tk3, tk4]: In this time interval, ia >0, ib =0, and ic = 0. Only the energy stored in La is 
discharged to C1, Co, and the load.  The energy stored in Lo is still 
discharged to Co and the load.  The equivalent circuit is shown in Fig. 
3.4(d). 
(v) Mode V [tk4, (k+1)Ts]: In this time interval, ia = ib = ic = 0.  No energy is stored in the three 
input inductors.  The energy stored in Lo is still released to Co and 
the load.  The equivalent circuit is shown in Fig. 3.4(e). 
(2) Steady-state analysis: 
To simplify analysis, the effect of input filter is ignored.  It is assumed that the three input 
phase voltages are as follows: 
ο
ο
( ) ( ) sin
( ) ( ) sin( 120 )
( ) ( ) sin( 240 )
a a m
b b m
c c m
e t v t V t
e t v t V t
e t v t V t



       
                                          (3.1) 
where Vm is the amplitude of input phase voltage.  Since the switching frequency fs (fs = 1/Ts) is 
much larger than line frequency f1, the three input phase voltages can be considered as constant 
during each switching period.  Assuming n is the switching number within the interval [60o, 
90o], namely n = fs/12f1, where f1 is the frequency of input voltage.  The following analysis is 
considered during the switching period [kTs, (k+1)Ts], where k = 0, 1,….., n-1.  When Sa, Sb, Sc 
and Sd are triggered, the following equations are obtained: 
 43 
 
1
, ,
1
, ,
1
, ,
c o
ap k ar k
c o
bp k br k
c o
cp k cr k
V Vi t
L
V Vi
L
V Vi t
L
     
t                                                      (3.7) 
where tar,k = tk4 – tk1, tbr,k = tk3 – tk1, and tcr,k = tk2 – tk1. 
From (3.4) and (3.7), the three time durations tar,k, tbr,k, and tcr,k are derived as 
,
1
,
1
,
1
( )
( )
( )
a k
ar k s
c o
b k
br k s
c o
c k
cr k s
c o
e t
t D
V V
e t
t
V V
e t
t D
V V
      
T
DT
T
                                                   (3.8) 
A.  Unfiltered input current  
Fig. 3.5 shows the waveforms of input phase voltage, gate signal, unfiltered input current 
and inductor current.  The average unfiltered phase-A input current in one switching period can 
be derived as 
2
'
, ( ) sin
2 2
on ap s m
avgsa
s
t i D T Vi t
T L
t                                             (3.9) 
Equation (3.9) indicates that i’sa,avg is sinusoidal and is in phase with ea.  Similarly, i’sb,avg, and 
i’sc,avg are sinusoidal and are in phase with eb and ec respectively. Moreover, the harmonic 
components of isa', isb', and isc' are distributed over multiple switching frequencies.  Thus, one 
can easily filter out harmonic components using the three sets of input filters Lf-Cf. 
B.  Voltage gain 
From Fig. 3.1, iC1 equals the sum of ia, ib and ic when Sa, Sb, Sc and Sd are turned off, and 
equals iLo when Sa, Sb, Sc and Sd are triggered.  The charged energy of C1 during the interval [tk1, 
(k+1)Ts] can be derived as 
, , , , , ,
1, 2
ap k ar k bp k br k cp k cr k
C A
i t i t i t
Q
                                          (3.10) 
Substituting (3.1), (3.4) and (3.8) into (3.10) yields 
 
2 2
1, 2
1
3
4
m
C A
s o c
D VQ
f L V V
                                                    (3.11) 
 45 
 
1 2
3V D
2
o
m L
M M M
V                                                (3.21) 
where  11
c
m
VM
V
 . 
From (3.13) and (3.21), the voltage gain of the front semi-stage can be derived as 
 1
1 2
C
m L
3 1 DV M
V                                                    (3.22) 
C.   Boundary condition of the front semi-stage 
ia must go to 0 To ensure that the front semi-stage is operated in DCM, the inductor current 
in each swit o oching period for 60 <ωt<90 .  The time duration ts,k is the sum of ton and tbr,k and can 
be obtained as  
1
, ,
1
( )c a k
s k on br k
c
V e t
st DTV
                                          (3.23) 
If the absolute value of ea(tk) equals Vm and the maximum of ts,k equals Ts, the front semi-stage is 
t t 
operated in boundary conduction mode (BCM).  Thus, the boundary voltage gain M1,bc is 
obtained as 
1
1,
c
bc
m
VM D
V
                                                         (3.24) 
From (3.22) and (3.24), when voltage gain M1 equals its boundary voltage gain M1,bc, the 
boundary normalized inductor time constant of the front semi-stage can be derived as 
23(1 )D                                                         (24LB D 3.25) 
From (3.25), the curve of LB L LB
 rear semi-stage 
Lo can be found 
 τ  can be plotted in Fig. 3.6(a).  When τ  is less than τ , the front 
semi-stage is operated in DCM. 
D.   Boundary condition of the
When the rear semi-stage is operated in CCM, the current ripple of inductor 
as 
(1 ) o s
Lo
o
D V TI
L
                                                      (3.26) 
 47 
 
By substituting (3.34), (3.18), (3.21) into (3.33), the ripple percentage of Vo is derived as 
2
22 2
  1 1 1    oV D D  (3.35) 
3.4 Research results 
A prototype circuit of the proposed converter is implemented with simple control logic in 
the laboratory.  The circuit parameters are chosen as 
V 
(ii) I
   o o s o sV C Rf L f
                                       
(i) Output voltage: Vo = 48 
nput voltage: Vrms = 115.5 V   10% (Vm = 200 V   10%) 
(iii) Output power: Po = 50 ~ 500 W (R = 4.6 – 46 Ω) 
(iv) Line frequency: f1 = 60 Hz 
 Co = 150 μF 
. 
 D6: MUR3040PT, Da1, Db1, Dc1 MUR3040PT, Da2, 
nd Sd IXFX55N50Q (IXYS). 
V, Vo = 48 V, and Po = 500 W, Fig. 3.7 shows some 
 currents are purely 
sinu
ower factor, low THDi, and adjustable DC output voltage.  The steady-state 
ana
(v) Switching frequency: fs = 36 kHz 
(vi) Inductors: L = 110 μH and Lo = 292 μH 
(vii) Capacitors: C1 = 68 μF and
(viii) Input filters Lf = 2 mH, Cf = 1 μF
Also, the power devices are selected as D1~
Db2, Dc2 MUR3040PT, Sa-Sc: IXFH27N80Q, a
Under the conditions Vrms = 104 
experimental results.  The input phase current is in phase with the input phase voltage, as 
shown in Fig. 3.7(a).  It is seen from Fig. 3.7(b) that the three input phase
soidal.  Fig. 3.7(c) shows the three inductor currents.  One can see that the front 
semi-stage is operated in DCM at full load.  Moreover, the measured power factor, THDi, 
efficiency, and Vc1 are shown in Fig. 3.8.  One can see that the measured power factor is almost 
unity at full load, the measured THDi at heavy load is less than 5% and the measured efficiency 
is about 74% at full load.  Additionally, the measured Vc1 is kept below 300V. 
3.5 Discussion 
This work presents a single-stage three-phase AC-DC converter, which combines a 
three-phase AC-DC buck-boost converter with a DC-DC converter.  The proposed converter 
achieves unity p
lyses of voltage gain and the boundary condition are discussed in detailed.  Finally, a 
prototype circuit of the proposed converter is implemented to verify the performance.  The 
proposed converter can achieve purely sinusoidal waveforms of three input currents, unity 
power factor, and low THDi.  Moreover, the measured Vc1 is less than 300 V. 
3.6 References 
[3.1] R. Wu, S. B. Dewan, and G. R. Slemon, ”A PWM ac-to-dc converter with fixed switching 
frequency,” IEEE Trans. on Industry Applications, vol. 26, No. 5, pp. 880-885, 1990. 
 49 
 
  
 
Fig. 3.1  Circuit configuration of the proposed converter. 
 
 
30     60     90    120    150   180    210    240    270   300   330   360           
ae be ce
0
t
 
Fig. 3.2  Three input phase voltages. 
 
 
 
 51 
 
  
 
 
(a) Mode I 
 
 
 
(b) Mode II 
Fig. 3.4  Equivalent circuit of operating principle for 60o < ωt < 90o. 
 53 
 
 (e) Mode V 
Fig. 3.4  (Continued) 
 
 
 
Fig. 3.5 The waveforms of input phase voltage, gate signal, unfiltered input current and inductor 
current for 0o < ωt < 360o. 
 
 55 
 
ea
isa
ea: 50 V/div, isa: 2 A/div, Time: 5ms/div 
 
 
(a) 
isa isb isc
isa/isb/isc : 2 A/div,Time: 5 ms/div  
(b) 
ia
ib
ic
ia/ib/ic : 10 A/div,Time: 5 ms/div  
(c) 
Fig. 3.7  Some experimental waveforms. (a) Input phase voltage ea and input phase current isa, 
(b) Three input phase currents, (c) Three input inductor currents. 
 
 57 
 
  
 
55
60
65
70
75
80
50 140 230 320 410 500
Vrms=104 V
Vrms=115.5 V
Vrms=127 V
 WoP
Efficiency(%)
 
(c) 
100
150
200
250
300
50 140 230 320 410 500
C1V (V)
 WoP
Vrms=104 V
Vrms=115.5 V
Vrms=127 V
 
(d) 
Fig. 3.8  (Continued) 
 59 
 
國科會補助專家學者出席國際會議心得報告 
(1) The 11th International Conference on Electrical Machines and Systems (ICEMS2008): 
姓   名 梁 從 主 單    位 電機系 職   稱 教 授 
國    別 中國湖北省 城   市 名   稱 武漢市 
出席會議
起迄時間
民國 97 年 10 月 15 日起 
至   97 年 10 月 19 日止 
出席會議 
名    稱 
 
The 11th International Conference on Electrical Machines and Systems (ICEMS2008) 
出席原因 
1. 參訪華中理工科技大學。 
2. 參訪武漢大學。 
3. 發表論文”Two-stage metal halide lamp electronic ballast with constant output 
power control” 
4. 擔任 Section Chair 
 
一、參與會議心得 
The International Conference on Electrical Machines and Systems (ICEMS2008)，為日本、
韓國、與中國聯合舉辦的學術年會，內容涵蓋層面廣泛，包含有：(1) Power Electronics, Electric 
Drives and Motion Control; (2) Renewable Energy Generation; (3) Theory, Modeling and 
Simulation; (4) Conventional Machines: IM, Sync. And DC Machines; (5) Designing, 
Manufacturing, Testing and Standards; (7) Heating, Cooling, Viberation, Noise and EMC; (8) 
Transformers, Reactors and Apparatus; (9) Small & Micro Machines, Servos and Actuators; (10) 
Field Analysis and Computation; (11) Special Machines: PM Machines, RM & SRM, LM; (12) 
Power Electronics, Electric Drives and Motion Control; (13) Theory, Modeling and Simulation; (14) 
Insulating, Monitoring, Diagnosis and Maintenance; (15) Particle Accelerator and Related 
Techniques; (16) High Field Magnet and Applications。本年會由各領域的科技產業專家及學術界
學者發表論文與參加會議的來賓做技術研討與交流。大會的研討會議程安排相當妥當，並安
排多場知名學者專題演講，內容包含有：(1)電機設計、伺服驅動控制發展趨勢的介紹； (2)
電力電子在節約能源上之應用； (3)永磁式同步電機無感測元件技術之分析。 
 
(4) 10/18(六) 8:30 至會場，聆聽相關電機控制、電源轉換及功率元件相關之報告。10:30 則開
始個人論文”Two-stage metal halide lamp electronic ballast with constant output power 
control”之海報報告，分別與多位人士討論本報告及安定器之設計與應用。下午 15:30 擔
任 P4A 的 Section Chair。晚餐後至武漢雜技館觀賞大會安排的節目。 
(5) 10/19(日) 上午向旅館 Check out 後，恰巧與日本教授 Hirofumi Akagi 碰面，並一同搭車前
往武漢國際機場，途中與 Akagi 教授討論 ECCE Asia 的相關事項，並準備邀請 Akagi 明
年訪台。8:35 分搭乘中國南方航空 CZ3075 班機經香港轉華航 CI622 班機，於 14:30 返抵
高雄小港國際機場。 
A. Two-output AC-DC flyback converter 
The power factor correction stage is a two-output AC-DC 
flyback converter. The controller of the flyback converter is a 
PWM IC L6561, which is operated in boundary conduction 
mode (BCM) to shape the line current into a sinusoidal 
waveform and achieving high power factor and low THDi in 
universal AC input voltage (90~264 Vrms) range [8,9]. The 
PFC stage also provides a two stable constant DC output 
voltage for the half-bridge inverter stage to drive lamp. Also, 
the electrical isolation is realized with the transformer.  
 
B. Half-bridge inverter 
The half-bridge inverter is used to drive MH lamp with 
low-frequency square-wave lamp current to avoid acoustic 
resonance. The topology is composed of two switches SH and 
SL, inductor LB and capacitor CB. Switches SH and SL are 
operated at high-frequency switching with low-frequency 
commutation. The low pass filter is composed of inductor LB 
and capacitor CB, which is employed to eliminate high-
frequency switching current ripple. 
Since operation of positive half-period (PHP) and negative 
half-period (NHP) are symmetrical, only the operation in the 
positive half-period is discussed. During positive half-period, 
switch SH is always off and switch SL is operated at high 
frequency to regulate the lamp current. If the voltage across 
of upper capacitor CDC1 and lower capacitor CDC2 are equal 
that voltage can be express as  
 
1 2DC DC DCV V V= = .                                                    (1) 
 
Also, the current of inductor LB is operated in discontinuous 
conduction mode (DCM). Some key waveforms are shown in 
Fig. 5. 
 
Mode I ( t0~t1):  Switch SL is ON, the equivalent circuit of 
this mode is shown in Fig. 6(a). The current flows through 
CDC2, lamp, CB, LB, and SL. 
The energy stored in inductor LB is increased and the inductor 
current iLB is linearly increased. The current iLB can be 
derived as 
 
DC
1
( )
( ) ( )lampLB S
B
V V
i t D T
L
−
= ⋅ ⋅ ,                                  (2) 
 
where D1 is the duty ratio of switch SL, and TS is the 
switching period of the high-frequency. The inductor current 
iLB and switch current iSL, iSH are equal during this period, the 
peak value of inductor current iLB at t = t1 can express as 
 
DC
, , , , 1 1
( )
( ) ( )lampLB pk SL pk SH pk S pk LB S
B
V V
I I I I i t D T
L
−
= = = = = ⋅ ⋅    (3) 
 
Mode II (t1~t2): Switch SL is OFF, and the DH is conducted. 
The equivalent circuit of this mode is shown in Fig 6. (b). 
The current flows through LB, SL, CB, lamp and CDC2. The 
energy stored in inductor LB is released to the lamp and the 
inductor current iLB is decreased linearly. So, the IS,pk can be 
expressed as   
 
DC
. 2
( )
( )lampS pk S
B
V V
I D T
L
+
= ⋅ ⋅ .                                  (4) 
 
 From (3) and (4), D1 and D2 can be solve by 
 
,
1
S pk B s
DC lamp
I L f
D
V V
⋅ ⋅
=
−
,                                                    (5) 
 
,
2
S pk B s
DC lamp
I L f
D
V V
⋅ ⋅
=
+
.                                                    (6) 
 
Mode III (t2~t3): The switch SL is OFF and iLB = 0, the 
equivalent circuit of this mode is shown in Fig 6. (c). The 
lamp energy is provided from capacitor CB. 
While the half-bridge inverter is operated at DCM, the 
lamp current can be derived as 
 
2
, 1 2 ,
2 2
( )
2
S pk S pk DC B S
lamp
DC lamp
I D D I V L f
I
V V
+ ⋅ ⋅ ⋅
= =
−
.              (7) 
 
From (7), the lamp power Plamp is given by 
 
2
,
2 2
S pk lamp DC B S
lamp
DC lamp
I V V L f
P
V V
⋅ ⋅ ⋅ ⋅
=
−
.                               (8) 
 
Also, the inductance LBB operated at boundary condition is 
expressed as 
 
2 2
,min ,min( )
4
lamp DC lamp
BB
lamp DC S
V V V
L
P V f
−
=
⋅ ⋅ ⋅
,                                (9) 
 Where Vlamp,min is the lowest lamp voltage. 
 
 Vgs,L
VLB
iLB
iS,H
 TS
Ilamp
t
t
t
t
t
iS,L
t
 D1TS
 D2TS
 D3TS
I II III
t0 t1 t2 t3
ILB,pk=ISL,pk=IS,pk
ILB,avg=Ilamp
ISL,pk=IS,pk
VDC-Vlamp
-(VDC+Vlamp)
? iLB
 
Fig. 5. Waveforms of half-bridge inverter for switching period TS 
2120
Authorized licensed use limited to: National Cheng Kung University. Downloaded on February 16, 2009 at 22:15 from IEEE Xplore.  Restrictions apply.
If the switch current signal gain Ki and the gain of the lamp 
voltage Kv are designed as the following, then (15) is equal to 
(11). This implies that, the constant power control can be 
achieved. 
 
, max ,min
ref
i
S pk lamp
V
K
I m V
=
− ⋅
 ,                                 (16) 
 
v iK m K= − ⋅ .                                                     (17) 
 
Then, substituting (15) into (8), the lamp power at DCM is 
given by  
 
2
2 2( )
refv
lamp lamp DC B S
i i
lamp lamp
DC lamp
VK V V V L f
K K
P V
V V
⎛ ⎞⎛ ⎞
−
⋅ + ⋅ ⋅ ⋅ ⋅⎜ ⎟⎜ ⎟⎜ ⎟⎝ ⎠⎝ ⎠
=
−
. (18) 
 
 
Lamp Voltage (V)
Pe
ak
 S
w
itc
h 
Cu
rre
nt
 (A
)
(Vlamp ,min,IS,pkmax)
(Vlamp,max,IS,pkmin)
Lamp steady-state 
operating-region 
70 80 90 100 110 120 130
0.6
0.65
0.7
0.75
0.8
0.85
0.9
 
Fig. 8. The peak current of switch IS,pk versus lamp voltage 
 
 
Vlamp
LB
CB
+
_
Vref
Σ
Ki
VPWM
Rlamp
SH
Latch & 
Driver
VDC1
VDC2 Differential 
Amplifier, Kv
Comparator
iLB(t)
SL
Vcls(t)
Half-bridge 
Driver
Square Wave 
Generator
iSL,on(t)
iSH,on(t)
Oscillator
Clock
KvVlamp
KiiS(t)
Vcls(t)
Vref
Constant power control block diagram
Switching  current sense 
KvVlamp(t)
Lamp voltage sense 
 
Fig. 9. Control block diagram with key waveform 
IV. EXPERIMENTAL RESULTS 
A laboratory prototype of 35 W MH lamps electronic 
ballast is implemented. The specifications of the MH lamp 
electronic ballast are as follows: 
 
z MH lamp rated wattage: 35 W; 
z Universal AC input voltage range: 90~264 Vrms, 60 Hz; 
z Lamp operating voltage range: 80~120 Vrms; 
z Lamp operating-frequency: 200 Hz; 
z DC-bus voltage(VDC1=VDC2): 200 V; 
z Minimum switching-frequency of  the PFC stage: 50 
kHz; 
z Switching-frequency of half-bridge inverter: 50 kHz; 
z Ignition voltage pulse: 3 kV. 
 
Two-stage MH lamp electronic ballast was researched in 
this study, and the several principal parameters can be 
calculated as: LB = 1.95 mH, Vlamp,min = 80 V, IS,pkmax = 0.86 A, 
IS,pkmin = 0.61 A, Vref = 1 V, m = -6.175 × 10-3, Kv = 4.562 × 
10-3, and Ki = 0.739. According to (18), the output-power 
characteristic-curve of half-bridge inverter is illustrated in Fig. 
10. It depicts that the power variation is ±1.31 % at DCM 
operation. 
The AC input voltage vac and AC input current iac 
waveforms at 110 Vrms, 60 Hz AC-input voltage is shown in 
Fig. 11. It can be seen that, the input current is in phase with 
input voltage. Measured power factor and the THDi under 
universal input voltages are shown in Fig. 12, and Fig. 13, 
respectively. They show that very high PF and low THDi can 
be obtained under low AC input voltage. At the high AC 
input voltage (264 Vrms), the PF is 0.9 and THDi is 31 %. 
 
 
Lamp Voltage (V)
La
m
p 
Po
w
er
 (W
)
80 90 100 110 120
30
32.5
35
37.5
40
35.31
34.39
 
Fig. 10. Theoretical lamp power analysis of 35 W proposed electronic ballast 
 
 
vac (100 V/div)
Time: 10 ms/div
iac (500 mA/div)
 
Fig. 11. AC input voltage and current waveforms 
2122
Authorized licensed use limited to: National Cheng Kung University. Downloaded on February 16, 2009 at 22:15 from IEEE Xplore.  Restrictions apply.
VI. ACKNOWLEDGEMENT 
This work was supported in part by LIGTEK Electronic 
Co., Ltd. under project no. 1Z960314 and the Advanced 
Optoelectronic Technology Center, National Cheng Kung 
University. 
 
REFERENCES 
[1] H. Peng, S. Ratanapanachote, P. Enjeti, L. Laskai, and I. Pitel, 
“Evaluation of acoustic resonance in metal halide (MH) lamps and an 
approach to detect its occurrence,” in Proc. IEEE IAS, 1997, vol. 3, pp. 
2276-2283. 
[2] M. A. D. Costa, J. M. Alonso, J. Garcia, J. Cardesin, and M. Rico-
Secades, “Acoustic resonance characterization of low-wattage metal-
halide lamps under low-frequency square-waveform operation,” IEEE 
Trans. on Power Electron., vol. 22, no. 3, pp. 735-743, May 2007. 
[3] C. R. Lee, K. H. Chen, and C. S. Moo, “Operating characteristics of 
small-wattage metal halide lamps with square wave current from 50 Hz 
to 50 kHz,” in Proc. IEEE IAS., 2003, vol. 2, pp. 1030-1035. 
[4] S. T. Chen, and L. L. Lee, “Optimized design of the electronic ballast 
for metal halide lamps,” in Proc. IEEE APEC., 2004, vol. 2, pp. 991-
996. 
[5] W. Mark, “A study of the high intensity discharge lamp-Electronic 
ballast interface,” in Proc. IEEE IAS, 2003, vol. 2, pp. 1043-1048. 
[6] Y. Jiang, J. Zhou, and Z. Qian, “A novel single stage single switch PFC 
converter with constant power control for ballast for medium HID 
lamps,” in Proc. IEEE IAS, 2000, vol. 5, pp. 3415-3418. 
[7] J. Xu, M. Chen, T. Zhang, and Z. Qian, “A constant power control 
strategy of electronic ballast,” in Proc. IEEE IAS, 2006, vol. 3, pp. 
1109-1102. 
[8] R. Erickson, M. Madigan, and S. Singer, “Design of a simple high-
power-factor rectifier based on the flyback converter,” in Proc. IEEE 
APEC., 1990, pp. 792-801. 
[9] “Design equations of high-power-factor flyback converter based on the 
L6561,” ST microelectronics application note, AN1059, 2003. 
[10] C. M. Huang, T. L. Liang, R. L. Lin, and J. F. Chen, “A novel constant 
power control circuit for HID electronic ballast,” IEEE Trans. on 
Power Electron., vol. 22, no. 3, pp. 854-862, May 2007. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Table I.  Measured results of various 35 W MH lamps at 110 Vrms AC input voltage 
No. Lamp type Pin(W) Vlamp(V) Ilamp(A) Plamp(W) 
1 GE CMH35/U/PAR20 E27 R35W 41.13 83.84 0.410 34.13 
2 GE CMH35/T/UVC/U/830/G12 40.40 93.80 0.373 33.83 
3 PHILIPS CDM-R 35W/830 PAR20 (1) 39.98 77.17 0.430 32.91 
4 PHILIPS CDM-R 35W/830 PAR20 (2) 39.79 86.02 0.395 33.08 
5 OSRAM HCI-T 35W/WDL 40.65 88.94 0.390 33.95 
 
 
2124
Authorized licensed use limited to: National Cheng Kung University. Downloaded on February 16, 2009 at 22:15 from IEEE Xplore.  Restrictions apply.
成大劉濱達教授、楊家輝教授、詹寶珠教授、謝明得教授等多位學者，參加此次的 APCCAS
國際會議，使得個人在學術研討交流及產業技術發展趨勢等方面皆獲益良多。 
 
二、參加會議經過 
(1) 11/30(日)上午與成大電機系楊家輝教授從高雄小港國際機場搭乘長榮航空下午 15:35 
BR0835 班機至澳門國際機場，17:10 抵達澳門，隨即搭乘接駁車至會議所在地點威尼斯
人酒店，並至大會報到，緊接著參加大會的 Welcome Reception，會中與許多學者交換心
得。Welcome Reception 結束後，與交大黃威教授、中山王朝欽、及成大楊家輝教授由澳
門大學博士生帶領參觀澳門並瞭解當地風貌。 
(2) 12/01(一) 09:00~11:00 參加開幕典禮及聆聽專題演講，9:30~10:10 的專題演講題目為「New 
Architectures for Low-power Delta-Sigma Analog-to-digital Converters」；10:30~11:00 的專題
演講題目為「Body Channel Communication for Low Energy BSN/BAN」。11:20~12:50 聆聽
Technical session。12:50~ 14:00 參加大會安排的午宴。14:00~17:20 繼續聆聽 Technical 
sessions。晚上大會並無安排行程，因此與多位國內學者邀約前往具有澳門當地特色的餐
廳用餐。 
(3) 12/02(二) 08:40~09:20參加專題演講，演講題目為「A look at Future Challenges」。09:30~12:50 
聆聽 Technical session。12:50~ 14:00 參加大會安排的午宴。14:00~17:20 繼續聆聽 Technical 
sessions。晚上 18:00~20:00 參加大會的 Banquet，並與許多國內外學者交換心得。 
(4) 12/02(三) 08:40~09:20 參加專題演講，演講題目為「Power RFID Chip Technology」。
09:30~12:50 聆聽 Technical session。12:50~ 14:00 參加大會安排的午宴。14:00~15:30 聆聽
Technical session。15:50~17:20 發表論文「Design of a Green Mode PWM Control IC」，此
論文並與 Session Chair 及許多國外學者討論本論文之相關技術問題，論文發表結束後隨
即搭乘接駁車至澳門機場。晚上 8:05 搭乘長榮航空 BR08365 班機回台，於 21:30 返抵高
雄小港國際機場。 
 
 
三、參加會議之相關照片 
Design of a Green Mode PWM Control IC 
Hung-Da Hsu, Tsorng-Juu Liang, Bin-Da Liu, Kai-Hui Chen 
Department of Electrical Engineering 
National Cheng-Kung University, Tainan, Taiwan 
Email: tjliang@mail.ncku.edu.tw 
 
 
Abstract— To decrease the power consumption of a switching power 
supply, the most effective approach is to lower the switching 
frequency. Hence, the current mode pulse-width-modulation 
(PWM) controller used in a switching regulator must be capable of 
frequency modulation at light-load condition. The green mode 
circuit is designed in proposed current mode PWM control IC with 
the concept of off-time modulation. The switching frequency 
reduction and switch losses will be proportion to the load decrease 
at light-load condition. Also, the leading edge blanking (LEB), soft 
start, slope compensation, and over voltage protection (OVP) 
functions are integrated into the proposed chip. 
I. INTRODUCTION 
  With the development of modern science and technology, 
consumer electronics products are being improved constantly. In 
order to fit in with the power supply and the load demand of 
numerous electronics products, the technology of energy 
conversion plays an important role undoubtedly [1][2]. Switching 
converters have a great influence in the power supply technique 
field. By means of accurate control method, a switching converter 
can deliver stable energy to the load by dealing with the input 
power [3]. Besides, through choosing a well-designed PWM 
control IC, the switching converter can achieve higher 
performance and superior reliability. 
  The main losses of a switching regulator are switching loss, 
conduction loss and the loss on the control circuit [4]. At light-
load or no-load conditions, the output current of switching 
regulator demands fewer, hence the conduction loss becomes very 
small. So the switching loss that increases with the operating 
frequency turns into the main power loss. If the operating 
frequency is maintained at the no-load condition, the switching 
loss becomes dominant factor of power dissipation and will 
degrade the efficiency of the whole system. Decreasing the 
operating frequency can lower the power loss at light-load 
condition effectively [5][6]. The pulse-frequency-modulation 
(PFM) technique is usually adopted at light-load condition. The 
research topic of this paper is to integrate not only the green mode 
function but some useful functions such as LEB, OVP, soft start 
and slope compensation [7]-[10]. Consequently, the power loss of 
the switching regulator can be reduce by the proposed current 
mode PWM control IC. 
 
 
II. IMPORVEMENT FOR REDUCING STANDBY 
POWER LOSSES 
Decreasing switching frequency is a widely used technique to 
reduce the switching losses in the power MOSFET and the core 
losses in the transformer of isolated switching regulator. The 
function of decreasing switching frequency must follow the load 
variation to decide the proper frequency at the standby mode. 
Once the system is operated in the standby mode, the switching 
frequency must be changed from normal mode to proper standby 
mode frequency according to the load variation. 
The control IC normally operates at fixed switching 
frequency generated by the RC oscillator. When the system enters 
the standby mode, the switching frequency must be decreased. 
The concept of decreasing switching frequency is illustrated in 
Fig. 1. Switching period is composed of turned-on time and 
turned-off time. Elongating the turned-off time is a common 
method to increase the switching period. When the turned-off 
time becomes longer pulse by pulse, the switching frequency will 
be reduced gradually. The reduced frequency of the standby mode 
clock signal will be obtained. This kind of green mode function is 
named “off-time modulation”.  
 
Fig. 1 The concept of off-time modulation 
 
The approach of generating green mode clock signal is 
illustrated in Fig. 2. When Vgmact is activated at logic high to enter 
the standby mode, the current, I, starts to charge the external 
capacitor C. A ramp voltage, Vr, is generated and sent to the non-
inverting terminal of green mode comparator. The signal, Vgmlim, 
varies in inverse proportion to the load variation, and it is sent to 
the inverting terminal of green mode comparator. Comparing Vr 
with Vgmlim, the green mode clock signal, Vgmclk, can be obtained. 
 
Fig. 2 The diagram of generating green mode clock signal 
 
1876978-1-4244-2342-2/08/$25.00 ©2008 IEEE.
voltage signal on “RtCt” is divided by Rs1 and Rs2, and it is added 
to the current-sensing signal. The addition of the sawtooth 
waveform must follow the PWM control signal in order to ensure 
that the slope compensation operate correctly. 
 
 
Fig. 5 Circuit diagram of leading edge blanking and slope 
compensation 
 
C. OVP Latch 
  This function is used to prevent the system from the over-
voltage condition. It is designed to rapidly detect the over-voltage 
failure, and shut down the system. The circuit is shown in Fig. 6. 
When VDD of the PWM control IC is not enough to enable the 
PWM control IC, then the voltage signal on “regstop1” is at logic 
high to reset LATCH. The functions of PWM control IC will not 
be activated. If the voltage signal on “OVP” is higher than the 
reference voltage level, Vovp, then LATCH will be set to turn on 
Movp, and the voltage signal on “regstop2” will be at logic high 
eternally. Thus, the signal “regstop” is always at logic high to 
make the PWM control IC shut down. Until VDD is removed, 
LATCH will be reset again to enable the PWM control IC. 
 
 
Fig. 6 OVP Latch 
 
IV. MEASUREMENT RESULTS 
The proposed PWM control IC was fabricated in TSMC  0.35
μm mixed signal 2P4M polycide 3.3V/5V process. Some blocks 
inside the chip are tested individually. 
A. Startup condition of the PWM control IC 
The waveforms associated with startup state such as VDD, 
VRtCt, Vsw, and Vref are shown in Fig. 7. In Fig. 7 (a), an interval 
time of 2 ms is observed, and in Fig. 7 (b), an interval time of 10 
μs is observed. When VDD is applied to the proposed PWM 
control IC, the voltage level has to be higher than the default 
voltage, and the linear regulator starts to generate Vref. When Vref 
rises to the desired voltage level, the VRtCt will be generated on 
pin “RtCt”. Besides, when the pin “CS” is not connected with any 
signal, the sawtooth waveform will be sensed at “CSout” due to 
the internal slope compensation resistor between “RtCt” and 
“CSout”. An additional voltage level can be applied to the pin 
“COMP” for generating the PWM signal, Vsw. In Fig. 7 (b). After 
Vref becomes steady, the first cycle of VRtCt is generated and Vsw 
occurred at the same time. Besides, the peak and valley values of 
VRtCt are much close to the desired voltage levels generated from 
bandgap voltage reference. The voltage level of Vref can be 
regulated steadily to be equal to 2.5 V. 
 
(a)                                                (b) 
Fig. 7 The signals associated with startup condition.                     
(a) 200 μs/div. (b) 1 μs/div. 
 
B. Startup condition of entering green mode 
The threshold voltage level of entering green mode is set to 
be equal to 0.2 V. It means that when the voltage on “COMP” is 
lower than the threshold level, the green mode function will be 
activated. Some signals associated with the startup condition of 
green mode are shown in Fig. 8. From Fig. 4 (a), when Vcomp is 
lower than 0.2 V, Vgmact, will be activated to be at logic high. 
From Fig. 8 (a), VRtCt, will stop operating, and the oscillator will 
stop generating the PWM clock signal. The PWM signal, Vsw, will 
be no longer generated. The green mode will generate the green 
mode clock signal for the system at the same time. From Fig. 4 (b) 
and Fig. 8 (b), with a small capacitor connected to the pin “SS”, 
VSS will rise up to compare with Vgmlim to generate the green 
mode PWM clock signal. The oscillator will not operate, and VRtCt 
will be held at the voltage level which is equal to Vref. 
VRtCt
Vcomp
Vsw
VRtCt
Vcomp
Vss
 
(a)                                                (b) 
Fig. 8 The signals associated with entering green mode.                
(a) 1 μs/div. (b) 5 μs/div. 
 
C. Current mode control of the PWM control IC 
The signal on pin “COMP” is the control signal of current 
mode control, and it will dominate the duty cycle of Vsw. The 
higher the voltage level on “COMP” is, the larger the duty cycle 
of Vsw is. The conditions of the voltage level on “COMP” are 
illustrated by Fig. 9. In Fig. 9 (a), when the voltage level on 
“COMP” is about 2.93 V, the duty cycle of Vsw is about 0.318. 
And when the voltage level on “COMP” is about is 1.06 V, the 
duty cycle of Vsw is about 0.15 as shown in Fig. 9 (b). By the 
1878
