行政院國家科學委員會補助專題研究計畫■ 成 果 報 告   □期中進度報告 
 
發展使用非線性採樣濾波器之多元感測器融合定位定向系統 
The Development of Multi-sensor Fusion Positioning and Orientation 
Systems Using Nonlinear Sampling Filtering Approaches 
    
計畫類別：■ 個別型計畫 □ 整合型計畫 
計畫編號：NSC 100-2221-E-006-232 
執行期間： 100 年 8 月 1 日至  101 年 7 月 31 日 
 
計畫主持人：江凱偉 
計畫參與人員：蔡孟倫(博士生)、廖振凱(碩士生)、林政安(碩士生)  
 
成果報告類型(依經費核定清單規定繳交)：■精簡報告  □完整報告 
 
本成果報告包括以下應繳交之附件： 
□赴國外出差或研習心得報告一份 
□赴大陸地區出差或研習心得報告一份 
□出席國際學術會議心得報告及發表之論文各一份 
□國際合作研究計畫國外研究報告書一份 
 
 
處理方式：除產學合作研究計畫、提升產業技術及人才培育研究計畫、
列管計畫及下列情形者外，得立即公開查詢 
          □涉及專利或其他智慧財產權，□一年□二年後可公開查詢 
          
執行單位：國立成功大學測量及空間資訊學系 
 
 
 
 
 
中   華   民   國  101  年 5 月 31 日 
 2
(Micro-Electro-Mechanical System, MEMS)技術的發展， MEMS IMU將慣性元件包含三軸加
速度計和陀螺儀裝於單一晶片，使得其體積、重量、成本皆大幅縮小，但也由於輕量化和
製造過程，MEMS IMU的飄移、尺度因子、雜訊和穩定性等參數皆較差，通常以兩種方式
克服這些缺點，其一為使用多組輔助感測器或是提出更貼切的估計演算法。本年度主要研
究目標為利用量子濾波器/平滑器、無跡卡曼濾波器/平滑器發展鬆耦合與緊耦合的多元感測
器定位定向演算法。鬆耦合架構因為其結構簡單故為目前各商用軟體所採用的多元感測器
融合架構，然而，目前並無以無跡量子濾波器/平滑器與無跡卡曼濾波器/平滑器發展之商用
鬆耦合的多元感測器定位定向軟體。本研究期透過採樣濾波器與平滑器之優點進一步提升
低成本多元感測器定位定向之精度，同時本研究所開發之架構除了透過使用GNSS與IMU之
資料外，未來亦提供使用者選用輪速記速度、航向儀之航向與非協和約制條件，這也是一
般商用軟體沒有的設計。 
三、　 非線性非高斯演算法 
    Bayesian 估計為動態估計模型的基礎理論，藉由 Bayesian 估計的基礎理論可發展出
INS/GPS整合估計策略。在Bayesian估計理論中，對一個動態的系統而言，以P(Xk|Xk-1 , Z1:k-1)
表示系統模型的密度分布函式，而以 P(Xk | Zk)表示觀測量模型的密度分部函式，其中： 
 
Xk = Fk ( Xk-1 , Wk ) ，Zk = Hk ( Xk , Vk )             (1) 
 
Xk 為 k 時刻的狀態項，Wk 為 k 時刻的系統雜訊，Zk 為 k 時刻的觀測量，Vk 為 k 時刻
的觀測雜訊，Fk ， Hk 為狀態項和觀測量非線性函式。估計的目的為決定下一瞬刻機率密
度函式(probability density function, PDF) P(Xk| Z1:k)，推估狀態項 Xk 的估計值X෡k 和其協變方
矩陣，整個 Bayesian 估計可分為兩個階段： 
 
1. 預估階段： 
預估階段為利用前一時刻的系統模型求得先驗 PDF，其公式如下： 
 
ܲሺܺ௞|ܼଵ:௞ିଵሻ ൌ ׬ܲሺܺ௞|ܺ௞ିଵሻܲሺܺ௞ିଵ|ܼଵ:௞ିଵሻ݀ܺ௞ିଵ           (2) 
 
2. 更新階段： 
為接收到輔助觀測量時所執行，先驗 PDF 可被更新，其公式如下： 
 
ܲሺܺ௞|ܼଵ:௞ሻ ൌ ܲሺܺ௞|ܼ௞ሻܲሺܺ௞|ܼଵ:௞ିଵሻܲሺܼ௞|ܼଵ:௞ିଵሻ  
3.1  量子濾波器(PARTICLE FILTER, PF) 
 
      基於 Bayesian 估計和 Monte Carlo 估計，通用量子濾波器能以下式表示： 
若有一組序列之量子൛ݔ଴:௞௜ ; ݅ ൌ 1,2, …ܰൟ，且已知其後驗分佈為ܲሺܺ଴:௞|ܼ଴:௞ሻ，則估計值可以
以下是描述： 
෠ܲሺܺ଴:௄|ܼ௞ሻ ൌ ଵே∑ ߜ௫బ:ೖ೔ ሺே௜ୀଵ ݀ܺ଴:௞ሻ                      (3) 
 4
 
圖 2：無跡量子濾波器流程圖 
 
3.3 擴展式量子濾波器 (EXTENDED PARTICLE FILTER ,EPF)和無跡量子濾波器
(UNSCENTED PARTICLE FILTER ,EPF) 
     
通用量子濾波器其中之一重大議題，為量子採樣需合適的密度分布，可藉由高斯近似
得到ܲሺܺ௞|ܺ௞ିଵ, ܼ଴:௞ሻ。實務上，如果利用 EKF 高斯近似取得ܲሺܺ௞|ܺ௞ିଵ, ܼ଴:௞ሻ，則稱為擴展
式量子濾波器，反之利用 UKF 近似，則稱為無跡量子濾波器。本案首先利用 EKF 和 UKF
同時取計算高斯近似和其狀態項及協變方，然後利用下式採樣量子及權： 
 
ݔො௞௜ ~ݍ൫ݔ௞௜ หݔ௞ିଵ௜ 	, ݖ௞൯ ൌ ܰሺ̅ݔ௞, ௞ܲሻ  ， ݓ௞௜ ൌ ௣ሺ௭ೖ|௫ොೖ
೔ ሻ௣ሺ௫ොೖ೔ |௫ೖషభ೔ ሻ
ேሺ௫̅ೖ,௉ೖሻ              (8) 
 
其中ܰሺ. ሻ為表示高斯分布，̅ݔ௞, ௞ܲ為 EKF 或 UKF 近似之平均值與協變方，圖 3 說明 UPF
流程。 
 
圖 3：無跡量子濾波器流程圖 
 
四、 模擬分析 
4.1 線性函式模擬 
 
為了比較量子濾波器與傳統卡曼濾波器差異，首先利用兩種函式分別模擬線性和非線性，
 6
 
      
圖 5：比較非線性函式之 RMSE         圖 6：各濾波器之執行時間 
 
五、 　 INS/GPS 整合架構 
 
5.1 整合架構 
 
圖 7 為本研究所使用的整合架構，IMU 的輸出包含加速度計與陀螺儀，而 INS 機械方
程式則基於 Bayesian 估計包含了系統動態模型；觀測量模型部分，利用 GPS 建立觀測量和
對應的函式建立觀測量模型，最終整合 GPS 和 INS 的結果，皆較個別獨立結果佳。 
 
 
圖 7：INS/GPS 整合架構 
 
   本研究針對鬆耦合與緊耦合架構進行分析，其主要差異在於 GPS 觀測量，鬆耦合所輔
助的 GPS 為 GPS 解包含其位置與速度，而緊耦合架構則是使用 GPS 觀測量包含虛擬距離、
Doppler 訊號或載波訊號。 
 
5.2 系統動態模型 
在 EKF 中，PSI 誤差模型被用來當作系統動態模型(Rogers, 2007)，在非線性的估計測略
中，INS 機械方程式中核心動態模型的框架為當地水平框架。 
 
 8
優異，其中提升的比率約 12%，但 UKF 和 UPF 的執行時間遠多於 EKF，EKF 的運算時間
約為作業時間的 30%，UKF 和 UPF 則約為 300%和 600%。另一方面，緊耦合的解果較鬆
耦合明顯，特別式於都市區高遮蔽率區域，EKF 精度提升約為 14%，UKF 則為 20%，而最
顯著的提升則為 UKF-TC 相較 EKF-LC 提升約 50%，從結果可看出緊耦合可叫鬆耦合較早
收斂。 
 
本研究之成果迄今計已發表一篇美國導航學會 ION GNSS 2011 年之國際研討會文章
(EI)、一篇美國導航學會 ION GNSS 2012 年已接受摘要，與一篇已接受之 SCI 期刊文
章 (Sensor Letters)。  
 
圖 7：測試平台                    圖 8：參考&測試系統 
 
圖 9：參考軌跡 
 
 10
六、　 結論與建議 
本研究發展非線性非高斯分布估計演算法，並整合 INS/GPS 以期提升移動製圖系統之
位置與姿態精度。從分析結果得知，大體而言於非線性及雜訊非高斯分布的估計下，UKF
和 UPF 較 EKF 優異，唯執行時間過久為其缺點，若同時考慮執行時間，則 UKF 為較佳的
選擇，從移動製圖系統的模擬資料及測試資料，系統和觀測量的非線性影響並非甚巨，雜
訊也接近高斯分佈，從以上可知於即時系統使用 EKF 為最佳選擇，而後處理則為 UKF 及
UPF 較為適當。 
參考文獻 
 
1. Julier, S.J.; Uhlmann, J.K. New extension of the Kalman filter to nonlinear systems, Proceedings of the 
SPIE,1997,182-193. 
2. Rogers, R.M. Applied Mathematics in Integrated Navigation Systems, Third Edition, AIAA, 2007.  
3. Shin, E. H. A Quaternion-Based Unscented Kalman Filter for the Integration of GPS and MEMS INS, 
Proceedings of ION GNSS 2004, Long Beach, California, September 21-24, 2004. 
 
國科會補助專題研究計畫成果報告自評表 
請就研究內容與原計畫相符程度、達成預期目標情況、研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）、是否適
合在學術期刊發表或申請專利、主要發現或其他有關價值等，作一綜合評估。
1. 請就研究內容與原計畫相符程度、達成預期目標情況作一綜合評估 
   ■達成目標 
□ 未達成目標（請說明，以 100 字為限） 
□ 實驗失敗 
□ 因故實驗中斷 
□ 其他原因 
說明： 
 
無研發成果推廣資料 
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
無 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
