1 
 
 
行政院國家科學委員會補助專題研究計畫成果報告
 
 
 
下行多載波分碼多重存取系統之用戶分組與適應性調變機制 
 
計畫類別：■個別型計畫   □整合型計畫 
計畫編號：NSC  99－2221－E－260－018 
執行期間： 99 年 8 月 1 日至 100 年 7 月 31 日 
 
執行機構及系所：國立暨南國際大學 電機工程學系(所) 
 
計畫主持人：郭耀文 
共同主持人： 
計畫參與人員：李世豪、王修安、楊鎮誥、黃靖中 
 
 
 
成果報告類型(依經費核定清單規定繳交)：■精簡報告  □完整報告 
 
本計畫除繳交成果報告外，另須繳交以下出國心得報告： 
□赴國外出差或研習心得報告 
□赴大陸地區出差或研習心得報告 
■出席國際學術會議心得報告 
□國際合作研究計畫國外研究報告 
 
 
處理方式：除列管計畫及下列情形者外，得立即公開查詢 
            □涉及專利或其他智慧財產權，□一年□二年後可公開查詢 
 
中   華   民   國  100 年 10 月 29 日  
3 
 
要求愈來愈高，通訊系統也不單是傳統的
類比通訊，更進步為高效能的數位通訊。
以前的電信系統傳送的訊息是單純的語音
訊號，但在廣泛應用多媒體的時代裡，以
說話為主的傳統通訊系統到現在已經逐漸
不能滿足民生需求，而未來的通訊發展趨
勢必然的會朝向多媒體通訊，能夠快速的
傳輸大量語音、影像等的數據服務。 
而隨著存取技術的不斷進步，語音、
視訊，多媒體和寬頻數據的服務正逐漸整
合到同一個網路當中。但是因為多媒體傳
輸需要相當大的傳送資料量，所以高速率
傳輸所需的頻寬也必須相對地增加，而增
加頻寬會帶來問題，這問題就是傳送信號
的符碼干擾(Inter Symbol Interference ; ISI)
將會使錯誤率嚴重增加。為了解決這個問
題，很多研究學者提出能夠抑制 ISI 干擾的
數位調變技術，而多載波調變(multi-carrier 
modulation，簡稱 MCM)正是可以實現這目
標的一種技術，其中最受矚目的技術為多
載波分碼多重存取系統(Multi-Carrier Code 
Division Multiple Access ， 簡 稱
MC-CDMA)[1]。MC-CDMA 被視為一種多
載波的系統，且此調變技術同時具有
OFDM 和 CDMA 兩者的優點。 
CDMA 在頻域上有分集(diversity)的優
點且對於窄頻干擾、脈衝雜訊有較強的抗
干擾力，並且因為使用者間是以展頻碼做
為區隔，在同一個頻帶和時間上可以同時
容納許多使用者，大幅增加了系統使用容
量的問題。這個系統的特色是將信號展頻
在 OFDM 的子載波上，並使用正交碼
(Hadamard Walsh code)當作展頻碼。使用正
交碼的優點在於不同碼之間的交相關為0，
則不會有使用者之間互相的 MAI(Multiple 
Access interference)干擾。但是當使用者間
的正交碼不同步時，如果接收端對同步的
動作沒有做好將會使信號的解調產生錯誤，
所以需要有很精確的展頻碼同步才能維持
系統的效能。 
正交分頻多工 (Orthogonal Frequency 
Division Multiplexing，簡稱 OFDM)，使用
多個正交子載波與循環字首，可以有效地
提升頻寬使用率，解決有限傳輸頻寬上頻
帶使用率的問題，同時也能克服多重路徑
所 造 成 的 符 元 間 干 擾 (Inter-Symbol 
Interference，簡稱 ISI)。MC-CDMA 結合了
上述兩項技術 CDMA 和 OFDM 的優點，利
用展頻技術將資料展頻至不同子載波上，
讓系統達到頻率分集的效果，同時具有正
交子載波的特性，更可以在同一時間與同
一頻帶上讓多個用戶同時存取，大幅增加
了 子 載 波 的 使 用 效 率 ， 基 於 這 些
MC-CDMA 的特點，讓 MC-CDMA 成為下
一代行動通訊的熱門選擇之一。 
 
三、研究目的 
MC-CDMA 系統將資料展頻至所有的
頻率上，為了讓用戶能有更好的傳輸品質，
用戶分組可以有效的增加系統在頻率選擇
性 衰 減 通 道 (frequency selective fading 
channel)下的效能，如果使用者將資料展頻
道到衰減很大的子通道上，接收端收的訊
號將很難解調出正確的資料，反而會造成
解展頻時候的困擾，如果針對不同的使用
者，只分配較好的通道給他，將可以大大
地降低錯誤率與提升頻譜的使用效率。 
大多數的 MC-CDMA 研究文獻中，系
統都是以固定的調變方式(如 BPSK)為前提
去分析與模擬，而實際上 MC-CDMA 應該
依據瞬時通道資訊來改變用戶的調變方式
以及傳輸功率，讓平均通道好的使用者可
以採用較佳的調變方式(如 64QAM)，而平
均通道差的使用者，採用較為強健的調變
(如 BPSK)，這樣一來可以提升整體頻譜使
用效率，而整個 MC-CDMA 系統的效能可
以大大提升。 
5 
 
1,,0,1
21
0 1
−== ∑∑
−
= =
NieCX
N
x N
injN
n
U
j
j
kji …
pi
 (1) 
於多重路徑會造成接收端的 ISI干擾，
因此一般的 OFDM 系統都會在並列轉串列
後的每一個 OFDM Symbol 前端加入所謂
的保護區間(Guard Interval，GI)，保護區間
放置均為零的資料(zero padding)，但放置為
零方式在信號經過通道時會造成子載波之
間喪失正交性(ICI)，所以為了處理 ISI 干擾
的問題和確保子載波之間的正交性，會採
用循環字首碼(CP)的作法：OFDM Symbol
後端的資料複製放到前段保護區間，此方
法稱為循環字首碼(Cyclic Prefix，CP)，CP
長度只要大於或等於多路徑延遲時間的長
度，就可以取樣到原本所傳遞的資料區間，
解決了 ISI 與 ICI 的問題。假設加入 CP 後
的訊號為    ，   信號經過通道做摺積，
與雜訊干擾之後，此時用戶的信號   ，表
示如下： 
0nh +∗= MCMC xy         (2) 
圖 1 的下半部為接收端的方塊圖，首
先接收信號     會先移除 CP 的信號，在
經過 FFT 轉換後的頻域信號，如下：  
1,,0,    
1
−=+= ∑
=
U
j
ii
j
iji NinHCXY …     (3) 
訊號在經過多重路徑衰減通道之後，
接收端解調變時就需要利用一些等化器的
檢測(detection)方式將頻域上展頻的訊號做
組合(combing)，再將所有子載波上的訊號
相加去得到解調出來的訊號值。圖 1 中的
jXˆ 可表示成下式： 
                                  (4) 
其中   個用戶在第 i 個子載波上的解調器
權重，而  則是解調後傳送端訊號 Xj 前面
的係數。 
以下介紹幾種常見的 SUD(Single User 
Detection，簡稱 SUD)檢測法。這些都可以
使用在多載波分碼多重接取系統之接收端
架構。 
 
強制歸零檢測法(Zero forcing 
equalizer)： 
強制歸零檢測法也稱作回復正交檢測
法(Orthogonality restoring combining, ORC)。
雖然 MC-CDMA 中所使用的展頻碼為具有
正交性的 Hadamard Walsh code，但在經過
多重路徑通道效應之後，正交碼的正交特
性還是會被通道增益破壞，使得每個用戶
間的展頻碼交相關不再為 0，於是使用者之
間產生 MAI 的干擾，但使用 Zero forcing
可以讓 MAI 為 0。Zero forcing 的原理就是
各個子載波上的接收端訊號乘上通道增益
的倒數來做解調，把被通道破壞的正交特
性回復，Zero forcing 的解調器權重如下： 
 1,,0,      1     
2
−==
=
∗
Ni
H
C
H
HCq
i
j
i
i
ij
i
j
i
…
         (5) 
而經過數學運算可以得到檢驗後的   如
下： 
1 1 1
0 0 1, 0
ˆ
1 1 1
k
N N U N
k k j k k i
k i i j i i i
i i j j k i i
X
nX C C X C C C
Hα α α
− − −
= = = ≠ =
=
+ +∑ ∑ ∑ ∑
 (6) 
第一項的訊號為用戶 k 的傳送端訊號，
因為要讓  前面的係數為 1，每個子載波訊
號相加後要除以係數α ，因為展頻碼間互
相正交的特性，所以我們可以定義： 
∑
−
= 


≠
=
=
1
0 ,     0
,   
N
i
k
i
j
i kj
kjN
CC
       (7) 
可看出使用 Zero forcing 時 N=α 。第二項
為用戶 j( kj ≠ )對用戶 k 所造成的干擾，也
就是 MAI 項。所以則可簡化如下： 
UjYqX
N
i
i
j
ij ,...,1,    
1
ˆ
1
0
== ∑
−
=
α
MCx MCx
MCy
MCy
α
kX
ˆ
kX
j
iq
7 
 
Estimation)。此為本計畫所使用的解調器。
最主要的條件就是對信號所做的估測值與
實際值的誤差必須和信號在每個載波上的
成分形成正交，MMSEC 的原理和 Zero 
forcing 類似，也是做正交性完全回復的動
作，它的特色是在解調器權重的分母加入
了一個子載波的雜訊比當參數。而 MMSEC
又分為 MMSEC per user 和 MMSEC per 
carrier，本計畫使用的是 MMSEC per carrier，
經由參考文獻 [3]中的推導，可以得知
MMSE per carrier 的等化器權重為： 
β+= 2
*
i
ij
i
j
i
H
HCq            (16) 
定義  為系統分配給用戶 j的總功率，
而   為雜訊功率，則








=
∑
=
NP
U
j
j /
1
2σβ  
而經過數學運算可以得到檢驗後的   為：
( ) *1 2
1, 0
ˆ
1 1( )
k
kU N
k i
k j i i kj j k i i
X
HX X L j n C
Hα α β
−
= ≠ =
=
+ +
+
∑ ∑
(17) 
由上式可以看出第一項是我們要求得的訊
號，而第二項是其他用戶對用戶 k 產生的
MAI，第三項是因雜訊干擾的雜訊項。以
下針對 MAI 和雜訊項和 SINR 來討論。 
 討論 MMSEC 的 MAI 項： 
可以發現，當 β 非常小的時候，
12
2
≈
+ βki
k
i
H
H
，則因為第一項要等於 kX ，
此時     。再觀察第二項，由於子載波正
交性的關係，則 MAI 項就等同於 Zero 
forcing，所以 MAI 項為 0；當 β 不可忽略
時，MAI 項就不能完全消除，但是因為  在
分母，所以可以把 MAI 項給壓低，雖然存       
在 MAI，不過 MAI 項是非常小的，所以當
使用者人數增加的時候，系統錯誤率只會
有些微的增加而已。 
 
 討論 MMSEC 的雜訊項： 
跟 Zero forcing 的雜訊項只受到通道增
益的線性反比相比，MMSEC 的雜訊項有被
抑制的效果，當通道增益很小時，分母數
值主要由 β 決定，不會像 Zero forcing 有雜
訊放大的影響。這種優點是 Zero forcing 所
沒有的。同樣的，當  非常小的時候，表
示當子載波上訊雜比很大，此時會跟 Zero 
forcing 的雜訊項相同，可以發現當 β 非常
小的時候，MMSEC 解調器等同於 Zero 
forcing，由此觀察可知 MMSEC 為 Zero 
forcing 的改良，但是由於 MMSEC 的複雜
度較高，必須要知道使用者人數，通道參
數，FFT 點數，雜訊能量，在以前的硬體
實作技術還不是很發達的時候，由於複雜
度的影響，雖然 MMSEC 有不錯的效能，
卻不能被廣泛的使用，不過現在因為 VLSI
技術的成熟，MMSEC 在 CDMA 的 SUD 的
應用也會越來越廣泛。 
 討論 MMSEC 的用戶訊號對干擾及雜
訊比(Signal to Interference and Noise 
Ratio ,簡稱 SINR) ： 
以用戶 k 來說，用戶 k 的 SINR 為接收
端解調出來後，把用戶 k 的訊號功率，除
以其他用戶產生的干擾和雜訊相加後的比
值。可以由上式中的第一項可得知  為用
戶展頻至子載波上的資料符元，而用戶 k
在一個子載波上的訊號功率    可以定義
如下： 
UkXXEkP kks ,,1,    }{)( …== ∗    (18) 
由 式 (17) 第 二 項 可 得 知 干 擾 項 為
( )∑
≠=
U
kjj
j jLX
,1
)(1
α
， 以 及 雜 訊 項 為
jP
2σ
ˆ
kX
Nα =
β
β
kX
( )sP k
9 
 
的位元錯誤率，所以我們將會限制無法達
到預期位元錯誤率的用戶傳送，直到該用
戶通道狀況許可再允許傳送。 
 
圖 4 系統設計簡介 
 
五、研究方法 
在基本 MC-CDMA 系統下，每一位用
戶會將資訊複製至所有子載波上傳送，若
無線通道為頻率選擇性衰減通道，則表示
每位用戶在每個子載波的通道增益衰減值
是不同的，為了讓用戶能利用衰減值較小
的通道傳送，我們使用了用戶分組的方法，
將系統的頻带劃分為多個群組；而在將所
有用戶分組後，會以最大化系統傳輸量為
前提，根據用戶的通道與群組內子載波的
雜訊狀況找出最合適的調變方式。 
圖 4 說明系統設計概念，在圖中我們
將系統可用的頻寬分為 4 個群組後，所有
用戶皆會被分配到自己效能較好的群組，
也就是說，在 G1~G4 群組裡的每位用戶都
是以自己通道增益較大的頻率範圍傳輸訊
號，但同一群組內的用戶間，雖然都是自
己本身通道增益較大的頻段，但彼此之間
的通道狀況也許差異很大，因此提出了適
應性調變機制，讓每位用戶可以依據本身
的通道狀況來改變所使用的調變。 
本計畫提出了一整套方案，包含一個
分群(grouping)的方法與分別在強制歸零檢
測法與最小均方錯誤組合法下的適應性調
變演算法。其中適應性調變演算法包含了
針對每個使用者 bit loading 的設定與功率
的分配。 
用戶分組演算法 
在用戶分組方面，首先基地台對所有
用戶做通道估測，因本計畫不討論通道估
測的誤差，所以假設通道估測是完美的。 
在基地台獲得所有用戶的通道資訊後，
分配用戶至適當的群組裡，而用戶分組有
許多的方法，本計畫是讓最差平均通道增
益的用戶先選，因為平均通道增益值較大
的用戶，在所有群組中都有不錯的效能，
所以讓通道狀況較差的用戶先做選擇，增
加用戶傳送成功的機會。若群組內的用戶
已滿載，那麼將用戶分配至通道增益次之
的群組，當所有用戶都分配至群組後，即
完成用戶分組的部份。 
以下將介紹本計畫中所提出的用戶分
組方法： 
1. 首先計算出矩陣  ，          為每
一個用戶在所有子載波上的平均增益
值，其中 2
,
1
N
u u j
j
m h N
=
= ∑ ，接著計算
出矩陣R，         
  
為用戶在每一
個 群 組 的 平 均 增 益 值 ， 其 中
2
, ,
 g u u jj gr h L∈= ∑ 。 
2. 找出平均衰減值最大的用戶   ：其中
{ }' arg min
U
u
u
u m
∈Θ
= ；接著找出用戶  通
道增益最大的群組 ：              ，
再將用戶 
  
分配至群組
  
。 
3. 將用戶
  
從   中移除，更新群組 
 
內
的用戶數目           。 
4. 若用戶都分配完畢，       ，則結束
用戶分組流程。 
5. 若         ，將群組   從   中移除，
執行步驟 2。 
在用戶分組之後，接著我們要把系統
總功率，分配給每個用戶，而同一群組內
用戶的通道增益差距會很大，所以群組內
( )1u Um ×=MM
'u
'u
'g { }
, '
' arg max
G
g u
g
g r
∈Θ
=
'u
'g'u
'g
UΘ
' '
1g gU U= +
=UΘ ∅
'gU U G= 'g  GΘ
11 
 
1
U
j
j
b
=
−∑ 加上限制條件一與拉格朗日乘數 α
相乘，而限制條件二則以       直接代入
式中。經過運算過後，可以得到每位用戶
的功率  
 
為： 
( ) ( )2 2
2 2
1
, ,
ln 0.2 ln 0.21
1.6 1.6
j
Uj ktotal
k
eff j eff k
P
P
U UH H
σ ε σ ε
=
=
+ − ∑
 
        
(28) 
上式表示第 j 個用戶的功率，當系統中
的用戶都以此式所得的功率傳送時，系統
將會達到最大的傳輸量。而要求用戶可傳
送的位元數時，但傳送的位元數必須為整
數，所以將式 (25) 加上地板函數 (floor 
function)成為下式： 
( )
2
,
2 2
1.6
log 1
ln 0.2
eff j j
j
j
H P
b
σ ε
  
  = −
  
  
    (29) 
令   為尚未分配的使用者所形成的
集合，而 A 為   的個數。接下來將說明適
應性調變機制的控制流程： 
1. 以式(28)求出在    裡所有用戶的功
率如下： 
( )
( )
2
2
,
2
2k
,
ln 0.2
1.6
ln 0.21
          
1.6A
j total
j
eff j
k
A
eff k
PP
AH
j
A H
σ ε
σ ε
∈Θ
= + −
∈Θ∑    
(30)  
2. 以上式的結果找出分配到最小功率的
用戶 j’，其功率為  ：          ，再
以算出用戶 j’可以傳送的位元數   。 
3. 若              ，則將用戶 j’從
  
中
移除，接著回到步驟 1 再重新計算
  
裡
剩下用戶的功率；其他則執行步驟 4。
若用戶無法達到要求，則該次就不傳
送，直到通道狀況符合再做傳送。 
4. 到此表示   裡的用戶都可以傳送，因
此我們算出   裡用戶可傳送的位元
數，而用戶 j’使用的調變模式則為
QAM-2 'jb 。 
 
這一個演算法有一個先天上的問題，
因為採用拉格朗日乘數法，需要依據公式
(25)得到分配位元數與功率間的關係式，但
是根據我們實驗的結果，這個關係在位元
數是 2,4,16,64 是準確的，然而在 8,32 卻是
不準的，因此會有一些資源上浪費的情況
發生。 
 
最 小 均 方 錯 誤 組 合 (Minimum Mean 
Square Error Combining, MMSEC) 下的
適應性調變演算法： 
因為在 MMSE 下，會有 MAI 的問題，
因此我們採取迭代的方式來逼近最佳的適
應性調變，演算法的概念參考於文獻[15]
中的 SF-IBDP 演算法： 
首先定義參數如下： 
U：系統用戶個數。 
m：迭代的次數。 
  
：第 m 次迭代時，第 j 個用戶的傳
送功率。 
     ：第 m 次迭代時，第 j 個用戶的
SINR。 
Q：用戶所需要的 SINR。 
一開始設定用戶的Q 和初始功率      ，
接著算出      ，再來調整用戶迭代的功
率。而迭代後的功率    ，假如尚未收歛，
便要去計算       ，讓用戶功率經過不斷
的迭代縮小，直到收斂。收斂時用戶所算
出的 SINR 會等同於Q，而用戶的功率就能
被調整為Q所需的功率。 
m
j
m
jm
j
m
j SINR
QSINR
PP
),min(1
=
+
       (31) 
因為適應性調變的部份是因為每個用
戶的通道都不相同，為了讓傳輸量最大化，
j jε ε=
jP
AΘ
AΘ
AΘ
'jP { }' minAj jjP P∈Θ=
'jb
' '
0 or 1j jP b<= < AΘ
AΘ
AΘ
AΘ
m
jP
m
jSINR
0
jP N=
0
jSINR
1m
jP
+
1m
jSINR
+
13 
 








=







=
−
n
erfcerfcP avPAM 14
3
54
3
4
γ
  (36) 
其中 n為雜訊功率。所以 8-QAM 的位
元錯誤率      可表示為： 
( )( )





 −−−
=
b
PPP QAM 428
111
      (37) 
因為 8-QAM 的平均功率為 6，而我們
要找的 SINR_bound (8)= 6/ n。我們經由不
斷的迭代找適當的 n 使            。我
們可以發現當 SINR_bound (8)=27.7，此時
可得            。所以我們取 8-QAM 的
SINR_bound(8)=27.7。 
討論當 M 可以開根號，如 M=4,16,64
時對應的 SINR_bound(M)，其 M-QAM 的位
元錯誤率       ，可經由 PAM 來計算，
只是 X 軸與 Y 軸所拆的 PAM 是相同的，
我們把其寫成： 
( )( )
b
P
P MQAMM
211 −−
=
−
         (38) 
相同的，我們為了讓             ，經過
不斷的迭代 SINR_bound(M)值，可以找到
SINR_bound(4)=9.5 ，
SINR_bound(16)=45.15 ，
SINR_bound(64)=179.7。 
而當 M=32 時，雖然 32 不能開根號，
但是經過模擬測試，其位元錯誤率也可以
使用式(38)來求得，其產生的誤差在可以接
受的範圍之內。利用同樣的方式逼近，我
們可以找到 SINR_bound(32)=90.8。 
以上利用迭代法來逼近 SINR_bound
的做法可以事先利用電腦計算出來，存成
一個表格，在執行SF-IBDP演算法中使用。
下表 1 列出當目標錯誤率為 0.01，0.001，
0.0001 時分別對應的 SINR_bound(M)。 
 
 
 
 BER=0.01 BER=0.001 BER=0.0001 
SINR_bound(2) 2.71 4.75 6.92 
SINR_bound(4) 5.43 9.56 13.84 
SINR_bound(8) 15.3 27.7 40.5 
SINR_bound(16) 24.6 45.15 66.48 
SINR_bound(32) 48.5 90.8 135 
SINR_bound(64) 94.1 179.7 269.4 
表 1 不同位元錯誤率下對應的 SINR_bound 
 
本計畫所使用的功率控制和適應性調
變機制。 
首先定義參數如下： 
 N：子載波總數。 
 U：總用戶個數。 
 
m：表示迭代的次數。 
    ：第 m 次迭代後的用戶 j 功率。 
 )( jb ：表示用戶 j 所使用調變可傳送的
位元數。 
 )( jB ：表示用戶 j 所使用 M-QAM 調
變，    = )(2 jb 。 
))((_ jBboundSINR ：要使用 )( jB 所需
要基本 SINR。 
 
      
：第m次迭代後用戶 j的 SINR。 
T ：功率收斂值。 
   ：系統目標 BER。 
     ：系統總功率。 
功率控制主要的目的是用戶的 SINR 在
不斷的迭代之後，可以等同於使用該調變的
所需的基本 SINR，而從用戶功率迭代公式
(39)可發現，若如果用戶目前的      小
於                ，則用戶的功率就沒有
改變，也表示此用戶不適合使用此調變模式；
但如果用戶的       >                ，
則用戶的功率會因為公式而不斷的縮小，直
8QAMP
8 0.001QAMP =
8 0.001QAMP =
M QAMP −
0.001M QAMP − =
m
jP
( )B j
m
jSINR
ε
systemP
m
jSINR
_ ( ( ))SINR bound B j
m
jSINR _ ( ( ))SINR bound B j
15 
 
 
圖 7 參考文獻[16]中不同解調器的錯誤率
比較圖 
 
圖 8 本計畫使用 ZF 與 MMSEC 的錯誤率
比較圖 
 
圖 9 和圖 10 是本計畫提出的方法和用
戶不分組與用戶隨機分組的系統效能比較
圖，其中 BPS 為 bytes per symbol，用來表
示 spectrum 的使用效率。這三種分組方式
都是使用同一套功率控制與可適性調變演
算法，主要是討論不同分組模式的差異性。
可以發現三種方法都滿足目標錯誤率，而
本計畫提出的方法有比較好的傳輸量。而
隨機分組與本計畫的方法比較起來，因為
用戶沒有選擇對自己而言，分配到有最大
群組平均通道增益的群組裡，因此會浪費
了一些系統的傳輸量。而隨機分組的效能
又比沒有分組的方法好，可以從圖中看出
用戶分組的優點。 
 
圖 9 不同分組方式之位元錯誤率比較   
 
圖 10 不同分組方式之位元傳輸量比較 
 
 
圖 11 和圖 12 為本計畫提出機制與
BPSK 以及 64-QAM 的效能比較圖，BPSK
與 64-QAM 為 MC-CDMA 在尚未分組的架
構下，以固定調變方式傳送，由圖中可觀
察出以 BPSK 調變方式雖然可以降低系統
的位元錯誤率，但系統傳輸量會較小；而
64-QAM 則為相反的狀況，雖然有較大的系
統傳輸量，但位元錯誤率卻相當的大。相
較之下，本計畫所提出的用戶分組與適應
性調變，可讓系統位元錯誤率維持在用戶
所要求的門檻之下，同時調變模式也可以
根據用戶的通道狀況改變，讓系統能有最 
大的傳輸量。
17 
 
統能在有限的傳輸功率下做最大化的傳輸，
同時滿足用戶的位元錯誤率 
 
七、計畫成果自評 
本計畫所完成之研究內容與原計畫在
理論與模擬方面相同，完成的內容包含： 
1. 分組 MC-CDMA 的架構。 
2. 使用者之分組方法。 
3. 適應性調變與功率分配之演算法。 
4. 軟體模擬平台。 
5. 實驗與結果分析。 
現今的通訊系統都非常地複雜，除了
通訊技術的進步之外，在多使用者的系統
當中，有效地分配資源也是另一個提升系
統效能的重要技術，本計畫利用分組加上
適應性調變，將可以有效的利用每個子通
道，進而提升頻譜的使用效率。 
目前本計畫已經發表了一篇關於 Zero 
forcing 的適應性調變機制於 2010 IEEE 
TENCON[18]，附於報告的最後，而增加一
些資料的期刊版本也即將完成。未來將繼
續把 MMSE 的方面的研究成果發表，預計
也可以產出一篇會議與一篇期刊論文。 
 
八、參考文獻 
[1] N. Yee, J. P. Linnartz and G. Fettweis, 
“Multi-Carrier CDMA in Indoor 
Wireless Radio Networks,” Proceedings 
PIMRC ’93, Yokohama, pp. 109-113, 
Japan, 1993. 
[2] A. Chouly, A. Brajal, and S. Jourdan, 
“Orthogonal multicarrier techniques 
applied to direct sequence spread 
spectrum CDMA systems,” in Proc. 
IEEE GLOBECOM’93, NOV. 1993, pp. 
1723-1728. 
[3] Stefan Kaiser, Multi-Carrier CDMA 
Mobile Radio Systems – Analysis and 
Optimization of Detection, Decoding, 
and Channel Estimation, 1998. 
[4] X. Cai, S. Zhou, and G.B. Giannakis, 
“Group-orthogonal multicarrier CDMA,” 
IEEE Trans. Commun., vol. 52, no. 1, pp. 
90–99, Jan. 2004. 
[5] J. Huang and Z. Niu, “A Fairness-based 
and Adaptive User Grouping and 
Subcarrier Allocation Algorithm for 
Grouped MC-CDMA Systems,” IEEE 
GLOBECOM '06, pp. 1-5, Dec. 2006. 
[6] Y. Wang, G. Xie, Y. Liu and N. Li, 
“Feasible resource allocation with 
partial channel information for grouped 
MC-CDMA systems,” ISCIT '07. 
International Symposium on 
Communications and Information 
Technologies, pp. 683-688, Oct. 2007. 
[7] Y. Wang, J. Shen, P. Zhang, S. Liu and Y. 
Liu, “Optimized Power Control and 
Resource Allocation in Grouped 
MC-CDMA Systems,” in Proc. ICC '08, 
pp. 4785-4789, May 2008. 
[8] X. Cai, S. Zhou, and G.B. Giannakis, 
“Group orthogonal multicarrier CDMA,” 
IEEE Trans. Commun., vol. 52, no. 1, pp. 
90–99, Jan. 2004. 
[9] C. Li, X. Wang, “Adaptive subchannel 
allocation in multiuser MC-CDMA 
systems,” in Proc. GLOBECOM’04, 
Volume 4, pp. 2503 – 2507, Dec. 2004. 
[10] M. Tabulo, D. Laurenson, S. 
McLaughlin, E. Al-Susa, “A Linear 
Programming Algorithm for a Grouped 
MC-CDMA system,” in Proc. The IEEE 
Vehicular Technology Conference, pp. 
1463-1467,Oct. 2003. 
[11] Y. Wang, P. Zhang, Y. Liu and Ju. Liu, 
“A Novel Criterion of Subcarrier 
Allocation for Grouped MC-CDMA 
User Grouping and Adaptive Modulation for 
Downlink MC-CDMA Systems 
Chun-Chieh Lu, Guan-Yi Shen 
Graduate Institute of Communication Engineering 
National Chi Nan University 
Puli, Nan-Tou, Taiwan 
{s97325901, s96325522}@ncnu.edu.tw 
Yaw-Wen Kuo 
Department of Electrical Engineering 
National Chi Nan University 
Puli, Nan-Tou, Taiwan 
ywkuo@ncnu.edu.tw
 
Abstract—In this paper, we propose the user grouping and 
adaptive modulation algorithms for downlink Multi-Carrier 
Code Division Multiple Access (MC-CDMA) systems. Under a 
frequency-selective fading channel, we adaptively assign users 
into groups by their channel state information (CSI) such that 
spectrum efficiency is improved and BER is reduced. After 
grouping, we assign bit loading and allocate transmission power 
for each user according to its effective channel response. Our 
scheme aims at maximizing total system data rate under both the 
total power and the BER bound constraints. Simulation results 
show that our scheme outperforms at bit error rate and data rate. 
Keywords - MC-CDMA, user grouping, adaptive modulation 
I.  INTRODUCTION 
Recently, Multi-carrier Code Division Multiple Access 
(MC-CDMA) systems have been considered as potential 
candidate for next generation (4G) technology. As described 
in literature [1], there are multiple types of combining the 
OFDM with CDMA concepts. In MC-CDMA, data symbols 
are spread by orthogonal codes (e.g. Walsh codes) and 
mapped into the subcarriers. Spreading in frequency domain 
can achieve frequency diversity and multiple access operation 
in the system; these can combat with frequency selective 
fading channel and increase spectrum efficiency. In fact, 
OFDM can be seen as a special case of MC-CDMA with 
spreading code length is equal to one. 
In the literature, many papers studied grouped MC-CDMA 
[2]–[9] to improve performance under frequency selective 
channel, where users are adaptively grouped and only use part 
of subcarriers. The basic idea of user grouping is simple. By 
carefully allocating users to the group with good channel 
quality, we can have higher throughput. Moreover, the 
processing complexity can also be reduced because data of 
one user is only spreaded among part of subcarriers. Many 
papers about MC-CDMA [2]–[4] assumed the same 
modulation, but in principle, a MC-CDMA system can 
allocate resource (i.e. subcarriers, modulation, and power) 
according to the channel state information (CSI) such that the 
overall data rate is maximized and BER requirement is 
guaranteed. The authors in [5]–[7] focused on the theoretical 
analysis according to Shannon’s capacity. In practice, a 
system can only operate at a fixed set of modulations and the 
performance depends on the design of receiver. Therefore, the 
results may not be suitable for real systems. Tang and 
Stolpman [8] proposed two adaptive modulation schemes 
which are based on an equivalent channel concept. In order to 
improve data rate for frequency selective channels, the authors 
divide subcarriers groups which can be considered as logical 
channels. A user can use all groups and the modulation for 
each group is determined by optimization. If a user has bad 
channel quality in some groups, they cannot be used, resulting 
in inefficiency. 
In this paper, we propose the user grouping and adaptive 
modulation algorithms to improve the system performance for 
downlink MC-CDMA systems. We first divide subcarriers 
into several groups, and each user can be allocated to only one 
group instead of all groups as in [8]. Though the shared data 
rate per user decreases, the number of users and the overall bit 
rate increase due to multiuser gain. The proposed user 
grouping algorithm can allocate users into a proper group 
based on the channel quality. Then, we compute the 
transmission power and the modulation scheme according 
their CSI and the given BER bound. The power allocation is 
also different from reference [8] where each user has the same 
power. Our scheme can optimize the power for each user and 
the system capacity can be improved. 
The rest of this paper is organized as follows. In Section II, 
we present our system model and describe the instantaneous 
SNR of each user. Section III develops the user grouping and 
the adaptive modulation scheme. Section IV presents 
simulation results and discusses the performance of the 
proposed scheme. Finally, conclusions and future work are 
given in Section V. 
II. SYSTEM DESCRIPTION 
Our system model is as shown in Fig. 1 for a multiuser 
downlink grouped MC-CDMA system. There are totally U 
users and N subcarriers, and the N subcarriers are divided into 
G groups. Each active user transmits only one symbol over L 
=N/G subcarriers, where L is also the spreading factor of codes. 
Let dj be the data from jth user, which will be allocated to a 
suitable group by the user grouping algorithm. After user 
grouping, the adaptive modulation scheme will calculate each 
user’s bit loading and transmitted power by its CSI and BER 
bound.  Each user chooses its spreading code and  data  symbol 
This work was supported in part by the National Science Council, Taiwan,  
under grant NSC 98 -2221-E-260-008. 
 
 
978-1-4244-6890-4/10$26.00 ©2010 IEEE TENCON 2010
 
 852
CDMA system by a simple M-QAM system over a channel 
with response keffH  as shown in Fig. 3. Let us examine 
equation (6). The first term is the SNR at the transmitter, and 
the second term can be considered as the loss of an effective 
channel. Therefore, the effective channel response, denoted by 
k
effH , is set as follows, 
2
2
1
.
1
k
eff L
k
i
i
L
H
H


                                                              (7) 
 Seong et al. [9] derived the BER approximation formula for 
M-QAM communication systems. We directly apply the result 
and get the BER of jth user as follows, 
 
 
2
2
1.6
0.2exp ,
2 1
eff
j
k
j b
H P


     
 
                                             (8) 
where j  denotes the BER and jb  is the number of bits for 
the jth user. We have performed a dedicated simulation test for 
this approximation. The result shows that this model is 
effective, but it is not included in this paper due to space 
limitation. 
III. USER GROUPING AND ADAPTIVE MODULATION 
In this section, the user grouping and adaptive modulation 
schemes are presented. The N subcarriers are divided into G 
groups with equal size. Each user will be assigned to a suitable 
group according to its effective channel response. After that, 
we calculate the bit loading for each user and the 
corresponding power to meet the BER requirement.  
A. User grouping 
The basic idea is to assign the user with deep fading first 
because it is easier to find a suitable group for the users with 
good average channel. Therefore, the spectrum efficiency can 
be improved.  
Let U  be the set of unassigned users and G  be the set of 
groups not fully filled. Let  1, GU UgU   be the set of the 
number of users in each group. The channel fading on the ith 
subcarrier for jth user is jiH . Let  1j Um m  be a vector 
representing the effective channel response for user j over all 
subcarriers, and
2
1
1j N
j
i
i
N
m
H


. Let  ,g j G Ur R  be a matrix 
where element ,g jr  representing the effective channel response 
for user j at group g and is equal to 
2group 
1
i g j
i
L
H

. The detail 
user grouping algorithm is as follows. 
 
STEP 1:  For each user, calculate vector m and matrix R. 
STEP 2: Find the user j’ that has the smallest average 
channel gain and  ' arg min
U
j
j
j m

 . Then, find the 
group 'g  that user 'j  has the best channel 
response and  , '' arg max
G
g j
g
g r

 . Assign user 'j  
to group 'g . 
STEP 3: Remove user 'j  from U , and ' ' 1g gU U  . If 
group 'g  is full, remove group 'g  from the set 
G . 
STEP 4: If =U  , end the algorithm; otherwise, go to step 
2. 
 
B. Adaptive modulation scheme 
For frequency selective fading channel, the BER will be 
high if high order modulation is used when the channel is in 
bad condition. Conversely, if low order modulation is used 
when the channel is in good condition, it wastes system 
resource. In order to solve this problem, adaptive modulation 
was proposed and has been studied in [9]-[10]. Adaptive 
modulation uses the instantaneous channel information to 
adjust power and constellation size to satisfy user’s 
requirement. In order to improve the spectrum efficiency, 
adaptive modulation is used in the MC-CDMA system. After 
rearranging equation (8), we can have the bit loading given the 
BER as 
 
2
2 2
1.6
log 1 ,  for 0.2.
ln 0.2
j
eff j
j j
j
H P
b 
 
 
   
 
 
                    (9) 
Let totalP  and jP  be the total available power and the 
power allocated to user j, respectively. The optimization 
problem can be stated as, 
1
U
j=1
minimize 
subject to 0
                0  for 1,2, , ,
U
j
j
j total
j j
b
P P
j U 


 
  



                          (10) 
where j  and j  is the BER and BER bound respectively. 
We can use Lagrange multipliers to find the solution of this 
problem as follows, 
   2 2
2 2
1
ln 0.2 ln 0.21
.
1.6 1.6
U
j ktotal
j
j k
k
eff eff
P
P
U UH H
   

               (11) 
After jP  is solved, we can get the maximum number of bit 
loading for user j by substituting equation (11) into equation 
(9) with a floor function. 
 
2
2 2
1.6
log 1 .
ln 0.2
j
eff j
j
j
H P
b
 
  
   
  
  
                                     (12) 
In case that some users have deep fading on all groups, we 
probably get negative or small values from equation (11). If it 
 854
0 5 10 15 20 25 30
0
50
100
150
200
250
300
SNR (dB)
B
P
S
 
 
proposed scheme
reference scheme
 
Fig. 7 BPS performance compared to reference scheme 
 
0 5 10 15 20 25 30
10
-6
10
-5
10
-4
10
-3
SNR (dB)
B
it 
E
rr
or
 R
at
e
 
 
Mod A
Mod B
Mod C
Mod D
 
Fig. 8 BER performance for different profile 
 
 
Fig. 6 and 7 show the BER and BPS respectively. Both 
schemes use adaptive modulation. We can see that our scheme 
can provide more BPS with less BER. The proposed scheme 
can assign optimal power for each user after grouping, but the 
power for each user is the same in [8]. Therefore, there is about 
20% improvement in BPS by our scheme.  
In the last experiment, we use different profiles to evaluate 
the performance and the results are plotted in Fig. 8 and 9. If a 
system cannot support high constellation such as profiles A and 
B, the BPS will saturate for high SNR and the BER is far away 
from the BER bound. Moreover, if a system has fine 
granularity in constellation, it can have high BPS with BER 
close to the BER bound such as profile B or D compared to 
profile A or C in the middle range of SNR. The results of this 
experiment show that the performance depends on the 
capability of a system. Theoretical analysis based on 
Shannon’s capacity cannot provide this kind of information.  
 
0 5 10 15 20 25 30
0
50
100
150
200
250
300
350
400
SNR (dB)
B
P
S
 
 
Mod A
Mod B
Mod C
Mod D
 
Fig.9 BPS performance for different profile 
 
V. CONCLUSION 
This paper proposed the user grouping and adaptive 
modulation algorithms for multi-user downlink MC-CDMA 
systems. Given the BER bound and the channel condition for 
each user, we adaptively assign users into groups and allocate 
power and modulation. Simulation results show that our 
scheme can have high spectrum efficiency with guaranteed 
BER. Simulation results have shown our proposed scheme 
outperforms both fixed modulation and reference scheme. In 
the future, we will study the system with other types of 
receiver. Moreover, the resource allocation issue in the uplink 
is also an interesting topic.  
REFERENCES 
[1] S. Hara and R. Prasad, “Overview of multicarrier CDMA,” IEEE 
Commun. Mag., vol. 35, pp. 126–133, Dec. 1997. 
[2] X. Cai, S. Zhou, and G.B. Giannakis, “Group-orthogonal multicarrier 
CDMA,” IEEE Trans. Commun., vol. 52, no. 1, pp. 90–99, Jan. 2004. 
[3] Yachen Wang, Gang Xie, Yuan'an Liu and Na Li, “Feasible resource 
allocation with partial channel information for grouped MC-CDMA 
systems”, in Proc. IEEE ISCIT,  pp. 683-688, Oct. 2007. 
[4] M. Tabulo, D. Laurenson, S.McLaughlin, E. Al-Susa, “A Linear 
Programming Algorithm for a Grouped MC-CDMA system”, in Proc. 
IEEE VTC, pp. 1463-1467, Oct. 2003. 
[5] Jinri Huang and Zhisheng Niu, “A Fairness-based and Adaptive User 
Grouping and Subcarrier Allocation Algorithm for Grouped MC-CDMA 
Systems”, in Proc. IEEE GLOBECOM, pp. 1-5, Dec. 2006. 
[6] Yachen Wang, Junyang Shen, Peng Zhang,Siyang Liu and Yuan'an Liu, 
“Optimized Power Control and Resource Allocation in Grouped MC-
CDMA Systems”, in Proc. ICC, pp. 4785-4789, May 2008. 
[7] Yachen Wang, Peng Zhang, Yuan'an Liu and Junshi Liu, “A Novel 
Criterion of Subcarrier Allocation for Grouped MC-CDMA Systems”, in 
Proc. CHINACOM , pp. 1090-1095, Aug. 2007. 
[8] C. Tang and V. J. Stolpman, “Multiple users adaptive modulation 
schemes for MC-CDMA”, in Proc. IEEE GLOBECOM, pp. 3823–3827, 
Dec. 2004. 
[9] Seong Taek Chung, and A. J. Goldsmith, “Degrees of freedom in 
adaptive modulation: a unified view,” IEEE Transactions on 
Communication, vol. 49, pp. 1561-1571, Sep 2001. 
[10] A. J. Goldsmith, and S. Chua, “Variable-rate variable-power MQAM for 
fading channels,” IEEE Transactions on Communication, vol. 45, pp. 
1218-1230, October 1997. 
 856
 2
 
November 21 (sun) November 22 (mon) November 23 (tue) November 24 (wed) 
14:00 - 
17:30 
Tutorials 08:30 Registration                        
9:00 - 
10:20 
Technical Sessions                 
9:00 - 
10:40 
Technical Sessions       
  
9:00 - 
10:30 
Plenary 
Session:Opening 
& Keynote I  
10:20 - 
11:20 
Coffee Break &   
Poster Session II  
10:40 - 
11:10 
Coffee Break                        
  
10:30 - 
11:00 
Coffee Break                        
11:20 - 
12:40 
Technical Sessions    
11:10 - 
12:30 
Technical Sessions                  
  
11:00 - 
12:00 
Technical 
Sessions                  
12:40 - 
14:10
Lunch Break                        
12:30 - 
14:00 
Lunch Break                         
  
12:00 - 
13:30 
Lunch Break        
14:10 - 
15:50 
Technical Sessions                 
14:00 - 
15:30 
Plenary 
Session:Keynote II & 
Closing 
  
13:30 - 
15:10 
Technical 
Sessions                  
15:50 - 
16:20
Coffee Break                       
15:30 - 
18:00 
Optional Excursion:                 
  
15:10 - 
16:10 
Coffee Break & 
Poster Session I     
16:20 - 
18:20 
Technical Sessions                 
  
  
16:10 - 
17:50 
Technical 
Sessions                      
  
18:30 - 
20:30 
Banquet                             
    
 
主要的行程如下:  
11 月 21 日: 
   中午: 約中午 12:00 由埔里出發，乘高鐵搭 17:35 班機出國。 
   晚上午: 夜宿福岡市。 
11 月 22 日: 
   全天: 報到並參加會議。 
11 月 23 日: 
   上午: 參加會議。 
 4
路相關方面，印象最深刻的有兩個方面，第一個是無線網路相關的論文，包含實體
層的問題如功率控制或是 MIMO，媒體存取層的排程問題，與通道編碼的問題等等，
在未來的系統中，每一層將不會是單獨設計，必許考量到層與層之間的關係，這些
論文讓我有些新的想法，對於本計畫的執行很有幫助。第二個是感測網路方面，它
是一個螞蟻大軍似的網路，透過小通訊節點的互相幫忙而形成一個大網路，通常運
用於感測特定的訊號，不過電力與有效的路由傳輸都是挑戰，在本會議中有兩個
session 關於這個議題，探討了路由、電力控制、定位、分組等等的問題，這些相關
的論文對下年度提新的計畫很有助益。 
三、考察參觀活動(無是項活動者略) 
    無 
四、建議 
可以直接與國外學者討論是一個很難得的經驗，本人非常感謝國科會可以
提供補助參與國際活動，也深切盼望未來國科會可以持續補助，讓國內的研究
人員可以有更開闊的視野。比較遺憾的部份是博士班研究生沒有申請到補助經
費，必須利用實驗室經費方能成行，因此也期望國科會可以多編列博士班學生
的出國經費，相信對於學生們會有很大的幫助。 
五、攜回資料名稱及內容 
共攜回會議論文一份，光碟片。 
六、其他: 報告之 Session 時間表、論文全文、照片剪影 
 6
 
Poster Sessions 
 
晚宴現場 
User Grouping and Adaptive Modulation for 
Downlink MC-CDMA Systems 
Chun-Chieh Lu, Guan-Yi Shen 
Graduate Institute of Communication Engineering 
National Chi Nan University 
Puli, Nan-Tou, Taiwan 
{s97325901, s96325522}@ncnu.edu.tw 
Yaw-Wen Kuo 
Department of Electrical Engineering 
National Chi Nan University 
Puli, Nan-Tou, Taiwan 
ywkuo@ncnu.edu.tw
 
Abstract—In this paper, we propose the user grouping and 
adaptive modulation algorithms for downlink Multi-Carrier 
Code Division Multiple Access (MC-CDMA) systems. Under a 
frequency-selective fading channel, we adaptively assign users 
into groups by their channel state information (CSI) such that 
spectrum efficiency is improved and BER is reduced. After 
grouping, we assign bit loading and allocate transmission power 
for each user according to its effective channel response. Our 
scheme aims at maximizing total system data rate under both the 
total power and the BER bound constraints. Simulation results 
show that our scheme outperforms at bit error rate and data rate. 
Keywords - MC-CDMA, user grouping, adaptive modulation 
I.  INTRODUCTION 
Recently, Multi-carrier Code Division Multiple Access 
(MC-CDMA) systems have been considered as potential 
candidate for next generation (4G) technology. As described 
in literature [1], there are multiple types of combining the 
OFDM with CDMA concepts. In MC-CDMA, data symbols 
are spread by orthogonal codes (e.g. Walsh codes) and 
mapped into the subcarriers. Spreading in frequency domain 
can achieve frequency diversity and multiple access operation 
in the system; these can combat with frequency selective 
fading channel and increase spectrum efficiency. In fact, 
OFDM can be seen as a special case of MC-CDMA with 
spreading code length is equal to one. 
In the literature, many papers studied grouped MC-CDMA 
[2]–[9] to improve performance under frequency selective 
channel, where users are adaptively grouped and only use part 
of subcarriers. The basic idea of user grouping is simple. By 
carefully allocating users to the group with good channel 
quality, we can have higher throughput. Moreover, the 
processing complexity can also be reduced because data of 
one user is only spreaded among part of subcarriers. Many 
papers about MC-CDMA [2]–[4] assumed the same 
modulation, but in principle, a MC-CDMA system can 
allocate resource (i.e. subcarriers, modulation, and power) 
according to the channel state information (CSI) such that the 
overall data rate is maximized and BER requirement is 
guaranteed. The authors in [5]–[7] focused on the theoretical 
analysis according to Shannon’s capacity. In practice, a 
system can only operate at a fixed set of modulations and the 
performance depends on the design of receiver. Therefore, the 
results may not be suitable for real systems. Tang and 
Stolpman [8] proposed two adaptive modulation schemes 
which are based on an equivalent channel concept. In order to 
improve data rate for frequency selective channels, the authors 
divide subcarriers groups which can be considered as logical 
channels. A user can use all groups and the modulation for 
each group is determined by optimization. If a user has bad 
channel quality in some groups, they cannot be used, resulting 
in inefficiency. 
In this paper, we propose the user grouping and adaptive 
modulation algorithms to improve the system performance for 
downlink MC-CDMA systems. We first divide subcarriers 
into several groups, and each user can be allocated to only one 
group instead of all groups as in [8]. Though the shared data 
rate per user decreases, the number of users and the overall bit 
rate increase due to multiuser gain. The proposed user 
grouping algorithm can allocate users into a proper group 
based on the channel quality. Then, we compute the 
transmission power and the modulation scheme according 
their CSI and the given BER bound. The power allocation is 
also different from reference [8] where each user has the same 
power. Our scheme can optimize the power for each user and 
the system capacity can be improved. 
The rest of this paper is organized as follows. In Section II, 
we present our system model and describe the instantaneous 
SNR of each user. Section III develops the user grouping and 
the adaptive modulation scheme. Section IV presents 
simulation results and discusses the performance of the 
proposed scheme. Finally, conclusions and future work are 
given in Section V. 
II. SYSTEM DESCRIPTION 
Our system model is as shown in Fig. 1 for a multiuser 
downlink grouped MC-CDMA system. There are totally U 
users and N subcarriers, and the N subcarriers are divided into 
G groups. Each active user transmits only one symbol over L 
=N/G subcarriers, where L is also the spreading factor of codes. 
Let dj be the data from jth user, which will be allocated to a 
suitable group by the user grouping algorithm. After user 
grouping, the adaptive modulation scheme will calculate each 
user’s bit loading and transmitted power by its CSI and BER 
bound.  Each user chooses its spreading code and  data  symbol 
This work was supported in part by the National Science Council, Taiwan,  
under grant NSC 98 -2221-E-260-008. 
 
 
978-1-4244-6890-4/10$26.00 ©2010 IEEE TENCON 2010
 
 852
CDMA system by a simple M-QAM system over a channel 
with response keffH  as shown in Fig. 3. Let us examine 
equation (6). The first term is the SNR at the transmitter, and 
the second term can be considered as the loss of an effective 
channel. Therefore, the effective channel response, denoted by 
k
effH , is set as follows, 
2
2
1
.
1
k
eff L
k
i
i
L
H
H


                                                              (7) 
 Seong et al. [9] derived the BER approximation formula for 
M-QAM communication systems. We directly apply the result 
and get the BER of jth user as follows, 
 
 
2
2
1.6
0.2exp ,
2 1
eff
j
k
j b
H P


     
 
                                             (8) 
where j  denotes the BER and jb  is the number of bits for 
the jth user. We have performed a dedicated simulation test for 
this approximation. The result shows that this model is 
effective, but it is not included in this paper due to space 
limitation. 
III. USER GROUPING AND ADAPTIVE MODULATION 
In this section, the user grouping and adaptive modulation 
schemes are presented. The N subcarriers are divided into G 
groups with equal size. Each user will be assigned to a suitable 
group according to its effective channel response. After that, 
we calculate the bit loading for each user and the 
corresponding power to meet the BER requirement.  
A. User grouping 
The basic idea is to assign the user with deep fading first 
because it is easier to find a suitable group for the users with 
good average channel. Therefore, the spectrum efficiency can 
be improved.  
Let U  be the set of unassigned users and G  be the set of 
groups not fully filled. Let  1, GU UgU   be the set of the 
number of users in each group. The channel fading on the ith 
subcarrier for jth user is jiH . Let  1j Um m  be a vector 
representing the effective channel response for user j over all 
subcarriers, and
2
1
1j N
j
i
i
N
m
H


. Let  ,g j G Ur R  be a matrix 
where element ,g jr  representing the effective channel response 
for user j at group g and is equal to 
2group 
1
i g j
i
L
H

. The detail 
user grouping algorithm is as follows. 
 
STEP 1:  For each user, calculate vector m and matrix R. 
STEP 2: Find the user j’ that has the smallest average 
channel gain and  ' arg min
U
j
j
j m

 . Then, find the 
group 'g  that user 'j  has the best channel 
response and  , '' arg max
G
g j
g
g r

 . Assign user 'j  
to group 'g . 
STEP 3: Remove user 'j  from U , and ' ' 1g gU U  . If 
group 'g  is full, remove group 'g  from the set 
G . 
STEP 4: If =U  , end the algorithm; otherwise, go to step 
2. 
 
B. Adaptive modulation scheme 
For frequency selective fading channel, the BER will be 
high if high order modulation is used when the channel is in 
bad condition. Conversely, if low order modulation is used 
when the channel is in good condition, it wastes system 
resource. In order to solve this problem, adaptive modulation 
was proposed and has been studied in [9]-[10]. Adaptive 
modulation uses the instantaneous channel information to 
adjust power and constellation size to satisfy user’s 
requirement. In order to improve the spectrum efficiency, 
adaptive modulation is used in the MC-CDMA system. After 
rearranging equation (8), we can have the bit loading given the 
BER as 
 
2
2 2
1.6
log 1 ,  for 0.2.
ln 0.2
j
eff j
j j
j
H P
b 
 
 
   
 
 
                    (9) 
Let totalP  and jP  be the total available power and the 
power allocated to user j, respectively. The optimization 
problem can be stated as, 
1
U
j=1
minimize 
subject to 0
                0  for 1,2, , ,
U
j
j
j total
j j
b
P P
j U 


 
  



                          (10) 
where j  and j  is the BER and BER bound respectively. 
We can use Lagrange multipliers to find the solution of this 
problem as follows, 
   2 2
2 2
1
ln 0.2 ln 0.21
.
1.6 1.6
U
j ktotal
j
j k
k
eff eff
P
P
U UH H
   

               (11) 
After jP  is solved, we can get the maximum number of bit 
loading for user j by substituting equation (11) into equation 
(9) with a floor function. 
 
2
2 2
1.6
log 1 .
ln 0.2
j
eff j
j
j
H P
b
 
  
   
  
  
                                     (12) 
In case that some users have deep fading on all groups, we 
probably get negative or small values from equation (11). If it 
 854
0 5 10 15 20 25 30
0
50
100
150
200
250
300
SNR (dB)
B
P
S
 
 
proposed scheme
reference scheme
 
Fig. 7 BPS performance compared to reference scheme 
 
0 5 10 15 20 25 30
10
-6
10
-5
10
-4
10
-3
SNR (dB)
B
it 
E
rr
or
 R
at
e
 
 
Mod A
Mod B
Mod C
Mod D
 
Fig. 8 BER performance for different profile 
 
 
Fig. 6 and 7 show the BER and BPS respectively. Both 
schemes use adaptive modulation. We can see that our scheme 
can provide more BPS with less BER. The proposed scheme 
can assign optimal power for each user after grouping, but the 
power for each user is the same in [8]. Therefore, there is about 
20% improvement in BPS by our scheme.  
In the last experiment, we use different profiles to evaluate 
the performance and the results are plotted in Fig. 8 and 9. If a 
system cannot support high constellation such as profiles A and 
B, the BPS will saturate for high SNR and the BER is far away 
from the BER bound. Moreover, if a system has fine 
granularity in constellation, it can have high BPS with BER 
close to the BER bound such as profile B or D compared to 
profile A or C in the middle range of SNR. The results of this 
experiment show that the performance depends on the 
capability of a system. Theoretical analysis based on 
Shannon’s capacity cannot provide this kind of information.  
 
0 5 10 15 20 25 30
0
50
100
150
200
250
300
350
400
SNR (dB)
B
P
S
 
 
Mod A
Mod B
Mod C
Mod D
 
Fig.9 BPS performance for different profile 
 
V. CONCLUSION 
This paper proposed the user grouping and adaptive 
modulation algorithms for multi-user downlink MC-CDMA 
systems. Given the BER bound and the channel condition for 
each user, we adaptively assign users into groups and allocate 
power and modulation. Simulation results show that our 
scheme can have high spectrum efficiency with guaranteed 
BER. Simulation results have shown our proposed scheme 
outperforms both fixed modulation and reference scheme. In 
the future, we will study the system with other types of 
receiver. Moreover, the resource allocation issue in the uplink 
is also an interesting topic.  
REFERENCES 
[1] S. Hara and R. Prasad, “Overview of multicarrier CDMA,” IEEE 
Commun. Mag., vol. 35, pp. 126–133, Dec. 1997. 
[2] X. Cai, S. Zhou, and G.B. Giannakis, “Group-orthogonal multicarrier 
CDMA,” IEEE Trans. Commun., vol. 52, no. 1, pp. 90–99, Jan. 2004. 
[3] Yachen Wang, Gang Xie, Yuan'an Liu and Na Li, “Feasible resource 
allocation with partial channel information for grouped MC-CDMA 
systems”, in Proc. IEEE ISCIT,  pp. 683-688, Oct. 2007. 
[4] M. Tabulo, D. Laurenson, S.McLaughlin, E. Al-Susa, “A Linear 
Programming Algorithm for a Grouped MC-CDMA system”, in Proc. 
IEEE VTC, pp. 1463-1467, Oct. 2003. 
[5] Jinri Huang and Zhisheng Niu, “A Fairness-based and Adaptive User 
Grouping and Subcarrier Allocation Algorithm for Grouped MC-CDMA 
Systems”, in Proc. IEEE GLOBECOM, pp. 1-5, Dec. 2006. 
[6] Yachen Wang, Junyang Shen, Peng Zhang,Siyang Liu and Yuan'an Liu, 
“Optimized Power Control and Resource Allocation in Grouped MC-
CDMA Systems”, in Proc. ICC, pp. 4785-4789, May 2008. 
[7] Yachen Wang, Peng Zhang, Yuan'an Liu and Junshi Liu, “A Novel 
Criterion of Subcarrier Allocation for Grouped MC-CDMA Systems”, in 
Proc. CHINACOM , pp. 1090-1095, Aug. 2007. 
[8] C. Tang and V. J. Stolpman, “Multiple users adaptive modulation 
schemes for MC-CDMA”, in Proc. IEEE GLOBECOM, pp. 3823–3827, 
Dec. 2004. 
[9] Seong Taek Chung, and A. J. Goldsmith, “Degrees of freedom in 
adaptive modulation: a unified view,” IEEE Transactions on 
Communication, vol. 49, pp. 1561-1571, Sep 2001. 
[10] A. J. Goldsmith, and S. Chua, “Variable-rate variable-power MQAM for 
fading channels,” IEEE Transactions on Communication, vol. 45, pp. 
1218-1230, October 1997. 
 856
 9
2 月 22 日: 
 返回台灣。 
 
二、與會心得 
CCCA2011 是一個區域型的研討會，如下面的照片剪影所示，事實上他是 6 個
小型的研討會所構成，但是 oral session 卻只有分成兩個部份，以至於各個不同領域
的都混合在一起，好處是可以瞭解其他領域發展的現況，缺點呢，就是比較無法深
入，或許這是未來參加研討會須要考量的一個地方。 
 
三、考察參觀活動(無是項活動者略) 
    無 
四、建議 
無 
五、攜回資料名稱及內容 
共攜回會議論文一份，光碟片。 
 
The 2011 International Conference on Computers, Communications, 
Control and Automation (CCCA 2011) 
HongKong, China, February 20-21, 2011 
 
Official Acceptance and Invited Letter 
 
Thank you for your submission to CCCA 2011. We are pleased to inform you that your paper 
 
Paper id: 57 
Title: A Generalized Proportional Fairness Scheduler for Broadband OFDMA 
Systems with heterogeneous traffic  
Contact Author: Yaw-Wen Kuo 
 
Due to review of CCCA 2011 Committees, your paper was accepted as a regular paper in CCCA 
2011 .Your paper will be published in CCCA 2011 book proceedings of with the Publishing 
Services of the IEEE, which will be indexed by EI Compendex and ISTP. Please do take into 
account in the revision to further improve the English quality of your paper. The length of the 
paper should not exceed 4 pages without extra pages fees.  
 
In order to make high quality of CCCA 2011 proceedings, the camera-ready version should 
follow IEEE format strictly. If your paper not follow IEEE format strictly, your paper will be not 
indexed by EI and ISTP. Kindly send your Final paper to ccca2011reg@gmail.com before 
January, 30, 2011. 
 
All accepted papers should submit the copyright to ccca2011reg@gmail.com before January, 30, 
2011. If the copyright not be submitted; your paper will not be included in IEEE Xplore and 
Indexed by EI and ISTP. 
 
Registration Fees: The registration will be opened in December 30, 2010; you can download the 
registration form in the website and send us before January, 30, 2011. Sorry for the so tight 
time. 
 
We hope to see you in HongKong, China, February, 2011. 
Best  
 
 
the BS. All MSs follow the instructions broadcasted by the 
BS to access the wireless channel. Throughout this paper, 
we take the downlink subframe for example. Our algorithm 
can be applied to uplink subframe if there is a control 
protocol for the BS to retrieve the demands of MSs.  
A subframe is composed of Nc subchannels, each 
consisting of a group of subcarriers. Time axis in a frame is 
divided into time slots, and we assume that there are Ns slots 
in the downlink subframe. A time slot, associated to an 
individual subchannel, is the smallest scheduling resource. 
This paper assumes that adjacent subcarrier permutation is 
used, and each MS can periodically report the channel 
quality back to the BS. A scheduler implemented in the BS 
is responsible for allocating the time slots according to the 
backlog and channel quality for each MS. The attenuations 
of subchannels for a MS vary a lot due to frequency 
selective channel. We assume that power allocation to an 
individual MS is constant, and an adaptive modulation and 
coding scheme is used to change the modulation and coding 
scheme according to SINR. 
In order to provide guarantee for diverse applications in a 
broadband wireless network, an admission scheme is 
required. A new flow sends its traffic descriptions and 
requirements to the BS, and the BS will determine whether it 
can be admitted or not. The design of admission algorithm is 
beyond the scope of this paper, and this paper focuses on the 
performance of scheduling algorithms. 
III. PROPOSED GENERALIZED PF SCHEDULER 
The PF algorithm has been proved effective in wireless 
networks, such as HSDPA and 1xEV-DO, to achieve a 
tradeoff between system throughput and fairness by 
maximizing the summation of logarithmic function of 
average rate. In a single carrier system, the PF utility 
function follows 
( )
( ) ,                                                                  (1)
( )
n
n
n
R ti t
T t
=  
where in(t), Rn(t), and Tn(t) are the PF utility function, the 
instantaneous achievable rate, and the average throughput of 
user n at time t. The PF scheduler will select the user, 
denoted as k*, with highest utility for transmission. The 
average throughput for all users is the updated according to 
*
*
1 1(1 ) ( ) ( ),  for ,
( 1)                (2)
1(1 ) ( ), for ,
k k
c c
k
k
c
T t R t k k
t t
T t
T t k k
t
⎧ − + =⎪⎪+ = ⎨⎪ − ≠⎪⎩  
where tc is the exponential moving average factor. 
Although the above algorithm is designed for a single 
carrier system, the PF scheduler can be used in a multi-
carrier system by treating each subcarrier independently 
[2][4]. The authors in [4] proposed a matrix scheduling 
algorithm  where  each  element,  denoted  by  im,n,  in  the 
matrix represents the PF utility function of a MS at a 
particular subchannel.  im,n can be expressed by 
,
,
( )
,                                                                  (3)
( )
m n
m n
n
R t
i
T t
=  
 
Figure 1. Frame structure of an OFDMA system. 
where Rm,n(t) denotes the instantaneous achievable rate for 
MS n at subchannel m.  The average throughput at (t+1)th 
frame can be updated by 
( ) ( ) ( )1 11 1 , ,                       (4)n n n
c c
T t T t S t m
t t
⎛ ⎞+ = − +⎜ ⎟⎝ ⎠ ∑  
where Sn(t,m) is the amount of data served in subchannel m 
for MS n.  
The PF scheduler selects the MS, says j, with highest 
utility for transmission. In case that multiple subchannels 
have the same utility for the MS j, the scheduler randomly 
allocates one of them to the MS j. Let the allocated 
subchannel be subchannel k. MS j can use subchannel k as 
long as its queue is nonempty. If all packets of MS j are 
served, then all elements in column j are clear to zero. If, in 
this iteration, all slots in subchannel k are used, all elements 
in row k are clear to zero. The same procedure repeats until 
all downlink packets are served or all slots are used.  
For current wireless networks such as HSDPA, all users 
are served in a best-effort manner. As a result, the average 
throughput is the most important factor. However, future 
broadband wireless networks aim at providing triple-play 
service, and other quality of service factors should be 
considered while designing the scheduler. To integrate all 
possible factors, we propose the generalized PF scheduler 
(GPF) which considers the average profit instead of the 
average throughput for a user. The PF utility function can be 
expressed by 
,
,
( )
,                                                                 (5)
( )
m n
m n
n
R t
i
P t
=  
where Pn(t) is the average received profit of MS n at tth 
frame. When Pn(t)= Tn(t), it leads to a standard PF scheduler. 
For different quality of service (QoS) requirements, such as 
date rate or delay, we can design the relative profit functions 
and use the same FP scheduler. For the rest of this paper, we 
consider the required data rate and determine the proper 
profit function.   
In a broadband wireless network, the required data rate 
of MS i, which is denoted by ρi, is determined according to 
the actual applications running in MS i. A MS will negotiate 
its required data rate with the BS during the admission 
process.  With heterogeneous traffic in the wireless network, 
the standard PF schedule loses fairness under high load 
conditions because the MSs with low average throughputs 
have higher priority. The phenomenon can be explained by 
algorithms favor users with low data rates.  On the other 
hand, the GPF scheduler can maintain fairness between 
users with similar channel condition. For example, user 5 
and 11 are with similar channel condition, and the ratio of 
received throughputs for them is about 0.627 which is close 
to 1.5M/2.5M.  
The second experiment is used to observe the transient 
behaviors for different schedulers. There are 6 users in the 
system with similar channel condition (no extra loss added). 
The required data rates for all users are the same and equal to 
5Mbps. All users generate constant rate at 5Mbps (equivalent 
to 3125 bytes per frame). User 1 stops sending data at 1000th 
frame. At 1100th frame, it generates 10Mbps for 10 frames. 
After 1110th frame, it is normal and generates 5Mbps again. 
The amount of data served in a frame for each scheduler is 
plotted in Fig. 3. To make the figures clear, we only plot the 
first two users. Because the GPF scheduler considers the 
required data rate, it can provide certain protection for well-
behaved users, and we can see that the impact, caused by 
user 1’s burst, on user 2 is smallest. Although the OFPF 
schedule has the rate holding mechanism, the transient 
behavior is still not good. The average throughput used in the 
OFPF scheduler is on subchannel basis, not on frame basis. 
The average throughput of user 1 can be hold, but the 
average throughputs of other users increase because the 
possibility to get channel with good quality increases when 
only 5 users are active. As a result, user 1 has higher priority 
when it becomes active at 1100th frame. As expected, for the 
PF scheduler, user 1’s traffic has higher priority. Regarding 
to the MSR scheduler, the amount of served data varies a lot 
because it only considers the channel quality. 
V. CONCLUSION  
This paper proposed a generalized PF scheduler with a 
proper updating method to deal with variation of arrival 
traffics. Simulation results shows that the proposed 
scheduler deals with heterogeneous traffic well and provides 
better rate guarantee. In the future, we plan to integrate 
delay requirement into the profit function. With proper 
design of profit definition, we believe that the GPF 
scheduler can handle different kinds of QoS requirements 
simultaneously. 
Table 1: Simulation parameters. 
Parameter Value 
Frame duration, Tf 5 ms 
FFT size 1024
No. of subchannel, Nc 30 
No. of slot, Ns 24 
Mean length, L 100 bytes 
Simulation time 50000 frames 
Tc 50 frames 
Tc for OFPF 1500 subchannels
Modulation & coding Rm,n(bytes/slot) Required SINR (dB)
64QAM 3/4 27 17.38
64QAM 2/3 24 15.84
16QAM 3/4 18 12.09
16QAM 2/3 16 10.56
16QAM 1/2 12 6.81
QPSK 3/4 9 3.91
QPSK 1/2 6 -2.22
Table 2: Throughputs for different algorithms. 
user 
no.
Throughput (bps) Extra loss 
added (dB)GPF OFPF PF MSR 
Ty
pe
 1
 1 1489595 1489595 1489595 1489595 -2.5
2 1496887 1496887 1496887 1496887 -5.0
3 1490970 1490914 1490970 1490970 -7.5
4 1493096 1493096 1493096 1493096 -10.0
5 1332302 1490442 1490446 1490448 -12.5
6 1024426 1488527 1451471 747873 -15.0
Ty
pe
 2
 7 2488108 2488108 2488108 2488108 -2.5
8 2484360 2484271 2484317 2484360 -5.0
9 2486984 2486984 2486858 2486984 -7.5
10 2477403 2327153 2173333 2481618 -10.0
11 2123572 2003742 1827696 2487272 -12.5
12 1661088 1558957 1451577 768891 -15.0
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Figure 3. Transient behaviors 
ACKNOWLEDGMENT 
This work was supported in part by the National Science 
Council, Taiwan, under grant NSC 98-2221-E-260- 008. 
REFERENCES 
[1] F. P. Kelly, A.K. Maulloo and D.K.H. Tan., “Rate control in 
communication networks: shadow prices, proportional fairness and 
stability”, Journal of the Operational Research Society, vol. 49, pp. 
237-252, 1998. 
[2] J. G. Andrews, A. Ghosh, and R. Muhamed, Fundamentals of 
WiMAX: Understanding Broadband Wireless Networking, Prentice 
Hall, 2007, pp. 209-216. 
[3] H. Kim and Y. Han, “A proportional fair scheduling for multicarrier 
transmission systems,” IEEE Communications Letters, vol. 9, no. 3, 
pp. 210–212, 2005. 
[4] N. Ruangchaijatupon and Y. Ji, “Simple Proportional Fairness 
Scheduling for OFDMA Frame-based Wireless Systems,” WCNC 
2008. 
[5] A. K. Parekh and R. G. Gallager, “A generalized processor sharing 
approach to flow control in integrated services networks: The single-
node case,” IEEE/ACM Trans. Netw., vol. 1, no. 3, pp. 344–357, Jun. 
1993. 
[6] S. J. Golestani , “A self-clocked fair queueing scheme for broadband 
applications,” IEEE INFOCOM’94 , pp. 636-646, 1994. 
 
1090 1100 1110 1120 1130 1140 1150 1160
0
1000
2000
3000
4000
5000
6000
Frame
S
er
ve
d 
by
te
s
(a) GPF scheduler
 
 
user 1
user 2
1090 1100 1110 1120 1130 1140 1150 1160
0
1000
2000
3000
4000
5000
6000
Frame
S
er
ve
d 
by
te
s
(d) MRS scheduler
 
 
user 1
user 2
1090 1100 1110 1120 1130 1140 1150 1160
0
1000
2000
3000
4000
5000
6000
Frame
S
er
ve
d 
by
te
s
(c) PF scheduler
 
 
user 1
user 2
1090 1100 1110 1120 1130 1140 1150 1160
0
1000
2000
3000
4000
5000
6000
Frame
Se
rv
ed
 b
yt
es
(b) OFPF scheduler
 
 
user 1
user 2
99 年度專題研究計畫研究成果彙整表 
計畫主持人：郭耀文 計畫編號：99-2221-E-260-018- 
計畫名稱：下行多載波分碼多重存取系統之用戶分組與適應性調變機制 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 2 2 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 0 1 100% 期刊論文即將投稿。 
研究報告/技術報告 0 0 100%  
研討會論文 1 2 100% 
篇 目前已經發表一
篇研討會論文，第
二篇關於 MMSE 的
部分還在準備中。
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 4 4 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
國科會補助專題研究計畫成果報告自評表 
請就研究內容與原計畫相符程度、達成預期目標情況、研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）、是否適
合在學術期刊發表或申請專利、主要發現或其他有關價值等，作一綜合評估。
1. 請就研究內容與原計畫相符程度、達成預期目標情況作一綜合評估 
■達成目標 
□未達成目標（請說明，以 100 字為限） 
□實驗失敗 
□因故實驗中斷 
□其他原因 
說明： 
2. 研究成果在學術期刊發表或申請專利等情形： 
論文：■已發表 □未發表之文稿 □撰寫中 □無 
專利：□已獲得 □申請中 ■無 
技轉：□已技轉 □洽談中 ■無 
其他：（以 100 字為限） 
本計畫主要研究下行 MC-CDMA 系統，根據接收機可以分為 Zero Forcing 與 MMSE 兩種，我
們根據不同的接收機設計出分群的適應性調變機制，目前已經有一篇關於 Zero forcing 的國
際會議論文發表，而比較完整的期刊版本目前接近完成，預計一個月內可以投稿。關於 MMSE
的研究也已經完成，預計也可以寫成一篇國際會議與一篇期刊論文。 
3. 請依學術成就、技術創新、社會影響等方面，評估研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）（以
500 字為限） 
而本計畫針對下行 MC-CDMA 系統來研究。我們發現在頻率選擇性通到中，如果將資料展頻
道所有的子通道，反而會受到衰減太大的子通道影響，而效能大大降低，因此我們選擇了
將子通道分群組的作法，先設計將所有使用者分群的做法，然後針對不同接收機來設計適
應性調變的機制，來決定每個使用者使用的調變與功率。本計畫研究的主題，主要是在基
地台端，但是必須要根據接收端的選擇來設計對應之演算法，如果接收端使用 Zero 
forcing 等化器，則每個使用者的訊號可以視為不相干，可以利用 Lagrange multiplier
的最佳化法來求得最佳解；但如果接收端是採用 MMSE 等化器，雖然可以降低雜訊被放大
的情況，但是會產生 MAI，因此我們採用迭代的方式來逼近最佳解。模擬結果顯示，本計
畫提出來的方法可以在保證 BER 的前提下，提高頻寬的使用效率，證明是一個有效的結果。
 
MC-CDMA 兼具 CDMA 與 OFDM 兩者的特性，是一個頗具潛力的系統，但是目前的研究還是以
OFDM 為大宗，因此還有不少可以研究的空間。本計畫針對的是下行的系統，未來可以延伸
到上行的系統。在下行的系統中，每個 mobile 使用者只要解調出自己的訊號即可，因此
只要採用 Single User Detection 即可，但是因為基地台的總功率有上限，因此必須做功
率控制；而上行的部分，因為基地台必須解調出所有上行使用者的訊號，因此需要
