行政院國家科學委員會專題研究計畫成果報告 
應用分散式電源於配電系統品質提升之研究 
子計畫二: 整合型資料探勘技術於電力系統運轉資料診斷之應用 
Data Diagnosis in Power System Operation Using Integrated Data Mining Technique 
 計劃編號：NSC93-2213-E-150-027 
執行期間：93/08/01~94/07/31 
主持人：史光榮  國立虎尾科技大學電機工程學系 
計劃參與人員：黃世皓、施勝偉  國立虎尾科技大學電機工程學系 
 
一、中文摘要 
    本計畫提出整合型資料探勘技術以作為電力系統之資料
診斷。著眼於類神經網路法之不良資料診斷須委由特定的門限
值方可實現，且根據電力系統架構或其運轉狀態之變動尚須對
門限值的選擇作更迭，因此本文即研擬融入間隙統計法之資料
探勘技術於檢測過程，進而加強類神經網路法的實用價值及使
用彈性。文中並將所提檢測模式測試於 IEEE 30-bus 電力系統
資料並予以分析，模擬結果證實該方法確有其可行性。 
 
Abstract 
  An application of integrated data mining technique for the data 
diagnosis of power system operation is proposed in this paper. 
Aimed at improving the bad data detection in the neural networks, 
the proposed approach utilized the gap statistical algorithm (GSA) 
as the guide for the determination of threshold for the data 
diagnosis work. Thanks to the cluster capability exhibited by GSA, 
the integrated data mining approach was seen very effective in the 
localization of the group of bad data. The proposed method has 
been tested on several example power systems. Test results 
demonstrated the feasibility of the method for the data diagnosis 
applications. 
 
關鍵詞：資料探勘技術、類神經網路法、不良資料、間隙統計
法。 
 
二、計劃緣由與目的 
能源管理系統(Energy Management System)的各項
功能中，狀態估測(State Estimation)是相當重要的一環，
其估測效能對其他應用軟體的可靠度影響甚劇。狀態估
測器於電力系統正常操作時，可計算其有效估測值，並
提供能源管理系統可靠的狀態資料庫。倘若資料監控與
擷取(Supervisory Control and Data Acquisition)系統所收
集的量測值含有嚴重誤差，將導致估測值存在偏差量增
大，進而影響相關程式的分析結果。且若電力系統監控
人員根據非正確估測之結果研議系統的操控策略，系統
運轉勢必遭受嚴重的考驗。為增加狀態估測值的可靠
度，避免電力系統資料庫發生異常，量測值所含不良資
料(Bad Data)於載入狀態估測器之前更須予以即時辨識
並刪除。 
過去數篇文獻中業已提出許多診斷方案，以解決不
良資料的問題[1-5]。對於靜態系統之異常資料，即有文
獻藉由加權最小平方法予以檢測[1]，另有文獻利用線性
規劃 (Linear Programming)技巧 [2]、Chi-square 法、
Skewness 法[3, 4]或類神經網路(Neural Networks)法[5]予
以找尋不良資料。其中類神經網路法頗為簡易，並適用
於不良資料即時(On-line)偵測，其即利用類神經網路的
估測能力並透過門限值的設定，以偵測不良資料的存
在。其中，若網路輸入量測值與輸出估測值的平方差大
於門限值，即表示異常資料之存在。此種方法具可行
性，惟門限值需依據不同的系統操作情況作適當調整。
且該方法的學習樣本應包含所欲偵測的樣型，否則資料
偵測錯誤之機會將大幅增加。 
近來，資料探勘(Data Mining)已成為各研究領域熱
門的討論課題[6]。根據資料本身特徵及相互的關聯性，
搜尋其蘊含的有效資訊，以作為使用者決策之用，該過
程即可廣泛定義為資料探勘[7]。資料探勘技術能夠提供
高適應性之自動化處理機制，以挖掘有效的資訊。因此
本文擬藉由間隙統計法(Gap Statistical Algorithm)嵌入類
神經網路法之整合型資料探勘技術，以解決電力系統不
良資料檢測的問題[8]。所提方法之建模方式係由類神經
網路所得之平方差資料利用分群法進行分類，並求其總
平方誤差；再透過平方差資料產生與其相對應之參考資
料集合並計算其總平方誤差；接著，利用最佳群組數計
算準則估測最佳群組數；最後即可藉由該結果以分析不
良資料。 
 
三、研究方法與成果 
 
1. 類神經網路之不良資料檢測 
如圖 1 為電力系統不良資料之類神經網路即時檢測
步驟。該演算法乃藉由類神經網路中神經元(Neuron)間
的加權值將不良輸入量測值之劇烈擾動予以分散，期使
輸入量測值對網路輸出估測值的影響能夠降至最低，進
而取量測值與估測值的平方差，並根據經驗設定合適的
門限值以檢測不良資料的存在。 
而由於電力系統之量測資料可能大於或小於零，因
此對每個神經元的激發函數(Activation Function)可假設
為[5]： 
1)exp(
1)exp()( +
−=
net
netnetO  (1) 
亦即此函數的變化將被限制在 1 與-1 之間。其中 net 代
表神經元的輸入值乘上各權重後之總合，O 為該神經元
之輸出值。因此，第 b 個輸出層神經元的局部梯度值
(Local Gradient)δbo即為： 
))(( obb
o
b
o
bo
b
o
b OtnetOdnet
dδ −=  
 ))()(1(
2
1 2 o
bb
o
b OtO −−=  (2) 
上式中 netbo 表示第 b 個輸出層神經元的淨輸入值，Obo 
代表第 b 個輸出層神經元的輸出值，tb為第 b 個輸出層
PD
FC
MD
 Tr
ial
 Ve
rsi
on
ww
w.
ze
on
.co
m.
tw
值以協助搜尋最佳群組數。其中當參考集合的資料點個
數為 n 時，期望值即以 En*[.]表示。此處採行自然對數之
用意即在使總平方誤差曲線趨於線性化，以便於監視及
判定。至於參考資料的產生，文中則根據欲分析資料於
每一維度中分佈的範圍，均勻地產生與其相對應的隨機
數值。倘若 En*[ln(Wk,ref)]與 ln(Wk,obs)之間的差距有顯著
增加的現象，此時即代表發生最佳群組數。其中，針對
單一群組資料的估測，相較於其他類似方法，間隙統計
法仍為有效，以致當所有量測資料皆屬有效值時，該法
可將其歸納成一組正常的資料叢集。 
 
2.4. 建模流程 
本文融入間隙統計法於強健性類神經網路法之建模
步驟如圖 2 所示。執行步驟分述如下[8]： 
 
步驟一 (輸入平方差資料)： 
待強健性類神經網路訓練完畢，再續以輸入實際量
測誤差，即可求得輸出估測值，並計算網路輸入值與輸
出值的平方差以構成所欲分析的資料類型。 
步驟二 (計算(eb-Rbo)2之總平方誤差 Wk,obs)： 
將平方差資料利用分群演算法予以分類，當群組數
為 k 時，可得總平方誤差 Wk,obs。另考量檢測模式之執行
效率，分群法可採行常用之分割式 K-means 法，以增加
運算速度[15]。 
步驟三 (計算參考資料集合之總平方誤差 * ,refkfW )： 
待參考資料集合產生後，即可將參考資料加以分
群。倘若參考資料集合之個數為 F，則可計算總平方誤
差 * ,refkfW , f=1, 2, …, F。 
步驟四 (最佳群組數之判斷)： 
利用下列數學式以進行最佳群組數之判斷。首先計
算間隙統計量 Gap(k)，即： 
)(-)]([)( ,, obskrefk
*
n WlnWlnEkGap =  (7) 
∑=
f
*
refkfrefk
*
n WlnF
WlnE )(1)]([ ,,  (8) 
另根據最佳群組數判斷準則，如(9)式所定義，則符合該
式之最小群組數 k 即為最佳群組數： 
1)1()( +−+≥ ksekGapkGap  (9) 
F
sdse kk
1111 += ++  (10) 
2
,1,11 )])([)((
1
refk
*
n
f
*
reffkk WlnE-WlnF
sd +++ ∑=  (11) 
其中，sek+1代表模擬誤差量，sdk+1則為標準差(Standard 
Deviation)。 
步驟五 (異常資料之檢定)： 
    此步驟執行異常資料之總檢定。當最佳群組數發生
在 k≠1 時，表示量測資料內含異常數據，換言之，量測
資料需分割為正常群組與異常群組。而後即依分類結果
計算每一群組其(eb-Rbo)2 數據的平均值，平均值最低之
群組即為正常資料，其餘群組則可視為異常資料群組。
此處另需說明的是，當最佳群組數 k=1 時，則意指此時
之量測值皆隸屬正常資料。 
 
執行分群演算
分析並計算總
平方誤差Wk,obs
產生參考資料
集合並計算總
平方誤差1111
計算間隙統
計量Gap(k)
計算最佳
群組數
間隙統計法
不良資料分析
輸入平方差資料
*
,refkfW
 
圖 2：整合型資料探勘技術之不良資料檢測流程 
 
2423
22211918
109111213
2017161514
86431
752
28272930
2625
G
GG
G
G G
G :發電機
:電壓量測儀錶
:功率量測儀錶
:負載
:電容器
:變壓器  
圖 3：IEEE 30-bus 系統架構 
 
3. 模式驗證 
 
本節使用如圖 3 之 IEEE 30-bus 電力系統以測試文
中所提整合型資料探勘技術於不同系統操作情況下之
不良資料診斷結果。 
 
A. 系統操作描述 
圖 3 所示電力系統共含 99 個量測值，本文根據匯
流排號碼依序將匯流排電壓、發電機或負載實/虛功率及
傳輸線上實/虛功率潮流量予以編號。俟系統於模擬運轉
後，本文擷取其中 150 個時間點的相關資訊以計算強健
性類神經網路的訓練樣本，且另考慮 30 個時間點以為
分析模擬之用。在 30-bus 電力系統中，假設負載係由線
性漸增負載並加上標準差為 1％的常態分佈隨機擾動
(Normally Distributed Random Fluctuation)所構成。其
中，負載值介於 16％至 25％之間，且不同匯流排含不
同負載量。此外，文中之負載功率因數均視為定值。利
用系統單線圖資料及負載數據並經由電力潮流程式即
可求得理想量測值 z+。將 z+加入常態分佈隨機擾動，方
能獲致所須的模擬量測值 z。其中，本文對理想電壓值
加上標準差為 1％的擾動；另對理想功率值則加上標準
PD
FC
MD
 Tr
ial
 Ve
rsi
on
ww
w.
ze
on
.co
m.
tw
