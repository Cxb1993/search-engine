表 C012A                                                                         共 95 頁  第 2 頁 
肺癌電腦斷層掃描電腦輔助偵測與診斷系統之開發(2/3) 
中文摘要 
 肺癌已連續 22年分別居於台灣女性與男性惡性腫瘤死因之第一位與第二位。而美國於 2001-2005
年間，肺癌則皆分別居於男性與女性惡性腫瘤死因之第一位。早期診斷出肺癌是提高其治癒率的重要
方法。在美國，肺癌的治癒率僅約 10%，而五年存活率也僅是些微高於治癒率。相對的，stage I的肺
癌，經切除手術之五年存活率可達 70%。近年來，電腦斷層掃描已是目前最常用於早期檢測出肺腫瘤
並分辨其良惡性的影像方法。然而肺部電腦斷層掃描的判讀卻不是一件容易的事，特別是微小肺腫瘤
之尋找，十分仰賴臨床醫師的判讀。具有不同經驗的醫師其所判讀出來的結果很可能會不同。 
 為了要提升電腦斷層掃描中肺腫瘤的偵測與診斷能力，藉由影像分析與資料探勘的技術，自動偵
測腫瘤位置與判斷其良惡性之電腦輔助偵測與診斷系統近來已逐漸受到相當的重視，並屢被證明有助
於肺腫瘤篩檢與診斷。多家商品化之電腦輔助偵測軟體或已獲得美國 FDA(Food and Drug 
Administration) approval，或正等待之，這些都說明了電腦輔助偵測在醫療儀器市場上所受到的重視。
然而，不論是商用產品的電腦輔助偵測軟體或是仍處於實驗室階段的電腦輔助偵測與診斷軟體，都未
臻理想。以電腦輔助偵測而言，敏感度不夠高，同時有過高的偽陽性，以及無法偵測到 GGO 
(Ground-Glass Opacity) 腫瘤是常見的缺點。就電腦輔助診斷而言，目前已發表的演算法的效能多數都
不夠高，通常的 ROC curve面積多界於 0.750和 0.920之間。 
本計畫為一三年期產學合作案，其主要目的在於發展高效能之肺腫瘤電腦斷層掃描之電腦輔助偵
測與診斷軟體系統。在電腦輔助偵測上，擬結合本研究團隊中興電工在此一課題上多年的研發經驗與
已發展之電腦輔助軟體，並藉由更細緻的解剖學的分析，提高腫瘤偵測率，同時降低 false positive 
lesions的數目，並且強化 GGO的偵測工作。在電腦輔助診斷上，擬藉由本研究團隊在影像分割上的
多年來所累積的經驗與發展的演算法，研發強健而有效的電腦斷層掃描之肺腫瘤分割技術，並萃取幾
近不受系統參數影響之影像學特徵。同時，將結合本團隊張允中醫師多年來在 Perfusion CT上之臨床
經驗與學術研究成果，發展具 motion correction能力之 Perfusion CT參數估計模型，提供具影像學特
徵與 Perfusion CT功能性特徵之電腦輔助診斷系統。 
在第二年計畫中，我們已完成三維肺腫瘤偵測演算法的修正，肺腫瘤電腦輔助偵測系統之第一階
段臨床測試，肺腫瘤邊緣偵測演算法，肺腫瘤影像特徵擷取，血流灌注分析之多時間點腫瘤對位技術
開發，電腦輔助視覺偵測，血流灌注分析與特徵擷取，以及結合第二年所完成工作項目之 3D 
Visualization Platform之建構等八項工作。在三維肺腫瘤偵測演算法修正方面，我們提出藉由找出精確
的血管組織，再將其從肺區中扣除，而使得一次能獲得所有候選肺腫瘤，進而再由規模矩陣(Size Matrix)
與形態動態(Morphological Dynamics)法分析候選肺腫瘤之型態動態、紋理，以及與血管的關聯性，判
別其是否為腫瘤。於肺腫瘤電腦輔助偵測系統: 第一階段臨床測試中，目前透過 LIDC數據庫的 65組
CT 影像檢測我們所提出的三維肺腫瘤偵測演算法，在靈敏度及錯誤率的效能上相較於近幾年公開的
肺腫瘤偵測演算法有較準確的結果。 
而在肺腫瘤邊緣偵測演算法中，我們分析了從未應用至肺腫瘤分割之五種影像分割演算法。透過
此量化分析，我們將於第三年計畫中提出新的肺腫瘤邊緣偵測演算法。於肺腫瘤影像特徵擷取方面，
透過對 LIDC資料的分析，我們得到影像形態上的資訊和其與惡性和鈣化程度的關聯性，對所發展的
肺腫瘤影像所擷取之特徵是一個很重要的參考指標。除了讓電腦可以自動偵測肺部腫瘤之外，我們發
展電腦輔助視覺偵測，使用肺區擷取功能取得肺區遮罩，且透過氣管與血管重建功能取得氣管與血管
遮罩，再將原始 DICOM影像內容扣除上述肺區、氣管與血管遮罩之後，剩下的影像可以清楚看見腫
瘤或是其他的異常組織。 
在血流灌注分析的多時間點腫瘤對位上，我們則提出一個新的剛性對位方式，可以大幅度降低
partial volume effect和 motion effect的混合效應。此外，在血流灌注分析特徵擷取中，我們探討孤立
肺結節中灌注性影像之訊號與腫瘤新生的意義中分析 time-intensity curve訊號的model-free參數定義，
可量化腫瘤組織中組織組成成分。在結合第二年所完成工作項目之 3D Visualization Platform之建構方
面，我們則發展了一個快速且有善的影像視覺化的平台，包含 3D影像立體顯示應用技術。據此，我
表 C012A                                                                         共 95 頁  第 4 頁 
I. 計畫之背景及目的 
1. 計畫背景 
多年以來，惡性腫瘤一直高居國內十大死因之首位。在行政院衛生署所發布之九十六年度台灣地
區主要死亡原因中，男性與女性因惡性腫瘤而死亡的比例分別為 30.06%和 27.08%。而肺癌則已連續
22 年居於男性惡性腫瘤死因之第二位與女性惡性腫瘤死因之第一位 (行政院衛生署統計公布欄, 
2006)。與其他致命疾病一般，早期診斷出肺癌是提高其治癒率的不二法門。在美國，肺癌的治癒率
僅約 10%，而五年存活率也僅是些微高於治癒率。相對的，stage I的肺癌，經切除手術之五年存活率
可達 70%，但若放任不切除，其存活率也大約在 10%左右(Henschke et al., 2001)。此一統計數據顯示
早期偵測的重要性。傳統上，肺癌的早期診斷或初步診斷多根據病人的相關病史、理學檢查、胸部 X
光、痰液癌細胞檢查、以及一般血液檢查。然而，不幸的是，胸部 X光攝影與唾液細胞檢查之結果並
不能有效地降低死亡率(Heelan et al., 1984)。 
近年來，隨著電腦斷層掃描在空間解析度、掃描速率、以及偵測器敏感度的快速進步，電腦斷層
掃描已是目前最常用於早期檢測出肺腫瘤並分辨其良惡性的影像方法。在一項 1000 人參與的 early 
lung cancer action project (ELCAP)臨床試驗中顯示(Henschke et al., 2001)，低劑量電腦斷層掃描
(low-dose CT)可以顯著的提高 stage I肺癌的偵測率，它也意味著較好的治癒率。而其後的持續研究顯
示，結至 2004年，在 27701個參與者中，治癒率可達 76%~78%。 
使用低劑量電腦斷層掃描用來偵測肺腫瘤，其劑量與胸部 X光攝影相當，不僅其靈敏度優於使用
胸部 X光攝影(Remy-Jardin et al., 1993)，並且大量降低了胸部 X光攝影中，解剖構造之組織結構重疊
所造成的遮蔽影響。藉由多排螺旋電腦斷層掃描技術的研發，目前已經能夠偵測直徑 1-2 mm的肺部
腫瘤，這些都是以前難以觀察到的(Fischbach et al., 2003)。就肺腫瘤偵測而言，電腦斷層掃描可謂是
兼具高靈敏度(sensitivity)與特異度(specificity)的診斷儀器。 
雖然低劑量電腦斷層掃描已有能力偵測到直徑 1-2 mm的肺部腫瘤，但是肺部電腦斷層掃描的判
讀卻不是一件容易的事。例如，對於分辨圓形(腫瘤)與管狀(血管)結構，醫師必須逐張切片影像仔細
檢查，這是非常耗費時間且極為容易造成判斷錯誤。尤其是在電腦斷層影像中尋找微小肺腫瘤更是容
易造成失誤。如果醫師僅以肉眼尋找，其準確程度有其極限。而微小腫瘤未被偵測到的主要原因通常
有二：(1)腫瘤位於血管壁上或其內部，(2) 腫瘤附近有許多其他組織存在，例如：支氣管、血管或肺
部組織等。也因此肺腫瘤之尋找，特別是微小肺腫瘤之尋找，十分仰賴臨床醫師的判讀。具有不同經
驗的醫師其所判讀出來的結果很可能會不同。這也造成了使用電腦斷層掃描來偵測肺腫瘤的可靠性與
平均準確率受到很大的影響。舉例而言，在 Yuan等人(Yuan et al., 2006)的一項評估研究中，從 150個
病人的低劑量電腦斷層掃描裡，醫生只找到了 628個 nodules中的 518個，漏失了 18%。而在 Das等
人(Das et al., 2006)的研究中，三個醫生分別在 116個 nodules中只找到了 68%、78%和 82%的 nodules。
Gierada等人(Gierada et al., 2008)則在一項 16位放射線科醫師(來自美國 10個 National Lung Screening 
Trial screening centers)參與的研究中更發現，兩兩醫師間對於偵測到的腫瘤的平均一致度只有 82%。
Multirater值界於 0.58和 0.64之間。 
表 C012A                                                                         共 95 頁  第 6 頁 
都未臻理想，存在著很大的進步空間。以電腦輔助偵測而言，有些時候會找到太多不是腫瘤的“假腫
瘤”，false positive rate過高。例如在 Yuan等人(Yuan et al., 2006)的研究中，ImageChecker CT所認定
的腫瘤，只有 49%是真的；而在 Das等人(Das et al., 2006)的研究中，ImageChecker CT和 NEV等兩個
CAD系統平均在每個病人身上找到 6個和 8個 false positive lesions。但另一方面，兩個 CAD系統的
敏感度都不高。在這兩項研究中，ImageChecker CT的敏感度皆只有73%，而在Das等人(Das et al., 2006)
的研究中 NEV 的敏感度僅為 75%。此外，根據我們團隊成員(張允中醫師)在台大醫院的經驗，GE 
Healthcare的 Lung VCAR並無法偵測到 GGO (Ground-Glass Opacity) 腫瘤。 
而在實驗室階段的電腦輔助偵測系統中，Armato等人(Armato et al., 2001)使用多重閥值分割法，
獲得疑似肺部腫瘤區域，經由型態與灰階值特徵之計算透過線性判別分析法(linear discriminant 
analysis)，得到肺腫瘤之位置。他們的方法獲致 0.90的 ROC Az值，其敏感度為 70%，且每一張影像
的 false-positive lesions為 1.5。Lee等人(Lee et al., 2001)根據基因演算法，提出模板比對的方式用來偵
測位於肺區內與肺壁上的腫瘤。初步得到疑似肺腫瘤的區塊，接著，作者使用 13 個特徵值作為去除
非腫瘤的區塊，其正確率為 72%(71/98)，然而其平均每一張影像的 false positives lesions趨近 1.1。Brown
等人(Brown et al., 2003)使用 attenuation thresholding、region growing和 mathematical morphology將肺
部以三維分割方式分割成多個有興趣的區域，而每一個區域的再以預先建構好的肺腫瘤與肺部結構模
型進行標記。其結果顯示大於 3mm 與介於 1mm 和 3mm 間的腫瘤，敏感度分別為 100%和 70%。但
是每個病人的平均 false positive lesions為 15。Gurcan等人(Gurcan et al., 2002)結合 thresholding、k-means 
clustering和 rule-based classification等技術獲致敏感度 84%，而每一張影像的平均 fasle positive lesions
為 1.74。Suzuki等人(Suzuki et al., 2003)以正規化之可疑腫瘤影像為特徵，使用多個 massive training 
ANNs，得到敏感度 80.3%，而每一張影像之 false positive lesion則為 0.18。 
 就電腦輔助診斷而言，目前已發表的演算法的效能多數都不夠高，通常的 ROC curve面積多數界
於 0.750和 0.920之間，例如 0.795(Awai et al., 2006)、0.830(Way et al., 2006)、0.920(Shah et al., 2005)、
0.857(Way et al., 2009)、0.870(Lee et al., 2008)。而造成效能不高的原因，除了影像學的特徵本質上無
法完全解釋腫瘤的良惡性，甚或細分不同的類別與 stage 外，目前已發表的演算法在影像學特徵的萃
取上，雖然頗具多樣性，但是多侷限於傳統的數學特徵。舉例來說，常用的 circularity、irregularity、
compactness、roundness (McNitt-Gray et al., 1999)、moment、fourier descriptors (Lee et al., 2008)等型態
學特徵並無法有效描述惡性腫瘤不規則或是葉狀的特性。而 Run-length (Way et al., 2006; Shah et al., 
2005; Way et al., 2009)、co-occurrence matrix (Shah et al., 2005; Lee et al., 2008)等紋路特徵並不 robust，
有可能因為電腦斷層掃描的系統參數不同，或是個體差異之因素而產生變異，也就是紋路特徵值所反
應的可能主要是系統參數或個體差異，而非良惡性之別。 
或許更基本的問題是：有研究指出，型態學特徵會因腫瘤分割結果的不同而產生不同的效能(Lee 
et al., 2008)。更確切的說，不同的腫瘤分割方法不但會造成腫瘤體積的量度變異，也會造成腫瘤型態
描述的差別。這也意味著發展一個強健且有效的腫瘤分割方法對於電腦斷層掃描肺腫瘤之電腦輔助診
斷是非常關鍵的。然而這一個課題在此領域中著墨的非常有限。譬如， 3D active contour model (Way 
et al., 2009)、以自動的方式提供一個粗略的腫瘤邊緣，再由人工的方式勾勒出各醫師認為的邊緣(Shah 
et al., 2005)、3D 形變模型(level set method的一種)( Kawata et al., 1998)、thresholding (McNitt-Gray et al., 
表 C012A                                                                         共 95 頁  第 8 頁 
 綜觀肺腫瘤電腦斷層掃描的電腦輔助偵測與診斷系統，雖然已漸趨成熟，但是尚無法在臨床診斷
上扮演重要的角色，其中主要原因可以歸納如下： 
A. 電腦輔助偵測 
a. 偵測到太多的 false positive lesions，形成放射科醫師不必要的困擾； 
b. 對於靠近血管與組織的腫瘤，其偵測率偏低； 
c. 對於平均灰階值(HU值)較低的腫瘤，如 GGO等，偵測率偏低。 
B. 電腦輔助診斷 
a. 缺少強健而有效的腫瘤分割技術，使得所獲致的影像學特徵，包括型態學特徵與紋路特徵，其
效能受到影響； 
b. 影像學特徵多侷限於傳統的數學特徵，無法有效的區分良惡性腫瘤的型態與紋路，且未將斷層
掃描系統參數的影響納入考量； 
c. 在萃取 Perfusion CT所提供的功能性資訊時未將呼吸所造成的腫瘤位置改變納入考量，以致於
Perfusion參數計算含有潛在的雜訊。 
3. 計畫目的 
 本計畫為一三年期產學合作案，其主要目的在於發展高效能之肺腫瘤電腦斷層掃描之電腦輔助偵
測與診斷軟體系統。在電腦輔助偵測上，擬結合本研究團隊中興電工在此一課題上多年的研發經驗與
已發展之電腦輔助軟體，並藉由更細緻的解剖學的分析，提高腫瘤偵測率，同時降低 false positive 
lesions的數目，並且強化 GGO的偵測工作。在電腦輔助診斷上，擬藉由本研究團隊在影像分割上的
多年來所累積的經驗與發展的演算法，研發強健而有效的電腦斷層掃描之肺腫瘤分割技術，並萃取機
幾近不受系統參數影響之影像學特徵。同時，將結合本團隊張允中醫師多年來在 Perfusion CT上之臨
床經驗與學術研究成果，發展具 motion correction能力之 Perfusion CT參數估計模型，提供具影像學
特徵與 Perfusion CT功能性特徵之電腦輔助診斷系統。本計畫三年的具體研究目的為： 
• 發展以 CT影像為主之肺腫瘤篩檢系統，針對肺部血管與支氣管之全自動或幾近全自動之影像分
割技術； 
• 發展以 CT影像為主之肺腫瘤篩檢系統，針對肺腫瘤之全自動或幾近全自動之偵測與影像分割技
術； 
• 發展 perfusion CT 之全自動或幾近全自動之影像對位與 motion correction 技術，並尋找有效的
perfusion CT功能參數； 
• 發展 CT肺腫瘤型態分析與危險性預測之技術； 
• 發展診療機制之肺部 CT影像研究，達到個人化醫學，依個人的條件給予適當的治療； 
• 發展以程序為導向(Process-Oriented)之電腦輔助偵測與診斷系統平台，更是一知識管理及分享
(Knowledge Management and Sharing)平台，並即時呈現 CT三維資訊、病人過去病歷與化療結果
之追蹤。 
而在第二年的計畫中，我們的主要研究重點為三維肺腫瘤偵測演算法之改良，肺腫瘤電腦輔助偵
測系統之第一階段臨床測試，三維肺腫瘤邊緣偵測演算法的開發，肺腫瘤影像特徵之擷取，多時間點
腫瘤對位技術開發，電腦輔助視覺偵測，血流灌注分析與特徵之擷取，以及結合第二年所完成工作項
目之 3D Visualization Platform之建構。 
表 C012A                                                                         共 95 頁  第 10 頁 
1998. 
Cooley WW, Lohnes PR. Multivariate data analysis. New York: Wiley, 1971. 
Cortes C and Vapnik V. Support-Vector Networks. Machine Learning 1995; 20(3): 273-297. 
Cour T, Benezit F, Shi J. Spectral Segmentation with Multiscale Graph Decomposition. IEEE International 
Conference on Computer Vision and Pattern Recognition (CVPR) 2005. 
Das M, Mȕ hlenbruch G, Mahnken AH, et al. Small Pulmonary Nodules: Effect of Two Computer-aided 
Detection Systems on Radiologist Performance. Radiology 2006; 241(2): 564-571. 
Diciotti S, Picozzi G, Falchini M, Mascalchi M, Villari N, and Valli G. 3-D Segmentation Algorithm of 
Small Lung Nodules in Spiral CT Image. IEEE Trans. Information Technology in Biomedicine 
2008;12(1):7-19. 
Dillon WR, Goldstein M. Multivariate analysis: method and applications. New York: John Wiley & Sons, 
1984. 
Dunn JC. A Fuzzy Relative of the ISODATA Process and Its Use in Detecting Compact Well-Separated 
Clusters. Journal of Cybernetics 1973;3:32-57. 
Erasmus JJ, Connolly JE, McAdams HP, Roggli VL. Solitary pulmonary nodules. Part I. Morphologic 
evaluation for differentiation of benign and malignant lesions. RadioGraphics 2000; 20:43-58. 
Eyal E. Model-based and model-free parametric analysis of breast dynamic-contrast-enhanced MRI. NMR 
Biomed. 2009;22: 40-53. 
Fischbach F, Knollmann F, Griesshaber V, Freund T, Akkol E, Felix R. Detection of pulmonary nodules by 
multislice computed tomography: improved detection rate with reduced slice thickness. Eur Radiol 2003;13: 
2378-2383. 
Fraioli F et al. Whole-tumor perfusion CT in patients with advanced lung adenocarcinoma treated with 
conventional and anti-angiogenetic chemotherapy: initial esperience. Radiology 2011;259. 
Frangi AF, Niessen WJ, Vincken KL, and Viergever MA. Multiscale vessel enhancement filtering. Proc. Int. 
Conf. Medical Image Computing Computer-Assisted Intervention. LNCS 1998; 1496: 130-137. 
Furuya K, Murayama S, Soeda H, Murakami J, Ichinose Y, Yabuuchi H, Katsuda Y, Koga M, Masuda K. 
New classification of small pulmonary nodules by margin characteristics on high-resolution ct. Acta 
Radiologica 1999;40:496-504. 
Gastaud M, Barlaud M, Aubert G. Combining shape prior and statistical features for active contour 
segmentation. IEEE TCSVTspecial session on Audio and Video Analysis for Interactive Multimedia Services, 
表 C012A                                                                         共 95 頁  第 12 頁 
Kang LQ, Song ZW, Li ZX, Yu SJ, Liu FH, Chen YF and Xing RG. Preliminary study on CT perfusion 
imaging in guiding biopsy of pulmonary lumps. Chinese Medical Journal 2009; 122(7):807-81. 
Karaman K, Kutay M, Bozdagi G. An adaptive speckle suppression filter for medical ultrasonic imaging. 
IEEE Trans. Med. Imaging 1995; 14: 283-292. 
Kauczor HU, Heitmann K, Heussel CP, Marwede D, Uthmann T, Thelen M. Automatic detection and 
quantification of ground-glass opacities on high-resolution CT using multiple neural networks: comparison 
with a density mask. AJR Am J Roentgenol 2000; 175:1329-1334. 
Kawata Y, Niki N, Ohmatsu H, Eguchi K, and Moriyama N. Shape Analysis of Pulmonary Nodules Based on 
Thin Section CT Images. Proc. SPIE 1997:964-974. 
Kawata Y, Niki N, Ohmatsu H, Kakinuma R, Eguchi K, Kaneko M, Moriyama N. Biexponential 
characterization of prostate tissue water diffusion decay curves over an extended b-factor range. IEEE Trans. 
Nucl. Sci. 1998;45:2132-2138. 
Kawata Y, Niki N, Ohmatsu H, Kusumoto M, Kakinuma R, Mori K, Nishiyama H, Eguchi K, Kaneko M, 
Moriyama N. Computerized analysis of 3-d pulmonary nodule images in surrounding and internal structure 
feature spaces. In: Proc. Int. Conf. Image Process. 2001:889-892. 
Kazuhiro U, Yoshikazu K, Manabu S, Jinbo M, Nobuyuki T, Kazuyoshi S and Kimikazu H. Role of 
Quantitative CT in Predicting Hypoxemia and Complications After Lung Lobectomy for Cancer, With 
Special Reference to Area of Emphysema. Chest 2005;128;3500-3506. 
Kido S, Kuriyama K, Higashiyama M, Kasugai T, Kuroda C. Fractal analysis of small peripheral pulmonary 
nodules in thin-section ct: evaluation of the lungnodule interfaces. J. Comput. Assist. Tomogr 
2002;26:573-578. 
Kim TH, Lee KM, Lee SU. Generative Image Segmentation Using Random Walks with Restart. European 
Conference on Computer Vision (ECCV) 2008. 
Kim TH, Lee KM, Lee SU. Nonparametric Higher-Order Learning for Interactive Segmentation. Proc. 
Computer Vision and Pattern Recognition (CVPR) 2010. 
Ko JP, Betke M. Chest CT: automated nodule detection and assessment of change over time-preliminary 
experience. Radiology 2001;218:267-273. 
Kostis WJ, Reeves AP, Yankelevitz DF, Henschke CI. Three-dimensional segmentation and growth-rate 
estimation of small pulmonary nodules in helical CT images. IEEE Trans Med Imaging 2003;22:1259-1274. 
Kuhnigk JM, Dicken V, Bornemann L, Bakai A, Wormanns D, Krass S, and Peitgen HO. Morphological 
Segmentation and Partial Volume Analysis for Volumetry of Solid Pulmonary Lesions in Thoracic CT Scans. 
表 C012A                                                                         共 95 頁  第 14 頁 
Mullally W, Betke M, Wang J, and Ko JP. Segmentation of Nodules on Chest Computed Tomography for 
Growth Assessment. Medical Physics 2004;31(4):839-848. 
Nappi J and Yoshida H. Automated detection of polyps with CT Colonography: evaluation of volumetric 
features for reduction of false-positive findings. Acad Radiol 2002; 9(4):386-397. 
Ng QS, Goh V, Fichte H, et al. Lung cancer perfusion at multi-detector row CT: reproducibility of whole 
tumor quantitative measurements. Radiology 2006; 239(2):547-553. 
Nock R, Nielsen F. Statistical region merging. IEEE Trans Pattern Anal Machine Intelligence 
2004;26:1452-1458. 
Nunzio GD, Tommasi E. Automatic Lung Segmentation in CT Images with Accurate Handling of the Hilar 
Region. Journal of Digital Imaging 2011;24(1):11-27. 
Otsu N. A threshold selection method from Gray-Level Histograms. IEEE Trans. on System, Man and 
Cybernetics 1979;1:62-66. 
Ovali GY, Sakar A, Göktan C, et al. Thorax perfusion CT in non-small cell lung cancer. Computerized 
Medical Imaging and Graphics 2007; 31: 686-691. 
Petkovska I, Brown MS, Goldin JG, Kim HJ, McNitt-Gray MF, Abtin FG, Ghurabi RJ, and Aberle DR. The 
Effect of Lung Volume on Nodule Size on CT. Academic Radiology 2007;14(4):476-485. 
Pu J, Paik DS, Meng X, Roos JE, and Rubin GD. Shape Break and Repair Strategy and Its Application to 
Automated Medical Image Segmentation. IEEE Trans Vis Comput Graph 2011;17(1):115-124. 
Reeves AP, Chan AB, Yankelevitz DF, Henschke CI, Kressler B, Kostis WJ. On measuring the change in size 
of pulmonary nodules. IEEE Trans Med Imaging 2006; 25:435-450. 
Remy-Jardin M, Remy J, Giraud F, Marquette CH. Pulmonary nodules: detection with thick-section spiral 
CT versus conventional CT. Radiology 1993; 187:513-520. 
Shah SK, McNitt-Gray MF, Rogers SR, et al. Computer-aided Diagnosis of the Solitary Pulmonary Nodule. 
Acad Radiol 2005; 12: 570-575. 
Shah SK, McNitt-Gray MF, Rogers SR, et al. Computer Aided Characterization of the Solitary Pulmonary 
Nodule Using Volumetric and Contrast Enhancement Features. Acad Radiol 2005; 12(10):1310-1319. 
Shiffman S, Rubin GD, and Napel S. Medical Image Segmentation Using Analysis of Isolable-Contour Maps. 
IEEE Trans. on Med. Imaging 2000;19(11):1064-1074. 
Saito T, Toriwaki JJ. New algorithms for euclidian distance transformations of an n-dimensional digitised 
表 C012A                                                                         共 95 頁  第 16 頁 
Weir HK, Thun MJ, Hankey BF, Ries LA, Howe HL, Wingo PA, Jemal A, Ward E, Anderson RN, Edwards 
BK. Annual report to the nation on the status of cancer, 1975-2000. J. National Cancer Institute 
2003;95:1276-1299. 
Yeh C, Lin CL, Wu MT, et al. A neural network-based diagnostic method for solitary pulmonary nodules. 
Neurocomputing 2008; 72: 612-624. 
Yeh C, Wang JF, Wu MT, et al. A comparative study for 2D and 3D computer-aided diagnosis methods for 
solitary pulmonary nodules. Computerized Medical Imaging and Graphics 2008; 32(4): 270-276. 
Yi CA, Lee KS, Kim EA, et al. Solitary Pulmonary Nodules: Dynamic Enhanced Multi–Detector Row CT 
Study and Comparison with Vascular Endothelial Growth Factor and Microvessel Density. Radiology 2004; 
233:191-199. 
Yuan R, Vos PM, Cooperberg PL. Computer-Aided Detection in Screening CT for Pulmonary Nodules.  
AJR 2006; 186:1280-1287. 
Zhang X, Stockel J, Wolf M, Cathier P, McLennan G, Hoffman EA, Sonka M.A new method for spherical 
object detection and its application to computer aided detection of pulmonary nodules in CT images.Med 
Image Comput Comput Assist Interv. 2007;10(Pt 1):842-849. 
Zhao, G., Pietik¨uinen, M.: Dynamic texture recognition using local binary patterns with an application to 
facial expressions. IEEE Transactions on Pattern Analysis and Machine Intelligence 2007;29(6). 
Zimmermann HJ. Fuzzy Set Theory and Its Applications. (Kluwer,Dordrecht,1991) 
Zwirewich CV, Vedal S, Miller RR, et al. Solitary pulmonary nodule: high-resolution CT and 
radiologic-pathologic correlation. Radiology 1991; 179: 469-476. 
行政院衛生署統計公布欄
http://www.doh.gov.tw/CHT2006/DM/DM2_2.aspx?now_fod_list_no=10327&class_no=440&level_no=4.  
葉清松, 3D電腦斷層影像之肺腫瘤電腦輔助診斷系統的開發與分析. 博士論文。 
 
  
表 C012A                                                                         共 95 頁  第 18 頁 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
圖 II.1.1：肺部電腦斷層掃描三維肺腫瘤偵測演算法改良之架構圖。 
 
  
血管重建 
 
 
 
 
基於形態特徵之肺壁腫
瘤偵測演算法 
 
 
 
DICOM  Images 
基於三維區域成長法
之肺區重建演算法 
 
平坦暗色圓切面搜尋之氣
管內壁重建與分割演算法 
 
 
候選肺腫瘤 
(=肺臟-氣管-血管) 
 
 
基於形態動態之三維胸腔電腦斷層影
像肺血管腫瘤偵測演算法 
 
 
表 C012A                                                                         共 95 頁  第 20 頁 
拉數 (Euler number, E)。藉此我們可以分析出單點與不同數目及位置點相連的 255種排列組合時的尤
拉數。分別對照刪除前與刪除後，每個該候選點的鄰接點的尤拉數的一致性，來確定是否可刪除候選
點，其表示刪除該點不會對物件或周圍產生拓撲結構的改變。 
多方向搜尋暗圓切面 
在第一年計劃中，我們提出平坦暗色圓切面搜尋法，以在三維空間中建立管狀物。該方法在直角
座標系的三個切面進行搜尋。當管狀物的方向不與此三切面成平行時，圓形切面在其中數個切面上會
呈現出橢圓外型。然而橢圓的長短軸比 ry/rx在重建的過程中並沒有被保留，因此在建立拓樸結構時，
並沒有客觀的排除圓切面重疊時該有的一致性．透過區域性多方向搜尋，可以把類橢圓比改為正圓度
比。  
多方向性搜尋的方法是將每次擷取的區域進行細線化後，再由中心線的末端取得極座標的 81 個
方向，分別為與直角座標 x軸為旋轉方向分割出 9個在𝜑 ∊ (-𝜋,𝜋)的方向，以及直角座標 y軸為旋轉
方向分割出 9個在𝜃 ∊ (-𝜋,𝜋)的方向，z方向的角度𝜓為零。 
 每個方向可產生固定深度 17 的(17x17)切面的立方體。由於管腔內外 HU 值的差異，初次的 RG
可擷取主支氣管。剩下附著的旁支皆為細小支氣管，其內腔的 HU值也因管壁影響而偏高。這也是在
第一階段的 RG無法滲透到小支氣管的主要原因，利用(17x17)切面的末端切面進行平坦暗圓切面，可
獲得區域性的管狀區域。再次計算新獲得的中心線並在每個末端點放入 seed point，進行區域成長後
再繼續前進，涵蓋了整個球體的 81個方向，新產生的末端點也會包含原來的方向，需要加以判斷及
排除。 
從orthogonal cross sections尋找圓盤，再堆疊的方式與目前嘗試將搜尋範圍侷限在中心線的末端，
再尋找區域圓盤並堆疊或區域成長，這兩者有相同的意涵，擷取圓形面並重組成管狀物。 雖然端點
的周圍在多切面上可能也瀰漫著類橢圓雜訊，但是透過 connected component便可排除。但若中心線
沒有涵蓋到細支氣管，在往後的迭帶步驟中也不易出現是此方法的缺點。因為 PVE 及管壁厚度變薄
的影響下，從初步的區域成長得知，軟組織的容限值 𝜆𝑚𝑖𝑛 ,  𝜆𝑚𝑎𝑥 並非全區域的固定值。進行區域性搜
尋與成長，我們可以動態的根據末端種子點的灰階值調整此參數。 
 
C. 基於形態動態之三維胸腔電腦斷層影像肺血管腫瘤偵測演算法 
由於 3D CT影像比 2D CT影像擁有較完整的形態資訊，因此利用 3D形態特徵的 CAD演算法確
實在偵測率上有所提高。根據上述Messay等人(Messay et al., 2010)提出一個較佳的肺腫瘤 CAD演算
法，可以達到 83.66%的靈敏度與平均一組 CT掃描產生 3個 FPs，但對於臨床醫師診斷上的幫助仍然
有其一定的限度。我們提出一個利用 3D胸腔 CT影像的 CAD演算法能夠提高肺腫瘤偵測的靈敏度及
減少 FPs的產生。為了達到這個目的，我們的方法採取三個階段的處理：第一個階段從胸腔 CT影像
分割出肺部的區域並在肺區中進行 3D血管的重建；第二階段，首先利用肺部區域的 CT影像扣除 3D
血管影像的遮罩後，偵測出懸浮在肺區血管周遭的腫瘤；在利用我們提出的規模矩陣 (Size Matrix) 篩
表 C012A                                                                         共 95 頁  第 22 頁 
第一階段腫瘤特徵萃取 
    第一階段，針對所有形態的肺腫瘤進行偵測，於每一個 VOI的血管形態中萃取出五個形態特徵，
如以下特徵： 
1. 大小 (Size, S)； S可以估計 VOI內血管的大小粗細。 
2. 大小差值 (Size Difference, SD)； SD為疑似腫瘤位置與周遭之間規模指數的差距，若 SD值越大，
代表 VOI內含有腫瘤的可能性越大，反之，表示 VOI內為血管可能性越高。 
3. 分支數 (Branch Number, BN)； BN為計算 VOI內的分支數。 
4. 平均 CT值 (Mean of HU, MH)； MH為計算 VOI內血管位置 CT值的平均。 
5. 形狀係數 (Shape Coefficient, SC)； SC值可以約略判斷 VOI內血管的形狀。 
第二階段腫瘤特徵萃取 
    第二階段，主要偵測第一階段遺漏的小腫瘤，於每一個 VOI的血管形態中萃取出五個形態特徵，
其中包含 S、BN和 MH，在上述已定義，因此不再重複定義。 
1. 判斷凸起物 (Judge Raised Object, JRO)； JRO是判斷 VOI內血管上是否含有凸起的部分。 
2. 凸起點 CT值 (Raised Point HU, RPH)； RPH為 VOI內判斷含有凸起物體時，將凸起位置的末端
點 CT值記錄下來，若 越大時，表示為腫瘤，反之，越小時則為血管。 
分類器 
 根據形態動態法的定義，VOI 內，利用 CTMT 形成各種不同的血管形態，並萃取每一種形態的
形態特徵，當做分類器的輸入參數進行分類。我們CAD演算法所使用的分類器是根據決策樹 (Decision 
Trees, DT)。DT由數個節點所組合而成，再由節點分出數個分支。節點代表所有的對象，而每一個分
岔路徑則代表某個對象的屬性值，路徑的終點表示對象的決策值。 
    我們提出的CAD演算法中，第一階段偵測腫瘤的分類器，輸入參數值包含形態特徵 S、SD、BN、
MH和 SC。由於附著腫瘤於肺區中不同位置產生的形態不盡相同，在所計算出的形態特徵中，根據
BN值的不同，分成三個分類器進行分類。每一個分類器中，針對另外四個參數值個別給予一組可能
的變數值，利用訓練資訊 (Training Data)，透過成本函數 (Cost Function) 的計算，得到每一個參數中
最佳的參數值。  
    我們訓練參數的成本函數設定為 measureF −β ， measureF −β 定義為精確度 (Precision) 與回收率 
(Recall) 的調和平均數 (Harmonic Mean)，如下所示： 
                             RecallPrecision
RecallPrecision)1( 2
2
+
⋅
+=
β
ββF                        (II.1.C.1) 
其中 β為正實數，Precision和 Recall定義為： 
                           PositiveFalsePositiveTrue
PositiveTrue
+
=Precision
                 
 (II.1.C.2) 
表 C012A                                                                         共 95 頁  第 24 頁 
2. 面積比(Area Ratio) 
  面積比是用來衡量候選腫瘤突出肺壁的程度，Area Ratio≥1，面積比愈大表示愈突出，則愈有可
能是腫瘤，其定義為 Area Ratio = 候選腫瘤的表面積 / 候選腫瘤附著肺壁的面積。 
3. Sigma13 
  Sigma13是表示候選腫瘤，經由主成份分析(Principle Component Analysis, PCA)計算後，最長的主
軸與最短的主軸之比，Sigma13≥1，其值愈小表示愈接近球形，則愈有可能是腫瘤。 
4. 體積(Volume)  
  計算該候選腫瘤的大小(mm3)。先求出候選腫瘤的個數(voxel number)，再乘上各軸的尺度轉換因
子。 
5. 體積比(Volume ratio) 
  由於候選腫瘤是 Fuzzy C mean最亮的前二類所組成，將其最亮的第一類所佔的體積，與次亮的
第二類所佔的體積相比，定義為體積比。 
  整個偽陽性去除步驟為，首先判斷 candidate的不變矩M21是否小於 THM21，當M21值愈大，其
形狀有可能是薄片狀、長條狀；而 M21 值愈小，其形狀愈集中，較接近圓球狀，才是我們初步要篩
選的腫瘤形狀，接著使用面積比(Area Ratio)及體積(volume)的特徵，來找出腫瘤。 
  當M21 > THM21時，表示該 candidate的外形屬於較複雜的形狀，有可能是因為週遭相連了較淡
的組織，這時我們就會把 candidate 進行分解後，再判斷是否為腫瘤。在判斷分解的情形，是因為
candidate 相連了較淡的組織，所以其體積比會較小且體積較大，故可作為判斷分解的條件。如果該
candidate判斷後不需分解，則有可能是與血管相連的腫瘤，才會造成外形複雜的形狀。因此，判斷該
candidate是否與血管相連，若相連，則為腫瘤。 
 
  
表 C012A                                                                         共 95 頁  第 26 頁 
3. 肺腫瘤邊緣偵測演算法 
肺癌在美國和台灣為主要的癌症死因之一(Cancer Facts and Figures 2009)，且它的存在通常都是藉
由肺結節的鑑定所標示出。於臨床試驗中，放射科醫師經常藉由觀察連續時間點之電腦斷層影像來量
測腫瘤體積大小與其髓時間的變化用於診斷與治療的目的(Reeves et al., 2006)。最主要的目的為提供有
價值之資訊於腫瘤良惡性的分類、癌症癒後的預測和治療療效的評估(Petkovska et al., 2007)。然而，
由於肺結節之體積、灰階值與形狀之範圍差異較為廣泛，尤其當其附著於其他組織或是被相似亮度的
組織所圍繞(例如：血管)，使得肺結節的分割為一困難的課題(Kawata et al., 1997)。目前肺結節的分割
演算法大致上可分為兩類：基於灰階值(intensity-analysis-based)(Wang et al., 2007; Diciotti et al., 2008; 
Mullally et al., 2004)與基於形狀(shape-analysis-based)(Kostis et al., 2003; Kuhnigk et al., 2006; Way et al., 
2006)。儘管上述研究提出了許多方法，由於肺結節型態的多樣性並常附著於周圍組織，精確的肺結
節分割演算法仍為一個尚待解決的難題。 
Automatic Nodule Boundary Detection 演算法 
一般來說，腫瘤偵測結果只提供粗淺的資訊，若要準確的判斷腫瘤之良惡性，則必須要針對腫瘤
影像，描繪出腫瘤的形狀，來增加電腦輔助診斷之準確率。因此利用偵測後所得到的粗淺資訊作為下
一步影像分割技術的先驗知識。基於圖論之半自動(graph based semi-automatic)腫瘤分割演算法已經被
證明能夠準確地測量電腦斷層掃瞄影像中之腫瘤大小。為了確定基於圖論演算法之有效性，詳盡地量
化驗證步驟是非常重要的。在此計畫中，我們使用已知肺結節位置與輪廓資訊之電腦斷層掃描影像，
針對一種基於區域成長與合併與四種不同之基於圖論之半自動影像分割演算法，提出一定量與定性分
析研究。這五種分割技術為 Statistical Region Merging (SRM)(Nock et al., 2004)、Random Walks with 
Restart (RWR)(Kim et al., 2008)、GrowCut (GWC)(Vezhnevets et al., 2005)、Nonparametric Higher-Order 
Learning Technique (NHO)(Kim et al., 2010)和Multiscale Normalized Cuts (MNCT)(Cour et al., 2005)。 
本研究嘗試將 Statistical Region Merging (SRM)(Nock et al., 2004)、Random Walks with Restart 
(RWR)(Kim et al., 2008)、GrowCut (GWC)(Vezhnevets et al., 2005)、Nonparametric Higher-Order Learning 
Technique (NHO)(Kim et al., 2010)、Multiscale Normalized Cuts (MNCT)(Cour et al., 2005)應用至肺腫瘤
邊緣輪廓之擷取，以下分別描述其演算法原理。 
Statistical Region Merging (SRM) 
區域合併基於統計方法(Statistical region merging, SRM) (Nock et al., 2004)是一項依據區域成長與
合併之概念所研發之彩色影像分割技術。SRM 將影像分割視為推論問題，此時影像本身將視為由部
分區塊所組成之影像的觀察值。因此，即可重建這些部分區塊的區域群組。SRM演算法的優點包含：
簡單、計算效率高，且在不使用任何色彩空間轉換模型(color space transformations)下，仍可達到絕佳
的分割結果。 
令 I 為所觀察的影像，含有 | I |個像素，每個像素都由 R、G、B 三原色所組成，其範圍介於{0, 
1, . . . ,g-1}，其中 g = 256，且影像為 24-bit，每個顏色各為 8-bit。I*代表觀察影像 I的真實影像，其
每一個像素皆可由 I的 R、G、B 所建構而成，而 I*中符合最佳結果之統計區域須滿足同質性，即位
表 C012A                                                                         共 95 頁  第 28 頁 
標籤為 
                           
arg max ( | ) arg max ( | )
k k
i k i i kl l
R p l x p x l= =
                     
(II.3.5) 
其中， 
                              1
( | ) ( )( | )
( | ) ( )
i k k
k i K
i n nn
p x l p lp l x
p x l p l
=
=
∑                           
(II.3.6) 
令 1{ , , }( )k k k kk
l l l l
MX x x X X= ⊂ 為 Mk個標籤為 lk的種子點群，則相似度機率 ( | )i kp x l 定義為 
1
1( | ) ( | , ) ( | )k k kM l li k i m k m kmp x l p x x l p x lZ =
= ∑  
                                   1
1 ( | , )k kM li m km
k
p x x l
Z M =
=
× ∑                        
(II.3.7) 
其中，Z為一正規劃常數。於 RWR (Kim et al., 2008)中， ( | , )kli m kp x x l 表示為穩定狀態(steady state)機率
kl
imr ，其定義如下所示： 
                                 
1
(1 )P r
(I (1 )P)
Q
k k k
k
k
l l l
m m m
l
m
l
m
r c cb
c c b
b
−
= − +
= − −
=                             
(II.3.8) 
其中， 1[ ]k
l
m i Nb b ×= 是N維向量。當 k
l
i mx x= 時， 1ib = ，否則 0ib = 。過渡矩陣(transition matrix) 
1P D W−= × ，
W為相似度矩陣，而 1 1D ( , , ),
N
N i ijj
diag D D D w
=
= =∑ 。 
 因此，給予不同的種子點群，可得到影像中每個像素對於每一群種子點的機率，將擁有最大事後
(posterior) 機率的標籤指定給此像素。 
 
Cellular Automata Segmentation 
 細胞自動機是由一些特定規則的格子所組成，每個格子看做是一個細胞，在此將細胞視為影像中
的像素(pixel)或體素(voxel)。每一個細胞可以具有一些狀態，但是在某一時刻只能處一種狀態之中。
隨著時間的變化(我們稱作「疊代」過程)，格子上的每一個細胞根據周圍細胞的情形，按照相同的法
則而改變狀態，換句話說，一個細胞的狀態是由上一個時刻所圍繞的細胞的狀態所決定。以人工生命
的角度來看，細胞自動機可以視為一個讓許多單細胞生物生活的世界，在我們設定好這個世界的初始
狀態之後，它們便按照同一個規則做演化。 
 一個細胞自動機由三個部分所組成 CA = (S, N, δ)。其中，S為非空的細胞狀態集合，N為細胞活
動空間的鄰近區域系統，而 δ: SN →S為細胞改變狀態的規則，在給定 t時間點的鄰近細胞狀態下，定
義 t+1 時間點的此細胞現階段的狀態。此報告中，我們所使用的鄰近區域系統 N 為 von Neumann 
表 C012A                                                                         共 95 頁  第 30 頁 
為了同時預測像素與其相對應區域之相似度(likelihoods)，首先，將像素與其相對應區域視為節點，建
立多層圖(multi-layer graph)。接著，分別建構像素與其相對應區域相似度之成本函數，透過最佳化求
解之方法，求得最後分割結果。以下分別依序敘述其相關步驟。 
圖形建構 
多層圖(multi-layer graph) G = (V,E)由節點 V = {X,Y}和鄰邊 E = {EX,EY,EXY}所組成。其中，X代表
像素，而 Y 為其相對應區域之節點。EX為連接相鄰像素的集合，而 EY為連接相鄰區域的集合，EXY
則為連接像素與其相對應區域的集合。 
相似度之成本函數 
於互動式影像分割中，使用者首先會標示某些像素點 X*，作為標籤資訊。根據此種子點群，將其
所屬之標籤指定其座落的區域內。接著，透過下列兩組成本函數，可預測像素與其相對應區域之相似
度。像素相似度 lΠ 屬於標籤 l之成本函數
X
lJ 為 
                           
2
, , , ' '
, ' 1
* 2 2
1 1
( )
( ) ( )
X
X X
N
X X X X X
l l P l U l H ii il i l
i i
N N
X X X
i i il il i il il
i i
J w
d d
ε ε ε π π
λ π π µ π π
=
= =
= + + = −
+ − + −
∑
∑ ∑
                
 
(II.3.15) 
其中， '' 1
XNX X
i iii
d w
=
= ∑ ，而 Xw 為像素之間的相似度矩陣。如果 *ix X∈ ， Xiλ λ= ，否則為 0。而如果 ix 之
標籤為 l， * 1ilπ = ，否則為 0。相似度 1
YN XY
il ik klk
p zπ
=
= ∑ ，而 1/
YNXY XY XY
ik ik ikk
p w w
=
= ∑ ， XYw 為像素與其相對
應區域之間的相似度矩陣。區域相似度 lZ 屬於標籤 l之成本函數
Y
lJ 為 
                            
2
, , , ' '
, ' 1
* 2 2
1 1
( )
( ) ( )
Y
Y Y
N
Y Y Y Y Y
l l P l U l R kk kl k l
k k
N N
Y Y Y
k k kl kl k kl kl
k k
J w z z
d z z d z z
ε ε ε
λ ε
=
= =
= + + = −
+ − + −
∑
∑ ∑
                  (II.3.16) 
其中， '' 1
YNY Y
k kkk
d w
=
= ∑ ，而 Yw 為區域之間的相似度矩陣。如果 *ky Y∈ ， Ykλ λ= ，否則為 0。而如果 ky
之標籤為 l， * 1klz = ，否則為 0。相似度 1
XN YX l
kl ki ii
z p π
=
= ∑ ，而 1/
XNYX YX YX
ki ki kii
p w w
=
= ∑ 。 
最佳化求解 
為了求得最佳解，令 XlJ 和
Y
lJ 分別對 lπ

和 lz

之微分為 0，且 [ ; ]l l lu zπ=
  
，可得 1 *(I (I ) )l lu u
−= − −Ω Π Ω
   
其中， 
表 C012A                                                                         共 95 頁  第 32 頁 
給予一個權重矩陣 W，多階正規化劃分準則(multiclass normalized cuts)嘗試極大化 K 類鏈接比
(linkratio)的平均： 
                      ∑∑
∑
∑
= ∈∈
∈∈
=
===Γ
K
l VjVi
VjVi
K
l
l
K
VNC
l
ll
jiW
jiW
K
Vlinkratio
K 1 ,
,
1 ),(
),(1)(1)(ε              (II.3.23) 
此準則所產生的劃分具有在群組內產生緊密的關連性與在群組間產生鬆散的關連性之特性，並使用劃
分矩陣 KNX × 來表示
K
VΓ 是由K類群集所聚集而成。其中， ],,[ 1 KXXX = 且



∉
∈
=
l
l
Vi
Vi
liX
0
1
),( 。由於
每一個節點最終只能歸屬於某一群，所以須滿足 NKX 11 = ( d1 代表dx1維全部為1的向量)。 
有了正規化劃分之準則與群集約束可得： 
                               ∑
=
=
K
l l
T
l
l
T
l
DXX
WXX
K
Xm
1
NC
1)(  aximize ε                      (II.3.24) 
                               { } * *subject to   X 0,1 , 1 1
N K
K NX
×
∈ =                     (II.3.25) 
                                0CX =                                           (II.3.26) 
其中， * SSN N= ∑ 。 
為了使式(II.3.24)易於處理，首先引進調整劃分矩陣(scaled partition matrix) Z： 
                               2
1
)(
−
= DXXXZ T                                    (II.3.27) 
於是上述方程組可改寫為： 
                           )(
1)(  aximize NC WZZtrK
Zm T=ε                          (II.3.28) 
                           Tsubject to  KZ DZ I=                                  (II.3.29) 
                                     0CZ =                                      (II.3.30) 
此方程組是一個限制式特徵值問題可藉由線性代數求解，詳細步驟請參閱(Cour et al., 2005)。 
 
  
表 C012A                                                                         共 95 頁  第 34 頁 
- 大部分存在的特徵(例如：曲率、圓形等)皆取決於腫瘤分割演算法之準確程度，造成臨床醫師使用
上的困難。 
本研究主要目的為解決上述限制，使得小腫瘤之評估具有一致性。 
實驗資料與方法 
 Lung Image Database Consortium (LIDC)是目前已公開中最大的肺結節電腦斷層掃描影像的資料
庫。針對此持續不斷更新的資料庫，Tan等人(Tan et al., 2010)提出一新的且詳盡之分析工具，目的為
協助研究者們能夠最佳地使用此資料庫進行肺癌的相關研究，其功能包含：呈現手繪腫瘤邊緣之輪廓、
計算與總結被註記腫瘤之體積、針刺狀程度(spiculation level)、伸長(elongation)等。於肺腫瘤影像特徵
擷取中，本研究採納來自 LIDC資料庫中 97組具有完整註解資料 。根據上述幾何與診斷相關的特徵，
於 242顆腫瘤中，(1) 221 (91%)其長軸長度(principal axis length)小於 20mm；(2) 77%的腫瘤，其惡性
評比介於 2和 4中。只有 13%的腫瘤被視為較嚴重的惡性程度，其惡性評比大於等於 4。 
為了突破過去肺 CT 腫瘤良惡性判別之準確性與特異性和針對不同肺 CT 腫瘤中多種型態(GGO
代表腫瘤是模糊的，Solid代表腫瘤是實心的，Mixed代表腫瘤兼具 GGO和 Solid之特性)之腫瘤良惡
性判別上的困境，在本計畫中我們將使用胸部電腦斷層掃描影像之肺腫瘤 pathological features和一般
features作為資料探勘之主要依據。為了達到擷取良惡性肺腫瘤特徵之全面性，Pathological features包
括 Gray Level Co-occurrence Matrix、Local Binary Pattern和 Shape Context (SC)、腫瘤輪廓之幾何特徵、
pleural indentation、calcification 和 cavity。在幾何特徵方面，主要根據本研究團隊過去在超音波影像
上針對乳癌所發展出的一組幾近不受影像系統參數影響的幾何特徵。雖然乳癌與肺癌在型態學上的特
性不盡相同，但是在量化型態學特性的經驗上卻是可以參考的他山之石。這組幾何特徵最重要的有四
個，分別是 number of substantial protuberances and depressions (NSPD)、lobulation index (LI)、
elliptic-normalized circumference (ENC)和 elliptic-normalized skeleton (ENS)。 
NSPD即顯著突出與內凹的數目，能有效地將腫瘤區分為平滑和非平滑(smooth & non-smooth)兩
大群組。類比於地理學(geographical)上的特徵突出(protuberances)與內凹(depressions)，分別相對於地
理學上的半島與灣。LI乃是嘗試描述出葉狀或突出之大小分佈狀況。 
ENC乃是以腫瘤之等效橢圓周長正規化值的腫瘤周長，它可以代表腫瘤輪廓延著等效橢圓蜿蜒的
程度。等效橢圓的面積和質心皆與可疑病灶相等，藉由 second-order central moments計算出等效橢圓
之長軸傾斜角度。 
ENS則是腫瘤之 skeleton長度值之正規化，其正規化之方式乃是將 skeleton的點集合個數除以等
效橢圓的長度。由於這些特徵乃是根據腫瘤的幾何形態表現上的特徵，因此相對於 texture 的特徵，
比較不受到系統參數以及灰階值偏移效應( bias )的影響，當處理到各家機器所產生的影像，會有著比
較穩定性的表現。 
在本計畫中，我們將著重於尋找描述 3D 肺腫瘤之 spiculation、lobulation、表面不規則度與複雜
度等型態學特徵。由於 NSPD、LI、ENC與 ENS在 2D CAD下的優異表現，其中列入考慮的四個重
要 3D 型態學特徵則是相對於這四個 2D 特徵的 3D 版本，暫定名為 NSPD-3D、LI-3D、ENC-3D 與
表 C012A                                                                         共 95 頁  第 36 頁 
Sharpness 區域性影像特徵 
 相對於 region size數學影像特徵著重於描述粗糙度，sharpness數學影像特徵則嘗試捕捉惡性腫瘤
的邊緣在 CT 影像中，通常顯得比較不 sharp 的特性。要量化此一特性，直覺的方法是腫瘤邊緣之緊
鄰內外側的灰階對比度。可能的方法有二：其一，以腫瘤輪廓為中心線之帶狀區域，計算此帶狀區域
中，腫瘤內與腫瘤外的灰階值的平均值的差，作為腫瘤邊緣的對比度。其二，計算腫瘤輪廓上每一點
延著法向量的灰階梯度，以所有灰階梯度的平均值代表腫瘤邊緣的對比度。 
肺腫瘤 pathological features 
肺腫瘤區塊描述的一個重要方法是量化它的紋理內容。雖然不同肺 CT 腫瘤中多種型態(GGO 代
表腫瘤是模糊的，Solid代表腫瘤是實心的，Mixed代表腫瘤兼具 GGO和 Solid之特性)的紋理定義並
不存在，但是對比於肺部常見的組織，直覺上這些腫瘤是可能透過一些區域描述子所提供的諸如平滑
度、粗糙度和一致性等性質的測量。本報告所用來描述肺腫瘤區域紋理的三種主要方法為灰階共生矩
陣(Gray Level Co-occurrence Matrix)、區域二維特徵(Local Binary Pattern)和形狀內容(Shape Context)。
灰階共生矩陣主要用為得到像平滑、粗糙、紋理等特性的表徵。區域二維特徵為灰階不變結構的統計
量，不易受物體灰階變化、旋轉和平移的影響。形狀內容的作用為描述 ROI中肺腫瘤邊界點附近的特
徵分布狀況。以下將針對各個特徵擷取演算法做詳細的描述。 
Gray Level Co-occurrence Matrix (GLCM) 
大多數基於統計的紋理測量方法僅僅利用直方圖，卻並未考慮像素之間相對關係的資訊。為了結
合此兩種重要的資訊，Haralick (Haralick, 1973)提出灰階共生矩陣，主要透過選擇像素間的相對位置
計算其出現的頻率，建構二維矩陣並以統計指標量化此局部紋理特性，用於檢測指定的紋理圖樣。其
原理簡述於下。 
設 n是影像中滿足位置運算子 Op的總數。令 /ij ijp M n= 為滿足位置運算子 Op的一對像素的聯合
機率的一個估測值。在得到機率矩陣 p後，我們採用下列五種統計指標作為肺腫瘤區域的局部紋理特
性分析。 
1) Contrast：用以描述影像中的對比程度。當影像區域對比越明顯，則其值越高，其函式定義為：  
                                   
( )
1
2
, 0
k
ij
i j
p i j
−
=
−∑
 
                               (II.4.1) 
2) Inverse difference moment：亦稱為 Homogeneity。測量影像的均勻程度，其函式定義為： 
                                   ( )
1
2
, 0 1
k
ij
i j
p
i j
−
= + −
∑
                                
(II.4.2) 
3) Angular second moment：亦稱為 energy。可用為量化區域影像灰階質分佈之一致性。當其值較
高時，代表此區域為平坦或是具有周期性的變化，其函式定義為： 
表 C012A                                                                         共 95 頁  第 38 頁 
5. 肺腫瘤生長速率之追蹤與預測 
隨著電腦斷層掃描技術的進步，電腦斷層應用於肺部腫瘤的篩檢與追蹤也日漸普遍，臨床醫師需
依據多次於不同時間點掃描之電腦斷層影像觀察腫瘤大小體積是否有變化。然而，由於每次掃描病人
的狀況與呼吸深度頻率的不同造成影像上的腫瘤位置有所變動，造成臨床醫師診斷上的困難性，由其
當部份腫瘤與其他解剖構造，例如：血管、心臟甚至是橫膈膜互相重疊時更是無法估算出腫瘤的生長
速度。因此提出三維多時間點的影像對位方式希望藉由電腦輔助的方式節省時間與人力成本，並且提
高判定腫瘤良惡性的準確率。 
目前已有許多學者提出針對於長時間追蹤肺腫瘤之影像對位方法的研究，例如：Betke等人(Betke 
et al., 2001)利用胸骨與脊柱解剖構造的特徵點方式對位。Hong等人(Hong et al., 2002; 2008)提出多維
的表面對位技術與提出整體性肺部初始對位與局部性肺腫瘤對位的概念。Smeets 等人(Smeets et al., 
2010)提出利用肺臟中血管樹的特徵最維對位技術的依據。結合上述各研究的概念後，本研究將提出
以胸腔骨頭之骨架化為主軸的三維對位技術。 
方法 
本實驗材料來自於台灣大學附設醫院提供的 GE電腦斷層系統影像，影像掃描參數為(axial view, 
120kVp, 100mAs)，每張影像的厚度為1.25mm。在此我們將第一個時間掃描的影像視為對位參考影像；
第二個時間掃描的影像視為被校正影像。對位技術方法依照流程圖依序敘述。 
分割與重建 
從二維影像中使用本計畫中之肺區截取技術之將人體身軀影像取出後，並利用電腦斷層影像之特
質不同窗值可以觀察到影像中不同的目標，在此需調整特定窗值觀察骨頭，此骨視窗設定為 WW = 
350HU、WL = 254HU。再利用 thresholding方式，灰階度大於閥值的區域留下，反之，小於閥值的區
域則刪除。所以會得到一些零碎的影像。可以利用形態學的影像處理，將其破碎的區塊填滿，太小的
區塊可視為雜訊則利用侵蝕的方式去除並斷開不相關結構的連結。 
上述步驟的輸入皆為二維影像，待皆通過上序步驟後的結果則可於三維空間中堆疊，並使用 18
連通的方式(18 connected components) 將肋骨主結構分割出。 
骨架化 
為了取出將肋骨的主體結構並有效地減少資料點之數量，所以需要骨架化的步驟。利用不同軸向
的想法將三維肋骨結構投影至不同二維平面(x-y plane, y-z plane, x-z plane)上，再計算二維平面上不同
區塊的重心點的位置，使用三維 18 聯通方式將其不同軸向上的區塊重心交集後重建於三維空間中，
分割出胸腔骨頭主要結構。 
對應點的選取 
對位通常是指兩個物體外形，一個稱做為來源(source)及另一個則為目標(target)，為了找出理想的
轉換式(rigid transformation)，進一步針對兩個物體進行對位。而轉換式的建立基礎則必須找出兩組資
表 C012A                                                                         共 95 頁  第 40 頁 
                             
( ) ( )
( ) ( )
( ) ( )
12 1
21 2
1 2
0
0
0
n
n
n n n n
U r U r
U r U r
K
U r U r
×
 
 
 =
 
 
  


   

                     
(II.5.6) 
ij i jr P P= − 代表原始影像兩對應點的間距。 
                                 
1 1 1
2 2 2
4
1
1
...
1 n n n n
x y z
x y z
Q
x y z
×
 
 
 =
 
 
 
  
                            
(II.5.7) 
求出所有參數後，再代入薄板仿樣法的二維轉換關係式便能將原始影像座標轉換成受力後之扭曲座
標。 
誤差量測 
為了量化影像資料對位校正前後，肺腫瘤位於參考影像中的位置差異性。其量測方式為固定同一
個腫瘤，利用對位校正前後之肺腫瘤的重心位置計算歐式距離後再計算兩者的差異。 
 
  
表 C012A                                                                         共 95 頁  第 42 頁 
CT 影像區塊，並同時呈現多個時間點相同 CT 影像區塊的影像，讓醫師藉以偵測腫瘤之存在以
及判讀可能的變化。 
 相較於原始計畫書中的氣管重建與分割演算法，在第二年計畫中我們所提出的修正演算法將氣管
內壁與外壁資訊的重要性大幅提升。原先，CAVD可以藉由已知的資訊，標記或去除血管、氣管或是
其他組織，或是將早先已知的腫瘤資訊帶入，快速突顯可能腫瘤的存在，因此只須達到約略氣管的重
建即可。但在第二年計劃的經驗中，氣管的資訊獲取，已成為是否會移除依附在氣管邊緣候選肺腫瘤
的重要關鍵，因此氣管不但要重建還要有高品質的分割，以得到精確的氣管的資訊。 
 
  
表 C012A                                                                         共 95 頁  第 44 頁 
材料與方法 
本實驗材料來自於台灣大學附設醫院提供的 GE電腦斷層系統之灌注影像。將欲掃描之目標區域
分為八層軸向影像(axial view, 120kVp, 100mAs)，每張影像的厚度為 5mm。當受測者注射入顯影劑(此
顯影劑以碘類為基礎)時，機器開始進行取像，八張為一組。本實驗所實用影像之掃描協定有兩種類
型。type 1 總掃描時間為連續四分鐘。前第一分鐘，每一秒取一組影像；之後的三分鐘，每隔十秒取
一組。Type 2 總掃描時間為連續的九十秒鐘，每一秒取一組影像。 
完成腫瘤對位校正後，我們利用手動圈選腫瘤感興趣區域 ROI後進行區域的灌注性參數分析。根
據本實驗所使用的影像資訊之掃描協定，我們採取相同影像掃描協定之 Schaefer等人(Schaefer et al., 
2006)探討孤立肺結節中灌注性影像之訊號與腫瘤新生的意義中分析 time-intensity curve 訊號的
model-free參數定義。 
1. Percentage increase in signal intensity (SI%)代表以最高的訊號減最低的訊號後除以最低訊號的
一種相對訊號關係。
                           
 
2. Early peak (EP)代表前三十秒時間中最大的顯影訊號值。 
3. Maximum peak (Pmax): 代表所有時間中最大的顯影訊號值。 
4. First transit slope (wash-in slope): 指的是顯影訊號值早期快速上升至 early peak(EP)的斜率，其代
表組織血管的擴散速度。  
5. Washout phase (wash-out slope) 為評估 early peak(EP)到第六十秒的時間訊號值下降的斜率，其
代表組織間代謝的速度。 
6. Mean enhancement (Emean%) 為顯影訊號平均值，此可以代表著不同組織間的密度。 
7. The initial area under the intensity–time curve (IAUC)代表訊號由零達到第六十秒時間的這一段
曲線下的積分面積。 
以上各參數都可以視為灌注性影像的特徵。除此之外，除了灌注性參數特徵可應用於大區域的
ROI分析外，我們將利用感興趣區域中的組成各單一像素於不同時間所組成的顯影劑流動變化視為
intensity–time curve並結合灌注性參數分析的材料，進行腫瘤組織中組織組成成分的分析。 
在此組成成分的分析是利用聚類理論(clustering algorithms)將所收集的資料加以分成不同的群別，
並能夠有效地表現出各類群占所有腫瘤成分的大小，希望能幫助腫瘤鑑別與診斷上提供更多的資訊。
在此我們增添 Area 與 Area Ratio兩個參數分別定義為各組之類別的大小面積與存在腫瘤中的比例。 
本實驗利用聚類理論中的模糊C-means分群法(fuzzy C-means clustering)(Dunn, 1973) 簡稱FCM，
乃是一種根據 C-means algorithm衍生而來的分群法，Bezdek(Bezdek, 1981)首先提出該方法，透過模
糊邏輯的概念，希望能進一步提升分群的效果。 
  
表 C012A                                                                         共 95 頁  第 46 頁 
軟體在真實運作條件進行測試，一些討厭的軟體行為會在這個期間內發生，並且讓引起問題的程式碼
被發現並且在大規模部署以前被修正完畢。 
驗證：為了驗證程式功能的正確性，需要捕捉在正式語言中，程式行為的模型或者是使用程式自
己本身的功能。在大多商業軟體的發展組織中，常常在發展中的程式是沒有任何正式規格的。正式的
驗證只有被產業軟體社團中的小部分於日常上使用（特別是在通訊協定驗證和內嵌系統或是醫療領域
上）。當驗證在實行時，系統設計的正式規格才與功能做比較。這個目的是讓程式碼確實和實際規格
所敘述的內容相符合。 
測試：對於軟體驗證而言，測試是十分必要的。在寫程式之前，設計的複審與程式碼的檢查需要
被完成。一旦程式碼撰寫完成，其他各式各樣依據在原始程式上的靜態分析方法，就可以被應用。各
種類的測試方法與測試步驟，其標的是在不同程度的整合和軟體錯誤的不同處理方法上。在較晚的步
驟進行的測試是（例如：外部功能測試、系統測試…等等）黑箱測試，它是以外部規格為基礎，因此
它不牽涉對實際程式碼細節之瞭解。一般來說，系統測試目標是在產品關鍵觀點上，例如：復原、安
全、壓力、績效、硬體組態…等等。生產與部署測試則是牽涉某種程度客戶可接受之標準的測試。很
多軟體公司將之定義為先期測試版程式（與客戶一起完成程式設計）。 
 為了維持我們所開發軟體的品質，我們皆依循上述軟體標準開發流程規範執行程式開發，以確保
所產出的軟體產品能夠可靠且有效率地執行，最終可以達到商品化的目標。  
表 C012A                                                                         共 95 頁  第 48 頁 
3. 氣管和血管的移除所造成肺門(Hilar)區域的不平整，如圖 III.1.A.4紅色圓圈所圈選區域。 
 
 
圖 III.1.A.2： 病灶造成肺實質硬化。 
 
 
圖 III.1.A.3： 左右肺相連。 
 
 
圖 III.1.A.4： 肺門區域的血管造成肺表面崎嶇。 
表 C012A                                                                         共 95 頁  第 50 頁 
 
圖 III.1.B.2。 
以圖 III.1.B.2為例，比較左圖全域性與右圖區域性橢圓暗面搜尋的結果，可以發現將方法由全域
性改為區域性的優缺點。如前言所敘，當氣管不斷的分岔延伸到肺泡曩。雖然氣管壁將壁內，如空氣
般的低密度區域與外界隔離，管壁的厚度卻隨著管徑變小而相對變薄而不明。搜尋細支氣管的難度在
於降低 Partial Volume Effect(PVE)的影響；該效應會使細小支氣管成為破碎的細線，也會讓 PVE造成
的雜訊被納入而造成溢出現象；然而過度的抑制雜訊會限制往下延伸的空間。 
 
a.  
 
表 C012A                                                                         共 95 頁  第 52 頁 
f.  
 
 
 
g.  
 
h.  
 
圖 III.1.B.1：全域性搜尋(左)；區域性搜尋(右)。 
 
未來三個月計畫 
氣管外壁偵測方法是基於前章節所得到的氣管內腔結果，再根據內腔的中心線建構出 ACM的起
始輪廓。然後根據影像的梯度向量流 Gradient Vector Flow (GVF)進行形變至氣管內壁。因而取得附著
在氣管內壁的幾何空間 geometric space網點．接著將這些網點設為前進至外壁的起始控制點，並且建
構出符合彈性關係的邊界元素模型．再次根據影像的梯度向量流，在達到內外能量平衡的最佳條件下，
進行形變至外壁。 
表 C012A                                                                         共 95 頁  第 54 頁 
 
圖 III.1.C.1：(a)(c)(e)為原 CT影像，(b)(d)(f)為(a)(c)(e)扣除血管位置後的影像，白色箭頭處為懸浮於
肺血管周遭的腫瘤。 
 
附著腫瘤的偵測 
    針對附著於血管上的腫瘤，在第一階段的偵測中，首先進行 VOIs 的選擇，在目前所使用的 76
組測試 CT 掃描中，一組 CT 掃描約產生 1,243~4,202 個 VOIs，總共產生 192,774 個 VOIs，當中 70
個為 TPs，192,704個為 FPs。根據放射科醫生的判斷，在 76組測試資料中共有 70顆直徑等於或大於
3毫米的腫瘤，所以在 VOIs選擇的程序中，我們的方法可以達到 100%的靈敏度，平均每一組 CT掃
描含有 2,537個 FPs。 
    我們利用形態動態法減少 FPs 的數量，每一個 VOI以 6個血管形態進行觀察，CTT個別設定為
50~500− 、 50~550− 、 50~600− 、 50~650− 、 50~700− 和 50~750− ，不同的 CTT 形成血管形態
表 C012A                                                                         共 95 頁  第 56 頁 
 
圖 III.1.C.2：各個腫瘤影像學特徵的靈敏度，(a) Subtlety；(b) Texture；(c) Malignancy。 
 
 
 
 
 
 
 
圖 III.1.C.3：FPs，(a)(b) 極大的血管分支處；(c)(d) 血管重疊處。 
 
未來三個月計畫 
 目前透過 LIDC數據庫的 76組 CT影像檢測我們所提出的肺腫瘤 CAD演算法，在靈敏度及錯誤
表 C012A                                                                         共 95 頁  第 58 頁 
 
圖 III.1.D.1：紅線區域為腫瘤的範圍，綠線區域為 Fuzzy C mean所找到 candidate的範圍。 
 
False Positive的部分，有以下幾種型式： 
• 是屬於肺壁上的突出物，但並不是腫瘤。 
 
圖 III.1.D.2：形式一。 
 
• 肺壁上並無實際的突出物，但在 fuzzy C mean的過程中被抓進來的 candidate。 
 
圖 III.1.D.2：形式二。 
448
170 180 190 200 210 220 230
280
290
300
310
320
330
447
170 180 190 200 210 220 230
280
290
300
310
320
330
351
360 380 400 420 440 460
280
300
320
340
360
380
400
284
50 100 150 200 250
150
200
250
300
350
400
378
250 300 350 400 450 500
200
250
300
350
400
130
100 150 200 250 300
150
200
250
300
350
表 C012A                                                                         共 95 頁  第 60 頁 
的結果則表示為 CA，其中紅色、藍色和綠色線條分別代表前景種子點、背景種子點和肺腫瘤之邊界
輪廓。Random Walks with Restart (RWR)與 Nonparametric Higher-Order Learning Technique (NHO)所需
之前景種子點與背景種子點分別標示為 FS(red)和 BS(else)。Multiscale Normalized Cuts (MNCT)中的顏
色區塊數目是人工指定，根據不同特性之肺腫瘤影像則會有數目上之差異。 
 
獨立懸浮 GGO 
 在本小節中將使用不同性質之獨立懸浮 GGO 肺腫瘤影像來呈現五種影像分割演算法的差異，其
不同性質影像分別為具有破碎邊緣與低對比，共兩類，如圖 III.3.1-3所示。 
 
 
圖 III.3.1：002. Type: GGO. Size: 33*34 pixels. Multiscale Normalized Cuts Segmentation: n=20。 
 
 
圖 III.3.2：Type: GGO. Size: 33*31 pixels. Multiscale Normalized Cuts Segmentation: n=30。 
 
表 C012A                                                                         共 95 頁  第 62 頁 
 
圖 III.3.5：Type: GGO. Size: 52*57 pixels. Multiscale Normalized Cuts Segmentation: n=30。 
 
 
圖 III.3.6：Type: Solid. Size: 177*197 pixels. Multiscale Normalized Cuts Segmentation: n=20。 
 
附著於肺壁上之 GGO肺腫瘤  
 在本小節中將使用附著於肺壁上之 GGO肺腫瘤影像來呈現五種影像分割演算法的差異，其不同
性質影像分別為具有低對比與內部灰階值分布不一致，共兩類，如圖 III.3.7-9所示。 
 
表 C012A                                                                         共 95 頁  第 64 頁 
 
圖 III.3.9：Type: GGO. Size: 217*283 pixels. Multiscale Normalized Cuts Segmentation: n=10。 
 
周圍連接著細微組織之 GGO肺腫瘤  
 在本小節中將使用不同特性之周圍連接著細微組織之 GGO肺腫瘤影像來呈現五種影像分割演算
法的差異，其不同特性影像分別為具有內部灰階值分布不一致與散佈多處之病灶，共兩類，如圖 
III.3.10-11所示。 
 
圖 III.3.10：Type: GGO. Size: 42*45 pixels. Multiscale Normalized Cuts Segmentation: n=10。 
 
表 C012A                                                                         共 95 頁  第 66 頁 
 
圖 III.3.13：GGO肺腫瘤附著於血管與肺壁上。 
 
討論 
為了降低肺腫瘤電腦斷層掃描影像的複雜程度，我們將處理範圍縮小至 ROI/VOI 中，且假設目
標物位於 ROI/VOI中間。一般來說，腫瘤偵測結果之輸出即可作為 ROI/VOI的主要參考資訊。在此
計畫中，藉由先前所研發之肺腫瘤偵測演算法可獲得肺結節位置與輪廓資訊，比較基於區域成長與合
併與基於圖論之四種不同類型的半自動影像分割演算法，提出定性與定量分析研究。於電腦斷層掃描
影像中，肺腫瘤之 Hu值明顯高於周遭的肺組織，所以本研究採取將統計分析融入區域競爭與合併之
SRM演算法。於各種不同形狀與類型之 GGO肺腫瘤例子中，透過 SRM可以很容易地擷取病灶之邊
緣輪廓，如圖 III.3.1-3所示。但是，肺腫瘤的形成大多數會依附在血管、支氣管或是肺壁上，導致 SRM
之分割結果會產生區域過度合併的現象。此外，根據統計準則制定之嚴謹程度，病灶細微區域容易被
視為背景。而由於MNCT同時處理不同階層(解析度)同一影像所構成之圖，可捕捉到粗糙且細緻之影
像細節，如圖 III.3.1-11 所示。但是，當分群數目設定過大時，同樣也會產生區域過度合併的現象，
所以針對不同類型之影像需要調整適當的分群數量。 
RWR 為建構於貝式(Bayesian)架構下之生成影像分割演算法模型(generative image segmentation 
model)。RW(Grady, 2006)與 RWR主要的差異在於像素到每一個標示的機率計算方式。RW採取最初
抵達機率(First arrival probability)，即像素到達的第一個種子點之機率值代表此像素歸屬於此種子點之
程度。而 RWR 則是考慮像素至所有種子點之平均機率(Average probability)，所以相較之下此方法較
不依賴於種子點之置放數量，且可以解決 weak boundary(如圖 III.3.6)和 texture(如圖 III.3.4)的問題。但
是，遇到前景與背景區域對比度較低(如圖 III.3.2、5、7、8、10 和 11)時，還是需要置入較為密集之
種子點群。當種子點之數目越多時，亦會提供 GrowCut 越多的資訊，分割結果如圖 III.3.1-11 所示。
對於病灶邊緣具有不規則形態時(如圖 III.3.3、III.3.10)，GrowCut 之分割結果常常具有平滑之特性，
此時可藉由限制細胞移動的方向來克服此缺點。 
表 C012A                                                                         共 95 頁  第 68 頁 
的形狀(11.98%)，就是幾乎呈現圓形(14.88)；(3) 178 (74%)個腫瘤其 PAL介於 3到 12mm之間；(4) 有
五個惡性腫瘤的惡性比例為 5，且 28個高度可疑的腫瘤的惡性比例為 4。 
 
表 III.4.1：於不同切面厚度下，病例和腫瘤的個數。 
Slice thickness 
(mm) 
  
No. of cases No. of nodules 
0.625 14 37 
0.75 1 2 
1 6 14 
1.25 3 12 
1.8 40 104 
2 8 16 
2.5 10 18 
3 15 39 
Total 97 242 
 
表 III.4.2：不同特徵下，腫瘤個數的分佈。 
Feature Value range No. of nodules Percent (%) 
Calcification [3, 4) 9 3.72 
 [4, 5) 4 1.65 
 [5, 6) 8 3.31 
 6 221 91.32 
Sphericity [1, 2) 0 0 
 [2, 3) 25 10.33 
 [3, 4) 99 40.91 
 [4, 5) 96 39.67 
 5 22 9.09 
Margin [1, 2) 14 5.79 
 [2, 3) 53 21.90 
 [3, 4) 49 20.25 
 [4, 5) 88 36.36 
 5 38 15.70 
Lobulation [1, 2) 102 42.15 
 [2, 3) 61 25.21 
 [3, 4) 39 16.12 
 [4, 5) 21 8.68 
表 C012A                                                                         共 95 頁  第 70 頁 
非腫瘤之肺部組織是非常困難的，且對於肺腫瘤的體積與形狀往往並沒有所謂的正確答案(ground 
truth)。因此，許多先前的研究整合多位放射科醫師的結果，將其視為參考標準。因此，透過本研究所
發展之互動式影像分割演算法，可以建立肺腫瘤相關形態資訊之參考標準。整體來說，透過對 LIDC
資料的分析，我們得到影像形態上的資訊和其與惡性和鈣化程度的關聯性。對所發展的肺腫瘤影像所
擷取之特徵是一個很重要的參考指標，未來如果在結合 perfusion 之功能性特徵，以期待有更佳的良
惡性辨別率。 
 
 
圖 III.4.1：形狀特徵與惡性腫瘤之關聯性。 
 
 
(c) (a) 
(b) (d) 
(e) 
表 C012A                                                                         共 95 頁  第 72 頁 
間中同樣的位置及可以幫助臨床醫師找到同一個肺腫瘤，以節省尋找肺腫瘤的時間。 
 
(a)  (b)  
圖 III.5.1：範例一之兩個時間點的影像。(a) 第一個時間點影像視為對位參考影像；(b) 第二個時間點
影像視為被校正影像。 
 
(a)  (b)  (c)  
圖 III.5.2：以二維方式驗證同一個腫瘤(紅框所示)之所在位置。(a) 為經過對位校正後的結果，腫瘤位
在第 60Z軸位置；(b) 為對位參考影像腫瘤位在第 60Z軸位置；(c) 需被校正影像未進行對位校正前，
腫瘤位在第 84Z軸位置上。 
 
 (a)  (b)  
圖 III.5.3：腫瘤(紅框所示)三維軸向面檢視兩個時間點的差異。(a) 圖為對位前；(b) 圖為對位後。 
 
表 C012A                                                                         共 95 頁  第 74 頁 
 (a)  (b)  
圖 III.5.7：腫瘤(紅框所示)三維軸向面檢視兩個時間點的差異。(a) 圖為對位前；(b) 圖為對位後。 
 
 (a) (b)  
圖 III.5.8：腫瘤(紅框所示)三維冠狀面檢視兩個時間點的差異。(a) 圖為對位前；(b) 圖為對位後。 
 
(a)  (b)  
圖 III.5.9：腫瘤(紅框所示)三維矢狀面檢視兩個時間點的差異。(a) 圖為對位前；(b) 圖為對位後。 
 
於範例一(圖 III.5.1)與範例二(圖 III.5.6)兩組長時間追蹤肺腫瘤之病例分別於間隔三個月的兩個時
間點掃描所得到的影像，第一個時間點都視為對位參考影像(reference)而隔三個月後的第二個時間點
則視為被校正影像(floating)，對於固定的一顆腫瘤於不同時間點掃描時，從軸狀(圖 III.5.3、圖 III.5.7)、
冠狀(圖 III.5.4、圖 III.5.8)與矢狀(圖 III.5.5、圖 III.5.9)方向都可以觀察出腫瘤位在肺臟的位置都不一
樣，但經過本研究提出對位技術校正後，肺腫瘤位置較為接近，且從常用的二維軸向影像(圖 III.5.2)
來檢視肺腫瘤於第一個時間點(參考影像)時是位在 Z軸方向第 60的位置上，在第二個時間點時位在 Z
軸方向第 84的位置上，而經過本研究提出對位技術校正後則位在 Z軸方向第 60的位置上。 
表 C012A                                                                         共 95 頁  第 76 頁 
圈選 ROI，可以看出兩者曲線的變動差不多，且經過差異的計算(如圖 III.7.1(b)) 兩者誤差大約在正負
1.5%左右。因此，本研究提出的對位技術的具有一定程度的可靠性。 
 
(a)  (b)   
圖 III.7.1：同一組影像資料進行兩種方式圈選 ROI所得到的 time-intensity curve。本實驗影像之資訊:
以第一個時間點的第三層面做為對位校正之參考影像，而其他時間點的影像則為需被校正之影像。而
圈選 ROI 的兩種方式為影像直接人為挑選相似影像之手動圈選 ROI 與影像經過對位校正技術後之手
動圈選ROI。左圖(a)為ROI量測後的 time-intensity curve；紅色代表人為視覺挑選影像之手動圈選ROI。
藍色代表經本研究對位校正技術之手動圈選 ROI。右圖(b)為左圖(a)中兩曲線資料的差異比例
(diff=before-after)。兩者誤差大約在正負 1.5%左右。 
 
灌注性影像經過對位校正去除掃描影像時病人呼吸狀況所產生的顯影劑訊號雜訊後，將進行肺腫
瘤灌注性參數分析與腫瘤細胞組織分析的流程，如圖 III.7.2與圖 III.7.2兩組範例顯示，圖 III.7.2(a)與
圖 III.7.2(a)代表影像對位校正前後其他時間影像與參考影像所計算的影像相似程度，對位校正後紅色
曲線明顯提高也較無校正前藍色曲線落差較大的波動出現。且從影像上觀察，如圖 III.7.2(b)與圖
III.7.3(b) 對位參考影像與圖 III.7.2(c)與圖 III.7.3(c)原始資料MIP (max intensity projection，最大投影，
將原始資料影像採取最大投影的目的是為了評估腫瘤於不同時間點在影像上的變化)影像，腫瘤型態
差異很大，而經過本研究對位校正技術後結果資料之MIP影像(如圖 III.7.2(d)與圖 III.7.3(d))也明顯與
圖 III.7.2與圖 III.7.3(b)對位參考影像較為相似。並且從顯影劑訊號值的觀點來看表中之圖 III.7.2(f)與
III.7.3(f) time-intensity curve經過對位校正後受 motion雜訊影像大為降低。 
 
表 C012A                                                                         共 95 頁  第 78 頁 
 (a)  (b)  
 (c)  (d)  
 (e)  (f)    
 (g)  (h)  
圖 III.7.3：範例二、灌注性影像分析流程(對位校正、參數分析、組織類別)結果。(a) 與參考影像計算
出的影像相似程度(紅色為校正後相似程度) 。(b)第一個時間點影像設定為對位參考影像。(c)原始資
料MIP (max intensity projection)。(d)對位校正後結果MIP (max intensity projection)。(e)灌注性分析ROI。
(f)比較 time-intensity curve (紅色為對位校正後)。(g)組織類別分析結果圖。(h)組織類別之 time-intensity 
curve。 
 
表 C012A                                                                         共 95 頁  第 80 頁 
 
 (a)  (b)  (c)  
圖 III.7.5：範例四、腫瘤組織類別分析。(a) 灌注性分析 ROI；(b) 組織類別之 time-intensity curve；(c) 
組織類別分析結果圖。 
 
表 III.7.2：範例四、腫瘤組織組織類別之灌注參數分析。 
Class_1 Class_2 Class_3 
IAUGC: 133.9195 
EP: 4.7873 
Tep: 25 
Pmax: 4.7873 
Tmax: 25 
washin: 0.1995 
washout: -0.0519 
Emean: 2.0941 
Area: 207 
AreaRatio: 0.0542 
IAUGC: 62.0308 
EP: 1.6334 
Tep: 26 
Pmax: 1.6334 
Tmax: 26 
washin: 0.0653 
washout: -0.0059 
Emean: 1.1181 
Area: 1466 
AreaRatio: 0.3836 
IAUGC: 119.6715 
EP: 3.1795 
Tep: 30 
Pmax: 3.1848 
Tmax: 31 
washin: 0.1074 
washout: -0.0059 
Emean: 2.2670 
Area: 2149 
AreaRatio: 0.5623 
 
再根據佔腫瘤組織成分的比例為基礎，將所有的已測試完成的病例進行統整，分為三大類:最大
比例(圖 III.7.6)、最小比例(圖 III.7.7)與中間比例(圖 III.7.8)組織。而其中，各種比例類別中又根據我們
目前實驗的灌注性影像的掃描協定的不同而分為 type1與 type2兩種。(type1指的是總掃描時間為連續
四分鐘(240 秒)。前第一分鐘，每一秒取一組影像；之後的三分鐘，每隔十秒取一組。Type 2 的總掃
描時間為連續的九十秒鐘，每一秒取一組影像。) 在不同 type1與 type2中進行統計分析 (如表 III.7.3、
表 III.7.4與表 III.7.5中灌注參數統計表) 與計算其比例類別的顯影劑訊號趨勢，如圖 III.7.6、圖 III.7.7
與圖 III.7.8中的紅色趨勢線。 
 
表 C012A                                                                         共 95 頁  第 82 頁 
 
 (a)  
 (b)  
圖 III.7.7：最小比例組織類別之 time-intensity curve趨勢。(a)為 type 1 總掃描時間為連續四分鐘。前
第一分鐘，每一秒取一組影像；之後的三分鐘，每隔十秒取一組。(b)為 Type 2 總掃描時間為連續的
九十秒鐘，每一秒取一組影像。 
 
表 III.7.4：最小比例組織類別之 time-intensity curve趨勢灌注參數統計表。 
Type 1(240s) 2 (90s) 
 mean std mean std 
IAUGC 343.794  195.606  326.462  341.983  
EP 13.038  8.841  11.054  13.263  
Tep 11.500  12.234  27.250  3.202  
Pmax 13.216  8.677  11.377  13.000  
Tmax 20.500  14.888  34.500  15.969  
washin 0.239  0.314  0.431  0.550  
washout -0.081  0.039  -0.085  0.110  
Emean 5.849  3.842  5.566  5.950  
y = 2E-09x5 - 1E-06x4 + 0.0002x3 - 0.0105x2 + 0.2477x + 799.02 
R² = 0.0108 
0 
100 
200 
300 
400 
500 
600 
700 
800 
900 
1000 
0 50 100 150 200 250 
in
te
ns
ity
  
time(s) 
Time-Intensity Curve---240s---carcinoma 
y = -7E-07x5 + 0.0002x4 - 0.0102x3 + 0.1962x2 + 2.1977x + 775.28 
R² = 0.058 
0 
200 
400 
600 
800 
1000 
1200 
-10 10 30 50 70 90 
in
te
ns
ity
  
time(s) 
Time-Intensity Curve---90s---carcinoma 
表 C012A                                                                         共 95 頁  第 84 頁 
的類別且訊號變動幅度較大。且其中佔最大比例的類別於腫瘤 ROI分布的彩色圖中似乎有其特定的分
布位置。 
 
未來三個月計畫 
 因此，在未來的三個月內將會針對灌注影像病歷之病理報告結果與灌注參數分析數值結果進行統
計驗證找出良惡性特徵與更進一步探討腫瘤類型與不同組織構成的形態是否有一定的相關。除此之外，
目前實驗灌注性肺癌病例只有二十例且扣除並未進行病理報告切片驗證腫瘤類型與影像資訊的不足
所剩的病例只有九組病例，且其中以惡性病例為居多，良性病例太少，尚不足能找出可靠性的腫瘤灌
注特徵，所以未來第三年計畫中將會收集更多病例，以讓系統分析成效更加可靠性、穩定性。 
 
8. 結合第二年所完成工作項目之 3D Visualization Platform 
DICOM Tag List可以顯示附加在目前瀏覽影像中的所有 DICOM Tag，顯示的資訊包括了 Tag的
名稱、ID以及內容。 
 
圖 III.8.1：DICOM Tag 顯示清單部份內容。 
表 C012A                                                                         共 95 頁  第 86 頁 
一但標記完成，AccuVR可以依據使用者的標記進行量測與分析。在量測的部分，會列出該標記
的基本資訊(如長度、面積)以及 HU值的統計量(如平均值、變異數...等等)；在分析的部分則會列出共
51項的各類量化特徵，包括了型態特徵、尺寸特徵、強度特徵、紋理特徵、位置特徵等。 
 
 
圖 III.8.4：對封閉曲線所標記的範圍進行 2D Feature 計算。 
 
此外，也可針對標記範圍顯示 HU值的直方圖，讓使用者可以進一步了解其 HU值的分佈情況。 
 
 
圖 III.8.5：顯示封閉曲線標記範圍的 HU值直方圖。 
表 C012A                                                                         共 95 頁  第 88 頁 
在 3D影像立體顯示應用技術方面，目前提供了兩種不同的觀看效果，讓使用者能夠根據本身的
硬體設備來做選擇。第一種是使用支援 Open GL的 Quad Buffered 顯示卡、120Hz立體顯示器與主動
式快門眼鏡，採用此硬體設備可以獲得較好的觀看效果。 
 
 
圖 III.8.8：未開啟立體顯示的體積成像顯示結果。 
 
 
圖 III.8.9：開啟主動式立體顯示設定。 
第二種觀看效果不需要特別的硬體設備，採用一般的顯示器、顯示卡，並搭配紅藍立體眼鏡即可
表 C012A                                                                         共 95 頁  第 90 頁 
在互動式腫瘤分割功能方面，AccuVR 提供了 Segmentation 介面讓使用者進行三維影像的分割。
當使用者尋找到欲分割的對象後，可經由在影像中設定前景、背景的方式，做為系統進行分割的依據；
接著，使用者只要分別設置分割的起始 slice與結束 slice，並按下 Segmentation介面中的"Start"按鈕，
經過短時間的運算後，便可看到分割結果。 
 
 
圖 III.8.12：繪製腫瘤圈選區域的前景(紅色)與背景(藍色)。 
 
圖 III.8.13：互動式腫瘤分割結果三個切面(Axial、Coronal、Sagittal)顯示。 
若使用者對分割結果不滿意，可以直接在影像中繼續編輯分割的前景、背景，接著再按下"Start"
按鈕，即可觀看修改後的分割結果，方便使用者快速獲得想要的結果，不用全部重新設定相關的參數。
表 C012A                                                                         共 95 頁  第 92 頁 
此外，也可以在 Segmentation介面中按下"Save Segmentation Result"按鈕，儲存目前的分割結果。 
 
圖 III.8.16：Segmentation介面。 
AccuVR另外提供了用來管理儲存的分割結果的工具，稱為"Segmentation Manager"。該介面分為
上、下兩個部分，在上半部分可以看到目前載入影像中，所有已儲存的分割結果，顯示的內容則依序
的列出了各分割的 index、ID、slice 起訖範圍和編輯者名稱；只要點選任何一筆分割，介面下方則會
顯示出該分割的 3D特徵，包含了 size、gray scale等 12項特徵。若使用滑鼠左鍵雙擊介面上半部分
的特定分割，AccuVR 會將該分割結果載入，並將 DICOM 檢視畫面切換到該分割的中間位置，方便
使用者再次觀看儲存的分割結果。 
 
 
圖 III.8.17：Segmentation manager。 
表 C012A                                                                         共 95 頁  第 94 頁 
未來三個月計畫 
電腦輔助視覺偵測：除了讓電腦可以自動偵測肺部腫瘤之外，我們也希望能提供醫師一種去除視
覺干擾的腫瘤偵測方式，當肺組織中氣管、血管、肺璧等正常生理結構都可以被濾除，剩下肉眼可見
的部份應該就是腫瘤或其它病變組織，讓醫師可以在清楚且不受干擾的情況下很輕易觀察到。 
我們將會使用肺區擷取功能取得肺區遮罩，使用氣管與血管重建功能取得氣管與血管遮罩，再將
原始 DICOM影像內容扣除上述肺區、氣管與血管遮罩之後，剩下的影像應該就可以清楚看見腫瘤或
是其他的異常組織。 
 
圖 III.8.20：在未扣除氣管與血管遮罩前的肺部影像，由於存在許多正常生理結構，
在觀察腫瘤時會受到相當多的干擾而較為不容易。 
 
圖 III.8.21：扣除氣管與血管遮罩後的肺部影像，由於少了正常生理結構的視覺干擾，
腫瘤或是異常組織在影像上清楚可見。  
國科會補助計畫衍生研發成果推廣資料表
日期:2011/01/18
國科會補助計畫
計畫名稱: 肺癌電腦斷層掃描電腦輔助偵測與診斷系統之開發(2/3)
計畫主持人: 陳中明
計畫編號: 99-2622-E-002-011-CC2 學門領域: 醫學資訊 
研發成果名稱
(中文) 肺癌電腦斷層掃描電腦輔助腫瘤偵測、對位與影像分割
(英文)
成果歸屬機構
國立臺灣大學 發明人
(創作人)
陳中明
技術說明
(中文) 肺癌已連續22年分別居於台灣女性與男性惡性腫瘤死因之第一位與第二位。而美
國於2001-2005年間，肺癌則皆分別居於男性與女性惡性腫瘤死因之第一位。早
期診斷出肺癌是提高其治癒率的重要方法。近年來，電腦斷層掃描已是目前最常
用於早期檢測出肺腫瘤並分辨其良惡性的影像方法。然而肺部電腦斷層掃描的判
讀卻不是一件容易的事，特別是微小肺腫瘤之尋找，十分仰賴臨床醫師的判讀。
具有不同經驗的醫師其所判讀出來的結果很可能會不同。 
這份know-how包括以下的技術： 
1. 以CT影像為主之肺腫瘤篩檢系統，針對肺部血管與支氣管之全自動或幾近全
自動之影像分割技術； 
2. 以CT影像為主之肺腫瘤篩檢系統，針對肺腫瘤之全自動或幾近全自動之偵測
與影像分割技術； 
3. perfusion CT之全自動或幾近全自動之影像對位與motion correction技術，
並尋找有效的perfusion CT功能參數； 
(英文) In recent years, computed tomography (CT) has become the most frequently used 
imaging modality for early detection and differential diagnosis of lung cancer. 
Nevertheless, interpretation of lung CT is definitely not an easy task. In particular, 
finding a small nodule highly dependes on the readings of medical doctors. Medical 
doctors with different experiences may result in different results of detection and 
diagnosis. 
 The technologies included in this know-how are 
1. a lesion screening system for a lung CT with automatic or nealy automatic 
segmentation algorithms for vessels, trachea and bronchus; 
2. a lesion screening system for a lung CT with automatic or nealy automatic detection 
and segmentation algorithms for lung lesions; 
3. automatic or nealy automatic image registration and motion correction techniques for 
perfusion CT and identifying the effective functional parameters of perfusion CT.
產業別 醫療器材製造業
技術/產品應用範圍
肺部電腦斷層掃描肺腫瘤自動偵測與影像分割/可用於協助醫師偵測肺部電腦斷層掃描肺
腫瘤
技術移轉可行性及
預期效益
可協助醫師提昇肺部電腦斷層掃描肺腫瘤的偵測率與正確性
註：本項研發成果若尚未申請專利，請勿揭露可申請專利之主要內容。
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
此一產學合作計畫主要在於協助廠商開發肺癌電腦斷層掃描電腦輔助偵測與診
斷系統。在此三年計畫的前兩年計畫中，我們已依照規劃，完成了肺腫瘤電腦
輔助偵測雛型系統及其第一階段臨床測試。並且在三維肺腫瘤邊緣偵測演算法
之開發，肺腫瘤影像特徵之擷取，多時間點腫瘤對位技術之開發，電腦輔助視
覺偵測，血流灌注分析與特徵之擷取，以及 3D Visualization Platform 之建
構獲得了初步成果。在第三年計畫中，我們將進一步改良腫瘤偵測與影像分割
測演算法，結合所得之肺腫瘤形態特徵與血流灌注之特徵，作為辨別肺腫瘤良
惡性之指標，完成肺腫瘤電腦斷層掃描之電腦輔助偵測與診斷軟體系統。 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
