i中文摘要
關鍵詞：射頻識別, 資料庫, 網路, 監控, 追蹤
RFID 近年來使用量逐漸增加，無論是在學術界研究或是產業方面。從門禁
管制、寵物辨識、圖書館防竊管理、商場防盜等等，都有很大的應用空間。然而，
目前現有的 RFID 系統大多是針對個別需求量身訂做，且沒有一套完整的系統對
傳回的資訊做更進一步的處理。我們期望將 RFID 做更進一步的應用，尤其是在
日趨複雜的人員管制及物流管理方面。在此子計畫中，我們選擇加入資料庫是因
為資料庫能幫助我們有效及快速的儲存及處理大量的資料。資料庫在物流上有著
不可或缺的地位，一個完善的資料庫決定一個企業利潤的多寡，在世界貿易中更
扮演關鍵的角色。由於資料量的不斷成長與使用者的增加，系統的反應時間相對
受到影響減慢，因此，效能的提升一直是產學界的重要課題。效能的提升可從硬
體與軟體兩方面來考量，硬體受到成本的限制，無限制的擴充不是治本之道。本
子計畫主要以軟體的最佳化為考量，進行系統效能分析，進而提出解決方案包括
協調機制與可靠度設計以增加效能及安全性。本子計畫在整個 RFID 總計畫中扮
演著決策中心的角色，主要任務將判讀 reader及 camera 所接收進來的資訊，經
由後級伺服器的運算處理，解讀其所代表的資訊，並決定系統的反應。而整個系
統的功能完全由本子計畫來決定。在報告的第一章中，我們首先對研究背景與目
的做一介紹。資料庫規劃與實作將在第二章中做介紹，當中我們將對實體關係模
式(ER model)與資料正規化作一說明，並且利用這兩種方法來規劃我們的資料
庫。第三章中我們將對協調控制的研究成果作一說明。第四章中我們將模擬實驗
環境與結果的展現。最後一章為研究成果自評。
iii
4.5 程式介面........................................... .......................... ............................... ..56
第五章 成果自評......................................................................................................58
參考資料......................................................................................................................59
2用以驅動 Transponder 將其內部 ID Code 送出，由 Reader 接收後再進行後續的
處理工作，如圖 1.1所示。
圖 1.1 RFID 的基本工作原理
但目前現有的 RFID 系統大多是針對個別需求量身訂做 [3]，且沒有一套完
整的系統對傳回的資訊做更進一步的處理。我們期望將 RFID 做更進一步的應
用，尤其是在日趨複雜的人員管制及物流管理方面，因此我們針對以上目標提出
改良的方法，擬研發一套完整的 RFID 系統。在管理系統日趨重要的今天，我們
期望經由這套系統的建立，將複雜且繁瑣的管理工作化繁為簡，並加強管理上的
安全性。在評估市面上現有的 RFID 系統之後，我們特別加入了資料庫這個元素
來修正以往的舊式系統。本子計畫亦是總計畫的核心及決策機制。總計畫之相關
處理程序包括：
a. 子計畫一：RFID 系統與影像處理技術整合之研究。
b. 子計畫二：讀取器（Reader）之研製暨建立讀取器與電子標籤 (Tag)之傳
輸系統。
c. 子計畫三：系統平台網路整合與性能監控技術之研發。
d. 子計畫四：資料庫設計及決策機制之分析與建構。
e. 子計畫五：電子標籤系統晶片之研發。
4當我們的系統應用在這邊時，除了將 Reader 所讀到的資訊透過網路傳回資
料庫進行比對外，CCD 補捉到的影像也同時經由網路傳回，和資料庫內的資訊
做雙重確認的工作，可避免盜用 Tag 的情形，使得門禁系統更為安全，其操作
流程如圖 1.4所示。
圖 1.4 具資料庫的門禁系統操作流程
圖 1.5 資料庫系統
上述例子為包括資料庫的 RFID 系統在門禁管制方面簡單的應用，選擇在系
統內加入資料庫是因為資料庫本身強大的功能。資料庫能幫助我們有效及快速的
儲存及處理大量的資料 [5]，例如：氣象預報系統、電話帳務系統、銀行存款系
使用者
資料庫
負責實際存取資料庫的軟體
處理應用程式的系統軟體
應用程式
Tag Reader
CCD
Network
Database
Monitor
Display
Application
由 Database決定
要執行的動作
61.2 研究計畫之目的及方法
在科技日益進步，人群交流日趨頻繁的今日，物品管理機制的建立越來越重
要。本子計畫的目的為配合其他子計畫建立一套完整的 RFID 系統，能提供完整
的物流管理機制，並有嚴密的安全防護，同時，還有完善的介面能夠更簡易的操
作這套系統。我們將應用 SQL資料庫軟體、Borland C -builder 及Window-NT 開
發網路監控視窗及相關應用程式，此系統主要的功能有：
a. 被動式物件管制
舊式的物流管制通常較為制式，例如生產線的品質管制。當貨物在進行品質
管制時，通常都是利用條碼進行辨認。但條碼的 Sensor 只能透過雷射讀取條碼
值，一旦貨物放置不妥，就無法進行下一步的動作，不過當運用 RFID的技術時，
先前的問題就可獲得改善。除了可正確的獲得物品資訊外，並具備有包含資料收
集、資料整合、即時警訊等功能。除此之外，RFID 系統可同時針對大量的物品
進行辨識的工作。當我們給予各別物品的 Tag 不同 ID Code 時，Reader 可以同
時接收這些訊息再送入資料庫做比對，比起舊式的物流管理系統，來得更為迅速
有效。
b. 主動式物件管制
人員管制在日益繁忙的社會是越來越重要了，舉凡公司機於保密原則，公共
場合因為公共安全，或是醫院組織為了健康之虞所需做的管制措施等。例如一般
公司的門禁系統，很多都是採用刷卡制度，但是，刷卡制度漏洞不少 [7]。有的
也許採用指紋或是網膜辨識，不過這些機制仍然是可以仿造的。我們在此提出以
RFID 為基礎的人員管制機制，希望除了可以達到人員控管的目的之外，並保有
高度的安全性。這個部份的內涵包括：RFID 的使用。影像辨識的應用在做人員
辨識的時候，先透過 RFID 進行 ID Code 的認證，再經由影像處理技術補捉人
臉的影像，與資料庫內部的資料進行比對，兩者皆符合時，表示認證通過，該員
81.3 報告架構
在報告的第一章中，我們首先對研究背景與目的做一介紹。資料庫規劃與實
作將在第二章中做介紹，當中我們將對實體關係模式 (ER model)與資料正規化作
一說明，並且利用這兩種方法來規劃我們的資料庫。第三章中我們將對協調控制
的研究成果作一說明。第四章中我們將模擬實驗環境與結果的展現。最後一章為
研究成果自評。
10
三組，影像處理、資料庫系統與電力電子等。
c. 複合屬性：指這個屬性可細分為多個子屬性，如地址又可分為街道，縣
市，郵遞區號，國家等部份。
d. 衍生屬性：指這個屬性的值是由其它屬性計算出來的，本身並不存在。
例如學校這個 Entity Type 可以有學生人數這個屬性，但這個屬性的值是
由學生這個 Entity目前的 Entity Set內的實體數目所決定。因此可以把學
生人數這個屬性視為衍生屬性。
在 E-R Model中我們是以屬性值來辨認出某一個 Entity。假設在某一個 Entity
Type 中，我們可以用某幾個屬性來找出唯一的 Entity，則稱這些屬性為 Key
Attributes。例如 Student是一個具有(StudentID，Name，Age，Address，Birthday)
等屬性的 Entity Type，某一 Entity Set是由電控系所有學生所組成，在沒有學生
同名的前提下，學生姓名 Name這個屬性可視為此 Entity Type的 Key Attribute。
當然 StudentID 也是這個 Entity Type 的 Key Attribute。特別要強調的是，Key
Attribute 是由某個 Entity Set 的資料來決定，因此 Name 這個屬性對電控系所有
學生所組成的 Entity Type 是 Key Attribute，但對由所有交通大學學生所組成的
Entity Type可能就不是 Key Attribute 了。若某 Entity沒有 Key Attribute，則稱為
Weak Entity Type。
所謂關係是指兩個以上 Entity 之間的關係。例如 Employee(員工 )和
Department(部門)之間可以有 WorksFor的關係，也就是說某員工在某部門工作。
Relationship 也可以具有一些屬性，如WorksFor這個 Relationship 可以有 Date這
個屬性，代表員工調到該部門工作的日期。注意 Date 這個屬性不屬於 Entity
Employee和 Entity Department，而是屬於 Relationship WorksFor。實體和關係間
可以有下列的特質：
a. Partial或 Total Participation：所謂 Total是指 Entity Set內的每一個 Entity
都一定存在有這樣的關係。如 Employee和WorksFor之間就是 Total，因
12
ㄧ。屬性與主鍵的符號如圖 2.3 所示。圖 2.4 至圖 2.7 為其他相關觀念所使用的
符號。
圖 2.1 實體的符號
圖 2.2 關係的符號
圖 2.3 屬性與主鍵屬性的符號
圖 2.4 多值屬性、衍生屬性與複合屬性的符號
圖 2.5 Total Participation of E2 in R[10,11]
實體
關係
屬性 主鍵屬性
多值
屬性
衍生
屬性 複合
屬性
E1 E2R
14
正規化主要分成五個步驟，1~5NF，其中 BCNF位在 3NF和 4NF之間。圖
2.8所示為各階段正規化的主要功能，接下來將對各階正規化作說明：
a. 第一正規化(First Normal Form，簡稱 1NF。由 E. F. Codd 提出)
b. 第二正規化(Second Normal Form，簡稱 2NF。由 E. F. Codd 提出)
c. 第三正規化(Third Normal Form，簡稱 3NF。由 E. F. Codd 提出)
d. Boyce/Codd正規化(Boyce/Codd Normal Form，簡稱 BCNF。由R. F. Boyce
與 E. F. Codd共同提出)
e. 第四正規化(Fourth Normal Form，簡稱 4NF。由 R. Fagin 提出)
f. 第五正規化(Fifth Normal Form，簡稱 5NF。由 R. Fagin 提出)
圖 2.8 各階段正規化主要功能
2.2.1 第一正規化
關聯式資料庫(relational database)要求各張資料表都必須符合第一正規化，
第一正規化的表格最重要的是能滿足「每個欄位只能含有一個值」這個條件，可
以消除重複性資料，檢查多餘的屬性和巢狀的關係，並且滿足關聯模式的定義。
1NF的條件:
a. 為一個二維式的表格
b. 表格的每一筆只能表達一個資料
1NF 刪除重複群組
2NF刪除依賴性
3NF刪除遞移依賴性
BCNF 刪除功能依賴性異
常
4NF刪除多值依賴性
5NF刪除關聯依賴性
16
圖 2.9 1NF實例
2.2.2 第二正規化
一個表格必須滿足第一正規化的條件，並且非主鍵的欄位都要對主鍵有「完
全地功能性相依(Fully Functional Dependency)」關係，才能算是達到第二正規化。
第二正規化主要可以消除功能相依，去除更新與新增時的異常。若ㄧ張表格中有
兩個欄位，分別是欄位 A和欄位 B，由欄位 A的值可推出欄位 B的值就稱功能
相依性。如果欄位 B 功能相依複合欄位 A，但是並不功能相依於複合欄位 A 的
任何子集，則稱欄位 B 完全功能相依於欄位 A。2NF 的方法是先分析和設定新
的關聯，並將每一部份的鍵獨立屬性，也就是移去部分的相關性。
圖 2.10 與圖 2.11 所示為一實例。我們可以從員工號碼(EmpNo)知道員工姓
名(EmpName)，這兩個屬性欄位其實是功能相依的；ProjNo與 ProjName也是這
樣一個例子。所以我們可以將原本的資料表細分成三張資料表。以新增資料時的
異常來說，如果小銘新接了一個專案，於資料表中就不用重複出現人員名稱與專
案名稱，僅需要記錄人員與專案代號即可，除了可以減少資料量之外，還可以使
得日後資料維護方便。
18
b. 無法單獨刪除一筆資料。
c. 仍有需要同步異動的資料。
圖 2.12 3NF實例，正規化前
圖 2.13 3NF實例，正規化後
一個表格必須滿足第二正規化的條件，並且消除「遞移相依」現象，意即非
主鍵的欄位之間沒有「完全地功能性相依」關係，才能算是達到第三正規化。由
圖 2.12我們可以觀察到，由人員的主修科目(Major)可以知道是什麼系(Dept)的學
生，知道系所名稱之後可以知道系所所在位置。經過第三正規化之後，我們可以
將原本的資料表細分成三張資料表，如圖 2.13所示。在經過 3NF 之後，先前的
「無法單獨新增一筆資料」與「無法單獨刪除一筆資料」的問題都解決了，需要
20
圖 2.15 BCNF實例，正規化後
第四正規化可刪除多值依賴性，讓每一個關聯不會有任何非瑣碎多值的相關
存在。1NF 會讓表格變成一筆一筆相依賴的資料，而 4NF 禁止一個屬性欄位中
有兩個或更多的多值相依賴其中。BCNF到 4NF會移除任何兩個屬性的 Primary
Key成為兩個新的獨立上層實體。第五正規化消除關係表內的欄位關係所形成的
循環。5NF在真實世界很少出現，從另一個角度來說，應該是很難設計成 5NF。
正規化的工作有時不必做得非常徹底，因為過多的資料表可能會降低系統執行的
效能。
2.3 系統規劃與設計
介紹過 ER model與正規化後，接下來就要利用這兩種方法來規劃我們的資
料庫系統。本子計畫在整個 RFID 總計畫中扮演著決策中心的角色，主要任務將
判讀 reader及 camera 所接收進來的資訊，經由後級伺服器的運算處理，解讀其
所代表的資訊，並決定系統的反應。分析系統功能之後，我們歸納系統將包含以
下實體：實驗室、人員、Reader、Tag、Camera，以及關係：就讀、代表、感應、
人臉訓練、人臉擷取、人員辨識。
實驗室這個實體主要屬性有：實驗室的編號、名稱、主持人姓名、聯絡電話，
22
表 2.1 實驗室基本資料
圖 2.17 人員實體與其屬性
表 2.2 人員基本資料
24
表 2.4 標籤資料
Camera這個實體跟 Reader有點類似，主要屬性有：Camera的編號、Camera
的安裝位置、Camera 的廠牌、Camera 的型號以及 Camera 所遵守的通訊標準。
Camera的實體模型如圖 2.20所示。表 2.5為根據圖 2.20所建立的攝影機資料基
本資料表。
圖 2.20 Camera實體與其屬性
表 2.5 攝影機資料
26
表 2.7 人員與標籤對照資料
表 2.8 閱讀器讀取標籤資料
表 2.9 人臉訓練資料
表 2.10 人臉擷取資料
28
第三章 協調控制與通訊協定
3.1協調控制之問題描述
考慮有 N 個相同移動代理人的群體，設其為質點而且根據下列的方程式在
平面上移動[13]：
    1,......,i i i N r v
                 (3.1)
其中， ( , )Ti ix yir 為代理人 i 的位置而且 ( , )Ti i ix y    為其速度。代理人 i 和 j
之間的相對位置為 ij i j r r r 。
假設至目標的預定路徑為 tr ，此為軌跡 ( )tp 所定義，即 ( ) tT p r。我們主要的
目標為驅動代理人群體沿著此路徑達到目標，同時，使代理人發展和保持某些想
要的隊列。在本篇報告中，我們提出了兩種設計方法，每一種設計皆使用虛擬領
導者幫助代理人追蹤預期路徑。
F1: Specified formation (N virtual leaders)
假設有 N個虛擬領導者 idr ，i = 1,…,N，每個代理人有一個領導者。這些虛
擬領導者的軌跡為 ( ) it p b，其中， 2i Rb ，i = 1,…,N，N為常數向量。我們預先
定義 ib 為預期的隊列。
圖 3.1 四種預期的隊列規格
30
圖 3.2 函數 f 和 g的圖形
可將 iR 表示成下列形式
( )
( )
i
i
j i
R j i
j ij N t
g

   r rr r r r (3.4)
其中， ( )iN t 表代理人 i在時間 t的鄰居標籤組， 0 0:g R R  為代理人 i和其鄰居
間距離的連續函數，表其鄰居施加在代理人上的短距離力強度，其一般形式如圖
3.2(b)所示。當 j i d r r ，則 0g  ，此時沒有 g 的力施加在代理人 i 上；當
0 j i d  r r ，則 0g  ，表驅使代理人 i 離開代理人 j。藉由當 ijr 趨近於零時，
( )ijg r 趨近於無限大，代理人碰撞的問題可被避免。
F2: Developed formation (one virtual leader)
在此設計中，假設只有一個虛擬領導者 0r 存在，其軌跡由 ( )tp 所給，即
0 ( ) ( )t tr p 。除了(3.3)被(3.5)取代外，方程式(3.1)~(3.4)再次被使用，
0
0
0
( )
i
i i
A i i
i i
f   
r r
r r
r r (3.5)
方程式(3.5)表此設計無預先規劃的預期架構，在 iA 的影響下，所以的代理人趨
32
由於  f  為連續、單調遞增函數，且 α為唯一，定義  ( ) ( )it col tr r  ，則式(3.8)可改
寫成 N  1r
α
 ，其中， NN R1 ，且 [ ] 1N i 1 ， i 。此 N 1 α表 N1 和 α的 Kronecker
乘積，此定義為將 N1 的每個元素以此元素乘以向量 α代替。
定理 3.1：考慮系統(3.7)與 id r q ，假設 f 為線性，即 ( )f kz z ，其中，k為正
數。則此系統的每一個解會漸進的收斂至系統平衡點。
證明：由 id r q 、 ( )f kz z 和式(3.8)，式(3.7)變成
( ) ( )
i
i i j i ji ij
j N
k g

     r r α r r b n    
                  (3.9)
考慮以下的 Lyapunov-type 函數 1V ：
1 0
1
1( ) ( ) ( )
2
i j i ji
i
N
d
i j N
V f d g d     
 
     
  r
α r r b
r
  
(3.10)
將 1V 對時間微分，可得
 
 
 
1
1
1
2
1
( )
1 ( )
2
  ( )
i
i
T
i
i iN
i
Ti j i ji ij j i
j N
T
N
i j i ji ij i
i j N
N
i
i
f
V
g
k g


 

            
          
 
 
 

r
α
r
α r
r
α
r r b n r r
r
α r r b n r
r
  
     
    

       (3.11)
注意， 1( ) 0V  r 且 1( ) 0V r ，  r r  。由式 (3.11)可得 1( ) 0V r  ，當 1( ) 0V r  時，若
且唯若 0r 。利用 LaSalle 理論，可得式(3.9)的每一個解都會漸進收斂至其平衡
點。
34
改變是微小的，以致於其可被常數向量 jq 取代；選擇 k 和方程式 g 使得在每一
個 1[ , ]j jt t 區間，當 jt t 時， j
r r  ，其中， j N j
  1r
α
 且 jα 為式(2.8)在 jq q 條
件下的解，則此系統每一個解的軌跡會漸進收斂至軌跡 ( )tα ，其解為
( ) ( )f t zz q
z
證明： 此證明與定理 3.1類似，故在此省略定理 3.2的證明。
F2：Developed formation (one virtual leader)
如果一個預期隊列滿足下列三個條件，則此隊列被稱為圍繞在 rˆ附近的 F2
隊列：
(D1) 在任何一對代理人間沒有碰撞發生。
(D2) 任何一個代理人至少有一個鄰居，可能除了在 rˆ上的一個。
(D3) 此隊列為“圍繞在 rˆ附近的鏈結隊列”或者“圍繞在 rˆ附近的半鏈結隊列”。
定義 3.1： (圍繞在 rˆ附近的鏈結隊列) 一個隊列如果被稱為圍繞在 ˆ ( , )Tx yr 附近
的鏈結隊列，則其是一個鏈結隊列，且對任何被定義為 y kx b  的直線，如果有
一個代理人 ( , )Ti i ix yr 滿足 i iy kx b  ，則至少會存在一個代理人 ( , )
T
j j jx yr 滿足
j jy kx b  。
定義 3.2： (圍繞在 rˆ附近的半鏈結隊列) 一個隊列如果被稱為圍繞在 ˆ ( , )Tx yr 附
近的半鏈結隊列，則其包含許多鏈結的副隊列，且他們中的任何一個皆為圍繞在
rˆ附近的鏈結隊列。
圖 3.3為此兩種定義的例子：(a)為圍繞在 A附近的鏈結隊列；(b) 為圍繞在
A附近的半鏈結隊列。在每一個圖中，實點表代理人，且任兩個以實線相連的代
36
0
0
01 1
( )
N N
i
i i i
ii i
f
 
    0r  rr r  r r  r
                    (3.15)
由於排斥力是成對出現的，我們假設一旦群體達到 r 的結構，在虛擬領導者
0 0 0( , )Tx yr 和代理人 i ， i 之間的吸引力變為成對的力，此意味著代理人 i 也
施加一大小相等但方向相反的力 0( )if r r 在虛擬領導者上。藉此，由於式(3.15)
第二個等式使得系統動態不用被改變。如果有一個在 ( , )Ti i ix yr 上的代理人施加
一方向向著半平面 {( , ) |  }x y y kx b  的力 f 在 0r 上，此時，為了平衡 f 必須至少
有一個其他的代理人施加一方向向其他半平面 {( , ) |  }x y y kx b  的力在 0r 上，則對
任何形式為 0 0y kx b  的直線會通過 0r 。因此，條件 D3被任何的 r 滿足且任何 r
的結構為圍繞在 0r 附近的預期隊列。
首先，我們分析了在虛擬領導者達到目標後，代理人群體的行為，即系統(3.12)
在 t T 時的行為， 0 tr r 且 0  0r 。定義另一函數 2 ( )V r 如下：
0
2 0
1
1( ) ( ) ( )
2
i j i
i
N
d
i j N
V f d g d    
 
     
  r r r rr
(3.16)
且將 2 ( )V r 針對時間微分可得
 
0 0
2
1
2
1
( )
1 ( )
2
i
T
i i iN
T
j i ij j ii j N
N
i
i
f n
V
g 

         
 
 

r r r
r r n r r
r

  

                 (3.17)
由於 2 ( ) 0V r ， r且 2 ( ) 0V r ，若且為若 0r 。可宣稱代理人群體的移動會最小
化 2 ( )V r 至其區域最小值中的一個，此也是系統(3.12)在 t T 後的一個平衡點。所
以，當群體達到此平衡點後，所以的代理人將停留在那裡。由定理 3.3，由於
38
圖 3.4 6個代理人跟隨虛擬領導者至目標且在 t = 10s時從一個隊列架構旋轉
至另外一個。
在第一個模擬裡，有 6N  個代理人和 N 個虛擬代理人(F3.1 設計)。目標位
於 ( 80, 60)T  ，預期路徑為從 (0) ( (0)) /sum Np r 開始的直線，虛擬領導人的速度為
常數向量，在此模擬的函數  f 為線性，我們預先定義 ib 使得在移動過程中，代
理人隊列會在時間區間 [8 ,12 ]s s 裡由圖 3.1(c)旋轉至(d)。圖 3.4 為此模擬的結果，
在每一個圖裡的圓圈表此圖形時刻的預期路徑。圖 3.4(a)表每一個代理人的初始
位置；圖 3.4 (b)表代理人群體已經達到如圖 3.1(c)的預期隊列；圖 3.4(c)表群體
正在旋轉；圖 3.4(d) 表旋轉的結果；圖 3.4(e)顯示群體正以新的預期隊列往目標
移動；最後，在圖 3.4(f)裡，代理人隊列為預期隊列且群體的幾何中心到達目標
位置。圖 3.5顯示此六個代理人的軌跡。圖 3.6顯示在此模擬中所有代理人隨著
時間的速度變化圖，可觀察大約在 5秒之後，所有的代理人的速度收斂至單一一
40
圖 3.6 代理人在第一次模擬中的速度
圖 3.7 6個代理人在第二次模擬的軌跡 (預期路徑為點虛線所示)，標記為群體
位置在 t = 0、t= 15、t = 30 和 t = 50時的狀況
42
圖 3.9 有 100代理人的群聚
44
圖 4.2 第二年計畫之實驗環境
4.2 資料模式效能評比
我們之所以選擇 Entity-Relationship（E-R） Model來規劃系統的資料庫，主
要是在我們的系統裡，E-R Model 的效能比其他的方法好。以下我們就選擇
Object-Based Model 來與 E-R Model比較。我們從 30,000筆資料裡，分別使用兩
種方法來查詢我們資料庫裡的資料。圖 4.3-4.5 分別是使用 Object-Based Model
的資料庫查詢結果、查詢分析、查詢資料統計；圖 4.6-4.8 分別是使用的資料庫
查詢結果、查詢分析、查詢資料統計。
46
圖 4.5 使用 Object-Based Model查詢統計
圖 4.6 使用 E-R Model查詢結果
48
4.3 協調控制與資料庫
根據第三章的描述，我們將協調控制運用到系統的資料庫裡，由於我們的通
訊協定選用 TCP/IP，而 TCP/IP 是網際網路的關鍵核心，也是業界的標準。我們
通常會用「協定組」（protocol suite）來稱呼 TCP/IP，這是因為 TCP/IP 事實上
是由許多不同的協定所組成，而更重要的是 TCP/IP 的架構採用了分層式的設計
方式，因此可以在每一層安排不同的協定。這種設計方式讓 TCP/IP 更彈性、靈
活。
TCP/IP這名稱，取自這協定裡重要的兩層協定：TCP（Transmission Control
Protocol）和 IP（Internet Protocol），因此可以想見這兩層協定的重要性。TCP 是
傳輸控制協定，主要是負責通訊傳遞間的先發工作，把一端送出的訊息處理成適
合輸送的模式，例如：分割訊息（Message）把它變成能在網路上傳送的獨立單
位一數據包（Datagram：由數據組合成的整體單位）；傳送至另一端時，再作還
原動作而轉換成原來的訊息，若有傳送錯誤或遺失數據包則重新傳送，如遇訊息
過大時能先分成數個單位，方便傳遞，並將傳輸後的數據包還原重組成正確順
序。網際協定（Internet Protocol)，相對於 TCP司內部運作之職，IP卻是真正傳
送間的行動者，當此方電腦將傳送的訊息送出後 TCP 便開始運作先發的流程，
譬如轉換成數據包等等，並且將傳送之目的地，彼方電腦或系統的位址 (IP
Address)告知給 IP，IP 便需負責帶領著數據包到達正確目的地；Internet 所連接
的任何節點或使用者皆擁有單獨的位址，這個位址便成為 IP 協定在傳輸運作上
唯一的行動準則和到達依據；IP 協定主要是負責個別數據包傳送路徑之選擇，
但需負責選擇傳輸路徑、行徑之閘門  (Gateway/Router)、中際系統(Intermediate
System)等，縱然是再複雜的環境，務需達到正確的目的地
TCP/IP 協定不僅成功的連接了不同網路，而且很多應用程式和概念也是完
全以 TCP/IP 協定為基礎發展出來，得以讓不同的廠商能夠忽略硬體結構開發出
共同的應用程式，例如今天應用廣泛的  WWW、E-MAIL、FTP、DNS 服務等等。
TCP/IP有兩種技術功能：
‧非連接導向分封交換傳送方式 (Connectionless Packet Delivery Service)：
TCP/IP 是根據信息中所含的位址資料來進行資料傳送，它不能保證每個獨
立路由的封包都能可靠和依序送達目的地。在每一個連線過程中，線路都不
是被獨佔的，而是直接映對到硬體位址上，因此特別有效。更重要的是，此
種封包交換方式的傳送，使得 TCP/IP 能適應各種不同的網路硬體。
‧可靠性分割訊息傳送方式(Reliable Stream Transport Service )：封包交換無
法確保每一個封包的可靠性，所以我們需要通訊軟體來自動偵測和修復傳送
過程中可能出現的錯誤和處理不良的封包。這種服務就是用來確保電腦之間
能夠建立連接和傳送大量資料。這服務的關鍵技術是將資料進行切割，然後
編號傳送，接著透過接收方的確認(acknowledgement)來保證資料的完整性。
我們為什麼要選用 TCP/IP做為我們網路的通訊協定？因為具有以下的特
50
圖 4.11 RFID_COM格示之主要建構
以下根據圖 4.12分別說明我們整個系統所定義的通訊協定格式，一開始的 2
Bytes為 Command，它分為 2種功用：
‧01：DBSync
當今天伺服端收到的 Command為 01時，則代表伺服端將和客戶端進行資料
間的交互作用，互相提供資料給對方來補足資料的不足。
‧02：即時
當今天伺服端收到的 Command為 02時，則顯示客戶端將要傳送必須儲存於
伺服端的資料。而傳送過來的資料分類，則必須靠接下來的 Sub-Command來
分類。
在 Command之後的 2 Bytes 為 Sub-Command，只針對 Command為 02。其
中（1）第一個 Byte可分為 3種：
‧01：ID + IPCam
當客戶端的監視器偵測到一個人的面貌，透過比對程式在資料庫中找到這個
人的相關資料，則這個人為存在於資料庫有紀錄的人員，只需將他在資料中
的 ID和捕捉到他的監視器號碼傳送回伺服端即可
‧02：Special ID + IPCam + 64*64*3
當客戶端的監視器偵測到一個人的面貌，透過程式的比對無法在資料庫中找
到這個人的相關資訊，則我們將此人視為陌生人；客戶端這時會給予此人一
Special ID，此 ID專為辨識陌生人，並將捕捉到他的監視器號碼和他的影像
傳送到伺服端。
‧03：Hello
我們想知道客戶端程式的狀況，到底是還在運作還是已經停止運作，所以我
們要求客戶端必須要在一定時間內發送 Hello訊息至伺服端，讓我們可以知
道客戶端程式目前的情況
（2）第二個 Byte可分為 4種：
00：Hello
01：User ID
02：Tag ID
03：Special ID
為 Sub-Command的第一個 Byte作更精確的確認。
（3）接下來的四個 Bytes為傳送的 ID，再下去二 Bytes為 IPCam，接著後面則
是影像。
52
Camera的所辯識出來的影像及記錄時間；還有任何一個 Reader所讀到的 Tag資
料，包含 Tag所代表的人、號碼、Tag number 及記錄時間。圖 4.14是資料庫的
查詢介面，使用者可以輸入想查尋的人、ID、IPCam 及 Reader。圖 4.15 可以隨
時知道 Reader是否有保持連線，讓我們可以隨時知道 Reader是否有問題。
圖 4.13 資料庫即時更新介面
圖 4.14 資料庫查詢介面
54
圖 4.17 使用者查詢選擇介面
圖 4.18 使用者查詢介面時間選擇
圖 4.19-4.21 為查詢的結果，這些資料都可以很迅速被列出來，以供使用者
方便查詢，而不是一次列出全部的資料讓使用者看的眼花撩亂。
56
圖 4.21 以 Reader查詢的結果
4.5 程式介面
（a） （b）
圖 4.22 第一年程式介面
第一年計劃是模擬 Lab818 環境的上視圖如圖 4.1 所示，主要程式介面如圖
4.22所示，分為（a）和（b），兩個部份，分別敘述如下：
（1）（a）部份主要是利用 RFID Reader讀取資料，再將資料透過網路傳送給資
料庫做處理。
（2）（b）部份是在實驗室門口架設 IPCam，將進入的人員做辯識，並將辯識結
果及圖片透過網路傳送給資料庫儲存。
58
第五章 成果自評
在協調控制的研究方面，我們設計兩種針對在無障礙環境中，移動自主代理
人群體之群聚問題的隊列控制法則。依據 Reynolds 所提出的三種法則，我們結
論出有四個有關群聚設計問題必須被解決，分別為分離、內聚、結盟和追蹤問題。
在我們的控制設計中，使用在任何相鄰代理人間的排斥力來解決分離問題，並使
用虛擬領導者和在代理人與其虛擬領導者之間的吸引力來解決其他三個問題。在
資料庫與決策機制方面，我們已經利用 ER model以及資料正規化兩種方法來來
設計完成資料庫系統所要使用的資料表。另外，透過系統的架構與經驗，我們能
找出某段時間內一個人的所在地或是他的運動軌跡。傳統監控系統並無法獲得這
些特點，證明這系統的價值。運用協調控制，我們能建立一個可靠、能自我修復
的監視系統。系統主控端可以從所有 RFID Reader 和 IPCAMs 收集所有狀態，
並做進一步控制。像是電源管理、影像追蹤等。協調控制使得系統更加完全、更
加可靠，也讓這個監視系統更具實用。本子計畫之部分成果已於國內研討會發
表，詳述如下：
[1] Der-Cherng Liaw, Chau-Yuan, “A Database Design for an RFID-Based Indoor
Surveillance,” Proc. 2006 CACS Automation Control Conference, Taipei, Taiwan,
R.O.C., Nov. 10-11. 2006.
[2]宋朝源 ,廖德誠 ,洪茂盛 ,鄭又誠 ,鄭兆暘 ,黃浩然 : “A Database Design for
RFID-Based Indoor Surveillance System,” 2007中華民國系統科學與工程會議 ,
Taipei, Taiwan, R.O.C., June 21-22. 2007.
[3] Der-Cherng Liaw, Mao-Sheng Hung, Chau-Yuan Song and Chao-Yang Cheng, “A
RFID-Based Indoor Surveillance Database System Design ,” Proc. 2007 CACS
Automation Control Conference, Tai-Chung, Taiwan, R.O.C., Nov. 9-11. 2007.
60
[14] N. Leonard and E. Fiorelli, “Virtual leaders, artificial potentials and coordinated
control of groups,” Proc. of the 40th IEEE Conference on Decision and Control,
pp. 2968-2973, 2001.
[15] P. Ogren, E. Fiorelli and N. Leonard, “Fo rmations with a mission: stable
coordination of vehicle group maneuvers,”  Proc. Symposium on Mathematical
Theory of Networks and Systems, 2002
[16] Gazi V., Passino K.M., “Stability analysis of swarms ,” IEEE Trans. on
Automatic Control, Vol. 48, No. 4, pp. 692 -697, April, 2003.
[17] H. Tanner, A. Jadbabaie and G. J. Pappas, “Flocking in the fixed and switching
networks,” Proc. of IEEE Transactions on, Automatic Control, July 2003.
[18] R. Olfati-Saber and R. M. Murray, "Flocking with obstacle avoidance:
Cooperation with limited communication in mobile networks," Proc. of the 42nd
IEEE Conference on Decision and Control, 2003.
[19] R. Olfati-Saber, "Flocking for multi -agent dynamic systems: Algorithms and
theory," Proc. of IEEE Transactions on Automatic Control, June, 2004 .
