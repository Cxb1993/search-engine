I 
目 錄 
目錄 ………………………………………………………………………………………………… Ⅰ 
圖目錄 ……………………………………………………………………………………………… Ⅱ 
表目錄 ……………………………………………………………………………………………… Ⅲ 
中文摘要 ………………………………………………………………………………………………1 
英文摘要 ………………………………………………………………………………………………1 
一、前言  ………………………………………………………………………………………………1 
二、電力交易市場  ……………………………………………………………………………………2 
三、等效電流為基礎之電力潮流追蹤法與安全度分析 ……………………………………………4 
    3.1 電力潮流追蹤法  ……………………………………………………………………………4 
    3.2 電力潮流追蹤法與安全度分析  ……………………………………………………………7 
四、安全度市場之設計   ……………………………………………………………………………8 
五、改良式免疫演算法   ……………………………………………………………………………10 
    5.1 免疫演算法之組成架構與演算步驟  ……………………………………………………10 
    5.2 改良式免疫演算法  ………………………………………………………………………11 
六、系統測試與結果分析   …………………………………………………………………………13 
    範例一：系統線路 10-20 發生故障情況，導致系統線路 15-18 產生壅塞   …………………14 
            測試一：參與者的調度費價格相同   ………………………………………………15 
            測試二：部分的參與者調度費價格不同(1)  ………………………………………15 
            測試三：部分的參與者調度費價格不同(2)  ………………………………………16 
            測試四：部分的參與者調度費價格不同(3)  ………………………………………16 
    範例二：系統線路 15-23 發生故障情況，導致系統線路 23-24 產生壅塞   …………………17 
            測試一：參與者的調度費價格相同   ………………………………………………17 
            測試二：部分的參與者調度費價格不同(1)  ………………………………………17 
            測試三：部分的參與者調度費價格不同(2)  ………………………………………18 
七、結論   ……………………………………………………………………………………………19 
參考文獻  ……………………………………………………………………………………………19 
 
 
 
 
 
 
 
 
 
 
 
 
III  
表目錄 
 
表 6-1  發電方得標成交量                                                         13 
表 6-2  負載方得標成交量                                                         13 
表 6-3  輸電線路潮流過載量                                                       13 
表 6-4  線路 10-20 故障導致線路 15-18 過載之貢獻度分析                              14 
表 6-5  線路 15-23 故障導致線路 23-24 過載之貢獻度分析                              14 
表 6-6  線路 23-24 故障導致線路 15-23 過載之貢獻度分析                              14 
表 6-7  安全度市場的潛在參與者                                                   14 
表 6-8  潛在發電方於安全度市場得標的選擇權標單                                   14 
表 6-9  潛在負載方於安全度市場得標的選擇權標單                                   14 
表 6-10  安全度市場參與者調度費率(範例一測試一)                                  15 
表6-11  安全度市場參與者的調度備轉容量與可停電力需求量(範例一測試一)             15 
表 6-12  安全度市場參與者調度費率(範例一測試二)                                  15 
表 6-13  安全度市場參與者的調度備轉容量與可停電力需求量(範例一測試二)            15 
表 6-14  安全度市場參與者調度費率(範例一測試三)                                  16 
表 6-15  安全度市場參與者的調度備轉容量與可停電力需求量(範例一測試三)            16 
表 6-16  安全度市場參與者調度費率(範例一測試四)                                  16 
表 6-17  安全度市場參與者的調度備轉容量與可停電力需求量(範例一測試四)            16 
表 6-18  安全度市場參與者調度費率(範例二測試一)                                  17 
表 6-19  安全度市場參與者的調度備轉容量與可停電力需求量(範例二測試一)            17 
表 6-20  安全度市場參與者調度費率(範例二測試二)                                  17 
表 6-21  安全度市場參與者的調度備轉容量與可停電力需求量(範例二測試二)            17 
表 6-22  安全度市場參與者調度費率(範例二測試三)                                  18 
表 6-23  安全度市場參與者的調度備轉容量與可停電力需求量(範例二測試三)             18 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
2  
司負責獨家經營發電、輸電及配電部分，並肩
負維護系統安全之責任。但是近年來，由於台
灣經濟開發成長速度比電力成長的速度還
快，使得台灣這幾年每到夏季尖峰時段會採取
限電，而影響工業發展與民生用電。在急需開
發電力的時期，國人的環保意識提高，人民有
「電廠不要蓋在我家後院」的觀念，以致於電
廠的興建與土地的取得都不易，所以政府推出
了「開放民間投資發電業」與「擬定電業法修
正草案」兩項重要的方案，這兩項方案對台灣
未來的電力事業自由化與民營化[2、3]有非常
大的幫助。而目前政府已核准開放民營電廠加
入電力市場運作，已經成功的跨出了電力自由
化的第一步。 
    美國、英國以及澳洲等正欲實施自由化或
已實施自由化的國家，在執行自由化的過程
中，都曾經遭遇到相當多的問題，若能從中汲
取經驗，可作為我國實施自由化的參考依據。
不過自由化的問題相當的繁雜，包含電力調度
運轉與規劃，維持可靠的電源供給與系統的安
全操作，以及維持輸電線系統的完整性及使輸
電交易順利完成的輔助服務，皆為自由化過程
中會遇到不可避免的問題，故本計劃提出在自
由化市場的輔助服務系統中，加入了即時安
全度市場(Real-time Security Market, RSM)的
概念。在即時安全度市場的參與者不僅單只
有供電端，亦可由負載端自願性的提供可停
電力，透過負載控制服務 (Load Control 
Service, LCS)，以紓解在事故發生時，系統運
轉可能發生違反電壓限制以及線路熱容量限
制的情形。當買賣電雙方在電力市場競標時，
便得以同時在安全度市場中進行投標，決定是
否願意提供擔任安全度提供者之角色。並以電
流注入法(Equivalent Current-Injection, ECI)配
合貢獻度分析與安全性分析為求解工具，增
進求解的效率與速度。 
    
    本計畫主要之研究貢獻包括： 
1.即時安全度市場的數學模式之建立： 
根據電力自由化下的一般競標模式流程，推
導出即時安全度市場模式，並建立其限制式
與目標函數。藉由「社會福利」最大化為目
標 ， 提 供 獨 立 系 統 操 作 者 (Independent 
System Operator, ISO)在安全度市場進行調
度時的參考依據。 
2.改良式人工智慧演算法： 
近年來爲了增強演算法的效能，往往會改良
原本的演算法，其目的是爲了加強演算法的
執行效率與增加尋獲最佳解的機率。本論文
也應用改良演算法來做為求解問題的演算
法，此法以免疫演算法為主體架構，當演算
法在演算的過程中，若有一段時間没有求得
較佳的解，訊號雜訊比 (Signal-to-Noise Ratio, 
SNR)將被啟動，以達到更佳的執行效率與增
加尋獲最佳解的機率。 
3.未來台灣邁向電力自由化之參考： 
藉由先進國家電力市場的趨勢與改革，了
解世界各國當前電力產業自由化的情況，以及
自由化下電力參與者與獨立系統操作者(ISO)
的安全度評估之互動關係與電力市場運作的
方式，可做為未來台灣電力自由化發展的參
考。 
 
二、電力交易市場 
 
    本計劃所提到的競標方式在電力池交易
模式中，為電力交易所撮合各市場參與成員的
競標標單方法。在英國電力市場中，為單方競
標模式，也就是說由發電業將競標價格及其斜
率下單至電力交易所，PX 依據負載需求容量，
撮合發電業之競標標單，得到一合理之價格。
若此決標標單造成系統壅塞，則以調整價格之
方式，訂定一壅塞價格；挪威電力市場中為雙
方競標模式，發電業和配電業同時投出競標標
單於電力交易所中，PX 根據雙方之競標曲線
撮合。若此決標標單造成系統壅塞，其做法和
英國電力市場類似，以調整價格之方式訂定一
壅塞價格[4、5]。本論文的電力交易市場參考
挪威之雙邊競標模式，以「累積合成曲線法」
之撮合方式撮合雙邊電量。 
    目前在電力池交易模式中，市場成員將其
競標之價格與容量投標至電力交易所，由電力
交易所撮合各成員之標單，而市場參與成員投
標至電力交易所之決標標單造成系統壅塞
時，ISO 退回該時段之標單，通知各成員進行
該時段新一次之競標，並公佈最佳競標標單供
參與成員參考。 
    但是在實際運轉調度時，可能有些不可控
制的外力，導致系統故障產生，使得在交易完
成之後，原本正常無壅塞的系統產生了線路壅
塞。本論文針對此方面問題於之後章節提出輔
助服務之即時安全度市場(Real-time security 
Market, RSM)的觀念，在自由化市場中，即時
安全度市場之參與者不僅單只有供電端，亦可
由負載端自願性的提供可停電力，透過負載控
4  
(Deregulation of Electricity Industry)政策。工商
業的進步與生活水準的提升，使得台灣電力消
費佔總能源消費的比重，有快速增加的趨勢。
電力供給、需求、與價格管制，均是當前國內
能源與電力問題的研究重點。而隨著電業自由
化以及市場競爭的來臨，世界各國紛紛進行電
力市場改革，使得公共電力事業從傳統的公營
獨占經營型態，逐漸轉型為競爭、民營的開放
市場型態。所有電力市場上的電力買賣將透過
電力交易所進行交易。電力交易所將每一時段
之競價結果交予獨立系統操作者(ISO)進行每
一筆交易之安全度分析，以決定該筆交易是否
成立。在傳統環境下，系統的安全度就短期而
言，是由發電方來擔負且屬於無償性質；而就
長期規劃而言，則須進行輸電系統的補強與擴
建工程。 
    在電力市場開放競爭後，由於無法要求發
電端（電廠）和需求端（售電業者或用戶）無
條件的提供輔助服務，因此有相當多的問題亟
待重新安排與解決，像是計算各類輔助服務的
成本與費用（包括設備投資、運轉維護、人員
培訓、發電燃料、機會成本、設備損耗與風險
補償等）、對輔助服務資源的認證及績效的衡
量、判斷輸電用戶使用了哪些項目的輔助服務
及其使用量等。 
    輔助服務的範圍相當廣泛，凡是爲了維持
輸電系統的完整性、使輸電交易順利完成、或
是調整輸電過程中偏差的相關服務，都可稱為
輔助服務。對市場開放程度較高且已採行較複
雜電力交易制度的國家或地區，發電機組提供
的輔助服務（如各類備轉容量），通常是透過
以小時為時段的連續交易市場購得，包括於即
時交易發生前一小時舉行的即時交易市場，部
份國家亦允許由輸電用戶藉由本身的發電資
源或與第三方市場參與者簽訂合約的方式，提
供各項與發電資源相關的輔助服務。 
    輔助服務的規劃與運用的核心問題在於
如何合理分攤費用及採行何種適宜的訂價方
式，以確保供應者回收成本獲得合理利潤外，
理想的訂價機制應亦能有效地提供市場參與
者決策所需的價格訊息，使市場參與者能與電
力系統的長短期需要相互呼應[7]。 
 
 
 
 
 
三、等效電流為基礎之電力潮流追蹤法與安全
度分析 
 
3.1  電力潮流追蹤法 
電力潮流追蹤法皆是依比例分配的原則
進行追蹤各發電機的電力分佈，決定出各發電
方的貢獻度。在探求系統中任一發電機複功注
入值或複功負載量於某一特定線路上複數功
率潮流之貢獻量時，亦須同時考慮到實功與虛
功之間之交叉貢獻量。舉例來說某一線路 i~j
上複數功率潮流將可以下式表示： 
 
     ( )
                     ( )
ij ij ij
p gen p gen
k k k k
k GS k GS
q gen q gen
k k k k
k GS k GS
S P jQ
P Q
j P Q
α β
α β
∈ ∈
∈ ∈
= +
= ⋅ + ⋅
+ ⋅ + ⋅
∑ ∑
∑ ∑
    (3.1) 
 
其中 genP 與 genQ 分別為有效與無效功率發電
量，GS 為發電機匯流排集合， pα 為有效功率
發電量於線路實功潮流之貢獻度因數， pβ 為無
效功率發電量於線路實功潮流之貢獻度因
數， qα 為有效功率發電量於線路虛功潮流之貢
獻度因數，而 qβ 為無效功率發電量於線路虛功
潮流之貢獻度因數。方程式(3.1)將輸電線上之
複數功率潮流表示成各發電機之實、虛功發電
量分量之和。其求解過程分述如下： 
 
 (A)匯流排注入功率與注入電流之關係矩陣 
以一個有 N 個匯流排的系統而言，匯流排
上注入功率可以下式表示 
 
)()(
,,,, Ik
sol
kRk
sol
kIk
sol
kRk
sol
kkk IEIFjIFIEjQP −++=+
 
 (3.2) 
 
其中匯流排電壓解 sol
k
sol
k
sol
k jFEV += ，匯流排之等效
注入電流為
IkRkk jIII ,, += 。因此，整個系統的匯
流排注入功率與注入電流之關係矩陣便可以
寫成 
 
|
|
|
R
I
P E F I
Q F E I
     
     
− − = − − − − − −     
     −     
          (3.3) 
 
其中上式中間部分為一個維度為 2N×2N 的稀
疏方陣，並唯一可逆矩陣。再將式(3.3)改寫成 
 
6  
矩陣[ ]oriY 進行修正，即利用原始負載之等效注
入電流推求出一等效負載導納，再將此等效負
載導納加入至系統原始導納矩陣中相對應位
置之主對角元素上。對一負載匯流排 i 而言，
此等效負載導納 eqiiy 可由下式中求出 
 
* *( ) ( )
eq soli i i i
i isol sol sol
i i i
eq sol
ii i
P jQ P jQI V
V V V
y V
− + − +
= = ×
⋅
= ⋅
, LSi ∈   (3.13) 
 
其中 LS為負載匯流排編號之集合。因此，將
每一個負載之等效負載導納求出並加入於式
(3.12)導納矩陣中對應的主對角線元素上，則可
改寫成 
 
mod ori sol eq
G LI Y V I       = −         
    
ori sol eq sol
iiY V y V       = −             (3.14) 
     
,modu solY V   =      
其中
 
,modu ori eq
ii ii iiy y y= −  
且
 
mod 0 ,
,
G ori
i
i LS
I
I eleswise
∈
  =  

 
0 ,
,
eq
L eq
i
i G S
I
I eleswise
∈
  =  

 
將方程式(3.15)做實、虛部分量分解，並重新整
理後可得 










−










−−−−−
−
=










−
sol
sol
u
G
u
B
u
B
u
G
IG
RG
F
E
YY
YY
I
I
mod,mod,
mod,mod,
mod
,
mod
,
|
|
 
 (3.15) 
 
上式中間部份為一 2N×2N 之方陣，推求其反
矩陣為 
 










−










−−−−−=










−
mod
,
mod
,
mod,
4
mod,
3
mod,
2
mod,
1
|
|
IG
RG
uu
uu
sol
sol
I
I
JJ
JJ
F
E
   (3.16) 
 
其中 
 
1
,mod ,mod ,mod ,mod
1 2
,mod ,mod ,mod ,mod
3 4
| |
| |
u u u u
G B
u u u u
B G
J J Y Y
J J Y Y
−
   −
   
− − − − − = − − − − −   
   
   
 
 
最後，將上述步驟(A)~(D)之四個關係矩陣求出
後，分別整合方程式(3.4)、(3.6)、(3.10)、(3.16)
以及方程式(3.7)、(3.11)、便可以推求得 
 
, , mod
1 2
, , mod
3 4
|
|
f u f u f
line
f u f u f
line
P D D P
Q D D Q
     
     
− − = − − − − − − −     
     
     
   (3.17) 
, , m od
1 2
, , m od
3 4
|
|
b u b u b
lin e
b u b u b
lin e
P D D P
Q D D Q
     
     
− − = − − − − − − −     
     
     
   (3.18) 
 
其中 
 
, , modu f f f u invD H Y J T
c
         
=
                
 
, , modu b ub b invD H Y J T
c
        
=
                
 
 
且 
 
mod 0 ,
,
h inj
h
h LS
P
P h GS
∈
  =   ∈
    
mod 0 ,
,
h inj
h
h LSQ Q h GS
∈
  =   ∈
 
 
inj
hP 、 injhQ 為由負載潮流程式所求得之發電機注
入淨實功量與虛功量。[Du,f]與[Du,b]分別稱為前
向與後向貢獻度矩陣，維度為 2M×2N。 
 
發電機對線路潮流與負載之貢獻量 
欲探討單一發電方對線路前向潮流之貢
獻，可直接由(3.17)式來求出。若 Pg與 Qg為發
電機匯流排 g 之淨注入實、虛功發電量，則 
 
, , ,
, 1, 2 ,
f g u f u f
line k kg g kg gP D P D Q= +            (3.19) 
, , ,
, 3, 4,
f g u f u f
line k kg g kg gQ D P D Q= +            (3.20) 
Mk ,....,1= ； GSg ∈  
 
式中 gf
klineP
,
,
、 gf
klineQ , , 分別為第g台發電機於第k個線
段上所提供的實、虛功量；GS表發電機編號之
集合。由此兩式中可以發現，依照本文所提出
之方法進行電力潮流追蹤時，系統中某一個發
電機於第k個線段上實功潮流之貢獻分量將包
括該發電機的實功貢獻分量與虛功貢獻分
量；同理，虛功潮流亦可得到相同的結果。此
法將是直接考慮AC潮流之結果為基礎並以
實、虛功率同時進行追蹤的方式，實、虛功之
間的交叉貢獻量所造成的影響亦於追蹤的過
程中一併考量。因此，第k個線段上前向與後向
實、虛功潮流可以表示成各個發電機之貢獻分
量之總合，如下 
8  
[ ] [ ] [ ]
nm
ori
matrix
F
matrix YYY ∆+=                      (13) 
[ ]


















∆∆
∆∆
=∆
ON
LLLL
MOM
MOM
LLLL
NO
'
'
mmnm
nmnn
nm
YY
YY
Y
            (14) 
其中 [ ]ori
matrixY 為事故發生前之系統導納矩陣，[ ]FmatrixY
為事故後系統導納矩陣，[ ]
nm
Y∆ 為線路 n~m 之導
納修正量。若原線路 n~m 之導納為 
[ ] 





−++−
+−−+
= )()(
)()(
cnmnmnmnm
nmnmcnmnm
nm bBjGjBG
jBGbBjG
Y  
則 
)(
cnmnmmmnn
bBjGYY −−−=∆=∆  
nmnmnm
jBGY +=∆  
 
四、 安全度市場之設計 
 
    本年度計畫以第一年度所提出之等效電
流注入法(ECI)負載潮流模型推導，並配合潮流
貢獻度分析與第二年度所提出之安全性分析
為基礎，將會更有效率的提供調度員於事故發
生時提供緊急調度之參考，並且在事故未發生
時預先做出預測，以期望獲得最大的社會福
利。 
    在已實施自由化的先進國家中，對於輔助
服務之備轉容量市場的處理大多採取由 ISO購
得，再依據系統需求，投入備轉容量。如美國
PJM 電力市場的處理方式是將現貨電力和備
轉容量分成兩個交易市場，現貨電力市場之處
理如前面章節所述，而備轉容量市場之處理方
式為 ISO 分區購買備轉容量，每區域須購買大
於該區運轉中最大機組容量以上的備轉容
量，每天每小時交易一次，每四小時執行一次
規劃，且須確保購買之備轉容量須在系統發生
供需不平衡時十分鐘內，投入有效之備轉容
量，以確保系統之穩定。一旦系統發生供需不
平衡時，依據經濟調度之原則投入備轉容量，
並酌收一合理之輔助服務費用。 
    不同於一般的備轉容量市場，本計劃針對
輔助服務提出即時安全度市場 (Real-time 
security Market, RSM)的觀念，在自由化市場
中，即時安全度市場之參與者不僅單只有供電
端，也可由負載端自願性的提供可停電力，透
過負載控制服務(Load Control Service, LCS)，
以紓解在事故發生時，系統運轉可能發生違反
電壓限制以及線路熱容量限制的情形。買賣電
雙方在電力市場競標時，便得以同時在安全度
市場中進行投標，決定是否願意提供擔任安全
度提供者之角色。 
    在安全度市場中，參與者可為發電方或負
載方，ISO 根據 PX 所提供之競價結果對系統
進行安全度分析。當在某一時段，某一事故模
擬中發現系統將會運轉在違反系統限制的情
形時，ISO 可經由安全度市場中挑選出潛在的
系 統 安 全 度 提 供 者 ( Potential Security 
Provider )。在此一機制下，ISO 可以與所選定
之系統安全度提供者進行調度合約之簽定，當
某一事故發生時，ISO 有權優先對其進行調
度，以紓解電網上之各種違反系統限制之問
題。對發電方而言，此一調度須向發電方增購
備用電力，所造成之成本稱之為避免性成本
(Preventive Security Cost)，若對於負載方進行
負載控制，則將須支付負載方一筆回饋金，此
一成本稱之為修正性成本(Corrective Security 
Cost)。承上所述，系統之總安全度成本將等於
避免性成本與修正性成本之和。 
    在本計劃所提出之安全度市場中，發電方
與負載方皆有權參加此市場之運作，藉由貢獻
度模型，ISO 有權決定何者為合格之參與方。
購電量對發電方而言可是為緊急備用容量之
購買，而對負載方而言則為緊急可卸載容量。
無論是緊急購電量或緊急可卸載容量，ISO 皆
以一補償電價的觀念於以回饋，故此將為一成
本最小化之問題。其整體架構圖如圖 4-1 所示。 
 
 
圖 4-1 安全度市場最佳決策構思圖 
 
    而在即時安全度市場的規劃中，電力市場
買賣雙方在 PX 進行投標時，依照每個參與者
之意願可同時向安全度市場提出其標單，安全
度市場中由 ISO 根據系統之網路狀況、買賣的
供需電量對各參與者進行評估，決定該參與者
是否有權參與競標。即時安全度市場(Real-time 
Security Market, RSM)之市場模型其敘述如下： 
10  
五、 改良式免疫演算法 
 
5.1 免疫演算法之組成架構與演算步驟 
 
    免疫演算法是將抗原當成欲求解的最佳
化問題，抗體則是求解空間中的可行解，針對
抗原來搜尋與它相吻合的抗體就是問題的可
行解。免疫系統具備辨識及記憶之特質，在每
一代的演化過程之中，將較佳抗體挑出來，存
入記憶細胞區成為記憶細胞的一員，並且對記
憶細胞做篩選只留下較好的抗體。 
    在免疫演算法中有兩種適合度，免疫系統
依據這兩種適合度產生不同的抗體，分別是抗
原與抗體間的適合度和兩抗體間的適合度。抗
原與抗體間的適合度代表兩者結合的強度；而
抗體間的適合度則可代表兩抗體間相似的程
度。 
    由理論可知，熵值可以應用於度量抗體間
的「雜散度」。熵值可由以下方程式計算得知， 
1
( ) log
=
= −∑
N
k
ik ik
i
E N P P
                  (5-1) 
其中 N 是抗體的數目，Pik 是第 i 個相對位置的
基因與第 k 個相對位置的基因相同的機率。假
如所有抗體的相對位置基因均與第 k 個抗體的
相對位置基因相同，則 Ek(N)=0。此第 k 個抗
體的「總雜散度」可用式(5-2)表示。 
1
1( ) ( )
M
k
k
E N E N
M
=
= ∑
                   (5-2) 
M是第 k 個抗體所包含的總基因（二進位位元）
數目。 
 
在免疫演算法中，兩種適合度都必須被考量。
第一種是兩抗體間的適合度，例如，第 j 個與
第 k 個抗體的適合度可如下計算， 
1( ) (1 (2))−= +jkbAff E
                  (5-3) 
E(2)是代表只有兩個抗體，第 j 與第 k 的「總
雜散度」，假如兩個抗體完全一樣，則 (AFFb)jk
之值為 1。(AFFb)jk 設定在 0 到 1 之間。第二
種適合度是抗體與抗原間的適合度，其方程式
如下： 
1( ) (1 _ )−= +kg kAff Obj f
                (5-4) 
Obj_fk 是第 k 抗體代入目標函數的值。假如一
個或多個變數違背它的限制，則對應的染色體
（變數）將被放入禁區表(taboo list)裡，以避免
再一次產生不合理解。 
    首先需瞭解目標函數(抗原)及其相關的限
制式，再決定可行解(抗體)以何種編碼方式加
以表示。而免疫演算法之相關參數加以說明如
下： 
 
(1)初始族群大小 
    在求解的空間中以隨機的方式，產生固定
大小數目的可行解，當作演化搜尋的初始族
群，此固定大小數目的可行解即為初始族群的
大小。 
 
(2)適應函數值 
    將隨機選出的初始族群，進行適應值的計
算。再將適應值作為抗體優劣程度的依據，由
此可得知哪些抗體較適合被選出來複製下一
代。就本論文而言，則以目標函數當成適應函
數值，為達到利潤最大化的目標，因此我們在
選擇適應值時也可以以最大值當為篩選的依
據。 
 
(3)複製 
    依據每一個抗體的適應程度來選擇，在下
一代子代中哪些抗體適合被淘汰以及哪些抗
體應該被大量複製。 
 
(4)交配 
    針對複製後的抗體而言，為了要保留部份
抗體的特性，則會設置一個機率值稱為交配率
(Mating Rate)，只有在滿足此機率值下才會進
行交配。至於哪一些抗體會被選出來交配，則
以隨機選取的方式來決定。 
 
(5)突變 
    為了避免抗體基因在交配的過程之中，失
去產生新資訊的機會，而陷入區域最佳解的情
況，所以藉由突變的機制來跳脫目前空間，擴
展搜尋解的空間進而達到全域最佳解。其突變
的原理與交配機制相類似，先設定一機率值稱
為突變率，在滿足此機率值下才會進行突變，
而突變的抗體與突變點都是以隨機的方式產
生。 
 
(6)記憶細胞 
    因為免疫系統的特性，可以將有效消滅抗
原的抗體加以記憶，以便能迅速做出反應。所
以，記憶區須具有儲存各種有效消滅抗原抗體
的地方，使免疫系統能在相同抗原第二次感染
12  
20
40
60
80
100
120 20
40
60
80
100
120
8
9
10
11
Second Dimension
Solution Space
First Dimension
Fu
n
ct
in
 
Va
lu
e
圖 5-3  SNR 於解空間的示意圖 
 
 改良式免疫演算法流程 
 
    藉由抗體與抗原間之最佳適合度辨識，演
算法將產生新的抗體直到最佳適合度值被找
到或者達到設定的疊代次數。經由上述各節介
紹，本論文所提出的改良式免疫演算法可歸納
成以下十個步驟。 
 
步驟一：建立基本資料 
    設定相關資料，例如匯流排數量、輸電線
感抗、輸電線線流量上限、各發電業輸出上下
限、配電業負載上下限、各發電業成本曲線函
數及疊代次數…等等。 
 
步驟二：產生初始值 
    以隨機方式並由各項限制式的篩選產生
合格的發電業初始發電值，也就是最初的父代
解。 
 
步驟三：數學系統轉換 
    經程式轉換，將初始發電值轉成二進位
制，把目標函數設為抗原，合理解設為抗體，
並經演算產生父代合理解，把父代十進制與二
進制合理解放入記憶系統。  
 
步驟四：複製 
    依據每一個抗體的適應程度來選擇，在下
一代子代中哪些抗體適合被淘汰以及哪些抗
體應該被大量複製。 
 
步驟五：交配 
    針對複製後的抗體而言，為了要保留部份
抗體的特性，則會設置一個機率值稱為交配率
(Mating Rate)，只有在滿足此機率值下才會進
行交配。 
 
 
圖 5-4  改良式免疫演算法流程圖 
 
步驟六：突變 
    為了避免抗體基因在交配的過程之中，失
去產生新資訊的機會，而陷入區域最佳解的情
況，所以藉由突變的機制來跳脫目前空間，擴
展搜尋解的空間進而達到全域最佳解。 
 
步驟七：適合度/雜散度計算 
    計算抗原與抗體間的適合度，計算抗體間
的適合度。計算抗體與記憶系統的雜散度，並
將不合標準的解放入禁區表中。 
 
步驟八：挑選較佳解 
    由每一次疊代所產生的父與子代整體解
14  
析，分別如表 6-4~表 6-6 所示。表 6-4 為系統
線路 10-20 發生故障導致線路 15-18 過載時，
過載線路 15-18 的貢獻度分析。表 6-5 為系統
線路 15-23 發生故障導致線路 23-24 過載時，
過載線路 23-24 的貢獻度分析。表 6-6 為系統
線路 23-24 發生故障導致線路 15-23 過載時，
過載線路 15-23 的貢獻度分析。ISO 藉由故障
線路的貢獻度分析，以決定何者為有資格的安
全度市場參與者。 
 
表 6-4  線路 10-20故障導致線路 15-18過載之貢獻度分
析 
發電方 貢獻度 負載方 貢獻度 負載方 貢獻度 
GenCo1 0.054643 DisCo1  DisCo11 8.03E-17 
GenCo2 0.011226 DisCo2 2.33E-17 DisCo12 0.091530 
GenCo3 0.035835 DisCo3 1.85E-17 DisCo13 0.061342 
GenCo4 0.049671 DisCo4 7.56E-17 DisCo14 0.059951 
GenCo5 0.024174 DisCo5 2.67E-17 DisCo15 1.26E-16 
GenCo6 0.037273 DisCo6 7.74E-17 DisCo16  
  DisCo7 7.01E-18 DisCo17 -1.67E-17 
  DisCo8 -2.45E-18 DisCo18 -2.99E-17 
  DisCo9 2.86E-17 DisCo19 -4.13E-17 
  DisCo10 1.69E-17 DisCo20 -3.43E-17 
 
表 6-5  線路 15-23故障導致線路 23-24過載之貢獻度分
析 
發電方 貢獻度 負載方 貢獻度 負載方 貢獻度 
GenCo1 -9.34E-17 DisCo1  DisCo11 0.008485 
GenCo2 -1.64E-17 DisCo2 0.011768 DisCo12 0.010493 
GenCo3 -2.75E-17 DisCo3 0.009227 DisCo13 0.006963 
GenCo4 1.65E-17 DisCo4 0.011048 DisCo14 0.006764 
GenCo5 0.17437 DisCo5 0.010388 DisCo15 0.010547 
GenCo6 -3.57E-17 DisCo6 0.010281 DisCo16  
  DisCo7 0.009032 DisCo17 0.009717 
  DisCo8 0.010986 DisCo18 0.010650 
  DisCo9 0.012149 DisCo19 0.009113 
  DisCo10 0.009036 DisCo20 0.007818 
 
表 6-6  線路 23-24故障導致線路 15-23過載之貢獻度分
析 
發電方 貢獻度 負載方 貢獻度 負載方 貢獻度 
GenCo1 3.75E-16 DisCo1  DisCo11 -0.00834 
GenCo2 4.83E-17 DisCo2 -0.01161 DisCo12 -9.95E-03 
GenCo3 -9.34E-17 DisCo3 -0.00909 DisCo13 -6.68E-03 
GenCo4 -1.55E-16 DisCo4 -0.01093 DisCo14 -6.53E-03 
GenCo5 -1.71E-01 DisCo5 -0.01028 DisCo15 -1.04E-02 
GenCo6 1.61E-16 DisCo6 -0.01010 DisCo16  
  DisCo7 -0.00889 DisCo17 -1.04E-02 
  DisCo8 -0.01061 DisCo18 -1.08E-02 
  DisCo9 -0.01132 DisCo19 -8.89E-03 
  DisCo10 -0.00888 DisCo20 -7.63E-03 
 
    在本年度計畫中，ISO 藉由表 6-4~表 6-6
來挑選有資格的安全度市場參與者，而願意參
與安全度市場並且為潛在的發電方參與者與
負載方參與者如表 6-7 所示。 
 
表 6-7  安全度市場的潛在參與者 
發電方 負載方 
GenCo1 DisCo2 DisCo9 DisCo18 
GenCo4 DisCo4 DisCo12  
GenCo5 DisCo5 DisCo13  
 DisCo6 DisCo14  
 DisCo8 DisCo15  
 
    此時，安全度市場的潛在發電方與潛在負
載方分別將其各自的選擇權標單投標至安全
度市場中，其得標的成交量與成交價格分別如
表 6-8 與表 6-9 所示。 
 
表 6-8  潛在發電方於安全度市場得標的選擇權標單 
發電業 (GenCo) 得標成交量 (MW) 得標成交價 ($) 
GenCo1 3.604861 0.4 
GenCo4 3.706108 0.3 
GenCo5 2.553646 0.4 
 
表 6-9  潛在負載方於安全度市場得標的選擇權標單 
發電業 
(DisCo) 
得標成交
量 (MW) 
得標
成交
價 ($)
發電業 
(DisCo) 
得標成交
量 (MW) 
得標
成交
價 ($) 
DisCo2 1.059846 0.3 DisCo12 0.892569 0.3 
DisCo4 0.990867 0.4 DisCo13 0.594011 0.3 
DisCo5 0.931699 0.4 DisCo14 0.579589 0.3 
DisCo6 0.901048 0.3 DisCo15 0.934734 0.3 
DisCo8 0.942228 0.4 DisCo18 0.931059 0.4 
DisCo9 1.044821 0.4    
 
    在本計劃的範例測試中，由於發電方可以
增加發電量或減少發電量，故當故障發生時，
可以要求發電方增加或減少發電量以解決壅
塞，而負載方由於只能減少負載，故當故障發
生時，只能要求負載方降低負載以解決壅塞的
情況。 
 
範例一：系統線路 10-20 發生故障情況，導致
系統線路 15-18 產生壅塞 
    本範例假設發電方與配電方完成競標撮
合，但當實際運轉調度時系統線路 10-20 卻發
生故障，導致系統線路 15-18 產生壅塞，ISO
由安全度市場進行調度來解決壅塞的問題。藉
由此調度來探討調度價格與調度電量的關
係。在此範例中，假設大部分的安全度市場參
16  
的支出，故會增加調度 12 號負載方的可停電
力量，並且減少調度 14 號負載方的可停電力
量。 
 
測試三：部分的參與者調度費價格不同(2) 
 
表 6-14  安全度市場參與者調度費率 
GenCo 
No 
調度費 
價格($) DisCo No 
調度費 
價格($) DisCo No 
調度費 
價格($) 
1 20 2 20 12 30 
4 20 4 20 13 20 
5 20 5 20 14 10 
  6 20 15 20 
  8 20 18 20 
  9 20   
 
表 6-15  安全度市場參與者的調度備轉容量與可停電
力需求量 
GenCo 
No 
解決壅塞
所調度的
備轉容量
(MW) 
DisCo 
No 
解決壅塞
所調度的
可停電力
量(MW) 
DisCo 
No 
解決壅塞
所調度的
可停電力
量(MW) 
1 -0.00263 2 0 12 -0.22670 
4 -0.28627 4 -0.00030 13 -0.46526 
5 -1.19650 5 -0.03054 14 -0.54083 
  6 -0.03306 15 -0.03021 
  8 -0.00052 18 -0.03032 
  9 -0.00246   
 
最後 ISO 需給付的總成本：$60.772 
 
圖 6-4  ISO 需給付的總成本收斂圖 
 
    在測試三中，若 14 號負載方的調度費價
格降低，而 12 號負載方的調度費價格增加。
由結果可得知，此時 ISO 會增加調度 14 號負
載方的可停電力量，並且減少調度 12 號負載
方的可停電力量，以達到增加社會福利，減少
調度成本支出的目地。 
 
測試四：部分的參與者調度費價格不同(3) 
 
表 6-16  安全度市場參與者調度費率 
GenCo 
No 
調度費 
價格($) 
DisCo 
No 
調度費 
價格($) 
DisCo 
No 
調度費 
價格($) 
1 20 2 20 12 30 
4 20 4 20 13 30 
5 20 5 20 14 30 
  6 20 15 20 
  8 20 18 20 
  9 20   
 
表 6-17  安全度市場參與者的調度備轉容量與可停電
力需求量 
GenCo 
No 
解決壅塞
所調度的
備轉容量
(MW) 
DisCo 
No 
解決壅塞
所調度的
可停電力
量(MW) 
DisCo 
No 
解決壅塞
所調度的
可停電力
量(MW) 
1 0.00274 2 -0.00424 12 -0.22947 
4 -0.93413 4 -0.00191 13 -0.45290 
5 -0.63865 5 -0.03969 14 -0.55556 
  6 -0.02967 15 -0.03067 
  8 -0.01107 18 -0.03583 
  9 -0.04726   
 
最後 ISO 需給付的總成本：$79.655 
 
 
圖 6-5  ISO 需給付的總成本收斂圖 
 
    在測試四中， 12、13、14 號負載方的調
度費價格同時增加。此時 ISO 希望減少調度成
本的支出，故會盡量減少調度 12、13、14 號
負載方的可停電力量，以增加社會福利。但是
由結果發現，若 12、13、14 號三個負載方的
總調度量減少，則無法解決壅塞情況，故即使
調度費價格再高，ISO 仍是不可避免地需要進
行調度，所以 ISO 如何與參與者簽訂調度價格
費用，直接影響了 ISO 所需支出的調度成本，
也間接影響了社會福利的多寡。 
18  
 
圖 6-7  ISO 需給付的總成本收斂圖 
 
    在測試二中，當調度 2、4、8、9 號負載
所需付出的調度價格提高時，可以發現 ISO 為
了降低調度成本，導致 2、4、8、9 號負載因
為每單位可停電力價格較昂貴而被調度的可
停電力量減少，而其它的參與者因為每單位可
停電力價格相對較低，而被調度的可停電力量
增加。 
 
測試三：部分的參與者調度費價格不同(2) 
 
表 6-22  安全度市場參與者調度費率 
GenCo No 調度費 價格($) DisCo No 
調度費 
價格($) DisCo No 
調度費 
價格($) 
1 20 2 10 12 20 
4 20 4 10 13 20 
5 20 5 20 14 20 
  6 20 15 20 
  8 10 18 20 
  9 10   
 
表 6-23  安全度市場參與者的調度備轉容量與可停電
力需求量 
GenCo 
No 
解決壅塞
所調度的
備轉容量
(MW) 
DisCo 
No 
解決壅塞
所調度的
可停電力
量(MW) 
DisCo 
No 
解決壅塞
所調度的
可停電力
量(MW) 
1 0.01430 2 -0.34578 12 -0.00240 
4 0.00848 4 -0.45497 13 -0.03420 
5 -2.23950 5 -0.03714 14 -0.03108 
  6 -0.01504 15 -0.03558 
  8 -0.55784 18 -0.01679 
  9 -0.48862   
 
 
 
 
 
 
最後 ISO 需給付的總成本：$74.163 
 
圖 6-8  ISO 需給付的總成本收斂圖 
 
    在測試三中，當 ISO 調度 2、4、8、9 號
負載方所需付出的調度費價格降低後，可以發
現因為調度每單位可停電力價格較便宜而導
致被調度的可停電力量增加，而其它的參與者
因為每單位可停電力價格相對較昂貴而使得
被調度的可停電力量減少。 
 
討論與分析： 
    本計劃提出兩個範例、共七個測試，由上
述的範例與測試中可以發現： 
 
1.在測試過程中，若發電方參與者或負載方參
與者的調度費價格較低，ISO 會儘量增加調度
費價格較低的發電方備轉容量與負載方可停
電力量，以達到減少調度成本支出，增加社會
福利的目地。 
 
2.在某些系統線路發生故障時，由於系統本身
的線路結構限制，導致參與安全度市場的發電
方送電或負載方受電將只剩單一線路。ISO 只
能不可避免的去調度此ㄧ線路上發電方或負
載方相當容量的備轉容量或可停電力，以解決
故障產生的壅塞情況。 
 
3.在某些故障情況之下，由於系統線路不會使
參與安全度市場的發電方或負載方形成單一
迴路供電或受電，故 ISO 在進行壅塞調度時，
有更大的彈性去調度其它參與安全度市場的
發電方或負載方，以解決系統壅塞情況。 
 
4.在尋求最佳解的過程中，使用改良式免疫演
算法做為求解工具，可以發現改良式免疫演算
