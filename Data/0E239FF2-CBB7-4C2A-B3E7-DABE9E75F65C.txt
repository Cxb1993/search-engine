 二、緣由與目的 
本計畫所屬的總計畫在設計一個超低功率之助聽器晶片系統（System on a 
Chip, SoC）。其主要功能是將聲音訊號經由微機電麥克風轉換成電訊號，再以
數位電路依據使用者的聽覺反應及習慣做適當的訊號處理，最後則藉由微機電喇
叭用音波刺激內耳的耳蝸。除了微機電麥克風及喇叭，所設計的電路皆會以 90 
nm 的 CMOS 製作成晶片且加以量測，最後並整合於單一晶片上。而本計畫將設
計此助聽器晶片系統所需要的類比電路。 
本計畫的目的是設計及實現此系統所需要的低功率混合訊號式介面電路，並
且將與其他數位電路整合於同一晶片上。本計畫將開發（1）微機電麥克風前置
放大器與類比數位轉換器；（2）微機電喇叭驅動電路；（3）電源控制電路。在 1 
V 的電源電壓之下，規劃的功率消耗分配如下；麥克風前置放大器與類比數位
轉換器佔 150 uW，微機電喇叭驅動電路佔 300 uW，電源控制電路佔 50 uW。 
2 
 3A. 低功率 Delta-Sigma ADC 
可用於在音頻的類比數位轉換器中，差積調變(Delta-Sigma modulation)是最
廣泛使用的技術，其架構圖如圖 3A.1 所示，該架構運用過取樣(over-sampling)
和負迴授的機制，使內部低解析度(resolution)的類比數位轉換器產生的量化雜訊
(quantization noise)被移至訊號頻帶之外，形成所謂的雜訊形變(noise shaping)，使
得數位輸出的 Y 在低頻的頻譜特徵和類比輸入 X 完全一致。就時序的觀點簡而
言之，差積調變器可以將一低速高解析度(low-speed high-resolution)的輸入，轉
換成一高速低解析度(high-speed low-resolution)的輸出，藉此大幅下降相對應之
類比電路需求。 
 
Fig 3A.1: 差積調變器架構和其功率消耗分佈圖 
雖然差積調變器有放寬電路規格的優點，使這架構尤其適合運用於深次微米
(deep-sub-micron)的製程上。然而隨著製程持續演進，電晶體的速度不斷提升但
是類比特性卻每況愈下，例如本質增益(intrinsic gain) [Murmann06]，造成傳統方
法設計的差積調變器，遭遇到前所未見的瓶頸。除此之外，本計畫希望助聽器必
須盡可能的降低功率消耗，從已發表的文獻研究發現，差積調變器內的濾波器
(loop filter)，一般消耗掉超過 70%的功率，是節能設計的首要課題。如依舊採用
傳統的電路，例如運用二階放大器(two-stage opamp)，非但無法有效節能，還必
須在類比電路上投注大量心力以達最低的規格需求。有鑑於此，我們基於目前已
多用於管線式類比數位轉換器(pile-lined ADC)之校正(digital calibration)技術
[Wang09]，將其改造並提出一適用於先進製程的低功率差積調變器，以滿足助聽
器計畫需求。 
一個完整的校正(calibration)機制，基本上分為錯誤分析(failure analysis)，檢
測(detection)和修正(correction)三大步驟。”錯誤分析”的目的是釐清錯誤的來源，
並將錯誤所帶來的後果量化。”檢測”是試圖將錯誤給翠取出來的過程。而”修正”
則是利用可調的參數來消彌錯誤。在本計畫執行期間，我們分別就這三部分有些
初步成果。以下會就其細節分別說明。 
4 
 於低增益放大器引起的積分器滲漏，會因電荷流失而拉低輸出準位，故利用開關
每次啟動的機制，強迫電荷回充而補償輸出電壓，可使得輸出電壓不至錯誤。如
果從頻域(frequency domain)去分析，可以發現在忽略 Cp 的情況下，新的積分器
及點可用下式來表示： 
⎟⎟⎠
⎞
⎜⎜⎝
⎛ +++
++
=
i
fs
i
f
tun
C
CC
Av
AvC
C
111
11
β  
如果 Cf=0，就是傳統積分及點的表示式。兩相比較，傳統積分器唯有當 Av
無限大時才會使極點 1，而可調式的積分器則多了 Cf 可以用來決定極點。進一步
分析可知，當 Cs等於 Cf 的(Av-1)倍時，βtun 會落在 1 的位置，也就是我們最期
望的結果。換句話說，異於追求高增益放大器的傳統設計，我們提出的方案是利
用迴授開關電容電路，就能達到修正積分器極點與雜訊轉換式零點之目的。另一
方面，雖然圖 3A.3 僅畫出延遲式(delaying)的積分器，但只要修正開關得啟動時
期(phase)，這架構便可變為一個非延遲式(non-delaying)的積分器。 
 
Fig 3A.3: 傳統積分器與可調式積分器 
接著我們要說明如何檢測差積調變的雜訊轉換式零點，一旦此步驟得以實
現，那一個完整的差積調變器的校正機制就算完備。一般校正有分為前景式
(foreground)的與背景式(background)兩種，有時也分別被稱為線上式(on-line)與離
線式(off-line)。差別就於當系統在校正所需校正時能否進行正常的運作，在此所
意謂的就是，當差積校正調變器的期間，調變器是否能如常進行訊號轉換的工
作。一般而言，前景式的校正因為將未知的成分降到最低，所以所需時間相對短，
但是缺點就是必須在系統在剛啟動之際或沒有運作的空檔來進行校正，反之背景
式的校正，則沒有此限制，但是代價是相對所需時間較久。在此計畫執行期間，
我們就這兩種形式的校正法都有提出我們的方案。 
首先是前景式校正的方法：對需要被校正的積分器輸入方波，其輸出訊號會
有如圖 3A.4 的特性：如果β小於 1，輸出會小於 0; 如果β大於 1，輸出會大於
6 
  
 
 
Fig 3A.5 背景式校正器的差積調變器運架構圖 
此矯正概念首見於[Huang05]的研究，但用於差積調變器時需作些修改。為
了找出校正器判斷β所需的臨界值，我們必須針對校正器作統計上的分析。首先
將校正器處理的訊號分為，輸入 X、雜訊 N 與測試訊號 Q 三種來源。由於這三
訊號的特性可用訊號系統的觀念處理之，則其最後校正器輸出的資訊可用機率密
度函數(Probability Density Function)來表示，而進一步可將β和校正器累積的 S
用三個機率來函蓋，分別是減少β、持平β與增加β的機率(PD,PF,PI)。不論何時，
β都應該被驅使往 1 移動，如果收集的資料不夠，最起碼要停在原地，也就是說，
盡量使遠離 1 的機率最低。圖 3A.6 就是模擬的β=0.99 時，遠離 1 機率的模擬結
果。很明顯可見，臨界值越大，往錯誤方向移動的機率越低，當值為 24，機率
小於千分之一。然而臨界值越大卻必須付出收斂時間為代價，設計者要自行斟酌。 
 
Fig 3A.6 當β=0.99 時，PD的機率 
8 
  
Fig 3A.8 二階輸入前饋差積調變器價構圖 
 
Fig 3A.9 二階輸入前饋差積調變器子區塊圖 
由以上的討論確定差積調變器的系統架構，以下將接著說明電路層(circuit 
level)設計時的考量。從圖 3A.1 已知濾波器會消耗掉 70％以上的功率，設計低功
率的重要性不言可喻，於是乎我們利用雜訊和速度(noise-and-settling)兩面向來實
現最省電的濾波電路。一般開關電容式的積分器，可以兩個階段(phase)，其一取
樣(sampling)另一是積分(integration)。請參考圖 3A.10，習慣上，我們會將積分器
操作時所有的雜訊匯集到輸入端並得： 
1
2 (1n m
kTP G R
C
)ζ≥ + +  
左式的 Pn 是雜訊量(noise power)，一旦系統的規格被決定(例如：訊雜比)，
則 Pn 就被限定。右式中的 2 代表差動(differential)架構，Gm 代表的是積分器閉
迴路(close  loop)的電導、R 代表的是開關導通電阻、ζ 代表運算放大器的雜訊
係數(一般落在 4~10 不等)、C1 是取樣電容大小。而 Gm 又可以用運算放大器的
電導 gm 表示： 
1
m
m
m
gG
g R
= +  
上式的結果等同於源級衰減(source degeneration)的電導關係，電阻反比於整
體電導。換句話說，當開關的電阻增加，閉迴路的電導也會隨之下降，使得整體
積分器的速度降低。因此，R 的上限被速度限制，R 的下限被電晶體的面積和驅
動電壓決定。 
10 
  
Fig 3A.12 線性區長度、迴轉區長度和訊雜比的關係 
總括來說，而上可知，積分器處與積分模式時，根據其系統架構，大約有
10~25 個時間常數的長度。於是，由速度所限定的不等式便可寫成： 
1( ) ( )
2
s
m
TCm n m n
G
τ+ = + ≤  
由前面提及的兩個不等式，我們可以畫出同時考慮雜訊和速度的 C1 對 Gm關係
圖，請見圖 3A.12，兩不等式的交點，就是最節能的 Gm,C1 之解。 
 
Fig 3A.12 由雜訊和速度條件得最低功率操作點 
以下提供一例子，做為上述說明的總結。如果要實現 14 位元(bits) 20k 赫茲
的差積調變器，並在 1 伏的額定電壓下以 5M 赫茲(Hz)取樣速度操作。試問所需
的取樣電容和開路電導大約為多少？一般而言，利用電晶體實現的開關，在合理
的面積和操作電壓下，其導通約 200 歐姆到 500 歐姆左右，在此假設 R 為 400
歐姆作為計算，另外先前提到的運算放大器的雜訊係數則取 5。先求得雜訊量值
(noise power) 
nPn 7.1210
5.0*128 3.9
3
==  
另外，加上速度的條件，5MHz 代表積分模式只有 100n 秒的時間，所以系統所
需的時間常數約略為 
nn 67.6
15
100 ==τ  
利用圖 3A.12 的數學關係，最低功率的的 Gm 為 
μτ
ζ 611
2
)1(2 =−
+=
kTRP
kTGm
n
 
12 
  
Fig 3A.15 以 65nm 實現的差積調變頻之晶片照片 
結合系統考量、電路設計、數位背景校正技術，我們以 65nm 實現一個低功
率二階差積調變器，其完整電路如圖 3A.13 所示。實際佈局(layout)請見圖 3A.14：
長寬各約 400um，電容佔總面積的 30%，電晶體佔 12%。其照片請見圖 3A.15。
總功率消耗約 186uW。圖 3A.16 是以 6k 單頻訊號輸入的量測結果，明顯可見諧
波失真因為校正器的啟動而下降，這是因為雜訊形變能力因校正而加強，使的從
比較器引入的雜訊皆被壓抑，然而雜訊底額(noise floor)沒有明確的下降，根據研
判應該是輸入極的熱雜訊，如要使 SNR 再提高，輸入極的電容有加大之必要。
晶片的規格摘要請見表格 3A.1。 
 
Fig 3A.16 音頻的量測頻譜圖 
Table 3A.1 規格整理 
Technology TSMC 65 nm 
Supply Voltage 1.2 V 
14 
 [Park08] Hyunsik Park et al., “A 0.7V 870uW Digital Sigma-Delta Modulator,” in 
Symposium on VLSI circuits, pp. 178-179, June 2008. 
hreier05] R. Schreier and G. Temes, “Understanding delta-sigma data converters.” 
A 65nm CMOS CT DeltaSigma Modulator with 81dB 
n Solid-State Circuits 
Conference, 2008. ISSCC 2008. Digest of Technical Papers. IEEE International, 
tion Delta-sigma ADC topology,” in 
ol. 37, pp. 737-738, June 2001
it 
 Sansen, “A 1- V 140 W 88-dB audio 
sigma-delta modulator in 90-nm CMOS,” IEEE J. Solid-State Circuits, vol. 39, 
no. 11, pp. 1809–1818, 2004. 
[Sc
IEEE press Piscataway, NJ, 2005. 
[Shu08] Y.-S. Shu, et al., “
DR and 8MHz BW Auto-Tuned by Pulse Injection,” i
3-7 2008, pp. 500 –631. 
[Silva01] J. Silva et al., “Wideband Low-distor
Electronics Letters, v . 
[Wang09] H. Wang et al., “Nested Digital Background Calibration of a 12-b
Pipelined ADC Without an Input SHA,” IEEE J. Solid-State Circuits, vol. 44, no. 
10, pp. 2780–2789, 2009. 
[Yao04] L. Yao, M. S. J. Steyaert, and W.
 
16 
  
Fig 3B.3: Pulse-Width Modulation。 
DSM 運用高速的數位運算及高取樣頻率可得到較低的總諧波失真（Total 
Harmonic Distortion, THD）[Gata02]，但高速的數位運算需要較大的功耗，高取
樣頻率意味著 Class-D 輸出級及其驅動電路操作在高切換頻率下，這將使得
Class-D 放大器的轉換效率降低。也有研究提出不同的 DSM 架構簡化所需的運
算量 [Kim06]，簡化後的DSM可達到較低的功耗，但其付出的代價是較差的THD
表現。PWM Class-D 驅動電路的切換頻率低，理論上會有最高的轉換效率，其缺
點是 THD 較高。在數位 PWM 的設計中，可運用訊號內插（interpolation）的技
巧來改善 THD 表現，實現適合助聽器應用的數位 PWM Class-D 放大器。 
圖 3B.4 為數位 PWM 調變器之架構圖。如圖所示，b 位元、取樣頻率為 fS Hz
的數位音頻訊號會先經過 OSR 倍的內插（interpolation）轉換成 b 位元、OSR×fS 
Hz 的訊號，內插的目的除了提高取樣點以增進 THD 表現外，並提供後面進行雜
訊形變所需的超取樣，接著內插過後的訊號經過 Digital PWM 轉換成代表脈衝寬
度的訊號（b 位元、OSR×fS Hz）。再將 b 位元數位脈衝寬度訊號轉換成 1 位元的
脈衝的過程中所需的時脈頻率（clock frequency）必須是輸入訊號取樣頻率的 2b
倍，以 b=16、fS =24 kHz 為例，Pulse Generator 的操作頻率約為 1.57 GHz。因此
在轉成脈衝訊號之前，b 位元（OSR×fS Hz）的數位脈衝寬度訊號透過 Noise Shaper
轉為較少的 q 位元（OSR×fS Hz）訊號，如此便能在不損失訊號精確度的前提下
大幅降低 Pulse Generator 的時脈頻率，降低電路的功率消耗。 
 
 
Fig 3B.4: 數位 PWM 調變器。 
圖 3B.4 中的 Digital PWM 功用是把數位訊號轉換為相對應的數位脈衝寬度
訊號，由於數位訊號取樣點有限的緣故，數位 PWM 的調變方法會產生諧波失
真。改善此問題之方法的概念是利用有限的取樣訊號來逼近類比 PWM 調變方
式，例如：運用線性內插的 LPWM（Linearized PWM）、運用 Newton-Raphson 
method 的 PNPWM（Pseudo Natural PWM）以及合併運用 Lagrange Interpolation
和 Newton-Raphson method 的 LAG-NR PWM [Adrian05]。相較於後兩者，LPWM
所需的運算簡單但具有較嚴重的失真。圖 3B.5 為 LPWM 調變方法之示意圖，由
圖可清楚看出如何利用取樣訊號（x[n], x[n+1]）以及其線性內插求得脈衝寬度訊
號（tp[n]）。考慮如圖 3B.5 所示之載波訊號（Carrier）： 
12)( −= ttC  
則脈衝寬度訊號為： 
]1[][2
][1][ +−+
+=
nxnx
nxntp  
18 
  
Fig 3B.7: LPWM 總諧波失真加雜訊圖。 
在不增加太多運算複雜度的前提下，為了解決 LPWM 在高輸入訊號頻率以
及大輸入訊號振幅下的非線性失真問題，可針對 LPWM 所產生的脈衝寬度誤差
作相對應的修正，我們稱此方法為 Algorithmic PWM（APWM）。圖 3B.8 為 APWM
調變方法之示意圖[Pascual00]，圖中 tp[n]為利用輸入訊號 x[n-1]、x[n]、x[n+1]
和 x[n+2]所求得的脈衝寬度訊號，而 d1、d2 分別為利用訊號 x[n]、x[n+1]線性外
插所得到值與訊號 x[n-1]、x[n+2]的差異： 
]2[][]1[2
]1[]1[][2
2
1
+−−+=
−−+−=
nxnxnxd
nxnxnxd
 
由圖中可觀察到：若 d1+d2 > 0，則利用 x[n]、x[n+1]進行 LPWM 所求得的脈衝
寬度會比實際的脈衝寬度來得小；若 d1+d2 < 0，則 LPWM 求得的寬度會比實際
值大。另外若脈衝寬度的值在 0 或 1 附近時，LPWM 與實際值的誤差會小於脈
衝寬度值在 0.5 附近的誤差。根據以上的觀察，我們可以對 LPWM 所計算的結
果作誤差修正以得到較正確的脈衝寬度訊號 tp[n]： 
( ) ( )xxxp ttddtnt −×++= 1][ 21α  
其中 tx 為 LPWM 求得的脈衝寬度： 
]1[][2
][1
+−+
+=
nxnx
nxtx  
而α為一常數，其數值可經由大量的系統模擬以得到最佳值。圖 3B.9 及圖 3B.10
是以 6.6 kHz 單頻訊號輸入（b=16, OSR=8, fS =24 kHz）的 APWM 模擬結果，由
3B.9 的頻譜圖可看出 APWM 可有效壓抑 LPWM 所產生的第三階諧波，在音頻
頻段內其 THD 為-92 dB。由 3B.10 之 THD+N 對輸入訊號振幅（dBFS）的作圖
可看出 APWM 可改善 LPWM 的 THD+N 表現隨著輸入振幅增加而惡化的現象，
在輸入訊號振幅為 0 dBFS 時，APWM 的 THD+N 為-91 dB。 
 
20 
 的數位訊號，通常 b≧16。要實現 16 位元寬度的脈衝訊號是幾乎不可行的，所
以此 b 位元的脈衝寬度訊號必須經過 Noise Shaper，在不損失音頻頻段訊號雜訊
比的前提下將 b 位元的訊號降為 q 位元（q 一般為 6 ~ 9）。圖 3B.11 所示為 Noise 
Shaper 之架構圖，Quantizer 將訊號從 b 位元降為 q 位元，而經由 Quantizer 產生
的量化雜訊（quantization noise）e[n]則透過回授濾波器 h[n]回授至輸入端與輸入
訊號 x[n]相減。圖 3B.12 為此 Noise Shaper 之線性模型，由此模型可得到： 
[ ]
)z(E)z(NTF)z(X
)z(E)z(H)z(X)z(Y
×+=
×−+=
         
1
 
其中 NTF(z)為雜訊轉換函數（Noise Transfer Function）。由式子可看出量化雜訊
E(z)將經過 NTF(z)的濾波形變，提升輸出訊號 Y(z)的雜訊比。在設計中，選取 
( )1NTF( ) 1 Nz z−= −  
其中 N 為此 Noise Shaper 的階數，則量化雜訊將經過 N 階高通濾波器（high-pass 
filter）的濾波。在此架構下，回授濾波器 H(z)的係數皆為整數，因此在電路實現
上非常簡單。圖 3B.13 是以 6.6 kHz 單頻訊號輸入（b=16, OSR=8, fS =24 kHz）的
APWM + Noise Shaper（q=8, N=3）頻譜圖，其 THD+N、THD 和 SNR 分別為-89 
dB、-92 dB 和 96 dB。此 Noise Shaper 透過 3 階的回授濾波器，可將 8 位元的 PWM
訊號之音頻頻段雜訊比維持在 95 dB 左右，此系統在高輸入訊號頻率下的
THD+N 表現則是被 APWM 的非線性失真所決定。 
 
 
Fig 3B.11: Noise Shaper。 
 
Fig 3B.12: Noise Shaper 線性模型。 
22 
  
Fig 3B.14: Noise Shaper 頻譜圖。 
綜合以上所述，圖 3B.15 所示為最後我們設計的數位 PWM 調變器區塊圖。
此調變器的數位音頻輸入訊號（16 位元、取樣頻率 48 kHz）首先會經過 8 倍的
內插轉換成 16 位元、384 kHz 的訊號，此訊號接著透過前述的 APWM 區塊調變
為 16 位元、384 kHz 的數位脈衝寬度訊號。藉由三階 Noise Shaper，16 位元的數
位脈衝寬度訊號將轉為 8 位元、384 kHz，最後此 8 位元的脈衝寬度訊號經由數
位計數器產生 1 位元的 PWM 訊號，其中數位計數器的操作頻率為 98.3 MHz。
表 3B.2 所列為此數位 PWM 調變器 THD+N、THD 和 SNR 的表現。 
 
 
Fig 3B.15: 數位 PWM 調變器。 
 
Table 3B.2: 數位 PWM 調變器表現。 
Input Frequency THD+N (dB) THD (dB) SNR (dB) 
1.03 kHz -95.1 -106.4 96.3 
6.66 kHz -89.5 -92.2 96.4 
 
在 Class-D 放大器中，輸出級電路（Output Driver）對於整體放大器的失真
表現和功率轉換效率有直接且顯著的影響。圖 3B.16 為 Class-D 輸出級電路之示
意圖，此電路接收經過 PWM 調變的訊號 Vpwm，最後經由開關電晶體（switching 
transistors）MH1,2、ML1,2 驅動低通濾波器和喇叭所組成的負載。由於功率轉換
效率和訊號線性度的考量，開關電晶體必須具備非常低的導通電阻。為了避免開
關電晶體 MH1、ML1（MH2、ML2）同時導通，使用 Non-overlap Gate Drive 電
路以引入一無效時間（dead time）。 
24 
  
Fig 3B.18: 開關電晶體導通電阻失真頻譜圖。 
 
Fig 3B.19: 開關電晶體尺寸與總諧波失真關係圖。 
 
Fig 3B.20: Dead time 失真。 
圖 3B.20 為 dead time 失真之示意圖，IL為流經電感 L 的電流。為了避免開
關電晶體同時導通而形成一條流經 VDD 到 VSS 的低電阻路徑，在輸出級電路中
必須引入一段無效時間 td，在此區間內電晶體MH和ML皆不導通。加入dead time
26 
 由於電晶體的有限導通（turn-on）與關閉（turn-off）時間，使得脈衝訊號在
轉態時會有上升延遲時間 tdr和下降延遲時間 tdf 的產生（如圖 3B.23 所示）。上升
和下降延遲時間的差值 tdf –tdr 會造成訊號線性度的失真，圖 3B.24 為 tdf –tdr 與
THD+N 的關係圖。以現今的製程技術來看，延遲時間 tdr和 tdf 的絕對值通常為數
個 ns 或更小，因此延遲時間在 Class-D 輸出級電路的設計中並非決定訊號線性度
的主要參數。 
 
Fig 3B.23: 脈衝訊號轉態延遲時間。 
 
Fig 3B.24: tdf - tdr與 THD+N 關係圖。 
輸出脈衝訊號的上升與下降的轉態時間有所不同且其轉態特性為非線性，為
了簡化起見，假設其特性為線性上升與下降且上升與下降的時間均為 trf（如圖 
3B.25 所示）。經由這樣的假設，輸出訊號 VO可看成輸入訊號 Vpwm 與一寬度為
trf 的脈衝訊號作迴旋積（convolution）。因此，輸出訊號為： 
)()()( fHfVfV rfpwmO ⋅=  where ( )
rf
rf
rf ft
ft
fH π
πsin
)( =  
以 trf = 10 ns 為例，Hrf 之-3dB 頻率將高於 40 MHz。因此有限上升與下降時間對
輸出訊號線性度的表現也非決定性的參數。 
 
28 
  3C. 數位控制開關切換模式電源轉換器 
在現今低功率晶片系統設計中，動態電壓調整（Dynamic Voltage Scaling, 
DVS）技術是最有效用且被廣泛應用的方法。DVS 系統需要能與數位電路溝通
且具有高功率轉換效率的電源轉換及控制電路，此電路必須能夠將電池直流電壓
動態調整為系統在不同操作情況下所需的各種電壓準位。在直流電源轉換電路
中，開關切換模式直流電壓轉換器（switching mode DC-DC converters）具有較
高的功率轉換效率，其中又可分為類比控制與數位控制兩類。圖 3C.1 所示為類
比 PWM 控制開關切換直流電壓轉換器之架構圖，透過開關切換，輸入電壓 Vin
可被轉換成不同準位的輸出電壓 VO。為了在不同負載電流、遭受 Vin 擾動以及電
路元件參數差異的情況下，VＯ都能維持一恆定的電壓值，此系統需要一回授迴
路（feedback loop）來調節 VO。在此迴路中，VO與參考電壓 Vref 的差值 Ve 經過
Compensator 得到控制訊號 Vc，Pulse-Wiwdth Modulator 則根據 Vc 產生脈衝寬度
調變訊號驅動開關來調節 VO。圖 3C.2 為數位 PWM 控制開關切換直流電壓轉換
器之架構圖，其中 ADC 將輸出電壓 VO與參考電壓 Vref 的誤差轉為數位訊號 De，
數位控制電路（Digital Control）根據 De計算出數位控制訊號 Dc再經由數位 PWM
（Digital PWM, DPWM）產生並輸出脈衝調變訊號驅動開關來調節 VO。與類比
控制相比，數位控制的優點有（1）不易受元件誤差、老化和元件特性隨環境漂
移的影響；（2）可因應不同情況改變設定參數；（3）可實現複雜的控制邏輯；
（4）易和數位電路溝通。除此之外，先進製程中類比電路的設計越來越艱難，
數位電路卻可從先進製程得到好處（面積、速度），導致為了實現高性能的類比
Compensator 與 PWM 電路所付出的代價越來越高，使得類比控制式開關切換直
流電壓轉換器將逐漸被數位控制式取代。 
 
Fig 3C.1: 類比控制式開關切換直流電壓轉換器。 
 
Fig 3C.2: 數位控制式開關切換直流電壓轉換器。 
30 
 出為 D2，經由如此安排可以得到： 
11
111
22 rrNNO
BE QDQD
V
V +≡+=  
22
222
22 rrNNO
BE QDQD
V
V +≡+=  
其中 N 為 ADC 的位元數，Q1、Q２分別為 VBE1、VBE2 經過 ADC 所造成的量化誤
差（quantization error）。組合以上式子可得到： 
( ) ( ) ( 211121112111 rrrrrr
O
BEBEBE QQKQDDKD
V
VVKV −++−+=−+ )  
經由選取適當的常數 K1，VBE1+K1(VBE1-VBE2)即為能帶繫電壓源。由上式我們可
以從 Dr1 與 Dr2 來計算出 VO與能帶繫電壓源的比值，藉此來調整、控制輸出電壓
VO。在數位能帶繫參考源的產生過程中，ADC 所引進的量化誤差將會導致輸出
電壓偏移理想的能帶繫電壓值。圖 3C.5 為開關切換模式電源轉換器輸出電壓之
示意圖，其中 Iload 為輸出端負載電流、VＯ,i為 VＯ的理想值，由於開關切換的緣故，
在穩定狀態時 VＯ帶有微小的漣波電壓（ripple voltage）Vrip。在不同的負載下，
VＯ必須落在系統規範的容忍範圍 VTB內，因此 
ripTBNBE VV
KV −≤+×
2
2 1
2  
圖 3C.6 為輸出電壓誤差對 ADC 解析度之關係圖。在 VTB=10 mV 的系統規格下，
由圖中可看出此架構所需 ADC 的解析度為 10 位元。 
 
 
Fig 3C.5: 開關切換模式電源轉換器之輸出電壓。 
32 
 3D. 連續近似類比數位轉換器(Successive Approximation Register ADC) 
上一節的數位控制開關切換模式電源轉換器需要一個極低功率的類比對數
位轉換器（ADC）。此 ADC 必須有 10-bit 解析度，操作於 1MSample/s 的速度之
下，它有兩種可能的輸入訊號 VDD 及 VBE2，輸入訊號介於 0.4V 到 0.8V 之間，
系統的參考電壓(VBE1)是會隨溫度變動的，介於 0.4V 到 0.8V 之間，整個系統是
由一個電池供電，它的電壓為 1.2V，為了達到節省功率消耗的目的，加上整個
操作速度的需求我們選用連續近似類比數位轉換器(SAR ADC)。 
 
Fig 3D.1: 典型連續近似類比數位轉換器架構。 
SAR ADC 一般由一個比較器 (Comparator)，一個 Successive Approximation 
Register (SAR)，加上一個電容陣列 (Capacitor Array) 組成，如圖 3D.1 所示。在
這個計畫中，我們從電容陣列著手，減少全部電容的大小，除了能降低功率消耗，
也能大幅降低晶片的面積，為了解釋我們的方法，我們先介紹傳統 SAR ADC 的
操作原理。 
 
Fig 3D.2: 連續近似類比數位轉換器的概念。 
讓我們以一個 3-bit SAR ADC 為例，如圖 3D.2 所示，假設類比輸入訊號為
V1，類比輸入訊號的可能範圍為 Vref。首先 V1 要跟二分之一 Vref 比較，如果
34 
 果來決定電容 4C 的底板(Bottom Plate)接 Vref 或接 GND，在此例中電容 4C 的底
板(Bottom Plate)接 Vref，另外將電容 2C 的底板(Bottom Plate)接 Vref,電容陣列其
他的電容的底板(Bottom Plate)維持接 GND。此時電容陣列當作一個數位對類比
轉換器(DAC)，此 DAC 根據 SAR 傳來的數位訊號在電容陣列的頂板產生一個二
分之一 Vref 以及一個四分之一 Vref 的電壓。電容陣列的頂板電壓跟比較器的正
端輸入電壓相比可以得到一個比較器輸出為 0。此時電容陣列的頂板電壓 
                           refrefiy VVVV 4
1
2
1 ++−=  
最後,在第五個 phase，依照前述的做法,電容陣列的頂板電壓跟比較器的正端輸入
電壓相比可以得到一個比較器輸出為 1。另外我們可以得到電容陣列的頂板電壓 
                       refrefiy VVVV 8
1
2
1 ++−=  
 
 
Fig 3D.4: 12-bit 分段式數位對類比轉換器。 
仔細觀察，我們可以發現，如果我們依照二進位的方式對三個比較器輸出編
碼,我們可以得到一個 5，剛好跟最後一個 phase 的數位對類比轉換器的輸出成一
個倍數關係 
                       )14(
8
1 +×= refDAC VV  
換言之,數位對類比轉換器的線性與否直接影響到整個 SAR ADC 的線性度，而數
位對類比轉換器的線性與否則是由其中的電容比值決定，如果電容比值跟設計有
偏差的話，數位對類比轉換器的輸出就會偏差，而電容的比值精準與否則是跟製
程以及電容的大小有關。身為設計者，我們所能改變的就是電容的大小，為了要
達到較好的電容比值精準，我們需要好的匹配(Matching)，所以不得不使用較大
的電容值。另外在傳統二進位的數位對類比轉換器的實現上，因為最小電容值受
到製程的限制，有其下限，如果需要的 bit 數很高，往往造成整個數位對類比轉
換器的電容陣列要用到很大的電容值。 
大電容值對電路有什麼壞處呢?首先，它會佔很大的面積。第二，電容本身
充放電會消耗較多功率。最後,也是最重要的,他對前級的主動元件電路(ex, buffer, 
filter。)會造成很大的負載(loading) ，為了在一定時間內推動很大的負載，前級
36 
  
Fig 3D.6: 1.5-bit/conversion 的架構。 
 在我們 Redundancy 的做法中需要兩個比較器分別跟兩個不同的參考電壓做
比較,然而兩個比較器的不匹配等因素在 SAR ADC 的運作中可能會引入其他的
錯誤(error)，為了避免這件事，所以我們使用一個比較器在兩個接連的時間
(V[n],V[n+1])分別跟兩個不同的參考電壓做比較，而這兩個不同的參考電壓則由
數位對類比轉換器產生，如圖 3D.6 中下圖所示。這樣的做法就是犧牲了一些速
度來避免錯誤的產生。 
在圖 3D.6 中右上圖的 Redundancy 的做法中我們可以看到它有三種可能的
比較器輸出所以我們需要三種 DAC 的狀態，因此我們必須用圖 3D.7 的做法來
實現數位對類比轉換，在圖 3D.7 中電容陣列除了可能接到 Vref，GND 兩種電
壓外，我們必須加上一個電阻來產生第三種電壓，也就是 0.5Vref。 
 
 
Fig 3D.7: 12-bit 分段式數位對類比轉換器(需要電阻)。 
 
38 
  
Fig 3D.10: 比較器。 
 
Fig 3D.11: 比較器電路。 
在比較器的實現中，我們使用一個 Pre-Amplifier 串接一個 Latch,如圖 3D.10
所示。為了達到節省功率消耗的目的，Pre-Amplifier 只有在需要比較時才工作。
整個比較器電路如圖 3D.11 所示。在此設計中，假設所有元件雜訊是受到
Pre-Amplifier 的元件雜訊所限制，所以我們可以忽略由 Latch 所貢獻的元件雜
訊。設計的考量主要是以元件雜訊(Device Noise)以及操作速度為主。 
以下我們舉例例來介紹 Pre-Amplifier 電路的設計流程。從圖 3D.10 我們可以
得知我們分配 4ns 給 Pre-Amplifier,而整個 ADC 線性度的要求是 10-bit,假設輸入
訊號大小是 1Vpp，假設元件雜訊所貢獻的雜訊功率相當於量化雜訊的四分之
一，所以可以得到元件雜訊所貢獻的雜訊功率為 
2
20.25 (144 V)
12
LSB
n
VP μ=×=  
因為 Pre-Amplifier 的操作時間 tp 以及元件雜訊功率 Pn 都已確定,我們可由下式
求得 gm 
2 24 ( ) (n
m p
P KT
g t
× ×≅ )  
40 
 輸入電容 250fF 
功率消耗(類比/數位) 20uW/NA 
 
參考文獻 
[1]  J. L. McCreary and P. R. Gray, All-MOS Charge Redistribution 
Analog-to-Digital Conversion Techniques-Part 1, JSSC, Dec 1975。 
[2]  R. Jacob Baker and Harry W.  Li and David E. Boyce, CMOS Circuit Design, 
Layout, and Simulation, IEEE Press, 2004。 
[3]  Franz Kuttner, A 1.2V 10b 20MSamples/s Non-Binary Successive 
Approximation ADC in 0.13um CMOS, ISSCC, 2002。 
 
42 
無衍生研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
無 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
