雲端服務縱深安全防護技術研發-雲端服務軟體檢測機制之研究 
第一年期中報告 (1/3) 
計畫編號: NSC99-2218-E-011-018 執行期間: 2010/08/01 ~ 2011/07/31  
計畫主持人: 李漢銘 教授 國立臺灣科技大學資訊工程系 
摘要 
雲端服務應用程式開發過程中，服務可透過第三方(third-party)軟體服務
提供者的網路服務，縮短服務配置與系統開發的過程，降低系統所開發的成本，
然而對於服務安全性的需求更亦顯得重要。動態與即時的雲端服務配置與分享
使得雲本已存在於網路環境的弱點與漏洞，更亦惡化，更因這些漏洞進而影響
整個雲端服務的穩定性與安全性。在雲端服務平台上，以人工方式檢測雲端服
務之漏洞與弱點需大量之成本，以特徵比對為基礎之機制無法適應多元且動態
之雲端服務，而以行為為基礎之檢測機制更因大量服務的產生而在效能上具有
挑戰性，本計畫在雲端計算全面性安全防護技術研發之架構下，對於雲端服務
之程式與資料提出雲端服務軟體威脅與檢測平台核心機制之研究。 
本計畫延續過去跨國資安先進技術計畫研究成果，如：「入侵偵測與事
件分析系統平台」以及其核心資料分析與網路行為塑模技術，對於雲端服務之
惡意攻擊行為進行收集與塑模，以建構出雲端惡意行為與弱點知識庫；基於對
於雲端服務與網路應用層惡意行為與弱點之分析，以建構大規模之雲端服務智
慧型自動檢測平台，以動態檢測之方式即時對於雲端服務與進行檢測(包括：內
容、連結、和執行檔)。 
本計畫可快速且深入地對於現今熱門之資安議題-雲端惡意網頁偵測與事
件分析之核心技術進行研發，鑑於下述三個因素：(1)本計畫可憑藉過去三年
iCAST 所累積的研發能量與溝通平台，包括與卡內基美隆電腦科學系教授
Christos Faloutsos 義務參與合作 (世界知名資料挖掘學者，擅長分析大規模資料
並找出隱含資料中有意義的資訊，引進最先進的大規模網路資料分析技術)。(2)
並藉由業界合作確保發研發出的技術符合實際業界需求(如：關貿網路、趨勢科
技，進行資料分享與惡意網頁攻擊案例之合作研究)。(3)擬將開發成果依照中研
Abstract 
In the development of web application software in cloud service, the 
developers would pay more attention in functionalities rather than the secured source 
code and whole system. It would lead to several vulnerabilities existed in web 
applications, furthermore, these vulnerabilities would damage the organization or 
enterprise information system even to business. Dealing with this problem by using 
pure human efforts, which inspects the vulnerability by hand, would raise the cost and 
make the response mechanism inefficiency. In addition, the polymorphism and 
variance attacks are hard to be observed and recognized as well. In this project, we 
intend solving above mentioned problems by proposing the intelligent web 
application attacks analysis and automatic software testing platform.  
In this project, we extend the result of previewed security operation center 
core mechanism development, “adaptive intrusion detection event analysis platform”, 
to do the further study in network security field. This project is to propose an analysis 
and detection mechanism to against the complex web applications with malicious 
behavior knowledge base in cloud service architecture. Based on web application 
malicious behavior analysis and testing mechanism, we are going to continually 
develop the automatic software testing platform for web application service especially 
for polymorphism and highly variances of attacks behavior. In this platform, we could 
automatically observe and recognize the vulnerability and exploits behind the web 
application scripts and source code in dynamic testing way.  
In order to promote our research result to industry, we plan to collaborate with 
information security company, e.g.: Trand Van Co. and Trend Micro, for sharing the 
real attack cases and data analysis. We will also collaborate with Carnegie Mellon 
University, Professor Christos Faloutsos to develop advanced data analysis 
mechanism. Furthermore, through the collaboration from their penetration cases and 
mythology, we could enhance our platform to match real requirement in both 
functionality and performance. In academic area, this project kernel mechanism could 
fill the existed gap in the field of software testing, information security and 
application in artificial intelligence. 
Keyword 
Malware detection, Sandbox, Fast-Flux 
一、 研究目的 
Fast-Flux 在資安來講，是目前最新興的 Botnet 問題之一。Fast-Flux 利用
DNS 技術的方法，去對受害主機設備來當跳板，且利用快速活動且動態改變受
害主機所對應的 IP 位址，讓其產生更多受害主機，並把自身隱藏在代理伺服器
後面，無法讓別人能找到。隨著網路的發達，當 Fast-Flux 技術越來越盛行，相
對的產生的受害主機也越來越多，當受害主機增多，就會造成使用者的一些個
人資訊被駭客拿來使用。所以該如何降低這些事情發生，就是要能即時的偵測
Fast-Flux 技術，讓使用者馬上就得知此網站是有問題的，來降低受害使用者的
數量。 
惡意軟體 (Malware) 在現今數位的時代，已經造成許多公司有資料外洩、
帳號密碼被竊取等事件發生。一般常見使用的掃毒系統，單純利用特徵辨識的
方式已跟不上病毒突變的速度，如果再加上雲端服務的上線，屆時，一旦受到
惡意軟體的攻擊，損失將更難以估計。對於公共安全議題影響也遠勝於對個人
的威脅，2010 年間大家所關心的議題 Stuxnet [16]（2010 年 11 月 Stuxnet 蠕蟲
攻擊伊朗核電廠，鎖定水庫、油井、電廠等重要基礎設施），而此病毒並無一
般常見惡意軟體會竊取資料或製造大量封包癱瘓系統，讓管理人員防不勝防。 
近年來網頁應用程式已成為服務提供者與使用者之間最主要的溝通管道，
為了與使用者有更即時性的互動，服務提供者經常使用 client side scripting 如
JavaScript 來增加互動性，但這也快速增加了網頁應用程式的安全弱點，使得針
對網頁應用程式的攻擊近年來一直居高不下，其中跨網站腳本攻擊 ( cross-site 
scripting, 以下簡稱 XSS ) 於 OWASP Top 〖 10〗 _([1])更是高居第二名，因此針
對 XSS 攻擊之偵測與防禦，進行相關研究與探討。 
  
Preventing XSS Using Untrusted Scripts：[26] 定義了一連串不受信任的 script 作
為黑名單，用來偵測使用者提供的資料當中是否包含了惡意的  script。 (7) 
Software Testing Techniques：[27, 28, 29, 30] 使用了軟體測試的方法，如黑箱測
試、錯誤輸入、行為監測等，藉由模擬使用者行為，來檢查推斷網頁應用程式
是否存在弱點。(8) Bounded Model Checking：[32] 使用了 counterexample traces 
來減少 sanitization 的次數以及找出程式運行導致錯誤發生的原因。(9) Lattice-
based Analysis：[31] 使用 flow sensitive 和 intra-procedural analysis 來偵測網頁應
用程式弱點。 
 
三、 研究方法 
FF 之研究方法，收集有效的收集完整網域內容，並在對所收集到的內容
去萃取 IP 位址服務；再來利用 IP 位址服務去找出其地理資訊，並得到所對應
其經度和緯度；再利用其經緯度去找出所在的時區位置，並算出時區嫡
(Entropy)；並利用經緯度去找出地理分布資訊算出服務距離，找出其最小的服
務距離，並透過平均值和標準差估計服務關係的接近程度；最後利用貝式網路
演算法並偵測是否為 Fast-Flux 技術。 
惡意軟體檢測之研究方法，欲研究惡意軟體首要工作先是收集惡意軟體
樣本，待樣本數達到一定數量時(各類數量大於兩百隻)，必須透過某家掃毒軟
體作為統一命名的動作，此舉可視為是日後算出分辨率的標準，在此我們將使
用 Linux 中免費的掃毒軟體 ClamAV 作為統一命名的標準。命名後，便可選定
分析系統，送入欲分析的軟體，監控軟體在系統內的執行情形，透過最後產生
的紀錄檔進行惡意軟體行為分析。由於起初紀錄檔所記錄的檔案數量過於龐大
難以分析，因此我們目的擺在縮小分析系統產生之紀錄，而利用這縮減過的紀
錄檔進行惡意軟體的分辨。 
XSS 之研究方法，收集目前 well-known 的 XSS cheat sheet 以及真實案例，
並進行分析找出 XSS pattern 可能注入的點 ( entry point ) 及可達成攻擊效果之組
合 ( attack vector )，即盡可能地從蒐集的資料當中，透過機器學習或資料探勘等
技術，找出所有種攻擊的組合，並結合網頁應用防火牆進行偵測與防禦，而
survey的工作也會持續地進行著，隨時掌握 XSS 最新的變化。 
  
惡意軟體之結果與討論，經由我們減少特徵的數量後，濃縮比例有達到
90% 以上，刪減過後的紀錄經由向量的轉換，採用自由軟體的 LibSVM 進行分
類，證實可以對廣告病毒(Adware)、木馬(Trojan)、和蠕蟲病毒(Worm)分別達
93% 以上的分辨率。下列兩個表格顯示出分析紀錄縮減的成果。 
 
表一. 廣告病毒(Adware.Admedia.exe)的原始分析紀錄，共有 99 行紀錄。 
Adware.Admedia.exe-FileLog 
File Write: 
 
MountPointManager 
DOCUME~1\TWSAND~1\LOCALS~1\Temp\nse2.tmp 
DOCUME~1\TWSAND~1\LOCALS~1\Temp\nse2.tmp\InstGameInfoHelper.exe 
DOCUME~1\TWSAND~1\LOCALS~1\Temp\nse2.tmp\System.dll 
DOCUME~1\TWSAND~1\LOCALS~1\Temp\nse2.tmp\ftdownload.dat 
DOCUME~1\TWSAND~1\LOCALS~1\Temp\nse2.tmp\ns3.tmp 
DOCUME~1\TWSAND~1\LOCALS~1\Temp\nse2.tmp\nsExec.dll 
DOCUME~1\TWSAND~1\LOCALS~1\Temp\nse2.tmp\InstGameInfoHelper.exe 
DOCUME~1\TWSAND~1\LOCALS~1\Temp\nse2.tmp\ftdownload.dat 
DOCUME~1\TWSAND~1\LOCALS~1\Temp\nse2.tmp\ns3.tmp 
DOCUME~1\TWSAND~1\LOCALS~1\Temp\nse2.tmp\nsExec.dll 
DOCUME~1\TWSAND~1\LOCALS~1\Temp\nse2.tmp\defaultthumbnail.bmp 
DOCUME~1\TWSAND~1\LOCALS~1\Temp\nse2.tmp\modern-header.bmp 
. 
. 
. 
File Open: 
 
C:\WINDOWS\WinSxS\X86_Microsoft.Windows.Common-Controls 
_6595b64144ccf1df_6.0.2600.2180_x-ww_a84f1ff9 
 
C:\WINDOWS\WinSxS\X86_Microsoft.Windows.Common-Controls 
_6595b64144ccf1df_6.0.2600.2180_x-ww_a84f1ff9\COMCTL32.dll 
 
C:\WINDOWS\WinSxS\x86_Microsoft.Windows.Common-Controls 
_6595b64144ccf1df_6.0.2600.2180_x-ww_a84f1ff9 
 
C:\WINDOWS\WindowsShell.Config 
C:\WINDOWS\WindowsShell.Manifest 
C:\WINDOWS\system32\SETUPAPI.dll 
C:\WINDOWS\system32\SHELL32.dll 
C:\WINDOWS\system32\SHELL32.dll.124.Config 
C:\WINDOWS\system32\SHELL32.dll.124.Manifest 
C:\WINDOWS\system32\SHFOLDER.dll 
C:\WINDOWS\system32\rpcss.dll 
 
Table 2. 廣告病毒(Adware.Admedia.exe)的縮減分析紀錄，共有 10 行紀錄。 
Adware.Admedia.exe-FileLog 
DOCUME~1\TWSAND~1\LOCALS~1 
DOCUME~1\TWSAND~1\LOCALS~1\Temp 
DOCUME~1\TWSAND~1\LOCALS~1\Temp\nse2.tmp 
C:\DOCUME~1\TWSAND~1 
C:\DOCUME~1\TWSAND~1\LOCALS~1 
C:\DOCUME~1\TWSAND~1\LOCALS~1\Temp 
C:\DOCUME~1\TWSAND~1\LOCALS~1\Temp\nse2.tmp 
C:\WINDOWS\WinSxS 
C:\WINDOWS\system32 
 
XSS 之之結果與討論，預期會產生出關鍵字組合之 Graphic Models，結合
網頁應用防火牆時可將欲檢測 pattern 與 Graphic Models 做相似度比對，如高出
[16] 「行政院衛生署所屬醫院 98 至 100 年度資訊安全監控防護委外服務案」
「防毒監控及服務報告書_10001 
[17] OWASP Top 10, 
https://www.owasp.org/index.php/Category:OWASP_Top_Ten_Project 
[18] Consideration Points: Detecting Cross-Site Scripting. Saha, Suman. 1 & 2, s.l. : 
International Journal of Computer Science and Information Security (IJCSIS), 
2009, Vol. 4. 
[19] Z. Su and G. Wassermann, “The essence of command Injection Attacks in Web 
Applications,” In Proceeding of the 33rd Annual Symposium on Principles of 
Programming Languages, USA: ACM, January 2006, pp. 372-382. 
[20] E. Kirda, C. Kruegel, G. Vigna, and N. Jovanovic, “Noxes: A client-side solution 
for mitigating cross site scripting attacks,” In Proceedings of the 21st ACM 
symposium on Applied computing, ACM, 2006, pp. 330-337. 
[21]T. Jim, N. Swamy, and M. Hicks, “BEEP: Browser-Enforced Embedded Policies,” 
In Proceedings of the 16th International World Wide Web Conference, ACM, 
2007, pp. 601-610. 
[22] Y. Xie, and A. Aiken, “Static detection of security vulnerabilities in scripting 
languages,” In Proceeding of the 15th USENIX Security Symposium, July 2006, 
pp. 179-192. 
[23] Y.-W. Huang, F. Yu, C. Hang, C. H. Tsai, D. Lee, and S.Y. Kuo,“Securing web 
application code by static analysis and runtime protection,” In Proceedings of the 
13th International World Wide Web Conference, 2004. 
[24] V.B. Livshits, and M.S. Lam, “Finding security errors in Java programs with 
static analysis,” In proceedings of the 14th Usenix security symposium, August 
2005, pp. 271-286. 
[25] “JavaScript Security: Same origin,” Mozilla Foundation, 
http://www.mozilla.org/projects/security/components/same-origin.html, February 
2006. 
[26] G. Wassermann, and Z. Su, “Static detection of cross-site Scripting 
vulnerabilities,” In Proceeding of the 30th International Conference on Software 
Engineering, May 2008. 
[27] Y.-W. Huang, S.-K. Huang, T.-P. Lin, and C.-H. Tsai, “Web application security 
assessment by fault injection and Behavior Monitoring,” In Proceeding of the 
12th international conference on World Wide Web, ACM, New York, NY, USA: 
2003, pp.148-159. 
[28] “Web Application Security Assessment,” SPI Dynamics Whitepaper, SPI 
Dynamics, 2003. 
[29] “Web Application Security Testing – AppScan 3.5,” Sanctum Inc., 
http://www.sanctuminc.com. 
[30] Y.-W Huang, F. Yu, C. Hang, C. –H. Tsai, D. Lee, and S. –Y. Kuo.“Verifying 
Web Application using BoundedModel Checking,” In Proceedings of the 
International Conference on Dependable Systems and Networks, 2004. 
[31] Y.-W. Huang, F. Yu, C. Hang, C. H. Tsai, D. Lee, and S.Y. Kuo,“Securing web 
application code by static analysis and runtime protection,” In Proceedings of the 
13th International World Wide Web Conference, 2004. 
[32] Y.-W Huang, F. Yu, C. Hang, C. –H. Tsai, D. Lee, and S. –Y. Kuo.“Verifying 
Web Application using BoundedModel Checking,” In Proceedings of the 
International Conference on Dependable Systems and Networks, 2004. 
 
3. 請依學術成就、技術創新、社會影響等方面，評估研究成果之
學術或應用價值（簡要敘述成果所代表之意義、價值、影響或
進一步發展之可能性）（以 500 字為限） 
Fast-flux 是 Botnet 其中使用的技術之一，主要是為了欺騙使
用者，來達到其目的的利益，例如欺騙使用者一些個人資訊，
而 Fast-flux 技術很難用黑名單給阻擋住，因為 Fast-flux 技術會
快速且動態的變動，讓使用者和黑名單無法馬上辨別。之前的
研究都是要花一定的時間收集 DNS 資訊，且不斷的查詢存活時
間，才可判別出是否用 Fast-flux 技術，利用此方法會造成查詢
時，造成更多使用者受害。因此我們提出利用地理座標快照系
統之即時的方法，對 Fast-flux 技術做偵測、減少受害主機的數
量，並且降低誤報率，達成能快速偵測出 Fast-flux。 
計畫中，我們透過降低分析紀錄檔的大小，加快系統在處
理大量資料時的效率，相較於本文引用的 Rieck et al [8] 用更小
的紀錄就可得到較好的分辨率；Firdausi et al [12] 相比有較低的
誤判率。實驗數據顯示，我們可以減少大約 90% 以上的紀錄、
大於 93% 正確判斷率、小於 7% 的誤判率，這將有助於我們在
雲端服務上對各種軟體做檢測服務有實質的幫助。另外，由於
本計畫所使用的 LibSVM 軟體屬於未經優化過的版本，因此可
隨意替換成其他有分類功能的工具(如：Id3、J48、和 Naïve 
Bayes)達到同樣的效果，此方法並不侷限於某種分類工具。 
長久以來，針對網頁應用程式的攻擊越來越頻繁，使用者敏
感資訊常因為該些攻擊而遭到竊取和利用，其中，XSS 攻擊為最
常見的攻擊之一，本計畫研究成果預期能夠有效地防禦 XSS 攻
擊，能避免駭客透過攻擊竊取使用者敏感資訊 ( 如 cookie 等 )，對
於現行網路銀行或重要入口網站之認證，達到保護的效果。 
 
 
 
 表 Y04 
應包括下列各項： 
1. 參加會議經過 
行程說明: 
以下為本次參與之目的： 
 參與 TAV-WEB 2010 並發表論文 
 參與 TAV-WEB 2010 相關研究發表議程 
 參與 ECML-PDKK 2010  相關研究發表議程 
 參與 ECML-PKDD PSDML 2010 發表論文 
 與參與學者交流與互動 
行程 
 19th October(Monday)：下上抵達比利時 Antwerp  (16:00) 
 20th October (Thuesday)： 發表本計畫之研究成果 
 20th October (Thuesday)： 參與 TAV-WEB 2010 相關研究發 
議程 
 21th October (Thuesday)：抵達西班牙 Barcelona 
 22th October (Thuesday)~24th October (Thursday)：參與
ACM AsiaCCS 會議 
 22th April(Wed.)： 參與 ECML/PKDD 2010 晚宴.   
 
2. 論文發表 
此次參與兩個研討會並發表兩篇計畫的研究成果。首先先說明 TAV-WEB 
2010 的論文發表概況，接著再說明 ECML/PKDD PSDML 2010 論文發表概況。 
 
圖一、於 ECML/PKDD 2010與 Christos Faloutsos 合影 
 表 Y04 
Browser-based Analysis of Web Framework Applications 
雖然 Web 應用發展到成熟的解決方案，提供先進的用戶體驗，但卻也
是讓檢測變得複雜出於同樣的原因。複雜性主要影響伺服器端新的動態頁
面，因為是聚合來自多個來源，因為有大量的可能處理方式路徑取決於參
數。基於瀏覽器的測試是一個適當的工具偵測錯誤考慮內生成的網頁的服
務器端進程和路徑複雜性的黑盒。然而，這些測試的原因並沒有發現一個
錯誤，要設手動偵測。本文提出以生成數據的路徑和部分涉及在伺服器回
溯起源，以便在開發時檢測到的錯誤，這篇研究重點用戶介面原件之網路
框架。 
Browser-based Analysis of Web Framework Applications 
雖然 Web 應用發展到成熟的解決方案，提供先進的用戶體驗，但卻也
是讓檢測變得複雜出於同樣的原因。複雜性主要影響伺服器端新的動態頁
面，因為是聚合來自多個來源，因為有大量的可能處理方式路徑取決於參
數。基於瀏覽器的測試是一個適當的工具偵測錯誤考慮內生成的網頁的服
務器端進程和路徑複雜性的黑盒。然而，這些測試的原因並沒有發現一個
錯誤，要設手動偵測。本文提出以生成數據的路徑和部分涉及在伺服器回
溯起源，以便在開發時檢測到的錯誤，這篇研究重點用戶介面原件之網路
框架。 
Browser-based Analysis of Web Framework Applications 
雖然 Web 應用發展到成熟的解決方案，提供先進的用戶體驗，但卻也
是讓檢測變得複雜出於同樣的原因。複雜性主要影響伺服器端新的動態頁
面，因為是聚合來自多個來源，因為有大量的可能處理方式路徑取決於參
數。基於瀏覽器的測試是一個適當的工具偵測錯誤考慮內生成的網頁的服
務器端進程和路徑複雜性的黑盒。然而，這些測試的原因並沒有發現一個
錯誤，要設手動偵測。本文提出以生成數據的路徑和部分涉及在伺服器回
溯起源，以便在開發時檢測到的錯誤，這篇研究重點用戶介面原件之網路
框架。 
 
 表 Y04 
 
Relational Constraint Driven Test Case Synthesis for Web 
Applications 
作者 Prof. Fu (美國 University of Hofstra)提出一個關係的一關
聯限制導向之技術，並結合自動測試案例測試 Web 應用程序。藉由靜態分
析，可以模擬的 servlet 作為關係傳感器，而操縱後端的資料庫。此外並
提出一個綜合生成一個序列模擬的 HTTP 請求用戶間的交談序列。該算法依
賴於 backward symbolic image computation。透過適應性機制，該技術
可以用於發現攻擊 Web 應用程式的工作流程。此研究在序列處理方面與我
們的論文有一些相似性，但處理的問題較為不同。 
而在參與 ECML/PKDD 2010 的研討會，與合作的美國卡內基梅隆教授
Christos Faloutsos 有對於未來的研究進行討論，Faloutsos 教授並指導
論文報告的方式，以及投影片的呈現。Christos 教授亦為本次研討會閉場
的 Keynote 講者，講題為處理大規模的網絡資料，透過 Random Walk with 
Restart 以及信賴擴散等演算機制。演講內容並保含曾經所分析過的資料
以及所提出的方法，Christos 教授在 graph mining 的領域具有很大的影
響力。 
此外我們報告本計畫另一研究成果為以序列為基礎之攻擊行為偵測，
此研究延續過去 iCAST 先進資安科技跨國研究合作計畫，並與 Christos 
Faloutsos 合作，藉由所提出的相似度比較衡量機制，我們可以將正常與
異常之序列行為區分，並可容忍雜訊等問題，其中使用了真實世界的 Acer 
eDC 經標記後之資料，藉由該資料，由於現今資安領域缺乏分析之資料，
因此許多學者對於 Acer eDC 警報資料感興趣，並希望我們提供分享。此次
發表，有學者對於模型進行推論深感興趣，並給予許多非常有建設性的建
議，例如可清楚描述 Viterbi演算法採用的動機等。 
 
 
 
 
 
 1 
 
國科會補助專題研究計畫項下出席國際學術會議心得報告 
                                日期： 2011  年  5 月 26  日 
                                 
一、參加會議經過 
Conference Held in Korea it talking about advanced communication technologies, and the slogan wan 
“Smart service Innovation through Mobile services”. Actually I knew about this conference by one of my 
advisors and it attract me, for many reasons, the most important reasons are, 1. It covers many areas of 
research that most of them are dealing with contemporary issues and gathers people from different 
domains; “appendix A” shows all these topics discussed in the 13th ICACT conference. Actually, we 
participated in the “Information Security” category, 2.this is the 13th annual for this conference, which 
mean its good quality conference since. Actually I talked to the chairman; he told me the acceptance rate 
was 30-35% of all received papers. 
Conference started on Feb. 13
th
 2011, the first day was open for registration completion, and there was 
only one keynote speech about WiMAX technology. There was 11 sessions that took place in the period 
from Feb. 14th 2011 to Feb. 16th 2011. Each session manage 4-5 different topics in different rooms 
simultaneously, some of the sessions was poster sessions. However, most of them were oral presentation 
sessions, each topic session included 5-6 paper presentations, and reserved 20 minute for authors to 
present their papers and extra five minute for questions and answers. “Appendix B” depicts the 13th 
ICACT conference Schedule.  
 
計畫編號 NSC 99-2218-E-011-018 
計畫名稱 雲端服務縱深安全防護技術研發 － 子計畫二 雲端服務軟體檢測機
制之研究 
出國人員
姓名 
Ismail Adel 
AL-taharwa 
服務機構
及職稱 
Computer Science and 
Information Engineering  
National Taiwan University of 
Science and Technology 
PhD student 
會議時間 
2011年 2月 13日
至 
2011年 2月 16日 
會議地點 
South Korea, Gangwon-do, 
Phoenix Park 
會議名稱 
(中文) 
(英文)The 13th International Conference on Advanced Communication 
Technology (ICACT 13) 
發表論文
題目 
(中文) 
(英文) Obfuscated Malicious JavaScript Detection by Causal Relations Finding 
 3 
Appendix A:  
 Topics ( as follows, but not limited to ) 
 1. BCN, NGN, NGI, IPv6, Future Internet 
 2. Mobile Communication, WiMAX 
 3. Wireless Communication, Satellite Communication 
 4. Digital Broadcasting, DMB, DVB, DTV, CATV 
 5. RFID/USN(Ubiquitous Sensor Network) 
 6. Network Robotics 
 7. ITS, LBS, Telematics 
 8. Digital Home Network, Power Line Communication 
 9. Broadband Satellite and High Altitude Platform Station (HAPS) 
 10. Information Security 
 11. Game, Multimedia & Content, Authoring tools 
 12. IPTV, Internet Telephony (VoIP, MoIP), Smart phone, Web Phone 
 13. Network Security, Management, Operation, and Maintenance 
 14. Optical Network, Packet Transport Network 
 15. Open Programmable Network, Active Network 
 16. System Engineering, Software Engineering 
 17. Groupware, ERP, BPM, Web2.0, Future Web 
 18. GRID, Cloud Computing, Distributed Computing 
 19. e-Governance, ITA/EA, ISP/BPR, e-Government, e-Learning and e-Health 
 20. e-Commerce, Mobile Commerce 
 21. SOA, Service Science 
 22. Low Carbon & Green Growth Policy, System, Service, and Tehnology 
 
 
 
 
 
 
 
 
Advance Program of ICACT 2011 (Session Overview) 
       
Jan. 17, 2011 
Day 1: Feb.13 (Sunday) 
     
Time Session Phoenix Ballroom Ⅰ 
15:00 
~ 
18:00 
 Tutorial  Tutorial 1: Introduction to WiMAX 
        
        
Day 2: Feb. 14 (Monday) 
     
Time Session 
A B C D E F 
Ruby Emerald Diamond 
Phoenix  
Ballroom Ⅲ 
Phoenix  
Ballroom Ⅱ 
Phoenix  
Ballroom Ⅰ 
09:00  
~ 
10:20 
 S1  
1A: Wireless 
Communication 
Technology  
(I) 
1B: Mobile 
Communications 
(I) 
1C:  RFID & 
USN 
Technologies 
(I) 
1D: Digital 
Home Network 
Technology - 
Tutorial 2: 
Cooperative 
communication 
fundamentals 
and coding 
techniques 
10:20  
~  
10:40 
Coffee Break 
10:40 
~  
12:00 
S2 
2A: Wireless 
Communication 
Technology  
(II) 
2B: Mobile 
Communications 
(II) 
2C:  RFID & 
USN 
Technologies 
(II) 
2D: Wireless 
Sensor 
Network 
2E: Poster 
Session (I) 
12:00  
~ 
13:20 
Lunch 
13:20 
~ 
14:40 
 S3  
3A: Wireless 
Communication 
Technology  
(III) 
3B: Mobile 
Communications 
(III) 
3C: Optical 
Networking 
Technology (I) 
3D: Distributed 
Computing 
Technologies 
(I) 
- - 
14:40 
~ 
15:00 
Coffee Break 
15:00  
~ 
16:20 
S4 
4A: Wireless 
Communication 
Technology  
(IV) 
4B: Mobile 
Communications 
(IV) 
4C: Optical 
Networking 
Technology (II) 
4D: Distributed 
Computing 
Technologies 
(II) 
4E: Poster 
Session (II) 
- 
16:20 
~ 
16:40 
Coffee Break 
16:40 
~ 
18:00 
Plenary Session 
19:00 
~ 
20:30 
Opening & Banquet 
  
Advance Program of ICACT2011 (In Session ID Order) - Jan. 17 (Fixed) 
    
No 
Paper 
Number 
Sessio
n 
ID 
Paper Final Title 
1 20110112 01A-01 Dependency of Jitter Variance on PLL Normalized Noise Bandwidth 
2 20110184 01A-02 Antenna Directivity Effect on the Delay Spread at Millimeter-Wave 
3 20110708 01A-03 Applications of Internet of Things on Smart Grid in China 
4 20110203 01A-04 Performance Evaluation of the Reliable Cooperative MAC Protocol in Ad Hoc Networks 
5 20110618 01A-05 Automated Voice based Home Navigation System for the Elderly and the Physically Challenged 
6 20110403 01B-01 Design of a Rectangular Spiral Antenna for Wi-Fi Application 
7 20110092 01B-02 Effective Contention-based Bandwidth Request Scheme for QoS Enhancement in IEEE 802.16e 
8 20110090 01B-03 Service Class Aided Scheduling for LTE 
9 20110012 01B-04 Impacts of CEE and CBS on the Capacity of MIMO-OFDM Systems 
10 20110337 01B-05 Two-Step Paging for Reducing Signaling Costs in Mobile IP 
11 20110402 01C-01 A CMOS Power Amplifier for UHF RFID Reader Systems 
12 20110424 01C-02 Needle in a cross-layer sensor stack 
13 20110214 01C-03 A Joining Mechanism for Efficient Address Management in Low-rate WPAN Mesh 
14 20110677 01C-04 rXPDL: An XML-based Policy Definition Language for Policy-driven RFID Event Management Agents 
15 20110380 01C-05 
The implementation of the intelligent transport system for the real-time roadside environment information 
transfer 
16 20110309 01D-01 Recognition Assisted Dynamic Surveillance System Based on OSGi and OpenCV 
17 20110683 01D-02 Architecture for Smart Grid Based Consumer End Solution 
18 20110229 01D-03 A Functional Architecture for User-Centric Multimedia Service on Mobile Station in Home Network 
19 20110687 01D-04 Application of Converged Communications in Smart Power Consumption Interactive Service 
20 20110035 01D-05 
Evaluation of Adaptive Modulation Technique in PAPR Reduction in OFDM Based High Voltage Power Line 
Communication Systems 
21 20110478 02A-01 
Low Complexity Hybrid Smart Antenna with Directional Elements over Frequency-Selective Fading 
Channel 
22 20110278 02A-02 PAPR Performance of Dual Carrier Modulation using Improved Data Allocation Scheme 
23 20110513 02A-03 GLRT-based Detection in SIRV Clutter with Steering Vector Mismatches 
24 20110717 02A-04 Session-oriented Adaptive Routing for Improving Path Stability in WLAN based Mesh Networks 
25 20110681 02A-05 Study of PAPR Reduction Methods in OFDM Systems 
26 20110130 02B-01 WINA: A Framework to Conserve Energy in Wireless Mobile Communications 
27 20110050 02B-02 A Fast and Accurate ICI Cancellation with Feedback Correction for the LTE-Advanced Uplink System 
28 20110242 02B-03 Analyzing the TCP Performance on Mobile Ad-Hoc Networks 
29 20110100 02B-04 Hierarchical Identity-Based Encryption Authentication Scheme for WiMAX and Femtocell 
30 20110357 02B-05 Performance Analysis of an (m, n) Energy Detector in Fading Environment with Double Threshold 
31 20110297 02C-01 Convergence of Multi-information System based on Web 
32 20110030 02C-02 A Hierarchical Structure based Reader Anti-Collision Protocol for Dense RFID Reader Networks 
33 20110710 02C-03 Gradual Cluster Head Election for High Network Connectivity in Large-Scale Sensor Networks 
34 20110317 02C-04 Secure Authentication and Communication in Ubiquitous Healthcare Middleware 
35 20110398 02C-05 Development of design technique for the performance improvement of ConTracer 
36 20110145 02D-01 On Transmission Efficiency of the Multimedia Service over IEEE 802.15.4 Wireless Sensor Networks 
37 20110485 02D-02 Analysis of Range-Based Localization Schemes in Wireless Sensor Networks: A Statistical Approach 
38 20110371 02D-03 Threshold Based Load Balancing Protocol for Energy Efficient Routing in WSN 
39 20110735 02D-04 Managing Disaster with Wireless Sensor Networks 
82 20110076 04A-04 Frequency Domain Estimation and Time Domain Correction of CFO and STO Offsets in OFDM System 
83 20110415 04A-05 
Symbol Error Rate of M-PSK Modulation in Incremental-Selective Decode-and-Forward Cooperative 
Communications over Rayleigh Fading Channels 
84 20110020 04B-01 Efficient Hybrid ARQ Based on Implicit Information 
85 20110284 04B-02 Opportunistic Feedback with Adaptive Modulation over Multiuser Diversity Systems 
86 20110410 04B-03 An Intelligent Data Structure Approaches for Mobile Devices 
87 20110200 04B-04 IP header translation protocol design and implementation to a post wireless network service 
88 20110727 04B-05 A Novel Bargaining Based Power Allocation for Coordinated Multiple Point Transmission/Reception 
89 20110431 04C-01 Bus FTTH Networks 
90 20110187 04C-02 Performance Evaluation of Hybrid Buffering Optical Packet Switch for Pareto Traffic 
91 20110134 04C-03 Time-Stamping Accuracy in Virtualized Environments 
92 20110318 04C-04 Optoelectronic Subcarrier for Chip-to-Chip Optical PCB Applications Using Long Wavelength VCSELs 
93 20110610 04C-05 
Spontaneous Emission of Silicon-based on 2D Photonic Crystals Slabs with the Honeycomb Lattice and 
Quantum Dot 
94 20110150 04D-01 Distributed Pairing for File Sharing in Large-Scale Peer-to-Peer Networks 
95 20110447 04D-02 A Scalable and Adaptive Cloud-based Message Brokering Service 
96 20110470 04D-03 Resource Discovery in Wireless, Mobile and Adhoc Grids – Issues and Challenges 
97 20110119 04D-04 Improving Content Availability for BitTorrent-like File Sharing employing User-driven Virtualized Nodes 
98 20110607 04D-05 Resource Discovery using Brokering with Dispute Solving in Grid Environment 
99 20110031 04E-01 Load Balancing with Transmission Power Control in Femtocell Networks 
100 20110043 04E-02 
Multiple Mobile Agents for Data Collection in Overflow Time Based Partitions of Wireless Sensor Networks 
with Dynamic Deadlines 
101 20110102 04E-03 
Research on Transmission Method of CDMA Satellite Communication System based on Time Division 
Duplexing 
102 20110202 04E-04 Research on Adaptive Transmission of Time Division Duplex Physical Frame in Mobile Satellite System 
103 20110231 04E-05 e-Discovery Support Tool Design and Implementation of the AGENT Module 
104 20110239 04E-06 Context-based Role Engineering for Ubiquitous Computing Environment 
105 20110501 04E-07 Method for the Home Service of Digital Cinema Contents 
106 20110686 04E-08 Multi-level Intrusion Detection System and Log Management in Cloud Computing 
107 20110702 04E-09 Human Body Parts Candidate Segmentation using Laws Texture Energy Measures with Skin Color 
108 20110166 04E-10 
Implementation of an impact position display system of golf ball using an image processing in an indoor golf 
course 
109 20110397 04E-11 Interactive E-book Authoring system based on MPEG-4 LASeR 
110 20110582 04E-12 U-Sketchbook: Mobile Augmented Reality System Using IR Camera 
111 20110208 04E-13 An Efficient Two-Factor User Authentication Framework for Wireless Sensor Networks 
112 20110296 04E-14 
Improving Localization Accuracy Using Signal Attenuation due to Neighbor signal interference in Wireless 
Sensor Networks 
113 20110312 04E-15 Control Method of Checkpoint Node Selection Using a Fuzzy Rule System and Feedback in CHEMAS 
114 20110054 04E-16 Hardware Development According to ISO 26262 
115 20110123 04E-17 Method of enabling a private IP terminal to receive multimedia data 
116 20110246 04E-18 A Grid Portal for Grid Resource Information Service 
117 20110111 05A-01 
An Efficient Power Transmission System Using Phase Control of Input Electrode Array for Two-dimensional 
Communication 
118 20110300 05A-02 A Simulink-Model of Specialized Processor on Piecewise-Polynomial Bases 
119 20110205 05A-03 Research on the Propagation Delay Characteristic of Multi-beam GEO Satellite Communications System 
120 20110138 05A-04 Dual Band MIMO Antenna Using a Decoupling Network for WLAN Application 
121 20110652 05A-05 Transmit Diversity Scheme with Sounding-based Channel Phase Feedback in OFDMA Systems 
164 20110164 06E-08 Seamless Handover Scheme based on SIP in Wireless LAN 
165 20110334 06E-09 QoS evaluation Based on Extend E-Model in VoIP 
166 20110603 06E-10 Distributed and Parallel Processing of Noise Information for 3D GIS in a U-city 
167 20110519 06E-11 Automating OS/SW Provisioning for Building Enterprise Data Center 
168 20110280 06E-12 
Towards a Secure Patient Information Access Control in Ubiquitous Healthcare Systems using Identity-
based Signcryption 
169 20110733 06E-13 Classifying Attacks in a Network Intrusion Detection System Based on Artificial Neural Networks 
170 20110048 06E-14 Effect of Jamming Technique on the Performance of Direct Sequence Spread Spectrum Modem 
171 20110094 06E-15 A Distributed Intrusion Detection System Against Flooding Denial of Services Attacks 
172 20110662 06E-16 A method for Real-time Detecting and Responding to Harmful Traffic 
173 20110147 06E-17 A Study on Effective Hash-based Load Balancing Scheme for Parallel NIDS 
174 20110684 06E-18 Mechanism for Regenerating CGA Using Threshold Secret Sharing in MANET 
175 20110678 06E-19 Modeling Router Hotspots on Network-On-Chip 
176 20110148 07A-01 Current-Reused Single-Ended Current-Output Multiplier as a Core Circuit in a UWB Pulse Detector 
177 20110071 07A-02 PNS Algorithm and FPGA Design of Wireless OFDM System 
178 20110540 07A-03 Distributed Uplink Power Control Algorithm for QoS enhancement 
179 20110039 07A-04 Power Control in Spontaneously Deployed Wireless LANs 
180 20110557 07A-05 Slot Antenna For Frequency Switchable Active Antenna 
181 20110040 07B-01 Control Packet Scheduling First for Fast Route Discovery in Tactical MANET 
182 20110192 07B-02 Co-channel interference and coverage probability of pilot signal in the IS-95 CDMA forward channel 
183 20110490 07B-03 A Robust Ranging Detection with MAI Cancellation for OFDMA Systems 
184 20110361 07B-04 Mobile WiMAX Coverage Evaluation for Rural Areas of India 
185 20110077 07B-05 A New Source Routing Mechanism in Mobile Ad- Hoc Network 
186 20110267 07C-01 A New Mechanism for Fast Handover between Heterogeneous Networks 
187 20110326 07C-02 QoS Performance Analysis of VoIP Traffic in Heterogeneous Networks with WIMAX Access 
188 20110237 07C-03 Design and Implementation of Low power Wireless IPv6 Routing for NanoQplus 
189 20110488 07C-04 A Modified ACO Algorithm for Multicast State Scalability problem based on Multicast Tree Similarity 
190 20110590 07C-05 Design and Implementation of IMS Service Continuity between IPTV and mobile 
191 20110325 07D-01 A Framework of Defense System for preventing to Insider's Malicious Behavior 
192 20110063 07D-02 Audio Forensic marking using Quantization in DWT-SVD Domain 
193 20110348 07D-03 
A Simple Location-dependent Key Generation Method Based on Multiple Antennas for Securing Wireless 
Communication 
194 20110700 07D-04 Metaware - An Extensible Virus Detection and Removal Toolkit 
195 20110281 07D-05 An Intra-Gateway for Entertainment Content in Digital Home 
196 20110477 08A-01 Improve IPv6 Global connectivity for 6LoWPAN 
197 20110137 08A-02 Min-total Based Relay Power Allocation Algorithm for Multi-user Cooperative Communication 
198 20110023 08A-03 Application of Exponential Window to Design a Digital Nonrecursive FIR Filter 
199 20110268 08A-04 Wireless Transmission of JPEG 2000 Compressed Video 
200 20110272 08A-05 Transmit Power Control Scheme for TV White Space Wireless System 
201 20110136 08B-01 
Using and Effective Algorithm to Resolve the Video-on-Demand Service Network Resource Allocation 
Problem 
202 20110127 08B-02 QoS-aware Active Queue Management Scheme for Multimedia Services 
203 20110046 08B-03 Pre-Processing Directory Structure for Improved RSYNC Transfer Performance 
204 20110721 08B-04 Survivability Measure for Multichannel MANET-based Tactical Networks 
205 20110577 08B-05 A Scheme Based on Coexistence of NSIS and RSVP for Realization of End-to-End QoS Provisioning 
246 20110216 09C-03 Flow-based Enhancements of SAGE Visualization Sharing uisng OpenFlow Programmable Netoworking 
247 20110551 09C-04 A Study on the delay of streaming packets during IP handover between WiFi and CDMA EvDO Rev.A 
248 20110448 09C-05 Rural BcN Projects for Solving Digital Divide 
249 20110059 09D-01 VoIP System based on Asterisk for Enterprise Network 
250 20110597 09D-02 Solving Interoperability Problem of SIP, H.323 and Jingle with a Middleware 
251 20110007 09D-03 An Investigation into the Effect of Security on Reliability and Voice Recognition System in a VoIP Network 
252 20110122 09D-04 Quadrant Based Intelligent Energy Controlled Multicast Algorithm for Mobile Ad Hoc Networks 
253 20110435 09D-05 MOBILE IPV6 FAST HANDOVER TECHNIQUES 
254 20110118 10A-01 Iterative Noncoherent Detection of Coded Differential Space-Time Modulation in Rayleigh Fading Channels 
255 20110032 10A-02 Analysis and comparison on roughness at millimeter wave 
256 20110382 10A-03 A Detection Scheme based on Matrix Partition for MIMO Signal with Distributed Antennas 
257 20110462 10A-04 
A Guide to Channel Assignment and Antenna Placement in IEEE 802.11 Based Multi-channel Multi-radio 
Wireless Networks 
258 20110734 10A-05 
Design and Implementation of Low Cost Microwave Full Duplex System based on WiFi Cards for 
Transmission over Long Distance 
259 20110081 10B-01 A Two-dimensional Classification Model of OSS: Towards Successful Management of the Evolution of OSS 
260 20110156 10B-02 A method for optimizing communication paths in distributed systems 
261 20110160 10B-03 Metric Suite for Assuring the Quality of ERP Implementation and Development 
262 20110588 10B-04 Hybrid Quantum Inspired Neural Model for commodity Price Prediction 
263 20110367 10B-05 A Reliable Framework for Adaptive Scientific Workflow Management Systems Based on SOA 
264 20110460 10C-01 Symbol Timing Synchronization for ISDB-T System in Multipath Fading Channel 
265 20110381 10C-02 A Folded-Cascode Harmonic Rejection Mixer for DVB-T ICs 
266 20110679 10C-03 Theoretical Design and FPGA Implementation of the Baseband Transceiver for the HD Radio FM System 
267 20110221 10C-04 A Multichannel Downstream Receiver Supporting Channel Bonding in HFC Network 
268 20110131 10C-05 DVB-S2 LDPC Finite-Precision Decoder 
269 20110180 10D-01 Smart Power Outlets with Cross-layer Communication 
270 20110065 10D-02 An Efficient Parallel SSHI Rectifier for Piezoelectric Energy Scavenging Systems 
271 20110324 10D-03 Greener ICT: Feasibility of Successful Technologies From Energy Sector 
272 20110174 10D-04 An Comparator Based Active Rectifier for Vibration Energy Harvesting Systems 
273 20110655 10D-05 Implement of An Efficient System to Reduce Power Consumption 
274 20110350 11A-01 SMS Text Messaging: A Ubiquitous Tool for Cheaper Medicine in the Philippines 
275 20110538 11A-02 Application Development With J2ME For Mobile Phone 
276 20110265 11A-03 Secure Quick Response-Payment(QR-Pay) System using Mobile Device 
277 20110210 11A-04 The Evaluation of M-Commerce Interface on Smart Phone in Thailand 
278 20110263 11A-05 The impact of customer’s affective trait on e-service quality and satisfaction - travel website cases 
279 20110358 11B-01 
Unique IDentification (UID) based model for the Indian Public Distribution System (PDS) implemented in 
Windows Embedded CE 
280 20110109 11B-02 Analysis of Human Factors in Software Application Design for Effective User Experience 
281 20110161 11B-03 Quality Assurance Model Capturing ERP Implementation Facets through RVRA Services 
282 20110495 11B-04 The Enterprise 2.0 adoption process: a participatory design approach 
283 20110552 11B-05 Measures of Structural Complexity and Service Autonomy 
284 20110096 11C-01 Telco IPTV Growth Strategy in Taiwan 
285 20110510 11C-02 Demand Forecasting and Strategies for the Successfully Deployment of the Smart TV in Korea 
286 20110168 11C-03 An efficient group rekey scheme for P2P IPTV DRM system 
287 20110228 11C-04 A Study on Frame Encryption for Protecting IPTV Contents 
 5 
Appendix C: Published Paper 
obfuscated benign JavaScript, we measured its performance 
by incorporating variant kinds of benign obfuscation 
techniques such as: Hexa obfuscation, MixUp obfuscation and 
MD5 obfuscation. The experiment results showed better 
attack detection coverage comparing with other baseline 
approaches [11], [10]. 
 
 
(a) 
 
(b) 
Figure 1.  Comparison between obfuscated JavaScript codes: (a) Obfuscated 
benign JavaScript code. (b) Obfuscated malicious JavaScript code 
We present more details of our work in the following 
sections. In Section II, we mention the related works. Section 
III describes the details of the proposed architecture to detect 
obfuscated malicious script. Experiments and evaluations are 
presented in Section IV. Those experiments results are 
discussed in Section V. Finally, we conclude this work in 
Section VI. 
II. RELATED WORKS 
In this section, we state the related works of malicious 
JavaScript detection and obfuscation techniques. 
A. Malicious JavaScript Detection 
JavaScript is flexible in running which make it emergent to 
create interactive Web pages. One problem accompanied with 
JavaScript code is that it is downloaded into Web browsers 
and executed on-the-fly by an embedded interpreter. It 
facilitates a lot of contemporary attacks. Many of them are 
mentioned by David Byrne [1] in one of the Black Hat 
community briefings. This makes it attractive choice for 
attackers to implement their assaults and distribute them over 
the Internet. The most pervasive JavaScript attacks are cross 
site scripting (XSS), SQL Injection and Drive-by-Download 
attacks [3]. Comprehensive study of these attacks with respect 
to the use of JavaScript is provided in [6], [8]. 
Standard JavaScript security solutions implemented by 
most available Web browsers are Sandboxing [13] and 
Security Policies. The former one restricts the execution of 
JavaScript on the client machine. That is, it does not provide 
any built-in support for file access [4]. The latter one includes 
several policies, within which we concern about the Same 
Origin Policy (SOP) that allows the read/write operations 
from the same origin, and disallows any access to content 
from different origins. Origin means the values of protocol, 
host, and port number all together [7]. Those solutions have 
much vulnerability, especially when manipulating distributed 
applications, e.g., easiness of poisoning Domain Name Server 
(DNS) cache with bogus data using JavaScript [9]. Also, there 
are many techniques circumventing SOP using JavaScript 
codes [8]. 
B. Obfuscation Techniques 
Obfuscation techniques originally created for benign 
purposes to protect the copyright of the developers. However, 
it provided a vulnerability to the attackers to evade most of the 
detection mechanisms such as RegExp, rule-based, syntax-
based and signature-based ones by making it impossible to 
trace the code manually or automatically without execution. 
Figure 1 shows two samples of obfuscated JavaScript. 
Likarish [11], [10] first proposed to deobfuscate the scripts to 
trace it. Later he proposed to use some machine learning 
techniques on a set of data features (Specific Features 
Counting) to detect obfuscated malicious JavaScript. 
Deobfuscation solution will be infeasible, especially when 
it have to be done dynamically. Also, the specific features 
solution is effective when collecting the obfuscated JavaScript 
files from black listed domains. However, in real world 
environment we are obliged to distinguish between obfuscated 
malicious JavaScript and obfuscated benign JavaScript, this is 
exactly what the proposed OCRF method does. This work is 
motivated by the presence of obfuscated benign JavaScript in 
the reality [5]. 
We found that there are six principle obfuscation strategies. 
Table 2 gives qualitative comparison between the 
performances of the proposed techniques to detect them. 
III. OBFUSCATED MALICIOUS JAVASCRIPT DETECTION 
SYSTEM 
In this section, we describe obfuscated malicious JavaScript 
detection mechanism based on finding the obfuscating causal 
relations that can reduce the false positive caused by the 
presence of obfuscated benign instances. To deal with most 
situations listed in Table 1, the proposed system consists of 
two hierarchical mechanisms Obfuscation Detection 
Techniques (ODT) and Obfuscating Causal Relation Finding 
(OCRF). The ODT is responsible for detecting the existence 
of obfuscation. Furthermore, the OCRF is used to detect the 
obfuscated malicious JavaScript when obfuscated benign 
JavaScript existing. 
In ODT, we use two obfuscation detection techniques based 
on n-gram and specific features distributions that could be 
automatically plugged-in machine learning classifier to build 
syntax level discriminative models. In OCRF, we propose a 
novel model to convert JavaScript files to the corresponding 
tokens’ sequences. After that, the causal relations extracting 
mechanism based on sequence mining technique is used to 
find out causal relations (semantics) of malicious JavaScript. 
The system architecture is shown in Figure 2. 
A. Obfuscation Detection Techniques 
In order to build a model that learns the obfuscating  
ISBN 978-89-5519-154-7 788 Feb. 13~16, 2011 ICACT2011
 
0t
eP is assumed to be constant in this work. Given two 
sequences of JavaScript tokens 1e  and 2e and their associated 
models 1G , 2G  we refer to [12] work to measure the distance 
between those two sequences which depends on how well one 
sequence is described by the model for another sequence. 
Given that the model G is a negative logarithm of the 
likelihood, we compute the code length of a sequence e as 
follows: 
     .;log; GeLGelGec                   (2) 
We define the dissimilarity (distance) between two sequences 
of JavaScript tokens 1e and 2e as 
    
   
 
,,
1212
1221
21
Gec
GecGec
eed

                  (3) 
where 12e is a new sequence formed by concatenating the 
sequences 1e and 2e . 12G is the associated model of the 
concatenated sequence 12e . 
Given the distance for each pair of sequences, sequence 
embedding seeks to represent those sequences of JavaScript 
tokens in a space so that the distance in the space will 
represent the relation of those sequences in a proper manner. 
We adopted Isomap technique [15] as a manifold learning 
approach before generating dissimilarity matrix to find the 
causal relation representation of JavaScript token sequences in 
the coordination spaces. 
3) Malicious JavaScript Detecting: It is easy to plug-in 
the proposed architecture in any classifier to detect anomalies. 
In this study, we adopted support vector machine (SVM), 
Naïve Bayes (NB) and Alternating Decision Tree (ADTree) 
for malicious JavaScript detection according to the extracted 
features. 
IV. EXPERIMENT RESULTS 
To evaluate the proposed method, first we collected a 
sample dataset; thenl we defined the experimental parameters 
and conditions in addition to the corresponding appropriate 
evaluation metrics. This section discusses those two issues in 
detail, and provides rational evidence on the proposed 
architecture performance based on the results of the conducted 
experiments. 
A. Dateset 
With respect to our objective, we are interested in three 
categories of JavaScript files: (1) plain (non-obfuscated) 
benign, (2) obfuscated benign, and (3) obfuscated malicious. 
Practically we collected plain benign and obfuscated 
malicious JavaScript files. For the remaining category, we 
used obfuscation tools to generate it from the plain benign 
JavaScript; to evaluate the ability of the proposed architecture 
to cover variant benign JavaScript code obfuscation 
techniques. 
All of the categories have been collected using virtual 
machine platforms. We used both Microsoft Windows XP and 
Ubuntu distribution with disabled antivirus software to 
facilitate the download of the malicious JavaScript files. In all 
of our crawling processes we have referred to certain Web 
sites and domains to validate our corpus. To collect benign 
samples we referred to the most frequently visited Web sites 
(first top 100 sites listed in –Alexa Web sites’ ranking page1. 
To collect real world malicious JavaScript, we looked on the 
blacklisted Web pages
2
. Our final corpus consists of 50 
obfuscated malicious samples and 206 plain benign samples. 
Eventually, we formulated three types of datasets using this 
corpus. These datasets contents are manifested in Table IV. 
TABLE 4. PREPARED DATASETS COLLECTIONS 
Set ID Set label Set content 
1 Plain set Contains obfuscated malicious and 
plain benign JavaScript files 
2 Obfuscated sets Contain obfuscated malicious and 
obfuscated benign JavaScript files 
 
For the malicious dataset, it was already obfuscated by the 
attackers. One interesting characteristic of this set is that it is 
not based on unique obfuscation algorithm as what is required 
in [10]. On the other hand, for the benign dataset we 
maintained it without any modification on the ODT method of 
this work. However, we applied different kinds of obfuscation 
techniques using prevalent obfuscating techniques to facilitate 
the operations in the OCRF of this work. 
Several mechanisms of JavaScript obfuscation are available 
to obfuscate the benign set as shown in Table II. We studied 
arrangements and methods used in the obfuscation of benign 
JavaScript. Then we selected the most practical and valid 
techniques to obfuscate the benign dataset. The main 
characteristics we seek in the selected tools are: (1) Portability, 
to ensure the workability of the generated script after the 
obfuscation process in most of the available web browsers. (2) 
Reliability, to ensure that the generated script after the 
obfuscation process satisfies the same intentions of the 
original source script. Two proofed tools used in this work, 
one is Stunnix JavaScript obfuscator commercial software, 
and the other is JavaScript Code Mix Up service provided by 
Tools88
3
 encoding Web site. Also, we incorporated extra 
encryption technique MD5, even it’s not pure obfuscation 
technique; to provide practical evidence on the resistance of 
our solution to the extreme complex obfuscation patterns. 
B. Evaluation Metrics and Experiment Design 
To the best of our knowledge this is the first implementation 
for obfuscated malicious and obfuscated benign discriminator, 
which does not need to perform any kind of de-obfuscation 
preprocessing. We implemented letter ngram, token n-gram 
and specific features works to detect obfuscated scripts using 
the plain set described in Table IV. To evaluate the 
                                                 
1
 [URL]: http://www.alexa.com 
2
 We referred to the sites listed in the following blacklists: 
[URL]: http://malwareurl.com 
[URL]: http://malwaredomainlist.com 
3
 [URL]: http://tools88.com/safe/JSencode.php 
ISBN 978-89-5519-154-7 790 Feb. 13~16, 2011 ICACT2011
VI. CONCLUSION 
In this work we have studied the problem of obfuscated 
JavaScript code, and proposed Obfuscating Causal Relations 
Finding (OCRF) technique to facilitate a better discrimination 
between obfuscated malicious JavaScript and obfuscated 
benign JavaScript. Our goal is to detect obfuscated malicious 
JavaScript with the minimum false positive rates. Our 
contributions are: (1) careful feature extraction, using domain 
knowledge (2) no need for de-obfuscation, since our method 
can be applied directly to the obfuscated script, (3) combined 
obfuscation detection, as well as malicious (obfuscated) code 
detection (4) improved accuracy and significantly reduced 
false positives. (While the average false positive rate of 
competitors is between 0.18 and 0.30, our method decreases it 
to be between 0.03 and 0.1. Moreover, our method is easy to 
implement as a plug-in for a Web browser. 
REFERENCES 
[1] D. Byrne. Intranet invasion through anti-dns pinning. Online: 
http://www.blackhat.com/html/bh-usa-07/bh-usa-07- speakers.html, 
2007. 
[2] C. Chen, A. Liaw, and L. Breima. Using random forest to learn 
imbalanced data. Technical report, Department of Statistics, UC 
Berkeley, 2004. 
[3] M. Cova, C. Kruegel, and G. Vigna. Detection and analysis of drive-
by-download attacks and malicious javascript code. In Proceedings of 
the 19th international conference on World wide web, WWW ’10, 
pages 281–290, New York, NY, USA, 2010. ACM. 
[4] O. Hallaraker and G. Vigna. Detecting malicious JavaScript code in 
mozilla. In ICECCS ’05: Proceedings of the 10th IEEE International 
Conference on Engineering of Complex Computer Systems, pages 85–
94, Washington, DC, USA, 2005. IEEE Computer Society. 
[5] B. Hoffman. Circumventing automated javascript analysis. In Blackhat 
2009 Course Lectures, April 2009. 
[6] M. P. Jayamsakthi Shanmugam. Cross site scripting-latest 
developments and solutions: A survey. International Journal of Open 
Problems in Computer Science and Mathematics (IJOPCM), 1(2):8–28, 
September 2008. 
[7] M. Jensen, J. Schwenk, N. Gruschka, and L. L. Iacono. On technical 
security issues in cloud computing. In Conference on Cloud Computing, 
2009. CLOUD ’09. IEEE International, pages 109 – 116, Horst Gortz 
Inst. for IT Security, Ruhr Univ., Bochum, Germany, Sept 2009. 
[8] M. Johns. On javascript malware and related threats web page based 
attacks revisited. Journal in Computer Virology, 4(3):161–178, August 
2008. 
[9] D. Kaminski. Dns server+client cache poisoning, issues with ssl. 
Online: http://www.blackhat.com/html/bh-usa-08/bh-usa- 08-
speakers.html, august 2008. 
[10] J. E. LIKARISH, P. and I. JO. Obfuscated malicious javascript 
detection using classification techniques. In In Malware 2009, 
Montreal, 2009. 
[11] P. Likarish and E. Jung. A targeted web crawling for building 
malicious javascript collection. In DSMM ’09: Proceeding of the ACM 
first international workshop on Data-intensive software management 
and mining, pages 23–26, New York, NY, USA, 2009. ACM. 
[12] C.-H. Mao, H.-K. Pao, C. Faloutsos, and H.-M. Lee. SBAD: Sequence 
based attack detection via sequence comparison. In ECML/PKDD 
Workshop on Privacy and Security issues in Data Mining and Machine 
Learning (PSDML 2010), 2010. 
[13] D. S. Peterson, M. Bishop, and R. Pandey. A flexible containment 
mechanism for executing untrusted code. In Proceedings of the 11th 
USENIX Security Symposium, pages 207–225, Berkeley, CA, USA, 
2002. USENIX Association. 
[14] M. Sutton. Antivirus struggling with obfuscated javascript. 
Online:http://research.zscaler.com/search/label/obfuscation, June 2010. 
[15] J. B. Tenenbaum, V. D. Silva, and J. C. Langford. A global geometric 
framework for nonlinear dimensionality reduction. Science, 290:2319–
2323, 2000. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
ISBN 978-89-5519-154-7 792 Feb. 13~16, 2011 ICACT2011
99年度專題研究計畫研究成果彙整表 
計畫主持人：李漢銘 計畫編號：99-2218-E-011-018- 
計畫名稱：雲端服務縱深安全防護技術研發--子計畫二:雲端服務軟體檢測機制之研究(1/3) 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 1 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 2 2 100%  
博士生 1 1 100%  
博士後研究員 1 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 1 100% 
人次 
 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 3 0 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
 
