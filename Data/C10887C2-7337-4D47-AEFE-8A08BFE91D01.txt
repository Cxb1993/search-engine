1 
目錄 
 
一、中文摘要......................................................................................................................................2 
二、Abstract ........................................................................................................................................2 
三、緣由與目的..................................................................................................................................2 
四、計畫內容......................................................................................................................................3 
1. 嵌入式生技碟片檢測整體架構.............................................................................................3 
2. 光機檢測伺服機構與壓電微動平台.....................................................................................3 
3. 生醫影像之嵌入式控制系統.................................................................................................4 
4. 光學放大變焦檢測架構.........................................................................................................4 
5. 壓電致動光學切片檢測架構.................................................................................................4 
五、計畫成果自評..............................................................................................................................5 
六、參考文獻......................................................................................................................................5 
 3
極進行研發。目前業界為求降低疾病檢測所需
耗費時間與金錢成本，趨向縮小多種生物反應
過程在一個微小晶片內進行，藉以大幅減少所
需測試消耗樣品量，同時增快生物反應速度縮
短檢測反應時間，進而達到降低檢測過程成
本，因此過去數年已有多個國家投入生物晶片
(Biochip)相關研究亦獲顯著成果。 
由於生物晶片產製需投入鉅額資金，且其
檢測過程需透過特定龐大或昂貴儀器完成，變
成目前居家生活看護所亟需即時生技檢測未
能實現主因。嵌入式可攜生技碟片檢測系統若
能考慮降低成本提高大量使用意願，加上微機
電製程與封裝技術蓬勃發展漸趨成熟，生技碟
片製程及檢測機電元件技術大幅提升，是以
BioCD 未來具有極佳發展空間。 
一般言 BioCD 結構存有多種微流道設計
與不同致動方式，但大體上都以旋轉離心力機
制為驅動基礎，或輔以其它物理或生化作用力
並行，主要因其檢測機制具有高解析生醫顯影
與操作便利性，是以 BioCD 未來具有極佳應
用空間。基於上述生技碟片的便利性及縮減成
本優勢，將會成為家庭與個人醫療平常生活一
環，因此本計畫設定探討其相關規格與檢測機
制，主要著眼其將會是未來數年，成為解決人
類疾病與身體保健方面重要研究主題。 
四、計畫內容 
本計畫年度執行包括嵌入式平台建立、即
時GUI 控制介面、硬體模組研發，及光機檢
測監控策略開發。本計畫這一年度研究方向，
著重在生技檢測嵌入式控制系統開發、檢體影
像擷取辨識分析、壓電致動變焦迴授控制、及
雛型檢測平台實作，藉以配合其生技碟片檢測
系統驅動架構進行工作，主要分為以下幾個部
分說明。 
1. 嵌入式生技碟片檢測整體架構 
由於目前工業界走向嵌入式系統控制趨
勢，本系統軟硬體發展以 ARM 系列硬體做為
工作平台，應用世界軟體趨勢開放原始碼資
源，在控制核心硬體平台內嵌 Linux 作業系
統，並開發圖型使用者介面(GUI)控制系統。
圖 1 所示為本研究嵌入式控制系統與各子系
統相對關係。 
 
圖1 生技碟片檢測嵌入式控制整體架構 
該嵌入式控制系統透過 ARM 嵌入控制
平台與 8051 微處理器，操控馬達伺服機構與
壓電微動平台如圖 2 所示，可控制透鏡組與物
鏡聚焦深度獲得鏡組變焦效果，並可透過共軛
焦架構針孔進行空間濾波，擷取不同焦平面影
像，獲得該檢測系統光學切片特性。 
 
圖2 嵌入程式碼執行檢測機台鏡運動 
2. 光機檢測伺服機構與壓電微動平台 
本計劃完成開發壓電變焦生技碟片光機
檢測雛形平台，如圖3所示，包括對焦與微動
子系統、變焦結構系統、壓電致動之微動平
 5
 
圖 6 壓電致動平台微小位移迴授電壓 
本研究應用共軛焦顯微技術，應用該壓電
致動器驅動一維微動平台，進行縱軸方向微動
位移改變其物鏡聚焦深度，可擷取樣本不同深
度影像，達到光學切片功能。其中，該光學系
統 Z 軸解析度 Zmin 及聚焦深度 DOF，根據採
用鏡片組規格與幾何設計，分別依習知光學公
式計算如下。 
0
min 2 2 2 2
obj
0.88 0.88 1.518 0.55Z 1.11878 m
NA 1.518 1.518 1.25
ηλ × ×= = = μη− η − − −
 
0
2 2
obj
1.518 0.55DOF 0.267168 m
2NA 2(1.25)
ηλ ×= ± = ± = ± μ  
因此，本實驗檢測生醫樣本不同切面，其
微動距離須大於該縱軸解析度，並在該聚焦深
度範圍內方能清楚觀測樣本影像。 
 本系統實施共軛焦顯微技術，可藉由光
學架構加置針孔(pinhole)機制，達到觀測樣本
特定切面的清晰結構目的，主要可利用雷射穿
透陶瓷基板技術，製作孔徑 200 mμ 針孔進行
樣本觀測。系統藉由壓電驅動物鏡及該
pinhole 進行微動，對一血液塗片做血球樣本
擷取影像觀察，如圖 7 所示，其僅能觀測到未
加入針孔影像某一層面，亦即部分非焦平面光
已被濾除。因此，需透過壓電縱軸微動平台，
可取得待測樣本不同聚焦平面光線，亦即獲得
不同樣本層面之光學橫切面影像。 
 
圖 7 具有針孔機制之血液影像 
五、計畫成果自評 
本研究計畫年度執行過程，完成生技碟片
檢測結構本體、壓電致動變焦機構、嵌入控制
技術製作、與影像清晰度辨識設計、生技碟片
變焦檢測系統整合、嵌入式韌體溝通機制建
立、及軟體控制程式開發等。 
由於 IC 製程、光學儀器、及生化科技設
備，亟需開發輕巧、快速且精密位移致動器，
得以研製小體積省成本高性能產品，因此本計
畫所研發壓電致動變焦型生技碟片檢測系統
（II），可對相關產業具有實務性貢獻，加速
國內生醫檢測系統自行研發設備腳步。 
另外，參與本計畫之人員將可經由本系統
設計、分析、製作、測試、及成果評估過程中，
瞭解整個光、機、電、控在系統配合關係，並
可透過執行累積相關知識經驗，藉以達到培訓
光機電系統整合人才目的，可應用於未來開發
各種新型生醫光學檢測系統。 
六、參考文獻 
[1]  楊自森，"分子生醫光電科學與技術"，物理雙月
刊，廿七卷五期，pp. 670-686，2005。 
[2]  吳昭穎，生技碟片及生物快速檢測試劑之視覺化
及自動化量測系統，逢甲大學，自動控制工程所
碩士論文，2003。 
[3]  張瑋茜，嵌入式生醫資訊監控裝置研發，國立台
灣大學，機械工程研究所碩士論文，2005。
 
行政院國家科學委員會補助國內專家學者出席國際學術會議報告 
                                                               97 年 7 月 23 日 
報告人姓名  蔣銘達 
 
就讀校院
（科系所）
                     ■博士班研究生 
華梵大學機電工程學系 
                     □碩士班研究生 
     時間 
會議 
     地點 
7/13/2008-7/16/2008 
 
韓國 大田 
本會核定
補助文號
NSC-97-2922-I-211-001 
(計畫編號：NSC 96-2221-E-211-005) 
會議 
名稱 
 (中文)第六屆 IEEE 工業資訊國際研討會 
 (英文) 6th IEEE International Conference on Industrial Informatics 
發表 
論文 
題目 
 (中文)生醫碟片檢測嵌入式控制之發展 
 (英文) Development of an Embedded Controller for BioCD Inspections 
(中文)生醫碟片檢測之光機電裝置研製 
 (英文) Prototyping of an Optomechanical Apparatus for BioCD Specimen Image 
Inspections 
 
報告內容包括下列各項： 
一、參加會議經過 
    2008 IEEE 工業資訊國際研討會(IEEE International Conference on Industrial Informatics 
-2008) 已於 2008 年 7 月 13 日至 2008 年 7 月 16 日在韓國大田舉行。此次大會係由韓國 RMIT
大學電機工程系主辦，大會約有一百多位學者、專家參與本次盛會。 IEEE工業發展之系統控
制、嵌入式系統、感測器與機器人系統國際研討會涵蓋極廣，此次會議中，論文主要分為兩大
區塊共 27 個領域，分別為： 
SS-TCL Tracking, communication and laser technology 
SS-IPSC Image processing and system control 
SS-EIS Embedded and intelligent systems 
SS-RF RF devices design and wireless technology 
SS-LIE Logistics and industry engineering 
SS-DES Dependable embedded systems 
SS-IEC Future Developments of IEC 61499 Standard 
SS-ITE IT and Energy: Applications and test beds 
SS-ISS Intelligent sensing and sensors 
SS-IR    Intelligent Robot 
SS-IRA Industrial robot and its application 
SS-PCCT Practice of computational intelligence techniques in engineering 
SS-PAC Production automation and control. Innovative future manufacturing 
TT-ISST Information Security, Safety and Trust 
TT-SCT Sensing and Communication Technologies 
TT-SOA Service-Oriented Architecture 
TT-SCML Supply Chain Management and Logistics 
TT-MR Mechatronics and Robotics 
TT-BNA Buildings, Networks and Automation 
TT-CCI Cognitive and Computational Intelligence in Industrial Informatics 
 
 
 
會能多給予機電研究者投入這一領域相輔相成多予鼓勵。 
四、攜回資料名稱及內容 
 2008 IEEE International Conference on Industrial Informatics，INDIN 2008) 論文光碟片。 
 2008 IEEE 工業資訊國際研討會議論文集。 
 
 
II. EMBEDDED CONTROLLER DEVELOPMENT
For the embedded controller, most developing and 
debugging jobs are conducted in the host end, which is 
usually an x86 system. On the x86 platform in this case, 
codes for image processing and sharpness evaluation 
algorithms are developed, and the Borland C++ tool are used 
to introduce human-machine interfacing GUI mechanisms.   
The GUI performs designed communication functions for 
image processing, serial data exchanging, zooming motor 
commanding, etc., as autofocusing the inspected biological 
sample precisely at the demanded location.  Once the 
developed codes are completely debugged and tested, they 
can be transplanted onto the targeted ARM platform, as 
shown in Fig. 1, and then executed to accomplish the 
programmed tasks entirely within the embedded controller. 
Fig. 1 Embedded controller development procedures 
A. Image sharpness evaluation 
For this prototype, sharpness evaluation is very critical as 
acquiring useful samples image from a BioCD during 
autofocusing stages, and it depends heavily that the targeted 
sample is precisely focused through the optical lenses system.  
To successfully achieve the optimal image quality goal, 
adequately exercising geometric optics principles, effectively 
evaluating image sharpness, and accordingly arranging the 
lenses mechanism definitely are imperative on autofocusing 
the inspected samples on a BioCD. 
B. Processing of acquired sample images  
Regarding the sample image manipulation schemes, 
mathematical methodologies using the wavelet and image 
processing computations are attempted to summarize the 
image sharpness comparisons.  The assumed approaches are 
coded in the BCB environment for subsequent controller 
embedment procedures.  In the meanwhile, coefficients of 
the adopted image sharpness evaluation algorithms are 
experimented and adjusted to obtain a satisfactory set.  A 
developed BCB human-machine interface template is shown 
in Fig. 2 once the autofocusing procedures are followed.     
Fig. 2 BCB human-man interface in autofocusing 
III. LINUX-BASED CONTROLLER DEVELOPMENT
This study adopted the Linux 2.4 OS kernel as developing 
the application codes for the x86 platform, where a virtual 
Linux OS environment is setup first with the aids of a 
VMWare tool. 
C. Platform-crossing GUI development tool 
A platform-crossing tool, Qt, provides a necessary 
framework for developing graphic user interfaces in C++ for 
applications. The object-oriented Qt tool, which symbolizes 
relatively portable and expandable, is usually engaged in 
developing GUI modules for platform- crossing applications, 
and is adopted here to fit in with the Linux OS arrangement 
on the ARM processor.  
Furthermore, a QT/Embedded utility which is a Qt C++ 
API tool, is exercised in this study.  The QT/Embedded 
utility, which contains class libraries and signal-slot 
mechanisms, as shown in Fig. 3, for developing embedded 
system, can provide a visualized approach to design the 
graphic user interfaces, and facilitate procedures to simulate 
the embedded system display functions based upon its virtual 
buffer packet mechanism. 
D. Object-oriented signal-slot mechanism 
To replace conventional feedback and information 
reflection mechanism, the object-oriented signal-slot 
mechanism initiates a signal as an event occurs within the Qt 
window, and the signal corresponds to a functional slot for 
executing a designated command.  The signal-slot 
mechanism features in no communications required for detail 
information exchanged among various classes, and remains in 
communicated states regardless of the differences of types. 
XX[W
Fig. 4 Image processing and displaying procedures 
On the other hand, the Pixmap functions illustrate the 
acquired images schematically on display devices.  These 
two functions are utilized alternatively in the prototype, such 
as performing the grayed and binary operations using the 
QImage functions, and then illustrating these information on 
the display screen using the Pixmap functions.    
J. Linux-based serial port communications 
An RS232 serial port establishes communications between 
the ARM embedded controller and the motor driver circuits, 
and a designated library is added with parameter tuned for a 
terminal of the Linux system,  The addressed terminal 
device is accessed to trigger its interrupt code in fulfilling 
read/write tasks, which are intended to control the motors 
through the communication protocol.  
On the other end, the ARM platform receives motor 
controlling signals from the COM1 port, and transmits the 
processed commands to the motor driver circuits through the 
COM2 port, as shown in Fig. 5.  Thus scheduled motor 
movements for the BioCD come into operation, and the 
functioning stats are precisely scheduled.  
Fig. 5 Communications between PC and ARM  
IV. THE DEVELOPED EMBEDDED CONTROLLER
The embedded controller uses an S3C2410X processor 
based ARM920T platform, along with its peripheral devices 
to construct the overall controller board.  Sample images on 
a BioCD are acquired by a CMOS image sensor attached to 
the ARM platform’s USB port, and then processed using the 
embedded image sharpness evaluation module. Based upon 
each evaluation result, the embedded controller sends serial 
commands to corresponding peripherals, i.e., the motor driver 
and the piezoactuator driver circuits, as to command these 
actuators for optimal distances among the lens groups in 
autofocusing.  
Meanwhile, each captured BioCD sample image is 
consecutively displayed on the LCD through the embedded 
controller, and user reactions are managed by exercising these 
developed GUI functions.  Fig. 6 shows the activated LCD 
touch panel, which helps carry out various instructions in 
order to accurately displace lenses for acquiring desired 
sample images.  The coded embedded controller along with 
the BioCD inspection prototype [17] are shown in Fig. 7.
Fig. 6 LCD touch panel displaying acquired images 
Fig. 7 The overall BioCD optical inspection system 
V. CONCLUSIONS
This study has experimentally established an embedded 
controller to inspect BioCD samples through an optical 
apparatus, and the controller is designed mainly to manipulate 
the optical apparatus to accomplish autofocusing tasks.  
Within the embedded controller, image acquisitions are 
triggered consecutively to evaluate each image sharpness, and 
each processed image frame is also displayed on the LCD.  
XX[Y
Prototyping of an Optomechanical Apparatus  
for BioCD Specimen Image Inspections 
Fu-Shin Lee  Rou-Jiun Shiu  Ming-Da Chiang 
Mechatronical Engineering Department  
Huafan University 
Huafan University, 223, Shihtin, Taipei County, TAIWAN. 
fslee@huafan.hfu.edu.tw 
Abstract-An optical inspection apparatus was prototyped 
for examining BioCD samples, and an automatic focusing 
mechanism using an embedded bio-image feedback 
mechanism was built in to control the focusing lenses system 
as to obtain adequate images on the image sensing chip, where 
sharpness of the captured images are evaluated and compared 
for subsequent motor movements. Over the motor course 
motion intervals, piezoactuator minute adjustments are 
henceforth triggered in fine movements to obtain clear images 
of the designated layer within inspected BioCD samples.  The 
prototype is featured in its Linux OS based application on an 
ARM platform, which can execute a variety of servo-motions, 
including fine motions through implementing piezo-actuations, 
once the assistances of processed bio images are employed.  
I. INTRODUCTION
Since biotechnology breakthroughs continuously 
promoted advancements in the biomedical industry, biochip 
and BioCD have become important research topics during 
last ten years.  Correspondingly, diverse inspection 
approaches for BioCDs and biochips have also drawn 
intensive attentions.    
Generally, techniques to inspect biological specimen 
include electrochemical means, refractive index 
measurements, fluorescence detections, optical spectra 
examinations, and mass spectra analyses, and image 
acquisitions for fluorescence indications seem most 
prospective for applications in BioCD specimen inspections.  
For example, a frequency counter alone with a strobe light 
source were used to investigate micro-fluids on a rotating 
BioCD [1], and thus the specimen images during reactions 
can be captured by a CCD.  
On the other hand, clear and serviceable specimen 
images need to be earned through properly designed optical 
lens systems, and adequate magnifications alone with 
image processing techniques behind are inevitable for 
successful specimen examinations.  Hence, mathematical 
formula for designing optical systems [2], which are 
composed of thin lenses or thick lenses, have been 
constantly employed to design optical apparatus for 
inspecting biological samples.  Furthermore, lenses 
assembled in optical apparatus have also been categorized 
into stationary lens groups, magnifying lens groups, and 
focusing lens groups [3] as to achieve their autofocusing 
goals.  
As for image processing and pattern recognizing for the 
fluorescence detections of inspected specimens, automatic 
virus identification methods [4] have been proposed using 
hierarchical approaches, in which acquired image features 
are decomposed into corresponding spectra. Thus, the 
feature information is analyzed through the Discrete 
Fourier Transform (DFT), and the existences of variances 
between the viruses can be observed.  Researches also 
showed that iterative adapting optimal thresholds for 
binarizing biochip sample images is an acceptable 
alternative,  since it can effectively eliminate blotches or 
distortions from acquisition noises [5].   
Meanwhile, non-invasive fluorescence detections are 
improved using the random work theory [6], and target 
positions are thus gauged based upon the emitted 
fluorescence spectrum bands.  Bayesian networks were 
employed to investigate the features of facula (light spots) 
[7], including their sizes, roughness, alignments, intensities, 
background noises, and color bleeding, in order to 
characterize the examined biological specimens.  
Researchers [8] also acquired images using a high-speed 
CCD, which is intended to identify specific micro-channels, 
and the feedback information is utilized to control a 
micro-fluid pumping system for separating designated 
cells.
There have been a variety of autofocusing algorithms 
studied recently for applications inspecting biological or 
industrial samples.  For example in a specific application, 
once an acquired image is segmented into several regions, a 
focus depth evaluation method is employed over the whole 
regions to calculate each region’s sharpness and reconstruct 
the surface profile of a target [9].  Then, separate 
processed regions with their corresponding most clearest 
portions are recombined to form a virtual 3D image in 
X\]`
{GplllGpGjGG
pGpGOpukpuGYWW_P
kjjSGkSGrGq GXZTX]SGYWW_
`^_TXT[Y[[TYX^XT_VW_VKY\UWWGⓒYWW_Gplll
study for the samples and the adequate one was 
implemented into the embedded controller.  
IV. DEVELOPMENT OF AN BIOCD INSPECTION PROTOTYPE
In the prototyped system, the motor and piezoactuator 
control algorithms are executed through a single-chip 
microprocessor once the commands are issued from the 
ARM embedded controller to control the BioCD inspection 
structure, which is formed by those optical lenses and 
accessories.
A. Construction of the BioCD optical Inspection structure 
The optical inspection module is a three-group lens 
architecture with the first group formed by three lenses, and 
the second as well as the third group agglutinated by a 
plastic lens each.  During the magnification courses, the 
third group lens remains stationary in front of the image 
detector chip as the first and the second group are 
conducing linear motions on the optical axis.  The first 
and second group of lenses serve to earn magnified images 
and the third one attends to focus the light beams.  The 
prototype is equipped with an oil-immersed object lens to 
examine tiny samples, and a mercury-arc lamp is employed 
as the light source, whose light beams are projected on the 
inspected sample, and then collected by the image detector 
chip.
The overall structure of the optical inspection prototype 
[12] is shown in Fig. 3, where motor A and motor B are 
used to control the first group and the second group of 
lenses, respectively, for magnification purposes.  On the 
other end, motor C attends to control the object lens to 
perform image focusing.  Label (1) ~ (3) represent the first 
lens group to the third lens group, respectively.  Label (D) 
and (E) stand for the piezoactuator and the high 
magnification factor oil-immersed object lens, respectively.  
B. Design of the embedded controller for the lenses 
To control the BioCD inspection structure, the embedded 
controller uses an S3C2410X processor based ARM920T 
platform, along with its peripheral devices forming the 
overall controller board.  Sample images on a BioCD are 
acquired by a CMOS image sensor attached to the ARM 
platform’s USB port, and then processed using the 
embedded image sharpness evaluation module. Based upon 
each evaluation result, the embedded controller sends serial 
commands to corresponding peripherals, i.e., the motor 
driver and the piezoactuator driver circuits, as to command 
these actuators for optimal distances among the lens groups 
in autofocusing.  
Meanwhile, each captured BioCD sample image is 
consecutively displayed on the LCD through the embedded 
controller, and user reactions are managed by exercising 
these developed GUI functions.  The activated LCD touch 
panel helps carry out various instructions in order to 
accurately displace lenses for acquiring desired sample 
images.   
Fig. 3.  The overall prototyped optical inspection structure 
C. Testing the peripheral circuit for the piezoactuator 
The piezoactuator is driven in a range of -35V ~ +160V, 
and is limited due to its saturation characteristics in 
deformation.  Fig. 4 shows the generated deformation 
measured for the tested piezoactuator once a laser 
interferometer is employed, and the resultant maximum 
stroke provided by the piezoactuator is 22Ӵm.   
ˀ˃ˁ˃˄
ˀ˃ˁ˃˃ˈ
˃
˃ˁ˃˃ˈ
˃ˁ˃˄
˃ˁ˃˄ˈ
˃ˁ˃˅
˃ˁ˃˅ˈ
˃
˃ˁ
˃˄
˃ˁ
˃ˆ
˃ˁ
˃ˇ
˃ˁ
˃ˈ
˃ˁ
˃ˊ
˃ˁ
˃ˋ
˃ˁ
˃ˌ
˃ˁ
˄˄
˃ˁ
˄˅
˃ˁ
˄ˇ
˃ˁ
˄ˈ ʻ̆˸˶ʼ
ʻ̀̀ʼ ˣ˭˧ʳ˗˼̆̇˴́˶˸
Fig. 4.  Laser interferometer measured piezoactuator displacements
D. Design of the BioCD image inspection architecture 
The designed BioCD inspection architecture consists of 
six modules, as shown in Fig. 5, including an image 
processing module, a GUI interface module, an optical 
inspection module, an image feedback module, a motor 
X\^X
B. Experiments for image zooming and specimen transecting 
An standard specimen for testifying optical lens systems 
is employed in this experiment to verify the magnification 
and focusing performances.  As exercising the prototyped 
apparatus, the relative distances between the lens groups 
and the corresponding magnification factors are shown in 
TABLE I.
To exercise the built-in confocal mechanism, several 
images transected from an onion epidermis sample are 
shown in Fig. 9, in which reflected light beams from 
different on-focus planes are captured to display the 
textures, and existence of structure diversities within the 
images indicates the validity of confocal principle.  
TABLE I 
RELATIVE DISTANCES BETWEEN THE LENS GROUPS IN MAGNIFICATIONS 
1st and 2nd 2nd and 3rd 3rd and focus  
100X 34mm 26mm  10mm 
200X 23mm 26mm  10mm 
Fig. 9.  Transected onion epidermis images due to piezoactuator motions 
VI. CONCLUSION
The prototyped optical apparatus to inspect samples on a 
BioCD has been successfully implemented on the 
ARM-Linux based platform, where sample images are 
acquired, processed, analyzed, and compared.  Meanwhile, 
the embedded controlled effectively commands the motors 
and the piezoactuator to displace the lenses mechanism 
based upon the image feedback and sharpness 
computations.  Course motions are performed by the 
motors for magnifications and autofocusing purposes, and 
fine motions are executed by the piezoactuator for the 
confocal advantages.  Accordingly, high resolution 
transected sample images at prescribed on-focus planes are 
obtained with designated magnification factors, and the 
experimental apparatus to verify the designed mechanism is 
thus successfully built.  
ACKNOWLEDGMENT
The authors are grateful to the National Science Council, 
Taiwan, for partial financial support under 
Grant No.: NSC 96-2221-E-211-005. 
REFERENCES
[1] S. Lai, Design and Fabrication of Polymer-Based Micro-Fluidic 
Platforms for Bio-Mems Applications, Ph. D. thesis, Graduate 
Program, Chemical Engineering Department, Ohio State University, 
2003. 
[2] R. E. Stephens, “The Design of Triplet Anastigmatic Lenses of the 
Taylor Type,” Journal of The Optical Society of America, vol. 38, no. 
12, pp. 1032-1038, 1948. 
[3] T. Chunkan, “Design of zoom system by the varifocal differential 
equation,” Optical Society of America, vol. 31, no. 13, pp.2265-2273, 
1992. 
[4] B. Matuszewski and L. Shark, "Hierarchical Iterative Bayesian 
Approach to Automatic Recognition of Biological Viruses in 
Electron Microscope Images,” Proceedings of 2001 International 
Conference on Image Processing, vol. 2, pp. 347-350, 2001. 
[5] T . Kaifel, C. Schiekel, and T. Kampke, "Spotting approaches for 
biochip arrays,” Proceedings of 15th International Conference on 
Pattern Recognition, vol. 4, pp. 356-356, 2000. 
[6] A. H. Gandjbakhche and I. Gannot, "Quantitative fluorescent 
imaging of specific markers of diseased tissue,” IEEE Journal of 
Selected Topics in Quantum Electronics ,vol. 2, no. 4, 1996. 
[7] S. Hautaniemi, H. Edgren, P. Vesanen, A. Järvinen, M. Wolf, O. 
Monni, J. Astola and O. Yli-Harja, “A novel strategy for CDNA 
microarray quality control using Bayesian networks,” Bioinformatics, 
vol. 19, no. 16, pp. 2031-2038, 2003. 
[8] W. K. Wu1, C. K. Liang, J. Z. Huang, ”MEMS-Based Flow 
Cytometry: Microfluidics-Based Cell Identification System by 
Fluorescent Imaging,” EMBC 2004 Conference Proceedings, 26th 
Annual International Conference of the Engineering in Medicine and 
Biology Society, vol. 4, pp. 2579-2581, 2004. 
[9] C. T. Lee, White Light Interferometer for 3D Profile 
Reconstruction –Pro-processing Technique, master thesis, Mech. 
Eng. Dept., Yuan Ze University, Taiwan, 2005. 
[10] Y. C. Chen, Fuzzy Auto- Focus Approaches for Digital Cameras, 
master thesis, Mech. Eng. Dept., National Chung Hsing University, 
Taiwan, 2004. 
[11] http://www.microscopyu.com. 
[12] W. Y. Zheng, Prototyping of a Confocal Zooming Apparatus for 
Biomedical Inspection, master thesis, Mechatronical Eng. Dept., 
Huafan University, Taiwan, 2007. 
X\^Z
TT-DENC Distributed, Embedded and Networked Control 
TT-SME e-Learning for Small and Medium Enterprises SME 
TT-EPT Emerging Platform Technologies in Industrial Informatics 
TT-ENIE Engineering e-Networked Industrial Ecosystems 
TT-FA Factory Automation 
TT-HCM Human Computer and Machine HCMI Interface 
TT-IIA Industrial Informatics Applications 
 
筆者論文[Fu-Shin Lee, Rou-Jiun Shiu, Ming-Da Chiang, Development of an Embedded 
Controller for BioCD Inspections.]安排在 7 月 14 日 17:05 to 17:25 於「TT-DENC1 Distributed, 
Embedded and Networked Control 1)」主題報作講述，本篇論文所研製生醫檢測系統，主要為
結合光機電整合技術，及嵌入式控制平台光學子系統架構，達成影像對焦完成觀測樣本目的。
本論文主要採用嵌入式系統 ARM Linux，做為檢測系統之微控制平台，其控制平台包括影像
處理與自動對焦子系統，可藉以判定迴授之樣本影像清晰度；亦包括週邊驅動子系統，可控制
訊號輸出並驅動馬達，進而改變其光學鏡頭位置，達成光學架構變倍對焦之功能。 完成對焦
動作後，再透過嵌入式控制平台，輸出控制訊號至壓電致動器，利用其壓電微動位移特性，觀
察樣本不同層之切片效果。 
此外，筆者論文 [Fu-Shin Lee, Rou-Jiun Shiu, Ming-Da Chiang, Prototyping of an 
Optomechanical Apparatus for BioCD Specimen Image Inspections.]安排在 7 月 14 日 15:45 to 
16:05 於「TT-IIA3 Industrial Informatics Applications 3)」主題報作講述，本篇論文所研製生醫
檢測系統，主要為結合光機電整合技術，及嵌入式控制平台光學子系統架構，達成影像對焦完
成觀測樣本目的。本論文主要採用嵌入式系統 ARM Linux，做為檢測系統之微控制平台，其
控制平台包括影像處理與自動對焦子系統，可藉以判定迴授之樣本影像清晰度；亦包括週邊驅
動子系統，可控制訊號輸出並驅動馬達，進而改變其光學鏡頭位置，達成光學架構變倍對焦之
功能。 該系統完成對焦動作後，再透過嵌入式控制平台，可輸出控制訊號至壓電致動器，並
利用其壓電微動位移特性，觀察樣本不同層之切片效果。本論文所研製檢測系統，主要以影像
資訊做為迴授訊號，設計一自動對焦的控制流程，將影像資訊經由影像前處理及清晰度判定，
其中影像清晰度判定可藉由清晰度函數計算影像清晰度值，並依此完成該檢測系統自動對焦程
序。  
 
 
 
 
二、與會心得 
在這四天大會中，筆者踴躍參加各種不同領域的研討會，從中我們可以了解目前世界各國
之工業發展之系統控制、嵌入式系統、感測器與機器人系統之研究現況及進展，並藉由與世界
各國學者面對面的討論及溝通，亦能了解世界各國在此領域研究之趨勢，此對國內從事工業發
展之系統控制、嵌入式系統、感測器與機器人系統相關研究有相當之幫助。特別是筆者對於在
此次研討會中所獲得之新知印象特別深刻，對教學及研究均有莫大之助益，特別感謝國科會資
助筆者參加此次會議，希望國科會能多提供機會，給予研究生多參加此類國際研討會，相信對
校內工業發展之系統控制、嵌入式系統、感測器與機器人系統相關教學及研究有相當大的幫助。 
 
 
 
INDIN2008 會場的照片 
三、建議 
我國近年來，由於政府大力支持學術研究，並在教育部全力推動下，學術研究能力大幅提升，
但是在業界產品嵌入式與人機介面虛擬科技整合之研究，似乎還有再加強的地方，是以希望國科
Development of an Embedded Controller  
for BioCD Inspections 
Fu-Shin Lee  Rou-Jiun Shiu  Ming-Da Chiang 
Mechatronical Engineering Department  
Huafan University 
Huafan University, 223, Shihtin, Taipei County, TAIWAN. 
fslee@huafan.hfu.edu.tw 
Abstract-In this study, optical-mechatronical techniques are 
integrated to develop an embedded controller for BioCD image 
sample inspections.  The Linux-based OS is loaded on an ARM 
platform to code the mandatory embedded controller functions, 
including image sharpness evaluations for feedback calculations, 
lenses-carried motor activations for magnifications or 
autofocusing, piezoactuator displacements for transected sample 
imaging, human-machine interfacing (Graphic User Interface, 
GUI) for accepting user instructions, and touch panel LCD 
displays for instant image realizations.  The developed 
embedded controller has verified its performances in an 
experimental BioCD setup. 
I. INTRODUCTION
The main issues of successfully developing an embedded 
controller solely depend on the application objectives, and 
effective eliminations of unnecessary modules selectively 
simplify a prototyped system for accomplishing necessary 
tasks efficiently within a limited time [1][2][3][4][5].
In the aspects of building biological sample inspection 
systems, researchers attempted focusing processes in a PC 
platform using the Borland C++ Builder interface [6], in 
which stepping motors along with precision linear guides are 
employed to build an autofocusing stage, and a CCD is used 
to receive the cell images for samples cultivated through 
tissue engineering.  During the processes, each frame of 
several continuously acquired images is similarly segmented 
into several regions.  Then, the processed regions with the 
clearest portions are recombined to present a virtual 3D image 
representing the original cell image.   
There have been a variety of autofocusing algorithms 
studied recently for applications inspecting biological or 
industrial samples.  For example in a specific application, 
once an acquired image is segmented into several regions, a 
focus depth evaluation method is employed over the whole 
regions to calculate each region’s sharpness and reconstruct 
the surface profile of a target [7].  Then, separate processed 
regions with their corresponding most clearest portions are 
recombined to form a virtual 3D image in representing the 
original one.  Fuzzy focusing algorithms were also 
developed to enhance autofocusing functions [8], and fault 
tolerances due to environmental factors can be established in 
an optical image acquisition system.   
To facilitate the focusing processes, several optimal focus 
algorithms have also been studied.  A discrete difference 
equation prediction model predicting the focusing curve trend 
is employed [9] to reduce the search time on moving the 
lenses for an optimal focus configuration.  For various 
application environments, a scheme for rating image 
sharpness is presented [10] based upon the DCT 
computational algorithms, and it is united with a high-speed 
searching means to effectively reduce the autofocusing time 
and to improve the focusing accuracy.  
As to effectively evaluate image sharpness of common 
examined samples, several approaches to differentiae image 
sharpness are assumed [11][12][13][14], including the well 
known Fourier Transform Method, Discrete Cosine 
Transform Method, and Discrete Wavelet Transform Method 
in the frequency domain, and the Steepest Gradient Method, 
the Total Difference Coefficient Method, the Standard 
Deviation Method, and the Entropy Method. 
In the research conducted by Yao et. al [15], various 
sharpness functions are evaluated and compared to appraise 
their values in all kinds of image acquisition applications, and 
the steepest gradient method is verified to be the most 
effective one, and finally merged with a rule-based searching 
method [16] to secure the optimal focus configuration.    
The object of this study is to develop an embedded 
controller for optical inspections of samples on BioCDs .  
Linux operation systems is employed as the designated 
embedded platform due to its availability of abundant open 
sources and exploitation of interfacing features.  To exercise 
the interfacing techniques between two kernels and to 
examine the performances of the converted codes on two 
different platforms are also important motivations to conduct 
this research.   
XXZ`
{GplllGpGjGG
pGpGOpukpuGYWW_P
kjjSGkSGrGq GXZTX]SGYWW_
`^_TXT[Y[[TYX^XT_VW_VKY\UWWGⓒYWW_Gplll
Hence, this research employed that mechanism to develop 
required functional slots with no format limitations, and 
hence facilitated corporative code executions among different 
formats of components.     
Fig. 3 Signal-slot communication mechanism 
E. Mechanisms for hardware accessions   
The graphic engine at the bottom layer of the 
QT/Embedded utility is basically a “frambuffer” interface, 
which is used to convert the display device into an abstract 
“framebuffer” block, as described for its role in Table I.
Table I!The embedded controller architecture  
Application 
Qt API 
QT/Embedded
Framebuffer 
Linux kernel 
Hence, users recognize these blocks as memory images 
with program addresses, and perform read/write tasks directly 
onto the imaged display screen.  As a result, the 
“framebuffer” blocks are realized as abstract entrances for the 
display devices, and executions of the application codes on 
the top layer consistently access the “framebuffer” block 
areas.
F. GUI developments for BioCD inspections 
In this prototype, the Linux OS is built first on the x86 
platform, and the Qt toolkit is then established on the Linux 
OS.  Three utilities, including Tmake, Qt/Embedded 2.3.7, 
and Qt 2.3.2 for X11, are used in developing the embedded 
controller system 
Once setting up the environment, parameters for building 
the embedded codes are defined to link mandatory files, and 
required crossing libraries are directed to in performing the 
correct linking and compilation processes.  Then, the 
developed codes are embedded into the target platform for 
subsequent executions in the controller.   
In short, the procedures for accomplishing a QT/Embedded 
GUI are briefed as design a graphic user interface, produce 
necessary files for the “Makefile” stage, code a command file 
to generate a “Makefile”, write the main program, and then 
compile the overall codes for this application.   
G. Linux-based BioCD image acquisitions  
 Since the embedded controller is performed on the 
ARM-Linux platform, an image acquisition IC device 
supported by a Linux-supported driver is imperative, and 
therefore a WEBEYE 2000 image processing chip is used as 
the device driver chip in this image acquisition setup.   
As for the employed API, this research utilized various 
hardware based driver functions, such as for the TV card, the 
image acquisition card, the USB CCD, etc. In order to acquire 
satisfactory BioCD sample images, once the hardware devices 
came with drivers to provide compatible functions, the 
research utilized these gadgets and coded required firmware 
to command the integrated image acquisition system for 
successful inspections.    
H. Image acquisition procedures 
In the Linux system, all hardware devises, including the 
image acquisition devices, are treated as virtual files and 
invoked through function calls to acquire sample images.  
The procedures for operating the device are briefly describe 
as: initiate the image acquisition device, read messages from 
the device, acquire sample images from the device, process 
each acquired image frame, and then close the image 
acquisition device.   
Since obtaining image frames is through direct memory 
mappings, this approach is achieved by direct accesses to the 
common shared memory blocks in the kernel. Due to the 
convenient and efficient interfacing mechanism for image 
conversions, the embedded controller in this study can 
therefore readily control the image acquisition device to 
perform efficient assignments.  
I. GUI design for BioCD sample image display 
The prototype also exercises image conversion functions 
after each frame of image are captured, and then exhibits it 
through the QT/Embedded graphic user interface. The flow 
charts shown in Fig. 4 illustrates the procedures that the 
controller processes and displays the acquired BioCD sample 
images, where the QImage functions are intended to convert 
the captured 24-bit full color BMP image files into their 
corresponding 32-bit RGB ones for subsequent processing 
steps.
XX[X
The feedback from each resolved image sharpness then 
effectively commands the motors and the piezoactuator to 
displace the lens groups for exact autofocusing.   
To fulfill the BioCD sample inspection purpose, the 
embedded controller comprising the modules to control the 
autofocusing motors along with the fine-motion piezoactuator, 
the image evaluation  together with the focus searching 
algorithms, the motion control techniques, the communication 
protocols for the peripheral LCD display, and the 
QT/Embedded GUI interfacings, has been successfully 
developed and tested on the ARM-Linux based platform.   
ACKNOWLEDGMENT
The authors are grateful to the National Science Council, 
Taiwan, for partial financial support under 
Grant No.: NSC 96-2221-E-211-005. 
REFERENCES
[1] M. H. Berge, B. Orlic, and J. F. Broenink, “Co-simulation of networked 
embedded control systems, a csp-like process-oriented approach,”  
Proc. IEEE Int. Symposium on Computer Aided Control Systems Conf.,
Munich, CACSD, pp. 434–439, 2006 
[2] T. A. Khan, “Embedded Linux systems for accelerator control 
applications,” 10th ICALEPCS Int. Conf. on Accelerator & Large Expt. 
Physics Control Systems, Geneva, Oct. 10–14, 2005. 
[3] F. M. Proctor and W. P. Shackleford, “Embedded real-time Linux for 
cable robot control,” Proc. of DETC'02 ASME 2002 Design
Engineering Technical Conf. & Computers & Information in 
Engineering Conference, Montreal, Canada, Sep. 29–Oct. 2, 2002. 
[4] V. Yodaiken, P. Cloutier, D. Schleef, P. N. Daly, R. Rajkumar, and B. 
Kuhn, “Development of RTOSes and the position of Linux in the 
RTOS and embedded market,” Proc. 21st Symposium on Real-Time 
Systems (RSS-00), Los Alamitos, CA, No. 27–Nov. 30, 2000. 
[5] Q. Peng, K. C. P. Wang, Y. Qiu, Y. Pu, X. Luo, and B. Shuai, “Fatigue 
Detecting Embedded System Based on S3C44Box,” Int. Conf. on 
Transportation Eng. (ICTE 2007), July 22–24, Chengdu, China, 2007. 
[6] F. S. Huang, The Application of Image Processing Techniques in 
Bio-Medical Detection, master thesis, Mech. Eng. Dept., National Chung 
Hsing University, Taiwan, 2002.  
[7] C. T. Lee, White Light Interferometer for 3D Profile 
Reconstruction –Pro-processing Technique, master thesis, Mech. Eng. 
Dept., Yuan Ze University, Taiwan, 2005. 
[8] Y. C. Chen, Fuzzy Auto- Focus Approaches for Digital Cameras, master 
thesis, Mech. Eng. Dept., National Chung Hsing University, Taiwan, 
2004. 
[9] H. C. Chuang, Design and Application of the Auto-Focus Search 
Algorithm Based on Discrete Difference Equation Prediction Model for 
Digital Camera, master thesis, Mechatronic Tech. Dept. National 
Taiwan Normal University, Taiwan, 2004. 
[10] C. C. Huang, High-Speed Passive Autofocus Technique, master thesis, 
Mech. Eng. Dept., Yuan Ze University, Taiwan, 2001.  
[11] M. Subbarao and J.-K. Tyan, "Selecting the Optimal Focus Measure for 
Autofocusing and Depth-From-Focus," IEEE Trans. on Pattern Analysis 
and Machine Intelligence, vol. 20, no. 8, pp. 864-870, 1998. 
[12] N. K. Chern, P. A. Neow and M. H. Ang, Jr., "Practical Issues in 
Pixel-Based Autofocusing for Machine Vision," Proc. IEEE Int. Conf. 
on Robotics and Automation, vol. 3, pp. 2797-2796. 
[13] K. S. Choi, J. S. Lee, and S. J. Ko, "New autofocusing technique using 
the frequency selective weighted median filter for video cameras," IEEE 
Trans. on Consumer Electronics, vol. 45, pp. 820-827, 1999. 
[14] C. F. Batten, , Autofocusing and Astigmatism Correction in the Scanning 
Electron Microscope, , master thesis, University of Cambridge 
Engineering, 2000. 
[15] Y. Yao, B. Abidi, and M. Abidi, "Evaluation of sharpness measures and 
search algorithms for the auto-focusing of high magnification images," 
SPIE, vol. 6246, pp. G.1-G.12, 2006. 
[16] N. Kehtarnavaz, H. J. Oh, "Development and real-time implementation 
of a rule-based auto-focus algorithm," Real-Time Imaging, vol. 9, 
pp. 197–203, 2003. 
[17] W. Y. Zheng, Prototyping of a Confocal Zooming Apparatus for 
Biomedical Inspection, master thesis, Mechatronical Eng. Dept., Huafan 
University, Taiwan, 2007. 
XX[Z
representing the original one.  Fuzzy focusing algorithms 
were also developed to enhance autofocusing functions 
[10], and fault tolerances due to environmental factors can 
be established in an optical image acquisition system.   
II. BASIC PRINCIPLE FOR OPTICAL LENSES
A. Sharpness curves for images through a lens 
According to the basic lens maker formula in (1), where 
 is the object distance,  is the image distance, and u v f
is the focus length of the lens,  different images for the 
object are obtained at location A, B, or C, and sharpest 
image should be captured at location B since all light 
beams emitted from the object is focused at this location 
through the lens.   
1 1 1
u v f
   (1) 
However, that on-focus condition is not gained at 
location A or C and the corresponding images are relatively 
fuzzy.  No matter which image sharpness calculation 
algorithm is adopted, a typical sharpness curve illustrated 
in Fig. 1.  usually shows the sharpness value hits its peak, 
i.e., the acquired image is clearest, when the image plane is 
located at the focus point, and the sharpness value 
decreases gradually along with fuzzier images when the 
image plane moves away from the on-focus point.   
B. The confocal mechanism for an optical system 
As light beams transmit through a lens, the refractive 
rays project onto an inspected sample and on-focus as well 
as out-of-focus rays from the sample are reflected to the 
detector.  Reflected light beams with the strongest 
intensity are from the on-focus plane transecting the 
inspected sample, as compared with what others are at 
out-of-focus planes.  Once a pinhole is employed to block 
away the reflected light beams from other out-of-focus 
planes, only the selectively transected sample portion on 
the on-focus plane is captured by the image detector chip 
[11], as shown in Fig. 2.  Based upon the confocal 
principle, this mechanism is built in to minutely activate the 
piezoactuator for adjusting the on-focus plane position, and 
therefore to optically acquire sliced images on various 
depths within inspected samples.  
III. BIOCD SPECIMEN IMAGE SHARPNESS EVALUATION
Generally, human visual perceptions do not differentiate 
two frames of very similar images easily, but it is not 
difficult to distinguish them by certain image features, such 
as calculations for abrupt edge changes, line widths, pattern 
areas, overall sharpness, etc. within the evaluated images.  
Typically, an inspected BioCD sample image gets sharper 
if its feature patterns get more eroded, and gets fuzzier if its 
featured patterns get more dilated.  This observation helps 
starting image sharpness evaluation later on within the 
embedded controller   
Fig. 1.  Sharpness curve for varying im e m  plane positions.  ag for
A
ing
B C
Fig. 2.  The confocal principle for an optical system 
A. Image sharpness evaluation algorithms 
To fulfill the goal in evaluating image sharpness of 
examined biological samples, several image sharpness 
calculations are assumed in this study, including the 
Fourier Transform Method, the Discrete Cosine Transform 
Method, and the Discrete Wavelet Transform Method in 
frequency domains, and the Steepest Gradient Method, the 
Total Difference Coefficient Method, the Standard 
Deviation Method, and the Entropy Method in spatial 
domains.   
B. Optimal sharpness searching algorithms 
During the autofocusing process to calculate the 
sharpness of an image, there are several searching 
methodologies to reach the optimal one, including the 
Global Search Method, the Binary Search Method, and the 
Fibonacci Search Method.  All of them were tested in this 
X\^W
control module, and a piezoactuator control module.  The 
optical inspection module grabs biological sample images 
with an image detector chip.  The image processing 
module together with the image feedback module evaluate 
and compare sharpness of acquired image frames in the 
Linux-ARM platform.  The motor control module together 
with the piezoactuator control module drive the lenses 
mechanism to perform the course and fine motions for 
autofocusing and confocal actions, respectively.  In the 
meantime, the GUI module accepts user supervising 
instructions and displays the acquired sample images on the 
LCD screen.   
E. Prototyping of the BioCD image inspection system   
Based upon the design approach, the experimental 
BioCD inspection prototype, as composed of the optical 
inspection mechanism, the embedded controller, and the 
peripherals, is presented in Fig. 6.  In the experimental 
setup, a GUI human-machine interface is also 
supplemented as to display the feedback images and to 
receive user instructions, as shown in Fig. 7.
Fig. 5.  The BioCD inspection architecture illustration 
Fig. 6.  The experimental BioCD inspection prototype
Fig. 7.  The developed GUI touch panel module for acquired images 
V. EXPERIMENTS FOR THE BIOCD INSPECTION PROTOTYPE 
A. Implementation of the autofocusing procedures 
The simplified focusing procedures, as shown in Fig. 8,
are stated as: grabbing an original sample image from the 
image detector chip, processing, evaluating, and comparing 
its sharpness with previous images within the embedded 
ARM controller, and then sending out adequate commands 
for proper motor as well as piezoactuator actions to 
displace the lenses system.  The procedures are repeated 
until a satisfactory autofocusing depth for the inspected 
sample is obtained.  During the fine motion intervals, 
driving voltage for the piezoactuator is delivered to 
minutely displace the confocal mechanism, and only 
deliberately transected images within the inspected sample 
reach the optical detector. 
Fig. 8.  The autofocusing procedures for the BioCD inspection prototype 
X\^Y
