 行政院國家科學委員會補助專題研究計畫 █成果報告   □期中進度報告 
 
用戶端主動參與之線路均載及瓶頸舒緩策略研究 
 
 
計畫類別：□個別型計畫   █整合型計畫 
計畫編號：NSC 98－3114－E－110－004－ 
執行期間： 98 年 11 月 01 日至 99 年 12 月 31 日 
 
執行機構及系所：國立中山大學電機工程學系 
 
計畫主持人：盧展南 
共同主持人：劉承宗、李宗璘、鄭志強、高崇堯、陳志維、葉增雄、曾聖有 
張榮芳、陳曦照 
計畫參與人員：李聰、詹育泓、黃耀毅、呂姿儀、黃子峰、羅鳴、薛志洪 
戴良宇、黃崇業、范柏文、吳旻諺、江亭毅、陳志豪、簡瑜廷 
黃偕洲、蔡宗霏、王奕翔、黃靖智、黃博儀、林建宏、林筱秋 
陳育杰、陳開瑞 
 
成果報告類型(依經費核定清單規定繳交)：□精簡報告  █完整報告 
 
本計畫除繳交成果報告外，另須繳交以下出國心得報告： 
□赴國外出差或研習心得報告 
□赴大陸地區出差或研習心得報告 
█出席國際學術會議心得報告 
□國際合作研究計畫國外研究報告 
 
處理方式：除列管計畫及下列情形者外，得立即公開查詢 
            □涉及專利或其他智慧財產權，□一年□二年後可公開查詢 
 
中   華   民   國  100 年 1 月 31 日 
V 
 
圖目錄 
圖 1.1 電力系統輸配電壅塞瓶頸發生原因魚骨示意圖 1 
圖 1.2 本計畫各主要工作項目關聯圖 2 
圖 1.3 含三條饋線之配電系統（綠–住宅區；紅–工業區；橘–商業區） 3 
圖 1.4 圖 1.4 子計畫二實驗平台 4 
圖 2.1 含三條饋線之配電系統 6 
圖 2.2 於配電系統中加入一台分散式電源之可靠度指標（縱座標左方刻
度為 SAIDI 值、右方刻度為 SAIFI 值） 8 
圖 2.3 含四台分散式電源之配電系統 10 
圖 2.4 分散式電源之切入時機對配電系統可靠度及變電所負載改變之影
響 12 
圖 2.5 高分子聚合物電解質膜燃料電池構造圖 15 
圖 2.6 高分子聚合物電解質膜燃料電池設備基本架構圖 16 
圖 2.7 本計畫所採用之高分子聚合物電解質膜燃料電池設備外觀圖 17 
圖 2.8 本計畫所採用之燃料電池設備圖控操作介面 17 
圖 2.9 本計畫針對燃料電池控制之系統架構示意圖 18 
圖 2.10 不同功率訴求下燃料電池之電流與指標函數
2H
λ 之響應變化圖 20 
圖 2.11 不同功率需求下含強韌性 PID 控制架構之燃料電池指標函數
2H
λ
響應變化圖 20 
圖 2.12 不同功率需求下含強韌性 PID 控制架構之燃料電池電流之響應變
化圖 21 
圖 2.13 不同功率需求下含強韌性 PID 控制架構之燃料電池電壓V (%)mfc
之響應變化圖 21 
圖 2.14 直接注入三相功率之分散式電源 22 
圖 2.15 含變流器介面組合之電源 22 
圖 2.16 雙饋式風力發電機示意圖 24 
圖 2.17 太陽能模板之等效電路 25 
圖 2.18 利用 MATLAB/Simulink 所建構之太陽能模板電路模型 26 
圖 2.19 當照度固定時太陽能模板隨溫度改變之 I-V、P-V 曲線 26 
圖 2.20 當溫度固定時太陽能模板隨照度改變之 I-V、P-V 曲線 26 
圖 2.21 太陽能光伏陣列之等效模型 27 
圖 2.22 搭配擾動觀察法之 DC-DC 升壓電路示意圖 28 
圖 2.23 市電併聯型光伏發電系統與 MATLAB/Simulink/SimPowerSystems
整合之電路 29 
圖 2.24 市電併聯型光伏發電系統動態模擬結果 29 
圖 2.25 裝設兩部不同型式分散式電源之配電系統與
MATLAB/Simulink/SimPowerSystems 整合之電路 30 
圖 2.26 裝設兩部不同型式分散式電源之配電系統市電端提供之功率與匯
流排電壓變化 31 
圖 2.27 配電系統連接至兩部不同型式分散式電源之匯流排電壓變化 31 
圖 2.28 配電系統連接至兩部不同型式分散式電源時風力機投入前後匯流
排 13 之功率流動變化情形 32 
VII 
 
圖 3.35 單一換流器輸出電流 1.5 A 57 
圖 3.36 雙模組換流器同步並聯電力網路電流輸出 0.5 A 波形(TPC1:0.2 A; 
TPC2:0.3 58 
圖 3.37 雙模組換流器同步並聯電力網路電流輸出 3 A 波形(TPC1:1.5 A; 
TPC2:1.5 A) 58 
圖 3.38 人機介面控制圖 59 
圖 3.39 系統換流器併聯流程圖 59 
圖 4.1 研究流程圖[4-2] 61 
圖 4.2 模擬系統架構圖 61 
圖 4.3 系統模擬流程圖 64 
圖 4.4 各策略日發電量百分比曲線圖 65 
圖 4.5 策略發電量模擬流程 65 
圖 4.6 計算超載機率與超載量流程 66 
圖 4.7 台灣 97 年系統負載曲線圖 68 
圖 4.8 各策略系統超載機率圖 69 
圖 4.9 各策略系統超載風險圖 69 
圖 4.10 三相配電系統狀態估計(SE)之架構 71 
圖 4.11 北市區處各類型用戶日負載模型[4-9] 72 
圖 4.12 高雄區處各類型用戶日負載模型[4-9] 72 
圖 4.13 饋線上之測量值分佈 74 
圖 4.14 執行狀態估計程式流程圖(第一階段) 75 
圖 4.15 執行即時負載潮流程式流程圖(第二階段) 76 
圖 4.16 12 個匯流排之簡易饋線 77 
圖 4.17 饋線上測量值分佈 78 
圖 4.18 循序饋線負載潮流分析演算法 84 
圖 4.19 領域分解轉換 86 
圖 4.20 非同步軟體管線執行 87 
圖 4.21 工作重疊轉換 88 
圖 4.22 增進工作重疊轉換 89 
圖 4.23 領域分解平行演算法 90 
圖 4.24 工作重疊平行演算法 92 
圖 4.25 增進工作重疊平行演算法 93 
圖 4.26 平行演算法的加速 94 
圖 4.27 分散式電源容量求解流程圖 98 
圖 4.28 OPC 曲線類型 99 
圖 4.29 饋線電力負載圖 101 
圖 4.30 OO 混合 PSO 的求解流程圖 103 
圖 4.31 台電測試系統[4-43] 104 
圖 4.32 DG 最大容量 OPC 曲線圖 105 
 
摘要 
由於負載的成長，電力公司大量運用現有輸配電設備。除了以往利用增設輸變電
設備以改善系統可靠度的方式，漸漸地電力公司亦以系統運轉調度的方式解決可
靠度的問題。影響系統可靠度最重要的因素是輸配電的超載運轉，線路壅塞是因
為過重的負載造成系統不穩定或超過規劃準則中的標準。智慧型電網技術如利用
資通技術、先進設備及軟體正漸漸被開發來維持系統穩定度及支援有效的電力市
場運作。在許多解決方案中，負載端管理及分散式能源如分散式電源及能源儲存
設備，可被運用來強化系統可靠度、降低系統損失、舒緩輸配電壅塞及降低二氧
化碳排放。然而這類方案會造成與系統間的相互影響，如電壓分布、電力品質及
系統穩定度的問題。本整合型計畫擬對台灣目前及未來可能面對的輸配電線路壅
塞的問題加以研究，並研擬利用分散式電源、能源儲存設備及需量反應等延緩輸
變電投資的可行策略。 
關鍵字：網路壅塞，用戶參與，分散式能源，需量反應，系統穩定度，系統可靠
度，電力品質，成本效益分析 
 
II
1 
 
第一章 簡介 
近年來，智慧電網、再生能源及分散型能源技術在先進國家進展迅速，除
政府帶動相關產業政策外，其發展原因主要為尋求電力品質與可靠度的提昇、備
用電力與輸配電系統架設成本的減少或延緩。台灣在電力供給上所面臨的挑戰主
要在於用電可靠度及品質需求的提高。由於台灣欠缺市場機制無法有效控制區域
性的負載需求，在部分都會區域因為負載過度集中，已存在有輸電壅塞的現象且
造成系統故障電流過大的問題。國內外案例顯示，若以現有系統增建變電所及輸
電線的策略，將可能無法及時應付負載的成長而有停限電的可能。 
對於智慧型電網的願景及功能需求因各國國情而異，在分析了解本地電網的
弱點之後，研擬由目前電網升級至智慧型電網的各種策略，將可提昇系統可靠度
支援本地產業發展。以本計畫所欲研究的輸配電瓶頸問題而言，經分析歸納後我
們可以將其可能的原因以如圖 1.1 所示。 
 
 
 
圖 1.1  電力系統輸配電壅塞瓶頸發生原因魚骨示意圖 
 
本計畫從用戶端負載及能源管理，尋求舒緩輸配電線路壅塞的可行方案。本
計畫運用用戶端分散式電源及電能儲存設備裝置，配合用戶主動參與之需量反
應，尋求一可靠又有效的調配操控策略，來一方面達到用戶於尖峰時間對電力公
司電能供應需求的降低，減少電費支出和線路損失及節能減碳的效果；另一方面
亦能夠透過這些電源的適度調控，以達到解決配電系統短時間過載，而又無法建
置變電所以提高整體供電量之輸配電瓶頸情況的發生。本計畫的目標希望執行的
工作成果可以實際地對台灣電力系統因為輸變電設置困難度增加所導致的供電
可靠度降低問題，提供可行的解決策略；而所欲發展的相關技術契合能源國家型
科技計畫中有關智慧電網與先進讀表基礎建設內所希冀達到的「發展需量反應及
需求端管理之驗證技術」及「發展含分散型電源之配電系統分析能力」兩大項核
心技術；且亦能達成「建立自動讀表、電力品質監測、停電管理及需量控制之整
合技術」中的部分技術需求。 
本整合型計畫含以下子計畫： 
子計畫一：配電系統分散式電能規劃與動態控制  (主持人:  劉承宗) 
子計畫二：分散式電源系統電力品質改善與儲能系統控制策略  (主持人:  李宗
璘) 
子計畫三：區域輸配電線路瓶頸之改善策略研究  (主持人:  盧展南) 
 
本計畫朝「解決輸配電壅塞瓶頸狀況」來努力，子計畫分成規劃設計、系統
3 
 
制器設計，使得配電系統在遭遇干擾時，此控制器應有讓相關子系統及整
體配電系統回復原有效能之能力。 
z 完整建構 Inverter‐based 分散式發/儲電設備之系統動態模型，並探究可能
的饋線連接情況下配電系統的動態性能。 
z 系統擾動對此配電系統動態穩定度之影響及各分散式發/儲電設備之過渡
指標評估；配電系統解聯時可能的孤島運轉對各分散式發/儲電設備之控制
因應設計。 
 
圖 1.3  含三條饋線之配電系統（綠–住宅區；紅–工業區；橘–商業區） 
 
在配電系統中分散式電源的電能規劃工作中，最關鍵的項目就是要掌握這些
相關系統裝置在不同工作時機及條件下的可靠度，以提供系統一較為明確的相對
可供電度指標。而分析系統可靠度的首要工作，乃是建立系統內各個單元運轉發
生錯誤之機率分佈、發生錯誤後所能供給之電力、及恢復完全供電的修復時間等
等與計算可靠度相關的因子。接著根據這些因子，研究人員才能以不同的方法去
計算系統的可靠度指標。 
而對於這些含有分散式電源的配電系統運轉而言，不論是內在的完整掌握各
條饋線內負載間運轉的狀態穩定性；亦或是外在的因為電網中不同的操作狀態變
動對於這些相對而言規模小得多的分散式電源將產生相當的擾動現象時，各饋線
內運轉的分散式電源是否能穩定運轉且平順地度過此動態變化。等等問題在操作
設定及穩定度控制上將採取何種配合措施，都必須先透過詳盡的分析與設計方能
預先掌握可能的結果。為求本部分計畫工作的成功執行，必須在有關的電機設備
操作可靠度指標及電機參數方面能夠有完整的數據及資訊。因此在工作進行的方
法上，我們亦擬透過一些精準之有限元素套裝軟體 JMAG來詳盡的探究各種分散
式電源及儲蓄電設備相關的運轉模型參數。如此方能夠在相關的技術評估執行層
面工作進行前，能夠有詳盡且具有足夠可信度的計算依據。而接續的本計畫在此
一部分的工作將利用模擬軟體 MATLAB/SimPowerSystems及 ATP/ATPDraw 針對這
類微電網進行設備模型及系統模型的建立與模擬分析。 
 
子計畫二  分散式電源系統電力品質改善與儲能系統控制策略，主持人:  李宗璘
教授(中山大學)，共同主持人:  曾聖有教授(長庚大學)、陳志維教授(虎尾科大) 
 
透過反流器為基礎連接至配電網路的再生能源或潔淨能源的供電架構日漸
受到重視，諸如太陽能發電、風力發電、燃料電池、微型渦輪等，均可透過電力
電子界面反流器而提供電力至電網，這種分散式的供電架構不僅增加供電可靠度
5 
 
子計畫三  區域輸配電線路瓶頸之改善策略研究，主持人:  盧展南(中山大學)，共
同主持人:  張榮芳教授(高苑科大)、陳曦照教授(高苑科大)，李聰教授(中山大學) 
 
本子計畫希望從用戶端能源管理的思維，以分散式能源及需量反應的策略
尋求尖峰時刻線路壅塞舒緩之道。本子計畫的主要工作為：1.含分散式電源之配
電系統模擬及運轉分析；2.區域輸配電線路瓶頸之改善策略，而此二項工作具體
內容可細分為： 
- 配電系統及分散式能源模型建立 
- 配電即時負載潮流及狀態估計 
- 提高分散式能源之饋線重組 
- 以分散式電源系統改善輸配電瓶頸之策略 
 
本計畫思考運用用戶端分散式電源及電能儲存設備裝置，配合用戶主動參與
之需量反應，尋求有效的調配操控策略，來達到用戶於尖峰時間對電力公司電能
供應需求的降低，減少電費支出和線路損失及節能減碳的效果；另一方面亦能夠
透過這些電源的適度調控，以達到解決配電系統短時間過載。在配電監控系統雖
然可提供調度人員系統部分即時資料，但目前很少運用在運轉最佳化上，主要是
因為即時資料不夠多，無法提供分析所需之完整系統模式資料，因此目前配電系
統規劃運轉仍以尖離峰等資料為分析依據。配電系統主動式管理需要配電系統的
即時狀態資料。本子計畫利用用戶用電資料、先進讀表系統及配電自動化系統中
的即時監視資料，建立系統的狀態估計來進行整合性配電系統管理並對用戶端電
源加以管理，透過饋線自動開關的操作達到運轉最佳化。 
 
7 
及表 2.2。圖 2.1 中饋線 1(F1)為供應住宅區；饋線 2 (F2)為供應工業區，而饋線 3 (F3)
則為供應商業區。 
本計畫擬針對在系統中加入分散式電源以解決配電壅塞並提升系統可靠度。在此將
表 2.1 配電系統各匯流排負載資料 
Bus λ (faults/year) r (hours/fault) Load (MW) Power Factor 
B2 0.001 5.0 0.0 1.00 
B3 1.00 0.5 1.2 0.85 
B4 0.50 0.8 1.0 0.88 
B5 0.60 1.1 1.4 0.87 
B6 1.20 1.0 1.2 0.90 
B7 1.10 1.8 1.6 0.86 
B8 1.50 1.8 5.1 0.97 
B9 2.00 0.6 4.2 0.96 
B10 1.80 0.9 6.0 0.98 
B11 0.50 1.4 4.1 0.96 
B12 0.80 1.8 6.2 0.97 
B13 1.00 0.9 5.2 0.97 
B14 1.50 0.7 3.6 0.92 
B15 2.00 1.4 2.5 0.90 
B16 0.60 1.2 2.5 0.95 
B17 0.70 1.5 4.6 0.98 
B18 1.10 0.8 2.1 0.93 
B19 0.80 1.0 2.1 0.94 
 
表 2.2 配電系統各饋線之線路參數 
Line λ (faults/year) r (hours/fault) Distance (km) XLPE Cable Area (mm2) 
FCB1 0.04 2.0 1.0 150 
FCB2 0.04 2.5 1.1 1800 
FCB3 0.05 1.5 1.4 500 
S1 0.08 0.5 1.5 150 
S2 0.07 0.8 1.2 150 
S3 0.02 1.0 0.7 150 
S4 0.06 1.1 0.9 150 
S5 0.01 2.0 2.5 150 
S6 0.05 3.0 2.3 1800 
S7 0.06 3.2 2.5 1800 
S8 0.05 1.2 2.3 1800 
S9 0.04 4.0 1.7 500 
S10 0.08 3.5 1.0 150 
S11 0.06 3.6 1.3 500 
S12 0.01 2.0 3.0 150 
S13 0.09 1.0 1.1 150 
S14 0.10 1.2 2.5 500 
S15 0.08 2.0 2.2 150 
S16 0.07 2.5 1.5 150 
S17 0.01 3.0 1.5 150 
9 
客戶數量不盡相同，因此加裝分散式電源後所能改善的可靠度指標量也不同。在此系統
中，每一匯流排的負載用戶數量為 1~3 戶，在計算可靠度指標時相當於一個變化量很大
的權重，在匯流排 11 與 13 處其用戶數量皆為一戶而其它的工業區匯流排的負載用戶數
量皆為兩戶，因此可靠度指標值並沒有單純的隨著離變電所距離增加而改善。由系統架
構圖可以看出，雖然匯流排 13 和 17 與變電所的距離相同，其可靠度指標差異量卻相當
大，在匯流排 13 加入分散式電源的可靠度甚至比在匯流排 12 加入分散式電源來得差。 
在分析完一台分散式電源對配電系統可靠度指標的影響後，接著針對在住宅區、工
業區、商業區各加入一台分散式電源，並將分散式電源的供電容量增加至饋線所能容忍
的功率上限（該區域總負載的 30%）。此時分散式電源依其供電容量大小與周圍線路容
量將可以支援附近的匯流排負載需求，在此情況下因可選擇支援負載的方式眾多（如分
散式電源位於匯流排 11 時，當其上游發生故障，分散式電源可選擇供應匯流排 9、11
或 11、12 或 10、11），而其可靠度指標值為三個變數（分別為住宅區、工業區、商業區
之分散式電源位置）的函數，由於其結果排列組合眾多，無法純以圖 2.2 的方式呈現。
如表 2.3 所示為將商業區之分散式電源安置於匯流排 19 時，住宅區分散式電源分別位於
匯流排 3~7、工業區分散式電源分別位於匯流排 8~13 之歸納計算結果，其列為住宅區
分散式（DG1）電源位置、欄為工業區分散式（DG1）電源位置。若以 SAIFI 為基準，
透過完整的計算資料我們可以找出住宅區分散式電源配至於匯流排 7、工業區配置於匯
流排 11、商業區配置於 19 為最佳的配置。其可靠度指標 SAIFI 為 1.1691；而若以 SAIDI
分別為基準，住宅區分散式電源配至於匯流排 6、工業區配置於匯流排 10、商業區配置
於 19 為最佳的配置此時 SAIDI 值為 1.4085。 
前述所得到的結果是能夠提供配電系統最佳可靠度的分散式電源配置位置。而對於
電力公司而言，最佳之可靠度位置的評估尚須考量各匯流排負載之大小及欲安裝之分散
式電源的額定選擇，再依住宅、工業、商業三區不同配置不同種類之分散式電源。舉例
而言，若於住宅區與商業區所安裝的電源為太陽能電池，根據資料[2-5]所示，換算得現
今太陽能電池設置成本約為每千瓦十五萬元；而於工業區設置風力發電機，其設置成本
約為每千瓦三萬五千元。同樣的，根據住、工、商三區饋線的負載上限不同，於每條饋
線各有不同的安裝功率上限限制，也將有不同的選擇支援供電方式，歸納而言其仍將為
以三台分散式電源位置為變數的函數，在此同樣列出其中一種組合選擇下的範例來說
明。如表 2.4 所示，其中住宅區分散式電源（DG1）位置表示於列、而工業區分散式電
源（DG2）位置則於欄中表達。表中數字為安裝分散式電源後每單位金錢造成可靠度指
標的變化量。可知在以 SAIFI 為基準下，住宅區分散式電源配置於匯流排 6、工業區配
置於匯流排 11、而商業區配置於匯流排 18 為最佳配置，其改善的幅度為
41.337 10−× /NT$，且此時的 SAIFI 大小為 1.1722；反之，若以 SAIDI 為基準，則住宅區
分散式電源配置於匯流排 6、工業區配置於匯流排 11、商業區配置於母線 18 為最佳配
置，其 SAIDI 改善幅度為 41.653 10−× /NT$，此時 SAIDI 大小為 1.4188。 
表 2.3 各饋線分別安置一台分散式電源時之系統 SAIFI 對應指標（DG3 於匯流排 19） 
DG2 
DG1 B8 B9 B10 B11 B12 B13 B17 
B3 1.2198 1.2151 1.2053 1.1857 1.2059 1.2137 1.1886 
B4 1.2135 1.2087 1.1990 1.1794 1.1995 1.2074 1.1823 
B5 1.2080 1.2032 1.1935 1.1738 1.1940 1.2019 1.1767 
B6 1.2064 1.2016 1.1919 1.1722 1.1924 1.2003 1.1752 
B7 1.2032 1.1985 1.1887 1.1691 1.1893 1.1972 1.1720 
11 
的一些變動差異： 
• DG1（住宅區）：太陽光電板 
• DG2（工業區）：風力發電機 
• DG3（工業區）：燃料電池 
• DG4（商業區）：蓄電池儲能系統 
而在考量系統的操作條件限制時，我們分別地規範了： 
a. 匯流排操作電壓上下限： 
 busmin maxV V V≤ ≤  (2-1) 
b. 饋線容量限制： 
 
nLineS LineSn max
P P≤  (2-2) 
c. 饋線中裝設分散式電源之容量限制： 
 DG
n
F
B_load DG F_loadn 1P P Pβ=≤ ≤∑  (2-3) 
d. 互聯開關可傳遞功率（Available Transfer capability, ATC）限制： 
 ATC TTC TRM= −  (2-4) 
 
n nTLine TLineP ATC≤ . (2-5) 
其中每一匯流排的操作電壓限制為 3%± ；而每一饋線中所能夠裝設的分散式電源總容量
最大不得超過饋線負載總需求的 30%（β）；TTC 為互聯開關總容量（Total Transfer 
Capability）；TRM 則為可靠之傳遞功率餘欲度（Transmission Reliability Margin）[2-6]. 
隨著饋線上負載的逐年成長，變電所中所有設備必須負擔的電功率亦逐年加重。當
其所佔變電所裝置容量的比例達到一定的臨界限定後（一般約為 70% [2-7]），考量到操
作的安全及供電的穩定，必須要即時地擴充變電所的裝置容量。但是整體而言，這種負
載量超過安全容量臨界限定的時間一般都相當的短，若僅僅為了符合這種短時間的安全
操作規範而投資經費所裝設的設備，將必然的在絕大部分的時間下處於閒置的狀態而顯
得投資過渡浪費。這種在考量過渡投資及運轉安全之間的僵局，將可藉由適當的調配現
有饋線中所可能安置的分散式電源來解決燃眉之急。 
依據前述的原則來評估配電系統中各種可能的改善方式，當然其組合及可能之選項
方案將因不同的分散式電源及安裝的匯流排位置甚至是系統的操作條件而有相當大的
差異。因此本計畫在此處所將提供的乃是其一定的規律及可資遵循的評估準則，希望對
於配電系統不論是在考慮擴充或是電力公司在考量制訂相關的法規以提供分散式電源
供應者相當的安置誘因時的參考。以圖 2.3 及表 2.5 所示的系統為例，若是每年的負載
平均成長率保持為 4%，而各匯流排相關的原始負載及饋線參數仍如表 2.1 及 2.2 所示的
話，則可以發現到在第五年時負載將成長到超過變電所的裝置容量的臨界限定值。雖然
表 2.5 四台分散式電源之相關操作參數 
參數 
電源 種類 可供電率 功率因數 容量(MW)
故障率λ 
(faults/year) 
修復時間 
(hours/fault)
DG1 太陽光電板 45% 0.91 1.4 0.2 16 
DG2 風力發電機 35% 0.85 12.0 4.0 12 
DG3 燃料電池 85% 0.95 5.0 0.2 5 
DG4 蓄電池儲能系統 90% 0.95 2.0 0.2 2 
 
13 
這可從系統 SAIFI 指標的變化觀察得到相對的結論。以所探究的配電系統來說，所對應
的具體化數據及相關的分散式電源切入時機則表示於表 2.6 及表 2.7 中。很明顯的，若
能依序地在第五年時切入 DG3（安置於 B13 之 5 MW 燃料電池）、第七年時再切入 DG2
（安置於 B9 之 12 MW 風力發電機）、第八年時再切入 DG4（安置於 B19 之 2 MW 蓄電
池儲能系統），最後在第九年時再切入 DG1（安置於 B6 之 1.4 MW 太陽光電板），則整
個配電系統會發生變電所超過裝置容量的臨界限定值的時程將整整的向後延緩至少四
年，為整個電力系統的操作與運轉爭取到額外的緩衝時間與策略安排抉擇的選項。 
15 
3. 鹼性燃料電池（AFC） 
4. 熔融碳酸鹽燃料電池（MCFC） 
5. 固態氧化物燃料電池（SOFC） 
雖然這五種燃料電池都是基於相同的電化學原理，但他們卻在不同的溫度範圍下工作，
使用不同的電解質材料，而且對於燃料的抗毒性與基本性能也不相同。表 2.8 即是這五
種燃料電池的簡介。由於本計畫所採購得的燃料電池實驗平台乃是 PEMFC 型式，因此
我們將專注於此種燃料電池開發相關的操控策略。 
 
高分子聚合物電解質膜燃料電池（PEMFC） 
高分子聚合物電解質膜燃料電池（Ploymer Electrolyte Membrane Fuel Cells，簡稱
PEMFC）由一種質子導體聚合電解膜構成。目前 PEMFC 在所有燃料電池類型中表現出
最高的功率密度（300~1000mW/cm 2 ），最快速啟動和開與關的循環特性。因為這些原
因，它很適應於可攜式電源和運輸工具，如大多數的汽車公司開發的燃料電池即大都著
重於 PEMFC。此型式之燃料電池乃是由質子交換膜、觸媒層、擴散層和流場板所構成
的，其示意圖如圖 2.5 所示，而其產生電能的步驟大致上可分為： 
第一步：反應物傳輸 
為了使燃料電池產生電，必須為其源源不絕地提供燃料和氧化物。這個看起來非常
簡單的任務，實際上可能是相當複雜的。簡單一點描述，當燃料電池輸出很大的電流時，
表 2.8 不同型式之燃料電池分類 
型式 
條件 PEMFC PAFC AFC MCFC SOFC 
電解質 高分子聚合物膜 
液態 3 4H PO
（固定不動）
液態 KOH 
（固定不動） 熔融碳酸鹽 陶瓷 
電荷載體 H +  H +  OH +  CO 23−  O 2−  
工作溫度 80 o C 200 o C 60 o C~220 o C 650 o C 600 o C~1000 o C
催化劑 鉑 鉑 鉑 鎳 陶瓷 
電池元件 碳基 碳基 碳基 不銹鋼基 陶瓷基 
燃料相容性 H 2 ,甲醇 H 2  H 2  H 2 ,CH 4  H 2 ,CH 4 ,CO 
 
 
圖 2.5: 高分子聚合物電解質膜燃料電池構造圖 
17 
MFC(流量控制器)。其功能敘述如下： 
1.電子負載機：可當電源之負載。其模式分為固定電流模式、固定電壓模式、固定電阻
模式、固定功率模式。 
2.電磁閥：可切換開或關來決定是否讓氣體通過。 
3.流量控制器：可調整供應至燃料電池的氫氣流量。 
由於燃料電池具有操作溫度低、快速啟動、高功率密度、小體積和低腐蝕性，一個
好的控制器可以使燃料電池的輸出表現有著較佳的結果。燃料電池的輸出表現和輸入電
池的氫氣和氧氣的流量關係非常的密切，氫氣和氧氣的缺乏會造成燃料電池的輸出性能
下降，更嚴重的甚至可能會損害到燃料電池本身，造成無法復原的損傷。當燃料無法供
應燃料電池之所需時，可以從外部觀察到的現象是電壓會下降，更甚者是燃料電池的電
壓無法維持在某個範圍值，會一直掉落到0 V。因此在做實驗時，需非常小心所供應的
 
圖 2.7: 本計畫所採用之高分子聚合物電解質膜燃料電池設備外觀圖 
 
圖 2.8: 本計畫所採用之燃料電池設備圖控操作介面 
19 
而 2W 選取則考慮一具有乘法性不確定性系統，經先前的討論得知 ( )~ 21P W P= + Δ 且
1∞Δ ≤ 可得到： 
 
~
2
( ) 1 ( ) ,
( )
P j W j
P j
ω ω ωω − ≤ ∀  (2-9) 
由此即可知道權重函數( 2W )可選擇為一條將
~
( ) ( ) 1P j P jω ω − 包覆的曲線，在幾個不同
的操作功率下系統所對應的權重函數W2則列於表2.9中。待權重函數都選擇完之後，即
可依據以下三個步驟來分別求取所設定之PID控制器參數。 
（1） 固定 pk 值為10，掃過整個頻帶求取滿足 2 1W W 1 S T ∞+ < 的 i dk k− 範圍。 
（2） 將不同功率求出的 i dk k− 取交集，並從此區域中選擇 ,i dk k 值。在這裡可選擇
14, 0.1i dk k= = 。 
（3） 檢查此參數值是否符合 2 1W W 1 S T ∞+ < 。結果可知道 ( ) ( ), , 10,14,0.1p i dk k k = 在
不同功率時之下皆滿足 2 1W W 1 S T ∞+ < 。 
 
控制器設計結果驗證 
透過前述的概念性說明在本計畫中所發展的有關燃料電池的控制器設計，我們透過
實驗，利用 Labview 實現控制器並搭配燃料電池測試平台，並根據系統識別與控制器設
計兩大步驟來落實。最後實驗證實設計出的控制器在燃料電池負載變動時，
2H
λ 能維持
在ㄧ安定值。首先在系統識別方面，先分別在不同操作點輸入不同的訊號（正弦波、
PRBS），並取其輸入輸出的數據，並分別由 Labview 及 Matlab 進行後續的處理。而在控
制器的實現上，則依照以下的三個步驟進行： 
1. 對燃料電池進行熱機動作，並先給予些許氫氣量，燃料電池處於無負載情況，且開
路 電壓為穩定的狀態。 
2. 調整電子負載機設定在定功率模式下，功率負載由 50 W，依序增加至 300 W。這個
緩慢增加負載的動作是要讓燃料電池溫度上升，不要讓電池在較低溫時承受負載的
劇烈變化。 
3. 將手動控制流量命令切換至自動由控制器控制並開始進行穩定
2H
λ 的動作，此時變
動負載，觀察
2H
λ 的變化情形。 
經由前述步驟的大量資料量測、修正與設計，我們可以先設定燃料電池的功率輸出
為 100 W，並且輸入 PRBS 訊號去估測系統參數。接著再啟動控制器，並設定燃料電池
的輸出功率從 100 WÆ150 WÆ200 WÆ250 WÆ300 WÆ250 WÆ200 WÆ150 WÆ100 
W 依序改變。而整個過程中燃料電池的響應則如圖 2.10 所示，其中上半部分是功率變
化時電流的變化情況，可看出這些電流將完全依據功率命令而改變；而由由圖 2.10 下半
表 2.9 燃料電池系統在不同操作功率下對應之權重函數 W2 
操作功率 100 W 200 W 300 W 
權重函數 W2 
20 10.08
1.667 1
s
s
+⎛ ⎞⎜ ⎟+⎝ ⎠  
16.67 10.1
2 1
s
s
+⎛ ⎞⎜ ⎟+⎝ ⎠  
20 10.07
1.429 1
s
s
+⎛ ⎞⎜ ⎟+⎝ ⎠  
 
21 
器能在約 2 秒內時
2H
λ 回到設定值 3，系統不會因為負載變動而使
2H
λ 無法回到設定的
值。而圖 2.12 和圖 2.13 則為負載功率需求依前述順序改變時電池電流與設定電壓
V (%)mfc 的變化情況圖。 
本實驗是透過偵測負載端的電流大小，去調整輸入氫氣流量的大小，以避免燃料電
池發生氫氣枯竭以及避免氫氣的浪費。在這方面
2H
λ 可當作一個指標，當燃料電池的負
載發生變動時，
2H
λ 會隨著負載變動而發生變化，而控制器設計的目標就是在負載變動
下維持
2H
λ 穩定。所採用的方法有兩種，一種是線上估測系統參數加預測控制，也就是
廣義預測控制，另一種則是離線系統識別並利用強韌 PID 控制。 
在廣義預測控制方面，吾人將系統當成是一個線性時變系統，因為由
2H
λ 的公式可
得知其輸入流量對於
2H
λ 之間的關係是隨著燃料電池的輸出電流 I 而改變的，因此採用
適應控制的方法。在系統識別實驗部分，則先採用最小平方法去識別，識別出來的模型
跟真實的系統是相近，但不完全跟真實系統相符，但這點可藉由控制器將去修正而達成
目的，這顯現了廣義預測控制的強韌性。至於在強韌性 PID 控制架構方面，則採用頻率
響應法進行系統識別，由結果明顯發現所得的轉移函數波德圖與實際系統並不完全相
合，而傳統的 PID 控制主要是依賴經驗並以試誤法設計參數，而強韌控制具有的優點是
在當系統有不確定的因素時，如系統的簡化、干擾進入與其它種種不確定的因素，控制
器能使系統維持穩定且擁有不錯的性能。因此在設計 PID 時加入強韌條件，使系統在種
種不確定因素下，控制器仍能使
2H
λ 維持在定值，從硬體系統的實測驗正結果，可以發
現到響應的結果均能滿足設定的操作條件。 
 
圖 2.12: 不同功率需求下含強韌性 PID 控制架構之燃料電池電流之響應變化圖 
 
 
圖 2.13: 不同功率需求下含強韌性 PID 控制架構之燃料電池電壓V (%)mfc 之響應變化圖
 
23 
可追溯至西元 1839 年由英國科學家 Grove 所提出的「氣體電池」實驗。Grove 的基本構
想為水可利用電將其分解成氫氣與氧氣，如果逆轉電解過程，即消耗氫氣與氧氣可產生
水，同時取出電。接著西元 1889 年由 Mond 與 Langer 兩位化學家提出「燃料電池」實
驗，製造出世界上第一具實用的燃料電池裝置。但是以當時在十九世紀的科技無法將燃
料電池商業化，因其金屬原料（白金）與燃料氣體（氫氣）取得不易。而燃料電池發展
的契機在於 1932 年，由英國劍橋大學博士生 Bacon 所提出雙孔電極之概念，將上述燃
料電池加以改良以及使用較普及的材料取代原本較稀貴之原料製作成鹼性燃料電池，此
電池稱為培根電池。 
燃料電池的現代發展史則主要在 1950 年由美國通用電機公司（GE）開始研發，GE
與美國航空總署合作，共同研製太空船的專用能源，由於當作太空船能量來源必須具有
高比功率與高比能量之特性，經過評估之後發現使用氫氧燃料電池特別適合。且燃料電
池所反應出來的純水還可供太空人飲用，但是以當時之技術還是無法將其推廣至民生用
途。直到 1973 年發生石油危機之後，世界大眾開始意識到能源枯竭之危機，燃料電池
又再度被重視推廣，不少民營或研究機構開始探討燃料電池的發展性與商業化之瓶頸，
開始積極開發新材料、追求更佳之燃料以及降低生產成本。終於在 1993 年由加拿大巴
拉得動力系統公司推出全世界第一輛以燃料電池為動力之車輛，成功將這種廉價、乾
淨、可再生的能源使用方式應用至民生方面，成為燃料電池發展的重要里程碑。 
由於在前（2.2）節中已經針對燃料電池相關的系統參數辨識與控制器設計做了完整
的探究，同時在所使用的 MATLAB/Simulink/SimPowerSystems 套裝軟體中亦已經提供
了固態氧化物燃料電池之數值模型，因此在此部分工作中我們僅以既有之模型為基礎，
並將其修正為以 1 MW 為單元之分散式電源模組。而其動態特性可以下式表示： 
 
0.5
2 2
0
2
[ ln( ) ]
2Nemst O dc
pH pORTV N E rI
F pH O
= + −  (2-11) 
其中 0E 為理想標準電壓，R 為通用氣體常數，T 為絕對溫度，r 為單位燃料電池內阻抗，
而其它的燃料電池相關參數如表 2.11 所示。 
 
雙饋式風力發電機 
風力能是一種無汙染的綠色能源，取之不盡，用之不竭，且分布廣泛。隨著人類對
生態環境的重視和能源的需求，再生能源的發展越來越受到重視，而風力發電是其中最
廉價、最有希望的綠色能源，風力能的開發與利用日益受到重視。在風力發電技術中，
大型變速恆頻風力發電技術已經成為主要發展方向。風力機大體上可分為兩大類，依風
輪結構與其氣流上的位置定義，分別為水平軸式與垂直軸式；而裝置於風力發電機組內
部的發電機種類主要有三大類，分別為鼠籠式感應機、雙饋式感應機、永磁式同步同機。
表 2.11 固態氧化物燃料電池系統相關參數 
符號 單位 符號 單位 
T 1273 K F 696.487 10× C/kmol 
Uopt 0.85 R 8413 J/(kmol K) 
K_H2 48.43 10−× (kmol/(s atm) K_O2 42.52 10−× (kmol/(s atm) 
K_H2O 42.81 10−× (kmol/(s atm) r 43.2813 10−× Ω 
Tf 5 rHO 1.145 
E0 1.18 No 4000 
 
 
25 
體內部會產生電子及電洞流，因而產生電位，連接負載形成通路後即可供應電流及能量。 
圖 2.17 為單組太陽能電池及模板之等效電路，此等效電路由代表光照能量轉換之電
流源、P-N 接面效應之二極體、金屬接觸壓降之串聯電阻與電流損失之並聯電阻所組成
[2-15], [2-16]。應用克希荷夫電流定律於圖 2.17 之電路可得下式： 
 module PV D RPI I I I= − −  (2-12) 
其中 Imodule 為太陽能板輸出電流， IPV 為太陽光伏電流，ID為二極體電流，IRp 為並聯電
阻之電流。二極體電流 ID定義如： 
 [ ( ) 1]module s moduleD o
T
V R II I exp
V A
+= −  (2-13) 
上式中 Io 為二極體飽和電流，VT為接面熱電壓，A 為二極體理想係數（介於 1.2~1.5 之
間），而式中之二極體飽和電流 Io 可定義為 
 ,
,( ) 1
sc ref i
o
OC ref v
T
I K T
I V K T
exp
V A
+ Δ= + Δ −
 (2-14) 
其中 ISC,ref 為標準工作環境測試下之短路電流，VOC,ref  為標準工作環境測試下之開路電
壓，Ki為電流溫度係數，Kv為電壓溫度係數，ΔT 為溫度變化大小。而 VT可定義為 
 sT
n kTV
q
=  (2-15) 
其中，ns為太陽能模板內部串聯電池單元之數量，k 為波茲曼常數(1.38×10-23 J/K)，q 為
一個電子的電荷量(1.602×10-19 C)，而 T 為實際工作溫度。太陽光伏電流 IPV則定義如 
 ,( )PV PV ref i
ref
SI I K T
S
= + Δ  (2-16) 
式中 Sref為標準工作環境下之照度，S 為實際工作環境之照度值，IPV,ref為標準工作環境
下之太陽光伏電流。在標準工作環境下之 IPV,ref可定義為 
 , ,P SPV ref SC ref
P
R RI I
R
+=  (2-17) 
由以上數學關係式與等效電路圖即可使用模擬軟體建構太陽能電池模組及進行特
性分析，本節所探討之太陽能板模組以 Kyocera 公司所開發編號 KC200GT 之太陽能模
板數據進行模擬驗證，其參數如表 2.12 所示[2-15], [2-16] 
利用 MATLAB/Simulink 模擬軟體建構之太陽能模板電路模型如圖 2.18 所示。為了
驗證此一模型確實與實際太陽能板之特性相穩合，接著分別模擬在固定照度（1000 
W/m2）下，不同工作溫度（0、25、50、75℃）時之太陽能模組輸出 I-V 及 P-V 曲線如
 
圖 2.17: 太陽能模板之等效電路 
 
27 
作為光伏發電之電源系統，其等效電路可由圖 2.17 擴展成圖 2.21 之模型，而其 V-I 關
係式則如： 
 
s( )
1 ( )
s
array array
p p Array s
Array P PV P o Array
s T s p p
NV R I
N N V RI N I N I exp I
A N V N R R
⎡ ⎤⎛ ⎞+⎢ ⎥⎜ ⎟ ⎡ ⎤⎢ ⎥⎜ ⎟= − − − +⎢ ⎥⎢ ⎥⎜ ⎟⋅ ⎢ ⎥⎣ ⎦⎢ ⎥⎜ ⎟⎝ ⎠⎣ ⎦
 (2-18) 
利用 MATLAB/Simulink 模擬軟體建立前述之太陽能光伏陣列，以 6400 塊模板利用
不同數量的串、併聯型態組成系統，每塊模板額定功率為 200 W，因此可以組合成最大
功率約為 1.28 MW 之光伏陣列模組，若分別考慮 40 160× 、80 80× 與160 40× 160*40 三
種不同組合型態，探討發電系統之輸出電壓、電流及功率與後續作為分散式電源之利用
可行性及陣列組成不同之影響。可以發現當使用相同數量之太陽能模組合成陣列時，輸
出最大功率值大致相同，但模組串聯數 Ns越少時，相對並聯數 Np越多，此時太陽能陣
列輸出電壓越低，而輸出電流會越高；反之當模組串聯數 Ns越多時，相對並聯數 Np越
少，此時此太陽能陣列輸出電壓越高，而輸出電流會越低。因此可依據實際應用需求的
電壓與電流規範值，來選擇適當的串、並聯太陽能模組數量以組成光伏陣列電源系統。 
另觀察上述之太陽能板的 I-V 及 P-V 特性曲線可以得知，太陽能電池會因為輸出電
壓或者電流的不同造成功率也會有所不同，且由特性曲線得知，太陽能電池在輸出最大
功率時，輸出電流與電壓必須工作在特定最佳點，越接近此點越能將太陽能電池的效率
發揮至最大。許多研究均針對此一課題提出不同的太陽能電池追蹤最大功率點工作之技
術，例如：擾動觀察法、增量電導法、滯環比較法與直接查表法等來判定最大功率輸出
之最佳工作點[2-17]-[2-20]。本計畫即依據採用 DC-DC 升壓器搭配擾動觀察法來追蹤最
佳工作點，運用此方法是因為只需量測較少之參數，且流程較簡單以及實現較容易。圖
2.22 即為本計畫中所飲用之使用最大功率追蹤技術之電路示意圖[2-20]，此電路使用之
參數則如表 2.13 所示。 
 
分散式電源併入電網之相關規範 
為了避免分散式電源因電網發生故障對分散式電源造成影響，因此國際電機與電子
工程師協會 IEEE 制定分散式電源與電網並聯之運轉與保護規範，必須在分散式電源端
裝設保護電驛，當分散式電源連接之責任分界點（PCC）的電壓或者頻率超出限制範圍
時，依其嚴重程度大小判定分散式電源與電網必須執行解聯的時間，如表 2.14 及表 2.15
所示[2-12]。 
而在饋的線保護裝置方面，則需同時安裝 50、51、50G、51G 四種不同型態之保護
 
圖 2.21: 太陽能光伏陣列之等效模型 
 
29 
秒之前 0 W，0.2~0.4 秒之間投入 500 kW，0.4 秒以後投入 1000 kW；而負載方面之變化
為：0.6 秒之前 750 kW，0.6 秒時增加至 1500 kW、150 kVar，0.85 秒降至 1000 kW；市
電之變化為：0.8 秒前與分散式電源及區域負載併聯供電，0.8 秒後因故跳脫，使得系統
成為孤島運轉，整個軟體模擬的結果如圖 2.24 所示。 
觀察圖 2.24 之模擬結果，太陽能光伏電源與市電系統並聯供電時，在 0.6 秒以前負
載需求 750 kW 之功率，而光伏電源在 0.2 秒之前並無功率投入，因此太陽能模組輸出
電壓為開路電壓，輸出電流為零，所有負載功率均由市電供應；在 0.2 秒時注入功率為
500 kW，比負載所需之 750 kW 之需求低，不足的 250 kW 由市電補足；在 0.4 秒以後
 
圖 2.23: 市電併聯型光伏發電系統與 MATLAB/Simulink/SimPowerSystems 整合之電路 
 
 (a)太陽能光伏模組輸出之電壓與電流 (b) 0.7s ~1.0s 負載端之電壓 
 
 (c)市電端輸出之三相電流  (d)光伏發電系統端輸出之三相電流 
 
 (e)市電端提供之實、虛功 (f)光伏發電系統端提供之實、虛功 
圖 2.24: 市電併聯型光伏發電系統動態模擬結果 
 
31 
統其供電線路均載與瓶頸舒緩可行性分析，並觀察其對於系統之影響，模擬結果如圖
2.26 至圖 2.32 所示。 
從動態的模擬結果可以觀察到，如圖 2.26 顯示兩分散式電源總共可提供約 10 MW
左右之功率，有效的舒緩市電負擔。由圖 2.27 中可以發現分散式電源連接之匯流排電壓
均會因為功率的投入而有些許幅度的升高的現象，但仍在操作的規範內。圖 2.28 及圖
2.29 則分別顯示若分散式電源提供之功率大於其連接匯流排之負載所需功率，則多餘之
 
 (a) 未併入 DG 時市電提供之實功 (b) 投入兩組 DG 後市電提供之實功 
 
 (c) 未併入 DG 時市電提供之虛功 (d) 投入兩組 DG 後市電提供之虛功 
 
 (e) 未併入 DG 時匯流排 2 之電壓 (f) 投入兩組 DG 後匯流排 2 之電壓 
圖 2.26: 裝設兩部不同型式分散式電源之配電系統市電端提供之功率與匯流排電壓變化
 
 (a) 未併入風力機時匯流排 13 電壓 (b) 投入風力機後匯流排 13 電壓 
 
 (c) 未併入光伏發電時匯流排 19 電壓 (d) 投入光伏發電後匯流排 19 電壓 
圖 2.27: 配電系統連接至兩部不同型式分散式電源之匯流排電壓變化 
 
33 
壅塞之現象，且在負載變動的情況下，可以穩定系統之運轉。當然的，若是系統發生接
地故障時，分散式電源必須快速偵測出並採取防護措施，以確保安全度過故障期。 
透過本項研究經驗與成果的累積，同時可提供下列相關效益： 
1. 模擬軟體建構之區域性電網及光伏發電系統模型，架構簡潔清楚，可單獨探討其運作
性能，亦可連接至系統以探討系統整體運轉穩定度，有利於學術研究與綠色電能設備
模型建置學習。 
2. 包含三條饋線、多組負載之區域型配電系統分別裝置了數量不等的分散式電源系統，
調控投入之功率大小，探討分散式電源對於區域用戶用電壅塞之舒緩情形，並研究負
載變動及發生故障對於分散式電源及系統之影響。此一模擬方式對於系統運轉穩定度
提供極佳的分析與驗證方法，可作為台灣許多工業區或科學園區配電系統未來裝置分
散式電源之規劃利用，可以增進電力工業技術開發之效能。 
3. 藉由分散式電源模型建立及與配電系統整合模擬，可以簡化開發的時程、快速訓練研
究人才、探討綠色電能的運作性能，也可解決台灣都會區或工業區用電擁塞與提出瓶
頸舒緩可行性的策略方案，對於改善用電品質及提高經濟效益有極大的幫助。 
4. 本計畫建構完成之市電併聯型微電網模型，可以在實際投資建置設備組成系統之前，
先行利用模擬方式探討系統運轉之狀況、觀察系統之穩定性、研判改善或解決問題之可
行性及必須實施之控制策略，此可降低投資之成本浪費，並提高問題解決之成功率。 
 
  
 
 
 (a) 未併入 DG 時電動機之轉速 (b) 投入 DG 後電動機之轉速 
 
 (c) 未併入 DG 時電動機之轉矩 (d) 投入 DG 後電動機之轉矩 
圖 2.30: 兩部分散式電源投入配電系統前後工業區饋線於
匯流排 9 之電動機負載轉速及轉矩變化 
 
35 
3.1分散式電源系統電力品質改善策略 
(a)主動電力濾波器抑制電壓諧波之研究 
分散式配電系統中因為大量濾波電容或是功因較正電容可能引起諧波電壓
振盪的問題，本計畫研究配電系統之主動濾波控制策略，並建立實驗室原型電
路驗證理論分析。圖 3.2 為研擬之放射型配電系統單線圖，L1~L3 為配電系統之
線電抗，C1-C3 為功因校正電容，主動濾波器安裝於饋線的末端以抑制諧波電壓
振盪。主動濾波器工作為一可控之諧波電導(電阻導數)以抑制配電系統之諧波
電壓，工作原理如式 3.1: 
∑ ⋅= ∗∗
h
abchhabc EGi
~
                        (3.1) 
其中，h代表諧波頻率的階數，Gh*為個別諧波頻率的電導命令，用以抑制相對
應的諧波電壓成分Eabch。因為特定的諧波電壓成分Eabch在諧波頻率ωh的同步參
考框架(SRF)下變成直流值，所以可使用低通濾波器(LPF)以擷取特定諧波電壓
成分，如圖3.2所示。再由諧波電壓和它對應的電導命令相乘可得諧波電流命
令，總電流命令則包括所有諧波電流命令。根據電流命令iabc*，測量的電流iabc，
和測量的電壓Eabc，電流調節器可求得電壓命令，以完成諧波抑制的功能。 
 
eqd
to
abc
5
eqd
to
abc
5
∗
5GabcE
5ω−
e
qdE 5 eqdE 5
5ω−
5
~
abcE
eqd
to
abc
7
eqd
to
abc
7
∗
7GabcE
e
qdE 7 eqdE 7
7ω
7
~
abcE
7ω
e
hqd
to
abc
∗
hGabcE
e
qdhE eqdhE abchE
~
hω hω
e
hqd
to
abc
∗
abci
abci
abcE
∗
abcv
 
圖3.2：放射型配電系統單線圖及控制方塊 
37 
 
                             (b)濾波器起動後 
圖3.4：饋線電壓波形及電壓THD 
 
 
圖3.5：濾波器電流波形 
 
 
(a)饋線末端電壓諧波失真 
7% 
3% 
Bus1 
Bus2 
Bus3 
2.0% 
2.5% 
3.0% 
參考電流 
實際電流 
39 
 
圖 3.7：系統電路圖 
 
 
圖 3.8：靜態虛功率補償器之控制方塊圖 
 
e
fqE
+
e
fdE
+ f
f
s ω
ω
+ SQRT
%VUF
s
k
k ip + nG∗f
f
s ω
ω
+ SQRT
e
fqE
−
e
fdE
−
fE
+
fE
−
%VUF*
s
kk ip + pG∗
*
fE
+
 
圖 3.9：靜態虛功率補償器之正序電導與負序電導控制方塊圖 
實驗結果 
圖 3.10~圖 3.12 為實驗測試波形圖。圖 3.10 顯示當靜態虛功率補償器啟動
後，饋線電壓升及不平衡現象可明顯改善，因靜態虛功率補償器用以抑制正序
電壓升及降低負序電壓，所以輸出電流含有正負序成分如圖 3.11 所示。圖 3.12
為靜態虛功率補償器起動之暫態測試，圖 3.12(a) 顯示出正序電壓由 1.04(pu)降
至 1.00(pu)，且直流端電壓也可控制在 380V，穩態時正序電導命令為 0.098；圖
3.12(b) 顯示負序電壓由 2.5%降至 2.0%，負序電導命令為 1.2。 
41 
 
(a)正序電壓與正序電導命令 
 
(b)負序電壓與負序電導命令 
圖3.12靜態虛功率補償器起動之波形 
 
(c)具下降模式控制之反流器併網運轉控制 
分散式電力反流器在沒有任何通訊的的狀況下與市電並聯連接時，電網電壓
與反流器輸出電壓可能存在相位差，因而造成反流器在併聯瞬間造成過大的循
環電流。本計畫研擬動態虛擬電感方式以抑制反流器之暫態電流，圖 3.13 為反
流器控制方塊圖，在電壓命令控制迴路中引入一隨時間而衰減的虛擬電感以達
到反流器軟啟動抑制暫態電流，如式 3.4 與式 3.5 所示，其中 Lv 為虛擬電感、
Lvo 為初始虛擬電感值、Lvf 為最終虛擬電感值、為 τ時間常數。 
                      IsLdroopref EE ⋅−= )(                       (3.4) 
1
()( ) +⋅+= − ss vfvovfv LLLL τ
τ
                      (3.5) 
除了虛擬電感的功能外，我們亦提出反流器相位切換策略，如圖 3.13 所示，
當電流過大時，圖中的開關 SW1 與開關 SW2 將由狀態 1 轉變為狀態 2，開關
SW1 由原先的實功率-頻率下降法轉變為鎖相迴路以達到電網電壓與反流器輸
出電壓零相位差，開關 SW2 由原先的電壓控制模式轉變為預測型電流控制模
式，使電網電壓與反流器輸出電壓之間相位差所產生的電流控制為零。因為鎖
1.04 
1.00 
380
300 
0 
0.098 
|E+f| 
Vdc 
Gp* 
%VUF 
Vdc 
Gn* 
2.5% 
2% 
380
300 
0 
1.2 
43 
圖 3.14 為併網實驗測試電路、系統參數、下降控制器參數設定，在併網前
由反流器獨立供給負載 968W，在併網後(S 開關導通) 反流器仍能正常工作並根
據下降控制機制調整輸出功率。圖 3.15 為反流器併接至電網之電流波形圖，由
微觀圖可看出反流器之電流可控制在安全範圍。 
 
 
(a)巨觀圖 
 
(a)微觀圖 
圖 3.15：獨立運轉反流器併接至市電之輸出電流波形 
45 
構如圖 3.18 所示電路。本子計畫分項採用具耦合電感交錯式昇壓轉換器搭配主
動箝制技術來實現軟切換及回收漏感能量，同時亦增加轉換器的功率處理能力
及降低輸出電流漣波。 
B. MPPT 控制及電路 
    因高昇壓轉換器的電源來自太陽能板，因此必須要有太陽能板最大功率追蹤
的功能，來提昇太陽能板的使用效率。而 MPPT 控制方式採用擾動觀察法來實
現，其控制電路架構採用圖 3.19 所示電路。量測 Vpv、Ipv 電壓經過 A/D 轉換後，
送入微控制器進行比較判斷增減載的動作，最後送出一個訊號至 PWM 控制器進
行 Duty 的調變。 
C. 電力線傳輸模組 
    電力線傳輸模組主要將太陽能電池的溫度、照度、電壓及電流資料透過電力
線模組 FTM-S005 經由調變引入太陽能電池的電源線中，利用此電源線當作傳輸
資料的媒介，再由高昇壓轉換器中的微控制器將以調變的資料再經過 FTM-S005
模組將調變信號取出，和電力轉換器上的輸入電壓、電流及輸出電壓、電流經由
串列傳輸，送至 PC 上做即時監控顯示。其電力線傳輸模組如圖 3.20 所示電路。 
圖 3.16：本子計畫二之整體系統架構 
47 
 
圖 3.20：電力線傳輸系統 
系統問題描述及對策 
1. 因太陽能電力轉換器的輸入電源電壓為模擬太陽能板輸出電壓 34V~42V，且
輸出要達到 DC 400V，所以造成需要很高的匝數比，導致轉換器整體效率不
高，最好只到 85%左右。 
2. 目前改善對策為:  
 (1) 開關元件選用 RDS ON 小的 MOSFET 開關。 
 (2) 改善電力級主線路徑的佈線，以降低線路上的阻抗。 
 (3) 使用銅箔繞制耦合電感。 
實測（模擬）結果驗證 
A. 直流-直流轉換器 
  為了驗證太陽能電力轉換器的可行性，以實際製作出具耦合電感昇壓轉換
器，如圖 3.21.所示電路。系統規格如下所示: 
電力級規格: 
• 輸入電壓 Vi=34V 
• 輸出電壓 Vo=400V 
• 輸出電流 Io=2.5A 
• 輸出功率 Po=1kW 
• 切換頻率 fs=50kHZ 
依據上述電路規格，元件選用規格如下所示: 
• 開關 M1~M4: IRFP260 
• 二極體 D1~D2: HFA08TB120 
• 匝數比: 20 
• 電感鐵心: EE-55 
• 一次側電感 L11、L21: 24uH、24.3uH 
• 二次側電感 L12、L22: 10.35mH、10.2Mh 
49 
(a)M1 及 (b)M2 的 VDS、IDS 波形圖 
 
 
圖 3.24：負載從 10%變動至 100%滿載時所量測輸出電壓 Vo 及電流 Io 的波形圖 
 
B. 電力線傳輸模組 
    圖 3.25 所示電路，為電力線傳輸模組。搭配微控制器及串列傳輸 RS-232，
來達成太陽能板的訊號調變以及傳送至 PC 上做顯示，達到即時監控的目的。在
圖 3.26 所示介面，為使用 LabView 圖控程式，建構於 PC 上，讓使用者清楚知
道發電系統目前的情況。 
 
圖 3.25：電力線傳輸模組 
 
51 
3.3 分散電源系統併聯微型電網之監控系統控制技術 
隨著科技日新月異的發展，高精密負載與特殊場所的設備需求，其換流器容
量及數量愈來愈大，因此換流器系統必須增加容量以滿足其他額定容量較大之負
載，然而增大單一換流器容量受限於開關元件的耐壓與耐流以及散熱等問題，容
易造成系統燒毀。因此換流器並聯運轉的方式雖然可以擴充系統的容量及增加系
統的效率，但並聯運轉仍有困難性。故並聯運轉必須先考量到同步操作的問題，
包括電壓大小、頻率、與相角，在並聯運轉時各換流器之間會產生相位差，而導
致各換流器之間會出現循環電流，而損壞至各換流器，能源問題乃現今學者為了
解決都無不絞盡腦汁，關於再生能源逐漸受到重視，再生能源擁有循環再利用特
點，對環境不構成汙染，電力網路為一個極大的交流系統，若能以換流器輸出電
流回饋至式電網路中，減輕電力網路發電廠所提供的電能，需考慮電力網路相
位，頻率，振幅的大小，才能達成換流器並聯電力網路型式，故此可以降低電壓
漣波的換流器並聯電力網路，未來研究重點。 
為了使系統更穩定，有許多文獻已經提出相關換流器並聯運轉的方式，包括
電感直接耦合、瞬時電流控制、N+1 餘裕控制、結合電壓控制與電流控制法、集
中式控制法、主僕控制法、分散邏輯控制法。電感直接耦合方式，當電感兩端電
壓或相位差出現循環電流時，電感則可作為導體，使換流器不會因循環電流過大
而損壞，優點:較具彈性且成本低，缺點:模組變流器間具差異故無法掌握其特性。 
集中控制法可分成兩種:(1)直接集中式控制法;(2)間接集中控制法，並聯控制
單元統一送出同步訊號至換流器，且電壓相位與輸出頻率之同步訊號同步，使各
換流器之間電流精準分配，若集中控制系統故障時，會使整個系統崩潰。主僕控
制法克服集中控制單元的缺點，透過開關或軟體自動設定，其中一組換流器當主
模組(master module)，產生分流控制信號來修正之電壓調整信號，以同時調整電
壓及控制分流。 
本研究主要探討規畫以 LabVIEW 系統，控制多塊模組的 PWM 傳送、電子
開關、輸出電流量，並由 DSP2812 擷取電壓電流回授信號再傳回人機系統，監
看整個系統的電壓與電流，並量測電力網路輸出端電流確認回充到電力網路，並
以數位訊號處理器 TMS320F2812 訊號處理送出同步訊號，以外部中斷的方式來
達成換流器同步輸出，達到並聯運轉的目的，結合比例-積分控制器(PI-Controller)
設計電壓迴授控制器，利用 CAN 區域網路通訊架構來控制電壓、電流，分開控
制核心達成主僕系統精密微控電流，避免系統因為集中控制法造成系統損壞，讓
並聯造成的循環電流經過分流，準確隨著負載變化而平均分配換流器的電流，大
大提高系統的穩定性，再利用輸出電源的相位、頻率、振幅，電網經由零點偵測
電路，得到即時電力網路資訊送入 DSP，即時送出輸出與電力網路並聯。本計畫
分別以單相換流器輸出、換流器同步輸出與電力網路並聯。 
連結電力網路運轉模式的電路架構簡介 
53 
使系統達到近似實功之輸出。濾波電感在換流器的功用乃濾除高頻諧波，較大電
感值會雖然輸出電流波形近似弦波，但造成系統響應速度變慢，較小電感值輸出
電流波形輸出電流波形諧波較大，但系統響應速度相對提升，故濾波電感量間接
影響到輸出電流波形與跟響應速度。連接電力網路之換流器等效電路。 
在電力網路併聯系統中，電力網路可視為頻率為 60 Hz 的電力網路系統。控
制換流器與電力網路同相位、振幅一致相關因素進而並聯上電力網路系統，將換
流器視為電流源提供電流給予電力網路，在每個取樣周期偵測輸出電感電流跟隨
電流參考來控制總輸出電流，將換流器輸入電能轉移至電力網路，如圖 3.29 所
示。 
同理而言換流器輸出電壓與電力網路相等電流應為零，由於換流器輸出電壓
與電力網路系統之間電壓會有相位差的問題，導致電感電流與電力網路相位不同
相位。由此可見換流器輸出電感電流，必須將換流器輸出電感電流先歸零再以追
隨參考電流輸出單位弦波電流，使得電感電流與電力網路同相位輸出實功給予與
電力網路系統。基於脈寬調變上，將電感電流視為回授電流與命令電流相減調整
脈寬調變修正電流輸出量。將參考值設為零與回授電流做相減運算得出誤差值，
誤差值乘以一個值(Kp)跟隨參考值結合下式中 L/T，比例控制器調整換流器輸出
電感讓電流歸零的動作。將參考值改為單位弦波，此時命令輸出電流值換流器輸
出電流近似弦波並與電力網路同相位得到實功率輸出。 
 
SLLab VT
LiiV +−= )( *
                    (3.7) 
(a)換流器並聯之運轉方式 
換流器並聯的架構須考慮輸出的電壓大小與相位，所產生的循環電流問題。
若輸出功率不相等的話，進而造成換流器的損壞，故相對需考慮換流器並聯之間
的循環電流。換流器並聯之架構圖如圖 3.30 所示，換流器並聯之控制方法需考
量同步問題，包括電壓大小、頻率與相角。故換流器並聯運轉，輸出電壓大小和
相位控制不當，將會造成換流器輸出功率分配不均衡，而導致換流器損壞。 
 
圖 3.29：連接電力網路之換流器等效電路圖 
55 
電網並聯上都是送出電流給予電網系統，因此投入的先後順序不會影響到電力系
統。 
(b)外部中斷並聯運轉原理 
以外部中斷的方式達成兩模組單相換流器同步輸出的目的，其中有兩個數位
訊號處理器。其中一個數位訊號處理器當主模組，負責送出同步訊號作同步。另
外一個數位訊號處理器負責接收同步訊號，同步訊號為 12 kHz，如圖 3.32 所示。
其 12 kHz 為系統之切換頻率 fs，故要調整系統之切換頻率，從主模組所輸出的
同步訊號作調整，系統頻率調變比率 mf 為 200，數位訊號處理器內部寫入兩個
外部中斷，分別為 12 kHz 及 60 Hz 外部中斷，因本文是採用兩個數位訊號處理
器分開控制輸出的電流，由於兩塊模組振盪器的時脈不會一致，所以當 12 kHz
中斷時，每中斷一次會進入抓取數位值進而將全三角波比較輸出，因各模組以電
網電壓為基準固定值，如此一來各個模組換流器的輸出的電流一致。電流正弦旗
標(Index)乃各模組中接收到外部中斷一時旗標加一，直到鎖相電路(PLL ZERO 
CROSS)產生同步訊號每 60 Hz 讓外部中斷二重新清空電流正弦旗標(Index)歸
零，令電流與電壓追上相位達成實功輸出。 
同步輸出原理，將 12 kHz 同時輸出使 SPWM 輸出的波形令兩個數位處理器
同時輸出。模組一換流器同步訊號為原本 12 kHz，模組二換流器同步訊號也為
時脈一致的 12 kHz，如圖 3.32 所示。使模組一換流器及模組二換流器所輸出的
電流漣波相同，在同一時序上依照三角載波輸出 PWM，零交越時機(PLL ZERO 
CROSS)每當 60 Hz 產生一方波，利用外部中斷判斷負緣轉正緣時機清空電流正
弦旗標(Index)，兩個換流器可以同步並聯運轉。 
實測結果驗證 
架構如圖 3.33 所示，系統分成單一模組換流器電網併聯輸出及雙模組換流
器並聯電網並聯輸出外部中斷同步輸出，圖為整體架構，實驗系統量測之電力網
路電壓、輸出電流及電流命令總輸出。 
 
圖 3.32：同步訊號示意圖 
57 
(b)雙模組換流器併聯電力網路輸出 
此章節以兩個模組換流器相互並聯，分別以同步和交錯式換流器輸出，並聯
電網前須注意兩個換流器輸出交流電壓與電力網路電壓相同頻率與相位，並進行
電流控制以確保輸出電流近似弦波饋入電力網路。主要透過電流控制換流器輸出
電流追隨電網相位，輸出交流電流與電壓同相後即可出實功給電力網路系統。 
圖 3.36 為雙模組換流器同步併聯電力網路電流輸出波形，TPV1 為電網電壓
波形。TPC1 為換流器一下達 0.3 A 電流命令。TPC2 為換流器二下達 0.2 A 電流
命令。TPC3 為相互並聯最後輸出至電網波形總輸出 0.5A。圖 3.37 為雙模組換流
器同步併聯電力網路電流輸出波形，TPV1 為電網電壓波形。TPC1 為換流器一
下達 1.5 A 電流命令。TPC2 為換流器二下達 1.5 A 電流命令。TPC3 為相互並聯
最後輸出至電網電流波形總輸出 3 A。 
以 LabView 經 CAN bus 傳遞輸出電流控制每一個模組，實現多模組換流器
同步併聯電網，以外部中斷方式利用同步訊號由主模組送出，解決換流器輸出電
壓與相位同步的問題，多模組換流器並聯運轉可以擴充系統的容量及增加系統的
效率。 
 
圖 3.34：換流器輸出電流歸零 
 
圖 3.35：單一換流器輸出電流 1.5 A 
59 
 
 
圖 3.38：人機介面控制圖 
 
圖 3.39：系統換流器併聯流程圖 
61 
 
圖 4.1 研究流程圖[4-2] 
 
傳統解決系統壅塞的策略方法為提升饋線及變壓器額定容量，本節說明非傳
統解決輸配電壅塞之策略所導致之輸配電設備避免成本[4-3]，將此避免成本視為
投資非傳統解決輸配電壅塞策略之投資效益，並與各種策略所需花費之年均化成
本(Levelized Annual Cost)比較。 
圖4.2為本研究使用之測試系統，其中各條饋線與主變壓器都各自有其尖峰
負載量佔設備額定容量百分比與不同之尖峰負載年成長百分比；以饋線F1為例，
尖峰負載量佔饋線額定容量90%，若尖峰負載量以每年2%速度成長，必須於第5
年提昇饋線容量，否則會發生超載情形；而系統尖峰負載量為45.6MVA佔主變壓
器額定容量76%，系統尖峰負載量以每年4%的速度成長，則必須於第6年擴增設
備容量，否則會有發生超載危機。因此必須依序於第3~6年擴建設備。 
 
圖4.2 模擬系統架構圖 
 
63 
年均化成本小於興建輸配電設備之避免成本，因此利用此三種策略對系統提供
3MW線路減載量能夠獲得投資效益；一旦線路負載減量提高至6和9MW時，雖
然線路負載減量倍數增加延緩年限隨之倍數提升，但延緩效益非但沒有倍數增加
增加幅度反而越來越小。 
表4.3 避免成本與年均化成本 
 
 
表4.4 非傳統解決輸配電系統壅塞策略成本參數 
風
力 
發
電 
裝置 
容量
(MW) 
裝置 
成本
($/MW) 
發電機
與塔座
(M$) 
運轉與維護
(M$) 
土地 
(M$) 
電網並聯
(M$) 
裝置總
成本
(M$) 
3 45000 94.5 13.5 13.5 13.5 135 
太
陽
能
發
電 
裝置 
容量
(M$) 
裝置 
成本
($/kw) 
太陽能
板(M$)
運轉與維護
(M$) 
土地 
(M$) 
電網並聯
(M$) 
裝置總
成本
(M$) 
3 150000 315 22.5 90 22.5 450 
儲
能
設
備 
容量
(MW) 
儲存 
容量
(MWh) 
功率 
裝置
($/kWh)
儲能裝置
($/kWh) 
運轉與維
護(固定) 
($/kW) 
運轉與維
護(變動) 
($/kW) 
裝置 
總成本
(M$) 
7.2 28350 17780 672 137 215.08 3 
柴
油
發
電 
裝置
容量
(MW) 
裝置 
成本
(M$/M
W) 
燃料價
格 
燃料熱值
(kcal/liter) 
單位燃料
熱值
($/kcal) 
熱耗率
(kcal/kWh
) 
每度電
燃料成
本
($/kWh)
3 32.2 15 8800 0.0017 2643.71 4.51 
需
量
反
應 
約定
契約
容量
(MW) 
最低抑
低契約
容量
(MW) 
基本電
費優惠
($/kW) 
流動電費優
惠($/kWh)  
3 1 20 4 
  
配電瓶頸舒緩策略對線路運轉影響模擬 
上一節計算了各策略之年均化成本，透過年均化成本可比較各符合投資策略
之效益，本節將分析各策略執行後對系統運轉之影響。本研究模擬之傳統策略為
提升饋線及變壓器容量(α=0)；非傳統策略為裝設分散式能源、儲能設備及實施
需量反應(α= 1～5)；尋求在此六種策略中，對應連續10年(β= 0～10)，系統每年
以4%之負載成長百分比下，對於改善線路壅塞降低超載機率與超載風險之影
響。模擬流程如圖4.3，紀錄各策略隨負載成長之超載機率與超載風險。
65 
 
圖4.4 各策略日發電量百分比曲線圖 
 
在假設各策略整年每小時平均發電量Oαh及標準差後，對其進行隨機取樣，
獲得其發電量的值。針對這次時間序列發電量，隨機取出第h小時為發生故障之
起始時間；假設機組非運轉狀態下並不會造成故障情形，因此若取得該h小時下
無輸出時，則需再次重新取出另一h；若第h小時策略輸出非為零，則根據表4.5，
令其在第h小時發生故障，且於第h+MTTR小時後故障方得清除；在此故障期間
之發電量皆為零，重覆此動作直到完成此次時間序列發電量所有故障次數，並儲
存之。本研究對每一小時均執行一百次分析以模擬負載及發電量之自然變動。 
 
圖4.5 策略發電量模擬流程 
67 
容量超載機率(Hourly Overload Probability,HOPαβ)計算方式如式4.2所示，由
於模擬時間單位為1小時，一年共8760小時；假設模擬100次後足以代表此模
擬符合真實系統之變動。故容量超載機率為總超載次數在分析時間長度共h
小時中，模擬次數k達100次後，所佔之百分比。α為策略代碼，β為負載成長
百分比代碼。容量超載次數(Hourly Overload Counts,HOCαβ)的計算，依超載
情形可能發生在流經變壓器之負載功率超過該變壓器額定容量，或者饋線上
傳輸之負載需量超過該條饋線額定容量，當同時發生時僅計1次。 
 
(4.2) 
 
8. 容量超載風險(Hourly Overload Risk, HORαβ)的計算如式4.4所示，依照超載機
率與超載量之乘積，定義此值為超載風險；當系統發生超載情況時，紀錄發
生之最大設備超載量(Hourly Overload Quantity,HOQαβ)，並將所有設備超載
量累加後，除以分析時間長度h與模擬次數k，故超載風險HORαβ為所有超載
次數中最大超載量和除以共h × k小時，表示超載風險為分析運轉次數k中每個
小時之可能超載量。 
 
(4.3) 
 
(4.4) 
 
系統模擬架構 
本研究模擬為使用19個匯流排範例配電架構，如圖4.2所示，其系統相關資
訊如下:  
‧ 變壓器一次側系統短路容量4000MVA。 
‧ 變壓器額定容量為60MVA，額定電壓為161KV/22.8KV，其阻抗值17.3%。 
‧ 饋線種類為XLPE，25KV，1/C， 500MCM地下纜線，其線路阻抗值為
0.0901+j0.1325(Ω/km)，容許載流量為437A，允許最大傳輸量為17.257MVA。 
‧ 模擬系統共有三條饋線分別為住宅(F1綠)、工業(F2紅)、商業(F3橙)型負載，
每節點有各自8784小時負載曲線，表4.6為對各節點年平均負載，除了各節點
平均值不同外亦有不同標準差，據以模擬匯流排負載之不確定性。各節點年
度負載曲線假設與台灣97年度系統總負載相似圖4.7，據以模擬季節性負載變
化。功率因數設定為定值且依據負載程度的不同假設，較重載的饋線功率因
數較低，因此虛功值可由下式算出。 
 
(4.5) 
表4.6 系統各節點負載設定參數值 
 
69 
 
圖4.8 各策略系統超載機率圖 
容量超載風險(HOR) 
影響超載風險最大因素為超載機率，由圖4.8與圖4.9比較可發現，超載機率
與超載風險呈現正相關關係，相同策略中超載機率越高其超載風險也越大。儲能
設備雖為解決超載機率之最佳非傳統策略，但其超載風險卻為最大，由於儲能設
備所能提供之降載量完全依據當時儲存容量而定，一旦儲存能量釋放完畢，儲能
設備對於系統而言如同虛設，對於要解決連續時段之超載風險，儲能設備無法有
效發揮其真正效益；而需量反應實施時間僅於尖峰負載時段4個小時，一旦其他
離峰時間因為負載成長關係造成超載情形，需量反應卻無法提供有效降載量，反
造成超載風險增加現象。 
 
圖4.9 各策略系統超載風險圖 
71 
有須要測量的地方就廣為設置，其次，也由於測量儀表之特性以及資料傳送回到
控制中心之通訊問題，使得所量測資料有誤差或在通訊過程中遺失等導致資料不
精確、不可靠與延遲等問題。而電力系統之狀態估計是可以降低上述問題顧慮的
一種有效方法。電力界完整狀態估計模組商用套裝軟體通常包含以下內容(1)測
量資料的可信度檢查，該功能將可事先將明顯錯誤的測量資料予以檢出，以免狀
態估測結果產生嚴重的失真。(2)可觀測性分析，一個可觀測系統的基本條件為
可用的測量值的數目不能少於所須估測之狀態，對於不可觀測系統，一種方式是
使用精準度很低的虛擬測量值於每一個不可觀測狀態之位置，在文獻上關於可觀
測性分析有拓樸(topological)法、數值(numerical)法與混合(hybrid)法三種主要之方
法。(3)狀態估計計算。 
 
圖4.10 三相配電系統狀態估計(SE)之架構 
 
本研究採用的配電系統狀態估計方法將分兩階段：第一階段：將以配電自動
化或 AMI 測量值為區隔，將饋線分為數個區塊(Block)，區塊內位於饋線上游有
實際測量值之節點定義為根節點，而在每個區塊內將包含若干沒有實際測量值之
負載點，將以該節點初始負載表示虛擬測量值(Pseudo Measurement)，在此，有
實際測量值的資料將給予高的權重，而虛擬測量值將給予低的權重，利用這些資
料，執行狀態估計程式，求出饋線上各個根節點的狀態；第二階段：將利用第一
階段的求解結果，以區塊為基礎，考慮虛擬測量值之負載功率及線路損失等，依
照功率平衡的觀念，計算出功率不匹配值(Power Mismatch)，再以此不匹配值，
修正各個節點的虛擬測量值，然後利用這些資料，執行逆向/順向掃描負載潮流
程式，最終求出能夠匹配實際測量值之節點負載。 
過去在缺乏用戶即時電表資料的情況下，電力公司往往利用過去所收集儲存
在 CIS 的客戶用電歷史資料，來決定配電變壓器的負載資料以做為系統運轉規劃
之用。為進行有效的配電系統資產利用與管理，詳細負載資料的密集估計是必要
的，如此方能提供如饋線重組、電壓/虛功之控制等功能所需要之可靠的即時負
載資料。要做好停電後的復電調度，我們必須要知道饋線每個區段的負載量，如
此一來，我們才可比較各種負載調度的優劣，確保饋線轉供調度是安全的。同樣
的，若我們有整條饋線上各節點(配電變壓器)正確的負載估計，就能較容易地評
估一個負載控制方案是否能產生預期的控制結果提高運轉效率及舒緩可能的網
路壅塞情形。 
73 
m
BE
ADBC jcijci
,,
,, =                                             (4-7) 
其中， jciBE ,, 為第 i 個配電變壓器其供電區域中，c 類型用戶於 j 相之每月售電量
(KWH)，m 則是每月用電日數(本研究設為 30 日)。第 i 個配電變壓器(Dist. Tr)其
供電區域(Service Region)中，c 類型用戶於 j 相，第 t 小時之實功負載初始值 t jciP ,,
以及虛功負載初始值 t jciQ ,, ，亦即為實、虛功虛擬測量值(Pseudo Measurement,PM)
之初始值如以下所示： 
jci
t
c
t
jci ADBCHLIP ,,,, ⋅=                                     (4-8) 
c
ct
jci
t
jci pf
pf
PQ
2
,,,,
1−⋅=                                     (4-9) 
其中， cpf 為 c 類型用戶之典型功率因數值(假設住宅、商業及工業三種用戶之功
率因數值分別為滯後 0.97,0.92 及 0.85)。因此第 i 個配電變壓器(Dist. Tr) 於 j 相
之實功負載值 t jiP , 以及虛功負載值 t jiQ , ，可加總其供電區域內各類型用戶 t jciP ,, 與
t
jciQ ,, ，並可以表示如下： 
∑= c t jcit ji PP ,,,                                            (4-10) 
∑= c t jcit ji QQ ,,,                                           (4-11) 
t
ci,α 及 t ci,β 則分別為第 i 個配電變壓器(Dist. Tr)其供電區域中，c 類型用戶於 j 相，
第 t 小時之實、虛功負載之調整因數(Scaling Factor) ，如下所示： 
∑∑ ⋅
⋅=
i c jci
t
c
jci
t
ct
jci ADBCDLCV
ADBCDLCV
)()(
)()(
,,
,,
,,α                           (4-12) 
 
線上電力潮流(on-line power flow, OLPF)為整合電壓/虛功控制(IVVC)最重
要的功能之一，主要是用來決定配電饋線目前狀態，特別是那些無法實際直接監
視的參數，如線路損失，以及用來評估由 IVVC 演算法建議的電壓/虛功控制動
作之影響。OLPF 包含使用由不同用戶類型調查統計得到的負載曲線資料之負載
估測器，以指定目前的負載大小至配電變壓器。以此負載估測器功能為基礎的
OLPF 結果可以合理地產生正確的變壓器負載估測結果，但如果負載模式符合每
個變壓器實際電力使用和能源消耗量，其結果可以進一步改善。 
在配電管理系統(DMS)中，狀態估計(SE)係指根據系統中測量儀表所測量出
之匯流排之電壓值，或注入之電流，或預測之負載以及傳輸線上之電力潮流等諸
多測量值，來估計系統目前最可能之狀態；此一狀態估計問題，可以被公式化成
一個加權最小平方(Weighted Least Square, WLS)的最佳化問題，並以疊代的方
法，在每一次疊代中，求解線性化的最小平方問題。為了改善估測結果之品質，
可觀測性分析與狀態估計在程式中應該執行於相同之迴圈，並且在每次狀態估計
之結尾，對於測量儀表須進行錯誤資料偵測(Bad Data Detection)，使得估測誤差
遠大於測量裝置標準差的極失真測量值於往後的疊代中不再被考慮。利用狀態估
計對資料一致性的檢測能力，可使配電系統各節點上的負載資料估計更為準確，
進一步使得配電系統調度更有效率。 
本研究採用的配電系統狀態估計方法將分兩階段： 
第一階段：將以圖 4.13 中的 AMI 測量值為區隔，將饋線分為數個區塊，區塊內
75 
?)ˆ( J
t txJ >
{ }1,...,24tmizZ ti === ,,...,2,1,
tn
irmaxFind )ˆ(  
t
iz
 
 
圖 4.14 執行狀態估計程式流程圖(第一階段) 
 
第二階段：將利用第一階段的求解結果，以區塊為基礎，考慮虛擬測量值之負載
功率及線路損失等，依照功率平衡的觀念，計算出功率不匹配值 (Power 
Mismatch)，再以此不匹配值，修正各個節點的虛擬測量值，然後利用這些資料，
執行逆向/順向掃描負載潮流程式，最終求出能夠匹配實際測量值之節點負載，
其流程如圖 4.15 所示。 
 
關於圖 4.15 之流程簡單說明如下： 
 
步驟1：建立網路、參數、電表資料管理系統資料庫（MDMS）、負載模型資料庫
與用戶資訊系統及售電資料庫等資料並建立 tcDLCV 及 jciADBC ,, 。 
步驟 2：讀入實際 ),( ,, t jamt jam QP 與虛擬 ),( ,, t jit ji QP 測量值及調整因數 t jci ,,α 。 
步驟 3：估算線路損失 ),( tlosstloss QP 。 
步驟 4：計算實功率與虛功率之不匹配值 ),( tmistmis QPΔ 。 
步驟 5：判斷是否滿足收斂條件 tolQP tmistmis <Δ , ? 
步驟 6：依調整因數 t jci ,,α 調整各節點每相實、虛功率之負載值，並更新每相實、
虛功率之負載值。 
步驟 7：執行逆向與順向掃描程序(BFS)以更新節點電壓，之後回到步驟 3。 
 
 
77 
 
圖 4.16 12 個匯流排之簡易饋線 
                                                                                     
表 4.8 饋線上各個 bus 的三相負載(pu) 
Bus Number True Load(pu) 
(phase a,   phase b , phase c) 
2 (0.8+0.21i, 0.9+0.23i, 0.85+0.22i) 
3 (1.1+0.18i, 1.2+0.17i, 1.0+0.16i) 
4 (0.87+0.2i, 0.95+0.21i, 1.02+0.19i) 
5 (0.87+0.2i, 0.95+0.21i, 1.02+0.19i) 
6 (0.81+0.2i, 0.85+0.21i, 0.83+0.19i) 
7 (0.37+0.1i, 0.35+0.11i, 0.32+0.09i) 
8 (0.27+0.09i, 0.25+0.1i, 0.26+0.095i) 
9 (0.67+0.12i, 0.65+0.11i, 0.66+0.13i) 
10 (0.77+0.12i, 0.75+0.11i, 0.76+0.13i) 
11 (0.47+0.09i, 0.45+0.085i, 0.46+0.087i) 
12 (0.27+0.05i, 0.25+0.045i, 0.26+0.047i) 
     
本範例模擬之執行結果如表 4.9 及表 4.10 所示，其中表 15 為 12 個匯流排之三相
電壓大小及相角，而表 4.10 為饋線段之分枝(branch)實虛功潮流及電流大小。 
 
表 4.9 12 個匯流排之三相電壓大小(pu)及相角(Degree) 
Bus Number Voltage Magnitudes(pu) 
(phase a,   phase b,   phase c)
Voltage Phase Angles(Degree) 
(phase a,  phase b,  phase c) 
1 1.0000    1.0000    1.0000 0      240.0000  120.0000
2 0.9928    0.9926    0.9930 -0.0394  239.9553  119.9460 
3 0.9888    0.9886    0.9892 -0.0632  239.9295  119.9147 
4 0.9857    0.9855    0.9861 -0.0806  239.9133  119.8900 
5 0.9810    0.9809    0.9816 -0.1087  239.8885  119.8557 
6 0.9768    0.9770    0.9776 -0.1364  239.8661  119.8294 
7 0.9707    0.9713    0.9720 -0.1823  239.8319  119.7914 
8 0.9669    0.9679    0.9684 -0.2133  239.8081  119.7652 
9 0.9627    0.9639    0.9644 -0.2529  239.7748  119.7311 
10 0.9597    0.9612    0.9616 -0.2811  239.7513  119.7061 
11 0.9577    0.9594    0.9597 -0.2980  239.7379  119.6904 
12 0.9572    0.9589    0.9592 -0.3028  239.7344  119.6862 
 
表 4.10 饋線段之分枝(branch)實虛功潮流(pu)及電流大小(pu) 
Line 
Section 
Branch power flow(pu) 
(phase a,      phase b,         phase c) 
Current Magnitude(pu) 
(phasea, phase b, phase c)
Bus1-2 7.4444+1.6171i  7.7220+1.6453i  7.6074+1.5873i   7.6180  7.8954   7.7712
Bus 2-3 6.5917+1.3903i  6.7665+1.3972i  6.7059+1.3491i   6.7857  6.9605   6.8882
79 
 
表 4.12 2 狀況 1 的電壓相角(SE)與 base case 之比較 
Bus 
Number
Voltage Phase Angles(Deg) (base case)
(phase a,  phase b   phase c) 
Voltage Phase Angles(Deg) 
(phase a, phase b, phase c)
1 0.0000  240.0000  120.0000 0.0000  240.0000 120.0000
2 -0.0394  239.9553  119.9460 -0.0354  239.9463 119.9544
3 -0.0632  239.9295  119.9147 -0.0548  239.9135 119.9320
4 -0.0806  239.9133  119.8900 -0.0723  239.8960 119.9135
5 -0.1087  239.8885  119.8557 -0.0924  239.8669 119.8870
6 -0.1364  239.8661  119.8294 -0.1173  239.8463 119.8692
7 -0.1823  239.8319  119.7914 -0.1712  239.8371 119.8260
8 -0.2133  239.8081  119.7652 -0.2107  239.8282 119.7977
9 -0.2529  239.7748  119.7311 -0.2571  239.8189 119.7584
10 -0.2811  239.7513  119.7061 -0.2885  239.8047 119.7404
11 -0.2980  239.7379  119.6904 -0.3154  239.7887 119.7350
12 -0.3028  239.7344  119.6862 -0.3194  239.7799 119.7352
 
表 4.13 狀況 2 的電壓大小(SE)與 base case 之比較 
Bus 
Number
Voltage Magnitudes(pu)(base case)
(phase a,  phase b,  phase c)  
Voltage Magnitudes(pu) 
(  phase a,   phase b,   phase c)
1 1.0000    1.0000    1.0000  1.0000    1.0000    1.0000
2 0.9928    0.9926    0.9930     0.9928    0.9926    0.9930
3 0.9888    0.9886    0.9892     0.9888    0.9886    0.9893
4 0.9857    0.9855    0.9861     0.9858    0.9858    0.9863
5 0.9810    0.9809    0.9816     0.9813    0.9813    0.9818
6 0.9768    0.9770    0.9776     0.9773    0.9776    0.9780
7 0.9707    0.9713    0.9720     0.9714    0.9728    0.9720
8 0.9669    0.9679    0.9684     0.9677    0.9699    0.9681
9 0.9627    0.9639    0.9644     0.9636    0.9666    0.9637
10 0.9597    0.9612    0.9616     0.9605    0.9642    0.9609
11 0.9577    0.9594    0.9597     0.9583    0.9624    0.9589
12 0.9572    0.9589    0.9592     0.9577    0.9620    0.9585
 
表 4.14 狀況 2 的電壓相角(SE)與 base case 之比較 
Bus 
Number 
Voltage Phase Angles(Deg) (base case)
(phase a,  phase b,   phase c) 
Voltage Phase Angles(Deg) 
(phase a,   phase b,  phase c)
1 0.0000  240.0000  120.0000 0.0000  240.0000  120.0000
2 -0.0394  239.9553  119.9460 -0.0394  239.9553  119.9460
3 -0.0632  239.9295  119.9147 -0.0612  239.9277  119.9188
4 -0.0806  239.9133  119.8900 -0.0806  239.9146  119.8963
5 -0.1087  239.8885  119.8557 -0.1040  239.8927  119.8631
6 -0.1364  239.8661  119.8294 -0.1320  239.8791  119.8390
7 -0.1823  239.8319  119.7914 -0.1910  239.8811  119.7852
8 -0.2133  239.8081  119.7652 -0.2335  239.8790  119.7507
9 -0.2529  239.7748  119.7311 -0.2831  239.8767  119.7047
81 
作。工作重疊技術將平行工作間的通訊需求轉換為較為低負擔的同步及較均勻分
布之通訊與處理。增進工作重疊技術針對工作間的通訊方向不一致的情形，提出
子工作重序與通訊方向調整方法，降低其通訊延遲的影響。我們運用此平行化技
術於負載潮流分析演算法，將其轉換成為平行演算法，當用於配電系統的饋線狀
態估計時，可以有效改進其執行效能。 
負載潮流分析(power flow analysis)是一種在問題實體空間進行狀態估計
(state estimation)的問題，一個狀態估計的問題包含一個實體空間，包括其內的狀
態變數、狀態變數間以公式代表的關連性、與若干邊界狀態變數的數值設定。狀
態估計的目標為計算所狀態變數的數值，以滿足以公式代表的關連性，並對邊界
狀態變數的設定數值有最佳的吻合度。這類問題的演算法通常具有一個外層迴
圈，其包含循序依存的迴圈迭代(loop iteration)，用以調整狀態變數的數值，直至
依據品質標準達到收斂為止。在此外層迴圈迭代之內，有若干個計算工作，這些
工作用以調整計算下一組估計的狀態數值，在狀態空間逐步達到收斂的狀態。全
部或大部分的工作相互依存，且各自為一內層迴圈，其循序的在狀態變數的實體
空間，以某種實體空間的方向，依據對應的公式關係，循序的計算與傳遞所估計
的狀態數值。這種問題的收斂演算法在其計算結構上具有緊密編織的資料依存
性，因此不易被平行化。然而為達到一個良好的狀態估計結果，外層收斂迴圈迭
代的次數可能很多，而需要顯著的計算時間。我們對此類問題的演算法分析其可
運用的平行性，並將其平行化，以達到有效的平行加速。 
在配電系統中，當配電饋線上的負載改變時，配電系統上無設置量測電表處
的狀態需要被估計出來，這些估計的狀態可以用於電力系統管理的動態決策使
用。其需要即時計算，以達適時的電力系統管理。給定一個僅在邊界節點有電表
量測的樹狀或線段的配電網路，負載潮流分析[4-10, 4-11, 4-12]可以在此配電網
路的內部節點上估計其系統狀態。 
一個負載潮流分析演算法包含一個兩層收斂迴圈，其外迴圈的計數由此演算
法的收斂特性決定，外迴圈的主體包含數個由內迴圈組成的工作，這些工作依序
執行正向電流狀態累算、反向電位累算、節點功率計算、總功率計算、收斂決策
計算、與對配電網路上的總體狀態調整。從我們的分析，此演算法在各內迴圈裏
的細顆粒計算間具有有限的平行性。在本研究中，為了將此演算法廣泛的應用於
區域化的電力管理系統，我們要在易於取得的個人電腦上以平行計算加速負載潮
流分析演算法的執行，我們分析負載潮流分析演算法中可以運用的平行性，並將
此循序演算法轉換成為數種平行化形式，以在多核心電腦上有效的加速其執行。 
 
負載潮流平行化處理問題描述 
在本研究中，我們的目標在於將負載潮流分析演算法，以多核心電腦結構為
執行環境，形成有效率的平行演算法，加速其執行速度。我們考慮兩種問題需求，
首先是依照此問題與原始演算法的特性，分析其平行度，規劃其有效率的平行執
行形式與演算法。其次，當資源的平行度足夠於將原始演算法的領域平行度分解
83 
的子領域叢集成為各單個平行執行緒。換各方式說，外迴圈可被轉換乘以領域分
解出的多個執行緒，我們合適的將此演算法平行化，以達有效的平行加速。 
細顆粒加速 
多核心結構上的計算透過共享記憶進行通訊，它們因此可以比分散式記憶機
器具與較快的通訊與同步動作，在多核心電腦上執行的計算可以因此被分解為計
算的較細顆粒而達到比用分散式磁磚計算較高的平行化效率。在此種機器上需要
支援比存在的方式更低執行負擔的同步與通訊機制，各種延遲隱藏(latency hiding)
技術也需被運用以達到好的管線效率。在多核心電腦上，相較於分散式記憶機
器，由於其使用共享記憶的對稱性，針對不規則之問題實體空間做領域分解與處
理器對應，可以較容易的支援。 
在目前的技術趨勢上，當資源平行度持續的增進，在最近的未來，許多問題
的演算法可以使用等同於其問題實體領域大小的資源平行度做平行執行。
Amdahl’s 法則[4-19]敘述一個使用多個處理器的程式，其加速程度受限於其循序
程式的比例。在較廣的角度，平行執行加速程度亦受限於由於同步與通訊[4-20]、
負載不均衡、與無法隱藏之延遲等附帶的負擔。為了有效的運用非同步細顆粒平
行性，這些因素必須在平行程式設計時，加以有效的考慮與因應。 
在本研究中，為了滿足資料依存性，在共享記憶執行的多個執行緒需要做頻
繁的通訊與同步。為了達到好的管線效率，需要在分佈在多個執行緒上所管線化
的迴圈迭代間，以工作負載等量化的技術均衡其分佈之子工作量，低負擔之同步
與通訊亦需有效的支援。在各執行緒上所分割出的子工作間，需要以工作重疊或
管線化的多執行緒執行達到單方向延遲隱藏的效應。對於非單方向的通訊與同步
延遲時間的隱藏，可以已傳輸方向重排與無關之工作的重序達成。 
當資源平行度足夠用於相關問題時，有效的降低由非同步細顆粒平行執行所
牽涉的執行負擔，可以使得平行演算法達到接近問題實體領域大小的平行加速，
我們介紹並設計有效的機制，以降低這些種類的執行負擔，當運用足夠的資源平
行度時，達到該問題接近最大化的加速程度。 
 
饋線負載潮流分析演算法 
如圖 4.18 所示，循序的負載潮流演算法由一個外層收斂迴圈組成，其迴圈
主體包括若干工作，分別依序計算各節點電流、從端點至來源節點的配電饋線電
流、從來源節點至端點的節點電位、各節點與線段的功率與總功率、已知與計算
的總功率差距、迴圈收斂判斷、與對各節點分佈功率估計的調整等。 
為了有效平行化此循序負載潮流分析演算法，我們進行了此演算法內的資料
依存性分析，其包括於相同外層迴圈迭代與連續外層迴圈迭代間的各工作間的資
料依存性分析。分析結果敘述於下： 
85 
亦可以被用於一個線段的配電網路結構。在本研究中，我們著重再發展此演算法
的平行化技術，我們目前選擇將線段結構之配電網路之負載潮流計算加以平行
化。因為在樹狀與線段結構的配電網路上的各計算工作的資料流方向是固定的，
兩種結構上的估計計算之工作均可以被以領域分解的方式，加上所需的通訊傳
遞，加以形成其平行演算法。此兩種計算結構的差異僅在於其通訊之非循環有向
圖(directed acyclic graph)的樣式。在樹狀結構上，在相同節點數的情形，其最長
通訊傳遞距離甚至比線段結構為短，而多核心結構支援之共享記憶亦使得在廣播
通訊時，有相同的效能效應。因此，本研究所發展的平行演算法與效能結論可以
被推廣到樹狀配電網路結構的負載潮流分析的平行演算法設計。 
在循序負載潮流分析演算法中，其外迴圈的迭代為嚴格循序依存，其各內迴
圈的子工作亦為循序依存，大部分之內迴圈包含循序依存的迭代，有些內迴圈包
含累算的依存性，其可以被轉換成為具有有限平行度的小顆粒計算。從我們的分
析，從各內迴圈分割出的計算可以被重疊的執行，然而由於其間仍有一定的資料
依存性，其連續的迴圈迭代並非無關，因此不可以以一般軟體管線技術處理其有
限之平行性，而目標的多核心電腦亦不支援同時執行的平行執行緒間的緊密同步
方式。 
除了總功率差距的計算與收斂決策之外的工作均為跨越配電網路的領域中
的迴圈處理，各迴圈可以從端點至來源節點或從來源節點至端點處理。其中區域
的節點內電流計算相互無關，其亦可以用領域分解的方式平行化處理。跨越節點
的全域計算相互兼有依存性，可以以線性傳遞的通訊與縮減運算支援期間的通訊
與計算。由於在一個外迴圈迭代內的所有工作相互間為循序依存，在這些工作間
因此不存在平行性與可重序的可能性。而外迴圈的迭代由於進行循序的收斂計
算，因此，其相互間亦不存有平行性。 
非同步管線技術 
在本研究中，我們設計一種新的平行化技術，稱之為非同步軟體管線
(asynchronous software pipelining)技術，其可以被運用於循序負載潮流分析演算
法。其由平行化與管線效率改進兩部分組成，其平行化使用領域分解的平行化技
術，其管線效率改進包括工作重疊與增進工作重疊兩種技術。藉由運用這些轉
換，所產生的平行演算法可以在多核心電腦上以非同步的方式重疊執行，而不需
要硬體鎖定同步的支援，並可達到均衡而具很少執行負擔與等待時間的有效率之
平行方式加速其執行。 
87 
為一個在所分解的子領域的子迴圈，而等量化分解的子領域使得此分解的 t
個子工作的工作量為等量的分解，此如圖 4.19(b)所示，此種轉換稱之為條狀
開採，而所分解的數目 t 將對應到將形成分割出的執行緒的數目。 
(b) 具通訊的迴圈融合(loop fusion with communication) 
我們可以繼續將各分解出的子工作依照分解的相同子領域做迴圈融合，因此
將融合出一個兩層的並行迴圈，其中第二層迴圈的 t 個迴圈迭代所包含的子
工作需要進行相互間的通訊，此如圖 4.19(c)所示。 
(c) 多執行緒分割(multithreaded partitioning) 
最後，我們可以將所有外層迴圈迭代中，依照內層迴圈從 1 至 t 的註標，分
割成為 t 個具相互通訊的平行執行緒，而每個子工作可由三個部分組成，分
別為其先期處理、與相鄰執行緒的通訊與同步、與其後續處理。各子工作中
相互間無關的先期處理與後續處理可以重疊執行，而相互間的通訊會造成各
子工作以時間偏移的方式重疊執行。每個執行緒負責執行領域分解出的一個
子領域內相關的所有計算，此如圖 4.19(d)所示。 
在多個所分割出的執行緒內的工作因此可以以工作重疊的方式執行，此種重
疊執行可以在相同與接續的外層迴圈迭代上產生，以造成相同方向通訊的通訊延
遲時間隱藏。我們可以安排這些並行非同步執行的執行緒，用最早排程(ASAP)
的方式，以工作時間偏移的方式重疊執行，以隱藏大部分相同方向跨執行緒的通
訊與同步的時間延遲，此種非同步軟體管線的執行方式顯示於圖 4.20。 
(2) 工作重疊技術 
工作重疊技術包括低負擔的同步轉換與同步處理的等量化兩種細部技術，在
領域分解技術應用於細顆粒的處理平行執行時，此部分尤為重要。 
 
圖 4.20 非同步軟體管線執行 
89 
的工作重疊性，形成較多的通訊延遲隱藏，此如圖 4.22(c)所示。 
 
饋線負載潮流分析平行演算法設計 
在本節，我們介紹負載潮流分析的平行演算法設計，其包含三種平行演算法
設計。第一個版本以運用領域分解(domain decomposition)轉換推導形成，其形成
一種合適的平行執行形式，並可以進一步的改進。為了改進管線化效率，另兩個
版本依序採用工作重疊(task overlapping)轉換與增進工作重疊(enhanced task 
overlapping)轉換推導產生。 
(1) 領域分解(domain decomposition)平行演算法 
在負載潮流分析演算法中，為了運用領域分解技術，我們將連續的實體配電
節點先等量的分割成可平行化計算的等分，將各等分中連續的實體配電節點之各
單節點在其第二層迴圈所需之計算對應成為所開採的不同組條狀之計算。條狀計
算的數目將等於所形成的執行緒的數目，並將指定到不同的處理器核心執行。 
如圖 4.23 所示我們可以將外層迴圈內各工作所分割出的條狀計算，依其所
指定的執行緒，將不同工做分出的條狀計算融合成為各執行緒的外層迴圈內的子
工作。如此融合出的完整迴圈是一個並行迴圈，此並行迴圈的迴圈迭代的計數即
為所對映出的執行緒的數目。在這些分解出的執行緒上，為了執行其迴圈迭代內
 
圖 4.22 增進工作重疊轉換 
91 
同步。其次，附加於每次通訊的處理需全由主執行緒處理，此會造成執行緒間附
加於通訊的處理的不均衡分佈，而造成動態執行多執行緒時之關鍵路徑長度的增
長。第三，如果我們讓非同步執行的執行緒有相近的時間偏移，跨越執行緒的通
訊時間可以被降低。 
在第一組平行演算法，對每一組跨所有執行緒的通訊，我們採用兩組屏障同
步，單向的通訊或廣播通訊可以被至於此兩個屏障間執行。在第二組平行演算法
設計中，我們設計了兩種客製化同步技術，分別用於廣播通訊與單方向通訊。它
們將可以降低單執行緒所需的同步負擔，亦可以均勻的將附屬於通訊的處理分佈
在各個執行緒上執行，而有助於細部的負載均衡。此用於廣播通訊的同步技術已
於前節介紹。 
對於單向通訊，我們使用一組共用之鎖定變數(lock variable)，用於相鄰的執
行緒間的通訊。當一個執行緒寫入其通訊之資料時，其透過重社對應之鎖定變數
以通知相鄰的執行緒，相鄰的目標執行緒可以針對此鎖定變數執行一組忙碌等待
(busy waiting)的迴圈，當其出迴圈時，即可讀取所傳遞的資料。此種方式可將通
訊的處理均勻的分佈到各個執行緒。在目的執行緒其後的工作中，即可設定該鎖
定變數，由於此問題中各執行緒間的因果依存性，通訊來源的執行緒不需等待此
設定的完成，而可繼續執行。在其需要再次重設該鎖定變數時，可由因果關係保
證其已設定，不至造成競賽條件(race condition)的情況。如此可以在所有執行緒
上，節省一組同步的操作，改進同步的負擔。 
上述兩個技術同時擁有低同步負擔與等量化執行緒的通訊處理的能力，因為
V、E、與 C 的通訊方向與 I 及 V 的通訊方向相反，僅有部分的工作重疊性可以
達到。我們採用領域分解轉換後，再採用此工作重疊技術推導出第二個版本的平
行演算法，此演算法如圖 4.24 所示，並將其以 C 語言及 OpenMP 平行程式庫將
其實做成為一個在多核心電腦上執行的平行程式。 
 
93 
換，I、V、與 P 的通訊成為相同方向的通訊，因而可以達到增進的工作重疊效
應，隱藏通訊延遲，降低其等待時間，此演算法如圖 4.25 所示。 
 
模擬結果與分析 
為了實證我們的平行演算法設計的有效性，我們使用 OpenMP 程式庫實做
此平行演算法為平行程式，並進行在一個四核心 AMD-945 電腦上進行其效能實
驗。在所有所設計的平行演算法上，我們使用四個執行緒為其領域分解的數目，
 
圖 4.25 增進工作重疊平行演算法 
95 
我們並量測了各執行緒在其通訊所執行之同步的忙碌等待(busy waiting)迴
圈的平均迴圈計數，在表 4.16 與表 4.17 分別顯示在配電饋線節點數為 4 運用工
作重疊(TO)與運用增進工作重疊(ETO)的演算法的各通訊所需的等待時間。比較
此兩表，由於增進工作重疊的改進管線效率，ETO 比 TO 在傳遞 I、V、與 P 可
以獲得較佳之工作重疊效應，因此其可以消耗較低的通訊等待時間。然由於其原
始演算法的依存性特性，其在傳遞 E 與 C 的延遲仍不能隱藏，每次外層迴圈迭
代上，E 與 C 的延遲累積在執行緒 0 上收到線段 I 值的通訊延遲上。 
實驗結果顯示細顆粒領域分解可初步達到非同步軟體管線的平行加速，工作
重疊與增進工作重疊可進一步增進管線效率，原始的負載潮流分析演算法可以在
不同節點數 / 核心數比率的範圍，以細顆粒平行度有效的加速。因此，以領域
分解、工作重疊與增進工作重疊所組成的非同步軟體管線技術可以有效的平行化
與加速原始緊密耦合的負載潮流分析演算法。 
 
本節結論 
在本研究中，我們設計出一種負載潮流分析的平行化演算法。我們運用所發
展出的非同步軟體管線技術，將一負載潮流分析的循序演算法轉換成為數種平行
化形式，以獲得平行化加速的效能改進。其可以運用領域分解出多個緊密耦合的
執行緒，並利於在其間縮短其平行執行時的關鍵執行路徑的長度。為了在資源平
行度足夠時，取得最大可達到之加速程度，我們改進其細顆粒管線化效率，其包
括工作重疊技術與增進工作重疊技術。增進工作重疊技術考量以細顆粒平行執行
時的效率改進問題，其包括提供低負擔之同步轉換與同步負載之等量化。增進工
作重疊技術考量促進潛伏期隱藏的效應，其包括工作重序與通訊方向的重新排列
的技術。在此研究的實驗中，我們驗證依此平行演算法所設計的平行程式，其可
以在實際的配電饋線節點數目的狀況下，獲得有效的效能改進。量測的數據並顯
表 4.16 平均等待循環計數 (TO) 
通訊部分 執行緒 0 執行緒 1 執行緒 2 執行緒 3 
Line I 183.64 20.09 18.43 NA 
V NA 8.53 58.60 195.16 
P 174.03 71.36 47.69 NA 
E, C NA 54.69 51.91 67.64 
 
表 4.17 平均等待循環計數 (ETO) 
通訊部分 執行緒 0 執行緒 1 執行緒 2 執行緒 3 
Line I 188.33 13.39  4.36 NA 
V 16.19 0.42  0.24     NA 
P  3.59 0.11  0.02 NA 
E, C       NA 47.62 62.72  166.36 
 
97 
求解空間的複雜架構，其大小隨求解問題規模的增大而呈指數級增長，目標函數
的計算可能十分複雜和計算量大，通常需要透過長時間模擬。而排序最佳化利用
排序比較代替精確值的計算，只比較解的優劣而不在乎解之間的具體差別是多
少，以及利用簡易模式(crude model)計算目標函數值，以快速得到足夠好的解。 
本研究主要以配電系統規劃為主要考量，決定如何在配電系統中安裝最大容
量之分散式電源。在考慮配電系統運轉安全下，將經由饋線重組方式，尋找 DG 
裝設位置及容量，使倂聯至配電系統分散式電源容量為最大。此問題將設計成混
合整數非線性規劃最佳化問題，控制變數包括饋線開關狀態、分散式電源安裝位
置 及 容 量 。 本 工 作 擬 以 排 序 最 佳 化 法 ， 粒 子 群 最 佳 化 法 (Particle 
SwarmOptimization, PSO)及混和排序最佳化法和粒子群最佳化法等 3 種方法在
求解上述問題，並比較 3 種方法之效能。 
本計劃利用饋線重組的方式，在符合配電系統安全運轉的條件下，得到分散
式電源的最大容量及位置。此最佳化問題的目標函數是併聯分散式電源之容量最
大化，目標函數表示成: 
∑
=
dgN
i
DGi uSMax
1
)(.  (4-15) 
目標函數值即為最大化各分散式電源裝置容量之總和。其中 DGiS 是第 i 個
DG 的裝置容量， DGN 是分散式電源總數量，u 為控制變數，控制變數包含分散
式電源裝置容量、裝設位置及饋線開關狀態。 
而限制條件，包括下列各項: 
1. 變壓器最大電力負載量限制 
t
Koutk
v NpSuS
ppk
∈∀≤∑
∈
max)(  (4-16) 
經變壓器流入和變壓器連接所有饋線的電力負載量總和必須小於變壓器最
大電力負載量。其中 v 表示系統負載狀態，包括尖峰負載及離峰負載， outK 是電
力負載流出節點之饋線集合， vpkS 代表變壓器 p 連接饋線 k 之電力負載量， maxpS 是
變壓器 p 之最大電力負載量， tN 為變壓器總數。 
2. 饋線最大電力負載量限制 
Doutkj
v
kj NjKkSuS ∈∈∀≤ ,)( max  (4-17) 
饋線電力負載量必須小於饋線最大電力負載量。其中 DN 是負載節點總數，
v
kjS 是饋線 k 連接節點 j 在尖峰負載及離峰負載下電力負載量， maxkjS 是饋線 k 最大
電力負載量。 
3. 節點電壓限制 
di
v
i NiVuVV i ∈∀≤≤ maxmin )(  (4-18) 
節點電壓必須在節點電壓最大值和最小值之間。其中 viV 是節點 i 在尖峰負載
及離峰負載下電壓， miniV 和 maxiV 分別表示節點 i 之電壓最小和最大限制值。 
4. 節點電壓偏移限制 
99 
抽取 1000 個可行解，已可反映求解空間的部分特性。由隨機抽取的 1000 個可行
解中，文獻 [4-37]證明在抽取的可行解中至少有 1 個可行解位於整個可行解空間
的前 5%較好解的機率幾乎為 100%。為了瞭解排序最佳化的觀念，首先應了解
排序性能曲線(Ordinal Performance Curve，OPC)的概念。設可行解空間Θ  (搜索
空間)中總共有 N 個可行解，對每一個可行解透過式(1)所示的目標函數精確獲得
其性能值(performance value)，再把這些性能值依從小到大的順序均勻地繪在直
角坐標系中，就可得到一條非降的曲線，稱之為 OPC 曲線。為獲得 OPC 曲線，
需要對整個解空間Θ中的每個可行解都通過精確的計算，但其計算量相當大。因
此通常獲取 OPC 曲線都是通過對表徵集合 NΘ 中，各個可行解利用 crude model
快速評估獲得，以近似確定該最佳化問題的類型。文獻[4-37]透過大量模擬實驗，
將排序最佳化理論的所有單目標最佳化問題，劃分為五種 OPC 曲線類型，即 flat
型、U 型、Neutral 型、Bell 型以及 steep 型，如圖 4.28 所示。 
 
圖 4.28 OPC 曲線類型 
由最佳化問題的目標函數值所得到之 OPC 曲線，確定是上述五種曲線之其
中一種類型後，再透過選擇機率(alignment probability)來評估求解的質量。選擇
機率可表示為 }|Pr{|),,( kGSksgP ≥∩= ，即被選定之子集合 S 中，至少包含“足
夠好解”子集合 G 中，有 k 個足夠好解的機率。其中 g 是集合 G 的個數，通常 g
和 k 為規劃設計人員根據實際情況自行設定的值。根據選定的選擇機率值
%),,( α≥ksgP ，在已知 g 和 k 的值的情況下，就可以確定被選定之子集 S 的大
小 s。 
文獻[4-38]依據 OPC 曲線、g 值、k 值及簡易模式評估目標函數值和正確計
算的目標函數值之誤差分布情形 U~[-w, w]，利用式(4-21)決定 S 集合之大小 s。 
ηγρ += gkes z  (4-21) 
其中 z 、 ρ 、γ 和η皆是常數，其大小依據 OPC 曲線及誤差分布情形決定。 
為了快速簡易的得到目標函數解，推導饋線電力負載量和節點電壓之簡易模
型(crude model)是必須的。圖 4.29 用以表示含分散式電源之配電系統，假設系統
101 
 
圖 4.29 饋線電力負載圖 
 
應用排序最佳化求解最佳化問題，可以透過以下四個步驟來實現: 
步驟 1：形成表征集合 NΘ ：從解空間Θ隨機抽取 N =1000 個可行解組成表征集
合 NΘ 。 
步驟 2：估計 OPC 曲線以確定待研究最佳化問題的類型：透過 crude model 快速
計算目標函數，集合各個可行解從小到大排序，繪製 OPC 曲線。根據
OPC 曲線的形狀，確定該最佳化問題所屬的類型。 
步驟 3：確定需要準確模擬的選定集合 S：在確定 OPC 曲線類型，設定 g 值和 k 
值，以及計算簡易評估值和準確值的誤差分布情況，根據式(4-21)求得 S
集合大小 s。 
步驟 4：從 S 集合中選取真實足夠好的解：對 S 集合中的每個可行解進行準確詳
細的模擬，計算其對應的目標函數值，根據目標函數值的大小對 S 集合
進行從小到大排序，選取前 k 個作為該最佳化問題的足夠好解。 
本計劃亦將使用粒子群最佳化法(Particle Swarm Optimization, PSO)解此非
線 性 最 佳 化 問 題 [4-41,4-42] 。 在 PSO 方 法 中 ， 第 i 個 粒 子 表 示 成
),...,,( 21 iDiii xxxx = ，在第 i 個粒子所有先前歷代解中之最佳解的粒子表示為
),...,,( 21 iDiii pppp = 。在族群裡所有粒子中有最佳解的粒子，以指標 g 表示。第
i 個粒子位置變化率（velocity）表示為 ),...,,( 21 iDiii vvvv = 。在本計劃中每一個粒
子 ),...,,( 21 iDii xxx 包括：分散式電源容量、分散式電源裝設位置和饋線開關狀態，
其中分散式電源容量屬於連續函數參數，饋線開關狀態和分散式電源裝設位置則
屬於整數參數，因此在計算 iv 時有不同的作法。針對連續參數 iv 的更新方式如下： 
)(*1*1
old
idid
old
id
new
id xprandNOcvv −+= )(*2*2 oldidgd xprandNOc −+
 (4-26) 
整數參數 iv 的更新方式如下： 
)(*1*( 1
old
idid
old
id
new
id xprandNOcRoundvv −+=
))(*2*2
old
idgd xprandNOc −+  (4-27) 
其中 Round()是取四捨五入值。 ix 的更新方式如下： 
 newid
old
id
new
id vxx +=   (4-28) 
綜合前面的說明，以 OO 混合 PSO 的求解流程如下： 
步驟 0：設定族群大小（m）及停止標準。 
103 
步驟 10：如果停止的條件滿足，則結束， bestg 的目標函數值即為最佳解，否則
回到步驟 6。 
 
圖 4.30 OO 混合 PSO 的求解流程圖 
105 
為了解此配電系統，在不違反安全運轉條件下，探討饋線重組及 DG 安裝位
置，對 DG 安裝最大容量的影響，本文分析下列三種不同 Cases: 
Case 1: DG 安裝在 3 個位置，分別是 n63、n12 和 n41，不考慮饋線重組，
控制變數只有分散式電源容量。 
Case 2: DG 安裝位置和 Case 1 同，但考慮饋線重組，因此控制變數含分散
式電源容量及常開開關位置。 
Case 3: DG 安裝位置可以自由選擇和並考慮饋線重組，控制變數包括分散式
電源容量，常開開關位置及分散式電源裝置位置。 
使用排序最佳化求解上述 3 個最佳化問題時，首先隨機抽取控制變數 N 
=1000 個可行解，組成表征集合。利用 crude model 計算電壓及饋線電力負載量
以快速得到目標函數值，將目標函數值從小到大排列，以得到 OPC 曲線，圖 4.32
顯示 DGs 最大容量 OPC 曲線型狀近似 flat 曲線。選擇 %α =95%，g=50，k=1，
使用上一節描述之 crude model 和正確模式(負載潮流分析) 計算目標函數值之間
誤差值的變異數=0.163，由於 22 3σ=W ，因此 W=0.699，經查文獻[4-38]之表 1 可
以得到 z =8.4299， ρ =0.7488、 γ =-1.1795 和η =2.0，將這些常數代入式(7)就可以
得到 s=47.407，為了方便計算，s 的大小取 10 的倍數，因此取 s=50，也就是在
1000 筆利用 crude mode 計算目標函數值，只要取最優目標函數之前 50 筆使用準
確模式計算目標函數值，至少有 1 筆在”足夠好解”集合的機率是 95%。 
為了比較排序最佳化和一般人工智慧最佳化演算法的求解效能，本文也同時
使用粒子群最佳演算法解 DG 安裝最大容量的最佳化問題，為了方便比較，粒子
數取 50。由於使用 OO 方法可以快速得到簡易解，本文同時探討結合 OO 和 PSO
的方法，也就是 OO 得到的解作為 PSO 的初始解，再以 PSO 演算法求解，並和
隨機選取初始解之 PSO 演算法做比較。為了解這些方法的穩定性，每個 Case 執
行 10 次。 
0 100 200 300 400 500 600 700 800 900 1000
0
2
4
6
8
10
12
14
16
18
20
D
G
 c
ap
ac
ity
 (M
V
A
)
 
圖 4.32 DG 最大容量 OPC 曲線圖 
表 4.19 說明在 3 個不同 Cases 下，分別使用 OO 和隨機選取 PSO 初始解所
花費的時間。由表得知，使用 OO 方法，隨著不同 Case 之控制變數增多，其執
行時間呈線性增加，Case1，Case2 和 Case3 花費的平均時間分別是 27.1 秒，30.0
秒和 33.15 秒。反觀 PSO 法使用隨機方式選取初始解，其執行時間隨控制變數增
107 
Case 2 較 Case1 增加饋線常開開關位置的控制變數，DG 平均最大總和容量
也是以 OO 結合 PSO 方法得到的為最大，其次是 PSO 方法，最差的是 OO 方法，
其得到的 DG 容量分別是 25756.9kVA、25143.6kVA 和 20881.5kVA。最大和最小
的 DG 安裝容量相差約 5000kVA。增加饋線重組的技巧，Case 2 較 Case 1 的 DG
安裝容量增加約 6000kVA。 
Case 3 比 Case 2 又再增加 DG 安裝位置之控制變數，3 種方法得到 DG 平均
最大總和容量的順序不變，其值分別是 27567.4kVA，26475.7kVA 和 21928.0kVA。
最大和最小值相差約 5500kVA。Case 3 和 Case 2 比較，增加 DG 位置選擇，DG
容量增加約 1500kVA。由以上結果得知，使用饋線重組的技巧及選擇 DG 安裝
位置是可以增加 DG 安裝容量。 
表 4.21 說明執行 10 次中，DG 安裝容量最大時之常開開關位置及 DG 安裝
位置(表中粗體字)。由表得知，Case2 經調整常開開關位置，將饋線重組，讓 DG
安裝位置附近原本由變壓器供應電力之負載，改變成由 DG 供應電力進而提高
DG 安裝容量。Case3 經由改變 DG 安裝位置，如表中之 n2, n12,n16, n78 和 n79，
這些節點都是在饋線頭端，也就是靠近變壓器附近的節點。DG 安裝在這些位置，
除了可以供應多一點饋線下游節點的負載，也可以逆送電力回變壓器，由此可
知，DG 安裝位置亦可增加 DG 的安裝容量。 
表 4.21：最佳饋線常開開關位置及 DG 安裝位置 
 OO PSO OO+PSO 
Case2 s55, s59,s62, 
s69,s88, s14, 
s90,s82,s92, 
s38,s94,s40, 
s86 
(n63, n12, n41)
s84, s60, s61, 
 s70,s76, s89, 
 s90, s91,s92, 
s37,s45,s95, 
s86 
(n63, n12, n41)
s84, s60, s63, 
 s70,s76, s89, 
 s90, s80,s92, 
s37,s94,s95, 
s86 
(n63, n12, n41) 
Case3 s84, s7, s61, 
s70,s13, s89, 
s90,s83,s92, 
s38, s45,s41, 
s86 
(n12, n20, n78) 
s84, s85, s96, 
 s87,s88, s89, 
s90, s80,s92, 
 s39, s33, s95, 
s86 
(n16, n67, n2) 
s84, s85, s96, 
 s69,s88, s89, 
s90, s91,s92, 
s38, s33, s95, 
s86 
(n12, n2, n79) 
 
本節結論 
本研究之目標主要以配電系統規劃為主要考量，決定如何在配電系統中安裝
最大容量之分散式電源。在考慮配電系統運轉安全下，經由饋線重組方式，尋找
分散式能源裝設位置及容量，使倂聯至配電系統分散式電源容量為最大。此問題
將設計成混合整數非線性規劃最佳化問題，控制變數包括饋線開關狀態、分散式
電源安裝位置及容量。本研究以排序最佳化法，粒子群最佳化法(Particle Swarm 
Optimization, PSO)及混和排序最佳化法和粒子群最佳化法等 3 種方法在求解上
述問題，並比較 3 種方法之效能。研究結果顯示，在配電系統符合安全運轉條件
下，經由饋線重組方式並適當選擇 DG 裝設在靠近變壓器位置，有助於增加分散
109 
第五章 結論 
 
如欲舒緩壅塞的配電系統，傳統方法為新增變電所及輸配電線，但由於人們對
於環保及自我意識的提升，造成大型集中式發電廠和輸配電設施的投資金額越來越
高，建設也越來越困難；因此轉而尋求使用分散式能源、儲能設備和需量反應等非
傳統策略解決系統壅塞問題。本研究從用戶端負載及能源管理，尋求舒緩輸配電線
路壅塞的可行方案。本構想旨在運用用戶端分散式電源及電能儲存設備裝置，配合
用戶主動參與之需量反應，尋求一可靠又有效的調配操控策略，一方面達到用戶於
尖峰時間對電力公司電能供應需求的降低，減少電費支出和線路損失及節能減碳的
效果；另一方面亦能夠透過這些電源的適度調控，以達到解決配電系統短時間過
載，而又無法建置變電所以提高整體供電量之輸配電瓶頸情況的發生。本研究分
析以分散式電源、儲能設備及需量反應方式，延緩線路設備投資的經濟效益，結
合提高分散式能源併聯容量之饋線重組，透過經濟層面及技術模擬層面分析，尋
求有助線路均載及瓶頸舒緩的最佳運轉及投資策略。 
本計畫針對配電系統中裝置分散式電源後相關的設計調配規劃以及連線運轉
時的穩定性與控制做深入的探究，進而以提供予用戶端若欲主動參與對輸配電瓶
頸等問題解決策略擬訂時之重要參考依據。由於這些分散式電源或儲能系統多是
裝設在接近負載端，主要的目標是以提供不同操作運轉需求的區域性電力為主；
若是能夠透過適當的規劃分析與操作策略擬訂，進而可以充分的應用這些分散式
電源以降低配電系統對於電網的供電需求，而達到舒緩輸變電瓶頸的問題。 
再生能源的發電量與發電週期大多與自然界環境因素有關，如太陽能發電及
風力發電，因此對於紓緩傳輸饋線或改善負載用電狀況所提供的幫助有限，透過
安裝大容量之能量儲存系統可以協助饋線改善尖峰用電與離峰用電間差量，減輕
電力系統負荷，亦可避免負載限電。因此在各個能量儲存系統與電網間建構有效
協調溝通介面，使得每個系統能在適當的控制下輸出或儲存能量，也是目前智慧
型電網所需提供基本功能。本計畫透過實驗室平台之建立以驗證理論分析。本計
畫所發展再生能源與電網間介面控制技術，包括諧振電流模式控制、預測型電流
控制、同步框參考電流控制等技術，在智慧電網中相當重要，這些技術亦可適用
於交流馬達控制，有助於國內相關產業技術升級。電力線信號傳輸技術建立，可
降低分散式再生能源系統信號傳輸的成本，使得系統開發成本低及體積小，提高
產品競爭力。  
為強化配電系統的使用效率及可靠度，配電管理系統(Distribution 
Management System, DMS)已逐漸被用來監測及控制配電系統。而好的配電系統
負載估計則有助配電管理系統執行有效的系統運轉策略及負載管理。另一方面，
在通訊與計算機工程技術領域之進步也使得相關電子裝置成本大為降低。所以，
已經有像自動讀表 (Automated Meter Reading, AMR)系統、先進讀表基礎建設
(Advanced metering infrastructure, AMI)、饋線終端單元及變電所之資料擷取與監
控系統，裝設在配電系統的變電所、饋線或終端用戶上。隨著智慧型電網的發展，
許多配電網路先進功能的達成均有賴AMI系統的支援，AMI主要的功能是對用戶
用電狀態進行量測及監視，包括用戶用電資料及電力品質資料。在取得資料後，
處理這些量測資料，同時對資料進行有效管理，除可提供用戶了解用電情況外亦
可提供其他電力管理資訊系統使用。本計畫發展配電系統狀態估計，亦針對配電
系統內饋線的負載潮流演算法進行平行化設計分析，有助配電系統即運轉效率的
提昇。 
111 
的情況時，對實際的如何高效率的擷取再生能源以產生電能，並透過這些分
散式電源的併網操控技術以解決可能發生的現實問題。本計畫所開發之可直
接連接至再生能源以擷取所產生之動能並轉換為電能的發電機組架構，將可
提昇能源整體的轉換效率，摒除不必要的轉換機構能量損失。同時所發展的
電機架構極具應用與尺寸上的彈性，將可對能源整體回收上提供創新的思維
與型式。 
2. 電力系統電壓諧波失真改善可降低負載不預期跳脫所造成的經濟損失，亦可
降低電力系統運轉損失，如線路損失、變壓器損失等，電壓諧波振盪現象及
抑制策略研究成果，未來可供台電公司訂定國內智慧電網運轉規範之參考。
再生能源併網所產生的逆送電力可能造成電網電壓過高或過大變動，因而限
制配電系系統可允許併接之分散式電源容量；靜態虛功率補償器可藉由提供
虛功率以協助穩定電網電壓及降低電網不平衡電壓，該技術未來在配電系統
扮演相當重要角色，可供台電公司訂定國內智慧電網運轉規範參考。 
 
(3)經濟效益 
1. 本計畫所訴求的是希望電力系統可以不因特定季節特定時間的短暫電力負荷
過載，而必須不斷地擴展系統所裝置的發電及送變電設施之容量。一方面將
造成這些設施在絕大部分時間的閒置所衍生的投資浪費問題；另一方面亦因
為民眾的環保等訴求所造成的用地及設施裝設困難的狀況。若能透過需量反
應及有效的調控裝置於各個用戶的分散式電源來因應這種短時間的尖峰負載
需求，則可有效地減少或延緩投資，提升系統整體的操作經濟效益。因此本
計畫強調「能源有效應用」，不但能夠對於減緩發變電設備投資及裝置上有積
極性的因應對策，更能夠提供高效率高品質的分散式發電裝置架構與併網技
術，兼顧滿足民生用電需求的同時，亦能夠對於環境的永續發展提供一可行
的途徑。本研究透過經濟層面及技術模擬層面模擬分析，尋求之最具有經濟
效益之策略將有助延緩輸配電瓶頸及投資。經濟層面除了計算延緩興建輸
配電設備之延緩效益與避免成本，並計算非傳統策略之現值利益與年均化成
本，藉由避免成本與年均化成本可比較出具有經濟效益之非傳統解決輸配電瓶
頸之策略。 
2. 台灣地處亞熱帶，綠色電能中發展重要的關鍵組件為太陽能光伏系統及風力
發電系統，無論從國家經濟發展、節能減碳或是產業開發與競爭力提昇方面
而言，都有必要投注大量的資源以積極研究發展。而這兩種關鍵組件的開發
與利用有賴於基礎研究人力的訓練及先期的特性與應用模擬驗證。藉由本計
畫對此類分散式電源模型建立及與配電系統整合模擬，可以簡化開發的時
程、快速訓練研究人才、探討綠色電能的運作性能，也可能解決用電壅塞與
提出瓶頸舒緩可行性的策略方案，對於改善用電品質及提高經濟效益有助益。 
3. 本研究發展之 1kW 模組化電力轉換器設計，可達到快速的擴充電力轉換器的
功率處理能力，也可提高供電穩定性及維護方便等優點，此技可技轉給廠商，
提昇廠商對電力轉換器的設計能力。 
4. 以多核心電腦執行之平行化程式，可以改進各項配電系統管理決策的即時反
應時間，因而增進電力系統關鍵管理的品質。 
 
(4)社會影響 
1. 民生社會發展方面：穩定的電力供應為國家產業發展及民眾生活品質提昇上
113 
參考文獻 
[2-1] H. Falaghi and M.-R. Haghifam, “Distributed generation impacts on electric 
distribution systems reliability: sensitivity analysis,” EUROCON 2005, 
Proceedings of the International Conference on “Computer as a Tool,” IEEE, 
Nov. 2005. 
[2-2] S. X. Wang, W. Zhao and Y. Y. Chen, “Distribution system reliability 
evaluation consider DG impacts,” DRPT, Proceedings of the 3rd International 
Conference on Deregulation and Restructuring and Power Technologies, 
April 2008. 
[2-3] L. Ding, Z.-C. Pan, and B. Wang, “Impact on reliability in active networks 
with distributed generation interconnection,” IPEC 2007, Proceedings of the 
8th International Power Engineering Conference, 2007. 
[2-4] R. E. Brown and L. A. A. Freeman, “Analyzing the reliability impact of 
distributed generation,” Proceedings of the IEEE PES 2001 Summer Meeting, 
2001. 
[2-5] N. Jenkins, R. Allan, P. Crossley, P. Kirschen, and G. Strbac, Embedded 
Generation, The Institution of Engineering and Technology, London, UK, 
2000. 
[2-6] D. J. Shin, J. O. Kimb, K. H. Kim and C. Singh, “Probabilistic approach to 
available transfer capability calculation,” Electric Power Sys. Research, vol. 
77, pp. 813-820, 2007. 
[2-7] C. S. Chen, M. Y. Huang, and C. C. Chen, “Expansion planning of substation 
capacity by considering service reliability,” Proceedings of the IEEE Int. 
Conf. on Power Sys. Tech., vol. 1, pp. 58-62, Singapore, Nov. 2004. 
[2-8] M. G. Molina and P. E. Mercado, “Modeling and control of grid-connected 
photovoltaic energy conversion system used as a dispersed generator,” 
Proceedings of the IEEE/PES Transmission and Distribution Conference and 
Exposition, Latin America, pp. 1-8, Aug. 2008. 
[2-9] A. Yazdani and P. P. Dash, “A control methodology and characterization of 
dynamics for a photovoltaic (PV) system interfaced with a distribution 
network,” IEEE Trans. Power Delivery, vol. 24, no. 3, pp. 1538-1551, 2009.  
[2-10] R. Majumder, A. Ghosh, G. Ledwich, and F. Zare, “Load sharing and power 
quality enhanced operation of a distributed microgrid,” IET Renewable Power 
Generation, vol. 3, no.2, pp.109-119, 2009.  
[2-11] H. Wei, Z. Jianhua, X. Qinghua and W. Ziping, “The impact on power quality 
by PWM converter in micro-grid,” Proceedings of the International 
Conference on Sustainable Energy Technologies, pp. 239-243, Nov. 2008.  
[2-12] IEEE Standard for Interconnecting Distributed Resources with Electric 
Power Systems, IEEE Standard 1547, 2003. 
[2-13] I. Şerban and C. Marinescu, “A solution for frequency control in islanded 
three-phase micro-grids supplied by renewable energy sources,” Proceedings 
of the International Conference on Optimization of Electrical and Electronic 
Equipment, pp. 327-332, May 2008. 
[2-14] A. S. Neto, F. A. S. Neves, E. L. R. Pinheiro, R. Gaiba, and S. R. Silva, 
“Dynamic analysis of grid connected wind farms using ATP,” Proceedings of 
the 36th IEEE Power Electronics Specialists Conference, pp.198-203, June 
2005. 
[2-15] R. F. Coelho, F. Cancer and D. C. Martins, “A proposed photovoltaic module 
and array mathematical modeling destined to simulation,” Proceedings of the 
IEEE International Symposium on Industrial Electronics, pp. 1624-1629, July 
115 
implementations,” Proc. of 2006 IEEE PES Power Systems Conference and 
Exposition, 2006. 
[4-13] V.H. Allan, et al., “Software pipelining,” ACM Computing Surveys, Vol. 27, No. 
3, September 1995. 
[4-14] M.S. Lam, “Software pipelining an effective scheduling technique for VLIW 
machines,” SIGPLAN Notices, Vol. 39, No. 4, April 2004. 
[4-15] H. Rong, et al., “Single-dimension software pipelining for multidimensional 
loops,” ACM Transactions on Architecture and Code Optimization, Vol. 4, No. 
1, March 2007. 
[4-16] N. Ahmed, et al., “Tiling imperfectly-nested loop nests,” Proc. of the 2000 
ACM/IEEE conference on Supercomputing, 2000. 
[4-17] Z. Li and Y. Song, “Automatic tiling of iterative stencil loops,” ACM Trans. on 
Programming Languages and Systems, Vol.26, No. 6, Nov. 2004. 
[4-18] K. Sun, et al., “Parallel domain decomposition for simulation of large-scale 
power grids,” Proc. of the 2007 IEEE/ACM Int’l Conf. on Computer-aided 
design, 2007.  
[4-19] G.M. Amdahl, “Validity of the single-processor approach to achieving 
large-scale computing capabilities,” Proc. of the American Federation of 
Information Processing Societies Conf. (AFIPS), 1967. 
[4-20] S. Eyerman and L. Eeckhout, “Modeling Critical Sections in Amdahl’s Law 
and its Implications for Multicore Design,” Proc. of the 37th Int’l Symp. on 
Computer Architecture, 2010. 
[4-21] M.J. Wolfe, High performance compilers for parallel computing, 
Benjamin/Cummings, 1996. 
[4-22] OpenMP Architecture Review Board, OpenMP Application Program Interface, 
Version 3.0, OpenMP Architecture Review Board, May 2008. 
[4-23] R. Chandra, et al., Parallel programming in OpenMP, Morgan Kaufmann, 
2001. 
[4-24] F. Z. Peng, “Editorial Special Issue on Distributed Power Generation, ” IEEE 
Trans on Power Electronics，vol. 19, no. 5, pp. 1157-1158, 2004. 
[4-25] N. Hadjsaid, J. F. Canard and F. Pumas, “Dispersed Generation Impact on 
Distribution Networks,” IEEE Computer Applications in Power, vol. 12, pp. 
22-28, 1999. 
[4-26] P.P Barker and R.W. De Mello, “Determining the Impact of Distributed 
Generation on Power Systems. I. Radial Distribution Systems,” Proceedings 
of IEEE PES Summer Meeting, vol.3, pp. 1645 -1656, 2000. 
[4-27] Chensong Dai and Y. Baghzouz, “On the voltage profile of distribution feeders 
with distributed generation,” IEEE Power Engineering Society General 
117 
for electric power suppliers in daily energy market,” IEEE Trans. on Power 
Systems, vol. 16, no. 4, pp. 1788-797, 2001. 
[4-40] Y. Shin, Y.C. Ho, C.H. Lin,” An ordinal optimization theory-based algorithm 
for solving the optimal power flow problem with discrete control variables,” 
IEEE Trans. on Power Systems, vol. 19, no. 1, pp. 276-286, 2004. 
[4-41] J. Kennedy and R. Eberhart, “Particle Swarm Optimization,” in Proceeding of 
the Fourth IEEE International Conference on Neural Networks, pp. 
1942-1948, 1995. 
[4-42] Y. Shi and R. Eberhart, ”Empirical study of particle swarm optimization,” in 
Proc. of IEEE International Conference on Evolutionary Computation, 
Anchorage, pp. 1945-1950, May 1999. 
[4-43] J.P. Chiou, C.F. Chang, C.T. Su,” Variable scaling hybrid differential evolution 
for solving network reconfiguration of distribution systems,” IEEE Trans. on 
Power Systems, vol. 20, no. 2, pp. 668-674, 2005.。 
 
 
 
 
2010 年國際電力電子研討會  出席報告 
 
李宗璘 
國立中山大學電機工程學系 
 
一.參加會議經過 
第六屆國際電力電子研討會 (2010 international power electronics 
conference IPEC-Sapporo)於 2010/6/21～2010/6/24在日本北海道札幌舉行，
研討會主題包括電力電子領域最新的技術發展、專題演講、口頭論文報告、海報
瀏覽及廠商展覽，該次研討會因為 IEEE/PELS的強力支援，因此也稱作
ECCE-ASIA，本人與碩士班學生王諺青及胡尚宏一起於 6/21號抵達會場。 
6/21 日下午主要以工業界專題演講為主，包括以下主題，相當實用。 
1. Electric propulsion for vehicles and total energy management 
2. NTT activity for green IT 
3. Advances of power electronics technology in the induction heating 
appliances 
4. Development of photovoltaic generation system in SHARP 
5. Power electronics for low-carbon industrial revolution 
6. NEDO’s power electronics projects and related activities 
 
6/22 號上午開始一連串的主題演講，主要包括應用電力電子技術於軌道科
技、高溫半導體技術與智慧電網應用等，議題圍繞在透過電力電子技術改善供電
與提升效率，為未來幾年電力電子技術發展的趨勢。6/22號下午開始一連串的
專題研討與壁報展示，幾個目前最熱門的題目都有相當的學者參與討論，如微電
網、多階反流器、太陽能電力轉換器、電動車及馬達控制器在家電產品應用。 
6/23 號上午專題研討則以直流轉換器、EMI 及車輛電子，下午以市電併網型
電力轉換器為主，另外有許多文章提出電力品質改善的策略。 
行政院國家科學委員會補助國內專家學者出席國際學術會議報告 
99 年 7 月 31 日 
報 告 人 
姓 名 
高崇堯 服務機構 
及 職 稱 
國立中山大學電機工程學系副教
授 
會
議 
時間 
地點 
時間: 2010/07/05 至 2010/07/09 
地點: 匈牙利，布達佩斯 
本會核定 
補助文號 
NSC 98-2218-E110-006 
NSC 98-3114-E-110-004 
會議名稱 
(中文) 第十九屆網路及系統理論國際研討會 
(英文) The 19th International Symposium on Mathematical Theory of Networks and Systems 
(MTNS 2010) 
發表論文
題 目 
(中文) 以二次積分限制法則分析有時變延遲項之離散時間系統的穩定度 
(英文) Stability Analysis of Discrete-Time Systems with Time-Varying Delays via Integral 
Quadratic Constraints 
報告內容應包括下列各項： 
一、參加會議經過 
二、與會心得 
三、考察參觀活動（無是項活動者省略） 
四、建議 
五、攜回資料名稱及內容 
六、其他 
 
 
 
 
 七月九日 
於 9:00 左右抵達會場，參加上午的 Plenary Lecture 及四場專題演講，以及午後的
Semiplenary lecture。下午則待在本人發表論文的場次。本人發表論文的場次共有四場
演講，本人的演講排在第二場。由於當天是大會的最後一天，參與的人數並不踴躍；
但本人的演講仍有十數位聽眾，論文發表後亦有一兩位學者提出問題相互討論，算是
一個相當成功的發表。大會於下午 5:30 結束。結束後本人與瑞典的 Ulf Jönsson 教授、
Kin Cheong Sou 博士、美國的 Magnus Egerstedt 教授、以及澳洲的 Bjorn Ruffer 博士共
進晚餐。 
 
 七月十日至十四日 
自費行程。參訪布達佩斯及維也納。 
 
 七月十五日 
於上午 5:00 左右離開旅館前往機場，搭乘 7:50 之匈牙利航空班機起程，於當日上午
9:30 左右抵達德國法蘭克福國際機場後，轉搭 13:30 之國泰航空班機轉往香港後轉搭
港龍航空班機返回高雄。於台灣七月十六日上午 10:30 左右抵達高雄，結束了這趟收
穫豐碩之國際會議行程。 
 
 
二、與會心得 
 
網路及系統理論國際研討會(International Symposium on Mathematical Theory of Networks 
and Systems, MTNS)，乃是一關於系統理論的國際性會議. 與會發表之論文多是與控制系統理
論，通訊理論，及訊號處理理論相關。此會議每兩年招開一次，會議規模與 IEEE 每年舉辦
的 Conference on Decision and Control 比較起來，相對較小，算是中等規模的會議。雖然如此，
此會議每次招開皆能吸引全球頂尖的系統理論學者參與。在本次會議五天的會期裏，有四百
多場專題演講，發表的論文涵蓋系統理論領域裡各種研究的課題。參與本次會議，除了得以
獲悉本人主要的研究課題（時間延遲系統、大型網路系統、切換系統）之最新研究進展，與
同領域的專家先進研討之外，藉著參與各種專題演講，本人亦得以獲知系統理論領域裡其它
研究課題的進展、並進一步了解目前系統理論領域研究的趨勢。除了參與專題演講之外，本
人也利用會期間的咖啡及午餐時間，與多位學者專家討論交換研究心得，從中獲得不少可貴
的想法。特別值得一提的是，利用參與本次會議的機會，本人得以再次與長期合作伙伴，瑞
典的 Ulf Jönsson 教授會面，當面討論合作研究的課題。會期中所討論的想法，目前正在進行，
如進展順利，將來很有可能發展出合著論文。 
 
參與本次會議的台灣學者，除了本人之外，只有台大機械系的王富正教授。比較起歐美
日等國家參與此次會議的人數，吾人可知台灣對系統理論領域的重視程度。系統理論乃是控
制，通訊，及訊號處理等工程領域的基礎。以台灣有如此高能見度的電機電子通訊產業而言，
對系統理論領域參與度與參與規模是如此之少的現象，著實令人覺得驚訝。 
 
 
 
 
 
 
 
Stability Analysis of Discrete-Time Systems with Time-Varying Delays via
Integral Quadratic Constraints
Chung-Yao Kao
Abstract— This manuscript presents certain l2-gain proper-
ties of and the integral quadratic constraint characterizations
derived from these properties for the discrete-time time-varying
operator. These IQC characterizations are crucial for the
IQC analysis to be applied to study robustness of discrete-
time systems in the presence of time-varying delays. One new
contribution of this manuscript is to utilize the information of
the variation of the delay parameter to derive less conservative
IQCs. The effectiveness of the proposed IQC analysis is verified
by numerical experiments, the results of which are compared
with those recently published in the literature.
I. INTRODUCTION
The content of this manuscript concerns robust stability
analysis of discrete-time systems with time-varying delays
in the following forms:
푥[푘 + 1] = 퐴푥[푘] +퐴푑푥[푘 − 휏 [푘]]
+ Δ(푥[푘], 푥[푘 − 휏 [푘]]) + 푒[푘] (1)
where 푛-dimensional signal 푥 is the signal of interest, 푒 is
a finite-energy disturbance, 퐴 and 퐴푑 ∈ ℝ푛×푛 are constant
matrices, and Δ(⋅, ⋅) is a causal and bounded operator on
the space of all finite-energy signals (the l2 space). The
delay sequence 휏 is an unknown function where only the
bounds on its value and/or variation are available to us. The
robust stability problem in question is to verify whether,
under any finite-energy disturbance input 푒, the energy of
signal 푥 remains finite for all admissible delay sequences
satisfying the given conditions.
Most existing results in the literature for time-varying
delay robustness were developed in time domain based on
the Lyapunov stability theorem – in which certain form
of Lyapunov-Krasovskii functional candidates are used to
derive stability conditions (see, for example, [1], [2], [3], [4],
[7], [9], [10], [11], [12]). The form of Lyapunov functions is
often tied to the formulation of systems under consideration.
As such, it is often non-trivial to generalize the result
for other systems with similar but slightly different forms
because the generalization involves modification of the form
of the Lyapunov function, which might not be easy to come
up with.
In contrast to the Lyapunov approach, in [6] and [5] we
proposed to tackle time-varying delay robustness problems
via a frequency-domain approach called Integral Quadratic
Constraint (IQC) analysis. The crucial step of applying the
Chung-Yao Kao is with the Department of Electrical Engineer-
ing, National Sun Yat-Sen University, Kaohsiung, Taiwan. E-mail:
cykao@mail.nsysu.edu.tw. His work is supported by the National Science
Council, Taiwan, under the grants NSC 98-2218-E-110-006 and NSC 98-
3114-E-110-004.
IQC analysis to analyze robust stability of time-varying
delay systems is to characterize the time-varying delay
operator in terms of integral quadratic constraints. With the
IQC characterization, stability conditions can be straightfor-
wardly obtained following the IQC stability theorem [8].
In [5] several IQCs were derived for discrete-time time-
varying delay operators. It is found that, in terms of energy
amplification, the discrete-time time-varying delay opera-
tor has some distinct features compared to its continuous-
time counterpart. In particular, for the discrete-time time-
varying operator, as long as the delay sequence is upper
bounded, the energy amplification ratio (i.e.; the l2-gain)
is always bounded regardless of the variation of the delay
sequence. This is distinctly different from its continuous-
time counterpart in that the ℒ2-gain depends only on the
variation of the delay parameter and the gain becomes
unbounded when the variation of the delay parameter exceeds
one. For the discrete-time case, it was unclear whether and
how the variation of the delay sequence affects the l2-gain
of the discrete-time time-varying delay operator, and how
to effectively utilize the information on the variation of
the delay sequence in robustness analysis of discrete-time
systems with time-varying delays. In this manuscript, we
continue our endeavor in [5]. We will focus on making the
link between the variation of the delay sequence and the
l2-gain of the time-varying delay operator, which hopefully
will lead to better IQC characterizations of the operator and
less conservative criteria for verifying varying-time-delay
robustness of discrete-time systems. Numerical experiments
will be conducted to verify the proposed stability criteria.
The remaining part of the manuscript evolves along the
following line. The next section introduces the main notation
and the IQC analysis applied to checking very-time-delay
robustness of linear time-invariant discrete-time systems.
Section III presents the IQCs for the time-varying delay
operator we so far discovered. Stability criteria resulting from
these IQC characterizations are presented in Section IV. The
results of the numerical experiments conducted to verify
the effectiveness of the proposed stability criteria are pre-
sented in Section V. Finally, we make a concluding remark
summarizing the current state of our work and what to be
investigated in the future.
II. NOTATIONS AND PRELIMINARIES
Symbol 퐼푛 is used to denote 푛-dimensional identity ma-
trix. The subscript 푛 is dropped when the dimension is
evident from the text. Given a matrix 푀 , the transposition
and the conjugate transposition are denoted by 푀 ′ and 푀∗,
Proceedings of the 19th International Symposium on Mathematical Theory of Networks and Systems – MTNS 2010 •  5–9 July, 2010 • Budapest, Hungary
ISBN 978-963-311-370-7 2309
Proposition 1. Consider the time-varying delay operator 풟휏
where the delay parameter 휏 could be any sequence from Υ1.
Then the following characterization holds for 풟휏 :
sup
휏∈Υ1
∥풟휏∥l2 =
√
ℎ. (5)
Furthermore, it can be shown that a unit impulse function
and the following delay sequence
휏 [푘] =
⎧⎨
⎩
풯푚 if 푘 < 풯푚
푘 if 풯푚 ≤ 푘 ≤ 풯푀
풯푀 if 푘 > 풯푀
(6)
realize the worst-case l2-gain.
Proposition 2. Consider the time-varying delay operator 풟휏
where the delay parameter 휏 could be any sequence from
Υ2, in which it is further assumed that 푑 < 푀 . Then the
following characterization holds for 풟휏 :
sup
휏∈Υ2
∥풟휏∥l2 =
√
푑+ 1. (7)
Furthermore, it can be shown that a unit impulse function
and the following delay sequence
휏 [푘] =
⎧⎨
⎩
풯푚 if 푘 < 풯푚
푘 if 풯푚 ≤ 푘 ≤ 풯푚 + 푑
풯푚 + 푑 if 푘 ≥ 푇푚 + 푑
(8)
realize the worst-case l2-gain.
Remark 1. Given any 푀 > 1, let us define the 푀 -step total
variation, and 푀 -step average variation of 휏 as
훿푀휏 [푘] :=
푀−1∑
푚=0
∣휏 [푘 + 1 +푚]− 휏 [푘 +푚]∣ ,
and
훿¯푀휏 [푘] :=
1
푀
푀−1∑
푚=0
∣휏 [푘 + 1 +푚]− 휏 [푘 +푚]∣ ,
Then Proposition 2 can be interpreted as follows: if one
may find a constant 푀 > 1 and establish that the 푀 -step
average variation of the delay sequence 훿¯푀휏 [푘] is strictly less
than one for all 푘, then the upper bound of the 푀 -step total
variation provides a tighter upper bound of the l2-gain of
the delay operator, assuming that the upper bound of the
푀 -step total variation 푑 is strictly less than 풯푀 − 풯푚 + 1.
For the upper bound 푑 of 훿푀휏 [푘] to be useful, it is crucial
that 푑 < 풯푀 −풯푚+1 and 훿¯푀휏 [푘] is strictly less than one for
all 푘. Also notice that the actual value of the upper bound
of 훿¯푀휏 [푘] does not offer useful information here. The only
crucial information is whether it is strictly less than one.
Proposition 3. Consider the time-varying “delay-difference”
operator 풮휏 where the delay parameter 휏 could be any
sequence from Υ1. Then the following characterization holds
for 풮휏 : for any l2 signal 푣,
∥풮휏푣∥2l2 ≤
∞∑
푘=−∞
풯∑
푖=1
(푣[푘]− 푣[푘 − 푖])2. (9)
Proposition 4. Consider the time-varying “delay-difference”
operator 풮휏 where the delay parameter 휏 could be any
sequence from Υ1. Then the following characterization holds
for 풮휏 : ∥∥∥∥풮휏 ∘ 푧푧 − 1
∥∥∥∥
l2
≤ 풯푀 , (10)
where 푧 represent the forward shifting operator and 푧
푧−1
the
discrete-time integrator.
Propositions 1 to 4 give rise to the following integral
quadratic constraints for 풟휏 and 풮휏 .
Proposition 5. Consider the time-varying delay operator 풟휏
where the delay parameter 휏 could be any sequence from
Υ1. Then the operator 풟휏 satisfies any integral quadratic
constraint defined by
Π1 =
[
ℎ푋1 0
0 −푋1
]
(11)
where 푋1 = 푋 ′1 ≥ 0 is any positive semi-definite matrix.
Proposition 6. Consider the time-varying delay operator
풟휏 where the delay parameter 휏 could be any sequence
from Υ2, in which 푑 < 푀 – in other words, the 푀 -step
average variation of 휏 is strictly less than one for all 푘. Then
the operator 풟휏 satisfies any integral quadratic constraint
defined by
Π2 =
[
(푑+ 1)푋2 0
0 −푋2
]
(12)
where 푋2 = 푋 ′2 ≥ 0 is any positive semi-definite matrix.
Proposition 7. Consider the time-varying “delay-difference”
operator 풮휏 where the delay parameter 휏 could be any se-
quence from Υ1. Then the operator 풮휏 satisfies any integral
quadratic constraint defined by
Π3 =
[∣휙(e푗휔)∣2푋3 0
0 −푋3
]
(13)
where 휙(푧) ∈ Rl∞ satisfies
∣휙(e푗휔)∣2 =
풯∑
휅=1
∣1− e−푗휅휔∣2 (14)
and 푋3 = 푋 ′3 ≥ 0 is any positive semi-definite matrix.
Proposition 8. Consider the time-varying “delay-difference”
operator 풮휏 where the delay parameter 휏 could be any se-
quence from Υ1. Then the operator 풮휏 satisfies any integral
quadratic constraint defined by
Π4 =
[풯 2푀 ∣휓(e푗휔)∣2푋4 0
0 −푋4
]
(15)
where 휓(푧) = 푧−1
푧
and 푋4 = 푋 ′4 ≥ 0 is any positive semi-
definite matrix.
Proceedings of the 19th International Symposium on Mathematical Theory of Networks and Systems – MTNS 2010 •  5–9 July, 2010 • Budapest, Hungary
2311
REFERENCES
[1] E. Fridman and U. Shaked. An improved stabilization method for
linear time-delay systems. IEEE Transactions on Automatic Control,
47(11):1931–1937, November 2002.
[2] E. Fridman and U. Shaked. Delay-dependent stability and 퐻∞ control:
Constant and time-varying delays. International Journal of Control,
76(1):48–60, 2003.
[3] H. Gao and T. Chen. New results on stability of discrete-time systems
with time-varying state delay. IEEE Transactions on Automatic
Control, 52(2):328–334, February 2007.
[4] H. Gao, J. Lam, C. Wang, and Y. Wang. Delay-dependent output-
feedback stabilization of discrete-time systems with time-varying state
delay. IEEE Proceedings – Control Theory Application, 151(6):691–
698, November 2004.
[5] C.-Y. Kao. On robustness of discrete-time LTI systems with varying
time delays. In Proceedings of IFAC 2008, 2008.
[6] C.-Y. Kao and A. Ranzter. Stability analysis with uncertain time-
varying delays. Automatica, 43(6):959–970, June 2007.
[7] V. L. Kharitonov and S.-I. Niculescu. On the stability of linear systems
with uncertain delay. IEEE Transactions on Automatic Control,
48(1):127–132, January 2003.
[8] A. Megretski and A. Rantzer. System analysis via Integral Quadratic
Constraints. IEEE Transactions on Automatic Control, 42(6):819–830,
June 1997.
[9] J.-P. Richard. Time-delay systems: an overview of some recent
advances and open problems. Automatica, 39(10):1667–1694, October
2003.
[10] S.-H. Song, J.-K. Kim, C.-H. Yim, and H.-C. Kim. ℋ∞ control
of discrete-time linear systems with time-varying delays in state.
Automatica, 35:1587–1591, 1999.
[11] V. Suplin, E. Fridman, and U. Shaked. 퐻∞ control of linear uncertain
time-delay systems - a projection approach. IEEE Transactions on
Automatic Control, 51(4):680–685, April 2006.
[12] M. Wu, Y. He, J.-H. She, and G.-P. Liu. Delay-dependent criteria
for robust stability of time-varying delay systems. Automatica,
40(8):1435–1439, August 2004.
Proceedings of the 19th International Symposium on Mathematical Theory of Networks and Systems – MTNS 2010 •  5–9 July, 2010 • Budapest, Hungary
2313
表 Y04 
 
 
圖 2. 
 
圖 3. 
 
圖 4. 
 
 
 
 
表 Y04 
行政院國家科學委員會補助國內專家學者出席國際學術會議報告 
                                                            99 年 11月 29日 
報告人姓名 
 
  陳曦照 
 
服務機構 
及職稱 
 
  高苑科技大學電機系副教授 
 
     時間 
會議 
     地點 
  99.11.21~99.11.24 
  日本 福岡 
本會核定 
補助文號 
NSC98-3114-E-110-004  
名稱:用戶端主動參與之線路均載及瓶
頸舒緩策略研究 
會議 
名稱 
 (中文) IEEE第 10分區 2010國際學術研討會 
 (英文) IEEE Region 10 Conference 2010,TENCON 2010 
發表 
論文 
題目 
 (中文) 經由匹配測量值程序實現配電饋線匯流排負載估測 
(英文)  Distribution Feeder Bus Load Estimations by Measurement Matching 
附
件
 
表 Y04 
 
二、與會心得 
    本會議為 IEEE第 10分區舉辦 2010年國際學術研討會(TENCON 2010)，今年
TENCON2010國際學術研討會於 2010/11/21~24在日本福岡的國際會議中心召開，電機系張
榮芳老師及本人均各有發表一篇論文(本人發表論文名稱：Distribution Feeder Bus Load 
Estimations by Measurement Matching)，因此相偕一同前往出席該會議。此次 TENCON2010
會議，共發表了 489篇論文，內容則涵蓋 IEEE的 10個不同領域及女性於工程方面之論文(如
六、其他，所載之議程)，而張老師及本人的論文均被安排在會議第二天發表。在發表會場
中除了看到來自各國優秀的研究學者，也遇見不少從台灣來的教授與學生來此發表論文，
除了高苑之外，其中還包括來自東華大學、東南科大、中央大學、中興大學、暨南大學、
亞洲大學、彰師大、成大、義守、東方技術學院及中山大學等)。會議期間我們亦至電力與
能源等相關領域之發表會場，聆聽與學習他人之長處。而每位發表論文之學者除了全程以
英文發表之外，亦極為用心將他們的成果和與會人員分享與討論，因此，個人深深覺得獲
益良多，不虛此行。經由本次研討會及攜回資料，可瞭解目前電力界研究的重點，尤其是
新理論的應用，亦可提供本人未來研究的重要參考資料。 
 
三、考察參觀活動(無是項活動者省略) 
四、建議(無) 
五、攜回資料名稱及內容 
 
IEEE Region 10 Conference 2010,TENCON 2010 (CD) 
 
六、其他 
 
11月 22~24日之議程： 
 
Monday, November 22, 2010 
Room 411 406 413 414 405 404 403 402 412 
09:00-10:30 Opening & Keynote Speech I (Main Hall, 3rd Fl.) 
11:00-12:00 T1-1 
Power 
Electroni
cs (I) 
T1-10 
Electric 
Power 
System 
Hardware (I) 
T3-1 
Face 
Recognition (I) 
 T10-1 
Scattering 
and Guided 
Wave 
Analysis 
T2-1 
Spintronics 
and 
Photonics 
T9-1 
Biomedical 
Engineerin
g (I) 
 WIE-1 
Pattern 
recogniti
on 
13:30 -15:10 T1-2 
Power 
Electroni
cs (II) 
T1-11 
Electric 
Power 
System 
Hardware (II) 
T3-2 
Video 
Processing 
T4-1 
Ubiquito
us 
Network 
(1) 
T10-2 
Antenna 
Design 
T2-2 
Device 
Simulations 
T9-2 
Biomedical 
Engineerin
g (II) 
T6-1 
Computing 
Architectur
es and 
Systems (I) 
WIE-2 
Power 
and 
Energy 
15:10-16:10 Poster Session I 
16:10-17:50 T1-3 
Power 
Electroni
cs (III) 
T1-12 
Electric 
Power 
System 
Hardware 
(III) 
T3-3 
Image 
Processing 
Applications 
T4-2 
Ubiquito
us 
Network 
(2) 
T10-3 
Optoelectroni
cs and 
Lasers 
T2-3 
Plasma-na
no 
Interface 
T9-3 
Biomedical 
Engineerin
g (III) 
T6-2 
Computing 
Architectur
es and 
Systems 
(II) 
WIE-3 
Signal 
Processi
ng 
  
Tuesday, November 23, 2010 
Room 411 406 413 414 405 404 403 402 412 
09:00-10:20 T1-4 
Electric 
Power 
T1-13 
Power and 
Energy 
T3-4 
Face 
Recognition 
T4-3 
Theory 
T10-4 
Microwave 
Devices 
T2-4 
Devices 
T7-1 
Modeling 
and 
T8-1 
Analog 
Circuit 
WIE-4 
Networks 
and 
1Design of Resonant Current Regulation for Discrete
Frequency Tuning Active Filter
Tzung-Lin Lee and Shang-Hung Hu
Department of Electrical Engineering, National Sun Yat-sen University, TAIWAN
Abstract—Harmonic resonances of the distribution power
system have become a significant issue in recent years, due
to extensive use of either nonlinear loadings or inverter-based
distributed generation systems. This paper presents resonant
current regulation to enhance the damping capability of the
discrete frequency tuning active filter for suppressing power
system harmonics. The resonant current regulator, which is
composed of various parallel band-pass filters tuned at harmonic
frequencies, is implemented so that the active filter can operate
as variable conductance for each harmonic frequency without
increasing overall gain of controller. Compared to the active
filter with proportional control, the current tracking capability
and the associated damping performances can be improved in
the proposed method, especially for higher order harmonics due
to severe phase lagging. Therefore, harmonic resonances can
be definitely avoided and voltage distortion for each harmonic
frequency can be separately suppressed to conform with har-
monic regulation. The required damping conductance to maintain
the harmonic voltage at an allowable level is also significantly
reduced. Operation principles are explained and test results
validate the effectiveness of the proposed approach.
KEYWORDS
Active power filter, Harmonic resonance, Harmonic voltage
damping
I. INTRODUCTION
Harmonic resonances resulting from power factor correction
capacitors and/or line capacitance have been a serious power
quality issue in the distribution power system [1], [2], [3],
[4], [5]. This scenario becomes more significant, due to either
a large amount of nonlinear loadings or high penetration of
inverter-based distributed generation systems [6]. According
to IEEE std. 519-1992 [7], maximum allowable voltage Total
Harmonic Distortion (THD) is 5% and individual voltage
distortion is 3% in distribution networks below 69kV. There-
fore, developing an effectively damping approach to maintain
voltage distortion at an acceptable level needs to be further
addressed.
Akagi et al. proposed a voltage detection active filter operat-
ing as harmonic conductance to suppress harmonic resonances
in a radial power distribution line [8]. This approach may
suffer from the mismatching between the active filter and
the line impedance, and thus result in unintentional ampli-
fication of harmonic voltage. This phenomenon is called as
”whack-a-mole” problem [9]. In this situation, large harmonic
distortion is induced on other positions in the distribution
This work is supported by National Science and Technology Program-
Energy of TAIWAN under grant NSC 98-3114-E-110-004.
system when the active filter provides damping functionality
at its deploying location. Distributed installation of active filter
systems presented previously can approach this issue, in which
a real-time communication system [10] or harmonics-drooped
control [11], [12] needs to be developed for coordinating the
operation of active filters with effectively damping function-
ality.
Authors have presented discrete frequency tuning active fil-
ter to alleviate the ”whack-a-mole” problem by separately ad-
justing damping conductance of each harmonic frequency [13].
This work is continuation to improve current tracking ca-
pability and damping performances of the active filter by
using the so-called resonant current regulation [14], [15]. The
resonant current regulator is composed of parallel-connected
band-pass filters to resonate at harmonic frequencies for
controlling the active filter as variable conductance for each
harmonic frequency. The harmonic damping performances
are improved accordingly without increasing overall gain of
controller even for higher order harmonic frequencies. In the
proposed method, the damping conductance of each harmonic
frequency is dynamically adjusted to avoid harmonic reso-
nances and conform voltage distortion with the harmonics reg-
ulation. Compared with the proportional-gain current control,
the required damping conductance to maintain the harmonic
voltage at an allowable level is significant reduced, so is the
kVA rating of the active filter
II. OPERATION PRINCIPLES
A simplified one-line diagram of the proposed discrete
frequency tuning active filter with resonant current regulation
is shown in Fig. 1. The active filter unit (AFU) is installed
at the end of a radial line to suppress harmonic voltage
amplification. The AFU operates as variable conductance at
each harmonic frequency as given,
i∗abc =
�
h
G∗h · E˜abch (1)
where h represents the order of the harmonic frequency. The
each conductance command G∗h is defined a control gain to
provide required harmonic suppression at the corresponding
harmonic frequency. Harmonic voltage components are de-
rived according to the synchronous reference frame (SRF)
transformation. The specific harmonic voltage component
E˜abch , which becomes a dc value in the SRF at ωh, can be
extracted by using a low-pass filter (LPF), as shown in Fig. 1.
Note that ωh should be set as corresponding negative-sequence
978-1-4244-5393-1/10/$26.00 ©2010 IEEE 2271
The 2010 International Power Electronics Conference
the harmonic detection plus conductance command G 
h 
can 
be expressed as: 
H(8) = G
h 
(8 - jW
h
)TLPF (4) 
1 + (8 - jW
h
)TLPF 
where W
h 
is the fundamental frequency and TLPF is time con­
stant of the low-pass filter. Therefore, harmonic suppressing 
capability �: ��) can be obtained from Fig. 4. 
Current Computation 
Controller Delay 
PWM Output Filter 
Fig. 3. Current control block diagram of the proposed AFU. 
, --------------1 
, V"';6--�L,�Rj .I 
' 
E
h
(s) 
1 
1 
sGs 
1
*(s) 1-------------
, :�I e-,T H e-· f r� ,l, ""I 
1h
(
SlIL __________________ ---'. 
Fig. 4. Voltage control block diagram of the proposed AFU in the distributed 
power system. 
III. SIMULATION RESULTS 
The proposed discrete frequency tuning active filter is 
applied to a radial power distribution line shown in Fig. 5(a) 
to demonstrate harmonic damping performances. Since high 
order harmonics (>7 ) seldom excite obvious resonances [2], 
only fifth and seventh harmonics are considered in this paper. 
Circuit parameters are given as follows: 
• Power system: 220 V(line-to-line), 20 kVA, 60 Hz, 
L=0.2mH(3.1 %), C=150pE(13.7%). 
• Nonlinear loads NLA and NLB: They are diode rectifiers 
rated at 5 kW(25 %), respectively. 
• The reference harmonic voltage distortion is set as 3%. 
(VD;;=3.0%) 
• wf is set as 62.8Rad to filter out 120 Hz ripple compo-
nent in the calculation of harmonic voltage distortion. 
• PI controller of the tuning control: kp=100, ki=2000. 
• Current control: kp=5, ki,5=100, ki,7=100, �=0.01. 
• The AFU is implemented by conventional three-phase 
voltage source inverter with PWM frequency 10 kHz and 
the sampling frequency 20 kHz. 
Fig. 5(b) shows bus voltages are severely distorted due to 
harmonic resonances before the AFU is switched on. After 
the AFU is in operation, voltage distortion along the line is 
significantly improved as shown in Fig.5(c). Voltage THD at 
The 2010 International Power Electronics Conference 
1.6 1.8 2 2.2 
Time 
2.4 2.6 
(a) Active filter conductance commands. 
(b) Harmonic voltage distortion. 
2.8 3 
Fig. 6. Conductance commands and harmonic voltage distortion of the AFU 
when NLA and NLB are added at t=1.5 s and t=2.0 s, respectively. 
bus 9 is reduced from 6.1 % to 4.4%, which contains 3.0% fifth 
harmonics and 3.0% seventh harmonics. At the steady state, 
the AFU consumes 1.26 k VA (peak current = 9 A, rms current 
= 3.3 A) at G"S = 0.470-1 and G"7 = 0.530-1. Fig. 6 shows 
G"S, G"7, VD5, VD7 as NLA increases to 6kW at t=1.5s and 
subsequently NLB increases to 6 kW at t=2.0 s, respectively. 
Increasing nonlinear loads causes higher voltage distortion as 
shown in Fig. 6(a). The PI regulator of the tuning control 
raises both G"S and G"7 commands to draw more harmonic 
current for reducing voltage distortion. VD5, VD7 are clearly 
maintained at 3% as indicated in Fig. 6(b) after short transient. 
The overshoot of voltage distortion is not an issue because 
harmonic variation of the distribution power system is slow in 
practice. 
Fig. 7 shows the frequency domain analysis of the proposed 
resonant current control, in which predictive control (kp=20) 
and critically damped control (kp=5) are encompassed for 
comparative purpose. Resonant current control contributes 
magnitude peaks at both fifth and seventh harmonic fre­
quencies, and also provides phase-leading compensation. This 
feature raises stability margin of the system as indicated in 
the open loop gain of Fig. 7(a). From the closed loop gain 
of Fig. 7(b) and TABLE I, significant improvement of current 
tracking capability in the proposed approach can be observed 
2273 
5TABLE I
STATISTICS OF THDV ALONG THE RADIAL LINE UNDER DIFFERENT CURRENT CONTROLS.
1 2 3 4 5 6 7 8 9 G5 G7 Peak Current RMS current
kp=20 3.0% 4.5% 4.8% 4.1% 3.4% 3.7% 4.4% 4.5% 4.5% 0.6% 0.48% 9.7A 3.57A
kp=5 3.2% 5.1% 5.8% 5.6% 5.3% 5.3% 5.4% 5.0% 4.5% 1.4% 0.37% 13.5A 6.33A
kp=5,ki=100 2.9% 4.5% 4.8% 4.1% 3.3% 3.6% 4.2% 4.4% 4.5% 0.47% 0.53% 9.0A 3.3A
−40
−20
0
20
40
60
80
M
ag
ni
tu
de
 (d
B)
100 101 102 103 104
−180
−90
0
90
180
Ph
as
e 
(de
g)
Open loop
Frequency  (Hz)
kp=20, ki=0
kp=5, ki=0
kp=5, ki=100
(a) Open loop gain.
−25
−20
−15
−10
−5
0
5
M
ag
ni
tu
de
 (d
B)
100 101 102 103 104
−135
−90
−45
0
45
Ph
as
e 
(de
g)
Closed loop
Frequency  (Hz)
kp=20, ki=0
kp=5, ki=0
kp=5, ki=100
(b) Closed loop gain.
Fig. 7. Frequency domain analysis of current control loop.
[4] Y. D. Lee, C. S. Chen, C. T. Hsu, and H. S. Cheng, “Harmonic
analysis for distribution system with dispersed generation systems,” in
International Conference on Power System Technology, 2006, pp. 1–6.
[5] V. Corasaniti, M. Barbieri, P. Arnera, and M. Valla, “Reactive and
harmonics compensation in a medium voltage distribution network
with active filters,” in IEEE/ISIE International Symposium on Industrial
Electronics, 2007, pp. 916–921.
[6] J. H. R. Enslin and P. J. M. Heskes, “Harmonic interaction between
a large number of distributed power inverters and the distribution
network,” IEEE Trans. Power Electron., vol. 19, no. 6, pp. 1586–1593,
Nov. 2004.
[7] IEEE Recommended practices and requirements for harmonic control
in electrical power systems, IEEE Std. 519-1992, 1993.
[8] H. Akagi, H. Fujita, and K. Wada, “A shunt active filter based on voltage
detection for harmonic termination of a radial power distribution line,”
IEEE Trans. Ind. Appl., pp. 638–645, May/Jun. 1999.
0
2
4
6
8
M
ag
ni
tu
de
 (a
bs
)
100 101 102 103 104
−180
−135
−90
−45
0
Ph
as
e 
(de
g)
Bode Diagram
Frequency  (Hz)
AFU OFF
AFU ON
Fig. 8. Harmonic voltage amplification.
[9] K. Wada, H. Fujita, and H. Akagi, “Considerations of a shunt active
filter based on voltage detection for installation on a long distribution
feeder,” IEEE Trans. Ind. Appl., pp. 1123–1130, Jul./Aug. 2002.
[10] P. Jintakosonwit, H. Fujita, H. Akagi, and S. Ogasawara, “Implementa-
tion and performance of cooperative control of shunt active filters for
harmonic damping throughout a power distribution system,” IEEE Trans.
Ind. Appl., vol. 39, no. 2, pp. 556–564, Mar./Apr. 2003.
[11] P.-T. Cheng and T.-L. Lee, “Distributed active filter systems (DAFSs):
A new approach to power system harmonics,” IEEE Trans. Ind. Appl.,
vol. 42, no. 5, pp. 1301–1309, Sept./Oct. 2006.
[12] T.-L. Lee, P.-T. Cheng, H. Akagi, and H. Fujita, “A dynamic tuning
method for distributed active filter systems,” IEEE Trans. Ind. Appl.,
vol. 44, no. 2, pp. 612–623, Mar./Apr. 2008.
[13] T.-L. Lee, J.-C. Li, and P.-T. Cheng, “Discrete frequency tuning active
filter for power system harmonics,” IEEE Trans. Power Electron.,
vol. 24, no. 5, pp. 1209–1217, May 2009.
[14] D. N. Zmood, D. G. Holmes, and G. H. Bode, “Frequency-domain
analysis of three-phase linear current regulators,” IEEE Trans. Ind. Appl.,
vol. 37, no. 2, pp. 601–610, Mar./Apr. 2001.
[15] M. Castilla, J. Miret, J. Matas, L. G. De Vicuna, and J. M. Guerrero,
“Linear current control scheme with series resonant harmonic com-
pensator for single-phase grid-connected photovoltaic inverters,” IEEE
Trans. Ind. Electron., vol. 55, no. 7, pp. 2724–2733, July 2008.
2275
The 2010 International Power Electronics Conference
2abc
to
dsqs
deqe
to
abc
Uabc
Uabc
iabc
iabc
iabc
Uabc
Usqd
isqd
C L
ω
ω
P
Q
P∗
Q∗
ie∗q
ie∗d
i∗abc v
∗
abc
VDC
PLL
PWM
PI
PI
K
HAFEC
Power
calculator
Utility
Fig. 3. The proposed hybrid active front-end converter and the associated control.
both real power and reactive power of the converter can be
simultaneously controlled without selecting operation mode.
Due to series-connected capacitor, the converter is operated
between a low-voltage dc side and high-voltage grid side with-
out any low-frequency transformer. Compared with previous
work, sensing inductor voltage E is no longer needed and thus
control algorithm can be much more simplified.
II. OPERATION PRINCIPLES
A simplified one-line diagram of the proposed hybrid ac-
tive front-end converter (HAFEC) is shown in Fig. 3. The
HAFEC is composed of a LC passive filter and a voltage
source converter in series connection to the grid U , in which
the coupling capacitor C is deployed to support a part of
fundamental voltage so that both real power and reactive power
can be controlled between the low-voltage dc side VDC and the
high-voltage ac side U without any low-frequency coupling
transformer. Converter control includes power calculation,
reference current determination, and current regulator. Detailed
operational principles are described as follows.
Calculation of both real power output P and reactive power
output Q of the converter are evaluated by using the so-called
instantaneous reactive power theory [5], as given:
�
P
Q
�
=
�
Usq Usd
−Usd Usq
�
·
�
isq
isd
�
(2)
where Usqd and isqd represent the output voltage and the output
current of the converter in the stationary frame, respectively.
Low-pass filters used for filtering out switching ripple in
calculating P , Q are not shown in the control diagram. Due to
series capacitor C, the reactive part of the inverter current is
related to real power output P , whereas reactive power output
Q is dependent on the real part. Based on the algorithm, the
current commands ie∗q , ie∗d of the converter in the synchronous
reference frame (SRF) can be evaluated according to real
power command P ∗ and reactive power command Q∗ by using
PI controllers. The PI regulator is defined as
TPI = kp +
ki
s (3)
where s is the Laplace operator, kp and ki are proportional
and integral gains, respectively. In the initial stage, kp is
selected according to the required response time and ki is to
provide zero steady-state error for the controlled variable. That
means the PI controller cannot cause stability issue because the
cutoff frequency of the PI controller is located at one decade
below system frequency. After transferring to the three-phase
system according to system angle measuring by Phase-lock
loop (PLL), the proportional current controller sequentially
generates the voltage command of the converter. Finally, the
space vector PWM is employed to synthesize the gating
signals of the converter. Therefore, the proposed HAFEC can
be controlled with the desired power flow requirement
The limitation of power delivery is dependent on the output
voltage of the converter and the coupling capacitor C. As
shown in (1), output power is proportional to the output
voltage, but inversely proportional to the reactance of C. Fig. 4
shows the relationship of power conversion for E to Xc.
Based on Fig. 4(a) and Fig. 4(b), the maximum dc voltage
and the series capacitor can be determined for the required
power output. Fig. 5(a) and Fig. 5(b) show power-flowing
examples between E and U for various conditions. Fig. 5(a)
illustrates maximum real power and maximum reactive power
are increased with |E| when Xc is fixed. The controllable
range of both real power and reactive power is also extended
3221
The 2010 International Power Electronics Conference
40.9 1 1.1 1.2
−200
−100
0
100
200
0.9 1 1.1 1.2
−100
−50
0
50
100
0.9 1 1.1 1.2
−20
−10
0
10
20
0.9 1 1.1 1.2
−2
−1
0
1
2
0.9 1 1.1 1.2
0
1
2
3
4
5
Time
U
E
I
P
Q
(a) Operation of real power control from −0.5 kW to 0.5 kW.
0.9 1 1.1 1.2
−200
−100
0
100
200
0.9 1 1.1 1.2
−100
−50
0
50
100
0.9 1 1.1 1.2
−20
−10
0
10
20
0.9 1 1.1 1.2
−2
−1
0
1
2
0.9 1 1.1 1.2
0
1
2
3
4
5
Time
U
E
I
P
Q
(b) Operation of real power control from 2.3 kVar to 3.3 kVar.
Fig. 7. Simulation results.
• PI controller for the real part of current command: kp=1,
ki=100.
• PI controller for the reactive part of current command:
kp=20, ki=500.
Fig. 8(a) shows power conversion for charging and discharging
modes, respectively. Charging operation mean the HAFEC
draw real power from the grid to charge the dc source, whereas
discharging mode denotes the power of the dc source is
delivered to the grid. Before t=1s, the converter is operated
at the charging mode with P ∗=-0.5 kW. Real power command
is then changed to P ∗=0.5 kW at t=1s. At this test, constant
Q∗=2.8 kVar is used. Reactive power control is given in
Fig. 8(b). As illustrated, the HAFEC is operated with step
change of Q∗ from 2.3 kVar to 3.3 kVar at t=1s, but with fixed
P ∗=-0.5 kW. Fig. 8 shows phasor diagram of U , E, I in both
operations as well as the associated rms values. Test results
shows both real power and reactive power can track command
well in the proposed HAFEC.
Re
Im
127 V � 0o
E=24 V� 98o
E=24 V� − 98o
I=7.8 A� − 100o
I=7.8 A� − 80o
(a) Blue vector(P ∗ = −0.5 kW); red vector(P ∗ = 0.5 kW).
Re
Im
127 V � 0o
E=32 V� 49oE=35 V� 138
o
I=6.4 A� − 102o
I=9.2 A� − 99o
(b) Blue vector(Q∗ = 2.3 kVar); red vector(Q∗ = 3.3 kVar).
Fig. 8. Phasor diagrams of U , E, I in Fig. 7
IV. EXPERIMENTAL RESULTS
The experimental setup is similar to the simulation circuit
in Fig. 6. The converter control is implemented by using TI
3223
The 2010 International Power Electronics Conference
Stability Analysis of Discrete-Time Systems with Time-Varying Delays via
Integral Quadratic Constraints
Chung-Yao Kao
Abstract— This manuscript presents certain l2-gain proper-
ties of and the integral quadratic constraint characterizations
derived from these properties for the discrete-time time-varying
operator. These IQC characterizations are crucial for the
IQC analysis to be applied to study robustness of discrete-
time systems in the presence of time-varying delays. One new
contribution of this manuscript is to utilize the information of
the variation of the delay parameter to derive less conservative
IQCs. The effectiveness of the proposed IQC analysis is verified
by numerical experiments, the results of which are compared
with those recently published in the literature.
I. INTRODUCTION
The content of this manuscript concerns robust stability
analysis of discrete-time systems with time-varying delays
in the following forms:
푥[푘 + 1] = 퐴푥[푘] +퐴푑푥[푘 − 휏 [푘]]
+ Δ(푥[푘], 푥[푘 − 휏 [푘]]) + 푒[푘] (1)
where 푛-dimensional signal 푥 is the signal of interest, 푒 is
a finite-energy disturbance, 퐴 and 퐴푑 ∈ ℝ푛×푛 are constant
matrices, and Δ(⋅, ⋅) is a causal and bounded operator on
the space of all finite-energy signals (the l2 space). The
delay sequence 휏 is an unknown function where only the
bounds on its value and/or variation are available to us. The
robust stability problem in question is to verify whether,
under any finite-energy disturbance input 푒, the energy of
signal 푥 remains finite for all admissible delay sequences
satisfying the given conditions.
Most existing results in the literature for time-varying
delay robustness were developed in time domain based on
the Lyapunov stability theorem – in which certain form
of Lyapunov-Krasovskii functional candidates are used to
derive stability conditions (see, for example, [1], [2], [3], [4],
[7], [9], [10], [11], [12]). The form of Lyapunov functions is
often tied to the formulation of systems under consideration.
As such, it is often non-trivial to generalize the result
for other systems with similar but slightly different forms
because the generalization involves modification of the form
of the Lyapunov function, which might not be easy to come
up with.
In contrast to the Lyapunov approach, in [6] and [5] we
proposed to tackle time-varying delay robustness problems
via a frequency-domain approach called Integral Quadratic
Constraint (IQC) analysis. The crucial step of applying the
Chung-Yao Kao is with the Department of Electrical Engineer-
ing, National Sun Yat-Sen University, Kaohsiung, Taiwan. E-mail:
cykao@mail.nsysu.edu.tw. His work is supported by the National Science
Council, Taiwan, under the grants NSC 98-2218-E-110-006 and NSC 98-
3114-E-110-004.
IQC analysis to analyze robust stability of time-varying
delay systems is to characterize the time-varying delay
operator in terms of integral quadratic constraints. With the
IQC characterization, stability conditions can be straightfor-
wardly obtained following the IQC stability theorem [8].
In [5] several IQCs were derived for discrete-time time-
varying delay operators. It is found that, in terms of energy
amplification, the discrete-time time-varying delay opera-
tor has some distinct features compared to its continuous-
time counterpart. In particular, for the discrete-time time-
varying operator, as long as the delay sequence is upper
bounded, the energy amplification ratio (i.e.; the l2-gain)
is always bounded regardless of the variation of the delay
sequence. This is distinctly different from its continuous-
time counterpart in that the ℒ2-gain depends only on the
variation of the delay parameter and the gain becomes
unbounded when the variation of the delay parameter exceeds
one. For the discrete-time case, it was unclear whether and
how the variation of the delay sequence affects the l2-gain
of the discrete-time time-varying delay operator, and how
to effectively utilize the information on the variation of
the delay sequence in robustness analysis of discrete-time
systems with time-varying delays. In this manuscript, we
continue our endeavor in [5]. We will focus on making the
link between the variation of the delay sequence and the
l2-gain of the time-varying delay operator, which hopefully
will lead to better IQC characterizations of the operator and
less conservative criteria for verifying varying-time-delay
robustness of discrete-time systems. Numerical experiments
will be conducted to verify the proposed stability criteria.
The remaining part of the manuscript evolves along the
following line. The next section introduces the main notation
and the IQC analysis applied to checking very-time-delay
robustness of linear time-invariant discrete-time systems.
Section III presents the IQCs for the time-varying delay
operator we so far discovered. Stability criteria resulting from
these IQC characterizations are presented in Section IV. The
results of the numerical experiments conducted to verify
the effectiveness of the proposed stability criteria are pre-
sented in Section V. Finally, we make a concluding remark
summarizing the current state of our work and what to be
investigated in the future.
II. NOTATIONS AND PRELIMINARIES
Symbol 퐼푛 is used to denote 푛-dimensional identity ma-
trix. The subscript 푛 is dropped when the dimension is
evident from the text. Given a matrix 푀 , the transposition
and the conjugate transposition are denoted by 푀 ′ and 푀∗,
Proceedings of the 19th International Symposium on Mathematical Theory of Networks and Systems – MTNS 2010 •  5–9 July, 2010 • Budapest, Hungary
ISBN 978-963-311-370-7 2309
Proposition 1. Consider the time-varying delay operator 풟휏
where the delay parameter 휏 could be any sequence from Υ1.
Then the following characterization holds for 풟휏 :
sup
휏∈Υ1
∥풟휏∥l2 =
√
ℎ. (5)
Furthermore, it can be shown that a unit impulse function
and the following delay sequence
휏 [푘] =
⎧⎨
⎩
풯푚 if 푘 < 풯푚
푘 if 풯푚 ≤ 푘 ≤ 풯푀
풯푀 if 푘 > 풯푀
(6)
realize the worst-case l2-gain.
Proposition 2. Consider the time-varying delay operator 풟휏
where the delay parameter 휏 could be any sequence from
Υ2, in which it is further assumed that 푑 < 푀 . Then the
following characterization holds for 풟휏 :
sup
휏∈Υ2
∥풟휏∥l2 =
√
푑+ 1. (7)
Furthermore, it can be shown that a unit impulse function
and the following delay sequence
휏 [푘] =
⎧⎨
⎩
풯푚 if 푘 < 풯푚
푘 if 풯푚 ≤ 푘 ≤ 풯푚 + 푑
풯푚 + 푑 if 푘 ≥ 푇푚 + 푑
(8)
realize the worst-case l2-gain.
Remark 1. Given any 푀 > 1, let us define the 푀 -step total
variation, and 푀 -step average variation of 휏 as
훿푀휏 [푘] :=
푀−1∑
푚=0
∣휏 [푘 + 1 +푚]− 휏 [푘 +푚]∣ ,
and
훿¯푀휏 [푘] :=
1
푀
푀−1∑
푚=0
∣휏 [푘 + 1 +푚]− 휏 [푘 +푚]∣ ,
Then Proposition 2 can be interpreted as follows: if one
may find a constant 푀 > 1 and establish that the 푀 -step
average variation of the delay sequence 훿¯푀휏 [푘] is strictly less
than one for all 푘, then the upper bound of the 푀 -step total
variation provides a tighter upper bound of the l2-gain of
the delay operator, assuming that the upper bound of the
푀 -step total variation 푑 is strictly less than 풯푀 − 풯푚 + 1.
For the upper bound 푑 of 훿푀휏 [푘] to be useful, it is crucial
that 푑 < 풯푀 −풯푚+1 and 훿¯푀휏 [푘] is strictly less than one for
all 푘. Also notice that the actual value of the upper bound
of 훿¯푀휏 [푘] does not offer useful information here. The only
crucial information is whether it is strictly less than one.
Proposition 3. Consider the time-varying “delay-difference”
operator 풮휏 where the delay parameter 휏 could be any
sequence from Υ1. Then the following characterization holds
for 풮휏 : for any l2 signal 푣,
∥풮휏푣∥2l2 ≤
∞∑
푘=−∞
풯∑
푖=1
(푣[푘]− 푣[푘 − 푖])2. (9)
Proposition 4. Consider the time-varying “delay-difference”
operator 풮휏 where the delay parameter 휏 could be any
sequence from Υ1. Then the following characterization holds
for 풮휏 : ∥∥∥∥풮휏 ∘ 푧푧 − 1
∥∥∥∥
l2
≤ 풯푀 , (10)
where 푧 represent the forward shifting operator and 푧
푧−1
the
discrete-time integrator.
Propositions 1 to 4 give rise to the following integral
quadratic constraints for 풟휏 and 풮휏 .
Proposition 5. Consider the time-varying delay operator 풟휏
where the delay parameter 휏 could be any sequence from
Υ1. Then the operator 풟휏 satisfies any integral quadratic
constraint defined by
Π1 =
[
ℎ푋1 0
0 −푋1
]
(11)
where 푋1 = 푋 ′1 ≥ 0 is any positive semi-definite matrix.
Proposition 6. Consider the time-varying delay operator
풟휏 where the delay parameter 휏 could be any sequence
from Υ2, in which 푑 < 푀 – in other words, the 푀 -step
average variation of 휏 is strictly less than one for all 푘. Then
the operator 풟휏 satisfies any integral quadratic constraint
defined by
Π2 =
[
(푑+ 1)푋2 0
0 −푋2
]
(12)
where 푋2 = 푋 ′2 ≥ 0 is any positive semi-definite matrix.
Proposition 7. Consider the time-varying “delay-difference”
operator 풮휏 where the delay parameter 휏 could be any se-
quence from Υ1. Then the operator 풮휏 satisfies any integral
quadratic constraint defined by
Π3 =
[∣휙(e푗휔)∣2푋3 0
0 −푋3
]
(13)
where 휙(푧) ∈ Rl∞ satisfies
∣휙(e푗휔)∣2 =
풯∑
휅=1
∣1− e−푗휅휔∣2 (14)
and 푋3 = 푋 ′3 ≥ 0 is any positive semi-definite matrix.
Proposition 8. Consider the time-varying “delay-difference”
operator 풮휏 where the delay parameter 휏 could be any se-
quence from Υ1. Then the operator 풮휏 satisfies any integral
quadratic constraint defined by
Π4 =
[풯 2푀 ∣휓(e푗휔)∣2푋4 0
0 −푋4
]
(15)
where 휓(푧) = 푧−1
푧
and 푋4 = 푋 ′4 ≥ 0 is any positive semi-
definite matrix.
Proceedings of the 19th International Symposium on Mathematical Theory of Networks and Systems – MTNS 2010 •  5–9 July, 2010 • Budapest, Hungary
2311
REFERENCES
[1] E. Fridman and U. Shaked. An improved stabilization method for
linear time-delay systems. IEEE Transactions on Automatic Control,
47(11):1931–1937, November 2002.
[2] E. Fridman and U. Shaked. Delay-dependent stability and 퐻∞ control:
Constant and time-varying delays. International Journal of Control,
76(1):48–60, 2003.
[3] H. Gao and T. Chen. New results on stability of discrete-time systems
with time-varying state delay. IEEE Transactions on Automatic
Control, 52(2):328–334, February 2007.
[4] H. Gao, J. Lam, C. Wang, and Y. Wang. Delay-dependent output-
feedback stabilization of discrete-time systems with time-varying state
delay. IEEE Proceedings – Control Theory Application, 151(6):691–
698, November 2004.
[5] C.-Y. Kao. On robustness of discrete-time LTI systems with varying
time delays. In Proceedings of IFAC 2008, 2008.
[6] C.-Y. Kao and A. Ranzter. Stability analysis with uncertain time-
varying delays. Automatica, 43(6):959–970, June 2007.
[7] V. L. Kharitonov and S.-I. Niculescu. On the stability of linear systems
with uncertain delay. IEEE Transactions on Automatic Control,
48(1):127–132, January 2003.
[8] A. Megretski and A. Rantzer. System analysis via Integral Quadratic
Constraints. IEEE Transactions on Automatic Control, 42(6):819–830,
June 1997.
[9] J.-P. Richard. Time-delay systems: an overview of some recent
advances and open problems. Automatica, 39(10):1667–1694, October
2003.
[10] S.-H. Song, J.-K. Kim, C.-H. Yim, and H.-C. Kim. ℋ∞ control
of discrete-time linear systems with time-varying delays in state.
Automatica, 35:1587–1591, 1999.
[11] V. Suplin, E. Fridman, and U. Shaked. 퐻∞ control of linear uncertain
time-delay systems - a projection approach. IEEE Transactions on
Automatic Control, 51(4):680–685, April 2006.
[12] M. Wu, Y. He, J.-H. She, and G.-P. Liu. Delay-dependent criteria
for robust stability of time-varying delay systems. Automatica,
40(8):1435–1439, August 2004.
Proceedings of the 19th International Symposium on Mathematical Theory of Networks and Systems – MTNS 2010 •  5–9 July, 2010 • Budapest, Hungary
2313
 2
rough estimates are used to derive a small set of plans for 
which simulations are necessary and worthwhile to find good 
enough solutions [10]. Descriptions of OO based technique 
and its applications in power system planning and controls can 
also be found in [9-11]. 
In this paper, a modified PSO method initialized by the 
OO technique is used to solve a feeder reconfiguration 
problem aiming at maximizing the DG penetration in the 
existing distribution network. 
II.  PROBLEM FORMULATION 
The feeder reconfiguration problem involving DG 
integration is formulated as a mixed discrete nonlinear 
optimization problem that takes distribution system security 
concerns into account. The objective function is to maximize 
the total DG capacity in the distribution network considered, 
i.e., 
∑
∈ NNi
DGi uSMax )(.  (1) 
Subject to network security constraints including 
T
Koutk
v NpSuS
ppk
∈∀≤∑
∈
max)(  (2) 
Lj
v
j NjSuS ∈≤
max)(  (3) 
Ni
v
i NiVuVV i ∈≤≤ ,)(
maxmin  
NDGi
v
DG NiSuS i ∈≤ ,)(
max  (4) 
)()( outputnoDGVoutputfullDGV vi
v
i −
  
N
v
i NioutputnoDGV ∈≤ ,%5)(/  (5) 
TSCpSCp NpIuI ∈≤ ,)(
max  (6) 
And the radial operation condition of the network 
In the above equations, DGiS  is the DG capacity integrated at 
node I and NN  is the set of all feeder nodes. u is the set of 
control variables including DG capacity, DG location and 
status of feeder switches. v represents system loading 
conditions including peak and off-peak loading 
conditions. outK  is the set of feeder nodes receiving power 
from certain transformer, vpkS  is the power flowing to feeder k 
from transformer p during v loading condition period. maxpS  is 
the rating of transformer p and TN  is the set of all substation 
transformers. vjS  is the loading of feeder j during v system 
loading condition, maxjS  is the rating of feeder j, and LN  is the 
set of all feeders. viV  is the node voltage during v system 
loading condition, miniV  and 
max
iV  are the voltage security 
limits. vDGiS  is the DG output during v system loading 
condition, and max
iDGS  is the capacity of DGi. SCpI  is the fault 
current at substation bus and maxSCpI  is the maximum 
interrupting current at bus connected to transformer p. 
III.  SOLUTION METHOD  
In the first iteration of the modified PSO solution 
procedure, instead of searching the best for sure, the OO based  
method aims to reduce the number of search samples in the 
solution space formed by all discrete variables, and seek 
candidates of good enough solutions in the set of, say top 
1~5%, best solutions for the original problem. 
The solution procedure adopted in this study is shown in 
Fig. 1. The first stage is based on the OO technique. Random 
numbers are used to generate a large set of candidate 
solutions, i.e., N sets of control variables u, each with different 
combination of tie switches. Four operation scenarios are 
studied by in each candidate solution, they are: 
1. Peak load without DG power output. 
2. Peak load with full DG power output 
3. Valley load without DG power output  
4. Valley load with DG power output 
Crude models are used to fast determine a subset of most 
promising solutions from the candidate solutions. Total 
penetration of DG is recorded when all security constraints are 
satisfied. The solutions are then ranked and Ordinal 
Performance Curve (OPC) is drawn to determine the size of a 
selected set (S) for further study where accurate models are 
used. 
In the second stage of the solution procedure, the initial 
particles of the PSO are those at the top of S that are studied 
by accurate models. OO based method is used to reduce the 
computational burden in the initial iteration of the modified 
PSO method and to start the following PSO search. A 
summary of the search procedure for obtaining a good enough 
solution with high probability can be described in the 
following: i) Use either a uniform selection or a heuristic 
method to select a representative set (N) for the search space. 
ii) Use an easily computed crude model to roughly evaluate 
and order the performance of each sample in N and collect the 
top s samples to form a selected subset (S), which is the 
estimated good enough subset. The OO theory would 
guarantee that S consists of actual good enough solutions with 
high probability. iii) Evaluate the objective value for each 
sample in S to obtain the good enough solution. 
OPC is used to exhibit the performance (fitness) 
distribution of candidate solutions. In [11] five broad 
categories of OPC models are described, they are i) lots of 
good samples, ii) lots of intermediate but few good and bad 
samples, iii) equally distributed good, bad, and intermediate 
samples, iv) lots of good and lots of bad samples but few 
intermediate ones, and v) lots of bad samples. A graphical 
expression for these five OPC models is shown in Fig. 2. A 
formula was derived in [11] to relate the size of the selected 
subset (S) to (a) the shape of the OPC, (b) the size of good 
enough subset G, (c) the alignment level k, (d) the alignment 
probability p, and (e) the error bound w between the 
performance value for the crude model and the exact model. 
The Appendix shows a formula to determine the size of S. 
 1797
 4
        ))()((*1*1 kxkprandNOc
old
idid −+  
        )))()((*2*2 kxkprandNOc
old
idgd −+  (10) 
Where Round() is the function to round up to integer. w is a 
inertia weighting which is updated by the following equation 
with maxw =0.9 and minw =0.4. maxk  is the specified maximum 
iteration number. 
k
k
wwwkw
max
minmax
max)(
−
−=  (11) 
Particle ix  is updated by the following equation: 
)1()()1( ++=+ kvkxkx newid
old
id
new
id   (12) 
After initialized by the OO technique, the best previous 
position (the position with the best fitness value) of the i-th 
particle is recorded and represented as ),...,,( 21 iDiii pppp = . In 
the following PSO iterations, if the evaluated fitness value 
(objective function) of a particle is better than the previous pi,  
pi is set to this value. pg is the maximum in all p’s , if the best p 
is better than pg,  pg is replaced by this value. If stop criterion 
is satisfied, pg  is the optimal solution, otherwise, the search is 
continued. 
III.  NUMERICAL RESULTS 
Fig. 4 shows a simplified medium voltage (11kV) 
distribution network of Taiwan Power Company [12]. Two 
substations supply the power to the customers from 83 
sections of 11 feeders that have 13 tie switches in between. 
The substation transformer and feeder current rating are 
1500Amp and 400Amp respectively. System short circuit 
capacity at the substation is 200MVA. DG has a sub-transient 
reactance of j0.1 p.u. and a unity power factor. The maximum 
DG capacity at each PCC is 12 MVA. The valley load is 50 % 
of the peak load and load patterns of the feeder sections are 
assumed coincident. Compensations for reactive power are 
shown in the one line to maintain acceptable voltage level 
during the peak load period. 
 
Fig. 4 Test system 
To demonstrate the effects of feeder reconfiguration on 
increasing DG penetration, three problems are formulated and 
solved by the proposed method. 
Test Case One 
In this case, without utilizing feeder reconfiguration, the 
aim is to find the maximum DG capacity at three specified 
locations that can be integrated to the existing network without 
violating network security constraints. There are three 
variables representing DG capacity involved in this test case. 
Test Case Two  
In this case, the feeder topology is restructured in order to 
accommodate higher capacity of DG. The locations for DG 
integration are the same as test case one. There are sixteen 
variables including three for DG capacity and thirteen for tie 
switch status involved in this case.  
Test Case Three 
Feeder reconfiguration is performed. Three best DG 
integration locations and their maximum capacity without 
violating any security constraints are determined. There are 
nineteen variables to be determined in this optimization 
problem. 
Test results of three solution methods are compared. They 
are the pure OO based method (method 1), the pure PSO 
based method (method 2) and the proposed method that uses 
OO technique for initializing PSO procedure (method 3). In 
method 1, N is set to 1000 and the representative set is chosen 
randomly. Fig. 5 show the OPC after the 1000 solution 
candidates are solved by crude models, and their fitness values 
(objective functions) are obtained and ranked. Fig. 5 indicates 
that it is a flat curve. The standard deviation of errors of crude 
model fitness value results as compared to those based exact 
load flow solutions is 0.163. Using the formula shown in the 
Appendix, the size of S (s) is 47.4. In the following 
presentation s is set to 50. According to the OO theory, the 
implication is that we will have 95% confidence that among 
the top solutions in the selected S from 1000 randomly chosen 
representative set, there exist at lease one good enough 
solution. 
0 100 200 300 400 500 600 700 800 900 1000
0
2
4
6
8
10
12
14
16
18
20
DG
 
ca
pa
ci
ty
 
(M
VA
)
 
Fig. 5 Ranked fitness values of objective function 
In methods 2 and 3, the particle size is set 50, and the 
maximum number of iterations (stopping criterion) is 100. 
Due to the stochastic characteristics of the PSO methods, 10 
runs are performed for each of the three test cases described 
above. The means and standard deviations of the results are 
presented.  
Table I shows a comparison of execution time of pure OO 
based method and one iteration of PSO method. In method 1, 
1000 candidates are solved by using crude models. It shows 
 1799
 6
DG sites n63, n12, n41 n63, n12, n41 n63, n12, n41 
Case3 Open 
branches 
positions 
84, 7, 61, 
70,13, 89, 
90,83,92, 
38, 45,41, 
86 
84, 85, 96, 
87,88, 89, 
90, 80,92, 
39, 33, 95, 
86 
84, 85, 96, 
69,88, 89, 
90, 91,92, 
38, 33, 95, 
86 
DG sites n12, n20, n78 n16, n67, n2 n12, n2, n79 
IV.  CONCLUSION 
In order to increase DG capacity in the existing network 
and reduce integration costs, a solution method for solving the 
feeder reconfiguration problem is proposed. Considering 
system operation constraints, the problem of maximizing DG 
penetration by feeder switching controls is formulated as a 
discrete nonlinear optimization problem. Simulation results 
have demonstrated that the proposed method has better 
performance in solving the problem than a pure PSO method. 
It is also shown in this study that DG with suitable output 
patterns would have positive effects on feeder voltage quality 
and a coordinated feeder reconfiguration could increase the 
allowable DG integrations in the existing distribution network. 
V.  APPENDIX 
Once the OPC pattern is identified, we may obtain the 
needed size, s, of the Selected Set {S} with a given alignment 
level, a, alignment probability, Pa, and the expected error 
bound, W, in the crude model. s is given as follows: 
η+= γρgkes z  (A1) 
where G is the size of the Good Enough set, z, ρ, γ and η are 
coefficients that can be found in [11] for different OPC 
patterns and error bounds, which can be obtained similarly to 
OPC through previous empirical studies over problems in the 
same field. 
VI.  ACKNOWLEDGMENT 
The authors would like to thank the financial support from 
National Science Council of Taiwan under Grants NSC 98-
3114-E-110-004. 
VII.  REFERENCES 
[1] S. Civanlar, J. J. Grainger, H. Yin and S.S.H. Lee, “Distribution feeder 
reconfiguration for loss reduction,” IEEE Trans. Power Delivery, Vol. 3 
(3), pp. 1217-1223, July 1988. 
[2] M. E. Baran and F.F. Wu, “Network reconfiguration in distribution 
systems for loss reduction and load balancing,” IEEE Trans. Power 
Delivery, Vol. 4 (2), pp. 1401 –1407, April 1989. 
[3] G. R. Darling, H.-D. Chiang and J.-C. Wang, “An efficient algorithm for 
real-time network reconfiguration in large scale unbalanced distribution 
systems,” IEEE Trans. Power Systems, Vol. 11 (1), pp. 511 -517, Feb. 
1996. 
[4] C. C. Liu, S. J. Lee, and S. S. Venkata, “Loss minimization for 
distribution feeders: optimality and algorithms,” IEEE Trans. Power 
Delivery, Vol. PWRD-3, pp. 1281-1289, 1989. 
[5] R. E. Brown, “Distribution reliability assessment and reconfiguration 
optimization,” Proceedings of Transmission and Distribution 
Conference and Exposition, vol. 2, 2001 pp.994 - 999. 
[6] S. A. Yin and C. N. Lu, "Distribution feeder scheduling considering 
variable load profile and outage costs," IEEE Trans. Power Systems, 
Vol. 24, No. 2, pp. 652-660, May 2009. 
[7] J. Olamaei, T. Niknam and G. Gharehpetian, “Impact of distributed 
generators on distribution feeder reconfiguration,” Proceedings of IEEE 
Lausanne Power Tech, 2007. 
[8] F. Li, “Application of ordinal optimization for distribution system 
reconfiguration,” Proceedings of Power Systems Conference and 
Exposition, IEEE/PES, 2009. 
[9] S. Y. Lin, Y. C. Ho, C. H. Lin, “An ordinal optimization theory-based 
algorithm for solving the optimal power flow problem with discrete 
control variables,” IEEE Trans. Power Syst., Vol. 19, No. 1, Feb. 2004, 
pp. 276-286. 
[10] M. Xie, J. Zhong, F. F. Wu, “Multiyear transmission expansion planning 
using ordinal optimization,”  IEEE Trans. Power Syst., Vol. 22, No. 4, 
Nov. 2007, pp. 1420-1428. 
[11] T. W. Edward Lau, Y. C. Ho, “Universal Alignment Probabilities and 
Subset Selection for Ordinal Optimization,” Journal of Optimization 
Theory and Applications, vol. 93, No. 3, pp. 445-489, June 1997. 
[12] J.P. Chiou, C.F. Chang, C.T. Su,” Variable scaling hybrid differential 
evolution for solving network reconfiguration of distribution systems,” 
IEEE Trans. on Power Systems, vol. 20, no. 2, pp. 668-674, 2005. 
VIII.  BIOGRAPHIES 
Rung-Fang Chang received the B.S. degree in electrical engineering from the 
Chung Yuan Christian University, Chung-Li, Taiwan, in 1990 and the M.S. 
and Ph.D. degrees from the National Sun Yat-Sen University, Kaohsiung, 
Taiwan, in 1992 and 2002, respectively. Currently, he is an Associate 
Professor of the Department of the Electrical Engineering, Kao Yuan 
University, Kaohsiung, Taiwan. His research interests are optimization of 
power system and load research. 
 
Shi-Jaw Chen received the M.S. and Ph.D degrees from the National Sun 
Yat-Sen University, Kaohsiung, Taiwan, in 1993 and 2001, respectively. 
Currently, he is an Associate Professor with the Department of Electrical 
Engineering, Kao Yuan University, Kaohsiung. His research interests include 
distribution system state estimation, renewable energy and power system 
operations. 
 
Ya-Chin Chang received his Ph.D. degree from National Sun Yat-Sen 
University in 2002. He is an associate professor with the Department of 
Electrical Engineering, Cheng Shiu University, Taiwan. His current research 
interests are on power system operation, economics, and estimating wind 
power penetration level and applications of FACTS devices to static stability 
enhancement for power systems. 
 
Chan-Nan Lu (SM’99--F’08) has been with the Department of Electrical 
Engineering, National Sun Yat-sen University, Taiwan, since 1989. His main 
areas of interest are computer applications to power systems, distribution 
automations, and power quality. 
 1801
 2
distribution management functions. 
The effectiveness of the entire DMS relies on the data 
accuracy provided by LM/LE. Dynamic LM/LE uses all the 
available information from the distribution network, including 
transformer capacities and customer monthly billings, if 
available, combined with the real-time measurements along the 
feeders, to accurately estimate the distribution network loading 
for both individual loads and aggregated bulk loads. One 
application, for example, is the optimal network 
reconfiguration function that recommends switching 
operations to reconfigure the distribution network to minimize 
network energy losses, maintain optimum voltage profiles, and 
to balance the loading conditions among the substation 
transformers, the distribution feeders, and the network phases. 
It can also be utilized to develop outage plans for maintenance 
or service expansion fieldwork [12, 13]. 
To support above mentioned applications, a feeder section 
and bus load estimation approach is proposed in this paper. 
The proposed technique is similar to that proposed in [1] and 
[9] that makes use of AM data from DA and AMI to adjust 
priori bus load data derived from historical data and match 
calculated and measured data values closely.. 
II.  THE PROPOSED MEASUREMENT MATCHING TECHNIQUE 
Since there are not enough real-time data to derive a 
complete real-time network model, in the proposed method, 
according to the locations of SCADA and AMI meters in the 
feeders, a distribution feeder away from the substation is 
divided into several smaller zones, as shown in Figure 1. AMI 
measurements could be the actual meter measurements at the 
distribution transformers or an equivalent summation of AMI 
measured customer loads supplied from the distribution 
transformers. For each feeder zone, it is desired to have at least 
two measurements at the terminals of the zone. A distribution 
state estimation [10] could then be used first to check the 
consistency of the actual measurements in the feeders in order 
to remove the bad data if there is any. In this paper, it is 
assumed that the actual measurements used for feeder bus load 
estimations are accurate. 
A continuous three-phase load flow based method with 
nodal load scaling and BFS procedure is described in the 
followings. The objective of the technique is to adjust original 
load values of PM by using all available measurements in the 
feeder zone. Except for system states and final load scaling 
values of PM, the technique assures that load flow results 
match the AM closely. After BFS procedure, whenever a 
voltage magnitude measurement node is reached, it will be 
replaced with the equivalent voltage measurement. 
 
QPIV ,,,
 Fig. 1. A simple feeder with various types of measurement in each zone 
 
In the study, it is assumed that AM have 100% accuracy, 
residuals (adjustment) will only appear in the PM. If 
adjustment of bus injection is still required, the mismatch is 
distributed to load buses using appropriate scaling factors at 
each iteration. The power balance equality constraints are 
satisfied after the mismatch approaches to zero with iterations. 
For each zone, the power mismatch equations at each iteration 
are described by the set of equations 
loss
i
pmdiammis PPPP −−=∆ ∑ )( ,                                               (1) 
loss
i
pmdiammis QQQQ −−=∆ ∑ )( ,                                               (2) 
where misP∆ and misQ∆  are the real and reactive power 
mismatch, respectively. lossP and lossQ  are the real power and 
reactive power line loss, respectively. pmdiP , and pmdiQ , are the 
real and reactive load of PM. At each bus scaling factors of 
PM at each iteration can be written as 
∑
=
i
pmdi
pmdi
pmdi
P
P
,
,
,α                                                              (3) 
∑
=
i
pmdi
pmdi
pmdi
Q
Q
,
,
,β                                                              (4) 
where pmdi,α and pmdi ,β  are the real and reactive power scaling 
factor for each PM, respectively. For buses with AMI-meter 
installed, their scaling factors will be zero. By multiplying 
scaling factors with power mismatch, the adjustment for load 
value of PM can be obtained easily. Therefore, adjusted real 
power can be written as )( ,, mispmdipmdi PP ∆×+α and reactive 
power load values can be written as )( ,, mispmdipmdi QQ ∆×+ β . 
The solution steps are as follows: 
Step1: Initialize three-phase distribution network parameter, 
actual measurements ( ),,,,, amkamkamk VQP and pseudo 
measurements (priori nodal load forecast) 
Step 2: Calculate line loss )( , LossLoss QP  
Step3: Calculate power mismatch )( , mismis QP ∆∆ with equations 
(1) and (2)
  
 
 1767
 4
III.  NUMERICAL RESULTS  
In order to give a clear description of the proposed concept, 
a simple feeder shown in Figure 4 is used in this section, and 
simulation results of two simplified test cases are presented. 
Case 1:Use DA power injection measurement and AMI 
metering data for load adjustment 
DA Power measurements )( ,1,,1 amam QP  are located at feeder 
head and AMI load data )( ,5,,5 amam QP and voltage 
measurement amV ,5  are at bus 5. In addition, it is assumed that 
voltage phasors of the reference bus is ),,( 111
cba VVV  
)1201,1201,01( °°° ∠−∠∠= . The convergence tolerance ε for 
power mismatch is 610− . After the calculations, not only 
feeder bus loads are rescaled to match three-phase power 
injection measurements ( =amP ,1 pu)0183.4,1421.4,7582.3( , 
))8073.0,8664.0,8257.0(,1 puQ am = and AMI load data 
( puP am )1.05 0.94,1.04,(,5 = , puQ am )0.17 0.19,0.18,(,5 = ),voltage 
value of bus 5 also matches that of voltage magnitude 
measurement( puV am )955.0,955.0,955.0(,5 = ). As shown in 
Figures 5-7, it shows the adjustments of real power and 
reactive power load scalings for three phases. Figure 8 (a) and 
(b) show the changes in real power and reactive power 
mismatch with iterations. Figure 9 shows the changes in 
voltage magnitude at each bus. It takes about 2-3 iterations to 
obtain a reasonable solution with much of the adjustment 
occurring at the first iteration. Table I shows the final load 
estimations. The total three-phase line losses for this case 
is + 0.1393 j0.0469, + 0.1442 0.0419, j+ 0.1329(=+ lossloss jQP
.)0.0502 j pu
 
amam QP ,1,1 ,
amamam VQP ,5,5,5 ,,
 
Fig. 4. Simple test feeder zone(for Case 1) 
 
1 2 3 4 5
0.7
0.8
0.9
1
1.1
1.2
1.3
Iteration 
R
ea
l 
p
o
w
e
r 
lo
a
d
(p
u
)-
p
h
a
s
e
 A
 
 
 
bus 2
bus 3
bus 4
bus 5
 
Fig. 5(a). Changes of real power load scaling with iterations (Phase A) 
 
1 2 3 4 5
0.1
0.12
0.14
0.16
0.18
0.2
0.22
0.24
0.26
Iteration 
R
e
a
c
ti
v
e
 p
o
w
e
r 
lo
a
d
(p
u
)-
p
h
a
s
e
 A
 
 
 
bus 2
bus 3
bus 4
bus 5
 
Fig. 5(b). Changes of reactive power load scaling with iterations (Phase A) 
1 2 3 4 5
0.75
0.8
0.85
0.9
0.95
1
1.05
1.1
1.15
1.2
1.25
Iteration 
R
e
a
l 
p
o
w
e
r 
lo
a
d
(p
u
)-
p
h
a
s
e
 B
 
 
 
bus 2
bus 3
bus 4
bus 5
 
Fig. 6(a). Changes of real power load scaling with iterations (Phase B) 
1 2 3 4 5
0.1
0.12
0.14
0.16
0.18
0.2
0.22
0.24
0.26
0.28
0.3
Iteration 
R
e
a
c
ti
v
e
 p
o
w
e
r 
lo
a
d
(p
u
)-
p
h
a
s
e
 B
 
 
 
bus 2
bus 3
bus 4
bus 5
 
Fig. 6(b). Changes of reactive power load scaling with iterations (Phase B) 
1 2 3 4 5
0.75
0.8
0.85
0.9
0.95
1
1.05
1.1
1.15
Iteration 
R
e
a
l 
p
o
w
e
r 
lo
a
d
(p
u
)-
p
h
a
s
e
 C
 
 
 
bus 2
bus 3
bus 4
bus 5
 
Fig. 7(a). Changes of real power load scaling with iterations (Phase C) 
 1769
 6
1 2 3 4 5
0.95
0.955
0.96
0.965
0.97
0.975
0.98
0.985
0.99
0.995
1
Bus 
V
o
lt
a
g
e
 m
a
g
n
it
u
d
e
(p
u
) 
 
 
phase A
phase B
phase C
 
Fig. 12. Voltage magnitude along the feeder 
TABLE II 
 FINAL LOAD ESTIMATIONS(PU) 
 
 Phase -A Phase -B Phase -C 
bus 2 0.7947+j0.3055 0.9484+j0.3437 0.8456+j0.3722 
bus 3 1.0968+j0.2302 1.1060+j0.2723 0.9640+j0.2147 
bus 4 0.7428+j0.1826 0.8297+j0.2016 0.9683+j0.1859 
bus 5 0.9402+j0.3127 1.0362+ j0.3238 1.0329+j0.3003 
IV.  CONCLUSION 
Feeder section and bus load estimations are useful for 
efficient distribution system operations. They can also be used 
to detect nontechnical power loss in the distribution network 
and perform effective service restoration after network outages. 
This paper proposes a new feeder bus load estimation 
approach and the test results obtained from simplified feeders 
confirm that the proposed technique can utilize different types 
of measurements from the field in conjunction with pseudo 
measurements derived from historical data to perform quasi 
real time feeder bus load estimations. 
ACKNOWLEDGMENT 
The authors greatly acknowledge the financial supports 
from National Science Council of Taiwan under Grants NSC 
98-3114-E-110-004. This study is also conducted under the 
“Applications of wide area sensing network and IT technology 
in AMI project” of the Institute for Information Industry which 
is subsidized by the Ministry of Economy Affairs of the 
Republic of China. 
 
RERERENCES 
 
[1] D. Shirmohammadi, W.-H. E. Liu, K. C. Lau and H. W. Hong, 
“Distribution automation system with real-time analysis tools,” IEEE 
Computer Applications in Power, Vol. 9, No. 2, April 1996, pp. 31-35. 
[2] I. Roytelman and V. Landenberger, “Real-time distribution system 
analysis – integral part of DMS,” Proceedings of IEEE PSCE, March 
2009, Seattle, USA. 
[3] J. Wan and K. N. Miu, “Weighted least squares methods for load 
estimation in distribution networks,” IEEE Trans. on Power Systems, Vol. 
18, No. 4, Nov. 2003, pp.1338-1345. 
[4] E. Manitsas, R. Singh, B. Pal and G. Strbac, “Modelling of pseudo 
measurements for distribution system state estimation,” Proceedings of 
CIRED Seminar 2008: SmartGrids for Distribution, Paper 0018, 
Frankfurt, 23-24 June 2009. [3] A. K. Ghosh,  
[5] D. L. Lukeman and R. H. Jones, “Load modeling for distribution circuit 
state estimation,” IEEE trans. on Power Delivery, Vol. 12, April, 1996, 
pp 999-1005. 
[6] M. E. Baran and A. W. Kelley, “state estimation for real-time monitoring 
of distribution systems,” IEEE Trans. on Power Systems, Vol. 9, No. 3, 
May 1994, pp. 1601-1609. 
[7] M. E. Baran and A. W. Kelley, “A branch-current-based state estimation 
method for distribution systems,” IEEE Trans. on Power Systems, Vol. 1, 
No. 1, Feb. 1995, pp. 483-491. 
[8] C. S. Cheng, and D. Shirmohammadi, “A three-phase power flow method 
for real-time distribution system analysis,” IEEE Trans. on Power 
Systems, Vol. 10, No. 2 May 1995, pp. 671-679. 
[9] M. K. Celik and W.-H. Edwin Liu, “A practical distribution state 
calculation algorithm,” Proceedings of 1999 IEEE PES Winter Meeting, 
Vol. 1, pp. 442-447. 
[10]C. N. Lu, J. H. Teng and W.-H. E. Liu, “Distribution state estimation,” 
IEEE Trans. on Power Systems, Vol. 10, No. 1, Feb. 1995, pp. 229-240. 
[11] M. M. Nordman and M. Lehtonen, “Distributed agent-based state 
estimation for electrical distribution networks,” IEEE Trans. on Power 
Systems, Vol. 20, No. 2, May 2005, pp. 652-658. 
[12]I. Roytelman, “Real-time distribution power flow – lessons from practical 
implementations,” Proceedings of 2006 IEEE PSCE, Oct. 2006, pp. 
505 – 509 
[13] I. Roytelman and V. Ganesan, “Coordinated local and centralized control 
in distribution management systems,” IEEE Trans. on Power Delivery, 
Vol. 15, No. 2, April 2000, pp. 718-724. 
 
BIOGRAPHIES 
Shi-Jaw Chen received the M.S. and Ph.D degrees from the National Sun 
Yat-sen University, Kaohsiung, Taiwan, in 1993 and 2001, respectively. 
Currently, he is an Associate Professor with the Department of Electrical 
Engineering, Kao Yuan University, Kaohsiung. His research interests include 
distribution system state estimation, renewable energy and power system 
operations. 
 
Rung-Fang Chang received the B.S. degree in electrical engineering from 
the Chung Yuan Christian University, Chung-Li, Taiwan, in 1990 and the 
M.S. and Ph.D. degrees from the National Sun Yat-sen University, Kaohsiung, 
Taiwan, in 1992 and 2002, respectively. Currently, he is an Associate 
Professor of the Department of the Electrical Engineering, Kao Yuan 
University, Kaohsiung, Taiwan. His research interests are optimization of 
power system and load research. 
 
Huang-Ren Lai received Ph. D. degree from Tamkang University, Taiwan. 
He is the deputy director of Network and Multimedia Institute of the Institute 
for Information Industry, Taiwan. 
 
Chan-0an Lu (SM’99–F’08) has been with the Department of Electrical 
Engineering, National Sun Yat-sen University, Taiwan, since 1989. His main 
areas of interest are computer applications to power systems, distribution 
automations, and power quality. 
 
 1771
98年度專題研究計畫研究成果彙整表 
計畫主持人：盧展南 計畫編號：98-3114-E-110-004- 
計畫名稱：用戶端主動參與之線路均載及瓶頸舒緩策略研究 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100% 3 個子計畫共同成果 
研究報告/技術報告 1 1 100% 3 個子計畫共同成果 
研討會論文 10 10 100% 
篇 
3 個子計畫共同成
果 
論文著作 
專書 0 0 100%   
申請中件數 3 3 100% 3 個子計畫共同成果 專利 
已獲得件數 0 0 100% 
件 
 
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 21 21 100%  
博士生 1 1 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 4 4 100% 3 個子計畫共同成果 
研究報告/技術報告 0 0 100%  
研討會論文 9 9 100% 
篇 
3 個子計畫共同成
果 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
 
