2 
 
部份，也有事實的陳述，因此假設我們要針對某一主題進行網友意見的摘要分析，這些輸入的
文件顯然要有進一層過濾。TREC(Text REtrieval Conference)會議從 2006 年開始的新主題“部
落格意見檢索競賽”(opinion retrieval task)，其目的即是模擬一個使用者在部落格(blogosphere) 
搜尋公眾意見的需求，找出與主題相關且包含意見的文件。這個競賽同時也是 2007 會議中吸
引最多人參與的一項競賽。 
TREC 的 opinion retrieval task 雖然不強調檢索到的意見的傾向(polarity)，但是對於使用
者來說，如果系統能將檢索到的資料依正、反傾向分類，自然在使用上更為方便。在本計畫中
我們提出利用意見擷取來分析部落格文件，提供使用者對於查詢主題，提供正反意見的分析。
我們的目標是建立一個可以接受不同主題的查詢，並依照使用者等待時間的長短提供不同深度
的意見摘要，並呈現不同族群對這個查詢主題所持立場的比例，提供使用者針對公共政策、社
會議題、及產品使用等，快速得到公眾的意見調查結果。 
三、 文獻探討 3.1. 網頁主文擷取	  
雖然部落格搜尋引擎是根據各個RSS Feed建立起的索引，但由於要提供使用者閱讀，所提供
的搜尋結果顯示的資料來源是原本部落格網頁。要從原始網頁中取得部落格的主文，是系統第
一個要解決的問題。Song 等人[10]以Vision-based page segmentation (VIPS)將網頁分成許多區
塊，配合機器學習演算法結合空間特徵以及內容特徵，學習網頁區塊模型。Cao等人則以兩個
步驟取出部落格主文[1]，首先採用視覺化的資訊(每一個部落網頁的寬度以及每一個區塊的字
數)，將網頁切割成不同的區塊，並且根據文字資訊量決定何者為主區塊，主區塊包含主文以
及評論。接著使用資訊分割點區分主區塊中主文以及評論，其準確率可以達到91%。	  3.2. 意見檢索	  
意見檢索是如何從收集回來大量文件，找出包含使用者主觀意見的文字部分；文字部分可
以是一句話、一個段落或者一個區塊[13][6][7]。過去幾年已有數項研究是關於意見檢索，探討
的主題包含商品、影視育樂、政策、體育、部落格…等等各個不同領域[6][11][4][13][8][9]。 
Zhang等人提出的資訊檢索方法分成三個步驟[13]。首先以傳統的資訊檢索元件，從蒐集的
4 
 
以DIV標籤為單位，切成數個區塊，每一個區塊至少包含三層DIV1。我們將包含完整主文的區
塊標記為Y，其餘皆標記為N。從而訓練一個分類器做為部落格主文擷取的依據。 我們以人工
觀察部落格網頁並且參考Song等人的提出的特徵[10]，挑選21個特徵，如圖1所示。 
 
圖1. 部落格主文擷取分類特徵  4.1.1. 部落格與非部落格分類器	  
由於搜尋引擎回傳的網頁不一定屬於部落格，此情況間接影響擷取部落格主文的效果。實
驗的資料集中，非部落格網頁約45%，網頁可能包含了論壇、新聞以及商品網站…等等，這麼
多非部落格的網頁，影響擷取主文實驗的效果，因此我們以機器學習的方式，建立部落格與非
部落格分類器。 
我們以人工觀察從11個主題隨機挑選的275個部落格網頁並且參考Cao等人提出的特稱[1]
選擇12個特徵，如圖2所示。部落格特徵可分成兩個部分，HTML網頁內容以及網域名稱，每
一個特徵值皆由HTML標籤中的id、name、class或者href判斷；前十項特徵是觀察HTML的原
始程式碼，從HMTL標籤中找到blog、comment、post、post-content、post by以及archive...等字
                                                 
1 用以增加區塊中包含主文的Positive標籤，以減少Negative區塊數量。 
6 
 
4.2. 意見擷取及檢索	  4.1.3. 查詢字擴充	  
較早的研究[2]僅從主題字計算每一篇部落格網頁與主題相關程度，過濾相關程度較低的
網頁，在本研究除了以主題字之外，尚有維基百科主題字擴充的部分，根據使用者輸入不同的
主題，以簡單的方式產生不同的組合字，並且透過維基百科查詢主題和其組合字，產生的過程
中過濾主題中的贅字，減少不必要的查詢，降低網頁傳遞的處理時間。 
根據不同的查詢，維基百科所回傳關於主題的內容，如果資訊量足夠會以一個表格呈現每
一個段落的標題，這些標題就是主題的擴充字。如果維基百科回傳的網頁沒有這個表格，系統
則認為回傳的資訊並不足夠且不予以擴充。 4.2.2. 過濾不相關部落格網頁	  
當使用者查詢一個主題後，期望所找到的網頁具有高度相關，然而搜尋引擎回傳的網頁不
一定與查詢有關或者相關程度不高，還需要花費時間檢閱網頁，為了解決這個問題，我們計算
網頁與主題相關程度的方法[2]，如公式(1)所示。 
 
 
公式(1)計算在每一個段落是否有出現主題字並除上段落各數作為Topic Word Density，此
方式有一缺點，如果部落客在撰寫文章時以其他與主題有關的字詞替代主題字時，部落格文章
被過濾的可能性會提高。因此，我們增加考慮擴充字，如公式(2)所示，根據文章中每一個段
落出現查詢以及主題字擴充的次數，計算每一篇文章的Topic Word Density，若是低於設定的
門檻值，則從文件集內移除。 4.2.3. 意見擷取	  
我們採用LODR來判斷一個字與主題的相關程度[2]，odd ratio用來比較兩個集合發生同一
件事t的機率差異，如果odd ratio等於一，表示兩個集合會發生t的機率相同，若大於一，表示事
8 
 
5.1. 部落格內文擷取實驗	  
由於篇幅的限制，我們僅呈現主要成果，相關數據請參考已發表之論文。有關部落格主
文的擷取，我們分別以人工標記及自動標記兩種方式訓練所得的模型，以相同測試資料比較擷
取的效果。實驗結果顯示經過非部落格網頁過濾以及減少取樣的人工標記訓練資料所得的模型
效果最佳，另外，透過自動標記可以達到與人工標記近似的效果，且能夠更快地標記大量的訓
練資料，減少標記時間。 
 
圖4.	   部落格內文擷取實驗比較  	  5.2. 過濾與主題無關部落格網頁	  
我們從透過Google Blog Search限定網域蒐集十個主題部落格網頁(包含電影、運動、政治
等不同領域)且每一個主題隨機挑選40篇網頁，透過正規表示式擷取內文後，以人工方式標記
答案，分別比較[2]以及4.2.1節以維基百科增加擴充字兩種方法的效果。 
實驗結果顯示增加擴充字對於過濾與主題不相關的部落格效果有很大的提升，如表7所示，
[2]計算每一個段落是否出現主題字，這種方式準確率相當高，但是召回率卻是非常低，因為
內文每一個段落不見得都包含主題字，反而以同義字代替，所以大多數的內文都被判定與主題
不相關。我們以[2]為基礎且以維基百科擴充與主題有關的字，這種方式將原本較低的召回率
提升至91.9%，F-Measure也由原本15.6%提高至85.9%。 
表1.	 增加與主題有關的字能夠使得系統更有效地找到與主題相關部落格內文  
Method Precision Recall F-Measure 
Topic 0.938 0.085 0.156 
Topic & Expansion words 0.806 0.919 0.859 5.3. 結論	  
10 
 
搜尋引擎有別傳統搜尋引擎最重要的特色。 
本篇研究是以部落格為主的意見搜尋引擎，讓使用者只需要輸入關鍵字，可以快速地顯示
意見，不會感覺到多餘的等待時間，並且透過週期性地更新，使用者可以快速掌握最新意見。
我們的貢獻在於過濾現有部落格搜尋引擎回傳非部落格網頁以及擷取不同部落格部茖格主文，
並且透過維基百科增加主題擴充字，改善[2]過濾不相關部落格網頁的效果。 
參考文獻 
[1] D. Cao and X. Liao and S. Bai. Blog Post and Comment Extraction Using Information Quantity 
of Web Format. AIRS 2008, pp. 298-309. 
[2] C. H. Chang and K. C. Tsai. Aspect Summarization from Blogsphere for Social Study. ICDMW 
2007, pp. 9-14. 
[3] E. Elgersma and M. de Rijke. Learning to Recognize Blogs: A Preliminary Exploration. ECAL 
2006. 
[4] T. K. Fan and C. H. Chang. Sentiment-Oriented Contextual Advertising. ECIR 2009, Vol. 5478, 
pp. 202-215. 
[5] A. Harb, M. Plantiè, and G. Dray. Web Opinion Mining: How to extract opinions from blogs? 
CSTST 2008, pp. 211-217. 
[6] M. Jiang and S. Argamon. Exploiting subjectivity analysis in blogs to improve political leaning 
categorization. SIGIR 2008, pp. 725-726. 
[7] B. Liu, M. Hu, and J. Cheng. Opinion Observer: Analyzing and Comparing Opinions on the 
web. WWW 2005, pp. 342-351. 
[8] Y. Lu and C. Zhai. Opinion integration through semi-supervised topic modeling. WWW 2008, 
pp. 121-130. 
[9] B. Pang, L. Lee, and S. Vaithyanathan. Thumbs up? Sentiment Classification using Machine 
Learning Techniques. EMNLP 2002, pp. 79-86. 
[10] R. Song, H. Liu, Ji-Rong Wen, and Wei-Ying Ma. Learning Important Models for Web Page 
國科會補助專題研究計畫項下出席國際學術會
議心得報告 
                                     
日期： 99  年 9  月  30 日 
                                 
一、目的 
第九屆Web Intelligence 與 Intelligence Agent Technology	 會議在2010年8
／31至9／3於加拿大多倫多約克大學舉行。本會議為IEEE、ACM、WIC三個學
會共同支持的重要會議。其目的是提升Web智慧資訊系統等研究。WI已舉辦過8
屆的國際會議，每年皆超過30個國家的國際專家學者參加，已成為網際網路資
訊技術重要研討會之一。 
本次所發表的論文題目MapMarker: Extraction of Postal Addresses And 
Associated Information for General Web Pages，處理的是有關於地址擷取的研
究；利用結構式及非結構式兩種機器學習技術從訓練資料中學習辨識地址的模
型。同時針對多個地址網頁中所擷取的地址再進一步擷取其相關的資訊，讓資
料庫的資訊更為完整。本論文所提出的地址及相關資訊擷取不僅可以是一個
Web服務，同時也可以做為Location-Based等手機服務的資料庫。藉由參加本次
的研討會，得以將我們的研究正式公佈，同時也可與各國學者學習在Web資訊
檢索和文字探勘上的寶貴經驗。	 
二、過程 
今年度一共邀請了五位Keynote	 Speakers，其中有三位是有關Web	 Intelligence
計畫編號 NSC 98－2213－ E － 008 －089－ 
計畫名稱 部落格意見檢索及摘要之研究 
出國人員
姓名 
張嘉惠 
服務機構
及職稱 
中央大學副教授 
會議時間 
     99 年 8月 30日  
至 99 年 9月  5日 
會議地點 
 
加拿大多倫多 
會議名稱 
(中文)  
(英文) 2010 IEEE / WIC / ACM International Conferences on Web 
Intelligence 
發表論文
題目 
(中文) 
(英文)  MapMarker: Extraction of Postal Addresses And 
Associated Information for General Web Pages 
國科會補助計畫衍生研發成果推廣資料表
日期:2011/02/02
國科會補助計畫
計畫名稱: 部落格意見檢索及摘要之研究
計畫主持人: 張嘉惠
計畫編號: 98-2221-E-008-089- 學門領域: WEB 技術
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
主辦 2010 人工智慧論壇, 邀請南加大 Craig Knoblock 及香港科技大學 Qiang 
Yang 教授來台訪問. 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
