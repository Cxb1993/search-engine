 2
行政院國家科學委員會 
專題研究計畫成果報告 
自動產生3D多人虛擬環境中擬真之虛擬角色行為 
Automatic Generation of Realistic Behaviors  
for Virtual Characters in 3D Multi-user Virtual Environments 
計畫編號：97-2221-E-004-010 
報告期限：97年8月1日至98年7月31日 
主持人：李蔡彥  Email: li@nccu.edu.tw 
執行機構及單位名稱：國立政治大學資訊科學系 
 
 
中英文摘要 
（一）、中文摘要 
目前3D虛擬環境（如Second Life及3D連線遊戲）
中虛擬替身的行為，多由真實使用者根據系統所
提供的有限功能進行控制。如能在虛擬環境中，
產生由電腦控制的虛擬角色，不但可增加環境的
豐富性，更可做為虛擬社會中社會現象的實驗平
台。然而，目前的虛擬環境系統多無法提供此類
擬真行為的自動產生機制。我們提議以兩年的時
間，針對虛擬環境中動畫角色行為的擬真性，根
據幾何、機構、動力、規劃、情緒、及社會等層
面設計適當的動畫程序及行為模型，並在現有的
虛擬環境系統中，進行虛擬殖民及社會集體行為
的模擬實驗。在過去一年（第一年）的研究中，
我們的研究目標在提高個別虛擬角色在動畫上
的真實性；研究重點將放在以運動捕捉資料改進
程序式動畫的擬真性，並以程序式動畫的方式建
立人體動畫的情緒風格模型。我們以最佳化的演
算法在程序式動畫的參數空間中，自動搜尋最接
近運動擷取動畫的參數組合，以產生既彈性又擬
真的虛擬角色動畫。另外，我們也嘗試建立情緒
與動作之間的關連模型，並以心理學實驗的方式
驗證所提模型的有效性。整體而言，本年度的研
究成果以達到階段性目標，這些成果也已於多個
國際研討會中發表。 
（二）、英文摘要 
In current 3D virtual environments, such as 
Second Life and 3D online games, the behaviors of 
an avatar are controlled by a real user according to 
a limited set of functions provided by the system. It 
is highly desirable for the behaviors to be created 
and controlled by the computer because we can not 
only enhance the content richness of the environ-
ment with ease but also enable interesting social 
experiments in virtual environments. We propose to 
use two years to conduct research on creating real-
istic behaviors for animated characters in virtual 
environments. We will design appropriate anima-
tion procedures and behavior models from the as-
pects of geometry, kinematics, dynamics, planning, 
emotion, and sociology. We will also integrate the 
implemented procedures into an existing virtual 
environment system to conduct simulation experi-
ments on virtual colony and collective social be-
haviors. In the past year (first year), we aim to en-
hance the realism of animation on individual ava-
tars. The focus will be on using motion capture 
data to enhance the realism of procedural anima-
tion and creating emotional body motions with 
procedural animation. We have adopted an optimi-
zation algorithm to automatically search the pa-
rameter space for the procedural animation such 
that the motion generated by the procedures can be 
made as close to the motion capture data as possi-
ble. Character animations created with this system 
can have the combined advantages of being flexi-
ble and realistic. In addition, we have also tried to 
build a hierarchical model to relate emotion to mo-
tion. We have verified the effectiveness of the 
model through psychological experiments. In gen-
eral, we have reached the goal set in the research 
proposal, and several research results have been 
published in international conferences.  
一、 緣由與目的 
3D電腦動畫的軟硬體技術，近年來可謂突
飛猛進，也使得3D動畫成為我國數位內容產業
 4
（Down）、兩腳交錯瞬間（Pass）、重心最高瞬
間（High）與前腳踏地瞬間（Contact）。兩個關
鍵格之間稱為階段（Phase）。如圖1所示，四個
關鍵格依序為Down、Pass、High及Contact。Down
到Pass之間的轉變稱為第一階段（Phase 1），Pass
到Contact稱為第二階段（Phase 2），Contact到
Down稱為第三階段（Phase 3）。 
我們的最佳化流程可分為三個步驟。首先，
在執行期之前，我們會先對運動擷取資料做前處
理，包括片段裁剪、骨架轉換及關鍵格標記。經
過前處理之後，在最佳化的執行期時，我們會先
對齊程序式動畫與運動擷取資料的關鍵格，然後
再利用模擬退火法（Simulated Annealing），最佳
化程序式動畫所提供的運動參數，使得程序產生
之動畫儘可能接近給定的運動擷取片段。一般而
言，最佳化問題的兩個要素是最佳化對象與目標
函數。如圖2所示，我們有一個自動調整運動參
數的模組（Auto Tuner），它可持續不斷地去調整
動畫程序所提供的運動參數，然後計算程序所產
生出的動畫與運動擷取片段之間的差異度，做為
它下一步調整運動參數的考量因素，目的是使兩
段動畫的差異度儘可能地達到最小。因此，我們
的最佳化對象（自變數）是動畫程序的197個運
動參數（表1），而目標函數是程序式動畫與運動
擷取片段的差異度。 
由於運動參數為高維空間中的資料，有著許
多局部解，我們通常會藉助機率搜尋演算法來解
決此問題。一般來說，模擬退火法是容易實作且
效率佳的演算法[14]，因此我們利用模擬退火法
來最佳化程序式動畫的運動參數。模擬退火法是
一種全域搜尋演算法，其特點是利用機率跳脫局
部解，以逼近真正的最佳解。詳細的演算法設計
請參閱我們發表的論文[9][10]。 
目標函數的設計是最佳化演算法中最重要
的步驟。對本問題而言，一個好的目標函數應該
要能測量出一段程序式動畫和一段運動擷取片
段的差異度。我們將一段動畫表示成一個組態串
列，而一個組態即代表角色的一個姿勢。假設以
運動參數組合A所產生之程序式動畫以PA表
示，已經過剪裁處理的運動擷取片段以M表示，
目標函數定義如下： 
∑
∈ ⎜⎜
⎜
⎝
⎛
+−
−+−
+
=
keyframesi
AA
A
iMiMd
iPiPd
w
iMiPdw
Af
])1[],1[(
])1[],1[(
)][],[(
)(
2
1
 
1) 
其中PA[k] 代表程序式動畫的第k格組態
（或姿勢），M[k] 代表運動擷取片段的第k格組
態。d是距離函數，用來計算兩個組態的差異度。
式子可分成兩項，前項d(PA[i], M[i]) 用來測量
PA和M在關鍵格 i角色姿勢的差異度，後項 
|d(PA[i-1], PA[i+1]) - d(M[i-1], M[i+1])| 用來測
量PA和M在關鍵格i角色各部位運動速度的差異
度。其中d(PA[i-1], PA[i+1]) 與d(M[i-1], M[i+1]) 
分別用來表示PA和M在關鍵格i一階導數的量度
（Magnitude），用來近似物理意義上的瞬時速
度。w1和w2為權重值，在我們目前的實驗中，
兩者值皆為1。 
我們希望能只需控制角色步伐大小和高
度，程序就能自動幫我們產生出自然的走路動
畫。但是由於運動參數彼此可能不獨立，所以當
我們去修改部分控制參數（如步伐大小和高度）
以符合需求時，可能會造成動作不自然。因此，
我們提議從這些最佳化後的運動參數去內插出
新的、符合使用者要求的參數組合。我們以步伐
大小及步伐高度的控制參數為點進行Delaunay
 
圖 2：最佳化系統架構圖 
 
圖 3：以三維空間圖視覺化運動參數的內插 
 6
我們認為，若要在動作和情緒這兩層面來找
出之間的關係，會因為它們的性質相差太大，而
不易找到有條理的對映。現實生活中各種動作都
存在著某些特性，使看似相同的動作，卻帶給人
不同的感覺，這些特性我們稱之為「風格」。人
在不同情緒下，肢體動作的風格亦不一樣。風格
類似形容動作的副詞，而情緒是人的內在狀態，
藉由風格表現於外在，以風格描述動作比以情緒
描述動作來得容易，因此我們藉由風格來替動畫
加入情緒意涵。 
我們假設程序、動作、風格和情緒這四種參
數為一階層關系，如圖6，改變程序和動作參數
可改變其帶有的風格，進而改變動作帶有的情緒
成份。一段動畫的製作順序，應是先找出動作特
徵做成動作參數，再將動作參數對映至程序參
數，由基礎程序來製作動畫。要替人物加入風
格，由動作參數著手較為合適，因為相較於基礎
程序的參數，動作參數較直覺。另外，若能知道
情緒如何影響風格，則可操弄風格來產生情緒效
果。因此在此論文中，我們將嘗試定義或找出這
四層參數間的對應關係。 
在基礎程序的階層，我們設計了四個主要的
基礎動畫程序。在動作參數的階層，我們以走路
動作為例，說明如何以參數化的方式建構特定的
動作，並記錄於外部資料檔案中。走路之動作參
數的定義如圖7所示。另外，在風格參數對動作
參數的對應上，我們選用Montepare等[13]所採用
的六個動作風格中的五個： smooth-jerky﹙平滑
和顫動﹚、stiff-loose﹙僵硬和放鬆﹚、slow-fast﹙慢
和快﹚、soft-hard﹙輕和重﹚和expanded-contracted
﹙擴張和收縮﹚，進行對動作參數上的設計。例
如，圖8是走路動作中設定擴張程度參數的範
例。最後，在情緒參數上，我們選用Ekman的基
本情緒模型，包含生氣、快樂、悲傷、及害怕等
與肢體動作較相關的基本情緒。 
（三） 實驗成果 
我們根據上一小節的階層模型，設計了一個
程序式動畫的引擎，並實作了上述參數模型的對
應關係。我們根據這些對應關係三個階段進行心
理學實驗，以驗證模型及對應關係的正確性。第
一，我們首先驗證風格參數與動作參數之間的對
應關係是否操弄成功。我們將五個風格參數分為
高低兩個等級，排列組合作用於走路動作上，其
高低程度以觀察者所能辨示並且不失自然為
準，所以共有2^5=32種走路動畫可做為評量影
片。我們請了包含男女各十五位的政治大學學生
參與此次實驗。 
從實驗結果，我們計算動作風格和其評分之
點二系列相關分析﹙point-biserial correlation﹚
[8]，可以得到表1。從此表中，我們可以得到除
了力道外，其餘四個操弄的風格和受試者的評分
皆達顯著。再深入觀察表5.2的相關結果可以發
現，雖然平滑度、僵硬度、速度及擴張度的操弄
確實和其本身的評分相關值最高且顯著，但和其
他動作風格評分間的相關也達顯著。例如，操弄
表 1：動作風格與評分相關性 
風格操弄
評分 平滑度 僵硬度 速度 力道 擴張度
平滑度 0.65** -0.295* 0.464** -0.351** 0.079
僵硬度 -0.445** 0.56** -0.371** -0.017 -0.262*
速度 -0.064 0.188 0.92** -0.196 0.836**
力道 -0.413** 0.132 0.757** -0.04 0.82**
擴張度 -0.061 -0.267* 0.511** -0.034 0.95**
* p < .05，** p < .01 
 
 
 
 
 
 
圖 7：走路動作的參數定義範例 
 
 
圖 6：關連情緒參數與運動參數的階層圖 
   
 (a) expanded (b) contracted  
圖 8：風格參數中擴張程度參數設定的範例 
(a) (b)
lift 
length step 
length 
step 
length 
ankle 
height 
x2 
 
3 
(c)
lift 
height 
x1 
 8
Automated Techniques,” Intl. J. of Hu-
man-Computer Studies, 59(1): 213-225, 2003. 
[3] A. Camurri, B. Mazzarino, M. Ricchetti, R. 
Timmers, and G. Volpe, “Multimodal Analysis 
of Expressive Gesture in Music and Dance 
Performances,” in Proc. of the 5th Intl. Work-
shop on Gesture and Sign Languages Based 
Human-Computer Interaction, 2003. 
[4] A. Camurri, M. Ricchetti, and R. Trocca, 
“EyesWeb - Toward Gesture and Affect Rec-
ognition in Dance/Musicinteractive Systems,” 
in IEEE Intl. Conf. on Multimedia Computing 
and Systems, 1999. 
[5] E. Crane and M. Gross, “Motion Capture and 
Emotion: Affect Detection in Whole Body 
Movement,” in Intl. Conf. on Affective Com-
puting and Intelligent Interaction, 2007. 
[6] P. F. Chen and T. Y. Li, “Generating Humanoid 
Lower-Body Motions with Real-time Plan-
ning,” in Proc. of 2002 Computer Graphics 
Workshop, 2002. 
[7] C. Darwin, The Expression of the Emotions in 
Man and Animals, London: John Murray, 
1872. 
[8] G. V. Glass and K. D. Hopkins, Statistical 
Methods in Education and Psychology (3rd 
edition), Allyn & Bacon, Boston, 1995 
[9] C.H. Liang, T.-Y. Li, “Using Motion Capture 
Data to Optimize Procedural Animation,” in 
Proc. of the Intl. Conf. on Computer Animation 
and Social Agents (CASA2009), Amsterdam, 
June 2009. 
[10] C.H. Liang and T.-Y. Li, “Optimizing Proce-
dural Animation with Motion Capture Data,” 
in Proc. of the 14th Conf. on Artificial Intelli-
gence and Applications, Taichun, Nov. 2009. 
[11] Y.-H. Lin, C.-Y. Liu, H.-W. Lee, S.-L. Huang, 
T.-Y. Li, “Verification of Expressiveness of 
Procedural Parameters for Generating Emo-
tional Motions,” in Proc. of the Eight Intl. 
Conf. Intelligent Virtual Agents (IVA'08), Lec-
ture Notes in Artificial Intelligence 5208, 
pp.514-515, Sept. 2009. 
[12] Y.-H. Lin, C.-Y. Liu, H.-W. Lee, S.-L. Huang, 
T.-Y. Li, “Evaluating Emotive Character An-
imations Created with Procedural Animation,” 
in Proc. of the 9th Intl. Conf. on Intelligent 
Virtual Agent, pp. 308-315, Amsterdam, Sept. 
2009.  
[13] J. Montepare, E. Koff, D. Zaitchik, and M. 
Albert, “The Use of Body Movements and 
Gestures as Cues to Emotions in Younger and 
Older Adults,” Journal of Nonverbal Behavior, 
23(2): 133-152, 1999. 
[14] S.J. Russell and P. Norvig, “Simulated An-
nealing Search,” Artificial Intelligence: A 
Modern Approach (2nd Edition), Prentice Hall, 
2002, pp.115-116. 
[15] Second Life, http://secondlife.com. 
[16] M. van de Panne, “From Footprints to Anima-
tion,” Computer Graphics Forum, 16(4): 
211-223, October 1997. 
[17] H. Schlosberg, “A Scale for Judgment of Fa-
cial Expressions,” Journal of Experimental 
Psychology, 29: 497-510, 1941. 
[18] R. Urtasun, P. Glardon, R. Boulic, D. Thal-
mann, and P. Fua. “Style-based Motion Syn-
thesis,” Computer Graphics Forum, 23(4): 
1-14, 2004. 
[19] H. G. Wallbott, “Bodily Expression of Emo-
tion,” European Journal of Social Psychology, 
28(6): 879-896, 1998. 
[20] A. Witkin and Z. Popovic, “Motion Warping,” 
Proceedings of ACM SIGGRAPH, Addison 
Wesley, pp.105-108, August 1995. 
[21] L. Zhao and N. I. Badler, “Acquiring and Vali-
dating Motion Qualities from Live Limb Ges-
tures,” Graphical Models, 67(1): 1-16, 2005. 
行政院國家科學委員會補助國內專家學者出席國際學術會議報告 
報 告 人 
 
姓 名 
 
李蔡彥 
 
服務機構
 
及 職 稱
 
國立政治大學資訊科學系 
 
時間 
會議 
地點 
 2008年 8月 27-29日 
 
 法國雷恩 
本會核定
 
補助文號
 
97-2221-E-004-010 
 
會 議 名 稱  (中文) 第八屆國際智慧型繪圖研討會  (英文) 8th International Symposium on Smart Graphics (SG2008) 
發表論文題
目 
 (中文) 虛擬環境中攝影機的即時運動計畫 
 (英文) Real-Time Camera Planning for Navigation in Virtual Environments 
一、參加會議經過 
 
一年一度的智慧型繪圖國際研討會（SG2008），今年在法國的雷恩（Rennes）舉行。這是我第
二次參加此一國際研討會，上一次是去年在日本舉行。在上次的經驗中，我發覺這個雖然不大，
但所探討的議題多是與我研究興趣相符合的主題，讓我收穫頗多，因此今年雖然遠在法國舉辦，
我仍然決定投稿參與此盛會。此次的會議在法國西方的雷恩（Rennes）市是舉行，地點是在雷恩
大學與法國著名的 INRIA研究機構的所在地。這是一個以研究為主的學術機構，但也授予學位學
程，以吸引世界各地優秀的學生前往從事研究工作。此次會議的議程主席是由此會議的創始者及
當地的Marc Christie等五位學者所共同擔任。此次會議吸引了世界各地十多國的數十位學者共同
參與，人數雖然不是很多，但由於研究主題有焦點，因此與會人員參與的程度不輸許多大型的研
討會。此次會議的議程共有三天，共分為七個發表場次、兩個大會演講、兩個討論場次、及一個
展示的場次。大會的主題演講主要是在資訊視覺化及智慧型多媒體的研究主題上，邀請到美國及
德國的知名學者 David Ebert及 Sussane Boll發表在這兩個領域的進展報告。另外，大會也安排了
兩個晚上的社交活動，包括一個起司與酒的歡迎晚會及一個在著名古宅內的大會晚宴，十分具有
文化特色，也充分展示了主辦單位的苦心。此研討會的特色之一便是會有一個系統展示的場次，
讓與會者可以展示自己所開發的系統，讓其他與會者體驗。我在此場次中也展示了我們所開發的
即時攝影機規劃系統，獲得了不錯的回饋。在第三天議程的最後，主辦單位也安排了當地實驗室
的參訪，參觀了虛擬實境、腦機介面、及即時繪圖等技術。就整個研討會參與的學者而言，或許
是由於地利之便，以歐洲學術團體的代表較多，其次是美國及亞洲的學者。 
本人所發表的論文題目為「虛擬環境中攝影機的即時運動計畫」，是有關如何以預算為基礎運
動計畫演算法設計即時攝影機規劃器，在虛擬環境中以第三人稱的方式追蹤虛擬替身，以期能規
劃出不被障礙物遮蔽，且符合攝影學原則的攝影機軌跡。發表的場次是屬於攝影機規劃的場次。
要在其他研討會中找到類似的場次並不容易，因為目前世界各地專精此主題的研究團體有限，因
此能藉此機會與同好進行交流，機會誠屬難得。 
 
二、與會心得 
 
智慧型繪圖（Smart Graphics）是結合人工智慧及電腦繪圖的一個新興圖學應用領域。此類研
究在近年來越來越受重視，因此才有獨立的研討會以此為主題舉辦。在此次研討會中，有許多論
文與認知科學及資訊視覺化相關，這也是近年來發展的趨勢，值得進一步觀察。另外，以限制為
