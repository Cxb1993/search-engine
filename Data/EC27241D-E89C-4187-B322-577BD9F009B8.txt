質薄層之 FDTD 分析、二維小介質圓柱散射的 FDTD 分析 
英 文 摘 要 ： In this research we treat Yee-FDTD, ADI-FDTD as 
discrete space-time signal processing procedure, and 
extend the z-transform technique in digital signal 
processing to a new digital spectral domain theory.  
This new theory can analyze the error and stability 
of Yee-FDTD and ADI-FDTD methods applied to many 
problems.  The procedure is more compact, complete, 
and general. 
 
In the first year this theory has been successfully 
applied to analyze one-dimensional cavity problem, 
one-dimensional propagation problem in free space, 
the error and stability of one-dimensional Yee-ADI 
hybrid gridding.  We also propose that the absorbing 
boundary condition (ABC) may be regarded as a spatio-
temporal filter, and utilize the filter design 
techniques popular in DSP to design the first order 
optimal one-dimensional absorbing boundary condition.  
However, the results showed that they depend on the 
chosen weighting function, and the performance is 
inferior to the conventional second-order Mur 
absorbing boundary condition. 
 
The researches in the second year are focused on the 
two-dimensional Green’s function and the three-
dimensional dyadic Green’s function for Yee-FDTD 
equations.  We successfully combined the digital 
domain theory developed in the first year and the 
partial difference operator theory to derive 
innovative analytic solution to the Yee-FDTD Green’s 
function for two-dimensional and the Yee-FDTD dyadic 
Green’s function for three-dimensional free space.  
With these analytic solutions we have discussed their 
wave propagation properties.  Such solutions could be 
also used in hybrid absorbing boundary conditions 
proposed in other literature, and may provide a 
deformable absorbing boundary condition with 
performance similar to the popular perfectly matched 
layer (PML). 
 
 I
摘要 
本研究將Yee-FDTD、ADI-FDTD視為離散時空訊號(Discrete Space-Time 
Signal)處理程序，並擴充數位訊號處理(Digital Signal Processing，DSP)之z 
轉換(z-Transform)技術為創新之數位頻域(Digital Spectral Domain)理論，可
分析Yee-FDTD及ADI-FDTD方法應用於許多問題之誤差及穩定度，較現今文獻所用
方法簡潔、完整、普遍化。 
此一新理論在第一年已成功應用於分析一維空腔問題、一維自由空間傳播問
題、一維Yee-ADI FDTD混成格網問題之誤差及穩定度，均為過去未有人發表之成
果。另外並提出吸收邊界條件可看成時空濾波器，運用DSP 之濾波器設計方法，
設計Yee-FDTD 方法之一階最佳一維吸收邊界條件。唯所得結果與採用之權重函
數有關，且一般情形下，效果不如傳統所用的二階Mur吸收邊界條件。 
第二年之研究以Yee-FDTD方程式之二維Green’s Function與及三維Dyadic 
Green’s Function為目標，成功地以第一年開發之數位頻域理論結合偏差分算符
理論(Partial Difference Operator Theory)，導出創新之Yee-FDTD自由空間二
維Green’s Function與三維Dyadic Green’s Function的解析形式解，並進一步
探討其波動性質。此種Yee-FDTD方程式之二維Green’s Function與及三維Dyadic 
Green’s Function有可能用於混成吸收性邊界條件(Hybrid Absorbing Boundary 
Conditions)，提供與完全匹配層(Perfectly Matched Layer, PML)性能彷彿，
而形狀可變之另一種吸收性邊界條件選擇。 
第三年之研究則考慮介電質存在時的問題。首先是利用訊號處理的多維度訊
號穩定度原理，配合數位頻域技術，導出無窮大導電物質空間之一維FDTD方程組
穩定條件，與傳統文獻運用Neumann方法所得結果相同。雖然結果相同，但其過
程象徵電磁數值方法與多維度訊號穩定度原理的結合，實為一大創新。但因所需
之多維度訊號穩定度原理只有證明到二維，因此只能應用於一維FDTD方法，實為
可惜。其次考慮一維薄介質夾層之TM斜向入射問題，我們應用數位頻域方法，首
次導出了FDTD反射與穿透場的時域解析解，並與連續時域解比較。最後，針對二
維小介質圓柱的TM散射問題，應用前一年得到的二維Green＇s Function，推導
出FDTD方程組的z域解，但其結果不易轉成時域解，亦難以計算出數值。 
 
關鍵詞：數位頻域理論、時域有限差分法、交錯方向內隱式方法、穩定度、混成
格網、吸收邊界條件、FDTD Green 函式、一維介質薄層、二維介質細圓柱 
 III
目錄 
摘要                   I 
Abstract II 
圖目錄                 IV 
第一章 緒論              1 
1.1 前言              1 
1.2 研究目的                     2 
1.3 創新貢獻             2 
1.4 章節概要             3 
第二章 一維自由空間問題           4 
2.1 簡介與文獻探討            4 
2.2 ADI-FDTD 空腔問題之數位頻域分析        4 
2.3 Yee-ADI 混成網格在傳播問題的穩定度與誤差分析     6 
2.4 最佳一維吸收邊界設計          8 
第三章 二維及三維自由空間之 Yee-FDTD Green 函數        11 
3.1 簡介與文獻探討              11 
3.2 二維 Yee-FDTD Green 函數之解析解          11 
3.3 三維 Yee-FDTD Green 對量函術之解析解         13 
3.4 平行板波導的二維 Green 函數           19 
第四章 一維及二維介質散射問題            22 
4.1 簡介與文獻回顧              22 
4.2 一維介質薄層之斜向 TM 入射問題的 Yee-FDTD 解析解      22 
4.3 二維介質小圓柱 TM 散射問題之 Yee-FDTD 頻域解       38 
第五章 結論                44 
5.1 總結                44 
5.2 未來可繼續之研究             44 
5.3 研究成果自評              44 
參考文獻                 46 
附錄 1  2009 年發表於 IEEE-APS 之國際會議論文         49 
附錄 2  未發表之一維自由空間傳播問題論文          54 
附錄 3  2010 年發表於 IEEE-APS 之國際會議論文         64 
附錄 4  2011 年發表於 IEEE Transactions on Antennas and Propagation 
       之期刊論文               69 
附錄 5  2011 年發表於 ISAP 之國際會議論文         79 
 2
Conditions)[11]，提供與完全匹配層(Perfectly Matched Layer, PML)[12]性
能彷彿，而形狀可變之另一種吸收性邊界條件選擇。 
二維 Green’s Function 的成果已發表於 2010 IEEE AP-S International 
Symposium [13]。三維 Dyadic Green’s Function 的成果也已發表於 IEEE 
Transactions on Antennas and Propagations [14]。這兩篇論文分別列為本報
告之附錄 3、4，藉供參考。我們也利用相似的方法，搭配變數分離，推演出平
行板波導的二維 Green’s Function z 域解，但其逆 z轉換的路徑積分較為複雜。 
第三年之研究則考慮介電質存在時的問題。首先是利用訊號處理的多維度訊
號穩定度原理[15][16]，配合數位頻域技術，導出無窮大導電物質空間之一維
FDTD方程組穩定條件，與傳統文獻運用Neumann方法所得結果[17]相同。雖然結
果相同，但其過程象徵電磁數值方法與多維度訊號穩定度原理的結合，實為一大
創新。但因所需之多維度訊號穩定度原理只有證明到二維，因此只能應用於一維
FDTD方法，實為可惜。因此先投稿2011 IEEE AP-S International Symposium，
未獲欣賞，修改後改投2011 International Symposium on Antennas and 
Propagation (ISAP 2011)獲接受，於本年10月底前往韓國濟州島報告[18]，論
文內容收錄於本報告附錄5。其次考慮一維薄介質夾層之TM斜向入射問題，我們
應用數位頻域方法，首次導出了FDTD反射與穿透場的時域解析解，並與連續時域
解比較。最後，針對二維小介質圓柱的TM散射問題，應用前一年得到的二維
Green＇s Function，推導出FDTD方程組的z域解，但其結果不易轉成時域解，亦
難以計算出數值。 
 
1.2 研究目的 
第一年研究目標為發展一維問題之創新數位頻域理論，並應用於混成格網之
誤差及穩定度分析。其次為運用 DSP 之無限脈衝反應(IIR)數位濾波器技術
[19]，設計最佳吸收邊界條件，並與傳統之二階 Mur 輻射邊界條件理論結果比
較。 
第二年研究目標為將數位頻域理論應用於二、三維問題，配合偏差分算符理
論，導出 Yee-FDTD 方程式之二維 Green’s Function 及三維 Dyadic Green’s 
Function 的解析形式，並探討其波動傳播機制。 
 
第三年研究目標為應用數位頻域理論，探討一、二維介質散射問題的
Yee-FDTD 方程式解之性質。 
1.3 創新貢獻 
第一年研究主要確立了數位頻域分析的理論架構：首先列出所要分析的時-
 4
第2章 一維自由空間問題 
2.1 簡介與文獻探討 
本計畫所要進行的時域有限差分方程組一般性誤差與穩定度分析，就我們所
知，過去除了無窮大自由空間中之數值色散誤差(Numerical Dispersion Error)
及穩定度[2]-[6]外，沒有什麼文獻。本計畫將使用的 z轉換方法，在 FDTD 方法
的應用，也只有找到 Sullivan 於 1996 的工作[20]，及 Kastner 分別在 2005、
2006 發表的兩篇論文[21][22]。Sullivan 的論文中，z 轉換只是推導色散或非
線性媒質中之遞迴方程式的工具，缺乏進一步的分析。Kastner 的論文中，將一
到三維的 FDTD Green 函數表成多維的逆 z 轉換，將積分函數以冪級數展開，直
接於單位圓上計算逆 z轉換的路徑積分。這種計算方式相當繁複，其結果也不容
易看出物理意義，更不用說是分析誤差與穩定度了。此外，Kastner 也只處理了
無窮大自由空間的情形，並沒有觸及有限空間問題及混成格網問題。 
 
2.2 ADI-FDTD 空腔問題之數位頻域分析 
假想一維自由空間，在 0z 及 zLz  分設完全導體邊界，於 zkz  0 處有 x 方
向之面電流 ztfzkztzJ x  /)()(),( 0 激發電磁場。假設 
 )()()( 00 Ttftftf             (2.1) 
為一個持續時間T 的脈衝訊號，而 
 



 
0
0
2cos)()(
m
mm tT
mFtUtf              (2.2) 
為週期T ，於 0t 開始的週期函數， )(tU 為單位步階函數(Unit Step Function)。 
以 ADI 方式均勻分割空腔內的自由空間，其對應之時-空偏差分方程組為 
][
2
1]
2
1[]
2
1[
2
][][ 2/12/12/1 kJtckHkHskEkE nx
n
y
n
y
n
x
n
x  


   ,   (2.3) 
 ][]1[
2
]
2
1[]
2
1[ 2/12/12/1 kEkEskHkH nx
n
x
n
y
n
y
   ,     (2.4) 
][
2
1]
2
1[]
2
1[
2
][][ 2/12/12/12/11 kJtckHkHskEkE nx
n
y
n
y
n
x
n
x
 


   ,  (2.5) 
 ][]1[
2
]
2
1[]
2
1[ 2/12/12/11 kEkEskHkH nx
n
x
n
y
n
y
   ,     (2.6) 
其中為自由空間之固有阻抗(Intrinsic Impedance)， ztcs  / 為 Courant 數。 
 6
證實此處所得方程式的正確性。另外，與連續波的恰當解比較，Yee FDTD 的誤
差較小，ADI 的誤差較大，主要來自共振頻率的差異。 
1000 1010 1020 1030 1040 1050 1060 1070 1080 1090 1100
-1.5
-1
-0.5
0
0.5
1
1.5
n
E
-F
ie
ld
 
 
Exact
Direct Yee
Direct ADI
Inverse z Transform
 
圖 2-1. 四種方法計算的晚期時域反應，其中直接 ADI 方法(Direct ADI)與方程式(2.9)-(2.14) 
(Inverse z Transform)所得結果重合。 
 
 
2.3 Yee-ADI 混成網格在傳播問題的穩定度與誤差分析 
我們完成了一維空腔問題與傳播問題的 Yee-ADI 混成格網穩定度與誤差分
析，同樣受限於篇幅，此處只介紹傳播問題的結果。 
假設自由空間的半空間 0zMz  畫分如圖 2-2：左方與右方區域為 Yee 網
格，網格大小為 0z ；中間區域為 ADI 網格，網格大小為 qzz /0 ，並假設 q 為
正整數。此外，進一步假定三個區域的 t 均相等，且時間取樣同步，而 00 / ztcs 
及 0qss  分別為 Yee 區域與 ADI 區域的 Courant 數。 
 
圖 2-2. 三明治區域問題 
 混合運用類似[8][9]及上一節的處理方法，可以得到 z域解如下： 
0),z]([
)z(
)z(
)z]([
00
00 




 

kMME
R
RkE xMM
kk
x 
 ,         (2.16) 
Yee 
Region 
ADI 
Region 
Yee 
Region 
z
z = -Mz0 z = 0 z = Lz 
z0 z=z0/q z0 
 8
-1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1
-1
-0.8
-0.6
-0.4
-0.2
0
0.2
0.4
0.6
0.8
1
 
圖 2-3. 左方 Yee 區域共振情況對應之極點分佈圖，圖中也標示出單位圓 
         
0 50 100 150 200 250
-1
-0.8
-0.6
-0.4
-0.2
0
0.2
0.4
0.6
0.8
1
n
E
-F
ie
ld
 (V
/m
)
 
 
Exact
Inverse z Transform
Direct Computation
 
圖 2-4. 三種方法算出的左方 Yee 區域中點電場時域反應，圖中直接由 Yee-ADI 演算法計算的結
果與(2.16)之逆 z轉換結果曲線重疊 
 
2.4 最佳一維吸收邊界設計 
在我們對一維自由空間問題的分析[9]中，設定二階 Mur 吸收邊界條件為 
    ].1[]1[][
1
2][]1[
1
1][ 1111 
  LELELE
s
LELE
s
sLE nx
n
x
n
x
n
x
n
x
n
x     (2.22) 
經過 z轉換，此一吸收邊界條件可表為 
 
)z(D
)z(N
)z](1[
)z]([ LE
LE
x
x ,              (2.23) 
 10
0 20 40 60 80 100 120 140 160 180 200
-0.2
0
0.2
0.4
0.6
0.8
1
n
E
-F
ie
ld
 
 
Exact
Mur's ABC
Optimal ABC
 
圖 2-5. 利用 Mur 邊界與最佳吸收邊界所得之時域電場反應 
 
-1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1
0
0.01
0.02
0.03
0.04
0.05
0.06
0.07
0.08
0.09
0.1
Omega/Omegac
G
am
m
aL
S
qu
ar
e
 
 
Mur's ABC
Optimal ABC
 
圖 2-6. Mur 邊界與最佳吸收邊界條件造成之反射係數大小平方之頻譜 
 
 
 12
 設所有場在 0n 前均為零，定義電場、磁場、電流的 z轉換為 



0
z],[)z](,[
n
nn
zz jiEjiE , )2/1(
0
2/1 z]
2
1,[)z](
2
1,[ 


  n
n
n
xx jiHjiH  ,
 )2/1(
0
2/1 z],
2
1[)z](,
2
1[ 


  n
n
n
yy jiHjiH  ,          (3.4)
 2/1)2/1(
0
2/1 z],[z],[)z](,[ 




 jiyx
tcjiJjiJ n
n
n
zz  ,  
於是可將(3.1)-(3.3)轉換為 z域的常差分方程組。經由處理，可得 )z](,[ jiEz 之
差分方程式為 
     ],[z1)z](,[)z](,[)z](,[zz 12222/12/1 jissjiEsjiEsjiE yxzjjyziixz   , (3.5) 
此 處 i 及 i 為 作 用 於 註 標 i 的 向 前 與 向 後 偏 差 分 算 符 ， 分 別 由
)z](,[)z](,1[)z](,[ jiEjiEjiE zzzi  及 )z](,1[)z](,[)z](,[ jiEjiEjiE zzzi  定義。算符 j
及 j 的定義亦相似。方程式(3.5)可寫為 
      ],[z1)z](,[zz 12222/12/1 jissjiEss yxzjjyiix   ,    (3.6) 
因而符號上可得出 
      ],[z1zz)z](,[ 112222/12/1 jissssjiE yxjjyiixz       (3.7) 
算符理論[10]允許我們展開 
 
        
     
      )()(220 0222/12/1
0
22/12/1
2
22/12/1
2
22/12/1
1
22/12/1
2
22/12/1
2
22/12/1
1
2222/12/1
zz
1
zzzz
zz
zzzz
1zzzz

 

 

 
































 

m
jjii
m
yx
m
m
m
m
m
jjyiix
jjyiix
jjyiix
ss
m
ss
ss
ss
 
(3.8) 
此處 




m 為組合係數 m 取 。 
 定 義 偏 遞 增 算 符 i 及 j 如 下 ： )z](,1[)z](,[ jiEjiE zzi  ，
)z](1,[)z](,[  jiEjiE zzj 。 則     21 ， 再 由 數 學 歸 納 法 可 證
    ji
p
pp
p
,,1
22 






  



 。 
 將這些性質代入(3.8)，可得 
    ],[1
)(22
1
)z](,[
)(
)(
1)(212
00
12 qjpiqm
m
p
ss
m
z
z
jiE
qpm
p
m
mq
m
yx
m
m
m
m
z























 
  










.(3.9) 
 14
]..
2
1[
]
2
1,,
2
1[]
2
1,,
2
1[
],
2
1,
2
1[],
2
1,
2
1[
],,
2
1[]..
2
1[
2/1
2/12/1
2/12/1
1
kjiJtc
kjiHkjiHs
kjiHkjiHs
kjiEkjiE
n
x
n
y
n
yz
n
z
n
zy
n
x
n
x




 



 








,        (3.12) 
].
2
1.[
],
2
1,
2
1[],
2
1,
2
1[
]
2
1,
2
1,[]
2
1,
2
1,[
],
2
1,[].
2
1.[
2/1
2/12/1
2/12/1
1
kjiJtc
kjiHkjiHs
kjiHkjiHs
kjiEkjiE
n
y
n
z
n
zx
n
x
n
xz
n
y
n
y




 



 








,        (3.13) 
]
2
1..[
]
2
1,
2
1,[]
2
1,
2
1,[
]
2
1,,
2
1[]
2
1,,
2
1[
]
2
1,,[]
2
1..[
2/1
2/12/1
2/12/1
1




 



 





kjiJtc
kjiHkjiHs
kjiHkjiHs
kjiEkjiE
n
z
n
x
n
xy
n
y
n
yx
n
z
n
z



,        (3.14) 
]
2
1,
2
1,[
]
2
1,,[]
2
1,1,[
],
2
1,[]1,
2
1,[
]
2
1,
2
1,[]
2
1,
2
1,[ 2/12/1




 



 
 
kjitMc
kjiEkjiEs
kjiEkjiEs
kjiHkjiH
n
x
n
z
n
zy
n
y
n
yz
n
x
n
x 
,         (3.15) 
]
2
1,,
2
1[
],,
2
1[]1,,
2
1[
]
2
1,,[]
2
1,,1[
]
2
1,,
2
1[]
2
1,,
2
1[ 2/12/1




 



 
 
kjitMc
kjiEkjiEs
kjiEkjiEs
kjiHkjiH
n
y
n
x
n
xz
n
z
n
zx
n
y
n
y 
,         (3.16) 
 16
 












0
0
0
ixjy
ixkz
jykz
ss
ss
ss
,            (3.26) 
 












0
0
0
ixjy
ixkz
jykz
ss
ss
ss
.            (3.27) 
 離散電場 Dyadic Green’s Function 定義為 
  ],,[],,[],,[],,[ ,,, kjiGkjiGkjiGkjiG zeen yeen xeenee  ,         (3.28) 
及 
  ],,[],,[],,[],,[ ,,, kjiGkjiGkjiGkjiG zehn yehn xehneh  .         (3.29) 
此處 ],,[, kjiG n xee 、 ],,[, kjiG n yee 、 ],,[, kjiG n zee 為由電流源 
  Tzyxn kjinssskjiJtc 00],,[][],,[2/1    ,         (3.30) 
  Tzyxn kjinssskjiJtc 0],,[][0],,[2/1    ,         (3.31) 
  Tzyxn kjinssskjiJtc ],,[][00],,[2/1             (3.32) 
產生的電場(3.18)，而 ],,[, kjiG n xeh 、 ],,[, kjiG n yeh 、 ],,[, kjiG n zeh 為由類似(3.30)-(3.32)
的磁流源產生之電場。符號 1][ n ， 0n 及 0][ n ， 0n 。相似的定義方式，有
當 0,0,0  kji 時， 1],,[ kji ，其他情況 0],,[ kji 。  
 另外也可以雷同方式定義離散磁場 Dyadic Green’s Function，不在本研究
探討之列。 
 以類似(3.4)的方法定義電場、磁場、電流源、磁流源的 z 轉換，可將
(3.22)-(3.23)化為 
   )z(z)z(z)z(1z 2/12/1 eqJHE   ,           (3.33) 
   )z(z)z(z)z(1z 2/12/1 eqMEH   .          (3.34) 
 02/1z)z()z( EJtcJeq   ,             (3.35) 
 2/1)z()z(  HMtcM eq  .             (3.36) 
由(3.33)(3.34)可得 
    )z()z(zz 22/12/1 SEI   ,           (3.37) 
   )z()z(zz)z( 2/12/1 eqeq MJS   ,           (3.38) 
而 I 是單位矩陣。符號上可推出 
    )z(zz)z( 122/12/1 SIE   .          (3.39) 
   L
Du
I
)z()z(
1)zz(
122/12/1   ,          (3.40) 
   2122/12/1 )1z(zzz)z(  u ,            (3.41) 
 18
 
 

 



mzm
mzzm
m
zyx
zzee
kjig
kji
sss
kjiG
],,[
1z
z
],,[
1z
)z](
2
1,,[
,32
1
, 
,           (3.48) 
 
221222
,
122
1
12
,,
)1(],,[






















 









zyx
m
kjim
mxz
sss
kji
m
kjig
,          (3.49) 
 
222212
,
12
1
122
,,
)1(],,[























 









zyx
m
kjim
myz
sss
kji
m
kjig
,          (3.50) 
 
}
222
,,
1
1
2222
,,
{)1(],,[
121212
1
321212
,




















 







































zyx
m
zyx
m
kjim
mzz
sss
kji
m
sss
kji
m
kjig
,        (3.51) 
    0,,1max0),1(,max kkjiimx  ,          (3.52) 
    0,,1max0),1(,max kkjjjimy  ,         (3.53) 
  }0,1,1max,1|min{|  kkkjimz .          (3.54) 
)z](,,[, kjiG xee 與 )z](,,[, kjiG yee 的分量可以由(3.46)-(3.54)適當輪換 zyx ,, 及對應的
 ,, 而得。 
 對(3.46)-(3.48)取逆 z轉換，便可得到時域 Dyadic Green’s Function 為 
 ],,[
22
],,
2
1[ ,
2
, kjigm
mn
kjiG mxz
n
mxm
n
xzee 
 




 ,          (3.55) 
 
 




 2 ,, ],,[22],2
1,[
n
mym
myz
n
yzee kjigm
mn
kjiG ,          (3.56) 
 

 






2
,
,
],,[
22
],,[]1[]
2
1,,[
n
mzm
mzz
zyx
n
zzee
kjig
m
mn
kjinUssskjiG 
.          (3.57) 
此處 1]1[ nU ，當 1n ，而 0]1[ nU ，當 1n 。其他分量同樣可由輪換下標及
足碼而得。 
 圖3-2顯示以(3.55)-(3.57)算出的時域Dyadic Green’s Function及以FDTD
直接計算的結果，兩者完全重疊，驗證(3.55)-(3.57)的正確性。此處的參數為
3/1 zyx sss 、 10i 、 20j 、 30k 。注意(3.55)-(3.57)中的各項組合係數
與多項組合係數均由 Mathematica®算出。 
 20
代入 
   0)z](,[)z](,[)z](,[zz 2222/12/1   jiEsjiEsjiE zjjyziixz ,      (3.59) 
得 
   0)z]([
)z]([
)z]([
)z]([
zz
22
22/12/1   jV
jV
s
iU
iU
s
jj
y
ii
x .      (3.60) 
設 
 )z(2)z]([
)z]([
1 2
yjj jVjV
 ,            (3.61) 
有 
 0)z](1[)z}([))z(1(2)z](1[ 2  jVjVjV y ,         (3.62) 
其解為 
 jyjy CCjV   )z]([ ,             (3.63) 
  222 111 yyy j   .            (3.64) 
代入邊界條件 0)z]([)z](0[  yLVV ，可得 
 
yL
jmjV sin)z]([  , 1,,1,0  yLm  .          (3.65) 
另由比較係數法，可展開 ][ 0jj  為 
 






 
 yy
L
m y L
jm
L
jm
L
jj
y  sinsin2][ 0
1
0
0 .          (3.66) 
因此可重新假設滿足(3.58)的 )z](,[ jiEz 為 
 )z]([sinsin2)z](,[ 0
1
0
iU
L
jm
L
jm
L
jiE m
yy
L
m y
z
y







 

 ,         (3.67) 
代入(3.58)，並利用 
 










yyy
jj L
jm
L
m
L
jm  sin
2
sin4sin 2 ,          (3.68) 
化得 
     ][1)z]([
2
sin4zz 1222
22/12/1 izssiUs
L
ms yxmiix
y
y   




 


 .     (3.69) 
符號上可解出 
 
 22
 
第4章 一維及二維介質散射問題 
4.1 簡介及文獻回顧 
前面的討論都是假設自由空間中的問題，本章嘗試分析介質散射問題。參考
文獻中，處理 Yee Cell 中介質成份，有的採用平均的方法，如[27]；也有的利
用 Maxwell 方程式的積分型式，推導出差分方程式，例如 Yu-Mittra 方法[27]
及 Maloney-Smith[27]技術。本章研究運用這種方法，得到 FDTD 差分方程式，
再以頻域方法分別處理一維介質薄層的斜向TM入射問題及二維小介質圓柱的TM
散射問題。對於一維問題，我們可以導出時域反應的解析型式，並算出一些結果，
並予討論。對於二維問題，只能得出 z域結果，無法如前面的一些結果，導得時
域反應的解析解，但可以由 z域公式討論其穩定度。 
 
4.2 一維介質薄層之斜向 TM 入射問題的 Yee-FDTD 解析解 
 考慮一個自由空間中夾一個厚度為 d之介質薄層的斜向 TM 入射問題如圖
4-1，其中介質薄層在 y、z 方向無窮延伸，介電係數為 0 r 、導磁係數為0、
導電率為，入射電場與磁場為 
 
 ),()sincos(),,(
0
xE
c
yxtEyxtE ss
inc
z   ,      (4.1) 
 0/),,(sin),,(  yxtEyxtH inczincx  ,        (4.2) 
 0/),,(cos),,(  yxtEyxtH inczincy  ,        (4.3) 
此處 ),( xEs  為已知函數， 
 
0
sin
c
yt   ,            (4.4) 
而 0c 和 0 分別是自由空間中的光速與固有阻抗。 
 
 24
求出 refzE 後，可由(4.9)得到 refxH 。 
 運用類似的想法，可以假設 2/dx  之自由空間內的電磁場為 
 
 ),(),( xExE trszz                (4.13) 
 ),(),( xHxH trs                (4.14) 
 ),( xEtrsz  )cos(
0c
xEt
              (4.15) 
 0/),(sin),(  xExH trsztrsx             (4.16) 
 0/),(cos),(  xExH trsztrsy             (4.17) 
並化簡未知穿透場的 Maxwell 方程式為 
 0cos1 2
0
0 



 trsztrsy E
cx
H ,           (4.18) 
 01 0
0




 trsytrsz H
cx
E ,             (4.19) 
同樣可經由(4.16)及解出之 trszE 得到 trsxH 。 
 介 質 區 2/2/ dxd  的 電 磁 場 則 可 分 別 令 為 ),( xEz  及
),(ˆ),(ˆ xHyxHxH yx   ，它們符合的 Maxwell 方程式可化簡為 
 0sin 0
0
0
0
0 



z
zrxy EE
c
H
cx
H 


          (4.20) 
 01sin 0
00






 xz H
c
E
c
            (4.21) 
 01 0
0




 yz H
cx
E              (4.22) 
 
將(4.21)代入(4.20)可得 
 0sin 0
0
2
0 


z
zry EE
cx
H 
           (4.23) 
01 0
0




 yz H
cx
E .             (4.24) 
 
 為使用 FDTD，建立 Yee Cell 如圖 4-2，假設其中的 cell 大小為 yx ，
 26
 
 對於包住介質薄層的 Yee Cell 如圖 4-3，可以利用積分形式的 Maxwell 方
程式 
  dazEdazDtdH ˆˆ            (4.29) 
寫成 
     
  ydjEjE
ydjEjEydxjEjE
yjHjHxjHjH
n
z
n
z
n
z
n
zr
n
z
n
z
n
y
n
y
n
x
n
x





 


 



],0[],0[
2
],0[],0[],0[],0[
],
2
1[],
2
1[]
2
1,0[]
2
1,0[
1
1
0
1
0
2/12/12/12/1

 (4.30) 
令 0y ，則
y
yjtnH
yjHjH
x
n
x
n
x 




  
),0,)
2
1((
/]
2
1,0[]
2
1,0[ 2/12/1 。設
由
0
sin
c
yt   及(4.21)，可知 
 






 zxx E
c
H
cy
H
00
2
0
sinsin            (4.31) 
 
將此結果取差分，代入(4.30)，並刪去註標 j，化簡得出 
]
2
1[]
2
1[
]0[
2
sin
]0[
2
sin
2/1
0
2/1
0
0
2
,10
2
,




 


 


n
y
n
y
n
z
avgrn
z
avgr
HH
Ed
s
Ed
s


,     (4.32) 
 
 


 x
d
x
d
ravgr 1,  .            (4.33) 
代入 ]
2
1[]
2
1[2/1 trsy
n
y HH  及 ]2
1[]
2
1[]
2
1[ 2/1,2/1,2/1   nrefynincyny HHH ,可將(4.32)
寫為 
 
]
2
1[]
2
1[]
2
1[
]0[
2
sin
]0[
2
sin
2/1,
0
2/1,
0
2/1,
0
0
2
,10
2
,




 


 


ninc
y
nref
y
ntrs
y
n
z
avgrn
z
avgr
HHH
Ed
s
Ed
s


 ,    (4.34) 
 28
解析解找出此套方程組的穩定條件。 
 
 首先對(4.25)-(4.28)取 z 轉換，並令 


0
, z][)z]([
n
nnref
z
ref
z iEiE ，
)2/1(
0
2/1,
00 z]2
1[)z](
2
1[ 


  n
n
nref
y
ref
y iHiH  ， 


0
, z][)z]([
n
nntrs
z
trs
z iEiE 、 
)2/1(
0
2/1,
00 z]2
1[)z](
2
1[ 


  n
n
ntrs
y
trs
y iHiH  ，得到 
 















0
0
)z](
2
1[
)z]([
1zz
cos
z-1z
02/1
2
1/2
iH
iE
s
s
ref
y
ref
z
i
i
 , 1i        (4.40) 
 















0
0
)z](
2
1[
)z]([
1zz
cos
z-1z
02/1
2
1/2
iH
iE
s
s
trs
y
trs
z
i
i
 , 1i .       (4.41) 
 
假設 irefz EiE )z()z]([ 0 、 2/1000 )z()z](2
1[  irefy HiH  ，利用
ii
i  )1(   及 iii  )1( 1 ，可將(4.40)化成 
















 0
0
)z(
)z(
1z)1(z
cos
)1(z1z
2/1
00
0
12/1
2
2/1



H
E
s
s
.        (4.42) 
其成立的條件為行列式等於 0，即 
    22/12/12222/12/1 coszz   s .          (4.43) 
同時需要 
 )z(
zz
)z( 02/12/1
2/12/1
00 EsH 


  .           (4.44) 
由(4.43)之特徵方程式解得 
  2/12/12/12/1 zzcos  
s
 ,          (4.45) 
故有 
 )z(cos)z( 000 EH                (4.46) 
 
此處不取負號是因為考慮的是往負 x 方向傳播的反射波。於是可假設 1i 時， 
 
 irefz RiE )z()z]([  ,             (4.47) 
 30
)z](
2
1[cosz)z](
2
1[)z](
2
1[z
)z](0[
2
sin
z
2
sin
2/1
00
2/1
0
2
,0
2
,



 









 


 
syy
z
avgravgr
EHH
Ed
s
d
s


.    (4.55) 
代入(4.48)、(4.50)、(4.52)，成為 
 
   
)z](
2
1[coszcos)z(z
)z(cosz1z
2
)1(zsin
2/12/12/1
2/12/102
,




 


s
avgr
EsRs
Tsds


.        (4.56) 
聯立(4.54)、(4.56)便可以解出 )z(R 、 )z(T ，其結果以 z、 表出，但記得兩者
有(4.43)、(4.45)的關係，所以最後還是 z 的函數。 
 
 由(4.54)、(4.56)得到的 )z(R 、 )z(T 相當複雜，看能否找特例化簡。由(4.43)
可知，若取 coss ，可得 z ，於是(4.54)、(4.56)可化簡為 
 
  )z](1[)z](
2
1[zz)z()z( 2/12/1   ss EETR ,          (4.57) 
   
)z](
2
1[coszcos)z(
)z(cos1z
2
)1(zsin
22/12
202
,




 
s
avgr
ER
Tds


.       (4.58) 
由 )z]([iEs 和 )z](2
1[ iEs 的定義，導出 coss 時， )z](0[z)z](2
1[ 2/1 ss EE  、
)z](0[z)z](1[ ss EE  ，而把(4.57)、(4.58)再化簡為 
 
)z](0[
1
cosz
)z(
)z(
11
)
2
1(z)
2
sin(cos
2
0,0
2
,
2
s
avgravgr
E
T
Rdsds















.    (4.59) 
從中可解得 
 
ps
R
E
R
zz
zz
)z](0[
)z( 0
0 
 ,                (4.60) 
 
ps
zT
zE
zT
zz
1
)](0[
)(
0 
 ,                (4.61) 
 32
算出 
 
   
  
 
  ]}1[)(cos(z))1(cos(
]1[))(cos(z))1(cos(
]1[z]1[z)cos(cosz
{
1cosz2z
zz]0[][
]2/[
0
2000
,






 
NinUNinmNinm
inUinminm
NinUinUm
m
FRERiE
mpm
mpm
Nin
p
in
pmmp
N
m pp
m
p
in
s
nref
z







 
                  (4.73) 
 
   
  
 
  ]}1[)(cos(z))1(cos(
]1[))(cos(z))1(cos(
]1[z]1[z)cos(cosz
{
1cosz2z
z1]0[][
]2/[
0
200
,






 
NinUNinmNinm
inUinminm
NinUinUm
m
FTETiE
mpm
mpm
Nin
p
in
pmmp
N
m pp
m
p
in
s
ntrs
z







 
                  (4.74) 
(4.73)-(4.74)中可看出 ]0[0 insER  及 ]0[0 insET  為主要成份(Dominant Part)，且
為離散之後退及前進之行進波，波形與入射信號成倍數關係。其餘部份包括衰減
成份及殘餘部份，造成整體波形與入射信號間的偏差。同時注意，當 0 時，
1zz0  p ，所以反射波會只剩下主要成份，而穿透波的其他部份仍然存在。 
 
 為驗證(4.73)-(4.74)的準確程度，我們以 Fourier 轉換，直接解原問題的
Maxwell 方程式(4.11)-(4.12)、(4.18)-(4.19)、(4.23)-(4.24)，且假設入射
訊號為與(4.66)-(4.70)對應的(2.1)-(2.2)，可以得出 Fourier 頻域解。要將這
些頻域解取逆轉換，以得時域解時，發現如果導電率不為 0，其極點須以數值方
法解複數超越(Transcendental)方程式，相當麻煩。所以假設 0 ，但還是經
過繁複計算，導出 
 
 
 



 

 

 



  



 

 
)cos)(()cos)((
Re),(
]2/[
0
)cos)((
N
s
rinU
s
rinU
meeFxinE
N
m
s
rinmjj
m
ref
z
m
,     (4.75) 
 
x
dr  ,                (4.76) 
    

0c
xs ,               (4.77) 
 34
0 5 10 15 20 25 30 35 40 45 50
-0.03
-0.02
-0.01
0
0.01
0.02
0.03
n
te
m
po
ra
l r
es
po
ns
e
 
 
direct
analytic
continuous
 
圖 4-4. 2i 處，純介質層反射場隨時間的變化 
0 5 10 15 20 25 30 35 40 45 50
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
n
te
m
po
ra
l r
es
po
ns
e
 
 
direct
analytic
continuous
 
圖 4-5. 2i 處，純介質層穿透場隨時間的變化 
 36
0 5 10 15 20 25 30 35 40 45 50
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
n
te
m
po
ra
l r
es
po
ns
e
 
 
direct
analytic
 
圖 4-7. 2i 處，導電介質層穿透場隨時間的變化 
 
 另外值得觀察的是介質層中的 FDTD 方程式(4.30)究竟可以準確到什麼程
度。圖 4-8 及 4-9 分別顯示入射角 6/  ，介電係數 4r ，導電率 0 ，且
 cos/0  xcs ，輸入訊號為(4.84)(4.85)之時，在 1.0r (黑線)及
9.0r (紅線)，於 2i 的反射場及 2i 的穿透場。由圖可知， 9.0r 時，FDTD
的誤差較 1.0r 時明顯，但不算嚴重。 
 
 38
4.3 二維介質小圓柱 TM 散射問題之 Yee-FDTD 頻域解 
考慮一個自由空間中一個半徑為 a 之介質小圓柱的 TM 入射問題如圖 4-10，
其中介質圓柱在 z 方向無窮延伸，介電係數為 0 r 、導磁係數為0、導電率
為，由對稱性，可假設入射電磁場為 
)(),(
0c
xtExtE s
inc
z  , 0
9
/)(),( 
c
xtExtH s
inc
y  .       (4.86) 
 
圖 4-10. 二維介質小圓柱的斜向 TM 入射問題 
 在 ayx  22 的自由空間，散射電磁場所滿足的 Maxwell 方程式可化為 
 
t
E
cy
H
x
H scatz
scat
x
scat
y




0
00 1 ,           (4.87) 
 
t
H
cy
E scatx
scat
z


 0
0
1  ,             (4.88) 
 
t
H
cx
E scatyscatz


 0
0
1  .             (4.89) 
a 
x
 

y
 40
 ,0],
2
1[]
2
1,[],[ 2/1,0
2/1,
0
,   jiHsjiHsjiE nscatyixnscatxjynscatzn    
  )0,0(),( ji ,              (4.93) 
 
 0],[]
2
1,[ ,2/1,0   jiEsjiH nscatzjynscatxn , )1,0(),(),0,0(),(  jiji  (4.94) 
  
 ,0],[],
2
1[ ,2/1,0   jiEsjiH nscatzixnscatyn  )0,1(),(),0,0(),(  jiji  (4.95) 
 
 由 SF/TF 分割中，入射場與散射場之定義，可知各處均有 
 
 ],[],[],[ ,,, jiEjiEjiE nscatzninczntotz  ,          (4.96) 
 ]
2
1,[]
2
1,[]
2
1,[ 2/1,0
2/1,
0
2/1,
0   jiHjiHjiH nscatxnincxntotx  ,    (4.97) 
 ],
2
1[],
2
1[],
2
1[ 2/1,0
2/1,
0
2/1,
0 jiHjiHjiH
nscat
y
ninc
y
ntot
y    .    (4.98) 
此處入射場為求與 FDTD 相容[]，假設由 
 ,0],
2
1[],[ 2/1,0
,   jiHsjiE ninctyixninctzn           (4.99) 
 0]
2
1,[2/1,0  jiH nincx             (4.100) 
 ,0],[],
2
1[ ,2/1,0   jiEsjiH ninctzixnincyn         (4.101) 
計算，而非直接從(4.86)求得。顯然在 )0,0(),( ji 時，FDTD 方程式一樣由(4.29)
可寫為 
 
]0,0[1
2
1]0,0[1
2
1
],
2
1[]
2
1,0[]0,0[
,
00,
1,
00,
2/1,
0
2/1,
0
,
ntot
zravg
ntot
zravg
ntot
yix
ntot
xjy
ntot
zn
ErtcErtc
jHsHsE


 

 





 
                 (4.102) 
其 中
yx
a
yx
a
rravg 
22
, 1
 ，
yx
ar 
2 。 (4.93) 及 (4.102) 可 利 用
(4.99)-(4.101)合寫為 
 42
)z](0,0[
],[]1[
0
0
)z](0,0[
0
]1,[],[
0
0
0
)](0,0[)zz()z](0,0[z)
2
11(
)z](0,0[z)
2
11(
],[
)z](
2
1[
)z](
2
1,[
)z](,[
zz0
0zz
zz
2/12/12/1
00,
2/1
00,
0
0
2/12/1
2/12/1
2/12/1
inc
zx
inc
zy
inc
zzravg
zravg
y
x
z
ix
jy
ixjy
Es
jii
Esjiji
zEErtc
Ertc
ji
iH
jiH
jiE
s
s
ss







































































(4.108) 
 
 將(4.108)的第二、三列方程式，代入第一列方程式，可得 
  
 
)}z](0,0[)(
)z](0,0[)z1)(
2
11(
)z](0,0[)1z)(
2
11]{(,[
)z](0,0[],[)(
)z](,[})zz{(
22/12/1
1
00,
00,
22
2222/12/1
inc
z
zravg
zravg
inc
ziixjjy
ziixjjy
Ezz
Ertc
Ertcji
Ejiss
jiEss











     (4.109) 
 
由(3.6)可知 FDTD 二維 z域 Green 函式 )z](','|,[ jijiG 滿足 
  ]'[]'[)z1()z](','|,[)( 12222/12/1 jjiissjijiGsszz yxiixjjy     
                (4.110) 
利用(4.109)的線性性質，可求出 
 
 44
第5章 結論 
5.1 總結 
本計畫經過三年研究，已建立起以時-空差分方程及數位訊號處理原理分析
FDTD 數值方法的數位頻域技術，應用來解析一、二、三維的問題。一維問題，
包括自由空間與薄介質層斜向入射問題，得到時域的解析解，並在 z 域討論
Yee-ADI FDTD 混成網格穩定度。對二、三維問題，也巧妙利用偏差分算符，得
到了時域 FDTD Green＇s Function 及 Green＇s Dyadic Function，並討論其波
動傳播性質，均是前人未曾得到的新結果。其他尚有較零星之若干研究，但沒有
完整理想的結果。 
5.2 未來可繼續之研究 
本計畫開發的數位頻域技術可廣泛運用於各種 FDTD 問題之分析：例如目前
相當熱門的超穎物質(Meta Material)中的 FDTD 方法特性，新次網格方法如
Huygens Surface 方法的解析等。本計畫主持人已就一種新的 Yee-ADI 混成網
格，提出利用數位頻域技術分析其穩定度的方法，向國科會申請三年期專題研究
計畫，並已獲通過。 
5.3 研究成果自評 
本計畫原先申請時，主題為「電磁場問題時域數值解法之數位頻域分析理論
與應用:混成網格誤差計算及最佳吸收邊界條件設計」。因此其主軸為數位頻域理
論之建立，而其應用以混成網格之誤差計算及最佳吸收邊界條件為主。但經第一
年一維問題之嘗試，發現最佳吸收邊界設計與所用但不易決定之權重函數有關，
且實作結果不如傳統之 Mur 條件。同時發現混成網格由於不同網格邊界無法匹
配，甚難得到穩定結果，而其時尚未發現運用 Huygens Surface 的方法，因此第
二年改以二、三維之 FDTD Green＇s Function 及 Green＇s Dyadic Function
為主要研究方向，幸而得到不錯的成果，得以發表一篇 IEEE Transactions on 
Antennas and Propagation 上的期刊論文。第三年開始探討介電質存在時的問
題，對於一維薄介質層斜向入射問題已得滿意結果，可能可以發表一篇國際會議
論文。對於二維介質小圓柱的散射問題，雖然順利導出 z域解，但對應的數值計
算極為繁複，本計畫未能得到數值結果，進一步清楚指示出 FDTD 方法的穩定度，
只能留待未來繼續。就在第三年時，發現 Berenger 發明的 Huygens Surface(HSG)
 46
參考文獻 
[1] K. S. Yee, “Numerical solution of initial boundary value problems involving 
Maxwell’s equations in isotropic media,” IEEE Trans. Antennas Propagat., vol. 14, 
no. 3, pp. 302-307, 1966. 
[2] A. Taflove and S. C. Hagness, Computational Electrodynamics: The 
Finite-Difference Time-Domain Method, 2nd ed., Artech House, 2000. 
[3] T. Namiki, “A new FDTD algorithm based on alternating-direction implicit 
method,” IEEE Trans.Microwave Theory Tech., vol. MTT-47, no. 10, pp. 2003-2007, 
October 1999. 
[4] F. Zheng, Z. Chen, and J. Zhang, “Toward the development of a three-dimensional 
unconditionally stable finite-difference time-domain method,” IEEE Trans. 
Microwave Theory Tech., vol. MTT-48, no. 9, pp. 1550-1558, 2000. 
[5] G. Sun and C. W. Trueman, “Unconditionally stable Crank-Nicolson scheme for 
solving two-dimensional Maxwell’s equations,” Electronics Letters, vol. 39, no. 7, pp. 
595-597, 2003. 
[6] S. K. Jeng, “Time domain electromagnetic field computation with a semi-discrete 
scheme as an alternative to implicit FDTD methods, “2005 IEEE AP-S International 
Symposium and USNC/URSI National Science Meeting,Washington D.C., USA, 2005. 
[7] S. K. Jeng, “A semi-discrete scheme for computing two-dimensional 
electromagnetic field in time domain,” 2006 IEEE AP-S International Symposium and 
USNC/URSI National Science Meeting, Albuquerque, New Mexico, USA, 2006. 
[8] S. K. Jeng, “An analytical solution to Yee’s FDTD partial difference equations for 
a one-dimensional cavity problem via z-transform,” 2009 IEEE AP-S International 
Symposium and USNC/URSI National Science Meeting, Charleston, SC, USA, June 
2009. 
[9] S. K. Jeng, “An analytical solution to Yee’s FDTD partial difference equations for 
a one-dimensional propagation problem via z-transform,” unpublished manuscript, 
2009. 
[10] S. S. Cheng, Partial Difference Equations, London: Taylor and Francis, 2003. 
[11] A. Boag, U. Shemer, and R. Kastner, “Hybrid absorbing boundary conditions 
based on fast nonuniform grid integration for nonconvex scatterers,” Microwave and 
Optical Technology, vol. 43, pp. 102-106, October 2004. 
[12] J. P. Berenger, “A perfectly matched layer for the absorption of electromagnetic 
waves,” J. Comput. Phys. , vol. 114, pp. 185-200, 1994. 
[13] S. K. Jeng, “An analytical expression for 2-D FDTD-compatible Green’s 
 48
the Green’s function method (GFM) used as ABC for arbitrarily shaped boundaries,” 
IEEE Trans. Antennas Propagat., vol. 50, no. 4, pp. 1017-1029, 2002.  
[27] A. Taflove, M. Celuch-Marcysiak, and S. C. Hagness, “Local subcell models of 
fine geometric features,” Chapter 10, in A. Taflove and S. C. Hagness, Computational 
Electrodynamics: the Finite-Difference Time-Domain Method, 3rd ed., Boston:Artech 
House, 2005.  
[28] A. Taflove, G. Waldschmidt, C. Wagner, J. Schneider, and S. C. Hagness, 
“Incident wave source conditions,” Chapter 5, in A. Taflove and S. C. Hagness, 
Computational Electrodynamics: the Finite-Difference Time-Domain Method, 3rd ed., 
Boston:Artech House, 2005. 
[29] L. J. Slater, “Confluent hypergeometric functions,” Chapter 13, in M. 
Abramowitz and I. Stegun, Handbook of Mathematical Functions, New York:Dover, 
1965. 
[30] J. –P. Bérenger, “A Huygens subgridding for the FDTD method,” IEEE Trans. 
Antennas and Propagation, vol. 54, no. 12, pp.3797-3803, 2006. 
[31] J. –P. Bérenger, “Extension of the FDTD Huygens subgridding algorithm to two 
dimensions, “IEEE Trans. Antennas and Propagation, vol. 54, no. 12, pp.3860-3867, 
2009. 
[32] J. –P. Bérenger, “Three dimensional Huygens subgridding for FDTD,” 2009 IEEE 
AP-S International Symposium and USNC/URSI National Science Meeting, Charleston, 
SC, USA, 2009 
[33] Z. Huang and G. W. Pan, “A novel subgridding trchnique for unconditionally 
stable time domain methods,” 2010 IEEE AP-S International Symposium and 
USNC/URSI National Science Meeting, Toronto, Canada, July 2010. 
 
An Analytical Solution to Yee's FDTD Partial Difference Equations for
a One-Dimensional Cavity Problem via z-Transform
Shyh-Kang Jeng*(I)
(I) Department of Electrical Engineering and Graduate Institute of Communication
Engineering, National Taiwan University, Taipei, Taiwan
skjeng@ew.ee.ntu.edu.tw
Introduction
Yee's FDTD method [1] has been very popular for computational
electromagnetics. However, few authors attempted to solve the partial difference
equations in Vee's method analytically. To the author's knowledge, only a
frequency domain solution for propagation in homogeneous isotropic media (the
so-called numerical dispersion relation) was given before [2]. This paper
proposes a new analytical solution to Vee's FDTD partial difference equations for
aID cavity problem via z-transform. This solution enables us to identify
differences of the Vee scheme from the exact continuous wave solution easily.
Problem and Exact Solution
AID cavity with a free space between PEC walls at z =0 and z =L~ is excited
by a given x -directed electrical current density Jx(z,t) =l5(z-ko~)f(t)/TJ ,
where TJ is the intrinsic impedance of free space, l5(.) is the Dirac delta function,
f(t) = fo(t)- fo(t-T) (1)
is a pulse of duration T , with
00 2mnfo (t) =U(t)IFmcos(-t + t/Jm) (2)
m=O T
a periodic function with period T when t ~ 0, and U(t) the unit step function
defined as zero when t ~ o. The problem may be solved by taking the Laplace
transform with respect to time, solving the resultant transform domain ordinary
differential equation, and then taking the inverse Laplace transform. The final
sampled exact solution for the electric field is derived as
Ex(k~,ndt) =Etransient(k~,ndt)+Eresonant(k~,ndt), (3)
(4)
*Supported by Grant# NSC97-2221-E-002-143-MY3, National Science Council, Taiwan.
978-1-4244-3647-7/09/$25.00 ©2009 IEEE
R;[k] =[ARYee COS(QRYeen)+BRYee sin(QRyeen)]U(n-1 k-ko 1)-
, , , . ' (13)
[AR,Yee COS(QR,Yee (n - N)) + BR,Yee sIn(QR,Yee (n - N))]U(n - N -I k - ko I).
Here Kam,Yee =2sin-1(sin(mQa 12)1 s), QR,Yee =2sin-1(ssin(KR 12)). Notations
F and Al are defined by fn+1/2 = f((n + 112)lit) = I'n+1/2 _ I'n-N+1/2m,Yee 'f'm,Yee J 0 J 0
[NI2]
and fOn+1/ 2 = fo((n + 1/2)~t) =U(n +1/2) LFm,Yee cos(2mn(n +1/2)1 N +¢m,YeJ .
m=O
asdefinedareA and BR,Yee R,Yee
1 [NI2] .
At,Yee =4 ~Fm,Yee sm¢m,Yee {csc((Qt,Yee - mQa)/2)-csc((Qt,Yee + mQa)/2)},
(14)
1 [NI2]
Bt,Yee =4 ~Fm,Yee cos¢m,Yee {csc((Qt,Yee - mQa)/2) + csc((Qt,Yee + mQa)1 2)}.
(15)
Coefficient
Discussions
Comparing (3)-(7) and (10)-(15), we find that the solution to the Yee scheme and
the exact continuous wave solution are in a very similar form. That enables us to
identify the differences easily. For the transient parts (4) and (11), the major
differences are that the digital wave numbers, K am and K am,Yee' are different, and
the weight of each harmonic component differ by a factor
of2sin(mQa 12) I(ssin(Kam,Yee)) , resulting in more distortions on the transient
pulse. For the resonant parts, the fractional deviation of the digital resonance
. QRYee -QR sin-1(ssin(KR12)) .angular frequencIes equals' = - 1, whIch decreases
Q R sKR 12
with increasing L, and is zero when s =1. Besides, when s > 1, at least one
QR,Yee becomes complex, and instability occurs. This is consistent with the well-
known CFL instability criterion s > 1. The amplitude of each mode is also
different in (5) and (12), even when the Courant number equals 1. In addition, as
s is significantly smaller than 1, the arguments in the unit step functions in (4), (6)
and (11), (13) may be with noticeable differences.
Numerical Verification
(16)
Figure 1 displays the late time responses computed by exact solution (3)-(7), the
direct implementation of the Vee scheme, and the analytical solution (10)-(15),
for s =0.8, L =9 ,ko =4 , k =3. The excitation is specified by
10 15 ( t) 6 ( t) 1 ( t )I'(t)=---cos Q - +-cos 2Q - --cos 3Q -
Jo 32 32 a lit 32 a lit 32 a lit '
where Qa =21r 1N =1r120, Le., N =40 . The results by direct implementation
and by (10)-(15) are almost identical, but with observable difference from the
 54 
 
附錄 2. 未發表之一維自由空間傳播問題論文 
S. K. Jeng, “An analytical solution to Yee’s FDTD partial difference equations for a 
one-dimensional propagation problem via z-transform,” unpublished manuscript, 
2009 
 
> REPLACE THIS LINE WITH YOUR PAPER IDENTIFICATION NUMBER (DOUBLE-CLICK HERE TO EDIT) < 
 
2 
author’s knowledge. It is also well-known that the z-transform is 
more popular than the Fourier transform in digital signal 
processing, because for discrete signals the z-transform is more 
effective. Since the Yee’s partial difference equations are a set 
of space-time discrete signal processors, applying the 
z-transform is more natural. Besides, with z-transform many 
useful concepts and techniques in digital signal processing, such 
as digital angular frequency, FIR and IIR digital filters, 
treatment of discrete periodic signal, and stability analysis in 
z-domain, are readily applicable, which is very convenient.  
Though in this paper we deal with only a one-dimensional 
problem, which seems impractical compared with two- or 
three-dimensional problems, we can get some insights easier 
from the analytical solution, such as the causality, the stability, 
and effects of signal and resonance poles, to this simplified 
problem.  It can be regarded as the first step and a demonstration 
to a general framework of obtaining an analytical solution to 
partial difference equations, which enables us to verify and 
analyze the behaviors of their straightforward implementation.  
 
We start with a description of the problem in Section II.  Then 
derive the analytic solution via z-transform in Section III.  The 
causality and stability of the solution are discussed in Section IV 
and V, respectively.  The final expressions for the time domain 
solution are given in Section VI.  Section VII is with numerical 
results and discussions.  Finally, some conclusions will be 
drawn in Section VIII.  
 
II. PROBLEM 
Assume that the one-dimensional free space 
between 0=z and zLz ∆=  is uniformly discretized and 
governed by the Yee’s FDTD partial difference equations 
 { }]2/1[]2/1[][][ 2/12/11 −−+−= +++ kHkHskEkE nynynxnx ηη      (1) { }][]1[]2/1[]2/1[ 2/12/1 kEkEskHkH nxnxnyny −+−+=+ −+ ηη    (2)  
 
for Lk <<0 , where s  is the Courant number and η is the 
intrinsic impedance of free space.  Let the electric field at 0=k  
be enforced as a pulse of duration N and specified as 
 
Nnn
n
x ffE −−=]0[ ,                      (3) 
 
where 
 
∑
=


 +=
]2/[
0
2cos)(
N
m
mmn N
mnFnUf φπ                 (4) 
 
is a discrete-time periodic signal multiplied by the unit step 
function 1)( =nU  for 1≥n  and 0)( =nU for 0≤n .The 
notation [ ]2/N  is defined as 2/N for even N , and 
2/)1( −N for odd N .   For simplicity in later derivations, we 
assume a null initial condition 00 =f .   At Lk =  is placed the 
Mur’s 2nd-order absorbing boundary [2] 
 
{ }
{ } ].1[]1[][
1
2
][]1[
1
1][
1
111
−−−++
++−+
−=
−
−++
LELELE
s
LELE
s
sLE
n
x
n
x
n
x
n
x
n
x
n
x
             (5) 
 
III. ANALYTICAL SOLUTION VIA Z-TRANSFORM 
Define the z-transform with respect to n  for ][kEnx  and 
]2/1[2/1 ++ kH nyη  as 
 
∑∞
=
−=
0
z][)z]([
n
nn
xx kEkE                    (6) 
 
and 
 
∑∞
=
+−+ +=+
0
)2/1(2/1 z]2/1[)z](2/1[
n
nn
yy kHkH ηη ,          (7) 
 
respectively.  Note that the transform variable z is not italicized 
to be distinguished from the spatial coordinate z .   
 By taking the z-transform of (1)-(2), and using the null initial 
condition, we obtain a system of ordinary difference equations 
 { },)z](2/1[)z](2/1[z)z]([)1z( 2/1 −−+−=− kHkHskE yyx ηη     
                             (8) 
{ }.)z]([)z](1[z)z](2/1[)1z( 2/1 kEkEskH xxy −+−=+− η     (9) 
   
 Substituting the following discrete propagating wave 
assumptions 
 
k
x
k
xx EEkE ζζ −−+ +=)z]([ , 11 −≤≤ Lk  ,           (10)    
,10,)z](2/1[ 2/1)2/1( −≤≤+=+ +−+−+ LkHHkH kykyy ζηζηη   
                        (11) 
 
into (8)-(9), we obtain a characteristic equation 
 
( ) ( )22/12/1222/12/1 zz −− −=− ζζs             (12) 
 
and 
 
2/1)2/1()z](2/1[ +−+−+ −=+ kxkxy EEkH ζζη .        (13) 
 
The z-transform of boundary conditions (3) and (5) can also 
be derived as 
 ( )Nx FE −−= z1)z()z](0[                (14) 
> REPLACE THIS LINE WITH YOUR PAPER IDENTIFICATION NUMBER (DOUBLE-CLICK HERE TO EDIT) < 
 
4 
(16),(4), as well as the null initial condition 00 =f .  We may 
also derive  
 
12
10 z)z]([
−−→ kksfkE ,                  (31) 
 
from (26)-(28).  Thus, we may prove  
 
0zz
2
zz)z]([
2
1 2211
0 →→ ∫∫ ∞∞ −−− C kn
k
C
n d
j
sfdkE
j ππ       (32) 
 
as 0≤− kn .  Here ∞C is a circle with an infinite radius.  Since 
there is no singularities between C and ∞C , we infer that 
0][0 =kEn for kn ≤ , independent of s .  This causality differs 
from the one obtained by discretizing the continuous traveling 
wave solution, i.e. the field is zero for skn /≤ .  This is a 
fundamental difference of the solution to the Yee’s FDTD 
equations from the solution to the corresponding Maxwell 
equations, due to discretization. 
 
V. STABILITY 
For (25) to be a stable signal, all singularities of (26) must be 
inside the unit circle.  Assume that (4) is stable, and all 
singularities of )z(F are within or on the unit circle.  Since (26) 
involvesζ , which is with a radical through (29), we must check 
if the branch points 
 
( ) 12121z 222 −−±−= sss                 (33) 
 
are both inside or on the unit circle.  It is easy to show that 
when 1>s , both of sz  are real, and at least one of them is 
smaller than -1.  Thus ][0 kE
n  is unstable for the Courant number 
larger than 1, which is well-known.  In the following discussions, 
we assume 10 ≤< s .  In addition, when 2/1=s , the branch 
points are on the imaginary axis, whereas when s  is larger or 
smaller than 2/1 , but still positive and smaller than 1, the 
branch points are both located in the left or right half plane, 
respectively. 
Next, we need to observe the poles related to the zeros of 
)z(g)z(f + .  Because of the term L2ζ , zeros of )z(g)z(f +  is 
not easy to solve.  Even if they can be solved numerically, the 
results can not be used for a general proof of stability.  A 
theorem modified from the Rouche’s theorem [9] is thus 
required and given below: 
 
If arbitrary functions f(z) and g(z) are analytic inside and on 
a closed contour sC , and |)z(||)z(| gf > on almost every point 
on sC , except possibly on some small segments which 
contribute 0 to z
)z(
)z('
2
1 d
f
f
j sC∫π and z)z()z(
)z(')z('
2
1 d
gf
gf
j sC∫ +
+
π , 
then )z(f and )z()z( gf + has the same number of zeros 
inside sC . 
 
Let −+∞ ∪∪∪∪∪∪= CCCCCCCC HLs 12 εε  as depicted 
in Fig. 2, where LC and HC are parts of the unit circle, and 1zs , 
2zs (also on the unit circle) are the branch points defined in (33). 
By verifying 22 )z(g)z(f > on every leg of sC and using 
commercial software Mathematica to find that the zeros of 
)z(f are a triple root at z = 1, we can say that both of )z(f and 
)z(g)z(f + have no zeros inside sC .  In other words, 
)z(g)z(f + has no zeros outside the unit circle.  We can 
conclude thus that the Yee’s FDTD algorithm with the Mur’s 
2nd-order absorbing boundary for our 1D problem is stable for 
10 ≤< s and bounded excitation. 
 
∞C
LC
LC
HC
1z s
2zs
1εC
2εC
+C
−C
 
Fig. 2. Contour for proof of stability using modified Rouche’s 
theorem 
 
Note that on the unit circle Ω= jez , where π<Ω is the digital 
angular frequency, the corresponding propagation factor  
 
jKe=ζ ,                    (34) 


 Ω= −
2
sin1sin2 1
s
K ,               (35) 
 
which is the famous dispersion relation.  
When cΩ<Ω , sc 1sin2 −=Ω , (34) is a complex number of unit 
magnitude.  When π<Ω<Ωc , (35) is complex, and (34) 
becomes 
 
1
2
sin1
2
sin2
2
sin21 22
2
2 −ΩΩ−Ω−= sssζ ,       (36) 
 
a negative real number smaller than -1.  When cΩ=Ω , 1−=ζ .  
> REPLACE THIS LINE WITH YOUR PAPER IDENTIFICATION NUMBER (DOUBLE-CLICK HERE TO EDIT) < 
 
6 
 
( ) ( )( )
( ) ( )( ) }.sincos
sincos
{z 
,,
,,
1
kKnQkKnP
kKnQkKnP
esole residuresonant p
rr
k
ii
k
n





+Ω−+Ω+
−Ω−−Ω
=
−
−∑
ζ
ζ
ε
     (54) 
 
In (54), 
Ω= jezz is the  th zero of )z(g)z(f +  on the upper 
half z-plane or the real axis.  Its numerical value is obtained with 
the help of software Mathematica.  Notation ε  is defined to be 
1 when z  is real, and 2 when z  is with a non-zero imaginary 
part.  Propagation factor 
jKeζζ = is calculated by 
substituting z  into (29) (30).  Coefficients 
 
 PPPP ri −== ,, , ,                (55) 
 QQQQ ri −== ,, , ,               (56) 
( ) 





+
= Ω−
=



jeF
zz
d
dP )z(
)(g)(f
z
)z(f
Re
zz
,          (57) 
( ) 





+
= Ω−
=



jeF
zz
d
dQ )z(
)(g)(f
z
)z(f
Im
zz
,           (58) 
 
are also evaluated with the help of software Mathematica. 
 
C. Contour Integral around the Branch Cut 
The contour integral around the branch cut can be expressed 
as  
 
.z)z(}
)z](0[1
]0[
)z](0[1
]0[{
2
1
z)z(}
)z](0[1)z](0[1
{
2
1
1
1
dyF
dyF
cutBranchthearoundIntegralContour
n
ky
y
k
n
ky
y
k
s
s
s
s
−
−
−−
− +
++
−
−
−
−
− +
−
+
Γ+
Γ−Γ+
Γ+
Γ+−Γ+
=
∫
∫
ζζ
π
ζζ
π        (59) 
 
when the contributions from '1εC and '2εC  approach zero.  In 
(59), jyxs +=z , 221 sxs −= , 21 ss xy −=  from (33).  
Notations )z](0[±Γ and ±ζ  represent the reflection coefficient 
)z](0[Γ and the propagation factor ζ  evaluated on contour 
leg ±B , respectively.  Equation (59) is integrated numerically 
using direct Riemman sum. 
 
 In the special case that a branch point coincides with the mth 
signal pole, the contributions from '1εC and '2εC  are not 
ignorable.  By direct integration, as the radii of '1εC and '2εC  
approach zero, their total contribution 
is )sin()cos( kBkA mnmn πθπθ −−− , where 
 
( ) )2/(sin)2/(cos12
)2/(cos)12(21
2222
22
mmsL
msLkA
αα
α
Ω+Ω−
Ω−−= ,       (60) 
( ) )2/(sin)2/(cos12
)sin(
2222 mmsL
mksB
αα
α
Ω+Ω−
Ω= .      (61) 
 
VII. NUMERICAL RESULTS AND DISCUSSIONS 
Consider a rectangular pulse as the excitation signal 
 

 ≤≤=
otherwise
pn
E nx ,0
1,1
]0[ ,             (62) 
 
with Np < .  The corresponding discrete-time periodic signal 
starting at 0=n is put in the form of (4), with 
 



−≤≤
=
=
2
11,
)/sin(
)/sin(2
0,/
Nm
Nm
Nmp
N
mNp
Fm π
π ,           (63) 
 
2
10,)1( −≤≤+−= Nm
N
pm
m
πφ ,             (64) 
 
for odd N, and  
 
( )( )






=−+−
−≤≤
=
=
2
,11
2
1
1
2
1,
)/sin(
)/sin(2
0,/
Nm
N
Nm
Nm
Nmp
N
mNp
F
p
m π
π ,           (65) 
 



=
−≤≤+−=
2/,0
1
2
0,)1(
Nm
Nm
N
pm
m
π
φ ,          (66) 
 
for even N.  For numerical verification, take 40=N , 
10=p , 15=L . We will compare ]9[nxE  by the straightforward 
Yee’s FDTD algorithm and by (24) along with all related 
formulas proposed in this paper.  Figs. 4 and 5 show the early- 
and late-time responses for 8.0=s , respectively.  In these two 
figures we can see that both curves by the direct Yee’s FDTD 
implementation and the inverse z-transform approach overlap.  
The difference of causality between the continuous traveling 
solution and Yee’s FDTD scheme as derived in Section IV is 
very clear in Fig. 4.   Figs. 6 and 7 display the pole residue 
contributions in early time and late time, respectively.  
Obviously, the signal pole residues contribute most in early time, 
> REPLACE THIS LINE WITH YOUR PAPER IDENTIFICATION NUMBER (DOUBLE-CLICK HERE TO EDIT) < 
 
8 
0 5 10 15 20 25 30 35 40 45 50
-0.5
0
0.5
1
1.5
n
E
-F
ie
ld
 
 
Traveling Wave Sol.
Direct Yee's FDTD
Inverse z-Transform
 
Fig. 8. Early-time response for 2/1=s  
 
450 455 460 465 470 475 480 485 490 495 500
-0.025
-0.02
-0.015
-0.01
-0.005
0
0.005
0.01
0.015
0.02
0.025
n
E
-F
ie
ld
 
 
Traveling Wave Sol.
Direct Yee's FDTD
Inverse z-Transform
 
Fig. 9. Late-time response for 2/1=s  
 
0 5 10 15 20 25 30 35 40 45 50
-0.5
0
0.5
1
1.5
n
C
on
tri
bu
tio
ns
 
 
Signal Pole Res.
Resonance Pole Res.
Total
 
Fig. 10. Pole residue contributions for 2/1=s  in early time 
 
450 455 460 465 470 475 480 485 490 495 500
-0.025
-0.02
-0.015
-0.01
-0.005
0
0.005
0.01
0.015
0.02
0.025
n
C
on
tri
bu
tio
ns
 
 
Signal Pole Res.
Resonance Pole Res.
Total
 
Fig. 11. Pole residue contributions for 2/1=s  in late time 
 
VIII. CONCLUSIONS 
A new analytic solution to Yee’s partial difference equations 
for a one-dimensional propagation problem using z-transform 
and space-time discrete signal processing has been proposed.  
The causality and stability of the solution have also been 
rigorously derived and proved, respectively. Numerical results 
to the analytic solution have been found almost identical to 
those calculated by direct implementation of Yee’s FDTD 
scheme.  The early-time and the late-time responses to a pulse 
excitation have been identified related to signal poles and 
resonance poles, respectively, and the contribution from the 
contour integral around the branch cut is ignorable. 
 This approach may be extended to deal with 2D and 3D 
problems, though not very straightforward.  Some progress has 
been made, and hopefully can be reported in the near future. 
 
ACKNOWLEDGMENT 
The author wishes to thank Professor Weng Cho Chew for 
very constructive comments and Messrs. Yarn-Chen Chen, 
Der-Tzung Liu, and Yo-Chung Liu of Sunplus Technology 
Company for their support of music signal processing projects 
for many years and giving the author a chance to become more 
familiar with digital signal processing, which is useful to this 
study. 
  
REFERENCES 
[1] K. S. Yee, “Numerical solution of initial boundary value problems 
involving Maxwell’s equations in isotropic media,” IEEE Trans. 
Antennas Propagat., vol. AP-14, no. 3, pp. 302-307, May 1966. 
[2] A. Taflove and S. C. Hagness, Computational Electrodynamics: The 
Finite-Difference Time-Domain Method, 2nd ed., Boston, MA: Artech 
House, 2000. 
[3] R. Kastner, “A multidimensional inverse Z-transform evaluation of the 
discrete time domain Green’s function,” in Proc. IEEE Int. Symp. 
Antenna Propag., vol. 1A, pp. 110-113,  July, 2005.  
 64 
 
附錄 3. 2010 年發表於 IEEE-APS 之國際會議論文 
S. K. Jeng, “An analytical expression for 2-D FDTD-compatible Green’s function in 
infinite free space via z-transform and partial difference operators,” 2010 IEEE AP-S 
International Symposium and USNC/URSI National Science Meeting, Toronto, 
Canada, July 2010. 
Formulation 
 
Assume that all fields are null before and at 0=n , and define the z-transforms of  
],[ jiE nz , ]2
1,[2/1 ++ jiH nxη , ],2
1[2/1 jiH ny +
+η , and ],[2/1 jiJ nz +η  as ∑∞
=
−
=
0
z],[)z](,[
n
nn
zz jiEjiE , 
)2/1(
0
2/1 z]
2
1,[)z](
2
1,[ +−
∞
=
+∑ +=+ n
n
n
xx jiHjiH ηη , )2/1(
0
2/1 z],
2
1[)z](,
2
1[ +−
∞
=
+∑ +=+ n
n
n
yy jiHjiH ηη , and 
2/1)2/1(
0
2/1 z],[z],[)z](,[ −+−
∞
=
+
ΔΔ
Δ
==∑ jiyx
tcjiJjiJ n
n
n
zz δηη , respectively.  Taking the z-
transforms of (1)-(3) leads to 
{ } 0)z](,[)z](1,[)z](
2
1,[)1z( =−+++− jiEjiEsjiH zzyxη ,                       (4) 
{ } 0)z](,[)z](,1[)z](,
2
1[)1z( =−+−+− jiEjiEsjiH zzxyη ,                     (5) 
],[)z](
2
1,[)z](
2
1,[z
)z](,
2
1[)z](.
2
1[z)z](,[)1z(
2/1
2/1
jissjiHjiHs
jiHjiHsjiE
yxxxy
yyxz
δηη
ηη
−⎭⎬
⎫
⎩⎨
⎧
−−+
−⎭⎬
⎫
⎩⎨
⎧
−−+=−
.           (6) 
Substitute (4)(5) into (6), and obtain 
( ) ( ) ],[z1)z](,[)z](,[)z](,[zz 12222/12/1 jissjiEsjiEsjiE yxzjjyziixz δ−− −−=Δ∇+Δ∇+− .             (7) 
Here iΔ  and i∇  are the forward and the backward partial finite difference 
operators with respect to the spatial index i . They are defined as 
)z](,[)z](,1[)z](,[ jiEjiEjiE zzzi −+=Δ  and )z](,1[)z](,[)z](,[ jiEjiEjiE zzzi −−=∇ , 
respectively.  With similar definitions, jΔ  and j∇  are the forward and the 
backward partial difference operators for the spatial index j .  Further, we may 
derive  
)z](,1[)z](,[2)z](,1[)z](,[ jiEjiEjiEjiE zzzzii −+−+=Δ∇ ,            (8) 
)z](1,[)z](,[2)z](1,[)z](,[ −+−+=Δ∇ jiEjiEjiEjiE zzzzjj .            (9) 
Equation (7) may be put into the form of 
( ){ } ( ) ],[z1)z](,[zz 12222/12/1 jissjiEss yxzjjyiix δ−− −−=Δ∇+Δ∇+− .         (10) 
Symbolically we may solve )z](,[ jiEz  as 
( ){ } ( ) ],[z1zz)z](,[ 112222/12/1 jissssjiE yxjjyiixz δ−−− −Δ∇+Δ∇+−−= .         (11) 
The operator theory in [5] allows us to expand 
( ){ } ( ) ( ) ( )
( ) ( ) ( )
( ) ( ) ( )
)()(22
0 0
222/12/1
0
22/12/1
2
22/12/1
2
22/12/1
1
22/12/1
2
22/12/1
2
22/12/1
1
2222/12/1
zz
1
zzzz
zz
zzzz
1zzzz
AAAA
A A
−
−
∞
= =
+
−
∞
=
−−
−
−
−
−−
−
−
−
−
Δ∇Δ∇⎟⎟⎠
⎞
⎜⎜⎝
⎛
−
=
⎟⎟⎠
⎞
⎜⎜⎝
⎛
−
Δ∇
+
−
Δ∇
−=
⎪⎭
⎪⎬
⎫
⎪⎩
⎪⎨
⎧
⎟⎟⎠
⎞
⎜⎜⎝
⎛
−
Δ∇
+
−
Δ∇
+−=Δ∇+Δ∇+−
∑ ∑
∑
m
jjii
m
yx
m
m
m
m
m
jjyiix
jjyiix
jjyiix
ss
m
ss
ssss
, (12) 
where ⎟⎟⎠
⎞
⎜⎜⎝
⎛
A
m represents a binomial coefficient. 
Conclusions 
 
An analytical expression for the 2-D DGF has been derived via the z-transform 
and partial difference operators.  From the resultant expressions and the computed 
results, we found that the DGF is pretty different from the corresponding 
continuous Green’s function.  Extension of this approach to the 3-D case is under 
way, and will be reported in the near future. 
 
References 
 
[1] R. Holtzman and R. Kastner, "The time-domain discrete Green's function 
method (GFM) characterizing the FDTD grid boundary," IEEE Trans. 
Antennas Proagat., vol. 49, pp. 1079-1093, 2001. 
[2] R. Holtzman, R. Kastner, E. Heyman, and R. W. Ziolkowski, "Stability 
analysis of the Green's function method (GFM) used as an ABC for arbitrarily 
shaped boundaries," IEEE Trans. Antennas Proagat., vol. 50, pp. 1017-1029, 
2002. 
[3] R. Kastner, "A multidimensional z-transform evaluation of the discrete finite 
difference time domain Green's function," IEEE Trans. Antennas Proagat., 
vol. 54, pp. 1215-1222, April 2006. 
[4] J. Vazquez and C. G. Parini, "Discrete Green's function formulation of FDTD 
method for electromagnetic modelling," Electronics Letters, vol. 35, pp. 554-
555, 1999. 
[5] S. S. Cheng, Partial Difference Equations. London: Taylor and Francis, 2003, 
pp. 121-124. 
[6] W. C. Chew, Waves and Fields in Inhomogeneous Media. New York: Van 
Nostrand Rhinhold, 1990, p. 219.  
40 45 50 55 60 65
-0.04
-0.03
-0.02
-0.01
0
0.01
0.02
0.03
0.04
n
te
m
po
ra
l r
es
po
ns
e
 
 
direct
analytic
continuous
       
Fig. 1. Early response of the 2-D discrete Green’s function computed by direct 
implementation of FDTD and analytic expressions (both results are overlapped), 
compared with the continuous Green’s function.  
IEEE TRANSACTIONS ON ANTENNAS AND PROPAGATION, VOL. 59, NO. 4, APRIL 2011 1347
An Analytical Expression for 3-D Dyadic
FDTD-Compatible Green’s Function in
Infinite Free Space via z-Transform and
Partial Difference Operators
Shyh-Kang Jeng, Senior Member, IEEE
Abstract—FDTD solutions have their own properties distinct
from the discrete samples of corresponding continuous wave
solutions. Thus, the discrete equivalent to the Green’s function
is needed for applications like the one using a hybrid absorbing
boundary condition which couples the FDTD algorithm with inte-
gral operators for nonconvex scatterers. In this paper we propose a
new closed-form expression for the 3-D dyadic FDTD-compatible
Green’s function in infinite free space via a novel approach with
the ordinary z-transform along with the spatial partial difference
operators. The final expression involves a summation of standing
wave modes with time-varying coefficients. The propagation
of waves in the Yee’s grid can be interpreted by the selective
property of the time-varying coefficients, which is very different
from the conventional concept of a traveling wave. The traditional
dispersion analysis using plane waves for the FDTD algorithm in a
source-free region may not be applicable to explain the wave prop-
agation phenomenon through our analytic expression, because the
corresponding z-transform diverges for z on the unit circle.
Index Terms—FDTD methods, Green functions, operators
(mathematics), Z transforms.
I. INTRODUCTION
T HE need for an Yee’s FDTD compatible Green’s func-tion (also known as the discrete Green’s function) has
been identified by Kastner [1] and Vazquez and Parini [2]. In
[1] Kastner mentioned that Boag et al. proposed a hybrid ab-
sorbing boundary condition for nonconvex scatterers [3], which
couples FDTD and integral operators. Kastner argued that since
FDTD solutions have their own dispersion, anisotropy, and sta-
bility properties, applications coupling FDTD and integral op-
erators create the need to produce discrete equivalents to the in-
tegrator and the corresponding Green’s function. In fact, to link
the sources and the fields, a discrete dyadic Green’s function is
required. In [2], Vazquez and Parini pointed out that with a 3-D
discrete dyadic Green’s function convolving with currents, radi-
ation and scattering problems can be numerically solved on the
Yee’s grid avoiding absorbing boundary conditions, and sup-
Manuscript received May 17, 2010; revised August 10, 2010; accepted
November 07, 2010. Date of publication January 31, 2011; date of current
version April 06, 2011. This work was supported by the National Science
Council, Taiwan, under Grant NSC97-2221-E-002-143-MY3.
The author is with the Department of Electrical Engineering and Graduate
Institute of Communication Engineering, National Taiwan University, Taipei,
Taiwan (e-mail: skjeng@cc.ee.ntu.edu.tw).
Color versions of one or more of the figures in this paper are available online
at http://ieee.ieeexplore.org.
Digital Object Identifier 10.1109/TAP.2011.2109363
pressing free space nodes to save computer memory storage
requirements.
In the meantime, it seems that conventional analyses on the
essence of Yee’s FDTD algorithm are confined to plane wave
propagation in a source-free region [4]. Very few mathematical
analyses on the FDTD algorithm for problems with sources have
been done before [1], [5]–[9]. Thus an analytic expression for
the discrete dyadic Green’s function will provide some new in-
sights for the FDTD solutions to problems with sources.
In [1] Kastner derived 1-D and 3-D scalar discrete Green’s
functions using the multidimensional z-transform, but in the 3-D
case he can only get the temporal response for field points along
the axis. In [2] Vazquez and Parini obtained complicated ex-
pressions for 2-D and 3-D discrete Green’s functions by the
multidimensional z-transform in spatial domain and a technique
introduced by Boole. They later applied those expressions with
convolution to model antenna radiation in free space [8].
In this paper we will propose a new closed-form expression
for the 3-D discrete dyadic Green’s function in infinite free
space via a novel approach with the ordinary z-transform along
with the spatial partial difference operators. The partial differ-
ence operators have been widely used to deal with partial differ-
ence equations by mathematicians [10], but it is believed new to
combine the partial difference operators with the z-transform.
Similar approach has been applied by the author to obtain an
analytical expression for the 2-D discrete Green’s function in a
recent conference paper [9]. Finally, in this paper some numer-
ical results together with discussions on interesting phenomena
are also included.
II. PROBLEM
Consider an infinite free space excited by electric and mag-
netic current sources. The corresponding Yee’s FDTD equations
are
(1)
0018-926X/$26.00 © 2011 IEEE
JENG: ANALYTICAL EXPRESSION FOR 3-D DYADIC FDTD-COMPATIBLE GREEN’S FUNCTION IN INFINITE FREE SPACE 1349
and
(18)
where , and are the elec-
tric fields (7) due to the electric current sources
(19)
(20)
and
(21)
respectively, and , and
are the electric fields (7) due to the magnetic current sources
(10) in the form of (19)–(21), respectively. Notation
for , and for . Similarly, for
, and otherwise.
The magnetic discrete dyadic Green’s function can be defined
similarly, with suitable change of subscripts. They are related to
magnetic field (8) instead of electric field (7). Since the electric
field and the magnetic field are dual, we will deal with only the
electric discrete dyadic Green’s function in this paper.
V. FORMULATION
A. Yee’s FDTD Equations in z-Domain
Define the z-transform of (7)–(10) as
(22)
(23)
(24)
(25)
From these we can prove
(26)
(27)
Here we adopt the one-sided, instead of the two-sided z-trans-
form, because any FDTD program has to start from a certain
time index, and the initial conditions can be taken into consid-
erations in later discussions.
Taking the z-transform of (11)–(12), we achieve the Yee’s
FDTD equations in z-domain
(28)
(29)
For brevity, the dependence on the spatial indices has been
suppressed from herein. The initial fields can be absorbed into
equivalent sources in the z-domain
(30)
(31)
Using (30)–(31), we can express (28)–(29) as
(32)
(33)
B. z-Domain Discrete Dyadic Green’s Function
Substituting (33) into (32) leads to an equation involving only
the electric field in the z-domain
(34)
Here is the identity matrix and
(35)
The electric field can be obtained symbolically as
(36)
Taking the inverse matrix symbolically, we found with the help
of Mathematica
(37)
(38)
(39)
(40)
JENG: ANALYTICAL EXPRESSION FOR 3-D DYADIC FDTD-COMPATIBLE GREEN’S FUNCTION IN INFINITE FREE SPACE 1351
C. Time-Domain Discrete Dyadic Green’s Function
Taking the inverse z-transform of (45)–(47) and applying the
residue theorem with the contour in the region of convergence
of (45)–(47), which is outside of the unit circle and encloses
(55)
leads to the final analytical expressions for the three components
of
(56)
(57)
(58)
Here, for , and for .
The other components of the electric discrete
dyadic Green’s function (17) can be derived from
(56)–(58) by suitable rotation of subscripts
and corresponding summation indices . When
is reduced to the 2-D discrete-time Green’s function
derived in [9]. As both and approach infinity,
can
be reduced to a form identical with the 1-D special case, (34)
given in [1], with suitable changes of coordinate axes. The
final results (56)–(58) are also consistent with the analytical
expressions given in [2] by rearranging the polynomial terms
and summations (using Jacobi polynomials). However, our
results seem to be in a more compact form and may need
less computation than those in [2]. It is also found that
mutual cancellation of adjacent terms in (48)–(50) to speed up
calculation can not be carried out, because the powers of the
three Courant numbers are different in different terms.
VI. NUMERICAL RESULTS AND DISCUSSIONS
Fig. 1 shows the temporal responses for the discrete dyadic
Green’s function by (56)–(58) and by the direct implementation
of Yee’s FDTD algorithm. The parameters for the computation
are . The re-
sults by (56)–(58) overlap with those by direct implementation
of FDTD, confirming the validity of the analytical expressions.
Note that here (56)–(58) are computed by Mathematica, with
which the binomial and multinomial coefficients can be calcu-
lated accurately.
The discrete dyadic Green’s functions shown in Fig. 1 is
obviously different from the corresponding continuous dyadic
Fig. 1. Temporal responses of the 3-D discrete dyadic Green’s function com-
puted by direct implementation of FDTD and analytic expressions (overlapped).
Green’s functions sampled at the Yee nodes and the time ,
after dividing by
(59)
(60)
(61)
where is the unit step function, is the Dirac’s
delta function, and is the derivative of . Also
in these equations , and are
the azimuthal and polar angles for the spherical co-
ordinates corresponding to the Cartesian coordinates
, and
, respectively, with respect to
. Notations and stand for the normal-
ized distances
(62)
(63)
JENG: ANALYTICAL EXPRESSION FOR 3-D DYADIC FDTD-COMPATIBLE GREEN’S FUNCTION IN INFINITE FREE SPACE 1353
Fig. 3. Spatial distribution of the magnitude of       in dB for  
on the plane   .
Fig. 4. Spatial distribution of the magnitude of       in dB for  
on the plane   .
Figs. 3 to 5 exhibit the spatial distribution of the magnitudes
of the standing wave mode in dB for with
by (48)–(50) on the plane . Note
that the numerical results have a very large dynamic range, and
are better presented by the magnitude in dB, ignoring the fast
changing signs. Besides, magnitudes less than are set to
be dB. We may see that the boundaries of the modes are in
a rhombus-like shape. This can be explained by that (48)–(50)
are zero when , and , respectively.
These conditions are corresponding to regions with the Man-
hattan-like distances from the source to the field point being
smaller than a threshold. Obviously, modes with larger index
will occupy larger areas. Note also that the Manhattan-like
distance is a more natural measure of distance for the Yee’s grid
than the Euclidean distance.
Fig. 5. Spatial distribution of the magnitude of       in dB for  
on the plane   .
Fig. 6. Modal coefficients 

 
	 in dB for various  (horizontal axis) and
 (vertical axis).
Though (56)–(58) are in terms of the standing wave modes,
the disturbance can still propagate outward. The reason may be
obtained by observing the temporal modal coefficients in dB
plotted in Fig. 6. From the figure, we see that for a given (the
horizontal axis), the coefficients will pick out the
modes whose modal index (the vertical axis) approximately
satisfies . Thus when increases, the
selected mode will be also with an increasing , which corre-
sponds to a standing wave mode distributed in a larger area, and
the disturbance spreads out.
The wave propagation phenomenon may be observed fur-
ther by calculating the time responses (56)–(58), for a larger
JENG: ANALYTICAL EXPRESSION FOR 3-D DYADIC FDTD-COMPATIBLE GREEN’S FUNCTION IN INFINITE FREE SPACE 1355
Fig. 11. CPU time required for generating the discrete Green’s function (56)
and for doing the discrete convolution in (68) from   = 0 to the upper limit
shown on the horizontal axis. Here        .
is about . Using Mathematica 7 on that com-
puter, binomial coefficients such as one million choose half mil-
lion can be calculated almost instantly, ten million choose five
million is computed within two seconds, and one hundred mil-
lion choose fifty million have been obtained in about five min-
utes; however, one trillion choose five hundred million cannot
be evaluated because of insufficient memory. Fig. 11 displays
the CPU time required for generating a component of the dis-
crete dyadic Green’s function (56) and for direct implementa-
tion of the discrete convolution. This log-log diagram shows
that the slopes for the CPU time to generate (56) and to com-
pute convolution are around 2.43 and 1.76, respectively, when
, the upper limit of for computation, is large. Thus the com-
plexities are about and for generating the discrete
dyadic Green’s functions and for doing the discrete convolu-
tion, respectively. We thus claim that accurate numerical results
for (68)–(70) as is around several thousand can be obtained,
though we stopped at , because of the long computing
time expected. A possible way to speed up the computation
might be using the approximate approach of applying a window
introduced in [8].
VII. CONCLUSION
A new analytical expression for the 3-D FDTD-compatible
dyadic Green’s function in infinite free space has been derived
using z-transform and spatial partial difference operators. The
final expression involves a summation of standing wave modes
with time-varying coefficients. The propagation of waves in the
Yee’s grid can be explained by the selective property of the
time-varying coefficients, which is very different from the con-
ventional concept of a traveling wave. Results of the traditional
dispersion analysis using plane waves for the FDTD algorithm
in a source-free region may not be applicable to interpret our an-
alytic expression, because the z-transform corresponding to our
expression diverges for z on the unit circle. A discrete equiva-
lent of the Stratton-Chu integral formula may be derived next for
developing a hybrid absorbing boundary condition. The z-trans-
form and operator approach is possible to be utilized to find the
discrete dyadic Green’s function in domains like an infinite rect-
angular waveguide, but taking the inverse z-transform will be
more involved.
ACKNOWLEDGMENT
The author wishes to thank Prof. S. S. Cheng at the National
Tsing Hua University, Taiwan, for the suggestion of using the
operator theory to solve partial difference equations. In addition,
very helpful and inspiring comments for improving the man-
uscript from the anonymous reviewers are much appreciated.
Thanks are also given to Dr. N. Lariviere and Dr. P. Mokhasi,
Technical Support, Wolfram Research, Inc., for providing in-
formation on the representation of large integers and the limit
of arbitrary-precision arithmetic in Mathematica.
REFERENCES
[1] R. Kastner, “A multidimensional z-transform evaluation of the discrete
finite difference time domain Green’s function,” IEEE Trans. Antennas
Propag., vol. 54, pp. 1215–1222, Apr. 2006.
[2] J. Vazquez and C. G. Parini, “Discrete Green’s function formulation of
FDTD method for electromagnetic modelling,” Electron. Lett., vol. 35,
pp. 554–555, 1999.
[3] A. Boag, U. Shemer, and R. Kastner, “Hybrid absorbing boundary con-
ditions based on fast nonuniform grid integration for nonconvex scat-
terers,” Microw. Opt. Technol., vol. 43, pp. 102–106, Oct. 2004.
[4] A. Taflove and S. C. Hagness, Computational Electrodynamics: The Fi-
nite-Difference Time-Domain Method, 2nd ed. Boston, MA: Artech
House, 2000, ch. 4.
[5] R. Holtzman and R. Kastner, “The time-domain discrete Green’s func-
tion method (GFM) characterizing the FDTD grid boundary,” IEEE
Trans. Antennas Propag., vol. 49, pp. 1079–1093, 2001.
[6] R. Holtzman, R. Kasrner, E. Heyman, and R. Ziolkowski, “Stability
analysis of the Green’s function method (GFM) used as an ABC for
arbitrarily shaped boundaries,” IEEE Trans. Antennas Propag., vol. 50,
pp. 1017–1029, 2002.
[7] N. Rospsha and R. Kastner, “Closed form FDTD-compatible Green’s
function based on combinatorics,” J. Computat. Phys., vol. 226, pp.
798–817, 2007.
[8] J. Vazquez and C. G. Parini, “Antenna modeling using discrete Green’s
function formulation of FDTD method,” Electron. Lett., vol. 35, pp.
1033–1034, 1999.
[9] S. K. Jeng, “An analytical expression for 2-D FDTD-compatible
Green’s function in infinite free space via z-transform and partial
difference operators,” presented at the IEEE Antennas Propag. Soc.
Int. Symp., Toronto, Ontario, Canada, Jul. 11–17, 2010.
[10] S. S. Cheng, Partial Difference Equations. London, U.K.: Taylor and
Francis, 2003.
Shyh-Kang Jeng (M’86–SM’98) received the
B.S.E.E. and the Ph.D. degrees from National
Taiwan University, Taipei, Taiwan, in 1979 and
1983, respectively.
In 1981, he joined the faculty of the Department of
Electrical Engineering, National Taiwan University,
where he is now a Professor. Between 1985 and 1993,
he was a Visiting Research Associate Professor and
a Visiting Research Professor with the University of
Illinois, Urbana-Champaign. In 1999, he visited the
Center for Computer Research in Music and Acous-
tics, Stanford University, Stanford, CA, for six months. His research interest
includes time-domain electromagnetic field computation techniques, antenna
design, multimedia signal processing, computational neuroscience, and com-
putational cognitive neuroscience.
Dr. Jeng is a recipient of the 1998 Outstanding Research Award of National
Science Council and the 2004 Outstanding Teaching Award of National Taiwan
University.
Rediscovering Stability Criterion of Yee’s FDTD 
Scheme for One-Dimensional Infinite Homogene-
ous Conductive Space Using a Multidimensional 
Signal Processing Theorem 
#Shyh-Kang Jeng1,  
1 Department of Electrical Engineering and Graduate Institute of Communication Engineering 
National Taiwan University, Taipei, Taiwan, skjeng@cc.ee.ntu.edu.tw 
 
 
 
Abstract 
 The Yee’s FDTD method for homogeneous conductive space is treated as a nonsymmetric 
half-plane (NSHP) support filter.  Its stability criterion is established from a modified multidimen-
sional signal processing theorem.  The result agrees with that obtained by the von Neumann’s 
method. This new approach may be extended for other FDTD-like methods. 
 
Keywords : Stability, FDTD methods, Multidimensional signal processing, NSHP filters 
 
1. Introduction 
 
The FDTD method [1][2] and its variations have been widely used.  The stability of these 
methods are often analyzed using von Neumann’s method [3][4].  On the other hand, these numeri-
cal schemes can be also viewed from a new aspect as space-time digital signal processing.  Their 
stability should be consistent with the stability criteria used in multidimensional signal processing.  
This paper is to show that the stability criteria for the 1-D Yee’s FDTD methods for homogeneous 
conductive space [5] can be rediscovered from the stability criteria for nonsymmetric half-plane 
(NSHP) support filters developed by Ekstrom and Woods [6][7] in multidimensional signal process-
ing. 
 
Many stability criteria for multidimensional signal processing have been proposed [7]; how-
ever, most of them deal with filters which are causal in all dimensions, such as the criteria based or 
generalized on theorems proposed by Shanks et al. [8] or Huang [9], and the criteria for N-
dimensional filters by Justice and Shanks [10].  It will be shown in this paper that the space-time 
filter corresponding to Yee’s FDTD method for 1-D conductive space cannot be put in standard ra-
tional forms, which are necessary to apply the stability criterion for filters causal in all dimensions. 
 
In addition, all the stability criteria in digital signal processing treat the condition that the 
poles of the multidimensional z-transform of the system transfer functions are on the unit circle as a 
cause of instability.  However, the von Neumann’s method regards its equivalent condition as stable 
in numerical analysis, since the field will not grow in this case. We will introduce the concept of 
exponential stability such that results obtained via multidimensional signal processing theorems can 
be consistent with the von Neumann’s method. 
 
This paper starts with the introduction of the stability criteria for NSHP support filters in 
Section 2.  Then we introduce the concept of exponential stability and modify the stability criteria 
for NSHP support filters in Section 3.  The modified criteria are then applied to rediscover the sta-
bility criteria of Yee’s FDTD for 1-D homogeneous conductive space, in Sections 4, respectively.  
Finally, the conclusion will be given in Section 5. 
 
2. Stability Criteria for NSHP Support Filters 
 
Take the two-dimensional z-transform of (2) and (3), we can solve 
 
)
2
1(z)1(2z)
2
1(
2
1z1z
)(
)z,(
)z,(H
2
2
2
0




tszt
t
E
E
x
x



 



.                                                                       (6) 
where, k
k
xx kEE


 
0
00 ][)( .  Since 1),(H  , stability criterion (a’) is satisfied.  
 
Next, we check criterion (b’) by considering )z,(H jKe  and find that the poles satisfy 
0
2
1z)21(2z
2
1 22 

 

  
tt ,                                                                                       (7) 
where 
2
sin 2
2
2 Ks

  , and (7) is identical with the stability polynomial equation obtained via the 
von Neumann’s method in [5].   
 
      The properties of the roots of (7) depend on the discriminator   1
2
21
2
22 

  
t  .  When  
(i) 1
2

t  or  
(ii) 1
2

t with 
2
2
11
2
2


 
 
t
 or 
2
2
11
2
2


 
 
t
, 
 
the discriminator is larger than or equal to zero, and  (7) will have two real roots  , .  To satisfy 
criterion (b’), we need 1,1   , which leads to 22   ,    011   ,    011   , 
and results in  41
2 t , 02  , 12  , respectively.  On the other hand, when 1
2

t with 
2
2
11
2
2
11
2
2
2


 



  
tt
, the discriminator is negative.  The roots will be a complex 
conjugate pair, such as  j , with  ,  real.  To satisfy criterion (b’), we re-
quire    122   jj , i.e., 1
2
1
2
1
0 




t
t
, which is always true under the assumption of 
1
2
0  
t .   
 
      By combining all the above stability requirements, we achieve a single condition, 10 2  .  
Since
2
sin 2
2
2 Ks

  , and   K , we have  s0 , which is just the stability requirement 
for the Courant number in an infinite dielectric space without conductive loss.  This result is also 
consistent with that given in [5]. 
 
5. Conclusions 
 
參加 
2011  
國際天線與傳播研討會 
（2011 International 
Symposium on Antennas 
and Propagation,  
ISAP 2011） 
報告 
 
 
 
 
鄭士康 
台大電機系/電信研究所 
中華民國一百年十一月十一日 
multidimensional signal processing theorem”，為國科會三年期計畫<<電磁場問題
時域數值解法之數位頻域分析理論與應用:混成網格誤差計算及最佳吸收邊界條
件設計>>之第三年部份成果。論文發表於十月二十八日下午之海報論文場次(圖
1)，為會中絕無僅有之純數值理論論文。雖屬冷門，也有三位出席者甚有興趣，
討論頗久。本人之論文利用數位訊號處理的定理，證明一維均質有損介質空間
FDTD 偏差分方程式之穩定條件與傳統 Neumann 方法所得結果相同，但本人方
法結合數值電磁理論與數位訊號處理，另有特色。 
 
 另外，於十月二十六日下午，接受大會邀請，擔任 Wireless Energy 
Transmission 之 Session Chair。此一 Session 共有四篇論文，分別由日本、韓國之
研究生發表。本人雖沒有做過無線電能傳輸之研究，但曾讀過 MIT 的相關論文，
因此有一點觀念。參加的聽眾不少，幾乎坐滿約五十個座位。發表的論文有實驗，
也有理論分析，主講人英文報告都沒有問題，但是都沒法以英文回應聽眾的問
題。我一方面將問題解釋得清楚一些，一方面引導主講人回答問題。此外，我對
每一篇論文均詢問實際傳送的功率有多少，能否有實際應用，主講人都無法回
答。會後若干主講人之指導教授找我，並稱我的問題很重要，之前沒有想過。有
些聽眾之後碰到我聊起，還以為我的研究領域就是 Wireless Energy Transmission。 
 
    在所聽的 Plenary Talk 及論文發表方面，印象較深刻的論文，簡單介紹如下： 
 
1. 韓國三星公司的研發副總Austin Kim，以“Antenna Technology Trends of 
Mobile Device“為題發表Plenary Talk。提到未來手持裝置之天線必需涵括更廣
的頻帶、縮小更多的尺寸、減少更多外在環境如金屬外框與人體干擾的影響。
趨勢為彈性、透明、抗雜訊。Q&A時，Prof. R. Mittra詢問為何天線設計人員
不能早期參與設計，而必須在其它設計完成後，再於極少的空間中去設計天
線。Kim回答通常認為天線為類比裝置，其設計較有彈性，因此都最後才加
入規劃。此外，Kim也提到熱門的超穎物質(meta material)，一般認為可以減
小天線尺寸，但據他們經驗，由於空間不足，超穎物質的週期性結構表現不
易，因此手持裝置上，利用超穎物質之天線並不成功。Mittra教授應已年過七
旬，但滿頭黑髮(也許是染的)，行動敏捷，思考發言銳利有條理，問問題常
切中要害，完全不顯老態；而且每年都到各地參加會議，叫人好生佩服。 
2. 日本的Y. Wakabayashi等人提出在FDTD方法中，以片段線性遞迴摺積方法
(piecewise linear recursive convolution technique)，分析金屬光柵的斜向入射問
題。結果似乎還不錯，但Prof. R. Mittra指出應用FDTD於斜向入射問題較困難
之處，在於時距須隨入射角之增加而減小，與我的研究相符合。  
3. 日本的R. Hasaba與M. Hara由名教授M. Ando指導，發展出開口空腔之雷達截
面積(Radar Cross Section，RCS)的新計算方法：反覆利用物理光學(Physical 
Optics)可以求得較準確數值。但論文報告中只應用到開口矩形空腔，而每次
準的基礎研究。出席者的英文討論能力，也較 IEEE APS Symposium 的參加者遜
色。 
 
 
四、結語 
 
感謝國科會於計劃中補助敝人參與此一會議，得以發表一己研究所得，並了
解亞太地區電磁研究之最新情況。 
 
 
圖 1. 台科大馬自莊教授在海報發表會場為作者所拍的相片 
 
 
 
 
Rediscovering Stability Criterion of Yee’s FDTD 
Scheme for One-Dimensional Infinite Homogene-
ous Conductive Space Using a Multidimensional 
Signal Processing Theorem 
#Shyh-Kang Jeng1,  
1 Department of Electrical Engineering and Graduate Institute of Communication Engineering 
National Taiwan University, Taipei, Taiwan, skjeng@cc.ee.ntu.edu.tw 
 
 
 
Abstract 
 The Yee’s FDTD method for homogeneous conductive space is treated as a nonsymmetric 
half-plane (NSHP) support filter.  Its stability criterion is established from a modified multidimen-
sional signal processing theorem.  The result agrees with that obtained by the von Neumann’s 
method. This new approach may be extended for other FDTD-like methods. 
 
Keywords : Stability, FDTD methods, Multidimensional signal processing, NSHP filters 
 
1. Introduction 
 
The FDTD method [1][2] and its variations have been widely used.  The stability of these 
methods are often analyzed using von Neumann’s method [3][4].  On the other hand, these numeri-
cal schemes can be also viewed from a new aspect as space-time digital signal processing.  Their 
stability should be consistent with the stability criteria used in multidimensional signal processing.  
This paper is to show that the stability criteria for the 1-D Yee’s FDTD methods for homogeneous 
conductive space [5] can be rediscovered from the stability criteria for nonsymmetric half-plane 
(NSHP) support filters developed by Ekstrom and Woods [6][7] in multidimensional signal process-
ing. 
 
Many stability criteria for multidimensional signal processing have been proposed [7]; how-
ever, most of them deal with filters which are causal in all dimensions, such as the criteria based or 
generalized on theorems proposed by Shanks et al. [8] or Huang [9], and the criteria for N-
dimensional filters by Justice and Shanks [10].  It will be shown in this paper that the space-time 
filter corresponding to Yee’s FDTD method for 1-D conductive space cannot be put in standard ra-
tional forms, which are necessary to apply the stability criterion for filters causal in all dimensions. 
 
In addition, all the stability criteria in digital signal processing treat the condition that the 
poles of the multidimensional z-transform of the system transfer functions are on the unit circle as a 
cause of instability.  However, the von Neumann’s method regards its equivalent condition as stable 
in numerical analysis, since the field will not grow in this case. We will introduce the concept of 
exponential stability such that results obtained via multidimensional signal processing theorems can 
be consistent with the von Neumann’s method. 
 
This paper starts with the introduction of the stability criteria for NSHP support filters in 
Section 2.  Then we introduce the concept of exponential stability and modify the stability criteria 
for NSHP support filters in Section 3.  The modified criteria are then applied to rediscover the sta-
bility criteria of Yee’s FDTD for 1-D homogeneous conductive space, in Sections 4, respectively.  
Finally, the conclusion will be given in Section 5. 
 
2. Stability Criteria for NSHP Support Filters 
 
Take the two-dimensional z-transform of (2) and (3), we can solve 
 
)
2
1(z)1(2z)
2
1(
2
1z1z
)(
)z,(
)z,(H
2
2
2
0




tszt
t
E
E
x
x



 



.                                                                       (6) 
where, k
k
xx kEE


 
0
00 ][)( .  Since 1),(H  , stability criterion (a’) is satisfied.  
 
Next, we check criterion (b’) by considering )z,(H jKe  and find that the poles satisfy 
0
2
1z)21(2z
2
1 22 

 

  
tt ,                                                                                       (7) 
where 
2
sin 2
2
2 Ks

  , and (7) is identical with the stability polynomial equation obtained via the 
von Neumann’s method in [5].   
 
      The properties of the roots of (7) depend on the discriminator   1
2
21
2
22 

  
t  .  When  
(i) 1
2

t  or  
(ii) 1
2

t with 
2
2
11
2
2


 
 
t
 or 
2
2
11
2
2


 
 
t
, 
 
the discriminator is larger than or equal to zero, and  (7) will have two real roots  , .  To satisfy 
criterion (b’), we need 1,1   , which leads to 22   ,    011   ,    011   , 
and results in  41
2 t , 02  , 12  , respectively.  On the other hand, when 1
2

t with 
2
2
11
2
2
11
2
2
2


 



  
tt
, the discriminator is negative.  The roots will be a complex 
conjugate pair, such as  j , with  ,  real.  To satisfy criterion (b’), we re-
quire    122   jj , i.e., 1
2
1
2
1
0 




t
t
, which is always true under the assumption of 
1
2
0  
t .   
 
      By combining all the above stability requirements, we achieve a single condition, 10 2  .  
Since
2
sin 2
2
2 Ks

  , and   K , we have  s0 , which is just the stability requirement 
for the Courant number in an infinite dielectric space without conductive loss.  This result is also 
consistent with that given in [5]. 
 
5. Conclusions 
 
國科會補助計畫衍生研發成果推廣資料表
日期:2011/11/11
國科會補助計畫
計畫名稱: 電磁場問題時域數值解法之數位頻域分析理論與應用:混成網格誤差計算及最
佳吸收邊界條件設計
計畫主持人: 鄭士康
計畫編號: 97-2221-E-002-143-MY3 學門領域: 電磁
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
無 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
