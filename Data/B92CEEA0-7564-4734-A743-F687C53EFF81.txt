3(primary immune response)將被活化 (activate)，接
著，這個適應性 IS 會產生大量的的抗原特異性抗
體(antibodies, Abs)以消滅此入侵的 Ag，在這個 Ag
清除後，部分的 Abs會繼續存在，而此抗原特異性
B細胞則會成為記憶 B細胞(memory B-cells)。對於
已遭遇過的 Ags，這些記憶 B細胞起作用於較初次
免疫反應更快與更強烈的二次免疫反應 (secondary
immune response)。圖一為人類的 IS圖示，詳細的
步驟依該圖說明如下：
步驟一：抗原辨識
在 Ag 的表面具有多個抗原決定位 (epitopes)，
這些抗原決定位可被多種 Abs 所辨識。如果一個
Ag之前已經與 Abs遭遇過，則記憶 B細胞將被活
化成為分泌大量用以消滅入侵 Ag 的抗原特異性
Abs的漿細胞(plasma cells)。然而，如果一個 Ag完
全是新的，則到步驟二。
步驟1
步驟2
步驟3
開始初次免疫反應
二次免疫反應
可用的Ab目錄
Ag辨識 記憶B細胞
對特異性Ag
具高親和力的
Abs的分泌
(漿細胞)
親和力計算
親和力
是否滿足?
對特異性Ag
具高親和力的
Abs的分泌
(漿細胞)
Ab選擇
對特異性Ag
具高親和力的
Abs的分泌
(漿細胞)
體細胞超突變
(生長中心)
B細胞合成
(骨髓)
無性繁殖選擇
步驟4
步驟5
差異Abs的產生
停止適
應
性
免
疫
反
應
是
否
圖一：人類的 IS
步驟二：可用的抗體存庫(available Ab repertoire)
可用的抗體存庫是由 B 細胞受體(亦即 Abs)所
組成的。Ab有兩條重(heavy, H)鏈與兩條輕(light, L)
鏈，每一個 H與 L鏈包含兩個區域：變異(variable,
V)區與固定(constant, C)區。V區執行 Ag辨識，C
區則起作用於當一個受動器 (effector)，負責與其相
關的 V區連接以合成 H鏈(或 L鏈)。Ab位於 V區
中用來辨識抗原決定位的位置稱為抗原結合部位
(paratope)。此外，Ab 具有免疫特異型(idiotope)，
此特異型可以被其它 Abs所辨識 (Jerne, 1984)。從
這個觀點，Jerne 發展了一個免疫定理，稱為個體
基因型網路(idiotypic networks)，請見圖四。圖四中
顯示，B細胞們不是孤立的，因此不同的 Abs可與
彼此產生交互作用。例如：入侵 Ag 的抗原決定位
刺激(圖中的實線)在 B細胞 1 表面的 Ab 1，B細
胞 1用 Ab 1的抗原結合部位  1抑制(圖中的虛線)
此 Ag，接著 Ab 1的免疫特異型 1發出刺激訊號給
B細胞 3，B細胞 3則用 Ab 3的抗原結合部位去
抑制 B細胞 1，以此類推。
在 Jerne 建立一個微分方程式以描述抗原特異性 B
細胞集合的動態後，Perelson (1989)接著回顧並且
發展出一個一般性的網路模式，如下所示：
RDBRIP 
其中
RIP =B細胞族群的增加率
B = 骨髓所分化之新 B 細胞置換死亡 B 細胞的補
充率
D = 未受刺激之 B細胞的死亡率
R = 受刺激之 B細胞的複製率
式(8)起作用於維持差異之 B 細胞 (亦即 Abs)的數
量，本文所提出的 AIS將使用它。
步驟三：楔合度(affinity)計算
當 Ab 的抗原結合部位與 Ag 的抗原決定位
「有」楔合的形狀時，它們有高的 Ab-Ag 楔合度
可以完全結合在一起，入侵的 Ag 隨即被消滅。在
Ag 完全被清除後，抗原特異性 B 細胞轉換成為記
憶 B細胞(memory B-cells)，並長久的存在於 IS中。
當相同的 Ag 再次入侵人體時，它們可以提供更迅
速與更強烈的免疫反應，使入侵的 Ag 在還沒有引
發人類的疾病前，即被有效的控制。換言之，即人
體對該類 Ag 已經具有免疫力了。然而，當 Ab 的
抗原結合部位與 Ag 的抗原決定位「沒有」楔合的
形狀時，它們仍然可以結合在一起，但是楔合度較
弱。此時，到步驟四，Ab可藉由楔合度成熟(affinity
maturation)以增加對此特異性 Ag 的楔合度，直到
此 Ag被消滅為止。
步驟四：無性繁殖選擇(clonal selection)
在 IS 中，無性繁殖選擇是去增加抗原特異性
Abs的數量。在成熟 B細胞遭遇到 Ag後，這些抗
原特異性B細胞會進入淋巴結的生長中心 (germinal
center)以進行增殖、分化與體細胞超突變 (somatic
hypermutation)。
步驟五：差異 Abs之生成
可用的 Ab 存庫的範圍，可以逐漸形成一個可
能的 Ab存庫(potential Ab repertoire)與往後再產生
一個完全的 Ab存庫(complete Ab repertoire)。這兩
個 Ab 存庫可以分別藉由如下所述之「B 細胞隨機
合成」與「體細胞超突變」而產生：
(1) B細胞隨機合成
骨髓在產生新的 Abs以取代死亡的 Abs中扮演
著一個重要的角色。在 B細胞分化的過程中，會對
組成 H與 L鏈的基因片段進行重組，以合成新的 B
細胞(Coico, 2003)。H 鏈是由它的 V 區的基因 V
(variable, VH)、D (diverse, DH)與 J (Joining, JH)－
VHDH JH和 C區的基因 μC 所組成；L鏈則是由它的
V 區的基因 V (variable, κV )與 J (Joining, κJ )－
κV κJ 和 C區的基因 κC (或 V區的基因 λV λJ 與 C
區的基因 λC )所組成。兩條相同的 VHDHJH- μC 與兩
條相同的 κV κJ - κC (或 λV λJ - λC )合成在一起
以產生未成熟 B 細胞，未成熟 B 細胞(immature
B-cells)在發展到成熟 B細胞(mature B-cells)的階段
中，為了確保此 B 細胞不會攻擊自身的組織或器
官，它會與自身抗原(self-Ag)發生作用，此時有三
種可能的情況：刪除(deletion)、無反應性(anergy)
53-3 PIA演算步驟
步驟一：起始
(1)病毒入侵系統，形成抗原；系統產生抗體，與抗
原對抗。
(2)假設抗體與抗原均已 Gaussian機率方式出現。
步驟二：計算抗體與抗原的機率統計量，即：平均
值、標準差與公式(6)到(11)
步驟三：Ag辨識
Ag 的抗原決定位，可被用來描述問題的參
數，而 Ab的抗原結合部位與免疫特異型，則用來
表示問題的決策變數 nx 。因為機率性問題是屬於
連續參數的問題，故對 Ag 與 Ab 使用實數表示，
此可能獲得比二元編碼較精準的解答。
步驟四：可用的 Ab存庫
首先依據存庫大小(repertoire size, rs)在每一個
決策變數的下上界限間隨機產生 Abs。接著計算每
一個 Ab 的限制違反程度 rsjvio j ,,2,1,  ，
並且由小到大遞增排序，具有最小限制違反程度的
Ab被選擇當做初始解。
步驟五：Ab-Ag楔合度計算
此步驟為利用公式(12)計算Ab-Ag的楔合度如
下：
  22log21, AbAgjI 
AgAb  , j = 1, 2, …, rs. (13)
此外，令在當時計算中的 Ab存庫中，具有最
高的 Ab-Ag楔合度的 Ab為最佳的 ),( Gxn*Ab ，並
且被選出去經歷無性繁殖的淘汰計算。
步驟六：終止條件
此PIA使用最大的淘汰代數(generation) maxG 當
做終止條件。如果此終止條件達到，則 PIA停止，
並且獲得最佳解；反之，到步驟五繼績產生新的
Abs。
步驟七：無性繁殖選擇
在此步驟中， ),( Gxn*Ab 被複製。本計劃發展
一個個體基因型 PIA 運算元，以控制抗原特異性
Abs 的數量，此運算元在當時計算中的 Ab 存庫
中，計算 ),( Gxn*Ab 被其它 Abs 所辨識機率 jrp 。
此
jr
p 定義如下：



N
n
dr nj eN
p
1
11 (14)




Nn
rsj
Gx
GxGx
d
n
njn
n
,,2,1
,,2,1
,),(
),(),(
*
*


Ab
AbAb (15)
其中 ),( GxnjAb 為在當時計算中的 Ab 存庫
中，第 j 個 Ab。大的
jr
p 表示 ),( Gxn*Ab 與
),( GxnjAb 有楔合的形狀。為了辨識 Ab-Ab 的程
度，要有一個事先定義的門檻值 rtp 才可。在 PIA
中， rtp = 0.999被採用。對於那些 jrp 大於或等於 rtp
的 Abs，則予選出並複製(proliferation)，進而發展
成為記憶 B 細胞；其它的 Abs 則被抑制
(suppression)，而走向死亡。
步驟八：差異抗體的生成
那些被選出的 Abs 接著根據體細胞超突變機
率( hmp )，而被分為兩個子集合：其中一個子集合
執行體細胞超突變，而另一個則進行受體改變。此
外，由骨髓產生新的 Abs，為用以置換在步驟五中
死亡的 Abs。此動態的維持差異 Abs數量的方式，
採 Cauchy 分配 )1,0(C 之機率密度函數來干擾
(perturbation)，採用該分配的原因是因為：它可以
偶爾產生較大的擾動值，以使得在搜尋空間的解可
以有較大的機會從局部最佳解跳脫，此點可與標準
Normal 分配 )1,0(N 相比較而得知 )1,0(C 的雙尾較
)1,0(N 不平坦，而且它的雙尾一直向兩側延伸，意
指 )1,0(C 可以產生大的擾動值。標準 Cauchy分配的
機率密度函數定義如下：
 sssfC ,1
11)( 2 (16)
Cauchy受體變化運算元為：
      隨機亂數)1,0(1)1,0(ˆ 65 C(0,1)xx  UU
(17)
其中
NnCCC Tn ,,2,1,)]1,0(,),1,0(),1,0([) 21  C(0,1
)1,0(5U 與 )1,0(6U = 均勻隨機亂數
 = 非負的指數項
對由骨髓產生新的 Abs 的生成可由圖十說明
之：Ab是由兩條 H鏈與兩條 L鏈所合成，而負責
辨識抗原決定位的 V 區(抗原結合部位)是分別由
VHDHJH - κV κJ (或 VHDHJH - λV λJ )等基因片段
所組成，因此在 Ab存庫中，所有的 Abs在 V區的
基因片段就形成為數龐大的基因片段集合。從步驟
五所選出的 Abs中，隨機地選擇兩個 Abs，接著在
抗原結合部位隨機選擇一個點，然後交換此兩個
Abs在抗原結合部位的基因以產生新的 Abs。為了
增加新的 Abs的差異性，被選擇的基因片段分別加
上 )1,0(4N 與 )1,0(5N 的隨機亂數，接著，這兩個新
產生的 Abs 在特異型基因片段也相對應地被交
換，最後，使用式(17)進行受體編輯。
步驟九：Ab存庫的更新
此步驟計算在新形成的 Ab 存庫中的 Abs 與
Ag 之間的楔合度，並且遞減排序。如果在排序集
合中最高的 Ab-Ag 楔合度大於當時最好的 Ab-Ag
楔合度，則選取此排序集合一半的 Abs，並複製到
rs數量的 Abs，而成為下一代的 Ab 存庫；如果排
序集合中最高的 Ab-Ag 楔合度，較當代最好的
Ab-Ag的楔合度差，則保持當代的 Ab存庫當做下
一代的 Ab存庫。此過程，不僅保有最好的 Ab，也
允許次佳的 Abs存活。
步驟十：重復步驟三至七，直到終止條件被達到為
止。
四、實驗結果
4-1釋例 1 [12]
7表四 PIA在釋例 2的求解結果
原文獻解 PIA解
1x 78 77.998423
2x 33 33.002454
3x 29.998 29.989947
4x 45 45.002417
5x 36.7673 36.762238
Optimal solution 10127.13 10124.489076
4-2-2 rtp 的分析
表五顯示 PIA 在固定 rs = 100 與使用兩種不
同的 rtp 下，對於求解問題 2 的數值計算結果，由
表中可知， rp 對於 PIA所得到之 )( ,SOM0 Lg x 的 ME
值有顯著差異，因為 P值= 0.016小於 = 0.05。此
外， rp = 0.9時 PIA所獲得的 )( ,SOM0 Lg x 之W值與
MAE優於 rtp = 0.99時 PIA所獲得的。
表五 PIA 在兩種不同的 rp 下對於求解問題 2
的數值計算結果表
Ab
rtp = 0.9 rtp = 0.99
P 值
B −5.7398 −5.7398
ME −5.7398 −5.7397 0.016
W −5.7397 −5.7393
MAE 3.7431E-05 7.63616E-05
MCT 16.24 秒 18.99 秒
4-3 系統示範
4-3-1建立輸入檔
依序建立問題、虛擬目標函數、決策變數之
上下界( 邊界條件 )與限制式違反程度之編碼，並
且分別儲存於文字檔中。
4-3-2輸入檔讀取
依序完成所有輸入檔之讀取。在成功讀取檔
案後，系統會出現下一個輸入檔的提示訊息。
4-3-3參數的設定
在處罰函數的的選項中，使用者可自行點選靜
態的或適應性的處罰函數，本文選擇靜態的處罰函
數作為示範說明；在參數設定的選項中，各參數的
預設值，為本文所找到的 PIA 方法的最佳參數設
定，此工具亦提供各參數的下拉式選單，允許使用
者視所求解問題的狀況，彈性地調整 PIA方法的參
數值。最後，選擇終止條件，終止條件的預設值為
maxgˆ = 3000，並且點選執行。
4-3-4結果輸出
圖五(a)為 PIA方法的計算結果輸出，圖五(b)
則為 PIA方法的圖形輸出。
(a) PIA方法的計算結果輸出畫面
(b) PIA方法的圖形輸出畫面
圖五 PIA方法的計算結果輸出畫面
五、結論
PIA方法之參數的一般性操作原則如下：
1. 參數世代數愈大，表示在 Ab目錄中的 Abs( 候
選解 )越多，有助於 PIA 方法找到一個問題的
最佳解，但是相對地必須付出較大的計算成
本。世代數愈小，所需花費的計算成本相對地
較少，但是 PIA 方法容易只找到局部最佳解。
本文建議理想的世代數設定值是介於 100 到
150之間。
2. 門檻值 rp 是一個介於 0與 1之間的數值， rtp 愈
接近 1表示選擇優秀的Abs( 候選解 )的壓力愈
大，因為很容易複製出 Ab 目錄中具有最佳
Ab-Ag親和力的 Ab ( 候選解 )，而無法保有鄰
近的次佳解，鄰近的次佳解有助於維持 Abs
( 候選解 )的差異性與發展出下一個世代優秀
的 Abs( 候選解 ) 。參數 rp 愈接近 0就喪失擇
優運算元的意義，因為 Ab 目錄的所有 Abs 不
論優劣，都可以輕易地越過此門檻值，導致無
法從Ab目錄中篩選出強壯的 Abs，本文建議 rp
理想的設定值是介於 0.9到 0.99之間。
六、參考文獻
1. Battiti, R., (1994), “Using mutual information for
selecting features in supervised neural net
