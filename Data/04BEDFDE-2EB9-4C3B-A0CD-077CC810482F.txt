經過 JPEG 2000 壓縮以後的影像資料最後安排成為一個壓縮的編碼串流(Codestream)，
圖 2為 JPEG 2000編碼串流結構的示意圖，這些編碼串流的結構會將一張 JPEG 2000的影像
資料分割成四個部分： 
(1)色彩通道，即色彩元素轉換。 
(2)空間分割，將影像切割成獨立編碼的區塊。 
(3)頻率分割，將經過小波轉換後的影像依據次頻帶或解析度的不同做分割。 
(4)空間及頻率分割，在每個次頻帶上在分割成多個編碼方塊。 
 
 
圖 2. 編碼串流結構示意圖 
 
2.2 相容於 JPEG 2000之影像加解密技術 
一般而言，一個有效的影像加解密技術可歸類出以下幾點應有的特性[12]。 
(1)壓縮等效性(Compressibility Equivalent)：加密後的壓縮資料長度應該與原始壓縮資料長度
相當。 
(2)複雜度等效性(Complexity Equivalent)：加密對壓縮產生的額外計算量應該愈少愈好。 
(3)向下相容(Backward Compatible)：加密後的壓縮碼必須可以被一般的影像解碼器解碼。 
(4)計算上的安全(Computationally Secure)：對於窮舉性的攻擊，加密金鑰必須提供足夠的安
全性。 
JPEG 2000加解密技術以技術特性大致可區分成兩大類，分別為特定的 JPEG 2000影像
加解密技術及植基於密碼學之影像加解密技術。特定的 JPEG 2000影像加解密技術一般是利
用 JPEG 2000算術編碼器特性來進行影像加密技術，此類技術利用打亂算術編碼器機率模式
[11]或算術編碼的不確定性[12]來達成加密的目的，此類技術加解密速度快，但僅適用於 JPEG 
2000影像格式。 
植基於密碼學之影像加解密技術[13-14]是利用傳統密碼技術直接對經由 JPEG 2000編碼
器產生的編碼串流加密，以達到部份或全部加密的目的，由於 JPEG 2000的封包的連續兩個
位元組資料均小於十六進位 FF90，因此，此類技術必須確保最後加密後的封包，連續兩個位
元組資料不能超過十六進位 FF8F。 
 
 2 
 
為能有效在解密端進行解密，本技術以相容於 JPEG 2000 - Part 1技術將解密嵌入在封包
的主檔頭，其嵌入示意圖如圖 5所示，嵌入細節則詳述於 3.3節。 
 
 
圖 5. 嵌入解密資訊示意圖 
 
本技術之詳細加密演算法如圖 6 所示。首先將原始編碼區塊的位元串流定義為明文P = 
{P1, P2, …, Pn}，其中Pi 是第i個位元組，i = 1, 2, …, n。 
(1)使用秘密金鑰產生加密金鑰串流 K，其中加密金鑰串流必須符合每個編碼區塊的長度。 
(2)將明文P與鑰匙串流K放入加密器中，此加密器會逐一對每個位元組進行加密。產生密文C
＝(P＋K) mod 256 = {C1, C2, …, Cn}，其中Ci 是第i個位元組，i = 1, 2, …, n。 
(3)檢查密文C是否符合JPEG 2000編碼語法，即兩相鄰位元組(CiCi+1 , i = 1, 2, …, n－1)必須保
持在十六進位值 0000至FF8F之間，假如兩相鄰位元組在FF90以上時，就將第一個位元組
FF更換成FE。 
(4)記錄FF更換成FE的位置X = {X1, X2, …, Xn}，作為解密資訊，其中Xi 是第i個更換成FE的位
置，i = 1, 2, …, n，以FE在位元串流出現的順序表示。 
(5)將解密資訊 X嵌入到主檔頭的注釋中。相容於 JPEG 2000 – Part 1之嵌入技術詳述於 3.3
節。 
(6)產生與 JPEG 2000 – Part 1相容的位元串流。 
 
CiCi+1<FF90?
加密器
密文C
C = {C1 , C2, … , Cn}
是
與 JPEG 2000 – Part 1
相容的位元串流
加密金鑰串流 K P = {P1 , P2, … , Pn}
明文P
記錄 FF更換成
FE的位置X
否
將第一位元組FF
更換成 FE
X = {X1 , X2,… , Xn}
將X嵌入主檔頭
的注釋中
 
圖 6. 加密流程圖 
 4 
 
的長度共佔用多少個位元組。 
在 JPEG 2000編碼中，共有六種類型的標記和標記段被使用，分別是定界型(Delimiting)、
固定資訊型(Fixed Information)、功能型(Functional)、在位元串流型(In Bitstream)、指標型
(Pointor)及資訊型(Informational)，其功能如表 1所示。 
 
表 1. 標記和標記段功能 
型式 功能 
定界型的標記和標記段 用來框住檔頭和資料 
固定資訊型的標記段 提供影像的必要資訊 
功能型的標記段 描述使用了那些編碼功能 
在位元串流型的標記和標記段 作為錯誤回覆(Error Resilience)之用 
指標型的標記段 指到位元串流中特定的偏移值 
資訊型的標記段 提供輔助資訊 
 
在資訊型的標記段中，提供輔助資訊的功能，所包含的資訊有色彩元素註冊(CRG, 
Component Registration)和注釋(COM, Comment)。其中注釋的功能允許非結構化的資料出現
在主檔頭及塊狀部分檔頭，用來記錄一些輔助的資訊。因此，編碼器可利用 JPEG 2000此一
編碼特性，將加密資訊存放在主檔頭的注釋中，如圖 8所示。其中 COM為標記碼所佔用大
小是二個位元組，其值是十六進位值 FF64；Lcom為標記段的長度(不包括 COM標記碼的長
度)所佔用大小是二個位元組，其值是十進位值 5至 65535之間；Rcom為標記段的註冊值所
佔用大小是二個位元組；Ccom為非結構化資料佔用多少位元組。 
 
 
圖 8. 相容於 JPEG 2000 – Part 1嵌入技術 
 
本文所提出的解密資訊嵌入法即利用 JPEG 2000主檔頭之特性，將編碼串流的解密資訊
直接嵌入 JPEG 2000主檔頭中，如此可正確無誤將 JPEG 2000影像解碼及解密，此即相容於
JPEG 2000 – Part 1之嵌入法。 
 
 6 
 
時，藉由嵌入解密資訊可以還原所替換位置的資料，將得到原始影像，如圖 11 所示。其中
圖 11(a)及 11(b)為使用 JPEG 2000標準解碼器所解碼之 Lena與 F16影像，解碼出來的影像與
加密影像圖 9(b)與 9(d)相同。 
 
 8 
 
 
(a) 
 
(b) 
圖 11. JPEG 2000解碼影像 
 
表 2為嵌入解密資訊與未嵌入解密資訊之差異。由表 2可以明顯看出，嵌入解密資訊與
未嵌入資訊的影像差異為 0.10%至 0.16%之間，差異極小，因此可證明本文提出之嵌入技術
具有壓縮等效性。 
 
表 2. 嵌入與未嵌入資訊差異表 
原始影像 標準 JPEG 2000壓縮
(位元組) 
加密影像 
(位元組) 嵌入資訊量 
Lena 36,045 36,091 0.13% 
F16 32,433 32,478 0.14% 
Bird 29,848 29,890) 0.14% 
Boat 36,178 36,220 0.12% 
Camera 37,570 37,608 0.10% 
Goldhill 45,304 45,373 0.15% 
House 34,774 34,822 0.14% 
Peppers 32,558 32,595 0.11% 
Sailboat 45,424 45,497 0.16% 
 
5. 結論 
本文利用 JPEG 2000語法上的特性，提出一適用於 JPEG 2000之影像加密技術。本文提
出之技術為一基於密碼學的方法，其是利用密碼學技術中的串流加密技術對 JPEG 2000編碼
串流進行加密，並利用 JPEG 2000 – Part 1核心解碼之特性，將解密資訊直接嵌入於 JPEG 2000
影像檔頭中，作為解密端解密之依據。本文所提方法具有下列優點： 
(1)對 JPEG 2000原始影像可達到 100%完全加密，無任何原始影像資訊可尋。一張已完成加
密之 JPEG 2000影像，其編碼串流完全加密，可完全保護原始影像，不透漏任何原始影像
資料。 
(2)利用密碼學之串流加密對 JPEG 2000編碼串流進行加密，即可達到所預估時間內完成加解
