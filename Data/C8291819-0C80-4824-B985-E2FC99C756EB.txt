???????????????????? 
???????? 
 
?????NSC 94??????E???????? 
?????94? 8? 1?? 95? 7? 31??
??????? ???????????? 
Email: hclin@cc.ctu.edu.tw 
???????????????? 
 
?????
?
??????????????????????????????????????????
??????? Hopfield?????????????????????????????
????????????????????????????????????????
???????????????????????????????????
?
?????????????Hopfield neural network???????
?
Abstract 
 
   Conventional approaches for harmonics filtering usually employ either passive, active filtering 
techniques or hybrid filters. This paper proposes an adaptive harmonic filtering approach using a 
modified discrete Hopfield network model. The advantage of the scheme is that it can extract the 
fundamental component of the distorted current and provide a suitable compensation current as the 
power harmonics may vary in amplitude and frequency from time to time. Therefore, the 
time-variant harmonic environments in real-time machine systems can be adapted successfully.  
Real-time performance experiments verify that the proposed scheme is feasible in term of real-time 
tracking, adaptive low frequency harmonics filtering, fast training and convergence speed. 
 
Keywords: Adaptive harmonic filtering, Hopfield neural network, Dynamic harmonics 
 2 
 
 
 
 
 
 
 4 
 
 6 
 
 8 
???????? 
?
?
???????????????????????????????????
??????????? Hopfield????????????????????
???????????????????????????????????
???????????????????????????????????
??????????????
 
???????????????????????????????????
??????????????????????????????????
???????????????????????????????????
???????????????????????????????????
???????????????????????????????????
??????????????????????????????????
???????????????????????????????????
???????????????????????????????????
???????????????????????????????????
????????????????????????-2006 IEEE International 
Conference on Systems, Man, and Cybernetics (SMC2006)), October 8-11, 2006, 
Taipei, Taiwan(??? EI???)???????????????? 2006??
?????????????????? 
 10 
????
?
?????????
?????????????????????????????
?????????????????????????????
????????????????????????????
? ???????????????????????????????? ???
???????????????????
? ??????????????????????????????? 
? ?????????????????? 
 12 
????????
Abstract - Traditional methods to measure power system harmonics employ either the power 
harmonic analyser or the software package such as Matlab. They, however, usually have limited 
capability in the Internet connection and/or human graphical interface. In this paper, a 
PC-based virtual instrument (VI) that can carry out a remote detection and monitoring using 
LabVIEW and the microprocessor (Intel 8051) for power system harmonics is proposed. The 
nearby PC (Server) can collect real-time waveform data that is transmitted to remote PCs 
(Clients) for on line harmonic analysis and monitoring via the Internet. The history of Total 
Harmonic Distortion (THD) in the waveform signal can be also recorded and tracked in the data 
base by clients. Experimental results have testified its well performance and remote capability. 
  
Keywords: FFT, TCP/IP, THD, VI, power system harmonics, Internet 
 
1    INTRODUCTION 
 
When the extensive use of power electronic devices is added to an industrial distribution 
power system, it is an important engineering practice to design a model of harmonic 
measurement and analysis approach in power systems [1-2]. Power system harmonics are caused 
by transformers, motors, and rectifiers; they have been detected as early as the 1920’ and ‘30s 
[3]. A system can still function adequately in the presence of limited amounts of harmonics, and 
in the past amounts injected into systems were generally considered insignificant. Today, 
however, increased industrial and consumer dependence on equipment with non-linear 
components is aggravating the situation. Harmonics in a power system can result in 
communication interference, transformer over heating, or the malfunction of solid-state devices, 
and so on [4-5]. Current harmonics induced by non-linear power electronic loads also present 
inefficient operations of local and global power supply systems.  
 
Harmonic measurements in industrial power systems are essential to achieve three objectives. 
Hsiung Cheng Lin   
Department of Automation Engineering, Chienkuo Technology University, Taiwan  
Email: hclin@cc.ctu.edu.tw 
Remote Real-time Power System Harmonics Detection 
and Monitoring via the Internet 
 14 
[ ]
∆
=
pi
ω
pi
2
0
2)(
2
1
tdtii ss  
   tdtni
n
nsn ωϕω
pi
pi 22
0 ,...3,2,1
)sin(2
2
1
  





+=
∞
=
 
    
   ...
2
3
2
2
2
1
1
2 +++== 
∞
=
sss
n
sn iiii                               (3)                                                                                         
...
2
4
2
3
2
2 +++=
∆
sssh iiii                                        (4)                                                 
which is the r.m.s. value of input harmonic current. 
 
The total harmonic distortion (THD) factor is the ratio of the r.m.s. value of all the harmonic 
components together to the r.m.s. amplitude of the fundamental component as following 
definition. 
 
Mathematically, 
11
2
2
1
2
1
2
s
h
s
n sn
s
ss
i
i
i
i
i
ii
THD ==
−
=

∞
=
∆
                             (5)                                                                                  
 
3    Structure of the system hardware 
 
The system hardware is shown as Fig. 1. It can perform remote on line harmonic detection 
and monitoring by two clients (remote PCs), respectively. These clients communicate with the 
server (nearby PC) according to TCP/IP using LabVIEW. The server is to collect the waveform 
data transmitted from the microprocessor (Intel 8051) through RS232 via the I/O interface 
(IC8255). The analog data (distorted current signal) that is initially captured from the Current 
Waveform Sensing Circuit is converted to a digital data via the A/D converter and then input to 
IC8255’s port. The Zero-Crossing Detector is used to ensure the current waveform to be 
captured from the zero-point for very cycle, avoiding spectrum leakage [1-2]. 
 
 16 
(b) 8051’s communication operation is chosen as Mode 1 to transmit the message via TXD and 
to receive the message via RXD. TXD is the transmission bit in the Universal Asynchronous 
Receiver transmitter (UART), and RXD is the receiving bit. 
(c) The data (waveform) in the serial port buffer (SBUF) is read from 8255 through 8051. 
(d) Upon complete transmission of data from UART serial port (TXD) to LabVIEW, TI will be 
set to 1 by the system.  
(e) Set the sampling rate sf (= t∆1 ) as 1000 and sampled points N=1000. 
(f) Go back to step(b) until the sampled points are reached. 
(g) Set time delay. 
(h) Go back to step(b) until the power in 8051 is turned off. 
 
 
Fig. 2 Flowchart of the 8051 programming 
 
4.2    Flowchart of LabVIEW programming 
 
In the server (nearby PC), the serial port (COM1) in LabVIEW uses the TXD and RXD of the 
UART to receive data from the microprocessor (8051) via its own UART. Note that the Bps, i.e. 
 18 
described as follows: 
(a) Initilize the TCP/IP connection with the server. 
(b) Read the waveform data that is transmitted from the server via the TCP/IP. 
(c) Display the current waveform signal in the waveform chart. 
(d) Harmonic analysis using FFT.  
(e) Display instant THD history and record it in the data base. 
(f) Set time delay to wait for next data reading cycle. 
(g) Go back to step(b) until the TCP/IP is disconnected. 
 
 
Fig. 4 Flowchart of the Client A programming 
 
In Client B (remote PC), it views the harmonic analysis results as Client A by the Web Site 
(Internet Explorer) simultaneously. Its flowchart is shown in Fig. 5. The main programming 
procedure is briefly described as follows: 
(a) Initilize the Web connection with the Client A. 
(b) View the front panel of the Client A via the Internet Explorer. 
(c) Go back to step(b) until the Web connection is disconnected. 
 20 
 
Fig. 7 TCP/IP connection program for Client A 
 
5.2 World Wide Web connection between the Clients 
 
In Client A, LabVIEW front panel displays its working status on line, as shown in Fig. 8. The 
waveform and its spectrum can be viewed in the chart, including the individual frequency and its 
amplitude. The waveform THD (%) is also presented immediately and recorded in the data file, 
i.e. a:\IO.txt. Once the THD (%) is over the predefined limit, for example 25%, the warning 
LED will be operated (on). 
 
 
Fig. 8 VI panel of the Client A  
 
The VI panel can be published to World Wide Web that can be viewed by for Client B via 
Internet Explorer. Fig. 9 shows the Web Publishing Tool to display the VI front panel.  
 
 
Fig. 9 VI panel for URL access 
 22 
waveform THD but also its individual frequency and amplitude. The path to save the THD 
history in the data base was set up in the system. A warning sign was switched on if the THD 
was beyond the predefined limit. As can be seen, there were 100 THD results displayed in the 
waveform chart (THD history) at the same time. 
 
 
Fig. 12 VI panel of the Client A 
 
From the World Wide Web, the Client B at the other remote PC can view the VI panel that is 
the same front panel as the VI panel of the Client A, as shown in Fig. 13. In particular, the 
control of VI panel can be transferred to the client with the protection of Fire wall.  
 
 
Fig. 13 Web front panel of the Client B 
 
The waveform’s THD was recorded once for every 30 minutes (i.e., time delay in Fig. 2) so 
that its history can be easily tracked by the data base, shown in Table 2.  
 
Table 2: THD history 
?????????? ????? ????? ??????? ???????
?? ?????????????????????????????????? ?????? ? ???????
?? ?????????? ? ??????? ??? ? ??????? ? ?????
?? ?????????? ? ????? ????? ? ??????? ? ???????
?? ?????????? ? ????? ????? ? ??????? ? ?????
?? ?????????? ? ? ????????? ? ??????? ? ???????
