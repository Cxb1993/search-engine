2 
 
Snort 來進行網路病毒偵測的情況，在國內並不多見。在高成本的商業產品解決方
案和高複雜度的開放原始碼建置架構都不可行的情況下，大多網路管理者對網路病
毒的偵測處理能力也因此而變得相當有限。 
不少研究人員和學者也因此提出關於網路病毒偵測的文獻，在[7]這篇論文中有
著很好概述。在部份的文獻中[9][10][1]，學者提出利用修改類似 Unix 的開放式平
台來進行網路病毒的偵測，或者在每部使用者機器上安裝特定的偵測輔助軟體來達
成網路病毒偵測的目標。然而這些方法在實務運作上卻有其實質困難，一來不是每
一個正在運作中的主機系統都允許進行作業系統核心(kernel)的修改，亦不容易在類
似校園網路的環境下，要求每一位使用者都必須安裝特定的偵測輔助軟體。然而面
對日益嚴重的網路病毒問題，我們需要一個低建置成本，且可快速簡易安裝的網路
病毒偵測系統，來有效進行網路病毒的管控，以穩定網路基礎建設的正常運作，方
能為明日各種新興網路應用提供最好的環境。 
NetFlow 資訊包含了一個短暫時間內，從來源端(source)到目的端(destination)
的簡單但必要的連線資訊，包含來源位址(source IP address)、目的位址(destination IP 
address)、來源通訊埠(source port number)、目的通訊埠(destination port number)、IP
協定類型(IP protocol type)、封包數目(number of packets)、封包總量(octets)等資訊。
這些簡單但必要的資訊，在不同的網路應用上，會有不同的特徵，也因此能反應該
網路應用的網路行為特性。NetFlow 的取得並不需要檢視封包的傳輸內容
(payload)，僅需要檢視封包表頭(header)即可得到所需要的資訊，因此相當適合使用
於高速度大頻寬的網路。在不少內建具 NetFlow 輸出功能的路由器(例如：Cisco、
Juniper)均可直接獲得 NetFlow 資訊。在不具備 NetFlow 輸出功能的路由器上，我
們亦可運用大部分網路設備具有的流量鏡射(traffic mirroring)功能，配合 NetFlow 輸
出軟體[11]，來取得 NetFlow 資訊。 
4. 研究方法 
本計畫之目標在建構一個以開放原始碼及開放式平台為基礎之網路病毒偵測
系統，且期望能將研發成果快速應用於現有校園網路環境之中，因此我們針對校園
網路流量進行觀測，並將觀測結果進行分析，之後推導出一個快速有效的網路病毒
偵測方法，之後，我們以系統實作方式驗整此一方法的可行性及實用性。本計畫進
行之步驟與方法詳述如下： 
(1) 收集有關網路病毒，網路流量分析，及網路管理之相關文獻並加以研讀。 
在計畫之起始階段所有計畫參與人員積極收集與計畫相關之各式文獻，研讀
關於網路病毒之特性，網路流量分析方法，及因應網路病毒之網路管理技
術，並討論各種網路病毒可能的形式，各種網路應用所可能產生的流量，以
及各種網路病毒管理對策之優缺點，並將學習所得轉化為研發設計本計畫之
開放式網路病毒偵測系統之基礎。同時，我們就各種可能的網路架構，研究
如何在不影響網路運作效能的情況下，能獲取 NetFlow 的資訊，以作為網路
病毒偵測的基礎。 
(2) 設計網路病毒偵測方法。 
在完成相關文獻的初步研讀後，我們嘗試設計以簡易的網路傳輸資
訊—NetFlow，包含封包傳輸的時間、來源 IP 位址(source IP address)、來源
通訊埠(source port number)、目的 IP 位址(destination IP address)、目的通訊埠
(destination port number)、包大小(octet)及一個 flow 的封包數目等資訊，考慮
未來適應高速度大頻寬的網路環境，嘗試在不檢視封包內容(payload)的情況
4 
 
(2) 實作完成一個以開放原始碼為基礎之網路病毒偵測系統。 
為驗證此一病毒偵測方法的可行性及實用性，在本計畫中我們完成一個以開
放原始碼為基礎，可在開放式平台上運作的網路病毒偵測系統。此系統因其
極低的建置成本及對各種不同網路架構的適應性，可快速應用於校園網路及
其他骨幹網路之病毒偵測。舉例來說，各校園網路管理者僅需取得本系統之
程式原始碼，配合其他開放原始碼及作業平台，即可在 PC 及伺服器上架設
完成此一病毒偵測系統，而能更有效的掌握網路病毒在校園網路的情況，進
而有效穩定校園網路的運作。 
圖 1是這個網路病毒偵測系統所產生的偵測結果，系統架構在Solaris平台
上，利用Perl語言進行雛形系統的開發，配合NetFlow的定期資料，可以在 10
分鐘內，分析完畢 10 分鐘所產生的數據。依據使用者實際回報的處理結果，
證實系統所做出的判斷有相當高的準確性。從這個結果中，我們可以發現，
即時目前已經存在有許多的軟體及資訊來協助使用者避免被網路病毒感
染，但實際上，仍有許多機器會被網路病毒所感染，且對外進行散播，而這
些散播行為都有可能會威脅網路的正常運作。因此，如何有效的進行網路病
毒散播的偵測，以維持網路的正常運作，仍為一相當迫切且重要的課題。 
序號 阻斷時間 IP/Network 類型說明 
1 2007/07/20 16:56:11 140.114.11.* IP-SCAN-TCP-445 
2 2007/09/30 15:52:38 140.114.12.* IP-SCAN-TCP-139 
3 2007/04/18 14:42:54 140.114.43.* IP-SCAN-TCP-139 
4 2007/10/24 16:13:02 140.114.43.* IP-SCAN-TCP-8080 
5 2007/10/24 11:23:02 140.114.43.* IP-SCAN-TCP-8080 
6 2007/10/01 18:03:13 140.114.45.* IP-SCAN-TCP-1433 
7 2007/10/11 17:42:59 140.114.45.* IP-SCAN-TCP-135 
圖 1 網路病毒偵測系統實作 
 
在完成本計畫後，我們規劃將此系統應用於學校之校園網路，並設計規劃與其
他網路安全偵測系統加以整合，配合智慧型自動管控機制的開發，將可整合完成一
個以開放原始碼及開放作業平台為基礎之網路安全自動防禦機制。 
在計畫執行過程中所有參與人員，學習到網路管理、網路流量分析，網路安全，
及網路病毒偵測的相關知識，以及如何以簡單網路傳輸資訊進行網路行為分析的技
巧。同時，配合系統的開發與實作，相關人員學習到以開放式原始碼及開放式作業
平台為基礎的系統發展經驗，培養國家在網路安全及系統開發上所需之人才。 
在計畫執行過程中，如何取得足夠的網路流量及網路病毒攻擊樣本，以驗證改
善此一系統的有效性，是本計畫的重要關鍵，也是最有可能遭遇的困難。除此之外，
各種網路應用快速興起，包含網路簡訊(Instant Messages)、網路電話(VoIP)、網路分
享(P2P file sharing)等，如何將網路病毒與這些新興的網路應用加以有效區隔，也是
本計畫面臨的挑戰。因此，我們將與學校資訊網路處(計算機與網路中心)合作，充
分利用校園網路的環境來設計、改良並驗證此一系統，如此開發完成的系統將能有
效實際應用於校園網路。 
