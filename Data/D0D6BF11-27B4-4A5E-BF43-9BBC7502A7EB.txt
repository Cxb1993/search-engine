 研究摘要(500 字以內) 
隨著數位科技的普及，各種傳統的物理或是光學量測，甚至是設備已逐漸
地改良或是重新設計成數位化的電子產品。其中，光學尺即是一個很好的例
子。但是相反的，這些數位化與科技化所帶來的便利性對於不黯電子設備或是
PC 主機操作的使用者來說，反而是無法適應或是接受度無法提高。 
因此，本計畫將延伸高速 USB 2.0 介面來整合至傳統儀器的設計應用領域
中，這是其所具備的即插即用以及熱插拔的特性是非常適合不熟悉電子產品的
一般使用者來操作。在本計畫中我們將高解析度的 USB CMOS 嵌入至傳統的
顯微鏡，並透過機構的改良來實現本系統。再者，於 VGA 模式(640*480)格式
下，更可傳輸每秒 30 張的影像，可作動態的攝影。透過 PC 主機的驅動程式
設計將可控制顯微影像的拍攝或是單張影像的擷取，以及控制顯像光源，讓影
像更為清晰。 
透過本計畫所實現的高解析度數位式光學顯微鏡，將可改進目前光學顯微
鏡在數位化的不便之處，並且建構出易操作，低單價的產品特性，不僅符合一
般基礎科學的研究外，未來更會可擴充之不同的光學儀器的設計上。 
 
 人才培育成果說明 
所有的關鍵技術與系統皆自行整合設計與測試，大可提昇國內工程人員對
於嵌入式系統整合的研發實力。如此，研發人員不但可熟悉如何將 USB 產品
與傳統物理設備相互結合，作整合式的設計與規劃。而經由理論與實務的配
合，將可使得參與的計畫學生，能夠符合目前產業界中最迫切需要之一的系統
工程師，除了加相關技術的同步升級外，對於系統整合與設計有了最完整的概
念。而未來，除了培養電子/電機相關產業的需求人才外，積極瞭解市場產品
現況與未來發展，進而開發關鍵技術提升研究能量，提供企業相關技術服務與
合作機會，都有助於台灣電子產業競爭力的提升。 
    參與計畫的學生，經過此計畫的訓練及成果，已經甄試上中正與成大等相
關科系研究所。 
 
 技術研發成果說明 
1. 提升傳統光學顯微鏡的應用範圍，提供數位化的應用與產品的延伸設計。 
2. 有助於業界進行 USB 2.0 介面的數位式光學顯微鏡相關產品的延伸設計
與應用。 
3. 已尋求策略聯盟廠商進行先期合作案，協助廠商進行先導研究與產品規
劃；進而強化產品的附加價值服務。 
4. 未來在整合多媒體技術的發展以及相關的應用上，對於台灣的學術界與
產業界都有相當的正面幫助。 
5. 能夠培養資訊相關產業的需求人才，積極瞭解市場產品現況與未來發
展，進而開發關鍵技術提升研究能量，提供企業相關技術服務與合作機
報告內容 
一、前言 
隨著數位科技的普及，各種傳統的物理或是光學量測，甚至是設備已逐漸地改良或是
重新設計成數位化的電子產品。其中，光學尺即是一個很好的例子。但是相反的，這些數
位化與科技化所帶來的便利性對於不黯電子設備或是 PC 主機操作的使用者來說，反而是
無法適應或是接受度無法提高。 
因此，本計畫將延伸高速 USB 2.0 介面來整合至傳統儀器的設計應用領域中，這是其
所具備的即插即用以及熱插拔的特性是非常適合不熟悉電子產品的一般使用者來操作。在
本計畫中我們將高解析度的 USB CMOS/CCD 嵌入至傳統的顯微鏡，並透過機構的改良來
實現本系統。在本系統中，採用百萬畫素的 CMOS/CCD 感測器，可高達 SXGA 1024x1008
解析度，以及補捉高解析度的單張顯微影像。再者，於 VGA 模式(640*480)格式下，更可
傳輸每秒 30 張的影像，可作動態的攝影。而在自動對焦上，可從 3 公分至無限遠，而手動
的對焦上，也提供了 1600 倍的光學顯微鏡規格。透過 PC 主機的驅動程式設計將可控制顯
微影像的拍攝或是單張影像的擷取，以及控制顯像光源，讓影像更為清晰。 
透過本計畫所實現的高解析度數位式光學顯微鏡，將可改進目前光學顯微鏡在數位化的不
便之處，並且建構出易操作，低單價的產品特性，不僅符合一般基礎科學的研究外，未來
更會可擴充之不同的光學儀器的設計上。 
 
二、研究目的 
隨著數位科技的普及，各種傳統的物理或是光學量測，甚至是設備已逐漸地改良或是
重新設計成數位化的電子產品。其中，光學尺即是一個很好的例子。但是相反的，這些數
位化與科技化所帶來的便利性對於不黯電子設備或是 PC 主機操作的使用者來說，反而是
無法適應或是接受度無法提高。 
而在傳統醫學或是生物領域上常見的光學顯微鏡是一個相當普及與重要的觀察或是檢
測設備。為了顧及光學顯微鏡的使用，一般的操作人員或是使用者通常不具備電子/電機的
背景，使得操作的便利性更是需加以考量的時候，就不得不思考如何去需更改整個光學顯
微鏡在數位化後與電腦連接或是安裝後的便利與減低困難度。而不諱言地，目前所廣泛使
用的 USB 介面，不僅可擴充至 127 個裝置，並且其所具備的即插即用以及熱插拔的特性是
非常適合不熟悉電子產品的一般使用者來操作。因此，隨著科技產品的日新月異，若是一
般儀器設備領域在透過 USB 介面來延伸或是相互整合的話，將可提高其便利性與創新應用
性。因此，本計畫初步規劃以 USB 介面為內部控制環境的操作介面。 
為了降低整個光學顯微鏡的開發成本，在本計畫中將傳統的目鏡以高解析度 CCD 嵌入
其中，並且改良了整個操作的方式，包括自動、半自動與全自動對焦，以及光源的控制等。
此外，也採用 130 萬畫素的 CMOS 感測器，可高達 SXGA 1024x1008 解析度，以及補捉百
萬級畫素單張顯微影像。也可自動對焦 3 公分至無限遠。透過這些功能的實現，將可把傳
統的光學顯微鏡以一個低單價的 USB CMOS 測器來解決，並提供使用者極大的使用便利
性。 
 
三、研究方法 
在本計畫中，大致可分為光學顯微鏡，USB CMOS 感測器、驅動程式設計以及光學顯
微鏡機構設計等方面來切入。 
 
雖然這樣的架構是相當簡單，但其中我們將克服各種 CMOS 感測器的嵌入，調整焦距
的模具製作，以及光源的設計與控制等技術，並克服建置中的許多整合的問題。雖然，CCD
感測器的畫質與解析度是優於 CMOS 感測器的，但有鑑於 CCD 感測器的單價過於昂貴，
在成本考量以及未來關鍵零件較為容易取得的前提下，我們同時選擇並評估目前的解析度
不斷提升，且已突破百萬畫素的 CMOS 感測器，此外，高解析度影像的擷取與焦距調整也
是本計畫所要解決的問題。在此，初期本計畫的系統，是以基本的光學顯微鏡的改良為切
入的方向，本計畫將設計能夠作自動調整焦距與手動調整等兩種使用方式。其中，對於手
動調整方式，我們將配置 10x、 20x、40x 與 100Xoil 等四種接物鏡倍率，以及 10x 與 16x
接目鏡提供使用者操作，如此可達到 1600 倍的光學顯微鏡的規格。透過此系統，可以無須
另外安裝電腦影像擷取裝置，即可達到影像數位化的功能。未來，預計規劃更高倍率的光
學顯微鏡以及望遠鏡等各種應用產品上。 
 
3.1.2 Video 裝置的基本特性 
在 USB 的規格文件中，定義了將某種相同屬性的裝置整合在一起的群體，稱之為群組
(Class)。而將這些相同屬性的裝置組合在一起的優點是，可以同時發展該群組以 PC 主機為
主的驅動程式。例如，滑鼠是屬於人性化介面裝置的一種，其群組驅動程式已包含在作業系
統下。如果滑鼠也遵循了裝置群組規格的話，那麼滑鼠的製造商在販售時，根本就無須另外
再附一套驅動程式。也就是可以直接使用 Windows 98 SE 或是 Windows 2000 所內建的人性
化介面裝置的驅動程式。如此，硬體的製造商只需專心發展其硬體電路即可。相對的，倘若
該裝置並不符合人性化介面裝置群組的話，就必須使用含有 Win32 API 函式呼叫的 VB，C++
或是 Delphi 等高階程式，另外再撰寫其驅動程式。 
 而關於 Video 群組的特性可以從下列文件中，作進一步地瞭解。 
z Universal Serial Bus Device Class Definition for Video Devices。 
z USB Video Device Class Release Specification 1.0 Released For Video Streaming Devices。 
z Universal Serial Bus Device Class Definition for Video Devices : Identifiers。 
z Universal Serial Bus Device Class Definition for Video Devices: Video Device Examples。 
 
上述的規格說明支援 Stream-Based Video Formats，如 MPEG2，MPEG4，JPEG，與 Frame 
Based 等的格式，以及包含未壓縮的資料，如 MJPEG 和 DV 等的格式。而相關的應用產品
從簡單的 WebCams 到全功能的 Digital Video Cameras 錄影帶，TV Tuners 等。 
 
 USB Video WDM 驅動程式撰寫  
上面所提及的 Video 群組的部分，主要是透過 USB 介面將資料串流的 Video 補抓與播
放出來。一般來說，我們在設計這 Video 群組時，其實都要考慮到 Audio 訊號。這是因為
傳輸到 PC 主機的 Video 訊號都常是壓縮過的 Video 訊號以及未經壓縮的 Audio 訊號。一般
Video 群組裝置支援 USB 1.1 與 2.0 規格，且這種裝置具有一種配置以及多重介面的特性。
而補抓或是播放的功能是根據應用程式的選擇為主的。 
一但 Video 裝置被連接至 USB 匯流排後，主機的 USB 匯流排驅動程式就會開始裝置列舉的
過程。主機會致能此週邊埠與這新週邊位址。此時，裝置會加以辨識，並下載韌體程式碼，
以及 PC 會透過端點 0 的控制傳輸取得 Video 裝置的裝置描述元。緊接著，裝置會在列舉一
次，這一次裝置會以新下載的相關訊息所定義。而裝置會從 PC 主機取得單一的 USB 位址，
然後即可透過這新的位址與 PC 主機溝通，並且也透過端點 0 控制傳輸從配置描述元中，取
義的命令集，呼叫與回傳來相互傳遞的。 而對於WDM資料串流濾波器驅動程式的命令是
涵蓋在一種稱之為服務要求區塊（Service Request Block，SRB）命令中。SRB 包含了濾波
器驅動程式需要去實現要求的訊息。其中，在WDM資料串流濾波器驅動程式中，包含用來
處理SRB的不同實現方式。例如，數個SRB同時處理或是一次僅處理一個SRB。 
 開發環境 
為了開發WDM驅動程式，相關的發展工具與環境是如下所列： 
1. Microsoft Visual C++ Version 6.0 Professional Edition。 
2. Microsoft Driver Development Kit for Windows XP。 
3. NuMega SoftICE Driver Suite。 
4. MSDN Library。 
 
 驅動程式的安裝 
安裝WDM驅動程式的第一步就是開啟一個INF安裝資訊檔。在INF檔案中，包含了許
多另外命名的節區名稱，並以刮號的符號加以區別。在INF檔案中可能有許多不同的節區，
並以任意的順序來放置。此外，在INF檔案中，設定了版本，製造商，目的路徑，來源磁碟
路徑，來源磁碟檔案，來源磁碟名稱，登陸編輯器入口等訊息。一旦，我們將USB裝置連
接PC主機的USB埠時，匯流排驅動程式即會立即地偵測裝置，視窗安裝精靈也會開始啟動，
然後我們可以透過指定的INF檔案所放置的路徑來安裝此USB裝置。 
 
3.1.3 系統設計與實現 
   為了實現高速的影像擷取與傳輸，在此我們採用在稍後的文章中，直接簡稱
EZ-USB FX2 為 FX2，以方便讀者的閱讀。  以下，首先介紹 FX2 特性包含了下
列各項：  
z 內建480 Mbits/sec收發器，PLL與SIE—完整的USB 2.0實體層(PHY)。 
z 雙重，三重與四重具備緩衝區的端點FIFO 以提供給480 MBits/sec USB 2.0資料傳輸率。 
z 內建，增強型8051可執行高達48 MHz。 
¾ 完整的功能特性：256 bytes的暫存器RAM，2個USART，3個計時器，2個資料指標
器。 
¾ 快速：每一指令週期是4倍時脈(在48 MHz，外頻是83.3nS)。  
¾ SFR可以用來存取需要高速的控制暫存器（包含I/O埠）。 
¾ 對於低ISR延遲提供了USB-向量化的中斷。 
¾ 可以用來作為USB管理與控制，無須去移動高速資料。 
z “軟體” 操作—USB韌體程式碼能夠透過USB介面來下載，省略了硬體程式碼記憶體的
需求。 
z 4個介面FIFO能以內部或是外部時脈所驅動。端點與介面FIFO被整體一致化以刪除介於
USB介面與外部邏輯電路的資料傳輸。 
z 泛用型可程式化介面（General Programmable Interface，GPIF）, 一種微編碼的狀態機，
可用來對連接至FX2 FIFO的‘glueless’ 介面提供時序主控者的服務。  
 
FX2 是一個單晶片的 USB 2.0 周邊電路設計的解決方案，其 FIFO 能被外部的主裝置端
來加以控制，其可提供時脈或是時脈致能訊號來 同步操作，或是閃控訊號來作非同步的操
作。相對的，FIFO 能被稱之為泛用可程式化介面（General Programmable Interface ，GPIF）
 而實際測試的圖片如下圖六所示，從圖中可以發現到其具備自動對焦的功能，也符合
本計畫所要實現的功能。 
 
   
圖六、實際影像擷取畫面 
 
從上述測試結果中，可以發現到本計畫所實現的可自動對焦與影像傳輸之高解析度數
位式光學顯微鏡在電路設計與驅動程式的撰寫上已有一定的成果。本計畫也將實現高解析
度 CMOS 週邊電路與高速影像傳輸。如此，就可以完整的測試與設計相關高速影像傳輸的
技術。而本計畫將能掌握到此 USB 介面的核心技術，並有助於將此 USB 介面延伸至未來
網路連接與控制的技術能力。 
隨著新的消費性電子產品不斷推出，可以預知未來傳統設備的趨勢，必定會朝向整合、
精簡，多功能來加以發展。而本計畫也將提早規劃並實現了這個目標，並且加以產品化。 
 
五、參考文獻 
1. Universal Serial Bus Revision 1.0，1.1 and 2.0 
2. Don Anderson, ”Universal Serial Bus System Architecture”，Addison Wesley, 1997. 
3. Steven McDowell and Martin D. Seyer, “USB explained”, 1999. 
4. John Hyde, “ USB Design by Example: a practical guide to building IO devices”, Wesley, 
1999. 
5. Wooi Ming Tan，”Developing USB PC Peripherals，Using the Intel 9x930Ax USB 
Microcontroller”，Annabooks, 1997. 
6. USB development tools, www.usb.org/developers/tools.html.  
7. 許永和編著，”USB 週邊裝置設計與應用-CY7C63 系列”，全華科技圖書公司。 
8. 許永和編著，”微處理機-USB 週邊裝置設計與應用 EZ-USB(FX)系列”，長高電腦圖書
公司。 
9. CYPRESS SEMICONDUCTOR COM，www.cypress.com 
10. Richard Berry , “Choosing and Using a CCD Camera” 
11. 卓堅鵬,”影像感測器基礎及應用”, 全華科技圖書,1993  
12. 許書務,”光感測器介面專題製作”,電子出版社,1989 
13. 陳榕庭、傑克遜，”半導體封裝與測試工程－CMOS 影像感測器實務”， 全華科技圖書
公司，2004 
 
