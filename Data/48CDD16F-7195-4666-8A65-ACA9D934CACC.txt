摘要 
在傳統的誘捕系統技術中，不論
是低互動或中互動的誘捕系統，由於
其先天上技術的限制，經常無法完美
的模擬真實系統的所有行為，而被駭
客或病毒發現，以至於本來應該是用
來學習駭客入侵的誘捕系統，卻經常
無法捕捉到真正的入侵行為。 
在本計畫所提出的有主動防禦機
制的誘捕系統中，本身是由真實系統
所構建並加上一些過濾機制的處理，
所以本身能完美的模擬真實系統。另
一方面，由於本計畫所提出的過濾機
制，所以可以達到自我保護並防禦的
功能，此外，其間所有的流量都被記
錄到資料庫，因此可以記錄所有行
為，方便資安管理者了解駭客之入侵
手法，並透過對於所捕捉到的惡意程
式進行逆向工程的分析，包括分析其
所連結的惡意網站URL和惡意程式的
行為。 
 
關鍵詞：誘捕系統，高互動性 自我保
護 
 
簡介 
電腦與網路的使用帶給現代人許
多便利，電腦代替人處理許多繁雜的
工作，也因此人們越來越依賴電腦。
由於越來越多的攻擊工具出現，攻擊
者不需擁有很強的技術背景，一般人
就可以使用這些工具，使得網路管理
者風聲鶴唳，草木皆兵。導致今日網
路安全問題正日益嚴重。駭客利用自
動化的大規模的漏洞掃描工具，可以
在發現漏洞後不久就使許多的電腦系
統遭受破壞。然而經過數十年的研究
和探索，我們仍然不能確保電腦系統
的安全，甚至無法準確評估它們的安
全性。傳統的入侵偵測系統或防毒軟
體由於需要事先分析病毒碼，再對一
般使用者作更新，或者必須等到入侵
偵測事件的發生再套用新的規則作防
禦，這些都只是被動式的預防。因而
誘捕系統（Honeypot）的需要便因此
誕生。誘捕系統可以收集駭客的行為
並作分析，使資安管理者可以進一步
的提早防範。誘捕系統是指受到嚴密
監控的網路誘騙系統，它可以迷惑敵
人，將攻擊從網路中比較重要的機器
上轉移開，對新攻擊發出預警，更重
要的是可以引誘駭客攻擊而並對其攻
擊的行為和過程進行深入的分析研
究，可以防患於未然。我們可將誘捕
系統和入侵偵測系統、防火牆等結合
使用，利用誘捕系統可以主動式的事
先學習所有可能的入侵特徵，在真正
的攻擊行為未發生之前，讓入侵偵測
系統或防火牆學習相關的特徵進而避
免 所 謂 的 零 時 差 攻 擊 (Zero-Day 
exploit)。1 
在傳統的資訊安全領域中，駭客
常常利用一些惡意程式(比如說：病
毒、蠕蟲、或是木馬程式)來感染一些
電腦，接著駭客再使用這些受感染的
電腦當作跳板，來對目標伺服器作分
散式的阻斷服務攻擊並使遭到攻擊的
網站當機，無法提供線上服務。然而
隨著電腦技術的進步，跳版程式的形
式也越來越多樣化，攻擊的手法也日
趨複雜，而隨著駭客技術的進步，通
常在中了跳版惡意程式的主機如果程
式偵測到是虛擬機器的環境，則跳版
惡意程式經常不會有動作。加上傳統
的開放式源始碼的誘捕系統(如honeyd)
                                                 
1 零時差攻擊:從某個弱點被使用者發現到官
方釋出修補程式的這段期間 
當使用者下達指令之後，該指令不會
直接交由 shell 層來解析，而是會先交
由有主動防禦機制的誘捕系統來處
理。本研究之有主動防禦機制的誘捕
系統在根據設定及修改過的程式來決
定要如何回應。這整個過程可以用圖 1
和 2 來說明。 
 
圖 1  ifconfig 在一般正常系統之執行 
 
 
圖 2  ifconfig 在有主動防禦機制的誘
捕系統之執行 
如圖 1 所示，使用者下達 ifconfig
指令，這個指令經由 shell、kernel 層
層的解析後交由 hardware 來執行，產
生系統網路相關的資訊來回傳給使用
者。同樣的指令在有主動防禦機制的
誘捕系統中，執行效果就不同。如圖 2
示，使用者下達 ifconfig 指令，這個指
令會先經由有主動防禦機制的誘捕系
統來處理，若系統認為該指令屬於危
險指令，可能會使攻擊者獲得一些網
路或是系統相關資訊的指令，則主動
防禦，直接過濾掉，不會把這個指令
交由下一層 shell 執行，這種功能稱為”
正向表列”的過濾方式。 
 
核心技術 
在有主動防禦機制的誘捕系統
中，每當使用者下達一個指令之後，
本研究系統不是利用事先撰寫好的腳
本程式去對駭客所下的指令回應，而
是直接交由我們所研發的保護機制—
有主動防禦機制的誘捕系統來做處
理。有主動防禦機制的誘捕系統會先
對這個指令作分析，主動保護系統，
將把有問題的指令過濾掉，或者把允
許的指令執行的結果正確的回傳給駭
客。由於有主動防禦機制的誘捕系統
是構建一層防禦機制在真實的系統
(shell)之上，所以本計畫發展的有主動
防禦機制的誘捕系統裡包含三個模組
技術：惡意指令過濾和行為紀錄並網
頁監控介面三個模組。 
在惡意指令過濾模組中，除了如
圖 2 所描述會過濾危險指令的功能之
外，還會主動保護系統避免執行攻擊
者所下載程式或是竄改的指令。有主
動防禦機制的誘捕系統是一個誘使駭
客來攻擊的系統，因此，為了保護真
實系統的安全性，此誘捕系統必須要
能夠對指令或是執行檔進行監控，確
保駭客沒有對系統檔案進行越權的修
改。 
指令行為紀錄模組紀錄到底駭客
曾經對此誘捕系統執行過什麼動作，
必須確實記錄詳細的工作日誌。為了
解決這個問題，本計劃的具主動防禦
 
圖 5:大量被捕捉的惡意程式 
 
 
圖 6:惡意指令紀錄 
 
參考文獻 
1. J. Kinder, S. Katzenbeisser, C. 
Schallhart, and H. Veith. 
“Detecting malicious code by 
model checking.” Proceedings of 
the 2nd International Conference 
on Intrusion and Malware 
Detection and Vulnerability 
Assessment, Vol. 3548, pp. 
174-187, Vienna, Austria, July 
2005. 
2. G. McGraw and G. Morrisett. 
“Attacking malicious code: report 
to the Infosec research council.” 
IEEE Software, Vol. 17, No. 5, pp. 
33-41, 2000.  
3. M. Christodorescu, S. Jha, S. A. 
Seshia, D. Song, and R. E. Bryant. 
“Semantics-aware malware 
detection.” Proceedings of the 
2005 IEEE Symposium on Security 
and Privacy , pp. 32-46, Oakland, 
CA, USA, May 2005. 
4. J. Bergeron et al. “Static Detection 
of Malicious Code in Executable 
Programs.” Symposium on 
Requirements Engineering for 
Information Security, Indianapolis, 
Indiana, USA, March 2001. 
5. R.W. Lo, K.N. Levitt, and R.A. 
Olsson. “MCF: A malicious code 
filter.” Computers & Society, Vol. 
14, No. 6, pp. 541-566, 1995. 
6. S. S. Muchnick. “Advanced 
Compiler Design Implementation.” 
Morgan Kaufman Publishers, 
1997. 
7. Cristina Cifuentes, and Antoine 
出國心得 
參加會議經過 
2011 年 7 月 28-29 日於美國伊利諾州芝加哥大學舉辦的第 11 屆研究、
創 新 與 通 訊 化 會 議 (EITC 2011 Research, Innovation and 
Commercialization)中還包含四個研討會，主題有新綠能與環境、智慧綠能
建築與電氣化汽車；醫療、公共衛生、生物科技、與生物資訊；科學與資訊
新材料與奈米科技；寬頻科技與應用、網路安全、雲端運算與 SoC。本會議
匯集許多國際知名的專家學者交流與分享他們在雲端、資安、與 System on 
Chip、與無線網路等領域的經驗與研究成果，會議內容十分充實，不僅提供
與會者吸收新知，更是國際間技術交流的機會。會議分成四個 sessions，以
平行方式進行，研究有生物科技、奈米科技、醫療資訊、無線網路、資訊安
全、雲端運算、省電與綠能、與 System on Chip 等。 
 
與會心得 
    此次會議以無線網路、通訊應用與系統、資訊安全的研究為主，探討新
科技及其應用在各領域的研究及成果，不僅可以增廣見聞、開拓視野，我也
很榮幸地認識許多網路安全應用等方面的專家學者，增加許多學術交流的機
會，受益匪淺。 
    目前資通安全議題由網際網路逐漸延伸到無線網路與通訊、創新科技應
用為主的應用，無線視，訊娛樂服務是目前的創新服務之一、綠能以及其應
用於生物科技上的創新研究等，都是讓與會者吸收新領域的好機會。會議中
也廣泛地討論有關雲端運算上的資訊安全的議題，是個相當有趣且實用性的
研究。 
從彼此討論與交流中，學習到其它研究的想法，是此次出國開會得到
最有助益的收獲。感謝國科會的協助讓這次的行程能夠順利完成。也希望政
國科會補助計畫衍生研發成果推廣資料表
日期:2011/08/24
國科會補助計畫
計畫名稱: 有主動防禦機制的誘捕系統研究(開放軟體元件開發分項)
計畫主持人: 陳嘉玫
計畫編號: 99-2220-E-110-002- 學門領域: 自由軟體暨嵌入式系統
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
