計畫前言： 
    電子產品近年來有輕薄短小、組裝要求快速及相對面積下可容納更多元件，如錫
球、陶瓷積體電容、二極體、電阻器等，這些微小元件被大量使用在遊戲機 PS2 或
XBOX、行動電話、NB、PC、LCD 等其他電子相關產業，其需求大幅增加且占有相當
重要之地位，因此監控微小元件的品質，量測系統扮演相當重要的角色。 
由於元件尺寸微小，不易進行量測，且產量龐大不易導入自動的全檢作業，故須在製程
中抽樣檢測，以確保產品的品質，如果使用光學投影機來量測，僅適用於簡單的尺寸量
測且量測速度慢、費力及人員量測所造成的視覺誤差，加上產品尺寸愈來愈微小，客戶
對產品的要求愈來愈高，造成量測的困難，現列舉二例來說明： 
(1)錫球量測：錫球大量使用在 BGA  IC 封裝產品，錫球的真圓度尺寸決定 BGA 在機
板上的共面度，直接影響後續表面黏著作業，因此錫球尺寸的監控作業相當重要，目前
錫球的最小尺寸有 0.2mm。 
(2)晶片電容量測：晶片電容大量使用在表面黏著產品中，目前 0201 型式晶片電容長
2mm、高及寬 1mm，厚度則依電容量不同有所變更。 
這些微小元件小如沙粒般，量測數量龐大，目前一般業界針對這類微小元件的品管作業
有二階段：第一階段方式是採用篩子為檢測治具，多層不同網目的篩子層層過濾先做初
級分類，其原理為 GO，NO GO 方式作為大量篩選分級。第二階段方式採用抽樣作精密
檢測，目前常用量測工具與方法有三種：(1)光學投影機量測法。(2)雷射量測法。(3)視
覺量測法。雖然光學投影機量測、雷射量測的量測精準確高，但其缺點為：(1)人為量測
誤差及量測效率低，不適於大量量測。(2)量測作業繁雜枯燥，費時費力。 
目前視覺量測方法是採取單一 CCD 鏡頭，將 CCD 鏡頭手動移動至微小物件下取
像，才進行自動量測，而當抽樣檢測時，一批數量約為 4~5 百顆的微小元件，量測時須
先使用治具，使錫球排列整齊，再逐一進行每顆微小元件的外觀尺寸量測，如圖 1 所示。
由於量測機台使用的鏡頭為高倍率顯微鏡頭，其取像視野很小，所以當微小元件在量測
平台上，量測平台要移動到每個微小元件上，作業上比較費時，尤其是在抽樣數量龐大
時仍須花費較多作業時間。 
研究目的： 
本計畫針對各類型微小元件開發一套高效率及高精確度 2.5D 量測系統，設計此系
統所涵蓋的技術有視覺量測技術、視覺對焦技術、視覺校正技術、精密光學伺服機台設
計與控制技術、人機介面設計技術及系統整合技術等。 
文獻探討： 
以下針對目前常用量測技術做回顧： 
(1) 雷射量測技術：主要應用於 3D 表面輪廓的精密量測，廣泛的應用在 3D 曲面的檢測
統所涵蓋的技術有視覺量測技術、視覺對焦技術、視覺校正技術、精密光學伺服機台設
計與控制技術、人機介面設計技術及系統整合技術等。為了達到所述之 2.5D 量測理念，
在設計此精密量測系統，其具體研究方法如下： 
(1) 2D 影像視覺量測方法： 
影響量測元件 2 維尺寸精確性的主要因素有兩種：影像尋邊的解析方法。影像尺寸
校正。一般而言影像尋邊的解析能力決定了系統的量測重覆性，而影像尺寸校正則左右
量測精確度，但必須高重覆性才能達成高精度的量測，故影像尋邊的解析能力在量測系
統非常重要，在影像尋邊的解析能力取決於高銳利邊緣的成像品質及次像素影像尋找方
法，現就本系統所採用次像素尋邊方法說明如下： 
所謂次像素是將一般數位影像中最基本的單位「像素」，依數學式或其他方法將其
分割成更小的單位。換句話說，像素通常是以整數來表示，則次像素便是以具有小數點
的實數來表示。以圖 5 來輔助說明次像素之觀念，圖中每一格代表數位影像的一個像素，
d 值代表兩實線的距離，若根據傳統像素的觀念，d 值可能為 3 或 4 個像素，但若以次
像素的概念來看，則 d 值可以較精確的數值 3.6 個像素來表示，如此便可獲得較高精度
的影像資訊。一般常見的次像素邊緣檢測技術，大致可分為微分梯度法、二階導數法、
結構法以及動差法四種。本計畫所採用的是微分梯度法。 
首先，先求出邊緣概略位置，再以內插法反覆地求出較精確的位置，以達到次像素
的精度。當物體與背景的對比明顯時，物體影像的灰度值會有急遽的變化，如圖 6 所示。
若將影像作導數處理，其邊緣灰階變化之反曲點會是一階導數的極大值，此極大值再經
二階導數處理後其值為零，而灰度值在邊緣處二次微分為零的位置點則稱為零交越點，
可認定為邊緣的所在位置。 
在自動對焦技術，本研究方法提出一快速、精確之對焦點搜尋法，方法如下： 
Step1：將搜尋法分為四大步驟，大範圍的全域搜尋跟粗搜尋及小範圍的細搜尋跟微搜尋。 
Step2：以搜尋速度最快速之方法為全域搜尋跟粗搜尋，以對焦最精確能適於各種環境下
之方法為細搜尋跟微搜尋。 
Step3：先使用全域搜尋跟粗搜尋快速找到對焦點可能存在的範圍，儲存為樣本之位置參
數。 
Step4：使用細搜尋及微搜尋，精確的找出最佳對焦點。 
快速、精確之對焦點搜尋法有以下優點：(1)先以粗搜尋量測大範圍，可加快搜尋時
間。(2)不需設定過多的限制條件。(3)使用粗搜尋鎖定對焦點的範圍後，再使用細搜尋
並以多次內差進行搜尋，可避免只找到局部最大值與過衝量。 
整理以上所提出的方法，在空間域(space domain)上利用灰階的對比強度或利用一
階、二階導數的性質分析等，其運算速度快，但需要對比較為強烈的圖檔，否則分析並
然後計算出對焦位置 ( )111 ,, ZYX 對此平面的高度 H，即為微小元件的高度值。 
校正步驟如下： 
    Step 1：放置一片表面鍍有校正圖案的半透明玻璃。 
    Step 2：CCD 1 取像得知玻璃上全部校正圖案的中心位置。 
    Step 3：每一校正圖案的中心位置自動移到 CCD 2 鏡頭下取像，計算其中心位置及
對焦位置。 
    Step 4：將 Step 3 所得座標值，找出工作平台 cbyaxz ++= 中的 cba ,, 係數值。 
 
四、結果與討論 
本系統所該發的機構如圖 11 及與軟體設計的人機介面系統如圖 12，。本計畫針對
同一樣本之陶瓷積層電容高度尺寸重複量測 20 次，重覆性量測數據如表 1 所示，得到
重覆性數據為 0.02mm。在準確性方面，本文由量測系統所量測樣本的外觀尺寸與光學
投影機做比較，經量測後所比對的數值如表 2 所示。 
業界對於檢測系統能力評估主要的評估項目有二，一為重覆性，一為準確性。當確
定操作者穩定性分析，確定此因素適合於規範後，在進行檢測系統的重覆性分析，如此
的重覆性分析才有意義，並且要良好的重覆性，才會有量測的準確性，所以在進行準確
性之前，必須進行重覆性分析。 
重覆性主要測試機台的穩定性及軟體的解析能力。若一套檢測系統無重覆性的話，
則會造成量測結果變異性過大。準確性主要是測試尺寸量測是否準確及成像方法是否正
確。 
 
結果與討論： 
1. 本系統以三軸運動平台與光學尺為基本的硬體工作平台，再搭配雙 CCD 鏡頭及影像
擷取卡所構成的影像擷取系統，整合成高精度高效率微小元件 2.5D 量測系統。 
2. 此系統採用雙 CCD 的取像作業，可以一次量測大批的微小元件。先使用低倍率鏡頭
做大範圍取像，達到微小元件之定位，再針對單一微小元件外觀尺寸量測。 
3. 經由實際量測後，系統之長度、寬度、高度的重覆性分別為 0.2 um、0.1 um、16 um，
可以達到我們所要求的精度，並可增加業界對於量測微小元件之方法，可大量縮短
量測時間與人力資源。 
4. 自行開發的量測系統配合人機介面、影像處理及硬體設計架構等技術，具有完整性與
價值性的光機電系統。 
5. 本系統開發之微小元件 2.5D 量測系統，已有初步的完成，對於自動對焦量測高度部
份，雖然實驗精度已可達到可接受的範圍，但若希望再提高精確度及可靠度，應對
圖與表： 
          
圖 1 固定錫球治具儀器         圖 2 微小元件隨意放置圖 
      
圖 3 雙 CCD 取像示意圖           圖 4  2.5D 量測高度示意圖 
                
圖 5  次像素示意圖              圖 6 導數與物體邊緣關係 
       
     圖 7 尺寸校正圖                  圖 8 雙 CCD 相對位置關係示意圖 
 
表一 重覆性數據 
積層電容
規格0.5mm 高度(mm)
最大值 0.504 
最小值 0.501 
全距 0.02 
量測樣本 20 
平均值 0.5025 
表二 量測數據比較表 
 
 機台量測 投影機量測 
編
號
長度 
(mm) 
寬度 
(mm) 
高度
(mm) 
長度 
(mm) 
寬度 
(mm) 
高度
(mm) 
1 0.997 0.5 0.503 0.998 0.499 0.499 
2 0.998 0.501 0.504 0.997 0.501 0.501 
3 0.999 0.499 0.501 1.001 0.498 0.498 
4 0.998 0.5 0.503 0.998 0.5 0.499 
5 0.998 0.501 0.502 0.997 0.499 0.498 
6 0.999 0.5 0.501 1.001 0.501 0.497 
7 0.998 0.499 0.504 1.001 0.501 0.5 
8 0.999 0.5 0.503 0.998 0.498 0.5 
9 0.998 0.501 0.501 0.997 0.499 0.497 
10 0.999 0.502 0.503 1.001 0.5 0.499 
11 0.998 0.5 0.504 0.998 0.499 0.5 
12 0.998 0.5 0.502 1 0.498 0.498 
13 0.997 0.501 0.504 0.999 0.499 0.499 
14 0.997 0.501 0.503 0.997 0.501 0.498 
15 0.998 0.501 0.501 1 0.498 0.497 
16 0.999 0.5 0.502 1.001 0.499 0.499 
17 0.998 0.499 0.503 0.998 0.498 0.498 
18 0.997 0.5 0.502 0.998 0.499 0.497 
19 0.999 0.501 0.501 1.001 0.5 0.498 
20 0.997 0.499 0.503 0.998 0.499 0.499 
平
均
0.9980 0.5002 0.5025 0.9989 0.4993 0.4985 
