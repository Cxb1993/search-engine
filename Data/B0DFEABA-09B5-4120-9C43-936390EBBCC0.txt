(1) 整合 WiMAX 與 WiFi 網路作為情緒管理服務運算系統之通
訊骨幹系統； 
(2) 提升資料傳輸的服務品質，亦考慮到傳輸裝置的能源問
題； 
(3) 提出一個省電節能機制 (IPSS 機制) 以支援情緒管理服
務應用； 
(4) 延伸 WiMAX 網路涵蓋範圍以解決傳輸死角的 IEEE 
802.16j 的系統。 
 
中文關鍵詞： 心智負荷、情緒管理、WiFi，WiMAX，無線整合系統，不間斷
連線 
英 文 摘 要 ： In the nowadays highly competitive society, people 
usually need to accomplish intensive workload and 
encounter high pressure situation, causing puzzlement 
of emotion. Therefore appropriate emotion management 
and disconcertion become increasingly important. This 
project plans to develop an emotion management system 
on the basis of medical treatment. The focal point of 
the research is to develop an emotion incident 
detection system which integrated with the medical 
resources and information services in a local area. 
The emotion perplexed people can share or exchange 
films and music through the wireless network 
integrated system to promote people’s emotion 
recovery. Based on the results from the past two 
years, we continue on the following three working 
topics:  
 
1. An Event Detection Based Emotion Management 
Systems Service Design 
The human mood state will reveal on several different 
physiological signals. In order to realize human 
emotion management, the main focus of this sub-
project include:  
(1) The analysis of mental workload；  
(2) The discrimination of emotion intensity；  
(3) The emotion incident detection on multiple 
signals.  
 
2. Service integration and screening operation 
structure on the nursing medical treatment system 
行政院國家科學委員會補助專題研究計畫 ▓ 成 果 報 告   □ 期中進度報告 
 
植基於醫療看護之情緒管理與促進服務運算系統（3/3） 
 
計畫類別：□ 個別型計畫  ■ 整合型計畫 
計畫編號：NSC 97－2221－E－006－177－MY3   
執行期間：99 年 8月 1日 至 100 年 7 月 31 日 
 
計畫主持人：詹寶珠 國立成功大學電機工程學系 
共同主持人： 焦惠津 斯國峰 林輝堂 國立成功大學電機系 
楊延光 王琪珍 林梅鳯  國立成功大學醫學院 
             劉炯朗 國立清華大學資訊工程學系    
 
 
 
 
成果報告類型(依經費核定清單規定繳交)：□精簡報告  ■完整報告 
 
本成果報告包括以下應繳交之附件： 
□赴國外出差或研習心得報告一份 
□赴大陸地區出差或研習心得報告一份 
□出席國際學術會議心得報告及發表之論文各一份 
□國際合作研究計畫國外研究報告書一份 
 
 
處理方式：除產學合作研究計畫、提升產業技術及人才培育研究計畫、
列管計畫及下列情形者外，得立即公開查詢 
          ■涉及專利或其他智慧財產權，□一年 ■二年後可公開查詢 
          
執行單位：國立成功大學電機工程學系 
 
中   華   民   國 一 零 零 年 七 月
 
 
II
交流社群，可進行資源分享 
 
 
四、支援情緒管理服務之無線網路整合系統 
此子計畫提供不間斷服務連線，考慮系統平台之間的資料傳輸，大多仰賴 WiFi 及
WiMAX 網路上的傳輸。資料傳輸必須有一套專屬的網路整合系統去提供即時性的資料
傳輸。讓病患在 WiFi 及 WiMAX 網路間連線不間斷，並依據所能提供之網路狀況，提
供最佳之需求服務。 
(1) 整合 WiMAX 與 WiFi 網路作為情緒管理服務運算系統之通訊骨幹系統； 
(2) 提升資料傳輸的服務品質，亦考慮到傳輸裝置的能源問題； 
(3) 提出一個省電節能機制 (IPSS 機制) 以支援情緒管理服務應用； 
(4) 延伸 WiMAX 網路涵蓋範圍以解決傳輸死角的 IEEE 802.16j 的系統。 
 
關鍵詞：心智負荷、情緒管理、WiFi，WiMAX，無線整合系統，不間斷連線 
 
 
Abstract 
In the nowadays highly competitive society, people usually need to accomplish intensive 
workload and encounter high pressure situation, causing puzzlement of emotion. Therefore 
appropriate emotion management and disconcertion become increasingly important. This 
project plans to develop an emotion management system on the basis of medical treatment. 
The focal point of the research is to develop an emotion incident detection system which 
integrated with the medical resources and information services in a local area. The emotion 
perplexed people can share or exchange films and music through the wireless network 
integrated system to promote people’s emotion recovery. Based on the results from the past 
two years, we continue on the following three working topics:  
 
1. An Event Detection Based Emotion Management Systems Service Design 
The human mood state will reveal on several different physiological signals. In order to 
realize human emotion management, the main focus of this sub-project include:  
(1) The analysis of mental workload;  
(2) The discrimination of emotion intensity;  
(3) The emotion incident detection on multiple signals.  
 
2. Service integration and screening operation structure on the nursing medical treatment 
system 
This project develops a medical treatment system offering an integration service to 
patients according to the patient's states and local medical resource restriction. The core of 
this project includes:  
(1) Develop a medical care analysis sub-system;  
(2) Develop a medical care searching sub-system. The medical care subsystem can access the 
database (Service Pool) to find the relevant service of medical treatment which best efficiently 
suits the demand;  
(3) Develop a medical care selection sub-system, the system provides the best service 
considering the dependency relationship of medical treatments between the relevant services;  
 
 
IV
目錄 
摘要 ............................................................................................................................................. I 
Abstract ..................................................................................................................................... II 
目錄 .......................................................................................................................................... IV 
圖目錄 ....................................................................................................................................... V 
表目錄 ....................................................................................................................................... V 
研究方法與成果 ........................................................................................................................ 1 
子計畫一、基於事件偵測之情緒管理系統服務設計 ............................................................ 1 
2.1 心智負荷(Mental workload) ............................................................................................. 2 
2.1.1 分析方法 .......................................................................................................... 2 
2.1.1.1 特徵計算 ....................................................................................................... 3 
2.1.1.2 特徵選取 ....................................................................................................... 4 
2.1.1.3 分類器 ........................................................................................................... 5 
2.1.2 實驗結果 .......................................................................................................... 6 
2.1.2.1 HRV 趨勢觀察 ............................................................................................... 7 
2.2 使用 ECG 於 4 類情緒/情緒程度分類 ............................................................................ 7 
2.2.1 分析方法 .......................................................................................................... 7 
2.2.2. 實驗結果 ......................................................................................................... 8 
2.3 信號切斷分析 (Emotion Segmentation) ......................................................................... 9 
2.3.1 分析方法 .......................................................................................................... 9 
2.3.2 實驗結果 ........................................................................................................ 11 
子計畫二、應用服務整合與篩選運算架構於醫療看護運作體系 ...................................... 12 
子計畫三、建構於 WiMAX 無線網路上支援情緒管理之多媒體傳輸系統 .................... 15 
3.1 分析方法 ......................................................................................................................... 15 
3.1.1 移動模型 ........................................................................................................ 15 
3.1.2 傳輸機制 ........................................................................................................ 16 
3.1.2.1 需求 ............................................................................................................. 16 
3.1.2.2 系統模型 ..................................................................................................... 17 
3.1.2.3 系統模組 ..................................................................................................... 17 
3.2 實驗結果 ......................................................................................................................... 19 
3.2.1 模擬環境 ........................................................................................................ 19 
3.2.1 模擬結果 ........................................................................................................ 19 
子計畫四、支援情緒管理服務之無線網路整合系統 .......................................................... 22 
4.1 整合型 WiMAX/WiFi 架構 4.1.1 分析方法 .............................................................. 23 
4.1.1.1. THBA 機制 ................................................................................................ 25 
4.1.2 實驗結果 ......................................................................................................... 27 
4.1.2.1 效能評估 ..................................................................................................... 27 
4.1.2.2 數據結果 ..................................................................................................... 28 
4.1.2.3. 結論 ............................................................................................................ 29 
4.2 研究 WiMAX 服務品質保證(QoS)與省電節能機制以支援情緒管理服務應用 ....... 30 
4.2.1 分析方法 ........................................................................................................ 30 
4.2.1.1. IPSS 架構介紹 ............................................................................................ 31 
4.2.2 實驗結果 ......................................................................................................... 33 
4.2.2.1. 系統分析 .................................................................................................... 33 
4.2.2.2. 模擬與分析 ................................................................................................ 37 
 
 
VI
表 2 IBPSO-Mental workload 分析結果 .................................................................................. 6 
表 3 分別使用 SFFS+pLDA 或 mRMR 於 4 類情緒識別上的結果 ..................................... 8 
表 4 使用 SFFS+pLDA 特徵挑選法於 KNN 的階層式分類法 ............................................. 9 
表 5 音樂情緒類別的音樂特徵規則 (1/2) 符號 ‘?’ 代表該音樂特徵於該情緒類別沒有
明顯規則) ................................................................................................................................. 13 
表 6 音樂情緒類別的音樂特徵規則 (2/2) (符號 ‘?’ 代表該音樂特徵於該情緒類別沒有
明顯規則) ................................................................................................................................. 13 
表 7 各音樂特徵擷取模型的精確性 (leave-one-out cross validation) ................................ 14 
表 8 音樂訊號分類模型及音樂特徵分類模型針對音樂情緒分類的精確性比較 ............. 15 
表 9 模擬參數 ......................................................................................................................... 19 
表 10 模擬劇本 ....................................................................................................................... 39 
 
 
 
 
 
 
 
 
 
2
個人靜止不動。一個人除非行為靜止，否則接會受人工雜訊的干擾。這些干擾對信號的
影響是破壞性的，即幾乎無法使用工程上的技術恢復。為此，為了建構基本情緒類型與
生理反應的關係上。我們需對於此必然的雜訊干擾，找到一個合理的排除機制。在本計
畫中，我們提出一個自動切斷與代表性情緒片段截取的方法。 
除了在排除雜訊的技術上開發。我們也針對相對抗雜訊的心電信號(ECG)作單一生
理信號的分析，心電圖在近日的發展下，容易測量且方便攜帶。。ECG 最常用的指標為
心律變異(HRV)。HRV 是一種量測心跳跟心跳之間時間變異程度的一種計算方法。心律
變異受自律神經系統控制(Autonomic nervous system )，掌管了心跳、呼吸、血壓以及體
溫等等無法由自己所控制的行為。而自律神經系統可分成二個系統，一面反應人體受所
受到外力刺激，一面進行內部調節，構成一個自律系統。自律神經系統分成交感神經系
統(sympathetic nervous system)以及副交感神經系(parasympathetic nervous system)。當交
感神經上升血壓會上升、心跳會加快、呼吸變快、體溫增高以及消化作用減慢，來應付
所面臨的問題如壓力危險等等狀況。當副交感神經上升血壓會降低，心跳會變慢讓人體
進入休息狀況保持體力。 
我們藉由萃取HRV在頻域 (frequency domain)和時域 (time domain)的特徵針對 4種
情緒分類，並對每一個情緒分成三個程度來分析其可識別性。同時，我們也使用 HRV
連續性的偵測受測者的心智負荷。心智負荷分析亦分成低、中、高三種程度。計畫中，
兩段式分類也被使用於本方法中去改善分類的效能。並於特定特徵中去觀察應徵者在持
續注意力時 HRV 趨勢的變化。 
 
2.1 心智負荷(Mental workload) 
 
2.1.1 分析方法 
此實驗目的主要是用醫學上常用來測驗持續注意力的工具來當作引發受測者在不
同狀況下的心智負荷，然後我們再搭配心電圖(ECG)儀器記錄使用者的生理訊號反應而
取樣頻率設定為 500HZ，紀錄受測者在不同心智負荷下所產生的反應為何。而實驗參照
Picard[4]所提出的實驗步驟，將休息時間當成低心智負荷另外中或高心智負荷利用量表
評估。 
在一般工具中引起持續注意力測驗分別會有 LCT(letter cancellation task)和
CPT(continuous performance test)。LCT[5]的測驗方式為刪字測驗，測驗內容要求使用者
在一堆英文字母中找到目標(H 字母)，然後做刪除的動作，如此持續到時間停止。LCT
除的用於注意力測驗之外，並且有診斷 visual-spatial dysfunctions 的功能。 
我們安排 69 位來自成功大學的學生當作受測者，年齡在 18-24 歲之間。而實驗的
地方是安排在一間安靜的房間內進行，目的是避免受測者在實驗中被打擾。當解說完畢
之後會開始進行實驗，總共實驗的時間會持續 50 分鐘，包含休息和兩個測驗。而測驗
內容主要是 CPT 持續效能測試和 LCT 刪字測驗，時間根據之前所做的實驗受測者認為
13 分鐘最為合適。CPT 是臨床上普遍使用來測驗持續性注意力的工具是比較屬於被動
式的測驗，測試時會要求使用者在一定時間內做出反應。而 LCT 刪字測驗則是屬於主
動式測驗，實驗中會要求使用者在一定時間內持續作刪除的動作，因而是屬於自主性的
測驗。 
 
 
4
 
(2) Frequency domain 
在頻率域計算方法[11]我們使用快速傅利葉轉換(Fast Fourier transform)並且搭配
HANNING WINDOWN(漢明視窗)計算。在此我們總共計算出七項特徵，分別為 LF(低
頻 0.04-0.15HZ)表示為交感神經、HF(高頻 0.15-0.4HZ)表示為副交感神經、VLF(極低頻
0.0-0.04HZ)、TP(總功率 0-0.4HZ)、LF/HF(低頻和高頻的比值)表示交感和副交感的調節、
LFnu(正規劃的 LF)以及 HFnu(正規劃的 HF)其中正規劃的 LF 和 HF 算法如下而圖 3 表
示各個頻率域的分布範圍。 
( )*100%LFLFnu
TP VLF
                                           
( )*100%HFHFnu
TP VLF
                                             
 
(3) Non-linear analysis 
在非線性的分析方法在此所使用的分別為 Poincare plot 以及 sample entropy。由
M.Brennan[12]所提出Poincare plot是一種用來表達連續兩個RR-interval相關性的圖示表
示方法，其將 x 軸表示為 RR interval(n)，y 軸表示為 RR interval(n+1)其中 n 表示為 RR 
interval 的個數。如果將(RR(n),RR(n+1))經過公式八的座標轉換公式得到新的座標以
( 1x 2x )表示。令 SD1 為經過座標轉換過的 1x 標準差，代表短期心律變異程度也代表副交
感神經活耀度，令 SD2 就是經過座標轉換過的 2x 標準差，則其可用於代表長期的心律
變異程度，也代表交感神經和副交感神經的調節[6]。而 SD12 則是 SD1 除以 SD2 的值，
表示交感神經活耀度。  
     1
2
cos sin
=45
sin cos 1
x RRn
x RRn
   
            
                                
 
 
圖 3 POINCARE PLOT(橫軸為 RR(n)，縱軸為 RR(n+1)) 
 
Sample entropy 是由 Approximation entropy[1]所改進的方法，由 Richman[2][7]所提
出，近來被廣泛用來評估 time series 的複雜度。當複雜度高時，我們所求得的 Sample 
entropy 的數值會比較高，而複雜度低的時候所求得的數值將相對比較低。 
     
2.1.1.2 特徵選取 
在此我們使用特徵選取的方法主要原因有兩項，第一是去除不必要的特徵並達到降
低維度的目的，第二為增加分類的辨識率。而在此我們特徵挑選方法選擇使用 SFFS 由
P.pudil.[3]提出，是一種降低維度的特徵選取方法，演算法中結合 Sequential Forward 
Selection (SFS)以及 Sequential Backward Selection (SBS)方法。SBS 是一種 Top to down
的方法，先從全部特徵開始挑選，之後再一次減少一個特徵，直到找到剩一個特徵才停
止，之後再由過程中找出最佳的特徵出來。而 SFS 跟 SBS 則相反是一種 Down to top 的
方法，作法中先從最少的一個特徵開始，之後再慢慢增加特徵個數直到全部特徵挑完才
停止，之後再由過程中找出最佳的特徵出來。而 SBS 和 SFS 有一個相同的問題就是
 
 
6
 
 
 
2.1.2 實驗結果 
而從量表得到的 Ground truth 之後我們再利用本篇論文所提出的分析架構流程使用
實驗過程中收集到的 HVR 生理訊號，辨識受測者是處在何種程度的心智負荷，而我們
總共測試在一階段辨識 (One phase classification) 以及兩階段辨識 (Two phase 
classification)的結果由下面表格 1、2 中我們所以觀察到辨識率結果，若使用一階段辨識
率最高辨識率可以達到 77%但是若使用兩階段辨識方法就可以達到 85%的辨識率。我們
從結果可以觀察到在對於 multiclass 的問題使用 multi classifier 效果會不如使用兩段辨識
的方法可以使整體辨識率提升 8%左右，而在此最佳為 SFFS+PLDA。 
 
表 1 SFFS-Mental workload 分析結果 
 Leave one out cross validation Ten-folding cross validation 
PLDA+KNN LFDA+KNN PLDA+KNN LFDA+KNN 
One phase 
Classification 75.85% 75.38% 74.42% 73.80% 
Two phase 
Classification 85.25% 84.37% 84.61% 83.62% 
 
 
表 2 IBPSO-Mental workload 分析結果 
Low Medium or high?
Medium High 
Classification rate= (Correct1+Correct+2+Correct+3)/ALL 
Classifier 
Mental workload? 
FS 
Classifier 
T: Correct1+=1 
F: Correct1+=0 
Mental workload 
Medium or High? 
FS 
T: Correct2+=1 
F: Correct2+=0 
T: Correct3+=1 
F: Correct3+=0 
圖 4 phase classification(兩段式分類法) 
 
 
 
8
 
圖 7 特徵挑選流程圖 
 
 
 
2.2.2. 實驗結果 
我們使用了 3 個影片來引出人的情緒與不同程度的情緒。受測者一剛開始處在平靜的狀
態，整個實驗流程如圖 8 所示。 
 
End
ECG Recording Simultaneously
15 min 15 min 10 min 10 min15 min 15 min
Self-report Self-report Self-report Self-report
 
圖 8 Procedure of the four emotions inducing experiments 
 
受測者回報時，跟據他們感受情緒的程度依 1~10 等級回報。當受測者回報的的等級
介於 1~3 之間，則視該情緒的程度為”低”，介於 4~6 之間，則視該情緒的程度為”中”, 若
回報高於 7 則視該情緒的程度為”高”。共有 73 個學生參與我們的研究，並且這些學生
都通過情緒表達障礙量表的測驗(“emotion expression of obstacle scale”)， 
 
表格 3 為使用 SFFS+pLDA/mRMR 於 KNN 分類器的結果。可以發現使用 SFFS 或
mRMR 來找特徵的效能在不同情緒上各有優缺。 
 
表 3 分別使用 SFFS+pLDA 或 mRMR 於 4 類情緒識別上的結果 
 Calm Joy Sad Fear Average 
SFFS-KNN 90.9% 83.3% 63.6% 72.7% 77.65% 
mRMR-KNN 96.97% 71.21% 66.67% 68.18% 75.758% 
 
為了增加準確率，我們使用了一個 2 階識別法。即一次分兩群，分兩次完成 4 個情
緒識別的方法。但究竟哪兩個先分，哪兩個後分，仍是個議題。4 個情緒每次挑兩個來
分類，共有 12 種可能的組合。為了找出效能最高的組合，我們提出了一個程序： 
Step 1: 找出識別率最高的情緒 
Step 2: 將識別率最高的情緒視為一群，其它的當作另一群 
Step 3: 取出識別率最高的一群，若仍有兩個以上的情緒尚未分類，回到 Step1 重新另一
 
 
10
其作法如下： 
令 tS 含有 p 個轉態點。則作為 tS 的 CumSAG 信號，將有 1p 個不同斜率的片段。令
上的折點分別為 },...,,...,{ 0 pj  ，其中 0 為上的第一個點。令 },...,,{ 21 nLLLL  為
一條連接之第一個點與最後一個點的直線，其中 ntL 1}{ 定義為  11  nt n
tL 。則折
點 j , },...,2,1{ pj 可以由以下計算得到： 
|}{|maxarg* ttt Lt  。其中
j = t*。下圖 10 所示之範例 

jt
tL
 
t t
 
圖 10 與 L 的最大差即是上的一個折點 
 
當找到一個折點時，可由的左半部與右半部再尋同樣的法則切斷，如此遞迴運算，直
到下面的條件滿足： max1 )(   jj , j 。 max 為經驗值，通常一個情緒會維持數個週
期。 max 建議至少也要有數個週期。 
以上的方法，我們稱為由上而下切割法。這樣的切割只是把信號以 Quasi-Homogeneous
的改變不斷的往下切。並沒有顧慮到所切出來的片段，是否合我們所需，意即能更符合
一段情緒持續的反應。於是，我們使用一個由下而上的合併法，此合併法依據
Bhattacharyya 距離[17]，作為相鄰兩個片段是否相似到足夠合併的判斷依據，定義為 
   )|~()|~(),( 11 jjjj XSpXSpXX 。 
 
且  11B 。其中  1,0B 。 若兩測量的片段在機率分佈上極相似，B 值趨近於 1，
反之 B 值趨近於 0。對任兩相鄰片段 ),( 1jj XX ，計算 B 值，定義為
JB , },...,1,0{ pJ  ，其
中 iniB 與 iniB 分別表示 JB 的平均值與標準差。不失一般性，假設 JB 滿足高斯分佈，且
),( LU ZZ 表示 JB 的兩個百分比。則合併的程序則持續直到以下條件不滿足： 
                       
 

LiniBiniB
J
UiniBiniB
J
ZBmean
ZB


)(
)max(
  。             
一旦條件滿足，即將 JB 最大值的兩個相鄰片段合併，並重新計算新片段與左右相鄰片
段的 B 值，如此即會更新 JB 。圖 11 顯示幾個情緒實驗中呼吸信號的偵測結果。 
(b)(a) (c) 
 
 
12
在 BVP 中亦可代表受呼吸影響的低頻信號。我們將原信號減去濾波後的信號後，並與
Hamming window 進行摺積運算以得到最後處理的信號。圖 12 是我們計算出來群 tC 中
片斷，對應到呼吸信號時間序列上的幾個例子。  
 
圖 12 自調控分群分析後取得的片段 
 
子計畫二、應用服務整合與篩選運算架構於醫療看護運作體系 
 
    此子計畫目的在於解決醫療資訊管理系統本身的區域化系統建構限制，目前區域間
的溝通仍舊由醫院的服務人員進行轉換及處理。為提供完整的資訊共享，須整合分散的
醫療及健康照護領域相關的服務。在目前現有技術中，服務導向運算在近年來已大量地
被用來解決異質性系統整合不易的問題。如何以有效率的方式完成需求有所改變的各種
醫療相關服務整合，必須依賴於有效率的軟體服務重用之上。因此，在此計畫中，我們
所著重的是，怎樣利用既有的醫療服務，引入服務導向軟體開發流程中，將之分類與整
合，以期能降低新的醫療服務開發之花費，並快速而正確地為使用者提供適用的整合性
醫療服務。 
 
2.1 實驗結果 
在第一年度主要的工作為相關文獻、資料之彙集、研讀及整理；進行各種可能
醫療相關服務之列舉與蒐集，以作為系統最初可以使用的醫療相關服務之集合，同
時針對常用的醫療相關服務進行系統設計，如：音樂治療系統，音樂可以引發病人
的各種不同情緒反應，利用音樂對於病人進行治療歷史已有長久的歷史，因此選擇
以音樂治療系統在醫療以及健康照護行為上提供服務。為能提供音樂治療服務，音
樂治療系統中其中一個重要的功能便是對音樂依據其所表達的情緒進行分類，為達
 
 
14
 
圖 13 音樂特徵擷取模型的訓練及測試程序 
 
 
 
   表 7 各音樂特徵擷取模型的精確性 (leave-one-out cross validation) 
 
 
 
 
在接續第二年度進行完整合的工作之後，我們與此整合型計畫的其他相關計畫
進行整合與測試。在此過程中需包含大量的情境測試，以及應用於實際醫療體系的
可用性測試。同時對於已完成的系統進行必要的調整。 
    而在音樂治療系統方面，根據第一年度及第二年度的結果，已建立音樂特徵進
行音樂情緒分類的分類規則，如圖二，且比較過去及此計畫中對音樂情趣的分類方
式，可發現使用音樂特徵的分類方式與過去直接使用音樂訊號特徵有相近的精確
性，其結果如表四。 
 
圖 14 利用音樂特徵建立的音樂情緒分類規則 
 
 
 
 
 
16
 
圖 16 Soft handoff 
 
 
交遞動作可分為硬交遞 (Hard Handoff) 和軟交遞 (Soft handoff)。如圖 15 所示，硬
交遞就是先將來源端基地台的連結切斷之後，才能與目的端基地台建立連結。行動通訊
設備在同一時間只能與一個基地台連結。因此硬交遞必須在兩個基地台重疊區域內快速
地轉移，使通訊中斷時間降到最短。硬交遞屬於先斷後連的架構。圖 16 中，軟交遞暫
時保留與來源端基地台的連結，並且同時建立與目的端基地台的連結。行動通訊設備在
同一時間只能與多個基地台連結。軟交遞屬於先連後斷的架構。 
 硬交遞的一個優點是在任何時間點，一個行動通訊設備只會使用一個頻道。通常硬
交遞所花費的轉移時間非常短，行動通訊設備也不會察覺到轉移事件的發生。硬交遞的
另一個優點是由於不需要同時間在多個頻道上進行通訊活動，因此也降低的客戶端硬體
設備的需求，使客戶端硬體設備得以更便宜和更簡化。而硬交遞的缺點則是若交遞時發
生錯誤，則通訊活動會暫時地中斷甚至異常地終止。 
 軟交遞的一個優點是當已經確定與目的端基地台建立可靠連結之後，才會將與來源
端基地台的連結中斷，因此當交遞發生錯誤時，而造成客戶端的通訊活動異常終止的可
能性非常低。而這項優點來自於較複雜的客戶端硬體設備，這種客戶端硬體設備必須能
夠同時在多個頻道上進行通訊活動，較高的硬體成本是軟交遞所需要付出的代價之一。
由於在無線網路中，大部分的交遞動作通常發生在基地台稀疏的區域，在這些區域內，
當頻道受到干擾或著衰退時，連結常常變得不可靠，而軟交遞使得在單一頻道上的干擾
或衰退影響程度大幅降低，大大地增加連結的可靠度。軟交遞所要付出的另外一個代價
是需要用多個頻道來維持一個連結。 
 不論是使用硬交遞或軟交遞都不會影響我們的成果。幾乎所有的串流網路都有資料
暫存器的設計，硬交遞造成的連結短暫中斷不會有任何影響。雖然軟交遞可以讓通訊活
動不會中斷，但需要額外的硬體設備。 
3.1.2 傳輸機制 
 此計畫使用的系統包含一個中央伺服器和一些基地台及其涵蓋範圍內的使用者所
構成的群組 (BSGs)。如圖 17 所示，以樹狀拓樸呈現系統架構，在一個 BSGs 內包含了
一些種子和一些一般節點，種子是相對一般節點而言移動性較低的節點。 
 
3.1.2.1 需求 
以下是網路協定電視的傳輸機制的服務要求： 
定位服務 : 每個基地台有獨特唯一的識別碼。識別碼可被鄰近的基地台存取；每個客戶
端可以從自己所屬的基地台或著鄰近的基地台獲得它們的識別碼。網際網路服務提供者
知道所有基地台的識別碼。 
節點移動性 : 某些節點會移動，例如位於車子內的使用者。某些節點固定不動，像是在
家中或著辦公室的使用者。 
 
 
18
 
Stotal 代表 BSG 中所有的種子數，而 bG 代表 BSG 中的分支數。這條式子顯示 BSG
必須傳送完整的 bG 的分支數。每個種子只需要傳送一次串流描述，但是小孩 (Childs) 們
卻必須 n 個種子來保證完整的品質。α代表 BSG 是否可以滿足其他 BSG ’ 的性質；當
α < 0，BSG 的種子數不足以支撐 bG 小孩群。某些小孩群會收到小於 n 個的描述。若任
何節點加入了 BSG 可是 α < 0，則伺服器會指定該點成為種子來提昇 α；當 α＝0，BSG
的種子剛好足以支撐 bG 小孩群。當 α >0，則代表 BSG 中有些種子是處於閒置，伺服器
可以分配更多其他的 BSG 給他的小孩。在我們的方法中，伺服器得分支數目是有限的，
但對於每一個 BSG 是無限的。 
 
在一般傳輸的時候，所有的節點根據多重播送 IP 來接收從 BSGp 的種子傳出來的資
料流，然後將種子傳遞給小孩的 BSGs。因為種子負責傳遞資料流，所以保持充足的種
子數是必須要的。系統對於每個節點設了二個參數 T 和 t，t 紀錄了節點待在 BSG 的時
間。任何節點待在某個 BSG 的時間大於 T 秒的話 ( t > T ) ，該點會成為種子。若 BSG
有更多的種子，BSG 的可靠度會更好，而且他的 BSGs 的品質也會更好。 
 
 
圖 18 An example of SWAP event 
  
由於機動性，一個節點可能會脫離目前的 BSG 而去加入另一個 BSG。若該節點需
要重新使用該資料流，則該點必須知道在新的 BSG 的多重播送群 IP。為了完成交遞的
動作，每個節點應該知道鄰居 BSG 的種子名單。為了達成這個，每個種子每隔一段時
間廣播資料給他的鄰居 BSG’，包含多重播送群 IP，自己 BSG 裡的種子名單。若目前的
基地台，沒有使用任何伺服器所提供的服務，為了加入系統該節點必須傳送一個要求給
伺服器。有了這些程序，因為節點沒有掌管任何東西，任意的普通節點移到其他 BSG’ 時
不會影響系統。從另外一個角度，若一個種子離開目前的 BSG，就會有某些額外的工作
要去做。在同 BSG 裡的種子需要交換訊息來確保彼此是否還存在。若是有任意一個種
子傳訊息失敗，其他的種子將會把傳送失敗的種子踢出自己的種子名單，並且通知伺服
器。若傳送失敗的種子剛好是負責傳遞資料流的種子，其他種子將會接管他的工作。除
非目的地的 BSG 有 α < 0 的情形，否則離開的種子將會變為普通的節點。顯然的，若 BSGp
中沒有充足的種子，BSG 中的種子的影像品質會很差。我們的方法是提供 SWAP 的方法
來解決。在圖 4.2，BSGc 會跟 BSGB交換自己在邏輯樹的位址。為了實做這個動作，種
子需要保存二層種子的資訊，包含了父母的 BSGp 以及祖父母的 BSGgp。種子因此需要
廣播 BSG 和 BSGgp 種子資訊給小孩 BSGs。一般節點不需要二層的資訊因為他們在
 
 
20
離開 BSGs 導致效能下降。 
 透過模擬，統計了每個節點服務一個種子的時間，並測量了提供串流的時間，結果
展示在圖 21，總種子時間隨著移動機率的增加而下降，即使將較高移動性的節點當作種
子，仍然較容易發生換手事件，由於某些節點正要離開邏輯樹，因此他們並不用服務任
何小孩群組，不會傳輸任何串流描述。 
 
 
圖 19 在不同的移動下接收到的串流描述數量 (a)30% (b)50% (c)70% 
 
 
 
22
 
圖 21 在不同移動比例下的種子時間及串流時間 (a)30% (b)50% (c)70% 
 
 
 
子計畫四、支援情緒管理服務之無線網路整合系統 
此子計劃研究一套可支援即時性資料傳輸的整合無線網路系統。當使用者在使用情
緒管理服務系統時，由一個地方移動到另一個地方，其行動裝置所連接的無線網路可能
由原先的 WiFi 網路變成 WiMAX 網路，或由 WiMAX 網路變成 WiFi 網路，在此換手 
(Handoff)過程中情緒管理服務應繼續進行而不應該受到網路換手的影響造成其服務品
質下降甚或中斷。如前所述，如果情緒管理服務運作不順暢或中斷，可能造成使用者情
緒上感受到不耐煩與挫折，影響到情緒管理服務的效果，更甚者可能會觸發其負面情緒
惡化成躁鬱或憂鬱，反而造成整體情緒管理服務系統失效。因此在本計畫中也將對
WiMAX 網路與 WiFi 網路間的換手機制進行研究，使得情緒管理服務在因移動造成網路
換手時，其運作不受影響或將其影響降至最低。 
 
本計畫在無線寬頻存取網路上提出了具有統一連接導向架構之整合型
WiMAX/WiFi 無線網路系統。此系統中包含一個新穎的  WiMAX/WiFi 無線存取
(W2-AP) 裝置與 WiFi 節點，以管理 WiMAX/WiFi 的介面。另外，在 WiFi 節點中嵌入
了 802.16 用戶平台 (Subscriber Station，簡稱 SS) 的 MAC 協定以取代原有 802.11 MAC 
 
 
24
從 802.11a 實體裝置送來的封包，MultiMAC 會依目前的網路狀況決定由何種 MAC 協
定 (即 802.11 MAC 協定或是由 SoftMAC 和 802.16 BS-MAC 所組成而成的聚合 MAC 
協定) 認收此封包。舉例來說，若某個 WiFi 節點的後置式網路為 WiMAX 網路，W2-AP 
中的 MultiMAC 會將 WiFi 節點所送達的封包送往聚合 MAC 協定層，並將此封包透過
802.16 PHY 介面轉送 (Relay) 至後端 BS。因此，W2-AP 裝置藉由 MultiMAC 與
SoftMAC，成為一個橋接器，以負責轉換在 WiFi 和乙太網路或是 WiFi 與 WiMAX 網
路之間的封包。再者，由於 W2-AP 包含了 802.16 MAC 中的 SS 模組與 BS 模組，則
此裝置可視為一個 WiMAX 子基地台(sub-BS)，以收集多個 WiFi 節點之頻寬請求再一
併傳送至 BS，並且配置 BS 所同意的頻寬給予 WiFi 節點使用。因此，本論文所提出利
用更新現有的 802.11 存取點裝置(如圖 22 (a)所示)，可使得 W2-AP 裝置動態的選擇有
線的乙太網路或是 WiMAX 技術作為後置式網路，提供室內或是室外的使用者存取網路
的服務。 
 
圖 23 兩階層式頻寬配置機制 
 
對於 WiFi 節點而言，傳統網路介面卡可透過韌體更新技術新增 MultiMAC ，
SoftMAC，以及 802.16 SS-MAC 等模組於 MAC 協定層中。如圖 22(b)所示，當 WiFi 節
點收到一個框架時，其 MultiMAC 下層模組會依封包標頭的識別碼分派此框架到合適的
MAC 協定進行處理。而 MultiMAC 上層模組負責將上層協定託付傳送的框架轉送到合
適的 MAC 進行傳輸，以增加面對不同應用之助益性。而所提出的協定模組中，亦可允
許 WiFi 節點分別傳輸 802.11 和 802.16 的封包到有線的乙太網路與無線的 WiMAX 網
路。因此，藉由更新 802.11 網路介面卡韌體架構之優點，提供位於 WiFi 熱點內的使用
者透過 local-WiMAX 方式存取後置式網路服務。換句話說，使用者不需額外購買
WiMAX 介面卡，僅更新傳統 WiFi 介面卡之韌體便可透過 WiMAX 系統存取網際網路
服務。此架構可進而大幅減少硬體以及網路建置成本。對於架構中之 BS 的 MAC 協定
而言，乃依照標準化規格而設計。此 BS 可分配 SS 及 W2-AP 可用的頻寬，進而使得
WiMAX 及 WiFi 達成共存合作於單一整合網路中。本論文提出的整合型網路架構對於整
合異質性網路領域之研究是一個相當有效的解決方法，可多方面應用。例如提供“個人
化 (personal) ”熱點服務，即一群在網路環境完備的大樓中的商務人員準備前往罕於使
用網路服務的鄉村或是郊區洽公時，此時這群人仍使用大樓內的網路存取服務，但他
們希望抵達洽公處時，仍可持續利用網路服務以完成公事。而為了支援個人化熱點存
取之需求，每個使用者僅須配備經韌體更新後之 WiFi 網路介面卡 (即本文所提出的
WiFi 節點架構) 與附近的 W2-AP 裝置連結，藉由大樓內的有線後置式網路存取網路
服務。當離開大樓時，他們可以攜帶 W2-AP 裝置以便透過戶外的 WiMAX 服務存取網
際網路。此種個人化熱點服務使得上述情境在近期內利用所提出的架構得以實現，使
 
 
26
WiFi 系統中的原始協定不需要大幅修改，可降低整合異質性網路所需的複雜度與費
用。第二則是令 WiFi 網路可以提供 WiMAX 網路相似的 QoS，而不需特別設計兩者間
之 QoS 對應協定 [24]，就可維持整體網路的服務品質與頻寬管理一致性。 
在 WiMAX/WiFi 整合型網路中，BS 或是 W2-AP 裝置所廣播的框架結構分別包含了
下傳 (DownLink，簡稱 DL) 子框架(subframe)與上傳 (UpLink，簡稱 UL) 子框架，如
圖 24 所示。DL 與 UL 子框架在主框架中所分配的比例，可依據目前的網路上下傳流量
比例動態決定子框架的長度。DL 子框架結構中，首先為週期性廣播的控制訊息，此訊
息包括 DL 同步訊號 (preamble)，框架控制標頭 (未顯示在圖 24)與第一個 DL 突發 (即
DL Burst #1)。圖 24 中，DL Burst #1 包括了 DL-MAP 與 UL-MAP，分別用來定義 SS 下
傳與上傳存取頻道的時間。而 UL 子框架結構則由頻寬請求 (BW-REQ) 區間與許多 UL 
Burst 所組成。在階層 A 的 BW-REQ 區間乃用來保留給 W2-AP 裝置去輪詢 (Polling) 多
個 WiFi 節點是否需要服務。同理，在階層 B 的 BW-REQ 區間亦用來保留給 BS 去輪詢
多個 W2-AP 裝置是否需要服務。而 W2-AP 裝置與 BS 分別在 UL-MAP 中定義 WiFi 節
點與 W2-AP 何時可上傳頻寬請求的區間。因此，基於文獻 [25][26]所提出以無競爭
(Contention-Free)方式輪詢機制，W2-AP裝置與BS分別可接收到不同WiFi節點與W2-AP
的頻寬請求，以配置 UL Burst 的上傳頻道的存取時間。 
此外，在階層 A 與 B 中，W2-AP 與 BS 分別以週期性廣播的方式，在每個框架開始
時分別傳送同步訊號至 WiFi 節點與 W2-AP，給予 WiFi 節點與 W2-AP 裝置來進行同步
處理。因此，框架的間隔時間等同於兩個下傳同步訊號間隔之時間，而一般的框架間隔
時間介於 2.5~20 毫秒，並且在一般運作當中是固定的。為了使 WiMAX 與 WiFi 整合架
構具一致性，在此假設 BS 與 W2-AP 裝置所廣播的框架長度相同。 
 
階層 B 的框架運作 
 
階層 B 架構如圖 23 所示，以 BS 的觀點，在階層 B 所運作的 W2-AP #1 與 W2-AP 
#2 視為在 WiMAX 網路中一般的 SS。BS 在每個框架開始時，會廣播 DL-MAP 與
UL-MAP 訊息給 W2-AP #1 與 W2-AP #2，並且分別對其定義允許 DL 與 UL 的傳輸長
度。其中，一個在 DL-MAP 中的 DL 同意 (DL grant) 訊息會在 DL 子框架 K 的起始位
置，透過 BS 發出的突發封包通知 W2-AP 裝置 (或 SS) 。而一個在 UL-MAP 的 UL 同
意 (UL grant) 訊息會指明框架 K 中的 UL 子框架可傳輸的間隔時間，UL 同意訊息依
據先前框架 (即框架 K-1) 所發出的頻寬請求予以發送。在框架 K 的 DL 子框架中，當
W2-AP #1 與#2 收到由 BS 發出的第一個 DL Burst 訊息，便根據此訊息所通知的分配
時間接收來自 BS 的封包。在框架 K 的 UL 子框架中，每個 W2-AP 裝置以分時多工的
方式轉送從 WiFi 節點所傳送的資料到 BS。 
 
階層 A 的框架運作 
 
對於階層 A 的框架運作模式，以 W2-AP 裝置的觀點，WiFi 節點就像 WiMAX 網
路中的 SS。而 W2-AP 裝置對於 WiFi 節點而言亦類似 WiMAX 網路中的 BS。如同先
前描述階層 B 的協定運作模式，每個 W2-AP 裝置以週期性的廣播框架給予在所連結的
WiFi 節點。當 W2-AP 裝置收到由 BS 在框架 K 發出的 UL-MAP 時，此 MAP 定義該
W2-AP 裝置所同意的頻寬請求訊息 (即在框架 K-1 所請求的頻寬)。此時，每個 W2-AP 
裝置會採取 THBA 機制，進一步決定其連接的每個 WiFi 節點應分配多少頻寬。因此，
W2-AP 裝置藉由 WiMAX 介面卡收到 UL-MAP，隨即重新分配所得的頻寬，接著利用
WiFi 介面卡將重新分配後的頻寬以控制訊息告知其連接的每個 WiFi 節點，使得 WiFi 
節點可利用所分配的頻寬上傳資料。 
 
 
28
率 (Constant Bit Rate，簡稱 CBR)。 
 Video ( 對應 WiMAX 中的服務類別 real-time Polling Service): 128kbps 的 CBR。 
 Web (對應 WiMAX 中的服務類別 BestEffort) : 64kbps 的 CBR。 
對於 VoIP，Video，BE 的封包發送間隔時間分別為 20 毫秒，10 毫杪，12.5 毫秒。在
WiFi 部份實驗參數設定，假設上傳頻道的速率為 12Mbps，並且 WiFi 熱點對其所覆蓋
的半徑為 50 公尺。此系統所評估之效能參數為平均「端點對端點延遲（End-to-end 
delay）」。端點對端點延遲定義為 WiFi 節點封包發送的時間至 WiMAX BS 所收到此封
包的時間。 
接下來討論三種不同的整合型 WiMAX/WiFi 系統的頻寬分配及協定運作方式，分
別為: 
 THBA 機制:此機制為本論文所提出兩階層式頻寬配置機制 (THBA)。如前面所
述，每個 W2-AP 依照服務類別將頻寬請求分類，以聚集相同類別之頻寬需求。並
且將其送至 BS 以要求頻寬。而 BS 會依據此頻寬需求分配適當的頻寬給予 W2-AP 
並且利用 UL-MAP 告知 W2-AP 所配置的頻寬及傳送區間。當 W2-AP 在框架 K 接
收到 BS 所廣播的 UL-MAP，將會建立相對的框架 K’並且根據 WiFi 節點所請求的
頻寬做出適當的分配。因此，在框架 K 時 BS 所分配 W2-AP 之上傳區間內，W2-AP 
擁有立即轉送所有來自 WiFi 節點所傳送資料至此區間之能力。 
 獨 立 頻 寬 分 配 (Independent bandwidth allocation，簡稱 Independent)機制:基於
前面所討論之整合型系統架構 (即 WiFi 部分亦執行連結為導向的頻寬存取協
定)。在 WiFi 與 WiMAX 部分，其頻寬請求與配置機制執行為互相獨立。代表
Independent 框架設計並無緊密的時間結合。換句話說，在 WiFi 部分，W2-AP 直
接依據 WiFi 節點的頻寬需求以及 WLAN 所提供的頻寬對其頻寬資源執行配置。同
理，對於 WiMAX 部分，W2-AP 根據其佇列長度 (Queue length) 送出其頻寬請求
至 BS，BS 亦依據 WMAN 所提供的頻寬對其在 UL 子框架中配置各個 W2-AP 適
當的 UL Burst 區間。 
 具有 EDCA 的 WiFi 控制機制 (WiFi withEDCA control，簡稱 WiFi-EDCA):在這個
機制下，每個 WiFi 節點都配置 802.11e 網路介面卡以執行 EDCA 頻寬競爭式協
定。另外，在每個 W2-AP 裝置中聚合 MAC 的 SoftMAC 與 802.16 BS-MAC (如圖
22(b)所示)中，為了修改以 WiFi 為 EDCA 協定的整合型架構，將其 802.16BS-MAC 
置換為 802.11e MAC 並且移除 MultiMAC 的功能。因此，每個 W2-AP 
 
圖 25 不同串流類別對平均端點對端點延遲變化量：(a) 提供不同的網路流量 (b) VoIP 的連線數 
 
裝置只當作 WiFi 與 WiMAX 之間的橋接器以轉換期傳輸封包。另外頻寬分配如同
Independent 的機制，只依據 W2-AP 佇列長度向 BS 提出其頻寬請求。 
 
4.1.2.2 數據結果 
圖 25 表示其端點對端點延遲變化量分別對不同的網路流量 (圖 25(a)) 以及網路中
 
 
30
 
圖 27 以 MSS 為基礎的 IPSS 演算法關係圖例 
 
此架構中，W2-AP 裝置用來提供 WiFi 節點使用 WiMAX 後置式網路服務，藉由韌體更
新方式提昇W2-AP裝置與WiFi 節點的網路介面卡功能，使得WiFi 網路具有與WiMAX 
系統傳輸行為相似之連結為導向通訊協定。同時所提出的 THBA 機制及對應的框架結
構可確保整合型網路服務品質與頻寬管理具有一致性。由實驗數據可知，本計畫所提出
之方法可大幅降低各種服務類別的延遲時間。 
 
4.2 研究 WiMAX 服務品質保證(QoS)與省電節能機制以支援情緒管理服務
應用 
 
4.2.1 分析方法 
人們對於行動通訊產品的依賴性逐漸增加，除了要求品質及傳輸量也要求其便利
性。然而，此類的行動通訊產品多以電池作為主要的電力來源，因此如何延長電池的使
用壽命減少因能源耗盡必須更換電池的不便，成為現階段無線通訊重要的課題。針對節
能的議題可從硬體與軟體兩方面進行討論 [28]，硬體方面可從降低運作的電壓、調整時
脈頻率來進行節能，亦或者減少液晶顯示器、硬碟存取以及中央處理單元的耗能，或是
適時的關閉未使用到的周邊設備，藉由減少額外的耗能以延長電池的使用壽命。除此之
外，在軟體方面則可從通訊的角度進行節能，如進行系統的最佳化、降低錯誤率的發生，
亦或者提供可暫時關閉與外界連通介面進行睡眠模式的方法，除此之外，也可透過改變
資料的儲存方式或進行有效的排程來達成節能之目的。著眼於 WiMAX 技術在無線通訊
的發展潛力，且目前已有許多相關的研究及技術 [29][30][31]，然而再佳的無線通訊技
術也須面臨有限能源運用之難題。由於 WiMAX 具有提供更高的傳輸率與更遠傳輸距離
的優點，意味著 WiMAX 必須消耗更多的能源在通訊上。因此，如何在電池供應的有限
能源下有效的延長 WiMAX行動裝置的運作時間將是 WiMAX是否能成功的關鍵因素之
一。 
 
 
圖 28 在 T1 前一個週期的起始點排程下一個 T1 週期內 G1 的排程 
 
 
 
 
32
 
圖 29 在 T1 cycle 內 IPSS 控制訊息的傳送圖示 
 
組的 MSSs 個數。最後，在子排程週期中剩餘的可用傳輸時間才可作為第二群組的存取
時間：  
2 1 1G GL T L    (4)  
IPSS 並將這些分散在 β個子排程週期中剩 
可用的頻寬資源(i.e. 2GL )重新整合，以作為第二群組的MSSs使用，如圖29所示，屬於
第二群組的 MSSs 會在前一個排程週期的起始點便獲得下一個排程週期中醒來的時間點
及時間長度。在上述步驟中，IPSS 先以群組為單位，先計算出每個群組的排程週期與
預先保留的頻寬資源。接下來，IPSS 再針對每個 MSS 可預先分配到的覺醒時間長度，
以及可開始使用頻寬資源的相對時間，因此對第一群組中的第 k個MSS中的第 j條連線
而言，其可分配通道頻寬資源為: 
1
min
1
1
min
1 1
(1, , )
(1, )
(1, , )
k
k
j
G N
k j
R k j
b k L
R k j



 
  


  (5) 
其中， min (1, , )R k j 表示在第一群組的第 k 個 MSS 中第 j 條連線之最小頻寬要求，b(1,k)表
示第一群組的第 k 個 MSS 分配到的覺醒時間長度， 1N 表示第一群組內的 MSSs 個數。
為保證滿足連線的QoS需求，IPSS預設以最小保留的傳輸率 (minimal reserved data rate) 
作為分配頻寬的主要權重參數。接著，計算在下一個子排程週期中第一群組 MSSs 的覺
醒時刻 ( )IkU x ，其中，I 代表第一群組 1G ， ( )IkU x 的計算從群組的第一個成員(k = 1)開
始，其中 It 表示子排程週期的長度，因此 
0 ( )
I IU x t  (6) 
假設第二個成員 (k = 2) 排在第一個成員(k = 1) 之後使用頻寬，時間相差 b(1,0)，因此
1 0( ) ( ) (1,0)
I IU x U x b  。因此，成員 (MSS k) 的覺醒時刻相當於前一成員 MSS (k-1)的覺醒
時刻加上此成員分配到的頻寬資源 b(1,k-1)，計算覺醒時刻的方式如下: 
1
1
0
( ) ( ) (1, 1) (1, )
k
I I I
k k
i
U x U x b k t b i



    
 (7) 
如先前所述，IPSS 將分散在 β 個子排程週期內的頻寬 ( 2GL )，重新分配給第二群組的
MSSs，分配的方式和前面所提的比例分配方法類似： 
2
min
1
2
min
1 1
(2, , )
(2, ) ( * )
(2, , )
k
k
j
G N
k j
R k j
b k L
R k j




 
 


   (8) 
其中， min (2, , )R k j 表示在第二群組的第 k 個 MSS 中第 j 條連線之最小頻寬要求，b(2,k)表
示在第二群組中的第 k 個 MSS 分配到的覺醒時間長度，N2 表示第二群組 2G 內的 MSSs
 
 
34
首先，針對第一群組的 MSSs 進行睡眠比例的計算。由於，屬於第一群組的 MSSs
必須在每個子排程週期醒來進行傳輸，因此在整個排程週期裡屬於第一群組的 MSSs 必
須醒來 β次，並在指定的覺醒期間公式 (5) 進行資料的傳輸其餘皆維持在睡眠模式。由
於 IPSS 採用的是以訊框 (frame) 為基本排程時間單位，因此 MSS 只有在整段訊框內皆
不需醒來時才切換至睡眠模式，因此第一群組 MSSs 的睡眠比例算式如下： 
1
2
(1, )
f
f
G
b i T
T
T
 

          
       (11) 
其中， (1, )
f
b i
T
    
為在第一群組內的第 i 個 MSS 分配到在子排程週期 ( 1T ) 內醒來進行傳輸
的訊框數目。 
因此，第二群組 MSSs 的睡眠比例也採用上述的相同觀念，透過第二群組 MSSs 的
排程週期內醒來的訊框數目與排程週期之比例做為節能比例，如下： 
2
2
(2. )
f
f
G
b i T
T
T
 

          
        (12) 
其中， (2, )
f
b i
T
    
為在第二群組內的第 i 個 MSS 分配到在排程週期 ( 2T ) 內醒來進行傳輸的
訊框數目。  
最後，為了表現整體網路的節能情形，將網路上各類型 MSSs 的睡眠比例依照各群
組 MSSs 之個數進行比例上的結合，整體網路的睡眠比例如下： 
1 2
1 2
1 2 1 2
total G G
N N
N N N N
          (13) 
 
平均延遲 
 
本計畫採用封包抵達的機率為 Poisson 的機率分布模型，根據機率模型的特性封包
平均延遲約為週期長度的一半。其中，第一群組的 MSSs 會在每 1T 週期便進行排程一次，
因此平均延遲長度約為 [17]： 
1 1
1
2G
D T 
           (14) 
其中， 1GD 表示第一群組的平均延遲時間長度。另外，第二群組的 MSSs 會每隔 2T 週期
才進行排程一次，因此平均延遲長度約為： 
2 2 1
1 1
2 2G
D T T    
     (15) 
 
Additive utility function 
 
在討論使用 utility function 前，必須先觀察 IPSS 的特性。由公式 (11-12) 可看出睡
眠比例 (ε) 會隨  值增加而增加，由公式 (13-14) 可觀察出平均延遲會因為  值的遞增
而增加。然而睡眠比例的增加表示整體節能效果較好，平均延遲的增加對整體的傳輸情
形卻是較差的表現。由於 additive utility function 算法適用於針對單一改變卻有兩相異優
劣改變之情形，意指針對其中一項為較佳的改變另一項則為較差改變之情形，因此為了
適用此種方法，將睡眠比例轉為覺醒比例 (i.e.醒來時間與排程週期之比值， 1w   ) 便
會隨著  值的增加而減少。 
 
 
36
 
圖 30 模擬的網路 
 
 
為了清楚表達三項主要控制訊息的頻寬消耗情形，以下將先針對使用 IPSS 節能時，控
制訊息的行為介紹。在每個訊框起始時 BS 會針對在該訊框內必須醒來的進行傳輸的 MSS
發送 MAP 訊息，其內容包含避免碰撞、作為 UL 和 DL 中間分隔的時區以及 MAP 訊息傳
輸所花費的時間，假設 MAP 訊息在每個訊框中占用個時槽，因此，對於整段排程週期長
度而言，將花費   個時槽進行 MAP 的通知。 
除了在訊框一開始進行通知的 MAP 訊息外，BS 還需針對在該訊框中必須進行傳輸的
傳輸的 MSS 進行個別的 IE 通知，因此若有 個 MSS 必須被告知進行傳輸，則 BS 必須佔
用 個 IEs 的傳送訊息時間，由於每個 IE 的長度為 5 bytes (40 bits)，且根據傳輸速度的標
準 IE 傳送訊息的傳輸速度屬於控制訊息之傳輸速度 (每單位時槽可傳輸 48 bits)，因此每傳
送一個 IE 訊息恰佔用該訊框中的一個時槽時間。在本研究中，假設每個 MSS 皆可以在分
配的訊框中完成傳輸，且每個 MSS 皆至少被服務一次。若考慮在整段排程週期的長度，由
於第一群組 1G 的 MSS 在每個子排程週期皆收到一次 IEs 的訊息，因此將接收到  次的 IEs
訊息，而第二群組 2G 的 MSS 則僅接收到一次的 IE 訊息，根據上述的描述可估計在整段排
程週期內將有 1 2N N  個時槽用於傳送 IEs 的訊息。 
最後，針對 BS 告知 MSS 進行睡醒時間的 MOB-SLP-RSP 訊息進行討論，以下簡稱為
SLP。由於 SLP 的傳輸是利用在該訊框中會醒來進行傳輸的 MSS，在訊框的一開始進行告
知何時進入睡眠以及睡眠的時間長度。因此，若在該訊框中有 個 MSS 會醒來進行傳輸，
則 BS 將傳送 個 SLP 的訊息，由於每個 SLP 的封包長度為 16 bytes (128 bits)，根據傳輸速
度的標準 SLP 的傳輸屬於資料的傳輸速度 (每單位時槽可傳輸 128 bits)，因此每傳送一個
SLP 訊息將占用該訊框一個時槽的時間。由於每個 MSS 在排程週期內都將至少被通知進行
傳輸一次，因此對於第一群組 1G 的 MSS 而言，將在每個子排程週期內收到一次 SLP 的訊
息；而第二群組 2G 的 MSS，則會在一個排程週期內收到一次 SLP 的訊息。若以整段排程週
期作為考量，則 SLP 將使用 1 2N N  個時槽作為傳輸 SLP 的時間。 
根據上述 IPSS 的排程方法，在整段排程週期估計控制訊息所占的長度如下： 
 
1 2 1 2
_ _ _
( )
hT MAP slot IE slot SLP slot
N N N N   
  
           (19) 
 
其中， hT 表示在整段排程週期 ( 2T ) 內控制訊息所使用的時槽樹暮總和，表示一個 MAP
訊息所占用得時槽長度， 1N 和 2N 分別在第一群組與第二群組的 MSS 個數。由於之前在一
個子排程週期內屬於第一群組的 MSS 會被排程一次，因此每個第一群組的 MSSs 應接收到
 
 
38
訊協定。 
 
 
圖 31 不同的  睡眠比例的模擬與分析 
 
 
本模擬採用 OFDMA 的物理層，相關設定參考表一。在模擬中各連線的設定參考表二
和表三。即時性的連線以 UGS 和 rtPS 的連線為代表，非即時性的以 nrtPS 為代表，並使用
Poisson pattern 來模擬資料傳輸的不規則性。表四為不同模擬劇本的設定。 
 
模擬的結果與討論 
 
睡眠比例(ε) 
由圖十證明式子 (11) 和 (12) 可以驗證睡眠比例 (ε) 的正確性。如圖 31 所示，當 
值設定為 4~8之後可以明顯的看見睡眠比例趨近於 0.925，當  值再往上設定可以明顯看見
並沒有更明顯的改善，由此可知睡眠比例雖然會隨著  值上升而增加，但是睡眠比例會在
某定值後逐漸收斂。 
圖十一是根據網路上不同的負載的情況進行模擬。圖 32(a)~(d)可以發現網路負載增加時節
能效果會受到些微影響，並且受影響的組合又會與連線類型相關。如圖 31(a)受到網路負載
的影響較大，因為在劇本一(scenario 1) 的連線組合在第一群組的連線中僅有 UGS 的連線，
其中 UGS 的連線又與網路上控制訊息的封包大小差異不大，因此隨著 MSS 的數目增加網
路上控制訊息佔用頻寬的情形也就更明顯的影響網路效能，因此整體節能效果將下降地明
顯。 
 
 
     
(a)                               (b) 
 
 
40
Scenario G1’ connections G2’ connections 
1 UGS nrtPS 
2 UGS+rtPS nrtPS 
3 UGS+nrtPS nrtPS 
4 UGS+rtPS+nrtPS nrtPS 
 
     
(a)                             (b) 
     
 (c)                              (d) 
圖 33 根據表 4 劇本下各群組 MSSs 不同數目下剩餘可用時槽比例 
 
 
4.2.2.3. 結論 
在無線網路中，具有移動性的 MSS 大多使用電池作為運作電力的來源，因此如何減少
能源的消耗以延長 MSS 的運作時間便成為一項重要的課題。在 IEEE 802.16e 標準中，針對
節能議題制定了一系列的標準。除了平常運行的狀態外，為了減少通訊能源的消耗，MSS
可在沒有資料需要進行傳送/接收時，進入所謂的睡眠模式以減少能源的消耗。  
此外在標準裡還制定了節能類別(Power-Saving Class)，然而標準裡所制定的節能類別
並未將排程的情形加入考量，因此若在多種不同類型的連線排程同時出現時，MSS 將因無
法有效率的進入睡眠模式而使節能效果大幅下降。因此，為了更有效率的使用頻寬並增加
節能效果，本篇論文將針對一種以 MSS 為基礎並將整體排程加入考量來進行睡眠模式的整
合性節能排程演算法進行數學。 
 
 
42
本計畫依照所提研究方法與計畫時程依序地將所規畫的研究目的一一完成 
(1) 有效率地整合 WiFi 和 WiMAX 無線網路以提供情緒管理服務運算系統給使用者，不管
是處在 WiFi 無線網路環境或 WiMAX 無線網路，其間所要傳輸至運算處理中心的資
料，皆可以藉由此無線整合網路環境順利地傳輸至處理中心作運算。 
(2) 提出一個無線通信省電節能演算法(簡稱 IPSS)。 
(3) 提出一個針對 IEEE 802.16j 穿透式中繼網路之高效能資源資源排程演算法，提供一個傳
輸無死角的網路環境。 
 
本計畫研究成果符合原計畫研究方向，實作上亦符合功能面上的需求，除了可應用於
精神病患看護外，在學術上，亦有發表於科學期刊的價值，列表如下： 
 
國際期刊論文 
1. Chin-De Liu, Yi-Nung Chung, and Pau-Choo Chung, "An Interaction-Embedded HMM 
Framework for Human Behavior Understanding: with Nursing Environments as Examples", 
IEEE Transactions on Information Technology in Biomedicine, Vol. 14, No. 5, pp. 1236-1246, 
Sep. 2010. (SCI) 
2. Jiann-Shu Lee, Yung-Ming Kuo, and Pau-Choo Chung, "A Visual Context Awareness Based 
Sleeping Respiration Measurement System", IEEE Transactions on Information Technology 
in Biomedicine, Vol. 14, No. 2, pp. 255-265, 2010. (SCI) 
3. Che-Wei Lin, Jeen-Shang Wang, and Pau-Choo Chung, "Mining Physiological Conditions 
from Heart Rate Variability Analysis", Computational Intelligence Magazine, IEEE, Vol. 5, 
No. 1, pp. 50-58, Feb. 2010. (SCI) 
4. Hui-Tang Lin; Chia-Lin Lai; Wang-Rong Chang; Sheng-Jhe Hong, “Design and Analysis of a 
WDM EPON for Supporting Private Networking and Differentiated Services,IEEE/OSA 
Journal of Optical Communications and Networking,”Vol. 2, Issue 5, pp. 266-282, 2010 (SCI) 
 
國際(國內)會議論文 
1. Chi-Keng Wu, Pau-Choo Chung, Chi-Jen Wang, “Extracting Coherent Emotion Elicited 
Segments from Physiological Signals,” IEEE Symposium Series on Computational 
Intelligence (SSCI 2011), France, April 2011 
2.  Chuan-Yu Chang, Jun-Ying Zheng, Chi-Jane Wang, and Pau-Choo Chung, “Application of 
Support Vector Regression for Phyciological Emotion Recognition”, International Computer 
Symposium (ICS 2010), Taiwan, 16-18 Dec 2010. 
3.  Chin-Wen Wu, Pau-Choo Chung, Chin-De Liu, "Assistance Instruments Detection using 
Geometry Constrained Knowledge for Health care Centers", The 5th International Conference 
on Future Information Technology 2010, Busan, Korea, 21-23 May, 2010. 
4.  Ming-Han Wu, Chih-Jen Wang, Yen-Kuang Yang, Jeen-Shing Wang and Pau-Choo Chung, 
"Emotional Quality Level Recognition Based on HRV", IEEE World Congress on 
 
 
44
參考文獻: 
[1] Pincus SM.,“ Approximate entropy as a measure of system complexity”, Proc. Natl Acad Sci 
USA, 1991. 
[2] Richman JS, Moorman JR. ”Physiological time-series analysis using approximate entropy and 
sample entropy.” Am. J. Physiol. Heart Circ. Physiol. 278(6):H2039-H2049 , 2000. 
[3] P. Pudil, J. Novovicova, J. Kittler, “Floating Search Method in Feature Selection”, Pattern 
Recognition Letters, 1994 
[4] J. A. Healey and R.W. Picard, ”Detecting stress during real world driving tasks using 
physiological sensors,” IEEE Trans. Intelligent Transportation Systems, vol. 6, no. 2,pp. 
156-1566, 2005. 
[5] Geldmacher DS. “Effect of stimulus number, and target-to-distractor ratio,on the performance 
of random array letter-cancellation tasks,” brain and cognition,1996. 
[6] Conners, C. K. “The Conners continuous performance test,” Toronto, Canada: Multi-Health 
Systems, 1994 
[7] R. W. Picard, E. Vyzas, and J. Healey, “Toward machine emotional intelligence: 
    Analysis of affective physiological state,” IEEE Transaction on Pattern Analysis and 
Machine Intelligence, vol. 23, no. 10, pp. 1175–1191, Oct. 2001. 
[8] Holland, J. "Genetic algorithms" Scientific American, pp. 66-72, July 1992. 
[9] L.Y. Chuang, H.W. Chang and C.J. Tu et al., Improved binary PSO for feature selection using 
gene expression data, Computational Biology and Chemistry ,2008. 
[10] J. Kennedy and R. Eberhart, “A discrete binary version of the particle swarm algorithm,” in 
Proc. IEEE Int. Conf. Systems, Man, Cybernetics,Computational Cybernetics, Simulation, pp. 
4104–4108, vol. 5, 1997. 
[11] J. Healy, “Wearable and Automotive Systems for Affect Recognition from Physiology”, PHD 
Thesis, MIT, 2000 
[12] R. W. Picard, E. Vyzas, J. Healey “Toward Machine Emotional Intelligence: Analysis of 
Affective Physiological State”, IEEE Transactions on Pattern Analysis and Machine 
Intelligence, VOL. 23, NO. 10, October 2001 
[13] J. Kim, E. André,” Emotion Recognition Based on Physiological Changes in Music 
Listening”, IEEE Transactions on Pattern Analysis and Machine Intelligence, Vol, 30 NO, 12, 
December 2008 
[14] K. H. Kim, S. W. Bang, S. R. Kim, “Emotion recognition system using short-term 
monitoring of physiological signals “, Medical & Biological Engineering & Computing, Vol. 
42, 2004 
[15] Z. Zeng, M. Pantic, G. l. Roisman, T. S. Huang, “A Survey of Affect Recognition Methods: 
Audio, Visual, and Spontaneous Expressions”, IEEE Transactions on Pattern Analysis and 
Machine Intelligence, VOL. 31, NO. 1, January 2009 
[16] D.L. Davies and D.W. Bouldin, “A Cluster Separation Measure”, IEEE Transactions on 
Pattern Analysis and Machine Intelligence, vol. 1, pp. 224-227, April 1979 
 
 
46
國科會補助專題研究計畫成果報告自評表 
請就研究內容與原計畫相符程度、達成預期目標情況、研究成果之學術
或應用價值（簡要敘述成果所代表之意義、價值、影響或進一步發展之
可能性）、是否適合在學術期刊發表或申請專利、主要發現或其他有關
價值等，作一綜合評估。 
1. 請就研究內容與原計畫相符程度、達成預期目標情況作一綜合評估
   ▓達成目標 
□ 未達成目標（請說明，以 100 字為限） 
□ 實驗失敗 
□ 因故實驗中斷 
□ 其他原因 
說明： 
 
 
 
2. 研究成果在學術期刊發表或申請專利等情形： 
論文：█已發表 □未發表之文稿 □撰寫中 □無 
專利：□已獲得 □申請中 █無 
技轉：□已技轉 □洽談中 █無 
其他：（以 100 字為限） 
 
 
 
 
 
48
國科會補助計畫衍生研發成果推廣資料表 
日期：   年  
月  日 
國科會補助計畫 
計畫名稱： 
計畫主持人：         
計畫編號：             領域： 
研發成果名稱 
（中文） 
（英文） 
成果歸屬機構  發明人 (創作人) 
 
技術說明 
（中文） 
 
 
 
（200-500 字） 
（英文） 
產業別 
 
技術/產品應用範圍 
 
技術移轉可行性及預期
效益 
 
     註：本項研發成果若尚未申請專利，請勿揭露可申請專利之主要內容。 
 
 
97 年度專題研究計畫研究成果彙整表 
計畫主持人：詹寶珠 計畫編號：97-2221-E-006-146-MY3 
計畫名稱：植基於醫療看護之情緒管理與促進服務運算系統--總計畫：植基於醫療看護之情緒管理與
促進服務運算系統 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 2 2 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 4 4 100%  
研究報告/技術報告 0 0 100%  
研討會論文 12 12 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 6 6 100%  
博士生 5 5 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
國科會補助專題研究計畫成果報告自評表 
請就研究內容與原計畫相符程度、達成預期目標情況、研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）、是否適
合在學術期刊發表或申請專利、主要發現或其他有關價值等，作一綜合評估。
1. 請就研究內容與原計畫相符程度、達成預期目標情況作一綜合評估 
■達成目標 
□未達成目標（請說明，以 100 字為限） 
□實驗失敗 
□因故實驗中斷 
□其他原因 
說明： 
2. 研究成果在學術期刊發表或申請專利等情形： 
論文：■已發表 □未發表之文稿 □撰寫中 □無 
專利：□已獲得 □申請中 ■無 
技轉：□已技轉 □洽談中 ■無 
其他：（以 100 字為限） 
3. 請依學術成就、技術創新、社會影響等方面，評估研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）（以
500 字為限） 
在情緒分析與管理部分，本計劃探討心智負荷程度與生理反應之關係、相同情緒內相異程
度的可識別性探討，亦提出最佳化多階層式情緒分類法與資料探勘技術於情緒事件偵測。
為了解決人工雜訊問題，開發了適用於高雜訊呼吸信號之切斷點分析演算法用以協助事件
偵測。本研究所提出之新型呼吸切斷演算法與多階層式情緒分類法，經實驗顯示具有優異
之執行效率及正確性，具有高度之學術價值及應用性。未來將可廣泛應用於生理情緒資訊
處理。 
在多媒體傳輸系統部分，本計畫於第一年度完成整合 WiMAX 與 WiFi 網路作為情緒管理服
務運算系統之通訊骨幹系統，並且亦考量到即時性資料的服務品質，採用了近期新興的無
線網路技術，WiMAX 網路提供之服務品質的保證。於第二年度除了考量到服務品質的資料
傳輸之外，亦考慮到傳輸裝置的能源問題，這是因為由於近年來使用者普遍使用行動裝置
來存取網路資料，但是這些行動裝置大部份都是以電池提供設備能源，其所能提供的能源
有限，因此為了延長行動裝置運作時間，省電節能的議題十分重要。針對節能議題，本計
畫於此年度提出一個省電節能機制 (IPSS 機制) 以支援情緒管理服務應用。第三年度本計
畫為了解決都會網路無線傳輸的死角，讓情緒管理使用者的資料可以順暢地傳輸至資料處
理中心，本計劃在此年度研究可延伸 WiMAX 網路涵蓋範圍以解決傳輸死角的 IEEE 802.16j
的系統。由於 IEEE 802.16j 網路提供中繼裝置以協助使用者裝置傳輸至基地台，然而如
何有效分配無線傳輸的資源與時間以提升整體網路的效能是一個非常重要的研究議題。有
鑒於此，本計畫於第三年度提出一個針對 IEEE 802.16j 穿透式中繼網路之高效能資源排
