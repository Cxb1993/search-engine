1 
行政院國家科學委員會專題研究計畫成果報告 
多晶矽太陽能電池之表面瑕疵檢測 
Surface Flaws Inspection of Multicrystalline Silicon Solar Cells 
計 畫 編 號：NSC 97-2221-E-216-023 
執 行 期 限：97 年 08 月 01 日至 98 年 07 月 30 日 
主 持 人：邱奕契 副教授 中華大學機械工程學系 
共同主持 人：無 
計畫參與人員：陳治宏 中華大學機械工程研究所 
 
一、中文摘要 
多晶矽太陽能電池表面所具有的不規則紋理，提
高了瑕疵分割的困難度。再者，太陽能電池表面
的抗反射層，也增加了取像的複雜度。為了成功
將上述表面瑕疵檢測出來，在硬體設備方面，本
研究所發展之太陽能電池檢測機，是由一台線掃
描攝影機、兩個紅光 LED 條狀光源、一張影像擷
取卡、及一組以伺服馬達驅動之移動平台所構
成。在軟體程式方面，本研究使用自行研發之投
影瑕疵偵測法進行表面瑕疵的檢測。投影瑕疵偵
測法首先將影像二值化，目的是將背景之紋理去
除；其次將二值化影像分別投影到水平軸及垂直
軸，並計算投影之平均值及標準差；最後則以設
定門檻值的方式將可能之瑕疵偵測出來。實驗結
果顯示，本系統攫取一張 2048x2048 影像約需 0.4
秒，檢測瑕疵約需 0.78 秒，瑕疵偵測率為 93.98%。 
關鍵詞：多晶矽太陽能電池、自動光學檢測、影
像分割、瑕疵偵測 
Abstract 
Due to the non-directional textured background of 
poly-crystalline silicon solar cells, the difficulty in 
segmenting desired flaws increases. Besides, the 
anti-reflection coating layer multiplies the complexity of 
image capture of solar cells. To successfully detect the 
aforementioned surface flaws of a solar cell, the 
developed inspection system, which was constructed to 
simulate a real production line, consists of one line scan 
camera, two red lights LED bar lighting, one image 
grabber, and one linear stage driven by a servo motor. As 
to the inspection software, we applied projection flaw 
detection (PFD) method to reveal defects. The 
independently developed PFD method first applied Otsu’s 
method to removed background textures from the image. 
The resulting image was then projected to the vertical 
axis and horizontal axis sequentially. After projection, the 
mean values and the standard deviations of the 
projections were calculated. Finally, the desired flaws 
were located by setting a suitable threshold value. The 
experimental results show that it takes about 0.4 seconds 
to acquire a 2048×2048 image, 0.78 seconds to inspect 
the image, and the overall flow detection rate is 93.98%. 
Keywords: poly-crystalline silicon solar cell, automatic 
optical inspection, image segmentation, defect detection. 
二、緣由與目的 
人類對石油的需求與日俱增，然而地球的石
油存量有限，因此人們紛紛開始尋找新的替代能
源。近年來許多科學家開始尋找可以利用大自然
力量生成的能源，例如：風力發電、水力發電、
及太陽能發電。2007 年 11 月 17 日，聯合國跨政
府氣候變遷小組(IPCC)在瓦倫西亞所發表的一份
氣候評估報告中指出，2100 年全球氣溫將會上升
攝氏 1.1~6.4 度，海平面則可能上升約 60 公分。
值得注意的是，該報告更提出警告說，只要氣溫
3 
 
圖 2：研究設備圖 
 
3.1、硬體架構 
隨線檢測的硬體架構由移動平台、線掃描攝
影機及光源所組成。取像設備為 DALSA Spyder2
高解析度線掃描攝影機，搭配 NIKON 55mm/f2.8
鏡頭。由上述瑕疵檢驗規範得知，瑕疵檢測所需
之精度必須小於 0.5mm，倘若能將影像的解析度
提高，則可取得較為清晰的瑕疵影像。此處影像
解析度為 26.8µm/ pixel，然而受限於機台的行程
過短，無法縮短平台的加速區，導致影像出現拉
長的現象。有鑑於此，本研究將影像大小設定為
2048x2048，此時之視野為 5.5cm x 5.5cm，一片太
陽能電池需分九次攫取。倘若日後解決行程太短
的問題後，可將影像大小調為 2048x5800pixel，視
野範圍為 5.5cm x 15.6cm。在此解析度下，一片多
晶矽太陽能電池需分三次取像即可。若搭配 3 台
線掃描攝影機同時進行取像，則只需取像一次。 
 
3.2、軟體架構 
隨線檢測的軟體程式部份必須能夠同時控制
平台的移動、線掃描攝影機的取像以及即時的瑕
疵檢測，因此所發展之軟體程式必須整合此三部
份。圖 3 所示為線上檢測軟體流程圖，在開啟程
式之後，伺服馬達保持激磁狀態。給予移動訊號
之後，伺服馬達透過聯軸器轉動滾珠螺桿進而使
平台移動，並且同時啟動線掃描攝影機擷取影
像；完成取像後，將影像二值化。接著使用投影
瑕疵偵測法，對二值化影像進行瑕疵檢測。完成
之後，將瑕疵輸出即完成單張影像的檢測。將上
述步驟重複執行九次，即可完成整張太陽能電池
的取像及檢測。 
 
圖 3：瑕疵檢測流程圖 
 
3.2.1、瑕疵分割：由於多晶矽太陽能電池具有較
複雜的背景，因此在影像分割時必須慎選分割方
法。圖 4.1 與 4.2 係以白點與刮傷瑕疵分別使用平
均二值化法、歐蘇法[1]、疊代法[2]、及矩量恆定
法[3]作為初步的評估，平均二值化法運算速度快
卻有判斷較不精準的缺點。歐蘇法是以機率統計
的原理，找出可以有效區分每個灰階濃度的分辨
閥值，歐蘇法的優點為速度快且幾乎不受光源影
響。疊代法藉由取代原先灰階平均值後去找尋新
的閥值，此法運算時間較歐蘇法快，但往往不能
得到比歐蘇法好的閥值。矩量恆定法是希望找到
一個門檻值，使分割前與分割後的前三階矩量保
持不變。 
    圖 4.1(a)及圖 4.2(a)為白點及刮傷瑕疵影像的
原始影像，在使用此四種分割法進行影像分割評
估，圖 4.1(b)及圖 4.2(b)為平均二值化的分割結
果，圖 4.1(c)及圖 4.2(c)為歐蘇法的分割結果，圖
4.1(d)及圖 4.2(d)為疊代法的分割結果，圖 4.1(e)
及圖 4.2(e)為矩量恆定的分割結果，由圖 4.1 中可
以看出歐蘇法的分割效果較佳，可順利把背景去
除並且保留瑕疵與電極線，另外三種方法無法成
功的將背景去除，影像中留下的矽晶背景，將導
致後續處理時的誤判。由圖 4.2 中可以看出使用歐
蘇法及疊代法這兩種方法可以得到較佳的分割效
果，但此分割結果還是無法順利將矽晶背景去
除。經由分析灰階値之後得知，造成此結果的原
因為瑕疵灰階値與背景灰階值過於相近，導致計
算上的誤判，無法成功的將影像分割。綜合以上
之結果，本研究是以歐蘇法進行影像二值化。 
5 
測影像輸出。 
步驟6： 此步驟為斷線瑕疵之檢測，檢測之前需
再次計算群組 uG 中的行投影平均值及
行投影標準差。檢測方式是將群組 uG
中，行投影値 )(xPV 大於行投影平均值
Pvµ 及行投影標準差 Pvµ 之和(7 式)者，則
視為斷線瑕疵。 
           )()(
uvuv
ppv xP σµ +>  (7) 
步驟7： 由式(7)判斷是否有瑕疵的存在。 
步驟8： 若無瑕疵，則清除待測影像。 
步驟9： 若有瑕疵，則輸出瑕疵影像。 
步驟10： 將兩個不同群組的影像進行整合，並輸
出瑕疵影像。 
 
圖 5：二值化影像 
 
圖 6：垂直投影瑕疵偵測法流程圖 
在垂直投影法檢測瑕疵時，首先使用二值化
將影像中的瑕疵以及背景分離。接著計算每一行
的投影值及行投影平均值，並使用行投影平均值
當作閥值將影像分成兩個群組 uG 、 lG 。並計算群
組 uG 的行投影平均值及行投影標準差，若行投影
値大於群組的投影平均值及行投影標準差之和，
則代表有斷線的情形；反之，則代表沒有斷線。
如果沒有斷線，則將群組 uG 的影像清除。即完成
垂直投影瑕疵偵測之結果，如圖 7、圖 8 所示。影
像中只剩下瑕疵及 grid finger，則繼續進行水平投
影檢測。水平投影瑕疵偵測法與垂直投影瑕疵偵
測法差不多。圖 9 為水平投影瑕疵偵測法的流程
圖，說明如下。 
步驟1： 輸入待測影像，影像中只包含 grid finger
及瑕疵。 
步驟2： 進行水平投影，並分別計算列投影值及
列投影平均值。 
步驟3： 利用此平均值 Phµ 做為閥值，將影像分成
lG 及 uG 兩個群組，其中 lG 指的是列投影
值小於列投影平均值之列， uG 指的是列
投影值大於列投影平均值之列。 
步驟4： 將群組 lG 之列像素直接輸出，此處輸出
之影像即為瑕疵影像。 
步驟5： 此步驟為斷線瑕疵檢測，檢測之前需要
再次計算群組 uG 中的列投影平均值 Pvµ
及列投影標準差 Pvσ 。檢測方式為群組
uG 中的列投影值 )(yPh 大於列投影平均
值 Pvµ 及列投影標準差 Pvσ 之和(8 式)
者，則視為斷線瑕疵。 
         +>
uhph
yP µ()(
uhp
σ )  (8) 
步驟6： 利用式(8)判斷是否有瑕疵。 
步驟7： 利用式(8)判斷 uG 群組是否有瑕疵，若無
則將影像清除。 
步驟8： 利用式(8)判斷 uG 群組是否有瑕疵，若有
則輸出瑕疵影像。 
步驟9： 將步驟 4、7 及 8 的影像整合，輸出完整
的瑕疵影像。 
步驟10： 由於步驟 9 輸出之瑕疵影像中含有許多
小線段，這些線段並非瑕疵，而是影像
偵測時鋸齒狀邊界所留下來的線段，因
此本步驟的目的是使用 1 字型中值濾波
7 
圖 10：bus bar 尺寸量測流程圖。 
 
3.3.2、Bus Bar 檢測結果：圖 11(a)所示為自製具
有針孔及線寬擴散瑕疵之樣本影像，圖 11(b)為其
二值化後之結果影像。圖 11(c)為利用垂直投影去
除電極線 grid finger 後之影像，影像中包含針孔及
bus bar，藉由水平投影計算線寬後，發現影像中
有多處線寬擴散瑕疵及針孔瑕疵，如圖 11(d)所
示。影像中所出現之 bus bar為具有線寬擴散的 bus 
bar，紅框所示為針孔瑕疵。 
 
圖 11：電極線擴散及針孔瑕疵檢測結果 
 
3.3.3、Grid Finger 之尺寸量測：由於多晶矽太陽
能電池中包含 bus bar 及 grid finger，因此在檢測
grid finger 時，先使用水平投影的方式將 bus bar
去除，接著使用垂直投影的方式量測線寬並判斷
尺寸是否在容許範圍內，詳細之檢測流程如圖 12
所示，並且說明各步驟。 
步驟1： 輸入待測影像。 
步驟2： 使用歐蘇法將影像二值化。二值化後之
影像將只包含 grid finger 及 bus bar。 
步驟3： 使用水平投影計算每一列的列投影值，
並計算列投影平均值。 
步驟4： 為避免誤判，先使用列投影將電極線(bus 
bar)消除。 
步驟5： 由於 grid finger 之長度就是影像的寬度
(2048 個像素)，因此設定若列投影值小
於列投影平均值，則將該列影像去除；
反之，若列投影值大於列投影平均值則
保留該行影像。 
步驟6： 若列投影值小於列投影平均值，則清除
該列影像。 
步驟7： 若列投影值大於列投影平均值，則保留
該列像素。 
步驟8： 整合待測影像，此時影像中將只剩下 grid 
finger 影像。 
步驟9： 使用垂直投影，此時先找到電極線邊界
之後，以其下方 20 個像素為區域，計算
區域內的電極線寬度。 
步驟10： grid finger 線寬的檢測方式是，若該列的
線寬大於設定的瑕疵容許值，則保留該
線；若無瑕疵情形，則清除影像並輸出
瑕疵影像。 
步驟11： 由太陽能電池示意圖可知 grid finger 的
線寬為 200µm，在解析度為 26.8µm 的情
況下，線寬大約是 8 個像素。此處將線
寬之容許值設為線寬的正負兩個像素；
亦即，若線寬超過 10 個像素，即判定為
印刷擴散；若線寬小於 6 個像素，則判
定為線寬不足。 
步驟12： 清除影像。 
步驟13： 輸出瑕疵影像。 
9 
景分離，導致後續檢測時無法順利被偵測出(圖
15(c))。由此看來，雖然無法檢測出完整瑕疵，但
還是可將二值化後留下的零星汙跡檢出，藍色方
框區域則是未完整檢出瑕疵的區域，因此視為有
瑕疵未正確檢出的影像。圖 16(a)為具有汙跡的原
始影像，其二值化後的影像如圖 16(b)所示，經過
二值化後，汙跡的大部分影像被分割成背景，因
此在之後的檢測只能針對分割後所保留下來的影
像進行檢測，檢測之結果影像如圖 16(c)所示，由
圖中可以發現，經過二值化後所保留的瑕疵影
像，可以順利的被檢出，整體來說完整的瑕疵並
未被正確的檢出，因此此檢測結果亦視為有瑕疵
未正確檢出的瑕疵影像。綜合上述結果可知，進
行取像時若無法加強瑕疵與背景間的灰階對比，
則後續二值化時瑕疵可能會被歸類為背景，進而
造成檢測時無法將完整的瑕疵偵測出來。具有破
裂瑕疵的太陽能電池只有一片，取像後所得到之
影像如圖 17 (a)所示。經過歐蘇法二值化後，裂痕
的影像幾乎完全被判定成背景，如圖 17(b)所示。
因此在後續檢測時，無法正確檢出完整的瑕疵，
其檢測結果如圖 17(c)所示，由於無法正確檢出完
整瑕疵，因此亦判定為未能正確檢出瑕疵之影
像。從具有邊緣掉削樣本所取得的影像共 5 張，
經由投影瑕疵偵測法檢測瑕疵後，5 張影像之瑕疵
皆可正確的被找到。圖 18(a)為原始影像，經過二
值化處理後的結果影像如圖 18(b)所示，可見瑕疵
已正確被分割出。檢測結果如圖 18(c)所示，可見
經由投影瑕疵偵測法檢測後，瑕疵可正確被檢
出。針對具有刮傷瑕疵影像之檢測，在 11 張樣本
影像中，其中 8 張影像中之瑕疵可以順利被檢出，
另外 3 張影像中之瑕疵則無法被檢出。以圖 19(a)
為例，此圖所示為具有刮傷瑕疵的原始影像，由
於刮傷影像其灰階值與背景之灰階值差異不大，
因此二值化後並無法將刮傷分割出來，如圖 19(b)
所示。經過投影瑕疵偵測法檢測後，所得到的結
果影像如圖 19(c)所示，其中藍色方框標示之區域
為無法完整檢出的刮傷。由檢測結果可知，二值
化所分割出來之瑕疵皆可以正確被檢出，但是如
果在影像分割時，瑕疵就被歸類為背景，此部份
瑕疵就無法被檢出。由此看來，日後針對此類對
比不明顯的瑕疵，在取像上可以考慮使用更高亮
度的紅色 LED 光源，以提高瑕疵與背景的對比。 
   
圖 14：汙跡檢測結果 圖 15：汙跡檢測結果 
 
 
圖 16：汙跡檢測結果 圖 17：破裂檢測結果 
