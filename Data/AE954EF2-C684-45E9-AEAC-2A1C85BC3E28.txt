異數未知。採用 GRNN 的模型可以很自由的不用假設η為特殊的函數形式，且
在使用觀測數據時亦不需先驗的資訊即可得到適當的估計式子。只要透過對樣本
進行無母數的估計得到x和 y 的聯合密度函數，就可以計算出條件機率密度函數
和期望值[14]。這樣的方法不需要迭代，而且可以對任意的一個新的 x估計出 y 。 
    假設 ),( yf x 表示為隨機變數向量 x 和單一隨機變數 y 的聯合機率密度函
數。則在給定X 下， y 的條件期望值，也就是 y 在X 的迴歸為 
 　 　 　 　 　 　 　 　 [ ] ∫
∫
∞
∞−
∞
∞−=
dyyf
dyyyf
yE
),(
),(
X
X
X                        (2) 
通常 ),( yf x 未知，據 Parzen 所提的方法由樣本觀測值來估計其機率估計式子為 
( ) ⎥⎦
⎤⎢⎣
⎡ −−⋅⎥⎦
⎤⎢⎣
⎡ −−−⋅= ∑
=+
+ 2
2
1
2)1(2)1( 2
)(exp
2
)()(exp1
2
1),(ˆ σσσπ
i
n
i
i
T
i
pp
yy
n
yf xxxxx     (3) 
其中的 ix 和 iy 是隨機變數 x和 y 的樣本值， n 為樣本觀測數目， p 為向量x的維
度且給定每個樣本的機率寬度為σ 。將式子(3)帶入式子(2)中，經過整理後的條
件期望值以 )(ˆ xy 表示 
∑
∑
=
=
⎟⎟⎠
⎞
⎜⎜⎝
⎛−
⎟⎟⎠
⎞
⎜⎜⎝
⎛−
=
n
i
i
n
i
i
i
D
Dy
y
1
2
2
1
2
2
2
exp
2
exp
)(ˆ
σ
σ
x                      (4) 
其中的純量函數 )()(2 iTiiD xxxx −−= 表示隨機變數 x 和設計點 ix 的歐基里德平
方距離。式子(4)的估計式 )(ˆ xy 可視為對所有觀測值 iy 做加權平均的結果。其式
子(4)中的σ 可稱為 GRNN 模型的平滑參數。在使用模型前，需要將多維度的輸
入變數做前處理，讓這些變數有相同的範圍或者是變異數。 
2.2 最佳平滑參數σ 的決定 
　  雖然對任意的平滑參數都可以得到對應的 GRNN 估計模型，但是這樣的話
就等於埋沒了類神經網路能夠立即學習的能力。因此必須在數據做完前處理後選
定其平滑參數。在核心函數中平滑參數的特性是當σ 值越大對應的模型曲線會比
較平滑；當σ 值越小對應的模型曲線就會越靠近反應值，但這樣有可能會造成配
適過度的情況。在此採用 Specht 提出的保留法(holdout method)來定義測試過程
中的配對集合，要得到最佳的平滑參數σ 即是使訓練的 MSE(mean squared error) 
為最小，我們以黃金割線法來做搜尋，平滑參數的搜尋範圍依據經驗設定在 0.2
以上，此搜尋最佳平滑參數的策略可以幫助我們建立較佳的估計模型。 
得到新的設計點 newx 位置後，其反應觀測值 newy 和反應變數估計值 )(ˆ newy x 差距甚
遠時，再對原來反應變數模型進行調整，也就是重新估計 GRNN 的平滑參數，
希望調整後的模型更接近實際的未知模型。設 )(ˆ newnewnew yyd x−= 為新設計點和
原模型的殘差，決定模型是否需要調整的條件為若 Ldnew >|| 則進行模型調整；反
之則繼續搜尋下一設計點的位置。而 L 的決定以最近一次觀測數據的絕對誤差
(MAD)中位數來設定之。採用絕對誤差中位數的好處是若某次誤差過大時，並不
會造成 L的波動。又因為初期估計的 GRNN 模型可能會造成門檻值 L過大，因
此另外設計一個批次處理的機制，當最近一次的模型依次取得多個設計點後都沒
修正時，亦需進行模型的調整。 
三、模擬結果與討論 
我們以 IMSE 做為評估模型的量測指至標，其定義為 
                 ∫ ∑
=
−= xx dxyEy
R
R
j
j
n
1
2)( )}|()(ˆ{1IMSE               (7) 
式子(7)中的 R 表示模擬的次數， )(ˆ jny 為第 j 次模擬時，當時的觀測點有n 個時的
估計模型。本實驗設定初始觀測點數目 0n 是隨機產生其設計點的位置，固定總觀
測數目 N 做為模擬的標準，每次進行 100=R 次的模擬實驗。式子(7)的量測指標
理論上會隨著樣本觀測點越多其值會遞減，因此除了觀察 IMSE 的變化之外，亦
考量觀測樣本數目所造成的成本，以 IMSE⋅N 對 N 作圖來探討之。 
3.1 模擬範例 
 在本章節中，我們考慮單變量和雙變量的設計，並加以詳細討論和比較其模
擬的結果。在單變量時，假設設計點的範圍落在 ]5,5.0[ 之間。在雙變量時則假設
兩個設計變數的範圍分別是 ]5,5.0[1 ∈x 和 ]5.1,5.0[2 ∈x 。我們所設定的反應函數
有以下三種： 
 線性模型：　 　 2321 xxy θθθ ++=  　　    )'10,5,2(),,( 321 =θθθ   
  　指數形式：　 　 )]exp(1[)( 21 xxy θθ −−= 　  )5.0,10(),( 21 =θθ  
 雙變量分數形式： )1()( 2211131 xxxy θθθθ ++=  )5.2,5.0,50(),,( 321 =θθθ  
 在單變量的例子中，假設誤差項之變異數為 22 )5.0(1)( −+= xkxσ ；雙變量
時，則假設誤差項的變異數為 ])5.0()5.0[(1)( 22212 −+−+= xxkxσ 。並在每個例
子中設定 2.0,1.0,0=k 和 4.0 四種情況。以上例子的模擬結果可與[11]稍做比較。
本範例設定的初始觀測數目 140 =n 採均勻分佈隨機產生，總觀測數目 100=N 。 
10 20 30 40 50 60 70 80 90 100
0.5
1
1.5
2
2.5
3
N
IM
S
E
10 20 30 40 50 60 70 80 90 100
1
1.5
2
2.5
3
3.5
4
N
IM
S
E
10 20 30 40 50 60 70 80 90 100
3
3.5
4
4.5
5
5.5
6
N
IM
S
E
10 20 30 40 50 60 70 80 90 100
4
5
6
7
8
9
10
11
12
13
N
IM
S
E
(a1) k=0 (a2) k=0.1 (a3) k=0.2 (a4) k=0.4 
10 20 30 40 50 60 70 80 90 100
5
5.5
6
6.5
7
7.5
8
N
(N
 × 
IM
S
E
) 0
.5
10 20 30 40 50 60 70 80 90 100
5.5
6
6.5
7
7.5
8
8.5
9
9.5
10
10.5
N
(N
 × 
IM
S
E
) 0
.5
10 20 30 40 50 60 70 80 90 100
6
8
10
12
14
16
18
20
N
(N
 × 
IM
S
E
) 0
.5
10 20 30 40 50 60 70 80 90 100
5
10
15
20
25
30
35
N
(N
 × 
IM
S
E
) 0
.5
(b1) k=0 (b2) k=0.1 (b3) k=0.2 (b4) k=0.4 
圖二：非線性指數模型參數 )'5.0,10(),( 21 =θθ 之順序設計結果 
(a1)-(a4) IMSE 圖；(b1)-(b4)平均 IMSE⋅N 圖 
10 20 30 40 50 60 70 80 90 100
0
5
10
15
20
25
30
N
IM
S
E
10 20 30 40 50 60 70 80 90 100
5
10
15
20
25
30
35
N
IM
S
E
10 20 30 40 50 60 70 80 90 100
5
10
15
20
25
30
35
40
45
N
IM
S
E
10 20 30 40 50 60 70 80 90 100
10
20
30
40
50
60
70
N
IM
S
E
(a1) k=0 (a2) k=0.1 (a3) k=0.2 (a4) k=0.4 
10 20 30 40 50 60 70 80 90 100
17
18
19
20
21
22
23
N
(N
 × 
IM
S
E
) 0
.5
10 20 30 40 50 60 70 80 90 100
18
20
22
24
26
28
30
N
(N
 × 
IM
S
E
) 0
.5
10 20 30 40 50 60 70 80 90 100
20
22
24
26
28
30
32
34
36
38
40
N
(N
 × 
IM
S
E
) 0
.5
10 20 30 40 50 60 70 80 90 100
25
30
35
40
45
50
55
60
65
70
N
(N
 × 
IM
S
E
) 0
.5
(b1) k=0 (b2) k=0.1 (b3) k=0.2 (b4) k=0.4 
圖三：雙變量分數形式參數 )5.2,5.0,50(),,( 321 =θθθ (a1)-(a4) IMSE 圖； 
(b1)-(b4)平均 IMSE⋅N 圖，(—)為順序設計和(--)為隨機設計 
四、結論 
    本研究提出結合 GRNN 和順序設計的方法來近似未知的非線性模型，這是
一種運用類神經網路既快速又穩定的學習特性和有效的透過最小變異的方式，依
序決定樣本設計點位置的新方法。另外配合順序設計法更新 GRNN 的模型以便
更快速的以少量的設計點逼近實際的非線性模型。 
    我們用提出的方法處理線性模型、指數模型、和雙變量的分數形式模型，實
驗結果顯示，本方法可用快速降低平均方差以達到近似的效果。與其它參數模型
做比較，可發現不必在同一設計點重複取樣，因為不需要估計母體的變異數，可
