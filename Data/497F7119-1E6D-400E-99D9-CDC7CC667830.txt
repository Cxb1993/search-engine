行政院國家科學委員會專題研究計畫成果報告 
虹膜影像辨識系統與 FPGA 實作 
Iris Recognition System and its FPGA implementation 
計畫編號：96-2628-E-005-089-MY2 
執行期限：96 年 8 月 1 日至  98 年 7 月 31 日 
主持人：陶金旭 教授 
共同主持人：陶金旺教授 
計畫參與人員：蔡仲智，許嘉倫，林恆毅，何省華，白雯琪 
 
 
中文摘要 
在本計畫中，我們提出兩種虹膜特徵
萃取方法，並且利用設計的特徵萃取方法
建構出不同的虹膜辨識系統。在影像前置
處理模組中，我們將虹膜下半部影像分
割、展開並且正規化成一個矩形區塊影
像。接著，分別利用提出的二種特徵萃取
方法，在正規化的虹膜區塊中抽取出虹膜
特徵向量。在提出的第一組虹膜系統中，
我們運用多通道的賈伯濾波器對正規化的
虹膜區塊分解產生輸出影像。然後藉由分
析每張濾波器輸出影像水平方向的相對變
化性，產生一組精簡的虹膜特徵碼。此外，
系統採用了一個簡單的特徵選取演算法去
除多餘的虹膜資訊，同時提升系統辨識
率。我們也以 Verilog 硬體描述語言來設計
此系統之特徵萃取模組，並使用 Xilinx ISE 
8.1i 將所設計之數位電路實現在場效可程
式化邏輯閘陣列之硬體上。在第二組辨識
系統中，我們提出了一個賈伯濾波器最佳
化的方法。我們利用粒子群最佳化演算法
產生最佳化賈伯濾波器的參數，並且發展
一套連續法來決定對於特定問題所需要的
濾波器數量。第二種虹膜辨識系統利用最
佳化的賈伯濾波器來萃取虹膜特徵，並且
使用相對變化分析法產生一組更為精簡且
有效的虹膜碼。實驗結果顯示，本計畫所
提出的虹膜辨識系統能產生較小的特徵向
量同時達到極高的辨識率。 
 
關鍵詞：虹膜辨識、賈伯濾波器、特徵選
取、粒子群最佳化。 
 
Abstract 
In this project, two iris feature 
extraction methods are proposed to build the 
different iris recognition systems. In the 
preprocessing stage, the lower part of the iris 
is unwrapped and normalized to a 
rectangular block. After that, the proposed 
feature extraction algorithms are applied to 
generate the iris feature vector. In our first 
system, we adopt a bank of Gabor filters to 
extract the iris features. The normalized iris 
block is first decomposed by the 
multi-channel Gabor filters. Then the iris 
code is generated by analyzing and encoding 
the horizontal variation of each filtered 
image. Moreover, a sequential floating 
search scheme is used to discard the 
redundant features and improve the system 
performance. The feature extraction of this 
system is also designed by using Verilog 
Hardware Description Language and 
implemented on a File Programmable Gate 
Array (FPGA) using Xilinx ISE 8.1i. In the 
second proposed system, the parameters of 
the Gabor filters are optimized by the 
particle swarm optimization. In addition, a 
sequential scheme is developed to determine 
the number of filters for a particular 
application. During the iris feature 
extraction, the normalized iris image is 
decomposed by the optimized Gabor filters 
and then a compact iris code is generated by 
using the relative variation analysis. 
Experimental results show that each 
proposed approach can produce comparable 
performance to existing methods 
 
Keywords: iris recognition, Gabor filter, 
feature selection, particle swarm 
optimization, FPGA. 
 
一、前言 
由於安全系統的需求與日俱增，因此
賈伯濾波器已被應用至許多關於影像
處理領域的研究課題，例如：紋理分割
[21][22]、邊緣偵測[23]、影像編碼[24]、
指紋影像處理[25]等。其中，賈伯濾波器
最主要的問題在於如何設計每個濾波器的
參數，以及如何決定針對特定應用問題所
需要的濾波器數目。一般二維賈伯濾波器
的定義如下： 
 
   2 22 21, ; , exp exp 22 x y
x yG x y f i fx  
          
 
cos sin
sin cos
x x
y y
 
 
                 
 
其中 f 與  是濾波器之中心頻率與角方
向，而 x 與 y 代表延 x 軸與 y 軸的高斯小
波包。由式子中，我們可以發現每個賈伯
濾波器有四個參數需要被決定。 
 
(二)粒子群最佳化演算法 
粒子群演算法屬於演化式計算技術的
一種，其最早被 Kennedy 與 Eberhart [26]
所提出。在此演算法中，每個粒子藉由調
整其速度(速率與方向)，嘗試在問題空間
(problem space)中找出一組最佳解。而粒子
調整改變其速度的準則，除了依據其自身
的經驗以外，也考量整體群組在當下得到
的最佳經驗。相對於基因演算法在每次疊
代時，需要三種運算與更新 (selection, 
crossover and mutation)，粒子演算法只需
要更新粒子的速度。 
在 PSO 演算法中，每個粒子各自擁有
座標向量，此向量代表 l 維問題空間中的
一個解。原始基本的 PSO 中，粒子的速度
與位置更新方程式之定義如下： 
    1 1 1 , 2 2k k k ki i i lb i gb iw c r c r     V V X X X X  
1 1k k k
i i i
  X X V  
 
其中 kiX 與 kiV 分別表示第 i 個粒子在第 k
次疊代中，其 l 維的位置向量與速度向
量。在速度更新方程式中， 1c 與 2c 是加速
度常數， 1r 與 2r 為兩個在  0,1 區間均勻分佈
的隨機變數。此外， ,i lbX 代表第 i 個粒子
直到當下所找到最佳解的位置，而 gbX 則
為粒子群體所搜尋到最佳解的位置。 
Clerc [27][28] 導入一個限制因子(  )
來控制 PSO 演算法的收斂特性。此改善後
的演算法稱為 constriction factor approach 
(CFA)，其粒子速度更新方程式改寫為： 
 
   1 1 1 , 2 2k k k ki i i lb i gb ic r c r       V V X X X X
 
1 22
2 ,   where ,   4
2 4
c c  
  
   
  
 
 
Clerc 證明當 1 2c c   大於 4 時，限制因子
可以確保 PSO 演算法的收斂。一般而
言，的值設定為 4.1。 
 
四、研究方法 
首先，在提出的第一套虹膜辨識系統
中，我們採用一組賈伯濾波器來萃取虹膜
紋理資訊，並提出一套適合分析虹膜特性
的特徵編碼演算法。最後，我們進一步利
用簡單的特徵選取方法濾除多餘的虹膜特
徵，以產生一組緊密而有效的虹膜碼。此
外，我們藉由 FPGA 實作此系統之特徵萃
取模組，並分析其在硬體實作所能達到的
效果。 
在另一套虹膜辨識系統中，我們提出
賈伯濾波器最佳化的方法。此方法藉由粒
子群最佳化演算法產生濾波器之參數最佳
化。此外，我們也提出連續法來決定對於
特定問題所需要的濾波器的數量。因此，
第二套虹膜辨識系統中，我們利用最佳化
的賈伯濾波器以及第一套辨識系統的編碼
法來產生更為精簡而有效之虹膜特徵碼。 
 
(一)虹膜影像前處理 
人眼虹膜的環形區塊位於瞳孔與鞏膜
之間，且經常受到眼瞼與睫毛的遮蓋。因
此，虹膜內外兩邊界需要被偵測以去除影
像中非虹膜區域。並且眼瞼遮蔽區域亦須
將其偵測與濾除，降低此雜訊造成系統辨
識率的降低。此外，虹膜影像可能受到取
像距離、瞳孔縮放與光照程度等影響，增
進系統辨識的難度。因此在影像前處理
中，這些可能影響辨識率的因素必須將其
去除或補償。本計畫提出的虹膜辨識系統
中，影像前處理模組包含了四個步驟：虹
膜邊緣偵測、虹膜選取區域展開、眼瞼偵
小比例，可以用來評估此虹膜區塊影像是
否擁有足夠的資訊。 
由於虹膜取像時，可能會有光照強度
的變化，造相同的虹膜會取得不同亮度之
影像。為了進一步增進系統的正確率，我
們將已去除眼瞼之後的虹膜區域影像正規
化為零均值與單位變異數。眼瞼偵測結果
與影像正規化如圖五(c)和(d)所示。 
 
(二)系統 I 之虹膜特徵萃取 
在我們所提出的第一套虹膜辨識系統
的特徵萃取模組中，我們採用[32]中所提
出的一組賈伯濾波器模型，以萃取出虹膜
複雜紋理的特徵。接著，藉由分析虹膜角
方向變化，將濾波器輸出影像進行編碼，
產生較小的虹膜特徵碼。最後，我們採用
一簡單的特徵選取演算法來去除多餘的虹
膜資訊。 
Gabor filters 可視為具有方向性的帶
通濾波器，我們採用[32]中所定義的濾波
器模型(圖六)，對第 j 個頻率、第 k 個方向
的 Gabor filter 如下： 
 
     2 2 2 21, exp exp 22 j k jjk r rg x y x y i x       
 
cos sin
sin cos
k k
k k
x x
y y
 
 
             
 
 
其中1 j m  、1 k n  。選擇的角頻寬為
n ，我們可以得到： 
 
2k n 
    
 
因此，濾波器之角方向中心之定義為： 
 
 2 1
k
k     
 
藉由選取
min max
0 1 2r r    ，徑方向中心
與頻寬為： 
 
  min 10
1
0
1 3 2 1
2
j
j
j
r r
j
r
  
 


   
 
 
 
其中 
 max min0 2 2 1r rm
     
 
此組賈伯濾波器模型可以將虹膜影像
分解為m n 個輸出影像。藉由計算輸出影
像的強度值(magnitude)，可以得到m n 個
虹膜子影像。在實驗中我們選取三個頻率
及八個方向角的 Gabor filters，產生二十四
張虹膜區塊子影像，圖七為虹膜區塊子影
像輸出結果。 
依據觀察，虹膜紋路的變異性在原始
影像的角方向較徑方向大。因此，我們藉
由分析正規化虹膜區塊水平方向的變化，
產生一組有效的虹膜特徵碼。首先，我們
將每張虹膜子影像分割出 8 21 個不重疊
的小區塊，並且計算每個小區塊的均值
M 。由於系統產生 24 張虹膜子影像，我
圖五：虹膜影像前處理：(a)展開之虹膜
區塊。(b)下眼瞼偵測結果。(c)影像正規
化。 
圖六：賈伯濾波器於頻域之模型。 
SFFS 某一階段所選出 n 條虹膜帶中的第 i
條相對應虹膜帶的相異距離。 
    令  :1 ,  n i iY y i n y X    代表 n 個距
離特徵最佳組合的集合，而 192 nY X  代表
X 中其他距離特徵的集合。假設我們設定
SFFS 欲選取虹膜帶的數目為 ，則此特
徵選取演算法描述如下： 
 
1) Initialization: 令 0n   及 0Y  . 
a) 從 192 nY  中選取一元素，此元素加入
集合 nY 後可產生最小等錯誤率， 
  
192
arg  min ,  
n ny Y
y EER Y y

 ； 將此
元素加入最佳距離特徵組合中
(  1 ,  n nY Y y  )，並令 1n n  。 
b) 若 2n  則重覆步驟 1.a；否則跳至步
驟 2。換言之，初始特徵組合數目為
2。 
2) Inclusion stage: 從 192 nY  中選取一元
素，此元素加入集合 nY 後可產生最小等
錯誤率，將此元素加入最佳距離特徵組
合中(  1 ,  n nY Y y  )，並令 1n n  。 
3) Test stage:  
a) 從 nY 中選出最差的元素，也就是
  arg  min
ny Y n
y EER Y y   。 
b) 若 y y  或
   1( )n nEER Y y EER Y   ： 
i.若 n  ，則終止演算法。 
ii.否則跳至步驟 2。 
c) 若 3n  ，將 y 移出最佳組合中並令
1n n  ；跳至步驟 2。 
4) Exclusion stage: 將 y移出最佳組合中
(  1n nY Y y   )並令 1n n  。清除 y並
且跳至步驟 3。 
 
最後，SFFS 所選取的 個距離特徵
組合(  :1 ,  i iY y i y X     )，其所相對
應的虹膜帶即為系統最後選取的特徵，並
且以選取的虹膜帶組成新的特徵向量 vˆ 。 
 
(四)虹膜特徵比對 
對於虹膜識別(identification)模式，輸
入影像所萃取的特徵向量 vˆ ，將與資料庫
所有特徵進行比對，判別其是否屬於此資
料庫以及其身分。本系統採用二元
Hamming 距離來計算兩虹膜碼間的差
異。假設資料庫中擁有 K 個類別的虹膜，
每個類別有 L 個不同影像產生的樣板(虹
膜碼)。令 ,ˆ i lv 表示資料庫中第 i 個類別的第
l 個樣板碼，而 ˆ jv 與 ,ˆ ji lv 分別代表兩向量 vˆ
及 ,ˆ i lv 中第 j 個元素。 ,i lE 為 vˆ 間 ,ˆ i lv 共同有
效元素。因此，兩虹膜碼之間的差異距離
定義為： 
 
  
,
20
,
1,
1 ˆ ˆ
i l
j j
H i l
ji l
j E
d
E



  v v  
 
其中 ,| |i lE 代表共同有效元素 ,i lE 的位元
數，  20 為特徵向量的長度。對於虹
膜識別模式，輸入測試影像將被確認為第
c 類別，此類別某個樣板與其相異距離最
小，也就是： 
 
1
1
arg min ( , )Hi Ki l L
c d i l  
  
 
在前處理定位出虹膜內外邊界，同時
也達到移動不變性(shift invariance)。將虹
膜有效區域正規化展開為固定大小的長方
形 區 塊 ， 完 成 了 尺 度 不 變 性 (scale 
invariance) 。 而 轉 動 不 變 性 (rotation 
invariance)在正規化的虹膜區塊中轉換成
了水平移動量。因此，我們在比對虹膜時，
藉由平移正規化虹膜區塊，便達到了原始
虹膜影像的轉動不變性。在實驗中，正規
化虹膜分別平移了-16 至+16 個像素。 
 
(五)FPGA 硬體實現 
在硬體實現上主要是使用 XESS 公司
所生產的 XSA-3S1000 與 XStend Board 
3.0 的硬體 FPGA 驗證板來進行驗證。
XESS 驗證板(如圖九)主要分為兩個模
組：XSA-3S1000 與 XStend Board 3.0。 
 
(六)最佳化賈伯濾波器與虹膜辨識系統 II 
由於難以針對特定應用問題，人工優
化賈伯濾波器的參數。因此，我們利用
CFA-PSO 演算法來解決濾波器參數優化
的難題。 
假設系統所需的濾波器數目為 n。令
PSO 演算法中，第 i 個粒子的 4n 維位置向
量為： 
 
 1 2 ... ,    for 1,..., .Ti i i inY Y Y i m X  
 
其中 m 為粒子的數量，而 x yij ij ij ij ijY f      
代表第 j 個濾波器的參數。當粒子撞擊到
我們所預設的問題空間邊界時，則改變其
相對應速度向量元素的正負號。每個粒子
皆隨機初始化其位置向量與速度向量。在
每次疊代步驟中，我們利用每個位置向量
所代表的濾波器來萃取虹膜特徵，並且估
算訓練影像組的適應值(fitness value)。 
在提出的第二套虹膜辨識系統中，我
們稱利用 PSO 最佳化賈伯濾波器的方法
為 PSOGF，並且採用了兩種 ROC 曲線評
估法做為最佳化演算法的適應值。這兩種
評估法分別是 area under the ROC (AUC)
以及 EER。以下描述基於 AUC 的 PSOGF
的步驟： 
1) 隨機初始各粒子之位置向量與速度向
量。 
2) 利用各粒子之位置向量所代表的賈伯
濾波器來萃取虹膜訓練影像之特徵，並
且估算 AUC 值。 
3) 更新每個粒子的 lbX 以及群體的 gbX 。 
4) 依據速度與位置更新方程式計算各粒
子下一時間的速度與位置。 
5) 重覆步驟 2 至 4，直到達成演算法終止
條件。 
PSOGF 演算法可以最佳化一組賈伯
濾波器的各個參數，但是無法針對特定問
題決定其所需要的濾波器數目。因此，我
們進一步提出 sequential PSOGF 演算法。
此方法不僅能最佳化各個濾波器的參數，
同時也能決定適合某問題之濾波器數量。 
連續 PSOGF 法的基本概念是利用原
始 PSOGF 一個接著一個的選取並最佳化
濾波器參數，而每次 PSOGF 的問題空間
維度為 4。當演算法正在最佳化第 k 個濾
波器時，前面已決定的 ( 1)k  個濾波器必
須同時用來萃取訓練組的特徵。因此，我
們定義一個位置佇列(position queue)來記
錄已選取的濾波器參數。令 qX 為位置佇
列，則基於 AUC 的連續 PSOGF 演算法
(SPSOGF-AUC)的描述如下： 
1) 初始位置佇列為空集合 q X ，並設
定 maxAUC 值為零。 
2) 隨機初始每個粒子的四維位置向量與
速度向量。 
3) 利用每個粒子的位置向量並結合位置
佇列所代表的濾波器來萃取訓練資料
集合之特徵，並且計算其 AUC 值。 
4) 更新 PSOGF 演算法中的 lbX 與 gbX 。 
5) 計算更新各粒子下一時間的速度與位
置。 
6) 重覆步驟 3 至 5，直至達到 PSOGF 的
終止條件。接著計算群體最佳位置的
AUC 值( GBAUC )。 
7) 若 GBAUC 大 於 maxAUC ， 則
max GBAUC AUC 令並且新增此群體最
佳 位 置 到 位 置 佇 列 中
( ,
TT T
q q gb   X X X )。清除粒子群之記憶，
並且回到步驟 2 。若 GBAUC 小於
maxAUC ，則終止演算法。 
基於 EER 的連續 PSOGF 演算法
(SPSOGF-EER)可利用相同的流程獲得。
不同處在於 SPSOGF-EER 在求取最小的
EER 值，而不是最大化 AUC 值。 
在位置佇列中，擁有最大 AUC 或最
小EER值的前 n個賈伯濾波器代表演算法
搜尋出最佳的濾波器組合。在實驗中，我
們利用 SPSOGF-AUC 與 SPSOGF-EER 分
別找出兩組最佳化的賈伯濾波器集合。此
圖十三：FFT/IFFT IP Core 元件圖。 
0 0.1 0.2 0.3 0.4 0.5 0.6
0
1
2
3
4
5
Distance
D
en
si
ty
 (%
)
 
 
Inter-Class
Intra-Class
(a)全部虹膜帶 
0 0.1 0.2 0.3 0.4 0.5 0.6
0
1
2
3
4
5
Distance
D
en
si
ty
 (%
)
 
 
Inter-Class
Intra-Class
(b)98 條虹膜帶 
0 0.1 0.2 0.3 0.4 0.5 0.6
0
1
2
3
4
5
Distance
D
en
si
ty
 (%
)
 
 
Inter-Class
Intra-Class
(c)119 條虹膜帶 
圖十七：不同虹膜帶組合之 intra-class 與
inter-class 距離分佈圖。 
 
對於 UBIRIS 資料庫，我們亦採用各
類別前四張影像作為訓練資料，而所有影
像作為測試資料。在訓練階段，SFFS 演算
法選出最佳組合為 162 條虹膜帶，此組合
在測試階段的等錯誤率為 1.04%。而當使
用完整虹膜影像時，等錯誤率為 1.24%。
由於 UBIRIS 資料庫在自然光源之下取
像，在虹膜紋路上產生較大的反光等雜
訊。因此，其錯誤率較 CASIA 資料庫來得
大。此外，由 SFFS 演算法使用 CASIA 資
料庫作為訓練資料所選出的虹膜帶組合也
用來測試其在 UBIRIS 資料庫的效能。如
表一所示，當使用以 CASIA 為訓練資料所
選出的 98 條與 119 條虹膜帶組合時，其等
錯誤率為 1.86%及 1.49%。此結果顯示，
當訓練資料與測試虹膜來自完全不同的資
料庫時，SFFS 演算法可以大幅降低特徵向
量的大小，同時維持相當的等錯誤率。 
如圖十八所示，當眼瞼大面積的遮蓋
住虹膜區域時，可能導致辨識系統所得到
的資訊不足，進而降低其辨識效能。因此，
我們另外設計一個測試條件來評估遮蔽範
圍所造成的效能影響。在影像前處理中，
我們可以偵測出虹膜被眼瞼遮蔽的區域。
藉由眼瞼偵測的結果，我們可以估算正規
化之虹膜區塊被遮蔽的面積比例。當一張
虹膜影像被遮蔽的比例大於一預設的門檻
值 RT 時，則系統認為此影像之資料量不
足，並且去除此虹膜影像。當 RT 值愈小
時，更多的虹膜影像會被去除。如圖十九
與表二所示，系統效能在不同虹膜帶的組
合時，藉由去除資訊量不足之影像，皆可
以進一步提升系統的辨識效能。其中，使
用 119 條虹膜帶並設定 RT 為 0.4 時，等錯
誤率可降低至 0.0044%。 
表一：以 UBIRIS 資料庫為測試資料時，
不同虹膜帶組合產生的等錯誤率。括號中
為虹膜帶之數目。 
訓練資料 等錯誤率 
CASIA 1.86% 
(98) 
1.49% 
(119) 1.24% 
(192) UBIRIS 1.04% 
(162) 
1.02% 
(168) 
 
中，我們不改變小區塊的數量(8 21 個)，
但改變每個小區塊的大小。 
此外，硬體環境使用 fixed point 運
算，與使用 Matlab 開發之演算法的 floating 
point 不同。為了分析影像重新取樣以及運
算精確度改變的問題，是否影響系統辨識
正確率，我們以 Matlab 之浮點數運算環境
下，測試重新取樣(64×512 像素)之虹膜區
塊的正確辨識率。同時，測試定點數運算
與重新取樣的條件下，評估系統效能。如
表三所示，平均辨識率在硬體環境下會有
些微的下降。我們比對 FPGA 實驗板中完
成賈伯濾波器後之輸出影像與使用Matlab
完成相同濾波的影像，造成兩者雜訊誤差
的原因是浮點數與定點數的運算差異。如
圖二十一所示，兩者濾波器結果相似。因
此，可能造成硬體實作時，辨識率下降的
主要原因是重新取樣所造成的影響。重新
取樣過大的虹膜影像，可能造成影像失
真，進而影響了系統之效能。 
 
(三)虹膜辨識系統 II 之實驗結果 
在系統 II 的認證實驗中，我們採用
AUC 與 EER 來評估系統之效能。首先，
在 SPSOGF 的訓練模式中，我們選用
CASIA-IrisV3-Interval 資料庫中每個類別
的前三張虹膜影像作為訓練資料。對於每
次 PSOGF 演算法，設定的粒子數為 10，
而 1c 與 2c 皆設定為 2.05。採用 AUC 與 EER
為適應值評估法時，其訓練結果分別如圖
二十二(a)與(b)所示。其中，SPSOGF-AUC
演算法的訓練模式中，得到最小的(1-AUC)
值為 4.64×10-8，此時選出了十個最佳化的
賈伯濾波器。而 SPSOGF-EER 在訓練時期
的最小 EER 值為 3.56×10-5，同樣選出十個
賈伯濾波器。如圖二十三所示，兩種演算
法雖然同樣選出十個賈伯濾波器，但這兩
組濾波器並不相同。 
在測試階段，先以 CASIA 資料庫中除
了訓練影像之外的資料做為測試資料。由
於 SPSOGF認為選出一組包含十個賈伯濾
波器是最佳的濾波器數量，我們在測試階
段以 8 至 11 個選出的濾波器來進行測試，
分析是否十個濾波器是最佳的數量。如圖
二十二所示，不論是 SPSOGF-AUC 或是
SPSOGF-EER 的測試結果，都是以十個濾
波器得到最佳的系統效能。因此，我們所
提出的第二套虹膜辨識系統，每筆虹膜資
料只使用了 1600 bits的記憶體來儲存特徵
碼，同時可以達到極高的辨識效能。 
為了比較最佳化賈伯濾波器與傳統賈
表三：比較硬體環境下之系統效能。 
Method 
Average CRR (%) 
RT =100% 70% 50% 
原系統 100 100 100 
重新取樣 
(浮點數) 99.95 99.99 100 
重新取樣
(定點數) 99.93 100 100 
 
圖二十一：軟體與硬體之賈伯濾波器實作
結果比較。 
(a) SPSOGF-AUC 
(b) SPSOGF-EER 
圖二十二：SPSOGF 之訓練時期與測試階
段，不同數量濾波器相對應之適應值變
化。 
效能。對 UBIRIS 資料庫，其正確辨識率
為 99.64%。換言之，UBIRIS 資料庫只有
兩張錯誤辨識之虹膜影像。 
 
對於我們所提出的兩套虹膜辨識系
統，可以發現在 UBIRIS 資料庫的測試下
的效能不如使用 CASIA 資料庫。如同先前
所提，UBIRIS 資料庫中第二時期的取像
環境是在自然光照之下，因而在虹膜影像
中產生許多環境反光的雜訊，如圖二十五
(a)。這些嚴重的反光，是導致整體系統辨
識效能下降的主要原因。此外，這個資料
庫也包含了許多失焦的影像，如圖二十五
(b)，同樣會造成系統的辨識錯誤。對於
CASIA 資料庫，除了大面積虹膜區域受到
眼瞼遮蔽造成的辨識影響外，資料庫也有
少數影像品質較差的檔案。如圖二十六所
示，交錯(interlaced)的虹膜影像通常會造
0 0.02 0.04 0.06 0.08 0.1 0.12
0
0.02
0.04
0.06
0.08
0.1
0.12
False Acceptance Rate (%)
Fa
ls
e 
R
ej
ec
tio
n 
R
at
e 
(%
)
 
 
Non-rejection
TR : 0.8
TR : 0.6
TR : 0.4
EER
0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
False Acceptance Rate (%)
Fa
ls
e 
R
ej
ec
tio
n 
R
at
e 
(%
)
 
 
Non-rejection
TR : 0.8
TR : 0.6
TR : 0.4
EER
(a) CASIA (b) UBIRIS (ALL) 
0.05 0.1 0.15 0.2 0.25
0.05
0.1
0.15
0.2
0.25
0.3
False Acceptance Rate (%)
Fa
ls
e 
R
ej
ec
tio
n 
R
at
e 
(%
)
 
 
Non-rejection
TR : 0.8
TR : 0.6
TR : 0.4
EER
0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
False Acceptance Rate (%)
Fa
ls
e 
R
ej
ec
tio
n 
R
at
e 
(%
)
 
 
Non-rejection
TR : 0.8
TR : 0.6
TR : 0.4
EER
(c) UBIRIS (SS) (d) UBIRIS (DS) 
圖二十四：設定不同遮蔽門檻值之 DET 曲線與等錯誤率。 
表五：設定不同遮蔽門檻值之虹膜認證實驗結果。 
 R
T  
1 0.8 0.6 0.4 
CASIA 
EER 0.0456% 0.0301% 0.0232% 0.006% 
1-AUC 9.6694×10-7 4.6391×10-7 1.5514×10-7 0.2317×10-7
UBIRIS(SS) 
EER 0.1194% 0.1194% 0.1189% 0.1120% 
1-AUC 5.3738×10-6 5.3738×10-6 5.3021×10-6 4.7035×10-6
UBIRIS(DS) 
EER 0.8567% 0.8567% 0.8551% 0.7425% 
1-AUC 3.5516×10-4 3.5516×10-4 3.5400×10-4 2.5842×10-4
UBIRIS(ALL) 
EER 0.7816% 0.7816% 0.7803% 0.6995% 
1-AUC 2.6491×10-4 2.6491×10-4 2.6418×10-4 1.9831×10-4
 
 
 
表七：虹膜辨識系統於 UBIRIS 資料庫之
效能比較數據。 
Methods EER (%) 
Proença and Alexandre 2.38 
System I 1.04 
SPSOGF-AUC 0.78 
SPSOGF-EER 0.44 
 
 
 
參考文獻 
 
[1] F. H. Adler, Physiology of the Eye. St. Louis, 
Mo: Mosby, 1965. 
[2] L. Flom and A. Safir, “Iris recognition 
system,” U.S. Patent 4 641 349, 1987. 
[3] J. G. Daugman, “High confidence personal 
identification by rapid video analysis of iris 
texture,” Proc. IEEE Int. Carnahan Conf. 
on Security Technology, pp.1-11, 1992. 
[4] J. G. Daugman, “High confidence visual 
recognition of persons by a test of statistical 
independence,” IEEE Trans. on Pattern 
Analysis and Machine Intelligence, vol. 15, 
No. 11, pp. 1148-1161, Nov. 1993. 
[5] J. G. Daugman, “Biometric personal 
identification system based on iris analysis,” 
U.S. Patent 5 291 560, 1994. 
[6] J. G. Daugman, “Complete discrete 2-D 
Gabor transforms by neural network for 
image analysis and compression,” IEEE 
Trans. Acoust., Speech, Signal Processing, 
vol. 36, pp. 1169-1179, Jul. 1988. 
[7] J. G. Daugman, “New methods in iris 
recognition,” IEEE Trans. Systems, Man 
and Cybernetics - Part B: Cybernetics, vol. 
37, no. 5, pp. 1167-1175, Oct. 2007. 
[8] R. P. Wildes, J. C. Asmuth, G. L. Green, S. 
C. Hsu, R. J. Kolczynski, J. R. Matey and S. 
E. McBride, “A system for automated iris 
recognition,” Proc. IEEE Workshop on 
Applications of Computer Vision, Sarasota, 
FL, pp. 121-128, Dec. 1994. 
[9] R. P. Wildes, J. C. Asmuth, G. L. Green, S. 
C. Hsu, R. J. Kolczynski, J. R. Matey and S. 
E. McBride, “A machine-vision system for 
iris recognition,” Machine Vision and 
Applications, vol. 9, pp. 1-8, 1996. 
[10] R. P. Wildes, J. C. Asmuth, S. C. Hsu, R. J. 
Kolczynski, J. R. Matey and S. E. McBride, 
“Automated, noninvasive iris recognition 
system and method,” U.S. Patent 5 572 596, 
1996. 
[11] R. P. Wildes, “Iris recognition: an emerging 
biometric technology,” Proceedings of the 
IEEE, vol. 85, No. 9, pp. 1348-1363, Sep. 
1997. 
[12] W. W. Boles, B. Boashash, “A human 
identification technique using images of the 
iris and wavelet transform,” IEEE Trans. on 
Signal Processing, vol. 46, No. 4, pp. 
1185-1188, Apr. 1998. 
[13] C. Sanchez-Avila, R. Sanchez-Reillo, and D. 
de Martin-Roche, “Iris-based biometric 
recognition using dyadic wavelet 
transform,” IEEE Aerosp. Electron. Syst. 
Mag., vol. 17, pp. 3-6, Oct. 2002. 
[14] Y. Zhu, T. Tan, and Y. Wang, “Biometric 
personal identification based on iris 
patterns,” Proc. of the 15th International 
Conference on Pattern Recognition, vol. 2, 
pp. 801-804, 2000. 
表六：虹膜辨識系統效能於 CASIA-V3-Interval 資料庫之比較數據。 
方法 AUC (%) EER (%) CRR (%) 虹膜碼 (bits) 
Daugman 99.99 0.08 100 2048 
Wildes et al. 99.75 1.76 － － 
Boles 94.52 8.13 92.64 － 
Ma et al. － 0.07 100 5280 
系統 I 99.96 0.0536 100 1960 
SPSOGF-AUC 99.999903 0.0456 100 1600 
SPSOGF-EER 99.999764 0.0321 100 1600 
國科會補助出席國際會議報告 
                                           98  年   10   月   25   日 
報告人姓名 陶金旭 服務機關名稱（請註明系所）及職稱
國立中興大學電機工程學系
教授 
會議期間及地點 
2008/10/12 – 2008/10/15 
新加坡 
國科會核定 
補助文號 
   
96-2628-E-005-089-MY2 
會議名稱 
（ 中文 ）2008 國際電機電子工程師學會之系統、人與仿生科技國
際研討會 
（ 英文 ）2008 IEEE International Conference on Systems, Man, and 
Cybernetics 
發表論文題目 
（ 中文 ）虹膜辨識運用粒子群聚技術最佳化之賈伯濾波器 
（ 英文 ）Iris Recognition using Gabor Filters Optimized by the Particle Swarm 
Technique 
報告內容應包括下列各項： 
 
 
一、 參加會議經過 
 
IEEE SMC 國際研討會會議主旨是讓學者專家交換最新的研究心得。會議涵蓋領域為systems 
science and engineering、human-machine systems以及cybernetics，主題包含系統，人工智慧，控
制，影像信號處理，人機介面等，是此領域非常重要的會議，也是提供各國學者發表其創新的
研究並且彼此交換意見的重要平台。 
 
2008 IEEE SMC會議在新加坡舉辦，會議期間為十月十二日至十月十五日。此次會議主軸
為Intelligent Sensor and Actuator Networks in Human Environments。投稿之論文總數約有來自43
不同之國家的論文1000篇，有618篇論文被接受並於分別在98個 oral sessions 以及 3個 poster 
sessions會議發表，其中並於十月十三、十四、十五日共有三場一小時之keynote speech，早上、
中午與下午各有十至十一場不同主題論文發表。 
 
我們在第二天下午發表一篇口頭論文，主要是提出一個有效率的虹膜辨識特徵向量，並利
用粒子群聚演算法來求得最佳化Gabor filters的參數以及濾波器的數目。研究成果顯示我們可以
使用較少的資料量達到極高的辨識正確率。藉由發表論文的機會，可獲得與會學者建議與心得，
進一步發展與提升研究成果。此一成果經修改後刊登於Journal of Electronic Imaging 期刊中。 
 
會議現場 
 
 
 
 
我們發表的論文 
 
 
 
Iris Recognition Using Gabor Filters Optimized by 
the Particle Swarm Technique 
 
C.C. Tsai 
Department of Electrical Engineering 
National Chung Hsing University 
Taichung, Taiwan, ROC 
J.S. Taur 
Department of Electrical Engineering 
National Chung Hsing University 
Taichung, Taiwan, ROC 
C.W. Tao 
Department of Electrical Engineering 
National I-Lan University 
Yilan, Taiwan, ROC 
 
 
Abstract—In this paper, an efficient feature extraction 
algorithm based on optimized Gabor filters and a relative 
variation analysis approach is presented for iris recognition. The 
Gabor filters are optimized by tuning the parameters with the 
particle swarm optimization method. Moreover, a sequential 
filter scheme is developed to determine the number of filters in 
the optimal Gabor filter bank. In the preprocessing step, the 
lower part of the iris image is unwrapped and normalized to a 
rectangular block which is then decomposed by the optimal 
Gabor filters. After that, a simple encoding method is adopted to 
generate a compact iris code. Experimental results show that the 
performance of the proposed method is encouraging and 
comparable to those of the existing iris recognition systems. 
Keywords— iris recognition, Gabor filter, particle swarm 
optimization. 
I. INTRODUCTION 
The Gabor decomposition adopts directional band-pass 
filters which have orientation-selective and frequency-selective 
properties and provide optimal joint resolution in both spatial 
and frequency domains [1]. Further, the multiresolution Gabor 
filters are similar to the 2-D receptive field profiles of the 
mammalian cortical simple cells [2]. The major challenge 
associated with Gabor filters is to design the parameters of the 
optimal filters and to decide the number of filters for a 
particular application. Sun et al. [3] proposed an evolutionary 
Gabor filter optimization method using the genetic algorithm 
to select a bank of Gabor filters for the task of vehicle 
detection. In this paper, we propose a novel Gabor filter design 
approach based on the particle swarm optimization (PSO) 
approach to select a bank of Gabor filters with optimal 
parameters. 
For the last decade, iris recognition has been a popular 
research topic in biometrics. In 1987, the first concept of iris 
recognition system is proposed by Flom and Safir [4]. 
Daugman used the first order derivatives of image intensity to 
locate the circular edges of the iris and made use of multi-scale 
quadrature 2-D Gabor wavelets to capture the information of 
the local phase [5]-[7]. The 2048-bit iris code was generated by 
quantizing the local phase angle according to the outputs of the 
real and imaginary part of the filtered images. The Hamming 
distance was adopted to evaluate the difference between a pair 
of feature vector. Wildes et al. [8]-[10] used a Laplacian 
pyramid constructed with four different resolution levels to 
extract the iris feature. The normalized correlation and the 
Fisher classifier were applied to decide if two different iris 
images are from the same class. In [11], the zero-crossing 
representation of a 1-D dyadic wavelet transform at different 
resolution levels was utilized to extract the feature of the iris 
and two alternative dissimilarity measurements were adopted 
to compare the iris images. Ma et al. [12] developed a bank of 
spatial filters with suitable kernels for iris recognition to 
capture local details of the iris pattern. The mean and the 
average absolute deviation of each block of the filtered images 
are calculated to generate 1536 feature components. Then a 
local intensity variation analysis method based on the 
Gaussian-Hermite moments [13] and a characterizing key local 
variations method using 1-D wavelet transform [14] are 
presented to extract the feature of the iris image. Yu et al. [15] 
utilized the multi-channel Gabor filters to extract the key 
points from the iris image and then computed the relative 
distances of these key points to represent the iris feature. 
In this paper, a particle swarm optimization (PSO) is 
proposed to design a bank of Gabor filters (PSOGF) with the 
optimal parameters; and further, a sequential scheme is 
developed to determine the number of filters. For the iris 
recognition, the optimized Gabor filters are used to extract the 
iris feature, and an effective feature encoding method is 
proposed to generate a compact iris code. Finally, the binary 
Hamming distance is utilized to measure the distance between 
a pair of iris feature vectors. Our experimental results show 
that the proposed iris recognition has an encouraging 
performance with a small length of the feature vector. 
The rest of this paper is organized as follows. In the 
Section II, we briefly review the Gabor filter and the PSO 
algorithm, and then present the PSOGF approach. The feature 
extraction, the encoding method, and the iris matching of the 
proposed iris recognition system are described in Section III. 
Experimental results and comparisons are reported in Section 
IV. Section V contains the conclusion of this paper. 
II. PARTICLE SWARM OPTIMIZED GABOR FILTER 
In this section, we briefly review the Gabor decomposition 
algorithm and the particle swarm optimization, and then 
present the proposed Gabor filter optimization approach with 
the PSO method to select the optimal parameters of the Gabor 
filter. 
 1
5) Repeat steps 2-4, until the termination conditions are 
satisfied. 
In our algorithm, the algorithm will be terminated when the 
EER corresponding to gbX  is equal to zero or the particles 
converged to the global best position, i.e., the average distance 
from gbX  to each particle is smaller than a specific threshold. 
D. Sequential PSOGF 
PSOGF has the ability to select a bank of optimal Gabor 
filters; however, the number of filters has to be assigned in 
advance. Since the accuracy and the information redundancy 
of a recognition system will be affected by the number of 
filters, a sequential PSOGF scheme is developed to solve this 
problem. Furthermore, the sequential PSOGF scheme limits 
the search dimension to four, as explained in the following, so 
that the PSOGF can be more effective. 
The concept of the sequential PSOGF is to obtain the 
Gabor filters one by one. When the k-th Gabor filter is being 
optimized, the (k-1) filters in the parameter queue obtained 
previously are fixed. That is, the basic PSOGF is repeatedly 
performed with single Gabor filter, so that the dimension of the 
search space of each PSOGF is equal to four. A position queue 
is used to store the final position of gbX  when each PSOGF 
terminated. The k Gabor filters composed of the position 
vector of each particle and (k-1) positions in the position queue 
are simultaneously used to extract the features of the training 
samples, and then the EER is evaluated as the fitness value. Let 
 be the vector of the position queue, the procedure of the 
sequential PSOGF algorithm is given as following: 
qX
1) Initialize the filter queue q = ∅X  and set the min  
to a large value. 
EER
2) Randomly initialize the 4-dimensional vectors of the 
position and the velocity of each particle. 
3) For the i-th particle with position ,  1,...,i i m= , the 
EER of the training set is computed with the bank of filters 
represented by the combination of the position queue and the 
position of the particle [ ], TT Tq iX . 
X
X X=
4) Update the local best position lbX  of each particle and 
the global best position gbX  of the swarm. 
5) Calculate the velocity vector and update the position of 
each particle according (5) and (4), respectively. 
6) Repeat steps 3-5, until the termination conditions of the 
PSOGF are satisfied, and then compute the EER ( GBEER ) for 
the global best position. 
7) If GBEER  is smaller than minEER , set minEER = GB  
and add the global best position into the position queue 
( [ ], TT TgbX ). Clear the convergent particle swarm and go 
to step 2. Otherwise the algorithm is terminated. 
EER
q q=X X
64 336
The first n Gabor filters in qX  with lowest EER indicate 
the best combination of the filters, and they are adopted to 
extract the features in our system. The sequential PSOGF 
strategy is able to decide the number of filters and to select a 
bank of Gabor filters with best parameters for a particular 
application. Furthermore, the low dimensional search space 
which requires fewer particles can reduce the search time and 
improve the convergence ability. 
III. IRIS RECOGNITION SYSTEM 
In this paper, we propose a novel iris recognition system 
that makes use of the sequential PSOGF and an efficient 
encoding scheme to extract the iris features. First, the iris 
image is located and unwrapped to a rectangular block of a 
fixed size. Then, the irrelevant part of the iris block is detected. 
Finally, Gabor filters are used to decompose the normalized 
iris block, and a relative variation analysis method is adopted 
to generate the iris code following the decomposition. 
A. Iris Image Preprocessing 
We adopt the similar idea of the iris localization method 
proposed by Wildes et al. [8] to detect and model the pupillary 
boundary and the limbic boundary. In this method, the 
parameters of the pupil and the limbus are obtained by using 
the Canny operator [19] and the Hough transform [20]. An 
example of iris localization is shown in Fig. 1(a) where the 
centers of pupil and limbus are marked with a white cross and 
a red circle, respectively. 
According to our observation, the upper part of the iris is 
more often occluded with a larger area by the eyelid and 
eyelashes. The serious destruction will decrease the 
recognition accuracy. In our system, we discard the upper part 
of the iris and unwrap the lower part of the iris image (between 
186o and 354o) to a rectangular block of ×  pixels by 
using the bicubic interpolation. The examples of the selected 
region of iris image and the unwrapped block are shown in Fig. 
1(a) and Fig. 1(b), respectively. 
The lower portion of the unwrapped iris image is 
sometimes occluded by the lower eyelid and/or eyelashes. In 
order to avoid the influence of the occlusion, such useless 
portion must be detected and masked out. The eyelid detection 
is performed by using the Canny edge detector and the curve 
fitting of a second-order polynomial. In addition, the 
unwrapped iris block is normalized to have zero mean and unit 
variance after the removal of the eyelid. The results of the 
occlusion removal and the iris normalization are shown in Fig. 
1(c) and Fig. 1(d), respectively. 
 
Figure 1.  Iris image preprocessing: (a) the detected iris boundaries and the 
selected iris region, (b) the unwrapped iris block, (c) the detected eyelid edge 
and the result of occlusion removal, and (d) the normalized iris image. 
B. Feature Extraction 
In our iris feature extraction, each normalized iris block is 
first decomposed into n filtered images with complex-value 
pixels by Gabor filters that are selected by sequential PSOGF, 
and then n component images can be obtained by computing 
 3
varies from one to twenty-six. In our experiments, four 
mislabeled iris images1 are discarded to simplify the analysis. 
In addition, if the number of samples in a class is less than four, 
the iris class will not be considered in the experiments. 
Therefore, totally 2578 iris images from 353 classes are 
adopted to evaluate our recognition system. 
B. Sequential PSOGF and Iris Verification 
In the iris verification, the receiver operating characteristic 
(ROC) curve that is a curve of FAR versus FRR is used to 
evaluate the performance of the proposed system. The FAR is 
the probability of accepting an imposter, and the FRR is the 
probability of rejecting a genuine user. The EER is a point of 
ROC curve where the FAR is equal to the FRR. The smaller 
EER indicates the better performance of a biometric 
verification system. 
In the training phase of the sequential PSOGF, first three 
iris data of each class in the CASIA-IrisV3-Interval database 
are selected as the training samples. We utilized 10 particles 
for each filter search stage, and the acceleration constants of 
the PSO algorithm in (5),  and , are both set to 2.05. The 
EERs of the training phase for different number of Gabor 
filters are shown in Fig. 3. The lowest EER corresponding to 
10 optimized filters is 3.56×10-5. 
1c 2c
 
Figure 3.  The EERs of the training and test stages versus the number of 
Gabor filters. 
In the test stage, the images of the CASIA-IrisV3-Interval 
database, excluding the training samples, are used to estimate 
the distance distributions by using 8 to 11 selected filters. For 
each combination of the filters, the total number of intra-class 
comparisons and that of inter-class comparisons are 3334 and 
1149587, respectively, and the test results are shown in Fig. 3. 
The best EER of all the iris samples is 0.032% when 10 Gabor 
filters selected by sequential PSOGF are employed to extract 
the iris features. In other words, our system utilizes only 
1600( ) bits to achieve an encouraging performance 
that is better than most of the existing methods. We will adopt 
10 Gabor filters optimized by sequential PSOGF to perform 
the following experiments. 
and eight orientations, i.e., 12, 18, and 24 filters. As shown in 
Fig. 4, the performance of the optimized Gabor filters is 
always better than that of the filter bank method. Furthermore, 
the proposed system using the fewer number of filters 
produces smaller size of the feature vector and requires less 
computation time. 
0
0.4
8 20 10= × ×
                                                          
For the comparison purpose, we implemented a traditional 
model of Gabor filters [22] with three frequencies and four, six, 
1 The file names of mislabeled images in the CASIA database and the 
indexes of selected iris classes in the UBIRIS database are available on 
http://nfslab.ee.nchu.edu.tw/iris_index.html. 
 
Figure 4.  The ROCs of the 12, 18, and 24 standard Gabor filters and the 
sequential PSOGF. 
As mentioned in Section III-A, the lower part of the iris 
image may be occluded by the eyelid. The occlusion may 
decrease the recognition accuracy due to the insufficient 
information. We carried out an additional experiment to 
evaluate the adverse effects of the occlusion. In the matching 
stage, the ratio ( effR ) of the number of effective elements E  
in (12) to the length of the feature vector can be computed. 
Then the intra-class or inter-class distance between a pair of 
iris image with an occluded ratio (1 effR− ) larger than the 
pre-selected rejection threshold RT  are discarded. When RT  
is set to be a smaller value, more distances will be rejected. 
Finally, the remainder distances are used to estimate the ROC 
curve. It is obvious in Fig. 5 that the system performances are 
improved by rejecting large occluded iris image. As shown in 
Table 1, the lowest EER of the CASIA database is 
substantially reduce to 6.10×10-6 when the distances between 
two different iris images with the ratio of the union occluded 
area is over 0.4 are rejected. 
 
 
Figure 5.  The ROC curves and the EERs with different rejection threshold. 
0.01
3 4 5 6 7 8 9 10 11
0
0.02
0.04
0.06
0.08
0.1
0.12
0.14
0.16
0.18
0.2
0.05999
0.06311
0.03212
0.05999
0.01131
0.00389
0.00356
0.00408
Number of Gabor filters
E
qu
al
 E
rr
or
 R
at
e 
(%
)
 
 
Training
Test
0.02 0.03 0.04 0.05 0.06 0.07 0.08 0.09 0.1
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
False Acceptance Rate (%)
F
al
se
 R
ej
ec
tio
n 
R
at
e 
(%
)
 
 
12 Gabot filters
18 Gabot filters
24 Gabot filters
Sequential PSOGF
0 0.02 0.04 0.06 0.08 0.1 0.12
0
0.02
0.04
0.06
0.08
0.1
0.12
False Acceptance Rate (%)
F
al
se
 R
ej
ec
tio
n 
R
at
e(
%
)
 
 
Non-rejection
T
R
 : 0.8
T
R
 : 0.6
T
R
 : 0.4
EER
 5
