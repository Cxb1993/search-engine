 
 
行政院國家科學委員會補助專題研究計畫成果進度報告 
多種類型影像認證技術之設計 
(The design of image authentication techniques for digital images) 
 
計畫編號：NSC 95-2221-E-126-008-MY2 
執行期間：95 年 8 月 1 日至 97 年 7 月 31 日 
計畫主持人：胡育誠 
計畫參與人員：林秉澄、潘星任、吳佑賢 
 
一、 中文摘要 
電腦軟硬體的快速發展使得數位影像
相關的資料大量的在網路上被傳遞，這樣
的狀況使得影像資料安全性保障的問題
越來越重要。舉例來說有版權的數位影像
資料很容易被複製，因為燒錄資料的軟硬
體設備日新月異。另外由於軟體的功能快
速發展，現今存在許多簡單易用的影像編
輯軟體，要竄改或是複製數位影像資料也
是相當容易達到的。 
對於一個合法購買者從網路或是一般
店面購買有版權的數位影像資料，當資料
取得後，他們如何知道這影像資料是來自
合法的管道，且確認這影像資料內容未被
修改過？若發現影像資料已經是經過竄
改後的結果，被破壞的影像資料如何回復
原來的資料內容？ 
一般而言，影像認證技術可以分成兩大
類：第一類的技術只能夠標示竄改區域，
也就是只能偵測被竄改的區域；而第二類
的技術不但能夠提供竄改區域的偵測，並
能夠進一步回復破壞區域。在這兩類的作
法中，針對只需能夠標示竄給區域的技
術，通常可以利用脆弱浮水印或是半脆弱
浮水印的使用即可達到。若要能夠達到進
一步重建被竄改區域的功能，通常需要透
過利用萃取影像的特徵值，然後利用數位
簽章技術來達成。 
 在本年度的計畫中，我們提出了一個
植基於漢明碼與小波轉換的灰階影像認證
技術。此技術會先將灰階影像利用離散小
波轉換處理後產生頻率域的係數。重要頻
帶的係數會進一歩運用漢明碼（Hamming 
Code）加以處理以產生影像的認證碼，用
於後續的竄改偵測與影像還原處理。產生
的認證碼是利用植基於模數函數之最不重
要 位 元 替 代 技 術 （ Modulus LSB 
Substitution）藏入到較不重要的小波係數
中，以減少影像藏入認證碼後的失真程
度。根據實驗結果我們發現，所提出的方
法不僅有不錯的藏入後影像品質，並可有
效的偵測出竄改區域，同時也可將遭受竄
改區域加以復原。 
 
Abstract 
As the fast development of the computer 
hardware and software, a great deal of 
image-related data is transmitted via 
Internet. The protection of image data 
becomes more and more important because 
it is easy to duplicate or modify digital 
images by image processing software. 
When one legal user buys authorized 
image data from the Internet or 
conventional stores, the content of the 
image data should be verified to ensure that 
no changes had been made. If the image is 
tampered, the detection of tampered areas 
證碼亦會連同被修改，導致認證能力受影
響。 
  （Wong et al, 1998）提出了公開鑰匙的浮
水印認證技術文獻 [16]，可偵測出影像的任
何異動，此技術可運用在醫療檔案的圖片、
商業圖片的處理、新聞報導的圖片…等，由
於此技術是公開的所以任何人都可以檢查
此訊息的完整性。而文獻 [17]由（Wong et al, 
2001）提出是運用私密鑰匙與公開鑰匙結合
的浮水印技術，當使用的私密鑰匙錯誤或者
該影像根本沒有藏入浮水印，又或者藏入的
浮水印遭受剪裁、切割。當遇到這些事件截
取出的浮水印將會是雜訊而無法認證此
圖。(Lin et al, 2005)提出文獻[12]利用區塊平
均值與子區塊平均值，產生出檢查碼與浮水
印 ， 埋 在 於 像 素 的 (Simple 
Least-significant-bit, LSB)位元，而驗證數位
影像與回復竄改區域的部份亦是利用了所
埋入的區塊平均值特徵。而文獻 [4]由
（Chang et al, 2006）提出了一套利用漢明碼
來驗證影像完整性。此技術主要是運用漢明
碼的方法來產生驗證影像時所需的認證
碼，當影像遭受竄改時，可使用漢明碼的檢
查碼可回復錯誤位元，而當超過容錯範圍則
可利用查表方式回復遭受竄改的影像區域。 
  而本年度的成果屬於浮水印認證技術的
類型，是利用離散小波轉換（Discrete 
Wavelet Transformation，DWT） [7] 的係數
特性，擷取出重要的頻帶搭配漢明碼
(Hamming Code)規則[13]，計算出檢查碼作
為認證碼，而埋入認證碼則透過機密鑰匙控
制藏入位置，採用植基於模數函數之最不重
要 位 元 替 代 技 術 （ Modulus LSB 
Substitution）  [2]藏匿於轉換後的小波係
數。本篇論文主要結構如下：第二章節的部
份會介紹本文所運用的相關技術，第三章節
會將本文所提出的浮水印技術詳細介紹，第
四章節則展示出與本文相關的實驗數據，最
終在第五章節的部份將探討結論。 
 
三、相關技術的探討 
3.1 離散小波轉換 
離散小波轉換（DWT）[7]，是一種將空
間域影像轉換為頻率域影像的方法，以一張
圖片為例子，經過小波轉換之後的取得的小
波係數，可分成低頻頻帶、中頻頻帶與高頻
頻帶，這三種頻帶，而相異的頻帶代表著不
同的重要性，根據這些資料的特性，將不同
的頻帶做不同的處理以達成我們所需要的
目的。 
一般而言，在低頻頻帶之中的係數為各個
像素的加總，小波係數變化量較少，所呈現
出來的影像比較平滑而且肉眼相較之下容
易辨識，如果再加上正規化的處理，位於低
頻頻帶的區域，會如同原使影像的縮圖，正
因如此只要我們稍微在低頻頻帶的像素動
一些修改，在眼睛的視覺馬上就會察覺出有
任何異樣，所以低頻頻帶是小波轉換之後比
較重要的頻帶；反之位於高頻頻帶的區域則
是像素之間的差異值，小波係數變化量較
大，所呈現出來的影像會比較複雜與模糊，
所以如果修改的像素位於高頻頻帶的話，肉
眼將不容易察覺，所以高頻頻帶是小波轉換
裡面屬於不比較重要的頻帶；中頻頻帶的重
要性介於高頻頻帶與低頻頻帶，在學術界上
絕大部分利用中頻頻帶來處理資訊隱藏，原
因很簡單，如果在低頻頻帶處理，很容易就
可以用肉眼就察覺出來有異樣，如果藏在不
容易察覺的高頻頻帶也是不妥當的，由於高
頻頻帶，在一些影像處理的技術上非常容易
遭受到修改，相對的會影響到機密資訊擷取
的正確性。 
離散小波轉換的技術發展至今，演變出很
多不同的種類，本研究方法裡面採用的是
Haar 的函數的離散小波轉換方式，在下文將
介紹 Haar 函數的原理與實做的方法。Haar
的函數是針對每一個相鄰的像素做處理，將
它分為水平、垂直相鄰像素值相加與水平、
垂直相鄰像素相減，相鄰像素相加該值會越
來越大，如果把他做正規化的處理，如同原
影像縮圖，所以每一個相鄰像素的垂直與水
平加總會存放在低頻頻帶，也就是重要的頻
帶；而相鄰像素的相減，在一張圖平滑的部
分像素值差異並不，所以相減之後的值並無
太大的變化，但如果是一張圖邊緣的部分，
     
 
 
（a）二階轉換         （b）三階轉換 
圖 3 Haar 函數的轉換結果 
 
3.2 漢明碼(Hamming Code) 
  漢明碼 [8] 是由貝爾實驗室的 R. W. 
Hamming 提出的錯誤更正碼，並且以他的
名字來命名。由於數位資料透過網路傳遞
時，可能導致封包遺失等錯誤，所以加一些
檢查碼，用來檢查資料在傳輸過程中，是否
發生錯誤。而時下最普遍的檢查碼有三種分
別為：同位元檢查（Parity Check）、循環冗
餘碼檢查（Cyclic Redundancy Code Check, 
CRC）、漢明碼（Hamming Code）。而本文
是套用漢明碼的技術，下文將詳述漢明碼的
相關運作流程。 
  漢明碼的檢查功能不僅具備檢查錯誤而
且還能錯誤更正，但更正錯誤位元數量是由
漢明碼的檢查的數量決定。而檢查碼的數量
是由欲檢查資料所決定，對於 M 位元的資
料，由公式 M ≦ 2n，K = n + 1 即可得知加
上 k 個檢查位元。舉例來講，如 4 位元資
料，則 4 ≦ 22，K = 2 + 1 = 3，檢查位元為 3 
位元。則漢明碼編碼為 M + K = 4 + 3 = 7 
位元。而在最簡單的漢明碼(7,4)中，每 4 個
資料位元後需加入 3 個檢查位元，而檢查位
元都是由這 4 個資料位元計算而得。當這 7
個位元中的任何一個有改變時，可使用一個
很簡單的計算方法來偵測錯誤並回復。 
  以實例來說明，我們設將 4 位元（D1=1、
D2=1、D3=0、D4=1）產生出 3 位元的檢查
碼，產生方式如圖 4 法， P1=( XOR (1、1、
1))=1，P2=( XOR（1、0、1）)=0，P3=( XOR
（1、0、1）)=0。 
 
  
圖 4 (7,4)漢明碼產生的方式 
 
  資料位元與檢查碼相關分類如圖 5，可看
出每一位元的檢查碼都與三個位元有相
關。假設此 7 位元中的 D4 錯誤，由原本 1
變更為 0 如圖 6，之後再利用（圖 4）方式
重新驗證檢查碼，P1=( XOR (1、1、0))=1，
P2=( XOR（1、0、0）)=0，P3=( XOR（1、
0、0）)=0，可以明顯的判斷出每一組驗證
都發現有錯誤，經過交叉比對即可以發現
D4 錯誤，並將其改正為正確位元即可。 
 
 
圖 5 (7,4)漢明碼資料與檢查碼關係圖 
 
圖 6 (7,4)漢明碼資料與檢查碼，當 D4 變更
為 0 
 
否則無法驗證此影像。緊接著採用植基於模
數函數之最不重要位元替代技術，別於傳統
的最簡單最不重要位元替代技術，此技術的
主要概念是將，欲埋藏的資訊利用模數的運
算藏入掩護係數的最不重要位元中，使得誤
差降至最低，並改善了簡單最不重要位元替
代技術所造成的失真問題。所以可確保平均
藏匿於三個頻帶的影像認證碼所造成的影
響影像品質將降至最低。 
以一回合小波轉換為例，會產生393216
位元的認證碼資料量，然而欲將認證碼平均
分攤至其餘三個頻帶，每一個頻帶的每一個
係數將會分攤2位元的認證資料。 
4.3 影像竄改偵測程序 
如需驗證影像完整性時，驗證者以相同程
序產生影像驗證碼 AC，之後再透過機密鑰
匙 k 取出埋才於欲認證影像的認證碼 AC1。
經過兩組認證碼的比對便可得知認證碼不
相吻合之處，之後再找尋到產生認證碼的小
波係數位置，即可察覺遭受竄改的像素。在
此同時必須注意到的一點是，本文是利用機
密鑰匙 k，將係數所產生出來的影像認證
碼，分別平均藏匿於其餘三個頻帶，所以假
使欲認證影像遭受區域性的竄改，則此區域
內的影像認證碼絕大部分分散於小波轉換
後的其餘三個頻帶。如此一來便可精準的找
尋到遭受竄改的區域，而竄改區域內所埋藏
的檢查碼亦會遭受到竄改，導致於影像會有
獨立點顯示出遭受竄改。為了改善這種明顯
的誤判，我們嘗試了許多方式來進行改善，
如侵蝕處理(Erosion)與擴張處理(Dilation)、
平滑化 (Smoothing)、中值濾波  (Median 
Filter)處理...等等。 
最後發現了獨立點與周圍像素的特性，所
以利用下述方式來消除獨立點，來實現我們
的目標。除邊界像素之外每一個像素都存在
著 8 個相鄰的像素，因此需檢查偵測出遭受
竄改像素，如果有一半以上的相鄰像素，為
正確無誤之像素，則視為獨立點並將此獨立
點消除。反之檢察無遭受竄改之像素，如果
有一半以上的相鄰酵素遭受竄改，則此像素
視為遭受竄改之像素。如此一來便可以消除
偵測過程所產生的獨立點，也可將偵測到的
篡改區域做補強，讓遭受改改區域內的小誤
判做更正。影像認證程序流程如（圖 8） 
正向小波
轉換
針對係數以
漢明碼規則
產生檢查碼
利用第機密鑰
匙找尋藏匿認
證碼順序
擷取出認
證碼AC1
埋入認證
碼影像
標示出遭受
竄改區域 消除雜訊
針對低頻頻
帶以正規化
模式處理
比對兩組
認證碼AC
與AC1
 
圖 8 影像認證程序流程圖 
4.4 影像回復程序 
在結束影像偵測程序中，已經可以確認影
像是否完整，然而遭受竄改的區域，本研究
嘗試將竄改區域以我們所埋入的認證碼資
訊加以回復。本文的影像回復可分為兩種，
由於認證碼採用的是（7,4） 漢明碼的檢查
碼，所以第一種方法是利用此技術特性可在
4 位元之中找尋到一個錯誤位元並加以回
復，而本文將小波係數化分為兩組（7,4） 漢
明碼換句話說，可偵測並回復各別一個位
元。 
第一種回復方法僅限於一組檢查碼只有
錯誤一個位元，並無法適用於區域性的篡
改。所以當本文偵測出竄改區域時，會採用
第二種的影像回復方式，欲將竄改像素回復
時會參考周圍未遭受竄改像素或者以回復
之像素，使用簡單的相鄰像素預測技術，預
測規則如公式 1。 
                                               
（1） 
在此公式 d 為將預測之像素，a 為相鄰
在左邊的像素，b 為相鄰在上方的像素，最
後 c 表示相鄰於左上方之像素，如此一來即
可推測此像素的像素值。再依照是否大於等
⎪⎩
⎪⎨
⎧
+
≤
≥
=
otherwise     
 ),min(   if    )max(
  ),max(   if     )min(
b-ca
a,bca,b
a,bca,b
d
正向轉換的影像品質平均，可發現平均
PSNR 值約在 40 dB 上下，而以此等級的影
像品質，肉眼是無法判斷此影像是否埋入影
像認證碼。 
 
表 2 藏入使用不同的 DWT 回合數 t 所產生
認證碼之影像品質 
 
（圖 11）為已經埋入認證碼的影像，可
以發現此影像與原始影像(圖 10-a) 並無太
大差異。因為本文使用的是藏匿在 LSB 部
分的技術，而且是效果最佳的植基於模數函
數之最不重要位元替代技術。（圖 12）針對
埋入認證碼之影像，進行不同程度的修改
（圖 12-a）在右上方多了一架飛碟不屬於原
圖的飛碟。則（圖 12-b）在機身部份多了一
個小圖案 
    在（圖 13）所顯示出的影像，乃是本
文未經過獨立點消除技術時所偵測竄改區
域的影像。可看出在大範圍修改的測試影像
(圖 13-a)，有非常多的獨立點，而在機身部
分作修改的影像(圖 13-b)，相較之下獨立點
數量降低很多。原因很簡單是由於埋藏於影
像之中的認證碼遭受到竄改所導致。而這些
遭受竄改的認證碼，是其它像素的認證碼，
一但遭受到竄改即會導致原先正確無誤的
像素被誤判為遭受竄改之像素。在大範圍的
影像遭受修改較多的認證碼，而只有在機身
修改的部份相較之下會出現較少的獨立
點。有鑒於此，本文提出的消除獨立點方
式，改善此缺點，而(圖 14)便是消除獨立點
之後的影像，如此一來可以精準的找到遭受
竄改的區域並加以後續處理。 
 
 
圖 11 藏入認證碼的 Airplane (PSNR=39.52) 
 
(a)大範圍修右上角加
入飛碟圖 
(b) 輕微修改機身部
位 
圖 12 遭受竄改的影像 Airplane 
 
(a)大範圍修改所產
生的獨立點 
(b)輕微修改所產生
的獨立點 
圖 13 因認證碼遭受修改所產生的誤判 
接下來的實驗是將遭受竄改區域加以回
復，在(圖 15)是本文回復影像技術的實驗結
果。(圖 15-a)回復區域為右上方出現不屬於
原圖的飛碟，在僅有的認證碼訊息之下，此
區域回復效果已經相當不錯，而(圖 15-b)回
復區域為機身之處，相同所呈現出的效果依
然不錯。本文的方法對於不同程度的修改影
像，皆能精準偵測並將竄改的區域影像加以
回復，而且經由肉眼觀察所回復影像，依然
有很不錯的品質。 
回合數 
影像 t = 1 t = 2 t = 3 
Airplane 39.52 45.557 51.545 
Baboon 40.565 46.591 52.48 
Goldhill 39.787 45.834 51.776 
Lenna 39.351 45.349 51.42 
平均 39.806 45.833 51.805 
