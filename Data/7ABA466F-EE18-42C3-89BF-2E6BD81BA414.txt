I 
 
摘要 
 台灣社會邁向老人化，慢性疾病不僅造成國人身心健康的威脅，對於醫療資
源支出也是個負擔。目前的醫學檢測，大都是在醫療院所完成，不但增加病患的
來回奔波，也浪費不少社會資源，因此，如何發展居家照護系統，提供更好的醫
療品質、降低社會成本及增加便利性，至為重要。本論文中之多訊息血氧量測系
統，可量測受測者的血氧濃度(SpO2)、心率(heart rate；HR)、呼吸率(respiratory rate)
以及動脈特性，對於提升居家醫療看護品質將有所助益。 
 本研究目的是減少護理人員負擔，使用方便、簡單、低成本的光電血管容積
(photoplethysmogram, PPG)信號來分析多樣生理訊息。本研究計畫三年的執行，
經由血氧濃度感測器和本實驗室自製的類比電路取得 PPG 信號，將紅光與紅外
光的直流與交流訊號分開，透過數位類比轉換器和 USB 進入以電腦為基礎的人
機介面處理平台，在軟體處理上做 PPG 信號即時顯示，並經過具動態計算的生
理參數演算法處理，可顯示包含血氧濃度(SpO2)、脈搏率(pulse rate；PR)、呼吸
率(respiratory rate)以及動脈特性等生理參數。 
 
關鍵詞: 光電血管容積圖(photoplethysmogram)、血氧濃度(SpO2)、脈搏率(pulse 
rate)、呼吸率(respiratory rate)。 
III 
 
 
目錄 
摘要.................................................................................................................................. I 
ABSTRACT ................................................................................................................... II 
目錄............................................................................................................................... III 
圖目錄........................................................................................................................... IV 
表目錄......................................................................................................................... VII 
一、 前言....................................................................................................................... 1 
二、 研究目的............................................................................................................... 1 
三、 文獻探討............................................................................................................... 2 
四、 研究方法............................................................................................................... 2 
4.1. 多訊息生理參數 ......................................................................................... 2 
4.2. 驗證系統 ..................................................................................................... 9 
4.3. 應用系統 ................................................................................................... 13 
五、 結果與討論......................................................................................................... 17 
5.1. 驗證系統 ................................................................................................... 17 
5.2. 應用系統 ................................................................................................... 19 
六、 計畫成果自評..................................................................................................... 38 
七、 研發成果發表..................................................................................................... 39 
八、 參考文獻............................................................................................................. 40 
 
V 
 
圖 25、二階主動低通濾波器 .................................................................................... 16 
圖 26、二階主動低通濾波器 .................................................................................... 16 
圖 27、多訊息生理參數系統流程圖 ........................................................................ 17 
圖 28、開始畫面 ........................................................................................................ 17 
圖 29、設定參數 ........................................................................................................ 18 
圖 30、驗證系統主畫面 ............................................................................................ 18 
圖 31、量測系統實體圖 ............................................................................................ 19 
圖 32、光接收電路訊號圖 ........................................................................................ 20 
圖 33、紅光與紅外光分光波形圖 ............................................................................ 20 
圖 34、紅光與紅外光波形圖 .................................................................................... 20 
圖 35、紅光、紅外光交流(AC)訊號圖 .................................................................... 21 
圖 36、紅光、紅外光直流(DC)訊號圖 .................................................................... 21 
圖 37、校正曲線圖 .................................................................................................... 22 
圖 38、SUBJECT1 血氧濃度量測比較圖 .................................................................... 23 
圖 39、SUBJECT 2 血氧濃度量測比較圖 ................................................................... 23 
圖 40、SUBJECT 3 血氧濃度量測比較圖 ................................................................... 24 
圖 41、SUBJECT 4 血氧濃度量測比較圖 ................................................................... 24 
圖 42、SUBJECT 5 血氧濃度量測比較圖 ................................................................... 24 
圖 43、SUBJECT 6 血氧濃度量測比較圖 ................................................................... 25 
圖 44、SUBJECT 7 血氧濃度量測比較圖 ................................................................... 25 
圖 45、SUBJECT 8 血氧濃度量測比較圖 ................................................................... 25 
圖 46、SUBJECT 9 血氧濃度量測比較圖 ................................................................... 26 
圖 47、應用系統的開始功能選單。 ........................................................................ 27 
圖 48、即時擷取人機介面 ........................................................................................ 28 
圖 49、多訊息分析系統人機介面 ............................................................................ 29 
圖 50、輸入受測者資訊畫面 .................................................................................... 30 
VII 
 
 
表目錄 
表 1、血氧模擬誤差比較表 ...................................................................................... 22 
表 2、血氧濃度誤差比較表 ...................................................................................... 26 
 
2 
 
 
三、文獻探討 
 經過去的文獻指出，Hertzman 和 Spielman 在 1937 年提出了關於光電血管容
積圖(photoplethysmogram，PPG)的觀念[1]，首次使用光學方法量測血液體積變
化量。1939 年，Burtion 計算出血管徑的連續變化波形，發現手指的血液體積收
縮壓與脈搏與交感神經系統呈現高度相關[2]。1994 年 Nitzan 利用 PPG 實現了直
接量測末稍循環系統變異，他利用指尖所量得之 PPG 信號，定義出振幅
(Amplitude，AM)以及基線(Baseline，BL)兩個主要參數，並證實了 PPG 信號與
HRV 有相同之頻譜區段分佈[3]。1996 年 Task Force 確定了 PPG 訊號與心率同步
[4]，K.Nakajima 也提出 PPG 訊號中隱含有心跳的訊息，可以藉此找出心率[5]。
由於 PPG 訊號可提取出心率，利用 PPG 做心率變異性分析也是很有可能的。1996
年 K.Nakajima 及 1999 年 A.Johansson 分別提出，PPG 訊號中隱含了呼吸引起的
強度變化資訊[5][6][7]，呼吸作用會影響靜脈血液回流到右心房時的血液體積變
化，這個調節作用借由靜脈系統傳遞到外周血管床，並且可在 PPG 訊號中觀察
到，藉此找到呼吸訊號。2002 年 Millasseau et al.提出了血管硬化指標與脈搏反射
指標兩項生理參數[8]。Lass et al.、Chua and Heneghan、Zheng and Zhang，分別
在 2004、2006、2003 年都提出了各自定義的脈波傳遞時間[9][10][11]，可觀察血
管的順應性與老化程度。2002、2005 年 Loukogeorgakis 及 Allen et al.也發表了關
於波前進速度的研究[12][13]。 
 
四、研究方法 
 經過三年的研究發展可分為兩版本，兩版本相異處在於硬體架設不同造成分
析軟體些微差異。舊版為第一年所研究作為驗證之程式，新版本為第二年與第三
年所研究之程式及其應用系統。其章節表達順序為多訊息生理參數、驗證系統和
應用系統。 
 
4.1.多訊息生理參數 
 在研究使用了生理參數包含有血氧濃度 SpO2、脈搏率(Pulse rate)、呼吸率
(respiratory rate)、血管灌流指標(perfusion index)、血管硬化指標(stiffness index)、
脈搏反射指標(reflection index)、脈波傳遞時間(pulse transit time；PTT)及脈波速
率(pulse wave velocity；PWV)，在演算法的部分已經完成這些生理參數的計算，
對於健康的受測者取得的 PPG 信號均可有效的計算出這些生理參數。 
 
4.1.1.血氧濃度 
 血氧濃度的量測，是在微處理機中重組數位化後紅光和紅外光 PPG 波形的
直流(DC)和交流(AC)成份(如圖 1 所示)，藉由鄰近峰值偵測法(neighboring peak 
searching)找出 PPG 的波峰(peak)以及相對的波谷(valley)，由於帶氧血紅素
(oxyhemoglobin；HbO2)和不帶氧血紅素(hemoglobin；Hb)對不同波長的光吸收係
4 
 
 
4.1.2.脈搏率 
 PPG 信號是偵測血流的變化，而心臟影響輸出血流形成脈搏，進而影響 PPG
波形。因此利用此關係，根據 PPG 的峰值間距(PPI)計算脈搏率(pulse rate)如下： 
  
BPM) minute;per (beat   
sec)(unit  
60
PPI
PRPPG       (3) 
脈搏率的計算步驟如圖 4 所示。 
 
記錄兩峰
值時間
代入換算公式計算PPI END
 
圖 4、脈搏率計算方塊圖 
 
4.1.3.呼吸率 
 經由第一年 Bivariate AR model 已驗證 PPG 中含有呼吸成分 [15]。因此本年
度將單變量自迴規模型(univariate AR model)和自迴歸分解(AR decomposition) 
[16]得到呼吸率，步驟如圖 5 所示。 
重新取樣
10Hz
Z-plane
找呼吸率
頻譜分析
AR model
END
 
圖 5、呼吸率演算方塊圖 
 
4.1.4.灌流指標 
 灌流指標 (perfusion index, PI) 是脈搏的 PPG 振幅 (amplitude, AM) 與直流
成分 (DC component) 的比值百分比。末梢灌流指標 (peripheral perfusion index, 
PPI) 反映出末梢血液流量的變化，可以用在預測動脈微循環時所引起的心搏量
變化，但 PPI 的變化會受到量測位置與受測者生理狀況的影響[17]。 
 PPG 量測採用在組織裡的光吸收量，波形如圖 6 所示。其特徵為振幅與直
流成分。直流成分 (如皮膚，靜脈血管等) 與心舒張末期血液在生理組織中搏動
的最小體積有關，振幅是與血管的順應性有關。其物理意義上，在組織中的所有
切面的血液容積的變化會正比於直流成分，因為較高的光吸收量相對於較多的血
液容積；其振幅為動脈壁的順應性，正比於組織血液搏動量的改變。 
        (4) 
6 
 
 
Δt
DWAM
 
(a) (b) 
圖 7、PPG (a) 在手指量測與脈搏反射[18] (b)特徵擷取示意圖 
 其中取得重搏波(dicrotic wave)方式參考 Millasseau 等學者發表的論文[18]，
因為重搏波並非很明顯，於是將重搏波擷取的部分分成兩種情況，如圖 8 所示，
(a)有明顯 D 波；(b)為 D 波不明顯。方法是首先將原始信號作一次微分，當波形
6為(a)時，重搏波位置會在一次微分信號為零的地方；當波形為(b)時，重搏波位
置則在一次微分信號最接近零的地方。 
 
(a)        (b) 
圖 8、重搏波特徵擷取(a)微分有過零(b)微分後最接近零 
P峰之後取
0.4秒
帶入公式計算
微分找取重
搏波
END
 
圖 9、RI 與 SI 演算方塊圖 
 
8 
 
其中 ，定義(B)中的上升時最大斜率需借由
微分來找尋。將 VP 訊號微分，取微分值最大那點就是 VP 訊號最大斜率值，分
別找出各三種定義的結束點後，即可計算出從 R 峰到各個點得時間，即可求出
PTT 值。 
START
從RP之間找出
區域最小值即
為V點
ECG
PPG
計算出PTT
使用何種定
義?
計算VP的二分
之一
取出VP線段並
微分
找出斜率最大
的點
計算VP
定義A 定義C
定義B
D值
計算出PWV
END
 
圖 12、PTT 與 PWV 計算流程圖 
10 
 
圖 14 為 MP30 之背面圖，分為三部份： 
1. Power input port from DC adapter：直流電源輸入； 
2. ON/Off switch：電源開關； 
3. Serial cable jack：輸出端，可以轉換成 USB 規格。 
 
4.2.2.感測器規格 
圖 15 為 ECG 量測感測器和規格，紅線為正極，白線為負極，黑線為接地。 
 
圖 15、ECG 量測 sensor 與其規格[19] 
圖 16 為 PPG 量測感測器與規格，還有末梢量測位置。 
 
圖 16、PPG 的量測 sensor[19] 
12 
 
 
4.2.3.程式架構 
圖 18 為程式流程圖。 
是否執行程式
(圖3.6)
經由Pan-
Tompkins找出
ECG的R峰
借由R峰找出
PPG的波峰P即
峰谷V
計算出RRI與
PPI
從P峰取出100
點訊號
取出R-峰訊號
進入呼吸率計
算流程
(圖2.11)
經由LabVIEW
虛擬儀表顯示
結果
START
是
否
輸入參數
(圖3.7)
確定
取消
帶入公式計算
出心跳與脈搏
(圖2.9)
進入SI、RI計
算流程
(圖2.17)
進入PTT與
PWV計算流程
(圖2.24)
更改參數
END
 
圖 18、驗證系統程式流程圖 
 
14 
 
 本研究光感測器探頭部分採用尼爾可(Nellcor)公司的Durasensor DS-100A手
指頭探頭(finger probe)，包含了光源和光接收器。光源部分又包含紅光和紅外光
的發光二極體，其發光光譜分別在 660nm 和 940nm 之波長。而光接收器的部分
為一光二極體，其作用是將所接收到的光轉換成電訊號。在血氧的檢測需要用到
紅光、紅外光兩種光源感測，為了不造成兩種光電信號的混疊，必頇採用兩光交
替發射的方法，所以我們需要控制 LED 產生交互明滅的電路，在本研究中我們
利用微控制器產生四個控制時序，分別依序為時序 1、時序 2、時序 3 及時序 4，
其作用如圖 21 所示，由此圖可知，紅光和紅外光的脈波頻率都是 100 Hz。 
 
時序1:
紅光_High、
紅外光_Low
時序2:
紅光_Low、
紅外光_Low
時序3:
紅光_Low、
紅外光_High
時序4:
紅光_Low、
紅外光_Low
紅外光
紅光
時序1:
紅光_High、
紅外光_Low
時序2:
紅光_Low、
紅外光_Low
時序3:
紅光_Low、
紅外光_High
時序4:
紅光_Low、
紅外光_Low
2.5ms 2.5ms 2.5ms 2.5ms 2.5ms 2.5ms 2.5ms 2.5ms
 
圖 21、LED 發光時序圖 
 參閱圖 20，當控制訊號 IR_CLK 為高電位且 R_CLK 為低電位時，IR_LED
將發光，此時 R_LED 不發光，驅動電流大小由電晶體之射極電阻決定。相反的，
紅光的發射驅動原理亦然。再以類比解多工將紅光和紅外光訊號分開。 
 本研究的前置電路部分由於光二極體接收到的 PPG 訊號(約 0.2~10 Hz)是一
個載在直流(DC)成份上的微弱交流(AC)信號，為了避免在放大此微弱交流(AC)
信號時，也將直流(DC)成份一併放大，超出了放大器的線性範圍，造成信號的飽
和，所以設計兩組相同的濾波電路，低通濾波(low-pass filter；LPF)電路取出直
流(DC)訊號，帶通濾波(band-pass filter；BPF)電路則取出交流(AC)訊號。濾波電
路系統架構如圖 22 所示。 
multiplexer
BPF；0.2Hz~18Hz
LPF；0.2Hz
Amplifier
BPF；0.2Hz~18Hz
LPF；0.2Hz
Amplifier
LPF；5Hz
LPF；5Hz
DAQ card
IR
R
IR_AC
IR_DC
R_AC
R_DC
IR、R
 
圖 22、濾波電路系統架構圖 
16 
 
樣的帶通範圍經過後級放大後會有 10Hz 的雜訊耦合，這樣的訊號進入微控制器
作運算時會有運算結果不穩定的情況，因此在後級放大之後經過電壓隨耦器再設
計一個截止頻率 fc 為 5Hz 的二階主動低通濾波電路，實際電路圖為圖 26 所式，
電壓增益為 1，當高頻訊號經過時會以 40dB/decade 的速度衰減。當訊號經過帶
通濾波電路，濾波範圍介於 0.2Hz~5Hz 即可得到訊號的直流(AC)成分。 
v
-VCC
VCC
-
+
27k 200k
470n
100n
1C
2C
1R 2R
 
圖 25、二階主動低通濾波器 
v
-VCC
VCC
-
+
15k 150k
150n
220n
1C
2C
1R 2R
 
圖 26、二階主動低通濾波器 
 本研究資料擷取部分用類比數位轉換卡，採用美商國家儀器公司推出的擷取
卡 USB-6009，負責信號之擷取，將類比信號轉成成數位信號，再經由 USB 介面
傳送資料給電腦，其規格具有 14 bits、48kS/s 取樣率、4 個類比差動輸入，已符
合本研究的信號量測需求。 
 
18 
 
接著會跳出設定參數的畫面(如圖 29)，要求使用者輸入身高、取樣頻率、以及
距離 D(心臟到探測器的距離)，確定按下 OK 後即會跳轉置主程式；若按 Cancel
則結束程式。 
 
圖 29、設定參數 
輸入完成後就會跳到主畫面(如圖 30)，其中按鈕有五個：定義 A、定義 B、定義
C，按下後就可顯示不同定義之 PTT 與 PWV 之結果；按下調整後，即可返回設
定參數的畫面(圖 29)，重新設定參數；最後一個按鈕是 EXIT，按下後結束程式。 
 
圖 30、驗證系統主畫面 
20 
 
IR Red
 
圖 32、光接收電路訊號圖 
 經過解多工器，將光感測器接收到的紅光與紅外光混疊訊號分開，再經由
RC 組成的取樣保持電路，如圖 33 所示，若將時間軸乘上 20 倍可以將可以觀察
出微小的紅光與紅外光訊號波形，如圖 34 所示。 
 
圖 33、紅光與紅外光分光波形圖 
 
圖 34、紅光與紅外光波形圖 
22 
 
 
圖 37、校正曲線圖 
表 1、血氧模擬誤差比較表 
SpO2(%) max. error(%) mean±SD 
100 2 1.79±0.14 
99 1.3 1.17±0.17 
98 2.7 0.25±0.23 
97 1.1 0.76±0.18 
96 1.7 0.78±0.17 
95 1.5 0.77±0.13 
94 2 0.71±0.1 
93 1.3 0.65±0.24 
92 1.2 0.7±0.28 
91 1.7 0.66±0.16 
90 1.7 1.4±0.51 
89 1.2 1.4±0.4 
88 1.2 1.3±0.51 
 
24 
 
 
圖 40、subject 3 血氧濃度量測比較圖 
 
圖 41、subject 4 血氧濃度量測比較圖  
 
圖 42、subject 5 血氧濃度量測比較圖 
26 
 
 
圖 46、subject 9 血氧濃度量測比較圖 
本系統經由校正取線計算後與MP150多通道生理量測儀器做同步量測，以
MP150量測的訊號為參考值進行誤差比較，由最大誤差、平均值誤差探討本系統
的性能。最大誤差表示本系統經由受測者實驗後，與標準值最大的誤差值。平均
值誤差，表示此量測系統的平均誤差範圍，如表 2所示。 
表 2、血氧濃度誤差比較表 
subject max. error(%) mean±SD 
subject1 1 0.4±0.37 
subject2 2 0.44±0.38 
subject3 2 0.56±0.37 
subject4 1 0.55±0.29 
subject5 1 0.58±0.49 
subject6 2 1±0.45 
subject7 2 0.55±0.42 
subject8 2 0.66±0.2 
subject9 1 0.8±0.3 
 
28 
 
 
 即時分析人機介面執行時，可即時演算參數號，並同時顯示訊號，開始畫面
如圖 48，即時擷取系統主要訊號由上而下為 PPG、SpO2 (血氧濃度)、PR (Pulse 
Rate)、RR (Respiratory Rate)、RI (Reflection Index)與 PI (Perfusion Index)。 
 
圖 48、即時擷取人機介面 
30 
 
  
圖 50、輸入受測者資訊畫面 
32 
 
 
圖 52、血氧濃度畫面 
34 
 
 
圖 54、硬化指標畫面 
36 
 
 
圖 56、灌流指標畫面 
38 
 
 
圖 58、生理參數輸出 Excel 表格 
 
 
六、計畫成果自評 
 在臨床診斷心血管疾病所採用侵入式量測，其風險是不可避免的，有鑑於
此，本計畫採用多光源 PPG 量測，以及分析出多訊息生理參數，對於心血管功
能評估可作為重要的研究。 
 本計畫第一年驗證了心跳與脈搏的相關性，由實驗結果可以證明兩者間存在
的正相關性。以及呼吸率的擷取分析，由實驗結果證明 PPG 與呼吸信號具有很
高的相關性。以這樣的結果可以提供 PPG 分析出脈搏率與呼吸率的可行性。主
要的生理參數有心率(脈搏率)、呼吸率、硬化指標、反射治標及脈搏傳輸速率。 
 本計畫第二年實作出一人機介面可以在電腦系統下做分析，硬體前端是兩光
源的 PPG 感測模組，經由擷取資料卡製作軟體的分析系統。主要的生理參數有
脈搏率、呼吸率及血氧濃度。 
 本計畫第三年總結前兩年的結果並加入多訊息分析參數的目標，除了上述的
生理參數外，還加入灌流指標，並整合一、二年的分析系統，製作出多訊息生理
參數介面，並把分析系統獨立成一套軟體。 
 總結本計畫三年成果，主要項目有(1)利用同步量測 PPG、ECG 與呼吸驗證
相關性，提出 PPG 分析呼吸與脈搏方法。(2)兩光源 PPG 感測電路硬體製作完成。
(3)軟體系統可獨立安裝在電腦裡，使人機介面系統更加完善。(4)可從 PPG 信號
40 
 
八、參考文獻 
[1] Hertzman, A. B. and Spielman, C. R., "Observations on the finger volume pulse 
recorded photoelectrically", Am. J. Physiol., 1937, vol.119, pp.334-5. 
[2] Burton A. C., “The range and variability of the blood flow in the human fingers 
and the vasomotor regulation by body temperature ”, American Physiological 
Society, 1939, vol.127, pp.473-453. 
[3] Nitzan, M., deBoer, H., Turivnenko, S., Babchenko, A., andSapoznikov, D., 
“Power spectrum analysis of the spontaneous fluctuations in the 
photoplethysmographic signal”, J. Basic Clin. Physiol. Pharmacol., 1994, vol5, 
pp.269–276. 
[4] Task Force of The European Society of Cardiology and The North American 
Society of Pacing and Electrophysiology, "Heart rate variability. Standards of 
measurement, physiological interpretation, and clinical use", Circulation, 1996, 
vol.93, pp.1043-1065. 
[5] Nakajima, K., Tamura, T. and Miike, H., "Monitoring of heart and respiratory 
rates by photoplethysmography using a digital filtering technique", Med. Eng. 
Phys., 1996, vol.18, no.5, pp.365-372.  
[6] Johansson A., and Őberg P. Ǎ., “Estimation of respiratory volumes from the 
photoplethysmographic signal. Part 2：a model study”, Medical & Biological 
Engineering & Computing, vol.37, pp. 48-53,1999. 
[7] Johansson A., "Estimation of respiratory volumes from the 
photoplethysmographic signal. Part 1：experimental result", Medical & Biological 
Engineering & Computing, 1999, vol.37, pp.44-47 
[8] Millasseau, S. C., Kelly, R. P., Ritter, J. M. and Chowienczyk, P. J., 
"Determination of age-related increases in large artery stiffness by digital pulse 
contour analysis", Clin. Sci., 2002, vol.103, pp.371-377. 
[9] Lass, J., Meigas, K., Karai, D., Kattai, R., Kaik, J. and Rossmann, M., 
"Continuous blood pressure monitoring during exercise using pulse wave transit 
time measurement", Proc. 26th Annual Int. Conf. IEEE EMBS, San Francisco, 
CA, USA, 2004, pp.2239-2242. 
[10] Chua, C. P. and Heneghan, C., "Continuous blood pressure monitoring using 
ECG and finger ", Proc. 28
th
 Annual Int. Conf. IEEE EMBS, New York, USA, 
2006, pp.5117-5120. 
[11] Zheng, D. C. and Zhang, Y. T., "A ring-type device for the noninvasive 
measurement of arterial blood pressure", Proc. 25th Annual Int. Conf. IEEE 
EMBS, Cancun, Mexico, 2003, pp.3184-3187. 
[12] Loukogeorgakis, S., Dawson, R., Phillips, N., Martyn, C. N. and Greenwald, S. 
E., "Validation of a device to measure arterial pulse wave velocity by a 
可供推廣之研發成果資料表 
█ 可申請專利  □ 可技術移轉                                 日期：100 年 10 月 14日 
國科會補助計畫 
計畫名稱：以多波長 PPG 實現多訊息生理參數量測 
計畫主持人：林育德 
計畫編號： NSC 97-2221-E-035-001-MY3 學門領域：醫用電子 
技術/創作名稱 PPG 之多訊息生理參數量測。 
發明人/創作人 林育德 
技術說明 
中文：光體積變化描計圖（photoplethysmography; PPG）的量測具
有容易架設、使用簡便以及價格低廉等優點，由文獻的探討得知，
PPG 信號隱含豐富的生理訊息，包含心率（heart rate; HR）、呼吸
速率（respiratory rate）、脈波傳遞時間（pulse transit time; PTT）、
脈波速率（pulse wave velocity; PWV）、血管硬化指標（stiffness 
index; SI）以及脈搏反射指標（reflection index; RI），而這些都是
心血管系統和臨床上相當重要的生理參數。截至目前為止，現有的
PPG 相關設備仍沒有辦法達到這種多樣性的要求，如果能夠從 PPG
信號中同時取得這些生理上的重要指標，將有極高的臨床價值，在
醫療儀器的市場上也會有相當大的競爭優勢。本計畫之執行成果已
有初步成果，除了可發表學術論文之外，亦具有申請專利的價值。 
英文：The photoplethysmography (PPG) measurement possesses the 
advantages such as easy setup, simple use and low cost. From the 
literatures reported, important physiological parameters that can be 
extracted from PPG signals include heart rate, respiratory rate, pulse 
transit time (PTT), pulse wave velocity (PWV), arterial stiffness index 
(SI) and the reflection index (RI) of pulse wave. These physiological 
parameters are all important in cardiovascular physiology and clinical 
medicine. To our best knowledge, no existing technology has been 
proposed to measure these parameters simultaneously in one device. It 
will be highly potential and valuable to integrate the measures 
mentioned above in one device via mere PPG technology. Primary 
results have been derived from the second-year execution of this 
project. In addition to the publication of the academic paper, the results 
are also evaluated to be highly potential to apply for a patent. 
可利用之產業 
及 
可開發之產品 
醫療器材、居家照護等相關產業。 
技術特點 
使用方便量測的 PPG 信號取得多種生理參數。 
推廣及運用的價值 
可應用於老齡化社會與慢性病患者之居家照護，亦可與 3C 資電產
品或車用電子結合，做為增加其附加價值的裝置。 
 
附件二 
  
International Journal Conference on Engineering and Technology (CET 2011)等四個國際研
討會所組成的聯合研討會。這次的應用計算機、計算機科學、計算機工程國際會議，
總共收到約300篇論文，其中只有95篇被接受在研討會中報告，並收錄在大會論文集之
中，其論文之接受率約30%左右。該國際研討會的論文將可在Index to Scientific & 
Technical Proceedings (ISTP)和Engineering Index（Compendex）搜尋到，其中該會議
2009年及2010年的論文已被ISTP檢索，檢索率100%，2009年的論文已被EI檢索，是水
準不錯的研討會。本人全程參與本會議所有的議程，另外也帶回本會議的論文集2011 
3
rd
 World Congress in Applied Computing,Computer Science, and Computer Engineering 
(ACC 2011) CD ROM，裏面包含所有這次會議的論文全文。 
本次會議邀請一位來自香港中文大學機械與自動化工程學系的Jun Wang 教授來演
講，王教授目前主要的研究包含神經網路及其相關應用，也在此領域中發表了140篇期
刊論文，同時也是IEEE在系統、人類、網絡化等業務的副主編，經歷相當豐富，本人
聆聽教授的英文演講雖然有些吃力，但由於教授準備的資料相當完整，因此本人在此
次的演講中也有所收穫，並對神經網路有初步認知，真是一場精采的演講。 
 
教授演講完後接連就是與會學者的專題演講，演講者大部分都來自中國大陸及香港
地區的學者，包括教授及博士研究員，藉此可了解對岸的研究情況及程度，也提高本
人國際學術的見識，重要的是從中可學習對岸研究的優點，並針對可精進之處予以探
討及突破，對我們的研究將有所幫助。 
  
搭配針對前述的偵測機制做選擇性濾波，故採用此方法可以避免傳統60Hz濾波器對於
無電源干擾之生理信號(如：ECG)也一併地進行濾波，導致失去原有特定的生理特徵。 
 
我們覺得這次的研討會是一個很精緻的小型研討會，參加這個研討會，讓我們有一
些新的想法，覺得相當值得。或許是因為這個研討會才舉辦第三屆，這次研討會我們
並無遇到台灣學者，希望在未來台灣能有更多人知道並參與這個研討會。 
 
Methods 
1. Modulation technique  
For transmitting the biopotential signals through the MIC port, the modulation technique is 
needed. We use the amplitude modulation (AM) technique to shift the frequency characteristics of 
ECG to fit the frequency response of MIC port. 
Assuming that the original signal x0(t) is a pure sinusoid with frequency fx and phase θx, and the 
carrier frequency fc is much higher than fx. The modulated signal s(t) is that signal x0(t) modulated 
by the carrier c(t), and can be expressed by 
   )2cos()2cos(
)()(
)(
0
ccxx tftf
tctx
ts
 

.
 (1) 
And the modulated signal is derived as 
     )(2cos
2
1
)(2cos
2
1
cxxccxxc tfftff  
.
 (2) 
The amplitude modulation process has shifted the frequency component from fx to much higher 
fc+fx and fc-fx. Similar concept can also be applied to any wide-band signal such as ECG. 
By amplitude modulation, the ECG signal is shifted upward to the vicinity of the frequency such 
that the ECG signal can be transmitted into computer via the MIC port. In this study, the carrier 
frequency is 1k Hz, which is higher than the upper frequency range of ECG signal, 250 Hz.  
To realize the modulation technique in hardware, we used the commercially available multiplier 
chip, AD633, and the function generator chip, ICL8038, for the carrier. AD633 is a convenient chip 
in AM field because the modulated signal can be obtained by easily wiring. On the other hand, 
ICL8038 can generate three kinds of simple waveform, and also the frequency and duty cycle can 
be easily selected. We use LabVIEW 8.2
®
 (National Instrumentation Co.) to develop a user-friendly 
package to acquire the modulated ECG from the microphone port of the laptop (ASUS W7K laptop, 
1.73 GHz clock). The acquired data were saved as the sound wave file type (.wav). The frontal 
control panel for modulation signal is shown in Fig. 2. The file path and sample time are selective in 
this program. 
 
Fig. 2 The frontal control panel for modulation signal 
 
Fig. 3 demonstrates the waveforms and the corresponding spectrum of raw ECG and modulated 
  
DAQ measurement ECG Demodulation ECG 
Fig. 5 The waveform of raw ECG and demodulation ECG with Full-wave rectification method 
 
3. Comparison between RRIraw and RRIdem on HRV analysis 
Bland and Altman [2] presented a statistical method to assess the degree of agreement between 
two clinical measurement methods. Fig. 6 demonstrates the scatter plot of one practical example for 
the agreement comparison between RRIraw and RRIdem, in which the limits of agreement with their 
corresponding 95% C.I. are also demonstrated. 
S2
S1
0
1
2
-1
-2
70 80 90 100
Average value by two measurements
Difference of the two measurements
Sd 2
d
Sd 2







n
StSd
232







n
StSd
232
 
Fig. 6 The scatter plot of the difference against the average value with the limits of the agreement 
and the 95% C.I. being demonstrated 
 
In order to assess if the proposed ECG measurement is reliable in HRV analysis, the ECGraw and 
ECGdem were acquired via data acquisition card (DAQ, National Instrumentation PCI6024E) and 
MIC port simultaneously by the same ECG amplifier. The RRIraw and RRIdem sequences were 
extracted by Pan-Tompkins QRS detection algorithm [3]. The experimental design for agreement 
analysis between RRIraw and RRIdem is depicted in Fig. 7. 
ECG
Amplifier
Amplitude
Modulation
MIC
Port
Demodulation
NI-DAQ ECGraw
ECGdem
 
Fig. 7 The experimental design for agreement analysis between RRIraw and RRIdem 
 
Summary 
In order to transmit ECG signal via microphone port, the modulation-demodulation technique is 
utilized. Although the morphological occurred after demodulation (as shown in Fig. 5), the result of 
statistical method indicates the ECG signal obtained by the proposed methodology is reliable for 
HRV analysis. 
The last but not least is that the microphone port is in almost all the IT products, so this technic is 
useful while adding the biosignals into the IT products. It would be more convenient to acquire the 
biosignals via the MIC port without the need of A/D card. 
References 
[1] Akselrod, S., D. Gordon, F.A. Ubel, D.C. Shannon, A. C. Barger, and R. J. Cohen. Power 
spectrum analysis of heart rate fluctuations: a quantitative probe of beat-to-beat cardiovascular 
control. Science Wash. DC. 213, pp. 220-222, 1981. 
[2] J.N. Bland, D.G. Altman. Statistical Methods for Assessing Agreement Between Two Methods 
of Clinical Measurement. Lancet, pp.307-310. 1986. 
[3] J. Pan and W. J. Tompkins., A Real-time QRS Detection Algorithm. IEEE Transactions on 
Biomedical Engineering, BME-32 (3), pp.230-236, 1985. 
Acknowledgement 
The authors wish to express their gratitude to National Science Council (NSC 
97-2221-E-035-001-MY3) and Ministry of Economic Affairs (99-EC-17-A-19-S1-163), Taiwan for 
the financial support on this research. 
  
signal. The results may provide another attractive approach to 
acquire the respiratory information from PPG without the need 
of filtering, in which case the raw PPG signal can be processed 
for further applications. 
II. METHODS AND MATERIALS 
A. Subjects and Experiments  
Ten healthy subjects (eight males and two females, 
non-smoker and with no prior history of cardiovascular disease) 
aged between 22 and 24 took part in the experiments after 
giving the informed consent. All subjects were asked to refrain 
from caffeine and alcoholic drink at least 4 hours before the 
experiments. All of the experiments were performed at the 
same university laboratory with the room temperature being 
maintained at about 25 degrees centigrade during the night time 
(from 9 to 11 pm). The subjects were required to have a resting 
period of at least 5 minutes under relaxation status before the 
experiment.  
Each experiment included three stages classified by different 
respiratory rate (20 breaths/min, 12 breaths/min and holding 
the breath in order). Each stage was maintained at least one 
minute, and the intervals between stages were 5 minutes. 
Throughout the experiment, the subjects were seated in a 
comfortable chair with their right upper arm kept at the height 
of heart level. The breathing rate is controlled by the subjects 
with a clock for their timing reference. The breathing rate is not 
easy to fix at a constant, but it is controlled to an acceptable 
precision during the whole experiment. 
B. Signal Measurement and Signal Analysis 
The Multifunctional physiological data acquisition system 
MP30® (Biopac  Inc.) was utilized for signal measurement. 
PPG signal (by module SS4LA, with 66.5-Hz lowpass filtering) 
and respiratory signal (by module SS6L, also with 66.5-Hz 
lowpass filtering) were collected simultaneously during each 
experimental stage. The PPG probe (SS4LA, with infrared 
wavelength 860 nm) was attached to the right index finger, 
whereas the respiratory signal was acquired by fast response 
thermistor (SS6L) and was put at the nostril during the 
measurement. The user friendly analysis package Biopac 
Student Lab® was used for the signal management, including 
the signal quality pre-screening, data storage and retrieval. The 
sampling frequency was 250 Hz. The signals were verified 
visually by a well-trained technician. A typical respiratory 
signal and PPG signal are shown in Fig. 1. If the signal quality 
was poor, the signal would be excluded from further analysis 
and the subject was asked to repeat the experiment once again.  
C. Signal Analysis 
The analysis was executed after the experiments were 
finished and approved. The source code for bivariate AR 
spectral estimation was developed in MATLAB® (MathWorks 
Inc.). The estimation method was originally developed by Morf 
et al. [10]. It is an expansion of single-channel Levinson recur- 
 
 
(a) 
 
(b) 
Fig. 1 Typical signals: (a) respiratory signal (12 breaths/min), (b) PPG 
signal. 
 
sion algorithm [12], and is briefly described as below. 
Let x[n] denote the vector of samples from two-channel 
process at sample index n 
Tnxnxn ]][  ][[][ 21=x ,                      (1) 
where the superscript T represent the transpose operation. In (1), 
x1[⋅] and x2[⋅] represent the acquired respiratory signal and PPG 
signal respectively, and both of them are all real-valued in this 
research. The bivariate AR(p) process, assumed to be wide- 
sense stationary (WSS), can be represented as 
∑
=
+−−=
p
k
f
pp nknkn
1
][][)(][ exAx ,            (2) 
for the forward AR process, or 
   ∑
=
−++−−−=−−
p
k
b
pp nkpnkpn
1
]1[]1[)(]1[ exBx  (3) 
for the backward AR process. In (2) and (3), Ap(k) and Bp(k) are 
the 2×2 AR(p) forward and backward prediction parameter 
matrices, and ][nfpe  and ]1[ −nbpe  are the 2×1 vector 
representing the forward and backward prediction error of the 
AR(p) driving noise process. With the property that the driving 
noise process is uncorrelated with past values of the AR 
process, the two-channel Yule-Walker normal equations of 
forward linear prediction version can be derived as  
]   [ 00PRa Lfppp = ,                     (4) 
in which  
   )]( )1( [ pppp AAIa L= ,             (5) 
   ]}[][{ nnE Hppp xxR = ,              (6) 
with 
   
⎥⎥
⎥⎥
⎦
⎤
⎢⎢
⎢⎢
⎣
⎡
−
−=
][
]1[
][
][
pn
n
n
np
x
x
x
x M ,                (7) 
and 
   ]}[][{ nnE Hfp
f
p
f
p eeP = .               (8) 
In the above equations, 0 is a 2×2 null matrices and I denotes a 
2×2 identity matrix. The symbol E represents the statistical 
expectation operator and the superscript H means the Hermitian 
transpose operation. The matrix fpP  in (8) is in its essence the 
  
   
⎥⎦
⎤⎢⎣
⎡=
= −−
)()(
)()(
            
])([)]([)(
2221
1211
11
fPfP
fPfP
ffTf HPP
f
P
H
PPAR aEPEaP
         (43) 
where aP is defined in (5). 
The magnitude squared coherence (MSC)  
   
)()(
)(
)(
2211
2
21
fPfP
fP
fC =             (44) 
and the coherence phase  
   
)}(Re{
)}(Im{tan)(
21
211
fP
fPf −=θ            (45) 
versus frequency f are utilized for the coherence analysis 
between respiration and PPG signal in this research. In addition, 
the corresponding PSD of respiration and PPG signal can be 
derived from P11(f) and P22(f) versus frequency f. 
III. RESULTS AND DISCUSSION 
The coherence between the measured PPG and respiratory 
signals at different breathing rates from ten subjects was 
analyzed to evaluate their relationships in frequency domain. 
Fig.2 shows the coherence analysis results for one subject in the 
condition of 12-breaths/min rate. As seen in Fig. 2(a), there 
exists MSC greater than 0.5 near 0.2 Hz (the respiratory 
frequency, see Fig.2(c)). Also, the coherence phase is smaller 
than zero (see Fig.2(b)), which imply that the respiration- 
induced changes in PPG signal lags the respiratory signal. It 
also can be appreciated that there is a corresponding component 
near the respiratory frequency in the PSD of PPG signal, as 
depicted in Fig.2(d). 
The results in the 20-breaths/min condition for the same 
subject are demonstrated in Fig.3 with the same order arranged 
in Fig.2. The MSC depicts that high coherence exists between 
respiration and PPG signal (see Fig. 3(a)). Also, the respiration- 
induced change in PPG has a time delay compared with the res- 
 
 
(a)                                          (c) 
 
(b)                                          (d) 
Fig. 2 Coherence analysis results in 12-breaths/min rate for one 
subject: (a) MSC, (b) coherence phase, (c) PSD of respiratory 
signal, and (d) PSD of PPG signal. 
  
 
(a)                                          (c) 
 
(b)                                          (d) 
Fig. 3 Coherence analysis results in 20-breaths/min rate: (a) MSC, (b) 
coherence phase, (c) PSD of respiratory signal, and (d) PSD of 
PPG signal. 
 
 
(a)                                          (c) 
 
(b)                                          (d) 
Fig. 4 Coherence analysis results in breath-holding condition: (a) MSC, 
(b) coherence phase, (c) PSD of respiratory signal, and (d) PSD 
of PPG signal. 
 
 
Fig.5 The low-frequency fluctuated pattern in breath-holding 
condition for another subject. 
 
piratory signal, as shown in Fig.3(b).  
Fig.4 shows the results in holding-breath condition for the 
same subject. As all of the MSC values are less than 0.5 (see 
Fig.4(a)), it is appreciated that no coherence is found in such 
case. 
Though only the results from one subject are depicted in this 
paper, similar results are derived for almost all subjects. The 
  
 
 
Yue-Der Lin (M’00-SM’07) was born in Taichung, Taiwan, in 1963. He 
earned the Ph.D. degree of electrical engineering from National Taiwan 
University in 1998. He has been a lecture of the Department of Electrical 
Engineering, Wufeng Institute of Technology in 1991 and 1992, and a teaching 
assistant in the Department of Electrical Engineering, National Taiwan 
University from 1996 to 1998. He joined Comtrend Corporation as a design 
engineer in 1998 and was responsible for the design of embedded systems in 
telecommunication. He joined the faculty of the School of Post Baccalaureate 
Chinese Medicine, China Medical College in 1999 as an assistant professor 
where his research efforts were focused on medical device design and 
biomedical signal processing. Since 2003, he became an associate professor at 
the Department of Automatic Control Engineering, Feng Chia University, 
Taichung, Taiwan. Dr. Lin is a visiting scholar of the University of Wisconsin- 
Madison in 2006, where he pursued the research in ECG signal processing. He 
is the winner of the Rotary International Scholarship in 1994-1995 and 
1996-1997, and has been listed in Marquis Who’s Who in the World in 2008 and 
2009 for his researches on physiological signal analysis and wearable 
technology. He has also been listed in IBC Top 100 Educators, 2000 
Outstanding Intellectuals of the 21st Century, Foremost Educators of the World, 
Foremost Engineers of the World, 21st Century Award for Achievement and 
Leading Engineers of the World in 2008. 
Dr. Lin’s research interests include the medical instrumentation, biomedical 
signal processing and statistical signal processing. He is a senior member of 
IEEE EMB society. 
TABLE I ALGORITHM FOR BIVARIATE AR PARAMETERS 
model. AR bivariate oforder   the and
  ]][  ][  ]2[  ]1[[Let 
=
=
P
Nn xxxxX LL
 
⎩⎨
⎧
==
===
                        
,2,1   ][][][
 :
00
00
N
Nn fornnn
Hbf
bf
XXPP
xee
tionInitializa
L
 
1          
     ]1[][1
]1[]1[1
         ][][1
          
      
0     
:
2
2
2
+=
⎪⎪
⎪
⎩
⎪⎪
⎪
⎨
⎧
−=
−−=
=
≤
=
∑
∑
∑
+=
+=
+=
pp
nn
N
nn
N
nn
N
Ppwhile
p
N
pn
Hb
p
f
p
fb
p
N
pn
Hb
p
b
p
b
p
N
pn
Hf
p
f
p
f
p
eeP
eeP
eeP
nComputatio
 
( )( ) ( )⎪⎩
⎪⎨
⎧
−=+
−=+
−
+
−
+
1
1
1
1
)1(
     )1(
          
f
p
Hfb
pp
b
p
fb
pp
p
p
PPB
PPA
 
⎪⎩
⎪⎨⎧ ++−=
++−=
+++
+++
b
ppp
b
p
f
ppp
f
p
pp
pp
PABIP
PBAIP
)]1()1([
)]1()1([
          
111
111  
  end for 
kppkk
kppkk
pkfor
pppp
pppp
        
)1()1()()(
)1()1()()(
               
1,2,1           
11
11
⎩⎨
⎧
−+++=
−+++=
−=
++
++
ABBB
BAAA
L
 
le    end whi
end for
npnn
npnn
Nppnfor
f
pp
b
p
b
p
b
pp
f
p
f
p
          
][)1(]1[][
]1[)1(][][
               
,2,1           
11
11
⎪⎩
⎪⎨⎧ ++−=
−++=
++=
++
++
eBee
eAee
L
 
 
  
the respiratory-induced variations in venous return 
to the heart. Such variation is primarily caused by 
the alterations in intrathoracic pressure during 
respiration. A part of the respiratory-related drift in 
perfusion also originates from the autonomous 
control of the peripheral vessels and is also 
synchronous with respiration. RIIV signal can be 
extracted from PPG by a bandpass filter (0.13-0.48 
Hz). High coherence has been shown to exist 
between RIIV and the changes in tidal volume and 
respiratory rate (Johhansson et al., 1999a and 1999b; 
Nilsson et al., 2003). As some commercial pulse 
oximeters also provide PPG signal, these results 
imply that the pulse oximeters can be a potential tool 
for the acquisition of arterial oxygen saturation, 
heart rate and respiration at the same time. 
The relationship between RIIV and respiratory 
signal has been examined extensively in the past 
decades (Johhansson et al., 1999a and 1999b; 
Nilsson et al., 2003). However, little research has 
been done concerning the coherence between the 
raw PPG signal acquired from pulse oximeter and 
respiratory signal. As the RIIV may deviate with the 
varying respiratory rate, the fixed bandpass filter for 
PPG signal filtration may limit the accuracy of 
analysis in practical conditions, especially in slow 
and fast breathing cases. The objective of the present 
study was to investigate whether such coherence 
exists between raw PPG signal and respiratory signal. 
The multi-channel autoregressive (AR) spectral 
estimation method proposed by Morf et al. (1978), 
was utilized for the coherence analysis under 
different breathing rates and the breath-holding state 
for five healthy male subjects. The two-channel AR-
based cross-spectral analysis demonstrated that raw 
PPG signal and respiration were coherent 
(magnitude-squared coherence greater than 0.5) at 
the respiratory frequency in the subjects studied, 
with changes in respiration leading to changes in 
PPG. No coherence was found in breath-holding 
cases for the subjects participated. The results of this 
research verify that there exists the corresponding 
respiratory component in spectrum of raw PPG 
signal. The results may provide another attractive 
approach to acquire the respiratory information from 
PPG without the need of filtering. The results also 
imply the possibility to acquire the physiological 
parameters other than arterial oxygen saturation 
form pulse oximeters. 
2 METHODS AND MATERIALS 
2.1 Subjects and Experiments 
0 5 10 15 20 25 30
-0.15
-0.1
-0.05
0
0.05
0.1
R
e
s
p
ir
a
ti
o
n
Time (second)
0 5 10 15 20 25 30
0
0.5
1
1.5
2
2.5
3
3.5
Time (second)
P
P
G
 f
ro
m
 P
u
ls
e
 O
x
im
e
te
r
 
Figure 1: Typical signals acquired. Upper: respiratory 
signal (natural respiration); lower: PPG signal derived 
form pulse oximeter. 
 
Five healthy male subjects (non-smoker and with no 
prior history of cardiovascular disease) aged 
between 22 and 24 took part in the experiments after 
giving the informed consent. All subjects were asked 
to refrain from caffeine and alcoholic drink at least 4 
hours before the experiments. All of the experiments 
were performed at the same university laboratory 
with the room temperature being maintained at about 
25 degrees centigrade during the night time (from 9 
to 11 pm). The subjects were required of having a 
resting period of at least 5 minutes under relaxation 
status before the experiment.  
Each experiment included two stages classified 
by different respiratory rate (natural respiration and 
holding the breath in order). Each stage was 
maintained at least one minute, and the intervals 
between stages were three minutes. Throughout the 
experiment, the subjects were seated in a 
comfortable chair with their right upper arm kept at 
the height of heart level.  
2.2 Signal Measurement  
The physiological data acquisition system MP150
®
 
(Biopac Inc.) was utilized for signal measurement. 
Pulse oximetry signal (by pulse oximeter module 
OXY100C) and respiratory signal (by temperature 
amplifier module SKT100C with fast response 
thermistor sensor TSD202A) were collected 
simultaneously during each experimental stage. The 
Pulse oximetry probe (TSD123A, with infrared 
wavelength 910 nm) was attached to the right index 
finger, whereas the respiratory signal was acquired 
at the nostril during the measurement. The analysis 
package Biopac AcqKnowledge
®
 (version 3.9.1) 
was used for signal management, including the 
signal quality pre-screening, data storage and 
retrieval. The signals were verified visually by a 
well-trained technician. A typical respiratory signal 
  
b
ppp
b
p
pp PABIP )]1()1([
111


. (15) 
Finally, the relationships of the driving noise 
process between AR(p) and AP(p+1)can be obtained 
by 
]1[)1(][][
11


npnn
b
pp
f
p
f
p
eAee            (16) 
and 
][)1(]1[][
11
npnn
f
pp
b
p
b
p
eBee 

.  (17) 
The above procedure is summarized in Table 1. It 
is assumed that there are N samples in each channel 
and the order of two-channel AR process is P.  
For two-channel AR spectral estimation, define 
the complex exponential vector EP(f) of P+1 block 
elements as 
]     [)(
22
IIIE
TPfjTfj
P
eef



 ,            (18) 
in which T is the evenly sampled interval (sec) of the 
signals x[]. After the computation of the related 
coefficients, the power spectrum density (PSD) can 
be calculated by 
11
])([)]([)(


H
PP
f
P
H
PPAR
ffTf aEPEaP     (19) 







)()(
)()(
2221
1211
fPfP
fPfP
,    (20) 
where aP is defined in (4). 
The magnitude squared coherence (MSC)  
)()(
)(
)(
2211
2
21
fPfP
fP
fC       (21) 
and the coherence phase  
)}(Re{
)}(Im{
tan)(
21
211
fP
fP
f

     (22) 
versus frequency f are utilized for the coherence 
analysis between respiration and the PPG signal 
acquired from pulse oximeter in this research. From 
equation (20), P11(f) and P22(f) versus f are the PSD 
of respiration and PPG signal respectively. 
3 RESULTS AND DISCUSSION 
The coherence between the respiratory signal and 
the PPG signal acquired from pulse oximeter at 
different breathing status for five subjects was 
analyzed to evaluate their relationships in frequency 
domain. Though only the results for one subject are 
demonstrated in this paper, similar results are 
derived for all subjects. 
     Figure 2 shows the coherence analysis results for 
one subject in the condition of natural frequency. As 
seen in Figure 2(a), there exists a peak of MSC 
greater than 0.5 near 0.2 Hz (the respiratory 
frequency, see Figure 2(b)). Also, the coherence  
0 0.5 1 1.5 2 2.5
0
0.2
0.4
0.6
0.8
Frequency (Hz)
M
a
g
n
it
u
d
e
 S
q
u
a
re
d
 C
o
h
e
re
n
c
e
0 0.5 1 1.5 2 2.5
-4
-2
0
2
4
Frequency (Hz)
C
o
h
e
re
n
c
e
 P
h
a
s
e
 
(a) 
0 0.5 1 1.5 2 2.5
0
2
4
6
8
10
12
Frequency (Hz)
P
S
D
 (
R
e
s
p
ir
a
ti
o
n
)
0 0.5 1 1.5 2 2.5
0
2
4
6
8
10
Frequency (Hz)
P
S
D
 (
P
P
G
)
 
(b) 
Figure 2: Coherence analysis results for the case of natural 
respiration: (a) MSC (upper) and coherence phase (lower), 
(b) PSD of respiratory signal (upper) and PPG signal 
(lower). 
 
0 0.5 1 1.5 2 2.5
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
Frequency (Hz)
M
a
g
n
it
u
d
e
 S
q
u
a
re
d
 C
o
h
e
re
n
c
e
0 0.5 1 1.5 2 2.5
-4
-2
0
2
4
Frequency (Hz)
C
o
h
e
re
n
c
e
 P
h
a
s
e
 
(a) 
0 0.5 1 1.5 2 2.5
0
0.5
1
1.5
2
2.5
Frequency (Hz)
P
S
D
 (
R
e
s
p
ir
a
ti
o
n
)
0 0.5 1 1.5 2 2.5
0
5
10
15
20
Frequency (Hz)
P
S
D
 (
P
P
G
)
 
(b) 
Figure 3: Coherence analysis results at the breath-holding 
condition: (a) MSC (upper) and coherence phase (lower), 
(b) PSD of respiratory signal (upper) and PPG signal 
(lower). 
  
also implied in the negative coherence phase (see 
Figure 2(a)). The respiration induced component is 
evident in the AR-based PSD of PPG signal, as 
shown in Figure 2(b). The coherence analysis is also 
specific to respiration. As the breath is in holding 
status, no coherent peak was found (see Figure 3). 
The coherent phenomenon cannot be observed by 
the FFT-based cross-spectrum method (as shown in 
Figure 4).  
The existence of coherent peak is determined by 
whether the corresponding pole inside the unit circle 
is prominent or not. It has been shown that the 
coherence spectrum is sensitive and specific to the 
respiration in this research, it may be possible to 
acquire the respiratory information from the PPG 
signal by single-channel AR method with the 
consideration of poles around the respiratory 
frequency. It may provide another attractive 
approach to acquire the respiratory information from 
PPG signal without the need of filtering. It also 
implies the possibility to acquire the other 
physiological parameters other than arterial oxygen 
saturation form pulse oximeters. Besides, the two-
channel AR method introduced in section 2 can be 
easily expanded to more than three channels. Such 
multi-channel AR method may be an alternative 
attractive tool for the coherent analysis among 
respiration, central venous pressure (CVP), arterial 
blood pressure (ABP) and PPG signal in the related 
research, e.g. for the cases in intensive care unit 
(ICU) or during surgical operation.  
ACKNOWLEDGEMENTS 
The author wishes to express the gratitude to the 
National Science Council, Taiwan, for the financial 
support on this research (under contract number 
NSC 97-2221-E-035-001-MY3 and NSC 97-2221-
E- 035-053). 
REFERENCES 
Hertzman, A. B. and Spielman, C. R., 1937, Observations 
on the finger volume pulse recorded photoelectrically. 
In Am. J. Physiol., vol.119, pp.334-335. 
Johansson, A., Ö berg, P. Å . and Sedin, G., 1999, 
Monitoring of heart and respiratory rates in newborn 
infants using a new photoplethysmographic technique. 
In J. Clin. Monit., vol.15, pp.461-467.  
Johansson, A. and Ö berg, P. Å ., 1999a, Estimation of 
respiratory volumes from the photoplethysmographic 
signal. Part I:  experimental results. In Med. Biol. Eng. 
Comput., vol.37, pp.42-47. 
Johansson, A. and Ö berg, P. Å ., 1999b, Estimation of 
respiratory volumes from the photoplethysmographic 
signal. Part II:  a model study. In Med. Biol. Eng. 
Comput., vol.37, pp.48-53.  
Levinson, N., 1947, The Wiener RMS (root mean square) 
error criterion in filter design and prediction. In J. 
Math. Phys., vol.25, pp.261-278. 
Morf, M., Vieira, A., Lee, D. T. and Kailath, T., 1978, 
Recursive multichannel maximum entropy spectral 
estimation. In IEEE Trans. Geosci. Electron., vol.16, 
pp.85-94. 
Nilsson, L., Johansson, A. and Kalman, S., 2000, 
Monitoring of respiratory rate in postoperative care 
using a new photoplethysmographic technique. In J. 
Clin. Monit., vol.16, pp.309-315. 
Nilsson, L., Johansson, A. and Kalman, S., 2003, 
Macrocirculation is not the sole determinant of 
respiratory induced variations in the reflection mode 
photoplethysmographic signal. In Physiol. Meas., 
vol.24, pp.925- 937. 
Webster, J. G. Ed., 1997, Design of Pulse Oximeters, IOP 
Publishing, Bristol. 
Welch, P. D., 1970, The use of the fast Fourier transform 
for the estimation of power spectra. In IEEE Trans. 
Audio Electroacoust.,  vol.AU-15, pp.70-73. 
Specifically, we propose to perform PLI detection periodically before applying PLI rejection filter 
to the ECG signal. In other words, the proposed algorithm can make intelligent decisions on 
whether to apply PLI rejection filter. 
Methods 
The proposed structure can be divided into two parts. One is for the PLI detection, and this is 
the specific feature in this study. Another one is for the adaptive filter. The whole block diagram of 
the proposed structure is illustrated in Fig. 1. From this figure, there are two paths from input to 
output, and the signal flow is dependent on the detection result. If PLI is detected in the input signal, 
then the signal will be conducted to the adaptive filter with the structure shown in Fig. 2. for 
interference cancellation. Otherwise, the signal passes by directly without any further processing. 
A. CFRA-based PLI detection 
A unique feature of this proposed algorithm is its capability of detecting the presence of the PLI 
in x[n]. The underlying assumption is that the presence of the PLI interference needs to be verified 
only once every T seconds. We will take advantage of the narrow-band nature of the harmonic 
signal. Then, we compare the measured root-mean-square (RMS) value with a pre-specified 
threshold that is adaptively determined to ensure the false alarm rate of the PLI detector is set to be 
within a pre-specified upper bound. Hence, the detector is also known as constant false alarm 
(CFAR) detector.  
The overall detector structure is marked by solid line entitled “Power-line interference 
detection” in Fig. 1. First, the ECG signal x[n] is filtered using an IIR band-pass filter with a pair of 
poles located at )/2exp( Si ffj    and zeros at 1. The filter transfer function is given below 
 
221
2
2cos21
11
)(











zz
f
f
z
A
zH
S
i 
,            (1) 
where  denotes the pole radius that should not be greater than unity, A is the scalar for magnitude 
normalization, fi represents the power-line frequency, and fS is the sampling frequency of input 
signal x[n].  
 The output of this filter, denoted by p[n] has a band-width that is roughly equal to 
  )]/2(sin)1(1[cos
2
2 2222
4
11
Si
S ffA
f
  

,        (2) 
where 2  Hz centered at fi. 
 The root-mean-square (RMS) value of {p[n]} during a period n = 1 to T, denoted by  
221
21
1
1
1
)(





zza
zza
zH

,                   (5) 
and 
21
2
2
1
1
)(





zza
z
zH ,                 (6) 
where a  2cos(2f0/fS), with f0  the oscillator’s tuned frequency (Hz) and fS = the sampling 
frequency (Hz).  
   H1(z) and H2(z) can be combined and the total transfer function of the system is normalized as 
follows, 
 
221
2
21
1
11
)(
)(
)()()(





zza
z
AzX
zE
zHzHzH
N 
,            (6) 
where X(z) and E(z) are the z-transform of x[n] and e[n], respectively.  
Notch filter
H1(z)
Real oscillator
H2(z)
+
Input ECG signal 
x[n]
Output y[n]
(filtered)
Residue noise 
e[n]
+
_
 
Fig.2 The structure of the proposed adaptive filter 
 
Experiment and Result 
   The respective function of the CFAR-based PLI detector and the proposed adaptive filter has 
been verified in the above analysis. It is necessary to evaluate the performance as they are combined 
together. Fig. 3 demonstrates the results for the performance test of the proposed structure, in which 
a special pattern with an intermittent sinusoidal interference added in a noise-free ECG signal is 
generated for the testing purpose. The added sinusoidal interference has amplitude of 0.1 mV and is 
intermittent with the first 2 seconds being 59.5 Hz, the last 3 seconds 60.5 Hz, and the other time no 
sinusoid appears. This test pattern is used to verify whether the proposed method can detect the 
simulated PLI with deviated frequencies. In the proposed method, the CFAR-based PLI detector 
makes PLI detection once per second, once the detector has detected PLI contaminated in the signal, 
the output will be set to a value 1 and the signal will be conducted to the adaptive filter; otherwise, 
the output will be 0 and no filtering will occur.  
References 
[1] J. C. Huhta and J. G. Webster, “60-Hz interference in electrocardiography,” IEEE Trans. Biomed. 
Eng., vol.BME-20, pp.91-101, 1973. 
[2] B. B. Winter and J. G. Webster, “Driven-right-leg circuit design,” IEEE Trans. Biomed. Eng., 
vol.BME-30, no.1, pp.62-66, 1983. 
[3] M. O'Flynn, Probabilities, Random Variables, and Random Process, Harper & Row, 1982. 
[4] B. Widrow, J. Glover, J. M. McCool, J. Kaunitz, C. S. Williams, R. H. Hearn, J. R. Zeidler, E. 
Dong and R. Goodlin, “Adaptive noise cancelling: Principles and applications,” Proc. IEEE, 
vol.63, pp.1692-1716, 1975. 
[5] M. L. Ahlstrom and W. J. Tompkins, “Digital filters for real-time ECG signal processing using 
microprocessors,” IEEE Trans. Biomed. Eng., vol.BME-32, no.9, pp.708-713, 1985. 
[6] P. S. Hamilton, “A comparison of adaptive and nonadaptive filters for reduction of power line 
interference in the ECG,” IEEE Trans. Biomed. Eng., vol.BME-43, no. 1, pp.105-109, 1996. 
[7] S. C. Pei and C. C. Tseng, “Adaptive IIR notch filter based on least mean p-power error 
criterion,” IEEE Trans. Circuits Syst. II, vol.CAS-40, no.8, pp.525-529, 1993. 
[8] H. C. So, “Adaptive algorithm for sinusoidal interference cancellation,” Electron. Lett., vol.33, 
no.22, pp.1910-1912, 1997. 
[9] A. K. Ziarani and A. Konrad, “A nonlinear adaptive method of elimination of power line 
interference in ECG signals,” IEEE Trans. Biomed. Eng., vol.BME-49, no.6, pp.540-547, 2002. 
[10] R. Lyons and A. Bell, “The Swiss army knife of digital network,” IEEE Signal Processing 
Mag., vol.21, no.3, pp.90-100, May 2004. 
Acknowledgement 
The authors wish to express their gratitude to National Science Council (NSC 
97-2221-E-035-001-MY3) and Ministry of Economic Affairs (99-EC-17-A-19-S1-163), Taiwan for 
the financial support on this research. 
  
Multichannel Capacitive ECG Measurement  
with Conductive Fabric Tape 
 
Abstract 
Several researches have been devoted to capacitive electrocardiogram (ECG) 
measurement. However, there is little literature available on the implementation of 
multichannel capacitive ECG system in standard limb leads. The schematic diagram for such 
system is also rarely available in literature. This paper presents a multichannel limb-lead 
capacitive ECG system with conductive fabric tapes pasted on a double layer PCB as the 
capacitive sensors. The design criteria and the corresponding schematic diagram are 
described in detail. The proposed system also incorporates the capacitive driven-body (CDB) 
circuit to reduce the common-mode power-line interference (PLI). The presented system is 
verified to be stable by theoretic analysis and practical long-term experiments. The signals 
acquired by the presented system are competitive with those by commercially available ECG 
machines. The feasible sensor size is also evaluated by a series of tests with different size of 
capacitive sensors, which is suggested to be greater than 60 cm
2
 and smaller than 1.5 mm in 
distance for capacitive ECG measurement. 
 
Keywords: capacitive electrocardiogram (ECG) measurement, conductive fabric tape, 
capacitive sensor, capacitive driven-body (CDB) circuit, power-line interference (PLI). 
 1 
發明專利說明書 
（本說明書格式、順序及粗體字，請勿任意更動，※記號部分請勿填寫）  
※ 申請案號： 
※ 申請日期：                   ※I P C 分類： 
一、發明名稱：（中文/英文） 
多訊息光學脈搏計 
Multiple-Information Photoplethysmograph 
二、中文發明摘要： 
本 發明涉 及 一種 生理檢 測裝置 ，包含 一光發 射器、 一光
感 測器 、一 類比 訊號 處理 器 及 一微 控制 器 。 該光 發射 器交
互 發射 一紅 外光 束及 一紅 光光 束至 一生 物體 後， 該光 感測
器 接收 自該 生物 體反 射或 透射 之該 紅外 光束 及該 紅光 光束
而 分別 產生 一紅 外光 訊號 及一 紅光 訊號 。該 類比 訊號 處理
器 處理 該紅 外光 訊號 及該 紅光 訊號 ，該 微控 制器 藉由 該紅
外光訊號以及該紅光訊號推算出生理參數  
附件七 
  
International Journal Conference on Engineering and Technology (CET 2011)等四個國際研
討會所組成的聯合研討會。這次的應用計算機、計算機科學、計算機工程國際會議，
總共收到約300篇論文，其中只有95篇被接受在研討會中報告，並收錄在大會論文集之
中，其論文之接受率約30%左右。該國際研討會的論文將可在Index to Scientific & 
Technical Proceedings (ISTP)和Engineering Index（Compendex）搜尋到，其中該會議
2009年及2010年的論文已被ISTP檢索，檢索率100%，2009年的論文已被EI檢索，是水
準不錯的研討會。本人全程參與本會議所有的議程，另外也帶回本會議的論文集2011 
3
rd
 World Congress in Applied Computing,Computer Science, and Computer Engineering 
(ACC 2011) CD ROM，裏面包含所有這次會議的論文全文。 
本次會議邀請一位來自香港中文大學機械與自動化工程學系的Jun Wang 教授來演
講，王教授目前主要的研究包含神經網路及其相關應用，也在此領域中發表了140篇期
刊論文，同時也是IEEE在系統、人類、網絡化等業務的副主編，經歷相當豐富，本人
聆聽教授的英文演講雖然有些吃力，但由於教授準備的資料相當完整，因此本人在此
次的演講中也有所收穫，並對神經網路有初步認知，真是一場精采的演講。 
 
教授演講完後接連就是與會學者的專題演講，演講者大部分都來自中國大陸及香港
地區的學者，包括教授及博士研究員，藉此可了解對岸的研究情況及程度，也提高本
人國際學術的見識，重要的是從中可學習對岸研究的優點，並針對可精進之處予以探
討及突破，對我們的研究將有所幫助。 
  
搭配針對前述的偵測機制做選擇性濾波，故採用此方法可以避免傳統60Hz濾波器對於
無電源干擾之生理信號(如：ECG)也一併地進行濾波，導致失去原有特定的生理特徵。 
 
我們覺得這次的研討會是一個很精緻的小型研討會，參加這個研討會，讓我們有一
些新的想法，覺得相當值得。或許是因為這個研討會才舉辦第三屆，這次研討會我們
並無遇到台灣學者，希望在未來台灣能有更多人知道並參與這個研討會。 
 
國科會補助計畫
計畫名稱: 以多波長PPG實現多訊息生理參數量測
計畫主持人: 林育德
計畫編號: 97-2221-E-035-001-MY3 學門領域: 醫用電子 
血氧濃度感測器得到血氧濃度(SpO2)、脈搏速率(pulse rate)與灌流指標(perfusion 
index)、搏反射指標(reflection index, RI)、血管硬化指標(stiffness index, SI)與
呼吸率(respiratory rate)等多種生理訊息，均為心肺、心血管等現代慢性疾病重要的
生理參數，而且此技術並可提供中醫脈診的諧波分析，可藉由人體的五臟六腑與循環系
統的和諧共振程度的訊息，做為中醫辨症論治的科學依據。以上生理參數可以分別針對
紅光與紅外光感測結果分別呈現，並且可以將分析結果記錄下來，提供醫生對病情診斷
與臨床研究之用，是目前技術無法提供的功能。
註：本項研發成果若尚未申請專利，請勿揭露可申請專利之主要內容。
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
正洽談與國內廠商的技轉以及申請美國專利中, 期刊論文部分, 目前 Revised
一篇(Physiological Measurement, SCI indexed), 手中正在撰寫的有三篇, 
將陸續完成並投稿. 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
