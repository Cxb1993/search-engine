II 
中文摘要 
在具有多重使用者的無線網路中，我們可以利用各個使用者經歷不同通道變動的特性
（即所謂的多重使用者多樣性），讓每一時槽內通道狀況最佳的使用者傳送資料，來增進網
路流量。在這個計畫中，我們分別針對合作式網路與感知無線電網路，提出能利用多重使
用者多樣性好處的分散式傳輸策略。針對合作式的網路系統，我們考量一個具通道感知能
力的時槽式 ALOHA 系統，使用者可根據自身到基地台與到其他合作的伙伴間的通道狀況
來隨機決定傳輸機率。而對於具有多通道的感知無線電系統，我們將設計同時具通道感知
能力與頻譜感知能力的通道存取技術。 
在計畫的第一年裡，我們針對具通道感知能力的合作式隨機存取系統，設計最佳的傳
輸機制與伙伴選擇策略以最大化系統的加權總流量。在我們所提出的系統中，每位使用者
根據自身到基地台與到合作伙伴間的通道狀來決定其傳輸機率。從我們之前的計畫成果中
可以得知，當使用者的等效通道超過某一門檻值時，使用者必定傳輸其資料，此等效通道
定義為此使用者的傳輸在未遭遇碰撞時對整體加權流量的貢獻量，而門檻值的大小將根據
此使用者的平均傳輸機率而決定。此外，每位使用者的最佳合作伙伴是可以最大化此使用
者的等效通道者。 
在計畫的第二年裡，我們針對具有多重次要使用者的多通道感知無線電系統，提出具
通道感知能力的傳輸機制。此傳輸機制包含兩個步驟，即「頻段選擇」與「碰撞解析」。更
精確地說，在我們提出的機制裡，每位使用者首先根據他對自身通道狀況與頻譜使用狀況
來選擇其中一條通道進行存取。接下來，系統將採用具通道感知能力的樹狀分裂式演算法
來進行封包的碰撞解析，避免選取到同一條通道的使用者間發生資料封包碰撞。當有足夠
的碰撞解析時間，具有最佳通道狀態的使用者將可以正確地傳輸資料。同時，我們只允許
通道狀態夠好的次要使用者傳輸資料，以降低次要使用者與主要使用者間的碰撞機率。在
以電腦模擬系統效能時，我們所提出的同時考量通道狀態與頻譜狀態的傳輸策略比沒有同
時考慮這兩種狀態的其他策略，還能更有效地提升系統流量。 
 
IV 
 
Table of Contents 
 
I. BACKGROUND AND MOTIVATION ................................................................................................. 1 
II. MAIN OBJECTIVES ...................................................................................................................... 3 
III. LITERATURE REVIEW ............................................................................................................... 4 
IV. RESEARCH METHODS ................................................................................................................ 5 
A. Channel-Aware Cooperative Random Access Networks ............................................... 6 
B. Channel- and Sensing-Aware Cognitive Radio Networks ............................................. 8 
V. SUMMARY OF RESEARCH RESULTS ........................................................................................... 12 
A. Channel-Aware Cooperative Random Access Networks ............................................. 12 
B. Channel- and Sensing-Aware Cognitive Radio Networks ........................................... 15 
VI. SELF EVALUATION ................................................................................................................... 19 
VII. RELATED PUBLICATIONS ........................................................................................................ 20 
VIII. REFERENCES ........................................................................................................................ 21 
APPENDIX A:  
Shu-Hsien Wang, An-Dee Lin, and Y.-W. Peter Hong, “Channel-Aware Transmission Control for 
Cooperative Random Access Networks,” in Proceedings of IEEE Vehicular Technology 
Conference, Spring, 2010 (VTC2010-Spring). 
APPENDIX B: 
Chi-Yu Hsu, “Channel and Sensing Aware Channel Access Policy for Multi-Channel Cognitive 
Radio Networks,” National Tsing Hua University, 2011 
APPENDIX C: 
Shu-Hsien Wang, Chih-Yu Hsu, and Y.-W. Peter Hong, “Channel and Sensing Aware Channel 
Access Policy for Multi-Channel Cognitive Radio Networks,” submitted to IEEE International 
Conference on Acoustics, Speech, and Signal Processing (ICASSP), 2012.
2 
developed to incorporate multiuser diversity into cooperative systems. However, in this case, 
both the uplink and the interuser channel states must be taken into consideration. 
In addition to exploiting cooperation among users to enhance system efficiency, efficient 
spectrum usage is also a critical issue that has attracted much attention in recent years. Radio 
spectrum is a scarce resource in wireless communication systems, but has not been utilized 
efficiently. In fact, most of the radio spectrum have been assigned to different applications or 
licensed to different users. Unlicensed users were not allowed to access the spectrum in any case. 
However, Federal Communications Commission (FCC) recently revealed that the use of licensed 
spectrum have been largely inefficient, leaving white spaces, i.e., spectrum intervals that are not 
occupied by licensed (or primary) users, available in the spectrum [15] as shown in Fig. 2. This 
has motivated recent studies on cognitive radio technology [16], which enables unlicensed (or 
secondary) users to sense vacancies in the spectrum, to opportunistically access the spectrum 
when it is vacant, and to retreat whenever the primary user returns. To do so, secondary users 
(SUs) are allowed to periodically sense the vacancies in spectrum and access the white spaces. 
However, due to the existence of spectrum sensing errors (that is, miss detection or false alarm), 
secondary users may transmit and collide with the transmission of licensed users (or, primary 
users), or keep silent even if the spectrum is idle. To preserve the transmission priority of 
primary users (PUs) and to access the spectrum more efficiently, SUs should carefully determine 
whether to access the channel or not such that the interference from SUs to the primary users can 
be limited to a certain level and the throughput of SUs can be maximized.  
To be more specific, in order to protect the transmission of PUs and enhance the spectrum 
utilization efficiency, there are two important issues for secondary networks, (1) spectrum 
sensing, and (2) spectrum access. The problem related to (1) is that secondary users should 
discover the unused portion of spectrum. However, the estimated spectrum occupancy state may 
not be always accurate. Spectrum sensing errors exist indeed, even if it can be set to approach to 
0 by designing a good spectrum sensing policy. A collision between secondary users and licensed 
users occurs when secondary users believe that a portion used spectrum is actually vacant and 
time 
frequency  
Fig. 2. Illustration of Spectrum Holes (White Spaces) 
spectrum hole
power 
    
4 
SU will first choose one channel to access and then emit reservation packets to compete for 
the right of transmission on the chosen channel. A channel-aware tree splitting algorithm is 
employed to resolve collision among users choosing the same channel. By taking the uplink 
sum throughput as the performance measure, the optimal channel selection and reservation 
strategies are derived to maximize the sum throughput among secondary users. Moreover, to 
guarantee primary users’ (PUs’) transmission priority, we also impose a collision probability 
constraint which limits the probability that each SU is allowed to transmit, especially when 
the channel is sensed to be busy. 
 
III. LITERATURE REVIEW 
Multiuser diversity [1-2] have been exploited to increase the throughput of wireless 
networks by scheduling the user with the best channel to transmit in each time slot. This 
technique requires the use of a central scheduler and knowledge of the channel state information 
(CSI) of all links, which may not be possible in practice. However, for systems without a central 
control, it has been shown that multiuser diversity can still be exploited by allowing each user to 
dynamically adjust its transmission probability according to its local CSI [3-5]. In this case, the 
optimal transmission strategy is for each user to transmit only when its uplink channel is 
sufficiently reliable. The adjustment of the transmission probability is refered to as the 
transmission control of each user. In [3-4], it has been shown that this distributed channel-aware 
transmission control can still effectively exploit multiuser diversity to enlarge the stable 
throughput of ALOHA networks. Extending upon these results, we further derived, in [5], the 
optimal transmission control that takes into consideration the statistics of channel estimation 
errors. In this case, we show that each user should be more conservative when using the channel 
if the channel estimation error is large. Even though throughput is increased by considering 
channel-aware transmission policies, the throughput of each user is still limited by the quality of 
its local uplink channel. This can be overcome with the use of cooperative communications. 
Cooperative transmission techniques have been proposed in the literature, e.g., in [6-10], to 
improve the reliability of wireless communications through the relaying of cooperative partners. 
While most studies on cooperative communications have focused on the physical layer aspects, 
MAC layer protocols that efficiently exploit the advantages of cooperation must also be designed. 
Specifically, we have also demonstrated in [17-20] the advantages of cooperation from a MAC 
perspective and quantified the improvement that can be obtained in terms of the users’ stable 
throughput in cooperative slotted ALOHA networks. In [20], we derived the two-user stability 
region and bounds for arbitrary N-user stability region for cooperative slotted ALOHA systems 
by adopting a simple decode-and-forward cooperative protocol, where any two users can form a 
cooperative entity and help relay each other's packets to the common AP. It has been observed 
that, the users with relative poor uplink channels can be significantly benefited from the help of 
its cooperative partner.  
6 
A. Channel-Aware Cooperative Random Access Networks 
Let us first consider an N-user cooperative slotted ALOHA system where the users, i.e., user 
1 to user N, are transmitting to a common access point (AP), as shown in Fig. 3. We consider a 
time-slotted system where the time slots are well-synchronized among users and the slot duration 
is assumed to be sufficient for the transmission of a packet and its corresponding 
acknowledgements. Let  be the instantaneous uplink CSI of user i and let  be the 
instantaneous interuser CSI between user i and user j in the m-th time slot, where 
. The CSI parameter can be set, for example, as the signal-to-noise ratio (SNR) 
at the corresponding receiver. In the m-th time slot, user i will transmit a packet to the AP with 
probability  which is set as a function of the local CSI vector 
. If more than one user is transmitting 
in the same time slot, the packets will collide and no packet will be received by the AP. However, 
if only user i is transmitting in the m-th time slot, user i's packet will be correctly decoded at the 
AP with probability , which is a function of the uplink CSI . At the end of each 
time slot, the AP will send a  feedback to the users, where 0 indicates that the time slot 
was idle, 1 indicates that the transmission was successful, e indicates that the transmission failed 
due to channel errors, and c indicates that a collision occurred. In the following, we shall often 
omit the time index m when referring to the current time slot. 
In the cooperative system under consideration, each user is allowed to store the other user's 
packet (if the initial transmission failed) and forward it to the AP in subsequent time slots. To do 
this, each user maintains two buffers: a cooperative buffer, which is used to store the packets 
received from the other user, and a self buffer, which is used to store its self-generated packets. 
When the uplink transmission of user i fails due to channel errors (and not collision), user j will 
make an attempt to decode the message, store it in the cooperative buffer, and forward it in later 
time slots. The probability that user i's packet is correctly received by user j, given that no 
  
Fig. 3. Cooperative Network with N Users 
8 
is the average number of packets successfully transmitted from user i to user j, for . Please 
note that,  is the partner selection functions with the -th entry equal to . 
By Loynes' theorem [27], we know that user i's cooperative queue will be stable if its arrival 
rate is less than its service rate, i.e.,  
  (3) 
In this case, the throughput of user i is  
  (4) 
On the other hand, if , the cooperative queue at user i will be 
unstable and it may occur that certain cooperative packets may never reach the AP. The 
transmission control policies must be chosen to avoid these situations. 
B. Channel- and Sensing-Aware Cognitive Radio Networks  
 
In the second year of this project, we extend our channel-aware transmission scheme to 
cognitive radio networks with multiple secondary users as shown in Fig. 4. Consider a cognitive 
radio network with L backlogged secondary users (SUs) communicating to an access point (AP), 
and the entire secondary network lies within the coverage area of primary users (PUs). Assume 
that the spectrum belonging to PUs is partitioned into M equal-bandwidth channels on which the 
spectrum of the m-th channel will be either idle or occupied by PUs, say, or . Suppose 
PUs transmit in a slotted fashion and that the presence or absence of PU signals on each channel, 
say channel m, can be characterized by the prior probabilities 
  and . 
The goal is for SUs to access the spectrum without colliding with PUs. To do so, the 
 
Fig. 4. Cognitive Radio Networks 
10 
(i.e., transmit or receive signals on only one channel at a time). Based on the local CSI and the 
sensing outcomes (thus, the belief vector), each SU will select one channel to access and then 
perform the channel reservation on the chosen channel. Let denote by 
  (6) 
the probability that SU i decides to reserve and transmit on the m-th channel, where  is 
referred to as the channel selection policy of SU i on channel m with . 
Reservation-Based MAC Protocol 
We consider a collision channel model such that a transmission will fail if there are multiple 
concurrent transmissions on the same channel. To prevent SUs from colliding with each other, 
the AP allocates some slots for SUs to reserve for their transmission after the spectrum sensing 
and before the actual data transmission. In addition, to enhance the throughput of secondary 
networks, the AP is supposed to serve the SU with the highest channel gain on each channel at 
each time instant. Suppose that the AP does not know the exact channel gains between itself and 
all the SUs. In fact, to collect all the channel state information from all the SUs will take a large 
amount of effort especially when the number of SUs is large. In the following, we propose a 
channel-aware reservation-based MAC protocol with collision resolution, where the AP is not 
required to collect all the CSI but just allocates K minislots for SUs to reserve their transmission 
at the beginning of each transmission period.  
Assume that the number of minislots  is less than the number of total SUs , and that 
the total number of SUs is known at each SU. In each minislot, users with channel gain beyond a 
certain threshold will be allowed to transmit. If a collision occurs, the threshold will be increased 
dynamically to determine the user with the best channel gain. If no reservation packet is emitted 
in a minislot, the AP will lower the threshold recruit more SU to compete for transmission, even 
if the channels of these SUs are less reliable.  
Let us first consider the single-channel case that all SUs are competing and transmitting on 
the same channel. Specifically, given the SUs with channel gain in the interval  will be 
allowed to emit a request in the first minislot, where  is chosen to maximize the probability 
that only the best user is allowed to transmit in the first minislot . 
Given that the previous  minislots are idle, i.e. all the SUs' channel gains are below the 
value of , the threshold in the -th minislot, i.e. , will be updated by maximizing the 
probability that the best user can be resolved in the next minislot, that is, 
 
Hence, after  successive idle minislots, the SUs that are allowed to transmit in the -th 
minislot will have channel gain within the interval   where   satisfies 
  Suppose that the -th minislot is the first non-idle minislot. In this case, 
we know that there is at least one SU whose channel gain falls within   If more than 
12 
  (8) 
we should carefully choose appropriate  to satisfy the above equation. However, 
the difficulty in designing  is that the exactly number of SUs competing on the 
same channel will depend on the channel selection policy and can vary across time. 
In the second year of this project, we devise a channel and sensing aware channel access 
policy (including channel selection and reservation threshold design) that maximizes SUs' 
throughput under a constraint on the probability of collision with PUs. 
 
V. SUMMARY OF RESEARCH RESULTS 
A. Channel-Aware Cooperative Random Access Networks 
In the first year, we will find the optimal transmission strategy that can maximize the 
weighted sum throughout of cooperative slotted ALOHA systems.  
Let  be the set of transmission control vectors  with average 
transmission probabilities given by the vector  and let  be the set of all 
possible  partner selection matrices . The throughput region for the N-user case can be 
expressed as 
  (9) 
We assume that the optimal transmission control will stablize all the cooperative queues, the 
weighted sum throughput of cooperative systems can be defined as 
 (10) 
where  are non-negative weights of the throughput of N users, and 
  (11) 
14 
Fig. 7 and Fig. 8 show the throughput region for two-user systems by adopting our proposed 
channel-aware transmission control (CA TC), the transmission control with only uplink channel 
awareness, and without CA TC in conventional slotted ALOHA systems. Each point in the figure, 
say , denotes the throughput of each user achieved by applying the optimal transmission 
controls for a certain weight vector  with different channel awareness capability.  
We first assume that each user's channel statistic is symmetric with the uplink SNR being 
distributed with mean 3.6 and the interuser SNR being distributed with mean 6.4. Therefore, the 
average reception probabilities of the uplink and interuser channels are approximately given by 
 and  for . We can observe that the throughput 
with the proposed CA TC dominate those of the other two cases since multiuser diversity can be 
exploited on both the uplink and interuser channel. Moreover, we consider an asymmetric 
channel scenario in Fig. 8, where user 1 suffers a poor uplink channel than user 2's. Assume that 
the average SNR on the uplink of user 1 and user 2 are given by 3.6 and 25.6, therefore, the 
average reception probabilities of the uplink channel are given by  and 
. Similarly, the throughput degrades as the channel awareness capability is 
limited. Besides, user 1's maximum throughput (which is achieved when user 2's throughput is 0) 
is significantly increased with the proposed CA TC because user 2 can serve a powerful relay 
path for user 1 if user 1 can effectively exploit the interuser CSI. 
The throughput of a three-user system with and without channel-aware transmission control 
(CA TC) is shown in Fig. 9. Again, each point in Fig. 9 can be achieved by using the optimal 
transmission controls and partner selection policies that maximize the weighted sum throughput 
with a certain weight vector, based on both uplink and interuser CSI (i.e., with the proposed CA 
TC) or when no CSI is considered. We assume the CSI statistics of each user are symmetric. 
Specifically, the SNRs on the uplink and interuser channel of each user are exponentially 
 
Fig. 8. Two-user throughput region with asymmetric channels 
16 
where  is the power spectral density of Gaussian noise,  s the bandwidth of one channel, 
and  
  (15) 
with  being a Bernoulli random variable parameterized by , 
i.e., . The probability  is the probability that SU i 
will successfully reserve the channel m given that it determines to access that channel, which can 
be expressed as 
  
Please note that, since each SU will not know the CSI of the other SUs, the probability 
 is averaged over all other SUs j's channel gain, . Moreover, since the 
channel gain is assumed to be i.i.d., the channel selection policy  will be identical for all 
SUs and so is the probability . However, finding the optimal channel selection policy and 
the optimal thresholds  jointly by solving (14) is intractable. Therefore, we propose a 
sub-optimal scheme that we first optimize the channel selection policy by maximizing the 
throughput without considering the collision probability constraint (i.e., without considering the 
threshold ). Thereafter, based on the devised channel selection policy, we tackle the 
collision constraining problem by choosing appropriate thresholds. 
Channel Selection Policy 
Regardless of the interference constraint between PUs and SUs, that is, the SU with the highest 
channel gain among SUs competing on the same channel can always transmit, we can simplify 
our optimization problem as 
 (16) 
subject to  Although we have removed the 
collision constraint, the problem is still hard to deal with since the selection policy is still 
embedded in the derivation of probability . By observing the above problem, if the 
probability functions  are known, the maximization problem becomes a linear 
programming (LP) program, where the optimal channel selection policy is given by 
18 
By (7)-(8), the optimal thresholds that maximize the throughput of SUs and satisfy the 
interference constraint can be numerically solved by  
  (19) 
We evaluate the throughput of SUs by exploiting the proposed reservation-based MAC 
protocols and channel-aware channel-access policy by computer simulations. Consider a 
cognitive radio network operated in a licensed spectrum with bandwidth W=3 MHz and noise 
variance  watts/Hz. Before each transmission, the AP will perform the spectrum 
sensing and then broadcast the sensing outcomes and pilot symbols to SUs. SUs will reserve the 
channel following the channel-aware reservation scheme by utilizing K=6 minislots. The SU 
who successfully reserved the spectrum will transmit its data in the following transmission 
period. Suppose that the idle probabilities of the 3 channels are  for all m. The AP of 
secondary networks senses the spectrum states periodically with errors  and 
. The channel gain between each SU to the AP is exponentially distributed with mean 
equal to 4.  
Fig. 10 shows the network throughput under the proposed channel and sensing aware 
channel access policy and the other two strategies under the collision probability constraint 
. By adopting the gain-based policy, each SU selects the channel with the best channel 
quality regardless of the sensing outcomes. Moreover, the belief-based policy suggests that each 
SU always selects the channel whose idle probability is the highest among the three, leaving the 
other two channels unused even if they are idle. Hence, the throughput under the belief-based 
policy may be much worse than the other two policies. The reason that the throughput drawn 
from gain-based strategy almost reaches that under the proposed strategy is because that the idle 
 
Fig. 10. Throughput of SUs with  for all m and  
20 
should transmit whenever its effective channel takes values beyond a certain threshold. Here, the 
defined effective channel models each user's contribution to the weighted sum throughput, given 
that it no collision occurs. We also showed that the best cooperative partner of a user is the one 
that maximizes its effective channel. If no partner can benefit the effective channel, the user will 
rather stay in the direct transmission mode without asking for help from others. Compared with 
conventional slotted ALOHA networks, the proposed channel-aware transmission control and 
partner selection policy improves the throughput of cooperative networks significantly, even if 
the average channel quality of uplink or inter-user channel is poor. 
For cognitive radio networks, we further proposed a channel and sensing aware channel 
access policy for secondary users (SUs) in a multichannel system. In the proposed policy, each 
SU first chooses a channel to access according to both the spectrum idle probability and the 
quality of all channels. The proposed channel access policy can be found through an iterative 
algorithm. After that, a reservation period that employs the channel-aware splitting algorithm is 
used to resolve collision among SUs that are choosing the same channel. Moreover, to preserve 
PUs’ transmission priority, a collision probability constraint is also imposed to limit the 
transmission of SUs. This is translated into a lower threshold on the channel gain, which allows 
only SUs with sufficiently reliable channels to transmit. The optimal reservation threshold was 
also characterized in our work. Our proposed channel access policy with both channel and 
sensing awareness was shown to outperform gain-based and belief-based channel access policies. 
The results we obtained match closely with the objects and tasks specified in the original 
proposal. The main results on cooperation networks have been partially presented at IEEE 
Vehicular Technology Conference in Spring 2010 (see Appendix A) and are to be submitted to 
IEEE Transactions on Communications. The main results on cognitive radio networks are 
presented in the master’s thesis given in Appendix B and has been submitted to IEEE 
International Conference on Acoustics, Speech, and Signal Processing (ICASSP) 2012 (see 
Appendix C). These as well as other related publications are listed in the following section. 
 
VII. RELATED PUBLICATIONS 
Journal Publications: 
- Y.-W. Peter Hong, Chun-Kuang Lin, and Shu-Hsien Wang, “Exploiting Cooperative Diversity 
in Slotted ALOHA Random Access Networks,” in IEEE Transactions on Information Theory, 
Vol. 56, No. 8, pp. 3828-3846, August 2010.  
Book: 
- Y.-W. Peter Hong, Wan Jen Huang, and C.-C. Jay Kuo, “Cooperative Communications and 
Networking: Technologies and System Design,” Publisher: Springer, 2010. 
Master Thesis: 
22 
8(10): p. 5214-5224, Oct. 2009.  
[6] Sendonaris, A., E. Erkip, and B. Aazhang, User cooperation diversity. Part I. System 
description. IEEE Transactions on Communications, 2003. 51(11): p. 1927-1938. 
[7] Sendonaris, A., E. Erkip, and B. Aazhang, User cooperation diversity. Part II. Implementation 
aspects and performance analysis. IEEE Transactions on Communications, 2003. 51(11): p. 
1939-1948. 
[8] Laneman, J.N., D.N.C. Tse, and G.W. Wornell, Cooperative diversity in wireless networks: 
Efficient protocols and outage behavior. IEEE Transactions on Information Theory, 2004. 
50(12): p. 3062-3080. 
[9] Laneman, J.N. and G.W. Wornell, Distributed space-time-coded protocols for exploiting 
cooperative diversity in wireless networks. IEEE Transactions on Information Theory, 2003. 
49(10): p. 2415-2425. 
[10] Scaglione, A. and Y.-W. Hong, Opportunistic large arrays: Cooperative transmission in 
wireless multihop ad hoc networks to reach far distances. IEEE Transactions on Signal 
Processing, 2003. 51(8): p. 2082-2092. 
[11] Janani, M., et al., Coded cooperation in wireless communications: Space-time transmission 
and iterative decoding. IEEE Transactions on Signal Processing, 2004. 52(2): p. 362-371. 
[12] Kramer, G., M. Gastpar, and P. Gupta, Cooperative strategies and capacity theorems for 
relay networks. IEEE Transactions on Information Theory, 2005. 51(9): p. 3037-3063. 
[13] IEEE P802.11 - WIRELESS NEXT GENERATION STANDING COMMITTEE. 
http://grouper.ieee.org/groups/802/11/Reports/WNG_update.htm  
[14] Cooperative Techniques in the IEEE 802 Wireless Standards: Opportunities and Challenges, 
in Cooperation in Wireless Networks: Principles and Applications, F.H.P. Fitzek and M.D. 
Katz, Editors. 2006. 
[15] Spectrum policy task force report, Federal Communications Commision, Report, Et docket 
No. 02-135, November 2002. 
[16] J. Mitola and G. Q. Maguire, Cognitive radio: Making software radios more personal. IEEE 
Personal Communications, 6: p. 13-18, 1999. 
[17] C.-K. Lin and Y.-W. P. Hong, On the finite-user stability region of slotted ALOHA with 
cooperative users. Proc. of IEEE International Conference on Communications (ICC), 2008. 
[18] Y.-W. Hong, C.-K. Lin, and S.-H. Wang, On the stability region of finite-user slotted 
ALOHA with cooperative relays. Proc. of the International Symposium on Information 
Theory (ISIT), 2007. 
[19] Y.-W. Hong, C.-K. Lin, and S.-H. Wang, On the stability of two-user slotted ALOHA with 
channel-aware and cooperative users. Proc. of IEEE Workshop on Wireless Networks: 
Communication, Cooperation and Competition (WNC3) 2007 (held in conjunction with 
WiOpt 2007). 
[20] Y.-W. Peter Hong, Chun-Kuang Lin, and Shu-Hsien Wang, Exploiting cooperative 
Channel-Aware Transmission Control for
Cooperative Random Access Networks
Shu-Hsien Wang, An-Dee Lin and Y.-W. Peter Hong
Institute of Communications Engineering
National Tsing Hua University, 30013 Hsinchu, Taiwan
{shwang,adlin}@erdos.ee.nthu.edu.tw and ywhong@ee.nthu.edu.tw
Abstract—Multiuser and cooperative diversity gains have been
studied extensively in recent years to improve communication
reliability and throughput of wireless networks. Multiuser di-
versity gains have been exploited by scheduling users with the
best channel to transmit in each time slot while cooperative
diversity gains have been exploited by having users relay each
other’s messages to the destination. Most works in the literature
consider these advantages separately and in systems that rely on
a central scheduler. In this work, we show that the throughput of
distributed random access systems can be improved by exploiting
both cooperative and multiuser diversity where the transmission
probabilities of users are adjusted according to their local channel
state information. The fully-loaded stability region is derived as
the performance measure of our proposed transmission strategy.
The optimal transmission control that maximizes the fully-loaded
region is shown to be a threshold-like function. That is, each
user shall transmit only when its effective channel is sufficiently
reliable. The effective channel in this case is defined as each user’s
contribution to the weighted sum throughput of the network.
I. INTRODUCTION
Cooperative communication systems [1], [2] exploit spa-
tial diversity gains by allowing users to transmit their own
messages as well as relay the messages of other users to the
destination or access point (AP). By doing so, each message
is communicated to the AP via multiple independent fading
paths and, thus, communication outage will occur only when
both the direct and the relay links fail simultaneously. In this
case, outage probability is reduced considerably compared to
non-cooperative systems, achieving the so-called cooperative
diversity. Moreover, multiuser diversity have also been studied
extensively in the literature by scheduling users with the best
channel to transmit in each time slot [3], [4]. This approach
is known maximize the system throughput of non-cooperative
multiple access systems [3], [4]. In the past, these techniques
have mostly been applied separately to enhance the reliability
and throughput of wireless systems and often rely on a central
control to collect the channel state information (CSI) of all
links or to schedule the cooperative transmissions. In this
work, we combine the use of both cooperative and multiuser
diversity in distributed random access networks and show how
these advantages can be exploited without a central channel-
aware scheduler.
This work was supported in part by the National Science Council, Taiwan,
under the grants NSC 98-2221-E-007-059-MY2, NSC 98-2219-E-007-004,
and NSC 98-2218-E-009-008-MY3.
When a central control is not available to collect the CSI or
to perform the transmission scheduling, distributed channel-
aware transmission control policies must be developed to
exploit the local CSI and the cooperative diversity gains. In
[5], [6], decentralized channel-aware transmission control poli-
cies have been proposed in non-cooperative slotted ALOHA
networks to allow for users to adjust their local transmission
probabilities in each time slot according to the knowledge of
their instantaneous uplink channel conditions. This serves as
a promising technique to exploit multiuser diversity gains in
distributed random access systems. Moreover, in [7]–[9], coop-
erative queuing and transmission policies have been derived to
exploit cooperative diversity gains in slotted ALOHA systems.
It has been shown that, in random access networks, cooperative
advantages not only can improve the transmission reliability
in the physical-layer but is also helpful in reducing contention
among users in the MAC layer.
The main contribution of this work is to propose a channel-
aware transmission control for cooperative slotted ALOHA
systems that increases the system throughput by allowing each
user to adjust its transmission probability according to the
CSI of both the uplink and the interuser channels. This work
builds upon our previous work in [9], where the proposed
transmission control function utilizes only the uplink CSI
and the results are derived only for an idealized two-state
reception model. In this work, we consider a more general
reception model and derive the optimal transmission control
that maximizes the fully-loaded stability region by assuming
that the interuser channels are independent and identically
distributed (i.i.d). Here, the fully-loaded stability region is
defined as the collection of arrival rate vectors that can be
stably accommodated without having the queue-length grow
to infinity in systems where all users are assumed to be
backlogged. We show that the optimal transmission control
function takes on the form of a thresholding function that
allows each user to transmit with probability 1 if the effective
channel is beyond a certain threshold and remain silent,
otherwise. The effective channel is defined as the contribution
of each user to the weighted sum throughput of the system.
II. SYSTEM MODEL
Consider a cooperative slotted ALOHA network with N
users transmitting to a common AP as shown in Fig. 1. Assume
that time is divided into equal-length slots that are sufficient
978-1-4244-2519-8/10/$26.00 ©2010 IEEE
where pi = E[si(γi)] is the average transmission probability
of user i and Ψ¯(·) = 1−Ψ(·). Moreover, 1[·] is the indicator
function, i.e. 1[E] = 1 if the event E is true and 1[E] = 0
otherwise. Hence, 1[γji>γjk, ∀k∈Oj\{i}] is the indicator that
identifies when user i has the best interuser channel to user j
among Oj and can serve as a relay for user j. Furthermore,
user i’s average service rate is given by
μi(α) = E
[
si(γi)
{
Ψ(γiD) + Ψ¯(γiD)Ψ(γi,coop)
∑
j∈Oi
1[γij>γi,∀∈Oi\{j}]r¯j
}] ∏
∈Oi
p¯. (2)
By Loynes’ Theorem, the fully-loaded region for a given set
of transmission parameter α is given by
C(α) =
⎧⎨
⎩λ : λi +
∑
j∈Oi
λ
(j)
i (α) < μi(α), ∀i ∈ {1, 2, ..., N}
⎫⎬
⎭ .
The fully-loaded region is obtained by taking the union of
C(α) over all possible values of transmission parameter α,
i.e.
C =
⋃
α
C(α). (3)
With the help of the following lemma, we can derive
the optimal transmission control, in terms of achieving the
largest fully-loaded region, under any given set of average
transmission parameters ω = (p1, p2, ..., pN , r1, r2, ..., rN ).
LEMMA 1: Given a set of average transmission probabili-
ties and rejection probabilities ω = (p1, ..., pN , r1, ..., rN ), the
fully-loaded region of the cooperative slotted ALOHA system,
i.e.,
Cω =
⋃
α: E[si]=pi, i=1,2,...,N
C(α),
is convex.
Sketch Proof: To prove Lemma 1, we first randomly choose
two point in the region, say point A = (λ(A)1 , ..., λ
(A)
N ) and
point B = (λ(B)1 , ..., λ
(B)
N ). Let us define the transmission con-
trol that stabilizes A (or B) as (sA1 , ..., sAN ) (or (sB1 , ..., sBN )).
For any point C(λ(C)1 , ..., λ
(C)
N ) located between the line
segment AB, i.e. (λ(C)1 , ..., λ
(C)
N ) = θ(λ
(A)
1 , ..., λ
(A)
N ) + (1 −
θ)(λ(B)1 , ..., λ
(B)
N ), θ ∈ [0, 1], we can always find the trans-
mission controls (s(C)1 , ..., s
(C)
N ) = θ(s
(A)
1 , ..., s
(A)
N ) + (1 −
θ)(s(B)1 , ..., s
(B)
N ) that stabilize point C and E[s
(C)
i ] = pi, i =
1, ..., N . Details are omitted due to space limitations. 
Let C¯ω  cl(Cω) be the closure of the fully-loaded region
under the transmission controls ω = (p1, ..., pN , r1, ..., rN ).
Due to the convexity of the fully-loaded region, each boundary
point on the direction of (β1, ..., βN ), say (Λ1,Λ2, ...ΛN ) ∈
C¯ω\Cω , can be denoted as
(Λ1,Λ2, ...,ΛN ) = arg max
(λ1,λ2)∈C¯ω
N∑
i=1
βiλi. (4)
Here, βi ∈ [0,∞) for all i and (β1, β2, ..., βN ) is the normal
vector of the region at the point (Λ1,Λ2, ...,ΛN ). Suppose
that the interuser channels between user i and its partners,
i.e.
{
γij , ∀j ∈ Oi
}
, are i.i.d. Then, the probability that the
channel from user j to user i has the largest interuser SNR
among those in Oj is given by
Pr
{
γji ≥ γjk,∀k ∈ Oj\{i} | γj,coop
}
=
1
N − 1 ,
which is common for all users i ∈ Oj . This means that, each
cooperative partner of user j will serve as user j’s relay with
equal probability. By (1) and (2), the weighted sum throughput
in (4) follows by
N∑
i=1
βiλi ≤
N∑
i=1
⎧⎨
⎩μi −
∑
j∈Oi
λ
(j)
i
⎫⎬
⎭
=
N∑
i=1
E
[
si(γi)
[
βiΨ(γiD)+
1
N−1Ψ¯(γiD)Ψ(γi,coop)
·
∑
j∈Oi
(βi−βj)r¯j
]] ∏
∈Oi
p¯.
Let us denote by
Φi(γi) = βiΨ(γiD)+
1
N−1Ψ¯(γiD)Ψ(γi,coop)
∑
j∈Oi
(βi−βj)r¯j
the effective channel of user i. Notice that given the CSI
{γi}Ni=1 of each user, the weighted sum throughput is∑N
i=1 si(γ1)Φi(γ1)
∏
j∈Oi p¯j . Therefore, the effective channel
can be interpreted as each user’s contribution to the weighted
sum throughput of the network. Then, given the transmission
parameter ω, the optimal transmission control that achieves
the boundary of the fully-loaded region on the direction of
(β1, ..., βN ) is derived in the following proposition.
PROPOSITION 1: Consider an N -user cooperative slotted
ALOHA system and assume that the interuser channels are
i.i.d., for a given set of average transmission probabilities and
rejection probabilities ω = (p1, ..., pN , r1, ..., rN ), the optimal
transmission controls that achieve the largest sum throughput
in (5) (i.e. achieve the region’s boundary on the direction of
(β1, ..., βN )) are the step functions
s∗i (γi) = 1[Φi(γi)>φi],∀i = 1, 2, ..., N, (5)
where the thresholds {φi}Ni=1 are constants that satisfy
E
[
s∗i (γi)
]
= E
[
1[Φi(γi)>φi]
]
= pi, ∀i = 1, 2, ..., N.
The proof is given in Appendix A. As stated in Proposition
1, each user shall transmit when its local CSI is good enough
such that each user’s transmission can lead to higher through-
put of the network. Hence, given ω = (p1, ..., pN , r1, ..., rN ),
the N -user fully-loaded region Cω is the union of regions
derived under all possible {βi ∈ [0,∞)}Ni=1 and the corre-
sponding optimal transmission controls {s∗i }Ni=1.
0
0.2
0.4
0 0.1
0.2 0.3
0.4
0
0.1
0.2
0.3
0.4
λ1λ2
λ 3
With No Tx Control
With Tx Control
Fig. 4. Three-user fully-loaded region with symmetric CSI.
link via cooperative mechanism.
The 3-user fully-loaded region shown in Fig. 4 depicts the
stable arrival rates that can be accommodated in symmetric
systems, where we assume that κiD = 3−1 × 103 and κij =
2−1×103, ∀i, j ∈ {1, 2, 3}. It is shown that the improvement
due to channel awareness is further obvious, even if the CSI
statistic of each user is symmetric. That is because, as the
number of users increases, it is important for each user to seize
the transmission opportunity when experiencing good channel
quality, otherwise, the transmission without channel awareness
will result in transmission fail due to the bad channel and/or
cause serious collision to the other users with good channel
condition.
V. CONCLUSION
In this work, a channel-aware transmission control function
that allows each user to adjust its transmission probability
according to both its uplink and interuser CSI has been
proposed for cooperative slotted ALOHA networks. We have
analyzed the fully-loaded stability region of the channel-aware
cooperative slotted ALOHA system and derived the optimal
transmission control function that maximizes the fully-loaded
region. The optimal transmission control has been shown to be
a threshold-like function that allows each user to transmit with
probability 1 if its effective channel exceeds a certain threshold
and remains silent, otherwise. We have shown that the fully-
loaded region can be enlarged considerably by employing the
proposed channel-aware user cooperation scheme.
APPENDIX A
PROOF OF PROPOSITION 1
Let us define a set of thresholding transmission control
functions as si(γi) = 1[Φi(γi)>φi], ∀i = 1, . . . , N, where
φi are chosen to satisfy E
[
si(γi)
]
= pi, ∀i. Furthermore,
let classify γi into two sets as Ui = {γi : Φi(γi) ≥ φi} and
Li = {γi : Φi(γi) < φi}, ∀i. Let s′1(γ1), . . . , s′N (γN ) be any
other kind of transmission control functions that also satisfy
E[s′i(γ1)] = pi, for all i. Then, denote λ′1, . . . , λ′N as the
corresponding exogenous arrival rates accommodated by all
users. The difference of the weighted sum throughput under
these two kinds of transmission controls is given by
N∑
i=i
βiλi −
N∑
i=1
βiλ
′
i
=
N∑
i=1
E
[
(si(γi)− s′i(γi))Φi(γi)
] ∏
∈Oi
p¯
=
N∑
i=1
{
E
[
(1− s′i(γi))Φi(γi)1[γi∈Ui]
]
−E
[
s′i(γi)Φi(γi)1[γi∈Li]
]}
·
∏
∈Oi
p¯
≥
N∑
i=1
{
E
[
(1−s′i(γi))φi1[γi∈Ui]
]
−E
[
s′i(γi)φi1[γi∈Li]
]}∏
∈Oi
p¯
=
N∑
i=1
{
φi
{
E[s1(γ1)]−E[s′1(γ1)]
}}
= 0.
Consequently, the thresholding transmission controls promise
for the largest sum throughput rate. Hence, the transmission
controls in (5) are optimal.
REFERENCES
[1] A. Sendonaris, E. Erkip, and B. Aazhang, “User Cooperation Diversity–
Part I: System Description” and “User Cooperation Diversity–Part
II: Implementation Aspects and Performance Analysis,” IEEE Trans.
Commun., vol. 51, no. 11, Nov. 2003.
[2] J. Laneman, D. Tse, and G. Wornell, “Cooperative diversity in wireless
networks: Efficient protocols and outage behavior,” IEEE Trans. Inf.
Theory, vol. 50, no. 12, pp. 3062–3080, Dec. 2004.
[3] R. Knopp and P. A. Humblet, “Information capacity and power control
in single-cell multiuser communications,” in IEEE International Con-
ference on Communications, Jun. 1995.
[4] P. Viswanath, D. N. C. Tse, and R. Laroia, “Opportunistic beamforming
using dumb antennas,” IEEE Transactions on Information Theory,
vol. 48, pp. 1277-1294, 2002.
[5] S. Adireddy and L. Tong, “Exploiting decentralized channel state
information for random access,” IEEE Trans. Inf. Theory, vol. 51, no. 2,
pp. 537–561, Feb. 2005.
[6] X. Qin and R. Berry, “Distributed approaches for exploiting multiuser
diversity in wireless networks,” IEEE Trans. Inf. Theory, vol. 52, no. 2,
pp. 392–413, Feb. 2006.
[7] C.-K. Lin and Y.-W. P. Hong, “On the finite-user stability region
of slotted ALOHA with cooperative users,” in Proceedings of IEEE
International Conference on Communications (ICC), 2008.
[8] Y.-W. Hong, C.-K. Lin, and S.-H. Wang, “On the stability region of
finite-user slotted ALOHA with cooperative relays,” in Proceedings of
the International Symposium on Information Theory (ISIT), 2007.
[9] Y.-W. Hong, C.-K. Lin and S.-H. Wang, “On the stability of two-
user slotted ALOHA with channel-aware and cooperative users”, IEEE
Workshop on Wireless Networks: Communication, Cooperation and
Competition (WNC3) 2007 (held in conjunction with WiOpt 2007).
[10] R. Rao and A. Ephremides, “On a stability of interacting queues in
multi-access system,” IEEE Trans. Inf. Theory, vol. 34, pp. 918–930,
Sep. 1988.
[11] R. Loynes, “The stability of a queue with non-independent inter-arrival
and service times,” Proceedings of the Cambridge Philosophical Society,
vol. 58, pp. 497–520, 1962.
[12] W. Szpankowski, “Stability conditions for some multiqueue distributed
systems: Buffered random access systems,” Advances in Applied Prob-
ability, vol. 26, pp. 498V515, 1994.
Abstract
A cognitive radio system that consists of multiple secondary users transmitting to a common
secondary access point is considered in this work. To increase the sum throughput of the
secondary system, a channel- and sensing-aware channel access policy is proposed for multi-
channel cognitive radio networks. In the proposed scheme, each user will choose a channel to
transmit on in each frame based on its knowledge of the channel qualities and the spectrum
occupancy state (SOS). Each frame will be divided into two phase: a channel reservation
phase and a data transmission phase. In the channel reservation phase, each user will send a
reservation packet to compete for the channel and a channel-aware splitting algorithm will be
employed to resolve collision through multiple mini time slots. With a sufficient number of
mini-slots, the user with the best channel gain will be identified and will be given the right
to transmit in the data transmission phase. A lower threshold is also set on the channel
gain of the transmitting user so that the collision probability (i.e., the probability that the
secondary user interferes with the transmission of the primary user) is maintained below a
certain level. The channel-aware reservation scheme was proposed in our previous work for
a single channel cognitive radio system. This scheme is extended to systems with multiple
parallel channels in this thesis. Here, each secondary user is assumed to have only one set
of transceivers so that only one channel can be accessed during each frame. A channel- and
SOS-aware channel access policy is then devised to help each secondary user determine which
channel to access in each frame. With the goal of maximizing the system sum throughput,
i
Contents
Abstract i
Contents iii
1 Introduction 1
2 System Model 5
3 Review of Single Channel Scenario 11
3.1 Channel-Aware Reservation Scheme . . . . . . . . . . . . . . . . . . . . . . . 11
3.2 Average Transmission Probability . . . . . . . . . . . . . . . . . . . . . . . . 15
3.3 Throughput Analysis and Maximization . . . . . . . . . . . . . . . . . . . . 19
4 Multi-channel scenario 23
4.1 Channel Access Strategy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24
4.1.1 Proposed Channel-Access Policy . . . . . . . . . . . . . . . . . . . . . 26
4.1.2 Gain-Based Strategy . . . . . . . . . . . . . . . . . . . . . . . . . . . 28
4.1.3 Belief-Based Strategy . . . . . . . . . . . . . . . . . . . . . . . . . . . 30
4.2 Transmission Control . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31
iii
List of Figures
2.1 Network model. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6
2.2 Time slot model. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7
3.1 Reservation period in each transmission block. . . . . . . . . . . . . . . . . . 13
3.2 Channel-aware splitting algorithm. . . . . . . . . . . . . . . . . . . . . . . . 15
5.1 Network throughput versus the number of SUs with K = 4 and v0 = 0.5 . . . 37
5.2 Network throughput versus the number of SUs with K = 6 and v0 = 0.5 . . . 38
5.3 The upper bound of average throughput with v
(1)
0 = v
(2)
0 = v
(3)
0 = 0.5 . . . . . 39
5.4 The upper bound of average throughput, v
(1)
0 = v
(2)
0 = 0.1, v
(3)
0 = 0.9 . . . . . 40
5.5 The upper bound of average throughput, v
(1)
0 = v
(2)
0 = 0.1, v
(3)
0 = 0.9, . . . . . 41
v
collision probability, i.e., the probability that SU transmits when PU is present. The trans-
mission policies of SUs are based on the SOS and knowledge of the sensing error probability.
For cognitive radio networks that contain multiple SUs, a heuristic transmission policy with
randomization on channel selection is proposed in [5] to prevent different SUs from choosing
the same white space and colliding with each other’s transmissions. Most existing spectrum
access policies designed for SUs only take into consideration the reliability of the spectrum
sensing outcome. However, when multiple SUs are present in the system, channel-aware
policies can also be developed to exploit multiuser diversity and, in this way, maximize the
overall system throughput.
In conventional networks, where all users belong to the same system and no collision
probability constraint must be considered, the sum throughput of the users can be maximized
by allowing the user with the highest channel gain to transmit in each time slot [6, 7, 8, 9].
To do so, the access point or the base station must acquire the channel state information
(CSI) of all users and schedule the transmission for the user with the best channel quality
(and, thus, with the maximum achievable rate). Scheduling policies that exploit multi-user
diversity in a centralized fashion are discussed in [6, 7]. When scheduling is not possible,
distributed channel-aware schemes, such as those in [8, 9, 10], can be employed without
significant loss in throughput. For example, in a slotted ALOHA network where each user
will transmit opportunistically at a average transmission probability, each user is allowed to
transmit with probability 1 if its channel condition is sufficiently good while remain silent
otherwise. All users will determine whether to transmit or not based on its local CSI without
a centralized scheduler, such as the access point or the base station.
The main contribution of this thesis is to propose a channel- and sensing-aware channel
access policy for multi-channel cognitive radio networks. In the proposed scheme, each
user will choose a channel to transmit on in each frame based on its knowledge of the
2
over channels that meet the collision requirements of PUs. Analogous to the single-channel
case, a SU will reserve the chosen channel by emitting a short reservation packet to the
access point before the exact data transmission process. With the concern of protecting
PUs in mind, we constrain that only the SU whose channel is good enough can reserve for
transmission. The condition that whether the channel of a SU is good enough or not will be
interpreted by a threshold on the channel gain between each SU to the access point. We will
characterized the optimal threshold under the proposed channel access policy and compare
the performance of our proposed policy with other heuristic channel access policies.
The thesis is organized as follows. The primary and secondary networks are modeled
in Chapter 2. We review the channel-aware reservation MAC protocol proposed in [11] is
given Chapter 3. In Chapter 4, we propose the channel access policy that maximizes the
throughput of SUs while devising a proper channel reservation process that can limit the
collision probability to a certain level. We provide simulation results in Chapter 5 and the
conclusion will go in Chapter 6.
4
AP
: Secondary User
: Primary User
Figure 2.1: Network model.
multaneously and then broadcast the sensing outcomes to all SUs. Specifically, the AP will
broadcast the sensing outcome {D(m)}Mm=1 ∈ {0, 1} of each channel to all SUs, where the
sensing outcome D(m) = 0 refers to the case that the spectrum of channel m is sensed to be
idle and D(m) = 1 refers to the case that the spectrum of channel m is sensed to be occupied
by PUs. The performance of spectrum sensing can be characterized with the false alarm
probabilities {P (m)FA }Mm=1 and the miss detection probabilities {P (m)M }Mm=1, which are defined
as the conditional probabilities
P
(m)
FA = Pr{D(m) = 1|H(m)0 is true}
and
P
(m)
M = Pr{D(m) = 0|H(m)1 is true},
where m = 1, ...,M is the channel index.
After the spectrum sensing, SUs will be allowed to transmit opportunistically within a
period TX as shown in Fig.2.2. Specifically, each SU will first estimate the channel between
itself to the AP, then reserve time slot for its packets by emitting some reservation packets
to the AP. If a SU successfully reserves the transmission slot, it will transmit in the following
time slot and receive ACK messages at the end of its transmission period. The transmission
attempts of SUs should be carefully determined by taking into consideration the sensing error
probabilities {P (m)FA , P (m)M } even if the spectrum is sensed to be idle (or busy). By considering
6
channels are reciprocal). Upon receiving the sensing outcome and pilot signals from the AP,
the SUs can determine whether or not to transmit on each channel based on the belief vector
and the channel state information (CSI) between themselves to the AP. Assume that the
channel coefficient between each SU and AP on each channel is a complex white Gaussian
random variable with zero mean and variance σ2, and that the channel will remain constant
in the following transmission period and is identical and independently distributed (i.i.d.)
among users on all channels. Let γ
(m)
i be the channel gain of SU i on the m-th channel. The
channel gains of each SU to the AP on each channel will be distributed with density
f(γ) =
1
σ2
exp
(
− γ
σ2
)
and cumulative distribution function (CDF)
F (γ) = 1− exp
(
− γ
σ2
)
.
Besides, the channel gain of each SU is assumed to be identical and independently distributed
across time. Suppose that each SU is equipped with only one transceiver such that it
can access only one channel at each time instant (i.e., transmit or receive signals on only
one channel at a time). Furthermore, we consider a collision channel model such that a
transmission will fail if there are multiple concurrent transmissions on the same channel. To
prevent SUs from colliding with each other, the AP allocates some slots for SUs to reserve
for their transmission after the spectrum sensing and before the actual data transmission.
In addition, to enhance the throughput of secondary networks, the AP is supposed to serve
the SU with the highest channel gain on each channel. Suppose that the AP does not know
the exact channel gains between itself and all the SUs. In fact, to collect all the channel
state information from all the SUs will take a large amount of effort especially when the
number of SUs is large. In this thesis, we propose a channel-aware reservation-based MAC
protocol with collision resolution, where the AP is not required to collect all the CSI but
8
the channel-access probability that SU i decides to reserve and transmit on the m-th channel
under the transmission control policy pi with constraint
∑M
m=1 φ
pi,(m)
i (γi, ω) = 1. In the
following chapter, we will discuss three transmission policies based on only the belief vector
(belief-based), only CSI vector (gain based), or both the vectors, and derive the optimal
access policies that can maximize the SU throughput while limiting the interference to the
primary networks to a certain level. In Chapter 3, we will first discuss the transmission
and reservation schemes developed for a single-channel scenario, i.e., M = 1. In the single-
channel case,
φ
pi,(1)
i = 1,
for all SU i. In Chapter 4, we will extend the reservation-based MAC scheme to multi-channel
systems by considering different types of transmission control policies.
10
to the AP in the first minislot. The AP will then feed back an acknowledgement to indicate
whether a success, idle, or collided reservation occurs. If there is only one SU emitting the
packet in the first time slot, the AP will understand that the SU is the one with the highest
channel gain and then feed back a 1-acknowledgment to assign transmission period to that
SU. If there is no SUs responding, the AP will claim that an idle minislot occurs and then
lower the channel gain threshold to, say, [H2, H1), such that only SUs whose gain fall within
the interval can reserve for transmission. Otherwise, if there are multiple SUs responding
in the first minislot, the AP will declare that a collision occurs and split the channel gain
interval [H1,∞) into two sets. One set containing a higher part of the interval [H1,∞) and
the other set containing the lower part of it, where the upper part of the interval will be the
new threshold of the channel gain in the next minislot.
Moreover, to ensure that the interference probability from the SU transmission to the
PUs, we shall not always let the SU who has reserved the channel transmit. Specifically,
based on the belief1 ω (i.e., the probability that the spectrum is idle at the end of the channel
estimation period), we constrain that only the SUs whose channel gains are greater or equal
to Γpilower(ω) can reserve the channel under the transmission policy pi. The thresholds Γ
pi
lower(ω)
should be carefully chosen so that the collision probability to the primary user is bounded
below.
The detailed channel-aware splitting algorithm for secondary networks is stated below.
Channel-Aware Splitting Algorithm
In each transmission block, the AP allows SUs to emit the reservation requests in the reser-
vation period, which is composed of K successive minislots with duration Tmin each as shown
1In single-channel scenario, the belief vector ω contains only one element, i.e., ω(1). Therefore, in this
chapter, we simplify the notation to ω instead of ω. In addition, we name it the belief instead of the belief
vector.
12
minislot, i.e. Hi, will be updated by
Hi = argmax
H
(
L
1
)
(F (Hi−1)− F (H)) [F (H)]L−1
[F (Hi−1)]L
,
where the optimal solution satisfies
F (Hi) =
(
1− 1
L
)i
. (3.3)
Moreover, with the collision probability constraint in mind, given that the first i−1 minislots
are idle, only the SUs whose channel gains falls within
[max{Γpilower(ω), Hi},max{Γpilower(ω), Hi−1})
can emit reservation packets in the i-th minislot.
While the first non-idle minislot is found, let say, some SUs emit reservation packet in
the i-th minislot, the AP knows that there is at least one SU whose channel gain falls within
[max{Γpilower(ω), Hi}, max{Γpilower(ω), Hi−1}) . If there is exactly one SU reserves, than it is
the one with the highest channel gain and shall be allowed to transmit in the following
period. Otherwise, if more than one SU request for transmission in the i-th minislot, the
interval [max{Γpilower(ω), Hi}, max{Γpilower(ω), Hi−1}) will be split into two equal-probability
partition once a minislot until the SU with highest channel gain is resolved or the remaining
K − i minislots are run out of. For example, as we know the highest channel gain as well as
some other SUs’s channel gains fall within [hl, hu), the upper part of the interval [hl, hu), let
say, [hc, hu), will be chosen as the new interval used in the next minislot, where the threshold
hc separates the upper and lower parts satisfies
hc = F
−1
(
F (hu) + F (hl)
2
)
. (3.4)
Furthermore, with the newly assigned interval [hc, hu), suppose that no SUs responds in this
moment, i.e. no SUs whose channel gains are within the range [hc, hu). Thereafter, the lower
14
The maximum integer i such that Hi > Γ
1-ch
lower(ω) is given by
log
(
1− exp
(
−Γ1-chlower(ω)
σ2
))
log
(
L−1
L
)
− 1,
where dxe denote the minimum integer that is greater or equal to x. Let define
I(ω) ,

log
(
1− exp
(
−Γ1-chlower(ω)
σ2
))
log
(
L−1
L
)

as the maximum allowable number of minislots that the lower bound of the interval of channel
gain, i.e., Hi, can be successive lowered down given the belief ω. Please note that, the lower
bound of the I(ω)-th minislot should never be less than Γ1-chlower(ω), the targeting interval
of channel gains in the I(ω)-th minislot is given by [Γ1-chlower(ω), HI(ω)−1). The transmission
probability under the belief ω is then given by
P 1-cht (ω)=
min{K,I−1}∑
i=1
2K−i∑
n=1
(
L
1
)
Pr
{
γ ∈ [h(n−1)i , h(n)i )
}[
Pr
{
γ ∈ [0, h(n−1)i )
}]L−1
(3.7)
+
2K−I∑
n=1
(
L
1
)
Pr
{
γ ∈ [g(n−1), g(n))} [Pr{γ ∈ [0, g(n−1))}]L−1
=
min{K,I−1}∑
i=1
2K−i∑
n=1
L
2K−i
[
1
L
(
L− 1
L
)i−1][(
L−1
L
)i−1
− 2
K−i − n+ 1
2K−i
1
L
(
L− 1
L
)i−1]L−1
(3.8)
+
2K−I∑
n=1
L· (
L−1
L
)I−1−1+e−
Γ1-chlower(ω)
σ2
2K−I
[(
L−1
L
)I−1
− 2
K−I− n+ 1
2K−I
[(
L−1
L
)I−1
−1+e−
Γ1-chlower(ω)
σ2
]]L−1
where [h
(n−1)
i , h
(n)
i ) is the n-th partition of the interval [Hi, Hi−1) in the i-th minislot such
that h
(0)
i = Hi, h
(2K−i)
i = Hi−1, and
Pr{γ ∈ [h(n−1)i , h(n)i )} =
Pr{γ ∈ [Hi, Hi−1)}
2K−i
.
Please note that in (3.7)-(3.8), we have simplified the notation I(ω) to I for conveniences.
And similarly, [g(n−1), g(n)) is the n-th partition of the query range [Γ1-chlower(ω), HI(ω)−1) in the
I-th minislot such that g(0) = Γ1-chlower(ω), g
(2K−I(ω)) = HI(ω)−1, and
Pr{γ ∈ [g(n−1), g(n))} = Pr{γ ∈ [Γ
1-ch
lower(ω), HI(ω)−1)}
2K−I(ω)
.
16
Proof: The proof is given in Section 7.1. Thus, it follows that
2K−i∑
n=1
[
1− 2
K−i−n+ 1
2K−i
1
L
]L−1
=
2K−i∑
n=1
[
1− m
2K−i
1
L
]L−1
≤
∫ 2K−i
n=1
[
1− 1
2K−i
n
L
]L−1
dn = 2K−i − 2K−i
[
1− 1
L
]L
and similarly,
2K−I(ω)∑
n=1
[(
L−1
L
)I(ω)−1
− 2
K−I(ω)−n+1
2K−I(ω)
[(
L−1
L
)I(ω)−1
−1+exp
(
−Γ
1-ch
lower(ω)
σ2
)]]L−1
≤
(
L−1
L
)(I(ω)−1)L
2K−I(ω)/L
(L−1
L
)I(ω)−1−1+exp(−Γ1-chlower(ω)
σ2
)
1−(1−exp(−Γ1-chlower(ω)σ2 )
(L−1
L
)I(ω)−1
)L.
Hence, the transmission probability given in (3.8) is approximated with its upper bound as
P 1-cht (ω)≤
min{K,I(ω)−1}∑
i=1
[
1−
(
1− 1
L
)L](
L− 1
L
)L(i−1)
+
(
L−1
L
)(I(ω)−1)L 1−(1−exp(−Γ1-chlower(ω)σ2 )
(L−1
L
)I(ω)−1
)L1{K≥I(ω)}
= min
{
1−
(
L−1
L
)LK
, 1−
(
L−1
L
)L(I(ω)−1)}
(3.9)
+
(
L−1
L
)(I(ω)−1)L 1−(1−exp(−Γ1-chlower(ω)σ2 )
(L−1
L
)I(ω)−1
)L1{K≥I(ω)}
, P¯ (1-ch)t (ω),
where 1{·} is an indicator function and we denote the upper bound of the average transmission
probability P 1-cht (ω) as P¯
(1-ch)
t (ω).
It is worthwhile to note that, the upper bound of the transmission probability given in
(3.9) increases as the threshold Γ1-chlower(ω) decreases. However, the transmission probability
stops to increase but remains the same whenever Γ1-chlower(ω) ≤ HK (i.e. K ≤ I(ω)), where HK
is the lower bound of the reservation interval after K − 1 successive idle minislots. Hence,
18
given the belief ω is given by
R1-ch(ω) =
min{K,I(ω)−1}∑
i=1
2K−i∑
n=1
(
L
1
)∫ h(n)i
h
(n−1)
i
2W log
(
1 +
γ
2N0W
)
f(γ)dγ
[
Pr
{
γ ∈ [0, h(n−1)i )
}]L−1
+
2K−I(ω)∑
n=1
(
L
1
)∫ g(n)
g(n−1)
2W log
(
1 +
γ
2N0W
)
f(γ)dγ
[
Pr
{
γ ∈ [0, g(n−1))}]L−1 . (3.12)
It is worthwhile to note that, the relationship between the transmission probability/rate
and the threshold on the channel gain in channel-aware splitting algorithm is implicit in (3.7)
and (3.12) since the probability that the spectrum is successfully reserved by the SU with the
highest channel gain will depend on the joint distribution of all the SUs’ channel gains. If we
directly maximize the transmission rate in (3.12) by selecting a proper threshold Γ1-chlower(ω)
that meets the collision probability constraint in (3.11), the optimization problem becomes
intractable. We then derive an upper bound of the transmission rate, which is denoted as
R¯1-ch(ω) given the belief ω by limiting the upper bound of the transmission probability, i.e.,
P¯ 1-cht (ω) ≤ min
{
1,
pcol
(1− ω)
}
. (3.13)
Intuitively, the transmission probability P 1-cht (ω) is upper bounded by the probability that
at least one SU’s channel gain is greater than or equal to max{Γ1-chlower(ω), HK}. Hence, the
upper bound of the transmission rate is defined as the average channel capacity if the SU
with the highest channel gain is always served at each transmission block provided that the
highest channel gain is greater than or equal to max{Γ1-chlower(ω), HK}. More specifically, the
average transmission rate is upper bounded as
R1-ch(ω)≤
∫ ∞
max{Γ1-chlower(ω),HK}
2W log
(
1 +
γmax
2N0W
)
fmax(γmax)dγmax , R¯1-ch(ω) (3.14)
where γmax , maxi γi is the highest channel gain among all SUs, and
fmax(γmax) =
L
σ2
exp
(
−γmax
σ2
) [
1− exp
(
−γmax
σ2
)]L−1
20
throughput of the secondary network, which is defined as the average transmission data
amount in one sensing interval over the period of one sensing interval, can be given by
TD
T
Eω
[
R1-ch(ω)
]
, (3.17)
where the expectation is taken over the belief. Recall that according to the binary sensing
outcome D ∈ {0, 1} broadcast by the AP, the value of belief defined in (2.3) will takes on
two possible values depending on the false alarm and miss detection probabilities. With
the abuse of nation, let denote by ω(D) as the belief given that D is sensed. The average
throughput of SUs can be given by
TD
T
1∑
`=0
Pr{D = `} ·R1-ch(ω(`)), (3.18)
where the probability that the spectrum is sensed to be idle or busy is given by
Pr{D = 0} =
1∑
j=0
Pr{D = 0|Hj is true} · Pr{Hj is true} (3.19)
= v0 · (1− PFA) + v1PM ,
or
Pr{D = 1} =
1∑
j=0
Pr{D = 1|Hj is true} · Pr{Hj is true} (3.20)
= v0 · PFA + v1(1− PM).
22
proposed access policy with the latter two policies.
4.1 Channel Access Strategy
Learning from the single channel case in previous section, we know that with a proper
K (the number of minislots), the SU with the highest channel gain can reserve the channel
successfully with high probability if its channel gain is also higher than the threshold designed
to meet the collision probability to the PUs. To maximize the individual throughput of each
SU, say SU i, we will have the following optimization problem:
max
{φpi,(m)i (·),Γpi,(m)lower (ω)}
Eγ
i
[
M∑
m=1
φ
pi,(m)
i (γi, ω)ω
(m)P(m)i (γ(m)i , ω) · 1[γ(m)i ≥Γpi,(m)lower (ω)]
× 2W
M
log
(
1 +
γ
(m)
i
2N0W/M
)]
subject to
M∑
m=1
φ
pi,(m)
i (γi, ω) = 1, (4.1)
φ
pi,(m)
i (γi, ω) ∈ [0, 1], ∀i,m,
(1− ω(m)) · P pi,(m)t ≤ pcol, ∀m,
whereN0 is the power spectral density of Gaussian noise,
2W
M
is the bandwidth of one channel,
and Ppi,(m)i (γ(m)i , ω) is defined as
Ppi,(m)i (γ(m)i , ω) , Pr
{
SU i’s channel gain is higher than those of
any other SUs competing for the same channel
∣∣∣∣ω, γ(m)i ,Φpi,(m)i = 1} ,
(4.2)
with Φ
pi,(m)
i being a Bernoulli random variable parameterized by φ
pi,(m)
i (γi, ω) and Γ
pi,(m)
lower (ω)
be the channel gain threshold that only SUs whose gains are no less than this can reserve
the m-th channel, and
P
pi,(m)
t (ω) = 1−
[
1− Eγ
i
[
φ
pi,(m)
i (γi, ω)P
pi,(m)
i (γ
(m)
i , ω)) · 1[γ(m)i ≥Γpi,(m)lower (ω)]
]]L
(4.3)
24
solving the optimization problem in (4.1) is complicated. Therefore, we propose a sub-
optimal channel-access strategy that maximizes the throughput by ignoring the collision
probability constraint.
4.1.1 Proposed Channel-Access Policy
The proposed channel-access strategy takes both CSI and belief into consideration without
considering the collision constraint. That is, given any belief vector, we want to maximize
the upper bound of the system throughput:
max
{φProp,(m)i (·)}
Eγ
i
[
M∑
m=1
φ
Prop,(m)
i (γi, ω)ω
(m)P(m)i (γ(m)i , ω) ·
2W
M
log
(
1 +
γ
(m)
i
2N0W/M
)]
subject to
M∑
m=1
φ
Prop,(m)
i (γi, ω) = 1, (4.4)
φ
Prop,(m)
i (γi, ω) ∈ [0, 1], ∀i,m.
Although we remove the collision constraint, the maximization problem is still hard to deal
with since the access policy is still embedded in the derivation of probability function P(m)i (·).
In the following we will develop an iterative algorithm to solve the optimal channel access
policy for the problem (4.4).
By observing the above problem, if the probability function PProp,(m)i (γ(m)i , ω) are known,
the maximization problem becomes a linear programming (LP) program, where the optimal
channel access policy is given by
φ
Prop,(m)
i (γi, ω) =
 1, if m = argmaxm′ ω(m′)PProp,(m
′)
i (γ
(m′)
i , ω) log
(
1 +
γ
(m′)
i
2WN0/M
)
,
0, otherwise.
(4.5)
For the ease of representation, we define a new variable
G
(m)
i (γ
(m)
i , ω) , ω(m)PProp,(m)i (γ(m)i , ω) log
(
1 +
γ
(m)
i
2WN0/M
)
(4.6)
26
Step 2: Update PProp,(m)i (γ(m)i , ω) as:
PProp,(m)i (γ(m)i , ω) =
L∏
j=1
j 6=i
1−
∫ ∞
γ
(m)
i
E[φ
Prop,(m)
j (γj, ω)|ω, γ
(m)
j ]f(γ
(m)
j )dγ
(m)
j ,
where
E[φ
Prop,(m)
j (γj, ω)|ω, γ
(m)
j ]
=
∫
γ
j
\γ(m)j
1
G
(m)
i ≥ G(m
′)
i ∀m′ ∈ {1, ...,M}
f(γ
j
\γ(m)j )d(γj\γ
(m)
j ).
We will repeat Step 1-2 until the access policy φ
Prop,(m)
j and the probability function PProp,(m)i
converge. ¤
Though the channel access policy can be numerically found by the proposed iterative
algorithm, we cannot explicitly express the relationship between the access probability with
the channel gain vectors and the belief vectors. And we can see that, if the number of
channels M increases, the complexity of the iterative algorithm will exponentially increases.
In the following we will study two special channel-access strategies, where the channel access
probability will depend on only the gain vector of each SU or the belief vector, referring to
as the Gain-Based Strategy and the Belief-Based Strategy.
4.1.2 Gain-Based Strategy
Gain-based strategy allows SUs to choose channel based on its own channel gains only.
Without the knowledge of the belief on all channels, each SU will choose the channel on
which its channel gain is the largest among those of the other channels to maximize its
throughput. To be more specific, under any belief ω and gain vector γ
i
, the probability that
SU i is attempting to access the m-th channel will be determined according to the channel
28
4.1.3 Belief-Based Strategy
On the other hand, we assume that SUs choose the channel with the highest idle probability
to prevent colliding to the PUs. As for the belief-based strategy, the channel access policy
can be given by
φ
Belief,(m)
i (ω) = 1[ω(m)≥ω(m′),∀m′∈{1,2,...,M}] (4.10)
Following the same analyzing procedure as in the gain-based strategy, we first calculate the
probability
Pr
{
SU j choose the m-th cahnnel
∣∣ω, γ(m)j , γ(m)i ,ΦBelief,(m)i = 1}
= Pr
{
SU j choose the m-th cahnnel
∣∣ω,ΦBelief,(m)i = 1}
= 1.
Hence,
PBelief,(m)i (γ(m)i , ω) =
L∏
j=1
j 6=i
1−
∫ ∞
γ
(m)
i
1 · f(γ(m)j )dγ(m)j
=
L∏
j=1
j 6=i
1− exp
(
−γ
(m)
i
σ2
)
=
[
1− exp
(
−γ
(m)
i
σ2
)]L−1
.
It can be easily shown that
PBelief,(m)i (γ, ω) ≤ PGain,(m)i (γ, ω), ∀γ ∈ [0,∞).
This is due to the fact that in the belief-based strategy, SUs will always choose the channel
with the highest idle probability and, thus, all the SUs competing on the same channel
simultaneously1.
1If there are multiple channels on which the idle probabilities are the same and also the highest ones
among all channels, SUs will randomly select one of the idlest channels with equal probability.
30
we have
Γ
pi,(m)
lower (ω) = (F
pi,(m)
max )
−1
(
1−min
{
1,
pcol
(1− ω(m))
})
. (4.14)
Please note that, the distribution of the channel gain of the transmitting SU on each
channel will depend on the belief vector and the channel access policy. Given the belief
vector ω and the channel access policy, the cdf function can be formulated by
F pi,(m)max (γ) =E
[
1
[γ≥γ(m)j ·Φpi,(m)j ,∀j∈{1,2...,L}]
∣∣∣ω]
=
L∏
j=1
E
[
1
[γ≥γ(m)j ·Φpi,(m)j ]
∣∣∣ω] (4.15)
=
L∏
j=1
{∫ ∞
0
1
[γ≥γ(m)j ·1]
Pr
{
Φ
pi,(m)
j = 1
∣∣∣ω, γ(m)j } f(γ(m)j )dγ(m)j
+
∫ ∞
0
1
[γ≥γ(m)j ·0]
Pr
{
Φ
pi,(m)
j = 0
∣∣∣ω, γ(m)j } f(γ(m)j )dγ(m)j }
=
L∏
j=1
{∫ γ
0
Pr
{
Φ
pi,(m)
j = 1
∣∣∣ω, γ(m)j } f(γ(m)j )dγ(m)j
+ 1[γ≥0] ·
∫ ∞
0
Pr
{
Φ
pi,(m)
j = 0
∣∣∣ω, γ(m)j } f(γ(m)j )dγ(m)j } (4.16)
=
L∏
j=1
{
1−
∫ ∞
γ
Pr
{
Φ
pi,(m)
j = 1
∣∣∣ω} f(γ(m)j )dγ(m)j }, (4.17)
where the first term is the probability that SU j did choose the m-th channel and his channel
gain is smaller than γ, and the second term is the probability that SU j did not choose the
m-th channel. By utilizing the three channel access policy discussed in the previous section
(i.e., the proposed channel- and SOS-aware channel access policy, gain-based policy, and the
belief-based policy), we will characterize the cdf F
pi,(m)
max (γ) and find the thresholds {Γpi,(m)lower }
to guaranteing the collision probability to the primary network.
32
we have
FGain,(m)max (γ) =
L∏
j=1
∫ γ
0
Pr
{
Φ
Gain,(m)
j = 1
∣∣∣ω, γ(m)j } f(γ(m)j )dγ(m)j
+
∫ ∞
0
Pr
{
Φ
Gain,(m)
j = 0
∣∣∣ω, γ(m)j } f(γ(m)j )dγ(m)j
=
L∏
j=1
∫ ∞
0
Pr
{
Φ
Gain,(m)
j = 1
∣∣∣ γ(m)j } f(γ(m)j )dγ(m)j
+
∫ ∞
0
Pr
{
Φ
Gain,(m)
j = 0
∣∣∣ γ(m)j } f(γ(m)j )dγ(m)j
−
∫ ∞
γ
Pr
{
Φ
Gain,(m)
j = 1
∣∣∣ γ(m)j } f(γ(m)j )dγ(m)j
=
L∏
j=1
1−
∫ ∞
γ
[F (γ
(m)
j )]
M−1f(γ(m)j )dγ
(m)
j
=
L∏
j=1
[
1− 1
M
+
[F (γ)]M
M
]
=
[
1− 1
M
+
[F (γ)]M
M
]L
,
where 1− 1
M
is the probability that SU j did not choose the m-th channel, and 1
M
· [F (γ)]M
is the probability that SU j chose the m-th channel and the channel gain of m-th channel is
smaller than γ.
To meet the collision constraint, as given in (4.14), we set
Γ
Gain,(m)
lower (ω) = (F
Gain,(m)
max )
−1
(
1−min
{
1,
pcol
(1− ω(m))
})
= −σ2 log
1− [(1−M min{1, pcol
1− ω(m)
})1/L
−M + 1
]1/M . (4.19)
4.2.3 Interference Constraint under Belief-Based Channel Access
Strategy
Suppose that SUs always choose the channel with the highest idle probability. Given the
belief vector ω, let denote byM , {m : m = argmax
m
ω(m)} be the index set of channels that
34
Chapter 5
Simulation
We evaluate the throughput of SUs by exploiting the proposed reservation-based MAC pro-
tocols and channel-aware channel-access policy by computer simulations.
Consider a cognitive radio network operated in a licensed spectrum with bandwidth
W = 3 MHz and noise variance N0 = 10
−6 watts/Hz. Before each transmission, the AP will
perform the spectrum sensing with duration TS = 3 ms and then broadcast pilot symbols
within duration TC = 20 µs. The SUs will reserve the channel following the channel-aware
reservation scheme by utilizing K minislots which is Tmin = 20 µs long. The SU who
successfully reserved the spectrum will transmit its data within TD = 10 ms. The AP will
then feed back the acknowledgement with time duration TACK = 20 µs.
For the single channel scenario, Fig. 5.1 and 5.2 show the relationship between the
network throughput and the number of SUs with K = 4 and K = 6 minislots respectively.
Suppose that the PUs activate half of the time, that is, the idle probability of the spectrum
is v0 = 0.5, and that the spectrum sensing detector of the AP of secondary network is with
sensing errors
PFA = 0.1, PM = 0.05.
And the channel gain between each SU to the access point is exponentially distributed with
36
0 20 40 60 80 100 120 140 160 180 200
1.6
1.8
2
2.2
2.4
2.6
2.8
3
x 10
6
number of SUs
av
er
ag
e 
th
ro
u
g
h
p
u
t 
(b
it
s/
se
co
n
d
)
Proposed Protocol with Sensing Errors (upper bound)
Proposed Protocol with Sensing Errors
Proposed Protocol with Sensing Errors (exhaustive search)
Figure 5.2: Network throughput versus the number of SUs with K = 6 and v0 = 0.5
searching for the optimal threshold, that is, solving the following problem under all belief ω
max
Γ1-chlower(ω)
R1-ch(ω)
subject to P 1-chlower(ω) ≤ min
{
1,
pcol
(1− ω)
}
.
So we can see from the simulations that the throughput under the suboptimal transmission
strategy almost coincides with the average throughput under the optimal transmission strat-
egy (that is, the optimal threshold) found by exhaustive search with a sufficient large K.
It is also worth to mention that the gap between the upper bound of network throughput
and the actual throughput becomes neglectable small, which encourage us to use the upper
bound of throughput rather than the actual throughput as the performance metric in the
multi-channel scenario to lead to a simple solution for the optimal reservation threshold on
the channel gain.
Consider that the whole spectrum is partitioned into M = 3 channels and all the other
38
3 4 5 6 7 8 9 10
2.2
2.4
2.6
2.8
3
3.2
3.4
3.6
3.8
4
4.2
x 10
6
number of users
av
er
ag
e 
th
ro
u
g
h
p
u
t 
(b
it
s/
se
co
n
d
)
Belief−based
Gain−based
Proposed
Figure 5.4: The upper bound of average throughput, v
(1)
0 = v
(2)
0 = 0.1, v
(3)
0 = 0.9
Suppose that the idle probabilities among channels are asymmetric, let say, v
(1)
0 = v
(2)
0 =
0.1, v
(3)
0 = 0.9, the throughput is depicted in Fig. 5.4. In this case, channel 1 and channel
2 are almost busy all the time, while channel 3 is almost idle. The intuition behind this
figure is that, when the difference of idle probability among channels is large, the belief-
based channel access policy may outperform the gain-based strategy, especially when the
number of SUs are small. Recall that in Fig. 5.3, we show that with symmetric spectrum idle
probabilities, choosing channels merely depend on the channel gains is better. When we focus
on the throughput of cognitive radio networks with asymmetric spectrum idle probabilities,
choosing the channel with the highest gain is not always the best policy. However, if the
number of SUs increases, in other words, the multi-user diversity gain increases, the gain-
based policy will be better than the belief-based policy. By the way, we can see that our
proposed strategy actually capture this feature, choosing the channel with the higher idle
probability and also with higher channel gain, and, thus, outperform either the belief-based
40
Table 5.1: Simulation setting
SNR(m) P
(m)
FA P
(m)
M
-11.5dB 0.1 0.0173
-12.5dB 0.1 0.0734
-13.5dB 0.1 0.1809
-14.5dB 0.1 0.3171
-15.5dB 0.1 0.4506
PU signal samples collected at the AP. Assume the number of samples N = 2500. Suppose
that the PU’s signal to the noise ratio received at the AP on the third channel is -11.5dB,
while the received SNR on the first and second channels are varying from -11.5dB to -15.5dB,
the miss detection probability is then given in Table 5.1. Fig.5.4 shows the upper bound of
throughput in the scenario that both the idle probability and the detection error probabilities
are all asymmetric among channels. With the detection error probabilities summarized in
Table 5.1 and assume that the number of SUs are L = 5, we can see that the belief-based
channel access policy performs much better than the gain-based policy. The reason is because
that the gain-based strategy mainly focuses on exploiting multi-user diversity, which does
not have much gain on throughput when the total number of SUs are small. Moreover, when
the spectrum utilization and the sensing reliability among channels are extremely different,
seizing the opportunity for a successful transmission and finding a channel that is most
probable to be idle is much more important.
42
Chapter 7
Appendix
7.1 Proof of Lemma 1
Suppose that g(n) is a decreasing function with n. It is true that for some positive integer
N , ∫ N
0
g(n)dn =
N∑
n′=1
∫ n′
n′−1
g(n)dn
(a)
≤
N∑
n′=1
∫ n′
n′−1
g(n′)dn
=
N∑
n′=1
g(n′),
where (a) applies since that g(n) is a decreasing function of n and g(n) ≥ g(n′) for all n′ ≥ n.
Hence, we complete the proof.
44
[7] P. Viswanath, D. N. C. Tse, and R. Laroia, “Opportunistic beamforming using dumb
antennas,” IEEE Transactions on Information Theory, vol. 48, pp. 1277-1294, 2002.
[8] S. Adireddy and L. Tong, “Exploiting decentralized channel state information for random
access,” IEEE Transactions on Information Theory, vol. 51, pp. 537-561, 2005.
[9] X. P. Qin and R. A. Berry, “Distributed approaches for exploiting multiuser diversity
in wireless networks,” IEEE Transactions on Information Theory, vol. 52, pp. 392-413,
2006.
[10] S.-H.Wang and Y.-W. P. Hong, “Transmission control with imperfect CSI in channel-
aware slotted ALOHA networks,” submitted to IEEE Transactions on Wireless Commun.,
2008.
[11] Shu-Hsien Wang and Y.-W. Peter Hong, “Channel-Aware Reservation-Based MAC Pro-
tocol for Cognitive Radio Networks”, in Proceedings of APSIPA Annual Summit and
Conference, 2009.
[12] X. Qin and R. Berry, “Opportunistic Splitting Algorithms for Wireless Networks,” Proc.
of the IEEE INFOCOM’04, vol. 3, pp. 1662-1672, 2004.
46
R
e
s
e
r
v
a
ti
o
n
Fig. 1. System flow of secondary networks.
The goal is for SUs to access the spectrum without colliding
with PUs. To do so, the secondary network’s AP will perform
spectrum sensing periodically by itself at the beginning of
each slot. Suppose that the AP has M sets of transceivers
and is capable of sensing all channels simultaneously and
then broadcast the sensing outcomes to all SUs. Denote by
{D(m)}Mm=1 ∈ {0, 1} the sensing outcomes of all channels,
where D(m) = 0 refers to the case that the spectrum of
channel m is sensed to be idle and D(m) = 1 refers to
the case that the spectrum of channel m is sensed to be
occupied by PUs. The performance of spectrum sensing can
be characterized with the false alarm probabilities {P (m)FA }Mm=1
and the miss detection probabilities {P (m)M }Mm=1. Given the
sensing outcomes and these two sensing errors, each SU can
evaluate the idle probability of each channel as
ω(m)(D(m)) = Pr{H(m)0 is true∣∣D(m)} (1)
=

v
(m)
0 (1−P (m)FA )
v
(m)
0 (1−P (m)FA )+v(m)1 P (m)M
, if D(m) = 0,
v
(m)
0 P
(m)
FA
v
(m)
0 P
(m)
FA +v
(m)
1 (1−P (m)M )
, if D(m) = 1.
We refer ω(D) = (ω(1)(D(1)), ..., ω(M)(D(M))) to as the be-
lief vector under the sensing outcomes D = (D(1), ...,D(M)).
After sensing spectrum states, the AP will broadcast pilot
symbols to help each SU estimate the channel between the AP
to itself. Assume that the uplink and downlink channels are
reciprocal and the channel gain on the m-th channel between
SU i and the AP, denoted by γ(m)i , is assumed to be identical
and independently distributed (i.i.d.) among users and across
time with density f(γ(m)i ) and cumulative distribution function
(CDF) F (γ(m)i ). Let define the channel gain vector of SU i,
γ
i
=
(
γ
(1)
i , γ
(2)
i , ..., γ
(M)
i
)
,
as the local channel state information (CSI) of SU i. Suppose
that each SU is equipped with only one set of transceiver such
that it can access only one channel at each time instant (i.e.,
transmit or receive signals on only one channel at a time).
Based on the local CSI and the sensing outcomes (thus, the
belief vector), each SU will select one channel to access and
then perform the channel reservation on the chosen channel.
Let denote by
φ
(m)
i (γi, ω) : ([0,∞)M × [0, 1]M )→ [0, 1]
the probability that SU i decides to reserve and transmit on the
m-th channel, where φ(m)i is referred to as the channel selec-
tion policy of SU i on channelm with
∑M
m=1 φ
(m)
i (γi, ω) = 1.
We adopt the reservation-based MAC protocol proposed in
[11] where each SU will emit reservation packet to the AP
opportunistically on the chosen channel according to its local
CSI, and a channel-aware splitting algorithm is used to resolve
the collision among reservation packets from different SUs.
By doing so, with sufficient time allocated for SU to emit
reservation packets, the SU with the highest channel gain
among all SUs will be admitted of transmission. The system
flow of the secondary network is shown in Fig.1.
When a SU transmits on the m-th channel, we say that
a collision occurs if the PU signals is actually transmitting
on the same channel (i.e., H(m)1 is true). In order to prevent
from colliding with PU signals, the SUs should carefully
determine their transmission probability. As proposed in [11],
we set a threshold on the channel gain when performing the
channel reservation, where only the SUs whose channel gain
is greater than Γ(m)lower(ω) can reserve channel m. Let denote
by P (m)t (ω) the probability that at least one SU transmit on
the m-th channel given the belief vector ω. With sufficient
time for channel reservation, we can approximate the transmit
probability by [11]
P
(m)
t (ω) = Pr{at least one SU whose gain ≥ Γ(m)lower(ω)}
≈ 1− F (m)max(Γ(m)lower(ω)), (2)
where F (m)max(γ) is the CDF of the highest channel gain among
the SUs competing on channel m. For example, if there are
exactly ` SUs competing on channel m, F (m)max(γ) = [F (γ)]`.
We can see that the transmission probability of SUs decreases
as Γ(m)lower(ω) increases. To constrain that the probability of
colliding with PUs should not be greater than pcol, that is,
the following inequality must hold:
Pr{at least one SU transmits, H1 is true}
= P (m)t (ω) ·
(
1− ω(m)
)
≤ pcol, (3)
⇒ P (m)t (ω) ≤ min
{
1,
pcol(
1− ω(m))
}
, m = 1, ...,M, (4)
we should carefully choose appropriate {Γ(m)lower(ω)}Mm=1 to
satisfy the above equation. However, the difficulty in designing
{Γ(m)lower(ω)}Mm=1 is that the exactly number of SUs competing
on the same channel will depend on the channel selection
policy and can vary across time.
In the following, we devise a channel and sensing aware
channel access policy (including channel selection and reserva-
tion threshold design) that maximizes SUs’ throughput under
a constraint on the probability of collision with PUs.
III. CHANNEL ACCESS POLICY
Since the CSI is i.i.d. among users and the belief vector
will be known at all SUs, maximizing the sum throughput
of all SUs will be the same as maximizing the individual
throughput of each SU. Thus, for SU i, we will have the
0 20 40 60 80 100
1
2
3
4
5
6
7 x 10
6
number of SUs
a
ve
ra
ge
 th
ro
ug
pu
t (b
it/s
ec
on
d)
 
 
Throughput under Proposed Policy
Throughput under Gain−Based Policy
Throughput under Belief−Based Policy
Fig. 2. Throughput of SUs with v(m)0 = 0.5 for all m and pcol = 0.05.
IV. SIMULATION
Consider a cognitive radio network operated in a licensed
spectrum with bandwidth W = 3 MHz and noise variance
N0 = 10−6 watts/Hz, where the whole spectrum is partitioned
into 3 equal-bandwidth channels. Suppose that the idle prob-
abilities of the 3 channels are v(m)0 = 0.5 for all m. The AP
of secondary networks senses the spectrum states periodically
with errors PFA = 0.1 and PM = 0.05. The channel gain
between each SU to the AP is exponentially distributed with
mean equal to 4. Fig. 2 shows the network throughput under
the proposed channel and sensing aware channel access policy
and the other two strategies. Under the gain-based policy, each
SU selects the channel with the best channel quality regardless
of the sensing outcomes. Under the belief-based policy, each
SU always selects the channel whose idle probability is the
highest among the three, leaving the other two channels unused
even if they are idle. Hence, the throughput under the belief-
based policy may be much worse than the other two policies.
The reason that the throughput drawn from gain-based strategy
almost reaches that under the proposed strategy is because that
the idle probabilities among channels are identical. Thus, it is
sufficient to choose channel merely depend on channel gain
to improve the throughput on each channel.
Suppose that the idle probabilities among channels are
asymmetric, let say, v(1)0 = v
(2)
0 = 0.1, v
(3)
0 = 0.9, the
throughput is depicted in Fig. 3. The intuition behind this
figure is that, when the difference of idle probabilities is large,
the belief-based channel access policy may outperform the
gain-based strategy, especially when the number of SUs are
small. Choosing the channel with the highest gain is not always
a good policy when the idle probabilities diverse. However, if
the number of SUs increases, that is, the multi-user diversity
gain increases, the gain-based policy will be better than the
belief-based policy again. By the way, our proposed channel
and sensing aware channel access policy actually captures the
feature of both gain-based and belief-based policies, and, thus,
strikes a good balance between them.
3 4 5 6 7 8 9 10
3
3.5
4
4.5
5
5.5 x 10
6
number of SUs
a
ve
ra
ge
 th
ou
gh
pu
t (b
its
/se
co
nd
)
 
 
Throughput under Proposed Policy
Throughput under Gain−Based Policy
Throughput under Belief−Based Policy
Fig. 3. Throughput with v(1)0 = v
(2)
0 = 0.1, v
(3)
0 = 0.9, and pcol = 0.05.
V. CONCLUSION
We proposed a channel and sensing aware channel access
policy for multi-channel cognitive radio networks. Each SU
will choose one channel to access according to both the
sensing outcomes and the local CSI to improve its throughput,
and then reserve for transmission on the chosen channel if its
channel gain is sufficiently large. An iterative algorithm was
proposed to devise the channel selection policy. Our proposed
reservation-based channel access policy outperforms the cases
when SUs access the channel based on only the knowledge of
local CSI or idle probabilities of all channels.
REFERENCES
[1] “Spectrum policy task force report,” Federal Communications Commi-
sion, Report, Et docket No. 02-135, November 2002.
[2] J. Mitola and G. Q. Maguire, “Cognitive radio: Making software radios
more personal,” IEEE Personal Communications, vol. 6, pp. 13-18, 1999.
[3] Qianchuan Zhao, S. Geirhofer, Lang Tong, B.M. Sadler, “Opportunistic
spectrum access via periodic channel sensing,” IEEE Transactions on
Signal Processing, vol. 56, pp. 785-796, 2008.
[4] Y. Chen, Q. Zhao, and A. Swami, “ Joint design and separation principle
for opportunistic spectrum access in the presence of sensing errors,” IEEE
Transactions on Information Theory, vol. 54, pp. 2053-2071, 2008.
[5] K. Liu, Q. Zhao, and Y. Chen, “ Distributed Sensing and Access in Cog-
nitive Radio Networks,” International Symposium on Spread Spectrum
Techniques and Applications (ISSSTA), Aug. 2008.
[6] R. Knopp and P. A. Humblet, “Information capacity and power control
in single-cell multiuser communications,” IEEE International Conference
on Communications (ICC), 1995.
[7] P. Viswanath, D. N. C. Tse, and R. Laroia, “Opportunistic beamforming
using dumb antennas,” IEEE Transactions on Information Theory, vol.
48, pp. 1277-1294, 2002.
[8] S. Adireddy and L. Tong, “Exploiting decentralized channel state infor-
mation for random access,” IEEE Transactions on Information Theory,
vol. 51, pp. 537-561, 2005.
[9] X. P. Qin and R. A. Berry, “Distributed approaches for exploiting mul-
tiuser diversity in wireless networks,” IEEE Transactions on Information
Theory, vol. 52, pp. 392-413, 2006.
[10] S.-H.Wang and Y.-W. P. Hong, “Transmission control with imperfect
CSI in channel-aware slotted ALOHA networks,” IEEE Transactions on
Wireless Commun., Vol. 8, No. 10, pp. 5214-5224, 2009.
[11] Shu-Hsien Wang and Y.-W. Peter Hong, “Channel-Aware Reservation-
Based MAC Protocol for Cognitive Radio Networks”, APSIPA Annual
Summit and Conference, 2009.
[12] X. Qin and R. Berry, “Opportunistic Splitting Algorithms for Wireless
Networks,” IEEE INFOCOM, vol. 3, pp. 1662-1672, 2004.
進行的研究方向。下午則在 SPCOM-P9: Secrecy and Communications 的 poster session
中發表了名為 A Game Theoretic Approach to Eavesdropper Cooperation In MISO 
Wireless Networks 的論文(現場情形請見項目三的照片)。 
 05/27 星期五是會議的最後一天，早上整理行李，從飯店 checkout 之後即到機場候
機。本人及隨行的黃元豪教授搭乘下午 17:30 的飛機由捷克布拉格經阿姆斯特丹，
於 05/28 星期六晚間 18:15 抵達桃園國際機場，完成此次的旅程。 
 
二、與會心得 
本次參與在捷克布拉格舉辦的 2011 IEEE International Conference on Acoustic, Speech 
and Signal Processing 國際會議，收穫良多，遇到許多國外的友人，如 University of 
Minnesota的 Prof. Tom Luo、University of Southern California的 Prof. C.-C. Jay Kuo、KAIST 
University 的 Prof. Youngchul Sung、香港中文大學的 Prof. Wa-Kin Ma、Army Research Lab
的 Dr. Ananthram Swami 等，並受到 University of California at Los Angeles 的 Prof. Mihaela 
van der Schaar 的邀請，希望未來能去 UCLA 進行實質的互訪和合作。ICASSP 是一個包
含主題非常廣泛的會議，在參與會議的過程中，有機會對於非自己專長的其他領域有更
多的認識，也有機會與許多國際學者面對面的接觸。特別是在生醫應用愈趨重要的今日，
能夠聆聽國際學者如何利用訊號處理技術來解決生醫的問題，收穫良多。  
本次在會議中發表的論文名為 “A Game Theoretic Approach to Eavesdropper 
Cooperation in MISO Wireless Networks”。在此論文中，我們討論竊聽者間互相合作所可
能面臨的風險，並利用 game theory 的概念，找出竊聽者的最佳策略。此研究有助於改善
未來實體層保密傳輸系統的設計。在會議中，我們得以與許多國際學者做深入的討論，
並得到許多的寶貴的意見。未來希望利用這些意見來更加提升我們的研究成果。 
 
三、會議參加過程的照片(請見下頁) 
 
 
 
 
 
 
國科會補助計畫衍生研發成果推廣資料表
日期:2011/10/25
國科會補助計畫
計畫名稱: 子計畫四：具通道感知之合作式網路存取技術
計畫主持人: 洪樂文
計畫編號: 98-2221-E-007-059-MY2 學門領域: 網路
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
獲得獎項：在計畫執行期間曾獲得以下獎項 
- 2011 Y. Z. Hsu Scientific Paper Award (有庠科技論文獎) 
- 2010 IEEE ComSoc Asia-Pacific Outstanding Young Researcher Award 
- 2010 Junior Faculty Research Award from National Tsing Hua University 
(新進人員研究獎) 
 
(研究成果亦幫助博士生 王淑賢 獲得聯發科技獎學金。) 
 
 
學術活動：在計畫執行期間，曾協助舉辦 VTC2010Spring 以及 ISITA2010。 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
