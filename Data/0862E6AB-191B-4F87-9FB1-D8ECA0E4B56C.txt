  
行政院國家科學委員會補助專題研究計畫■成果報告    
□期中進度報告 
 
小型人形機器人之設計、研製及應用－子計畫五： 
行為策略與 FPGA 模組之研發及其於人形機器人足球賽之應用(3/3) 
 
 
計畫類別：□ 個別型計畫  ■ 整合型計畫 
計畫編號：NSC 95－2221－E－032－057－MY3 
執行期間：97 年 8 月 1 日至 98 年 7 月 31 日 
 
計畫主持人：翁慶昌   淡江大學電機工程學系 
共同主持人： 
計畫參與人員： 黃楷翔    淡江大學電機工程學系 
               楊玉婷    淡江大學電機工程學系 
               詹翔閔    淡江大學電機工程學系 
               胡越陽    淡江大學電機工程學系 
成果報告類型(依經費核定清單規定繳交)：□精簡報告  ■完整報告 
 
本成果報告包括以下應繳交之附件： 
□赴國外出差或研習心得報告一份 
□赴大陸地區出差或研習心得報告一份 
□出席國際學術會議心得報告及發表之論文各一份 
□國際合作研究計畫國外研究報告書一份 
 
 
處理方式：除產學合作研究計畫、提升產業技術及人才培育研究計畫、
列管計畫及下列情形者外，得立即公開查詢 
          ■涉及專利或其他智慧財產權，□一年■二年後可公開查詢 
          
執行單位：淡江大學電機工程學系 
 
中 華 民 國 九 十 八 年 十 月 三 十 一 日
  II
Abstract 
The main purpose of this project is to design and implement a robot soccer system for humanoid 
soccer game. Four topics of mechanical structure, electronic system, human machine interface, 
and behavior strategy are considered to design in this project. Humanoid robots with 26 
degree-of-freedoms is design and implement to be autonomous soccer robots, which can process 
the image information by themselves and have the fundamental abilities to play soccer. 
Furthermore, humanoid robots will be designed so that they can stand by only one leg, walk 
forward, walk backward, turn left, turn right, rotate, walk sideway, shoot ball, and throw ball. 
Two processors of μ’nsp and NIOS II are used for the system of the humanoid robot. μ’nsp is a 
16-bit DSP processor which is used to obtain image information extracted from a CMOS image 
sensor. The strategy system of the humanoid robot is also built on it. NIOS II is a 32-bit 
embedded soft-core processor which is used to control the motion of actuators and receive the 
data of the other sensors, such as the electronic compass, force sensor, and G-sensor. FPGA 
modules around the NIOS II CPU can be designed by using the hardware description language to 
realize motion control of humanoid robot and the function of autonomous balance. In the 
behavior strategies design, the functions such as penalty kick, obstacle run, and tracking along a 
line are design and implemented. Furthermore, some behavior strategies about multiple humanoid 
robots are proposed such that they can cooperate with each other to win the soccer game. 
 
Keywords: robot soccer game, soccer robot, humanoid robot, autonomous mobile robot, 
behavior strategy. 
 
  IV
六、參考文獻 57 
七、計畫成果自評 58 
 
  2
三、 文獻探討 
自 1966 年，Waseda University 發表了全世界第一台的類人形機器人，打開了人形機器
人開始序幕的第一章。自此而後投入人形機器人的研究前仆後繼從未間斷。國內學業界在
人形機器人的研究上亦有一些相關研究成果，微星科技研發的 E2R-H3 智慧型機器人，除
了能靈活運用全身關節平衡行走外，還具備人臉偵測及語音辨識能力。而日本可說是世界
上最熱中人形機器人研究的國家，HONDA 汽車公司於西元 2000 年發表其所研發的自走
機器人 ASIMO (Advanced Step in Innovative MObility)，其主要特色為具有立體視覺與即時
控制的自主式雙腳步行移動方式。依靠著機體上的兩個陀螺儀，ASIMO 便可在平坦地面上
的行走運動。研發 ASIMO 的目的主要是用來當作一種能在人類生活空間內，如家屋中的
樓梯、房間等地多用途使用的機器人。SONY 公司亦於 2003 年發表 QRIO[1]，不但會跳舞
還可以在 1 公分的凹凸地面行走，上 10 度的斜坡，被推倒之後還能自己站起來，亦可透過
立體視學進行避障與路徑規畫，身高只 58 公分、體重也只 6.5 公斤，可說是向家用人形機
器人的目標又邁進了一大步。 
在過去的幾十年間，對於架構自主式機器人(autonomous robot)，也即是具有獨立行為
能力機器人的研究一直沒有間斷。較早期的研究著重在機器人智慧的給予與機器人學習的
策略，在這個部份大多就程式模擬的結果來討論，直到近年來才有學者將知識與學習的策
略直接應用在機器人實體上。而要達到這樣的目的，除了要有良好的演算法外，機器人結
構與感測器的設計均需詳細的規畫與製作，所以整個難度也相對提高許多。這幾年，國外
學者更廣泛探討分散式的自主式機器人如何有效的分工合作，主要包括機器人能力的提升
以及相互之間的整合、互動、溝通與合作等研究主題。應用範圍包括如何讓一群機器人共
同有效的完成一個指定任務，或探討一群機器人如何改善整體任務的性能，此外如何發展
一套公平的裁判方式來評估自主性機器人發展的優劣也是探討的重點之一。機器人足球賽
便是在這種期待之下被提出來，機器人足球賽(robot soccer games)就是以數個機器人組成的
隊伍在一定的規格限制與規則下做踢球的比賽。機器人踢足球看似遊戲，但是其可以實際
展示一個國家人工智慧、信息處理和自動化技術的實力，所以機器人足球賽目前已成為 21
世紀國際學術研究與現代高科技研究的一項重點。因為機器人足球賽集合了計算機、資訊、
電子、無線通信、影像處理、數學、力學、機械、自動控制、感測器、人工智慧等涉及眾
多領域的高科技，其可以有效培養學生的動手能力、創造能力和協調合作精神。目前在國
際上有兩大機器人足球聯盟(RoboCup 與 FIRA)在推動此項研究，且在每年都會舉辦世界
盃機器人足球大賽以及國際性研討會。機器人足球世界聯盟RoboCup之成立目標是『在2050
年發展一個可以贏過人類世界盃足球冠軍隊伍之全自主式人形機器人隊伍』，所以其方法與
  4
模擬人類頭部上下自由度之伺服機，其功用為使機器人的視覺系統可以上下轉動。標示 2
為模擬人類頭部左右自由度之伺服機，其功用為使機器人的視覺系統可以左右轉動。 
 
圖 4.2、頭部自由度示意圖 
(b)馬達規劃概念 
由於考慮到整個人形機器人要輕量化，再加上頭部的伺服機只要支撐 CMOS 感測器，
因此本子計畫採用重量輕且扭力低之伺服機。台灣廣營(GWS)公司所出產的 MICRO MG 型
號的伺服機，不僅重量輕而且價格也便宜，5.40 (kg - cm)的扭力已經足夠驅動 CMOS 感測
器做上下與左右的轉動，相當適合搭配於頭部。 
表 4.1、MICRO MG 伺服機規格表 
MICRO MG 伺服機規格 
外型尺寸 28*14*29.8(mm) 
扭力 5.40 (kg-cm) 
速度 0.14 (sec/60°) 
重量 28.0 (g) 
工作電壓 4.8 (V) 
可動作角度 180 (度) 
 
4.1.2 手部機構 
 手部機構設計的目的在於使得人形機器人可以撿起球，並提供人形機器人於跌倒爬起
時支撐起地面所需的維度。手部機構設計的概念包括：(a)自由度規劃概念與(b)馬達規劃概
念，其分別敘述如下。 
(a)自由度規劃概念 
 本子計畫之人形機器人機構於雙手部份各規劃了 4 個自由度。如圖 4.3 所示，圖中的
  6
4.1.3 腰部機構 
  腰部機構設計的目的在於使得人形機器人可以做出前後傾與左右轉動的動作，腰部機
構設計的概念分包括：(a)自由度規劃概念與(b)馬達規劃概念，其分別敘述如下。 
(a)自由度規劃概念 
本子計畫之人形機器人機構於腰部部份各規劃了 2 個自由度。如圖 4.4 所示，標示 1
為模擬人類腰部的前後搖擺自由度之伺服機，其功用為使人形機器人的腰部可以前後搖
擺。但考量到如果只以單一支撐軸的話對於該伺服機的負荷會太大，因此於裝設此維度伺
服機身體的另一邊，再加裝設伺服機轉盤來輔助轉動並提供另一支撐點以減輕此伺服機之
負擔。標示 2 為模擬人類腰部左右轉自由度之伺服機，其功用為使人形機器人的腰部可以
左右轉動。 
 
圖 4.4、腰部自由度 
(b)馬達規劃概念 
由於腰部於彎腰取物或旋轉上半身時，皆需要支撐整個上半身的重量，因此腰部的每
一顆伺服機都必須使用大扭力的伺服機。而 KONDO 公司所出產的 KRS-4014HV 型號的伺
服機扭力可達 40.8(kg - cm)且為全金屬齒輪，相當符合我們的需求，適合搭配於腰部。 
表 4.3、KRS-4014HV 伺服機規格表 
KRS-4014HV 伺服機規格 
外型尺寸 43*32*32.5 (mm) 
扭力 40.8 (kg-cm) 
速度 0.19 (sec/60°) 
重量 65 (g) 
工作電壓 9 ~ 12 (V) 
可動作角度 260 (度) 
 
  8
 
圖 4.6、腳部自由度示意圖  
 
(b)馬達規劃概念 
由於腳部須在執行各式移動動作時支撐整個人形機器人之重量，因此腳部的每一顆伺
服機都必須使用較大扭力的伺服機。而 KONDO 公司所出產的 KRS-2350HV 型號的伺服機
扭力可達 29.5 (kg - cm)且為全金屬齒輪，相當符合我們的需求，適合搭配於腰部。此外，
由於髖關節旋轉自由度之伺服機，因為需支撐旋轉整隻腳時所受的力，同時考量機構設計
上的強度與方便性，因此髖關節旋轉自由度之伺服機則另行選用與腰部同款之伺服機
KRS-4014HV。 
表 4.4、KRS-2350HV 伺服機規格表 
KRS-2350HV 伺服機規格 
外型尺寸 41*38*20(mm) 
扭力 29.5(kg-cm) 
速度 0.13(sec/60°) 
重量 62(g) 
工作電壓 9 ~ 12(V) 
可動作角度 180(度) 
 
4.2 人形機器人之系統控制核心與 FPGA 模組設計 
人形機器人以 NIOS II 發展板做為系統控制核心，利用 VHDL 開發人形機器人系統週
邊 FPGA 模組，並透過 C++所撰寫系統控制核心與各 FPGA 模組連結，實現出人形機器人
  10
 
圖 4.8、人機介面與 NIOS II 傳輸架構 
由於 RS232 與 NIOS II 之間資料的傳輸是以 TXD 和 RXD 來執行資料相互傳輸的功能，
所以本子計畫利用 NIOS II 上的 PIO 規劃腳位作為 TXD 與 RXD 的腳位，利用 I/O 中斷的
方式與 RS232 做連接，進行雙方資料的相互傳輸。 
 
4.2.2 資料分析模組 
此模組主要目的是接收 RS232 傳輸模組所傳來的封包資料，而從 RS232 傳輸模組接收
到的資料分為兩大類：對 Flash 進行存取的資料封包與指令封包。資料分析模組可將由人機
介面傳來的資料進行解碼的動作，判別經由 RS232 所傳輸的封包資料是對 Flash 進行存取
的資料封包，或是給機器人下達執行動作的指令封包，資料分析模組之架構如圖 4.9 所示。
資料分析模組分析出傳輸的封包格式後，再對 “Flash 存取模組” 或 “動作執行模組” 下達
動作命令。從 RS232 傳輸模組所接收到的封包，是以”FE”為封包的起始資料，”FC”為封包
的結束資料，中間包含著指令或是對 Flash 進行存取的資料，如表 4.5 所示。 
 
 
 
圖4.9、資料分析模組 
RS232 
transmission
module 
1bit 8bit 
1bit Data 
Human- 
machine 
interface 
NIOS II 電腦端 
Data 
analysis 
module 
Flash
存取模組
資料分析模組
Erase
Program
動作執行
模組
Program
解
碼 Erase
Execute
Sensors
命
令
感測器接收模組
RS232
傳輸模組
  12
給動作執行模組，而動作執行模組在接收到要讀取的資料位址後，動作執行模組會經由
Flash 存取模組讀取 Flash 中指定位址的資料，讀出動作的馬達數值，然後執行動作；當指
令封包中的第三筆和第五筆資料分別為 F2 和 00 時（Disable Sensor），則停止接收 Sensor
傳來的資料；當指令封包中的第三筆和第五筆資料分別為 F2 和 01 時（Enable Sensor），則
開始接收 Sensor 傳來的資料。 
表 4.6、指令封包 
1 2 3 4 5 6 7 
FE FD Order1 Order2 Order3 Order4 FC 
 
表 4.7、指令封包中的命令 
 Order1 Order2 Order3 Order4 
Chip Erase F0 00 00 00 
Sector Erase F0 01 Sector 01 
Execute F1 00 Sector Bank 
Disable Sensor F2 00 00 00 
Enable Sensor F2 00 01 00 
 
動作執行模組接收到資料分析模組給的 address 資料後，並在從 Flash 存取模組讀出馬
達資料的狀態時，資料分析模組不會執行 Program、Erase Chip、Erase Sector、Disable Sensor
和 Enable Sensor 的動作，若執行這五個動作，則會更動到 Flash 存取模組內的馬達數值，
導致動作執行模組所讀出的馬達資料產生錯誤。相對的，當資料分析模組給予 Flash 存取模
組執行 Program 和 Erase 的動作時，資料分析模組並不會傳送 Execute 的指令給動作執行模
組；也就是動作執行模組讀出各個馬達資料的動作，和 Flash 存取模組做 Program 和 Erase
的動作不能同時進行。 
 
4.2.3 感測器接收模組 
 感測器接收模組連結 RS232 傳輸模組和資料分析模組，如圖 4.10 所示，目的為決定是
否接收感測器的資料。它是由一個二對一的多工器所構成，當人機介面藉由 RS232 傳輸模
組傳一筆接收感測器資料的封包時，多工器就會選擇開始接收感測器的資料；反之，多工
器則會選擇接收其它的指令封包。 
  14
(c) Erase 函式 
alt_erase_flash_block( fd , test_offset , regions->block_size ); 
表 4.10、Erase 函式變數的名稱意義 
名稱 意義 
fd 開頭的指標 
test_offset 清除的起始位址 
regions->block_size Setor 的大小 
 
4.2.5 動作執行模組 
動作執行模組連結 Flash 存取模組和馬達執行模組，如圖 4.11 所示，目的為讀取 Flash
的資料並給予馬達執行模組。當所有的動作值存入 Flash，資料分析模組輸入執行指令和開
始的位址到動作執行模組後，動作執行模組對 Flash 讀取過程如圖 4.12 所示。首先動作執
行模組給予 Flash 存取模組位址和讀取致能訊號，等到 Flash 存取模組發出讀取結束訊號，
動作執行模組立即讀取下一個位址和送出讀取致能的訊號給 Flash 存取模組，然後再一次等
待Flash存取模組的讀取結束訊號，之後動作執行模組不斷的重複致能讀取訊號和等待Flash
存取模組的讀取結束訊號，並且配合溝通的協定，如表 4.11 所示，以“Time”決定這個動作
要連續執行的次數，在第二筆資料時若獲得“FD”，表示之後有二十六筆數值為基本動作的
馬達值，像站立、手舉高等。在第六筆到三十一筆之間一旦從 Flash 存取模組獲得資料，馬
上致能馬達執行模組，但是在給予第三筆資料前，也就是第一顆馬達時，要從馬達執行模
組得知馬達為閒置狀態，否則會改變正在動作的馬達，而造成錯誤動作。在第三十二筆的
“MotionDelay”代表每個動作和每個動作之間的延遲，是為了機器人做完一次動作，能夠穩
定一段時間，因為機器人在進行毎個動作之間，馬達執行每週期為 1.4 ms，比起系統振盪
週期 40 ns 長很多，因此加入“MotionDelay”的協定。在第三十三筆的資料若為 FC，表示之
後的位址已沒有存放馬達值，將再次等待資料分析模組傳入新的命令。不過如果第三十三
筆不是 FC，就表示還要進行馬達的加減動作，像手臂從下慢慢往上舉等動作，並且記錄接
下來的動作要連做幾次。在第三十四筆所獲得的 B.Delay 功能如同 MotionDelay，可是
B.Delay 是對每次加減動作的延遲，而 MotionDelay 是一連串動作做完後的延遲，所以
B.Delay 是小動作之間的延遲，而 MotionDelay 是大動作之間的延遲。第三十五筆到第六十
筆的加減動作如同第六筆到第三十一筆一般，不過由於加減動作往往不只一次，而且馬達
動作時間遠大於 Flash 讀取時間，因此動作執行模組會把第三十五筆的位址儲存起來，方便
下一次重複執行時，可以重新地給與馬達加減值，如此可以減少電路的使用面積，而且不
  16
表 4.11、動作執行的封包格式 
1 Class 
2 Repeat Time 
3 FD 
4 Times 
5 B.Delay 
6~29 Motor1~24 
30 Motion Delay 
31 FC(Time) 
32 B.Delay 
33~56 Motor1~24 
57 Motion Delay 
58 FC(Time) 
59~86 Repeat4~30 
… Con. 
 
表 4.12、動作執行封包的名稱意義 
封包名稱 意義 
Time 執行次數 
FD 封包開始 
M# 第幾顆馬達的基本動作值 
Motion Delay 動作與動作之間的延遲時間 
B.Delay 每次執行加減動作之間的延遲時間 
MA# 第幾顆馬達的加減動作值 
FC 封包結束 封包結束 
Con 連接下一個 Flash 的 Sector 
 
4.2.6 馬達控制器模組 
馬達控制器模組是負責將動作執行模組傳出的馬達資訊轉換成伺服馬達控制訊號，並
傳送至伺服馬達。如圖 4.13 所示，動作執行模組送給馬達執行模組的角度資料分成固定角
度與加減角度兩種，透過這兩種角度資訊來控制伺服馬達的轉動，以實現出機器人的運動
控制，角度資料的封包格式如表 4.13 與表 4.14 所示。 
  18
 
圖 4.14、壓力感測器裝載圖 
利用 ZMP 的變化進而設計出一套運用於人形機器人身上的模糊平衡系統架構，而機器
人為了平衡一定需要一些平衡動作，本子計畫為此而設計了四種平衡動作，分別為：(A)
踝關節前傾修正、(B)踝關節後傾修正、(C)踝關節左傾修正與(D)踝關節右傾修正，共四種
平衡動作再加上(E)無動作修正，一共五種的基本動作。 
在 ZMPx、∆ZMPx、ZMPy與 ΔZMPy四個輸入的數值下，可以藉由圖 4.15 的模糊平衡
系統來得出相對應的修正動作。為了要做到 360 度平衡則需建立兩個單軸模糊控制器，前
後模糊平衡控制器會來決定執行(1)無動作、(2)踝關節後傾修正與(3)踝關節前傾修正，左右
模糊平衡控制器會來決定執行(1)無動作、(2)踝關節左傾修正與(3)踝關節右傾修正，兩個控
制器會有兩種不同的數據，因此策略執行模組會把兩邊系統所決定所需要的馬達控制角
度，再根據其結果所對應的動作，將兩套系統所決定出來所需要的馬達控制角度加以合併，
計算馬達角度，將馬達實際角度計算出來。因此壓力感測器主要負責控制腳踝位置的馬達，
做出適合的動作。 
 
圖 4.15、壓力感測器的模糊平衡系統 
 
  20
 
圖 4.17、加速度計的模糊平衡系統 
4.3 人形機器人之人機介面設計 
人形機器人的動作設計會產生相當大的資料量，因此本子計畫設計了人機介面，簡化
使用者設計動作的方式，讓使用者與機器人有一個良好的溝通橋樑。為了讓使用者能對動
作做設計及編輯，並將這些編輯好的動作資料傳送至機器人，且這些資料必須正確無誤，
以避免因資料錯誤而造成馬達與機器人機構上的損傷，所以本子計畫在人機介面上規劃設
計許多功能不同的介面，並且把這些介面整合在同一表單上，避免使用者在編輯動作時一
直在介面間切換，導致混亂。其介面主要有四項：編輯介面、特殊操作介面、傳輸介面與
感測器回傳介面，其分別敘述如下。 
4.3.1 編輯介面 
本子計畫所設計的人形機器人，其自由度高達 24 個(不含頭部 2 個自由度)，針對每一
顆馬達做編輯動作相當不容易，因此本子計畫利用樹狀圖、機器人馬達實際對應圖以及資
料庫三個區塊，設計了一個有效管理且容易編輯的介面如圖 4.18 所示。並且介紹各部份的
功能，其分別敘述如下： 
  22
 
圖 4.19、加減角度提示 
 
圖 4.20、加減角度差 
(c) 資料庫 
如圖 4.18 所示，編號 3 之區域為資料庫之功能，其主要目的在於讓使用者能夠快速的
編輯動作，其介面類似於 EXCEL 之介面，並且使用分頁的方式，可供使用者選擇要編輯的
類型，如圖 4.21 所示。可選則選擇組合動作、加減角度以及固定角度來進行編輯。 
 
圖 4.21、資料庫 
 基於前面的幾項功能，本子計畫便設計了同步動作的功能。先前之編輯方式都是編輯
後，將資料傳送至機器人身上的 Nios II 後，執行動作才能知道結果。這造成了想像與實際
不同的情況，因此本子計畫設計了同步功能，能直接知道動作的執行結果，進而進行動作
  24
(b) 逆向轉換 
跟對稱動作類似，將每一個馬達角度做逆向，讓使用者不必再一一調整馬達角度，加
快調整速度，如圖 4.26 所示。 
 
圖 4.26、特殊操作-逆向轉換 
4.3.3 傳輸介面 
設計好的動作必須傳送至機器人身上的Nios II發展板，因此本子計畫設計傳輸介面，
讓資料能傳送至Nios II發展板的Flash中所指定的記憶體位置。機器人執行自主動作時，是
對應指定Flash中的記憶體位置執行動作，因此必須將動作傳送到Nios II發展板上的Flash
中。針對不同資料量，傳輸介面規劃成兩個傳送介面：(a)單筆傳送介面與(b)多筆傳送介面。
其功能分別敘述如下： 
(a) 單筆傳送介面 
其功能為將單筆的資料依照指定的位置傳送到Flash，如圖4.27所示。其中計算角度的
功能是為了確認動作是否回到原本的動作，其結果將會顯示圖3.4.9左邊的編號1之區域中，
如果回到原本的動作的話，其加起來的值必為零，避免沒有歸位的情況發生。Erase_Sector 
的功能則將指定的Sector 做清除的動作，讓其空間空出來，Erase_Chip則是將有的Sector 清
除掉，如圖3.4.9編號2之區域中。編號3之區域中會將送出的指令顯示出來，確保送的指令
跟預期的一致。 
  26
的狀況能夠被即時監控，讓使用者能夠在各項比賽中能夠快速調整到最好的狀況。 
如圖4.29所示為壓力感測器之回傳介面，左方代表人機介面收集到的八個壓力點的資
訊，計算出零力矩點(ZMP)並於右方顯示出ZMP位於雙腳間之位置，可藉由這些即時資訊
讓使用者了解人形機器人目前平衡的狀況，以及目前姿態ZMP點之變化。 
 
圖 4.29、壓力感測器回傳介面 
如圖 4.30 所示為加速度計的回傳介面，其圖的左方分別代表 X 軸、Y 軸、Z 軸之數值
變化，而右方之圖示則顯示目前加速度計之狀況，可代表姿態之加速度狀況。 
 
圖 4.30、加速度計回傳介面 
4.4 人形機器人之行為策略設計 
人形機器人以凌陽科技的 μ’nsp 做為行為策略設控制核心，並搭配 CMOS 感測器建構
出人形機器人的影像與策略系統。為了簡化設計流程與縮短機器人策略的開發時間，本子
計畫以有限狀態機的架構設計一套行為策略來作為機器人的人工智慧開發平台，如圖 4.31
所示，直接將行為策略平台架構在 μ’nsp 上，透過 CMOS 感測器所取得的影像資訊做為機
  28
移向，當機器人正面對準目標球之後才會開始以前進系列的動作接近目標球，同時會依據
機器人當時頭部二維搜尋機制於垂直方向的角度值來決定前進動作步伐的大小，以高效率
且又穩定的方式達到接近目標球的目的。如圖 4.35 所示為射門策略流程，當在追球策略中
機器人與目標物距離已達一個預設的較短距離後，下個狀態便會進入射門策略，主要目的
是利用較小的動作對於機器人的位置做精確的修正，並判斷是否須確認球門位置，在確認
完機器人踢球腳位置已達目標球前方時，便會執行射門動作，完成動作之後下個狀態就會
又重新回復到找球策略。 
開始
更新影像資訊
執行頭部與身體動作
找球
追球射門
找
到
球
追到球
未到位
遺
失
球踢
完
球
 
圖 4.32、有限狀態機策略主程式流程 
  30
追球
是否有球
是
回到找球狀態
否
球中心Y
是否過上
球中心Y
是否過下
頭上下
是否夠高
頭上下
是否夠低
上下置中
Flag致能
上下置中
Flag禁能
上下置中
Flag禁能
是
否
是
否
否否
是 是
球中心X
是否過左
球中心X
是否過右
頭左右
是否夠左
頭左右
是否夠右
左右置中
Flag致能
左右置中
Flag禁能
左右置中
Flag禁能
是
否
是
否
否否
是 是
上下置中
Flag禁能
上下置中
Flag禁能
頭抬1° 頭低1°紀錄不夠接近1
頭左轉1°頭右轉1°
左右置中
Flag禁能
左右置中
Flag禁能
紀錄不夠接近2
兩Flag是否
皆致能
頭上下是否
低至門檻
頭是否偏左
不夠接近1或
不夠接近2
頭是否偏右
左
平移
右
平移
進入踢球狀態 持續追球狀態
上下與左右置中Flag皆禁能
不夠接近1與不夠接近2清除
上下與左右置中Flag皆禁能
不夠接近1與不夠接近2清除
頭左右置中
頭上下固定往下
是
否
是否
是
否
是
是
直走
否
 
圖 4.34、追球策略流程 
  32
 
圖 4.37、六顆紅外線感測距離之偵測範圍示意圖 
 
圖 4.38、目標方向與機器人方向相對關係示意圖 
本子計畫提出了一個兩輸入與一輸出的模糊避障系統，此兩個輸入分別為紅外線感測
器所量得的機器人與障礙物之間的距離和電子指南針回傳的機器人目前方向與目的地方向
的角度差，所提出的方式可以檢測出機器人分別執行五個動作時的危險性以及對機器人到
達目標點的幫助性，經由這些結果可以讓機器人選出最適合的動作。針對五種不同動作的
五個模糊系統的方塊圖如圖 4.39 所示。此外，若有兩個動作同樣具有最高的適應值時，我
們依照直走 ( 3m ), 左轉 30 度 ( 2m ), 右轉 30 度 ( 4m ), 左平移 ( 1m ), 與右平移( 5m )的優先
順序來選擇。 
1d
1φ 1
f
5d
5φ 5
f
1IRd
6IRd
1Mφ
5Mφ
km
Gφ  
圖 4.39、模糊系統方塊圖 
 
IR1 
IR2 
IR3 IR4 
IR5 
IR6 
目標方向 機器人方向 
  34
糊避障系統的方法，機器人可以有效且正確的選擇適應值較大的動作當下一次執行的動
作以幫助機器人到達目的地。 
Gθ
),( 11 yx
),( 22 yx
Mθ
Oθ
 
(a) 執行右轉 30 度的動作 
Gθ
),( 11 yx
),( 22 yx
5Mθ
Oθ
 
(b) 執行右平移的動作 
圖 4.40、決定 iφ 之動作示意圖  
(2) 決定輸出與輸入變數的論域 
由紅外線感測器所量得的值最遠距離的數值為 80 公分，而電子指南針所量測到目
的地方向與機器人移動後的方向相差角度最大為 180 度，因此在輸入變數範圍的部分，
我們設 ][0,80∈id ， ]100,0[∈iφ ，在輸出變數的部分則為 ]180,0[∈if 。 
(3) 定義語言項與歸屬函數和模糊化策略 
此模糊避障系統輸出與輸入之語言變數如下： 
 F}, N, {C,}A,A,{A)( 321 ==idT  (4. 8) 
  36
(4) 建立規則庫 
此模糊系統之規則庫建立如表 4.15 所示，其每個規則描述如下式： 
Rule： 1 2( ,  )R j j : 
  
1 2 1 2( , )IF  is  and  is  , then  is i j i j i f j jd A B f Cφ , 
 1 2 1 2 {1,  2, 3},   {1,  2, 3},  ( , )  {1,  2, 3}j j f j j∈ ∈ ∈  (4. 11) 
在此模糊系統中我們令後件部的部分為 
          ,1)3 ,2()2 ,2()3 ,1()2 ,1()1 ,1( BCCCCCC fffff ======  
          ,2)3 ,3()2 ,3()1 ,2( NCCCC fff ====  
          GCCf == 3)1 ,3(  
表 4.15、模糊系統之規則庫 
if  
id  
C N F 
iφ  
S B N G 
N B B N 
B B B N 
 
(5) 解模糊 
在此次所提出的模糊系統中，我們利用加權平均法來解模糊並得到此系統的輸出，
其描述如下： 
 
∑∑
∑∑
=
=
=
=
=
=
=
=
⋅
== 3
1
3
1
21
3
1
3
1
) ,(21
1
1
2
2
1
1
2
2
21
) ,(
)() ,(
),( j
j
j
j
j
j
j
j
jjf
iii
jjw
Cvjjw
dff φ
  (4. 12) 
此式中， )( ) ,( 21 jjfCv 為模糊集合 ) ,( 21 jjfC 的輸出值， ) ,( 21 jjw 則是權重值其描述如下： 
 
))(),(min(),(
21
21 iBiA jj
djjw φμμ=
 (4. 13) 
因此在 id 與 iφ 兩個感測器可量測的數值下，五個基本動作都可以藉由這個模糊系統來
得出相對應的適應值 }{1,2,3,4,5, ∈ifi 。最後，機器人可以選擇適應值最大的動作來做
為下一步的動作。 
 
  38
  
圖 4.42、標示點於白色方框相對座標示意圖 圖 4.43、整張影像座標與九宮格分割示意圖
接著再將目標線段於視線範圍內末端點(EndX, EndY)與起始點(StaX, StaY)之座標，於
白色方框之座標系轉換至整張影像畫面之座標系，如此便能獲得目標線段於視線範圍內末
端點(EndX’, EndY’)與起始點(StaX’, StaY’)在整張影像畫面中的座標值，即 p’9 與 p’10，如
圖 4.43 所示。最後將整張影像畫面均分成九宮格，依據目標線起始點與末端點於九宮格中
所座落的相對位置由行為策略系統決定出最適合的動作。另外，考量機器人可能在移動過
程中遺失目標線段，因此當機器人遺失目標線段時，會依據上一刻影像畫面中目標線的起
始點作為優先判斷的依據，因為目標線的起始點即表示機器人在前一刻所在之位置與目標
線相對位置之關係，若目標線起始點位置偏左或偏右，便會直接決定相對應的修正動作，
但如果目標線起始點位置位於影像畫面中間之區域，則會再一併考量上一刻影像畫面中目
標線的末端點位置，才能決定出最適合的修正動作讓機器人朝向遺失目標線的方向移動，
並重新回到循線軌跡追蹤的一般狀態之行為策略，策略流程如圖 4.44 所示。 
  40
4.4.4 多機器人足球賽之行為策略 
當人形機器人具備了基本的移動功能與行為策略之後，接著便是發展機器人足球賽中
多機器人之行為策略。首先，在機器人上場前會先依據現場比賽之需求，先行預設機器人
之腳色，若強調攻擊則可設定成一隻主攻擊員與兩隻輔助攻擊員；若考量一般情況則可設
定成一隻主攻擊員、一隻輔助攻擊員與一隻守門員；若強調防守則可設定成兩隻輔助攻擊
員與一隻守門員。主攻擊員主要負責進攻，主要負責前場的搜尋與進攻敵方球門，就算當
時持球權在對方機器人身上，依然會持續在前半場區域持續搜尋等待進攻機會，最多在中
場附近參與爭球以搶奪進攻權。輔助攻擊員亦可以稱作防守員，主要依據當時為進攻方或
防守方而在工作任務上有所區隔，當己方屬於進攻時，主要負責輔助主攻擊員進攻敵方球
門，隨時準備於主攻擊員遺失球或進攻失敗時適時補上攻擊；當己方屬於防守方時，則主
要負責上前去爭球，針對敵方機器人的進攻進行干擾並搶奪持球權。守門員主要負責防守
球門前區域，針對目前目標球之位置以平移系列動作為主要移動模式來阻擋敵方機器人進
攻路線，在一般情況下守門員並不會離開球門區，除非當目標球已相當接近球門區時，守
門員才會衝出來並將球朝敵方球門方向踢離球門區。 
此外，在比賽進行的過程中，除事先設定的守門員角色之外，其餘機器人的角色皆會
依照己方為進攻方或防守方以及目前該機器人持球與否進行角色的轉換。因考量在實際人
形機器人於機器人足球賽中傳球的成功機率，因此當機器人拿到持球權時，該機器人在角
色上便會轉換成主攻擊員負責朝向敵方球門進攻，其他場上除了守門員之外的機器人在角
色上便會轉換成輔助攻擊員，進而輔助主攻擊員進行進攻，而不會再上前去爭搶持球權。
舉例而言，在比賽進行中若原本的防守員爭搶到持球權後，該機器人角色便會轉換成主攻
擊員去進攻敵方球門，相對的，原本的主攻擊員則不會在場上等待爭搶到持球權的原防守
員將球傳送過來，而是會主動轉換成輔助攻擊員，協助進攻準備隨時上前補踢與接手進攻。 
本子計畫所完成之人形機器人為防止守門員常需撲身擋球，以致於容易導致機構、伺
服機與相關電子電路受損之情況，因此在賽前的機器人角色配置上，一隻主攻擊員、一隻
輔助攻擊員與一隻防守員之配置。主攻擊員位於前場爭取進攻際會，輔助攻擊員位於中場
輔助進攻並協助防守，而防守員則位於後場進行防守與干擾敵方攻門。 
(a) 攻擊員之行為策略 
基本上主攻擊員、輔助攻擊員與防守員之策略設計在歸類上都仍屬於攻擊員之行為策
略，主要因為持球權的與否以及屬於進攻方或防守方而在機器人的角色上會產生轉換與差
異。多機器人足球賽在攻擊員之行為策略設計上，主要是以單一機器人罰踢之行為策略作
為延伸性的應用與變化。主要分成找球、追球與射門策略，其敘述分別如下： 
  42
 
圖 4.45、多機器人足球賽之攻擊員找球策略流程圖 
 
  44
(3) 射門策略 
在射門策略上，不同於罰踢競賽的情況中目標球只會放置於機器人前方特定區域範圍
內，也就等同於目標球始終位於球門前方之區域內，只要確保機器人在射門動作之前能以
正面朝向球門就有進球的機會。因此當機器人確實追到球在起腳射門之前須再確認目前攻
擊方向是否朝向敵方球門位置，若追到球當下並沒有搜尋到敵方球門的位置，機器人便會
執行右護球 90°的動作再次搜尋敵方球門位置，其中的護球動作即以目標球為圓心，機器人
與目標球之間的距離為半徑，繞著目標球做向左旋轉或向右旋轉的動作，目的是在於希望
在搜尋敵方球門的過程中，能確保目標球的位置使中仍位於機器人前方位置，不至於當搜
尋到敵方球門之後反而遺失了目標球之位置。當機器人成功搜尋到敵方球門之後，便會利
用左護球與右護球動作將機器人的方向調整至面向敵方球門的中央位置，接下來便進入只
看目標球而不在確認敵方球門位置的狀態，最後再根據小左平移、小右平移與小直走將機
器人的射門腳調整至適當的起腳位置後，便可執行踢球動作。機器人足球賽之攻擊員射門
策略流程如圖 4.47 所示。 
 (b) 守門員之行為策略 
守門員主要負責固守己方球門與球門區域，本子計畫所完成之人形機器人在動作功能
上並沒有設計撲身擋球之動作，因此在防守上，除了當目標球離球門區過近時，守門員會
衝出球門前將目標球朝敵方球門方向踢開以降低敵方進攻的成功率，其他情況皆以平移系
列動作做為阻擋敵方機器人射門路徑為主要目的。主要分成找球、盯球、追球與衝球策略，
其敘述分別如下： 
(1) 找球策略 
在找球策略上，類似單一機器人罰踢競賽與多機器人足球賽中攻擊員的找球策略，但
畢竟守門員必須固守在球門前，因此不會有任何移動搜尋的功能，只會固定站立在球門中
央區域不斷的進行遠、中、近三段的左右搜尋，因應守門員需面對整個球場，因此在左右
搜尋的段數上，增加了一個將頭部抬得比較高的遠距離搜尋，以確保守門員能隨時掌握球
場上目標球之位置。多機器人足球賽之守門員找球策略流程如圖 4.48 所示。 
(2) 盯球策略 
在盯球策略上，若機器人成功搜尋到目標球之位置後便會進入此策略狀態，其功能主
要是讓守門員在球還離球門區甚遠處，能只利用影像二維搜尋機制鎖定住目前目標球的蹤
跡，而不至於過早進行平移式的射門路徑阻擋，以免造成因過早移動導致球門露出一大片
空檔讓敵方機器人有機可趁。嚴格說起來，守門員的盯球策略類似於攻擊員追球策略中的
前半部之功能。若目標球的位置已移動到較近之距離時，在策略上便會進入下一個追球狀
  46
是否有球
呼叫搜尋函式
是否為
三段搜尋
給定三段搜尋
頭部視線高度
給定一段搜尋
頭部視線高度
紀錄二段搜尋
已經結束
紀錄三段搜尋
已經結束
是
否
是
否
持續找球狀態
是否有球
進入盯球狀態
是
否
找球
是否為
二段搜尋
是
給定二段搜尋
頭部視線高度
紀錄一段搜尋
已經結束
否
 
圖 4.48、多機器人足球賽之守門員找球策略流程圖 
  48
追球
是否有球
球距離
是否過近
是
是
否
回到找球狀態
否
球中心Y
是否過上
球中心Y
是否過下
頭上下
是否夠高
頭上下
是否夠低
上下置中
Flag致能
上下置中
Flag禁能
上下置中
Flag禁能
是
否
是
否
否否
是 是
球中心X
是否過左
球中心X
是否過右
頭左右
是否夠左
頭左右
是否夠右
左右置中
Flag致能
左右置中
Flag禁能
左右置中
Flag禁能
是
否
是
否
否否
是 是
上下置中
Flag禁能
上下置中
Flag禁能
頭抬1° 頭低1°紀錄不夠置中1
頭左轉1°頭右轉1°
左右置中
Flag禁能
左右置中
Flag禁能
紀錄不夠置中2
兩Flag是否
皆致能
頭上下是否
低過低門檻
頭是否偏左
不夠置中1或
不夠置中2
頭是否偏右
是
否
是
否
是
否
是
是
否
左
平移
右
平移
進入衝球狀態 持續追球狀態
上下與左右置中Flag皆禁能
不夠置中1與不夠置中2清除
上下與左右置中Flag皆禁能
不夠置中1與不夠置中2清除
頭左右置中
頭上下固定往下 不動
頭上下是否
高過高門檻
回到盯球狀態
是
否
 
圖 4.50、多機器人足球賽之守門員追球策略流程圖 
  50
般守方隊伍於開球防守時，大多會把機器人配置於球場中央線區域，此時己方主攻擊員取
得持球權後，一抬頭便可馬上確認球門位置，即刻起腳射門，這樣的戰術設計可大大的提
高己方開球時進球得分的機率，另外，因為開球時機器人位置的擺放是由參賽者自行放置，
因此機器人在執行此開球戰術時，便無須去擔心此時機器人本身的自我定位是否精確，或
是其他己方機器人是否確切回傳其所在位置或相關所需資訊，在這樣的地利條件之下，更
增加了此開球戰術的可執行度。開球戰術示意圖如圖 4.52 所示。 
 
圖 4.52、開球戰術示意圖 
五、 結果與討論 
5.1 實驗結果 
本子計畫所完成之人形機器人，於 FPGA 模組研發及其應用上，不但以 VHDL 硬體描
主攻擊員 
輔助攻擊員 
防守員 
敵方機器人 
敵方機器人 
敵方機器人 
  52
架構下，開發出因應不同競賽需求之行為策略。單一機器人罰踢行為策略之實測結果如圖
5.2 所示，其中圖(a)~圖(e)為機器人主要以平移系列之動作移動至正面朝向球的位置；圖(f)~
圖(h)為機器人則主要以直走系列動作移動至球的前方；圖(i)~圖(j)為機器人將踢球腳之位置
微調至球的正前方；圖(k)~圖(l)為機器人將起腳射門得分[9-10]。 
 
(a) (b) (c) 
 
(d) (e) (f) 
 
(g) (h) (i) 
 
(j) (k) (l) 
圖 5.2、單一機器人罰踢行為策略之實測結果 
單一機器人避障行為策略之實驗結果如圖 5.3 所示，其中圖(a)~圖(b)為機器人以直走動作進
入障礙物環境；圖(c)為機器人以左轉動作朝向左前方出口處調整方向；圖(d)~圖(e)為機器
人以直走動作朝左前方出口處前進；圖(f)為機器人以右轉動作將方向修正回正前方並離開
次障礙物環境。 
  54
 
(g) (h) (i) 
 
(j) (k) (l) 
圖 5.4、單一機器人循線軌跡追蹤行為策略之實測結果 
多機器人足球賽之開球戰術實測結果如圖 5.5 所示，其中圖(a)為主攻擊員朝左側邊線以側
踢方式開球；圖(b)~圖(d)為輔助攻擊員朝中場線快速前進並取得控球權；圖(e)~圖(g)為原輔
助攻擊員取得控球權後轉換角色成主攻擊員，並以護球動作繞球旋轉至面向球門之方向；
圖(h)為主攻擊員將踢球腳之位置微調至球的正前方；圖(i)~圖(l)為主攻擊員起腳射門得分。 
 
(a) (b) (c) 
 
(d) (e) (f) 
  56
 
(j) (k) (l) 
 
圖 5.6、多機器人足球賽之防守員回防解球之實測結果 
5.2 結論與建議 
本子計畫於三年內所設計出之人形機器人系統，不但具備能有效執行各種機種動作之
強健的硬體機構，亦提供能讓使用者方便設計與編輯動作的人機介面，在 FPGA 模組研發
及其應用上，以 NIOS II 發展板做為運動控制的系統核心，整合以 VHDL 硬體描述語言所
設計的各式週邊 FPGA 模組，藉由訊息傳輸、資料分析、動作執行、Flash 存取、感測器接
收與馬達控制器等不同功能的 FPGA 模組相互配合，發展出人形機器人的系統發展平台，
讓人形機器人具備基本的感知與行動能力， 同時亦延伸出其他如具有模糊控制器的自主平
衡模組，讓機器人具備了自主平衡的能力並能應用於相關的移動控制中。此外，在行為策
略研發及其應用上，更充分顯現出對於機器人本身所能獲得之環境資訊的有效運用，透過
以有限狀態機制架構所建立起的行為策略系統，除了具備快速開發與容易擴充等優點之
外，更有效的將相關人形機器人於各式機器人足球賽中的不同競賽之策略加以實現，無論
是強調機器人本身功能性的避障行為策略以及循線軌跡追蹤行為策略，或是實際應用於機
器人足球競賽中的罰踢行為策略以及針對多機器人足球賽所發展的攻擊員行為策略與守門
員行為策略，甚至是團體戰術層面的多機器人足球賽開球戰術行為策略，都能充分顯示出
本子計畫之人形機器人於行為策略設計上的功能性與可應用性。綜觀本子計畫所實現之人
形機器人系統於行為策略與 FPGA 模組之設計與應用上之成果，於小型人形機器人之相關
研究領域中可算是相當完整與充實，若將來有機會能在軟硬體平台上進行升級，便能更有
效的開發高深且實用的相關技術，諸如建構專屬的影像策略平台以提供客制化的影像資訊
並延續相關行為策略之研究，整合無線網路發展更詳盡與可靠度更高的團體行為策略，動
作感知於步態規劃實現與即時的姿態修正等，都是將來可繼續延伸並更深入探討與研究的
議題。 
  58
七、 計畫成果自評 
在這三年的時間內，本子計畫於自行架構的小型人形機器人系統平台上持續進行技術
開發，並積極參與各項人形機器人相關的國內外競賽，以進行系統平台的實際驗證並於競
賽中吸收各方專長與特點進而提升研究。以 NIOS II 發展板做為運動控制與感測器應用的
控制系統核心，再透過 VHDL 硬體描述語言架構出 NIOS II CUP 週邊相關電路的 FPGA 模
組，並用於訊息傳輸、資訊分析、感測器接收、Flash 存取、動作執行、馬達控制，同時依
據各式感測器資訊所建構之自主平衡功能與避障行為策略亦在此實驗。另外，架構於 μ’nsp
內的行為策略系統，主要負責需要影像相關資訊的行為策略，在有限狀態機制的概念之下，
分別針對單一機器人之功能與多機器人足球賽之行為策略進行開發，亦有著相當明確與實
際應用之成果。因此本子計畫所實現之人形機器人系統，在研究內容上完全符合”行為策略
與 FPGA 模組之研發及其於人形機器人足球賽之應用”的本子計畫名稱。於學術研究成果
上，本子計畫已有一些相關的期刊論文與會議論文發表，亦曾在「2007 CACS 國際自動化研
討會」之「學生論文競賽」比賽，以「Fuzzy Method Design for Obstacle Avoidance of Humanoid 
Robot」之作品獲得亞軍。此外，本子計畫所實現之人形機器人系統，不單純只提供學術研
究上之價值，其人形機器人實體功能皆有具體且明確的實驗結果，同時，更能因應國際上
兩大機器人足球聯盟 FIRA 與 RoboCup 之人形機器人組的競賽需求，實際參與國際性的機
器人足球賽，其中更於 2007 年在美國舊金山所舉行之「FIRA 機器人足球世界盃：HuroCup
組」比賽中，獲得 Dash 單項冠軍、Penalty Kick 單項冠軍、Obstacle Run 單項冠軍、Weight 
Lifting 單項冠軍、Basketball 單項亞軍、Marathon 單項亞軍與 All Round 全能賽總冠軍；
亦於 2008 年在中國青島所舉行之「FIRA 機器人足球世界盃：HuroCup 組」比賽中，獲得
Penalty Kick 單項冠軍、Obstacle Run 單項冠軍、Weight Lifting 單項冠軍、Dash 單項亞軍、
Basketball 單項季軍與 All Round 全能賽亞軍等優異的成績。因此本計畫就研究內容、達成
目標、學術研究成果與應用價值上，皆有明確且顯著的成果與表現。 
  
