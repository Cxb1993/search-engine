2 
 
中文摘要 
 
對於生物組織的超音波反應特性而言，衰減係數是個重要的參數。一般估測組織的衰減係數
大略可分為利用背散射訊號估測以及穿透訊號估測兩種。其中，背散射訊號的估測方式可適合於
大部分的應用。但是卻有散射成份干擾的困難。應用穿透訊號的方式是較為適合於估測衰減係數，
但是由於必須在組織兩端皆放上探頭，因此只適合體外實驗用。近年來由於超音波對比劑的的技
術成熟，使得我們可以發展一個新方法，使用對比劑來估測體內組織的衰減係數。由於對比劑有
高度非線性的特性，因此我們藉由使用多組頻率激發組織之後的對比劑，我們可應用其所產生的
諧波訊號達到應用穿透訊號估測組織衰減係數的目的。除此之外，我們也應用對比劑在肝組織當
中的分佈比率估測肝組織整體的健康程度。[19-22] 
 
在本計劃中，我們將研究分成三個部份來進行研究：（一.）我們計算經由對比劑回波訊號
中的諧波成分來估測理論中組織的衰減係數，其中必須利用周期譜的方式求得訊號的功率頻譜密
度。（二.）設計一個可用在體內實驗的適應性演算法，用以估測體內組織的衰減係數。並且，對
此法做誤差分析以得知應用此方法估測衰減係數與理論值的差距。（三.）利用動物實驗，將不同
程度的肝臟疾病應用超音波對比劑在肝組織的分佈情形藉以判斷肝病。[19-22] 
 
 
英文摘要 
Attenuation Coefficient (Att. Coef.) is an acoustic parameter for tissue characterization. Two major 
techniques for Att. Coef. Estimation are the backscattering and transmission methods. Backscattering 
method is suitable for general applications, but the speckle interference makes it inaccurate. 
Transmission method is more reliable, but it is suitable for peripheral organs only, due to the need of a 
separate transmitter. With the aid of contrast agent (microbubble), a new way to estimate the Att. Coef. 
of soft tissues is proposed, which is suitable for general applications . Since microbubble is a highly 
nonlinear object, Using the multiple frequencies generated by microbubbles behind the tissue, the Att. 
Coef. Can be estimated in transmission mode. Since the harmonics are generated by common 
microbubbles, their relative strengths can be predicted by theory and measured for Att. Coef. Estimation. 
 
   The research is divided into three parts. First, we use periodogram to estimate the power spectrum of 
echo signals and using the second harmonic component to estimate the theoretical Att. Coef. Secondly, 
we will develop an adaptive algorithm to estimate Att. Coef. Which is suitable for general application. 
Finally, we  use agent distributed in different rates to estimate liver diseases.   
 
 2 
for averaging. The major advantage of time averaging is that the 
TAC can be estimated accurately using echoes from a small 
tissue area.  
To study the feasibility of using the echo of contrast agent 
(microbubbles) for improving TAC estimation, a simplified 
scenario is assumed and shown in Fig. 1 for developing the 
required estimation theories. As shown in Fig. 1, there are two 
separated range gates with a vessel (blood flow) inside each gate. 
The amounts of microbubbles inside the range gates are 
assumed to have an identical distribution. The echo signal from 
the microbubbles are considered to be larger than the echoes of 
their surrounding tissue and the microbubbles inside the tissue. 
The attenuation coefficient of the separating tissue between 
these two vessels are to be estimated based on the echo of 
microbubbles. Let the echo signals of bubbles inside gate 1 and 
2 be (1) ( )x t  and (2) ( )x t , and their power be 
1P  and 2P . The 
difference between them is that (2) ( )x t  is attenuated more than 
(1) ( )x t . If (1) ( )x t  was used as a reference signal, its power 
1P  
could be attenuated to be 
2P . To estimate the additional 
attenuation caused by the separating tissues between the two 
gates, the major requirement is to have accurate estimates of 
1P  
and 
2P . Since the attenuation of 
(1) ( )x t  is common to both of 
(1) ( )x t  and (2) ( )x t , it won’t bother the estimate of the 
attenuation coefficient of the separating tissue. Therefore, in the 
theory and experimental works given latter, (1) ( )x t  is treated as 
the bubble echo without attenuation (i.e., reference signal) and 
(2) ( )x t  is treated as the bubble echo with attenuation.  
Using the nonlinear bubble oscillation equation given by 
Miller[21], we extend it to be a stochastic model of microbubble 
in vascular system after attenuated by tissue. Then some 
statistical property of bubble second harmonics are presented. 
An unbiased and consistent α estimator by narrow band second 
harmonic signals is presented. However, for contrast agents 
designed for medical imaging, they are not the ideal bubble as 
assumed in Miller’s work, the intensity relation between the 
second and fundamental harmonics is not always squarely 
related [19-20], such that the TAC estimator might be biased but 
still consistent. Finally, the performance of the TAC estimator is 
shown experimentally. In the experimental work, we 
demonstrate the biased estimation when using non-ideal 
bubbles.  
II. SIGNAL MODEL 
A signal model for the bubble echo attenuation process is 
presented in this section. Since the two vessels given in Fig. 1 
are different in their depths only, a signal model for a single 
vessel is enough for deriving the TAC estimator given latter. 
The echo attenuation process is to be analyzed based on the 
setup given in Fig. 2. Let    0 cos cs t t  be the interrogating 
signal, which is considered to be a continuous wave with center 
frequency
cf . Based on Fig.2, after attenuation, it becomes: 
   ( , )cosj c cs t L f t                                          (2) 
where ( , )j cL f  is the attenuation factor defined 
as
( ) / 20
( , ) 10 c j
f L
j cL f


 
  . L  is the tissue length and 
jL is the length between the transducer and the j-th 
microbubble in a range-gated vessel. Then  s t  excites the 
bubbles to emit harmonic signals. In most case, the signal 
attenuated by the blood inside the vessel is much smaller than 
that of tissue, therefore we can simplify  s t  into: 
   ( , )cosc cs t L f t                                                  (3) 
Following Miller’s result [21], for a bubble with radius
0 , its 
echo consists of three terms as: 
     1 2s t dc s t s t                                                       (4) 
with 
   1 1s t a s t                                                                   (5) 
and 
 22 2( )s t a s t                                                                   (6) 
where 
1a and 2a are the fundamental and second harmonic 
amplitude responses of microbubble. Values of 
1a and 2a  
depend on the bubble size, bubble resonance frequency and 
other physical constants that characterize the surrounding 
environment of bubbles.  
The bubble signal is then attenuated and received as 
     1 2x t x t x t                                                            (7) 
where  
 1 1( , ) ( )cx t L f s t                                                          (8) 
and 
2 2( ) ( , 2 ) ( ).cx t L f s t                                                       (9) 
Applying (5) and (6) in (8) and (9), it can be shown that 
 1x t and 2 ( )x t  can be rewritten to be 
   1 1 0(2 , )cx t L f a s t                                                   (10) 
and 
   22 2 0(2 ,2 )cx t L f a s t                                                (11) 
Assuming that the size of bubbles are randomly distributed, then 
the frequency depend factors, 
1a and 2a , would become 
random variables 
1A  and 2A . As shown in Fig2, the echo from 
a flow would compose of multiple microbubbles with random 
sizes. In such case, the fundamental harmonic of bubble echo 
can be modeled to be a random signal: 
     1 1
1
( ) 2 , cos
N
c j c j
j
X t u t L f A t  

    (12) 
where ( )u t  is the echo of tissue and it is assumed to be invariant 
from pulse to pulse, N is the number of microbubbles which is 
random, and 1 jA  and phase j  are the random factors of 
bubbles. Unlike bubble echo, the tissue backscattering signal is 
deterministic for a certain A-Line from pulse to pulse. As the 
fundamental harmonic, the second harmonic can be modeled as: 
     2 2
1
2 ,2 cos 2 2
N
c j c j
j
X t L f A f t  

  (13) 
 4 
 qp   could be approximated as: 
  2 2
1
exp
q
qp
 


 
 
  
 
                                                 (24) 
where 2  is the variance of q  and has a value of 62.1  
2
dB . 
Since ˆ  is linearly related to q  as 
1
1 1
ˆ
4
Q
q
qf L Q
  

                                                     (25) 
ˆ  is a Gaussian random variable with 
 ˆE   and 
 
2
2
2
4 f L Q




                                     (26) 
It is easy to know that this estimator is asymptotically consistent, 
if 
 
 
2
2
ˆlim var lim 0
4Q Q cf L Q

 
                                     (27) 
 
To summarize, the properties of this estimator are: 
1) To make the TAC estimator of (25) be unbiased, the 
statistical properties of the harmonic signals of bubbles in 
flow1 and flow2 must be identical. Using the second 
harmonic to estimate TAC may attain this condition and be 
unbiased. However using fundamental harmonic to estimate 
TAC, the estimator will be interfered by tissue 
backscattering signal ( )u t  as given in (12), this will make 
the estimator biased. 
2) When the sample size Q increase, the TAC estimation error 
will be decreased as (27). However, since the fundamental 
harmonic is interfered by ( )u t , this will make the variance 
of TAC estimate, 2 , be larger than that of using the second 
harmonic..  
 
IV. ESTIMATION BIAS DUE TO NON-IDEAL BUBBLE PROPERTY  
For ideal bubble, the amplitude of 
2 ( )s t  is 
2
2 ( , )ca L f . 
However, for non-ideal bubble, the amplitude of 
2 ( )s t  must be 
modified to be 2 ( , )ca L f
 , where   is known as the logarithm 
scale ratio of the fundamental and second harmonic, which 
could be different than 2 [19-20 ] depending on the shell 
property of bubble and thus it is frequency dependent. That is 
the second harmonic amplitude is not the square of the 
fundamental harmonic exactly. Based on this property, the 
attenuated second harmonic echo of (13), the log power 
spectrum of (18) and TAC estimator (23) must be changed to 
be: 
       2 2
1
, , 2 cos 2 2
N
c c j c j
j
X t L f L f A f t    

      (28) 
    2( ) 2 10log 2c cP f f L Y f f                     (29) 
 1 2
1
2 1 1
ˆ
4 4
Q
q q
qc
B B
f L Q

 

 
   
 
                            (30) 
 
Because of scale factor   is unknown, the TAC estimator 
based on the ideal model (13) would become an up- biased 
estimator when   is greater than 2 or an down-biased estimator 
when   is less than 2. It should be noted that the scale factor 
 will not affect the consistency of the TAC estimator. 
Following (30), when the sample size Q increases to infinity, it 
would become: 
2
ˆlim
4Q

 

 
  
 
                                                          (31) 
which means that the consistency is still maintained. 
 
V. EXPERIMENT 
To verify the signal model and demonstrate the performance 
of the proposed TAC estimator, an experiment system as shown 
in Fig.3 is built for collecting bubble signals. It is to be verified 
that TAC can be estimated efficiently using the bubble 
harmonic signals and its precision can be improved by 
increasing the sample size Q . 
A. Experimental Setup 
Fig3 presents the block diagram of the experimental system 
and a phantom, which consists of a silicon tube with diameter 
being 1cm and an overlying fresh pork liver with thickness 
being 1cm. Before experiment, the pork liver is degassed by a 
vacuum machine for two hours. A high speed flowing pump is 
used to generate the flow in the vessel phantom made by silicon 
tube. Dissolution water is filled inside the tube. Free-gas 
microbubbles were injected into the tube to simulate bubble 
flow. Phantom and transducer were placed in a water tank, 
where dissolution water was also used to avoid the measurement 
noise generated by ambient bubble and other scatters.  
The transmitter uses an arbitrary function generator 
(TGA1242 TTI) to generate signals. Then a power amplifier 
(75A250 AR ) is used to generate the signal for the transmitting 
piston (V325, 2.25MHz, 2.5cm, Panametrics). The signal 
power is set at a level that can make the bubbles generate second 
harmonics with SNR around 20dB. 
Bubble echo signals were received by a wideband transducer 
(V309, 5MHz, 2.5cm, Panametrics), which ensures that both the 
first and second harmonics can be received. The signals were 
further amplified by a low-noise amplifier ( 5072 PR 
Panametrics ) before A/D conversion (AD-Link, PCI-9812, 
20MHz, 16bit). The digitalized signals were stored in the PC for 
further processing. 
B. Experimental Results 
For latter comparison, attenuation coefficient of the liver 
sample is measured using the standard transmission mode 
method, which is used as the reference value to identify the 
possible bias of the TAC estimator. To decrease the random 
noise generated by the measurement system, the attenuation 
coefficient is measured 20 times for averaging. The result is: 
 =0.51 dB/cm/MHz. 
 6 
ACKNOWLEDGMENT 
The authors like to thank Dr. Men-Tung Lo for discussion in 
the early stage of this work. 
 
 
REFERENCES 
[1] Parker KJ, Asztely MS, Lerner RM, Schenk EA, Waag RC, “In vivo 
measurements of ultrasound attenuation in normal or diseased liver,” 
Ultrasound Med. Biol., vol.4, 127–136, 1988. 
[2] Maklad NF, Ophir J, Balsara V, “Attenuation of ultrasound in normal 
liver and diffuse liver disease in vivo,” Ultrason. Imag., vol. 6, pp. 
117–125, 1984. 
[3] Roman Kuc and Mischa Schwartz, “Estimating the acoustic attenuation 
coefficient slope for liver from reflected ultrasound signals,” IEEE Trans. 
Sonics Ultrason., vol. 26, no.5, pp. 353-362, 1979 
[4] R. Kuc, “Estimating acoustic attenuation from reflected ultrasound 
signals: comparison of spectral-shift and spectral-difference approaches,”  
IEEE Trans. Acoust. Speech Signal Process., vol. 32, pp. 1-6, 1984 
[5] Ping He and James F. Greenleaf, “Application of stochastic analysis to 
ultrasonic echos-estimation of attenuation and tissue heterogeneity from 
peaks of echo envelope,” J. Acoust. Soc. Amer., vol.79 no. 2, pp. 526-534, 
1986. 
[6] Ping He, “Acoustic attenuation estimation for soft tissue from ultrasound 
echo envelope peaks,” IEEE Trans. Ultrason., Ferroelect., Freq. Contr., 
vol. 36, no. 2, pp. 197-203, 1989. 
[7] Varghese T, Ophir J, “Characterization of elastographic noise using the 
envelope of echo signals,” Ultrasound Med. Biol., vol. 24, no. 4, pp. 
543-555, 1998 
[8] M. J. Cloostermans and J. M. Thijssen, “A beam corrected estimation of 
the frequency dependent attenuation of biological tissues from 
backscattered ultrasound,” Ultrason. Imag., vol. 5, no. 2, pp. 136–147, 
1983. 
[9] Z. F. Lu, J. A. Zagzebski, E. L. Madsen, F. Dong, “A Method for 
estimating an overlying layer correction in quantitative ultrasound 
imaging,” Ultrason. Imag., vo1. 7, pp. 269-290, 1995. 
[10] H. Kim, J. A. Zagzebski, and T. Varghese, “Estimation of ultrasound 
attenuation from broadband echo-signals using bandpass filtering” IEEE 
Trans. Ultrason., Ferroelect., Freq. Contr., vol. 55, no. 5, pp 1153-1159  
2008. 
[11] Parker K. J, Wagg R. C, “Measurement of ultrasonic attenuation within 
regions selected from B-scan images,” IEEE Trans. Biomed. Eng., vol. 30, 
pp. 431– 437, 1983; 
[12] Walach E, Shmulewitz A, Itzchak Y, Heyman Z., “Local tissue 
attenuation images based on pulse-echo ultrasound scans,” IEEE Trans 
Biomed. Eng. Vol. 36, pp.211–221, 1989. 
[13] S. L. Bridal, B. Beyssen, P. Fornes, P. Julia, G. Berger, “Multiparametric 
attenuation and backscatter images for characterization of carotid 
plaque,” Ultrason. Imag., vol. 22,  pp. 20-34, 2000. 
[14] K.K. Shung and G.A. Thieme, Ultrasonic Scattering in Biological Tissues, 
CRC Press, Boca Raton, FL, 1993. 
[15] Perter D. Bevan , Michael D. Sherar, “B-scan ultrasound imaging of 
thermal coagulation in bovine liver: log envelope slope attenuation 
mapping” Ultrasound Med. Biol., vol. 27, no. 3, pp.379-387, 2001 
[16] K. J. Peters, R. C. Waag, D. Dalecki and J. G. Mottley, “Estimation of 
local attenuation from multiple views using compensated video signals,”  
Acustica, vol. 79, pp. 251-258, 1993. 
[17] B. Zhao, O. A. Basir, and G. S. Mittal, “Estimation of ultrasound 
attenuation and dispersion using short time Fourier transform,”  
Ultrasonics, vol. 43, pp. 375-381, 2004. 
[18] Shigao Chen, Mostafa Fatemi, Eileen McMahon, James F. Greenleaf, 
Mark Belohlavek, “Spectral compensation for tissue attenuation and 
transmit intensity in ultrasounic detection of microbubbles by harmonic 
method,” Proc. IEEE, Ultrason. Symp., pp. 982-985, 2004. 
[19] William T. Shi and Flemming Forsberg, “Ultrasonic characterization of 
the nonlinear properties of contrast microbubbles,” Ultrasound Med. 
Biol., vol. 26, pp. 93-104, 2000. 
[20] De Jong N., Cornet R. and Lancee, C. T., “Higher harmonics of vibrating 
gas-filled microspheres. part two: measurements” Ultrasonics. vol.32, pp. 
455-459, 1994 
[21] D. L. Miller, ”Ultrasonic detection of resonant cavitation bubbles in a 
flow tube by their second-harmonic emissions,” Ultrasonics., vol. 9, pp. 
217-224, 1981. 
[22] L. Hoff, ”Acoustic properties of ultrasonic contrast agents,” Ultrasonics, 
Vol. 34, pp. 591-593, 1996 
[23] K. E. Morgan, P. A. Dayton, D. E. Kurse, A. L. Kliabanov, G. H. 
Brandenburger, and K. W. Ferrara, “ Changes in the echoes from 
ultrasonic contrast agents with imaging parameters,” IEEE Trans. 
Ultrason., Ferroelect., Freq. Contr., vol. 45, no. 6, pp. 1537-1548, 1998. 
[24] Men-Tzung Lo, Jenho Tsao, and Darong Su, “Volume scattering of 
distributed microbubbles and its influence on blood flow estimation,” 
IEEE Trans. Ultrason., Ferroelect., Freq. Contr., vol. 50, no. 12, pp. 
1699-1710, 2003 
[25] J. A. Jensen, Estimation of Blood velocities using ultrasound: a signal 
processing approach. New York: Cambridge University, 1996 
[26] P. Tortoli, M. Pratesi, and V. Michelassi, “Doppler spectra from contrast 
agents crossing an ultrasound field,” IEEE Trans. Ultrason., Ferroelect., 
Freq. Contr., vol.  47, no. 3, pp. 716-725, 2000. 
[27] P. N. Burns, J. E. Powers, D. H. Simpson, A. Brezina, A. Kolin, C, T. 
Chin, V. Uhlendorf, and T. Fritzsch, “Harmonic power mode doppler 
using microbubble contrast agents : an improved method for small vessel 
flow imaging,” Proc. IEEE Ultrason. Symp. 1547-1550, 1994 
[28] G. Guidi, V. L. Newhouse, and P. Tortoli, “Doppler spectrum shape 
analysis based on the summation of flow-line spectra,” IEEE Trans. 
Ultrason., Ferroelect., Freq. Contr., vol. .42, no. 5, pp. 907-915, 1995 
[29] Sheng-Kai Tsao; Jenho Tsao; “Estimation of tissue attenuation 
coefficients using contrast agent, ” Proc. IEEE Ultrason. Symp. 
1572-1575, 2006. 
 
 
 
 
 
 
 
Fig.1. The schematic diagram for estimating tissue 
attenuation coefficient using echoes from two range gates 
XDR 
skin 
tissue 
vessel 
gate 1 
gate 2 
Fig.2. The schematic diagram for deriving the attenuated 
backscattering signal of microbubbles. 
XDR 
skin 
tissue 
vessel 
L 
jL l  
