 2
接使用數位相機來取像來得到一個二維的
亮度（brighness）矩陣時，很不幸的，其
並 不 能 做 為 該 景 中 亮 度 真 正 幅 射
（radiance）的量測 [1,2,3]。現實的情況
是，在真實世界中的幅射（radiance）與相
片中的像素值存在著一個非線性的對應關
係，例如當幅射低於某個臨界值時，在數
位相片中即無法顯現其差異，而只能皆以
最暗─0 來表示之；同樣地，當幅射強過某
一臨界值時，數位相片也只能以最亮─255
來紀錄該像素的強度。由上面的說明，我
們可以很明顯地看出，拍攝所得之數位相
片的動態範圍（dynamic range）是相當小
的。所謂“動態範圍＂就是指一個景或影
像中最亮與最暗的對比值。我們以圖 1 來
說明一般相片之動態範圍不足的問題。圖
1(a)為我們眼睛所看到的真實景物，注意，
我們可以看到漂亮的藍天部份；(b)為我們
以一般數位相機所拍得的相片，很明顯
的，相片中的天空幾為死白，這就是所謂
“動態範圍＂不足所造成。 
 
 
圖 1 動態範圍不足的問題 
 
而高動態範圍（high dynamic range）
影像在許多領域，例如電腦圖學、影像處
理、影像顯示等也正變得愈來愈普遍且愈
來愈重要 [3]。有許多學者指出，其在許多
應用上都能得到比一般以低動態範圍影像
（LDR）影像有更好的結果 [3-5]，例如打
光模擬（ light simulation）及移動模糊
（motion blur）等。一般來說，有二種方法
可以產生高動態範圍影像，一是由硬體設
備的改進，例如富士新推出之稱為 HDR 
CCD 之感光元件，其藉由結合兩種不同感
光度的 CCD，而可以提高比傳統 CCD 提
高約四倍的動態範圍；而另一種方法就是
結合多張以不同曝光時間拍攝的LDR影像
來合成一張所謂的高動態範圍影像  [3, 
6-9]。 
在 HDR 影像的合成部份，Debevec [3] 
提出一個有效且簡單的方法來把多張以不
同曝光時間拍攝的LDR影像合成一張高動
態範圍影像。但是此方法並沒有考慮真實
數位相片中的雜訊問題。另外我們也發現
其在LDR影像上的取樣點亦是該方法的關
鍵。雜訊問題與取樣點的好壞會大大影響
所計算出之相機響應函數（camera response 
curve），進而決定合成 HDR 影像的結果。
所以我們先利用雙向濾波器（ bilateral 
filter）來去除數位相片中的雜訊，接著提
出一個基於 K-means 之影像分割法來決定
其取樣點位置，以有效改善所求得之相機
響應函數的精確性，而得到更完美的 HDR
影像。此外我們也觀察到 Debevec [3] 所用
的三角形權重函數，如式(1)所示。 
 
⎪⎪⎩
⎪⎪⎨
⎧
+>−
+≤−
=
)(
2
1
)(
2
1
)(
maxminmax
maxminmin
ZZzforzZ
ZZzforZz
xw  (1) 
 
其會導致所合成 HDR 影像在高亮度的區
域容易有不好的雜點產生，圖 2 為其實作
的結果，我們可以發現在檯燈的燈管部份
有明顯雜點產生，而該區域正是整張 HDR
影像中亮度最亮的部份。所以我們在本研
究中也將探究該類雜點產生之原因，並提
出一新的權重函數來修正此一問題，且確
保所計算出之 HDR 影像有高對比的高品
質。 
 
 
圖 2 以 Debevec 法所合成之 HDR 影像 
 
三、研究方法 
 4
對合成之高動態範圍影像有非常大的影
響。如前一節所提，以原論文中所提之三
角形權重函數，如式(1)所示，所合成之 HDR
影像具有高反差的高品質但是在高亮度的
地方常會有不好的雜點產生，如圖 2 所示。
根據我們實際檢驗的結果發現，其原因主
要是來自於原論文所使用的三角形權重函
數。一個簡單的檢驗方法即是把該權重函
數改成 ( ) 1=xw ，即等於取消權重函數。結
果發現這樣便不會有雜點產生，但是所合
成之 HDR 影像品質卻變差了，尤其在亮度
區域的反差對比變得很不好。仔細探究其
原因，我們發現不同權重函數會導致所求
出之相機響應函數會有很大的不同，而前
面所言，其正是整個 HDR 影像合成的關
鍵。所以在本研究中我們提出使用 Gaussian
的權重函數來解決此一問題，以保持其合
成之 HDR 影像有高對比高品質。最後我們
將以 Durand [10] 等提出的方法來將 HDR
影像之動態範圍壓縮成一般顯示器所能顯
現之 LDR 影像來驗證我們的結果。 
 
四、研究結果與討論 
為了去除雜訊的影響，我們先對 LDR
影像以雙向濾波器處理後再轉到 RGB 色彩
空間中以 K-means 來做影像分割，圖 5 為
其結果，(a)與(b)分別為沒有與有經過經雙
向濾波器之分群結果，可以明顯發現雙向
濾波器可以有效去除雜訊並提升 K-means
分群的正確性。 
 
 
(a)                (b) 
圖 5 K-means 分群結果 
 
而 K-means 分群後之每個群的中心即是我
們的取樣點，其結果如圖 6 所示，可以看
出其能 RGB 不同頻帶中之不同亮度分布區
段都能有取樣點，且避開了可能造成之錯
誤結果的影像邊緣區域。 
 
 
圖 6 以 K-measn 所計算出之取樣點位置 
 
接著為了探討取樣點對相機響應函數
與合成之 HDR 影像之影響，我們比較了三
種方法：(1)取樣點都偏在較暗的柱子處；
(2)在影像平面上均勻取樣；(3)以 K-means
做影像分割後每個類別中心為取樣點。圖 7
為其所求出之相機響應函數之結果。  
 
-4
-3
-2
-1
0
1
2
3
1 51 101 151 201 251
Z
ln
(E
)
均勻分布 10點
K-means   10點
牆角附近 10點
 
圖 7 不同取樣法所得出之相機響應函數 
 
我們可以發現以 K-means 法所得之曲線較
銳利，而只取牆角附近取樣點之結果最
差。圖8為以不同取樣點法所計算出之HDR
影像之比較，注意天空的部分，我們可以
發現 K-measn 取樣法所得結果之對比
(contrast)較其他方法好。 
 
 
(a)               (b ) 
圖 8 不同取樣法所合成之 HDR 影像 
(a)均勻取樣；(b)K-means 法取樣。 
 
此外我們也探討了 K-means 的計算時
