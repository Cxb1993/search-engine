二、電流注入法負載潮流模型 
以電流注入為基礎(Current-Injection Based)的負載
潮流，它具有良好收斂的效果、快速解耦的特性、最小
記憶體的需求、高穩定性及易與其它設備元件整合等，
並能得到一個快速、簡單的負載潮流模型，所推導出的
亞可比矩陣( Jacobian Matrix )每次疊代時只需對少部
分的元素進行修正，可縮短求解所耗費的時間。 
 
負載匯流排模型 
從圖一，我們可以得到兩項等效電流注入方程式 
 
 
圖一、輸電線等效π 模型 
 
}eb)e(eb)f(fj{g}fb)f(fb)e(e{gI icjiijjiijicjiijjiiji +−+−+−−−−=  (1) 
}eb)f(fg)e(ej{b}fb)f(fb)e(e{gI jcijijijijjcijijijijj +−+−+−−−−=   (2) 
 
接著將 iI , jI 分成實部、虛部分別對狀態變數 ie , 
je  , if  , jf  偏微分，整理後可得誤差方程(3)式 
 
     
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢
⎣
⎡
∆
−−
∆
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢
⎣
⎡
−−−−−
−
=
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢
⎣
⎡
∆
−−
∆
k
i
k
i
GB
BG
k
ii
k
ri
f
e
YY
YY
I
I
|
|
,
,  (3) 
 
實、虛部電壓更新方程式為 
 
kkk
kkk
fff
eee
∆+=
∆+=
+
+
1
1                    
 
從上式中可以看出式(3)中間之矩陣為疊代的亞可
比矩陣，其組成的元素很明顯的可以知道即是Bus i, j
的導納矩陣。再者，整個亞可比矩陣內的所有元素皆為
獨立的常數，與系統的狀態變數無關，故為一個狀態獨
立(State Independent)的常數亞可比矩陣。 
 
電壓控制匯流排模型 
電壓控制匯流排其已知的條件為發電機有固定的
電壓以及固定的實功發電量，且虛功量為未知數，實與
前述之負載匯流排推導過程不盡相同，若要等效成注入
電流，在過程上將會遇到如何將已知值與所推導的負載
潮流模型結合的困難。為解決電壓控制匯流排在電流注
入法上的問題，並能與前面所推導的負載匯流排模型整
合，成為一套完整的電力系統負載潮流模型。 
 
對一電壓控制匯流排而言，其注入的實功量 iP可以
方程式(4)式表示 
ii,iri,i
*
ii,ri,ii
*
iii
IfIe    
])jI)(IjfRe[(e]IRe[VP
⋅+⋅=
++=×=
  (4) 
 
其中 ii jfe + 為發電機端電壓， ii,ri, jII + 為發電機注入
網路的電流，經由對 Pi做泰勒展開，可得到 
 
ii,iri,iii,iri,ii If ∆Ie ∆I ∆fI ∆eP ∆ ×+×+×+×=  (5) 
 
將方程式(3)式代入方程式(5)式中整理後可得 
 
jiijiij
jiijiij
ii,iiji
'
iji
ii,r
'
ijiijii
f ∆)fge(b       
e ∆)fbe(-g       
f ∆)Igfbe(       
e ∆)Ibfg(eP ∆
⋅−+
⋅−×+
⋅+×+×−+
⋅+×+×=
  (6) 
 
其中 
 
cal
i
spec
ii PPP −=∆
 
而對於發電機端電壓，可知 
 
   222
iii feV +=             (7) 
 
同時對 ie 與 if 做泰勒展開後得 
 
   
2
,
2
,
2
2 22
calispecii
iiiii
VVV
ffeeV
−=∆
∆⋅+∆⋅=∆                (8) 
       
整理後便可得出電壓控制匯流排的亞可比矩陣以及誤
差方程式如方程式(9)式所示。 
 
   
⎥⎥
⎥⎥
⎥⎥
⎦
⎤
⎢⎢
⎢⎢
⎢⎢
⎣
⎡
∆
∆
−−
∆
∆
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢
⎣
⎡
−−−−−−=
⎥⎥
⎥⎥
⎦
⎤
⎢⎢
⎢⎢
⎣
⎡
∆
−−−
∆
j
i
j
i
i
i
f
f
e
e
JJ
JJ
V
P
43
21
2 |
|    (9) 
] )(-      )( [ ,
'
1 ijiijiriijiiji bfgeIbfgeJ ⋅−⋅+⋅+⋅=  
] )(      )(- [ ,
'
2 ijiijiiiijiiji gfbeIgfbeJ ⋅−⋅+⋅+⋅=  
] 0      2 [3 ieJ =        ，        ] 0      2 [4 ifJ =  
 
三、 內點演算法之最佳化電力潮流 
由於成本函數為二次式曲線，因此使用二次規劃
法。對較簡單的二次式成本函數的最佳化問題，可用傳
統二次規劃法(Conventional Quadratic Programming)，簡
稱 CQP 的具有接近 λ 疊代法運算速率的效果。以下
介紹 CQP 處理問題的方式 
最後應用內點演算法求解最佳化電力潮流，利用電
流注入法負載潮流模型與預測-校正式內點演算法推導
出最佳化電力潮流模型（Equivalent Current Injection 
Based Optimal Power Flow, ECIOPF），初步考慮之目標
函數與等式與不等式限制條件推導之模型如下： 
 
目標函數： 
  Min.  ∑ ++= cbPaP)f(P G2GG   
等式限制式： 
 ⎪
⎪⎪⎭
⎪⎪
⎪
⎬
⎫
⎪⎪
⎪
⎩
⎪⎪
⎪
⎨
⎧
=+−
=++−
=+−
=+−
0
0
0
0
22 calspec
cal
LoadGen
cal
i
spec
i
cal
r
spec
r
VV
PPP
II
II
  
其中  calrI 表示電流之實部； caliI 表示電流之虛部 
      
22 fe
qfpeI specr +
+=  ， 22 fe
qepfI speci +
−=  
不等式限制式： 
 
⎪⎪
⎪
⎭
⎪⎪
⎪
⎬
⎫
⎪⎪
⎪
⎩
⎪⎪
⎪
⎨
⎧
≤≤
≤≤
≤≤
≤
≤
匯流排電壓
發電機虛功
發電機實功
線路潮流
線路潮流
    VVV
       QQQ
         PPP
                  S
                SS
222
GGG
GGG
22
to
22
from
S  
 
所發展之 ECIOPF程式流程如圖三所示。 
 
 
圖三、ECIOPF之演算流程圖 
四、整數型改良式基因演算法 
混合整數型問題是發生在OPF 中加入非連續的控
制變數，一旦連續型態的問題要考慮到離散的變數將會
使得整個問題描述變的複雜且難以處理。本計劃擬提之
模型為AC負載潮流模型，其有別於DC 模型，相較之
下所提出之模型相當具有強韌性，對系統線路參數之變
動，將改善傳統DC 模型產生收斂解大量偏差之缺點。
其中最佳化負載潮流部分將納入電容器、變壓器抽頭等
參數調整一併進行考量，在不違反任何系統限制條件
下，進行最佳化參數調整。 
為了處理這類的問題，本文參考進化規劃法及禁忌
搜尋法的優點，提出整數型改良式基因演算法，對傳統
GAs針對上述之缺點進行改良。 
1. 離散變數採用整數型式進行編碼，包含OLTC、可
切換式電容器、電抗器組數容量。 
2. 交配與突變改為擇一進行，且交配機率改以機動式
調整，調整方式與此一世代之最佳解之產生方式是
於上一代中以何種方式（交配或突變）產生。 
3. 利用禁區搜尋法之觀念，一些不可行或者曾經出現
過的解將予以記錄，禁止其反覆進入求解之流程
中。所謂禁區有： 
◎該世代中除了最佳解以外已搜尋過的可行解。 
◎區域最佳解。 
◎違反限制條件的解。 
4. 利用菁英選取取代天擇輪盤法。在父代和子代族群
在2k個解中，選取適應值最佳的k個解形成新的父
代的族群，其餘淘汰的解紀錄於禁區表之內。 
利用ECIOPF解決連續變數問題，RGA解決整數問
題，分工合作，發展混合整數人工智慧-最佳化電力潮
流(Mixed Integer Artificial Intelligence-Optimal Power 
Flow；MIAI-OPF )。其修正式基因演算法之執行步驟
如下所示： 
 
步驟一、編碼(Encode)並隨機產生初始族群個體 
以隨機方式產生 n組初始族群個體 
 SΩ=[Ω1,…,Ωj,…,Ωn]    
一個問題所有的決策變數透過某種特定的方式加以編
碼。每個基因代表ㄧ個變數，若因應本計劃所策劃之整
數型問題，則各變數將會被規劃成數個區段，每個區段
將代表其實際值。 
 
步驟二、解碼並計算適應函數 
jΩ 解碼後對應到狀態空間中的一個解 Xj。然後計
算出每一族群個體之適應函數值 
 )G(XΦ jX j =                    
其中 G(Xj)為族群個體 Xj之適應函數。 
適應函數用來評估給定的決策變數(即狀態空間的
可能解)，並且獲得一個值。這個染色體的目標函數值，
就稱為這個染色體的適合度。本計劃針對此步驟採用
ECIOPF作為 RGA之適應函數。 
整合RGA 與ECIOPF 之全部流程如圖六所示。 
 
 
圖六、RGA 與OPF 整合之流程 
 
五、測試結果 
系統以 IEEE 30Bus [11]為計算資料，如圖七所示。
系統中包含 6台發電機、41條輸電線、四部 OLTC及
9個電容組。 
 
26
27 29 30
2122 2324
25
16 17
18
19
20
12 13
14
15
10
1 2
3 4
5
28
11
6
7
8
9
T1
T2
T3
T4 C1
C2
C3
C4
C5
C6
C8
C9
C7
 
圖七、IEEE 30 Bus 系統圖 
 
混合整數型最佳化電力潮流同時處理連續和離散
兩種變數，在離散變數部分分別處理 OLTC 和並聯電
容組設備，此 OLTC 具有 20 段調節設備，上限為
1.05pu，下限為 0.95pu，並聯電容組亦俱備 20段調變，
上限為 10MVAR。此測試分成兩部份進行: i) RGA效能
測試和 ii) 與其他人工智慧比較。由於人工智慧每次所
得之結果均不相同，故本測試執行 50 次 RGA 取其平
均值。其執行結果分別如下: 
i) RGA效能測試： 
參考[11]在四條輸電線中裝設 OLTC元件，其上限
為 1.05pu，下限為 0.95pu，步階為 0.01。其最佳配置結
果如表一所示，最佳運轉成本為 774.7575$/h，平均收
歛次數為 21.82次，平均執行時間為 393秒/次，其平均
收斂結果如圖八所示。 
 
表一、OLTC最佳配置結果 
No. 1 2 3 4 
From/To Bus 6-9 6-10 4-12 28-27 
Best Tap position 0.995 0.995 0.98 0.96 
 
774.4
774.5
774.6
774.7
774.8
774.9
775
775.1
775.2
775.3
775.4
1 6 11 16 21 26 31 36次數
$/h
 
圖八、執行 50次之 OLTC平均收斂次數 
 
參考[6]在九個匯流排中裝設電容組元件，其上限
為 10MVAR，下限為 0MVAR，步階為 0.5MVAR。其
最佳配置結果如表二所示，最佳運轉成本為
774.5135$/h，平均收歛次數為 42.72次，平均執行時間
為 740秒/次，其平均收斂結果如圖九所示。 
 
表二、併聯電容組最佳配置結果 
Shunt No. 1 2 3 4 5 6 7 8 9 
Bus No. 10 12 15 17 20 21 23 24 29 
Best BSH 0 7.5 3 1.5 3 0 8 10 1.5
 
773.8
774
774.2
774.4
774.6
774.8
775
775.2
775.4
775.6
775.8
776
1 11 21 31 41 51 61
次數
$/h
 
圖九、執行 50次之電容組平均收斂次數 
