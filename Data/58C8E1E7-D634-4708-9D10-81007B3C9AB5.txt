1 
行政院國家科學委員會專題研究計畫成果報告 
熔融紡絲機台異常診斷系統 
Development of a fault diagnosis system in melt spinning 
 
計 畫 編 號：NSC 96-2221-E-011-130 
執 行 期 限：96 年 08 月 01 日至 97 年 07 月 31 日 
主 持 人：黃昌群 台灣科技大學高分子工程系 
計畫參與人員：廖建鈞 台灣科技大學工程學院自動控制學程 
高振清 台灣科技大學高分子工程系 
 
一、中文摘要 
本研究提出熔融紡絲機台之加工參數異常
診斷，採用聚丙烯材料，利用田實驗規劃法進
行實驗與設計，而加工參數包含壓出機加熱溫
度曲線、螺桿轉速、齒輪幫浦轉速、冷卻風速
與捲取速度五個因子，搭配張力感測器即時量
測紡絲張力變異，計算訊號雜音比、變異數分
析與信賴區間，根據確認實驗選擇最佳參數組
合，以最佳參數組合為標準，單一顯著加工參
數的改變進行實驗。將實驗結果，利用小波包
變換擷取訊號的資訊，並針對這些子訊號計算
熵和計算原始訊號的標準差值作為特徵向
量。應用三層倒傳遞類神經網路做為分類器，
將異常的特徵向量作為此分類器的輸入，並進
行訓練。由實驗結果顯示，顯著加工參數為壓
出機加熱溫度曲線、冷卻風速與捲取速度，所
提出的方法可以有效及正確的區別三種異常
之顯著加工參數，並可以建立一套自動檢測加
工參數異常的辨識系統。 
關鍵詞：異常診斷、田口法、小波包、倒傳遞
類神經網路 
Abstract 
This study proposes melt spinning fault 
diagnosis, which can diagnose something wrong 
with process parameters. We used the material 
of polypropylene (PP) in experiments and the 
Taguchi method to plan the experiment. Five 
process parameters include the heating 
temperature’s curve of the extruder, formation 
speed, metering pump speed, cooling air speed 
and take-up velocity. The variance of spinline 
tension is measured by a tension sensor and the 
results are used to calculate such data as 
signal-to-noise ratio, analysis of variance and 
confidence interval. The significant factors and 
the best combination of process parameters are 
found by the confirmation experiment. The 
experiments are conducted based on the change 
of a single process parameter. The wavelet 
packet transform of the tension signal is 
obtained, and we compute the feature values of 
entropy from the sub-signal and standard 
deviation from the original signal. A three-layer 
neural network with back-propagation algorithm 
is trained to be a classifier. The experiment 
results show the faults in three signification 
factors, heating temperature’s curve of the 
extrude, cooling air speed and take-up velocity, 
can be effectively and precisely diagnosed. 
Keywords: Fault diagnosis, Taguchi method, 
Wavelet packet transform, Neural network 
二、緒論 
高分子加工製程因機器設備磨損、材料消
耗、定期維修或更換新製程時，致使製程輸出
值偏離預設目標值而影響產品品質，在製程日
益複雜且良率要求極高的產業，如何運用允收
抽樣(Acceptance sampling)、實驗設計(Design 
of experiments)、即時製程資料進行異常診斷
與分類、統計製程管制 (Statistical process 
control, SPC) 、 回 饋 / 前 饋 批 次 控 制
(Feedback/Feedforward run-to-run control)及預
知保養(Predictive maintenance, PM)提醒等技
術，提昇製程品質控制(Quality control)績效，
乃是當前學界與業界極力追求的目標。在製程
品質控制技術之時間演進上，允收抽樣雖然被
3 
(Short-time fourier transform, STFT)方法，可依
照偵測信號特性調整視窗寬度可解決此問題
[13]，但限制於固定視窗(Window)寬度，使頻
率與時間的解析度相互牽制之作用；法國學者
Mallat[14]在研究地震波局部性質時，發現傳
統傅立葉轉換難以達到要求，而引入小波概念
對信號進行分解，藉由多重解析度分析，將複
雜信號分解為單純信號，以探討信號所包含的
資 訊 ； Grossman[15] 藉 適 當 函 數 的 轉 移
(Translation)與擴張(Dilation)將信號分解，此
一有限且具振盪性的適當函數即為小波
(Wavelet) ； 因 連 續 小 波 轉 換 的 冗 餘 性
(Redundancy)和不可實現性(Impracticality)兩
個限制，將其尺度參數與平移參數予以離散化
(Discretization)，即可獲得離散小波轉換；Jin
與 Shi[16]利用 Harr 小波轉換針對多變量品質
特性進行監控，應用群集(Cluster)與 T2 管制圖
偵測隨機資料與異常資料進行分類，建立自動
異常偵測、小波特徵選取、最佳特徵選取與偵
測最佳化之管制方法；Santose 等人[17]提出萃
取不同解析小波轉換係數之絕對值做為類神
經網路輸入資料，辨別脈衝、壓降及暫態振動
等電力受干擾之信號；Elmitwally 等人[18]應
用預先處理的離散小波係數做為模糊類神經
(Neuro-fuzzy)輸入值，區別壓降、壓昇、斷電、
脈衝、暫態振動、電壓閃爍、諧波、平頂波
(Flat-top)等電力擾動信號；Lou 和 Loparo[19]
根據正常、內圈瑕疵與滾珠瑕疵之軸承振動信
號，藉由小波轉換所產生特徵值訓練模糊類神
經分類器，以期診斷滾珠軸承局部的瑕疵； 
Peng[20]等人提出使用小波包轉換去選取信
號能量的症狀，再以最佳樹選擇特徵向量，最
後以倒傳遞類神經網路來辨識渦輪機的故障
診斷； Lee[21]等人利用小波包於斷路器故障
診斷，並以類神經網路做故障分類。 
隨著電腦技術、信號分析技術與資料庫技
術的發展，診斷系統已經被應用在光電產業、
醫療技術、工業工程技術等，但尚未應用在高
分子加工製程之熔融紡絲機台。Wang 等人[22]
以類神經網路、專家系統及其兩者的結合，針
對變壓器做錯誤診斷，結果發現以類神經網路
與專家系統的結合除了正確性較高外，還是一
個方便提供動力設備維修和診斷專家的重要
工具；Zhou 等人[23]提出基於基因演算法的異
常診斷系統應用在複雜和特別的核發電場
上，利用基因演算法可以容易被制定，也可以
在這個系統的所有信號中，處理虛假的訊號；
Shubhalaxmi[24]等人為解決車輛多樣化故障
的問題，所以提出一個使用多層感知器去學習
在特徵值中故障與對應的誤差關係，建立故障
偵查的診斷系統，這個應用將可以容易使用在
找尋車輛多樣化故障。因為診斷系統應用的方
面快速的成長，熔融紡絲傳統的檢測方式都是
在實驗室中離線進行的，利用對已生產的紡絲
進行抽樣檢測來人工分析品質，這種離線檢測
不但浪費了大量的紡絲，更重要的是在連續生
產中不能及時發現產品的品質問題，導致大量
後續產品出現質量缺陷，且分析結果易受到操
作人員的經驗與知識的影響。熔融紡絲診斷系
統可透過張力感測器收集熔融紡絲張力的訊
號，由電腦分析和處理將機台異常加工參數診
斷出來[25]。 
本研究擬以熔融紡絲為實驗機台，整合實
驗設計與機台異常分析子系統，建構熔融紡絲
機台加工參數異常診斷系統。紡絲張力之均勻
性有助於纖維品質的均勻，故在田口實驗規劃
法進行實驗分析與設計過程中，選擇紡絲張力
變異為品質特性，而加工參數包含壓出機加熱
溫度曲線(螺桿三段加熱溫度、模頭溫度、紡
嘴溫度及齒輪幫浦溫度)、螺桿轉速、齒輪幫
浦轉速、冷卻風速與捲取速度五個因子，藉張
力感測器量測紡絲張力變異，將實驗量測結果
分別計算信號雜音比、變異數分析與信賴區等
數據，分析影響紡絲張力變異情形，最後獲得
一組最佳參數組合及顯著加工參數。而診斷系
統資料庫樣本以最佳參數組合為標準，只改變
單一顯著加工參數進行個別實驗，將實驗結
果，透過小波包擷取訊號特徵值，且藉由倒傳
遞類神經網路分類可得到影響張力異常之顯
著加工參數，完成熔融紡絲機台加工參數異常
診斷系統之建構。診斷系統資料庫完成後，即
可在張力感測器量測到張力變異異常時，判斷
出影響張力變異異常的加工參數。 
一般工廠都是根據經驗豐富的製程工程師
來設定熔融紡絲之加工參數條件，並且在抽絲
過程中出現異常時，能夠判斷異常的原因，進
而改善，然而為了使製程技術之延續，避免技
術之斷層，以及作為工程師判斷加工參數異常
之參考，降低生產之成本；而本研究以田口
法、變異數分析、小波包變換及倒傳遞類神經
網路為研究方法，試尋找在一最佳加工條件範
圍內，張力發生變異時，可以得知為何種加工
5 
(Wavelet packet analysis)可以對高頻信號進行
小波分解，能夠為信號提供一種更加精細的分
析方法，它將頻帶進行多層次劃分，對多分辨
分析沒有細分的高頻部分進一步分解，並能夠
根據被分析信號的特徵，自適應地選擇相應頻
帶，使之與信號頻譜相匹配，而提高了時-頻
分辨率，因此小波包具有更廣泛的應用價值。 
S
DDA3DAA3AAA3
DD2AD2DA2AA2
D1A1
DDD3ADD3DAD3AAD3ADA3  
圖 3.2 三層小波包分解樹 
以圖 3.2 的一個三層小波包的分解為例，A
表示低頻，D 表示高頻，末尾的序號數表示小
波包分解的層數(即尺度數)，小波包分解算法
如下式。 
⎪⎩
⎪⎨
⎧
=
=
+
−
+
+
−
∑
∑
nj
k
k
lk
nj
l
k
nj
klk
nj
l
dbd
dad
,1
2
12,
,1
2
2,
………………….(4) 
3.3 類神經網路[36-38] 
類神經網路或譯為人工神經網路，其主要
的基本概念是嘗試著模仿人類的神經系統，它
的架構源自於現今對人類神經系統的認識，是
由很多非線性的神經元和位於這些運算單元
間的眾多連結所組成，而這些運算單元通常是
以平行且分散的方式來進行運算，如此就可以
同時處理大量的資料應用。此外，類神經網路
之應用不需前提假設，只要有充足的歷史資
料，即可進行分析。 
輸入層 輸出層隱藏層  
圖 3.3 倒傳遞類神經網路架構 
一般網路架構可分為輸入層、隱藏層與輸
出層，每一層皆由神經元所組成，同一層神經
元彼此不相連，不同層神經元則彼此相連，且
信號之傳遞為單一方向，從輸入層至輸出層為
止，如圖 3.3 所示；在輸入層神經元接受輸入
值之前，須將輸入值進行變數尺度化變換其值
域，避免各個輸入變數值域差異太大，導致小
值域變數重要性無法呈現，大值域變數控制網
路的學習，影響網路學習的效果。 
輸入值傳送至神經元，集成函數將輸入值
加權乘積和與神經元偏權值相差，利用激發函
數之非線性雙彎曲函數進行轉換，輸出下一層
神經元直至輸出層為止，並根據神經元輸出值
(Y)與目標值(VT)定義一個誤差函數計算誤差 
∑ −=
j
jT YVE j
2)(
2
1 ……………………..(5) 
利用最陡坡降法將誤差函數最小化，網路即小
幅度調整神經元與神經元間的加權值大小，及
隱藏層和輸出層之偏權值，而修正加權值
( ijWΔ )與偏權值( jθΔ )分別為 
ij
ij W
EW ∂
∂−=Δ η , 
j
j
E
θηθ ∂
∂−=Δ ………...(6) 
其中η為學習速率(Learning rate)，控制每次最
陡坡降法最小化誤差函數的步幅。學習過程一
次一個訓練樣本方式進行，直至所有訓練樣本
都學習過為止，此過程稱為一個學習回合
(Learning epoch)，但網路訓練樣本可反覆學習
N 回合，最後計算均方根誤差(Root mean 
square error, RMSE)量測誤差差距。 
四、實驗規劃與結果討論 
本研究擬以熔融紡絲為實驗機台，整合實
驗設計與機台異常分析子系統，建構熔融紡絲
機台加工參數異常診斷系統。選擇紡絲張力變
異為品質特性，而加工參數包含壓出機加熱溫
度曲線、螺桿轉速、齒輪幫浦轉速、冷卻風速
與捲取速度五個因子，藉張力感測器量測紡絲
張力變異，將實驗量測結果分別計算信號雜音
比、變異數分析與信賴區等數據，分析影響紡
絲張力變異情形，最後獲得一組最佳參數組合
及顯著加工參數。而診斷系統資料庫樣本以最
佳參數組合為標準，只改變單一顯著加工參數
進行個別實驗，將實驗結果，透過小波包轉換
後，進行電腦運算以擷取訊號的特徵，擷取三
種重要的特徵值，分別將三種特徵值輸入至倒
傳遞類神經網路系統的訓練辨識，等訓練完成
收斂後，再實際運用在另外的測試樣本上，進
行張力變異異常之辨識，完成熔融紡絲機台加
7 
了降低實驗時可能發生的誤差，因此每一實驗
組 合 將 重 複 實 驗 十 次 ， 其 數 據 值 為
1021 ,...,, yyy ，其 SN 比計算結果如表 4.2 所示。 
為了暸解加工參數在不同水準時，對輸出
電壓變異的影響程度，根據步驟二之 SN 比，
利用 25L 直交表將同一因子同一水準值之 SN
比相加，再除以每一水準之個數，即是此參數
此水準之平均回應值，依此製作成如表 4.3 之
回應表，在表 4.3 用星號突顯每一個加工參數
對品質特性影響較大回應值之水準別，將所選
的各個水準別以表格型式列出，在預測最適化
條件是否符合再現性，將可配合 ANOVA 表應
用作分析。 
表 4.3 直交表之回應值 
 A B C D E 
水準一 27.371* 26.363* 25.372 26.184 23.285 
水準二 24.133 25.284 26.383* 27.400* 24.723 
水準三 24.794 24.966 25.668 24.611 25.762 
水準四 25.127 25.584 25.378 23.377 26.626 
水準五 25.965 25.193 24.590 25.818 26.994*
根據變異數分析(Analysis of variance，
ANOVA)，應用統計檢定的方法，辨識各個因
素之影響效果，確立明顯之加工參數，以評估
預測品質最佳值及其信賴界限 (Confidence 
interval，CI)。然而預測值與實際實驗數據所
得之品質相互比較，驗證實驗是否具有再現
性，如果所推定條件組合確實成立的話，其組
合並不只是代表這 25 組實驗中的最佳組合，
而應該是 3125( 55 )組實驗中的最佳組合，即可
證明實驗數據之正確性與完整性；反之，若超
出所預估的信賴界限，則認定此實驗不具有再
現性，需重新規劃實驗加工參數的水準值，直
至實驗成功為止。表 4.4 為計算過後的
ANOVA 表，再與 F 檢定法的結合，其值是經
由查表即可得知[29]，所以只要 F 值大於 3.26
即為顯著因子，故選擇 A、D 及 E。 
表 4.4 張力變異之 ANOVA 表 
 SS dof V F F0.05,4,12
 8.757* 4 2.189 1.145 3.260
A 31.095 4 7.774 4.066  
B 5.874* 4 1.469 0.768  
C 8.315* 4 2.079 1.087  
D 47.356 4 11.839 6.192  
E 45.368 4 11.342 5.932  
P(合併誤差) 22.946 12 1.912   
Total 146.764 24    
表 4.3 所示，結果為參數 A 之水準一、參
數 B 之水準一、參數 C 之水準二、參數 D 之
水準二及參數 E 之水準五，並配合表 4.4 之
ANOVA 表所選出之顯著加工參數 A、D 及 E，
即可決定參數 A 之水準別為一(A1)、參數 D
之水準別為二(D2)和參數 E 之水準別為五
(E5)。 
表 4.5 影響張力變異之顯著加工條件範圍 
最佳組合 
(標準) 
改變顯著
加工條件 A 
改變顯著 
加工條件 D 
改變顯著
加工條件 E
A1B1C2D2E5 A2D2E5 A1D1E5 A1D2E1 
 A3E2E5 A1D3E5 A1D2E2 
 A4D2E5 A1D4E5 A1D2E3 
 A5D2E5 A1D5E5 A1D2E4 
經由上面可以得到影響張力變異的主要三
個顯著加工條件，分別為壓出機加熱溫度曲線
(A)、冷卻風速(D)與捲取速度(E)，本實驗以最
佳組合為一個標準，固定兩個顯著加工條件，
只改變一個顯著加工條件進行實驗，如表 4.5
所示，可以得到影響張力變異的三個顯著加工
條件範圍，除此之外，也利用現有的 25 組實
驗，來驗證如果改變非顯著加工條件 B 和 C
時，它並不會明顯的影響張力變異，將上述的
結果，透過下節介紹的小波包進行特徵擷取。 
4.2 小波包變換及其應用 
本研究採用小波變換中的小波包，選用
Daubechies 小波函數，其中對於短而快的暫態
干擾使用 D4 或 D6 小波是較好的；對於慢速
的暫態干擾使用 D8 或 D10 是較適合的[39]，
在此則採用D4作為執行小波轉換時母小波函
數並做四層之多重解析分析。 
13.491
10.758 2.409*
8.671 1.633* 1.357* 1.39*
6.946 1.648* 0.828* 0.916* 0.751* 0.785* 0.858* 0.673*
0.407*0.468*1.023*0.753*0.780*5.624* 0.450*0.536* 0.385*0.585*0.361*0.458*0.352*0.466* 0.373*0.347*
圖 4.2 信息代價函數值及最佳基搜尋結果 
首先利用小波包快速分解算法計算出信號
在各子空間上的小波包係數，接著選定信號代
價函數，計算出小波包樹中各節點處的信息代
價函數值，如圖 4.2 所示，而本研究選用的信
號代價函數是 Shannon entropy，因為 Shannon 
entropy 是負號，所以在取特徵值時是最小值
愈能代表此瑕疵的資訊。最後採取自底向頂逐
節點比較的方法搜尋最佳基，如圖 4.3 中的灰
色框所示，這些節點對應的小波包基就是所求
的最佳基。這個最佳小波包基對應的可容許樹
如圖 4.3 所示。 
9 
時就已經收斂，且誤差均方值最後的收斂結果
可達到 0.001。 
0
0.2
0.4
0.6
0.8
1
0 0.5 1
最小熵值(正規化)
次
小
熵
值
(正
規
化
)
因子E 因子D 因子A
 
0
0.2
0.4
0.6
0.8
1
0 0.5 1
最小熵值(正規化)
標
準
差
(正
規
化
)
因子E 因子D 因子A
(a) 最小熵值與次小熵值 (b) 最小熵值與標準差 
圖 4.4 特徵值相對分佈圖 
在經過上述的參數設定及訓練後，我們可
得到倒傳遞類神經網路根據所輸入的三種值
所調整出的權重值。再選出另外所準備的 36
個新的測試樣本，如表 4.6 所列，其中
A1D2E1、A1D2E2、A1D2E3 和 A1D2E4 所改變的
顯著因子 E 捲取速度與 A1D1E5、A1D3E5、
A1D4E5和A1D5E5所改變的顯著因子D冷卻風
速，與原本的加工參數的設定值有些許的不
同，例如：捲取速度原本為 500、600、700
和 800 轉，變更為 550(E’1)、650(E’2)、750(E’3)
和 850(E’4)轉，而冷卻風速原本為 1、5、7 和
9 格，變更為 2(D’1)、6(D’3)、8(D’4)和 10(D’5)
格，由於溫度曲線在之前的測試實驗中，已經
將能順利抽成絲之範圍定出，所以在測試樣本
上並沒有作改變，這樣的測試樣本，可以更確
定此系統的辨識能力，以判定此三種特徵是否
真的適用於張力變異的異常辨識上，另外表
4.6 中，也增加了九組數據，是為了驗證改變
非顯著因子 B 及 C 時，並不會影響分類的結
果，所以從現有的 25 組實驗中找出 No.11、
No.06 和 No.18 這三組資料，以 No.11 為例說
明，它是固定顯著因子 A 和 D，只改變顯著
因子 E，然而同時也改變非顯著因子加工參數
B 和 C 來進行實驗，將資料透過小波包變換
後，同樣擷取三種特徵值，加以分類，這樣可
以以實際的實驗來說明調整非顯著因子 B 和
C 時，不會影響分類的效果，更可以確定加工
參數 B 和 C 為非顯著因子。而以三個特徵值
帶入類神經網路辨識得到的結果是 100%的成
功。 
五、結論 
提昇製程品質控制(Quality control)是目前
工業界極力追求的目標，因其所帶來的好處與
利益是不可預估的。因而本研究應用張力感測
器所量測的數據搭配小波包變換處理異常訊
號的特徵擷取，以倒傳遞類神經網路來設計異
常訊號之分類與辨識，而此熔融紡絲診斷系統
可以直接應用實際工廠生產過程中所發生的
加工參數異常診斷上，可以代替人工進行熔融
紡絲機台加工參數異常診斷的工作。最後實驗
的結果與討論可知，在一個依最佳加工參數組
合為標準和三種影響張力變異異常的加工參
數中：顯著加工參數(A)壓出機加熱溫度曲
線、顯著加工參數(D)冷卻風速與顯著加工參
數(E)捲取速度，共 36 個測試樣本中，系統的
辨識率可達 100%。證實了選擇以小波包變換
作為加工參數異常的特徵抽取是非常適切的。 
然而本研究所使用的方法，雖然可以有助
於人員縮短故障分析時間，節省人力耗損，但
依田口規劃法所進行的實驗時，出現可能先前
設定的水準值，設定不是很妥當，使實驗的重
覆次數增多，使得花費很多時間與成本在進行
實驗，若實驗水準值的設定能更準確，即可更
快完成實驗，再則因為熔融紡絲機台之穩定性
不佳，可能會影響實驗的結果，若熔融紡絲機
台之穩定性能夠再提昇，即可使系統適用性更
佳。根據上述之結果，目前在 SPC 及回饋/前
饋控制為線上(On-line)品質控制技術，SPC 觀
察量測值監控製程品質，當量測值超出管制圖
(Control chart)上下管制界線時會發出警訊
(Alarm)，其優點為利用統計理論區分機遇原
因 (Chance cause)與可歸屬原因 (Assignable 
cause)，而批次回饋/前饋控制促使製程維持一
定的輸出水準，整合 SPC 與控制技術減少過
度控制的問題，這必定是為來學術界與業界共
同努力的目標，將留待未來研究探討。 
六、參考文獻 
[1] 吳偉欽，“聚丙烯纖維染色性之探討”，絲織園地，
第 26 期。 
[2] A. Dutta and V. M. Nadkarni, “Identifying Critical 
Process Variable in Poly(ethylene terephthalate) Melt 
Spinning,” Textile Research Journal, Vol. 54, No. 1, 
pp. 35-42 (1984). 
[3] C. Jinan, T. Kikutani, A. Takaku and J. Shimizu, 
“Nonisothermal Orientation-induced Crystallization 
in Melt Spinning of Polypropylene,” Journal of 
Applied Polymer Science, Vol. 37, pp. 2686-2697 
(1989). 
[4] J. S. Denton, J. A. Cuculo and P. A. Tucker, 
“Computer Simulation of High-speed Spinning of 
PET,” Journal of Applied Polymer Science, Vol. 57, 
pp. 939-951 (1995). 
[5] S. Chen, W. Yu and J. E. Spruiell, “On-line Studies 
of Structure Development during Melt Spinning of 
Poly(butylenes telephthalate),” Journal of Applied 
Polymer Science, Vol. 34, pp. 1477-1492 (1987).  
