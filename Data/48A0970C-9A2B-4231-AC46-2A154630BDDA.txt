 1 
目錄 
中文摘要 ....................................................................................................................... 2 
ABSTRACT ..................................................................................................................... 3 
第一章 研究目的 ......................................................................................................... 3 
第二章 RFID 驗證機制 .............................................................................................. 6 
第三章 安全的群組存取控制協定 ........................................................................... 19 
第四章 基於公開金鑰與線上驗證機制的 RFID 防偽系統 ................................... 29 
第五章 RFID 應用於供應鏈管理與所有權轉移研究 ............................................ 43 
第六章 研究成果自評 ............................................................................................... 55 
參考文獻 ..................................................................................................................... 59 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 3 
Abstract 
The counterfeiting problem affects manufactures, distributors, governments and 
consumers. Brand owners need techniques for guaranteeing the authenticity of their 
products in today’s global marketplace. Radio-frequency identification (RFID) is 
considered as a promising approach because it provides an extensible, flexible and 
secure measure to combat counterfeiting.RFID system is gaining popularity and 
attracting interest from both the enterprises and academic institutes. But now, we face 
several security problems and challenges in RFID systems. Several RFID 
anti-counterfeiting mechanisms have been proposed in resent years.  
In this paper, we first present a new lightweight anti-counterfeiting authentication 
scheme that can be applied in low-cost RFID system. However, the universal 
deployment of RFID devices in consumer items may expose new security and privacy 
risks. Some risks will be reduced if the RFID tag can be accessed only by the 
authorized readers. 
 Therefore, we propose a RFID access control protocols and one ownership 
transfer protocol. The access control protocol is a basic type for different authorized 
readers. For each tag, only one doctor can access it. Only some lightweight operations 
such as hash function and pseudorandom number generator are needed in the tags. Such 
design can be implement in practical. For hospital infrastructure with diversity of group 
member access right, each group’s access rights are distinguished as three grades.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
第一章 研究目的 
 5 
來可以預期，RFID 電子標籤被廣泛應用在各種產品，消費者將有疑慮是否其購買
有 RFID 電子標籤的物品有可能讓自己的隱私曝光。這是將 RFID 大量應用前必須
解決的問題。而研究 RFID 的相關安全機制，與一般安全設計不同之處在於所有
計算與設計都必須在成本限制考量下，做出運算負荷不大但夠安全的設計。 
因此我們投入研究有關 RFID 電子標籤的辨識 (Identification)、驗證
(Authentication)、存取控制(Access Control)、防偽(Anti-Counterfeiting)，這幾項研
究其實是密不可分的。 
在 RFID 驗證機制，設計方向就是在驗證進行過程中不致出現固定的驗證值，
一方面防止中間第三者可能攔截重送攻擊，另一方面防止被有心人士追查而洩漏
持有者的行蹤，這是很重要的隱私問題。在這個計畫中，我們瞭解在不同的應用
環境或標準規格最適合的方法，以做為各種 RFID 系統導入之參考，並且我們更
進一步提出改良的設計。 
在 RFID 存取控制，設計方向是使用兩次 Challenge-Response 達成相互驗證，
並進一步對存取控制研究之其他安全條件做深入探討，像是位置隱私、重送攻擊、
DoS 攻擊、竊聽、通訊量分析等，就能以更周延的觀點將安全漏洞做好改善，提
出更安全的 RFID Tag 存取控制協定。而且我們針對某些應用環境下必須對 Reader
的存取權限有所區隔時，讓 Reader 有不同存取權限的存取控制機制，更進一步還
要以群組但有階級的概念來規劃存取控制的機制，更能符合某些應用環境。 
在 RFID 防偽方面，對現有防偽系統提出可能的攻擊弱點並改進之，而且會
針對商品生產流程做更多的設計，做出較大的系統規劃。然後，再針對不同的應
用情境，檢討使用數位簽章的設計如何改良，而在將來”Smart Tag”若能普及，重
新檢視並強化防偽機制的設計。 
 
 
 
 
 
 
 
 
 
 7 
 Zhang 等人[13]在 2005 年提出 Juels 設計上的完整性有所缺失，並改進其
設計。 
 在 2004 年，Molnar 等人[14]提出應用於圖書館管理的 RFID 驗證機制，
其設計需要在 Tag 具備虛擬亂數產生器 (Pseudo-Random Number 
Generator, PRNG)，就可以保障 Tag 的 Key 於驗證過程中不被得知。 
 而 在 2005 年 Molnar 等 人 [15] 提 出 另 一 個 以 虛 擬 亂 數 函 數
(Pseudo-Random Number Function, PRF)設計的RFID驗證機制，使用 PRF
讓 Tag 每次都以不同假名回應後端 Server 的驗證，而加強了隱私的保障。 
 在 2006 年，Tsudik[16]提出的 RFID 驗證協定命名為 YA-TRAP，其設計
也是需要在 Tag 具備虛擬亂數產生器(PRNG)，主要概念是透過在 Tag 上
的遞增時戳來做驗證，而後端 Server 在對 Tag 做驗證前就先計算出 Hash
對照表，讓後端 Server 在驗證過程的運算負荷降低。 
 同樣在 2006 年，Chatmon 等人[17]就針對 YA-TRAP 的安全漏洞做改進，
可是其設計卻增加後端 Server 的運算負荷。 
 在 2004 年，Juels[18]提出在 Tag 和後端 Server 建立假名和 Key 的對照表
為依據做 RFID 驗證機制，使用 one-time pads 概念更新 Tag 的假名以防
止仿製和竊聽的問題，但這樣的設計在 Tag 上需要較多的記憶體空間，
並且在更新 Tag 資料的通訊成本較高。 
 在 2005 年，Juels 提出另一個低成本的驗證協定[19]，可應用於 EPC 
Class-1 Generation-2 標準的 Tag，使用“kill password”為驗證依據，防止
Tag 被仿製的可能。 
 要能夠應用於低成本 Tag 的驗證，另外可行的安全設計就是使用
challenge-response 策略，在 2003 年由 Vajda 等人[20]就有提出這類的設
計，而對 Key 的保護只需要做簡單的 XOR 運算即可。 
 在 2004 年，Ranasinghe 等人[21]也提出一種 challenge-response 策略的
RFID 驗證機制，這個方法在 Tag 上設計了所謂的“Physical Unclonable 
Function(PUF)”[22]，而後端 Server 則是儲存對應每個 Tag 做 PUF 運算
的一連串 challenge-response 值，每次的驗證只要逐一比對為使用的值，
即可驗證 Tag，而不必於驗證過程中做相關的加密運算，減輕後端 Server
的運算負荷。 
 在 2005 年，Rhee 等人[23]也提出一種 challenge-response 策略的 RFID 驗
證機制，Tag 的 Key 值保護是採用 Hash 函數，但這部分只需由後端 Server
運算，所以對 Tag 的運算負荷不高，而這個協定還宣稱可適用於分散式
資料庫的環境。 
 9 
保障。 
 在 2004 年 Gao 等人[35]提出改進供應鏈上的驗證機制，在安全與隱私保
護做了改善，Tag 需要有 PRNG 和 Hash 函數，還需要可重複寫入的記憶
體空間來儲存可合法讀取 Tag 資料的 Reader 記錄，以保護 Tag 不被未授
權的 Reader 讀取，而且其宣稱能適用於非常大規模的 Tag 數量之驗證，
但其缺點是後端 Server 的運算負荷頗大。 
 在 2005 年 Yang 等人[36]提出的 RFID 驗證機制，可不受重送攻擊和第
三者介於中間攻擊的威脅，其設計需求是 Tag 有 Hash 運算能力，並和
後端 Server 共享兩個秘密訊息，透過這樣的方式來提供隱私保護和不被
仿製。 
以上這些 RFID 機制在設計，除了要能夠驗證 Tag 的真偽，還要在驗證進行過
程中不致出現固定的驗證值，一方面是為了防止中間第三者可能攔截重送攻擊，
另一方面是為了防止被有心人士追查而洩漏持有者的行蹤，這是很重要的隱私問
題。由上述一些認證的方法的演變，不難發現其中有所差異，有使用假名的方式、
對稱式金鑰加密的方式以及到後來考量用更新金鑰的方式，其用來達到防偽的效
用都有一些必須特別注意的地方，簡述如下: 
1. 就假名的方式來看，目的是為了保護原本的驗證訊息值(如:電子產品碼)，不
過，電子標籤回覆給讀取器的訊息值若是固定或可預測的，則該值一旦被攻擊
者攔截到，而後只要將此固定的驗證值複製到另一個假冒的電子標籤中，如此
一來，便可進行產品的假冒。 
2. 就對稱式金鑰加密的方式來看，透過對稱式金鑰去對驗證訊息加密，來保護驗
證訊息，加上搭配亂數值一同加密，則可確保每次傳出的值都不固定，然而這
種方式的重點就在於用來加密的金鑰之安全程度了，就低價的 RFID 來看，其
可存放的資料值的記憶體是很有限的，其安全度未必很夠，一旦攻擊者透過不
斷的嘗試而破解出秘密金鑰，則攻擊者便只需將加密金鑰和加密函式複製到假
冒的電子標籤，變可進行產品的偽造。 
3. 就更新電子標籤金鑰的方式來看，之所以要更新金鑰，就是希望金鑰被破解的
機率降低，以及過去的訊息不被追蹤，即使這回合的金鑰被破解，而下次的金
鑰也改變了，然而要用此種方法，則首先不免要注意準備更新的值是沒有被竄
改的，同時也要確定更新資料的雙方(如：後端伺服器與電子標籤)是否有同步
進行更新資料，否則一旦指要有一次雙方更新不一致而沒察覺，便會導致日後
驗證失效。 
 
在討論我們設計的安全存取控制協定之前，先介紹其他研究認為 RFID 系統
要達到安全的存取控制，基本上必須滿足下列幾個特性：相互認證、匿名性、機
密性和完整性，所以在介紹完我們的存取控制協定之後，會以這些特性來分析是
否為一個好的存取控制機制。 
 11 
方面可將發佈給電子標籤的驗證資料寫入電子標籤內，另一方面則可授權給讀取
器進行日後對電子標籤的存取權限。 
讓伺服器將發佈給電子標籤的驗證資料寫入電子標籤內是為了日後能夠去
驗證電子標籤的真偽。而由伺服器授權給讀取器的目的則是由於一片 RFID 防偽晶
片的成本大約 20~40元，用於低價商品尚不符成本，較適合用於名牌精品、酒類、
藥品、化妝品、汽車零件等高單價產品，或可以貼在證書及證券上面，於是這些
授權讀取器通常會出現在需要被驗證的高價商品常被交易的場合，如百貨公司、
精品店或代理商等，於是，當產品需要驗證其真偽時，則讀取器會先跟生產的廠
商的資料庫進行連線，因此還可以回傳產品的產地、生產的年份、甚至建議售價，
以及其他想要提供給消費者的資訊，此外授權的讀取器將擁有較多的權限。 
2.2.1 符號描述 
在接下來的論文中，將會使用到一些符號於我們的協定中。各符號的功用描
述如下： 
z ||   :  連結運算 
z + :  加法運算 
z ‐ :    減法運算 
z ⊕   :  互斥或運算 
z RC :  隨機亂數值 
z 21 ,bb :隨機亂數值 
z TagI :  電子標籤索引 
z RdrI :  讀取器索引 
z TagK ::   電子標籤的金鑰 
z RdrK :  讀取器的金鑰 
z RdrK ' :電子標籤的下一回合使用的金鑰 
z ack   :  一個特定的值用以告知電子標籤的真偽   
 13 
RdrI 、讀取器的金鑰  RdrK 和共用的秘密  ),...,,,( 210 naaaa 。此外，這些資
料也將記錄在伺服器的資料庫，如同  ( RdrI , RdrK , ),...,,,( 210 naaaa )。 
2.2.3 認證階段 
當一個產品被帶攜帶到授權的讀取器，產品的電子標籤能夠在後端伺服器的
協助下並經由授權讀取器來驗證。我們的機制是專注在 RFID 系統的防偽議題。  主
要的設計概念類似於“一次性密碼”(one‐time password)的認證機制策略。在“一次性
密碼”系統裡，需要被驗證的關鍵資訊必須在每回合變動。而在我們的設計中也是
類似的情況，用來驗證用的關鍵資訊在每個回合將會不同。如此一來，由於電子
標籤不能用關鍵資訊去進行偽造，所以任何人去攔截關鍵資訊皆沒有用。也就是
說，任何人無法偽造出可以通過認證的電子標籤。 
步驟 1. 讀取器產生一個隨機亂數  1RC ，並將其傳送給電子標籤。 
步驟 2. 當電子標籤收到隨機亂數  1RC ，以索引值  TagI 、自己的金鑰  TagK
和兩個秘密  0n 及  1n 產生訊息  1M   如下： 
          )1()1()( 011 RCnRCnKIM TagTag ⊕+⊕⊕⊕=  
                        然後訊息值  ),( 1MI Tag   被傳送給讀取器。 
步驟 3. 讀取器傳送一個詢問給伺服器。 
步驟 4. 伺服器產生一個隨機亂數  2RC ，並將其傳送給讀取器。 
步驟 5. 當讀取器接收到隨機亂數  2RC ，以自己的金鑰  RdrK 、亂數  2RC
和兩個秘密  ja 及  1+ja 產生訊息  3M   如下： 
                              )2()2( 12 RCaRCaKM jjRdr ⊕+⊕⊕= +  
                          接著訊息值  ),,1( 1MIRC Tag 和  ),( 2MI Rdr   被傳送給伺服器。 
步驟 6. 唯有來自授權讀取器的要求才可被後端伺服器接受。為了驗證讀取
器，伺服器根據接受到的讀取器索引值  RdrI ，經由其資料庫中取出
讀取器的金鑰  RdrK 和秘密  ),,( 21 ++ jjj aaa 。然後伺服器驗證訊息
2M ： 
                              )2()2( 1
?
2 RCaRCaKM jjRdr ⊕+⊕⊕= +  
                                                若上式成立，表示該讀取器尚未授權，並且其可獲得的回覆只
有關於產品規格  TagInfo 的訊息。 
 15 
去驗證訊息  5M   及  6M 的完整性： 
             
))||2||()2||||(()||||(
)||||()||2||())2||||((
1216
?
21
211215
+++
+++
⊕−=
=⊕−
jjjj
jjjj
aRCaRCaaMackbb
ackbbaRCaRCaaM
   
          若上述得等式成立，其得出的結果值為  )||||( 21 ackbb .  接著讀取
器直接將值  ),,,( 2143 UUMM 傳送給電子標籤。 
步驟 8. 該電子標籤便能使用接收到的訊息、秘密  ),,( 210 nnn 和自己的金鑰 
TagK 去驗證訊息組  ( 1U , 2U )和( 3M , 4M )的完整性： 
                               
))1||||()||1||(()||||(
)||||()||1||())1||||((
214
?
21
21123
RCKnKRCnMackbb
ackbbnRCKRCKnM
TagTag
TagTag
⊕−=
=⊕−
 
))||1||()1||||(()'||'||'(
)'||'||'()||||1())||||1((
122
?
210
210201
TagTag
TagTag
KRCnRCnKUnnn
nnnnKRCKnRCU
⊕−=
=⊕−
 
          若上述得等式皆成立，表示電子標籤也將會被告知其已通過驗證，
並且該更新值  )',','( 210 nnn 。為了避免可能的惡意竄改和傳輸錯誤， 
TagK   及  ),,( 210 nnn 應該保留直到下個回合開始之前.   
            之後，電子標籤應該告知讀取器，其已完成更新的動作。接著，        電
子標籤產生訊息  7M   及  8M 給讀取器如下： 
              217 bbackM +⊕=  
              )1( 128 RCbbackM ⊕+⊕=  
                      然後值  ),( 87 MM 將被發送給讀取器。 
步驟 9. 當接收到上述訊息時，讀取器能使用相同的值  1b   及  2b 去驗證訊
息  7M   及  8M 的完整性： 
              218
?
127 ))1(()( bRCbMbbM ⊕⊕−=⊕−    
                        若上述得等式皆成立，表示電子標籤已完成這回合的更新動作。 
2.3 安全性分析 
在這個章節中，我們會對我們的機制進行論證，以確保達到章節二中提及的
安全屬性。 
2.3.1  資料的完整性:   
 17 
預測的，所以攻擊者在我們的設計中執行重送攻擊並無效。 
2.3.4 防止欺騙攻擊: 
        任一個攻擊者想假冒擁有授權讀取器或合法電子標籤都是不可能的。只要
攻擊者不知道電子標籤的秘密 TagK 、 0n 和 1n ，他也就不能產生正確的回覆訊
息去欺騙讀取器，即使攻擊者竊聽到合法電子標籤的回覆訊息並重送，我們由
先前於上述剛提過的分析可得知此回覆訊息並不會被接受，因此攻擊者假冒成
一個有效的電子標籤將不會發生。相類似地，攻擊者假冒成一個授權的讀取器
的情況是不會在我們的設計中發生。攻擊者不能獲得授權讀取器的金鑰 
RdrK ，以產生對應的正確回應，即使攻擊者竊聽到授權讀取器的回覆訊息並
重送，也將不會被伺服器端所接受，因此攻擊者便無法獲得正確的一對對訊息
值 ),( 54 MM 及  ( 21 ,UU )，並在步驟  7  去欺騙電子標籤。必然地，欺騙攻擊是
不可能存在於我們的設計。     
2.3.5 防止複製攻擊: 
        電子標籤的複製也就是一個合法的電子標籤被複製後並被貼附到假冒的
商品上。而為了對付複製攻擊，必須讓攻擊者無法存取電子標籤的識別資料。
在我們的設計中，如同我剛剛在上述提及的，電子標籤的認證程式是安全的，
因此任何沒有經過允許的審問都無助於攻擊者去複製電子標籤。 
然而，電子標籤並無法抵抗實體攻擊，倘若有非法人士經由實體攻擊得出電子
標籤的識別資料，依然能確保這樣的行為對他並不值得。首先，非法人士必須
買一個真品，接著去對產品中的電子標籤進行實體攻擊得出其識別資料，再製
造出大量的複製電子標籤。不過，由於識別資料將會透過伺服器的控制而在步
驟6和步驟8的時候進行更新，因此其餘的複製電子標籤將變為無效。由此看
來，透過實體攻擊去得出一個電子標籤的識別資料後，卻只能造出一個有效的
複製電子標籤，對於非法人士去進行複製攻擊並不值得。 
 
2.3.6 防止非同步攻擊: 
        非同步攻擊就是攻擊者企圖使得存放在電子標籤的祕密與伺服器內的對
 19 
第三章 安全的群組存取控制協定 
3.1 我們設計的安全群組存取控制協定 
早期學者的設計都避免不了第三者介於中間的攻擊模式，也就是非法者居中
假冒電子標籤或讀取器而欺瞞對方完成運作， RFID 安全研究議題都要特別注意
的風險與威脅[37]。所以我們更深入探討先前的研究為何無法防止這樣的威脅，例
如用來驗證 Tag 是否為當初 Server 核發的，傳回的 Key 值是不應該明白傳送，而
且又要避免竄改或被攔截重送攻擊，很直覺的設計就是就採用 Challenge-Response
的精神，由 Reader 決定一個隨機亂數或質問值，而 Tag 接受並以 Key 值進行計算
回應值回傳給 Reader，這樣就可避免第三者介於中間的攻擊，而 Reader 可以將回
應值交由後端 Server 驗證其是否正確。在 Tag 傳出回應值之際，也應該同樣再用
一次 Challenge-Response 的精神，由 Tag 決定一個亂數要求 Reader 能送回以 Key
值進行計算回應值回傳，這樣就可以確認 Reader 的真偽。就是如此簡單，只要使
用兩次 Challenge-Response 就可以真正達成相互驗證，然後再進一步對存取控制研
究之其他安全條件做深入探討，像是位置隱私、重送攻擊、DoS 攻擊、竊聽、通
訊量分析等，就能以更周延的觀點將安全漏洞做好改善。 
 
圖 3.1 電子標籤的認證協定 
 
但在某些應用環境下必須對 Reader 的存取權限有所區隔時，前述設計即不適
用，而需要重新思考如何設計讓 Reader 有不同存取權限的存取控制機制，這方面
的概念在 2006 年由 Ayoade[38]提出的，其提出最直接的解決方案就是在後端
Server 建立 Reader 與 Tag 的權限對照表，當 Reader 要對 Tag 進行存取時，後端
Server 在取得 Reader 與 Tag 的識別碼後，比對權限對照表，就可以判斷 Reader 是
否有權存取此一 Tag。 
 21 
y h( )：單向雜湊函數 
y KSVR：資料庫伺服器的秘密金鑰 
y GroupID：每個主治醫生有不同的群組識別碼，主治醫生之下的住院醫生和實習
醫生都屬於同一個群組識別碼。 
y KeyVS：每個主治醫生都有自己的一個讀取器金鑰，由資料庫伺服器將本身 KSVR
與 GroupID 串連，進行雜湊運算得到的值 h(KSVR || GroupID)，事先分別存入主
治醫生的讀取器和該群組讀取器有權限讀取的電子標籤內。 
y UserIDi：每個住院醫生和實習醫生有不同的使用者識別碼。 
y KeyR：存在醫生使用讀取器的金鑰，主治醫生的是 KeyVS，住院醫生的是
h(KeyVS||UserIDi)，實習醫生的是 h(h(KeyVS) ||UserIDi)，由資料庫伺服器事先存
入醫生的讀取器。因為單向雜湊函數不可逆，住院醫生無法 由
h(KeyVS||UserIDi)、實習醫生無法由 h(h(KeyVS) ||UserIDi)逆推得出主治醫生讀取
器金鑰 KeyVS，所以住院醫生及實習醫生都不會假冒主治醫生的身份。 
y IDflag：讀取器身份類別，在後續的協定中，我們以"Rdt"代表住院醫生，"Itn" 
代表實習醫生，同樣是由資料庫伺服器事先存入住院醫生和實習醫生的讀取
器。 
y TagID：電子標籤識別碼 
y KeyT：電子標籤金鑰，由資料庫伺服器將本身 KSVR與 TagID 串連，進行雜湊
運算得到的值 h(KSVR || TagID)。 
y Q：讀取器隨機產生的亂數，傳給電子標籤，告知電子標籤將進行存取。 
y n：電子標籤被存取過程中，會產生的隨機亂數。 
y Respn：提供電子標籤驗證讀取器是否有權限讀取標籤資訊，讀取器以自己的
金鑰 KeyR與電子標籤傳送的亂數 n 做互斥或(exclusion or)運算，並進行雜湊
運算得出的雜湊值 h(KeyR⊕n)。 
y Dtidn：電子標籤將其識別碼 TagID 以安全的形式傳給讀取器及資料庫伺服
器，格式為 h((TagID || KeyVS)⊕(n|| Q))。 
y Ctag：電子標籤內的資訊 M 均是以 KeyT加密成密文 )(E M
TKey
存在。在我們的
協定裡面，將 Ctag區隔成三種區塊 C1tag、C2tag和 C3tag，C1tag是主治醫生可以
寫入的區塊，C2tag 是住院醫生可以寫入的區塊，C3tag 是實習醫生可以寫入的
區塊。 
y KeyC T ：資料庫伺服器將 KeyT 傳給讀取器的過程中，是以 KeyR 加密成密文 
)(E TKey KeyR 的格式。 
y Htag：用來檢查讀取器異動電子標籤的更新資料是否完整正確，格式為 h((Ctag’|| 
KeyR)⊕n)。 
 23 
詳細步驟流程如下： 
步驟 1. 讀取器隨機產生亂數 Q，傳給電子標籤，告知電子標籤將進行存取。 
步驟 2.電子標籤隨機產生一個亂數 n 傳給讀取器，要求讀取器回應可驗證身分的
雜湊值。 
步驟 3. 讀取器以自己的金鑰 KeyR與亂數 n 做互斥或(exclusion or)運算，並進行雜
湊運算得出 Respn 值： 
   )( nKeyhResp Rn ⊕=  
讀取器將 Respn 值、身份類別 IDflag 與使用者識別碼UserIDi一同傳給電子標
籤做驗證。 
因為單向雜湊函數不可逆，住院醫生無法由 h(KeyVS||UserIDi)、實習醫生
無法由 h(h(KeyVS) ||UserIDi)逆推得出主治醫生讀取器金鑰 KeyVS，所以住
院醫生及實習醫生都不會假冒主治醫生的身份。 
步驟 4. 電子標籤收到 Respn 值、身份類別 IDflag 與使用者識別碼UserIDi後，先分
辨 IDflag 的值，有下列三種情況： 
(1)當 IDflag 的值為空，代表是主治醫生，電子標籤計算 Respn’值如下： 
  )( nKeyh'Resp VSn ⊕=  
(2)當 IDflag 的值為"Rdt"，代表是住院醫生，電子標籤計算 Respn’值如下： 
 ))||(( nUserIDKeyhh'Resp iVSn ⊕=  
(3)當 IDflag 的值為"Itn"，代表是實習醫生，電子標籤計算 Respn’值如下： 
))||)((( nUserIDKeyhhh'Resp iVSn ⊕=  
電子標籤比對讀取器傳來的 Respn 值與本身計算的 Respn’值是否相等，如果
不相等，電子標籤不做任何回應；而如果相等，表示此讀取器是屬於有權
限讀取其資料的群組。於是，電子標籤準備將其識別碼 TagID 以安全的形
式傳給讀取器，讓讀取器能在資料庫伺服器的協助下取得可解開標籤資訊
密文的 KeyT。所以，電子標籤將其識別碼 TagID、主治醫生讀取器金鑰
KeyVS、亂數 n 和讀取器傳來的亂數 Q 做互斥或運算，並進行雜湊運算得出
Dtidn 值： 
   ))||()||(( QnKeyTagIDhDtid VSn ⊕=  
電子標籤會將 Dtidn 值與標籤資訊的密文 Ctag 一同傳給讀取器。 
步驟 5. 讀取器收到 Dtidn 後，連同前面收到的亂數 n、群組識別碼 GroupID 和自
己的身份類別 IDflag、使用者識別碼 UserIDi 以及亂數 Q 傳給資料庫伺服
器驗證其存取權限。 
步驟 6. 資料庫伺服器依據傳來的群組識別碼 GroupID，即可連同本身的秘密金鑰
KSVR代入計算雜湊值得出此群組主治醫生讀取器金鑰 KeyVS： 
   )||( GroupIDKhKey SVRVS =  
於是進一步將此 KeyVS 值與亂數值 n、亂數值 Q，逐一與資料庫伺服器內所
有的電子標籤識別碼 TagID 做互斥或並進行雜湊運算得出雜湊值，以搜尋
符合 Dtidn 的 TagID： 
 25 
))||(( nKey'Ch'H VStagtag ⊕=  
(2)如果 IDflag 的值為"Rdt"，代表是住院醫生，電子標籤計算 H tag’值如下： 
)))||(||(( nUserIDKeyh'Ch'H iVStagtag ⊕=  
(3)如果 IDflag 的值為"Itn"，代表是實習醫生，電子標籤計算 H tag’值如下： 
      )))||)((||(( nUserIDKeyhh'Ch'H iVStagtag ⊕=  
電子標籤比對收到的 H tag 值與 H tag’值是否相等，若兩個值一樣，表示從讀
取器傳送過來的資訊密文 Ctag’是完整且正確的，而且是由認證的讀取器所
傳送，所以如果是主治醫生，電子標籤才會將 C1tag 異動為 Ctag’；如果是住
院醫生，電子標籤才會將 C2tag 異動為 Ctag’；如果是實習醫生，電子標籤才
會將 C3tag 異動為 Ctag’。 
 
3.2 群組存取控制協定的安全性分析 
3.2.1 相互認證(Mutual Authentication) 
為了防止非法讀取器存取電子標籤相關資料，電子標籤必須有能力確認讀取
器是否屬於有權限讀取其資料的群組。在我們設計的存取控制協定採用要求－回
應(challenge-response)精神，在步驟 2，電子標籤會傳送一個亂數 n 給讀取器，以
要求讀取器回應可驗證身分的雜湊值。而在步驟 3，讀取器必須以自己的金鑰 KeyR
計算出下列的回應值 Respn： 
    )( nKeyhResp Rn ⊕=  
然後讀取器將 Respn 值、身份類別 IDflag 與使用者識別碼 UserIDi一同傳給電子標
籤，所以在步驟 4，電子標籤即可依據 IDflag 與使用者識別碼 UserIDi的值，以事
先儲存有權限存取其資料的主治醫生讀取器金鑰 KeyVS，做同樣的運算得出 Respn’
值： 
(1) 如果 IDflag 的值為空，則： 
)( nKeyh'Resp VSn ⊕=  
(2) 如果 IDflag 的值為"Rdt"，則： 
))||(( nUserIDKeyhh'Resp iVSn ⊕=  
(3) 如果 IDflag 的值為"Itn"，則： 
))||)((( nUserIDKeyhhh'Resp iVSn ⊕=  
電子標籤比對 Respn 值與自己計算的 Respn’值，若兩者一致，電子標籤即可確
認該讀取器是屬於有權限讀取其資訊之合法讀取器的群組。 
電子標籤必須確認讀取器是合法之後，才會傳出身分識別的相關資訊，以避
免電子標籤的資訊被擷取，這樣的設計才能真正達到互相認證之目的。在我們的
設計，步驟 4 電子標籤會傳遞隱含識別碼的 Dtidn 值給讀取器和資料庫伺服器： 
    ))||()||(( QnKeyTagIDhDtid VSn ⊕=  
 27 
子標籤和讀取器通訊，所以可達到匿名性的要求。 
 
3.2.3 機密性(Confidentiality) 
 
電子標籤和讀取器之間的通訊資料必須保護，才不會被攔截或竊聽而洩漏電
子標籤儲存的資料，在我們的設計步驟 4，電子標籤傳給讀取器的資訊，以及步驟
8，讀取器如果有必要異動電子標籤的資料，都有考量加密的設計，以保護電子標
籤和讀取器之間的通訊。 
在步驟 4，電子標籤既存的資料是的密文 Ctag，這些資料直接傳給讀取器，即
使通訊資料被攔截，任何人沒有金鑰 KeyT，即無法解開 Ctag 內容。 
在步驟 8，如果讀取器要異動電子標籤的資料，其在步驟 6 已經由資料庫伺服
器取得金鑰 KeyT，所以在步驟 8 就可以將異動的資料 M’ 以金鑰 KeyT加密成密文
Ctag’： 
    )(E M''C
TKeytag
=  
Ctag’傳送寫入電子標籤過程中就算被攔截，任何人沒有金鑰 KeyT，即無法解
開 Ctag’內容。更進一步來說，即使電子標籤被竊取或拾獲，因為電子標籤存放的
是密文 Ctag，所以沒有金鑰 KeyT，是無法解開 Ctag 內容。 
所以，在我們的設計中，電子標籤和讀取器之間的通訊資料，是以具有一定
安全程度的對稱式加密法加密保護的，能夠預防被攻擊者竊聽和截取風險，可達
到資料機密性的要求。 
 
3.2.4 完整性(Integrity) 
為了防止電子標籤和讀取器之間的通訊發生位元錯誤，通常會用總和檢查碼
(CRCs)方式校正，在我們的設計步驟 1～4，可額外加入這樣的機制，因為讀取器
會將標籤資訊解密，如果通訊有位元錯誤，使用總和檢查碼方式即可校正。而在
步驟 8，讀取器傳給電子標籤更新的資訊是密文，電子標籤不進行解密檢視明文內
容，這裡若只用總和檢查碼是無法確認可能發生的資料竄改或傳輸錯誤，所以在
我們的設計，除了傳送更新的資訊密文 Ctag’之外，還以單向雜湊函數運算出下列
的檢查值 H tag： 
    ))||(( nKey'ChH Rtagtag ⊕=  
然後，讀取器將更新的資訊密文Ctag’、H tag與身份類別 IDflag 值一併傳給電子標
籤，如此在步驟 9，電子標籤即可依據 IDflag 的值，以主治醫生讀取器金鑰 KeyVS 
做同樣的運算得出 H tag’值： 
(1) 如果 IDflag 的值為空，則： 
))||(( nKey'Ch'H VStagtag ⊕=  
(2) 如果 IDflag 的值為"Rdt"，則： 
 29 
第四章 基於公開金鑰與線上驗證機制的 RFID 防偽系統 
4.1RFID 防偽機制 
RFID 製程有一定的技術門檻，而 RFID 標籤的複製並非那麼容易，進而衍生
出應用 RFID 標籤達成防偽效用。目前的相關研究與實際案例，最開始是假設複
製或仿造 RFID 標籤的技術門檻高，對有心偽造者而言，可說是難以跨越的鴻溝
[39]，所以將 RFID 標籤嵌入產品包裝內，即可用來驗證產品的真偽。不過，複製
或仿造 RFID 標籤的技術門檻雖高，僅靠此一特性仍不足以保證防偽效用[40]，因
此相關研究都還會進一步使用密碼技術來補強，結合密碼學的強固特性讓複製仿
造變得極為困難，們有較為接近的想法，認為運用非對稱式密碼加上雜湊函數的
數位簽章機制，能確保 RFID 標籤內的資訊更為安全，並且在 RFID 標籤和讀取器
之間加上鑑別協定(Authentication Protocol)，就能有效防止偽造的標籤及非法的讀
取。 
2004 年，美國食品藥物管理局(US Food and Drug Administration, FDA)認可
RFID 應用於藥品的追溯[41]，做為減少偽藥的解決方案。這個解決方案是透過電
子藥譜(E-Pedigree)的建立，將藥品運送、儲存、交易的每一筆資料加以記錄，整
個藥品供應鏈協助電子藥譜的建立，成就全面的監護網絡。任何人對某項藥品有
所疑慮，即可透過電子藥譜追溯到零售店、批發商及藥品供應商，每個單項藥品
都要做到追蹤管理。由於偽藥氾濫，每年皆對藥品製造商造成億萬美元的商業損
害，因此 FDA 對電子藥譜採樂觀態度看待，認為電子藥譜的實行將能有助於解決
偽藥製品的問題。 
這樣的機制實施，目前具體進行的有 Texas Instruments(TI)和 VeriSign 宣佈一
項 RFID 技術與公開金鑰機制(PKI)的藥品驗證計畫[41]，此計畫分成兩個階段： 
第一階段的系統平台展開，透過 RFID 與 PKI 的系統建構，藥品供應商藉由
RFID 的可追蹤性來檢視藥品的配銷系統流程是否安全，達到藥品在供應鏈上的動
態監控。不過，要達到此一願景，製藥商必須先投注許多成本於 IT 追蹤系統的建
置和硬體設備的投資。 
在第二階段的系統部署，是宣導與鼓勵藥品供應鏈中所有成員，無論是製藥
工廠、藥品零售商或是藥局等，都能配合建制 RFID 與 PKI 的電子藥譜系統，讓
藥品在供應鏈的每一個環節都能確實的追蹤並查詢藥品的行蹤。 
在這個發展架構中，RFID 標籤內會被寫入三項訊息以作為後續控管藥品的重
要依據，分別是單一辨別碼 (Unique Identification, UID)、產品製造商辨識碼
 31 
 
圖 4.2  藥品上的 RFID 標籤[44] 
另外同樣是將 RFID 於防偽用途的例子，還有臺中市中興地政事務所於 2006
年提出的研究中[45]，認為應用 RFID 技術於權狀書狀的防偽是一種可能。目前權
利書狀的防偽辨識[45]，主要仍是憑藉視覺或觸覺以人工判別方式進行辨識，需要
的輔助工具不外乎是利用放大鏡及紫外燈光源照射，進行防偽標記之檢驗。雖然
目前的權利書狀尚未加入電子防偽技術，不過若將 RFID 電子標籤整合成為權利
書狀的防偽機制之一， RFID 電子標籤生產之初即被賦予一個 ID，基本上這個無
法被修改的 ID 就可做為辨識的依據，也就是 RFID 標籤貼在權利書狀上，就多了
一項技術門檻較高的保護措施。而為了徹底確保 RFID 標籤不會被複製，進一步
預留一些欄位儲存電子簽章，確保 RFID 電子標籤內容不被竄改，並於地政單位
使用者端的應用系統提供數位簽章之查驗功能。 
 
圖 4.3 我國所有權狀的防偽辨識設計[45] 
有價票證常是偽造的最大目標，像美鈔、歐元等世界性流通的貨幣，都是歹
徒最想偽造的貨幣，所以各國政府將偽幣的防範視為重點，而由於 RFID 的快速
讀寫性，近年來將打擊偽造品的焦點放在 RFID 上，試圖從 RFID 的功能找出防偽
的可能性。但是 RFID 本身的原始設計概念不是為了提供安全標準的「身分辨識」
而設計的，因此在現有安全功能上還所有不足，目前還無法仰賴 RFID 的特性來
達到辨識偽鈔的目的，仍然得配合其他合適的防偽方案，以及完善的管理系統才
能夠達到防止偽鈔的功用。 
 
 33 
不過，目前應用普及和低成本的 RFID 標籤並非所謂的“Smart Tag”，僅是一種以
無線方式存取的媒體，沒有能力對讀取器做驗證！在這樣的情況下，惡意人士只
要攜帶手持式讀取器讀取產品就能取得原廠的簽章值，而仿冒業者在製造仿冒品
時就將取得的原廠簽章寫入 RFID 標籤，並送到各通路門市販售。當消費大眾購
買產品提出驗證產品的真偽時，通路門市的讀取器會向產品上的 RFID 標籤發出
讀取的要求，而且由於仿冒品 RFID 標籤已寫入原廠的簽章值，因此亦可向消費
大眾證明簽章的真偽(如圖 22 虛線之下的流程)。 
其實，這些防偽設計的迷思，是認為只要把簽章值寫入 RFID 標籤中，並驗
證簽章就能達到防偽作用。而我們要在此指出這些設計的最大問題，是沒有真正
了解數位簽章的意義！利用數位簽章技術所簽署出來的文件，是為了能讓任何人
做驗證，數位簽章與其文件本來就是要散佈傳遞的，然而如果把這樣的概念應用
在防偽的設計上，只要把 RFID 標籤中的簽章及相關資訊複製出來，儲存到另一
個 RFID 標籤上，這個 RFID 標籤上具有完全相同的資訊與簽章，當然也能通過驗
證，所以只有簽章是沒有辦法達到防偽的。究竟如何才能讓 RFID 標籤真正具有
防偽作用呢？這要從 RFID 整個系統的運作架構重新檢討，這是我們計畫中將要
做到的研究成果之一。 
另外，如果未來在理論上較被認同的“Smart Tag”能發展並普及，電子標籤的
晶片上加入主動防止被非法讀取的機制，其可以判斷要來讀取其資料的訊號是否
來自於合法授權的讀取器，若不是就不會送出任何資料，如此即能對防偽機制有
更佳的保障。 
如果要對“Smart Tag”做更明確的定義，我們可以參考 Rieback 等人在 2005 年
提出的論述[46]： 
 RFID 電子標籤與讀取器的能見度(Visibility of RFID Tags and RFID 
Readers)： 
在整個 RFID 系統的運作架構下，必須能定義清楚電子標籤上的資料可
被讀取的狀態，像是哪些資料可永遠被讀取或哪些資料受到保護，這在
電子標籤被核發出來都要明確定義，而讀取器被授權可讀取哪些電子標
籤也是應該定義清楚。 
 RFID 電子標籤的存取方式(Access and Modification of RFID Tag Data)： 
必須有適當的規劃設計，也就是電子標籤的所有權歸屬人可用何種方式
合法存取電子標籤的資訊。 
 採用適當的隱私保護機制(Usage of Privacy-Enhancing Technologies)： 
電子標籤的所有權歸屬必須有一套運作機制，讓所有權能合理轉移，而
 35 
向產品公司取得 EPC Code 的 Protocol。 
2. Purchase Phase：產品從授權代理商要出售給消費者。 
3. Brand Tag Verification Phase：商品擁有者可將購買的商品拿至授權的 Reader
驗證其 Tag 的真偽。 
 
 
                     Brand Tag Issuing Phase                  
  PKs, SKs                    PKR , SKR,PKs                   IDT  
   Server                 Reader                 Tag    
(Brand Company)                        (OEM) 
          1. Request 
          2. IDT 
3.1 決定產品類別 TypeEPC 
3.2 C1 = EpkS (IDR, IDT) 
3.3 現在時間 T1R，防止訊息被攔截重送攻擊 
3.4 S1 = SskR( H(T1R,IDR ,IDT ) 
3.5 T1R, C1, S1, TypeEPC, CertR 
4.1 檢驗 T1R 是否在合理的時間範圍內 
4.2 檢驗憑證 CertR 並取出 Reader 的 PKR 
4.3 解密 DskS (C1)得出 IDR ,IDT 
4.4 檢驗 VpkR(S1)
?=H(T1R, IDR, IDT) 
4.5 檢驗 IDR是否為資料庫內有記錄的授權 OEM 廠之 Reader 
4.6 根據 TypeEPC配給對應的產品 EPCT  
4.7 產生一個流水號 SN 
4.8 產生一個 KeyT設定為之後對該 Tag 寫入保護的驗證值 
4.9 記錄 IDT, IDR, KeyT, EPCT, SN, T1R 
4.10 SGT = SskS(H(IDT ||EPCT || SN)) 
4.11 C2 = EpkR(KeyT, EPCT, SN, SG T ) 
4.12 現在時間 T2S，防止訊息被攔截重送攻擊 
4.13 S2 = SskS(H( T2S, KeyT, EPCT, SN, SGT))  
4.14  T2S ,C2 ,S2 
5.1 檢驗 T2S是否在合理的時間範圍內 
5.2 解密 DskR(C2)得出 KeyT, EPCT, SN, SG T 
5.3 檢驗 VpkS(S2)
?=H(T2S, KeyT, EPCT, SN, SGT) 
 37 
5.1 檢驗 T4S是否在合理的時間範圍內 
5.2 解密 DskR(C4)取得 Msg, KeyT, SN’, SGT’ 
5.3 檢驗 VpkS (S4)
?=H(T4S, Msg, KeyT,SN’, SGT’) 
5.4 印給消費者有 Msg 的交易收據 
5.5  KeyT, SN’, SGT’ 
6.1 以 KeyT 寫入 SN’, SGT’ 
  (即 SN= SN’ , SGT＝SGT’) 
 
 
                   Brand Tag Verification Phase                
  PKs, SKs                  PKR , SKR, PKs           IDT, EPCT,SN,SGT 
   Server               Reader                  Tag    
(Brand Company)                 (Authorized Agent) 
          1. Request 
          2. IDT, EPCT, SN , SGT 
3.1 檢驗 VpkS(SGT )
?=  H(IDT ||EPCT || SN)  
假若驗證不通過則不會繼續執行(簽章可以 off-line 驗證) 
3.2 C5 = EpkS ( IDR, IDT, SGT) 
3.3 現在時間 T5R，防止訊息被攔截重送攻擊 
3.4 S5 = SskR (H(T5R ,IDR, IDT, SGT)) 
3.5  T5R ,C5, S5, CertR 
4.1 檢驗 T5R是否在合理的時間範圍內 
4.2 檢驗憑證 CertR並取出 Reader 的 PKR 
4.3 解密 DskS (C5)得出 IDR, IDT, SGT 
4.4 檢驗 VpkR(S5)
?=H(T5R, IDR, IDT, SGT) 
4.5 檢驗 IDR是否為 Server 資料庫內有記錄的授權代理商之 Reader 
4.6 查資料庫中 IDT的記錄之 IDT 、EPCT和 SN，驗證 VpkS(SGT )
?=H(IDT ||EPCT || 
SN) 
4.7 查資料庫中 IDT的記錄之確認碼 Msg 
4.8  C6= EpkR(Msg)  
4.9 現在時間 T6S，防止訊息被攔截重送攻擊 
4.10 S6 = SskS(H(T6S, Msg)) 
4.11  T6S, C6, S6 
5.1 檢驗 T6S是否在合理的時間範圍內 
5.2 解密 DskR (C6)得出 Msg 
 39 
到防偽架構設計精神，如下圖 4.5 所示： 
 
 
 
 
 
 
 
圖 4.5 Off-line 驗證 
在 Off-line 情況下驗證簽章值真偽，可以初步過濾不是該製造商的產品或是很
明顯就是有問題的 Tag，故可以避免不必要的網路資源浪費和製造商 Server 的負
擔。 
(2) On-line 的檢驗 
在第二章國內外導入 PKI 於 RFID 防偽應用之案例介紹，可知道大部分的防
偽機制是認為只要在產品製造時將廠商的簽章值寫入 RFID 標籤內，後來藉由簽
章的驗證就能達到防偽作用。我們要在此指出這些設計的最大問題是沒有真正了
解數位簽章的意義！利用數位簽章技術所簽署出來的文件，是為了能讓任何人做
驗證，數位簽章與其文件本來就是要散佈傳遞的，然而如果把這樣的概念應用在
防偽的設計上，只要把 RFID 標籤中的簽章及相關資訊複製出來，存到另一個 RFID
標籤上，這個 RFID 標籤具有完全相同的資訊與簽章，當然也能通過驗證，所以
只有簽章是沒有辦法達到防偽的，仿冒業者只要取得一個正確的 RFID 標籤簽章
值，就能進行大量的偽造，如下圖 4.6 所示：  
要求讀取 
向消費大眾證明簽章真偽 
(以原製造者公鑰驗證簽章) 
原製造者  藥品  通路門市  藥品 消費大眾 
簽章值 
原製造者將已寫入簽章值
的 RFID標籤嵌入到產品
中，並且送到通路門市販售
 41 
Tag Verification Phase 的步驟 3.2。 
 Reader 端簽章： 
在 Brand Tag Issuing Phase 的步驟 3.4、Purchase Phase 的步驟 3.5、Brand 
Tag Verification Phase 的步驟 3.4 和 5.7。 
而原製造商的 Server 收到這些加密與簽章訊息，會進行以下解密和檢驗簽章
的動作： 
 Server 端解密： 
在 Brand Tag Issuing Phase 的步驟 4.3、Purchase Phase 的步驟 4.3、Brand 
Tag Verification Phase 的步驟 4.3。 
 Server 端驗證簽章： 
在 Brand Tag Issuing Phase 的步驟 4.4、Purchase Phase 的步驟 4.4、Brand 
Tag Verification Phase 中的步驟 4.4 和 6.2。 
當然，Server 傳送給 Reader 的訊息，同樣要做適當的加密與簽章，以確保通
訊的安全性與完整性： 
 Server 端加密： 
在 Brand Tag Issuing Phase 的步驟 4.11、Purchase Phase 的步驟 4.11、Brand 
Tag Verification Phase 的步驟 4.8 和 6.7。 
 Server 端簽章： 
在 Brand Tag Issuing Phase 的步驟 4.13、Purchase Phase 的步驟 4.13、Brand 
Tag Verification Phase 的步驟 4.10 和 6.9。 
同樣的，當 Reader 收到這些加密與簽章訊息，會進行以下解密和檢驗簽章的
動作： 
 Reader 端解密： 
在 Brand Tag Issuing Phase 的步驟 5.2、Purchase Phase 的步驟 5.2、Brand 
Tag Verification Phase 的步驟 5.2 和 7.2。 
 Reader 端驗證簽章： 
在 Brand Tag Issuing Phase 的步驟 5.3、Purchase Phase 的步驟 5.3、Brand 
Tag Verification Phase 的步驟 5.3 和 7.3。 
此外，為了防止重送攻擊可能發生在各 Phase 裡，所以不管是在 Server 端還
Client (Reader)端在傳送資料時，都必須加入一個時間當作參數，來防止重送攻擊
的可能。 
4.3 結論 
 43 
第五章 RFID 應用於供應鏈管理與所有權轉移研究 
當更進一步探究 RFID 電子標籤的生命週期，不論是在辨識用途或貨品管理，
很多應用情境會需要考量安全性與隱私性都設計得更高的電子標籤應該有所謂
「所有權移轉(Ownership Transfer)」之研究空間。如以商流過程來說，從製造商到
通路商，若貨品上還是使用同一個電子標籤，其存取權限如何移轉過去，移轉過
後則製造商不再允許存取進入下一階段的電子標籤，而通路商則不至於能讀取到
先前階段的關鍵資訊，也就是說要能達成“forward untraceability”。當然，商流過
程中還有通路商到零售商、零售商到消費者、消費者與消費者間二手買賣、消費
者將商品送修回廠維修、及最後商品損壞後可能回收還可使用的電子標籤，這些
環節中都有所有權移轉的研究空間，而且是有很實際的應用價值，值得深入探討。 
圖 5.1  商流過程的各種所有權移轉時機 
5.1 供應鏈管理與 RFID 的崛起 
    近年來供應鏈管理研究重心，更逐漸走向與上下游廠商及其他相關企業之間
更緊密的合夥關係，企業之間彼此常會有訊息或貨品流通的情形發生，有時甚至
會面臨跨國的運輸，則此時企業必須面對貨運承攬、通關、海空運輸等過程中可
能的變異所產生的風險，可能的風險如未準時送達的缺貨以及可能的過量庫存。
而運輸管理層面的全球供應鏈透明化( Global Supply Chain Visibility )則是一種可
行的解決方案，其主要精神即是建立一個系統，以電子化的方式串接由訂單到商
品送到顧客端的全球海空運輸、通關、倉儲等運輸過程，以確保能即時取得商品
運輸狀況，進而可有效掌控整個物流運籌過程。全球供應鏈透明化大致可分為兩
部分，一個是主動管理機制(如圖 5.2)，另一個則為即時更新貨品狀況與各項檔資
訊，如採購訂單、入倉單、提貨單等。 
 45 
2.電子標籤的驗證：貨品從賣方轉移到買方時，買方會在存取過程中驗證電子
標籤的真偽，確認是來自賣方。 
3.無關聯性：貨品電子標籤被讀取出的訊息，不應被找出其在供應鏈流向之關
聯性。 
4.供應鏈的可視性：若供應鏈存在一個運籌管理中心，其應能直接存取貨品電
子標籤且即時掌握其所在位置，以有效追蹤貨品流向。 
更進一步，就 RFID 的特性與其應用於電子化交易程式上，我們認為其運算
能力都應有適當的考量及設計，而交易過程更應達到雙方不可否認性。所以，交
易時應該還需具備下列二點特性： 
1.不可否認：交易過程中，買賣雙方不能否認自身曾發出的訊息。 
2.符合 RFID 系統的可行運算：由於目前為降低電子標籤的成本，使用的電子
標籤運算能力仍相當有限，所以在設計上需注意運算的複雜度。 
若要讓交易的雙方要進行安全的所有權移轉，就是要想辦法讓買方在收到 
貨品時能夠確認貨品來自於賣方，之後將貨品內的電子標籤驗證值進行更新以達
到所有權移轉，然而要達到此目標，最好的方式就是讓買賣雙方事先協調好共用
秘密，但由於供應鏈上上下游廠商之間的關係都是在交易發生後才會存在，因此
無法在選定廠商前就協議好雙方的秘密，於是我們想到透過網際網路的方式去讓
交易雙方協調出共用秘密，將來買方在收到貨物而準備要執行所有權移轉前，可
透過賣方寫入到出貨貨品電子標籤內的共用秘密去判定貨品來自賣方，而後對電
子標籤進行驗證值的更新來達到所有權安全移轉。至於，為了提供供應鏈的透明
化，使貨品在轉送過程中是可隨時被掌握的，因此我們考慮加入物流業者的角色，
並讓物流業者能夠對貨品進行盤點，同時必須確保物流業者無法進行所有權移
轉，所以我們考慮只將部分秘密告知物流業者。 
5.2.1 系統架構 
 
Phase3 
Phase2 
賣方寫協商值到
Tag裡 
Phase4 
貨品所有權轉移 
協商交易的 
共同金鑰 
賣方  買方 
BServer  AServer  
     
AaderRe   BaderRe  
Tag  
物流業者具有有限權
限，可盤點 
 (選擇性的) 
Tag  
 47 
           pgY BXB mod=  
然後將上述欲交給賣方的訊息 BY 及訂單 BOrd ，組成訊息 BM ： 
    )||( BBB OrdYM =  
接著用自己的私鑰將訊息 BM 簽章： 
 ))(( BSKM MHSigSG BB =  
再以賣方的公鑰 APK ，將訊息 BM 與其簽章值進行加密 ),( BA MBPK SGME ，
連同買方本身的憑證 BCert ，一起傳送給賣方。 
步驟 二. 賣方收到上述訊息之後，使用自己的私鑰解開密文，得出訊息 BM 與其簽
章值，並驗證其完整性：  
 )()(
?
BB MPKB
SGVMH =  
        經驗證後可得出訊息 BY ，假設賣方隨機選出一個整數 AX ，同樣會產生
對應的訊息 AY ： 
          pgY AXA mod=  
        我們知道藉由 Diffie-Hellman 金鑰協議方式可得出一把共同協商金鑰        
pY AXB mod ，而只需取出其中部分長度來當共同金鑰 1CK 及 2CK ，分別定
義為各取前後 96bits 並紀錄下來。 
然後將欲回傳給買方伺服器的訊息 AY 、給買方訂單的回應 resp 及電子標
籤的相關資訊 TagInfo 組成訊息 AM ： 
    )||||( TagAA InforespYM =  
接著用自己的私鑰將訊息 AM 簽章： 
          ))(( ASKM MHSigSG AA =  
再以買方的公鑰 BPK ，將訊息 AM 與其簽章加密 ),( AB MAPK SGME ，連同 賣
方本身的憑證 ACert ，一起傳送給買方。 
步驟 三. 買方收到上述訊息之後，使用自己的私鑰解開密文，來得出訊息 AM 與其
簽章值，並驗證其完整性： 
  )()(
?
AA MPKA
SGVMH =  
        確認完整性後可取得訊息 AY ，透過運算 pY BXA mod 得出一把共同協商金
鑰，取其中前 96bits 和最後 96bits 作為兩把共同金鑰 1CK 及 2CK 並紀錄起
來。 
步驟 四. 這是個選擇性執行的步驟，如果將物流業者這個角色考慮進來，讓其具  
備有限的權限而能在運貨的過程中去存取電子標籤，則賣方必須多此步
 49 
2CK ： 
    
2)1())11(3(
1)1())1(2(
CKRCKRCCKM
CKRCKRCKM
Tag
TagTag
=⊕⊕⊕−
=⊕⊕⊕−  
然後回覆 ACK 給賣方伺服器，告知已成功取得 1CK 及 2CK 並紀錄在電子標
籤，未來也只有知道這兩把金鑰才可做所有權轉移，接著此產品便可準備
出貨。 
 
 
5.2.4 物流業者控管貨品階段 
這是個選擇性執行的階段，物流業者可存取電子標籤，並依照出貨清單的資
訊來得知所負責運送的貨品之動向(如圖 5.6)。 
 
圖 5.6 物流業者控管貨品階段 
步驟 一. 授權的物流業者隨機產生一個亂數值 2RC ，與 2CK 做互斥或運算，然後
傳送給電子標籤。 
步驟 二. 當電子標籤收到該值，可透過已知的一把共同金鑰 2CK 解得 2RC ，經下 
列運算產生訊息 4M ： 
            )22()2(4 RCCKRCTIDM ⊕+⊕=  
步驟 三. 物流業者可根據 2RC 與 2CK 解出電子標籤序號TID ，與資料庫內的訂貨清
單進行資料比對，以確認貨品動向。 
 
5.2.5 貨品所有權轉移階段 
當貨品由賣方廠商送達買方指定處，買方伺服器先驗證貨品電子標籤之真
偽，當確認貨品來自賣方後，買方伺服器便產生新的電子標籤存取金鑰並要求電
子標籤做更新，來達到貨品所有權轉移(如圖 5.7)。 
1.要求讀取Tag資訊 
3.比對清單資料是否吻合
2.回應訊息供物流業者進行 
物流業者 Tag 
 51 
步驟 四. 當電子標籤收到上述訊息之後，便能以自己內存的 1CK 及 TagK 經由 7M 解
出 TagK' ： 
   ')3())31(7( TagTag KRCKRCCKM =⊕⊕⊕−  
 然後經由 6M 進一步對 TagK' 的正確性做下列驗證： 
    )21()32(83 '
?
CKCKRCCKKMRC Tag ⊕⊕⊕⊕−=  
 如果上述式子皆成立，代表已通過買方伺服器的驗證，同時也取得新  的
存取金鑰 TagK' ，便進一步將原有的金鑰 TagK 更新為 TagK' ，然後回覆 ACK 給
買方伺服器，即完成電子標籤的所有權轉移程式。 
 
5.3 安全性分析 
    在章節二中列出 RFID 應用於供應鏈上需滿足之條件，底下我們將依據每個
條件逐一進行分析： 
5.3.1 存取授權： 
這項重點是交易完成後僅有買方才能存取該貨品電子標籤，而我們的設計是
讓買方能重新設定電子標籤之存取金鑰，賣方即無法對該電子標籤再進行存取。
而為了讓買方可以決定電子標籤的存取金鑰，在我們設計的買賣雙方協商共同金
鑰階段，買方伺服器及賣方伺服器用 Diffie-Hellman 金鑰協議方式協商出買賣雙方
才知道的共同金鑰 1CK 及 2CK ，賣方出貨前先將 1CK 及 2CK 安全的存入電子標
籤，當買方收貨時就能用同樣的 1CK 及 2CK 重新設定標籤內的存取金鑰 TagK 。 
    在電子標籤寫入協商金鑰階段的步驟三，賣方伺服器以 TagK 去保護 1CK 及
2CK ，連同本身產生的隨機亂數 1RC 運算產生訊息 2M 與 3M ：            
       
)11()12(3
)1()1(12
RCCKRCKCKM
RCKRCKCKM
Tag
TagTag
⊕+⊕⊕=
⊕+⊕⊕=
 
    所以在電子標籤寫入協商金鑰階段的步驟四，電子標籤可透過 TagK 運算得出
1CK 及 2CK ： 
 53 
以TID確認為賣方出貨清單中所列之貨品，然後經由 6M 對 TagK 的正確性做下列驗
證：       
       )21())3(6(3
?
CKCKRCKMRC Tag ⊕⊕⊕−=  
倘若上式驗證無誤代表該電子標籤內存在著買賣雙方當初在訂購時協商的共
同金鑰 1CK 及 2CK ，則確認該貨品來自於賣方。因為買賣雙方才知道 1CK 及 2CK ，
攻擊者無法偽造出相同訊息來通過驗證，所以買方可對貨品電子標籤加以驗證。 
5.3.3 無關聯性： 
為了確保貨品電子標籤被讀取出的訊息不被找出其在供應鏈流向之關聯性，
所以電子標籤被讀取訊息中的序號必須保證不被攻擊者解出，而且也不可被找出
其在交易過程各階段的關聯性。為了達到這樣的目的，在我們的設計中，無論是
在哪個當階段去讀取電子標籤，得到的回應訊息都會以不同的金鑰做保護，且加
入亂數使得每次的回應都有所不同。接下來，我們列出三個階段中和電子標籤回
應訊息相關的部分： 
1.在電子標籤寫入協商金鑰階段的步驟二，電子標籤以存取金鑰
TagK 去保護
TID ，產生回應訊息： 
         )1()1(1 RCKRCTIDM Tag ⊕+⊕=  
2.在物流業者控管貨品階段的步驟二，電子標籤以共同金鑰 2CK 去保護TID，
產生回應訊息 4M ： 
         )22()2(4 RCCKRCTIDM ⊕+⊕=  
3.在貨品所有權轉移階段的步驟二，電子標籤以共同金鑰 1CK 及 2CK 保護TID
和
TagK ，產生回應訊息 5M 與 6M ： 
         
)3()321(6
)2||3()3||1()||(5
RCKRCCKCKM
CKRCRCCKTIDKM
Tag
Tag
⊕+⊕⊕=
+⊕=  
很明顯地，上述訊息都只有合法讀取者才能以正確的金鑰 TagK 或 1CK 與
2CK ，解出TID。此外，雖然上述訊息中的亂數都是由讀取方決定，縱使攻擊者假
扮讀取方對電子標籤提出以相同亂數值做出回應訊息的要求，由上述可知電子標
籤在每個階段的回應值皆不相同，攻擊者亦無法找出同一電子標籤在不同階段回
應訊息的關聯性。                                                                     
 55 
第六章  研究成果自評 
我們在既有的基礎，進一步研究有關 RFID 電子標籤的辨識、驗證、存取控
制、防偽，這幾項研究是不可分割的，才能做出最完善的設計。 
在 RFID 驗證機制，設計方向就是在驗證進行過程中不致出現固定的驗證值，
一方面防止中間第三者可能攔截重送攻擊，另一方面防止被有心人士追查而洩漏
持有者的行蹤，這是很重要的隱私問題。 
在 RFID 存取控制，設計方向是使用兩次 Challenge-Response 達成相互驗證，
並進一步對存取控制研究之其他安全條件做深入探討，像是位置隱私、重送攻擊、
DoS 攻擊、竊聽、通訊量分析等，就能以更周延的觀點將安全漏洞做好改善，提
出更安全的 RFID Tag 存取控制協定。而且我們還會針對某些應用環境下必須對
Reader 的存取權限有所區隔時，讓 Reader 有不同存取權限的存取控制機制，在這
個計畫中，是不同權限讀取器安全存取控制協定，在協定中明確定義使用的相關
參數及詳細的步驟流程，針對各個讀取器有不同權限，後端資料庫伺服器不需儲
存權限對照表，且能保證使用者資料的隱私以及電子標籤和讀取器之間能夠互相
驗證。並且因為電腦系統的存取控制研究早已邁入無對照表的概念，以降低伺服
器被入侵的風險及維護的成本，所以本計畫以此精神提出的設計更安全也更具實
用性，並且達到了相互認證、匿名性、機密性和完整性的條件。另外，也從實務
的考量做了複雜度的分析，所設計的存取控制協定對於電子標籤、讀取器和資料
庫伺服器的運算能力都是可接受的。 
在 RFID 防偽方面，對現有防偽系統提出可能的攻擊弱點並改進之，而且會
針對商品生產流程做更多的設計，做出較大的系統規劃。然後，再針對不同的應
用情境，檢討使用數位簽章的設計如何改良。 
並且我們對於 RFID 供應鏈有延伸的研究。我們的協定不僅適用於供應鏈上貨
品的所有權轉移，也將物流與供應鏈的可視性一併考慮進來，以提高追蹤與管理
貨品的整體效率。另外，也考量到讀取器合法的存取權，且透過驗證傳輸訊息之
完整性來維持伺服器與電子標籤的內容值同步，同時更不必擔心對方否認這筆交
易。而為了符合低成本電子標籤所具備有限的運算能力，我們讓電子標籤只需執
行一些輕量的運算，因此本設計使用的成本既實際又可行，能廣泛的應用於 RFID
系統下的各類貨品交易及轉賣環境，也適用於日常生活中一般網路下訂單的小型
交易。 
本研究不僅有理論上的價值，亦對實務應用提供一個良好的發展經驗，此計畫
研究有效整合RFID的幾個重要安全議題之研究，並對研究成果進行實作，具有前
瞻性與務實性的研究，將有效提升RFID系統的實用性與安全性。 
 
 57 
The  Counterfeit  imposes  a  menace  to  industry  worldwide,  and  the 
problem is not specific for certain products or countries. In 2003, Koh 
et al. describe a RFID  system based on  “track and  trace”  solution  to 
apply  into  pharmaceutical  supply  chain  management  to  fight  the 
counterfeit.  Moreover,  there  are  applications  to  solve  malicious 
manner were presented. But there always still existed some disputes 
and  not  conform  Class  1  Generation  2  (C1G2)  standards. 
Unfortunately,  the  trick  is  changeable.  The  Koh  et  al.’s  scheme  is  at 
premise rather primitive.  In order to tackle this problem, we propose 
an  anti‐counterfeit  ownership  transfer  protocol  for  low  cost  RFID 
system.  We  only  use  a  tag  to  be  a  storage  media.  The  proposed 
scheme can ensure a secure transaction. 
In  this  research, we propose a RFID access control scheme. Not only 
the authentication mechanism but also the access right authorization 
mechanism is designed in our scheme. It is designed for low‐cost RFID 
system.  Our  scheme  is  more  suitable  for  meeting  the  RFID  system 
demands of the future. Moreover, we also propose a tamper resistant 
prescription  RFID  access  control  protocol  for  different  authorized 
readers. Not only  the authentication mechanism but also  the access 
right  authorization mechanism  is  designed  in  our  scheme. Only  the 
specific  doctor,  usually  the  patient’s  doctor,  can  access  the  tag. 
Moreover,  some  relative  information  of  patient’s  prescription  is 
attached to a RFID tag for tamper resistant. The patients’ rights will be 
guaranteed. 
可利用之產業 
及 
可開發之產品 
本研究不僅有理論上的價值，亦對實務應用提供一個良好的發展經
驗，此計畫研究有效整合 RFID 的幾個重要安全議題之研究，並對
研究成果進行實作，具有前瞻性與務實性的研究，將有效提升 RFID
系統的實用性與安全性。 
技術特點 
我們在既有的基礎，進一步研究有關 RFID 電子標籤的辨識、驗證、
存取控制、防偽，這幾項研究是不可分割的，才能做出最完善的設
計。 
推廣及運用的價值
一、 在 RFID 驗證機制，設計方向就是在驗證進行過程中不致出
現固定的驗證值，一方面防止中間第三者可能攔截重送攻
擊，另一方面防止被有心人士追查而洩漏持有者的行蹤，這
是很重要的隱私問題。 
二、 在 RFID 存取控制，設計方向是使用兩次 Challenge‐Response
達成相互驗證，並進一步對存取控制研究之其他安全條件做
深入探討，像是位置隱私、重送攻擊、DoS攻擊、竊聽、通
訊量分析等，就能以更周延的觀點將安全漏洞做好改善，提
出更安全的 RFID Tag 存取控制協定。而且我們還會針對某些
應用環境下必須對 Reader的存取權限有所區隔時，讓 Reader
有不同存取權限的存取控制機制，在這個計畫中，是不同權
 59 
參考文獻 
1. 資策會創新應用研究所整理,  “我國 RFID 公領域應用推動藍圖”, RFID 應用
推動辦公室網站, http://rfid.org.tw/content.php?sn=112, 2006. 
2. R. Koh, E. Schuster, I. Chackrabarti, and A. Bellman, “Securing the Pharmaceutical 
Supply Chain”, White Paper, Auto‐ID Labs, Massachusetts Institute of Technology, 
2003. 
3. M. Lehtonen, T. Staake, F. Michahelles, and E. Fleisch, “From Identification to 
Authentication ‐ A Review of RFID Product Authentication Techniques”, Printed 
handout of Workshop on RFID Security, July, 2006. 
4. S. Weis, S. Sarma, R. Rivest and D. Engels, “Security and Privacy Aspects of 
Low-Cost Radio Frequency Identification Systems”, in 1st Intern. Conference on 
Security in Pervasive Computing (SPC), Boppard, Germany, March 12-14, 2003. 
5. D. Henrici and P. Muller, “Hash-based Enhancement of Location Privacy for 
Radio-Frequency Identification Devices using Varying Identfiers”, Proceedings of 
the Second IEEE Annual Conference on Pervasive Computing and 
Communications Workshops, pp.149-153, Mar, 2004 
6. M. Ohkubo, K. Suzuki, and S. Kinoshita, “Cryptographic Approach to 
Privacy-Friendly Tags”, RFID Privacy Workshop, MIT, MA, USA, November, 
2003. 
7. G. Avoine and P. Oechslin, “A Scalable and Provably Secure Hash Based RFID 
Protocol”, 2nd IEEE International Workshop on Pervasive Computing and 
Communication Security, IEEE Computer Society Press, pp.110-114, 2005. 
8. S. M. Lee, Y. J. Hwang, D. H. Lee, and J. I. Lim, “Efficient Authentication for 
Low-Cost RFID systems”, International Conference on Computational Science 
and its Applications - ICCSA 2005, pp.619-627, 2005. 
9. E. Y. Choi, S. M. Lee, and D. H. Lee, “Efficient RFID Aauthentication Protocol 
for Ubiquitous Computing Environment”, International Workshop on Security in 
Ubiquitous Computing Systems, 2005. 
10. S. H. Lee, T. Y. Asano, and K. G. Kim, “RFID Mutual Authentication Scheme 
Based on Synchronized Secret Information”, Symposium on Cryptography and 
Information Security, January, 2006. 
11. J. Pearson, “Securing the Pharmaceutical Supply Chain with RFID and Public-key 
Infrastructure (PKI) Technologies”, Texas Instruments White Paper, June, 2005. 
 61 
24. P. Tuyls and L. Batina, “RFID-Tags for Anti-Counterfeiting”, The Cryptographers’ 
Track at the RSA Conference (CT-RSA), LNCS Vol.3860, pp.115–131, Feb 13-17, 
2006. 
25. M. Feldhofer, “A Proposal for Authentication Protocol in a Security Layer for 
RFID Smart Tags”, Stiftung Secure Information and Communication Technologies 
SIC, 2003. 
26. M. Feldhofer, S. Dominikus, and J. Wolkerstorfer, “Strong Authentication for RFID 
Systems using the AES Algorithm”, Workshop on Cryptographic Hardware and 
Embedded Systems - CHES 2004, LNCS 3156, pp.357-370, 2004. 
27. S. Dominikus, E. Oswald, and M. Feldhofer, “Symmetric Authentication for RFID 
Systems in Practice”, Workshop on RFID and Lightweight Crypto, July 14-15, 
2005. 
28. D. Bailey and A. Juels., “Shoehorning Security into the EPC Standard”, In 
International Conference on Security in Communication Networks, pp. 303–320, 
2006. 
29. A. Juels and S. Weis, “Authenticating Pervasive Devices with Human Protocols”, 
Advances in Cryptology - CRYPTO 2005, Vol.3126, pp.293–308, 2005. 
30. N. Hopper and M. Blum, “A Secure Human-Computer Authentication Scheme”, 
Technical Report of Carnegie Mellon University, CMU-CS-00-139, 2000. 
31. T. Dimitriou, “A Secure and Efficient RFID Protocol that Could Make Big Brother 
(partially) Obsolete”, International Conference on Pervasive Computing and 
Communications, 2006. 
32. T. Dimitriou, “A Lightweight RFID Protocol to Protect Against Traceability and 
Cloning Attacks”, Proceedings of the First International Conference on Security 
and Privacy for Emerging Areas in Communications Networks, pp.59-66, 2005. 
33. D.N. Duc, J. Park, H. Lee and K. Kim, “Enhancing Security of EPCglobal Gen-2 
RFID Tag against Traceability and Cloning”, 2006 Symposium on Cryptography 
and Information Security, 2006. 
34. S. J. Engberg, M. B. Harning, and C. D. Jensen, “Zero-knowledge Device 
Authentication: Privacy & Security Enhanced RFID Preserving Business Value 
and Cconsumer Convenience”, Second Annual Conference on Privacy, Security 
and Trust, 2004. 
35. X. Gao, Z. Xiang, H. Wang, J. Shen, J. Huang, and S. Song, “An Approach to 

the past researches [19-21], they all hold this 
contention and presume tag can capable secure and 
anti-counterfeit attacks by integrating digital 
signature [22] in their scheme. It is not a practical 
concept. 
Actually, the above anti-counterfeit designs 
which directly write the digital signature into the 
RFID tag, and identify the digital signature can not 
perform anti-counterfeit function. Here we point out 
the critical problem is that only use the digital 
signature can not achieve the anti-counterfeit 
function. We review past literatures [23-27] 
proposed about ownership transfer concept, but 
these literatures basically still use the symmetric key 
cryptographic function, hash function and PKC 
(Public Key Cryptography) method, and regard the 
RFID tag to be a “Smart Tag”. Because the current 
RFID tag’s logic gates are about 500-5000, it’s 
impossible to perform complex computations on the 
current RFID tags.  
The current RFID standard ratified by 
EPCglobal is named EPCglobal Class 1 Gen 2 
(Gen-2) RFID specification. We briefly summarize 
properties of Gen-2 RFID tag as follows [28]: 
(1)Gen-2 RFID tag is passive, meaning that it 
receives power supply from readers. 
(2)Gen-2 RFID tag communicates at UHF band 
(800-960 MHz) and its communication range is 
from 2 to 10 m. 
(3)Gen-2 RFID tag supports on-chip Pseudo-
Random Number Generator (PRNG) and Cyclic 
Redundancy Code (CRC) computation. 
(4)Gen-2 RFID's privacy protection mechanism is to 
make the tag permanently unusable once it 
receives the kill command with a valid 32-bit kill 
PIN. 
 (5)Read/Write to Gen-2 RFID tag's memory is 
allowed only after it is in secure mode. 
Due to the current RFID tag is just a storage 
media which accesses via wireless and the 
computing resource was limited. Therefore, there 
exits an insecure crisis, the intruder just need to 
carry a mobile reader and send a request information 
to a tag, tag will response information and signature 
to the reader, so the intruder will obtain the original 
signature easily. Continuously, the dummy-OEM 
only need to write the stolen signature into the RFID 
tag of any counterfeit product, and the intruder can 
forward these counterfeit products to the 
commercial agent for sale which is regarded as the 
legal products. Once the consumer purchases the 
product and asks to verify its validity, the reader of 
commercial agent will send a read request aim at the 
RFID tag on the product, the RFID tag will respond 
signature to the reader of commercial agent. Due to 
the stolen original signature has been written into 
the RFID tag, thus the commercial agent also can 
prove its correctness to the consumer. The scenarios 
are illustrated as Fig. 1.   
 In fact, the digital signature is used to be 
verified by anyone. However if such concept be 
applied to anti-counterfeit design, and anyone can 
duplicate the signature and relevant information 
from the RFID tag, and then store on another RFID 
tag. The false tags which with copies the legal 
signature can also pass the identification. That is 
only with signature mechanism can not perform 
anti-counterfeit. Thus, we propose a novel anti-
counterfeit ownership transfer protocol for RFID 
system with efficient and lightweight computation 
via online authentication. 
The proposed protocol should possess an 
online authentication and has the following 
requirements: 
(1) Against attacks (such as replay attack, man-in-
the-middle attack etc.). 
(2) Anti-counterfeit (Prevent a great deal of tag’s 
clone ) 
(3) Lightweight computation and conform C1G2 
standards. 
(4) With ownership transfer. 
The other sections of the paper are as follow: 
the proposed protocol content will be involved in 
section 2. We also analyze the requirements in 
section 3, and make a conclusion in section 4. 
 
 
2   Our Scheme 
Our scheme divides into three phases: (1) 
Initialization phase (2) Purchase Phase (3) 
Ownership transfer phase. The brief scenarios are 
illustrated in Fig.2. 
WSEAS TRANSACTIONS on COMPUTERS
Chin-Ling Chen, Yu-Yi Chen, Yu-Cheng Huang, 
Chen-Shen Liu, Chia-I Lin and Tzay-Farn Shih
ISSN: 1109-2750 1150 Issue 8, Volume 7, August 2008
wants to write data into tag. The 
reader needs the authorized 
key . TKey
SG：                the signature of the brand company. 
:
?
BA=              compare whether A  is equal to  or 
not. 
B
||:                      concatenation operation. 
 
 
2.2 Initialization Phase 
Suppose the OEM (Original Equipment 
Manufactures), the commercial agent and the 
authorized agent’s reader obtain the certificates from 
brand company via online authentication to verify if 
the communication correctly with the end server in 
advance. 
The Secure Socket Layer (SSL) channel is built 
between the brand company and commercial agent 
in advance. The identification of each reader and 
server depends on the secure channel of the PKI 
(Public Key Infrastructure). 
Therefore, the brand company authorized the 
OEM to manufacture new products. The OEM will 
read the IDT via the authorized reader which sending 
the information of the product to the brand company 
to get a unique EPC, serial number, digital signature 
and the authorized key KeyT. The information will 
also be recorded in the server database. 
Simultaneously, the OEM gets the authorized 
key KeyT, it will use the KeyT to write SN, EPC, 
digital signature into the product tag. The tag stored 
the product information (IDT, EPCT, SN, SGT). 
Finally, the product will be sent to the authorized 
commercial agent. 
 
 
2.3 The Purchase Phase 
In this phase, we describe the consumer how to 
buy the product from commercial agent, and the 
consumer how to identify the counterfeit products.  
Firstly, commercial agent’s reader makes an 
off-line authentication with the RFID tag, and shows 
the verification result to consumer. Once the 
consumer confirms to purchase the product, the 
commercial agent will ask the consumer to enter a 
password, and then the commercial agent will 
forward the hash value of password to the brand 
company’s server for registration.  
The brand company’s server will regenerate a 
new signature SGT’ and a new serial number SN’ for 
the RFID tag. The database will update and send 
related information including the authorized key 
KeyT to the commercial agent. The commercial 
agent’s reader uses the authorized key  to write 
the new signature and new serial number into the tag. 
TKey
 
 
2.4 Ownership Transfer Phase 
If the consumer A wants to sell and transfer the 
ownership of the products to consumer B, he can go 
to the authorized neighborhood site (authorized 
agent) to show B whether the product is original or 
not via the backend server sent back the message 
Msg. If the Msg is the same as the original one, the 
consumer B only trusts reader of this authorized 
agent. 
 Therefore, the consumer A enters the self-
setting password PW, and then the consumer B 
enters a new password PWnew,. The two passwords 
are calculated by one way hash function will transfer 
to the brand company server for authentication. 
After calculating the hash value of consumer 
B’s password, the new signature value will be sent 
back to the brand company server for generating a 
set of new signature, new serial number and 
identification message Msg. They will be transmitted 
to the authorized agent’s reader.  
Finally, the reader writes the new signature and 
serial number to the RFID tag by using the 
authorized key KeyT, and then prints the 
identification message Msg. The Fig. 3 shows the 
flow chart of the ownership transfer phase. 
Step 1：The reader sends a request message Mreg to 
the tag. 
Step 2： Upon receiving the Mreg, the tag will 
transfer the stored  
to the reader. 
) , , ,( TTT SGSNEPCID
Step 3：The reader will use the server’s public key 
to verify the correction of the as 
follows: 
TSG
)||||()(
?
SNEPCIDHSGV TTTs =  (1) 
If it is correct, the reader will use its own 
private key to make the signature of the 
message  )) , ,(( TTR SGIDIDH
)) , ,((1 TTRR SGIDIDHSS =           (2) 
The reader transfers  
),,,,( 1 RTTR CertSGSIDID  to the server. 
Step 4 ： After receiving the above message, the 
server will use the reader’s public key to 
verify CertR. If the verification is correct, 
the server will use the reader’s public key 
to verify the correction of as follows: 1S
WSEAS TRANSACTIONS on COMPUTERS
Chin-Ling Chen, Yu-Yi Chen, Yu-Cheng Huang, 
Chen-Shen Liu, Chia-I Lin and Tzay-Farn Shih
ISSN: 1109-2750 1152 Issue 8, Volume 7, August 2008
number and new signature .The tag 
doesn’t need to perform the complex operation 
entirely. Thus, the access time can be decreased. 
'SN 'TSG
 
 
 
 
 
(PKs, SKs)                                        (PKR , SKR, PKS )                                (IDT ,EPCT , SN ,SGT ) 
 
 
 
 
 
 
 
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Sever(S)                              Reader(R)                                                    Tag(T)                       
SSL channel 
(Authorized Agent)(Brand Company) 
1. M reg
3.1Vs(SGT)    H(IDT|| EPCT||SN)
?=
2. (IDT, EPCT, SN , SGT ) 3.2 S1 = SR (H(IDR, IDT, SGT)) 
3.3 (IDR, IDT, S1, SGT ,CertR)
4.1 Verify CertR and gain PKR?
4.2 VR (S1)    H (IDR, IDT, SGT)  
=
4.3 Check if IDR in database 
equals the received IDR 5.1 VS (S2)     H (Msg) 
?=?
4.4VS (SGT)    H(EPCT || SN)  ??
= 5.2 Consumer enters PW choice himself at buying time 
and generates a hash value H(PW)  
5.3 The new owner of the product enters new password 
PWnew and generates a hash value H(PWnew)  
5.4 S3= SR(H(H(PW), H(PWnew)))  
AAZZZZ=
4.5 Check if IDR in database of 
identification message 
4.6 S2 = SS(H(Msg))  
4.7  ( Msg, S2 ) 
?=
5.5  (H(PW),S3 ) 
6.1 VR (S3)    H(H(PW), H(PWnew)) 
6.2 Check if H (PW) of the IDT in database equals to the 
received H (PW) 
6.3 Check if the KeyT of the IDT  in database  
6.4 Generate new SN’ and new Msg’ 
6.5 Increase record IDT, IDR, KeyT, Msg, SN’, H(PWnew)
6.6 SGT’ = SS(H(EPCT || SN’ )) 
6.7 S4 = SS ( H( Msg’, KeyT, SN’, SGT’ )) 
6.8 (Msg’, keyT, SN’, SGT’, S4) 
7.1 V  )',',,'()(
?
4 TTS SGSNKeyMsgHS =
7.2 Print transaction receipt (includes Msg’) 
 and send it to consumer 
 7.3 Use the KeyT to write the SN’ 
and SGT’ into tag. 
Fig. 3. The flow chart of the ownership transfer phase 
WSEAS TRANSACTIONS on COMPUTERS
Chin-Ling Chen, Yu-Yi Chen, Yu-Cheng Huang, 
Chen-Shen Liu, Chia-I Lin and Tzay-Farn Shih
ISSN: 1109-2750 1154 Issue 8, Volume 7, August 2008
only permit the simple operations (for example 
exclusive-OR, random number generation and CRC 
operations) for tags’ operation. Some previous 
schemes often used the symmetric or asymmetric 
cryptosystem to implement their applications. These 
schemes do not conform the EPC C1G2 standards. 
Thus, they are not suitable to current low cost tag. 
Simultaneously, the proposed scheme can resist 
various attacks and with mutual authentication. 
None of the previous methods achieve all 
requirements, but the proposed method achieves all 
requirements. 
 
 
4   Conclusion 
At present, the cost of the RFID tag is still too 
high, in spite of many literatures are supposed that 
the RFID tag has sufficient computing resource. 
Due to the current tag are limited the logic gates, 
their proposals are impractical. Thus, how to add 
the anti-counterfeit mechanism to the passive RFID 
tag with low cost and limited computing resource is 
the emerging issue. 
In this paper, we only use the passive RFID tag 
to be a storage media to propose a secure 
authentication transaction with ownership transfer. 
The proposed scheme not only with the online 
authentication but also meet the following 
requirements. 
(1) Applied to low cost and the limited computing 
resource tag. 
(2) The tag doesn’t need to make the complex 
operation and increase access speed. 
(3) Prevent a great deal of tag’s clone. 
(4) Against the replay attack. 
(5) Against Man-in-the–Middle attack. 
(6) Only simple computing operations (e.g. use 
exclusive-OR, Cyclic Redundancy Code and 
generate random number etc.) are applied to 
conform to EPC Global C1G2 standards. 
(7) With ownership transfer. 
We proposed an anti-counterfeit ownership 
transfer protocol such that against attacks, anti-
counterfeit, and lightweight computation to conform 
the C1G2 standards requirements can be guaranteed. 
The tag only needs update new signature and new 
serial number. Thus the RFID tag doesn’t need to 
make the complex computations  
 In the future, the online verification should be 
integrated with the EPC network. For all sale 
products, the users can verify whether or not the 
original and fake of the products. 
 
 
 
 Table 1. Comparison of the related schemes   
        Scheme  
Property 
Seo et al. [23] Osaka et al. [24] Koralalage et al. [26] Fouladgar et al. [27] Our scheme
Resist to  
Man-in-the–
middle attacks 
Yes No Yes Yes Yes 
Resist to replay 
attack 
Yes Yes Yes Yes Yes 
Resist to DOS 
attack  
Yes Yes No Yes Yes 
GEN-2 
conformation 
No No No No Yes 
Mutual 
authentication  
No No No Yes Yes 
Ownership 
transfer 
Yes Yes Yes Yes Yes 
 
 
 
 
 
 
WSEAS TRANSACTIONS on COMPUTERS
Chin-Ling Chen, Yu-Yi Chen, Yu-Cheng Huang, 
Chen-Shen Liu, Chia-I Lin and Tzay-Farn Shih
ISSN: 1109-2750 1156 Issue 8, Volume 7, August 2008
Advanced Communication Technology, Vol.1, 
pp. 255-259. 
[22]Joseph K. Liu, Karyin Fung, Duncan S. Wong, 
Providing High Availability to Time-Stamping 
Services Using Threshold Signature, WSEAS 
Transaction on Communications, Vol. 3, No. 
1109-2742. April 2004. 
[23]Y.  Seo,  T.  Asano,  H.  Lee, and K. Kim, A 
Lightweight Protocol Enabling Ownership 
Transfer and Granular Data Access of RFID 
Tags, the 2007 Symposium on Cryptography 
and Information Security Sasebo, Japan, Jan. 
2007, pp. 23-26. 
[24]K. Osaka, T. Takagi, K. Yamazaki, and O. 
Takahashi, An Efficient and Secure RFID 
Security Method with Ownership Transfer, IEEE 
International Conference on Computational 
Intelligence and Security, Japan. Vol. 2, Nov. 
2006, pp. 1090-1095. 
[25]M. David, S. Andrea, and W. David, A Scalable, 
Delegatable Pseudonym Protocol Enabling 
Ownership Transfer of RFID Tags, Selected 
Areas in Cryptography – SAC 2005, Lecture 
Notes in Computer Science (LNCS 3897), 
Springer-Verlag, Kingston, Canada, Aug. 2005, 
pp. 276-290. 
[26]K.H.S. Sabaragamu Koralalage, S. Mohammed 
Reza, J. Miura, Y. Goto, and J. Cheng, An 
Approach to Enhance the Security and Privacy 
of RFID Systems Used in Product Lifecycle 
with an Anonymous Ownership Transferring 
Mechanism, Proceedings of the 2007 ACM 
symposium on Applied computing,  Mar. 2007, 
pp. 270 – 275.  
[27] Sepideh Fouladgar, Hossam Afifi, A Simple 
Privacy Protecting Scheme Enabling Delegation 
and Ownership Transfer for RFID Tags, Journal 
of communications, Vol. 2, No. 6, Nov. 2007. 
[28]EPCglobal Inc., Class 1 Generation 2 UHF Air 
Interface Protocol Standard Version 1.09", 
Available web site: 
http://www.epcglobalinc.org/standards/technolo
gy/specifications.html. 
WSEAS TRANSACTIONS on COMPUTERS
Chin-Ling Chen, Yu-Yi Chen, Yu-Cheng Huang, 
Chen-Shen Liu, Chia-I Lin and Tzay-Farn Shih
ISSN: 1109-2750 1158 Issue 8, Volume 7, August 2008
A Design of Lightweight RFID Anti-Counterfeiting Mechanism 
Yu-Yi Chen1       Yi-Cheng Wei2 
1 Department of Management Information System, National Chung Hsing University 
Taichung 402, Taiwan, R.O.C. 
chenyuyi@nchu.edu.tw 
2 Department of Computer Science and Engineering, National Chung Hsing University 
Taichung 402, Taiwan, ROC 
s9556013@cs.nchu.edu.tw 
Received  15 June 2008;  Revised  15 July 2009 ;  Accepted  15 July 2009 
Abstract. The counterfeiting problem affects manufactures, distributors, governments and consumers. Brand 
owners need techniques for guaranteeing the authenticity of their products in today’s global marketplace. Ra-
dio-frequency identification(RFID) is considered as a promising approach because it provides an extensible, 
flexible and secure measure to combat counterfeiting. Several RFID anti-counterfeiting mechanisms have 
been proposed in resent years. In this paper, we present a new lightweight anti-counterfeiting authentication 
scheme that can be applied in low-cost RFID system. 
Keywords: RFID, anti-counterfeiting, authentication, low-cost tags 
1   Introduction 
Counterfeiting is one of the fastest growing economic crimes. It leads to damage in the reputation of brand own-
ers, economic losses, promotes inferior working conditions and puts the safety and health of consumers at risk. 
The damage of counterfeiting in traditional trade is roughly 200 billion USD estimated by OECD[1]. It seems no 
anti-counterfeiting mechanism is secure enough in the past. As we know, RFID has gained popularity of being 
an anti-counterfeiting technology in resent years. It completes the existing anti-counterfeiting measures, such as 
holograms, colour shifting inks, taggants, fingerprints and chemical makers[2], which do not avail automatic 
authentication of product authenticity. Therefore, RFID is considered as a promising approach because it pro-
vides an extensible, flexible and secure measure to combat counterfeiting. 
For anti-counterfeiting purpose, it will be possible to authenticate a product by locating an RFID-tag with ref-
erence information on it. The authentication can be performed as follows. As a product passes a reader, the 
reader checks whether the reference information is present on the tag. If the reference information is verified to 
be authentic after running a specific protocol, the product is declared to be genuine and otherwise not. However, 
by capturing the authentication information, and by storing it in a new chip, the attacker can make a clone of the 
original tag. To make the cloning of the tag infeasible, it should be useless for an attacker to derive the tag’s 
secrets through passive attacks or active attacks. As we know, there are some solutions had been proposed in 
several RFID anti-counterfeiting schemes[3,4,5,6,7,8]. 
To evaluate RFID anti-counterfeiting schemes in practice, the cost of authentication needs to be considered. 
Considering low-cost RFID tags are highly resource constrained and cannot support strong cryptogra-
phy[9,10,11,12], lightweight computations need to be designed that take into account the limitations of the tags. 
In this paper, we propose a lightweight anti-counterfeiting authentication scheme that can be used in low-cost 
RFID system. Our scheme primarily targets at high-end consumer products such as handbags, apparels, purses, 
shoes, etc. The high values of these products provide enough incentives for end-consumers to verify them before 
making payment. As such, consumers can safeguard their stake by authenticating a product. Our scheme is rela-
tively useful and easy to implement. For preventing those threats, we also reference other low-cost RFID authen-
tication protocol[13,14,15,16] that show possible impacts of threats to RFID. From the references above, we can 
conclude that the security requirements must be satisfied as follows. 
1. Data integrity: 
For preventing possible malicious altering or transmission error, the data should be assured consistent 
and correct in the communication. 
2. Against Information disclosure: 
Even if an attacker can intercept communications, he cannot obtain any secret information. 
Chen et al: A Design of Lightweight RFID Anti-Counterfeiting Mechanism 
 
3 
For some security considerations, the reader needs to be authorized by server first. It is reasonable for high-
end consumer products which usually be sold in a department store, agent or boutique. In our scheme, only the 
authorized reader can get the authorized key RdrK . Later, it has right to verify the genuineness of product under 
the assistance of the server. For the tag issued by the server, it will be attached to the certified product. The tag is 
embedded a unique key TagK  for verification in the future. Under these assumptions, the following tasks 
should be executed to initialize the reader and the tag. 
Task 1. In the tag of certified product, some critical data should be written such as the tag’s index value TagI , 
the tag’s key TagK , the corresponding EPC code, the triple-secrets ),,( 210 nnn  and owner’s key. Fur-
ther, these data and more detailed product specifications TagInfo  are also recorded in the server’s data-
base as ( TagI , TagEPC , TagK , ),,( 210 nnn , TagInfo ). 
Task 2. In the authorized reader, some critical data should be written such as the reader’s index value RdrI , 
the reader’s key RdrK and shared session-secrets ),...,,,( 210 naaaa . Moreover, these data are also re-
corded in the server’s database as ( RdrI , RdrK , ),...,,,( 210 naaaa ). 
2.2   Authentication Phase 
As a product is carried to an authorized reader, its tag can be verified by the reader under the assistance of the 
back-end database server. Our scheme is focus on anti-counterfeiting issue of RFID system. The main concept 
of our design is similar to the strategy of “one-time password” authentication scheme. In “one-time password” 
system, the key information which needs to be authenticated will be changed for each run. Similarly in our de-
sign, the key information for authentication will be different in each run. It is useless for anyone to intercept the 
key information because the tag cannot be cloned by using the key information. It means anyone cannot counter-
feit tag that can pass the authentication. The workflow of this phase can be shortly described as follows. 
1. the reader makes a challenge for the tag 
2. the tag responds the reader’s challenge 
3. the reader sends a request to the server  
4. the server makes a challenge for the reader 
5. verification request for both of the reader and the tag 
6. the authorized reader will be acknowledged the genuineness of the tag and more detailed product specifi-
cations; the unauthorized reader will be only acknowledged the product specifications. 
7. only the tag of genuine product will be acknowledged the result of verification and the following steps 
will be continued for anti-counterfeiting. 
8. the critical data of the tag will be refresh  
9. the authorized reader will be acknowledged the tag have refresh already 
 
Step 1. The reader generates a random number 1RC  and sends it to the tag. 
Step 2. As the tag receives the random number 1RC  , it generates the message 1M  by its index value TagI , its 
key TagK  and two secrets  0n  and  1n  as follows. 
)1()1()( 011 RCnRCnKIM TagTag ⊕+⊕⊕⊕= .                                                                  (1) 
Then the values ),( 1MI Tag  are emitted to the reader. 
Step 3. The reader sends a query to the server. 
Step 4. The server generates a random number 2RC  and sends it to the reader. 
Step 5. Upon receiving the random number 2RC , the reader generates a message 2M  by its key  RdrK , the 
random number 2RC , and two secrets  ja  and 1+ja   via the following equality. 
)2()2( 12 RCaRCaKM jjRdr ⊕+⊕⊕= + .                                                                                 (2) 
Then the values ),,1( 1MIRC Tag  and ),( 2MI Rdr  are sent to the server. 
Step 6. Only the request from an authorized reader can be accepted by the backend server. To authenticate the 
reader, the server retrieves reader’s key RdrK  and the session-secrets ),,( 21 ++ jjj aaa  according to the 
received reader’s index value RdrI  from its database. Then it can verify the message 2M  as follows. 
)2()2( 1
?
2 RCaRCaKM jjRdr ⊕+⊕⊕= + .                                                                               (3) 
Chen et al: A Design of Lightweight RFID Anti-Counterfeiting Mechanism 
 
5 
21 )(' nnKK TagTag +⊕= .                                                                                                       (18) 
Later, the tag should inform the reader that it is updated completely. Then the tag generates messages 
7M  and 8M  for reader as follows. 
217 bbackM +⊕= .                                                                                                                   (19) 
)1( 128 RCbbackM ⊕+⊕= .                                                                                                     (20) 
Then the values ),( 87 MM  are emitted to the reader. 
Step 9. Upon receiving the above messages, the reader can use the same values 1b  and 2b  to verify the integ-
rity of messages 7M  and 8M  as follows. 
218
?
127 ))1(()( bRCbMbbM ⊕⊕−=⊕− .                                                                               (21) 
If the above equality is held, it means the tag updates completely for this run. 
3   Security Analysis of Our Protocol 
In this section, we demonstrate our scheme achieves the security properties mentioned in section 2. 
 Data integrity: 
For preventing possible malicious altering or transmission errors, the data should be assured consistent and 
correct in the communication. It means that the integrity of the transmitted messages should be guaranteed. 
Checksums (CRCs) are often employed on the communication interface but protect only against random 
failure. Furthermore, the integrity of transmitted information should be assured in advance. In our scheme, 
the design for integrity verification can be found in step 6 and step 8. Those messages )||||( 21 ackbb ,   
and )',','( 210 nnn  are embedded into paired-values ),( 43 MM , ),( 65 MM , ),( 21 UU  and ),( 87 MM  be-
fore sending. Then the receiver can verify the integrity of those messages. 
 Against Information disclosure: 
In our design, the critical information is protected by lightweight operations before communication. For 
example, in step 2, the tag’s key TagK should be sent to the backend server for authenticating and it is 
protected by the following operations. 
)1()1()( 011 RCnRCnKIM TagTag ⊕+⊕⊕⊕= .                                                                      (22) 
Then the message )1,,( 1 RCMI Tag  is sent to the backend server via the reader. If an attacker intercepts this 
message, he cannot derive the key TagK because the secrets 0n  and 1n  are only known by the tag and the 
backend server. Of course, in other steps, the critical information is also protected similarly before commu-
nication. Therefore, the attacker cannot obtain any secret information even if he intercepts communications. 
 Against Replay attack: 
To deal with replay attacks, the response of tag and reader must be unique for every server’s challenge. 
The reader is a bridge of the server and the tag in our design. As the reader wants to query a tag, the reader 
will send a random number 1RC  to the tag. The random number 1RC  cannot be controlled by the adver-
sary, and the tag must reply according to the random number. Thus, the response cannot be reused for 
cheating.  
Moreover, the “challenge-response” is also applied to the connection between the reader and the backend 
server. As the reader wants to intact with the server, it sends a request to the server first. Then the server 
will generate a random number 2RC  and sends it to the reader. The server’s challenge and the reader’s re-
sponse are unpredictable. Therefore, it is not useful for an attacker to perform replay attack in our design. 
 Against Spoofing attack: 
It is impossible for an attacker to impersonate as a legal tag or a legal reader. As long as the attacker 
doesn’t know the tag’s secrets TagK , 0n ,and 1n  , he cannot generate the correct response to spoof the 
reader. Even if the attacker replays the intercepted response from the legal tag, it will not be acceptable as 
we just mentioned before. Therefore, the attacker masquerades as a valid tag will not happen. Similarly, the 
attacker masquerades as an authorized reader will not happen in our design. The attacker cannot obtain the 
authorized reader’s key RdrK  to generate the correct response to spoof the server. Even if the attacker re-
plays the intercepted response from the authorized reader, it will not be acceptable. Therefore, the attacker 
cannot get the correct paired-values ),( 54 MM  and ),( 21 UU  to spoof the tag in step 7. Consequently, 
spoofing attack is not possible in our scheme. 
 Against Cloning attack: 
Chen et al: A Design of Lightweight RFID Anti-Counterfeiting Mechanism 
 
7 
[8] K. H. M. Wong, P. C. L. Hui, A. C. K. Chan, "Cryptography and Authentication on RFID passive tags for apparel 
products", Computers in Industry, Vol. 57, No. 4, pp. 342-349, 2006. 
[9] S. Dominikus, E. Oswald, M. Feldhofer, "Symmetric Authentication for RFID Systems in practice", ECRYPT Work-
shop on RFID and Lightweight Crypto, Graz, Austria, July 2005. 
[10]  D. C. Ranaslnghe, D. W. Engels, P. H. Cole, "Low-cost RFID systems: Confronting Security and Privacy", Auto-ID 
Labs Research Workshop, Zurich, Switzerland, September 2004. 
[11] S. Yu, K. Ren, W. Lou, "A Privacy-preserving Lightweight Authentication Protocol for Low-Cost RFID Tags", IEEE 
Military Communications Conference (MILCOM 2007), pp. 1-7, 2007. 
[12]  J. Yang, J. Park, H. Lee, K. Ren, K. Kim, "Mutual Authentication Protocol for Low-cost RFID", Ecrypt Workshop on 
RFID and Lightweight Crypto, July 2005. 
[13] E. Courses and T.Surveys, "An Effective Privacy-Preserving RFID Scheme against Desynchronization", Intelligent 
Information Hiding and Multimedia Signal Processing, Vol. 2, pp. 659-662. Nov. 26-28, 2007. 
[14] M. Lehtonen, , F. Michahelles, E. Fleisch, "Trust and Security in RFID-based Product Authentication Systems Au-
thors", IEEE Systems Journal, Vol. 1, No. 2, pp. 129-144, December 2007. 
[15] S. E. Sarma, S. A. Weis, D. Engels, "Radio-Frequency Identification: Security Risks and Challenges", RSA Laborato-
ries, Vol. 6, No. 1, 2003. 
[16] L. Tieyan, W. Guilin, D. Robert, "Security Analysis on a Family of Ultra-lightweight RFID Authentication 
Protocols", Journal of Software, Vol. 3, No. 3, pp. 1-10, 2008. 
[17] T. Staake, F. Thiesse, E. Fleisch, "Extending the EPC Network–The Potential of RFID in Anti-Counterfeiting", in 
Proceedings of the 2005 ACM symposium on Applied computing, pp. 1607-1612, 2005. 
Dear Prof. Jong Hyuk Park 
 
 Enclosed in attachment files is a manuscript entitled “The Design of RFID 
Access Control Protocol using the Strategy of Indefinite-Index and 
Challenge-Response” for your consideration for publication in Special Issue of 
Computer Communications on Information and Future Communication Security. This 
article is original and it has not been published elsewhere. I, the corresponding author, 
affirm that all the authors have contributed substantially to the manuscript and 
approved the final submission. 
 
Sincerely 
Yu-Yi Chen 
Associate Professor 
Cover Letter
 1 
 2 
 3 
 4 
 5 
 6 
 7 
 8 
 9 
10 
11 
12 
13 
14 
15 
16 
17 
18 
19 
20 
21 
22 
23 
24 
25 
26 
27 
28 
29 
30 
31 
32 
33 
34 
35 
36 
37 
38 
39 
40 
41 
42 
43 
44 
45 
46 
47 
48 
49 
50 
51 
52 
53 
54 
55 
56 
57 
58 
59 
60 
61 
62 
63 
64 
65 
1 
1. Introduction 
Radio Frequency Identification (RFID) technology is becoming widespread in our 
daily life. RFID systems have many applications in manufacturing, supply chain 
management, inventory control, and telemedicine [1]. The key problem that impacts 
the application of RFID system is the information security [2]. For achieving secure 
access in RFID systems, some researches [3,4] have been proposed. However, it 
seems only the authentication mechanism is considered in the proposed scheme. The 
more important design about access right authorization mechanism had been ignored. 
Now, we introduce those proposed schemes briefly as follows. 
 
1.1 Weis's hash-based access control scheme 
In 2003, Weis et al. proposed two simple hash-based access control protocols, 
hash-lock scheme and randomized hash-lock scheme [3]. The hash-lock scheme is 
shown in Figure 1. As a tag is issued by the back-end database server, the hash value 
imetaID  of its iKey  is stored in the tag. The reader can only get this hash value 
imetaID  as it tries to access the tag. If the reader is legal, it can ask the back-end 
database server for providing the corresponding iKey . After the reader forwards the 
correct iKey  to the tag, the tag’s ID information can be accessed by the reader. 
 
Figure 1. Weis et al.’s hash-based access control scheme 
 
1.2 Weis's randomized access control scheme 
However, the previous scheme can not against the reply attack, another 
“randomized hash-lock” scheme is proposed by Weis et al.. This protocol is shown in 
Figure 2. A tag is initially stored a iKey  and issued by the back-end database server. 
 1 
 2 
 3 
 4 
 5 
 6 
 7 
 8 
 9 
10 
11 
12 
13 
14 
15 
16 
17 
18 
19 
20 
21 
22 
23 
24 
25 
26 
27 
28 
29 
30 
31 
32 
33 
34 
35 
36 
37 
38 
39 
40 
41 
42 
43 
44 
45 
46 
47 
48 
49 
50 
51 
52 
53 
54 
55 
56 
57 
58 
59 
60 
61 
62 
63 
64 
65 
3 
 
Figure 3. Chien’s hash-based access control scheme 
 
1.4 The disadvantages of the previous researches 
In the proposed schemes, man-in-the-middle attack [5], spoofed reader attack [5,6] 
and spoofed tag attack [5] will cause the mechanism crashed. Moreover, mutual 
authentication [6], location privacy [5,7,8], and practicability are not guaranteed in 
those schemes. 
First, an attacker can eavesdrop the messages between the reader and the tag since 
the communication channel is not secure. In those proposed schemes, the tag’s response 
message can be eavesdropped and retransmitted to cheat the reader. An attacker also 
can figure out how to retransmit the reader’s response to cheat the tag. Clearly, mutual 
authentication can not be guaranteed since the spoofed reader attack and spoofed tag 
attack. 
Second, the tag’s owner can be traced if the tag’s responses can be collected and 
recognized. In those proposed schemes, an attacker can easily trace the tag’s location 
since the tag’s responses are always the same.  
As to the issue of practicability, the brute-force searching is a heavy loading for the 
reader in the second scheme of Weis et al.’s. And Chien’s scheme cannot be 
implemented with low-cost RFID tags since each tag needs to have a battery-driven 
clock. 
 
 
 1 
 2 
 3 
 4 
 5 
 6 
 7 
 8 
 9 
10 
11 
12 
13 
14 
15 
16 
17 
18 
19 
20 
21 
22 
23 
24 
25 
26 
27 
28 
29 
30 
31 
32 
33 
34 
35 
36 
37 
38 
39 
40 
41 
42 
43 
44 
45 
46 
47 
48 
49 
50 
51 
52 
53 
54 
55 
56 
57 
58 
59 
60 
61 
62 
63 
64 
65 
5 
 
Figure 4. Our protocol 
Step 1. The reader generates a random number Q  and then emits this number to the 
tag. 
Step 2. As the tag receives the random number Q , it should prepare another random 
number R  and its secret value iKey  to be hashed with Q  as follows. 
)( RQKeyh i  
The message  will be used for the tag’s authentication if the tag’s serial 
number is also known by the server. For the purpose of keeping the tag’s 
location private, the serial number cannot be emitted directly. The serial 
number will be pre-processed to be different in each access. 
(1) Suppose the tag’s serial number iindex  is specified as a pair of values 
) ,( ii yx  which can be also regarded as a coordinate. 
(2) As we know, there exists infinite possible to select two un-parallel lines 
crossed on the coordinate. If let the tag freely determines those two 
 1 
 2 
 3 
 4 
 5 
 6 
 7 
 8 
 9 
10 
11 
12 
13 
14 
15 
16 
17 
18 
19 
20 
21 
22 
23 
24 
25 
26 
27 
28 
29 
30 
31 
32 
33 
34 
35 
36 
37 
38 
39 
40 
41 
42 
43 
44 
45 
46 
47 
48 
49 
50 
51 
52 
53 
54 
55 
56 
57 
58 
59 
60 
61 
62 
63 
64 
65 
7 
the message  can be verified as follows. 
)(
?
RQKeyh i  
If the equality is held, it means the tag is issued by the server. After the tag is 
authenticated, the server should provide the following message  to the tag 
for mutual authentication. 
)( RKeyh i  
Then the secret value iKey , random number R , and message  are sent to 
the reader. As the same of all proposed scheme, we presume it is a secure 
channel between the reader and the back-end database server. 
Step 5. As the reader receives the messages from the back-end database server, it 
holds the secret value iKey  and random number R  for the necessary of the 
following access session, it just needs to forward the message  to the tag. 
Step 6. Upon receiving the message , it can be verified by the tag’s secret value 
iKey  and the random number R  as follows. 
)(
?
RKeyh i  
If the equality is held, it means the reader has proved itself is trusted since the 
message  is embedded with the correct secret value iKey . 
Now, the reader is authorized to access the ciphertext C  existed in the tag. 
For assuring the integrity in the transmission, the check value V  is 
generated as follows. 
))(( RCfhV CRC  
Then the ciphertext C  and check value V  are emitted to the reader. 
Step 7. As the reader receives the messages from the tag, the ciphertext integrity check 
can be done as follows. 
))((
?
RCfhV CRC  
After, the reader can use iKey  to decrypt the ciphertext C  as follows. 
)(CDM
iKey
 
Step 8. If it is necessary to write a modify data 'M  to the tag, it should be encrypted 
by the reader in advance. 
)'(' MEC
iKey
 
 1 
 2 
 3 
 4 
 5 
 6 
 7 
 8 
 9 
10 
11 
12 
13 
14 
15 
16 
17 
18 
19 
20 
21 
22 
23 
24 
25 
26 
27 
28 
29 
30 
31 
32 
33 
34 
35 
36 
37 
38 
39 
40 
41 
42 
43 
44 
45 
46 
47 
48 
49 
50 
51 
52 
53 
54 
55 
56 
57 
58 
59 
60 
61 
62 
63 
64 
65 
9 
)(
?
RQKeyh i  
If the equality is held, it means the tag is issued by the server. Clearly, the attacker 
cannot spoof the reader to replay the response since it depends on the random 
challenge from the reader. 
3. Issue of spoofed tag attack 
As the same of all proposed scheme, we presume the channel between the reader 
and the back-end database server is secure. The reader is supposed to be already 
authenticated by the server. If the reader tries to access a tag, it should be able to 
response the message embedded with the correct secret value iKey  from the 
server to response the tag’s challenge. We use the same strategy called 
“challenge-response”. In step 2, the challenge number R  is generated by the tag. 
Then the challenge number R  which is arranged into the matrix  is forwarded 
from the reader to the server. The corresponding response message  is 
generated by the server in step 4. 
)( RKeyh i  
The response message  will be forwarded to the tag to verify in step 6. 
)(
?
RKeyh i  
If the equality is held, it means the reader is authorized by the server to response 
the challenge. Clearly, the attacker cannot spoof the tag to replay the response 
since it depends on the random challenge from the tag. 
4. Mutual authentication 
The strategy called “challenge-response” is used twice in our design. It achieves 
mutual authentication between the reader and the tag, then the above attacks can 
be avoided. 
5. Location privacy 
RFID tags have the character of outstanding traceability. Suppose a tag’s 
information is intercepted and collected by an attacker on different locations, 
maybe the history of the tag’s locations can be identified. It means the attacker can 
keep track of the tag’s owner. For the purpose of keeping the tag’s location private, 
the tag’s response message in each access can not be recognized it is emitted by 
the same tag. In our design, the tag’s serial number iindex  is specified as a pair 
of values ) ,( ii yx . The procedure about how to determine four points for two 
un-parallel lines crossed on the coordinate is described in step 2. There exists 
infinite possible to select those two un-parallel lines. It means iindex  can be 
represented to be different in each access. Moreover, the values of these four 
 1 
 2 
 3 
 4 
 5 
 6 
 7 
 8 
 9 
10 
11 
12 
13 
14 
15 
16 
17 
18 
19 
20 
21 
22 
23 
24 
25 
26 
27 
28 
29 
30 
31 
32 
33 
34 
35 
36 
37 
38 
39 
40 
41 
42 
43 
44 
45 
46 
47 
48 
49 
50 
51 
52 
53 
54 
55 
56 
57 
58 
59 
60 
61 
62 
63 
64 
65 
11 
As we mentioned in the introduction, we don’t think those proposed RFID access 
control schemes are feasible to be implemented in practical. In fact, those schemes are 
not secure access control mechanisms since the accessed data is transmitted in 
plaintext. The attacker can intercept the plaintext by eavesdropping. This problem can 
be avoided as the encryption/decryption is involved, and it is indeed designed in our 
scheme. Moreover, the ciphertext integrity is guaranteed for against the modification 
attack.  
Before the access, mutual authentication is also guaranteed in our design. The time 
complexity is listed and compared in Table 1. Our scheme can be practically applied 
into the RFID systems because of only lightweight operations are necessary for the 
tag.  
Table 1. The comparison of time complexity 
Protocol 
Reader Authenticate Tag Tag Authenticate Reader Tag Access 
Server Reader Tag Server  Reader Tag Server Reader Tag  
Weis et al.’s 
hash-based 
scheme[3] 
1C             1H+1C          
Weis et al.’s 
randomized 
scheme[3] 
   kH 1H       1C          
Chien’s 
hash-based 
scheme[4] 
1C       1H 1H 1H+1C          
Our scheme 1H+1C    1H 1H    1H+1C none 
2H+1D+ 
1E+1C 
2H+1C 
The notations of table: H: the cost of a hash, D: the cost of a decryption, E: the cost of an encryption, C: 
the cost of a comparison,  : the data is just transmitted in plaintext without any encryption/decryption, 
none: none relative processing. 
 
References 
[1] Y. Xiao, X. Shen, B. Sun,L. Cai, Security and Privacy in RFID and Applications 
in Telemedicine, IEEE Communications Magazine. 44 (4) (2006) 64-72. 
[2] L. He, Y. Gan, N.-N. Li, Z.-Y. Cai, A Security-Provable Authentication and Key 
Agreement Protocol in RFID System, International Conference on Wireless 
Communications, Networking and Mobile Computing 2007(WiCom 2007). 21-25 
September (2007) 2078-2080. 
[3] S. Weis, S. Sarma, R. Rivest, D. Engels, Security and Privacy Aspects of 
Computer Communications 
The Design of RFID Access Control Protocol using the Strategy of Indefinite-Index and 
Challenge-Response 
Dear Editor, 
Thank you for your useful comments and suggestions on the language and structure of our 
manuscript. We have modified the manuscript accordingly, and detailed corrections are listed 
below point by point: 
1) Cover letter should state that the article is original and it has not been published 
elsewhere. 
 The required information is now included in the cover letter. 
2) Figure 4 has not been cited in the text. 
 Now all figures are provided and cited in sequence in the main text. 
3) Pages should be numbered consecutively. 
 The pages have been numbered. 
 
The manuscript has been resubmitted to your journal. We look forward to your positive 
response. 
 
Sincerely 
Yu-Yi Chen 
Associate Professor 
Responses to Technical Check Results
Dear Prof. Chung‐Ming Huang 
 
 Enclosed in attachment files is a manuscript entitled “A Design of Tamper 
Resistant Prescription RFID Access Control System” for your consideration for 
publication in Special Issue of Computer Communications on Open Network Service 
Technologies and Applications. This article is original and it has not been published 
elsewhere. I, the corresponding author, affirm that all the authors have contributed 
substantially to the manuscript and approved the final submission. 
 
Sincerely 
Yu-Yi Chen 
Associate Professor 
Cover Letter
 1 
 2 
 3 
 4 
 5 
 6 
 7 
 8 
 9 
10 
11 
12 
13 
14 
15 
16 
17 
18 
19 
20 
21 
22 
23 
24 
25 
26 
27 
28 
29 
30 
31 
32 
33 
34 
35 
36 
37 
38 
39 
40 
41 
42 
43 
44 
45 
46 
47 
48 
49 
50 
51 
52 
53 
54 
55 
56 
57 
58 
59 
60 
61 
62 
63 
64 
65 
 
1. Introduction 
An RFID system consists of three parts: RFID tags (also called transponders), 
readers (also called interrogators), and the back-end database server. Readers 
broadcast queries to tags in their wireless transmission ranges for information 
contained in tags, and tags reply with required information such as identification (ID) 
numbers. The readers are connected to the back-end database that store information 
associated with tagged objects in order to use data obtained from readers in a useful 
way. As an alternative to barcodes, RFID tags have advantages like data capacity, 
read/write capability, and no requirement of line-of-sight. 
Current research and development on RFID focuses on manufacturing and retail 
sectors to improve supply chain efficiency and learn more about consumer behavior. 
Healthcare is considered to be the next home for RFID after manufacturing and retail 
[8,9,15]. As we know, some hospitals and medical institutes are starting to conduct 
their own small-scale RFID testing projects, such as patient identification [7,14,19], 
drug administration, access to medical records [1,3,4], transfusion, and equipment, 
patient, and staff tracking [5]. The main purpose of these innovations is to improve 
patients safety, eliminates paper-based document, cost savings, increases efficiency 
and productivity, prevent/reduce medical errors, and so on. 
Essentially, the RFID systems work by placing unique electronic identifiers on 
items or on people. For example, RFIDs have been embedded in patient bracelets so 
that medical staff can electronically identify patients before surgery and before 
administering medications and blood transfusions. RFID technology provides a 
method to transmit and receive data from a patient to medical professionals without 
human intervention. Improving safety, quality, and value of health care is the focus of 
most hospitals. The application of RFID in healthcare has, in fact, just begun. 
In 2006, John Ayoade [2] proposed a framework for paperless electronic heath 
record (EHR) system [13]. John Ayoade pointed out the authority of readers should be 
different for accessing different tags. In such situation, those proposed RFID access 
control mechanisms [6,10,11,12,16,17,20] are not suitable. And John Ayoade did not 
propose how to make it work in practical. 
In this paper, we focus on RFID access control system for different authorized 
readers. The tag’s access should be under some control mechanisms. Only the specific 
doctor, usually the patient’s doctor, can access the tag. Moreover, some relative 
information of patient’s prescription should be attached to a RFID tag for tamper 
resistant.  
 1 
 2 
 3 
 4 
 5 
 6 
 7 
 8 
 9 
10 
11 
12 
13 
14 
15 
16 
17 
18 
19 
20 
21 
22 
23 
24 
25 
26 
27 
28 
29 
30 
31 
32 
33 
34 
35 
36 
37 
38 
39 
40 
41 
42 
43 
44 
45 
46 
47 
48 
49 
50 
51 
52 
53 
54 
55 
56 
57 
58 
59 
60 
61 
62 
63 
64 
65 
 
･ iHC : the hash prescription chain, it is computed as ),( 1 iii PPhHC . 
･ : exclusive-or operation. 
･ ) (h : a one-way hash function. 
･ ) (
iKey
E : the encryption function using the secret value iKey  to encrypt the 
message. 
･ ) (
iKey
D : the decryption function using the secret value iKey  to decrypt the 
message. 
There are two phases in our scheme: authentication phase and access control 
phase. 
2.1  The authentication phase 
As a doctor uses his reader to access his patient’s tag, the reader and the tag should 
be authenticated by the back-end database server. The procedure of this phase is 
shown in figure1. 
 1 
 2 
 3 
 4 
 5 
 6 
 7 
 8 
 9 
10 
11 
12 
13 
14 
15 
16 
17 
18 
19 
20 
21 
22 
23 
24 
25 
26 
27 
28 
29 
30 
31 
32 
33 
34 
35 
36 
37 
38 
39 
40 
41 
42 
43 
44 
45 
46 
47 
48 
49 
50 
51 
52 
53 
54 
55 
56 
57 
58 
59 
60 
61 
62 
63 
64 
65 
 
generated the following response message 1TR . 
),,( 111 TRTT NNKeyhR  
Moreover, the second response message 2TR  is the hash value of the 
association proof RTAsc  and two random numbers 1RN , 2TN . 
),,( 212 TRRTT NNAschR  
For some access control purpose in the next phase, the check value 1TV  
should be prepared now. 
),( 111 TiT NHPhV  
Finally, the tag emits the messages ( THID , 1TX , 2TN , 1TR , 2TR , 1TV ) to the 
reader. 
Step 3. According to the random number 2TN , the reader uses its key RKey  to 
generate the following response message 1RR . 
),( 21 TRR NKeyhR  
For the use of next phase, the doctor writes out a prescription which is 
encrypted by the reader’s key RKey . 
)(MEC
RKey
 
A number 2RN  is randomly selected and used for generating the following 
values. 
),( 21 RR NChV  
22 RRR NKeyX  
),( 22 RRR NKeyhV  
After, the tag’s messages ( THID , 1TX , 2TN , 1TR , 2TR , 1TV ) are forwarded and 
additional generated messages ( RID , 1RR , 2RN , C , 1RV , 2RX , 2RV ) are 
transmitted. to the back-end database server. 
Step 4. According to the hash value THID , the tag’s key 'TKey  can be retrieved. 
Then the number '1TN  can be got as follows. 
'' 11 TTT KeyXN  
After, the correctness of the tag’s key 'TKey  and the number 1RN  can be 
verified. 
)',,'( 11
?
1 TRTT NNKeyhR  
 1 
 2 
 3 
 4 
 5 
 6 
 7 
 8 
 9 
10 
11 
12 
13 
14 
15 
16 
17 
18 
19 
20 
21 
22 
23 
24 
25 
26 
27 
28 
29 
30 
31 
32 
33 
34 
35 
36 
37 
38 
39 
40 
41 
42 
43 
44 
45 
46 
47 
48 
49 
50 
51 
52 
53 
54 
55 
56 
57 
58 
59 
60 
61 
62 
63 
64 
65 
 
 
Figure 2.The access control phase of our protocol 
 
Step 1. For assuring the integrity of the prescription, the last prescription’s hash value 
'1iHP  is retrieved from the database and then be verified. 
)','( 11
?
1 TiT NHPhV  
According to the received value 2RX  and the generated key 'RKey , the 
number '2RN  can be got as follows. 
'' 22 RRR KeyXN  
Then the correctness of the ciphertext C  and the number '2RN  can be 
verified. 
)',( 2
?
1 RR NChV  
),,,( .2 1121 SSSS RVXX
Tag 
RTTT AscKeyID ,,
Back-end database server 
SKey
1
2
1
121
?
1
1
?
1
'   
)(   
)(   
),,(   
),( .3
TTT
SKeyi
SKeyi
TSSS
TTS
NIDID
XDHC
XDHP
NXXhV
NKeyhR
T
T
Reader 
RR KeyID  ,
),,,( 1121 SSSS RVXX
''   
)','(   
)',,(   
)(   
)(   
),(   
)(   
record    into    rites   
)(   
)','(   
)',(   
   ''   
)',( .1
1
11
1211
'2
'1
1
'
2
?
2
2
?
1
22
11
?
1
TTT
TTS
TSSS
iKeyS
iKeyS
iii
ii
i
Key
RRR
RR
RRR
TiT
NIDID
NKeyhR
NXXhV
HCEX
HPEX
PPhHC
PhHP
PMw
CDM
NKeyhV
NChV
KeyXN
NHPhV
T
T
R
 1 
 2 
 3 
 4 
 5 
 6 
 7 
 8 
 9 
10 
11 
12 
13 
14 
15 
16 
17 
18 
19 
20 
21 
22 
23 
24 
25 
26 
27 
28 
29 
30 
31 
32 
33 
34 
35 
36 
37 
38 
39 
40 
41 
42 
43 
44 
45 
46 
47 
48 
49 
50 
51 
52 
53 
54 
55 
56 
57 
58 
59 
60 
61 
62 
63 
64 
65 
 
database server. 
),( 1
?
1 TTS NKeyhR  
If the equality is held, it means the response message is indeed from the 
back-end database server with the share secret. Base on the server can be 
trusted, the tag understands that the reader had been authenticated and 
authorized to access it. 
For assuring the integrity of 1SX  and 2SX , the check value 1SV  should be 
verified as follows. 
),,( 121
?
1 TSSS NXXhV  
Then the encrypted hash values 1SX  and 2SX  can be decrypted by the tag’s 
TKey . 
)(' 1SKeyi XDHP T  
)(' 2SKeyi XDHC T  
Those two hash values iHP , iHC  are appended to the proof list. This list 
will be used for assuring the patient’s rights. 
Finally, the tag updates its identifier to be 'TID  which is generated as 
follows. 
'' 1TTT NIDID  
 
3. Analysis of our protocol 
In this section, we will analyze our scheme about man-in-the-middle attack, 
spoofed reader attack, spoofed tag attack, mutual authentication, location privacy and 
practicability. 
1. Issue of man-in-the-middle attack 
Since the communication between the reader and the tag, the back-end database 
server and the reader can be eavesdropped or intercepted, how to avoid 
man-in-the-middle attack is the most important issue. For against the replay attack, 
the “challenge-response” approach is used and more details will be analyzed in the 
following issue. For against the eavesdropping attack, all of the critical parameters 
 1 
 2 
 3 
 4 
 5 
 6 
 7 
 8 
 9 
10 
11 
12 
13 
14 
15 
16 
17 
18 
19 
20 
21 
22 
23 
24 
25 
26 
27 
28 
29 
30 
31 
32 
33 
34 
35 
36 
37 
38 
39 
40 
41 
42 
43 
44 
45 
46 
47 
48 
49 
50 
51 
52 
53 
54 
55 
56 
57 
58 
59 
60 
61 
62 
63 
64 
65 
 
4. 
),'( 2
?
1 TRR NKeyhR  
If the equality is held, it means the reader is issued by the server.  
After the reader is authenticated by the server, the response message 1SR  for the 
tag’s challenge is generated in step 1 of the access control phase. 
)','( 11 TTS NKeyhR  
The response message 1SR  will be forwarded via the reader to the tag to be 
verified in step 3. 
),( 1
?
1 TTS NKeyhR  
If the equality is held, it means the reader is authorized by the server to response 
the challenge. Clearly, the attacker cannot spoof the tag to replay the response 
since it depends on the random challenge from the tag. 
4. Mutual authentication 
The strategy called “challenge-response” is used twice in our design. It achieves 
mutual authentication between the reader and the tag, then the above attacks can 
be avoided. 
5. Location privacy 
RFID tags have the character of outstanding traceability. Suppose a tag’s 
information is intercepted and collected by an attacker on different locations, 
maybe the history of the tag’s locations can be identified. It means the attacker can 
keep track of the tag’s owner. For the purpose of keeping the tag’s location private, 
the tag’s response message in each access can not be recognized it is emitted by 
the same tag. In our design, the tag’s identifier is updated in each access. Clearly, 
the attacker cannot trace the hash value of the tag’s identifier. Moreover, the other 
messages emitted between the tag and the reader are randomized and not useful to 
identify the tag. Therefore, the tag’s location privacy can be guaranteed in our 
design. 
6. Practicability 
For improving patients’ safety, the tamper resistant prescription issue is considered 
to reduce forged and altered prescriptions, and deter drug abuse in Canada and 
 1 
 2 
 3 
 4 
 5 
 6 
 7 
 8 
 9 
10 
11 
12 
13 
14 
15 
16 
17 
18 
19 
20 
21 
22 
23 
24 
25 
26 
27 
28 
29 
30 
31 
32 
33 
34 
35 
36 
37 
38 
39 
40 
41 
42 
43 
44 
45 
46 
47 
48 
49 
50 
51 
52 
53 
54 
55 
56 
57 
58 
59 
60 
61 
62 
63 
64 
65 
 
Framework, Computers & Security. 25:3 (2006) 207-212. 
[3] J. Bardram, Hospitals of The Future - Ubiquitous Computing Support for 
Medical Work in Hospitals, The Second International Workshop on Ubiquitous 
Computing for Pervasive Healthcare Application. (2003). 
[4] J. Bardram, Applications of Context-Aware Computing in Hospital Work: 
Examples and Design Principles, Proceedings of the 2004 ACM symposium on 
Applied Computing. (2004) 1574-1579. 
[5] V. Boginski, I.K. Mun, Y. Wu, K.P. Mason, C. Zhang, Simulation and Analysis 
of Hospital Operations and Resource Utilization Using RFID Data, 2007 IEEE 
International Conference on RFID Gaylord Texan Resort, Grapevine, TX, USA, 
March 26-28 (2007). 
[6] H.-Y. Chien, Secure Access Control Schemes for RFID Systems with Anonymity, 
International Conference On Mobile Data Management. (2006) 96-99. 
[7] B. Chowdhury, R. Khosla, RFID-Based Hospital Real-Time Patient Management 
System, 6th IEEE/ACIS International Conference on Computer and Information 
Science (ICIS 2007). (2007). 
[8] J. Ericson, RFID for Hospital Care, The E-Business Executive Daily. (2004). 
[9] J.A. Fisher, T. Monahan, Tracking The Social Dimensions of RFID Systems in 
Hospitals, International Journal of Medical Informatics. 77:3 (2008) 176-183. 
[10] X. Gao, Z. Xiang, H. Wang, J. Shen, J. Huang, S.Song, An Approach to Security 
and Privacy of RFID System for Supply Chain, The E-Commerce Technology 
for Dynamic E-Business. (2004) 164-168. 
[11] H.-W. Kim, S.-Y. Lim, H.-J. Lee, Symmetric Encryption in RFID Authentication 
Protocol for Strong Location Privacy and Forward-Security, IEEE International 
Conference on Hybrid Information Technology (ICHIT'06). (2006) 718-723. 
[12] H.-S. Kim, J.-H. Oh, J.-Y. Choi, Analysis of The RFID Security Protocol for 
Secure Smart Home Network, International Conference on Hybrid Information 
Technology(ICHIT'06). 2 (2006) 356-363. 
[13] C.-H. Kuo, H.-G. Chen, The Critical Issues about Deploying RFID in Healthcare 
Industry by Service Perspective, Proceedings of The 41st Hawaii International 
Conference on System Sciences. (2008). 
[14] H.A. Nahas, J.S. Deogun, Radio Frequency Identification Applications in Smart 
Hospitals, The Twentieth IEEE International Symposium on Computer-Based 
Medical Systems. (2007). 
[15] S.-W. Wang, W.-H. Chen, C.-S. Ong, L. Liu, Y.-W. Chuang, RFID Applications 
in Hospitals: A Case Study on A Demonstration RFID Project in A Taiwan 
Hospital, Proceedings of The 39th Hawaii International Conference on System 
