2 
 
中文摘要 
 
對於生物組織的超音波反應特性而言，衰減係數是個重要的參數。一般估測組織的衰減係數大略
可分為利用背散射訊號估測以及穿透訊號估測兩種。其中，背散射訊號的估測方式可適合於大部
分的應用。但是卻有散射成份干擾的困難。應用穿透訊號的方式是較為適合於估測衰減係數，但
是由於必須在組織兩端皆放上探頭，因此只適合體外實驗用。近年來由於超音波對比劑的的技術
成熟，使得我們可以發展一個新方法，使用對比劑來估測體內組織的衰減係數。由於對比劑有高
度非線性的特性，因此我們藉由使用多組頻率激發組織之後的對比劑，我們可應用其所產生的諧
波訊號達到應用穿透訊號估測組織衰減係數的目的[20]。 
 
在本計劃中，我們將研究分成兩個部份來進行研究：（一.）我們計算經由對比劑回波訊號中的諧
波成分來估測理論中組織的衰減係數，其中必須利用周期譜的方式求得訊號的功率頻譜密度。
（二.）設計一個可用在體內實驗的適應性演算法，用以估測體內組織的衰減係數。並且，對此法
做誤差分析以得知應用此方法估測衰減係數與理論值的差距。 
 
 
 
英文摘要 
 
   Attenuation Coefficient (Att. Coef.) is an acoustic parameter for tissue characterization. Two major 
techniques for Att. Coef. Estimation are the backscattering and transmission methods. Backscattering 
method is suitable for general applications, but the speckle interference makes it inaccurate. 
Transmission method is more reliable, but it is suitable for peripheral organs only, due to the need of a 
separate transmitter. With the aid of contrast agent (microbubble), a new way to estimate the Att. Coef. 
of soft tissues is proposed, which is suitable for general applications [20]. Since microbubble is a highly 
nonlinear object, Using the multiple frequencies generated by microbubbles behind the tissue, the Att. 
Coef. Can be estimated in transmission mode. Since the harmonics are generated by common 
microbubbles, their relative strengths can be predicted by theory and measured for Att. Coef. Estimation. 
 
   The research is divided into two parts. First, we use periodogram to estimate the power spectrum of 
echo signals and using the second harmonic component to estimate the theoretical Att. Coef. Secondly, 
we will develop an adaptive algorithm to estimate Att. Coef. Which is suitable for general application.  
 
 
2 
 
3) Like tissue backscatter sample, CA sample could 
be attained consistent when we have enough 
independent samples. But independent sample of 
CA method is getting from CA flowing in the 
blood vessel. That is we can get independent 
sample without change another place in tissue. In 
application view point, new method is more 
probable to estimate the pathology in a small area. 
 
However, CA is highly depends on frequency. Therefore 
the variation of estimator would be different in frequency. We 
proposed a multi-band estimator to avoid the uncertainty 
variance in the single-band estimator. 
The paper is organized as follows. A signal model of CA 
estimation system with experimental environment would be 
present. A stochastic process of the system would be present 
that independency of different frequency component and the 
power spectrum of these signal to show the second harmonic 
signal would not be interfered by liver tissue. An attenuation 
coefficient estimation using second harmonic signal would be 
proposed and we can proved if we have enough sample these 
estimator would be consistency. To avoid the unknown 
property of CA, a more stable estimator using multi-band 
second harmonic would be presented also. Finally, the 
experiment in-vitro can be prove these estimator and statistical 
inference to prove that second harmonic estimation is more 
efficiently than fundamental estimation. 
PHYSIC AND STOCHASTIC SIGNAL MODEL 
A. Signal model for propagation in soft tissue and 
vascular  
Fig 1a) is a physical model of signal propagating in soft 
tissue and contrast agents (CA) in blood vessel. We 
proposed to use the CA second harmonic signals 
transmitting back to receiver to estimate attenuation 
coefficient of the tissue between blood vessel and receiver. 
In this model, suppose the vessel diameter is xcm. The soft 
tissue with an axial length of Lcm is overlaying in the 
vessel, within the sample volume. However, we assume 
that reflected signal between vessel and soft tissue can be 
ignored. Between the transducer and tissue, there may be 
water and we assume that signal will not be change in this 
area. 
 
Fig 1b) shows the block diagram equivalence to Fig 1a). 
In Fig 1b), it described the propagation , attenuation , and 
back scattering of transmit signals in soft tissue and the 
nonlinear signals of contrast agent transmitting back to 
receiver . With well control the experiment environment to 
simplify the receive signal, suppose that : 
 
1) Signal reflection because of impedance mismatch 
of heterogeneous junction (water to liver tissue and   
tissue to blood vessel) is small enough to ignore. 
2) the nature of soft tissue is homogenous , that is 
attenuation coefficient is α/ dB per cm per MHz 
with no change in place. 
3) To avoid the multiple scattering in blood vessel, the 
concentration of contrast in a sample volume is 
very small. 
4) When CA change in radius is very small, than the 
higher harmonics signals is only up to second 
harmonics signal, and the minimum threshold 
excitation amplitude to generation sub-harmonic 
signals which is not reached also. 
 
Suppose we transmit a sinusoidal signal with frequency 
is cf  and the amplitude is A into the system in Fig 1a). 
The signal would be separated into two parts. The first 
part is backscattered signal of liver tissue. From the 
irregularly shaped reflector with attenuation signal model 
supposed by R.Kuc[6], the first part is observed to be a 
sum of many individual sinusoids with random 
amplitudes and occurrence times. The second part is the 
signal propagation through liver tissue into blood vessel. 
than signal would become: 
 
( )12010 cos 2cf L cA f tα π− +… 
( ) ( )
1
20
1
10 cos 2c i
M f
c isc i
i
A f t
ασ π θ−
=
+∑ l        (1) 
Fig 1: Ultrasound propagation model of acoustic signal 
in flow system with overly tissue. Fig1a) Experiment set 
up procedure Fig1b) System block diagram of Fig1a).   
Fig 1a: ultrasound propagation through soft tissue and 
CA in the vascular. Fig 1b: The block diagram of Fig 1a 
4 
 
( ) ( ) 0 0
1 1
,
N N
p p j k
j k
R t t R E A Aτ τ
= =
⎡ ⎤+ = = +⎣ ⎦∑∑ … 
( )
1 14 42 220 20
1
1 1
10 10c c i
sc i
N Mf L f
j
j i
E A E
α ασ− −
= =
⎧ ⎫⎡ ⎤⎪ ⎪⎡ ⎤ + ×⎨ ⎬⎢ ⎥⎣ ⎦⎪ ⎪⎣ ⎦⎩ ⎭∑ ∑
l
   12j fe π τ− +… 
1
1 8 2 22 20
2
1
10 c
N f L j f
j
j
E A e
α π τ− −
=
⎡ ⎤⎣ ⎦∑               (10) 
 
The auto correlation function of Eq(10) can be separate 
by DC, fundamental and second harmonic component. For 
the result of Eq(10) we can summarize as: 
 
1). ACF of ( )R t  is independent in time varying, 
that is, statistical property would not be 
changed in time.  
2). There is no correlation term of any two 
different frequency bands. So the CA 
fundamental and second harmonic components 
are mutually independent. 
 
Than the log-power spectral densities of these two 
frequency components can represent independently: 
 
( )1p dBS f =  
( )
1 14 42 220 20
10 1
1 1
10 log 10 10c c i
sc i
N Mf L f
j
j i
E A E
α ασ− −
= =
⎧ ⎫⎡ ⎤⎪ ⎪⎡ ⎤ + ×⎨ ⎬⎢ ⎥⎣ ⎦⎪ ⎪⎣ ⎦⎩ ⎭∑ ∑
l
   ( )cf fδ −  
( )1 cf fµ δ= −                            (11) 
 
And the second harmonic frequency is: 
 
( )12p dBS f =  
( )21 10 2
1
2 2 10log 2
N
j c
j
f L E A f fα δ
=
⎧ ⎫⎡ ⎤− + −⎨ ⎬⎣ ⎦⎩ ⎭∑  
   ( ) ( )1 22 2 2 cf L f fα µ δ= − + −           (12) 
 
Eq(11) and Eq(12) indicate that at the fundamental 
spectrum will be interfere by the backscatter signal of 
tissue. The second harmonic spectrum is a random 
component of CA with tissue attenuation. Thus in the next 
section, we will propose an tissue attenuation estimator use 
( )12pS f  samples. 
 
ESTIMATION METHOD 
A.. Tissue attenuation coefficient estimator using CA 
second harmonic signal ( )12pS f  
In preview section, we can summarize the second 
harmonic signals of ( )R t  is a randomly CA component 
with a deterministic tissue attenuation. We have proposed a 
method to estimate the power spectral density of CA in 
vitro and to estimate tissue attenuation with in vivo signal. 
We will propose this estimator is efficient and the 
estimation error will decrease in sample size increase. 
If we measure q CA sample to estimate the power 
spectral density of ( )12pS f , the expectation power of 
second harmonic signal. We can use the sample mean of 
received sample power spectral to be an estimator: 
 
( ) ( ) 2^ 1 1
1
12 10log 2
p
Q
qdB q
S f R f
Q =
= ∑         (13) 
 
From the result of Eq(12), we need to subtract the mean 
power of CA to estimate attenuation. If we can measure the 
Q second harmonic samples before inject in to vascular, 
after we get another Q sample with overly tissue, the α  
estimatorαˆ is: 
 
( ) ( )^ ^1 1
1
1ˆ 2 2
2 2 p pre pdB dB
S f S f
f L
α −⎡ ⎤= −⎣ ⎦     (14) 
 
Where: 
    ( )^ 12p pre dBS f−  spectral estimator before the CA 
inject into vascular. 
    ( )^ 12p dBS f    spectral estimator after the CA 
inject into vascular. 
If the statistical parameter (mean, variance) of CA 
harmonic would not be changed, then we can propose that 
mean and estimation error of estimator αˆ is: 
 
[ ] { }1 2 2
1
1ˆ 2 2
2 2 pre
E f L
f L
α α µ µ α−= + − =   (15) 
 
[ ] ( ) ( )
^
12
1
1ˆvar 2 var 2
2 2 p dB
S f
f L
α ⎡ ⎤= ⎣ ⎦  
( ) ( )121
1 1 2 var 2
2 2 p dB
S f
Qf L
⎡ ⎤= ⎣ ⎦    (16) 
 
Eq(15) can be proved that if the statistical properties 
would not be changed. Then αˆ  is an unbiased estimator 
of α  and we also can be proved: 
 [ ]ˆlim var
Q
α→∞ =  
6 
 
 
 
 
 
 
 
 
be proved that signal attenuation is nonrandom and the 
spectral difference method would be used to measure signal 
attenuation at ( 2, 2.125, 2.25, 2.375 )MHz in fundamental 
with bandwidth is 20KHz and  ( 4, 4.25, 4.5 4.75 )MHz in 
second harmonic component with bandwidth is 40KHz 
independently with PRF is 5KHz. The measurement tissue 
placed in the water proof between transmitter and receiver 
transducer presented in Fig2a) is a flesh liver with L=1cm 
depth before the liver set up to measurement. A de-gas 
process using a special pump is to delete the free gas in 
liver sample of two hours. A certain place choose in the 
tissue would be the beam path of transmission and receive 
transducer in Fig2a) and Fig2b). The place choosing is 
according to the four assumption in Fig1a) to avoid the 
blood vessel and irregular reflector in liver tissue. The 
water proof in the water proof in Fig2a) and Fig2b) is 
dissolution water in a water tank to be satisfied the 
assumption in Fig1a). Fig2b) is an experimental 
environment that we proposed in Fig1a). A flow-system 
presented in Fig2a) is a silicon-tube with diameter is 1cm 
composed of a high-speed flowing pump to model the 
vascular in Fig1a). The solution in the silicon tube is to 
model the CA in the vascular. Pig liver is overlaying in 
flow system and the beam path of liver is chosen the same 
as experiment in Fig2a). The measurement system 
presented in Fig2a) and Fig2b) can be divided in 
transmission part and receive part. Transmission part using 
the arbitrary function generator ( TGA1242 TTI ) to 
generate signal. Then using a power amplifier (75A250 AR ) 
to generate the high power signal into Transmit piston 
( V325 2.25MHz 2.5cm Panametrics ). Signal would 
received by a wideband receive transducer ( V309 5MHz 
2.5cm Panametrics ) first. Using wideband transducer is 
proposed to receive the second harmonic component in 
Fig2b). After the signal be received, a low noise amplifier 
( 5072 PR Panametrics ) would be amplified the received 
signal suitably in to A/D converter (AD-Link PCI-9812 
20MHz 16bit ). A/D card would be converted receive signal 
into digital form and storage into PC. Finally Matlab would 
be the estimator and the statistical inference would also be 
inference the experimental result. 
B. Experimental Result 
To avoid the random noise generated in the electronic 
measurement system, 20 samples of transmission mode 
system in each frequency-band would be minimized the 
noise effect using the sample mean in the frequency domain. 
After these propose, using the spectrum difference 
introduced in R.Kuc, we can measure the tissue attenuation 
coefficient in transmission mode: 
0.51/ / /dB cm MHzα =              (23) 
Fig3 present an estimation result of experiment in Fig2b) 
with single transmission frequency at 2MHz. This 
estimation value αˆ  using second harmonic estimator 
denoted by Eq(13) and Eq(14) with sample size Q 
increased from 125-2500. From the figure, we can see the 
variation of these estimation values would be decreased 
with sample size increased. That is, this estimator is 
consistency if we have enough samples Q. After estimation 
using 2500 realizations, the attenuation coefficient would 
be estimated at α =0.519/dB/cm/MHz with the estimation 
error is: 0.73 / / /m dB cm MHz . That is estimation 
attained consistent.  
Fig4 present a multiband harmonic estimation. Using 
Eq(18), that is the four harmonic frequency band 
( 4,4.25,4.5,4.75 )MHz would be estimate the attenuation 
coefficient independently. After the estimation in each 
frequency have already be done, Multiband estimator of 
frequency weighting method in Eq(20) would be estimate 
the attenuation coefficient value of ˆTα . Fig4 present the 
estimation value with sample size are (125,250,500…2500) 
in each frequency component. That is there is equal to 
( 500,1000,2000,…10000) samples in each ˆTα  
estimation. Compare with single-band estimator, the 
estimation variance in Fig4 is smaller than the variance in 
Fig3 because of the sample size is 4 times greater than 
estimation using in single frequency band. But the main 
advantage of sample in different frequency is to average the 
risk of the unknown random property of contrast agent in 
the certain frequency band. The same as Fig3 present the 
estimation error of multiband estimator would be decreased 
with the sample size increased. That is, ˆTα  is also a 
consistent estimator. 
Fig 2: Experiment setup with measurement systems. 
Fig2a: Transmission mode measurement system to 
measurement ideal attenuation coefficient. Fig2b: Flow 
estimation system presented in Fig1a.    
8 
 
REFERENCE 
[1]. Avinash C., Kris A. “Signal processing of broadband 
pulsed ultrasound: Measurement of attenuation of soft 
Biological Tissues” IEEE Transactions on biomedical 
engineering,vol.BME-25,no.4,July 1978 
[2]. Z.F.Lu, J.A.Zagzebski, E.L.Madsen, F.Dong “A 
Method for estimating an overlying layer correction in 
quantitative ultrasound imaging” Ultrasound imaging 
17,pp269-290,(1995) 
[3]. Perter D.Bevan , Michael D.Sherar “B-scan ultrasound 
imaging of thermal coagulation in bovine liver:log 
envelope slope attenuation mapping”ultrasound in 
Med&Biol,Vol.27,No3,pp.379-387,200 
[4]. Shigao Chen, Mostafa Fatemi, Eileen McMahon, 
James F.Greenleaf, Mark Belohlavek “spectral 
compensation for tissue attenuation and transmit 
intensity in ultrasounic detection of microbubbles by 
harmonic method” IEEE Transactions on UFFC pp 
982-985 2004 
[5]. D.L.Miller”ultrasounic detection of resonant cavitation 
bubbles in a flow tube by their second-harmonic 
emissions” Ultrasonics pp217-224 september 1978 
[6]. Roman Kuc, Mischa Schwartz”Estimating the acoustic 
attenuation coefficient slope for liver from reflected 
ultrasound signals. IEEE Transactions on sonics and 
ultrasounds vol. su26 no5 September 1979. 
[7]. Mentzung Lo, Jenho Tsao and Darong Su,”Volume 
Scattering of Distrubuted Microbbles and Its Influence 
on Blood Flow Estimatuon” IEEE Transactions on 
UFFC,vol.50,No.12,pp1699-1710 2003 
 
 
     978-1-4244-2957-8/08/$25.00 © 2008 IEEE    328     ISSNIP 2008 
 
 
   For a given SV-signal, denoted as svx , an augmented data 
matrix can be formed as 1 2' [ , , , , ]
T
K svX x x x x= L , which is a 
( 1)K N+ ×  matrix. The solution of SICA is defined as: 
1
1 1
K K
sv k k k k s sv
k k
y w x w x w x
+
= =
= = +∑ ∑ , 
which can be found by the usual blind ICA estimation 
algorithms. Note that the difference between ICA and SICA is 
in their data matrix only. There are two types of contributions 
in the supervised solution svy , they can be separated as 
0sv s svy y w x= + , 
where 0 1
K
k kk
y w x== ∑  is the unsupervised ICA solution. The 
unsupervised ICA solution is defined as the IC with the 
largest kurtosis among all IC’s found by the ICA algorithm 
without using the SV-signal. Therefore, 0y is to be referred to 
also as the principle independent component (PIC). 
   It is shown in the following that the optimal SV-signal for 
the purpose of FECG extraction is the FECG itself, 
i.e., svx f= . 
   Since the PIC 0y is a linear combination of the abdominal 
signals, it is in general a mixture of MECG, FECG and noise. 
Let the contributions of MECG, FECG and noise in the PIC 
be my mα= , fy fβ= and vy vγ= , with ,   and α β γ being 
the associated coefficients, then the supervised solution can 
be written as: 
sv m f v s sv
s sv
y y y y w x
m f v w xα β γ
= + + +
= + + + . 
   As stated above, the kurtoses of the signal components are 
related as [ ]  [ ]  [ ]m f vkurt y kurt y kurt y> > , so the ICA 
estimation algorithm [12] would try to make svy as close to 
my as possible to maximize the kurtosis of svy . However this 
result can happen only if my and fy are separable. 
Unfortunately, the separability of my and fy  is in general not 
guaranteed. However, if the SV-signal is available and 
svx f= , then 
( )sv sy m w f vα β γ= + + + , 
and then it is possible for the SICA to have svy approach 
my by setting sw β= − . This result shows also that if the noise 
is zero mean, the expectated value of the SICA solution is 
[ ]sv mE y y= , which is the MECG. 
 
B. A Supervision Signal Construction Algorithm 
   Two concerns about the construction of the SV-signal are 
given first. Based on the definition SICA, the SV-signal must 
be derived from the PIC 0y  to ensure that fy can be 
cancelled by the SV-signal. This requirement makes the SV-
signal construction problem become a FECG extraction 
problem. In addition, since the purpose of the SV-signal is to 
supply complementary information for the ICA, a major 
concern is that it should not be constructed based on vector 
space techniques, like spatial SVD and spatial ICA. Thus a 
good candidate for SV-signal construction is the classical 
averaging and subtraction technique used for FECG 
extraction.  
   A template based MECG suppression technique is 
employed to construct the required SV-signal here. It is a 
single-beat subtraction technique. A major step in the single-
beat technique is to do temporal analysis for exploiting the 
signal structure before subtraction, which is done by beat 
detection. Therefore the results of single-beat subtraction 
techniques can be used to help the spatial ICA be aware of the 
temporal structure of the FECG. After MECG suppression, 
there is still a difficulty in SV-signal construction. The 
difficulty is that the SNR of fy is low in general, therefore 
the SV-signal is going to be reconstructed (instead of 
estimated) based on the quasi-periodic property of the FECG. 
A template based technique for reconstructing the FECG is 
proposed here. The major procedures for MECG suppression 
and FECG reconstruction are given below. 
 
1. MECG suppression: 
   The MECG my  in the PIC is to be suppressed beat by 
beat based on the template of its QRS-complex. The 
MECG is suppressed in a similar way as proposed in [4]. 
An initial estimate of template is assumed to be available 
for beat detection by template matching. After all of the 
beats are detected, the coherent averaging of their 
waveforms is used as a new template for MECG 
suppression. The maternal beats are subtracted at their 
detected positions with the amplitudes estimated by the 
new template. 
 
2. FECG reconstruction: 
   After the MECG in the PIC is suppressed, the signal left 
is supposed to consist of FECG and noise only, 
i.e., f vy y+ , therefore the fetal beats can be detected by 
template matching. An initial estimate of the FECG 
template is assumed to be available for template matching. 
As in the MECG suppression, a new estimate of the 
template of FECG is found by coherent averaging of the 
detected beats. The template is shifted and put at the 
position of the detected fetal beats with equal amplitude to 
synthesize the reconstructed FECG, which is to be used as 
the SV-signal. Let ( )q n be the template of the fetal QRS-
complex, the reconstructed FECG is  
( ) ( )f j
j
y n q n n= −∑% , 
where jn ’s are the detected positions of the fetal beats, 
and sv fx y= % . 
 
C. The SICA Solution 
   After the SV-signal is available, the supervised solution 
svy can be found by the one-unit ICA estimation algorithm 
