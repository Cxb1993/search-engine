I 
 
（一）計畫中文摘要 
關鍵詞：通道配置（Channel Allocation）、檔案修復（File Repair）、金鑰管理（Key Management）、
多媒體廣播群播服務（Multimedia Broadcast Multicast Service）、通用行動通訊服務（Universal 
Mobile Telecommunications System） 
 在網際網路上，群播技術已被廣泛的使用來傳送多媒體內容。近年來，行動通訊網路已經和網
際網路成功整合。為了將網際網路上的多媒體服務提供給行動裝置存取，第三代行動通訊網路組織
（Third Generation Partnership Project；3GPP）提出了多媒體廣播群播服務（Multimedia Broadcast 
Multicast Service；MBMS）之相關規範，透過通用行動通訊服務（Universal Mobile Telecommunications 
System；UMTS）網路將多媒體內容群播給行動裝置。由於多媒體廣播群播服務之相關標準仍持續
制定當中，針對提供更好的服務品質與效能之考量，標準所提出的機制仍舊有許多進步的空間。本
計畫專注於提出更有智慧的機制使得多媒體廣播群播服務可以被更有效率的建置在 UMTS 網路上。
為了增進多媒體廣播群播服務之效能，我們考慮三個重要的議題（如下所列）。 
 
議題(1) 有效率的多媒體廣播群播服務之無線電資源管理機制：多媒體廣播群播服務中定義了點對
點（Point-to-Point）傳輸以及點對多點（Point-to-Multipoint）的無線傳輸模式，分別使用專用邏輯
通道（Dedicated logical channel）和共用邏輯通道（Common logical channel）來傳輸多媒體廣播群
播服務之資料給使用者。當使用共用邏輯通道時，雖然可以同時服務多個使用者，但由於該通道必
頇使用足以傳送到整個涵蓋區域的傳送功率，因此會對專用邏輯通道造成嚴重干擾。如何有效率地
使用無線電資源來同時服務多媒體廣播群播服務以及傳統電信服務之使用者將是一個關鍵的議
題。 
議題(2) 安全的多媒體廣播群播服務之金鑰管理：多媒體廣播群播服務的金鑰管理機制使用四種金
鑰來確保多媒體廣播群播服務內容傳輸的安全性，分別為：Multicast Request Key（MRK）、Multicast 
User Key（MUK）、Multicast Service Key（MSK）與 Multicast Transport Key（MTK）。傳送這些安
全金鑰給群播群組中的每一個使用者將造成額外的信令，因此降低通用行動通訊服務網路的效能。
如何減少因為金鑰交換而造成額外的信令是值得研究的議題。 
議題(3) 有效率的多媒體廣播群播服務之檔案修復機制：當多媒體內容以群播方式傳送給使用者的
時候，由於網路擁塞以及訊號品質不良的影響，檔案在傳輸過程中會造成遺失或錯誤。為了重傳遺
失或錯誤的資料，3GPP 26.346 制定了三種檔案修復機制（File Repair Mechanism）：單點修復機制
（Unicast Repair Mechanism）、使用原檔案下載議程之群播修復機制（Multicast Repair Mechanism 
through Original Download Session）及透過新群播議程之群播修復機制（Multicast Repair Mechanism 
through New Repair Session）。這三種修復機制明顯地造成額外的信令及網路流量。因此，多媒體廣
播群播服務需一個更有智慧的檔案修復機制來將網路的信令以及流量降至最低。 
  
 本計畫將在三年內提出具體的成果。我們將詳細地研究多媒體廣播群播服務相關的規範。依據
這些研究結果，提出新的機制來解決上述的議題。理論上，針對我們提出的機制，我們將推導數學
分析模型來驗證其正確性並研究其效能。我們會實做模擬實驗來預測當提出之機制實際在現實系統
中運作時的效能。我們預期針對每個議題發表一至數篇國際論文以及專利。對於參與計畫之研究生，
可以深入了解各種最新的多媒體廣播群播服務運作機制與協定，這將有助於國內無線通訊人才培育。
除此之外，本計畫研究成果亦可提供給目前進行第三代行動通訊網路研究之學界及業界參考，促使
國內無線通訊技術的快速發展，提升國內無線通訊技術在國際間的競爭力。 
III 
 
 
目錄 
 
（1）研究計劃之背景 .............................................................................................. 1 
（1.1）多媒體廣播群播服務之架構 .................................................................... 1 
（1.2）MBMS 服務提供之流程 .......................................................................... 3 
（1.3）MBMS 無線電存取網路之簡介 .............................................................. 8 
（1.4）MBMS 安全性之簡介 ............................................................................13 
（1.5）總結 ..........................................................................................................21 
（2）研究計畫之目的 ............................................................................................23 
（2.1）議題一、有效率的多媒體廣播群播服務之無線電資源管理機制 .....23 
（2.2）議題二、安全的多媒體廣播群播服務之金鑰管理 ..............................23 
（2.3）議題三、有效率的多媒體廣播群播服務之檔案修復機制..................26 
（3）研究結果與討論 ............................................................................................31 
（3.1）第一年計畫成果 ......................................................................................31 
（3.2）第二年計畫成果 ......................................................................................47 
（3.3）第三年計畫成果 ......................................................................................67 
（4）計畫成果自評 ................................................................................................86 
 
2 
 
 
圖（一）、MBMS 系統架構圖 
 
 
表（一） MBMS Bearer Context 
 
 在 MBMS 系統架構中，為了能夠有效率地將資料繞送給使用者，規格定義了兩種
Context：MBMS Bearer Context 和 MBMS UE Context。如表（一）所示，MBMS Bearer Context
用來描述一個 MBMS 承載服務（MBMS Bearer Service）所需要的相關訊息（例如 IP 群播
位址、服務品質等參數），以及網路中有哪些下流節點（downstream nodes1）欲繞送此 MBMS
服務之內容資料。此 MBMS Bearer Context 會存在於 BM-SC、GGSN、SGSN 和 RNC 等網
路節點上。如果當使用者加入某個 MBMS 服務，而該網路節點卻沒有此 MBMS Bearer 
Context 時，該網路節點便建立此 Context 並通知上層的網路節點其欲繞送該 MBMS 服務給
使用者。此時，上層的網路節點便會將此節點加入到其 List of Downstream Nodes 的參數中。
另外，MBMS UE Context 則用來描述使用者所加入某 MBMS 承載服務之使用者相關資訊，
詳細的參數如表（二）所示。當使用者加入某個 MBMS 服務後，此 MBMS UE Context 便
會在 BM-SC、GGSN、SGSN、RNC 和 UE 被建立。 
4 
 
 
圖（三） MBMS Multicast Service Activation Procedure 
 
步驟 1. 使用者裝置執行 PDP Context Activation procedure [7]來建立一個 PDP Context，其用
來和 GGSN 間傳送接下來的信令訊息（Signaling Message），如果此 PDP Context 已
經存在，那麼使用者裝置就不需要執行 PDP Context Activation procedure 來建立
了。 
 
步驟 2. 使用者裝置送出一個 IGMP Join 訊息（IPv4 環境下）或是 MLD Join 訊息(IPv6 環
境下)到 GGSN，用來指出其想要加入一個 MBMS 承載服務。值得一提的是使用者
裝置利用 Join 訊息中的 IP 群播網路位址來指出其欲接收的群播 MBMS 承載服
務。 
 
步驟 3. GGSN 送出 MBMS Authorization Request 訊息到 BM-SC 去尋查使用者裝置是否
有權利使用這項服務，BM-SC 依據使用者裝置的訂購資訊做出授權的決定，如果
授權成功，BM-SC 將回傳 MBMS Authorization Response 訊息給 GGSN 並在其中
夾帶用來傳送此 MBMS 服務之 GGSN 的 Access Point Name（APN）。此 APN 可
能會和用來傳送信令訊息之 PDP Context 的 APN 不同，因此在 APN 解析時得到
的 GGSN 也可能會和接收加入訊息的 GGSN 不同。如果授權失敗，程序將立即結
束而不再交換任何訊息。 
 
步驟 4a. GGSN 送出 MBMS Notification Request 訊息給 SGSN，訊息內容包含 IP 群播位
址、APN 以及Linked NSAPI，Linked NSAPI 就是用來傳送 Join 訊息之 PDP Context 
的 NSAPI，APN 則是 BM-SC 指定用來傳送此 MBMS 服務之 GGSN。此時，GGSN 
會啟動一個 MBMS 啟動計時器來確認 SGSN 能正確無誤的通知到使用者裝置。 
6 
 
 
圖（四） MBMS Session Start Procedure 
  
 GGSN 送出 MBMS Registration Request 訊息給 BM-SC，BM-SC 將會回傳 MBMS 
Registration Response 訊息給 GGSN，內容包含 MBMS 承載服務的 MBMS Bearer 
Context 的資訊。此時，BM-SC 將 GGSN 加入到 MBMS Bearer Context 的 “list of 
downstream nodes” 參數。 
 
步驟 12. GGSN 建立 MBMS UE Context 並且傳送 Create MBMS Context Response 訊息給
SGSN。 
 
步驟 13. 如果 SGSN 沒有關於這個 MBMS 承載服務的 MBMS Bearer Context 的資訊，
SGSN 送出 MBMS Registration Request 訊息給 GGSN，GGSN 將會回傳 MBMS 
Registration Response 訊息給 SGSN，內容包含 MBMS 承載服務的 MBMS Bearer 
Context 的資訊。此時，GGSN 將 SGSN 加入到 MBMS Bearer Context 的 “list of 
downstream nodes” 參數。 
 
步驟 14. SGSN 利用 MBMS UE Linking procedure [8]將 MBMS UE Context 提供給目前使
用者裝置所在的 RNC。 
 
步驟 15. 如果 SGSN 在步驟 6 中已檢查過使用者裝置所能處理的 MBMS 承載能力時，
SGSN 送出 Activate MBMS Context Accept 訊息給使用者裝置指出該使用者裝置已
經成功的加入到此 MBMS 服務。訊息內容包含 TMGI 以及此 MBMS 承載能力（也
就是這個 MBMS 承載服務所使用最大的服務品質）。如果在執行步驟 6 時，SGSN 
並未核對使用者裝置所能處理的 MBMS 承載能力時，SGSN 便根據 MBMS Bearer 
Context 比對服務所需的最大服務品質與使用者裝置所能處理的最大服務品質，如
果使用者裝置不能滿足要求，SGSN 拒絕啟動 MBMS Context 的要求，並開始將已
經建立的 MBMS UE Context 做撤銷。如果使用者能滿足需求，SGSN 送出 Activate 
MBMS Context Accept 訊息給使用者裝置，表示該 MBMS 服務啟動成功。 
 
 
8 
 
的承載，BM-SC 便開始等待事先預設的延遲時間。當此時間結束後，BM-SC 便依據在
MBMS Service Activation Procedure 中建立的路由資訊開始傳送資料給使用者裝置。 
  
 圖（五）為 BM-SC 繞送一個 MBMS 服務給使用者裝置之例子。當資料開始傳遞時，
BM-SC 依據 MBMS Bearer Context 的“List of downstream nodes”參數將資料傳送給需要資
料的 GGSN（也就是 GGSN1），此時 GGSN 便會從 MBMS Bearer Context 檢查有哪些 SGSN 
需要接收資料（也就是 SGSN2），GGSN 便將資料送到 SGSN2。SGSN2 也檢查其 MBMS 
Bearer Context 有哪幾個 RNC 要接收（也就是目前使用者所在之無線電網路），然後將資
料傳到 RNC，最後再透過無線電傳到使用者裝置。 
 
 當資料傳送結束，如果接下來的一段長時間裡將不再有任何資料傳送，BM-SC 會啟動
MBMS Session Stop Procedure 來釋放所使用的網路承載資源。當使用者裝置不再需要接收
MBMS 資料時，使用者裝置啟動 MBMS Multicast Service Deactivation Procedure 將在 UE、
RAN、SGSN、GGSN 以及 BM-SC 裡的 MBMS UE Context 移除，同時也離開這個群播群
組。針對 MBMS 更詳細的介紹，請讀者參閱[1-5]。 
 
（1.3）MBMS 無線電存取網路之簡介 
 由於無線電資源是有限的，且遠比核心網路來的小，所以在資源利用上有著比核心網
路更加嚴格的使用方式，因此無線電資源掌握了能使用 MBMS  服務使用者數量的關鍵，
如何有效率地使用無線電資源，也就是對有限的資源做最佳的利用，便成為所有研究者所
致力的目標。 
 
 MBMS 設計所使用的無線電承載也是以最佳的使用方式為出發點，定義了點對點
（Point-to-Point）以及點對多點（Point-to-Multipoint）兩種傳輸方式，點對點傳輸為使用者
裝置與 RNC 之間利用專屬通 道（dedicated channel）方式連結，資料以及控制信令直接
經由這點對點的專屬通道傳送給使用者裝置， 此種傳輸方式為傳統的電路交換（circuit 
switch）網路傳輸方式，因此不多作贅述。不同於點對點傳輸， 在點對多點傳輸模式下，
核心網路可以同時將資料以及控制信令傳送給多個使用者裝置。為了作點對 多點傳輸，
3GPP  25.346  定義了三個新的邏輯通道（Logical  Channel ），分別是 MCCH （MBMS 
point-to-multipoint Control Channel）、MTCH（MBMS point-to-multipoint Traffic Channel）以
及 MSCH（MBMS point-to-multipoint Scheduling Channel）。 
 
 MCCH 用來在核心網路與眾多使用者裝置之間傳送控制信令等資訊，傳輸的資訊可以
分成兩大類：關鍵資訊（Critical Information）與非關鍵資訊（Non-critical Information），
關鍵資訊包含 MBMS 鄰接細胞資訊（MBMS NEIGHBOURING CELL INFORMATION）、
MBMS 服務資訊（MBMS SERVICE INFORMATION）、MBMS 無線電承載資訊（MBMS 
RADIO BEARER INFORMATION）： 
 
(1) MBMS 鄰接細胞資訊：其敘述鄰接細胞的 MTCH 組態，使用者裝置將利用這些
10 
 
 
圖（七）UE side MAC-m additions to MAC-c/sh 
 
 
 上述三種邏輯通道對應的傳輸通道（Transport Channel）皆為 FACH（Forward Access 
Channel），而 FACH 所對應的實體通道（Physical Channel）為 S-CCPCH（Secondary Common 
Control Physical Channel）。 
 
 為了因應新增的邏輯通道，MBMS 在 Media Access Control（MAC）的 MAC c/sh 新
增了 MAC-m，圖（六）為 UTRAN 新增的 MAC-m 的架構，其包含的部份分別為： 
 
 Scheduling/Buffering/Priority Handling：依據 MBMS 以及非 MBMS 資料的優先權和延
遲需求（delay requirement）對傳輸資源做管理。 
 TCTF（Target Channel Type Field） MUX：在 MAC 標頭裡新增一個 TCTF 欄位，這個
欄位用來做邏輯頻道與傳輸頻道之間對應，也就是指出使用的是哪一種邏輯頻道。 
 Addition of MBMS-ID：新增 MBMS-ID 欄位來分辨不同的 MBMS 服務。 
 TFC（Transport Format Combination）selection：負責做傳輸格式組合的選擇。對於每個
傳輸通道，在一段傳輸時間間隔裡，MAC-c/sh/m 會為其選擇適合該資料的傳輸格式，
傳輸格式包含區塊大小、編碼相關資訊等。當使用者使用多個傳輸通道時，在一段傳輸
時間間隔裡，每個傳輸通道所選出來的傳輸格式的組合即為傳輸格式組合。所有被 RNC 
允許用來作為傳輸用途的傳輸格式組合便成為一個傳輸格式組合集合，TFC 選擇便是
從這個集合裡挑選適合的傳輸格式組合來傳送資料。 
 
 在使用者裝置端也新增了相對應的 MAC-m，圖（七）為使用者裝置端的 MAC-m 的
架構，新增的部份分別為： 
 TCTF DEMUX：依據 MAC 標頭裡的 TCTF 欄位判斷其屬於哪一種邏輯通道，並且刪
除這個欄位。 
 Read MBMS-ID：依據 MBMS-ID 判斷這個資料是屬於哪一個 MBMS 服務。 
 
 由於  MBMS 使用的兩種傳輸方式分別建立不同的承載，也就是點對點承載
（Point-to-Point Bearer）以及點對多點承載（Point-to-Multipoint Bearer），但在一 cell 下兩
12 
 
 
圖（八）Channel type switching signaling flow from p-t-m to p-t-p 
 
圖（九）Session Start Procedure in UTRAN 
 
 以下我們將簡述一個計數流程所使用的時機。在圖（四）MBMS Session Start Procedure 
裡，我們已詳細敘述在核心網路到 RAN 之間的建立流程，但步驟 4 中，RAN 與使用者
裝置之間會建立無線電資源，圖（九）為 UTRAN 執行 Session Start 的流程，其詳細步驟
如下： 
 
步驟 1. UTRAN 通知使用者裝置議程即將開始。 
 
步驟 2. UTRAN 執行計數流程來判斷目前 cell 下的使用者裝置的數目，依據存在的使用者
裝置多寡來決定使用點對點傳輸或是點對多點傳輸，因此執行計數流程完畢後，
便開始建立與使用者裝置之間的無線電資源，如果為點對點傳輸，則使用 DTCH 來
傳輸 MBMS 服務，如果使用點對多點傳輸，則會使用 MTCH。 
 
步驟 3. 無線電資源建立完畢，當 BM-SC 開始傳送 MBMS 服務時，UTRAN 便可透過已
建立的通道將資料傳送給使用者裝置。 
 
14 
 
 
圖（十一）UMTS 認證流程圖 
 
認證流程如圖（十一）所示，其中HSS 將使用Authentication and Key Agreement（AKA）演
算法來計算所需要的金鑰[9]。 
 
步驟 1. 當使用者裝置要存取GPRS/UMTS 網路的時候，會先傳送Attach Request 訊息給
SGSN，此時SGSN 便會判斷是否存在這個使用者裝置相對應的Authentication 
Vector（AV），如果存在，則第二步與第三步會省略。否則，SGSN 會透過傳送
Authentication data request 的訊息給HSS以取得相關於這個使用者裝置的AV。 
 
步驟 2. HSS 藉由Authentication Data Request 訊息中使用者裝置的IMSI 來得到此使用者
裝置的資料，並且產生相對應的AV，HSS 利用隨機變數RAND 及順序數目（SQN）
與使用者裝置共同擁有的秘密金鑰K 產生出AV，此AV 包含一個隨機變數RAND、
認證訊息AUTN、兩把金鑰IK、CK 和一個用來對照的XRES。HHS 將這些AV 透
過Authentication data response 訊息回傳給SGSN。 
 
步驟 3. SGSN 會從接收到的許多AV 中選擇一個還沒有用過的，將其AV 中的RAND 與
AUTN 透過User authentication request 訊息傳送給使用者裝置。 
 
步驟 4. 當使用者裝置收到訊息，會透過AUTN 判斷是否能夠接受此訊息。使用者裝置會
透過AUTN、RAND 與原本存在之秘密金鑰K 產生出順序數目SQN、兩組金鑰IK、
CK 與用來對照的RES，UE 會先檢查SQN 是否夠大（表示其中並沒有被他人竄
改），如果通過檢查，會將RES 透過User authentication response 訊息傳送給SGSN。
當 SGSN 收到此訊息，會將RES 與之前送過來的XRES 作比對，如果相同，表示
這個認證與交換金鑰的過程是成功的。最後，SGSN 與UE 之間就會有相同的IK 與
CK 以供其對於將來的資料作加密解密之途。 
 
16 
 
6. 介面 Ua：介面Ua 乘載了應用程式協定的封包，其安全性受到金鑰的保護，此金鑰為在
使用者裝置與BSF 之間的介面Ub 上執行HTTP Digest AKA 所得到的結果。 
 
 我們可以透過每一個節點的介紹了解在 GBA 架構之下，有兩個重要的流程，第一個
為 
Bootstrapping 流程（如圖（十三）所示）細節如下： 
 
步驟 1. 使用者傳送一個HTTP 的要求給BSF。訊息內容包含此使用者裝置的使用者識別碼
（也就是IMSI）。 
 
步驟 2. BSF 會透過傳送Authentication data request 訊息給HSS 以取得相關於這個使用者
裝置的AV。HSS 透過訊息的使用者裝置的IMSI 來得到此使用者裝置的資料，並
且產生相對應的AV，HSS 透過隨機變數RAND 還有順序數目SQN 與使用者裝置
都共同擁有的秘密金鑰K 產生出AV，其中包含一個隨機變數RAND、認證訊息
AUTN、兩把金鑰 IK、CK 和一個用來對照的XRES。HHS 將這些AV 透過
Authentication data response 訊息回傳給BSF。 
 
步驟 3. BSF 會從接收到的許多AV 中選擇一個還沒有用過的，將其AV 帶有的資訊RAND 
與AUTN透過401 Unauthorized WWW- Authentication 訊息傳送給使用者裝置。 
 
步驟 4. 當使用者裝置收到訊息，會透過AUTN 判斷是否能夠接受此訊息。使用者裝置會
透過AUTN、RAND 與秘密金鑰K 產生出順序數目SQN、兩組金鑰IK、CK 與用
來對照的RES，UE 會檢查SQN 是否夠大（表示其中並沒有被他人竄改）。 
 
步驟 5. 如果通過檢查，使用者裝置傳送給 BSF 另一個HTTP 要求，其包含了Digest AKA 
回應（即為RES）。 
 
步驟 6. BSF 透過檢查RES 來認證使用者裝置。 
 
步驟 7. BSF 透過將CK 與IK 結合（concatenate）起來而製造出金鑰Ks，而Bootstrapping 
transaction identifier （B-TID）也在此步驟中產生出來，其格式如同一個NAI
（Network Address Identifier）的格式。 
 
步驟 8. BSF 會回傳一個內含B-TID 的200 OK 訊息給使用者裝置表示認證成功，此外，在
此200 OK訊息裡面，BSF 應該指出金鑰Ks 的有效時間。 
 
步驟 9. 當使用者裝置收到 200 OK 訊息，也會用和步驟七同樣的方式產生Ks（結合CK 與
IK）。使用者裝置與BSF 會透過下個流程的步驟從金鑰Ks 產生出金鑰Ks_NAF，
透過Ks_NAF 可以保護介面Ua 的安全性。其產生方式為Ks_NAF = KDF (Ks, 
"gba-me", RAND, IMPI, NAF_Id)，其中KDF 是在行動裝置（Mobile Equipment; ME）
上面執行的金鑰產生函式。 
18 
 
 
 
圖（十四）UMTS 使用 bootstrapped 安全協商流程 
 
 
 在我們探討完一個點對點的安全性是怎麼完成的之後，我們需要討論點對多點的安全
性如何在MBMS 中建立，其方式是透過點對點的安全性衍生出來的，在介紹這樣的轉換之
前，我們必頇先討論在群播服務裡面安全性的定義，以及MBMS 群播服務的協定堆疊，則
可以清楚地明白在MBMS 群播服務上面安全性如何被提供。 
 
 根據[16]的介紹，基於無線網路廣播的特性，一個群播服務必頇達到下述四點要求，才
能算是一個安全的群播服務。 
 
1. 當一個使用者加入某個群組之前，由於無線網路的特性，其可以接收到群播服務傳送給
其他使用者的封包，此時其無法得到群組金鑰並解開封包。 
 
2. 當一個使用者加入到某個群組之後，其得到的群組金鑰不能解開在其加入到群組前已傳
送的群播封包（此點表示此群組金鑰需要更新）。 
 
3. 當一個使用者離開某個群組之後，他仍然可以接收到群播服務的封包，此時其無法透過
既有的群組金鑰解開此群組中群播的封包（此點表示此群組金鑰需要更新）。 
 
4. 已離開群組的眾多使用者，並無法依據在離開群組前所得到的知識合力破解出之後的金
鑰。當然，MBMS 群播服務的安全性也要符合上述四點，接著我們先看一下MBMS 的協
定堆疊，如圖（十五）。 
 
20 
 
 
圖（十七）UMTS MBMS 的安全架構圖 
 
BSF之間已經執行了上述的bootstrapping流程2，而User Service Registration的實做方式是透
過HTTP-digest的方式來實做。在此流程當中，BM-SC的角色即為GBA中的NAF。圖（十 
七）為MBMS的安全架構圖[11]。 
 
 上述的 User Service Registration 即為圖（十七）中的HTTP Digest Authentication，其
中MRK 就是透過bootstrapping 之後得到的Ks_NAF 製造出來的密碼，而使用者名稱仍為
B-TID，透過執行User Service Registration，BM-SC 可以確認此使用者對這個User Service 作
註冊，並且同時也會確認此使用者是否有權限註冊此User Service（即利用MRK），如果使
用者裝置與BM-SC 所製造出來的MRK 是相同的，表示BM-SC 對使用者裝置認證成功，
則BM-SC 與使用者裝置之間的點對點承載即可以受到MUK 的保護，其是透過使用者裝置
與BM-SC 共有的Ks_NAF 所製造出來的。 
 
 當使用者裝置對於 BM-SC 註冊了某個User Service 之後，此使用者即有資格得到此
User Service的MBMS Service Key，簡稱MSK。MBMS 提供三種方法讓使用者裝置取得MSK，
可以由使用者裝置主動要求、由BM-SC pull 使用者裝置來拿此MSK、由BM-SC 直接將
MSK push 給使用者裝置。在這三種方法中，BM-SC 透過MIKEY[14]的方式用之前的MUK 
保護將MSK 封裝起來，並且利用UDP 與點對點的承載將此訊息送給使用者裝置。等到使
用者裝置得到了MSK，表示他可以正確地接收此User Service 群播的封包。 
22 
 
低通用行動通訊服務網路的效能。如何減少因為金鑰交換而造成額外的信令是值得研究的
議題。 
 
議題三、有效率的多媒體廣播群播服務之檔案修復機制：當多媒體內容以群播方式傳送給
使用者的時候，由於網路擁塞以及訊號品質不良的影響，檔案在傳輸過程中會造成遺失或
錯誤。為了重傳遺失或錯誤的資料，3GPP 26.346 制定了三種檔案修復機制（File Repair 
Mechanism）：單點修復機制（Unicast Repair Mechanism）、使用原檔案下載議程之群播修復
機制（Multicast Repair Mechanism through Original Download Session）及透過新群播議程之
群播修復機制（Multicast Repair Mechanism through New Repair Session）。這三種修復機制
明顯地造成額外的信令及網路流量。因此，多媒體廣播群播服務需一個更有智慧的檔案修
復機制來將網路的信令以及流量降至最低。 
 
 本計畫將在三年內提出具體的成果。我們將詳細地研究多媒體廣播群播服務相關的規
範。依據這些研究結果，提出新的機制來解決上述的議題。理論上，針對我們提出的機制，
我們將推導數學分析模型來驗證其正確性並研究其效能。我們會實做模擬實驗來預測當提
出之機制實際在現實系統中運作時的效能。我們預期針對每個議題發表一至數篇國際論文
以及專利。對於參與計畫之研究生，可以深入了解各種最新的多媒體廣播群播服務運作機
制與協定，這將有助於國內無線通訊人才培育。除此之外，本計畫研究成果亦可提供給目
前進行第三代行動通訊網路研究之學界及業界參考，促使國內無線通訊技術的快速發展，
提升國內無線通訊技術在國際間的競爭力。
24 
 
在3GPP原本設計的金鑰管理機制裡面為了達到安全的目的，因此存在四種金鑰：MRK、
MUK、MSK與MTK，我們可以知道MRK與MUK是利用使用者裝置原本就會有的IK與CK
結合出來的Ks所計算出來的，所以不需要花費額外的信號來傳送此兩把金鑰，然而，為了
傳送對應到一個User Service的MSK，必頇透過點對點的方式將MSK用MUK加密傳送給每
一個使用者裝置，這個傳送也是必要的，由於每個使用者的MUK不同，為了讓大家都得到
同一把MSK，必頇透過這樣的方式來傳輸。之後，透過群播的方式將MTK透過MSK加密給
加入此User Service的每一個使用者裝置，最後用MTK加密每一個RTP議程。透過這樣複雜
的流程可以確保MTK是非常新的，不會過時。但是若我們考慮[16]所提及的四點群播服務
的安全性要求時，我們會發現這樣的架構要付出額外的信令傳遞，如圖（十八）所示，我
們舉出一個例子：如圖（十八）（a）所示，BM-SC將MSKa利用點對點的方式利用MUK1、
MUK2與MUK3傳送給這個User Service裡面的UE1、UE2與UE3。在圖（十八）（b）所示，透
過MSKa加密MTKI給此User Service裡面的每個UE。當圖（十八）（c）時，表示UE3離開了
這個User Service，則根據[16]的第三點，我們必頇讓UE3沒有辦法用MTKI來解開之後的資
料封包，BMSC勢必要傳輸新的MTK給UE1與UE2，然而，為了傳輸新的MTK，要用MSK
加密，但是UE3也有目前的MSKa，故得重新透過點對點的方式將MSKb用MUK1與MUK2加
密後傳輸給UE1與UE2，則在圖（十八）（d）用MSKb加密MTKII廣播的時候，UE3因為沒有
新的MSKb，因此他無法解開並得到MTKII。因此，這樣的模式，每當有UE加入或離開某
User Service的時候，都需要執行一次上述（c）與（d）的步驟以更新MSK與MTK，如果某
User Service群組中的UE個數很多，或者是此User Service群組的進出很頻繁的時候，信令的
傳送會很頻繁，會對整體系統效能造成很大的影響。 
B. 國內外有關本計劃之研究情況 
為了減少額外的信令傳遞，[17]-[20]就提出了金鑰樹（Key Tree）的概念套用在群播服
務的安全性當中。[17]定義重新得到金鑰（rekeying）的動作是當有人離開或進入此User 
Service群組時，群組中的人要得到金鑰的動作。[18]證明了rekeying的動作會讓整個系統的
效能非常低落，因此[19][20]將[17][18]的建議實做，設計出金鑰樹，以減少信令的消耗，我
們將金鑰樹簡介如下： 
 
圖（十八）UMTS MBMS 金鑰散佈的例子 
 
BMSC
UE1 UE2 UE3
MUK1{MSKa} MUK2{MSKa} MUK3{MSKa}
(a)
BMSC
UE1 UE2 UE3
(b)
MSKa{MTKI}
MTKI MTKI MTKI
BMSC
UE1 UE2 UE3
MUK1{MSKb} MUK2{MSKb}
(c)
MSKa MSKa MSKa MSKa MSKa MSKa
MTKI
MSKaMSKb MSKb
BMSC
UE1 UE2 UE3
(d)
MTKI
MSKaMSKb MSKb
MTKII MTKII
MSKb{MTKII}
26 
 
的概念應用到MBMS的網路之中，此篇論文希望透過金鑰樹的方式讓使用者換新的金鑰時，
其所花費的信令數目能夠減少到最低。 [22]提出了一種與拓樸相符的金鑰管理
（Topology-Matching Key Management；TMKM）樹，其利用了行動通訊網路的特性，將金
鑰樹與行動通訊網路拓樸整合在一起，以減少信令花費。 
C. 重要參考文獻之評述 
雖然上述文獻針對信令減少而設計，但[17-20]是針對金鑰樹的概念作一些定義，並且
透過傳統演算法與圖論的概念，針對金鑰樹的複雜度以及能夠解省的信令作數學分析，只
能把這些文獻當作背景資料來參考。[21]雖然針對MBMS設計了金鑰樹的概念，但是論文當
中並沒有針對其整體架構設計作深入的分析比較，只是建議將金鑰樹應用在MBMS上，但
是實際如何運作我們無法從此文獻當中得知。[22] 所提出的架構是針對行動通訊網路所設
計的，但關於信令的地方做了很多假設，細節也不清楚。在此議題當中，我們希望能夠把
金鑰樹（不論是與拓樸有關的傳統金鑰樹或者是與拓樸有關的新型金鑰樹）的概念應用在
MBMS金鑰管理當中，並且設計出模擬平台，以便能夠比較不同的金鑰管理機制對於MBMS
網路效能的影響。 
（2.3）議題三、有效率的多媒體廣播群播服務之檔案修復機制 
A. 重要性 
群播內容傳遞過程，由於使用者裝置的移動性以及外在環境的變化，資料會因為無線
訊號品質不良而遺失或是錯誤，對於串流服務而言，遺失或錯誤並不會造成嚴重的影響，
又因為串流服務的即時性（Real-Time），修復後的資料也可能已不再需要，使用者裝置不
需針對串流服務內容加以修復。然而，檔案下載服務卻不然。接收端若無法完整無誤的接
收整個檔案，便無法正確的使用或是完整的呈現。3GPP 26.346 定義了三種檔案修復機制
（File Repair Mechanism）：單點修復機制（Unicast Repair Mechanism）、使用原檔案下載議
程之群播機制（Multicast Repair Mechanism through Original Download Session）及透過新群
播議程之群播修復機制（Multicast Repair Mechanism through New Repair Session）。 
 單點修復機制：使用者發出修復請求，告知 BM-SC 其所缺少或錯誤的資料區塊，BM-SC
便將修復資料夾帶在修復回覆中傳送給使用者，但是如果一個細胞下，許多人都要求
同意修復資料時，相同資料會被傳送許多次，因此造成了不必要的浪費。 
 使用原檔案下載議程之群播機制：每個使用者發出修復請求，告知 BM-SC 其所缺少或
錯誤的資料區塊，BM-SC 將在修復回覆中告知使用者，修復資料會在原本傳送檔案的
這個議程群播給使用者，一段時間之後 BM-SC 便將資料群播給所有在群組中的使用者，
但是即使未發出修復請求的使用者也會收到。 
 透過新群播議程之群播修復機制：每個使用者發出修復請求，告知 BM-SC 其所缺少或
錯誤的資料區塊，BM-SC 將在修復回覆中告知使用者，修復資料將在一個新的修復議
程中群播給使用者，因此使用者必頇執行 MBMS Service Activation Procedure（請參閱
圖三）加入到新的修復議程，一段時間之後 BM-SC 便將資料群播給加入到這個群組的
使用者，因此只有需要修復資料的使用者接收到修復資料，但是其他修復資料的使用
28 
 
因為IP網路的檔案修復機制並未考慮到UMTS網路之特性，所以要將其應用在MBMS
上並不適用，而[26]所提之檔案修復機制雖然將FEC使用在檔案修復，並且已得到明顯改進，
然而並未對傳輸方式加以改進，因此仍舊存在著不需要修復資料的使用者會接收到修復資
料，依舊會浪費許多網路資源。在此議題當中，我們將針對修復檔案之傳輸方式提出機制
加以改進，而FEC的使用方面，因為FEC針對的是以編碼方式達到檔案修復，因此可以套用
在任何一種修復檔案之傳輸方式，因此我們不考慮FEC的部份。 
30 
 
[15] Chou, C. M., Hsu, S. F., Lee, H. Y., Lin, Y. C., Lin, Y. B., and Yang, R. S. CCL ISA: A CORBA-based 
Open Service Access System. International Journal of Wireless and Mobile Computing, to be 
published. 
[16] Paul, S. Multicast on the Internet and Its Applications. Kluwer Academic, 1998. 
[17] Canetti, R., Garay, J., Itkis, G., Miccianancio, D., Naor, M., and Pinkas, B., “Multicast security: A 
taxonomy and some efficient constructions,” IEEE InfoCOM 99, 2:708-716, March 1999 
[18] Moyer, M. J., Rao, J. R., and Rohatgi, P., “A survey of security issues in multicast communications,” 
IEEE Network, 13(6):12–23, Nov.–Dec. 1999 
[19] Wong, C., Gouda, M., and Lam, S.,“Secure group communications using key graphs,” IEEE/ACM 
Trans. Networking, 8(1):16-30, February 2000. 
[20] Goshi, J. and Lander R.E., “Algorithms for Dynamic Multicast Key Distribution Trees, “ Proc. ACM 
Symp. Principles of Distributed Computing (PODC 2003) 
[21] Wenyuan X., Trappe, W., and Paul, S., “Key management for 3G MBMS security,” IEEE 
GLOBECOM '04. 4: 2276-2280, 29 Nov.-3 Dec. 2004  
[22] Sun, Y., Trappe, W., and Liu. K. J., “A scalable multicast key management scheme for heterogeneous 
wireless networks”, IEEE/ACM Transactions on Networking, 12(4): 653-666, August 2004. 
[23] Nonnenmacher, J., Biersack, E. W., and Don Towsley, E. W., Parity-based Loss Recovery for Reliable 
Multicast Transmission. IEEE/ACM Transaction on Nerworking, 6(4):349-261, August 1998. 
[24] Paul, S., Sabnani, K. K., Lin, C. H., and Bhattacharyya, S., Reliable Multicast Transport Protocol 
(RMTP). IEEE Journal on Selected Areas in Communications, 15(3):407-421, April 1997. 
[25] Lacher, M. S., Nonnenmacher, J., and Biersack, E. W., Performance Comparison of Centralized 
Versus Distributed Error Recovery for Reliable Multicast. IEEE/ACM Transaction on Nerworking, 
8(2):224-238, April 2000. 
[26] Jenkac, H., Liebl, G., Stockhammer, T., Xu, W., Retransmission Strategies for MBMS over GERAN. 
Wireless Communications and Networking Conference, 2005 IEEE, 3:1773-1779, 13-17 March 2005. 
[27] Akyildiz, I. F., Lin,Y. B., Lai, W. R., and Chen, R. J., A New Random Walk Model for PCS Networks. 
IEEE IEEE Journal on Selected Areas in Communications , 18(7): 1254-1260, 2000. 
 
 
32 
 
析模型，並開發模擬程式。這項研究指出 URM 為了研究這兩個演算法的效能(包括通話未
完成率、用戶滿意度指標等)，我們推導出數學分析模型，並開發模擬程式。這項研究指出
不管在傳統通話服務中的通話未完成率及用戶滿意度指標中，URM 都較 RRM 優越，但
URM 會稍稍減少多媒體廣播群播服務之效能。 
 
英文摘要 
3GPP 23.246 defines the Multimedia Broadcast Multicast Service (MBMS) to deliver 
multicasting content over the Universal Mobile Telecommunications System (UMTS), where the 
common logical channel may be enabled to serve multiple MBMS users at the same time. 
However, the usage of the common logical channel may cause interference to the dedicated 
logical channels serving the traditional calls. To more efficiently utilize the radio resource to 
serve both traditional and MBMS calls, this work proposes two channel allocation algorithms: 
Reserved Resource for Multicasting (RRM) and Unreserved Resource for Multicasting (URM). 
We develop simulation models to investigate the performance for the two algorithms, including 
the call incompletion probability and customers‟ satisfaction indication. Our study indicates that 
URM outperforms RRM in terms of the call incompletion probability for the traditional calls and 
satisfaction indication by slightly degrading the performance of MBMS calls. 
 
Keywords: Channel Allocation, Multimedia Broadcast and Multicast Service (MBMS), 
Performance Modeling, Soft Handoff, Universal Mobile Telecommunications System. 
 
1. Introduction 
The Third Generation Project Partnership (3GPP) working group proposed the Multimedia 
Broadcast Multicast Service (MBMS) [a.2] to support multicasting over the Universal Mobile 
Telecommunications System (UMTS) [a.9, a.10]. Fig. 1 shows the MBMS architecture. The 
MBMS is evolved from the original UMTS network, which consists of the Universal Terrestrial 
Radio Access Network (UTRAN) and the core network. The existing network nodes, including 
Gateway GPRS Support Node (GGSN), Serving GPRS Support Node (SGSN), Radio Network 
Controller (RNC), and User Equipment (UE), are modified to accommodate the MBMS service. 
The GGSN is enhanced to receive MBMS-specific IP multicast traffic, manage the GPRS 
Tunneling Protocol (GTP) tunnels, and route the MBMS packets towards those SGSNs that have 
requested to receive the MBMS service. The SGSN performs the MBMS bearer service control 
function for each user and delivers the MBMS packets to the UTRAN. The new network node, 
Broadcast Multicast Service Center (BM-SC), serves as an MBMS data source or an entry point 
for content providers through the Open Service Access-Service Capability Server (OSA-SCS) 
interface. For more details of the MBMS service, readers may refer to [a.2]. 
 
 In the MBMS service, two wireless transmission modes are defined between the UE and 
UTRAN, which are Point-To-Point (PTP) and Point-To-Multipoint (PTM) modes. In the PTP and 
PTM modes, the dedicated logical channel and the common logical channel are used to deliver 
MBMS data to UEs, respectively. The MBMS user may use a dedicated logical channel (through  
34 
 
2. Channel Allocation Algorithms 
 This section describes the RRM and URM algorithms. Before detailing the two algorithms, 
we briefly illustrate the WCDMA air interface. In WCDMA, the Orthogonal Variable Spreading 
Factor (OVSF) technique [a.4, a.6, a.16] is used to preserve the orthogonality among users‟ 
physical channels. The physical channels are assigned OVSF codes with different spreading 
factors (denoted as v) for variable rate transmission services. Let Code𝑣   denote an OVSF code 
with spreading factor v where 
v ∈ {2n | n is an integer and 2 ≤ n ≤ 9} . 
 For a physical channel with an OVSF code of a smaller v, a higher transmission rate service 
can be supported. Suppose that the physical channel assigned with the code Code29  supports the 
bit rate r. Then, the physical channel with the code Code29−𝑖  can support bit rate 2
i
r. As 
mentioned in [a.9], in the real implementation, r is 7.5 kb/s. Within the coverage area of a Node 
B (also known as “cell”), the total bit rate that can be allocated to the physical channels is 29r. Let 
2
L
r denote the total bit rate that can be allocated to the physical channels in a cell, where L is an 
integer and 1 ≤ L ≤ 9. Assume that the logical channel (either dedicated logical channel or 
common logical channel) is implemented by the physical channel supporting bit rate 2
l
r where l 
is an integer and 0 ≤ l ≤ L. Then the total number C of logical channels within a cell is 
 
C = 2
L−l 
  
In WCDMA, the common and dedicated logical channels are implemented by the physical 
channels. The soft handoff is supported for dedicated logical channels [a.5, a.17] and soft 
combining is supported for common logical channels [a.1, a.12], where a handoff call can use 
different logical channels to connect to more than one Node B at the same time in the overlapping 
areas between adjacent cells. 
 
 To simplify our discussion, in this study, we assume that a UE can only carry a traditional 
call or an MBMS call at a time. We consider homogeneous traditional and MBMS calls. Both 
dedicated logical channels and common logical channels have soft handoff capability. Fig. a.2 
shows the channel pool of a Node B. A traditional call is served by the dedicated logical channel. 
An MBMS call can be served by either the dedicated logical channel (i.e., PTP mode) or the 
common logical channel (i.e., PTM mode), which is controlled by a control logic. As mentioned 
previously, the usage of the common logical channel may cause high interference to dedicated 
logical channels. We assume that turning on one common logical channel causes damage to θ 
dedicated logical channels. A Node B turns on at most one common logical channel to serve the 
MBMS calls. 
36 
 
system checks whether the handoff queue is empty. If not, the released channel is assigned to a 
handoff call in the queue. Otherwise, CRt ← CRt − 1. When an MBMS call is completed, CRm ← 
CRm − 1. 
 
Algorithm URM. The URM does not reserve in advance any common logical channel to serve 
the MBMS calls. For an MBMS call request, the control logic is enabled to decide whether 
the dedicated logical channel or the common logical channel can be used to serve the 
MBMS call. If number of MBMS calls in the system is larger than θ, then URM attempts to 
turn on the common logical channel for the incoming MBMS call. We consider the 
following two cases to handle a new or handoff MBMS call request. 
 
Case URM1: The system is at the ON state. The request is accommodated, and it will be served 
by the common logical channel. CRm ← CRm + 1. 
 
Case URM2: The system is at the OFF state. If C − CRt  < θ + 1, the common logical channel 
cannot be turned on. The system determines whether C − CRt − CRm > 0. If so, one dedicated 
logical channel is allocated to serve the new or handoff MBMS call request, and CRm ← 
CRm + 1. Otherwise (i.e., C − CRt − CRm = 0), the new MBMS call request is blocked. For 
the handoff MBMS call, it is buffered in the handoff queue for the second link. If no channel 
is available before the MBMS user moves out of the overlapping area, the handoff call is 
forced to terminate. If C − CRt ≥ θ + 1, then we may turn on the common logical channel to 
serve MBMS calls. The system checks whether CRm + 1 ≤ θ. If so, one dedicated logical 
channel is allocated to serve the new or handoff MBMS call request, and CRm ← CRm + 1. 
Otherwise (i.e., CRm + 1 > θ), we turn on the common logical channel to serve the MBMS 
request: The system state switches from OFF to ON. The CRm calls (that are currently 
served by the dedicated logical channels) are moved to the common logical channel. The 
new MBMS call is accommodated by setting CRm ← CRm + 1. 
 
The following two cases are considered to handle a new or handoff traditional call request: 
 
Case URM3: The system is at the ON state. In this case, URM handles the traditional call 
request in the same way as RRM. 
 
Case URM4: The system is at the OFF sate. If C − CRt − CRm > 0, then one dedicated logical 
channel is allocated to serve the new or handoff traditional call request. Otherwise (i.e., C− 
CRt − CRm = 0), the call request is blocked if it is a new traditional call, and the call request 
is buffered in the handoff queue if it is a handoff traditional call. If the traditional call user 
moves out of the overlapping area before the free channel is available, the call is forced to 
terminate. 
 
When a served traditional call is completed, one dedicated logical channel is released. The 
38 
 
The soft handoff model in [17] is applied to derive the output measures for the traditional calls. 
Fig. 4 illustrates the timing diagram for the soft handoff model, where ti represents the time 
period when a UE can receive the signal from Cell i. Because the cells may overlap, the UE will 
enter Overlapping Area i before it moves from Cell i to Cell i + 1. Let xi be the time period when 
the UE stays in the non-overlapping area of Cell i. Suppose that the overlapping period is τi. Then 
ti can be expressed as 
ti = τi-1 + xi + τi. 
 
A connecting traditional call utilizes one dedicated logical channel during the non-overlapping 
period xi, and is looking for a second dedicated logical channel from Cell i+1 during τi. Assume 
that the second dedicated logical channel is found at time μi and zi is the residual cell residence 
time in cell i. Then the channel occupancy time of the connecting traditional call in Cell i+1 is 
min(zi+1, the remaining call holding time). Since cell residence time ti is exponentially distributed, 
from the memoryless property, zi also has the same distribution as ti. Let E[zi] = 1/ω, E[xi] = 1/η 
and E[τi] = 1/γ. Then from (1), we have  
 
E[zi] = E[ti] = E[τi-1] + E[xi] + E[τi]. 
 
The output measures derived in our models include: 
 λo,t ( λo,m ): traditional (MBMS) handoff call arrival rate 
 Po,t ( Po,m ): new call blocking probability for a traditional call (an MBMS call) 
 Pf,t ( Pf,m ): the forced termination probability for a traditional handoff call (an MBMS 
handoff call), i.e., the probability that a traditional handoff call (an MBMS handoff call) is 
dropped because no radio channel is available in the new cell 
 Pnc,t ( Pnc,m ): the call incompletion probability for a traditional call (an MBMS call) 
 
Following the previous study [a.11], we use the Satisfaction Indication (denoted as SI) to 
reflect the customers‟ satisfaction about the network, which is defined as follows: Let Pc,t (Pc,m) 
be the probability that a traditional (an MBMS) call is completed, Pi,t (Pi,m) be the probability that 
a traditional (an MBMS) call is connected but is eventually force terminated, Ti,t (Ti,m) be the 
expected effective call holding time for a traditional (an MBMS) incomplete call, Tc,t (Tc,m) be the 
expected effective call holding time for a traditional (an MBMS) complete call, and E[tc] = 1/μt 
(E[tm] = 1/μm) be the expected non-interrupted traditional (MBMS) call holding time. Then SI is 
expressed as: 
 
𝑆𝐼 =  
𝜆𝑜 ,𝑡
𝜆𝑜 ,𝑡 + 𝜆𝑜 ,𝑚
  
𝑃𝑖 ,𝑡𝑇𝑖 ,𝑡 + 𝑃𝑐 ,𝑡𝑇𝑐,𝑡
E 𝑡𝑐 ,𝑡 
 +  
𝜆𝑜 ,𝑚
𝜆𝑜 ,𝑡 + 𝜆𝑜 ,𝑚
  
𝑃𝑖 ,𝑚𝑇𝑖 ,𝑚 + 𝑃𝑐 ,𝑚𝑇𝑐 ,𝑚
E 𝑡𝑐,𝑚  
  
 
Note that since Pi,t Ti,t + Pc,t Tc,t ≤1/μt and Pi,m Ti,m + Pc,m Tc,m ≤1/μm, we have 0 ≤ SI ≤ 1, and a 
larger SI implies a higher customer satisfaction. 
 
40 
 
calls. On the other hand, Pnc,m for URM increases as λo,t increases. Since in URM, the system does 
not preserve the common logical channels for the MBMS calls, the MBMS calls have to compete 
for the logical channels with traditional calls. 
 
In Figs. a.5 (c) and a.6 (c), we observe that SI is an decreasing function of λo,t for both URM 
and RRM. The URM outperforms RRM in terms of SI. Though URM does not reserve the logical 
channels for MBMS calls, Pnc,m for URM does not degrade so significantly (as shown in the 
figures, the Pnc,m values are below 4%). Thus, URM can provide better customers‟ satisfaction 
(i.e., SI) than what RRM does. 
 
Effects of the Overlapping Period: In Fig. a.5, we also investigate the effects of the expected 
length of the overlapping period (i.e., E[τi]) on the performance for URM and RRM. For both 
traditional and MBMS calls, when E[τi] increases, we have the following facts: 
 
Fact 1. The served calls occupy the channels longer so that the new call arrivals have less chance 
to be allocated channels, which will increase the new call blocking probability. 
 
Fact 2. When the UE stays in the overlapping area longer, it is more likely for handoff calls to 
obtain the second link from the new cell, which reduces the force termination probability. 
 
Consider Fig. a.5 (a). For Pnc,t for RRM and URM, when λo,t is small, the impacts of E[τi] is 
insignificant (see Fig. 8 (a) when λo,t = 4μt). When λo,t > 4μt, Pnc,t for URM and RRM increases as 
E[τi] increases. This is because when λo,t is large, the impact of Fact 1 is more significant than 
that of Fact 2, and dominates the Pnc,t performance. 
 
Consider Fig. a.5 (b). In this figure, we set λo,m =μt (i.e., small MBMS new call arrival rate). 
Facts 1 and 2 are balanced, therefore, we observe that E[τi] has insignificant effects on Pnc,m for 
URM and RRM. 
 
From Figs. a.5 (a) and (b), we observe that when λo,t is small, E[τi] has insignificant effects on 
Pnc,t and Pnc,m for URM and RRM. When λo,t becomes high, increasing E[τi] degrades Pnc,t for 
URM and RRM. Consequently, Fig. a.5 (c) shows that with small λo,t, E[τi] has insignificant 
effects on SI for URM and RRM, but with high λo,t, as E[τi] increases, SI for URM and RRM 
decreases. 
 
Effects of the Non-overlapping Period: In Fig. a.6, we study the effects of the non-overlapping 
period E[xi] = 1/η. As η increases, the UE stays in the non-overlapping area shorter, and the UE is 
more likely to make soft handoff. Either traditional or MBMS calls attempt to occupy the second 
links in the new cell, and the radio resource is consumed more quickly. Thus, for both URM and 
RRM, we observe that Pnc,t increases as η increases (see Fig. a.6 (a)). Pnc,m for URM degrades as 
η increases. However, η does not cause any effect on Pnc,m for RRM. This is due to the resource 
42 
 
Fig. a.8: Effects of μm (θ = 4, λo,t = 6μt, μm = 0.25μt, γ= 20μt) 
 
 
 
Fig. a.9: Effects of θ (λo,m =μt, μm = 0.25μt, γ= 20μt, η = 0.5μt) 
 
 
 
Fig. a.10: (a)-(c) Effects of Var[xi] (θ = 4, λo,t = 6μt, λo,m =μt, 
   μm = 0.25μt, γ= 20μt). (d)-(f) Effects of Var[τi] 
     (θ = 4, λo,t = 6μt, λo,m =μt, μm = 0.25μt, η = 0.5μt) 
 
Effects of θ: Fig. a.9 investigates the effects of θ on the performance for RRM and URM. A 
44 
 
on the radio resource in the UMTS network. We considered two channel allocation algorithms, 
RRM and URM for the UMTS MBMS service. In RRM, a common logical channel is reserved to 
serve the MBMS calls. On the other hand, URM is enabled a control logic to decide whether the 
dedicated logical channel or the common logical channel can be used to serve MBMS calls. In 
other words, if the number of MBMS calls in the system is larger than a predefined threshold θ, 
then URM turns on the common logical channel to serve the new incoming MBMS calls. In our 
study, to more precisely simulate the radio interface of UMTS, i.e., WCDMA, we apply the 
soft-handoff model for both traditional and MBMS calls while constructing analytic and 
simulation models. Our performance evaluation results showed that URM outperforms RRM in 
terms of Pnc,t (i.e., the call incompletion for the traditional calls) and SI (i.e., customers‟ 
satisfaction indication) in all cases by slightly degrading the Pnc,m (i.e., the call incompletion for 
the MBMS calls) performance, and when the MBMS call arrival rate, λo,m, increases, the 
performance for URM approaches that for RRM. 
 
  
46 
 
54(2):591–601, March 2005. 
[a.17]  Lin, Y.-B. and Pang, A.-C. Comparing Soft and Hard Handoffs. IEEE Transactions on 
Vehicular Technology, 49(3):792–798, May 2000. 
[a.18]  Sipila, k., Honkasalo, Z., Laiho-Steffens, J. and Wacker, A. Estimation of Capacity and 
Required Transmission Power of WCDMA Downlink Based on a Downlink Pole 
Equation. Proc. of IEEE VTC2000-Spring, pages 1003–1005, 2000. 
 
  
48 
 
shows that the proposed HFS can reduce both communication and storage overhead without 
damaging QoS of UMTS MBMS 
 
1. Introduction 
To deliver multimedia content efficiently over the Universal Mobile Telecommunications System 
(UMTS), 3GPP proposed the Multimedia Broadcast/Multicast Service (MBMS) based on UMTS 
[b.1][b.2]. UMTS MBMS utilizes point-to-multipoint transmission technology, where the 
multimedia content is delivered from a single source to a group of mobile devices through the 
UMTS MBMS transmission bearer. Figure 1 illustrates the simplified UMTS MBMS network 
architecture [b.3]. The User Equipment (UE; Figure b.1 (a)) receives the MBMS application (also 
known as MBMS User Service) [b.4] from the Broadcast Multicast-Service Center (BM-SC; 
Figure b.1 (b)), which is an application server serving as an MBMS data source or as an entry 
point for the multimedia content provider. The UEs joining the multicast group for a specific 
MBMS User Service are called joined UEs. The BM-SC initializes the establishment of the 
MBMS transmission bearer, then sends multimedia content to the joined UEs. The Home  
Subscriber Subsystem (HSS; Figure b.1 (c)) maintains UMTS subscriber information (e.g., 
security related information). The Bootstrapping Server Function (BSF; Figure b.1 (d)) is a 
security server function, which is responsible for establishing shared secrets between the BM-SC 
and UEs. The BM-SC multicasts MBMS content to the joined UEs via a broadcasting network 
bearer. To prevent the non-joined UEs from receiving the MBMS content, 3GPP 33.246 proposed 
the Key Management Mechanism (KMM) [b.5], which are described as follows. 
 
A specific MBMS User Service has two corresponding group keys, namely the MBMS 
Transmission Key (MTK; denoted as T) and the MBMS Service Key (MSK; denoted as S). 
Every UE of an MBMS User Service group has the same S and T. T is used to protect multicast 
content from eavesdropping or modification, where the multicast content is encrypted by T 
before being multicasted to all joined UEs. A UE uses T to decrypt content that it receives. T is 
multicasted from BM-SC to all joined UEs by sending S{T}, which means that T is encrypted by 
S. S is individually unicasted from BMSC to every joined UE. During an MBMS User Service, T 
or S is updated when one of the following events occurs: (Event 1) a new UE joins the multicast 
group; (Event 2) a joined UE leaves the multicast group; (Event 3) the timer of the current S 
expires, or (Event 4) the timer of the current T expires. The User Service Join procedure (denoted 
as P1 for Event 1), the User Service Leave procedure (denoted as P2 for Event 2), the MSK 
Periodic Update procedure (denoted as P3 for Event 3), and the MTK Periodic Update procedure 
(denoted as P4 for Event 4) are exercised at this moment in order to update T or S [b.5]. The four 
procedures are described in detail below. 
 
Figure b.2 shows the message flow for Procedure P1 with the following steps, where we 
suppose that the multicast group contains N joined UEs. Assume that a new UE, UEN+1, joins the 
MBMS User Service, and before UEN+1 joins the service, the two keys, S
old
 and T
old 
are used for 
the MBMS User Service. 
50 
 
Bootstrapping authentication
Bootstrapping usage procedure (RN+1) 
Generate Snew
UN+1{S
new}
UEN+1 BSFBM-SCUE1...N
S
new{Tnew} Generate T
new
Derive UN+1 and RN+1
U1...N{S
new}
J3
J2
J4
J1
Derive UN+1 and RN+1
 
Figure b.2. Message flow for the User Service Join Procedure in KMM 
 
In this report, to consider Issues 1 and 2, KTS is first modified so that it can be applied in 
UMTS MBMS KMM. Analytical results indicate that KTS is not efficient in UMTS MBMS 
KMM. The Hash Function Scheme (HFS), which is regarded as more efficient than KTS, is then 
proposed. The rest of this report is organized as follows. The application of KTS in the existing 
UMTS MBMS KMM is described in Section 2. Section 3 details HFS. Section 4 provides 
security analysis for HFS. Section 5 conducts an analytical model and simulation experiments to 
evaluate the performance of KMM with/without KTS or HFS. Finally, Section 6 concludes this 
report. 
 
2. KTS in UMTS MBMS Key Management 
 This section describes how to apply KTS in UMTS MBMS KMM. In KTS, BM-SC 
establishes and maintains a balanced binary key tree [b.9, b.14]. As shown in Figure b.3, each 
leaf U of the tree is assigned to corresponding joined UE (Figure b.3 (a)). The root of the key tree 
is S for the multicast group (Figure b.3 (b)). The intermediate nodes of the key tree are the 
intermediate KEKs (Figure b.3 (c)), which are used to facilitate efficient S updates. 
 
Consider N joined UEs, UE1, UE2,…, UEN, in the multicast group. Let H be the height of the 
binary tree, which can be calculated by 𝐻 =   𝑙𝑔𝑁 . The keys in the tree have the index number 
(i, j), where 0 ≤ 𝑖 < 𝐻 is the layer number, and 1 ≤ 𝑖 < 2𝑖  is the position number in layer i. 
The index number for the parent of the KEK with the index (i, j) is given by (𝑖 − 1,  
𝑗
2
 ). 
Suppose that UEj is assigned the user key UH,j where 1 ≤ 𝑗 < 𝑁. The content is encrypted by the 
intermediatekey Ki,j before it is multicasted to 2
H−i
 UEs, UE2𝐻−𝑖(𝑗−1)+1, UE2𝐻−𝑖(𝑗−1)+2 , ..., 
UE2𝐻−𝑖𝑗 . UH,j is used to encrypt the key that will be unicasted to UEj. UEj stores S, T, Rj, UH,j and 
H−1 intermediate keys 𝑲
𝐻−1, 
𝑗
2
 
, 𝑲
𝐻−2, 
𝑗
22
 
, …, 𝑲
1, 
𝑗
2𝐻−1
 
. In other words, UEj contains H + 3 keys. 
  
 
 
52 
 
To prevent UEk from decoding overheard multicast content,  𝑲
𝐻−1, 
𝑘
2
 
𝑜𝑙𝑑 , 𝑲
𝐻−2, 
𝑘
22
 
𝑜𝑙𝑑 ,..., 
𝑲
1, 
𝑘
2𝐻−1
 
𝑜𝑙𝑑  and Sold should be updated. The newly generated keys (i.e.,𝑲
𝐻−1, 
𝑘
2
 
𝑛𝑒𝑤 , 𝑲
𝐻−2, 
𝑘
22
 
𝑛𝑒𝑤 ,..., 
𝑲
1, 
𝑘
2𝐻−1
 
𝑛𝑒𝑤  and Snew) are delivered to all joined UEs that own the old keys, which are 
encrypted by the old keys. BM-SC then unicasts UH,k{𝑲𝐻−1, 𝑝
2
 
𝑛𝑒𝑤 , 𝑲
𝐻−2, 
𝑝
22
 
𝑛𝑒𝑤 ,..., 𝑲
1, 
𝑝
2𝐻−1
 
𝑛𝑒𝑤  and 
S
new
} to UEk. In the example of Figure b.3, where UE8 joins the multicast group, BM-SC 
multicasts  𝑲1,2
𝑜𝑙𝑑   𝑲1,2
𝑛𝑒𝑤   to UE5, UE6 and UE7, and unicasts  𝑼3,8  𝑲2,4
𝑛𝑒𝑤 ,  𝑲1,2
𝑛𝑒𝑤 , 𝐒𝑛𝑒𝑤   to 
UE8, in order to deliver  𝑲1,2
𝑛𝑒𝑤  to UE5, UE6, UE7 and UE8. These key deliveries are 
performed at Step J3. 
 
MSK Update Procedure P3: To update S, the all KEKs and S in the key tree should be 
regenerated and unicast to all joined UEs, including S and H−1 KEKs. The key deliveries 
can be performed at Step S1. 
 
In KTS, delivery of intermediate KEKs requires multicast transmission. According to the 
UMTS KMM, KEKs may be delivered through the MTCH. Based on the UMTS MBMS standard 
[b.4], the following two implementation methods are available for KEK delivery: (i) BM-SC 
creates a new multicast group for the KEK delivery, and (ii) BM-SC multicasts KEKs through the 
network bearer of the original multicast group. In method (i), to form a new multicast group, all 
joined UEs should perform the MBMS Multicast Service Activation procedure [b.3], which 
incurs heavy signaling overhead to the UMTS network. Method (ii) is thus more practical than 
method (i). However, method (ii) consumes radio resource (carrying the multicast content) in 
delivering KEKs, thus decreasing the QoS of multicast content. Furthermore, KTS has the 
following problems. 
 
 In KTS, H + 3 keys are stored in a UE. Increasing the number of joined UEs (i.e., increasing H) 
raises the amount of storage space required, and therefore may not be practical due to the 
limited UE storage space. 
 KTS may require much extra key transmission overhead to keep the key tree balanced when 
UEs join or leave. 
 
The next section proposes the Hash Function Scheme (HFS) for KMM in UMTS MBMS by 
utilizing the one-way hash function to resolve both Issues 1 and 2 without extra storage space. 
 
 
 
 
 
54 
 
of SHA-1, as mentioned in [b.10], theoretically, it requires 280 trials using the brute-force 
method to break the full 80-step SHA-1, which is considered big overhead. In the recent studies 
[b.10][ b.16], the birthday attack and multi-collision attack were proposed to break SHA with less 
computation overhead, whose details can be found in [b.10][ b.16]. Wang et al. [b.20] reduced 
the complexity of the computation (to find a collision in SHA-1 using collision search attack) to 
269. The computation overhead is still high, i.e., up to several hours. In HFS, the one-way hash 
function h(·) is applied when only Event 1 or 3 occurs. For Events 2 and 4, HFS follows the 
standard procedures in MBMS KMM. Usually, the time interval between the occurrence of Event 
2 and the occurrence of Event 4 is shorter than one hour. In other words, before SHA-1 is broken, 
UE may retrieve new S and T from BM-SC. Thus, HFS is considered robust under birthday and 
multi-collision attacks. 
 
4. Security Analysis 
 A secured multicast mechanism should satisfy the group secrecy property [13], which 
stipulates the following requirements. 
 Nongroup confidentiality: only the joined UEs can decode the multicast content, i.e., 
nonjoined UEs cannot decode it. 
 Past confidentiality: a UE joining at time t cannot decode any multicast content before t. 
 Future confidentiality: a UE leaving at time t cannot decode any multicast content after t. 
 
This section analyzes the group secrecy property for the KMM, KMM with KTS (denoted as 
KMMKTS), and KMM with HFS (denoted as KMMHFS). 
 
As specified in [b.1], in KMM, nongroup confidentiality can be achieved by group keys S and 
T, and past and future confidentialities can be achieved via Procedures P1 and P2, respectively. 
Additionally, in [b.9], KMMKTS has been proven to be able to achieve the three confidentialities. 
In KMMHFS, Procedure P2 is the same as that in KMM, and future confidentiality can be 
achieved. In KMMHFS, we modify Procedures P1 and P3 in KMM. In KMMHFS, Procedure P1 is 
invoked to update S and T when a new UE joins the multicast group at t. Since the UE does not 
have the old T and S, it cannot decode any content multicasted before t, and past confidentiality 
holds in KMMHFS. 
 
In KMM, T is used to encode the multicast content for security protection, and S is used to 
encrypt the multicast transmission of T. The following lemma proves that HFS prevents any 
malicious UE from obtaining S and T, and therefore cannot steal the multicast content. In other 
words, KMMHFS holds nongroup confidentiality. 
 
Lemma 1 Let ti be the time when the ith event occurs during a multicast session, and S
(i)
 and T
(i)
 
denote S and T used at the ith event. Suppose that a malicious UE, UEm, starts to overhear the 
multicast information at time t' during the period between ti and ti+1, i.e., ti ≤ t' < ti+1. Then with 
KMMHFS, UEm cannot get S
(i)
 and T
(i)
. 
56 
 
experiments are executed to ensure the stability of the simulation 
 
In this study, the session time Ts of an MBMS User Service session is modeled as a widely 
used Gamma distribution with mean 
1
𝜇
 and variance vs [b.12] because Gamma distribution can 
be shaped to represent many distributions, as well as to measure data that cannot be characterized 
by a particular distribution [b.7]. Additionally, this distribution has been widely used in mobile 
network studies [b.12]. A UE may join or leave the multicast group during an MBMS User 
Service session. Assume that the UE inter-arrival time ta to an MBMS User Service session has 
Gamma distribution with mean 
1
𝜆
 and variance va. The resident time tu (when the joined UE stays 
in an MBMS User Service session) is assumed to be Gamma distributed with mean 
1
𝜂
 and 
variance 𝑣𝑢 =
1
𝛼𝜂2
, where α is the shape parameter. During an MBMS User Service session, S and 
T are periodically updated every ∆s and ∆t time units, respectively. The other notations used in 
this study include the random number N (to count the number of current joined UEs in a multicast 
group at a specific time point), the total number X of UEs that have joined the multicast group 
during the period Ts and the total number Y of UEs that have left the multicast group during the 
period Ts. 
 
This study applies videos as multicast sessions to investigate the performance of MBMS User 
Services. The average session time (
1
𝜇
) is 100 mins, and the variance of session time (vs) is 570 
min. If vs is large (e.g., vs ≥ 
1
𝜂2
), then most of generated session times are very small numbers (the 
curve of Gamma density function can be found in Figure 11 of Chapter 3 [b.7]) and not fit to 
represent the periods of movies. Therefore, a small variance is chosen to approximate the real 
world. According to Chebyshev‟s Inequality, the probability P that the session times are out of 
the range [
1
𝜇
− 𝑡,
1
𝜇
+ 𝑡] is less than 
𝑣𝑠
𝑡2
 for all t. If 
1
𝜇
 = 100 mins and vs = 570 min
2
, then P is 
less than 63.3%. The numerical results indicate that P is about 20%. Furthermore, the effects of 
1
𝜆
, 
va and 
1
𝜂
 (discussed later) are similar even for different vs. Therefore, the performance results 
specifically for Exponential session times are not presented. For the same reason, α = 4 is chosen 
for the Gamma resident time tu so that a reasonable number of UEs stay in the MBMS service 
within any time period. Anyway, it is easy to adjust these parameters to simulate different 
behaviors of MBMS services.  
 
Let ei be the number of Events i (i = 1, 2, 3 or 4) occurring in a multicast session. Let Ni,j be the 
number of joined UEs in the multicast group at the jth occurrence of Event i. As specified in [b.1], 
T and S have the same size of 128 bits. Let nu,i(Ni,j) and nm,i(Ni,j), be the numbers of unicast and 
multicast messages used to deliver S or T at the jth occurrence of Event i conditioning on there 
are Ni,j joined UEs, respectively. Let ku,i(Ni,j) and km,i(Ni,j) be the numbers of keys (T or S) carried 
in a unicast and a multicast messages at the jth occurrence of Event i conditioning on there are Ni,j 
58 
 
 
Figure b.7. The effects of 
1
λ
 on Mu, Su and Sm (
1
μ
 = 100 mins, vs = 570 min2, 
1
η
 = 60 mins, α = 4, 
∆t = 5 mins and ∆s = 20 mins ) 
 
or  
𝑆𝑚 =   𝑠𝑚 ,𝑖 𝑁𝑖 ,𝑗  
𝑒𝑖
𝑗 =1
4
𝑖=1
 
 
(2), (3) and Figure b.6 clearly indicate that Mm = Sm for each scheme, since every multicast 
message contains only one key, i.e., km,1(N1,j) = km,2(N2,j) = km,3(N3,j) = km,4(N4,j) = 1 for all j. 
Additionally, KMM and KMMHFS have the same Mm values. Based on the simulation 
experiments, the impacts of the input parameters on the output measures are elaborated as 
follows. 
 
Effects of 
1
𝜆
: Figure b.7 plots Mu, Su and Sm as functions of 
1
𝜆
 for KMM, KMMKTS and KMMHFS, 
where 
1
𝜇
 = 100 mins, vs = 570 min
2
, 
1
𝜂
 = 60 mins, α = 4, ∆t = 5 mins and ∆s = 20 mins. The 
inter-arrival time is exponentially distributed with mean 
1
𝜆
 mins. 
 
The figure shows an intuitive result that Mu, Su and Sm decrease as 
1
𝜆
 increases. A lower 
1
𝜆
 implies 
that more UEs join (i.e., a larger X), stay (i.e., a larger N) and then leave (i.e., a larger Y) the 
service. Based on Figure b.6, explicitly all of Mu, Su and Sm are decreasing functions when 
1
𝜆
 increases. 
 
Figure b.7 (a) indicates that decreasing 
1
𝜆
 significantly increases Mu of KMM and slightly 
increases Mu of KMMHFS. Decreasing 
1
𝜆
 only insignificantly affects Mu of KMMKTS. In KMM, 
BM-SC needs to unicast S to all UEs in service at Procedures P1, P2 and P3, and the effort of S 
delivery is large if the net traffic is heavy. In KMMHFS, S is delivered to all UEs at Procedure P2, 
and thus the Mu of Mu is smaller than that of KMM. In KMMKTS, only for Procedure P3, BM-SC 
60 
 
 
Effects of va: Figure 8 plot Su and Sm as functions of va for KMM, KMMHFS and KMMKTS, 
respectively. In these figures,  
1
𝜆
 = 2 mins, 
1
𝜇
 = 100 mins, vs = 570 min
2
, 
1
𝜂
 = 60 mins, α = 4, ∆t = 5 
mins and ∆s = 20 mins. Note that if the variance (va) equals to 4 min
2
, then the inter-arrival times 
form an exponential distribution, and Su and Sm for KMMHFS are smaller than those of KMMKTS, 
as revealed in Figure 7. We observe the following. 
 For va < 1 min
2
, Su and Sm are insensitive to the variance of the inter-arrival time. 
 
 For va ≥ 1 min
2
, Su and Sm are increasing functions of va. Specifically, a change in va 
significantly affects Su of KMM and KMMHFS. 
 
A large va means the system traffic becomes more bursty, that is, most inter-arrival times are 
very small, but a few of them are very large. The inter-arrival times thus diverge in a wide range. 
If the same period Ts is observed, then the number of UEs joining the service (i.e., X) for a large 
va is greater than that for a small va, and the effect of increasing va is similar to the effect of 
decreasing 
1
𝜆
. Therefore, Su and Sm increase as va increases. Specifically, if va ≥ 60 min
2
, the Su of 
KMMHFS is larger than that of KMMKTS. 
 
Effects of 
1
𝜂
 : Figure b.9 plots Su and Sm as function of the mean session holding time 
1
𝜂
 for 
KMM, KMMKTS and KMMHFS, respectively. In these figures, 
1
𝜆
 = 2 mins, va = 570 min
2
, 
1
𝜇
 = 100 
mins, vs = 570 min
2
, α = 4, ∆t = 5 mins and ∆s = 20 mins. Notably, X is fixed for every 
1
𝜂
, and the 
execution numbers of Procedures P3 and P4 are also fixed. As 
1
𝜂
 rises (i.e., the time period that a 
joined UE remains in the service rises), Y falls and N rises. Since the total traffic to the system is 
fixed, increasing 
1
𝜂
 has the following phenomena. 
 
 
Figure b.9. The effects of 
1
η
  on Su and Sm (
1
λ
 = 2 mins, va = 570 min2, 
1
μ
 = 100 mins, vs = 570 
min2, α = 4, ∆t = 5 mins and ∆s = 20 mins) 
62 
 
(i.e., Su) but increase the multicast overhead (i.e., Sm). The burst multicast overhead due to the 
key distribution of KMMKTS may result in that the QoS is not guaranteed in some period with 
very heavy traffic. Additionally, KMMKTS requires large memory in UEs. The number of group 
keys required for a service is 𝑙𝑔𝑁, and it increases as more UEs join this service, while only one 
S is stored for each service in KMM and KMMHFS. Thus, KMMKTS is more complex than the 
other two schemes. By contrast, KMM and KMMKTS are simple to implement. Compared with 
KMM, the proposed scheme KMMKTS can reduce overhead in unicast messages, and also 
provides the same QoS, because KMMKTS does not increase the multicast overhead. 
 
A、The Analytical Model 
 This section proposes an analytical model to validate the simulation model by calculating 
the number of occurrences of executions for P1 or P2 during a MBMS session. Consider the 
timing diagram in Figure 5. Suppose that the elapse time of an MBMS User Service session, Ts, is 
exponentially distributed with the density function f(t), the mean 
1
𝜇
 and Laplace transform 
𝑓 𝑠 =  
𝜇
𝜇+𝑠
 , to validate the simulation model (which is mainly used to conduct our study and is 
easily applied different distributions for the session times). 
 
1st UE 
joins
MBMS User Service Session Start MBMS User Service Session Stop
2nd UE 
joins
3rd UE 
joins
T
x-1st UE 
joins
xth UE 
joins
1st UE 
leaves
2nd UE 
leaves
x-1st UE 
leaves
utat ut
ut
ut
ut
 
Figure b.5. Timing diagram 
 
During an MBMS User Service session, when an UE joins or leaves the multicast group of this 
service at his own will, P1 or P2 is triggered. In our analytical model, the UE inter-arrival time 
for an MBMS User Service session, ta, is assumed to be exponentially distributed with the mean 
1
𝜆
. The time period that the joined UE stays in the MBMS User Service session, tu, has the density 
function fu(·), the mean 
1
𝜂
 and the Laplace transform 𝑓𝜇
∗(𝑠). 
 
Let X be the number of UEs joining the multicast group conditioning the period Ts. From [11], 
the probability that X = x during period Ts = t can be expressed as 
Pr 𝑋 = 𝑥 𝑇𝑠 = 𝑡 =
 𝜆𝑡 𝑥
𝑥!
𝑒−𝜆𝑡 . 
64 
 
 
Figure b.10. Comparison between the analytic and simulation results 
 
 
Pr 𝑡𝑢 ≥ 𝜏 =   𝜇𝑒
−𝑢𝜏𝑑𝜏𝑓𝜇  𝑡𝑢 𝑑𝑡𝑢
𝑡𝑢
𝜏
∞
𝑡𝑢 =0
=   1 − 𝑒−𝑢𝑡𝑢  𝑓𝜇  𝑡𝑢 𝑑𝑡𝑢 = 1 −
∞
𝑡𝑢 =0
 𝑓𝜇  𝑡𝑢 𝑒
−𝑢𝑡𝑢 𝑑𝑡𝑢 = 1 −
∞
𝑡𝑢 =0
𝑓𝜇
∗ 𝜇 , 
and Pr[𝑡𝑢 < 𝜏] can be calculated as𝑓𝜇
∗(𝜇). 
Thus, (5) is rewritten as 
Pr 𝑌 = 𝑦 𝑋 = 𝑥 =  
𝑥
𝑦
  𝑓𝜇
∗(𝜇) 
𝑦
 1 − 𝑓𝜇
∗(𝜇) 
𝑥−𝑦
 
 
The expected number of Y is thus expressed as 
 
𝐸 𝑌 =    𝑦 Pr 𝑌 = 𝑦 𝑋 = 𝑥 Pr⁡[𝑋 = 𝑥] 
𝑥
𝑦=1
∞
𝑥=1
=     𝑦 
𝑥
𝑦
  𝑓𝜇
∗(𝜇) 
𝑦
 1 − 𝑓𝜇
∗(𝜇) 
𝑥−𝑦
𝑥
𝑦=1
  
𝜇𝜆𝑥
 𝜇 + 𝜆 𝑥+1
  
∞
𝑥=1
.                 (7) 
 
This study takes the Gamma distribution as an example for the distribution of tu. The Gamma 
distribution with shape parameter α, with mean 
1
𝜂
 and variance  𝑣𝑢 =
1
𝛼𝜂2
 has the Laplace 
transform 𝑓𝜇
∗(𝑠) as 
 
𝑓𝜇
∗ 𝑠 =  
𝛼𝜂
𝛼𝜂 + 𝑠
 
𝛼
.                       (8) 
 
Applying (8) to (7), (7) can be written as 
66 
 
[b.16]  Nandi, M. and Stinson, D. R. Multicollision Attacks on Some Generalized Sequential 
Hash Functions. IEEE Transactions on Information Theory, 53(2):759–767, February 
2007.  
[b.17]  NIST. FIPS PUB 180-1: Secure Hash Standard. April 1995.  
[b.18]  Sun, Y., Trappe, W., and Liu, K. J. A Scalable Multicast Key Management Scheme for 
Heterogeneous Wireless Networks. IEEE/ACM Transactions on Networking, 
12(4):653–666, August 2004. 
[b.19]  Wallner, D., Harder, E., and Agee, R. Key Management for Multicast: Issues and 
Architectures. Technical Report RFC 2627, IETF, June 1999. 
[b.20]  Wang, X., Yin, Y. L., and Yu, H. Finding Collisions in the Full SHA-1. Crypto‟05, 
August 2005. 
[b.21]  Wong, C. K., Gouda, M., and Lam S. S. Secure Group Communications Using Key 
Graphs. IEEE/ACM Transactions on Networking, 8(1):16–30, Feburary 2000. 
[b.22]  Xu, W., Trappe, W., and Paul, S. Key Management for 3G MBMS Security. IEEE 
Globecom‟ 04, pages 2276–2280, December 2004. 
 
  
68 
 
delivery tree, downstream is the direction of the MBMS data flow from BM-SC to UE, and 
upstream is the direction of the MBMS signaling flow from UE to BM-SC. 
 
Two kinds of contexts are maintained for MBMS Bearer Service, i.e., MBMS UE Context 
and MBMS Bearer Context. The MBMS UE Context stores the UE-specific information, which 
is created through the MBMS Multicast Service Activation procedure [c.1]. This context is stored 
in all nodes of the delivery tree [see Fig. c.1(f)–(j)]. The MBMS Bearer Context stores MBMS 
Bearer-Service-specific information and a list of the downstream nodes. The MBMS Bearer 
Contexts [Fig. c.1(k)–(n)] specify the connectivity of the delivery tree. If this context does not 
exist when a network node creates the MBMS UE Context, the network node will also create the 
MBMS Bearer Context and notify its upstream node that it has joined the delivery tree. The 
upstream node then inserts the ID of this network node into the downstream node list of its 
MBMS Bearer Context. 
 
During MBMS content transmission, MBMS data may be lost or corrupted. The 3rd 
Generation Partnership Project (3GPP) 26.346 proposed three file repair schemes to retransmit 
the corrupted MBMS data [c.2], i.e., the Unicast File Repair (UFR) scheme, the Re-Multicast 
File Repair (RMFR) scheme, and the New Bearer Service (NBS) file repair scheme. These 
schemes introduce extra data traffic and/or signaling overheads to the UMTS network. To resolve 
this issue, we propose a new scheme called the Reuse Bearer Service (RBS) file repair scheme. 
 
This paper is organized as follows. Section 2 describes UFR, RMFR, and NBS. Section 3 
proposes the RBS scheme. Section 4 elaborates on analytic models for the three 3GPP schemes 
and the RBS scheme. Section 5 investigates the performance of the four schemes. 
 
2. Existing File Repair Schemes 
An MBMS file is divided into several file blocks. A block is identified by the Source Block 
Number and Encoding Symbol ID pair. After an MBMS file download, a UE determines whether 
the received file blocks are corrupted by cyclic redundancy check. 
 
A UE that receives Corrupted File Blocks (CFBs) is called a Corrupted UE (C-UE). When a 
CFB is detected, a C-UE sends the file repair request message to the BM-SC to indicate the 
Source Block Number and the Encoding Symbol ID of the CFB. 
 
Upon receipt of the repair request message, BM-SC retransmits the CFBs by executing one 
of the following three repair schemes proposed by 3GPP 26.346 [c.2]. 
 
 UFR: For each C-UE, BM-SC retransmits the requested CFBs. If two or more C-UEs request 
the same CFBs, then multiple copies of the CFBs are individually unicasted to these C-UEs. 
This scheme does not take the advantage of multicast, and an extra unicast traffic is required. 
RMFR: When BM-SC receives the repair request message from a C-UE, it informs UE that 
70 
 
 
Fig. c.2. CFB delivery example in RBS. 
 
received by using a timer. When the file repair message is received by the BM-SC, the timer is 
reset. After the timer expires, BM-SC recognizes that all request messages (from C-UEs) have 
been received. Then, each network node routes a CFB to its downstream node according to the 
CRT. Consider the example in Fig. c.2, where C-UE1 (in RA1), C-UE2, and C-UE3 (in RA3) 
request a CFB. RA1 and RA3 are connected to RNC1 and RNC3, respectively. RNC1 (RNC3) is  
 
served by SGSN1 (SGSN2). Both SGSN1 and SGSN2 are served by GGSN1. Thus 
 
CRTB[BM − SC] = {GGSN1 : 3} 
CRTG[GGSN1] = {SGSN1 : 1, SGSN2 : 2} 
CRTS[SGSN1] = {RA1 : 1} 
CRTS[SGSN2] = {RA3 : 2} 
CRTR[RNC1] = {C − UE1} 
CRTR[RNC3] = {C − UE2, C − UE3} 
 
where the notation “{X : k}” (X = GGSN, SGSN, or RA) means that there are k C-UEs within the 
service area of the X node. BM-SC, GGSN, and SGSN deliver the CFB to their downstream 
nodes specified in CRTB, CRTG, and CRTS, respectively. RNC transmits the CFB to the C-UEs 
specified in its CRTR. Therefore, a CFB is multicasted only to the C-UEs requesting it. The UEs 
(that correctly receive the file block) will not receive the CFB, and the retransmission scoping 
problem can be resolved. 
 
A CFB list is maintained in a C-UE‟s MBMS UE Context to store the IDs of the CFBs 
requested by this C-UE. The CFB list is created when a network node receives the repair request 
message from C-UE and is deleted when all CFBs requested by this C-UE have been transmitted. 
When a C-UE moves from the old RA to a new RA, the CRTs should be updated for correct CFB 
delivery, and the CFB list for this C-UE is referenced to determine all CRTs that should be 
updated. Consider the example in Fig. c.2 again. Suppose that C-UE1 moves from RA1 (served 
by RNC1) to RA2 (served by RNC2). The RBS scheme updates the CRTs of the CFBs requested 
by C-UE1 as follows (see Fig. c.3). 
1. CRTS[SGSN1]. RA1 is decremented by 1. RA1 is removed from CRTS if CRTS 
[SGSN1].RA1 = 0. 
72 
 
size. In the radio access network, the radio transmission cost for CFBs depends on the radio 
bearer, which is out of the scope of this paper and has been treated in our previous study. The 
output measures derived in this paper are introduced as follows: 
1) Mg: expected number of CFBs delivered from BM-SC to GGSN; 
2) Ms: expected number of CFBs delivered from GGSN to SGSNs; 
3) MR: expected number of CFBs delivered from SGSNs to RAs; 
SR: expected number of file repair request messages and file repair response messages 
delivered; 
4) Sd: expected number of signaling messages required to establish and delete the delivery tree 
for CFB delivery; 
5) Ct: net cost of CFB transmissions, where 
 
𝐶𝑡 = 𝑏 𝑀𝑔 + 𝑀𝑠 + 𝑀𝑅                                                              (1) 
 
6) Cs = SR + Sd: cost for signaling message transmissions; 
7) Cn: net repair cost, where  
 
𝐶𝑛 = 𝐶𝑡 + 𝐶𝑠 .                                                                        (2) 
 
In the remainder of this paper, we use the notations Mg,X, Ms,X, MR,X, Ct,X, Cs,X, Cn,X, SR,X, and Sd,X 
to represent the costs for schemes X=UFR, RMFR, NBS, or RBS. 
 
A. Analysis for UFR 
Suppose that the arrivals of UEs to a class i RA are a Poisson process with arrival rate λi, and the 
RA residence time for a UE in a class i RA has a general distribution with mean 1/μi. These two 
assumptions model the user mobility behavior in the UMTS network. In other words, we consider 
the effects of user mobility on the performance of file repair schemes. Then, from the M/G/∞ 
model and Little‟s law [c.9], the expected number of UEs in a class i RA is ρi = λi/μi. Consider an 
arbitrary MBMS file block. Let pi be the probability that this block is erroneously transmitted to a 
UE in a class i RA. Then, the probability that C-UE erroneously receives this block at the end of 
the rth retransmission run is 𝑝𝑖
𝑟+1. 
 
Since there are F/b blocks in an MBMS file, the expected number of CFBs after the rth 
retransmission run in a class i RA is 𝜌𝑖𝑝𝑖
𝑟+1(𝐹 𝑏). Therefore, MR,UFR is expressed as 
 
𝑀𝑅,𝑈𝐹𝑅 =   𝑛𝑖𝜌𝑖𝑝𝑖
𝑟+1(
𝐹
𝑏
)
𝑙
𝑖=1
=  
𝑛𝑖𝜌𝑖𝑝𝑖𝐹
(1 − 𝑝𝑖)𝑏
𝑙
𝑖=1
.
∞
𝑟=0
 
 
In UFR, BM-SC individually unicasts CFBs to each requesting C-UE. Therefore, Mg,UFR = 
Ms,UFR = MR,UFR, and 
74 
 
we have  
 
𝜋𝑖 𝑗 =  
𝜌𝑖
𝑗
𝑗!
 𝑒−𝜌 𝑖 .                                                               (6) 
 
Consider an arbitrary MBMS file block. Let 𝑃𝑖
(𝑟)
 be the probability that there is at least one 
UE in a class i RA, and all joined UEs in this RA correctly receive this block after the rth 
retransmission run. From (6), we have 
 
𝑃𝑖
(𝑟)
=   1 − 𝑝𝑖
𝑟+1 𝑗𝜋𝑖 𝑗 = 𝑒
−𝜌 𝑖𝑝𝑖
𝑟+1
− 𝑒−𝜌 𝑖
∞
𝑗 =1
                                  (7) 
 
where  1 − 𝑝𝑖
𝑟+1 𝑗  is the probability that there are j joined UEs in a class i RA, and all of these 
UEs correctly receive the block after the rth retransmission run. Let 𝑃𝑐 ,𝑖
(𝑟)
be the probability that 
this file block will not be transmitted to a class i RA in the r+1st retransmission run. By using (6) 
and (7), we compute 𝑃𝑐 ,𝑖
(𝑟)
 as 
 
𝑃𝑐 ,𝑖
 𝑟 = 𝜋𝑖 0 + 𝑃𝑖
 𝑟  𝑃𝑖
 𝑟 + 𝜋𝑖 0  
𝑛𝑖−1
×    𝑃𝑗
 𝑟 + 𝜋𝑗  0  
𝑛𝑗
1≤𝑗≤𝑙 ,𝑗≠𝑖
                 (8) 
= 𝑒−𝜌 𝑖 +  1 − 𝑒−𝜌 𝑖(1−𝑝𝑖
𝑟+1)   𝑒−𝜌𝑗𝑝𝑗
𝑟+1𝑛𝑗
𝑙
𝑗 =1
                                      (9) 
 
where the first term of the right-hand side of (8) is the probability that there is no joined UE in 
this class i RA. The second term is the probability that, after the rth retransmission run, this file 
block is correctly received by all UEs in class i RA, this file block is not transmitted in the other 
class i RAs, and this file block is not transmitted in class j RAs (where 𝑗 ≠ 𝑖). 
Let 𝑃𝑐 ,𝑖    
(𝑟)
be the probability that SGSN transmits this CFB to a class i RA in the r+1st 
retransmission run. From (9), 𝑃𝑐 ,𝑖    
(𝑟)
can be expressed as 
 
𝑃𝑐 ,𝑖    
(𝑟)
= 1 − 𝑃𝑐 ,𝑖
 𝑟 = 1 − 𝑒−𝜌 𝑖 −  1 − 𝑒−𝜌 𝑖(1−𝑝𝑖
𝑟+1)   𝑒−𝜌𝑗𝑝𝑗
𝑟+1𝑛𝑗
𝑙
𝑗 =1
 .               (10) 
 
Since there are F/b blocks in an MBMS file, we have 
 
76 
 
𝐶𝑠,𝑁𝐵𝑆 = 𝑆𝑅,𝑁𝐵𝑆  + 𝑆𝑑 ,𝑁𝐵𝑆 =   33
𝑙
𝑖=1
∞
𝑟=0
𝑛𝑖𝜌𝑖  1 −  1 − 𝑝𝑖
𝑟+1 
𝐹
𝑏  
= 33    
𝐹 𝑏 
𝑗
 
𝐹 𝑏 
𝑗 =1
𝑙
𝑖=1
 
𝑛𝑖𝜌𝑖 −𝑝𝑖 
𝑗
𝑝𝑖
𝑗 − 1
 . 
 
D. Analysis for RBS 
In RBS, CRT and CFB lists are created when a network node receives repair request messages 
from C-UEs. A network node only multicasts a CFB to the C-UEs listed in its CRT. Like RMFR, 
RBS does not need to create a new multicast group for CFB delivery. Consider an arbitrary 
MBMS file block. Let 𝑃𝑖 
(𝑟)
be the probability that there are more than one C-UE (receiving this 
block erroneously) in a class i RA after the rth retransmission run. Therefore, 𝑃𝑖
(𝑟) + 𝑃𝑖 
(𝑟)
+
𝜋𝑖 0 = 1. From (6) and (7), 𝑃𝑖 
(𝑟)
can be expressed as 
 
𝑃𝑖 
(𝑟)
= 1 − 𝑒−𝜌 𝑖𝑝𝑖
𝑟+1
.                                                            (16) 
 
In RBS, if there is one or more C-UEs in class i RAs after the rth retransmission run, the 
block is multicasted from the SGSN to this RA in the r+1st retransmission run. Since there are 
F/b blocks in an MBMS file, from (16), we have 
 
𝑀𝑅,𝑅𝐵𝑆 =  
𝐹
𝑏
   𝑛𝑖𝑃𝑖 
(𝑟)
𝑙
𝑖=1
∞
𝑟=0
=  
𝐹
𝑏
   𝑛𝑖  1 − 𝑒
−𝜌 𝑖𝑝𝑖
𝑟+1
 
𝑙
𝑖=1
.
∞
𝑟=0
                    (17) 
 
The derivations for Ms,RBS and Mg,RBS are similar to that for MR,RBS, and we have 
𝑀𝑠,𝑅𝐵𝑆 =  
𝐹
𝑏𝑁𝑟
   𝑛𝑖  1 − 𝑒
−𝜌 𝑖𝑝𝑖
𝑟+1𝑁𝑟 
𝑙
𝑖=1
∞
𝑟=0
                                       (18) 
𝑀𝑔 ,𝑅𝐵𝑆 =  
𝐹
𝑏
   1 −  𝑒−𝜌 𝑖𝑝𝑖
𝑟+1𝑛𝑖
𝑙
𝑖=1
 .                                          (19)
∞
𝑟=0
 
From (17)–(19), Ct,RBS can be expressed as 
 
𝐶𝑡 ,𝑅𝐵𝑆 = 𝐹   𝑛𝑖  1 − 𝑒
−𝜌 𝑖𝑝𝑖
𝑟+1
+
1 − 𝑒−𝜌 𝑖𝑝𝑖
𝑟+1𝑁𝑟
𝑁𝑟
 
𝑙
𝑖=1
+ 1 −  𝑒−𝜌 𝑖𝑝𝑖
𝑟+1𝑛𝑖
𝑙
𝑖=1
 
∞
𝑟=0
.         (20) 
 
 In RBS, SR,RBS is the same as that in UFR and is expressed in (5). In RBS, the signaling 
messages to establish and delete the delivery tree for CFB delivery are not required. Therefore, 
78 
 
follow the inequality 
Cn,RBS < Cn,NBS < Cn,RMFR < Cn,UFR. 
 
Fig. c.5. Effects of δ (F = 5000, b = 100, ρ1 = 50, ρ2 = 1, p1 = 0.05, and p2 = 0.005). 
 
This phenomenon is explained as follows. In Fig. c.5, the expected numbers of C-UEs (which is 
 𝜌𝑖𝑝𝑖
𝑟+1∞
𝑟=0 ) in a class 1 RA and a class 2 RA are about 2.5 and 0.005, respectively. Two facts 
are observed. 
 
Fact 1: In class 1 RA, more than one joined UEs are expected to erroneously receive a file 
block. Obviously, multicasting (RMFR, NBS, and RBS) is more efficient than 
unicasting (UFR). 
Fact 2: In class 2 RA, it is likely that there is no UE or at most one UE erroneously 
receiving the file block. Therefore, UFR and the proposed RBS can more efficiently 
retransmit CFB than RMFR and NBS. 
 
 We observe that Fact 1 is more significant than Fact 2 in terms of retransmission cost, and 
hence, UFR incurs the largest retransmission cost. The transmission disadvantage of UFR 
becomes more significant as δ increases. Since RMFR and NBS encounter the retransmission 
scoping problem, Fig. c.5 shows that the proposed RBS scheme outperforms RMFR and NBS. 
When δ ≤ 0.8, Cn,NBS is smaller than Cn,RMFR. When δ > 0.8, the results reverse due to the 
following facts. In NBS, all CFBs are multicasted to the new multicast group (consisting of all 
C-UEs), and RMFR multicasts all CFBs to all joined UEs. Therefore, NBS is better than RMFR 
when δ is small. On the other hand, to form a new multicast group, NBS incurs more signaling 
messages than RMFR. Since the multicast costs for both NBS and RMFR are roughly the same 
when δ is large, RMFR outperforms NBS due to the low signaling cost. 
 
B. Effects of pi 
In Fig. c.6, F = 5000, b = 100, δ = 0.4, ρ1 = 50, and ρ2 = 1. It is trivial that Cn is an increasing 
function of p2 and p1. A nontrivial observation is that when p2 < 0.05, Cn is insignificantly 
affected by p2. When p1 = 0.005, the average number of C-UEs for a file block in a class 1 RA is 
 𝜌1𝑝1
𝑟+1∞
𝑟=0 ≈ 0.25. There is at most one C-UE in a class 1 RA. Therefore, UFR and RBS are 
80 
 
 
Fig. c.7. Effects of b (F = 5000, ρ1 = 50, ρ2 = 1, δ = 0.4, 𝑝1
∗ = 0.05, and 𝑝2
∗ = 0.005). 
 
6. Conclusion 
This paper has proposed analytic and simulation models to study the MBMS file repair schemes 
in the UMTS network. The 3GPP proposed three file repair schemes, i.e., UFR, RMFR, and RBS. 
These schemes introduce extra data traffic and signaling overhead during retransmission. This 
paper has proposed a new scheme called RBS. In this scheme, a CFB is multicasted only to the 
UEs that erroneously receive the CFB, and the retransmission scoping problem is resolved.  
 
This paper has shown that when more than one joined UE erroneously receives the file 
blocks, the RMFR, NBS, and RBS schemes are more efficient than UFR. When there is at most 
one UE erroneously receiving the file block, UFR and RBS can retransmit the CFBs more 
efficiently than RMFR and NBS do. To conclude, the proposed RBS scheme can significantly 
outperform the other three 3GPP schemes. 
 
Appendix – Simulation Models 
This appendix describes the discrete event simulation model for the four file repair chemes, i.e., 
UFR scheme, RMFR scheme, NBS File Repair scheme, and RBS File Repair scheme. Denote 
RA𝑥 ,𝑦
(𝑖)
 as an RA, where i is the class type of the RA, x identifies the ID of the SGSN serving the 
RA, and y specifies the ID of the RA. We define three types of events. 
 
a. The ARRIVAL event represents a UE arrival to an RA. This event includes three fields. 
The x field identifies the SGSN serving the UE. The y field specifies the RA where the 
UE resides. The i field indicates the class of the RA. 
b. The DEPART event represents a UE departure from an RA. The event list consists of 
three fields, i.e., x, y and i, which are the same as those in the ARRIVAL event.  
c. The SESSION event represents an MBMS file multicast to the joined UEs. 
 
 Each event has a timestamp to indicate the time when this event occurs. The events are 
82 
 
 
 
Fig. c.8. Timing diagram in class i RA. 
 
 
Fig. c.9. Main flowchart of the simulation model. 
 
If event e is a DEPART event, Step 9 decreases N(e.x, e.y) by 1. Then, the simulation 
proceeds to Step 4. 
 
If event e.type is SESSION, Step 10 increases NS by 1 and generates F/b file blocks for this 
session. For each file block, Step 11 generates an erroneous file block transmission to each joined 
UE with probability pi. Step 12 executes one of the four file repair schemes to be elaborated upon 
later. Step 13 checks if NS is equal to 50 000. If so, the output measures are computed at Step 14, 
and the simulation terminates. Otherwise (i.e., NS < 50000), Step 15 generates the interarrival 
time tf for the next MBMS file transmission and the next SESSION event with timestamp ts+tf 
and inserts the generated event into the event list. Then, the simulation flow goes back to Step 4. 
84 
 
Fig. c.11. RMFR scheme. 
 
NBS Scheme: Fig. c.12 shows the pseudocodes for the NBS scheme. In this scheme, two lists 
(CRTG and CRTS) are created to count the number of SGSNs and RAs to which the CFBs are 
transmitted, respectively. The details are not elaborated upon here. 
 
 
Fig. c.12. NBS scheme. 
 
RBS Scheme: Fig. c.13 illustrates the pseudocodes for the RBS scheme. In this scheme, the lists 
CRTG(k) and CRTS(k) are created to count the number of SGSNs and RAs to which a CFB k is 
transmitted. The details are not elaborated upon here. 
 
 
Fig. c.13. RBS scheme. 
  
86 
 
（4）計畫成果自評 
本計劃執行三年，總共發表三篇 Top SCI 國際期刊論文與一篇國際會議論文： 
[J1] Lai, Y.-C., *Lin, Phone, Fang, Y., and Chen, W.-H. Channel Allocation for UMTS 
Multimedia Broadcasting and Multicasting. IEEE Transactions on Wireless Communications, 
7(11):4375-4383, November 2008. (SCI Impact Factor = 2.181, SCI Rank = 11/67, Area: 
Telecommunications) 
[J2] Cheng, S.-M., Lai, W.-R., *Lin, Phone, and Chen, K.-C. Key Management for UMTS 
MBMS. IEEE Transactions on Wireless Communications, 7(9):3619-3628, September 2008. 
(SCI Impact Factor = 2.181, SCI Rank = 11/67, Area: Telecommunications) 
[J3] Lai, Y.-C., *Lin, Phone, Lin, Y.-B., and Chang, L.-T. A File Repair Scheme for UMTS 
MBMS Service. IEEE Transactions on Vehicular Technology, 57(6):3746-3756, November 
2008. (SCI Impact Factor= 1.308, SCI Rank = 17/67, Area: Telecommunications) 
[C1] Cheng, S.-M., Lai, W.-R., and Lin, Phone. A Hash Function Scheme for Key Management in 
UMTS MBMS. Proceedings of IEEE Globecom 2007 Conference, pages 5148-5152, November 
2007. 
 
申請中專利 
 賴彥丞,張鋁淙,林風,林一平.多媒體廣播群播服務之檔案修復方法及通用移動通信系統
網路 (FILE REPAIR METHOD FOR MBMS AND UMTS NETWORK). EPC 歐洲專利. 
 賴彥丞,張鋁淙,林風,林一平.多媒體廣播群播服務之檔案修復方法及通用移動通信系統
網路 (FILE REPAIR METHOD FOR MBMS AND UMTS NETWORK).中華民國專利. 
 賴彥丞,張鋁淙,林風,林一平.多媒體廣播群播服務之檔案修復方法及通用移動通信系統
網路 (FILE REPAIR METHOD FOR MBMS AND UMTS NETWORK). 美國專利. 
 
報告 1: 參加 The 14th Asia-Pacific Conference on Communications (APCC2008) 
國際會議  
心得報告 
出席人員：國立台灣大學資訊工程學系 林風教授 
一、參與經過 
本人在 2008 年 10 月 14 日-17 日參加在日本東京秋葉原所舉辦的  The 14th 
Asia-Pacific Conference on Communications (APCC2008) 國際會議。此國際會
議為 IEICE協會主辦由美國電機工程師協會 IEEE協辦在網路通訊領域很重要
的年度盛會。除了學術的論文探討外，以及 IEICE 的重要討論亦選擇在此會
議上舉行。這是一次非常重要的國際會議。本人在此會議中主要擔任許多重要
的工作為「代表 IEEE Communications Society Asia Pacific Region 擔任
APCC2008 Best Paper Award Committee 之委員」。註: 本人為 IEEE 
Communications Society Asia Pacific Region Technical Affair Committee 之 Vice 
Chair。此次 APCC 2008 Best Paper Award 的委員包括有 Prof. Naohisa Ohta from 
KEIO University, Prof. Daehyoung Hong from Sogang Uninversity, Prof. Tomoaki 
Ohtsuki from Keo University, Prof. Iwao Sasase from Keio University, Prof. 
Masahiro Umehira from Ibaraki University, President Zhen Yang from Nanjing 
University。最後在七十多篇稿件中選取出三篇 Best Papers。 
二、與會心得 
本人此次國際會議所獲很多，除了執行以上重要的任務，本人亦第一次擔任國際
會議 Best Paper Award的Committee，親自接觸整個程序。並與多位中日韓學者
相談甚歡並做學術交流。總言之本次參加國際會議收穫甚多。 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
報告 3: Microsoft Imagine Cup 2009 World Competition 國際會議 
心得報告 
出席成員：國立台灣大學資訊工程學系 林風教授 
 
參與經過與心得 
 
 本人在 98 年 7 月 3 日-8 日參加在埃及所舉辦之 Microsoft Imagine Cup 2009 
國際會議。此會議的主要目的為 Software Design 的 Competition。由每個國家選
出一個代表隊參加。 
 
為了把創意與科技知識融合其來，讓來自世界各地的學生，運用微軟公司各
式各樣的開發工具與科技，展現其在軟體上創新的才華，並構思、測試、最後建
構成實際的應用軟體並改變世界，微軟公司舉於 2009 年舉辦 Imagine Cup 軟體
設計競賽，本次比賽主題為「夢想一個科技能解決社會難題的世界」。本屆競賽
吸引了全台各大院校的學生組隊參加，林風教授與其指導學生汪庭宇、林子圻、
王信能以及林威言所組成的 Tech-Volunteers 隊，以「TVC: Trusted Volunteer 
Community System」之創意構想平台參加了這一次的競賽，獲得台灣區冠軍的成
績。代表台灣在前往埃及開羅參加微軟 2009 Imagine Cup 世界賽。 
 
在此次 2009 Imagine Cup 世界賽中，本人所領導之團隊，在來自世界各地
67 個國家代表隊中，獲得最後世界賽前六強的成績，並且為亞洲唯一進入前六
強的隊伍。 
 
本人此次國際會議所獲良多，除了參與比賽外，亦與多國學者有所接洽。台灣團
隊的領隊為洪蘭教授。在此行中亦與洪教授相談並學習許多，增加了不少國際觀。 
 
報告2: 2009年英特爾國際科學展 (Intel International Science and Engineering 
Fair，Intel ISEF) 
心得報告 
出席人員：國立臺灣大學資訊工程學系  林 風  教授  
會議名稱：2009年美國英特爾國際科技展覽會（Intel ISEF） 
 
一、參加會議經過 
本人於 98 年 5 月 8 日-18 日參加在美國內華達州雷諾市所舉辦的 2009 年英
特爾國際科學展(Intel International Science and Engineering Fair，Intel ISEF)，此科
學展為全球規模最大的中學生國際性科學競賽，匯集來自 56 個國家、1,500 位
學生、1,225 件作品參與，一同分享其研究概念，展現優異的科學研究成果。 
     本人此次很榮幸擔任此次＂美國科展輔導教授暨特別獎評審委員＂我國代
表隊經過為期六天激烈競爭，在眾多競爭者中脫穎而出，囊括 5 項大會獎及 6
項特別獎，成果相當豐碩。 
    這次得獎學生及獎項包括：（一）國立臺中女子中學曾依晴同學以「麵包蟲
體內分離出可分解保麗龍之菌種」作品獲大會微生物學科首獎（US$5000）、大
會微生物學科一等獎（US$3000）、美國獸醫學會一等獎（US$1000）、美國微生
物學會五等獎（US$250）；Lemelson 基金會獎（US$1000），在代表團獲得 11 個
獎項中囊括 5 個獎項，屬成果最亮麗；（二）國立科學工業園區實驗高級中學江
盛浩以「逆勢求生－k 子棋和局之研究」作品獲得大會數學科二等獎（US$1500）；
（三）臺北市立建國高級中學譚文皓同學以「Anthropogenic Restoration of an 
Endangered Plant Induced the Initial Divergence of a Butterfly」作品獲大會動物學
科四等獎（US$500）；（四）國立嘉義女子高級中學林育惠同學以「來去自如的
氣體分子─氣體穿越氣泡的行為研究」作品獲大會化學科四等獎（US$500）；（五）
臺北市立第一女子高級中學史宜平同學以「人類視覺觀感之數位影像自動化版調
重製技術」獲美國計算機協會（ACM）四等獎（US$200）、聯合技術公司獎
（US$2000）；（六）臺北市立麗山高級中學李怡慧和趙予靖同學以「反射式紅外
光液晶智能窗」或專利與商標學會三等獎（US$150）。 
其中本人所參與輔導的是臺北市立第一女子高級中學史宜平同學：作品為
「人類視覺觀感之數位影像自動化版調重製技術」，此技術為將不清楚的影像透
過程式處理後呈現的更為清楚，這樣的技術更可應用在 multicasting 上。所傳送
之影像可經由 Multicast Server 端透過 multicasting 的技術傳送至手機端時，在手
機端執行此程式使影像更為清楚。此作品在這次競賽中得到獲美國計算機協會
（ACM）四等獎（US$200）、聯合技術公司獎（US$2000）。  
 
二、與會心得 
本人參與此次國際會議受益良多，覺得藉由參加國際大型會議除了可以吸收
最新的科技資訊外，更可與各國優秀人才交換心得，互相觀摩並廣泛獲得友誼，
對提升我國國際地位和建立國民外交等情事，均有正面影響與幫助。除此之外，
在此大會中觀摩到許多原創性電腦相關作品與吸收了許多電腦相關發展之資訊。 
特別一提的是，此次代表隊成果得到世界冠軍，當我國學生站在講台領獎那一剎
那，心情非常感動更感到與有榮焉，亦希望將此行的所見所聞應用在未來的相關
研究上。 
