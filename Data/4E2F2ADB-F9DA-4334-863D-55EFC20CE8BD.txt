use a personal computer to simulate a nonlinear 
problem with considerably large degrees of freedom 
(about 1 million degrees of freedom/per 3GB RAM), and 
the analysis includes static, direct integration 
time-history, and natural frequency and mode shape 
analyses. The OpenMp scheme will be used to 
parallelize the program including equation solves, 
eigenvalue solves, and element matrix calculations 
for shared-memory computers. To apply the seismic 
loading to the soil-structure interaction model is 
always a complicated issue. This project will use 
deconvolution scheme and finite element analysis to 
accurately transform the measured earthquake 
acceleration data to the mesh bottom, and the 
boundary conditions contains viscous and absorbing 
conditions. Base on this project, three journal paper 
were published, and the codes and manual of this 
program can be accessed from myweb.ncku.edu.tw/~juju.
英文關鍵詞： Earthquake； Finite element method； Natural 
frequency； OpenMP； Parallel computation； Soil-
structure interaction； Solver. 
 
 
1. 前言  
民國 88 年 921 大地震造成台灣許多房屋及橋梁倒塌，而歷年來之颱風亦造成多座
橋基傾斜、及都市淹大水。除人員生命財產之損失外，亦造成經濟上重大之損失，因此
一個準確的結構及大地力學分析方式，實有其必要性。在執行結構設計時，往往會保守
的假設許多邊界條件，因為有安全係數，使分析結果有誤差，亦可被接受。如果要預估
災害對結構及土坡之影響，則必須使用更精確的分析法，即結構分析時需要考慮土壤的
因素，甚至必須考慮水的影響，此便是土壤-結構、或土壤-結構-水互制分析。早期的發
展以線性土壤結構互制分析為主，1970 年 Richart 等人簡化了在半無限空間中剛性地基
的地基阻抗函數，並考慮了土壤特性及基礎埋置的影響 [1]。在時域方面，非線性土壤
結構的相互作用分析，2000 年 von Estorff 等人結合邊界元素和有限元素模擬土壤結構
的相互作用。結構物與土壤和在近場的建模的有限元素考慮了不均勻性和彈塑性硬化行
為的影響。模型中包含其餘的土壤區域處理邊界元素，和無窮遠的波輻射 [2]。2001 年
Ju 和 Wang 開發的有限元素法，計畫產生空間和時間依賴性的波速，超過使用希格登方
向角的單向一階邊界算子的餘弦，而且此法用來再次吸收邊界沿線以模擬無界問題的行
為 [3]。Kobayashi 等(2002) 為土壤互制模型開發出 Lattice Model。一個位於土壤表面
的地震紀錄點，當作移動控制和對分析模型輸入在 GL-52 m 伴隨著 300 Gal 的最大加速
度[4]。Casciati 和 Borja (2004)利用三維的 brick 有限元素法來模擬在時域的反應，此模
型可分辨出哪些區域可能產生應力集中和考慮在上部和本身破碎基底間的間斷性。基礎
和周圍土壤的有限元素模型和要分析的地震反應，整個系統包含動態土壤結構作用
[5]。Maheshwari 等(2004)，讓在時域的分析公式化並且研究土壤間非線性物質對地震
反應的影響。透過連續偶合增加解答計畫，已經找到系統的地震反應。假設兩個子系統
在每個階段都偶合。在有限元素公式中，HiSS 因之前提及到的可塑性土壤可被視為非
線性物質[6]。Armando Bárcena 和 Luis Esteva (2007)利用基礎法解決二維的土壤結構
互制問題，但在基礎土壤性質與結構考慮為非線性時此方法卻不盡滿意，但儘管如此，
此方法仍然被採用。在強度較高地震情形下，限制永久變形於一定範圍內，基礎土壤允
許使用線性特性來呈現真實的非線性特性[7]。H.Zolghadr Jahromi 等(2009)，假設土壤
結構偶合系統分成兩個獨立系統。在模擬系統中土壤結構偶合系統被分為土壤以及次級
結構領域[8]。Naohiro Nakamura (2009)提出將與頻率域的阻抗轉換成時間域的方法和增
加模擬的準確性。提出土壤與結構互制系統在地震反應分析利用時間域的能量傳送邊
界。因為只適用於頻率域，界限僅可適用於線性分析或等效線性分析[9]。Boris Jeremić 
等(2009)模擬不均勻土壤在時間域的土壤基礎結構互制系統。此研究採用了 Bauschinger 
的結果、Drucker-Prager 的降伏表面和完全彈性的 von Mises 降伏表面來模擬不均於土壤
在不同的土壤模型[10]。 
土木設施均座落在廣大無際的大地上，不論結構之自重、受力，或由大地傳來的地
震力，最後都在兩者互制下傳遞到大地中，因此結構與大地力學互制分析是準確分析土
木設施的基本。本計畫將整合主持人多年來在土壤-結構互制之研究，建立一個土壤-
結構-水互制之有限元素分析程式。土壤將使用 Cap‐Drucker‐Prager非線性模式，結構部
分將使用梁元素模擬，將分成鋼構及混凝土模型，並使用較容易之塑性鉸方式進行。本
程式可由 myweb.ncku.edu.tw/~juju 網址下取得。 
 
2.  地震作用下之土壤‐結構互制有限元素分析之構架 
      精確的土壤‐結構互制(SSI)有限元素方式，可執行地震作用下之分析，目前此問
題在學術上並沒有一個標準方式，亦可以說似乎沒有合理的方法，主要原因是地震
我們將使用反摺積法轉換土壤表面的加速度到網格邊界上。這項工作可使用波的傳
遞理論解，如 SHAKE91去計算，然而，對特定的有限元素網格而言，精度可能降低。
所以另一種較佳的方法是直接使用有限元素分析來解反摺積的問題，進行的程序如
下： 
(1) 於迭代次數為 k時，積分網格邊界的加速度(abot_k(t))來獲得位移，接著將位移放
到網格邊界的節點，在第一次迭代時(k=1)，(abot_k(t))是未知的，因此我們可以假
設它等於土壤表面被測得的加速度(atop_0(t))。 
(2) 進行有限元素分析來得到土壤表面的加速度(atop_k+1(t))，接著尋找轉換函數(H(f)): 
))f(a/()f(a)f(H 1k_topk_bot        
其中abot_k(f)與atop_k+1(f)是abot_k(t)與atop_k+1(t)之快速傅立葉轉換(FFT)結果，f為
頻率，  =1.0E‐7為一個非常小的值來避免數值誤差。 
(3)  求得頻域中適用於網格邊界的加速度，如下： 
)f(a)f(H)f(a 0_top1k_bot     
其中atop_0(f)  是atop_0(t)經由FFT得到的結果。 
(4) 進行abot_k+1(f)的FFT反轉換以求得時間域的結果abot_k+1(t)。 
如果abot_k+1(f)與abot_k(f)相似，則迭代收斂，且abot_k+1(f)為最適合應用在網格
邊界的加速度，若不相似，則let k=k+1  回到(1)。 
 
於第一次迭代，abot_k(t)為未知，我們使用土壤表面量測到的加速度來近似它，
因此abot_k+1(f)與abot_k(t)往往非常不同，於第二次迭代時，兩個底部加速度數據之差
異性會大大的減少，而第三次迭代的調整可以進一步產生更精確的結果，轉換函數
方程式(1)只限於在穩態條件下之FFT時間間隔，適用於線性的土壤材料，但是，對
於高度非線性的土壤行為，實際的轉換函數與時間相關，這可能會導致上述計算的
錯誤，我們將在本計畫中研究並討論這個問題。 
 
2‐3  地震時有元素在時域的分析之合理程序 
(1)   土壤自重階段的靜態限元素分析 
在這個階段，土壤自重加載在有限元素模型上，黏滯或吸收邊界法的邊界網格
設置為垂直邊界面均為滾支撐。土壤將使用 Drucker‐Prager 或 Cap‐Drucker‐Prager
非線性模式。在靜態有限元素分析上將使用 10至 20個力量間隔來模擬土壤自重階
段，然後得到一個平衡條件。如果這個問題包含結構或開挖，我們可以藉由幾個施
加的靜態分析步驟，進一步改變土壤的材料性質，及把結構物的材料特性加到網格
上。如果施工程序對自重的結果不是很敏感，或問題只是專注在地震分析上，則我
們只要執土壤結構之自重分析，而得到近似的結果。 
 
(2)   在地震搖晃階段動態的有限元素分析 
這個階段包含了地震搖動的分析，地震位移則加在網格底部各節點三個方向
上。對於黏邊界法，在自重分析上，網格上的固定邊界會改變成由隨著時間變動的
地震位移控制的邊界條件。對於吸收邊界法，這些邊界會改變成由方程式控制的吸
收邊界。Newmark直接積分法將被使用進行地震加載之歷時分析。 
 
3. 靜水之影響加入土壤-結構-互制之時域有限元素分析 
    水會影響土壤-結構之力學行為，例如水庫中之水，及地下水對土壤均有相當程度
之影響，本節討論固體外靜水之問題，此部分已發表於 SCI期刊論文上[14]。為了將
計之步驟: 
(1) 重編節點以獲得勁度矩陣的最小帶寬。在這項研究中，將使用 reverse 
Cuthill-McKee method 進行研究。 
(2) 求得勁度矩陣的指標數陣列 LL 及 LLL。 
(3) 設 i=1，然後在 1到 KL(i)個自由度內選擇第一個區塊，其中 KL(i)為區塊 i的最
大自由度，且第一區塊的 KL(1)可從輸入獲得。 
(4) 設 i=i+1，來找下一個區塊，其自由度(DOF)是在 KL(i-1)+1 到 KL(i)之間，其中 i
為當前區塊數。KL(i)是從最大的 DOF 到 KL(i) DOF，一直到 KL(i) DOF 中的 LLL(1)
小於或等於 KL(i-1)。 
(5) 為求出下一個區塊而轉到步驟（4），直到沒有找出任何區塊，此時，餘下的 DOF
將成為最後一個區塊（定義為 nKLth區塊）。 
(6) 由於我們需要增加 A 部份的 MA以獲得一個更有效的 PCG 解，故一些以奇數區塊開
頭的成功的區塊將被組合成一個新的奇數區塊。最後，將該區塊總數命名為 nKLN。 
(7) 順序對在奇區塊數的區域裡的節點作重新編號，於偶區塊數的區域亦然。 
(8) 根據在步驟（7）的節點排列來求 LL 和 LLL。 
 
對於上述程序，步驟 1 和 2 是在傳統的有限元素法裡必須執行的。第 2 步完成後則
可繼而完成步驟 3到 8，而這些程序也只需用到指數陣列 LL 和 LLL。平行運算的條件將
解釋如下： 
 
對於矩陣乘法和分解： 
(1) A 部份的區塊能夠完全平行。 
(2) 在 A部份的區塊完成後，B部份帶奇數或偶數的區塊能夠各自完全平行。我們可先
處理奇數區塊再到偶數區塊。 
 
對於往前替代： 
(1) A 部份的區塊能夠完全平行。 
(2) 在 A部份的區塊完成後，B部份的區塊能夠完全平行。 
 
對於往後替代： 
(1) B 部份帶奇數或偶數的區塊能夠完全平行。我們可先處理奇數區塊再到偶數區塊。 
(2) 在 B部份的區塊完成後，A部份的區塊能夠完全平行。 
  根據上述解釋，我們將使用 OpenMP 的程式碼去執行平行運算。此程式很簡單，故
這樣的平行運算程序幾乎跟傳統非平行程序一樣，本部分之應用及程式使用方法已法表
於[15]。 
 
Part A
Part B
Part B
Part B
MA
MB
 
 1
出席第五屆 ISEV2011 國際環境振動研討會議心得報告 
                                            100 年 11 月 11 日 
報告人姓名 朱聖浩 服務機構 成功大學土木系 職稱 教授 
中文：第五屆國際環境振動研討會議  
會議正式名稱 
英文：5th International Symposium on Environmental Vibration: 
Prediction, Monitoring and Evaluation 
會 議 時 間       自 98 年 10 月 19 日至 
98 年 10 月 23 日 
地點（國、城市） 中國大陸成都市 
 
 
一、 前言 
 
本次獲准出國參加第五屆國際環境振動研討會議(5th International Symposium on 
Environmental Vibration: Prediction, Monitoring and Evaluation)，本屆研討會
會議地點為中國大陸成都市西南交通大學舉行，會議時間為西元 2011 年 10 月
19 日至 10 月 23 日，筆者除參加第五屆國際環境振動研討會議外，並發表論文。
發表論文之題目為 Behavior of high-speed trains moving on bridges during 
earthquakes，下圖為筆者發表論文時之照片。 
 
 
國科會補助計畫衍生研發成果推廣資料表
日期:2012/11/04
國科會補助計畫
計畫名稱: 土壤-結構-靜水互制之時域平行有限元素程式之建立
計畫主持人: 朱聖浩
計畫編號: 100-2221-E-006-183- 學門領域: 結構應力
無研發成果推廣資料
meshless 
analyses＇, 
accepted by 
Engineering 
Computations. 
 
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100%  
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
其他成果 
(無法以量化表達之
成果如辦理學術活
動、獲得獎項、重要
國際合作、研究成果
國際影響力及其他協
助產業技術發展之具
體效益事項等，請以
文字敘述填列。) 
與本計畫相關之期刊論文共發表三篇[11,14,15]，程式及手冊則可由
myweb.ncku.edu.tw/~juju 網址取得。 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
