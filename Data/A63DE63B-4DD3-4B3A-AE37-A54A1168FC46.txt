1 
行政院國家科學委員會補助專題研究計畫成果報告 
藥品檢驗之機器視覺系統(I) 
 
計畫類別：■個別型計畫  □整合型計畫 
計畫編號：NSC 100-2221-E-214-031 
執行期間：100 年 8 月 1 日 至 101 年 7 月 31 日 
 
 
計畫主持人：吳文言 
共同主持人： 
計畫參與人員： 
 
執行單位：義守大學 
 
 
中  華  民  國  1 0 1   年  7   月  3 1   日 
3 
一、 前言 
根據經濟部統計資料指出我國藥品醫療製造產值逐年走高且增幅優於整體製造業，而且
比較不受到景氣影響(經濟部產業經濟統計簡訊, 2010)。另據工研院 IT IS 季報指出，國內製
藥產業 2010 全年產值預期將有 679.5 億元，年增 8.5%，年增率較製造業為高，因此製藥產業
實是台灣一項重要的產業。以台灣之製藥產業來說，具有品管能力、人才、國際合作經驗、
獎勵政策、IP 保護、技術創新及基礎環境優良等優勢。 
傳統上，對於藥品的外觀檢驗，通常採用抽驗來監控產品品質，並由操作員以目視檢驗
為主。現今醫學的進展, 所需藥品生產的市場大幅成長，由於藥品的種類繁多, 在生產的各個
階段，都可能發生瑕疵問題，但由於生產數量龐大，使產品的檢驗方式更加困難。因此若能
在藥品製造之檢驗工作配合自動化趨勢，期望有助於提升藥品製造業者的產品品質。近年來
在藥品外觀檢驗利用機器視覺技術之研究工作敘述如下:  
1. 藥品膠囊檢驗：Islam et. al. 利用影像處理技術從事藥品膠囊(capsule)檢驗, 所採用的影像
特徵為膠囊影像邊緣, 並求一逼近的圓形以判斷是否符合規格, 共測試 1,000 藥品膠囊, 
結果有 95%的檢驗正確率(Islam et. al. 2008) 。Ge et. al. 利用影像二值化找出膠囊影像, 並
用數學形態學(morphology)以消除雜訊, 最後使用支援向量機(support vector machine , 
SVM)配合 4 種特徵值來分析膠囊影像, 以偵測可能之瑕疵,其測試 15,460 個膠囊影像, 正
確檢驗率為 94.1% (Ge et. al. 2009) 。Spiclin et. al.從事藥品膠囊印字檢驗, 首先利用影像轉
換方面消除取得影像扭曲的問題, 接著利用樣板比對以找出膠囊印字所在區域, 最後判斷
印字是否有偏移或缺少等瑕疵, 由於印字體及其可能瑕疵較小, 因此需應用次像素解析度
(Spiclin et. al. 2010) 。 
2. 泡罩與藥片檢驗：Derganc et. al. 提出利用影像彩色資訊配合訓練之樣本影像, 用以檢驗泡
罩(blister)中彩色藥片, 可檢驗之瑕疵為缺少藥片, 破損, 破碎, 及個別藥片之色彩, 大小, 
形狀檢查(Derganc et. al. 2003)。Zhao and Li 應用二值化方法將泡罩包裝後藥片(tablet)所在
區域分割出來, 並求出其邊緣, 接著利用複利葉運算子(Fourier descriptor)萃取其特徵值, 
並用支援向量機(SVM)檢驗藥片在泡罩包裝後缺少或破裂等瑕疵(Zhou et. al. 2008) 。 
3. 藥片壓印字檢驗：Spiclin et. al.提出一套方法,利用結合直接比對(direct matching), 主軸比
對(principal axis matching), 圓形輪廓比對(circular profile matching)方法,以分類並檢驗壓印
字體的藥片之正確性 (Spiclin et. al. 2007) 。Bukovec et. al. 提出幾何方法與統計方法兩種
方法 , 分別配合先前資訊 (a priori knowledge) 用以檢驗壓印 (imprinted) 與未壓印
(non-imprinted)藥片,測試 4 種共 3,445 壓印藥片之實驗結果發現統計方法配合先前資訊之
方法, 較能有效偵測出藥片瑕疵 (Bukovec et. al. 2007)。 
4. 藥品顆粒檢驗：Mozina et. al. 分析影響藥品顆粒(pellet)檢驗的重要因素, 為照明, 光學與
鏡頭, 樣本, 機構設計, 軟體等, 設計一方法檢視這些要因, 並估計所需的 4 項重要特徵值, 
以決定檢驗的藥品顆粒是否符合規格(Mozina et. al. 2009a)。Mozina et. al. 認為在藥片外觀
檢驗上最重的問題是如何正確地將影像分割藥片與背景區域, 因此提出一輪廓追蹤方法
將影像有效地分割藥片與背景區域(Mozina et. al. 2009b)。Mozina et. al. 使用視覺影像技術
作為製程分析技術(process analytical technology)工具以監控線上藥粒塗層作業(pellet 
coating process)(Mozina et. al. 2010)。 
5. 注射液檢驗：Zhou et. al. 以機器視覺技術從事注射液的檢驗工作 , 利用二階差分
5 
(1) 影像輸入： 
一般工業上常使用 CCD 來取像，取像環境的優劣，往往影響 CCD 所取得之影像品質，
故取像環境必須加以控制，否則會對檢驗的工作產生重大困難。另外光源的選擇也是需要考
慮，不同發光源能凸顯不同物體的特徵，用對光源來照射檢驗物，將會增加 CCD 所取得之影
像品質，有助於檢驗工作的進行(徐正聲&江行全 1998)。由於藥品本身為立體物體，並非為一
平面，所以在照明上不易控制使得光線分佈都非常均勻，故本研究將針對不同的藥品特性及
檢驗特性採用適當的照明方法，如背面照明，前置照明，或兩階段照明等。 
 
 (2) 影像前處理： 
影像在取得的過程中常受外在環境因素干擾，或取像設備不佳，導致影像出現雜訊，影響
影像的可用性。在影像處理中，多使用濾波來降低雜訊對影像的干擾和去除，當中以高通濾
波、中通濾波、低通濾波、均化濾波等較常使用，也都有不錯的效果。雖然濾波具有良好的
抑制雜訊效果，但卻會導致主體影像失真許多，故使用時要根據目標物的特性來做選擇，像
是藥品影像中的雜訊，就非常適合使用中通濾波來抑制雜訊，因為它能有效保留藥品影像中
的文字並有效消除雜訊。為了凸顯出影像中所需要的資訊，區別出影像的背景與欲檢驗物，
ㄧ般常用二值化的方法，所謂影像二值化是給定一閾值，與待測物影像的灰階值相比較，待
測物影像灰階值小於閾值時，則將此灰階值改變為 0，也就是黑色，反之要是灰階值大於閾
值時改變為 255，為白色。本研究將以前一年研究計畫所發展的影像前處理方法，針對不同
的藥品特徵採用適當的處理方法，如灰階直方圖等，以得到藥品表面中的字元影像資訊。此
方法能快速有效地將藥品影像分離出來，有利接下來的處理步驟。 
 
(3) 影像定位： 
    為了取到影像中特徵的相關資訊與位置，可利用累積投射的方法，此法能有效區別出影
像中字元的位置與其相對應的座標值，並框選出其所在範圍和大小，進而分割出所需之字元
範圍，故在藥品影像中，若欲取得影像中字元之所在位置，便可使用此方法。投射原理為於
影像中，分別對影像的 X-Y 軸做投射，再分別將 X-Y 軸的物體像素點作累加和統計分布，所
構成的 X-Y 累計直方圖，藉此方式可以正確地對影像中各字元框出其所在區域和對應的座標
軸位置，並有效區別出其相關特徵值。藉由 Y 軸投射與 X 軸反覆投射結果，依次取得影像中
的字元位置，並分割影像中的每個字元所在位置。此影像定位與分割方法可以有效地將個別
藥品及字元分離出來，以利後續的影像分析工作。 
 
三、 結果與討論 
本研究主要是發展藥品自動化視覺檢驗方法之前處理方法，透過控制取像光源與影像處理的
步驟，處理藥品影像，以利後續瑕疵偵測與分類。在藥錠上，利用背面打光方式取得藥錠之
影像，並利用灰階影像直方分解，藥錠所在位置找出來，測試 500 張影像，發現此方法可以
得到 100%的偵測率。其次，對於藥品標籤方面，利用前置照明方法，取得標籤影像，並利用
x-y 方向灰階累積分配方法，得到影像方位資訊，以做為後續判斷標籤印刷字，正確與否的基
礎。在藥品標籤的實驗部分，採用 500 張影像，正確判斷率為 95％，主要錯誤判斷的原因為
標籤反光造成字體扭曲。 
 
7 
 
四、計畫成果自評 
 
本年計畫為多年期第一年主要是發展藥品自動化檢驗之影像前處理方法，再次計畫中完成藥
品多項檢驗項目之前處理方法，可供後續建一步檢驗用。在此計畫階段中已完成預期所欲達
成的目標。研究成果可廣泛用於藥品外觀之前處理方法，具有學術上之價值及實際應用之可
能，研究成果可以發表於學術研討會，並可進一步投稿學術期刊。 
由於班機關係，提早到北京，因此就參加主辦單位安排在會議前一天的 2場Workshop, 綜
觀本次會議即有來自約 10 個國家，約有 959 篇論文發表，主要作者約 2,465 人次。每天下午
時段各安排 2 場，共有 6 個論文場次發表。論文發表同一時段約有 11 場次同時舉行，每個
場次約有 6 篇論文發表，一般論文共有約 66 場次。此外，會議前一天安排 5 場 Workshop, 3
天會議期間於早上時間安排共 7 場專題演講。由這些論文場次主題，可以瞭解在智能控制與
自動化研究方面，範圍非常廣，參與的研究人員分佈在許多的領域。 
 
二、 與會心得 
WCICA 2012 是 IEEE 支持每兩年舉辦一次的重要會議，自 1993 起舉辦各吸引許多論文投
稿，本次會議即有共 959 篇論文接受發表，會前一天(July 5)並舉辦 5 場 Workshop，即顯得此會
議其重要性。近幾年大陸非常積極舉辦各項國際研討會，藉此機會與國際學術交流，此外，亦
可以增加其學術發表能力。在此次會議中即可以看到許多大陸方面的學者與會。此次會議除主
辦國大陸有相當多的論文發表外，來自全球的論文亦相當多。藉由參與此會議可以瞭解全球關
於智能控制與自動化研究的最新發展趨勢，亦可以由此找尋新的研究方向與題目，因此獲益良
多。 
 
三、 考察參觀活動(無是項活動者省略) 
  無 
 
四、 建議 
       希望能多鼓勵與獎助國內學者與學生參與國際會議，以開展國際視野，並能掌握世界發展趨
勢。由於舉辦地點的關係，在此次研討會中有許多來自大陸的論文發表，可見參與國際性研討會
除了個別學者參與外，若能對於一些重要的研討會，提供額外的資源，以整合國內學者長期積極
參與，相信可以得到比較具體的影響力。 
 
五、 攜回資料名稱及內容 
1. WCICA 2012 大會手冊：議程簡介與發表論文場地 
2. WCICA 2012 光碟論文集：包含本次會議所有發表論文全文電子檔 
3. Call for papers: International Journal of Automation & Computing 
4. Call for papers: ACTA Automatica Sinica 
5. Call for papers: The IASTED International Conference on Engineering and Applied Science (EAS 
2012), December 27-29, 2012, Colombo, Sri Lanka 
6. Call for papers: 2012 IEEE International Conference on Robotics and Biomimetics, December 11-14, 
2012, Guangzhou, China 
7. Call for papers: 2013 ACC, June 17-19, 2013, Washington, DC, USA 
8. Call for papers: The 32nd Chinese Control Conference (CCC’ 2013), July 26-28, 2013, Xi’an China 
9. Call for papers: 3rd IFAC International Conference on Intelligent Control and Automation Science 
(ICONS 2013), September 2-4, 2013, Chengdu, China 
10. Call for papers: 10th IEEE International Conference on Control & Automation, June 12-14, 2013, 
Hangzhou, China 
國科會補助計畫衍生研發成果推廣資料表
日期:2012/09/28
國科會補助計畫
計畫名稱: 藥品檢驗之機器視覺系統(I)
計畫主持人: 吳文言
計畫編號: 100-2221-E-214-031- 學門領域: 生產系統規劃與管制
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
無 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
