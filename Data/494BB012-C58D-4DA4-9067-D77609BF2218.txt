 2
增加處理上的複雜度，壓縮率降低，更會導致後續電腦視覺辨識處理的誤判，更甚者會導致
整個數位監錄系統(DVR)的監錄失真與不安全。因此，本計畫提出一種應用於 DVR 系統在昏
暗環境中增強移動體影像顯示的方法，主要原理是先分析畫面的像素特性，將影像像素分為
四種類型，個別對這四種像素採用不同的雜訊衰減方法。接者建立一張參考的絕對背景以粗
略切割出移動物體，再利用連通標籤的方式，將物體分析出來;最後利用對比度增強的方式，
將色彩影像補強與清晰化，諸如人臉。如此可以有效的將昏暗不清的移動物體，較清楚的顯
示出來，因此本計畫研發成果應用於數位監錄系統前端畫面處理，可有效增強昏暗環境中之
視訊畫面品質，以利後續監錄資訊處理，並可應用在機關大樓、社區、道路交通等攝影監控
系統中而提升監錄畫面品質(特別在夜間)，在產品實質貢獻方面，並可提昇企業 DVR 產品之
附加價值，及強化其國際競爭力。 
 
[人才培育成果說明] 
    本計畫不僅能幫助產業產品及技術的發展，也在人才培訓方面有所助益，參與此計畫之
工作人員可充分熟悉影像 /視訊處理的相關技術暨知識，且可將課堂所學的影像處理 
（Image/Video Processing）及移動物偵測暨增強（Motion Estimation & Enhancement）相關理
論，驗證於實作作品，並從中學習到問題的分析與解決的能力，進而可獲得寶貴的影像處理
實務經驗，對於投入相關產業之研發或繼續深造都有相當大的幫助。藉此計畫之執行，公司
將可培訓出一個熟悉電腦視覺處理及移動物偵測暨增強技術之團隊。 
 
[技術研發成果說明] 
    本計畫使用 CCD 攝影機拍攝一些實驗視訊樣本，並以人眼主觀標準來評估本計畫影像
增強方法及使用壓縮改善率來評估雜訊濾除方法，壓縮改善率則如公式(1)表示。 
100%(%) compressed compressed
compressed
PVOV
CR IR OV
−
×− =
                      (1) 
OVcompressed 指的是原始視訊經壓縮後的檔案大小，而 PVcompressed 表示原始視訊先經過雜訊濾除
程序，再做視訊壓縮後的檔案大小。得到的視訊壓縮比較結果如表 1 所示，圖 1 及圖 2 則為
實驗視訊樣本移動物切割暨增強之後的結果。 
 
表1. 視訊樣本規格及壓縮改善率 
Video file dpi form Total number of frames CR_IR(%) 
Video1 640x480 AVI 150 87.83% 
Video2 720x480 AVI 286 88.73% 
 
     
         (a)Video1              (b)Video1 處理後之結果 
  圖 1. 實驗視訊樣本 Video1 
 4
 
2、像素分類與雜訊濾除 
先分析畫面的像素特性，將影像像素分為四種類型，如表 2 所示，再分別對這四種像素
採用不同的雜訊衰減方法，如下圖 4 所示。 
 
表 2. 像素分類 
類   型 說   明 
(1) 靜止像素(static pixel) 指相鄰畫面之間，相同位置的像素值變化微弱。 
(2) 平滑移動像素 (dynamic pixel at edge) 
相同資訊像素在相鄰畫面之間的位置不一樣，故
稱其為移動像素，此移動像素是位於畫面的平滑
區。 
(3) 邊緣移動像素 (dynamic pixel at flat) 移動像素位於影像中的邊緣處。 
(4) 強烈且孤立的雜訊 (strong and isolated noise) 
經過像素分類偵測過程後，由於孤立的像素不能
算是移動物身上的一部分，所以稱其為強烈雜
訊。 
 
 
 
圖 4. 像素分類與雜訊濾除流程圖 
 
2.1、靜止像素雜訊衰減 (Noise Reduction for Static Pixels) 
影像/是訊中的靜止像素，其意味著在上一張畫面與目前畫面之相同位置像素，並沒有多
大的變化。因此，可利用影像疊合概念，將不同畫面之相同位置的靜止像素相累加，然後計
算平均值，把平均值視為雜訊衰減結果。假設從畫面 t-a 開始，一直到目前畫面 t，座標(p,q)
像素都判斷為靜止像素，則目前畫面座標(p,q)像素的時間域雜訊衰減輸出公式如下所示： 
 
 6
1
1
_ _ ( , , )
rgb
n
rgbn p
noise output frame x y t xp
=
= ∑
         (5) 
其中 noise_output_framergb(x,y,t)為強烈且孤立雜訊的輸出結果。 
相反的，若強烈且孤立雜訊位於影像/視訊邊緣部分，則計算所有非雜訊像素的亮度值，把每
個亮度值與強烈且孤立雜訊的亮度值相減，找出差距最小的非雜訊像素，然後將此像素取代
掉中心點，即視為輸出。 
 
2.5、濾波後級處理 (Post-Processing for Filtering) 
此步驟主要是對濾波後的影像進行最後檢查的一道程序，偵測影像/視訊中是否還殘留著
尚未被檢測出來的雜訊。因為目的在於些微修補濾波效果，因此，僅挑出與周圍鄰居像素差
異頗大的像素，然後利用數個鄰居像素計算平均值以進行取代，以下是詳細步驟流程說明。 
步驟 1：以一個 3x3 大小的遮罩掃描整張影像，計算中心點與 8 個鄰居像素的亮度絕對差值，
如果 8 個差值都超過臨界值 Thd，則標記中心點像素為觀察候選點。 
步驟 2：以一個 3x3 大小的遮罩掃描整張影像/視訊，如果只有中心點為觀察候選點，而 8 個
鄰居皆非觀察候選點的話，則將中心點的上、下、左與右等四個鄰居像素累加起來計算平均
值，取代中心點像素。 
 
3、移動物體偵測與切割 
為了觀察夜間雜訊及移動物的變化，本計畫選擇使用光流法(Optical Flow)來偵測出像素
間的變化，根據光流場的分析，若是移動向量(motion vector)介於 0~1 間，表示為一個極小的
運動，因此若是移動向量大於 1 表示為一個極大的運動。透過這樣子的觀察，可以將像素分
成背景像素(background pixel)及移動像素(motion pixel)，其中背景像素是指相鄰畫面中，相同
位置向量長度小於 1 的像素，而移動像素是指相鄰畫面，相同位置向量長度大於 1 的像素。
詳細像素分類說明如下表 3。 
表3. 像素分類 
類型 說明 
背景像素(background pixel) 指相鄰畫面，相同位置向量長度小於 1。 
移動像素(motion pixel) 指相鄰畫面，相同位置向量長度大於 1。 
 
3.1、移動偵測方法分析 
目前的移動偵測方法主要可略為下，目前移動物偵測的方法主要可略分為：（1）背景相
減法（2）相鄰影像差法（3）方塊比對法（4）光流法。本計畫利用畫面與畫面之間建立光流
場，並從光流場的分佈圖中看出光流變化，就是對同一個移動物體在不同畫面像素間的位移，
也就是說光流場反映了影像上每一個像素的變化趨勢，適合觀察夜間雜訊及移動物的變化。 
 
3.2、移動物切割 
本計畫提出一個有效的移動偵測方法，首先找出所有移動向量座標的中心點，緊接者，
再使用移動模板(motion template)的概念框出移動的物體，昏暗環境下移動物偵測演算法流程
如下圖 5。 
 8
其中， [ ]BFed pframe I 為雙邊濾波器過後的影像， ( )SG p qσ − 為一個空間域高斯平滑函數，其定
義為中心點像素與鄰居像素的距離權重值。 ( )
r
G I Ip qσ − 為一個強度域的高斯平滑函數，指的
是中心點像素與鄰居像素其像素值的相似程度。 sσ 為一個高斯函數的 sigma 值， rσ 為一個
正規化過後擴展值，介於 0~1 之間，參數的大小決定函數的展開程度。 
在得到雙邊濾波器過的粗略影像後，再透過下列公式(8)，將分離出來的移動物體除以經
過雙邊濾波器後的粗略影像，就能夠得到細節影像。 
 
MObject
detail
BFed
frameframe frame=                        (8) 
 
其中， detailframe 為細節影像， MObjectframe 為移動物體影像，為 BFedframe 經過雙邊濾波器
後的影像。 
 
圖 6. 增強方法流程圖 
 
 
4.3、移動物增強方法 
本計畫使用 Retinex 方法針對粗略細節做影像增強，Retinex 具有良好的處理效果，其中，
Retinex 理論主要包含了兩個方面的內容：1.物體的顏色是由物體對長波、中波和短波光線的
反射能力決定的，而不是由反射光強度的絕對值決定的；2.物體的色彩不受光照非均性的影
響，具有一致性。在 Retinex 方法中，最簡單的即是單一規模的高斯函數，稱為 Single Scale 
Retinex (SSR)，此作法只需考慮周圍的八個點的像素值，或是以等比例的框架大小(Mask)，
公式如下所示： 
( , ) log ( , ) log[ ( , ) ( , )]
retinex BFed BFedframe x y frame x y G x y frame x y= − ∗      (9) 
 10
計畫查核點說明 
重要工作項目
 
查核內容概述（力求量化表示）
 
廠商參與情形概述
 
1-4月 5-8月 9-12月 1-4月 5-8月 9-12月 
A視訊樣本擷
取
 
進行實驗畫面與視訊影片的搜集與分
類。
 
提供攝影器材與保養器材。
 
A1樣本分析 樣本分析進度達到70% 
樣本分析進
度達到90% 
樣本分析進
度達到100% 
樣本需求調
整
 
樣本需求調
整
 
樣本需求調
整
 
A2樣本擷取 樣本擷取進度達到60% 
樣本擷取進
度達到85% 
樣本擷取進
度達到100% 
提供攝影器
材
 
提供攝影器
材
 
提供攝影器
材
 
B演算法推導 制定昏暗視訊畫面增強方法之整體演算流程。
 
協助判斷演算法之可行性。
 
B1 複雜度分
析暨運算
 
複雜度分析暨
運算達到50% 
複雜度分析
暨運算達到
80% 
複雜度分析
暨運算達到
100 
協助複雜度
分析暨運算
 
協助複雜度
分析暨運算
 
協助複雜度
分析暨運算
 
B2 雜訊偵測
暨分析
 
雜訊偵測暨分
析達到50% 
雜訊偵測暨
分 析 達 到
80% 
雜訊偵測暨
分 析 達 到
100% 
提供相關技
術及器材協
助
 
提供相關技
術及器材協
助 
提供相關技
術及器材協
助 
B3雜訊濾波 雜訊濾波達到30% 
雜訊濾波達
到60% 
雜訊濾波達
到100% 
提供相關技
術及器材協
助 
提供相關技
術及器材協
助 
提供相關技
術及器材協
助 
B4 移動物體
偵測暨切割
 
移動物體偵測
暨 切 割 達 到
20% 
移動物體偵
測暨切割達
到50% 
移動物體偵
測暨切割達
到100% 
提供相關技
術及器材協
助 
提供相關技
術及器材協
助 
提供相關技
術及器材協
助 
B5 移動物體
增強
 
移動物體增強
達到20% 
移動物體增
強達到50% 
移動物體增
強達到100% 
提供相關技
術及器材協
助 
提供相關技
術及器材協
助 
提供相關技
術及器材協
助 
C系統整合 演算法程式撰寫並整合至廠商系統中 程式相容性判斷與最佳化 
C1程式撰寫 程式撰寫達到30% 
程式撰寫達
到60% 
程式撰寫達
到100% 
程式相容性
判斷
 
程式相容性
判斷
 
程式相容性
判斷
 
C2介面開發 介面開發達到30% 
介面開發達
到60% 
介面開發達
到100% 
介面相容性
判斷
 
介面相容性
判斷
 
介面相容性
判斷
 
C3程式整合 程式整合達到20% 
程式整合達
到50% 
程式整合達
到100% 程式最佳化 程式最佳化 程式最佳化 
D結案報告 結案報告整理與撰寫 協助結案報告整理 
D1 結案報告
撰寫
 
結案報告撰寫
達到10% 
結案報告撰
寫達到60% 
結案報告撰
寫達到100% 
協助結案報
告整理
 
協助結案報
告整理
 
協助結案報
告整理
 
 
98年度專題研究計畫研究成果彙整表 
計畫主持人：陳昭和 計畫編號：98-2622-E-151-009-CC3 
計畫名稱：應用於 DVR 系統在昏暗環境中之視訊畫面增強技術 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 0%  
研究報告/技術報告 1 1 100%  
研討會論文 2 2 100% 
篇 
 
論文著作 
專書 0 0 0%   
申請中件數 1 1 100%  專利 已獲得件數 0 1 0% 件  
件數 1 1 100% 件  
技術移轉 
權利金 71 71 100% 千元  
碩士生 5 5 100%  
博士生 1 2 50%  
博士後研究員 0 0 0%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 0% 
人次 
 
期刊論文 0 1 0%  
研究報告/技術報告 0 0 0%  
研討會論文 1 2 50% 
篇 
 
論文著作 
專書 0 0 0% 章/本  
申請中件數 1 1 100%  專利 已獲得件數 0 1 0% 件  
件數 0 0 0% 件  
技術移轉 
權利金 0 0 0% 千元  
碩士生 0 0 0%  
博士生 0 0 0%  
博士後研究員 0 0 0%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 0% 
人次 
 
 
