 
 
 
 
2
應用智慧型控制於非線性雙旋轉翼多輸入多輸出系統之研究(III) 
 
計畫編號：NSC 95-2221-E-019-054- 
執行期間：95年8月1日至96年7月31日 
計畫主持人：莊季高  國立臺灣海洋大學 通訊與導航工程學系 
 
Abstract—This project proposes a fuzzy switching grey 
prediction PID controller to an experimental propeller setup 
which is called the twin rotor multi-input multi-output 
system (TRMS). The goal of this study is to stabilize the 
TRMS in significant cross coupling conditions and to 
experiment with set-point control and trajectory tracking. 
The proposed scheme enhances the grey prediction method 
of difference equations, which is a single variable second 
order grey model (DGM(2,1) model). It is performed by a 
real-valued genetic algorithm (RGA) with a system 
performance index as fitness function. We apply the integral 
of time multiplied by the square error criterion (ITSE) to 
form a suitable fitness function in RGA. Simulation results 
show that the proposed design can successfully adapt to 
system nonlinearity and complex coupling conditions. 
Computer simulations show that the proposed approach has 
better performance than pervious works. For real time 
control, Xilinx Spartan II SP200 FPGA is employed to 
construct a hardware-in-the-loop system. 
1. INTRODUCTION 
Fuzzy set theory was first introduced to public by Zadeh in 
1965 [1] in the hope to handle the imprecise information in 
the real world. Zhang [2] optimized the input/output 
membership functions for a nonlinear dynamic system by 
Extended Kalman Filter. Lu [3] used the genetic algorithm 
to tune the membership functions of a fuzzy controller for 
smart structure systems with the requirement of vibration 
control. It is independent of the expert’s knowledge, to 
adjust  parameters of fuzzy controller to improve the 
performance. In this paper, a switching mechanism is built 
by a fuzzy inference system to produce an appropriate 
forecasting step-size. A randomly chosen parameter set may 
always result in a poor performance. To provide a more 
efficient methodology to adjust the fuzzy set parameters, the 
genetic algorithms are thus considered. 
Genetic algorithm (GA) was first proposed by Holland in 
1975 [4]. It is an optimization technique based on simulating 
the phenomena that takes place in the evolution of species 
and is adapted to an optimization problem. This technique 
implies the laws of natural selection onto the population to 
achieve individuals that are better adjusted to their 
environment. The population is nothing more than a set of 
points in the search space. Each individual of the population 
represents a point in that space by means of its chromosome. 
The individual degree of fitness is given by the fitness 
function that is formed by system requirements. The 
parameters of the controller are tuned by GA that fitness 
function is formed by specific indexes such as the System 
Performance Index [5]. The System Performance Index is an 
optimization for parameters tuning of control systems. It 
deals with a modification of the known integral of time 
multiplied by squared error criterion (ITSE). 
The concept of grey system was firstly proposed by 
Deng from the control problem of unknown systems in 1981 
[6]. Next year, he proposed the paper of grey control system 
which made the grey system research studied widely [7]. 
Grey theory mainly integrates key concepts of system theory, 
information theory and control theory. Grey system theory 
has been widely utilized in system modeling, information 
analysis, and prediction fields. Grey prediction controller 
was proposed by Cheng in 1986 [8]. The large prediction 
step using in grey prediction controller usually causes worse 
transient response, but small prediction step yields a faster 
response. Therefore, the forecasting step-size in the grey 
prediction controller can be switched according to the error 
of system during different periods of the system response. It 
differs from the traditional prediction techniques, in which 
its prediction still can be generated by grey model 
construction stage even facing unknown systems. Therefore, 
many approaches of grey prediction controllers have been 
developed in recent years [9-10]. 
In here, a fuzzy switching grey prediction PID controller 
is utilized, which is combined with real-value genetic 
algorithms (RGA). The strict model of mathematics is 
needless in this paper. The searching parameters of PID 
controller are obtained by RGA. The structure of grey 
prediction controller is obtained by fuzzy switching 
mechanisms. The design process is more concise and the 
controller is more robust to the traditional controllers. 
According to simulation results, the new approach improves 
the performances in set-point control and trajectory tracking. 
2. TRMS SYSTEM 
The TRMS, as shown in Fig. 1, is characterized by 
complex, highly nonlinear and inaccessibility of some states 
and outputs for measurements, and hence can be considered 
as a challenging engineering problem [11]. The control 
objective is to make the beam of the TRMS move quick and 
accurate to the desired attitudes—both to the pitch angle and 
the azimuth angle in the condition of decoupling between 
two axes. The TRMS is a laboratory set-up for control 
experiments and is driven by two DC motors. Its two 
propellers are perpendicular to each other and joined by a 
beam pivoted on its base that can rotate freely in the 
horizontal and vertical plane. The joined beam can be moved 
by changing the input voltage to control the rotational speed 
of these two propellers. There is a Pendulum 
Counter-Weight hanging on the joined beam which is used 
for balancing the angular momentum in a steady state or 
with a load. In certain aspects its behavior resembles that of 
a helicopter. It is difficult to design a suitable controller 
 
 
 
 
4
where p is the forecasting step-size of the system. Pys, pym 
and pyl are the forecasting step-sizes for the large error, the 
middle error and the small error, respectively. 
lθ  and 
sθ are the switching time of the large error and the small 
error, respectively.  
   In this fuzzy system, the absolute value of error e  has 
two linguistic values (PS-positive small, PB-positive big). 
The forecasting step-size p is the consequent variable of the 
fuzzy rules. It takes two linguistic values (N-negative, 
PB-positive big). The membership functions of each 
linguistic values and range for each fuzzy variable are 
described in Fig. 3, where the trapezoidal is used to describe 
the antecedent and consequent. The trapezoidal membership 
is specified by four parameters {a, b, c, d} as follows [14]: 
xd
dxc
cxb
bxa
ax
cd
xd
ab
ax
dcbaxtrapmf
≤
≤≤
≤≤
≤≤
≤
⎪⎪
⎪
⎩
⎪⎪
⎪
⎨
⎧
−
−
−
−
=
,0
,
,1
,
,0
),,,;(
          (11) 
The fuzzy rule base is shown in below. 
NispthenPBiseIfRule
PBispthenPSiseIfRule
:2
:1         (12) 
where (12) is employed to decide (10). The de- fuzzification 
process uses the discrete center of gravity method. This 
paper presents a fuzzy set theory with a switching grey 
prediction. The block diagram of the dynamic forecasting 
step-size is shown in Fig. 4. 
 
C. Utilization Of RGA 
 
A system performance index is used for fitness function 
in RGA. It is an optimization criterion for parameters tuning 
of control system, which is suitable for RGA. It deals with a 
modification of the known integral of time multiplied by 
squared error criterion (ISTE). In order to influence a 
characteristic value of a signal it is not necessary to add a 
special term to the ITSE which will increase the selection 
pressure in RGA. An evident possibility is to divide the 
integral criterion in special error section for each 
characteristic value. The addition in the integral section is 
straight forward and always the same unit. The general form 
and an often used performance index are shown below. 
( ) ( ) ( ) ( )( )∫= T dtttytutetrfI
0
,,,, ,             (13) 
0,1))()(()),(),(( 22 >>+== αα ntutetttuteff nITSE       (14) 
 
 
sθ lθ
e
 
(a) 
 
pys pyl
p
 
(b) 
 
Fig. 3.  (a) Input: Membership functions for e . 
(b) Output: Membership functions for  p. 
 
 
0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
-0.5
0
0.5
1
1.5
Absolute Value Of Error
M
em
be
rs
hi
p 
Fu
nc
tio
n 
V
al
ue
 PS PB 
-20 -15 -10 -5 0 5 10 15 20
-0.5
0
0.5
1
1.5
Forecasting Step-size
M
em
be
rs
hi
p 
Fu
nc
tio
n 
V
al
ue
N PB 
0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
-20
-15
-10
-5
0
5
10
15
20
Absolute Value Of Error
Fo
re
ca
st
in
g 
S
te
p-
si
ze
0 5 10 15 20 25 30 35 40 45 50
-10
-5
0
5
10
15
Time (sec)
D
yn
am
ic
 F
or
ec
as
tin
g 
S
te
p-
si
ze
 
Fig. 4. Dynamic forecasting step-size change from the system error. 
 
 
The definition of the criterion of I-PITSE is 
control
ssTime
timeRise
IIovershoot
Iovershoot
tI nPTISE +
⎥⎥
⎥⎥
⎦
⎤
⎢⎢
⎢⎢
⎣
⎡
+
+
×+=
 
 2
 
    (15) 
Rise time：the difference area between r and y from t=0 to t 
where the gain of y is 0.9r. 
overshoot I & overshoot II：the area between the overshoot 
or maximum peak and r. This section is also double 
evaluated in the sense of more selection pressure and smooth 
fitness landscape. 
ssTime：the steady state time. 
4. SIMULATION 
Simulations included decoupled systems and cross 
coupled system. In the process of RGA, population size was 
10. The first step was to evaluate each fitness value of 
individuals (chromosomes) and subsequently grade them by 
fitness function. The individuals were selected 
probabilistically by their fitness values. Using these selected 
individuals, the next population was generated through a 
process of Adewuya crossover law [15]. Mutation was 
applied with a very low probability 0.025. During the 
simulation in Simulink, reference input of horizontal was 1 
rad and initial condition was 0 rad. Reference input in 
 
 
 
 
6
Table 4. Comparison of total error in cross-coupling system. 
 
reference V or H [16] This paper improvement 
Horizontal 50.0221 28.4915 43.042% 
set-point 
Vertical 32.8766 27.6544 15.884% 
Horizontal 14.0243 8.5304 39.174% 
sine wave 
Vertical 72.2283 43.9153 39.199% 
Horizontal 125.397 101.8933 18.744% square 
wave Vertical 99.3753 38.6560 61.101% 
 
 
0 5 10 15 20 25 30 35 40 45 50
0
0.5
1
1.5
horizontal simulation
Time (sec)
D
eg
.(r
ad
)
reference input
system output
0 5 10 15 20 25 30 35 40 45 50
-0.6
-0.4
-0.2
0
0.2
0.4
vertical simulation
Time (sec)
D
eg
.(r
ad
)
reference input
system output
 
Fig. 11. Step response in cross-coupling system. 
 
0 5 10 15 20 25 30 35 40 45 50
-1
-0.5
0
0.5
1
horizontal simulation
Time (sec)
D
eg
.(r
ad
)
reference input
system output
0 5 10 15 20 25 30 35 40 45 50
-0.6
-0.4
-0.2
0
0.2
0.4
vertical simulation
Time (sec)
D
eg
.(r
ad
)
reference input
system output
 
Fig. 12. Sine wave response in cross-coupling system. 
0 5 10 15 20 25 30 35 40 45 50
-1.5
-1
-0.5
0
0.5
1
horizontal simulation
Time (sec)
D
eg
.(r
ad
)
0 5 10 15 20 25 30 35 40 45 50
-0.6
-0.4
-0.2
0
0.2
0.4
vertical simulation
Time (sec)
D
eg
.(r
ad
)
reference input
system output
reference input
system output
 
Fig. 13. Square wave response in cross-coupling system. 
 
5. FPGA IMPLEMENTATION 
 
For real time control, we implement the hybrid RGA-PID 
controller in a FPGA set. The system of FPGA and TRMS is 
shown in Fig. 14. The control inputs to TRMS within range 
[0－5] are supply voltage of the DC motors. A change in the 
voltage value results in a change of the rotation speed of the 
propeller which results in a change of the corresponding 
position of the beam. For control purpose, the position of the 
beam is encoded in a 16-bit code by the chip HCTL-2016 
and then combined with the FPGA which is made by 
Xinlinx. The command output is a 16-bit signal that will be 
converted to analog voltage by a D/A converter AD7547. 
Design procedure is based on the Foundation Series ISE 6.2 
Edition.  
 
Fig. 14. System of FPGA and TRMS 
 
5.1 Xilinx Spartant II XC2S200 FPGA 
 
The Spartant II XC2S200 Field-Programmable Gate 
Array gives high performance, abundant logic resources, and 
a rich feature set all at an exceptionally low price. It offers 
200,000 system gates, as shown in Table 5. System 
performance is supported up to 200M HZ. It has a regular, 
 
 
 
 
8
To obtain an algorithm that can be implemented in a digital 
device, there are three approaches can be used for integral 
functions approximation: 
1. ( ) ( ) ( )11 −− ⋅=− kkk tehtItI  and ( ) ( )∑−
=
⋅=
1
0
k
j
kk tehtI  (24) 
2. ( ) ( ) ( )kkk tehtItI ⋅=− −1  and ( ) ( )∑
=
⋅=
k
j
kk tehtI
0
 (25) 
3. ( ) ( ) ( )kkk tehtItI ⋅=− −1  and 
 ( ) ( ) ( )( )∑
=
−+⋅=
k
j
kk
k
tete
htI
0
1
2
    (26) 
We use the second approach to implement the RGA-PID 
controller in FPGA. The operation frequency of HTCL-2016 
and Xinlinx XC2S200 are 14M Hz and 200M Hz, 
respectively. In order to combine these devices, we must 
coordinate the operation frequency by a 4-bits frequency 
divider circuit shown in Fig. 17.  
Divider Divider Divider DividerCLK OUT
CLK
Q0
Q0 Q1 Q2 Q3
Q1
Q2
Q3  
Fig. 17. Frequency divider circuit 
 
The signal Q3 in Fig. 17 is the command signal to 
HTCL-2016. Position of the beam will be delivered to 
FPGA for computing. Computing procedure of FPGA is 
shown in Fig. 18. In Fig. 18, the State Machine is used for 
calculating command signal according to error, change of 
error, and sum of error. It contains some decision units and 
limit switches. The whole structure of PID controller is in 
Fig. 19, it consists of one differentiator, one integrator and 4 
16-bits registers. Output is a 16-bits signal which will be 
converted into analog voltage for DC-motor. The controller 
structure has two inputs and two outputs, as shown in Fig. 20, 
it contains four PID controllers. Fig. 21 shows the layout and 
routing on FPGA, its cost is presented in Table 6. 
 
 
Fig. 18. Computing procedure of FPGA 
PK
IK
DK
error ∫
dt  
Fig. 19. Structure of PID controller 
 
PK
IK
DK
∫
dt
PK
IK
DK
∫
dt
PK
IK
DK
∫
dt
PK
IK
DK
∫
dt
 
Fig. 20. Controller structure 
 
 
Fig. 21. Mapping of routing on FPGA 
 
Table 6. Costs of implementation 
Element Number 
Input Output  41 
Functions Generator 47 
Carry Symbols 39 
Flip Flops 4 
Latches 41 
CLB 29 
Logic gate 1968 
Globe buffer 1 
 
 
 
 
10
成果自評: 
 
本計畫已完成理論分析、軟體模擬及硬體模擬。目前TRMS能進行位置追跡及定位之控制，已獲
致不錯的結果。在理論分析及軟體模擬部分，已發表於SCI 期刊Lecture Notes in Artificial 
Intelligence 及IEEE International Conference on Systems, Man, and Cybernetics。在硬體模擬部分，
除了將陸續整理發表論文外，未來將應用更簡易的演算法於FPGA中，以實現硬體的即時學習與
控制。 
 
可供推廣之研發成果資料表 
■ 可申請專利  ■ 可技術移轉                                     日期：96年10月27日 
國科會補助計畫
計畫名稱：應用智慧型控制於非線性雙旋轉翼多輸入多輸出系統之
研究(III) 
計畫主持人：莊季高         
計畫編號：NSC 95－2221－E－019－054     學門領域：控制 
技術/創作名稱 智慧型直昇機自動定位追跡控制器 
發明人/創作人 莊季高 
中文： 
保留(尚未申請專利) 
技術說明 英文： 
保留(尚未申請專利) 
可利用之產業 
及 
可開發之產品 
航太工業 
 
智慧型直昇機自動定位追跡控制器 
技術特點 
本計畫是針對一實驗用的雙旋轉翼多輸入多輸出系統，在雙軸向耦
合的情況下，進行定位控制。以系統性能指標為基礎，利用模糊系
統與基因演算法來求得PID控制器的參數值，並以FPGA進行硬體控
制之實現。藉由應用基因演算法的原理與運算方式，針對時間響
應，採用暫態性能指標作為適應函數，以期搜尋最佳化控制器參
數，期望能跳出區域最佳解而找到全域最佳參數，並且克服雙軸
向交互影響的部分，以改善PID控制器對TRMS系統的性能表現。
推廣及運用的價值 可裝置於直昇機自動駕駛系統內，以取代現有的PID控制器。 
 
出席國際學術會議報告 
(2006年第13屆國際神經資訊處理研討會) 
莊季高 
國立台灣海洋大學通訊與導航工程系  副教授 
 
 
 (一) 參加會議經過 
 
   國際神經資訊處理研討會(International Conference on Neural Information Processing)，
為每年舉辦一次之國際性會議，今年會議於10月3日至10月6日在香港舉行。本次會議共
收到來自42個國家的1175篇論文，經審查後，被接受可發表的計386篇論文，通過率
33%相當低，會議論文被收錄成SCI期刊Lecture Notes in Computer Science的special 
issue。大會議程分成62個組，筆者在此次會議中除發表2篇論文外，亦擔任「機器人與
控制 II」之Session Chair。另外亦參加演化理論組、模糊系統組、硬體實現組及學習演
算組，以盡量吸收新知。會中所討論的主題涵蓋範圍相當廣泛，主要包括類神經網路理
論與應用、類神經網路控制、模糊邏輯理論與應用、進階學習理論與應用、演化計算理
論與應用、視覺與影像合成與應用、最佳化設計、系統設計與模擬、系統判別、類神經
網路晶片及機器人與控制等議題。 
 
  筆者於10月4日及5日分別發表「使用混合式智慧型系統於亂流下之着陸控制」及
「混合式智慧型PID控制於多輸入多輸出系統」論文，此2篇文章引起與會人士的熱烈討
論，論文發表後並與許多學者專家相互交換智慧型理論於不同系統之應用與研究心得。
「機器人與控制」分組報告的重點為控制理論與應用，包含類神經網路於預測控制之應
用、AND-OR模糊類神經網路於船舶之控制、類神經網路解耦合控制器於非線性系統之
應用、類神經網路應用於非線性狀態延遲強健控制器之設計、新BP類神經網路應用於機
器手指之控制、類神經網路應用於自走式機器人之追跡控制等。其中有關智慧型理論與
應用，是目前控制系統的主要研究趨勢，因而引起與會人士熱烈的討論。 
 
本次大會邀請 2位大師級學者蒞會演講，分別為  Shun-ichi Amari 及  Russell 
Eberhart。Dr. Amari 目前是日本RIKEN Frontier Research Program中Brain Information 
Processing Group的主任，亦是日本東京大學的講座教授。Dr. Amari 目前已發表近三百
篇SCI期刊論文，主要研究項目為Brain Process related theories，他所帶領的團隊目前正
嘗試設計Brain-style computer。在neural inference的過程中，應用arithmetic mean及alpha 
mean並結合Bayesian theory去整合腦神經推理的過程。Dr. Eberhart目前是美國普度大學
電機系的系主任，IEEE Fellow，曾擔任IEEE Neural Networks Council的主席，Particle 
Swarm Optimization的創造者，主要研究項目為Computational Intelligence。Dr. Eberhart
提出以swarm intelligence的方式，進行類神經網路connection weights的更新，取代傳統
以梯度法的方式。他所帶領的團隊已成功的完成以類比電腦更新類神經網路。另外、大
I. King et al. (Eds.): ICONIP 2006, Part III, LNCS 4234, pp. 605 – 615, 2006. 
© Springer-Verlag Berlin Heidelberg 2006 
Turbulence Encountered Landing Control Using Hybrid 
Intelligent System 
Jih-Gau Juang1 and Hou-Kai Chiou 
Department of Communications and Guidance Engineering 
National Taiwan Ocean University  
Keelung City, Taiwan, ROC  
jgjuang@mail.ntou.edu.tw1 
Abstract. During a flight, take-off and landing are the most difficult operations in 
regard to safety issues. Aircraft pilots must not only be acquainted with the 
operation of instrument boards but also need flight sensitivity to the ever-changing 
environment, especially in the landing phase when turbulence is encountered. If 
the flight conditions are beyond the preset envelope, the automatic landing system 
(ALS) is disabled and the pilot takes over. An inexperienced pilot may not be able 
to guide the aircraft to a safe landing at the airport. This paper proposes an 
intelligent aircraft automatic landing controller that uses recurrent neural network 
(RNN) controller with genetic algorithm (GA) to improve the performance of 
conventional ALS and guide the aircraft to a safe landing. 
1   Introduction 
China Airlines Flight 642 had a hard landing at Hong Kong International Airport on 22 
August 1999. The lifting wing was broken during the impact, which killed 3 passengers 
and injured 211 people. After 15 months of investigation, a crash report was released on 
November 30, 2000. It showed that the crosswind-correction software 907 on the 
Boeing MD-11 had a defect. Boeing also confirmed this software problem later and 
replaced nearly 190 MD-11 crosswind-correction software programs with the 908 
version. Although this accident was attributed to bad weather and software problem, 
the ALS was focus of the safety issue. The first ALS was made in England during 1965. 
Since then, most aircraft have had this system installed. The ALS relies on the 
Instrument Landing System (ILS) to guide the aircraft into the proper altitude, position, 
and approach angle during the landing phase. According to Federal Aviation 
Administration (FAA) regulations, environmental conditions considered the 
determination of dispersion limits as being: headwinds up to 25 knots, tailwinds up to 
10 knots, crosswinds up to 15 knots, moderate turbulence, and wind shear of 8 knots per 
100 feet from 200 feet to touchdown [1]. If the flight conditions are beyond the preset 
envelope, the ALS is disabled and the pilot takes over. An inexperienced pilot may not 
be able to guide the aircraft to a safe landing at the airport. It is therefore desirable to 
develop an intelligent ALS that expands the operational envelope to include safer 
responses under a wider range of conditions. The goal of this paper is to show that the 
proposed intelligent ALS can relieve human operators and guide the aircraft to a safe 
landing in a wind-turbulence environment. 
 Turbulence Encountered Landing Control Using Hybrid Intelligent System 607 
Flare Path 
Glide Path 
≈ 
Altitude 
1200 ft 
0 ft 
50 ft 
Runway 
Touchdown  
altitude (ft), Eδ  is the incremental elevator angle (deg), Tδ  is the throttle setting 
(ft/sec), oγ  is the flight path angle (-3deg), and g  is the gravity (32.2 ft/sec²). The 
parameters ii ZX ,  and iM  are the stability and control derivatives. 
To make the ALS more intelligent, reliable wind profiles are necessary. Two 
spectral turbulence forms modeled by von Karman and Dryden are mostly used for 
aircraft response studies. In this study the Dryden form [9] was used for its 
demonstration ease. The model is given by 
                                         ⎟⎟⎠
⎞
⎜⎜⎝
⎛
+Δ
+=
u
uu
gcg
as
a
t
Nuu
21)1,0( σ                                          (6) 
                                             ⎟⎟⎠
⎞
⎜⎜⎝
⎛
+
+
Δ
= 2)(
)(31)1,0(
u
www
g
as
bsa
t
Nw
σ
                                  (7) 
where  
])51ln(
)510/ln(1[510
h
uu windgc +−= , gcu u2.0=σ , 
hLw = , 
u
o
u L
U
a = , 
w
o
w L
U
a = , 
3w
o
w
L
U
b = , 
3/1100hLu =  for 230>h ,  600=uL  for 230≤h , 
( )hu gcw ×+= 00098.05.02.0σ  for 5000 ≤≤ h , gcw u2.0=σ  for 500>h . 
The parameters are ug is the longitudinal wind velocity (ft/sec), wg is the vertical 
wind velocity (ft/sec), 0U  is the nominal aircraft speed (ft/sec), 510windu is the wind 
speed at 510 ft altitude, 
uL  and wL  are scale lengths (ft), uσ  and wσ  are RMS values of 
turbulence velocity (ft/sec), tΔ  is the simulation time step (sec), N(0,1) is the Gaussian 
white noise with zero mean and unity standards deviation, gcu is the constant 
component of gu , and h  is the aircraft altitude (ft). Fig. 2 shows a turbulence profile 
with a wind speed of 30 ft/sec at 510 ft altitude. 
 
 
 
 
 
 
 
 
 
 
 
 
Fig. 1. Glide path and flare path 
 Turbulence Encountered Landing Control Using Hybrid Intelligent System 609 
descriptions can be found in [9]. In order to enable aircraft to land more steady when 
aircraft arrives to the flare path, a constant pitch angle will be added to the controller. 
Genetic Algorithm (GA) is a global search method [11], which can search best 
population by using evolutionary computation. Therefore, it has been widely used to 
solve optimal problem recently. It can search many points at the same time, so not apt to 
fall into local optimal solution. The control parameters of the pitch autopilot were 
derived by traditional control theory, which can not bear various wind turbulence. 
When the wind turbulence is too strong, the ALS can not control aircraft to land safely. 
In here we reselected the aircraft’s control parameters by using a hybrid RNN-GA 
control scheme which improved the ability of turbulence resistance of the ALS. 
Williams and Zipser [12] proposed a real-time recurrent learning (RTRL) algorithm 
in 1989, which is used to train RNN (as shown in Fig. 5). RNN is used to approximate 
and control a nonlinear system through an on-line learning process [13]-[14], and the 
weights of the networks need to be updated using a dynamical learning algorithm 
during the control process. In the training schemes of RNN, most algorithms were 
developed in accordance with different problems. The learning algorithms adjust the 
weights of the network, so that the trained network will exhibit the required properties. 
The most general algorithms used for RNN are usually the gradient descent learning 
algorithms. By evaluating the gradient of cost function with respect to the weights of 
the networks, it is possible to iteratively adjust the value of the weights in the direction 
opposite to the gradient. It is well known that there are feedback paths or recurrent links 
in RNN, i.e., the current output depends upon the past outputs of the network. 
Furthermore, the level of error depends not only on the current parameter set, but also 
on the past parameter set. Obviously, it is necessary to consider these dependencies in 
the learning schemes. In the course of learning, the adjustment of the relevant 
parameters of the network will be updated by sequential mode; therefore, this can be 
applied to on-line learning. The characteristics of the RNN are fast learning, short 
execution time, fast convergence, and the network relatively stabilizes with plasticity. 
Fig. 5 shows the structure of the RNN. The inputs for the RNN controller are: 
altitude, altitude command, altitude rate, and altitude rate command. The output of the 
controller is the pitch command. The activation of the hidden layers is sigmoid 
function, which can be used in nonlinear space transformation. Weights updating rules 
are given as follows. 
1
( ) ( ) ( )
n
x c u
j ij j i
j
net k w x k w u k
=
= ⋅ + ⋅∑   (8) 
( ) ( ( ))i jx k f net k=  (9) 
( ) ( 1)cj jx k x k= −  (10) 
1
( ) ( )
n
y
i i i
i
net k w x k
=
= ⋅∑  (11) 
( ) ( ( ))iy k f net k=  (12) 
( )( ) ( ) ( )( )
y
i d i
i
y k
w y k y k x k
net k
η ∂Δ = ⋅ − ⋅ ⋅⎡ ⎤⎣ ⎦ ∂  (13) 
( )( )( ) ( ) ( ) ( )( ) ( )
u y i
i d i
i j
x ky k
w y k y k w k u k
net k net k
η ∂∂Δ = ⋅ − ⋅ ⋅ ⋅ ⋅⎡ ⎤⎣ ⎦ ∂ ∂  (14) 
 Turbulence Encountered Landing Control Using Hybrid Intelligent System 611 
 
Fig. 6. The RNN learning structure 
 
GA searches starting
Define the relevant 
parameters
Generate initial 
generations and populations
Satisfy the 
condition of the 
ending evolution
Generate different 
wind turbulence
All populations are 
tested
Aircraft landing 
simulation
Record successful times
Reproduction
Mutation
Crossover
Generate new generation
Optimal values
GA searches ending
YES
NO
 
Fig. 7. Learning process of the RNN-GA scheme 
 Turbulence Encountered Landing Control Using Hybrid Intelligent System 613 
0 5 10 15 20 25 30 35 40 45
-8
-6
-4
-2
0
2
4
6
8
10
12
Time (sec.)
de
g.
Pitch (Solid) & Pitch Command (Dashed)
  
5 10 15 20 25 30 35 40 45
0
50
100
150
200
250
300
350
400
450
500
Time (sec.)
ft.
Altitude (Solid) & Altitude Command (Dashed)
 
Fig. 8. Aircraft pitch angle and command       Fig. 9. Aircraft altitude and command 
0 5 10 15 20 25 30 35 40 45
-30
-25
-20
-15
-10
-5
0
5
Time (sec.)
ft.
/s
e
c.
Vertical Velocity (Solid) & Vertical Velocity Command (Dashed)
      
0 5 10 15 20 25 30 35 40 45
-10
-8
-6
-4
-2
0
2
4
6
8
Time (sec.)
de
g.
Pitch (Solid) & Pitch Command (Dashed)
 
Fig. 10. Aircraft vertical velocity and command   Fig. 11. Aircraft pitch angle and command 
5 10 15 20 25 30 35 40 45
0
50
100
150
200
250
300
350
400
450
500
Time (sec.)
ft.
Altitude (Solid) & Altitude Command (Dashed)
     
0 5 10 15 20 25 30 35 40 45
-40
-35
-30
-25
-20
-15
-10
-5
0
Time (sec.)
ft.
/s
ec
.
Vertical Velocity (Solid) & Vertical Velocity Command (Dashed)
 
   Fig. 12. Aircraft altitude and command        Fig. 13. Aircraft vertical velocity and command 
Table 1. The results of RNN from using different turbulence speeds 
Wind speed (ft/sec) 10 20 30 40 50 
Landing point (ft) 879 867 914 926 949 
Aircraft vertical speed (ft/sec) -2.5 -2.2 -2.1 -1.9 -1.7 
Pitch angle(degrees) -0.9 -0.8 -0.2 0.2 0.6 
 Turbulence Encountered Landing Control Using Hybrid Intelligent System 615 
7. D.K.Chaturvedi, R.Chauhan, and P.K. Kalra, “Application of Generalized Neural Network 
for Aircraft Landing Control System,” Soft Computing, vol. 6, pp. 441-118, 2002. 
8. Y. Iiguni, H. Akiyoshi, and N. Adachi, “An Intelligent Landing System Based on Human 
Skill Model,” IEEE Trans. on Aeros. and Electr. Sys., vol. 34, no. 3, pp. 877-882, 1998. 
9. C.C.Jorgensen and C.Schley, “A Neural Network Baseline Problem for Control of Aircraft 
Flare and Touchdown,” Neural Networks for Control, pp. 403-425, 1991. 
10. M.G. Cooper, “Genetic Design of Rule-Based Fuzzy Controllers,” Ph.D. dissertation, 
University of California, Los Angeles, 1995. 
11. R.L. Haupt and S.E. Haupt, Practical Genetic Algorithm, USA, 2004. 
12. R.J. Williams and D. Zipser, “A Learning Algorithm for Continually Running Fully 
Recurrent Neural Network,” Neural Computing, vol. 1, pp.270-2801 1989. 
13. J.L.Elman, “Finding Structure in Time,” Cognitive Science, vol. 14, pp.179-211, 1990. 
14. M. Meral and N.S Sengor, “System Identification with Hybrid Elman Network,” Proc. of 
IEEE on Signal Processing and Communications Applications Conf., pp. 80-83, 2004. 
15. A.A. Adewuya, “New Methods in Genetic Search with Real-valued Chromosomes,” M.S. 
thesis, Dept. of Mechanical Engineering, Massachusetts Institute of Technology, 1996. 
 Hybrid Intelligent PID Control for MIMO System 655 
construction stage even facing unknown systems. Therefore, many approaches of grey 
prediction controllers have been developed in recent years [8-9]. 
In this paper, a switching grey prediction PID controller is utilized, which is 
combined with real-value genetic algorithms (RGA) [10]. The parameters of the 
controller are tuned by RGA which fitness function is formed by specific index such as 
System Performance Index [11]. The System Performance Index is an optimization for 
parameters tuning of control system. A modified system performance index of the 
known integral of time multiplied by squared error criterion (ITSE) is used in this 
paper. The strict model of mathematics is needless with respect to the searching 
parameters of PID controller which is obtained by RGA, or the structure of grey 
prediction controller which is obtained by switching mechanism. For this reason the 
design process is more concise and the controller is more robust to the traditional 
controller. According to simulation results, the new approach improves the 
performances in set-point control and trajectory tracking. 
2   System Description 
The TRMS, as shown in Fig. 1, is characterized by complex, highly nonlinear and 
inaccessibility of some states and outputs for measurements, and hence can be 
considered as a challenging engineering problem [12]. The control objective is to make 
the beam of the TRMS move quickly and accurately to the desired attitudes, both the 
pitch angle and the azimuth angle in the condition of decoupling between two axes. The 
TRMS is a laboratory set-up for control experiment and is driven by two DC motors. Its 
two propellers are perpendicular to each other and joined by a beam pivoted on its base 
that can rotate freely in the horizontal and vertical plane. The joined beam can be 
moved by changing the input voltage to control the rotational speed of these two 
propellers. There is a Pendulum Counter-Weight hanging on the joined beam which is 
used for balancing the angular momentum in steady state or with load. In certain 
aspects its behavior resembles that of a helicopter. It is difficult to design a suitable 
controller because of the influence between two axes and nonlinear movement. From 
the control point of view it exemplifies a high order nonlinear system with significant 
cross coupling. For easy demonstration in the vertical and horizontal separately, the 
TRMS is decoupled by the main rotor and tail rotor.  
 tail rotor
Tail shield
DC-motor + 
tachometer
pivot
main rotor
DC-motor + 
tachometer
free-free beam
counterbalance
main shield
 
Fig. 1. The laboratory set-up TRMS 
 Hybrid Intelligent PID Control for MIMO System 657 
y
Λ
 
Fig. 3. The block diagram of the switching grey prediction PID control 
.,...,2,1),()( )0(
1
)0()1(
nkmyyAGOky
k
m
=∑==
=
D                          (2) 
The DGM(2,1) model is expressed as  
0)()1()2( )1()1()1( =++++ kbykayky ,                                  (3) 
where the a and b are undecided coefficients of second order difference equation. The 
parameters a and b can be solved by means of the least square method as follows 
           YBBB
b
a TT 1)( −=⎥⎦
⎤⎢⎣
⎡
                                             (4) 
where 
⎥⎥
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢⎢
⎢
⎣
⎡
=
)(
)4(
)3(
)1(
)1(
)1(
ny
y
y
Y #
  
⎥⎥
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢⎢
⎢
⎣
⎡
−−−−
−−
−−
=
)2()1(
)2()3(
)1()2(
)1()1(
)1()1(
)1()1(
nyny
yy
yy
B ##
 
Take the Z transform for (3); we obtain the following characteristic equation 
( ) 02 =++ bazz                                                     (5) 
and the roots of (5) are represented as 
2
42
1
baa
z
−+−
=
 , 
2
42
2
baa
z
−−−
=
 .                                     (6) 
Therefore, there are three cases for (6): Case I. 21 zz ≠ ; Case II. 21 zz = ; Case 
III. 1z and 2z are a conjugate pair. 
Case I: If 21 zz ≠ , the solution of the prediction model of second order difference 
equation by using inverse Z transform is  
pkpk zczcpky ++
Λ
+=+ 2211
)1(
)(                                                (7) 
The constants 1c  and 2c  are obtained by solving the initial condition of (7) from 1=k  
and 2=k : 
 Hybrid Intelligent PID Control for MIMO System 659 
Therefore, the modified grey prediction can be constructed by  
.)1,2( )0(
)0(
yMGOAGODGMIAGOIMGOy DDDDD=
∧
   (17) 
Influence of using different step-size on the system is shown in Table 1. The goal is 
to find a proper forecasting step-size between the given positive and negative one. The 
controller not only can reduce the overshoot, but also can cause a shorter rise time than 
the conventional design methods. The switching mechanism is defined by [14] 
⎪⎩
⎪⎨
⎧
≥
>≥
>
=
epyl
epym
epys
p
s
sl
l
θ
θθ
θ
if
if
if
,                                                 (18) 
where p is the forecasting step-size of the system. pys, pym and pyl are the forecasting 
step-sizes for the large error, the middle error, and the small error, respectively. lθ  and 
sθ are the switching time of the large error and the small error, respectively.  
Table 1. Different forecasting step-size influence on the system 
                     Forecasting 
                     Step-size 
System 
 response 
Positive 
forecasting 
step-size 
Negative 
forecasting 
step-size 
Overshoot Small Big 
Rising time Long       Short 
Steady state time       Slow Fast 
Adapt region Close Leave 
A system performance index is used for fitness function in RGA. It is an 
optimization criterion for parameters tuning of control system. It deals with a 
modification of the known integral of time multiplied by squared error criterion (ISTE). 
In order to influence a characteristic value of a signal it is not necessary to add a special 
term to the ITSE which will increase the selection pressure in RGA. An evident 
possibility is to divide the integral criterion in special error section for each 
characteristic value. The addition of integral sections in the time horizon is straight 
forward and always the same unit. For example, the aim of control optimization is to 
determine the control parameters in order to minimize the error signal e as shown in 
Fig. 4. The general form and an often used performance index are shown below. 
( ) ( ) ( ) ( )( )∫= T dtttytutetrfI
0
,,,, ,                                  (19) 
0,1,))()(()),(),(( 22 >>+== αα ntutetttuteff nITSE                        (20) 
The following equation represents system performance index: 
control
timestatesteady
risetime
IIovershoot
I*overshoot
tI nPITSE +
⎥⎥
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢⎢
⎢
⎣
⎡
+
+
+
=
*2
1
* .                              (21) 
 Hybrid Intelligent PID Control for MIMO System 661 
4   Simulations 
In the process of RGA, population size is 10. The first step is to evaluate each fitness 
value of individuals (chromosomes) and subsequently grade them by fitness function. 
The individuals are selected probabilistically by their fitness values. Using these selected 
individuals the next population is generated through a process of Adewuya crossover law 
[15]. Mutation is applied with a very low probability 0.025. The target parameters of the 
control system are the forecasting step-size, switching times, and the PID control gains, 
which are pylh, pysh, pylv, pysv, lhθ , svθ , KPhv, KIhv, KDhv, KPvh, KIvh, KDvh, KPvv, KIvv, 
KDvv, KPhh, KIhh, and KDhh. During the simulation in Simulink, reference input of 
horizontal is 1 rad and initial condition is 0 rad. Reference input in vertical is 0.2 rad and 
initial condition is -0.5 rad. Simulation time is from 0 to 50 seconds. System performance 
requirements are: maximum overshoot less than 1%；rising time, delay time and steady 
state time as short as possible. System Performance Index is 
( )( ) ( )
( ) ( )( ) ( )
( ) ( )
( ) ( )( ) ( ) ( )
.
9.0
2
05.0
9.0
0.101.1
01.1
2
⎟⎟
⎟⎟
⎟⎟
⎟
⎠
⎞
⎜⎜
⎜⎜
⎜⎜
⎜
⎝
⎛
−+
+
−+
−
=
∫
∫
∫
∫
≤
≥
≥>
≥
trte
ty
ty
ty
PITSE
dttrty
dttr
dttrty
dtMpty
tI
                                                (23) 
Fitness function in RGA is 
vpitsehpitse II
FunctionFitness
__
1000010000
_ += .                                        (24) 
Simulation results are shown in Fig. 7 to Fig. 9. Compare to previous work [16], as 
shown in Table 2, the TRMS output performance has been improved a lot. 
 
Fig. 7. Step response in cross-coupling system 
