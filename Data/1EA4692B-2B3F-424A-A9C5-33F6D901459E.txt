 2
障診斷與調度決策系統，以便在電力系統發生嚴
重事故時，迅速提供正確的故障資訊，進而採取
適當的調度策略，確實有其必要性。針對電力系
統的特性，應用智慧型多代理人技術，發展出即
時線上故障診斷與復電決策系統，期望能在故障
發生時，迅速判斷出故障發生之位置，並採取適
當之復電策略，進而使故障範圍及所受之影響減
到最小。 
本計畫運用智慧型多代理人技術，有效支援
配電饋線、主變壓器及大規模停電事故之故障偵
測、隔離及復電(FDIR)功能。協助操作人員對於
配電系統故障之應變能力、縮短故障處理時間、
提高服務品質及營運成本。 
二、 拓樸分析 
拓樸分析（Topology Processor）是根據配
電自動化資料庫所得電氣連結性及動態開關狀態
建立配電系統網路模型，以達到顯示及分析配電
系統等目的。此外，拓樸分析亦可配合圖資運轉
系統顯示配電系統網路之配電設備屬性資料及實
際地理位置。 
在圖資運轉系統中，配電設備分為二種元
件：分支（branch）及節點（node），分支為任
何連接兩個端點之設備如地下/架空電纜線、開
關及變壓器等，而節點是將分支連結之電氣節
點。圖一為拓樸分析流程圖，拓樸分析經由追溯
過程建立網路結構，一般而言，拓樸追溯是由給
定之節點設備或分支設備開始，以分支另一端點
為新的起點，而分支連結到新的節點表示是新的
分支，重覆執行此過程直到抵達開路開關或終
點，當所有配電設備皆已追溯完畢時，則代表用
戶停電事故管理系統之網路模型建構完成。 
表一為圖資運轉系統中電氣連結性資料表屬
性資料說明，於電氣連結性資料表中可得知配電
設備所有電氣連結屬性資料，不過，若想要得到
配電設備更多的相關屬性資料則需由資料庫其他
資料表格查詢；配電系統任何設備的電氣連結關
係皆儲存於圖資運轉資料庫之電氣連結性資料
表，在圖資運轉系統資料庫中，每個設備皆有其
各自設備流水號，藉由設備流水號，於不同資料
表查詢其屬性資料，如線路變壓器型式及容量、
饋線遮斷電流等。 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
表一 電氣連結性表格屬性資料說明 
英文名稱 中文名稱 欄位說明 
FSC 設備種類編碼  
UFID 設備流水號  
N1 節點 1  
N2 節點 2   
FDR1 主要供電饋線 1  
FDR2 主要供電饋線 2  
DIR 
 
 
方向性 
 
 
0:單節點設備有電 ; 1:順向
有電 ; 2:逆向有電 ; 3:順向
無電 ; 4:逆向無電 ; 98:單
節點設備無電 ; 99:沒有供電 
OHUG 地下架空別 0:OH(架空) ; 1:UG(地下) 
OSTATUS 開關運作連結狀態 0:OFF(不通電) ; 1:ON(通電) 
PHASE 相別  1:? ; 2:A ; 3:B ; 4:C ; 
5:AB ; 6:BA ; 7:BC ; 
8:CB ; 9:CA ; 10:AC ; 
11:ABC 
X 設備之 X 座標  
Y 設備之 Y 座標  
 
三、 節點簡量 
圖資運轉系統資料庫對配電系統之設備及
其屬性資料記錄的相當複雜，此其中也包括了許
多不是本計畫所需要的設備，所以在此執行節點
簡量的動作，將多餘之設備資料去除，建立適合
本計畫應用之資料庫以簡化應用程式之資料輸入
圖一 拓樸分析流程圖 
開始 
完成整體追溯且設立
供電標誌、迴路標誌
及饋線顏色代碼
是否有任何未到
達之設備？
假設所有開關關閉，透過查詢任
何不能到達之設備，檢查連接性
是否無誤
從配電自動化資料庫讀取配
電系統模型到記憶體 
是否有迴路？ 
何種類型之迴路
等待開關狀態改變，
中止拓樸處理程式 
輸出未到達設備之列
表，然後離開 
是 
否 
是 
否
 4
五、  復電多代理人系統 
本計畫提出一種代理人模型執行 FDIR 功
能，以提高台電在配電自動化系統上的能力。在
配電自動化系統代理人架構下，適當的執行開關
故障檢測與隔離以恢復供電。將 FDIR 模型的通
信模擬建構在 JADE 平台上，以確保遵守 FIPA
標準[6-8]，同時還透過圖形化代理人介面來監控
每一個代理人上的通訊。配電自動化系統代理人
架構(DASA)與 FIPA 代理人管理模型[8]，如圖
三所示。架構中包含兩個公共代理人；代理人管
理系統(AMS)與目錄導引器(DF)。 
 
圖三 FIPA代理人管理參考模型 
 
在 DASA 中各種不同類型的代理人具備了
自動化的功能。他們可以主動尋找其他代理人，
提供他們數據及資料以達到分析的功能。以圖三
為例，拓樸處理器 TP 在即時狀態下，保持與饋
線上所有設備的溝通。此外，TP 也能夠追蹤管
理異常的設備。在 DASA 平台中，所有的代理
人與 TP 建立拓樸關係。例如：FTU 代理人區域
內的常開 FTU 先透過 TP 代理人與轉供的 FCB
與 MTR 代理人建立拓樸關係。在故障檢測並隔
離區域之後，常開 FTU 便可詢問 FCB 與 MTR
饋線容量裕度，以決定轉供與否。代理人通訊架
構依據 FIPA 所假設的公用代理人，來達到互相
溝通的功能。而相同涵義的代理人訊息可使用符
號來表示。 
5.1 以配電自動化系統代理人執行饋線故障 
以配電自動化系統代理人執行饋線故障，本
計畫以多重代理人支援故障定位、隔離及復電研
究，透過 JADE 平台開發各代理人系統之建置。
運用其分散式的特性及溝通訊息支援配電系統故
障之隔離與復電功能。使配電系統建構出分散式
多代理人環境，並以專家系統(規則庫型)推論其
復電程序，發揮多代理人處理能力以協助調度中
心內系統調度員做復電策略執行時之參考，提升
復電效率並減輕調度人員判別負擔，快速將故障
事件導致停電範圍復電。當配電系統發生故障
時，智慧型代理人會根據 FTU 所接受之訊息，
自動找出故障點、隔離且啟動相關機制，歸納出
合適的復電策略，以防止故障範圍擴大。 
台電公司針對配電饋線上所發生之故障，依
故障點於饋線上之位置將饋線故障分為兩種故障
類型。第一種故障型式是線段區間故障，此乃饋
線線段上某一區間發生故障；第二種故障型式是
饋線出口或饋線斷路器故障。其中以第二種饋線
出口端發生故障之情形較為嚴重，此種饋線故障
發生時整條供電饋線上之負載均需轉供到其他饋
線上，由其他饋線承接故障停電區之負載以恢復
供電。 
A. 線段區間故障： 
饋線故障簡易圖，如圖四所示，當 FTU1 與
FTU2 之間發生故障 F1 時，饋線上斷路器 FCB1
將會跳脫，根據 FTU1 與 FTU2 所回傳之電流旗
標，找出故障區段並加以隔離之後，進行上游復
電及下游轉供之工作，各代理人間的動作時序圖
如圖五及轉供程序分述如下： 
程序 1 隔離故障點： 
當故障發生後，FTU1 傳送故障訊息至上游
FCB1 並令 FCB 之狀態為 open，每一個 FTU 立
即藉由 Report by Exception 將其作動 CB 之狀態
與故障電流值寫入每一 FTU 之 RTDB。因為在
有故障電流經過之故障點上游 FTU 將有 FL 之指
示，下游區段由於沒有故障電流經過而無 FL 之
回報，由故障點 FTU2 開始往下游詢問，直到詢
問至第一個無 FL 回報之 FTU3 為止，並將此
FTU2 及其上游之 FTU1 之開關狀態設為 open，
達成故障隔離之功能。 
程序 2 上游未故障區域由原供電饋線繼續供
電： 
故障隔離後，立即令 FCB1 之狀態為
close，將上游未故障區域由原供電饋線繼續供
電。 
程序 3 下游區域在故障點隔離後，由其他饋線
轉供： 
完成上游復電後，故障隔離之 FTU2 將會傳
送訊息給 Open-tie switch FTU4 ，將詢問承載饋
線之 FCB2 及 MTR2 有關承載饋線及主變壓器之
裕度。等 FTU4 收到上游負載相關資料及承載欲
度時，經過判斷便可決定是否投入以進行下游復
電。如果能支援之饋線超過一條以上，則選擇最
 6
次側上的斷路器MCBi1與MCBi2以隔離故障點，
接著MTR agent偵測到主變壓器上之斷路器跳脫
信號，立即切斷該故障主變壓器轄下的所有饋線
斷路器FCBi1~FCBi6，最後藉由偵測同一主變壓
器底下所有饋線斷路器跳脫以確認該主變壓器發
生故障。在完成主變壓器故障之確認及隔離後，
配電自動化系統將閉合此故障主變壓器與其相鄰
主變壓器間的常開連絡斷路器以進行轉供復電。
而整個主變壓器故障偵測、隔離與復電之時序圖
如圖八所示，各動作分述如下： 
程序 1：配電主變壓器發生故障，MTR 令變壓
器一次側與二次側斷路器 (MCBi1 、
MCBi2)之跳脫以隔離故障。MTR 偵測
到變壓器斷路器跳脫信號，便下達啟斷
故障主變壓器轄下所有 FCB agent 的饋
線 斷 路 器 (FCBi1 、 FCBi2 、 FCBi3 、
FCBi4、FCBi5、FCBi6)之命令，以完成
主變壓器故障之確認。 
程序 2：主變壓器故障後之復電轉供程序中要投
入原故障主變壓器轄下的饋線斷路器
前，需先計算承載主變壓器之轉供能力
以判斷此主變壓器可承接之最大轉供饋
線數量。若承載主變壓器之容量裕度足
以承接故障變壓器之負載量，則系統由
RTU agent 下達投入變壓器間之常開連
絡斷路器(TCB)及原故障主變壓器轄下
的饋線斷路器，以完成故障停電區域支
援復電。 
程序 3：若承載主變壓器之容量裕度無法承接故
障變壓器之負載量，則依承載主變壓器
之容量裕度計算可承載之最大轉供饋線
數量，根據卸載策略之評估指標函數，
選擇重要用戶等級較高且其負載量較大
的饋線投入其饋線斷路器以完成轉供，
其餘無法轉供的饋線再依一般饋線故障
處理以完成因主變壓器故障所造成之復
電轉供。 
 
圖八 主變壓器故障時序圖 
 
當系統發生主變壓器故障停電事故時，首先
是由同一變電所內之相鄰主變壓器執行復電轉
供，一旦發生承載主變壓器容量裕度不足以完成
全面復電時，其餘無法轉供之饋線將當作一般饋
線故障事故處理以完成復電。由饋線故障之復電
法則中提到在轉供裕度足夠的情形下，連絡饋線
之選擇是以同一變電所內之饋線為優先，因此可
知不論是饋線故障或者是主變壓器故障，其復電
之原則都是以同一變電所內可完成轉供為目的，
避免變動到其他變電所之供電架構所造成的開關
操作複雜度及其主變壓器於開關操作時轉供能力
估測困難。 
 
六、 配電系統故障復電之實例研究 
 
6.1 饋線故障之復電研究 
模擬鳳山區處如圖九所示配電系統饋線口
BW46 故障情形，應用多代理人系統執行
FDIR，並且監控每個代理人之間的傳遞訊息，
如圖十所示。當 BW46 饋線口發生故障時，開
關 CB30 跳脫，造成 L32-L37 線段區間因此停
電，由於饋線 BW39 沒有足夠裕度可以承接
BW46 所有負載，如圖中的訊息 2-5，因此須將
BW39 轉移部份負載 117 安培到 BW32，投入開
關 S4 並且打開開關 S5。最後，投入開關 S34，
BW46 停電區域 L32-L37 將轉供給 BW39，完成
復電程序。台電中央統籌管理的配電自動化系統
執行 FDIR，需要 19 則通訊訊息，相較於所提出
之配電自動化系統代理人採用分散式執行
FDIR，只需要 13 則通訊訊息。除此之外，中央
統籌的 DAS 執行 FDIR 時，必須從即時資料庫
取出大量資訊，而所提出之代理人系統執行
FDIR 時，代理人之間只需要查詢所需資料，大
大減少通訊上的負擔。 
 8
A. 復電策略一(不考慮供電優先度) 
    由於不考慮供電優先度，饋線開關應用復電
策略解決配電系統運轉問題，則以最大中斷負載
優先復電。而各代理人之間訊息傳遞，如圖十一
所示。因為故障發生在 MTR2，由於支援主變壓
器 MTR1，無法直接承接故障變壓器 MTR2 的
所有饋線，因此負載量較高的饋線 BW37、
BW39 和 BW40 優先考量承接。部分無法由支援
主變壓器承載的饋線 BW36 和 BW38，則由其他
支援饋線 BW49 和 BW42 轉供處理，如圖十一
中訊息 10-19 所示，由於 BW49 無法全部承接
BW46 負載，因此打開開關 S12 進行卸載策略，
卸載區域為 L12 和 L13 共 82A，並且投入開關
S13 和 S21，以減少非故障停電區域。 
 
 
 
圖十一 主變壓器故障之各代理人時序圖(不考慮
供電優先度) 
 
B. 復電策略二(考慮供電優先度) 
考慮到供電優先度時，優先權較高的用戶在執
行 FDIR 時將能先行復電。而重點用戶等級決定
於每條饋線的供電優先權。由於支援主變壓器
MTR1 沒有足夠裕度承載主變壓器 MTR2，而饋線
BW36、BW37 及 BW39 供電優先權大於 BW38 和
BW40，因此將關閉 CB21、CB22 與 CB24 優先納入
復電策略。部分無法由支援主變壓器承載的饋線
BW38 與 BW40，則以轉供方式處理，由其他饋線
轉供以減少非故障停電區域，如圖十二訊息 10-
19 所示。其中饋線 BW38 之負載區域 L19-L22，
藉由投入連絡開關 S21 轉供至 BW42 進行復電，
由於 BT46 無法全部承接 BW40 負載，只能承接部
分負載 L29，其餘需做區域卸載動作，卸載區域
為 L26、L27、L28 共 96A，故打開 S25 開關，在
確認 BT46 及其所屬之主變壓器 MTR3 不會過載
後，投入連絡開關 S26 進行轉供。主變壓器執行
兩種復電策略，復電前後的電流負載。當考量重
點用戶優先權時，可以發現饋線將需進行更多卸
載區域。 
MTRSL2 RTUSL MTRSL1 MTRSL3 CB21,22,24 CB23 CB25 CB27 S21 CB15 S26 S18-20 S23-24 S25 MTRCL3
mseeages
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
CB54,CB55 
tripped
[1]
[2]
CB21,22,24 
tripped
[3]
[4]
[5]
CB23 
tripped CB25 
tripped
[6]
[9] [7] [8]
[10] [11]
[12]TIE3
closed
[13] [14] [15] [16]
[17] [18] [19]
[20][21] [22]
[23]
[32][24]
[25] [26]
[27]
[35]
[28][29]
[38]
[31][30] [33]
[34][36]
[37]
[39]
S21
closed S25
openedS26
closed
 
 
fault detection 
and isolation
service 
restoration
[40]
[1]   Inform MTR2 fault
[2]   Request CB21-CB25 tripped
[3] CB21, 22, 24 tripped confirm
[4]   CB23 tripped confirm
[5]   CB25 tripped confirm
[6] Isolation confirm
[7] Query MTR1 capacity reserve
[8] Query MTR3 capacity reserve
[9] Query BW36-BW40 loadings
[10] BW36-BW40 total loading message
[11] MTR1 capacity reserve message
[12] MTR3 capacity reserve message
[13] MTR1 capacity reserve is not enough, 282 (A)
[14] Request CB21,CB22,CB24 close
[15] Feeder load transfer
[16] Feeder load transfer
[17] CB21,CB22,CB24 close confirm
[18] Feeder load transfer
[19] Feeder load transfer
[20] Query BW42 capacity reserve
[21] Query MTR3 (Shun-Liao) capacity reserve
[22] Query L19-L22 loadings
[23] BW42 capacity reserve message
[24] MTR3 (Shun-Liao) capacity reserve message
[25] L19-L22 loading messages
[26] Query BT46 capacity reserve
[27] Query MTR3 (Chao-Liao) capacity reserve
[28] Query L26-L28 loadings
[29] Query L29 loading
[30] BT46 capacity reserve message
[31] MTR3 (Chao-Liao) capacity reserve message
[32] L26-L28 loading messages
[33] L29 loading message
[34] Request S25 opened
[35] S25 opened confirm
[36] S21 closed confirm
[37] S26 closed confirm
[38] BW38 load transfer confirm
[39] BW40 partial load transfer confirm
[40] Feeder load transfer confirm  
圖十二 主變壓器故障之各代理人時序圖(考慮供
電優先度) 
七、 結論 
本計畫提出一種多重代理人(Multi-agent)應
用軟體之開發，執行配電系統故障偵測、隔離與
復電之開關操作策略，以支援配電系統調度員能
迅速地完成故障之復電計畫，並強化供電可靠
度，減少電力公司與用戶的停電損失。本研究所
推導之成果，將可提供台電推動配電自動化時之
參考依據，使配電系統之運轉，更有效提昇其電
力品質。 
 
八、 參考文獻 
[1] 蘇昭庭，「應用多代理人執行配電系統故障
復電」，碩士論文，國立中山大學電機工程
學系，民國九十七年。 
[2] M. Wooldridge and N. R. Jennings, Intelligent 
agents: Theory and practice. The Knowledge 
Engineering Review, 10(2) , pp. 115-152, 1995. 
[3] N. R. Jennings and M. J. Wooldridge, 
Applications of Intelligent Agents.  In Agent 
Technologies: Foundations, Applications, and 
Markets. N. R. Jennings and M. J. Wooldridge 
(eds.) Springer-Verlag, Berlin, Germany, pp. 3-
28, 1998. 
表 Y04 
行政院國家科學委員會補助國內專家學者出席國際學術會議報告 
                                                            98 年 6 月 1 日 
報告人姓名    林嘉宏 
 
服務機構 
及職稱 
 
  國立高雄應用科技大學電機系教授 
 
     時間 
會議 
     地點 
  98.05.25~98.05.27 
  西安，中國大陸 
本會核定 
補助文號 
97-2221-E-151-053- 
會議 
名稱 
(中文)  2009 國際工業電子及應用研討會 
(英文)  The 4th IEEE Conference on Industrial Electronics and Applications, ICIEA 2009 
發表 
論文 
題目 
 (中文) 應用多代理人技術於配電系統故障、偵測、隔離及復電之應用 
 (英文) Fault Detection, Isolation and Restoration using a Multiagent-based Distribution 
Automation System 
報告內容應包括下列各項： 
 
一、參加會議經過 
 
5 月 25 日至西安曲江賓館會場報到。 
5 月 25-27 日在西安曲江賓館會場參加配電系統相關論文的研討。 
 5 月 27 日在西安曲江賓館會場口頭發表一篇應用多代理人技術於配電系統故障、偵測、
隔離及復電之應用之研究論文。 
 5 月 29 日返國。 
 
二、與會心得 
 
  隨著高科技之大量應用於工業、商業及住宅不同類型用戶，電力品質之提升已成
為各國電力公司積極推動之目標，其中配電自動化與用戶自動化更是未來電力工業最
為重要的發展方向。配電自動化包括控制中心、通訊系統、饋線口端末單元、饋線端
末單元所構成之配電管理系統，能將現場之電流、電壓、角度等類比信號與開關狀態
之數位信號回傳，配合即時網路拓樸處理，確定配電系統架構，藉由各種不同之分析
與運轉應用軟體產生控制指令，達到配電系統規劃與運轉最佳化之目的。本論文將運
用 JADE 平台開發多代理人的配電自動化系統來偵測、隔離故障與復電。當故障點被
偵測與隔離後，運用多代理人系統內的變電所端末單元、主變壓器、饋線口端末單元、
饋線端末單元等代理人推導適當的復電計畫。 
 
 
三、考察參觀活動(無是項活動者省略) 
 
 
