Report: Null Space Component Analysis for Noisy
Blind Source Separation
1 Introduction
The blind source separation (BSS) problem is a fundamental issue in applications
of biomedical engineering, signal processing, and communications. The problem
involves separating the source signal from observation signals under various source
signal mixing models; initially, linear instantaneous (memoryless) mixing models
were used, followed by linear convolution mixing models, and more recently nonlinear
mixing models [1, 2, 3, 4]. Various topics related to the problem, including its history,
are discussed in Common and Jutten’s handbook [5] and O’Grady et al.’s survey
paper [6].
In this report, we consider the most basic BSS model, which assumes the source
signals are mixed instantaneously by a matrix. Our objective is to estimatem source
signals and the mixing matrix from n observation signals for any m and n ≥ 2. Dar-
mois [7] observed that the problem is ill-posed because it does not provide a solution
for Gaussian and temporally independent and identically distributed (i.i.d.) source
signals. Usually, the problem can be well posed by imposing assumptions on the
source signals. For example, one can assume that the source signals are temporally
i.i.d. but non-Gaussian. The assumption is the basis for the well known indepen-
dent component analysis (ICA) algorithm, which exploits higher-order statistics to
perform the task [8, 9, 10]. However, even with the assumptions about the source
signals, the ICA approach cannot handle the scaling and permutation ambiguities;
this indicates that the permutation order and the scaling of the derived source signals
cannot be uniquely determined.
There have been a number of attempts to extend the ICA approach in order to
address the problem in noisy environments. Several methods, based on estimating
the probability functions of the source signals or their high order statistics, have
been proposed to solve the noisy BSS problem. The methods can be classified
1
Based on the proposed models for source signals and the matrix operators, we use
a regularization approach to formulate the noisy BSS problem (i.e., a BSS problem
whose observations are noisy) as a constrained optimization problem. The proposed
null space component analysis (NCA) algorithm utilizes the alternating projection
method, which iteratively derives the source signals, the rake-constrained matrix
operators, and the mixing matrix from the observation signals. The signal-to-noise
ratio (SNR)(or the signal-to-interference-plus-noise ratio (SINR)) evaluates the per-
formance of an estimation algorithm in recovering the source signals, but it does not
access the accuracy of the estimated mixing matrix. We propose a new metric that
takes account of both source signal estimation and mixing matrix estimation. To
demonstrate the robustness and accuracy of the NCA algorithm, we used it to sepa-
rate noisy synthesized signals; and to verify the algorithm’s efficiency, we tested it on
a real-life signal. The test involved removing electrocardiography (EOG) artifacts
from electroencephalography (EEG) signals [26, 27].
2 Null Space Component Analysis (NCA)
Given a set of signals, the NCA approach constructs an operator for each signal
so that only the signal is in the operator’s null space, and all other signals are
excluded. First, we show that the operators exist for linearly independent signals.
Then, we demonstrate that the optimal linear operators can be constructed based
on the information about the signals.
2.1 Separating Operator
Let s, s1, · · · , sm−1 be a set of m signals represented by row vectors in R
N , and
let s be linearly independent of si for all i = 1, · · ·m− 1. We define the separating
operator T : RN → RN that separates s from {si} as follows:TsT = 0N , 0N in RN whose elements are all equal to 0,T sTi 6= 0N . (2)
The signal s is called the separating signal of the operator T ; and the signals {si}
are called the support signals of T because they help T to remove the signal s. As
sT 6= 0N , the separating operator T is always a singular operator.
The operator T is well-defined because a linear operator can be constructed from
the signals to satisfy the above definition. Let si = ui + vi with ui in the direction
of s and vi in the direction perpendicular to s; then, it is straightforward to verify
3
Let Tj be the j-th row of a matrix operator T of size N ×N . By the l
2 property,
we have
||TsT ||22 =
N∑
j=1
||Tjs
T ||22. (7)
Using Equation (7), and normalizing the 2-norm of each row, ||Tj||
2
2 = 1, the ob-
jective function of Equation (6) can be re-arranged and re-written in terms of Tj
as
min
{||Tj ||=1}
N∑
j=1
Tj
[
(1− µ+ µm) sT s− µ
m−1∑
i=1
sTi si
]
T Tj . (8)
Given a signal, let Tj operate on a local segment of length L. We can impose
the non-zero elements of Tj on L consecutive elements beginning at j, and use the
periodic boundary condition to extend the end point if necessary; for example,
Tj = [ 0 . . . 0︸ ︷︷ ︸
j−1
∗ . . . ∗︸ ︷︷ ︸
L
0 . . . 0︸ ︷︷ ︸
N−L−(j−1)
]. (9)
If Tl and Tk with l 6= k are derived independently, the summation and minimization
in Equation (8) can be interchanged, and we have
N∑
j=1
min
||Tj||22=1
Tj
[
(1− µ+ µm) sT s− µ
m−1∑
i=1
sTi si
]
T Tj . (10)
Note that if µ is sufficiently small,
(1− µ+ µm) sT s− µ
m−1∑
i=1
sTi si (11)
is a positive semi-definite matrix. Because the support of Tj is local, the signal seg-
ment that contributes to the calculation Tj
[
(1− µ+ µm) sT s− µ
∑m−1
i=1 s
T
i si
]
T Tj
is located in the same support interval of Tj. Obviously, the solution T
∗
j of Equation
(10) is of the form [ 0 . . . 0︸ ︷︷ ︸
j−1
∗ . . . ∗︸ ︷︷ ︸
L
0 . . . 0︸ ︷︷ ︸
N−L−(j−1)
], where the segment of ∗s is the eigen-
vector that corresponds to the smallest eigenvalue of the L× L square submatrix[
(1− µ+ µm) sT s− µ
m−1∑
i=1
sTi si
]
j:((j+L−1) mod (N+1))+1,j:((j+L−1) mod (N+1))+1
. (12)
The optimal local separating operator T ∗ is the matrix formed by concatenating the
N column vectors {T ∗Tj }
T ∗ = [T ∗T1 · · ·T
∗T
N ]
T . (13)
2.1.2 Group of Separating Operators
For a collection of signals {s1, s2, · · · , sm}, we have defined the separating operator
that separates one of the signals, say s1, from the others. The sole requirement for
5
Note that the last step of the above derivation is possbile because si can be derived
independently of the other signals.
3 NCA for BSS
The BSS problem involves the retrieval ofm unobserved sources, denoted as {s1, . . . , sm},
from n observed mixtures, {x1, . . . , xn}. Each signal, either si or xj , is a row vector
of size N (the number of sampling points) and m ≤ n; that is, the number of ob-
served mixtures is not less than the number of unknown source signals. The problem
can be formulated as follows:
xi =
m∑
j=1
aijsj, ∀ i ∈ {1, . . . , n}. (21)
Here, we assume that {aij} are unknown non-negative mixing coefficients (although
the non-negative constraint is not necessary). Equation (21) can be re-written in
matrix form as follows:
X = AS, (22)
where A is a non-negative matrix mapping from Rm to Rn; and X = [xT1 · · ·x
T
n ]
T
and S = [sT1 · · · s
T
m]
T are matrices of size n × N and m × N respectively. In the
non-negative matrix, denoted as A ≥ 0, all the elements are equal to or greater than
zero.
3.1 NCA Constraints for BSS
Based on the NCA approach, we introduce the NCA constraints for the BSS problem.
We show that, with the constraints, the BSS problem can be resolved up to the
indeterminacy of the scaling of the source signals.
The BSS model is affected by scaling, permutation, and rotation ambiguities1.
Because of the scaling ambiguity, we cannot determine the scaling of the source
signals. To overcome the problem, we usually assume that var(si) = 1 or the norm
of each column of A is 1. The permutation ambiguity prevents us from determining
the correct order of the source signals because
X = AP TPS, (23)
1For any solution A and S of Equation (22), AC−1 and CS is also a solution. By using singular
value decomposition (SVD), C can be factored as a multiplication of the permutation, rotation,
and scaling matrices.
7
Equation (27) enforces that Ti(B
TS)Ti = 0 if and only if B = I because Tis
T
i = 0
and Tis
T
j 6= 0 for j 6= i. The signal model and operators that satisfy Equation (27)
are called the NCA constraints for the BSS problem. We conclude this discussion
with the following theorem.
Theorem 1. Let [T1, · · · , Tm] be a tuple of operators. Then, the BSS problem can
be uniquely determined up to the scaling of signals by imposing the NCA constraints
in Equation (27).
Initially, the separating operators of the source signals and their true order may
seem infeasible because they are relevant to the unknown source signals and their
order. Actually, the theorem does not imply that the true order of the source
signals can be resolved. It simply indicates that the order of the source signals
can be determined after the order of the operators is provided. The operators are
adaptively estimated from the observation signals. We discuss this aspect in Section
4.1.
4 NCA for Noisy BSS
Noisy BSS assumes that the observations in the BSS model are noisy and that they
take the following form:
X = AS + V, (28)
where V = [vT1 , · · · , v
T
n ]
T is an n × N matrix and vi is sampled from i.i.d. white
Gaussian noise with mean 0 and variance σ2. The covariance of X −AS is σ2I. By
taking the log-likelihood of the Gaussian joint distribution of X −AS and omitting
the constant term in the log-likelihood, we obtain
log L(X|AS) =
N∑
i=1
−1
σ2
(X[i] −AS[i])T (X[i] −AS[i]) (29)
=
−1
σ2
Trace(
∑
i
(X[i] −AS[i])(X[i] −AS[i])T ) (30)
=
−1
σ2
||X −AS||2F . (31)
The maximum of the log-likelihood is the minimum of ||X − AS||2F , the Frobenius
norm of X −AS. It is possible to determine the maximum log-likelihood by finding
A and S to minimize ||X − AS||2F with the source signals that satisfy the NCA
constraints. However, in practice, we solve the noisy BSS problem with the following
formulation, which is more robust against the noisy environment:
9
min
||Ti||=1
‖Ti − T̂i‖
2
F satisfying
{
Rank(Ti) = N − 1,
Tis
T
i = 0N ,
(34)
where the matrix operator norm ||Ti|| = 1 indicates that the 2-norm of each row in
Ti equals 1. The condition where Tis
T
i = 0 occurs because Ti is the operator that
separates the signal si from the other signals {sj|j 6= i}. The solution of Equation
(34) can be derived by first solving the following equation:
min
||Ti||=1
‖Ti − Tˆi‖
2
F satisfying
{
Rank(Ti) ≤ N − 1,
Tis
T
i = 0N .
(35)
The rank of the obtained operator is then modified to N − 1.
Let Tˆi = UiΣiV
T
i be the SVD of Tˆi, where Ui = [u1, · · · , uN ]. First, we construct
an orthonormal basis {
sTi
||si||2
, w1, · · · , wN−1} in R
N by performing the Gram Schmidt
procedure on {
sTi
||si||2
, u1, · · · , uN−1}. Then, we project each column of Tˆi into the
space of {w1, · · · , wN−1}. This corresponds to finding the coefficients that minimize
min
{bk,j}k=1,··· ,N−1
N∑
j=1
‖
N−1∑
k=1
bk,jwk − Tˆ
T
i,j‖
2, (36)
where Tˆ Ti,j denotes the j-th column of Tˆ
T
i . Let W = [w1, · · · , wN−1] and let bj =
[b1,j , · · · , bN−1,j ]
T . The coefficient vector bj that solves Equation (36) is
bj =
(
W TW
)−1
W T Tˆ Ti,j (37)
for j = 1, · · · , N .
Let Bi = [b1, · · · , bN ] be an N−1×N matrix. The operator that solves Equation
(35) can be expressed as (WBi)
T , where W is an N × N − 1 matrix. Note that
(WBi)
T sTi = 0N becauseW
T sTi = 0N−1; and Rank(Bi) ≤ N−1 because the columns
of Bi are not necessarily independent of each other. To make the rank of (WBi)
T
equal to N − 1, we apply SVD to Bi and replace the zero singular values with small
positive numbers. The rank of the resultant matrix B˜i and that of the new operator
(WB˜i)
T is N − 1 because of the following rank inequality:
(Rank(Y ) +Rank(Z)− k) ≤ Rank(Y Z) ≤ min(Rank(Y ), Rank(Z)), (38)
where Y and Z are matrices of size N × k and k ×N respectively.
Finally, we normalize the 2-norm of each row in the operator (WB˜i)
T by mul-
tiplying an N × N diagonal matrix D to the right of (WB˜i)
T . The final operator
is
Ti = B˜
T
i W
TD, (39)
which satisfies Equation (34).
11
To calculate the source signals S, we use the Kronecker product, denoted as ⊗.
Let the vec linear operator transform a matrix U into a column vector by stacking
the columns of U underneath one another. A basic connection between the vec and
the Kronecker product indicates that if U , V , and W are three matrices such that
the matrix product UVW is defined, then
vec(UV W ) = (W T ⊗ U) vec(V ). (45)
Applying the vec operator to Equation (44) and using Equation (45), we can derive
that
vec S =
{
m∑
i=1
[
(mµ+ 1) T Ti Ti + (−µ)
m∑
k=1
T Tk Tk
]
⊗ eie
T
i
+ λ
(
IN×N ⊗A
TA
)}−1
λ vec
(
ATX
)
.
(46)
We summarize Sections 4.1.1, 4.1.2, and 4.1.3 in the NCA algorithm below.
Algorithm NCA:
INPUT: observation signals X (matrix of size n × N), initial signals S0 (matrix of
size m×N), stopping thresholds ǫ, Lagrangian µ, Lagrangian λ and the parameter
L for local linear operators.
OUTPUT: m source signals S and the n×m non-negative mixing matrix A.
Step 1. Let k = 0.
Step 2. Estimate m separating operators Ti
k from Sk (Section 4.1.1).
Step 3. Estimate the non-negative mixing matrix Ak from Sk (Section 4.1.2).
Step 4. Estimate the source signals Sk+1 with fixed Ti
k and Ak (Section 4.1.3).
Step 5. If RMSE(Sk, Sk) ≥ ǫ, where RMSE calculates the root mean square error
of Sk+1 against Sk, then set k = k + 1 and go to Step 2.
Step 6. Output: the source signals S = Sk+1 and the mixing matrix A = Ak.
5 Implementation Issues and Experiment Results
Next, we consider some implementation issues and the results of experiments per-
formed on synthesized and real-life biomedical signals with the proposed algorithm.
In Sections 5.1 and 5.2 we discuss the estimation of the initial source signals and
the performance measurements respectively; and in Section 5.3, we review the ex-
periment results.
13
initial wide-band source signal.
C. Reference Signals are Provided: In certain applications, especially biomedi-
cal systems, some reference source signals are provided. The references can be used
to obtain the initial source signals. The other initial signals are derived based on
the orthogonal complement of the space of the reference signals. Let r1, · · · rk be the
reference signals, and let the space of those signals be
∑k
l=1 alrl. The observation
signal xi can be decomposed into two orthogonal components, one in the subspace
of the references and the other in its complement subspace. The second component
can be used as an initial source signal. The projection of xi in the subspace of
references is
∑k
l=1 a
∗
l rl, where the parameters {a
∗
l } minimize the objective
||xi −
k∑
l=1
alrl||
2. (49)
By the orthogonality principle, the parameters a∗l are the solution of
(x−
∑
l
alrl)r
T
i = 0, for i = 1, · · · k. (50)
The above equation can be re-written as the linear system Ra = b, with R[i, j] =
rir
T
j , b[i] = xr
T
i , and a[i] = ai. The component xi −
∑k
l=1 a
∗
l rl is in the complement
subspace of the reference signals and can be used as an initial source signal.
5.2 Performance Measurement
The performance of a signal estimation method for noisy BSS can be evaluated
by the signal-to-interference-plus-noise ratio (SINR)2. Let si be an original source
signal, and let sˆi be its estimation. Then, the SINR is defined as
10 log10
||si||
2
||si − sˆi||2
. (51)
The SINR does not evaluate the estimation of the mixing matrix, which is as impor-
tant as the estimation of the source signals when assessing the performance of the
signal estimation method. Next, we introduce a metric that considers both mixing
matrix estimation and source estimation in the performance evaluation.
For simplicity, we assume that a noisy BSS problem has two sources, s and u,
and n observations. Let the i-th channel observation xi be
xi = ais+ biu+ ni, (52)
where a1 and bi denote the unknown mixing coefficients, and ni is noise. The
proposed metric calculates the SNR of the scaled signal ais from xi as follows:
10 log10
a2i ||s||
2
||ais− aˆisˆ||2
, (53)
2For single channel source estimation, this is called signal-to-noise ratio (SNR).
15
source signals in Figure 2(c) were derived by the procedure described in Section
5.1.A and illustrated in Figure 1. The source signals and the mixing matrix of the
NCA algorithm are shown in Figures 2(f) and (b) respectively. Figures 2(g) and
(h) show the SINR and SSNR performance of our approach, and those of the DSS
and FastICA approaches, respectively. Note that FastICA’s performance was only
evaluated in a noise-free environment. In the top subfigure, the SINR values of
the NCA and FastICA approaches are similar, but the SSNR values of NCA are
obviously better in the bottom subfigure. This indicates that the sources estimated
by both methods are very similar, but FastICA’s mixing matrix is less accurate than
that of NCA. In all cases of noisy BSS, NCA outperforms DSS.
Figure 3 shows the under-deterministic case with three observation channels in
Figure 3(d), and four original source signals in Figure 3(e). Because the source
signals are narrow-band signals and the NSP algorithm is very effective in decom-
posing a signal comprised of narrow-band subcomponents, the initial source signals
(shown in Figure 3(c), and estimated as described in Subsection 5.1.A) are close to
our final results in Figure 3(f). FastICA recovers better source signals 1 and 3 than
our approach in a noise-free environment; as shown in the top subfigure of Figure
4; however, our SSNR values are better (as shown in the bottom subfigure). This
indicates that NCA’s mixing matrix estimation is superior to that of FastICA. For
noisy BSS, NCA usually obtains better results for SINR and SSNR measurements,
except for source signal 2 in SINR and source signal 3 in SSNR.
In the third case, shown in Figure 5(e), the original source signals are two wide-
band signals. The two observation signals (shown in subfigure (d)) were obtained
by mixing the source signals with the matrix (shown in subfigure (a)). The initial
source signals were estimated by Method B, described in Section 5.1 and illustrated
in Figure 5(c). The NCA results are shown in Figures 5(f). It is obvious that the
NCA modified the initial source signals substantially in order to derive the final
results, as shown by the respective SINR curves in the top subfigure of Figure 6.
Comparing the SINR and SSNR values of NCA and FastICA on the vertical axes
of the respective subfigures in Figure 6, we conclude that NCA achieves a better
estimation of the source signals and a better mixing matrix in noiseless cases. As
shown in Figure 6, on noisy BSS problem, NCA significantly outperforms DSS in
all cases of noise variance.
B. Real-life Data
Next, we compare the performances of NCA and FastICA on a set of real-life
17
are contained in the second and third source signals. In the C(SICA, S0) column
of the table, FastICA’s second source signal, SICA2, is similar to all the reference
signals. However, FastICA’s first and third source signals, SICA1 and SICA3, are not
similar to any reference signals because their C-values measured with the references
are small. Thus, the FastICA method finds two EEG signals (SICA1 and SICA3) and
one EOG signal (SICA2). Finally, the C(SICA, Sˆ) column shows that the conclusions
derived by FastICA and NCA are consistent because the EEG and EOG signals
derived by both methods have high C-values.
Table 1
C(Sˆ, S0) C(SICA, S0) C(SICA, Sˆ)
S01 S02 S01 S02 Sˆ1 Sˆ2 Sˆ3
Sˆ1 0.2081 0.0383 SICA1 0.1302 0.2179 SICA1 0.6681 0.2989 0.0859
Sˆ2 0.8471 0.6072 SICA2 0.6314 0.7562 SICA2 0.1062 0.7631 0.8518
Sˆ3 0.8006 0.7186 SICA3 0.0860 0.0123 SICA3 0.6887 0.3208 0.1701
6 Concluding Remarks
We have proposed a novel deterministic method called NCA for modeling the op-
erators and source signals to solve the noisy BSS problem. NCA is based on a
constrained optimization approach, which we believe is more adaptive for solving
the BSS problem with various a priori knowledge about the source signals. Theoret-
ically, we showed that the proposed model can resolve the permutation ambiguity in
the BSS problem, provided that the source signals are linearly independent. Numer-
ically, we demonstrated the efficacy of the NCA algorithm in a noisy environment
and on real-life EEG signals. In terms of separating EEG signals, the results of
NCA and FastICA are comparable.
References
[1] A. J. Bell and T. J. Sejnowski, ”An information-maximization approach to blind
separation and blind deconvolution,” Journal of Neural Computation, vol.7, Issue. 6,
pp.1129-1159, Nov. 1995.
[2] O. Yilmaz and S. Rickard, ”Blind separation of speech mixtures via time-frequency
masking,” IEEE Trans. on Signal Processing, vol.52, Issue.7, pp. 1830-1847, 2004.
19
[18] H. Attias, ”Independent factor analysis,” Neural Computation, vol. 11, No. 4, pp.
803-851, May 1999.
[19] P. R. Babu and S. Narasimhan, ”Multivariate techniques for preprocessing noisy data
for source separation using ICA,” International Journal of Advances in Engineering
Sciences and Applied Mathematics, vol. 4, Issue.1-2, pp.32-40, June 2012.
[20] M. Davies, ”Identifiability, subspace selection and noisy ICA,” Independent compo-
nent analysis and blind signal separation -Fifth International Conference, ICA 2004,
pp.152-159, 2004.
[21] Private communcations with Y. Deville and A. Hyva¨rinen.
[22] N. E. Huang, Z. Shen, S. R. Long, M. C. Wu, H. H. Shih, Q. Zheng, N. C. Yen, C. C.
Tung, and H. H. Liu, ”The empirical mode decomposition and the Hilbert spectrum
for nonlinear and non-stationary time series analysis,” Proceedings of the Royal Society
of London. Series A: Mathematical, Physical and Engineering Sciences, vol. 454, no.
1971, pp.903-995, 1998.
[23] S. L. Peng and W. L. Hwang, ”Null Space Pursuit: An operator-based Approach
to adaptive signal separation,” IEEE Trans. on Signal Processing, vol.58, no.5, pp.
2475-2483, 2010.
[24] P. Smaragdis, ”Blind separation of convolved mixtures in the frequency domain,”
Neurocomputing, vol. 22, No 1-3 pp.21-34, Nov 1998.
[25] A. Ciaramella and R. Tagliaferri, ”Separation of convolved mixtures in frequency
domain ICA,” International Mathematical Forum, vol.1, No. 16, pp.769-795, 2006.
[26] S. Vorobyov and A.Cichocki, ”Blind noise reduction for multisensory signals using
ICA and subspace filtering, with application to EEG analysis,” Biological Cybernetics,
vol. 86, Issue. 4, pp.293-303, 2002.
[27] A. Schlo¨gl, C. Keinrath, D. Zimmermann, R. Scherer, R. Leeb, and G. Pfurtscheller,
”A fully automated correction method of EOG artifacts in EEG recordings,” Clinical
Neurophusiology, 118, pp. 98-104, 2007.
[28] W. L. Hwang, Y. C. Lin, and J. Ho, ”Null Space Component Analysis for Noisy Blind
Source Separation,” Technical Report, Institute of Information Science, Academia
Sinica, TR-IIS-13-001, 2013.
[29] NSP codes in Matlab, Available:
http://mda.ia.ac.cn/English/publications/publications index.htm#2010
[30] FastICA package in Matlab, Available: http://research.ics.aalto.fi/ica/fastica/
[31] DSS package in Matlab, Available: http://www.cis.hut.fi/projects/dss/package/
[32] J. Sa¨rela¨ , H. Valpola, ”Denoising Source Separation,” Journal of Machine Learning
Research, vol.6, pp.233-272, 2005.
[33] A. T. Erdogan, ”A family of bounded component analysis algorithm,” IEEE ICASSP,
pp.1881-1884, March 2012.
21
(a) (b)
50 100 150 200 250 300 350 400
0
0.5
1
1.5
2
2.5
50 100 150 200 250 300 350 400
−0.4
−0.2
0
0.2
0.4
50 100 150 200 250 300 350 400
0
0.5
1
1.5
2
2.5
3
50 100 150 200 250 300 350 400
−0.5
0
0.5
1
1.5
50 100 150 200 250 300 350 400
−1
0
1
2
3
4
50 100 150 200 250 300 350 400
−1
−0.5
0
0.5
1
(c) (d) (e)
50 100 150 200 250 300 350 400
−1
0
1
2
3
4
50 100 150 200 250 300 350 400
−1
−0.5
0
0.5
1
0 1 2 3 4 5
x 10−3
−10
0
10
20
30
40
50
SI
NR
 (d
B)
Variance of noise
 
 
NCA source 1
NCA source 2
DSS source 1
DSS source 2
ICA source 1
ICA source 2
0 1 2 3 4 5
x 10−3
0
5
10
15
20
25
30
35
40
45
50
SS
NR
 (d
B)
Variance of noise
 
 
NCA source 1
NCA source 2
DSS source 1
DSS source 2
ICA source 1
ICA source 2
(f) (g) (h)
Figure 2: The separation of the mixtures of a chirp and a piecewise signal by the
NCA algorithm and the comparison of the performance of NCA, DSS, and FastICA
on the (noisy) BSS problem: (a) the original mixing matrix; (b) the estimated
mixing matrix; (c) the initial source signals; (d) the observation signals; (e) the
original source signals; and (f) the estimated source signals; (g) SINR performance
versus the noise variance; (h) SSNR performance versus the noise variance; the
root-mean-square errors for the estimated signal at top is 0.00006 and at bottom is
0.00007. The parameters for the NCA algorithm are: µ = 10−6, ǫ = 0.001, λ = 1,
and L = 2. The scores of FastICA for noiseless case are recorded on the vertical
axes. For all cases of noise variance, NCA outperforms DSS.
23
0 0.05 0.1 0.15 0.2 0.25 0.3 0.35
−2
0
2
4
6
8
10
12
14
SI
NR
 (d
B)
Variance of noise
 
 
NCA source 1
NCA source 2
NCA source 3
NCA source 4
DSS source 1
DSS source 2
DSS source 3
DSS source 4
ICA source 1
ICA source 2
ICA source 3
ICA source 4
0 0.05 0.1 0.15 0.2 0.25 0.3 0.35
−2
0
2
4
6
8
10
12
14
16
SS
NR
 (d
B)
Variance of noise
 
 
NCA source 1
NCA source 2
NCA source 3
NCA source 4
DSS source 1
DSS source 2
DSS source 3
DSS source 4
ICA source 1
ICA source 2
ICA source 3
ICA source 4
Figure 4: Comparison of the performance of NCA, DSS, and FastICA on the (noisy)
BSS problem in Figure 3. Top: SINR performance versus the noise variance. Bot-
tom: SSNR performance versus the noise variance. The scores of FastICA are
recorded on the vertical axes.
25
0 0.5 1 1.5 2 2.5 3
x 10−3
0
2
4
6
8
10
12
14
16
18
SI
NR
 (d
B)
Variance of noise
 
 
NCA source 1
NCA source 2
DSS source 1
DSS source 2
ICA source 1
ICA source 2
0 0.5 1 1.5 2 2.5 3
x 10−3
−2
0
2
4
6
8
10
12
14
16
18
SS
NR
 (d
B)
Variance of noise
 
 
NCA source 1
NCA source 2
DSS source 1
DSS source 2
ICA source 1
ICA source 2
Figure 6: Comparison of the performance of NCA, DSS, and FastICA on the (noisy)
BSS problem in Figure 5. Top: SINR performance versus the noise variance. Bot-
tom: SSNR performance versus the noise variance. The FastICA scores are recorded
on the vertical axes. Obviously, for noisy BSS, NCA outperforms DSS in all cases
of noise variance.
27
100 200 300 400 500 600 700 800 900 1000
−400
−200
0
200
100 200 300 400 500 600 700 800 900 1000
−400
−200
0
200
(a)
100 200 300 400 500 600 700 800 900 1000
−100
−50
0
50
100
100 200 300 400 500 600 700 800 900 1000
−100
−50
0
50
100
100 200 300 400 500 600 700 800 900 1000
−100
−50
0
50
100
100 200 300 400 500 600 700 800 900 1000
−100
−50
0
50
100
100 200 300 400 500 600 700 800 900 1000
−400
−200
0
200
100 200 300 400 500 600 700 800 900 1000
−400
−200
0
200
(b) (c)
Figure 8: Comparison of the source separation results of the NCA and FastICA
methods: (a) the EOG reference signals: S01 (top) and S02 (bottom); (b) the source
signals derived by FastICA: from top to bottom, the signals are SICA1, SICA2, and
SICA3; and (c) the source signals derived by NCA: from top to bottom, the signals
are Sˆ1, Sˆ2, and Sˆ3. The FastICA’s results are the averages of running the algorithm
20 times.
29
2. OUR PROPOSED METHOD
We first estimate our blur map by using the modified local
contrast prior and the guided filter. Second, we propose an
image deblurring method optimized with both discrete total
variation (TV) and Tikhonov-like regularizer. With this L1-2
optimization, we deblur the input image to obtain a set of de-
blurred images. In the final step, we adopt the scale selection
to select the deblurred pixels to fill in the final all-in-focus
output. The flowchart is show in Fig. 1 while the details are
introduced as below:
2.1. Blur map generation
For the latent edge signal l(x), we can model it as
l(x) = A · u(x) +B (1)
where u(x) is the step function, A is the amplitude, B is the
offset, and the edge is located at x = 0.
Suppose the edge signal l(x) suffers the out-of-focus blur,
we can approximate the blurry signal b(x) as the convolution:
b(x) = l(x)⊗ g(x, σ) (2)
where g(x, σ) is the Gaussian function with its standard devi-
ation σ:
g(x, σ) =
1√
2πσ
exp(−x
2
2σ
) (3)
In order to extract the blur scale σ, we reference the local
contrast prior LC(x) proposed in [3] and then modify it using
the edge properties derived from [5]. Following the previous
equations, we can obtain the gradient of the blurry edge and
then substitute it into LC(x). We have
∇b(x) = ∇(l(x)⊗ g(x, σ)) = A · g(x, σ) (4)
and
LC(x) =
max |∇b(x′)|
max b(x′)−min b(x′) (5)
≈ 1√
2πσ
max | exp(− x
2
2σ2
)| (6)
where x′ is the neighborhood of x.
Since max | exp(0)| = 1 at the edge location (x = 0), we
can easily adopt |∇b(x, y)| =
√
∇b2x +∇b2y from x- and y-
directions to obtain our 2-D blur map as follows:
σ(x, y) =
1√
2πLC(x, y)
=
0.3989
LC(x, y)
(7)
where LC(x, y) = max |∇b(x
′,y′)|
max b(x′,y′)−min b(x′,y′) and (x
′, y′) is the
neighborhood of (x, y) within a local window.
Moreover, in order to remove the ambiguity around edges
and the noise of our blur map, we adopt the original blur im-
age as the guided image to lead us to a better blur map after
guided filtering [9].
σ(x, y)← GF{b(x, y), σ(x, y), r, ǫ} (8)
2.2. Image deblurring with L1-2 optimization
After generating the blur map, we propose our image deblur-
ring method with L1-2 optimization to obtain the deblurred
images for all-in-focus image reconstruction.
Our image deblurring with L1-2 optimization adopts both
Tikhonov-like regularizer and TV regularizer. Consider b be
the blurry image, Gσ represent a Gaussian blurring operator
with blur scale σ, lσ be the corresponding deblurred n × n
gray-scale image, and r be additive noise.
b = Gσlσ + r (9)
Since b is the input blurry image, b is given. Suppose Gσ is
determined, we can recover lσ using our proposed model:
min
lσ
µ
2
‖Gσlσ−b‖22+α·
n2∑
i=1
‖Dilσ‖+ (1− α) ·
n2∑
i=1
‖Dilσ‖22
(10)
where Dilσ denotes the discrete gradient of lσ at pixel i,∑ ‖Dilσ‖ is the TV regularizer of lσ , and ∑ ‖Dilσ‖22 is the
Tikhonov-like regularizer. Besides, µ is a parameter, and
0 ≤ α ≤ 1.
Similar to Wang et al’s [10], we adopt variable-splitting
and penalty techniques for our L1-2 optimization. At each
pixel, we introduce an auxiliary variable wi to transfer Dilσ
outside the non-differentiable term ‖·‖ and penalize the differ-
ence between wi and Dilσ . We can yield the approximation
model as follows:
min
w,lσ
µ
2
‖Gσlσ − b‖
2
2
(11)
+ α · (
n2∑
i=1
‖wi‖+
β
2
n2∑
i=1
‖wi −Dilσ‖
2
2
) + (1− α) ·
n2∑
i=1
‖Dilσ‖
2
2
with a large enough penalty parameter β such that wi →
Dilσ and the minimization question described in equation
(11) is modified into a penalty function in degree (w, lσ).
We adopt an alternating minimization algorithm to min-
imize the penalty function with respect to either wi and lσ .
For a fixed lσ , only the middle two term related to wi are
separable with respect to wi, so minimizing equation (11) is
equivalent to solving the following equation:
min
wi
‖wi‖+ β
2
n2∑
i=1
‖wi −Dilσ‖22 (12)
for which the unique solver is given using matrix calculus by
the following formula:
wi = max{‖Dilσ‖ − 1
β
, 0} Dilσ‖Dilσ‖ (13)
where i = 1, 2, · · · , n2 and the convention (0/0) = 0. In
the other hand, for a fixed wi, we can easily minimize lσ by
solving the quadratic equation described in equation (14).
min
lσ
µ
2
‖Gσlσ−b‖
2
2+
αβ
2
n2∑
i=1
‖wi −Dilσ‖
2
2+(1−α)·
n2∑
i=1
‖Dilσ‖
2
2
(14)
(a) original (b) our blur map
(c) ours (d) Bae + Chan
Fig. 3. (a) The original ‘face’ image, (b) our blur map (dark
pixel suffers small blurring scale, and vice versa), (c) our all-
in-focus result, and (d) the result using Bae et al.’s blur map
and Chan et al.’s deconvtv.
5. REFERENCES
[1] O. Whyte, J. Sivic, A. Zisserman, and J. Ponce, “Non-uniform
deblurring for shaken images,” in CVPR, 2010, pp. 491–498.
[2] S. Bae and F. Durand, “Defocus magnification,” Comput.
Graph. Forum, vol. 26(3), pp. 571–579, 2007.
[3] Y.-W. Tai and M. Brown, “Single image defocus map estima-
tion using local contrast prior,” in ICIP, 2009, pp. 1797–1800.
[4] E. Kee, S. Paris, S. Chen, and J. Wang, “Modeling and remov-
ing spatially-varying optical blur,” in ICCP, 2011.
[5] S. Zhuo and T. Sim, “Defocus map estimation from a single
image,” Pattern Recognition, vol. 44(9), pp. 1852–1858, 2011.
[6] Q. Shan, J. Jia, and A. Agarwala, “High-quality motion de-
blurring from a single image,” ACM Trans. on Graphics, vol.
27(3), 2008.
[7] L. Xu and J. Jia, “Two-phase kernel estimation for robust mo-
tion deblurring,” in ECCV, 2010, pp. 157–170.
[8] S. Chan, R. Khoshabeh, K. Gibson, P. Gill, and T. Nguyen, “An
augmented lagrangian method for total variation video restora-
tion,” IEEE Trans. Image Processing, 2011.
[9] K. He, J. Sun, and X. Tang, “Guided image filtering,” in ECCV,
2010, pp. 1–14.
[10] Y. Wang, W. Yin J. Yang, and Y. Zhan, “A new alternating min-
imization algorithm for total variation image reconstruction,”
SIAM Journal on Imaging Sciences, vol. 1(3), pp. 248–272,
2008.
[11] T.F. Chan and C.-K. Wong, “Total variation blind deconvo-
lution,” IEEE Trans. on Image Processing, vol. 7, no. 3, pp.
370–375, 1998.
[12] J.M. Bioucas-Dias and M.A.T. Figueiredo, “A new twist:
Two-step iterative shrinkage/ thresholding algorithms for im-
age restoration,” IEEE Trans. Image Processing, vol. 16(12),
pp. 2992–3004, 2007.
(a) original (b) our blur map
(c) ours (d) Xu
Fig. 4. (a) The original ‘stone’ image, (b) our blur map, (b)
our all-in-focus result, and (d) Xu et al.’s result.
(a) original (b) ours (c) our blur map
(d) Shan (e) Xu (f) Bae + Chan
(g) (h) (i) (j) (k)
Fig. 5. (a) The original ‘building’ image, (b) our all-in-focus
result, (c) our blur map,(d) Shan et al.’s result [6], (e) Xu
et al.’s result, (f) the result using Bae et al.’s blur map and
Chan et al.’s deconvtv, and (g-h) are the magnified regions of
(a,b,d,e,f), respectively.
>
From papers@icassp2012.org Fri Dec 23 07:46:09 2011
Return-Path: <papers@icassp2012.org>
Received: from mx.iis.sinica.edu.tw (mx.iis.sinica.edu.tw [192.168.0.49])
by mail.iis.sinica.edu.tw (8.13.8/8.13.8) with ESMTP id pBMNvZO7025707
(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO);
Fri, 23 Dec 2011 07:57:35 +0800 (CST)
(envelope-from papers@icassp2012.org)
Received: from mail.securecms.com (mail.securecms.com [69.5.195.196])
by mx.iis.sinica.edu.tw (8.14.3/8.14.3) with ESMTP id pBMNwNGb081226;
Fri, 23 Dec 2011 07:58:24 +0800 (CST)
(envelope-from papers@icassp2012.org)
Received: from PICARD.federation.securecms.com (unknown [10.0.0.129])
by mail.securecms.com (Postfix) with ESMTP id 37E0311EF01;
Thu, 22 Dec 2011 17:46:20 -0600 (CST)
From: "ICASSP 2012 Notifications" <papers@icassp2012.org>
To: ctshen@iis.sinica.edu.tw, whwang@iis.sinica.edu.tw, pei@cc.ee.ntu.edu.tw
Reply-To: 
Subject: ICASSP 2012 Review Results for paper #1748
Date: Thu, 22 Dec 2011 17:46:09 -0600
Importance: High
X-Priority: 1
Message-ID: <20111222-17460992-14fc-0@PICARD.federation.securecms.com>
MIME-Version: 1.0
Content-Type: multipart/mixed;
boundary="--=5554C149F29D4CC480D8_E332_BFB8_38C1"
X-Greylist: Delayed for 00:10:48 by milter-greylist-4.2.3 (mx.iis.sinica.edu.tw [140.109.20.49]); Fri, 23 Dec 2011 07:58:24 +0800 (CST)
X-Spam-Score: -0.001 () SPF_PASS
X-Scanned-By: MIMEDefang 2.67 on 140.109.20.49
----=5554C149F29D4CC480D8_E332_BFB8_38C1
Content-Type: text/plain;charset="UTF-8"
Content-Transfer-Encoding: Quoted-Printable
Dear Chih-Tsung Shen, Wen-Liang Hwang, Soo-Chang Pei,
Paper ID: 1748
Title: 'Spatially-Varying Out-Of-Focus Image Deblurring With L1-2 Optim=
ization And A Guided Blur Map'
The ICASSP 2012 Technical Committee has completed the review process an=
d we are pleased to inform you that the manuscript listed above has bee=
n ACCEPTED for presentation in a session at the conference. Congratulat=
ions! (The format of the your will be announced soon. We would like to =
remark that, for ICASSP, poster and oral presentations have entirely th=
e same status.)=20
Information on many aspects of ICASSP 2012, including the venue, accomm=
odation, tourism, and visa requirements, are available on the conferenc=
e web site http://www.icassp2012.org; more information, including the c=
omplete technical program and the registration forms, will be available=
soon.
CRITICAL INFORMATION:=20
- Included at the end of this e-mail message are the reviewers' comme=
nts on your paper.  ICASSP has a PAPER UPDATE PERIOD during which paper=
s can be slightly modified to address reviewer comments.  Updated paper=
s must be uploaded to the ICASSP 2012 web site from today until 12:00 m=
idnight January 19, 2012 (Central US Time).  Please be reminded that yo=
u CANNOT change the title of the paper, change the authors or author or=
der of the paper, or make significant text changes to the body of the o=
riginal reviewed paper.  We reserve the option to use the accepted vers=
ion of your paper if we feel that the updated version differs substanti=
ally from what the reviewers accepted.  The revised paper is maximum 4 =
pages, double-column, following the style in the Author Kit.
- At least one author MUST BE REGISTERED for the conference at a non-=
student rate by January 26, 2012 (each full registration can cover up t=
o 4 papers).  Failure to have such registration will result in removal =
of the paper from the Technical Program.  In about two weeks, you will =
receive an e-mail announcing the opening of the registration website.
- Additionally, note that papers which are not presented at the confe=
rence will be excluded from the official proceedings and will not appea=
r on IEEE Xplore.  It is therefore very important that at least one aut=
hor of this paper attend the conference to present the work.
In the case that any special A/V equipment is required for presentation=
please inform the conference secretariat through email: papers@icassp2=
012.org.
The IEEE Signal Processing Society (SPS) is pleased to provide travel g=
rants on a highly competitive basis to student and non-student authors =
from low-income countries.  Only a limited number of grants are availab=
頁 1 / 3
2012/4/25file:///C:/Users/CTShen/AppData/Local/Temp/Low/DLVBIDHN.htm
2. Nevertheless, a good paper.
Reference to Prior Work: References adequate
-----
Importance/Relevance: Of sufficient interest
Novelty/Originality: Moderately original
Technical Correctness: Probably correct
Experimental Validation: Limited but convincing
Clarity of Presentation: Difficult to read
Comment on Clarity of Presentation:=20
English should be improved in the final version if submission is accept=
ed.
Reference to Prior Work: References adequate
General Comments to Authors:=20
Authors propose a method to remove out-of-focus blur using a synthesis =
of ideas from methods cited in the paper and they provide a good compar=
ison with existing methods. The methods are presented in an understanda=
ble way though the English should be improved in the final version if t=
he submission is accepted, e.g. first paragraph in Intro has terms like=
=E2=80=9Cgrantee=E2=80=9D (for guarantee?)  and =E2=80=9Cmotion blurry=
image=E2=80=9D .
-----
----=5554C149F29D4CC480D8_E332_BFB8_38C1--
頁 3 / 3
2012/4/25file:///C:/Users/CTShen/AppData/Local/Temp/Low/DLVBIDHN.htm
100年度專題研究計畫研究成果彙整表 
計畫主持人：黃文良 計畫編號：100-2221-E-001-017- 
計畫名稱：虛無空間算子的訊號處理:多通道訊號的分離,去噪,及運算子的學習 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 1 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 1 1 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 1 1 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 1 1 100%  
博士生 1 1 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
