Abstract
This project considers the relay subset selection problem in a two-way amplify-and-
forward relay network, where each user is equipped with multiple antennas and each
relay is equipped with a single antenna. In a two-way channel, two users exchange data
with each other using a relay subset. With the optimal relay subset selection scheme,
the system can reduce the hardware burden while preserving the diversity benefit. How-
ever, the optimal relay subset selection algorithm requires an exhaustive search of all
possible combinations to determine the optimum subset in order to achieve the maxi-
mum sum-rate. Thus, this results in high computational complexity. In order to reduce
the computational load while still maximizing the achievable rate, a cross-entropy (CE)
method is introduced to search for the optimal relay subset. Simulation results indicate
that the proposed CE method can guarantee a result that is within 98% of the optimum
sum-rate obtained by the exhaustive search method with low computational complexity.
Keywords: Cross-entropy method, relay subset selection, sum-rate, two-way
channel.
ii
表目次
4.1 Complexity comparisons between the CE algorithm and the ES method. . 9
iv
1. 計畫的緣由與目的
Cooperative relaying scheme is a very compelling technique due to its various ad-
vantages such as cell coverage extension and throughput improvement [1, 2]. In wireless
relay networks, relays are allowed to collaborate with each other to assist the transmission
from a source to a destination. In order to provide higher spectral efficiency, the two-way
relay channel has been proposed to replace the conventional one-way relaying protocol as
a promising protocol for a wireless cooperative relaying network.
In the two-way relay channel, two users communicate with each other through multi-
ple relays; thus, each user acts as a source and a destination [2]. To improve the transmis-
sion quality, the most intuitive approach is to involve as many relays as possible. However,
the main drawbacks of this approach include the difficulty in synchronizing transmissions
from multiple disparate relays and the increase in transmission power increases as the
number of relays increases.
The relay selection scheme is a feasible solution for the reduction of synchronization
complexity and the transmission power at relays while, at the same time, preserving
the diversity benefit [3]. In this scheme, only the best relay subset is used, while the
remaining relays are not employed. Thus, the number of required relays is reduced. The
relay selection scheme aims to find the optimal relay subset that maximizes the sum-
rate. Some relay subset selection algorithms have recently been proposed [3,4]. However,
these schemes have focused either on single-input single-output (SISO) one-way relaying
protocol or on SISO two-way relaying protocol. This project considered the relay subset
selection problem in a two-way amplify-and-forward relay network, where each user is
equipped with multiple antennas and each relay is equipped with a single antenna. Focus
was given to multiple-input multiple-output (MIMO) two-way relay network, and the
optimal relay subset selection for the concerned scenario was not yet considered.
With perfect channel state information, the optimal relay subset selection problem
of the concerned scenario is transformed into a particular combinatorial optimization
problem which is a non-convex optimization concern. The optimal solution of this com-
binatorial optimization problem is to perform an exhaustive search over all combinations.
The complexity of optimal relay subset selection problem turns out to be
(
R
Rs
)
, which is a
potential problem especially for large relays, where R is the number of available relays, Rs
is the number of selected relays, and
(
a
b
)
denotes the binomial coefficient a!/ [b! (a− b)!].
Inspired by the success of the Cross-Entropy (CE) method [6] in solving complicated,
large-scale combinatorial optimization problems efficiently, we propose the application of
the CE method for searching the optimal relay subset in an MIMO two-way relay network.
Simulation results indicate that the proposed CE method can guarantee a result that is
within 98% of the optimum sum-rate obtained by the exhaustive search method with low
computational complexity.
1
the relays receive. In the second phase, relays are scheduled to transmit, while both User
1 and User 2 receive. Third, both User 1 and User 2 have perfect knowledge of all the
channel state information1.
Based on the above-mentioned assumptions, the signals received by the relays in the
first phase can be described as
r = Fx1 + Gx2 + n, (2.1)
where r = [r1 r2 . . . rR]
T ∈CR×1 is the received vector, in which ri is the incoming signal
of the ith relay, and (·)T denotes transposition; F ∈CR×M and G ∈CR×M are the channel
matrices from User 1 to all R relays and from User 2 to all R relays, respectively; and
x1 and x2 are the transmitted signals from User 1 and User 2, respectively. In this case,
it was also assumed that the signal vectors x1 ∈ CM×1 and x2 ∈ CM×1 are circularly
symmetric complex Gaussian with E{x†1x1} = α1/M and E{x†2x2} = α2/M , respectively,
where (·)† denotes transpose conjugate, E {·} indicates the expectation operator, and α1
and α2 are the signal-to-noise ratio (SNR) of the User 1-relay link and the SNR of the
User 2-relay link, respectively. The term n = [n1 n2 . . . nR]
T ∈CR×1 is a noise vector, in
which ni is an additive complex Gaussian noise with zero mean and unit variance at the
ith relay.
In the second phase, only a subset of relays for processing the incoming signals and
forwarding them to User 1 and User 2 is selected. Before the received signal ri is forwarded
by the ith relay to User 1 and User 2, it should be weighted by a normalization factor2,
$i. This is done to satisfy the power constraint of each relay, βi, e.g., |$iri|2 ≤ βi, where
$i can be expressed as
$i =
√
βi
α1
M
‖fi‖22 + α2M ‖gi‖22 + 1
, (2.2)
where fi ∈C1×M and gi ∈C1×M are the channel vectors from User 1 to the ith relay and
from User 2 to the ith relay, respectively. In addition, it was assumed that the channels
remained constant during the two phases, as was done in [5]. In this case, the signal
received by User 1 and User 2 can be written as{
y1 = F
†Φ (ωq) WFx1 + F†Φ (ωq) WGx2 + F†Φ (ωq) Wn + z1
y2 = G
†Φ (ωq) WFx1 + G†Φ (ωq) WGx2 + G†Φ (ωq) Wn + z2
, (2.3)
where W = diag ($1, $2, · · · , $R) is the weight matrix; z1 ∈CR×1 and z2 ∈CR×1 are the
white complex Gaussian noise vectors with E{z1z†1} =E{z2z†2} = I; ωq = [ω1 ω2 . . . ωR],
ωi ∈ {0, 1}, is a binary relay selection vector, whose element ωi = 1 if the ith relay is
selected, and ωi = 0 if it is not; and Φ (ωq) = diag (ω1, ω2, · · · , ωR) is an R×R diagonal
matrix.
1Similar to most works on two-way relay channels, we have assumed that both users have perfect
knowledge of all the CSIs. These CSIs can be obtained, for example, from the method developed in [7].
2It should be noted that the sum-rate can be improved significantly if phase compensation mechanism
and appropriate power allocation strategy are performed at the relays. However, it is very impractical
to assume that the phase coherence among the relays is established. This is because small variations in
the location of the mobile relay nodes lead to large phase changes immediately. As a result, phase will
be difficult to track. For this reason, this project only considers the simplest power allocation strategy
at the relays, in which we assume that each relay is operable at two different power levels: zero and
the predetermined maximum allowed power. In this case, the considered problem becomes a problem of
knowing how to select the cooperating relays.
3
3. 研究方法
The CE method [6] is an iterative algorithm, and each iteration for the optimal
solution ω∗ of (2.6) involves the following two iterative phases:
1) Generate Ns random samples ω
(1)
q , . . . ,ω
(Ns)
q with respect to a probability density
function (pdf) f (ωq; p), where p = [p1, . . . , pR] is the probability vector whose
entries pi indicate the probability of the ith relay to be chosen and f (ωq; p) denotes
the R-dimensional Bernoulli probability density functions, which can be described
as
f (ωq; p) =
R∏
i=1
p
1i(ωq)
i (1− pi)1−1i(ωq) , (3.1)
where the indicator function 1i(ωq) ∈ {0, 1} indicates whether the ith element of ωq
(the ith relay) is selected; if the ith element of ωq is selected, 1i(ωq) will be set to
1. In addition, each element of ωq is modeled as an independent Bernoulli random
variable with the probability distribution P (1i (ωq) = 1)=1 − P (1i (ωq) = 0)= pi
for i = 1, . . . , R.
2) Update the parameters p using I
(
ω
(1)
q
)
, . . ., I
(
ω
(Ns)
q
)
and some scoring mechanism
in order to produce better samples in the next iteration.
The CE method iteratively optimizes p, which will eventually generate a nearly optimal
solution ω∗ that leads to high sum-rate.
The first step of the CE method is to turn the optimization problem in (2.6) into a
meaningful estimation problem. This estimation problem can be then determined from
an associated stochastic problem as represented by:
Pp (I (ωq) ≥ γ) =
∑
ωq∈Ω
1{I(ωq)≥γ}f (ωq; p) , (3.2)
where Pp is the probability measure that the score is greater than some value γ, ωq is
the random variable produced by the pdf f (·; p); and 1{I(ωq)≥γ} is the indicator function,
whose value is 1 if I (ωq) ≥ γ and 0 otherwise. In order to solve (3.2), the CE method
iteratively updates the probability vector p so that most samples generated by f (ωq; p)
satisfy I (ωq) ≥ γ. By iteratively improving γ, f (ωq; p) eventually converges to an
optimum pdf f (ωq; p
∗) that generates ω∗ with a minimum number of samples, and γ
then converges to γ∗. In each iteration, (3.2) can be estimated using a log-likelihood
estimator with reference to p as in [6]:
p̂∗ = arg max
p
1
Ns
Ns∑
l=1
1{
I
(
ω(l)q
)
≥γ
} ln f (ω(l)q ; p) . (3.3)
5
• Step 5: Calculate the parameter p(t) according to
p
(t)
i =
∑Ns
l=1 1
{
I
(
ω(l,t)q
)
≥r(t)
}1i
(
ω
(l,t)
q
)
∑Ns
l=1 1
{
I
(
ω(l,t)q
)
≥r(t)
} . (3.7)
• Step 6: Update the parameter p(t) smoothly via
p(t) = λ× p(t) + (1− λ)× p(t−1), (3.8)
where λ is the smoothing parameter, with 0 < λ ≤ 1.
• Step 7: Repeat Step 2 to Step 6 for t := t + 1 until the stopping criterion is met.
Note that the stopping criterion is the predefined number of iterations.
Note that convergence proof of the CE method can be found in the appendix of [9].
Next, let us consider the complexity issue of the proposed CE algorithm. Since the
CE method is a population-based search method, the total number of function evaluations
needed to determine the suboptimal solutions with low complexity can therefore be fixed.
In this case, the complexity of the CE method can be expressed in terms of the total
number of function evaluations. Accordingly, the total number of function evaluations for
the CE method is the number of samples Ns times the maximum number of iterations
t (i.e., O(CE) = Ns × t). On the other hand, the total number of function evaluations
required for the exhaustive search (ES) method to find the optimal subset is O(ES) =(
R
Rs
)
.
7
Table 4.1: Complexity comparisons between the CE algorithm and the ES method.
(R,Rs) Ns t O(CE) O(ES) ϑ O(ES)O(CE)
(14, 4) 40 3 120 1001 98% 8.3417
(14, 5) 40 3 120 2002 98% 16.6833
(14, 6) 40 3 120 3003 98% 25.0250
(14, 7) 40 3 120 3432 98% 28.6000
(14, 8) 40 3 120 3003 98% 25.0250
(14, 9) 40 3 120 2002 99% 16.6833
(14, 10) 40 3 120 1001 99% 8.3417
(14, 11) 20 3 60 364 99% 6.0667
(14, 12) 15 3 45 91 99% 2.0222
(16, 8) 50 3 150 12870 98% 85.8000
(18, 9) 80 3 240 48620 98% 202.5833
(20, 10) 140 3 420 184756 98% 439.8952
determined how the sum-rate of various algorithms are affected by a variable number of
selected relays, Rs, in the interval from 4 to 12. In this case, the antenna configurations for
two users are also both M = 4 and the computation loops required for the proposed CE
and ES methods are given in Table 4.1. Another performance metric, ϑ , was also defined
to indicate the convergence ratio of the sum-rate obtained by the proposed CE method
compared to that obtained by the ES method. The sum-rate results against the number
of selected relays for different schemes are shown in Fig. 4.2. Based on Fig. 4.2 and Table
4.1, it can be observed that, as expected, the sum-rate improved with an increase in the
number of relays for the random search method and the worst-case selection. In addition,
when the number of selected relays is more than or equal to Rs = 6, ES and CE methods
surprisingly provided higher sum-rate than that achieved by the all-transmission scheme.
This is because the relays mainly provided the diversity benefit, while noises at all relays
are also amplified and superimposed at the destination nodes (two user sides). Since the
selected relays have achieved the margin of the diversity gain, the additional relays seem
to waste energy and also degrade the system sum-rate. This characteristic confirmed the
requirement of the relay subset selection in MIMO two-way networks. Furthermore, and
most importantly, the convergence ratio, ϑ, and the complexity ratio, O(ES)O(CE) , indicate
that the available sum-rate obtained by the CE algorithm converges to within 98% of the
optimal result implemented by the ES algorithm with low complexity.
As shown in Fig. 4.2, the achievable rate is an unimodal function in terms of Rs.
Based on this information, we attempt to solve the joint optimization of Rs and the
selected relay set problem using the proposed relay selection algorithm and the golden
section search [10]. The new proposed scheme is an iterative algorithm that can be
described as follows. At the very beginning, we use two numbers Rs,min and Rs,max
to represent the minimum number of selected relay and the maximum number of se-
lected relay, respectively. Next, the golden section method computes the midpoints
R
(t)
s,1 = d(Rs,min +Rs,max) /2e and R(t)s,2 = d(Rs,1 +Rs,max) /2e, where the super-index of
Rs denotes the iteration index and d·e denotes the ceiling operation. We then employ
the CE algorithm to search the optimal relay subset for Rs,min, Rs,max, R
(t)
s,1, and R
(t)
s,2
to obtain the corresponding sum-rates Ice (Rs,min), Ice (Rs,max), Ice
(
R
(t)
s,1
)
, and Ice
(
R
(t)
s,2
)
,
respectively. If Ice
(
R
(t)
s,1
)
≥ Ice
(
R
(t)
s,2
)
, then the golden section method sets Rs,max equal
9
1 2 3
0.95
0.955
0.96
0.965
0.97
0.975
0.98
0.985
0.99
Number of iterations (t)
C
on
ve
rg
en
ce
 ra
tio
 ( 
ϑ )
(R,Rs)=(10,5)
(R,Rs)=(14,7)
 
Figure 4.3: Convergence ratio (ϑ) against number of iterations (t).
11
6. 成果自評
本計畫執行結果與原計畫書之規劃大致上相符 、 大部分預定達成的目標也都有順利達成 。
預期達成目標包括系統模型的建立 、 文獻的收集研讀 、 演算法的發展 、 理論的分析 、 電腦系統
的模擬與數值分析 、 人員的訓練 、 和經驗的傳承等等皆有非常好的成效 。 總體而言 , 本計畫執
行上十分順利 、 而且結果豐碩 , 相關執行成果已發表在水準相當高的 IEEE 國際期刊上 。 所
發表刊物名稱 、 卷期及出版日期如下 :
◦ Jung-Chieh Chen∗ and Chao-Kai Wen, “Near-optimal relay subset selection for two-way amplify-and-forward
MIMO relaying systems,” IEEE Transactions on Wireless Communications, vol. 10, no. 1, pp. 37-42, January
2011. (SCI, EI, Impact Factor = 2.152, Rank = 7/78)
13
出席國際學術會議心得報告 
                                                             
計畫編號 NSC99-2221-E-017-007 
計畫名稱 雙向傳遞之多輸入多輸出合作式通訊系統的中繼站選擇策略研究 
出國人員姓名 
服務機關及職稱 
陳榮杰 
國立高雄師範大學光電與通訊工程學系／副教授 
會議時間地點 
 2010年 12月 06日 ～ 2010年 12月 08日 中國‧成都 
 2011年 05月 20日 ～ 2011年 05月 28日 捷克‧布拉格 
會議名稱 
 2010 International Symposium on Intelligent Signal Processing & Communications Systems 
 2011 IEEE International Conference on Acoustics, Speech, and Signal Processing 
發表論文題目 
 Asymptotic Mutual Information of Amplify-and-Forward MIMO Relay Channel with Rician Fading 
 On the Ergodic Capacity of Jointly-Correlated Rician Fading MIMO Channels 
 
一、參加會議經過 
 
 2010 International Symposium on Intelligent Signal Processing and Communications Systems： 
此行參加的會議為：國際智慧訊號處理暨通訊系統研討會（International Symposium on Intelligent 
Signal Processing and Communications Systems，ISPACS 2010），主辦地點在中國成都。與會人士
涵蓋相當多來自產官學之背景。本次大會議程主要包含四項主軸：第四代無線通訊、網路世代
的訊號科技、沉浸式全面通訊及多媒體資訊搜尋等議題。本次會議使我獲益最多是其中一場的
Keynote Speech。這場 Keynote Speech 演講者是目前任教於加州大學 Riverside 分校的 Yingbo 
Hua教授（為 IEEE Fellow），演講的主題是 Subspace於無線通訊上的應用。Subspace的概念主
要是利用線性代數的觀點，將訊號分成訊號子空間及雜訊子空間，如此我們便可將訊號由雜訊
中分解出來，這種方法主要的概念是將訊號只送往訊號空間送，藉以增加降低能量的損失。而
且，Subspace也可以應用於做預編碼的設計，也正是我目前的研究重點之一。 
 
   
圖一、 參加 ISPACS 2010研討會所拍攝照片。    
 
 
Jung-Chieh Chen 
寄件者: chaokaiwen@gmail.com 代理 Chao-Kai Wen [chaokai.wen@mail.nsysu.edu.tw]
寄件日期: 2010年9月5日星期日 上午 9:34
收件者: Jung-Chieh Chen
主旨: Fwd: ISPACS2010: Decision Notification
第 1 頁，共 2 頁
2011/10/22
 
 
---------- Forwarded message ---------- 
From: ISPACS2010 <ispacs2010@uestc.edu.cn> 
Date: 2010/9/5 
Subject: ISPACS2010: Decision Notification 
To: chaokai.wen@mail.nsysu.edu.tw 
 
 
Dear Chao-Kai Wen, 
 
Thank you for your submission to ISPACS2010. 
We are pleased to inform you that your paper number 1401, entitled Asymptotic Mutual Information 
of Amplify-and-Forward MIMO Relay Channel with Rician Fading 
has been accepted for presentation at The 2010 International Symposium on Intelligent Signal 
Processing and Communications Systems, to be held in Chengdu, China from 06 Dec. - 08 Dec. 
2010. We look forward to your participation and presentation at ISPACS 2010. Papers went through 
a rigorous reviewing process. Each paper was reviewed by at least two program committee members.
 
Remember that you must adhere to the following requirements: 
1. In order to guarantee inclusion in the conference program one author must be registered by 
October 14, 2010 23:59, the pre-registration deadline. 
2. Your completed IEEE copyright form must be received by October 03, 2010 23:59. The form and 
instructions can be found at ISPACS2010 AUthor's Kit. 
3. Full papers are limited to 4 pages (IEEE double column format). Your camera-ready paper must 
be submitted no later than October 3, 2010. Please refer to the author kit from ISPACS2010 for 
further instructions. Due to publication deadlines, no time extensions will be granted. 
 
Please carefully take into account the enclosed comments by the reviewers when preparing the 
camera-ready version. It is incumbent upon you to do so. 
 
Congratulations on having your paper accepted! 
We look forward to seeing you in ChengDu, China. 
 
Sincerely, 
Lap Pui Chau, Licheng Jiao, & Yiming Pi 
Technical Program Co-Chairs 
The 2010 International Symposium on Intelligent Signal Processing and Communications Systems 
ispacs2010@uestc.edu.cn 
========================================================================
First reviewer's review: 
1. This paper considered the analysis of the mutual information (MI) for spatially correlated MIMO- 
AF (Amplify-and-forward) relay (two-hop) channel with Rician fading. 2. Based on the above-
mentioned model, the authors derived the analytical expression for the asymptyotic MI. The results 
is novel and has not been discussed in the literatures, and it is significant in practical applications for 
designing of capacity achieving input covariance matrix and the relay amplifying matrix.  
201O International Symposium on Intelligent Signal Processing and Communication Systems (lSPACS 2010) December 6-8,2010 
Asymptotic Mutual Information of 
Amplify-and-Forward MIMO Relay Channel with 
Rician Fading 
Chao-Kai Wen 
Institute of Comm. Eng. 
Jung-Chieh Chen Pangan Ting 
National Sun Yat-sen University 
Kaohsiung, Taiwan 804, R.O.C. 
E-mail: ckwen@ieee.org 
Dept. of Optoelectronics & Comm. Eng. 
National Kaohsiung Normal University 
Kaohsiung, Taiwan, R.O.C. 
E-mail: jc_chen@ieee.org 
Industrial Technology Research Institute 
Hsinchu, Taiwan, R.O.C. 
E-mail: pating@itri.org.tw 
Abstract-In this paper, we derive the asymptotic mutual in­
formation expression for the amplify-and-forward (AF) muItiple­
input multiple-output (MIMO) two-hop relay channels, where 
the source terminal (ST), relay terminal (RT) and destination 
terminal (DT) are equipped with a number of antennas and there 
is a direct link between the ST and DT. The analysis is based on 
the Kronecker correlated Rician fading model. The considered 
channel model is fairly general and the derived asymptotic mu­
tual information result can be degenerated to several previously 
published results. Numerical simulation results show that, even 
for a moderate number of antennas at each link, the derived 
mutual information expression provides undistinguishable results 
as the average mutual information. 
Keywords - Asymptotic analysis, cooperation, MIMO antennas, 
relay channel. 
I. INTRODUCTION 
Wireless multiple-input multiple-output (MIMO) antenna 
systems together with relay techniques has recently been 
recognized as an attractive solution to improve the quality of 
wireless channels. Cooperative strategies can also be viewed as 
a generalization of conventional relay communication systems. 
Motivated by this, considerable attention has been paid on 
understanding the achievable rates of relay channels under 
various settings [1-7]. 
As illustrated in Fig. 1, we consider a two hop relay 
link that consists of a source terminal (ST), a relay terminal 
(RT), and a destination terminal (DT). The ST and the RT 
simultaneously on the same frequency band, and each RT 
employs an amplify-and-forward (AF) relaying transmission 
scheme. Moreover, we assumed that the DT have perfect 
channel state information (CSI) while the ST and RT do not 
have the SCI. Deriving analytical expressions for the average 
mutual information of finite-size MIMO relay channels is very 
difficult. In most cases, particularly with spatial correlation, 
the analytical expressions are unsolvable. For recent progress 
please refer to [2]. Asymptotic techniques (or large-system 
approaches) is an alternative to circumvent the mathematical 
difficulties and have been widely used. Based on the large­
system approaches, a few results have been obtained for 
MIMO relay channels, e.g., [3-7]. 
In this context, [3] addressed the capacity scaling law of 
MIMO relay systems in the large-system limit. Later, [4] 
978-1-4244-7371-7/10/$26.00 ©2010 IEEE 
� Transmission at the first slot -----� Transmission at the second slot 
Relay G 
Source Destination 
Fig. I. A MIMO relay communication system. 
derived the asymptotic mean and variance of the mutual 
information for the MIMO relay Kronecker Rayleigh fading 
channels without a direct link between the ST and DT. More 
recently, the asymptotic mutual information for the MIMO 
relay channel including a direct link has been derived in 
[6]. For multi-level AF relay networks, an asymptotic mutual 
information expression was also presented in [7] where the 
noise at the relays was ignored. To summarize, nevertheless, 
all of these prior works were based on the MIMO channels 
without a LOS component, or the MIMO channel being in 
Rayleigh fading. The need to consider LOS is apparent, as 
the channel in typical outdoor environments is likely to have 
an LOS path between two ends. 
To the best of our knowledge, there appears to be no 
asymptotic mutual information results which apply for MIMO 
relay channel with Rician fading. Motivated by this, this paper 
intend to complement these earlier results [4, 6], dealing with 
the case of Rayleigh fading. Numerical simulation results 
show that the asymptotic mutual information obtained by the 
proposed derivation provides reliable results over a wide range 
of SNR values, even for the antenna configuration for the ST 
and the DT is only one. In regard to the derivation approach, 
our analysis is based on the replica method. Recently, the 
replica method was successfully introduced by Tanaka [8] and 
Moustakas et. al. [9], respectively, to deal with the asymptotic 
2010 International Symposium on Intelligent Signal Processing and Communication Systems (lSPACS 2010) December 6-8,2010 
Deriving analytical expressions for the average mutual in­
formation of finite-size MIMO relay channels is difficult and 
for some, particularly with spatial correlation, is unsolvable. 
We circumvent this difficulty by considering the large-system 
regime where {M, N, Mr} approach to infinity at fixed ratios 
{ Z. ' I¥:t }. It should be noted that the asymptotic expression of 
the second term of (10) has been obtained in previous works, 
e.g., [9, 17] but the difficulty lies in the asymptotic analysis of 
the first term of (10). 
Proposition 1: The mutual information of the Kronecker 
Rician fading MIMO relay channel, J, can be asymptotically 
approximated by 
I = log det (I + EP) + log det (I + <I>c,2(1 + CIRl)) 
2 
+ log det (I + c2R2) + log det (I + coRo) - L Ml cl q 
l =O 
- log det (I + <I>C,3) - log det (I + c3R2) + Mrc3'>3, (11) 
where 
<I>C,2 
<I>C,3 
Gt ('>2T2 + H� (I + c2R2)-1 H2) G, (14) 
, J 
� �2 
Gt ('>3T2 + H� (I + c3R2)-1 H2) G. 
, J 
(15) 
The quantities � � {'>l hl and e � {cl hil satisfy the fixed­
point equations (16) and (17) (see top of next page). 
Proof' Due to the space limitation, the proof is omitted. 
• 
The first two lines of (11) is corresponding to the asymptotic 
approximation of the first term of (10), and the last line of (11) 
is associated with the second term of (10). Next, consider 
a Gaussian vector channel with deterministic (not random) 
channel matrix vE ECMXM, output Z ECM, and 
(18) 
where U ECM is a standard complex Gaussian random vector. 
Clearly, the term log det (I + EP) in (11) corresponds to 
the mutual information between x and z. Note that, E is a 
linear combination of the two matrices Eo and El which we 
refer them, respectively, as the equivalent channel matrices 
of the direct link and the relay (source-relay-destination) link. 
Finally, we note that Propositions 1 provides a unified formula 
that encompasses many known results [4, 6, 9, 17]. 
IV. NUMERICAL RESULT S 
For the simulations, we have assumed that the spatial 
correlation is generated from an uniform linear array with 
7 
The Wllues III the two sides of n link reprcscnts (0,,01) 
at the transmitter <Iud receiver, respectively. 
JY� 
.o-/�� 
��
5>
/� �
�O- -
-
-10 -5 o 5 10 
PI (dB) 
. 9. _ ' - ' ..0- . _._0- . _._ 0 
M� =2l1f = 2N=8 
max. relative error = 1.2% 
9- ___ 0. - - - 9_ - __ 0 
JIIr =2M = 2N=4 
max. relative error = 2.9% 
Mr =2/11 = 2N=2 
max. I'clntivc error = ;1.0% 
15 20 25 30 
Fig. 2. The average mutual information versus PI for spatially correlated 
MIMO relay systems with Mr = 2M = 2N. The solid lines correspond 
to the results for analytical approximations, and the circles mark the exact 
mutual information obtained by Monte-Carlo simulations. 
half wavelength spacing in a wireless scenario where there is 
one propagation path cluster with Gaussian power azimuthal 
distribution having mean angle of Ol and root-mean-square 
spread of 8l . Specifically, we take the correlation matrix with 
elements [9] 
[Tdm,n (or [Rdm,n) /180 d<jJ j7r(m-n)sin(!I.J)-(4>-91)2 
= --- e 2°1 
-180 .,.hrr81 
(19) 
with m, n being the indices of antennas. In addition, we use the 
subscripts T and R, respectively, to refer to the corresponding 
values at the transmit and receive sides. 
All our analysis is based on the assumption that all the 
dimensions of the channel matrices are large. In this subsec­
tion, we provide simulation results showing that the asymptotic 
regime is reached for relative small number of antennas. 
For the simulations provided we assume: The channel mean 
components {Hl hl are assumed to have all constant entries. 
In addition, 10 = 0 and 11 = 12 = 1 are adopted. 
We plot the mutual information results of MIMO relay 
channels versus PI for Mr = 2M = 2N = 2,4,8 in 
Fig. 2, with the spatially correlation parameters specified in 
the figures. In this figure, we show 1) the average mutual 
information J which is obtained by 10,000 Monte Carlo 
simulations, 2) the asymptotic mutual information I, and 3) 
their maximum relative difference (in percentage). We see that 
even for the case with only one antenna at the source and the 
DT, the asymptotic result is reasonable, and for two antennas, 
it becomes nearly exact. 
ACKNOWLEDGEMENT 
The work of C.-K. Wen was supported in part by the Na­
tional Science Council (NSC) of Taiwan under Grant NSC 98-
1Jung-Chieh Chen
 寄件者: ICASSP 2011 Notifications [papers@icassp2011.com]
寄件日期: 2011年1月18日星期二 上午 4:42
收件者: chaokaiwen@gmail.com; jinshi@seu.edu.cn; kwong@ee.ucl.ac.uk; jcchen@nknucc.nknu.edu.tw; pating@itri.org.tw
主旨: ICASSP 2011 Review Results for paper #1452
重要性: 高
Dear Chao-Kai Wen, Shi Jin, Kai-Kit Wong, Jung-Chieh Chen, Pangan Ting,
Paper ID: 1452
Title: 'On the Ergodic Capacity of Jointly-Correlated Rician Fading MIMO Channels'
The ICASSP 2011 Technical Committee has completed the review process and we are pleased to inform you that the manuscript listed above has been 
ACCEPTED for presentation in a poster session at the conference.  Congratulations!  (We would like to remark that, for ICASSP, poster and oral 
presentations have entirely the same status.)
The presentation of your paper is scheduled on Wednesday, May 25, 09:30 - 11:30.
Information on many aspects of ICASSP 2011, including the venue, accommodation, tourism, and visa requirements, are available on the conference 
web site http://www.icassp2011.com; more information, including the complete technical program and the registration forms, will be available soon.
CRITICAL INFORMATION: 
  - Included at the end of this e-mail message are the reviewers' comments on your paper.  ICASSP has a PAPER UPDATE PERIOD during which 
papers can be slightly modified to address reviewer comments.  Updated papers must be uploaded to the ICASSP 2011 web site from today until 12:00 
midnight February 20, 2011 (Central US Time).  Please be reminded that you CANNOT change the title of the paper, change the authors or author order 
of the paper, or make significant text changes to the body of the original reviewed paper.  We reserve the option to use the accepted version of your 
paper if we feel that the updated version differs substantially from what the reviewers accepted.  The revised paper is maximum 4 pages, double-
column, following the style in the Author Kit.
  - At least one author MUST BE REGISTERED for the conference at a non-student rate by March 13, 2011 (each full registration can cover up to 4 
papers).  Failure to have such registration will result in removal of the paper from the Technical Program.  In about two weeks, you will receive an e-
mail announcing the opening of the registration website.
  - Additionally, note that papers which are not presented at the conference will be excluded from the official proceedings and will not appear on IEEE 
Xplore.  It is therefore very important that at least one author of this paper attend the conference to present the work.
In the case that any special A/V equipment is required for presentation please inform the conference secretariat through email: papers@icassp2011.com.
The IEEE Signal Processing Society (SPS) is pleased to provide travel grants on a highly competitive basis to student and non-student authors from 
low-income countries.  Only a limited number of grants are available.  The grants will be awarded to applicants who have a genuine need for support, 
and the paper quality will be taken into consideration.  SPS membership is required at the time when the application is made.  Please visit the travel 
grant application website http://www.signalprocessingsociety.org/travel-grant-application/ for more information.
Finally, for those who will need a visa, please note that the IEEE has strict guidelines that invitation letters for visa purposes can only be sent to people 
who have completed the registration process.  Further information regarding invitation letters is posted on the website, see 
http://www.icassp2011.com/en/general-info/good-to-know/passport-and-visa-requirements.  Please note that the visa application procedure can take up 
to two months.
Again, congratulations; we look forward to welcoming you in Prague, Czech Republic, in May.
Sincerely,
Alle-Jan van der Veen and Jonathon Chambers ICASSP 2011 Technical Program Co-Chairs
---- Comments from the Reviewers: ----
Importance/Relevance: Of sufficient interest
Novelty/Originality: Moderately original
Technical Correctness: Definitely correct
3__________ Information from ESET NOD32 Antivirus, version of virus signature database 5795 (20110117) __________
The message was checked by ESET NOD32 Antivirus.
http://www.eset.com
II. SYSTEM MODEL AND PROBLEM FORMULATION
We consider a single-user MIMO system with M transmit
antennas and N receive antennas. The received signal at the
base station can be written in vector form as
y = Hx+ u, (1)
where y ∈ CN is the received signal vector, H ∈ CN×M is
the channel matrix with the (i, j)-th element representing the
channel fading between the m-th transmit antenna and the n-
th receive antenna, x ∈ CM is the transmitted symbol vector
with E[xx†] = P, and u ∈ CN is the complex Gaussian noise
vector with zero mean and a covariance matrix of I.
For the MIMO channel, the jointly-correlated (or the Weich-
selberger) MIMO channel in [8] is considered, and therefore
the channel matrix H is given by
H = H˜+ H¯ = Ur(G˜W)U†t + H¯, (2)
in which Ur = [ur,1 ur,2 · · ·ur,N ] ∈ CN×N and Ut =
[ut,1 ut,2 · · ·ut,M ] ∈ CM×M are deterministic matrices (not
necessarily unitary matrices), G˜ ∈ CN×M is a deterministic
matrix with real-valued nonnegative elements, W ∈ CN×M
denotes the channel components that are independent and iden-
tically distributed (i.i.d.) standard (zero-mean unit-variance)
complex Gaussian entries, and H¯ ∈ CN×M is a deterministic
matrix corresponding to the line-of-sight (LOS) component of
the channel. Note that rather than being restricted to unitary
matrices as in [8], Ur and Ut are any deterministic matrices.
Let us deﬁne the coupling matrix
G  G˜ G˜ (3)
with the (n,m)-th element, gn,m. The name of the “coupling
matrix” is due to the fact that the (n,m)-th element of G
speciﬁes the mean amount of energy that is coupled from ur,n
to ut,m (and vice versa) [8]. Without loss of generality, we
assume that G and H¯ are normalized in such a way that⎧⎨
⎩
tr(UtU
†
t) = M, tr(UrU
†
r) = N,
1
NM
tr(G) =
1
κ+ 1
ρ,
1
NM
tr(H¯H¯†) =
κ
κ+ 1
ρ,
(4)
where κ denotes the Rice factor, and ρ is the SNR of the
system. The generality of this model can be seen by the fact
that, as κ → ∞, (2) converges to a deterministic channel while
if κ = 0, (2) models a Rayleigh fading channel.
If H is perfectly known at the receiver and x is Gaussian
with the covariance matrix, P, the average mutual information
between x and y is given by [2]
Ie(P) = EH [I(P)] . (5)
where I(P)  log det
(
I+HPH†
)
. In (5), the averaging
process is taken over the period which is long enough to cover
the whole fading process of W, but is short enough that Ut,
Ur, G and H¯ can be considered time-invariant. Clearly, the
input covariance matrix P is designed based on the long term
realization of the channel. Assume that the average power of
the transmitted symbol is constrained by tr(P) ≤ M . As such,
the ergodic capacity of the problem is given by
max
P0
Ie(P) s.t. tr(P) ≤ M. (6)
As P ∈ CM×M is a Hermitian matrix, the required opti-
mization involves M2 real-valued variables (M real diagonal
entries and M(M−1)2 complex entries in the upper triangle).
Let the eigenvalue decomposition of P be P = UpΛpU†p.
Solving P that maximizes I(P) thus involves ﬁnding of Up
and Λp. There are a few special cases that the eigenvectors
of the optimal P are understood analytically. For these cases,
the remaining challenge is to determine the eigenvalues of P,
which, nevertheless, usually requires numerical optimization
techniques (e.g., statistical programming [17]). For example,
in [5], the Vu-Paulraj algorithm was developed based on the
barrier method [16, Chap. 11] where the related gradient and
Hessian are approximated by Monte-Carlo methods.
Apparently, the drawback of statistical programming is the
computational complexity requirement (and hence long exe-
cution time), since it requires Monte-Carlo methods for each
iteration. In the next section (Section III), we ﬁrst derive an
asymptotic expression of (5) and then use this new expression
to obtain the asymptotic-optimal covariance matrix.
III. ASYMPTOTIC MUTUAL INFORMATION
To obtain the results, we consider the large-system regime
where both M and N approach to inﬁnity at ﬁxed ratios M/N
and employ the replica method [9, 12, 13].
Proposition 1: Given Gaussian input distributions with co-
variance P, the average mutual information of the Weichsel-
berger MIMO channel (5) can be approximated by
Ie(P) = log det (I+ΞP) + log det (I+R)− γTGψ, (7)
where
Ξ  T+ H¯† (I+R)−1 H¯ ∈ CM×M (8)
with
T  Utdiag(γTG)U†t ∈ CM×M , (9)
R  Urdiag(Gψ)U†r ∈ CN×N . (10)
In (9) and (10), the quantities γ  [γ1 · · · γN ]T and ψ 
[ψ1 · · ·ψN ]T satisfy the following ﬁxed-point equations{
γn = u
†
r,n (I+Π)
−1
ur,n,
ψm = u
†
t,mP (I+ΞP)
−1
ut,m
(11)
with Π  R+ H¯(I+T)−1H¯†.
Proof : See the appendix. 
Proposition 2: The mutual information I(P) converges in
distribution to a Gaussian distribution with asymptotic mean
Ie(P) and asymptotic variance
φ = det
(
I−
[
Φ1 Φ2
Φ3 Φ4
])
(12)
3225
DQDO\WLFDO
VLPXODWLRQ
˧ 

˧ 

       







)UH
TX
HQ
F\
       









)UH
TX
HQ
F\
615 G%˧ 
615 G%˧ 
Fig. 1. The average mutual information versus SNR for the MIMO channel
with M = 3 and N = 2.
˧  
˧  
FDSDFLW\DFKLHYLQJLQSXWV
9X3DXOUDMDOJRULWKP
3UHVHQWHGDOJRULWKP
 
Fig. 2. The ergodic capacity versus SNR for the MIMO channel withM = 3
and N = 2.
With the deﬁnition of Z(y,H), we have
Ey,H [Z
r(y,H)] = EH,X
[∫
Dy
r∏
α=0
e−‖y−Hx(α)‖2
]
,
(20)
where x(α) denotes the αth replica signal vector with dis-
tribution p(x), X 
[
x(0) x(1) · · · x(r)]. After some tedious
algebraic manipulations (see [12, 13] for detail), the saddle-
point asymptotic approximation of F is then given by
F = − lim
r→0
∂
∂r
max
Q
min
Q˜
T (r)(Q, Q˜), (21)
where
T (r)(Q, Q˜) = − log det (I+QΣ⊗R)−N log(r + 1)
−
N∑
n=1
M∑
m=1
Tr
(
Q˜n,mQn,m
)
+ log EX
[
e
∑M
m=1 Tr(
∑N
n=1 gn,mQ˜n,mX
†TmX)
×evec(V¯)†[(Q⊗R)−1((QΣ⊗R+I)−1−I)]vec(V¯)
]
.
and Q  {Qn,m}∀n,m and Q˜  {Q˜n,m}∀n,m. The saddle-
points can be obtained from the point of zero gradient with re-
spect toQ and Q˜. To avoid searching over all possibleQ and
Q˜, we adopt the replica symmetry assumption, i.e., Qn,m =
qn,m11
† + (cn,m − qn,m)I, and Q˜n,m = q˜n,m11† + (c˜n,m −
q˜n,m)I. The parameters {ck,n,m, qk,n,m, c˜k,n,m, q˜k,n,m} are
determined by equating the partial derivatives of F to zeros.
Inserting these results, we have the replica symmetric solution
of F at r = 0 and then ﬁnally obtain Proposition 1.
REFERENCES
[1] G. J. Foschini, and M. J. Gans, “On limits of wireless communications in
a fading environment when using multiple antennas,” Kluwer Academic
Publishers–Wireless Per. Commun., pp. 311–335, 1998.
[2] I˙. E. Telatar, “Capacity of multi-antenna Gaussian channel,” Euro. Trans.
Telecom., vol. 10, pp. 585–595, 1999.
[3] D. Shiu, G. J. Foschini, M. J. Gans, and J. M. Kahn, “Fading correlation
and its effect on the capacity of multi-element antenna systems,” IEEE
Trans. Commun., vol. 48, pp. 502–513, Mar. 2000.
[4] A. M. Tulino and S. Verdu´, Random Matrix Theory and Wireless
Communications, Foundations and Trends in Commun. and Info. Theory,
vol. 1, no. 1, pp. 1–182, 2004.
[5] M. Vu and A. Paulraj, “Capacity optimization for Rician correlated
MIMO wireless channels,” in Proc. Asilomar Conf. Sig., Sys. and Comp.,
pp. 133–138, Nov. 2005.
[6] H. O¨zcelik, M. Herdin, W. Weichselberger, J. Wallace, and E. Bonek,
“Deﬁciencies of the ‘Kronecker’ MIMO radio channel model,” Electron.
Lett., vol. 39, pp. 1209–1210, Aug. 2003.
[7] A. M. Sayeed, “Deconstructing multi-antenna fading channels,” IEEE
Trans. Sig. Proc., vol. 50, pp. 2563–2579, Oct. 2002.
[8] W. Weichselberger, M. Herdin, H. Ozcelik, and E. Bonek, “A stochastic
MIMO channel model with joint correlation of both link ends,” IEEE
Trans. Wireless Commun., vol. 5, pp. 90–100, Jan. 2006.
[9] A. L. Moustakas, S. Simon, and A. M. Sengupta, “MIMO capacity
through correlated channels in the presence of correlated interfers and
noise: A (not so) large N analysis,” IEEE Trans. Info. Theory, vol. 49,
pp. 2545–2561, Oct. 2003.
[10] X. Gao, B. Jiang, X. Li, A. B. Gershman, and M. R. McKay, “Statistical
eigenmode transmission over jointly-correlated MIMO channels,” IEEE
Trans. Info. Theory, vol. 55, pp. 3735–3750, Aug. 2009.
[11] J. Dumont, S. Lasaulce, W. Hachem, Ph. Loubaton and J. Najim, “On
the capacity achieving covariance matrix for Rician MIMO channels: An
asymptotic approach,” to appear in IEEE Trans. Info. Theory, 2010.
[12] T. Tanaka, “A statistical-mechanics approach to large-system analysis of
CDMA MUDs,” IEEE Trans. Info. Theory, vol. 48, pp. 2888–2910, Nov.
2002.
[13] C.-K. Wen, and K.-K. Wong, “Asymptotic analysis of spatially correlated
MIMO multiple-access channels with arbitrary signaling inputs for joint
and separate decoding,” IEEE Trans. Info. Theory, vol. 53, pp. 252–268,
Jan. 2007.
[14] J. Hoydis, J. Najim, R. Couillet, and M. Debbah, “Fluctuations of the
mutual information in large distributed antenna systems with colored
noise,” in Proc. Allerton Conf., Urbana-Champaing, Illinois, USA, 2010.
[15] W. Hachem, Ph. Loubaton, and J. Najim, “Deterministic equivalents for
certain functionals of large random matrices,” Ann. App. Prob., vol.17,
pp. 875–930, 2007.
[16] S. Boy and L. Vandenberghe, Convex Optimization. Cambridge, UK:
Cambridge University Press, 2004.
[17] K. Marti, Stochastic Optimization Methods, Springer, 2005.
3227
99 年度專題研究計畫研究成果彙整表 
計畫主持人：陳榮杰 計畫編號：99-2221-E-017-007- 
計畫名稱：雙向傳遞之多輸入多輸出合作式通訊系統的中繼站選擇策略研究 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 1 1 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 1 1 100%  
研究報告/技術報告 0 0 100%  
研討會論文 1 1 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
