frequency of chirp are below the resonance, near the 
resonance, or above the resonance； due to the 
nonlinear resonance characteristic of microbubble. 
Therefore, compression filter designed base on square 
law model is limited by pressure, magnitude and 
bandwidth of the transmitted signal.  
In this project, we propose a novel method, named 
frequency-shifted pulse inversion technique. Two 
chirp pulses are transmitted with different center 
frequencies. One echo of them is frequency-shift to 
make the fundamental frequency components be 
cancelled. By this way, the 2nd harmonic bandwidth 
can be increased to improve axial resolution. Then 
the 2nd harmonic is further compressed by an adaptive 
pulse compression filter and thereby get higher 
resolution than conventional techniques. Hopefully, 
the high resolution B-mode system can be build for 
the diagnosis of cardiac diseases. This project will 
focus on the following issues : 
 
1. Theoretical analysis for the frequency-shifted 
pulse inversion technique.  
2. Simulation study on the frequency-shifted pulse 
inversion technique  
3. Performance evaluation by differential bandwidth 
selection.  
4. Optimal parameter designed of frequency shift size 
for bandwidth combining  
5. Adaptive compression filter designed 
 
英文關鍵詞： Ultrasound imaging, Coded excitation, Pulse 
compression, Ultrasound contrast agent 
 
2 
 
中文摘要 
 
編碼激發-脈衝壓縮技術常被用在成像的方法上，此技術能成功的提高訊號的訊雜比及穿透深度。
超音波對比劑的強烈回音能使組織下的微血管較清楚的被偵測到，如此一來，對比劑的非線性
特性常被用在各種超音波成像方法上。 
在Borsboom 2005 研究中，利用微氣泡二次諧波的頻寬為基頻訊號頻寬的兩倍為基礎來建立脈衝
壓縮濾波器，但由於氣泡獨特的共振特性，對每個頻率的頻率響應皆不一致，且Chirp訊號通常
為一寬頻帶訊號，其頻帶上變動的頻率對於氣泡的頻率響應結果也皆不一致，因此以 square law 
model 的觀念來設計脈衝壓縮濾波器的效能，會受到發射訊號聲壓強度及頻寬大小限制。 
我們提出一新方法： 頻移之脈衝反相合頻法。傳統脈衝反相技術利用發射一組相位相反的正負
Chirp訊號，希望將收到的回波訊號相加，消去線性部分而保留非線性部分。我們則利用兩組不
同頻率的Chirp訊號來當作激發訊號，使其中一組回波訊號做頻率位移後，將兩組訊號做處理相
減，進而消除基頻成份，保留非線性成分，且使得二次諧波成分訊號頻寬加大，再利用Adaptive 
Compression Filter 來做二次諧波脈衝壓縮 增強其訊號解析度。將建立較高解析度的B-mode影
像，以期將來使用於心臟內科的臨床診斷。 
我們將整個研究分成以下部分來進行研究  1. 頻移之脈衝反相合頻技術理論分析 2. 頻移之脈衝
反相合頻法技術模擬研究 3.基於氣泡共振特性對於不同頻帶選取之頻寬合成技術效能頻估 4. 
頻率位移量的最佳參數分析設計 5.可適性脈衝壓縮濾波器設計 
 
關鍵詞: 超音波成像、編碼激發、脈衝壓縮、超音波對比劑。 
 
 
 
 
 
 
 
 
 
 
4 
 
論文發表: 
 
期刊論文： 
1. S.K. Tsao and J. Tsao, “Tissue attenuation coefficient estimation using bubble second harmonics with 
frequency diversity,” Journal of Biomedical Science and Engineering, Vol. 5, No. 5, pp. 276 -284, 
2012. (NSC100-2221-E-002-063). 
 
研討會論文： 
1. Sheng-Kai Tsao, Shi Ping Chen and Jenho Tsao, "Tissue Attenuation Coefficient Estimation using 
Bubble Second Harmonics with Frequency Diversity," 6th International Conference on 
Bioinformatics and Biomedical Engineering (iCBBE 2012), Shanghai, China, May 17-20, pp. 640 – 
643, 2012. 
2. Sheng-Kai Tsao and Jenho Tsao, "Estimation of the Noise Caused Bias of a Tissue Attenuation 
Coefficient Estimator by Fixed Range and Frequency," 6th International Conference on 
Bioinformatics and Biomedical Engineering (iCBBE 2012), Shanghai, China, May 17-20, pp. 792 – 
795, 2012. 
3. Sheng-Kai Tsao and Jenho Tsao, “An Unbiased Tissue Attenuation Coefficient Estimator Using 
Microbubble Echoes with Harmonic Ratio Compensation” 2012 International Conference on 
Biomedical Engineering and Biotechnology (ICBEB 2012), Macau, China, May 28 ~ 30, pp.727-730, 
2012 
4. Ming-Huang Chen and Jenho Tsao, “Optimal Transmission Frequency Selection Base on Scattering 
Cross Section for Ultrasound Contrast Harmonic Imaging,” 2012 International Conference on 
Biomedical Engineering and Biotechnology (ICBEB 2012), Macau, China, May 28 ~ 30, pp. 856-859, 
2012. 
 
 
 
 
 
 
6 
 
前半部L(t)可以跟前面一樣視為包絡線,如figure3中左邊的虛線,figure4中右邊的實線.L(t)的用處是
將figure 4的時域sidelobe壓低 
 
經過和頻後,時域訊號長度縮短,促使時域解析度提高.所L(t)對訊號長度的限制是解析度提高必須
考量的參數。 
諧波合頻問題 
原因來自於探頭頻率響應、組織衰減，可能導致某些二倍頻無法產生。 
2 研究方法與實驗結果 
研究方法 
發射不同分頻寬合頻訊號測試發射訊號頻寬限制。 
發射不同分頻寬補償合頻訊號與未補償合頻訊號做比較。 
模擬研究之流程圖: 
 
 
 
 
 
 
 
 
 
 
 
 
 
8 
 
分頻寬10%的諧波合頻與脈衝反相 
 
Figure 2:兩個 echo 諧波和頻結果 
 
Figure 3:pulse inversion 實驗結果 
 由figure5,figure6 可看出和頻訊號結果較佳.以和頻後時域來看,較少的時域沒有artifact,且訊號
波形雜訊較低,SNR相當高. 
10 
 
 
3 B-mode成像比較 
實驗儀器 
三維雕刻機(步進馬達) 
成像方式分別為 
基頻成像、脈衝反相技術成像、諧波合頻成像 
發射訊號 
中心頻 3MHz 分頻寬 30% 
探頭 
5MHz(無聚焦) 
使用仿體為 
吉利 T+矽膠片製成 
吉利 T+棉花+銅片製成 
 
 
分頻寬30%三種影像比較 
 
J. Biomedical Science and Engineering, 2012, 5, 276-284                                                     JBiSE 
doi:10.4236/jbise.2012.55035 Published Online May 2012 (http://www.SciRP.org/journal/jbise/) 
Published Online May 2012 in SciRes. http://www.scirp.org/journal/jbise 
Tissue attenuation coefficient estimation using bubble 
harmonics with frequency diversity* 
Sheng-Kai Tsao1, Jenho Tsao2 
 
Graduate Institute of Communication Engineering, National Taiwan University, Taipei, Taiwan 
Email: 1a0928819058@yahoo.com.tw, 2tsaor215@cc.ee.ntu.edu.tw 
 
Received 2 February 2012; revised 28 February 2012; accepted 21 March 2012 
ABSTRACT 
In a previous work, we developed a consistent TAC 
(tissue attenuation coefficient) estimator using bubble 
echoes. Based on temporal averaging, we can improve 
the estimation precision of TAC for the tissue bounded 
between two vessels. In this paper, we extend it to use 
frequency diversity for saving interrogation time by 
transmit multiple narrowband signals in each pulse. 
At first, we analyze the deterministic and stochastic 
properties of the diversity signals. Then a multi-band 
maximum likelihood diversity combiner is developed. 
We also provide diversity gains of different diversity 
estimators for comparing their estimation efficiencies. 
In the experimental work, we design a simplified 
phantom for demonstrating the performance of the 
purposed estimator. It is shown that the TAC estima-
tion rate can be improved by frequency diversity. The 
convergence rates of single-band and multi-band es-
timators are compared and it is shown that the multi- 
band estimator is more consistent than the single- 
band estimator.  
 
Keywords: Tissue Characterization; Ultrasound Contrast 
Agent; Tissue Attenuation Coefficient 
1. INTRODUCTION 
Ultrasound attenuation is the energy loss of signal after 
propagating through a medium. For the medium of soft 
tissue, Kuc assumed that its attenuation coefficient is 
constant over the entire sample volume and the back- 
scattering is a Gaussian random process [1]. In such case, 
he presented a spatial averaging method to estimate tis- 
sue attenuation coefficient (TAC), which is estimated by 
the power difference of tissue echoes based on the fol- 
lowing equation [2]: 
   1 2attenuation 10log 10logdB P f P f fd    (1) 
where  1P f  and  2P f  are the PSD’s of echo sig- 
nals at two different ranges, d is the depth of isonified 
tissue, f is the signal frequency and   is the TAC. By 
spatial averaging, its estimation precision is bounded by 
the available number of spatial samples; thus the estima- 
tion error will be large, if the sampling area is small. 
In our previews work [3], as shown in Figure 1, we 
proposed a method to estimate TAC of the separating 
tissue between two vessels using the second harmonic of 
microbubble, which is a single-band estimator. Assum- 
ing that the distribution of microbubbles inside the ves- 
sels are identical then we can estimate the TAC using Q 
independent samples of the logarithmic power as: 
   1 21 ˆ ˆˆ 10log 10log4 P f P ffL         (2) 
where L is the tissue length. The TAC estimate can be 
statistically decomposed to be: 
1
1 1ˆ
4
Q
q
qfL Q
 

             (3) 
where q  is the random error defined in [3] and rewrit- 
ten in Eq.12. This estimator has a variance which can be 
reduced by the factor of 1 Q . Since the Q sample are 
collected in time, the advantages are that the sample 
volume (spatial resolution) can be a small region between 
two vessels and the TAC can be estimated precisely 
 
Transducer
Skin 
Tissue 
Vessel
Gate 1 Gate 2
 
Figure 1. The schematic diagram for estimating tissue 
attenuation coefficient using echoes from two range gates. 
*This work was supported by the National Science Council, Taipei,
Taiwan (NSC100-2221-E-002-063). 
S.-K. Tsao, J. Tsao / J. Biomedical Science and Engineering 5 (2012) 276-284 278 
transmitting frequencies, 1f  and 2f . A reasonable 
choice is to keep second-harmonic group above all 
transmitting frequencies, then it requires   1 22 p pf B f B   22 cf , which is equivalent to requiring that c p f Bf   . This requirement can be 
simplified to be  2c pf Bf   or  1 2 pf f B   . 
In summary, the frequency spacing must be constrained 
by , otherwise the bubble fre- 
quencies may collide the transmitting frequencies. 
 12Bp f f B    2 p
Based on the above constraint, it can be found that the 
difference frequency f f    is located below the 
transmitting bands and far away from the second har- 
monic group. This situation make its signal to noise ratio 
(SNR) be another concern in frequency spacing selection, 
since the bubble frequencies are located on the two ends 
of the transducer passband, where system gains are low. 
To have more bubble frequencies for diversity, a rea- 
sonable choice is to select a set of 1f , 2f  and f  
such that the second harmonic group can be close to the 
center frequency of transducer. This choice will push the 
difference frequency f f    close to direct current 
(DC), where SNR is low and thus it must be discarded. 
In addition, based on Eq.3, the TAC estimation error is 
inversely proportion to frequency; this is in favor of the 
second harmonic group also. Therefore, in this paper, we 
choose only the second harmonic group to be the diver-
sity frequencies. 
2.2. Independency of Diversity Signals 
To evaluate the performance of the proposed TAC diver- 
sity estimator, the stochastic properties of the diversity 
signals must be known. Using the notations defined in [3] 
and referring to Figure 1, for the frequency 
2 2k c ,f f k f    the bubble echo attenuated by a tissue 
(i.e. echo from vessel 2) with length L is: 
     22 ,  0,1,2k k kX t L f Y t k        (5) 
where   2 2 2022 , 10 kf LkL f    is the tissue attenuation 
factor at 2kf  and  is the pre-attenuated bubble 
echo (i.e. bubble echo in vessel 1): 
 kY t
      2 2 2
1
cos 2π 2
N
k j k k
j
Y t A f f t 

    j  (6) 
where 2 jA  is the scattering coefficient and j  is the 
time delay of the j-th microbubble. 2 jA  is a random 
bubble response, which depends on bubble radius 0  
and other physical constants.  j L   j , where c
jL    is the length between transducer and the j-th mi- 
crobubble in a range-gated vessel and c is the sound 
speed. 
Before checking the independency of the diversity 
signals, their correlation property is derived first. The 
correlation of the two pre-attenuated signals,  kY t  and 
 Y t
         
         
         
E Y
, is: 
       
   
   
   
2 2 2 2
1
2 2 2 2
1
                 cos 4 2
                 
                  cos 2
N
k j k j
j
c j
N
j k j
j
j
t Y t E A f A f
E k t
E A f A f
E k t
  
 


       
        
    
       


 



 
(7) 
Since the time delay j  is uniformly distributed in 
blood flow, its associated phase will be a uniform distri- 
bution in  0,2π
k
. In such case,  would 
be zero for 
   kE Y t Y t    , which results in that each two fre- 
quency bands are uncorrelated. When the number of 
bubble N is large,  tk  will be a zero mean Gaussian 
random process, then we can summarize that 
Y  kY t  and  Y t  are independent to each other. By the same way, 
we can further show that k  X t  and  X t  are inde- 
pendent also, since attenuation is not a random factor. 
3. DIVERSITY METHOD 
Based on the TAC estimator developed in [3], there are 
different places to do diversity combing. Corresponding 
to the stages of signal processing, three possible diver- 
sity combining methods can be developed. The diversity 
signals may be combined at 1) power, 2) difference of 
logarithmic power or 3) TAC of each single-band esti- 
mate. Their differences are in combining method and 
available diversity gain. The combining method depends 
primarily on the statistical properties of the three quanti- 
ties above. After analyzing the joint distribution of the 
multiple-frequency observations, the proposed combin- 
ing method will be given in 3.1. 
For the first combining method, let  be power of 
the pre-attenuated signal  and  be power 
of the attenuated signal 
 1P k2P k kY t k

X t  at the frequency 2kf , 
they can be expressed explicitly as: 
    21 1
1
N
j k
j
P k A f

  2             (8) 
      22 2 2 2
1
2 , ;  0,1, 2
N
k j k
j
P k L f A f k

     (9) 
Based on the results in [4], the samples of  1P k  and  2P k  follow chi-square distribution with two degree of 
freedom. In this case, joint distribution of the ratio of  1P k  to  2P k  is asymmetric and non-central. Since 
the joint distributions are frequency dependent, it’s dif- 
ficult to develop a TAC estimator. This is why estimator 
for this method is not developed. 
Copyright © 2012 SciRes.                                                                                JBiSE 
S.-K. Tsao, J. Tsao / J. Biomedical Science and Engineering 5 (2012) 276-284 280 
diversity gain of the multi-band ML estimator and 2) 
comparison of the difference between the equal-diversity 
estimator Eq.23 and the multi-band ML estimator Eq.18. 
In the previous work [3], we showed that the variance 
of the single-band TAC estimator Eq.2 is: 
   
2
2
2
ˆvar
4 cf L M


           (21) 
Its value is frequency dependent. Since the distribution 
of Eq.3 is Gaussian, the single-band TAC estimator is a 
ML estimator also. For quantifying the performance of 
the multi-band ML estimator, its diversity gain is defined 
to be the inverse of the ratio of its variance Eq.19 to 
Eq.21 as:  
2
0
1
2ML k c
k fG
f
                  (22) 
This result shows that larger frequency spacing ( f ) 
will yield larger diversity gain. 
For the third combining method in Section 3, it is the 
equal-diversity estimator: 
2
0
1ˆ
3
ˆE k
k
 

                 (23) 
where ˆk  is the single-band TAC estimator Eq.3 for 
frequency = 2k . Comparing to the multi-band MLE of 
Eq.18, the equal-diversity estimator is easy to implement. 
This estimator can be rewritten as: 
f
2
0 1 2
1ˆ
3 2
mM
k
E
k m k
D
f ML

 
             (24) 
Its variance is equivalent to the average variance of the 
single-band estimator given in Eq.3. The diversity gain 
of the equal-diversity estimator can be found to be: 
1122
0
9 1
2EQ k c
k fG
f


             
            (25) 
To compare these two diversity strategies, we can 
calculate the ratio their diversity gains given in Eq.22 
and Eq.25: 
2 22 2
0 0
1 1 1
9 2 2ML EQ k c c
k f fG
f f


 
         
    (26) 
The value of ML EQ  is very close to 1.0, if G   
4. EXPERIMENT 
A simple in vitro experimental system is built to verify 
the estimation efficiency that can be improved by fre-
quency diversity. In this experiment, we like to 1) check 
the correlation of diversity signals and different pulse M 
2) check the consistency and the convergence rate with 
and without diversity 3) compare the diversity gain of the 
multi-band MLE to the single-band estimator and 4) 
compare efficiency of the multi-band MLE to the equal- 
diversity combiner. 
4.1. Experimental Setup 
The block diagram of the experimental system is pre- 
sented in Figure 2. Figure 3 present the phantom of 
Figure 2, which is made by jelly T (Juliana, Taiwan) 
because this material has low acoustic attenuation. The 
phantom has two flows to produce two gated signals as 
given in Figure 1. The diameter of the flows is 5 mm. 
Since the phantom is soft and may be dissolved by flow, 
to maintain the structure the thickness of the tubes is set 
to be 1 mm. To avoid shadowing effect of flow 1, these 
two flows are positioned at different elevations within  
 
Function 
Generator 
Power 
Amplifier  
PC 
Pulse  
Receiver 
T/R 
switch V380 Phantom
Microbubble 
Source 
 
Figure 2. The block diagram of experimental system. 
 
Liver 
1cm 
Flow2 
5mm 
Flow1 
5mm 
Jelly T 
V380 
1.2cm  2 ck f f  is sufficiently small or the number of di- 
versity frequencies is large. Such case happens when 
bandwidth of the diversity signal is small, then perform- 
ance of the ML combiner approaches that of the equal- 
diversity combiner. 
Figure 3. The phantom is made by Jelly T, which 
has low acoustic impedance. A fresh pork liver used 
for estimating TAC. The contrast agent used is 
Sonovue. An intravenous drip is used to simulate 
microbubbles in blood flow. 
Copyright © 2012 SciRes.                                                                                JBiSE 
S.-K. Tsao, J. Tsao / J. Biomedical Science and Engineering 5 (2012) 276-284 282 
self-correlation function is much greater than cross-cor- 
relation function. The oscillation of cross-correlation is 
due to difference frequency components in Eq.7. Figure 
6 presents the correlation functions of the three fre-
quency components. In this figure, it demonstrates that 
the intensity correlation can be reduced by increasing 
frequency spacing (i.e., difference frequency).  
Before we show that the TAC estimator Eq.18 can 
converge efficiently, firstly we show the converge prop-
erty using the single-band estimator Eq.3. The experi-
mental data were partitioned to have different number of 
pulses M for estimating the TAC. Figure 7(a) presents 
the estimated TAC values using the second harmonic 
frequency fc = 3 MHz. For M < 2000, there are multiple 
sub-sets of data for estimating the TAC. The different 
estimates are presents as scatter diagrams for M = 5, 25, 
50, 100, 500, 1000, 1500 and 2000 in Figure 7(a). The 
estimate values are spread between –0.5 and 1.6 
dB cm MHz  when M = 5, finally ˆ  converges to 
0.4890 dB cm MHz  when M is increased to 2000. In 
this case, we prove that Eq.20 is attained when pulse 
number M is increased.  
To check 2), Figure 7(b) presents the TAC estimation 
values of the multi-band MLE Eq.18 using data of 3, 3.5 
and 4 MHz. In this figure, the estimation values converge 
as the number of pulses M increases. This estimator 
converges consistently as M increased to 2000. The con-
verged value is 0.504 dB cm MHz , this value is very 
close to the single-band estimation value. This shows 
that Eq.18 is also an unbiased estimator. Compare to 
Figure 7(a), the variation of multi-band MLE at each M 
is smaller than that of single-band estimator, this is be-
cause that each pulse has three samples in multi-band 
MLE. This shows that Eq.20 is attained. 
 
0 200 400 600 800 1000
-0.2
0
0.2
0.4
0.6
0.8
Time index
C
or
re
la
tio
n
 
Figure 5. Correlation function of    1 1Eˆ Y t Y t
0 200 400 600 800 1000
-0.2
0
0.2
0 200 400 600 800 1000
-0.2
0
0.2
C
or
re
la
tio
n
0 200 400 600 800 1000
-0.1
0
0.1
Time index  
Figure 6. Cross-correlation function of    1 2Eˆ Y t Y t   , 
   2 3Eˆ Y t Y t    and    1 3Eˆ Y t Y t   . These three figures 
shows that the main component of correlation function (7) is 
the difference frequency term. The intensity of correlation 
can be reduced by increasing frequency spacing. 
 
0 1000 2000
-0.5
0
0.5
1
1.5
2
(a)  sample size Q
TA
C
 e
st
im
at
io
n 
va
lu
e 
dB
/c
m
-M
H
z
0 1000 2000
-0.5
0
0.5
1
1.5
2
(b)  sample size Q  
Figure 7. The distribution of estimation values of single 
band (3M Hz) and multiband (3, 3.5 and 4 MHz) estimators. 
 
To check the convergence property of using single- 
frequency estimator (3 MHz) and three-frequency esti- 
mator (3, 3.5 and 4 MHz), we calculate the estimation 
variance with M = [10, 25, 50, 100]. The variances of the 
three-frequency estimator are: 0.0222, 0.0084, 0.0041 
and 0.0028 dB cm MHz . The variances of the single- 
frequency estimator are: 0.0958, 0.0341, 0.0189 and 
0.0087 dB cm MHz . These results shows 1) both esti- 
mators converge according to 1/M and 2) the diversity 
technique works effectively in all cases, since each vari- 
  (upper) 
and    1 2Eˆ Y t Y t   (lower) which are calculated by 2000 
samples. This figure present cross-correlation of two differ- 
ent diversity frequency is much smaller than correlation of 
the same diversity frequency. 
Copyright © 2012 SciRes.                                                                                JBiSE 
S.-K. Tsao, J. Tsao / J. Biomedical Science and Engineering 5 (2012) 276-284 
Copyright © 2012 SciRes.                                                                               
284 
2c   , the bubble echo will consist of two differ- 
ence-frequency signals as: 
  
             
            
            
dx t
 JBiSE 
        
    
   
    
21 22
2
22
2
, , , ,
cos 2
, 2 ,
2 cos 2 2
j
j
L f L f L f L f
a f t
L f L f
a f t
   
 
 
 
   
     
 
     

(29) 
It is noted that the first component of Eq.29 consists 
of two different attenuation quantities, therefore it can 
not be used for TAC estimation; only the second com-
ponent is useful. 
In this paper, we have already increased the estimation 
efficiency of TAC estimation using multiple bubble har- 
monics. For completeness, this method may need esti- 
mators for other parameters, e.g., tissue length estimator, 
and need experimental works to demonstrate in vivo ap- 
placations [7]. 
 
REFERENCES 
[1] Kuc, R. and Schwartz, M. (1979) Estimating the acoustic 
attenuation coefficient slope for liver from reflected ul-
trasound signals. IEEE Transactions on Sonics and Ul-
trasonics, SU-26, 353-362.  
doi:10.1109/T-SU.1979.31116 
[2] Kuc, R. (1984) Estimating acoustic attenuation from re-
flected ultrasound signals: Comparison of spectral-shift 
and spectral-difference approaches. IEEE Transactions 
on Acoustics, Speech and Signal Processing, 32, 1-6.  
doi:10.1109/TASSP.1984.1164282 
[3] Tsao, S.K. and Tsao, J. (2010) A consistent tissue at-
tenuation coefficient estimator using bubble harmonic 
echoes. IEEE Transactions on Ultrasonics Ferroelectrics 
and Frequency Control, 57, 2654-2661. 
[4] Shi, W.T. and Forsberg, F. (2000) Ultrasonic characte- 
rization of the nonlinear properties of contrast microbub-
bles. Ultrasound in Medicine and Biology, 26, 93-104.  
doi:10.1016/S0301-5629(99)00117-9 
[5] Miller, D.L. (1978) Ultrasounic detection of resonant 
cavitation bubbles in a flow tube by their second-har- 
monic emissions, Ultrasonics, 19, 217-224. 
[6] Newhouse, V.L. and Shankar, P.M. (1984) Bubble size 
measurements using the nonlinear mixing of two fre-
quencies. Journal of Acoustical Society of America, 75, 
1473-1477. doi:10.1121/1.390863 
[7] Bridal, S.L., Beyssen, B., Fornes, P., Julia, P. and Berger, 
G. (2000) Multiparametric attenuation and backscatter 
images for characterization of carotid plaque. Ultrasonic 
Imaging, 22, 20-34. 
 
 
 
 
出席研討會： 
(1)  
2012 International Conference on Biomedical Engineering and Biotechnology (iCBEB), May 28 to 
30, 2012, Macau. 
 
(2)  
The 6th International Conference on Bioinformatics and Biomedical Engineering (iCBBE 2012), 
May 17 to 20, 2012 in Shanghai. 第六屆生物資訊與生物醫學工程國際學術會議於2012年5月17日
在上海舉行。會議由IEEE醫學工程與生物協會和武漢大學合辦，並得到國內外眾多高校的專業支
持。會議收錄文章將被IEEE出版並被Ei和ISTP雙檢索。iCBBE 2011論文已順利入IEEE庫，iCBBE 
2012已進入IEEE官方會議列表。 
會議涉及蛋白質結構、功能和次序分析，蛋白質交互作用，連接和功能，蛋白質組計算，DNA
及RNA的結構、功能和次序分析，基因規則、表達、鑒定和網路，基因組的結構、功能和比較，
基因工程和蛋白質工程，生物計算進化，藥物設計和電腦半自動診斷，資料的獲得、標準化、分
析和呈現，生物資訊學的法則、模型、軟體和工具，生物資訊問題研究的新方法，生物醫學成像、
圖像處理和呈現，生物電子和神經系統工程，生物材料和生物醫學光學，生物力學和生物傳送，
NMT/CT/ECG 技術的方法和生物效應，生物醫學裝置、感測器和人造器官，生物化學、細胞、分
子和組織工程，生物醫學的機器人技術和機械學，復原工程和臨床工程，劑量測定系統和可佩帶
系統，生物信號處理和分析，生物計量和生物測量，有關生物醫學工程的其他主題和生物成像，
生物統計和生物數學，腫瘤研究，環境污染與公共監控四個特別專題共計29個專題報告。 
 
 
 
發表論文摘錄： 
 
an unknown bias term of TAC estimation in [3], since it is 
insonification-power dependent. This will make TAC 
estimation complicated. Rather than high-power method, 
Newhouse’s method can generate the bubble harmonics and 
inter-modulation frequencies by low power excitation to 
keep a linear relation between its input acoustic pressure 
and echo power in logarithmic scales. 
In the following sections, we analyze properties of the 
diversity signals and present a suitable diversity combining 
method for these signals to estimate TAC. The diversity 
frequencies are analyzed and determined. Then, the 
diversity method is developed and the gains of different 
diversity methods are defined. In experimental works, 
performances of different diversity methods are verified. 
Finally a brief discussion and conclusion are presented. 
 
METHODOLOGY 
Following Newhouse’s approach, we transmit a 
dual-frequency signal: 
 ( ) ( ) [ ] ( ){ }0 cos cosc cs t p t t tω ω ω= + + Δ⎡ ⎤⎣ ⎦          (1) 
Where ( )p t  is the pulse envelope 2 fω πΔ = Δ . The 
bandwidth of ( )p t is defined to be pB , which determines 
the range resolution and puts a lower bound for the 
frequency spacing as follows. The bubble response has four 
bands which are the second harmonics at 12 2 cf f=  and 
( )22 2 cf ff = + Δ , the sum frequency at 
1 2 2 cf f ff fΣ + =≡ + Δ and the difference frequency at 
2 1f fffΔ − =≡ Δ . The first three frequencies are equally 
spaced and 1 22 2f f fΣ << . For convenience, these 
frequencies are denoted as 2 2 ;  for 0,1, 2k cf f k f k= + Δ = , 
and will be called second-harmonic group also. In this case, 
the bandwidth of each frequency band is 2 pB . To keep the 
performance of the diversity technique, we must be 
constrained the frequency spacing by 
12 ( 2 )pBp f f B< Δ < −  to avoid the frequency collision to 
each other or the second-harmonic group collide the 
transmitting frequencies. Based on the above constraint, it 
can be found that the difference frequency f fΔ = Δ  is 
close to direct current (DC) and far away from the second 
harmonic group thus it must be discarded.   
 To evaluate the performance of the proposed TAC 
diversity estimator, the stochastic properties of the diversity 
signals must be known. The j-th bubble response of each 
2 2k cf f k f= + Δ  in vessel has the same time delay jψ , 
follow the assumption of previous work the time delay is 
uniformly distributed in blood flow, its associated phase 
will be a uniform distribution in [ ]0,2π . In such case, each 
two frequency bands are uncorrelated. When the number of 
bubble is large, bubble response will be a zero mean 
Gaussian random process, then we can summarize that each 
two diversity frequencies are independent to each other.  
 
A. Diversity Method 
In this section, we would decide the MLE using 
second-harmonic group. Let ( )1P k  be power of the 
vessel1’s echo and ( )2P k be power of the vessel2’s at the 
frequency 2kf . To separate the attenuation factor and 
bubble echo, we taking the logarithm of the ( )1P k  and
( )2P k . The pre-attenuated logarithmic-power of bubble 
echoes from vessel 1 and 2 and they have the same 
probability density function (pdf). 
( )1 110logkB P k=                             (2) 
( )2 2 210log 2 ;    for 0,  1,  2k kB P k f L kα= + =       (3) 
where α  is the TAC of the separating tissue. Both 1kB
and 2kB  have non-central and asymmetric distributions. 
For convenience, we define the difference of the 
logarithmic-powers to be: 
( ) ( )
( )
1 2
2 1 2
2
10 log 10 log
2
2
k
k k k
k k
D P k P k
f L B B
f L
α
α ε
= −
= + −
= +
                 (4) 
where 1 2k k kB Bε = − is the pre-attenuated logarithmic- 
power difference of the bubble signals from two vessels. 
Follow Kuc’s approach, when 1kB  and 2kB  have the 
same pdf, kε  can be approximated to be a zero mean 
Gaussian random variable with a same variance 2εσ  for all 
k  such that kD ’s are independent Gaussian random 
variable with mean value is attenuation quantity of its 
frequency.  
To estimate TAC precisely we need enough statistic 
samples. When we collect M  independent echoes for 
each diversity signal, each sample of the difference of the 
logarithmic-power is: 
22
m m
k k kD f Lα ε= +                            (5) 
By (5), the log likelihood function of α  can be found to 
be: 
( ) ( )
( )
2
2 2
22
0 1
3 log 2
2
1    2
2
M
m
k k
k m
M
D f L
ε
ε
α πσ
α
σ
= =
= −
⎡ ⎤
− −⎢ ⎥⎣ ⎦∑∑
A
          (6) 
Then we can find the ML estimate of TAC is: 
( ) ( )
2 2
2 2
0 1 0 1
2 2
2 2
2 2
0 1 0
2 2
ˆ
2 2
M M
m m
k k k k
k m k m
MLE M
k k
k m k
D f L D f L
f L M f L
α = = = =
= = =
= =
∑∑ ∑∑
∑∑ ∑
         (7) 
which is unbiased with the following variance: 
( )
( )
( ) ( )
2
22
22
0 1
2 22 222
22
00
2
ˆvar
22
M
k
k m
MLE
kk
kk
f L
M f LM f L
ε
ε
σ
σ
α = =
=
=
= =
⎡ ⎤⎢ ⎥⎣ ⎦
∑∑
∑∑
      (8) 
The estimation variance can be reduced by increasing the 
number of pulses M  and/or the number of diversity 
641
increases.  
Table I can be used to check the diversity gain when 
using two frequencies and three frequencies for diversity 
combining. Since the diversity gain can be calculated by (9) 
as the variance ratio of different estimators and their values 
are independent of the number of pulses M . We select M
=5 for the estimators to calculate their variances. In this 
case, each variance value is calculated using 400 
realizations. For simplicity, we select variance ratio of the 
single-frequency estimator (3MHz) and the two-frequency 
estimator (3&4 MHz) to represent the diversity gain of 
MLE using two frequencies. Theoretical value of this ratio 
is 2.8 using (9) and the experimental value is 3.1 
(0.188/0.059), which is slightly greater than theoretical 
value. This is because that the variance 2εσ  is not a 
constant value for each frequency. Another case is diversity 
gain of MLE using three frequencies. The theoretical value 
is 4.14 using (9), which is also smaller than the 
experimental value 4.18 (0.188/0.045). Based on these 
results, we can conclude that the estimation variance can be 
decreased by increasing frequency bands or using higher 
frequency for estimation.  
The variances of two diversity methods, MLE (7) and 
equal-diversity (10), are given in Table II. All variance 
values are calculated using 400 realizations of data. The 
results show that the estimation variances of equal diversity 
are slightly larger (10%) than those of MLE so that we can 
use equal diversity to estimate TAC. 
 
DISCUSSION 
In this paper, the single-frequency TAC estimator [3] is 
extended to be a multiple-frequency diversity estimator 
using bubble harmonics. In this paper, we presented a MLE 
of TAC for these frequency bands and compare its 
efficiency to that of the linear-diversity estimator, which is 
the simplest diversity strategy.  
In the experimental work, we use a dual-frequency signal 
to verify this technique. The experimental results show that 
the frequency diversity works well, which confirms that the 
assumption of independency for each frequency band is 
proper. By checking efficiency of the diversity technique, it 
is found that the variance of logarithmic-power 2εσ is 
frequency dependent and much smaller than what Kuc 
presented [1]. In the future, we like to check the physical 
and statistical properties of bubble echoes and present a 
statistical model for 2εσ . 
 
REFERENCE 
[1].R. Kuc,  M. Schwartz, Estimating the Acoustic 
Attenuation Coefficient Slope for Liver from Reflected 
Ultrasound Signals,  IEEE Trans. Sonics and 
Ultrasonics, SU-26 (5) (1979) 353-362. 
[2].Hairong Shi, Tomy Varghese, Carol C. Mitchell, 
Matthew McCormick, Robert J. Dempsey, Marl A. 
Kliewer, “In vivo attenuation and equivalent scatterer 
size parameters for atherosclerotic carotid plaque: 
Preliminary results,” Ultrasonics, 49 (2009)779-785. 
[3].S. K. Tsao, J. Tsao, A Consistent Tissue Attenuation 
Coefficient Estimator Using Bubble Harmonic Echoes,  
IEEE UFFC Trans. 57 (12) (2010) 2654 -2661. 
[4].W. T. Shi , F. Forsberg, Ultrasonic Characterization of 
the Nonlinear Properties of Contrast Microbubbles, 
Ultrasound Med. Biol. 26 (2000) 93-104. 
[5].V. L. Newhouse, P. M. Shankar, Bubble size 
measurements using the nonlinear mixing of two 
frequencies, J. Acoust. Soc. Am. 75 (5) (1984) 
1473-1477. 
 
 
 
 
 
 
 
 
 
TABLE I 
STATISTICS OF THE ESTIMATED TAC USING THE MULTIPLE SECOND 
HARMONIC BANDS.  
THE SAMPLE SIZE Q IS 2000 FOR ALL CASES 
 
Frequency
(MHz) 
α(dB/cm/MHz) 
mean Variance 
3 
3.5 
4 
3 & 4 
3.5 & 4 
0.4890 
0.4989 
0.5171 
0.5070 
0.5092 
0.188 
0.156 
0.093 
0.059 
0.063 
3, 3.5 & 4 0.5043 0.045 
 
 
Fig.4 The distribution of estimation values of single 
band (3M Hz) and multiband (3, 3.5 and 4 MHz) 
estimators. 
500 1000 1500 2000
-0.5
0
0.5
1
1.5
2
No.of pulses M
TA
C 
es
tim
at
e 
in
 
dB
/c
m
-M
Hz
500 1000 1500 2000
-0.5
0
0.5
1
1.5
2
No.of pulses M
TA
C 
es
tim
at
e 
in
 
dB
/c
m
-M
Hz
TABLE II 
ESTIMATION VARIENCE OF EQUAL DIVERSITY AND MLE  
THE SAMPLE SIZE Q IS 5 WITH 400 ESTIMATED VALUES FOR ALL 
CASES 
 
Frequency
(MHz) 
variance 
MLE Equal diversity 
3 & 4 
3.5 & 4 
3, 3.5 & 4 
0.059 
0.063 
0.045 
0.067 
0.067 
0.048 
643
than we can increase K times SNR of range 1 and range 2 
In this case, bias could be decreased but estimation 
variance would be increased since we only remain M
independent samples to estimate TAC.  
In this paper, we extend the stochastic model of 
attenuated scattering signal by adding white Gaussian noise, 
this model is suitable for tissue scattering process or bubble 
second harmonic echo. Then we analyze the estimation bias 
of Kuc’s estimator by fixed the range L and frequency f . 
We also derive a modified TAC estimator by rearrange the 
independent samples. In the experimental works we 
measure the bias by change the different level of noise and 
compare with the theoretical bias value. The bias term 
could be compensated since it could be estimated by signal 
and noise level. 
 
METHODOLOGY 
To fix f and L in TAC estimator, the echo of range 1 
and range 2 is considered to be a continuous wave 
(narrowband) with center frequency 2 cf . These signal can 
be treated as tissue echo by Kuc [1, 2] or bubble second 
harmonic echo [3]. The echo signals of range 1 and range 2 
plus white Gaussian noise ( )n t as:  
( ) ( ) ( )1 2
1
cos 2 2
N
j c j
j
X t A f t n tπ ϕ
=
= + +∑           (2) 
( ) ( ) ( ) ( )2 2
1
2 , 2 cos 2 2
N
c j c j
j
X t L f A f t n tη π ϕ
=
= + +∑  (3)  
where ( )2 , 2 cL fη is the attenuation factor defined as
4 / 20(2 ,2 ) 10 cf LcL f
αη −= . N is the number of scatters, 
amplitude 2 jA  is the random factors of scatter (or bubble 
second harmonic) response and jϕ  is random phase 
which is dependent of the length between the transducer 
and the j-th scatter in a range. In this case, amplitude and 
phase distribution are mutually independent and both the 
phase distribution in these two ranges will be uniformly 
distributed in [ ]0,2π . When N  is large, the power of each 
sample of pre-attenuated echo signal (echo of range 1) 
without noise effect is 
2
2
1
N
j
j
Y A
=
= ∑ which has a chi-square 
distribution with two degrees of freedom. 
Before we analysis the noise caused bias, we need to 
check the echo sample of range1 and range 2 is stochastic 
stationary. Since the noise component is independent of 
echo signal such that echo process are independent of time. 
In this case, we can estimate ( )110log P f and     
( )210log 2P f fLα+  by periodogram as the sample mean 
of the power spectrums of all sample signals as: 
( ) ( ) 2
1
10ˆ log
Q
qdB q
P f P f
Q
=
= ∑                    (4) 
where ( )qP f is the spectrum of the q-th sample of 
signal of range 1 or range 2, and it can be found to be the 
Fourier transform of (2) and (3) and Q is the sample 
number. In this case, the expect value of this estimator can 
be defined as the logarithm power spectrum of (2) and (3) 
at frequency 2 f : 
( ) 2 0110 log 2 10 log 2c Y
N
P f Nσ⎛ ⎞= +⎜ ⎟⎝ ⎠               (5) 
( )2
2 0
2
10 log 2
                 4 10log
2 (2 ,2 )
c
c Y
c
P f
Nf L N
L f
α σ
η
=
⎛ ⎞
+ +⎜ ⎟⎝ ⎠
   (6) 
Where 0 / 2N is expective noise power. Equation (5) 
and (6) shows: 1) noise effect cannot be averaged since we 
take the logarithm power of echo signal and 2) noise effect 
is different in range L and frequency 2 cf . Follow (1) 
Kuc’s estimator [1] can be defined by fixed d and 2 cf as: 
( ) ( )1 21 ˆ ˆˆ 2 24 c cdB dBc P f P ff Lα
⎡ ⎤
= −⎣ ⎦                 (7)            
where ( )1ˆ 2 c dBP f  is the log-scaled power of the harmonic 
of bubbles in range 1 and ( )2ˆ 2 c dBP f  is that of range 2. 
Replace (5) and (6) in (7), αˆ become: 
1
1 1ˆ
4
Q
q
qc
bias
f L Q
α α ε
=
= + + ∑                    (8) 
Where the bias component is caused by noise power 
since the noise effect in range2 is much larger than range1: 
2 2
0
4 /102 2
0
/ 210 log
4 10 / 2
Y
f L
c Y
N Nbias
f L N Nαα
σ
σ −
⎛ ⎞+
= ⎜ ⎟
+⎝ ⎠
        (9) 
Follow Kuc’s approach, the random component qε  is a 
zero mean Gaussian random variable with variance 2εσ  
and has a value of 62.1 ( )2dB . If noise effect is neglected, 
unbiased estimator αˆ  is a Gaussian random variable 
with: 
[ ]ˆEα α=  and ( )
2
2
24 cf L Q
ε
α
σ
σ =                (10) 
In this case, we define the SNR is the ratio of signal 
power (bubble echo) and noise power, then we can define 
ISNR is the SNR of vessel1 and OSNR  is the SNR of 
vessel2. Combine (8) and (9) the mean value of αˆ  
become: 
[ ] 1ˆ 1 log
1
I
O
SNRE
SNR
α α
⎡ ⎤⎛ ⎞+
= +⎢ ⎥⎜ ⎟
+⎢ ⎥⎝ ⎠⎣ ⎦
                 (11) 
Based on this result we can summarize: 1).When signal 
power is much greater than noise power the bias term 
would become zero that is, TAC estimator is unbiased if the 
noise component can be neglected. 2). the bias component 
can be compensated if SNR can be measured accurately.  
To decrease the bias effect we can improve ISNR  and 
OSNR  by rearrange the sample Q into M groups where
793
FFT and its intensity at the peak value of second harmonics 
are extract to estimate TAC using (7), where the true tissue 
length (1cm) is used for the L . After we averaged the 2500 
samples, the estimation value is 0.495 dB. Since these 
values are much closed to reference values such that there 
could be treated to unbiased estimation. 
The white Gaussian noise is added into measured echo 
signals independently. The OSNR is selected from -2dB to 
15dB. Fig.4 presented the noise caused bias of estimated 
values and measurement values. Where estimated value is 
calculated by (9) and measurement value is calculated by 
difference of the TAC with and without interfered by noise. 
In this figure, the estimator is still kelp unbiased when the 
OSNR is greater than 10dB. in this case, the TAC estimation 
value is 0.438 dB. The bias effect is increased when the 
OSNR  decreased from 10dB to 1.63dB and the bias term is 
increased to 0.3 dB. The bias would become 0.3 since the 
SNR is decreased below to 0dB that means the TAC cannot 
be estimation (compensate) in this level. We also presented 
the bias decreasing using (12). The number of averaged 
sample K is select to 1 and 20 and OSNR is 4.6dB. In this 
case, the bias is 0.075 dB when K =1 and -0.02 dB when 
K =20. That is bias can be decreased by K . However the 
standard deviation is 0.02 dB when K =1 and 0.037 dB 
when K =20 that means variance is increased by K also. 
Figure 5 presented the difference of estimated bias and 
measurement value to SNR decreased. This figure is also 
presented the estimated values using (9) is much closed to 
the measurement values that means the bias component 
could be compensated since the SNR and noise power can 
be measured. 
 
DISCUSSION 
 
In this paper, we derive a noise induced bias estimation 
of TAC estimator by fixed frequency and range. It is 
accomplished by using bubble second harmonic echoes to 
measure tissue attenuation. Bias component has a relation 
of averaged signal to noise ratio of range 1 and range 2, 
which means bias could be compensated by measured 
signal power and noise power precisely. A modified PSD 
estimation by increase SNR also can decrease the bias 
however variance is increase. 
The experimental work presents theoretical bias value is 
close to experimental value. In high SNR level, bias effect 
could be neglected, bias could be compensated when SNR 
is greater than zero and it cannot be compensated since 
noise level is higher than signal level. It also present 
decreases the bias and variance would be a tradeoff.  
 
REFERENCE 
 
[1]. Roman Kuc and Mischa Schwartz, “Estimating the 
acoustic attenuation coefficient slope for liver from 
reflected ultrasound signals,” IEEE Trans. Sonics 
Ultrason., vol. 26, no.5, pp. 353-362, 1979 
[2]. R. Kuc, “Estimating acoustic attenuation from 
reflected ultrasound signals: comparison of 
spectral-shift and spectral-difference approaches,”  
IEEE Trans. Acoust. Speech Signal Process., vol. 32, 
pp. 1-6, 1984 
[3]. S. K. Tsao, J. Tsao, A Consistent Tissue Attenuation 
Coefficient Estimator Using Bubble Harmonic Echoes,  
IEEE Trans. Ultrason., Ferroelect., Freq. Contr., vol. 57, 
no. 12, pp. 2654 -2661, 2010 
 
 
 
 
 
Fig4. The bias effect calculated by (9) and measured value. SNR 
from -2dB increased to 15dB 
 
Fig5. The bias difference of (9) and measured value. SNR 
from -2dB increased to 15dB 
795
the ratio of diversity frequency is independent of 
microbubble amount. Using this parameter to estimate TAC 
could attain both unbiased and consistent. 
II. THEORY 
A. Bias caused by flow property 
As shown in Fig.1 from [5], we like to estimate the TAC 
of separation tissue between two vessels (or range gates). If 
the bubble inside the tissue is negligible and we transmit a 
narrowband signal ( ) ( ) ( )0 cos cs t p t tω= , where ( )p t  is the 
pulse envelope and 2c cfω π= , the second harmonic echo 
from gate-2 can be modeled by the tissue attenuation factor 
2 2 / 20(2 ,2 ) 10 cf LcL f
αη −=  as: 
( ) ( )2 2(2 , 2 )cX t L f Y tη=   ʳʳʳʳʳʳʳʳʳʳʳʳʳʳʳʳʳ   (2) 
and the bubble echo component is: 
( ) ( ) ( )( )22 2
1
2 cos 2 2
N t
j c c j
j
Y t A f f tπ θ
=
= +¦   ʳʳʳʳ      (3) 
In clinical applications, bubble echo depends highly on 
the flow properties of individual vessel. In (3), if the random 
factors of bubbles 2 jA  depends only on bubble radius and 
phase jθ  is uniformly distributed, the number of bubble in 
gate-2, ( )2N t , is the only factor of flow properties that 
affect bubble echo. In this model, the echo from gate-1 can 
be found by setting the tissue length, L , to zero and change 
( )2N t to ( )1N t . 
There are two factors that affect the bubble number 
( )2N t , the static factor includes vessel diameter and bubble 
concentration in the vessels and the time varying factor is the 
amount bubble changed by instant blood velocity. Since 
( )2N t  is large and it is nearly time invariant in any pulse 
duration, pT , the average power spectrum of ( )Y t can be 
simplified as: 
( ) ( ) ( )2 22 2( ) 2 2cY cA fP f N t f fσ δ≅ −                 (4) 
where ( )2
2
2 cA f
σ is the variance of 2 jA  at 2 cf f= . In this 
case, the power spectrum can be separated into two parts: 
flow property ( )2N t and bubble response ( )22 2 cA fσ , that is, the 
difference of gate-1 and gate-2 can be simplified as the 
difference of ( )1N t  and ( )2N t .  
Follow (1) TAC estimator can be defined as: 
( ) ( )1 21 ˆ ˆˆ 2 24 c cdB dBc P f P ff L
ª º
= −¬ ¼α                      (5) 
where ( )1ˆ 2 c dBP f  is the log-scaled power of the harmonic of 
bubbles in gate-1 and ( )2ˆ 2 c dBP f  is that of gate-2. To 
estimate the power spectrum we can use the following 
estimator: 
( ) ( ) 2
1
10ˆ log
Q
qdB q
P f P f
Q
=
= ¦       ʳʳʳʳʳʳʳʳʳʳ   (6) 
where ( )qP f is the spectrum of the q-th sample of signal 
of gate-1 (or gate-2), and it can be found to be the Fourier 
transform of (2) and Q is the number of samples. 
In this case, the expected value of αˆ  become: 
[ ] ( ) ( )
1
1 1ˆ 1 2
4
Q
q q
qc
E N t N t
f L Q
α α
=
ª º≅ + −¬ ¼¦            (7) 
Where qt  is time index of q th sample. This shows that 
mismatch of bubble number, i.e., ( ) ( )1 2q qN t N t≠ , would 
cause estimation bias. 
B. Unbiased estimator 
To construct an unbiased estimator that can overcome the 
bubble number mismatch, we need to introduce another 
factor, which is independent of bubble number, to 
compensate the mismatch. Following Newhouse’s approach, 
we transmit a dual-frequency signal: 
( ) ( ) [ ] ( ){ }0 cos cosc cs t p t t tω ω ω= + + Δª º¬ ¼    ʳʳʳ   (8) 
where 2 fω πΔ = Δ ,same as single band case, the second 
harmonic component echo from gate2 can also be separated 
into tissue attenuation factor η  and bubble echo components. 
Let the second harmonic components of ( )X t  compose of 
two frequency: 1 2 cf f=  and ( )2 2 cff f= + Δ , to keep 
statistically independent, the frequency spacing need satisfy: 
12 ( 2 )p pB f f B< Δ < −  ( pB is bandwidth of ( )p t ).  
Following (4) the average power spectrum of gate-2 of these 
two frequencies is: 
( ) ( ) ( )2 2
2
2
1
( ) 2
iY iA f
i
P f N t f fσ δ
=
≅ −¦                  (9) 
Like the HSFR introduced by Greenleaf et al. to 
compensate input power[3], in this paper we employ a new 
parameter which is the power ratio of these two frequency 
bands names HR  for the same purpose. Following (9) the 
stochastic average of this ratio in gate1 and gate2 are: 
( )
( )
( )
( )
2 11
1 2 2
2
1
1 2
2
A fX
X A f
P f
HR
P f
σ
σ
= =                             (10) 
( )
( ) ( )
( )
( )
2 12
2 2 2
2
1 2
2 2
2
2 ,2 A fX
X A f
P f
HR L f
P f
σ
η
σ
= = Δ                (11) 
Since this parameter is independent of bubble number, TAC 
can be estimated by estimate 1ˆ dBHR  in gate-1  and   2
ˆ
dB
HR  
728
is inserted to introduce the desired attenuation for flow 2. In 
case1, the contrast agent (microbubble) used is Sonovue. Its 
concentration is 10ml in 4.5 liters of dextrose solution. In 
case2, concentration in vessel1 is two times of this value.  
The transmitter uses an arbitrary function generator to 
generate signals. Then a power amplifier is used to control 
the signal before applying to the T/R switch and piston 
probe, which is a non-focused transducer (V380, 3.5MHz, 
2.5cm, Panametrics). Bubble echo signals are received 
through the T/R switch and amplified by a low-noise 
amplifier (5072 PR Panametrics Waltham, MA, USA) The 
digitalized signals were stored in the PC for further 
processing. 
In the experiment, a dual-frequency signal with center 
frequencies 1.5, and 2 MHz are transmitted to measure the 
echo signals of two bubble flows. The second harmonic 
frequencies are 3 and 4MHz. The bandwidth of transmission 
signal is selected to be 100 KHz. The transmission power is 
set at a level to make the bubbles generate second harmonics 
with SNR around 10 dB. 
The PRF is set at 1 KHz to ensure the independency of 
each sample. The flow speed is about 2.45m/s. The 
measurement is repeated for 1000 times to get 1000 A-lines. 
Each A-line sample uses a rectangular window to select the 
echo from flow1 and flow2. The peak values of frequencies 
in the second harmonic 3 and 4MHz are estimated by (6). 
Using the peak power of second harmonic HR is estimated 
by (10) and (11).  
Fig.4 shows the result of case1, in Fig.4-a is the 
estimated result of (5) using second harmonic with cf  = 
3MHz Fig.4-b is TAC estimation value of (12) using HR . In 
case 1, theoretically, both (5) and (12) are unbiased and 
consistent estimators. In this case, we can treat the estimation 
result using second harmonic frequency (i.e. result in Fig.4-a) 
as a reference for comparison. For Q  < 1000, there are 
multiple sub-sets of data for estimating the TAC. The 
different estimates are presents as scatter diagrams for Q  = 
100, 200, 250, 500 and 1000. In Fig.4-a and –b, their 
convergence values are close, where αˆ  converges to 0.443 
/ /dB cm MHz in Fig.4-a and to 0.615 / /dB cm MHz in 
Fig.4-b. In this case, the estimation variance of Fig.4-a is 
0.34 / /dB cm MHz and is 5.63 / /dB cm MHz  in Fig.4-b; this 
result shows that both estimators of (5) and (12) are unbiased, 
if the random distribution of bubbles inside vessel-1 and 
vessel-2 are the same. However estimator (12) has very large 
deviation such that estimation value using HR is slightly 
draft away from the reference value. That is, using second 
harmonic to estimate TAC is more efficient in case 1. 
Fig.5 presents αˆ  estimated in case2, which represents 
the TAC estimates when bubble number of two vessels are 
mismatch. In Fig.5-a we found that the estimation value 
using second harmonic is 1.03 / /dB cm MHz  with variance 
is 0.35 / /dB cm MHz . This shows a large bias, which is far 
away from the results in Fig.4-a due to bubble number 
mismatch. Fig.5-b is an unbiased estimation in this case, 
αˆ is 0.342 / /dB cm MHz  with variance is 
6.05 / /dB cm MHz , this value is close to the TAC estimation 
value in Fig.4-a, however the large estimation variance make 
the estimation value far away from the estimation value in 
Fig.4-a. This implies: to estimate TAC using HR needs a lot 
of additional samples to keep consistent. 
IV. DISCUSSION 
Since bubble harmonic power depends highly on number 
of microbubbles and flow property, we need bubble 
distributions be same in two flows to have an unbiased TAC 
estimate. Follow Greenleaf’s work, we introduce HR to 
compensate the effect of bubble number, this new parameter 
can provide unbiased estimation and release the restriction of 
bubble distribution. HR is calculated at each pulse such that 
this parameter also can compensate the time varying bubble 
number changed by blood pressure, vessel diameter 
mismatch and transducer gain mismatch of two vessels. 
However the estimation variance using HR is 
( )22 cf fΔ times greater than that using second harmonic. In 
this experiment, the theoretical variance ratio is 18, the 
experimental values are 16.6 in case1 and 17.3 in case2, 
which means: to attain consistent estimation we needs very 
large amount samples than the original estimator in [5]. The 
new estimator still need to avoid shadowing effect by vessel-
1, however using HR to estimate TAC, we can also measure 
the echoes of vessel-1 and vessel-2 in different beam path 
since HR  is independent of flow properties. Another 
consideration is the separation tissue still needs be treated as 
non-perfused to avoid the interference from bubble in tissue, 
this assumption may limits the clinical applications for 
estimating the TAC of atherosclerotic carotid plaque in 
carotid artery only. These restriction needs to be released in 
future works. 
REFERENCES 
 
[1] R. Kuc and M. Schwartz, “Estimating the acoustic attenuation 
coefficient slope for liver from reflected ultrasound signals,” IEEE 
Trans. Sonics Ultrason., vol. 26, no.5, 1979, pp. 353-362. 
[2] R. Kuc, “Estimating acoustic attenuation from reflected ultrasound 
signals: comparison of spectral-shift and spectral-difference 
approaches,”  IEEE Trans. Acoust. Speech Signal Process., vol. 32, 
1984, pp. 1-6  
[3] S. Chen, M. Fatemi, E. McMahon, J. F. Greenleaf, M. Belohlavek, 
“Spectral compensation for tissue attenuation and transmit intensity in 
ultrasounic detection of microbubbles by harmonic method,” Proc. 
IEEE, Ultrason. Symp. ,2004, pp. 982-985. 
[4] V. L. Newhouse, and P. M. Shankar, “Bubble size measurements 
using the nonlinear mixing of two frequencies,” J. Acoust. Soc. Am., 
Vol. 75, No.5, 1984, pp. 1473-1477. 
[5] S. K. Tsao and J. Tsao, “A Consistent Tissue Attenuation Coefficient 
Estimator Using Bubble Harmonic Echoes,” IEEE Transactions on 
Ultrasonics. Ferroelectrics. And Frequency Control., Vol. 57, No. 12, 
2010, pp. 2654 -2661,. 
 
730
{ }2arg max ( ; )co ff f rσΣ=                                (2) 
This is the SCS method for finding the optimal driving 
frequency for a mixture of bubbles. 
III. OPTIMAL TXF SELECTION BASED ON BUBBLESIM  
BubbleSim is a simulation program developed by Hoff 
for solving the nonlinear bubble equation to get the bubble 
echo signal ( )y t  for a given driving signal ( )x t [6]. Unlike 
the SCS of bubble, the result of BubbleSim can provide 
much detail information about the bubble echo. This includes 
the effects of amplitude, frequency, waveform of the driving 
signal and other bubble characteristic parameters. For the 
convenience in specifying the harmonics of the bubble signal 
with different bubble size, the signals will be denoted as 
( ; , )cx t f r  and ( ; , )cy t f r  when necessary, where cf  is the 
center frequency of the driving signal and r is the bubble 
radius.  
As in the SCS method, the total power of the second 
harmonic of bubble echo can be found as 
2 2( ; ) ( ; ) ( ; )c c
r
P f r w r r P f rΣ =¦                                 (3) 
where 2 ( ; )cP f r  is the second-harmonic power (SHP) of a 
bubble with radius r. One way to find the SHP is to use the 
pulse inversion technique [6, 8], which needs to transmit two 
phase-inverted driving signals to find the second harmonic, 
2 ( ; , )cy t f r , of ( ; , )cy t f r . By Fourier transform, the power 
spectrum of the second harmonic can be found to be  
2
2( ; , ) [ ( ; , )]c cU f f r FT y t f r=                                 (4) 
Then the SHP can be found to be  
2
2
2 ( ; ) ( ; , )
f B
c cf B
P f r U f f r df
+
−
= ³                                    (5) 
where 2 ( 2 )cf f=  is the twice of TxF  andʳ B is bandwidth of 
driving signal. 
As in the SCS method, the optimal driving frequency, 
cof , can be found as  
{ }2arg max ( ; )
c
co cf
f P f rΣ=                                         (6) 
This is the BubbleSim method for finding the optimal 
driving frequency for a mixture of bubbles. It is noted that, to 
find the total second harmonic power, 2 ( ; )cP f rΣ , the bubble 
equation must be solved for different bubble sizes, which is 
very time consuming. Even more serious is that the total 
second harmonic power must be computed for different 
driving frequencies to find the optimal driving frequency, 
cof . This will be prohibitive for practical usage. 
IV. SIMULATION STUDIES 
A. The use of SCS method 
For demonstrating the SCS method, the TSCS's of three 
different mixture of bubbles are computed for optimal TxF 
selection. The mean bubble sizes used are 2, 1.5 and 1 ȝm. 
For each bubble, the SCS of second harmonic are computed 
using Eq. 26b in[4] with the following settings: Shell 
thickness = 4 nm, Shell shear modulus = 50 MPa, Shell 
viscosity = 0.8 Pas, Ambient pressure = 100 KPa, Polytropic 
exponent = 1, Viscosity of the liquid = 0.001 Pas, Density of 
the surrounding liquid = 1000 kg/m3 and Density of the shell 
material = 1100.  
Three TSCS's are shown in Fig. 1. In each figure, the 
values of TSCS at two TxF's are given and marked with 
dashed arrows. One is the optimal TxF and the other is 2.25 
MHz for comparison. The TSCS of a TxF is represented as 
P(TxF); for example, in Fig. 1-a, "P(1.70 MHz) = - 96.4 dB" 
means that the TSCS at 1.70MHzcof = is - 96.4 dB. The 
TxF, 2.25MHz, is chosen to be a reference case for showing 
the performance of the optimal TxF and it represents a non-
adaptive situation that use a fixed TxF, 0 2.25MHzf = , 
despite of the change of bubble size. In dB scale, the 
difference, 0( ) ( )coP f P f− , is the improvement factor (IF) 
of the optimal TxF relative to the reference TxF, 0f . For the 
three type of bubble mixtures, the improvement factors are 
2.5, 0.3 and 7.4 dB.  
B. Verification by BubbleSim 
Although the proposed SCS method can find an optimal 
TxF for a given bubble mixture without solving the bubble 
equation, its result has nothing to do with the driving signal. 
In imaging applications, the driving signal is pulsed and 
bandlimitted, which may have complicated effects on bubble 
echo due to the nonlinearity of bubble. However this is not a 
problem for the BubbleSim method, since BubbleSim solves 
the bubble response for a given driving signal. To verify the 
usefulness of the optimal TxF predicted by the SCS method, 
the IF's of the optimal TxF's shown in last section are 
examined using BubbleSim method. 
The power of bubble responses to a chirp signal driving 
at the optimal TxF are found by BubbleSim for comparison 
with that of the non-adaptive case. The chirp signal is set to 
have bandwidth = 1 MHz  and transmission acoustic pressure 
= 50 KPa , and is shaped by a Hanning window to have pulse 
length = 10 ȝs. In BubbleSim, the bubbles are simulated 
using the modified Raleigh-Plesset equation with parameters 
set as in [6] : Shell thickness = 4 nm , Shear modulus = 
50 MPa  and Shear viscosity = 0.8 2/Ns m .  
The simulation results are presented using the PSD 
(Power Spectral Density) of bubble echoes. The PSD of the 
echoes of a bubble mixture is defined as: 
( ; , ) ( ; ) ( ; , )c c
r
S f f r w r r U f f r=¦                             (7) 
where ( ; , )cU f f r  is the power spectrum of the second 
harmonic of bubble echo as defined in (4). The second 
harmonic of bubble echo is extracted by the pulse inversion 
technique and ( ; )w r r  is the bubble density.  
The PSD's of the same bubble mixtures defined in last 
section are and shown in Fig. 2. In each figure, two PSD's 
are given, one is for the optimal TxF predicted by the SCS 
method and the other is for the reference frequency 
0 2.25MHzf = . 
 
857
predicted by a same method. This is why the reference case 
is used for defining the improvement factor.  
For further verification, the IF's of SCS method are 
examined for 8 different bubble densities with mean bubble 
size being decreased from 3ȝm to 0.4ȝm as: 3ȝm, 2.5ȝm, 
2.0ȝm, 1.5ȝm, 1.0ȝm, 0.8ȝm, 0.6ȝm and 0.4ȝm. The 
corresponding optimal TxF's predicted by the SCS method 
are 1.02MHz, 1.28 MHz, 1.7MHz, 2.45 MHz, 4.01 MHz, 
5.19 MHz, 7.19 MHz and 11.57 MHz. As above, the 
reference one uses 0 2.25MHzf =  for all 8 cases to predict 
the IF's of the optimal TxF's. Then the IF's of the optimal 
TxF's is evaluated by BubbleSim using the same setting as 
before. The IF's are shown in Fig. 3.  
 
Comparing the optimal TxF's with the reference 
frequency, it can be found that: 
1)The 1.5ȝm bubble mixture is the one that closest to the 
reference case. 
2)The optimal TxF's increase as mean bubble sizes decrease,  
3)The change of optimal TxF's increase as the mean bubble 
sizes decrease, especially when it crosses the reference 
case; this means that the sensitivity of TxF's to bubble size 
is higher for small bubbles than for large bubbles. 
 
Comparing the IF’s for different cases, it can be found 
that: 
1)The sensitivity of IF to TxF is higher for large bubbles (on 
the LHS of Fig. 3) than for small bubbles (on the RHS of 
Fig. 3). This property is a consequence of the scattering 
property of bubble, which can be confirmed by comparing 
the TSCS’s given in Fig. 1. The shape of the TSCS around 
cof , given in Fig. 1-a, is sharper than those given in Fig. 1-
b and 1-c; this means that the TSCS of large bubble is more 
sensitive to TxF than that of small bubble.  
2) A general property of the IF’s is that IF increases 
monotonically as the distance between the optimal and 
reference frequencies, i.e., 0cof f− , increases. 
3) The IF’s predicted by the SCS method is in general larger 
than those predicted by BubbleSim. However, since these 
two predicted IF’s are proportional to each other, this is 
enough to confirm that the SCS method is a proper 
technique for optimal frequency selection for varying 
bubble size distribution. 
 
V. CONCLUSION 
For optimizing the SNR in contrast imaging, an 
analytical technique, named SCS method, for optimal 
transmission frequency selection is proposed. The 
correctness of the SCS method is validated using simulation 
signals generated by BubbleSim.  
Based on results of the test cases, it is found that the 
sensitivity of TxF's to bubble size is higher for small bubbles 
than for large bubbles; however, the sensitivity of IF to TxF 
is higher for large bubbles than for the small bubbles.  
Since the SCS method is an analytical technique, it is 
computationally efficient and can be the basis for developing 
an adaptive TxF selection technique. However, it needs the 
knowledge about bubble size distribution. To be an adaptive 
technique, bubble size distribution must be estimated in time. 
This calls for a technique to estimate the time-varying bubble 
size distribution based on bubble echoes. 
REFERENCES 
[1] S. Menigot, A. Novell, A. Bouakaz, and J.-M. Girault, “Improvement 
of the power response in contrast imaging with transmit frequency 
optimization,” Proceeding IEEE Ultrasonic Symposium, 2009, pp. 
1247–1250. 
[2] M. Kaya, S. Feingold, K. Hettiarachchi, A.P. Lee and P.A. Dayton, 
"Acoustic responses of monodisperse lipid encapsulated microbubble 
contrast agents produced by flow focusing," Bubble Sci Eng Technol 
2010;2, pp. 33–40. 
[3] J. M. G. Borsboom, C. T. Chin, A. Bouakaz, M. Versluis, and N. de 
Jong, “Harmonic chirp imaging method for ultrasound contrast 
agent,” IEEE Trans. Ultrason., Ferroelect., Freq. Contr., vol. 52, pp. 
241–249, 2005. 
[4] C. C. Church, “The effects of an elastic solid surface layer on the 
radial pulsations of gas bubbles,” 1995 J. Acoust. Soc. Amer. 97, pp. 
1510–1521. 
[5] D.E. Goertz, N. de Jong and A.F.W. van der Steen, "High Frequency 
Attenuation and Size Distribution Measurements of Definity and 
Manipulated Definity Populations," Proceeding IEEE Ultrasonics 
Symposium, 2006, pp. 1552–1555.  
[6] L. Hoff, Acoustic Characterization of Contrast Agents for Medical 
Ultrasound Imaging. Boston: Kluwer Academic, 2001. 
[7] L. Hoff, P. C. Sontum, and J. M. Hovem, “Oscillations of polymeric 
microbubbles:Effect of the encapsulating shell,” J. Acoust. Soc. 
Amer., vol. 107, pp. 2272–2280, April. 2000. 
[8] R. Arshadi, A. C. H. Yu, and R. S. C. Cobbold, “Coded excitation 
methods for ultrasound harmonic imaging,” Canadian Acoustics, vol. 
35, no. 2, pp. 35–46, 2007. 
 
0 2 4 6 8 10 120
5
10
15
20
25
Optimal center frequency              MHz
Im
pr
ov
em
en
t F
ac
to
r (
dB
) 
 
I F predicted by SCS
I F predicted by BubbleSim
Figure 3  Improvement factor verification for different mean 
bubble sizes: 3.0ȝm ~ 0.4ȝm. 
859
100年度專題研究計畫研究成果彙整表 
計畫主持人：曹建和 計畫編號：100-2221-E-002-063- 
計畫名稱：一個用於二次諧波脈衝壓縮成像之多頻合成技術(II) 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 1 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 4 0 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
