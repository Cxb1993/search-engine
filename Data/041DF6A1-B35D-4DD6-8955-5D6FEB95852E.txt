2行政院國家科學委員會專題研究計畫成果報告
應用人工智慧於醫療資源之輔助規劃研究－以人工全膝關節置換術為例(I)
計畫編號：NSC96-2221-E-150-009
執行期間：96 年 8 月 1日至 97 年 7月 31 日
計畫主持人：張俊郎
計畫參與人員：賴瑋諭
一、中文摘要
在眾多的老年常見的疾病中，關節炎佔有相當高的罹患比率，而膝關節的退化多少都
會影響老人的生活。行動不便不但會造成了生理上的障礙，對於老人心理的衝擊影響甚鉅。
根據健保申報資料統計顯示，台灣地區接受膝關節置換術從 1998 年到 2003 年約成長了
29.9%，其利用率高且醫療費用成本高，佔健保相當份量的支出比例。
本研究的目的乃是要建構一個輔助臨床的評估系統。就醫院觀點而言，初期住院日評
估可以協助醫師事先建立診療標準流程，在有限的醫療資源與人力情況下如何合理分配與
評估並可作為後續出院照顧計畫之安排；就病患與家屬觀點而言，可減少病患對自己住院
期間長短不確定性與減輕病患家屬精神壓力的心理調適。
本研究分別應用三種人工智慧技術(決策樹、類神經網路與案例式推理)以作為探討醫療
資源分配之工具。研究結果顯示，決策樹正確分類率為 78.53%；類神經網路之均方根誤差
為 0.0436；案例式推理在誤差為一天時，準確率可達 79.21%。總結而言，本研究結果已顯
示此系統的實際可行性，並提供適切結果。
關鍵字：決策樹、案例式推理、類神經網路、資料探勘、全膝關節置換術、住院日
二、Abstract
Arthritis is the most common disease among the old people in Taiwan. Arthrosis of the knee
caused tremendous inconvenience to the elders’life. In addition, the disability not only impact
old people physically but also mentally. According to the statistics released by Bureau of National
Health Insurance, people who undertook the surgery of total knee arthroplasty have grown 29.9%
from 1998 to 2003. It is a huge portion of the medical budget.
In this thesis, the computer aided clinical evaluation system is expected to help the doctors
to make a better decision. A standard procedure can be built up as doctors’reference.
4尤其對於重大疾病採用論病例計酬方式，來達成醫療資源的有效管理。
國內外相關研究顯示，論病例計酬制度的施行對於各項疾病的住院日及住院醫療費用
確實能縮短與減少(楊昱琦，2000)。過多的住院日並不能保證醫療品質的提升，反而可能會
造成院內感染等併發症，然而過短的住院治療也可能因為治療不足而影響病患的病情(曾維
功，2005)。
住院日常被視為醫療資源使用的指標之一，合適的住院日評估將有助於醫療資源的管
理與分配。因此，住院日的預測對於病患、家屬以及醫療資源利用是具有相當重要的意義。
近年來，為避免醫療資源過於浪費，健保給付制度不斷修正，健保局針對高利用與高費用
的診療項目進行嚴格審查，如白內障手術、全髖關節及全膝關節置換術等。而全膝關節置
換術所花費的醫療資源與費用比例是相當可觀的，如能預先根據病患身心狀況建立一套評
估標準，對於醫療資源分配上便能有效的控管與安排後續照顧。對於病患與家屬，更可免
除不必要的心理壓力以及術後的生活照顧安排。
五、研究目的
如何有效分配醫療資源對於醫院管理工作是一門相當重要的課題，而病患成本效益管
理則有賴於準確評估病患復原成效與資源利用率(Buchman et al., 1994) 。住院日(Length of
Stay, LOS)評估是一項相當具有挑戰性且困難的工作，但是對於如何成功的經營醫院卻是必
須的。
本研究的目的乃是要建構一個初期輔助臨床的評估系統以協助醫院在醫療資源規劃上
妥善分配。而從醫院經營管理角度而言，初期住院日評估可以協助醫師依據病患身心評估
狀況事先建立診療標準程序，在有限的醫療資源與人力情況下合理分配與評估住院日天數
與病床資源並可作為後續出院照顧計畫之安排；就病患與家屬觀點而言，可減少病患對本
身住院期間長短不確定性與減輕病患家屬精神壓力的心理調適。在術前並可根據自己的身
心狀況配合醫師診斷，有效降低併發症的機率與影響。
六、文獻探討
全膝關節置換術
由於醫藥醫學的進步，人類壽命的延長，老年人口持續增加，隨著年齡的增長，人的
骨骼、關節往往會因為退化或長期使用而導致磨損，而產生疼痛不適或造成行動不便，甚
至造成生活滿意度降低。而疾病到晚期時，關節的磨損程度更嚴重時，保守療法往往無法
緩解病患的疼痛，也無法改善關節的活動功能，因此需要接受人工關節置換術，藉此有效
解除病患的疼痛感，並改善關節活動功能。
骨性關節炎(退化性關節炎，Osteoarthritis)是目前施行人工關節置換術最常見的原因。
當關節炎較嚴重時，關節面軟骨會嚴重磨損破壞，甚至出現變形，往往會導致疼痛、功能
受限及行走不便，此時保守治療多成效不彰，人工關節是最佳的選擇；其它如類風濕性關
節炎或股骨頭缺血性壞死等，於較嚴重時亦常考慮人工關節置換；老年人移位性股骨頸骨
折為避免日後產生股骨頭缺血性壞死及骨折癒合不良併發症，亦是行人工關節置換的適應
症。人工關節置換後，大多數病患的疼痛可以減輕甚至完全解除，關節的功能及變形亦可
明顯改善。(陳威明，1996)
6與測試範例比率為 7:3。
資料預處理
根據模型之需求將輸入變數分為連續變數與類別變數，並進行轉換。其中定義為連續
變數之變項為：年齡(0~100)、疾病嚴重度(0~24)；而定義為類別變數之變項為：性別(男性
/女性)、開刀診斷原因(714 類風濕性關節炎及其他發炎性多發性關節病變/715 骨關節病及
有關疾患/716 其他關節病變/274 痛風)、醫師服務手術量(I/II/III/IV)、醫院權屬別(公立醫院
/私立醫院)與醫院層級別(醫學中心/區域醫院/地區醫院)。
案例式推理模型建立
模型建構流程
本研究之建構推理運作流程如下所述：
1. 輸入新案例：輸入目前所欲評估的新個案於本研究建構模型中。根據個案病患在本模型
所需輸入的個案資料與相關的因子，如性別、年齡、開刀診斷原因、痼疾、醫師手術服
務量、醫院層級別與醫院權屬別七個輸入變數等。
2. 分析問題：案例是由許多指標所組成，如何選擇案例指標做為評估個案的重要性因素，
將對於案例表示的完整性及評估後結果有著十分顯著的重要性。本研究根據合作研究醫
院所提供之健保申報記錄，以獲得重要的相關性評估指標。
3. 決定權重：根據各指標對於評估結果重要程度的不同，期望評估的結果能更合適於新個
案的使用。
4. 選取案例：案例庫中儲存多筆資料已供參考，藉由相似度比對找出最相似案例的解決方
法，進而評估其適合性。
5. 相似度法則：比對新個案的各屬性與案例庫中舊案例的屬性，由相似值最高的優先考
量，再評估所此相似案例是否適合於新個案。
6. 修正案例：當所挑選出的相似案例之解決方法不適合目前的新案例時，可透過臨床專業
醫師之領域知識進行修正相似案例的解決方案，使其更符合目前案例的解決問題，以決
定最終提供的方案。
7. 儲存案例：將可行的案例儲存於案例庫中，增加案例庫資料的完整性，並強化系統的彈
性與自我學習能力機制。
其推理流程圖參考相關文獻(Slade, 1991)如圖一所示：
82. 定量相似度
相鄰法(Nearest neighbor approach)是案例式推理中較常被應用於定量屬性的相似度計
算方法。其相似度計算公式表示如下所示：
max min
( & ) 1


Case Query
Sim Case Query
Case Case
(2)
Case ：案例屬性值。
Query ：查詢案例屬性值。
maxCase ：屬性值範圍的上限。
minCase ：屬性值範圍的下限。
3. 相似度計算
本研究之相似度計算採用 Kolodner 於 1993 年所提出相似度計算公式，如下所示：
1
1
( , )
( , )
n
input history
j j ij
jinput history
i n
j
j
w sim f f
Similarity f f
w






(3)
jw ：各個指標的權重值。
i ： index 。
n：指標個數，亦即評估指標關鍵索引。
input
jf ：輸入案例的第 j 個指標。
history
ijf ：案例庫中第 i個案例第 j 個指標。
( , )input historyj ijsim f f ：輸入案例與案例庫中的案例於第 j 個指標的相似度。
( , )input historyiSimilarity f f ：輸入案例與案例庫中第 i個案例的相似度。
由於屬性權重不易量化，故本研究係透過層級分析法(Analytic Hierarchy Process, AHP)
概念擷取專家意見，把複雜的評估問題以簡明的因素層級結構系統化及量化。層級分析法
是由 Satty、Hwang 與 Yoon 於 80 年代所發展出的一套理論。其進行步驟如下所述：
(1) 依據重要性強度尺度(Intensity Scale of Important)建立屬性間的成對比較矩陣
(Pairwise Comparison Matrix)。
(2) 計算成對比較矩陣之最大固有值(Eigenvalue)。
(3) 並求此相對之固有向量。
針對屬性之評量尺度，本研究參考鄧振源與曾國雄(1989)之評估尺度如表一所示，以決
定屬性間相對的重要程度與重要性比值。例如：屬性 X 較屬性 Y 為「極重要」的關係時，
則兩者間的比值為 7。因此，根據屬性間之相對重要程度比較產生成對比較矩陣 ijA a  ，
其成對比較矩陣如式(4)所示。
10
表三 全膝關節置換術住院天數評估指標層級分析問卷
絕
對
重
要
同
等
重
要
絕
對
重
要
A 性別 9 8 7 6 5 4 3 2 1 2 3 4 5 6 7 8 9 B 年齡
A 性別 9 8 7 6 5 4 3 2 1 2 3 4 5 6 7 8 9 C 開刀診斷原因
A 性別 9 8 7 6 5 4 3 2 1 2 3 4 5 6 7 8 9 D 疾病嚴重度
A 性別 9 8 7 6 5 4 3 2 1 2 3 4 5 6 7 8 9 E 醫院權屬別
A 性別 9 8 7 6 5 4 3 2 1 2 3 4 5 6 7 8 9 F 醫院層級別
A 性別 9 8 7 6 5 4 3 2 1 2 3 4 5 6 7 8 9 G 醫師手術服務量
B 年齡 9 8 7 6 5 4 3 2 1 2 3 4 5 6 7 8 9 C 開刀診斷原因
B 年齡 9 8 7 6 5 4 3 2 1 2 3 4 5 6 7 8 9 D 疾病嚴重度
B 年齡 9 8 7 6 5 4 3 2 1 2 3 4 5 6 7 8 9 E 醫院權屬別
B 年齡 9 8 7 6 5 4 3 2 1 2 3 4 5 6 7 8 9 F 醫院層級別
B 年齡 9 8 7 6 5 4 3 2 1 2 3 4 5 6 7 8 9 G 醫師手術服務量
C 開刀診斷原因 9 8 7 6 5 4 3 2 1 2 3 4 5 6 7 8 9 D 疾病嚴重度
C 開刀診斷原因 9 8 7 6 5 4 3 2 1 2 3 4 5 6 7 8 9 E 醫院權屬別
C 開刀診斷原因 9 8 7 6 5 4 3 2 1 2 3 4 5 6 7 8 9 F 醫院層級別
C 開刀診斷原因 9 8 7 6 5 4 3 2 1 2 3 4 5 6 7 8 9 G 醫師手術服務量
D 疾病嚴重度 9 8 7 6 5 4 3 2 1 2 3 4 5 6 7 8 9 E 醫院權屬別
D 疾病嚴重度 9 8 7 6 5 4 3 2 1 2 3 4 5 6 7 8 9 F 醫院層級別
D 疾病嚴重度 9 8 7 6 5 4 3 2 1 2 3 4 5 6 7 8 9 G 醫師手術服務量
E 醫院權屬別 9 8 7 6 5 4 3 2 1 2 3 4 5 6 7 8 9 F 醫院層級別
E 醫院權屬別 9 8 7 6 5 4 3 2 1 2 3 4 5 6 7 8 9 G 醫師手術服務量
F 醫院層級別 9 8 7 6 5 4 3 2 1 2 3 4 5 6 7 8 9 G 醫師手術服務量
依據表三之問卷填寫結果，建立成對比較矩陣，如下所示：
1 1 1 1 1 11 8 8 9 5 5 9
1 18 1 3 5 57 7
1 1 1 1 18 13 6 3 3 6
9 7 6 1 7 7 1
1 1 1 15 3 15 7 4 8
1 1 15 3 4 15 7 8
9 7 6 1 8 8 1
 
 
 
 
 
 
 
 
 
 
 
 
  
步驟二：計算權重值
1. 將成對比較矩陣中各行之元素加總，即可獲得行的總和值。
2. 再將各行中的元素分別除以行的總和值，可得一個新7 7 之矩陣。
3. 最終將此7 7 矩陣求其平均數，即為各屬性之相對權重值。
12
表六 完全比對(開刀診斷原因/醫師手術服務量)
開刀診斷原因
/醫師手術服務量
A(714/I) B(715/II) C(716/III) D(274/IV)
A(714/I) 1 0 0 0
B(715/II) 0 1 0 0
C(716/III) 0 0 1 0
D(274/IV) 0 0 0 1
而定量屬性則採用差距比對相似度計算公式加以衡量。而根據本研究之七項變因可歸
納如表七所示：
表七 案例庫因子分類表
全膝關節置換術健保資料庫
因子 內容
比對
方式
性別 A 男性 B 女性
邏輯
比對
年齡 依當年度申報年齡計算(0 歲~100 歲)
差距
比對
開刀診斷原因 A(714) B(715) C(716) D(274)
完全
比對
痼疾 依疾病嚴重程度加總計算(0 分~24 分)
差距
比對
醫師手術
服務量
A(I) B(II) C(III) D(IV)
完全
比對
醫院層級別 A 醫學中心 B 區域醫院 C 地區醫院
完全
比對
醫院權屬別 A 公立醫院 B 私立醫院
邏輯
比對
模型評估
利用測試範例進行驗證，其成效評估指標為準確率。
八、結果與討論
為了驗證本研究之醫療資源輔助規劃系統的可行性，本研究利用 2000 至 2003 年間全
膝關節置換術實際病患案例作為系統驗證之用。資料筆數總共為 16,064 筆，而其中作為系
統驗證之用採隨機選取 4,820 筆案例資料，讓個案推理診斷系統評斷，使用者可根據系統
所搜尋出最相似的前十筆舊有案例作為參考依據。
由於本系統為藉由解答屬性的相似程度來呈現其精確度，進而評估推理結果的正確性
與可靠性。解答屬性是以住院天數作為回應屬性，因此本研究以最末推薦結果案例之相似
程度稱為參考相似案例，而與案例結果符合之結果案例之相似程度稱為印證案例相似度。
由於住院天數對於不同醫療環境所造成誤差未知性，故本研究針對不同住院天數之容許天
數符合個數作為計算本系統之準確度。如表八所示。
14
【11】 Hwang C. L., Yoon K., 1981, Multiple Attribute Decision Making: Method and
Applications, Springer- Verlag, New York.
【12】 Saaty T. L., 1980, The Analytic Hierarchy Process, McGraw- Hill, New York.
