是將傳統之 GVF 之 vector flow 方向由原來的兩個方向拓展至 4 個方向，並將衝突之向量予以
刪除。此法雖可改善傳統 GVF 蛇型輪廓模型(Snake)之分割結果，但若影像中有目標發生重
疊，則無法得到理想的分割結果。(4) 在子宮頸癌的檢測方面，Tumer [18]等人利用某特定波
長的光束來照射子宮頸，並收集其反射之螢光光譜來作分析，以反射光不同頻率的強度作為
輻狀基底函數類神經網路(Radial Basis Function Neural Network, 簡稱 RBFNN)的輸入項，而網
路輸出則是子宮頸是否正常之機率。
在本計劃中，我們針對子宮頸抹片影像提出有效率的辨識方式，利用影像處理與圖形識
別的方法，分析子宮頸抹片病理影像之資訊，並提出一種改良式的輻狀基底函數(Radial Basis
Function) 類神經網路來做子宮頸癌抹片病理影像之學習與辨識。
輻狀基底函數類神經網路( RBFNN)[4]之主要概念是建構許多輻狀基底函數，以函數逼近
法(Curve Fitting)找出輸入輸出間的映射關係。其架構包括輸入層、單一隱藏層與輸出層，其
中每一隱藏層之神經元即代表一輻狀基底函數。此種網路之優點為學習時間相當快速，在建
構 RBFNN 時一般採用複合式學習法，即前階段以非監督式學習選取輻狀基底函數之中心點，
而後階段以監督式學習調整輸出層之連結權重向量。傳統之 RBFNN 以隨機選取法來決定中
心點之位置，其缺點在於：須具備大量的訓練範本資料，才能夠經由隨機選取來獲得具有代
表性之中心點。當輸入空間範圍很大時，選取之中心點個數須夠多才足以具備代表性。
在 RBFNN 之學習演算法方面，目前研究之成果如下：Chen 等人[19]提出一種垂直最小
平方法(Orthogonal Least Squares, 簡稱 OLS)來選取中心點，其想法主要是利用 Gram-Schmidt
正交化過程來求得互相垂直之中心點向量，而後段則採用最小平方法(LMS)調整輸出層之連結
權重向量。利用此種方法之優點為可獲得較少之中心點個數，然而缺點是輻狀基底函數之標
準偏差值無法預知。Ham [20]提出序率坡降法(Stochastic Gradient Approach, 簡稱 SGA)來同時
調整中心點向量、標準偏差及輸出層之連結權重向量，其精神類似傳統之誤差倒傳遞
(Back-Propagation, 簡稱 BP)演算法類似，因此會有收斂速度慢、容易落入局部極小點、任意
初始值無法獲得良好結果等缺點。
在本計劃中所我們以 Isodata [3]聚類演算法為基礎提出一種改良式的 RBFNN 學習演算
法來解決上述之問題。
貳、方法
本計劃大致分為四個步驟
(a) 影像前級處理
本計劃的影像前級處理分為彩色影像與灰階影像兩個部分。在彩色影像的部分，利用
RGB 與 HIS 模型對影像做分析，以獲得影像在彩色模型上的表現，找出細胞染色後在不
同損傷細胞間的差異。在灰階影像部分，主要包括影像增強及紋理分析，計算影像灰階度
之直方圖（Histogram），使用直方圖均化（Histogram Equalization）來增強細胞邊界，再進
一步分割出細胞正確輪廓。如圖一（a）和（b）所示，得知影像增強前後細胞邊界的差異。
本研究由資料庫中隨機選取一位病人資料，任意選取一張抹片影像，針對欲分析之細胞作
選取將其影像大小設定為 256×256。我們將藉由自行撰寫的彩色模型參數作分析；其次將
影像轉為灰階，所得為 8bits 之影像，然後藉由直方圖均化（Histogram Equalization）[29],[32]
的技術，針對影像作調節顯示，增強細胞質與細胞核之邊界，以增加主動輪廓模型分析之
準確度。
径為 r 之圓，首先我們可先將每一個圓 iC 內之像素灰度平均值 iI 與變異數
2
i 求出，若
某圓對應之變異數大於臨界值 T，則該圓之圓心必定接近細胞質或核之邊界，可先行
剃除。經剃除後假設剩餘 M 個像素點。
(2) 判斷此 M 個像素點所對應之圓 iC 內之像素灰度平均值 是否大於細胞核之灰度臨界
值 NT ，如是則該圓之圓心必定不屬於細胞核可將先行剃除。經剃除後假設剩餘 P 個像
素點。
(3) 將此 P 個像素點一次取兩個點形成一線段，檢查此線段上像素灰度是否小於細胞核之
灰度臨界值 NT ，如是則該兩個點應屬同一細胞核，删除兩點中之一點。經剃除後假設
剩餘 Q 個像素點。
(4) 以此 Q 個圓為初始輪廓，並執行蛇形演算法，其收斂輪廓即為細胞核之所在。
(5) 減少內力並將上述收斂輪廓向外拓展並執行蛇形演算法，其再次收斂輪廓即為細胞質
之邊界所在。
(c)細胞特徵參數抽取
子宮頸癌細胞在病理學上分為多種不同型態損傷，所表現的特徵也不相同。因此，在特
徵參數的選取部分，主要分為彩色影像分析與灰階影像分析的部分，並依細胞之輪廓平滑與
否、細胞核之大小等關係加以來探討。彩色影像分析的部分，透過 RGB 與 HIS 模型所計算出
之色彩參數，我們可以得知不同損傷細胞在色彩表現上之差異，以正常細胞所表現之參數值
為標準，可依不同之差異性將細胞型態做初步之分類。其次在灰階影像分析的部分，透過主
動輪廓模型圈選出的細胞核與細胞質輪廓，可計算出細胞之核質比及細胞輪廓長度，由文獻
[22]得知，病理師在鑑別細胞之正常或異常時，是根據細胞之濃染程度、細胞紋理、細胞核大
小及其核質比等特徵，而目前在臨床診斷上，對於濃染程度及其紋理分佈尚無量化的數值供
醫師參考。在病理學診斷上，損傷程度較嚴重之細胞，其濃染程度較明顯，如圖二；而異常
細胞之細胞核亦較正常細胞之細胞核來的大，不同種類之細胞其間之比率各不相同，如表一；
平均來說，當細胞核大小大於 Para-basal cell，如圖三，細胞核之 2 倍即可判斷為異常細胞。
透過主動輪廓模型，我們可計算出 Para-basal cell 之細胞核大小約為 82 pixels，由此可知，當
偵測之細胞其細胞核大小若大於 164 pixels 即判斷為異常細胞。。再根據影像前級處理所獲得
的參數值，包括：熵值、對比度等資訊，配合彩色影像分析所得之色彩特徵參數，即可將子
宮頸癌細胞做正確有效的分類。
圖二. HSIL 濃染細胞影像 圖三. Para-basal cell 影像
表一 抹片上細胞之細胞核平均大小[24]
低度 SIL 高度 SIL
排列 薄片狀 sheets 融合狀 syncytium
細胞形態 中間層，表層 基邊層，化生細胞
細胞邊緣 清 楚 不清楚的 ill-defined
細胞核的大小 2-6 倍 2-4 倍
核的不規則度 輕度到中度 中度以上
核質比 小到中 高
染色質 細 粗
為了實際運用於臨床上，故具有良好的運算能力及高準確之診斷能力是屬於必要之要
求。故在準確率的評估方面分為兩個部分，第一部分是辨識正常細胞與異常細胞；第二部分
是將辨識出的異常細胞作型態分辨。本研究將以臨床醫師的診斷結果與本系統之準確率
（Accuracy）、敏感度（Sensitivity）、有效性（Specificity）作一比較，以評估本系統之實用性。
其中，TP、 TN、FP 及 FN 在兩部分之系統評估中代表之意義分別如下圖四（a）（b）所示，
而 T、F、P、N 各別之定義如下：
T：系統對細胞型態判斷正確。
F：系統對細胞型態判斷錯誤。
P：細胞實際為異常細胞。
N：細胞實際為正常細胞。
正常細胞 異常細胞
系統判斷為正常細胞 TN FN
系統判斷為異常細胞 FP TP
（a）
LISL 細胞 HSIL 細胞
系統判斷為 LSIL 細胞 TN FN
系統判斷為 HSIL 細胞 FP TP
（b）
圖四 系統評估參數示意圖
（a）辨識正常細胞與異常細胞（b）辨識異常細胞型態
參、實驗結果
圖五為 RBFNN 之訓練過程圖，其中訓練參數分別為：中心點個數=50; 目標誤差=0.01; 中
我們同樣將測試影像透過貝氏網路作測試，其評估結果如表五所示，其 Accuracy、
Sensitivity 與 Specificity 值分別為 0.841、0.905 與 0.783。其中 2筆 FP 之影像為中間層
細胞，其細胞質及細胞核大小與 LSIL 較接近，受濃染程度亦較不明顯，因此本研究為了瞭解
是否因這 2筆資料造成系之準確率降低，我們排除這 2筆與 LSIL 特徵相似之細胞影像，再一
次透過 RBF 網路作測試，實驗結果如表六所示，Accuracy 提高為 0.881。因此，我們可以得
知當細胞特徵較不顯著時，在本系統中不易被正確鑑別。
表五 異常細胞型態鑑別結果之評估
異常細胞型態鑑別
TP TN FP FN Accuracy Sensitivity Specificity
18 5 2 19 0.841 0.905 0.783
表六 異常細胞型態鑑別結果之評估（去除 2 張 FP 影像）
異常細胞型態鑑別
TP TN FP FN Accuracy Sensitivity Specificity
18 5 0 19 0.881 1 0.783
肆、結論
在本計劃中，我們建構出一套適合子宮頸癌病灶輔助診斷的辨識系統，本系統的完成相信對
於子宮頸癌的偵測及預防有很大的幫助，也將使類神經網路理論之應用範圍更加地推廣，對
往後在其他研究領域的應用及整合技術的發展亦有啟發之作用。
參考文獻
[1] 臺灣地區歷年癌症死亡數統計，行政院衛生署，
http://www.doh.gov.tw/new/891115/891115-6.htm。
[2] 嚴孟祿、謝長堯，子宮頸癌在台灣，行政院衛生署 80 年度委託研究計畫成果報告，1991，
台北。
[3] J. T. Tou and R. C. Gonzalez, Pattern Recognition Principles, Addison-Wesley, 1974.
[4] 張斐章、張麗秋、黃浩倫，類神經網路-理論與實務，民國 92 年 9 月，東華。
[5] 阮正雄、傅堯喜、徐正光，子宮頸抹片與陰道鏡圖譜，嘉洲出版社，民國 91 年 1 月，台
北。
[6] 子宮頸癌篩檢的改進，長庚紀念醫院，
http://www.cgmh.org.tw/intr/intr5/c6700/CJTSENG2/education/b2.htm。
[7] 6 分鐘護一生—淺談子宮頸癌防護新進展，台灣大學附設醫院，
http://ntuh.mc.ntu.edu.tw/edu/health/54.htm
[8] V. Dadeshidze, L. Olsson and R. A. Domanik, “Segmentation of nuclear images in automated 
cervical cancer screening”, SPIE. Society for Optical Engineering, vol.1778, pp.52-63, 1995.
[9] R. Narayanswamy, J. P. Sharp, J. Heather, R. J. Stevart, and K. L. Johnson, “Morphological 
feature detection for cervical cancer screening”, SPIE. Society for Optical Engineering, vol.2424,
