 2
行政院國家科學委員會專題研究計畫成果報告 
多重位元率之代數碼激式語音壓縮演算法(MR-ACELP) 
之分析、實現與改進 
 
計畫編號：NSC 96-2221-E-218-059 
執行期限：96 年 08 月 01 日至 97 年 07 月 31 日 
主持人： 陳福坤 南台科技大學資工系 
共同主持人： 周裕達 陸軍軍官學校電機系 
計畫參與人員：蔡毓叡、陳冠銘 南台科技大學資工系 
 
摘要 
本計劃原規劃為三年期計畫，選定 MR-ACELP 語音壓縮演算法為主軸，但核定為一
年期，且刪除硬體實現經費，因此計畫執行略有減省。本計畫進行探索 MR-ACELP 之
整體壓縮、切換位元率方式、隨機碼簿架構，並建立軟體模擬平台。且我們對 MR-ACELP
語音壓縮中最低位元率的部份提出一新的「交替式搜尋法」。最後，為了能公正客觀的
衡量語音品質，我們將方法用到 ITU-T G.729D 語音編碼器上，因為目前只有 ITU 有完
整且正規的語音品質衡量系統。這篇論文已發表在 IEICE Trans. Information and Sys-
tems。 
關鍵詞：代數碼激式線性預測編碼(ACELP)、焦點搜尋法(Focused search)、深先搜
尋法(Depth first search)、交替搜尋法(Switching Search)。 
一、簡介 
因應語音壓縮的需求，ITU 隨即規劃 ITU4 標準，希望將語音壓縮編碼位元率降低至
4kbps (壓縮率：26 倍)，但已過近 5 年迄今未有結論。反而 ITU 目前比較被重視的是另
一輝煌成就：凌駕於 MPEG-4 的視訊(Video)壓縮標準 H.264 ；H.264 目前已收錄於
MPEG-4 Part. 10, AVC(Advanced Video Coding)。ITU4 語音壓縮演算法遲遲未定案的主
原因在考慮：到底繼續沿用並改善 ACELP 這種運算簡單的架構使其位元率降低，還是
變更為超低位元率之諧波編碼(Harmonic Coding)使其位元率提高但降低運算複雜度。但
在此時，在 ITU 4 (4 kbps)訂不出較低位元率的語音壓縮演算法下，歐洲 3GPP (the 3rd 
Generation Partnership Project)組織已逐漸主導目前語音壓縮 ITU 規範的地位，2004 年
12 月公告的最新語音壓縮演算法，其最低位元率可低至 4.75 kbps (壓縮率：21.9 倍)。
它考量了即時壓縮的必要性，因此繼續採用 ACELP 架構，此新定訂的 3GPP TS 26 Series
語音壓縮方式稱為多重位元率代數碼激式線性預測編碼(MR-ACELP)，有二大貢獻：一
是可在各種位元率下做切換；二是最低位元率可低至 4.75 kbps(壓縮率：21.9 倍)，優於 
ITU 目前訂的最低位元率 G729D 6.4 kbps(壓縮率：16.25 倍)降低了許多，所付出的代
 4
Track Pulse Positions 
1 i0 0, 5, 10, 15, 20, 25, 30, 35 
2 i1 1, 6, 11, 16, 21, 26, 31, 36 
3 i2 2, 7, 12, 17, 22, 27, 32, 37 
4 i3 3, 8, 13, 18, 23, 28, 33, 38, 
  4, 9, 14, 19, 24, 29, 34, 39 
表四、6.70 kbit/s 模式 ACELP 碼簿 
Track Pulse Positions 
1 i0 0, 5, 10, 15, 20, 25, 30, 35 
2 i1 1, 6, 11, 16, 21, 26, 31, 36, 
  3, 8, 13, 18, 23, 28, 33, 38 
3 i2 2, 7, 12, 17, 22, 27, 32, 37, 
  4, 9, 14, 19, 24, 29, 34, 39 
表五、5.90 kbit/s 模式 ACELP 碼簿 
Track Pulse Positions 
1 i0 1, 6, 11, 16, 21, 26, 31, 36, 
  3, 8, 13, 18, 23, 28, 33, 38 
2 i1 0, 5, 10, 15, 20, 25, 30, 35, 
  1, 6, 11, 16, 21, 26, 31, 36, 
  2, 7, 12, 17, 22, 27, 32, 37, 
  4, 9, 14, 19, 24, 29, 34, 39 
表六、5.15 和 4.75 kbit/s 模式 ACELP 碼簿 
Subframe Subset Pulse Positions 
 1 i0 0, 5, 10, 15, 20, 25, 30, 35 
1  i1 2, 7, 12, 17, 22, 27, 32, 37 
 2 i0 1, 6, 11, 16, 21, 26, 31, 36 
  i1 3, 8, 13, 18, 23, 28, 33, 38 
 1 i0 0, 5, 10, 15, 20, 25, 30, 35 
2  i1 3, 8, 13, 18, 23, 28, 33, 38 
 2 i0 2, 7, 12, 17, 22, 27, 32, 37 
  i1 4, 9, 14, 19, 24, 29, 34, 39 
 1 i0 0, 5, 10, 15, 20, 25, 30, 35 
3  i1 2, 7, 12, 17, 22, 27, 32, 37 
 2 i0 1, 6, 11, 16, 21, 26, 31, 36 
  i1 4, 9, 14, 19, 24, 29, 34, 39 
 1 i0 0, 5, 10, 15, 20, 25, 30, 35 
4  i1 3, 8, 13, 18, 23, 28, 33, 38 
 2 i0 1, 6, 11, 16, 21, 26, 31, 36 
  i1 4, 9, 14, 19, 24, 29, 34, 39 
二、代數碼激式語音編碼器(ACELP) 
在 ACELP 的架構中脈衝數量的多寡直接的會影響到語音品質，脈衝數越多的碼簿
結構，合成出來的語音訊號品質較佳，反之脈衝數越少，合成語音品質相對較低。3GPP 
AMR 5.90 kbit/s 模式之隨機碼簿的脈衝位置便使用了重疊分軌設計，以期能改善編碼語
音品質。對於目前低位元率語音編碼器中隨機碼簿搜尋而言，為了避免最佳脈衝位置偏
 6
 
k
t
k
k
t
k
tt
k
k
Dk
k
k E
CQ Φcc
cd
HcHc
cxH 222
t2 )()()(   (2) 
其中， xH td 為固定碼簿目標訊號與脈衝響應交相關係數，其表示式如下： 
       39039 2 ,,nnihixnd
ni


 (3) 
HHΦ t 為合成濾波器的脈衝響應 h(n)的自相關函數(Auto correlation)，其向量元素
表示式如下： 
 


39
)(),()(),(
jn
ijjnhinhji  (4) 
在進行碼簿搜尋時，需將二個脈衝位置代入(5)式來計算(2)式分子部份交相關函數
d(n)值： 
    2102 mdmdnCk   (5) 
其中 0m 代表脈衝 i0 的位置， 1m 代表脈衝 i1 的位置，而(2)式分母部份的展開式如下： 
      101100 2 m,m,mm,mmE    (6) 
原始標準的 3GPP AMR 5.90 kbit/s 模式固定碼簿搜尋是使用全搜尋法的方式，選出
最能夠合成目標訊號的一組位置向量。而利用全搜尋法來搜尋所有的脈衝位置組合數總
共有 512321161 CC 種組合，搜尋的計算量還是相當龐大。因此我們將針對 3GPP AMR 
5.90 kbit/s 模式隨機碼簿搜尋提出快速搜尋演算法。 
三、ACELP 固定碼簿搜尋法 
全域脈衝替換搜尋法 
我們發現全域脈衝替換搜尋法(Global Pulse Replacement Search)可直接應用於雙脈
衝的搜尋上，以下我們詳細介紹套用在 3GPP AMR 5.90 kbit/s 模式雙脈衝搜尋上，全域
脈衝替換法的搜尋流程。根據固定碼簿搜尋的定義，碼簿搜尋依據是在求出 4.2 式為最
大的脈衝組合，由此可知可令 4.2 式中分子部份求得最大的交相關係數 d(n)來考量與脈
衝出現的相對位置，因此我們以 d(n)做為起始搜尋的初始向量。首先，從 0T 和 1T 二軌
 8
因此用於雙脈衝搜尋的全域脈衝替換搜尋法，一開始以 d(n)為依據的初始向量搜尋
需要 32 個搜尋迴圈數，而第一次的脈衝交替搜尋則為 16 個搜尋迴圈數，所以基本的迴
圈數至少需要 32+16=48。而若未設定終止條件，則可能造成無窮搜尋迴圈的狀況發生，
使得相同的脈衝位置會不停的替換，所以我們加入一判斷條件，若脈衝組合所計算出的
kQ 值不再上升，則令此脈衝組合為所求得之解，不再繼續進行替換動作。因此在計算
量的分析上，我們無法先行估計得知正確的計算迴圈數，需由實際的運作來取得平均迴
圈數，經過我們實驗統計所得到的計算量為 54.18 個搜尋迴圈數。 
交替脈衝替換搜尋法 
依據以上所介紹的雙脈衝搜尋之全域脈衝替換搜尋法，雖然計算量已經降至原始標
準全搜尋法的 1/10 左右，但在不斷的替換搜尋過程當中，會造成一些冗餘的搜尋存在。
因此我們提出了交替脈衝搜尋方法(Switching Search, SS)，其搜尋程序可分為兩個階段： 
(1) 第一個階段的搜尋先從 0T 和 1T 二軌中找出令 )(nd 為最大值的脈衝位置，接著固
定此脈衝 i0 的位置，與 2T 、 3T 、 4T 和 5T 此四軌的 32 個脈衝位置做組合搜尋。
因此在這一個階段，會有 32 個脈衝位置組合和其對應所得到之一組最佳脈衝組
合的 kQ 值。 
(2) 第二個階段的搜尋則是反過來從 2T 、 3T 、 4T 和 5T 這四軌中，找出令 )(nd 為最大
值的脈衝位置，接著固定此脈衝 i1 的位置，與 0T 和 1T 二軌的 16 個脈衝位置做組
合搜尋。因此在這一個階段，會有 16 個脈衝位置組合和其對應所得到之一組最
佳脈衝組合的 kQ 值。 
最後由這兩個階段所得的最佳脈衝組合來比較 kQ 值， kQ 值較大者則做為輸出的碼
向量，因此兩個階段所搜尋的計算迴圈數加總為 16+32=48。 
交替脈衝替換搜尋法 
為了再降低交替脈衝搜尋法的計算量，我們再更進一步的去縮減搜尋脈衝的候
選位置，提出簡化式交替脈衝搜尋法(reduced switching search, RSS)。不同於交替脈
衝搜尋法，我們在第一個階段的搜尋脈衝位置數會縮減為 16 個，這是利用了 3GPP 
AMR 5.90 kbit/s 模式固定碼簿結構具有重疊分軌(Overlap track)的特性，因此我們提出
了兩種簡化式交替脈衝搜尋方法，來考慮有重疊位置的組合和沒有重疊位置的組合
之間的影響。 
第一種簡化式交替脈衝搜尋(RSS1)，我們將重疊分軌的特性考慮進去，搜尋程序
 10
體最佳化之解。因此，語音編碼品質評估的依據，須以編解碼後之語音為準。在以
實質編碼所得的語音品質為依據下，以下實驗均以實質 ITU 規範定點化版本 G.729
所使用的全搜尋法為比較基準。 
表 4.3 所呈現的比較數據分別為平均的 MOS-LQO 分數、與全搜尋法比較之
MOS-LQO 變化率、標準差和計算迴圈數。從數據中可發現我們所提出的各種交替脈衝
搜尋法計算量都比全域脈衝替換法還來的少，語音品質卻毫不遜色，甚至方法 RSS2 還
高於全搜尋法一些，這顯示結果並非異常，因為在 ACELP 語音編碼中，各級編碼程
序均會相互影響，逐級最佳化者，並非為整體最佳化之解。因此各級間累積的誤差，
將對編碼語音品質有所影響。而編碼語音品質依據乃以編碼後之整體語音為準，並
非僅以隨機碼簿這一級的目標向量為依據。 
表七、3GPP AMR 5.90 kbit/s 模式各搜尋法效能比較 
 FULL GPR SS RSS1 RSS2 
MOS-LQO (Mean) 3.6873 3.6824 3.6834 3.6841 3.6892 
MOS-LQO 
Variation (Bias) 
0 -0.1195% -0.0952% -0.0663% 0.0655% 
MOS-LQO 
Standard Deviation
- 1.404410-2 1.096310-2 1.905810-2 1.516610-2
Number of Loops 512 54.18 48 32 32 
 
五、結論 
本計畫針對雙脈衝之低位元率 ACELP 語音壓縮編碼器，提出快速簡化搜尋方法，
包括交替脈衝搜尋法和簡化式交替脈衝搜尋法。3GPP AMR 5.90 kbit/s 模式語音編碼器
是具有重疊分軌架構之隨機碼簿，因此針對此一特性，我們設計並研究了各種簡化搜尋
流程，以期能降低搜尋計算複雜度。在以 3GPP AMR 5.90 kbit/s 模式為實驗平台下，驗
證了所提出的交替脈衝搜尋各簡化方法，確已可有效降低計算複雜度至僅剩 1/16，且不
影響編碼語音的聽覺感官品質。為了能夠達到在語音編碼上的廣泛應用，本論文所提出
的所有快速搜尋演算法，皆能應用在各類 ACELP 語音編碼器的隨機碼簿搜尋上，並且
可視系統運作的能力來調整計算複雜度，藉此希望能夠有效的運用在行動裝置的通訊
