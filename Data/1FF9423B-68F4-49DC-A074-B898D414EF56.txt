II 
 
中文摘要 
依據本院經建會人口推估，65 歲以上人口比率將由2006 年9.95%，約227 萬人，
至2016年增為13%，約303 萬人，其中有5%的屬於失智人口，而其餘的95%屬於可自行生
活於家中。因此，以資訊技術輔助生活於家裡為政府的發展政策之一「大溫暖社會福利
套案」。本計畫建構可監測獨居老人的行動狀態和生理情況。在行動狀態的判斷採用3 軸
加速規建立使用者的動作軌跡，透過Self Organized Fuzzy Neural Network (SOFNN)
分類器討論走路、坐下和跌倒的動作分類。由於SONFIN為TSK的輸出，因此此系統亦可
以做為跌倒的風險指標。計畫中設計一可攜式裝置，置於使用者胸前，並可以測心電圖，
由於是測量動態心電圖，所以提出「去除生理訊號的晃動雜訊技術之架構及其方法」專
利，其是利用適應性濾波器，以加速規訊號為參考抵補源，強化所測量的生理訊號。 
 
關鍵詞：加速規、ECG、SOFNN、適應性濾波器 
IV 
 
中文摘要                                                      II 
目   錄 
英文摘要                                                      III 
目 錄                           IV 
一、前言                                                      1 
二、研究目的                                                  1 
三、文獻探討                                                  2 
四、研究方法                                                  7 
五、結果與討論                                                28 
六、文獻參考                                                  45 
七、計畫成果自評                                              48 
附件一、行政院國家科學委員會補助國內專家學者出席國際學術會議報告 
附件二、可供推廣之研發成果資料表 
附件三、A Novel Noninvasive Measurement Technique for Analyzing the  
Pressure Pulse Waveform of the Radial Artery 
附件四、A New Oscillometry-Based Method for Estimating the Dynamic  
Brachial Artery Compliance under loaded conditions 
附件五、Application of a Fuzzy C-mean Algorithm for Pulse Waveform  
Analysis in Patients with Myocardial Ischemia 
附件六、Abnormal matching between the left ventricle and the arterial system in 
patients with acute myocardial infraction after thrombolysis plus adjuvant 
 一、前言 
由於醫療科技的發達，國人的平均壽命不斷增長，而人口的年齡結構相對越趨高齡
化。根據財團法人工業技術研究院之研究報告[1]指出，到 2025 年我國六十五歲以上的
人口將佔總人口的 20%且比例與十四歲以下的人口比例相同。由此高齡化現象可知，未
來國人邁入高齡時將可能面臨缺乏子女照護，甚至是獨自生活的情況。因應上述必然之
趨勢，發展高齡者生活及健康照護機制便更顯重要[2-3]。 
由調查[4-7]顯示65歲以上老年人有三分之一到二分之一曾經跌倒過；而在這些有跌
倒經驗的老年人中，又有將近二分之一的老年人曾發生多次的跌倒。也就是說，平均約
每四名65歲以上老年人，就有一人曾經在過去一年當中，至少會跌倒一次以上，六成以
上發生在戶外，跌倒的地方並非凹凸不平之處，竟然以平坦路面最多。跌倒所造成的傷
害，輕者也許只是皮肉淤血，重者卻可能骨折、關節扭傷及軟組織損傷，老人跌倒更嚴
重的後果還有可能還會因為腦出血而導致中風，危及生命，導致老年人身心創傷因而造
成心理上恐懼再次跌倒而自我限制行動、長期臥床、依賴他人照顧、身體功能與獨立活
動能力逐漸喪失、增加罹病率及死亡率，增加家庭照顧及社會醫療保險的付出、提高社
會負擔成本。因此深入探討造成老人容易跌倒的成因是當今研究老年人功能障礙刻不容
緩的議題。 
 
二、研究目的 
因生活水平的提高與醫療技術的進步，醫療照護機構也愈來愈完善，使得人類的平
均壽命得以延長，老年人口也急速增加。依研究顯示：跌倒現象是社區老人普遍存在的
健康問題；而且，跌倒是老年人在家中經常發生意外事故之一，居家老人往往因跌倒導
致身體功能障礙、行動不便、活動受到生理上的限制，造成老年人喪失信心，心理上害
怕再次跌倒而自我限制活動、長期臥床或依賴他人照顧，身體功能與獨力活動能力逐漸
喪失、增加罹病率及死亡率，增加家庭照顧和社會醫療保險的付出、提高社會負擔成本。
因此，對於老人看護中，跌倒意外的發生已經成為照護的重點之一，因為跌倒意外的發
生對老人的生命健康造成極大的威脅[8-9]。本研究提出一套可應用於醫療照顧上的行為
3 
 
消耗的身體動作或姿態。 
由於ADL與PA的監測目的及項目不同，應用的監測技術也有很大差異。身體活動
監測項目包含：步態特徵、動/靜態活動分類、姿態、熱量消耗。主要以可穿戴式感測器，
配戴於身體特定部位達成身體活動監測。日常生活常見感測元件有開關類型、陀螺儀
(gyroscope)、加速規(accelerometer)、其他類型，如壓力感測元件。目前學、業界較感興
趣的感測元件為陀螺儀及加速規。 
陀螺儀(gyroscope)：陀螺儀為慣性感測元件，常見於航空航海用途，可量測物體旋
轉時的角速度或角位移 。如圖1基本構造是將一個繞固定軸旋轉的轉輪(spinning wheel, 
or rotor)，架設於兩個正交(orthogonal) 架撐的可動平衡環 (gimbals) 上。系統維持原有
的慣性，旋轉軸在空間上的座標改變時，會在該軸產生與角速度等比例的扭力。微機電
技術製作之微型陀螺儀，以高頻振動元件取代轉動件，以感測運動時伴隨的科氏力
(Coriolis force) 。 
 
圖1 陀螺儀基本構造 
加速規(accelerometer)：屬慣性感測元件(inertial sensor) ，可量測身體活動的加速
度。內部以懸臂樑結構感測加速度，加速度變化使振動質量產生位移。 
 
        圖2 壓阻式                    圖3 壓電式 
5 
 
立、走路的即時顯示系統，其不足之處在於只是描述人體姿態，並無使用任何程式或是
演算法來判斷行為。 
由 J. Y. Hwang, [26]等人於 2004年提出以藍牙建構一個即時的跌倒監測系統，作者
採用的傳感器分別有加速規和防螺儀並搭配演算法為設定閥值法(Threhold)，受測者以
三名 26 歲成人為主進行前跌、側跌、後跌和起立坐下來進行行為狀態分類，而此篇系
統的靈敏度(Sensitivity)為 95%，變異度(Specificity)為 100%。其不足之處在於受測者人
數不多，不能以少量的實驗數據來代替多數人的行為狀態。 
Tong Zhang[27]等人，在 2006年所提出的研究，作者們認為一個具有傳感器的穿戴
式的跌倒偵測系統有其可行性與有效性的，但是仍存在著些問題，例如人也許忘了穿衣
服，這套設備是採醫療設備的標準或是大眾市場的標準，如何控制虛警概率，因此作者
在系統架構改變為將加速規嵌入手機中，並由一搖控器來控制是否聯上網路，並使用
1-Class SVM (Support Vector Machine)的演算法來做預處理，此一預處理的演算法需要輸
入高維度的真實資料，然而實際上要一下子取得大量資料是很難的，因此作者採取兩階
段的方式進行跌倒分析的研究。第一階段為前文所提及之預處理的部份，第二階段以兩
種不同分類器下去做比較，分別為 KFD ( Kernel Fisher Discriminant )及 k-NN ( Nearest 
Neighbor )經由兩階段的跌倒分析出結果，一旦發生跌倒便經由手機連上網路，告知伺
服器端使用者跌倒的訊息。此篇研究分類結果在預處理時，即經 1-Class SVM (Support 
Vector Machine)且在較高階時得到最好的準確度 84.6%，而經過第二階段分類後平均準
確度為 93.3%。其不足之處，以老人來說並不習慣然手機長時間帶在身邊，大多喜歡放
在包包或家具上，以此說來如何能正確得到使用者行為狀態是引人爭議的部份。 
由 A.K. Bourke等作者於 2006年提出以下論點[28]，作者們認為老年人因身體機能
的退化，如肌肉力量和反應速度相對於年輕成人是退化許多的，因此在跌倒瞬間的加速
度相對會比年輕成年人大，而此反應於加速規電壓峰值上，相較於年輕人會有一個較高
的電壓峰值。 作者們以日常生活動作的訊號為基礎進行研究，他們更認為在軀幹和大
腿的加速規訊號會產生較大的峰值電壓。作者們將加速規配戴在胸前與大腿進行了兩部
份的實驗，一為以自願的 10名年輕成人進行模擬的跌倒測試，並以不同型態進行跌倒。
7 
 
四、研究方法 
4.1系統硬體架構 
本研究嘗試以加速度而產生電壓訊號的高靈敏度加速規與類神經網路結合，並加上
藍牙( Bluetooth )無線技術，如圖5為本研究系統硬體架構。主要以MSP430 F1611的3組
12-Bit ADC將加速規反應訊號（即1顆加速規，每顆均有XYZ三軸）之類比訊號轉換為
數位訊號再經藍牙無線技術傳送加速規資料，而接收端為具有藍牙接收模組之PC， PC
端利用圖控式程式語言（LabVIEW）將加速規反應訊號存取下來，再以MATLAB先擷取
AR Model參數，後再送入類神經網路來分類行動狀態。 
類比電路分析如圖 6所示，本系統採用了 ADI公司生產的儀表放大器，可以有效的
擷取人體 ECG訊號，如訊號需要調整放大倍率，僅需要多加一顆電阻，減少電路的複雜
度並且使用簡單、低雜訊，因而採用之。高通濾波器是指高於截止頻率之訊號通過，低
於截止頻率之訊號則衰減的電路，ECG的信號在 0.5Hz至 50Hz的範圍之間，故我們設計
高通濾波器截止頻率在 0.66Hz，使低頻的雜訊衰減。為了因應每個人體心臟電訊號的強
弱，我們特地使用 Microchip生產的數位電位計 IC，它具有 256 階 SPI 100kΩ雙通道
數位電位，將獲得的心電圖訊號，做非反向放大以利後續電路的處理和觀察。類比電路
中，最為常見是電源 60Hz 的雜訊，還有來自於非人體所能製造的高頻雜訊的干擾，因
此我們設計一低通濾波器截止頻率在 49.5Hz 擷取到我們想要的範圍。使用二極體將訊
號基線提升，藉以提高 ECG之準位，使訊號呈現在正半週，其電路圖如圖 7所示，實體
測量電路如圖 8所示，其貼放在受測者的乳線的左上方，如圖 9所示。ECG訊號傳輸至
PDA如圖 10所示。 
由於為4通道且AD為12 Bits，因此每個通道需要2 Bytes，共需8 Bytes，再加上碼頭2 
Bytes，所以每次取樣需傳送10 Bytes，詳細如下所述。 
9 
 
 
 
圖8 實體電路。 
 
圖9 電路人體擺放位置。 
 
圖10 ECG展現於PDA。 
採用之Kionix KXM52高靈敏度加速規，其工作原理為當加速規本體產生移動或轉
動時，使內部CMOS 微結構產生位移，造成電容值的變化，再轉換為特定的輸出電壓
為訊號。所需電源(Vdd)可在2.7(2.5)V 至5.5V之間，一般採用3.3V；C1 為電源端的濾
波電容，用來降低電源雜訊，其電容值建議採用0.1μF，必要時可外加亞鐵鹽(ferrite)環
/墊片(EMI core/bead)或於主電源電路串接小阻值的電阻以抑制雜訊；C1、C2、C3 分別
為X 軸、Y 軸與Z 軸輸出端的低通濾波電容，其電容值與感測器內部的等效電阻(32K
三軸加速規 
電極 
 
11 
 
 由XYZ 軸感測的電壓變化可以得之KXM52-1050 本體的傾斜角度，如圖12所示，
以φ 、ρ 與θ 分別代表X 軸、Y 軸與Z 軸的傾斜角度，加速度與傾斜角度之關係可
由式(2)描述。 
 
 
                   (2) 
 
圖12傾斜角度示意圖 
4.2系統程式架構 
 
13 
 
微控器本身內建的 USART 控制藍牙傳送，由於設計為以每秒 200筆來擷取動作訊號轉
換為數位訊號，因此輔助設計同位元檢查碼及資料封包來確保數位訊號不易遺失。 
由此設計方式即可推斷出資料封包以每秒 100K bits 的資料封包經藍牙將加速規反
應動作資料傳送至 PC端接收。 
4.2.2 LabVIEW軟體程式 
 
圖 15 LabVIEW程式架構圖 
如圖 15 ，LabVIEW程式架構圖，主要功能為以 USART控制藍牙接收動作資料封
包，並且將動作資料封包以 USART有線方式傳送至 PC端，再利用 LabVIEW建立起序
列埠通訊（Serial COM Port）功能的方式將動作資料成功地接收進 PC，並開始處理資料
封包，如圖 16為所建立之序列埠通訊程式流程圖，而圖 17為設計之前面板。 
15 
 
圖 18訊號儲存與波形顯示流程圖 
由圖 13，系統程式架構圖可知 PC端還需搭配 MATLAB執行參數擷取與分類器程
式，將由第三章進行詳給說明。 
4.3參數擷取與分類器 
本章說明參數擷取與分類器，包括了 AR Model、自我組織學習類神經網路分類器和
多層感知類神經網路分類器等部份。對於分類器的研究，有二個主要的議題，包括：模
糊類神經網路的架構設計及其相關學習演算法，因此，我們以 TSK 型模糊類神經網路
架構的線上學習演算法[29]。 
4.3.1 參數擷取 
將加速規的三軸訊號，以 Eq. (2.2.1)轉換為一合成訊號，由於人體動作的基本反應時
間約為 160~190 ms，至完成一動作，如坐下約 2~3秒，為能完全掌握各動作的訊號，因
此擷取 4秒的訊號。前文 2.2.1提及MCU的取樣頻率為 200Hz，我們在錄存的資料中對
於三個加速規挖取同一時間點且相同長度之加速規訊號，如圖 19，為加速規至於胸部，
走路時 4秒的加速規訊號。 
 
圖 19 
這 4秒資料只是一種走路的訊號，其他還有坐下、跌倒等，要同時讓分類器去分類，
這將會是一筆很大的資料，因此我們採用自回歸模型(AR(Autoregressive) Model)，來取
得每筆資料的特徵值。 
 當我們把人體動作的變化視為訊號源，此為白雜訊號(white noise )，三軸加訊規在
17 
 
                                                     (12) 
所以(9)式可以簡化為一自相關函數 
                            (13) 
(12)式與 AR模式的 Yule Walker的方程式相同，所以 相同於(3)式的 ，把(12)式展開
為矩陣型式 
              (14) 
解出上式 即為 AR模式的係數。 
 
4.3.2自我組織學習模糊類神經網路分類器(SONFIN) 
SONFIN為 Self-constructing Neural Fuzzy Inference Network，SONFIN為 TSK型模
糊類神經網路架構，是一五層架構，其中，第一層為輸入層，第二層為模糊法則的歸屬
函數，第三層為法則層，第四層為後鑑部層，第五層為輸出層。而所提出的線上學習演
算法包括了結構學習及參數學習，在結構學習方面，結合了輸入空間的分割及法則的產
生。至於參數學習方面，則是使用倒傳遞演算法。所發展的網路架構剛開始時，並無節
點(即法則)的存在，法則的產生完全由線上同時進行的結構及參數學習所完成，使用者
不需要事先設定法則數。 
圖 20為我們所使用的 TSK型模糊類神經網路(TSK-type fuzzy neural networks)的架
構圖，TSK 型模糊類神經網路以其五層網路架構來實現模糊推論機制的輸入、模糊化
(Fuzzifier)、IF-THEN規則及推論、解模糊化(Defuzzifier)、及輸出等五個單元。 
19 
 
)
σ
][
exp( 2
)1(
)2(
ij
iji
ij
mu
u =                                         (16) 
其中mij和σij
 第三層：在這一層中節點稱為法則節點(rule node)，而每一個節點代表一個模糊法
則，此層完成模糊邏輯法則前鑑部匹配工作，所以此模糊節點完成模糊且(fuzzy 
AND)或積(product)動作 
表示高斯歸屬函數之中心點(center)及寬度(width)。 
∏ )2()3(
i
ijj uu =                                                (17) 
 第四層：在這一層中節點稱為後鑑部節點(consequent node)，每個節點是第三層的
輸出乘上第一層和連結權重的線性組合， 
)( ∑
1
0
)3()4(
n
i
iijjjj xwwuu
=
==                                      (18) 
 第五層：此層的節點稱為輸出節點(output node)，在此層中，將完成解模糊化的動
作 
∑
∑ ∑
∑
∑
1
)3(
1 1
0
)3(
1
)3(
1
)4(
)5(
)(
p
j
j
p
j
n
i
iijjj
p
j
j
p
j
j
u
xwwu
u
u
uy
=
= =
=
=
=
===                        (19) 
 
TSK型模糊類神經網路之線上學習演算法 
我們所提出來的網路架構包括了二種學習演算法－結構學習(structure learning)和參
數學習(parameter learning)演算法，如圖 21所示。結構學習包含輸入空間的分割和模糊
法則的建立。而參數學習只要是來調整參數，我們是以倒傳遞學習演算法以得到最小的
誤差函數。所發展的網路剛開始時，並無節點(即法則)的存在，法則的產生由線上同時
進行的結構與參數學習所完成。 
21 
 
圖 22 法則產生流程圖 
 
Step 1: IF xi
      {Generate first rule 
 is the first incoming pattern THEN do 
       with mean mi1=xi, variance σi1=σinit
           weight w
, 
1
       where σ
=random 
init
} 
 is a prespecified constant. 
Step 2: ELSE for each newly incoming xi
{Find  
, do 
jRj
FF
t )(≤≤1
max max=  
 IF  FF ≥max  
    do nothing 
 ELSE 
 {R(t+1) = R(t)
  generate a new rule 
 +1 
with mean i
R
ij xm t == )1( , variance init
R
ij
t σσ )1( == , 
        weight randomw tRj == )1(  
  where σinit
} 
 is a prespecified constant.} 
圖 23 線上學習演算法之虛擬碼 
 
參數學習：倒傳遞學習演算法 
TSK型模糊類神經網路之初始架構完成後，接著進行參數學習。在每個節點下，此
網路架構可利用參數學習法則調整內部的歸屬函數和後鑑部參數至最佳組合。此網路架
23 
 
ijwijij wtwtw Δη)()1( ===                               (26) 
對於歸屬函數的參數更新公式如下: 
                  (27) 
                         (28) 
)(Δ)()1( tmtmtm ijijij ===                               (29) 
)(Δσ)(σ)1(σ ttt ijijij ===                                (30) 
因此，我們總結結構學習及參數學習之間關係的流程圖，如圖 24所示。 
25 
 
 
圖 25 多層感知類神經網路架構 
第一層神經元所接收到外部的輸入，如下： 
a0為輸入向量，                   (32) 
第二層為隱藏層，其中採用正切雙彎曲轉移函數(Tan-Sigmoid Transfer Function)其輸出如
下式： 
 , ,                            (33) 
第三層為輸出層，其輸出如下式： 
 , ,                            (34) 
參數學習：倒傳遞學習演算法 
MLPNN是採用倒傳遞演算法(BP)，來調整其間加權值，使其MSE(Mean Square Error)
減少；但為了縮短收斂時間，僅對誤差量大過 0.1的始作調整。參數初始值的設定，加
權值範圍在[-0.5 0.5]；偏壓值在[-0.2 0.2]，對每一子網路的學習過程如下： 
定義MSE如下 
                                (35) 
其中隱藏層的輸出向量 代表 Tan-Sigmoid函數，函數為： 
27 
 
圖26所示為適應性濾波器架構，其輸入訊號為ECG和其晃動雜訊(s+n)，參考輸入訊號
為加速規的三軸訊號和偏移量， ( ) = [  ( ) ( ), ( )]x y zX n C, Acc n , Acc n Acc n ，其中偏移量可以
為一固定值，C=1，濾波器的係數 = [ 0, 1, 2, 3]W w w w w ，其輸出為 = Ty XW ，偏移量的權
值w0已被證明為一高通濾波器其零點在0Hz[30]，濾波器在輸出和輸入的誤差量被定義
如下： 
= + - Te s n XW ,                                                (1) 
2 2= + - 2 + +T T Te ( s n ) ( s n )XW WX XW .                            (2) 
適應性濾波器所萃取的純ECG訊號是藉由使mean-squared-error (MSE)最小化完成，而
MSE 定義如下： 
   2 2[ ] = [( + ]+ 2 [( + ) ] + [ ]T T TE e E s n ) E s n X W WE X X W .                    (3) 
而least-mean-squares (LMS) 被使用來處理此最小化問題。根據此方法，濾波器的係數可
以藉由下式調整： 
   +1 = -Δt t tW Wα ,                                                   (4) 
其中α 用於調整LMS的收斂速度，其梯度定義如下： 
   
















∂
∂
∂
∂
=∇
=
3
]2[
0
]2[
w
eE
w
eE
tWW
t  .                                              (5)  
其估測梯度如下： 
29 
 
如圖 27為實驗流程圖，考慮到老年人不適合進行跌倒的測試，以 10名正常年輕人
且為自願者接受測試，分別找來 5名女性自願者，其平均身高及體重約為 159.6 cm及
48.2 kg；5名男性自願者，其平均身高及體重約為 173 cm及 67.4 kg。分別於胸、腹、
大腿各配帶 1顆加速規，在坐下、走路、跌倒情況下量測之並錄取訊號，每種類各錄存
了 20次資料，包含有 10筆訓練，主要用來調整類神經網路的法則節點和 10筆測試資
料，主要來看其分類正確與否。 
1.坐下：擬以四腳鐵椅進行測試來減少椅子滑動，每名受測者並配帶本研究所設計
之裝置進行測量，以 5秒為間隔發號令受測者進行坐下之動作，其示意圖如圖 28。 
 
圖 28坐下實驗示意圖 
2.走路：擬以一段長約 20公尺之直線距離，每名受測者於配帶本研究所設計之裝置
進行測量，其示意圖如圖 29。 
 
圖 29 走路實驗示意圖 
3.跌倒：擬建構一個安全且適合之空間，跌倒床墊為一張雙人氣墊床。受測者配帶
裝置後並以眼罩矇上雙眼，此做法主要希望受測者為不預期的正面跌倒，其示意圖
31 
 
 
圖 31為至於胸部的加速規訊號和其複合訊號 
第一為了解將加速規放置於身體何處具有較佳準確率，因此實驗我們採取以有線方
式在胸、腹、大腿擺放加速規來錄取坐下、走路及跌倒之訊號，以 SONFIN 及MLPNN
進行行為狀態分類。第二由圖 32-33，可得知每個人正面跌倒時不可能很正面的跌下，
有時偏左有時偏右。 
33 
 
選 10次當訊練和測試樣本，以 AR model的 60階參數當輸入，其認知器的效能展示於
表 10。 
因為 SONFIN的輸出層為 TSK model，因此其輸出值可以為任何數值，雖然我們採用 
Winner決策，來判斷動作行為，但此認知器亦可以做為跌倒的風險評估，圖 35(a)所示
為受測者在 4秒中內走路然後跌倒的實驗，我門每格 0.25秒抓取一斷資料，以 60階的
AR model參數去測試所訓練好的認知器，其輸出節果如圖 35(b)所示，坐下的值一直是
最小，一開始的走路輸出值最大，當發生跌倒時，跌倒的輸出值變為最大，但隨著受測
者跌倒後是躺在軟墊上，因此下一段的資料辨識值就開始下降，但仍是三種動作的最大
值。 
 
Table 1. Statistical parameters of the SONFIN for the training data with the accelerometer 
placed on the chest. 
Order of AR Activities Sensitivity Specificity Total classification accuracy 
 Sitting 0.46 0.815  
20 Walking 0.48 0.73 0.523 
 Falling 0.63 0.74  
 Sitting 0.56 0.975  
40 Walking 0.74 0.78 0.75 
 Falling 0.95 0.87  
 Sitting 0.88 0.995  
60 Walking 0.97 0.94 0.95 
 Falling 1 0.999  
 Sitting 0.9 0.995  
80 Walking 0.97 0.95 0.957 
 Falling 1 0.99  
 Sitting 0.95 0.995  
100 Walking 0.97 0.975 0.973 
 Falling 1 0.99  
35 
 
 Falling 0.96 0.95  
 
Table 4. Statistical parameters of the SONFIN for the testing data with the accelerometer 
placed on the chest. 
Order of AR Activities Sensitivity Specificity Total classification accuracy 
 Sitting 0.42 0.78  
20 Walking 0.5 0.71 0.493 
 Falling 0.56 0.75  
 Sitting 0.67 0.945  
40 Walking 0.65 0.835 0.737 
 Falling 0.89 0.825  
 Sitting 0.82 0.95  
60 Walking 0.87 0.91 0.863 
 Falling 0.90 0.935  
 Sitting 0.82 0.95  
80 Walking 0.87 0.91 0.863 
 Falling 0.90 0.935  
 Sitting 0.82 0.95  
100 Walking 0.88 0.91 0.867 
 Falling 0.90 0.94  
 
 
Table 5. Statistical parameters of the SONFIN for the testing data with the accelerometer 
placed on the waist. 
Order of AR Activities Sensitivity Specificity Total classification accuracy 
 Sitting 0.45 0.785  
20 Walking 0.57 0.725 0.53 
 Falling 0.57 0.785  
 Sitting 0.78 0.865  
40 Walking 0.77 0.89 0.78 
 Falling 0.83 0.865  
 Sitting 0.87 0.955  
60 Walking 0.88 0.935 0.887 
 Falling 0.91 0.94  
 Sitting 0.88 0.96  
80 Walking 0.88 0.94 0.893 
 Falling 0.92 0.94  
37 
 
 
Table 8. Statistical parameters of the BPNN for the testing data. 
Position Activities Sensitivity Specificity Total classification accuracy 
 Sitting 0.53 0.68  
Chest Walking 0.47 0.72 0.447 
 Falling 0.34 0.77  
 Sitting 0.52 0.79  
Waist Walking 0.80 0.635 0.547 
 Falling 0.32 0.895  
 Sitting 0.50 0.76  
Thigh Walking 0.67 0.615 0.483 
 Falling 0.28 0.85  
 
 
Table 9. Elders’ basic information. 
Elder Sex Age 
(Years) 
High 
(cm) 
Weight 
(Kg) 
1 Female 70 163 46 
2 Female 68 158 50 
3 Male 72 177 74 
4 Male 86 168 68 
5 Male 69 163 60 
6 Male 73 168 79 
7 Male 70 162 59 
 
 
Table 10. Statistical parameters for elders 
 Activities Sensitivity Specificity Total classification accuracy 
 Sitting 0.99 1  
Training Walking 0.96 0.97 0.967 
 Stairstep 0.96 0.98  
 Sitting 0.90 0.94  
Testing Walking 0.73 0.88 0.804 
 Stairstep 0.79 0.86  
 
 
39 
 
5.3 適應性濾波器實驗結果 
適應性濾波器採用的是重復的演算法，因此重復的次數將決定微控器的覆載量，，
所以我們利用一純淨的心電圖訊號，加入不同大小的雜訊量，再以不同的疊代次數，看
其濾波的效能，其所加入的雜訊能量的訊號雜訊比(SNR)由2.2 to 10.2 dB，圖36(a)所示
為一純淨的心電圖訊號，(b)圖為耦合雜訊的心電圖，其SNR為2.2 dB，再經過20次的疊
代演算，其結果如圖36(c)所示。圖37所示為不同的疊代次數和不同的耦合雜訊能量，其
濾波後利用均方誤差(MSE)比較濾波的效能，可以發現當疊代次數到達60次，濾波器即
達到收斂的效果。 
圖38所示為一受測者走路所記錄的Lead II 心電圖，加速規置於受測者左腳電極的
旁邊，加速規的三軸訊號如圖(c)(d)(e)，圖(b)為濾波後的訊號，在原始訊號中有雜訊的
振幅大於R波的振幅，但經過適應性濾波器的處理，可以發現雜訊會被抑制掉，突顯出
R波，同時由於適應性濾波器亦為一高通濾波器，所以其輸出的基準位亦歸為0。 
圖38所示為受測者不太晃動時測得的訊號，其濾波過後的訊號如圖(b)所示，可以
看出其濾波的效能不錯，由其當0.8秒時，受測有一些晃動，心電圖的基準亦有晃動，但
經過濾波後，此些雜訊皆濾除。最後我們亦利用高通Butterworth濾波器來濾除身體晃動
的雜訊，如圖38(a)的心電圖訊號，其截止頻率為5Hz，此為參考文獻[31]所述，其濾波
的結果如圖40所示，遠較適應性濾波器的效果差。 
41 
 
 
Figure 37. The performance comparison between the different levels of motion artifact being 
added to the uncouple ECG for the different iteration’s numbers. 
43 
 
 
Figure. 39. The performance of the adaptive filter under without movement, (a) the real 
recoded ECG, (b) the filtered ECG, (c) the X axis signal of the accelerometer, (d) the Y axis 
signal of the accelerometer, and (e) the Z axis signal of the accelerometer.  
45 
 
6. 文獻參考 
 
[1]易芝玲, “遠距居家照護服務 ”, 產業科技創新國際研討會, 國家圖書館國際會議廳, 
2003 
[2]W.C. Kao, W.H. Chen, C.K. Yu, C.M. Hong, S.Y. Lin ,“Portable real-time homecare 
system design with digital camera platform”IEEE Transactions on Consumer Electronics, 
vol. 51, Issue 4, Nov. 2005 ,pp: 1035–1041 
[3]R. Isais, K. Nguyen, G. Perez, R. Rubio, H. Nazeran,“A low-cost microcontroller-based 
wireless ECG-blood pressure telemonitor for home care,”Engineering in Medicine and 
Biology Society, 2003. Proceedings of the 25th
[4] N. Noury , “A Smart Sensor Based on Rules and Its Evaluation in Daily 
Routines.”Proceedings of the 25
 Annual International Conference of the 
IEEE, vol. 4, 17-21 Sept. 2003 ,pp: 3157–3160 
th
[5] A. Sixsmith, N. Johnson, “A Smart Sensor to Detect the Falls of the Elderly.”Pervasive 
Computing, 2004, Apr-Jun: pp.42-47. 
 Annual International Conference of the IEEE EMBS 
Cancun, Mexico, 2003, pp. 3286-3289. 
[6] C.W. Lin, “Compressed-Domain Fall Incident Detection for Intelligent  
Home Surveillance.” Proceedings of IEEE International Symposium on Circuits and Systems, 
ISCAS 2005, pp. : 2781-3784. 
[7] N. Noury,  “A Smart Sensor for the Remote Follow up of Activity and Fall Detection of 
the Elderly.” Proceedings of 2nd Annual International IEEE-EMBS Special Topic 
Conference on Microtechnologies in Medicine & Biology, 2002, pp. : 314-317. 
[8]  N.S Liang, L.C. Fu, C.L. Wu, “An integrated, flexible, and Internet-based control 
architecture for home automation system in the Internet era,” Robotics and Automation.”,  
Proceedings. ICRA '02, vol. 2, May, 2002, pp: 1101-1106.  
[9] S.M. Baek, K.B. Chang, I.J. Shim, G.T. Park, “Implementation of smart home control 
using LabVIEW/sup TM/ and PDA,” Consumer Electronics, IEEE International 
Symposium, Step, 2004, pp:558-562.  
[10] S. M. Kay, “Modern spectral estimation: Theory and application,” Prentice Hall, New 
Jersey, 1988. 
[11] Jung C. F., and Lin C. T., “An on-line self-constructing neural fuzzy inference network 
and its application”, IEEE Trans. Fuzzy Syst., 1998, 6:p.12-32. 
47 
 
on fall characteristics.” Ann Rheum Dis 1994,pp.:733-5 
[25] G.M. Bertolotti, A. Cristiani, R. Gandolfi, R. Lombardi, “A portable system for 
measuring human body movements.” Proceedings of the 9th
[26] J.Y. Hwang, J.M. Kang, Y.W. Jang, Y.W. Jang, H.C. Kim, “Development of Novel 
Algorithm and Real-time Monitoring Ambulatory System Using Bluetooth Module for 
Fall Detection in the Elderly” Proceedings of the 26
 EUROMICRO Conference on 
Digital System Design (DSD’06) 
th
[27] T. Zhang, J. Wang, P. Liu, J. Hou, “Fall Detection by Embedding an Accelerometer in 
Cellphone and Using KFD Algorithm”, IJCSNS International Journal of Computer 
Science and Network Security,vol.6 , Oct, 2006, NO. 10 
 Annual International Conference of 
IEEE EMBS, Sep. 1-5,2004. 
[28] A.K. Bourke, J.V. O’Brien, G.M. Lyons, “Evaluation of a threshold-based tri-axial 
accelerometer fall detection algorithm.” Gait & Posture, vol. 26, 194-199, 2007. 
[29]莊家峰，具線上學習能力之自我建構類神經模糊推理，交通大學博士論文，1996 
[30] B. Widrow, J. R. Glover, J. M. McCool, J. Kaunitz, C. S. Williams, R. H. Hean, J. R. 
Zeidler, E. D. Jr, R. C. Googlinb, “Adaptive noise cancelling: principles and 
applications,” Proc. IEEE., 63:1692-1716, 1975. 
[31] A. Ruha, S. Sallinen, S. Nisssila, “A real-time microprocessor QRS detector system with 
a 1-ms timing accuracy for the measurement of ambulatory HRV,” IEEE Trans. Biomed. 
Eng., 44: 3159-3167, 1997. 
 
49 
 
Novel Noninvasive Measurement Technique for Analyzing the Pressure Pulse Waveform 
of the Radial Artery”, IEEE. Transaction on Biomedical Engineering, Vol. 55, No. 1, pp. 
286-297, 2008. (SCI, Corresponding author) (附件 3) 
[2] Shing-Hong Liu, Jia-Jung Wang and Kuo-Sheng Huang, “A New Oscillometry-Based 
Method for Estimating the Dynamic Brachial Artery Compliance under loaded 
conditions”, IEEE. Transaction on Biomedical Engineering, Vol. 55, No. 10, pp. 
2463-2470, 2008 (SCI, Corresponding author) (附件 4) 
[3] Shing-Hong Liu, Kang-Ming Chang, Jian-Jung Chen, Kuo-Tai Tang, “Application of a 
Fuzzy C-mean Algorithm for Pulse Waveform Analysis in Patients with Myocardial 
Ischemia,” International Journal of Electrical Engineering, Vol. 15, No.5, pp.399-407, 
2008. (EI,  Corresponding author) (附件 5) 
[4] Chun-Peng Liu, Jia-Jung Wang, Wei-Chih Hua, Shing-Hong Liu, “Abnormal matching 
between the left ventricle and the arterial system in patients with acute myocardial 
infraction after thrombolysis plus adjuvant angioplasty”, Biomedical Engineering: 
Applications, Basis and Communications, Vol. 20, No. 4, pp. 223–230, 2008 (SCI) (附件
6) 
[5] Tsu-Hsun Fu, Shing-Hong Liu, Kuo-Tai Tang, “Heart rate extraction from the 
photoplethysmogram waveform using wavelet multi-resolution analysis”, Journal of 
Medical and Biological Engineering, Vol. 28, No. 4, pp. 229-232, 2008. (EI). (附件 7) 
[6] Shih-Chung Yang, Shing-Hong Liu, Kang-Ming Chang, “Iothalamate meglumine 
induced transient tachycardia during intravenous bolus injection for CT and parameters 
related to its discomfort”, Chinese J. Radiology, Vol. 33, No. 3, pp.131-136, 2008. (附
件8) 
[7] Shing-Hong Liu, Kang-Ming Chang, Chu-Chang Tyan, “Fuzzy C-means 
clustering for myocardial ischemia estimation with pulse waveform analysis”, 
Biomedical Engineering: Applications, Basis and Communications, Vol. 21, No. 2, 
pp.139–147,2009. (SCI, EI) (附件9) 
[8] Shing-Hong Liu, Jia-Jung Wang, Da-Chuan Cheng, “Non-invasive determination 
of the instantaneous brachial blood flow using the oscillometric method”, Biomed. 
Tech. Vol. 54, pp.171-177, 2009. (SCI EI) (附件10) 
[9] Shing-Hong Liu, Chu-Chang Tyan, Kang-Ming Chang, “A Novel compliance 
measurement in radial arteries using strain-gauge plethysmography”, Physiol. 
Meas., Vol.30, pp. 947–956, 2009. (SCI, EI, Corresponding author) (附件11) 
[10] Shing-Hong Liu, Yuen-Jen Chang, “Using Accelerometers for Physical Actions 
Recognition by a Neural Fuzzy Network”, Telemedicine and e-Health, Vol.15, No. 
9, pp. 867–876, 2009. (EI, SCI, Corresponding author) (附件12)  
[11] Da-Chuan Cheng, Arno Schmidt-Trucksaess, Shing-Hong Liu, Xiaoyi Jiang, "Improved 
arterial inner wall detection using generalized median computation,", Lecture Notes in 
 行政院國家科學委員會補助國內專家學者出席國際學術會議報告 
                                                     2009年 10月 21日 
報告人姓名 
 
劉省宏 
 
服務機構 
及職稱 
朝陽科技大學 
資訊工程系 
副教授 
     時間 
會議 
     地點 
2009.10.17–2009.10.19 
中國天津 
本會核定 
補助文號 
NSC 96-2221-E-324 -054 -MY3  
會議 
名稱 
 (中文) 第 2屆國際生物醫學工程暨資訊研討會 
 (英文) The 2 th International Conference on Biomedical Engineering and 
Information 
發表 
論文 
題目 
 (中文) 以 Kalman Filter來去除光容積晃動雜訊用於監示 CT的檢查 
 (英文) Using a Kalman Filter to Compensate for 
Photoplethysmogram Artifacts when Monitoring CT 
Examinations 
(中文) 以 ECG、加速規和來芽傳輸製作可攜式的睡眠監測 
 (英文)  Portable Sleep Monitoring by ECG and Accelerator and 
Bluetooth Transmission 
一、參加會議經過 
BMEI’09為每年舉辦一次，今年於10月17日–10月19日在中國天津的賽象飯店舉
行。這個研討會的目的是為因應近年來醫學工程各項科學與技術的快速發展，提供一個
公開的論壇，令醫學工程師與醫學物理學家可以彼此討論與交換各種想法，進而促進這
個領域的進步。此次由中華民國生物醫學工程學會鼓勵國內醫工學門的學者參與此會
議，且此會議的論文收錄於EI和IEEE Xpole，足以證明此會議在醫工領域的重要性。本
次會議有多名亞洲學者受邀為Keynote Speakers，如Dr. Bin He、Prof. Wen-Lian Hsu、
Prof. Ngan、Prof. Yuan-Ting Zhang。會議分為三大主軸：醫學電子與資訊、生物力學
和生醫材料，本人主要是參與醫學儀錶和生醫訊號處理，今年在Hearlthcare的文章較
少，或許是這些年來已有多次相關的研討會舉辦過，本次會議多為醫學影像的議題。本
次的舉辦場所在中國天津，使得本人在會議空閒之於能參觀中國北京和天津的發展與進
步，實為本次會議的另一項收獲。 
附件一 
 四、攜回資料名稱及內容 
大會論文集包含主辦者致詞、演講者的講稿摘要與每位參會者書面論文彙編，論文
集名稱為「2th International Conference on Biomedical Engineering and Information, 
2009 Proceedings」。大會雖然對會場的服務好，且供應非常好的午餐和晚餐。 
     
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 推廣及運用的價值 
增加可攜式裝置測量訊號的穩定度。 
※ 1.每項研發成果請填寫一式二份，一份隨成果報告送繳本會，一份送 貴單
位研發成果推廣單位（如技術移轉中心）。 
※ 2.本項研發成果若尚未申請專利，請勿揭露可申請專利之主要內容。 
※ 3.本表若不敷使用，請自行影印使用。 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
TYAN et al.: NOVEL NONINVASIVE MEASUREMENT TECHNIQUE FOR ANALYZING THE PRESSURE PULSE WAVEFORM 289
Fig. 1. Diagram of the three axial directions.
Fig. 2. Actual (D ) and vertical (D ) displacements of the radial artery as
detected by a sensor at different positions, whereD = D  cos.
the optimal measurement point. The location on the axis
is actually the pressure exerted by the sensor on the artery,
so it can be viewed as the transmural pressure. Driscoll et al.
[13]–[15] reported that exerting greater pressure on the skin
increases the radial pulse amplitudes, especially those of the
harmonics. However, if the exerted pressure exceeds a certain
level, the pulse amplitudes and wave velocity all decrease.
These observations were confirmed by Yoon et al. [16], which
implies that the transmural pressure has a significant impact on
the PWA and the pulse-wave velocity.
Prompted by the aforementioned observations, we have de-
signed a two-axis mechanism and a standard positioning proce-
dure for detecting the optimal measurement site for accurately
measuring the PPW. A modified sensor was designed to detect
the arterial diameter changed waveform (ADCW) and PPW si-
multaneously. We analyzed the vascular geometry to estimate
the optimal position and the radial artery width, and used an
artery model to estimate the optimal position for the PWA.
We also used the echo method to measure the radial artery outer
diameter in ten healthy subjects. The error between the esti-
mated radial artery width and the actual outer diameter could
be considered to be the resolution of the axis scanning pro-
cedure—this error was less than 0.5 mm. Finally, we diagnosed
the positive and negative myocardial-ischemia symptoms in 60
patients whose chief complaint was chest pain, using the exer-
cise electrocardiogram (ECG) as a reference. We then recorded
their PPWs using our designed two-axis mechanism and stan-
dard positioning procedure. A parameter of the PWA also could
be used to distinguish the positive and negative groups.
The purpose of this research was to develop a new noninva-
sive measuring apparatus that has a two-axis mechanism and
employs a standard positioning procedure for detecting the op-
timal measurement site for accurately measuring the PPW. The
paper is organized as follows. Section II describes the two-axis
mechanism apparatus, artery model, and our method for ana-
lyzing the vascular geometry. Section III presents our standard
positioning procedure and clinical test methods, and Section IV
presents the results for the resolution of the axis scanning pro-
cedure and the diagnosis of myocardial ischemia symptom with
the PWA. The results are discussed and conclusions are drawn
in Section V.
II. MEASUREMENT SYSTEM
In this section, we describe the noninvasive measurement
system used to record the PPW, which is based on a modified
sensor. In order to obtain an accurate PPW, the sensor must be
placed directly above the middle of the radial artery, and then
the transmural pressure between the sensor and artery is set to
zero so as to maintain an optimal coupling condition. According
to our geometry analysis, the amplitude of the ADCW is max-
imal when the sensor is placed over the middle of the artery.
Therefore, we modified a sensor so that it could simultaneously
measure the PPW (using a pressure transducer) and the ADCW
(using a strain gauge). We also designed a two-axis mechanism
and employed a standard positioning procedure to detect the
optimal measurement position on the and axes.
A. Vascular Geometry Analysis
The sensor can measure the ADCW as it moves across the ra-
dial artery. If the sensor is displaced from the middle of arterial
width, the vertical component of the change in the arterial diam-
eter is a triangular function, as shown in Fig. 2. When the artery
expands, the actual displacement of the arterial wall is
almost the same around its circumference. However, when the
sensor is not positioned vertically above the middle of the artery,
the relationship between the vertical displacement and the
actual displacement is given by , where
is the included angle between the middle position and the offset
position. decreases as this angle increases and, hence, a
strain gauge was used to measure changes in . Therefore, as
the sensor is scanned across the radial artery, increases to
and then decreases, with the measured ADCW amplitude
and the signal-to-noise ratio (SNR) changing in the same way.
These changes allow the optimal axis position to be found.
2464 IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 55, NO. 10, OCTOBER 2008
Fig. 1. Schematic of the oscillometry method in which artery and air-cuff
models are used to determine the loaded arterial compliance.
loaded compliance of the brachial artery. We used an airflow
meter and a pressure transducer to record the pumped airflow
and cuff pressure, respectively, to characterize the cuff that com-
prises both the tissue properties and the elastic cuff mechanism
in each oscillometric measurement [15]–[18]. In the cuff de-
flation, the oscillation amplitude (OA) was extracted from the
oscillation waveform of cuff pressure. A change in the arterial
volume embedded in the cuff volume can be derived from the
cuff characteristics and OA. Thus, a nonlinear relationship be-
tween the changed volume and the cuff pressure in a brachial
artery can be obtained. Finally, this study examined 32 patients
who complained of numbness or lack of strength in the lower
limbs to measure the arterial compliance (Cecho) with the diam-
eter and flow velocity of brachial artery.
This paper is organized as follows. Section II describes the
designed measurement apparatus and the method used to calcu-
lateCosci . Section III presents the standard calibration procedure
and the clinical test methods, and Section IV the results from
comparisons of Cecho . The results are discussed and conclusions
are drawn in Section V.
II. MEASURING DYNAMIC COMPLIANCE
Fig. 1 shows the schematic of how to employ the artery and
air-cuff models to determine the loaded arterial compliance via
the oscillometric method. Because the relationship between the
arterial pressure and volume is nonlinear, the changes in arterial
volume should not be proportional to the cuff pressure. In the
skin-surface-based detection method, a volume pulse from the
underlying artery needs to transmit through the intermediate tis-
sue and the cuff cover before it can be detected. If the cuff is
tightly wrapped around the arm during the deflation period, the
cuff model must consist of the intermediate tissue characteris-
tics and the elastic cuff mechanism [15], [16]. By the way, the
arm geometry and the interaction between the cuff and upper
arm should also be included in the cuff model. Once the cuff
model in each measurement is established, the change in the
arterial volume can be estimated. According to the fact that a
nonlinear relationship between the arterial changed volume and
the transmural pressure exists in an artery [17], [18], the loaded
C–P curve may thus be determined as the change in the arterial
volume divided by the blood pulse pressure.
Fig. 2 shows a block diagram of the proposed measure-
ment system. The oscillometry system contained a cuff, an
Fig. 2. Block diagram of the proposed measurement system. The thick arrows
(→) represent air pathways, thin arrows (→) represent electric current flow, F
is the pumped flow, PC I is the cuff pressure during the inflation period, PC D
is the cuff pressure during the deflation period, VC is the cuff volume, RRA
represents the recursive regression approach, RWRA represents the recursive
weighting regression approach, Ccuﬀ represents the slope of the cuff model,
OA˜s represent the estimated OAs, and Vpulse artery is the change in the arterial
volume.
air-pumping motor, a releaser valve, a pressure transducer, and
an airflow meter. The airflow meter and pressure transducer si-
multaneously recorded the pumped airflow and cuff pressure
during the inflation period, with the airflow converted into the
volume by integration. The relationship between the cuff pres-
sure and the cuff air volume (i.e., the cuff model) was con-
structed by a recursive regression approach (RRA) that allowed
artifacts introduced by the blood pressure waveform and pump-
ing motor to be removed. During the deflation period, only the
pressure transducer recorded the cuff pressure, from which the
oscillation waveform was extracted. However, the OAs are not
only related to the volume change of the brachial artery, but are
also influenced by cardiovascular diseases and artificial motions
during clinical measurements. Fuzzy logic discriminator and a
recursive weighting regression approach (RWRA) as described
by Lin et al. [19] were used to construct the oscillometry model
with the cuff pressure and OAs as input. This method can be
applied to effectively reduce the noise level in the OAs.
A. System Design
We used the MSP430 microcontroller that exhibits ultralow
power consumption and has useful functions for building a
portable apparatus. In the sensing module of Fig. 2, a silicon-
membrane pressure transducer (range: 5 psi; SCX05DNC,
SenSym) was used to measure the cuff pressure, which was
calibrated using a mercury column sphygmomanometer. When
the analog cuff pressure signal (PC ) was bandpass filtered from
0.1 to 3 Hz to yield the oscillation signal, maximum change
in positive slopes was used to find the OAs on the oscillation
signal [17]. During the peak detection process, the oscillation
signal slope was measured periodically at rising side, and unless
the slope meets some predetermined criteria, the peaks would
be measured and compared. The airflow meter (AWM3300,
Honeywell) has a range of 1000 sccm. The cuff pressure, oscil-
lation waveform, and airflow signals were then digitized using
a 12-bit A/D converter at a sampling rate of 250 Hz. Because of
airflow and pumping-time limits, we used pulse width modula-
tion to control the pumping rate of the motor during the inflation
period and the deflation rate of the releaser valve during the de-
flation period.
Authorized licensed use limited to: CHAOYANG UNIVERSITY OF TECHNOLOGY. Downloaded on October 4, 2008 at 21:24 from IEEE Xplore.  Restrictions apply.

August 6, 2008 12:13 00081
224 C.-P. Liu et al.
LV mechanical eﬃciency may tend to correlate linearly with the ventriculo–arterial coupling index, although
the abnormal coupling between the left ventricle and arterial system still exists.
Keywords: Ventriculo–arterial coupling; Eﬀective arterial elastance; Ventricular elastance; Mechanical
eﬃciency; Acute myocardial infarction (AMI); End-systolic pressure–volume relation.
INTRODUCTION
The performance of the cardiovascular system depends
prominently on the interaction of the left ventricle and
arterial system. Thus, left ventriculo–arterial coupling,
one of crucial determinants of cardiovascular function,
has a signiﬁcant eﬀect on both the magnitude and
eﬃciency of transfer of left ventricular (LV) stroke
work to the arterial system.1–5 As shown in previous
studies,2,6–9 the coupling between the left ventricle and
arterial system can be quantitatively explained by using
LV pressure–volume planes. In addition, LV pump-
ing performance can be characterized by the ventric-
ular end-systolic pressure–volume relationship (Ees),
whereas the LV afterload, i.e. the arterial system, can
be similarly measured using the arterial end-systolic
pressure–stroke volume relationship (Ea). Thus, the
Ees/Ea ratio may serve as a reliable index for evalu-
ating the ventriculo–arterial coupling.
It is believed that in normal physiological conditions,
the arterial system and left ventricle are virtually opti-
mally matched and work at an Ees/Ea ratio close to
unity. Simultaneously, the left ventricle can provide the
arterial system with maximal stroke work under the
optimal coupling situation.4,5,10 On the contrary, the
ventriculo–arterial coupling may become suboptimal in
various cardiovascular diseases or in diﬀerent stress con-
ditions. For instance, heart failure generally results in
a reduced Ees and an increased Ea, thus diminish-
ing the Ees/Ea ratio.3,5,11–13 Also, in patients with
acute myocardial infarction (AMI), Ea may maintain
unchanged but Ees may be decreased, leading to an
Ees/Ea ratio of less than one.1,9 Thus, the ventriculo–
arterial coupling in infarcted hearts may be diﬀerent
from that in normal hearts and is worthwhile further
investigation.
Accordingly, the purpose of this work is to examine
the ventricular–arterial coupling relationship in normal
sinus rhythm condition in patients with post-AMI after
thrombolysis and percutaneous coronary intervention,
to make sure whether a linear correlation between one of
the two volume elastances (Ees and Ea) and the Ees/Ea
ratio exists in infarcted hearts, and to see whether there
is a linear correlation between the mechanical eﬃciency
of the left ventricle and the Ees/Ea ratio, when the EF
is greater or less than 50%.
MATERIALS AND METHODS
Patient Population
Twenty-six patients with single-vessel AMI were stud-
ied in the catheterization laboratories of the Kaohsiung
Veterans General Hospital, Kaohsiung, Taiwan. AMI
was documented by symptoms, cardiac enzymes, and
abnormalities of electrocardiogram (ECG). Excluded
from the current study were the patients who had atrial
ﬁbrillation, obvious valvular disease, recent CVA, severe
systemic disease, malignancy, old myocardial infarc-
tion, cardiogenic shock, bleeding tendency, unstable
angina, expending infarction, or New York Heart Asso-
ciation functional class IV. At ﬁrst, the patient’s his-
tory, medication, physical condition, and laboratory
data were reviewed in detail. If patient had no con-
traindications for thrombolytic therapy, this interven-
tion was considered ﬁrst. Intravenously thrombolytic
therapy (streptokinase 1,500,000 units over 30–60min)
was administered to the 26 eligible patients within
6 h after the AMI event. In 18 of the 26 patients,
the percutaneous transluminal coronary angioplasty
(PTCA) procedure was performed at ﬁrst week (5–7
days) to achieve Thrombolysis in Myocardial Infarc-
tion (TIMI) ﬂow grade 3 in the infart-related vessel.
Informed consent was obtained from each patient and
the study protocol was approved by the Human Inves-
tigation Committee of the Kaohsiung Veterans General
Hospital, Kaohsiung, Taiwan.
Adjunctive pharmacologic therapy followed the stan-
dards of the intravenously thrombolytic therapy. Hep-
arin was administered to the 26 patients for at least
48h. The indication of anticoagulation during the
period after the thrombolytic therapy and before PTCA
procedure was individualized to each patient indepen-
dently of the LVEF in the study group. Based on the
EF, these patients were divided into two groups. One
patient group (Group 1) including 18 subjects had EF
of 50% or more. The other (Group 2) containing eight
patients had EF of less than 50%.
Experimental Protocol
For the two group patients, the LV pressure–volume
study is conducted immediately after the PTCA pro-
cedure. After patients were medicated with diazepam
2
22232202((
% "
2
##	
<#	&-	(&'#(+',6



0

4
0
45


*)                             )*
,(D#"	#&-"'&(''#	-	(
'. 
(- # <#	 # , ## # &'#(	 &&#
"	 	 # ,	, '	# D.  (# 	 D ,' 	#
"( <# &'#(	 &&#.  '	 	 # ,	,
'	# 	 2 & # -"'	 "	# &  '& '
#(#	 - (. 4	 #	 # 	-+( & -"'	
"	# &  ' ( 	( &&(	# -"'	 (#. 4	
((#-"(#&'#(('#	(@E-"'	(#
@5	&,	,'	#,(	(("		
#FF:	F&-"'	"(. 
25#	
&	#	&#	#	,'##(	&(-)/8*
&	'6)* 
 *)*)*)  67-5) 7 



 6 7 *)*)                   )*
777 F*F*))*)                   )*
,(  # ('(& '"(-#(	7  # #-&#
"(-#(.,'#+&	#	 7)* &		#
(#'&"'	& )7* ##  *) 	 +7 .(	'
	' 6)* 	 + (	#(# + # "(-#( )7*. 
	(	#	,'##(	&(-)4/8*
 






*)*)

*)

7
7-5)
-
6 7

          ):*
,(- #	(-'E	#	#.
(#'(((,#
-"'	"() #(#,'# #(	&(-)G8* 
	.'#	      77
  H8)	8 	I
#G8 
 ;9;9*)  886 5)    
 
8
  7886 ;F*9);9 
        )@*
	((#,'##(	&(-)4G8*
 -78 5)86
 
  F;F*9)*);9 
 






 
)5*
	('2"(	&	
4&'#(
 
8
8'86% F;9;9*)                      )$*
/-"( #0<. )@* )8*  #"' ("	& ##'
&'#( 	 # #(	&( &	#	  ) *.  # -'#
('#	&'#(	++	G8	4G8.
8'##(	&(-	+&(#-"#		
(	#(#	. 
(  	  , # -"#	 	
(	#(#	 & '' '#('#	 	' )!* &(
	 	#(&( 771. 
(- 
.  , 	 &	 ## -
#(+	(,#	(#	 #-	#(' 	 #(	'
	'.&(<	 #(+	 '  	((#
#-#		"#"?##	.,(#"+'#
 &'#(	 &&# + '-	#	 # &(<	
#(+	)GGG*(	#(	#(#	"(. 













 

 %
 %



   %
  %

 


 	 

	

	




  %
   %

 




(.	',##(+		''!-"#	.




 %
 %
 

 %
 % 
 
 %
 % 
 





(.	#(#		''!.

!(	 # ,'# #(	&(- #( # ',(
&(<	 &&	# 	#	 ( 	( -?	 #-
-(-"(#	##	#(	(	#(#	#.3	##(
	 # (&(<	 &&	# 	#	 ',( 	(
	 ( ' -"(#	# 	 (	#(#	 #. J	( (
'' & -"#	  #('  	 # #(-	
,''&-"		#'+'-	#.K	#
March 17, 2009 12:4 00114
140 S.-H. Liu, K.-M. Chang & C.-C. Tyan
score, a composite of measures of functional capacity
and stress-induced ischemia, has been shown to predict
prognosis in coronary artery diseases.2–4 The treadmill
electrocardiogram measurements were made according
to conventional methods at the hospital, in which the
patient was allowed to run freely on the treadmill. In a
standard diagnosis, when the patient’s treadmill elec-
trocardiogram shows a horizontal or lower slope ST
depression, the patient will be diagnosed with myocar-
dial ischemia. It has been reported that exercise electro-
cardiogram examination reveals the presence of chest
pain during exercise or exertion, with the accuracy
of diagnosis reaching 90%.5 But the treadmill exer-
cise is a dangerous and hard exercise for the patients.
The patients must run until their heart rate attains at
least 85%–90% of the maximum heart rate for 1min,
or until fatigue develops.6,7 Therefore, how to easily
examine the risk of myocardial ischemia is a challenging
study.
O’Rourke et al. have shown that arterial sclerosis is
caused by the fracture and fragmentation of the elastic
lamellae with the diabetes.8 Consequently, many stud-
ies have been developed to assess arterial stiﬀness as
a means of predicting the cardiovascular risk to the
patient. Most of these studies have focused on the anal-
ysis of the blood pressure waveform measured from
the radial artery. This kind of method is known as
pulse waveform analysis (PWA). Research into PWA
of the radial artery was initiated by the invention of a
pulse waveform scanner by Vierordt in 1855,9 which
has since proven to be a safe and eﬀective diagnos-
tic tool. Many technologies have been used to measure
the radial artery waveform and have employed either
a single sensor or an array sensor. An array sensor is
placed on the wrist over the radial artery; the device
automatically ﬂattens the artery, adjusts the contact
pressure, and selects the optimal sensing element for
recording the pulse wave.10 In 1993, Wang et al. used
a Fourier transform to study the radial artery wave-
form, which would be aﬀected by mechanical resonance
between the heart and other organs.11 They discovered
evidence that pathological changes in diﬀerent organs
aﬀected the harmonic values of the pressure pulse wave-
form (PPW),12–15 which has led to PWA being used as
an eﬀective and accurate diagnostic tool. Form factor
(FF) value is a time domain feature that comes from the
ratio of the standard deviation of the derivative signal.
The FF value has been used in biomedical signal anal-
ysis, such as EEG16 and electrocardiogram (ECG).17
The FF value is very sensitive to noise, and is only suit-
able for narrow band signals, not for wide band signals,
such as EMG. Because PPW is a narrow band signal,
the FF value also could be used to describe the PPW’s
characteristic in time domain.
A hard k-means algorithm executes a sharp classiﬁ-
cation, in which each object is either assigned to a class,
or not. The application of fuzzy sets in a classiﬁcation
function causes the class membership to become a rel-
ative one and an object can belong to several classes at
the same time but with diﬀerent degrees.18 Therefore, a
fuzzy C-means (FCM) algorithm which is an unsuper-
vised clustering method has a better performance than
the hard k-mean algorithm for identifying the medi-
cal problems.19,20 A receiver operating characteristics
(ROC) curve is used to determine the optimal decision
function, which is based on the feature centers derived
by FCM.
In our studies, the radial artery can be regarded as a
three-dimensional cylinder, and locating the best mea-
suring point requires three axes to be considered, as
shown in Fig. 1. In this ﬁgure the Y -axis is deﬁned as
being parallel to the radial artery, the Z-axis is verti-
cal (i.e., perpendicular to the radial artery), and the
X-axis is horizontal (i.e., perpendicular to the fore-
arm). In order to get a standard measurement, we had
designed a three-axis mechanism and a standard posi-
tioning procedure for detecting the optimal measure-
ment site.21 A modiﬁed sensor was designed to detect
the arterial diameter changed waveform (ADCW) and
PPW simultaneously. The sensor combined a piezore-
sistor (diameter: 12mm, range: 15 psi; NPI-12, Lucas,
USA) with a strain gauge (size: 5 × 2mm; resistance:
119.8 ± 0.2%Ω, mean ± SD; KFG-5-120-C1, Kyowa,
Japan). The waveform signals were recorded using a
digital-to-analog acquisition card (PCI 6014, National
Instruments), with LabView software used for data
retrieval and manipulation. The analog bandwidth was
Fig. 1 Diagram of the three axial directions.
172 S.-H. Liu et al.: Determination of instantaneous blood flow
Article in press - uncorrected proof
Figure 1 Block diagram of the proposed measurement system.
The thick arrows ( ) represent the air pathways and the thin arrows (---- ) the electric current flow. F is pumped flow, PC_I is cuff
pressure during the inflation period, Posci is oscillometric pressure waveform during the deflation period, VC is cuff volume, Ccuff
represents the slope of the cuff model, Fosci is the oscillometric flow waveform, and PWM is the pulse width modulation.
build a non-linear cuff model that illustrates the relation-
ship between air cuff pressure and internal volume, we
detected airflow pumped into the pneumatic cuff and cuff
pressure using the airflow meter and pressure transducer
during the inflation period, respectively. During the defla-
tion period, only the pressure transducer was used to
record cuff pressure. A change in arterial volume embed-
ded in cuff volume can be determined from the cuff
model and the oscillometric pressure waveform. Then,
instantaneous arterial flow can be found by differentiating
the changed volume. Also, an appropriate calibration
procedure was designed and verified, which allowed
oscillometry-based airflow to be obtained from the
simulator during the deflation period. To validate the pro-
posed method, we compared blood flow using the oscil-
lometric method with Doppler-based blood flow mea-
sured using Doppler ultrasound.
Materials and methods
Oscillometric flow measurement
In oscillometry, an arterial volume pulse from the under-
lying artery must pass through the intermediate tissue
and cuff cover before it can be detected. If the cuff is
tightly wrapped around the upper arm during the defla-
tion period, the cuff model should be governed by the
characteristics of the intervening tissue and cuff elasticity
w3, 24x. The detection of an oscillometric pressure wave-
form in cuff pressure is affected by the characteristics of
both the artery and cuff. The amplitude of the oscillo-
metric pressure waveform is maximal in the unloaded
condition when cuff pressure is equal to mean arterial
pressure w3, 7, 8x. Once the cuff model in each measure-
ment has been established, the change in oscillometric
pressure could be converted to the change in oscillo-
metric volume by multiplication with cuff compliance. The
change in oscillometric volume was proportional to the
change in the cross-section of the artery when the length
of the cuff was constant and the circular shape of the
arterial lumen was assumed. Thus, the differentiation of
the oscillometric volume waveform (i.e., the oscillometric
flow waveform) can be used to indirectly assess the arte-
rial blood flow of interest under different loading condi-
tions. However, in an unloaded condition, the maximum
amplitude of the oscillometric flow waveform can be
most properly applied to evaluate blood flow in the bra-
chial artery.
System design
Figure 1 shows a block diagram of our proposed oscil-
lometric blood flow measurement system. During the
inflation period, pumping airflow and cuff pressure were
simultaneously measured. The amount of air pumped
into the cuff was determined by integrating the airflow.
The relationship between cuff pressure and cuff air
volume (i.e., the cuff model) has been proven to be
non-linear w7, 8x. Thus, a non-linear regression approach
was used to construct the cuff model and the slope of
the non-linear relationship was here defined as cuff com-
pliance. During the deflation period, only the pressure
transducer was used to record cuff pressure, from which
the oscillometric pressure waveform was extracted. After
differentiating the oscillometric pressure waveform and
then multiplying by cuff compliance, the oscillometric
flow waveform could be obtained.
To achieve ultralow power consumption and high
availability for building a portable apparatus, an MSP430
microcontroller was utilized in the study. In the sensing
module of Figure 1, cuff pressure is measured with a
silicon-membrane pressure transducer (range: 3.45=
104 N/m2; SCX05DNC, SenSym, USA). The output of the
pressure transducer is calibrated using a mercury column
sphygmomanometer. The oscillometric pressure wave-
form is obtained after band-pass filtering the analog cuff
pressure signal from 0.5 to 3 Hz w7, 8x. The airflow meter
(AWM3300, Honeywell, USA) has a maximum operating
range of 1000 ml min-1. Cuff pressure, the oscillometric
pressure waveform, and airflow signals are then digitized
by a 12-bit A/D converter at a sampling rate of 250 Hz.
948 S-H Liu et al
1. Introduction
Noninvasive and quantitative measurement of the mechanical properties of the vascular system
is required for the evaluation of hemodynamic conditions in various cardiovascular diseases
(Glasser et al 1997, Franklin et al 1997). These mechanical properties are related to arterial
stiffness, such as the relative change in arterial diameter, absolute diameter change, the
velocity of pulse propagation and the relationship between pressure change and volume
change. Important indices related to arterial stiffness include distensibility, compliance,
pulse wave velocity and vascular impedance (Mackenzie et al 2002, Oliver and Webb 2003).
However, these indices are rarely done by simultaneously taking the blood pressure and
diameter measurements. Diameter measurements are made using an echo-based method or
magnetic resonance imaging (MRI) (Murai et al 2005, Levenson et al 1981, Khder et al
1997). The vascular compliance, C, which is used to describe the degree of atherosclerosis,
can be measured by simultaneously observing the absolute diameter change, D, and the
corresponding change in blood pressure, P, in a segment of vessel. The compliance can thus
be calculated as C = D
P
(Mackenzie et al 2002, Oliver and Webb 2003).
Some studies focused on the arterial compliance measurement without using an echo-
based or MRI method. These studies defined the capacitative compliance or oscillatory
compliance as the ratio of the arterial volume change to the arterial pressure change. Shanker
and Webster proposed a maximal compliance which used electrical plethysmography to record
the arterial pulse volume at different transmural pressures by applying a pressurized cuff
wrapped around a lower leg (Shanker and Webster 1991). Lopez-Beltran et al (1998) offered
a peripheral vascular compliance indicator by applying an infrared photoplethysmography to
represent the pulsatile change in the arterial volume. Drzewiecki and Pilla (1998) calculated
the pressure-lumen area measurements by determining the cuff compliance. Liu et al (2008)
used an airflow meter and a pressure transducer to characterize a cuff model which embedded
the change in the arterial volume.
The arterial stiffness index (ASI) was obtained simultaneously with the measurement of
brachial arterial blood pressure by calculating the oscillometric waveform at the arm (Sharma
et al 2002, Kaibe et al 2002). ASI has been reported to show a good correlation with pulse
wave velocity between the carotid and femoral arteries. Hence, it is considered valuable for
evaluating arterial stiffness in hypertensive patients (Kaibe et al 2002). Sato et al (2005)
reported that the ASI correspondingly rose when other risk factors were present, including
hypertension, hyperlipidemia and diabetes.
In our study, a two-axis mechanism and a standard positioning procedure have been
designed to detect the optimal measurement site for accurately measuring the pulse pressure
waveform (Tyan et al 2008). A modified sensor was designed to detect the arterial diameter
change waveform (ADCW) and pulse pressure waveform with the strain gauge and the
piezoresistor, simultaneously. Because the designed two-axis mechanism can place the sensor
very close to the middle of the radial artery, the change in the arterial radius for the different
contact pressure can be measured according to the vascular geometry. Thus, a nonlinear
relationship between the change in the arterial radius and the pulse pressure in a radial artery
can be obtained. Many studies have proven that hypertension can accelerate the increase in
vascular wall thickness and decrease vascular elastic and systemic compliance (Kannel and
Stokes 1985, Safar et al 1984). This study comprised 23 patients with mild or moderate
hypertension and 14 normotensive patients to investigate the designed compliance method.
Of the 23 patients, there were 14 who also had the risk of hyperlipidemia. The ASI of these
patients was also measured.
The purpose of this research was to develop a novel noninvasive measuring method that
had a two-axis mechanism and employed a standard positioning procedure for measuring the
2  TELEMEDICINE and e-HEALTH  NOVEMBER 2009
LIU AND CHANG
activities of motion behavior have to be recognized for home care. 
The threshold method does not have enough capability to process 
this problem.
Some studies have considered using neural or fuzzy recognizers 
for different objects. A backpropagation neural network (BPNN) uses 
the Fourier descriptor of the object’s contour as the feature vector for 
classification.13,14 Juang et al. showed that the self-constructing neu-
ral fuzzy inference network (SONFIN) recognizes moving objects with 
a shorter training time and higher recognition rate than the BPNN or 
the radial basis function network.15,16 Zhang et al. used the one-class 
support vector machine algorithm to extract features of the motion 
signal, and the kernel Fisher discriminant and the k-nearest-neighbor 
algorithm for classifying falling.11
The present study considered three problems: (1) the optimal posi-
tion for the accelerometer; (2) recognition of the basic three actions 
of walking, sitting down, and falling; and (3) identification of an 
inexpensive portable telemetry device that is suitable for use in 
medical applications. Three accelerometers were placed on the chest, 
waist, and thigh to measure the motion trajectories related to the 
investigated actions. The signals were transmitted to the monitoring 
system using Bluetooth technology, which has been widely embedded 
in cell phones, personal digital assistants, and notebook computers. 
Thus, these devices could use the Internet to transmit data or alarm 
signals to family members.17 Moreover, some home-care medical 
devices, such as blood pressure monitors, electrocardiographs, and 
pulse oximeters, also contain embedded Bluetooth modules for 
outputting measured data. We used a SONFIN algorithm to recognize 
the three actions of walking, sitting down, and falling. This network 
can be self-learning by constructing the structure and parameters 
of the neural network for the habitual motions of an individual 
person.16 The acceleration trajectory of each action was considered as 
an autoregression (AR) model. A linear predictor method was used to 
estimate the model’s parameters as the feature vector. Our designed 
measurement system was applied to 10 volunteers performing the 
three actions of walking, sitting down, and falling. We gathered 
about 20 samples for each activity to complete our experiments. The 
results of the statistical parameters of the SONFIN show that the three 
actions could be recognized, achieving 88.7% accuracy when the 
accelerometer was placed anywhere between the chest and the waist, 
and when the dimension of the feature vector is 60. Using a BPNN 
rather than the SONFIN to recognize the three actions under the same 
conditions produced a markedly lower recognition rate. Finally, seven 
elderly individuals were asked to perform the three actions of walking, 
sitting, and climbing stairs. The system recognized appropriate activity 
in 80.4%.
Methods
Figure 1 shows the detection system. The subjects wore three three-
axial accelerometers on the chest, waist, and thigh. Two microcon-
troller units (MCUs), one master and one slave, were used to sample 
the signals of the three accelerometers and transfer the data with the 
serial communication to the Bluetooth module. A NB received the 
data via Bluetooth. The interface was written in LabView software to 
display and record the signals. The raw independent signals from an 
accelerometer were converted into polar coordinates, and the feature 
vector was extracted. The three actions were then recognized with a 
SONFIN algorithm.
Two MCUs were used since the TI MSP430 F1611 device used 
has only eight A/D channels and a 12-bit A/D converter, which 
was insufficient for three three-axial accelerometers. Therefore, two 
MCUs were imbedded in the system (one master and one slave), 
with data transfer performed using the serial peripheral interface 
bus model. The sampling rate of the master MCU was 250 Hz. One 
trigger signal of the master MCU was connected to the interrupt port 
of the slave MCU for synchronous sampling. The MCU used the serial 
communication port (baud rate: 115,200) to connect to the Bluetooth 
module (MB-C04, SMART Design Group, Taiwan). Each accelerom-
eter (KXM52-L20, Kionix, city, state, USA) had a range of ±2 g with 
three-axis output signals in rectangular coordinates. The power sup-
ply to the measurement system was a 4.5-V lithium battery.
The sample data to the A/D converter of the MCU were separated 
into low and high bytes. The master MCU transmitted 20 bytes to the 
Bluetooth module when a sampling period finished: 18 bytes were 
F1
AU4
Fig. 1. Our proposed detection system.
AU2
Actions
Bluetooth
chest
waist
thigh
 
Feature
Extraction
Recognition
AU3
F
Improved Arterial Inner Wall Detection Using Generalized Median Computation 623
The automatic methods have the potential in reproducing results and eliminating
the strong variations made by manual tracings of different observers. Moreover, the
processing time can be considerably reduced. The motivation of this study is to develop
a confidential system which is able to detect the intima and adventitia of both near and
far artery walls, with or without plaques, automatically even under strong speckle noises
using dynamic B-mode sonographic image sequences. This system can identify not only
the IMT but also the lumen diameter (LD) during systolic and diastolic cycles, from
which the artery elasticity can be potentially calculated. Via this system, the dynamic
process of carotid artery (CA) can be represented by some parameters such as IMT
variation, lumen diameter variation, and IMT compression ratio.
This study provides a new technique for detecting the IMT and the LD changes
along a section of CCA, which is in general different from previously published works.
The proposed system contains two phases. In the first phase, a novel dual dynamic
programming (DDP) combined with some anatomic knowledge makes the detection
more robust against the speckle noises. In the second phase, the generalized median
filter is applied and the median curves are calculated, which are fed backwards to the
system and the DDP is applied again having the median curves as knowledge to correct
its results fully automatically. The proposed scheme has the following steps:
Phase 1
1. Input image Ik; 1 ≤ k ≤ K .
2. If k=1, manually select a rectangle r1; else, track rk using knowledge r1. (Sec.2.3)
3. Extract feature image gk from Ik having a rectangle rk. (Sec.2.4)
4. Apply DDP on gk to detect the dual curves (intima and adventitia). Output cIk and
cAk . (Sec.2.5)
5. Goto Step 1 until k > K .
Phase 2
1. Input cIk and cAk , 1 ≤ k ≤ K , calculate dual median curves MI and MA and their
corresponding translation tIk and tAk . (Sec.2.6)
2. Apply DDP onto gk with guides (MI , MA, tIk, tAk ) and output the final intima and
adventitia curves for each image Ik; 1 ≤ k ≤ K . (Sec.2.7)
The rest part of this paper is organized as follows. In Section 2.1 we address how the
image sequences are acquired. The problems of this study are illustrated in Sec. 2.2.
The methods are described in Sec. 2.3 to 2.7. Then, results are demonstrated (Sec. 3),
discussion and conclusion are given in Sec. 4 and Sec. 5, respectively.
2 Materials and Methods
2.1 Image Acquisition
After at least 15 minutes of rest in the supine position, the ultrasonic examinations of
the right and left CCA were performed. An Esaote Mylab 25 ultrasound scanner with
maximum amplitude of the pressure waveform. There-
fore, authors of the previous studies have always
described the optimal measuring position for the sensor
as over the artery with light adjustments. Concerning
the applied force of the sensor, because the compliance
of the artery belongs to a nonlinear curve, the contact
pressure will affect the shape of the pressure waveform.
Yoon et. al. had found that the amplitude of the pres-
sure waveform first increases, reaching a maximum, and
then decreases when the contact pressure is continu-
ously increased [11]. Driscoll et. al. used the harmonic
coefficients to show that pressure pulse contour, pulse
wave velocity and harmonic transmission ratios were
relatively stable in the brachial and radial arteries of
normal subjects over a large range of the force applied
at these arteries [12,13]. They also found that the con-
tact pressure at the level of the arterial wall would be
larger for subjects with greater amount of subcutaneous
tissue and fat over the artery. Moreover, the excessive
contact pressure may produce alterations in arterial geo-
metry that can distort the arterial pressure waveform
and consequently diminish its value as a diagnostic aid.
Liu et. al. proposed a two-axis mechanism who used
this mechanism to measure the pressure waveform for
estimating the myocardial ischemia symptoms [14,15],
and to measure the arterial diameter change waveform
for estimating the compliance of the radial artery [16].
In these studies, the pressure waveforms were measured
when the sensor was placed at the middle of radial
artery, and applied an unloading contact pressure.
However, the question is whether the sensor has to be
placed at the middle of artery and the applied force also
has to be in an unloading condition for the pressure
waveform measurement or not. If the sensor couldn’t be
placed at middle of artery, where is the location of the
sensor just about enough to detect a complete pressure
waveform for the diagnosis? Moreover, if the unloading
condition couldn’t be satisfied, how much would contact
pressure be fine? Therefore, in this paper, we studied
the distortion of the pressure waveform affected by the
sensor’s location and contact pressure. We used our
designed two-axis mechanism (Pattern Number:
I309976, R.O.C.) to quantitatively measure the radial
pressure waveform which real photo is shown in Fig 1.
A modified sensor that can detect arterial diameter
change waveform (ADCW) and pressure waveform with
the strain gauge and the piezoresistor, simultaneously
was used. In the X-axis scanning procedure, we used the
template matching method to analyze the distortion
degree of the pressure waveform when the sensor was
moved across the radial artery. In the Z-axis scanning
procedure, we also used the template matching method
to analyze the distortion degree of the pressure wave-
form when the contact pressure was continuously
increased. This study used 28 patients with untreated,
mild or moderate hypertension and 14 normotensive
patients to investigate the change in pressure waveform.
2. Method
The modified sensor combined a piezoresistor(diameter:
12 mm, range 15 psi; NPI-12, Lucas, USA) with a strain
gauge (size: 5 × 2 mm, resistance: 119.8 ± 0.2% Ω, mean
± SD, gage factor: 2.12; KFG-5-120-C1, Kyowa, Japan).
Its active surface was semispherical and constructed
from soft silicone rubber. We have shown that the sen-
sor could measure the ADCW and pressure waveform
simultaneously [14]. The waveform signals were
recorded using a digital-to-analog acquisition card (PCI
6014, National Instruments), with LabView software
used for data retrieval and manipulation. The analog
bandwidth, pressure-sensor gain, strain-gauge gain and
sampling frequency were 0.1-40 Hz, 100, 5000 and 500
Hz, respectively. The pressure sensor was calibrated
using a mercury-column pressure gauge.
Because the template matching method could com-
pare the correlation between the reference pattern and
the test pattern, we used it to analysis the distortion of
the pressure waveform affected by the sensor’s location
and the applied force in this paper. In the registered
pressure signal from X-axis or Z-axis scans, one cycle
pressure waveform was chosen as the reference pattern
to compare over the pressure waveform. The reference
pattern was considered as an optimal waveform in the
whole pressure signal. The correlation signal was
Figure 1 Schematic of the two-axis mechanism. A: Sensor; B:
Stepping motor: C: X-axis screw; D: Platform; E: Handgrip.
Liu and Tyan BioMedical Engineering OnLine 2010, 9:6
http://www.biomedical-engineering-online.com/content/9/1/6
Page 2 of 14
                             Editorial Manager(tm) for The Journal of Signal Processing Systems 
                                  Manuscript Draft 
 
 
Manuscript Number: VLSI663R2 
 
Title: Gaussian noise filtering from ECG by Wiener filter and ensemble empirical mode decomposition 
 
Article Type: SP Circuits and Systems for Bio-Signals 
 
Keywords: ECG, Gaussian noise, Wiener filter, ensemble empirical mode decomposition 
 
Corresponding Author: Dr. Kang-Ming Chang, Ph.D 
 
Corresponding Author's Institution: Asia University 
 
First Author: Kang-Ming Chang, Ph.D 
 
Order of Authors: Kang-Ming Chang, Ph.D; Shing-Hong Liu, Ph.D 
 
Manuscript Region of Origin: TAIWAN, REPUBLIC OF CHINA 
 
Abstract: Empirical mode decomposition (EMD) is a powerful algorithm that decomposes signals as a 
set of intrinsic mode function (IMF) based on the signal complexity. In this study, partial 
reconstruction of IMF acting as a filter was used for noise reduction in ECG. An improved algorithm, 
ensemble EMD (EEMD), was used for the first time to improve the noise-filtering performance, based 
on the mode-mixing reduction between near IMF scales. Both standard ECG templates derived from 
simulator and Arrhythmia ECG database were used as ECG signal, while Gaussian white noise was used 
as noise source. Mean square error (MSE) between the reconstructed ECG and original ECG was used 
as the filter performance indicator. FIR Wiener filter was also used to compare the filtering 
performance with EEMD. Experimental result showed that EEMD had better noise-filtering 
performance than EMD and FIR Wiener filter. The average MSE ratios of EEMD to EMD and FIR Wiener 
filter were 0.71 and 0.61, respectively. Thus, this study investigated an ECG noise-filtering procedure 
based on EEMD. Also, the optimal added noise power and trial number for EEMD was also examined. 
 
 
 
 
ARTICLE IN PRESS
applied to analyze biomedical control and feature extraction (Lin
et al., 2003; Huang et al., 1999; Lin and Lee, 1996). One of the
advantages of fuzzy logic is that it can be applied empirically
without explicit mathematical models of the underlying nonlinear
physiological systems. Also, it is easy to implement a feature
extraction system using fuzzy logic since this is based on
linguistic rules. In this paper, we propose an HR detection method
that includes a slope calculation, a fuzzy logic discriminator (FLD),
and an algorithm for determining the peak index. The use of the
differential waveform allows the drift in the baseline PPG signal to
be removed and enhances the change in the perfusion duration of
PPG. The FLD was used to evaluate the truthfulness of each peak
as a weight. The determining algorithm used the weight of a peak
to detect the index of maximum slope and adjusted the input
parameters of the FLD for the next peak. The capability of our
proposed HR detection method was tested using the following six
examples of contamination: raising and lowering the hand,
respiration disturbance, changes in amplitude, presence of no
dicrotic notch or of double dicrotic notches, and premature atrial
contraction (PAC). To evaluate the performance we also used
wavelet multiresolution analysis and a correlation detection
method to extract the HR for these six different examples.
This paper is organized as follows. Section 2 describes the
design of the FLD parameters, the ﬂow diagram of the determin-
ing algorithm, the correlation method, and the wavelet method.
The six different cases for the PPG waveform also are detailed in
this section. Section 3 compares the performance of the FLD
method with those of the correlation and wavelet methods, and
presents the recorded HR responses. The results are discussed and
conclusions are drawn in Section 4.
2. Materials and methods
Fig. 1 shows a block diagram of the proposed measurement
system. The entire system includes a speciﬁc simple pulse
oximeter (SpO2) monitor, a differentiator, parameter calculation,
an FLD, a determining algorithm, and a peak detector. The SpO2
monitor used (SA200, Rossmax, Taiwan) a sampling rate of 250 Hz
outputted PPG digital signals corresponding to red and infrared
light intensities via a serial port to the computer. The PPG signal
of the SpO2 monitor is preprocessed by a differential equation to
evaluate the slope signal and remove the baseline drift of the PPG
signal and enhance the change in the perfusion duration of PPG.
The disturbance characteristics of Pre_Ratio, Pos_Ratio, and y
(deﬁned in Section 2.1.1) are then extracted from the slope
signal. The FLD uses these parameters to evaluate a weight
representing the truthfulness of the peak of the slope signal, and a
determining algorithm uses this weight to detect the actual peaks
of the perfusion cycle and adjust Pre_PP, Pos_PP, and N_PP (deﬁned
in Section 2.1.1). Based on the determining algorithm, the peak
detector determines the perfusion peak of the raw PPG waveform
by identifying the maximum value of the PPG waveform following
the actual peak of the slope signal. The HR of beat-to-beat is
calculated.
In this section, we also present the other two extraction
methods (correlation and wavelet) that were used to smoothen
the PPG waveform into a sine wave. Detection of the local
maximum was used to identify the peak index. A gold standard
BBI was manually extracted from the PPG signal.
2.1. Fuzzy logic discriminator for peak determination
The PPG waveform has a maximum slope when the left
ventricle pumps into the aorta. For computational efﬁciency, the
slope Di at point i was calculated as the average of three data-
point differences di1, di2, and di3 within a window of size m. The
stroke cycle of the left ventricle is about 0.1 s, and hence we used
m=40 for the sampling rate of 250 Hz. The transfer function is
deﬁned as follows:
HðzÞ ¼ 1
3
ð1zmÞþðz1zðmþ1ÞÞþðz2zðmþ2ÞÞ : ð1Þ
The slope signal is very sensitive to changes in the PPG
waveform, and contains more peaks than the raw PPG signal. In
the general method, a threshold is normally used to determine a
local maximum. However, the peak is larger for a larger PPG
waveform, and so a ﬁxed threshold is insufﬁcient for detecting the
maximum of the slope signal, making it necessary to design an
efﬁcient algorithm for determining the local maximum.
2.1.1. The normal PPG waveform and characteristics
Fig. 2 shows a standard PPG signal and its slope, which exhibits
only one perfusion peak and one dicrotic notch peak. The slope
signal can sensitively represent the change in the PPG waveform
with a reduced baseline offset, as shown in Fig. 2(b). The
maximum peak of the slope signal occurs at the perfusion cycle
of the PPG waveform. Thus, we deﬁned it as the actual peak of the
perfusion cycle. In order to detect these actual peaks, we deﬁned
some parameters for the slope signal. I[n] represents the interval
between any two contiguous peaks of the slope signal, and Pre_PP
is deﬁned as the interval between the two actual peaks of the
perfusion cycle. We ﬁrst deﬁne any detected peak of the slope
signal, P2, as being the actual peak of perfusion cycle. Thus, Pre_PP
of P2 is
Pre_PP¼ I½n1; ð2Þ
when P1 is an actual peak of the perfusion cycle. When P2 is found
to not be a peak of the perfusion cycle, Pre_PP of P3 will be
Pre_PP¼ Pre_PPþ I½n: ð3Þ
HRSpO2 Monitor Peak
Detector
PPG Pre_Ratio
Calculating FLDPos_RatioS W DeterminingDifferential
Parameters θ AlgorithmEquation
Pre_PP
Pos_PP
N_PP[n+1]
Fig. 1. Block diagram of the proposed measurement system. The system includes a speciﬁc SpO2 monitor, an injector trigger, a differentiator, parameter calculations, an
FLD, a determining algorithm, and peak detection.
S.-H. Liu et al. / Engineering Applications of Artiﬁcial Intelligence 23 (2010) 968–977 969
From: rcmerrel@hsc.vcu.edu 
To: changkm@asia.edu.tw 
Cc: charles.doarn@uc.edu 
Date: Mon, 4 Oct 2010 10:03:17 -0400 (EDT) 
Subject: Telemedicine and e-Health - Decision on Manuscript ID TMJ-2010-0078.R1 
 
 
04-Oct-2010 
 
Dear Dr. Chang: 
 
It is a pleasure to accept your manuscript entitled "Wireless Portable ECG and a 
Tri-axis Accelerator Implementation and Application on Sleep Activity Monitoring" 
in its current form for publication in the Telemedicine and e-Health.  The comments 
of the reviewer(s) who reviewed your manuscript are included at the foot of this letter. 
 
The Copyright Agreement form attached to this email should be sent to the publisher 
as soon as possible. Manuscripts cannot be published without this form. The 
corresponding author is responsible for obtaining signatures of coauthors. Authors not 
permitted to release copyright must still return the form signed under the statement of 
the reason for not releasing the copyright. 
 
Please fax the Copyright Agreement form to 914-740-2101. 
 
If preferred, the Copyright Agreement form may be filled out electronically and 
emailed to copyrightforms@liebertpub.com. 
 
Authors who would like their papers to be made free online immediately after 
publication can sign up for Liebert Open Option for a one-time fee.  If the paper has 
NIH funding, it will also be uploaded onto PubMedCentral on behalf of the 
author.   Please contact Karen Ballen at kballen@liebertpub.com or at (914) 
740-2194 for more information. 
 
Thank you for your fine contribution.  On behalf of the Editors of the Telemedicine 
and e-Health, we look forward to your continued contributions to the Journal. 
 
Sincerely, 
 
For Peer Review
 
 
 
Telemedicine and e-Health Manuscript Central: 
http://mc.manuscriptcentral.com/liebert/telemedicine 
 
 
 
Wireless Portable ECG and a Tri-axis Accelerator 
Implementation and Application on Sleep Activity 
Monitoring 
 
 
Journal: Telemedicine and e-Health 
Manuscript ID: TMJ-2010-0078.R1 
Manuscript Type: Original Research 
Date Submitted by the 
Author: 
02-Oct-2010 
Complete List of Authors: Chang, Kang-Ming; Asia University, Department of Information and 
Communication Engineering 
Liu, Shing-Hong; Chaoyang University of Technology, Department 
of Computer Science and Information Engineering 
Keyword: e-health, Home health monitoring, Telehealth, Telemedicine 
  
 
 
 
Mary Ann Liebert, Inc., 140 Huguenot Street, New Rochelle, NY 10801
Telemedicine and e-Health
For Peer Review
Abstract:  
Night-to-night variability of sleep activity requires more home-based portable 
sleep monitoring instead of clinical polysomnography (PSG) examination in the 
laboratory. In this article a wireless sleep activity monitoring system is described. The 
system is light and small for the user. Sleep postures, such as supine or left /right site 
were observed by a signal from a tri-axis accelerator. An overnight electrocardiogram 
(ECG) was also recorded with a single lead. Using an MSP430 as microcontroller, 
both physiological signals were transmitted by a Bluetooth chip. A Labview based 
interface demonstrated the recorded signal and sleep posture. Three nights of sleep 
recordings were used to examine night-to-night variability. The proposed system can 
record overnight heart rate interval (RRI). Results show that sleep posture and posture 
change can be precisely detected via tri-axis accelerator information. There is no 
significant difference for intra-subjects, but there are statistically significant 
differences for inter-subjects, both for RRI and for sleep posture distribution. The 
wireless transmission range is also sufficient for home-based users. 
 
Keywords: Sleep posture, Portable polysomnography, ECG, Accelerator. 
 
 
Page 2 of 37
Mary Ann Liebert, Inc., 140 Huguenot Street, New Rochelle, NY 10801
Telemedicine and e-Health
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
表 Y04 第2頁 共3頁 
本屆研討會所探討的範圍非常廣泛，全部議程多達 50 個主題(Session)，可
說是涵蓋了醫學工程的全部領域。所有的論文皆經同儕審查(Peer Review)，共有
3600 多篇的投稿，接受率約為 50%。研討會中除了分別安排口頭報告與海報之
外，還特別針對一些近年來大家關注的主題，進行小型討論會與現場展示研究成
果。 
此次與會者多為中國的學者參與，其他國家參與者甚少，台灣的出席人員亦
不多。我所參與的 Session 是“Biomedical Instrumentation ”，此次中國之行為本人
第一次到中國的經驗，發現中國所舉辦的會議鬆散，Oral 每個場次約只有半數的
作者參與，因此每場次都提早結束，Post 場次亦只有少數張貼海報，甚至只是將
論文貼上，所發表的內容在“Biomedical Instrumentation ”亦多無創新，亦無 Chair 
men 的指導，令我對此行的學術價值大打折扣。雖然大會在網頁上宣傳該研討會
去年參與的熱列，但我參與過認為應該是言過其實，並體會到未來幾年應該不會
再去參與中國舉辦的研討會。 
雖然目前台灣在研究的品質上與其他國家相比並不遜色，但是研究的數量並
不及歐美、日本，而且因為數量少因此多樣性與普遍性皆不足，在這方面實有賴
國內研究者繼續努力，加強相互交流，開創更多的創意。以期令國內的生物科技
發展佔得契機。 
三、建議 
會前所有的通知與註冊費用的繳納皆透過網際網路、電子郵件與信用卡，真
正利用到現代科技的便利之處，也節省了時間與大量文件書信的往來。雖然在學
術上較無收獲，但此行因為利用空閒時間看了北京和天津此兩大都市，對中國的
發展只有讚歎其成果，但物價超貴，人超多，但環境乾淨，車輛多，但無交通事
故，政治思想極其箝制，我竟然不能從中國連上國內的入口網站或政府機構網
站，所看的新聞亦為樣本訊息。明瞭到兩岸的差異是如此大，若撇開政治，大陸
的發展是優於台灣，這或許是我這次會議的最大收獲。 
四、攜回資料名稱及內容 
國科會補助計畫衍生研發成果推廣資料表
日期 2010年10月21日
國科會補助計畫
研發成果名稱
發明人
(創作人)
技術說明
技術移轉可行性及
預期效益
技術/產品應用範圍
產業別
計畫名稱:
計畫主持人:
計畫編號: 學門領域:
(中文)
(英文)
成果歸屬機構
(中文)
(英文)
以三軸加速規建構無線式的老年人居家行動照顧系統
劉省宏
96 -2221-E -324 -054 -MY3 醫用電子
去除生理訊號的晃動雜訊技術之架構及其方法
朝陽科技大學 劉省宏
一種去除生理訊號的晃動雜訊技術之架構及其方法， 特別係指一種應用適應性
濾波技術的結構方法， 以去除因人體晃動所產生耦合於生理訊號中的雜訊，
且利用三軸加速規記錄身體晃動的訊號作為參考訊號源， 並採用最小均方的演
算法，其所採用的疊代技術可以降低演算的複雜度,較適用於可攜式的裝置系統
,將此演算法應用於具單晶片的微控器中， 可以有效的去除生理訊號測量時最
容易耦合的晃動雜訊， 透過本發明之設計， 進而提升整體生理監測的準確性
， 以提高受測對象的使用安全性。
A technique including the structure and method can remove the moving
artifacts. The method is the algorithm and its structure of adaptive
filter which could remove the coupled noise caused by the body
moment. An accelerometer measuring the body action is used as the
reference signals in the adaptive filter. The optimal weight of the
adaptive filter could be adjusted by a least mean square algorithm
which suits for the single chip system.  Using this technique can
arise the accuracy and safety of the physiological monitor
醫療器材製造業
可攜式的生理測量系統，包含EEG、ECG、PPG等
增加可攜式裝置測量訊號的穩定度。
註：本項研發成果若尚未申請專利，請勿揭露可申請專利之主要內容。
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
[1] 2007 生物醫學科技和健康管理研討會-學生論文競賽 ＇以 MSP430 建構家
護式心血管監測儀＇ 第一名。 
[2] 2007 「Journal of Medical and Biological Engineering」年度論文競
賽優良獎 
[3] The 6th Virtual Instrumentation Paper Contest 2007, 產業組佳作。
[4] 2010 全國大學校院數位生活科技與創意應用競賽＇綠色節能商品價目標示
系統＇佳作。 
 
[5] 中華民國 發明專利，「三軸脈診儀及其診脈方法」 劉省宏、陳建仲、田莒
昌，字號：發明第 I 309976 
[6] 中華民國 發明專利，「壓振式血流量測裝置」劉省宏，申請第 097142464
號 
[7] 中華民國 發明專利，「去除生&amp；#63972；訊號的晃動雜訊技術之架構
及其方法」劉省宏，申請第 098136708 號 
 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
