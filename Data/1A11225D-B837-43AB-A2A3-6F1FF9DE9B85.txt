2摘 要
關鍵字: 電力品質、諧波、不平衡、功率因數、硬體描述語言、SOC
由於近年來使用了許多的資訊設備與電力電子轉換器，使得電力品質的問
題日趨嚴重，其中因為諧波污染、負載不平衡等負載特性均會影響用戶功率因
數量測值，本文以六種功率因數定義式，針對同一筆用戶負載量測資料計算其
功率因數值，計算所得之六個值將因負載特性不同而有所差異。隨著半導體的
技術愈來愈成熟，SOC(System On a Chip)設計已是未來的趨勢，使所設計的系
統晶片能達到功能強、體積小的目的，本文利用快速傅立葉轉換(FFT)為基礎
來分析六種功率因數定義式，利用硬體描述語言(VHDL)及使用一些新式矽智
財(IP core)如 CORDIC core 和 FFT core 在以由下而上的設計流程(Bottom-Up)
建構整個模擬系統。最後在利用模擬與實測波形，來求取所需之實、虛與視在
功率值，其平均誤差大約為 0.2%左右。
4目 錄 頁次
中文摘要………………………………………………………………..2
英文摘要………………………………………………………………. 3
第一章緒論 5
第二章數位信號處理 9
第三章電力量與功率因數之定義 22
第四章數位積體電路與FPGA介紹 34
第五章功率因數計算之晶片設計與模擬測試 50
第六章結論 75
參考文獻…………………………………………………………….….77
出席國際學術會議心得報告及發表之論文各一份 81
6類存在變動、不平衡及諧波的負載時，是否能確切反應負載的特性情形值得我
們去探討。而最新的GE kV2電子式時間電表[3]是依據IEEE Standard 100[4]來
設計，利用較高速的數位取樣技術，可以考慮不平衡及諧波的影響，視在電力
可分別選用向量視在電力或算術視在電力。但是kV2電子表只是使用數位相移
90度的方式計算無效電力，而不是使用快速傅立葉轉換(FFT)，在分析諧波的
影響方面仍有改善空間。
雖然大多情況下諧波污染源是用戶產生，但亦有可能來自於系統，因此，
其影響用戶諧波污染責任歸屬問題，亦應加以釐清。
1.2研究目的
早期對視在功率及功率因數的定義均只考慮負載為線性，但近年由於
電力電子元件及技術進步，閘流體元件的大量使用，因而用戶端有越來越
多的諧波負載。此外如鐵路及電弧爐也有不平衡及變動的負載情形，也應
特別注意。雖然目前電力公司對諧波、電壓閃爍、不平衡等的電力品質管
制相當完備，且已經實施一、二十年，但與負載特性最有關的電力量如視
在功率、功率因數等卻還需要有較合適的定義與計算方法，才能充分反應
負載特性於電費計價上。目前用戶的電力計費結果並不能充分反應諧波、
變動與不平衡的電力品質問題，希望目前以數位電錶的技術，配合較完整
的電力數量計費公式，並考慮諧波與不平衡的影響，便能促使用戶為降低
所需繳的電費，而自動自發地改善其負載特性。
1.3文獻回顧
對於會破壞電力品質的污染源及其對電力量的影響，一直有許多探討文獻
[5-8]。Mattavelii[9]於西元1994年討論在IEEE標準辭典[4]中電力量定義的缺
8的特性。
基本上三相視在電力的定義式非常多，如等效視在電力、算數視在電力、
向量視在電力、及基本波視在電力等，採用不同的視在電力就有不同的功率因
數值，如果採用無效電力也有不同結果。但是諧波、不平衡，及負載變動真正
的影響為何，應如何考量，國內用戶負載特性為何，仍需深入探討。在電力量
之計算與定義方面 IEEE Standard Committee 與 IEEE Working Group on
Nonsinusoidal Situations曾將各電力量分為基本波與非基本波部份來討論，並討
論評估三相系統的不平衡程度。Filipski 教授有許多文章討論幾種視在功率的
計算方式，並檢討各種電錶的優劣，最後建議採用算術視在電力計算法較容易
實現。Emanuel 教授也有許多文章討論則利用電壓及電流的對稱分量解釋一些
在正弦條件下電力定義的問題，文中建議採用正序之有效電力除以視在電力來
定義功率因數，而視在電力的定義則分成正序有效電力、正序無效電力及不平
衡電力三部份。另外由IEEE許多文獻顯示，針對同一負載使用不同功率因數
定義，其功率因數計算值會有差異，在極端時會由100%變化至70%。在國內
91年節約能源論文發表會中，也顯示針對同一電弧爐負載使用不同功率因數定
義，其功率因數量測值可由97%至90%的差異。由此可知功率因數的定義，實
在需要檢討。此外IEEE Standard 1459-2000[1,18]已針對此種問題的電力量及功
率因數定義作廣泛討論，並希望各界與各電力公司能提出看法與現場實測經
驗。
10
上式中δ為Dirac 函數，因此 )t(s 可被表示為
)t(s)t()t( cs 




n
c )nTt()t(




n
c )nTt()nT( (2.3)
將（2.3）式兩側取連續時間傅立葉轉換




k
scs )kjj(XT
1
)j(X (2.4)
上式中
T
2
s
 為信號之取樣頻率，圖2-2 則為（2.4）式脈衝列取樣之頻域表
示法，由圖中可發現一事實，當
Ns 2 (2.5) 經脈衝取樣後所產生之 )j(X s 方
不致產生交疊（aliasing）現象如圖2-2(c)所示，因此可利用一低通濾波器，將
)j(Xc  由 )j(Xs 中經濾波還原，若（2.5）式不成立亦即 Ns 2 ，則 )j(Xs 將
有交疊現象產生，如圖2-2(d)所示，此時 )j(Xc 並無法從 )j(Xs 經濾波還原。上
述說明即為奈奎斯（Nyquist）取樣定理的概念，其詳細之定理敘述如下：
假設 )t(c 為一有限頻帶信號，即
0)j(Xc  , N (2.6)
若
Ns 2T
2  (2.7)
則 )t(c 可由一取樣序列 ]nT[]n[ c ，n =0,±1,±2...所決定，而2ΩN 稱為奈
奎斯率（Nyquist rate）。
12
一週期為N 的離散序列 ]n[
~
 與連續時間週期性信號同樣可由傅立葉級數
來描述，即以此週期性離散序列基本頻率的整數倍頻率之複數指數序列總和表
示如下
 
k
kn)N2(j
~~
e]k[
N
1
]n[ X (2.8)
因上式中複數指數具有下述性質
]n[ee]n[e Nk
kn)N2(j
k 
  (2.9)
故此週期性離散序列 ]n[
~
 的傅立葉級數表示式，僅需N個複數指數即可完整描
述，如下式所示




1N
0k
kn)N2(j
~~
e]k[
N
1
]n[ X (2.10)
而傅立葉級數係數可經由下式得到




1N
0n
kn)N2(j
~~
e]n[]k[X (2.11)
（2.10）式與（2.11）式即構成離散傅立葉級數（Discrete Fourier Series, DFS）
的合成及分析對，為簡化表示式常定義符號如下
)N2(j
N eW
 (2.12)
故分析方程式變為




1N
0n
kn
N
~~
W]n[]k[X (2.13)
合成方程式為




1N
0k
kn
N
~~
W]k[
N
1
]n[ X (2.14)
其轉換對的關係可以下式描述之
14



 


otherwise,0
1Nk0,W]n[]k[X
1N
0n
kn
N (2.22)



  



otherwise,0
1Nn0,W]k[X
N
1
]n[
1N
0k
kn
N (2.23)
而一般離散傅立葉轉換對均多以下式表示
分析方程式
kn
N
1N
0n
W]n[]k[X 


 (2.24)
合成方程式




1N
0k
kn
NW]k[XN
1
]n[ (2.25)
其轉換對的關係可以下式描述之
]k[X]n[ DFS
2.4快速傅立葉轉換
離散傅立葉轉換在離散數位信號處理的分析設計及應用扮演著相當重要
的角色[20]，然而當以（2.24）式進行DFT 運算時其時間複雜度相當大，因 ]n[
及X[k]可以為複數，以（2.24）式直接運算其所需的計算時間約與 2N 成正比，
即時間複雜度為 )N(O 2 ，如此長的運算時間在許多應用中是不允許的，因此利
用適當的演算法進行DFT 轉換是相當重要的。
在數位信號處理的應用上最常使用的演算法為快速傅立葉轉換（Fast
Fourier Transform, FFT），此演算法能有效率的進行DFT 轉換，其所需之時間
複雜度約為 )NlogN(O 2 ，當序列長度N相當大時，可有效降低計算所需之時
間 ， 在 此 介 紹 兩 種 基 本 的 FFT 演 算 法 ， 一 稱 為 分 時 FFT 演 算 法
16
（2.31）式中G[k] 及H[k] 可視為 ]n[ 序列偶數點及奇數點之N/2 點的DFT 轉
換，如圖2-4-1 所示為8 點的DFT流程圖。由（2.31）式可依同樣的方法進一步
將N/2 點的DFT 分割成兩個N/4 點的DFT 並依此類推，如（2.31）式中G[k] 可
進一步分解成




1)2N(
0r
rk
2NW]r[g]k[G







1)4N(
0
k)12(
2N
1)4N(
0
k2
2N W]12[gW]2[g



 






1)4N(
0
k)
4N
k
2N
1)4N(
0
k
4N W]12[gWW]2[g



  (2.32)
同理






1)4N(
0
k)
4N
k
2N
1)4N(
0
k
4N W]12[hWW]2[h]k[H



  (2.33)
在最後階段將成為僅2點的DFT運算如圖2-3中8點的DFT運算其最後階段中2
點的DFT 運算如圖2-4 所示，由圖2-3 及圖2-4 的比較可發現圖2-3 流程圖均為
如圖2-4 流程圖形式的組成，而觀察圖2-4 可發現其存在兩複數乘法，此複數
乘法可再利用 knNW 的對稱性以及週期性修正成如圖2-5 稱為蝴蝶圖，此流程圖
將其複數乘法數目降為原先的1/2 倍，可有效的降低計算所需之時間，圖2-6 則
顯示最後完整的8 點DFT 流程圖
圖2-3 分時FFT 演算法中2 點DFT 流程圖
18
圖2-6 利用分時FFT 演算法蝴蝶圖計算之8 點DFT 流程圖
2.4.2分頻FFT演算法
在分時FFT演算法中，是將χ[n]序列分成許多小序列以較少點數的DFT計
算，而分頻FFT演算法則是將輸出序列X[k]分成許多的子序列再進行DFT的運
算，同樣考慮N 為2 的冪次方，由X[k]的DFT 轉換式可知
kn
N
1N
0n
W]n[]k[X 


   ,  k=0,1,2,…,N-1 (2.34)
其偶數點為
20




1)2/N(
0n
)1r2(n
NW)])2/N(n[]n[(]1r2[X   , r=0,1,2,…,(N/2)-1




1)2/N(
0n
nr
2/N
n
N WW)])2/N(n[]n[(




1)2/N(
0n
nr
2/N
n
N WW]n[h (2.40)
（2.37）及（2.40）式兩演算法的流程如圖2-7 所示，依前述相同的方法推導可
得最後一級2 點DFT的流程圖，如圖2-8 所示，而圖2-9 則顯示一8 點DFT以分
頻FFT 演算法計算之完整流程。
圖2-7 分頻FFT演算法分解成兩N/2點DFT流程圖
22
第三章電力量與功率因數之定義
在正弦平衡系統的電力量定義向來非常明確，但是隨著科技的發展使得電
力電子元件的大量運用，諧波及不平衡問題愈趨嚴重，使得電力系統變成已非
正弦且不平衡。諧波及不平衡對電力量的影響雖有持續的探討，但以往一直未
有明確的規範提出，因此西元2000年IEEE再度提出於非正弦及不平衡系統的
相關電力量試用標準以供各界參考。本章介紹IEEE 1459-2000的內容，以及目
前國內所使用的視在功率、功率因數及相關電力量定義，探討於諧波及不平衡
負載下各視在功率的影響，並比較視在功率及功率因數與線路損失之關係，進
而分析各定義於諧波、不平衡及負載變動下所具有的指標意義以及所受之影
響。
3.1單相系統功率因數
在無諧波污染的正弦單相系統中，電壓及電流的瞬時值為
)tsin(V2)t(v  (3.1)
)tsin(I2)t(i  (3.2)
視在功率的定義為電壓有效值乘以電流有效值，即
VIS (3.3)
實功率（平均功率）的定義為
 cosVIP (3.4)
其中   為電壓及電流的相角差
虛功率的定義為
 sinVIQ (3.5)
功率因數的定義為
22 QP
P
S
P
PF

 (3.6)
24
2
B
22
B QPSD  (3.15)
在（3.13）式及（3.15）式中，下標B的意義為此定義由Budeanu在1927年所提
出[21]。
3.2三相系統功率因數
前述正弦及非正弦條件下的差異在三相系統中亦然，故在IEEE 1459-2000
對含有諧波及不平衡的三相電路分別定義。算術視在功率（Arithmetic Apparent
Power）SA、向量視在功率（Vector Apparent Power）SV及等效視在功率（Effective
Apparent Power）Se，以及對應之功率因數定義：算術功率因數（Arithmetic Power
Factor）PFA、向量功率因數（Vector Power Factor）PFV及等效功率因數（Effective
Power Factor）PFe。
1. 算術視在功率及功率因數
算術視在功率
TTSSRRTSRA IVIVIVSSSS  (3.16)
算術功率因數
A
A S
P
PF  , P=PR+PS+PT (3.17)
2. 向量視在功率及功率因數
向量視在功率
2
B
2
B
2
V DQPS  (3.18)
     2BTBSBR2BTBSBR2TSR DDDQQQPPP 
向量功率因數
V
V S
P
PF  , TSR PPPP  (3.19)
算術視在功率及向量視在功率原在IEEE標準辭典[22]中已有提及，更早的
26
4. 基本波視在功率及功率因數
基本波視在功率
2
1
2
11 QPS  (3.26)
其中 1T1S1R1 PPPP 
1T1S1R1 QQQQ 
對應之功率因數稱為基本波功率因數
)
P
Q
cos(tan
S
P
cosPF
1
11
1
1
11
 (3.27)
5. 第一種修正型基本波視在功率及功率因數
第一種修正型基本波視在功率
2
1M1
2
11M1 QPS  (3.28)
 0Q,Q 0Q,01M1 11 1Q 
其中 1T1S1R11T1S1R1 QQQQ,PPPP 
對應的功率因數稱為第一種修正型基本波功率因數
)
P
Q
cos(tanPF
1
1M11
1M1
 (3.29)
台電目前的功率因數計算方式，如果以機械轉盤式電表量測而得，僅考慮
基本波的實功率及虛功率的正值部分，並未計入諧波所產生之影響，其定義可
視為(3.28)、(3.29)式。
6. 第二種修正型基本波視在功率及功率因數
第二種修正型基本波視在功率
2
2M1
2
12M1 QPS  (3.30)
12M1 QQ 
其中 1T1S1R11T1S1R1 QQQQ,PPPP 
對應的功率因數定義稱為第二種修正型基本波功率因數 2M1PF
28

 )dttP
dttQ
cos(tanPF
T
1
T
2M1
1
2M1 

 (3.37)
如果台電對大型用戶功率因數之量測是以三相機電轉盤式kWh（千瓦時）表
及三相機電轉盤式kVARh（千乏時）表，以一個月kWh及kVARh之累計值來
計算當月之平均功率因數值類似於（3.36）所定義。由於三相機電轉盤式kVARh
電表只需稍加修改即可量測正值及負值或絕對值虛功率累計值，故在此一併探
討（3.35）式及（3.37）式所定義之平均功率因數。
3.4評估諧波污染及負載不平衡
為反應諧波以及負載不平衡的影響，有別於以往常用的定義 IEEE
1459-2000中另定義了衡量諧波及不平衡污染的指標。由前述等效視在功率及
功率因數的定義中，可推導三相四線式系統基本波等效電壓及等效電流為
   2 1TR2 1ST2 1RS21T21S21R1e VVVVVV318
1
V  (3.38)
3
IIII
I
2
1N
2
1T
2
1S
2
1R
1e
 (3.39)
三相三線式系統基本波等效電壓及等效電流分別為
9
VVV
V
2
1TR
2
1ST
2
1RS
1e
 (3.40)
3
III
I
2
1T
2
1S
2
1R
1e
 (3.41)
基本波等效視在功率（fundamental effective apparent power）Se1為
1e1e1e IV3S  (3.42)
故等效視在功率包含基本波與諧波成份，即
2
1e
2
eeN SSS  (3.43)
30
1. 算術視在功率
算術視在功率可分解成
TSRA SSSS 
2
TN
2
1T
2
SN
2
1S
2
RN
2
1R SSSSSS  (3.48)
SA包含由諧波所產生的非基本波視在功率。
2. 向量視在功率
向量視在功率亦可分解成
222
V BB DQPS 
2
BH1B
2
BH1B
2
H1 )DD()QQ()PP(  (3.49)
如果某些場合中實與虛的諧波功率為負值，將使得SV值下降功率因數值上升，
因此SV並不適合評估諧波所造成的損失，通常 VA SS  ，亦可由圖3-1之向量圖
看出。
P
R
Q B R
D
B
R
P
S Q B S
D
B
S
P
T Q B T
D
B
T
S T
S S
S R
S V
S A
S V
0
32
       
       
       2NT2TT2ST2RT
2
NS
2
TS
2
SS
2
RS
2
NR
2
TR
2
SR
2
RR
eee
IVIVIVIV
IVIVIVIV
IVIVIVIV
IV3S



 (3.55)
因 TSR VVV 
      2NT2NS2NR2T2S2Re IVIVIVSSS3S  (3.56)
(3.56)不等式兩側取平方可得
      2NT2NS2NR2T2S2R2e IVIVIVSSS3S 
     2NT2NS2NR2A IVIVIVS  (3.57)
最後可得
     2NT2NS2NR2A2e IVIVIVSS  (3.58)
（3.58）式顯示出當含3倍次及其它諧波時Se及SA差異的可能範圍。通常
Ae SS  ，故視在功率及功率因數定義的關係式為
VAe SSS  (3.59)
VAe PFPFPF  (3.60)
b. 三相三線系統
(1) 只含3倍次以外諧波
同樣的首先考慮諧波負載為平衡，但只含有3倍次以外的諧波。
因 RRS V3V 
則
3
VVV
V
2
T
2
S
2
R
e
 (3.61)
由(3.22)及(3.61)式可得等效視在功率為
     
     
     2TT2ST2RT
2
TS
2
SS
2
RS
2
TR
2
SR
2
RR
eee
IVIVIV
IVIVIV
IVIVIV
IV3S



 (3.62)
因負載為三相平衡諧波負載，故 TSR VVV  ，(3.62)式可改寫如下
34
第四章數位積體電路與FPGA介紹
4.1數位積體電路設計簡介
過去電路設計都是使用畫電路圖的方式來加以設計，但現今數位電路設
計由於電腦輔助設計軟體(Computer Aided Design, CAD)功能越來越強大，模
擬合成所需的時間越來越短，而設計的閘數由原來幾千閘增加到數十萬閘，
甚至現在利用矽智財產權(Intellectual Property, IP)來設計系統單晶片(System
On Chip, SOC)，其閘數更達到幾百萬閘，所以以往傳統設計的方式已不合時
宜，而系統設計者總是想要加快產品上市的時間，以提昇自己的競爭力且同
時保證自己的設計無誤，為了要達到快速且功能無誤，所以要慎選設計方
法，通常數位電路設計中主要分為由上而下的設計流程(Top-down Design
Methodology)、由下而上設計流程(Bottom-up Design Methodology)、平坦設計
流程(Flat Design Methodology)等三種設計方式[25]。前述兩種的設計方式均屬
階層式設計，通常階層式設計盡量不要超過三層以上，因為會造成元件間連接
的困難度及除錯困難度，階層式設計往往用於設計較大的電路上。
以上三種設計方法均包含了硬體描述語言、合成及模擬驗證，而現今更
可以利用特殊積體電路應用(Application Specific Integrated Circuit, ASIC)和場
控邏輯閘(Field Programmable Gate Array, FPGA)來實現想要設計的硬體。而超
大型積體電路(Very Large Scale Integration, VLSI)設計技術與製成工業快速成
長，使得所設計的系統越來越複雜，所以數位系統的工程師需要
1. 易學易用的硬體描述語言
2. 功能強大的電腦輔助設計軟體
3. 可以快數雛型化的 IC 元件
藉由以上三個工具來加速獲利時間和上市時間。
36
圖4-1 數位積體電路的分類圖
IO
B
IO
B
IO
B
IO
B
IO
B
IO
B
IO
B
IO
B
IO
B
IO
B
IO
B
IO
B
IO
B
IO
B
IO
B
IO
B
圖4-2 基本FPGA內部方塊結構圖
38
1. 反熔絲架構（Anti-Fuse）：
顧名思義的，其本身就是像熔絲陣列一般，將我們的電路設計下載至
FPGA上，我們稱之為燒錄，原理就是將FPGA的熔絲燒斷，因此若將
電源關掉，則FPGA內之資料不會遺失，此架構稱之為反熔絲架構。
2. 靜態隨機存取記憶體(SRAM)：
SRAM電路主要的架構為雙穩態電路，在被寫入資料後，它會維持原來
狀態直到電源被中斷或是寫入其它的值為止，其中需注意到的一點
為，若將電源關掉，FPGA內的資料會被洗掉，直到下次重新組態
（Configuration）後，FPGA才會恢復原來功能。
所以在設計初期時，儘量使用以SRAM為設計基礎的FPGA來做為設計工
具，因為使用反熔絲架構的FPGA設計時，若設計出現錯誤時，整個FPGA就
無法再使用，除非設計者很有把握，否則建議在設計初期用反熔絲架構的
FPGA。若發生錯誤時，只要重新再將設計下載至FPGA上，等到整個設計成
熟後，再使用反熔絲架構的FGPA，因為再燒斷熔絲後，FPGA功能已固定，
往後在使用過程就不用重新做組態的動作，可以加快開機或執行之速度。
4.4 FPGA的設計流程
FPGA和ASIC兩者的前段設計大致是相同的，因為所設計的電路在經過電
腦輔助設計工具合成、功能驗證等，都沒有牽涉到合成出來的電路要放置什麼
樣的元件(CPLD、FPGA等)，所以前段設計FPGA和ASIC設計流程是相同的，
設計流程圖如圖4-4所示。前段各設計部分說明如下：
1. 規格訂定(Specification)：
在設計初期必須訂立規格，如操作頻率、工作電壓、IC的輸入輸出接腳
（I/O Pins）、臨界路徑、功能區塊等。規格定義的越清楚，往後在設計
IC時，就會避免很多不必要的麻煩。
40
5. 合成(Synthesis)：
將設計者所寫的HDL合成出電路並且將電路最佳化，也就是說合成出來
的電路都是最簡化設計。其中在合成的過程中，設計者需要下設計規範
(Design Constraint)，明白確定操作的頻率要跑多少？面積是否要最小？
是否並行處理等等？都要告訴合成器(Synthesizer)，合成器會將你的需求
轉換成所需的設計，合成器所產生的檔為連線檔(netlist file)，也就是Cell
和Cell的連線關係。
以上五點為前段設計部分，後段ASIC和FPGA的設計流程就不盡相同，其
中FPGA的後段設計部分說明如下：
42
6. 繞線配置(Place & Route)：
在合成過後所產生的連線檔，依照設計者所下的設計規範，藉由電腦輔
助設計工具做Gate level的放置及繞線工作。一般在合成時，設計者所下
的設計規範會被合成器轉換成繞線配置看的懂的指令，也就是說不用在
繞線配置中另外下設計規範，如果設計者沒有下設計規範的話，電腦輔
助設計工具不知道該繞成何種線路，可能就是預設(Default)的線路，也
許就沒有達到規格的需求。所以下設計規範可以讓繞線配置工具知道該
變成時脈為X-MHz，也就是說在臨界路徑上用較快的元件來完成，在比
較不在乎時序的部分，用一般元件來達成。
7. 時序模擬(Time & Simulation)：
在做完繞線配置之後，電腦輔助設計工具會產生含有時間延遲的HDL連
結檔，這是設計者所能做的最後一項把關工作，時序模擬要做的不只是
在功能模擬上所得到的結果，在做完繞線配置之後結果是否正確，驗證
上一級的輸出訊號到下一級的設定時間和保持時間是否符合需求。
8. 電路驗證：
FPGA後段設計流程較ASIC之設計流程少了送至晶圓廠製作及封裝，和
取回之後的測試與除錯等程序，因此，FPGA的設計流程節省了許多設
計時間及成本。FPGA本身就是一顆未經規劃的IC，以其來模擬，具有
高時效性及容許錯誤嘗試之特性，當所設計的電路經由硬體描述語言
設計、編譯、測試完成後，在經由下載將所產生之電路架構編譯檔下
載至FPGA去作規劃，如此便是一顆立即可用的雛型IC。
在數位電路設計要考慮的因素非常的多，如果不注意的話，會導致設計者
所設計之系統無法達到規格要求，一些需注意事項如下所示[28]：
1. 傳輸延遲
44
圖 4-5 組合邏輯電路的傳輸延遲圖
5. 脈衝寬度
脈衝寬度就是一個訊號脈衝所能維持位準的寬度，若你的脈衝寬度小於
預設的值時，可以予以忽略。
6. 輸出延遲時間
輸入訊號通過循序電路時須要注意的是，當觸發訊號觸發時，輸出訊號
會經過一段時間才會生效，在這段時間稱之為輸出延遲時間。
7. 操作電壓
由於製程技術日新愈異，從0.25到現在的0.13製程，操作電壓也由原來
的+5V下降到+3.3V，或是+1.8V等，由於操作電壓降低，所以功率也會
隨之降低。不過要注意的是，通常積體電路的操作電壓可以容許到正負
10%，也就是說在操作電壓為+5V時，若使用為5.1V，IC也是可以動作
的。
8. 操作頻率
在規格中，要將整個系統的操作頻率大約能工作到多少先做個預估，在
繞線配置過後，會產生出實際的物理模型，也就是說需考慮時序的問
題，在系統中會有很多延遲發生，有傳輸延遲、元件延遲、連接延遲等
等，這些延遲都會直接影響到操作頻率。換句話說延遲愈多，操作頻率
46
VHDL做早是由美國國防部為開發高速積體電路所需[29]，用來整合各家
廠商的電路設計所制定的統一數位系統描述標準，一開始不支援邏輯合成的功
能，但有許多廠商看出未來趨勢，開始各自發展邏輯合成工具，許多晶片設計
公司開始發展硬體描述語言，以允許設計者使用比邏輯閘更高層次的發展工
具，在較短的時間內完成設計工作。最初硬體描述語言僅提供電路模擬之功
能，隨後很快便具有電路合成之能力，進而成為取代邏輯閘層次設計之利器。
儘管如此，由於不同公司的硬體描述語言並不一致，因此晶片設計之成果不能
互通，進而造成了許多積體電路委外設計機構如美國國防部(Department of
Defense, DoD)在整合不同公司晶片設計成果上的困擾。有鑑於此，美國國防部
委託IBM、Texas Instrument及Intermetrics等三家公司發展VHDL語言以做為硬
體描述語言之標準，並於1985年發表。隨後此語言於1987年獲得電機電子工程
學會(Institute of Electrical and Electronics Engineering, IEEE)認證為工業標準，
此一標準稱之為IEEE Std 1076-1987。在1993年時，IEEE再次更新VHDL語言，
我們稱此更新後之標準為IEEE Std 1076-1993。
4.5.1 VHDL的優點
1. 提供多種不同的設計方法(design methodology)。
2. 不同的製程特性(technology independence)也不必考量。
3. 可以用來設計各式各樣的數位電路。
4. 它是一種硬體描述語言的標準，設計人員可以用它來交換設計的心
得。
5. VHDL的語法與C語言類似。
4.5.2 VHDL的基本架構
VHDL已普遍應用在數位晶片的設計上，整個VHDL編寫的架構其實就是
再描述一個數位晶片的硬體架構，其架構主要分為四大類：
1. LIBRARY 宣告區：
48
圖4-6 VHDL的寫法與架構
在VHDL中提供了三種撰寫程式的方法，分別為資料流模式(Data flow)、行
為模式(Behavior)描述及結構模式(Structure)，VHDL語言對於三種基本模式的
描述：
1. 資料流模式(Data flow)：在此模式下，所有的敘述句都以平行的方式處
理之，一些比較簡單的組合邏輯電路都是以平行的方式處理輸入信
號，因此，此模式十分合適使用來實現這些組合邏輯電路。
2. 行為模式(Behavior)：此模式下的每一個敘述句的執行次序是有先後次
序，因此，此行為模式描述法之語法與一般高階語言如 C 語言之語法
十分相像。行為模式描述法可以有效的描述順序邏輯之電路如正反
器、暫存器、計數器及有限狀態機器等等。
50
第五章功率因數計算之晶片設計與模擬測試
5.1 程式設計流程
隨著半導體製程技術的進步，積體電路所使用的邏輯閘數不斷地擴充，因
此在設計電路時，無法再利用傳統的電路圖設計方式來實現龐大功能之硬體，
利用VHDL設計數位電路為目前的趨勢，將多功能之IC架構，分割成多個獨立
功能的方塊，再加以模組化，則可增加設計電路之彈性，也可使電路系統易於
維護。圖5-1為積體電路設計的流程圖，首先訂定積體電路的相關規格，其中
包括積體電路內部所使用的資料長度、系統的取樣頻率與電路之輸入輸出腳位
等。待規格訂定完畢後，利用VHDL語言設計電路，並將各個功率因數計算方
法分割為各別獨立功能之電路，同時分別模擬並驗證各子電路功能，再根據階
層式電路設計的技巧，將不同功能方塊所對應的子電路組成完整的電路。利用
VHDL設計電路的過程中，以Xilinx公司所開發的ISE6.1進行程式的撰寫、電路
編譯與模擬驗證，待利用模擬驗證電路之功能正確後，再以Modelsim進行時序
模擬，待時序模擬正確，即可下載至晶片上完成設計。本研究利用模擬與實測
波形資料，同時比對軟體MATLAB計算的結果，以驗證所設計晶片的可行性。
5.2 功率因數計算模組介紹
圖5-2為功率因數計算IC之功能架構圖，功率因數計算IC的運算過程，必
須使用多種數學邏輯運算，可概分為兩個運算模組，各模組分述如下：
52
圖 5-2 功率因數計算IC功能架構圖
5.2.1 FFT計算模組
FFT計算模組的功能為，讀取電壓與電流的瞬時值，執行FFT計算後輸出，
以作為下一級電路輸入。設計中所使用的FFT計算亦為採用Xilinx公司所開發
之FFT core，此FFT core可以計算長度為 42 ~ 142 的DFT與IDFT，其計算法則為
採用Cooley-Tukey所提出之分時FFT演算法。它同時提供連續運算所需之輸入
與輸出之記憶體。本研究針對電壓與電流兩通道的瞬時值執行長度為64的FFT
運算，運算後可得到各頻域上的實部與虛部數值。
5.2.2 絕對值模組
絕對值模組的功能為，讀取FFT模組計算後各頻域上的實部與虛部數
值，執行平方、加法及平方根運算，以計算出各頻域的大小值，其中平方根
運算是利用Xilinx 公司所開發之正規化座標轉換數位計算矽智產(generalized
coordinate rotational digital computer IP，CORDIC core)來實現。CORDIC core
能計算三角函數、方程式邊界值、雙曲線函數與平方根函數。
54
本研究所採用之 FPGA晶片係為Xilinx公司所研製之 Spartan系列之
XC3S1500晶片，其具有高速計算能力及充裕的內部記憶體，因此十分適用於
數位運算晶片之實作。在設計數位IC時，有一個很重要必須考慮的因素，就是
數位資料處理技術，若以浮點數運算則有較精確的計算優點，缺點是浮點數運
算以硬體電路實現較為複雜，而固定點數運算由於電路實現簡單，在很多工業
運用上，使用率遠高於採用浮點數運算。在合成一個整數計算IC設計上，適當
地量化數值扮演著重要的角色。
圖5-4 模擬三相三線系統方塊圖
利用軟體Simulink及Sim Power System所提供的模組(black)建構模擬方塊
圖，架構如圖1，並以Matlab計算分析，模擬程序說明如下：
1. 模擬電源為 w33 220V對稱電壓源模組 (Symmeytical Three-phase
Voltage)。
56
變化曲線，其說明如下：
a. 因 1PF 、 1M1PF 與 2M!PF 僅利用各相負載基本波實功率及虛功率部份，所 以
當總負載量固定而不平衡程度增加，此三功率因數值並不隨著 U1S 改
變。即 2M11M11 PFPFPF  。
b. VPF 利用各相實虛功率及失真功率的總和來計算功率因數值，但在三
相總負載固定且無諧波的條件下，此時失真功率為零，故無法反應出現
路損失與不平衡程度。僅 ePF 隨 U1S 上升而下降，表示僅 eS 能呈現負載不
平衡的特性。即 VAe PFPFPF  。
4. Case4將諧波百分比固定為100%，改變 U1S 與Case3相同，則同時考慮諧波成
分與不平衡負載的影響，其結果就如同Case2及Case3的共同影響，結果顯
示 2M11M11VAe PFPFPFPFPFPF  ，
表5-1 4種負載狀況
三相負載狀況 Case1 Case2 Case3 Case4
)kW(P 1R 5 5 5~8.575 5~8.575
)kW(P 1S 5 5 5~1.425 5~1.425
基本波
實功率
)kW(P 1T 5 5 5 5
var)k(Q 1R 1.65 1.65 1.65~2.365 1.65~2.365
var)k(Q 1S 1.65 1.65 1.65~0.935 1.65~0.935
基本波
虛功率
var)k(Q 1T 1.65 1.65 1.65 1.65
(%)
S
S
1e
eN 0 0~220 0 100
三相平衡 三相平衡 三相不平衡 三相不平衡
落後性 落後性 落後性 落後性三相負載說明
無諧波 有諧波 無諧波 有諧波
表5-2 計算Case1三相負載端所得六種功率因數
功率因數定義 ePF APF VPF 1PF 1M1PF 2M1PF
Case1 0.9496 0.9496 0.9496 0.9496 0.9496 0.9496
表5-3計算Case2三相負載端所得六種功率因數
(%)
S
S
1e
eN
ePF APF VPF 1PF 1M1PF 2M1PF
0 0.9496 0.9496 0.9496 0.9496 0.9496 0.9496
58
35 0.8927 0.9485 0.9496 0.9496 0.9496 0.9496
40 0.8773 0.9481 0.9496 0.9496 0.9496 0.9496
45 0.8609 0.9475 0.9496 0.9496 0.9496 0.9496
50 0.8436 0.9467 0.9496 0.9496 0.9496 0.9496
55 0.8256 0.9455 0.9496 0.9496 0.9496 0.9496
圖5-6 U1S 對六種功率因數值的變化曲線
表5-5計算Case4三相負載端所得六種功率因數
(%)
S
S
1e
eN (%)
S
S
1
U1
 ePF APF VPF 1PF 1M1PF 2M1PF
100 0 0.6702 0.6702 0.6702 0.9496 0.9496 0.9496
100 5 0.6698 0.6700 0.6702 0.9496 0.9496 0.9496
100 10 0.6685 0.6693 0.6702 0.9496 0.9496 0.9496
100 15 0.6663 0.6682 0.6702 0.9497 0.9497 0.9497
100 20 0.6633 0.6666 0.6702 0.9497 0.9497 0.9497
100 25 0.6595 0.6646 0.6703 0.9497 0.9497 0.9497
100 30 0.6550 0.6621 0.6703 0.9497 0.9497 0.9497
100 35 0.6497 0.6591 0.6703 0.9497 0.9497 0.9497
100 40 0.6438 0.6556 0.6703 0.9497 0.9497 0.9497
100 45 0.6373 0.6517 0.6703 0.9497 0.9497 0.9497
60
100%
-
(%)
(Matlab)
(Matlab)(FPGA) 
目標值
目標值模擬值
表5-6~表5-4為Case2、Case3與Case4中資料的計算結果比對，可看出以
Matlab所計算出的各視在功率與功率因數與以FPGA所計算出的各視在功率與
功率因數，兩者的結果相當近似，平均誤差最大約於0.2%，對此可證明所設計
IC的可行性。
表5-6計算Case2三相負載端所得三種視在功率Matlab與FPGA計算值
)VA(Se )VA(SA )VA(SV(%)
S
S
1e
eN
Matlab FPGA (%) Matlab FPGA (%) Matlab FPGA (%)
0 15709 15668 -0.259% 15709 15681 -0.178% 15709 15680 -0.182%
20 16022 15979 -0.266% 16022 15992 -0.189% 16022 15992 -0.190%
40 16928 16887 -0.241% 16928 16900 -0.163% 16928 16900 -0.165%
60 18338 18296 -0.230% 18338 18310 -0.153% 18338 18310 -0.154%
80 20148 20104 -0.219% 20148 20119 -0.142% 20148 20119 -0.142%
100 22259 22212 -0.210% 22259 22229 -0.133% 22259 22229 -0.133%
120 24594 24542 -0.213% 24594 24560 -0.136% 24594 24560 -0.136%
140 27096 27042 -0.198% 27096 27062 -0.127% 27096 27062 -0.127%
160 29723 29666 -0.192% 29723 29684 -0.132% 29723 29684 -0.132%
180 32443 32382 -0.188% 32443 32405 -0.118% 32443 32405 -0.118%
200 35236 35170 -0.187% 35236 35196 -0.114% 35236 35196 -0.114%
220 38085 38014 -0.186% 38085 38046 -0.104% 38085 38046 -0.103%
平均
誤差
-0.216%
平均
誤差
-0.141%
平均
誤差
-0.141%
表5-7計算Case2三相負載端所得基本波實功率Matlab與FPGA計算值
)W(P )W(P1(%)
S
S
1e
eN
Matlab FPGA (%) Matlab FPGA (%)
0 14917 14890 -0.179% 14917 14903 -0.091%
20 14917 14887 -0.203% 14917 14888 -0.193%
40 14917 14889 -0.190% 14917 14892 -0.167%
60 14917 14889 -0.185% 14917 14895 -0.151%
80 14917 14889 -0.186% 14917 14896 -0.139%
100 14917 14890 -0.181% 14917 14899 -0.122%
120 14917 14889 -0.187% 14917 14900 -0.116%
140 14917 14889 -0.188% 14917 14901 -0.105%
160 14917 14888 -0.193% 14917 14901 -0.109%
180 14917 14888 -0.192% 14917 14903 -0.097%
200 14917 14888 -0.192% 14917 14903 -0.093%
220 14917 14890 -0.183% 14917 14903 -0.091%
平均
誤差
-0.188%
平均
誤差
-0.123%
表5-8-1計算Case2三相負載端所得各功率因數Matlab與FPGA計算值
62
15000
20000
25000
30000
35000
40000
0 50 100 150 200 250
SeN/Se1(%)
Se
(V
A
)
Matlab
FPGA
圖5-8 Case2中等效視在功率 eS 相對於 eNS 變化曲線
15000
20000
25000
30000
35000
40000
0 50 100 150 200 250
SeN/Se1(%)
SA
(V
A
)
Matlab
FPGA
圖5-9 Case2中算術視在功率 AS 相對於 eNS 變化曲線
64
表5-9計算Case3三相負載端所得三種視在功率Matlab與FPGA計算值
)VA(Se )VA(SA )VA(SV(%)
S
S
1
U1
 Matlab FPGA (%) Matlab FPGA (%) Matlab FPGA (%)
0 15706 15675 -0.195% 15706 15687 -0.118% 15706 15688 -0.12%
5 15727 15695 -0.201% 15706 15687 -0.120% 15706 15689 -0.11%
10 15790 15759 -0.198% 15706 15690 -0.105% 15705 15690 -0.09%
15 15893 15862 -0.194% 15708 15692 -0.101% 15705 15690 -0.10%
20 16036 16005 -0.196% 15709 15694 -0.096% 15704 15691 -0.08%
25 16219 16188 -0.193% 15712 15699 -0.085% 15704 15692 -0.08%
30 16439 16408 -0.191% 15716 15704 -0.077% 15703 15691 -0.08%
35 16695 16663 -0.193% 15721 15709 -0.078% 15703 15692 -0.07%
40 16986 16953 -0.194% 15728 15717 -0.071% 15702 15694 -0.05%
45 17309 17275 -0.196% 15738 15729 -0.058% 15702 15694 -0.05%
50 17664 17630 -0.192% 15751 15743 -0.052% 15701 15695 -0.04%
55 18048 18013 -0.194% 15770 15762 -0.048% 15701 15695 -0.04%
平均
誤差
-0.194%
平均
誤差
-0.077%
平均
誤差
-0.066%
表5-10計算Case3三相負載端所得基本波實功率Matlab與FPGA計算值
)W(P )W(P1(%)
S
S
1
U1

Matlab FPGA (%) Matlab FPGA (%)
0 14906 14897 -0.060% 14906 14896 -0.067%
5 14905 14898 -0.048% 14905 14897 -0.051%
10 14905 14899 -0.037% 14905 14897 -0.057%
15 14905 14898 -0.045% 14904 14896 -0.051%
20 14904 14900 -0.028% 14904 14896 -0.056%
25 14904 14901 -0.019% 14904 14897 -0.047%
30 14903 14900 -0.022% 14903 14898 -0.036%
35 14903 14901 -0.011% 14903 14896 -0.047%
40 14902 14903 0.006% 14902 14897 -0.032%
45 14902 14903 0.008% 14902 14897 -0.034%
50 14902 14905 0.018% 14902 14897 -0.036%
55 14901 14905 0.024% 14901 14896 -0.033%
平均
誤差
-0.011%
平均
誤差
-0.043%
表5-11-1計算Case3三相負載端所得各功率因數Matlab與FPGA計算值
ePF APF VPF(%)
S
S
1
U1

Matlab FPGA (%) Matlab FPGA (%) Matlab FPGA (%)
0 0.9496 0.9503 0.0781% 0.9496 0.9496 0.0016% 0.9496 0.9496 -0.0012%
5 0.9477 0.9492 0.1567% 0.9496 0.9497 0.0088% 0.9496 0.9496 -0.0026%
10 0.944 0.9455 0.1564% 0.9496 0.9496 0.0048% 0.9496 0.9496 -0.0004%
15 0.9378 0.9392 0.1524% 0.9495 0.9494 -0.0093% 0.9496 0.9496 -0.0033%
20 0.9294 0.9310 0.1692% 0.9493 0.9494 0.0106% 0.9496 0.9496 -0.0043%
25 0.9189 0.9205 0.1767% 0.9491 0.9492 0.0099% 0.9496 0.9496 -0.0004%
30 0.9066 0.9081 0.1658% 0.9489 0.9488 -0.0114% 0.9496 0.9496 -0.0040%
66
15000
15500
16000
16500
17000
17500
18000
0 10 20 30 40 50 60
S1U/S1
+(%)
SA
(V
A
)
Matlab
FPGA
圖5-13 Case3中算術視在功率 AS 相對於 U1S 變化曲線
15000
15500
16000
16500
17000
17500
18000
0 10 20 30 40 50 60
S1U/S1
+(%)
SV
(V
A
)
Matlab
FPGA
圖5-14 Case3中向量視在功率 VS 相對於 U1S 變化曲線
68
5 14918 14891 -0.183% 14918 14901 -0.114%
10 14919 14892 -0.180% 14918 14903 -0.103%
15 14919 14894 -0.169% 14919 14902 -0.117%
20 14920 14893 -0.183% 14920 14904 -0.109%
25 14920 14895 -0.168% 14920 14904 -0.110%
30 14921 14895 -0.175% 14921 14905 -0.110%
35 14922 14896 -0.175% 14922 14905 -0.116%
40 14922 14896 -0.174% 14922 14908 -0.093%
45 14923 14899 -0.158% 14923 14907 -0.104%
50 14924 14899 -0.169% 14923 14907 -0.106%
55 14924 14899 -0.171% 14924 14907 -0.112%
平均
誤差
-0.174%
平均
誤差
-0.115%
表5-14-1計算Case4三相負載端所得各功率因數Matlab與FPGA計算值
ePF APF VPF(%)
S
S
1
U1
 Matlab FPGA (%) Matlab FPGA (%) Matlab FPGA (%)
0 0.6702 0.6703 0.0189% 0.6702 0.6698 -0.0576% 0.6702 0.6698 -0.0578%
5 0.6698 0.6699 0.0170% 0.6700 0.6696 -0.0595% 0.6702 0.6698 -0.0593%
10 0.6685 0.6686 0.0202% 0.6693 0.6689 -0.0571% 0.6702 0.6698 -0.0582%
15 0.6663 0.6665 0.0273% 0.6682 0.6679 -0.0489% 0.6702 0.6699 -0.0489%
20 0.6633 0.6634 0.0142% 0.6666 0.6663 -0.0523% 0.6702 0.6699 -0.0541%
25 0.6595 0.6597 0.0270% 0.6646 0.6643 -0.0489% 0.6703 0.6699 -0.0525%
30 0.6550 0.6551 0.0198% 0.6621 0.6618 -0.0513% 0.6703 0.6699 -0.0538%
35 0.6497 0.6498 0.0207% 0.6591 0.6588 -0.0470% 0.6703 0.6699 -0.0534%
40 0.6438 0.6439 0.0158% 0.6556 0.6553 -0.0527% 0.6703 0.6699 -0.0548%
45 0.6373 0.6375 0.0343% 0.6517 0.6514 -0.0389% 0.6703 0.6700 -0.0446%
50 0.6302 0.6303 0.0205% 0.6472 0.6469 -0.0420% 0.6703 0.6700 -0.0495%
55 0.6227 0.6228 0.0145% 0.6423 0.6420 -0.0446% 0.6704 0.6700 -0.0518%
平均
誤差
0.021%
平均
誤差
0.05%
平均
誤差
0.053%
表5-14-2計算Case4三相負載端所得各功率因數Matlab與FPGA計算值
1PF 1M1PF 2M1PF(%)
S
S
1
U1
 Matlab FPGA (%) Matlab FPGA (%) Matlab FPGA (%)
0 0.9496 0.9496 0.0017% 0.9496 0.9496 0.0017% 0.9496 0.9496 0.0017%
5 0.9496 0.9496 0.0006% 0.9496 0.9496 0.0006% 0.9496 0.9496 0.0006%
10 0.9496 0.9496 0.0006% 0.9496 0.9496 0.0006% 0.9496 0.9496 0.0006%
15 0.9497 0.9496 -0.0004% 0.9497 0.9496 -0.0004% 0.9497 0.9496 -0.0004%
20 0.9497 0.9496 -0.0004% 0.9497 0.9496 -0.0004% 0.9497 0.9496 -0.0004%
25 0.9497 0.9496 -0.0004% 0.9497 0.9496 -0.0004% 0.9497 0.9496 -0.0004%
30 0.9497 0.9496 -0.0015% 0.9497 0.9496 -0.0015% 0.9497 0.9496 -0.0015%
35 0.9497 0.9496 -0.0015% 0.9497 0.9496 -0.0015% 0.9497 0.9496 -0.0015%
40 0.9497 0.9496 -0.0015% 0.9497 0.9496 -0.0015% 0.9497 0.9496 -0.0015%
45 0.9497 0.9496 -0.0025% 0.9497 0.9496 -0.0025% 0.9497 0.9496 -0.0025%
50 0.9497 0.9496 -0.0025% 0.9497 0.9496 -0.0025% 0.9497 0.9496 -0.0025%
55 0.9497 0.9496 -0.0036% 0.9497 0.9496 -0.0036% 0.9497 0.9496 -0.0036%
70
圖5-17 Case4中固定 eNS ，算術視在功率 AS 相對於 U1S 變化曲線
20000
21000
22000
23000
24000
25000
26000
0 10 20 30 40 50 60
S1U/S1
+(%)
S V
(V
A
)
Matlab
FPGA
圖5-18 Case4中固定 eNS ，向量視在功率 VS 相對於 U1S 變化曲線
14000
14500
15000
15500
16000
16500
17000
0 10 20 30 40 50 60
S1U/S1
+(%)
P(
W
)
Matlab
FPGA
72
VSn
-200
-150
-100
-50
0
50
100
150
200
0 320 640 960 1280 1600 1920 2240 2560 2880 3200 3520 3840
時間(取樣數)
電
壓
(V
)
VTn
-200
-150
-100
-50
0
50
100
150
200
0 320 640 960 1280 1600 1920 2240 2560 2880 3200 3520 3840
時間(取樣數)
電
壓
(V
)
圖5-20 某國立科大研究室之三相相電壓波型圖
IR
-200
-150
-100
-50
0
50
100
150
200
0 320 640 960 1280 1600 1920 2240 2560 2880 3200 3520 3840
時間(取樣數)
電
流
(A
)
74
計算方式
Matlab FPGA (%)
P(W) 1132.53 1130.26 -0.20
P1(W) 1132.1 1130.4 -0.15
表5-17 某國立科大研究室之各功率因數計算結果
計算方式
Matlab FPGA (%)
ePF 0.7278 0.7279 0.02
APF 0.7299 0.7295 -0.06
VPF 0.7374 0.7370 -0.05
1PF 0.9595 0.9593 -0.02
1M1PF 0.9595 0.9593 -0.02
2M1PF 0.9595 0.9593 -0.02
5.5 結語
由本章分析可知於諧波、負載不平衡中，僅Se能確實反映出負載之特性，
同時將其表現在PFe的定義上。因此於三相系統中Se及PFe確實為較合適之電力
量定義。本章對於諧波、負載不平衡對各種功率因數的影響如下：
1. 有諧波時： 2M11M11VAe PFPFPFPFPFPF  ，諧波成分愈大時， VPF
與 1PF 之間的差異愈大。
2. 負載不平衡時： 2M11M11VAe PFPFPFPFPFPF  ，不平衡越大
ePF 、 APF 與 VPF 的差異愈大。
本研究為了驗證所提出的功率因數計算方法實用性，利用VHDL語言撰述
各計算模組，再利用一些運算式與矽智產IP，如CORDIC core和FFT core，合
成出整個數位系統。再從給定含有諧波成分與負載不平衡的模擬與實測波形資
料顯示，比對以軟體Matlab計算的結果，驗證所設計的IC可以精確地計算各視
在功率與功率因數。
76
3. 透過模組化電路設計的技巧，以 FPGA 實現電力量與功率因數計算之晶片
設計，利用模擬與實測波型，與軟體 Matlab 的計算比對下，驗證設計 IC 的
正確性。
4. 數位積體電路的技術不斷推陳出新，許多的演算法則大量的被撰寫為 IP，
本研究整合幾個 IP core，實現電力量與功率因數計算在 FPGA 上。
6.2未來研究方向
1. 各種功率因數定義式之差異與諧波污染、負載不平衡等負載特性的量化對
應關係可在仔細研究。
2. 在學界上應用於頻率估測的的方法非常多，本研究使用的是快速傅立葉轉
換，是否在使用其它方法時能夠更精確且快速的計算結果，值得進一步討
論。
3. 增加電力品質可分析的項目，如電壓閃爍、電壓中斷、電壓突昇與電壓驟
降等。對於電力品質之暫態與穩態部分能對不良之電力品質作分析，供後
端電力監控者使用。
4. 結合相關 I/O與其他硬體介面，結合成商業化的量測儀器，供給電力公司或
廠商，可用於現場量測上。
78
IEEE Trans. on Power Delivery, Vol. 11, No. 1, pp. 73-78, 1996.
[11]A. E. Emanuel, “The Buchholz-Goodhue apparent power definition: The
practical approach for nonsinusoidal and unbalance systems,” IEEE Trans. 
on Power Delivery, Vol. 13, No. 2, pp. 344-350, 1998.
[12]A. E. Emanuel, “Apparent power definitions for three-phase
systems,” IEEE Trans. on Power Delivery, Vol. 14, No. 3, pp. 767-772,
1999.
[13]L. S. Czarnecki, “Power related phenomena in three-phase unbalanced
systems,” IEEE Trans. on Power Delivery, Vol. 10, No. 3, pp. 1168-1176,
1995.
[14] P. S. Filipski and P. W. Labaj, “Evaluation of reactive power meters in the 
presence of high harmonic distortion,” IEEE Trans. on Power Delivery, Vol. 
7, No. 4, pp. 1793-1799, 1992.
[15] IEEE Working Group on Nonsinusoidal Situations: Effects on Meter
performance and Definitions of Power, “Practical definitions for powers in 
systems with nonsinusoidal waveforms and unbalanced loads: a
discussion,” IEEE Trans. on Power Delivery, Vol. 11, No. 1, pp. 79-101,
1996.
[16]T. H. Fu and C. J. Wu, “Load Characteristics Analysis of AC and DC Arc 
Furnaces Using Various Power Definitions and Statistic Method,” IEEE 
Trans. on Power Delivery, Vol. 17, No. 4, pp. 1099-1105, 2002.
[17]C. J. Wu, C. P. Huang, T. H. Fu, T. C. Zhao, and H. S. Kuo, “Power Factor 
Definitions and Effect on Revenue of Electric Arc Furnace Load,” IEEE 
International Conference on Power System Technology, Vol. 1, pp. 93-97,
2002,Kunming, China.
[18]A. E. Emanuel, “Summary of IEEE Standard 1459: Definitions for the 
Measurement of Electric Power Quantities Under Sinusoidal,
Nonsinusoidal, Balanced, or Unbalanced Conditions,” IEEE Trans. 
Industry Applications, Vol. 40, No. 3, pp. 869-876, 2004.
80
[33]林俊男，功率因數定義對大型用戶電價計費之影響，國立台灣科技大
學電機工程系碩士學位論文，2002。
82
Kasparova
Application of Fuzzy Sets to Autonomous
Robot Vehicle Navigation Application of
Fuzzy Sets to Autonomous Robot Vehicle
Navigation Using the PIC18F452
Microcontroller
Robert Casey,
Michael Hensler
539-219
A Fuzzy Engine Model for Efficient Stock
Market Prediction
Shereen Mohamed,
Neamat El Gayar,
Hazem Abd
Elazeem
539-672
Application of fuzzy c-means clustering in
power system model reduction for controller
design
Shu-chen Wang,
Pei-hwa Huang,
Chi-jui Wu
539-629
報告人的文章「Application of fuzzy c-means clustering in power system model
reduction for controller design」安排在「Fuzzy Systems」的議程口頭宣讀，很
多人出席。
三、心得與建議
由上面的分析可知第五屆國際智慧計算與人機介面機制研討會中，技術分組
討論的議程包括電機、機械、經濟等裡領域，大會的訴求是針對最新主題立刻
討論以交流各個領域觀念，統合學習的觀念值得學習。大會也舉辦Conference
Banquet，讓大家交流文化與知識。隨著資訊科技的發展，先進國家在此領域
永遠有大量研究人力。筆者參加第五屆國際智慧計算與人機介面機制研討會，
獲益很多，同時亦深盼國內能多加強此領域的研究。
84
2 Fuzzy c-means Cluster Analysis
The method proposed in this paper utilizes fuzzy
c-means clustering (FCM) analysis [14-16] to reduce
the original high-order model into a low-order model.
Cluster analysis [17, 18], of which the task is to
classify non-processed data into certain categories
depending on various traits, is a basic tool commonly
used in several scientific fields. Data in each category
have the most resemblance while being very
dissimilar with data from other categories.
Suppose there are n data points{ jx }, 1 j n  ,
to be clustered into c data clusters. Let ij denote
the degree of membership that jx belongs to the i th
cluster. It is noted that 10  ij and 1 1
c
iji   for
each j . Define the fuzzy partition matrix [ ]ijU  ,
1 i c  , 1 j n  . Therefore, the objective of the
fuzzy c-means algorithm is to determine all the
elements of matrix U . The FCM algorithm is
essentially an iterative procedure and can be
formulated as the following six steps in which
l denotes the iteration number.
(a) Set the number of clusters c . Initialize U
randomly as ( ) [ ]l ijU  , 1l , 1 i c  .
(b) Compute the cluster center ic of each
cluster:
1
1
n m
ij jj
i n m
ijj
x
c






(1)
Note that the value of m normally falls in the range
of 1.5 3m  .
(c) Select the weighting jw of every data point, then
the weighted data point jW as
j j jW x w  (2)
(d) Compute the distance ijd between the j th data
point and the i th cluster center:
ij i jd c W  (3)
(e) 1l l . Compute ij in ( )lU as
2/( 1)
1
1
( )
ij c m
ij kjk d d
 



(4)
(f) If ( 1) ( )l lU U    , a preset accuracy, then stop;
otherwise, return to Step (b).
It is worth noting that in the above algorithm, the
cluster center ic of each cluster is referred to as the
prototype of the cluster and can be considered as the
representative of that cluster.
3 Design Method
Given a state space linear model, dynamic
characteristics of the system can be best revealed
from its poles and zeros. The following steps
comprise the proposed model reduction method and
controller design.
Step1:
After configuring all the parameters of the power
system and linearizing the system state equations, the
following system dynamic equations are obtained:
x Ax Bu
y Cx
 


(5)
where , ,A B C are the state, input, and output
matrices of the system; x , u and y denote the state,
input and output vectors, respectively.
Step2:
From Equation (5), the transfer function is found to
be
1
2
0 1 2
2
0 1 2
( ) ( )
m
m
n
n
H s C sI A B
b b s b s b s
a a s a s a s
 
   
   


(6)
Based on the transfer function, the poles and zeros
can be computed.
Step3:
Using the fuzzy c-means algorithm, it can cluster
separately the poles and zeros in the complex plane to
obtain the corresponding cluster centers. In order to
keep the system oscillatory behaviors, poles with and
without imaginary parts are clustered into distinct
groups, and zeros are processed likewise.
Step4:
The calculated cluster centers replace the respective
groups of poles and zeros of the original system and
collectively constitute the set of poles and zeros for
the reduced-order model. The tentative reduced-order
model transfer function is thus set as
86
Table 3 Poles and zeros of the original model
Poles Zeros
220 .91 0
-8.30 0
-0.21 0
-0.09 j75619000
-0.81 j11.52
Table4. Poles and zeros of the reduced model
Clustered Poles Clustered Zeros
28.75 j75619000
-0.81 j11.52
Table 5 Electromechanical modes of the power
system
Eigenvalue without PSS Eigenvalue with PSS
-0.81 j11.52 -3.04 j11.50
Figure 3. Comparison the original system with and
without power system stabilizer
Step2:
The transfer function of the original model is
calculated as
( 1.33)( 0.001)( 0.67 1.15)
( )
( 8.18 8.83)( 0.67 10.78)( 1.84 1.22)
s s j s j
H s
s j s j s j
   
     
The poles and zeros of the original model are
displayed in Table 3.
Step3:
Using fuzzy c-means algorithm, the poles and zeros
of the original models are processed to obtain some
cluster centers to be used for representing the original
poles and zeros.
Table 4 shows the poles and zeros after
clustering. In Table 4, the poles ( 28.75 ) are obtained
from clustering the poles of the original model,
( 220.91 ), ( -8.30 ), ( -0.21 ), and ( -0.09 ). The poles
( -0.81 j11.52 ) of the electromechanical mode are
retained. Regarding the zeros, the clustered zeros are
( j75619000 ).
Step4:
The cluster center is obtained after computation and
is used to replace the poles and zeros of the original
system to become the reduced model. The tentative
transfer functions for the reduced model are:
75619000
( )
( 28.75)( 0 .81 11.52)
s j
R s
s s j

  
Step5:
The gain adjustment factor is used to adjust the
system response to make the reduced-order model
compatible with the original model. For the study
system, the gain adjustment factors are calculated as
14
0
( )
3.45 10
( ) s
H s
k
R s


  
After the above steps, the transfer function of the
reduced order model is ( )= ( )R s kR s which is given
below
143.45 10 ( 75619000)
( )
( 28.75)( 0.81 11.52)
s j
R s
s s j
  
  
Step6:
The reduced-order model is used to design a
proportional-integral power system stabilizer. If the
electromechanical mode of the closed-loop system is
to be assigned at -2 j11 , the parameters of power
system stabilizier are obtained:
  8 .8 5 2 0 3 .6P Ik k 
From Table5, the electromechanical mode of of
the original model system are obviously improved.
The time responses after a small distrubance is
shown in Figure 3.
WSEAS2006(venice)國科會出國補助報告95-12-06-1
1
行政院國家科學委員會補助國內專家學者出席國際學術會議報告
名稱：第五屆國際智慧計算與人機介面機制研討會[The 5th WSEAS
International Conference on COMPUTATIONAL INTELLIGENCE,
MAN-MACHINE SYSTEMS and CYBERNETICS (CIMMACS '06)]
報告人：吳啟瑞教授
服務機構：國立台灣科技大學（電機系）
會議時間：自95 年11 月20 日至95 年11 月 22日
地點：義大利威尼斯(Venice)
會議主辦機構名稱：World Scientific and Engineering Academy and
Society (WSEAS)國際科學與工程學會及協會
一、簡介
國際科學與工程學會及協會(WSEAS)自1996成立後，即努力舉
辦各類研討會及國際性會議，也積極出版相關定期期刊與會議論文
集，促進學術交流。第五屆國際智慧計算與人機介面機制研討會在
義大利威尼斯(Venice)召開，將電機、電子、資工、資管、機械、企
管等領域的教授集合討論，是很特別的方式，與會者來自世界各大
學、製造廠商、與研究機構之學者專家，有最高級與最新進的文章與
技術研討。
二、過程
第五屆國際智慧計算與人機介面機制研討會在義大利威尼斯
(Venice)召開，該市是亞德里亞海域很特別的城市，號稱水都，即市
內的公共運輸靠的是船與渡輪。風光明媚，街上擠滿行人，有上班族
與觀光客。大會召開期間天氣非常好，會議的議程由Plenary Lecture
開 始 ， 主 題 為 Concurrent Self-Organizing Maps –A Powerful
Artificial Neural Tool for Pattern Recognition，主講者為Polytechnic
University of Bucharest 的 Professor Victor-Emil Neagoe。接下來三
天的活動包括各個Paper Session， 如Image processing, maps and
applications，Neural networks and applications of computational
intelligence ， Man-machine systems and applications ， Fuzzy
Systems ， Data analysis and decision support systems ， Pattern
Recognition，Algorithms, optimization and control等非常精采，出席
學者專家約300人，來自世界各國。報告人也很有榮幸負責主持Fuzzy
Systems的paper section，所有文章如下：
SESSION: Fuzzy Systems
Chair: Jean J. Saade, Chi-Jui Wu
Fuzzy model-based detection of sensor
faults in waste-water treatment plant
Igor Skrjanc 539-692
WSEAS2006(venice)國科會出國補助報告95-12-06-1
3
Application of Fuzzy C-Means Clustering in Power System
Model Reduction for Controller Design
SHU-CHEN WANG1 PEI-HWA HUANG2 CHI-JUI WU3
Department of Electrical Engineering Department of Electrical Engineering
National Taiwan Ocean University National Taiwan University of Science and
Technology
No. 2, Peining Rd., Keelung 20224 No. 43, Sec. 4, Keelung Rd., Taipei 10607
TAIWAN TAIWAN
1scwang@mail.ccmtc.edu.tw
2b0104@mail.ntou.edu.tw
3cjwu@mouse.ee.ntust.edu.tw
Abstract: -This paper presents the application of fuzzy c-means (FCM) clustering in the order reduction
of dynamic models for controller design in a power system. Based on the fuzzy c-means algorithm, a
method is proposed for clustering the poles and zeros of the original power system model into new
clusters from which a reduced-order model can be obtained. Then the reduced-order model is used to
design a proportional-integral type power system stabilizer to improve the damping in system oscillation
after a system disturbance. The reduced-order model can contain the critical dynamic characteristics of
the original model, but let it easier to design the controller. Results from a sample power system are
presented to show the validity of the proposed method. The electromechanical mode of the power system
can be improved by the designed power system stabilier from pole assignment.
Key-Words: -Power system dynamics, Model reduction, Fuzzy c-means, Fuzzy Clustering, Pole
assignment.
1 Introduction
Model order reduction concerns the
transformation of a higher-order model into a
lower-order model through some sort of
computation [1, 2]. A certain relationship between
these two models is preserved and they are similar
in the characteristics under consideration. In
power system studies, creating a dynamic model is
the first step for system stability research,
dynamic behaviors analysis, or other system
functional tests. As systems become larger, their
complexity increases and power system analysis
has to tackle high-order model analysis. However,
computation on the high-order model is highly
complex while the final analysis results may have
unnecessary portions. In this case, having a
low-order model that maintains the main
characteristics of the high-order systemt can
replace the original system and significantly
simplify the computational problem [3-13].
If the stability performance of a power system
is unable to satisfy the specification, the
stabilizing controller can be used to improve the
dynamic characteristics. Without stability
disturbance compensation, steady-state
performance and any other performance index
are not possible. Therefore, a stabilizing
controller of power system is needed. The most
important application of the reduced order model
is let it easier in the design of a suitable controller
for the original high-order system. Many methods
can used to design a power system stabilizier with
output feedback scheme. The pole-placement
design allows for the power system having the
electromechanical mode dynamic to be placed in
desired location.
In this paper, the method based on fuzzy
c-means clustering analysis [14-18] aims to group
poles and zeros of a power system transfer
function into some clusters. For each cluster, the
original system poles (zeros) can be replaced by
each cluster center that becomes the new member
representative of the cluster. All new members
representing their respective clusters jointly
constitute a tentative reduced-order model of the
WSEAS2006(venice)國科會出國補助報告95-12-06-1
5
clustered into distinct groups, and zeros are
processed likewise.
Step4:
The calculated cluster centers replace the
respective groups of poles and zeros of the
original system and collectively constitute the set
of poles and zeros for the reduced-order model.
The tentative reduced-order model transfer
function is thus set as
Figure 1. Single-machine infinite bus power
system
Vref
Vs
EFD
1
KA
1+ sTA
sK f
1+ sTf
VOLTAGE
REGULATOR
STABILIZING
TRANSFORMER
+
-
LIMITER
Vt
-
+
Vpss
Figure 2. Block diagram of static excitation
system
Table 1 The parameters of generator
dX = 2pu 'dX = 0.244pu
'
doT = 4.18sec
qX = 1.91pu 'qX = 0.17pu
'
qoT = 0.55sec
Table 2 The parameters of static excitation system
AK = 400 AT = 0.05
FK = 0.025 FT = 1.0
1
1
( )
( )
( )
t
i i
r
i i
s z
R s
s p


 
 
(7)
Step5:
In order to make the time response of the
reduced-order model compatible with that of the
original higher order model, a gain adjustment
factor defined by
0
( )
( ) s
H s
k
R s 
 (8)
is used to adjust the steady state value of the
reduced order model.
Step6:
The parameters of a proportional-integral power
system stabilizier (PSS) are to be determined. The
power system stabilizier has the transfer funtion
as
I
PSS P
k
V k
s
   (9)
Then the closed-loop transfer function of the
system is
( )
( ) ( )PSS P I
y sH s
v s sk H s k H s

  (10)
4 Example
Consider the single-machine infinite bus power
system shown in Figure 1.
The generator can be represented by the two
axis model. The equations are obtained:
' ' '
'
1
[ ( ) ]d d q q q
qo
E E X X I
T

    (11)
' ' '
'
1
[ ( ) ]q FD q d d d
do
E E E X X I
T

   
(12)
The parameters of generator are shown in Table
1.
The block diagram of static excitation system
is displayed in Figure 2. The parameters of static
excitation system are shown in Table 2.
Based on the above-described method, the
reduced order model and the controller design for
the study system is obtained as follows:
Step1:
Choose the state vector x as:
' 'T
d q FD Sx E E E V        
The definitions for each state variable are
'
dE direct-axis transient voltage
'
qE quadrature-axis transient voltage
WSEAS2006(venice)國科會出國補助報告95-12-06-1
7
system, the gain adjustment factors are calculated
as
14
0
( )
3.45 10
( ) s
H s
k
R s


  
After the above steps, the transfer function of the
reduced order model is ( )= ( )R s kR s which is given
below
143.45 10 ( 75619000)
( )
( 28.75)( 0.81 11.52)
s j
R s
s s j
  
  
Step6:
The reduced-order model is used to design a
proportional-integral power system stabilizer. If
the electromechanical mode of the closed-loop
system is to be assigned at -2 j11 , the parameters
of power system stabilizier are obtained:
  8 .8 5 2 0 3 .6P Ik k 
From Table5, the electromechanical mode of
of the original model system are obviously
improved.
The time responses after a small distrubance
is shown in Figure 3.
5 Conclusion
A model reduction method for reducing the order
of power system dynamic models in controller
design has been proposed in this paper. Based on
the fuzzy c-means algorithm, the proposed
method performs clustering on the poles and the
zeros of the original system model into new
clusters from which a reduced-order model can
be derived. The reduced-order model that
maintains the main characteristics of the
high-order system can significantly simplify the
design of a power system stabilizer. Results from
applying the method to a sample power system
have been demonstrated to show the validity of
the proposed method.
Acknowledgments
This work was supported in part by the National
Taiwan Ocean University and the National
Science Council of Taiwan.
References:
[1] A. Bergen, Power Systems Analysis, Prentice
Hall, New York, 2000.
[2] D. Trudnowski, Order reduction of
large-scale linear oscillatory system models,
IEEE Trans. on Power Systems, Vol. 9, No. 1,
1994, pp. 451-458.
[3] F. Saleh and M. Mahmoud, Design of power
system stabilizers using reduced-order
models, Electric Power System Research, Vol.
33, 1995, pp. 219-226.
[4] A. Feliachi, X. Zhang and C. Sims, Power
system stabilizers design using optimal
reduced order models, IEEE Trans. on
Power Systems, Vol. 3, No. 4, 1988, pp.
1670-1684.
[5] R. Castro and J. de Jesus, A wind park
reduced-order model using singular
perturbations theory, IEEE Trans. on
Energy Conversion, Vol. 11, No. 4, 1996, pp.
735-741.
[6] N. Nihei and T. Oyama, A study on
decomposition and model reduction for wide
area power system stability assessment,
Power Engineering Society 1999 Winter
Meeting of the IEEE, Vol. 1, 1999, pp.
651-654.
[7] N. Sinha and J. Pal, Simulation based
reduced order modeling using a clustering
technique, Computer & Elect. Engineering,
Vol. 16, No. 3, 1990, pp. 159-169.
[8] N. Sinha, Reduced-order models for linear
systems, Proc. of the IEEE Conference on
Systems, Man and Cybernetics, 1992, pp.
537-542.
[9] M. Duric, Z. Radojevic and E. Turkovic, A
reduced order multimachine power system
model suitable for small signal stability
analysis, Electrical Power & Energy Systems,
Vol. 20, No. 5, 1998, pp. 369-374.
[10] G. Obinata and B. Anderson, Model
Reduction for Control System Design,
Springer, 2001.
[11] P. Benner, R. Mayo, E. Quintana-Orti, and G.
Quintana-Orti, A service for remote model
reduction of very large linear systems, Proc.
of the International Parallel and Distributed
Processing Symposium, 2003, pp. 22-26.
[12] H. Ukai, H. Masubara, M. Kobayashi, and H.
Kandoh, Stabilizing control of series
capacitor compensated power system on the
basis of reduced order model, Proc. of the 4th
International Conference on Advances in
Power System Control, Operation and
Management, 1997, pp. 603-608.
