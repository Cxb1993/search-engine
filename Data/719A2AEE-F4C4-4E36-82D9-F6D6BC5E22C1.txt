- 2 -
中文摘要
由兩條或多條不同來源序列所組成的序列稱為嵌合序列。這種嵌
合序列普遍存在於許多的資料庫中，如在 rRNA、基因、與 EST 資料
庫等等。如何在大量資料中正確地找出這些嵌合序列，並選擇出可行
解(即 near-optimal alignments)裡的最佳排列組合，以期更為貼近現實
問題，並對基因與蛋白質之研究及預測有所助益，是本研究的最大目
標。
本研究將目標定為二階段完成，首先是嵌合序列排列問題，研究
之主要目的是在大量資料中找出嵌合序列，此序列由多條(k 條，k>2)
父序列組合而成。其二是設計排列調整演算法以解決相似程度在某個
範圍內(即近似解：near-optimal alignments)時，如何選擇最佳的排列
方式，以便實際應用時，可以得到更佳的嵌合序列排列結果。
第一階段我們定義廣義的嵌合體最長共同子序列問題(mosaic
longest common subsequence problem)。並設計非常有效率之了各個擊
破(divide-and-conquer)演算法與動態規劃(dynamic programming)演算
法來解決此問題。在第二階段，我們使用自定之追跡(tracing)技巧並
配合動態規劃演算法，找出可行解之最佳排列組合。
本計畫之成果除分別發表於國際期刊外[Huang07, Tseng06]，尚有
WEB 介面之程式實作，可供有興趣者進一步驗証，畫面及操作方式
將附錄於本結案報告之後。
Abstract
A chimeric sequence is a sequence consisting of two or more
heterologous parent sequences. There are many chimeric sequences in
the databases of rRNA, genes and ESTs. How to search those chimeris
sequences in such huge amount of data and to choose the biologically
meaningful alignment among acceptable/near-optimal alignments are
- 4 -
序列。
在只考慮目前存活物種的前提下，這種序列應不可能存在，或突
然在實驗室變出來。為了純化與修正 PCR-clone 的序列資料，許多專
家提出了不同的嵌合序列的現象與偵測方法[Qiu01, Spek01, Wang96,
Wang97, Koma97, Lies91, Cole03, Robi95, Hube04]。在實際生物序列
資料中，16S rRNA 可幫助我們了解微生物之間的差異 [Huge98,
Pace97]，但其定序過程與 PCR 有關，所以在 16S rRNA 研究上也有
嵌合序列的問題。目前因為 16S rRNA 之資料比較完整，一些研究也
以 16S rRNA 為偵測嵌合序列之對象[Huge03, Hube04, Koma97]。
在生物學家研究序列之過程中常常會利用生物序列排列
(sequence alignment)，而如何定義排列方式或分數計算方式，就有許
多變形。圖一表示全域排列 (global alignment)、區域排列 (local
alignment)與嵌合排列(chimeric alignment)三者之關係，由圖中我們很
容易可以看出其不同點。全域排列比較傾向挑出長度比較接近或更長
之序列，直覺上長度越長，在條件相似的情況下，分數也可能越高。
在區域排列中，若有一較小片段非常相似，就較易挑出此片段，這時
其他部份可能就不再被考慮。若暫不考慮生物上的意義，嵌合排列可
說是為了改善或避免全域排列與區域排列之缺點。而且其在生物序列
研究上有其重要價值。
- 6 -
到目前為止，許多嵌合序列之偵測方法侷限於找出最佳的兩條序
列組合成嵌合序列。但在未知的現實中，我們不能排除嵌合序列由多
條序列所構成之可能性。因此本計畫的第一個目標就是設計一個演算
法偵測一序列是否可能為 k 段(k≧2)父序列所組成。
解決第一個目標後，我們檢視其結果，發現所謂最適的嵌合序列
除其相似度分數為最高外，並未對其嵌合序列的排列情形加以討論或
處理。我們以 A = agactagagatt與 B= agaga為例子，採用最簡
單的計分方式，相同得一分，不相同或 gap 則不給分亦不扣分。我
們會得到下列九種相同得分的不同排列結果：
A = agactagagatt A = agactagagatt A =agactagagatt
B = aga---ga---- B = -----agaga-- B =--a---gaga--
A = agactagagatt A = agactagagatt A =agactagagatt
B = aga-----ga-- B = a-----gaga-- B =ag-----aga—-
A = agactagagatt A = agactagagatt A = agactagagatt
B = aga---g--a-- B = ag---ag--a-- B = ag---a--ga--
倘若遇到上述具相同相似度，但卻具有多組不同之序列排列方式
時，該如何選擇較好的排列就成為另一個問題。若再加入[Naor94]之
概念，相似度分數最高之排列組合未必是生物上具意義的排列組合，
反而多半會出現在所謂的近似解(near-optimal alignments)。據此，本
研究計畫的第二個目標，就是要解決在可接受的相似度時(近似最佳
解)，在一大群的較優排列中，我們如何另定篩選的方式，以便選擇
最佳的排列方式，讓嵌合序列排列的結果更符合生物上的意義。相較
於一般的序列排列演算法只告訴我們在數學上最高的分數
(mathematical optimum)，而我們欲找出具生物意義或滿足某些特性下
之最好的排列方式（biological optimum），此對於嵌合序列之標示與
- 8 -
L(2i,p,q)意謂在目標序列的位置 p 到位置 q 之間，使用 2i個來源序列
之最佳解。
步驟三：
計算L(2i,p,q)=max1prqn{ L(2i-1,p,r)+ L(2i-1,r+1,q)}，其中1iw。
步驟四：
如果 i≠w，L(b[i,0],p,q)=max1prqn{ L(2i×bi,p,r)+ L(b[i-1,0],r+1,q)}
其中 1iw。
b[i,0]意謂二進位制 k 最右邊之 i+1 個位元。
步驟五：
輸出 L(k,1,n)。
我們上列福爾摩莎 1 號的時間複雜度為 O(n2m|S|+n3logk)。我們對
此仍不滿足，進一步改善我們的演算法，採用前處理的方式，使得時
間複雜度可降得更低。
演算法：福爾摩莎 2 號
步驟一：
初始化，V0=0
步驟二：
對所有的 SiS，計算並儲存其 S-table St(T,Si)
St(T,Si)儲存所有 T 的末端字串(suffix string)與 Si的 LCS 長度。
步驟三：
對所有的 SiS 及 1lk，計算 Vl=minE{Vl-1⊕St(T,Si)}
minE{}為我們自訂之函數，輸入值為長度不一之向量集合，輸出值為
各向量值相對位置之最小值。如 minE{(5,1,6), (2,3,4,1), (2,2,3)} =
(2,1,3,1)。
而 Vl-1⊕St(T,Si)計算方式如下例所示：
- 10 -
者，則稱為一區塊。(可細分為、、+等三種區塊)
近似解區塊排列問題：每一近似解皆可被唯一方式切割為、、+等
三種區塊之組合，我們定義為該近似解所有區塊長度之次方和，
本問題旨在求出為最大值之近似解。
 追跡(tracing)技巧(找出所有近似解)
路徑選擇損分公式：在回溯路徑選擇時、若由 x 點回溯至 y 點，(x、
y 相鄰)，則其損分公式為「x 目前得分-y 目前得分-xy 邊線得分」。(目
前得分為圓圈內之數字，邊線得分則為 xy 間之邊線上數字)
例一：由點(4,5)回溯至(3,4)時、「5-4-1=0」，即代表選擇此路徑損分為
0。(換言之、此路徑為最佳路徑)
例二：由點(4,5)回溯至(3,5)時、「5-3-(-1)=3」，即代表選擇此路徑損分
為 3。
- 12 -
範例結果列表(所有近似排列組合及其值,=0,=2)
為最大值之背後動機為選出之排列組合、其相似/不相似(
的區域較為明顯，在生物上才足見其意義。例如在前例中，選出為
最大值的排列組合為 排列，可顯見其相似區域。詳細討
論及其演算法細節可參閱[Tseng06]。
4 結論與討論
本研究計畫依訂定的兩大目標，分別得到豐碩的成果。在第一目
標中，我們提出兩種演算法解決嵌合體最長共同子序列問題。此問題
之動態規劃演算法(福爾摩莎 2 號)比各個擊破法(福爾摩莎 1 號)更快
的原因在於我們運用了前人所提之 LCS 資料結構之前處理技巧，因
為此資料結構的存在，讓我們可以非常有效率的求得兩序列 C1與 C2
|bbacdd
-|abdcd
- 14 -
[4] [Huge98] P. Hugenholtz, B. M. Goebel and N. R. Pace, “Impact of 
culture-independent studies on the emerging phylogenetic view of
bacterial diversity”, Journal of Bacteriol, Vol. 180, pp. 4765-4774,
1998.
[5] [Huge03] P. Hugenholtz and T. Huber, “Chimeric 16S rDNA
sequences of diverse origin are accumulating in the public databases”, 
International Journal of Systematic and Evolutionary Microbiology,
Vol. 53, pp. 289-293, 2003.
[6] [Koma97] G. Komatsoulis and M. Waterman, “A new computational 
method for detection of chimeric 16S rRNA artifacts generated by
PCR amplification from mixed bacterial populations”, Applied and
Environmental Microbiology, Vol. 63, pp. 2338-2346. 1997.
[7] [Kopc94] E. D. Kopczynski, M. M. Bateson and D. M. Ward,
“Recognition of chimericsmall-subunit ribosomal DNAs composed
of genes from uncultivated microorganisms”, Applied and
Environmental Microbiology, Vol. 60, pp. 746-748, 1994.
[8] [Lies91] W. Liesack, H. Weyland and E. Stackebrandt, “Potential 
risks of gene amplification by PCR as determined by 16S rDNA
analysis of a mixed-culture of strict barophilic bacteria”, Microbial
Ecology, Vol. 21, pp. 191-198, 1991.
[9] [Naor94]D. Naor and D. L. Brutlag, “On near-optimal alignments of
biological sequences”, Journal of Computing Biology, Vol. 4, pp.
349-366, 1994.
[10][Pace97] N. R. Pace, “A molecular view of microbial diversity and 
the biosphere”, Science, Vol. 276, pp. 734–740, 1997.
[11][Qiu01] X. Y. Qiu, L. Y. Wu, H. S. Huang, P. E. McDonel, A. V.
- 16 -
6 附錄
http://bio.cse.nsysu.edu.tw/NBA/
前言
此網址旨在利用實作之資訊，幫助讀者了解近似解區塊排列問題
(Near-optimal Block Alignment)演算法之流程及其結果。本網址免費提
供非商業性學術研究使用，若有操作及核心演算法等相關問題，歡迎
各界不吝指教。
Department of Computer Science and Engineering
National Sun Yat-sen University Kaohsiung, Taiwan 80424
URL: http://par.cse.nsysu.edu.tw
TEL: +886-7-5252000 ext. 4345
- 18 -
這三個欄位，第一個為序列比對時所使用的分數矩陣，只需依序
輸入分數矩陣的上三角部份資料即可，可參照左方之例子。
第二個欄位為我們計畫中的近似閥值 d，第三個則是閥值。
在此部份，可設定較相似、無關、較不相似等區塊之著色方式。
待一切設定完成，即可按下下方的兩個鈕之一來檢視最後結果。
左方的鈕為簡易的執行結果，僅列出在各等級的近似解下的最佳排列
結果。右方的鈕則會列出在報告中使用到的各項變數資料及最後結
果，以使讀者更加了解。
