the rate distortion bound and has the best 
performance among similar works in the world up to 
now. Compared with previous works, our coding 
structure can offer more design flexibility in terms 
of statistical distribution of the side information 
and practical code rate selection. 
英文關鍵詞： Cognitive radio, relay, cooperative transmission, 
distributed source coding, Wyner-Ziv coding, rate 
distortion, LDPC, LDGM, simultaneously good for 
source and channel code. 
 
 1
 Cognitive-Cooperative Multiple Access with Distributed Coding (3/3) 
 
 
英文摘要 
The next generation wireless networks will integrate several application scenarios and provide a wide 
spectrum of services. To accommodate this and maintain seamless wireless access, the user devices will 
become smarter than ever and capable of sensing the surrounding environment and seizing available 
wireless resource whenever needed. In this project, we investigate distributed coding for such dynamic 
wireless networks. The goal is to provide space diversity through user cooperation without the need of 
multiple antennas. In the third year of this project, we consider the situation where a relay or cooperating 
terminals have correlated information which they want to convey to the destination. For a terminal in this 
situation to minimize its transmission bandwidth, this is a source coding problem with side information 
(the correlated signals from the other terminals) only at the destination. We focus on the coding/decoding 
issue of this problem, and propose and implement a new coding structure, called residual Wyner-Ziv 
Coding. Simulation results show that this practical coding structure approaches the rate distortion bound 
and has the best performance among similar works in the world up to now. Compared with previous 
works, our coding structure can offer more design flexibility in terms of statistical distribution of the side 
information and practical code rate selection. 
 
Keywords: Cognitive radio, relay, cooperative transmission, distributed source coding, Wyner-Ziv 
coding, rate distortion, LDPC, LDGM, simultaneously good for source and channel code.
2I. INTRODUCTION
The next generation wireless networks will integrate several application scenarios and provide a wide
spectrum of services. In order to support seamless wireless access for data-rate hungry applications such as
multimedia and gaming, the communication bandwidth will be very wide, and the area spectral efficiency
will have to be highly increased. To accommodate these needs, the computation of wireless networks
will become more and more distributed, and moving from infrastructure toward terminals/devices. The
end-user devices will become smarter than ever and capable of inspecting the surrounding environment
and seizing enough wireless resource whenever needed. In addition, in order to be highly portable, the
end-users devices will have to be small in size, with low power consumption, and utilizing most globally
available spectra. Hassle free upgrade for the end-users is also an important feature. Thus, the new devices
should be backward compatible to the existing popular wireless services (such as the wireless local area
networks (WLAN)), and a new multiple access mechanism has to be defined for these new devices.
There are two recent developments in communication theory that might help to achieve the aforemen-
tioned new user device requirements. One is dynamic resource allocation based on Shannon’s water-filling
concept. This helps the user devices seize as much useful wireless resource (e.g., spectrum) as possible.
In order to accomplish a good resource allocation, the devices first need to be environment-aware and able
to accurately sense and understand the surrounding environment. This calls for an intelligent, or cognitive
radio (CR) device [1]. The resource allocation mechanism will be network-wide, but possibly distributed
to the individual devices (namely, autonomous) to achieve good spectrum pooling [2].
The other helpful concept is diversity which appears in many forms. It can help lower the power
consumption for a given performance requirement. Frequency and time diversities in general can be
obtained through good channel coding and modulation design, as well as good resource allocation. Space
diversity needs the deployment of multiple antennas which the new small-size devices may not afford.
Fortunately, as the new wireless networks will be packed densely in space to achieve high frequency
reuse and low power consumption, the end-user devices will likely find many other user devices placed
nearby. In this scenario, the user devices can help relay each other’s data to obtain space diversity through
cooperation [3] [4] [5] [6]. The channel coding and modulation design for this scenario will be distributed
as opposed to the conventional space-time coding for which the multiple coded data streams are generated
and emitted from the same user on its different antennas.
In this project, we investigate issues pertaining to cognitive-cooperative multiple access (C2MA), and
propose solutions to facilitate it. In the third year, we consider the situation where a relay or cooperating
terminals have correlated information which they want to convey to the destination. For a terminal in this
situation to minimize its transmission bandwidth, this is a source coding problem with side information
(the correlated signals from the other terminals) only at the destination. We focus on the coding/decoding
issue of this problem, and propose and implement a new coding structure, called residual Wyner-Ziv
Coding. Simulation results show that this practical coding structure approaches the rate distortion bound
and has the best performance among similar works in the world up to now. Compared with previous
works, our coding structure can offer more design flexibility in terms of statistical distribution of the side
information and practical code rate selection.
II. DISTRIBUTED SOURCE CODING
Without loss of generality, we consider the two-terminal case (Fig. 1). In this model, the two terminals
have correlated data to be sent to the base station. If one of the terminals knows exactly what the other
terminal sends to the base station, it can remove the redundancy (i.e., the portion of data already sent
by the other terminal) from its transmission to minimize the bandwidth it needs to transmit to the base
station. However, this approach requires the terminals to be powerful and capable of listening to what
the other terminals are sending. For practical half-duplex consideration, a terminal can only send after
listening. Thus the usage of the channel is not efficient. Instead, we will assume that the two terminals
encode and transmit independently. Consider that terminal 2 sends to the base station without considering
4Fig. 2. [14] coding structure : TCQ + SWC
Another group utilized trellis-based or turbo-based quantization and coset construction to deal this
problem [17], [18]. However, their performance is not very good.
B. Summary of contributions
Instead of building nested codebooks as in [11], we use a new coding structure in [19], where two
codebooks without a nested structure are used in a two-stage serial quantization process. The encoder first
quantizes the source once, and then it uses the other codebook to quantize the quantization error of the
first stage. The quantization index of the second stage is then sent to the decoder. We name the coding
in [19] as residual WZC, which reflects some resemblances of our coding structure to the residual vector
quantizer [20, Sec 12.11] for source coding without side information. In a theoretical random coding
setting, the residual WZC is proved to be rate distortion bound achieving for both noisy and noiseless
cases.
In this work, we show that using graph-based codes, the theoretically-optimal residual WZC in [19]
can be practically implemented. The implementation of the theoretical residual WZC in practice is not
trivial.
The codebook of the first stage quantizer acts as a channel code in our decoder, and must be simultane-
ously good for Source and Channel coding (SSC). Although the LDPC is proved to be SSC theoretically
[21], the edge degree design and practical quantization algorithm for SSC LDPC are still unknown. We
modify the recently proposed reinforced belief propagation (RBP) algorithm [22] such that the LDPC,
whose edge degree is originally optimized for channel coding, is good for source coding.
The codebook of the second stage for our residual WZC is chosen as a low-density generator matrix
code (LDGM). We also apply the RBP algorithm to LDGM, which is much simpler than the well-known
hard-decimation-based algorithm [23] for LDGM, and reduce the overall WZC complexity significantly.
The non-ideal practical quantizers at the encoder make the channel decoder operate in a rate regime
above capacity. We propose a method which can increase the equivalent signal-to-noise ratio (SNR) at
the channel decoder to solve this problem.
Compare to the previous best know results [14]. Our residual WZC can approach the Wyner-Ziv bound
for all rate regimes when the side information is arbitrarily distributed. Moreover, our coding scheme
can extend to noisy QG-SCSI problems. For practical implementation, we can operate on more flexible
code rate. By using the loss to the Wyner-Ziv bound as the performance metric for the simulation, our
6Fig. 4. Noiseless QG-SCSI system model
when PV > D. When PV ≤ D, RWZ(D) = 0 and we will neglect this trivial case in the following.
Then, we introduce some definitions and a lemma.
Definition 1: Given a vector x= (x1, . . . ,xn)T and a predetermined value A, the modulo A operation is
defined as
x mod A= (x1−QA(x1), . . . ,xn−QA(xn))T ,
where QA(xi) is the nearest multiple of A to xi, ∀i.
For example, 2 mod 3= (2−3) =−1. This definition is different from the GF(q) operation.
Definition 2: (mod-A distance) The mod-A distance between two vectors a = (a1, . . . ,an)T and b =
(b1, . . . ,bn)T is
||b−a||2A ≡
n
∑
i=1
[(bi−ai) mod A]2.
Lemma 1: (crypto lemma) LetUn be a n×1 random vector uniformly distributed over Ω= [−A2 , A2 ]n. For
any random vector Un ∈Ω and Un is statistically independent of Xn, we have that the sum Y n = (Xn+Un)
mod A is uniformly distributed over Ω, and Y n is statistically independent of Xn.
A. Residual Wyner-Ziv coding structure
The residual Wyner-Ziv coding structure is shown in Fig. 5. The main spirit of the residual WZC
structure is that at the encoder part we get codeword c1 and c2 from quantizer C1 and C2, but we only
send out codeword index of c2 to the decoder part. Due to the help of the side information at the decoder,
we can reconstruct c1 from the channel decoder C1 at the decoder part. In summary, with the help of the
side information at the decoder, the encoder part can send out fewer bits to the decoder. However, the
decoder part can reconstruct the codeword c1 and c2 at the encoder part. Now, we go into more details
in the following.
Encoder part:
The first component of the encoder part is the uniform source generator. The input of the residual
quantization part in Fig. 5 is
(αx+d) mod A,
where α is a scaling factor which will be determined later, d is a randomly generated dither signal known
both at the encoder and the decoder, and A is called as the modulo size. The entries of dither are uniformly
distributed in the interval [−A2 , A2 ]. According to Crypto Lemma in Lemma 1, (αx+d) mod A is uniform
8Gaussian source. From information theory, the rate distortion bound of the Gaussian source quantization
is
R(D) =
1
2
log(
σ2
D
), (9)
where σ2 is the variance of the source (e1 here) and D is the variance of the quantization error variance
(e2 here). If we choose
α= 1− D
PV
, (10)
then the rate of R2 is
R2 =
1
2
log(
αD+α2PV
αD
) =
1
2
log(
D+αPV
D
) =
1
2
log(
PV
D
),
which is the code rate of RX |Y (D). If at the same time the final MSE distortion is D, then we can claim
the WZC bound is achieved.
Decoder part:
The main purpose of the decoder part is to reconstruct the difference, vˆ, between the source and the
side information.
The first component of the decoder part can be considered as an equivalent channel. The decoder
receives the index representing c2 and the side information y. As in Fig. 5, the decoder computes w as
w= (c2−αy−d) mod A (11)
= (c2−d−αx+αv) mod A (12)
= (c2+αv− (αx+d) mod A) mod A (13)
= (c2+αv− (−c1+ c2+ e2) mod A) mod A (14)
= (c1+αv− e2) mod A, (15)
which can be considered as an equivalent channel. Regard w as an equivalent channel observation, c1 as
an equivalent channel input, and αv− e2 as an equivalent channel noise. Therefore channel decode c1
from w.
It is worth noting that if the channel noise, αv−e2, is dependent on the channel input, c1, it will greatly
degrade the performance of the existing-capacity-achieving channel decoder. However, if we use dither d
here, by Lemma 1, we can ensure that c1 is independent of v. Since the uniform source generator part
generates a whole new source (independent of the original source x) to the residual quantization part,
the codeword c1 is independent to the original source x = y+ v. Moreover, it is reasonable that c1 is
independent of e2. From information theory, the quantization error is independent of the codeword. In our
case, e1 is independent of c1. Since e2 is the quantization error of e1, there is no dependency between e2
and c1.
By denoting the channel decoder output as cˆ1, we can compute vˆ, the reconstruction of v, as
vˆ= (w− cˆ1) mod A (16)
= (w− c1) mod A (17)
= (αv− e2) mod A, (18)
where (17) holds for correct decoding of c1. Last, the reconstruction xˆ is
xˆ= y+ vˆ.
We now calculate the final distortion. Same as before, for the ease of the explanation, we neglect the
mod A operation temporarily. We know that x− xˆ = v− vˆ and α = 1− DPV , same as equation (10). The
10
codeword, c2, is dependent on the first stage quantization error e1, and has no dependence on the random
dither d. For E2 and U , the reason is same as U2 and U .
For the 1st stage quantizer, we require the 1st stage quantizer to be a perfect quantizer. From the rate
distortion theory, we have the code rate constraint for R1:
R1 ≥ I((αX+U) mod A;−U1) (29)
= h((αX+U) mod A)−h((αX+U) mod A|−U1) (30)
= logA−h((αX+U) mod A|−U1) (31)
= logA−h((−U1+U2+E2) mod A|−U1) (32)
= logA−h((U2+E2) mod A|−U1) (33)
= logA−h((U2+E2) mod A) (34)
= logA− 1
2
log(2pie(α2PV +αD))+
1
2
log(2pie(α2PV +αD))−h((U2+E2) mod A) (35)
= logA− 1
2
log(2pie(α2PV +αD))+
1
2
log(2pie(α2PV +αD))−h(E1 mod A) (36)
= logA− 1
2
log(2pie(α2PV +αD))+ ε1 (37)
= logA− 1
2
log(2pie(αPV ))+ ε1 (38)
For equation (31), by Lemma 1, (αX+U) mod A is uniform in the interval [−A2 , A2 ]. Equation (32) is
due to equation (28). Equation (34) is due to the independence. It is also reasonable for the practical case,
from the second stage quantizer’s operation, (c2+ e2) mod A = e1, which is the quantization error, and
independent of the codeword, −c1. Equation (35), we introduce a Gaussian differential entropy term. The
reason is a follows. Suppose we deal with an infinite modulo size case. We do not need to consider the
mod-A operation. α2PV +αD is the variance of U2+E2. The term ε1 represents the difference between
the infinite modulo size and finite modulo size.
ε1 =
1
2
log(2pie(α2PV +αD))−h(E1 mod A) (39)
=
1
2
log(2pie(αPV )−h(E1 mod A) (40)
Note that when the modulo size approaches infinity, ε1 might approaches to zero. Equation (38) is due
to α= 1− DPV .
For the 2nd stage quantizer, we require the 2nd stage quantizer to be a perfect quantizer. From the rate
12
(24). Finally, in equation (61), we define the difference between the infinite modulo size and the finite
modulo size as
ε3 =
1
2
log(2pie(αPV ))−h((αV −E2) mod A) (62)
Again, note that when the modulo size approaches infinity, ε3 might approach to zero.
Let us compare ε1 in (40) and ε3 in (62). Indeed, these two terms are the same. We can consider
(αV −E2) in ε3 as a new Gaussian random variable ∼ N(0,α2PV +αD), which is the same as the second
term of ε1.
Until now, we have derived the code rate of each component for our residual WZC scheme. The result
is the same as equation (25) and (26). We find out again that the component code C1 must be a SSC
code. In the following part, we will discuss some practical implementation issues.
IV. PRACTICAL IMPLEMENTATION ISSUES
In Section IV-A, we will discuss how to choose a reasonable modulo size for our residual WZC. In
Section IV-B, we will discuss the impacts of non-perfect of component codes. In Section IV-C, we will
discuss how to implement such SSC code. Before our work, there was no implementation of such code.
A. Infinite modulo size problem
Let us revisit the result of Section III-B. To achieve the Wyner-Ziv bound, the modulo size A should
approaches to infinity. However, at the same time, the code rate R1 will also becomes infinite from (25).
The approach to solve this problem is as follows.
First, observe ε1 in (40) and ε2 in (51). We want these two terms to be as small as possible. In fact,
we only need to consider ε1, since ε1 is always larger than ε2. Note that these two terms describe the
difference between the finite modulo size and infinite modulo size. Because ε1 reflects a larger variance
of Gaussian, ε1 is always larger than ε2. Now, our problem turns out into
ε2 < ε1 =
1
2
log(2pie(αPV ))−h(E1 mod A). (63)
Note that E1 ∼ N(0,αPV ).
Now, we want to calculate h(E1 mod A).
h(E1 mod A) =−
∫
x∈[−A2 ,A2 )
fE1(x) log fE1(x)dx, (64)
and
fE1(x) = ∑
n∈Z
fG,αPV (x+nA). (65)
Note that fG,αPV (x) represents Gaussian probability density function (pdf) with variance αPV . (65) reflects
the mod operation. When the realization is done over the modulo size, its pdf can be calculated through
the other summand term. With above formulas, we can calculate ε1 numerically. We can therefore choose
A to make ε1 and ε2 smaller than a threshold ε.
In the following, we use the modulo size Aε to represent the sufficient large modulo size such that we
can essentially neglect ε1 and ε2 in (25) and (26). For example, see Fig 6. In this case, PV = 0.28 and
α= 0.4612. Empirically, we choose ε= 0.005 as the threshold. From this figure, we know that when the
modulo size equals 2.97, ε1 << ε. So, choose the modulo size equals 2.97 is large enough.
14
modulation (PAM) as the constellation of C1, and the equivalent SNR of the channel (15) with A= Aε is
SNRε =
A2ε/k
σ2eo′ +α2PV
, (67)
where k is a constant related to the order of the PAM constellation. If we increase the modulo size from
Aε to Ap with rates R1 and R2 unchanged, the quantization error variance of e2 will become
σ2ep = (Ap/Aε)
2σ2eo′, (68)
since the variance of C1’s input, which is uniformly-distributed input, increases from A2ε/12 to A
2
p/12.
Then the equivalent SNR becomes
SNRp =
A2p/k
σ2ep+α2PV
=
A2ε/k
σ2eo′ +(
Aε
Ap
)2α2PV
,
which is larger than SNRε in (67) since Ap > Aε.
How large should the modulo size be? To answer this question, we should take into account the effects
on the channel decoder due to the increment of the modulo size. When the PAM constellation of C1 is
chosen according to Ap instead of Aε, the signal power of codeword c1 is scaled by (Ap/Aε)2. Thus now
the maximum tolerable equivalent noise variance σ2dp for the practical channel coding can be estimated
by
σ2dp = (Ap/Aε)
2σ2do′. (69)
Now we wish σ2dp ≥ σ2ep+α2PV to ensure the practical channel decoding in (15) being successful. Using
this criteria with (68) and (69), the practical modulo size Ap must meet,
Ap ≥ Aε
√√√√( α2PV
σ2do′−σ2eo′
)
. (70)
σ2do′ and σ
2
eo′ can be obtained via the numerical simulations.
Although increasing the modulo size can solve the channel decoding beyond capacity problem, there
will be a loss in the final distortion compared with the theoretically predicted D using R2 in (3) owing
to the increment of the quantization error variance of e2 from (21). Same as the calculation of (21), the
new distortion Dp is
Dp = σ2eo′
(
Ap
Aε
)2
+(1−α)2PV . (71)
Compared to the theoretical distortion Do, the additional distortion is
Dp−Do = σ2eo′
(
Ap
Aε
)2
−σ2eo. (72)
In summary, when we have designed each component code, we can get σ2eo′ and σ
2
do′ . From these two
parameters, we can determine how large the practical modulo size Ap should be. Besides, we can judge
whether the component code is well designed through (72). If we use bad component code, the practical
modulo size Ap would be very large, which inevitably increases the final distortion loss.
16
Fig. 7. Graph-based code implementation of residual Wyner-Ziv coding
chart fitting approach in [29] to obtain an LDPC good for the channel coding. There is one more thing
to be emphasized. From section III-B, we know that codebook C1 should be uniformly distributed. For
practical implementation, we can choose constellation points equally partitioned the modulo interval.
For the quantization alphabet of the LDGM code in step 4, we should use Gaussian distributed codebook
from the implication of Section III-B. However, in practical implementation, the quantization alphabet
of the LDGM is uniformly spaced with variance α2PV . To achieve Gaussian distributed codebook, we
require infinite alphabets, but in practical situations we can only use finite alphabets. To preserve some
statistical properties, we require the variance and mean to be the same. In fact, the quantization alphabet
has minor effects on the quantization results compared with the edge degree design and the quantization
algorithm. The edge degree of LDGM is obtained similarly as in [23] with the design method named
Extended BP (EBP) curve.
In step 5, we increase the modulo size to solve the channel decoding beyond capacity problem described
in Section IV-B.
B. Simultaneously good for source and channel code design: low density parity check (LDPC) code
1) Degree distribution design and m-ary LDPC code: In this section, we first explain the relationship
between the loss and the number of quantization alphabets (constellation points) we can use. Since we
design LDPC code as a SSC code, the phrase “quantization alphabet” and “constellation points” share the
same meaning in this section. If we can use m quantization alphabets, we say we use a m-ary code. If we
use 2-ary code, it means that we can use 2 quantization alphabets. For uniform source in interval [−A2 , A2 ],
it is natural for us to choose −A4 and A4 . If we use 4-ary code, we can use 4 quantization alphabets. For
18
0 0.2 0.4 0.6 0.8 1
0
0.5
1
1.5
R (b/s)
R
an
do
m
 c
od
in
g 
lo
ss
 (d
B)
Fig. 8. Random coding loss of 2-ary quantization code
mutual information refers to the LLR and the transmitted bit. In the theory of EXIT chart fitting [31], to
achieve the channel capacity, we need to adjust the edge degree such that the area between the two EXIT
curves as small as possible. Moreover, these two curves can only cross as the mutual information equals
1. For example, see Fig. 10.
EXIT curve of variable node (VND):
IE,VND(IA,VND, IE,DET ,dv) = J
(√
(dv−1) [J−1(IA,VND)]2+[J−1(IE,DET )]2
)
(77)
This equation is quoted form equation (22) of [29]. We can regard IE,VND as the output mutual information
of the VND, and IA,VND as the input mutual information of the VND. dv is the degree of the VND. The
calculation of J-function can be found in the appendix of [29]. IE,DET is the mutual information comes
from the detector. We can also refer it as
IE,DET = I(c;LLR) = I(c;y) = R (78)
for 2-ary case. Where R is the channel capacity (code rate), c refers to the transmitted bit, and y is the
channel observation. This equation holds due to the channel coding theory.
EXIT curve of check node (CND):
IE,CND(IA,CND,dc) = 1− J
(√
dc−1 · J−1(1− IA,CND)
)
(79)
This equation is quoted from equation (9) of [29]. We can regard IE,CND as the output mutual information
of the CND, and IA,CND as the input mutual information of the CND. dc is the degree of the CND.
In our design, we can fix the degree of CND at the beginning, and tune VND’s degree such that the
two EXIT curves can be as close as possible but cross only as the mutual information equals one. Let N
be the number of different VND degrees, and denote theses degrees by dv,i, i = 1, · · · ,N. Let ai be the
fraction of nodes having degree dv,i, bi be the fraction of edges incident to VNDs of degree dv,i, and n
be the total number of VNDs. Then
bi =
naidv,i
n∑Ni=1 ai ·dv,i
, (80)
20
0 0.2 0.4 0.6 0.8 1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
IA,VND, IE,CND
I E
,V
N
D
,
 
I A
,C
ND
Fig. 10. EXIT chart only cross when the mutual information equals 1
the fitting would always fail, because there is a small gap between BP and ML decoding [32]. We can
increase IE,DET a little. In this design example, we increase to IE,DET ∼ 0.7. The VND degree profile:
35.364% of degree 2, 44.742% of degree 3, and 19.894% of degree 9.
Fig. 11. 4-ary code detector part [23]
Now we discuss the 4-ary code design. Other higher quantization alphabets case can be coped with the
22
Now, we introduce the practical message passing algorithm for our mod-A distance case.
a priori probability calculation:
fui|c1, i = ∑
n∈Z
fG,σ2(ui− c1,i+Aεn) (88)
We let ui be the ith element of C1’s input (uniform), and c1,i be the ith coded symbol of codeword c1.
fG,σ2(x) is the PDF of N(0,σ2), and Z is the integer set. To reflect the modulo Aε operation, we use the
above conditional probability density function (PDF) to calculate the a priori probability.
Let us see an example to see the relationship with this PDF and mod-A distance. Suppose now the
source is uniform in [−1,1], and we use 2-ary code with quantization alphabets −0.5, 0.5. Consider a
source symbol is 0.9. From the definition of mod-A distance, we know the distance between 0.9 and 0.5
is 0.4, and the distance between 0.9 and −0.5 is 0.6. And this 0.6 distance can be included in when n= 1
in the equation (88).
Gray mapping function node operation:
After the calculation of equation (88), we want to transform the probability to the LLR of each codeword
bit. If we adopt 2-ary code, we can directly calculate the LLR. However, if we adopt 4-ary (or higher)
code, we need one more step to deal with the Gray-mapping. The Gray mapping function, φ(c1c0), is
φ(00) =−3A, φ(10) =−A, φ(11) = A, φ(01) = 3A (89)
Then we can calculate the probability of each bit as
p(c1 = 0) ∝ p(u=−3A)p(c0 = 0)+ p(u= 3A)p(c0 = 1) (90)
p(c1 = 1) ∝ p(u=−A)p(c0 = 0)+ p(u= A)p(c0 = 1) (91)
p(c0 = 0) ∝ p(u=−3A)p(c1 = 0)+ p(u=−A)p(c1 = 1) (92)
p(c0 = 1) ∝ p(u= A)p(c1 = 1)+ p(u= 3A)p(c1 = 0) (93)
This formula can obtained from the sum product algorithm [40] or equation (111) of [23]. The p(u) can
be calculate by equation (88). The p(c0) and p(c1) would change during BP iterations. This formulation
can be extended to other 2m-ary code.
BP VND operation:
Lnmar =∑Li,in (94)
Li,out = Lnmar−Li,in (95)
Lnmar represents the marginal LLR at present iteration. ∑Li,in represents the sum over the LLR connected
to the VND. Li,out represents the output LLR to the edge i. Li,in represents the input LLR from the edge
i.
RBP VND operation:
Lnmar = γ(n)L
n−1
mar +∑Li,in (96)
Li,out = Lnmar−Li,in (97)
Lnmar represents the marginal LLR at present iteration. L
n−1
mar represents the marginal LLR at previous
iteration. γ(n) = 1− γ0γn1, where γ0 and γ1 are in [0,1]. ∑Li,in represents the sum over the LLR connected
to the VND. Li,out represents the output LLR to the edge i. Li,in represents the input LLR from the edge
i. The difference between RBP and BP is the consideration of previous marginal LLR.
BP & RBP CND operation:
Li,out = ln
1−∏ j ̸=i 1−e
L j,in
1+eL j,in
1+∏ j ̸=i 1−e
L j,in
1+eL j,in
(98)
24
TABLE II
LDPC CHANNEL DECODING ALGORITHM USING BP
Initialization
Let all the LLR equal to 0
for i=1:n, {source→ f unction node}
Calculate the a priori probability (88)
end
Iteration
While round < Maxiteration
for i=1:n, { f unction node→VND}
Do the gray mapping operation as (90),(91),(92) and (93)
end
for i=1:(m ·n), {VND→CND}
Do the ‘BP VND operation’
Calculate the extrinsic LLR and marginal LLR as (94) and (95)
end
for i=1:k, {CND→VND}
Do the ‘BP & RBP CND operation’
Calculate the extrinsic LLR as (98)
end
for i=1:(m ·n), {VND→ f unction node}
Do the ‘BP VND operation’
Output the extrinsic LLR as (94) and (95)
end
If all the CND and VND constraints are satisfied,
Break off the iteration
End
simulation result shows the practical quantization error variance is 0.1340. The loss is about 0.162 dB.
Refer to Fig. 9. We can find out that for 4-ary code quantizer, the random coding loss can be nearly 0
dB. Note that the tuning of the value of γ1 is still required.
3) LDPC code as a channel decoder: We have equipped the knowledge of BP in Section V-B2.
We present the LDPC channel decoding algorithm in table II. Suppose we use 2m-ary LDPC code. There
will be (m ·n) VND, k CND, and n channel observation.
Design example of 2-ary LDPC:
Now, we consider a R = 0.68 b/s 2-ary LDPC quantizer. We use the degree distribution obtained in
section V-B1. From the channel coding theory, the maximum tolerable noise variance is 0.2625. We use
the channel decoding algorithm presented in table II to do the simulation. For practical simulation, we set
the maximum iteration time as 1000. Our simulation result shows the practical maximum tolerable noise
variance is 0.2345. The loss is about 0.49 dB. At a first glance, it seems a bad result. However, see the
Fig. 8. We can find out that for 2-ary code channel code, there is an inevitably random coding loss about
0.35 dB. In fact, our design is about 0.15 dB away from the 2-ary code’s limit.
Design example of 4-ary LDPC:
Now, we consider a R= 1 b/s 2-ary LDPC quantizer. We use the degree distribution obtained in section
V-B1. From the channel coding theory, the maximum tolerable noise variance is 0.1291. We use the
26
Icb means the non-erased probability after CND’s operation. Ic means the non-erased probability from the
channel observation. This value can be obtained from equation (78). [23] turns the source quantization
problem into channel decoding problem. Ibc means the non-erased probability from VND’s output. vcd is
the edge fraction of c-node with degree d. Due to CND’s BP rule in equation (98), to output non-erased
probability, we should require all the connected d−1 edges to be non-erased.
VND’s operation in Fig. 12:
I+bc = 1− (1− Ib)(1− Icb)db−1 (100)
In this optimization problem, we set all the VNDs with degree db. Moreover, the method [23] is designed
for ‘hard decimation+BP’. The term, Ib, is the fraction of VNDs that have been decimated. Icb means
the non-erased probability from CND’s output. Due to CND’s BP rule in equation (94) and (95), to
output non-erased probability, we should only exclude the case that all the connected db− 1 edges are
erased. Since we described the fixed points phenomenon, the new I+bc in equation (100) would equal to
the previous Ibc. From this equality, we can get the relationship between Ib, the fraction of decimated
VNDs and the fixed points result. It can be also found in equation (36) in [23].
Fraction of non-erased VND in Fig. 12:
Ib,ext = 1− (1− Icb)db (101)
At fixed points situation, the fraction of non-erased VND can be determined by this equation. Simply
speaking, we exclude the case that all the connected db edges are erased.
We can regard Ib as the input (x-axis), the fixed point result Ib,ext as the output (y-axis). We call this curve
as extended BP (EBP) curve, which generalizes the original EXIT curve. To let ‘hard decimation+BP’ con-
verge, [23] points out the degree distribution should let the EBP curve satisfy the following monotonicity
condition:
Ib|Ibc=0 ≥ 0, (102)
dIb
dIbc
≥ 0, Ibc ∈ [0,1], (103)
For condition (102), the relation between Ibc = 0 and Ib can be obtained by equation (100). This condition
is reasonable concerning the physical meaning of Ib. It is unreasonable for Ib < 0. The condition (103)
describes the relationship between Ib and Ibc. We can imagine that with the increment of the non-erased
probability, Ibc, we hope the reason is due to the increment of Ib. In practical operations, we determine
Ib first, and observe the fixed points result. Now, this condition requires the relationship between Ib and
Ibc to be one to one mapping.
With the monotonicity condition, [23] observes that the conditions are more easily satisfied for smaller
Ic. [23] defines the maximum Ic as Ithrc . The optimal degree distribution can be obtained by maximizing I
thr
c
under the monotonicity condition. The optimization problem can be found in equation (40)∼ (44) in [23].
Design example of 2-ary LDGM:
We design a 2-ary LDGM code with code rate R = 0.4461 b/s for block length 100000. There are
100000 CNDs and 44610 VNDs. For the optimization problem, we can use the function ‘fmincon’ in
MATLAB. Fix all the VND’s degree to 10, and adjust CND’s degree. The empirical degree, equation (45)
of [23], for CND is adopted. Our simulation result shows Ithrc = 0.4437, which is near to the theoretical
limit 0.4461. The CND degree distribution is in table III.
Now, we discuss the more general 2K-ary LDGM code design. Same as before, let us see the factor
graph, Fig 13, first. We assume the CND connected to the same u-node has the same degree. This
assumption lowers the complexity of design. The difference between 2-ary case and 2K-ary case is the
Gray-mapping function node. In 2-ary case, we can consider Ic by equation (78)
28
TABLE IV
8-ARY LDGM, R= 2 B/S, CND DEGREE
degree 2 3 4 5 6 7 8 9 10
number 181458 48408 20631 12729 6606 5658 4086 2766 2388
degree 11 13 15 17 19 21 24 27 30
number 1944 1947 3036 1518 861 45 630 1041 969
degree 33 37 41 63 70 77
number 879 558 72 459 732 579
TABLE V
LDGM QUANTIZATION ALGORITHM USING RBP
Initialization
Let all the LLR equal to 0
for i=1:n, {source→ f unction node}
Calculate the a priori probability (88)
end
Iteration
While round < Maxiteration
for i=1:n, { f unction node→CND}
Do the gray mapping operation as (90),(91),(92) and (93)
end
for i=1:(m ·n), {CND→VND}
Do the ‘BP & RBP CND operation’
Calculate the extrinsic LLR as (98)
end
for i=1:k, {VND→CND}
Do the ‘RBP VND operation’
Calculate the extrinsic LLR as (96) and (97)
end
for i=1:(m ·n), {CND→ f unction node}
Do the ‘BP & RBP CND operation’
Output the extrinsic LLR as (98)
end
End
[23], for CND is adopted. Note Ic,k′=0 = 0.6631, Ic,k′=1 = 0.6667, and Ic,k′=2 = 0.6702. Summing up these
three terms by chain rule, we can get the target code rate 2 b/s. Our simulation result shows Ithrc = 0.6649,
which is near to the theoretical limit 0.6667. The result is shown in table IV.
2) Quantization algorithm: Now, let us see the quantization algorithm of our LDGM quantizer. We
present it in the table V. Suppose we use 2m-ary LDGM code. There will be (m ·n) CND, k VND, and
n source sample.
Design example of 2-ary LDGM:
Now, we consider a R= 0.4461 b/s 2-ary LDGM quantizer. We use the degree distribution obtained in
section V-C1. The source is distributed as ∼ N(0,0.1345). The rate distortion bound quantization error
30
where βe is a real number. X is the original source. This equation describes the relationship between
the source and the noisy encoder observation, and can be also viewed as this way
X = fX(YD)+βeYE +N, (107)
where E[N|YD,YE ] = 0.
3) The rate distortion bound for this model is
RNWZ(D) =
1
2
log
β2eσ2YE |YD
D−EYEYD[σ2X |YE ,YD]
, (108)
where D is the final MSE distortion. EYEYD[σ2X |YE ,YD] means the variance of the source conditional
on YD and YE , and it can be also viewed as the MSE of N conditional on YD and YE .
Fig. 15. Residual Wyner-Ziv coding for noisy QG-SCSI
Our residual WZC for noisy QG-SCSI is in Fig. 15. How to adjust our noiseless residual WZC to
handle the noisy QG-SCSI? Let us rewrite equation (108) in the following,
RNWZ(D) =
1
2
log
σ2YE |YD
D−EYEYD [σ2X |YE ,YD ]
β2e
=
1
2
log
σ2YE |YD
D′
=
1
2
log
ασ2YE |YD
αD′
, (109)
where we let D′ =
D−EYEYD [σ2X |YE ,YD ]
β2e
. The last equation looks like the formulation of noiseless case. The
second stage quantizer faces Gaussian source with variance ασ2YE |YD (αPV for noiseless case) and the target
distortion MSE is αD′ (αD for noiseless case). Since α= 1− DPV in noiseless model, we let
α= 1− D
′
σ2YE |YD
(110)
32
about 0.28 dB away the rate distortion bound. At the same time, a SSC LDPC is obtained with
0.25 dB away the channel capacity and 0.162 dB away the rate distortion bound.
5) To solve the channel decoding beyond capacity problem in Section IV-B, we can increase the modulo
size. By equation (70), Ap = 3.3208. Empirically, we add a little more. We choose Ap = 3.33 to
do the simulation. We test 2000 source blocks. The final distortion is about 0.64 dB away the
Wyner-Ziv bound.
Design example of noisy QG-SCSI :
The coding scheme can refer to Fig. 14. Same as previous design example, we deal with two kinds of
distribution for the decoder side information yd, and get the nearly same result. The first kind is Gaussian
side information and the second kind is uniformly distributed side information. In fact, with the help of
the dither signal d, our residual WZC can deal with arbitrary side information as long as the difference
NED is still an i.i.d. Gaussian with same variance σ2YE |YD .
We consider a noisy QG-SCSI as following:
YE = YD+NED (118)
X = YE +NE (119)
NED ∼ N(0,σ2YE |YD) (120)
N ∼ N(0,σ2NE ) (121)
In order to compare with the result of [14], we set σ2YE |YD = 0.28. Moreover, we set σ
2
NE = 0.28. Now, we
follow the design flow in Section V-A. In the following simulation, we set the block length n= 105.
1) Given target MSE, D = 0.2975, σ2YE |YD = 0.28, and σ
2
NE = 0.28. From equation (116), R2 = 2 b/s.
α= 0.9375 from equation (110).
2) Find a large enough modulo size A. When Aε = 3.3924, ε1 < 0.004 in (40) is small enough and
can be neglected. Choosing A= Aε, by equation (115), we get R1 = 0.68 b/s. At the same time, we
solve the infinite modulo size problem in Section IV-A.
3) Design a SSC LDPC with code rate 0.68 b/s according to Section V-B1. For the practical tolerable
noise variance, we can refer to Section V-B3. The simulation results shows σ2do′ = 0.2345, about
0.49 dB away the channel capacity.
4) Design a LDGM with code rate 2 b/s according to Section V-C1. For the practical quantization
error variance, we can refer to Section V-B2 and V-C2. The simulation results shows σ2eo′ = 0.0193,
about 0.7 dB away the rate distortion bound. At the same time, a SSC LDPC is obtained with 0.49
dB away the channel capacity and 0.44 dB away the rate distortion bound.
5) To solve the channel decoding beyond capacity problem in Section IV-B, we can increase the modulo
size. By equation (117), Ap = 3.6277. Empirically, we add a little more. We choose Ap = 3.64 to
do the simulation. We test 2000 source blocks. The final distortion is about 0.166 dB away the
Wyner-Ziv bound.
Comparing our simulation result to [14], our performance is much better. In fact, our performance is the
best in the literature. Since [14] can only achieve the rate distortion bound at high rate region theoretically,
the low rate region simulation result is poor. [14] shows 0.35 dB, 0.42 dB, and 1.07 dB loss at 3.86 b/s,
1.55 b/s, and 1.07 b/s. The lower the code rate the larger the loss. For high rate region comparison, our
residual WZC possesses 0.166 dB loss, which is better than 0.35 dB at 3.86 b/s. Moreover, in practical
implementation, our coding scheme can deal with arbitrary side information due to the help of the dither
signal. [14] need to change the design once the decoder side information’s distribution changes. Last, our
residual WZC can practically operate on more flexible rate region. However, [14] can only operate on
some few code rate points.
Why does our coding scheme have higher loss at the low rate region? Our coding scheme’s loss mainly
comes from the increment of the modulo size. The additional distortion can be calculated from equation
34
[11] R. Zamir, S. Shamai, and U. Erez, “Nested linear/lattice codes for structured multiterminal binning,” IEEE Trans. Inf. Theory, vol. 48,
no. 6, pp. 1250–1276, June 2002.
[12] Y. Oohama, “The rate-distortion function for the quadratic Gaussian CEO problem,” IEEE Trans. Inf. Theory, vol. 44, pp. 1057–1070,
May 1998.
[13] S. C. Draper and G. W. Wornell, “Side information aware coding strategies for sensor networks,” IEEE J. Sel. Areas Commun., vol. 22,
no. 6, pp. 966–976, 2004.
[14] Y. Yang, S. Cheng, Z. Xiong, and W. Zhao, “Wyner-Ziv coding based on TCQ and LDPC codes,” IEEE Trans. Commun., vol. 57,
no. 2, pp. 376–387, Feb. 2009.
[15] Z. Liu, S. Cheng, A. D. Liveris, and Z. Xiong, “Slepian-Wolf coded nested lattice quantization for Wyner-Ziv coding: High-rate
performance analysis and code design,” IEEE Trans. Inf. Theory, vol. 52, no. 10, pp. 4358–4379, Oct. 2006.
[16] M. W. Marcellin and T. R. Fischer, “Trellis coded quantization memoryless and Gauss-Markov sources,” IEEE Trans. Commun., vol. 38,
no. 1, pp. 82–93, Jan. 1990.
[17] S. Pradhan and K. Ramchandran, “Distributed source coding using syndromes (DISCUS): Design and construction,” IEEE Trans. Inf.
Theory, vol. 49, no. 3, pp. 626–643, Mar. 2003.
[18] J. Chou, S. S. Pradhan, and K. Ramchandran, “Turbo and trellis-based constructions for source coding with side information,” in Proc.
IEEE Data Compression Conf.(DCC), 2003.
[19] S.-J. Lin, S.-C. Lin, K.-S. Chen, and H.-J. Su, “Coding for noisy quadratic-Gaussian Wyner-Ziv problem: A successive quantization
approach,” in IEEE Information Theory Workshop, 2009.
[20] A. Gersho and R. M. Gray, Vector quantization and signal compression. Kluwer Academic Fublishers, 1992.
[21] V. Chandar, “Sparse graph codes for compression, sensing, and secrecy,” Ph.D. dissertation, Massachusetts Institute of Technology,
2010.
[22] A. Braunstein, F. Kayhan, and R. Zecchina, “Efficient LDPC codes over GF(q) for lossy data compression,” ver.2, Oct. 2011.
[Online]. Available: http://arxiv.org/abs/0901.4467v2
[23] Q. Wang and C. He, “Design and analysis of LDGM-based codes for MSE quantization,” Jan. 2008. [Online]. Available:
http://arxiv.org/abs/0801.2423
[24] T. Cover and J. Thomas, Elements of Information Theory. New York: Wiley, 1991.
[25] K. S. Chen, S. C. Lin, and H. J. Su, “Low density constructions for simultaneously good for channel and source coding problem (SCS)
with application,” Master’s thesis, National Taiwan University, 2009.
[26] M. J. Wainwright and E. Martinian, “Low-density graph codes that are optimal for binning and coding with side information,” IEEE
Trans. Inf. Theory, vol. 55, no. 3, pp. 1061–1079, Mar. 2009.
[27] M. J. Wainwright, “Sparse graph codes for side information and binning,” IEEE Signal Process. Mag., vol. 24, no. 5, pp. 47–57, SEP.
2007.
[28] Q. Wang and C. He, “Practical dirty paper coding with nested binary LDGM-LDPC codes,” in Proc. ICC, 2009.
[29] S. T. Brink, G. Kramer, and A. Ashikhmin, “Design of low-density parity-check codes for modulation and detection,” IEEE Trans.
Commun., vol. 52, no. 4, pp. 670–678, Apr. 2004.
[30] Q. Wang and C. He, “Approaching 1.53-dB shaping gain with LDGM quantization codes,” in Proc. GLOBECOM, 2007.
[31] A. Ashikhmin, G. Kramer, and S. t. Brink, “Extrinsic information transfer functions: Model and erasure channel properties,” IEEE
Trans. Inf. Theory, vol. 50, no. 11, pp. 2657–2673, Nov. 2004.
[32] C. Measson, A. Montanari, and R. Urbanke;, “Maxwell construction: The hidden bridge between iterative and maximum a posteriori
decoding,” IEEE Trans. Inf. Theory, vol. 54, no. 12, pp. 5277–5307, Dec. 2008.
[33] X. Hu, E. Eleftherious, and D. M. Arnold, “Regular and irregular progressive edge-growth Tanner graph,” IEEE Trans. Inf. Theory,
vol. 51, no. 1, pp. 386–398, Jan. 2005.
[34] L. Dinoi and S. Benedetto, “Design of fast-prunable S-random interleavers,” IEEE Trans. Wireless Commun., vol. 4, no. 5, pp. 2540–
2548, SEP. 2005.
[35] T. Filler and J. Fridrich, “Binary quantization using belief propagation with decimation over factor graphs of LDGM codes,” in 45th
Annual Allerton Conf. on Comm. Control, and Comput., Monticello, IL, USA, 2007.
[36] D. J. C. MacKay, “Good error-correcting codes based on very sparse matrices,” IEEE Trans. Inf. Theory, vol. 45, no. 2, pp. 399–431,
March 1999.
[37] P. A. Regalia, “A modified belief propagation algorithm for code word quantization,” IEEE Trans. Commun., vol. 57, no. 12, pp.
3513–3517, Dec. 2009.
[38] D. Castanheira and A. Gameiro, “Lossy source coding using belief propagation and soft-decimation over LDGM codes,” IEEE 21st
International Symposium on Personal Indoor and Mobile Radio Communications, pp. 431–436, 2010.
[39] T. Murayama, “Thouless-Anderson-Palmer approach for lossy compression,” Physical Review E, vol. 69, 2004.
[40] F. Kschischang, B. Frey, and H. Loeliger, “Factor graph and the sum-product algorithm,” IEEE Trans. Inf. Theory, vol. 47, no. 2, pp.
498–519, Feb. 2001.
[41] E. Martinian and J. S. Yedidia, “Iterative quantization using codes on graphs,” 41st Annual Allerton Conference, Allerton House, UIUC,
ILLinois, USA, Aug. 2004.
[42] M. J. Wainwright, E. Maneva, and E. Martinian, “Lossy source coding compression using low-density generator matrix codes: Analysis
and algorithm,” IEEE Trans. Inf. Theory, vol. 56, no. 3, pp. 1351–1368, Mar. 2010.
[43] Q. Wang, C. He, and L. Jiang, “Near-ideal M-ary LDGM quantization with recovery,” IEEE Trans. Commun., vol. 59, no. 7, pp.
1830–1839, July 2011.
[44] D. Rebollo-Monedero and B. Girod, “A generalization of the rate-distortion function for Wyner-Ziv coding of noisy sources in the
quadratic-Gaussian case,” in Proc. IEEE Data Compression Conf.(DCC), Snowbird, UT, 2005, pp. 23–32.
 2
合作式通訊、中繼式通訊、編碼理論、以及通訊安全之演講。用於設計 LDPC 編碼的
重要方法 EXIT CHART 的發明人 ten Brink 博士亦有論文在此次會議發表。最後敝人
旁聽了 Verdu 博士的演講:在有限長度下之通道以及資訊源的編碼。這是一場非常有
趣且振奮人心的演講，其內容討論了如何放寬 Shannon 消息理論中的一個非常重要
的假設:碼長度須為無限長。雖然考慮有限長碼下許多有名的通道例如廣播通道、多
使用者進入通道、中繼式通道等的最佳傳輸速度仍未知，但是 Verdu 博士和他的學
生發展出一套工具可以分析傳輸速度上下界限的差距。他們的研究對於實際上設計
有限長度編碼有很大的影響跟貢獻。Verdu 博士是 2007 IEEE joint communications/ 
information theory 論文獎 以及 2011 IEEE information theory 論文獎的得主. 
 
二、與會心得 
藉由這次發表論文的機會，敝人可以即時的跟同領域的學者切磋討論，獲益匪淺。
除了提升外語口語表達能力，藉由跟學者們的討論可以進一步改善我們的研究.更有
甚者，藉由旁聽他人的發表以及大會的重點演講可以掌握通訊研究的趨勢並且提升
提問的能力跟技巧。而午宴更提供與其他研究人員交流的機會。 
三、考察參觀活動(無是項活動者略) 
無 
四、建議 
無 
五、攜回資料名稱及內容 
內含大會論文集的 USB 隨身碟 
 1
 
國科會補助專題研究計畫項下出席國際學術會議心得報告 
                                    日期：2012 年 4 月 16 日 
一、參加會議經過 
於四月一日晚間從台北出發，四月二日清晨六點半抵達巴黎。此行除了發表論文以
外，還肩負著宣傳我們即將在九月於台北舉辦的 WPMC 2012 研討會（本人是議程主
席），因此向 IEEE WCNC 2012 主辦單位租了一個展示空間，除了放 CFP 外，也展示
計畫編號 NSC 100－2219－E－002－011－ 
計畫名稱 無線感知式協同型網狀網路之研究-子計畫三：無線感知式協同型多工
存取之分散式編碼架構(3/3) 
出國人員
姓名 蘇炫榮 
服務機構
及職稱 台灣大學電信所 副教授 
會議時間 
 2012 年 4 月 1 
日至 2012 年 4 月
4 日 
會議地點 法國巴黎 
會議名稱 
(中文)2012 IEEE無線通訊及網路研討會 
(英文)2012 IEEE Wireless Communications and Networking Conference 
(WCNC 2012) 
發表論文
題目 
(中文)關於在多輸入多輸出衰落竊聽者通道下最佳人工雜訊輔助之安
全性傳輸 
(英文)On Optimal Artificial-Noise Assisted Secure Beamforming 
for the Multiple-Input Multiple-Output Fading Eavesdropper 
Channel 
附件四 
 3
六、其他 
 
 
 
the rate gain from the proposed scheme. We also provide the
necessary condition to have optimal covariance of AN matrix
with full rank. In Section V we demonstrate the simulation
results. Finally, Section VI concludes this paper.
II. SYSTEM MODEL
In this paper, lower and upper case bold alphabets denote
vectors and matrices, respectively. The superscript (.)H de-
notes the transpose complex conjugate. ∣A∣ and ∣a∣ represent
the determinant of the square matrix A and the absolute value
of the scalar variable a, respectively. A diagonal matrix whose
diagonal entries are a1 . . .ak is denoted by diag(a1 . . .ak). The
trace of A is denoted by tr(A). We define C(x) ≜ log(1+ x)
and (x)+ ≜ max{0, x}. The mutual information between two
random variables is denoted by I(;). In denotes the n by n
identity matrix and A ≽ 0 denotes that A is a positive semi-
definite matrix.
We consider the MISOSE system model where the trans-
mitter has nT antennas. And the received signal at Bob
(the legitimate receiver) and Eve (the eavesdropper) can be
respectively represented as
yk = hHk xk +w1,k, (1)
zk = gHk xk +w2,k, (2)
where xk ∈CnT×1, k is the time index, hk is deterministic (i.e.,
known), gk ∼CN(0,InT ), and w1,k and w2,k are circularly sym-
metric complex additive white Gaussian noises with variances
one. In this system model, we assume that the CSI of the
legitimate channel and only the statistics of Eve’s channel are
known at transmitter. From Csisza´r and Ko¨rner’s argument [1]
we know that the capacity of such a channel can be represented
by
C = max
U→X→Y ZG
I(U ;Y )− I(U ;Z∣G), (3)
where U is the auxiliary random variable, Y and Z are the
received signals at Bob and Eve, respectively, and G is the
channel gain of Eve’s channel. Note that Y , Z, and G are all
random. In the following we omit the time index to simplify
the notation. Since it is very hard to solve f (x∣u) from (3),
which is a functional, we adopt the linear channel prefixing
f (x∣u) as
x = u+v, (4)
where u ∼ CN(0,Su) and v ∼ CN(0,Sv) are independent
vectors to convey the message and AN, respectively. The
channel input power is constrained by
tr(Su +Sv)≤ PT . (5)
Substituting (1), (2), and (4) into (3), we have the secrecy rate
as
R =(
log
(
1+hH (Su +Sv)h
1+hHSvh
)
−E
[
log
(
1+gH (Su +Sv)g
1+gHSvg
)])+
.
(6)
Then the considered optimization problem is
max
Su,Sv
R (7)
s.t. tr(Su +Sv)≤ PT , Su ≽ 0, Sv ≽ 0. (8)
In the following sections, we will first prove that beam-
forming is optimal for Su and find the optimal beamformer.
Then we will generalize the AN, proposed in [9] to be in
the null space, to transmit in all directions. After that we will
show the performance gain of such prefixing and derive some
characteristics of it.
III. THE ANALYSIS OF THE PROPOSED SIGNALING
We will first prove that the optimal signaling of the
proposed transmission scheme is beamforming, then derive
the optimal beamformer. After that, we will prove that the
optimal power allocation of AN in the null space of the
legitimate channel is uniformly allocated.
Theorem 1: For the MISOSE fast faded wiretap channel
with the perfect information of the legitimate channel h, and
only the mean and covariance matrix of the eavesdropper
channel g ∼CN(0,InT ) known at the transmitter, the optimal
signaling is beamforming.
Due to limited space, we only give the proof sketch as
following. By applying the interlacing theorem [17, p.182] to
the derivative of the Lagrangian of (7) with respect to Su, we
can find that Su only has one eigenvalue which is larger than
zero. In addition to Su ≽ 0, we know that optimal Su must be
full rank.
In order to solve the optimal beamformer, we consider the
following channel prefixing,
x = uu1 +
nT∑
i=1
viui, (9)
where ui’s form the the orthonormal basis of CnT ,
u ∼ CN(0,PU ), and vi ∼ CN(0,PVi), i = 1,2, . . . ,nT , are
the desired signal and AN random variables, respectively,
with PU being the signal power, PVi , i = 1,2, . . . ,nT , being
the AN powers, respectively. In (9), we assume that Su and
Sv have the identical eigenvectors ui. In the following, we
prove that the channel prefixing (9), (i.e. Su and Sv have
the identical eigenvectors.), satisfies the KKT conditions
of Theorem 1. After that, we will also derive the optimal
beamformer based on (9).
Theorem 2: For the MISOSE fast faded wiretap channel
with the perfect information of the legitimate channel h, and
only the mean and covariance matrix of the eavesdropper
channel g ∼CN(0,InT ) known at the transmitter, the channel
prefixing (9) with u1 = h/∣∣h∣∣ satisfies the KKT conditions if
PV1 = 0 or
∣∣h∣∣2
1+ ∣∣h∣∣PV1
= E
⎡
⎢⎢⎣ ˜G1
1+
nT
∑
i=1
PVi ˜Gi
⎤
⎥⎥⎦ , (10)1168
1 (defined right after (10)) and applying the weak law of large
number. We then have Δ(P′V1) as
Δ(P′V1) = log
(
1+ ∣∣h∣∣2 P′V1
)
−E
[
log
(
1+
P′V1 ˜G1
1+PT −PU −P′V1
)]
.
From the results in [11], we know that if (1 + PT − PU −
P′V1)∣∣h∣∣2 < 0.56146, then Δ(P′V1)< 0 for P′V1/(1+PT −PU −
P′V1) > 0. Thus when nT is large enough and RGoel > 0 for
some power allocation, as long as (1+PT −PU −P′V1)∣∣h∣∣2 <
0.56146, the proposed scheme can outperform Goel and Negi’s
scheme. Also from [11] we know that if (1 + PT − PU −
P′V1)∣∣h∣∣2 > 1, then Δ(P′V1)> 0 for P′V1/(1+PT −PU −P′V1)> 0,
and there will be no gain.
Note that the above discussion provides an intuitive expla-
nation of the gain from transmitting AN in the signal direction.
However, it is only for RLB, but not the jointly optimized
result. In the following, we provide a necessary condition for
the optimality of full rank AN from joint optimization. First
define
Fk (x) =
∫
∞
0
xe−t
(1+ xt)k
dt = e1/xEk (1/x)
where Ek(x) is the En-function.
Theorem 5: A necessary condition for the optimal covari-
ance matrix of AN to be full rank is
1
PV1
⎛
⎜⎝ (1−nT )F1(PV1)(
1− PV2PV1
)nT + F2(PV1)(
1− PV2PV1
)nT−1
⎞
⎟⎠
− 1
PU +PV1
⎛
⎜⎝ (1−nT )F1(PU +PV1)(
1− PV2PU+PV1
)nT + F2(PU +PV1)(
1− PV2PU+PV1
)nT−1
⎞
⎟⎠
+
nT−1∑
k=1
(Bk −B′k)
Fk(PV2)
PV2
≥ ∣∣h∣∣
4 PU(
1+ ∣∣h∣∣2 PV1
)(
1+ ∣∣h∣∣2 (PU +PV1)
) ,
where
Bk = (nT − k)
(
−PV1
PV2
)nT−1−k 1(
1− PV2PV1
)nT−k+1 ,
B
′
k = (nT − k)
(
−PU +PV1
PV2
)nT−1−k 1(
1− PV2PU+PV1
)nT−k+1 ,
(18)
for k = 1,2, . . . ,nT −1.
V. SIMULATION RESULTS
In this section, we first illustrate the performance gain of the
proposed transmission scheme over Goel and Negi’s scheme.
We then verify the necessary condition in Theorem 5 for the
cases we consider in first part. We use a 2 by 1 by 1 channel
as an example. Assume the noise variances are normalized to
0 5 10 15 20
−0.1
−0.05
0
0.05
0.1
 
 
PV
1
’
se
cr
e
cy
 ra
te
 (b
its
/ch
an
ne
l u
se
)
||h||2=0.05, PT=50
Δ (PV
1
’ )
RGoel
Fig. 1. The curve of Δ(P′V1 )
30 40 50 60 70 80
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
transmit power PT
se
cr
e
cy
 ra
te
 (b
its
/ch
an
ne
l u
se
)
||h||2=0.05
 
 
Generalized AN
Goel and Negi’s AN
Fig. 2. Secrecy rate versus transmit power under ∣∣h∣∣2 = 0.05.
1. The channel states we use in the simulation are ∣∣h∣∣2 =
0.05, 0.1, 0.2, and 0.4 and E[ ˜G] = [1, 1]T . From Fig. 2, Fig.
3, and Fig. 4, which correspond to ∣∣h∣∣2 = 0.05, 0.1, and 0.2,
respectively, we can easily see that the proposed scheme
indeed provides apparent rate gains over Goel and Negi’s
scheme in moderate SNR regions. We can find that the rate
gains decrease with increasing ∣∣h∣∣2, which is consistent with
the results in [11]. We also find that the range of PT which
provides the largest rate gain also decreases with increasing
∣∣h∣∣2. This is because the gain provided by the AN in the
signal direction is more evident when Bob’s received SNR
is relatively small compared to Eve’s. In addition, it is also
observed that when the SNR approaches infinity or zero, the
performances of the proposed scheme and Goel and Negi’s
coincide. This property can be proved, but the proof is not
provided here due to limited space. As an example, we also
illustrate the optimal power allocation among PU , P′V1 , and P
′
V2
under ∣∣h∣∣2 = 0.05 in Fig. 5. It can be easily seen that as the
received SNR increases, the power allocated to P′V1 decreases
and the rate gain over Goel and Negi’s scheme also decreases.
We also use simulation to verify the validity of Theorem 5,
and find that the considered examples, which have full rank
covariance matrix of AN, indeed satisfy the derived necessary
conditions.1170
On Optimal Artificial-Noise Assisted Secure
Beamforming for the Multiple-Input
Multiple-Output Fading Eavesdropper Channel
Szu-Hsiang Lai † Pin-Hsun Lin† Shih-Chun Lin‡ Hsuan-Jung Su†
r98942061@ntu.edu.tw pinhsunlin@gmail.com sclin@ntut.edu.tw hjsu@cc.ee.ntu.edu.tw
†Department of Electrical Engineering and Graduate Institute of Communication Engineering
National Taiwan University, Taipei, Taiwan 10617
‡ Graduate Institute of Computer and Communication Engineering
National Taipei University of Technology, Taipei, Taiwan 10643
Abstract—In this paper we consider secure transmission for
the multiple-input, multiple-output, single-antenna-eavesdropper
systems with perfect information of the main channel and only the
statistics of the eavesdropper’s channel state information known
at the transmitter. We adopt the celebrated artificial-noise (AN)
assisted beamforming, which was studied by Goel and Negi with
the limitation that the AN must be allocated in the null space
of the main channel. By removing this limitation, we study the
rate optimization problems over the covariance matrices of the
signal and the AN. After exploring the structure of the optimal
solutions, we show that the original optimization problem can
be simplified as a much simpler power allocation problem. Our
results show that to improve the rate performance, one may
allocate the power of the AN in the directions of the right singular
vectors of the main channel. Thus Goel and Negi’s AN selection is
strictly sub-optimal. Moreover, our simulations show that when
the main channel has no null space, the rate performance of
our optimized signaling outperforms that of Goel and Negi’s
significantly.
I. INTRODUCTION
In a wiretap channel, a source node wishes to transmit
confidential messages securely to a legitimate receiver and to
keep the eavesdropper as ignorant of the message as possible.
As a special case of the broadcast channels with confidential
messages [2], Wyner [17] characterized the secrecy capacity
of the discrete memoryless wiretap channel. The secrecy
capacity is the largest rate communicated between the source
and destination nodes with the eavesdropper knowing no
information of the messages. Motivated by the demand of
high data rate transmission and improving the connectivity
of the network [18], multiple antenna systems with security
concern are considered by several authors. Shafiee and Ulukus
[16] first proved the secrecy capacity of a Gaussian channel
with two-input, two-output, and a single-antenna eavesdropper.
This work was supported by National Science Council and National Taiwan
University, Taiwan, R.O.C., under grants NSC 100-2221-E-002-133, NSC
100-2911-I-002-001, 10R70501, and NSC 100-2628-E-007-025-MY3.
The authors of [9], [14], [15] proved the secrecy capacity of
a Gaussian multiple-input multiple-output (MIMO), multiple-
antenna-eavesdropper channel using different techniques. Con-
cerning the characteristics of wireless channels, the impact of
fading on secrecy transmission was considered in [13] with
full channel state information at the transmitter (CSIT). Con-
sidering practical issues, perfect CSIT may not be available.
Several papers discussed the partial CSIT issue [3]–[5], [8],
[10]–[12]. However, the secrecy capacities for channels with
partial CSIT are known only for the limited case [5] where
the transmitter has single antenna with block fading.
In this paper, we consider an important type of wiretap chan-
nels with partial CSIT, namely, the multiple-input multiple-
output single-antenna-eavesdropper (MIMOSE) fading wiretap
channels. We assume that the main channel has a constant
channel gain and the eavesdropper channel is fast faded,
respectively. Therefore the transmitter has perfect knowledge
of the main channel and only the statistics of the eavesdropper
channel. The transmitter is assumed to have full knowledge of
the legitimate receiver’s channel. We adopt the celebrated arti-
ficial noise (AN) assisted beamforming [4] [8]. This signaling
can also be treated as one kind of linear prefixing where the
channel input is the message-bearing signal with the AN. We
relax the restriction in [4] [8] where the AN must be allocated
in the null space of the main channel, then study the rate
optimization problem over the covariance matrices of such
generalized AN and message-bearing signal. Note that the
assumption that the statistics of the eavesdropper’s channel
are known at transmitter was also used in [4] to design the
power allocation between the signal and the AN (see [4, (8)]).
Thus our comparison to the method in [4] in Section IV is
reasonable and fair.
The main contribution of our paper is to show that the
complicated covariance matrix optimization problem can be
2012 IEEE Wireless Communications and Networking Conference: PHY and Fundamentals978-1-4673-0437-5/12/$31.00 ©2012 IEEE 518
Substituting (1), (2), and (5) into (4), we then have the
optimization problem finding the achievable secrecy rate as
max
S
u
,S
v
RMIMOSE , (6)
such that tr(S
u
+S
v
)≤ PT , (7)
S
u
 0, S
v
 0, (8)
where
RMIMOSE =
(
log
(
det
(
InR +H(Su+Sv)H
H
)
det(InR +HSvH
H)
)
−E
[
log
(
1+gH (S
u
+S
v
)g
1+gHS
v
g
)])+
.
(9)
Note that the above is a generalized version of the result in
[4] since we do not restrict AN in the null space of the main
channel. In the following, we will provide the necessary steps
to simplify (6) as a pure power allocation problem.
III. OPTIMIZATION OF THE COVARIANCE MATRICES OF
THE SIGNAL AND THE AN
In this section, we will first present our main result, i.e.,
the power allocation problem simplified from (6), (7), and (8).
After that, we will provide the necessary steps to attain this
result.
Theorem 1. For the MIMOSE fast Rayleigh fading wiretap
channels with perfect information of the legitimate channel
H, and only the mean vector and covariance matrix of the
eavesdropper channel g∼CN(0,InT ) known at the transmitter,
with linear prefixing (5), the optimal secrecy rate can be found
by solving
max RMIMOSE
subject to
k
∑
i=1
(PUi +PVi)+(nT − k)PV0 ≤ PT
PUi ≥ 0, i= 1 · · · k
PV j ≥ 0, j = 0 · · · k, (10)
where PU1 · · ·PUk and PV1 · · ·PVk are the powers of signal and
AN in the direction of the main channel, respectively. PV0 is
the power of AN in the null space of the main channel, and
RMIMOSE =
(
k
∑
i=1
log
(
1+σ2i (PUi +PVi)
1+σ2i PVi
)
−E

log


1+
k
∑
i=1
(PUi +PVi)G˜i+PV0
nT
∑
i=k+1
G˜i
1+
k
∑
i=1
PViG˜i+PV0
nT
∑
i=k+1
G˜i




)+
,
(11)
where G˜i = |gi|
2, and gi is the ith entry of g.
Note that compared to (6), the simplified optimization
problem stated in Theorem 1 only has 2k+ 1 variables to
search. In addition, when the main channel is full column
rank, it can easily be seen that the AN scheme in [4] can
not be used to help secure transmission. However, under the
same condition, our proposed AN scheme still works. To prove
the theorem, in the following two subsections, we prove that
for MIMOSE systems with linear prefixing (5), the optimal
directions of both the signal and AN are the same as the right
singular vectors of the main channel in Lemma 1. After that
we discuss the rank property of the optimal signal covariance
matrix in Lemma 2 and the power allocation of the AN in
Lemma 3, respectively, which help to reduce the complexity
of solving the optimization problem. Finally, we provide a
sufficient condition under which transmitting AN (without the
signal) in the subspace (not the whole space) of the main
channel is better.
A. The optimal directions of the signal and the AN
In the following we first prove that with linear prefixing,
the eigenvectors of the optimal covariance matrices of both
the signal and AN are the same as the right singular vectors
of the main channel. Note that this result was heuristically
used in [4] without proof.
Lemma 1. For the MIMOSE fast Rayleigh fading wiretap
channels with the perfect information of the legitimate channel
H, and only the mean vector and covariance matrix of the
eavesdropper channel g ∼CN(0,InT ) known at the transmit-
ter, with linear prefixing, right singular vectors of the main
channel are the optimal eigenvectors for both the covariance
matrices of signal and AN.
Due to limited space, we only describe the sketch of the
proof. It is clear that the second term on the right hand side
of (9) is independent of the eigenvectors of S
u
and S
v
because
g is isotropically distributed. Thus we only need to consider
the first term. After some arrangement, we can observe that
the optimization problem becomes to maximize the numerator
and minimize the denominator simultaneously with respect to
two matrices. Through proving that these two optimizations
can be achieved simultaneously with these two matrices to be
diagonal, we can attain the desired result.
In the following, we provide a rank property of the signal
covariance matrix. This property helps to simplify the secrecy
rate formula and reduce the complexity of solving the power
allocation of signal and AN.
Lemma 2. For the MIMOSE fast Rayleigh fading wiretap
channels with the perfect information of the legitimate channel
H, and only the mean vector and covariance matrix of the
eavesdropper channel g∼CN(0,InT ) known at the transmitter,
the optimal signal covariance matrix has the rank smaller or520
ENC
DEC
w
w^
DEC
Alice
Bob
Eve
w^
Fig. 1. The considered system model.
30 40 50 60 70 80
0
0.2
0.4
0.6
0.8
1
1.2
1.4
P
T
S
e
c
re
c
y
 R
a
te
 (
b
it
s
/c
h
a
n
n
e
l 
u
s
e
)
The proposed scheme
Goel and Negi’s scheme
Fig. 2. Comparison of the secrecy rates with σ21 = 0.1,σ
2
2 = 0.05
known at the transmitter. Instead of transmitting AN in the
null space of the legitimate channel, we considered injecting
AN in all directions, including the direction for conveying
the dedicated messages. The proposed AN scheme can also
be used in the case where the main channel has no null
space. Through simulations, we verified that the proposed
scheme outperforms Goel and Negi’s AN scheme under certain
channel conditions, especially when the legitimate channel is
poor.
Our future work may include the development of an efficient
algorithm to solve the power allocation problem in Theorem
1. In addition, we may extend our result to fast fading
multiple-input multiple-output multiple-antenna-eavesdropper
wiretap systems with statistical channel state information at
the transmitter.
REFERENCES
[1] G. Caire and S Shamai. On the capacity of some channels with channel
state information. IEEE Trans. Inform. Theory, 45(6):2007–2019, Sept.
1999.
[2] I. Csisza´r and J. Korner. Broadcast channels with confidential messages.
IEEE Trans. Inform. Theory, 24(3):339–348, 1978.
[3] S. Gerbracht, A. Wolf, and E. Jorswieck. Beamforming for Fading Wire-
tap Channels with Partial Channel Information. In Proc. of International
ITG Workshop on Smart Antennas (WSA), Bremen, Germany, Feb. 2010.
[4] S. Goel and R. Negi. Guaranteeing secrecy using artificial noise. IEEE
Trans. Wireless Commun., 7(6):2180–2189, Jun. 2008.
[5] P. Gopala, L. Lai, and H. El Gamal. On the secrecy capacity of fading
channels. IEEE Trans. Inform. Theory, 54(10):4687–4698, Oct. 2008.
[6] R. A. Horn and C. R. Johnson. Matrix analysis. Cambridge university
press, Cambridge, UK, 1985.
[7] R. A. Janik and M. A. Nowak. Wishart and anti-wishart random
matrices. J. Phys. A: Math. Gen., (36):3629–3637, 2003.
[8] A. Khisti and G. W. Wornell. Secure transmission with multiple
antennas-I: The MISOME wiretap channe. IEEE Trans. Inform. Theory,
56(7):3088–3104, July 2010.
[9] A. Khisti and G. W. Wornell. Secure transmission with multiple
antennas-II: The MIMOME wiretap channel. IEEE Trans. Inform.
Theory, 56(11):5515–5532, Nov 2010.
[10] S. H. Lai, P. H. Lin, S. C. Lin, and H. J. Su. On optimal artificial-noise
assisted secure beamforming for the fading eavesdropper channel. In
Personal, Indoor and Mobile Radio Communications, 2011 IEEE 22th
International Symposium on, pages 1172–1176, Sept. 2011.
[11] J. Li and A. P. Petropulu. On ergodic secrecy rate for Gaussian MISO
wiretap channels. IEEE Trans. Wireless Commun., 10(4):1176–1187,
April 2011.
[12] Z. Li, R. Yates, and W. Trappe. Achieving secret communication for fast
Rayleigh fading channels. IEEE Trans. Wireless Commun., 9(9):2792–
2799, Sept. 2010.
[13] Y. Liang, V. Poor, and S. Shamai (Shitz). Secure communication over
fading channels. IEEE Trans. Inform. Theory, 54(6):2470–2492, Jun.
2008.
[14] T. Liu and S. Shamai (Shitz). A note on the secrecy capacity of the
multiple-antenna wiretap channel. 55(6):2547–2553, JUNE 2009.
[15] F. Oggier and B. Hassibi. The secrecy capacity of the MIMO wiretap
channel. IEEE Trans. Inform. Theory, 57(8):4961 – 4972, Aug. 2011.
[16] S. Shafiee and S. Ulukus. Towards the secrecy capacity of the Gaussian
MIMO wire-tap channel: the 2-2-1 channel. IEEE Trans. Inform. Theory,
55(9):4033–4039, Sept. 2009.
[17] A. D. Wyner. The wire-tap channel. Bell. Syst. Tech. J., 54(8):1355–
1387, Jan. 1975.
[18] X. Zhou, R. K. Ganti, and J. G. Andews. Secure wireless network
connectivity with multi-antenna transmission. IEEE Trans. Wireless
Commun., 10(2):425–430, Feb. 2011.522
100年度專題研究計畫研究成果彙整表 
計畫主持人：蘇炫榮 計畫編號：100-2219-E-002-011- 
計畫名稱：無線感知式協同型網狀網路之研究--子計畫三：無線感知式協同型多工存取之分散式編碼
架構(3/3) 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 4 4 100%  
博士生 1 1 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 1 1 100%  
研究報告/技術報告 0 0 100%  
研討會論文 8 8 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
