  -I- 
 
中文摘要 
本研究之目的在於發展一個整合慣性導航系統及全球導航衛星系統之軟體
模擬器。其主要功能除了提供未來全球導航系統的衛星參數及多頻民用訊號觀測
量、系統誤差的模擬評估、靜態及動態的精度評估。同時亦提供在相同運動軌跡
下不同等級慣性測量系統之靜態及動態觀測量、相關系統誤差、及不同座標系統
的慣性導航演算架構以供後續分析之用。隨著直接定位技術之發展，測量界的使
用者對精密定位定向平台的需求與日俱增。本研究所發展之模擬器可以提供一個
全面探討整合式定位定向技術的軟體平台，它的優點是低成本而且可以免去硬體
整合的難題。對台灣地區的使用者而言，高等級的慣性測量系統取得並不容易。
故藉由使用本研究所發展之平台，使用者除了可以模擬各等級慣性測量系統之靜
態或動態觀測量並同時可獲得衛星導航系統之靜態或動態觀測量，故吾人可藉由
這些模擬觀測量以較為低廉之成本發展各式整合式定位定向的演算法供研究及
產業界使用。 
 
關鍵詞：INS，GNSS，軟體模擬器 
 
 
 
Abstract 
 
The primary objective of this study is to develop a software simulator for 
INS/GNSS integrated system. The GNSS simulator is designed with the satellite 
related parameters of future GNSS and able to emulate multi-frequencies observables 
for civil user. As a result, it can be used to investigate the individual impact of system 
error sources, as well as the positioning accuracy assessment in static and kinematic 
mode. On the other hand, the proposed INS simulator is able to emulate IMU 
measurements in static and kinematic mode using the same trajectory generator used 
by GNSS simulator. In addition, it provides inertial sensor error models as well as 
several INS mechanizations for different navigation frames for further analysis. With 
the inclusion of direct geo-referencing technologies, the demands for precise 
positioning and orientation system from geomatics communities have been increased. 
It can be regarded as a cost-effect tool to study the technologies concerning 
INS/GNSS integrated system. The availability of high-end INS is limited in Taiwan, 
therefore, the research communities as well as industries can adopt proposed software 
simulator and enable a low cost solutions to study the standard and advanced 
algorithms for INS/GNSS integrated system. 
 
Keywords: INS, GNSS, Software Simulator 
 - 1 - 
 
第一章 緒論   
 
1-1 研究背景及文獻回顧 
 
GPS 為美國自 1970 年代末期開始發展的導航衛星定位系統，目前有 28 顆衛
星運行於距離地球表面約 2 萬公里的軌道中(see Parkinson et al,1996)。由於設計
至今已有約 30 年的時間，其定位精度已漸漸無法滿足日益升高的使用需求，因
此美國已經著手進行 GPS 系統之現代化，增加新的、改善品質的電碼觀測量，
以及更重要地，將原有的雙頻觀測系統提升為三頻觀測系統。 
GPS 系統之現代化已於 2005 年展開，2005 年 9 月發射的最新 GPS Block 
IIR-M 衛星已經開始傳送 L2C 觀測量，此觀測量是調制在 L2 頻道的最新電碼觀
測量，除了可以幫助地面接收儀對於 L2 載波觀測量的連續接收、減少由訊號失
鎖所產生的週波脫落之外，更提供了訊號強度較 L1 C/A 電碼觀測量更強、品質
更好的 L2 電碼觀測量，以消減電離層效應，提升定位精度。第二步的重大改變
預計於 2007 年開始發射的 GPS Block IIF 衛星，此系列總共包含九顆衛星。GPS 
Block IIF 衛星將傳送第三個頻率 L5 (1176.45 MHz) 的觀測量，GPS 將正式由雙
頻觀測躍升為三頻觀測系統。此一改變將會大幅改變現有相對定位基線計算的資
料處理方式，改變確定載波觀測量週波未定值之計算方法，藉由三頻觀測量之線
性組合大幅提升目前雙頻基線計算的求解效率。第三步的改變預計於 2012 年開
始發射的 GPS Block III 衛星，此系列的衛星將傳送 L1C 觀測量，提供訊號強度
及品質可與 L2C 觀測量匹配的 L1 電碼觀測量，進一步提升定位效能(Misra and 
Enge, 2001)。 
由俄羅斯發展的 GLONASS 導航衛星系統曾於 1995 年完成部署，隨後由於
衛星生命期只有三年與俄羅斯政府財力不足的問題，衛星數目由 1995 年的 26
顆直線下降至 2001 年的 7 顆，終於導致系統無法順利運行。然而基於國家安全
及導航系統自主性等因素的考量之下，俄羅斯政府決定繼續維持 GLONASS 之
運作並提出類似 GPS 現代化之計畫。該計畫第一步為在 2003 年後所發射的
GLONASS-M 衛星中，將第二個民用訊號調制在 L2 頻率中以增加定位精度。接
下來則是在 2008 年後所發射的 GLONASS-K 衛星中，將第三個民用訊號調制在
L3 頻率以進一步提升新一代 GLONASS 的性能。該計畫預計在 2010 年將衛星數
量提升至 24 顆，以提供全球覆蓋的高精度導航服務。除了致力於 GLONASS 的
性能提升之外，俄羅斯當局並與美國與歐盟針對未來整合涵蓋 GPSIII, GALILEO
及 GLONASS 的未來 GNSS 達成相關技術合作與交流的協議。 
前面所提及的 GPS 及 GLONASS 為由軍方所控制的導航系統。相較之下，
歐盟正大力發展中的 GAILEO 系統主要則是提供民用導航之用。早在 1990 年初
期，歐盟即開始發展針對歐洲北部提供較佳定位精度的衛星導航系統。歐洲太空
總署(European Space Agency, ESA)並於 1998 年針對發展一個獨立於 GPS 及 
GLONASS 且主要為民用之導航系統展開一系列的研究，並於三年之後公佈所使
用的衛星訊號結構 (O’Keefe,2001)。至此整個 Galileo 計劃的實施正式進入緊鑼
密鼓的發展階段。第一顆 Galileo 衛星(GIOVE-A)已於 2005 年 12 月 28 日成功發射
升空；至此，未來多系統的 GNSS 發展正式展開。Galileo 的原始計畫可分為三
期：第一期(2001 迄今)主要為研發階段；除了完成相關系統的設計外，最重要的
是衛星驗證(in-orbit validation, IOV)。而 IOV 的主要步驟為於 2005 年底發射 30
顆衛星中的四顆以驗證相關系統。然而發展期間不可抗拒之經費及技術發展問題
 - 3 - 
 
在高精度之導航及戰術等級的慣性測量裝置。所以發展具有慣性導航系統及未來
全球導航衛星系統之整合式定位系統在近年全球導航界中一直是最熱門的研究
課題之一(Titterton and Weston, 1997)。 
目前不論在軍用或民用的整合系統發展皆趨向於使用 INS 及 GNSS。主要的
動機在於此二系統具有互補之特徵；例如 INS 具有高採樣頻率及短時間內高精
度之特性，所以可以被使用來解決 GNSS 所遭遇諸如訊號遮蔽、低採樣頻率、週
波脫落、易被干擾等限制(Hide and Moore, 2004)。對於高動態運動的物體而言，
GNSS 無法提供足夠的採樣頻率來追蹤載體的運動。另外 INS 可以提供 GNSS 所
無法提供的姿態參數。而 GNSS 在無訊號遮蔽的環境下可以提供穩定的定位及導
航資訊。故它可用來減低 INS 因為積分加速度計及角速度之系統誤差所造成隨
時間累積的定位誤差。一般而言，INS 在獨自運作的模式下期定位誤差約略與時
間的平方成正比(Chiang, 2004)。由上所述不難發現 INS 與 GNSS 完全符合互補
之需求。圖 1-2a 上所示為 INS/GNSS 及整合式系統相關特性之示意圖。圖中綠
點及紅線分別為 GNSS 及 INS/GNSS 整合系統的動態定位軌跡。而在圖 1-2a 下
方可清楚看見當失去 GNSS 訊號時，INS 單獨導航定位解的誤差將隨著時間的增
長而快速地增加。然而，一但 GNSS 的訊號回覆後，GNSS 繼續提供穩定的導航
定位資訊，此一整合系統將迅速地將位置解拉回到可接受的誤差範圍內。圖 1-2b
為在失去 GNSS 訊號時，INS 在 40 秒內各種誤差的增量。 
 
 
圖 1-2 為 INS、GPS 及整合系統相關特性 
 
而整個整合式定位及導航系統的發展關鍵在於核心演算法部分。傳統的算法
是以卡曼濾波器(Kalman filter)為主(Savage, 2000)。卡曼濾波器(Kalman Filter)自
1960 由 Rudolph E.Klman 博士發表其著名關於離散資料線性濾波器遞回解法
(Kalman, 1960)之論文後即廣泛的被使用在導航及控制等相關領域。該濾波器由
一系列具備預測器(predictor)及補償器(corrector)且具備將估計後狀態參數之變方
最小化之最佳化特性之數學式所構成。它被公認為是目前在整合系統開發過程中
核心演算法的唯一選擇。而目前的 INS/GNSS 整合架構可分為:(1)鬆耦合架構
(loosely coupled integration scheme )，(2)緊耦合架構(Tightly coupled integration 
scheme)，(3) 超緊耦合 (Deep integration scheme)(El-Sheimy, 2004)。後者因為涉
及 GNSS 接收機與 IMU 之硬體整合故技術門檻較高，一般都由相關硬體廠商進
行相關系統之研究及發展。故在此研究中，吾人將把研究焦點放在鬆耦合及緊偶
合之相關技術。圖 1-3 為鬆耦合的架構示意圖。 
 
 - 5 - 
 
衛 星 ) ， 緊 耦 合 仍 可 利 用 觀 測 量 整 合 的 方 式 達 成 最 佳 的 位 置 估 值
(Scherzinger,2004)。圖 1-4 為緊耦合整合架構之示意圖。 
 
1-2 研究方法 
 
本研究所發展的 INS/GPS 整合系統模擬器之主要架構分為三大部分，分別
為軌跡產生器、觀測量模擬器及最佳狀態估算器等部分，如圖 1-5 所示。不論是
飛行載體、地面載體等，使用者只要給予所希望載體的軌跡動態，軌跡產生器提
供了載體真實的運動軌跡。如此經由諸如設計直線速度、加速度、角速度及持續
時間等動態運動方程即可得到運動體的完整路徑。相關特性整理如下： 
 
z 所模擬出的軌跡可以是任何所感興趣的座標系統，如慣性座標系統(Inertial 
frame)、地心地固座標系統(Earth-center Earth-fixed frame)、當地座標系統
(Local level frame)及載體座標系統(Body frame)。 
z 在近地表面任何的軌跡皆可模擬。 
z 所有的載體姿態、位置、速度均可模擬。 
z 模擬過程中，考慮了地球旋轉所造成的柯式力(Coriolis)和向心力(Centripetal)
影響。 
z 包含了近似地球運動的旋轉橢球體模型及重力模型。 
 
圖 1-5 INS/GPS 整合系統模擬器之主要架構 
 
吾人可透過選定起始點及選定特定之運動軌跡之函數組成動態軌跡模擬之
功能。這些運動軌跡之函數可以包含直線的等加速度或等減速運動、直線的等速
度運動、等角速度等。初期的設計會以平面軌跡為主，未來會將之擴充至三度空
間的動態模擬。透過軌跡模擬器吾人可計算在每個時刻載體的坐標，而模擬觀測
量即可輕易地藉由動態軌跡逐點的進行模擬而產生。圖 1-6 所示為利用簡單的直
線等速與圓形等速運動所產生之軌跡。 
 
 - 7 - 
 
實參數提供性能分析及觀測量模擬。 
 
 
圖 1-7 GNSS 模擬觀測量產生流程 
 
    除了上述模擬衛星分佈外，一套完整 GNSS 軟體模擬器需能模擬各種衛星誤
差來源，主要誤差為電離層誤差、對流層誤差、軌道誤差、多路徑效應等。ㄧ個
有效的 GNSS 系統誤差模型對模擬結果的可信度及準確度有決定性的影響。換言
之，ㄧ個 GNSS 模擬器必須要能產生與真實 GNSS 系統具備相似統計特性的系
統誤差。這些誤差的統計特性必須使用在不同環境下所採集到數據透過繁複的理
論分析與統計測試才可獲得。所有的參數必須要具備可調整之特性以提供完整之
測試與分析並考慮可能的大氣資料、電離層活動與使用者之位置資訊。表 1-2 所
示為本研究所採用之 GNSS 系統誤差模型。藉由上述參考模擬 INS 及 GNSS 的
架構，吾人即可著手建置相關模擬器，主要包含軌跡模擬、觀測量模擬以及最後
的整合估算器。整合系統的估算器其內容包含以鬆耦合與緊偶合方式實現包含卡
曼濾波器(適合即時導航)與平滑器(適合高精度之後處理(Schwarz and Wei, 
2000))之 INS/GNSS 最佳化整合架構。 
 
 表 1-2 GNSS 系統誤差模型 
主要系統誤差 現有給定方式 
軌道誤差 GPS = ± 5 m ,  
Galileo = ± 2 m 
對流層 修正的 Hopfield 模型 
電離層 Klobuchar Model 
多路徑效應 Colored-noised model 
接收儀時錶 ± 300 m 
系統時間偏差 100 ns 
坐標系統偏差 暫不考慮 
 
 
 
 
 
 - 9 - 
 
 
(a)                             (b) 
圖 2-1 平台式慣性導航系統 
 捷聯式慣性導航系統(Strapdown Inertial Navigation System, SINS) 
 
 與平台式慣性導航系統最大的不同處在於捷聯式的可攜性。將捷聯式慣性導
航系統安裝在載體上，x-軸朝向載體前方；y-軸朝向載體正右方，z-軸指向重力
線方向。如此感測器的三軸就相同於載體參考框架。圖 2-2 為捷聯式慣性導航安
裝在載體上的示意圖。 
 
 
圖 2-2 捷聯式慣性導航裝置三軸示意圖 
 
由於缺少了慣性平台，所以感測器三軸的方向並不能如同於平台式始終對準
於導航框架，也因此在進行導航解算時就必須考慮到載體參考框架與導航參考框
架之間的轉換關係，而兩參考框架之間的轉換是透過陀螺儀所量測到的角速度
b
ibω 來建構轉換矩陣。載體參考框架在導航過程中會隨著載體的運動而產生旋轉
和位移，因此轉換矩陣將在導航過程中不斷地更新，以確保加速度計所量測之觀
測量 bf 可以正確地轉換到導航參考框架下進行解算。捷聯式相較於平台式不論
是在耗電性、成本、體積及重量都大幅降低外，慣性儀表易安裝及維護也提高了
系統的性能與可靠性，但一般的捷聯式系統的精度仍難以達到平台式的水準。現
行的捷聯式慣性導航系統依照精度的區別大致可分為三種等級：導航等級
(Navigation grade)、戰術等級(Tactical grade)和微機電等級(MEMS grade)。表 2-1
列出此三種等級的效能表現。圖 2-3 為捷聯式的慣性量測裝置外觀。 
 - 11 - 
 
2-2.2 地球參考框架(The Earth frame, e-frame) 
 
 這裡提到的地球參考框架是指協議的地球座標系統(Conventional Terrestrial 
System, CTS)的實踐。我們定義它的中心位在地球的質量中心，z-軸的方向為地
心指向協議的地球極(Conventional terrestrial Pole, CTP)也就是平行地球自轉軸，
x-軸為地心指向格林威治零子午圈和赤道的交點，y-軸和 x-軸、z-軸構成一個右
旋正交框架。如圖 2-5 所示。這個協議的地球座標系統通常又稱為地心地固座標
系統(Earth centered earth fixed coordinate system, ECEF coordinate system)。
WGS84 座標系統是協議的地球座標系統 CTS 的具體實現之一，為美國國防部為
全球定位系統 GPS 所建立的，並為美國國防部的 GPS 廣播星曆和精密星曆的參
考座標系統。在慣性導航中所提到的地球參考框架通常也是使用 WGS84 座標系
統。 
 
 
圖 2-4:慣性參考框架 
 
 
圖 2-5 地球參考框架 
 
2-2.3 當地水平參考框架(The local level frame, l-frame) 
 
 在慣性導航系統當中，通常把當地水平參考框架當作導航框架(Navigation 
frame, n-frame)。其原點為感測器的中心，z-軸的方向定義為測站的橢球面法線方
向，y-軸指向地平北方(橢球子午圈方向)，x-軸、y-軸和 z-軸構成一個右旋正交
框架。此種框架稱之為北、東、地系統(north-east-down, NED)，如圖 2-6(a)所示。
但在慣性導航系統中，另一種定義為東、北、天系統(east-north-up, enu)的當地水
 - 13 - 
 
 
2-3.1 地球參考框架(e-frame)到當地水平參考框架(l-frame) 
 
 從 e-frame 轉換到 l-frame 的 DCM 如下所示： 
 
( ) ( )2
sin cos sin sin cos
sin cos 0
cos cos cos sin sin
l
e y zC R Rπϕ λ
ϕ λ ϕ λ ϕ
λ λ
ϕ λ ϕ λ ϕ
= − −
− −⎛ ⎞⎜ ⎟= −⎜ ⎟⎜ ⎟− − −⎝ ⎠
 (2.1) 
其中ϕ為經度，λ為緯度， yR 和 zR 分別表示為對參考框架的 y-軸及 z-軸做旋
轉。利用正交性可得到 l-frame 到 e-frame 的 DCM，由下所表示： 
 ( ) sin cos sin cos cossin sin cos cos sin
cos 0 sin
Te l
l eC C
ϕ λ λ ϕ λ
ϕ λ λ ϕ λ
ϕ ϕ
− − −⎛ ⎞⎜ ⎟= = − −⎜ ⎟⎜ ⎟−⎝ ⎠
 (2.2) 
2-3.2 當地水平框架(l-frame)到載體參考框架(b-frame) 
 從當地水平框架轉換到載體參考框架的 DCM 定義為下式(Titterton and 
Weston, 2004)： 
 ( ) ( ) ( )bl x y zC R R Rφ θ ψ=  (2.3) 
其中φ、θ 及ψ 分別表示為尤拉角(Euler angles)即為載體姿態角的三個元素：
roll、pitch 和 heading。因此，如同 2-2.1 所提到的正交性，由 b-frame 轉換到 l-frame
的 DCM 也可以藉由(2.3)式的轉置矩陣所得來： 
( ) ( ) ( ) ( )
cos sin 0 cos 0 sin 1 0 0
sin cos 0 0 1 0 0 cos sin
0 0 1 sin 0 cos 0 sin cos
c c c s s s c s
c s c s s s
s
l l T
b n z y xC C R R R
s s c c
c s s c c s
s c c c
ψ θ φ
ψ ψ θ θ
ψ ψ φ φ
θ θ φ φ
θ ψ φ ψ φ θ ψ φ ψ φ θ ψ
θ ψ φ ψ φ θ ψ φ ψ φ θ ψ
θ φ θ φ θ
= = − − −
−⎛ ⎞⎛ ⎞⎛ ⎞⎜ ⎟⎜ ⎟⎜ ⎟= −⎜ ⎟⎜ ⎟⎜ ⎟⎜ ⎟⎜ ⎟⎜ ⎟−⎝ ⎠⎝ ⎠⎝ ⎠
− + +⎛ ⎞⎜ ⎟= + − +⎜⎜ −⎝ ⎠
⎟⎟
(2.4)
 
(2.4)示中，c 代表 cos；s 代表 sin。如果已知 DCM lbC ，則尤拉角也可由以下公
 - 15 - 
 
 x x xxy zy zxω ω ω= −  (2.12) 
注意在(2.11)式和(2.12)式中ω的上下標，此一法則會在慣性導航方程式中經常被
使用到。 
2-4  捷聯式慣性導航系統 
INS 的基本量測元件為 IMU，而所量測到的量通常為載體在三軸上速度變量
b
fvΔ  及角度變量 bibθΔ  ，且為離散的形式，如再分別對時間做一次積分及二次積
分，則可得到載體的速度、位置和姿態角，以達到導航的目的，這是慣性導航的
最基本概念。由於加速度計及陀螺儀本身的一些系統性及非系統系的誤差，會造
成量測到的 bfvΔ  和 bibθΔ  並非理想的變動量。因此再使用原始的觀測量進行導航
前，一些基本的系統性誤差模式必須用以改正原始的觀測量。通常陀螺儀利用偏
心量 bias；加速度計利用偏心量 bias 及尺度因子 scale factor 做最初步的改正動
作。通常這些系統誤差會在 IMU 的規格書中說明，但最好的做法莫過於自行對
IMU 做實際的測試，如此會得到較為客觀的系統誤差值。 
 b bib ib b tωθ θΔ = Δ − Δ  (2.13) 
 
1 0 0(1 )
10 0(1 )
10 0 (1 )
gx
b b
f f g
gy
gz
s
v v b ts
s
⎛ ⎞⎜ ⎟+⎜ ⎟Δ = Δ − Δ⎜ ⎟+⎜ ⎟⎜ ⎟⎜ ⎟+⎝ ⎠
  (2.14) 
在(2.13)式及(2.14)式中， bibθΔ 和 bfvΔ 分別表示經過改正過後的陀螺儀及加速度
計的輸出。bω和 gb 則分別表示陀螺儀及加速度計的偏心量， gxs 、 gys 及 gzs 為
在三軸上的加速度計的尺度因子。 1k kt t t+Δ = − 代表在( )1k kt t + 間的時間差。
IMU 的採樣頻率可以用 1Hz t= Δ 決定，但通常採樣頻率並非一定值，因此 tΔ 必
須將之視為一變數。 
要利用改正過後的 IMU 觀測量 bfvΔ 和 bibθΔ 進行導航，一連串的數學模型必
須被建立，這些數學模型由三項動態方程式所組成，稱之為慣性導航方程式。其
三項動態方程式分別為：位置動態方程式、速度動態方程式及旋轉矩陣動態方程
式。藉由慣性導航方程式就可將來自 IMU 的觀測量處理為所需要的導航解。這
裡所指的導航解，所採用的座標框架都是當地水平導航框架。 
 - 17 - 
 
(2.20)式為速度動態方程式的基本型式，但目標方程式必須是一加速度的函式，
因此在等號的右邊必須做一些數學的運算，已達到與加速度相關的目的函式，以
下將會列出各個步驟的數學推導。首先，先處理 er 與 er 的部份。在地心地固框
架中的座標 er ，與同一點位在慣性框架下的座標的關係，可以用座標轉換式表
示： 
 e e iir C r=  (2.21) 
(2.21)式對時間做一次微分： 
 e e i e ii ir C r C r= +    (2.22) 
其中： 
 e e ii i ieC C= − Ω  (2.23) 
將(2.23)式代入(2.22)式中，可得： 
 ( )e e i i ii ier C r r= −Ω   (2.24) 
再作一次微分： 
 
( ) ( )
( ) ( )
( 2 )
e e i i i i i e i i i
i ie ie i ie
e i i i e i i i i
i ie i ie ie
e i i i i i i
i ie ie ie
r C r r r C r r
C r r C r r
C r r r
= −Ω −Ω + −Ω
= −Ω − Ω −Ω
= − Ω +Ω Ω
   
  
 
 (2.25) 
在(2.25)式中，因為可將地球自轉速率視為等角速度，因此角速度的變量可當作
0， 0iieΩ = 。 
 經由以上的推導， er 及 er 分別可以改寫成(2.24)式與(2.25)式的型式。又
n n n
e en eC C= −Ω 、 i i i i nie nr r C v= Ω + ，代入 (2.20)式可得： 
 
( 2 )
( 2 2 )
( 2 )
( 2 )
n n e i i i i i i n n e
e i ie ie ie en e
n i i i n i i i i i i n n
i ie n ie ie ie ie en
n i i i n i i i n i i n
i ie n ie ie i en n
n i i i i n i i i
i en ie n ie ie
v C C r r r C r
C r C v r r v
C r C v r C C v
C r C v r
= − Ω +Ω Ω −Ω
= − Ω − Ω Ω +Ω Ω −Ω
= − Ω −Ω Ω − Ω
⎡ ⎤= − Ω + Ω −Ω Ω⎣ ⎦
   



 (2.26) 
 - 19 - 
 
n
ieΩ 為 nieω 的斜對稱矩陣，表示地球自轉的速率投影到導航框架上，寫成： 
 ( cos 0 sin )n n e Tie e ie e eCω ω ω ϕ ω ϕ= = −  (2.33) 
eω 為地球自轉的速率，其值大約為 -57.2921158 10 rad s× 。在(2.30)式中的重力
ng ，通常以正常重力處理，為緯度ϕ與橢球高h 的函數(Schwarz and Wei, 2000)： 
 
2 4 2 2
1 2 3 4 5 6(1 sin sin ) ( sin )
ng a a a a a h a hϕ ϕ ϕ= + + + + +  (2.34) 
1 4
2 5
3 6
9.7803267715 0.0000030876910891
0.0052790414 0.0000000043977311
0.0000232718 0.0000000000007211
a a
a a
a a
= = −
= =
= =
 
2-4.3 姿態角動態方程式 
如 2-3.3 節所提到的，姿態角的動態方程式可以用方向餘弦矩陣的動態方程
式表示： 
 n n bb b nbC C= Ω  (2.35) 
或 
 n b nb nb bC C= −Ω  (2.36) 
因為三個姿態角與方向餘弦矩陣 nbC 的關係可以在(2.5)式、(2.6)式及(2.7)式得
到。因此可將方向餘弦矩陣的動態方程視為姿態角的動態方程式。 
 
圖 2-8 四元素的方向向量及旋轉向量 
 除了先前所提的尤拉角，四元素(Quaternions)更是經常被使用在更新姿態角
及轉換矩陣上，因為可以避免矩陣運算上的奇異解發生，另外，也減少了轉換矩
陣中的變數，在方向餘弦矩陣中有六個變數，而四元素只有四個變數。四元素在
 - 21 - 
 
 ˆ Tq q q q=  (2.42) 
四元素的動態方程表示為： 
 
1 1
2 2
3 3
0 0
0
01
02
0
z y x
z x y
y x z
x y z
q q
q q
q
q q
q q
ω ω ω
ω ω ω
ω ω ω
ω ω ω
−⎛ ⎞⎛ ⎞ ⎛ ⎞⎜ ⎟⎜ ⎟ ⎜ ⎟−⎜ ⎟⎜ ⎟ ⎜ ⎟= = ⎜ ⎟⎜ ⎟ ⎜ ⎟−⎜ ⎟⎜ ⎟ ⎜ ⎟⎜ ⎟− − −⎝ ⎠ ⎝ ⎠⎝ ⎠

 

 (2.43) 
xω 、 yω 及 zω 為載體旋轉的角速度。四元素的初始值可以利用(2.40)式，以方向
餘弦矩陣得來。 
由(2.16)、(2.30)及(2.35)式，可以得到完整的捷聯式慣性導航方程式： 
 ( )
1
2
nn
n n b n n n n
b ie en
n n bb b nb
D vr
v C f v g
C C
ω ω
−⎛ ⎞⎛ ⎞ ⎜ ⎟⎜ ⎟ ⎜ ⎟= − + × +⎜ ⎟ ⎜ ⎟⎜ ⎟⎜ ⎟ ⎜ ⎟Ω⎝ ⎠ ⎝ ⎠



 (2.44) 
 ( )1
1 0 0
10 0
cos
0 0 1
M h
D
N h ϕ
−
⎛ ⎞⎜ ⎟+⎜ ⎟⎜ ⎟= + +⎜ ⎟⎜ ⎟−⎜ ⎟⎝ ⎠
 (2.45) 
2-5 慣性導航的實踐 
 由於 IMU 是記錄每個取樣時間點的量測值，必須將之視為一種離散時間的
觀測。如要從觀測量轉換到導航資訊：位置、速度及姿態角，就必須利用數學式
的積分來達成。在(2.44)式中，列出了慣性導航方程式，利用改正過後的觀測量
b
ibθΔ 和 bfvΔ 代入且對時間做積分，即可得到欲求的導航訊息。 
2-5.1 姿態積分 
在慣性導航中，量測到的速度變量 bfvΔ 是載體相對於慣性參考框架下的變
量，必須將之轉換到導航框架下，才能進行導航解的解算。亦即從載體參考框架
轉換到導航框架的方向餘弦矩陣必須先被建立，以 MEMS 等級的 IMU 為例，初
始的方向餘弦矩陣必須由 GPS 的位置解來輔助建構。但在導航的過程中，載體
參考框架與導航框架之間的轉換關係不斷地在變動，因此更新 b-frame to n-frame
 - 23 - 
 
參考(2.30)，則 nvΔ 為： 
 (2 )n n n n n nf ie env v v t g tω ωΔ = Δ − + × Δ + Δ  (2.50) 
速度的積分即可寫成下式： 
 1 1n n nk k kv v v+ += +Δ  (2.51) 
位置的積分： 
 11 2
n n
n n k k
k k
v vx x tδ++ ⎛ ⎞+= + ⎜ ⎟⎜ ⎟⎝ ⎠
 (2.52) 
整個慣性導航方程式的處理流程，如圖 2-9 所示。 
 
圖 2-9 當地水平參考框架的捷聯性慣性導航示意圖 
 
 
 
 
 
 
 
 
 
 
 - 25 - 
 
相關措施 實施時間 
取消 SA 2000 年 5 月 
z 衛星 IIR-M 衛星性能提升項目 
 新的 L2 民用電碼(L2C) 
 L1 & L2 的軍用碼(M) 
 2005 年 5 月 26 日發射第一顆傳送
L2C 的 GPS IIR-M 衛星 
 預計 2014 年完成 24 顆衛星傳送
L2C 訊號計畫 
z 衛星 IIF 衛星性能提升項目 
 新的 L2 民用電碼(L2C) 
 L1 & L2 的軍用碼(M) 
 新的 L5 民用電碼 
 預計 2008 年 8 月發射第一顆傳送
L5 及 L2C 的 GPS IIF 衛星 
 預計 2016 年完成 24 顆衛星傳送
L2C 及 L5 訊號計畫 
z 衛星 III 衛星性能提升項目 
 新的 L2 民用電碼(L2C) 
 增強軍用碼(M)之功率 
 新的 L1 民用電碼(L1C) 
 預計 2013 年發射第一顆傳送 L5、
L2C 及 L1C 的 GPS III 衛星 
 預計 2021 年完成 24 顆衛星傳送
L1C 訊號計畫 
 
GPS 系統現代化於 2005 年正式展開，該年 9 月發射最新的 GPS Block IIR-M
衛星，已開始傳送 L2C 觀測量。此觀測量調制於 L2 頻道的最新電碼觀測量，除
了可以幫助地面接收儀對於 L2 載波觀測量的連續接收、減少由訊號失鎖所產生
的週波脫落外，更提供訊號強度較 L1 C/A 電碼觀測量更強、品質更好的 L2 電
碼觀測量，以消減電離層效應，提升定位精度。GPS Block IIR-M 為 Block IIR 的
第二部分，總共包含 8 顆衛星(Misra and Enge, 2001)。 
 
 
圖 3-2 Modernized GPS 衛星示意圖(Lachapelle, 2002) 
第二步重大改變預計於 2008 年開始，發射 GPS Block IIF 衛星，此系列共包
 - 27 - 
 
 
圖 3-4 現代化後 GPS 的民用訊號頻譜及其特性 
(Kaplan and Hegarty, 2005) 
 
圖 3-5 2008 年 1 月 14 日 GPS 星群分佈圖 
現階段可使用的民用訊號調制在 L1 上，未來當現代化的計畫完成時，調制
於 L2 及 L5 上新的民用訊號也將無限制地提供一般使用者使用。對於目前廣大
使用即時 GPS 動態單點定位使用者而言，三頻的觀測量能夠增加訊號的多餘觀
測量，並藉由消除電離層干擾大幅提升單點定位精度。除此之外，現代化 GPS
並針對訊號的可靠度、完整性、連續性及抗干擾性等性能做大幅的提升，對使用
差分定位的應用而言，這增加的第三個頻率可以更有效的估計電離層效應並提供
基線求解之用(Chiang et al., 2006)。 
目前美國國防部將精確的 P 電碼鎖碼組成所謂的 Y 電碼，以供軍方及少數
 - 29 - 
 
 
 GLONASS Modernization plan
 
圖 3-7 GLONASS 現代化計畫(FSARF, 2005) 
 
 GLONASS-M Performance 
  
圖 3-8 GLONASS-M 衛星之性能(FSA RF, 2005) 
 - 31 - 
 
如同 GPS 一樣，GLONASS 系統為一包含軍用及民用雙重用途之系統。未
來的 GLONASS 系統可以提供三頻民用訊號，提供高精度導航、定位及時間等
相關應用領域之用。整合 GPS 及 GLONASS 之接收機在 1995 年前後已有成熟的
產品問世，過去相關文獻亦證明整合現有 GPS 及 GLONASS 系統能夠提供較任
一系統較高之定位精度及全球覆蓋率(Zinoviev, 2005)。因此未來如果 GLONASS
能夠成為穩定的信號來源，整合現代化 GPS 及 GLONASS 的多頻率 GNSS 應能
較現有 GPS 或 GLONASS 單一系統具備更高的定位精度(Zinoviev, 2005)。 
圖 3-11 (http://gge.unb.ca/Resources/GLONASSConstellationPlot.pdf) 所示為
GLONASS 於 2008 年 3 月 25 號之星群。。圖中所示目前 GLONASS 星群已具備
16 顆衛星，其中 701、712 到 723 等 13 顆為 GLONASS-M 衛星。 
 
圖 3-11 2008 年 3 月 25 日 GLONASS 星群分佈圖 
2007 年 9 月 26 日於美國德州沃斯堡舉辦的 Civil GPS Service Interface 
Committee (CGSIC)會議中，來自俄羅斯太空總署 PNT 資訊中心的副主席
Revnivykh 先生，提及未來有意於 K 系列衛星之 L1CR 及 L5R 傳送碼分多址
(CDMA)的訊號。如此一來，未來包含 GPS、GLONASS、Galileo 與 Compass
衛星皆會播送碼分多址的訊號，有助於硬體製造商設計價格更為低廉但精度更高
之多系統接收機，同時軟體設計者亦能利用共頻的多系統訊號，設計更為有效的
聯合資料處理演算法。第一顆 K 系列衛星預計於 2009 年至 2010 年間發射升空。 
3-3   Galileo 
前面所提及的 GPS 及 GLONASS 皆為軍方所控制的導航系統。相較之下，
歐盟正大力發展中的 Galileo 系統主要是提供民用導航之用。早在 1990 年初期，
歐盟即開始發展針對歐洲北部提供較佳定位精度的衛星導航系統。歐洲太空總署
(European Space Agency, ESA)於1998年針對發展一個獨立於GPS 及 GLONASS
且主要為民用之導航系統展開一系列的研究，並於三年後公佈所使用的衛星訊號
 - 33 - 
 
 
圖 3-13 Galileo 訊號頻率分佈圖(Hein et al., 2002) 
3-4   Beidou/Compass 
北斗衛星導航定位系統(Beidou/Compass)，是中國研發的區域性三維衛星定
位與通信系統(CNSS)。該系統由 3 顆(2 顆工作衛星、1 顆備用衛星)北斗定位衛
星(北斗一號)、地面控制中心為主的地面部份與北斗用戶終端三部分組成。可向
用戶提供全天候、24 小時的即時定位服務，其三維定位精度約幾十米。 
北斗衛星導航定位系統的基本工作原理是雙星定位：以 2 顆在軌衛星的已知
坐標為圓心，各以測定的衛星至用戶終端的距離為半徑，形成二個球面，用戶終
端將位於這二個球面交線的圓弧上。地面中心站配有電子高程地圖，提供一個以
地心為球心、以球心至地球表面高度為半徑的非均勻球面，利用數學方法求解圓
弧與地球表面的交點即可獲得用戶的位置。由於定位時需要用戶終端向定位衛星
發送定位信號，藉由信號到達定位衛星時間的差值計算用戶位置，所以被稱為有
源定位。其定位示意圖如圖 3-14。 
 - 35 - 
 
GEO： 
24 小時 00 分 
使用頻率 
(民用) (MHz) 
L1：1575.42 
L2：1227.60 
L5：1176.45 
E1：1575.42 
E5b：1207.14
E5a：1176.45
G1：1602~1616
G2：1246~1257
3rd：未定 
B-1：1561.10 
B1-2：1589.74 
B3：1268.52 
B2：1207.14 
參考座標框架 WGS-84 GTRF PZ-90 
Beijing 1954 
coordinate 
system 
時間系統 GPST GST UTC(SU) 
Chinese 
coordinated 
universal time 
傳輸方式 CDMA (碼分多址) 
CDMA 
(碼分多址) 
FDMA/CDMA
(頻/碼分多址)
CDMA 
(碼分多址) 
 
未來開發多頻率、多系統的 GNSS 聯合處理技術，如同一般多感測器一樣，
可能遭遇基線解算物理模式之定義、基線解算數學模式的探討與系統參數整合等
問題。其中系統參數整合問題對精密測量影響最甚的莫過於時間系統、坐標系統
與訊號結構的差異，表 3-2 可看出各系統參數相異之處。故研究發展支援多系統
的 GNSS 聯合處理技術時，必須針對不同系統間的互相操作性及相容性課題進行
探討及分析，並從依循相關文獻的建議選擇最適合的發展策略。 
由於 Galileo 的訊號與 GPS 完全相容，因此 GPS 接收儀製造商將可較為輕
鬆地將現有的 GPS 技術擴充為 GNSS 技術。未來接收儀的頻道(Channel)數目預
計將會提高較現有的 3 倍(2 倍來自於可視衛星數目的增加，1 倍來自於頻率數的
增加)。因此本研究優先針對現代化 GPS 及 Galileo 發展 GNSS 雙系統聯合資料
處理與性能分析模組，提供整合 GPS 及 Galileo 之未來 GNSS 於台灣地區包含衛
星可視數量、DOP 值、可靠度等性能評估值指標，針對空間分佈 (Spatial 
variation)、時間分佈(temporal variation)及對遮蔽效應的敏感度等模式進行深入分
析。 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 - 37 - 
 
以下簡單敘述 GPS 和 INS 整合後之優點： 
z 於長時間測量時，高精度的 GPS 資料可以用來修正 INS，控制其誤差隨時
間累積，使得誤差侷限在某一範圍內。 
z 具有誤差範圍的 INS 資料，可在 GPS 相鄰兩次觀測值更新之間，以其高頻
輸出的導航訊息內插求出精確的位置。 
z INS 資料可用於 GPS 訊號週波脫落的偵測與改正。 
z 整合式 INS/GPS 系統提供精確的姿態測定。 
z INS 的輔助加強系統抗干擾的能力。 
z 當干擾、遮蔽使 GPS 訊號接收中斷時，INS 可輔助 GPS 使接收機快速重新
接收訊號。 
由此可見，GPS 和 INS 兩者間存在著良好的性能互補特性，整合式導航系
統比任一系統單獨使用效能更佳。 
表 4-1 整合系統與單一系統之比較 
 
INS GPS INS/GPS 
短期觀測，位置、速
度精度高 
長期觀測，位置、
速度精度高 
位置、速度精度高 
精確姿態 精度一致，與時間
無關 
精密姿態 
高取樣頻率 不受重力影響 高取樣頻率 
優點 
訊號不中斷  GPS 遮蔽，仍有導航解 
誤差隨時間累積 姿態雜訊量高 週波脫落偵測 
受重力影響 非自主 抗干擾 
缺點 
需初始和空中對準及
率定 
¾ 週波脫落和
訊號失鎖 
¾ 取樣頻率低 
¾ 減短 GPS 訊號重新
接收時間 
¾ 重力測定 
4-2   整合系統之結構 
    GNSS 和 INS 的整合方式有很多；一般分為鬆耦合方式（loosely coupled）
 - 39 - 
 
法單獨求解時，就會完全失去整合的意義，同樣成為單一系統的運作模式。由於
使用者必須同時接受四顆以上的衛星訊號，負責處理 GNSS 觀測量的卡曼濾波器
才能解算出 GNSS 所提供的導航解，因此我們會希望在實行 INS/GNSS 整合系統
時，隨時都能收到四顆以上的衛星訊號，但現實中總不盡理想，很多時候我們並
不能同時收到四顆或以上的衛星訊號，造成的原因諸如不開闊的觀測區域造成遮
蔽，例如：高樓大廈林立處、隧道、綠色隧道等等。當然，在如隧道這種天空視
角完全被遮蔽的情況下，理論上是完全收不到 GNSS 的訊號的，因此也不可能得
到任何的 GNSS 導航解，此時就必須依靠 INS 本身的獨自運作。但如高樓大廈
林立處，有時雖無法接收到四顆或以上的衛星訊號，或是可以收到四顆或以上的
衛星訊號但卻是品質不良的反射訊號，這些都無法提供正確的衛星導航解。因
此，另一種最佳化的 INS/GNSS 整合架構油然而生， INS/GNSS 緊耦合
(Tightly-Coupled)整合系統架構。 
 
圖 4-5 INS/GPS 緊耦合架構示意圖 
緊耦合整合系統架構，基本上是將兩系統在觀測量的部分就做整合，換句話
說，緊耦合不再像是鬆偶合系統般，將兩系統視為獨立運作的導航系統，個別得
到導航解之後再進行整合，取而代之的是緊密地將 INS/GNSS 視為同一個系統，
一同進行導航解算，而 INS 及 GNSS 則是此整合系統的感測器，也就是觀測量
來源。圖 4-5 為緊耦合架構的示意圖。此種架構的整合，最大的優點在於當 GNSS
訊號薄弱時，系統只要能收到一顆衛星的正常訊號，即可進行導航解算。因此，
緊耦合可以說是 INS/GNSS 在軟體方面最佳的整合方式。 
由兩種不同的整合架構可知，卡曼濾波器在 INS/GNSS 扮演了舉足輕重的角
色，下一節將會介紹所使用的卡曼濾波器以及 INS/GNSS 的卡曼濾波器設計。 
4-3  擴展式卡曼濾波器 
在 GPS/INS 整合系統研究的發展中，數據處理理論中的最優估計理論─卡
曼濾波理論起了重要的作用，它為整合式的導航系統提供了重要的理論基礎。卡
曼濾波器 （Kalman filter, KF） 自 1960 年由 Rudolph E. Kalman 博士發表其著
名關於離散資料線性濾波器遞迴解法 (Kalman, 1960) 之論文後，即廣泛的被使
用在導航及控制等相關領域。該濾波器由一系列預測器 （predictor） 與補償器 
（corrector） 以及將估計後狀態參數之變方最小化之最佳化特性之數學式所構
 - 41 - 
 
式中，γ為正常重力向量； lE 為姿態誤差 lε 的反對稱形式或其外積。 
 
0
( ) 0
0
D E
l l
D N
E N
E
ε ε
ε ε ε
ε ε
⎛ ⎞− ⎟⎜ ⎟⎜ ⎟⎜ ⎟= × = −⎜ ⎟⎜ ⎟⎜ ⎟⎟⎜−⎝ ⎠
 (4.5) 
式中，ε為姿態誤差向量， ( )× 為一向量的反對矩陣或外積。詳細的公式推導
可以參考 (Britting, 1971)、(Farrell and Barth, 1998) 和(Schwarz and Wei, 2000)。 
z 位置誤差方程 
因位置誤差方程為位置與速度的函數，需使用偏微分才可得到位置誤差方
程，表示如下： 
 
N
l
rr rv E
D
v
r F F v
h vh
δϕ δδϕ
δ δλ δλ δ
δ δδ
⎡ ⎤ ⎡ ⎤⎡ ⎤⎢ ⎥ ⎢ ⎥⎢ ⎥= = +⎢ ⎥ ⎢ ⎥⎢ ⎥⎢ ⎥ ⎢ ⎥⎢ ⎥⎣ ⎦ ⎣ ⎦⎣ ⎦



 (4.6) 
2
2 2
0 0
( )
sin 0
( ) cos ( ) cos
0 0 0
N
E E
rr
v
h M h
v vF
h N h N h
h h h
h
ϕ ϕ ϕ
ϕ λ
ϕλ λ λ
ϕ λ ϕ ϕ
ϕ λ
⎡ ⎤ ⎡ ⎤∂ ∂ ∂ −⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥∂ ∂ ∂ +⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥−∂ ∂ ∂⎢ ⎥ ⎢ ⎥= =⎢ ⎥ ⎢ ⎥∂ ∂ ∂ + +⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥∂ ∂ ∂⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥∂ ∂ ∂⎢ ⎥ ⎣ ⎦⎣ ⎦
  
  
  
 (4.7) 
         
1 0 0
10 0
( )cos
0 0 1
N E D
rv
N E D
N E D
v v v M h
F
v v v N h
h h h
v v v
ϕ ϕ ϕ
λ λ λ
ϕ
⎡ ⎤∂ ∂ ∂ ⎡ ⎤⎢ ⎥ ⎢ ⎥⎢ ⎥∂ ∂ ∂ ⎢ ⎥+⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥∂ ∂ ∂⎢ ⎥= = ⎢ ⎥⎢ ⎥ ⎢ ⎥∂ ∂ ∂ +⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥−⎢ ⎥∂ ∂ ∂ ⎢ ⎥⎢ ⎥ ⎢ ⎥⎣ ⎦⎢ ⎥∂ ∂ ∂⎣ ⎦
  
  
  
 (4.8) 
z 速度誤差方程 
參考(4.2)式，速度誤差方程的估算形式可以表示為： 
 ˆˆ ˆ ˆˆ ˆ(2 )l l b l l l lb ie elv C f vω ω γ= − + × +  (4.9) 
上述方程式經擾動後產生： 
 - 43 - 
 
 
(2 ) ( )( )
( ) ( )
n l l l l l
ie el r v
l l l l
r v
v v r v
v r v v
δω δω δ δ δ δ
δ δ δ δ
× + = × Ω + Ω
= × Ω + × Ω
 (4.16) 
其中， 
 
tan 0
tan( ) 0 0
0
D E
l ND
v
N E
v v
M h N h
vvv
N h N h
v v
M h N h
ϕ
ϕδ
⎛ ⎞− ⎟⎜ ⎟⎜ ⎟⎜ + + ⎟⎜ ⎟⎜ ⎟⎜ ⎟⎜ ⎟⎟⎜× Ω = + ⎟⎜ ⎟⎜ + + ⎟⎜ ⎟⎜ ⎟⎜ ⎟− −⎜ ⎟⎟⎜ ⎟⎜⎝ ⎠+ +
 (4.17) 
        
2
2
2 2
2
2 2
2
22
2 2
2 cos
tan0
( ) ( )
( ) cos
2 ( cos sin )
tan( ) 0
( ) ( )
( ) cos
2 sin 0
( ) ( )
E e
N D E
E
e N D
l N EE D
r E N
NE
E e
v
v v v
v
M h N h
N h
v v
v vv vv v v
N h N h
N h
vvv
N h M h
ω ϕ
ϕ
ϕ
ω ϕ ϕ ϕδ
ϕ
ω ϕ
⎛ ⎞− ⎟⎜ ⎟⎜ − ⎟⎜ ⎟+⎜ ⎟⎜ ⎟− + +⎜ ⎟⎜ ⎟+ ⎟⎜ ⎟⎜ ⎟⎜ ⎟⎜ − ⎟⎜ ⎟⎜ ⎟−⎜ ⎟⎟⎜× Ω = − ⎟⎜+⎜ + +⎜ +⎜⎜⎜⎜⎜⎜ +⎜⎜ + +⎜⎜⎜⎜⎝ ⎠
⎟⎟⎟⎟⎟⎟⎟⎟⎟⎟⎟⎟⎟⎟⎟⎟
 (4.18) 
於當地水平坐標系（l-frame）中，重力向量 lg 是以正常重力γ近似表示，
[ ]0 0 Tlg γ= ，且γ隨高度變化。假設有一個球狀的地球模型且其簡化的倒
數平方重力模型給定如下 (Rogers, 2003)： 
 20 ( )
R
R h
γ γ=
+
 (4.19) 
(4.19)式中， 0γ 為在 h=0 且R MN= 下的正常重力。擾動上述方程得到： 
 2( ) h
R h
γδγ δ=
+
 (4.20) 
    利用公式(4.12)～(4.20)，速度誤差方程可改寫為： 
 ( )l l l l l l bvr vv bv F r F v f C fδ δ δ ε δ= + + × +  (4.21) 
其中， 
 - 45 - 
 
( ) ( ) ( )
( ) ( ) ( ) ( )
( ) ( ) ( )
( ) ( ) ( )
l l l l l l b b b b
b b b ib il ib il
l l b b l l b b
b ib il b ib il
l l b l l b b
b nb b ib il
l l l l b b
b b ib il
E C I E C I E C
I E C I E C
I E C I E C
I E C I E C
δ δ
δ δ
δ δ
δ δ
− + − = − Ω −Ω + Ω − Ω
= − Ω −Ω + − Ω − Ω
= − Ω + − Ω − Ω
= − + − Ω − Ω


 (4.25) 
上述方程式等號兩邊同時消去 ( )l lbI E C−  ，可得到： 
 ( ) ( )l l l l b bb b ib ilE C I E C δ δ− = − Ω − Ω  (4.26) 
然後結合一次項，於是上述方程式可改寫為： 
 ( )l b b bb ib il lE C Cδ δ= − Ω − Ω  (4.27) 
若以向量形式表示，則可以下列公式表示： 
 ( )l l b bb ib ilCε δω δω=− −  (4.28) 
    為了得到 bibwδ ，可以從 ˆˆ ˆb b lil l i lC=ω ω 著手開始，其展開結果如下： 
( )( )b b b l l lil il l il ilC I Eω δω ω δω+ = + +                          
上述方程式之一次項為： 
 ( ) ( )b b l l l b l l lil l il il l il ilC E Cδω δω ω δω ε ω⎡ ⎤= + = + ×⎢ ⎥⎣ ⎦  (4.29) 
將公式(4.29)代入公式(4.28)： 
 
( )
( )
l l l l l b
il il b ib
l l l l b
il il b ib
C
C
ε δω ε ω δω
δω ω ε δω
= + × −
= − × −

 (4.30) 
下一個步驟為將上述方程式等號右邊第一項展開為速度與位置誤差項，則姿態誤
差方程可改寫為： 
 ( )l l l l l l ber ev il b ibF r F v Cε δ δ ω ε δω= + − × −  (4.31) 
 - 47 - 
 
 22d dβ βσ=− +  (4.37) 
 
2
2
2
20 0
0 0 2 ( )
0 0 2
x x
x xx
b
y y y y y
z z y
y y
w t
β σδω δωβ
δω δω β δω β σ
δω β δω β σ
⎡ ⎤⎡ ⎤ ⎢ ⎥⎡ ⎤ ⎡ ⎤− ⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥= = − +⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥−⎢ ⎥ ⎢ ⎥⎣ ⎦ ⎣ ⎦ ⎣ ⎦ ⎢ ⎥⎣ ⎦

 

 (4.38) 
(4.36)與(4.38)式中，α和 β是相關時間，其定義可參考 (Rogers, 2003)；而 2σ 是
系統方差。對於低成本的慣性系統有時會以白噪聲取代一階高斯馬可夫。關於不
同的 INS 隨機誤差模型的細節可參考(Nassar, 2003)。 
因此，帶有 15 個誤差狀態的連續一階微分方程可以下列公式表示： 
 ( ) ( ) ( ) ( ) ( )x t F t x t G t w tδ δ= +  (4.39) 
其中 
0 0 0
( ) 0
( ) 0
0 0 0 0
0 0 0 0
rr rv
l l
rv vv b
l l
er ev il b
F F
F F f C
F F F Cω
α
β
⎡ ⎤⎢ ⎥⎢ ⎥×⎢ ⎥⎢ ⎥= − × −⎢ ⎥⎢ ⎥⎢ ⎥−⎢ ⎥⎢ ⎥−⎣ ⎦
 
l
l
l
b
b
r
v
x
f
δ
δ
δ ε
δ
δ ω
⎡ ⎤⎢ ⎥⎢ ⎥⎢ ⎥⎢ ⎥⎢ ⎥= ⎢ ⎥⎢ ⎥⎢ ⎥⎢ ⎥⎢ ⎥⎣ ⎦
，
2
2
0
0
0
2
2
G
ασ
βσ
⎡ ⎤⎢ ⎥⎢ ⎥⎢ ⎥⎢ ⎥
= ⎢ ⎥⎢ ⎥⎢ ⎥⎢ ⎥⎢ ⎥⎢ ⎥⎣ ⎦
  
但在計算時必須將連續方程轉換成離散形式，詳細推導於下一小節介紹。 
4-3.2 離散的時間系統 
擴展的卡曼濾波是目前常用的非線性濾波算法之一。其基本概念就是將非線
性系統線性化，然後採用標準的卡曼濾波器算法進行迭代濾波。INS 誤差模型和
感測器誤差模型的結合可用線性化連續的時間系統形式來表示，公式如下： 
 ( ) ( ) ( ) ( ) ( )x t F t x t G t w tδ δ= +  (4.40) 
 - 49 - 
 
    1 1
1 1
1 1
1 1
[ ]
( , ) ( ) ( ) ( , ) ( ) ( )
( , ) ( ) ( ) ( ) ( ) ( , )
k k
k k
k k
k k
T
k k k
Tt t
k kt t
t t T T T
k kt t
Q E w w
E t G w d t G w d
t G E w w G t d d
+ +
+ +
+ +
+ +
=
⎧ ⎫⎪ ⎪⎡ ⎤ ⎡ ⎤⎪ ⎪= Φ ξ ξ ξ ξ Φ η η η η⎢ ⎥ ⎢ ⎥⎨ ⎬⎪ ⎪⎢ ⎥ ⎢ ⎥⎣ ⎦ ⎣ ⎦⎪ ⎪⎩ ⎭
⎡ ⎤= Φ ξ ξ ξ η η Φ η ξ η⎢ ⎥⎣ ⎦
∫ ∫
∫ ∫
 (4.46) 
上述方程式的梯形整合得到 (Maybeck, 1994a)： 
        
1 1 1 1
1 ( ) ( ) ( ) ( ) ( ) ( )
2
T T T
k k k k k k k k k kQ G t Q t G t G t Q t G t t+ + + +⎡ ⎤≈ Φ Φ + Δ⎢ ⎥⎣ ⎦  (4.47) 
假設 ( ) ( ) ( )TG t Q t G t 在時刻( ), 1k kt t + 間可視為常數，那麼上述方程式可以獲
得一個近似解(Maybeck, 1994a)，結果如下： 
          
1
1 ( ) ( ) ( ) ( ) ( ) ( )
2
T T T
k k k k k k k k k kQ G t Q t G t G t Q t G t t +⎡ ⎤≈ Φ + Φ Δ⎢ ⎥⎣ ⎦  (4.48) 
4-3.3 線性化觀測模型 
卡曼濾波器的推導始於隨機處理模型和以下的觀測方程： 
 k k k kz H x vδ = δ +  (4.49) 
(4.49)式說明於時刻 kt 下，觀測值向量 kzδ 以狀態向量 kxδ 和隨機觀測誤差 kv 的
線性組合表示之 (Gelb, 1974；Brown and Hwang, 1992)。設計矩陣 kH 定義為： 
 [ ]
| 1ˆ
k
k k
h x
H
x xx −
∂
=
=∂  (4.50) 
其中， [ ]h x 為狀態的非線性觀測方程。觀測值的協變方矩陣為： 
 ,
0,
kT
k i
R i k
E v v
i k
⎧ =⎪⎪⎡ ⎤=⎨⎢ ⎥⎣ ⎦ ⎪ ≠⎪⎩
 (4.51) 
系統噪聲 kw 和觀測噪聲 kv 假設為不相關，即： 
 0, ,Tk iE w v i k⎡ ⎤= ∀⎢ ⎥⎣ ⎦  (4.52) 
以線性化 GPS 觀測模型為例，詳細推導與說明參考(Eun-Hwan Shin, 2005)。位置
誤差方程表示如下： 
 - 51 - 
 
而在觀測值更新方面，首先要計算出卡曼增益矩陣（Kalman gain）， kK ，
然後利用預測得到之估值 | 1ˆk kx −δ 和其協變方 | 1k kP − 來更新狀態與誤差協變方。其
表示如下： 
 1| 1 | 1( )T Tk k k k k k k k kK P H H P H R −− −= +  (4.60) 
 | | 1 | 1ˆ ˆ ˆ( )k k k k k k k k kx x K z H x− −δ = δ + δ − δ  (4.61) 
 | | 1( )k k k k k kP I K H P −= −  (4.62) 
或以下列形式表示： 
 
1( )
ˆ ˆ ˆ( )
( )
T T
k k k k k k k
k k k k k k
k k k k
K P H H P H R
x x K z H x
P I K H P
− − −
− −
−
⎧⎪ = +⎪⎪⎪⎪δ = δ + δ − δ⎨⎪⎪⎪ = −⎪⎪⎩
 (4.63) 
整個卡曼濾波器的運作過程如下圖所示。 
 
圖 4-6 卡曼濾波器運作流程圖 
4-3.5 整合 IN/GNSS 卡曼濾波器 
z 鬆耦合整合系統 
以 15 個狀態參數的 INS/GNSS 鬆耦合閉合式卡曼濾波器為例，這些誤差狀
態包括三個位置參數 3 1
lrδ × 、三個速度參數 3 1lvδ × 、三個姿態參數 3 1ε × 、三個加速
計偏差參數 3 1ab × 和三個陀螺漂移參數 3 1gb × ，表示如下： 
 - 53 - 
 
 1 0
0 1G
G ⎡ ⎤= ⎢ ⎥⎣ ⎦  (4.71) 
 0
0G
wb
w
wd
⎡ ⎤= ⎢ ⎥⎣ ⎦  (4.72) 
wb及wd 分別被視為白噪聲。結合兩組動態方程，可以得到完整的緊耦合系統
的動態方程： 
 0 0
0 0
I I I I I
G G G G G
x F x G w
x F x G w
δ δ
δ δ
⎡ ⎤ ⎡ ⎤ ⎡ ⎤ ⎡ ⎤ ⎡ ⎤= +⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥⎣ ⎦ ⎣ ⎦ ⎣ ⎦ ⎣ ⎦ ⎣ ⎦
 (4.73) 
在緊耦合系統的觀測量方面，GNSS 的虛擬距離觀測量與 INS 推導出的距離差值
被當作觀測向量 Zδ ，其中 INS 推導的距離如下： 
 ( ) ( ) ( )2 2 2, , , ,INS k I s k I s k I s kx x y y z zρ = − + − + −  (4.74) 
其中， ( )I I Ix y z 為 INS 所算出的載體三軸在地心地固參考框架的坐標，而( ), , ,s k s k s kx y z 為第 k 顆衛星的地心地固參考框架的坐標，可以從星曆中計算
得到。 
GNSS 的虛擬觀測量可以以下列方程式表示： 
 ,GPS k k kr C tb nρρ δ= + +  (4.75) 
kr 是第 k 顆衛星到達地面接收器的真實距離，C 為光速， tbδ 為接受器的時錶偏
差， knρ 隨機誤差。 
假設收到 m 顆的衛星觀測量，觀測方程式可寫成： 
 
,1 ,1
,2 ,2
, 3 1 , 1
, ,
INS GPS
INS GPS
m m m
INS m GPS m
Z H tb n
h
ρ ρ ρ
ρ ρ δϕρ ρδ δλ δ
δρ ρ
× × ×
−⎛ ⎞ ⎛ ⎞⎜ ⎟− ⎜ ⎟⎜ ⎟= = + +⎜ ⎟⎜ ⎟ ⎜ ⎟⎜ ⎟ ⎝ ⎠⎜ ⎟−⎝ ⎠
#  (4.76) 
其中，Hρ 為設計矩陣。 
 
 - 55 - 
 
5-2 觀測量模擬器 
 
 經由路徑模擬器所產生出的“真實＂路徑資料後，其中包含了各點位的坐
標、速度及姿態角的訊息。而總資料量取決於使用者的定義，通常在模擬一軌跡
的時候，會模擬出與 IMU 資料輸出率相同的資料量，如欲模擬的 IMU 資料為
100 筆每秒的話，路徑模擬器也必須以同樣的頻率輸出路徑資訊，而觀測量模擬
器就依路徑資訊產生所對應的觀測量。然而 GNSS 的觀測量目前市面上的最高取
樣頻率為 50Hz，這也可以由使用者自訂。因此，GNSS 觀測量模擬器也可以用
以測試新的高頻 GNSS 演算法。 
在觀測量模擬器的部分又可以細分成兩部分：INS 觀測量模擬器及 GNSS 觀
測量模擬器。以下會分別討論此兩種觀測量模擬器的運作過程及其所運用的原
理，另外是結果部分。 
 
5-2.1 INS 觀測量模擬器 
  
一般來說，INS 觀測量模擬器是慣性導航方程式的逆推導。IMU 所量測到的
三軸加速度及角速度，可以藉由路徑模擬器所產生的“真實＂載體位置、速度及
姿態角推算得到。其目的是得到虛擬的捷聯式 IMU 在 b-frame 上所測得的訊號，
依照使用者所給定的參數，如加速度計及陀螺的偏差量、漂移量級尺度因子，可
以設計出各種不同等級的 IMU 訊號，全是依使用者的需求而定。而諸如訊號雜
訊、地球自轉及重力的影響也會被考慮進來，以求能夠更貼近真的 IMU 觀測量。
圖 5-2 說明了整個 INS 觀測量模擬器運作的原理。 
 
 
圖5-2 IMU觀測量模擬器示意圖(Yang, 2008) 
 
由於路徑模擬器中產生的載體速度同常是以當地水平坐標做為參考，而 IMU
的觀測量是以載體坐標 b-frame 相對於慣性參考框架 i-frame 的變化，因此之間也
牽扯到了坐標轉換的關係。可以把整個 IMU 模擬的加速度觀測量寫成下列方程
式： 
 ( )2b b l l bl l lieib l el ibf R v v g fω ω δ⎡ ⎤= + + × − +⎣ ⎦  (5.1) 
b
ibf 為模擬的加速度觀測量，其為在載體坐標系下相對於慣性坐標系的力。 blR 為
當地水平坐標系統與載體坐標系的轉換矩陣。 lv 為當地水平坐標下的加速度，
由於在路徑模擬器中，使用者已經將加速度視為輸入量，因此在這為已知。
 - 57 - 
 
機誤差兩分面來討論。對於一個高等級的 IMU 來說，製造的廠商會在產品出廠
前先做好了 IMU 的系統誤差定義，可以藉由一連串的實驗得到 IMU 誤差參數，
諸如：加速度計的偏差量、陀螺儀的漂移量及各別的尺度因子等等，又由於系統
本身的穩定度，所以在處理高等級的 IMU 時，其中只存在些許的隨機誤差。但
對於較低成本的 IMU，如 MEMS 等級的 IMU，由於組成的系統晶片較高成本的
來得不穩定，因此會造成許多的額外誤差，且系統誤差也變得較不穩定，因此要
模擬低成本的 IMU 必須考量多項的誤差來源。圖 5-4 為將模擬觀測量加上誤差
因子的示意圖。 
 
 
圖 5-4 觀測量誤差模擬示意圖 
在本研究當中，系統性誤差包含了感測器的偏差量、尺度因子、尺度因子的
非線性誤差、感測器的三軸非正交性等等，諸如此類的系統性誤差可以藉由實驗
室或製造廠商大致地訂出，在 IMU 的資料被用於 INS 導航方程式時，都必須先
經過這些系統性誤差的粗略改正。在隨機誤差的設計方面，其中包含了角度的隨
機誤差、速度的隨機誤差及尺度因子隨著溫度的改變而造成的偏差。大致上，有
三種數學模式可以用來模式化此類的 MEMS 等級 IMU 所產生的隨機誤差，隨機
常數 random constant、隨機走勢 random walk 及一階高斯馬可夫模型(Shin, 
2005)。表 5-1 列出了三種不同的數學模型。 
表 5-1 三種的隨機數學模型 
隨機處理
( )x t  
連續時間方程 離散時間方程 變數 
隨機常數 ( ) 0x t =  1k kx x+ =  無 
隨機走勢 ( ) ( )x t w t=  1k k kx x w+ = +  kw 為白噪聲 
一階高斯馬
可夫 ( ) ( ) ( )1x t x t w tβ= − +  
1
1
kt
k k kx e x wβ
+Δ
+ = +  k
w 為 白 噪
聲，β 為相關
時間， 1kt +Δ
為時間間隔 
 如圖 5-4 所示，其為產生出的無誤差 IMU 觀測量，在這以模擬一戰術等級
的 IMU 作為列子，各種誤差因子如表 5-2，而所模擬出的“真實＂觀測量與無誤
差的觀測量之間的差值，在圖 5-5 中顯示。 
 - 59 - 
 
交點赤經(Ω)、平近地點角(E)，計算出衛星軌道與衛星分佈位置，提供未來模擬
衛星分佈位置與衛星誤差之資訊。圖 5-7 為克卜勒衛星軌道示意圖。 
 
圖 5-7 克卜勒軌道示意圖(Misra and Enge, 2001) 
由於真實衛星軌道離心率非常小(小於 0.01)，故國外相關軟體模擬器發展的
經驗建議可以選擇圓形軌道取代橢圓軌道(Luo, 2001)，將離心率與近地點設為
零，故只需要四個參數，可以簡化計算模擬衛星位置及速度之計算。衛星在軌道
面的位置可由(5.4)式計算得，式中 r 為圓形軌道之半徑。而 E 可視為平近點角，
藉由(5.5)式計算得，式中 E0 為參考時刻 t0 之平近點角。 
 
0
0 0
0
cos
sin
0
x E
r y r E
z
⎡ ⎤ ⎡ ⎤⎢ ⎥ ⎢ ⎥= =⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥⎣ ⎦⎣ ⎦
 (5.4) 
 0 0( )E E n t t= + −  (5.5) 
n 為衛星之角速度，在圓形軌道中該值為常數。該值可由(5.6)式求得。 
 
3
EGMn
r
=  (5.6) 
式中 G 為萬有引力常數，而 ME 為地球質量。一般使用者皆是在地球觀測衛星，
故吾人必須將軌道坐標由慣性坐標轉換成如 WGS-84 之地固坐標系統。 
 0er Rr=  (5.7) 
 0er Rr=   (5.8) 
(5.7)與(5.8)式中的 re與 er 分別為衛星在 WGS-84 坐標系統之位置與速度向量，而
 - 61 - 
 
User position
in ECEF
User position
in LLA
User time
in UTC
User time
in GPS
Position convert
LLA → ECEF
Time convert
UTC → GPS
Line of sight
(LOS) vectors
from user
position to
healthy satellites
Satellite positions
in ECEF and
time in GPS
LOS vectors
converter
ECEF → LLA
DOP
Masking
Visibility/
elevation
LLA: Longitude, Latitude, Altitude  
圖 5-9 性能指標計算流程圖(Chiang et al., 2006) 
完成所有衛星位置設定後，系統可提供使用者選擇單一或雙系統，模擬範圍
選擇單點或區域做檢測，檢測單一時刻或時段內之衛星分佈圖(圖 5-10)、衛星運
行軌跡(圖 5-11)、衛星可視數量、DOP 值等性能分析指標計算。 
東西
北
南
3
6
916
18
19
20
22
7
 
圖 5-10 經度 119 度，緯度 21 度可視衛星分布狀況 
 
圖 5-11 衛星運行軌跡 
5-4 最佳狀態估算器 
在 INS/GNSS 整合系統當中，最佳狀態估算器為最主要的部分。其負責解算
 - 63 - 
 
Accelerometers 
(△ v)
Gyroscopes      
(△ θ)
GPS 
Corrections 
Corrections 
INS KF 
(ρ or ψ )
Gravity 
Positions
Velocities
Attitudes∫
∫ ∫
 
圖 5-13 緊耦合整合架構 
5-5 RTS 平滑器 
RTS 平滑器全名為 Rauch-Tung-Striedel 平滑器，發表於 1965 年，就在卡曼
博士與 1960 年發表其卡曼濾波器後。卡曼濾波器為一種遞迴式的最佳估算器，
依據當下及過去含有噪聲的觀測量，用以估算線性或非線性動態系統的最佳狀
態。與卡曼濾波器做比較，RTS 平滑器同樣也是估算動態系統的最佳狀態，但所
考慮的觀測量為現在、過去及未來。也因此，RTS 平滑器並不能如卡曼濾波器一
般運用在及時處理，只能在後處理端應用。在一個 INS/GNSS 整合系統中，運用
RTS 平滑器可以大幅減低因為 GNSS 衛星訊號失鎖所造成的平面誤差，如此的
應用非常適合只需要將導航資訊做後處理的測量工程。 
RTS 平滑器可視為卡曼濾波器的附加應用。一個完整的 RTS 平滑器運作可
分為兩個步驟，第一步需運用卡曼濾波器，並記錄每個時間點的狀態向量、變方
及協變方。在第二步，演算法將會處理在第一步所記錄的資料，以一種反向的方
式處理，平滑器這時會估算出另外一組新的狀態參數，圖 5-15 為 RTS 平滑器的
運作過程，圖的上方表示一往計算的估算器，如卡曼濾波器，而下方則表示反算
的部分，如 RTS 平滑器。圖 5-15 中也清楚的指出參予平滑器計算的各種資料。 
 
 
圖 5-15 RTS 平滑器運作過程 
 - 65 - 
 
第六章 成果 
 
 本章節將展示此模擬器的成果；包括模擬的路徑、虛擬的觀測量、最佳估算
器的作用以及應用在後處理和高精度要求的 RTS 平滑器。 
 
6-1 操作介面 
 
 模擬器為了讓使用者更容易使用，因此在 MATLAB 的環境下設計了一個簡
單的操作介面。使用者可以在此鍵入欲使用的 IMU 參數設定，諸如加速度計偏
差量和陀螺飄移量等。藉由參數的設定，可以模擬出不同等級的 IMU，以符合
各種不同應用的需求。操作介面裡的路徑選擇為內建的，當然，使用者也可以自
行規劃所需要模擬的路徑。因為應用層面的不同，取樣頻率也包含在操作介面
中，一般標準的 IMU 取樣頻率約介於 100~200Hz 之間，但 MEMS 等級的 IMU
通常有可能為較低的輸出頻率，所以這裡提供了自行輸入的功能。圖 6-1 為操作
介面圖示。 
 
圖 6-1 模擬器操作介面 
6-2 模擬路徑 
  
 本段落以一個 1480秒的模擬路程做為接下來的 IMU及GNSS觀測量模擬的
依據。模擬的過程包括了等加速度直線運動、等速度直線運動、等角速度運動等，
且包含了多次的轉彎，以測試模擬觀測量及最佳狀態估算器是否合乎理論。且路
徑的座標系統包括了地心地固系統、大地座標系統及當地水平座標系統，各座標
系統間存在著特定的轉換關係，因此在路徑上的點位可以輸出使用者希望的座標
表示方式。圖 6-2 為模擬的路徑。 
 - 67 - 
 
 
圖 6-4 模擬的陀螺儀輸出 
 
圖 6-5 模擬 GNSS 位置解 
6-4 INS/GNSS 整合導航解 
 
 INS/GNSS 的整合系統之優缺點已於前述章節中說明，在此就不另行贅述。
以下將展示模擬路徑的整合導航解以及其與無誤差的資料比較。首先，圖 6-6 為
完整路徑的整合定位解，黑色框為局部放大圖。期間 GNSS 不斷地提供穩定及可
靠的位置解，而整合方式採用 INS/GNSS 鬆耦合方式，其整合卡曼濾波器包含
15 個狀態參數，因 GNSS 的幫助，使得整合定位解一直落在可接受的範圍內，
而 INS 的作用能在兩個 GNSS 的位置解之間仍然提供穩定的位置、速度及姿態
解算。而圖 6-7 為整個路徑的平面位置誤差，參考系統為模擬的真實點位，rms
為 0.3783 公尺，比單純的 DGPS 位置精度(rms：0.5 公尺)還來得好。如先前所提
到的，鬆耦合整合方式與緊耦合整合方式在導航衛星訊號良好下，其導航定位解
並無太大差異，因此這裡只圖示出鬆耦合系統的位置解。而鬆耦合與緊耦合的比
較將在之後介紹。 
 - 69 - 
 
顯而易見地，當失去衛星訊號時，鬆耦合整合系統在平面的誤差會瞬間拉
高，但依舊在可接受的範圍內，這表示本研究所設計的最佳狀態估算器為合理的
設計，可符合 INS/GNSS 整合系統的要求。而圖 6-9 為相同情況但架構為緊耦合
系統，由於衛星訊號失鎖的情況是假設完全無可視衛星數，所以緊耦合系統在此
無法明顯地看出與鬆耦合系統的差別。 
 
圖 6-9 緊耦合在四段 60 秒衛星訊號失鎖的平面誤差 
圖 6-8 及圖 6-9 中的綠色線條表示在 RTS 平滑器的應用後，平面位置的誤
差。由圖表上可見，當 RTS 平滑器被應用在處理導航訊息時，可以大幅減少誤
差的產生，但由於演算法的關係，RTS 平滑器只能使用在後處理，這對於一些不
需要及時處理導航訊息的工程應用有很大的幫助，例如測量工程。表 6-1 及表 6-2
分別為圖 6-8 及圖 6-9 中四段衛星訊號失鎖的情況，EKF 在鬆耦合、緊耦合及
RTS 平滑器個別的平面誤差 RMS 比較表。 
 
表 6-1 衛星訊號失鎖時的 RMS(鬆耦合) 
         時段 
系統 1 2 3 4 
EKF-鬆耦合 1.51m 0.66m 0.67m 1.37m 
RTS 平滑器 0.28m 0.13m 0.08m 0.15m 
 
表 6-2 衛星訊號失鎖時的 RMS(緊耦合) 
         時段 
系統 1 2 3 4 
EKF-緊耦合 1.42m 0.42m 0.81m 0.99m 
RTS 平滑器 0.18m 0.08m 0.09m 0.10m 
 
由上述兩表中不難發現當衛星訊號完全失鎖時，鬆耦合及緊耦合的系統所能
提供的平面位置解，其精度是差不多的。在鬆耦合的系統中，一但可視衛星少於
四顆，亦及無法提供衛星的導航解，這在都市地區會造成相當地不便。由於有時
也許可以收到一顆以上四顆以下的衛星，但仍然對鬆耦合系統毫無幫助。這個問
題在緊耦合的架構下可以被解決。圖 6-10 為緊耦合架構在只能觀測到三顆衛星
時的平面誤差。圖 6-11 為可視衛星數量持續遞減至零的過程，緊耦合系統在平
 - 71 - 
 
 
圖 6-12 在可視衛星數遞減的情形下鬆耦合與緊耦合的比較 
 在INS/GNSS的整合架構下，負責整合的卡曼濾波器參數調校一直是個重要
的課題，參數設定的正確與否會決定系統的效能表現，未經調校或不適當的系統
雜訊協變方矩陣(Q)與觀測量雜訊矩陣（R）皆會影響整合式系統的定位精度，圖 
6-13與圖 6-14分別顯示不同量級Q矩陣對定位誤差之影響。 
 
 
圖 6-13 未調校的 Q 矩陣 
 
圖 6-14 調校後的 Q 矩陣 
在持續有 GNSS 導航解的更新下，因為參數調校不當所顯示的定位誤差並不
容易察覺；唯有透過研究整合系統於 GNSS 訊號遮蔽期間定位之誤差累積才得以
 - 73 - 
 
 
圖 6-17 福德隧道 
 
 
圖 6-18 雪山隧道 
 
 
 
 
 
 
 
 
 
 - 75 - 
 
Symposium on 
GPS/GNSS 2008, 
November 11-14, 
Tokyo, Japan 
Simulation Platform for 
INS/GNSS Integrated 
Systems, 
11 地籍測量學刊 GNSS 於台灣地區效
能分析  
蔡孟倫、江凱
偉、楊名 
已發表 
 
12 航測及遙測學刊 The Accuracy and 
Reliability Analysis for 
Future GNSS in Taiwan 
Region 
蔡孟倫、江凱
偉、楊名、陳鶴
欽 
已發表 
13 Journal of the 
Chinese Institute of 
Engineers (SCI) 
The performance 
comparison between GPS 
and BeiDou-2/Compass: 
A perspective from Asia 
Chen, H.C, 
Huang, Y.S., 
Chiang, K.W., 
Yang, M., and 
Rau, J.Y.(2008): 
已接受 
14 GPS Solutions (SCI) An ANN-RTS Smoother 
Scheme for Accurate 
INS/GPS Integrated 
Attitude Determination  
Chiang K.W., 
Lin,Y.C., Huang 
Y.W★ and 
Chang H.W 
已接受 
15 GPS Solutions (SCI) 
GPS solutions, 
Volume: 12   Issue: 
2   Pages: 135-146  
A Truly Intelligent and 
Autonomous SPP/MEMS 
IMU Integration Scheme 
for Land Applications. 
Chiang, K. 
W★ , Huang 
Y.W 
已發表 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 - 77 - 
 
參考文獻 
 
1. 楊名及江凱偉(2007), 全球衛星導航系統(GNSS)聯合資料處理技術期
末報告，內政部土測局。 
2. Yang, Y., El-Sheimy, N., Goodall, C., and Niu, X. (2007) IMU Signal 
Software Simulator, ION NTM 2007, San Diego, CA 
3. Shin, E.H. (2005): Estimation Techniques for Low-Cost Inertial Navigation, 
(PhD. thesis), May. 2005, UCGE Report No. 20219. Department of 
Geomatics Engineering, The University of Calgary. 
4. Bennour, Z., Landry, R. Jr., Giroux, R. Constantinescu, A., and Gavidia, 
G.(2005). Wed-Based MEMS Inertial Navigation Simulator, ION 61st Annual 
Meeting 2005, Cambridge, MA 
5. Chiang, K.W. (2004): INS/GPS Integration Using Neural Networks for Land 
Vehicular Navigation Applications, Department of Geomatics Engineering, 
The University of Calgary, Calgary, Canada , UCGE Report 20209 
6. Hide, C. and Moore, T. (2004): Low Cost Sensors, High Quality Integration. 
7. Hide, C. and Moore, T. (2004): GPS and Low Cost INS Integration for 
Positioning in the Urban Environment. 
8. El-Sheimy, N. (2004a): Inertial Techniques and INS/DGPS Integration, 
ENGO 623 lecture notes, Department of Geomatics Engineering, The 
University of Calgary. 
9. Misra, P. and Enge, P. (2001): Global Positioning System : Signals, 
Measurements, and performance, Ganga-Jamuna Press,Massachusetts,2001. 
10. O'Keefe, K. (2001): Availability and Reliability Advantages of GPS/Galileo 
Integration. Proceedings of the US Institute of Navigation (ION) GPS’2001 
meeting, Salt Lake City, September 11-14, 2002 -, USA (CD). 
11. Shin, E.H. (2001): Accuracy Improvement of Low Cost INS/GPS for Land 
Application, (M.Sc. thesis), Dec. 2001, UCGE Report No. 20156. 
Department of Geomatics Engineering, The University of Calgary. 
12. Savage, P.G.(2000): Strapdown Analytics Part I ,II, Strapdown associate  
13. Titterton, D. H. and Weston, J. L. (1997): Strapdown Inertial Navigation 
Technology, Peter Peregrinus Ltd. 
14. Parkinson, B.W., Spilker, J.J., Axelrad, P., and Enge, P. (1996): GPS: Theory 
and Application Vol I, II, American Institute of Aeronautics and Astronautics.  
15. Brown R.G. and Hwang P.Y.C. (1992): Introduction to random signals, John 
Wiley and Sons, New York, 1992. 
 
 - 79 - 
 
附件 
 
    本研究成果已發表 EI 等級以上之論文列為本報告之附件。 
 
growing positional errors caused by INS based systems is
preferred (Chiang et al. 2004).
The Kalman filtering (KF) approach has been widely
recognized as the standard optimal estimation tool for
current INS/GPS integration schemes (Gelb 1974); how-
ever, it does have limitations that have been reported by
several researchers (Brown and Hwang 1992; Vanicek and
Omerbasic 1999; Chiang et al. 2004; El-Sheimy and Ab-
del-Hamid 2004). Several alternative integration schemes
have been investigated using different approaches such as
Artificial Intelligence, particle filtering, wavelet multi-res-
olution, adaptive KF, and unscented KF (Ojeda and
Borenstein 2002; El-Sheimy and Abdel-Hamid 2004).
Chiang and El-Sheimy (2002) and Chiang et al. (2003)
first suggested an INS/GPS integration architecture using
the multi-layer feed-forward neural networks (MFNN) for
fusing data from differential GPS (DGPS) and either nav-
igation grade IMUs or tactical grade IMUs. Moreover,
Chiang and El-Sheimy (2004) introduced the idea of
developing the conceptual intelligent navigator using arti-
ficial neural networks (ANN) for next generation land
vehicular navigation and positioning applications. How-
ever, Chiang et al. (2004) indicated that the major limita-
tion of applying the MFNN for alternative INS/GPS
integration scheme lies in determining the optimal topol-
ogy, its effect on the learning time during the update pro-
cedure and its effect on the prediction accuracy during GPS
signal outages. Once the topology is decided, the synaptic
weights are adjusted in a network with a fixed topology.
Limiting factors of MFNN
According to Chiang et al. (2004), the complexity of
applying the MFNN varies depending on the complexity of
the applications. On the other hand, the complexity of
ANN depends on its topology, which consists of the
number of hidden neurons (size) and hidden layers (depth)
(Ham and Kostanic 2001). The MFNN with an optimal
topology is expected to have the generalization ability and
provide the best approximation accuracy to the unknown
model (Haykin 1999). There are many ways to choose the
appropriate number of hidden neurons (Bishop 1995). The
common principle indicates that the most appropriate
number of hidden neurons is application dependent and can
only be decided empirically during the early stage of
topology design (Mezard and Nadal 1989).
To avoid the limitations of the MFNN, several methods
for successively and automatically constructing a neural
network during the learning process have been proposed
during the last two decades (Alpaydin 1991). In other
words, the networks are able to decide the appropriate
topology based on the task given without human inter-
vention (Alpaydin 1991). Among them, the constructive
neural network (CNN) invented by Fahlman and Lebiere
(1990), has attracted the attention mostly. Therefore, the
objectives of this article are to: (a) develop an intelligent
and autonomous MEMS IMU/GPS integration scheme
using the CNN approach and (b) compare the performance
of developed scheme with both the MFNN and KF-based
schemes in terms of positioning accuracy during GPS
signal outages. Table 1 summarizes the theoretical char-
acteristics of the CNN and MFNN architectures.
The implementation of an intelligent and autonomous
Ins/Gps integration scheme
Chiang and El-Sheimy (2002) proposed a position update
architecture (PUA), as shown in Fig. 1, to fuse the navi-
gation solutions provided by an INS and GPS simulta-
neously bridging navigation gaps during GPS signal
blockages. In PUA, the input neurons process the INS
derived velocity VINSðtÞ and azimuth /INSðtÞ from the INS
mechanization. The output neurons generate the two
dimensional coordinate differences between two consecu-
tive time epochs along the North and East directions
½dNðtÞ and dEðtÞ:. The desired (i.e., the reference) outputs
[dNGPS(t), dEGPS(t)] are provided by GPS during signal
availability in either DGPS or single point positioning
(SPP) mode of operation. Therefore, when GPS is avail-
able, [dNGPS(t), dEGPS(t)] are used as the system outputs.
In this study, a modified PUA is implemented, as shown
in Fig. 2. The topology of MFNN is then replaced by CNN.
The CNN architecture starts with a minimal topology,
consisting only of the input and output neurons (Frean
1990). The optimal values of the direct input–output syn-
aptic weight links are computed during the training proce-
dure using GPS derived coordinate differences as updates.
The first step of CNN training procedures begins with
the minimal topology for the entire training data set until
no further improvement can be achieved. During this
process, there is no need to back propagate the output
Table 1 Theoretical comparison between CNN and MFNN
MFNN CNN
HN Empirical trials OTF
HL Empirical trials OTF
Flexibility
of topology
Fixed OTF
Speed of
learning
Fast using
LM algorithm
Very fast using
quickprop algorithm
HN number of hidden neuron, HL number of hidden layer, LM
Levenberg–Marquardt learning algorithm, OTF on the fly means the
time span during learning process
136 GPS Solut (2008) 12:135–146
123
During the second step of recruitment process shown in
Fig. 4, only a single layer of weights are trained. The
incoming weights of the winning neurons are frozen and
the winner becomes the hidden neuron, which is inserted
into the active network in the second step of recruitment.
The new hidden neuron is then connected to the output
neurons and the weights on connection become adjustable.
All connections to the output neurons are trained. In other
words, the weights connecting the input neurons and the
output neurons are trained again using the quickprop
algorithm. On the other hand, the new weights connecting
the hidden neurons and output neurons are trained for the
first time. Both training steps use the same inputs
VINSðtÞ and /INSðtÞ½  and outputs dNðtÞ and dEðtÞ½ ;
respectively.
The second hidden neuron is then recruited using the
same process, as shown in Figs. 5 and 6. This unit receives
input signals from both input neurons and previous re-
cruited hidden neurons. All weights connecting input
neurons and candidate hidden neurons are adjusted to re-
cruit the second hidden neuron. The values of the weights
are then frozen, as soon as the hidden neuron is added to
the active network, as illustrated in Fig. 5. All the con-
nections to the output neurons are then established and
trained.
The process of recruiting new neurons, training their
weights from the input neurons and previously recruited
hidden neurons, then freezing the weights and training all
connections to the output neurons, is continued until the
error reaches the training error goal or the maximum
number of epochs. The finalized topology shown in Fig. 7
becomes a modified feed-forward neural network with (n)
hidden neurons and (n) hidden layers.
The usage of the CNN for developing an alternative
INS/GPS integration scheme poses several advantages over
Fig. 4 Step 3, the recruitment of first hidden neuron
Fig. 5 Step 4, adding second hidden neuron
Fig. 6 Step 5, the recruitment of second hidden neuron
Fig. 7 Finalized CNN-based PUA
138 GPS Solut (2008) 12:135–146
123
Figure 10a shows the assembly of the sensors used in the
field tests.
The reference trajectories were generated with a navi-
gation grade IMU (Honeywell CIMU) and carrier phase
DGPS (10 cm level positioning accuracy) with a backward
smoothing algorithm. The CIMU can be considered one of
the most accurate IMUs available for civil applications. On
the other hand, since the proposed algorithm integrates a
low cost IMU and GPS in SPP mode, therefore, the ref-
erence trajectories used in this study can be considered
appropriate. The IMU and GPS measurements obtained in
the first and second field tests were used to generate the
stored navigation knowledge (training). The third field test
trajectory was used as the test trajectory for the proposed
scheme.
The first field test is composed of a large loop, see
Fig. 10b. The duration of this field test is 1,200 s. The
second field test (Fig. 10c) consists of a straight line seg-
ment and a large loop. The duration of this field test is
1,000 s.
The stored weights were acquired using measurements
obtained through the first two field tests in the traditional
off-line training mode. As shown in Fig. 11, 16 simulated
GPS outages marked in circles with dot lines from the first
and second trajectories were used to acquire stored
weights. Four of them were 30 s, two of them were 60 s,
and four of them were 120 s. The dynamics variations
experienced by the test vehicle during those outages in-
clude acceleration/deceleration along straight lines, slow
turns and sharp turns. They are considered to be typical
maneuvers that could be experienced by land-vehicles.
Furthermore, the window based weights updating strat-
egy was applied to update the navigation knowledge during
the availability of the GPS signal. It is worth mentioning
that the final topology of the CNN after off-line training
consisted of 41 hidden neurons after applying the two
training trajectories.
Fig. 9 System configuration
Fig. 10 Sensor assembly and
field test trajectories
140 GPS Solut (2008) 12:135–146
123
Figure 12 clearly indicates that the CNN-based scheme
converged twice as fast when compared to the MFNN-based
scheme with the same training dataset and error goal. The
number of recruited hidden neurons was 36, which was less
than the number of hidden neurons decided empirically for
the MFNN-based scheme (50 in this case). Based on the
results presented in Fig. 12, the CNN-based scheme is able to
reach the same training goal with less training time and a
simpler architecture when compared to the MFNN-based
scheme. In addition, the CNN-based scheme distinguishes
itself from the MFNN-based scheme since it can decide its
topology ‘‘on the fly’’ based on vehicle’s dynamic variations
and presented INS sensor errors. Figures 13 and 14 show the
accumulated positional errors for different INS/GPS SPP
integration schemes during several GPS signal outages used
for testing the proposed scheme. Table 4 illustrates the per-
formance summary of all GPS signal outage periods. Only
half of the results are presented in figures (only four outages).
However, Table 4 does show all the results of this study.
Figures 13 and 14 clearly show that the KF positional
errors increase, as the function of the length of the GPS
signal outage period. This time dependent growth is typical
for the KF when operating in prediction mode without GPS
updates. On the other hand, the positional errors of both
PUA methods (MFNN and CNN) behaved differently. In
general, if taking into account the relationship between the
vehicle’s dynamic variations and positional error accumu-
lation, one can see the strong correlation between them
(e.g., significant dynamic variations and large positional
errors). In other words, the error behaviors of the proposed
schemes are affected by the vehicle’s maneuvers. Chiang
et al. (2004) developed a performance analysis index to
study the impact of vehicle’s dynamic variations on posi-
tional error accumulations of PUA (MFNN) and the results
did show similar correlation presented in this study.
As indicated in Table 4, both MFNN and CNN schemes
were able to reduce the positional error during most of the
GPS signal outage periods. Since CNN is one of the vari-
ants of MFNN and both of them were trained with the same
training data sets, it is reasonable that both of them
exhibited similar performance in position domain. The
overall improvements reached 55 and 69%, respectively.
Figures 13 and 14 clearly depict that the KF was able to
provide better positioning accuracy during the first 5–10 s
of GPS signal outage periods in most scenarios by zooming
in Figs. 13 and 14 and looking into the positional error
accumulation for the first 10 s of each outage. In contrast,
both MFNN and CNN schemes outperformed the KF when
the length of the outages extended to 20 s or longer.
In contrast, although the MFNN and CNN schemes
suffered from minor degradations in terms of positional
errors in some scenarios due to the impact of dynamic
variations, they were able to reduce the time dependant
errors and provide relatively stable solutions. As indicated
in Fig. 10d, there were slow but noticeable heading chan-
Table 3 The dynamic variations during test GPS outages
1 2 3 4 5 6 7 8
Length (s) 30 60 30 120 60 120 120 60
Motion Straight
line
(south)
Straight
line
(south)
Straight
line
(south)
Sharp turn
and straight
line (west)
Smooth
turn
Straight line
(south) and
sharp turn
Straight line
and sharp
turn (west)
Straight line
(south-west)
Distance (m) 612 1,260 585 1,800 720 1,750 1,835 1,220
Fig. 12 Learning speed comparison
142 GPS Solut (2008) 12:135–146
123
of observability by feeding the networks using the desired
outputs provided by SPP during the availability of GPS
signal. Once the signal blockage occurs, the proposed
methods are expected to provide compensation to the in-
puts and provide corrected outputs with performance sim-
ilar to the desired outputs during training implicitly.
Conclusions
This study proposed an intelligent and autonomous INS/
SPP integration scheme for low-cost MEMS IMUs using
the CNN. Compared to fixed topology networks, such as
the MFNN, the CNN provide more flexibility. They can
develop alternative schemes and decide upon the network
topology including the size and depth based on the com-
plexity of the application. The intensive empirical trials
needed for the MFNN to decide upon an optimal topology
can be avoided. The results presented in this study dem-
onstrate that the KF-based scheme was able to provide
better positioning accuracy during the first 5–10 s of GPS
signal outage periods in some scenarios when a low-cost
MEMS IMU/SPP system was used. However, due to the
limitations of bias stability and noisy measurements of
MEMS IMUs, the corresponding KF positioning accuracy
degraded rapidly with time. On the other hand, when the
MFNN or CNN schemes were implemented, the results of
KF were improved by more than 55%. Although the per-
Fig. 14 Positional errors during
1st ~ 4th GPS outages
(PUA_MFNN)
144 GPS Solut (2008) 12:135–146
123
Chiang KW, Noureldin A, El-Sheimy N (2003) Multi-sensors
integration using neuron computing for land vehicle navigation.
GPS Solut 6(3):209–218
Chiang KW, El-Sheimy N, Noureldin A (2004) A new weights
updating method for neural networks based INS/GPS integration
architectures. Meas Sci Technol 15(10):2053–2061
El-Sheimy N, Abdel-Hamid W (2004) An adaptive neuro-fuzzy
model to bridge GPS outages in MEMS-INS/GPS land vehicle
navigation. Proceedings of ION GNSS 2004, Long Beach
Fahlman SE, Lebiere C (1990) The cascade learning architecture. In:
Touretzky D (ed) Advances in neural information processing
system 2. Morgan Kaufmann, Denver
Frean M (1990) The upstart algorithm: a method for constructive and
training feed-forward neural networks. Neural Comput 2:198–209
Gelb A (1974) Applied optimal estimation. MIT Press, Cambridge
Ham FM, Kostanic I (2001) Principles of neurocomputing for science
and engineering. McGraw-Hill, New York
Haykin S (1999) Neural networks: a comprehensive foundation, 2nd
edn. Prentice-Hall, New Jersey
Mezard M, Nadal JP (1989) Learning in feed-forward layered
networks: the tiling algorithm. J Phys A Math Gen 22:2191–
2203
Ojeda L, Borenstein J (2002) FLEXnav: fuzzy logic expert rule-based
position estimation for mobile robots on rugged terrain.
Proceedings of the 2002 IEEE international conference on
robotics and automation, Washington
Vanicek P, Omerbasic M (1999) Does a navigation algorithm have to
use Kalman filter? Can Aeronaut Space J 45(3):292–296
146 GPS Solut (2008) 12:135–146
123
INTRODUCTION  
 
The GPS has become the primary source of providing 
navigation information for most of the present vehicular 
navigation applications. However, GPS technology needs 
line of sight signals to the GPS satellites to provide 
solutions with long-term stability, therefore, it is capable 
of providing navigation solutions continually in all 
situations only with uninterrupted signal reception, which 
is not the case for land vehicle navigation applications 
which suffer the impact from intermittent signal reception 
(i.e., forest area or urban canyon) or no signal reception 
(i.e., underground or tunnel). Therefore, GPS has to be 
integrated with other sensor to bridge periods of no signal 
reception to provide continuous navigation solutions. On 
the contrary, an INS is a self-contained positioning and 
attitude device that continuously measures three 
orthogonal linear accelerations and three angular rates to 
calculate the required position. The primary advantage of 
using an INS on outdoor land vehicles is that acceleration, 
angular rotation and attitude data are provided at high 
update rates. Thus the velocity and position of the vehicle 
can also be provided with abundant dynamic information 
and excellent short term performance. However, the error 
of accelerometers will be double integrated and cause 
position error that accumulate with time; the error of gyro 
will generate attitude errors (i.e. the horizontal platform 
misalignments), which causes gravity to project into the 
horizontal axes and disturb the acceleration measurement 
to the vehicles. Both errors grow as a function of time; 
therefore, an INS is only accurate for a limited time if 
without external aiding. Integrated systems provide an 
enhanced navigation system that has superior 
performance in comparison with either a stand-alone GPS 
or INS as it can overcome each of their limitations. 
However, those improvements come with the price.  
 
The high cost and government regulations prevent the 
wider inclusion of those high quality IMUs to augment 
GPS as a commercialized navigation system in land 
vehicle applications until now with the introduction of 
MEMS-based inertial system. The progress in MEMS 
technology enables complete inertial units on a chip, 
composed of multiple integrated MEMS accelerometers 
and gyroscopes. In addition to their compact and portable 
size, the price of MEMS based is far less than those high 
quality IMUs as well, however, the performance of 
current MEMS based IMUs does not meet the 
requirement of tactical grade IMU due to their noisy 
measurements and poor stability. Therefore, such devices 
are not usable as sole navigation system. In a 
decentralized Kalman filter configuration, there are two 
filters working independently: an INS filter and a GPS 
filter. The INS filter is the main one in the configuration 
and uses the output of the INS mechanization to estimate 
the states (i.e., positions, velocities and attitudes) along 
the trajectory. The output of the GPS filter (i.e., positions 
and velocities) is then used to update the main filter. In 
other words, position and velocity update modes are the 
standard procedures to provide measurement updates for a 
decentralized Kalman filter. With the aiding information 
provided by GPS, those inertial error states can be 
estimated through the coupling relationships between 
them. For example, accurate estimation of the velocity 
error states (provided by GPS) will not only improve the 
accuracy of velocity computation directly but also the 
accuracy of the computed pitch and roll.  
 
The heading error dA, is therefore, playing an important 
role in determining the long-term positioning accuracy 
[El-Sheimy, 2002]. Since it is modulated by the velocity 
components Vn or Ve, the effect of azimuth error 
becomes particularly significant at high velocities. 
However, there is no strong coupling between the velocity 
errors and the heading error, which is mainly affected by 
gyro bias. As a result, the positional errors of a low cost 
MEMS IMU will deteriorate rapidly during GPS signal 
outages.  
 
Therefore, it would be beneficial for a low cost 
MEMS/GPS integrated system to have direct heading 
measurement update using a pseudo GPS heading sensor 
utilizing only one GPS receiver or physical heading 
sensors such as GPS heading sensor that has two GPS 
receivers or magnetic compass. In fact, magnetic 
compasses have been applied as a standard option for the 
early version of dead reckoning navigation system [El-
Shiemy, 2002]. However, the problems with magnetic 
compasses are the calibration of magnetic field and the 
derivation of proper model to compensate for the 
disturbance of the magnetic field [El-Shiemy, 2002].  
Such problems become more complicated in typical land 
vehicular environments.  
 
On the other hand, Chiang [2004] implemented a pseudo 
GPS heading algorithm that combines the GPS headings 
provided by a GPS receiver and INS headings provided 
by the mechanization to provide the stable headings of a 
moving vehicle. In addition, Shin [2005] implemented the 
extended Kalman filter that has 21 states (e.g,3 position 
sates, 3 velocity states, 3 attitude states, 3 accelerometer 
bias/scale factor states, and 3 gyro drift/scale factor states) 
with the ability to accommodate direct heading update 
provided by a pseudo GPS heading sensor derived by 
GPS positions using a GPS receiver. The results presented 
in the Shin [2005] do show the enhancement of the 
positioning accuracy when the direct heading 
measurement updates are applied. 
 
Therefore, the objectives of this study are to : (1) develop 
a physical GPS heading sensor using two GPS receivers 
along with the proper algorithm to obtain GPS heading 
(2)compare the performance of the proposed GPS heading 
511
 
The measurement update equations utilize new measurements 
into the a priori state estimate to obtain an optimized an 
optimized a posteriori state estimate. The measurement 
update equations are given as: 
 
 
( ) ( ) 1T Tk k k k k k kK P H H P H R −⎡ ⎤= − − +⎣ ⎦         (5) 
( ) ( ) ( )( )ˆ ˆ ˆk k k k k kx x K Z H x+ = − + − −            (6) 
( ) ( ) ( )Tk k k k kP P K H P+ = − − −                     (7) 
 
where 
K  is the Kalman gain matrix, 
Z  is the vector of updating measurements of position and 
velocity, 
R  is the measurements variance-covariance matrix 
 
The Kalman update engine is triggered at every GPS 
measurement using the difference between GPS and INS 
solutions as input. Hence, the KF generates an updated 
estimate for reducing the INS errors using measurement 
update equations. Whenever a GPS measurement is 
unavailable, the KF works in time prediction mode to 
estimate the error state vector. In this case, the KF 
equations need the statistical properties of the system to 
be stationary and well defined which cannot be 
guaranteed, specially, with a MEMS-based IMU 
implemented in kinematic or dynamic environments [El-
Sheimy, 2002].  
 
For a standard loosely coupled INS/GPS integrated 
architecture, GPS position and velocity information are 
applied to provide measurements update, as shown in the 
Figure(1). In this study, the GPS heading information can 
be applied as additional measurements update thus the 
modified loosely coupled INS/GPS integrated architecture 
implemented in this  study is given in the Figure(2). 
 
 
 
 
 
 
 
 
 
 
 
 
Figure 1: A standard INS/GPS loosely coupled 
integration scheme 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Figure 2: Modified INS/GPS integration scheme with 
GPS heading update 
 
DEVELPEMENT OF GPS HEADING SENSOR 
 
In this study, several methods are provided to compute 
redundant heading information utilizing GPS antennas. 
Carrier phase measurements are processed in kinematic 
DGPS mode to  obtain high accuracy positions and 
velocities solutions. Therefore, these solutions could be 
used to compute the heading or azimuth of a vehicle 
except for GPS outages. Meanwhile, those computed 
headings can be used to provide measurement updates to 
the Kalman filter applied to improve the performance of 
the low cost INS/GPS integrated system used in this study. 
 
The first approach used to obtain heading information of a 
vehicle is based on the positional differences between two 
GPS antennas. As shown in the Figure (3), the positions 
of antenna A and B are obtained through the used of 
kinematic carrier phase DGPS processing with superior 
accuracy. The position difference can then be obtained 
and headings are derived by following equation: 
 
, ,1 1
,
, ,
( ) ( ) ( )( ) tan tan
( ) ( ) ( )
A DGPS B DGPS
DGPS P
A DGPS B DGPS
E t E t E tt C C
N t N t N t
θ − −⎛ ⎞− ⎛ ⎞Δ= + = +⎜ ⎟ ⎜ ⎟⎜ ⎟− Δ⎝ ⎠⎝ ⎠
 
(8) 
where  
 
,i iN E  are the coordinates of GPS antennas under  local level frame 
C  is a constant that depends on the quadrant in 
which point B lies 
A
B
North
θE
θ
EΔ
NΔ
A
B
 
Figure 3:Obtaining GPS heading from the positional 
differences of two antennas  
 
INS
NAV
INS  K.F.
GPS  K.F.
Corrected
r, v, ω
GPS r, vGPS
ResetK.F feedback
Closed loop
 
INS
NAV
INS  K.F.
GPS  K.F.
Corrected
r, v, ω
GPS r, vGPS
ResetK.F feedback
Closed loop
GPS  Heading GPS ψ or AGPS
513
RESULTS AND DISCUSSIONS 
 
To evaluate the performance of the proposed scheme, a 
field test was conducted on October 2006 by the 
Intelligent Multi-Sensor Geomatics System Lab of the 
National Cheng Kung University. The test was conducted 
in land vehicle environments using a low cost INS/GPS 
integrated system consisting of a MEMS IMU (CrossBow 
NAV420) and two Leica GPS System500 receivers 
(e.g.,Rover and master station). Figure (8) shows the set 
up of those systems. In addition,  two Garmin GPS35 
series receivers to setup a GPS heading sensor and the 
baseline between them is 1.2 meters 
 
 
Figure 8: The experimental platform 
 
The GPS measurements were processed using the 
GrafNavTM 7.0 software (Waypoint Consulting Inc.) in 
DGPS mode.  The GPS navigation solutions along with 
the GPS headings were then fed into a decentralized 
Kalman filter of the Aided Inertial Navigation System 
(AINS™) Toolbox software developed by the MMSS 
research group at the University of Calgary, to obtain 
INS/DGPS integrated solutions for further analysis. The 
reference trajectories were generated by the INS/DGPS 
integrated system. The reference solutions were generated 
using AINS 21 states EKF and backward smoothing. The 
field test reference trajectory is shown in figure (9). The 
length of experiment is about 500 seconds and the 
experimental results are shown in the Figure (10) and 
Table 1, respectively. 
 
 
Figure 9: Field test trajectory 
 
As indicated in Figure (9), the GPS heading sensor have 
brought benefits to improve positioning accuracy on east, 
north and up directions. The accuracy improvement with 
the use proposed GPS heading sensor is illustrated in the 
Table 1. Based on the field test data applied in this study/ , 
the improvements of positioning accuracy ranges from  
55% to 60% in three directions.  
 
0 100 200 300 400 500
-4
-2
0
2
4
E
as
t e
rr
or
(m
)
0 100 200 300 400 500
-4
-2
0
2
4
N
or
th
 e
rr
or
(m
)
0 100 200 300 400 500
-1
0
1
GPS TIme-373982 (sec)
U
p 
er
ro
r(
m
)
GPS/INS
GPS/INS+Heading
 
Figure 10: Position errors after utilizing heading 
sensor 
As mentioned in the previous sections, a standard loosely 
coupled INS/GPS integration scheme combines INS 
measurements and GPS solutions. The error states of INS 
can be then estimated and corrected by the Kalman filter. 
The GPS solutions including positions and velocities 
provide long-term accurate measurement updates to the 
INS Kalman filter. This update procedure then improves 
the accuracy of estimated positions, velocities, roll and 
pitch based on the explicit coupling relationship between 
them. However, the coupling relationship between the 
velocity errors and the heading error is weak; in fact, it is 
mainly affected by the gyro bias. Hence, direct heading 
updates provided by a physical GPS heading sensor along 
with a modified loosely coupled INS/GPS integration 
scheme developed in this study are effective tools to 
enhance the performance of a low cost MEMS/GPS 
integrated system.   
 
Table 1: The enhancement  in positioning accuracy 
RMS value (m) 
 
INS/GPS INS/GPS  + heading 
Improvement 
(%) 
East 0.692 0.304 56.1 
North 0.731 0.278 61.9 
Up 0.151 0.065 56.9 
 
 
 
 
0 0.2 0.4 0.6 0.8
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
N
or
th
 (
km
)
East (km)
Trajectory (φ
0
 = 22.9861771706, λ
0
 = 120.1561185982
515
Performance Analysis of GPS Augmentation 
Using Future Taiwanese SBAS   
 
 
Yu-Sheng Huang, Yun-Wen Huang, Kai-Wei Chiang and Ming Yang 
 Department of Geomatics 
 National Cheng Kung University, Taiwan 
 
 
 
BIOGRAPHY   
 
Yu-Sheng Huang is a master student at the Department 
of Geomatics, National Cheng Kung University, Taiwan. 
He is interested in the next generation’s navigation and 
positioning technologies such as GNSS modernization, 
inertial navigation and mobile multi-sensor systems. He is 
also a member of Intelligent Multi-Sensor Geomatics 
System Lab.  
 
Yun-Wen Huang is a PhD student at the Department of 
Geomatics, National Cheng Kung University, Taiwan. He 
is interested in the next generation’s navigation and 
positioning technologies such as GNSS modernization, 
inertial navigation and mobile multi-sensor systems. He is 
also a member of Intelligent Multi-Sensor Geomatics 
System Lab. 
 
Dr. Kai-Wei Chiang is an assistant professor within the 
Department of Geomaics at National Cheng Kung 
University in Taiwan. He has a PhD from the Department 
of Geomatics Engineering at the University of Calgary 
and also holds a B.Sc and M.Sc. in Geomatics 
Engineering from National Cheng Kung University. He 
has 12 years experience in Geomatics engineering, 
formerly known as surveying engineering. His expertise 
includes multi-sensor systems, mobile mapping systems, 
real-time static and kinematic positioning, and digital 
photogrammetry and their applications in mapping and 
geospatial information system. 
 
Ming Yang is a professor within the Department of 
Geomaics at National Cheng Kung University in Taiwan. 
He has a M.Sc and PhD from the Civil and Environmental 
Engineering and Geodetic Science Department Civil and 
Environmental Engineering and Geodetic Science 
Department at the Ohio State University and also holds a 
B.Sc in Geomatics Engineering from National Cheng 
Kung University. He has 22 years experience in 
Geomatics engineering, formerly known as surveying 
engineering. His expertise includes Global Positioning 
System, Satellite Navigation, and Geodesy. 
ABSTRACT  
 
The spread of civil use of the GPS service in car 
navigation, various surveying and mapping applications, 
aviation, maritime, and numerous scientific applications, 
calls for high availability and reliability of the positioning 
service, which at present has some limitations due to the 
limited satellite visibility in Taiwan area due to its urban 
canyons and mountainous regions. Taiwanese geographic 
feature sometimes causes the interruption of positioning 
and the degradation of the positioning accuracy due to 
bad Geometric Dilution of Precision (GDOP). Therefore, 
the idea of developing the future Taiwanese satellite-
based augmentation system is initiated. The proposed 
constellations have an equatorial plane with four or six 
MEO satellites, and the tentative altitude of those 
satellites is set around 20,000 kilometers. Five study sites 
across Taiwan Island are selected for a fixed-site 
performance analysis. The objective of this article is to 
use a GNSS software simulator being developed at the 
Department of Geomatics, National Cheng Kung 
University to perform technical benefits analysis for the 
GPS augmentation using future Taiwanese SBAS.  
 
Up to now, the visibility studies against different masking 
angles of GPS only case, GPS plus four, and GPS plus six 
have been completed. The preliminary results in term of 
the satellite visibility do show the potential enhancement 
of proposed constellations of future Taiwanese SBAS. 
 
INTRODUCTION  
 
The conventional geomatics industry including mapping 
and surveying applications has been revolutionized with 
the use of Global Positioning System (GPS), which is the 
best known, and currently fully operational satellite based 
navigation system operated by USA. It consists of 
satellites, ground reference station infrastructure as long 
as user equipment to determine positions and velocities 
along the world. Motivated by the United States 
Department of Defense (DoD), the current GPS has 
experienced three decades’ development. Although the 
960
launched in late 2005. Galaxy XV is a PanAmSat, and 
Anik F1R is a Telesat. As of August, 2007, the new 
satellites are in an operational mode. The goal of these 
new GEO satellites are ：  
– Replace INMARSAT III’s  
– Eliminate single point of failure of GEO coverage 
– Provide at least two GEO’s in view to each user for 
better availability 
 
Figure 4 illustrates the concepts of development (a) the 
system architecture (b) and signal footprint of EGNOS (c). 
The architecture is almost the same as WAAS. Moreover, 
It augments the two military satellite navigation systems 
now operating, the US GPS and Russian GLONASS 
systems, and makes them suitable for safety critical 
applications [Hein, 2000] 
 
 
Fig 4. System infrastructure and signal footprint of 
EGNOS (Courtesy of ESA) 
 
Because the mountainous terrain and urban canyons, 
user can’t to receive enough number of satellites in 
most of the urban territory of Japan. Therefore, Japan 
has designed of its own augmentation system to GPS, 
Quasi-Zenith Satellite system (QZSS) to provide more 
“overhead” satellites. Figure 5 illustrates the orbit 
constellation and ground of QZSS. QZSS use three, 
Geosynchronous “figure-of-8”, satellites which are 
inclined and elliptic orbits in the different orbit plane to 
pass over the same ground track to keep at least one 
satellite exists near zenith over Japan [IS-QZSS Ver. 
0.0]. 
 
 
Fig 5. QZSS orbit constellation and ground track (Courtesy of 
JAXA) 
 
DESIGN OF FUTURE TAIWANESE SBAS 
 
The GPS industries in Taiwan have been growing since 
2000 and they are specialized in manufacturing consumer 
GPS products. Therefore, to catch up with the latest 
development of GNSS around the world and meet the 
requirements for better positioning performance in typical 
environments in Taiwan, the National Space Organization 
(NSPO) of Taiwan is scheduled to initiate a series of 
studies to evaluate the performance of future SBAS in 
Taiwan later this year. Currently, there are two options 
that attract the most attentions from the NSPO’S program 
committee. The proposed constellations have an 
equatorial plane with four or six MEO satellites 
broadcasting DGPS corrections as well as additional 
ranging signals, respectively. The tentative altitude of 
satellites is set around 20,000 kilometers in order to 
receive the signals from GPS for other purposes. 
 
Therefore, the objective of this article is to use a GNSS 
software simulator being developed at the Department of 
Geomatics, National Cheng Kung University to perform 
technical benefits analysis for the GPS augmentation 
using future Taiwanese SBAS. The proposed simulator 
have two modules, performance analysis and raw data 
generation. Although the current study is limited to GPS 
augmentation only; the GNSS software simulator 
developed is able to adopt Europe’s Galileo as well as 
Russia’s GLONASS for future multi-constellation 
analysis. 
INMARSAT 3
AOR/W
54°W
INMARSAT 3
POR
178°E
Telesat
107°W
PanAmSat
133°W
 
Fig 3. Current WAAS satellite signal footprint (Courtesy 
of FAA) 
962
 
Fig 9. The simulation results of the visibility of four MEO 
satellites augmentation system case while elevation  angle 
are from 10° to 50° through 24hr at South station (23°N, 
120°E). 
 
Fig 10. The simulation results of the visibility of four 
MEO satellites augmentation system case while elevation  
angle are from 10° to 50° through 24hr at North2 station 
(25°N, 122°E). 
 
Fig 11. The simulation results of the visibility of six MEO 
satellites augmentation system case while elevation  angle 
are from 10° to 50° through 24hr at South station (23°N, 
120°E). 
 
Fig 12. The simulation results of the visibility of six MEO 
satellites augmentation system case while elevation  angle 
are from 10° to 50° through 24hr at North2 station (25°N, 
122°E). 
Figure 13 and figure 14 are the number of visible 
satellites of two cases of GPS space-based augmentation 
system GPS-plus-four and GPS-plus-six from 10° to 50° 
at South Station (23°N,120°E). They can both increase 
the number of visible satellites to 14 satellites. Moreover, 
they reduce the situation that number of visible satellites 
is less than 4 and is unable to get the position solution. 
 
Fig 13. The simulation results of the visibility of GPS-
plus-four satellites while elevation  angle are from 10° to 
50° through 24hr at South station (23°N, 120°E). 
 
Fig 14. The simulation results of the visibility of GPS-
plus-six satellites while elevation  angle are from 10° to 
50° through 24hr at South station (23°N, 120°E). 
964
The Implementation a Simulation Platform for 
INS/GNSS Integrated Systems 
 
Chih-Yu Hu 
Intelligent Multi-Sensor Geomatics System Lab 
Department of Geomatics, National Cheng Kung University, Taiwan 
 
 
BIOGRAPHY 
 
Chih-Yu Hu is a graduate student fellow at the Department 
of Geomatics, National Cheng Kung University. His 
research focuses on INS/GNSS integration and RTS 
smoothing at post-processing. 
 
ABSTRACT 
 
The integration of INS with GPS leads to numerous 
applications nowadays, mainly driven by the development 
of low-cost MEMS sensors. Then, it is not surprising that 
great interest has been generated toward low cost inertial 
navigation systems (INS) in the last decade. Although the 
basic principles of INS are quite simple, the analysis of its 
performance and the impact of sensor quality on the 
overall result are quite complex. In fact, one particular 
aspect of INS design is the complexity to evaluate new 
algorithms and innovative digital signal processing with 
various sensors and to access their performances in 
function of several kinds of mobile trajectories. Therefore, 
as most engineering applications, simulation can be 
considered an important step to implement INS/GPS 
integration algorithms. 
 
Therefore, this article exploits a simulation platform for 
INS/GNSS integrated systems. It consists of a trajectory 
generator, GNSS simulator; IMU simulator and optimal 
estimation engine. Comparing to other INS/GNSS 
simulation platforms, the proposed platform distinguishes 
itself from others by including the EKF and RTS smoother 
implemented in loosely coupled and tightly coupled 
architectures as the core of the optimal estimation engine.          
GNSS receivers require direct line of sight signals to the 
GNSS satellite to provide solutions with long-term stability; 
consequently, it is capable of providing continuous navigation 
solutions with uninterrupted signal reception (El-Sheimy, 
2004). However, GNSS leaves two scenarios to be considered 
in the land environment. The first one is intermittent signal 
reception, as for instance in heavily forested areas or in urban 
centers. The other one is no signal reception at all, as for 
instance in buildings, tunnel or underground. In the first case, 
GNSS has to be integrated with other sensors to bridge periods 
of no signal reception. In the second case, GNSS has to be 
replaced by another navigation system that can provide 
continuous navigation solutions in above environments during 
no GNSS signal reception (Chiang, 2004).  
 
It also provides inertial sensor error models and several 
INS mechanizations for different navigation frames for 
further analysis. With the inclusion of direct 
geo-referencing technologies, the demands for precise 
positioning and orientation system from geomatics 
communities have been increased. Therefore, the proposed 
platform can be regarded as a cost-effect tool to study the 
technologies concerning INS/GNSS integrated system. 
The availability of high-end INS is limited in Taiwan, 
therefore, the research communities as well as industries 
can adopt proposed software simulator and enable a low 
cost solutions to study the standard and advanced 
algorithms for INS/GNSS integrated system. 
Therefore, it can be used for research as well as education 
purposes. Several practical issues concerning the 
implementation of INS/GNSS integration algorithms are 
discussed to demonstrate the capability of proposed 
platform.   
 
Keywords: INS, GNSS, Simulator, Estimator 
 
INTRODUCTION 
 
Global Positioning System (GPS) provides precise timing, 
position, and velocity information by utilizing the constellation 
of satellites and a remote receiver that uses range 
measurements to the satellites and spatial trilateration 
techniques. In addition, more navigation satellite systems 
including Russia’s GLONASS, Europe’s Galileo, and PRC’s 
Compass will be available for the coming years. Those 
systems will form the mainframe of future Global Navigation 
Satellite System (GNSS).  
 
 
Inertial Navigation System (INS) that measures three 
orthogonal linear accelerations and three angular rates to 
calculate the navigation information is another navigation 
system used widely. In contrast to GPS, INS is self-contained 
and independent of external signals. Providing acceleration, 
angular rotation and attitude data at high update rates is the 
primary advantage of using an INS in land vehicles. However, 
the disadvantage of using an INS is that INS accuracy will 
descend rapidly because of the sensor errors (accelerometers 
and gyros) quickly growing with time. The accelerometer 
errors cause position error and the gyro errors result in the 
attitude errors. Therefore, an INS is used in the short-term case 
if no other navigation system or navigational aids (Schwarz 
and Wei, 2001). 
Trajectory 
generator 
•Land vehicle
•Airborne
IMU raw data 
simulator   
(Δv, Δθ)
GNSS 
Navigation 
solutions 
simulator (P,V)
GNSS        
raw data 
simulator     
(ρψ)
INS 
Mechanization
KF                     
filtered states 
covariance  matrices
Smoother                    
Smoothed states 
covariance  matrices
Real time 
applications
Post-processing 
applications
Measurements simulator Optimal estimation engine
Loosely coupled
Tightly coupled
Real measurements
 
Figure 3: simulated trajectory 
 
IMU measurement simulator  
 
Four reference frames are involved in the implementation 
of the simulator. They are the inertial frame (denoted as i), 
in which the inertial systems comply with Newton’s 1st 
and 2nd law of motion, the earth centered earth fixed 
frame (ECEF), the navigation frame, and the body frame. 
See Titterton and weston (1997) for details concerning 
these frames. The WGS-84 frame (e-frame) and the ENU 
LLF (l-frame) are applied as ECEF and navigational 
frames respectively. The body frame (b-frame) herein is 
defined as right-forward-up. 
  
Figure: 1 The architecture of proposed simulator 
 
PRINCIPLE OF THE SIMULATOR 
 
Trajectory generator  
 
To construct an INS/GNSS simulator, the first step is to 
design a trajectory generator. This generator not only can 
simulate the trajectory of a land vehicle but also can create 
a route in aviation. The most different part between land 
and aviation is the attitudes change in vehicle. Because of 
the changes in roll and pitch are very small when cars 
moving. So that it can be ignored while designing a ground 
trajectory generator but not in fly.  
 
The conceptual principle of the IMU measurement 
simulator is shown in Figure 4. The vehicle’s rectilinear 
and angular motions designed by the user are first 
translated to PVA information, which is related to the 
navigation frame. Differentiation of the PV information 
derives the acceleration when the gravity is combined. 
However, such acceleration is only a transitory quantity on 
the navigation frame with respect to the inertial frame. 
Frame rotation information is necessary to transform the 
acceleration to the body frame, in which the 
accelerometers measure the vehicle’s translation motions 
with respect to the inertial frame. Frame rotation can be 
computed from the attitude when the earth rotation is 
combined. Frame rotation information indirectly provides 
the vehicle’s rotational motions on the body frame with 
respect to the inertial frame, which are measured by 
gyroscopes. Translation and rotational motions plus 
various sensor errors form the inertial sensors outputs. 
 
Land and airborne dynamics can be considered as two 
different conditions; however their trajectory generators 
are implemented utilizing the same principle. The 
generator can created a “true” dynamic path by employing 
velocity, acceleration, angular velocity and each of their 
continued time. Figure 2 illustrate the simulation of a 
vehicle moving in straight line and turn respectively. A 
trajectory example with 25 minutes time span is shown on 
Figure 3. 
 
  
 
 
 
 
 
 
 
 
 
 
 
 
  
Figure: 2 Straight lines and turn simulation  
 Figure 4: principle of simulator  
 (Adopted from Yang et al., 2007) 
  
 
 
 
 
 
 
 
 
 
 
 
 
GNSS ECEF satellite 
position and GPS 
time
User ECEF satellite 
position and GPS 
time
Raw 
estimate of 
Range and 
CPH is the 
magnitude 
of the LOS 
vector
Line of sight 
(LOS) 
vectors from 
user 
positions to 
healthy 
satellites
Add Orbital 
error
Add GGTO  
error to 
GALILEO 
satellites
Add user 
receiver 
clock error    
Add 
Troposphere 
error
Add satellite 
clock error
Add 
Ionosphere 
error
Add 
Multipath 
error
Add receiver 
white noise
Add 
ambiguities to 
the phase 
measurements
PR and CPH for a given 
receiver and GNSS 
constellation with all errors 
sources modeled   
 
Figure 9: The generation of simulated GNSS 
measurements 
 Figure 7: Difference between error-free and simulated 
IMU measurement Optimal estimation engine 
  
It is common practice to use an EKF to accomplish the 
data fusion. Beside the Kalman filter, other filtering 
concepts are also known. These often account for the 
non-linearities of the system model, e.g. sigma point filters. 
But the nonlinearities are very moderate and, in general, 
these filters have shown identical performance in 
integrated navigation systems. 
GNSS Simulator 
 
A GNSS simulator must be able to simulate satellites 
distribution in the future, all error sources and user 
dynamic path. Because of the errors of GNSS determine 
the accuracy of navigation system so that the system errors 
have to be modeled. The ionosphere, troposphere, error of 
satellite track and multipath effect are modeled in the 
simulator.  
 
Several KF implementations are known. A widely used 
implementation is the closed loop error state space EKF. A 
strapdown inertial navigation system calculates 
continuously the position, velocity and attitude. As 
additional measurements become available, the EKF 
estimates the errors of these quantities. In a closed loop 
design these errors are fed back to the strapdown 
mechanization. That is the preferred way of integration 
with low cost or tactical grade IMUs as the accumulated 
systematic error sources and some of the attitudes errors 
tend to jeopardize the performance of navigation solutions. 
Although the closed loop seems is considered effective for 
all kind of situations; however, the estimator implemented 
in this study also includes open loop correction as an 
option.  
 
As the development of satellite navigation system, a GNSS 
software simulator allows user input the information of 
satellite system to get complete distribution of satellites 
and system errors. By inputting six Keplerian elements, 
the simulator can calculate the track and distribution of 
satellites. A satellite’s track should be ellipse but past 
studies indicated that it can be replaced by circular form. 
Therefore, the calculation of a satellite’s track and velocity 
can be simplified by ignored perigee and eccentricity. In 
fact, this simulator not only utilizes circular track but also 
employ the YUMA ephemeris which downloaded from 
internet. Figure 8 show how the GNSS simulator provides 
coordinate of satellites. 
  
Loosely coupled INS/GNSS integration architecture  YUMA 
almanacs via 
GNSS receiver
YUMA 
almanacs via 
internet
User Defined 
Keplerian
Elements
Load YUMA 
almanacs 
Convert to GNSS 
ephemeris format
Satellite 
positions  and 
velocities in 
ECEF
Time in GPS 
weeks and GPS 
seconds
Time span and 
time step
 
The Loosely coupled architecture is the simplest way of 
integrating a GNSS processing engine into a integrated 
navigation system. The GNSS processing engine first 
calculates position fixes and velocities in the local level 
frame and then send those solutions as measurements to 
the INS main kalman filter. By comparing the navigation 
solutions provided by INS mechanization with those 
solutions provided by GNSS processing engine, the error 
states can be optimally estimated.    Figure 8: the calculation of satellite coordinate As shown in Figure 10. The great advantage of loosely 
coupled architecture is, the simplicity of its 
implementation, because no advanced knowledge of 
GNSS processing is necessary. The disadvantage of 
implementation is that the measurement update of the 
 
Figure 9 indicated the simulation of GNSS measurement. 
It’s clear to see that several kinds of error model are added 
in the process to make sure the result can approximate real 
measurement as possible. 
  
  
RTS Smoother 
 
According to Gelb [1974], there are three types of 
backward smoothing algorithms; fixed-interval smoothing, 
fixed-point (single-point) smoothing and fixed-lag 
smoothing. Only the fixed interval smoother will be 
considered in this study, see Gelb [1974], and Brown and 
Hwang [1992] for details concerning other smoothing 
algorithms. 
 
The Rauch-Tung-Striebel smoother (RTS) was first 
presented in 1965 a few years after R. E. Kalman 
presented his filter in 1960(Gelb, 1974). The Kalman filter 
is a recursive filter that optimally, by means of 
maximum-likelihood, estimates the state vector of a 
dynamic system on the condition that a linear (or 
linearized) system model, past and current noisy 
measurements are known.  
 
Figure 13: Forward and reverse run of a RTS smoother 
  
In comparison to the KF, the RTS smoother calculates the 
most likely estimation of the state vector of a linear 
dynamic system on the condition that past, current and 
future measurements are known. Therefore it is only 
applicable in post processing, but promises improved 
accuracy, especially during GNSS outages.  
In the second step, only the logged data is used by the 
algorithm. It is processed backward in time. The algorithm 
recursively estimates a new system state, by means of 
maximum likelihood. Figure 13 illustrates how the data is 
used. The upper part shows the forward run and the lower 
part the reverse run and the involved variables. The 
forward and reverse run of a RTS smoother is shown in 
Figure 13. 
 
The implementation of a RTS smoother may be regarded 
as an add-on to the Kalman filter. The data processing can 
be divided in two steps. In the first step the RTS smoother 
acts as an Kalman filter, but every time the system state 
vector changes, it and its variance-covariance matrix is 
logged into a file.  
 
Between two GNSS measurements the KF predicts the 
system state ˆkx
− , by means of inertial navigation. When a 
new GNSS measurement becomes available, the KF 
calculates a new corrected prediction ˆkx  but the longer 
the time between the measurements is, the greater the 
errors will become. Hence the KF trajectory contains great 
discontinuities. The smoother has the ability to level these 
discontinuities, by means of a new weighting of the 
previously calculated system states
If the system state changes in the propagation step of the 
KF, the state vector and the propagation matrix are logged 
too. But if the state changes due to a measurement update, 
no measurement data is logged, because it is not needed by 
the algorithm (Brown and Huang, 1992).  ˆkx
− ˆ
kmk
ˆkxx,  and . 
The final trajectory therefore is smooth and contains no 
discontinuities. The full smoother equations are given 
below: 
 
 
 
 
reach about 26m and its RMS is 11.4987m as shown in 
Figure 16. Comparing to well-tuning Q, the maximum of 
position error is only about 2.6m and its RMS is 1.508m. 
 
The need to re-design algorithms based on the Kalman 
filter (i.e., states) to operate adequately and efficiently on 
every new platform (application) or different systems (i.e., 
switch from navigation grade IMU to tactical grade IMUs) 
can be very costly. In addition, the Q and R matrices 
tuning is heavily system dependent. For example, it is 
impossible to use the sets of parameters that are designated 
for navigation grade IMU for the estimation utilizing 
tactical grade IMUs. By using the proposed simulation 
platform, user can appreciate the filter tuning process 
using various “pseudo” IMUs with different accuracies. In 
this case, it can be used as a tool to train people how to 
tune the Q matrix theoretically according to the grade of 
IMU selected without actually getting a pricy IMU and 
conducting time consuming filed tests.   
 
 
 
Figure 16: Impropriety Q matrix 
 
 
The comparison between loosely coupled EKF and 
RTS 
 
Figure 17 illustrate the results of the commonest 
INS/GNSS integrated architecture. The RMS of positional 
errors is 0.4013m. No GNSS outage is simulated in this 
case. 
 
 
Figure 17: Result of Loosely-coupled with good GNSS 
 
Figure 18 compare the results of EKF and RTS smoother 
with a segment of simulated GNSS outage with 5 minutes 
in length. .The RMS of positional error arises to 8.78m. 
On the contrary, The RTS smoother did a great job 
compensating the state vector during GNSS outage. 
Therefore, the position RMS after using RTS smoother can 
be reduced to 0.83m. The improvement in term of 
positional error after applying RTS smoother reaches 90%.  
 
 
Figure 18: 300s GNSS outage 
 
Figure 19 illustrates the performance of EKF and RTS 
smoother during frequent GNSS outages. Table 2 
illustrates the RMS values of positional errors during 
simulated GNSS outages for EKF and RTS smoother, 
respectively.    . 
 
 
Figure 19: Four 60s GNSS outage 
 
Table 2 RMS in GNSS outage (Loosely-Coupled only) 
Outage 1 2 3 4 
EKF-RMS 1.51m 0.66m 0.67m 1.37m 
RTS_RMS 0.28m 0.13m 0.08m 0.15m 
 
The comparison between tightly coupled EKF and RTS 
 
The number of satellite in view is an interesting problem 
when the tightly coupled integration architecture is 
implemented. Figure 20 illustrates the performance of the 
tightly coupled architecture when no GNSS outages occur. 
The RMS of positional error is 0.4754m, which is similar 
to the result of the loosely couple architecture, as shown in 
Figure 17. 
 
When degraded GNSS coverage occurs, the advantage of 
tightly-coupled appears. Figure 21 illustrates the situation 
of degrading GNSS coverage. When the number of 
satellites becomes less than 4, the tightly coupled 
architecture can still provide reasonable position solution.  
for investigating some practical issues concerning the 
development of INS/GNSS integration algorithm. 
Therefore, it is a cost effective tool not only for research 
but for education as well.     
 
It becomes easier in studying INS/GNSS integration 
algorithm and Kalman Filter arguments tuning through the 
simulator. Without experience hardware, it totally 
composes of software thus the system becomes more 
fixable.  
  
 
Beginning of 
GPS outage
End of GPS 
outage
Residual errors of Kalman filter
Residual errors of smoothing
Improvement achieved by 
smoothing
Improvement needed to be achieved 
 
 
Figure 25: The impact of RTS smoother on positional error 
during outage 
 
CONCULSIONS 
 
This study exploits a complete INS/GNSS simulation 
platform. Its architecture includes trajectory generator 
which can generate all kind of trajectory by user defined. 
Measurement generator created IMU and GNSS 
measurements according to the user designed path data 
and senor error model. Estimator has two different data 
process strategy, feedforward which suit for high grade 
IMU and feedback for tactical grade or MEMS IMU. 
Besides, The EKF and RTS smoother are implemented by 
loosely coupled and tightly coupled integration 
architecture.  
 
It will become easier in studying INS/GNSS integration 
algorithm and Kalman Filter arguments tuning through the 
simulator. Without expensive hardware, it totally 
composes of software thus the system becomes more 
fixable.  
 
Not only in study but also the result of simulation also can 
be the principle of IMU purchase. User can easy create a 
varied environment where desired IMU was expected to 
work. Then through simulation, the adaptive IMU can be 
selected. In the future, not only in the high demand of 
accuracy in mapping or low-cost navigation for personal 
use, this simulator can provide precise simulation as 
possible. To reach all kind of demands, the estimation 
process engine is expected to process real measurement 
data in the further study.  
 
ACKNOWLEDMENTS 
 
The author would acknowledge the financial support by 
the National Science Council of the Executive Yuan, 
ROC(Taiwan) (NSC 95-2221-E-006 -335 -MY2) from his 
supervisor, Dr. Kai-Wei Chiang, who initially encouraged 
him to apply and by given him the time and resources 
needed for helping the author accomplishing this work. 
Yun-Wen Huang is acknowledged for helping him 
accomplish this work.  
 
 
REFERENCES 
 
1. Bennour, Z., Landry, R. Jr., Giroux, R. 
Constantinescu, A., and Gavidia, G. (2005). 
Web-Based MEMS Inertial Navigation Simulator, 
ION 61st Annual Meeting 2005, Cambridge, MA 
2. Brown R.G. and Hwang P.Y.C. (1992): Introduction 
to random signals, John Wiley and Sons, New York, 
1992. 
3. Chiang, K.W.(2004). INS/GPS Integration Using 
Neural Networks for Land Vehicular Navigation 
Applications, Department of Geomatics Engineering, 
The University of Calgary, Calgary, Canada, UCGE 
Report 20209. 
4. El-Sheimy, N. (2004) Inertial Techniques and 
INS/DGPS Integration, ENGO 623 lecture notes, 
Department of Geomatics Engineering, The 
University of Calgary. 
5. Gelb A (1974) Applied Optimal Estimation. MIT 
Press, Cambridge, England. 
6. Schwarz, K.P. and M. Wei.(2001). INS/GPS 
integration for Geomatics. Lecture Notes for 
ENGO623, Department of Geomatics Engineering, 
the University of Calgary, Calgary, Alberta, Canada.  
7. Titterton, D. H. and Weston, J. L. (1997): Strapdown 
Inertial Navigation Technology, Peter Peregrinus 
Ltd. 
8. Yang, Y., El-Sheimy, N., Goodall, C., and Niu, X. 
(2007) IMU Signal Software Simulator, ION NTM 
2007, San Diego, CA 
 
generation system, Russia is taking serious steps to 
modernize GLONASS as well [2]. 
 
The GPS and GLONASS signals are free but their 
availability is not guaranteed and currently most users are 
taking the risk. However, as satellite navigation becomes 
a vital technology across a number of critical industrial 
sectors, for example, a nation’s transport infrastructure 
becoming dependent on this technology is a strategic risk 
that most industrial countries are not willing to accept. 
These perspectives motivated the Galileo program in 
Europe. 
  
Unlike GPS and GLONASS, Galileo will also offer a 
guaranteed service to users who are willing to pay for it 
(e.g. Commercial Service – CS, and Public Regulated 
Service – PRS) in addition to a free signal similar to that 
of GPS (Open Service – OS, and Safety of Life service – 
SoL). Galileo will be available to the public in 2012. 
 
China´s Compass is the satellite system planned by China. 
As with GPS, GLONASS, and Galileo, the system is 
planned to provide two navigation services: an open 
service for (commercial) customers and an “authorized” 
positioning, velocity, and timing communications service. 
Compass consists of a constellation of 30 non- 
geostationary satellites, constituted by 27 Medium Earth 
Orbit (MEO), three Inclined Geosynchronous (IGSO) and 
five Geostationary (GEO) satellites. Compass could begin 
operation in 2013 if all the political statements are 
brought into reality. 
 
In all, these systems form the mainframe of Global 
Navigation Satellite Systems (GNSS) [1]. The brief 
discussion of current and future navigation systems 
mentioned previously reveals the huge potential that 
exists for future navigation and positioning applications. 
The vast majority of the world will be users of these 
existing systems. The fundamental questions then are: 
“Which system or systems should a country use?”; “How 
to choose a combination of the systems?”; “What are the 
benefits and respective merits of those systems?” There is 
no simple answer to these questions, as the best solution 
will undoubtedly be application dependent, which has its 
own requirements in terms of accuracy, reliability, 
robustness, cost and other application-specific criteria. 
 
The GPS industries in Taiwan have been growing since 
2000 and they are specialized in manufacturing consumer 
GPS products. To catch up with the latest development of 
global navigation satellite systems around the world, the 
National Space Organization (NSPO) in Taiwan is 
interested in the latest development of Compass/Beidou-2 
as well as its performance in the greater Asia region since 
its coverage over the Asia region will directly benefit the 
users in Taiwan, which is located in the center of East 
Asia. The NSPO commands National Cheng Kung 
University to conduct a pilot study in the applications and 
potential performance improvements of the Compass 
/Beidou-2 system. 
 
Therefore, the main objective of this study is to 
investigate the performance of BeiDou-2/Compass 
comparing to GPS, GLONASS and Galileo in the greater 
Asia region. The satellite visibility and DOP of each 
system or possible combinations between them are used 
as the major indices for the performance evaluation with 
the emphasis on the addition of Compass. In addition, 
those indices are further analyzed in terms of their spatial 
and temporal distributions with the emphasis on the 
greater Asia region. 
 
GLOBAL NAVIGATION SATELLITE SYSTEMS (GNSS) 
 
GPS 
 
GPS is the best known and fully operational satellite 
based navigation system operated by USA. Motivated by 
the United States Department of Defense (DoD), current 
GPS has been operating for 30 years since the first GPS 
satellite launch. It consists of satellites, ground reference 
station infrastructure as well as user equipment to 
determine positions and velocities around the world. 
Although the original motivation was only for military 
purposes, GPS has been widely used in civilian 
applications during the past few decades. However, the 
integrity, availability, and accuracy still need further 
improvement for various applications. 
 
Therefore, a GPS modernization program was initiated in 
the late 1990’s, making an attempt to upgrade GPS 
performance for both civilian and military applications. 
The GPS modernization program started with the 
cancellation of SA in 2000. It will be followed by the 
addition of a new civil code on L2 (L2C), then the third 
civil frequency L5. Further modernization consists of the 
assessment and design of a new generation of satellites to 
meet military and civil requirements through 2030. The 
purpose of the GPS III program is to deliver major 
improvements in accuracy, assured service, integrity, and 
flexibility for civil users. See [3] for a completed review 
concerning the expected performance of GPS III. 
 
GLONASS 
 
GLONASS was originally deployed as the Soviet Union’s 
answer to GPS. The design of GLONASS is very similar 
to GPS except that each satellite broadcasts its own 
particular frequency with the same codes (this is known 
as a FDMA, or Frequency Division Multiple Access, 
scheme), while GPS satellites broadcast the same 
frequencies and a receiver differentiates between satellites 
by recognizing the unique code broadcast by a given 
satellite (this is known as a CDMA, or Code Division 
satellites launched after 2007 would complement the first 
three satellites for the BeiDou-1 system, while also 
supporting passive one-way downlink like GPS. Table 
3illustrates the launch dates and positions of the five 
Compass GEO satellites. 
 
Table 1 The parameters of the five GEO satellites and the 
three IGSO satellites in COMPASS 
GEO(5) IGSO(3) 
First launch BeiDou-1D  3-Feb-07 
Semi-major 
Axis[Km] 42164 
FOC Apr-04 Eccentricity 0 
Semi-major 
Axis[Km] 42164 
Inclination 
[Deg] 55 
Eccentricity 0 RAAN 0º,120º,240 º 
GEO 
Longitudes 
58.75º,80º,110.5º 
,140ºand 160ºE 
Argument  
of perigee 
187.6º,67.6º
,307.6 º 
RAAN：Right Ascension of ascending node 
 
Table 2  The parameters for future GNSS. 
Parameter GPS GLONASS Galileo Compass (Meo)
First launch 22-Feb-78 12-Oct-82 28-Dec-05 13-Apr-07 
FOC 17-Jul-95 18-Jan-96 2012  2013  
Services -military -civil 
-military 
-civil 
-commercial 
-open 
- authorized 
- open/commercial
Number of SV 31 24 27 27 
Orbital planes 6 3 3 3 
Inclination  55º 64.8º 56º 55º 
Semi-major 
Axis[Km] 26560 25508 29601 27840 
Period 11h58m 11h15m 14h05m 12h50m 
Coordinate 
frame WGS-84 PZ-90 GTRF Beijing 1954 
Time system GPST UTC(SU) GST China UTC 
Coding CDMA FDMA CDMA CDMA 
Frequencies 
[MHz] 
L1:1575.42 
L2:1227.60 
L5:1176.45 
G1:1602 
G2:1246 
G3:TBD 
E1:1575.42 
E5a:1176.45 
E5b:1207.14 
E6:1278.75 
B1-2:1589.74(E1)
B-1:1561.1 (E2，)
B2:1207.14(E5b)
B3:1268.52(E6) 
FOC：Full operational capability ;   
 
Table 3 Launch date and position of the five COMPASS 
GEO satellites. 
Satellite Launch Date Position 
BeiDou-1A 31-Oct-2000 140°E 
BeiDou-1B 21-Dec-2000 80°E 
BeiDou-1C 25-May-2003 110.5°E 
BeiDou-1D 3-Feb-2007 58.75°E 
BeiDou-1E TBD 160°E 
 
 
BeiDou-1A, BeiDou-1B, and BeiDou-1C belong to the 
original BeiDou-1 system. BeiDou-1D and BeiDou-1E 
are considered as the additional satellites for the 
BeiDou-2 system. 
 
THE BENEFITS OF MORE SATELLITES 
 
According to Table 2, future GNSS is expected to provide 
at least nine frequencies with more than 112 GNSS 
satellites when all the systems become fully operational. 
A number of papers have put attention to the study of the 
compatibility and interoperability of different systems 
with the emergence of the above mentioned systems.  
 
Meanwhile, an increasing number of agreements between 
the operators guarantee the interoperability of systems 
and signals. The Raising number of satellites and signals 
will provide more observations. In general, the increasing 
number of visible satellites would decrease the DOP 
values, and consequently, the position accuracy increases. 
Using four systems will almost four times the number of 
satellites. However, this does not necessarily decrease the 
DOP values, although it will be the common case. 
Nevertheless, from the increasing redundancy in the 
adjustment process, the position accuracy, availability, 
integrity and continuity will be improved when more 
satellites are available [10]. 
 
SIMULATION RESULTS AND DISCUSSION  
 
A number of papers [11, 12] have been dedicated to the 
study of the hybrid GPS, GLONASS, Galileo and 
BeiDou-2/Compass systems. But none of them provides 
the performance analysis specifically for the greater Asia 
region. Thus the main purpose of this study is to 
investigate the performance of BeiDou-2/Compass 
comparing to GPS, GLONASS and Galileo in the greater 
Asia region; and also to explore whether combining 
BeiDou-2/Compass with each GNSS would yield 
performance improvements in the same region. 
 
The GPS satellite coordinates used in this study were 
determined by using actual ephemeris (converted from the 
almanac files, Yuma431.txt, which can be downloaded 
from [13]). The current GLONASS constellation is 
obtained from web site [4]. The Galileo constellation was 
compiled from information in [14]. The implemented 
GLONASS constellation was essentially 24 satellites in 
three orbital planes whose ascending nodes are 120° apart. 
8 satellites are equally spaced in each plane with 
argument of latitude displacement 45°. The orbital planes 
have 15° argument of latitude displacement relative to 
each other. The satellites operate in circular 25508km 
orbits at an inclination 64.8°. The Galileo constellation 
comprises 27 operational satellites in a Walker 
constellation with three orbital planes, equally spaced 
with a 56° nominal inclination and a semi-major axis of 
 
Figure 3 Spatial variation of visibility for 
GPS/Galileo/GLONASS  
 
Figures 4 to 6 illustrate the results concerning Compass. 
Using those figures, the impacts of the three IGSO 
satellites and the five GEO satellites used in Compass are 
discussed separately. With IGSO satellites alone (see 
Figure 4), it can provide 1 to 3 additional satellites 
through 24 hours to the user in the greater Asia region. 
After combining with GEO (see Figure 5), the number of 
visible satellites provided to the same region increase to 4 
to 8 through 24 hours. It can be regarded as a regional 
navigation satellite system that can work alone to provide 
positioning solution. However, countries outside of the 
greater Asia region cannot profit from those IGSO/GEO 
satellites of Compass. Figure 6 illustrate that the global 
distribution of visible satellites ranges from 8 to 10 for 
users outside the greater Asia region with a full 
constellation of Compass. On the contrary, the user in the 
greater Asia region can receive from additional 4 to 8 
satellites from Compass IGSO/GEO, summing up to a 
maximum of 17 visible satellites. 
 
Figure 4 Spatial variation of the number of visible 
Compass IGSO satellites  
 
Figures 7 and 8 illustrate visibility distribution of the GPS 
/Compass and GPS/Galileo/Compass combined systems, 
respectively. The visibility distribute uniformly across the 
most of the world, while better visibility can be achieved 
in the greater Asia region due to the extra 4 to 8 satellites 
provided by the IGSO/GEO satellites of Compass.  
 
Figure 5 Spatial variation of the number of visible 
GEO/IGSO satellites of Compass  
 
Figure 6 Spatial variation of the number of visible 
Compass satellites with a full constellation 
 
Figure 7 Spatial variation of the number of visible GPS/ 
Compass satellites  
 
Figure 8 Spatial variation of the number of visible GPS/ 
Galileo/Compass satellites  
Figure 9 illustrates the spatial variation of the visibility of 
combining GPS/GLONASS/Galileo/Compass. In this 
1.52-2.19 to 0.72-0.92. With the addition of IGSO/GEO, 
the maximum of visible Compass’s satellites also increase 
to 17; the minimums of HDOP and VDOP also are 
improved to 0.74 and 1.32, respectively. However, the 
performance improvement is limited to users in the Asia 
region. All the simulation results illustrate that Compass 
can provide better visibility and dilution of precision in 
Asia region. Therefore, focus on Asia region, observing 
the impact of different GNSS in Asia region. 
 
Table 4  Summary of the performance of different 
system combination in global scale 
MA=10 NVS [Min-Max] 
HDOP 
[Min-Max]
VDOP 
[Min-Max] 
GDOP 
[Min-Max]
GPS 8-10 0.80-1.13 1.52-2.19 1.96-2.76
Galileo 8-9 0.82-1.09 1.56-2.07 2.07-2.55
Compass 8-17 0.74-1.11 1.32-2.05 1.72-2.55
2G 16-20 0.56-0.72 1.03-1.40 1.35-1.69
GPS/C 16-27 0.54-0.72 0.95-1.39 1.24-1.68
3G 23-28 0.47-0.58 0.84-1.06 1.13-1.31
2G/C 24-36 0.45-0.58 0.83-1.11 1.05-1.35
3G/C 31-43 0.40-0.51 0.72-0.92 0.95-1.13
2G : GPS/Galileo; 3G : GPS/GLONASS/Galileo; 
C : Compass 
 
Regional Visibility and DOP 
 
The scenario of regional analysis is the same as the global 
simulation but scoping to the greater Asia region to 
interpret the performance improvement of Compass in the 
Asia region specifically. The greater Asia region with 
longitude set from 90ºE to 180ºE, and latitude set from 
60ºS to 60ºN are chosen. This area covers most of the 
China, Japan, Korea, Taiwan, Southeast Asia and 
Australia. 
 
Visibility and Dilution of precision (DOP) 
 
Figure 14 to 16 illustrate the spatial variation of averaged 
satellite visibilities over the 24-hour period for GPS 
versus Compass, GPS/Galileo versus GPS/Compass and 
GPS/GLONASS/Galileo versus GPS/Galileo/Compass 10 
degree masking angle. Due to the lack of clarity of the 
values on top of the color bars in these figures, the 
minimum and maximum values of each color bar in those 
figures are summarized in Table 5. 
 
With the results presented above, there are two scenarios 
to be observed. The first scenario, on the left column, 
consist of only MEO satellites, resulting in better 
visibility around the equator, while the rest of the world 
suffer from poorer visibility; the second scenario, on the 
right column, uses Compass or combined systems, which 
deliver better visibility in the entire South East Asia 
region, with best visibility around Indonesia and 
Singapore. As shown in Table 5, GPS and Galileo have 
similar visible satellites in the greater Asia region. The 
use of Compass brings additional visible satellites to the 
user in this region; therefore some East Asian countries 
could receive almost twice the number of satellites over 
GPS and Galileo when the Compass is used alone. The 
GPS/Galileo combined system provides slightly more 
satellites than using Compass alone. The GPS/Galileo 
combined system provides roughly twice number of the 
visible satellites of GPS or Galileo respectively. 
 
On the contrary, the GPS/Compass combined system has 
roughly three times number of visible satellites than GPS 
or Galileo alone, which is similar to the performance of 
the GPS/GLONASS/Galileo combined system in this 
region. Compass can provide more visible satellites over 
industrial areas and densely populated metropolis, making 
satellites more efficiently used. Notice that this only 
applies to the Asia region. 
 
 
Figure 14 Spatial variation of the number of GPS versus 
Compass visible satellites  
 
Figure 15 Spatial variation of the number of GPS/Galileo 
versus GPS/Compass visible satellites  
 
Table 5 illustrates the minimum and maximum of the 
number of visible satellites, HDOP, VDOP and GDOP 
values for different system combination in regional scale, 
respectively. Comparing the regional scope of Table 5 
Compass observed at those cities in the open sky and 
urban canyon scenarios, respectively. 
  
Table 7  Visibility of GPS and Compass [MA=10 º]. 
NVS 
MA=10 
GPS COMPASS
Min Max Mean Min Max Mean
Beijing 6 13 8.75 13 17 14.87
Seoul 6 13 8.78 12 17 13.80
Tokyo 6 13 8.80 12 17 13.97
Shangaai 6 13 8.90 13 18 15.09
TaiPei 6 13 9.10 13 18 15.42
Hongkong 7 13 9.00 13 18 15.44
Bangkok 6 12 9.31 14 18 16.15
Singapore 8 13 9.92 16 19 17.27
Sydney 6 12 8.82 11 16 12.83
MA: Masking Angle 
 
As shown in Table 7, the minimum of the number of 
visible Compass satellites almost equals to the maximum 
number of visible GPS satellites. The means presented in 
the table illustrate the Compass has six additional visible 
satellites than GPS. Those five GEO and three IGSO 
satellites covering Asia region contribute to this 
improvement. In addition, the cities that are closer to the 
equator would result in the better visibilities. Therefore, 
Singapore and Bangkok have more satellites. On the other 
hand, Sydney, which is located in a medium latitude 
region in the south hemisphere, has poorer satellite 
visibility. Thus less significant performance improvement 
over GPS can be achieved with Compass.  
 
Table 8  Visibility of GPS and Compass [MA=40 º]. 
NVS 
MA=40 
GPS COMPASS 
Min Max M SR Min Max M SR 
BJ 1 6 4.02 74% 4 7 6.00 100%
Se 1 7 4.02 71% 4 8 7.04 100%
To 2 7 3.88 57% 5 8 7.05 100%
SH 1 8 4.06 70% 5 8 7.21 100%
TP 1 7 4.00 61% 5 8 7.29 100%
HK 2 7 3.96 54% 6 9 8.31 100%
Ba 1 7 3.54 45% 7 10 8.68 100%
Si 1 6 3.17 36% 6 9 7.08 100%
Sy 2 7 3.88 63% 4 8 6.92 100%
BJ[BeiJing]、Se[Seoul]、To[Tokyo]、SH[ShangHai]、TP[TaiPei]、
HK[HongKong]、Ba[Bangkok]、Si[Singapore]、Sy[Sydney] 
M：Mean; SR: Success rate 
 
As shown in Table 8, the means of the visible Compass 
satellites for the cities located in the high latitude regions 
are slightly larger than GPS. For those cities that are 
closer to equator, more Compass satellites are visible 
comparing to GPS satellite. The success rate of the 
Compass reach 100% in all cases but the maximum of 
GPS only reach 74%. Besides, the success rate of 
Singapore is only reach 36%. 
 
Table 9 illustrates the minimum, maximum, and mean of 
number of visible satellites for the GPS/GLONASS/ 
Galileo/Compass combined systems against masking 
angles raising from 10º and 40º. These cities lead to the 
same conclusions. It can be remarked that Singapore has 
the highest number of visible satellites when the masking 
angle equals to 10º; but it also has lowest number of 
visible satellites when the masking equal to 40º. Figure 18 
illustrates the spatial variation of visibility of a 
GPS/GLONASS/Galileo/Compass combined system 
when masking angle equal to 40º in Asia region. It can be 
observed the result does not like the scenario of masking 
angle equal to 10º show better visibility around the 
equator but the low latitude. 
 
Table 9 Visibility of Hybrid GPS/GLONASS/Galileo 
/Compass system  
3G/C- 
NVS 
MA=10 MA=40 
Min Max Mean Min Max Mean
Beijing 29 46 38.30 9 23 16.22
Seoul 29 44 37.16 10 22 17.26
Tokyo 31 44 37.46 10 22 17.20
Shanghai 32 47 38.48 11 22 17.30
Taipei 32 47 38.99 10 21 17.04
HongKong 32 48 39.07 13 22 17.71
Bangkok 30 47 40.47 11 23 17.04
Singapore 38 48 42.94 11 19 14.93
Sydney 30 44 36.26 9 22 17.16
 
 
Figure 18 Spatial variation of the visibility for GPS, 
GLONASS, Galileo, and COMPASS [MA=40] 
 
Figures 19 and 20 compare the visible GPS satellites  
versus visible Compass satellites observed in Beijing、
Singapore、Sydney through 24hr when the masking angle 
equal to 10º and 40º, respectively. Those cities are chosen 
based on their geographical locations in the greater Asia 
of the GPS/Galileo/Compass visibility are improved from 
24-36 to 28-36 and from 1.05-1.35 to1.06-1.22, 
respectively. The user in Asia region can get better 
performance than other countries in the world. 
 
The future of GNSS is bright. More satellites and more 
signals will be available to many user communities. 
However, the challenge will be how to solve interoperable 
issues between them. Compatibility and interoperability 
of all GNSSs would ensure the benefits of satellite-based 
Positioning, Navigation and Timing are far greater than 
what any individual system can provide 
 
The preliminarily results presented in this article indicate 
Beidou-2/Compass can provide 4 to 8 additional satellites 
with superior performance over the greater Asia region 
with the use of its unique GEO/IGSO/MEO combined 
satellite constellation. With the standalone case, the 
performance of Compass would get little better than the 
other GNSS constellations in the global scale. Moreover, 
it can get significant performance improvement in the 
Asia region. In fact, the performance of Compass in Asia 
is improved significantly comparing to GPS alone in term 
of the visibility, DOP values, and robustness to urban 
canyon effect. Compass alone can provide similar 
performance to the GPS/Galileo combined system.  
 
Future studies will be conducted to provide more 
insightful technical benefit analysis including availability, 
accuracy, continuity, reliability to realize the impact in the 
Asia region with the use of Compass.  
 
ACKNOWLEDGMENTS 
 
The author would acknowledge the financial support by 
the National Science Council of the Executive Yuan, 
ROC (Taiwan) (NSC 95-2221-E-006 -335 -MY2). From 
his supervisor, Dr. Kai-Wei Chiang, who initially 
encouraged him to apply and by given him the time and 
resources needed for helping him accomplishing this 
work. Yun-Wen Huang, Meng-Lun Tsai, and John C 
Huang are acknowledged for helping him accomplishing 
this work. 
 
REFERENCES 
 
1. McDonald, K.D., The Modernization of GPS: Plans, 
New Capabilities and the Future Relationship to 
Galileo. Journal of Global Positioning Systems, 2002. 
1(1): p. PP.1-17. 
2. Federal Space Agency for the Russian Federation, 
GLONASS: Status and Perspectives., in Munich 
Satellite Navigation Summit 2005. 2005: Munich. 
3. Pullen, S. and P. Enge, A Civil User Perspective on 
Near-Term and Long-Term GPS Modernization. Text 
GPS/GNSS Symp, 2004: p. 3-13. 
4. GLONASS Constellation status.   [cited 2008 
February, 29]; Russian Space Agency, 
Information-Analytical Center (IAC):[Available from: 
www.glonass-ianc.rsa.ru. 
5. Zak, A. December 29, 2007 [cited 2008 February 29]; 
Available from: http://www.russianspaceweb.com/. 
6. Global navigation satellite system - GLONASS - 
interface control document, version 5.0. 2002, 
Coordination Scientific Information Center: Moscow. 
7. Hofmann-Wellenhof, B., H. Lichtenmgger, and E. 
Wasle, GNSS Global Navigation Satellite Systems: 
GPS, GLONASS, Galileo, and more. 1 ed. 2006, 
Austria: Springer. 402. 
8. T. Grelier, A.G., J. Dantepal, L. Ries, and J.-L.I. A. 
DeLatour, Compass signal structure and first 
measurements, in ION GNSS 2007. 2007: Fort Worth, 
Texas. p. 3015. 
9. Submission of the updated information of Compass 
system to the Fourth Resolution 6009 (WRC-03) 
Consultation Meeting, in Ministry of Information 
Industry. 2006, Radio Regulatory Department: The 
People's Republic of China. 
10. Hofmann-Wellenhof, B., H. Lichtenmgger, and E. 
Wasle, GNSS Global Navigation Satellite Systems: 
GPS, GLONASS, Galileo, and more. 1 ed. 2006, 
Austria: Springer. 397-400. 
11. A.Constantinescu and R.J. Landry, 
GPS/Galileo/GLONASS hybrid satellite constellation 
simulator - GPS constellation validation analysis, in 
ION 61st Annual Meeting. 2005: Cambridge, MA. p. 
733-737. 
12. Hein, G., Envisioning a Future GNSS System of 
Systems Part 1. Inside GNSS, 2007. 2(1): p. 58–67. 
13.   [cited 2007 27 November]; U.S. Coast Guard 
Navigation Center:[Available from: 
http://www.navcen.uscg.gov/gps/almanacs.htm. 
14. Dinwiddy, S.E., E. Breeuwer, and J.H. Hahn, The 
Galileo System. 2004, procs of the European 
Navigation Conference GNSS 2004: Rotterdam, The 
Netherlands. p. 151:1-5. 
15. Wu, F., K. Nobuaki, and A. Yasuda, A Study of 
Hybrid Modernized GPS and Galileo Positioning in 
Japan. The Journal of Japan Institute of Navigation, 
2003. 109: p. 171-178. 
16. O'Keefe, K., S. Ryan, and G. Lachapelle, Global 
availability and reliability assessment of the GPS and 
Galileo Global Navigation Satellite Systems. Canadian 
Aeronautics and Space Journal, 2002. 48(2): p. 
123-132. 
17. A.Constantinescu, R.J. Landry, and I. llie, Availability, 
Accuracy and Global Coverage Analysis for a Hybrid 
GPS/Galileo Satellite Constellation Using a Global 
Navigation Satellite System Simulator, in 
International Symposium European Radio Navigation 
EURAN 2004. 2004: Munich, Germany. 
The Kalman filter (KF) approach has been widely 
recognized as the standard optimal estimation tool for 
current INS/GPS integration schemes. However, it has 
limitations, which have been reported by several 
researchers [Gelb, 1974; Brown and Hwang, 1992; 
Vanicek and Omerbasic, 1999]. The major inadequacy 
related to the utilization of the KF for INS/GPS 
integration is the necessity to have a predefined accurate 
stochastic model for each of the sensor errors [Brown and 
Hwang, 1992]. Furthermore, the prior information about 
the covariance values of both INS and GPS data as well 
as the statistical properties (i.e. the variance and the 
correlation time) of each sensor system has to be 
accurately known [Vanicek and Omerbasic, 1999]. 
Furthermore, for GPS/IMU integration applications 
(where the process and measurement models are 
nonlinear), the Extended Kalman filter (EKF) operates 
under the assumption that the state variables behave as 
Gaussian Random Variables (GRV). Naturally, the EKF 
may also work for nonlinear dynamic systems with non-
Gaussian distribution, except for heavily skewed 
nonlinear dynamic systems, where the EKF may 
experience problems [Shin, 2005].  
 
On the other hand, Artificial Neural Networks (ANN) 
techniques have been applied to develop alternative 
INS/GPS integration schemes to overcome the limitations 
of the KF and improve the positional accuracy of 
vehicular navigation systems during GPS signal 
blockages successfully [Chiang, 2004]. However, Chiang 
[2004] indicated that hat future development concerning 
the use of artificial intelligent techniques such as ANN for 
INS/GPS integration should include an integrated 
approach of the KF and an Artificial Intelligent (AI) 
approach (e.g., ANN ). Such an integrated approach will 
provide a system capability of estimating all navigation 
states and make use of the advantages of AI techniques to 
fulfill the needs for practical solutions. Therefore, 
Goodall et al., [2005] proposed an ANN-KF hybrid 
scheme that is capable of estimating all navigation states 
and make use of the advantages of ANN techniques to  
successfully improving the positioning accuracy of 
vehicular navigation systems during GPS signal 
blockages. However, none of those previous researches 
aim at developing a completed Positioning and 
Orientation System (POS) to meet the requirements of 
mobile mapping applications in terms of the available 
states and achievable accuracy. In fact, the scope of those 
earlier studies is limited to incorporate ANN to bridge the 
gap between GPS outages by improving the positioning 
accuracy for navigation purpose. Therefore, the issue 
concerning orientation angles was not discussed 
thoroughly in those early works.  
 
PROBLEM STATEMENTS 
 
Post-mission processing, when compared to real-time 
filtering, has the advantage that data of the whole mission 
can be used to estimate the trajectory. This is not possible 
when using filtering because only part of the data is 
available at each trajectory point, except the last [Gelb, 
1974]. When filtering has been used in a first step, one of 
the optimal smoothing methods such as Rauch-Tung-
Striebel (RTS) backward smoother can be applied. It uses 
the filtered results and their covariances as a first 
approximation. This approximation is improved by using 
the additional data that was not used in the filtering 
process. Depending on the type of data used, the 
improvement obtained by optimal smoothing can be 
considerable. Therefore, most of the direct geo-
referencing applications require higher accuracy 
platforms, especially in attitude determination [El-Sheimy, 
1996].  
 
The good thing is that such high accuracy requirements 
for position and attitude determination in mobile mapping 
applications can be achieved in post-mission mode with 
an optimal smoothing algorithm. In fact, most of the 
commercial mobile mapping systems use an optimal 
smoothing algorithm to provide accurate position and 
orientation for direct geo-referencing [Shin, 2005]. As 
mentioned previously, an ANN-KF hybrid scheme has 
been proposed to improve the positional accuracy of 
vehicular navigation systems during GPS signal 
blockages successfully [Goodall et al., 2005].  In fact, all 
of the current commercially available INS/GPS integrated 
POSs use tactical grade IMUs or above to provide 
accurate POS solutions for general MMS applications. 
Therefore, upgrading the hardware (e.g., IMU) can be 
considered as an effective solution to improve the 
accuracy of POS solutions when a low cost MEMS IMU 
is used. However, such improvement is rather limited as 
the availability of high grade (navigation) IMUs is 
regulated by the governmental regulations of certain 
countries where the IMUs are produced.  
 
On the other hand, the price of those available medium 
grade IMUs (tactical grade) is very high at the present 
time. In certain countries, even the availability of medium 
grade IMUs is limited. Therefore, another effective way 
to improve the accuracy of a low cost MEMS INS/GPS 
integrated POS solutions is through the improvement of 
POS algorithm. Comparing to the hardware perspective 
mentioned above, the software perspective can be 
considered as a cost effective solution to develop a low 
cost INS/GPS integrated POS for general MMS 
applications. 
 
Therefore, this article aims at proposing a hybrid scheme 
to adopt both ANN and an optimal smoothing algorithm 
for achieving higher accuracy of POS parameters to fulfill 
the requirements for direct geo-referencing applications 
with the use of a low cost Micro-Electro Mechanical 
The measurement update equations utilize new measurements 
into the priori state estimation to obtain an optimized 
posteriori state estimation. The measurement update 
equations are given as: 
 
 
( ) ( ) 1T Tk k k k k k kK P H H P H R −⎡ ⎤= − − +⎣ ⎦                    (5) 
( ) ( ) ( )( )ˆ ˆ ˆk k k k k kx x K Z H x+ = − + − −                        (6) 
( ) ( ) ( )Tk k k k kP P K H P+ = − − −                                       (7) 
 
where 
K  is the Kalman gain matrix, 
H  is the design matrix 
Z  is the vector of updating measurements of position and 
velocity, 
R  is the measurements variance-covariance matrix 
 
The update engine of KF is triggered at every GPS 
measurement using the difference between GPS and INS 
solutions as input. Hence, the KF generates an updated 
estimate for reducing the INS errors using measurement 
update equations. Whenever a GPS measurement is 
unavailable, the KF works in time prediction mode to 
estimate the error state vector. In this case, the KF 
equations need the statistical properties of the system to 
be stationary and well defined which cannot be 
guaranteed [Shin and El-Sheimy, 2004].  
 
Figure (1) depicts a closed loop and loosely coupled 
INS/GPS integration architecture, which is implemented 
in this study [Shin and El-Sheimy, 2004].  As shown in 
Equation (6), the KF provides the optimal estimate of a 
state vector at epoch k ( ˆkx ) by using measurements 
(updates) that are only available up to epoch k. On the 
other contrary, the optimal backward smoothing allows an 
optimal smoothed estimation of the state vector at epoch k 
( ˆksx ) utilizing all or some of the measurements that are 
available after epoch k. The smoothed estimate ( ˆksx ) 
could be considered to be an optimal combination of a 
forward estimate and a backward estimate. The forward 
estimate is obtained by using all measurements up to k, 
and thus, it is the estimate provided by the KF. The 
backward estimate is obtained by using all or some of the 
measurements after k. Therefore, since more 
measurement updates are used for the estimations, the BS 
estimates in general, if not more accurate, can never be 
worse than the filtered estimates (Brown and Hwang, 
1992).  
 
Accelerometers 
(△ v)
Gyroscopes      
(△ θ)
GPS 
Corrections 
Corrections 
INS KF
GPS KF 
(position/velocity)
Gravity 
Positions
Velocities
Attitudes∫
∫ ∫
 
Figure 1: A loosely coupled INS/GPS integration 
architecture (Closed loop) 
 
However, the smoothing is performed after the filtering 
stage. Hence, all smoothing algorithms will be dependent 
on the obtained filtered solution. Thus, accurate filtering 
is required for accurate smoothing [Gelb, 1974]. 
According to Gelb [1974], there are three types of 
backward smoothing algorithms; fixed-interval smoothing, 
fixed-point (single-point) smoothing and fixed-lag 
smoothing. Only the fixed interval smoother will be 
considered in this study, see Gelb [1974], and Brown and 
Hwang [1992] for details concerning other smoothing 
algorithms. As indicated in Figure (2a), DGPS 
measurements are available at each epoch for the whole 
mission of time span N. Also, the filtered solution 
estimates are obtained from the KF at each epoch k 
( ,ˆk kx  ), where k = 0, 1, 2... N [Shin, 2005]. In the fixed-
interval smoothing, the initial and final time epochs of the 
whole interval of measurements (i.e. 0 and N) are fixed. 
The requirement here is the optimal smoothed estimate at 
all epochs k in the interval between 0 and N, as indicated 
in Figure (2b). In this case, all measurement updates 
between 0 and N are used, and hence, the optimal 
smoothed estimate at epoch k is ,ˆ
s
k kx . Obviously, this 
type of smoothing can only be carried out in post-mission 
since it requires the availability of all measurements up to 
N [Nasser, 2003]. 
 
The Rauch-Tung-Striebel (RTS) backward smoother is 
implemented in this study. Compared to other fixed-
interval smoothers, the RTS algorithm has the advantage 
to be the easiest and simplest in implementation [Gelb, 
1974]. The RTS smoother consists of a forward sweep 
and a backward sweep. The forward sweep is the common 
KF with all predicted and updated estimates and 
corresponding covariance saved at each epoch of the 
whole mission. The backward sweep begins at the end of 
the forward filter (i.e. at epoch N) with the initial 
conditions of  , ,ˆ ˆ
s
N N N Nx x=  and , ,=s N N N NP P , the 
RTS algorithms are given as follows [Gelb, 1974]: 
errors behave based on the dynamics of the vehicle or 
platform. This is a form of supervised training whereby 
the network develops itself based on inputs and observed 
outputs, as shown in the Figure (4). The specific inputs 
and target values along with the topology of the networks 
are given in details in the Figure (5). 
 
∑
Unknow
model
Neural
networks
+_
expected
outputs
d
y
x
e
error signals
actual
outputs
 
Figure 4: Supervised Learning for function 
Approximation 
The topology of an ANN is constructed from small 
processing units (neurons) that are interconnected within 
the network using weighted links. In general, the basic 
model of the neuron contains three major components: (a) 
weight links , ,,i j j kw W ; (b) an adder for summing the 
input signals iφ  that are weighted by respective synapses 
of the neuron and external bias ( kb ); and (c) an 
activation function )(•ϕ  for limiting the amplitude of the 
neuron output and the final output ky . Figure (5) depicts 
a feed forward neural network, which contains external 
inputs ),,( 321 φφφ , a hidden layer with 3 hidden neurons, 
and the output layer with 3 output neurons. The depicted 
network is said to be fully connected since all inputs/all 
neurons in one layer are connected to all neurons in the 
following layer [Bishop, 1995].  The mathematical 
formula expressing what is going on in the depicted 
network takes the form: 
 
                                                                        (11) 
 
where θ specifies the parameter vector ,which contains all 
the adjustable parameters of the network; i.e., the weights 
and bias jilj Ww ,, , .Since the bias can be interpreted as 
a weight acting on an input clamped to 1;i.e., 
1, 21 =bb ,the joint description “weight ” will most often 
be applied covering both weights and bias. To determine 
the weight values one must have a set of examples of how 
the outputs, iyˆ , should relate to the input, lφ , the process 
of obtaining the weights from these examples is called 
supervised learning and it is basically a conventional 
estimation process. That is, the weights are estimated 
from existing examples in such a way that the network, 
according to some metric, models the true relationship as 
accurate as possible. This supervised learning process can 
be implemented through the use of backpropagation 
learning algorithm. 
 
As shown in Figure (5), af(•) and AF(•) represent the 
activation functions for hidden neurons and output 
neurons. In this study, a nonlinear activation function (e.g., 
hyper tangent) is utilized at the hidden neurons so that the 
nonlinearities can serve to enhance the network’s 
approximation capabilities and reduce the impact of noise 
meanwhile a linear activation function is applied at the 
output layer neurons. Such combination, one nonlinear 
hidden layer and the linear output layer, has shown the 
ability to approximate any differentiable function [Haykin, 
1999]. 
 
 
Figure 5: A fully connected Two Layer Feed Forward 
Network 
 
There are many variations of backpropagation learning 
algorithms which are used to speed up the training 
process and avoid local minimums. The variant used in 
this article is the Levenberg-Marquardt learning algorithm. 
This method is considered the fastest and most stable 
among all the available learning algorithms [Chiang, 
2004]. 
 
AN OPEN LOOP DESIGN FOR ANN-RTS 
SMOOTHER SCHEME 
 
As shown in Figure (6), the KF and RTS smoother are 
utilized to optimally estimate the position errors, velocity 
errors, attitude errors, and the sensor biases and 
compensate for their effect in real- time and post-mission 
modes, respectively. In fact, both approaches can provide 
optimally estimated navigation parameters including 
position, velocity and attitudes. In addition, sensor biases 
and scale factors can be estimated and feedback to INS 
mechanization to correct the raw measurements provided 
by an IMU. However, since the scope of this study is 
limited to POS parameters including positions and 
attitude angles, only the components concerning the POS 
parameters are shown in Figure (6).  
 
To obtain those POS parameters with higher accuracy, an 
intelligent compensation method can be implemented to 
, , ,0 ,
1 1
ˆˆ ( ) ( , )
h nn
i i j k k i j i j k o
j l
y t f AF W af w w W
φφ θ φ
= =
⎡ ⎤⎛ ⎞= = + +⎢ ⎥⎜ ⎟⎢ ⎥⎝ ⎠⎣ ⎦∑ ∑
 
Figure 7:  The implementation of ANN embedded KF 
and RTS smoother 
 
ANN-RTS smoother hybrid schemes 
 
Figure 8:  The topology of proposed ANN schemes 
 
RESULTS AND DISCUSSIONS 
 
To evaluate the performance of the proposed schemes, 
three field tests are used. The tests were conducted in land 
vehicle environments using different INS/GPS integrated 
systems consisting of one tactical grade IMUs, Litton 
LN200 (1 deg/hr), a low cost IMU, BEI MotionPak II 
(MEMS), and two NovATel OEM-4 receivers. The 
INS/GPS integrated system with LN200 was used as the 
reference system. Therefore, the measurements and 
navigation solutions provided by the INS/GPS integrated 
systems with MotionPak II were used to verify the 
performance of proposed schemes. Figure (9) shows the 
set up of these systems. Figures (10), (11) and (12) 
illustrate the trajectories of these field tests.  
 
 
 
 
 
 
 
 
 
 
 
 
 
Figure 9:  The set up of the tested systems 
 
Figure 10:  Test trajectory 1 
 
Figure 11:  Test trajectory 2 
 
Figure 12: Test trajectory 3 
 
iMAR-FMS 
LN200 
Accelerometers 
(△ v)
Gyroscopes      
(△ θ)
GPS 
Corrections 
Corrections 
INS KF/RTS 
Smoother 
GPS KF 
(position/velocity)
Gravity 
Positions
Velocities
Attitudes∫
∫ ∫
ANN 
compensation
-1000 0 1000 2000 3000 4000 5000 6000 7000
-2000
-1000
0
1000
2000
3000
4000
East (m)
N
or
th
 (m
)
Trajectory1
Reference trajectory
Simulated outages for testing
N
or
th
 (m
)
-8000 -7000 -6000 -5000 -4000 -3000 -2000 -1000 0
-4000
-3000
-2000
-1000
0
1000
2000
East (m)
N
or
th
 (m
)
Trajectory2
Reference trajectory
Simulated outages for testing
N
or
th
 (m
)
-800 -600 -400 -200 0
-600
-500
-400
-300
-200
-100
0
100
200
East (m)
N
or
th
 (m
)
Trajectory3
Reference trajectory
Simulated outages 
for training
Simulated 
outages for cross 
validation
0 500 1000 1500 2000-0.5
0
0.5
R
ol
l e
rr
or
 (d
eg
)
MPK-Training Results
0 500 1000 1500 2000-0.5
0
0.5
Pi
tc
h 
er
ro
r (
de
g)
0 500 1000 1500 2000-20
0
20
H
ea
di
ng
 e
rr
or
 (d
eg
)
Time (sec)
KF
KF+ANN
RTS
RTS+ANN
 
 
        Figure 14:  Training results of attitudes 
(Trajectory 3) 
 
Performance verification of proposed schemes 
 
To verify the performance of well trained schemes 
including ANN-KF and ANN-RTS smoother schemes, 
sixteen simulated GPS outages in total (30 seconds) that 
were independent from those ten outages used for training 
were selected and marked in blue circles in each test 
trajectory based on their dynamic variations, as depicted 
in Figures (10) and (11). Since each field test was 
conducted independently, therefore, the simulated GPS 
outages selected from the first and second field test used 
for the verification were independent to those outages 
selected from the third field test used for training. The 
dynamic variations experienced by the vehicle during 
those simulated outages include straight line segments, 
sharp turns, accelerations and decelerations.  
 
Figures (15a) to (15b) and Figures (16a) to (16b) depict 
the testing results of proposed schemes, respectively. As 
shown in Figures (15a), (15b) (16a) and (16b), both 
ANN-KF and ANN-RTS smoother schemes are capable 
of reducing the POS errors of the KF and RTS smoother, 
respectively. The summary of testing results is illustrated 
in Table 2. As depicted in Table 2, the proposed ANN-KF 
scheme first improves all the errors of roll angles, pitch 
angles and heading angles estimated by the KF by 40%, 
40%, and 50% in average, respectively. In addition, it 
effectively reduces the positional errors in north, east and 
height by 30%, 45% and 30%, respectively. Since the 
errors of roll and pitch can be well estimated by the KF 
during measurement update using GPS velocities or 
positions, the proposed ANN-KF schemes can not provide 
significant improvement concerning those two attitude 
angles. On the contrary, the proposed schemes are able to 
provide significant in compensating for the heading errors 
estimated by the KF.  This step is very important to 
mobile mapping applications as heading errors can be 
considered critical for the positioning errors estimated the 
KF during GPS outages.  
 
Therefore, the proposed ANN-KF compensation scheme 
is able to improve the accuracies of positional 
components as well as orientation components in real 
time. After applying ANN-KF compensation, the 
orientations estimated by the KF can be improved to the 
level of using a RTS smoother in real time mode even 
with the use of a low cost MEMS IMU. In addition, the 
relatively large attitude errors shown in Figures (16b) for 
the first 200 seconds can be considered as the 
convergence period for the in-motion alignment for the 
use of a low cost MEMS IMU, therefore proposed ANN-
KF scheme can accelerate the in-motion alignment 
process as well as improve its accuracy. 
 
Table 2 illustrates the improvements produced by the 
proposed ANN-RTS smoother scheme. The proposed 
ANN-RTS smoother scheme improve all the errors of roll 
angles, pitch angles and heading angles estimated by the 
KF by 75%, 70% ,and 75% in average, respectively. In 
addition, all of the improvements in positional POS 
parameters reach 80% in average comparing to the KF.  
On the other hand, the proposed ANN-RTS smoother 
scheme improve all the errors of roll angles, pitch angles 
and heading angles estimated by the RTS smoother by 
70%, 50% ,and 70% in average, respectively. In addition, 
all of the improvements in positional POS parameters 
reach 30% in average comparing to the RTS smoother. 
 
0 500 1000 1500 2000 2500-50
0
50
N
or
th
 e
rr
or
 (m
) MPK-Testing Results (Tj-1)
0 500 1000 1500 2000 2500-20
0
20
Ea
st
 e
rr
or
 (m
)
0 500 1000 1500 2000 2500-20
0
20
H
ei
gh
t e
rr
or
 (m
)
Time (sec)
KF
KF+ANN
RTS
RTS+ANN
 
             Figure 15a:  Test results of positions 
(Trajectory 1) 
 
The proposed ANN-RTS smoother scheme improves all 
the errors of POS parameters estimated by the KF and 
RTS smoother significantly for the MEMS systems. 
Among those POS parameters compensated by proposed 
ANN-RTS smoother scheme, the improvement for the 
orientation parameters is more significant than positional 
parameters. Consequently, for the low cost MEMS system 
with proposed ANN-RTS smoother compensation, the 
POS parameters estimated by RTS smoother can be 
improved to the level of using a medium tactical grade 
system. Figure (17) illustrate the impact of ANN-RTS 
well trained schemes were verified using the rest of the 
test data sets.  
 
The preliminarily results presented in this article indicate 
the proposed ANN-KF compensation scheme is able to 
improve the accuracies of positional components as well 
as orientation components in real time. After applying 
ANN-KF compensation, the orientations estimated by the 
KF can be improved to the level of using a RTS smoother 
in real time mode even with the use of a low cost MEMS 
IMU. On the contrary, the proposed ANN-RTS smoother 
scheme improves all the errors of POS parameters 
estimated by the KF and RTS smoother significantly for 
the MEMS systems. Among those POS parameters 
compensated by proposed ANN-RTS smoother scheme, 
the improvement for the orientation parameters is more 
significant than positional parameters. Consequently, for 
the low cost MEMS system with proposed ANN-RTS 
smoother compensation, the POS parameters estimated by 
RTS smoother can be improved to the level of using a 
medium tactical grade system. 
 
Therefore, the proposed ANN embedded POS algorithm 
can be considered as a cost effective tool to improve the 
accuracy of POS parameters to meet the requirements for 
mobile mapping applications with the use of a low cost 
MEMS IMU. Those results can be considered positive for 
the inclination of a low cost MEMS IMU for the 
development of a cost effective position and orientation 
system for medium MMS applications.      
 
ACKNOWLEDGEMENTS 
 
The authors would acknowledge the financial support by 
the National Science Council of the Executive Yuan, 
ROC(Taiwan) (NSC 95-2221-E-006 -335 -MY2) from their 
supervisor, Dr. Kai-Wei Chiang, who initially encouraged 
them to apply and by given them the time and resources 
needed for helping them accomplishing this work. Yun-
Wen Huang is acknowledged for helping them 
accomplish this work.  
 
Dr Naser El-Sheimy and Dr. Xiaoji Niu from the MMSS 
group at the Department of Geomatics engineering, the 
University of Calgary are acknowledged by providing the 
field test data sets applied in this research. Dr. Eun-Hwan 
Shin is acknowledged for providing the INS 
mechanization and INS/GPS extended Kalman filter used 
in this article. 
 
REFERENCES 
 
Bar-Itzhack, I.Y. and Berman, N. (1988): Control 
Theoretic Approach to Inertial Navigation System, AIAA 
Journal of Guidance, Control & Dynamics, Vol. 11, pp. 
237-245. 
 
Bishop, C.M. (1995): Neural Networks for Pattern 
Recognition, Oxford University Press. 
 
Brown R.G. and Hwang P.Y.C. (1992): Introduction to 
random signals, John Wiley and Sons, New York, 1992. 
 
Chiang, K. W. Noureldin, A and El-Sheimy, N. (2003): A 
New Weight Updating Method for INS/GPS Integration 
Architectures Based on Neural Networks, Measurement 
Science and Technology Vol.15, No.10, pp. 2053-2061  
 
Chiang, K.W. (2004): INS/GPS Integration Using Neural 
Networks for Land Vehicular Navigation Applications, 
Department of Geomatics Engineering, the University of 
Calgary, Calgary, Canada, UCGE Report 20209 
 
El-Sheimy, N (1996): The Development of VISAT - A 
Mobile Survey System for GIS Applications, Ph.D. thesis, 
UCGE Report No. 20101, Department of Geomatics 
Engineering, the University of Calgary. 
 
El-Sheimy, N. (2002): Introduction to Inertial Navigation, 
ENGO 699.71 lecture notes, Geomatics department, 
University of Calgary. 
 
Gelb, A. (1974): Applied Optimal Estimation, The 
Analytic Science Corporation. 
 
Goodall, C., El-Sheimy, N., and Chiang, K.W.,(2005): 
The Development of a GPS/MEMS INS Integrated 
System Utilizing a Hybrid Processing Architecture, 
Institute of Navigation GNSS 2005 proceedings, Sept.13-
16, Long Beach, California 
 
Haykin, S. (1999): Neural Networks: A Comprehensive 
Foundation, 2nd Edition, Prentice-Hall, New Jersey 
 
Shin, E.H. (2005): Estimation Techniques for Low-Cost 
Inertial Navigation, Ph.D. thesis, UCGE Report 20219, 
Department of Geomatics Engineering, The University of 
Calgary. 
 
Vanicek, P. and Omerbasic, M.(1999): Does a navigation 
algorithm have to use Kalman filter?, Canadian 
Aeronautics and Space Journal, Vol. 45, No. 
3,Septmber,1999. 
 
表 Y04 
一、 參加會議經過 
 
    本人此行的目的在參與並發表國際攝影測量與遙感學會 (International Society for 
Photogrammetry and Remote Sensing, ISPRS)於北京主辦之 2008 年會並發表一篇學術論文。該
學會成立於 1910 年，是國際一級學術組織。該組織以推動國際攝影測量、遙感與空間信息
技術的發展、應用與交流合作為宗旨，成員遍及近百個國家和地區，下設 8 個技術委員會，
具有學術活動歷史悠久、組織嚴密、參與面廣、影響力大、知名度高等特點。其每四年舉辦
一次國際攝影測量與遙感大會(ISPRS Congress)，研討最新前沿技術與發展方向，展示最新技
術系統與成果，制訂下一個四年的研究指南，選舉新一屆領導機構。 
 
    本人所發表論文的標題為 An ANN Embedded RTS Smoother for INS/GPS Integrated POS 
Applications；而本文的作者依序為 Yun-Wen Huang, Kai-Wei Chiang, Yung-Cheng Lin, Naser 
El-Sheimy (黃芸玟、江凱偉、林泳成與 Naser El-Sheimy)。本文為測量及空間資訊系的成員與
加拿大 University of Calgary Department of Geomatics Engineering 之系主任 Dr. El-Sheimy 共
同合作之文章。本研究的主要動機即在於針對傳統 INS/GNSS 整合式的定位定向演算法從軟
體觀點提出有效的性能提升策略。本研究將以本系所擁有的 MEMS 等級的 IMU 為基礎發展
類神經網路嵌入式的高精度 INS/GNSS 精密定位定向演算法。本研究最重要的創新在於率先
提出以鬆耦合架構擴充而得之 ANN-RTS 平滑器混合架構，並利用此架構發展適用於低成本
IMU 之類神經網路嵌入的 INS/GNSS 定位定向演算法。初步的研究結果顯示本文所提出之演
算法在定位精度部分平均可以提升近 40%，而在姿態精度之部分平均可以提升近 60%。換言
之，吾人可以將使用低價位 MEMS IMU 之 POS 精度提升至接近使用低階戰術等級 IMU 之
水準。本研究承國科會經費資助下而完成(NSC 95-2221-E-006 -335 -MY2)。 
 
本人於 7 月 2 日 10 點 25 分搭乘華航 CI 621 由高雄小港國際機場出發並於 11 點 55
分抵香港並轉搭港龍航空 KA 992 至北京。飛機於下午 5 點左右抵達北京首都國際機場。北
京首都國際機場的第三航站大廈十分新穎且空間寬敞舒適。唯北京空氣汙染相當嚴重，晚上
至北京國際會議中心報到後住宿於與鳥巢體育館僅一馬路之隔的五洲大酒店。 
 
7 月 3 日早即於 8 點 30 分前抵達會場參加相關的研討。晚上參加大會主辦之 Opening 
ceremony 後與來自加拿大 University of Calgary Department of Geomatics Engineering 之數名
學者共進晚餐，當晚投宿於五洲大酒店。  
表 Y04 
此行的相關費用，致以由衷萬分謝意！  
 
三、 考察參觀活動(無是項活動者省略) 
   
7 月 7 日早上應上海微掌公司牛小驥博士之邀至該公司發表演講，並與該公司資深研究
員共同討論整合系統應用於個人攜行導航系統之可行性。該公司為美商Sirf(世界第一大GPS
導航晶片之供應商)所成立之子公司。 
 
當天下午在牛博士陪同下應上海交通大學空天科學技術發展研究院戰興群教授之邀赴
該校發表演講，並與戰教授之研究群深入交換意見。這次的訪問對於未來促進雙方更進一步
的交流有很大的意義。大陸研究生的積極與獨立研究能力值得我們的學生學習。同時上海交
大的新校區相當廣闊且設備相當新穎。當晚與戰教授的研究群一起用餐，晚上宿於佳友維景
飯店。 
 
7 月 8 日早上應上海微掌公司牛小驥博士之邀再度至該公司進行小組討論。下午安排上
海外灘之參訪行程，晚上宿於佳友維景飯店。 
 
7月9日早上1130搭乘港龍航空KA803由上海浦東機場出發於下午2點半左右抵達香港；
隨即搭華航 CI626 於傍晚 6點抵小港機場。 
 
四、 建議 
 
    雖然近年的國家財政狀況不佳，導致各項預算支出均必須刪減，若能客觀規劃積極支持
有意義的國際學術活動，增加臺灣在國際舞台上的能見度，也提攜國內年輕一代增加他們的
國際活動歷練，對國內科技生根紮實迎頭趕上甚至超越國際水準，都是一項值得投資的多效
益規劃，因此，建議在國家財政能力許可下，多鼓勵支持並補助國內學者與研究生參與國際
學術活動。在此將相關建議事項列舉如下： 
 
1. 國科會所補助之機票費用無法反映現況，建議依年度調整已適度減低受補助者之負擔。
2. 建議國科會提高補助學生國發表論文補助之額度，現行的補助制度增加學生至歐美發表
論文的經濟負擔。 
