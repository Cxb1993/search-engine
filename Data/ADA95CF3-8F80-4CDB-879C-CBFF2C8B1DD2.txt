the inteference to the overlaying macrocells and can 
maximize its total throughput for serving multiple 
users as well by integrating the multiuser scheduling 
techniques.  
 
In the second year, we proposed a location-aware 
mechanism combined with a low-cost four-sector 
switched-beam directional antenna to enhance the 
spectrum efficiency of orthogonal frequency-division 
multiple access (OFDMA)-based femtocell systems.  
 
In the last year, we further investigate how to 
improve the performance of the network MIMO system by 
further equipping multiple antennas at each base 
station. we present a 3-cell network multipleinput 
multiple-output (MIMO) architecture with fractional 
frequency frequency (FFR) and a novel tri-sector 
frequency partition scheme. We demonstrate that the 
FFR-based 3-cell network MIMO architecture with the 
proposed tri-sector frequency partition can not only 
effectively overcome the intergroup interference, but 
can avoid executing the complex multibase-station 
joint processing for a huge number of cluster of 
cells at all locations. 
英文關鍵詞： hierarchical cognitive radio network, Femtocell, 
network MIMO 
 
計畫成果自評 
    在此綠能寬頻無線電之研究計畫中，我們研究如何建立低功率的無線進接網路及後端接取網路
架構，而且又能維持很好的 又能抱持好的服務品質。此計劃考慮三種基地台架構：(1) 階層式感
知無線電網路 (Hierarchical Cognitive Radio Network) ; (2) 超微微細胞基地台 (Femtocell) ; 
(3) 網路多天線系統 (Network Multiple Input Multiple Output Systems)。 
 
    在第一年的計劃中，我們使用最佳化的技巧，提出智慧型多天線如何階層式基地台架構設計出
最佳波束權重與能量分配，減低對Macrocell的干擾，並結合多用戶排程技術，將整體用戶的總容
量最佳化。  
 
    在第二年的計劃中，我們在正交分頻多重接取之毫微微細胞系統下，提出了一個位置知曉機制，
同時結合一個低成本、四區段的切換式波束方向性天線，以提高頻譜效率。 
 
    在第三年的計劃中，我們使用多重天線在多個細胞內進行合作式的傳輸。在此部份提出了一個
結合細胞扇區化、部分頻率重複使用之三細胞合作為基礎的網路多重天線系統，此架構用來降低多
細胞系統中嚴重的細胞間干擾問題。 
 
各年度研究執行成果將說明如後，且相關論文發表如下: 
[1] Meng-Lin Ku, Li-Chun Wang, and Yu-Ted Su, "Toward Optimal Multiuser Antenna Beamforming for 
Hierarchical Cognitive Radio Systems,” IEEE Trans. on Communications, Vol.60, No. 10, pp. 2872~2885, 
Oct. 2012. 
[2] A. H. Tsai, L. C. Wang, J. H. Huang, and R. B. Hwang, “High-Capacity OFDMA Fentocells by Directional 
Antennas and Location Awreness,” IEEE Systems Journal, Vol. 6, No. 2, pp. 329-340, June 2012. 
[3] Li-Chun Wang and Chu-Jung Yeh, “3-Cell Network MIMO Architectures with Sectorization and Fractional 
Frequency Reuse,” IEEE Journal in Selected Area in Communications, Vol. 29, No. 6, pp. 1185-1199, May, 
2011 
[4] Meng-Lin Ku, Qingchun Chen, Saeed S. Ghassemzadeh, Vahid Tarokh, and Li-Chun Wang, “Service Coverage 
for Cognitive Radio Networks with Cooperative Relays in Shadowed Hotspot Areas,” IEEE WCNC, Mar. 
2011. 
[5] A. H. Tsai, L. C. Wang, J. H. Huang, and R. B. Hwang, “Stable Subchannel Allocation for OFDMA Fentocells 
with Switched Multi-beam Directional Antennas,” IEEE GlobeCom, Dec. 2011. 
[6] Meng-Lin Ku, Li-Chun Wang, Yu-Ted Su, “Optimal Multiuser Beamforming and Power Allocation for 
Hierarchical Cognitive Radio Systems,” IEEE ISSSTA/ISITA, Oct. 2010. 
[7] Li-Chun Wang and Chu-Jung Yeh, “A Three-Cell Coordinated Network MIMO with Fractional Frequency 
Reuse and Directional Antennas,” IEEE ICC, May, 2010. 
 
 
 
三、Publication 
[1] Meng-Lin Ku, Li-Chun Wang, and Yu-Ted Su, "Toward Optimal Multiuser Antenna Beamforming 
for Hierarchical Cognitive Radio Systems,” IEEE Trans. on Communications, Vol.60, No. 10, pp. 2872 
~2885, Oct. 2012. 
[2] Meng-Lin Ku, Qingchun Chen, Saeed S. Ghassemzadeh, Vahid Tarokh, and Li-Chun Wang, “Service 
Coverage for Cognitive Radio Networks with Cooperative Relays in Shadowed Hotspot Areas,” IEEE 
WCNC Mar. 2011. 
[3] Meng-Lin Ku, Li-Chun Wang, Yu-Ted Su, “Optimal Multiuser Beamforming and Power Allocation 
for Hierarchical Cognitive Radio Systems, IEEE ISSSTA/ISITA, Oct. 2010. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
KU et al.: TOWARD OPTIMAL MULTIUSER ANTENNA BEAMFORMING FOR HIERARCHICAL COGNITIVE RADIO SYSTEMS 2873
data rate that can be provided by the underlying CR system
for the secondary users. Hence, the SINR constraint is set
as the the minimum link quality requirement for concurrent
multiuser transmissions, depending on signalling schemes and
bit error rates. The transmission power constraint is to limit
the maximum total transmission power at the underlying CR
base station (BS).
The HCR system can be regarded as a paradigm of the tradi-
tional two-user interference channel problem where two users
transmit independent messages without cooperation. The exact
capacity region of the two-user interference channel is not yet
fully understood and remains an open issue. In this channel
model, each transmit-receive pair wishes to achieve reliable
communications, but the two users interfere with each other.
The capacity region is only known for a few special cases such
as the Gaussian interference channel or discrete memoryless
interference channel with strong interference [24][25]. The
growth of CR has recently motivated many works to study the
two-user interference channel with one cognitive transmitter
[26]–[28]. The channel models considered in [26][29][30]
assume that the cognitive transmitter could non-causally or
causally access the message of the primary transmitter to
enable interference reduction and improve transmission rates
through some precoding strategies, e.g., Gel’fand-Pinsker cod-
ing in [31] and Costa’s dirty paper coding in [32]. Due to the
one-side transmitter cooperation, finding the capacity region
of the two-user cognitive interference channel is much easier
than that of the traditional two-user interference channel. The
optimization framework to determine the sum capacity of
the cognitive interference channel is in general a non-convex
problem. Based on theoretical results in [29], the work of
[33] thus attempts to optimize the sum capacity of a multi-
input multi-output (MIMO) cognitive interference channel by
applying duality techniques. However, the results invented by
this work can only provide us an upper bound for the sum
rate of the two-user interference channel (or equivalently, the
HCR system) as it is assumed that the message of the primary
transmitter is fully acquirable at the cognitive transmitter.
Therefore, it is imperative to understand the achievable sum
rate of the traditional two-user interference channel and to
benchmark the sum rate performance of the HCR system from
practical design viewpoints.
In this paper, we jointly design the beamforming weights
and the allocated power for each CR user to maximize the
sum rate of the underlying CR system, while satisfying the
constraints of the interference power to the primary BS, the re-
quired SINR for the secondary users, and the total transmitted
power from the secondary BS. The design framework for the
HCR system discussed in this paper can help us understand:
(1) how beamforming techniques can be used to manage the
interference in the HCR system; (2) what sum rate can be
achieved in the underlying CR system. Actually, the sum rate
maximization problem is strongly NP-hard even for a standard
multiuser power control problem [34]. Compared with those
works without adopting beamforming or merely concerning
power control [5]–[17], it is more challenging to find the op-
timal solution for the joint multiuser beamforming and power
allocation with all the aforementioned considered constraints,
which is indeed a non-convex optimization problem. Detailed
review of these related works will be conducted in Section II.
The main contribution of this paper is to solve the afore-
mentioned non-convex optimization problem by proposing
an iterative sum rate maximization (ISM) algorithm. First,
we optimize the sum rate of the microcellular system by
alternatively maximizing its lower bound performance and
discuss the feasibility of the three imposed constraints. A
necessary condition for the choice of Imax and γmin,k to make
the considered optimization problem feasible is provided,
where Imax and γmin,k are the given values with respect
to the interference power and SINR constraints, respectively.
Besides, we also analyze the feasibility condition for the
case where secondary users are ideally scheduled at different
spatial angular directions. Second, we transform the problem
of interest into a form of convex optimization by introducing
auxiliary variables in the objective function to constrain the
intra-user interference power among the secondary users. The
transformation approach used for tackling the non-convex sum
rate maximization problem is inherently different from the
conventional epigraph approach in [15] although they look
similar at the first glance. The idea of our approach originates
from an observation that by fixing the values of the auxiliary
variables, the non-convex optimization problem becomes a
manageable convex optimization problem. In addition, an
iterative procedure is provided for updating two lower bound-
related coefficients so as to tighten the lower bound of the sum
rate performance. It is proved that when the iterative procedure
converges, the optimal solution of the transformed convex
optimization problem with the two converged coefficients is
a local maximizer of the original sum rate maximization
problem. Third, we use the Lagrangian function and Karush-
Kuhn-Tucker (KKT) conditions to analyze the optimal sum
rate performance with respect to the perturbations of the
auxiliary variables. Interestingly, we find that the maximum
achievable sum rate of the transformed equivalent system
can proportionally increase with respect to the introduced
auxiliary variables when the intra-user interference power
constraints among the secondary users are inactive for the
derived optimal beamforming weights, i.e., the equality for the
intra-user interference power constraints does not hold. When
the intra-user interference power constraints are active, i.e.,
the equality for the intra-user interference power constraints
becomes effective, one can increase the sum rate by trading
off the objective of maximizing the matched output power and
that of minimizing the intra-user interference power among
the secondary users. This property helps the proposed ISM
algorithm maximize the underlying microcellular sum rate,
while complying with all the three aforementioned constraints.
The developed methodology can enhance the underlying CR
systems to achieve the maximum sum rate, and facilitate the
coexistence with noncognitive systems.
The rest of this paper is organized as follows. Some related
works are introduced in Section II. In Section III, we describe
the HCR system model, where multiple antennas are used at
the underlying CR system for downlink broadcasting. Section
IV introduces the sum rate maximization problem by jointly
designing multiuser beamforming and power allocation with
the constraints of SINR, interference power, and transmission
power and discuss the feasibility of the three imposed con-
KU et al.: TOWARD OPTIMAL MULTIUSER ANTENNA BEAMFORMING FOR HIERARCHICAL COGNITIVE RADIO SYSTEMS 2875
ŖŴŦųġĤĳ
őųŪŮŢųźġŶŴŦų
ŎŢŤųŰŤŦŭŭŶŭŢųġŴźŴŵŦŮ
ŎŪŤųŰŤŦŭŭŶŭŢųġŴźŴŵŦŮ
0g
2g
0h
1g
^ `2 2,w h ^ `1 1,w h
ŖŴŦųġĤĲ
1D
0D
0d
1d
2d
Fig. 1. An HCR system model.
at providing reliable communications for the secondary users
and avoids yielding severe interference to the primary user.
Denote sj and x as the transmitted signals from the
secondary BS to the jth secondary user and that from the
primary user to the primary BS, respectively. Assume that the
transmitted signals sj and x are uncorrelated with each other,
i.e., E
[
xs∗j
]
= 0 for all j, and E
[
sis
∗
j
]
= 0 for all j = i.
Furthermore, the energy of signal sources is assumed to be
normalized to one, i.e., E
[
|sj|2
]
= E
[
|x|2
]
= 1 for all
j. An M × 1 column vector wj represents the beamforming
weight for the jth secondary user, for j = 1, . . . ,K . Then,
the received signal at the kth secondary user is given by
rk =
⎛
⎝ K∑
j=1
wjsj
⎞
⎠
†
hk +
√
Qgkx+ zk, k = 1, . . . ,K ,(1)
where hk denotes the channel response corresponding to M
antennas between the secondary BS and the kth secondary
user; Q denotes the transmitted power for the primary user;
gk represents channel response between the primary user and
the kth secondary user; and zk is Gaussian noise at the kth
receiver side with zero mean and variance σ2z . On the other
hand, the received signal at the primary BS can be written as
r0 =
√
Qg0x+
(∑K
j=1
wjsj
)†
h0 + z0 , (2)
where z0 denotes the noise at the primary BS, and h0 and
g0 represents the channel from the secondary BS to the
primary BS and that from the primary user to the primary BS,
respectively. Let D0 and d0 be the distance from the primary
BS to the secondary BS and to the primary user, respectively,
and represent dk as the distance between the primary user
and the kth secondary user (k = 1, . . . ,K). For simplicity,
we assume that the secondary users are uniformly distributed
within a circle of a fixed radius D1. Assume that long-term
power control is adopted to compensate path loss in both the
macrocellular and microcellular systems. Hence, in (1) and (2)
the channel responses gk with the effects of shadowing and
multipath fading are represented as
gk =
{√
βkak, k = 0√
ξkβkak, k = 1, . . . ,K ,
(3)
where ak is a Rayleigh-faded channel gain, βk stands for
the log-normal shadowing with a variance of S, ξk char-
acterizes the effective interference power boost for the kth
secondary user resulting from the perfect power control
mechanism at the primary user. Due to the long-term power
control for compensating path loss, the power emitted by the
primary user is scaled by a factor of (d0/dref )α1 , where
dref is the reference distance, and α1 is the path loss
exponent of the primary system. Thus, the effective inter-
ference power gain to the kth secondary user is given by
ξk=(d0/dref )
α1 (dref/dk)
α1 =(d0/dk)
α1
. Similarly, we can
express the channel responses hk as
hk =
⎧⎨
⎩
√
ξβ˜ka˜kvk, k = 0√
β˜ka˜kvk, k = 1, . . . ,K ,
(4)
where vk is the steering vector characterizing the relative
phase response of each antenna; a˜k and β˜k have the same
definitions as ak and βk in (3), respectively; ξ=(D1/D0)α2
models the effective interference power gain for the relative
distance of D1 and D0 with the path loss exponent α2 in the
secondary system. Note that for a linear array with antenna
spacing of half a wavelength and a far-field narrowband source
assumption, the steering vector can be expressed as vk =[
1, e−jπ sin θk , . . . , e−j(M−1)π sin θk
]T
, where θk is the spatial
angle for the kth secondary user and −π2 ≤ θk < π2 [35].
IV. JOINT MULTIUSER BEAMFORMING AND POWER
ALLOCATION
A. Sum Rate Maximization Problem
From (1), the average SINR for the kth secondary user is
given by
Υk =
∣∣∣w†khk∣∣∣2∑K
j=1,j =k
∣∣∣w†jhk∣∣∣2 +Bk
, k = 1, . . . ,K , (5)
where Bk = Q |gk|2 + σ2z is the noise plus the interference
power resulted from the primary user. The achievable sum rate
for all the secondary users in the underlying CR system can
be lower bounded by
Rsum =
∑K
k=1 log2 (1 + Υk)
≥∑Kk=1 pklog2 (Υk) + ρk  Rsum,lb , (6)
where the two coefficients pk and ρk can be chosen as pk =
ςk/(1 + ςk) and ρk = log2 (1 + ςk) − pk log2 (ςk), for any
given ςk > 0 [13]. In fact, the equality in (6) holds when
pk = Υk/(1 + Υk) and ρk = log2 (1 + Υk) − pk log2 (Υk),
and the equality holds for (pk, ρk) = (1, 0) if Υk approaches
plus infinity.
Our objective is to maximize the sum rate of the secondary
system by tightening the lower bound in (6) subject to the
following three constrains: (1) to ensure the interference power
to the primary BS; (2) to guarantee the SINR requirement for
KU et al.: TOWARD OPTIMAL MULTIUSER ANTENNA BEAMFORMING FOR HIERARCHICAL COGNITIVE RADIO SYSTEMS 2877
variables W and Ω because the objective function in (10)
or (11) is the logarithm of a quadratic-over-linear function,
which appears as a non-concave one. The non-concavity can
be intuitively checked by rewriting the objective function in
(10) as the minus of two convex functions 2 log2
(
w†khk
)
and log2 (Ωk +Bk). However, we show that (11) is indeed
a convex optimization problem for a given Ω. Clearly, the
constraints (C.1), (C.3), and (C.4) in (11) are convex since
they appear in the formulation of the non-negative weighted
sums of quadratic functions. The constraint functions of (C.5)
and (C.6) are linear. We can further express (C.2) in (11)
as a second-order cone convex constraint like [38]. Since the
above optimization problem of (11) for any fixed value of Ω
is convex, one can obtain the optimal beamforming weight
vectors to achieve the maximum sum rate R1 (pk, ρk,Ω).
B. Tightness of Sum Rate Lower Bound Performance
The lower bound performance of (6) is strictly related to pk
and ρk, and we tighten the performance by iteratively updating
the two coefficients. Define wˆ(i)k as the optimal solution of
(11) for a given
(
p
(i)
k , ρ
(i)
k ,Ω
(i)
k
)
at the ith iteration. In the next
iteration, we update Υ(i+1)k = Υk
(
wk ← wˆ(i)k
)
, Ω
(i+1)
k =∑K
j=1,j =k
∣∣∣wˆ(i)j hk∣∣∣2, and the two coefficients as
p
(i+1)
k = pk
(
ςk ← Υ(i+1)k
)
;
ρ
(i+1)
k = ρk
(
ςk ← Υ(i+1)k
)
,
(12)
where
(
p
(0)
k , ρ
(0)
k ,Ω
(0)
k
)
are initialized as (1, 0,∞), and the
notation f(x ← y) means that the variable x in f(·) is replaced
by y. We repeat the above procedure until the values of pk
and ρk converge, i.e., p(i+1)k = p
(i)
k = p
∗
k, ρ
(i+1)
k = ρ
(i)
k = ρ
∗
k,
and Ω(i+1)k = Ω
(i)
k = Ω
∗
k and it possesses the following two
important properties:
1) Convergence: The update of p(i)k and ρ(i)k monoton-
ically increases the lower bound performance. That
is, we have
∑K
k=1 p
(i+1)
k log2
(
Υ
(i+1)
k
)
+ ρ
(i+1)
k ≥∑K
k=1 p
(i)
k log2
(
Υ
(i+1)
k
)
+ ρ
(i)
k . This can be easily veri-
fied from (6), and thus, the convergence can be obtained.
2) Local maximizer: When the iterative procedure con-
verges, the optimal solution of (11) with (pk, ρk,Ωk) =
(p∗k, ρ
∗
k,Ω
∗
k) can reach a local maximizer of the original
sum rate maximization problem, i.e., the problem that
the objective function Rsum = ∑Kk=1 log2 (1 + Υk) is
adopted in (11). See Appendix C for the proof.
C. Iterative Sum Rate Maximization (ISM) Algorithm
Now, we determine the optimal value for Ω under the
converged values of (p∗k, ρ∗k):
Ωˆ = argmax
Ω
R1 (p
∗
k, ρ
∗
k,Ω) . (13)
Although Ωˆ in (13) can be obtained by the exhaustive search,
it is still preferable to develop an efficient way to reduce the
computational complexity. First, according to (10), we define
R2 (Ω,W) =
K∑
k=1
p∗k · log2
(
1
Ωk+Bk
(
w†khk
)2)
+ ρ∗k
 f (Ω) + g (W) ,
(14)
where f (Ω) =
∑K
k=1 −p∗k · log2 (Ωk +Bk) and g (W) =∑K
k=1 2p
∗
k · log2
(
w†khk
)
+ ρ∗k. For convenience of notation,
we omit p∗k and ρ∗k in R1 (p∗k, ρ∗k,Ω). From (11) and (14), it
follows that
R1 (Ω) = max
W∈Θ(Ω)
R2 (Ω,W)
= max
W∈Θ(Ω)
{f (Ω) + g (W)} , (15)
where Θ (Ω) is the feasible set associated with the opti-
mization problem of (11) and its size depends on the value
of Ω. Consider two vectors Ω(1) =
[
Ω
(1)
1 , . . . ,Ω
(1)
K
]T
and
Ω(2) =
[
Ω
(2)
1 , . . . ,Ω
(2)
K
]T
, leading to two non-empty feasible
sets Θ(1) and Θ(2), respectively. By letting Ω(2) ≤ Ω(1) (i.e.,
Ω
(2)
k ≤ Ω(1)k ∀k), we can observe that
f
(
Ω(2)
)
≥ f
(
Ω(1)
)
. (16)
Define Rg (Ω) = max
W∈Θ(Ω)
g (W). Since Θ(2) is a subset of
Θ(1) if Ω(2) ≤ Ω(1), one can see that
Rg
(
Ω(2)
)
≤ Rg
(
Ω(1)
)
. (17)
To further analyze the optimal value of Rg (Ω) with respect
to the perturbations of the auxiliary vector Ω, we can write a
Lagrangian function by incorporating the constraint of (C.4) in
(11) into the objective function g (W). Hence, we transform
the optimization problem of Rg (Ω) = max
W∈Θ(Ω)
g (W) into
its equivalent form:
Rg (Ω) = −max
λ≥0
min
W∈Θ˜
−g (W)
+
K∑
k=1
λk
(
K∑
j=1,j =k
∣∣∣w†jhk∣∣∣2 − Ωk
)
,
(18)
where λ = [λ1, . . . , λK ]T is a Lagrange multiplier vector with
respect to the constraint of (C.4), and Θ˜ is a convex set formed
by all constraints in (11), exclusive of (C.4). From (18), we
then show that
Rg
(
Ω(2)
)
= max
λ≥0,W∈Θ˜
g (W)−
K∑
k=1
λk
(
K∑
j=1,j =k
∣∣∣w†jhk∣∣∣2 − Ω(2)k
)
= g
(
W˜
)
−
K∑
k=1
λ˜k
(
K∑
j=1,j =k
∣∣∣w˜†jhk∣∣∣2 − Ω(2)k
)
≥ g
(

W
)
−
K∑
k=1

λk
(
K∑
j=1,j =k
∣∣∣w†jhk∣∣∣2 − Ω(2)k
)
= g
(

W
)
−
K∑
k=1

λk
(
K∑
j=1,j =k
∣∣∣w†jhk∣∣∣2 − Ω(1)k
)
+
K∑
k=1

λk
(
Ω
(2)
k − Ω(1)k
)
= Rg
(
Ω(1)
)
+
K∑
k=1

λkΔk ,
(19)
KU et al.: TOWARD OPTIMAL MULTIUSER ANTENNA BEAMFORMING FOR HIERARCHICAL COGNITIVE RADIO SYSTEMS 2879
to avoid disturbing the primary user’s transmission at the
preliminary stage. Also, each secondary user is assumed to
be equipped with a cellular signal strength monitoring device
to monitor the noise plus interference power Bk coming from
its surrounding primary user. Afterwards, all these information
is reported to the microcellular BS in turn through their uplink
channels [37].
It is worthwhile to discuss the relationship between the
proposed scheme and the ZFB scheme in [11] and [12]. From
(10), we can observe that when the auxiliary variables Ωk are
all equal to zero, the proposed scheme is degenerated into a
ZFB-based sum rate maximization problem with optimal user
power allocation, i.e., replace wj in (10) by
√
βjwˆZF,j , as
follows:
βˆ = argmax
β
K∑
k=1
pk · log2
(
βk
Bk
)
+ ρk
subject to
(C.1)
∑K
j=1 βj
∣∣∣wˆ†ZF,jh0∣∣∣2 ≤ Imax
(C.2) βkBk ≥ γmin,k, k = 1, . . . ,K
(C.3)
∑K
j=1 βj ‖wˆZF,j‖2 ≤ Pmax ,
(21)
where Wˆ†ZF = [wˆZF,1, . . . , wˆZF,K ]
†
=
(
H†H
)−1
H† is
the ZFB solution, H = [h1, . . . ,hK ], β = [β1, . . . , βK ],
and βj is the power allocated to the jth secondary user.
The degenerated optimization problem of (21) is a convex
one with affine function constraints, and the zero-forcing
condition will rigorously limit the degree of design freedom
for achieving the optimal sum rate, where the allocated power
βj should satisfy the three constraints in (21). Our proposed
scheme, however, bears resemblance to the MMSE solution by
replacing Wˆ†ZF in (21) with Wˆ†MMSE =
(
H†H+Φ
)−1
H†,
where Φ complies with the intra-user interference power
constraints of (C.4) in (10). Due to the relaxation of Ωk = 0,
the proposed scheme offers more flexibility to obtain better
performance than the ZFB scheme.
VI. PERFORMANCE AND DISCUSSION
A. Simulation Setup
Here we describe the simulation environments for evalu-
ating the performance of the proposed ISM algorithm. Table
1 lists the simulation parameters, and the 3GPP-based system
parameters and channel models are adopted in our simulations
[39][40]. Consider a Cartesian coordinate system with X and
Y axes as shown in Fig. 3. Assume that the BSs of the
macrocellular and microcellular systems are located at points
(0m, 300m) and (400m, 0m), respectively. A primary user
randomly appears within the circle centered at (0m, 300m)
with the radius of d0 ≤ 100m, and K secondary users
uniformly locate at a semicircle with angle of arrival (AOA)
θk = −90◦ + [90◦ + 180◦ (k − 1)]/K, for k = 1, . . . ,K , and
the radius of D1 = 100m, 200m or 300m to the secondary
BS. Particularly, we also simulate the case where the sec-
ondary users are randomly distributed within the circle with
the radius of D1 ≤ 300m, i.e., random spatial scheduling.
The secondary BS is equipped with an array of M = K + 1
antenna elements which are separated by half a wavelength.
The thermal noise density and system bandwidth are set as
 0 ,300m m
 400 ,0m m
User #1
User #2User #3
User #4
ġġġġġġőųŪŮŢųźġŃŔ
ġġġġġġőųŪŮŢųźġŶŴŦų
ġġġġġġŔŦŤŰůťŢųźġŃŔ
ġġġġġġŔŦŤŰůťŢųźġŶŴŦų
Secondary BS
Primary BS
T
1D
0d
Fig. 3. Geographical locations of the HCR systems.
−174 dBm/Hz and 10MHz, respectively. Assume that per-
fect power control is used for both macrocellular and microcel-
lular systems, and let the maximum uplink transmission power
of the primary user be 23 dBm. The maximum downlink
total transmission power for the secondary BS is set to be
(49 + 10 log10K) dBm, which is proportional to the number
of secondary users. For each secondary user, the minimum
link quality requirement to achieve a BER=10−6 under BPSK
modulation with coding rate 1/2 is given by 6.4 dB in terms
of SINR [41]. The interference power constraint parameter,
Imax, is calculated according to (A.3). For example, Imax is
given by −91.85 dBm for Pout = 0.01, γ = 6.4 dB, and
d0 = 100m. The variance for the log-normal shadow fading
is 8 dB, and the spatial correlation of the shadowing in the
microcell is modeled by (0.3)Δ/10, where Δ is the distance
between any two secondary users with respect to the reference
distance of 10m. The non-light-of-sight (NLOS) path loss
model is used for each channel link [39]. We also simulate the
case where the BS-to-BS link is light-of-sight (LOS) in Fig.
8 [39]. The Rayleigh fading is adopted, which is very often
observed in cellular applications. We evaluate the proposed
algorithm in terms of the achievable sum rate Rsum and
the concurrent transmission probability Pct in the secondary
system. The concurrent transmission probability is defined as
the probability that the underlying CR BS can simultaneously
serve all K users in the presence of the primary user [42].
The step size and adjustment parameters δ and ΔT in the ISM
algorithm are set to be 0.1 and 0.02, respectively. In addition,
the ZFB method and the beamforming method, referred to as
”MaxMin SINR” in [15], are simulated to compare with our
proposed ISM algorithm.
B. Numerical Results
Fig. 4 shows the sum rate improvement by using the
ISM algorithm for a cell radius D1 = 200m, compared
to the case without considering the sum rate maximization.
The initial sum rate is small and limited by the intra-user
interference power among the secondary users because the
ISM algorithm initially maximizes the total matched output
power for the secondary users, subject to the three HCR
system constraints (C.1)-(C.3) in (7). Moreover, the sum rate
performance under the converged coefficient (p∗k, ρ∗k,Ω∗k) is
better than the initial sum rate, and the gap becomes significant
KU et al.: TOWARD OPTIMAL MULTIUSER ANTENNA BEAMFORMING FOR HIERARCHICAL COGNITIVE RADIO SYSTEMS 2881
1 2 3 4 5 6 7 8 9
5
10
15
20
25
30
35
40
45
K (Number of Secondary Users)
C s
u
m
 
(bi
ts/
s/H
z)
 
 
D1= 100m
D1= 200m
D1 300m
MaxMin SINR, D1 300m
ZFB, D1 300m
Fig. 6. Achievable sum rates for various numbers of secondary users K
with cell radiuses D1 = 100, 200, and D1 ≤ 300 meters.
1 2 3 4 5 6 7 8 9
0
5
10
15
20
25
30
35
K (Number of Secondary Users)
R e
ff 
(bi
ts/
s/H
z)
 
 
D1= 100m
D1= 200m
D1 300m
ZFB, D1 300m
MaxMin SINR, D1 300m
Fig. 7. Effective sum rates for various numbers of secondary users K with
cell radiuses D1 = 100, 200, and D1 ≤ 300 meters.
is larger than seven, the achievable sum rate is saturated
even if more antennas are deployed at the underlying BS.
While users are uniformly distributed within the cell radius
of 300m, the achievable sum rate is increased proportional
to the number of secondary users K , and the proposed ISM
algorithm can improve sum rate performance by about 8 and
10 bits/s/Hz for K = 7 and K = 9, respectively, compared
to the method that maximizes the worst SINR. This significant
gap is due to the fact that the sum rate formula is a logarithm
function of SINR, and maximizing the worst SINR only does
not necessarily maximize the sum rate performance. With a
great sacrifice of the concurrent transmission probability, the
ZFB method performs slightly better than the proposed ISM
algorithm.
Fig. 7 shows the effective sum rate versus the number of
secondary users. The effective sum rate Reff is defined as the
product of the achievable sum rate Rsum and the concurrent
transmission probability Pct. For D1 = 100m and 200m, the
effective sum rate decreases when the number of users is larger
than six. From the viewpoint of maximizing the effective sum
rate at the cell edge, we suggest deploying an antenna array
with at most seven antennas at the underlying CR BS, covering
an area with the cell radius of 200m when considering the
use of beamforming for SDMA in an HCR system. Besides,
we also simulate the effective sum rate performance of the
ZFB with optimum power allocation in (21) for comparison.
It is found that the proposed scheme performs better than the
ZFB scheme, and the performance gap becomes obvious as K
increases. This is because when K increases, the zero-forcing
criterion will lower the probability for multiuser concurrent
transmission. We can also observe that for D1 ≤ 300m and
K ≤ 9, the maximum effective sum rate offered by the
underlying CR system is not more than 12 bits/s/Hz. The
MaxMin SINR method is inferior to our proposed algorithm,
and the performance gap of the effective sum rate between the
two methods is about 3 bits/s/Hz.
Fig. 8 depicts the effective sum rate performance for differ-
ent SINR outage probabilities of the primary user when the
BS-to-BS link is LOS or NLOS. The simulation is carried
out with a required SINR of the primary user γ = 6.4 dB
or 11.2 dB for BPSK and QPSK modulation, respectively
[41]. It can be generally observed that as γ decreases or Pout
increases, the microcellular system can attain better effective
sum rate performance. As compared with the NLOS channel,
the microcellular system is subject to a performance loss from
3.5 bits/s/Hz to 5 bits/s/Hz in the LOS channel, and the
slope of the improvement across Pout is relatively steeper.
Fig. 9 illustrates the power allocation ratio for each indi-
vidual secondary user in the case of K = 4 and D1 = 100m,
200m, and 300m. We can observe that for D1 = 100m, the
power distributed to each user is almost identical since the
two-tier interference between the microcell and the macrocell
is not a dominant factor in this case. Actually, users closer to
the primary system can consume a little bit more power. When
the cell radius D1 increases to 200m, two users on the central
location are assigned more power (about 27% ∼ 29%) than
the others on the two sides (about 19% ∼ 25%). For a larger
cell radius of 300m, the power allocated to the fourth user
is immediately boosted to a ratio of 39%, thereby decreasing
the accessible power to the other three users. We also find
that the first user away from the primary system acquires
the least power allocation ratio among the four users, and
the ratio tends to decrease as the cell radius increases. When
D1 = 300m, the power ratio for user #1 is merely about 14%.
This phenomenon can be explained as follows. In addition
to the primary user, the fourth secondary user is interfered
with other secondary users. Beamforming technique mainly
exploits the information of the steering vectors, characterized
by the AOA, to separate the secondary users. Since the steering
vectors for the two users on the two sides of the microcell are
highly correlated, the first user is assigned much less power
to ensure the SINR requirement of the fourth user.
Fig. 10 illustrates the achievable sum rate for each sec-
ondary user in the case of K = 4 and D1 = 100m, 200m, and
300m. Except for the fourth user, the secondary system can
provide each secondary user with a user rate ranging between
4 and 8 bits/s/Hz, and a slight degradation can be observed
KU et al.: TOWARD OPTIMAL MULTIUSER ANTENNA BEAMFORMING FOR HIERARCHICAL COGNITIVE RADIO SYSTEMS 2883
bility for the primary user is therefore calculated as
Pr (Υ0 ≤ γ) = Pr
⎛
⎜⎝|g0|2 ≤ γ
(
K∑
j=1
|w†jh0|2+σ2Z
)
Q
⎞
⎟⎠
= Φ
⎛
⎜⎝ ln
(
γ
Q
(
K∑
j=1
|w†jh0|2+σ2Z
))
−m0
σ0
⎞
⎟⎠ ,
(A.2)
where Φ (x) is referred to as the cumulative distribution func-
tion (CDF) of the standard normal distribution. We observe
from (A.2) that to provide the primary user with a target
SINR threshold γ and an outage probability upper bounded
by Pout is equivalent to restricting the interference power to
the following upper limit:
∑K
j=1
∣∣∣w†jh0∣∣∣2 ≤ Imax
= σ2z
(
Q
γσ2z
exp
{
σ0Φ
−1 (Pout) +m0
}− 1) ,(A.3)
where the macrocellular BS only needs to know a preset
average SNR of the primary link, Q
/
σ2z , after power control.
APPENDIX B.
To ease analysis, we assume that γmin,k = γmin, for all k.
Define ζk =
|w†khk|2∑K
j=1 |w†jhk|2 and μk =
|w†khk|2
Bk
. Using (5), we
get
min
k
Υk = min
k
1
1
ζk
+ 1μk
−1 =
1
max
k
(
1
ζk
+ 1μk
)
−1
≥ 1
max
k
(
1
ζk
)
+max
k
(
1
μk
)
−1
 Υ˜ , (B.1)
where we use max
k
(ak + bk) ≤ max
k
ak + max
k
bk. It can be
verified from (B.1) that the SINR constraint (C.2) in (7) is
feasible if there exists beamforming weights wk such that
Υ˜ ≥ γmin. Note that max
k
(
1
μk
)
= 1min
k
μk
and max
k
(
1
ζk
)
=
1
min
k
ζk
. From (C.3) in (7) and applying the Cauchy-Schwarz
inequality, we can write
min
k
μk ≤ 1K
K∑
k=1
1
Bk
∣∣∣w†khk∣∣∣2
≤ 1K
K∑
k=1
1
Bk
‖wk‖2 ‖hk‖2 ≤ PmaxK maxk
(
1
Bk
‖hk‖2
)
.
(B.2)
We now appeal to the results in [15], showing that min
k
ξk ≤
rank(H)
K , where H = [h1, . . . ,hK ]. From (B.1) and (B.2), it
follows that
Υ˜ ≤ 1
K
rank(H) +
K
Pmax
·min
k
(
Bk
‖hk‖2
)
− 1
. (B.3)
Therefore, from (B.1) and (B.3), we conclude that there exist
beamforming weights such that
Υk ≥ γmin, for all k, only if
1
K
rank(H)
+ KPmax ·mink
(
Bk
‖hk‖2
)
−1
≥ γmin .(B.4)
Notice that the rank of H depends on the steering vectors
of secondary users. From (4), the determinant of H can be
computed by applying the Vandermonde determinant [44]. For
the case of K ≤ M and
√
β˜ka˜k = 0 for all k, we can get
det (H) = 0 if and only if
e−jπ sin θm = e−jπ sin θk , for all k = m . (B.5)
Since −π2 ≤ θm < π2 and |sin θm − sin θk| < 2 for any k and
m, it is then straightforward to rewrite (B.5) as
rank (H) = K if and only if
θm = θk, for all k = m . (B.6)
Hence, if secondary users are ideally scheduled at distinct
angular directions in the spatial domain, i.e., rank (H) =
K ≤ M , the necessary condition degenerates into
Υk ≥ γmin, for all k, only if
Pmax
K ·maxk
(
‖hk‖2
Bk
)
≥ γmin . (B.7)
APPENDIX C.
For simplicity, we express the constraint functions in (11),
excluding (C.4), as ψk(W)‡. We now prove that the optimal
solution of (11) with (p∗k, ρ∗k,Ω∗k) satisfies KKT conditions of
the original sum rate maximization problem:
{Wˆ, Ωˆ} = argmax
W,Ω
K∑
k=1
log2
(
1 + 1Ωk+Bk
∣∣∣w†khk∣∣∣2
)
subject to
(C.1 − C.3, C.5, C.6)ψk (W) ≤ 0,
k = 1, . . . , 4K + 2 ,
(C.4)
∑K
j=1,j =k
∣∣∣w†jhk∣∣∣2 ≤ Ωk, k = 1, . . . ,K .
(C.1)
Define v∗k ≥ 0 and λ∗k ≥ 0 as the Lagrangian multipliers
for the constraints ψi(W) ≤ 0 and (C.4), respectively,
and w∗k as the corresponding optimal solution of (11) when
(pk, ρk,Ωk) = (p
∗
k, ρ
∗
k,Ω
∗
k). By applying KKT conditions, the
partial derivative of the Lagrangian dual function of (11) with
respect to wj at (w∗k, v∗k, λ∗k) yields
−2hjh†jw∗j
K∑
i=1,i=j
∣∣∣w∗†i hj∣∣∣2+Bj+(w∗†j hj)2
+
∑
k
v∗k ∇wj [ψk (W)]
∣∣
wk=w∗k
+
K∑
k=1,k =j
2λ∗khkh
†
kw
∗
j = 0 ,
(C.2)
for j = 1, . . . ,K . On the other hand, the KKT conditions
for the Lagrangian dual function of the problem (C.1) with
respect to wj and Ωj are given by
−2hjh†jwj
Ωj+Bj+(w†jhj)
2 +
∑
k
v˜k∇wj [ψk (W)]
+
K∑
k=1,k =j
2λ˜khkh
†
kwj = 0, j = 1, . . . ,K ,
(C.3)
and
λ˜j =
(w†jhj)
2
(Ωj+Bj)
2+(w†jhj)
2
(Ωj+Bj)
, j = 1, . . . ,K , (C.4)
where v˜k ≥ 0 and λ˜k ≥ 0 are the Lagrangian multipliers.
Without loss of generality, λ˜k > 0 as γmin,k is usually
‡The K equality constraints in (C.6) can be represented by 2K affine
inequality constraints.
KU et al.: TOWARD OPTIMAL MULTIUSER ANTENNA BEAMFORMING FOR HIERARCHICAL COGNITIVE RADIO SYSTEMS 2885
[26] N. Devroye, P. Mitran, and V. Tarokh, “Achievable rates in cognitive
radio channels,” IEEE Trans. Inf. Theory, vol. 52, no. 5, pp. 1813–1827,
May 2006.
[27] A. Jovicic and P. Viswanath, “Cognitive radio: an information-theoretic
perspective,” IEEE Trans. Inf. Theory, vol. 55, no. 9, pp. 3945–3958, Sep.
2009.
[28] W. Wu, S. Vishwanath, and A. Arapostathis, “On the capacity of
Gaussian weak interference channels with degraded message sets,” in
Proc. 2006 IEEE Int. Conf. Inf. Sciences and Systems, pp. 1703–1708.
[29] S. Sridharan and S. Vishwanath, “On the capacity of a class of MIMO
cognitive radios,” IEEE J. Sel. Topics Signal Process., vol. 2, no. 1, pp.
103–117, Feb. 2008.
[30] Y. Cao and B. Chen, “Interference channel with one cognitive trans-
mitter,” in Proc. 2008 IEEE Int. Signals, Systems and Computers, pp.
1593–1597.
[31] S. Gelfand and M. Pinsker, “Coding for channels with random param-
eters,” Probl. Contr. Inf. Theory, vol. 9, no. 1, pp. 19–31, 1980.
[32] M. H. M. Costa, “Writing on dirty paper,” IEEE Trans. Inf. Theory, vol.
29, no. 3, pp. 439–441, May 1983.
[33] R. Soundararajan and S. Vishwanath, “Adaptive sum power iterative
waterfilling for MIMO cognitive radio channels,” in Proc. 2008 IEEE
Int. Conf. Commun., pp. 1060–1064.
[34] Z. Q. Luo and S. Zhang, “Dynamic spectrum management: complexity
and duality,” IEEE J. Sel. Topics Signal Process., vol. 2, no. 1, pp. 57–73,
Feb. 2008.
[35] L. C. Godara, “Application of antenna arrays to mobile communications,
part II: beam-forming and direction-of-arrival considerations,” Proc.
IEEE, vol. 85, no. 8, pp. 1195–1245, Aug. 1997.
[36] Z. Q. Luo and W. Yu, “An introduction to convex optimization for
communications and signal processing,” IEEE J. Sel. Areas Commun.,
vol. 24, no. 8, pp. 1426–1438, Aug. 2006.
[37] K. T. Kim and S. K. Oh, “Cognitive ad-hoc networks under a cellular
network with an interference temperature limit,” in Proc. 2008 IEEE Int.
Conf. Advanced Commun. Technology, pp. 879–882.
[38] S. Boyd and L. Vandenberghe, Convex Optimization. Cambridge Uni-
versity Press, 2004.
[39] 3GPP, TR 36.814 (V9.0.0), “Further advancements for E-UTRA physi-
cal layer aspects (Release 9),” Mar. 2010.
[40] 3GPP, TR 36.819 (V11.0.0), “Coordinated multi-point operation for LTE
physical layer aspects (Release 11),” Sep. 2011.
[41] S. J. Lin, W. H. Sheen, I. K. Fu, and C. C. Huang, “Resource scheduling
with directional antennas for multi-hop relay networks in Manhattan-like
environment,” in Proc. 2007 IEEE Mobile WiMAX Symposium, pp. 108–
113.
[42] L. C. Wang and A. Chen, “Effects of location awareness on concurrent
transmissions for congnitive ad hoc networks overlaying infrastructure-
based systems,” IEEE Trans. Mobile Comput., vol. 8, no. 5, pp. 577–589,
May 2009.
[43] G. L. Stuber, Principles of Mobile Communication. Kluwer Academic
Publisher, 2001.
[44] R. A. Horn and C. R. Johnson, Matrix Analysis. Cambridge University
Press, 1990.
Meng-Lin Ku (M’11) received the B.S., M.S. and
Ph.D. degrees in Communication Engineering from
National Chiao Tung University, Hsinchu, Taiwan,
in 2002, 2003 and 2009 respectively. Between 2009
and 2010, he held post-doctoral positions in the
Department of Electrical and Computer Engineering
at National Chiao Tung University and in the School
of Engineering and Applied Sciences at Harvard
University (in chronological order). In August 2010,
he became the faculty member of the Department of
Communication Engineering with National Central
University, currently holding a position as an Assistant Professor. He is
a member of the IEEE Communications Society and served as technical
program committee members for numerous IEEE international conferences
such as VTC, ICCT, etc. He is the executive committee member of the
2012 IEEE International Conference on Telecommunications for Intelligent
Transport Systems. His current research interests are in the wide areas of
next-generation mobile and wireless communications, cognitive radios, and
optimization for radio access.
Li-Chun Wang (M’96, SM’06, F’11) received the
B.S. degree from National Chiao Tung University,
Taiwan, R.O.C. in 1986, the M.S. degree from
National Taiwan University in 1988, and the Ms.
Sci. and Ph.D. degrees from the Georgia Institute
of Technology, Atlanta, in 1995, and 1996, respec-
tively, all in electrical engineering.
From 1990 to 1992, he was with the Telecommu-
nications Laboratories of the Ministry of Transporta-
tions and Communications in Taiwan (currently the
Telecom Labs of Chunghwa Telecom Co.). In 1995,
he was affiliated with Bell Northern Research of Northern Telecom, Inc.,
Richardson, TX. From 1996 to 2000, he was with AT&T Laboratories, where
he was a Senior Technical Staff Member in the Wireless Communications
Research Department. Since August 2000, he has joined the Department of
Electrical and Computer Engineering of National Chiao Tung University in
Taiwan and is the current Chairman of the same department. His current
research interests are in the areas of radio resource management, cross-
layer optimized techniques for heterogeneous wireless networks, and cloud
computing for mobile applications.
Dr. Wang was elected to the IEEE Fellow grade in 2011 for his contri-
butions in cellular architectures and radio resource management in wireless
networks. He won the Distinguished Research Award of National Science
Council, Taiwan in 2012, and was a co-recipient (with Gordon L. Stu¨ber
and Chin-Tau Lea) of the 1997 IEEE Jack Neubauer Best Paper Award
for his paper “Architecture Design, Frequency Planning, and Performance
Analysis for a Microcell/Macrocell Overlaying System,” IEEE TRANSAC-
TIONS ON VEHICULAR TECHNOLOGY, vol. 46, no. 4, pp. 836-848, 1997.
He has published over 150 journal and international conference papers. He
served as an Associate Editor for the IEEE TRANSACTIONS ON WIRELESS
COMMUNICATIONS from 2001 to 2005, the Guest Editor of Special Issue
on “Mobile Computing and Networking” for IEEE JOURNAL ON SELECTED
AREAS IN COMMUNICATIONS in 2005, and on “Radio Resource Management
and Protocol Engineering in Future IEEE Broadband Networks” for IEEE
Wireless Communications Magazine in 2006. He is holding nine US patents.
Yu T. Su received the B.S.E.E. degree from Tatung
Institute of Technology, Taipei, Taiwan and Ph.D.
degree from the University of Southern California,
Los Angeles, USA, in 1974 and 1983, respectively.
From 1983 to 1989, he was with LinCom Corpo-
ration, Los Angeles, USA, where his last position
was a Corporate Scientist. Since September 1989, he
has been with the National Chiao Tung University,
Hsinchu, Taiwan and is currently a professor in the
Department of Electrical Engineering. He was an
Associative Dean of the College of Electrical and
Computer Engineering from 2004 to 2007, Head of the Communications
Engineering Department from 2001 to 2003. He is also affiliated with
the Microelectronic and Information Systems Research Center of the same
university and served as a Deputy Director during 1997-2000. From 2005
to 2008, he was the Area Coordinator of Taiwan National Science Council’s
Telecommunications Programme. His main research interests include com-
munication theory and statistical signal processing.
IEEE SYSTEMS JOURNAL, VOL. 6, NO. 2, JUNE 2012 329
High-Capacity OFDMA Femtocells by Directional
Antennas and Location Awareness
Ang-Hsun Tsai, Student Member, IEEE, Li-Chun Wang, Fellow, IEEE, Jane-Hwa Huang, Member, IEEE, and
Ruey-Bing Hwang, Senior Member, IEEE
Abstract—In this paper, we propose a location-aware mecha-
nism combined with a low-cost four-sector switched-beam direc-
tional antenna to enhance the spectrum efficiency of orthogonal
frequency-division multiple access (OFDMA)-based femtocell
systems. The considered location-awareness capability is specified
in the current IEEE 802.16m WiMAX standard, but has not
been applied to avoid the interference between indoor femtocells
and outdoor macrocells. With the knowledge of the locations of
outdoor users, the proposed four-sector switched-beam antenna
in a femtocell can effectively avoid the interference among
femtocells and macrocells by adjusting the number of OFDMA
subcarriers used at each femtocell. Numerical results show
that the proposed approach can significantly improve spectrum
efficiency compared to the existing methods.
Index Terms—Closed subscriber group (CSG), femtocell,
four-sector switched-beam directional antenna, link reliability,
location awareness, open subscriber group (OSG), orthogonal
frequency-division multiple access (OFDMA), spectrum
efficiency, two-tier interference.
I. Introduction
FEMTOCELLS can improve system capacity and indoorcoverage with low power and low cost [1]–[4]. Un-
like base stations in conventional cellular systems, femto-
cells connect to the network center through the broadband
wirelines inside the customers’ homes. Due to short trans-
mission distance, femtocells require very low transmission
power. From the operator’s viewpoint, deploying femtocells
can also significantly improve system capacity because the
same spectrum can be repeatedly used by a huge number
of other femtocells. Femtocells can also off-load the traffic
of the outdoor macrocell users toward the indoor femtocell
base station (fBS). From the customers’ perspective, the fBS
Manuscript received June 30, 2011; revised November 2, 2011; accepted
November 7, 2011. Date of publication January 10, 2012; date of current
version May 22, 2012. This work was supported in part by the National
Science Council (NSC) of Taiwan, under Research Grant NSC 100-2221-E-
009-103-MY3, and in part by the Industrial Technology Research Institute,
Information and Communication Research Laboratories, Taiwan. Part of this
work was presented at the IEEE Wireless Communications and Networking
Conference, 2010.
A.-H. Tsai, L.-C. Wang, and R.-B. Hwang are with the Department
of Electrical Engineering, National Chiao Tung University, Hsinchu 300,
Taiwan (e-mail: anghsun@gmail.com; lichun@cc.nctu.edu.tw; raybeam@
mail.nctu.edu.tw).
J.-H. Huang is with the Department of Electrical Engineering, National Chi
Nan University, Nantou 545, Taiwan (e-mail: jhhuang@ncnu.edu.tw).
Color versions of one or more of the figures in this paper are available
online at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/JSYST.2011.2178724
is much closer than the outdoor macrocell base station (mBS),
thereby improving indoor signal quality.
However, the serious two-tier interference in femtocells
is the key challenge [2]–[5]. After femtocells are densely
deployed, both the femto-to-femto and the macro-to-femto
interference occur. In the meanwhile, the macrocell users
undergo the interference from the femtocells and macrocells
as well. The severe two-tier interference significantly affects
the system capacity because the subcarriers available for the
femtocells are reduced.
In the literature, most studies on femtocells considered the
omnidirectional femtocells and can be categorized into three
kinds: power control, access method, and spectrum allocation.
In [1] and [6], the power control method for femtocells with
omnidirectional antenna were discussed. In [1], an autoconfig-
uration method of transmit power was proposed for the code
division multiple access (CDMA)-based femtocells with the
shared spectrum allocation scheme. In [6], the authors pro-
posed a distributed femtocell uplink power control to achieve
higher signal-to-interference plus noise ratio performance on
the condition that the link quality of the macrocell users can
be guaranteed.
Access methods for femtocells were discussed in [3], [7],
and [8]. In [3], the authors compared the closed subscriber
group (CSG) and open subscriber group (OSG) femtocell
systems, where the CSG fBSs only serve the authorized users,
and the OSG fBSs can serve any users. Because the OSG
users can select the base station with best signal quality
among the femtocells and macrocells, the OSG scheme has
better coverage than the CSG scheme. In [7], the authors
studied different access methods for femtocells and proposed
a hybrid access approach to improve the average throughput.
In [8], the authors investigated the effects of access methods
in the uplink femtocell systems. They suggested that the
access method depend on the cellular user density in the
time division multiple access/orthogonal frequency-division
multiple access (OFDMA) network, and showed that open
access is the optimal choice in the CDMA network.
In [9]–[14], spectrum allocation schemes for femtocells with
omnidirectional antenna were discussed. In [9], the channel
selection issues in the WiMAX-based femtocell systems was
investigated by taking into account of the femto-to-femto inter-
ference. In [11], distributed channel selection schemes for fem-
tocells were developed to improve the capacity by adjusting
the number of used subcarriers. In [10], the authors analyzed
1932-8184/$31.00 c© 2012 IEEE
TSAI et al.: HIGH-CAPACITY OFDMA FEMTOCELLS 331
the macrocell and femtocell system, and the later scheme
allows the same spectrum shared by both the marcocell
and femtocell system. Compared with the shared spectrum
allocation schemes, the exclusive spectrum allocation scheme
can reduce the mutual interference, but may have lower
spectrum efficiency. On the contrary, the shared spectrum
scheme can increase the spectrum efficiency at the cost of
higher two-tier interference.
In the shared spectrum scheme, two spectrum management
schemes are further considered and compared in this paper:
CSG and OSG access methods. According to the CSG method,
the outdoor macrocell user cannot access the femtocell. By
contrast, if the OSG method is adopted, the macrocell users
can access the femtocell. In principle, the CSG method can
ensure privacy and security better than the OSG method.
However, the interference issue of CSG is more severe than
the OSG method because the outdoor user can be arranged to
use the idle subcarriers of femtocells. Fig. 2 shows the two-
tier interference scenario for an outdoor user in the OSG and
CSG schemes.
B. Location Awareness
If the appearance of an outdoor macrocell user can be
detected by the nearby femtocells, the usage of subcarriers
in the femtocell system can be adjusted in order to reduce the
interference to the macrocell system. Furthermore, location
capability combined with network level signaling can support
location-based services and emergency E911 calls. The loca-
tions of outdoor macrocell users can be estimated by many
kinds of techniques, e.g., the network-managed, mobile station
(MS)-managed, femtocell-assisted, and GPS-based methods
[21]. For the network-managed location estimation method, the
time of arrival and the angle of arrival in the uplink transmis-
sions are used to locate the outdoor user. For the MS-managed
method, a mobile user can calculate the location information
with fewer interactions with the network compared with the
network-managed location estimation method. The femtocell-
assisted location determination method relies on mobile users
which are not connected to any femtocells to collect the infor-
mation of neighboring fBSs. Based on the collected informa-
tion, the network can determine the macrocell user’s location.
In the following, we discuss the subcarrier usage adjustment
procedures to reduce interference for the location-aware fem-
tocell systems. During the registration processes of femtocells,
a cellular operator can obtain the location information of the
femtocells [1], which is stored in the location database of
femtocell gateways at the network center. After positioning
an outdoor user, cellular networks inform the corresponding
femtocell gateway to look up its location database, and notify
the femtocells close to that particular outdoor user. By reduc-
ing the used subcarriers in femtocells, the link reliability of
outdoor users can be ensured even with the shared spectrum
allocation scheme. Location-aware femtocells need not reduce
the subcarrier usage if an outdoor user is far away from
them. By contrast, conventional femtocells without location
awareness shall use fewer subcarriers to guarantee the link
quality of the outdoor users. Hence, the location-aware fem-
tocells can achieve higher femtocell capacity compared with
the conventional femtocells. Usually, only the approximate
location of the outdoor user is required by the location-aware
femtocells to make decision about the subcarrier usage. If
it is necessary to reduce more interference and estimate the
macrocell user location more accurately, femtocell gateways
can instruct more femtocells near that macrocell user to adjust
subcarriers usage.
C. Channel Models
To evaluate the two-tier interference in the OFDMA-based
hybrid macrocell and femtocell systems, we consider the
following radio propagation effects, including path loss,
wall penetration loss, shadowing, and frequency-selective
multipath fading.
1) Path Loss: According to [22], the path loss between
transmitter and receiver with the propagation distance d m is
defined as
L(d) (dB) =
⎧⎪⎨
⎪⎩
20 log10(
4πd
λ
) , d ≤ dBP
20 log10(
4πdBP
λ
) + 35 log10(
d
dBP
) , d > dBP
(1)
where λ is the wavelength, dBP is the break-point distance,
and dBP = 5 m and 30 m for indoor links and outdoor links at
the 2.5 GHz carrier frequency, respectively.
2) Wall Penetration Loss: The wall penetration attenuation
is assumed to be 5 dB per wall for indoor links, and 10 dB per
wall for the outdoor-to-indoor links. We denote P˜Li as the total
penetration loss between the ith femtocell and the considered
user, and P̂L as the wall penetration loss between the macrocell
and the considered user.
3) Shadowing: The log-normally distributed shadowing
random variable 10ξ/10 is considered in our model, where
ξ is a Gaussian-distributed random variable with zero mean.
The shadowing standard deviations for the indoor links, the
macrocell-to-femtocell links, and the femtocell-to-femtocell
links are σ = 5 dB, 8 dB, and 10 dB, respectively.
4) Frequency-Selective Multipath Fading: To model the
received link quality in the OFDMA system, the Stanford
University interim-3 (SUI-3) channel model [23] is adopted
in this paper. The SUI-3 channel model considers a three-tap
channel with nonuniform delays.
III. Performance Metrics
In this paper, we consider the following performance met-
rics, including carrier to interference-and-noise ratio (CINR),
link reliability, femtocell capacity, and spectrum efficiency.
A. Carrier to Interference-and-Noise Ratio
For the femtocell users, the two-tier interference comes from
the macrocell and the other neighboring femtocells. Suppose
that Ĝ(θ) is the antenna gain of the macrocell and G˜(θi) is
that of the ith femtocell. Due to the frequency selective fading,
|Ĥm|2 represents the link gain between the macrocell and the
femtocell user, and |H˜i,m|2 is that between the ith femtocell and
the femtocell user. Therefore, the CINR of the mth subcarrier
TSAI et al.: HIGH-CAPACITY OFDMA FEMTOCELLS 333
user can still use all subcarriers with capacity Csh0. Suppose
that the probability that there is an outdoor user around the
considered femtocell is p. With the location awareness, the
average spectrum efficiency for the shared spectrum allocation
scheme can increase to
SELA =
pCsh1 + (1 − p)Csh0
B
. (9)
The existence probability p of an outdoor user around a
femtocell can be measured by the femtocell [16] from the long-
term statistics depending on the population density, femtocell
density, femtocell transmission power, and so on.
To achieve higher spectrum efficiency, the location-aware
femtocell system need to adaptively operate in the suitable
spectrum allocation scheme and access method according to
the existence probability p of an outdoor user and the proba-
bility threshold p∗. The probability threshold p∗ for selecting
the spectrum sharing scheme can be obtained as follows, since
SELA is the average spectrum efficiency for a location-aware
femtocell system, as defined in (9). In the condition that using
the shared spectrum scheme in the location-aware femtocell
system can have higher spectrum efficiency than using the
exclusive spectrum scheme, we have
SELA =
pCsh1 + (1 − p)Csh0
B
≥ SEex = Cex
B
. (10)
Then, by rearranging (10), we can find the probability thresh-
old p∗ as
p ≤ p∗ =
Csh0 − 12Cex
Csh0 − Csh1 . (11)
Accordingly, for the location-aware femtocell system, the
shared spectrum allocation scheme can achieve higher spec-
trum efficiency than the exclusive spectrum allocation scheme
as p < p∗. The location-aware femtocell need to periodically
report the existence probability of outdoor users to the fem-
tocell gateway at the network center. Then, femtocell gateway
can calculate the probability threshold by (11) in advance, and
adaptively instruct the location-aware femtocells to switch the
suitable spectrum allocation and access method. For a given
environment, the location-aware femtocells can operate in the
shared spectrum allocation scheme if p < p∗. Otherwise,
the location-aware femtocells should work in the exclusive
spectrum allocation scheme to achieve the best spectrum
efficiency.
IV. Directional Antennas for Femtocells
Directional antennas can decrease the two-tier interference
and thus improve femtocell capacity. For now, most of the
fBSs are equipped with only omnidirectional antennas, which
have lower antenna gain. In addition, each user will be
easily interfered by neighboring femtocells. On the contrary,
directional antennas can reduce the interference to adjacent
femtocells and achieve the better CINR due to high main lobe
gain and narrow beam pattern. In this section, we compare
the four-sector switched-beam antenna and the IEEE 802.16m
sector antenna.
Fig. 3. (a) Structure of four-sector switched-beam directional antenna.
(b) Structure of the prototype. (c) Circuitry for the four-sector switched-beam
directional antenna with the transistor-based switch.
Fig. 4. Each beam pattern of four-sector switched-beam directional antenna.
A. IEEE 802.16m Sector Antenna
We consider the sector antenna in the IEEE 802.16m system
[26] which has the radiation pattern A(θ) as follows:
A(θ) = − min[12
(
θ
θ3 dB
)2
, Am] (dB) (12)
where θ3 dB is the 3 dB beamwidth (corresponding to θ = 70°),
and Am = 20 dB is the maximum attenuation. The sector
antenna pattern in the IEEE 802.16m is mainly designed for
outdoor environments. We consider a four-sector fBS that
follows the above antenna pattern. Such a four-sector femtocell
requires four radio transceivers, yielding higher implementa-
tion cost.
B. Four-Sector Switched-Beam Directional Antenna
To resolve the high implementation cost issue of the four-
sector femtocell using the IEEE 802.16m sector antenna,
TSAI et al.: HIGH-CAPACITY OFDMA FEMTOCELLS 335
TABLE II
OFDMA-Based Femtocell System Parameters
Downlink OFDMA Parameters Values
Carrier frequency 2.5 GHz
mBS transmit power 43 dBm
fBS transmit power 20 dBm
mBS antenna gain G(θ) 8 dB
Macrocell radius (Rm) 500 m
Noise figure (mBS/fBS/MS) 5 dB/5 dB/7 dB
System bandwidth (B) 10 MHz
Sampling frequency 11.2 MHz
FFT size (M) 1024
Subcarrier bandwidth 10.9375 kHz
Null subcarriers 184
Pilot subcarriers 120
Data subcarriers (Nds) 720
Guard fraction (G) 1/8
Predefined effective CINR threshold
for link reliability (γth) −2.5 dB
Minimum link reliability requirement Prel = 90%
Fig. 6. Link reliability of indoor femtocell user versus the subcarrier usage
ratio ρ of the femtocells, for the exclusive and shared spectrum allocation
schemes. The switched-beam directional antenna, IEEE 802.16m sector an-
tenna, and 0-dB omnidirectional antenna are compared.
the subcarrier usage ratio ρ > 0.33. The directivity of
the IEEE 802.16m sector antenna can help reduce the
femto-to-femto intercell interference at the range of large
value of ρ. For ρ < 0.33, however, the IEEE 802.16m
sector antenna has worse indoor user’s link reliability
than the omnidirectional antenna because its antenna
gain A(θ) < 0 dB in the azimuth angle θ = 0o [referring
to (12)] and the gain of the omnidirectional antenna is
equal to 0 dB in all azimuth angle.
2) Compared with the shared spectrum allocation scheme,
the exclusive spectrum allocation scheme has better
indoor user’s link reliability performance because the
macro-to-femto cross-tier interference does not exist.
In such a femto-to-femto interference-limited case, the
switched-beam directional antenna even with the higher
antenna gain yields the similar indoor user’s link per-
formance as the IEEE 802.16m sector antenna. Never-
theless, both the switched-beam antenna and the IEEE
802.16m sector antenna perform better than the omnidi-
rectional case.
Fig. 7. Link reliability of outdoor user versus the subcarrier usage ratio ρ of
the femtocells, in the shared spectrum allocation scheme with the CSG and
OSG access methods.
3) To provide high subcarrier usage ratio in femtocell
systems, it is important to control the femto-to-femto
interference. For the link reliability requirement Prel =
90%, the switched-beam antenna can support ρ = 1 in
both shared and exclusive spectrum allocation scheme.
However, the IEEE 802.16m sector antenna can support
subcarrier usage ratio ρ = 1 in the exclusive spectrum
allocation scheme, but can only support ρ = 0.73 at
most in the shared spectrum allocation scheme. For
omnidirectional antenna scheme, the largest permissible
subcarrier usage ratio ρ = 0.85 and ρ = 0.48 in
the exclusive and shared spectrum allocation schemes,
respectively.
Fig. 7 shows the link reliability performance of outdoor
user against the subcarrier usage ratio ρ of the femtocells,
in the shared spectrum allocation scheme with the CSG and
OSG access methods. We assume that in the CSG method
the outdoor user around the considered femtocell is served
by the macrocell, while the outdoor users can select the base
station with the stronger signal strength among the mBS and
the fBSs in the OSG method. Besides, the outdoor user needs
only one subchannel for voice calls. We have the following
observations.
1) The IEEE 802.16m sector antenna can yield better
link reliability of outdoor user than the switched-beam
antenna for both CSG and OSG methods. Though the
higher-gain switched-beam antenna enhances the signal
strength, it also increases the interference from femto-
cells to lower the link reliability of the outdoor user.
Nevertheless, both the switched-beam antenna and the
IEEE 802.16m sector antenna perform better than the
omnidirectional case.
2) To ensure the link reliability of the outdoor users, it is
also important to control the femto-to-macro and femto-
to-femto interference in the shared spectrum allocation
scheme. For the link reliability requirement Prel = 90%,
the IEEE 802.16m sector antenna can support subcarrier
usage ratio ρ = 0.12 at most in the OSG method, and ρ =
0.11 at most in the CSG method. However, the switched-
TSAI et al.: HIGH-CAPACITY OFDMA FEMTOCELLS 337
Fig. 10. Maximum allowable subcarrier usage ratio of the location-aware
femtocell versus the femtocell density in the shared spectrum allocation
scheme subject to the link reliability requirement Prel ≥ 90%. Scenario I:
an outdoor user appears near the considered central femtocll. Scenario II:
there is no outdoor user around the considered central femtrocell.
3) One can observe that location awareness capability can
also affect the choice of spectrum sharing schemes
for different antenna patterns. When the switched-beam
antenna is used, the shared spectrum schemes provide
higher spectrum efficiency than the exclusive scheme
when p < 0.46. The shared spectrum schemes can
result in higher spectrum efficiency than the exclusive
spectrum scheme only for p < 0.19 when the IEEE
802.16m sector antenna is used and for p < 0.15 when
the omnidirectional antenna is used, respectively.
C. Impacts of Femtocell Density and Existing Probability of
Outdoor Users on Spectrum Efficiency
Fig. 10 shows the impact of femtocell density on the
maximum allowable subcarrier usage ratio ρ for the location-
aware femtocells with the shared spectrum location scheme
subject to the link reliability requirement Prel ≥ 90%. We
consider two scenarios. Scenarios I represents the situation that
an outdoor user appears near the considered central femtocell,
and Scenario II represents the situation that an outdoor user
does not appear near the considered central femtocell. From
the figure, we have the following observations.
1) In Scenario I, the femtocell density significantly affects
the maximum allowable subcarrier usage ratio ρ when
an outdoor user appears near the considered central
femtocell. When the femtocell density is higher than 500
femtocells/km2 (the corresponding nearest separation
distance between two femtocells is dsf ≈ 45 m), the
maximum allowable subcarrier usage ratio ρ shall be
smaller than 0.25 to ensure the link reliability of outdoor
users.
2) In Scenario II, the maximum allowable subcarrier usage
ratio ρ can be increased since the outdoor user does not
exist. For example, when the femtocell density reaches
4500 femtocells/km2 (the corresponding nearest sepa-
ration distance between two femtocells is dsf ≈ 15 m),
a location-aware femtocell system has the potential to
improve ρ = 0.05 to ρ = 0.33 even with omnidirec-
Fig. 11. Achieved spectrum efficiency of the location-aware femtocell versus
the femtocell density for different existing probability of an outdoor user under
the link reliability requirement Prel = 90% in the shared spectrum allocation
scheme, where the switched-beam antenna is used.
tional antenna. If the switched-beam antenna is used,
a location-aware femtocell system has the potential to
improve ρ = 0.08 to ρ = 0.85.
Fig. 11 shows the achieved spectrum efficiency of the
location-aware femtocells against the femtocell density for
various existing probability p of an outdoor user near the con-
sidered femtocell. We consider the location-aware femtocell
using the switched-beam antenna and the OSG access method
with Prel ≥ 90% in the shared spectrum allocation scheme.
We have the following observations.
1) The existing probability p of an outdoor user signifi-
cantly affects the achieved spectrum efficiency of the
location-aware femtocell system in the shared spectrum
allocation scheme. The higher the existing probability
p, the lower the achieved spectrum efficiency of the
location-aware femtocell system. In this case, if the
femtocell density is 1000 femtocells/km2, the achieved
spectrum efficiency of p = 0, 0.2, 0.46, 0.6, and 0.8 can
be improved by 470%, 373%, 255%, 188%, and 94%
compared to that of p = 1.0. If the femtocell density
is 4000 femtocells/km2, the spectrum efficiency can be
improved by 675%, 544%, 369%, 269%, and 138% for
p = 0, 0.2, 0.46, 0.6, and 0.8.
2) For the exclusive spectrum allocation scheme with a
given femtocell density, the achieved femtocell spectrum
efficiency does not fluctuate according to the existing
probability p of an outdoor user. This is because the
femtocell and macrocell systems are allocated with
different frequency bands. For instance, the achieved
spectrum efficiency in the exclusive spectrum scheme
is 1.2 b/s/Hz and 0.8 b/s/Hz for the femtocell density of
1000 and 4000 femtocells/km2, respectively.
3) With the information of the existing probability p of
a nearby outdoor user and the femtocell density, the
location-aware femtocell system can properly choose
the spectrum allocation scheme to achieve a better
spectrum efficiency. From (11), one can calculate the
probability threshold p∗ for any given femtocell density.
For example, the probability threshold is p∗ = 0.46 when
TSAI et al.: HIGH-CAPACITY OFDMA FEMTOCELLS 339
Table III shows the comparison of various antennas for
location-aware femtocells in terms of the average spectrum
efficiency. Five environments are considered in the table, and
they are the dense urban areas, urban areas, suburban areas,
rural areas, and wilderness of Europe [28], respectively. We
make a summary of the data given in the table.
1) It can be seen that the switched-beam antenna has the
best spectrum efficiency performance for the location-
aware femtocells compared with the IEEE 802.16m and
the omnidirectional antennas.
2) To have better average spectrum efficiency performance,
the location-aware femtocell with the switched-beam an-
tenna should operate in the exclusive spectrum allocation
scheme for the dense urban areas, where the existing
probability of outdoor users is p = 0.70. However,
the location-aware femtocell with the switched-beam
antenna can operate in the shared spectrum allocation
scheme for the urban areas, suburban areas, rural ar-
eas, and wilderness, where the existing probabilities of
outdoor users are p = 0.33, p = 0.18, p = 0.04, and
p = 0.01, respectively.
VI. Conclusion
In this paper, we evaluated the throughput of the OFDMA
femtocell system with the directional antenna by applying
three techniques to reduce the interference between macrocells
and femtocells. First, the low-cost four-sector switched-beam
antenna was employed to mitigate the interference because
of the narrow-beam pattern. Second, the partial usage of
subcarriers approach ensured the link reliability of all users
by adjusting the number of OFDMA subcarriers used by a
femtocell. Third, the location awareness was applied to the
femtocell systems for improving spectrum efficiency. Combin-
ing these elements, a location-aware femtocell achieved higher
spectrum efficiency than the conventional femtocells using the
directional antennas, under the link reliability requirement.
The contributions of this paper are described as follows.
First, we provided a useful principle for femtocell network
planning to select the appropriate spectrum allocation scheme
and access method to improve spectrum efficiency. Second,
we found that the location awareness capability was essential
to the success of improving the femtocell spectrum efficiency
because using the directional antenna was not enough to
guarantee the link reliability of all indoor and outdoor users.
Third, the impacts of spectrum allocation, access method, fem-
tocell density, and directional antenna on link reliability and
spectrum efficiency of OFDMA femtocells were investigated,
and had some important observations. For example, we found
that the shared spectrum scheme may not always have better
spectrum efficiency than the exclusive spectrum scheme under
the link reliability requirement.
Future Works: In summary, the design principles pro-
vided in this paper can help decide the suitable spectrum
allocation and access method for the femtocells. There are
some interesting research topics that can be extended from
this paper, including multiple-user access and subchannel
allocation in switch-beam OFDMA femtocells.
References
[1] H. Claussen, L. T. W. Ho, and L. G. Samuel, “An overview of the
femtocell concept,” Bell Labs Tech. J., vol. 13, no. 1, pp. 221–246,
2008.
[2] V. Chandrasekhar and J. G. Andrews, “Femtocell networks: A survey,”
IEEE Commun. Mag., vol. 46, no. 9, pp. 59–67, Sep. 2008.
[3] S.-P. Yeh, S. Talwar, S.-C. Lee, and H. Kim, “WiMAX femtocells:
A perspective on network architecture, capacity, and coverage,” IEEE
Commun. Mag., vol. 46, no. 10, pp. 58–65, Oct. 2008.
[4] D. Lo´pez-Pe´rez, A. Valcarce, G. de la Roche, and J. Zhang, “OFDMA
femtocells: A roadmap on interference avoidance,” IEEE Commun.
Mag., vol. 47, no. 9, pp. 41–48, Sep. 2009.
[5] R. Y. Kim, J. S. Kwak, and K. Etemad, “WiMAX femtocell: Require-
ments, challenges, and solutions,” IEEE Commun. Mag., vol. 47, no. 9,
pp. 84–91, Sep. 2009.
[6] V. Chandrasekhar, J. G. Andrews, T. Muharemovic, Z. Shen,
and A. Gatherer, “Power control in two-tier femtocell networks,”
IEEE Trans. Wireless Commun., vol. 8, no. 8, pp. 4316–4328,
Aug. 2009.
[7] G. de la Roche, A. Valcarce, D. Lo´pez-Pe´rez, and J. Zhang, “Access
control mechanisms for femtocells,” IEEE Commun. Mag., vol. 48, no. 1,
pp. 33–39, Jan. 2010.
[8] P. Xia, V. Chandrasekhar, and J. G. Andrews, “Open vs. closed access
femtocell in the uplink,” IEEE Trans. Wireless Commun., vol. 9, no. 12,
pp. 3798–3809, Dec. 2010.
[9] H. Zeng, C. Zhu, and W.-P. Chen, “System performance of self-
organizing network algorithm in WiMAX femtocells,” in Proc. Int.
WICON, no. 25. Nov. 2008, pp. 1–9.
[10] V. Chandrasekhar and J. G. Andrews, “Spectrum allocation in tiered
cellular networks,” IEEE Trans. Commun., vol. 57, no. 10, pp. 3059–
3068, Oct. 2009.
[11] C. Lee, J.-H. Huang, and L.-C. Wang, “Distributed channel selection
principles for femtocells with two-tier interference,” in Proc. IEEE VTC,
May 2010, pp. 1–5.
[12] C.-H. Ko and H.-Y. Wei, “On-demand resource-sharing mechanism
design in two-tier OFDMA femtocell networks,” IEEE Trans. Vehicular
Technol., vol. 60, no. 3, pp. 1059–1071, Mar. 2011.
[13] S.-Y. Lien, C.-C. Tseng, K.-C. Chen, and C.-W. Su, “Cognitive radio
resource management for QoS guarantees in autonomous femtocell
networks,” in Proc. IEEE ICC, May 2010, pp. 1–6.
[14] S.-Y. Lien, Y.-Y. Lin, and K.-C. Chen, “Cognitive and game-theoretical
radio resource management for autonomous femtocells with QoS guar-
antees,” IEEE Trans. Wireless Commun., vol. 10, no. 7, pp. 2196–2206,
Jul. 2011.
[15] V. Chandrasekhar and J. G. Andrews, “Uplink capacity and interfer-
ence avoidance for two-tier femtocell networks,” IEEE Trans. Wireless
Commun., vol. 8, no. 7, pp. 3498–3509, Jul. 2009.
[16] H. Claussen, F. Pivit, and L. T. W. Ho, “Self-optimization of femtocell
coverage to minimize the increase in core network mobility signalling,”
Bell Labs Tech. J., vol. 14, no. 2, pp. 155–184, 2009.
[17] S.-G. Josep and W. H. Chin, “Performance of an LTE femtocell base
station employing uplink antenna selection,” in Proc. WiAd, Jun. 2011,
pp. 224–229.
[18] N.-D. Da´o, Y. Sun, and W. H. Chin, “Receive antenna selection
techniques for femtocell uplink interference mitigation,” in Proc. IEEE
Int. Symp. PIMRC Workshops, Sep. 2010, pp. 180–184.
[19] Y. Jeong, H. Kim, B.-S. Kim, and H. Choo, “Avoidance of co-channel in-
terference using switched parasitic array antenna in femtocell networks,”
in Proc. ICCSA, vol. 6018. 2010, pp. 158–167.
[20] A.-H. Tsai, J.-H. Huang, L.-C. Wang, and R.-B. Hwang, “High capacity
femtocells with directional antennas,” in Proc. IEEE WCNC, Apr. 2010,
pp. 1–6.
[21] R. Srinivasan and S. Hamiti, “IEEE 802.16m system description docu-
ment (SDD),” IEEE 802.16 Broadband Wireless Access Working Group,
Tech. Rep. IEEE 802.16m-09/0034r2, Sep. 2009.
[22] V. Erceg, L. Schumacher, P. Kyritsi, A. Molisch, D. S. Baum, A. Y.
Gorokhov, C. Oestges, C. Lanzl, V. J. Rhodes, J. Medbo, D. Michelson,
M. Webster, E. Jacobsen, D. Cheung, Q. Li, C. Prettie, M. Ho, S.
Howard, B. Bjerke, K. Yu, L. Jengx, A. Jagannatham, N. Tal, S. Valle,
and A. Poloni, “Indoor MIMO WLAN channel models,” IEEE P802.11
Wireless LANs, Tech. Rep. IEEE 802.11-03/871r1, Nov. 2003.
[23] V. Erceg, K. V. S. Hari, M. S. Smith, D. S. Baum, K. P. Sheikh,
C. Tappenden, J. M. Costa, C. Bushue, A. Sarajedini, R. Schwartz,
D. Branlund, T. Kaitz, and D. Trinkwon, “Channel models for fixed
wireless applications,” IEEE 802.16 Broadband Wireless Access Work-
ing Group, Tech. Rep. IEEE 802.16.3c-01/29r4, Jul. 2001.
第三年執行成果 
網路多重天線系統結合細胞扇區化及部分頻率重複使用之研究 
一、中文摘要 
    在第三年計畫中，我們使用網路多重天線系統在多細胞中進行個人化平行傳輸。此系統為多重
天線廣播系統在多細胞環境下的應用。結合基地台間地理位置的關係與頻帶的分割，我們使用多重
天線在多個細胞內進行合作式的傳輸。在此部份提出了一個結合細胞扇區化、部分頻率重複使用之
三細胞合作為基礎的網路多重天線系統。此架構用來降低多細胞系統中嚴重的細胞間干擾問題。從
系統架構與佈局的觀點，我們提供的三細胞合作為基礎之網路多重天線系統不僅可以有效對抗細胞
間干擾，也能降低多個基地台合作時的複雜度。 
 
二、英文摘要 
    In the third year project, we present a 3-cell network multipleinput multiple-output (MIMO) 
architecture with fractional frequency frequency (FFR) and a novel tri-sector frequency partition scheme. 
One fundamental question to apply the network MIMO technique in such a high interference environment 
is: how many base stations should be coordinated together to provide sufficient performance? We will 
demonstrate that the FFR-based 3-cell network MIMO architecture with the proposed tri-sector frequency 
partition can not only effectively overcome the intergroup interference, but can avoid executing the 
complex multibase-station joint processing for a huge number of cluster of cells at all locations. It will be 
shown that the proposed 3-cell network MIMO with the rearranged tri-sector frequency partition strategy 
can outperform the 7-cell network MIMO with omni-directional antennas. Various sector antenna 
architectures and the method for determining the inner region of the FFR cell planning are also discussed 
and analyzed on top of the network MIMO system. We hope that this study can provide important 
insights into the design of the network MIMO systems from the perspectives of architecture and 
deployment. 
 
三、Publication 
[1] Li-Chun Wang and Chu-Jung Yeh, “3-Cell Network MIMO Architectures with Sectorization and 
Fractional Frequency Reuse,” IEEE Journal in Selected Area in Communications, Vol. 29, No. 6, pp. 
1185-1199, May, 2011. 
[2] Li-Chun Wang and Chu-Jung Yeh, “A Three-Cell Coordinated Network MIMO with Fractional 
Frequency Reuse and Directional Antennas,” IEEE ICC, May, 2010. 
 
 
 
 
2number of the coordinated cells of the network MIMO system
increases, a group of coordinated cells in network MIMO
systems are still affected by the co-channel interference from
the neighboring coordinated groups. This kind of the inter-
group interference (IGI) should be taken into account when
evaluating the performance of network MIMO systems [14],
[15]. Hence, it becomes crucial to design a network MIMO
system subject to the constraints of three coordinated cells per
group and the IGI effects simultaneously.
The ultimate goal of this paper is to investigate which kind
of 3-cell FFR-based network MIMO architectures are feasible
and can significantly improve SINR performance and capacity
subject to the IGI effects. In this paper, we propose a 3-
cell FFR-based tri-sector network MIMO architecture with
a sector-frequency rearrangement scheme. Specifically, the
proposed sector-frequency rearrangement schemes can amplify
the performance gain of the network MIMO even with a small
number of coordinated cells, i.e., the 3-cell network MIMO
case. We examine various tri-sector architectures [16], [17] and
determine which directional antenna scheme can effectively
reduce the impact of IGI in the multi-cellular system and
design the sector frequency rearrangement scheme similar to
[18] for the 3-cell network MIMO architecture. Furthermore,
we discuss how to determine the uncoordinated inner region
for the tri-sector network MIMO with FFR cell planning.
The rest of this paper is organized as follows. In Section
II, we discusse the related work for network MIMO and FFR
techniques. Section III defines the system model. In Section
IV, we briefly review the concept of network MIMO. Section
V shows the IGI issue for network MIMO systems. In Section
VI, we present the proposed 3-cell network MIMO architecture
with FFR. In Section VII, we show numerical results and
discuss the inner region issue in Section VIII. We finally give
concluding remarks in Section IX.
II. RELATED WORK
In the literature, the related work for the network MIMO
techniques for downlink as well as uplink and the FFR
techniques can be summarized as follows.
• For downlink cellular networks, the concept of enhanc-
ing downlink capacity of a cellular system by the co-
processing at transmitting end in a cellular system was
proposed [19]. Also, [20] proposed a distributed multi-
cell beamforming and analyzed its the performance based
on Wyner’s circular array model [21]. The coordinated
strategies with grouped interior and edges users based
on Wyner’s circular array model were analyzed in [22].
The authors in [23] compared downlink network MIMO
coordination with denser BS deployment. In [24] a block
diagonalization scheme was used to form a cluster co-
ordination in a multi-cellular system, including intra-
and inter-cluster coordination, to enhance the sum rate
and reduce the interference for the cluster-edge users,
respectively. In [25], downlink coordination with limited
distributed antenna arrays was compared to that with
centralized antenna arrays. Under a fixed number of
antennas per cell, [26] evaluated the impact of different
number of sectors per cell, and the impact of the number
of coordinated cells.
• The network MIMO technique has been also studied for
the uplink case [27]–[31] . For the uplink network MIMO
systems, the coordinated BSs simultaneously receive the
multiple users’ signals within the area of the coordinated
group of cells and suppress the mutual interference
between users by means of coherent linear (received)
beamforming across BSs. An important issue in uplink
network MIMO is which BSs shall be selected for cooper-
ation. The authors in [29] provided dynamic BS clustering
approach for uplink BS coordination which resulted in
significant sum rate gain compared to the static BS
clustering schemes proposed in [30], [31]. Additionally,
the issue of how to select a subset of users for jointly
coordinated detection to reduce the burden of backhaul
was addressed in [27]. It proposed an isolation-based user
grouping algorithm to optimize system capacity under a
strongly constrained backhaul between seven-coordinated
cells, which was also modified to downlink scenario for
capacity improvement under a limited backhaul [28].
• The recent researches on FFR were mostly related to
the OFDMA systems [32]–[37]. The outage capacity
performance of an FFR-based OFDMA cellular system
with proportional fair scheduling was studied in [32]. The
joint effects of the FFR system parameters, the interior
region, and the bandwidth assignment on cell throughput
was formulated as an optimization problem in [33].
The resource allocation problem in an FFR-based multi-
cell OFDMA system was translated to a graph-coloring
problem in [34]. The concept of FFR can be also applied
to a tri-sector cellular system [35]. For example, [36] con-
sidered the FFR-based tri-sector cellular OFDMA system
and showed that the inter-cell interference can be reduced
and cell throughput is improved as well by the proposed
subcarrier scheduling algorithms. Under similar FFR-
based tri-sector cellular OFDMA systems, [37] proposed
an interference mitigation scheme by combining partial
reuse and soft handover.
III. SYSTEM MODEL
We consider a cellular system with Ncell = 19 cells, where
the center cell has two-tier neighboring cells. In the baseline
case, each BS and each user has one single transmit/receive
antenna. When the cellular system with three sectors is con-
sidered, we assume that each sector is equipped with one
sector antenna. The gain pattern used for each sector antenna
is specified as [2], [3]
A(θ)dB = −min
[
12
(
θ
θ3dB
)2
, Am
]
, (1)
where A(θ)dB is the antenna gain at angle θ in decibels and θ ∈
[−180◦, 180◦] is the angle between a mobile user with respect
to the main-beam direction of the considered sector antenna.
The 3 dB beamwidth θ3dB is the angle of which the antenna
gain is 3 dB lower than the antenna gain at the main-beam
4identity matrix. The weight matrix W can be obtained by
using the pseudo-inverse of the channel matrix. The received
signal vector is hence given by
Y = Hx+ n = HWs+ n = s+ n . (10)
With per-base power constraint (9), the objective of the
network MIMO system is to maximize the minimum rate
among the coordinated cells, and the corresponding maximum
common rate solutions are [5]
pk =
PBS
max
j
[WW∗](j,j)
=
PBS
max
j
∑
k
|wj,k|2
, for all k , (11)
which results in an equal symbol power transmission and
(·)∗ denotes the conjugate transpose operation. Therefore,
the corresponding mobile’s rate is given by log2(1 + pk/σ2)
bit/s/Hz among all the coordinated cells, where σ2 represents
the noise power. From (11), we can observe that the actual
average power of data stream s2k (i.e., pk), will be lower
than the original available transmission power PBS due to
beamforming weights.
B. ZF-DPC Network MIMO Transmission
The ZF-DPC network MIMO transmission constructs the
linear weight matrix W = Q∗ through the QR decomposition
of the channel matrix H = LQ, where L is a lower triangular
matrix with (k, i)-th entry Lk,i and Q is a unitary matrix with
QQ∗ = Q∗Q = IM . The received signal is written as
Y = Hx+ n = LQQ∗s+ n = Ls+ n , (12)
and the corresponding k-th mobile’s received signal is yk =
Lk,ksk+
∑
i<k
Lk,isi+nk. Note that the weight matrix W = Q∗
ensures no interference from data symbols with indices i > k.
The remaining interference from data symbols i < k are taken
care of by the successive interference cancellation of DPC.
Based on the result of ZF network MIMO transmission, if
we set pk = p for all k, the per-site power constraint (9)
becomes E[|xj |2] = [WW∗](j,j)p =
∑
k |wj,k|2p ≤ PBS for
all transmitted signal xj . Recall that the weight matrix W =
Q∗. We have [WW∗](j,j) = [Q∗Q](j,j) = [IM ](j,j) = 1.
Thus, we can set pk = PBS for each coordinated BS. Given
the received signal in (12), mobile k can achieve the capacity
log2(1+ |Lk,k|2pk/σ2) bit/s/Hz. Note that the channel vectors
of channel matrix H need to reorder similar to the case in
traditional multi-user MIMO broadcast systems [40].
V. EFFECTS OF INTER-GROUP INTERFERENCE ON
NETWORK MIMO SYSTEMS
A. SINR Performance Model
When applying network MIMO in a multi-cellular envi-
ronment, it is important to include the effects of IGI among
the coordinated network MIMO groups. Clearly, a group of
coordinated cells will cause interference to the neighboring
coordinated group of cells even if the intra-group interference
has been cancelled by the joint multi-BS processing. Consider
a cell with two-tier surrounding cells layout under M -cell
13G3 G4
7
8
9
10
11
12
13
14
15
16
17
18
0
1
2
3
4
5
6
G0
G3
G4
G5
G1
G2
G6
3-cell Network MIMO 7-cell Network MIMO
G0
0
1
2
3
4
5
6
7
8
9
10
11
12 14
15
16
17
18
G1
G2 G5
G6
G7
G8
Fig. 1. An example of inter-group interference for the 3-cell and 7-cell
network MIMO systems.
network MIMO coordination. Denote IG as the set of index
for the interfering network MIMO groups and Gi as the
cluster of cells for group i, i ∈ IG. Let [w(Gi)a,b ]M×M be
the precoding weights for cell a ∈ Gi with respect to mobile
b = 1, · · · ,M . With data symbol s(Gi)b of mobile b, the output
signal transmitted from cell a can be represented as
x(Gi)a =
M∑
b=1
w
(Gi)
a,b s
(Gi)
b . (13)
From (8) and (13), we can obtain the SINR of mobile k as
follows:
γIGIk =
pk||hkwk||2
1 +
∑
i∈IG
∑
a∈Gi
M∑
b=1
p
(Gi)
b |h(Gi)k,a w(Gi)a,b |2
, (14)
where pk = E[|sk|2] and p(Gi)b are the average power of stream
sk and s(Gi)b , respectively; and h
(Gi)
k,a is the channel response
between the considered mobile k and the interfering BS a ∈
Gi. According to (11) p(Gi)b = p(Gi). From (14), we can obtain
the SINR with ZF-based network MIMO transmission as
γIGIk,ZF =
pk
1 +
∑
i∈IG
∑
a∈Gi
M∑
b=1
p(Gi)|h(Gi)k,a w(Gi)a,b |2
. (15)
If ZF-DPC network MIMO transmission is adopted, the cor-
responding SINR is represented as
γIGIk,ZFDPC =
PBS|Lk,k|2
1 +
∑
i∈IG
∑
a∈Gi
M∑
b=1
PBS|h(Gi)k,a w(Gi)a,b |2
, (16)
where Lk,k is defined in (12).
B. SINR Performance Degradation
In this section, we explain why IGI affects the performance
of network MIMO systems by examples. Fig. 1 shows the 3-
cell and 7-cell network MIMO systems. In the case of 3-cell
network MIMO, cells 0, 4 and 5 forms a 3-cell network MIMO
group G0. Although for cell 0, network MIMO transmission
61B
2B
3B
1B
2B
3B
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
1B
3B
2B
3B
1B
2B
1B
2B
3B
1B
3B
1B
2B
2B
3B
2B
3B
1B
2B
3B
1B
2B
3B
1B
2B
2B
3B
1B
3B
1B
2B
1B
3B
1B
2B
1B
3B
3B
2B
1B
3B
2B
1B
3B
2B
1B
3B
2B
1B
2B
3B
Considered frequency band
Coordinated cells
Interferers by directional antenna
Interferers by side lobe
Regular tri-sector
frequency partition for cell
2
B
3
B
1
B
Fig. 4. Interference example for 3-cell FFR-based network MIMO with
regular tri-sector frequency partition (consider cell 0).
sectors with the same main-beam direction at each cell are
with the same frequency band (e.g. the left cellular system in
Fig. 3), which can be found in [35]–[37]. As for the rearranged
tri-sector frequency partition, the sectors with the same main-
beam direction at the neighboring cells can have different
frequency bands as shown in the right part of Fig. 3. We
will design the network MIMO systems based on the above
two tri-sector frequency partitions. Although the rearranged
tri-sector frequency partition may yield severer co-channel
interference than the regular tri-sector frequency partition, we
will show that combining the 3-cell network MIMO with the
rearranged tri-sector frequency partition can outperform the 3-
cell network MIMO with regular tri-sector frequency partition.
B. FFR-based Network MIMO with Regular Tri-Sector Fre-
quency Partition
In this section, we combine network MIMO with FFR
and the regular tri-sector frequency partition. As mentioned
before, the FFR method partitions the whole frequency band
into different zones. Compared to the conventional omni-cell
with universal frequency reuse factor of one, the tri-sector
cellular system combined with FFR can significantly reduce
the interference, while fully utilizing the frequency band at
each cell. As an example in Fig. 4, when a user of cell 0
utilizes one of RU fB1,n (n = 1, . . . , N ) in frequency band
fB1 , the interference comes from 7 cells {4, 5, 12, 13, 14, 15,
16} under the assumption of perfect 120◦ sector antenna rather
than being interfered by all 18 cells in the omni-directional
case. Here, the question is how we can further improve the
SINR on top of FFR? The solution proposed in this paper is
to further incorporate the network MIMO technique with FFR.
From Fig. 4, we find that the seven interfering sources
consists of two critical interferers coming from first-tier neigh-
boring cells 4 and 5 and five weaker second-tier interferers due
to higher path loss. Therefore, we use the network MIMO tech-
nique to cancel the two most severe interference. Instead of
coordinating huge number of cells, we propose a coordination
scheme with only three cells. We define those coordinated
cells as a group shown in Fig. 3. For the arbitrary group
Gi, we label the three cells as CellGia , CellGib , and Cell
Gi
c ,
respectively. For the 3-cell coordination, we can apply network
MIMO transmission to each subband fBp,n for p = 1, 2, 3
and n = 1, . . . , N . Under the assumption of perfect sector
directional antenna, the channel matrix of fB1,n for cell 0 in
the group {0, 4, 5} is
H(fB1,n) =
 h(0),0 h(0),4 h(0),50 h(4),4 0
0 0 h(5),5
 , (17)
where (x) denotes the corresponding served user in cell x. We
eliminate the interference caused by h(0),4 and h(0),5 (from
cells 4 and 5) by network MIMO. As a result, the two most
severe interference is cancelled through a small-sized (3× 3)
matrix computation. Importantly, this small-sized cooperation
scheme can be applied to all the cells within the entire service
area. For example in Fig. 4, at certain time slot we have many
cooperated groups among the 19-cell layout: cells {0, 4, 5},
{8, 2, 1}, {10, 11, 3}, and {18, 6, 17}. Not only the middle cell
(cell 0) is coordinated with its neighboring cells, but the cells
in the outer layer are also coordinated simultaneously.
1) Cells Regrouping and Partner Selection: In this section,
we propose a cell regrouping and partner selection scheme
to address the service fairness issue caused by the network
MIMO systems with the regular tri-sector frequency partition.
From Fig. 4, among arbitrary group Gi, the cell labelled
as “CellGia ” can achieve free intra-group interference within
the whole subband fB1 = {fB1,1 , . . . , fB1,N } under network
MIMO systems. However, subbands fB2 and fB3 are still
affected by two first-tier cells and five second-tier cells. We
therefore define fB1 as the primary band of CellGia for group
Gi. Similarly, we define fB2 and fB3 as the primary band
of CellGib and Cell
Gi
c , respectively. Therefore, the cell users
served by different subbands among a group can have different
signal quality. Note that this service fairness issue is different
from the unbalanced signal quality issue mentioned in Section
V-C.
The service fairness issue can be resolved by the proposed
regrouping and partner selection scheme. Assume that cell
0 is grouped with cells 4 and 5 with primary band fB1
at certain time slot one, as shown in Fig. 5. Cell 0 will
regroup with cells 1 and 6 at the next time slot two by
counterclockwise rotating way to reselect coordinated partner.
After this regroup, the primary band of cell 0 becomes fB2 .
Similarly, cell 0 regroups with cells 2 and 3 at time slot three
by counterclockwise reselecting coordinated partner again and
the corresponding primary band becomes fB3 . In this way, all
cells will simultaneously “rotate” and regroup with two new
neighboring cells at a new time slot, where “rotate” means the
coordinated partner reselection procedure. Take the three cells
{0, 4, 5} an example. Those cells form a group at time slot
one. At time slot two, cell 0’s regroup set is now {1, 0, 6},
cell 4’s regroup set is {3, 12, 4}, and cell 5’s regroup set
is {5, 14, 15}. Similarly, cell 0’s regroup becomes {2, 3, 0},
cell 4’s regroup set is {4, 13, 14}, and cell 5’s regroup set
81B
2B
3
B
2B
3
B
3
B
2B
3
B
1B
2B
2B
3B
1B
2B
3B
3
B
2B
3
B
2B
2B
3
B
1B
2B
3B
2B
3B
2B
3B
2B
3
B
2B
3B
3B
2B
3
B
1B
2B 2B
3B
2B
3B
2B
3B
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
Considered frequency band
Coordinated cells
Interferers by directional antenna
Interferers by side lobe
1B
1B1B
1B
1B
1B
1B
1B
1B
1B1B
1B
1B1B
Three kinds of frequency
partition for cell
3
B
1
B
2
B
1
B
2
B
3
B
2
B
3
B
1
B
Fig. 7. Interference example for 3-cell FFR-based network MIMO with
rearranged tri-sector frequency partition and 60◦ cell sectoring (consider cell
0).
network MIMO.
2) Cell Planning for 60-degree Tri-Sector Architecture:
To address the effects of cell planning with different
sectorization techniques, we further design the 3-cell network
MIMO systems with three 60◦ cell sectoring. Here we
consider rearranged tri-sector frequency partition to avoid the
cells regrouping procedure. Figure 7 shows the example of the
proposed rearranged 60◦ tri-sector network MIMO systems.
In this design, each cell has three hexagon-shaped sectors
with different frequency assignment. The cells with 60◦ and
120◦ sectors are also called as the clover-leaf-shaped cells
and diamond-shaped cells, respectively [16], [17]. Generally,
this clover-leaf-shaped cells can match sector contour better
than the cells with diamond-shaped sectors [16]. Additionally,
the cells with 60◦ sectoring can use spectrum more efficiently
[17]. Similar to the case of 120◦ sectoring, each cell under
60◦ sectoring performs three individually 3-cell network
MIMO coordinations with its six neighboring cells for
each frequency partition. The two first-tier interferers (the
dotted area in Fig. 7) are cancelled through network MIMO
transmissions. The 3-cell coordination structure can also be
implemented for all the cells.
D. Complexity Comparison of Regular and Rearranged Fre-
quency Partitions
With the assumption of perfect sector directional antennas,
the regular tri-sector frequency partition leads to a simpler
channel matrix than the rearranged tri-sector frequency par-
tition, e.g. (17) versus (18). For QR decomposition used for
ZF-DPC network MIMO, an m×n (m ≥ n) matrix A needs
2n2(m − n/3) flops by the Householder QR algorithm [41],
where one flop is a complex multiplication or an addition
floating-point operation. The simplified channel matrix for
regular frequency partition is an upper Hessenberge matrix
and can be factorized by the Givens Hessenberg QR algorithm
with 3n2 flops, where an n× n matrix A is called the upper
Hessenberg matrix if entry ai,j = 0 whenever i > j+1. As a
result, the complexity of constructing weight matrix utilizing
ZF-DPC network MIMO transmissions for the regular and
rearranged frequency partitions are 3M2 flops and 43M
3 flops
respectively, where M = 3 in our considered 3-cell network
MIMO architecture. For an n × n channel inverse operation
used for ZF network MIMO, we need LU factorization with
2
3n
3 flops by Gaussian elimination [41]. For the upper Hes-
senberg matrix, the LU factorization can be completed with
n2 flops. The complexity between the regular and rearranged
frequency partitions are M2 flops and 23M
3 flops, respectively.
Note that the computational savings of the regular tri-
sector frequency partition compared to the rearranged tri-sector
frequency partition is under the assumption of using perfect
sector directional antennas to construct the simplified channel
matrix (17). For actual antenna pattern, the channel matrix
of the regular tri-sector frequency partition will not be zero
elements due to the effects of imperfect radiation from the
sidelobe and backlobe, i.e., h(4),0, h(5),0, h(5),4, h(4),5 6= 0
in (17). As a result, both regular and rearranged tri-sector
frequency partitions perform full 3 × 3 matrix computations
with the same computational complexity.
Another advantage of the rearranged tri-sector frequency
partition over the regular sector frequency partition is
service fairness described in Section VI-B1. If network
MIMO is employed at the regular tri-sector frequency
partition, we need extra cell regrouping procedures to ensure
the service fairness among the coordinated cells in each group.
Finally, we summarize the features of the proposed FFR-
based 3-cell network MIMO systems: (i) using a small coordi-
nation size M = 3 to perform low complexity network MIMO
systems, (ii) reducing the effects of IGI via the combination
of FFR and directional antennas, (iii) avoiding the unbalanced
signal quality issue caused by larger coordination size M .
Note that actual cell sectorization cannot be perfect by using
directional antenna pattern (1). The other cells will also affect
the received signal quality of cell 0. However, by taking
advantage of sectoring and FFR, the impact caused by the
side-lobe and back-lobe transmissions (the grid areas in Fig.
4, Fig. 6 and Fig. 7) is not significant compared to the omni-
cell with universal frequency reuse factor of one.
VII. NUMERICAL RESULTS
In this section, we show the SINR performances of the
proposed FFR-based 3-cell network MIMO systems. Consider
a multi-cellular system with BS-to-BS distance RB2B = 2 km.
The interference-free SNR at cell edge is Γ = 18 dB for 120◦
sectorized cells. The same values of BS-to-BS distance and
Γ (for same transmission power comparison) are used for the
clover-leaf-shaped cells. The standard deviation of shadowing
is 8 dB and the path loss exponent µ = 4. Mobile users
are uniformly distributed within each sector/cell. The channel
response between any user-and-cell pair is represented by (3),
where the angle-depend antenna pattern is considered. In this
paper, we assume perfect CSI obtained at each BS and a
10
−30 −20 −10 0 10 20 30 40 50
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Received SINR (dB)
CD
F
Omni−cell with reuse one
ZF−DPC network MIMO in 
rearranged frequency partition
ZF network MIMO in 
rearranged frequency partition
Clover−leaf−shaped (600) 
regular sector FFR 
Fig. 12. The CDFs of received SINR for omni-cell with reuse factor of one,
60◦ regular tri-sector (1/3) FFR cellular systems and proposed rearranged
partition-based 3-cell network MIMO systems in 60◦ cell sectoring.
Fig. 9 shows the jointly effects of FFR and 3-cell ZF-based
network MIMO. The gain of the ZF-based network MIMO
is actually lower than that of the traditional 1/3 FFR-based
cellular system with the regular tri-sector frequency partition.
After applying the rearranged scenario, the performance gain
is also not significant. It is because the actual average power
of data stream becomes smaller according to (11). Even if
no first-tier interference exist through coordination, the signal
quality of the ZF-based network MIMO system is lower than
that of the ZF-DPC network MIMO system.
One important issue for system operators is how many users
can be supported for a specific data rate. This performance
metric can be quantified by the help of the coverage probability
or the reliability function defined as
P (γth) , Prob[SINR > γth] . (19)
Figures 10 and 11 shows the values P (γth) in percentage for
different MCS levels. From Fig. 10, the system can support
higher percentage of users with different MCSs transmission
under the proposed joint FFR and ZF-DPC network MIMO
scheme, especially for the rearranged tri-sector frequency
partition method. For example, there are about 5.5 ∼ 8 %
and 15 ∼ 26 % gains over the case for the FFR system
with sectoring. Nevertheless, in Fig. 11, one can observe that
the ZF-based network MIMO system in both rearranged and
regular tri-sector frequency partition schemes may perform
worse than the pure sectoring FFR without network MIMO
when 16-QAM or higher modulation levels are considered.
This phenomenon can be explained by the fact that the ZF
weights in (11) may decrease the transmit average data stream
power.
B. Effects of Cell Planning with Various Sectorizations
Secondly, we consider the effect of cell planning with
different sector directional antenna setups. Figure 12 shows the
received SINR performance with 60◦ sectorized cell planning.
−20 −10 0 10 20 30 40 50
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Received SINR (dB)
CD
F
3−cell omni−coordination
(with IGI) 
7−cell omni−coordination
(with IGI)
Diamond: FFR−based 3−cell network 
MIMO under 120o−shaped cell
Square: FFR−based 3−cell network 
MIMO under 60o−shaped cell
Fig. 13. Performance comparison of proposed FFR-based 3-cell network
MIMO with general omni-directional 3-cell and 7-cell network MIMO sys-
tems.
We find that the advantage of pure using regular sectorization
is obvious under 60◦ cell sectoring. It is because cell with
60◦ sectoring can perform better than 120◦ sectoring [16]
[17]. When further applying 3-cell network MIMO, the ZF-
DPC can obtain similar SINR performance compared with
120◦ sectorized cells. However, the gain of ZF-based network
MIMO scheme is not very significant at the 90-th percentile
of the received SINR, and is actually lower than that by using
tri-sector FFR scheme. In other words, under the rearranged
tri-sector frequency partition, the proposed 3-cell network
MIMO enhances the signal quality more effectively on cell
planning with 120◦ tri-sector architecture than with 60◦ tri-
sector architecture. Note that the performance of the omni-
cells with universal frequency reuse factor of one is different
in Fig. 8 and Fig. 9 due to different cell planning although the
difference is not much.
C. Benefit of Joint Frequency Partition and Network MIMO
Finally, we show the potential gains of combining tri-sector
FFR and network MIMO in Fig. 13. Take ZF-DPC as the
example. The performance degradations caused by IGI for
the 3-cell and 7-cell network MIMO systems are significant.
However, taking advantage of joint tri-sector FFR and network
MIMO, the proposed FFR-based 3-cell network MIMO archi-
tecture (for both cell sectorizations) with rearranged tri-sector
frequency partition can even outperform conventional 7-cell
network MIMO system. The improvement is about 2 dB for
60◦ sectoring and 3 dB for 120◦ sectoring at 90-th percentile
of the received SINR. It shows the potential benefit of using
a small number of coordinated cells.
D. Benefits of Network MIMO with Multiple Antennas at Each
Base Station
In future wireless broadband systems, BS may equip mul-
tiple antennas for exploring performance gains from transmit
diversity or spatial multiplexing techniques. In this section, we
12
beam direction of the tri-sector cell which has the maximal
antenna gain; the latter represents the user locating at the
boundary of the tri-sector cell where the antenna gain is 3
dB lower than the main-beam direction.
Here, we consider two-tier interference so that I =
{1, 2, . . . , 18} in which the number element represents cell
index. Denote the cell radius as R (= dref) and the considered
mobile at position A with distance d away from the serving
BS. The corresponding distances between mobile and interfer-
ers are
1st-tier cells

dA1 = d
A
2 =
√
(
√
3R/2)2 + (3R/2− d)2
dA3 = d
A
6 =
√
(
√
3R)2 + d2
dA4 = d
A
5 =
√
(
√
3R/2)2 + (3R/2 + d)2
2nd-tier cells

dA7 = d
A
9 =
√
(
√
3R)2 + (3R− d)2
dA10 = d
A
18 =
√
(3
√
3R/2)2 + (3R/2− d)2
dA11 = d
A
17 =
√
(2
√
3R)2 + d2
dA12 = d
A
16 =
√
(3
√
3R/2)2 + (3R/2 + d)2
dA13 = d
A
15 =
√
(
√
3R)2 + (3R+ d)2
dA8 = 3R− d
dA14 = 3R+ d
.
(23)
When mobile user locates at the position A, the angle between
user and serving BS is θA = 0, i.e., in the main-beam
direction of the sector antenna. Due to different frequency
assignments among cells, the co-channel interferers may point
to different directions for regular and rearranged tri-sector fre-
quency partitions, resulting in unequal antenna gains (angles).
To be distinguishable, we use θˆAi and θ˜Ai to represent the
relative angles with interferer i for regular and rearranged tri-
sector frequency partitions, respectively. The details of angles
between the mobile and the main-beam direction of interfering
BSs are listed in the Appendix.
Similarly, as a mobile locates at position B with distance
d to the serving BS, the corresponding distances between the
mobile and interferers are
1st-tier cells

dB1 = d
B
4 =
√
(
√
3R)2 + d2
dB2 = d
B
3 =
√
(
√
3R/2)2 + (3R/2− d)2
dB5 = d
B
6 =
√
(
√
3R/2)2 + (3R/2 + d)2
2nd-tier cells

dB7 = d
B
13 =
√
(2
√
3R)2 + d2
dB8 = d
B
12 =
√
(3
√
3R/2)2 + (3R/2− d)2
dB9 = d
B
11 =
√
(
√
3R)2 + (3R− d)2
dB14 = d
B
18 =
√
(3
√
3R/2)2 + (3R/2 + d)2
dB15 = d
B
17 =
√
(
√
3R)2 + (3R+ d)2
dB10 = 3R− d
dB16 = 3R+ d
.
(24)
The corresponding angles between the mobile and the inter-
fering BSs are also listed in the Appendix.
For examining the inner region (distance) with omni-
directional antenna, we can use above analysis by setting
A(θi) = 1. In this case, a mobile has the same SINR quality
at both position A and B. In other words, the omni-directional
antenna produces a circle region with radius d for equal signal
quality.
Table I shows the inner and uncoordinated distances cor-
responding to different SINR requirements with both regular
and rearranged tri-sector frequency partitions. We find that
the cells with regular frequency partitions can extend a larger
distance as mobile locates close to the main-beam direction
of a sector antenna (A) than to the sector edge (B). The
SINR guaranteed distances are also larger than that of a tri-
sector FFR cell planning which further partitions an inner
region by omni-directional antenna. Oppositely, the cells with
rearranged tri-sector frequency partitions has similar distance
extensions as mobile locates close to the main-beam direction
or to the sector edge. This is because there are two face-to-face
interferers in the rearranged scenario. When a mobile locates
in the main-beam direction of a sector antenna, the interference
also come from the main-beam directions. Additionally, the
extended distances in both A and B are close to the values of
the omni-inner region. That is, the contour of uncoordinated
region by rearranged tri-sector frequency partition will be close
to the region by omni-directional antenna. As a result, we have
the following comments:
• If cell planning combined with rearranged tri-sector fre-
quency partition, we can construct the inner region with
assigning suitable spectrum for uncoordinated transmis-
sions. In the outer region, we can use network MIMO
scheme to further improve the SINR.
• If cell planning combined with regular frequency par-
tition, it may not be easy to establish the inner region
for tri-sector FFR cellular system. Mobiles out of the
uncoordinated distance can use network MIMO. How-
ever, the improvements are not significant according to
the discussion in Section VII
IX. CONCLUSIONS
In the paper, from the aspects of architecture and de-
ployment, we have presented a FFR-based 3-cell network
MIMO tri-sector base station architecture that can effectively
overcome the inter-group interference and relieve the burden
of executing the complex multi-BS joint processing for a huge
number of cluster of cells. We further proposed a rearranged
tri-sector frequency partition to exploit the interference mit-
igation capability of the network MIMO transmission. We
demonstrated that using a 3-cell coordinated network MIMO
with the proposed rearranged tri-sector frequency partition can
outperform the 7-cell coordinated network MIMO with omni-
directional cell. We also analyzed how to determine the interior
region for the FFR-based systems and find that under 120o
sector antenna architecture the proposed tri-sector frequency
partition is more feasible for the FFR-based MIMO system
than the regular tri-sector frequency partition. This kind of 3-
cell coordinated network MIMO architectures are particularly
useful because the IEEE 802.16m WiMAX standard body has
14
are
I7 : θˆBi =
pi
3
+ tan−1
(
2
√
3R
d
)
;
I8 : θˆBi =
5pi
6
+ tan−1
(
3R− 2d
3
√
3R
)
;
I9 : θˆBi =
2pi
3
+ tan−1
( √
3R
3R− d
)
;
I10 : θˆBi =
2pi
3
;
I11 : θˆBi =
2pi
3
− tan−1
( √
3R
3R− d
)
;
I12 : θˆBi =
pi
6
+ tan−1
(
3R− 2d
3
√
3R
)
;
I13 : θˆBi =
pi
6
− tan−1
(
d
2
√
3R
)
;
I14 : θˆBi =
pi
3
− tan−1
(
3
√
3R
3R+ 2d
)
;
I15 : θˆBi =
pi
3
− tan−1
( √
3R
3R+ d
)
;
I16 : θˆBi =
pi
3
;
I17 : θˆBi =
pi
3
+ tan−1
( √
3R
3R+ d
)
;
I18 : θˆBi =
pi
3
+ tan−1
(
3
√
3R
3R+ 2d
)
. (28)
Similarly, with rearranged tri-sector frequency partition, the
angles for the worst case position B related to the first-tier
and second-tier interfering BSs are
I1 : θ˜Bi =
pi
6
− tan−1
(
d√
3R
)
;
I2 : θ˜Bi = tan
−1
( √
3R
3R− 2d
)
;
I3 : θ˜Bi =
2pi
3
+ tan−1
( √
3R
3R− 2d
)
;
I4 : θ˜Bi =
pi
2
+ tan−1
(
d√
3R
)
;
I5 : θ˜Bi =
pi
3
+ tan−1
( √
3R
3R+ 2d
)
;
I6 : θ˜Bi =
pi
2
+ tan−1
(
3R+ 2d√
3R
)
, (29)
and
I7 : θ˜Bi =
pi
2
+ tan−1
(
d
2
√
3R
)
;
I8 : θ˜Bi = θˆ
B
i =
5pi
6
+ tan−1
(
3R− 2d
3
√
3R
)
;
I9 : θ˜Bi =
pi
6
+ tan−1
(
3R− d√
3R
)
;
I10 : θ˜Bi = θˆ
B
i =
2pi
3
;
I11 : θ˜Bi = tan
−1
( √
3R
3R− d
)
;
I12 : θ˜Bi = θˆ
B
i =
pi
6
+ tan−1
(
3R− 2d
3
√
3R
)
;
I13 : θ˜Bi =
pi
3
+ tan−1
(
2
√
3R
d
)
;
I14 : θ˜Bi = θˆ
B
i =
pi
3
− tan−1
(
3
√
3R
3R+ 2d
)
;
I15 : θ˜Bi = pi − tan−1
( √
3R
3R+ d
)
;
I16 : θ˜Bi = θˆ
B
i =
pi
3
;
I17 : θ˜Bi =
pi
3
− tan−1
( √
3R
3R+ d
)
;
I18 : θ˜Bi = θˆ
B
i =
pi
3
+ tan−1
(
3
√
3R
3R+ 2d
)
. (30)
REFERENCES
[1] 3GPP TSG RAN 1 R1-101695. (2010, Feb.) “Text proposal for 3GPP
TR 36.814 on CoMP”.
[2] 3GPP TR 36.814 v9.0.0. (2010, Mar.) “Evolved universal terrestrial
radio access (E-UTRA); further advancements for E-UTRA physical
layer aspects (Release 9)”.
[3] IEEE. Standard 802.16. Part 16: air interface for fixed and mobile
broadband wireless access systems – DRAFT amendment to IEEE
standard for local and metropolitan area networks - advanced air
interface, IEEE P802.16m/D4, Feb. 2010.
[4] M. K. Karakayali, G. J. Foschini, R. A. Valenzuela, and R. D. Yates,
“On the maximum common rate achievable in a coordinated network,”
IEEE International Conf. of Commun., vol. 9, pp. 4333 – 4338, Jun.
2006.
[5] M. K. Karakayali, G. J. Foschini, and R. A. Valenzuela, “Network
coordination for spectrally efficient communications in cellular systems,”
IEEE Trans. on Wireless Commun., vol. 13, no. 4, pp. 56 – 61, Aug.
2006.
[6] G. J. Foschini, M. K. Karakayali, and R. A. Valenzuela, “Coordinat-
ing multiple antenna cellular networks to achieve enormous spectral
efficiency,” IEE Proc. Commun., vol. 153, no. 4, pp. 548 – 555, Aug.
2006.
[7] H. Zhang and H. Dai, “Cochannel interference mitigation and coop-
erative processing in downlink multicell multiuser MIMO networks,”
EURASIP Journal on Wireless Commun. and Networking, pp. 222 –
235, Feb. 2004.
[8] M. Costa, “Writing on dirty paper,” IEEE Trans. on Information Theory,
vol. 29, no. 3, pp. 439 – 441, May 1983.
[9] G. Caire and S. Shamai, “On the achievable throughput of a multi-
antenna Gaussian broadcast channel,” IEEE Trans. on Information
Theory, vol. 49, no. 7, pp. 1691 – 1706, Jul. 2003.
[10] S. Vishwanath, N. Jindal, and A. Goldsmith, “Duality, achievable rates,
and sum-rate capacity of gaussian MIMO broadcast channels,” IEEE
Trans. on Information Theory, vol. 49, no. 10, pp. 2658 – 2668, Oct.
2003.
 國科會補助專題研究計畫項下出席國際學術會議心得報告 
                                   日期：102年 10月 15日 
                                 
一、 參加會議經過 
Monday, 3 December 2012  9:00－17:00： 
參與 IEEE GLOBECOM 2012 Tutorial ，包含 An Introduction to Small Cell 
Wireless Networks、Mobile-Station and Base-Station Cooperation for 
Near-Capacity Wireless Communication、M2M in Smart Grid & Smart Cities: 
Technologies, Standards, and Applications 等。 
Tuesday, 4 December 2012  16:00－18:00發表下列文章： 
“ D ² ENDIST: Dynamic and Disjoint ENDIST-based Layer-2 Routing Algorithm 
for Cloud Datacenters “ ，並全程參與 Cloud Computing and Communication 
Technology , Chair：Hongfang Yu (University of Electronic Science and 
Technology of China, China) 
計畫編號 NSC99-2221-E-009-026-MY3 
計畫名稱 綠能寬頻無線電之研究：網路架構、干擾消除、和資源分配 
出國人員
姓名 
王蒞君 
服務機構
及職稱 
交通大學電機系特聘教授兼系主任 
會議時間 
101年 12月 3 日至  
101年 12月 7 日 會議地點 美國 Anaheim 
會議名稱 
(中文) 
(英文)  Globecom 2012 
發表論文
題目 
(中文) 
(英文)D ² ENDIST: Dynamic and Disjoint ENDIST-based Layer-2 
Routing Algorithm for Cloud Datacenters 
附件四 
 國科會補助專題研究計畫項下出席國際學術會議心得報告 
                                   日期：102年 10月 15日 
                                 
一、 參加會議經過 
Sunday 2 June 2013,13:30–17:00 Seminar : 
與 Chiung-Jang Chen共同發表 ” Small Cells Technologies in LTE Advance 
and Beyond “ 一文。 
Monday 3 June 15:30-17:00 conference： 
於 Heterogeneous Networks conference 擔任主席。於會議中帶領下述研究論
文進行交流。 
1. A Novel Dynamic Interference Coordination Scheme in 
Macrocell-Picocell Heterogeneous Networks  
2. Adaptive Mode Switching Based on Statistical CSI for Downlink MIMO 
in Heterogeneous Network with RRH Deployment  
3. An Inter-Cell Interference Cancellation for Downlink Layer-1/Layer-2 
計畫編號 NSC99-2221-E-009-026-MY3 
計畫名稱 綠能寬頻無線電之研究：網路架構、干擾消除、和資源分配 
出國人員
姓名 
王蒞君 
服務機構
及職稱 
交通大學電機系特聘教授兼系主任 
會議時間 
102年 6月 2日至  
102年 6月 5日 會議地點 德國德累斯頓 
會議名稱 
(中文) 
(英文)  VTC 2013 
發表論文
題目 
(中文) 
(英文) Small Cells Technologies in LTE Advance and Beyond 
附件四 
國科會補助計畫衍生研發成果推廣資料表
日期:2013/10/17
國科會補助計畫
計畫名稱: 綠能寬頻無線電之研究：網路架構、干擾消除、和資源分配
計畫主持人: 王蒞君
計畫編號: 99-2221-E-009-026-MY3 學門領域: 通訊
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
無 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
