Keywords: Face Sheet, Real-Valued Genetic Algorithm, Back-Propagation Neural 
Network 
1. 前言 
    近年來科技日新月異，IC 製程技術的不斷突破，造就了台灣科技產業的蓬勃發
展，尤其以筆記型電腦而言，每年的生產出貨量更是相當驚人。筆記型電腦的相關零
組件也因為科技的進步，需求量日益增加，面對這樣高需求的情況下，有必要節省人
力資源作有效的利用並降低生產成本以增加產品競爭力。而視覺檢測技術是工廠自動
化檢測中，一種最簡便且有效的方法，除了可在單調重複性高的工作中使用，也可應
用於無人工廠及高危險工作場合。而在產品檢測的過程中，常常因為人眼長時間使用
所造成的視覺疲勞，使得產品檢測的良率不一，基於此希望開發一套自動化光學檢測
系統，來取代人工檢測上的缺失。 
    本文提出一套應用於黑色滑鼠面板的表面瑕疵檢測技術。在黑色的滑鼠面板中
(如圖 1，圖中框線所圍部分為瑕疵所在處)，瑕疵與面板本身的灰階值對比度偏低，
造成檢測方面的困難，這與一般 PC 板上檢測元件瑕疵所遭遇之狀況有所不同；在影
像的前處理方面，利用對比伸張強化(Contract Stretch Function)[1]的方式將影像的對比
程度增強，搭配實數型基因演算法找出最合適的對比影像，利用空間域的低通濾波將
對比之後所產生的影像雜訊濾除，再利用邊緣特性[2]將瑕疵與面板分離，分割後所產
生的毛邊雜點則是利用形態學斷開的方式濾除，最後則是利用倒傳遞類神經網路 [3]
來作為瑕疵的分類器，藉由學習後的類神經網路來分辨出瑕疵種類。 
 
圖 1  具有瑕疵的黑色滑鼠觸控面板 
 
2. 研究方法 
2.1 文獻探討 
    滑鼠觸控面板之材質類似塑膠材質，表面並非完全平面，觸控面板本身會有ㄧ點
點彎曲的現象，這樣的現象會造成面板的受光面不均，且因為面板表面也是凹凸不
平，所以無法直接利用二值化分割方式，將瑕疵與面板分離出來，而表面瑕疵與面板
的灰階值差異不大，對比性不高且受光面不均的因素，亦造成檢測上的困難。蔡[4]
對於 TFT-LCD的 Mura瑕疵，利用獨立成份分析設計一個能凸顯具均勻或規律性紋路
表面瑕疵的濾波器，並利用粒子群最佳化演算法作為獨立成份分析求解的最佳化方
法。曾[5]在傅立葉(Fourier Transform)頻譜中心點選取一適當半徑，將頻譜上中心點與
最佳的物種。實數型基因演算法改善了以往基因演算法需要編碼與解碼的步驟，除了
減短演算時間、減少煩雜的編碼及解碼動作、並增加演算效率，實數型基因演算流程
如圖 2(a)所示。在進行實數型基因演算法之前，必須先將基因演算法所使用的參數做
前置設定，研究中所使用的參數包括族群數 (Popsize)、代數 (Generation)、交配
(Crossover)機率、突變(Mutation)機率、適應性函數(Fitness function)等，詳細參數設定
如表 1 所示。 
表 1  實數型基因演算法參數設定 
族群數 100 
代數 300 
交配機率 0.8 
突變機率 0.05 
適應性函數 f(x) f(x)=C_max-g(x) ,when C_max>g(x) 
   =0         ,otherwise 
 
    本研究所使用的 CCD 攝影機其擷取之影像大小為1024 768× pixel，且經由 Otsu[10]
二值化方法所找到的閥值為 180，當二值化的閥值設定為 180 時，可以很清楚的將面
板與背景分離出來，所以在設定染色體向量(min, max)的搜尋範圍時則是取 Otsu 所搜
尋到的閥值作為基準，min 的搜尋範圍為灰階值 0 ~89 之間，max 搜尋範圍為灰階值
90~180 之間。在基因演算法中有三個主要的運算部分：複製、交配、突變，分別介
紹如下： 
(1)複製：其目的則是複製適應性較好的染色體，使其優良的基因得以保存並傳播。在
本文中複製所使用的是輪盤法以及精英準則，輪盤法是將適應性高的物種擁
有較高的選中機率，而精英準則是保留適應高的物種，經由這兩個方式將最
佳的染色體保留下來。 
(2)交配：交配目的是希望藉由此過程來產生比上一代更好的物種基因，假設兩條染色
體向量 1 min1 max1P (K ,K ) 、 2 min 2 max 2P (K , K ) ，經由交配後所得到的子代(Offspring 
chromosomes)結果如式(3)，其中 iλ 是一個介於 0~1 之間的隨機數。 
1 min1 1 min 2 2 max1 2 max 2
1 min1 1 min 2 2 max1 2 max 2
1:[(1- ) , (1- ) ]
2 :[ (1- ) , (1- ) ]
Off K K K K
Off K K K K
λ λ λ λ
λ λ λ λ
+ +
+ +              (3) 
(3)突變：這個運算方式是為了獲得整體的最佳解，這樣的好處是避免過早收斂而不致
陷入局部的最佳解，計算公式如式(4)，其中 _ minpK 為基因範圍的最小值， _maxpK
為基因範圍的最大值，λ是一個介於 0~1 之間的隨機數，實數型基因演算程
式介面如圖 2(b)所示。 
_ min _ max _ min( )p p p pK K K Kλ= + −                     (4) 
   
(a)網路架構                          (b)程式介面 
圖 4  倒傳遞類神經網路 
 
    研究中使用的類神經網路總共有四層分別是：輸入層、隱藏層 1、隱藏層 2、輸
出層，詳細的類神經網路參數設定如表 2 所示。在類神經網路的輸入部分，則是針對
瑕疵的長寬比、最小矩形密度、伸長度、伸展度、X 方向的變異數、Y 方向的變異數、
真圓度這七種特徵值，來當作類神經網路的輸入，經由類神經網路學習後來判斷出滑
鼠觸控面板的四種瑕疵：刮痕、異紋、皺摺、污點。 
 
表 2  類神經網路參數設定 
輸入層 7 
隱藏層 1 5 
隱藏層 2 5 
輸出層 4 
訓練樣本數 120 
學習迴圈 250 
學習率 0.1 
 
3. 研究成果 
    本研究主要發展一套自動化瑕疵檢測系統，利用CCD攝影機取得影像，配合長條
型白色冷光燈作為系統的光源，並將擷取之後的影像經由系統判斷出是否具有瑕疵。
所使用的硬體方面包括有灰階的CCD攝影機(1024 768× pixel )、鏡頭、影像擷取卡、取
像平台及個人電腦(P4 3.0G 記憶體512MB)，取像平台如圖5(a)。在軟體方面則是使用
Borland C++ Builder 6.0 為程式開發工具，滑鼠觸控面板的檢測程式介面如圖5(b)所
示。 
   
 (a)取像平台                           (b)滑鼠面板檢測程式介面 
圖 5  系統設備簡介 
 
(a1)汙點 
 
(a2)影像對比伸張強化
 
(a3)最後處理結果 
 
(b1)刮痕 
 
(b2)影像對比伸張強化
 
(b3)最後處理結果 
 
(c1)異紋 
 
(c2)影像對比伸張強化
 
(c3)最後處理結果 
 
(d1)皺摺 
 
(d2)影像對比伸張強化
 
(d3)最後處理結果 
圖 7  黑色滑鼠觸控面板檢測結果 
 
表 5  檢測處理時間 
影像處理單元 處理時間(毫秒) 
影像對比強化 31 
影像空間域濾波 47 
邊界特性擷取 78 
形態學濾波 39 
瑕疵標註 46.7 
瑕疵分類 16 
程式總執行時間 257.7 
 
