 i
中文摘要 
    本研究計畫以達成全球企業間資訊交換電子化為目標，旨在建立一套產品
資料自動蒐集、整合、分類與快速搜尋之方法論，來滿足身處高速化社會的人
們對內容管理的需求。首先，以 UNSPSC 分類標準作為產品內容分類之參考依
據，並訂立有彈性的資料儲存架構及資料儲存格式正規化的方法論，進行產品
資料的結構化儲存，以利各類產品型錄之有效管理。本研究並利用 Web Services
技術來達成產品內容之搜尋與蒐集，將所獲取之產品內容加以效率化整理，進
一步轉換成 eCatalog XML 之標準格式傳輸，最後系統結構化地將資料分類及
儲存，以利於產品資料的搜尋及再使用，更希望能透過 ebXML 標準規範來與
各廠商進行商業流程的對談，以簡化資料取得的工作。本計畫已經針對系統架
構、系統模組功能、所需之資訊技術及分類搜尋關鍵性統計方法進行深入之研
究與探討。具體研究成果將於本成果報告書中詳述，成果亦已發表多篇國際期
刊論文。 
 
關鍵字：電子型錄管理、電子內容管理、可延伸標記語言、網路服務、電子交
易管道、電子採購、電子銷售、貝式機率 
 
 iii
 
 
目錄 
中文摘要 .................................................................................................................................................. I 
ABSTRACT ............................................................................................................................................ II 
目錄 ........................................................................................................................................................III 
1. 研究背景、動機與目的.................................................................................................................1 
1.1 研究背景 ...............................................................................................................................1 
1.2 研究動機 ...............................................................................................................................2 
1.3 研究目的 ...............................................................................................................................2 
1.4 研究方法及進行步驟 ...........................................................................................................3 
2. 文獻探討 ........................................................................................................................................5 
2.1 電子內容管理 .......................................................................................................................5 
2.2 電子型錄管理 ..................................................................................................................... 11 
2.3 ROSETTANET 標準 ..............................................................................................................17 
2.4 WEB SERVICE.......................................................................................................................19 
3. 內容管理系統架構及方法論.......................................................................................................23 
3.1 系統流程分析 .....................................................................................................................23 
3.2 型錄資料格式轉換系統(MAPPING SYSTEM)......................................................................24 
3.3 分類處理方法論 .................................................................................................................24 
3.4 以貝式理論為基之四層式 UNSPSCCODE 分類方法論 ...................................................26 
3.5 資料倉儲架構方法論 .........................................................................................................35 
3.6 WEB SERVICES 內容搜尋方法論........................................................................................40 
4. 系統細部流程分析與設計...........................................................................................................43 
4.1 系統之角色定義 .................................................................................................................43 
4.2 系統之功能模組概觀 .........................................................................................................44 
4.3 系統之軟硬體分析 .............................................................................................................45 
4.4 系統資料庫分析.........................................................................................................................46 
4.5 系統模組之各細部流程 .....................................................................................................48 
5. 系統實作 ......................................................................................................................................59 
5.1 一般使用者操作 .................................................................................................................59 
 1
1. 研究背景、動機與目的 
1.1 研究背景 
     隨著網際網路的發達與 Web 技術的成熟發展，網路上的內容資訊由以往
的資訊貧乏，轉變成為今日的資訊加速累積與擴散。正因大量資訊的簡易取得
與流竄，在茫茫網海中能找到所需的資料，成為現今 B2B 電子商務及電子化交
易的最大挑戰。雖然，目前網路上不乏眾多的搜尋引擎，但是以網路技術與應
用的現況和未來發展而言，現有的技術是不夠的。依現有搜尋技術所得之結果，
充斥著許多不相關的資訊，在高速 e 化的環境下，高效率的搜尋分類及搜尋方
式以及快速尋獲所需產品或技術內容才是競爭力的關鍵泉源。 
    隨著電子商務的蓬勃發展，電子市集的成敗及經營方式成為眾所矚目的焦
點，良好的電子市集，必須提供使用者多樣化及動態的商品，與技術(服務) 內
容，以滿足使用者的需求，因此內容管理儼然成了一個新興的研究主題。內容
管理必須從各種管道蒐集到各式各樣的資料，並建置在單一資料庫中，以加速
資訊的使用及查詢，而若要達到此一目的，則必須先解決三個重要議題，一為
如何做到有效率的蒐集及整合資料。二為如何對多元且異質的資料進行管理及
分類。三則是提供實現資料交換核心界面及方法。整體需求的前因後果及所需
解決之議題可以圖 1 表示。 
Content
Management 需求
資料快速
搜尋需求
eMarketplace
產品管理需求
大量資料搜尋
不易
產品資料過多
管理不易
資料收集方法 資料整理方法 資料分享方法
企業資料
管理需求
Support Support
 
圖 1 內容管理需求圖 
 
 
 
 3
將針對圖中各塊領域中前人未曾做過的地方進行深入的探討。 
資料收集方法 資料整理方法 資料分享方法
*Web Service
*Web Html
*XML資料格式
交換
*資料分類
*資料儲存格
式正規化
同義詞庫之建
立
人工蒐集法
*Web Service
Web Html
*ebXml蒐集法
*多語系分析
ebXml資料分
享方法
 
圖 2 內容管理課題及可能解決技術 
    在本研究計畫中將提出整體性的系統架構，並針對其中星號(＊) 的某些部
分進行深入的探討。 
 
1.4 研究方法及進行步驟 
內容搜尋Web Service
Data Collection System
Outer Web
Service
Man-made
Collect System
Outer Homepage
Parser
1.On-Line Editing
2.Data Import
3.Data Milti-Format
Export
Supplier
Catalog
Maintain
客
戶
端
資
料
搜
尋
關鍵字查詢自動類別搜尋
Web入口網站
內容管理系統 多
語
系
字
串
處
理
查
詢
字
串
資
料
正
規
化
產品分類處理
資料正規化
分類管理 索引建立
同義詞處理 多語系處理
結構化儲存 資料分析處理
客戶(人)
客戶(系統)
 
圖 3 理想之內容管理系統整體架構圖 
    本研究計畫提出的整體型錄管理架構如圖 3 所示，希望未來的 Content 
Management 可朝圖 3 的目標邁進。而本研究計畫中也將分部分的探討此整體系
統的可行性與可實做性，最後再完成一個具體的雛形系統(包括以透過 Web 
Services、ebXML 去自動蒐集資料與結構化資料，並建立資料的索引，讓使用
 5
2. 文獻探討 
2.1 電子內容管理 
    對於內容管理，國外的專家學者有著各式各樣的要點描述，根據 Guenther 
(2001) 的說法，內容管理的範圍包含規則、流程、系統架構的組合，它能幫助
組織管理文件、圖像、多媒體資料、程式等各類內容，另外它還必須提供一些
功能來管理傳統的 Html，讓前端的使用者方便的使用，且它必須提供一些背景
程式來定義、標準化、控制及儲存 Content。根據 Stonebraker 和 Hellerstein (2001) 
的描述，內容管理必須要解決企業所擁有的半結構化或無結構化內容之產生、
追蹤、版本控管、儲存及儲存上的問題。根據 Griffith、Krampf 和 Palmer(2001) 
的說法，內容管理包含一些靜態物件的管理，例如圖像、文字、數位文件和多
媒體資料等。綜合以上的說法，本研究計畫認為內容管理應該是去替企業管理
所有的圖像、文字、數位文件、程式和多媒體資料，並可以讓企業中的任何使
用者可以很快速的搜尋到它所想要找的任何資料。 
    根據孫雅麗(2000) 所言，要做到資訊文件的管理，必須要有良好的方法來
解決分類及搜尋兩個問題，資訊搜尋工具必需要先將文件內容放置入事先定義
好的類別中後，才能讓使用者快速的進行查詢。而其中，找出文件內容應放置
的類別，這個動作稱為『分類』。分類有兩種方式，一是利用人工手動去分析及
分類文件內容，此法準確度高，但若文件數量過多，則人工將無法處理大量的
分類需求；另一種方法是利用電腦來輔助自動分類，但是這種方法容易受到文
件內容的雜訊及用語，影響到分類的準確度。另外，當使用者下達搜尋命令時，
系統必須找尋出使用者想要的類別，再在該類別範圍中做更為細部的內容比
對。因此，本研究計畫認為，內容管理所要做的主要工作就是設計一良好的儲
存庫，來有效的替內容作分類及追蹤管理，並以讓使用系統的人可以快速的搜
尋到內容為目標。以下則針對此兩個主題之現行作法做文獻探討及深入研究。 
 
 7
每個維度代表文件不同的特徵。文件的向量則由字彙的原型所組成，再計算詞
彙於文中出現頻率以評估詞彙的代表性，而查詢問句亦以相同的方式找出具有
代表性的詞彙組合，接著再將文件與查詢問句的向量以內積計算出兩者的相關
程度。它有別於之前各種檢索模式一次僅針對單一文件做處理，採用向量空間
模型則是針對一群文件間彼此的差異來作為索引的對象。 
    雖然全文檢索看似解決了搜尋上的問題，但在內容管理上，並不是百分之
百適用，根據吳政叡(2002) 的說法，他指出全文檢索雖然有其優點和適用場
合，但也非絕對適用，它存在一些應用上的限制，例如非文字資料基本上是不
適合使用全文檢索的，如地圖、聲音、影像等。即使是文字資料，也並非所有
檢索需求均可由全文檢索式的處理來滿足，例如數值形態的資料就沒有辦法使
用全文檢索。在內容管理的領域中，我們常常需要使用到數值型態的比對功能，
不單單只是字串的比對，例如在找尋產品時，使用者常常希望能找到某屬性的
屬性值是在那個範圍中的產品集合，而非只有文字形態的比對。因此，在內容
管理的領域中，只有全文檢索是明顯有所不足的。本研究計畫將發展一系統架
構，讓資料的提供者可以動態的定義及描述本身的資料，並讓系統很容易的搜
尋與呈現。 
 
2.1.2. 內容管理的分類 
    在內容管理的領域中，為了加速內容的取得，所有的內容均需被適當的歸
類，諸如圖像、數位文件、程式、多媒體資料及產品資訊等。而其中最複雜也
最困難的莫過於產品資料的歸類問題，新進入系統的產品資訊，必須要被安排
一個適當的分類碼，才能在搜尋時可以有效率的找到該產品。要建立一個通用
性的內容管理系統，首先必須要有能力處理全球各地種類繁多的產品，而本研
究計畫所欲發展的系統將以通用型的型錄管理系統為主。目前世界上有各式各
樣的產品及服務分類標準，如 UNSPSC、SIC/NAICS、NIGP、Internal、CCCCode
等，而其中最活躍也是最多人使用的莫過於 UNSPSC(UNSPSC White Paper, 
 9
屬語系的字元集，最顯而易見的地方就是當我們打開瀏覽器時，有數十種的語
系可供選擇。而現代，為了達到各語系國家資訊系統的互通，不得不發展一通
用的字元集，讓所有語系的所有字元都存在一個系統下，Unicode 即為因應此
一目的所發展出之字元集，以下即為其簡介(Unicode Standard, 2002) 。 
全球字元集標準 Unicode 
    所謂 Unicode 是 Unicode 協會所創立的字元集，Unicode 全球字元集標準，
全名 Unicode Worldwide Character Standard，是一種字元編碼系統，用來支援全
球各種現代語文之轉換、處理與顯示。此外，它還支援著各種手寫方式的古典
及歷史文字，使得文字涵蓋範圍更加豐富與廣泛。將 Unicode 與網際網路、多
層應用程式結合，可以使單一網站貫穿許多作業平台、不同的語系與不同的國
家。最後，就目前而言 Unicode 的主要編碼方式有兩種，一種是 UTF8(非固定
式編碼長度，一至三個位元組) ，另一種是 UTF16(固定式編碼長度，兩個位元
組) ，其差異將分別由下解釋。 
UTF8 與 UTF16 形式之 Unicode 
    UTF-8 編碼方式主要是以 3 個位元組為主，在編碼過程依語言別所需，自
行判斷所需空間來調整儲存空間大小，也就是一個 Unicode 字元可能以 1 至 3
個位元組儲存。它是一種可變長度的編碼方式，例如在儲存英文字元時，只使
用一個位元組來儲存該字元，運用此編碼方式儲存的好處是可以節省較多的硬
體空間。另外，UTF16 編碼方式則是一律以兩個位元組來儲存該字元，只提供
固定字元長度來儲存，這是兩者間最大的差異。 
    由上述說明可知，UTF-8 字元格式會根據不同語系而改變長度，如 UTF-8
在編碼英文時只需 8 位元組，但中文則是 24 位元組，所以中文字出現比例較高
的地方還是使用 UTF-16 比較節省空間。而採用 Unicode 為編碼方式的系統，
將可以在單一系統中輕易跨越多國語系，呈現多國的語言，這是現代的內容管
理系統必須要提供的功能。 
 
 11
2.2 電子型錄管理 
    在內容管理的中，產品型錄管理佔著非常重要的一部份，每個公司行號或
企業都有著它各自的產品或服務來獲取利潤，面對全球越來越複雜的產品及服
務內容，以往將產品屬性寫死在資料庫表格欄位中的作法已不敷使用，而為了
要動態及詳細的描述產品資訊，型錄管理也變得格外重要。本研究計畫想要替
全球所有的公司發展出一套通用型的系統架構，讓各不同領域之異質性廠商的
產品資料都能共同存在本系統中，搭配本系統的內容編輯模組及搜尋機制，企
業將可以在本系統上共享產品型錄資訊，並以達到產品資料共享及管理為目的。 
    基於對大量且複雜產品資料維護之需求，國內外型錄大廠紛紛投入經費，
期望能在 content management 領域中，尋求一最佳解決方案，建立一兼具彈性
與效率之資料儲存方式與資料搜尋方法。本研究計畫首先針對部分國外對此領
域有深入研究的組織所訂出之規格，進行深入分析及比較；並擷取他們作法上
的優缺點，希望能探討出一最佳解，來發展一更為優良的系統架構。以下即針
對電子型錄管理領域中兩家較優秀之組織 eCatalog XML(eCX) (eCX,2002) 及
Open Catalog Format(OCF) (OCF,2002) 進行分析及比較。 
 
2.2.1 eCatalog XML (eCX) 
    eCX 為專為電子型錄整合而生的一個組織，它提出了一些準則來規範異質
資料庫中的型錄之新增、修改及刪除等方法，因此，只要是有能力處理 XML
檔案格式的軟體，皆有能力按照 eCX 所規範的 XML Schema 來產生 XML 檔案，
並藉此 XML 檔案來更新遠端合作系統之資料庫(eCX Standard, 2003) 。 
    要達成電子型錄的整合，可以使用如圖 5 所示的方式，由 Company1 使用
XML 相關軟體，產品符合 eCX XML Schema 所規範之 XML Files，再由
Company2 接收 eCX 檔案格式的 XML Files，經 XML 相關軟體進行匯入動作，
更新資料庫，以達到異質資料庫間資料傳輸整合的目的。 
 13
Schema
Catalogry Attribute Navigation Metadata
Name Value Type Update Comment
 
圖 7 eCX 文件驗證樹狀架構圖 
y Data：如圖 8，為資料真正儲存處。資料儲存分成三個部分，分別為 Item、
Data Extension 及 Pricing。其中以 Item 為型錄資料儲存所在，Data Extension
為群組資料集合，Pricing 則是針對各種不同層次客戶之訂價管理，如圖 8
中所示。 
Data
Data
Extension Item Pricing
Owner NameValue KeyValue Update DataExtension Meta Data Comment  
圖 8 eCX 資料儲存樹狀架構圖 
 
2.2.2 Open Catalog Format (OCF) 
    為公立組織所提出的一個共通性型錄儲存架構，來協助廠商儲存、表示及
傳送型錄資料，透過樹狀結構及屬性描述的方式來表達型錄。另外，OCF 是一
種產品陳述語言。它不定義任何分類下的屬性及資訊。例如，OCF 不為特定範
疇或者專門領域分類的產品屬性命名，取而代之，OCF 由用戶自行定義他們
(OCF Standard, 2003) 。因此，OCF 能夠從 RosettaNet 那裡取得特定產業規格
的專門標準，並使用在 OCF 的規格中。如此使用 RosettaNet 規範的廠商，將可
以把 RosettaNet 的分類架構套入 OCF 的規範，並透過 OCF 所提供的軟體，進
行軟體間跨 Internet 之 OCP Protocol 資料交換，達成資料透通，如圖 9 所示。 
 15
2. Interval Value：該屬性值具有區間性特質，以此方式定義之，範例如下
所示： 
<attr name="weight" valuetype="float_i" value="[2.0，4.0]"/> 
3. User-defined Value：OCF 允許使用者自訂資料型態，如同資料庫中的
command 一般，使用者可定義各種資料型態，範例如下所示。 
<attr name="date" valuetype="date" value="Wed Aug 25 20:55:42 PDT 
1999"/> 
    OCF 產品型錄特性為其屬性具有繼承性，某型錄下的產品乃繼承母節點的
所有屬性。其型錄搜尋方式是透過使用者定義的交集及聯集的方式、及屬性值
對應方式達成，範例如下所示。 
<?xml version="1.0" standalone="yes"?> 
<!--  Query request format  --> 
<query toplevel="and"> 
<!-- toplevel defaults to "or" --> 
<and><attr name="Cost" valuetype="float" value="29.99"/> 
<attr name="Platform" value="Microsoft Windows 95"/> 
<product name="6f*"/><or> 
<attr name="foo" value="9" valuetype="integer"/> 
<attr name="bar" value="8" valuetype="integer"/> 
</or></and><or> 
<attr name="Version" value="7.0"/> 
<attr name="Version" value="6.0"/></or> 
<attr name="Features" valuetype="strings"> 
<value><val>Inline pictures</val> 
<val>HTML ready</val></value></attr> 
<not><or><attr name="Color" value="red"/> 
<attr name="Color" value="blue"/></or></not></query> 
 
2.2.3 解決方案比較 
eCX 與 OCF 的比較如下： 
y XML 之使用：eCX 與 OCF 兩者之產品儲存架構，皆採用了 XML 為記錄產
品的標準方式，主要是要應用 XML 跨平台及格式可以自訂等優點。 
y 型錄資料建立資訊：eCX 針對資料開創者的資料有詳細的記載，分為
Admin、Schema 及 Data，而 OCF 主要為 Schema 及 Data 的部分。 
y 版本控制及更新狀態：eCX 在資料擷取課題乃定義 Metadata 紀錄型錄更新
狀態，並有資料更新的追蹤檔，而 OCF 則無此機制。 
 17
2.3 RosettaNet 標準 
2.3.1 RosettaNet 基本介紹 
    為了解決各供應鏈內各事物命名之混亂情形，一些有志於訂立標準命名規
則及作業流程的廠商組成了 RosettaNet 非營利性組織，希望能為日後的供應
鏈，訂定出一套標準的命名規範及流程規範。RosettaNet 的首要目標是制訂企
業流程(business processes) 的標準，次要目標則是訊息語法(message syntax) 的
標準(RosettaNet Taiwan, 2002) 。 
    在 RosettaNet Taiwan (2003) 網站中，它說明了在傳統的商業交易模式中，
人們必須透過聲音來傳遞所需的訊息，而這些訊息在各供應商間之傳輸，必須
以共同共通文字及文法為基礎，經由電話或其他媒介來達成整個交易過程。又
在現今系統對系統的企業交易模式(system-to-system business exchange) 中，網
際網路(Internet) 可以說是資訊交換的媒介，就如同聲音用來傳送訊息一樣。在
這之上 XML/HTML 就扮演著真實世界中語言的角色，如英文、中文、日文等。 
    Dictionary 則是代表著一個統一的標準用語字典，這點在數位世界中是相
當重要的。例如，當我們在描述車子的時候，有人說＂車子＂、＂汽車＂或＂
轎車＂時，大家都可以知道這是什麼東西，並且知道每個人所指的都是相同的
東西。然而，對於數位世界中，這種多樣式的稱呼卻會造成電腦的模糊，勉強
用人工智慧辨識或是用轉換表(Mapping Table) 轉換，仍然是相當複雜的問題，
並且又不能解決所有領域的問題。 
    而在Dictionary之上，RosettaNet的應用架構(Implementation Framework) 就
相當於語言中的文法，而 RosettaNet 的交易界面流程 Partners Interface Processes 
(PIPs) 相當於一般的對話模式(Dialog) ，如下訂單的模式、查詢產品標價的模
式等。建立在 Dictionary、Implementation Framework 和 PIP 之上就是所謂的電
子化作業流程(eBusiness Process) 。圖 10 中說明了 RosettaNet 的開發重點是在
Dictionaries、Framework、PIP 和 eBusiness Process，以下分部分說明之。 
 19
    RNIF 是一種為了讓 RosettaNet PIPs 可以正確運行所生的執行架構。因為
PIP 是一種企業對話，而對話間所交換的資訊則為 Business Document，是一種
由 XML 所製成而成之企業文件。RNIF 即是為了讓這種企業文件可以在網路企
業伙伴中順利的交換流動，又同時兼具安全性及正確性所產生的執行平台。 
 
2.3.4    PIPs 
    PIPs 為 RosettaNet Partner Interface Process 的縮寫，為 RosettaNet 發展的主
軸，Dictionsry 及 RNIF 只是為了要達到能使用 PIPs 來完成企業交易所發展出
來的輔助工具而已。PIP 是一種電子化企業交易流程的交易規格說明書，包含
了整個電子化企業的架構。RosettaNet 訂定的 PIP 由 Cluster 至 Segment 至 PIPs，
皆是將供應鏈中的營運架構，依一些既定的流程模式來制訂。而其中流程架構
包含了企業伙伴的關係建立、新產品發表、市場建立、訂單管理、庫存管理及
客戶服務之維護等，將這些流程打散成各個重複性高且可重複利用的 Process，
並訂出交易雙方所必須提供的界面。 
 
2.4 Web Service  
    自有電腦以來，各行各業紛紛投入大量的資金及努力去開發優良的資訊系
統，但這些各自的資訊系統，並沒有考慮到今日電子商務的興起，因此，在各
行業各自的資訊系統間，並沒有共通的準則，來讓系統間能夠互相溝通，以致
於在電子商務的時代，沒有辦法做到跨系統的及時溝通。有鑑於此，各種交換
的方法紛紛出籠，而 Web Services 也是為達此一目所發展出來的方法之一，它
主要的原理是透過各個資訊系統都有能力處理純文字檔的能力，在純文字檔中
加一些標籤(XML 檔案) 來讓溝通的雙方皆瞭解檔案的含意，以達成溝通的目
的。以下就是為了到以 Web Services 溝通所定義出的一些標準及方法(Grahan, S., 
2002) 。 
2.4.1    Simple Object Access Protocol (SOAP) 
 21
黃頁：一些公司的分類資訊，將註冊的公司作有效的歸類。 
綠頁：註冊與其它公司互動的 XML 檔案格式，顧客只要得知此格式內容，即
可和註冊公司透過 XML 格式溝通，並獲得服務。 
 
2.4.3    Web Services Description Language (WSDL) 
    WSDL (Web Services Description Language) 在網路服務中，扮演一個『描
述網路服務』的角色。在 Web Services 的世界中，如果沒有一個統一的描述網
路服務的格式，資訊系統將無法瞭解服務的內容及傳送與接收之資料型態。
WSDL 標準目前由  IBM 及  Microsoft 所研擬，裡面說明相關服務的
IDL(Interface Description Language) 及程式間如何協同合作以進行網路服務
(World Wide Web Consortium, 2003) 。 
    WSDL 是利用 XML 語言所寫成，只是副檔名為 WSDL。WSDL 語法主
要分為兩個部分： 
(1) 描述服務界面(Service Interface Definition) ：這個部分主要是說明 WSDL 檔
案的資料格式、傳遞溝通的訊息、服務如何進行以及各種規範等，這個部分是
可以重複使用的。針對這部分，Web Services 所必須定義的有 
服務型別(TYPE) ：定義進行服務所必要的資料元素及資料型態 
訊息(Message) ：定義訊息，說明有哪些資訊需要傳輸。 
服務流程(PortType) ：定義一連串網路服務的作業。包括了『資料輸入項』與
『資料輸出項』等。 
服務鏈結(binding) ：主要是定義服務傳輸協定及相關資料型態 
(2) 實做服務之定義(Service Implementation Definition) ：這個部分主要是說
明，由如何進行服務提供者所提供的服務，包括：提供服務的廠商、提供服務
的網路位置等 
服務連接埠(Port) ：說明了網路服務的服務端點位置(URL) 。 
網路服務(Services) ：說明了服務的名稱 
 23
3. 內容管理系統架構及方法論 
3.1 系統流程分析 
    本研究計畫中所提及的 Content 以各廠商公司所提供的產品資料及服務為
主。而本研究計畫所建置之系統中，希望能廣納各 ERP 中關於產品描述領域所
現有的 XML 格式檔案，將之轉換成 eCX Schema 所規範的 XML 檔案內容，再
進一步傳送到本系統做資料正規化、多語系分析與產品分類處理等，希望能在
最小的努力下，達到最高結構化整理資料的成果。待資料儲存於資料庫後，再
進一步的將它建置成一個 Web Services，讓各方的顧客，不論使用任何作業系
統與任何程式語言，皆可透過 Web Services 來獲取內容管理系統中的內容。最
後，在客戶端查詢資料庫的同時，也必須要同時維護產品查詢次數的紀錄或增
加使用者端的回饋，以作為下次使用者查詢時之參考依據。 
產品資料處理系統
RosettaNet 格式之
ERP 任何格式之 ERP
使用Web Service
接收產品資料訊息
eCX標準格式
的 XML檔
Xml Format
Request
Xml Format
Response
Web Service Server
資料正
規劃
多語系
處理
產品歸
類處理
程式語言選擇
Java C++ .Net Perl VB
Client User
作業系統選擇
Linux Window Solaris UNIX FreeBSD
產品資料儲存系統
關連式資
料庫
☉查詢結果記錄
☉實驗數據維護
☉資料型態分析
Supplier
Content
Management
Kernel
Client
User
型錄資料格式轉換系統
 
圖 11 論文系統流程圖 
 25
UNSPSC 分類產品時，我們只需比對被歸於此分類的產品即可。 
    目前本系統有兩種方式輸入型錄資料，一種是透過 RosettaNet 的 2A2 PIP
來向供應商尋求產品資料，在此狀態下，由於所要到的資料的格式是屬於
RosettaNet 的標準規範，又 RosettaNet 的分類標準本來就是使用 UNSPSC 分類
標準，因此，由此方式進入本系統的資料的分類碼，並不需再做轉換的動作。
但，若是經由另一種方式進入本系統的產品資料，亦即由其它 ERP 轉入的檔
案，本系統將採用 3.4 節中的方法論，算出各種分類的機率，將產品資訊歸到
最有可能的類別中，並由資料的提供者做確認及修改的動作。 
    另外，由於 UNSPSC Code 為階層式架構的設計，因此，當使用者查詢某
類別產品而找不到時，系統可以很容易的再查詢 UNSPSC 分類碼階層樹上同一
階層的產品類別，或者往樹狀結構的父類別或子類別做再查詢的動作。另外，
本系統也可以讓查詢者自訂要從那個類別之下開始搜尋，及要往下搜尋多少階
層。例如，若使用者欲查詢整組的筆記型電腦產品，則不需要往筆記型電腦的
子類別，如 CPU、硬碟或記憶體等，來作搜尋。又若使用者對電腦產業的相關
零組件產品都有興趣，則他也可以告訴系統替他找電腦類別下多少層分類的產
品類別，階層樹狀如 13 圖所示。 
 27
貝式理論為基之分類方法來幫助使用者或供應商找到產品資訊欲歸屬到的類
別。接下來本文將以單層分類碼的分類方法開始說明，再說明如何將此分類方
法使用到四層式架構的 UNSPSCCode 分類方法中。 
貝式理論：
)|()()|()(
)|()(
)(
)|()()|(
ABPApABPAp
ABPAP
BP
ABPAPBAP ×+×
×=×=  
系統定義 
⎪⎪
⎪⎪
⎪⎪
⎪⎪
⎪⎪
⎪⎪
⎪⎪
⎪⎪
⎪
⎩
⎪⎪
⎪⎪
⎪⎪
⎪⎪
⎪⎪
⎪⎪
⎪⎪
⎪⎪
⎪
⎨
⎧
×+×
×=
×+×
×=
⊂
…=
)|()()|()(
)|()()|(
)|()()|()(
)|()()|(
而得到事後機率：，可根據實驗的成敗當某個新進產
實驗，實驗失敗的機率                   
分類Ci品去作系統中分類的情況下，拿該產Ci：在新進產)|(
，實驗成功的機率 實驗                   
分類Ci品去作系統中分類的情況下，拿該產Ci在新進產)|(
驗，實驗失敗的機率                   
分類實Ci品去作系統中分類的情況下，拿該產Ci：在新進產)|(
實驗，實驗成功的機率                   
分類Ci品去作系統中分類的情況下，拿該產Ci在新進產)|(
佔所有產品之百分比分類Ci系統中P(Xi)
事件分類之關鍵字中找到之Ci％以上可於系統80鍵字            
之關新進 之關鍵字作比較，分類關鍵字與新進產Ci取系統中之Zci
分類的事件Ci某新進產 Xi
分類之關鍵字中Ci可於系統％以上80鍵字            
之關新進 之關鍵字作比較，分類關鍵字與新進產Ci取系統中之
UNSPSCCode  Ci
15190151901,2i
XiZciPXiPXiZciPXiP
XiZciPXiPZciXiP
XiZciPXiPXiZciPXiP
XiZciPXiPZciXiP
ZciZci
XiZciP
XiZciP
XiZciP
XiZciP
Ci
Unspsccode
）或（品進入系統時
品不為
品不為：
品為
品為：
產品：
關
產品品：
品為：
找到是否關
產品品分類實驗：
分類碼
分類數目為，其中
 
    事前機率為不給定任何其它條件下，猜測新進產品為 Ci 分類的機率。例
如：假設全球有 100 個產品，其中 8 個產品屬於筆記型電腦分類，若現在有一
個新的產品產生，系統會使用 8/100 的機率來猜測該產品為筆記型電腦分類，
 29
1. 定義每一個 UNSPSCCode 所屬的關鍵字，而這些關鍵字必須為此分類產品
用來描述此產品時，常常使用到的字詞。 
2. 使用反覆的試驗來得到較準確的 )(XiP 、 )(XiP 、 )|( XiZciP 、 )|( XiZciP 、
)|( XiZciP 及 )|( XiZciP ，而機率的獲取方式將會在下一小節中介紹。 
3. 根據產品資料作每個分類試驗時的成敗( Zci 或 Zci ) ，計算該產品為各個
UNSPSC 分類碼的事後機率，其中事後機率計算方式為： 
For Each  i  In 分類碼  
{ 
做 Ci 分類試驗得到實驗結果( Zci 或Zci )  
If ( ZCi )  
)|()()|()(
)|()(
)(
)|()()|(
iXZciPXiPXiZciPXiP
XiZciPXiP
ZciP
XiZciPXiPZciXiP ×+×
×=×=
 
Else 
)|()()|()(
)|()(
)(
)|()()|(
iXZciPXiPXiZciPXiP
XiZciPXiP
ZciP
XiZciPXiPZciXiP ×+×
×=×=
 
} 
4. 找出事後機率最大的數個分類碼。 
    使用上述方式則可以將產品經過分類試驗後，得到更準確的事後機率。而
在四層式架構的 UNSPSC 分類碼中，總共的分類數有 15190 分類，若是要在判
別每一筆產品分類時，都需做 15190 次分類試驗，對於系統將是一個沈重的負
擔，本研究計畫採用廣度優先搜尋(BFS) (Fukuda, K., 2002) ，使用分層式的判
斷方法來判別分類，判別的流程如圖所示。 
 31
    在四層式的分類方法中，每一層所決定的分類個數並不是固定的，而是可
以隨著使用者之不同喜好動態調整。 
 
3.4.2 實驗機率訓練方法 
    事前機率需要初始化，否則每個分類機率皆為 0，則沒辦法繼續系統之運
作。本系統先假設每個分類的出現次數都為 1，來初始化系統的事前機率，經
初始化後再由廠商上傳型錄或使用者查詢產品分類時之分類決策，來更正產品
分類的出現次數，以得到更為正確的事前機率，如圖 16。而其中各分類事前機
率的計算為： 
之父類別之所有產品數分類之產品數 CiCiXiP /)( =  
假設每個第四層
UNSPSC分類之產
品各出現一次
計算本系統各分
類之事前機率
初始化事前機率
回饋產品出現次數給系統  
圖16 事前機率訓練圖 
    實驗機率的初始化則是使用一些已知產品分類的實驗資料來訓練系統，得
到實驗機率，而得到初始化的實驗機率後，還可以持續的由供應商上傳型錄時
自動分類後之確認結果和一般使用者型錄查詢時自動分類後之確認結果，來得
到回饋的統計資料，如圖 17 所示。而其中各分類實驗機率的計算方法為： 
由系統訓練資料： 
For Each i In 分類碼 
{ 
分類產品之個數產品中為分類試驗個數分類產品通過 CiCiXiZciP /Ci)|( =  
分類產品之個數產品中為分類試驗個數分類產品不通過 CiCiXiZciP /Ci)|( =  
分類產品之個數產品中不為分類試驗個數分類產品通過非 CiCiXiZciP /Ci)|( =
 33
圖 17 實驗機率訓練圖 
 
3.4.3 產品搜尋方法 
    UNSPSC 標準雖然解決了本系統中產品分類的困難點，但也同時增加了搜
尋端使用者在搜尋產品時的困擾。使用本系統的使用者如果熟悉 UNSPSC 分類
碼，那他將可以沒困擾的很快的找到產品分類，但如果使用者不熟悉 UNSPSC 
分類標準，那他將很難在數以萬計的產品分類中，確定欲搜尋產品的精確分類。
而在本系統中，找到該分類是系統搜尋產品的第一步，因此本系統利用 3.4.1
節中所提及的分類方法，來減少使用者不瞭解 UNSPSC 分類的困擾，希望能夠
為使用者自動的判定產品分類，以最小化電腦與人類互動的次數，並最大化類
別搜尋的準確性。 
    在本小節中，系統處理的字串為使用者的查詢產品資訊，系統透過將使用
者查詢之產品資訊與系統 UNSPSC 各分類的關鍵字做比對，可以算出使用者查
詢各分類的機率各為多少，若使用者不滿意目前所搜尋出來的產品，則他可以
選擇其它分類，或將條件放寬，由系統幫助使用者挑選出更多的分類，以得到
更多相關的產品，以下提供了一個搜尋範例。 
    範例：假設我們系統有五個分類，分類名及事前機率分別為 A10%、B20%、
C30%、D10%、E30%，又，在系統中，對五個分類所訂出之關鍵字分別為 A
類(筆記型電腦) ：”CPU/晶片組/主記憶體/顯示裝置/硬碟/光碟”；B 類(連接
線) ：”顏色/長度/應用領域/連接器” ；C 類(靈芝) ：”產地/種類/功效/服用方法
/注意事項/主原料/特色” ；D 類(耳溫槍) ：”測量時間/掃描頻率/測溫範圍/尺寸
/重量/型號/價格” ；E 類(輪圈) ：”尺寸/成分/用途”。 
其中 C1 為 A 分類，C2 為 B 分類，C3 為 C 分類，C4 為 D 分類，C5 為 E 分類，
而假設之機率數據如下表 3 中所列： 
表1 範例機率列表 
 35
3.4.4 產品自動分類方法 
    內容管理所要管理對象為全球化數以萬計的產品分類，因此，本系統選擇
了 UNSPSC 分類標準作為分類的依據，以因應產品分類的需求。然而，UNSPSC
標準雖然解決了本系統中產品分類的困難點，但要將全球各地種類繁雜的產品
歸類到適當的分類中卻也要花費極大的努力。本系統根據 3.4.1 之方法論，希望
能夠根據產品所提供的描述資訊來為產品做最適當的分類，並期望在分類模糊
不清時，能夠找出可能性最高的幾個分類，並使得這幾個分類的聯集包含正確
分類的機率大於某一機率之上。 
    如果在上述試驗中，最大的分類事後機率大於其它分類事後機率甚多，則
供應商可以不考慮其它分類，但若前數名分類的事後機率皆差不多，那麼，供
應商就該仔細的觀看各分類碼之差異，選則他所想要的 UNSPSC 分類碼，甚
至，如果未來的系統允許的話，他也可以一次將一個產品歸為兩類，讓使用者
搜尋這兩分類碼時，皆可搜尋的到此產品。 
 
3.5 資料倉儲架構方法論 
3.5.1 不限定屬性個數之產品資料儲存及搜尋方法 
    在本研究計畫所發展的系統裡，有著大量的產品屬性，而各個分類產品的
屬性並非寫死不變，而是可以動態增加或減少的。在本系統中，每個屬性都歸
於一個 UNSPSC 分類碼下，而本系統規定每個 UNSPSC 分類碼都有自己所屬
的一群屬性，當某個產品被歸到某個 UNSPSC 分類碼中時，則它將可以使用該
UNSPSC 分類碼所屬的任何屬性來描述本身產品。在系統中，系統為每個屬性
做型態分類，型態類別包含了數值形態的屬性和文字形態的屬性兩種。數值形
態的屬性例如硬碟大小，例如：某產品中硬碟屬性的屬性值為 100GB，那麼其
中，100 為數值大小，是可以做範圍式查詢的，GB 為單位，整個數值形態屬性
之屬性值包含了數值及文字兩個部分；而文字型態的屬性則例如精油的療效，
 37
UNSPSCCode
UNSPSCCode Description
43 17 18 01 Notebook
… ...
Attribute
UNSPSCCode AttName NnmberDataFlag UnitClass DefaultUnit
43 17 18 01 CPU N(數值形態) Frequency MHz
43 17 18 01 晶片組 T(文字形態) 0 0
43 17 18 01 主記憶體 N(文字形態) Size MB
43 17 18 01 顯示裝置 T(文字形態) 0 0
43 17 18 01 硬碟大小 N(數值形態) Size GB
43 17 18 01 光碟 T(文字形態) 0 0
43 17 18 01 電池 T(文字形態) 0 0
Proudct
Company ProductID UNSPSCCode
AaaCom 1 43 17 18 01
… … ...
pAttribute
Company ProductID AttName AttUnmber AttValue
AaaCom 1 CPU 800 PIII 800MHz/900MHz/1GHz
AaaCom 1 CPU 900 PIII 800MHz/900MHz/1GHz
AaaCom 1 CPU 1000 PIII 800MHz/900MHz/1GHz
AaaCom 1 晶片組 SIS
AaaCom 1 主記憶體 256 256MB
AaaCom 1 顯示裝置 14.1" LCD
AaaCom 1 硬碟大小 10 10GB
AaaCom 1 光碟 DVD 6X
UnitConvertTable
UnitClassID UnitClass UnitName ToBaseUnit
1 Frequency Hz 1
1 Frequency KHz 1000
1 Frequency MHz 1000000
1 Frequency GHz 1000000000
2 Size B 1
2 Size KB 1000
...
 
圖 18 分類與產品資料關連圖 
    以此一對多的對應方式，將可以無限制的新增分類產品之屬性資料，而不
必像一般的資料庫，將屬性寫死在表格欄位中。另外，如果該產品是組合式的
產品，例如 CPU 可以是 PIII 800MHz/900MHz/1GHz 中任一個，則系統必須要
找出 CPU 的是否為數值形態，如果是，則抓出它的 UnitClass 及 DefaultUnit，
再來就是到 UnitConvertTable 中找出同 UnitClass 的所有單位，在此例中為 Hz、
KHz、MHz、GHz，比對 CPU 的屬性值，分離出數值資料 800、900、1，並將
所有的單位轉成 DefaultUnit，轉完之後數值資料成為 800、900、1000，存入
AttNumbe 中，並在 AttValue 欄位中，全部都填入”PIII 800MHz/900MHz/1GHz”，
上述的作法流程圖如圖 19，而在查詢的時候，系統也必須要將數值形態之屬性
的數值資料分離出來，流程如圖 20 所示，如此作法的好處除了可做範圍式的搜
尋外，不論使用者打入欲搜尋 800Mhz 或 900MHz 或 1GHz，或不論使用者打
入什麼樣的單位 1000MHz 或 1GHz，皆可以找到該筆產品。 
 39
了要達到搜尋的目標，系統必須先將搜尋字串跑過圖 19 的流程，得到”CPU 800 
PIII%” and ” 晶片組  SIS” and “光碟  DVD”，並利用資料庫的交集功能
(Intersect)，將各個條件分開查詢得到結果後，再做交集的動作，所以上述查詢
的 SQL 語法將變成： 
(select distinct Company,ProductID from pAttribute where AttName=’CPU’ and 
AttNumber=800 and AttValue like ’PIII%’)  
intersect 
(select distinct Company,ProductID from pAttribute where AttName=’晶片組’ and 
AttValue like ’SIS’)  
intersect 
(select distinct Company,ProductID from pAttribute where AttName=’光碟’ and 
AttValue like ’DVD’)  
以此 SQL 語法查出的產品，即為我們需要的產品。 
    由以上的作法，缺點是一筆產品資料將會佔用更多的資料庫空間，但此精
準的比對功能，將可節省使用者在找尋產品時更多的時間。 
 
3.5.2 資料正規化方法 
    本系統之資料正規化的目的，在於讓供應商上傳的型錄資料，可以在做搜
尋比對時，有更高的命中機會。例如產品資料”<NAMEVLAUE><NAME>硬碟
</NAME><VLAUE>10/20/40GB </VLAUE></NAMEVLAUE>”，此時，若使用
文字的比對方式，當查詢者輸入”20 GB” or “20GB”，都是找不到的狀態，因為
比 對 字 串 時 ， 並 沒 有 20GB 此 字 串 存 在 ， 若 我 們 將 它 拆 解
成 ”<NAMEVLAUE><NAME> 硬碟 </NAME><VLAUE>10GB /20GB /40GB 
</VLAUE></NAMEVLAUE>”，則當系統查詢資料時，即可找到該筆產品資料。
本系統建立這些規則用於產品資料匯入系統的時候，也等於是事先將資料做整
 41
到這些參數後，將會根據 3.4 節中的方法，將屬性當成關鍵字去算出最有可能
的幾個分類，自動將這些分類的產品拿出比對其屬性及屬性值，最後，整合資
料回應給 Client 端有哪些公司哪些產品符合使用者的描述，並告知這些產品的
產品屬性及屬性值資料，流程如圖 22 所示。 
    於圖 22 中，本系統建置了 Web Services 之伺服器，而 Web Services 的客戶
端，則是欲使用本系統的人或系統，他們只要使用 Web Services 的 Client 端套
件，並根據我們的 WSDL 撰寫程式，不論使用任何作業系統或程式語言，都可
以輕易的跨平台來取得本系統的內容資訊，並可以很容易的將本系統之內容資
料產生報表資料或將資料作後續處理。 
1.
G
et
 W
SD
L 
Fi
le Receive SOAP
Format XML
Response
3.Send SOAP
Format XML
Request
Web Service Server
程式語言選擇
Java C++ .Net Perl VB
Client User
作業系統選擇
Linux Window Solaris UNIX FreeBSD
Content
Management
Kernel
Client
User
2.Write Web Service
Client Software
4.Use The Product
Content To do
Something
 
圖 21 Web Services 內容搜尋方法論架構圖 
資料搜尋
資料整理
資料列表
資料封裝
Company Product Attribute Value
1 1 中央處理器 PIII 800MHz
Memory 256MB
2 1 中央處理器 PIII 800MHz
Memory 256MB
... ... ... ...
1.UNSPSC Code、Attributes、Attribute Values
資料分類
資料搜尋
資料整理
資料列表
資料封裝
Web
Service
Server
XML
Request
XML
Response
Company Product Attribute Value
1 1 中央處理器 PIII 800MHz
Memory 256MB
2 1 中央處理器 PIII 800MHz
Memory 256MB
... ... ... ...
2.Attributes、Attribute Values Web
Service
Client
Web
Service
Server
XML
Request
XML
Response
Web
Service
Client
 
 43
4. 系統細部流程分析與設計 
4.1 系統之角色定義 
    本研究計畫所欲發展的系統，主要有三個角色的參與，分別為系統管理者、
供應商使用者及一般使用者，如表 4 中所列。系統管理者負責整個系統的正常
運作，舉凡供應商的管理、系統參數的維護都是系統管理者的負責範圍；供應
商使用者則為型錄的提供者，他必須要將自家的產品型錄匯出成為標準的 XML
格式，並撰寫 XSLT 檔案，使該公司所提供的型錄可順利的轉換成為本系統中
所採用的功用標準格式(eCX) ，以利本系統型錄資料的匯入及整理。另外本系
統對於 XML 型錄的匯入有兩種管道，第一為 Web 上的檔案上傳，第二為使用
Web Services 來上傳檔案，在後面的章節中會有詳細介紹；第三個角色為一般
使用者，為欲取得本系統型錄內容資料的一般用戶，使用者可利用 Web 的方式
或者 Web Services 的方式來對本系統作查詢。 
表2 系統角色定義 
角色 說明 
系統管理者 系統管理者，負責供應商之管理及各實驗數據之觀察與調整 
供應商使用者 供應商，經由多種管道提供產品型錄供本系統使用 
一般使用者 一般使用者，可經由各種方式取得本系統內所有的產品內容資料 
 45
  Java & Linux 版之示範程式 任何使用者 
 
4.3 系統之軟硬體分析 
4.3.1 系統分析工具 
    本研究計畫所採用的流程分析工具為 Income，此軟體是德國 Promatis 公司
所開發的流程分析工具。該軟體中包含 Process Designer、Knowledge Browser、
Document Center、Monitor、Data Marts、Process Pilot 等；分別提供流程設計與
描述、線上瀏覽、知識管理、流程監督及整合性分析等多項功能，可作為流程
基本結構之分析工具(簡君穎, 2001) 。在本研究中採用 Income 所提供的功能
Process Designer 來對系統之行為模式作分析，希望能夠分析出各功能的行為模
式。 
    Process Designer 是由三個基本元素所構成，分別為活動(Activity) 、物件
(Object) 、連結(Connection) ，用以描述事件發生的流程狀態；圖形中之活動
以長方形表示，代表執行某項作業。物件以圓形表示，代表的是被活動所消耗、
修改、運送、或產生之物體及狀態。連結以直線表示，主要用來連結活動與物
件，其中連接方式有三種，一種為單箭頭代表訊息流，一種為一直線代表資料
唯讀，最後一種為雙箭頭，代表可輸入與輸出資料(Promatis Corporation, 2000) 。 
 
4.3.2 系統硬體相關 
    本系統所採用的硬體配備架構圖資訊如圖 23 所示： 
Windows Client
Linux Client
Data baseJDBC Driver
Web Server
Web Service Server  
 47
Unspsccod 相關表格： 
 分類碼(Unspsccode) ：紀錄著 15190 個分類，及各分類的事前機率及
實驗機率 
 分類碼屬性(AllAttribute) ：各個分類在系統中所有的屬性資訊，而各
個屬性紀錄著該屬性的屬性名稱、是否為數值型屬性及本屬性的預設
單位資料 
 訓練資料(UnspscTrainingLog) ：紀錄系統訓練實驗機率的歷史資料，
資料來源有三種，一為一般使用者做自動分類查詢後，確認分類碼後
所產生的統計資料(TrainingFlag=C) ，二為供應商做型錄上傳後，確
認各產品分類碼後所產生的統計資料(TrainingFlag=S) ，三為由已知分
類碼之產品資料，直接訓練系統所得之統計資料(TrainingFlag=F) 。在
有任何資料進入此表格時，系統會驅動一程式去加權平均歷史機率資
料與新進訓練資料 
 關鍵字(UnspscKeywords) ：存放這個 UNSPSCCode 的關鍵字，以在
各分類碼的試驗中使用 
其它參照表： 
 單位轉換表(UnitConvertTable) ：儲存各單位的轉換公式，以作為單位
轉換的準則 
 國別碼(CountryCode) ：儲存 ISO 標準中的國別碼 
 幣別碼(CurrencyCode) ：儲存 ISO 標準中的幣別碼 
 語言碼(LanguageCode) ：儲存 ISO 標準中的語言碼 
表格間之關連性說明： 
1. 一個公司對應一個公司狀態 
2. 一個公司有數個公司產品 
3. 一個公司產品對應一個分類碼 
4. 一個公司產品有數個產品資訊 
5. 一個分類碼有數個分類碼屬性 
 49
驗機率維護的動作，以下即為各子功能之行為模式分析及說明。 
 
圖 25 系統主流程分析 
 
4.5.1 型錄查詢模組 
    本模組提供一般使用者查詢系統中的型錄資料。一般使用者可以有三種方
式來指定欲查詢之 Unspsccode，一種為手動鍵入，一種是從系統所提供的選單
中做選取，另一種為使用系統自動分類的方式。若使用自動分類，則使用者必
須填入一些關鍵字，交由系統判別出一些較有可能的分類碼，供使用者挑選。
待使用者指定分類碼後，系統會搜尋出該分類碼的屬性，供使用者填寫查詢之
產品條件，而使用者在送出這些條件後，將可以觀看查詢到之結果。 
 
圖26 型錄查詢流程分析 
    在一般使用者查詢型錄資料時，若使用者選擇以自動分類之方式判斷
Unspsccode，則系統必須自動的替使用者判斷出分類碼，判斷的流程如圖 27 所
 51
 
圖 27 分類系統流程分析 
    在使用者做完自動分類後，他可以觀看並決定他所想要的 Unspsccode，而
在使用者做決定的同時，他的決定將變成系統的一筆訓練資料，來更新系統之
各分類碼事前機率及事後機率，步驟如下： 
1. 當只判別一項產品時，抓取在自動分類過程中所有用到的分類碼，包含
Segment、Family、Class 及 Commodity 
2. For each 分類碼{ 
ZXONXP = 最終決定是該分類，而該分類之實驗結果為成功之機率 
ZXONNOTXP=最終決定不是該分類，而該分類之實驗結果成功之機
率 
若使用者決定之 Unspsccode 為 Commodity 層級，則其所有父類別為
確定之同層級決策 
If( 該分類碼實驗成功 and 使用者最終決定為此分類碼 )  
 ZXONXP=1 
Else if( 該分類碼實驗成功 and 使用者最終決定不為此分類碼 )  
 ZXONNOTXP=1 
Else if( 該分類碼實驗失敗 and 使用者最終決定為此分類碼 )  
 ZXONXP=0 
 53
改分類碼資訊後，將型錄資料寫進資料庫中，並更新系統事前機率及實驗機率
資料。 
    型錄編輯頁面：提供給供應商新增、修改及刪除產品資料的界面，並提供
供應商套用屬性資料規則到產品資訊的功能。 
   供應商基本資料編輯功能：提供給供應商修改本身基本資料的功能，一旦供
應商更改了基本資料，則必須等待系統管理者的核可。若系統管理者不核可該
修改資料，則在下次欲編輯基本資料時出現警告。 
 
圖 29 供應商功能流程分析 
 
4.5.3  供應商維護模組 
    本模組提供給系統管理者管理供應商的功能。系統管理者可以新增、查詢、
修改及刪除供應商，並可以對新註冊供應商及修改過基本資料的供應商作核准
與拒絕的動作，系統將透過電子郵件主動告知註冊者或供應商審核結果。 
 55
4.5.5 Web Service 模組 
    本模組提供了 Web Services 的功能，給各個不同作業平台及不同程式語言
之系統呼叫，達成跨系統之功能。 
    圖 32 為 Web Services 部署的流程，系統開法者將開發完成的服務利用工具
(Axis) 來部署，產生 Web Services 的 WSDL 描述檔案，當客戶端拿到此服務之
WSDL 描述文件，即可製作符合 WSDL 中規範的 Web Services 客戶端軟體來
向 Web Services 要求服務，並得到回應。客戶端之程式得到之回傳資料型態亦
定義於 WSDL 檔案中，因此，客戶端程式可以解析該份資料，進而使用該份資
料。 
 
圖 32 Web Services 建置流程分析 
 
    圖 33 為使用自動分類方法來查詢型錄資料的服務。該服務接收欲查詢之屬
性及屬性值，使用自動分類方法來找出最可能之分類碼，並進入資料庫中查詢
所有符合條件的型錄資料，最後包裝成一固定格式回送給客戶端。 
 57
 
圖 35 供應商型錄上傳流程分析 
 
    圖 36 為使用 Windows 作業系統與 VB 程式語言所做出之 Web Services 客
戶端程式。在型錄查詢上，提供了兩種功能讓使用者使用，一種是自動分類查
詢功能，另一種是指定分類碼查詢功能。客戶端將查詢條件送出給服務，則服
務會回傳查詢的結果給使用者。在此程式中會將查詢結果以條列的方式顯示，
並可個別觀察各產品資料；在型錄上傳方面，供應商必須填入公司 ID、密碼，
並手動選擇欲上傳的型錄檔案上傳給服務，該服務即會以 SOAP 格式回傳型錄
上傳的更新結果給客戶端。 
 
圖 36 VB and Windows Web Services 客戶端流程分析 
 59
5. 系統實作 
    本章為系統的實作部分，在各小節將介紹以各個不同身份進入本系統時所
能操作之功能，以下即為功能說明及系統畫面。 
5.1 一般使用者操作 
    一般使用者進入系統時，他在系統左邊的下拉式選單中，將只看到查詢型
錄的功能。使用者在查詢型錄資料時，如果他是已經非常瞭解所欲查詢產品分
類碼的使用者，則可以手動鍵入分類碼；若使用者不知道自己欲查詢的分類碼，
則他可以要求系統列出各分類碼，供使用者選取，如圖 39 所示；或者他也可以
在圖 40 內鍵入他所欲查詢產品的相關資料，要求系統幫他分類，待送出資料
後，系統將會執行分類流程為使用者判斷分類，分類的結果如圖 41 所示，使用
者可以在圖中點選各分類碼，來得知該分類碼的資訊，也可以參考系統替他算
出的事後機率，來找出想要查詢的分類碼，等確定所要查詢類別後，按下圖中
的確定決策來完成分類碼的選取。而在使用者確定分類碼的同時，系統將會將
這次分類實驗的統計資料記錄到資料庫中。 
 
圖 38 型錄查詢畫面 
 61
 
圖 41 自動分類系統結果輸出畫面 
    等使用者確定分類碼時，系統會自行帶出該分類碼的一些屬性，讓使用者
填入一些相關的查詢條件，而其中在”NumOrTex”欄中，若資料為”T”，則代表
這個屬性提供文字型查詢，系統將比對型錄資料是否包含使用者
在”AttributeValue”欄中所填入的值；若資料為”N”，則代表這個屬性提供數值型
查詢，而預設單位為”DefaultUnit”欄中所列，系統將比對型錄資料的數值資料
是否包含於使用者所指定的範圍裡，而其中所指的範圍為使用者所指定的數值
加減使用者所指定的容忍誤差百分比。等使用者填完資料後，送出查詢即可查
到型錄中所有符合之列表資料及個別產品詳細資料，分別如圖 43 及圖 44 所示。 
 
 63
型錄上傳或者是使用 Web Services 來上傳型錄，系統都將會使用此份 XSLT 檔
案來為此這家供應商轉換型錄格式，以讓後續系統處理統一格式的型錄檔案。 
 
圖 45 供應商上傳 XSLT 畫面 
2. 上傳型錄功能：供應商在上傳過 XSLT 檔案後，可上傳本身的型錄檔案。在
Web 化的界面之下，供應商可指定一至多個型錄檔案進行上傳，上傳後系
統將這些檔案轉換成一個 eCX 的檔案，如圖 47 所示，圖的左端會列出所有
供應商所上傳的型錄檔案，右邊則列出轉換格式後之檔案。 
 
圖 46 供應商上傳型錄畫面 
 65
 
圖 49 供應商型錄編輯畫面 
 
圖 50 供應商型錄新增畫面 
4. 供應商基本資料維護功能：供應商可在此更改自己的基本資料，而更改為後
必須等待系統管理者的審核，在審核動作結束之前，此供應商不能再次的修
改基本資料。系統管理者可能會核准或拒絕此次的修改，若是修改的資料遭
拒絕，則在供應商下次維護基本資料時，畫面上會有警示的字樣如圖 51 所
示。 
 67
確認或拒絕此筆資料。核准或拒絕的資訊將會透過電子郵件的方式傳遞給相關
人員查閱。 
 
圖 53 供應商審核畫面 
    系統管理者的另一項工作是實驗數據的維護。他可以在事前機率維護模組
中修改該分類之產品所出現的次數，以增加產品出現的機會，亦即分類之事前
機率。 
 
圖 54 事前機率維護畫面 
    管理者也可以在實驗機率維護模組中直接調整該分類之實驗機率，包含了
『屬於此分類之產品通過此分類實驗之機率』及『非此分類之產品通過此分類
實驗之機率』兩種機率。 
 69
 
圖 57 『供應商使用 Web Services 上傳型錄資料服務』WSDL 畫面 
    圖 58 為一 Web Services 客戶端的範例程式，使用了 Windows 作業平台及
VB6.0 來開發。圖 58 為使用指定 Unspsccode、屬性及屬性值來查詢型錄，畫面
右邊上方是程式所送到 Web Services 端的 SOAP 訊息，右邊下方為 Web Services
端的所回送的 SOAP 格式結果。 
 
圖 58 VB/Window Web Services 客戶端畫面-指定分類碼查詢 
    圖 59 為使用系統自動分類功能的型錄查詢服務，使用者填寫完屬性及屬性
值後送出，即可得到結果。 
 71
 
圖 61 VB/Window Web Services 客戶端畫面-型錄上傳 
    圖62為另一Web Services客戶端的範例程式，使用了Linux作業平台及 Java
來開發。圖 62 為使用指定 Unspsccode、屬性及屬性值來查詢型錄，畫面的下
方為程式將服務回傳之訊息解譯後所呈現之產品資料。 
 
圖 62 Java/Linux Web Services 客戶端畫面-型錄搜尋 
    圖 63 所提供之功能可讓供應商填入公司 ID、公司密碼，程式自動在事先
設定好的目錄中掃瞄有無新進型錄檔案，若有型錄檔案，則使用 Web Services
將檔案上傳給本系統。畫面下方為服務所回傳之型錄匯入成功或失敗訊息。 
 73
類上，分類的效果則沒有那麼好，例如在 Commodity 層，系統有時很難分出使
用者想要找的是 Computer Server 或 Personal Computer，在這個情況下，本貝式
分類方法可能並不完全適用。未來擬採用人工智慧或類神經網路等其它技術來
做補強的動作，希望能夠提升在差異度不高的分類上的分類品質。 
 
5.5.2 案例驗證 
    本研究實際到網際網路上，各領域供應商內蒐集了 100 家公司，500 筆產
品之資料，利用人工的方式去分類產品。待分類完成後，將已知分類之產品資
料經由 3.4.2 之實驗機率分類方法來獲得各分類碼的事前機率及實驗機率，最
後，再用這些事前機率及實驗機率去為新進來或欲查詢的產品做分類。分類的
結果都有不錯的成效，表 6 列出了一些欲搜尋產品類別、輸入的關鍵字及分類
的結果列表，讀者可以觀察出欲查詢的分類皆在結果分類的前幾名中。 
表4 測試分類資料 
 
搜尋產品分類 指定關鍵字 分類結果分類及事後機率 
43211503 
顯示裝置、晶片
組、重量、
CD-ROM、電池 
43211503- 
0.866541 
43212102- 
0.125 
43212104- 
0.125 
43212105- 
0.125 
41112207 
掃描頻率、測量時
間、顯示裝置 
41112207- 
0.645495 
41112201- 
0.071429 
41112202- 
0.071429 
41112203- 
0.071429 
25161507 
前叉、輪圈、煞車
器 
25161507- 
1.000000 
25161501- 
0.111111 
25161502- 
0.111111 
25161503- 
0.111111 
43211503 
顯示裝置、晶片
組、CD-ROM 
43211501- 
0.949394 
43211503- 
0.866541 
43212102- 
0.125000 
43212104- 
0.125000 
70151602 
使用方法、療效、
產地 
70151602- 
1.000000 
70151601- 
0.142857 
70151603- 
0.142857 
70151604- 
0.142857 
 75
6.2 未來展望  
1. 希望能夠連結各 Content Management 平台，達成與國際間的資料互通
與同步更新，來讓台灣的使用者可以觀看到國際間的產品型錄，而其
它國家的用戶也可以觀看到台灣最新的型錄。 
2. 希望能夠讓供應商從型錄管理平台中匯出各式各樣的型錄格式，諸
如：Pdf、Word、Excel、Html 及 Txt 等。 
3. 希望未來的分類系統可以採用一些有數學根據的方法，諸如人工智慧
或類神經網路來讓系統自動分類與學習，更期望後人能提出一些速度
更快且準確度更高的分類方法，來自動判別產品分類。 
4. 現在多語系的解決方案雖都可以解決資料呈現上的問題，但在各語系
間的內容翻譯轉換，仍然都是使用人工處理，希望未來的翻譯系統可
以達成在各語系間的自動翻譯轉換而沒有錯誤。 
5. 目前本系統對於型錄資料的規則化整理還很有限，希望未來的系統能
以專家系統或其它方式，對各領域之資料作自動的整理，以簡化資料
在搜尋時期的困難度。 
6. 希望本系統能具有同義詞庫，可將相同語意之字詞以同一方式儲存，
而在型錄的搜尋時也可透過此同義詞庫，找到更正確的產品。 
7. 另外，本系統尚未考慮型錄的版本控管，希望未來的系統有能力來做
版本的管控及追蹤。 
 
 
 
 
 
 
 77
http://www.ebxml.org/ (2002) 
ebXML Taiwan, 台灣 ebXML 推廣中心, http://www.ebxml.org.tw/ (2003) 
eCX Standard, “eCatalog XML”, http://www.ecx-xml.org/ (2003) 
Fukuda, K., “Institute for Operations Research, ETHZ, and Department of 
Mathematics, EPFL, Switzerland”, 15-16 (2002) 
Goldfarb, G.F., and Prescod, P., “The Xml Handbook”, Pearson Education Publisher 
(2002) 
Grahan, S., “Building Web Services With Java”, Pearson Education Publisher (2002) 
Griffith, D. A., Krampf, R. F., and Palmer, J. W., “The Role of Interface in 
Electronic Commerce: Consumer Involvement with Print versus On-Line 
Catalogs, “ International Journal of Electronic Commerce, 5(4), 135-153 
(2001) 
Guenther, K., “Web Site Management-What is a Web Content management 
Solution?, “ ONLINE-WILTON, 25(4), 81-88 (2001) 
Lausen, G., and Marr, P.J., “Adaptive Evaluation Techniquesfor Querying 
XML-based E-Catalogs, “ Engineering e-Commerce/ e-Business Systems 
(2002)  
Lee, S.M., “Collaborative Service Brokering Model: Utilizing Advertisement and 
Recommendation Approaches”, Advisor: Dr. Chuen-Tasi Sun (1991) 
McQueen, H., “Taste, snack, meal: Content management in three courses,” EContent, 
24(9), 26-31 (2002) 
MSDN Taiwan, “Microsoft MSDN”, http://61.219.235.181/taiwan/ (2003) 
OCF Standard, “Open Catalog Format”, http://www.martsoft.com/ocp/ (2003) 
Pack, T., “Know your customer: InStranet offers innovations in Enterprise-wide 
content management” EContent, 24(9), 56-57 (2001) 
Promatis Corporation, “Income process designer”, http://www.promatis.com/ (2003) 
Requisite Technology Inc., “A Catalog Content management White Paper”, 
http://www.requisite.com (2000) 
RosettaNet Taiwan, “RosettaNet Taiwan”, http://www.rosettanettaiwan.org.tw 
(2003) 
RosettaNet, “RosettaNet”, http://www.rosettanet.org (2003) 
Schmid, J., “The internet/catalog financial model,” Catalog Age, 20(6), 49-53 
(2003) 
Stonebraker, M., and Hellerstein, J. M., “Content Integration for E-Business, 
“ Sigmod Record-Quality Publication of The special Interest Group on 
Management Data, 30, 552-560 (2001) 
UDDI community, “UDDI Version 2.0 Data Structure Specification”, UDDI 
Organization (2001) 
 79
8. 計畫成果自評 
 本研究已達計畫之各個目標。本研究主要整理內容管理領域之 UNSPSC 分
類標準、XML 傳輸及交換標準、ISO 幣別碼……等標準，供應鏈中企業之間的
電子資料交換系統推動研究。本研究與網際網路做結合，搭配網際網路的各項
優點發展出一個彈性之內容管理資料庫，達到動態的描述與管理內容。 
本研究提供供應商處理各領域之產品型錄資料，讓型錄搜尋不再侷限於純
文字型態的檢索，更可以加入數值型態的搜尋達到搜尋型錄之便捷性；供應商
可利用 XML Data Mapping 系統將產品資料轉化成中介型錄資料內容，並發展
出以貝式為基之產品自動分類雛型系統，可以讓使用者快速的找尋其標的產
品；最後再利用 Web Services Server 的建置，讓使用者透過各種不同之程式語
言與本系統溝通，讓內容管理的 Web Services 客戶端不受異質系統不相容之限
制，提供迅速且便利之內容管理服務。本研究各年之重點工作如下所述： 
第一年： 
1. 本階段在發展核心系統，亦即資料的儲存庫，系統必須要設計良好的資料結
構及彈性，以因應多變的環境。 
2. UniCode 研究：以往各國的資訊系統多未整合，各語系的國家紛紛發展自己
所屬語系的字元集，最顯而易見的地方就是當我們打開瀏覽器時，有數十種
的語系可供選擇。而現今為了達到各語系國家資訊系統的互通，不得不發展
一通用的字元集，讓所有語系的所有字元共存於一個環境系統下，UniCode
即為此一目的所發展出之字元集。 並研究各多語系系統現階段的技術，以作
為系統發展之基礎。 
3. 研究系統資料庫設計，因應多變性的產品內容結構。建立產品描述的正規化
條件規則庫，讓供應商的產品資料可以規則化的存入資料庫，以利後續的搜
尋。 
4. 發展一內容分類統計方法以進行自動分類，減少人力的使用，本研究方法將
