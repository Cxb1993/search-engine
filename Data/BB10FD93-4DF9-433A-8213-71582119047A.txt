 1
行政院國家科學委員會專題研究計畫成果報告 
非線性估測理論之探討及其於導航系統之設計 
Investigation of Nonlinear Estimation Theory and the Innovative Designs 
on Navigation Systems 
計畫編號：NSC 96-2221-E-019-007 
執行期限：96 年 8 月 1 日至 97 年 10 月 31 日 
主持人：卓大靖  國立臺灣海洋大學通訊與導航工程學系 
 
 
中文摘要 
應用擴展型卡爾曼濾波器 (extended Kalman 
filter，EKF)於導航訊息處理受到普遍之採用。傳統之擴
展型卡爾曼濾波器之求取系統方程式與量測方程式之
Jacobian 矩陣，使其成為一次佳(suboptimal)之濾波器。
基本上，單純之 GPS 與 GPS/INS 整合導航系統的數學模
型之數學描述應為非線性，若系統數學模型不夠精確或者
存在建模之不確定性時，濾波器則會呈現不穩定行為。非
線性濾波器不採取線性化的方法，不必求取系統方程式與
量測方程式的 Jacobian 矩陣，因此定位精度更高。此外，
使用 EKF 時，掌握精確之系統數學模型以及雜訊之統計
特性，系統狀態向量及量測值雜訊皆為零均值之高斯白雜
訊，方能獲得理想之濾波效果。採用自適應性濾波，利用
觀測數據進行濾波遞推之同時，不斷地由濾波本身去判斷
載體在動態上是否有變化。當判斷有變化時，需進一步決
定將此種變化視為隨機干擾而歸於模型雜訊中，抑或對原
動態模型進行修正，使之掌握並適應目標變化後之動態，
即時估計並調整濾波器內部之系統數學模型與雜訊強
度，可滿足進一步之性能需求。本研究探討了非線性濾
波，並適當地配合自適應性理論，採用了四種方式進行導
航系統設計，依序為： (1) 模糊強跟蹤無跡卡爾曼濾波器
(unscented Kalman filter)於整合導航系統之設計；(2) 中
差分卡爾曼濾波器於 GPS 導航之研究;(3) 灰關聯分析
(grey relational analysis)輔助 H∞ 濾波器於導航系統之
應用，及(4)粒子濾波器(particle filter)之探討及其於導航
系統之設計。 
 
關鍵詞：全球定位系統 (GPS)，慣性導航系統 (INS)，
GPS/INS，強跟蹤，無跡卡爾曼濾波器，模糊邏輯，中差
分卡爾曼濾波器，灰關聯分析，H∞ 濾波器，粒子濾波器 
 
Abstract 
The extended Kalman filter (EKF) has been widely 
applied to the Global Positioning System (GPS) 
navigation processing and GPS/INS (inertial 
navigation system) integrated systems as the navigation 
state estimator. The EKF uses first order Taylor series 
expansion, which can be improved by higher order 
approximations at the expense of computational 
burden. There are several alternatives for the classical 
EKF that can be employed. Recently, there has been an 
increasing interest in the development of techniques for 
nonlinear estimation. Four approaches for improving 
the navigation accuracy are presented: (1) fuzzy strong 
tracking unscented Kalman filter design for integrated 
navigation; (2) GPS navigation processing using the 
quaternion-based divided difference filter; (3) grey 
relational analysis-aided H∞ filtering for GPS 
navigation; (4) particle filter applications for navigation 
system design. 
 
Keywords: Global Positioning System (GPS), Inertial 
Navigation System (INS), GPS/INS, strong tracking, 
unscented Kalman filter, Fuzzy Logic, divided 
difference filter, grey relational analysis, H∞ filter, 
particle filter 
 
一、前言 
While employed in the GPS receiver and the 
GPS/INS integrated navigation systems as the 
navigational state estimator, the extended Kalman filter 
(EKF) has been one of the promising approaches. The 
EKF not only works well in practice, but also it is 
theoretically attractive because it has been shown to be 
the filter that minimizes the variance of the estimation 
mean square error (MSE). Nevertheless, the fact that 
EKF highly depends on a predefined dynamics model 
forms a major drawback. To obtain good estimation 
solutions using the EKF approach, the designers are 
required to have good knowledge on both dynamic 
process (plant dynamics, using an estimated internal 
model of the dynamics of the system) and measurement 
models, in addition to the assumption that both the 
process and measurement are corrupted by zero-mean 
white noises. If the input data does not reflect the real 
model, the estimates may not be reliable. The 
divergence due to modeling errors is a critical problem 
in Kalman filter applications. If the theoretical behavior 
of a filter and its actual behavior do not agree, 
divergence may occur. A conventional Kalman filter 
fails ensure error convergence due to limited 
knowledge of the system’s dynamic model and 
measurement noise. If the Kalman filter is provided 
with information that the process behaves a certain way, 
whereas, in fact, it behaves a different way, the filter 
will continually intend to fit an incorrect process signal. 
In the GPS navigation filter design, there exists 
model uncertainties which cannot be expressed by the 
linear state-space model. It is in fact very often the case 
that little a priori knowledge is available concerning the 
 3
estimation smoothness. Traditional approach for 
determining the softening factors heavily relies on 
personal experience or computer simulation using a 
heuristic searching scheme. To resolve the shortcoming, 
a new approach called the fuzzy strong tracking 
unscented Kalman filter (FSTUKF) is suggested. The 
fuzzy logic reasoning system (Sasiadek, et al. 2000) 
based on the Takagi-Sugeno (T-S) model (Takagi and 
Sugeno 1985) is incorporated into the STUKF. The 
fuzzy reasoning system is constructed for obtaining 
suitable softening factors according to the time-varying 
change in dynamics. By monitoring the innovation 
information, the FLAS (which is the filter’s internal 
mode) is employed for dynamically adjusting the 
softening factors based on the fuzzy rules so as to 
enhance the estimation accuracy and tracking capability. 
The example on tightly-coupled GPS/INS integrated 
navigation processing based on the FSTUKF will be 
presented. Performance comparison will be 
demonstrated using the proposed FSTUKF method as 
compared to the EKF, UKF, and STUKF approaches. 
The divided difference filter (DDF), also called the 
central difference filter (CDF), adopts an alternative 
linearization method called a central difference 
approximation (Nørgaard et al. 2000a, 2000b; Saulson et 
al. 2004) in which derivatives are replaced by functional 
evaluations, and an easy expansion of the nonlinear 
functions to higher order terms is possible. The DDF is 
based on a multivariable extension of Stirling’s 
interpolation formula. Both the DDF and UKF are 
considered to be among the class of linear regression 
Kalman filters. Both filters generate a finite number 
points about the mean based on varying the covariance 
matrix along each dimension. Two common types of 
DDFs, based on the Stirling’s interpolation 1st and 2nd 
order, have been the divided difference filter 1st order 
(DDF1) and the divided difference filter 2nd order 
(DDF2). One of the particularly useful ideas presented 
in Schei (1997) that directly update the Cholesky factors 
of the covariance matrices can be used in DDF. It has 
been reported that the DDF performs a better 
covariance estimate than the UKF by approximating the 
covariance based on prior covariance as opposed to 
depending on the covariance of the set of sampled 
points (Nørgaard et al. 2000a, 2000b; Saulson et al. 2004).  
The quaternion approach (Farrell and Barth 1999) 
is an important tool to describe the orientation of a 
vehicle introduced by Hamilton (1844, 1847) in the 
mid-nineteenth century as an extension of complex 
numbers and as a tool for manipulating 3-dimensional 
vectors. A quaternion needs four variables to represent 
a single rotation. Euler angles sometimes create the 
singularity problems. There are several advantages 
using the quaternion approach. A quaternion is 
computationally efficient than the Euler angles since 
computation of trigonometric equations is not required. 
Due the above mentioned considerations, the 
quaternion-based DDF will be conduced for processing 
the GPS navigation. The effectiveness of the proposed 
strategy will be investigated.  
The implementation of Kalman filter requires the 
a priori knowledge of both the process and 
measurement models. One of the robust filtering 
approaches has been focused on the H∞ estimations 
methods (Shaked and Theodor, 1992; Shen and Deng, 
1995, 1997). Kalman and H∞ filters have similar 
observer structure. Differing from traditional Kalman 
filtering approach, the robust H∞ estimator guarantees 
that a H∞ norm is less then a prescribed positive value 
so that the estimation error won’t exceed the 
pre-specified boundary. It is important to note that the 
optimal H∞ filter depends on the weighting matrices on 
the estimation error in the performance criterion, i.e., 
the designer must chose the weighting matrices based 
on the performance requirements, whereas the Kalman 
filter are dependent on the variance of the noise. The 
designers are not required a priori knowledge of the 
noise source statistics and the H∞ filter will attempt to 
minimize the worst possible effects of disturbances due 
to the modelling errors and measurement noise. The H∞ 
filter is employed to ensure that the energy gain from 
the disturbances to the estimation error is less than a 
pre-specified level. Based on the H∞ filtering approach, 
the robustness is significantly improved as compared to 
the conventional Kalman filtering algorithm. 
The H∞ filter is a stable filter that ensures the H∞ 
norm from the disturbances to the estimation error is 
bounded by a specified positive value. The task of the 
H∞ filter is to search the optimal estimate among all 
possible ones such that the worst-case performance 
measure should satisfy the requirement: γ≤Jsup , where 
“sup” stands for supremum and γ  is a prescribed 
level of noise attenuation, i.e., the estimator guarantees 
the smallest estimation error over all possible 
disturbances of finite energy. In the case that parameter 
∞→γ , the H∞ filter will emerge to the Kalman filter.  
The system with partial unknown structure, 
parameters, and characteristics is called a grey system 
(Deng, 1998). The grey system theory can be employed 
to improve the navigation accuracy performance 
without sufficient information or with highly nonlinear 
property. The proposition of grey theory occurring in 
the 1990 to 1999 time period resulted in the uses of grey 
theory to each field. The major advantage of grey 
theory is that it can handle both incomplete information 
and unclear problems very precisely. The grey 
relational analysis is a similarity measure for finite 
sequences with incomplete information. As long as the 
necessary data sequences are available, grey relational 
analysis can be used to determine the relational grades 
between the reference sequence and the comparative 
ones. Accordingly, the best comparative sequence can 
be found by further analyzing the resultant relational 
grades.  
The grey relational analysis uses information from 
the grey system to dynamically compare each factor 
 5
matrix to get state correction vector and update state 
vector:  
)]ˆ([ˆˆ −− −+= kkkkkk xhzKxx             (10) 
- Update error covariance 
[ ] −−= kkkk PHKIP               (11) 
B. Time update equations: 
- Predict new state vector and state covariance matrix  
)ˆ(ˆ 11
−
−−
− = kkk xfx                 (12) 
kkkkk QΦPΦP
T +=−+1              (13) 
where the linear approximation equations for system 
and measurement matrices are obtained through the 
relations 
−=∂
∂≈
k
k
k
xxx
f
Φ
ˆ
; 
−=∂
∂≈
k
k
k
xxx
hH
ˆ
         (14) 
In the EKF, the state distribution is approximated by a 
Gaussian random variable (GRV), which is then 
propagated analytically through the first-order 
linearization of the nonlinear system. Wan and van der 
Merwe (2000) pointed out that this will introduce large 
errors in the true posterior mean and covariance of the 
transformed GRV and lead to suboptimal performance 
and sometimes filter divergence. Further detailed 
discussion can be referred to Brown and Hwang (1997), 
Farrell and Barth (1999), and Gelb (1974). 
 
(一) 模糊強跟蹤無跡卡爾曼濾波器(unscented Kalman 
filter)於整合導航系統之設計 
 
Unscented Kalman Filter. The unscented Kalman filter 
(UKF) was first proposed by Julier, et al. (1995) to 
address nonlinear state estimation in the context of 
control theory. The UKF addresses this problem by 
using a deterministic sampling approach. The state 
distribution is also approximated by a GRV, but is 
represented using a minimal set of sample points. 
These sample points are carefully chosen so as to 
completely capture the true mean and covariance of the 
GRV. When the sample points are propagated through 
the true nonlinear system, the posterior mean and 
covariance can be captured accurately to the 3rd order 
of Taylor series expansion for any nonlinear system. 
One of the remarkable merits is that the overall 
computational complexity of the UKF is the same as 
that of the EKF (Wan and van der Merwe 2000). 
The first step in the UKF is to sample the prior 
state distribution, i.e., generate the sigma points 
through the unscented transformation (UT) (Julier, et al. 
2000; Julier, 2002; Julier and Uhlmann 2002). The 
unscented transform is a method for calculating the 
statistics of a random variable which undergoes a 
nonlinear transformation. The basic premise is that to 
approximate a probability distribution is easier than to 
approximate an arbitrary nonlinear transformation. A 
set of weighted samples or sigma points are 
deterministically chosen so that they completely 
capture the true mean and covariance of the random 
variable. The samples are propagated through true 
nonlinear equations, and the linearization of the model 
is not necessary. 
Suppose the mean x  and covariance P  of 
vector x  are known, a set of deterministic vector 
called sigma points can then be found. The ensemble 
mean and covariance of the sigma points are equal to 
x  and P . The nonlinear function (x)y f=  is applied 
to each deterministic vector to obtain transformed 
vectors. The ensemble mean and covariance of the 
transformed vectors will give a good estimate of the 
true mean and covariance of y , which is the key to the 
unscented transformation. Figure 1 illustrates the 
mapping of the UKF versus that of the EKF, through 
the transformation of: (1) the nonlinear function )(⋅f , 
shown on the top portion of the figure, and (2) its 
Jacobian F , shown at the bottom portion of the figure. 
The dot-line ellipse represents the true covariance; the 
solid-line ellipse represents the calculated covariance. 
The UKF approach estimates are expected to be closer 
to the true values than the EKF approach. 
 
Figure 1. Illustration of properties of UKF and EKF (Li 
et al. 2006). 
 
Consider an n  dimensional random variable x , 
having the mean xˆ  and covariance P , and suppose 
that it propagates through an arbitrary nonlinear 
function f . The unscented transform creates 12 +n  
sigma vectors X  (a capital letter) and weighted points 
W , given by 
xX ˆ)0( =                 (15) 
T
ii λn ))((ˆ)( PxX ++= , ,...,ni 1=        (16) 
T
ini λn ))((ˆ)( PxX +−=+ , ,...,ni 1=        (17) 
)(0 λn
λW (m) +=                 (18) 
)1( 200 βαWW
(m)(c) +−+=            (19) 
)(2
1
λn
WW (c)i
(m)
i +== , n,...,i 21=        (20) 
where iλn ))P(( +  is the i th row (or column) of the 
matrix square root. )P( λn +  can be obtained from the 
lower-triangular matrix of the Cholesky factorization; 
nknαλ −+= )(2  is a scaling parameter; α  determines 
the spread of the sigma points around x)  and is 
usually set to a small positive (e.g., 110*1 4 ≤≤− α ); k  is 
a secondly scaling parameter (usually set as 0); β  is 
 7
deteriorates to a STUKF based on a single fading factor. 
The range of the forgetting factor is 10 ≤< ρ . The 
softening factor ε  is utilized to improve the 
smoothness of state estimation. A larger ε (with value 
no less than 1) leads to better estimation accuracy; 
while a smaller ε  provides stronger tracking capability. 
The value is usually determined empirically through 
computer simulation and 51 ≤≤ ε  is commonly 
selected (Zhou and Frank, 1996). 
 
The Fuzzy Logic Adaptive System (FLAS). Fuzzy logic 
was first developed by Zadeh in the mid-1960s for 
representing uncertain and imprecise knowledge. It 
provides an approximate but effective means of 
describing the behavior of systems that are too complex, 
ill-defined, or not easily analyzed mathematically. A 
typical fuzzy system consists of three components, that 
is, fuzzification, fuzzy reasoning (fuzzy inference), and 
fuzzy defuzzification, as shown in Figure 2. The 
fuzzification process converts a crisp input value to a 
fuzzy value, the fuzzy inference is responsible for 
drawing calculations from the knowledge base, and the 
fuzzy defuzzification process converts the fuzzy actions 
into a crisp action. 
 
 
Figure 2. A fuzzy system. 
 
The fuzzification modules: (1) transforms the error 
signal into a normalized fuzzy subset consisting of a 
subset for the range of the input values and a 
normalized membership function describing the degree 
of confidence of the input belonging to this range; (2) 
selects reasonable and good, ideally optimal, 
membership functions under certain convenient criteria 
meaningful to the application. The characteristics of the 
fuzzy adaptive system depend on the fuzzy rules and 
the effectiveness of the rules directly influences its 
performance. The defuzzification is used to provide the 
deterministic values of a membership function for the 
output. Using fuzzy logic to infer the consequent of a 
set of fuzzy production rules invariably leads to fuzzy 
output subsets. 
Fuzzy modeling is the method of describing the 
characteristics of a system using fuzzy inference rules. 
In this paper, a Takagi-Sugeno (T-S) fuzzy system is 
used to detect the divergence of EKF and adapt the 
filter. A typical rule in the T-S model has the form: 
IF Input 1x  is 11F  and Input 2x  is 12F  …and Input 
nx  is 1nF  
THEN Output 
nknkknkk xCxCCxxxfy +++== LK 11021 ),,,( . 
where )~0( niCki = are constants in the k -th rule. For 
the first-order model, we have the rule in the form: 
IF Input 1x  is 11F  and Input 2x  is 12F  
THEN Output 21211110 xCxCCyk ++= . 
where 11F  and 12F  are fuzzy sets and 10C , 11C  and 
12C  are constants. For a zero-order model, the output 
level is a constant:  
IF Input 1x  is 11F  and Input 2x  is 12F  THEN 
Output 10Cyk = . 
The output is the weighted average of the ky : 
∑ ⋅=
=
M
k
kk ywy
1
                (41) 
where the weights kw  are computer as 
∑ ∏
∏
=
= =
=
M
j
ij
iF
n
i
ik
iF
n
i
k
x
x
w
1 1
1
)]([
)(
μ
μ
             (42) 
with ∑ =
=
M
i
iw
1
1 ,and the μ ’s represent the membership 
functions. 
 
Fuzzy Strong Tracking Unscented Kalman Filter. The 
degree of divergence (DOD) parameters for identifying 
the degree of change in vehicle dynamics need to be 
defined. Examples for possible approaches are given as 
follows. The innovation information at the present 
epoch is employed for timely reflect the change in 
vehicle dynamics. The DOD parameter ξ  can be 
defined as the trace of innovation covariance matrix at 
present epoch (i.e., the window size is one) divided by 
the number of satellites employed for navigation 
processing: 
m
kk υυ
T
=ξ                   (43) 
where Tmk υυυ ][ 21 L=υ , m  is the number of 
measurements (number of satellites).  Furthermore, 
the averaged magnitude of innovation at the present 
epoch can also be used: 
∑=
=
m
i
iυm 1
||1ζ                (44) 
In the FLAS, the DOD parameters are employed as the 
inputs for the fuzzy inference engines. By monitoring 
the DOD parameters, the FLAS is able to on-line tune 
the softening factor according to the fuzzy rules. For 
this reason, this scheme can adjust the fading factors 
adaptively and therefore improves estimation 
performance. When the softening factor is smaller, the 
tracking capability of STUKF is better; while the 
softening factor is larger, the tracking accuracy of 
STUKF is improved. The FLAS is employed to tune the 
softening factor according to the innovation 
Membership functions 
Rule base 
Fuzzification Fuzzy inference Defuzzification
 9
matrices containing first order DDs are 
}2/)],ˆˆ(),ˆˆ({[})({)( ,,),(
)1(
ˆ
)1(
ˆ hhhkk kjxkikjxkijixxxx wsxfwsxfSS −−+=≡
         (46a) 
}2/)],ˆ(),ˆ({[})({)( ,,),(
)1()1( hhhkk jvkkijvkkijixwxw swxfswxfSS −−+=≡
         (46b) 
}2/)],(),({[})({)( ,,),(
)1()1( hhhkk kjxkikjxkijixzxz vsxgvsxgSS −−+=≡
         (46c) 
}2/)],ˆ(),ˆ({[})({)( ,,),(
)1()1( hhhkk jvkkijvkkijizvzv svxgsvxgSS −−+=≡
         (46d) 
where h  represents the chosen step size,  jx,s  
denotes the j-th column of xS and likewise for the other 
factors. DD1 filter and DD2 filter algorithm equations 
are summarized as follows. 
(A) DD1 filter algorithm equations 
- Initialization: ox , )0(xS  
- Measurement update 
(1) Divided differences: )()1( kzxS , )()1( kzvS  
(2) The predicted measurement (output prediction 
value):  
),( kkk vxgz =            (47) 
(3) Cholesky factor of the covariance of the output 
estimation error: 
  ])()([)( )1()1( kkk zvxzz SSS =            (48) 
(4) The a posteriori cross-covariance: 
 Txzxxz kkk )]()[()( )1(SSP =            (49) 
(5) Kalman gain:  
1])()()[( −= Tzzxzk kkk SSPK          (50) 
(6) The a posteriori state:  
)(ˆ kkkkk zzKxx −+=            (51) 
(7) The a posteriori covariance:  
])()([)(ˆ )1()1( kkk zvkxzkxx SKSKSS −=       (52) 
where the updated covariance is obtained by the 
update of the square Cholesky factors.  
- Time update 
(8) Divided differences: )()1( ˆ kxxS , )(
)1( kxwS  
(9) The a priori state (the predicted state equation) 
),ˆ()(
~
1 kkkk wxfzfx =≈+            (53) 
(10) The a priori covariance (covariance of the state 
prediction error)  
])()([)1( )1()1( ˆ kkk xwxxx SSS =+          (54) 
Figure 4 provides the DD1 filter loop.  
(B) DD2 filter algorithm equations 
The DD2 filter makes use of both the first and second 
order central differences to approximate nonlinear 
transformation of the state and covariance. The 
matrices of second order DDs are defined as 
[ ]
⎪⎭
⎪⎬
⎫
⎪⎩
⎪⎨
⎧
−−++−=≡ ),ˆ(2),ˆˆ(),ˆˆ(
2
1})({)( ,,2
2
),(
)2(
ˆ
)2(
ˆ kkikjxkikjxkijixxxx hhh
hkk wxfwsxfwsxfSS  
(55a) 
[ ]
⎪⎭
⎪⎬
⎫
⎪⎩
⎪⎨
⎧
−−++−=≡ ),ˆ(2),ˆ(),ˆ(
2
1})({)( ,,2
2
),(
)2()2(
kkijvkkijvkkijixwxw hhh
hkk wxfswxfswxfSS  
(55b) 
[ ]
⎪⎭
⎪⎬
⎫
⎪⎩
⎪⎨
⎧
−−++−=≡ ),(2),(),(
2
1})({)( ,,2
2
),(
)2()2(
kkikjxkikjxkijixzxz hhh
hkk vxgvsxgvsxgSS  
(55c) 
[ ]
⎪⎭
⎪⎬
⎫
⎪⎩
⎪⎨
⎧
−−++−=≡ ),(2),ˆ(),ˆ(
2
1})({)( ,,2
2
),(
)2()2(
kkijvkkijvkkijizvzv hhh
hkk vxgsvxgsvxgSS  
(55d) 
- Initialization: ox , )0(xS  
- Measurement update/correction 
(1) Divided differences: )()1( kzxS , )()1( kzvS , )()2( kzxS , )()2( kzvS  
(2) The predicted measurement (output prediction 
value): 
),()( 2
2
kk
vx
k h
nnh vxgz +−=  
∑ −+++
=
xn
p
kpxkkpxk hhh 1 ,,2
),(),(
2
1 vsxgvsxg  
∑ ++++
=
vn
p
pvkkpvkk hhh 1 ,,2
),(),(
2
1 svxgsvxg        (56) 
where vn denotes the dimension of the measurement 
noise vector. 
(3) Cholesky factor of the covariance of the output 
estimation error: 
 ])()()()([)( )2()2()1()1( kkkkk zvxzzvxzz SSSSS =    (57) 
(4) The a posteriori cross-covariance:  
T
xzxxz kkk )]()[()(
)1(SSP =  
(5) Kalman gain: 1)]()()[( −= kkk zzxzk SSPK  
(6) The a posteriori state: )(ˆ kkkkk zzKxx −+=  
(7) The a posteriori covariance: 
])()()()()([)(ˆ )2()2()1()1( kkkkkk zvkzxkzvkzxkxx SKSKSKSKSS −=          
(58) 
- Time update/prediction 
(8) Divided differences: )()1( ˆ kxxS , )(
)1( kxwS , )()2( ˆ kxxS , )(
)2( kxwS  
(9) The a priori state (the predicted state equation) 
),ˆ()( 2
2
1 kk
wx
k h
nnh wxfx +−=+  
∑ −+++
=
xn
p
kpxkkpxk hhh 1 ,,2
),ˆ(),ˆ(
2
1 wsxfwsxf  
∑ −+++
=
wn
p
pwkkpwkk hhh 1 ,,2
),ˆ(),ˆ(
2
1 swxfswxf  (59) 
(10) The a priori covariance (covariance of the state 
prediction error) 
 11
⎥⎥
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢⎢
⎢
⎣
⎡
−−−
−
−
−
=Ω
0
0
0
0
)(
rqp
rpq
qpr
pqr
b
nbω             (63) 
The quaternion-based equation of motion is discussed 
as follows. The rotation matrix nbC  in terms of the unit 
quaternion parameters can be written as 
⎥⎥
⎥⎥
⎦
⎤
⎢⎢
⎢⎢
⎣
⎡
−−++−
−−−++
+−−−+
=
2
2
2
1
2
3
2
010322031
1032
2
3
2
2
2
1
2
03021
20313021
2
3
2
2
2
1
2
0
)(2)(2
)(2)(2
)(2)(2
qqqqqqqqqqqq
qqqqqqqqqqqq
qqqqqqqqqqqq
n
bC  
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢
⎣
⎡
⎥⎥
⎥⎥
⎦
⎤
⎢⎢
⎢⎢
⎣
⎡
−−++−
−−−++
+−−−+
=
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢
⎣
⎡
=
b
b
b
w
v
u
qqqqqqqqqqqq
qqqqqqqqqqqq
qqqqqqqqqqqq
z
y
x
2
2
2
1
2
3
2
010322031
1032
2
3
2
2
2
1
2
03021
20313021
2
3
2
2
2
1
2
0
)(2)(2
)(2)(2
)(2)(2
&
&
&
V
    (64) 
where bu , bv , and bw  represent the velocity 
components in the x, y, and z directions of body frame 
coordinates, 30 ~ qq are the quaternions. In case the 
velocity in the x-component is considered, 
Viubb ≈≈ ||||||||
r
V , the model can be simplified. The 
simplified quaternion-based nonlinear vehicle dynamic 
model is given by  
)( 23
2
2
2
1
2
0 qqqqVx −−+=&  
)(2 3021 qqqqVy +=&               (65) 
)(2 2031 qqqqVz −=&  
The dynamic model governed by Eq. (65) with additive 
noise is represented by the 113×  vector: 
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢
⎣
⎡
+
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢
⎣
⎡
−
+
−−+
++−
−+
+−
−−−
−
−
−
=
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢
⎣
⎡
=
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢
⎣
⎡
13
12
11
10
9
8
7
6
5
4
3
2
1
2031
3021
2
3
2
2
2
1
2
0
012
103
230
321
13
12
11
10
9
8
7
6
5
4
3
2
1
3
2
1
0
0
0
)(2
)(2
)(
)(
2
1
)(
2
1
)(
2
1
)(
2
1
1
1
1
u
u
u
u
u
u
u
u
u
u
u
u
u
d
qqqqV
qqqqV
qqqqV
rqqqpq
rqqqpq
rqqqpq
rqqqpq
r
q
p
x
x
x
x
x
x
x
x
x
x
x
x
x
d
b
V
z
y
x
q
q
q
q
r
q
p
τ
τ
τ
&
&
&
&
&
&
&
&
&
&
&
&
&
&
&
&
&
&
&
&
&
&
&
&
&
&
       (66) 
where 31 ~ xx  represent the three angular velocity 
components; 74 ~ xx  represent the quaternions; 108 ~ xx  
represent the positions; 11x represents the vehicle 
velocity in the x-component (i.e., longitudinal ) of body 
frame; and 12x and 13x  represent the receiver clock 
offset and drift errors, respectively. 
The system matrix F  for the quaternion based 
dynamic equation is given by 
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎦
⎤
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎣
⎡
−−−
+
−−+−−
−−
−−
−−
−−−−−−
−
−
−
=∂
∂=
0000000000000
1000000000000
0000000000000
00)(20002222000
00)(20002222000
000002222000
0000000
222222
000000
2
0
22222
000000
22
0
2222
000000
222
0
222
0000000000100
0000000000010
0000000000001
20311032
30210123
2
3
2
2
2
1
2
03210
012
103
230
321
qqqqVqVqVqVq
qqqqVqVqVqVq
qqqqVqVqVqVq
pqrqqq
prqqqq
qrpqqq
rqpqqq
τ
τ
τ
x
fF
(67) 
The process noise covariance matrix for this nonlinear 
model is given by the form 
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢
⎣
⎡
=
13131312
12131212
1111
1010
99
88
77
66
55
44
33
22
11
qq
qq
q
q
q
q
q
q
q
q
q
q
q
kQ
  (68) 
in which the iiq  are set to be constants, 111K=i ; 
2
3
1212
tStSq gf
Δ+Δ= ; 
2
2
13121213
tSqq g
Δ== ; tSq gΔ=1313 . 
The states and the measurements are related 
nonlinearly. The pseudorange equation can be 
linearized by expanding Taylor’s series around the 
approximate (or nominal) user position )ˆ,ˆ,ˆ( nnn zyx  and 
neglecting the higher terms. Assuming that only the 
pseudorange observables are available, the linearized 
measurement equation based on n  visible satellites for 
this nonlinear model is given by:  
⎥⎥
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢⎢
⎢
⎣
⎡
+
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢
⎣
⎡
⎥⎥
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢⎢
⎢
⎣
⎡
+
⎥⎥
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢⎢
⎢
⎣
⎡
=
⎥⎥
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢⎢
⎢
⎣
⎡
nzyx
zyx
zyx
nn v
v
v
x
x
x
x
x
x
x
x
x
x
x
x
x
ggg
ggg
ggg
ρ
ρ
ρ
ρ
ρ
ρ
ρ
ρ
ρ
MMMMMMMMMMMMMMMM
2
1
13
12
11
10
9
8
7
6
5
4
3
2
1
)3()3()3(
)2()2()2(
)1()1()1(
2
1
2
1
0100000000
0100000000
0100000000
ˆ
ˆ
ˆ  (69) 
where the elements of the measurement model kG  are 
the partial derivatives of the predicted measurements 
with respect to each state, which is an ( 13×n ) matrix.  
⎥⎥
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢⎢
⎢
⎣
⎡
=∂
∂=
0100000000
0100000000
0100000000
)3()3()3(
)2()2()2(
)1()1()1(
zyx
zyx
zyx
k
ggg
ggg
ggg
MMMMMMMMMMMMMx
gG  (70) 
 13
specific elements of the state vector, kQ  matrix should 
be defined accordingly. 
The H∞ filter is a stable filter that ensures the H∞ 
norm from the disturbances to the estimation error 
( kk zz ˆ− ) is bounded by a specified positive value. The 
task of the H∞ filter is to search kzˆ  such that the 
optimal estimate of kz  among all possible kzˆ  (i.e., 
the worst-case performance measure) should satisfy the 
requirement: 
                 γ≤Jsup                   (76) 
where “sup” stands for supremum and γ  is a 
prescribed level of noise attenuation, i.e., the estimator 
guarantees the smallest estimation error over all 
possible disturbances of finite energy. In the H∞ 
filtering algorithm, both kw  and kv  are not necessary 
to be white or coloured Gaussian process. 
In the dynamic, two-person game, the discrete H∞ 
filtering can be interpreted as a minimax problem 
where the estimator provides estimation of kz , i.e., kzˆ . 
kzˆ  plays a role that against the exogenous noise inputs 
kw and kv , and the initial state 0x . Therefore, the 
performance criterion can be defined as 
∑ +−−⋅+
−−=
= −−
−
N
k k
k
k
kkkk
kkk
J
0
2
1
2
1
2
2
1
0
00
)0,,(ˆ
)]||||||(||||ˆ[||
2
1
||ˆ||
2
maxmin
VWQ
p
xvwz
vwzz
xx
γ
γ  (77) 
where “min” standards for minimization and “max” 
standards for maximization. The H∞ filtering deals with 
deterministic disturbance and no a priori knowledge of 
the noise statistics is required. 
Since measurement value ks  is given, kv  can 
be determined once the optimal values of kw  and 0x  
are found. By use of kk Lxz =  and kk xLz ˆˆ = , the 
performance criterion/cost function can be rewritten as 
∑ −+−−⋅
+−−=
= −−
−
N
k k
kk
k
kkkk
kkk
J
0
2
1
2
1
2
2
1
0
00
)0,,(ˆ
)]||||||(||||ˆ[||
2
1
||ˆ||
2
maxmin
VWQ
p
xswz
Hxswxx
xx
γ
γ   
(78) 
where LQLQ kk T= . 
The value of the game is the value of the cost 
function.  
∗∗∗∗∗ = JJ kkk ),,,ˆ( 0xwsx            (79) 
where ∗J  is the game value. The optimal strategies 
for kxˆ , ks , kw  and 0x  are ∗kxˆ , ∗ks , ∗kw  and ∗0x , 
which can be substituted into Eq. (79) to yield 
0xwsx =∗∗∗∗ ),,,ˆ( 0kkkJ               (80) 
which gives a zero value game. ∗kxˆ , ∗ks , ∗kw  and ∗0x  
are the saddle-point solution, and represent the optimal 
strategies. If the strategies also satisfy a saddle-point 
inequality, they represent optimal strategies. A saddle 
point strategy is obtained by solving two optimisation 
problems: 
∗= J
kkk 0ˆ
maxmaxmaxmin
xwsx
             (81) 
∗= J
kkk xxws ˆ0
minmaxmaxmax              (82) 
If ∗∗ = JJ , the solution to Eqs. (81) and (82) produce 
the saddle-point strategies. These values also satisfy a 
saddle-point inequality 
),,,ˆ(),,,ˆ(),,,ˆ( 000
∗∗∗∗∗∗∗∗ ≤≤ xwsxxwsxxwsx kkkkkkkkk JJJ  (83) 
The optimal strategy of the measurement noise can be 
obtained by 
0xHsv =−= ∗∗∗ kkkk ˆ                (84) 
Let 0>γ  be a prescribed level of noise attenuation. 
There exists an H∞ for kz if and only if there exist 
stabilizing symmetric solution 0>kP  to the 
corresponding discrete-time Riccati equation, the 
optimal H∞ filter that forces γ≤Jsup  is given as 
follows: 
∗∗ = kk xLz ˆˆ , Nk ,,1,0 L=            (85) 
where 
)]ˆ[ˆˆ 1
∗∗∗
+ −+= kkkHkkk xHsKxΦx , 00ˆ xx =       (86) 
The H∞ filter gain and covariance are computed 
through 
1T11T1 ][ −−−− +−= kkkkkkkkkkH VHPHVHPQIPΦK γ     (87) 
kkkkkkkkkkk WΦPHVHPQIPΦP ++−= −−−+ T11T11 ][ γ ; 00 pP = (88) 
Eq. (88) is the discrete-time Riccati equation (sometimes 
also called the Riccati difference equation). If the 
solution of kP  to Eq. (88) exists ],0[ Nk∈∀ , then 
0>kP ],0[ Nk∈∀ . Like the Kalman filtering problems, 
the H∞ filtering problems are associated with 
corresponding steady-state problems. In the 
steady-state version, the corresponding Riccati 
equations are algebraic and the filters’ covariance 
matrices and gains become constant. In the case that 
parameter ∞→γ , the H∞ filter will emerge to the 
Kalman filter. The algorithm can now be summarized. 
Let 0>γ  be a prescribed level of noise attenuation, 
there then exists an H∞ filter for kz  if and only if there 
exists a stabilizing symmetric solution 0>kP  to the 
discrete-time Riccati equation, and the optimal H∞ 
filtering algorithm is given by Eqs. (85-88). Figure 5 
shows the system architecture for the GPS navigation 
solutions using the H∞ filtering algorithm. 
 
 15
 
 
 
 
 
 
 
 
 
 
 
 
Reference 
GPS 
pseudorange 
xˆ
kz  
γ  −− kk zz ˆ
+ 
- 
Measurement prediction 
)ˆ(ˆ −− = kk xhz  
GRA 
GRA-aided H∞ filter loop 
H∞ filter 
 
Figure 7. GPS navigation processing using the 
GRA-aided  H∞ filter. 
 
The innovation sequence information is utilized for 
deriving the grey relational coefficient. From the 
incoming measurement kz  and the optimal prediction 
−
kxˆ  obtained in the previous step, the innovations 
sequence is defined as 
−−= kkk zzυ ˆ                  (94) 
The innovation represents the additional information 
available to the filter as a consequence of the new 
observation kz . Innovation information is employed as 
the GRA. The parameters for identifying the degree of 
change in vehicle dynamics need to be defined. 
Examples for possible approaches are given as follows. 
The innovation information at the present epoch is 
employed for timely reflecting the change in vehicle 
dynamics. The parameter ξ  can be defined as the 
trace of innovation covariance matrix at present epoch 
(i.e., the window size is one) divided by the number of 
satellites employed for navigation processing: 
m
kk υυ
T
=ξ                   (95) 
where Tmk υυυ ][ 21 L=υ , m  is the number of 
measurements (number of satellites).  Furthermore, 
the averaged magnitude of innovation at the present 
epoch can also be used: 
∑=
=
m
i
iυm 1
||1ζ                 (96) 
By monitoring the parameters, the GRA is able to 
performing on-line tuning of γ  in the H∞ filter. 
Information flow for determination of γ  through the 
GRA is shown in Figure 8. 
 
[ ]Tiii ξζ=χ  
where 
∑=
=
m
i
iυm 1
||1ζ ; 
m
kk υυ
T
=ξ  
kz
GRA 
)ˆ(ˆ −− = kk xhz  
γ  
−−= kkk zzυ ˆ  
 
Figure 8. Information flow for determination of γ  
through the GRA. 
 
(四) 粒子濾波器之探討及其於導航系統之設計 
 
Particle filters is a probability-based estimator. 
Bayesian estimation is the foundation for particle filters. 
Bayes’ rule is described by the following equation: 
            
)|(
)|()|()|(
1
1
−
−=
kk
kkkk
kk p
ppp
Yy
YxxyYx         (97) 
The above equation is called the Bayesian state 
estimation, where one wants to find a way to 
compute )|( kkp Yx . In order to find )|( kkp Yx , we have to 
find the equation )|( 1−kkp Yx from the 
Chapman-Kolmogorov (Papoulis and Unnikrishna 
Pillai, 2002) and the marginal density function. 
The )|( kkp Yx can be written as: 
     11111 )|()|()|( −−−−− ∫= kkkkkkk dppp xYxxxYx     (98) 
The pdf )|( 1−kkp Yy is: 
         kkkkkkk dppp xYxxyYy )|()|()|( 11 −− ∫=       (99) 
 
The flow chart for SIS is summarized as follows. 
(1) Initialization: 
   draw the state i0x  from )( 0xq , ni .......1=  
(2) Importance sampling step: 
   sample ),|(~ 1 kikkik q YXxx −  
   evaluate the importance weight: 
          
),|(
)|()|(
1
1
1
k
i
k
i
k
i
k
i
k
i
kki
k
i
k q
pp
yxx
xxxy
−
−−∝ωω  
   normalize the importance weight: 
∑= ik
i
ki
k ω
ωω  
(3) The posterior density )|( kkp Yx  
∑ −≈
=
N
i
i
kk
i
kkkp
1
)()|( xxYx δω  
 
Sampling Importance Resampling (SIR). In Gordon et 
al. (1993), SIR filter is named the “bootstrap” filter. 
Since SIS has degeneracy problem, all but one particle 
will neglect normalized weight. The resampling 
technique is used to avoid the problem. The purpose of 
 17
algorithm is that Nicholas Metropolis published in 1953, 
and W.K. Hastings had generalized it in 1970. The 
conception of this algorithm is that the old particle ikx  
goes to the new particle *ikx  if the uniformly 
distributed random number is less than the acceptance 
probability. The algorithm is given by from van der 
Merwe, et al. (2000).  
The old particle ikx  is obtained from resampling 
stage, so that },{ 1ikikik −= XxX . The new particle *ikx  is 
obtained from the proposal distribution, so 
that },{ 1** ikikik −= XxX . According to van der Merwe, et al. 
(2000), the acceptance probability α   
}
),|()|()|(
),|()|()|(,1min{
1
*
1
11
**
k
i
k
i
k
i
k
i
k
i
kk
k
i
k
i
k
i
k
i
k
i
kk
qpp
qpp
yxxxxxy
yxxxxxy
−−
−−=α    (102) 
If one uses the a prior distribution as the importance 
density function, which can get the new particle 
from )|(),|(~ 1*1** ikikkikikik pq −− ≈ xxyxxx , and the old particle 
is from )|(),|(~ 11 ikikkikikik pq −− ≈ xxyxxx  then the 
acceptance probability α  can be presented as: 
}
)|(
)|(,1min{
*
i
kk
i
kk
p
p
xy
xy=α            (103) 
 
The M-H algorithm step is as follows: 
(1) Sample )1,0(~ Uu  
(2) Sample particles )|(~ 1* ikikik p −xxx  and then particles 
are through EKF algorithm 
(3) If }
)|(
)|(,1min{
*
i
kk
i
kk
p
pu
xy
xy≤  
     if accept it: 
                  *ikik xx =  
     if reject it: 
                  ikik xx =  
  end if 
 
四、結果與討論 
本計畫之結果與討論分四部份介紹。  
 
(一) 第一部份-模糊強跟蹤無跡卡爾曼濾波器(unscented 
Kalman filter)於整合導航系統 
Figure 9 shows the architecture of the 
tightly-coupled GPS/INS integrated navigation 
processing based on the FLAS-coupled STUKF 
mechanism. The measurement is the residual between 
GPS pseudorange and INS predicted range, which is 
used as the measurement of the UKF. 
 
 
Figure 9. Integrated navigation processing using the 
FSTUKF. 
 
The differential equations describing the 
two-dimensional inertial navigation state are: 
⎥⎥
⎥⎥
⎥⎥
⎦
⎤
⎢⎢
⎢⎢
⎢⎢
⎣
⎡
+
−=
⎥⎥
⎥⎥
⎥⎥
⎦
⎤
⎢⎢
⎢⎢
⎢⎢
⎣
⎡
=
⎥⎥
⎥⎥
⎥⎥
⎦
⎤
⎢⎢
⎢⎢
⎢⎢
⎣
⎡
r
vu
vu
e
n
r
e
n
e
n
e
n
aa
aa
v
v
a
a
v
v
v
v
e
n
ω
ψψ
ψψ
ωψ
)cos()sin(
)sin()cos(
&
&
&
&
&
     (104) 
where [ ua , va ] are the measured accelerations in the 
body frame, rω  is the measured yaw rate in the body 
frame, as shown in Figure 10. The error model for INS 
is augmented by some sensor error states such as 
accelerometer biases and gyroscope drifts. Actually, 
there are several random errors associated with each 
inertial sensor. It is usually difficult to set a certain 
stochastic model for each inertial sensor that works 
efficiently at all environments and reflects the 
long-term behavior of sensor errors. The difficulty of 
modeling the errors of INS raised the need for a 
model-less GPS/INS integration technique (Farrell and 
Barth, 1999). Linearization of Eq. (104) results in the 
following set of linearized equations 
 
⎥⎥
⎥⎥
⎥⎥
⎦
⎤
⎢⎢
⎢⎢
⎢⎢
⎣
⎡
+
⎥⎥
⎥⎥
⎥⎥
⎦
⎤
⎢⎢
⎢⎢
⎢⎢
⎣
⎡
⎥⎥
⎥⎥
⎥⎥
⎦
⎤
⎢⎢
⎢⎢
⎢⎢
⎣
⎡
=
⎥⎥
⎥⎥
⎥⎥
⎦
⎤
⎢⎢
⎢⎢
⎢⎢
⎣
⎡
ψδψ
δ
δ
δ
δ
ψδ
δ
δ
δ
δ
w
w
w
v
v
e
n
v
v
e
n
e
n
e
n
e
n
0
0
00000
00000
00000
01000
00100
&
&
&
&
&
   (105) 
 
which will be utilized in the integration Kalman filter as 
the inertial error model. In Eq. (105), nδ  and 
eδ represent the east, and north position errors; nvδ  
and evδ represent the east, and north velocity errors; 
and δψ  represent yaw angle, respectively. 
 
 19
the Cholesky factorization has been used in obtaining 
the sigma points. The softening factor ε  in the STUKF 
is a constant and does not change subject to the change 
in dynamics. In the FSTUKF, ε  is determined by the 
FLAS.  
The philosophy for defining the rules is 
straightforward: (1) for the case that the DOD 
parameter is small, our objective is to obtain results 
with better estimation accuracy, and a larger softening 
factor ε  should be applied; (2) for the case that the 
DOD parameter is increased, our objective is to increase 
the tracking capability, and a smaller softening factor 
should be applied. The membership functions (MFs) of 
input fuzzy variable DOD parameters as shown in 
Figure 9 are triangle MFs, obtained by the function:  
⎪⎪
⎪
⎩
⎪⎪
⎪
⎨
⎧
≤
≤≤−
−
≤≤−
− ≤
=
xc
cxb
bc
xc
bxa
ab
ax
ax
x
0
0
)(μ             (107) 
The first-order T-S model has been employed. The 
zero-order model needs more complicated MFs and 
rule base and is, therefore, more difficult to determine. 
The presented FLAS is the If-Then form and consists of 
9 rules. 
1. IF ξ is zero and ζ is zero THEN ε  is 6 3 3 ++ ζξ  
2. IF ξ is zero and ζ is small THEN ε  is 6 3 3 ++ ζξ  
3. IF ξ is zero and ζ is large THEN ε  is 6 3 3 ++ ζξ  
4. IF ξ is small and ζ is zero THEN ε  is 2  ++ ζξ  
5. IF ξ is small and ζ is small THEN ε  is 2  ++ ζξ  
6. IF ξ is small and ζ is large THEN ε  is 1  
7. IF ξ is large and ζ is zero THEN ε  is 1  
8. IF ξ is large and ζ is small THEN ε  is 1  
9. IF ξ is large and ζ is large THEN ε  is 1  
 
 
Figure 14. Membership functions of input fuzzy 
variables ξ  (top) and ζ  (bottom). 
Figures 15-18 provide results for the integrated 
navigation system using the EKF, UKF, STUKF and 
FSTUKF approaches. The deviations from the truth in 
Northing and Easting are shown. Before the FLAS is 
incorporated, evaluation of navigation accuracy for 
UKF and STUKF is presented, shown in Figures 15 and 
11. Comparison of navigation errors for EKF and UKF 
is shown in Figure 15. A smaller process noise 
covariance matrix is applied to preserve good 
estimation accuracy in the low dynamic regions. 
Although increasing the value may improve the 
estimation accuracy in the high dynamic regions, while 
at the expense of performance degradation at low 
dynamic regions. Comparison of navigation errors for 
STUKF and UKF is shown in Figure 16. Figure 17 
shows the comparison of navigation errors for the 
FSTUKF, STUKF and UKF. When the vehicle is under 
high dynamic environments, a smaller softening factor 
ε  will be required for better tracking capability; when 
the vehicle is in lower dynamic environments, a 
larger ε will be needed for better estimation precision 
(i.e., smoother results). Accordingly, as the improved 
version of STUKF, the FSTUKF employs the FLAS for 
automatically adjusting the value of ε . It can be seen 
that substantial estimation accuracy improvement is 
obtained by using the proposed technique. Figure 13 
provides comparison of east and north position errors 
via all the four approaches: EKF, UKF, STUKF, and 
FSTUKF.  
 
Some of the remarks are given as follows.  
(1) In the four time intervals, 0-100, 301-400, 501-550 
and 651-800s, the vehicle is not maneuvering and is 
conducting constant-velocity straight-line motion. For 
this case, all the EKF, UKF, STUKF and FSTUKF 
provide equivalently good results. The navigation 
accuracies based on the four approaches have relatively 
small difference. By use of the T-S fuzzy logic, the FLAS 
senses smaller values of DOD parameters, and gives a 
larger softening factor. With large softening factors, the 
UKF, STUKF and FSTUKF deteriorate to the EKF. As a 
result, the navigation accuracies based on the EKF, UKF, 
STUKF and FSTUKF are equivalent. 
(2) In the three time intervals, 101-300, 401-500 and 
551-650s, the vehicle is maneuvering. The mismatch of 
the model leads the STUKF to larger navigation error 
while the FLAS timely detects the increase of DOD 
parameter, and then reduces softening factor so as to 
maintain good tracking capability. It has been verified 
that, by monitoring the innovation information, the 
FSTUKF has good capability to detect the change in 
vehicle dynamics and adjust the softening factor for 
preventing the divergence and having better navigation 
accuracy. 
 
Figure 19 shows the fading factors resulting from 
STUKF and FSTUKF, respectively. For the three regions 
of high dynamic environments, the fading factors using 
FSTUKF have been amplified at a higher rate as 
compared to the STUKF. 
 21
method such as the Cholesky factorization has been 
used in obtaining the sigma points.  
 
-2000 0 2000 4000 6000 8000 10000
-20000
-10000
0 .0000
1 0000
-1000
0
1000
2000
3000
4000
5000
6000
7000
8000
North (m)
 East (m) 
A
lti
tu
de
 (m
)  
 
Figure 20. Three dimensional vehicle trajectory (in ENU 
frame). 
 
0 50 100 150 200 250 300 350 400 450
-100
0
100
200
300
400
E
as
t  
km
/h
r
0 50 100 150 200 250 300 350 400 450
-300
-200
-100
0
N
or
th
  k
m
/h
r
0 50 100 150 200 250 300 350 400 450
0
50
100
Time (sec)
A
lti
tu
de
  k
m
/h
r
 
Figure 21. Vehicle velocity in the east, north, and 
vertical components. 
 
Estimation accuracy comparison for the (1) results 
based on the DD1 and EKF; (2) results based on the 
DD2 and UKF will be presented, respectively. The basic 
principle is to increase the navigation estimation 
accuracy while preserving and without sacrificing the 
performance at the low dynamic regions. For 
comparison purpose, the same values of process noise 
covariance parameters will be utilized. The parameters 
employed in the two cases are as follows: (1) a smaller 
process noise covariance kQ  is used: 55.111 −= eq ; 
7122 −= eq ; 7233 −= eq ; 81~ 7744 −= eqq ; 91~ 101088 −= eqq ; 
591111 −= eq , for which case 41 −= eα , 2=β , 0=γ  for 
UKF; (2) larger process noise covariance kQ  is used: 
5711 −= eq ; 0035.022 =q ; 44.133 −= eq ; 67~ 7744 −= eqq ; 
97~ 101088 −= eqq ; 671111 −= eq , for which case 
007.0=α , 2=β , 0=γ  for UKF. For both cases, the 
following parameters are set: 1=dt ; 3=h . Let each of 
the white-noise spectral amplitudes that drive the 
random walk position states be 
)sec/()sec/(1.0 2 radmS p = . Also, let the clock model 
spectral amplitudes be sec104.0 18−⋅=fS and 
118 sec1058.1 −−⋅=gS . These spectral amplitudes can be 
used to find the kQ  matrix for the proposed 
quaternion-based model. Figure 22 provides the 
comparison of position RMSE for four types of filters 
when smaller and larger process noises are utilized. 
 
 
 
Figure 22. Comparison of position RMSE for four types 
of filters when smaller (top) and larger (bottom) process 
noises are utilized.  
 
(三) 第三部份-灰關聯分析(grey relational analysis)輔助
H∞ 濾波器於導航系統 
The experiment was conducted on a simulated 
vehicle trajectory originating from the position of North 
25.1492 degrees and East 121.7775 degrees at an altitude 
of 100m. This is equivalent to 
[ ]T2694074.34911080.23042329.2- m in the WGS-84 
ECEF coordinate system. The location of the origin is 
defined as the (0,0,0) m location in the local tangent 
East-North-Up (ENU) frame.  
Since we assumed that the differential GPS (DGPS) 
mode is used and most of the errors can be corrected, 
but the multipath and receiver measurement thermal 
noise cannot be eliminated. The measurement noise 
variances irρ  are assumed a priori known, which is set 
as 2)3( m . Let each of the white-noise spectral amplitudes 
that drive the random walk position states be 
sec/)sec/(003.0 2 radmS p = . Also, let the clock model 
spectral amplitudes be sec)10(4.0 18−=fS  and 
 23
 
Figure 25. Vehicle velocity in the east, north, and 
vertical components. 
 
 
Figure 26. Vehicle acceleration in the east, north, and 
vertical components. 
 
Table 1. Description of vehicle motion 
Time interval (sec) Motion 
[0-1000] Constant velocity 
[1001-2000] Circular motion  
[2001-2800] Constant velocity 
[2801-4300] Variable velocity 
[4301-4800] Circular motion, clockwise 
turn 
 
Table 2. Parameter setting for EKF and H∞ filter 
 EKF H∞ filter 
dt  sec1  sec1  
pS  sec//)sec/(003.0 2 radm  sec//)sec/(003.0 2 radm  
gS  118 sec)10(58.1 −−  118 sec)10(58.1 −−  
fS  sec)10(4.0 18−  sec)10(4.0 18−  
γ  NA ∞<< γ0  
 
 
 
Figure 27. Position error based on the H∞ filter as 
compared to the EKF when kQ  is small. 
 
 
Figure 28. Position error based on the EKF and the H∞ 
filter as ∞→γ , when kQ  is small. 
 
 
Figure 29. Trajectory of the grey relational coefficient. 
 
 25
architecture with total states, using EKF and particle 
filters approaches is employed. Figures 38 and 39 show 
the comparison of east and north position errors using 
(1) EKF, (2) PF with EKF as proposal distribution, and 
(3) EK-PF. The number of particles used is 80. The EKF 
algorithm may cause the estimation degradation; while 
the particle filter, with sufficient number of particles, 
has the capability to compensate the un-modeling part 
caused by the linearization process. 
 
 
 
 
Figure 34. Comparison of GPS position errors for EKF, 
UKF and PF with EKF as proposal when the nonlinear 
model is used (smaller process noise covariance has 
been used).  
 
 
 
 
Figure 35. Comparison of GPS position errors for EKF, 
UKF and EK-PF when the nonlinear model is used 
(smaller process noise covariance has been used). 
 
 
Figure 36. Comparison of RMSE of errors of estimation. 
 
EKF 
UKF
PF 
EKF
UKF 
PF
EKF
UKF
PF 
EKF 
UKF 
PF 
EKF
UKF PF
EKF 
UKF 
PF 
 27
III. Book chapters 
 
1. Dah-Jing Jwo, Mu-Yen Chen, Chien-Hao Tseng and 
Ta-Shun Cho, "Adaptive and Nonlinear Kalman 
Filtering for GPS Navigation Processing", in 
Applications of Kalman Filter,  I-Tech Publications, 
Vienna, Austria, EU. (In press) 
 
相關研究仍持續進行，現亦彙整及發展更豐富之成果，準
備將其投至期刊發表中。 
 
六、參考文獻 
 
[1] Abdelnour, G., Chand, S. and Chiu, S. (1993). 
Applying fuzzy logic to the Kalman filter 
divergence problem, in: Proc. IEEE Int. Conf. on 
Syst., Man and Cybernetics, Le Touquet, France, pp. 
630-634. 
[2] Brown, R., and Hwang, P. (1997). Introduction to 
Random Signals and Applied Kalman Filtering. John 
Wiley & Sons, New York. 
[3] Ding, W., Wang, J., and Rizos, C. (2007). Improving 
Adaptive Kalman Estimation in GPS/INS 
Integration. The Journal of Navigation, 60, pp.517-529. 
[4] Farrell, J., Barth, M. (1999). The Global Positioning 
System and Inertial Navigation, McCraw-Hill 
professional. 
[5] Gelb, A. (1974). Applied Optimal Estimation. M. I. T. 
Press, MA.  
[6] Hide, C, Moore, T., and Smith, M. (2003). Adaptive 
Kalman filtering for low cost INS/GPS, The Journal 
of Navigation, 56, pp.143-152. 
[7] Julier, S. J. (2002). The scaled unscented 
transformation, in: Proceedings of the American 
Control Conference, Anchorage, USA, pp.4555-4559. 
[8] Julier, S. J., Uhlmann, J.K., Durrant-whyte H. F. 
(1995). A new approach for filtering nonlinear 
system, in: Proceeding of the American Control 
Conference, pp.1628-1632. 
[9] Julier, S. J., Uhlmann, J. K., Durrant-whyte, H.F. 
(2000). A new method for the nonlinear 
transformation of means and covariances in filters 
and estimators, IEEE Transactions on Automatic 
Control, 5(3), pp.477-482. 
[10] Julier, S. J., Uhlmann, J. K. (2002). Reduced sigma 
point filters for the propagation of means and 
covariances through nonlinear transformations, in: 
Proceeding of the American Control Conference, 
pp.887-892 
[11] Li, Y., Wang, J., Rizos, C., Mumford, P. J., Ding, W. 
(2006). Low-cost tightly coupled GPS/INS 
integration based on a nonlinear Kalman filter 
design, in: Proceedings of the U.S. Institute of 
Navigation National Tech. Meeting, pp.958-966. 
[12] Mehra, R. K. (1972). Approaches to adaptive 
filtering, IEEE Trans. Automat. Contr., AC-17, 
pp.693-698. 
[13] Mohamed, A. H. and Schwarz, K. P. (1999). 
Adaptive Kalman filtering for INS/GPS, Journal of 
Geodesy, 73, pp.193-203. 
[14] Salychev, O. (1998). Inertial Systems in Navigation 
and Geophysics, Bauman MSTU Press, Moscow. 
[15] Sasiadek, J. Z., Wang, Q., Zeremba, M. B. (2000). 
Fuzzy Adaptive Kalman filtering for INS/GPS 
data fusion, in: Proc. 15th IEEE int. Symp. on 
intelligent control, Rio, Patras, Greece, 181-186. 
[16] Simon, D., (2006). Optimal State Estimation, Kalman, 
H∞, and nonlinear approaches, John Wiley & Sons, 
New York. 
[17] Takagi, T., Sugeno, M. (1985). Fuzzy identification 
of systems and its application to modelling and 
control, IEEE Trans. Syst., Man, Cybern., vol. 
SMC-15, no.1, pp.116-132.  
[18] Wan, E. A., van der Merwe, R. (2000). The 
unscented Kalman filter for nonlinear estimation, 
in: Proceedings of Adaptive Systems for Signal 
Processing, Communication and Control 
(AS-SPCC) Symposium, Alberta, Canada, 
pp.153-156. 
[19] Wan, E. A., van der Merwe R. (2001). The 
Unscented Kalman Filter, in: Simon Haykin (Ed.), 
Kalman Filtering and Neural Networks, Wiley, 
(Chapter 7). 
[20] Xia, Q., Rao, M., Ying, Y., and Shen, X. (1994). 
Adaptive fading Kalman filter with an application, 
Automatica, 30, pp.1333-1338. 
[21] Zhou, D. H., Frank, P. M. (1996). Strong tracking 
Kalman filtering of nonlinear time-varying 
stochastic systems with coloured noise: 
application to parameter estimation and empirical 
robustness analysis, Int. J control, 65, 295-307. 
[22] Crassidis, J. L. (2006) Sigma-point Kalman filtering 
for integrated GPS and inertial navigation, IEEE 
Transactions on Aerospace and Electronic Systems 
42(2), pp.750-756 
[23] Gordon, N. J., Ristic, B., Arulampalam, S. (2004) 
Beyond the Kalman Filter : Particle Filter for 
Tracking Applications, Artech House, Boston 
[24] Hamilton, W. R. (1844). On a new species of 
imaginary quantities connected with a theory of 
quaternions, Proc. R. Irish Acad. 2, pp.424–434.  
Available: 
http://www.maths.tcd.ie/pub/HistMath/People
 29
[53] Carpenter, J., Fearnhead, P., Clifford, P.  (1999). 
Improved particle filter for nonlinear problems, 
IEE Proc. –F, Radar, Sonar Navig., vol. 146, no. 1, 
pp. 2-7. 
[54] Gordon, N. J., Salmond, D. J., Smith, A. F. M., 
(1993). Novel approach to 
nonlinear/non-Gaussian Bayesian state estimation, 
IEE proceedings , vol. 140 , no. 2 , pp. 107-113 
[55] Ristic, B., Arulampalam, S., Gordon, N. (2004). 
Beyond the Kalman Filter: Particle Filter for 
Tracking Applications, Artech House, Boston. 
London. 
[56] Julier, S. J. (2002). The scaled unscented 
transformation, in: Proceedings of the American 
Control Conference, Anchorage, USA, 
pp.4555-4559. 
[57] Julier, S. J., Uhlmann, J. K., (2002). Reduced sigma 
point filters for the propagation of means and 
covariances through nonlinear transformations, in: 
Proceeding of the American Control Conference, 
pp. 887-892. 
[58] van der Merwe, R., Doucet, A., de Freitas, J.F.G., 
Wan, E. (2000). The Unscented Particle Filter, 
Technical Report OUED / F-INFENG / TR 380, 
Cambridge University Engineering Department. 
 
 
 
 
出席國際學術會議心得報告 
                                                             
計畫編號 NSC 96-2221-E-019-007 
計畫名稱 非線性估測理論之探討及其於導航系統之設計 
出國人員姓名 
服務機關及職稱 
卓大靖 國立臺灣海洋大學通訊與導航工程學系 教授 
會議時間地點 (1) 韓國首爾; (2)中國青島 
會議名稱 
(1) 17th IFAC 2008 
(2) ICIC 2007 
發表論文題目 
(1) An Adaptive Sensor Fusion Method with Applications in Integrated 
Navigation  
(2) A Fuzzy Adaptive Fading Kalman Filter for GPS Navigation 
 
一、參加會議經過 
(1) 17th IFAC 2008國際學術研討會 
國際學術研討會 17th IFAC World Congress，於 2008年 7月 6-11日於韓國首爾(Seoul)之
COEX 會展中心(COEX Convention Center)舉行(圖一)。國際自動控制年會(IFAC World 
Congress) 是該領域中相當重要的國際研討，由世界各會員國舉辦。此會係三年舉行一次之
國際學術研討會，今年之研討會與會人員共數千位，來自世界各國家或地區，台灣約有七十
人參加，乃一規模相當龐大之知名會議，計有將近四百場 Sessions報告，會場中亦提供了許
多產品(如機器人)之展示(圖二)。研討會論文內容涵蓋廣泛，會議主題涵蓋了 Reduced 
Complexity Control Systems, Overview of Potential Evolutions of Technologies Applied 
in Commercial Transport Airplanes, Automotive & Manufacturing Systems, Nonlinear 
∞H  Control and Disturbance Rejection, Geometric Control, Time Delay Systems, 
Identification in Systems Biology: Methods and Applications, Output Feedback Sliding 
Mode Control, Optimal Control Theory, Optimization Based Controller Synthesis, 
Subspace-Based System Identification, Fault Detection, Robust Adaptive Control, 
Multi-Vehicle Systems等諸項重要之議題。筆者於 7月 9日下午 15:00-15:20進行口頭報告，
Applications of Stochastic Systems Theory題目為“An Adaptive Sensor Fusion Method 
with Applications in Integrated Navigation”。本論文推導了一種新的自適應卡爾曼濾波
器，並應用於 GPS/INS導航之設計，解決了部份應用卡爾曼濾波器(Kalman filter)進行狀態
估測時，必須明確掌握系統狀態空間模型之問題。此報告亦引起許多與會專家之興趣，獲得
了許多廻響，之後並與聽眾進行了心得交換。會中巧遇俄羅斯籍舊識 Oleg A. Stepanov (圖三， 
任職於 Central Scientific Res. Inst. Elektropribor 之 department head)，相談甚歡。7月 10
日當日晚上大會舉行了晚宴(圖四)，提供了與會人士進一步交流之機會。整體而言，此次研
討會提供了各國與會人士密切交換研究心得之機會，對於筆者個人而言，由於除了報告個人
研究成果之外，亦廣泛吸取諸多學者專家之經驗，對於未來從事前瞻導航系統之開發與設計，
以及基礎研究之紥根，開啟了更廣闊之思路與視野。 
