 
中 文 摘 要 ： 在本報告的第一部分，我們對叢集式感測網絡的檢測與估計
問題進行了探討。我們提出聯合檢測與估計技術以解決這個
問題。在新方法中，每個中繼點檢測訊號來源，利用所提出
的聯合檢測與估計的法則壓縮這些信息，並將其轉發到目的
節點。然後，所有從網絡中繼節點所轉發的訊息，則在目的
地端根據聯合檢測與估計法則相融合，以判斷來源端所發射
的訊息。中繼節點和目的節點的檢測估計和融合規則都使用
期望最大化（EM）演算算法進行處理。模擬結果顯示，反饋
機制加速了向 CRLB 收斂的速度。在本報告的第二部分，我們
探討了在一個稱為雙向中繼網絡的通道估計問題。文獻上可
以找到的研究已經設計了一個以通道估計均方誤差為準則所
設計的訓練序列，並以該訓練序列估計通道狀態。然而，這
種通道道估計方法可能不適合通道狀態快速變化的環境。另
一個缺點是，這種需要以發射領航訊號為基礎的通道估計將
耗費大量的頻寬。為了進一步提高頻寬效率，我們提出以 EM
演算法為基礎的數據檢測和通道估計方法。模擬結果顯示了
所提出方法的性能可以非常接近 CRLB。此外，以相同數量的
領航訊號為比較基礎，我們的研究結果展現所提出的方法優
於在文獻中論文所提出以訓練序列為基礎的通道估計方法。 
中文關鍵詞： 合作式通訊，叢集式感測網路，通道估測，資料檢測，雙向
中繼網路，期望最大化演算法 
英 文 摘 要 ： In the first part of this report, the problem of 
detection and estimation in cluster-based sensor 
networks is explored. Joint detection and estimation 
techniques are developed to tackle this problem. In 
the proposed approach, each relay detects the source 
information using its joint detection and estimation 
rules, and then compresses this information and 
forwards it to the destination node. The source 
information received from all the relays in the 
network is combined at the destination node in 
accordance with a fusion decision rule in order to 
determine the corresponding symbol vector. The joint 
detection and estimation rule at the relays and the 
fusion rule at the destination node are both 
processed using an expectation maximization (EM) 
algorithm. The simulation results show that the 
feedback mechanism accelerates the convergence of the 
local channel estimates toward the 
Cram$\acute{\mbox{e}}$r-Rao lower bound (CRLB). In 
1Abstract- In the first part of this report, the problem of detection and estimation in cluster-based sensor
networks is explored. Joint detection and estimation techniques are developed to tackle this problem. In
the proposed approach, each relay detects the source information using its joint detection and estimation
rules, and then compresses this information and forwards it to the destination node. The source information
received from all the relays in the network is combined at the destination node in accordance with a
fusion decision rule in order to determine the corresponding symbol vector. The joint detection and
estimation rule at the relays and the fusion rule at the destination node are both processed using an
expectation maximization (EM) algorithm. The simulation results show that the feedback mechanism
accelerates the convergence of the local channel estimates toward the Crame´r-Rao lower bound (CRLB).
In the second parts of this report, the channel estimation problem is considered in a bandwidth efficient
structure called two-way relay network. Previous studies have designed a training-based channel estimator
based on the mean square error to obtain the channel state information. However, this channel estimator
may be unsuitable for a wireless environment, wherein the fading channel changes from one data block to
another. Another drawback is that the training-based scheme requires pilots to be placed throughout the
data block, which will cost a substantial amount of bandwidth. To further improve bandwidth efficiency,
a data detection and channel estimation scheme based on the EM algorithm is proposed. The simulation
results show that the performance of the proposed scheme can approach the CRLB at the region with
high signal-to-noise ratio. In addition, given the same number of pilots, our results show that the proposed
scheme outperforms the training-based schemes proposed in previous studies.
Keywords: Cooperative communications, cluster-based sensor networks, channel estimation, data de-
tection, two way relay network, expectation maximization.
I. INTRODUCTION
Cooperative communications, in which multiple users assist one another in relaying their information to
the destination, provide an effective means of increasing the spatial diversity within communication net-
works [1]–[5]. It can provide diversity gain without carrying multiple antennas on a single communication
device and is particularly beneficial in multi-hop wireless networks or sensor networks, in which node
transmissions are subject to stringent power constraints. The first part of report focuses on the particular
case of cluster-based networks, in which a small number of nodes facilitate the communications between
a pair of cluster-heads located in different cluster groups. Specifically, the report proposes an efficient
3Single transmit antenna s


 



h1,y1 h2,y2 · · · hK ,yK
Relay 1 Relay 2 · · · Relay K
u1 u2 · · · uK
uˆ1 uˆ2 · · · uˆK
× × ×
  
uˆ01 uˆ02 uˆ0K
u0 u0 u0
× × ×  
× = Binary
Symmetric
Channel
Destination Node

u0
Fig. 1. System model for joint distributed detection and estimation for cooperative network.
known. In practice, however, this information is generally not available in advance. Accordingly, in the
joint detection and estimation scheme proposed in this report, each relay constructs a local detection rule
based upon its own estimate of the CSI.
In resource constrained networks, the energy and bandwidth required for data transmission are limited
[15], and thus channel estimation schemes based on the transmission of many known symbols are
impractical. Accordingly, the joint detection and estimation scheme proposed in this report is based on
observations containing unknown symbols. The problem of joint detection and estimation has attracted
significant interest in the literature [16]–[20]. However, the formulation proposed in this report differs from
existing joint detection and estimation schemes in that it utilizes a distributed approach, which exploits
node cooperation and achieves a better system performance in cluster-based communications networks.
Moreover, a decision feedback channel is implemented between the destination node and the relays in
order to combat the possible effects of deep fade and to improve the detection and estimation performance
of each relay. In implementing the joint distributed symbol detection and channel estimation scheme, the
rules applied at the relay nodes and destination node are derived in accordance with an expectation
maximization (EM) algorithm [21], [22]. As described above, this report considers the problem in which
a small number of nodes within a particular cluster cooperate with one another in relaying the messages
sent from a cluster-head outside the cluster to the local cluster-head. In accomplishing the forwarding
process, each relay forwards a block of symbols locally determined on the basis of the received block
5AF relaying strategy is employed at the relay node in the model presented in [33], [34] because of its
low-complexity merit. The second part of this report also focuses on AF-based TWRNs. However, to
achieve the required performance, the training-based channel estimation schemes require more bandwidth
to transmit numerous pilot signals. Moreover, a training-based scheme may be unsuitable for the time-
varying environment, in which the communication channel rapidly varies from block to block.
For the sake of increasing bandwidth efficiency, a joint symbol detection and channel estimation scheme
is proposed for TWRNs. The scheme is employed at the source nodes (that also serve as the destination
nodes), and the detection and estimation rules are also derived based on the EM algorithm. The EM
algorithm is known to be capable of converging to a local maximum depending on the choice of initial
point. A straightforward approach for the avoidance of unfavorable select a number of initial points is
to randomly select a number of initial points among which the best result is determined. However, this
selection technique may require considerable computational time and still trap at poor performance. In
order to acquire a better initial result, we utilize two orthogonal bits as the pilots to obtain the initial points
for the derived EM algorithm. However, the number of pilots used in the proposed scheme is notably
fewer than that used in the training-based estimation scheme proposed in [33]. (see Section IV).
The rest of the report is organized as follows. The system model and the proposed detection and esti-
mation rules of the cluster-based networks are introduced in Section II. Section III derives the algorithms
of the proposed joint detection and estimation scheme for the AF-based TWRN. Section IV summarizes
simulation results that demonstrate the effectiveness of the proposed scheme in these two structures.
Finally, a number of conclusions are drawn in Section V.
II. JOINT DETECTION AND ESTIMATION FOR COOPERATIVE COMMUNICATIONS IN CLUSTER-BASED
NETWORKS
A. Problem statement and system model
The joint detection and channel estimation scheme developed in this report considers a parallel relay
network with the structure shown in Fig. 1. Let D = {r1, . . . , rK} be the set of K receivers which
observe the signal measurement sequences Y = {y1, . . . ,yK} generated from a common transmitted
symbol vector s, where yk, k = 1, . . . , K denotes the received signal blocks yk = {ytk}Tt=1 at receiver rk
corresponding to each block of T symbols s = {st}Tt=1 sent from the transmitter. Assume that at time
t, the transmitter transmits the complex symbol st and the receivers R receives {ytk}Kk=1. The received
7P
(
yk, uˆ
(j−1)
0k
∣∣∣ hk, s) (a1)= ∑
U(j−1)\u(j−1)k
P
(
yk, uˆ
(j−1)
0k ,U
(j−1)
∣∣∣hk, s)
=
∑
U(j−1)\u(j−1)k
P
(
yk, uˆ
(j−1)
0k
∣∣∣U (j−1), hk, s)P (U (j−1)∣∣hk, s)
(b1)
=
∑
U(j−1)\u(j−1)k
p
(
yk
∣∣U (j−1), hk, s)P (uˆ(j−1)0k ∣∣∣U (j−1), hk, s)P (U (j−1)∣∣hk, s)
(c1)
=
∑
U(j−1)\u(j−1)k
p
(
yk
∣∣∣u(j−1)k , hk, s)P (uˆ(j−1)0k ∣∣∣U (j−1))P (u(j−1)k ∣∣∣hk, s) ∏
um∈U(j−1)\u(j−1)k
P (um|s)
(d1)
=
∑
U(j−1)\u(j−1)k
p (yk |hk, s)P
(
uˆ
(j−1)
0k
∣∣∣U (j−1)) ∏
um∈U(j−1)\u(j−1)k
P (um|s). (4)
Note also that the channel between the kth relay node and the destination node is assumed to be a
binary symmetric channel (BSC). In addition, the internal cluster communications are assumed to take
place over quasi-static channels.
B. Derivation of relay decision rule and destination decision rule
1) Joint detection and estimation at relay nodes: Consider the joint detection and estimation rule at
receiver rk in iteration j. Furthermore, define
(
yk, uˆ
(j−1)
0k
)
and X(j)k =
(
yk, uˆ
(j−1)
0k , hk
)
as the incomplete
data and complete data, respectively. Note that in the following, the superscript j is dropped from the
symbol X (j)k when it can be determined from the context.
The probability function of Xk as a function of s is given by
P (Xk| s) = P
(
yk, uˆ
(j−1)
0k
∣∣∣hk, s) p(hk|s), (2)
where p(hk|s) denotes the probability density function of hk given s. Since the channel response vector
and the signal block are independent, p(hk|s) can be written as
p(hk|s) = p(hk). (3)
The probability function P
(
yk, uˆ
(j−1)
0k
∣∣∣hk, s) in (2) can be further expressed as equation (4), where
(a1) follows from the fact that u
(j−1)
k is a function of yk, (b1) follows from the fact that yk and
uˆ
(j−1)
0k are conditionally independent given uˆ
(j−1)
k , (c1) follows from the fact that the destination node
makes a decision uˆ(j−1)0k based only on U
(j−1) and does not depend on s and hk, and (d1) follows
9Substituting (7) into (6) and dropping the terms which do not relate to s, we obtain
Q′k
(
s|s[i]) = 1
2σ2
T∑
t=1
{
2ytkE
[
hk|yk, uˆ(j−1)0k , s[i]
]
st − E
[
h2k|yk, uˆ(j−1)0k , s[i]
]
s2t
}
log


∑
U(j−1)\u(j−1)k
P
(
uˆ
(j−1)
0k
∣∣∣U (j−1)) ∏
um∈U(j−1)\u(j−1)k
P (um|s)

 , (8)
where E
[
hk|yk, uˆ(j−1)0k , s[i]
]
can be seen as the estimate of the latent variable hk. Note that the term
E
[
h2k|yk, uˆ(j−1)0k , s[i]
]
s2t can be ignored if the transmission signal st has a constant energy for all transmis-
sion times t. Note also that in the first iteration, the log term in (8) is not evaluated since the information
uˆ
(j−1)
0k is not yet available. Finally, the probability terms P
(
uˆ
(j−1)
0k
∣∣∣U (j−1)) and P (uˆm|s) are easily
derived using the method given in [14]. Having performed the E-step, the M-step is then performed by
maximizing the auxiliary equation, i.e.,
s[i+1] = argmax
s
Q′k
(
s|s[i]) . (9)
After the detection and estimation procedure, we can forward the results to destination node and use the
fusion rule to combine the received signal. The initial fusion at destination will be provide in the next
subsection.
2) Joint detection and estimation at destination node at initial iteration: This section commences by
deriving the destination decision rule at the initial iteration (iteration j = 1). According to the fusion
process, let Uˆ (0) and X(0)0 =
(
Uˆ (0),h
)
be the incomplete data and complete data at the destination node,
respectively.
The probability function of X0 as a function of s has the form
P (X0| s) (a3)=
K∏
k=1
P
(
uˆ
(0)
k |hk, s
)
p(h|s)
(b3)
=
K∏
k=1
T∏
t=1
P
(
uˆ
(0)
tk |hk, st
)
p(h|s), (10)
where (a3) follows from Assumptions 3 and 4, and (b3) follows from Assumption 2. The probability
P
(
uˆ
(0)
tk |hk, st
)
can be written as
P
(
uˆ
(0)
tk = 1|hk, st
)
=
∫
dytk
1 [Λ (ytk|hk) > ηk] p(ytk|hk, st), (11)
where 1 is an indicator function, Λ (ytk|hk) = p(ytk|hk,st=1)p(ytk|hk,st=0) , and ηk is equal to 1 in the initial step for all
k.
11
Q
(1)
0
(
s|s[i]) = E

log ∏
uˆ
(1)
m ∈Uˆ(1)
P
(
uˆ(1)m
∣∣ uˆ(0)m ,u(0)0 ,h, s) ∣∣∣Uˆ (1), Uˆ (0), s[i]


+ E
{
logP
(
Uˆ (0),h
∣∣∣s) ∣∣∣Uˆ (1), Uˆ (0), s[i]}
=
∑
uˆ
(1)
m ∈Uˆ(1)
E
{
logP
(
uˆ(1)m
∣∣ uˆ(0)m ,u(0)0 ,h, s) ∣∣∣Uˆ (1), Uˆ (0), s[i]}
+ E
{
logP
(
Uˆ (0),h
∣∣∣s) ∣∣∣Uˆ (1), Uˆ (0), s[i]} . (18)
p
(
h
∣∣∣Uˆ (1), Uˆ (0), s[i]) = P
(
Uˆ (1), Uˆ (0)
∣∣∣h, s[i]) p(h)∫
h
P
(
Uˆ (1), Uˆ (0)
∣∣∣h, s[i]) p(h)
=
∏
uˆ
(1)
m ∈Uˆ(1)
P
(
uˆ
(1)
m
∣∣∣ uˆ(0)m ,u(0)0 ,h, s[i])P (Uˆ (0),h∣∣∣s)
∫
h
∏
uˆ
(1)
m ∈Uˆ(1)
P
(
uˆ
(1)
m
∣∣∣ uˆ(0)m ,u(0)0 ,h, s[i])P (Uˆ (0),h∣∣∣s) . (19)
The fusion rule at the destination node in iteration j = 2 can again be formulated using the EM
algorithm. Here, the auxiliary function has the form
Q
(1)
0
(
s|s[i]) = E {logP (X(1)0 ∣∣∣s) ∣∣∣Uˆ (1), Uˆ (0), s[i]} (17)
Substituting (16) into (17) gives equation (18).
Obtaining the expectation of (18) requires the density function p
(
h
∣∣∣Uˆ (1), Uˆ (0), s[i]), which can be
obtained as equation (19).
The M-step can be acquired by maximizing the auxiliary equation, i.e.
s[i+1] = argmax
s
Q
(1)
0
(
s|s[i]) . (18)
III. JOINT DETECTION AND ESTIMATION FOR TWO-WAY RELAY NETWORKS
A. Problem statement and system model
Fig. 2 illustrates the considered TWRN, in which a relay node aids in relaying the messages sent from
the two source nodes. The transmission process of the TWRN can be divided into two phases. In the first
13
 
h1    
h1    
Relay  
S1   S2  
h2   
h2   
Fig. 2. A classic two way relay network.
B. Derivation of decision and estimation rules for TWRN
We begin to derive the joint detection and estimation rules at S1 using the EM algorithm. In the TWRN,
three unknown parameters have to be estimated, namely, the signal block d2 and fading channels a and
b. We further divide the parameters into two groups, namely, (b,d2) and a. The estimation of (b,d2) will
be given in Subsection III-B1, whereas the estimation of a will be discussed in Subsection III-B2.
1) Updating b and d2: According to the considered model, we define (y1, a,d1) and X = (y1, a, b,d1)
as the incomplete and complete data, respectively. During the process of the EM algorithm, the expectation
step of the EM algorithm requires an auxiliary function, which can be expressed as
Q
(
d2|d[k]2
)
= E
[
lnP (X|d2)|y1, a,d1,d[k]2
]
, (23)
where d[k]2 denotes the kth detection result of d2.
Since, at the (k + 1)th time, S1 can obtain the channel estimate aˆ[k] made at previous time k and
obviously it also knows its own data information d1, part of the received signal transmitted from S1 can
then be removed from y1, i.e.,
yˆ
[k+1]
S2
= y1 − β
√
P1aˆ
[k]d1
= β
√
P2bd2 + nS1 + β
√
P1 a d1︸ ︷︷ ︸
n
′
S1,a
, (24)
where a is the channel estimation error of a, and the subscript S2 means that we removed the terms
related to S1. We can rewrite the auxiliary function as
Q
(
d2|d[k]2
)
= E
[
lnP (X|d2)|yˆ[k+1]S2 ,d
[k]
2
]
, (25)
where the complete data X can be replaced by
(
yˆ
[k+1]
S2
, b
)
and the probability function P (X|d2) can be
15
Proof: See Appendix A.
Lemma 2: When the channel estimation error is very small, i.e., ∆a → 0, the PDF p
(
yˆ
[k+1]
S2
∣∣∣ b,d[k]2 )
can be written as the product of T complex Gaussian distribution, that is,
p
(
yˆ
[k+1]
S2
∣∣∣ b,d[k]2 ) = T∏
t=1
p
(
yˆ
[k+1]
S2,t
∣∣∣ b, d[k]2,t)
=
T∏
t=1
1
πσ2
n
′
S1,a
exp

−
∣∣∣yˆ[k+1]S2,t − β√P2bd[k]2,t∣∣∣2
σ2
n
′
S1,a

 , (31)
where yˆ[k+1]S2,t and d
[k]
2,t are the tth element of yˆ
[k+1]
S2
and d[k]2 , respectively, and σ
2
n
′
S1,a
= β2 |h1|2 σ2n + σ2n.
Proof: See Appendix B.
Lemma 2 is primarily based on the assumption that a is very small, i.e., the estimate of aˆ[k] is
very good. This approximation will be proven accurate when the noise is weak in accordance with the
simulation results obtained by this report (see Section V).
Substituting (26) and (31) into (25), we can obtain
Q
(
d2|d[k]2
)
=
T∑
t=1
E
{
ln p
(
yˆ
[k+1]
S2,t
∣∣∣ b, d2,t)∣∣∣ yˆ[k+1]S2 ,d[k]2 }+ E {b| yˆ[k+1]S2 ,d[k]2 }
=
T∑
t=1
E

 ln 1πσ2n′S1,a −
(
yˆ
[k+1]
S2,t
− β√P2bd2,t
)2
σ2
n
′
S1,a
∣∣∣∣∣∣∣ yˆ
[k+1]
S2
,d
[k]
2

+ E
{
b| yˆ[k+1]S2 ,d
[k]
2
}
, (32)
where p
(
yˆ
[k+1]
S2,t
∣∣∣ b, d2,t) is derived from (31) by replacing d[k]2,t with d2,t. By substituting (27) into (32) and
removing the terms that are not related to d2, we obtain
Q
′
(
d2|d[k]2
)
=
1
σ2
n
′
S1,a
T∑
t=1
{
E
[
b| yˆ[k+1]S2 ,d
[k]
2
]
β
√
P2d2,t
(
yˆ
[k]
S2,t
)∗
+ yˆ
[k]
S2,t
(
E
[
b| yˆ[k+1]S2 ,d
[k]
2
]
β
√
P2d2,t
)∗
− E
[
b2
∣∣ yˆ[k+1]S2 ,d[k]2 ] β2P2d22,t} , (33)
where the superscript ∗ denotes the complex conjugate operation and the term E
[
b2| yˆ[k+1]S2 ,d
[k]
2
]
β2P2d
2
2,t
can be ignored if the transmission signal d2,t has equal energy for all time t. The term E
[
b| yˆ[k+1]S2 ,d[k]2
]
can be interpreted as the minimum mean square error (MMSE) channel estimation of b given yˆ[k+1]S2 and
d
[k]
2 , i.e.,
bˆ[k+1] = E
[
b| yˆ[k+1]S2 ,d
[k]
2
]
. (34)
17
is approximated by
E
[(
n
′
S1,b
)2]
= E
[(
βh1nr + n1 + β
√
P1 b d1
)2]
≈ E
[
β2 |h1|2nrnHr
]
+ E
[
n1n
H
1
]
= σ2
n
′
S1,b
I, (40)
where we have dropped the term of channel estimation error b. As a result, the density function of ˆy[k+1]S1
given a and d1 can be expressed as
p
(
yˆ
[k+1]
S1
∣∣∣ a,d1) = T∏
t=1
p
(
yˆ
[k+1]
S1,t
∣∣∣ a, d1,t)
=
T∏
t=1
1
πσ2
n
′
S1,b
exp

−
∣∣∣yˆ[k+1]S1,t − β√P1ad1,t∣∣∣2
σ2
n
′
S1,b

 , (41)
where yˆ[k+1]S1,t and d1,t are the tth element of yˆ
[k+1]
S1
and d1, respectively. Substituting (38) and (41) into
(36), we can obtain the (k + 1)th estimate of a. The process of updating (b,d2) and a can be obtained
iteratively until convergence. The decision of d2 is then adopted as the final decision.
IV. SIMULATION RESULTS
A. Simulation Results for Cluster-Based Networks
This section evaluates the performance of the proposed detection and estimation scheme for the case
of data blocks comprising T = 100 symbols with BPSK modulation and a cooperative communications
network comprising three relay nodes (see Fig. 1). In performing the simulations, the fading channels
between the source node and the relay nodes are assumed to be time-invariant in each block. The
initialization conditions of the EM algorithm are critical since different initial points cause the system
to converge toward different local optima. Hence, a pilot bit is inserted into each block for estimation
purposes, and the estimated value is then used to initialize the EM algorithm.
Figure 3 plots the bit error rate (BER) of the cooperative communications network against the SNR.
Note that the BERs at the relays and destination node prior to feedback are denoted as “relay 1st” and
“destination 1st”, respectively, while the corresponding BERs after the global and local decisions are
transmitted over a BSC with a crossover probability of 0.001 are denoted as ”relay 2nd” and ”destination
2nd”, respectively. It is seen that the feedback process results in a significant reduction in the BER at
both the relay nodes and the destination node.
19
−5 0 5 10 15
10
−4
10
−3
10
−2
10
−1
10
0
SNR (dB)
M
S
E
 
 
relay ML
relay 1st
relay 2nd
CRLB
Fig. 4. MSE performance with channel estimation bound.
TABLE I
THE AVERAGE NUMBER OF EM STEPS AT THE RELAY NODES.
SNR(dB) -6 -3 0 3 6 9 12 15
Relay 1st 4.0667 3.5500 2.9689 2.5778 2.3434 2.1687 2.0738 2.0374
Relay 2nd 3.0309 2.6967 2.4631 2.2539 2.1475 2.0994 2.0971 2.0950
B. Simulation Results for TWRN
The performance evaluation of the proposed estimation and detection algorithms for TWRN is also
conducted by computer simulations. We consider that the source Si would like to transmit signal vector
di = {di,t}Tt=1 with uncoded binary phase shift keying modulation to the other source node via the
assistance of the relay node. The fading channels are assumed to be zero mean and unit variance. Without
loss of generality, the noise vectors at the relay node and source nodes are set to be zero mean with a
covariance matrix of IT . The transmission power of the source nodes and the relay are fixed as P2 = 2P1
and Pr = (P1 + P2) /2. In order to feed the derived algorithm with a better initial point, two orthogonal
bits are placed in the data block of the two source nodes. As a result, our scheme has higher bandwidth
efficiency and can gain 75 percent of bandwidth for the case of T = 8 compared with the training-based
channel estimation. When T is getting larger, our scheme can achieve much higher BW efficiency and
save (T − 2)/T BW for channel estimation in TWRNs.
Figs. 5 and 6 illustrate the mean square errors (MSEs) of the estimates of a and b, respectively, with data
21
0 5 10 15 20 25 30
10
−4
10
−3
10
−2
10
−1
10
0
10
1
 
 
P
2
 (dB)
M
S
E
 o
f 
b
CRLB (ρ = 0.75)
CRLB (ρ = 0)
EM
Fig. 6. MSE versus the transmission power of S2 for channel b with T = 8.
0 5 10 15 20 25 30
10
−4
10
−3
10
−2
10
−1
10
0
10
1
P
2
 (dB)
M
S
E
 o
f a
 
 
CRLB (ρ = 0.9375)
CRLB (ρ = 0)
EM
Fig. 7. MSE versus the transmission power of S2 for channel a with T = 32.
which generates some attenuation in the low SNR range. Moreover, the additional noise may alter the
distribution of n
′
S1,a
from being a simple complex Gaussian distribution. Notably, as mentioned in Lemma
2, we have made an assumption that the estimation error approachs zero when the noise power is very
small. According to the characteristics shown in Figs. 5 to 8, the simulation results are in line with the
assumption about estimation error approximation in Lemma 2.
Fig. 9 demonstrates the BER of the proposed scheme and the ML estimator provided in [33] for different
lengths of data under the same number of pilots. In this figure, two pilot bits are used to estimate the
23
0 5 10 15 20
10
−2
10
−1
10
0
P
2
 (dB)
B
E
R
 
 
ML (ρ
h
 = 0.9)
ML (ρ
h
 = 0.95)
EM
Fig. 10. BER of the proposed scheme and the training-based ML estimator for time varying channel.
used in [37] is adopted in this evaluation and is given by
hi (t) = ρhhi (t− TB) + e (t) , (43)
where ρh = E [hi (t) h∗i (t− TB)] /σ2h is the normalized correlation coefficient of channel; TB is the size
of static channel, which is equal to the length of the data block for this simulation; and e (t) is complex
Gaussian distribution with zero mean and variance
(
1− |ρh|2
)
σ2hi . For fair comparison, the ML estimator
[33] uses one training sequence with T = 8 pilots to estimate the CSI, and the results would then be
used for data detection in the subsequent three data blocks. For the proposed scheme, each data block
uses two orthogonal bits to obtain the CSI. From the simulation results, we can see that the error floor
phenomenon occurs in the performance of the ML estimator for both ρ = 0.9 and ρ = 0.95. By contrast,
the error floor phenomenon does not appear in the proposed scheme. In addition, the proposed EM-based
scheme has significantly better BER than the training-based estimator for most SNR ranges.
V. CONCLUSIONS
The first part of this report has proposed a joint distributed detection and estimation scheme based
upon an EM algorithm for cluster-based cooperative communications networks. Specifically, the joint
distributed detection and estimation rules are derived by using EM algorithm. The simulation results have
shown that the use of a feedback mechanism between the relay nodes and the destination node improves
both the channel estimation and data detection performance at the relay nodes and the BER performance
25
APPENDIX B
PROOF OF LEMMA 2
When ∆a → 0, (29) can be well approximated by
E
[(
n
′
S1,a
)2]
≈ E
[
β2 |h1|2nrnHr
]
+ E
[
n1n
H
1
]
= β2 |h1|2 σ2nI + σ2nI = σ2n′S1,aI. (46)
Since the noise at the relay and the source S1 are AWGN, the received signals yˆ
[k+1]
S2,t
, t = 1, . . . , T are
conditionally independent across receivers given d[k]2,t. Then we can derive p
(
yˆ
[k+1]
S2
∣∣∣ b,d[k]2 ) by
p
(
yˆ
[k+1]
S2
∣∣∣ b,d[k]2 ) = T∏
t=1
p
(
yˆ
[k+1]
S2,t
∣∣∣ b, d[k]2,t)
=
T∏
t=1
1
πσ2
n
′
S1,a
exp

−
∣∣∣yˆ[k+1]S2,t − β√P2bd[k]2,t∣∣∣2
σ2
n
′
S1,a

 . (47)
REFERENCES
[1] J. N. Laneman, D. N. C. Tse, and G. W. Wornell, “Cooperative diversity in wireless networks: Efficient protocols and outage behavior,”
IEEE Transactions on Information Theory, vol. 50, no. 12, pp. 3062–3080, December 2004.
[2] G. Kramer, M. Gastpar, and P. Gupta, “Cooperative strategies and capacity theorems for relay networks,” IEEE Transactions on
Information Theory, vol. 51, no. 9, pp. 3037–3063, September 2005.
[3] J. N. Laneman and G. W. Wornell, “Distributed space-time-coded protocols for exploiting cooperative diversity in wireless networks,”
IEEE Transactions on Information Theory, vol. 49, no. 10, pp. 2415–2425, October 2003.
[4] T. E. Hunter, S. Sanayei, and A. Nosratinia, “Outage analysis of coded cooperation,” IEEE Transactions on Information Theory, vol. 52,
no. 2, pp. 375–391, February 2006.
[5] A. Sendonaris, E. Erkip, and B. Aazhang, “User cooperation diversity part I and part II,” IEEE Transactions on Communications,
vol. 51, no. 11, pp. 1927–1948, November 2003.
[6] A. Nosratinia, T. E. Hunter, and A. Hedayat, “Cooperative communication in wireless networks,” IEEE Communications Magazine,
vol. 42, no. 10, pp. 74–80, October 2004.
[7] A. Høst-Madsen and J. Zhang, “Capacity bounds and power allocation for wireless relay channels,” IEEE Transactions on Information
Theory, vol. 51, no. 6, pp. 2020–2040, June 2005.
[8] R. S. Blum, “Distributed detection for diversity reception of fading signals in noise,” IEEE Transactions on Information Theory, vol. 45,
no. 1, pp. 158–164, January 1999.
[9] J. Hu and R. S. Blum, “Application of distributed signal detection to multiuser communication systems,” IEEE Transactions on
Aerospace and Electronic Systems, vol. 38, no. 4, pp. 1220–1229, October 2002.
[10] Z. J. Hass and C.-P. Li, “The multiply-detected macrodiversity scheme for wireless cellular system,” IEEE Transactions on Vehicular
Technoloy, vol. 47, no. 2, pp. 506–530, May 1998.
27
[31] H. Ding, J. Ge, D. B. da Costa, and Y. Guo, “Outage analysis for multiuser two-way relaying in mixed Rayleigh and Rician fading,”
IEEE Communications Letters, vol. 15, no. 4, pp. 410–412, April 2011.
[32] Y. Yang, J. Ge, and Y. Gao, “Power allocation for two-way opportunistic amplify-and-forward relaying over Nakagami-m channels,”
IEEE Transactions on Wireless Communications, vol. 10, no. 7, pp. 2063–2068, July 2011.
[33] F. Gao, R. Zhang, and Y.-C. Liang, “Optimal channel estimation and training design for two-way relay networks,” IEEE Transactions
on Communications, vol. 57, no. 10, pp. 3024–3033, October 2009.
[34] B. Jiang, F. Gao, X. Gao, and A. Nallanathan, “Channel estimation and training design for two-way relay networks with power
allocation,” IEEE Transactions on Wireless Communications, vol. 9, no. 6, pp. 2022–2032, June 2010.
[35] N. O’Donoughue and J. M. F. Moura, “On the product of independent complex gaussians,” IEEE Transactions on Signal Processing,
vol. 60, no. 3, pp. 1050–1063, March 2013.
[36] G. Tavares and L. M. Tavares, “On the statistics of the sum of squared complex gaussian random variables,” IEEE Transactions on
Communications, vol. 55, no. 10, pp. 1857–1862, October 2007.
[37] Y. Ma, D. Zhang, A. Leith, and Z. Wang, “Error performance of transmit beamforming with delayed and limited feedback,” IEEE
Transactions on Wireless Communications, vol. 8, no. 3, pp. 1164–1170, March 2009.
mƁ ĿėØ!ğUÖAsyîProfessor Sheng-Tzong ChengƁÕĿŷ·Energy-
Aware Multi-path Routing for Wireless Sensor Network with HolesƁ·¿ũwřĞ
Ţ¿«ŗèîĎŇaŷƀ
ſġ½
Ë½ŁģōİugHîyėØƁVyėß;9uVeŰ$íîč
żƀœÆî½ŁX²sieū½ŁƁ¿Æî,žƁß;ĞţXƉugHe}õ
Ɖy=čżƁś.šňıŌƀíĮîľ®ƁÌş¿^ńî¦Jƀ5·ġ½
yėdØş¿4Xî®Fĝ¹ƁCæØĦvƀ½Ł5zŴóèƁwŹ
žƁ]¦"î¸Źƀ
bſŁ
ĺ½ŁyėŨCß;ĦvƁTĞ·őMdƂs}¿4Xîĝ¹ƃƀœT¢ŏġ
ŨîņůƀŁƁe0¿½ŁTģĬiîeū½ŁƁb=%e}ØkúƁT 
yĭÄêŨîC»ØĦvƀ
ſ©cŃ¯YýP0~
c½Łľ®ŭƀ
3ſŪ
ľ®į¥RíĮ
s½ŀ¶®PíĮ
ľ®1®Ū²ĺl\ƀ
knowledge of channel state information. We also provide some
numerical examples to evaluate the performance of the considered
system.
Although the simulation results are shown, simulation assumptions
and analysis of the results are not enough. It is difficult to
understand the simulation assumptions and the results.
Although the variable gain scheme may has a potential gain,
it may require amplifiers with a large dynamic range. It should
also be considered in the paper.
There are some grammatical errors in the paper. More careful
review is required.
----------------------- REVIEW 3 ---------------------
PAPER: 83
TITLE: Performance Analysis of AF Cooperative Communications with Imperfect Channel Information
AUTHORS: Tsang Yi Wang, Chen Wan Tsung and Chao Tang Yu
OVERALL RATING: 2 (weak reject)
The simulation results clearly show improvement of capacity by the proposed variable gain. However, the clarity of
this paper is not enough. At first, it is not clarified in your paper what is difference between your paper and the
previous works [1-3] on performance analysis with imperfect channel estimation. Secondly, it is not clarified in your
paper what is problem with the conventional variable gain in [4] and what is solved with the proposed variable gain.
These points should be clarified.
  
 
Fig. 1. The cooperative communication system model. 
For the AF scheme, the estimation of the channel gain 
between between S and Ri obtained by LMMSE can be 
expressed as  
 
)((ˆ )(22
2
totsisist
vssht
sh
si vhPTPT
P
h +
+
=
σσ
σ
,    
(1) 
where Ps is the transmission power of the source, and 
)(totsiv is the noise of the link between S and Ri with power of 
2
vsσ .  
In the data transmission phase, the received signal vector ri 
at Ri can be expressed as 
isisi hhP αφ vsr ++= )ˆ(
,         
(2) 
where s is the transmitted signal vector of S, 
sihˆ represents the 
estimated channel gain stated in (1), hφ denotes the channel 
estimation error which is a Gaussian random variable with 
zero mean and variance α2, and vαi is a noise vector with each 
element drawn from the complex Gaussian distribution with 
zero mean and variance N0. Equation (2) can be rewritten as  
,
ˆ
)()(ˆ
ˆ
2121
sisis
iissis
issisi
hP
jjhhPhP
hPhP
vs
vvss
vssr
+=
++++=
++=
ααφφ
αφ
 (3) 
where vsi is a noise vector with each element drawn from the 
complex Gaussian distribution with zero-mean and variance 
00
ˆ NPN s +=α . After receiving signals, each relay forwards 
the received signal to the destination with either fixed gain or 
variable gain. For the variable-gain scheme, the amplifying 
gain 
viG  depends on the estimated channel gain and can be 
expressed as  
0
2
ˆˆ NhP
PG
sis
r
vi
+
=
       (4) 
where 
sihˆ  is the imperfect CSI from the source to Ri. For the 
fixed-gain scheme, the amplifying gain fiG  does not depend 
on the instantaneous CSI and is given by (see [4]) 
 
0
2
ˆNP
PG
hs
r
fi
+
=
σ
       (5) 
Let the signals transmitted by Ri be represented as 
ii Grx = , where viG=G or fiG=G for variable-gain and 
fixed-gain schemes, respectively. The received signal at the 
destination from Ri is then given by 
( ) iiidrid hhP αα ηxr ++= ˆ       (6) 
where Pr is the transmission power of the source, iαη is a 
noise vector with each element drawn from the complex 
Gaussian distribution with zero mean and variance 0N . By a 
straightforward derivation, we can obtain the received signal 
at the destination, which is given by 
,
ˆ
)()(ˆ
ˆ
2121
idisir
iiirisir
iirisird
hP
jjhhPhP
hPhP
vx
ηηxx
ηxxr
+=
++++=
++=
ααφφ
αφ
 (7) 
where vid is a noise vector with each element drawn form the 
zero mean complex Gaussian distribution with zero-mean and 
variance 0
2 NPG rvi +α . 
III Performance Analysis of AF Cooperative 
Communications  
In this section, the effect of channel estimation error on the 
AF cooperative communications is studied. In this work, the 
maximum ratio combining (MRC) scheme is adopted as the 
diversity combining method at the destination. Two 
performance measures, namely, the outage probability and the 
SNR gap ratio are derived to characterize the system 
performance.  
A. SNR gap ratio  
The SNR gap ratio defined in [1] is given by 
R =
γ (α=0) −γ (α≠0)
E γ (α=0)[ ] ,       (8) 
where 
0)( =αγ is the SNR at the destination when there is no 
hsL 
h1d 
h2d 
h3d 
hLd 
hs2 
hs3 
hs1 
S D 
R1 
R2 
RL 
R3 
. 
. 
. 
  
 
Fig. 2. Average SNR Gap Ratio for AF relaying scheme 
when α = 0.5. 
Figs. 3 and 4 show the simulation results of outage 
probability for perfect and imperfect CSI with fixed-gain and 
variable-gain AF schemes, respectively. As can be observed 
from the two figures, we can conclude that increasing the 
number of relays can improve the system performance in 
terms of outage probability. Fig. 5 shows the comparison of 
fixed and variable gain schemes. The comparison shows that 
fixed-gain scheme can provide a better performance in terms 
of outage probability. This result may be due to that variable 
gain Gvi contains the channel estimation sihˆ  which is not 
estimated accurately. Thus, in accordance with the outage 
probability, the AF cooperative communications with fixed 
gain outperforms the one with variable gain. 
 
Fig. 3. Outage probability for fixed gain relaying scheme with 
perfect and imperfect CSI. 
 
Fig. 4. Outage probability for variable gain relaying scheme 
with perfect and imperfect CSI. 
 
Fig. 5. Outage probability for AF relaying scheme (α = 0.5). 
V Conclusion 
In this paper, we have analyzed the performance of 
cooperative communication systems operating in an AF mode 
with imperfect knowledge of channel state information. We 
have derived the SNR gap ratio and outage probability for 
fixed-gain and variable-gain AF cooperative communication 
systems with imperfect channel knowledge. Numerical 
simulations have been carried out and the results show that 
the variable gain scheme is less sensitive to the channel 
estimation error when the SNR gap ratio is used as a 
performance metric. On the other hand, in accordance with 
the outage probability, the AF cooperative communications 
with fixed gain outperforms the one with variable gain. 
Besides, we have also observed that the performance of the 
AF cooperative systems with channel estimation error can be 
improved by increasing the number of relays.  
thγ  (dB) 
thγ  (dB) 
thγ  (dB) 
ĴëđīƄNSC 98-2221-E-110-043-MY3
ĴëYýƄè²WÙĐĔĎŇ
ĚW9­ÈÓġÓÏ>÷þ
8e_xYƄáĪ* ! !
ÀDÇÅPěýƄsyŔĵ @¬£!
½ŁƈŨƄ101  6 ¾ 17 ´Ġ 101  6 ¾ 20 ´!
½ŁgžƄStevens Institute of Technology, Hoboken, NJ, USA!
½ŁYý : 2012 IEEE 7th Sensor Array and Multichannel Signal Processing Workshop 
(SAM 2012)
íĮľ®ŷó:
1. Tsang-Yi Wang and Jwo-Yuh Wu, “Reliability-Based Detection for Decode-And-
Forward Relaying in Cooperative Communications,” the Seventh IEEE Sensor Array 
and Multi- channel Signal Processing Workshop (SAM 2012), June 17–20, 2012, 
Stevens Institute of Technology, Hoboken, NJ. (Invited paper)
2. Jwo-Yuh Wu, Chung-Hsuan Hu, and Tsang-Yi Wang, “Low-Overhead Cooperative 
Beamforming Under Imperfect Quantized SNR of Source-to-Relay Links,” the 
Seventh IEEE Sensor Array and Multichannel Signal Processing Workshop (SAM 
2012), June 17– 20, 2012, Stevens Institute of Technology, Hoboken, NJ.
ſOB½ŁčŘ
Â²6/16§ƅĨĤÿCI020îâÇ?ĖeƀœâÇ²ĖećĆƈŨKžI9Ô
ƈ=řĖeåŒŐÇmƁ§ƅgŦP×ŉ=řMarriott³Żƀ=řŸƁfŸ7
öÊœÊİíĮîľ®ƁÔ'TĞİāŎîaŷƀœ%³ŻT§gŦ=ŧ½g
žƁƁ-§Ê=ŧ½gž (Stevens Institute of Technology)Ɓ#¶¸ŵ<=řO
B½ŁÔ'îWelcome Receptionƀfreception dinnerƈ]ĸrqeyėCƁĶľ
yĭíŏÎƀ
6/18ìtµf³Żè|µŹƁô¥=½Łl=ƁŶQl=Ń¯ƁEZĹ6ª
¨Ɓġ½YÞƁŝ¿½Łľ®ŭƀŬLOB2mPlenary TalkƀĀmPlenary TalkÕĿė
Ø!ğħ:fŔĵĵīƉäűĩYîyėProf. Yonina EldarƁÕĿŷó>ØSub-
Nyquist Sampling: Performance Limits, Beamforming, and HardwareƁ·ó?R=
ršĲîoēQÆ ĭƁÙľ·øŽŊŽîŕƁÕĿėşĉÑ/ƀ Ām
Plenary TalkÕĿė>Ø!ğĖefDistributed DetectionűĩYîyėProf. Venugopal 
V. VeeravalliƁÕĿŷó>Øĺyė¼¿YîŶjQuickest Change Detection 
in Distributed Sensor Networks Ɓĺ ĭŮÚčíĮĸ	Ɓ·°îèÚƇ
ĕR=šĲƀf2mÕĿ
Ɓ>fcoffee breakƈŨ]ġ½yėęętƀď¥ĩOB
%ŷØSmart GridîsessionƁööó?Ŕĵ ĭfsmart gridÕüĳħƀ
ſġ½
Ë½Ł¼sîßħ·Invited talkmÊrƁKï2mƀœ·ĺ½Ł,ž
ƁT
¡¼ŏyĭê¿ĢŅî÷þŷƁŜĽÕĿî±[ãƁÍĥI9ťîľ®l\Ɓ
»ØĻòƀÑ/Ò8î±ƁàðGÒƀġ½yėƁşÛƁłÌ%½Łş¿O
ġƀ
bſŁ
ŁÜŞ9fUÖģĬîeū½ŁTnBŜĽÕĿîmÊƁfŠWķĒļûƁ
T yėyç»Ğ=¿èîŃĵƀSqƁăō½Łİ+ŢĞ±ÏƁ 
ġ½yėT¿vîCƁnBOġƀ
ſ©cŃ¯YýP0~
c½Łľ®ŭƀ
3ſŪ
ľ®į¥RíĮ
s½ŀ¶®PíĮ
ľ®1®Ū²ĺl\ƀ
Reliability-Based Detection for
Decode-And-Forward Relaying in Cooperative
Communications
Tsang-Yi Wang
Institute of Communications Engineering
National Sun Yat-sen University
Kaohsiung, Taiwan
Email: tcwang@faculty.nsysu.edu.tw
Jwo-Yuh Wu
Department of Electrical Engineering
National Chiao Tung University
Hsinchu, Taiwan
Email: jywu@cc.nctu.edu.tw
Abstract—This paper considers the decode-and-forward (DF)
relaying scheme in cooperative communication networks. Specif-
ically, this study considers a cooperative network, in which each
relay can obtain perfect channel state information (CSI) from
the source to itself, and the destination can acquire perfect
CSI from all the relays to itself, but the destination does not
need all CSI from the source to all participating relays. For the
considered semi-blind model, we propose a quantized reliability-
relaying (QRR) scheme, in which each relay quantizes the value
of the log-likelihood ratio (LLR) into three levels and forwards
the message to the destination if the LLR value falls into the
“send +1” and “send -1” regions, and keeps silent if the LLR
value falls into the “no-send” region. Under the semi-blind model
and the same average power constraint imposed at each relay,
we compare the QRR scheme with the traditional DF scheme.
Through the theoretical analysis, the work shows that the QRR
scheme outperforms the traditional DF scheme. The simulation
results also agree with the theoretical analysis.
I. INTRODUCTION
Cooperative communications, in which multiple single-
antenna relay terminals assist the source in transmitting their
information to the destination, provides an effective means
of increasing the spatial diversity within communication net-
works [1]–[4]. This paper considers the decode-and-forward
(DF) relaying scheme, in which each relay decodes the re-
ceived information and then regenerates a new message and
forwards it toward the destination. In many applications, since
the relays may not be able to perform channel decoding due to
lack of knowledge of the channel book or limited transceiver
capabilities, the DF scheme also applies to the scenario, in
which the received signals at the relays is only detected or
demodulated on a symbol-by-symbol manner. Therefore, when
the DF scheme is mentioned in this paper, it is referred to as
the DF relaying scheme in uncoded systems.
Most earlier works in the literature mainly focus on the
error performance and diversity order analysis in various
cooperative networks under the assumption that the channel
state information (CSI) at each relay and all CSI at the des-
tination are known. Recently, some works have been devoted
to considering the blind relay networks [5], [6], in which
the relays do not have any CSI, including the CSI between
the source to each relay and the CSI between each relay
to the destination. This study considers a different scenario
than the one requiring all CSI and the one using blind relay
networks. Specifically, in our considered model, each relay
can obtain perfect CSI from the source to itself, and the
destination can acquire perfect CSI from all the relays to
itself. However, the destination does not need all CSI from
the source to all participating relays. The considered model
is more realistic as compared with the system assuming the
availability of all CSI and the system with all blind relay. In the
cooperative communications requiring all CSI, not only more
communication resource but also, more importantly, significant
modifications of hardware and software which has been built
for traditional point-to-point communications at almost all
layers of the network are required [7]. On the other hand, the
cooperative communications using blind relays do not use any
channel estimation hardware and software built in traditional
non-cooperative communication transceiver, which assumes a
too simple model.
For the considered semi-blind model, we propose a quan-
tized reliability-relaying (QRR) scheme, in which each relay
quantizes the value of the log-likelihood ratio (LLR) into three
levels and forwards the quantized message to the destination
if the LLR value falls into the “send +1” and “send -1”
regions, and keeps silent if the LLR value falls into the “no-
send” region. Under the same semi-blind model and the same
average power constraint imposed at each relay, we compare
the QRR scheme with the traditional DF scheme. Through
the theoretical analysis, the work shows that the QRR scheme
outperforms the traditional DF scheme. The simulation results
also agree with the theoretical analysis.
The remainder of this paper is organized as follows. Sec-
tion II describes the system model of the considered semi-
blind relaying networks. Section III introduces the proposed
QRR scheme. Section IV presents the results of simulations
designed to quantify the performance of the proposed QRR
scheme. Finally, Section V presents some brief concluding
remarks.
2012 IEEE 7th Sensor Array and Multichannel Signal Processing Workshop (SAM)
978-1-4673-1071-0/12/$31.00 ©2012 IEEE 165
III. QRR SCHEME
A. Design of QRR
Since the output SNR for the DF-relaying scheme is difficult
to define, in developing the QRR scheme, this paper adopts
the deflection coefficient [8], which is widely used as a
performance measure in detection theory and has the same
concept of the output SNR. For a given relay-to-destination
CSI 품, the conditional deflection coefficient is given by
푑2def :=
(E풙,풘[푧∣푠 = +
√
푃푠, 품]−E풙,풘[푧∣푠 = −
√
푃푠, 품])2
Var풙,풘[푧∣푠 = −
√
푃푠, 품]
.
(6)
It can be shown that
E풙,풘[푧∣푠 = +
√
푃푠, 품] =
푀∑
푖=1
훼푖E[푢푖∣푠 = +
√
푃푠, 푔푖]
=
푀∑
푖=1
훼푖푔푖(2푝+ 푞 − 1)
√
푃푟
1− 푞 . (7)
Similarly, we have
E풙,풘[푧∣푠 = −
√
푃푠, 품] =
푀∑
푖=1
훼푖푔푖(1− 2푝− 푞)
√
푃푟
1− 푞 . (8)
In addition, the variance of 푧 given 품 and 푠 = −√푃푠 can be
obtained as
Var풙,풘[푧∣푠 = −
√
푃푠, 품]
= E풙,풘
[
∣푧∣2∣푠 = −
√
푃푠, 품
]
−
(
E풙,풘
[
푧∣푠 = −
√
푃푠, 품
])2
=
푀∑
푖=1
∣훼푖∣2
(
∣푔푖∣2푃푟
(
4푝(1− 푝− 푞)
1− 푞
)
+ 휎2푤
)
. (9)
It immediately follows from (6), (7), (8), and (9) that
푑2def =
(∑푀
푖=1 2훼푖푔푖(2푝+ 푞 − 1)
√
푃푟
1−푞
)2
∑푀
푖=1 ∣훼푖∣2
(
∣푔푖∣2푃푟
(
4푝(1−푝−푞)
1−푞
)
+ 휎2푤
) . (10)
Denoting
휓푖 := 훼
∗
푖
√
∣푔푖∣2푃푟
(
4푝(1− 푝− 푞)
1− 푞
)
+ 휎2푤
and
휙푖 :=
2푔푖(2푝+ 푞 − 1)
√
푃푟
1−푞√
∣푔푖∣2푃푟
(
4푝(1−푝−푞)
1−푞
)
+ 휎2푤
,
and applying the Cauchy-Schwartz inequality, we obtain
푑2def ≤ 푑2def,opt, (11)
where
푑2def,opt :=
푀∑
푖=1
휙2푖 =
푀∑
푖=1
4∣푔푖∣2푃푟(2푝+ 푞 − 1)2
4∣푔푖∣2푃푟푝(1− 푝− 푞) + 휎2푤(1− 푞)
.
(12)
By the Cauchy-Schwartz inequality, the equality in (11) holds
when 휓푖 = 푐휙푖, where 푐 is a constant. Thus, the optimal
combining coefficient 훼MDC,푖 that gives the maximum value
of 푑2def is given by
훼MDC,푖 =
2푐푔∗푖 (2푝+ 푞 − 1)
√
푃푟
1−푞
∣푔푖∣2푃푟
(
4푝(1−푝−푞)
1−푞
)
+ 휎2푤
.
B. Theoretical result
In the following, we prove that the QRR scheme outper-
forms the traditional DF-relaying scheme in terms of the
deflection coefficient. The analysis commences by establishing
the lemma below to show the existence of a local optimum
푑2def attained at a nonzero 푞.
Lemma 1: If 푝(0) > 12 and
푝′(0) > max
1≤푖≤푀
−4∣푔푖∣
2푃푟푝(0) + 휎2푤(1 + 2푝(0))
4∣푔푖∣2푃푟 + 4휎2푤
, (13)
then the optimal 푞opt that gives the maximum value of 푑2def is
located at 0 < 푞opt < 1.
Proof: Due to the page limit, we only sketch the proof.
Firstly, it can be shown that
lim
푞→0 푑
2
def,opt ≥ lim푞→1 푑
2
def,opt.
It then suffices to show that lim푞→0 푑2def,opt increases when 푞
increases from zero, since this will guarantee the existence of
a local maximum attained at a nonzero 푞. It can be shown that
as long as 푝(0) > 12 and the condition given in (13) holds, then
lim푞→0
∂푑2def,opt
∂푞 > 0. Finally, the assertion then follows from
the fact that 푑2def,opt is a continuous function of the probability
푞.
Lemma 1 implies that if condition (13) holds, the QRR
scheme is better than the traditional DF-relaying scheme, since
the traditional DF-relaying scheme is the special case of QRR
with 푞 = 0. To further investigate the conditions for 0 <
푞opt < 1, the lemma below is provided.
Lemma 2: If the received signal model at each relay is
given in (1) and the breakpoints of the reliability quantizer
are set to be 휂푢 = −휂푙 = 휂, then 푝′(0) = − 12 .
Proof: When the received signal model at 푖th relay is
given in (1), the probabilities 푝 and 푞 can be respectively
expressed as
푝(휂) =
∫ ∞
휂
Eℎ푖
[
1√
휋∣ℎ∣휎푛 exp
{
−
(
푡− ∣ℎ∣2√푃푠
)2
∣ℎ∣2휎2푛
}]
푑푡,
(14)
and
푞(휂) =
∫ 휂
−휂
Eℎ푖
[
1√
휋∣ℎ∣휎푛 exp
{
−
(
푡− ∣ℎ∣2√푃푠
)2
∣ℎ∣2휎2푛
}]
푑푡.
(15)
167
Low-Overhead Cooperative Beamforming Under 
Imperfect Quantized SNR of Source-to-Relay Links 
 
Jwo-Yuh Wua, Chung-Hsuan Hua, and Tsang-Yi Wangb 
 
a. Department of Electrical Engineering, National Chiao Tung University, 
1001, Ta-Hsueh Road, Hsinchu, Taiwan; 
b. Institute of Communications Engineering, National Sun Yat-sen University, 
70, Lien-Hai Road, Kaohsiung, Taiwan 
 
Abstract-We consider a cooperative beamforming system with the 
amplify-and-forward protocol. To reduce the signaling overhead, each 
relay quantizes the SNR of the source-to-relay (S-R) link into one bit, 
which is then transmitted through a binary symmetric channel (BSC) 
with a known crossover probability to the destination. Given the set of 
the error-corrupted one-bit messages received at the destination, the 
beamforming design criterion is the maximization of the expected 
receive SNR, averaged over the conditional bit-flipping distributions of 
BSCs. We derive an analytic expression for the considered SNR metric, 
which is a complicated function of the beamforming weights. To 
facilitate analysis, we further derive a tractable lower bound for the 
conditional average SNR. By conducting maximization with respect to 
this lower bound, a closed-form sub-optimal beamformer can be 
obtained as a solution to a generalized eigenvalue problem. Computer 
simulations are used to illustrate the performance of the proposed 
scheme. 
 
Index Terms—Cooperative communications; amplify and forward; 
relay; beamforming; overhead reduction; quantization. 
 
I. INTRODUCTION 
 
Cooperative communications is a well-known technique for 
exploiting distributed spatial resource for performance 
enhancement in modern wireless networks [1-2]. To realize various 
performance gains benefiting from user collaboration, the channel 
state information (CSI) of the source-to-relay (S-R) and relay-to-
destination (R-D) links is needed at the relays/destination [1-2] in 
order to facilitate the design of efficient signal relaying schemes. 
As a result, communication overheads dedicated to link CSI 
transmission or feedback become necessary. Considering that 
energy efficiency is a critical demand in next-generation wireless 
systems, the reduction, or minimization, of intra-network 
communication is rather crucial. The development of low-overhead 
information relaying techniques therefore has been an emerging 
research topic [3-9]. Besides, almost all existing studies of 
cooperative communications rely on the idealized assumption that 
the transmission and reception of inter-node link CSI are perfect. 
However, such a design paradigm may not be realistic in many 
large-scale system scenarios. For example, in wireless sensor 
networks wherein small-size sensor nodes with limited power 
resources are deployed far away from the fusion center (FC), the 
transmission of the local CSI via wireless links to the FC could be 
subject to severe path loss and deep fading [10], resulting in 
distorted or even erroneous CSI received at the FC. Hence, in 
addition to the low-energy-consumption demand, designs of relay 
systems that further take account of imperfect CSI 
transmission/feedback are also of much importance. Such an issue, 
however, remains much to be investigated in the literature. 
This paper presents an original study of the aforementioned 
problem in the cooperative beamforming setup. We consider the 
cooperative beamforming scheme employing the amplify-and-
forward (AF) relaying protocol. To reduce the signaling overhead, 
each relay quantizes the signal-to-noise ratio (SNR) of the S-R link 
into one bit, which is then sent to the destination for beamforming 
design. Rather than assuming that the quantized bit is received at 
the destination without errors, we consider the general case that the 
one-bit message could be flipped by a binary symmetric channel 
(BSC) with a known nonzero crossover probability. Given the one-
bit messages received from all relays, the beamforming design 
criterion adopted at the destination is the maximization of the 
receive SNR averaged with respect to the conditional channel 
flipping distributions. A closed-form formula for the proposed 
SNR metric is first derived. The formula is seen to be a highly 
nonlinear function of the beamforming factors, and direct 
maximization of this objective function is quite difficult. For 
analytic tractability, we further derive a lower bound of the 
conditional average SNR that can be expressed as a generalized 
Rayleigh quotient [11]. By conducting maximization with respect 
to this lower bound, a closed-form suboptimal beamformer can be 
obtained as the solution to a generalized eigenvalue problem. 
Computer simulations are used to illustrate the performance of the 
proposed solution. The rest of this paper is organized as follows. 
Section II is the preliminary. Section III presents the main results 
of this paper. Section IV is the conclusion. 
 
II. PRELIMINARY 
 
A. Cooperative Beamforming System 
 
We consider the cooperative beamforming system, in which L  
relays employ the AF protocol to collaboratively transmit the 
common source signal [ ] { 1,1}x n    to the destination. The 
received signal at the ith relay is 
2012 IEEE 7th Sensor Array and Multichannel Signal Processing Workshop (SAM)
978-1-4673-1071-0/12/$31.00 ©2012 IEEE 425
       q|q r r
q
(g,h ,q) | q (g,h ,q) Pr(q | q)dq dqE H H  ¯  q¡ °¢ ±  
    ,        (3.1) 
where Pr(q q)  denotes the probability that q  is flipped into q . 
That is, the conditional average SNR is obtained by averaging over 
all possible transmitted q ’s given the received q . 
To fix the idea, let us define3 
                     
1
ˆ(q) q
L
l i i
i
S q q l

£ ²¦ ¦¦ ¦ ¤ »¦ ¦¦ ¦¥ ¼
   , 0 l Lb b ,             (3.2) 
which denotes the set consisting of all possible q ’s that differ 
from q  in exactly l bits; there are thus !
!( )!
L
l
L
C
l L l


 possible 
q ’s in (q)lS  . Associated with each q (q)lS  , we further collect 
all indices at which iq  differs from iˆq  to obtain 
                                  \ ^ˆ(q,q)l i iI i q qv  .                              (3.3) 
With (3.2) and (3.3), the conditional average SNR is given as 
                 r r
0 q (q)
(g,h ,q) Pr(q q) (g,h ,q)
l
L
dq dq
l S
H H
 
  

   ,           (3.4) 
where 
                     
(q,q) (q,q)
Pr(q q) (1 )
c
l l
k m
k I m I
p p
 
 ¬ ¬­ ­ ­ ­  ­ ­ ­ ­  ® ®
 
  
 ,           (3.5) 
and (q,q)clI   denotes the complement of (q,q)lI  . Through further 
manipulations an explicit formula of r(g,h ,q)dqH   is shown in the 
following theorem (details omitted due to space limitation). 
 
Theorem 3.1: The conditional average SNR (3.4) admits the 
following form 
1 2 1 1 2 1
2
1
1
r
20 1 1 1 1
1
1
( , , , )
(g,h ,q)
( , , , )l l l l
L
i l iL L L L L
i
dq L
l k k k k k k k
i i l
i
c l k k g
g d l k k
H
  

       

£ ²¦ ¦¦ ¦¦ ¦¦ ¦¦ ¦ ¤ »¦ ¦¦ ¦¦ ¦¦ ¦¦ ¦¦ ¦¥ ¼

    

"
 "
"
           (3.6) 
where 
            
1
1 ,
1 1
( , , , ) (1 ) ( )
j j
l l
i l k k r i i
j j
c l k k p p hI G S

 
 ¬­ ­ ­ ­ ®
 "  ,       (3.7) 
in which 
1
(1 )
L
l
l
pI

  and ( )G ¸  is defined in (2.6), 
                     
2
2 2
1 ,( , , , ) 1 ( )
w
i l r i i
d
d l k k h
P
TG S  ¯ ¡ °¢ ±"  ,              (3.8) 
and 
                          
= 1  
            , otherwise.
1 2, , , ,
t
li i
i
i
q q i k k k
q
S
£¦  ¦¦¤¦¦¦¥
  "


                    (3.9) 
                                                                                                     ʳϭʳ
  To maximize the conditional average SNR r(g,h ,q)dqH   given in 
(3.6) with respect to the beamforming weights ig ’s, we shall first 
 
 3. The notation   denotes the binary addition operation. 
rewrite r(g,h ,q)dqH   in a more tractable form. Through further 
rearranging the indices in the multiple summations in (3.6), 
r(g,h ,q)dqH   can be expressed as a single sum of Rayleigh 
quotients. This is established in the next theorem (details omitted 
due to space limitation). 
Theorem 3.2: Let r(g,h ,q)dqH   be defined in (3.6). Then we have 
                              
2
r
1
c g
(g,h ,q)
g D g
H
M m
dq H
m m
H

  ,                       (3.10) 
in which 
0
L
L
l
l
M C

  , and, for each4 1 m Mb b , 
                          1 1 1c [ ( , , , ) ( , , , )]
H
m l L lc l k k c l k k " " " ,            (3.11) 
                    \ ^1 1 1D ( , , , ), , ( , , , )m l L ldiag d l k k d l k k " " " ,     (3.12) 
for certain 1, , , ll k k" . Given a particular set of indices 1, , , ll k k"  
in the multiple summations in (3.6), the corresponding index m  in 
(3.10) is determined according to 
         
0
0 1
11 1
1
0 1 1
( ) ( )
kl l L sL
s l l l
s s k
m l C C k k
M
M
M M
M
M
E

  
 
   
       ,   (3.13) 
where 0 0k   and ( )E ¸  denotes the Kronecker delta function.     ϭ 
                                                                                                     
Based on (3.10), the beamforming weights can be obtained by 
solving the following optimization problem 
                    Maximize       s.t. 
2
2
21
c g
g
g D g
H
M m
dH
m
m
P

 .            (3.14) 
where dP  denotes the total transmit power. However, since the 
cost function in (3.14) is a highly nonlinear function of g , a 
closed-form solution to (3.14) is hard to find. This thus motivates 
us to devise alternate approaches to finding (possibly suboptimal) 
beamforming weights. 
 
B. Closed-Form Suboptimal Solution 
 
  To facilitate analysis, we go on to derive in the following theorem 
a tractable lower bound for r(g,h ,q)dqH  . By conducting 
maximization with respect to this lower bound, we can then obtain 
a closed-form suboptimal solution (details omitted due to space 
limitation). 
Theorem 3.3: Let cm  and Dm  be defined in (3.11) and (3.12). 
The following inequality holds: 
                              
2
1
c g g cc g
g D g g Dg
H H HM m
H H
m
m

p ,                             (3.15) 
where 
1
c c
M
m
m
  and 
1
D D
M
m
m
 .                                         ʳϭ 
With the aid of (3.15), a suboptimal beamformer can be obtained 
based on maximization of the lower bound derived in (3.15): 
 
4. The dependence of the index m  in (3.10) on 1, , , ll k k"  is omitted to 
simplify notation. 
427
國科會補助計畫衍生研發成果推廣資料表
日期:2012/10/08
國科會補助計畫
計畫名稱: 應用於合作式無線中繼網路之聯合分散式檢測與估測法則研究
計畫主持人: 王藏億
計畫編號: 98-2221-E-110-043-MY3 學門領域: 通訊
無研發成果推廣資料
其他成果 
(無法以量化表達之
成果如辦理學術活
動、獲得獎項、重要
國際合作、研究成果
國際影響力及其他
協助產業技術發展
之 具 體 效 益 事 項
等，請以文字敘述填
列。) 
無 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
