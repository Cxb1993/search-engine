 2
參數對加工件表面粗糙度的影響，其以 ANFIS 方法
準確地建立灰度值的空間頻率、算術平均值及標準
差與加工件表面粗糙度間的關係。Bekir[10]提出
CO2 雷射加工之功率、進給速度等切削參數對其切
削質量的影響。Carlos 等人[11]建立一 CO2 雷射切
割深度之數學模型，該模型輸入參數為輸入功率、
光點直徑與進給速率。功率 100W 與速度 10(mm/s)
至 65(mm/s)時，其預測切削深度的誤差小於 17.8%。
Caydas等人[12]使用ANFIS建模放電加工粗糙度、
脈衝時間、開路電壓間之關係式，準確預測放電加
工過程造成的表面粗糙度現象與白層厚度。
Alimardani[13]等人使用 ANFIS 預測雷射加工固體
曲面的深度，以雷射脈衝能量、雷射脈衝數與切削
速率預測雷射切削深度，訓練後結果表明預測平方
根誤差為 0.11mm，百分比誤差為 0.07%。故本文以
視覺檢測應用於雷射切割機在不同工作參數包含
進給速率、切削功率之切割深度特性評估，並採用
ANFIS 建模雷射加工深度、進給速率與雷射電源功
率間之關係式，以克服系統之時變與非線性的特性，
並發展一 ANFIS 雷射電源控制器，使雷射機台能準
確控制雷射加工深度。 
 
三、視覺系統檢測雷射切削深度 
本文使用的雷射管瓦數為 60w，其工作週期與
電源功率近似成正比，故對電源控制器來控制其功
率之工作週期對加工物件切削。本文使用壓克力板
於雷射加工機下切削，其切削參數為：進給速率
(10mm/s~80mm/s)、電源功率工作週期(20%~80%)
來進行雷射切削深度的取樣，基於切削參數組合，
獲得 216 組數據(1~107 共 107 組訓練數據庫與
T1~T9 共 9 組檢測數據庫)，如表 1 所示。視覺系統
檢測雷射切削深度包括一個 CCD 和適當的照明，
影像擷取訊號分辨率為 1300×1200，1/30 秒擷取速
度，和 8 位元圖像灰階輸出至電腦做數位影像分
析。 
圖 1、雷射切削深度的檢測影像 
表 1、雷射切削深度檢測數據 
 V (mm/s) 
P 
(%60W) 
D 
(mm) 
1 10 80 3.994 
2 10 75 3.588 
3 10 70 3.574 
4 10 65 3.447 
5 10 50 2.803 
6 10 55 2.887 
7 10 45 2.705 
8 10 40 2.600 
9 10 35 2.400 
10 10 30 2.298 
11 10 25 2.226 
12 10 20 2.030 
13 20 80 2.088 
14 20 75 2.000 
15 20 70 1.948 
16 20 65 1.928 
17 20 50 1.612 
18 20 25 1.275 
19 20 45 1.528 
20 20 60 1.800 
21 20 35 1.357 
22 20 30 1.329 
23 20 20 1.137 
24 30 80 1.247 
25 30 75 1.149 
26 30 70 1.107 
27 30 65 0.967 
28 30 60 0.925 
29 30 55 0.855 
30 30 50 0.757 
31 30 45 0.690 
32 30 40 0.660 
33 30 35 0.619 
34 30 25 0.548 
35 30 20 0.491 
36 40 80 1.093 
37 40 75 0.912 
38 40 70 0.899 
39 40 65 0.837 
40 40 60 0.813 
41 40 55 0.780 
42 40 50 0.729 
43 40 45 0.685 
44 40 35 0.575 
45 40 30 0.547 
46 40 25 0.512 
47 40 20 0.420 
48 50 80 0.715 
49 50 75 0.701 
50 50 70 0.689 
51 50 65 0.673 
52 50 60 0.655 
53 50 55 0.631 
54 50 45 0.561 
55 50 40 0.530 
56 50 35 0.434 
57 50 30 0.401 
 4
V
1
m


.
..
...
.
.
.
N
N
.
.
.
11
w
.
.
.
1w
Layer 1 Layer 2 Layer 3 Layer 4 Layer 5

11 fw
V
V
P
1P
nP
mnw mnw mn
mnmnfw
D
V     P 
V    P 
 
圖 2、ANFIS 架構圖 
 
第一層：輸入模糊化層，將明確輸入值經由前件部
隸屬函數模糊化轉換得出模糊隸屬度。本層每一節
點內存在一節點函數(隸屬函數)。 
nkPO
mkVO
k
k
Pmk
Vk
,,1      )(
,,1          )(
,1
,1




 

 (1) 
其中 V,P 為節點的輸入，而 Vk,Pk 分別為 V,P 之隸
屬函數第k組模糊集合，即第一層函數輸出值 kO ,1 ，
nmk  ,,1  為前件部的隸屬函數。我們使用鈴鐺
型隸屬函數時，  ,1 kO  
nmk
a
cZ
Z
kZ
kZ
k
k b
Z
Z




 

,,1
,
1
1)( 2


 
(2) 
其中 Z{V,P}為輸入參數，而 kZa , kZb , kZc 為前
件部參數。 
第二層：模糊推論規則庫層，由規則庫之對應關係，
利用第一層所輸出的歸屬函數值來作第二層權重
函數的輸出值。 
mnknjmi
PVwO
ji PVkk
,1,,,1,,1
)()(,2
 

，，

 
(3)
第三層：正規化激發強度層 
mnk
www
wwO
mn
k
kk
,,1
,,
21
3



  (4)
第四層：解模糊化層，將正規化激發強度值 kw 與
後件部函數歸納得到解模糊化。  
mnk
rPqVpwfwO kkkikkk
,,1
,,4


 (5) 
其中 kw 為第三層的輸出， kp , kq , kr 為後件部參
數。 
第五層：為計算第四層中網路類神經元輸出值的總
合，以作為整個系統最後網路的輸出值。 


 mn
k
kk fwDO
1
1,5  (6) 
定義誤差 e及誤差函數 E  
DDe d   (7) 
22
2
1
2
1 eDDE d   (8) 
其中 dD 為系統期望位置，D 為實際輸出位置，
ANFIS 系統會調整後件部參數，使誤差函數 E 達到
最小。 
 
五、雷射切削深度模型與預測結果 
針對壓克力材料對於不同雷射切削參數所量
測的雷射切削深度訓練資料庫如表 1 所示之 1~107
共 107 組數據，設 m=4, n=6，經由 ANFIS 建模，
可得表 2 之前件部參數(共 3×(4+6)=30 個)，與表 3
之後件部參數(共 3×4×6=72 個)。建模與測試結果如
表 4 所示，其中測試數據如表 1 所示之 T1~T9 共 9
組數據， D 為建模估測的雷射切削深度。使用
ANFIS 建模估測之雷射切削深度與實際影像量測
之雷射切削深度的關係圖如圖 3 所示，其中 x 軸為
ANFIS 推估出來的雷射切削深度，y 軸為影像量測
的實際雷射切削深度。建模結果的均方根誤差為
0.009mm，最大絕對誤差為 0.038mm，最大相對誤
差為 4.73%，平均相對誤差值為 0.6%。為了進一步
確認的估計的準確性，量測驗證數據資料共 9 組列
於表 1 中 T1~T9 組數據，並使用 ANFIS 推估驗證
數據的雷射切削深度，驗證數據結果列於表 4 中
T1~T9 組測試結果。測試結果之均方根誤差為
0.013mm，最大絕對誤差為 0.036mm，最大相對誤
差為 2.33%，平均相對誤差為 0.85％。圖 4 所示為
驗證數據之估測雷射切削深度與實際影像量測雷
 6
56 0.450 0.016 3.69 
57 0.402 0.001 0.25 
58 0.360 -0.008 -2.17
59 0.301 0.007 2.38 
60 0.471 0.002 0.43 
61 0.452 -0.006 -1.31
62 0.449 0.001 0.22 
63 0.433 0.005 1.17 
64 0.395 -0.001 -0.25
65 0.379 -0.005 -1.30
66 0.371 0.007 1.92 
67 0.363 0.013 3.71 
68 0.322 -0.016 -4.73
69 0.316 0.000 0.00 
70 0.299 0.009 3.10 
71 0.253 -0.007 -2.69
72 0.416 0.000 0.00 
73 0.400 0.002 0.50 
74 0.378 0.000 0.00 
75 0.364 0.000 0.00 
76 0.351 0.001 0.29 
77 0.341 0.001 0.29 
78 0.318 -0.001 -0.31
79 0.295 -0.002 -0.67
80 0.282 0.002 0.71 
81 0.269 0.001 0.37 
82 0.251 -0.001 -0.40
83 0.228 0.000 0.00 
84 0.363 -0.001 -0.27
85 0.351 0.001 0.29 
86 0.315 0.000 0.00 
87 0.379 0.001 0.26 
88 0.266 0.000 0.00 
89 0.238 0.000 0.00 
90 0.210 0.000 0.00 
91 0.197 0.001 0.51 
92 1.805 -0.001 -0.06
93 0.905 0.001 0.11 
94 0.348 0.004 1.16 
95 0.267 -0.003 -1.11
96 0.243 -0.002 -0.82
97 0.207 0.002 0.98 
98 0.180 0.002 1.12 
99 0.146 -0.002 -1.35
100 1.337 0.001 0.07 
101 0.635 -0.001 -0.16
102 0.233 -0.001 -0.43
103 0.159 0.002 1.27 
104 0.148 0.000 0.00 
105 0.122 0.000 0.00 
106 0.108 -0.001 -0.92
107 0.081 0.001 1.25 
T1 3.204 -0.036 -1.11
T2 1.471 0.000 0.00 
T3 1.138 -0.002 -0.18
T4 0.584 -0.006 -1.02
T5 0.638 0.007 1.11 
T6 0.602 0.012 2.03 
T7 0.417 0.001 0.24 
T8 0.391 0.003 0.77 
T9 0.293 -0.007 -2.33
 
圖 3、建模之估測與實際雷射切削深度關
係圖 
 
圖 4、驗證數據之估測與實際雷射切削深
度的關係圖 
圖 5、建模之結果圖。 
 
0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
 8
20 25.901 0.901 3.60 
21 45.243 0.243 0.54 
22 59.450 -0.550 -0.92
23 33.834 -1.166 -3.33
24 31.190 1.190 3.97 
25 18.711 -1.289 -6.45
26 15.511 0.511 3.41 
27 9.870 -0.130 -1.30
28 80.028 0.028 0.04 
29 73.998 -1.002 -1.34
30 71.455 1.455 2.08 
31 63.166 -1.834 -2.82
32 60.683 0.683 1.14 
33 56.594 1.594 2.90 
34 50.067 0.067 0.13 
35 43.749 -1.251 -2.78
36 40.288 0.288 0.72 
37 34.985 -0.015 -0.04
38 25.618 0.618 2.47 
39 19.550 -0.450 -2.25
40 15.650 0.650 4.33 
41 9.599 -0.401 -4.01
42 80.482 0.482 0.60 
43 72.476 -2.524 -3.37
44 71.218 1.218 1.74 
45 64.120 -0.880 -1.35
46 60.978 0.978 1.63 
47 56.536 1.536 2.79 
48 49.703 -0.297 -0.59
49 44.306 -0.694 -1.54
50 32.772 -2.228 -6.37
51 30.012 0.012 0.04 
52 26.662 1.662 6.65 
53 18.845 -1.155 -5.78
54 13.833 -1.167 -7.78
55 11.311 1.311 13.11
56 79.558 -0.442 -0.55
57 74.510 -0.490 -0.65
58 70.419 0.419 0.60 
59 65.469 0.469 0.72 
60 60.463 0.463 0.77 
61 54.885 -0.115 -0.21
62 44.663 -0.337 -0.75
63 42.117 2.117 5.29 
64 34.728 -0.272 -0.78
65 31.150 1.150 3.83 
66 27.158 2.158 8.63 
67 18.523 -1.477 -7.38
68 14.300 -0.700 -4.67
69 9.901 -0.099 -0.99
70 79.182 -0.818 -1.02
71 74.585 -0.415 -0.55
72 70.330 0.330 0.47 
73 63.368 -1.632 -2.51
74 53.013 -1.987 -3.61
75 49.224 -0.776 -1.55
76 43.753 -1.247 -2.77
77 39.969 -0.031 -0.08
78 36.769 1.769 5.05 
79 31.661 1.661 5.54 
80 26.079 1.079 4.32 
81 20.805 0.805 4.03 
82 14.144 -0.856 -5.71
83 9.785 -0.215 -2.15
84 82.104 2.104 2.63 
85 74.086 -0.914 -1.22
86 65.951 0.951 1.46 
87 60.600 0.600 1.00 
88 55.436 0.436 0.79 
89 51.862 1.862 3.72 
90 44.704 -0.296 -0.66
91 37.678 -2.322 -5.81
92 33.049 -1.951 -5.57
93 29.856 -0.144 -0.48
94 26.010 1.010 4.04 
95 21.084 1.084 5.42 
 10
5 40 0.631 0.620 -0.011 -1.74
6 50 0.590 0.599 0.009 1.53
7 60 0.410 0.397 -0.013 -3.17
8 70 0.380 0.370 -0.010 -2.63
9 80 0.300 0.320 0.020 6.67
 
圖 8、預期切削深度與實際切削深度的關係圖 
 
八、雷射點陣圖雕刻實作驗證建模的性能 
首先將輸入的原始圖檔利用影像處理技術使
其反白灰階化，係指原本由紅、綠、藍三原色依比
例混合而成的彩圖，轉換為介於黑色與白色之間的
灰階圖，轉換後的每一像素值由數值 0 到 255 之間
所表示，共計有 256 種變化，最亮為白色，以數值
0 表示之，最暗的顏色為黑色，以數值 255 表示，
介於黑色與白色之間的稱之為灰色，而灰色依明暗
的不同以數值 1 到 255 之間來表示之。將美女 Lena
的圖片轉換為反白灰階化之圖檔，設定雕刻速度為
30(mm/s)，雕刻深度範圍為 0.22(mm)至 1.4(mm)以
及反白灰階值為 135 以下雷射不予出光即代表越
亮得像素點不出光，黑色為最深的雕刻深度即代表
越反白灰階值越大輸出的功率工作週期越大。工件
雕刻時，將影像圖檔內容上的每一點像素值依序讀
取，結束一行的讀取後則換行反方向讀取，並將其
存取資料傳輸於控制系統，使 x-y 軸移動到加工點
時，雷射加工機的雷射頭會配合 ANFIS 電源控制
器控制雕刻功率的工作週期於 50mm*50mm 壓克
力板上進行雕刻或不雕刻。如圖 9 所示為圖檔第一
行反白灰階值透過 ANFIS 電源控制器於壓克力板
上雕刻的深度，其中圖檔第一行的反白灰階值範圍
為 0 至 150，對應的切削深度為 0.22mm 至
0.55mm，並將所需的雕刻深度於 ANFIS 電源控制
器運算出所需的雷射功率周期，並將於影像系統量
測此深度，量測結果深度範圍為 0.23mm 至
0.54mm，其雷射切削深度精度為在±0.03mm 以
內。將反白灰階化影像使用 2.5D 加工的方式，將
明暗之色彩對應到淺深的加工，而呈現立體之灰階
圖檔的加工成品如圖 10 所示為點陣圖檔雷射加工
成品圖。其中加工深度愈深，雷射輸出功率工作週
期愈高，以深淺度來表現灰階圖檔的明暗現象。 
圖 9、點陣圖於壓克力板上雕刻的深度 
圖 10、點陣圖檔雷射加工成品圖 
 
九、結論 
本文使用適應性類神經模糊推論系統(ANFIS)
進行 CO2 雷射加工機之雷射切削深度、雷射切削速
度、雷射切削功率工作週期間關係之建模。對於雷
射切削深度在 4mm 以內，進給速率 10~80mm/s，
雷射加工功率 80%(48W)以內時，雷射切削深度模
型的建模誤差在 0.038mm 以內，而測試誤差在
0.036mm 以內。而對於雷射加工功率工作週期模型
0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
 12
using computer vision methods. J Mater Process 
Technol 1991;28:265–74. 
[18] Galante G, Piacentini M, Ruisi VF. Surface 
roughness detection by tool image processing. 
Wear 1991;148:211–20. 
[19] Al-Kindi GA, Baul RM, Gill KF. An application 
of machine vision in the automated inspection of 
engineering surfaces. Int J Product Res 
1992;30(2):241–53. 
[20] Kiran MB, Ramamoorthy B, Radhakrishnan V. 
Evaluation of surface roughness by vision 
system. Int J Machine Tools Manufacture 
1998;38(5):685–90. 
[21] Min-Yen Yeh, Chin-Cheng Lee, Shan-Cheng 
Pan,Zong-Liang Chen, Chong-Min Wang and 
Rui-Tang Lee“Integrated System Design of 
PWM Application on Electrical Vehicle Driving 
and Battery Charger”, Kaohsiung County 
82445,Taiwan, pp 57. 
[22] W.C. So, C.K. Tse and Y.S. Lee, “A Fuzzy 
Controller for DC/DC Converters”, IEEE Power 
Electronics Specialists Conference, Taipei, June, 
1994. 
[23] C.H. Tso and J.C. Wu, “An Integrated Digital 
PWM DC/DC Converter”, IEEE ICECS 2000, 
vol. 1 , 2000, pp. 104-107. 
[24] Z. Lu, Z. Qian and Y. Zeng, “Reduction of 
Digital PWM Limit Ring with Novel Control 
Algorithm”, IEEE Applied Power Electronics 
Conference 2001, vol. 1, 1995, pp. 521-534. 
[25] G.S. Buji, “Optimum output waveforms in PWM 
inverters”, IEEE Trans. Ind. Applicat., vol. 
IA-16, no. 6, pp. 830-836, 1980. 
[26] I.J. Pitel, S.N. Talukdar and P. Wood, 
“Characterization of programmed waveform 
pulse width modulation”, IEEE Trans. Ind. 
Applicat., vol. 16, no. 5, pp. 707-715, 1980. 
[27] A. Kawamura, T. Haneyoshi and R.G. Hoft, 
“Deadbeat controlled PWM inverter with 
parameter estimation using only voltage sensor”, 
in IEEE PESC Conf. Rec., 1986, pp. 576-583. 
[28] Y. Nishida and T. Haneyoshi, “Predictive 
instantaneous value controlled PWM inverter for 
UPS”, in IEEE PESC Conf. Rec., 1992, pp. 
776-783. 
[29] S.L. Jung and Y.Y. Tzou, “Discrete 
sliding-mode control of a PWM inverter for 
sinusoidal output waveform synthesis with 
optimal sliding curve”, IEEE Trans. Power 
Electron., vol. 11, no. 4, pp. 567–577, 1996. 
[30] J.M. Retif, B. Allard, X. Jorda and A. Perez, 
“Use of ASIC’s in PWM techniques for power 
converters”, in IEEE IECON Conf. Rec., pp. 
683-688, 1993. 
[31] R.C. Seals, “Position feedback control with a 
‘smart’ controller based on an FPGA”, in IEE 
Colloquium on Stepper Motors and Their 
Control, pp. 6/1-6/3, 1994. 
[32] W.S. Carter, “The future of programmable logic 
and its impact on digital system design”, in IEEE 
Int. Conf. Computer Design: VLSI in Computers 
and Processors,  pp. 10-16, 1994. 
[33] A.M. Schultz, S.B. Lceb., A.H. Mitwalli, D.K. 
Jackson and G.C. Verghese. “A multirate digital 
controller for an electric vehicle battery charger”, 
IEEE Power Electronics Specialists Conference, 
Vol. 2, pp. 1919-1915, 1996. 
[34] A. Kawamura and T. Yokoyama, “Comparison 
of Five Different Approaches for Real Time 
Digital Feedback Control of PWM Inverters”, 
Conference Record of the IEEE Industry 
Applications Society Annual Meeting, pp. 
1005-1011, 1990. 
[35] Y.Y. Tzou, “DSP-Based Fully Digital Control of 
a PWM DC-AC Converter for AC Voltage 
Regulation”, IEEE Power Electronics Specialists 
無研發成果推廣資料 
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
無 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
國科會補助專題研究計畫成果報告自評表 
請就研究內容與原計畫相符程度、達成預期目標情況、研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）、是否適
合在學術期刊發表或申請專利、主要發現或其他有關價值等，作一綜合評估。
1. 請就研究內容與原計畫相符程度、達成預期目標情況作一綜合評估 
■達成目標 
□未達成目標（請說明，以 100字為限） 
□實驗失敗 
□因故實驗中斷 
□其他原因 
說明： 
2. 研究成果在學術期刊發表或申請專利等情形： 
論文：□已發表 ■未發表之文稿 □撰寫中 □無 
專利：□已獲得 ■申請中 □無 
技轉：□已技轉 ■洽談中 □無 
其他：（以 100字為限） 
3. 請依學術成就、技術創新、社會影響等方面，評估研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）（以
500字為限） 
針對特定材質，建模 CO2雷射切削深度與雷射功率、進給速率間之關係。應用至無框與半
框眼鏡切割上，目前洽談發展雷射 2.5D 攝影機台之技轉中。 
