重建方法之平均分類正確率為 90.6%，最高辨識率則為
98.7%；當太陽能模組包含 36 片(6×6)太陽能電池，而模組影
像大小為 1250×1250 像素時，平均檢測時間約為 1.08 秒。 
 
中文關鍵詞： 瑕疵檢測，電致發光，傅立葉轉換，獨立成份分析，太陽能
電池/模組 
英 文 摘 要 ： Solar cells that convert the photons from the sun to 
electricity are mainly based on crystalline silicon 
in the current market because it can generate good 
performance in usable lifespan and conversion 
efficiency among the currently available techniques. 
In this research, we will first propose a machine 
vision-based automatic identification for shop floor 
control in solar wafer manufacturing. The inherited 
unique pattern of each individual solar wafer is 
extracted using non-contact machine vision techniques 
without intruding and damaging the wafer. The second 
task of this research aims at defect inspection on 
solar cells and solar modules using 
electroluminescence (EL) imaging. A solar cell (or 
module) charged with varying electrical currents will 
emit infrared light whose intensity will be darker 
for intrinsic grain boundaries and extrinsic defects 
such as cracks, breakages and broken fingers in the 
sensed image. The EL image of a solar cell presents 
also a heterogeneously textured pattern, which makes 
the defect detection task extremely difficult. 
英文關鍵詞： Defect detection, Fourier transform, Independent 
component analysis, Electroluminescence, Solar 
cell/module 
 
目錄 
 
目錄.............................................................................................................I 
一、中文摘要.............................................................................................II 
英文摘要..........................................................................................III 
二、計劃緣由與目的..................................................................................1 
三、研究方法..............................................................................................4 
3.1 多晶矽晶片識別方法................................................................4 
3.1.1小波轉換方法簡介................................................................................4 
3.1.2小波封包(Wavelet packet)轉換.............................................................6 
3.1.3Curvelet 轉換...................................................................................6 
3.1.4 第一代 Curvelet 轉換..........................................................................7 
3.1.5 第二代 Curvelet 轉換..........................................................................9 
3.1.6 灰階直方圖交叉比對法.....................................................................10 
3.1.7 梯度角方向直方圖交叉比對法.........................................................11 
3.2 多晶太陽能電池電致發光影像瑕疵檢測方法 ............................11 
3.2.1 二維快速傅立葉轉換........................................................................12 
3.2.2反傅立葉轉換(影像還原)............................................................13 
3.2.3偵測傅立葉頻譜上之瑕疵角度方向..................................................13 
3.2.4去除傅立葉頻譜頻帶.........................................................................15 
3.2.5影像相減.....................................................................................16 
3.2.6差異影像之閥值設定.........................................................................17 
3.3 Mean-shift平滑技術於多晶太陽能表面瑕疵檢測....................................17 
3.3.1 形態學(Morphology)影像前處理.....................................................18 
3.3.2 獨立成份分析(ICA)簡介............................................................19 
3.3.3ICA 前處理................................................................................20 
3.3.4快速 ICA( FastICA )演算法................................................................21 
3.3.5ICA 基底影像訓練及影像重建.........................................................21 
3.3.6 待測影像之基底重建.........................................................................22 
3.3.7 閥值的選擇與計算分類正確率.........................................................23 
四、實驗結果與討論...............................................................................24 
4.1 多晶矽晶片識別方法檢測結果..................................................................24 
4.2 多晶太陽能電池電致發光影像瑕疵檢測結果..........................................25 
4.3 多晶太陽能電池模組電致發光影像瑕疵檢測結果..................................25 
五、計畫成果自評....................................................................................27 
六、參考文獻............................................................................................28 
 
 I
英文摘要(Abstract) 
    Solar cells that convert the photons from the sun to electricity are mainly based 
on crystalline silicon in the current market because it can generate good performance 
in usable lifespan and conversion efficiency among the currently available techniques. 
In this research, we will first propose a machine vision-based automatic identification 
for shop floor control in solar wafer manufacturing. The inherited unique pattern of 
each individual solar wafer is extracted using non-contact machine vision techniques 
without intruding and damaging the wafer. The second task of this research aims at 
defect inspection on solar cells and solar modules using electroluminescence (EL) 
imaging. A solar cell (or module) charged with varying electrical currents will emit 
infrared light whose intensity will be darker for intrinsic grain boundaries and 
extrinsic defects such as cracks, breakages and broken fingers in the sensed image. 
The EL image of a solar cell presents also a heterogeneously textured pattern, which 
makes the defect detection task extremely difficult.  
This research involves three phases to complete in three years, which are: 
1) Year 1: Develop an encoding methods based on wavelet transform, wavelet packets 
and curvelet transform in the spectral domain and histogram matching of 
gray-level and gradient angles in the spatial domain are proposed to 
identify solar wafers to their corresponding ingot lots. In the spectral 
domain methods, wavelet decomposition, wavelet packets and curvelet 
transform are used to extract the feature vector of a solar wafer. The 
similarity between two compared wafers is then calculated by the 
Euclidean distance of their corresponding feature vectors. The experiments 
show that wavelet packets and curvelet transform have the best 
discrimination power to encode and identify solar wafers. The wavelet 
packets and curvelet transform can reach a 100% recognition rate for ingot 
lot identification. 
2) Year 2: This research focuses on defect detection of the multicrystalline solar cells 
in EL images. Since the finger interrupt and crack are line- or bar-shaped, 
the Fourier transform is used to eliminate suspected defects and results in a 
defect-free surface in the reconstructed image. By subtracting the 
reconstructed image from the original image, the defects can be distinctly 
enhanced in the difference image. Then, the defect is effectively segmented 
by a simple statistical control limit. In the experimental results of solar cell 
EL images, the Fourier transform reconstruction scheme can effectively 
detect fingers interrupt, micro-crack, and breakage. The average 
computation time is 0.29 seconds for a solar cell image of size 550×550 
pixels. 
3) Year 3: The Independent component analysis (ICA) is used to generate the basis 
images from defect-free solar cells. Each test image is reconstructed by a 
linear combination of the basis images. The accumulated gray-level 
difference between the test image and the reconstructed image is 
effectively used as a discrimination to detect the presence of defect in the 
solar cell subimages. The experimental results of solar module inspection 
show that the ICA image reconstruction method can provide up to 98.7% 
of correct classification. 
Keywords: Defect detection, Fourier transform, Independent component analysis, 
Electroluminescence, Solar cell/module 
 III
1. 鑄造多晶矽錠（Ingots）：使用的原料為多晶矽，主要運用鑄錠法（Block casting）
將熔融的矽鑄造固化而成。鑄錠法之流程技術為將多晶矽原料在石英坩堝融
化後，再將矽熔湯倒入另一鍍有氮化矽之方形石英坩堝中，接著液態的矽會
自坩堝底部往上凝固，當坩堝底部結晶固化後，固液界面會垂直往上移，而
產生柱狀的晶粒。因為每次鑄造出的多晶矽錠固化快慢程度不同，會導致每
次鑄造出的多晶矽錠其晶柱大小與形狀都不一樣。 
2. 切片：使用線切割技術將多晶矽碇裁切成每片 厚度的多晶矽晶片( Solar 
wafers )。 
3. 蝕刻及拋光：蝕刻的目的是去除切片製程中，因機械應力所造成的結構損傷
層，如果不去除損傷層會降低太陽能電池的轉換效率。而拋光的目的則是要
降低微粒（Particle）附著在多晶矽晶片表面。 
4. 清洗：使用離子水（DI water）去除多晶矽晶片表面的雜質污染物。 
5. 擴散：因為一般多晶太陽能晶片為 P 型基板，只要利用高溫熱擴散處理，使 P
型基版表面形成一層薄薄的 N 型半導體，就可將多晶矽太陽能板變成 P-N 二
極體。 
6. 網印或蒸鍍：將經過上述製程處理過的多晶矽晶片，使用銀膠印刷或是蒸鍍
方法，在其表面接出導電電極，即完成一片多晶太陽能電池（Solar cells）。 
7. 太陽能電池模組化：單一太陽能電池輸出功率太小，必須將多個太陽能電池
串聯（增加輸出功率）及並聯（提高輸出電壓）在一起而形成太陽能模組（Solar 
module）。電池之串接是將銅箔焊接在金屬電極上，而銅箔另一端則接到另
一片電池之背面，如此重複完成組裝。可將多片太陽能電池正反面加上高分
子塑膠保護層，並於正面加上強化玻璃以強化太陽能模組之安全性。 
 
 由於多晶矽太陽能板具製造成本低之優勢，且具光電轉換效能佳以及可用年
限長（Lifespan）之特性，目前仍為太陽能產業的主流產品，本研究將針對多晶
矽太陽能之多晶矽晶片（Polycrystalline silicon wafers）、太陽能電池（Solar cells）
以及太陽能模組（Solar modules）為主要研究對象。圖 1(a)為一個多晶太陽能晶
片影像，從圖中可觀察出多晶太陽晶片表面分佈眾多不規則且大小不一之晶格
（Grains），每一晶格之灰階也有相近或極大的差異，主要是因為多晶矽太陽能
晶片的矽原子排列方式不只一種，而是由多種不同排列方向的單晶隨機組合而
成，因此多晶太陽能晶片影像可視為一個異質性紋路表面（Heterogeneous 
texture）；圖 1(b)為一個完成網印步驟之太陽能電池（Solar cell）直接以 CCD 攝
影機所擷取的影像，其表面具有二條平行的金屬電極（稱為 Bus bars）以提供與
外界線路之接焊，以及一列極細的金屬手指（Fingers），或稱之格子線
（Gridlines），用於收集載子（Carrier）。太陽能電池影像除了具規律結構之格子
線外，多晶矽晶格仍呈現於表面背景中。相對於單晶矽太陽能板而言，多晶矽太
陽能板之瑕疵檢測具有極高的困難度，且目前之影像處理技術也大多集中於規律
性紋路的檢測，極少針對異質性紋路表面開發自動視覺檢測方法；而太陽能電池
 V
三、研究方法 
 本節將分別介紹計畫中各階段針對多晶矽太陽能電池識別與檢測所開發之
演算法。3.1 節將描述第一年使用機器視覺  (Machine vision)中之紋路分析 
(Texture analysis)技術對製程中之多晶矽太陽能晶片進行分類與識別，在頻率域
之方法上，應用小波轉換 (Wavelet transform)及 Curvelet 轉換技術萃取每張多晶
矽太陽能晶片影像之能量值指標向量 (Feature vector)並做同矽碇與不同矽碇間
之分類與辨識；3.2 節則描述第二年利用傅立葉轉換(Fourier transform)的重建影
像技術，將原始影像中之瑕疵消除，再藉由比較原始影像與還原影像之差異以區
分瑕疵在 EL 影像中之位置。；3.3 節說明第三年使用 ICA (Independent Component 
Analysis)為基之重建太陽能電池影像用以辨識大範圍多晶太陽能模組，訓練多晶
太陽能模組中正常之太陽能電池子影像的基底影像，並將每一待測太陽能電池之
子影像利用基底影像的線性組合做影像重建，計算原始測試影像與重建影像之總
差異值，即可有效判斷多晶矽太陽能模組中是否含有瑕疵太陽能電池之子影像。 
 
3.1 多晶矽晶片識別方法 
 
第一階段(第一年)計畫中，本研究在多晶碇經過鑄造製程處理後，每次鑄造
出的多晶矽碇其長晶過程因晶粒大小與形狀都不一且以隨機方式任意呈現於矽
碇中，因此每個矽碇之矽晶格樣式皆不相同。就同一矽碇而言，切割位置連續之
晶片則會有極為相似之晶格圖樣，圖 2 顯示三組來自不同矽碇之多晶矽太陽能晶
片影像，圖 2(a)-(c)為第一組三片連續且來自同一矽碇之多晶矽太陽能晶片影
像，(d)-(f)為第二組三片連續且來自同一矽碇之多晶矽太陽能晶片影像，而(g)-(i)
為第三組三片連續且來自同一矽碇之多晶矽太陽能晶片影像。觀察圖 2 可知，同
矽碇之多晶矽太陽能晶片具有相似之晶格分佈與圖樣。而在圖 2(a)、(d)與(g)之
不同矽碇的三個晶片中，其矽晶片表面之晶格圖樣則不相同且相互間有明顯的差
異存在。本研究依同矽碇之多晶矽太陽能晶片在影像中具有相類似之晶格圖樣及
不同矽碇之多晶矽太陽能晶片具有不同晶格圖樣之特性，利用機器視覺技術對晶
格圖樣進行分析，並做同矽碇與不同矽碇之多晶矽太陽能晶片的分類與識別。。 
 
3.1.1小波轉換方法簡介 
 
小波，即小區域的波，是一種特殊的長度有限、平均值為 0 的波。小波分析
法採用了一個能使局部化的窗函數：令 為一小波函數，其為一個帶通濾波器
(Band-pass filter)，且 
)( 1)(, a
bt
a
tba
                         (3-1-1) 
 
其中 )(, tba 稱為小波雛型(Wavelet prototype)，而 表尺度， 表位移，a b a1 用
以確保能量不變。式(3-1-1)可依信號性質做縮張或平移之動作，其所構成之視窗
能於高、低頻部份改變，在處理低頻訊號時使用較寬的時間區間但較小的頻域範
 VII
對角方向之細節影像 、 與 ，此四個子影像大小皆為原來影像之LHf HLf HHf 41 ，
對平滑子影像 再重複小波分解步驟可得到下一階更小之子影像。 LLf
)( j
HH
 
圖 3 為一個三階小波係數矩陣示意圖，藉由此可清楚了解到小波係數分佈的
情形與分佈大小。為了說明圖 3 之多尺度分析，茲選定圖 4(a)之圖型來對照比較
圖 3，圖 4(b)-(d)為 1 至 3 階 Haar 小波轉換圖型，圖 4 可以驗證小波轉換經多解
析分析後，影像大小未有改變，且對於解析部份可以清楚看出各細節部份所解析
出水平、垂直與對角部份等。 
 
3.1.2小波封包(Wavelet packet)轉換 
 
在實際之應用中，許多問題我們希望能在水平、垂直或對角之子影像得到更
多的資訊，而正交小波轉換的尺度僅針對平滑子影像 行下一階 (即 )
之小波分解，而沒對每個細節子影像空間進行分解。小波封包是將一組訊號依
Mallat 演算法與小波運算的結果 (Mallet, 1989a, 1989b)，即對每個細節子影像 
( 或 )進行下一階之小波分解，並獲得更細微的特徵描述。 
)( j
LLf 進 階1j
)()( , jHL
j
LH ff f
 
為了方便說明小波封包在每一階之分解結果，本研究令 代表平滑區域 
( )；
S
LL H 代表水平細節區域 ( LH )； 代表垂直細節區域 L )； D 代表對角
細節區域 (
V ( H
HH )。一張原始影像 )y 經一階小波封包轉換可得 )1(S 、 )1(H 、 )1(V
)1(
D ，如圖 5 所示，即一階小波封包轉換與一階小波轉換之結果相同。圖 6 為
二階小波封包轉換之小波係數矩陣示意圖，我們將分別對一階小波封包轉換之
、 、 和 的各別子區域再做小波轉換，並得到在不同尺度下更細微
之資訊。圖 6 中，我們將二階的小波係數表示為 )，其中 與b 分別表示一階
小波封包轉換之子影像與二階小波封包轉換之子區域，
,(xf f
, HS
f
}
f
和 f
)1(
Sf
)1(
Hf
)1(
V
)1(
Df f
2(
,baf a
{ , DV,,ba  。在三
階小波封包轉換中，我們分別將二階小波封包轉換後的每個子影像再做小波轉
換，其三階的小波係數表示為 ，其中 、 與 分別表示一階小波封包轉換
之子影像、二階小波封包轉換之子影像與三階小波封包轉換之子區域，
，其分解結果如圖 7 所示。為了說明圖 8 之多尺度分析，茲
選定圖 8(a)之圖型來對照比較圖 5 至圖 7，圖 8(b)-(d)為 1 至 3 階小波封包轉換圖
型，圖 8 可以驗證小波封包轉換經多解析分析後，對於子影像解析部份可以更清
楚看出水平、垂直與對角之特徵。 
)
,c
3(
,baf a b c
}, DV,H,{S,, cba 
 
3.1.3 Curvelet轉換 
 
傳統之小波轉換在二維影像之分解過程中僅依水平、垂直與對角三個方向獲
取三個細節子影像，如前述圖 4-6 所顯示之範例中，小波轉換無法細部分解 與
二個對角線。由於多晶矽太陽能晶片之晶格方向分佈眾多，為了更精準描述
晶格表面之細部方向特徵，本研究除了小波轉換外，也同時考慮使用 Curvelet
轉換 (Candés and Donoho, 2000; Candés and Guo, 2002)以獲取更多且更獨特之特
徵指標向量。 
45
135
 
為了克服小波轉換表達能力的不足，Candés 首先在 1998 年提出了 Ridgelet
 IX
有了 Radon 轉換大致上之概念後，本研究接著簡要介紹 Ridgelet 轉換，然後
引出 Curvelet 轉換 (李智杰、高新波及姬紅兵，2004)。二維連續 Ridgelet 轉換 
(Candés and Donoho, 1999)定義如下：設基函數 RR : ，滿足下列允許條件 
    

d
2
                         (3-1-10) 
 
那 麼 對 任 意  b的 , 和0a R   ,0 2 ， 定 義 Ridge
),,( :ba 
let 的 基 函 數
22 RR  如下： 
 


 
a
byx
a
yxba
  sincos1),(,,            (3-1-11) 
 
式(3-1-11)中， 是尺度參數， 是位移參數。則 Ridgelet 轉換定義為： a b
 
 dxdyyxfyxbaR baf ),(),(),,( ,,                 (3-1-12) 
 
其實，Ridgelet 轉換是以 Wavelet 轉換和 Radon 轉換為基礎，對函數 的 Randon
轉換可由下式表示： 
f
 
  dxdytyxyxftRf )sincos(),(),(            (3-1-13) 
 
其中 是單位脈衝函數，常用來表示實際系統的不連續性， t是由原點到射線的
距離，為射線與水平線之夾角。由式(3-1-12)和式(3-1-13)中，可推導出函數 的
Ridgelet 轉換，可表示為： 
f
 
   dtabtatRfbaR f )/)((),(),,( 21             (3-1-14) 
 
式(3-1-14)中，角度變量為常數，t沿角度之方向做距離變化。可以看出Ridgelet
轉換是在線性 Radon 轉換切片上的一維小波轉換。 
 
不同於小波轉換僅對輸入影像之水平與垂直方向進行低通與高通之濾波運
算，Curvelet 轉換也是一個多尺度(multi-scale)的轉換，但在每個尺度下，具有多
個方向之細節分解。就一個 Curvelet 函數 ),( yx 及其 Curvelet prototype 
),(,, yxba  ，一個二維影像 之連續 Curvelet 係數可表示為 ),( yxf
 
   dxdyyxfyxC baba ),(),(,,,,                 (3-1-15) 
 
其中 a是尺度參數，b 表位移參數，為方向參數，且  20  。 
 
Curvelet 轉換是基於 Ridgelet 轉換理論、多尺度 Ridgelet 轉換理論和帶通濾波器
理論的一種轉換。如同微積分之定義一樣，在足夠小的尺度下，曲線可以被看作
 XI
形區域視窗 )(~ wU j ，其定義為 
 
)()()(~ 1 wVwwU jjj                        (3-1-20) 
 
而對於每一個 ]4/,4/ ，會有一個楔形區域視窗 )(~ , wU lj ，定義如下 [  l 
 
)(~)()()(~ 1, wSUwSVwwU ljljjlj               (3-1-21) 
 
在離散之 Curvelet 轉換的實現方法中，Candés 和 Donoho 在 2005 年提出了兩種
快速離散 Curvelet 變換的實現方法，分別是 USFFT (Unequally-spaced Fast Fourier 
Transforms)算法和 Wrapping 算法，本研究所使用之方法為 Wrapping。基於
Wrapping 的快速離散 Curvelet 變換的實現方法中，其核心思想是圍繞原點做纏
繞，即在具體實現中對任意區域通過週期化的技術映射到原點的映射區域。 
 
在小波轉換中每個子影像皆為矩形，而 Curvelet 之每個子影像則為楔形
(Wedge)，而此楔形區塊可在不同尺度下呈現在不同之方向，因此 Curvelet 轉換
之金字塔架構 (Pyramid structure)分解結果則如同極座標系統，其尺度變化如同
輻射軸長，而方向變化則是輻射之角度。在最低解析度下，Curvelet 無方向變化
(即原始影像之平滑部份)，而在愈高解析度下，Curvelets 方向變化愈多，且其形
狀就如同針狀物。圖 9 為 Curvelet 在頻率域下的分解示意圖 (Hennenfent and 
Hervmann, 2006)，此圖包含 3 個尺度，第一階 (最內之方形)表示平滑影像，第
二階至第三階分別是由第一階之方形區域往外擴散，其擴散方式是將前一階的每
個楔形區域再細分成 2 個不同尺度的楔形區域，並以極座標方式在不同的尺度下
得到更細節的資訊，圖中淡色區域為第一階、第二階與第三階之分解結果，灰色
區域為將此分解結果區隔，以方便觀察。圖 10 則是將內含 與 兩個對角
線之矩形圖案經 Curvelet 分解之結果，由圖 10(b)可明顯觀察到矩形圖案之水平
線、垂直線、 與 對角線可獨立顯示在每階所對應方向的 Curvelet 域上，
而中心部份之圖樣則為原始矩形在最低解析尺度之平滑版本，圖中黑色區域分別
為二階、三階與四階之 Curvelet 轉換結果，灰色區域為將分解結果做區隔以方便
觀察，本身並無意義。由圖 9 與圖 10(b)中，Curvelet 轉換是依照不同角度將圖
10(a)之水平線、垂直線、 對角線與 對角線在不同階層中細分出來，並得
到在不同尺度下的細節訊息，此圖例說明 Curvelet 轉換的確比 Wavelet 轉換具備
描述不同角度細節的能力。相對於 Wavelet 轉換，Curvelet 轉換可提供更多描述
不同方向細節之特徵值，可更有效代表每一個矽晶片的獨特晶格圖樣。 
45 135
45 135
45 135
 
3.1.6 灰階直方圖交叉比對法 
 
本研究利用 Michael 及 Dana [1990]提出之直方圖交叉比對法 (Histogram 
intersection)應用於灰階影像之多晶矽太陽能晶片，即只考量每個像素點灰階值以
及梯度方向 (Gradient direction)之直方圖來進行特徵萃取，並做相似度之比對。
 XIII
度，由於 EL 取像方式是透過使太陽能電池通電後，使用近紅外光 CCD 在完全
密不透光的環境下取像，由於無法使用任何外加光源，因此取像之增益(Gain)
值、曝光時間(Exposure time)、外加電流大小與每片太陽能電池之電阻性(發光效
率)不同，會完全影響取得 EL 影像之結果。EL 影像中的灰階(亮度)與少數載子
密度成正比，在影像中，多晶矽之晶(Grain boundary)與差排(Dislocation)之區域
會較灰暗，同時外部瑕疵所造成的區域，例如裂痕、金屬手指斷線及來自製程之
異物，也會造成少數載子密度較低，而呈現較暗的灰階，因此 EL 影像可有效同
時提供一個太陽能電池之電性(Electrical)與材料(Material)特性，如圖 12 所示。然
而 EL 影像技術不只可以應用於單一太陽能電池也可適用於封裝製程後之大尺寸
太陽能電池模組，圖 13 是一張由 36 (6×6)個太陽能電池組合之太陽能模組之 EL
影像，前述太陽能電池之 EL 影像可視為一個微觀 (Micro-view)或高解析
(High-resolution)之影像擷取方式，而太陽能模組之 EL 影像則為一個巨觀
(Macro-view)或低解析(Low-resolution)的取像方式。由於每個太陽能電池之晶格
樣式不同而使得每個太陽能模組影像中每一個太陽能電池之子影像(Subimage)
的圖樣(Pattern)也不相同。 
 
一個多晶矽太陽能電池在傳統光學攝影機所擷取之灰階影像中，如圖 14 所
示，瑕疵比較不容易被觀察出來，且表面晶格非常複雜容易發生漏檢及誤判的情
形，若在製程中沒有即時檢測出瑕疵，將因為製程上沒有立即修正及調整缺失，
容易造成最後成品中大量不正常產生，不僅浪費了大量的材料成本，且對於使用
效能也會發生極大的損失；而在 EL 取像系統所擷取的灰階影像可以發現，如圖
15 所示，太陽能電池中的裂痕瑕疵被明顯的呈現(如圖中圓形虛線所標示之區
域)，然而晶格背景也同時被凸顯於 EL 影像，使得做自動瑕疵檢測的困難度也大
為增加。 
 
由多晶太陽能電池之 EL 影像可以發現，太陽能電池中的瑕疵具備條狀與線
狀之特性，而且正常之晶格背景也同時被凸顯於 EL 影像中，使得自動瑕疵偵測
的困難度也大為增加。由於在空間域(Spatial Domain)之原始灰階影像無法使瑕疵
特徵凸顯出來，且容易受到影像中背景晶格的干擾影響，因此本研究利用傅立葉
轉換(Fourier transform)的重建影像技術，將原始影像中之瑕疵消除，再藉由比較
原始影像與還原影像之差異以區分瑕疵在 EL 影像中之位置。 
 
由於條狀與線狀瑕疵在傅立葉頻譜上具備較高之線形分佈，因此利用霍夫轉
換(Hough transform)技術，先偵測出傅立葉頻譜中對應瑕疵之角度方向，藉由消
除此角度的傅立葉頻率元素，可得到一張去除瑕疵且保留背景晶格之還原影像，
再將原始待測影像與其還原影像進行影像相減運算，可將兩影像間之差異凸顯於
影像中，最後利用統計管制界限設定閥值，即可有效偵測瑕疵所在。圖 16 為本
研究之檢測方法流程。 
 
3.2.1 二維快速傅立葉轉換 
 
 在本研究中所分析的影像皆是二維的離散(Discrete)影像，因此必須將傅
立葉轉換寫成二維之離散傅立葉轉換，以便之後的分析工作。令二維影像大小為
MN，影像中像素點  的灰階值為yx,  yxf , ，其中 x = 0, 1, 2, …, M-1 和 = 0, 1, 
2, …, N-1，二維離散傅立葉轉換如式(3-2-1)所示。 
y
 XV
夫角度 ，並對霍夫角度 所對應之霍夫累加值 )(A 加總能量值。令 )(A 為霍
夫轉換在 角度之一維累加器(Accumulator)，並設 )(A 的起始值為 0，其中
 = 。假設影像大小為 179  ,0  ,1  ...,  NM  ， )2,2(M), 00 v( Nu  為傅立葉頻譜
之中心點座標，並設點 與中心點 連線和水平方向 間的夾角為),v(u ),( 00 vu )0( u
，即式(3-2-5)。 
 


 1-

0










 0tan
0 ,   
1
u
v
u
v
u
v





if   ,   
if               
u
v
  ...,  ,1  M
180
tan
v
                  (3-2-5) 
 
其中u ， ，且u0u vu  v 1-,0 ， v 1-  ..., N  ,1  ,0 。 
 
I. 第一階段瑕疵之角度篩選 
 
    根據霍夫累加值直方圖 ，採用統計製程管制界限的
方式找出瑕疵之角度，由於太陽能電池在 EL 影像中之特定結構，不論正常影像
或是瑕疵影像，當 時，其霍夫累加值
179    ),( 
 135 ,90 
 ...,  ,1  ,0A
 ,0 45 , )(A 皆非常的高，因此
計算能量值平均數 )( A 和能量值標準差 )( A 時，其平均數和標準差之數值會變
的很大而造成管制界限不易設定，所以本研究排除上述四個角度，進而計算其能
量值平均數 )( A 和能量值標準差 )( A ，如式(3-2-6)與(3-2-7)所示： 
 
 135 ,90 ,


45 ,0
176
1 179
0
 

A     , )( ) ( A              (3-2-6) 
 
 135 ,90 ,


45    ,][
175
1 179
0
2
)



A( A
  ,0)( (  A
)(
)    (3-2-7) 
 
    由於瑕疵角度所對應之霍夫能量累加值較大，因此只需使用上管制界限作為
閥值，就可以將瑕疵角度找出來，當 A 的能量值大於管制界限的上限，則將
角度記錄於集合 1 ，其上管制界限判斷的標準如下式： 
      180
1
0    ),()|  )()(   AAA( 1  )(  AK   (3-2-8) 
 
II. 第二階段瑕疵之角度篩選 
 
    經過第一階段瑕疵之角度篩選過後，尚有與瑕疵無關之角度的累加能量值大
於管制界限，因此在第二階段瑕疵之角度篩選則是要由集合 中排除與瑕疵無
關之角度，而正確的找出最終要去除傅立葉頻譜中對應瑕疵之角度，其方法之說
明如下。 
 
令 為穿過傅立葉頻譜中心 ( 且角度為 的直線方程式，而 為*0,*L ), 0v0u s,L *
 XVII
 
  ,  ),(
)((  &  0     0     ,           0
),(ˆ
22
0

 


otherwisevuF
rvv)u-uLandLif
vuF
2
0    (3-2-10) 
 
其中  = 0, 1, …, u 1M ， v  = 0, 1, …, 1N 。 
 
若傅立葉頻譜上的頻率元素 滿足上述(3-2-10)之判斷式，則將對應於頻
率元素 之傅立葉頻率
),( vu
 vu,   v,uF 的值設成 0，因此得到新的傅立葉頻率為
，再透過反傅立葉影像轉換，即可得到一張去除瑕疵且保留背景晶格之還
原影像。在上述公式(3-2-10)中，若
 vuF ,ˆ 
 vu, 落在半徑 4r 的圓內時，則保留該頻率
元素 ，此乃在以 為圓心之小半徑內的頻率元素代表低頻訊號，即整
張影像之主要資訊，因此這些頻率元素必須保留下來。 
)v,(u  00 ,vu 
 
 
3.2.5 影像相減 
 
經由反傅立葉影像轉換後得到一張去除瑕疵且保留背景之還原影像，將待測
影像與其還原影像逐點做影像相減運算，可將兩影像間之差異凸顯於影像中。由
於反傅立葉轉換後，使得反傅立葉影像之亮度有些許變異，所以進行做影像相減
之前必須先對反傅立葉影像進行光源正規化(Illumination normalization)，而本研
究採用光源正規化方法之計算流程如下： 
 
首先，計算原始影像(待測影像) 的灰階值平均數),( yxf f 和標準差 f ，如
公式(3-2-11)與(3-2-12)所示，影像大小為 NM  。 
 



1
0
1
0
),( 1
M
x
N
y
f yxfNM
                           (3-2-11) 
 
 




1
0
1
0
2]),([ 1
M
x
N
y
ff yxfNM
                     (3-2-12) 
 
接著計算反傅立葉影像 的灰階值平均數),(ˆ yxf fˆ 和標準差 fˆ ，如公式
(3-2-13)與(3-2-14)所示： 
 
 



1
0
1
0
ˆ ),(ˆ 
1 M
x
N
y
f yxfNM
                           (3-2-13) 
 
 




1
0
1
0
2
ˆˆ ]),(ˆ[ 
1 M
x
N
y
ff yxfNM
                     (3-2-14) 
 
最後，透過公式(3-2-15)對反傅立葉影像進行光源正規化，使得原始影像與其還
原影像皆有相同之灰階平均值和標準差，其中 表示反傅立葉影像之光源
正規化結果： 
),(ˆ yxf 
 
 XIX
3.3.1 形態學(Morphology)影像前處理 
 
 形態學(Morphology)是研究影像中物體形狀或結構的一種重要方法，主要是
利用特殊定義的結構元素，在每個像素位置上與灰階影像中相對應的區域進行邏
輯運算。本研究設計(如圖20) L1 的結構元素(Structure element , SE，即長度為
L個像素且寬度為1個像素之遮罩)用於濾除大部分背景之晶格，並且保留瑕疵。
此結構元素可以濾除背景晶格之原因，主要是在瑕疵影像中所呈現之晶格背景大
都屬於塊狀，而瑕疵的形狀具備條狀和線狀之特性，因此我們針對瑕疵結構的特
性，設計 之三種結構元素用於保留垂直 、對角 之
條狀或線狀的瑕疵結構，並將濾除背景晶格，期望進行ICA分類時能提高辨識正
確率。 
 135 90  45 和、 )(90 )135 (45 、
 
令 為EL灰階影像，即為影像在座標位置 之灰階值，影像大小為
，L為結構元素之長度。 表示一個大小為
),( yxf ),( yx
NM  SE-135 L1 在 的對角線之
結構元素，如圖20(a)； 為一個大小為
135
SE-45 L1 在 對角線之結構元素，如
圖20(b)；而 則為一個大小為
45
SE-90 L1
)
在垂直方向 之結構元素，如圖20 
(c)，S 分別為三種結構元素在EL影像中以 為中心
點之灰階值加總。 
)90( 
,(135 yxS  )、,(90 yx  ),( Syx 、45 ), y(x
 
    將整張影像每一個像素位置，反覆上述步驟最後完成前處理之形態學影像
。形態學之詳細步驟如下所示。 ),( yxf 
 
步驟 1：將三種結構元素各別計算灰階 值加總。 
 
結構元素之灰階值加總-135    


 2
)1(
2
)1(
135 ),(),(
L
Li
iyixfyxS     (3-3-1)      
 
結構元素之灰階值加總-54      


 2
)1(
2
)1(
45 ),(),(
L
Li
iyixfyxS       (3-3-2) 
 
結構元素之灰階值加總-90     


 2
)1(
2
)1(
90 ),(),(
L
Li
iyxfyxS             (3-3-3) 
 
其中 ;)1(
2
1
 ,... ,1)1(
2
1
 ),1(
2
1  LMLLx )1(
2
1
 ..., ,1)1(
2
1
 ),1(
2
1  LNLLy 。 
 
步驟 2：在三個結構元素加總值 
),(  ),(  ),( 1359045 yxSyxSyxS 、、 中，挑選灰階值加總之最小值的結構元素。 
令 SE- 為從結構元素 中，挑選灰階值加總之最小值),(  ),(  ),( 1359045 yxSyxSyxS 、、
 XXI

























3
2
1
333231
232221
131211
3
2
1
s
s
s
aaa
aaa
aaa
x
x
x
                    (3-3-6) 
 
或 
Asx   
其中 ， ， 。 Txxx ) , ,( 321x ][ ijaA Tsss ) , ,( 321s
 
    ICA 的模型是由混合訊號 ，其中 代表觀察到的隨機變數
(如同上述雞尾酒派對問題中麥克風收集到的混合訊號)，以及獨立的潛在變數
(如同上述例子中三個講話者原來說話的訊號)，和一個未知的混
合矩陣(Mixing matrix) A 組成，假設x s存在線性組合關係，則三者的關係為
x   
x Tnxxx ) ..., ,,( 21x
與
T
ns )s ..., ,s ,( 21s
As。
所
 
為了估計獨立的潛在變數 s，必須經由反混合矩陣(De-mixing matrix) 對隨
機變數 做重建以得到獨立成份(Independent components)
W
x y ，而獨立成份 y 則被
用來估計潛在變數 s，即： 
Wxy                            (3-3-7) 
當反混合矩陣 ，則  1 AW sy 
 
在 ICA 模型中，有一個基本的限制，就是獨立成份彼此間必須相互統計獨立
(Statistically independent)，以下介紹獨立性 (Independence)的基本定義，以
代表隨機變數，而 為其聯合密度函數(Joint probability 
density function)，如果變數間彼此互相獨立，則聯合密度函數可以為邊際密度函
數(Marginal probability density function)的階乘(Factorial)。令 代表隨機變數
的邊際密度函數，則 
nyyy  ..., , , 21
iy
)y..., , ,( 21 nyyf
)( ii yf



n
i
iinnn yfyfyfyfyyyf
1
221121 )()()...()(),...,,(      (3-3-8) 
獨立性必須和非相關(Uncorrelatedness)作一個區別，假設變數 與 之間互不相
關，則會滿足： 
iy jy
      jiyEyEyyE jiji  for     ,               (3-3-9) 
 
其中 代表期望值。 }{E
 
3.3.3 ICA 前處理 
 
在進行 ICA 分析之前，資料必須經過前處理以方便 ICA 演算法的計算。而
 XXIII
 
),()1( , crfMcrix                   (3-3-13) 
其中 。 
 
; ,... ,2 ,1 Mr  Nc  ..., ,2 ,1
最後將H 張訓練之子影像組成一個矩陣維度為 KH  訓練樣本資料矩陣 X，如下
示： 
 
          (3-3-14) 
 
驟 2：將訓練樣本資料 X，輸入到 FastICA，獲得來源(Source)矩陣 
tICA 之
其中
所
 TH
HKHH
K
K
xxx
xxx
xxx
xxxX ..., , , 21
21
22221
11211














步
 
    第二個步驟就是將訓練樣本資料 X，輸入到 Fas 流程，可以將 FastICA
所分離之基底影像U (Basis images)輸出， U 為 KH  之向量矩陣、H 為訓練
常之子影像的張 、K 為子影像大小數 NM  。正 ICA  
 
模型為
XWU   
 
其中 W 為 FastICA 求解之反混合矩陣(Demixing matrix)， 為大小 HH  ，而 U 則
為估算之來源(Source)矩陣，亦即基底影像組合，大小為 KH  。 個訓練樣本，
最多可獲得 H 個基底 ，每個基底長度為 K，即
H
iu  T 。 H21
.3.6 待測影像之基底重建 
 
表示影像在 灰階値， 像大小為
uu ,...,,uU 
 
3
令 (f ),( yx 之 子影), yx NM  ， y 為測試樣本
資料， [yy ]，其中 ..., , , 21 Kyy NMK 之 。 
驟 1：測試樣本 之集中化(Centering) 
先計算訓練樣本之均值向量，如式(3-3-15)。 
 
 
)(y步
 
首



H
i
iH 1
1 xx                               (3-3-15) 
 
其中 H 為訓練樣本的張數。再將測試樣本 )(y 與訓練樣本平均值 )x( 相減，便可
算 集中化後的測試樣本 ，如式 )。 
 
出 )( y (3-3-16計
xyy                               (3-3-16) 
A 所分離的獨立成份之虛擬
 
步驟 2：計算重建測試樣本之權重 )(b 。 U 為 FastIC
 XXV
100%)( 21 
P
P TT分類正確率                 (3-3-24) 
 
四、實驗結果與討論 
4.1 多晶矽晶片識別方法檢測結果 
 
第一階段(第一年)所提出的方法可有效藉由小波轉換及 Curvelet 轉換將每張
影像轉換成具有多解析及多尺度之能量值向量指標，並利用機器視覺技術辨識每
張多晶矽太陽能晶片之晶格圖樣並做為辨識身份之依據。本章將比較小波轉換及
Curvelet 轉換對分類與辨識效果之準確性，並探討多解析與多尺度之階層數之結
果。 
 
在多晶矽廠商提供之 204 張多晶矽太陽能晶片影像中，不論能量指標向量為
或 皆能有效分類出同矽碇與不同矽碇的多晶矽太陽能晶片，其分類之正
確率可達到 100％，如表 1 所示。而在將多晶矽太陽能晶片轉換成特徵值指標之
時間中，因小波封包轉換及 Curvelet 轉換是利用不同通道及尺度取得特徵值，故
在轉換成能量指標向量的時間會消耗許多，其消耗之時間分別約為 2.23 秒及
17.63 秒。在灰階直方圖交叉比對法及梯度方向直方圖交叉比對法中，對一張多
晶矽太陽能晶片轉換成直方圖之時間約為 0.8 秒，故在轉換成特徵指標時間上減
少許多，但在灰階及梯度方向直方圖交叉比對之分類正確率約為 97％。在多晶
矽廠商提供之樣本中，若不顧慮到每張多晶矽太陽能晶片轉換成能量指標向量的
時間，則小波封包之 的能量指標向量與 Curvelet 的 的能量指標向量皆可
正確分類出同矽碇與不同矽碇的多晶矽太陽能晶片；但若考慮到能量指標向量轉
換之時間，在分類部份則建議使用灰階及梯度方向直方圖交叉比對法，其分類正
確率約為 97％。若能量指標向量轉換之時間在 3 秒以內為可接受之範圍，則可
選擇小波封包之 的能量指標向量，其分類正確率約為 100％。在辨識正確率
方面，Curvelet 轉換能將辨識出的影像編號與輸入影像的編號差距介於為 之
間，即辨識出的影像為輸入影像的下一張或上一張，故在辨識之正確率部份明顯
比小波封包轉換及灰階及梯度方向直方圖交叉比對法好。 
4WP 2C
4WP 2C
4WP
2
 
在 41 個多晶矽太陽能晶片樣本中，若多晶矽太陽能晶片之位移不大，則利
用梯度方向直方圖交叉比對法即可將正確分類出同矽碇與不同矽碇之多晶矽太
陽能晶片，如表 2 所示。若有大位移之情況出現，則建議使用小波封包之 能
量指標向量作為多晶矽太陽能晶片之特徵。在分類正確率部份，不論是相同環
境、改變光源或小位移之情況下，其梯度方向直方圖交叉比對法及小波封包之
的分類正確率皆高達 100％，即梯度方向直方圖交叉比對法及小波封包之
能量指標向量皆能明確分類出同矽碇與不同矽碇的多晶矽太陽能晶片。在辨
識正確率中， Curvelet 轉換之能量指標向量能在相同環境下辨識出同一張矽晶
片，而梯度方向直方圖交叉比對法及小波封包之 因突顯矽晶片表面晶格架構
沒有比 Curvelet 轉換之能量指標向量較明確，故在相同環境下無法辨識出同一張
多晶矽太陽能晶片。 
4WP
4WP
4WP
4WP
 
 XXVII
助於提升 ICA 分類之正確率。 
 
 XXIX
六、參考文獻 
 
Baykal, I. C. and G. A. Jullien, 2004, “In-camera detection of fabric defects,” Circuits 
and Systems, Vol. 3, pp. 934-936. 
 
Bartlett, M. S., J. R. Movellan and T. J. Sejnowski, 2002, “Face recognition by 
independent component analysis,’’ IEEE Transactions on Neural Networks, pp. 
1450-1464. 
 
Bently, W. A., 1979, “The inspection: an automatic optical printed circuit board (PCB) 
inspection,” in Proc. Soc. Photo-Optical Instrument. Engrs., Vol. 201, pp. 37-47. 
 
Bodnarova, A., M. Bennamoun and S.J. Latham, 2000, “A constrained minimisation 
approach to optimise Gabor filters for detecting flaws in woven textiles,” Acoustics, 
Speech, and Signal Processing, Istanbul, Vol. 6, pp. 3606-3609 
 
Chan, C. H. and K. H. Pang, 2000, “Fabric defect detection by Fourier analysis,” 
IEEE Trans. on Industry Application, Vol. 36, pp. 1267-1276. 
 
Candés, E. J. and D. L. Donoho, Philosophical Transactions A of The Royal Society, 
Stanford University , Stanford, California, 1999. 
 
Candés, E. J. and D. L. Donoho, 2000 “Curvelets - a surprisely effective nonadaptive 
representation for objects with edges.” in C. Rabut, A. Cohen and L. L. Schumaker 
(Eds.) Vanderbilt University Press, Nashville, TN, Curves and Surfaces, pp. 105-120. 
 
Candés, E. J. and F. Guo, 2000, “New multiscale transforms, minimum total variation 
synthesis: application to edge-preserving image reconstruction,” Signal Processing, 
Vol. 82, pp. 1519-1543. 
 
Conners, R. W., C. W. Mcmillin, K. Lin and R. E. Vasquez-Espinosa, 1983, 
“Identifying and locating surface defects in wood: part of an Automated Lumber 
Processing System,” IEEE Transactions on Pattern Analysis and Machine 
Intelligence, Vol. PAMI-5, pp. 573-583. 
 
Corneloup, G. J. Moysan and I. E. Magnin, 1996, “B-scan image segmentation by 
thresholding using co-occurrence matrix analysis,” Pattern Recognition, Vol. 29, pp. 
281-296. 
 
Fuyuki T. and A. Kitiyanan, 2009, “Photographic diagnosis of crystalline silicon solar 
cells utilizing electroluminescene, “ Applied physics A, Vol. 96, pp. 189-196. 
 
Hennenfent, G, and F. J. Hervmann, 2006, “Seismic denoising with non-uniformly 
sampled curvelets, ” Computing in Science and Engineering, Vol. 8, pp. 16-25. 
 
Hurri, J., H. Gävert, J. Särelä and A. Hyvärinen, FastICA Package, 2004, Online 
Available: http://www.cis.hut.fi/projects/ica/fastica/. 
 
 XXXI
 
劉廣東，陳阿林，2009 年，「基於 Curvelet 變換的圖像去噪」，重慶師範大學學
報，重慶大學，第 26 卷，第 4 期。 
 
蕭鉢，1999 年，「應用小波轉換與表面瑕疵檢測」，碩士論文，私立元智大學工
業工程與管理研究所。 
 XXXIII
    
(a) 第一組同矽碇樣本 1 (b) 第一組同矽碇樣本 2 (c) 第一組同矽碇樣本 3
   
   
(d) 第二組同矽碇樣本 1 (e) 第二組同矽碇樣本 2 (f) 第二組同矽碇樣本 3 
   
   
(g) 第三組同矽碇樣本 1 (h) 第三組同矽碇樣本 2 (i) 第三組同矽碇樣本 3 
圖 2 多晶矽太陽能晶片影像：(a)-(c)為第一組來自同一矽碇且切割位置相近之連
續三個晶片； (d)-(f)為第二組來自同一矽碇且切割位置相近之連續三個晶
片；(g)-(i)為第三組來自同一矽碇且切割位置相近之連續三個晶片 
 
 XXXV
 
 
)1(
Sf )1(Hf 
(平滑子影像) 
 
(水平細節子影像) 
)1(
Vf )1(Df 
(垂直細節子影像) 
 
(對角細節子影像) 
 
圖 5 二維影像經一階小波封包轉換之小波係數矩陣示意圖 
 
 
 
)2(
,SSf ,HSf ,SHf ,HHf 
)2(  )2(  )2(  
)2(f ,VS ,DS ,VH ,DH 
)2(f  )2(f  )2(f  
)2(f ,SV ,HV ,SD ,HD 
)2(f  )2(f  )2(f  
)2(f ,VV ,DV ,VD ,DD 
)2(f  )2(f  )2(f  
 
圖 6 二維影像經二階小波封包轉換之小波係數矩陣示意圖 
 
 
 
 
 
 XXXVII
圖 9 Curvelet 分解示意圖 (資料來源：Hennenfent and Herrmann, 2006) 
 
  
(a) 原始矩陣影像 (b) Curvelet 分解之結果 
圖 10 Curvelet 多解析範例 
 
圖 11 電致發光(EL)影像系統之架構 
 XXXIX
),(ˆ),(),( yxfyxfyxf 
  
 

otherwise ,255
)(),( , 0
, ff
KfyxfifyxB

),( yxf
),( vuF
),(ˆ vuF
)(A
1
2
 yx,fˆ
),(ˆ yxf 
)(AK
5.2)( AK
fK
ffKfu
yx f



 ),(

 
圖 16 本研究方法之處理流程 
 XLI
 Uyb
Uby ˆ
xyy 
為訓練樣本之均值向量x
為測試樣本y
U矩陣
y-y ˆ
},...,{ Hx2x1xX 
XWU ：
 
圖 19 電致發光影像瑕疵檢測方法之處理流程 
 XLIII
   
(a1) 原始影像 (b1) 原始影像 (c1) 原始影像 
   
(a2) 圖(a1)之平滑影像 (b2) 圖(b1)之平滑影像 (c2) 圖(c1)之平滑影像 
圖 22 瑕疵太陽能模組子影像經過形態學影像處理之範例 
 
 XLV
編號 瑕疵影像 檢測結果 編號 瑕疵影像 檢測結果 
1 
  
9 
  
2 
  
10 
  
3 
  
11 
  
4 
  
12 
  
5 
  
13 
  
6 
  
14 
  
7 
  
15 
  
8 
  
   
圖 24 傅立葉影像重建技術應用於太陽能電池之檢測結果 
 
 
 
 
 
 
 XLVII
表 3 不同計算距離值方式之分類正確率(原始影像) 
影像 原始影像 
訓練樣本張數 30 張 
距離值
組數 o c
D  D  
第一組 91.2% 91.2% 
第二組 90.0% 91.2% 
第三組 92.5% 95.0% 
第四組 86.2% 87.5% 
第五組 91.2% 91.2% 
第六組 88.7% 90.0% 
第七組 90.0% 91.2% 
第八組 91.2% 91.2% 
第九組 95.0% 95.0% 
第十組 90.0% 91.2% 
平均分類正確率 90.6% 91.5% 
標準差 2.31% 2.19% 
最低分類正確率 86.2% 87.5% 
最高分類正確率 95.0% 95.0% 
*測試樣本共 80 張，含 28 張正常影像與 52 張瑕疵影像 
 
 XLIX
 表 5 原始影像與形態學平滑影像在計算距離值之分類正確率 
訓練樣本張數 30 張 
距離值 oD  cD  
影像 
組數 
原始影像 形態學 平滑影像 原始影像 
形態學 
平滑影像 
第一組 91.2% 91.2% 91.2% 92.5% 
第二組 90.0% 91.2% 91.2% 92.5% 
第三組 92.5% 95.0% 95.0% 97.5% 
第四組 86.2% 86.2% 87.5% 87.5% 
第五組 91.2% 91.2% 91.2% 92.5% 
第六組 88.7% 91.2% 90.0% 93.7% 
第七組 90.0% 91.2% 91.2% 92.5% 
第八組 91.2% 95.0% 91.2% 95.0% 
第九組 95.0% 97.5% 95.0% 98.7% 
第十組 90.0% 91.2% 91.2% 91.2% 
平均分類正確率 90.6% 92.1% 91.5% 93.4% 
標準差 2.31% 3.08% 2.19% 3.16% 
最低分類正確率 86.2% 86.2% 87.5% 87.5% 
最高分類正確率 95.0% 97.5% 95.0% 98.7% 
*測試樣本共 80 張，含 28 張正常影像與 52 張瑕疵影像 
 
 
 LI
Multicrystalline material is made up of a number of smaller
crystals. The surface of a multicrystalline solar wafer shows
numerous grains (crystallites) of random shapes and sizes at
random position and orientations with different illumination
reﬂections and, therefore, results in a unique multi-grain pattern
in the sensed image. There are no two silicon ingots with the
same multicrystalline surfaces. The solar wafers sliced from
different silicon ingots thus show different multi-grain surfaces
in the images. The neighboring solar wafers sliced from the same
ingot will present highly similar (or, almost identical) multi-grain
patterns. The surface patterns will be changed gradually when
they are distant from each other in their slicing sequence.
Fig. 1(a)–(c) and (d)–(f) presents, respectively, three consecutive
solar wafers from two different silicon ingots. It shows the solar
wafers sliced sequentially from the same ingot display only subtle
differences, and are not visually distinguishable. The solar wafer
surfaces from different ingots are of the same texture type.
However, their multi-grain patterns are visually different, as
demonstrated in Fig. 1(a) and (d). In this study, we propose a
non-contact, attachment-free identiﬁcation system for solar
wafer tracking in manufacturing up to a lot. Here a lot means
all solar wafers sliced from the same silicon ingot. Since the solar
wafers are processed in manufacturing according to their sliced
sequence of an ingot, the lot tracking provides valuable produc-
tion and quality details for shop ﬂoor monitoring and control.
The inherited unique multi-grain pattern of a solar wafer is
extracted using machine vision techniques without intruding and
damaging the wafer surface. It can be observed from Fig. 1 that
the edges between crystal grains are clear and sharp and present
various directional details. The distribution of grain-edge direc-
tionality gives rich and unique features for encoding the identity
of a multicrystalline solar wafer. In this paper, we propose two
main image processing schemes to extract the pattern features of
a solar wafer image. One is based on wavelet transforms in the
spectral domain, and the other is based on a fast match of
gradient angle histograms in the spatial domain.
In the recent past, multi-resolution decomposition techniques
based on wavelet transforms have received considerable attention
for the extraction of textural features. The continuous 1-D wavelet
transform was initially introduced by Grossmann and Morlet [5].
It was then extended to 2-D wavelet transform by Lemarie and
Meyer [6]. The use of wavelets for texture analysis was pioneered
by Mallat [7]. He showed that a particular function of the orthogo-
nal wavelet basis is equal to texture primitives with spatial
orientation. After that, wavelet transforms have been extensively
applied to texture classiﬁcation and segmentation [8–14].
For one level of standard wavelet decomposition, a 2-D image is
decomposed into one smooth (low-frequency) subimage and three
detail (high-frequency) subimages which contain ﬁne structure
with horizontal, vertical and diagonal orientations. The wavelet
decomposition process can be recursively applied to the smooth
subimage to obtain the next level of the pyramid hierarchy. In order
to obtain smaller bands at a higher frequency, wavelet packets [15]
are also used for texture analysis. In wavelet packets, both the
smooth subimage and the detail subimages are iteratively decom-
posed using the standard wavelet transform. Wavelet packets are
better localized in both spatial and frequency domains. They have
also been used for texture classiﬁcation and segmentation [16–19].
The proposed solar wafer identiﬁcation schemes in the spec-
tral domain use both the wavelet decomposition and wavelet
packets to extract the wafer features in the decomposed detail
subimages. The encoded pattern features are used as the identity
Fig. 1. Multicrystalline solar wafer images: (a)–(c) three consecutive wafers sliced from the same silicon ingot; (d)–(f) three consecutive wafers sliced from another ingot.
D.-M. Tsai, M.-C. Lin / Robotics and Computer-Integrated Manufacturing 29 (2013) 312–321 313
can be further decomposed to generate the next resolution level
of the hierarchy. Fig. 2(a) depicts the wavelet decomposition of a
2-D image in one resolution level. The 2-D pyramid wavelet
decomposition algorithm for a digital image can be implemented
as follows [22].
Given an image f ðx,yÞ of sizeM  N,
f l x,yð Þ ¼
1
Ll
X
i
lðiÞ  f ðð2xþ iÞmodM, yÞ ð3aÞ
f h x,yð Þ ¼
1
Lh
X
j
hðjÞ  f ðð2xþ jÞmodM,yÞ ð3bÞ
for x¼0, 1, 2, y, M/21 and y¼0, 1, 2, y, N1
f S x,yð Þ ¼
1
Ll
X
i
lðiÞ  f lðx, ð2yþ iÞmod NÞ ð3cÞ
fH x,yð Þ ¼
1
Lh
X
j
hðjÞ  f lðx, ð2yþ iÞmod NÞ, ð3dÞ
f V x,yð Þ ¼
1
Ll
X
i
lðiÞ  f hðx, ð2yþ iÞmod NÞ, ð3eÞ
fD x,yð Þ ¼
1
Lh
X
j
hðjÞ  f hðx, ð2yþ iÞmod NÞ, ð3fÞ
for x¼0, 1, 2,y, M/21 and y¼0, 1, 2,y, N/21where Ll and Lh
are the support lengths of ﬁlters l(i) and h(j), respectively. In this
study, the most compact Haar basis with lowpass ﬁlter
ðlð0Þ,lð1ÞÞ ¼ ð
ﬃﬃﬃ
2
p
=2,
ﬃﬃﬃ
2
p
=2Þ and highpass ﬁlter ðhð0Þ,hð1ÞÞ ¼ ð
ﬃﬃﬃ
2
p
=2,

ﬃﬃﬃ
2
p
=2Þ are used for fast convolution.
Fig. 2(b) illustrates the decomposition result of two resolution
levels for a 2-D image, where f(i)(x,y) represents a decomposed
subimage at level i. Fig. 3((a1) and (b1)) shows two solar wafer
images from different ingots. The 2-level decomposition results of
the two wafer images are demonstrated in Fig. 3((a2) and (b2)).
The enlarged detail subimages f ð2ÞH ðx,yÞ and f ð2ÞV ðx,yÞ at level 2 for the
two wafer images are presented, respectively, in Fig. 3(a3), (a4) and
(b3), (b4). The detail subimages f ð2ÞH ðx,yÞ indeed show the domi-
nated horizontal edges and f ð2ÞV ðx,yÞ displays the main vertical edges
of the two images. The detail subimages of f ð2ÞH ðx,yÞ and f ð2ÞV ðx,yÞ
between these two wafer patterns are apparently different.
In order to extract the representative features of a solar wafer,
we calculate the normalized energy of each decomposed detail
subimage at a resolution level. It is deﬁned as the sum of squared
wavelet coefﬁcients of a decomposed detail subimage at a
resolution level with respect to that of the decomposed smooth
subimage at the same resolution level. That is,
EðjÞH ¼
X
x
X
y
½f ðjÞH ðx,yÞ2=EðjÞS ð4aÞ
EðjÞV ¼
X
x
X
y
½f ðjÞV ðx,yÞ2=EðjÞS ð4bÞ
EðjÞD ¼
X
x
X
y
½f ðjÞD ðx,yÞ2=EðjÞS ð4cÞ
where EðjÞS ¼
P
x
P
y½f ðjÞS ðx,yÞ2,f ðjÞH ðx,yÞ, f ðjÞV ðx,yÞ and f ðjÞD ðx,yÞ are the
decomposed horizontal, vertical and diagonal detail subimages,
respectively, and f ðjÞS ðx,yÞ is the decomposed smooth subimage at
resolution level j.
At each decomposition level, we obtain three discriminant
features for wafer pattern encoding. The feature vector of a solar
wafer at a given wavelet decomposition level J is denoted by
W J ¼ ðEðJÞH ,EðJÞV ,EðJÞD Þ ð5Þ
A feature vector that combines the extracted features at two
decomposition levels J and Jþ1 is given by
W J,Jþ1 ¼W J [W Jþ1 ¼ ðEðJÞH ,EðJÞV ,EðJÞD ,EðJþ1ÞH ,EðJþ1ÞV ,EðJþ1ÞD Þ ð6Þ
In order to efﬁciently calculate the degree of similarity
between two solar wafers, the simple Euclidean distance is used
as the measure. Let P and Q be two solar wafers images, andW(P)
Fig. 3. Wavelet decomposition of solar wafer images: (a1), (b1) original wafer
images from two different ingots; (a2), (b2) respective 2-level decomposition
results; (a3), (b3) respective enlarged horizontal detail subimages at level 2;
(a4), (b4) respective enlarged vertical detail subimages at level 2. (a1) Original
image, (b1) Original image, (a2) 2-level decomposition, (b2) 2-level decomposi-
tion, (a3) f(2)H (x,y), (b3) f
(2)
H (x,y), (a4) f
(2)
V (x,y) and (b4) f
(2)
V (x,y).
D.-M. Tsai, M.-C. Lin / Robotics and Computer-Integrated Manufacturing 29 (2013) 312–321 315
generally appears in the high frequency channels. In order to
extract more discriminant pattern features in both low and high
frequency bands at each level, the wavelet packets are also used
for encoding the identity of a solar wafer.
In wavelet packets, the three detail subimages are decomposed
iteratively by the conventional wavelet transform to obtain
smaller bands at the higher frequencies. Fig. 4(a) depicts the
pyramid algorithm of wavelet packets, where the smooth sub-
image f ð1ÞS along with the three detail subimages f
ð1Þ
H , f
ð1Þ
V and f
ð1Þ
D at
resolution level 1 are further decomposed to the next level.
Fig. 4(b) illustrates the wavelet packets at resolution level 2,
which are the decomposition results from the 1st-level wavelet
transform in Fig. 2(b).
A decomposed subimage at resolution level J in wavelet
packets is denoted by f ðJÞa1 ,a2 ,,aJ , where ak A S,H,V ,Df gfor
k¼ 1, 2,    , J. ak represents one of the four subimages S
(Smooth approximation), H (Horizontal detail), V (Vertical detail)
and D (Diagonal detail) at level k. akþ1 is a subimage at level kþ1
and is decomposed from subimage ak at the previous level k. For
instance, f ð2ÞH,V is the vertical detail at resolution level 2, whose source
image is the horizontal detail at level 1. Fig. 5(a1) and (b1) shows
two solar wafers from different ingots, which are the same as those
in Fig. 3((a1) and (b1)). Fig. 5(a2) and (b2) are the corresponding
wavelet packets at resolution level 3. The enlarged 3rd-level packets
in Fig. 5(a3)–(a5) and (b3)–(b5) are the decomposed horizontal,
vertical and diagonal results of the 2nd-level horizontal detail f ð2ÞH in
Fig. 3(a3) and (b3). Note that the notation of f ð2ÞH in wavelet
decomposition is equivalent to f ð2ÞS,H in wavelet packets. The enlarged
packets show that f ð3ÞS,H,H resembles to its source subimage f
ð2Þ
H
containing the horizontal detail, as seen in Fig. 5(a3) and (b3).
f ð3ÞS,H,V and f
ð3Þ
S,H,D provide more subtle vertical and diagonal details in
Fig. 5(a4), (a5) and (b4), (b5) for the source subimage.
In wavelet packets, the energy of each decomposed detail
subimage normalized with respect to its corresponding smooth
subimage at level J forms a feature vector of the solar wafer
pattern. Hence,
EðJÞa1 ,a2 ,,aJ ¼
P
x
P
y
½f ðJÞa1 ,a2 ,,aJ1 ,aJ ðx,yÞ2P
x
P
y
½f ðJÞa1 ,a2 ,,aJ1 ,Sðx,yÞ
2
ð8Þ
where akAfS,H,V ,D9k¼ 1,2,    ,J1g, and aJ A H,V ,Df g. Therefore,
there are a total of (4J1)3 energy values extracted from
wavelet packets at resolution level J. The extracted feature vector
at level J in wavelet packets is given by
WPJ ¼ fEðJÞa1 ,a2 ,,aJ 9akAfS,H,V ,D9k¼ 1,2,    ,J1g and aJAfH,V ,Dgg
ð9Þ
A feature vector that combines the wavelet packet features
from multiple decomposition levels is given by
WPJ, Jþ1 ¼WPJ [WPJþ1 ð10Þ
and
WPJ,Jþ1,Jþ2 ¼WPJ [WPJþ1 [WPJþ2
Denote by WP(P) and WP(Q) the feature vectors extracted
from wavelet packets for solar wafers P and Q, respectively. The
similarity between wafers P and Q is also measured by the
Euclidean distance, i.e.,
DWPðP,Q Þ ¼ JWPðPÞWPðQ ÞJ ð11Þ
2.3. Encoding with histogram intersection
Wavelet transform and wavelet packets offer detailed direc-
tion features of a solar wafer as identity codes. Both encoding
methods require the multi-channel, multi-resolution transforms
Fig. 5. Wavelet packets of solar wafer images: (a1), (b1) original wafer images from
different ingots; (a2), (b2) respective wavelet packets at level 3; (a3)–(a5) and (b3)–
(b5) respective enlarged H, V and D details decomposed from f ð2ÞS,H (i.e., f
ð2Þ
H of wavelet
transform in Fig. 3((a3) and (b3)). (a1) Original image, (b1) Original image, (a2)Wavelet
packets at level 3, (b2) Wavelet packets at level 3, (a3) f ð3ÞS,H,H , (b3) f
ð3Þ
S,H,H , (a4) f
ð3Þ
S,H,V ,
(b4) f ð3ÞS,H,V , (a5) f
ð3Þ
S,H,D and (b5) f
ð3Þ
S,H,D .
D.-M. Tsai, M.-C. Lin / Robotics and Computer-Integrated Manufacturing 29 (2013) 312–321 317
vectors. It is deﬁned as
gD ¼
ðm1m2Þ2
s21
ð17Þ
where m1¼mean distance (DW or DWP) for any two wafers from
the same ingots;
m2¼mean distance for any two wafers from different ingots;
s21¼distance variance for wafers from the same ingots
The measure is similar to the Fisher ratio [23]. Because the
wafers from different ingots involve different silicon grain pat-
terns and their measured distances could be distinctly different,
the within-class variance in the gD measure is only given by the
wafers from the same ingots. A larger value of gD indicates a
better separability of a feature vector. Table 1 summarizes the
resulting gD ratios of wavelet decomposition and wavelet packet
features vectors at different resolution levels.
As shown by the box-plots in Fig. 8 and the separability mea-
sure gD in Table 1, the feature vectors extracted from wavelet
packets consistently outperform those from wavelet decomposition.
The best feature set of wavelet decomposition is W3,4 (i.e., W3[ W4)
with a gD value of 48.2. The feature vector WP4 given by wavelet
Fig. 8. Box plots of distance measures for wafers from the same and different
ingots under various feature combinations from (a) wavelet decomposition, and
(b) wavelet packets.
Table 1
Separability measure gD of various feature combinations in the spectral domain.
Encoding method Feature set
Wavelet decomposition W2 W3 W4 W2,3 W3,4 W2,3,4
26.4 35.8 27.6 36.9 48.2 48.1
Wavelet packets WP2 WP3 WP4 WP2,3 WP3,4 WP2,3,4
27.8 52.8 71.4 56.6 70.1 68.3
Fig. 9. Demonstrative solar wafer images of 10 ingots used in the experiments.
D.-M. Tsai, M.-C. Lin / Robotics and Computer-Integrated Manufacturing 29 (2013) 312–321 319
Based on the experimental results of discrimination power
analysis, classiﬁcation performance and effects of illumination
changes and location shifts, wavelet packets with the feature set
WP4 provides the best effectiveness for classifying a solar wafer to
its corresponding ingot lot. The gradient angle histogram inter-
section is the most computationally efﬁcient method with a good
classiﬁcation rate.
4. Conclusions
This paper has presented three machine-vision-based encod-
ing methods for automatic identiﬁcation of multicrystalline solar
wafers in a manufacturing process. A solar wafer surface com-
prises silicon grains of random sizes and shapes. The direction-
ality information of grain edges provides discriminant features for
wafer identiﬁcation. The encoding methods extract the multi-
grain pattern features using wavelet decomposition and wavelet
packets in the spectral domain, and gradient angle histogram
intersection in the spatial domain. The machine vision schemes
provide non-contact, label-free identiﬁcation of solar wafers for
lot tracking in solar cell manufacturing.
Experimental results have shown that wavelet packets give the
most representative features and identify a solar wafer within its
three neighbors in the cutting sequence. The gradient angle
histogram intersection is the most efﬁcient method for solar
wafer encoding. The proposed methods in their current forms
cannot accurately identify individual solar wafers in a manufac-
turing process. It is worthy of further investigation.
References
[1] Hill JM, Cameron B. Automatic identiﬁcation and data collection: scaning into
the future. Achieving Supply Chain Excellence through Technology 2000;7:
269–72.
[2] Markkainen, M, Ala-Risku, T. Automatic identiﬁcation—applications and
technologies. In: Logistics research network eighth annual conference;
2003, London, UK.
[3] Mcfarlane D, Sarma S, Chirn JL, Wong CY, Ashton K. Auto ID systems and
intelligent manufacturing control. Engineering Applications of Artiﬁcial
Intelligence 2003;16:365–76.
[4] Rein, S, Krieg, AWeil, A, Emanuel, G, Glathaar, M, Grohe, A et al. Single-wafer
tracking in PV production lines. In: The 23rd European photovoltaic solar
energy conference and exhibition; 2008, Valencia, Spain.
[5] Grossmann A, Morlet J. Decomposition of Hardy functions into square integr-
able wavelets of constant shape. SIAM Journal on Mathematics 1984;15:
723–42.
[6] Lemarie PG, Meyer Y. Ondellettes et bases hilbertennes. Revista Matema´tica
Iberoamericana 1986;2:1–18.
[7] Mallat SG. A theory for multiresolution signal decomposition: the wavelet
representation. IEEE Transactions on Pattern Analysis and Machine Intelli-
gence 1989;11:674–93.
[8] Chen T, Kuo C-CJ. Texture analysis and classiﬁcation with tree-structured
wavelet transform. IEEE Transactions on Image Processing 1993;2:429–41.
[9] Pichler O, Teuner A, Hosticka BJ. A comparison of texture feature extraction
using adaptive Gabor ﬁltering, pyramidal and tree structured wavelet trans-
forms. Pattern Recognition 1996;29:733–42.
[10] Chitre Y, Dhawan AP. M-band wavelet discrimination of natural textures.
Pattern Recognition 1999;32:773–89.
[11] Arivazhangan S, Ganesan L. Texture classiﬁcation using wavelet transform.
Pattern Recognition Letters 2003;24:1513–21.
[12] Kumar V, Raju USN, Sekaran KC, Krishna VV. A new method of texture
classiﬁcation using various wavelet transforms based on primitive patterns,
International Journal of Graphics. Vision and Image Processing 2008;8:21–7.
[13] Luo B, Aujol J-F, Gousseau Y, Ladjal S. Indexing of satellite images with
different resolutions by wavelet features. IEEE Transactions on Image
Processing 2008;17:1465–72.
[14] Reddy BVR, Mani MR, Subbaiah KV. Texture classiﬁcation method using
wavelet transforms based on Gaussian Markov random ﬁeld. International
Journal of Signal and Image Processing 2010;1:35–9.
[15] Coifman RR, Wickerhauser MV. Entropy-based algorithms for best basis
selection. IEEE Transactions on Information Theory 1992;38:204–22.
[16] Laine A, Fan J. Texture classiﬁcation by wavelet packet signatures. IEEE
Transactions on Pattern Analysis and Machine Intelligence 1993;15(1993):
1186–91.
[17] Yoshida H, Casalino DD, Keserci B, Coskun A, Ozturk O, Savranlar A. Wavelet-
packet-based texture analysis for differentiation between benign and malig-
nant liver tumours in ultrasound images. Physics in Medicine and Biology
2003;48:3735–53.
[18] Hiremath PS, Shivashankar S. Texture classiﬁcation using wavelet packet
decomposition. ICGSTs GVIP Journal 2006;6:77–80.
[19] Kim SC, Kang JJ. Texture classiﬁcation and segmentation using wavelet
packet frame and Gaussian mixture model. Pattern Recognition 2007;40:
1207–21.
[20] Swain MJ, Ballard DH. Color indexing. International Journal of Computer
Vision 1991;71:11–32.
[21] Antonini M, Barlaud M, Mathieu P, Daubechies I. Image coding using wavelet
transform. IEEE Transactions on Image Processing 1992;1:205–20.
[22] Tsai D-M, Hsiao B. Automatic surface inspection using wavelet
reconstruction. Pattern Recognition 2001;34:1285–305.
[23] Webb A. Statistical pattern recognition. West Sussex, England: John Wiley &
Sons; 2002.
Table 3
Effects of changes in illumination and location shifts.
Encoding method Feature
set
Classiﬁcation rate (%)
Illumination
changes
Small
shifts
Large
shifts
Wavelet
decomposition
W2,3,4 078.9 010.5 000.0
Wavelet packets WP4 100.0 100.0 100.0
Histogram
intersection
Y 100.0 100.0 000.0
D.-M. Tsai, M.-C. Lin / Robotics and Computer-Integrated Manufacturing 29 (2013) 312–321 321
present brighter luminescence in the sensed image. Process deﬁ-
ciencies such as small cracks, breaks, and ﬁnger interruptions appear
as dark regions in the EL image. Fig. 2 shows the conﬁguration of the
EL imaging system. Fig. 3(a) shows the EL image of a defect-free
solar cell. Figs. 3(b)–(d) presents three EL images of defective solar
cells that contain small cracks, breaks, and ﬁnger interruptions,
respectively. The defect areas are inactive, resulting in dark regions
that are visually observable in the sensed EL image.
By observing both Figs. 3(a) and (b), the EL imaging system not
only shows the extrinsic defects as dark objects but also presents
the dislocation and grain boundaries with dark gray levels in the
sensed image. The background shows inhomogeneous patterns of
dark blobs and clouds due to the random crystal grains in the
multicrystalline silicon wafer. This characteristic makes the auto-
matic defect detection in EL images very difﬁcult. In this paper,
we propose a Fourier image reconstruction scheme to detect
small cracks, breaks, and ﬁnger interruptions of multicrystalline
solar cells in EL images. The proposed Fourier-transform-based
scheme can well identify the local defect as long as it is darker
than its surroundings in the EL image. The defect contrast is not
required to be larger than the grain boundary contrast.
Texture analysis techniques [3] in image processing have been
used for automatic visual inspection of various material surfaces.
These defect detection methods mainly aim at homogeneously
textured surfaces, in which textural patterns appear repetitively
or periodically in the whole image. A set of textural features are
generally extracted either from the spatial domain or from the
spectral domain of an inspection image, and then a high-dimen-
sional classiﬁer is used for identifying local defects that break the
homogeneity of the textured background.
In spatial domain approaches, the widely-used textural fea-
tures are the second-order statistics derived from spatial gray
level co-occurrence matrices [4]. They have been used for the
inspection of machined surfaces [5], web surfaces [6], textile
fabrics [7], and cotton contamination [8].
In spectral domain approaches, textural features are com-
monly extracted from the power spectrum of an image by the
Fourier transform [9]. They have been used for the inspection of
textile fabrics [10,11] and semiconductor wafers [12]. Gabor ﬁlter
banks with varying frequencies and phase angles are also com-
monly used to represent texture characteristics, and are applied
to the inspection of granite [13], steels [14], and textile fabrics
[15,16]. The wavelet transform [17,18] is a powerful tool of
multiresolution analysis for textural feature extraction. The dis-
criminant features are generally represented by wavelet energies
of decomposed subimages in different frequency channels and
scales. They have been applied to the inspection of semiconductor
wafers [19] and textile fabrics [20,21].
The local feature extraction techniques above work success-
fully only for defect detection in uniform and homogeneously-
textured surfaces. They cannot be extended to defect detection in
heterogeneously-textured surfaces, such as EL images of multi-
crystalline solar cells. For solar wafer and solar cell inspection, Fu
et al. [22] presented a machine vision method to detect cracks in
solar cells. The method can identify only cracks in the cell edges
having gray levels distinct from their surroundings. Ordaz and
Lush [23] analyzed the conversion efﬁciency of a solar cell based
on the gray-level distribution in the EL image. Pilla et al. [24] used
the thermographic technique to highlight cracks in solar cells.
Demant et al. [25] studied the quality of multicrystalline solar
wafers using the photoluminescence imaging (PL) technique. The
quality features are combined in a histogram for an interpretable
presentation, and are used to establish a rating of wafer quality.
Haunschild et al. [26] analyzed crystallization-related features of
solar wafers in PL images. It is shown that the fraction of crystal
defects, deﬁned as the pixels covered by crystal defects divided by
the total number of pixels of the wafer, is highly correlated
with the open circuit voltage. Warta [27] reviewed various
sensing techniques for defect and impurity diagnostics in silicon
solar cells.
Recently, Tsai et al. [28] presented an anisotropic diffusion
algorithm for detecting small cracks that are visible on the solar
wafer surface. The sensed image, obtained from a typical CCD
camera and light source, shows micro-cracks with low gray levels
Fig. 1. CCD-captured images of (a) multicrystalline solar wafer and
(b) multicrystalline solar cell.
EL Image
PC
Cooled
Camera
IR filter
Luminescence
DC
Power
Supply
Polycrystalline silicon cell
Fig. 2. Conﬁguration of an EL imaging system.
Fig. 3. Demonstrative EL images of solar cells: (a) defect-free sample; (b) small crack; (c) break; (d) ﬁnger-interruption.
D.-M. Tsai et al. / Solar Energy Materials & Solar Cells 99 (2012) 250–262 251
transform (DFT) of f ðx,yÞ is given by
Fðu,vÞ ¼
XN1
y ¼ 0
XM1
x ¼ 0
f ðx,yÞUexp j2p ux
M
þ vy
N
 h i
ð1Þ
for spectral variables u¼ 0, 1, 2, :::, M1 and v¼ 0, 1,
2, :::, N1. The DFT is generally complex; that is,
Fðu,vÞ ¼ Rðu,vÞþ jUIðu,vÞ ð2Þ
where Rðu,vÞ and Iðu,vÞ are the real and imaginary parts of F(x, y),
i.e.,
Rðu,vÞ ¼
XN1
y ¼ 0
XM1
x ¼ 0
f ðx,yÞUcos 2p ux
M
þ vy
N
 h i
ð3aÞ
Iðu,vÞ ¼
XN1
y ¼ 0
XM1
x ¼ 0
f ðx,yÞUsin 2p ux
M
þ vy
N
 h i
ð3bÞ
The power spectrum P(x, y) of F(x, y) is deﬁned as
Pðu,vÞ ¼ 9Fðu,vÞ92 ¼ R2ðu,vÞþ I2ðu,vÞ ð4Þ
Since the input image f ðx,yÞ is real, the FT exhibits conjugate
symmetry. The magnitude of the transform is symmetric with
respect to the DC center in the spectrum image. Fig. 4(a1) is the EL
image of a defect-free solar cell of size 550 550 pixels. The
corresponding Fourier spectrum in Fig. 4(a2) shows that the high-
energy frequency components spread circularly in the spectrum
image for the random grain background. The vertical bright line in
the spectrum image represents the two horizontal bus bars. The
bright spots in the horizontal line in the spectrum image
represent the vertical thin ﬁngers of the solar cell. The distance
between the spots in the spectrum image is associated with the
spacing of ﬁngers in the spatial image. Fig. 4(b1) shows the EL
image of a defective solar cell that contains a small line crack at
an angle of 371, and Fig. 4(b2) is the corresponding Fourier
spectrum image. It is expected to ﬁnd a 1271 high-energy straight
line passing through the DC center in the spectrum image.
However, the resulting spectrum image cannot sufﬁciently dis-
play a visible line due to the extremely short line segment of the
small crack with respect to the whole EL image area.
In order to intensify the high-energy line for a defect with
either a long or a short line segment in the Fourier spectrum
image, the original solar cell image is equally divided into many
non-overlapping subimages of smaller size. Fig. 4(c1) shows the
crack defect in a 7575 subimage. Fig. 4(c2) presents the
corresponding Fourier spectrum, where the high-energy line
associated with the 371 crack is now more distinctly present at
1271 in the spectrum image. The Fourier transform of a small EL
subimage not only gives a better representation of line- and
bar-shaped defects in a random background but also provides a
better computational efﬁciency, as compared to the process
results in the whole image of a large size.
The choice of an adequate subimage size is generally related to
the defect size present in the EL image. The window size should
be selected such that the defect line in its associated spectrum
image can sufﬁciently present a signiﬁcant local peak of the
accumulated power spectrum. As a rule of thumb, a satisfactory
detection results can be always achieved if a defect to be
inspected in the window is at least half of the window width.
A preliminary experiment has indicated that the proposed method
generates consistent detection results for varying window sizes
between 5555 and 9595 pixels.
2.2. Line detection in spectrum images
To automatically detect high-energy lines associated with line-
shaped defects in the Fourier spectrum image, we propose a two-
stage line detection process for the task. The ﬁrst stage of the line
detection process uses the Hough transform (HT) to ﬁnd the slope
angles of suspected lines in the spectrum image, and the second
stage uses a veriﬁcation rule to remove false angles detected in
the ﬁrst stage.
Step 1: The Hough transform
The Hough transform is an effective technique for line detec-
tion under noisy and discontinuous conditions. It involves a
voting process that transforms the set of points in the image
space into a set of accumulated votes in the parameter space.
A local peak larger than some threshold in the parameter space
then indicates a line present in the image space. The conventional
HT is computationally intensive for real-time, on-line applications
due to the large search space of parameter values. Fortunately, the
implementation of the HT line detection in the spectrum image is
very easy and fast because every line will pass through the DC
center of the spectrum image. The line equation is then solely
deﬁned by the parameter of slope angle.
The HT process scans every pixel (u, v) in the spectrum image,
and calculates the slope angle
y¼ tan1 vv0
uu0
 
ð5Þ
where ðu0,v0Þ is the central coordinates of the spectrum image,
and is given by ðM=2,=N=2Þ for an image of size M  N. The voting
weight for the one-dimensional accumulator AðyÞ at slope angle y
is given by the Fourier spectrum 9Fðu,vÞ9; i.e.,
AðyÞ’AðyÞþ9Fðu,vÞ9
        
127°=
Fig. 4. Fourier spectrum images of solar cells: (a1) defect-free EL image; (a2)
spectrum image of (a1); (b1) full-sized defective EL image of 550550 pixels;
(b2) spectrum image of (b1) where no lines can be visually observed; (c1) small
crack in a 7575 EL subimage; (c2) spectrum image of (c1), where a 1271 -line
can be distinctly observed.
D.-M. Tsai et al. / Solar Energy Materials & Solar Cells 99 (2012) 250–262 253
magnitudes HDsðynÞas a function of the shift Ds for slope angles
451, 631, 681 and 1351. Each proﬁle HDsðynÞis symmetric with
respect to Ds¼ 0. The high-energy projections at 451 and 1351 do
not show the maximum peak at Ds¼ 0, and HDsð683Þ near the true
line angle of 631 does not show a monotonic decreasing proﬁle.
This phenomenon also holds for the break defect. Therefore, the
2−=Δs
0=Δs
1−=Δs
1=Δs
2=Δs
Ss =Δ
Ss −=Δ
×
●
),( vuF
Fig. 6. Sketch of lines parallel to Lyn ,0 with a shift of Ds.
Fig. 7. Proﬁles of projection HDsðynÞ: (a) EL subimage of a small crack; (b) Fourier spectrum image showing a high-energy line at 631; (c)–(f) proﬁles of the line projection at
angles 451, 631, 681 and 1351, respectively.
D.-M. Tsai et al. / Solar Energy Materials & Solar Cells 99 (2012) 250–262 255
between f ðu, vÞ and f^ ðx, yÞ is given by
Df ðx,yÞ ¼ 9f ðx,yÞf^ ðx,yÞ9 ð14Þ
A small difference value of Df ðx, yÞ indicates a defect-free
point at (u, v), whereas a distinctly large difference shows strong
evidence of a defect point. The upper bound of a simple statistical
control limit is thus used to set the threshold for segmenting
defects from the background in the difference image Df ðx, yÞ. The
threshold for Df ðx, yÞ is given by
TDf ¼ mDf þKDf UsDf ð15Þ
where mDf and sDf are the mean and standard deviations of
Df ðx, yÞ in the whole image, and KDf is a pre-determined control
constant. The detection results can be represented by a binary
image, wherein the pixel ðx, yÞ with Df ðx, yÞ4TDf is a defect
point and is marked in black. It is otherwise a defect-free point
and is marked in white in the binary image. Figs. 9(a1) and (b1)
show, respectively, a defect-free and a small crack subimage.
Their reconstructed images are presented in Figs. 9(a2) and (b2).
Figs. 9(a3) and (b3) are the corresponding difference images
Df ðx, yÞ. The results show that the reconstructed image of the
defect-free sample is similar to its original one, and no signiﬁcant
differences are found in the difference image. In contrast, the
reconstructed image of the defective sample effectively blurs the
small crack, and the difference magnitudes of the defect region
are dramatically large in the resulting image. Notice that the
defective image in Fig. 9(b1) contains a crack with a mean gray
value of 74 and grain boundaries with a mean gray value of 55.
The crack contrast is lower than the grain boundary contrast. The
proposed Fourier image reconstruction method can still well
detect the crack.
2.4. Removal of ﬁnger interruption
In the image reconstruction process, special care must be given
to ﬁnger interruptions. Since the solar cell presents periodical thin
ﬁnger lines in the vertical direction and the bar-shaped ﬁnger
interruption also appears vertically in the EL image, removal of all
frequency components along the horizontal direction (i.e. y¼ 03)
in the Fourier spectrum image will remove all ﬁnger lines in the
reconstructed image. The subsequent image subtraction between
the inspection image and the reconstructed image will then
inevitably identify the normal ﬁnger lines as defects. To cope
with such a problem, only a short horizontal band-rejection
region is used to remove the possible bar-shaped defects of ﬁnger
interruption in the low-frequency region and retain the high-
frequency components for the periodical ﬁnger lines in the
spectrum image.
Fig. 10(a) shows the EL image of a ﬁnger interruption, where
the repetitive thin vertical lines are the normal ﬁngers.
Fig. 10(b) is the corresponding spectrum image. Fig. 10(c1) dis-
plays the revised spectrum image, where the horizontal black
strip across over the entire image represents the band-rejection
region. Figs. 10(c2) and (c3) are, respectively, the difference image
and the resulting binary image with KDf ¼ 1. It shows that the
normal ﬁnger lines in the difference image are falsely detected as
defects in the binary image. By using a short horizontal band-
rejection strip with length of 10 pixels and width of 5 pixels in a
75 75 EL subimage, the bar-shaped defect can be reliably
identiﬁed without segmenting the normal ﬁnger lines as defects,
as seen in Figs. 10(d1)–(d3). The speciﬁc band-rejection strip in
slope angle 03 is applied for every inspection image.
3. Experimental results
In this section, we present the experimental results from a set
of multicrystalline solar cells that contain defect-free samples of
random backgrounds and defective samples of various defect
types in EL images. All experiments were implemented on a
personal computer with a Pentium Core 2 Duo 3.00 GHz proces-
sor. The whole image of a solar cell is 550550 pixels wide with
8-bit gray levels. Each solar cell image is divided into small non-
overlapping subimages of size 7575 pixels. The computation
time for a 7575 subimage is only 0.006 s. The proposed method
achieves a fast processing time of 0.29 s for on-line inspection of a
whole solar cell with a size of 550550 pixels.
In the proposed algorithms, two critical parameters, the width
Dw of the band-rejection region for image reconstruction and the
control constant KDf for thresholding the difference image, may
affect the detection results. The effects of changes in the para-
meter values of Dw and KDf are individually evaluated in the
following two subsections.
3.1. Effect of band-rejection width Dw
The band-rejection width Dw determines the region for
removing the frequency components that correspond to line-
and bar-shaped defects. Too small a width may not effectively
remove the possible defects in the reconstructed image, and as a
result, the true defects will not appear in the difference image. It
then may cause mis-detection of defects in the resulting binary
image. However, too large a width removes the frequency
components not only of the defects but also of the dark regions
in the background. The difference image between the original EL
image and its reconstructed image will distinctly present the
Fig. 10. Removal of vertical ﬁnger interruption in the reconstructed image: (a) EL
subimage of a ﬁnger interruption; (b) Fourier spectrum image; (c1)–(c3) revised
spectrum image with band-rejection length L¼ 75, difference image, and binary
image, respectively; (d1)–(d3) revised spectrum image with band-rejection length
L¼ 10, difference image, and binary image, respectively.
D.-M. Tsai et al. / Solar Energy Materials & Solar Cells 99 (2012) 250–262 257
Figs. 12(a1)–(c1) show a set of three defect-free images for the
test. Figs. 12(a2)–(c2) are the corresponding reconstructed images,
and Figs. 12(a3)–(c3) are the difference images. Figs. 12(a4)–(c4),
(a5)–(c5), and (a6)–(c6) are the segmentation results of the differ-
ence images with control constants KDf ¼ 1, 1.5, and 2, respectively.
Figs. 13(a1)–(c1) further present a set of three defective EL images of
small crack, break and ﬁnger interruption, respectively. Figs. 13(a2)–
(c2) and (a3)–(c3) are the reconstructed images and the resulting
difference images. Figs. 13(a4)–(c4), (a5)–(c5), and (a6)–(c6) show
the detection results as binary images with control constants
Fig. 12. Effect of changes in control constant KDf for defect-free solar cells: (a1)–(c1)
defect-free EL subimages; (a2)–(c2) respective reconstructed images; (a3)–(c3)
respective difference images; (a4)–(c4) segmentation results with KDf ¼ 1;
(a5)–(c5) segmentation results with KDf ¼ 1:5; (a6)–(c6) segmentation results
with KDf ¼ 2.
Fig. 13. Effect of changes in control constant KDf for defective solar cells: (a1)–(c1)
defective EL subimages with small crack, break and ﬁnger interruption, respec-
tively; (a2)–(c2) respective reconstructed images; (a3)–(c3) respective difference
images; (a4)–(c4) segmentation results with KDf ¼ 1; (a5)–(c5) segmentation
results with KDf ¼ 1:5; (a6)–(c6) segmentation results with KDf ¼ 2.
D.-M. Tsai et al. / Solar Energy Materials & Solar Cells 99 (2012) 250–262 259
Although the proposed method is based on the Fourier transform,
it can be efﬁciently applied to a small subimage and achieves an
average computation time of 0.29 s for a whole solar cell image of
size 550 550 pixels. It can be practically implemented for on-
line, real-time defect inspection in solar cell manufacturing.
Experimental results also show that the two main parameters
of the proposed method, band-rejection width Dw and control
constant KDf , can be tolerant in a moderate range. The ﬁne-tuned
parameter values of Dw and KDf for best detection results are
generally related to the image size and resolution in question. It
would be worthwhile to further investigate automatic selection of
adaptive parameter values for changes of image size and image
resolution.
References
[1] T. Fuyuki, H. Kondo, T. Yamazaki, Y. Takahashi, Y. Uraoka, Photographic
surveying of minority carrier diffusion length in polycrystalline silicon solar
cells by electroluminescence, Applied Physics Letters 86 (2005) 262108.
[2] T. Fuyuki, A. Kitiyanan, Photographic diagnosis of crystalline silicon solar cells
utilizing electroluminescence, Applied Physics A 96 (2009) 189–196.
[3] X. Xie, A review of recent advances in surface defect detection using texture
analysis techniques, Electron Letters Computer Vision and Image Analysis 7
(2008) 1–22.
[4] R.M. Haralick, K. Shanmugam, I. Dinstein, Texture features for image
classiﬁcation, IEEE Transactions on Systems Man, and Cybernetics SMC-3
(1973) 610–621.
[5] K.V. Ramana, B. Ramamoorthy, Statistical methods to compare the texture
features of machined surfaces, Pattern Recognition 29 (1996) 1447–1459.
[6] J. Iivarinen, K. Keikkinen, J. Rauhamaa, P. Vuorimaa, A. Visa, A defect detection
scheme for web surface inspection, International Journal of Pattern Recogni-
tion and Artiﬁcial Intelligence 14 (2000) 735–755.
[7] R. Pan, W. Gao, J. Jiu, H. Wang, Automatic recognition of woven fabric pattern
based on image processing and BP neural network, Journal of Textile Institute
102 (2011) 19–30.
[8] J. Li, Y. Lu, B. Pu, Y. Xie, J. Qin, W.-M. Pang, P.-A. Heng, An automated cotton
contamination detection system based on co-occurrence matrix contrast
information, in: IEEE International Conference on Intelligent Computing and
Intelligent Systems, Shanghai, China, 2009, pp. 517–521.
[9] S.S. Liu, M.E. Jernigan, Texture analysis and discrimination in additive noise,
Computer Vision, Graphics Image Process 49 (1990) 52–67.
[10] C.H. Chan, G.K.H. Pang, Fabric defect detection by Fourier analysis, IEEE
Transactions on Industry Applications 36 (2000) 1267–1276.
[11] A. Kumar, Computer-vision-based fabric defect detection: a survey, IEEE
Transactions on Industrial Electronics 55 (2008) 348–363.
[12] T. Ohshige, H. Tanaka, Y. Miyazaki, T. Kanda, H. Ichimura, N. Kosaka, T.
Tomoda, Defect inspection system for patterned wafers based on the spatial-
frequency ﬁltering, in: IEEE/CHMT Int. Electronic Manuf. Technol. Symp., San
Francisco, CA , USA, 1991, pp. 192–196.
[13] G. Paschos, Fast color texture recognition using chromaticity moments,
Pattern Recognition Letters 21 (2000) 837–841.
[14] K. Wiltschi, A. Pinz, T. Lindeberg, Automatic assessment scheme for steel
quality inspection, Machine Vision and Applications 12 (2000) 113–128.
[15] A. Kumar, G. Pang, Defect detection in textured materials using Gabor ﬁlters,
IEEE Transactions on Industrial Applications 38 (2002) 425–440.
[16] A. Bodnarova, M. Bennamoun, S. Latham, Optimal gabor ﬁlters for textile ﬂaw
detection, Pattern Recognition 35 (2002) 2973–2991.
[17] S.G. Mallat, A theory for multiresolution signal decomposition: the wavelet
representation, IEEE Transactions on Pattern Analysis and Machine Intelli-
gence 11 (1989) 674–693.
[18] T. Chen, C.C.J. Kuo, Texture analysis and classiﬁcation with tree-structured
wavelet transform, IEEE Transactions on Image Processing 2 (1993) 429–441.
[19] K. Maruo, T. Shibata, T. Yamaguchi, M. Ichikawa, T. Ohmi, Automatic defect
pattern detection on LSI wafers using image processing techniques, IEICE
Transactions on Electronics E82-C (1999) 1003–1012.
[20] J. Scharcanski, Stochastic texture analysis for monitoring stochastic processes
in industry, Pattern Recognition Letters 26 (2005) 1701–1709.
[21] X. Yang, G. Pang, N. Yung, Robust fabric defect detection and classiﬁcation
using multiple adaptive wavelets, IEE Proceedings Vision, Image Processing
152 (2005) 715–723.
[22] Z. Fu, Y. Zhao, Y. Liu, Q. Cao, M. Chen, J. Zhang, J. Lee, Solar cell
crack inspection by image processing, in: International Conference on the
Business of Electronic Product Reliability and Liability, Shanghai, China, 2004,
pp. 77–80.
[23] M.A. Ordaz, G.B. Lush, Machine vision for solar cell characterization, in: Proc.
of SPIE, San Jose, CA, USA, 2000, pp. 238–248.
[24] M. Pilla, F. Galmiche, X. Maldague, Thermographic inspection of cracked solar
cells, in: Proc. of SPIE, Seattle, WA, USA, 2002, pp. 699–703.
[25] M. Demant, M. Glatthaar, J. Haunschild, S. Rein, Analysis of luminescence
images applying pattern recognition techniques, in: Proceedings of the 5th
World Conference on Photovoltaic Energy Conversion, Valencia, Spain,
pp. 1078–1082, 2010.
[26] J. Haunschild, M. Glatthaar, M. Demant, J. Nievendick, Quality control of as-cut
multicrystalline silicon wafers using photoluminescence imaging for solar cell
production, Solar Energy Materials and Solar Cells 94 (2010) 2007–2012.
Fig. 15. Detection results on defective solar cells: (a1), (b1) EL subimages with
small cracks; (c1), (d1) EL subimages with breaks; (e1), (f1) EL subimages with
ﬁnger interruptions; (a2)–(f2) respective segmentation results.
D.-M. Tsai et al. / Solar Energy Materials & Solar Cells 99 (2012) 250–262 261
122 IEEE TRANSACTIONS ON INDUSTRIAL INFORMATICS, VOL. 9, NO. 1, FEBRUARY 2013
Defect Detection in Solar Modules
Using ICA Basis Images
Du-Ming Tsai, Member, IEEE, Shih-Chieh Wu, and Wei-Yao Chiu
Abstract—Solar power has become an attractive alternative of
electricity energy. Solar cells that form the basis of a solar power
system are mainly based on multicrystalline silicon. A set of solar
cells are assembled and interconnected into a large solar module to
offer a large amount of electricity power for commercial applica-
tions. Many defects in a solar module cannot be visually observed
with the conventional CCD imaging system. This paper aims at
defect inspection of solar modules in electroluminescence (EL)
images. The solar module charged with electrical current will emit
infrared light whose intensity will be darker for intrinsic crystal
grain boundaries and extrinsic defects including micro-cracks,
breaks and finger interruptions. The EL image can distinctly high-
light the invisible defects but also create a random inhomogeneous
background, which makes the inspection task extremely difficult.
The proposed method is based on independent component anal-
ysis (ICA), and involves a learning and a detection stage. The large
solar module image is first divided into small solar cell subimages.
In the training stage, a set of defect-free solar cell subimages are
used to find a set of independent basis images using ICA. In the
inspection stage, each solar cell subimage under inspection is re-
constructed as a linear combination of the learned basis images.
The coefficients of the linear combination are used as the feature
vector for classification. Also, the reconstruction error between the
test image and its reconstructed image from the ICAbasis images is
also evaluated for detecting the presence of defects. Experimental
results have shown that the image reconstruction with basis images
distinctly outperforms the ICA feature extraction approach. It can
achieve a mean recognition rate of 93.4% for a set of 80 test sam-
ples.
Index Terms—Defect detection, independent component anal-
ysis, surface inspection, solar module.
I. INTRODUCTION
S OLAR power has become an attractive alternative of elec-tricity energy due to growing environmental concerns and
global oil shortage. Solar cells that convert the photons from
the sun to electricity are mostly based on crystalline silicon in
the current market because it can generate good performance in
usable lifespan and conversion efficiency among the currently
available techniques. Multicrystalline solar cells are more pop-
ular than monocrystalline solar cells. They dominate the pro-
duction volume in the photovoltaic industry due to lower man-
ufacturing costs.
The surface of a multicrystalline solar wafer shows multiple
crystal grains of random shapes and sizes in random positions
Manuscript received September 02, 2011; revised October 12, 2011 and Feb-
ruary 06, 2012; accepted May 19, 2012. Date of publication July 20, 2012; date
of current version December 19, 2012. Paper no. TII-11-504.
The authors are with Yuan-Ze University, Chungli 320, Tao-Yuan, Taiwan
(e-mail: iedmtsai@saturn.yzu.edu.tw)
Digital Object Identifier 10.1109/TII.2012.2209663
Fig. 1. CCD-captured images of (a) multicrystalline solar wafer; (b) solar cell;
(c) solar module composed of 36 solar cells.
and orientations. It results in a heterogeneous texture in the sur-
face. No two solar wafer surfaces contain completely identical
patterns. A solar wafer is a thin slice of a silicon ingot. It is
further processed and fabricated into a solar cell that forms the
basic unit of a solar power system. A set of solar cells are as-
sembled and interconnected into a solar module to offer a large
amount of electricity power for a variety of commercial appli-
cations.
Fig. 1(a) shows the image of a defect-free multicrystalline
solar wafer. It contains random crystal grains on the surface.
Fig. 1(b) is a solar cell image taken by a typical charge-coupled-
device (CCD) camera, where the vertical thin metal strips are
finger electrodes that supply current to the two horizontal thick
bus bars. The bus bars are used for interconnecting solar cells
to make a solar module. Fig. 1(c) demonstrates a CCD-captured
solar module image. It is composed of a matrix of 36 (6 6)
solar cells.
Image processing techniques have become an important tool
for biometric recognition [1], [2], robotic automation [3], [4]
and industrial inspection [5]–[7]. The quality inspection of
a solar module in manufacturing is very important to ensure
the expected conversion efficiency and durable lifespan. A
few automatic defect detection algorithms in the literature
have been focused on the detection of defects in solar wafers
and solar cells. The inspection in the early manufacturing
stages can prevent delivering defective materials to the sub-
sequent process. However, some of critical defects including
micro-cracks, breaks and finger interruptions may inevitably
occur in solar modules during the transportation, handling and
1551-3203/$31.00 © 2012 IEEE
124 IEEE TRANSACTIONS ON INDUSTRIAL INFORMATICS, VOL. 9, NO. 1, FEBRUARY 2013
system to detect micro-cracks in solar wafers. The intensities
of a micro-crack are darker than those of the surrounding grain
background in the sensed image. A local thresholding and
a region-growing segmentation, followed by morphological
post-processing and blob analysis, are used to detect the dark
micro-cracks. The method is performed in the solar wafer
process, but not in the final solar module process. It is assumed
that the sensed micro-crack is significantly darker than the
crystal grains by infrared lighting. A dark, thin elongated
crystal grain in the defect-free solar wafer could be falsely
detected as a defect. It cannot be directly extended for detecting
various defect types found in solar modules.
The currently available defect detection algorithms reviewed
above are generally applied to detect defects with distinct geo-
metric and intensity features, or are computationally intensive
to detect defects in a high-resolution image. Since the EL image
of a solar module under inspection is generally very large in size
and local defects in a solar cell subimage is relatively very small
in a random background, we need a fast detection algorithm to
screen all possible defective solar cells in the large solar module
image.
The proposed method is based on the independent component
analysis (ICA) technique [17]. ICA is a novel statistical signal
processing technique to extract independent sources given only
observed data that are mixtures of unknown sources without any
prior knowledge of the mixing mechanism. It has been applied
in texture analysis [18], [19] that uses either the estimated in-
dependent components or the column vectors of the estimated
mixing matrix as features for texture classification/segmenta-
tion. The ICA techniques have also been applied for surface
defect detection of textile fabrics [20], [21] and liquid crystal
display (LCD) panels [22] in manufacturing, and for grading
tomato ripening [23] in agriculture. All the ICA-based defect
detection methods are only applicable to non-textured or ho-
mogeneously-textured surfaces. They cannot be extended for
defect detection in the EL images with inhomogeneous back-
ground patterns.
The proposed ICA-based defect detection scheme involves a
learning process and an inspection process. Each solar module
image is first partitioned into individual solar cell subimages.
In the learning process, a set of defect-free solar cell subim-
ages are randomly chosen from different solar modules. Each
2D solar cell subimage used for training is reshaped as a 1D
signal and forms a row vector in the data matrix. The ICA tech-
nique is then used to find a set of statistically independent basis
images from the training data matrix. In the inspection process,
the solar module image is also first divided into individual solar
cell subimages. A test solar cell subimage is reconstructed as a
linear combination of the learned basis images. It is expected
that a defect-free solar cell subimage can be well represented
by the basis images and the reconstructed image of a defective
solar cell subimage will be distinctly deviated from its original
one.
In this study, we evaluate two ICA-based approaches for
identifying the presence or absence of defects in a solar cell
subimage. The first approach is based on feature extraction and
the second approach is based on image reconstruction from
ICA basis images. The first ICA approach uses the coefficients
of the linear combination of basis images as the feature vector.
It is then compared with that of each training sample in the data
set by a distance measure, and the minimum distance among
all training samples is used as the discrimination measure. The
second ICA approach simply calculates the reconstruction error
between the original solar cell subimage under inspection and
its reconstructed image from the basis images. If the distance or
reconstruction error is larger than a predetermined threshold, it
is identified as a defective solar cell subimage. Otherwise, it is
declared as a defect-free subimage. The performance between
these two ICA-based approaches will be evaluated by a set of
EL images of solar modules. The proposed method can fast
detect the presence/absence of defects in solar modules, but it
cannot identify the actual shape and location of a defect in the
image.
The paper is organized as follows: Section II first discusses
the basic ICA model, followed by the process for extracting
independent basis images from a set of training samples. The
feature extraction and image reconstruction from the ICA basis
images for detecting the presence/absence of defects in an in-
spection image are then presented. Section III evaluates the per-
formance of the proposed ICA-based detection methods and
analyzes the effect of changes in the number of basis images.
The comparative study between the proposed method and the
existing methods of adaptive thresholding and gray-level mor-
phology is also presented in this section. The paper is concluded
in Section IV.
II. ICA BASIS IMAGES FOR DEFECT DETECTION
The EL image of a multicrystalline solar module investigated
in this study present multiple solar cell subimages, each con-
taining randomly-shaped dark regions in the background. The
critical defects found in a solar module are micro-cracks, breaks
and finger interruptions. They are present as dark line- or bar-
shaped regions, or divide a region into a bright and a dark area in
the EL image, as seen in Fig. 3(a)–(c). There are no straightfor-
ward features based on geometric shapes and intensities to dis-
tinguish the difference between defect regions and the dark re-
gions in the background. The proposed method uses ICA to find
a set of representative basis images that can best describe var-
ious defect-free solar cell subimages. Each solar cell subimage
partitioned from a large EL image of solar module is then rep-
resented as a linear combination of the basis images.
In order to inspect individual solar cells in the large solar
module, the solar cells in the whole EL image must be parti-
tioned into small subimages, each containing exactly one solar
cell. It can be observed from the solar module image in Fig. 2
that the spacing between adjacent solar cells in either horizontal
or vertical direction is straightly and continuously dark in the
whole EL image of a solar module. Horizontal and vertical pro-
jections that accumulate the gray levels of each row and column
in the solar module image are first constructed. The local valleys
(i.e., local minima) of the projection then indicate the spacing
between adjacent solar cells. Two adjacent local valleys in the
same projection direction are fine-tuned so that each partitioned
solar cell subimage gives the same size.
126 IEEE TRANSACTIONS ON INDUSTRIAL INFORMATICS, VOL. 9, NO. 1, FEBRUARY 2013
Fig. 5. Morphological smoothing on solar cell subimages: (a1) defect-free
sample; (b1)–(d1) three defective samples; (a2)–(d2) respective smoothing
results of (a1)–(d1).
ICA model is to maximize the statistical independency of ICs.
Non-Gaussianity is a commonly used measure for statistical in-
dependency. It can be given by the negentropy [17]
(3)
where is a Gaussian random vector of the same covari-
ance matrix as . is the entropy of a random vector .
The negentropy is always non-negative and is zero if and only
if the random variable has a Gaussian distribution. It is well jus-
tified as an estimator of the non-Gaussianity of the ICs. Since
the exact probability density of the random variable is unknown,
the exact negentropy computation using (3) above is prohibited.
An approximation of the negentropy is proposed as follows:
(4)
where is a Gaussian variable of zero mean and unit vari-
ance. is a non-quadratic function, which can be given by
, as suggested by Hyvarinen et al. [17].
The demixing matrix with that maximizes the
negentropy can be efficiently calculated with the fixed-point
search algorithm [26], [27] in FastICA.
To find a set of representative basis images, a collection of
partitioned solar cells randomly chosen from the defect-free
solar modules are used as the input data set in the off-line
learning process. In the ICA model, each training sample of a
2D solar cell subimage must be reshaped as a 1D row vector in
the data matrix . Denote by the gray level at pixel co-
ordinates of an subimage. The data matrix consists
of defect-free samples, i.e., , where
is the -th training sample, and with
. The 1D elements of are obtained from the 2D
subimage , i.e.,
(5)
for and . The ICA model for
the training data matrix is given by
The demixing matrix is obtained from the FastICA al-
gorithm [30]. The row vectors of the estimated sources with
are the basis images. Given a data set
of training subimages, we can obtain up to basis images.
They are used to extract discriminant features or reconstruct the
image by representing the test image as a linear combination of
the learned basis images .
C. On-Line Defect Inspection
For a solar module image under inspection, it is first divided
into individual solar cell subimages by horizontal and vertical
projections. The morphological operation then follows for each
solar cell subimage to smooth the background. Let be a solar
cell subimage in its 1D form for test. The surface characteristics
of this solar cell can be represented by the coefficients of the
linear combination of the basis images .
That is
(6)
where is the coefficient vector of the linear
combination. It can be used as the feature vector of the test
sample . The coefficient vector can be obtained by
(7)
where is the pseudo-inverse of , and is given by
.
To determine the presence or absence of defects in the test
sample , the cosine distance is used to evaluate the similarity
between the test subimage with feature vector and every
sample with feature vector in the training data set .
Hence, the cosine distance is defined as
(8)
where the feature vector of training sample is given by
(9)
128 IEEE TRANSACTIONS ON INDUSTRIAL INFORMATICS, VOL. 9, NO. 1, FEBRUARY 2013
TABLE I
RECOGNITION RATES OF ICA-BASED FEATURE EXTRACTION AND IMAGE
RECONSTRUCTION APPROACHES
The first experiment was conducted to evaluate the perfor-
mance between the feature-extraction and the image-re-
construction . The morphological preprocessing is ap-
plied to both ICA approaches, and the number of basis images
is 30. Table I summarizes the statistics of recognition rates R%
of the two ICA methods for the 10 training data sets. It shows
that the average recognition rate of the image reconstruction ap-
proach is 93.4% with a maximum of 98.7%, while the average
recognition rate of the feature extraction approach is only 78.4%
with a maximum of 82.5%. The “Std. dev.” in the table means
the standard deviation of recognition rate % obtained from
the 10 training sets. Table I shows that most of the 10 training
sets can yield a good recognition rate larger than 92% and the
standard deviation is only 3.2% for the image reconstruction ap-
proach. The variation is due to the different basis images de-
rived from individual training samples. If the training samples
contain good representations of various background patterns of
defect-free solar cells, the derived basis images can then suf-
ficiently represent all possible background patterns of the test
samples. Since the training process can be performed off-line,
we can always carry out multiple training sets that contain dif-
ferent defect-free samples in a preliminary experiment and then
select the one that results in the maximum recognition rate for
on-line inspection in manufacturing.
To further compare the performance of these two ap-
proaches, the receiver operating characteristic (ROC) curves
are also given in Fig. 6 for the 9th training data set that gives
the best recognition rate. In the ROC plot, the true positive (TP)
rate is shown in the vertical axis and the false positive (FP)
rate is shown in the horizontal axis. The results show that the
ROC curve of the image reconstruction approach rises swiftly
upward and far outperforms the feature extraction approach.
The image reconstruction method uses the whole image (
data points of an image) to calculate the reconstruction
error. It performs the self-comparison between the input image
and the template image pixel by pixel, where the template
image is generated from the input image itself. However, the
feature-extraction method uses only a small number of data
points, where is the number of basis images, to calculate
the difference of feature vectors between the inspection image
and each individual defect-free image used in the training set.
Fig. 6. Receiver operating characteristic (ROC) curves of the ICA-based fea-
ture extraction and image reconstruction approaches.
Therefore, the feature-extraction method may result in severe
deviation when the inspection image is quite different from any
of the training samples. Since the image reconstruction method
uses more data points and evaluates the errors from the image
itself, it is more stable and reliable to generate a good discrim-
ination measurement to detect the presence/absence of defects
in a solar cell subimage. In the subsequent experiments, only
the image reconstruction approach under different scenarios is
evaluated accordingly.
The second experiment was conducted to evaluate the perfor-
mance of the proposed image reconstruction approach with and
without morphological smoothing. The number of basis images
used in the experiment is also 30. Table II lists the recognition
rates with the original EL images as the input and those with the
morphologically-smoothed images as the input. It shows that
the morphological smoothing process can slightly improve the
mean recognition rate by 2%. For all 10 training data sets, the
recognition rates of morphologically-smoothed images are con-
sistently larger than those of original EL images. The morpho-
logical process tends to smooth (or remove) the dark regions in
the background and generate a more simple and uniform surface
so that the basis images can have a better representation for ar-
bitrary EL images. The dark regions in the background are very
difficult to be smoothed while the defective regions are clearly
retained at the same time. The proposed morphological process
can mildly smooth or blur the dark regions in the background
and, thus, the resulting EL images can be better represented
from a given set of basis images. This gives a slight improve-
ment on recognition rate. The experimental results indicate that
the proposed image reconstruction method can further improve
the recognition rate if a more effective background smoothing
process can be developed in the future.
The last experiment in this paper is to evaluate the effect of
changes in the number of training images (i.e., the number of
basis images). The proposed image reconstruction approach
with morphological smoothing is applied in the experiment.
Table III summarizes the statistics of recognition rates with
varying number of basis images from 20, 25, 30 to 40. It shows
that the recognition rate increases as the number of basis images
130 IEEE TRANSACTIONS ON INDUSTRIAL INFORMATICS, VOL. 9, NO. 1, FEBRUARY 2013
Fig. 7. Comparison of the proposed method with adaptive thresholding/morphology approaches: (a1)–(d1) EL images of one defect-free and 3 defective solar
cells for testing; (a2)–(d2) respective detection results from adaptive thresholding and binary morphology; (a3)–(d3) respective detection results from gray-level
morphology.
and it can use the original defect-free training samples as the
basis images without the need of ICA process for learning. The
overall recognition rate of the image reconstruction approach is
93.4% for the inspection of solar cell subimages. The compu-
tation time of image reconstruction and measurement of recon-
struction error is only 0.03 seconds with 30 basis images for a
208 208 solar cell subimage, or 1.08 seconds for a whole solar
module image containing 36 solar cells. It is computationally
very efficient for a large solar module of image size 1250 1250
pixels.
The additional processing time of the morphological oper-
ation is 0.04 seconds for a 208 208 solar cell subimage or
1.44 seconds for a whole solar module image of 1250 1250.
A more efficient smoothing preprocessing that can effectively
remove the random dark regions in the background for better
basis image extraction and representation is worth further in-
vestigation.
The proposedmethod in this study can be treated as a “global”
approach that detects only the presence/absence of defects in
solar modules. It cannot classify the type of defect. A “local”
approach that detects the shape and location of a defect in the
EL image using a more complicated spectral technique such as
the Fourier transform or the wavelet transform is currently under
investigation. The “local” approach generally could be compu-
tationally more intensive. Since a solar module involves a very
large image size, the “global” approach can efficiently screen
the suspected defective solar cells and then the “local” approach
can effectively verify and detect the actual shape and location
of a defect for the suspected solar cells. The incorporation of
both “global” and “local” approaches can then both efficiently
and effectively identify defects of solar modules in EL images.
REFERENCES
[1] Y. Si, J. Mei, and H. Gao, “Novel approaches to improve robustness,
accuracy and rapidity of iris recognition systems,” IEEE Trans. Ind.
Inf., vol. 8, pp. 110–117, Feb. 2012.
[2] S. Jin, D. Kim, T. T. Nguyen, D. Kim, M. Kim, and J. W. Jeon, “De-
sign and implementation of a pipelined datapath for high-speed face
detection using FPGA,” IEEE Trans. Ind. Inf., vol. 8, pp. 158–167,
Feb. 2012.
[3] R. Gerndt, S. Michalik, and S. Krupop, “Embedded vision system
for robotics and industrial automation,” in IEEE Int. Conf. Ind. Inf.
(INDIN), Caparica, Lisbon, 2011, pp. 895–899.
[4] S. Livatino, F. Banno, and G. Muscato, “3-D integration of robot vi-
sion and laser data with semiautomatic calibration in augmented reality
stereoscopic visual interface,” IEEE Trans. Ind. Inf., vol. 8, pp. 69–77,
Feb. 2012.
[5] C.-H. Chan and G. K. H. Pang, “Fabric defect detection by Fourier
analysis,” IEEE Trans. Ind. Appl., vol. 36, pp. 1267–1276, 2000.
[6] A. Picon, O. Ghita, P. F. Whelan, and P. M. Iriondo, “Fuzzy spectral
and spatial feature integration for classification of nonferrous materials
in hyperspectral data,” IEEE Trans. Ind. Inf., vol. 5, pp. 483–494, 2009.
[7] D.-M. Tsai, I.-Y. Chiang, and Y.-H. Tsai, “A shift-tolerant dissimilarity
measure for surface defect detection,” IEEE Trans. Ind. Inf., vol. 8, pp.
128–137, Feb. 2012.
[8] T. Fuyuki and A. Kitiyanan, “Photographic diagnosis of crystalline sil-
icon solar cells utilizing electroluminescence,” Appl. Phys. A, vol. 96,
pp. 189–196, July 2009.
[9] T. Fuyuki, H. Kondo, T. Yamazaki, Y. Takahashi, andY. Uraoka, “Pho-
tographic surveying of minority carrier diffusion length in polycrys-
talline silicon solar cells by electroluminescence,” Appl. Phys. Lett.,
vol. 86, p. 262108, Jun. 2005.
[10] Y. Takahashi, Y. Kaji, A. Ogane, Y. Uraoka, and T. Fuyuki, “Lu-
minoscopy—Novel tool for the diagnosis of crystalline silicon solar
cells and modules utilizing electroluminescence,” in Proc. 4th World
Conf. Photovoltaic Energy Conv., Hawaii, 2006, pp. 924–927.
[11] Z. Fu, Y. Zhao, Y. Liu, Q. Cao, M. Chen, J. Zhang, and J. Lee, “Solar
cell crack inspection by image processing,” in Proc. Int. Conf. Busi-
ness Electronic Product Reliability Liability, Shanghai, China, 2004,
pp. 77–80.
[12] M. A. Ordaz and G. B. Lush, “Machine vision for solar cell character-
ization,” in Proc. SPIE, San Jose, CA, 2000, pp. 238–248.
表 Y04 
行政院國家科學委員會補助國內專家學者出席國際學術會議報告 
                                                      2012 年  12 月 11 日 
報告人姓名  蔡篤銘 
 
服務機構
及職稱 
 
元智大學工業工程與管理系所 
 
     時間 
會議 
     地點 
2012/12/02 至 12/05 
THAILAND /Phuket 
本會核定
補助文號
NSC 99-2221-E-155 -049 -MY3
會議 
名稱 
The 13th Asia Pacific Industrial Engineering and Management Systems 
Conference 
發表 
論文 
題目 
A Shift-tolerant Dissimilarity Measure for Surface Defect Detection 
內容應包括下列各項： 
一、參加會議經過 
   亞太工業工程與管理系統 (Asia Pacific Industrial Engineering and Management 
Systems, APIEMS)研討會是亞太地區有關工業工程領域最重要的研討會，台灣為
APIEMS 組織之創始國之一，在此組織之委員會佔有重要之決策影響力。由今年為
APIEMS 第 13 屆之研討會，共有來自 15 個國家超過 500 位作者參與發表 260 篇論文，
今年大會主題為“藉由有效資源管理達成永續經營”，安排三場專題演講以及多個場次
依供應鏈管理，綠色製技術，永續生產，六標準差等主題進行報告。參與 APIEMS 發表
之論文為A Shift-tolerant Dissimilarity Measure for Surface Defect Detection，介紹用於LED
晶粒自動瑕疵檢測之技術。 
    除參加論文發表外，報告人也是 APIEMS 國際組織委員會成員(Board member)之一
，因此也藉此機會參加委員會議(Board meeting)，除討論例行事項外，也在與韓國之強
力競爭對中，選出來自臺灣元智大學工業工程與管理學系之江行全教授為 APIEMS 
2015-2016 之理事長，這是近年來臺灣工業工程領域在國際相關組織之一大重要成就，
也顯示臺灣工業工程在國際之影響力。 
 
二、與會心得 
    本次會議為亞洲地區工業工程領域極為重要之研討會，雖在泰國普吉島觀光勝地舉
行，但會議期間，參與之學者皆非常踴躍，分場會議室常有座位不足而需站立聽講之情
形。在會議中之除臺灣、韓國、日本之教授與學生發表外，來自泰國、印尼等東南亞國
家之學者也積極地利用工業工程技術來改善其國內企業在製造以及服務之品質及效
率。臺灣之工業工程學者更不可鬆懈，應更努力協助臺灣企業在精進，更有國際競爭力。
    臺灣之學界在國際組織中常較為弱勢，但由於臺灣是 APIEMS 之創始會員國之一，
因此目前在該組織的委員會中，來自臺灣的會員人數較多，多組織之運作及決策有相當
的影響力，而來自臺灣之江行全教授當選 2015-2016 之理事長，他除了主導 APIEMS 會
士(fellow)之選舉辦法及推動，未來 3 年臺灣工業工程學者在該組織及其他國際組織之重
要性將也更為顯著。 
 
表 Y04 
行政院國家科學委員會補助國內專家學者出席國際學術會議報告 
                                                      2013 年  3 月 1 日 
報告人姓名  蔡篤銘 
 
服務機構
及職稱 
 
元智大學工業工程與管理系所 
 
     時間 
會議 
     地點 
2013/2/21 至 2/24 
INSTICC/ Spain / Barcelona
本會核定
補助文號
NSC 99-2221-E-155 -049 -MY3
會議 
名稱 
VISIGRAPP2013(8th Int’l. Joint Conf. on Computer Vision, Imaging and 
Computer Graphics Theory and Applications) 
發表 
論文 
題目 
Dual-mode detection for foreground segmentation in low-contrast video images
報告內容應包括下列各項： 
一、參加會議經過 
International Joint Conference on Computer Vision, Imaging and Computer Graphics Theory 
and Application 今年(2013)已是第八屆舉辦，分 VISAPP(電腦視覺)與 GRAPP(電腦繪圖)
兩組，由 ISTICC(Institute for Systems and Technologies of Information, Communication and 
Control)國際組織策劃主辦，此國際研討會最大特色主要整合電腦視覺 (Computer 
Vision)，電腦繪圖(Computer Graphics)與資料視覺(Data Visualization)之學者及研究結
果，探討此三項領域之整合與創新技術，尤其著重擴增實境的應用，此研討會一共有來
自五大洲 445 篇論文投稿，每篇皆有二位以上匿名審稿人，最後僅接受 271 篇進行口頭
及海報展示。大會開幕時先邀四位 CV，CG 與 DV 之專家針對這三個領域整合之困難以
及合作、整合方向進行討論(Panel discussion)，而在往後四天討論會場，則由這四位與談
人分別擔任 keynote speakers，進行深入之探討，及報告其研究成果。本次參與VISIGRAPP
之 VISAPP 組別，所發表之題目為” Dual-mode detection for foreground segmentation in 
low-contrast video images”，在展示期間除海報外，亦使用 iPad 展示及時視訊處理效果，
獲得與會人士極大的注意，參觀之學者也十分踴躍提問，並藉此機會與許多國外學者交
流，互相交換研究心得與經驗。 
 
二、與會心得 
本次研討會為電腦視覺以及電腦繪圖兩個研究領域相互整合之獨特會議，讓兩個不同領
域之專家學者能匯聚一堂互相激盪、並互相討論如何整合以產生創新性之應用，相較於
其他研討會，此會議先由四位 keynotes speakers 在開幕時先進行 10 分鐘之研究主題介
紹，再以 panel discussion 方式討論研究之方向以及 CV 與 CG 整合之問題，爾後在每一
天的會場再分別由不同 keynotes speakers 進行深度報告與討論，此做法值得國內舉辦各
類型研討會之單位參考。除此之外，ISTICC 組織於會議結束後，以 e-mail 方式對與會
人士進行問卷調查，以做改善活動之依據也值得國內舉辦研討會之單位參考。 
 
表 Y04 
行政院國家科學委員會補助國內專家學者出席國際學術會議報告 
                                                      2013 年  5 月 30 日 
報告人姓名  蔡篤銘 
 
服務機構
及職稱 
 
元智大學工業工程與管理系所 
 
     時間 
會議 
     地點 
2013/5/20 至 5/23 
Japan / Kyoto 
本會核定
補助文號
NSC 99-2221-E-155 -049 -MY3
會議 
名稱 
MAV2013(IAPR International Conference on Machine Vision Applications) 
發表 
論文 
題目 
A real-time ICA-based activity recognition in video sequences 
內容應包括下列各項： 
一、 參加會議經過 
本次參加之國際會議為 International Association for Pattern Recognition(IAPR)組織授權之第
十三屆 IARP International Conference on Machine Vision Applications。此研討會小而細緻，
有來自 24 個國家，僅選擇少數 32 篇論文進行口頭報告，以及 80 篇論文進行海報展示。在
三天之研討會中，有關口頭報告之場次在同一時間僅有一場，因此參與聆聽之人員十分踴
躍。本次參與 MVA 會議之口頭報告題目為 ”A real-time ICA-based activity recognition in 
video sequences”，發表動態表達及行為辨識之技術及相關應用。除論文發表外，也受邀擔
任 Industry session 場次之主持人(session chair)，協助工業應用相關論文的會場主持，也同
時受邀參與大會 VIP 人員之晚宴，有機會與大會籌辦之教授及受邀之 Keynote speakers 及
session chairs 聚餐，增加非正式場合之交流。 
 
二、 與會心得 
此次研討會參與人數雖僅約兩百人，但同一時間，不論口頭報告或海報展示，僅有一個場
次進行，因此參與的學者皆非常踴躍，並有更多之交流與互動的機會。三天之研討會期間，
每日安排一位 keynote 演講者就機器視覺之技術與應用進行專題演講。而每天也安排一個
海報展示之場次，並由參與學者投票選取每日之最佳海報獎，而在所有之論文中也分最佳
論文獎以及最佳應用獎兩項，以鼓勵學術研究與實務應用之貢獻。 
 
三、 考察參觀活動(無是項活動者省略) 
無 
 
四、 建議 
本次由日本京都大學舉辦之 IAPR MVA 研討會除了日本著名大學之教授學者參與大會之
規畫以及擔任 session chairs 外，也邀請許多日本知名企業，如 NEC、OMRON 等之研發
單位人員與工程師參與，使得此研討會不僅強調學術研究之技術發表，也加強了機器視覺
技術於工業及生活上的應用及成果。臺灣未來不論在國內或國際研討會之籌畫及執行過程
中亦可朝此方向努力，邀請國內知名之企業的人員參與，不僅可使該企業有機會讓參與國
外學者認識該公司，也能促進學術研討成果與企業應用之結合。 
 
五、 攜回資料名稱及內容 
Proceedings of MVA 2013 研討會會議論文全集以及論文全文隨身碟。 
 
99年度專題研究計畫研究成果彙整表 
計畫主持人：蔡篤銘 計畫編號：99-2221-E-155-049-MY3 
計畫名稱：機器視覺為基之多晶矽太陽能晶片自動識別及太陽能電池/模組於電致發光影像之瑕疵檢測
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 3 3 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
國科會補助專題研究計畫成果報告自評表 
請就研究內容與原計畫相符程度、達成預期目標情況、研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）、是否適
合在學術期刊發表或申請專利、主要發現或其他有關價值等，作一綜合評估。
1. 請就研究內容與原計畫相符程度、達成預期目標情況作一綜合評估 
■達成目標 
□未達成目標（請說明，以 100字為限） 
□實驗失敗 
□因故實驗中斷 
□其他原因 
說明： 
2. 研究成果在學術期刊發表或申請專利等情形： 
論文：■已發表 □未發表之文稿 □撰寫中 □無 
專利：□已獲得 □申請中 ■無 
技轉：□已技轉 □洽談中 ■無 
其他：（以 100字為限） 
3. 請依學術成就、技術創新、社會影響等方面，評估研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）（以
500字為限） 
本計畫在第一階段完成了，使用機器視覺 (Machine vision)中之紋路分析 (Texture 
analysis)技術對製程中之多晶矽太陽能晶片進行分類與識別，在頻率域之方法上，應用
小波轉換 (Wavelet transform)及 Curvelet 轉換技術萃取每張多晶矽太陽能晶片影像之
能量值指標向量 (Feature vector)並做同矽碇與不同矽碇間之分類與辨識。因多晶矽太
陽能晶片是由不同大小且不規則之晶格隨機分佈於晶片表面上，而小波轉換及 Curvelet
轉換技術皆為多尺度及多解析度之頻率域轉換方法，藉由其優異之影像細節描述能力以突
顯個別多晶矽太陽能晶片之晶格獨特特徵。本研究針對多晶矽太陽能晶片進行分析，實驗
結果顯示在梯度方向直方圖交叉比對法中，其分類之正確率可達到 97％。而小波封包及曲
線波轉換在分類結果上皆可達到 100％之正確率。在識別結果中，曲線波轉換在同矽碇之
連續切割晶片中則可達到辨識出前後一張之多晶矽太陽能矽晶片。對一張影像大小為 2600
×2600 之多晶矽太陽能晶片做梯度方向直方圖交叉比對法、小波封包轉換及曲線波轉換各
別所需之時間約為 0.8 秒、2.23 秒及 17.63 秒。本計畫於第一階段所開發之演算法已投稿
且被刊登於 Robotics and Computer Integrated Manufacturing 國際期刊 (IF: 1.23)。
 
    本計畫在第二階段導入機器視覺技術針對多晶矽太陽能電池(Solar cell)於電致發光
(Electroluminescence, EL)影像進行瑕疵檢測，可自動偵測太陽能電池與模組之瑕疵，
增加太陽能成品品質之穩定以及提高產品之良率，改善傳統人工目檢容易因疲勞造成漏
判、誤判等缺點。本計畫於第二階段所開發之演算法已投稿且被刊登於 Solar Energy 
