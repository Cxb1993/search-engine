2 
Keywords: Organic Emitting Layer, Organic 
Light Emitting Diode (OLED), Image 
Process, Fuzzy Neural Network. 
二、緒論 
隨著各類手持式資訊產品興起，顯示器扮
演人機溝通介面角色顯得越來越重要，電子
紙、手機、數位相機、PDA 以及數位電視等
產品不斷推陳出新，未來顯示器將朝多功能且
方便攜帶的輕薄短小方向發展；而有機發光二
極體(Organic Light Emitting Diode，OLED)之
特性正巧是薄型化顯示器未來發展重要組件
之一。OLED因為所需的資本門檻較小，且本
身具有自發光色性質(不需背光模組、彩色濾
光片以及偏光膜)，可大幅降低成本及減少顯
示器厚度(＜2nm)，還有高亮度、較無視角限
制(＞165°)、高反應速度(10ηs 以下)、低驅動
電壓(5.15V)以及可繞曲與製程簡單等優點，
OLED在未來極具市場潛力及產品競爭力。 
然而目前 OLED實際量產方面，面臨良率
不佳而無法量產的問題。良率不高起因於「有
機薄膜」製程中，有機薄膜層塗佈不良導致失
敗；為了提高 OLED的製程良率與顯示品質，
其所對應的檢測技術也相形重要。在這些檢測
技術當中，又以自動光學檢測系統[1]最受矚
目，不但可以降低檢測成本，提高檢測速度及
減少誤判率，達到自動化檢測準確、即時線上
檢測、減少人力與人為誤判等優點。 
OLED 的基本結構是由薄而透明且具半導
體特性之銦錫氧化物(Indium Tin Oxide，ITO)
與電力之正極相連，再加上另一個金屬陰極，
包成如三明治的結構。整個結構層中包括了：
電洞傳輸層(Hole Transport Layer，HTL)、有
機發光層(Emitting Material Layer，EL)與電子
傳輸層(Electron Transport Layer，ETL)。當電
力供應至適當電壓時，正極電洞與陰極電荷就
會在發光層中結合並產生光亮，依其配方不同
產生紅、綠和藍(RGB)三原色構成基本色彩。
有機發光層之低分子化合物是利用蒸鍍法聚
合以及塗佈法所形成，而發光層的基本條件是
固態時具有高的量子吸收率、好的成膜性和高
的載體傳輸性，故此良好的有機成膜技術是影
響有機發光二極體品質重要特性之一。 
由於有機發光層於生產檢測過程中，前段
製程需仰賴許多儀器設備，而後段製程則需大
量人員以目視方式來做檢測，而利用人工檢測
不僅費時而且容易因疲勞而產生檢測失誤。若
有機發光層需求量越來越大，且成本及價值愈
高時，OLED製造業者會開始要求逐片做材料
檢驗，如此更增加 OLED 的成本，因此客觀
公正的第三者專業檢測服務將可做為重要依
據，所以本論文針對有機發光二極體中的有機
發光層，應用影像處理技術來開發一套自動瑕
疵檢測系統，期望以快速且準確的檢測結果來
取代因人為因素所造成的錯誤。 
自動光學檢測系統[1]，應用在有機發光二
極體瑕疵檢測系統上，會碰到的問題為：有機
發光層與導電層皆為透明薄膜層，且在製程當
中發光層與導電層是互相重疊緊貼；若直接取
像所要克服之主要問題有：光學鏡頭對透明薄
膜層取像不容易、導電層光線繞射容易造成影
像干擾以及影像亮度過低；因此在文獻探討上
以此為開端，針對研究前會碰到的問題，延伸
探討至整個論文，接下來文獻探討依序會介
紹：有機發光層發光層螢光效應、影像品質提
升、影像分割、特徵值擷取以及分類器辨識等
文獻探討。 
有機發光層為透明薄膜層，影像擷取不
易，需使用它種光線顯影；楊富名[2]探討紫
外光照射對有機材料的螢光顯影與影響，並且
使用 X 光電子能譜儀探討紫外光線對有機材
料的傷害程度與安全範圍。 
影像擷取容易受到環境條件影響，若是多
塵埃、濕氣狀況下，容易造成影像中含有雜訊
干擾，更尤其是有機發光二極體當中的透明導
電層，容易造成光線繞射產生雜訊；而且若用
紫外光取像，影像亮度值過低，需利用影像品
質提升方法去除雜訊以及提昇亮度；C. J.  
Huang 等人[3]在晶元瑕疵檢測中使用中值濾
波器有效的將隨機雜訊消除且對原始瑕疵特
徵影響不大；S. J. Ko和 Y. H. Lee[4]經由加權
的方式改良中值濾波器，除了可抑制雜訊干擾
外，還可保留影像中的紋理特性。M. Unser
等人[5]採用內插方法放大離散訊號，提升影
像品質，而劉鴻明[6]更是匯整提出改良內插
法的最近鄰相內插法使得品質改善效果更佳
且演算速度更快。 
成功的影像分割必須先取得良好二值化影
像，因為環境因素的些微變動，門檻值的取得
也必須能夠隨著影像資訊變動而自動化調
整，例如 N. Otsu [7]藉由統計式方法找出影像
前景與背景的灰階分水嶺觀念能有效將影像
二值化。J. N. Kapur 等人[8]提出了一個類似
4 
素被分組為兩個主要模式的灰階，設置一個門
檻值，凡是 f(x,y)>T*的任一點(x,y)可稱為前景
點，反之則稱為背景點。 
 
圖 2 單一門檻值 
統計式門檻值決定方法是根據 Otsu[7]的
結果，其為一種能因應環境的不同而自動決定
一適合門檻值來分割影像的方法。若 *T 為最
佳門檻值，且把影像中的像素分成兩區，如圖
3 所示的 1C 和 2C 。在 1C 區內的任一像素其灰
階值 f(x,y)必定滿足 *),(0 Tyxf  ，且 2C 區內
的任一像素其灰階值 ),( yxf 必定滿足
255),(1*  yxfT 。Otsu提出兩個條件，只
要任何一者成立即可。 
圖 3 影像中像素分二區的例子 
第一個條件為 *T 的決定，使得 C1和 C2之
間的變異數(Between-Variance)為最大；第二
個條件為C1內的變異數加上C2的變異數之和
為最小。關於第一個條件，可想成 C1 和 C2
可分得最開；第二個條件，則可想成 C1和 C2
內的灰階值最近似。 
以上理論實現的方法是在灰階 0 至 255
間，逐一將灰階值代入計算變異數和 2W 式子
內，等全部 256 個灰階值皆已代入計算完畢
後，再從最小的 2W 中得到其相對應的灰階值
來當作 *T ，而這個 *T 就是將原始影像分割為
1C 和 2C 兩區的最佳門檻值。 
3.1.2形態學運算[13] 
斷開(Opening)運算是指先對影像作侵蝕
再膨脹的運算，這樣的步驟可用來消除影像中
之雜訊小點、平滑輪廓、打斷窄的細頸及消除
小島狀物體。 
閉合 (Closing)運算是與斷開相反的動
作，即先對影像作膨脹再侵蝕的運算。在閉合
過程中即可消除影像中之小洞、連結斷線及填
補輪廓上的缺口。 
3.2特徵值擷取[14] 
本研究根據有機發光層瑕疵外觀指標來
選取特徵值，經由觀察瑕疵外觀特性，擬選擇
瑕疵緊緻性、厚度差及質心灰階對比三種特徵
值。以下分別介紹三種特徵值的計算方式： 
a.緊緻性 
緊緻性(Compactness)是屬於形狀上的特徵
值，藉由影像物體的面積與周長的關係，來描
述其物體的圓形曲率與緊密度的外形特徵。 
現有一物體的面積為 A，周長為P，則緊
緻性(C )的定義如下： 
A
PC
2
                           (1) 
實例當中，若影像同時含兩個以上瑕疵區
塊，利用式(1)計算瑕疵緊緻性容易造成結果
不正確，這是因為將兩個以上的面積以及周長
合併計算原故，故此必須將瑕疵區域獨立出
來，藉由權重加總方式使得瑕疵緊緻性更為正
確，而權重後的緊緻性可將式(1)表示成式(2)： 
  L
i
i
i
i
A
a
a
PC
2
                     (2) 
其中 iP為影像中第 i個瑕疵區塊之周長， ia 為
第 i個瑕疵區塊之面積。而式(2)中可經由消去
ia 簡化成式(3)： 
 L
i
i
A
PC
2
                        (3) 
b.厚度差 
在影像處理當中，厚度的計算可藉由型態
學之侵蝕運算達成，重複侵蝕瑕疵區塊直到瑕
疵區塊完全消失，即停止運算，而侵蝕的次數
的 2倍即為瑕疵厚度；然而為了突顯塗佈不均
之長條型特性與氣泡瑕疵長短軸相似之特
性，此時將侵蝕運算子分為二，分別是上下方
向侵蝕運算子與左右方向侵蝕運算子，上下運
算子計算瑕疵上下方向厚度值，左右運算子計
算瑕疵左右寬度厚度值，而厚度差則定義為瑕
疵上下厚度與左右厚度差。 
c.質心灰階對比 
質心灰階對比定義為質心灰階值比上背景
6 
jnetj
Y  exp1
1                 (9) 
其中 jnet 和 jY 分別為輸出層第 j個神經
元的加權乘積和其推論輸出值。 
5.計算輸出層和隱藏層的差距向量 。 
(a) 計算輸出層差距量 j     jjjjj YTYY  1         (10) 
其中 j 是輸出層第 j 個神經元的差距
量。 
(b) 計算隱藏層差距量 h     
j
jhjhhh hyWHH  _1 (11) 
其中 h 是隱藏層第 h個神經元的差距
量。 
6.計算各層神經元間加權值修正量及偏權值
修正量。 
(a) 計算輸出層權值修正量 
hjhjhj hyWHhyW __    (12) 
jjj            (13) 
其中 hjhyW _ 為隱藏層第 h個神經元與
輸出層第 j 個神經元間的加權值修正
量， j 為輸出層第 j個神經元的偏權值
修量。 
(b) 計算隱藏層權值修正量 
ihihih xhWXxhW __    (14) 
hhh            (15) 
其中 ihxhW _ 為輸入層第 i個神經元與
隱藏層第 h個神經元間的加權值修正
量， h 為隱藏層第h個神經元的偏權值
修正量。 
7.更新網路各層間的加權值與偏權值。 
(a) 更新隱藏層與輸出層間的加權值
hjhyW _ 與偏權值 j  
hjhjhj hyWhyWhyW ___     (16) 
jjj                    (17) 
(b) 更新輸出層與隱藏層間的加權值
ihxhW _ 與偏權值 h  
ihihih xhWxhWxhW ___     (18) 
hhh                    (19) 
8.重複步驟 3～7直到網路收斂。 
定義一誤差平方和函數 (Mean Squared 
Error，MSE)來測試網路是否達到收歛，其
結果在小於一合理範圍內即可達到收歛。 
  
j
jj YTMSE
2
2
1              (20) 
d. 輸出層將前一層隱藏層演算結果做結合，
最後透過 L5辨識出瑕疵種類。 
四、實驗規劃與結果討論 
由於有機薄膜層為透明薄膜層，所以在光
源上不使用自然光而是使用紫外光，目的在於
激發有機薄膜層，經過紫外光激發有機薄膜層
會造成螢光顯影，有瑕疵區塊灰階亮度會高於
無瑕疵影像灰階亮度，故此會顯影出有瑕疵之
影像。 
如上述所提及，顯影的瑕疵影像雖然亮度
過低，但有瑕疵影像部分其灰階度會高於無瑕
疵影像灰階度，故此可利用灰階度來判斷有無
瑕疵，研究中採用機率統計中最常用為統計分
佈程度的標準差(Standard Deviation)來分析影
像中像素分佈的情形，簡單來說標準差就是利
用有瑕疵影像與無瑕疵影像灰階值差異，來描
述瑕疵分佈程度；瑕疵像素可看成影像中的雜
訊干擾，因此可藉由雜訊的分佈程度，來判斷
影像中是否有瑕疵的存在。一張影像標準差定
義如式(21)： 
 
 

M
x
N
y
fyxf
NM 1 1
2
),(1      (21) 
其中 f(x,y)為待檢測影像的灰階值， f 為無瑕
疵影像的平均灰階值。根據標準差的定義，可
以得知影像中像素灰階差異小有較小的標準
差，表示影像中沒有瑕疵或者有些許的雜訊干
擾；反之灰階差異大則有較大的標準差，即影
像中確定有瑕疵的存在；本實驗測試之無瑕疵
影像的標準差數值分佈在 0~2之間，故經由試
誤法設定 σ＞3，即判斷檢測影像為瑕疵影像。 
判斷為瑕疵影像後，雖然紫外光能讓有瑕
疵的有機發光層顯影，不過因為去除自然光因
素，使得瑕疵影像灰階值差異不明顯，此時就
必需透過影像品質提升來增加灰階值差異幅
度，在提升灰階亮度方面使用最近鄰內插法，
明顯提升瑕疵影像資訊；不過此時影像內含雜
訊量依然過高，必需透過濾波器消除雜訊，其
中又以中央加權中值法濾波器效果最好，能夠
消除雜訊又能保留刮痕瑕疵的特徵值。 
此時再透過統計式門檻值將瑕疵像素分割
出來，將瑕疵影像分割成瑕疵主體與背景，通
常分割出的背景型態還是過於破碎，故此要利
用型態學上的閉合運算來填補瑕疵輪廓上的
8 
種特徵值可將有機發光層瑕疵如以下流程做
分類：首先，透過緊緻性可以清楚區分刮痕瑕
疵，由於刮痕輪廓較長面積較小所以緊致性會
極大；接著利用質心灰階對比可以順利區分雜
點瑕疵，而該特徵值是根據雜點質心灰階值皆
相近於背景特性，故此質心灰階對比可辨別雜
點瑕疵；最後以厚度差判別出塗佈不均與氣泡
瑕疵，其厚度差是突顯塗佈不均狹長型的瑕疵
型態特性，以及氣泡長寬相似之特性。 
經由上述介紹特徵值的計算方法，進而將
80 筆瑕疵樣本特徵值計算出來，為了更容易
看出四種瑕疵的區別，我們利用平均值的方式
表示如表 1。而圖 9 與圖 10 為三種特徵值的
相對分佈圖。 
表 1 瑕疵特徵平均值 
瑕疵種類 緊緻性 厚度差 質心灰階對比
氣泡 7.891 6.1 3.560 
塗佈不均 16.153 58.6 3.262 
雜點 25.513 2.8 1.101 
刮痕 258.859 2.6 1.778 
 
0
10
20
30
40
50
60
70
0 50 100 150 200 250 300 350
緊緻性
厚
度
差
刮痕 氣泡 塗佈不均 雜點
 
圖 9 緊緻性與厚度差之分佈圖 
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
0 50 100 150 200 250 300 350
緊緻性
質
心
灰
階
對
比
刮痕 氣泡 塗佈不均 雜點
 
圖 10 瑕疵緊緻性與質心灰階對比之分佈圖 
由圖 9緊緻性與厚度差之分佈圖觀察，很
明顯的將四種瑕疵分成三個區塊，若以紅色弧
線來區分，可分為區域內的氣泡與雜點、區域
右側的刮痕以及區域上方的塗佈不均瑕疵，唯
一的缺點是在區域內的氣泡與雜點瑕疵混雜
在一起，故此必需再增加一特徵值，以利於區
分弧線內混雜的兩者。 
如圖 10所示，可觀察出原先混雜在一起的
雜點與氣泡已區分開來，且將瑕疵分為三種區
域，雖然此圖氣泡與塗佈不均仍混雜在一起，
不過由於圖 9當中可觀察到緊緻性與厚度差
特徵已將兩者分開，故此由兩張特徵分佈圖初
步可判斷選取的三個特徵值可有效辨識待判
別之四種瑕疵，而其分類結果驗證將在下章節
使用模糊類神經驗證。 
4.3 模糊類神經瑕疵分類 
最後將 80 筆統計數據導入模糊類神經分
類器，其目的將三種特徵值數據資訊辨識分類
成四種瑕疵種類；在架構上總共有四層，分別
為輸入層、模糊層、隱藏層以及輸出層，輸入
層為 3個特徵值的輸入節點；模糊層採用的是
三角型函數作為歸屬函數，將數據語意化為極
大、大、中以及小，而三種特徵值歸屬函數實
例如圖 11、12、13，因三種特徵值語四種語
意變化，故會有 3×4=12 總共 12 個歸屬函數
節點；而隱藏層根據經驗設定成歸屬函數節點
與輸出節點和之一半(12+4)/2=8，故有 8個隱
藏節點；最後將輸出層結果綜合輸出即為分類
結果：模糊類神經網路學習速率與慣性因子皆
設定為 0.5，最後經過 20000訓練次數而達成
模糊類神經之學習。 
在實際瑕疵檢測上，通常是利用設計好的
訓練資料庫，進而判斷大量的瑕疵樣本，故此
在實驗設計上，比照實際瑕疵檢測系統，設計
一瑕疵訓練資料庫，用以分析特徵值抓取好
壞，進一步辨識推論資料庫瑕疵樣本。 
 
圖 11 厚度差三角形歸屬函數 
 
圖 12 緊緻性三角形歸屬函數 
 
圖 13 質心灰階對比三角形歸屬函數 
10 
觀測方式，該方法雖然能人工肉眼檢測，但是
由於 SEM解析度極高，只能小範圍檢測，若
要應用在將來產線是絕對不可能的，而本研究
貢獻在於提出一套檢測透明有機發光層系
統，並且能進一步利用模糊分類系統辨識出瑕
疵種類，以供將來製程產線工程人員參考。 
 
六、參考文獻 
[1] C. Hecht and G. Dishon, “Automatic optical 
inspection (AOI),” Proceedings of the 1990 
40th Electronic Components and Technology 
Conference, vol. 1, pp. 659-661, 1990. 
[2] 楊富名，“紫外光照射處理對有機半導體電
特性影響之研究”，國立彰化師範大學光電
科技研究所， 2007。 
[3] C. J. Huang, C. F. Wu and C. C. Wang, 
“Image processing techniques for wafer 
defect cluster identification,” IEEE Design 
& Test of Computers, vol. 19, no. 2, pp. 
44-48, 2002. 
[4] S. J. Ko and Y. H. Lee, “Center weighted 
median filters and their applications to 
image enhancement,” IEEE Trans. on 
Circuits and Systems, vol. 38, no. 9, pp. 
984-993, 1991. 
[5] M. Unser, A. Aldroubi and M. Eden, 
“Polynomial spline signal approximations: 
filter design and asymptotic equivalence 
with shannon’s sampling theorem,” IEEE 
Trans. Information Theory, vol. 38, no. 1, pp. 
99-103, January 1992. 
[6] 劉鴻明，“應用於影像內插法之研究”，中
原大學資訊工程學系碩士學位論文， 
2005。 
[7] N. Otsu, “A threshold selection method form 
gray level histogram,” IEEE Trans. on 
System, Man, and Cybernetics, Sem 8, pp. 
62-66, 1978. 
[8] J. N. Kapur, P. K. Sahoo and A. K. C. Wong, 
“A new method for gray-level picture 
thresholding using the entropy of the 
histogram,” Computer Vision, Graphics and 
Image Processing, vol. 29, no. 3, pp. 
273-285, 1985. 
[9] T. Markiewicz, S. Osowski, B. Marianska 
and L. Moszczyński, “Automatic recognition 
of the blood cells of myelogenous leukemia 
using SVM,” International Joint Conference 
on Neural Networks, vol. 4, pp. 2496-2501, 
2005. 
[10] 李玫憶，“細胞次結構影像辨識系統”，私
立中原大學醫學工程系碩士學位論文，
2005。 
[11] C. T. Su, T. Yang and C. M. Ke, “A 
neural-network approach for semiconductor 
wafer post-sawing inspection,” IEEE Trans. 
on Semicond. Manuf., vol. 15, no 2, pp. 
260-266, 2002. 
[12] 張子仁，“模糊類神經網路影像校準方法
應用在精密樣板比對”，中原大學機械工程
學系碩士學位論文，2003。 
[13] 鐘國亮編著，影像處理與電腦視覺第三
版，東華書局，2005。 
[14] 陳建堂，“偏光膜外觀瑕疵之影像檢測系
統開發”，國立台灣科技大學高分子工程研
究所碩士學位論文，2008。 
[15] F. J. Lin, R. J. Wai and H. P. Chen, “A PM 
synchronous servo motor drive with an 
on-line trained fuzzy neural network 
controller,” IEEE Trans. on Energy 
Conversion, vol. 13, no. 4, pp. 319-325, 
1998. 
[16] F. J. Lin, W. J. Hwang and R. J. Wai, “A 
supervisory fuzzy neural network control 
system for tracking periodic inputs,” IEEE 
Trans. on Fuzzy Systems, vol. 7, no.1, pp. 
41-52, 1999. 
[17] Y. C. Chen and C. C. Teng, “A model 
reference control structure using a fuzzy 
neural network,” Fuzzy Sets and Systems, 
vol. 73, pp. 291-312, 1995. 
[18] C. T. Su, T. Yang and C. M. Ke, “A 
neural-network approach for semiconductor 
wafer post-sawing inspection,” IEEE Trans. 
on Semiconductor Manufacturing, vol. 15, 
no 2, pp. 260-266, 2002. 
[19] L. X. Wang, “A course in fuzzy systems 
and control,” Prentice-Hall, New Jersey, 
1997. 
[20] K. S. Narendra and K. Parthasarathy, 
“Identification and control of dynamical 
systems using neural networks,” IEEE Trans. 
on Neural Networks, vol. 1, no. 1, pp. 4-27, 
1990. 
[21] J. Zhang and A. J. Morris, “Recurrent 
neural-fuzzy networks for nonlinear process 
modeling,” IEEE Trans. on Neural Networks, 
vol. 10, no. 2, pp. 313-326, 1999. 
99 年度專題研究計畫研究成果彙整表 
計畫主持人：黃昌群 計畫編號：99-2221-E-011-009- 
計畫名稱：有機發光二極體有機發光層瑕疵檢測系統之開發 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 1 1 100%  
研究報告/技術報告 1 1 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 1 1 100%  
博士生 1 1 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
