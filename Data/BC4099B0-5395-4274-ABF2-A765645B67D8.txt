_________ 
行政院國家科學委員會補助專題研究計畫成果報告 
 
空時碼為基礎之多輸入多輸出正交分頻多工多重存取系統: 通道估
測、同步補償及接收濾波器的設計 
Channel estimation, synchronization and receiver design for 
STBC-based MIMO OFDMA uplink transmissions 
計畫編號：NSC 97－2221－E－030－003－ 
執行期間： 97 年 08 月 1 日至 98 年 07 月 31 日 
計畫主持人：余金郎  教授 
計畫參與人員：吳俊賢、陳誌祥、翁小曼、洪大祐 
 
中文摘要 
藉由少量的引導信號，空時碼(STBC)的多輸入多
輸出(MIMO)補零正交分頻多工技術(ZP-OFDM)可在多
使用者方案下提供很好的性能。然而，對於複數對稱訊
號卻不然，因此在此計畫當中，針對複數輸入訊號發展
一個新的通道估測和等化技術。運用 Alamonti 空時碼
(STBC)的架構，我們提出 STBC MIMO ZP-OFDM 子空
間通道估測法，我們證明通道估測的正確與唯一性。另
外由於子空間通道估測方法對於收集的資料量非常敏
感，因此我們將利用空時碼前後兩個時間所接收到的資
料之間的關聯加入 forward-backward 平均法的技術以改
善通道估測的性能以及增加所需收集的資料量以加快收
斂速度。最後在濾波器的設計方面，我們將利用空時碼
的特性改良 MMSE 濾波器，可有效減少系統複雜度，並
減少誤碼率。 
關鍵詞：空時編碼，正交分頻多工系統，半盲通道估測，
多輸入多輸出，多使用者檢波，最小均方誤差值等化器。 
 
英文摘要 
The space-time block code (STBC) multiple-input 
multiple-output (MIMO) zero-padding orthogonal 
frequency division multiplexing (ZP-OFDM) has been 
widely investigated in recent years. It provides a good 
performance for the multi-user scenario with a small 
number of pilots. However, it would fail in face of complex 
symmetric signals. In this paper, novel channel estimation 
and equalization for complex input signals are investigated. 
With the Alamouti-like STBC scheme, the channel impulse 
responses of the space-time coded MIMO ZP-OFDM 
system are shown to be identifiable up to two ambiguity 
matrices by subspace channel estimation. The frequency 
domain minimum mean-square error (MMSE) equalizer is 
then employed to detect the OFDM symbols. Furthermore, 
we propose a forward-backward averaging technique to 
enhance the performances of blind channel estimation. The 
weight analysis for the MMSE equalizer is also conducted 
to reduce the complexity of system design. Computer 
simulations demonstrate the effectiveness and correctness 
of channel estimation and weight analysis for the 
space-time coded MIMO ZP-OFDM systems. 
 
Index Terms—space-time coding, OFDM, semi-blind 
channel estimation, MIMO, multi-user detection, MMSE 
equalizer 
  
  
                                                 
 
 
work correctly for the complex input signal scenario 
because of the rank deficiency of signal subspace. 
Unfortunately, OFDM systems, like IEEE802.11a/g, usually 
adopt high-order modulation schemes such as 16-QAM or 
higher order ones for high-speed transmission. The main 
contribution of this paper is to design the STC-ZP-OFDM 
systems for complex input signals. Using the Alamouti-like 
space-time block code (STBC), we establish the signal 
model of the MIMO STC-ZP-OFDM system followed by 
the semi-blind subspace channel estimation. Extending the 
identifiability analysis in [30], we show that the CIRs of 
MIMO STC-OFDM systems are identifiable up to two 
ambiguity matrices. With the estimated channel, the 
frequency domain minimum mean-square error (MMSE) 
equalizer is then employed to detect OFDM symbols. 
Another contribution of this paper is the performance 
enhancement of channel estimators and the weight analysis 
of MMSE equalizers. We propose a forward-backward (FB) 
averaging technique to enhance the performances of blind 
channel estimation. The FB averaging technique is 
extensively used in adaptive beamforming [33] and 
STBC-CDMA systems [34]. Owing to the property of 
STBC, the FB averaging technique can be applied here. 
Furthermore, the weight analysis for MMSE equalizers is 
also performed in which the computation complexity of the 
system design is reduced largely. 
The rest of this paper is organized as follows. In Section 
II, the signal model for complex symmetric signals is 
reviewed and the problem formulation is discussed. The 
novel subspace channel estimation for complex input 
signals is proposed in Section III. The channel 
identifiability is analyzed in Section IV. In Section V, the 
equalization and symbol detection are investigated. The FB 
averaging technique is presented and the weight analysis 
for MMSE equalizer is examined in Section VI. Section VII 
shows simulation results. Finally, conclusions are given in 
Section VIII. 
Notation: Vectors and matrices are denoted by boldface 
lower and upper case letters, respectively; superscripts of 
( ) ( ) ( )* , ,T H⋅ ⋅ ⋅  denote the complex conjugate, transpose 
and conjugate transpose, respectively; KI  denotes a 
K K×  identity matrix; 2      
K
K
K
⎡ ⎤= ⎢ ⎥−⎣ ⎦
0 I
M
I 0
 denotes a 
2 2K K×  permutation matrix satisfying 
2 2 2 2 2
H H
K K K K K= =M M M M I ; 0 denotes a zero vector or 
matrix with all zero entries; [ ]E ⋅  denotes the statistical 
expectation; ⋅  denotes the matrix or vector Frobenius 
norm; ⊗  denotes the Kronecker product; ( )Tr ⋅  is the 
trace of a matrix and ( )diag ⋅  denotes a diagonal matrix. 
  
II. SIGNAL MODEL AND PROBLEM FORMULATION 
Consider a K-user quasi-synchronous uplink MIMO 
OFDM system shown in Fig. 1 which is equipped with two 
transmit antennas using Alamouti’s STBC scheme at the 
transmitter and ( )J J K≥  receive antennas at the receiver. 
It is straightforward to apply this system to downlink with 
K virtual users [30]. Let ( ) ( ) ( )= (0)  ( 1)
Tk k k
i i is s N⎡ ⎤−⎣ ⎦s "  be 
the OFDM block symbol of user k transmitted at time i and 
( ) ( ) ( )= (0)  ( 1)
Tk k k
i i iu u N⎡ ⎤−⎣ ⎦u "  be the inverse discrete 
Fourier transform (IDFT) of ( )kis , respectively. For each 
user, two consecutive block symbols ( )2
k
is  and 
( )
2 1
k
i+s  are 
transmitted across the transmit antennas by the following 
coding scheme 
( ) ( ) ( ) ( )*
2 2 2 1 2 +1
( ) ( ) ( ) ( )
2 2 1 2 +1 2
 ,  
 ,  
k k k k
i i i i
k k k k
i i i i
+
∗
+
= = −
= =
s s s s
s s s s 
                       (1) 
where ( )kis  and 
( )k
is  indicate the coded block symbols 
transmitted through (2 1)-thk −  and (2 )-thk  transmit 
antennas, respectively. The coded block symbols are further 
transformed by IDFT operation 
( ) ( )
( ) ( )
k H k
i N i
k H k
i N i
=
=
u A s
u A s                              (2) 
where NA  is the N-point DFT matrix with (p,q)-th entry 
exp( 2 / )j pq N Nπ− . Let 
( ) ( )( , ) ( , ) ( , )0   ,Tj k j k j kh h L⎡ ⎤= ⎣ ⎦h "  1 2 ,  1k K j J= =" "  
eigenvalue 2ησ  and spans the orthogonal complement of 
H . The channel estimate is then obtained using the 
orthogonal property of Hn =U H 0 . However, the above 
result is not true for the complex symmetric signal scenario. 
For complex symmetric signal ( )kis , there are / 2 1N +  
different components herein. Note that ( )kiu  is also 
symmetric for complex symmetric signal ( )kis , that is, 
( ) ( )( ) = ( ), k ki iu n u N n−    1, , / 2 1n N= −" . Therefore, the 
vector iv  with size of 2KN has NK+2K different 
components in which vR  turns out to be singular. The 
rank of the noise subspace nU  is increased from 
2 2JM KN−  to 2 2JM KN K− −  and Hn =U H 0  is then 
not satisfied. Consequently, the subspace channel 
estimation proposed in [30] can work for real signals only 
but not for complex symmetric signals. In order to apply 
the STBC ZP-OFDM system to high-order modulation 
scheme such as 16-QAM or higher order ones, a novel 
semi-blind channel estimation is developed in the 
following.  
 
III. NOVEL SEMI-BLIND CHANNEL ESTIMATION 
In this section we propose a novel semi-blind channel 
estimation algorithm to resolve the problem stated in 
Section II. Let [ ]= (0)  ( 1) Tu u N −u … , 
[ ]= (0)  ( 1) Ts s N −s …  and HN=u A s , i.e. ( )u n  is the N 
point IDFT of ( )s k . Considering the complex-conjugate 
property of DFT/IDFT operation, the IDFT of *( )s k  is 
then given by *( )u N n− , which is expressed in 
matrix-vector form by 
* * * * = (0) ( 1)  (1)
TH
N u u N u⎡ ⎤−⎣ ⎦A s … . However, the 
irregular order of *HNA s  makes channel estimation 
difficult [35]. To ease the derivation of channel estimation, 
the Alamouti-like STBC scheme is proposed by adding a 
phase shift matrix onto the second input vector of the 
STBC coding matrix, 
( ) ( ) ( ) ( )
2 2 2 1 2 +1
( ) ( ) ( ) ( )
2 2 1 2 +1 2
,  
,  
k k k k
i i i i
k k k k
i i i i
∗
+
∗
+
= = −
= =
s s s Φs
s s s Φs              (11) 
where 2 2 ( 1)(1, , , )j N j N Ndiag e eπ π −=Φ " . Note that 
multiplying an OFDM block symbol *s  by the phase 
matrix Φ  will result in a circular time shift to the IDFT of 
*s , i.e., * * * *= ( 1)  (1) (0) 
TH
N u N u u⎡ ⎤−⎣ ⎦A Φs … .  Another 
Alamouti- like STBC scheme is presented in [36] for 
single-carrier block transmission over multipath fading 
channels. A permutation matrix is introduced to perform 
time reversal of the second input vector of the STBC 
coding matrix. With this permutation matrix, the diversity 
gains can be acquired with proper linear receiver 
processing. On the other hand, the phase shift matrix of the 
proposed Alamouti-like STBC scheme is used to adjust the 
IDFT of s* in order. 
Performing the IDFT operation on (11) and using the 
circular shift property of IDFT, we have 
( ) ( ) ( ) ( ) ( ) ( )*
2 2 2 2 1 2 1 2 1
( ) ( ) ( ) ( ) ( ) ( )*
2 2 2 1 2 +1 2 +1 2
,  
, 
k H k k k H k k
i N i i i N i N i
k H k k k H k k
i N i i i N i N i
+ + +
+
= = = = −
= = = =
u A s u u A s J u
u A s u u A s J u         (12) 
where NJ  is the N×N exchange matrix with ones on its 
anti-diagonal and zeros elsewhere. Similar to (6), the signal 
vectors 2ix  and 2 1i+x  for the modified STBC scheme are 
given by 
2 1 2 2 2 1 2
* *
2 1 1 2 1 2 2 2 1
i i i i
i NK i NK i i
+
+ + +
= + +
= − + +
x H u H u η
x H J u H J u η
 (13) 
where NK N K= ⊗J J I . Using (13), we can obtain the signal 
model ir  in (8) where H  is modified by 
1 2
2 1NK NK
∗ ∗
⎡ ⎤= ⎢ ⎥−⎣ ⎦
H H
H
H J H J
.            (14) 
Through (8) and (14), we then develop a novel semi-blind 
channel estimation algorithm next. 
Note that there is no constraint on the OFDM block 
symbol ( )kis  except that its elements are independent. 
Therefore, the components in iv  are uncorrelated and the 
correlation matrix vR  is nonsingular. The 
eigenvalue-eigenvector decomposition of rR  in (10) is 
then given by  
system in a single-user environment [26], where the 
subspace channel estimation is developed by using the 
frequency-domain signal after converting the multipath 
fading channels to a set of parallel flat-faded subchannels. 
Since the frequency-domain signals in [26] and the 
time-domain signals in (8) are not unitarily related, the 
subspace decompositions on the corresponding correlation 
matrices are quite different and the channel identifiability in 
[26] can not be applied directly here. Moreover, a 
multi-user scenario with multiple receive antennas is 
studied in this paper. Therefore, it is worth to further 
investigate the identifiability problem of the proposed 
channel estimation. 
The identifiability analysis is heavily dependent on the 
structure of H  in (14). By defining 
1 2
* *
2 1
( ) ( )
( )
( ) ( )
l l
l
L l L l
⎡ ⎤= ⎢ ⎥− − −⎣ ⎦
h h
F
h h
, we have the following 
lemma. 
Lemma 1: If (0)F  is of full column rank, H  is also of 
full column rank. 
Proof: We can find two permutation matrices P and Q such 
that 
                =F PHQ                  (25) 
where P and Q are row and column permutation matrices, 
respectively 
[ ]1 2 1 TM M M J+= ⊗P ω ω ω ω I"     (26) 
[ ]1 1 2  N N N K+= ⊗Q ε ε ε ε I"      (27) 
and iω  and iε  respectively indicate 2   1M ×  and 
2   1N ×  vectors in which the -thi  element is one and the 
others are zeros. We then have 
(0)
(0)
( )
 =
( ) (0)
( )
L
L
L
⎡ ⎤⎢ ⎥⎢ ⎥⎢ ⎥⎢ ⎥⎢ ⎥⎢ ⎥⎢ ⎥⎣ ⎦
F 0
F
F
F
F F
0 F
#
# %
%
% #
.       (28) 
Since (0)F  is of full column rank and F  is a 
2 2JM KN×  block lower triangular matrix, we can easily 
show from [Theorem 1, 29] that F  and hence H  are of 
full column rank. 
Lemma 2: If ( )lF  is of full column rank, ( )L l−F  is 
also of full column rank. 
Proof: Let ( )L l− =F α 0  where α  is a 2 1K ×  
coefficient vector. Partition α  as two 1K ×  subvectors, 
1 2(  )
T T T=α α α . Then ( )L l− =F α 0  can be expressed by  
1 1 2 2
* *
2 1 1 2
( ) ( )
( ) ( )  .
L l L l
l l
− + − =
− =
h α h α 0
h α h α 0
          (29) 
Taking complex conjugate on (29) yields 
* *
1 2 2 2
* * * *
2 1 1 1
( ) ( )
( )
( ) ( )
l l
l
L l L l
⎡ ⎤ ⎡ ⎤⎡ ⎤ = =⎢ ⎥ ⎢ ⎥⎢ ⎥− − − − −⎣ ⎦ ⎣ ⎦ ⎣ ⎦
h h α α
F 0
h h α α
. (30) 
Since ( )lF  is of full column rank, we have 1 2= =α α 0 . 
Therefore, we conclude that ( )L l−F  is also of full 
column rank.  
Theorem 3: Let ( )j lh

 be a matrix that has the same 
dimension as that of ( )j lh , jH

 and H

 be composed by 
( )j lh

 as (7) and (14), and ( )lF

 and F

 be defined 
similar to ( )lF  and F , respectively. Assuming that (0)F

, 
(0)F  and 1 2* *
2 1
(0) (0)
(0) (0)
⎡ ⎤⎢ ⎥−⎣ ⎦
h h
h h
 
   are all of full column rank, 
then if ( ) ( )span span=H H , we can find two K K×  
constant matrices 1b  and 2b  such that  
   
*
1 1 1 2 2
*
2 1 2 2 1
( ) = ( ) ( )
 ,   0, ,
( ) = ( )  + ( )
l l l
l L
l l l
− =h h b h b
h h b h b
 
"  .   (31) 
Proof: see Appendix A. 
From Theorem 3, we know that the channel coefficients 
can be obtained by subspace technique up to two K K×  
invertible matrices. Besides, though it is assumed that the 
channel order is known exactly in Theorem 3, the 
identifiability of channel estimation is still applied when the 
channel order is overestimated. Assume that the estimated 
channel order is L  with L L≥ . Then M N L= +  and 
the channel matrix in (14) becomes  
1 2
( ) ( )
2 1
( ) ( )
L L J NK L L J NK
NK NK
L L J NK L L J NK
− × − ×
∗ ∗
− × − ×
⎡ ⎤⎢ ⎥⎢ ⎥= ⎢ ⎥−⎢ ⎥⎢ ⎥⎣ ⎦
H H
0 0
H
H J H J
0 0
        (32) 
where the zero entries are caused by overestimation of the 
true channel order. When considering the identifiability of 
channel estimation, one can move the zero rows in (32) to 
systems is straightforward. Besides, MIMO STC-OFDM 
systems are much less sensitive to channel zeros. 
Therefore, without loss of generality, the 
ZP-OFDM-OLA equalizer is adopted in the subsequent 
discussions to perform the symbol detection.  
VI. PERFORMANCE ENHANCEMENT AND WEIGHT 
ANALYSIS 
The performance enhancement achieved using the FB 
averaging technique and the weight analysis of MMSE 
equalizers are discussed in this section.  
 
A. FB Averaging Technique 
The ensemble correlation matrix is not available 
practically, and instead, the sample correlation matrix is 
used 
1
1 SN H
r i i
isN =
= ∑R rr             (41) 
where SN  is the number of block signals. The random 
error between the sample correlation matrix rR

 and the 
ensemble correlation matrix rR  will result in the 
performance degradation of receiver design. Because of the 
STBC property, the FB averaging technique can be applied 
here to reduce the random error of sample correlation 
matrix and enhance the channel estimation performance. 
Using the permutation matrix 2MJM , we first define a 
backward block signal ibr  by 
*
2ib MJ i=r M r , which is 
given as  
*
2 +1 2 +11 2 2 +1
* ** * *
2 22 1 2
 
-         
i iNK NK i
ib
i ii
⎡ ⎤−⎡ ⎤ ⎡ ⎤⎡ ⎤= = +⎢ ⎥⎢ ⎥ ⎢ ⎥⎢ ⎥ −− ⎢ ⎥⎣ ⎦⎣ ⎦ ⎣ ⎦⎣ ⎦
x ηH J H J u
r
x ηH H u
.    (42) 
With the backward block signal in (42), we have the 
following Lemma. 
Lemma 4: Suppose that rR  has a form as in (10) and 
the ensemble correlation matrix of ibr  is given by 
*
2 2E
H H
rb ib ib MJ r MJ⎡ ⎤= =⎣ ⎦R r r M R M . Then we have rb r=R R . 
Proof: see Appendix C. 
From Lemma 4, we obtain that ir  and ibr  have 
identical ensemble correlation matrix and therefore, ibr  
can be treated as another different block signal for ir . 
Interestingly, using the fact that the exchange matrix NKJ  
is unitary and satisfies 1NK NK
− =J J , we can express ibr  in 
(42) by 
*
2 +11 2 2 +1
**
2 1 22
            
 + 
   
iNK i
ib
NK NK iNK i
∗ ∗
⎡ ⎤− ⎡ ⎤⎡ ⎤= ⎢ ⎥ ⎢ ⎥⎢ ⎥− −⎢ ⎥⎣ ⎦ ⎣ ⎦⎣ ⎦
ηH H J u
r
H J H J ηJ u
.    (43) 
Comparing (43) with (13) reveals that the transmitted signal 
in ibr  is 
*
2 +1
*
2  
NK i
NK i
⎡ ⎤−⎢ ⎥⎢ ⎥⎣ ⎦
J u
J u
 while that in ir  is 
2
2 1
i
i+
⎡ ⎤⎢ ⎥⎣ ⎦
u
u
. The 
corresponding backward sample correlation matrix is 
computed by * *2 2
1
1 ( )
SN
H H
rb MJ i i MJ
isN =
= ∑R M r r M . The 
forward-backward sample correlation matrix is then given 
by 
*
2 2
1
1 1
2 2
SN
H T H
rfb r rb i i MJ i i MJ
isN =
⎡ ⎤ ⎡ ⎤= + = +⎣ ⎦⎣ ⎦ ∑R R R rr M r r M   . (44) 
The forward-backward sample correlation matrix with 
2 SN  block signals is much closer to the ensemble 
correlation matrix rR  than the sample correlation matrix 
in (41). Consequently, with the forward-backward sample 
correlation matrix, the perturbation of noise subspace is 
reduced and the correctness of channel estimation is 
improved.  
 
B. Weight Analysis 
The MMSE equalizer ( )nW  in (40) is analyzed in this 
subsection. We first partition ( )nT  and ( )nW  into  
[ ]1 2( ) ( )n nT T  and [ ]1 2( ) ( )n nW W , respectively, where 
2 -1
1 1
2 -1
2 2
( ) ( ) ( )
( ) ( ) ( )
s z
s z
n n n
n n n
σ
σ
=
=
W  R T
W  R T
             (45) 
and 1 21 2
2 1
( ) ( )
( ) ,  ( )
( ) ( )
n n
n n
n n∗ ∗
⎡ ⎤ ⎡ ⎤= =⎢ ⎥ ⎢ ⎥−⎣ ⎦ ⎣ ⎦
g g
T  T
g g
. With the 
definitions of 1( )nT , 2 ( )nT  and 2JM , we have  
1 2 2( ) ( )Jn n
∗= −T M T  and 2 2 1( ) ( )Jn n∗=T M T . From the 
above relations, ( )nT  can then be expressed by  
*
2 2( ) ( )J Kn n=T M T M .                 (46) 
With 2 2 1( ) ( )Jn n
∗=T M T , 2 ( )nW  in (45) becomes 
12 1 2
2 2 1 2 1( ) ( ) ( ) ( ) ( )
H
s z J s J zn n n n nσ σ −− ∗ ∗⎡ ⎤= = ⎣ ⎦W  R M T  M R T . (47) 
Furthermore, with (39) and (46), 2 ( )
H
J z nM R  is simplified 
by 
to that by Zeng [30]. When the FB technique is used, the 
corresponding BER is accelerated to a lower level in Fig. 7. 
For example, the BER using the FB technique approximates 
to 10-3 while the others are about 10-1 when Ns=100. Figs. 8 
and 9 study the case of the QPSK modulation scheme. The 
plots confirm the effectiveness of weight analysis and FB 
technique.   
Examples 3: The near-far effect for the compared 
methods is examined in this example. The transmitted 
power of user 1 is 10dB lower than that of user 2. For 
simplicity, only the BERs with pilot-based channel 
estimation are shown in Figs. 10 and 11 for the cases of 
BPSK and QPSK modulation schemes, respectively. It is 
obvious that the proposed methods perform better than that 
in [30], especially when the input SNR becomes large. 
Since user 2 has a transmitted power larger than user 1, the 
BER of user 2 is lower than that of user 1. 
Examples 4: In the last example, we study a single-user 
scenario where the two channels share common zeros. The 
two transfer functions are given by [30] 
( )
1
1
2 3
4 5
6 1
2
( ) 0.8644 0.3962 (0.0942 0.9649 )
         ( 0.8519 0.1684 ) (0.8735 1.9654 )
         ( 0.4380 0.7443 ) ( 0.4297 0.5523 )
         ( 1.1027 0.8197 ) 2 2
( ) 1.1091 0.86
h z i i z
i z i z
i z i z
i z z i
h z
−
− −
− −
− −
⎡= + + −⎣
+ − + + −
+ − − + − −
⎤+ − − − −⎦
= −
( )
1
2 3
4 5
6 1
61 ( 0.6149 2.1165 )
         ( 0.2546 0.9645 ) ( 0.2698 0.2127 )
         ( 1.6720 0.4779 ) ( 1.8760 0.1007 )
         (0.5750 0.2974 ) 2 2  .
i i z
i z i z
i z i z
i z z i
−
− −
− −
− −
⎡ + − −⎣
+ − − + − +
+ − + + − +
⎤+ + − −⎦
 (53) 
As shown in Figs. 12 and 13, the proposed method has a 
lower BER than that in [30] and close to that of MMSE 
equalizer with true channels.  
 
VIII. CONCLUSIONS 
The semi-blind channel estimation and equalization of 
MIMO STC-ZP-OFDM system are investigated in this 
paper. Unlike that in [30], our proposed methods using the 
Alamouti-like STBC scheme work very well not only for 
real input signals but also for complex input signals. The 
CIR by the subspace channel estimation is shown to be 
identifiable up to two ambiguity matrices. The FB 
averaging technique using the STBC property is also 
proposed to enhance the channel estimation performance. 
Moreover, the MMSE equalizer weights are analyzed to 
reduce computational cost. Computer simulations confirm 
the superiority of the proposed system.  
 
APPENDIX A: PROOF OF THEOREM 3 
According to assumptions that H  and H

 have 
identical structures and both (0)F  and (0)F

 are of full 
column rank, it is seen from Lemma 1 that H  and Hˆ  are 
matrices of full column rank. We then have that 
( ) ( )span span=H H  if and only if there exists a 
2   2KN KN×  full rank matrix B  such that 
 = H HB

.                 (54) 
With =F PHQ   and using (25) and (54), F  becomes 
H H H= = =F PHBQ PP FQ BQ FQ BQ   .   (55) 
Note that P  and Q  are unitary matrices, i.e. H =P P I  
and H =Q Q I . Since HQ BQ  is also invertible, we have 
( ) ( )span span=F F . Partition HQ BQ  into an N N×  
block matrix, 
1,1 1,2 1,
2,1 2,2 2,
,1 ,2 ,
      
     
 = 
                     
   
N
NH
N N N N
⎡ ⎤⎢ ⎥⎢ ⎥⎢ ⎥⎢ ⎥⎢ ⎥⎣ ⎦
B B B
B B B
Q BQ
B B B
"
"
# # #
"
     (56) 
where 2 2, , , 1, ,
K K
n m n m N
×∈ =B C … . Since F  and F  are 
block lower triangular matrices and (0)F

 and (0)F  are 
of full column rank, we can show from [Theorem 2, 29] that 
HQ BQ  is a block lower triangular matrix with identical 
diagonal blocks. Similarly, since F  and F

 are also block 
upper triangular matrices and ( )LF

 and ( )LF  are of full 
column rank as revealed in Lemma 2, it is easily shown that 
HQ BQ  is a block upper triangular matrix with identical 
diagonal blocks. Therefore, HQ BQ  can be reduced to a 
block diagonal matrix 
 = T N ⊗Q BQ I b                (57) 
where b  is a 2 2K K×  invertible matrix. Partition b  
by 
     1 2
3 4
 
 =  
 
⎡ ⎤⎢ ⎥⎣ ⎦
b b
b
b b
               (58) 
( )1 2⊗B B  ( )3 4 1 3 2 4⊗ = ⊗B B B B B B  and 
( )1 2 1 2H H H⊗ = ⊗B B B B   where { }iB  are matrices with 
right dimensions [33]. Using these two identities, the 
correlation matrix of iv  can then be calculated from (70) 
and (71) by 
( ) ( ) ( )2 2 2 2H Hv NK NK= ⊗ ⊗ ⊗ = ⊗R I B I Σ I B I BΣ B . (72) 
H
NKBΣ B  in (72) is further simplified by 
[ ]
(0) (0)
( )
( 1) ( 1)
(0)
(0) ( 1)
( 1)
 .
HH H
K N K N
H
NK K N
H H
K N K N
H
K N
K N K N
H
K N
N K NK
N N
N
N
⎡ ⎤ ⎡ ⎤⊗ ⊗⎢ ⎥ ⎢ ⎥= ⊗⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥⊗ − ⊗ −⎣ ⎦ ⎣ ⎦
⎡ ⎤⊗⎢ ⎥= ⊗ ⊗ −⎢ ⎥⎢ ⎥⊗ −⎣ ⎦
= ⊗ ≡
I A I A
BΣ B Σ I
 I A  I A
Σ A
I A I A
 Σ A
I Σ Σ
# #
# "   (73) 
where HN N N=A A I  has been used in (73). Substituting (73) 
into (72) yields 
2v NK= ⊗R I Σ .             (74) 
Next, using *2 2
H
rb MJ r MJ=R M R M  and (10),  rbR  is 
obtained by  
* 2
2 2 2
T H
rb MJ v MJ MJησ= +R M H R H M I .      (75) 
With the definitions of 2MJM  and H in (14), 
*
2MJM H becomes  
2 1*
2
1 2
2( ) .
NKNK NK
MJ
NK
H
NK
∗ ∗
−− ⎡ ⎤⎡ ⎤= = ⎢ ⎥⎢ ⎥− −⎣ ⎦ ⎣ ⎦
= ⊗
0 JH J H J
M H H
J 0H H
H M J
   (76) 
We further show that 2 2( ) ( )
H H H
NK v NK v⊗ ⊗ =M J R M J R  
as follows. From (74), we have  
2 2 2
2
2
( )( )( )
( )( )( )
( )  .
H H H
NK NK NK
H
N K N K N K
N K v
⊗ ⊗ ⊗
= ⊗ ⊗ ⊗ ⊗
= ⊗ ⊗ =
M J I Σ M J
I J I I Σ J I
I I Σ R
    (77) 
Using (75)-(77), rbR  is finally computed as   
2
2 2 2
2
2
( ) ( )
 .
H H H H
rb NK v NK MJ
H
v MJ r
η
η
σ
σ
= ⊗ ⊗ +
= + =
R H M J R M J H I
HR H I R
 (78) 
Therefore, (78) completes the proof of Lemma 4. 
 
 
 
REFERENCE 
 
[1] J. Chuang and N. Sollenberger, “Beyond 3G: wideband wireless data 
access based on OFDM and dynamic packet assignment,” IEEE 
Communication Magazine, vol. 32, no. 1, pp. 78-87, 2000. 
[2] D. Agrawal, V. Tarokh, A. Naguib, and N. Seshadri, “Space–time 
coded OFDM for high data rate wireless communications over 
wideband channels,” in Proc. IEEE Vehicular Technology Conference, 
vol. 3, pp. 2232-2236, May 1998 
[3] Z, Liu, G. B. Giannakis, B. Muquet, and S. Zhou, “Space-time coding 
for broadband wireless communications,” Wireless Communications 
and Mobile Computing, vol. 1, no. 1, pp. 35-53, Jan.-Mar. 2001. 
[4] N. Al-Dhahir, C. Fragouli, A. Stamoulis, W. Younis, and R. 
Calderband, “Space-time processing for broadband wireless access,” 
IEEE Communications Magazine, pp. 136-142, Sept. 2002. 
[5] A.J. Paulraj, D.A. Gore, R.U. Nabar and H. Bolcskei, “An overview 
of MIMO communications – a key to gigabit wireless,” Proceedings 
of the IEEE, Vol. 92, No. 2, pp. 198-218, Feb. 2004. 
[6] A. F. Naguib, N. Seshadri, and A. R. Calderbank, “Increasing data rate 
over wireless channels,” IEEE Signal Processing Magazine, vol. 17, 
pp.76-92, May 2000. 
[7] S. Noh, Y. Jung, S. Lee, and J. Kim, “Low-Complexity Symbol 
Detector for MIMO-OFDM-Based Wireless LANs,” IEEE Trans. 
Circuit and Systems –II, vol. 53, no, 12, pp.1403-1407, Dec. 2006. 
[8] Y. Jung, J. Kim, S. Lee, H. Yoon and J. Kim, “Design and 
Implementation of MIMO-OFDM Baseband Processor for 
High-Speed Wireless LANs,” IEEE Trans. Circuit and Systems –II, 
vol. 54, no, 7, pp.631-635, July 2007. 
[9] ETSI Normalization Committee, “Radio Broadcasting Systems, 
Digital Audio Broadcasting (DAB) to mobile, portable and fixed 
receivers,” Norme ETSI, Sophia-Antipolis, France, Doc. ETS 300 401, 
1995-1997. 
[10] ETSI Normalization Committee, “Digital broadcasting systems for 
television, sound and data services; framing structure, channel coding 
and modulation for digital terrestrial television,” Norme ETSI, 
Sophia-Antipolis, France, Doc. pr ETS 300 744, 1996. 
[11] Part 11: Wireless LAN Medium Access Control (MAC) and Physical 
Layer Specifications (PHY)—High Speed Physical Layer in the 5 
GHz band, IEEE Standard 802.11a, Jan. 1999. 
[12] A. Doufexi, S. Armour, M. Butler, A. Nix, D. Bull, J. McGeehan, and 
P. Karlsson, "A comparison of the HIPERLAN/2 and IEEE 802.11a 
wireless LAN standards," IEEE Communications Magazine, vol. 40, 
no. 5, pp. 172-180, May 2002. 
[13] IEEE Standard for Local and Metropolitan Area Networks Part 16: 
Air Interface for Fixed Broadband Wireless Access Systems, IEEE Std 
802.16-2004. 
[14] H. Ali, A. Doucet, and Y. Hua, “Blind SOS subspace channel 
estimation and equalization techniques exploiting spatial diversity in 
OFDM systems,” Digital Signal Processing, vol. 14, pp. 171-202, 
March 2004. 
[15] H. Kameyama, T. Miyajima, and Z. Ding, "Perfect blind channel 
shortening for multicarrier systems," IEEE Trans. Circuits and 
System–I, vol.55, no.3, pp.851–860, April 2008. 
[16] B. Muquet, Z. Wang, G. B. Giannakis, M. D. Courville, and P. 
Duhamel, “Cyclic prefixing or zero padding for wireless multicarrier 
transmissions?,” IEEE Trans. Communications, vol. 50, no. 12, pp. 
2136-2148, Dec. 2002 
[17] H. Huang, H. Zou and Y. Wang, “A Two-Stage Direct Blind Symbol 
Recovery Method for Zero Padding OFDM System,” in Proc. 2nd 
IEEE International Symposium on Wireless Communication Systems, 
Siena, Italy, 2005, pp. 520-523 
[18] B. Li, S. Zhou, M. Stojanovic and L. Freitag, “Pilot Tone Based 
ZP-OFDM Demodulation for an Underwater Acoustic Channel,” in 
Proc. IEEE Oceans Conference, Boston, MA, September 2006. 
[19] Y. S. Chen and C. A. Lin, ``Blind channel identification for MIMO 
single carrier zero padding block transmission systems,'' IEEE trans. 
on Circuits and Systems–I, vol.55, no.6, pp.1571–1579, July 2008. 
[20] J. Wang, J. Song, Z. Yang, L. Yang and J. Wang, “Frames theoretic 
analysis of zero-padding OFDM over deep fading wireless channels,” 
IEEE Trans. Broadcasting, vol. 52,  issue 2, pp. 252-260, June 2006  
[21] B. Lu, X. Wang and Y. Li, “Iterative receivers for space-time 
block-coded OFDM systems in dispersive fading channels,” IEEE 
Trans. Wireless Communications., vol. 1, Issue 2, pp. 213-225, April 
2002  
[22] D.B. Lin, P.H. Chiang and H.J. Li, “Performance analysis of 
two-branch transmit diversity block-coded OFDM systems in 
time-varying multipath Rayleigh-fading channels,” IEEE Trans. 
Vehicular Technology, vol. 54,  Issue 1, pp. 136-148, Jan. 2005 
[23] Y. Li and N. Seshadri, “Channel estimation for OFDM systems with 
transmitter diversity in mobile wireless channels,” IEEE J. Select. 
Areas Commun., vol. 17, pp. 461-471, Mar. 1999. 
5 10 15 20 25 30
10
−6
10
−5
10
−4
10
−3
10
−2
10
−1
10
0
SNR(dB)
B
it 
E
rr
or
 R
at
e 
(B
E
R
)
 
 
pilot SS [26]
pilot SS
pilot SS with FB
optimal SS [26]
optimal SS
optimal SS with FB
true channel
 
Fig. 3. BER versus input SNR of the compared methods. 
Scenario is the same as that in Fig. 2.  
 
5 10 15 20 25 30
10
−4
10
−3
10
−2
10
−1
10
0
10
1
10
2
SNR(dB)
N
M
S
E
 o
f E
st
im
at
ed
 C
ha
nn
el
s
 
 
pilot SS
pilot SS with FB
optimal SS
optimal SS with FB
 
Fig. 4. Channel estimation performance versus input SNR. 
Scenario is the same as that in Fig. 2 except that QPSK 
modulation is used.  
 
5 10 15 20 25 30
10
−4
10
−3
10
−2
10
−1
10
0
SNR(dB)
B
it 
E
rr
or
 R
at
e 
(B
E
R
)
 
 
pilot SS
pilot SS with FB
optimal SS
optimal SS with FB
pilot SS with (49)
optimal SS with FB and (49)
true channel
 
Fig. 5. BER versus input SNR of the compared methods. 
Scenario is the same as that in Fig. 4.  
 
100 120 140 160 180 200 220 240 260 280 300
10
−3
10
−2
10
−1
10
0
10
1
10
2
Number of Block Signals
N
M
S
E
 o
f E
st
im
at
ed
 C
ha
nn
el
s
 
 
pilot SS [26]
pilot SS
pilot SS with FB
optimal SS [26]
optimal SS
optimal SS with FB
 
Fig. 6. Channel estimation performance versus the number 
of block signals. Scenario is the same as that in Fig. 2 
except for SNR=15dB.  
 
100 120 140 160 180 200 220 240 260 280 300
10
−4
10
−3
10
−2
10
−1
10
0
Number of Block Signals
B
it 
E
rr
or
 R
at
e 
(B
E
R
)
 
 
pilot SS [26]
pilot SS
pilot SS with FB
optimal SS [26]
optimal SS
optimal SS with FB
true channel
 
Fig. 7. BER versus the number of block signals. Scenario is 
the same as that in Fig. 6. 
100 120 140 160 180 200 220 240 260 280 300
10
−3
10
−2
10
−1
10
0
10
1
Number of Block Signals
N
M
S
E
 o
f E
st
im
at
ed
 C
ha
nn
el
s
 
 
pilot SS
pilot SS with FB
optimal SS
optimal SS with FB
 
Fig. 8. Channel estimation performance versus the number 
of block signals. Scenario is the same as that in Fig. 6 
except that QPSK modulation is used. 
 
計畫成果自評 
  正交分頻多工調變系統(OFDM)廣泛地應用於寬頻無線通訊系統。目前OFDM 已被採
用於一些無線傳輸標準，例如無線區域網路IEEE 802.11x、都會網路IEEE 802.16、個人網
路IEEE 802.20 及數位聲訊/視訊傳播(DAB/DVB)等。另外，空時編碼技術近年來廣泛地被
討論，而它與OFDM 系統也已成為第四代寬頻行動通訊標準技術之一。空時碼使用空間分
集特性配合特殊的編碼，以提供衰落通道下的分集增益。尤其加上多輸入多輸出(MIMO)
系統，可以有效地提高通訊容量及分集增益。但是多輸入多輸出系統的設計與分析的複雜
度也隨之增加。 
本研究計畫針對空時區塊碼 MIMO ZP-OFDM 的多使用者系統，探討在頻率選擇衰落
通道下，多使用者環境的空時區塊碼 MIMO ZP-OFDM 系統之通道估測及接收濾波器的設
計與分析。在多使用者存取相同頻帶的空時區塊碼MIMO ZP-OFDM 系統，其訊號模型的
建立遠比在單一使用者來的複雜，而所需探討議題也多了許多，我們提出一修正的空時區
塊碼，利用此碼，空時區塊碼 MIMO ZP-OFDM 的訊號模型可以有效的整理。利用子空間
正交的特性，我們提出子空間通道估測法，我們證明估測的正確與唯一性。另外由於子空
間通道估測方法對於收集的資料量非常敏感，因此我們利用空時區塊碼前後兩個時間所接
收到的資料之間的關聯加入 forward-backward 平均法以改善通道估測的性能及加快收斂
速度。最後在濾波器的設計方面，我們利用空時碼(STC)的特性改良MMSE濾波器，可有效
減少系統複雜度，並減少誤碼率。 
 本研究計畫可以使參與人員對於空時碼與多輸入多輸出正交分頻多工多重存取系統的
結合和對應的半盲目通道估測有完整之認識。因此本計畫的執行將有助於提升國內第四代
行動通訊技術的研發與多使用者偵測技術的研究水準。 
  本計劃的研究成果已發表於國外重要期刊[1][2]及歐洲無線通信高峰會研討會[3]. 
1. J.L. Yu and Yin-Cheng Lin, “Space-Time Coded MIMO ZP-OFDM Systems: Semi-Blind Channel 
Estimation and Equalization,” IEEE Trans. Circuit and Systems –I: Regular Papers, vol. 56, no. 7, 
pp. 1360-1372, July 2009 (EI,SCI) (NSC-96-2221-E-030-003-, NSC-97-2221-E-030-003-) 
2. J.L. Yu and Yin-Cheng Lin, “Comments on ‘Semi-Blind Channel Estimation and Equalization for 
MIMO Space-Time Coded OFDM’,” IEEE Trans. Circuits and Systems-I: Regular Paper, vol.55, no. 
11, pp.3513-3513, Dec., 2008 (EI,SCI) (NSC-96-2221-E-030-003-) 
3. J.L. Yu and Yin-Cheng Lin, “Space-Time Block Coded MIMO ZP-based OFDM Systems for 
Complex Input Signals,” 16th IST Mobile and Wireless Communications Summit, Hungary , 1-5 
July, 2007. 
 
可利用之產業 
及 
可開發之產品 
以 OFDM 技術為基礎的產品 
 
技術特點 
適用於複數調變訊號，增加頻寬使用效率。 
推廣及運用的價值 
 
頻寬使用效率高，其運用價值高。 
※ 1.每項研發成果請填寫一式二份，一份隨成果報告送繳本會，一份送 貴單位
研發成果推廣單位（如技術移轉中心）。 
※ 2.本項研發成果若尚未申請專利，請勿揭露可申請專利之主要內容。 
※ 3.本表若不敷使用，請自行影印使用。 
表 Y04 
報告內容應包括下列各項： 
一、 參加會議經過 
短短幾天的會議，著實讓本人獲益良多。第一天約中午到達韓國仁川機場，
韓國的硬體建設的確相當進步，尤其首爾市區，下榻的飯店在一個小山丘
上，距離會場梨花女子大學約六個地鐵站。第二天早上八點就到梨花大學
會場，校園很有特色。一開始先由韓國 KT 電信公司副總裁 Dr. Han Wook 
Jung 以”Need to increase the use of wireless data and smartphone for boosting 
up the mobile contents market”做開場演講；隨後分別由中日韓三國的學者專
家做專題演講。韓國由首爾大學 Seong-Cheol Kim 教授主講韓國的明星電
信產品”WiBro-Mobile Wimax in Korea＂；日本由東京市立大學 Mamoru 
Sawahashi 教授主講＂Standardizations for LTE/LTE-Advanced and 
Future Broadband Radio＂， Mamoru Sawahashi 教授原本在 NTT DOCOMO, 
INC.工作，所以實務經驗豐富；台灣則由清華大學王晉良教授
以＂Communications Technology Development in Taiwan＂為題說明台灣
產官學界在電信技術發展的現況。不難看出各個國家在通訊方面的研究精
進。下午我有一篇論文報告，由隨行的研究生上台報告，我與 Mamoru 
Sawahashi 教授共同擔任 section chair。第三天已經沒有我的工作，聽了
有關 OFDM 相關的報告，晚上則參加舉辦單位的晚宴，晚宴中王晉良教授還
代表台灣為明年主辦 APWCS 展示宣傳短片。 
 
     
二、 與會心得 
這次來韓國從其中了解到不少各國的在通訊產業未來的發產和規格，舉此
次在韓國首爾所見為例，3G 方面的產業在台灣一直以來推行的並不是很順
利，然而當我在韓國首爾不論是地鐵或是走在街上，幾乎人手一機使用觀
賞影音電視節目或是多媒體簡訊，電話通訊反而是附加的功能，不難發現
韓國的手機產業對於 3G 方面的推動遠比台灣來的成功，台灣的 3G 應用的
推廣還須再加油。 
 
三、 考察參觀活動(無是項活動者省略) 
 
四、 建議 
 
五、 攜回資料名稱及內容 
The 6th IEEE VTS Asia Pacific Wireless Communications Symposium (APWCS2009) 
 
六、 其他 
 
 
( ) ( ) ( )
0
( ) ( ) ( ) ( )
L
m m m
l
r n h l x n l v n
 
  ¦                  (3) 
where ( ) ( ),  0, ,mh l l L "  represent the corresponding 
discrete-time baseband channel impulse response with 
assumption of L N , and ( ) ( )mv n  is the additive white 
Gaussian noise. The ith received signal block is grouped as 
( ) ( ) ( )[ ( ), , ( 1)]m m m Ti r iN r iN N  r " .  Using (3), we obtain
( ) ( ) ( ) ( )
0 1 1
m m m m
i i i i  r H x H x v                      (4) 
where ( ) ( ) ( )[ (0), , ( 1)]m m m Ti i iv v N v "  is the noise vector, 
( )
0
mH  is a N Nu  Toeplitz matrix with first row 
 ( ) 0 ,0, 0mhª º¬ ¼" and first column 
   ( ) ( )0 , , ,0, 0 Tm mh h Lª º¬ ¼" "  and ( )1mH  is also a N Nu
Toeplitz matrix with first row ( ) ( )0, ,0, ( ), , (1)m mh L hª º¬ ¼" "
and first column > @0, ,0 T" . The first term in (4) denotes 
the desired signal and the second term is the ISI component 
from the (i-1)-th OFDM symbol. Concatenating ( )0
mH  and 
( )
1
mH  and stacking ix  and 1ix  into a larger matrix and 
vector, respectively, (4) is rewritten by 
1( ) ( ) ( ) ( ) ( ) ( )
1 0
im m m m m m
i i i i
i
ª ºª º   « »¬ ¼ ¬ ¼
x
r H H v H x v
x
     (5) 
where    , , 1 Ti x iN L x iN N   ª º¬ ¼x "  and ( )mH  is a 
( )N N Lu   Toeplitz matrix. ( )mH  in (5) is not a full 
column rank matrix and is not satisfied the identifiably 
condition in blind channel estimation. The multichannel 
signal model via oversampling technique or multiple 
receive antennas is often exploited to treat this problem 
[4][6]. Without loss of generality, the OFDM system which 
deploys multiple antennas at the receiver is adopted in this 
paper. Assuming the number of receive antennas is M , (3) 
is extended to the multichannel signal model 
           (1) ( )
0
, ,
LTM
l
n r n r n l x n l n
 
ª º   ¬ ¼ ¦r h v"  (6)
where      (1) ( ), , TMl h l h lª º ¬ ¼h "  and 
(1) ( )( ) ( ), , ( )
TMn v n v nª º ¬ ¼v " . Stacking   ,  , ,n n iN r "
1iN N   yields 
   , , 1 TT Ti N i iiN iN Nª º    ¬ ¼y r r H x v"           (7) 
where
   
   
0
0
N
L
L
§ ·
¨ ¸ ¨ ¸
¨ ¸© ¹
h h 0
H
0 h h
" " "
# % % % % #
" " "
         (8) 
   , , 1 TT Ti iN iN Nª º  ¬ ¼v v v"                  (9) 
HN in (8) is a ( )NM N Lu   block Toeplitz matrix and is of 
full column rank if NM N L!   where M>2 suffices to 
satisfy the necessary condition when N L . The 
subspace channel estimators in [4][7] are developed based 
on the signal model in (7), where Li [4] uses the ISI-free 
components while Yu [7] partitions the signal in (7) into 
several consecutive blocks. 
III. PROPOSED SUBSPACE CHANNEL ESTIMATION
With favor of the block Toeplitz structure in (8), [7] 
proposed the block matrix scheme to generate a set of sub-
vectors from the vector yi. The number of equivalent 
samples is increased such that the performance of channel 
estimation is improved. However, the performance 
improvement is limited when the length of the sub-vector is 
close to that of yi. In this section, a novel block matrix 
scheme is presented. Consider an observation interval over 
K OFDM symbols. The resulting received signal vector is 
given by 
0 1 1, , ,
TT T T
K K NK K Kª º  ¬ ¼y y y y H x v  "         (10) 
where [ ( ), , ( 1), (0), , ( 1)]TK x L x x x NK   x " "  is a 
(NK+L)×1 vector with ( ) ( 1) 0x L x     " and HNK is a 
NKM×(NK+L) block Toeplitz matrix which has a similar 
form to (8). Because of the above block Toeplitz structure, 
HNK can be expressed by 
      
      
G
NK
G
ª º
« »
 « »
« »
« »¬ ¼
H 0
H
0 H
%               (11) 
where HG is a ( )GM G Lu   block Toeplitz matrix. Using 
(10) and (11), a sub-vector ,K gy  of GM×1 is defined by 
, ( ), , ( 1)
TT T
K g g g Gª º  ¬ ¼y r r " , which is obtained as 
, , , ,   0,1, ,K g G K g K g g NK G   y H x v   "               (12) 
where > @, ( ), , ( 1) TK g x g L x g G   x "  and ,K gv  contains 
the noise component. In order to guarantee that HG is of 
full column rank, the minimum of G is calculated by
min ( )1
LG ceil
M
 

                              (13) 
where ceil(x) is the nearest integer greater than or equal to 
x . Using (12), the ensemble autocorrelation matrix 0R  is 
written by 
2 2
0 , ,
H H
K g K g s G G nE V Vª º  ¬ ¼R y y H H I                 (14) 
where 2sV  and
2
nV  are signal and noise power, respectively. 
Performing the eigenvalue-eigenvector decomposition 
(EVD) on 0R  yields 
2
0
H H
s s s n n nV 6 R U U U U                        (15) 
where s6  is a diagonal matrix consisting of G L
eigenvalues larger than 2nV , sU  is a ( )GM G Lu   matrix 
and spans the signal subspace which equals the range space 
of HG, and nU  is orthogonal to sU  and spans the noise 
subspace. Using the orthogonal property between signal 
subspace and noise subspace, we have 
H
n G  U H 0                                    (16) 
Let iq  be the i-th column of nU  and partition iq  into a 
G×1 block vector 

On the other hand, Considering the ISI-free signal vector 
zi, the MMSE equalizer is obtained by the optimization 
criterion [6] 
 
2
2
2 2arg  min  || ||
H
i iJ E ª º ¬ ¼W W W z x                 (30) 
The MMSE solution is obtained by  
1
2 2 zx
 W R R                                         (31) 
2 2
2
H H
i i s N L N L nE V V ª º  ¬ ¼R z z H H I                      (32) 
2H
zx i i s N LE V ª º  ¬ ¼R z x H                             (33) 
From (27) and (31), some observations are examined. Since 
HN-L is a block Toeplitz matrix with identical form to (8), 
the first L and the last L components of xi contained in zi
will have smaller gains (i.e., norms of the corresponding 
column vectors in HN-L) than the others.  The phenomenon 
also appears in the MMSE equalizer of (27). The last L
components of xi contained in yi will have smaller gains 
than the others because the last L columns of 1H  have 
smaller norms than the others. The estimation errors for 
components of xi become higher since they have smaller 
gains.
To overcome this problem, a new MMSE equalizer is 
proposed as follows. Let G=N+L and g=iN, i=0,1,…, K-1,
for ,K gy  in (12), i.e., , , ,K iN N L K iN K iN y H x v   in which 
,K iNx  can be partitioned as > ( ), ( 1), ,Tix iN L x iN  x"
@( ),..., ( 1) Tx IN N x IN N L    . It is found that the 
components of xi in ,K iNx  will correspond to the same 
vector norm as h, while the rest ones which are referred as 
ISI components have smaller gains. The proposed MMSE 
equalizer is described by the following optimization 
problem 
 
0
2
0 0 ,arg  min  || ||
H
K iN iJ E ª º ¬ ¼W W W y x                 (34) 
The MMSE solution is obtained by  
1
0 0 yx
 W R R                                       (35) 
2 2
0 , ,
H H
K iN K iN s N L N L nE V V ª º  ¬ ¼R y y H H I                  (36) 
2
, 0
H
yx K iN i sE Vª º  ¬ ¼R y x H                              (37) 
where 0H  is the matrix with removing the first L and the 
last L columns from HN+L. The estimate of ix  is obtained 
by passing appropriate signal vector into the MMSE 
equalizers designed by (27), (31) or (35), respectively. 
Finally, performing DFT operation on the estimate of 
ix can reconstruct the transmitted symbol si.
VI. COMPUTER SIMULATIONS
Computer simulations are executed to verify the 
performance of the compared subspace (SS) channel 
estimators including SS with ISI free [4], block-SS [7], and 
the proposed block-SS methods. The QPSK modulation 
scheme is applied and M=2 is used. The time-invariant 
multipath channel is randomly generated by an 
exponentially decayed power delay profile 
2 4 4
0
[ ] , 0,...,
k mL
m
k e e k LK
 
 
  ¦                     (38) 
The effect of block matrix size, G, is shown in Fig. 1. Note 
that the block-SS method [7] degenerates to the SS with ISI 
when G=N. The block-SS is sensitive to the selection of 
block matrix size, especially when G=N, while the 
proposed block-SS has almost the same MSE even G>N.
The RMSE of channel estimation versus the input SNR is 
plotted in Fig. 2. It is found that with the selection of G=60,
the proposed block-SS method provides the lowest RMSE 
among the compared estimators. 
The performances of various MMSE equalizers versus 
the input SNR are shown in Fig.3, where the true channel 
matrix and correlation matrix are used. The proposed 
MMSE equalizer outperforms the other two MMSE 
equalizers. Fig. 4 shows the effects of the channel order. It 
is found that the proposed MMSE equalizer is less sensitive 
to the channel order while the others in [4] and [7] have 
higher BERs as the channel order increases.  
The effects of finite samples on the MMSE equalizers 
are examined in Fig. 5, where the correlation matrices are 
computed from (20), (22) and (24), respectively. For a fair 
comparison of equalizer’s performance, the true channel 
matrix is used. It is shown that both the MMSE equalizers 
W1 and W2 require almost 2000 OFDM symbols to 
converge to their ideal BERs. On the other hand, the 
proposed MMSE equalizer almost converges to the ideal 
value of 10-4 with 100 OFDM symbols only. That is 
because the sample correlation matrix 0Rˆ  is averaged by 
NK-N-L-1=3124 equivalent samples when K=100. On the 
contrary, the sample correlation matrices 1Rˆ  and 2Rˆ  are 
averaged by K OFDM symbols. 
VII. CONCLUSIONS
The block-SS channel estimator and MMSE equalizer 
for SIMO OFDM systems without CP are proposed in this 
paper. The block-SS channel estimator utilizes the block 
Toeplitz structure of channel matrix to increase equivalent 
samples and thus decreases the RMSE of channel 
estimation. Similarly, a novel MMSE equalizer is presented 
which can converge to its ideal BER with few OFDM 
symbols. The cost of the proposed method is a higher 
number of CAs than the compared methods.  
REFERENCES
[1] J. A. C. Bingham, “Multicarrier modulations for data 
transmission: An idea whose time has come,” IEEE Commun.
Mag. Vol. 28, pp. 5-14, May 1990. 
[2] European Telecommunications Standards Institute, 
“Broadband radio access networks (BRAN); HIPERLAN 
type 2; Physical (PHY) layer,” Valbonne, France, TR 101 
405 V.1.1.1, Apr. 2000. 
[3] IEEE Standard for Local and Metropolitan Area Networks 
Part 16: Air Interface for Fixed Broadband Wireless Access 
Systems, IEEE Std 802.16-2004. 
[4] C. Li and S. Roy, “A Subspace Blind Channel Estimation 
method for OFDM Systems without Cyclic Prefix,” IEEE
Trans. Wireless Commun., vol. 1, pp. 572-579, Oct. 2002. 
[5] C. Wang and Z. Zhou, “A new detection algorithm for OFDM 
system without cyclic prefix,” in IEEE 6th CAS Symp. on 
Emerging Technologies: Mobile and Wireless Comm. 
Shanghai, China, May, 2004. 

表 Y04 
行政院國家科學委員會補助國內專家學者出席國際學術會議報告 
                                                      2009 年  10  月  30  日 
報告人姓名  余金郎 
 
服務機構
及職稱 
 
輔仁大學電機系教授 
 
     時間 
會議 
     地點 
自 98 年 8 月 25 日～98 年 8
月 29 日 
中國西安 
本會核定
補助文號
 
NSC 97-2221-E-030 -003 - 
 
會議 
名稱 
 (中文) 第 4 屆 中國國際通訊與網路訊研討會 
 (英文) 2009 Fourth International Conference on Communications and 
Networking in China (ChinaCom2009) 
 
 
發表 
論文 
題目 
 (中文) 半正交空時碼之多載波分碼多工存取單輸入多輸出正交分頻多工
調變系統設計 
 (英文) Multiuser Detection for QO-STBC MC-CDMA MIMO Systems 
 
 
附件三
 
Multiuser Detection for QO-STBC MC-CDMA MIMO Systems
Jung-Lang Yu 
Department of Electrical Engineering 
Fu Jen Catholic University 
Taipei Hsien 24205, Taiwan 
Chun-Hsien Wu 
Department of Electronics Engineering 
Fu Jen Catholic University 
Taipei Hsien 24205, Taiwan 
 
 
Abstract—The multi-carrier code-division multiple-access (MC-
CDMA) multiple-input multiple-output (MIMO) system with 
quasi-orthogonal space-time block codes (QO-STBC) is studied 
in this paper. Considering QO-STBC scheme that involves three 
or four transmit antennas, a subspace-based blind channel 
estimation is proposed. With the estimated channel coefficients, 
the minimum output energy (MOE) and eigenspace receivers are 
employed for symbol detection. The weight analyses are 
performed to reduce the system computational complexity. 
Besides, the forward backward averaging technique is presented 
to enhance the performance of multiuser detection.  
Keywords-MC-CDMA; MIMO; QO-STBC; MOE; Multiuser Detection 
I. INTRODUCTION 
The MC-CDMA system, which is developed by the 
combination of orthogonal frequency division multiplexing 
(OFDM) and CDMA, has been widely studied for high-speed 
wireless communications in that it provides bandwidth 
efficiency and interference suppression capability [1]. The 
application of STBC scheme to MC-CDMA systems was 
presented in [2] and demonstrated that the space-time coded 
MC-CDMA systems gain a significant profit of transmit 
diversity in multipath fading channel. The ideas of STBC were 
first introduced by Tarokh [3] and Alamouti [4], respectively. 
Afterwards, STBC systems with more than three transmit 
antennas were studied in [5][6].  The performance of STBC 
OFDM-CDMA systems with orthogonal pilot preambles and 
four transmit antennas was evaluated in [7].   
In this paper the QO-STBC MC-CDMA systems with 
three or four transmit antennas are investigated. Jafarkhani [3] 
has proposed a typical 4×4 QO-STBC scheme with four 
transmit antennas. Practically, some active users might install 
three antennas only at the transmitter due to the limitation of 
device size. With different configurations of transmitters, the 
multiuser receiver design including the blind channel 
estimation and symbol detection is examined here. A 
subspace-based channel estimator which utilizes the space-
time coding property is first presented. Using the noise 
subspace of the correlation matrix, the channel coefficients are 
estimated by solving a quadratic optimization problem. The 
performance analysis of channel estimation is executed by 
using the first order perturbation theory on the correlation 
matrix [8]. With estimated channel coefficients, the MOE and 
eigenspace receivers are employed for symbol detection. 
Based on the quasi-orthogonal STBC property, weighting 
analyses of above two receivers are performed such that the 
computational complexity of receiver design is reduced. 
Furthermore, the forward-backward averaging technique 
(FBAT) is applied to alleviate the performance degradation 
due to finite samples. Computer simulations demonstrate that 
the correctness of performance analysis and superiority of the 
proposed receivers. 
II. SIGNAL MODEL 
Fig. 1 shows an uplink quasi-synchronous QO-STBC MC-
CDMA systems equipped with three or four transmit antennas. 
The encoding and transmission scheme for Jafarkhani’s QO-
STBC is characterized by the following coding matrix [3] 
( ) ( ) ( )
( ) ( ) ( )
( ) ( ) ( )
( ) ( ) ( )
* *
* *
* *
* *
(4 ) 4 1 4 2 4 3
(4 1) 4 4 3 4 2
( )
(4 2) 4 3 4 4 1
(4 3) 4 2 4 1 4
k k k k
k k k k
k
k k k k
k k k k
b n b n b n b n
b n b n b n b n
n
b n b n b n b n
b n b n b n b n
⎡ ⎤− + − + +⎢ ⎥+ − + − +⎢ ⎥= ⎢ ⎥+ − + − +⎢ ⎥+ + +⎢ ⎥⎣ ⎦
B
[ ](4 ) (4 1) (4 2) (4 3)k k k kn n n n= + + +d d d d              (1) 
where ( )kb n  denotes the n-th information symbol for user k,  
( ) ( ) ( ) ( )1 2 3 4( ) [ ( ) ( ) ( ) ( )]Tk k k k kn d n d n d n d n=d and ( ) ( )ikd n  is the 
transmitted symbol through the i-th transmit antenna at the n-
th time slot. If only three antennas are installed at the 
transmitter, a row vector will be removed from the coding 
matrix in (1). 
The MC-CDMA transmitted signal after the spreading and 
IDFT operations is given by ( ) ( ) ( ) ( ) ( )i i iHk k kn d n N=x F c  where 
( ) ( ) ( ) ( ) ( )[ 0 1 ]i i i Tk k kc c N= −c "  is the spreading codes and F 
denotes the N N×  DFT matrix with the mn-th entry 
exp( 2 ( 1)( 1) / )j m n Nπ− − − . We further assume that the 
channels are frequency-selective fading and linear time-
invariant (LTI) where ( ) ( ) ( ) ( ) ( ), , ,[ 0 1 ]i q i q i q Tk k kh h L= −h "  is the 
channel impulse response from the i-th transmit antenna to the 
q-th receive antenna for the k-th user, and L is the maximum 
delay spread among all channels. In order to avoid the 
intersymbol interference (ISI), we insert a cyclic prefix (CP) 
of length larger than the channel order. To integrate two 
different transmitting configurations together, it is assumed 
that all users adopt the same coding matrix in (1), but ( ),i qkh  is 
a zero vector if the i-th transmit antenna is not equipped for 
the k-th user. The received signal at the q-th receive antenna 
from all transmit antennas after discarding the corresponding 
cyclic prefix is then given by  
( ) ( ) ( ) ( )4
1 1
K
q i
k
k i
n n
= =
= ∑∑r x ○* ( ) ( ) ( ),i q qk n+h η                 (2) 
Performing the eigenvalue decomposition on Rˆ  yields 
ˆ ˆ
ˆ ˆ ˆ
ˆ ˆ
H
s s
s n H
nn
⎡ ⎤ ⎡ ⎤⎡ ⎤ ⎢ ⎥ ⎢ ⎥⎣ ⎦ ⎢ ⎥⎢ ⎥ ⎣ ⎦⎣ ⎦
Λ 0 U
R = U U
U0 Λ
.                  (13) 
The perturbation error between R and Rˆ  is defined by 
ˆΔ = −R R R                             (14) 
which is a Hermitian matrix with zero mean. The perturbation 
of the noise subspace due to ΔR  is denoted by 
ˆ
n n nΔ = −U U U . Based on the first order perturbation theory 
of subspace in [8], we have 
n s n
+Δ = − ΔU R RU                         (15) 
where sR  is the noise-free correlation matrix 
2
4
H
s n NQ sσ= − =R R I GΩ G .                      (16) 
Due to the perturbation of noise subspace, the error of 
channel estimation is defined by ˆk k kh h hΔ = − where ˆ kh  is 
computed from (11). The MSE of channel estimation can be 
derived from [8]  
{ } { }2 11 14H Hn k k k kMSE tr trTσ γ γ+ + + +⎡ ⎤= +⎣ ⎦V V V JV       (17) 
where ( ) 11 2 211 ,Hk k nk kγ ρ ρ σ−− −= + G G , ( ) 12 214 ,4Hk nk kγ ρ σ−−= G G  
and 4 4 3NQ K−= ⊗J M I .  
IV. RECEIVER DESIGN 
In this section, the weighting analysis and performance 
enhancement are studied for the MOE and eigenspace 
receivers, respectively. 
A. Filter Design 
The MOE receiver minimizes the overall receiver output 
power while passing the desired signals with unit-gain 
constraints [7] 
( ) ( ) ( ) ( )( ) ( ) ( )
( ) ( )
41 2 3 4
1
min  J , , ,
subject to     1,   1, ,4
i iH
k k k k k ki
i iH
k k i
==
= =
∑w w w w w Rw
w g "
           (18) 
where ( )ikw  is the receiver weight vector to extract the symbol 
( ) (4 1)kb n i+ −  and R is the ensemble correlation matrix of (7). 
The weight vector of the MOE receiver is well known as 
( ) ( ) ( )( ) ( )11 1   ,    1, ,4i i i iHk k k k i−− −= =w g R g R g … .                (19) 
Ideally, the weight vector in (10) will fall onto the signal 
subspace of R. Unfortunately, it will deviate from the signal 
subspace if finite sample effects and/or signature vector errors 
exist. The eigenspace receiver utilizes the orthogonal 
subspace property to generate the weight vector by  
( ) ( ) ( )( ) ( )11 1, ,   1, ,4i i i iH H Hk s k s s s k s s s k i−− −= =w g U Λ U g U Λ U g … .  (20) 
where sΛ  is a 4 4K K×  diagonal matrix whose diagonal 
elements are the eigenvalues corresponding to the eigenspace 
sU . The eigenspace receiver will produce a lower BER than 
the MOE receiver in a finite sample scenario [7]. 
B. Weight Analysis 
Using quasi-orthogonal STBC properties, weight vectors 
( )i
kw  and 
( )
,
i
k sw  are analyzed in Lemma l. 
Lemma l: Given the weight vectors ( )ikw  and ( ),
i
k sw   of MOE 
and eigenspace receivers in (19) and (20), respectively, the 
following relations are satisfied. 
( ) ( ) ( ) ( ) ( ) ( )2 1 3 1 4 1* *
2, 3, 4,,  ,  = = =QN k QN k QNk k k kw M w w M w w M w    (21) 
( ) ( ) ( ) ( ) ( ) ( )2 1 3 1 4 1* *
2, , 3, , 4,, , , ,,  ,  = = =QN k s QN k s QNk s k s k s k sw M w w M w w M w   (22) 
Proof: Due to the space limitation, only the derivation of (21) 
is discussed below. Note that since iM  is a permutation 
matrix, it is unitary, so is ,i QNM , i.e., , , 4 ,
H
i QN i QN QN=M M I   
2,3,4i = . Besides, ,i QNM  has the relations of 2,QN =M  
2,
T
QN−M , 3, 3,TQN QN= −M M  and 4, 4,TQN QN=M M . Using the 
definitions of ( ) , 1 4ik i =D " , we have the following equalities, 
( ) ( ) ( ) ( )
( ) ( ) ( )
( ) ( )
1 2 * 3 * 4
2, 3, 4,
2 4 * 3
3, 4,
3 4 *
2,
,
,
.
k QN k QN k QN k
k QN k QN k
k QN k
= − = − =
= − = −
= −
D M D M D M D
D M D M D
D M D
          (23) 
Substituting (23) into (9), ( )ikg  has the following relations,  
( ) ( ) ( ) ( )
( ) ( ) ( )
( ) ( )
1 2 * 3 * 4
2, 3, 4,
2 4 * 3
3, 4,
3 4 *
2,
,
,
.
k QN k QN k QN k
k QN k QN k
k QN k
= − = − =
= − = −
= −
g M g M g M g
g M g M g
g M g
           (24) 
From (24) and ( ) ( )1 4k k k⎡ ⎤= ⎣ ⎦G g g" , we have *2,QN k =M G  
*
2 3, 3 4, 4,   and k QN k k QN k k− = − =G M M G G M M G G M , or 
* *
2, 2 3, 3 4, 4k QN k QN k QN k= = =G M G M M G M M G M .         (25) 
Using (25) and [ ]1 K=G G G" , we further have  
* *
2, 2, 3, 3, 4, 4,,  ,  QN K QN K QN K= = =G M G M G M G M G M GM  (26) 
where ,i K K i= ⊗M I M  is a unitary matrix. Substituting 
*
2, 2,QN K=G M G M  into (7), the correlation matrix becomes 
* 2
2, 2, 2, 2, 4
H T H
QN K s K QN n NQσ= +R M G M Ω M G M I . With s =Ω  
( )1 4,..., Kdiag ρ ρ ⊗ I , the term 2, 2,HK s KM Ω M  is simplified by  
