II
系統誤差的方案，並給出了向量半參數模型的核權函數估計、近鄰權函數估
計及樣條估計相對於標量半參數模型的主要區別在於單個光滑參數為一組光
滑參數所代替。對於權函數估計，表現在原模型的單個權值為一個權陣所代
替，而對樣條估計，是用 Kronecker 積代替原來的數乘運算來實現標量到向
量的擴展。最後用實測資料的算例檢驗了其效果。 
【關鍵字】非參數估計；線性半參數模型；非線性模型；系統誤差
IV
components. The statistic property of some estimators are also discussed. The main
innovations of this part include: proposes the estimating formulas of the
aforementioned methods, derives the formulary for asymptotic variance of the
estimation of parametric component under Least-Square principle, proves that the
estimation of parametric and nonparametric components of linear semiparametric
model are bias, and proposes the calculating method of bias for aforementioned
methods. At the end of this chapter, a technique for solving nonlinear parametric
model by semiparametric model is proposed. It expands the non-linear functions as
Taylor series at an approximate point, the expanding includes 2 parts, the first order
term and the remainder, and the 2 parts make up a semi-parametric model. The
effect of some techniques is tested with numerical examples.
In part 4, the estimating theory of nonlinear semiparametric models is researched,
including the calculating formulae of the estimation of parametric and
nonparametric components, the statistic property of the estimation of parametric
component. The main innovations of this part are: gives the nonlinear estimating
formulas of Kernel, Nearest-Neighbor, Nature Spline, Blocked-polynomials,
Trigonometric-series, Wavelet and Two-phase Estimator under the principle of
Least-Square, derives the formulae for Guass-Newton Method and some
approximate nonlinear methods, derives the formula for asymptotic variance of the
estimation of parametric component under Least-Square principle, proves that the
coefficient matrix of normal equation is positive definite, proves that the estimation
of parametric and nonparametric components of Least-Square Kernel Estimator for
nonlinear semiparametric model are bias, and the bias property is suitable for the
other estimating methods of nonlinear semiparametric model. At the end of this
part simulated data are used to verify the effectiveness of these techniques for
nonlinear semiparametric model.
Part 5 expounds the definition and property of systematic errors, studies the
systematic errors in GPS and techniques to handle them. A new scheme is proposed
which is using nonlinear semiparametric models to deal with systematic errors in
GPS.
【key words】Nonparametric estimator ; Linear semiparametric models;
Non-linear models; Systematic error
2X 、 i同模型 1， )(g 是定義在 1R 上的未知函數。對這種模型，主要研究
了相依資料非參數估計的有些大樣本性質，構造了 X 的估計 nXˆ ，研究了 nXˆ
的相合性。
模型 6： niXBfL iii  1)( ，其中： iB 同模型 4， X 、 i 同模型
1， )(f 是定義在 1R 上的未知函數。此模型稱為單指標（Single-Index）模
型。對這種模型，主要利用密度估計的有關性質研究了 X 的某個方向的估計
的漸近正態性。
模型 7： iiiiii gniXBL  )(,1 1 ，其中： iB 、 X 、 i同模
型 3， )(g 是定義在 1R 上的未知函數。
模型 8： iiiiiii BfBnitgXBL  )(,1)( 1 ，其中： X 同上， f為未知函
數， )( it 是 .iid 非隨機設計點列或隨機子樣， )(g 是定義在 1R 上的未知函數，
ii , 是 .iid 隨機誤差向量， ),( ii tB 與 i獨立， i與 i獨立， 0)()(  ii EE  ，
)( 2iE ， )( 2iE  。
此外還有自建模回歸模型和隨機前沿面回歸模型等。在諸多半參數模型中，
研究成果最豐富的主要是模型 1、2、3。研究的內容涉及參數分量 X 的各種
估計的構造，估計量的漸近正態性，強弱收斂速度，強弱相合性，重對數律
等大樣本性質。各種模型都來源於特定的應用領域。在測量資料處理領域所
研究的半參數模型形式一般為模型 4。模型的參數部分代表測量資料處理中
確定的函數模型，非參數部分代表測量資料中的隨機或非隨機信號，Δ代表
觀測值的隨機誤差向量。
以往研究的半參數模型中的參數分量均為線性函數，故以往研究的半參
數模型都是線性半參數模型，有人也稱之為偏線性回歸模型。對於參數、非
參數和半參數模型，各有其適應範圍，離開各自的適應範圍就無法評價這些
模型的優劣，只能一般地說，這些模型在其適應的範圍內都是十分有用的，
其理論和方法都尚在發展之中。 
 
§1.2 本研究的主要內容及意義
將非線性模型估計理論中的參數估計擴展到半參數估計以及將線性模型
4Part 1 非線性參數模型及其估計
§1.1 非線性模型的非線性強度及其度量
1.1.1 非線性模型的非線性強度的概念 
測量中的觀測方程大多是非線性方程。一般地，用 L 表示觀測向量，用
X表示未知參數向量，用△表示觀測誤差向量，則非線性觀測方程可寫為：
 )(XfL （1-1）
式中， Tn XfXfXf ))()(()( 1  ，是由 n個 X的非線性函數組成的 1n 向量。
T)(在本節表示轉置， t)(表示切向方向。
不失一般性，設 L為同精度獨立觀測值。關於模型（1-1）的參數估計，
傳統的方法是將其線性化，即將（2-1）式在參數的近似值 0X 處展為 Taylor
級數，並取至一次項。然後再應用線性參數模型估計理論進行參數估計。將
非線性模型線性化，因略去了二階及二階以上高次項，得到的僅含一次項的
線性模型顯然是原模型的近似。由於線性近似後得到的線性模型是近似模
型，所以線性近似必然會產生模型誤差。有的非線性模型線性近似所產生的
模型誤差大於等於由觀誤差所引起的誤差，而有的非線性模型線性近似所產
生的模型誤差卻可忽略不計。
由於不同的非線性模型的非線性程度不一樣，線性近似時引起的模型誤
差會不同。非線性程度越強，線性近似時產生的模型誤差就越大。非線性模
型的非線性程度，稱為非線性強度。可見一個非線性模型採用線性近似的方
法進行參數估計時，參數估值的精度很大程度上取決於該模型的非線性強
度。
1.1.2 非線性模型的非線性強度的度量 
1.1.2.1 固有曲率和參數效應曲率 
設非線性模型為（2-1）， TnLLL )( 1  為同精度獨立觀測向量，
T
n )( 1  為 iid.隨機誤差向量， 0)( iE ， 22 )var( i , ni ,,1  。
引進記號：
pi
nki
k
X
Xf
XB
,,1
,,1
)(
)(








 ，
pji
nkji
k
XX
Xf
Xw
,,1,
,,1
2 )(
)(









6提升線 hC 沿 h方向的二階導數是：
whhhhw
db
dX
X
hB
db
d T
p
i
p
j
jikij
b
j
X
p
j j
p
i
iki
hk
hk 

 
 






1 101
1
2
2
0
 （1-3）
h是 0b 時的速度向量， h為 0b 時的加速度向量，加速度向量可分解為
三個分量，即垂直於切平面的法分量 Nh，在切平面上平行於切線方向 h和
垂直於切線方向 h的兩個分量 Ph和 Gh，分別稱為法向加速度、測地加速度
和切向加速度，它們構成切分量 th，故有
t
h
N
h
G
h
P
h
N
hh    （1-4）
把 h和 h用關於弧長的導數表示為：
db
ds
db
ds
ds
d
db
d
h 
  （1-5）
2
22
2
2
db
sd
db
ds
ds
d
db
d
h 
 



 （1-6）
這樣 h就分解為相互垂直的兩項，從第一項
2





db
ds
ds
d
可計算法截線曲率 Kh：
   222
2
/ h
N
h
h
N
h
N
N
h
db
ds
db
ds
ds
d
ds
d
rhK










 



















所以法曲率
2
h
N
hN
hh KK 



 （1-7）
法曲率 NhK 與方向 h有關，但與參數無關，所以又稱固有曲率。對一切 h取
N
hK
的最大值可得非線性模型的最大固有曲率 NK 。 類似地可得另一曲率
2
h
t
ht
hK 



 （1-8）
由於 th裏至少有一項
t
db
Sd




2
2
 依賴於參數 b，所以 th不僅與方向 h有關，
8的直線 X=X0+bh變為：
bdhbRXbhXRXXR  )()()( 000 （1-13）
式中 d 為方向向量，而提升線變為 )(dbfd  ，且對應於 0 。可見，通過變換
hwB 、、 分別變為 dUQ 、、 。取 d 為單位向量，得參數下沿 d 方向的曲率為（1-10）
式。Q 和 N 的列向量分別生成解軌跡在 0 處的切空間和法空間。因此，相應的投影
矩陣 PT和 PN可分別表示為： TT QQP  ， TN NNP  。於是
))(()(
))(()(
UddQQUdd
UddNNUdd
TTtT
TTNT


利用矩陣與立體陣的性質和運算有：
]]][[][[]]][][[[))(()(
]]][[][[]]][][[[))(()(
dUNdNUddNNUddNNUdd
dUQdQUddQQUddQQUdd
TTTTTTNT
TTTTTTtT


（1-14）
因為 Q、N 是正交陣，所以有 INNIQQ TT  , 。根據向量范數（歐氏範數）的定義
可得：
dUQdUddK
dUNdUddK
TTtTt
d
TTNTN
d
]][[)(
]][[)(


（1-15）
根據上式給出非線性模型的固有曲率立體陣 G和參數效應立體陣Ω 的定義為：
]][[
]][[
UQ
UNG
T
T


（1-16）
式中 G為 pptn )( 的立體陣；Ω 為 ppp  的立體陣，[ ][ ]為立體陣的方括
號乘法，它們僅與模型及參數有關，而與方向 d 無關。
1.1.2.3 非線性模型的非線性強度度量
非線性模型非線性強度小，線性近似時只產生較小的模型誤差，得到令人滿意的結
果；而有的非線性模型對參數的近似值十分敏感，線性近似時產生較大的模型誤差；還
有些非線性模型甚至不能線性近似。要判斷一個非線性模型可否線性近似，首先引入非
線性模型線性近似的容許曲率。
將（1-1）式在 X0處線性近似，得： )()( 00 XXBXfL  （1-17）
假定參數 X的估值為 Xˆ ，且滿足： )ˆ()()ˆ( 00 XXBXfXf  （1-18）
用線性化模型（1-18）代替（1-1），在置信水平（1-α）下的置信域為：
),(ˆ)ˆ)(ˆ()ˆ()ˆ()ˆ()( 20
2
pnpFpXXXBXBXXXfXf TT   （1-19）
10
了參數變換後在新參數下進行線性化近似求解非線性模型的可能性，但難以實際應用。
對於線性近似的方法，當模型的非線性強度較弱時，可以將其在 X0處線性化，得誤
差方程： )(()( 00 XfLdXXBV  ，根據最小二乘準則可得：
))()(())()(( 00100 XfLXBXBXBdX TT   （1-24）
於是參數 X 的最小二乘估計量為： dXXX  0ˆ 。當（1-21）式成立時，線性近似所
引起的模型誤差對最小二乘估計量 Xˆ 的影響小於等於觀測誤差對參數估值 Xˆ 的影響。
1.2.2 最小二乘參數估計的迭代解法
對於非線性強度較強的非線性模型，由於線性近似將產生大於觀測誤差的模型誤
差，所以一般採用迭代的方法求解。求模型（1-1）的非線性最小二乘估計，就是求參
數 X 的估值 Xˆ ，使得 min))ˆ(())ˆ(()ˆ()ˆ(  LXfLXfXVXV TT ，此式等價於以
min)ˆ(2)ˆ()ˆ()ˆ(  LXfXfXfXR TT （1-25）
為目標函數的非線性無約束最優化問題。
1.2.2.1 Guass-Newton 法
設（1-1）存在一階偏導，參數 X間相互獨立，則函數 


n
i
ii LXfXR
1
2)])ˆ([()ˆ(
取極小值，其一階導數條件為：
0
)(
])([2
1


n
i
i
ii dX
Xdf
LXf
dX
dR
設 X 的初值為 X0，用 )(Xf 的一階 Taylor 展式代替 )(Xf ，則 )(Xf i 在
0X 附近的近
似 Taylor 展式為：
)(
)(
)()( 00
0
XX
dX
Xdf
XfXf
X
i
ii  （1-26）
得
)(
)()()( 0
0
0
0
XB
XX
XfXf
dX
Xdf
i
ii
X
i 

 ，
所以有： 


n
i
ii
n
i
iii XLXXBLXXXBXfR
1
200
1
2000 )](
~
)([]))(()([ ,其
中
0000 )()()(
~
XXBXfLXL iiii  。對於給定的 )(, 00 XBX i 和 )( 0XLi 是確定
的，則上式的最小二乘估計為：
12
約束條件： kkdX 
式中： k為一正數，它隨迭代而變化。約束條件∥dXk∥≤ k，限制了 kdX ，使 kdX
的長度不大於 k，這樣 kdX 總在一個給定的小區域中活動。這個區域是可信賴的，
所以稱該方法為信賴域法。
常數 k取決於 )( 1kXQ 對 )( 1kXR 的逼近程度。這個逼近程度可用下式來描述
)(
)(
1
1


 k
k
k XQ
XR
r
rk越接近於 1， )( 1kXQ 對 )( 1kXR 的逼近程度越好，於是







75.025.0,
75.0,2
25.0,4/
1
k
k
k
k
k
k
k
r
rdX
rdX

 （1-32）
12.2.4 Quisi-Newton 法
Quisi-Newton 法的關鍵是尋找一個隻含一階偏導數資訊的 Qk矩陣。由（1-31）式
有
























2
2
1
2
1
2
2
1
2
pp
p
k
X
R
XX
R
XX
R
X
R
h （1-33）
根據多元函數偏導數的定義：
i
ppii
X
i
p
X
XXfXXXXf
X
XXXf
i 





),,(),,,,(
lim
),,,( 11
0
21
有：




































p
p
pp
p
dX
p
p
p
dX
p
pp
dX
p
dX
p
pp
dX
p
dX
k
dX
XdXXX
dX
XXXdXX
dX
XdXXX
dX
XXXdXX
dX
XdXXX
dX
XXXdXX
h
p
p
p
)(),,(
lim
)(),,,(
lim
)(),,(
lim
)(),,,(
lim
)(),,(
lim
)(),,,(
lim
1
0
1
211
0
2
1
2
0
1
2
211
2
0
1
1
1
0
1
1
211
1
0
1
1
1



14
))()(()()()())((2
))()(()())((
LXfXBXBXBXBLXf
LXfXBXBLXf
nnTnnTnTn
nnTnTn
n

 （1-37）
式中 LXfV nn  )( ， n 由（1-37）式確定。
1.2.2.6 同倫演算法
對於非線性最小二乘平差模型，有
0))ˆ(()ˆ( ˆ 

  LXfP
X
f
X XX
T
（1-38）
這是最小二乘解必須滿足的一個精確正交條件方程。按同倫思想對 )ˆ(X 構造同倫函數：
)ˆ()1()ˆ()ˆ,( XbaXbXt 
對求一階偏導數：
  0)1()ˆ(ˆ
)ˆ,(













S
X
X
bbI
S
b
XaX
Xb
（1-39）
其中 ))ˆ((
ˆ
2
2
ˆ
ˆ LXfP
X
f
X
f
P
X
f
X
XXXX
XX
T











（1-40）
將（1-38），（1-39）代入（1-40）式，與初值微分方程 ),1()ˆ,( aXb  聯立得：

































),1()ˆ,(
0))])ˆ((
)(1([))ˆ((ˆ
ˆ
2
2
ˆˆˆ
aXb
S
X
LXfP
X
f
X
f
P
X
f
bbI
S
b
LXfP
X
f
aX
XX
XX
T
XX
T
XX
（1-41）
將初值代入初值微分方程得：
0][))(( 











 S
X
bI
S
b
LafP
X
f T
aX
對上式採用正交分解法求解，然後應用 Runge-Kutta 法求解微分方程：





),1()0(
)(
ay
yv
ds
dy
，
預估 ))(),(()( 01
0
1
0
1 sXsbsy
T ，並採用迭代法對 y1 進行修正，獲得滿足精度要求的
)( 01 sy ))(),(( 0101 sXsbT 。根據 ))(),(()( 010101 sXsbsy T 繼續跟蹤曲線 )(s ，則
微分方程（1-41）變為：
16
lBBBwlBBBBlBBlBBBdX TTTTTTT 11111 )](][))([()()(   （1-46）
由此可直接求得（1-1）式的參數估值。
由上式直接求參數估值，需先由線性近似求得 dX 的近似值代入右端，故由此得到
的是一個近似直接解，當模型的非線性強度很強時，仍可能存在模型估計誤差。
1.2.3.2 顧及二次項的直接解法
對模型（1-1）按非線性最小二乘估計準則，求 VTV=min 的極小解，即求滿足非線
性方程組（1-42）的 X 的估值 Xˆ 。將（1-42）式中的
XX
XXf ˆ/)(  和 )ˆ(Xf 在近似
值 X0處 Taylor 展開，取至二次項，忽略二次以上各項，有：
02
2
1
))(())((
00
0
2
2
2
2
0
2
2
0






























dXB
X
f
X
f
BdX
dXLXf
X
f
BBLXfB
T
XXXX
TT
T
XX
TT
（1-47）
w、l的定義同前，則由上式可得：
    2/)()( 11 dXwBdXdXwBdXlBBlBBBdX TTTTTT   （ 1-48）
同上用 lBBB TT 1)(  代替上式右邊的 dX得 ：
    2/)())(()()()( 11111 lBBBwBlBBBlBBBwBdXlBBlBBBdX TTTTTTTTTTTT   （1-49）
由此可直接求得（1-1）式的參數估值。
由上式直接求參數估值，需先由線性近似求得 dX 的近似值代入右端，且忽略了三
階以上偏導數項，故由此得到的是一個近似直接解，當模型的非線性強度很強時，仍可
能存在模型估計誤差。
1.2.4 最小二乘參數估計的其他解法
前面介紹的各種演算法，都需要求導計算，當 f(X)比較複雜時，求導很困難。尤
其是當 )(Xf 不可微時，前面介紹的各種方法均不能應用。以下是幾種無需求導計算的
直接搜索演算法。
1.2.4.1 單純形法
單純形法是一種只需要計算函數值而無需求導的方法。其基本原理如下：對於非線
性模型中的 p 個待估參數，按一定的規則選取 p +1 組近似值，構成初始單純形。用此
p +1 組近似值計算 p +1 個目標函數值並比較其大小，找出最大的目標函數值，並剔除
相應的那組參數近似值。然後按一定的換點規則換入新的一組參數近似值。用這組新的
18
cX 縮短距離，稱為縮短，縮短點用 SX 表示。縮短後，計算縮短點 SX 的目標函數值 SR 。
若 US RR  ，則用 SX 取代 UX ，構成新的單純形。
（4）、縮小
當反射無效，即 RR 、 ER 和 SR 均不小於 UR 時，可將整個單純形向目標函數值最
小點 LX 處縮小。通常將單純形縮小一半。
按上述換點規則逐步變換單純形，就可以使最終的單純形頂點的目標函數最小值，
以給定的精度逼近其極小值。搜索終止條件為下述兩個條件之一：
（1） 向量在某步的移動距離小於某限值
（2） 函數值在某步的減少量小於某限值
運算式為：





p
i
Li
Li
RXR
p
pieXX
0
2))((
1
1
,,1)(
（1-52)
式中 、e ＞0 為給定的誤差限。
1.2.4.2 類比退火演算法
類比退火演算法（Simulated Annealing Algorithms）是一種求目標函數極小值的
全局優化演算法，其基本思想來源於統計物理學：當金屬在高溫下熔化時，所有原子都
處於高能的自由運動狀態，隨著溫度的降低，原子的自由運動減弱，物體的能量隨之降
低，只要在凝結溫度附近使溫度下降足夠慢，原子排列就越來越有規則，從而形成結晶。
這一過程稱為退火過程，可用來類比多元目標連續函數的優化過程。退火過程服從
Boltzmann 概率分佈。用物理上的退火過程來類比多元目標函數的優化過程，稱為類比
退火演算法。
類比退火演算法可概述為：
1.取初始點 X0和初始溫度 T，並令 k=1。
2.算初始點 X0的目標函數值 )( 0XE 。
3.若 T=0，則轉 6。
4.對 X0進行隨機擾動，得到新點 X1。
5.計算新點 X1的目標函數值 )( 1XE 和目標函數之差 )()( 01 XEXEE  ：
①若 0E ，則降溫： )10lg(/ kTT  ，且令 10 XX  ， )()( 10 XEXE  ，
20
富，除最小二乘估計外，還有非線性模型的穩健估計、非線性模型的極大似然估計、非
線性模型的 Bayes 估計等。
1.3.1 穩健估計
設同精度獨立觀測值為 TnLLL )1 （ ，其非線性誤差方程為： LXfV  )ˆ( ，
純量形式為：
iii LXfV  )ˆ( （1-53）
求解誤差方程式的準則函數可表達為下列最優化問題：
 min)( iV （1-54）
最優化準則函數 )( iV 取不同的形式，可得到不同的最優化準則。較常用的 )( iV 有：
（1） Huber 提出的：






kuusignk
ku
u
)(
1
)(
（2） Tukey 提出的：





























Bu
B
Bu
B
uB
u
6
11
6
)(
2
322





















Bu
Bu
B
u
u
u
0
1
)(
22

（3） Andrews 提出的：









AuA
Au
A
u
A
u



2
2
2
cos1
)(






Au
Au
A
u
A
u



0
sin
)(
（4） uu )( 為總體期望值；
（5） )(u 為總體中位數；
22


































 4
2
22
2
2
2
2
22
2
2
0
0)(
)(
)( 


 n
BB
L
X
L
X
L
XX
L
E
XX
L
EZI
T
T
T
T
是分塊對角陣，且一旦估計出 2,X 就估計出來了，故只需單獨考慮 X 的演算法。X 的
極大似然估計迭代演算法一般公式為：
nX
n
nn
X
L
PXX

1
在 Newton-Raphson演算法裏，
nX
Tn XX
L
P
12 






nP 是對數似然函數的 Hessian 矩陣；在 Guass-Newton演算法裏，取 nP 為 Hessian矩陣
的數學期望，即資訊矩陣逆的反號，運算式為：
nX
Tn XX
L
EP
12 






在 BHHH 演算法中取
2,
1
1 nX
T
i
n
i
i
n X
L
X
L
P





 











 ，其中   X
XfLXf
X
L iiii



 )()(
2
。
Xˆ 相應的漸近方差陣分別為：
2ˆ,ˆ
12
ˆ
X
TX XX
L







2ˆ,ˆ
12
ˆ
X
TX XX
L
E







2ˆ,ˆ
1
1
ˆ
nX
T
i
n
i
i
X X
L
X
L





 











 
1.3.3 Bayes 估計
Bayes 定理 :設 TnLLL )( 1  為觀測向量，其分佈密度為 )/( XLf 。這裏
T
pXXX )( 1 ， X ，為參數空間，且 X具有先驗分佈密度 )(X 。於是，X
的後驗分佈密度為： )()/()/( XXLfLXf  。
24
Part 2 非參數模型估計
§2.1 非參數模型的估計概述
不知道總體分佈的具體形式的資料時，武斷地假設總體分佈的形式並進行參數估計
或檢驗，顯然是不可取的，有時甚至是災難性的，這導致了非參數統計的產生。對於不
知道來自何種分佈的資料，可以用分佈擬合方法來確定擬合分佈，然後進行相關檢驗。
若統計問題不需要完全瞭解總體分佈的具體形式（如用一組資料估計總體的 P 分位元
數，兩組資料是否來自同一分佈，兩組資料是否來自相互獨立的總體等），可直接構成
相應的統計量，對這些問題進行估計和檢驗，常用的有次序統計量方法，秩方法，符號
檢驗法，Wilcoxcon 秩和檢驗法、符號秩和檢驗法等，另外還可用游程檢驗法來檢驗資
料的隨機性，因為非參數統計問題對資料的基本要求必須是具備隨機性。在非參數統計
問題中，僅僅限於推斷某些未知參數是不夠的，非參數統計還可對未知的總體分佈進行
推斷，如用經驗分佈函數估計未知總體分佈函數，用直方圖、Rosenblatt 估計、Parzen
核估計、近鄰估計來估計密度函數等。
參數估計與非參數估計的區分是相對的。在非參數估計中，也存在無偏、相合、漸
近正態、均方相合等概念。由於半參數模型中的非參數分量的估計是以非參數模型的估
計為基礎的，故在此概略介紹非參數估計的有關理論和方法。
設非參數模型為：
iii tgL  )( ， ni ,,1  （2-1）
iL 為 .iid 觀測量， i為 .iid 隨機觀測誤差， niitt 1 ，it 與 i 相互獨立，
0)( iE ， 0)(  jiE ， )( ji ， 22 )( iE ， iL 是 it 時 的 觀 測 值 ，
10 1  ntt 。
§2.2 非參數模型的權函數估計法
權函數法作為一種非參數估計方法已有較長歷史，核函數和近鄰函數是兩種最基本
的權函數, 相應的非參數估計叫核估計和近鄰估計。設模型為（2-1），則 )( xtg 的
權函數估計 )( xW tg 可表示為下述形式： 


n
i
ixixW LtWtg
1
)()(ˆ （2-2）
其中 )( xi tW 為權函數，設 ),,;()( 1 nxixi tttWtW  是選定的 n 個依賴於 t的 Borel函
數， )(ˆ xW tg 總是 Li的線性組合，一個 Li對應一個 iW ， ii tW与 一般無對應關係， iW 的
構造可能與全體it 或部分的it 有關，視具體函數而定，故 iW 一般寫為
26
較常用的核函數有：


0
2
0
2
cos
2)(1 







 c
c
u
c
ucu
c
uK 

（2-9）


0
0
4
)1(3
)(
2
2
2 








 a
au
au
a
a
u
uK （2-10）


 

其他0
11
)(3
uu
uK （2-11）


  
其他0
11
2
1
2
1
)( )1,1[4
u
uIuK ，此為平均核 （2-12）


 u
u
uK
)1(
1
)( 25 
（2-13）
0)()
2
exp(
2
1
)( 2
2
6  
u
u
uK （2-14）











 u
u
u
uK
2
7
2
2
sin
2
1
)(

（2-15）
  ueuK u
2
1
)(8 （2-16）
它們大多為某個隨機變數的概率密度函數。
2.2.2 近鄰估計
近鄰權是一種具有優良大樣本性質的權函數.該方法的要旨首先是引進一個衡量 R
中兩點 vu、 的距離的函數 ，可以是歐氏距離



n
i
ii vuvu
1
22 )(
也可以是馬氏距離 iini
vuvu 
1
max
為了反映各分量的重要程度及其在單位大小上的差別，可引進權因數 nCC ,,1  ，使 iC
滿足配方條件，即 1,0
1
 

n
i
ii CC 。將距離函數改進為 


n
i
iii vuCvu
1
22 )( 或
ii
ni
i vuCvu 
1
max 。現觀測值為niiL 1，指定空間中某一點 xt ，來估計函數在
該點的值 )( xtg ，將 ntt ,,1  按所選的距離意義下與 xt 接近的程度排序：
28
差估值，採用
)(
)(ˆ( 2
1
Wtrn
tgL j
n
j
j




 

求得；Hi為核 iK 對應的光滑參數，即窗寬。
圖 2-1 是 )(1 tg 的核權函數估計，分別對應於前述的核函數 1K 、 2K 、 8K、 ，
圖 2-2 和 2-3 分別是 )(2 tg 和 )(3 tg 的核權函數估計，與核的對應關係同圖 2-1。從
圖上可看出，除平均核權函數估計（與 7K 相對應）略顯光滑不足外，其餘的核權
函數估計的光滑性均很好，尤其對頻率較低的信號 )(1 tg ，擬合度也不錯。分析表
2-1 中的 i，對不同的類比信號， 6k 的擬合度均最高；而不同的核權函數估計，
又以對頻率較高的非週期信號 )(3 tg 的估計效果最差。相同的樣本量和類比觀測雜
訊下，不同的核對同一信號有不同的窗寬，同一核對不同的信號窗寬也不同，見表
2-2。
圖 2-4 是 )(1 tg 的近鄰權函數估計，a、b 分別對應于線性近鄰權和平方近鄰權。圖
2-5、2-6 分別是 )(2 tg 和 )(3 tg 的近鄰權函數估計。權函數估計對頻率較低的信號的估
計質量也高於頻率較高的信號。 i計算方法同上，Ki 為近鄰寬度。表 2-3 為不同信號
的近鄰權函數估計精度，由此可看出，近鄰權函數估計與核權函數估計類似，對 )(1 tg 和
)(3 tg 的估計精度較高， i與模擬值相當，而對 )(2 tg 的估計精度較低。
圖 2-1 不同核函數下 )(1 tg 的核權函數估計
30
g2 0.69115 1.06810 1.31950 0.69115 0.43982 3.07880 0.06283 0.62832
g3 0.14923 0.21991 0.28274 0.15708 0.09425 0.77754 0.01571 0.12566
(a) (b) （a） (b)
圖 2-4 )(1 tg 的近鄰權函數估計 圖 2-5 )(2 tg 的近鄰權函數估計
表 2-3
(a) (b)
圖 2-6 )(3 tg 的近鄰權函數估計
§2.3 非參數模型的其他估計方法
最小二乘類非參數估計是非參數模型的另一類主要估計方法，有 Fourier 級數估
計、樣條估計、多項式估計或分塊多項式估計及小波估計等。 
2.3.1 Fourier 級數估計
設 ]1,0[)( 2Ltg x  ，則 )( xtg 有 Fourier 級數展開：
  ]1,0[)2sin()2cos(
2
~)(
1
0 


x
j
xjxjx tjtjttg 

（2-21）
今取為正整數，用
 



 

1
0 )2sin()2cos(
2
~)(
j
xjxjx jtjttg
 線性近鄰權 平方近鄰權
g1 0.12264 0.12178
g2 0.29008 0.29531
g3 0.11450 0.11307
32
顯然， )(ˆ xtg 為 xt 的一個多項式，故此估計為多項式估計，顯而易見，多項式估計由
多項式函數 jU 所確定。在非參數估計中常用的多項式函數有：
Legendre 多項式：
1)(0 uU ， 




 






 ,2,1
)()(,
)()(,
)(
1
0
1
0 j
uUuUXu
uUuUXu
uU
j
k
kk
jj
j
k
kk
jj
j
 gf , 為 ]1,0[2L 的內積， f 為 ]1,0[2L 的範數。
冪多項式：
 ,1,0)( juuU jj
加權冪多項式：
選定  個常數 ,,1 rja jr 、 ，定義

















aa
aa
A
1
111


,,1)(
1
1 

 kjuauU
K
k
kjj 、
要求 A 滿足非負正交條件：





 kj
kj
uUuU
n
n
r
rkrj 0
1
)()(
1
1
與 Fourier 級數估計一樣，多項式估計的表現大多不如權函數估計。
由函數逼近理論知，任何一個連續函數的曲線可用分段多項式來無限逼近，那麼
對於 n個數據點，可用 n-1 次多項式來精確地通過所有點。對於高次多項式存在逼近精
度與計算結果穩定性之間的矛盾，資料很小的偏差可引起函數值的大幅度震盪；對於低
次多項式計算結果穩定，但擬合誤差一般會增大。所以一種調和的方法是用分塊多項式。
2.3.3 分塊多項式估計
設 1N 為同 n 有關的整數，將[0，1]分成 N 個小區間：
 
 



II
NiiiI
nN
ni
,21
1,,12,)1(2


，其中
N2
1
記 )12(  iti ，   Nitttttt TmixixxIxni ni ,,1,)()(1)()( 1   ， )( xn t  TxnNxn tt )()(1   為
34
2.3.5 小波估計
首先要構造 ]1,0[2L 上的緊支撐正交小波基，有多種方法，如先構造 )(2 RL 上任一
組 Daobechies 正交小波：設 )(t 和 )(t 分別是尺度函數和母小波，要求 )(t 和 )(t 緊
支撐，有連續導數，且 )(t 有 N-1 階消失矩，則對任何滿足 Nj 02 的正整數 0j ，可
找到函數集合








12,,1,0,,)(
12,,1,0,)(
0
0
0
j
jk
j
kj
kjjt
kt


構成 ]1,0[2L 上的標準正交基。則對任意 ]1,0[2Lf  有展開式：
 







12
0
12
0
0
0
00
)()()(
j j
k jj k
jkjkkjkj tbtatf  （2-34）
在 ]1,0[2L 意義下收斂，式中：
  10
1
0
)()(,)()(
00
dtttfbdtttfa jkjkkjkj  （2-35）
這樣得到的 ]1,0[2L 上的標準正交基繼承了尺度函數 )(t 和母小波 )(t 的性質（緊支
撐，有一階連續導數），並且對固定的 0j ，當 Nk  ， ,1N 12, 0  Nj 時有：
)2(2)( 00
0
2/ ktt jjkj  
對固定的 j ，當 12,,1,  NNNk j 時有：
)2(2)( 2/ ktt jjjk   （2-36）
於是，對於非參數模型（3-1）式，由 Hall 和 Patil 構造的正交小波基得到的非
參數小波估計為：
 

 



12
0
12
0
}ˆ{
0 1
0
00
)(ˆ)(ˆ)(ˆ
j j
jk
k
j
jj k
xjkbjkxkjkjx
tIbtatg   （2-37）
由 Delyon 和 Judisky 構造的正交小波基得到的非參數小波估計為：
 

 



12
0
12
0
}ˆ{
0 1
0
00
)(ˆ)(ˆ)(ˆ
j j
jk
k
j
jj k
xjkbjkxkjkjx
tIbtatg   （2-38）
2.3.6 算例
設模型和類比資料同 2.2.3，對於 Fourier 級數估計，經大量試算，對高頻和低頻
信號，結果均不太理想，在統計學文獻中也證明 Fourier 級數估計的大樣本性質不如核
估計，這可能是實際應用中很少採用此估計的緣故。
36
來做估計的擬合。以樣條估計為例，令 )()()( i
i
ii
i
i xgLV  ， )(1)( ( ii VV  TinV ))( ，
)()( ig 為基於觀測量 },,,,,,{ 1121 nii LLLLL   的極小化 min)()()(  gJPVV i
Ti 
的解。定義 )()()( i
Ti PVVCV  ，然後挑選，使 min)( CV ，此法叫 CV 法。但
)(CV 不易計算，以同精度觀測為例，對於光滑樣條估計有如下簡便公式：







n
i ii
n
j
iiji
h
LhL
n
CV
1
2
2
1
))(1(
))((
1
)(


 （2-39）
當 1)( iih 時，該項對 )(CV 的貢獻特別大，反之 0)( iih 時，對 )(CV 的貢獻則
偏小。所以當 )}({ iih 參差不齊時， )(CV 有較大的波動。為此，用
))((
1
)(
1
1
 htr
n
h
n
n
i
ii 

代替單個 )(iih ，就得到 GCV 準則：
2
1
2
1
)((
1
))((
1
)(




 


 
 



hItr
n
LhL
n
GCV
n
i
n
j
iiji （2-40）
GCV 法有光滑不足的傾向，當 GCV 曲線較平緩時，往往取得較差的極小點。
2.4.2 L曲線法
設觀測方程為 iii tgL  )( ， i為雜訊， )( itg 是觀測值的信號，寫為向量形式：
gL ， TnLLL )( 1  ，是相應於 Tnttt )( 1 的觀測量。 Tnggg )( 1  ，
T
n )( 1  ，R 是選定的光滑矩陣。考察 0 的曲線 )(),(  g ，其中
)(ˆ)(ˆ)(  gRgg T 為信號範數， )( 為雜訊範數。L 曲線是關於參數的信號
的範數對雜訊的範數的參數圖，所得到的曲線稱為 L 曲線。可以證明該曲線是 L 形的。
關於如何選擇合適的，有兩種建議：一是選擇距離原點最近的點，稱為 D；一
是選擇曲線上曲率最大的點即拐點，稱為 K。
2.4.3 Iterative Plug-in
對於核估計，窗寬選擇的通用辦法是 GCV 或 L曲線法。當樣本容量太大時，這些方
法存在計算上的困難，而且在高維時不可靠，這時可用迭代插入法。迭代插入法是把未
知函數的估計插入到漸近公式裏以確定最佳光滑參數。以一維核估計為例，先選擇核函
數 K，核函數有其確定的支撐，選擇權函數 W，確定窗寬 H 的上、下界，取核函數 K 的
支撐寬度的二分之一作為上界，下界的取法為使  
n
i
ii HtHt
1
,


覆蓋 W的支撐集。核估計可取（2-4）形式，極小化均方誤差： ))(()( HISEEHMISE  ，
38
(a) 樣條估計 (b) 核估計
圖 2-9 兩種估計方法的結果對比
40
從數學的觀點看，最小二乘準則提供了最優的解一組有多餘觀測的線性代數方程組的方
法，比較易於用歐氏空間的概念進行解釋，並能進一步擴展到無限維的 Hilbert 空間。
§3.1 最小二乘核估計
3.1.1 估計方法
設模型為（4-1），其中 1)( 1  pXXX Tp 是未知參數, TnLLL )( 1  ，
 1(BB TnB ) ，  )(( 1tgg Tntg ))( ， itg 是定義在 1,0 上的未知函數，
T
n )( 1  是 .iid 隨機誤差向量，且 0)( iE ， )( 2iE ，  1,0it ，
10 1  ntt ， it 與 i相互獨立。
選定 R上的概率密度核函數 )(K 及 0H ，對選定的點 kt ，定義核權函數 )( ki tW 為： 
 
nkji
HttK
HttK
tW n
j
jk
ik
ki ,,1
)(
)(
)(
1
1
1







、、 （3-3）
假設 X已知，基於 niiii tXBL 1,  作出 ktg 的非參數核估計：



n
i
iikik XBLtWXtg
1
))((),(ˆ （3-4）
其中 K 是與 H及 ntt ,,1  有關的核權函數。由 ),(ˆ Xtg k 計算觀測值的殘差：
kkkk LXtgXBV  ),(ˆ （3-5）
寫成向量形式為 ))(( LBXWIV  ，再由最小二乘準則得：
min))(()()(  LBXWIPWILBX TT （3-6）
記 nnji tWW  ))(( ，則上式的法方程為：
LWIPWIBBXWIPWIB TTTT )()()()(  （3-7）
若 pBrank )( ，即B 滿秩，則 BWIPWIB TT )()(  非奇異，X的最小二乘估計為：
  LWIPWIBBWIPWIBX TTTTk )()()()(ˆ 1   (3-8）
kXˆ 代入 ),(ˆ Xtg k ，得 )(tg 的估計 )ˆ,(ˆ kk Xtg ：
)ˆ()ˆ)(()ˆ,(ˆ
1
k
n
i
kiiikk XBLWXBLtWXtg 

（3-9）
3.1.2 算例
設模型為（3-1），L 為觀測值向量，n 取 100，p取 2， pnibB jji  为)20/(}{ ,
階矩陣，X 的真值取 TX ]3000020000[ ， Tntgtgtg ))()(()( 1  為信號向量，取
42
（a） (b)
圖 3-3 非參數分量取 3g 時的最小二乘核估計
表 3-1 未知參數的半參數核估計與參數估計結果比較
最小二乘半參數核估計 最小二乘參數估計
X1k X2 k V k TV k X1p X2 p V p TV p
g1 20001.1590 29999.8956 0.8681 20002.6490 29999.6501 38.64700
g2 20001.809 29999.9861 1.2727 20003.7386 29999.5639 107.62522
g3 20000.3940 30000.0172 0.7702 20001.9220 29999.7242 65.30291
採用 GCV 法的關鍵在於迴圈步長的選擇和搜索空間的確定。對於最小二乘核估計，
當核 )(uK 對稱且單峰時， )(ˆ ktg 是集中在 kt 附近一個鄰域的樣本的加權平均，窗寬 H 正
好是這個鄰域的寬度。我們所選的核往往滿足對稱且單峰的條件，因此，在核估計中， H
的取值不會超過 t 的取值範圍，故可定 ntt ,1 為 H 的搜索空間，本例為  2,50/ ，對
於等間隔的 it ，可取最小間隔為迴圈步長來搜索最佳窗寬，本例為 50/ 。
所列三個算例，採用半參數模型，都可估計出系統誤差即非參數分量的大致形狀，
大大改善了存在明顯光滑系統誤差情況下未知參數的估值和估計殘差。由計算結果可以
看出，無論是未知參數估值與模擬真值的接近程度，還是殘差的大小和分佈狀態，半參
數模型所得的結果，明顯好於參數模型估計的結果。半參數模型參數分量估值與真值的
接近程度，也說明了所提出的核估計中確定光滑參數搜索範圍和搜索步長的方法對本算
44
差的大致形狀，大大改善了存在明顯光滑系統誤差情況下未知參數的估值和估計殘差，
（a） (b)
圖 3-4 非參數分量取 1g 時的最小二乘線性近鄰權函數估計
（a） (b)
圖 3-5 非參數分量取 2g 時的最小二乘線性近鄰權函數估計
（a） (b)
圖 3-6 非參數分量取 3g 時的最小二乘線性近鄰權函數估計
表 3-2 未知參數的半參數近鄰估計
線性近鄰權估計 平方近鄰權估計
46

















 PL
PLB
g
X
KPPB
PBPBB TTT
ˆ
ˆ

（3-21）
當 pBFrank T )( （p 為未知參數個數）時，法方程係數陣滿秩。若法方程係數陣滿秩，
則 Xg ˆ、ˆ 有唯一解，令 ])([)( 1 PKPIPP   ，則解為：
 
   






LPBBPBBIPKPg
LPBBPBX
TT
TT
)()()(ˆ
)()(ˆ
11
1



 （3-22）
3.3.2 算例
取模型和類比資料同 3.1.2 算例，未知參數向量半參數估值為 Xˆ ，忽略系統誤差
項，採用最小二乘參數模型進行估計，參數估值為 PX 。圖 3-10、3-11、3-12 分別為非
參數分量取 g1、g2、g3時的樣條估計結果，(a) 中的粗實線代表半參數估計出的系統誤差，
細實線代表系統誤差的模擬值，(b)中的粗實線代表半參數模型樣條估計的殘差，細實線
代表參數模型最小二乘估計的殘差。半參數模型估計和參數模型估計的殘差分別按
)ˆ)(( LXBWIV   和 LXBV p  ˆ 計算。未知參數的見表 3-3。此三個算例，採用
半參數模型的樣條估計，可估計出系統誤差的大致形狀，大大改善存在明顯光滑系統誤
（a） (b)
圖 3-10 非參數分量取 1g 時的樣條估計
48
§3.4 線性半參數模型的其他估計方法
3.4.1 分塊多項式估計
設模型為（3-1），M 為一個與樣本量 n有關的給定的正整數，將 1,0 等分成 M 份：
 
 



1,21
1,,12,)1(2


nM
nv
I
MvvvI
nvI
 為 nvI 的示性函數， TmvxvxIxnv ttttt nv ))()(1()(  ， Mv ,,1  。 vt 為 nvI
中的點，可取 nvI 的中點，也可是其他點。定義
T
xnxn tt )(()( 1  TTxnM t ))( ，記
Mmq )1(  ，則形如：   Txnx ttg )()( 的函數是 1,0 上的 m 次分塊多項式，其中
qR ，我們用 )(g 逼近 )(g ，得：
iiii LtgXBV  )(
由最小二乘準則得：
min])([ 2
11
2 

iii
n
i
i
n
i
ii LtgXBPVP （3-23）
上式等價於 min])([ 2
1


i
T
ini
n
i
i LtXBP 
由此解算參數的估值，其解 Xˆ 和 )(ˆtg q 為 X 和 )(g 的分塊多項式最小二乘估計。 記
,)( 1
T
nVVV  iTinii LtXBV   )( ，則
  LXtBLtBXV TnTn 


  )()( （3-24）
當 nqp  時，得法方程：
  PL
t
BX
tBP
t
B
n
T
T
n
n
T















)(
)(
)( 


（3-25）
由上式可得：
)ˆ)(()(ˆ 1  TnTTTM tPBPLBPBBX   （3-26a）
)ˆ)()(())()((ˆ 1 Mnn
T
nn XPBtPLttPt    （3-26b）
整理之，令 ])())()()(([)( 1 PttPttIPP n
T
nn
T
n   （3-27）
得： LPBXBPB TT )(ˆ)(   （3-28）
其中 I為 n階單位陣，由矩陣反演可證明，只要滿足 pBPBrank T ))((  （p為未知參
數的個數），則 BPBT )( 可逆，方程（3-28）有唯一解：
LPBBPBX TTM )())((ˆ
1   （3-29）
50
可得 )(tg 的估計為：
)ˆ()()(ˆ  XBLSttg
T  （3-39）
3.4.3 小波估計
 設模型為（3-1），假定： pjnitfB ijijij  1,1,)(  ， )(jf 是定義在[0,1]
上的未知函數， Tipii )( 1   為 .iid 向量， 0)( iE  ，  ),cov( ji ，其中
 ij ，為 p階正定矩陣。i 與 i 相互獨立。
設有某給定的尺度函數 )( ，相伴 )(2 RL 的多尺度分析為 m ， m的再生核為：



Zk
mmmmmm
m ksktstEstE )2()2(2)2,2(2),( 0  （3-40）
記  iii ssA ,1 是[0,1]的一個分割，且 niAt ii  1, 。當 X已知時，定義 )(g 的估計
為：
 


n
i A
mii
i
dsstEXBLXtg
1
0 ),()(),(ˆ （3-41）
有 LXtgBXV  ),(ˆ0 ，應用最小二乘準則，X 的小波估計為極小化：
minPVV T （3-42）
的解。記

jA
imij dsstES ),( , nnijSS  )(
則 )(),(ˆ0 BXLSXtg  。（3-42）式可寫為：
min))(()()(  LBXSIPSILBX TT （3-43）
其法方程為：
LSIPSIBBXSIPSIB TTTT )()()()(  （3-44）
解之得 X 的小波估計 0ˆX ：
LSIPSIBBSIPSIBX TTTT )()())()((ˆ 10   （3-45）
最後得 )(tg 的小波估計為：
)ˆ()(ˆ0 XBLStg  （3-46）
3.4.4 兩階段最小二乘估計 
 設模型為（3-1）， ))(( itgE ， ))(( 2 itgE 。 iii tge  )( ， ni ,,1  ，
則 ie 為 iid.隨機量，且 ,0)( ieE  ))(var(22 iei tgeE  2  220ˆ  ，則
有 iiiiii eXBtgXBL  )( 。引入記號：  TnLLL  1 ，  1(BB TnB ) ，
52
最小二乘參數模型估計結果對比見表 3-4：
表 3-4 四種估計結果對比
g1 g2 g3
X1 20001.1590 20001.8094 20000.3940
X2 29999.8956 29999.9861 30000.0172核估計
VTV 0.8681 1.2727 0.7702
X1 20000.8724 20001.1640 19999.7268
X2 29999.8769 30000.2837 30000.0929平方近鄰權
VTV 0.7649 0.7179 0.8224
X1 19999.9556 20000.4144 19999.7428
X2 30000.0552 30000.3567 30000.0941
近
鄰
權
線性近鄰權
VTV 0.5219 0.5249 0.8838
X1 20000.0011 19999.9655 19999.8465
X2 29999.8970 30000.0805 30000.0479樣條估計
VTV 0.8231 1.7239 0.9022
X1 20002.6490 20003.7386 20001.9220
X2 29999.6501 29999.5639 29999.7242參數模型估計
VTV 38.6470 107.6252 65.3029
由表 3-4 可見，在存在明顯光滑系統誤差的情況下，無論是核權函數估計、近鄰權
函數估計還是樣條估計，在未知參數估值與模擬真值的接近程度以及殘差平方和的大小
等方面，採用半參數模型的估計結果明顯好於參數模型估計結果。
§3.6 線性半參數模型估計的統計性質
3.6.1未知參數估計的漸近正態性和漸近方差
若半參數模型滿足各估計方法的條件，當 n 時，未知參數 X 的估值 Xˆ 是漸近常
54
3.6.2 未知參數估計的有偏性
半參數模型未知參數的最小二乘核估計式為（3-8），對其取期望，並顧及
 gBXL ， 0)( E 得：
  ))()()()(()ˆ( 1 LWIPWIBBWIPWIBEXE TTTTk  
  gWIPWIBBWIPWIBX TTTT )()()()( 1  
令   )()()()( 11 WIPWIBBWIPWIBBH TTTT   ，則： gHXXE k 1)ˆ( 
顯然 hXˆ 是 X 的有偏估計，偏量為：
  gWIPWIBBWIPWIB TTTT )()()()( 1   （3-61）
最小二乘近鄰估計、樣條估計等估計方法的未知參數的估計式與（3-8）式有相同的
形式，採用類似的方法可以證明，它們均是 X的有偏估計。最小二乘近鄰估計的偏量為：
  gCIPCIBBCIPCIB TTTT )()()()( 1   （3-62）
樣條估計的偏量為：   gPBBPB TT )()( 1   （3-63）
分塊多項式最小二乘估計的偏量為：
)())(( 1  PBBPB TT  （3-64）
三角級數估計偏量為：
)())(( 1  PBBPB TT  （3-65）
3.6.3 非參數分量估計的有偏性
半參數模型非參數分量的最小二乘核估計式為（3-9），對其取期望，並顧及（3-11）
式和得：
gHIWLEHIWXBLWEgE hk )()()())ˆ(()ˆ( 11 
gIWHWg )( 1
顯然 kgˆ 是 g 的有偏估計，偏量為：
gIWBHW )( 1 （3-66）
最小二乘近鄰估計、樣條估計等估計方法的非參數分量的估計式與（3-9）式有相同的形
式，它們均是 g的有偏估計。非參數分量的最小二乘近鄰權估計的偏差為：
gICBHC )( 2  （3-67）
非參數分量的樣條估計的偏差為：
56
在此採用的是 u檢驗進行常態檢驗。u檢驗一般適用於大樣本，它要求參數服從常態
分佈，母體中誤差已知，或者母體非常態，樣本充分大（至少為 30）時，根據中心極限
定理可知參數漸近服從期望和中誤差為母體期望和母體中誤差的常態分佈，可進行 u 檢
驗。下面採用雙尾檢驗，假設非參數分量表徵資料中的系統誤差。
給出原假設 0:0 gH 和備選假設 0:1 gH ，對給定的顯著水平，查表得分位
值 2/u ；計算統計檢驗量的值 uˆ ，若 2/ˆ uu  ，則拒絕 0H ，認為在顯著水平（1-
置信水平）下，觀測資料中的系統誤差是顯著的，應採用半參數模型處理；若 2/ˆ uu  ，
則接受 0H ，認為在顯著水平下，觀測資料中的系統誤差不顯著，應採用參數模型進
行處理。
§3.8 用線性半參數模型估計方法估計非線性參數模型
3.8.1非線性參數模型與線性半參數模型
設非線性模型為（1-1），式中 L為同精度獨立觀測值向量，f(X)=（f(X) … f(X)）
T，是由 n 個 X 的非線性函數組成的向量。文獻已證明，當模型的非線性強度較弱時，可
將模型在初始值處線性化，用線性模型理論和方法求解。當模型的固有曲率較小而參數
效應曲率較大時，採用適當的參數變換減小模型的參數效應曲率，仍能達到線性近似的
目的。當模型的固有曲率較大時，由於線性近似將產生較大的模型誤差，則需要採用迭
代類解法、顧及 Taylor 展式二、三次項的直接解法、遺傳演算法、類比退火法以及單純
形法等非線性解算方法。這些演算法各有優劣。
本節將半參數最小二乘核估計方法引入非線性模型的解算，具體思路如下：由於非
線性模型的 Taylor 展開式取一次項的余項是一個高次多項式，具有光滑性特徵，這與半
參數模型中的非參數分量的特徵相同，故非線性模型在初始值處用 Taylor 級數展開取一
次項後，將二次以上的各項用一光滑的非參數分量描述，構成半參數模型，按半參數模
型的解算方法來構造參數分量和半參數分量的解。參數分量的估值就是非線性模型參數
的估值，非參數分量的估值就是線性近似產生的模型誤差。
對模型（1-1），設參數的近似值向量為 TXXX )( 02010  ，將非線性方程組在 0X
處線性化取一次項，用非參數分量 )( itg 表達餘項，有：
nitgX
X
f
X
X
f
XfL iiu
Xu
i
X
i
ii ,,1)()(
00
1
1
0 



 （3-73）
寫成向量形式為：  gBxBL 0 （3-74）
58
L 29.12 14.43 9.53 7.09 5.62 4.64 3.94 … 2.42 2.19 2.00
取參數的近似值為 TX )3.04.5(0  ，計算得模型沿 h方向的固有曲率和參數效應曲
率較小，分別為0.000036 和 0.0213。將上式在 0X 處線性化取一次項，用非參數分量 )( itg
表達余項（ )25/iti  ，得線性半參數模型： iLi /4.5 2 iitgxix  )(/8.103.0 21 。
採用最小二乘核權函數估計非參數分量，由GCV法搜索得 H=0.1253 ,按半參數模型得參數
估值為  TkX 0.3000-5.4202ˆ ；對模型線性近似後採用最小二乘估計所得的參數估
值為  TPX 0.2587-5.4202ˆ 。兩種估計模型的殘差分別為 )ˆ)(( kk XBLWIV  和
pp XBLV ˆ ，如圖3-13所示，虛線為參數估計殘差，實線為半參數估計殘差。加入非
參數分量後，存在法方程係數陣奇異的問題，對核權函數估計法方程係數陣奇異的採用偽
逆求得，X 的第二個分量無改進，半參數法估計非線性模型所存在的法方程係數陣奇異的
與模型的非線性強度的關係，有待進一步研究。
算例 2：已知非線性模型為 25,,121  ieXL iXi ，其中參數的真值同算例 1， Li的部分
觀測值列於表 3-6。
表 3-6 模擬觀測值
i 1 2 3 4 5 6 7 … 23 24 25
L 4.20 3.25 2.52 1.95 1.51 1.17 0.91 … 0.33 0.25 0.19
取參數的近似值同算例 1，計算得模型沿 h 方向的固有曲率和參數效應曲率較大，分別為
0.0465和 0.2638。首先建立非線性模型的線性半參數模型：將上式在 0X 處線性化取一次
項，用非參數分量 )( itg 表達余項得：   2*3.01*3.0*3.0 **4.5*4.5 xeixeeL iiii )( itg i 。
採用最小二乘核權函數估計非參數分量 ， H=0.0627 ，進而得 參 數 估 值 為
 TkX 0.2535-5.3808ˆ ；對模型線性近似後採用最小二乘估計所得的參數估值為
 TPX 0.2468-5.3629ˆ 。
60
Part 4 非線性半參數模型估計
§4.1 引言
 設非線性半參數模型為：
 )()( tgXfL （4-1）
其中 )(Xf 為非線性已知函數， TpXXX )( 1 1p 是未知參數， it 是 .iid 隨機子
樣，  1,0it ， i是 .iid 隨機誤差，且 0iE ，  22 )( iE ， it 與 i相互獨立，
g 是定義在 1,0 上的未知函數。 
§4.2 非線性半參數模型的最小二乘核估計
4.2.1 估計方法
設模型為（4-1），記 TnLLL )( 1  ， Tn XfXfXf ))()(()( 1  ，採用兩步核
估計。選定 R 上的概率密度核函數 )(K 及窗寬 0H ，定義核權函數 )( ki tW 為： 
 
nkji
HttK
HttK
tW n
j
jk
ik
ki ,,1
)(
)(
)(
1
1
1







、、
記
 





















 
)()(
)()(
)()(
)(
1
1
111
,1,
nnn
ini
n
n
jiji
tWtW
tWtW
tWtW
tWW
，





 



 

n
k
kj
ij
ji
H
tt
K
H
tt
K
tW
1
)(
假設 X已知，基於 niiii tXfL 1),(  作出 itg 的非參數核估計：
 
  





















n
j
n
k
ki
jjji
n
j
jjiii
HttK
XfLHttK
XfLtWXtg
1
1
1
1
1 )(
))(()(
))()((),(ˆ （4-2）
設 )ˆ,(ˆ)ˆ( XtgLXfV  ，則有
62
 UMNG T ，為非線性模型的固有曲率立體陣。
4.2.3 顧及二次項的非線性直接解法
將（5-5）式中的 0/)( XXXf  和 )ˆ(Xf 分別在近似值
0X 處 Taylor 級數展開，並
取至二次項有：



















)(
)(
2
1)(
)()ˆ(
)(
)(
2
1)()()(
0
0
00
0
2
0
32
ˆ
bdX
XX
Xf
dXdX
X
Xf
XfXf
adX
XXX
Xf
dXdX
XX
Xf
X
Xf
X
Xf
Xji
T
X
Xkji
T
XjiXX （4-10）
當 )()()( 00 XBHPXB T 非奇異時有：
0
)(
)(
)()(
)(
)(
2
2
1
)(
)())((
)(
)(
)(
))()((
)(
0000
0000
22
2
00































dX
X
Xf
HP
XX
Xf
XX
Xf
HP
X
Xf
dX
dX
XX
Xf
HPLXf
X
Xf
HP
X
Xf
LXfHP
X
Xf
X
T
XjiXji
T
X
T
Xji
T
X
T
X
T
X
 
  2/)())(()())())(((
)())(()()())(()())((
11
111
lHPBHNwHPBlHPBHN
lHPBHNwBdXHPlHPHNlHPBHNdX
TTTT
TTT




(4-11)
將 )(HP 作平方根分解得 MMHP T)( ，再對 MB 進行 QR分解得：
  QRRNQMB T  0)( ，有 1RdX ， MlQT ，則（4-11）式可化為：
  2/)(11  HGMlNRRdX TTT  
 UMQH T ，為非線性模型的參數效應曲率立體陣，G 同上。
4.2.4 Guass-Newton 迭代解法
設初值為  TpXXX 0010 ,,  ，記 XXXfB ˆ/)(  ， ,(ˆ 10 dXXXdX  TpdX ), ，
在 0X 處線性化（4-3）式得誤差方程為：
 ))(()()( 00 LXfdXXBWIV 
當 )()()( 00 XBHPXB T 非奇異時，得改正數的計算公式為：
  ))()(()()()()( 00100 LXfHPXBXBHPXBdX TT  
從而   ))()(()()()()(ˆ 001000 LXfHPXBXBHPXBXX TT   ，當 dX較大時，可
令求得的 Xˆ 作為新的初始值，重複上面的計算過程，直到滿足要求為止，迭代公式為：
  ))()(()()()()( )()(1)()()()1( LXfHPXBXBHPXBXX kTkkTkkk   （4-12）
64
（7） 計算 )( iV  ， ])ˆ()[( )()( LXfWIV ii   ；
（8） 計算 )()( )( iTi PVV  ;
（9） i=i+1，若 ni ， )1()( 1  nttiH ni ，轉（3）；否則轉（1）；
（10） 取 )()( )( iTi PVV  中的最小值對應的 H。
4.2.6 法方程係數陣非奇異的性質
P 正定，當 n 充分大時， RnXBHPXB T /)()()( 00 ，R 為一正定陣，此時
TXB )(( 0 10 ))()( XBHP 存在。對於半參數模型的估計的大樣本性質一般都是基於一定
的假設條件的。為了此結論，首先給出如下假設條件：
條件 1：存在定義在 1,0 上的函數列 )(j 使得有
ijijij utB  )( ， ni ,,1  ， pj ,,1  （4-15a）
其中 iju 是實數序列，其作用相當於 .iid 隨機誤差，且與ie 相互獨立。定義
nuuR Tiin /lim （4-15b）
是一正定陣，且
0/lim 
 nin
au （4-15c）
條件 2： )(g 及 )(j 在 1,0 上滿足 Lipschitz 條件，即存在絕對常數  00 M 使得
 
tsMtfsf
ts
mts



0
1,0,
)()(sup
0
對所有的 10 0 m 均成立，其中 )()()(  jgf  。
條件 3：當 n 充分大時， )(iW 滿足：
（1）  1,0,1)(
1


ttW
n
i
i ；
（2） )()(max
1
1 n
n
j
jini
aOtW 

， nnan log ；
（3） )()(max
,1 njinji
bOtW 

， 2)(log  nnbn ；
（4） )()()(max
1
1 n
n
j
nijijni
dOcttItW 

。


nncnn logsuplim
4 ， 

nndnn logsuplim
4 ， )(tI 為 it 的 聯 合 分 佈 密 度 。 設
66
線性直接解法求得 X的非線性最小二乘分塊多項式估計為：
 
 





lCPBCNWCPBlCPBCN
lCPBCNWBdXCPlCPCNlCPBCNdX
TTTT
TTT
)())(()())())(((
2
1
)())(()()())(()())((
11
111
（4-19）
由 dXXX  0ˆ 可得未知參數 X 的估值 Xˆ ，代入（4-17）式得非參數分量的估計為：
))ˆ(())ˆ()(()(ˆ
1
XfLCXfLtCtg
n
i
iii 

（4-20）
4.3.2 近鄰寬度 k的確定
本文採用 GCV 法確定近鄰寬度 k。對於最小二乘近鄰估計，不論是 k 近鄰權，是線性
近鄰權，還是平方近鄰權，其估計是集中在 kt 附近一個鄰域的樣本的加權平均，k正好是
這個鄰域的寬度。因此，在近鄰估計中，k 的取值範圍不會超過樣本量的大小，故可定 n,1
為 k 的搜索空間。計算步驟如下：
（1） 取 i=1， )0(X 為初始值， 11k 為初始近鄰寬度；
（2） 計算 0/)( XXXf  ；
（3）計算近鄰權陣 C；
（4） 計算 )()()( CIPCICP Ti  ；
（5） 取 )()( i
i CP  為第 i行元素為 0 ,其餘行同的矩陣 )( iCP ；
（6） 按式（5-19）計算dX ，進而得 )(ˆ iX  ；
（7） 計算 )( iV  ， ])ˆ()[( )()( LXfCIV ii   ；
（8） 計算 )()( )( iTi PVV  ;
（9） i=i+1，若 ni ， ik i  ，轉（3）；否則轉（10）；
（10） 取 )()( )( iTi PVV  中的最小值對應的 k。
§4.4 非線性半參數模型的樣條估計
4.4.1 估計的基本公式
多項式插值的 Runge 現象和數值計算都表明高次多項式用於插值存在不穩定問題，
故一般只採用一次、二次多項式，最多用三次多項式。分段插值可提高插值精度，但又
出現了光滑問題，這樣就導致了三次頋米特多項式插值，在分段點上連續且一階可導。
為了進一步提高光滑性，又提出了具有二階可導的樣條插值。有關文獻已證明三次自然
樣條是最光滑的曲線。本研究採用的樣條即為三次自然樣條。
68
)(P 為對稱正定陣，將其作平方根分解得 MMP T)( ，再對 MB 進行 QR 分解得：
  QRRNQMB T  0)( ，有 1RdX ， MlQT ，則上式可化為：
  GMlNRRdX TT )(11   （4-30）
 UMNG T ，為非線性模型的固有曲率立體陣。
4.4.3 取至二次項的非線性直接解法
將非線性法方程組中的 0/)( XXXf  和 )ˆ(Xf 分別在近似值
0X 處 Taylor 級數展開，並
取至二次項，代入（4-26）式，並忽略掉
kji XXX
Xf

 )(3
項得：
    2/)()()())(()())(( 11 dXWPBdXdXWBdXPlPNlPBNdX TTTT    （4-31）
令 BPBN T )()(  得：
 
  2/)())(()())())(((
)())(()()())(()())((
11
111
lPBNWPBlPBN
lPBNWBdXPlPNlPBNdX
TTTT
TTT






（4-32）
4.4.4 光滑參數的確定
GCV 法的思想已有敍述，對於半參數模型樣條估計，由於光滑參數不象最小二乘核估
計中的窗寬和近鄰估計中的近鄰寬度那樣具有非常明確的意義，因此的搜索空間和搜
索步長的確定很困難，目前一般還是基於經驗。一般是人工干預電腦的搜索過程，主要
體認在根據經驗調整光滑參數的初始值、搜索步長和搜索範圍。搜索步驟為：
（1） 給定的初始值和搜索步長；
（2） i=1,計算 )(XJ 、 )(gJ ，令它們其第 i 行為 0 得 )()( iXJ  和 )()( iXJ  ，計算
LJX iX
i )(ˆ )()(   ，再計算 LJg igi )(ˆ )()(   ；
（3） 用計算得到的
)()(
1
)(
1
)(
1 ˆ,,ˆ,ˆ,,ˆ
i
n
i
i
i
i
i gggg 


  內插出 it 點的非參數分量估值
)(ˆ iig
 ；
（4） 用 )(ˆ iig
 計算 it 對應的觀測值的估值
)()()( ˆˆˆ ii
ii
i gXBL
  ；
（5） i=i+1，轉（2）；
（6） 計算 


n
i
i
iii LLPCV
1
2)( )()( ；
（7） 迴圈，求得使 GCV 最小的；
（8） 若存在多個使 GCV 最小，計算半參數模型樣條估計的殘差，看殘差圖，選擇使
殘差圖最接近常態的，因為在相當寬的條件下，許多個獨立隨機變數之和近似
70
BPBT )( 可逆，令 BPBN T )()(  ，方程（4-38）有唯一解：
  2/][)]([))(()())((ˆ 1111 PlBNWPBPlBNNlPBNXd TTTTT    （4-39）
未知參數的分塊多項式估值為 XdXX M ˆˆ
0  。那麼相應的估計為：
))ˆ(())()((ˆ 1 LXftPt M
T
nn   （4-40）
進而得非參數分量的分塊多項式估值：
))ˆ(())()(){((ˆ)()(ˆ 1 LXftPttttg M
T
nn
T
n
T
nM   （4-41）
4.5.2 三角級數估計
設模型為（4-1），取：








122sin2)(
22cos2)(
1)(1
kjktt
kjktt
t
j
j



則  j 構成  1,02L 的一組基底，令：
 
  Tnni
T
tt
ttt

 


)()(
)()()( 1


先設 X為已知，求下述極小問題：

 RaaXfL
T  min)(
2
的解， ))((ˆ XfLCa   ，相應的 )(tg 的估計為：
))(()()(ˆ)(),(ˆ 1 XfLtatXtg TTTT   
然後再求極小：
min)))(()()()(()),(ˆ)((
1
21
1
2  



n
i
TTT
ii
n
i
ii XfLtXfLXtgXfL 
此為一非線性方程組，可得：
  2/][)]([))(()())((ˆ 1111 PlBNWPBPlBNNlPBNXd TTTTT   
未知參數的三角級數估值為 XdXX ˆˆ 0  。那麼相應的估計為：
))ˆ(())()((ˆ 1 LXftPt T    （4-42）
進而得非參數分量的分塊多項式估值：
))ˆ(())()()((ˆ)()(ˆ 1 LXftPttttg TTn
T     （4-43）
72
iiii tgXfL   )()( （4-51）
上式為一標準的非參數模型，按非參數模型的估計方法，可得 )(tg 的估計 )(tg 。以核
權函數為例得：


 
n
i
iii XfLtWtg
1
))()(()( （4-52）
將所得的 )(tg 的估計 )(tg 回代，求下列極小問題：
  min)(ˆ)( 2
1



n
i
ii tgXfL （4-53）
的解，所得 X 的第二階段的估值 Xˆ 即為所求。
§4.6 算例與比較
為了檢驗非線性半參數模型的估計方法的有效性，在此採用實測資料計算得到的衛
星座標和假定的測站座標 51282732004404()( TZYX T)3208706 ，加類比系統
誤差，按偽距模型反算偽距觀測值，採用單點偽距定位，建立非線性半參數模型形式，
樣本量 n=48， )( ZYXX  為未知參數，g 代表觀測值中的系統誤差向量，取三種模
擬系統誤差形式如下： )4/sin(*32)(1 ttg  ， )6sin(*)2sin(*3*2)(2 ttttg  ，
)4/cos(/47.2)(3 ttg  。為模擬的觀測雜訊向量， 1.00  。分離出的系統誤差與模
擬的系統誤差對比見圖
圖 4-1 g1 核估計 圖 4-2 g2 核估計
圖 4-3 g3 核估計 圖 4-4 g1 線性近鄰估計
74
Z 3208705.9334 3208705.9376 3208705.9260
X -2004403.9787 -2004403.9783 -2004403.9789
Y 5128272.9724 5128272.9734 5128272.9730樣條
Z 3208705.9206 3208705.9207 3208705.9222
4-1、4-2 到 4-12，它們分別對應於核估計、線性近鄰估計、平方近鄰估計和樣條估計，
由圖可知，對於非線性模型，採用前述的估計方法，能有效地分離出系統誤差。左圖的
粗實線代表半參數估計的系統誤差，細實線代表系統誤差模擬值，右圖的粗實線代表半
參數模型估計的殘差，細實線代表忽略系統誤差採用參數模型最小二乘估計得到的殘
差，呈明顯的系統性。未知參數的估計結果如表 4-1 所示可見，對於非線性半參數模型，
採用所述的估計方法，能有效地估計出未知參數，估值與模擬真值的差異均在釐米級。
§4.7 非線性半參數模型最小二乘估計的統計性質
4.7.1 正則條件
要研究非線性最小二乘估計量的統計性質，需要相當繁重的正則條件。在假定為
同精度獨立正態隨機誤差的前提下，把條件予以放寬。以非線性半參數模型的最小二乘
核估計為例，推導該估計的統計性質，其他最小二乘類估計的統計性質同理可得。
條件（1）在（5-1）式中，假設非線性函數 )(Xf 是緊集 x 上關於 X 的連續函數，隨機
誤差向量 N~ ),0( 2I ，參數的真值記為 X~ ，它是 x 的內點。
條件（2）當 n 時，函數 nXfXfXX
n
i
iin /))
~
()(()
~
,(
1
2



 

 在 x × x 上一致收
斂到 )~,( XX 。且 )~,( XX 在 X 上存在唯一的極小值點。
條件（3） )(Xf i 在 x 上關於 X 存在一階連續導數，且在 X
~
的某個領域內有：
  )(/)()(lim XRnWBBWBB T
n


，式中： )(XR 為正定矩陣, W為核權。
條件（4） )(Xf i 在 x 上關於 X 存在二階連續導數，且在 X
~
的某個鄰域內有
)()(
1
lim
1
2
2
XE
XX
f
n ij
n
i ji
i
n




。
條件（5）假定 )(Xf i 在 x 上存在三階連續導數，且下列有關導數的極限存在：






)(
1
lim
1
2
XE
XX
f
X
f
n ijk
n
i kj
i
i
i
n
， 



)()(
1
lim
1
2
3
XG
XXX
f
n
n
i
ijk
kji
i
n
。
76
Part 5 應用非線性半參數模型處理系統誤差
§5.1 系統誤差概述
自 Guass1794 年創立最小二乘法以來，測量資料處理理論和方法得到了充分的發展，
這種發展大致可分為兩個階段，以電子電腦的廣泛使用為分界：在第一階段，由於計算
手段的限制，研究主要集中在減少計算工作量的資料處理方法上，出現了 Schreiber 提
出的在解演算法方程前消去一些未知數和合併一些誤差方程式的 Schreiber 法則、
Krueger 提出的將條件方程分組解算的分組平差法以及 Hermert 分區平差法等。第二階
段，由於電腦技術的飛速發展，矩陣代數、泛函分析、最優化理論和數理統計等數學理
論在測量資料處理中的廣泛應用，其研究主要集中在新理論和新方法上，測量資料處理
理論和方法都發生了巨大的變化。
現代測量資料處理中研究的誤差主要有：偶然誤差、系統誤差和粗差。傳統上對測
量問題通常只分析其偶然誤差，而忽略了其他誤差。現代測量資料處理的研究，除了計
算方法的繼續完善之外，更主要的是追求理論上的完善，因此相繼提出了將粗差、系統
誤差納入模型進行處理的一系列的理論。經典意義下的系統誤差和粗差實際上都是模型
誤差的一種。模型誤差定義為所建立的數學模型與客觀現實之間的差異，是現代資料處
理理論中的術語，是現代統計學在測量資料處理理論應用中的產物。模型誤差又包括隨
機模型誤差和函數模型誤差。隨機模型誤差又包括方差和協方差不準確引起的誤差等，
可用隨機模型的驗後估計解決。
在相同的觀測條件下，若誤差在大小、符號上表現出系統性，或在觀測過程中按一
定的規律變化，或為某一常數，則為系統誤差。系統誤差可進一步分為恒值系統誤差和
變值系統誤差。恒值系統誤差是指在相同的測量條件下，誤差的大小和符號保持不變。
變值系統誤差是指在相同的測量條件下，誤差的數值按某一確定的規律變化的誤差。變
值系統誤差按變化規律還可分為線性系統誤差、週期性系統誤差和複雜規律系統誤差。
系統誤差既有系統性，又有隨機性，很難從環境上完全找到系統性原因加以排除。系統
誤差對觀測結果的影響一般具有累積作用，對成果質量的影響也特別顯著，如果忽略系
統誤差，平差結果將是有偏的。
Guass 創立最小二乘法時，假設觀測誤差服從常態分佈，算術平均值為最或然值。後
來 Guass 為了使最小二乘理論建立在更穩固的基礎之上，放棄了算術平均值為最或然值
和觀測誤差服從常態分佈的假定，證明了只要觀測誤差各分量獨立，誤差中數為 0，方差
78
附加系統參數 S的選擇有兩種情況：
一種是顧及系統誤差特點的附加參數，如三角高程平差中的折光係數，測邊網平差
中的尺度比未知數，衛星多譜勒定位中的頻偏、時延等未知數。另一種是多項式型的附
加參數，如一般多項式、正形多項式、球諧函數中的係數作附加參數。對於附加的參數
又有兩種處理方法：一種是把附加參數看作非隨機參數，按通常的參數平差方法一併解
出 Xˆ 和 Sˆ 。另一種處理方法是把附加參數看作隨機畸變，如一個具有各態歷經性的平穩
隨機函數，按最小二乘配置法一併解出 Xˆ 和 Sˆ 。
對於用附加系統參數平差法處理系統誤差，難點是附加參數的選擇和處理。因為在
附加系統參數的平差中，補償系統誤差的完整性與解的穩定性之間往往是矛盾的。為了
盡可能全面地補償系統誤差，則要求模型中附加參數個數要多，但這又常常造成過度參
數化，使法方程係數狀態變壞，解的精度惡化。在選擇系統參數時一般用統計檢驗方法
來選擇附加參數。一方面是系統誤差參數的顯著性檢驗(當參數間正交或接近正交時，一
般採用一維 t 檢驗，逐一對參數進行顯著性檢驗)；另一方面是系統參數的相關性檢驗。
若選取的參數間或參數與原觀測量之間有較強的相關性，可能導致法方程病態，從而得
到錯誤的估計，故要進行相關性檢驗，以確定參數的選取是否適當，一般用兩者的相關
係數來反映，在給定的置信度下進行檢驗。但這種檢驗的方法存在著不足，一是計算量
大，二是難以保證在剔除了若干附加參數後模型對系統誤差補償的完整性。將附加參數
或全部參數視為隨機量按參數加權平差或最小二乘配置法估計基本參數和附加參數是一
種改進措施，但這種方法中權比的確定是一個難題。
即使附加參數處理成隨機參數，在幾何條件很弱時，仍可能出現附加參數的過度參
數化，其精度仍可能低於不帶附加參數的平差結果。這可能是附加參數 S 與基本參數 X
間的強相關造成的。解決辦法是將 X也視為隨機參數，S 視為具有各態歷經性的平穩隨機
過程，用具有兩類隨機參數的平差方法處理。此時隨機模型為：
T
S
T
XL
S
X
XS
X
BBAA
X
n
n
n








0
0
0
)cov(
上述方法從隨機模型看都要求已知信號 S的協方差陣 Σs，這些協方差陣中的元素是根據
協方差函數計算的，因為我們假定信號是具有各態歷經性的平穩隨機函數，正因為是具
80
§5.2 GPS 定位中的系統誤差
用非線性半參模型來處理測量中非線性函數模型涉及的系統誤差，以 GPS 定位為例，
GPS 測量的原始觀測量是衛星信號的碼相位觀測值和載波相位觀測值，以及信號傳播的時
間延遲量。觀測值中往往含有大量的系統誤差如軌道誤差、GPS 接收機鍾差、衛星鍾差、
電離層延遲誤差、對流層延遲誤差和多路徑誤差等，其中電離層延遲誤差、對流層延遲
誤差和多路徑誤差是平差中討論最多的系統誤差。
對流層是高度為 40公里以下的大氣層。由於其離地面近，所以大氣密度較電離層大，
且大氣狀態隨地面氣候的變化而變化。當電磁波通過對流層時，傳播速度會發生變化，
從而引起傳播延遲，稱為對流層延遲誤差。天頂方向的對流層延遲影響約為 2.3 米，而
仰角 E 為 10o時，傳播延遲影響將增大到約 13 米。目前採用的對流層延遲的改正模型較
多，應用較廣泛的主要是 Hopfield 模型和 Blank 公式。
電離層是高度位於 50—1000 公里之間的大氣層。由於太陽的強輻射，電離層中的部
分氣體分子被電離而形成大量的自由電子和正離子。當電磁波信號穿過電離層時，傳播
速度會發生變化，所以信號傳播時間乘以其在真空中的傳播速度，不等於信號的實際傳
播距離，從而引起測距誤差，此誤差稱位電離層誤差。電離層延遲誤差取決於電子總量 N
Σ和信號頻率 f。計算電離層延遲誤差的主要困難在於電子總量的複雜性，它隨多種因素
而變化，很難正確地確定。首先，電子總量隨地方時變化。由於大氣所吸收的太陽能和
地方時有密切的關係，所以電子總量也將隨地方時變化而變化，一般呈現如下規律：電
子總量隨地方時作周日變化，白天大於夜晚，所以白天電離層延遲誤差大，夜晚小。峰
值約在地方時 14 時，此時電離層的延遲誤差最大。在夜晚（地方時 0-6 時，20-24 時）
的電子總量變化小，可當作常數，在白天（6-20 時）電子總量的變化可近似看作餘弦波。
其次，電子總量隨太陽活動而變化。太陽活動強烈的年份較平穩年份的電離層電子總量，
可相差 4 倍左右。另外電子總量還隨季節變化而作周年變化。可見，電子總量與多種因
素有關，到目前為止尚未完全弄清楚每一種因素是通過什麼方式來影響電子總量，無法
用一個嚴格的模型來描述其變化規律。
對 C/A 碼單頻接受機，其電離層延遲改正方法有兩種：一種是採用相對定位或差分
定位的方法，一種是用模型進行改正。當兩站相距不遠時，兩站觀測同一衛星的電離層
延遲誤差可認為基本相同，因此通過相對定位或差分定位可基本消除電離層延遲誤差。
常用的改正電離層延遲誤差的模型有兩種：一是直接採用導航電文所提供的電離層延遲
改正值 Tgd。此值是衛星在天頂方向的電離層延遲改正，實際觀測方向的改正數，需要由
82
難以同時滿足。常用的線性組合有寬巷觀測值、窄巷觀測值和無電離層延遲的組合觀測
值。寬巷觀測值的波長達 86 釐米，很容易準確地確定其整周模糊度，但測量雜訊大；而
窄巷觀測值測量雜訊雖小，整周模糊度又很難確定；至於無電離層延遲的線性組合，雖
然電離層延遲為 0，但由於組合係數不是整數，使其模糊度不再具有整數特性。對寬巷和
窄巷觀測值，這種組合只能消除電離層延遲系統誤差中的一次項，組合觀測值中仍然含
有高階誤差項，可達幾個釐米。
對單頻用戶而言，使用電離層模型改正後，可能殘留的誤差超過 10 釐米；用現有的
對流層模型改正後，可能殘留幾釐米-幾分米的誤差；儘管現在已有許多削弱多路徑誤差
的方法，但可靠而實用的削弱多路徑誤差的方法仍有待進一步研究。
在半參數模型中，待估計的變數包括一個參數部分和一個非參數部分，通常我們對
參數分量感興趣。非參數分量可以是一個函數或多個函數的組合，一般假定函數是光滑
的（事實上，GPS 定位中大多數系統誤差是隨時間光滑變動的）。函數中的局部的突變（或
高頻項）認為是 0 均值隨機雜訊。半參數模型中的參數分量對應於站點座標和單個雙頻
GPS 接收機觀測序列的整周模糊度，而光滑部分則可用來大致描述含系統誤差的觀測序
列，如多路徑誤差、電離層殘差、對流層殘差。採用半參數模型來處理 GPS 定位資料，
是削弱系統誤差的一種新的解決方案。GPS 中的系統誤差往往隨時間平滑地變化，在半參
數模型中，這些誤差被描述為複雜而光滑的函數。採用半參數模型的估計方法，可同時
估計函數和其他參數(例如站座標)。
由於 GPS 定位中的函數模型均為非線性模型，採用一次近似線性化的線性形式，對
於非線性強度較強的模型，非參數部分還應包含非線性模型線性化產生的模型誤差，即
解算所提取的信號分量，除了包含系統誤差外，還包括非線性模型線性化產生的模型誤
差，以此來研究 GPS 定位中的系統誤差就很不準確，為了削弱非線性模型線性化產生的
模型誤差，引入用非線性半參數模型來處理含系統誤差的 GPS 定位資料的思想，所得的
系統誤差的估值就主要是測量過程中系統誤差的估值，而幾乎不再含有非線性模型線性
化帶來的模型誤差。
由於在 GPS 定位中，同一時刻的觀測值至少為 4 個，即同一時刻 tj有若干個相關或
不相關的觀測值 Lij，是一向量，對於單點偽距定位模型，j=1, …,m，對於相位雙差模型，
j=1, …,m-1，m 為曆元 i觀測到的有效衛星數，此時非線性向量半參數模型為：
 )()( tgXfL （5-3）
於是
84
文中的非線性半參數模型的估計方法，可得未知參數和非參數分量的估計式。
無論是核權函數估計、近鄰權函數估計，還是樣條估計，對於單點偽距定位模型，
觀測值權陣 P 可取 mnmn 階單位矩陣，而對於雙差模型，由於對不同的衛星的同步觀
測量所組成的雙差是相關的，相應的權陣為：



















)(0000
0000
00)(00
0000
0000)( 1
n
i
tP
tP
tP
P
，其中

















111
111
111
)(
m
m
m
tP i
此時 P可表示為 )( in tPIP  ， nI 為 n 階單位矩陣。
算例：採用載波相位相對定位，採樣間隔為 10秒，解算前剔除粗差，由廣播星曆計算衛
星在地心地固坐標系中的座標並恢復整周未知數。採用兩個測站 8 分鐘的同步觀測資料
進行處理，選擇的時段共 48 個曆元，觀測到 6顆衛星。 ni ,,2,1  ， mj ,,2,1  ，其
中 m 為衛星數,n 為曆元數， 6m ， jjj ZYX 、、 為衛星 j 的座標， jiD
~
為第 i 曆元
衛星 j 的偽距觀測值， jt 為衛星 j 的衛星鍾偏差，未知參數是座標（X Y Z）和接受機
鍾誤差 it。在 GPS 精密定位中最常用的是測站間與衛星間求雙差的定位模型，觀測方程
為：
)()()/()()()( 1212121212 i
pq
j
pq
j
q
j
p
j
pq tNtDcftdtdtd   （5-10）
))()(())()(()()()( 2212121212 j
q
j
q
j
p
j
p
j
q
j
p
j
pq tttttdtdtd  
))()(())()(()()()( 1212121212 i
q
i
q
i
p
i
p
i
q
i
p
i
pq tNtNtNtNtNtNtN  （5-11）
))()(())()(()()()( 1212121212 j
q
j
q
j
p
j
p
j
q
j
p
j
pq tDtDtDtDtDtDtD 
2
2
2
2
2
22 ))(())(())(()( ZtZYtYXtXtD j
p
j
p
j
p
j
p 
)()()( j
p
j
p
j
p tZtYtX 、、 為衛星 p 在 jt 時刻的座標，設為已知，以 1 號點為已知點進
行相對定位， 111 ZYX 、、 為已知座標，取測站 2 的偽距單點定位結果作 222 ,, ZYX 的近
似值 02
0
2
0
2 ,, ZYX ，考慮到為觀測方程為非線性的，其中必然存在殘餘的系統誤差，建立
非線性半參數模型為：
 gXfL )( （5-12）
L 為雙差觀測值向量， )( 1 nttZYXX   ,g 代表偽距定位的系統誤差，為隨機
誤差向量， nm 維，設測站點三維地心座標近似值為 000 ,, ZYX 。具體的非線性誤差
86
TpqdNdZdYdXX )( 12121212 為未知參數，採用顧及二次項的直接解法，得測站點坐
標的核估計、近鄰估計和樣條估計見表 5-1，圖 5-1 是採用參數雙差模型解算得到的各衛
星對的殘差估計值，由圖可看出它們具有明顯的系統性。圖 5-2、5-3 和 5-4 分別為核估
計、近鄰估計和樣條估計得到的雙差模型系統誤差圖。殘差呈正態分佈。
88
4．研究了非線性半參數模型的最小二乘估計問題，主要包括非線性半參數模型的參
數分量和非參數分量的估計公式以及參數分量估計的統計性質；導出了非線性半參數模
型顧及一次項的非線性直接解法、顧及二次項的非線性直接解法和基於 Guass-Newton 迭
代法的最小二乘核估計的估計式，證明了法方程係數陣非奇異，這是法方程有唯一最小
二乘解的基本條件，給出了採用 GCV 法確定核權函數估計窗寬時的搜索範圍、 t 等間隔
時的搜索步長以及具體的計算步驟；導出了非線性半參數模型的最小二乘近鄰估計顧及
二次項的非線性近似直接解法的估計式；導出了非線性半參數模型顧及一次項的非線性
直接解法和顧及二次項的非線性直接解法的樣條估計式；導出了非線性半參數模型的分
塊多項式估計、三角級數估計、小波估計式和兩階段估計顧及二次項的非線性直接解法
的估計式；證明了非線性半參數模型最小二乘核估計的參數分量估計的漸近常態性和有
偏性，這種漸近常態性和有偏性可推廣到非線性半參數模型的其他估計方法。本研究內
容初步形成了在最小二乘準則下非線性半參數模型估計理論和方法。
5．在研究系統誤差，尤其是 GPS 定位中的系統誤差的性質和處理方法的基礎上，基
於非線性模型的解算方法，提出了用非線性向量半參數模型解決 GPS 定位中系統誤差的
方案，並用類比和實測資料進行了檢驗。計算結果表明，用所推導的計算方法，可以提
取出絕大部分系統誤差，能有效地估計出未知參數，各估值與模擬真值的差異均在釐米
級。指明了非線性向量半參數模型估計估計相對於標量非線性半參數模型估計的主要區
別在於單個光滑參數被一組光滑參數所代替。對於權函數估計，表現在原模型的單個權
值為一個權陣所代替，而對樣條估計，是用 Kronecker 積代替原來的數乘運算來實現標
量到向量的擴展。
有待進一步研究的問題：
由於本研究是在前人非線性參數模型估計理論和線性半參數模型估計理論的基礎上
進行的，重點在於為形成一套最小二乘準則下非線性半參數模型估計理論和方法做一個
初步的理論研究，由於時間及人力等條件限制下午, 因此其他非最小二乘估計準則下非
線性半參數模型估計的構造及估計量統計性質的推求，非線性半參數模型參數分量無偏
估計的構造等許多問題均有待進一步研究，要形成較完善的非線性半參數模型估計理
論，還有很長的路要走，因為這不僅取決於非線性估計理論的進一步完善，還依賴於半
參數估計理論的深入發展。
90
models. J. Econometrics, 58, 71-120
[23] Simono®, J.S. and Tsai, C.L. (1999) Semiparametric and additive model selection using an im-proved
Akaike information criterion. Computational and Graphical Statistics, 8, 22-40
[24] Faddy, M.J. and Jones, M.C. (1998). Semiparametric smoothing for discrete data. Biometrika 85,
131-138
[25] Hodgson, Douglas J.,"Robust Semiparametric Estimation in the Presence of Heterogeneity of Unknown
Form", 1996
[26] Liu Liping and Eija Arjas,“A bayesian model for fatigue crack growth, Practical Nonparametric and
Semiparametric Bayesian Statistics”, Lecture Notes in Statistics 133, 339-353, 1998
[27] Chen, Hung ,"Asymptotically efficient estimation in semiparametric generalized linear models. ",Ann.
Statist. 23 (1995), no. 4, 1102--1129
[28] Chen, Hung; Chen, Keh-Wei ,"Selection of the splined variables and convergence rates in a partial spline
model. ",Canad. J. Statist. 19 (1991), no. 3, 323--339
[29] Chen, Hung; Shiau, Jyh-Jen Horng ,"A two-stage spline smoothing method for partially linear models.
",J. Statist. Plann. Inference 27 (1991), no. 2, 187--201
[30] Shiau, J.-J. H. and Wahba, G. (1988). "Rates of Convergence of Some Estimators for a Semiparametric
Model." Communications in Statistics, B17
[31] Beran, J., Ghosh, S. (1998) Root-n-consistent estimation in partial linear models with long-memory
errors. Scandinavian Journal of Statistics. Vol. 25, No. 2, 345-357
[32] Joel L. Horowitz, Semiparametric Estimation of a Proportional Hazard Model with Unobserved
Heterogeneity Econometrica, 1999, vol. 67, issue 5, pages 1001-1028
[33] Cui, H. and He, X. (1995). Consistency of semiparametric estimation of elliptic densities. Acta
Mathematica Sinica, new Series , vol. 11, 44-58
[34] He, X. and Kim, M. (2002). On Marginal Estimation in a Semiparametric Model for Longitudinal Data
with Time-independent Covariates. Metrika , vol. 55, 67-74
[35] He, X., Zhu, Z.Y. and Fung, W.K. (2002). Estimation in a Semiparametric Model for Longitudinal Data
with Unspecified Dependence Structure. Biometrika , vol. 89, No. 3, 579-590
[36] Fung, W.K., Zhu, Z.Y., Wei, B.C. and He, X. (2002). Influence diagnostics and outlier tests for
semiparametric models. Journal of the Royal Statistical Society, Series B , Vol. 64(3), 565-579
[37] Anton Schick,Comments. P. E. Greenwood , W. Wefelmeyer,(2001),Inference for semiparametric
models: Some questions and an answer ,Statistica Sinica, 11 (2001), 892-906
[38] Anton Schick,U. U. Mueller,W. Wefelmeyer,Plug-in estimators in semiparametric stochastic process
models. Selected Proceedings of the Symposium on Inference in Stochastic Processes (I.V. Basawa, C.C.
Heyde and R.L. Taylor, eds). IMS Lecture Notes-Monograph Series, 37 (2001), 213-234
[39] Anton Schick,Efficient estimation in a semiparametric additive autoregressive model. Statistical
Inference for Stochastic Processes, 2 (1999), 69-98
[40] Anton Schick, Efficient estimation of invariant distributions of some semiparametric Markov chain
models. (With W. Wefelmeyer.) Mathematical Methods of Statistics, 8 (1999), 426-440
[41] Anton Schick,Efficient estimation in a semiparametric additive regression model with ARMA errors. In
Asymptotics, Nonparametrics, and Time Series, S. Ghosh ed. (1999), 395-425
[42 ]Anton Schick, Root-n consistent and efficient estimation in semiparametric additive regression models.
Statistics and Probability Letters, 30 (1996), 45-51
[43] Anton Schick,Efficient estimation in a semiparametric additive regression model with autoregressive
errors. Stochastic Processes and their Applications, 61 (1996), 339-361
[44] Anton Schick, Asymptotically uniformly most powerful tests in parametric and semiparametric models.
(With S. Choi and W.J. Hall.) Annals of Statistics, 24 (1996), 841-861
[45] Anton Schick, On asymptotically efficient estimation in semiparametric models. Annals of Statistics, 14
