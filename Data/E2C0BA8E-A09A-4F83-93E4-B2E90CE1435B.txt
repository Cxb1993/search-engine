 
中 文 摘 要 ： 本計畫根據太陽能以及風力發電系統的應用規格，訂出最大
功率追蹤晶片的各項參數以及可調整範圍於 Simulink 建立系
統實驗平台。透過分析並研讀以擾動觀察髮為基礎設計之最
大功率追蹤電路其平行化之架構以及適用於高速系統之平行
化以及管線化設計，本計畫所設計之折疊式省面積之太陽能
MPPT 晶片於第二年順利設計完成，獲 ISC2010 最佳論文以及
100 年國家晶片中心優良晶片佳作。最後，本計劃設計並實
現高效率能源擷取之全數位型太陽能/風力多模最大功率追蹤
晶片製作晶片(折疊式太陽能/風力雙模晶片設計，獲台塑應
用研討會績優論文獎)，完成折疊式太陽能/風力雙模晶片於
Simulink 平台進行系統效能實測，獲 2011 MATLAB & 
Simulink 論文比賽優選獎)。ADC 晶片部分，完成六位元時域
型類比數位轉換器，並以電壓控制震盪器驅動之；完成以時
間數位轉換器為主的微調控制器設計，並整合時域型類比數
位轉換器，達成十二位元解析度；完成設計一鋸齒波校正電
路，並克服 TTFFSS corners 與溫度變異造成的誤差。在太陽
能發電系統部分，本計畫中的直流-直流轉換器主要功能是將
太陽能板之電能藉由直流-直流轉換器供應給電池組，以提供
太陽能發電系統之直流-交流換流器，達到市電併聯供電的目
的。最大功率追蹤器部分，本計畫將採用擾動與觀察法實現
MPPT，並做過壓、過流及過溫保護。備用電源供應器方面，
採用返馳式轉換器，利用 PWM IC 控制，達到有效管理備用電
源轉換器的功率。風力發電系統部分，本計畫所設計的轉換
器已成功應用於長庚大學戶外 1.5kW 風力發電機中，並實際
運轉；本計畫所設計之 PWM 整流器可成功抑制風力發電機的
電流諧波，降低機電共振噪音；本研究採用 d-q 座標軸電流
解耦控制技術完成市電側功因校正及有效功率控制；本研究
將用直接查表法及模糊控制法則完成風力發電系統之最大功
率追蹤。 
中文關鍵詞： 風力、太陽能、發電系統、多模、節能、最大功率追蹤、晶
片 
英 文 摘 要 ：  
英文關鍵詞：  
 
 計畫目的: 
子計畫一： 
我們以太陽能發電系統與風力發電系統為主要研究對象，希望透過全數位型太陽能/風力
多模最大功率追蹤晶片之實現來提升太陽能板與風力系統的發電效能。 
子計畫二： 
 本子計畫將提出時域型類比數位轉換器，負責提供把電壓轉換成數位訊號。為了解決類比
數位轉換器的電壓解析瓶頸，本研究採用時域訊號轉換之架構，利用三角波或鋸齒波截取輸入
訊號的準位，轉換成不同大小的波寬，再以計數器計算得到的數位碼。 
子計畫三： 
 本計畫所提之「1.5kW太陽能發電系統之電能轉換器研製」，主要研究涵蓋三個項目：直
流-直流轉換器設計、最大功率追蹤器及備用電源供應器。在本研究內容中，主要針對設計昇
壓轉換及返馳式轉換器進行探討，並提出一高效率、低成本之轉換器。 
子計畫四： 
設計一組應用於1.5kW風力發電系統之高功因、低諧波污染的脈波寬度調變型整流器及市
電併聯型變流器。 
預期完成的工作項目及成果: 
子計畫一： 
 根據太陽能以及風力發電系統的應用規格，訂出最大功率追蹤晶片的各項參數以及可調
整範圍(規格由子計畫四協助提供，於 Simulink 建立系統實驗平台-於第一年順利完成) 
 分析並研讀以擾動觀察髮為基礎設計之最大功率追蹤電路其平行化之架構以及適用於
高速系統之平行化以及管線化設計(折疊式省面積之太陽能MPPT晶片於第二年順利設
計完成，獲 ISC2010 最佳論文以及 100 年國家晶片中心優良晶片佳作) 
 設計並實現高效率能源擷取之全數位型太陽能/風力多模最大功率追蹤晶片製作晶片
(折疊式太陽能/風力雙模晶片於第三年順利完成設計，獲台塑應用研討會績優論文獎 
 進行太陽能與風力發電系統整合與實測 (折疊式太陽能/風力雙模晶片於 Simulink 平台
進行系統效能實測於第三年順利完成，獲 2011 MATLAB & Simulink 論文比賽優選獎) 
子計畫二： 
項目(1)：預期設計一類比數位轉換器，並整合電壓控制震盪器。 
  成果(1)：完成六位元時域型類比數位轉換器，並以電壓控制震盪器驅動之。 
項目(2)：預期設計一微調控制架構以提高整體 ADC 的解析度。 
成果(2)：完成以時間數位轉換器為主的微調控制器設計，並整合時域型類比數位轉換 
器，達成十二位元解析度。 
項目(3)：預期設計校正電路，解決晶片在不同製程溫度變異之下的穩定性與精確度。 
成果(3)：完成設計一鋸齒波校正電路，並克服 TTFFSS corners與溫度變異造成的誤差。 
 3. I-Chyn Wey, Chien-Chang Peng, Yu-Jiang Liao, and Yu-Sheng Yang, “A Precise Power 
Supply Noise Detector with High-Linearity,＂ in Proc. of Workshop on Design, Analysis and 
Tools for Integrated Circuits and Systems, Hong-Kong, China, Mar. 2011. 
4. I-Chyn Wey and Chun-Chien Wang, “Low-Error and Hardware-Efficient Fixed-Width 
Multiplier by Using the Dual-Group Minor Input Correction Vector to Lower Input Correction 
Vector Compensation Error,＂ accepted in IEEE Transactions on Very Large Scale Integration 
Systems, 2011. 
5. 魏一勤, 楊詠順, “低硬體成本之風力-太陽能雙模發電系統全數位折疊式最大功率追蹤
晶片設計與實現,＂ 第八屆台塑應用技術研討會, 桃園, 台灣, 6 月 2011. (績優論文獎) 
6. I-Fu Tang, Shao-Ku Kao, “A time-to-digital converter using a multi-phase voltage-controlled 
 oscillator＂, in Proc. IEEE International Conference of Electron Devices and Solid-State 
 Circuits (EDSSC), 15-17 Dec. 2010. 
7. 曾聖有、吳盈至、劉勳諭, “具昇壓型緩震電路之交錯式昇壓轉換器應用於太陽能發電系
統,＂ 第八屆電力電子研討會, 2009, pp. 1564-1569. 
8. 曾聖有、莊舜安, “軟切換多模組輸出之輔助電源應用於 48V 輸入電源系統,＂ 第八屆電
力電子研討會, 2009, pp. 184-189. 
9. 曾聖有、呂健瑋， ＂高昇壓比轉換器之電池放電系統＂，第三十一屆電力工程研討會， 
2010, pp. 459-463. 
10. S.-Y. Tseng, C.-L. Ou, S. –T. Peng and J. –D. Lee, “Interleaved Coupled-inductor Boost 
Converter with Boost Type Snubber, ＂ Proceedings of ECCE, 2009, PP. 1860-1867. 
11. Geeng-Kwei Chang, Shu-Yuan Fan and Sheng-Yu Tseng, “Multi-output Auxiliary Power 
Supply with Lossless Snubber,＂ proceedings of IEEE Conference on Industrial Electronics 
and Applications, 2011, pp. 2172-2178. 
12. Woei-Luen Chen, Jen-Feng Li, and Bo-Xiang Huang,“Design of an Energy-Saving Charge 
Equalization System,＂  Electric Power Components and Systems, vol. 39, no. 15, pp. 
1632-1646, 2011. 
13. Woei-Luen Chen and Yu-Huang Lin,“A systematic approach to synthesize a STATCOM 
controller using eigenstructure assignment,＂ Electric Power Components and Systems, vol. 39, 
no. 15, pp. 1632-1646, 2011. 
14. Woei-Luen Chen, Yi-Guan Huang and Chun-Hao Pien,“Control and performance analysis for 
a capacitor coordinated STATCOM to enhance dynamic compensation capability,＂ Electric 
Power Components and Systems, vol. 39, no. 10, pp. 991-1006, 2011. 
15. Woei-Luen Chen, Zheng-Cong Li, and Bo-Xiang Huang,“Control and performance 
identification for small vertical axis wind turbines,＂ IET Renewable Power Generation 
Conference, Sept. 2011. (Edinburgh, UK) 
16. Woei-Luen Chen, Zheng-Cong Li, and Cheng-Zhang Xie,“Control of STATCOM with 
Supplementary Damping Enhancement for Wind Farm Voltage Regulation＂, IET Generation, 
Transmission & Distribution, 2011. (in press) 
 主要創新技術 
子計畫一： 
應用於太陽能發電系統之全數位折疊式省面積低功率最大功率追蹤晶片(ISC2010 會議最佳
論文獎、2011 國家晶片中心年度優良晶片佳作獎) 
本晶片中，我們透過全數位型太陽能最大功率追蹤晶片之實現來提升太陽能板系統的發電效能。最大功率
追蹤演算法是決定太陽能擷取效能的關鍵技術，透過晶片實現，可大幅提升最大功率追蹤演算法的效能，
透過折疊式設計則可大幅降低晶片成本，以 ASIC 可較 DSP、FPGA 和微控制器減少功率以及硬體消耗。
本晶片經由 folding 技術後，晶片面積減少 77％與功率消耗減少 70%，其發電效率為 97.9%。(本晶片已完
成晶片實測。在系統整合方面，可搭配 Simulink 進行系統模擬，支援不同太陽能板系統規格。) 
                晶片照相圖                                   晶片規格表 
 
低硬體成本之風力-太陽能雙模發電系統全數位折疊式最大功率追蹤晶片設計與實現 (2011 
MATLAB/Simulink 論文競賽 優選獎、第九屆台塑企業應用技術研討會 績優論文獎) 
本設計提出應用於風力-太陽能雙模發電系統之最大功率追蹤(MPPT)晶片，可同時支援 2 種再生能源發
電。MPPT 演算法，風力採用直接查表法、太陽能採取增益調適型擾動觀察法，能改善傳統擾動觀察法發
電效率較差的問題。電路方面透過折疊式技術，共用電路中相同運算單元，能夠在不影響系統效能的需求
下，縮小硬體面積達 39%，節省功率消耗達 38%。此晶片實現於 TSMC0.18μm 製程，晶片面積
0.87mm*0.88mm，發電效率可達 97.75%。(目前本子計畫最新設計已可支援重組/多模/多規格之設計) 
 
 
 
 
 
 
 
    太陽能風力雙模發電系統架構                        太陽能風力雙模 MPPT 電路使用 Folding 改善架構圖 
850.0um
79
0.
0u
m
Mux and Dmux
Multiplication
Register
Division
Subtraction
PWM50K
PWM100K
 由於鋸齒波(Ramp)對製程敏感，必須加上校正電路以避免製程變異導致日後晶片量測上
的誤差。經由電路模擬，在 TTFFSS 等不同參數下所得到的鋸齒波電壓最大(FF)與最小(SS)
可能相差近兩倍；當加入如圖 2 之校正機制，三組不同參數所獲得的鋸齒波幾乎相同，誤差
小於 5mV，可限制讓粗調控制器的最大誤差( INL )小於 0.16 個 LSB。 
子計畫三： 
1. 本研究採用電流控制之方式來追蹤太陽能最大功率點，所提之設計基本上是採用擾動與觀
察法的追蹤方式，搭配電流控制法則。採用本研究之控制器控制之太陽能光電板，不需要
如傳統擾動與觀察法估算功率，只需偵測太陽能光電板的輸出電壓，可以簡化控制電路。 
2. 本研究提出具昇壓型緩震電路之交錯式昇壓轉換器架構應用於太陽能發電系統。所提轉換
器分別採用緩震電路及交錯式操作方法，來提高轉換器的轉換效率及功率處理能力。本設
計可使開關在導通轉態時達到零電壓切換特性，也可在截止轉態時達到零電壓轉態特性，
經實驗證實交錯式昇壓型轉換器之緩震電路應用於太陽能發電系統，可提高整體效率 5%。 
3. 本研究提出多模組輸出返馳式轉換器當作系統的輔助電源。在此設計中，採用返馳式轉換
器結合一組無損耗緩震電路，來回收一次測漏感的能量，同時緩和開關截止轉態時的電壓
突波，以降低功率開關在截止轉態時汲極-源極間的電壓上升速度，達到降低開關截止轉
態的切換損失。比傳統硬切電路，所提輔助電源系統能夠在滿載時有效提高轉換效率 4%。 
 
▲圖 1 本研究採用電流控制方式之太陽能最大功率追蹤控制方塊圖實例 
 ▲圖 2 所提昇壓型緩震電路之交錯式昇壓轉換器電路圖 
       
▲圖 1.3模糊控制實現之最大功率追蹤控制器 ▲圖 1.4 模糊控制法之功率-轉速實測曲線 
無效功率控制及系統市電併聯之電力品質 
如圖 2.1 所示，本研究目的在於將 PCC 匯流排後之電力負載所需的無效功率成份，皆由
變流器提供，因此主電力系統只需提供有效功率，即可有效降低輸電損失。當系統存在電容
性無效功率負載，會使 PCC 如電容性般，含有正的無效功率成份，而控制器迴路會使無效電
流命令上升，使變流器呈現電感性模式，消耗負載之無效功率，若投入電感性負載，則會使
PCC 如電感性般，具有負的無效功率成份，控制器會使無效電流命令下降，使變流器呈現電
容性模式，提供負載之無效功率，可降低傳輸損失、提高電力系統的穩定及效率。由實驗可
驗證本研究之無效功率補償迴路，可使變流器補償負載的無效功率成份，且不論負載為電阻
性、電容性、電感性，都可以大幅改善主電力系統的功率因數。實驗結果整理於表 2.1。 
 
▲圖 2.1 耦合點之無效功率補償控制示意 
表 2.1 市電側無效功率控制器實驗結果 
 Before Compensation Power Factor 
After Compensation 
Power Factor Improvement 
Resistive Load 0.98 1.0 0.02 
Capacitive Load 0.86 1.0 0.14 
Inductive Load 0.9 1.0 0.1 
 
 
在功率因數(PF)方面，當轉換系統尚未啟動前，因受濾波器與線路電感、電容的無效功
率成份影響，會使風力發電機與市電系統之功率因數降低，如圖 2.2 所示，而當轉換系統啟
動後，經由切換式整流器與三相變流器的無效功率控制器，可改善市電側的功率因數(圖
2.3)。以電力品質分析儀量測系統的功率因數(PF)，可發現其的確操作在功率因數 1.0 附近。 
  
計畫架構(含樹狀圖)： 
 
系統架構圖 
  
子計畫一: 全數位型風力-太陽能多模節能及最大功率追蹤晶片之實現 
一、 子計畫一計畫內容簡介 
子計畫一所提之「最大功率點追蹤之晶片設計」以 Verilog 實現全數位型風力-太陽能多模的
單晶片控制轉換器，使太陽能與風力發電系統在任何工作環境下均可獲得最大功率輸出。在
太陽能電池方面，因太陽能的輸出特性隨著工作環境的照度及溫度變化，為獲得最大功率輸
出，本單晶片控制轉換器乃採用改良式擾動觀察法，即為增益調適型擾動觀察法[1]來設計，
並以折疊式技術進一步達到省面積低功率的效果。在風力方面，以直接查表法[2]來改善擾動
觀察法在追蹤過程中的缺失，直接查表法以架構簡單，功率追蹤速度快以及節省晶片成本的
優點，所以子計劃一在風力發電系統方面使用直接查表法為最大功率追蹤演算法。因為太陽
能發電系統容易受氣候以及雲層影響；子計畫一為了支援不同的氣候型態以及不同的發電系
統，最大功率追蹤演算法晶片必須具備多模運轉能力。然而，多模運算的最大功率追蹤晶片，
讓硬體使用效率可以大幅減少不必要的晶片功率消耗，且單一模組多功能的效用可降低硬體
成本，並且兼顧硬體高快速計算能力和低功率的優點。將太陽能與風力發電系統結合，達到
多模控制的目標。但是太陽能與風力系統的訊號特性不同，多模設計可根據太陽能的增益調
適型擾動觀察法與風力的查表法的特性，提升電能擷取效率。並且在搭配太陽能折疊式技術
[3]，將系統能整合成雙模的晶片，使得風力晶片在面積與功率消耗有所改進。此計畫分工範
圍如圖(一)所示。 
 
圖一、各子計畫分工範圍 
  
表一、擾動觀察法控制策略表[5]-[8] 
Case 系統狀態 控制策略 
1 0, 0dP dV   增加電壓變量 
2 0, 0dP dV   減少電壓變量 
3 0, 0dP dV   增加電壓變量 
4 0, 0dP dV   減少電壓變量 
目前風力發電使用的最大功率最蹤演算法是為擾動觀察法，因具有結構簡單，所需量測
參數較少的優點。此方法藉由週期性的擾動，觀察風力發電輸出功率變化作為控制依據，但
由於風速時常處於劇烈變化，不易穩定操作在最大功率點，追蹤效果不佳；直接查表法為記
錄風力發電機之最佳工作曲線，並以控制器控制風機轉速，可快速明確的得到參考轉速，有
較好的追蹤效果。 
研究方法說明 
(一) 太陽能以增益調適型擾動觀察法實現最大功追蹤晶片演算法設計 
1. 增益調適型擾動觀察法介紹[1] 
增益調適型擾動觀察法最大的特色就是使用擾動後的輸出功率對輸出電壓(P-V curve)斜
率(dp/dv)即時去調整最大功率追蹤控制器，同時藉由斜率的判斷來改善擾動觀察法有不當的
擾動以及電壓錯誤的問題，以太陽能板輸出功率與輸出電壓關係圖的最大功率點作為區分，
將曲線分為兩部份，即為圖(一)。可發現在電壓操作在離最大功率點越遠時，斜率絕對值越
大；當電壓操作再離最大功率點附近時，斜率絕對值越小；當電壓操作在最大功率點時，斜
率等於零。 
 
圖一、太陽能的功率-電壓特性曲線圖[1] 
  
 
圖三、增益調適型擾動觀察法流程圖[1] 
2. 太陽能發電系統之增益調適型擾動觀察法最大功率追蹤晶片電路設計 
2.1 電路硬體參數分析與設計： 
2.1.1演算法效能分析: 在高照度下增益調適型擾動觀察法與低增益和高增益擾動觀察法之
比較 
    本子計畫一以 MATLAB/Simulink 為基礎，建構出增益調適型擾動觀察法之架構，並在
高照度中進行太陽能發電系統效能測試。因特性曲線的斜率較為明顯，故高增益錯誤率明
顯降低，但擾動量較大且其響應時間較快，系統於最大功率追蹤時因擾動較大造成準確度
較低(1.02pu)，穩態誤差相對較大。增益調適型與低增益兩者都能準確達最大功率點，但
低增益所需追蹤時間較長(1.43 秒)會讓能量有所損耗；增益調適型在 0.1 秒即可達最大功
率點，其響應時間遠快於高增益 0.36 秒和低增益 1.43 秒，詳見表(二)與圖(四)。所以不論
傳統擾動觀察法(高增益與低增益)與增益調適型都能達到最大功率點的效果。但傳統擾動觀
  
 
圖五、發電效率、晶片面積與位元數關係圖 
2.1.3 以折疊式技術改善晶片面積與功率消耗： 
    本子計畫一以多工器、解多工器與暫存器來控制折疊式電路整體時序，並以計數器來
控制多工器與解多工器的開關，以達到我們所需共用運算單元的效果，本子計畫一加入暫
存器(D-Type FF)來達到訊號同步，避免不必要的 Latch 產生，讓整體面積與效能上有所提
升。增益調適型擾動觀察法使用折疊式技術能有效達到運算單元共用效果，減少晶片面積
與降低功率的消耗，圖(六)為增益調適型擾動觀察法折疊式技術架構圖。 
 
圖六、增益調適型擾動觀察法使用折疊式技術後之架構圖 
3. 晶片實現結果: 
3.1 FPGA 驗證： 
    本子計畫一透過 FPGA 驗證與 Simulink 模擬相互比較的結果，如圖(七)所示本系統之
  
 
圖八、高照度(1.0pu)與低照度(0.4pu)FPGA 功率、時間驗證圖 
3.2 佈局驗證 
    將本子計畫一所設計的折疊式增益調適型擾動觀察法，透過SOC Encounter配合TSMC 
0.18um製程建構出電路佈局完成益調適型擾動觀察法核心佈局圖，得到晶片規格如表
(四)，再經驗證 Post-layout Simulation(nanosim)與RTL 模擬一致，並且RTL與Simulink相
互驗證輸出與輸入，證實電路佈局正確無誤，並從FPGA以及晶片佈局驗證整理出表(三)，
使用折疊式技術的增益調適型擾動觀察法，改善功率消耗(77%)以及晶片面積(74%)。 
表三、功率消耗、面積與發電效率比較表 
MPPT 功率消耗 面積 發電效率 
Folding 前 
(12bits) 5.07mW 
0.80mm*0.84mm 
0.67 mm2 97.9% 
Folding 後 
(12bits) 1.14mW 
0.44mm*0.38mm 
0.17mm2 97.9% 
Folding 後 
改善幅度 70% 74% 
1.0pu(97.9%) 
0.4pu(97.5%) 
  
 
圖九、應用於太陽能發電系統之全數位折疊式省面積低功率最大功率追蹤晶片佈局圖 
 
圖十、折疊式最大功率追蹤頻率-電壓 shmoo 圖 
 
 
 
 
  
 
圖十一、風力發電機在不同風速之特性曲線與最佳運作曲線[11] 
    最佳運作曲線是風力發電機輸出之最大功率點的集合，由於戶外的環境風速是隨時改變
的，在此我們需使用最大功率追蹤演算法(Maximum power point tracker ,MPPT)實現在風力
發電，確保風力發電機在風速有變化的情況下，皆能在最佳運作曲線上運作，使風力發電機
轉速保持在最佳狀態，讓功率係數(Cp)保值在最大值，輸出最大功率。 
2.風力發電機之最大功率追蹤控制設計: 
2.1 直接查表法[2] 
    在擾動觀察法效果不理想的情況下，我們使用最佳運作曲線直接查表法作為我們的最大
功率追蹤架構。最佳運作曲線查表法優點為運算架構簡單，功率追蹤速度快，節省控制晶片
電路的硬體成本。在風速變化較大時，能準確操作於最大功率輸出，有較佳功率追蹤效率。
在此我們使用 MATLAB Simulink 模擬驗證，在此使用兩種風速 Vw=10m/s 與 Vw=7m/s 模擬
比較兩種最大功率追蹤驗證，在前 10 秒風速 7m/s，後 10 秒使用風速 10m/s，共計 20 秒，
功率追蹤結果如圖(十二)所示。 
  
風力發電機的 Vdc 三次方成正比，b 為經由觀察發電機最佳運作曲線所得的常數，其值為
0.00372。由於使用風機輸入功率直接運算目標電壓 *d cV 需要除以 b 在開立方根，如實現此
運算電路運算，會使電路變架構複雜，電路運算架構龐大，故我們先將風力發電機之最佳運
作曲線紀錄成一 Look-up table，降低演算電路複雜度，由輸入風機功率，即可直接輸出對應
電壓值，作為功率追蹤目標電壓。 
3
e dcP bV            (2.1) 
2.2 Lookup Table 電路位元數分析 
風力最大功率追蹤 Lookup Table 電路在晶片架構面積龐大，在經由 Design Compiler 合
成後分析不同位元數 Lookup Table 電路之面積大小，並且在 Matlab Simulink 觀察 Lookup 
Table 電路之輸入輸出位元數與發電效率的關係，選擇性降低輸入輸出位元數以降低其面積。
Lookup Table 電路輸入範圍為 0W~1500W，故輸入位元數由 11bit 開始分析，輸出位元數由
制定規格 12bit 開始分析，位元數與面積分析結果如圖(十四)所示，藍色曲線為輸入輸出位元
數與發電效率的關係，黑色曲線為輸入輸出位元數與所需電路面積的關係。 
 
 
圖十四、Lookup Table 輸入輸出位元數與發電效率、電路面積關係 
由圖(十四)結果紀錄於表(八)中觀察，在輸入位元數降低時，由於資料筆數減少，電路面
積會大幅下降，但發電效率小幅下降。反之，輸出位元數下降時，電路面積下降較不明顯，
發電效率下降幅度較大。可顯示其選擇位元數之電路效益，圖(十四)標明紅色部分選擇輸入
為 9bits 時電路，面積只須 10029μm2，其發電效率保持較高，為較佳的選擇，不會造成電路
面積的過度浪費。在考慮演算法發電效率為主的情況，我們選擇輸入 9bits 輸出 12bits 之查
  
表九  風力查表電路經動態範圍調整改善效果 
Table Power(μW) 面積 μm2 改善比率
風力查表電路 400.67 10029μm2 -- 
風力查表電路加入輸出值動態範圍調整 373.91 8835μm2 12% 
 
2.4 使用 MATLAB/Simulink 模擬驗證 
為了驗證直接查表法演算之正確性，我們使用 MATLAB/Simulink 作模擬驗證功率追蹤演
算法，並且探討晶片運算電路所需要的輸出與輸入端的規格，以便設計。計算出不同位元數
與最佳精準度(double)之間的誤差，分析直接查表法的效能、面積與功率消耗的關係，得到
在不同位元數在面積上相對應的發電效率，再經由結果來決定選擇位元數。 
圖(十六)為直接查表法在 Simulink 的架構，其中包含查表法架構的 Lookup Table、PI 控制器、
減法器，以及 Push-Pull Converter 與風力發電機之模型，來模擬風力發電機之架構。 
 
圖十六、直接查表法系統使用 MATLAB/Simulink 之架構圖 
    在此使用兩種風速 Vw=9m/s 與 Vw=7m/s 作高風速、中風速模擬最大功率追蹤驗證，在
前 10 秒使用高風速，後 10 秒使用中風速，共計 20 秒，功率追蹤結果如圖(十七)所示。在風
速上升與下降的情況，皆能快速準確的追蹤至最大功率點。 
  
(PWM)電路來啟動。PWM 電路如圖十九所示，由計數器、比較電路部份組成。當 PI 控制器
輸出與計數器比較。當 PIout 值大於計數器值時，PWM 輸出為 1，小於 0 時，則 PWM 輸出
為 0。在此輸入 clk 為 25MHz，當計數器從 0 數到 255，完成一筆 PWM 輸出。Push Pull 
Converter 兩組相同 Duty Cycle 相位相差 50%的 PWM 作控制，因此需要使用多工器作相位
轉換，產生兩組所需的 PWM。 
 
圖十九、PWM 電路架構圖 
3. 太陽能與風力最大功率追蹤電路整合: 
3.1 太陽能與風力最大功率追蹤電路整合與電路架構改良 
    在製作太陽能與風力雙模最大功率追蹤晶片，需將兩種最大功率追蹤演算法電路架構作
共用，達到節省面積與功率的效果。其架構由圖(二十)所示，為了實現MPPT IC因而分析太
陽能系統中所需之輸入(ADC)與輸出端(DC-DC Converter)所需規格。為了實現太陽能與風力
雙模MPPT IC 因而分析太陽能-風力系統中所需之輸入(ADC)與輸出端(DC-DC Converter)所
需規格，其規格為表(十)所示。在DC-DC Converter太陽能所使用的切換頻率為100kHz，而
ADC為了減少IC面積上的付出只使用一個轉換晶片，則高速的需求是必要的。由於需轉換成
數位形式之電壓與電流信號較多，使用多工器切換的方式來達到共用效果，可減少晶片上面
積與佈線上得干擾和功率消耗。所設計的每一個電壓與電流轉換時間，最長時間為1Mhz 。 
表十、太陽能-風力系統ADC與DC-DC Converter規格表 
太陽能系統/風力系統 速度 解析度 
ADC  1Mhz 12bit  
DC-DC Converter  100kHz/50kHz 8bit 
  
3.3 整合 PWM 電路結果: 
    目前比較的是 PWM 電路的整合與兩組分別使用結果如表(十一)九所示。在共用 PWM 電
路情況下，電路面積節省了 954um2 與功率消耗節省了 16uW。接下來需將風力部分之加法
器與乘法器電路與太陽能部分使用折疊式架構做元件的共用，以達到進一步節省電路面積之
效果。 
表十一、太陽能風力最大功率追蹤電路合成後面積功率比較 
 PWM 共用計數器 PWM 分別使用
Clk 25MHz 25MHz 
面積(um2) 1294 2248 
功率(nW) 19.08 35.10 
3.4 使用折疊式(Folding)作共用節省電路: 
為了實現太陽能與風力雙模MPPT電路架構Folding，我們必須分析太陽能-風力系統中所
需輸入端(ADC)與輸出端(Converter)所需操作頻率，其規格為表(十二)所示。在輸入端系統電
壓與電流之數位訊號經由ADC產生，其取樣頻率皆為1MHz。在輸出端太陽能所使用的DC-DC 
Converter切換頻率為100kHz；風力發電系統Converter的切換頻率為50kHz。由於將兩個系
統一起做Folding整合，其操作頻率必須相同，故將風力MPPT演算法電路輸出操作頻率，透
過PWM電路中相位轉換電路做操作頻率提升至100kHz與太陽能MPPT演算法電路輸出部份
匹配，而輸出至風機Converter的切換頻率保持在相同的50kHz，不改變系統規格架構，但可
將太陽能與風力的MPPT演算法部分透過Folding整合。MPPT演算法輸入與輸出端的操作頻
率設定為匹配後，可將太陽能風力雙模MPPT電路整體中相同功能之運算元件一起做Folding
轉換，MPPT電路輸出與原始MPPT電路有相同之功能與操作頻率，故可在不影響發電效率
下，將太陽能與風力MPPT電路架構中加法與乘法器電路透過Folding共用，以節省晶片電路
面積。 
表十二  太陽能-風力系統ADC與Converter規格表 
太陽能系統 操作頻率 解析度
ADC 1MHz 12bit 
DC-DC Converter 100kHz 8bit 
風力系統 操作頻率 解析度
ADC 1MHz 12bit 
AC-DC Rectifier 50kHz 8bit 
 
  
 
圖二十二 使用折疊式技術整合太陽能風力 MPPT 之運算電路架構圖 
  
參考文獻 
[1] 林永祥，〈Design of a Gain Scheduling Photovoltaic Energy Conversion System〉，
私立長庚大學電機工程學系，碩士論文，民國 97 年。 
[2] 蘇益立，〈市電併聯型風力發電系統實現〉，私立長庚大學電機工程學系，碩士論文，
民國 99 年。 
[3] K. Seth, K. N. Viswajith, S. Srinivasan, and V. Kamakoti, “Ultra folded high-speed 
architectures for Reed Solomon decoders,” Proc. of the 19th International Conference 
on VLSI Design, Jan. 2006. 
[4] 陳均祺，〈台灣耗能性產業因應京都議定書之溫室氣體減量預估〉，私立淡江大學水資
源及環境工程學系，碩士論文，民國 95 年。 
[5] M. A. Slonim and L. M. Rahovich, “Maximum power point regulator for 4 kW solar cell 
array connected through invertor to the AC grid,” Energy Conversion Engineering 
Conference,  vol. 3, no. 2, pp. 1669-1672, 1996. 
[6] E. Trishan and P. L. Chapman, “Comparison of Photovoltaic Array Maximum Power 
Point Tracking Techniques,” IEEE Transaction on Energy Conversion, vol. 22, pp. 
439-449, Jun. 2007. 
[7] 溫宗修，〈風力發電機之混合式最大功率追蹤法〉，私立大同大學電機工程學系，碩士
論文，民國 98 年。 
[8] E. Koutroulis and K. Kalaitzakis, “Design of a maximum power tracking system for 
wind energy conversion applications,” IEEE Transactions on Industrial Electronics, 
Vol. 53, pp. 486-494, Apr. 2006. 
[9] Y. C. Kuo, T. J. Liang, and J. F. Chen, “Novel maximum power point tracking controller 
for photovoltaic energy conversion system,” Industrial Electronics, IEEE Transactions, 
vol. 48, pp. 594-601, 2001. 
[10] 盧彥良，〈應用徑向基底類神經網路於風力發電系統之最大功率控制〉，國立中山大學
電機工程學系，碩士論文，民國 97 年。 
[11] J. G. Slootweg, S. W. H. deHann, H. Polinder and W. L. Kling, “General Model for 
Representing Variable Speed Wind Turbines in Power System Dynamics 
Simulations,” IEEE Trans. Power Systems, vol.18, pp. 144-151, Feb. 2003. 
 
 
  
階製程會面臨前段所述的種種障礙，轉換精確度容易受干擾而降低，因而需要精密的放大器、
比較器與校正補償電路來彌補訊號上的失真，大幅提高電路設計的難度，增加設計成本與研
發時間。為了解決可預見的電壓解析瓶頸，本研究採用時域訊號轉換之架構[3]，其概念是利
用三角波或鋸齒波截取輸入訊號的準位，轉換成不同大小的波寬(Pulse Width)，再以計數器
計算得到的數位碼。 
此研究子計畫，如圖 1，負責提供把電壓轉換成數位訊號。類比數位轉換器在積體電路
的製作上很容易因製程上的偏移造成誤差，其特性對整個最大功率追蹤系統有重大的影響。
因此本子計畫將提出時域型類比數位轉換器，如圖 2，其特色是比傳統類比數位轉換器操作
在較小的功率消耗、較小晶片面積、以及提高對雜訊等參數變異的容忍度。 
 
圖 1 – This subproject in the system of the entire project is showed inside the blue dotted line. 
 
Clock 
Generator
Coarse 
Controller
Fine 
Controller
Vc
Fs/Fc
Phase[1:16]
Vin
Stop
6b
6b
12b
MUX
Voltage to 
digital 
converter
FIFO
V1
Vn
Vin D[1:N]
F[1:N]
 
圖 2 – The function of this subproject and the sketch of the VDC function. 
 
2‐3. 文獻探討 
此計畫主要參考了 Time‐Based  Ramp  ADC  [3], Multi‐Phase  VCO  [4]  以及  Time‐to‐Digital 
  
 
圖五則是[4]  的概略系統方塊圖，與我們相同的是粗調控制是利用計數器計算其時間等
效數位碼大小，而微調則是利用 VCO本身的相位差來作取樣轉換動作。不過我們並未採用此架構，
而是把 VCO的相位提升到 16個，並直接用 VCO的相位重覆循環 4次以提升額外 2位元的解析度，不
過也必須把 VCO提高 4倍速作為代價。 
 
 
圖 5 – The block diagram of Time-based ADC using ring VCO. 
2‐4. 研究方法 
2-4-1 全電路架構 
 
 
 
 
圖 6 – 12 位元類比數位轉換器的電路架構 
  
週期以內，此時加入微調控制器(Fine Controller)，分析 Stop 與 Fc_Stop 的時間長度，進而獲
得額外 6 位元解析度，提升總解析度到 12 位元。 
 
 
2-4-2 頻率相位產生器 (Clock Phase Generator) 
由圖 6，全電路架構圖來看，頻率相位產生器分為兩個電路，其一是 16 相位電壓控制正
盪器(VCO)，其二是除頻器。本晶片用 VCO 震出最高所需頻率與相位，然後把 Pf[0]相位當
作系統頻率，逐級除頻而獲得所需要的三個頻段，Fp[15:0] 在 1GHz，Fc 在 256MHz、Fs 在
1MHz。除頻器使用基本除 2 電路。 
如圖 8，為 16 相位 VCO 電路圖，所有的 Cell 對接順序只有 P8 與 P16 處反接，這是為
了讓 VCO 之中的相位傳遞能夠達成一個循環的狀態。 
如圖 9，VCO Cell 內部電路，實際在電路 Cell 內部來看，除了 P8 與 P16 以外，其他的
Cell 之間的接法為 OUT1 接 IN2，OUT2 接 IN1，恰好是反接，唯有 P8 與 P16 之處正接。 
 
 
圖 8 – 具有 16 相位之 VCO 
 
 
圖 9 – VCO 內部 Cell 之電路 
 
圖 10 為 VCO 在 3 個 corner，TT(25 度 C、1.8V)、FF(0 度 C、1.98V)、SS(80 度 C、1.62V)，
的頻率對電壓 Vc 作圖，其中用尺標標示的分別是垂直線上的相同 Vc 點，與水平線上的相同
頻率(1GHz)點，在這些標示範圍內，VCO 的線性度良好。 
  
器(Counter)轉換出不同電壓對應的 6 位元數位碼。 
 
 
圖 12 –同步器(Synchronizer)，功能是讓 Coarse 與 Fine 的解析波寬的 falling edge 同步 
 
如圖 12，因為 Synchronizer 獨立出來不容易理解，所以加入 Counter 做說明。從外部看，
虛線框內為 Synchronizer，其產生 Pulse Width (Coarse)波寬，由計數器計算其大小而獲得粗調
解析度 C[5:0]。 
從虛線內部看，Fs 作為波寬起始點，啟動 SR Latch 的 S 端，當比較器輸入端鋸齒波電壓
超過 Vin 的瞬間，產生 Stop 訊號，進入同步器之第一個 DFF，第一個 DFF 接著開啟第二個
DFF 的 D 端，這個時間非常短暫，只需要不到 20p 秒，隨後 Fc 最接近的下一個 rising edge
會觸發第二個 DFF，產生 Fc_Stop 訊號，此訊號啟動 SR Latch 之 R 端，至此產生完整的 Pusle 
Width (Coarse)波寬。 
值得一提的是，Fc_Stop 不但是 Coarse Controller 的時間計數終點，同時也是 Fine 
Controller 的相位取樣終點，這個特性在圖 3 時序圖中一覽無遺。因此，Coarse 與 Fine 兩者
的計算時間(波寬)標準在此同步，因此命名此方塊叫做 “Synchronizer＂，此方塊是 Coarse
與 Fine 共用之。 
 
圖 13 – 比較器(Comparator)電路內部增加兩個 NMOS 電流鏡放電路徑，提高靈敏度 
  
段式電流鏡架構，八通道充電電流之間的關係是二進位的倍數關係。此架構不但節省晶片布
局所需面積，在佈局上也把面積大的電流鏡設計在外側，面積小的則畫在內側，提高晶片面
積利用率。 
理論上，若鋸齒波為線性，則精確度無限(若不考量時脈上限)。然而，實際電路的充放
電必然有其非線性的現象，我們藉由設計充電泵的架構，讓鋸齒波盡可能具有良好的線性度，
以求最大解析度。 
承上一段，由於鋸齒波(Ramp)對製程敏感，而 Charge Pump 是產生鋸齒波的電路，必須
加上校正電路以避免製程變異導致日後晶片量測上的誤差。經由電路模擬顯示，在 TTFFSS
等不同參數下所得到的鋸齒波電壓最大(FF)與最小(SS)可能相差近一倍，因此鋸齒波的校正
是必須要的工作。 
以下圖 16、圖 17 的模擬圖會展示相同輸入訊號的情況，在不同 Corner 卻能得到同樣正
確的結果。在同樣充電電流之下，鋸齒波在 TT(25 度 C、1.8V)、FF(0 度 C、1.98V)、SS(80
度 C、1.62V)的情況下，鋸齒波的變異很大，因為充電電流量隨著不同參數的變化會有顯著
的不同。這樣的情況會直接導致此時域型粗調控制器 ADC 轉換錯誤。 
 
 
圖 16 – 未校正前的鋸齒波在三組參數下的變異 
 
又如圖 17 顯示，當加入校正機制，三組不同參數所獲得的鋸齒波幾乎相同，誤差小於
5mV，經過評估得知此誤差造成粗調控制器的最大誤差( INL )小於 0.16 個 LSB，對粗調轉換
準確度的影響很小，可維持粗調控制器輸出正確的轉換結果。 
 
圖 17 - 校正後的鋸齒波在三組參數下的變異 
 
 
 
 
 
 
  
依照時域解析度擴充法則，6 位元解析度需要粗調時脈 Fc(256MHz)乘以 2 的六次方，等
於是需要用 16.384GHz 才能獲得 6 位元解析度！這在實際設計上是不可行的。 
至於一般延遲線(Delayed Line)架構的設計則容易受到製程參數變異而發生數位碼整體
平移(Shift)的錯誤，必須隨著外部環境參數與晶片參數變化來改變控制電壓，或使用額外的
校正電路來修正延遲時間變異所導致的編碼錯誤與平移。 
本架構利用 VCO 的 16 相位，Pf[15:0]，操作在 1GHz 頻率來取代 16.384GHz 時脈與一般
延遲線架構，利用與系統頻率 Fs(1MHz)、Fc(256MHz)、Fp(1GHz)同步的相位 Pf[15:0]來做微
調控制器獲得解析度的取樣訊號。根據相位 Pf[15:0]與系統頻率的同步關係，無論 VCO 本身
的頻率變動如何，Pf[15:0]永遠與之同步，因此當晶片受到製程、溫度甚至是晶片老化等影響，
Q[63:0]相位仍然會鎖定在一個 Fc 的週期之內，維持轉換精確度，這等同是一種自我校準的
相位架構。 
 
※這個架構的主要優勢列舉如下： 
1. 不必依賴外部精確的 Vc 控制 
2. Q[63:0]與 Fc 有相位同步的本質，不需校準。 
3. 只需要 4 倍於 Fc 的頻率即可運作此 6 位元微調控制器，減少動態功率的損耗。 
4. 比起傳統延遲線架構，對於製程變異的抗性極高，在 TT、FF、SS 可使用相同輸入設
定得到正確結果。 
 
 
圖 19 – Fine Controller 之 Decoder 架構，把 thermometer code 轉為 binary code 
 
圖 19 是微調控制器的 Decoder 架構，經過取樣維持電路(Sample/Hold Circuit)後，把電路
做兩階段編碼，分為兩階段的主要原因是全加器(FA)電路很大，若把 64-to-6 Decoder 用一級
HA/FA 編碼器實現，必然會浪費大量面積。因此採取兩段式編碼，可以大幅減少 HA/FA 編
碼器的使用數量。 
第一階段是 DFF layer selector，概念是先判斷 DFF 陣列的相位延遲傳遞到哪一層，因為
一定要先數滿第一層，才會進入第二層，以此類推。因此，如圖 20，只需要簡單的 OR 邏輯
閘以及標準型 4-to-2 Decoder，就能組合出 64-to-2 Decoder，產生 B5-B6 兩個碼。 
第二階段是把 64 個相位選出其中一層需要編碼的 16 個相位，傳給下一級 HA/FA 
Decoder，因為 Q[63:0]是 thermometer code，四層各 16 相位的狀態只有三種可能──全 “1”、
  
thermometer code 編碼錯誤。 
 
2-4-5 電路模擬 
本電路最高使用頻率是 Fp[15:0]，操作在 1GHz，用於 Fine Controller 的多相位訊號；其
次是 Fc，256MHz，用於 Coarse Controller 的 Counter 計數頻率；最後是 Fs，1MHz，用於整
個晶片的基本工作頻率，即本晶片的 ADC 取樣頻率。 
由於本晶片 Fine Controller 操作在 1GHz，且為多相位訊號，對電腦運算負擔較大，若整
合 Coarse Controller，進而操作在 1MHz，對電腦而言是非常非常龐大的運算量！比方說：此
ADC 轉換一個 Code 需要 1us 週期，對 Coarse 而言只有計數器(256MHz)運算量稍大，但對
Fine 而言，多相位皆操作在 1GHz 是很大量的運算。因此，若要對全電路進行 FFT 數據分析，
需要大量的數據，因此本晶片的驗證分為兩階段，分別是 Coarse Controller 與 Fine Controller
的詳細驗證，最後是全電路的 SNR 分析。以下分別解釋模擬的方法與結果： 
粗調控制器 – 6 位元電壓數位轉換器 
粗調控制器的架構為 6 位元時域型 ADC，採用正弦波輸入，經過 ADC 之後，再用理想
DAC 把數位碼轉回弦波，再以 FFT 轉換求其 SNDR、ENOB、DNL、INL 等數據。 
圖 22 是微分非線性度曲線，此部分表示實際數位碼寬度與理想數位碼寬度間的差值，我
們模擬得到 DNL 小於 0.15LSB，特性良好。 
圖 23 是積分非線性誤差(INL)，或可說是個輸出數位碼的實際轉換電壓與理想轉換電壓
的差值，理想值為小於 0.5 個 LSB。在此我們量測到小於 0.7LSB 的值。量測時，可以藉由鋸
齒波充電電流電阻調整 Offset error 來修正。 
圖 24 則是測試弦波經過理想 DAC 轉換後，再經過 FFT 運算，此數據可推算出 SNDR、
SFDR 等轉換器的動態性能，最後可計算出有效位元值 ENOB。 
表 1 則列出 Pre-Sim 與 Post-Sim 在 TT 情況下的重要參數比較。 
表 2 則列出 Post-Sim 的三個 corner 之下的 FFT 參數結果比較。 
值得一提的是：加入粗調控制器的 Ramp 校正電路之後，無論在 TT、FF、SS，結果都
是使用相同輸入設定所獲得的，這直接證明了鋸齒波校正電路的功能。 
 
 
圖 22 (a) – DNL 折線圖：Pre-Layout Simulation 
  
 
圖 24 (a) – FFT Spectrum：Pre-Layout Simulation，輸入頻率=10KHz 
 
 
圖 – 24 (b) – FFT Spectrum：Post-Layout Simulation，輸入頻率=10KHz。 
 
Coarse Pre- Simulation Post- Simulation 
DNL(MAX) 0.12 0.19 
INL(MAX) 0.66 0.73 
ENOB 5.78 5.74 
SNDR 36.5 36.3 
SFDR 41.9 41.5 
表 1 – Coarse Controller 重要參數表 
 
Coarse TT FF SS 
DNL(MAX) 0.19 0.48 0.17 
INL(MAX) 0.73 0.78 0.91 
ENOB 5.74 5.69 5.59 
SNDR 36.3 36.0 35.4 
SFDR 41.5 41.4 39.1 
表 2 – Coarse Controller at 3 corners：Post-Layout Simulation 
 
  
(a) Pre-Sim：DNL,max = 0.22 ; INL,max = 0.26 (b) Post-Sim：DNL,max = 0.38 ; INL,max = 0.38 
圖 26 – Simulation：FF Corner 
 
(a) Pre-Sim：DNL,max = 0.26 ; INL,max = 0.75 (b) Post-Sim：DNL,max = 0.5 ; INL,max = 0.75 
圖 27 – Simulation：SS Corner 
 
FINE TT FF SS 
DNL(MAX) 0.19 0.48 0.17 
INL(MAX) 0.73 0.78 0.91 
表 3 – Fine Controller 靜態參數整理表 
 
全電路 SNR 分析 – 12 位元時域型 ADC 
全電路的分析主要針對 SNR 做動態分析驗證，因為 12 位元數的時域型 ADC 運算量龐
大，DNL、INL 數據需要大量數位碼的累積來換算其誤差值，超過合理模擬時間範圍，故此
  
2‐5. 結果與討論 
2-5-1 量測考量 
輸入與輸出埠的設定 
本晶片所有的控制 I/O 埠共有 32 個 I/O 埠，其中 VDD、VSS 共 5 組；在模擬中有「需
要控制」的輸入訊號是 Vc、Vin、Vref、Vcb Vreset、Cali_sw 等 6 個；控制電阻的 Vddr1、
Vddr2；輸出 12 位元數位碼 12 個；最後是輸出頻率 2 個埠，共 32 個。 
其中如 Vddr1、Vddr2 等控制訊號是用來控制電阻的控制輸入訊號，理想值為 VDD，並不需
要外接。但為了在量測晶片時，可以測試更多不同變數的影響，因此用外接電阻，目的是希
望量測與分析數據更加圓滿，提高晶片量測成功率。 
 
量測訊號方法 
1. 由測試機產生一個連續的正弦波輸入訊號 Vin，讓 ADC 能執行轉換的工作。 
2. 在 ADC 電路的輸出端，收集一組取樣點。 
3. 將收集到的時域樣本儲存，利用 Matlab 做 DFT/FFT 轉換。 
4. 使用公式或演算法，針對相關的頻率分析。以便計算各種參數，並與規格做比較 
 
儀器連接方法如圖 30。 
 
圖 30 – 量測裝置圖 
 
電源供應器：圖左，產生 VDD、VSS 與偏壓點 Vc 
頻率產生器：圖中，產生良好的正弦波，做動態測試。 
邏輯分析儀或示波器：圖右，記錄數位碼狀態變化，作為分析依據。 
 
2-5-2 晶片實際量測結果 
圖 30 為晶片測試環境設定。 
圖 31 為示波器量測到的經過除頻後輸出為 1MHz 之 VCO 頻率。 
  
 
圖 33 – 晶片實際拍攝圖 
 
各參數 預計規格 量測結果 
取樣頻率 1MHz 1MHz 
全功率 49.7mW 50.7mW 
VCO 功率 34.3mW 35.1mW 
ENOB 11.0 無法量測 
表 5 – 預計規格與實測結果 
 
本次設計得出的模擬結果與實際晶片量測無法做數據分析比較，因為 ADC 內部訊號有
錯誤，經不斷檢討驗證，錯誤分析如下： 
參考圖 32，理論上輸入 DC 電壓時，輸出數位碼應該固定在某個值，然而本晶片卻會呈
現類似「週期性電容放電」的波形，顯然鋸齒波的部分有錯誤。經研判是鋸齒波校正電路沒
有正確地把鋸齒波鎖定住，反而讓鋸齒波不斷的重複「計數器遞增充電電流量→計數器數滿
→快速放電到零電位→計數器再次遞增充電電流量」的循環，表現出來的波形會呈現緩慢減
少然後突然遞增是因為鋸齒波在時域訊號處理上有一反向的特性。 
這次晶片設計最大的失誤就是鋸齒波校正電路沒有做開關，導致校正電路錯誤時無法藉
由關閉校正功能來取得未校正的轉換結果。其次，校正電路中有 D 型正反器的輸入 reset 端
訊號浮接，研判可能就是因為此關鍵訊號無法經由 D 型正反器傳遞導致鋸齒波校正之計數器
無法停止，形成週期性充放電的鋸齒波，因而無法執行 ADC 數據分析之任務。然而，我們
可以從圖 32 判斷此 ADC 仍然具有取樣輸入訊號的功能，並且輸入訊號與輸出訊號有明確的
  
3‐3. 研究成果之學術與應用價值 
目前已經可以預測未來是可攜式電子產品的世界，因此電源的可靠性與低功率產品
的研發日趨重要，而(類比)電壓轉數位轉換器是大部分電子系統的常用電路，例如：可
攜產品必備的數位式直流對直流轉換器也必須用此電路，此電路的設計可說非常重要。
其應用價值如下所列： 
(1) 各種人機介面之類比數位轉換電路。 
(2) 未來最大功率追蹤系統，可以運用本計劃的技術，加以大量實現在低成本  CMOS
製程，符合當前綠色能源發展方向。 
(3) 將來高階 CMOS製程可望朝時域型類比數位轉換氣發展。 
3‐4. 是否適合在學術期刊發表 
是的，本計畫結合一般時域型電壓轉數位結構與時間轉數位架構，並利用了多相位 VCO
作為提升解析度的媒介，具有創新價值，可以在學術期刊發表。目前已經在 2010  IEEE 
International Conference on Electron Devices and Solid‐State Circuits (EDSSC'10)研討會發表一篇
A Time‐to‐Digital Converter Using a Multi‐Phase Votage‐Controlled Oscillator 研討會論文，並計
畫著手撰寫期刊論文。 
3‐5. 主要發現或其他有關價值 
(1) 了解類比轉數位轉換器設計的困難及其在綠色能源系統中所扮演的腳色。 
(2) 學習電路與系統面的整合。 
(3) 學習分析既有的電路，進而思考創新的技術來改善。 
(4) 累積積體電路的設計、模擬、測試等能力和經驗  ,有助於建立發展更龐大的綠色能
源系統之能力。 
四、 可供推廣之研發成果資料表 
尚無可供推廣之研發成果。 
五、 參考資料 
[1] Chia‐Nan Yeh; Yen‐Tai Lai; Chi‐Chou Kao, “A Novel Flash A/D Converter with Ultra Short Latency 
and  High  Bubble  Error  Tolerance”,  Communications,  Circuits  and  Systems,  2007.  ICCCAS  2007. 
International Conference on 11‐13 July 2007 Page(s):1048 – 1052. 
[2] Adeniran,  O.A.;  Demosthenous,  A.,  “Optimization  of  bit‐per‐stage  for  low‐voltage  low‐power 
CMOS  pipeline  ADCs”,  Circuit  Theory  and  Design,  2005.  Proceedings  of  the  2005  European 
Conference on Volume 2, 28 Aug.‐2 Sept. 2005 Page(s):II/55 ‐ II/58 vol. 2. 
[3] Shahrzad Naraghi, Matthew Courcy, Michael P. Flynn, “A 9b 14μW 0.06mm2 PPM ADC  in 90nm 
Digital CMOS”, p.168~170, ISSCC 2009, SESSION 9, DATA CONVERTER TECHNIQUES. 
[4] Jaewook Kim and Seonghwan Cho, “A Time‐Based Analog‐to‐Digital Converter Using a Multi‐Phase 
Voltage‐Controlled Oscillator”, ISCAS, 2006. 
[5] Abdel  S.  Yousif  and  James  W.  Haslett,  “030.  A  Fine  Resolution  TDC  Architecture  for  Next 
Generation PET  Imaging”,  IEEE TRANSACTIONS ON NUCLEAR SCIENCE, VOL. 54, NO. 5, OCTOBER 
2007. 
  
 
圖 1.本分項計畫所提電路架構方塊圖 
II. 太陽能板發電原理 
    太陽能板是由許多太陽能電池(cell)串並聯所組成，每一個太陽能電池皆由 P-N
接面的半導體所組成，經由光照射後會形成一電流源提供給負載。太陽能板之等效電
路如圖 2 所示，其中電流源 Iph 用來表示太陽能板藉由光照射後所產生之電流；Dj 用
以表示 P-N 接面之二極體；Rsh 和 Rs則分別代表太陽能板內部的等效並聯電阻及串聯
電阻。在一般情況下，Rsh 為接面阻抗約為數百 kΩ，而 Rs 為矽與電極之阻抗約為 m
Ω。因此一般為了簡化分析，可將 Rsh 與 Rs忽略不計，Vpv與 Ipv則分別表示太陽能電
池模組之輸出電壓及電流。透過等效電路並結合半導體 P-N 接面半導體特性，可將太
陽能板之等效數學模型表示如方程式(2.1)所示。 
 
圖 2 太陽能板等效電路 
           sh
spvspvpv
pvophpv R
IRV
AkT
RIVq
III




  1])(exp[   (2.1) 
其中 
Vpv：太陽能 v 之輸出電壓(V) 
Ipv：太陽能板之輸出電流(A) 
q：一個電子所含電荷量( 19106.1  C) 
K：波茲曼常數( 231038.1   J/°K) 
T：太陽能板之表面溫度(°K) 
A：太陽能板之理想因數(A=1~5) 
Ipvo：太陽能板之反向飽和電流(A) 
  
 
(b) 
圖3 不同環境溫度、固定照度(1kW / m2 )下之(a)電壓-電流特性曲線及(b) 電壓-功率特
性曲線(資料來源:SHARP公司) 
III. 太陽能發電之最大功率追蹤 
    由於擾動與觀察法之原理與架構簡單，常被使用在太陽能光電板最大
功率點追蹤 (Maximum Power Point Tracking：MPPT)的應用，因此本研究計
畫採用擾動與觀察法來實驗 MPPT。以太陽能光電板的發電特性而言，圖 3
為其輸出電壓 VPV 與輸出功率 PPV 之關係曲線圖，由圖中可得知，在不同
照度下會有不同的功率與電壓曲線，在每條曲線中，則會產生一點最大功
率點，此最大功率點的追蹤若採用擾動與觀察法方式去實現，其系統控制
流程圖如圖 4 所示。由圖 4 中可得知，採用擾動觀察法需要先估算太陽能
板的輸出功率，然後針對輸出功率 PPV 與輸出電壓 VPV 之關係，判斷出要
增載或減載，以達到 MPPT 的功能。  
 
圖 4. 擾動與觀察法的控制流程圖 
  
Counter
VCO
MPPT ZCD
Peak
Current
Sense
UVLO ReferenceRegulator
Vi
A
Bout INV
Comp
Rrange
Rmin
Vco
CS
Ii
II
ID
Error
Amp
Q        
Q’R
Flip
Flop
A
Complementary
mode output
  B      
Vref
EN
GND
PCS1
Vref
OCReset T
1
1
PCS2
Reset D
PWM 
Comparator
VIi
VB/L
VDD VEN
PV
R1
Vco
Rmin
Rrange
Buffer VEA
Buffer
B/Lmode
MPPTU
CSU
OSU PWMU
Vi
L1
L2
M1 M2
M3
L1m
L2m
L1s
L2s
D1
D2
D3
D5D4
VOR0
C0
CM1 CM2
( V Battery )
LA-55P
R2
C1
B/Lmode
B/Lmode
R
B/Lmode
B/Lmode
VDD
 
圖 6 操作於充電模式下系統電路圖 
     
   (VDS :50 V/div, IDS: 5 A/div, 10 μs/div)          (VDS :50 V/div, IDS: 5 A/div, 10 μs/div) 
(a)                                                                                   (b) 
圖 7 具昇壓型緩震電路之昇壓轉換器操作在 20％滿載下，(a)開關 M1 (b)開關 M2 VDS 及 IDS
波形圖 
             
 
  (VDS :50 V/div, IDS: 10 A/div, 10 μs/div)           (VDS :50 V/div, IDS: 10 A/div, 10 μs/div) 
(a)                                                                                   (b) 
  
(a) MPPTU 
    依據表1之MPPT控制方法，需先判斷出前一態的增減載訊號，因此我們將預設增減載的
值。然後開關S1閉合，將太陽能板輸出電壓Vi讀入並儲存在電容CVP內，成為前一態太陽能板電
壓，接下來開關S2和S3同時閉合，與預設的光電板輸出變化量ΔVi做加減，並和後一態的太陽能
板輸出電壓Vi+1做比較，然後依據表1的動作條件使用邏輯電路作判斷，如此便可決定操作區
域。只要判斷出Vi+1>Vi+ΔVi或Vi+1<Vi-ΔVi，便將開關S1導通，將太陽能板輸出電壓儲存起來，
做為前一態太陽能板輸出電壓再進行比較，其模擬波形圖，如圖18所示。 
(b)CSU 
    由圖19得知，當操作在A區時，轉換器輸入電流Ii調整為加大ΔTV1的時間即dead time的時
間，使太陽能板輸出電流IPV下降，即達到降載之功能。由圖20得知，當操作在B區時，轉換器
輸入電流Ii調整為縮小ΔTV2的的時間，使太陽能板輸出電流IPV上升，即達到增載之功能。因此
根據增載或降載的訊號，我們需要一個加減法器，來調整dead time的時間。 SI+1為增載訊號，
SD+1為減載訊號，而SI+1’與SD+1’分別為SI+1和SD+1互補訊號，ΔIi為預設dead time的量。當SI+1為1
時，OP1形成一個減法器，且透過關閉S1~S3的控制形成一閉迴路，將ΔIi持續做累加，結果將儲
存在電容C1，等ZCD(Zero Current Detection)信號進來，電路圖上標記有ZCD的開關全閉合，並
將儲存在電容C1所累加dead time的結果存入電容C4，由於OP6的RC形成放電路徑，當電容C4
放完電，即表示dead time結束，並用比較器OP5 做偵測，其模擬波形圖，如圖21所示。 
(c)PWMU 
   操作充電模式時，我們已從CSU的處理來Reset T，接下來將取電力級上電感電流做PCS，
利用差動放大器偵測峰值電流與參考電壓做比較，來Reset D，並經SR正反器產生互補式信號，
其模擬波形圖，如圖22。 
(d)OSU 
    Reset T 和 Reset D 進入 SR 正反器輸出互補式信號，經 X1和 X2 OR 閘後產生互補式輸出，
此舉是為了方便設計 B/L mode 之多工器選擇線。做選擇控制時，O1 和 O3 OR 閘輸出會恆為
低電位，因為 O1~O4 OR 閘所接電路為 D 類放大器，其優點是可快速充放電流，但其缺點是
兩端輸入不能同時為高電位，否則將會使上下臂導通燒毀電晶體。Aout 和 Bout 將輸出互補
式的方波來驅動電力級上開關，其模擬波形圖，如圖 23 所示。 
 
圖 13 PWM IC 內部功能方塊圖 
  
 
 
 
 
 
 
 
 
 
 
 
 
圖16 MPPT整體架構方塊圖 
 
    
(VPV、Vi : 50V/div, IPV、Ii : 5A/div, 1s/div)        (VPV: 50V/div, IPV: 5A/div, VO : 20V/div, IO : 1A/div, 1s/div) 
(a)                                         (b) 
圖17  最大功率追蹤實測波形 
 
圖18 MPPT電路simplis模擬波型圖 
SC
  
 
圖21 CSU電路simplis模擬波形圖 
 
 
圖22 PWMU電路simplis模擬充電模式波形圖 
Voltage/V
Time/mSec
S
R
Output B
Output A
 
圖23 OSU電路simplis模擬波型圖 
 
 
 
  
 
IDS
VDS
    
IDS
VDS
 
     (VDS: 50 V/div, IDS: 10 A/div, 5 s/div)          (VDS: 50 V/div, IDS: 10 A/div, 5 s/div) 
(a)                                                                               (b) 
圖 25 硬切返馳式轉換器操作在(a) 50%滿載下(b) 100%滿載下開關 M1上的電壓 VDS及電流 IDS波形圖 
 
IDS
VDS
   
IDS
VDS
 
     (VDS: 50 V/div, IDS: 10 A/div, 5 s/div)          (VDS: 50 V/div, IDS: 10 A/div, 5 s/div) 
(a)                                                                               (b) 
圖 26 本文所提無損耗緩震電路之返馳式轉換器操作在 (a) 50%滿載下(b) 100%滿載下開關 M1的電壓
VDS及電流 IDS波形圖 
 
      
圖 27 所提與硬切轉換器從輕載到滿載效率比較圖      圖 28 本文所提轉換器在 20%至 100%滿載時輸出電             
壓 VO及輸出電流 IO波形圖   
V. 系統架構 
    本計畫主要目的是實現太陽能發電系統，實體實驗平台如圖 29 所示，系統架構如圖 30
所示，包括 1.5kW 交錯式昇壓轉換器及備用電源轉換器。直流-直流轉換器主要採用昇壓型
緩震電路之交錯式昇壓轉換器在交錯式昇壓轉換器的功率開關上，加上昇壓型緩震電路來達
到軟切的效果，同時利用開關共用原理，以減少電路複雜度與元件數目、來降低電路成本及
電路體積並提升太陽能發電系統整體效率 5%。備用電源多模組輸出返馳式轉換器當作系統
的輔助電源。在此電路架構中，採用一組無損耗緩震電路來輔助返馳式轉換器回收一次側漏
  
VI. 各年計畫結果自評 
A. 第一年 
直流-直流轉換器 
    本計畫所提昇壓型緩震電路之交錯式昇壓轉換器由一組交錯式昇壓轉換器搭配昇
壓型緩震電路所構成。依據所提轉換器電路動作原理及各重要參數的設計原則，已完
成一台雛型機。由硬體實測波形也已驗證所提轉換器開關在導通轉態時具有 ZVS 特
性，而在截止轉態時具有 ZVT 特性，並且所提轉換器效率高於硬切轉換器，其滿載效
率可達到 92%。由上述之實驗結果可驗證本文所提昇壓型緩震電路提昇轉換器效率之
可行性。 
備用電源供應器 
    本計畫所提電路採用返馳式轉換器結合無耗損緩震電路，來抑制開關的電壓突波
及回收變壓器漏感能量。依據所提轉換器穩態分析及電路設計流程，已實際研製一台
五組輸出之返馳式轉換器雛型機，藉由實驗波形也得知，所提無耗損軟切電路具有降
低切換損失、回收漏感能量，來提高轉換器的轉換頻率。同時由效率比較圖也可得知，
提高轉換器在滿載時能有效提高 4%的效率，使滿載效率達到 81.4%。由上述之實驗結
果可得知，本文所提無損耗緩震電路的可行性。 
第二年 
直流-直流轉換器 
 本計畫所提結合昇壓型緩震電路之交錯式昇壓轉換器，在交錯式昇壓轉換器的功率
開關上，加上昇壓型緩震電路來達到軟切的效果，同時利用開關共用原理，以減少電
路複雜度與元件數目、來降低電路成本及電路體積，已由實驗結果驗證本計畫所提昇
壓型緩震電路之可行性。 
  備用電源供應器 
    本計畫提出多模組輸出返馳式轉換器當作系統的輔助電源。在此電路架構中，採
用一組無損耗緩震電路來輔助返馳式轉換器回收一次側漏感的能量，同時緩和開關截
止轉態時的電壓突波，以降低功率開關在截止轉態時汲極-源極間的電壓上升速度，加
上包含回授 A/D 的速度及內部 PID 補償電路穩定性的 FPGA 管理，達到降低開關截止
轉態時的切換損失。 
  最大功率追蹤器 
    由於太陽能光電板的輸出電壓與輸出功率會隨日照強度變化而改變，而
且輸出功率與輸出電壓之間呈現非線性比例的關係，故要找出最合適之最大功
率演算法。本計畫使用擾動與觀察法，其原理與架構簡單。雖然擾動觀察法會在
接近最佳功率點時，會在最佳功率點附近不停擾動，產生能量的損失，但是因需要量測
的外部參數少，因此追蹤功率的速度最快。 
第三年 
直流-直流轉換器 
  
參考文獻 
[1] Hong-Sung Kim, Gyu-Ha Choe, Gwon-Jong Yu and JinSoo Song, “Analysis of Bidirectional 
PWM Converter for Application of Residential Solar Air Conditioning System,” Proceedings 
of IEEE WCPEC, Vol. 1, Dec. 1994, pp. 1069-1072. 
[2] R. J. Hacker, D. K. Munro, J. M. Thomycroft, “Small Grid-Connected Solar Photovoltaic 
Generators in the UK,” International Conference on Renewable Energy-clean Power 2001, 
1993, pp. 61-66. 
[3] 江炫樟、張國財、顏吉永，”家用太陽能儲能系統之研製”，第十七屆(1996)電力工程研
討會論文集(II)，672-676 頁。 
[4] S. J Chiang, K. T. Chang, and C. Y. Yen, “Residential Photovoltaic Energy Storage System,” 
IEEE Trans. on Industrial Electronics, Vol. 45, No. 3, June 1998, pp. 385-394. 
[5] 黃慶連、蔡明村、林清一、蔡文蔭，”光伏系統併入電力線之應用研究”，第十七屆(1996)
電力工程研討會論文集(II)，772-776 頁。 
[6] Tsukasa Takebayashi, Hirofumi Nakata, “New Current Feed Back Control Method for Solar 
Energy Inverter Using Digital Signal Processor,” Proceedings of PCC ’97, Vol. 2, Aug. 1997, 
pp. 687-690. 
[7] Katsuya Hirachi and Yasuharu Tomokuni, “Improved Control Strategy to Eliminate the 
Harmonic Current Components for Single-Phase PWM Current Source Inverter,” Proceedings 
of Power and Energy Systems in Converging Markets, Oct. 1997, pp. 189-194. 
[8] Kiyashi TAKIGAWA, Hiromu KOBAYASHI, “A Development of Compact and Reliable 
Protective Control Unit for Grid Connected Small Residential PV Systems,” Proceedings of 
IEEE WCPEC, Vol. 1, Dec. 1994, pp. 1081-1084. 
[9] Fadia M. A. Ghali, “A Combined Technique for Elemination of Islanding Phenomenon, 
“ Conference Record of the IEEE Photovoltaic Specialists Conference, May 1996, pp. 
1473-1476. 
[10] Sakutaro Nonaka, “A Utility-Connected Residentail PV System Adapted a novel Single-Phase 
Composite PWM Voltage Source Inverter,” Proceedings of IEEE WCPEC, Vol. 1, Dec. 1994, 
pp. 1064-1068. 
[11] Satish J. Ranade, Nadipuram R. Prasad, Steve Omick, Louis F. Kazda, “A Study of Islanding 
in Utility-Connected Residential Photovoltaic Systems PART I- Models and Analytical 
Methods,” IEEE Trans. on Energy Conversion, Vol. 1, No. 3, Sep. 1989, pp. 436-445.  
  
[23] Carmeli, M. S., Dezza, F. C., Faranda, R., Marchegiani, G. and Mauri, M.,“Advanced control 
strategy for PQ improvement in PV systems without energy storage device,”SPEEDAM 
2008, June 2008, pp. 217 – 222. 
[24] Djarallah, M., Zeidane, B. O., Azoui, B.,“Energy transfer mechanism for a grid-connected 
residential PV system within the Matlab/Simulink environment,”UPEC 2007, Sept. 2007, 
pp. 763 – 770. 
[25] Fara, S., Finta, D. and Iancu, M.,“Efficient renewable energy systems exploitation aiming 
at reducing electricity generation from conventional power plants,”IEEE Conference on 
AQTR 2008, vol. 2, May 2008, pp. 91 – 95. 
[26] Bouhouras, A. S., Marinopoulos, A. G., Papaioannou, I. T., Labridis, D. P., Evaggelopoulou, 
C. K., Koutrouli, L. K. and Dokopoulos, P. S.,“Reliability improvement resulting from the 
integration of PV systems in the Interconnected Greek Transmission System,”IEEE 
Conference on EEM 2008, May 2008, pp. 1 – 6. 
[27] Mellit, A.,“Development of an expert configuration of stand-alone power PV system 
based on adaptive neuro-fuzzy inference system (ANFIS),”MELECON 2006, May 2006, 
pp. 893 – 896. 
[28] Hasan, K. N., Haque, M. E., Negnevitsky, M. and Muttaqi, K. M.,“Output quality 
evaluation of photovoltaic systems with different current control methods of 
switch-mode converters,”IEEE Conference on ICHQP 2008, Sept. 28 2008-Oct. 1, pp. 1 – 6. 
[29] Shimakage Toyonari, Jiro Sumita, Noriyuki Uchiyama, Kato Takeyoshi and Suzuoki 
Yasuo,“Supply and demand control of distributed generators in a microgrid,”IEEE 30th 
International INTELEC 2008, Sept. 2008, pp. 1 – 5. 
[30] Williams, S. R., Betts, T. R., Gottschalg, R., Infield, D. G., de Moor, H., van der Borg, N., 
Burgers, A. R., Friesen, G., Chianese, D., de Montgareuil, A. G., Zdanowicz, T., Stellbogen, D. 
and Herrmann, W.,“Accuracy of Energy Prediction Methodologies,”vol. 2, May 2006, pp. 
2206 – 2209. 
 
 
 
 
 
 
 
 
  
e e mP P
31
2w w
P AV
m P wP C P
A
 
圖 34 風力發電機轉換效率示意圖 
一般評估風力機所能擷取到的機械能時，通常以功率係數(power coefficient, CP)來代表轉
換後在發電機上的機械功率與風能之比例： 
  31
2m P w
P A C V                   (3) 
其中 CP 與風速、風力機的轉速及風力機葉片的設計參數有關；λ 為風力機葉尖速度與風速
Vw比值(tip speed ratio, λ)，定義為 
2 rps r
w w
f R R
V V
                   (4) 
其中，ωr為風力發電機的角速度(rad/s)，frps為風力機轉速(rps)，其與發電機的極數 P 及輸出
之電壓頻率 fe的關係可表示為： 
2 e
rps
ff
P
                    (5) 
利用(2)及(4)代入(3)即可整理到功率係數與葉尖速度比的關係，如下式： 
 
3
3
( ) 1
2
m
P
r
PC
A R

 
                   (6) 
風力發電機輸出電能，在考慮發電機的損失下，可表示為： 
 e P w eP C P                       (7) 
其中，ηe 為發電機的效率。由於發電機轉換損失遠低於發電量，所以在分析風力發電系統的
效率時可忽略發電機損失。將(7)修正為 
PeCP(λ)Pw                   (8) 
圖 2 所示為一典型風力發電機之功率係數 CP 對葉尖速度比 λ的特性曲線示意圖。此圖說
明當不同的葉尖速度比 λ 下，皆有一特定的功率係數。而為了達到最大功率點，其葉尖速度
比 λ 就必須保持在最佳的操作點上。圖 3 所示為各風速下風力發電機輸出電能對轉速之特性
曲線圖。由圖 3 可知，當風速固定時，風力機的輸出電能會隨著轉速的增加，呈現先上升而
  
再代入(5)式可求出實際機械轉速 ωr，接著根據參考命令與實際值間之誤差 Δωr，利用比例-
積分控制器(PI)產生電流命令 idu*將風力機轉速調整到當下所對應的機械轉速參考命令 ωr*，
使風力機調整在最大功率曲線上，以輸出最大電能。 
 
圖 4 不同功率係數下，風力機轉速、輸出電能及風速之關係 
d
dt
s s
3 ( + )
2 u u
v i v i    s
ωri
ωrp
K
K 1
b
2
poles
s-1
s
v
tan
v


   
3 
 
圖 5 以直接查表法實現之最大功率追蹤控制器 
 A.2 直接查表法之實驗結果 
本實驗將以實際自然風場反覆進行實驗，在不同的平均風速下進行測試，為了得知所使
用的演算法之成效，本計畫使用風力發電機能量轉換效率(Energy Efficiency,EE)[3]來評估發
電效率： 
                       
3
1
3
1
EE
1
2
n
r
e k=
n
w
w
k=
b
W
W ρAV

 


                              (10) 
其中 Ww為推動風力機葉片之風能，We為實際風力發電機輸出之電能。為了分析本計畫所設
計之最大功率演算法成效，先進行未執行最大功率追蹤之實驗，以做為實驗的比較基礎。圖
6-9 為風力發電機經由長時間(17.5 分鐘)運轉的動態響應。其中發電機的切入轉速(ωr,cut-in)為
7.12 rad/s，切入風速(Vw,cut-in)為 2.5 m/s，發電轉速或風速高於其切入轉速時，可開始輸出功
  
 
圖 9 未執行最大功率追蹤之功率-轉速曲線 
 由實驗結果可得知，在未執行最大功率追蹤時，可發現風力發電機在各風速下輸出的電
功率極小，累積風能約為 0.382M J 與累積電能 0.021M J 相差極大(圖 7)，導致其能量轉換效
率只有約為 0.056(圖 8)，代表只能由風能中擷取 5.6%的能量來使用。如圖 9 所示，與文獻[3]
所提供之最佳功率-轉速曲線做比較，未執行最大功率追蹤之工作點均落於最佳曲線的右側。 
依據 II 風力發電原理可知，發電機最大輸出功率與系統參數及風力機機械轉速有關，而
系統參數為定值，因此可得到最大輸出功率與機械轉速為三次方正比之關係。藉由這個關係，
最大功率追蹤可將風力發電機的輸出功率 Pe 帶入(9)，求得此風速下最大功率點所對應之機械
轉速命令，接著藉由調整切換式整流器有效電流命令 idu*，將發電機轉速控制在參考命令。
本計畫採用之風力發電機最佳轉速常數為 0.0468[3]，據此獲得發電機輸出之電功率與轉速命
令的關係，並以自然風場進行長時間(17.5 分鐘)、變動風速下之實驗，系統響應如圖 10 所示。 
 
圖 10 最佳轉速常數時直接查表法時系統之動態響應過程 
  
由 Pe的響應可發現，有效電流隨著風的變化而改變(圖 10)，有效調節發電機之轉速，進
而擷取較多的風能(圖 11)，可得到較高的能量轉換效率約為 0.158(15.8%)的結果，如圖 12 所
示。而將風力發電機操作於所設定的最佳功率曲線上(圖 13)。由以上結果可知，本計畫之直
接查表法，可在任何風速下輸出最佳電功率。 
IV. 風力發電機噪音抑制 
 傳統風力發電系統架構，其中風機側使用不可控制之二極體整流器，造成輸出電流產生
諧波(圖 14(a))，導致電流波形嚴重失真。其整流器的電流諧波可由傅立葉分析表示: 
2 3 (cos )
1 cos    =6 +1 =1,2,3......
1 cos   =6 -1 =1,2,3......
as dc hps hns
hps
hns
i I t i i
i M t M n n
M
i N t N n n
N



  

 
　  
其中，包含正序諧波 ihps與負序諧波 ihns，且電流總諧波失真率約為 30%左右(圖 14(b))。
負序諧波產生反向旋轉磁場，形成反方向旋轉轉矩引起承軸脈動，減少發電機的出力，而當
電流諧波頻率接近機械元件共振頻率時，將會引起機電共振，使整體結構強度與壽命降低。
轉矩脈動與機電共振都會使風力發電機產生噪音，造成對人體或生物影響。  
      
(a) (b) 
圖 14 二極體整流器電壓、電流實驗波形及電流諧波頻譜 
為了驗證噪音改善之成效，本實驗先由二極體整流器系統進行噪音量測實驗，找出機械
共振所產生較大噪音之轉速點，並量測現場噪音，然後將二極體整流器置換成切換式整流器
系統進行噪音量測實驗，再次量測現場噪音，並將兩者噪音做比較。在此首先定義均能音量
Leq，其為單位時間內之聲壓平均值： 
                          
2
10 0
0
1 ( )10 log
T
eq
p tL dt
T p
                               (11) 
其中 p(t)為測定音壓，單位為帕(Pa)、T 為測定時間、p0 為基準聲壓為 20μPa，由於人耳能聽
到的響度差距極大，因此將以分貝(dB)作為均能音量之單位。而分貝與人耳聽覺的關係大致
上為：當聲壓值變化為 3dB 時，人耳剛好可以分辨，5dB 時可以感覺到顯著的差別，而當聲
  
 
圖 16 在低轉速 81rpm 下切換式整流器噪音振幅與傅立葉分析 
 
圖 17 在中轉速 167 rpm 下傳統二極體整流器噪音振幅與傅立葉分析 
  
 
圖 20 在高轉速 220 rpm 下切換式整流器噪音振幅與傅立葉分析 
 
V.無效功率控制及系統市電併聯之電力品質 
A.1 無效功率控制 
圖 21 為本計畫中之市電側系統測試無效功率補償之實驗架構，其變流器經過 d-q 軸電流
解耦控制，使其具有無效功率補償功能，可在 PCC 補償負載的功率因數(PF)，降低傳輸損失。
為了驗證本系統與控制策略，可以適用於各種負載，本計畫利用電阻性、電容性與電感性負
載進行實驗。 
 
圖 21 系統無效功率補償示意圖 
  
 
圖 24 電容性負載實驗：PCC 之電壓、電流波形 
CH1(v)：200V/div.；CH2(i)：5A/div.；CH3(ix)：2A/div.；
CH4(iqx*)：10V(4.016A)/div.；time：20ms/div.
ix
v
i
iqx*
 
圖 25 電容性負載實驗：PCC 經無效功率補償之電壓、電流波形 
3. 電感性負載： 
當負載變成消耗無效功率之電感性負載，此時 PCC 電流 i 相位領先電壓 v，如圖 26 所示。
此時負載產生的無效電力使功率因數下降至 0.9，經由無效功率補償迴路送出無效電流命令 
iqx*使市電側變流器如同電容器般，提供無效功率，補償電感性負載，如圖 27 所示，使主電
力系統為單位功率因數傳輸。 
 
圖 26 電感性負載實驗：PCC 之電壓、電流波形
  
 
圖 28 轉換器未啟動前轉換系統兩端之電壓、電流波形 
 
圖 29 轉換器啟動後轉換系統兩端之電壓、電流波形 
由以上之實驗結果，可以得知本計畫所研製的市電併聯型風力發電系統，不論在任何大
小的功率傳輸下，都可以得到良好的電力品質，並且利用無效功率補償控制器，使風機側與
市電側的轉換器均可以單位功率因數來進行電力的傳輸。在此可將系統電力品質分析結果整
理於表 3。 
表 3 電力品質與併聯法規分析結果 
項目 風機側 系統 
市電側 
系統 規範 是否符合規範
電壓總諧波失真率 THDv 1.9% 0.7% 5% 符合 
電流總諧波失真率 THDi 3.9% 4.5% 5% 符合 
功率因數 PF 1 1 --- 符合 
 
  
 
圖 31 1.5kW 風力發電系統總架構 
  
電，將電能傳輸至台電系統。並積極進行太陽能發電系統之整合測試。茲將第二年度計
畫的成果整理如下： 
1.  風力發電系統之整合與測試並與市電併聯：本計畫以一部 1.5kW 之永磁同步三相
交流發電機為系統輸入源，透過脈波寬度調變整流器(PWM  rectifier)將三相交流電源轉換
成直流電源，並且利用推挽式升壓轉換器(push‐pull  converter)將計畫裡所使用的輸出電
壓規格48V之蓄電池升壓，最後將推挽式升壓轉換器(push‐pull Converter)之輸出電壓經由
脈波寬度調變變流器(PWM  inverter)與市電併聯傳輸電能至市電。成功的將各個子架構整
合並完成一套完整風力發電系統。 
2.風力發電機的最大功率追蹤：由於風力具有快速變動之特性，本計畫比較改良型
擾動觀察法與直接查表法兩種最大功率追蹤法，找出最合適之最大功率演算法。雖然改
良型擾動觀察法能夠有效追蹤風速的變化，但是直接查表法的能量轉換效率比改良型擾
動觀察法的能量轉換效率佳，且直接查表法追蹤速度較快也較容易操作在最大功率點
上。故本計畫之風力發電系統將以直接查表法作為風力發電最大功率之演算法。 
3.整合風力及太陽能發電系統與市電系統併聯測試：本計畫在風力發電系統與市電
併聯部分，將 1.5kW 之風力發電系統完成，可以觀察出當風速上升或下降時，轉速與電
能能夠跟著改變，穩定的操作且轉速所儲存的動能不會被損耗殆盡。並且發現當轉速只
需要略高一點，依據風力機的特性其電能立即上升，只要轉速略降一點輸出之電能很快
的下降，但是依然可以操作於最大功率曲線上。且由最大功率追蹤暫態響應實驗，可發
現於 PWM 整流器啟動後，風力機電流波形為弦波波形，有效改善電力品質。在太陽能
發電系統與市電併聯部分，將太陽能發電系統進行整合實測，由實驗結果可以發現，當
太陽發電系統啟動時，經由最大功率演算法，能夠穩定的工作於最佳工作點上，並即時
輸出最大電能。再將兩種發電系統經由後級升壓轉換器，提升電壓等級，由變流器以調
變技術達成低諧波失真率，功率因數為 1，使其最大實功輸出，將電能傳輸至市電。 
D. 第三年 
第三年度計畫將第二年度整合之 1.5kW 風力發電系統在做進一步效能提升。首先在風機
側的最大功率追蹤控制方面利用能量效率公式，來驗證直接查表法的效益，其次在風力
發電機噪音抑制方面，採用切換式整流器取代傳統二極體整流器，大幅了降低系統因電
流諧波所產生的機電共振噪音。最後在市電側的無效功率控制及併聯市電之電力品質方
面，使系統在 PCC 具有無效功率補償的性能，並維持良好的電力品質併聯於市電。茲將
第三年度計畫的成果整理如下： 
1.風力發電系統之整合測試並與市電併聯：本計畫以一部 1.5kW 之永磁同步三相交
流發電機為系統輸入源，透過脈波寬度調變整流器將三相交流電源轉換成直流電源，並
且利用推挽式升壓轉換器將計畫裡所使用的輸出電壓規格 48V 之蓄電池升壓，最後將推
挽式升壓轉換器之輸出電壓經由脈波寬度調變變流器與市電併聯傳輸電能至市電。成功
的將各個子架構整合並完成一套完整風力發電系統。 
  
第八屆電力電子研討會, 2009. 
9. 陳偉倫, 卞均浩, 蘇益立 ” 容量可回復型靜態同步補償器之設計及製作,” 第八屆電力
電子研討會, 2009. 
10. 陳裕心, 陳偉倫, ”以 PIC 微處理器為基礎之新型串聯鉛酸蓄電池平衡充電器設計,” 電子
工程研討會, June, 2009. 
11. W.L. Chen, Chun-Hao Pien and Yung-Ping Feng, “Design of an FPGA-based Space Vector 
PWM Generator for Three-phase Voltage-Sourced Inverters,” 2nd IEEE International 
Conference on Power and Energy, 2008. (Malaysia) 
12. 丁瑞霖, 陳偉倫, 翁川翔, 許源浴, ”靜態同步補償器應用於感應發電機併聯電力系統”,中
華民國第二十九屆電力工程研討會, 2008. (Tainan) 
13. W.L. Chen, Yung-Ping Feng and Chun-Hao Pien, “A Simple Approach to the Realization of an 
FPGA-based Harmonic Elimination PWM Generator,” ICEM’08- XVIII International 
Conference on Electrical Machines, 2008. (Portugal) 
14. 余家宏, 林永祥, 馮詠評, 陳偉倫,”應用於市電併聯型太陽光電能轉換系統最大功率追蹤
控制之新型擾動觀察法設計”, 第七屆台灣電力電子研討會暨展覽會, 2008. (Tainan) 
 
 
(第二年計劃期間所發表論文 1-8) 
1. Woei‐Luen  Chen,  S.‐C.  Chen,  C.‐C.  Chen,  and  Y.‐Y.  Shih,  ”Patient‐driven  loop  control  for 
ambulation  function  restoration  in  a non‐invasive  functional electrical  stimulation  system,” 
Disability and Rehabilitation,   vol. 32, no. 1, pp. 65‐71, 2010. SCI.   
2.  Woei‐Luen Chen, W.‐H. Chang, C.‐C. Chen and Y.‐Y. Shih, ”Ambulation study of a woman with 
paraplegic using a reciprocating gait orthosis with functional electrical stimulation in Taiwan,” 
Disability and Rehabilitation, vol. 4, no.6, pp.429‐438, 2009. SCI. 
3. 翁川翔,  陳偉倫,  李龍安,  劉建宏,  許源浴  “雙饋式感應發電機動態特性之模擬,”中華民
國第三十屆電力工程研討會, 2009. (Taipei)   
4. 梁維綱,  陳偉倫,  ”直接電流向量控制型感應馬達驅動器設計及製作,”  中華民國第三十屆
電力工程研討會, 2009. (Taipei)   
5. Woei‐Luen Chen,  I‐Li Su, and Jian‐Der Lee, “Design of a gain scheduling photovoltaic energy 
conversion  system,”  IEEE  Symposium  on  Industrial  Electronics  &  Applications,  2009. 
(Malaysia)   
  
[1] 陳偉倫,林育煌,高嘉宏,徐聖宗,“具噪音抑制作用之風力發電機控制方法與裝置＂,中
華人民共和國專利 
[2] 陳偉倫,林育煌,高嘉宏,徐聖宗,“具噪音抑制作用之風力發電機控制方法與裝置＂，中華
民國專利 
(本計畫成果所發表之碩士論文) 
第二年 
蘇益立，「市電併聯型風力發電系統實現」，長庚大學碩士論文，2009 
第三年 
林育煌，「具功因校正及諧波改善之市電併聯型風力發電系統研製」，長庚大學碩
士論文，2010 
參考文獻 
[1] M. G. Simoes, B. K. Bose, and R. J. Spiegel, “Design and performance evaluation of a 
fuzzy-logic-based variable-speed wind generation system,” IEEE Trans. on Industry 
Applications, vol. 33, no. 4, pp. 956-965, 1997. 
[2] M. Naidu and J. Walters, “A 4-kW 42-V induction-machine-based automotive power 
generation system with a diode bridge rectifier and a PWM inverter,” IEEE Trans. on Industry 
Applications, vol. 39, no. 5, pp. 1287-1293, 2003. 
[3] 蘇益立，「市電併聯型風力發電系統實現」，長庚大學電機所碩士論文，2010。 
 
 2
e-Networked Industrial Ecosystem, 6. Factory Automation, 7. Green IT, 8. 
Human, Computer and Machine Interface, 9. Industrial Informatics 
Applications, 10. Information Security, Safety and Trust, 11. 
Infrastructure and Technology, 12. Mechatronics and Robotics, 13. 
Sensing and Communication Technologies, 14. Service-oriented 
Architectures, 15. Supply Chain Management and Loqistics 等等。
Special sessions則有1. Advanced Software Engineering in Industrial 
Automation, 2. Bio-Inspired Methods, Techniques and Algorithms, 3. 
Energy and Information Technology, 4. Self-X and Autonomous Control 
in Mechatronics and Production, 5. Knowledge-based Medical 
Informatics Applications and Medical Decision Support Systems, 6. 
Manufacturing Scheduling, 7. Modern Software Engineering Methods 
and Approaches in Industrial Automation, 8. Service Engineering, 9. 
Embedded Systems & Reconfigurable SoCs, 10. Mobile/Wireless 
Communication Network as an Industrial Infrastructure, 11. P2P and 
Content Distribution Networking Technologies and Their Industrial 
Applications。筆者所發表之論文歸屬於” Information Security, Safety 
and Trust”領域，題目為"Reversible data hiding based on histogram 
modification of SMVQ indices”。重點在探討如何透過直方圖重排，提
高機密資料的隱藏量。由於實驗結果比以往方法來得好，故引起多人
之興趣，並向筆者索取更詳細的資料。同時筆者亦受邀擔任此session
的主席。  
 
二、與會心得與建議  
 
本次大會所在地-大阪，是亞洲著名的大都市，亦有相當豐富的歷
史古蹟，如大阪城公園、天守閣、天王寺等。會議所在地大阪大學"
 4
各地研究人員互相交流，獲得相當豐富之寶貴經驗，也體會影像處理
技術在工業資訊的廣泛應用，將是必然的趨勢，因此，建議學校能多
支援此相關領域的研究計畫。 
此次會議，主辦單位費了很多心力，使得整個會議過程順利，美
中不足的是，各個 session 分布在不同樓層，因此聽講過程如欲更換
session，便得上下樓層，往返較費時。但綜合來說，此會由於所發表
的論文相關性極高，參與學者互動密切，都有不錯的收獲。此次會議
堪稱是次成功的會議，。 
三、攜回資料名稱及內容 
 
1. 會議論文集光碟片。 
2. 相關期刊樣本 
 
 
圖一 大阪大學"中之島"會議中心 
 
encoding index will be denoted as an SOC or OIV codes 
and replace with a d-bits code or remain unchanged. In 
addition, in [19], Yang and Lin extends Chang et al.’s 
scheme [3] in which the VQ codebook is divided into 2B 
clusters and half of these clusters are used to embed secret 
data, where B denotes the size of the secret data embedded 
into each VQ index. 
In order to restore the original image and increase 
hiding capacity, based on the distribution of transformed 
image and inspired from the Chang et al.’s scheme [3], this 
paper proposes a novel reversible data hiding scheme in the 
SMVQ-compressed domain. The remainder of this paper is 
organized as following. The proposed scheme is detailed in 
section 2. The experimental results and performances 
comparison of our scheme and previous approaches are 
included in section 3. Section 4 is conclusions. 
2. THE PROPOSED SCHEME 
The grayscale cover image C with the size N*M is 
partitioned into small non-overlapping blocks of n*m pixels. 
In this case, cover image is partitioned into (N/n)*(M/m) 
blocks. Each block of the image can be encoded by using 
VQ. Finally, a block of the image is only represented with 
an index of the nearest codeword in codebook. 
N
um
be
r o
f i
nd
ic
es
 
 Index value 
Fig. 1 The histogram of compressed image 
(image: Lena) 
A compressed image, denoted as I, consists of all the indices, 
also named as compression code. The size of compression 
code is proportioned to the number of codewords of the 
codebook. 
N
um
be
r o
f i
nd
ic
es
 
 Index value 
Fig. 2 The histogram of transformed image 
(image: Lena) 
The transformed image can be obtained by using SMVQ to 
the compressed image. To reconstruct the original image 
completely, the size of state codebook and that of codebook 
are set to be same. For each index of compressed image, a 
transformed index can be got in such a way. The histograms 
of the compressed image and the transformed image, in 
codebook size 256, for image “Lena” are shown in Fig. 1 
and Fig. 2, respectively. Most of the transformed indices 
distribute around zero. 
2.1 Classification of indices 
The transformed image, normally distributed around 
zero, is generated by using the SMVQ to VQ compressed 
image. The transformed image almost spans by the 
transformed indices with the smallest values. The indices in 
a transformed image are first categorize into three portions, 
i.e., portion 1, portion 2, and portion 3, respectively, with 
distinct sizes for the purpose of hiding secret data; 
meanwhile, the indices in portion 1 with the smallest values 
and the indices in the portion 3 with the largest values. 
Suppose that the size of state codebook, which is same as 
the size of VQ codebook, is H. For n < m < H and n, m ∈  N, 
the portion 1 includes the indices with values between 0 and 
n-1. The portion 2 includes the indices with values between 
n and m-1. The portion 3 includes the indices with values 
between m and H-1. The indices belonging to portion 1 are 
used to hide secret data and reconstruct image. The indices 
belonging to portion 2 are used to compress code stream and 
reconstruct image. The indices belonging to portion 3 are 
only used to reconstruct image. Compared to the Chang et 
al.’s scheme [3] using referred counts to sort codebook, the 
proposed scheme using distribution of indices to categorize 
the transformed indices into three portions. There are great 
amount of transformed indices located in portion 1. 
Since transformed indices are partitioned into three 
portions, some leading codes (indicators) are required to 
distinguish the three portions as shown in Table 1. 
Table 1 Indicator for each portion 
portion categorization 
portion 1 portion 2 portion 3 
indicator(binary form) 
indicator1(0) indicator2(10) indicator3 (11) 
2.2 Encoding 
Suppose that the size of secret data, sd, is s bits. For the 
encoding process, an encoding index belonging to portion 1 
is denoted by x1 and the encoded index is denoted by x1’. 
Then, the x1’ is expressed as Eq. (1). 
x1’= indicator1 || x1*2**s+sd  (1) 
Suppose that the size of encoding space for each 
embeddable transformed index is E-bit. In order to restore 
the index from encoded index, the hiding space of the each 
index would be reduced to ⎣ ⎦*E/n)*(2log2 . The larger the n 
is, the more the number of embeddable indices. Accordingly, 
the hiding space of each index is significantly reduced. 
An encoding index belonging to portion 2 is denoted by 
x2 and the encoded index is denoted by x2’. Then, the x2’ is 
expressed as Eq. (2). 
x2’= indicator2 || (x2-n) (2) 
467
cover images. The codebooks with 128, 256, 512 and 1024 
16-dimensional codewords were trained by the LBG [20] 
algorithm with “airplane”, “boat”, “lena”, “pepper”, and 
“sailboat” as the training images. These codebooks are used 
to evaluate the compression performance between the 
proposed scheme and the others. There are 16384 
compression codes (indices) created when an image sized 
512*512 is encoded by using VQ of which codebook with 
16-dimensional codewords. 
Bit rate (BR) used here is defined in Eq. (8), where ||x|| 
denotes the size of x. A compression method with a smaller 
BR means that the method has a better compression 
performance and vice versa. 
BR= ||code stream|| / ||image||  (8) 
For image “Lena”, the largest embedding capacities are 
52180, 56315, 58200, and 59330 bits for codebook size 128, 
256, 512, and 1024, respectively. Besides, the variation of 
the embedding capacities of cover image is 7k bits for 
different codebook size. Furthermore, for image “House”, 
the largest embedding capacities are 41970, 44335, 45090, 
and 45640 bits for codebook size 128, 256, 512, and 1024, 
respectively. The variation of the embedding capacities of 
cover image is 4k bits for different codebook sizes. 
Moreover, all of the BRs of the two images are less than VQ 
BR.  
The numbers of indices of portion 1 and portion 2 are 
denoted as Np1 and Np2, respectively. The above two images 
have the largest embedding capacity and smaller BR when 
(Np1, Np2, Codebook size) is (2, 8, 128), (4, 16, 256), (8, 32, 
512), and (16, 64, 1024), respectively. The embedding 
capacity may not increase with the number of indices of 
portion 1 increasing. That is because increasing the number 
of indices of portion 1 will reduce the hiding space of each 
index of portion 1. The simulation results (normal hiding) 
for various test images are shown in Table 2. They are 
obtained with (Np1, Np2, Codebook size) are (2, 8, 128), (4, 
16, 256), (8, 32, 512), and (16, 64, 1024), respectively. For 
each codebook size, the values of BR are smaller than that 
of VQ BR. For codebook size 128, 256, and 512, the larger 
codebook size is, the more embedding capacity is. There is a 
little bit variation for the difference of embedding capacity 
between codebook size 512 and 1024. When codebook size 
is 128, 256, 512, or 1024, the embedding capacity is on 
average 3.0, 3.3, 3.4, 3.3 bits per index, respectively. In the 
proposed scheme, due to the indices of portion 1 can support 
high embedding capacity and the indices of portion 2 can 
support high compression rate, the proposed scheme has 
very high embedding capacity and compression efficiency. 
To demonstrate the superiority of the proposed scheme, 
we compared it with the Chang et al.’s [3] scheme, theYang 
and Lin’s [19] scheme, and the Shie and Lin’s [18] scheme, 
respectively. Here, the codebooks size for all the schemes 
are set to be 256 and 512. The comparisons are shown in 
Table 3 and Table 4. The embedding capacity and BR of the 
Chang et al.’s[3] scheme, embedded one and two bits secret 
data into each index value, are shown in left side of Table 3. 
The embedding capacity and BR of the Yang and Lin’s [19] 
scheme, embedded one and two bits secret data into each 
index value, are shown in middle side of Table 3. The EC 
and BR of the proposed scheme (under hiding), an index is 
encoded by log
2
(cs)-1, log
2
(cs)-2, or log
2
(cs)-3 bits are 
shown in right side of Table 3. Encoded bits is log
2
(cs)-1 for 
the proposed scheme and embedding two bits secret data 
into each index value for the other schemes in codebook size 
256 and 512. One can observe that each of the embedding 
capacity and BR of the proposed scheme are superior to 
those of other schemes. 
Table 2 Simulation results (normal hiding) for various test 
images 
image 
Codebook size/VQ BR 
128 / 0.438 256 / 0.500 512 / 0.563 1024 / 0.625
Np1 / Np2 
2 / 8 4 / 16 8 / 32 16 / 64 
 EC  
BR 
airplane 51795 57345 59885 60645 0.426 0.491 0.555 0.618 
lena 52180 56315 58200 59330 0.415 0.463 0.544 0.610 
peppers 52905 57325 60300 60030 0.415 0.481 0.546 0.608 
boat 43875 44230 43570 42785 0.419 0.481 0.542 0.605 
sailboat 46080 48965 49205 46480 0.420 0.485 0.544 0.603 
tiffany 57845 64865 65290 63115 0.420 0.487 0.551 0.613 
house 41970 44335 45090 45640 0.428 0.490 0.554 0.618 
elaine 49870 55430 58630 57075 0.406 0.472 0.534 0.600 
 
Especially, each of the embedding capacity of the proposed 
scheme is much larger than those of other schemes. 
Furthermore, less embedding capacity and lower BR are 
required occasionally. The proposed scheme, encoded bits is 
log
2
(cs)-2, or log
2
(cs)-3, or the other schemes, embedding 
one bit secret data into each index value, in codebook size 
256 and 512 satisfy this requirement. In this case, the 
embedding capacity and BR of the proposed scheme are still 
superior to those of other schemes. That is, Table 3 shows 
that the proposed scheme has the best performance, 
followed by the Yang and Lin’s scheme, and then the Chang 
et al.’s scheme. 
In general, a data hiding method with a smaller value of 
BR and a larger value of embedding capacity mean that the 
method has a better performance for data hiding and 
compression. Furthermore, the smaller value of BR is to be 
at variance with the larger value of embedding capacity. 
469
image is proposed. The proposed scheme is not only hiding 
secret data into a VQ compressed image but also able to 
restore the original image after secret data extraction. In 
addition to this, our proposed scheme has the best 
efficiency compared with previous schemes in various 
codebook sizes for eight test images. 
ACKNOWLEDGEMENT
This work was partially supported by National Science 
Council, R.O.C. under Grant No. NSC98-2220-E-182-002 
REFERENCES
 [1]  C.-C. Chang, G.-M. Chen, M.-H. Lin, Information 
hiding based on search-order coding for vq indices, 
Pattern Recognition Letters 25 (11) (2004) 1253 – 
1261. 
[2]  C.-C. Chang, Y.-P. Hsieh, C.-Y. Lin, Lossless data 
embedding with high embedding capacity based on 
declustering for vq-compressed codes, Information 
Forensics and Security, IEEE Transactions on 2 (3) 
(2007) 341–349. 
[3]  C.-C. Chang, W.-C. Wu, Y.-C. Hu, Lossless recovery 
of a vq index table with embedded secret data, Journal 
of Visual Communication and Image Representation 
18 (3) (2007) 207 – 216. 
[4]  C.-C. Chang, T. D. Kieu, Y.-C. Chou, Reversible 
information hiding for vq indices based on locally 
adaptive coding, Journal of Visual Communication 
and Image Representation 20 (1) (2009) 57 – 64. 
[5]  J. Tian, Reversible data embedding using a difference 
expansion, Circuits and Systems for Video 
Technology, IEEE Transactions on 13 (8) (2003) 890–
896. 
[6]  S. C. Shie, S. D. Lin, C. M. Fang, Adaptive data 
hiding based on smvq prediction, IEICE Trans. 
Information and Systems E89-D (2006) 358– 362. 
[7]  M.-N.Wu, C.-C. Lin, C.-C. Chang, An embedding 
technique based upon block prediction, Journal of 
Systems and Software 81 (9) (2008) 1505 – 1516. 
[8]  W.-C. Du, W.-J. Hsu, Adaptive data hiding based on 
vq compressed images, Vision, Image and Signal 
Processing, IEE Proceedings - 150 (4) (2003) 233–238. 
[9]  C.-L. Tsai, H.-F. Chiang, K.-C. Fan, C.-D. Chung, 
Reversible data hiding and lossless reconstruction of 
binary images using pair-wise logical computation 
mechanism, Pattern Recognition 38 (11) (2005) 1993 
– 2006. 
[10]  Z. Ni, Y.-Q. Shi, N. Ansari, W. Su, Reversible data 
hiding, Circuits and Systems for Video Technology, 
IEEE Transactions on 16 (3) (2006) 354–362. 
[11]  C.-K. Chan, L. M. Cheng, Hiding data in images by 
simple lsb substitution, Pattern Recognition 37 (3) 
(2004) 469 – 474. 
[12]  C.-T. Hsu, J.-L. Wu, Hidden digital watermarks in 
images, Image Processing, IEEE Transactions on 8 (1) 
(1999) 58–68. 
[13]  G. Langelaar, R. Lagendijk, Optimal differential 
energy watermarking of dct encoded images and video, 
Image Processing, IEEE Transactions on 10 (1) (2001) 
148–158. 
[14]  Y. Wang, J. Doherty, R. Van Dyck, A wavelet-based 
watermarking algorithm for ownership verification of 
digital images, Image Processing, IEEE Transactions 
on 11 (2) (2002) 77–88. 
[15]  S. Mallat, A theory for multiresolution signal 
decomposition: the wavelet representation, Pattern 
Analysis and Machine Intelligence, IEEE Transactions 
on 11 (7) (1989) 674–693. 
[16]  G. Xuan, J. Zhu, J. Chen, Y. Shi, Z. Ni, W. Su, 
Distortionless data hiding based on integer wavelet 
transform, Electronics Letters 38 (25) (2002) 1646–
1648. 
[17]  G. Xuan, Y. Shi, Z. Ni, J. Chen, C. Yang, Y. Zhen, J. 
Zheng, High capacity lossless data hiding based on 
integer wavelet transform, in: Circuits and Systems, 
2004. ISCAS ’04. Proceedings of the 2004 
International Symposium on, Vol. 2, 2004, pp. II–29–
32 Vol.2. 
[18]  Shih-Chieh Shie, Shinfeng D. Lin, Data hiding based 
on compressed VQ indices of images, Computer 
Standards & Interfaces. 31 (6) (2009) 1143-1149. 
[19]  Cheng-Hsing Yang, Yi-Cheng Lin, Reversible data 
hiding of a VQ index table based on referred counts, 
Journal of Visual Communication and Image 
Representation. 20 (6) (2009) 399-407. 
[20]  Y. Linde, A. Buzo, R. Gray, An algorithm for vector 
quantizer design, Communications, IEEE Transactions 
on 28 (1) (1980) 84–95. [26] T. Kim, Side match and 
overlap match vector quantizers for images, Image 
Processing, IEEE Transactions on 1 (2) (1992) 170–
185. 
[21]  Image Database: http://sipi.usc.edu/database. 
[22]  M. Jo, H. D. Kim, A digital image watermarking 
scheme based on vector quantization, IEICE Trans. 
Information and Systems E85-D (2002) 1054–1056. 
[23]  S. C. Shie, S. D. Lin, and C. M. Fang, Adaptive data 
hiding based on SMVQ prediction, IEICE Trans. 
Information and Systems E89-D (2006) 358-362. 
[24]  C.-C. Chang, W.-L. Tai, C.-C. Lin, A reversible data 
hiding scheme based on side match vector 
quantization, Circuits and Systems for Video 
Technology, IEEE Transactions on 16 (10) (2006) 
1301–1308. 
471
我主要對於IC設計相關的論文有較多的關注，像是“Towards a Language 
Based Synthesis of NCL Circuits”、“Design and Development of B2B 
e-Commerce Framework for Malaysian SMEs”。在DATICS-IMECS 2011學
者分別來自不同國家，有法國、香港、中國與台灣，彼此的研究領域非
常多樣化，主要都是分享在各自領域的研究發展現況；在會場除了了解
其他各國學者的研究成果與經驗外，在會後我們也相互討論並交換意
見；透過這樣的方式更深入了解一些有興趣的議題，也讓本人研究上能
夠不斷獲取新知。 
 
二、 與會心得  
IMECS 2011會議提供工程以及電腦科學領域的學者，可以透過此項
國際會議，與其他各國的學者的研究方向交流經驗並且分享心得。同
時，大家可以透過會議中的報告與討論，了解不同國家(以亞洲國家居多)
的科技發展，以及研究特色，對彼此的未來研究幫助匪淺。IMECS 2011
是由許多會議所共同合辦，因此在當天還有許多的會議在進行，像是
ICEE、ICIE、ICCS、ICCSA等其他14個會議，有許多與會學者甚至同時
參與兩個以上的會議，藉此增廣了大家的研究討論範疇，不僅是單純侷
限於特定領域，這是過去參加其它會議所少有的經驗。 
本次我們研究團隊所發表的論文是研究高精準度、高偵測線性度的
工作電壓雜訊偵測電路設計，藉此設計可偵測晶片內工作電壓雜訊的分
布情形，藉此提升晶片設計的良率與可靠度，並且在這次會議中，與
session chair 進行了一些意見交換，對於我們的設計上也得到了許多建
設性的建議，尤其是在設計成本、電壓源的設計與使用、實驗分析與設
計、以及訊號源的取得方面都有許多意見交流，讓我們收穫良多。這次
DATICS-IMECS 2011 會議所拍攝的幾張照片，與大家一起分享。 
 
 
 
 
DATICS 2011 會議會場 香港帝苑酒店 
 
 
A Precise Power Supply Noise Detector with High-
Linearity 
I-Chyn Wey, Chien-Chang Peng, Yu-Jiang Liao, and Yu-Sheng Yang 
  
Abstract 
   In this paper, we proposed a noise detector with high 
linearity in CMOS 0.18um process. By removing the 
precharging capacitor, we can provide a stable charging 
voltage source to enhance power supply noise detection 
linearity from 0.9291 to 0.9986. By using separated supply 
voltage sources, we set the detection path with a higher 
supply voltage of 2.5V to turn on the detection circuitry 
immediately when supply voltage drops. In this way, the 
noise detection range can be enlarged and the noise 
detection accuracy is improved by 4.94 times. 
Key Words: Precise, Power Supply Noise, Noise Detector, 
High Linearity. 
I. Introduction 
    In recent years, due to the progress of CMOS technology, 
not only the transistor size is scaled down, the supply 
voltage is also lowered as well as threshold voltage. 
Lowering power supply voltage leads to lower power 
consumption; however, noise does not decrease while the 
supply voltage is downward. To solve the noise issues in 
VLSI designs, we must first detect the behavior, 
distribution, and size of noise to build the understanding of 
noise interference. The type of noise can be classified as 
switching impulse noise, power supply noise (PSN), and 
substrate noise [1], [2]. For different noise sources, we must 
apply different techniques to detect them [1]-[10]. In this 
paper, we focus our attention on PSN detection. 
    Nowadays there are some built-in noise detection circuits 
[3]-[6] that have been proposed to measure the distribution 
of noise signals in a VLSI chip. High linearity and high 
precision are two design goals in PSN detection circuits 
design. The built-in self noise detection circuits in [3], [4] 
are constructed by a source follower and a transconductance 
amplifier. These designs can detect the noise in real time. 
 
Manuscript received Oct. 1, 2010; revised Jan. 6, 2011. This work was 
supported in part by NSC 99-2220-E-182-001 and supported by National 
Chip Implementation Center, Taiwan, for the chip implementation. 
I-Chyn Wey is with Graduate Institute of Electrical Engineering, 
Electrical Engineering Department, and Green Technology Research 
Center, Chang-Gung University, Taiwan. E-mail: icwey@mail.cgu.edu.tw. 
Chien-Chang Peng is with Graduate Institute of Electrical Engineering, 
Chang-Gung University, Taiwan. 
Yu-Jiang Liao is with Electrical Engineering Department, Chang-Gung 
University, Taiwan. 
Yu-Sheng Yang is with Electrical Engineering Department, Chang-
Gung University, Taiwan. 
 
However, the detection results translated from 
transconductance amplifier are non-linear. As for the 
concurrent power supply noise detection technique [5], it 
can provide an output error message upon the occurrence of 
power supply noise. However, it only shows the noise is 
detected or not detected, we cannot get the detail noise 
information. For the power supply noise monitoring circuit 
[6], the detected signals are analog signals, which can 
reveal the detected noise voltage peak values. Nevertheless, 
the noise detection range is limited because the noise 
amplitude peak value cannot be detected before the 
charging transistor is turned on. In addition, the detected 
PSN signal is affected by the variance of charging voltage, 
which leads to non-linear PSN detection results. 
To remove the unstable charging voltage source in 
[6], we remove the precharging capacitor Cr and charge the 
capacitor Cx by using an independent power supply with 
higher supply voltage of 2.5V. By this way, the output 
dynamic range is enlarged to 4.04 times and the detection 
accuracy can be enhanced by 4.94 times. 
II. The Existing PSN Detection Circuits 
    Built-in power supply noise detecting circuit [3]-[4], 
consists of a source follower (SF) that senses power supply 
noise voltage and a transconductance amplifier (Gm) that 
converts the SF’s output voltage to current signal Iout. The 
detected PSN can be directly observed through Iout. The 
benefit of built-in detecting circuit lies in its small size, 
real-time output and the detected noise voltage or current 
value that can be observed directly. However, the detection 
results translated from transconductance amplifier and 
source follower are non-linear. 
Concurrent power supply noise detection technique [5] is 
designed based on a self-checking scheme which 
concurrently monitors a signal of the system clock 
distribution network. It can provide an output error message 
upon the occurrence of power supply noise. The benefit of 
concurrent detecting method lies in its digital output, which 
is hardly interfered by noise. But we can only know the 
scope of noise rather than its accurate value. 
The power supply monitoring circuit [6] is to measure the 
power supply noise through its effect on the propagation 
delay of an inverter chain. The total charge flow to Cx is 
proportional to the propagation delay of the inverter chain. 
While the propagation delay of the inverter chain is 
proportional to the supply voltage, and the supply voltage is 
However, when the charging voltage increases, the delta Vx 
will reach saturation and the linearity of PSN detection can 
no more be held. To find out the highest PSN detection 
linearity, we compare the PSN detection linearity among 
different charging supply voltages. To evaluate the 
detection linearity of PSN detector, we define the relevance 
between the ideal expected PSN value and the real detected 
PSN value as PSN detection linearity, which is defined as 
   
   
1
2 2
1 1
Relevance (r) =                          (1)
n
i i
i
n n
i i
i i
x x y y
x x y y

 
  
  

 
 
As illustrated in Fig. 4, we can achieve a higher PSN 
detection linearity of 0.9986 by selecting the maximum 
charging voltage of 2.5V. As a result, the VDDH value is 
set as 2.5V to acquire the higher PSN detection linearity. 
The size of output capacitor also affects the PSN detection 
linearity. Based on the analytical results, we select the 
capacitance of 0.4pF as the output capacitor with the PSN 
detection linearity of 0.9986. As a result, the PSN can be 
read clearly with 4.04 times larger average detected PSN 
voltage difference as compared with the conventional 
design in [6], as shown in Fig. 5. The linearity can also be 
enhanced from 0.9291 to 0.9986. 
 
Fig. 3 Comparison of Vx variation under various power supply 
noise pulse amplitude in the proposed PSN detection circuit versus 
the state-of-art PSN detector in [6] 
 
Fig. 4 Analysis of various charging supply voltage for higher PSN 
detection linearity 
 
Fig. 5 Comparison of detected output voltage difference in the 
state-of-art PSN detector in [6] and the proposed PSN detector 
 
Fig. 6 Comparison of PSN detection error in the state-of-art PSN 
detector in [6] and the proposed PSN detector 
To evaluate the PSN detection accuracy, we define the 
PSN detection error as: 
Detection Error = 100%                  (2)X X
x
V V
V
   
As illustrated in Fig. 6, the PSN detection resolution in [6] 
is limited to around 100mV and the average PSN detection 
error is 75.265%. Under the case with 100mV PSN 
detection resolution, the PSN detection error can be 
lowered to 15.246 % in our proposed PSN detection circuit. 
The reason that makes our improvement effective is that we 
successfully raise the charging voltage to enhance the PSN 
detection range and provide an independent stable charging 
path to improve PSN detection linearity. 
To evaluate the PSN detection performance, we 
summarize the comparison results in Table 1. In the 
proposed PSN detector, the PSN detection linearity can be 
improved from 0.9291 to 0.9986 in terms of relevance. The 
detected output variance can be enlarged from 15.82mV to 
79.75mV. Therefore, the output dynamic range can be 
enlarged to 4.04 times. Moreover, the PSN detection error 
can also be reduced from 75.27% to 15.25%. As a result, 
the noise detection accuracy can be improved by 4.94 times. 
國科會補助專題研究計畫項下出席國際學術會議心得報告 
                                     日期：100 年 6 月 29 日 
 
計畫編號 NSC99－2220－E－182－001－  
計畫名稱 應用於風力太陽能發電系統之多模節能最大功率追蹤晶片之開發
(3/3) 
出國人員
姓名 曾聖有 
服務機構
及職稱 長庚大學助理教授 
會議時間 
100 年 6 月 21 日
至 
100 年 6 月 23 日 
會議地點 中國北京 
會議名稱 
(中文)工業電子及應用研討會 
(英文) IEEE conference on Industrial Electronics and 
Applications (ICIEA2011) 
發表論文
題目 
(中文)使用快速響應之混合式昇壓/返馳轉換器於電擊槍應用 
(英文)High Voltage Generator using Rapid Response Boost/Flyback 
Converters for Stun Gun Applications 
(中文)採用無損耗多組輸出之輔助電源供應器 
(英文)Multi-output Auxiliary Power Supply with Lossless Snubber 
(中文)採用多組交錯式升降壓轉換器應用於反射式充電器 
(英文)A Reflex Charger Realized by Multi-interleaved Buck-Boost 
Converters 
 工業電子及應用研討會著重於理論與實務結合，會議期間有專業人士的專題報告及
各國電機專家論文發表與討論。21 日參加三場專家論文發表與討論及專業人士的專題報
告，其中所參加三場專家論文發表與討論分別為能量管理與控制系統、切換式電路與電
力轉換器及海報張貼主題的論文發表；而專業人士的專題報告則是＂雲端運算在製造領
域的應用＂。22 日聆聽一場論文發表與討論，主題為能量管理與控制系統；同時發表兩
篇論文，分別為＂High Voltage Generator using Rapid Response Boost/Flyback 
Converters for Stun Gun Applications”及” A Reflex Charger Realized by 
Multi-interleaved Buck-Boost Converters”，晚上參加研討會所舉辦的晚宴。23 日聆
聽兩場論文發表與討論及發表一篇論文，其聆聽論文發表主題分別為＂非線性系統＂
及＂電力元件管理＂；而發表的論文主題為＂ Multi-output Auxiliary Power Supply 
with Lossless Snubber＂。由於 6/23 日結束已經下午 6 點，因此於 6 月 24 日中午才從
北京搭機返台，為第六屆工業電子及應用研討會劃下完美的句點。 
二、與會心得 
IEEE 的「工業電子及應用研討會」是電機相關領域中重要的年會之ㄧ。與會之專
家、學者均來自世界各國研究或從事通訊、控制、電力系統及電能轉換器之菁英，因此
能夠參加 2011 的「第六屆工業電子及應用研討會」機會非常難得。尤其在各專業論文
發表的場次中，吸取各國專業人才辛苦的研究與技術開發的成果，獲益良多。 
    此次會議議程，主要涵蓋兩大主題：<一>專業人士的專題報告、<二>電機領域專家
論文發表與討論。在專業人士的專題報告方面，共舉行三天，總共有六個議題被討論，
分別為＂ 雲端運算在製造領域的應用＂、＂下一代的生物辨識系統＂..等等轉題演
三、建議 
此次參加研討會看到大陸很多學生參與會議，同時在研討會上發表其研究的論文，
其表現皆很好。雖然國內也有一些名額補助學生出國參加研討會，若能增加補助名
額或是鼓勵國內各大學舉辦國際研討會，此將可增加學生的國際觀及訓練學生的英
文能力。 
四、攜回資料名稱及內容 
    2011 6th IEEE conference on Industrial Electronics and Applications 
   光碟片*1 
 
                                    
A variant of the RCD type snubber is adopted for the multi-
output flyback converter. The RCD snubber in Fig. 1 can be 
placed in parallel with the switch, as shown in Fig. 4. In order 
to recover the energy trapped in leakage inductor of transfor-
mer, the resistor 1R  in the RCD snubber can be replaced by a 
transformer coupled to the output, resulting in the circuit in Fig. 
5. It can be seen that the proposed snubber can recover the 
energy trapped in leakage inductor to output load and thus in-
creases the overall efficiency. Fig. 6 shows the complete circui-
try with five sets of output. 
II. OPERATIONAL PRINCIPLES OF THE PROPOSED 
AUXILIARY POWER SUPPLY
In order to simplify the analysis of the proposed snubber, 
the one output converter as shown in Fig. 5 is considered in the 
analysis. Operation of this circuit can be divided into seven 
operation modes, and suppression of transistor surge voltage is 
different in each mode.  In Fig. 7, (a)~(g), the operational prin-
ciples corresponding to each mode are illustrated. From the key 
waveforms shown in Fig. 8, the detail operation of this conver-
ter can be clarified. 
M1
Vi
Tr1
1:N
N1 N2
D2
CO RO
C1
LK
Lm
D1R1
Figure 1. Schematic diagram of flyback converter with  conven tional
RCD snubber. 
M1
Vi
Tr1
1:N
N1 N2
D2
CO RO
C1
D1
LK
Lm
D 2
L1
Figure 2. Sch ematic d iagram of flyback converter with lossless 
LCD snubber. 
M1
V i
Tr1
1:N
N 1 N 2
D2
CO RO
C 1
L K
Lm
M 2
Figure 3. Schematic diagram of flyback converter with conven tional 
active clamp circuit. 
M1
Vi
Tr
1 :N
N1 N2
D2
CO RL
LK
Lm
C1
D1R1
RCD snubber
Figure 4. Schematic diagram of flyback converter with conven tional RCD 
snubber in paral lel with the switch 
T r1
R1
M1
1:N
Vi
Lm1
LK1 DO
CO1
VO
DM 1
CM 1
Tr2
D 1
1:N
LK21
Lm21
C1
D2
LOD3
D4
Tr2
1:N
Figure 5. Schematic diagram of flyback converter with the proposed 
lossless snubber. 
T r1
1:N1:N2:N3:N4:N 5
DO1
CO1 R1
C
O2 R2
R3
R5
CO3
CO5
V2
V3
V4
V5
GND1
R4CO4
M1
N1
Vi
L m11
LK11
DO2
DO3
DO4
DO5
VO
V1
LOD3
D 4
N4
Tr2
1:N
C1
D2
D1
1:N
N3
L K21
Lm21
Tr2
Figure 6. Schematic diagram of the proposed auxiliary power supply with 
five s ets of output  voltages. 
2011 6th IEEE Conference on Industrial Electronics and Applications 2173
                                    
and at this moment, only transformer 1rT  is supplying energy 
to load through diode oD .
Mode 7 [Fig. 7(g); 76 ttt <≤ ]
At 6t , the energy stored in 21mL  is reset to 0 and diodes 
1D  and 2D  become off. Current 11LmI  decreases linearly as it 
keeps releasing its energy to load. When switch 1M  is turned 
on at the end of mode 7, a new switching cycle will start. 
III. DESIGN OF THE PROPOSED AUXILIARY POWER SUPPLY
To design the proposed power supply systematically, de-
termination of  duty ratio D , transformers 1rT Εʳ 2rT  and ca-
pacitor 1C  are detailed as follows [14]. 
A. Duty ratio D
As the converter is operating in continuous conduction 
mode (CCM) and, according to volt-second balance principle, 
the following equation can be obtained: 
C1
D
2
DO
C0 R O
Tr1
1:N
N1 N2
Vi
Lm 11
LK1 1
IOIL m 1 1
ILK1 1
I C1
ID 1
IDS
I LO
VO
LOD3
D4
N4Tr2
1:N
M1
VD S
D
M 1
C
M 1
D1
Tr 2
1:NN3
LK2 1
Lm2 1
IL K21 IL m 21
VN3
VC1
VN1
VN2
VN4
Figure 7(d). Mode 4 
C1
D
2
DO
C0 RO
Tr 1
1: N
N1 N2
Vi
L
m1 1
LK11
IOIL m 1 1
IL K11
IC1
ID1
ID S
ILO
VO
LOD3
D4
N4T r2
1:N
M1
VDS
D
M 1
C
M 1
D 1
Tr 2
1: N
N3LK2 1
Lm2 1
IL K2 1 ILm 2 1
VN3
VC1
VN1
VN 2
VN4
Figure 7(e). Mode 5  
C1
D2
DO
C0 RO
Tr 1
1: N
N1 N2
Vi
Lm1 1
LK11
IOIL m 1 1
IL K11
IC1
ID1
ID S
ILO
VO
LOD3
D4
N4T r2
1:N
M1
VDS
DM 1CM 1
D 1
Tr 2
1: N
N3LK2 1
Lm2 1
IL K2 1 ILm 2 1
VN3
VC1
VN1
VN 2
VN4
Figure 7(f). Mode 6 
C1
D2
DO
C0 RO
Tr1
1:N
N 1 N2
Vi
Lm 1 1
LK11
IOIL m 11
I LK11
IC1
ID1
IDS
ILO
VO
LOD3
D4
N4T r2
1:N
M1
VDS
DM 1CM 1
D1
Tr2
1:N
N3LK21
Lm 21
ILK2 1 ILm 2 1
VN3
VC1
VN1
VN 2
VN4
Figure 7(g). Mode 7 
Figure 7. Operat ional principle of the proposed converter (continued) 
t0
t0
t0
t0
t0
t0
t0
t0
t0
t0
t0
t0
M1
IDS1
VDS1
ILm1
VC 1
VN 1
Vi
-VO
N
VN 2
VO
ILK 12
ILO
ILm12
IO
VO
t0 t1 t2 t3 t 5t6 t7t4
Figure 8. Key waveforms of the proposed converter 
2011 6th IEEE Conference on Industrial Electronics and Applications 2175
                                    
• turns-ratio of transformer 1rT : 1:3:3:1.5:3.5:3 
• magnetizing inductance 11mL : 147 Hμ
• leakage inductance 11KL : 0.9 Hμ
• transformer core: EI-33 
• capacitor 1C : 39 nF
• switch 1M : IRFPS59N60C 
Measured waveforms of DSV  and DSI  of switch 1M  of the 
proposed auxiliary power supply under hard-switching are 
shown in Fig. 9. Fig. 9(a) shows those waveforms under 50% 
of  full load while Fig. 9(b) shows those waveforms under full 
load. Waveforms shown in Fig. 10 are the same waveforms 
except that the proposed lossless snubber is applied. From Fig. 
9 and Fig. 10, it can be seen that the power supply with the 
proposed lossless snubber can reduce surge voltage across tran-
sistor switch at turn-on (ZVS) and decrease slew rate of voltage 
across the switch at turn-off (ZVT). Comparison of conversion 
efficiency between the power supply under hard-switching and 
with the proposed lossless snubber from light load to heavy 
load is shown in Fig. 11. From Fig. 11, it is clear that the effi-
ciency of the proposed one is higher than that under hard-
switching, and its efficiency reaches 82.5% under full load 
condition. 
Fig. 12 shows measured waveforms of output voltage oV  and 
current oI  of the proposed power supply under a step-load 
change between 20% and 100% of full load. From Fig. 12 it 
can be observed that voltage regulation of output voltage oV  of 
15V is limited within ±1%. 
IDS
VDS
(VDS: 5 0 V/div, IDS: 1 A/div, 5 μs/div) 
(a) 
IDS
VDS
(VDS: 5 0 V/div, IDS: 1 A/div, 5 μs/div) 
(b) 
Figure 9. Measured voltage VDS and  current IDS waveforms of switch M1
of the proposed auxiliary power supply un der hard-switch ing 
(a) under 50%, and (b) under 100% of full load. 
IDS
VDS
(VDS: 50 V/div, IDS:  10 A/div, 5 μs/div) 
(a) 
IDS
VDS
(VDS: 50 V/div, IDS:  10 A/div, 5 μs/div) 
(b) 
Figure 10. Measured voltage VDS and current IDS waveforms of switch 
M1 of the proposed au xiliary power supply with lossless 
snubber (a) under 50%, and (b) under 100% of full  load. 
Hard-swi tching 
ci rcuit
The proposed lossless s unbber
Figure 11. Comparison of efficiency between the proposed au xiliary 
power supply under hard-switching and with the proposed 
lossless snubber from l ight load to heavy load. 
2011 6th IEEE Conference on Industrial Electronics and Applications 2177
+LJK9ROWDJH*HQHUDWRU8VLQJ5DSLG5HVSRQVH
%RRVW)O\EDFN&RQYHUWHUVIRUVWXQ*XQ$SSOLFDWLRQV
6KHQJ<X7VHQJ*XDQ:HL+VX<L5HQ-KXDQJ6KX<XDQ)DQ*HHQJ.ZHL&KDQJ
'HSDUWPHQWRI(OHFWULFDO(QJLQHHULQJ
&KDQJ*XQJ8QLYHUVLW\
.ZHL6KDQ7DR<XDQ7DLZDQ52&
(PDLOV\WVHQJ#PDLOFJXHGXWZ
'HSDUWPHQWRI(OHFWULFDO(QJLQHHULQJ
:X)HQJ8QLYHUVLW\
0LQ6\RQJ&KLD<L7DLZDQ52&
(PDLOV\IDQ#ZIXHGXWZ


$EVWUDFW²7KLV SDSHU SUHVHQWV KLJK YROWDJH JHQHUDWRU IRU VWXQ
JXQDSSOLFDWLRQV7KHSURSRVHGKLJKYROWDJHJHQHUDWRUFRQVLVWVRI
FRXSOHGLQGXFWRU ERRVW DQG IO\EDFN FRQYHUWHUV ZKLFK DGRSWV
DFWLYH FODPS FLUFXLW WR UHFRYHU HQHUJ\ WUDSSHG LQ OHDNDJH
LQGXFWDQFHV RI FRXSOHG LQGXFWRU DQG WUDQVIRUPHU LQ WZR
FRQYHUWHUVVLPXOWDQHRXVO\:LWKWKLVDSSURDFKFRXSOHGLQGXFWRU
ERRVWFRQYHUWHUFDQERRVWYROWDJHRIEDWWHU\XSWRDKLJKRXWSXW
YROWDJHZKLOHIO\EDFNFRQYHUWHULVDGRSWHGWRVWHSXSWKHRXWSXW
YROWDJH XS WR WKH GHVLUHG YROWDJH RI FDSDFLWDWHG SDUDO\VLV IRU
FRQYLFWV FRQIHUULQJ ,Q RUGHU WR LQFUHDVH VDIHW\ RI WKH VWXQ JXQ
WUDQVIRUPHURIIO\EDFNZLWKDKLJKWXUQVUDWLR LVXVHGE\PXOWL
ZLQGLQJ PHWKRG LQ VHFRQGDU\ ZLQGLQJ WR VSHHG XS RXWSXW
UHVSRQVHDQGWRUHGXFHFKDUJHVVXSSOLHGE\VWXQJXQIRUPHHWLQJ
PD[LPXPHQGXULQJFKDUJHVRIKXPDQERG\6LQFHVZLWFKHVLQWKH
SURSRVHG JHQHUDWRU DGRSWV VZLWFK LQWHJUDWLRQ WHFKQLTXH LWV
ZHLJKWDQGYROXPHFDQEHUHGXFHGDQG LWV FRQYHUVLRQHIILFLHQF\
FDQ EH LQFUHDVHG$V FRPSDUHGZLWK FRQYHQWLRQDO VWXQJXQ WKH
SURSRVHG RQH FDQ DFKLHYH  WHQVHFRQG ILULQJV ZKLFK H[FHHGV
WLPHVRIWHQVHFRQGILULQJVRIWKHFRQYHQWLRQDORQH)LQDOO\D
SURWRW\SHXQGHUPD[LPXPRXWSXWYROWDJHRIN9DQGPD[LPXP
RXWSXWFXUUHQWRIP$KDVEHHQLPSOHPHQWHGWRYHULI\IHDVLELOLW\
RIWKHSURSRVHGKLJKYROWDJHJHQHUDWRU
.H\ZRUGV +LJK YROWDJH JHQHUDWRU FRXSOHLQGXFWRU ERRVW
FRQYHUWHUDFWLYHFODPSIO\EDFNFRQYHUWHUVWXQJXQ
,9 ,1752'8&7,21
,Q WKH SDVW GHFDGHV GXH WR UHPDUNDEOH DGYDQFHV LQ WKH
PDWHULDOVVFLHQFHVHPLFRQGXFWRUWHFKQRORJ\LVJURZLQJIDVWWR
TXLFNO\ H[SDQG WKH FRQVXPHU SURGXFW PDUNHW 6LQFH
SHUIRUPDQFHVRIWKHFRQVXPHUSURGXFWVUHTXLUHOLJKWHUWKLQQHU
VKRUWHU DQG VPDOOHU WKH SRUWDEOH FRQVXPHU SURGXFW LV
GHYHORSHG %HFDXVH RI VWDEOH WHFKQRORJ\ RI WKH SRUWDEOH RQH
WKHVWXQJXQZKLFKLVUHJDUGHGDVWKHHOHFWULFDOLQFDSDFLWDWLRQ
ZHDSRQ DQG XVHV EDWWHU\ DV LWV YROWDJH VRXUFH LV JURZLQJ LQ
SRSXODULW\DPRQJODZHQIRUFHPHQWDJHQFLHV
7KH VWXQ JXQ ZRUNV ZLWK ILULQJ WZR WHWKHUHG EDUGV DW D
WDUJHW DQG VHQGLQJ SXOVHV RU GF RI KLJKYROWDJH HOHFWULFLW\
WKURXJK WKH WHWKHU ZLUHV WR LQGXFH LQYROXQWDU\ PXVFOH
FRQWUDFWLRQDQG LQWHQVHSDLQ:KHQDQHQRXJKKLJKYROWDJH LV
DSSOLHGWRKXPDQERG\LWZLOOLQGXFHDFXUUHQWSDVVLQJKXPDQ
ERG\DQGFDXVHDFWLRQSRWHQWLDOWRJHQHUDWHPXVFOHFRQWUDFWLRQ
7KH SURSDJDWLRQ RI WKH DFWLRQ SRWHQWLDO LV VLPLODU WR WKDW RI
VHQVHVLJQDOZLWKHOHFWULFDOLPSXOVHV:KHQWKHDFWLRQSRWHQWLDO
LV KLJK HQRXJK WR FDXVH LQYROXQWDU\ VWLPXODWLRQ RI ERWK WKH
VHQVRU\ QHUYHV DQG WKHPRWRU QHUYHV LW FDQ JHQHUDWH QHXURQ
PXVFXODU LQFDSDFLWDWLRQ 10, IRU SDUDO\VLV FRQYLFWV
7KHUHIRUH LQ RUGHU WR HIIHFWLYHO\ JHQHUDWH10, DQG LQFUHDVH
RSHUDWLRQDO VDIHW\ RI VWXQJXQ RXWSXW FXUUHQW RI WKH RQHPXVW
EHOLPLWHGZLWKLQDGHVLUHGUDQJH
:KHQ HOHFWULFDO LPSXOVH LV DSSOLHG WRKXPDQERG\ LWZLOO
LQGXFH D10, +RZHYHU ZKHQ D KLJKHU HOHFWULFDO LPSXOVH LV
SXW RQ KXPDQ ERG\ LW ZLOO JHQHUDWH D YHQWULFXODU ILEULOODWLRQ
UHVXOWLQJ LQ D KXUW IRU KXPDQ ERG\$FFRUGLQJ WR VWDQGDUG RI
,(&>@ WKH UHODWLRQVKLS EHWZHHQ HOHFWULF VWXQQLQJ
GXUDWLRQYHUVXVHOHFWULFVWXQQLQJFXUUHQWLVLQGLFDWHGWROLPLWWKH
VWXQQLQJ FXUUHQW IRU DFKLHYLQJ D VDIHW\ RSHUDWLRQ RI HOHFWULF
VWXQQLQJ IRU KXPDQ 7KH SORWV RI HOHFWULF VWXQQLQJ GXUDWLRQ
YHUVXV HOHFWULF VWXQQLQJ FXUUHQWDUH LOOXVWUDWHG LQ)LJZKHUH
EHKDYLRU RI WKH KXPDQ SK\VLRORJ\ FRUUHVSRQGHG WR HDFK
RSHUDWLRQDODUHD$a$LVGHILQHGLQ7DEOH)URP7DEOHLW
FDQEHVHHQWKDWZKHQRSHUDWLRQDODUHDLVORFDWHGRQDUHD$RU
$LWLVDVDIHW\RSHUDWLRQDQGFDQDYRLGWRJHQHUDWHYHQWULFXODU
ILEULOODWLRQ IRU KXPDQ ,Q RUGHU WR DYRLG WR YHQWULFXODU
ILEULOODWLRQ ZKHQ HOHFWULFDO LPSXOVH XVLQJ DF YROWDJH XQGHU
IUHTXHQF\UDQJHVIURPWR+]LVDSSOLHGWRKXPDQERG\
LWV VWXQQLQJ FXUUHQW LV OLPLWHG EHORZ P$ ,I WKDW XVLQJ GF
YROWDJH LV DGRSWHG LWV VWXQQLQJ FXUUHQW LV FRQWUROOHG ZLWKLQ
P$ $V PHQWLRQHG DERYH WKH VWXQ JXQ V\VWHP XVLQJ GF
YROWDJH WR LQGXFH 10, LV PRUH VDIHW\ WKDQ DF YROWDJH
)XUWKHUPRUH VLQFH WKH VWXQ JXQ XVHV WZR WHWKHUHG EDUGV DQG
WHWKHU ZLUHV LW ZLOO JHQHUDWH DQ H[WUD ORVVHV LQ WHWKHU ZLUHV
XQGHU DF YROWDJH 7KHUHIRUH WKH SURSRVHG VWXQ JXQ V\VWHP
DGRSWVGFYROWDJHWRDFKLHYH10,
 
DDFVRXUFH EGFVRXUFH
)LJ  5HODWLRQVKLS DPRQJ YHQWULFXODU ILEULOODWLRQ HOHFWULF VWXQQLQJ GXUDWLRQ
DQGHOHFWULFVWXQQLQJFXUUHQWLQWKHKXPDQERG\





1780978-1-4244-8756-1/11/$26.00 c©2011 IEEE
  

$V GHVFULEHG SUHYLRXVO\ LW FDQ EH REVHUYHG WKDW HOHFWULFDO
VWXQQLQJFDQJHQHUDWHPXVFOHFRQWUDFWLRQIRUDFKLHYLQJ10,
$V PHQWLRQHG DERYH WKH EUHDNGRZQ YROWDJH RI VNLQ
LPSHGDQFH IRU KXPDQ LV DERXW 9 DV VKRZQ LQ )LJ 
)XUWKHUPRUHVLQFHFXUUHQW,LSDVVLQJKXPDQERG\VKRZQLQ)LJ
PXVW EH JUHDWHU WKDQ P$ IRU JHQHUDWLQJ10, DQG EH OHVV
WKDQ P$ IRU DYRLGLQJ WR JHQHUDWH YHQWULFXODU ILEULOODWLRQ
FXUUHQW ,LPXVWEH OLPLWHGEHWZHHQP$DQGP$7KHFORWK
EDUULHU XQGHU  FXPXODWLYH LV SXQFWXUHG E\ HOHFWULFLW\ XQGHU
N9aN9 IRU GLIIHUHQW PDWHULDO ,Q RUGHU WR SHQHWUDWH WKH
EDUULHU VSHFLILFDWLRQ RI WKH SURSRVHG VWXQ JXQ LV GHVLJQHG
XQGHURXWSXWYROWDJHRIN9DQGRXWSXWFXUUHQW,2RIP$
&6&
56
5VF
 8VNLQ >9@
5VNLQ>ȍ@

)LJ$QHTXLYDOHQWLPSHGDQFHRIVNLQ )LJ3ORWRIWKHVNLQLPSHGDQFHRI
SRXOWU\ YHUVXV WKH DSSOLHG
YROWDJH

)LJ  $Q LOOXVWUDWLRQ RI SURFHGXUH IRU PXVFOH FRQWUDFWLRQ LPSXOVH
SURSDJDWLRQEHWZHHQEUDLQDQGPXVFOHFHOOV

)LJ  $Q HTXLYDOHQW FLUFXLW IRU GHVFULELQJ WKH PXVFOH FRQWUDFWLRQ LPSXOVH
SURSDJDWLRQEHWZHHQEUDLQDQGPXVFOHFHOOV
9, '(6,*12)7+(352326('6781*816<67(0
7R UHDOL]H WKH SURSRVHG VWXQ JXQ V\VWHP V\VWHPDWLFDOO\
GHVLJQ RI GXW\ UDWLRV ' DQG ' FRXSOH LQGXFWRU 7I
WUDQVIRUPHU7IDQGWKHFODPSFDSDFLWRU&&DUHLOOXVWUDWHGLQWKH
IROORZLQJ
$ 'XW\5DWLRV'DQG'
7KH SURSRVHG VWXQ JXQ V\VWHP FRQVLVWV RI D FRXSOHG
LQGXFWRU ERRVW FRQYHUWHU DQG DQ DFWLYH IO\EDFN FRQYHUWHU DQG
WKHLU VZLWFKHV DUH LQWHJUDWHG E\ VZLWFK LQWHJUDWLRQ WHFKQLTXH
$OWKRXJK FLUFXLW VWUXFWXUHV RI WKH FRXSOHLQGXFWRU ERRVW
FRQYHUWHUDQG WKHDFWLYH IO\EDFN FRQYHUWHUDUH LQWHJUDWHGZLWK
VZLWFKLQWHJUDWLRQWHFKQLTXHWKHLUWUDQVIHUIXQFWLRQV0DQG0
GR QRW DIIHFW DQG WKHLU YDOXHV DUH WKH VDPH DV WKH RULJLQDO
FRQYHUWHUV7KHUHIRUHWUDQVIHUIXQFWLRQ0RIWKHSURSRVHGVWXQ
JXQV\VWHPLVHTXDOWR00,QRUGHUWRDWWDLQWUDQVIHUUDWLR0
WUDQVIHUUDWLRV0DQG0DUHILUVWGHWHUPLQHG,QWKHIROORZLQJ
WUDQVIHUUDWLRV0DQG0DUHGHULYHG
6LQFH WKH FRXSOHLQGXFWRU ERRVW FRQYHUWHU LV GHVLJQHG LQ
FRQWLQXRXVFRQGXFWLRQPRGH &&0WKHUHODWLRQVKLSEHWZHHQ
LQSXW YROWDJH 9LDQG YROWDJH 9'& FDQ EH LQGLFDWHG ZLWK YROW
VHFRQGEDODQFHSULQFLSOHRIFRXSOHGLQGXFWRU7IDVIROORZV
9L'76>9'&9L'1@76  
ZKHUH1LVWXUQVUDWLRRIFRXSOHLQGXFWRU7IDQG9'&LVGFEXV
YROWDJHDFURVVFDSDFLWRU&'&)URPLWFDQEHREVHUYHGWKDW
WUDQVIHUIXQFWLRQ0EHWZHHQLQSXWYROWDJH9LDQGYROWDJH9'&
FDQEHH[SUHVVHGDV


 

'
'1
9
90
L
'&

  
 

)XUWKHUPRUH DFWLYH FODPS IO\EDFN FRQYHUWHU LV RSHUDWHG LQ
GLVFRQWLQXRXVFRQGXFWLRQPRGH'&0WRJHQHUDWHWKHGHVLUHG
RXWSXW YROWDJH 6LPLODUO\ DFFRUGLQJ WR YROWVHFRQG EDODQFH
SULQFLSOHRIWUDQVIHU7IWUDQVIHUUDWLR0FDQEHGHWHUPLQHGE\
9'&'76>921'76@  
ZKHUH 1 LV WXUQV UDWLR RI WUDQVIRUPHU 7I DQG '76 LV WKH
FRPSOHWHO\ GLVFKDUJH WLPH LQWHUYDO RI WKH HQHUJ\ VWRUHG LQ
PDJQHWL]LQJ LQGXFWRU/PI 7KHUHIRUH WUDQVIHU UDWLR0 FDQ EH
GHULYHGDV


 '
'1
9
90
'&
2   
ZKHUH'' 
$V PHQWLRQHG DERYH WKH WRWDO WUDQVIHU UDWLR 0 FDQ EH
GHWHUPLQHGDVIROORZV
 



''
'1'1
9
9
0
L
2


  
 
$FFRUGLQJWRGXW\UDWLR'FDQEHGHULYHGE\
 




 

11
0'1110'10'
'

 
 
%DVHGRQWKHRSHUDWLRQDOOLPLWDWLRQRIWKHFRQYHUWHURSHUDWHGLQ
'&0WKHYDOXHRIUDWLR'PXVWEHOLPLWHGDQGLWLVOHVVWKDQ
' $FFRUGLQJ WR  DQG  D ODUJH GXW\ UDWLR '
FRUUHVSRQGVWRDVPDOOHUWXUQUDWLRV1DQG1ZKLFKDWWDLQVD
ORZHUYROWDJHVWUHVVHVRQIUHHZKHHOLQJGLRGHV'DQG'DQGD
KLJKHU FRXSOLQJ FRHIILFLHQW EHWZHHQ 7I DQG 7I IRU UHGXFLQJ
VZLWFKLQJ ORVVHVLQVZLWFKHV0DQG0+RZHYHULQRUGHUWR
DFFRPPRGDWH YDULDWLRQV RI ORDG OLQH YROWDJH DQG FRPSRQHQW
YDOXH LW KDG EHWWHU VHOHFW DQ RSHUDWLQJ UDQJH EHWZHHQ '  
a
% &RXSOHG,QGXFWRU7I
2QFHWKHGXW\UDWLR'DQGYROWDJH9'&DUHVHOHFWHGWKHWXUQV
UDWLR1 RI FRXSOHG LQGXFWRU 7I FDQ EH GHWHUPLQHG IURP 
ZKLFK\LHOGV




'
'001  
 
1782 2011 6th IEEE Conference on Industrial Electronics and Applications
Form (20), when Lk2J is specified, the capacitance range of the 
clamp capacitor Cc can detennined as 
C 
> (1-DJ)2T/ 
c - 2 
7r LK2J 
VII. EXPERIMENTAL RESULTS 
(21) 
To verify the performances of the proposed stun gun system, 
as shown in Fig. 4, a prototype with the following 
specifications was implemented. 
- input voltage Vi: 7.4V1l.65Ah (Lithium battery), 
- switching frequency Is: 25 kHz, 
- output maximum voltage VO(max/ 30kV, 
- output maximum currentiO(max/ 5mA, and 
- output maximum power PO(max): 9W. 
According to the previous specifications, components of the 
stun gun system are determined as follows: 
- turns ratio of coupled inductor TjJ: 2, 
- turns ratio of transformer Tfl: 100, 
- magnetizing inductor Lmll: 24uH, 
- leakage inductor LKll: 1.4uH, 
- magnetizing inductor Lr'1l 106uH, 
- leakage inductor LK2J: 56uH, 
- active clamp capacitor Cc: 0.3uF, 
- output capacitors Co: 3nF/40kV, 
-capacitors Cll, C12 and C13: 3nF/1OkV, 3nF120kV and 
3 nF/3OkV, 
- SwitchMJ, M2: IRF59N60C, 
- diode DJ: STTH12R06D, 
- diode D2: DSEC60-03A, and 
-diodes Df], Dfl, Dj3 and Df4: STTH05R06D, two 
STTH05R06D in series, three STTH05R06D in series and 
four STTH05R06D in series. 
Measured voltage VDS and current IDS waveforms of 
switches MJ and M2 is shown in Figs. 10 and 11 under 
simulated load resistances of 100MQ and 500n, respectively. 
Fig. 1O(a) and (b) shows those waveforms of switches MJ and 
M2 under load resistance of 100MQ, while Fig. l1(a) and (b) 
shows those waveforms of ones under load resistance of 500n. 
From Figs. 10 and 11, it can be seen that the proposed stun 
gun converter can be operated with zero-voltage switching 
(ZVS) at turn-on transition. Fig. 12 shows measured 
waveforms of output voltage Vo and current 10, illustrating 
that output voltage Vo can reach 30kY. In order to observe 
rising time of output voltage with single winding and with 
multi-windings in the flyback, Fig. 13 illustrates output 
voltage waveform during the stun gun system from power on 
to steady-state conditions. From Fig. 13, it can be seen that 
rising time of the stun gun system with single winding and 
with four sets of windings are separately l70ms and 97ms. 
The rising time of the one with four sets of windings can 
reduce rising time about l30ms. Moreover, when the skin and 
clothing barrier impedances occur in breakdown condition, the 
body resistance of human is about 60(}-1,750n which is posed 
in IEC479-1. In order to simulate the body resistance of 
human, Figs. 14 and 15 illustrates measured waveforms of 
output voltage Vo and output current 10 under step-load 
changes in which the simulated resistance varies from 
100MQto 500n and from 100MQ to 2kn, respectively, Figs. 
l4(a) and l5(a) shows those waveforms under changes of the 
simulated resistance from 100MQ to 500n, while Figs. l4(b) 
and l5(b) illustrates those waveforms under variations of the 
one from 100MQ to 2kn. From Figs, 14 and 15, it can be 
found that when the simulated resistance varies from 100MQ 
to 500n, the stun gun system using four sets of winding can 
reduce falling time about 40ms. When the simulated resistance 
changes from 100MQ to 2kn, the one can decrease falling 
time about 20ms. Therefore, the stun gun system adopts four 
sets of windings in the secondary side of flyback can reduce 
falling time to increase its operational safety. Furthermore, 
when the simulated resistance changes, output current 10 can 
be kept in the desired constant current of 5mA. From 
experimental results, we can find that the proposed stun gun 
system using Li-ion (7.4V1l.65Ah) can achieve 210 ten­
second firings. It is l.4 times of the conventional stun gun 
X26c which is made by taser. 
Fig. 10. Measured voltage VDS and IDS current wavefonns ofCa) switchM1 and 
(b) switch M2 under the simulated load resistance of 100 MO. 
Fig. 11. Measured voltage VDS and IDS current wavefonns ofCa) switchM1 and 
(b) switch M2 under the simulated load resistance of 500 O. 
Fig. 12. Measure wavefonns of output voltage Va and current 10 under the 
simulated load resistance of 100 MO. 
1784 2011 6th IEEE Conference on Industrial Electronics and Applications 
A Reflex Charger Realized by Multi-interleaved 
Buck-Boost Converters 
S.-Y. Fan, G.-K. Chang 
Department of Electrical Engineering 
Wufeng University 
Ming-Hsiung, Chia-Yi, Taiwan 
E-mail: syfan@wfu.edu.tw 
S.-Y. Tseng 
GreenPower Evolution Applied Research Lab (G-PEARL) 
Department of Electrical Engineering 
Chang Gung University 
Kwei-Shan, Tao-Yuan, Taiwan, R.O.C 
E-mail: sytseng@mail.cgu.edu.tw
Abstract- This paper proposes a multi-battery charger with Ref-
lex charging technique. This circuit is achieved by an interleaved 
buck-boost converter with RLC snubber. The required posi-
tive/negative pulses for the Reflex charging are generated by only 
controlling the resonant period of the RLC snubber and the driv-
ing signals of the main switches with microchip. With the pro-
posed circuit structure, not only the lifetime of rechargeable bat-
teries can be extended due to the use of Reflex charging tech-
nique. Moreover, with the interleaved buck-boost converter, the 
efficiency of the charger can be further improved and the charg-
ing of multi-batteries simultaneously can be achieved. In this 
project, a multi-battery charger with Reflex charging technique 
is implemented for verifying its performance. Experimental re-
sults show that the proposed circuit structure can generate the 
required positive/negative pulses for the Reflex charging. 
Keywords- interleaved buck-boost converter; Reflex charging; 
charger 
I. INTRODUCTION 
Recently, the demand for portable products is growing ex-
ponential. Besides the features and functions, the overall suc-
cess of a portable product is also dictated by the batteries it 
used. That is, the capacity, the charge time, and the life expec-
tancy of the battery [1]. Hence, how well the working know-
ledge of batteries and batteries charging technologies are car-
ries out have been the significant impacts on the overall per-
formance of the batteries.  
The basic considerations for battery charger circuit topolo-
gies are selection of the type of battery, choice of battery charg-
ing techniques, and design of converter circuit. For the type of 
battery, lead acid buttery and nickel cadmium battery are the 
two battery types that dominate the rechargeable battery market 
today. Due to the larger capacity and lower cost, lead acid but-
tery has been used in many applications, such as portable prod-
ucts, uninterrupted power systems, electric vehicle, and com-
munication systems, to be main power source or the auxiliary 
power source. Because the waste of lead acid buttery is one of 
high pollutant, it is urgent to improve the capacity, the efficien-
cy, and the life time of rechargeable battery to alleviate the 
environment pollution.  
For the design of battery charging techniques, there are 
several methods have been developed and used in consumer 
products, such as the constant trickle current (CTC), constant 
current (CC), constant voltage (CV), and constant-current and 
constant-voltage (CC-CV) [2]. These low-cost, simple design 
conventional battery charging methods result in a reduction of 
battery capacitor and a shorter life span due to the long charg-
ing time. Due to the long charging time, the rate and uniformity 
by which irons move from one electrode to the other are slow 
and not uniform, thus result electric double layers to be formed 
around the electrode. These electric double layers then induce 
over-potential or concentration polarization to retard the charg-
ing process, and thus reduce the battery capacity and efficiency.  
To speed up the charging time, pulse current charging me-
thod is proposed to address the electrochemical process occur-
ring in the battery [3, 4]. With the current waveform shown in 
Fig. 1, battery charging is interrupting periodically to allow the 
irons to diffuse and distribute more evenly throughout the bat-
tery. Here, the relax interval (tRES) is usually set at the order of 
several milliseconds to hundreds of milliseconds which can not 
effectively eliminate the impact of concentration polarization. 
Hence, an improvement on the pulse charging is promoted and 
is named Reflex charging method [5-7]. Current waveform of 
the Reflex charging method consists of a positive pulse, a nega-
tive pulse, and a relax interval. Fig. 2 shows the current wave-
form of Reflex charging, where the positive pulse is used to 
reduce the charging time, the negative pulse is for accelerate 
the diffusion rate of the irons, and the relax interval is for alle-
viating the polarization [8]. Therefore, the capacity, the charge 
time, and the life expectancy of the battery can be improved 
obviously.  
Fig. 3 shows the conventional circuit to realize the Reflex 
charging, where switch M1 is used to provide the positive 
pulses and switch M2 and series resistor R2 are used to release 
negative pulse energy. Series resistor R2 in this circuit is ener-
gy-consuming and makes the charger bulky. Therefore, some 
energy circuits [9, 10] or non-dissipative circuits [4, 11, 12] are 
proposed to alleviate the energy loss problems. Besides, series 
connected battery charging schemes, parallel connected battery 
charging schemes, and multiphase charging schemes [13, 14] 
are also provided to increase the utility of charging current for 
further promoting the efficiency of battery charger. Hence, a 
Reflex charging circuit implemented by an interleaved Buck-
boost converter and shown in Fig. 4 is presented in this paper. 
The two lossless snubbers shown in Fig. 4 not only achieve the 
function of snubber, but also use to provide the needed nega-
tive pulse.  
1215978-1-4244-8756-1/11/$26.00 c©2011 IEEE
Figure 8. Driving signals and key waveforms of the proposed Reflex charger 
operated in State 1. 
     
(a) mode 1                              (b) mode 2 
      
(c) mode 3                           (d) mode 4 
(e) mode 5 
Figure 9. Operational modes of the proposed Reflex charger in state 1 over 
one cycle. 
A. State 1 (TP)
In state 1, all of the N-set interleaved converters are operat-
ed in high-frequency to provide the needed positive charging 
currents. By using microprocessor to control the turn-on period 
of the power switches in every set of the interleaved Buck-
boost converters, the positive charging current can be formed 
by superimposing all of the positive pulses of converters. Here, 
the mode operations of an interleaved Buck-boost converter are 
first described with reference to Fig. 9 in detail as the following: 
1) Mode 1(t0  t < t1)
Mode 1 begins at time t0 when power switch M1 is turn on 
and M2 is turn off. Meanwhile, inductor L11 of snubber circuit 
resonates with capacitors C11 and C12 of snubber circuit to in-
duce a positive pulse on the switching current iDS1 and a nega-
tive pulse on the charging current iB1. At the end of resonance, 
the resonant current goes to zero and all energy will be stored 
in the capacitors of snubber circuit. At the same time, switching 
current iDS1 caused by the input voltage flows through the in-
ductor L1 of converter to store energy in inductor L1 while the 
inductor L2 of converter discharge energy to the battery VB2.
2) Mode 2(t1  t < t2)
At time t1, the resonance between inductor and capacitors 
of snubber circuit is ended, the converters are operated in nor-
mal state. That is, the switching current iDS1 and inductor cur-
rent iL1 are linearly increased for storing energy in inductor, and 
the inductor L2 is in the freewheeling state for providing induc-
tor current iDL1 to charge battery VB2, hence inductor current 
iDL1 and charge current iB2 are linearly decreased.  
3) Mode 3(t2  t < t3)
At time t2, power switch M1 is turn off and M2 is kept in off 
state, causing the switching current iDS1 to drop to zero. Theo-
retically, inductor current iL1 is going to charge battery VB1
through output diode D1 for keeping continuity. Due to energy 
stored in capacitors C11 and C12 of snubber circuit during mode 
1, the voltage across the output diode D1 is reversely biased. 
Hence, as shown in Fig. 9(c), energy stored in capacitors C11
and C12 of snubber circuit is discharged to battery VB2 through 
inductor L1 and generate a negative pulse current in charging 
current iB2.
4) Mode 4(t3  t < t4)
Mode 4 begins when the energy stored in capacitors C11
and C12 of snubber circuit releases to zero. Operational princip-
als are the same as that in Mode 2, except that it is charging 
battery VB1 instead of battery VB2.
5) Mode 5(t4  t < t5)
At time t2, power switch M1 is turn off and M2 is conducted. 
At this moment, the operation is repeated from mode 1to mode 
4 referring to switch M2.
B. State 2 (TN1)
In this state, one of the N-set interleaved Buck-boost con-
verters is driven by signals shown in Fig. 10 to turn on power 
switch M1 and turn off power switch M2, and all of the N-set 
interleaved Buck-boost converters are driven by signals shown 
in Fig. 6 to have the power switches are conducted only during 
the resonant period. Hence, each set of interleaved Buck-boost 
converter generate a negative pulse current and a negative 
pulse current with the time shift of resonant period in battery 
2011 6th IEEE Conference on Industrial Electronics and Applications 1217
(IB1: 500 mA /div, IB2:500 mA/div, time:500ms/div)
(a) 
(IB1: 500 mA /div, IB2:500 mA/div, time:500ms/div)
(b) 
(IB1: 500 mA /div, IB2:500 mA/div, time:500ms/div)
(c) 
(IB1: 500 mA /div, IB2:500 mA/div, time:500ms/div)
(d) 
Figure 12. Measured waveforms of charge currents IB1 and IB2 in the proposed 
Reflex charger under input voltage of 21V with (a) one set, (b) two sets, (c) 
three sets and (d) four sets of interleaved Buck-boost converters. 
(IB1: 500 mA /div, IB2:500 mA/div, time:500ms/div)
(a)17V 
(IB1: 500 mA /div, IB2:500 mA/div, time:500ms/div)
(b)19V 
(IB1: 500 mA /div, IB2:500 mA/div, time:500ms/div)
(c)21V 
Figure 13. Measured waveforms of charge currents IB1 and IB2 in the proposed 
Reflex charger with four sets of interleaved Buck-boost converters under 
different input voltage of (a) 17V, (b) 19V, and (c) 21V. 
IV. CONCLUSIONS
This paper has proposed a Reflex charger with 4-sets of in-
terleaved Buck-boost converters and a control circuit. In this 
paper, operational principles of the Reflex charger with one 
set of interleaved Buck-boost converter have been presented 
in detail. The proposed Reflex charger use lossless snubber to 
generate the needed negative pulse for releasing energy stored 
in the leakage inductor while still sustaining the turn off ZVT 
feature. In the paper, interleaved Buck-boost converter has 
been used to charge two-batteries simultaneously for improv-
ing the utility rate of charging current. Thus, the efficiency of 
the charger can be further improved. Experimental results 
have verified that the proposed Reflex charger can realize the 
Reflex charging technology with the lossless snubber. It is 
relatively suitable for charger application.  
2011 6th IEEE Conference on Industrial Electronics and Applications 1219
國科會補助計畫衍生研發成果推廣資料表
日期:2012/02/08
國科會補助計畫
計畫名稱: 應用於風力太陽能發電系統之多模節能最大功率追蹤晶片之開發(3/3)
計畫主持人: 李建德
計畫編號: 99-2220-E-182-001- 學門領域: 晶片科技計畫--目標導向型研究
計畫
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
2010ISC最佳論文獎-應用於太陽能發電系統之全數位折疊式省面積低功率最大
功率追蹤晶片 
2011 國家晶片中心優良晶片數位組佳作-應用於太陽能發電系統之全數位折疊
式 
省面積低功率最大功率追蹤晶片 
2011台塑應用研討會績優論文獎-低硬體成本之風力-太陽能雙模發電系統全數
位折疊式最大功率追蹤晶片設計與實現 
2011 MATLAB &Simulink 論文比賽優選獎-折疊式風力太陽能雙模發電系統之最
大功率追蹤晶片設計 
99 中華民國風能學術研討會-優秀論文獎 PWM 整流器應用於小容量風力發電機
電力品質及噪音之改善 
100中國電機工程學會青年論文獎第三名-具功因校正及諧波改善之市電併聯型
風力發電系統研製 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
