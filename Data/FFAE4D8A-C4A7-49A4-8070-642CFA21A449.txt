  
行政院國家科學委員會專題研究計畫成果報告 
計畫名稱：電能處理系統之精緻化與加速壽命測試研究- 
子計畫二：太陽能直流供電系統-最大功率追蹤器之精緻化研究 
                  計畫編號：98-2221-E-150-070- 
執行期限：98 年 08 月 01 日 至  99 年 07 月 31 日 
    主持人：陳裕愷  副教授   國立虎尾科技大學飛機系航電組 
                       計畫參與人員：王韋勝、呂育政 
ㄧ、摘要 
    本子計畫提出一新型最大功率追蹤控制器應
用於太陽能直流供電系統，所謂新型最大功率追
蹤法是以擾動觀察法配合灰色預測改進擾動觀察
法固定變量之缺點，以減少在最大功率點附近的
擾動量，進而達到更準確的最大功率追蹤。在電
源系統硬體部份，我們設計了最大功率追蹤控制
器並以軟切式直流/直流轉換器來實現。最後以電
路及電感模擬和硬體電路進行系統整合測試，驗
證此系統之正確性與可行性。 
關鍵字︰擾動觀察法、灰色系統、軟切式直流/直
流轉換器 
Abstract-This sub-project presents the design and 
implementation of a new maximum power point 
tracking (MPPT) controller for PV DC-Power 
systems. The conventional perturbation and 
observation MPPT method is modified with a grey 
prediction method to achieve the optimal 
perturbation step and improve the efficacy of the PV 
system in this sub-project. In addition, the analysis 
and design of the proposed MPPT controller with 
soft-switching DC/DC converters is proposed in the 
project. Simulated using matlab and JMAG and 
experimental results from a prototype have 
confirmed the effectiveness and feasibility of the 
proposed approach. 
Keywords: P&O, Grey system, Soft-switching 
converter 
二、計畫緣由與目的 
利用太陽能板將太陽光轉換為可用的能量，
加上現在全球能源危機浮現人類積極尋找可用的
替代能源，包括太陽能、風力、潮汐等，而太陽
能是一種免費、無污染且又取之不盡、用之不竭，
是一種可以利用來發電的一種相當好的能源。近
幾年來太陽能板的技術越來越成熟，效率也越來
越高，但價格上還是稍嫌昂貴，所以如何有效的
利用太陽能板所產生的能量是目前衛星上重要的
課題。 
因為太陽能板物理特性其電壓與電流是非線
性的關係，在不同的工作環境下會有不同的工作
曲線。而每一條工作曲線均只有一個最大功率
點，若將太陽能板直接與負載連接並無法得到最
大功率，這樣會造成能量的損耗[1]。因此為了提
高太陽能板工作效率必須做最大功率點追蹤控
制，使負載能夠有效利用太陽能板的能量。如何
找出一最佳之最大功率追蹤控制機制並以高效率
之轉換器來實現此MPPT之電路架構，此乃是本計
畫之研究動機與目的。 
三、研究方法 
3-1 電源系統基本架構 
電源系統架構基本上可分做三個部份，能量
產生、能量儲存、能量分配與管理。能量產生在
系統上主要是利用太陽能板吸收太陽光輻射，然
後轉換成電能。能量儲存使用可重複充放電之蓄
電池，將太陽能板所產生的電能儲存，然後提供
系統在夜間時使用其的電能，或者在必要時能提
供系統在太陽能電池的功率不足時的電量。能量
分配與管理亦是電源系統的管理者，功能是在分
配及管理電源，使電源系統的電源能做更有效的
利用其架構圖如圖1所示。 
 
圖1、MPPT電路系統架構圖 
3-2 太陽能板特性 
太陽能板內部是由一等效電流源、二極體、
串聯電阻Rs與分流電阻Rsh所組成，其等效電路
圖，如圖2所示。串聯電阻的產生是因為半導體本
身存在著電阻，而且在半導體與金屬的接觸間也
會有電阻存在，這些電阻就如同一個串聯電阻一
般。再者太陽電池元件的電路間，會有些許漏電
流Ileak，分流電阻即為V/Ileak，當分流電阻越小
時，漏電流就越大。通常在分析太陽能板時Rs的
值很小，而Rsh的值很大，因此為了簡化分析過程
可將Rs和Rsh忽略不計。由半導體物理特性可推導
出太陽能板方程式，I為太陽能板電流，P為太陽能
板最大功率，如式(1)、(2)所示[2], [3]： 
= - exp -1p ph p sat
s
qVI n I n I
kTAn
⎡ ⎤⎛ ⎞⎢ ⎥⎜ ⎟⎢ ⎥⎝ ⎠⎣ ⎦
        (3-1) 
  
d、e依序移動，可看出照度快速變化會讓工作點產
生振盪造成能量的損失。由圖2與圖3之太陽能板
V-I-P 3D模擬特性曲線可知，當環境溫度與照度變
化時太陽能板之發電最大功率亦會成接近線性之
關係，故可以灰色理論來預估其可能之下一個太
陽能板之最大功率值。 
3-4 灰色理論 
灰色系統[7]全名為灰色系統理論分析(Grey 
System Theory)，是由中國鄧聚龍教授於1982年提
出，此理論主要是針對系統模型之不明確性，資
訊之不完整性之下，進行關於系統的關聯分析、
模型建構、藉預測及決策之方法來探討及瞭解系
統。灰色理論的應用範圍極廣，主要能對事物的
不確定性、多變量輸入、離散的數據及數據的不
完整性做有效的處理。 
灰色系統理論最主要的功能即是找出影響系
統之參數，並建立其數學關係式，依據模型之用
途與描述方法不同，則有不同的關係式。而灰色
理論其研究的方式可以分為： 
1. 灰生成(Grey Generating) 
2. 灰關聯分析(Grey Relational Analysis) 
3. 灰建模(Grey Model) 
4. 灰色預測(Grey Prediction) 
5. 灰決策(Grey Decision Making) 
6. 灰控制(Grey Control) 
本計畫所使用的灰色預測(Grey Prediction)是
以 GM(1,1)為基礎對現有數據所進行的預測方
法，一般分成數據預測、異常預測、拓墣預測、
系統預測。而對於最大功率追蹤本計畫使用數據
預測，只要原始數據有 4 筆以上，就可通過生成
變換來建立灰色模型。此外，在灰色系統理論中
對數據量的要求並不嚴苛，因此只需少量的數據
便可進行建模，對於訊息不完整或資料數較少的
系統環境，此理論也就發揮了它的實用性。 
    利用 GM(1,1)模型再根據擾動觀察法所擷取
的功率數據，便可預測出下一步需增載減載的變
化量大小，讓控制器能快速的追蹤到最大功率
點，減少擾動過程中能量的損失。將擾動觀察法
流程圖加入灰色系統理論後，本計畫的預測型最
大功率追蹤流程圖就如圖 5 所示，在更新數據後
去做下一次功率的預測，之後便能快速決定增減
載方向及變化量之大小。 
GM(1,1)模型是最常使用的一種灰模型，表示
為一階微分，輸入變數為一個，其建模生成步驟
如下： 
  1.  假設有變數 )0(X ： 
)}(),....,2(),1({ )0()0()0()0( nxxxX =         (4-1) 
  2.  作一次累加生成模型 )1(X ： 
 )}(),......,2(),1({ )1()1()1()1( nxxxX =        (4-2) 
  3.  GM(1,1)的灰微分方程為： 
 bkazkx =+ )()( )1()0(             (4-3) 
     ( ) ( ) ( )( ))1()(5.0)( 111 −+= kxkxkz        (4-4) 
  4.  根據最小平方法，令 
        
 
 
 
 
   利用 NTT YBBBa 1)(ˆ −=                  (4-5) 
解出 a、b 值求出 
 
  5.  所得之 a、b 值代入響應方程式： 
 
a
be
a
bXkX ak +−=+ −])1([)1(ˆ )0()1(       (4-6) 
  6.  利用累加生成還原成 (k))0(X 的型態即可得
之預測值：  
 (4-7)  
 
預測型最大功率追蹤其控制方式如圖7所
示，以下做一簡單說明： 
Step 1：擷取太陽能板目前電壓與電流計算出其功
率。 
Step 2：假設目前電壓由V3*增加到V2*，功率也由
P3增加到P2，並由數據預測模型式子(4-1)~(4-7)預
測出下一點為V1*與P1，此時應該繼續增加參考電        
壓Vref*往最大功率點Pmax移動。 
Step 3：若繼續增加電壓到V1，預測點為V1與P1，
此時超過最大功率點Pmax，此時應減少參考電壓
Vref* 讓工作點回到最大功率點。 
根據Step1~Step3將擾動觀察法流程圖加入灰
色系統理論後，本研究的預測型最大功率追蹤流
程圖就如圖5所示，在更新數據後去做下一次功率
的預測，之後便能快速決定增減載方向及變化量
之大小。 
 
圖 4、預測型最大功率追蹤控制法之 P-V 曲線說明
圖 
)1(ˆ)(ˆ)(ˆ )1()1()0( −−= kxkxkx
⎥⎥
⎥⎥
⎦
⎤
⎢⎢
⎢⎢
⎣
⎡
−
−
−
=
⎥⎥
⎥⎥
⎦
⎤
⎢⎢
⎢⎢
⎣
⎡
=
1)(
1)3(
1)2(
)(
)3(
)2(
)1(
)1(
)1(
)0(
)0(
)0(
nz
z
z
B
kx
x
x
Yn MM
  
 
圖 8、 對稱型半橋橋式整流型轉換器 
 
圖 9、 具軟切換架構之半橋轉換器 
圖 10 所示為不同功率下，硬切換與軟切換之
效率圖，由此圖可以看出在功率在 300 W 至 1.2 
kW 間，軟切換之效率皆高於硬切換之效率，而當
功率為 1.2 kW 時，其效率可達到 92.3%。 
84.00%
85.00%
86.00%
87.00%
88.00%
89.00%
90.00%
91.00%
92.00%
93.00%
0 200 400 600 800 1000 1200 1400
輸入功率（W）
效率 硬切換
軟切換
 
圖 10、不同功率下之硬切換與軟切換之效率圖 
3-7 MPPT量測 
為了方便測試，本計劃利用電源供應器串聯
電阻棒的方式模擬太陽光電板之非線性特性，如
圖 11 所示。 
 
圖 11、MPPT 測試方法 
 根據最大功率轉移定理，當 MPPT 追蹤至最
大功率時，電阻 Rm所消耗之功率與 MPPT 之功率
會相等，而電阻上之跨壓 VRm會等於 MPPT 之輸
入 電 壓 Vi ， 即
2
dc
Rm i
VV V= = ，
2 2
4
Rm dc
mpp i i
m m
V VP V I
R R
= × = = 。而 MPPT 準確率之計算
方式如下： 
準確率(%)= | |1 100%i i mpp
mpp
V I P
P
⎛ ⎞−− ×⎜ ⎟⎜ ⎟⎝ ⎠
  (7-1) 
圖 12 所示為 Vdc=600V，Rm=105Ω時之 Vi與 Ii波
形圖，此時應追蹤之最大功率 2600 857.14
4 105mpp
P = =×
 
W ， 而 MPPT 所 追 蹤 到 的 功 率 為
327.13 2.6859 878.64iP = × =  W ， 準 確 率 為
97.49%。 
 
（Vi：50 V/div, Ii：500 mA/div, time：1 s/div） 
 
圖 12、Vdc=600 V，Rm=105 Ω時之 Vi與 Ii波形圖 
 圖 13 所示為不同功率下，MPPT 追蹤之準確
率示意圖，在功率為 100 W 時，其準確率僅有
91.87%，因其取樣解析度不佳，使得回授訊號容
易被雜訊所干擾；而在功率為 900 W 時，準確率
可達到 97.49%。 
MPPT準確率
91.00%
92.00%
93.00%
94.00%
95.00%
96.00%
97.00%
98.00%
0 200 400 600 800 1000
功率(W)
準確率
 
圖 13、不同功率下，MPPT 之準確率示意圖 
3-8 磁性元件之分析與設計 
    此部份將以軟體模擬與工程量測為主軸，希
望能對其他子計畫系統之磁性元件設計與分析有
所幫助。此外，亦可增加系統之整體效率及可靠
度。磁性元件之量測與材料之分析已由中鋼高磁
公司予以必要之協助。 
電感與變壓器設計時對鐵心之要求會有以下幾點
注意事項： 
z 高飽和磁通密度—防止鐵心工作於飽和
區，而失去磁性 
z 高導磁率—易激磁、耦合較好、能量轉換能
力強 
z 高工作頻率—在高頻下工作磁氣特性不受
影響 
z 高溫度穩定度—磁氣特性不受環境溫度影
響 
z 低功率損失—提高效率及減低溫升 
表 Y04 
行政院國家科學委員會補助國內專家學者出席國際學術會議報告 
                                                            99 年 06 月 28 日 
報告人姓名 陳裕愷 服務機構
及職稱 
國立虎尾科技大學 
飛機工程系/副教授 
   時間 
會議地點 
99 年 6 月 21日起至 25日
日本札幌 
本會核定
補助文號
 
會議 
名稱 
 (中文) 2010國際電力電子研討會 
 (英文) IPEC-ECCE ASIA 2010 
發表 
論文 
題目 
 (中文) 預測型最大功率追蹤控制器應用於太陽能微衛星之研究 
 (英文)  Prediction Maximum Power Point Tracking Method for PV-Battery 
        Micro-Satellite Systems with Body Mounted Solar Panels 
報告內容應包括下列各項： 
一、 參加會議經過 
此研討會於民國 99年 6月 21號至民國 99年 6月 24號，「IPEC-Sapporo 2010」此
研討會是由 IPEMC與 ECCE-ASIA共同舉辦，今年為第一次合辦，IPEC屬於國際性的
研討會，結合了許多電力電子與電機控制與技術方面資訊。 
1. Static Power Converters 
2. Power Semiconductor Devices and Packaging 
3. Modeling, Simulation, EMI and Reliability 
4. Electric Machines, Actuators and Sensors 
5. Motor Control and Drives 
6. Motion Control and Robotics 
7. Renewable Energy and Energy Saving 
8. Power Electronics Applied to Power Systems 
9. Power Electronics and Drives Applied to Railway Systems 
10. Power Electronics and Drives Applied to Electric and Hybrid Vehicles 
11. Power Supply for Information and Communication Technologies 
12. Power Electronics and Drives Applied to Home Appliance 
13. Education in Power Electronics and Electrical Engineering 
14. Other Related Topics 
此次研討會內容相當豐富，投稿論文分別來自於 40 個不同國家的論文，此次投稿
文章共有 654篇，共接受 417篇論文，此研討會將發表方式分成兩種：「Oral Session」
與「Poster Session」。 
本次大會安排三位 plenary Talk及兩場次的 Industrial seminar等會議內容，使本次會
議增加許多豐富內容並且富有多樣性，增加研究之能量。 
 
 
無研發成果推廣資料 
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
已協助國內相關產業之技術發展並洽談合作技術 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
