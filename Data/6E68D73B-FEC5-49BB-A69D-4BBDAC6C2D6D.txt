2 
壹、前言 
 
本文作者於 2010年[1]成功發展結構光條紋視覺系統之校正與表面量測，此技巧係使用特
殊格點排列的校正試件同時校正相機及雷射投影機；由平面物體的剛體平移量測試驗，顯示
此系統的深度量測基本誤差為± 4 μm左右。本校正技巧可使用多達 3000個左右的控制點來求
取光條紋平面，因此量測精準度遠比 Zhou與 Zhang [2]所使用的校正方法（僅使用 10多個控
制點求取光條紋平面，深度方向量測誤差約為 0.225 mm）來的高。其他如使用雷射光點的結
構光條紋視覺量測系統[3-5]的深度方向量測精準度則約為 0.10 mm與 0.20 mm之間。 
當以此校正過的系統量測曲面物體時，由於雷射投射角度之影響，當物體移動至某一位置
時將引起雷射平面與物體表面相切，造成雷射光條紋無法投射至位於此切面下的物體表面，
使得系統無法量測其表面輪廓，因此本文在相機的另一側多加裝一台雷射投影機（如圖 1 所
示），並調整校正方法，以解決此問題。本文亦進行圓管量測實驗，以評估本系統量測曲面
時的誤差。 
 
 
圖1 結構光條紋視覺系統示意圖 
貳、研究方法 
一、理論背景 
（一）針孔相機模型(Pinhole Camera Model) 
一般相機可視為由鏡頭(lens)與影像平面所組成，如圖 2所示，影像平面在鏡頭中心 C之
前，而焦距ƒ則為影像平面至鏡頭中心的距離。O及 O’分別為世界座標系統(world coordinate 
system)X-Y-Z以及影像平面座標系統(image coordinate system)u-v的座標原點，C則為相機的
鏡頭中心，同時也是相機座標系統 (camera coordinate system)x-y-z 的座標原點。影像座標系
統的 u軸與 v軸分別平行於相機座標系統的 x軸與 y軸，其原點則位於影像平面的左上角 O’。
空間中某一點 P(X, Y, Z)投影至影像平面上為 Pc(uc,vc)，此點即為 C點與 P點連線與影像平面
之交點，由相似三角形的關係，可得 P(X, Y, Z)與 Pc(uc,vc)關係式： 
1
c
c
X
zu
Y
zv F
Z
z
 
   
   
   
    
 
=               (1) 
其中 F為一透視轉換矩陣，由焦距 f、影像平面中心(uc,vc)、描述世界座標與相機座標間平移
關係的平移矩陣
T
x y zt t ,t ,t =   以及旋轉矩陣 R = R(θ, φ, ϕ)所定義。其中 θ、φ與 ψ分別為繞 y
軸、x軸以及 z軸作左右搖動 (pan)、上下傾斜 (tilt) 與旋轉 (swing) 的角度。然而在實際取
4 
2
2
1 0 0
0 1 0 0
0 0 11 1 1 1
T T
h h h h
h h h h
x x x xr
y r y y Q y
 −       
        − = =        
                
       (4) 
使用式(1)，圖可被投影至影像平面上，但會變成橢圓或者仍舊是圓。橢圓(ue, ve)中心可以下
式求得[7]。 
1
0
0
11
e
T T
e
u
λv F(HQ H )F−
   
   =   
     
            (5) 
使用式(3)，可將橢圓中心(ue, ve)轉換成扭曲的影像座標(ud, vd)。 
d e
d e
u u u
v v v
δ
δ
     
= +     
    
              (6) 
最後，可使用下式將此控制圓點於影像平面上的投影點座標單位由mm轉換成pixel。 
x d
y d
u M u
v M v
=
=
               (7) 
上式，Mx與My分別為在u與v軸方向的比例係數，其單位為 pixel/mm，可將實際物理單位 
mm 轉換為影像單位 pixel。  
透過以上的轉換，可得到在世界座標中任意控制圓點中心，在影像平面上的座標位置，
由上述轉換，可知共有 15 個相機參數，其中Mx，My，ƒ，k1，k2，p1，p2 以及(u0, v0)為相機
的內部參數 (intrinsic parameter)。而 ( , , )x y zt t t 和 (θ, φ, ϕ)則為相機的外部參數  (extrinsic 
parameter)。 
利用上述方程式(5) ~ (7)，可將一個在三維世界座標下的控制圓點中心，對映到二維影像
平面上，因此可將三維的場景投影到二維影像平面上。然而此對映的轉換過程係屬於多對一
的轉換，如果只使用一台相機時，即無法獲取深度的相關資訊。所以本計畫以雷射投影機投
射一單線段光條紋於待測誤表面上，以便由2D的條紋影像求取待測物表面的深度資料。 
若已知空間中S個控制圓點中心的世界座標位置，以及此S個世界座標點在相機之影像平
面上相關的影像座標(Uj, Vj)，j = 1, …, S，即可以非線性最小平方法[8]，求得相機的最佳15
個相機參數，使得經由相機模型方程式求得的影像對座標(uj, vj)與實驗值(Uj, Vj)之間的誤差為
最小，亦即使下式之值為最小值。 
{ }2 2
1
( ) ( )
j
j j j j
j
S
E U u V v
=
=
= − + −∑            (8) 
（三）投影機模型(Projector Model) 
圖4顯示結構光條紋量測系統之投影機模型，圖中顯示，光條紋平面πs上的任意點Ps於影
像平面πc上的理想投影點為Pc，也就是Ps為 cCP

射線與光條平面πs的交界點。因此，如果已知πs
與 cCP

相對於世界座標系統X-Y-Z 的平面方程式與線方程式，即可決定相對於世界座標系統 
X-Y-Z的Ps點的座標位置。  
對於投射於某一物體表面上的光條內的任意點Pn，若其相對於世界座標系統 X-Y-Z 的座
標為 Pn(X, Y, Z)，則投影機所投射出來的光條平面方程式可表示為 
6 
上述方法雖可求得位於Ls線上的N個控制點Qj，但仍無法由此N個共線的控制點求取光條
平面的方程式。為取得三個以上的非共線點，以決定光條平面的方程式，本計畫將沿著相機
主光軸方向移動校正試件至m個不同位置處，並以CCD相機攝取各校正平面之影像，以決定
位於各校正平面上的光條中心線上的各個校正控制點。理論上來說，由於計算誤差的關係，
所得到的校正控制點位置並非剛好都在光條平面上，所以一個距離所有控制點最近的平面，
即為所要求取的光條平面。所有校正控制點至方程式(10) 所表示的光條平面的距離平方和為 
2
1
2 2 2
1 0
( , , , )
i i im N
j j j
i j
aX bY cZ d
f a b c d
a b c
−
= =
 + + +
=  
+ + 
∑∑          (10) 
使用非線性最小平方法使 f 之值為最小，即可得到光條平面的方程式。 
二、校正方法 
（一）格點中心之求取 
本文採用固定間距的圓形格點中心座標，以作為相機校正時所需的校正點。若相機之影
像平面與圓形格點校正試件表面兩者互不為平行時，所擷取影像之圓形格點將成橢圓形狀
[7]。本文將原始影像做 Sobel Operator 的遮罩運算，以求得影像的灰階梯度，並凸顯出圓形
或橢圓形物件的邊緣，接著以[9]所述的次像素邊緣搜尋法得到物體影像邊緣具次像素精度的
座標點，即可由這些邊界點求得圓形格點或橢圓形格點的中心座標位置[9]。 
（二）Scale Factor之求取 
由於影像的最小單位為像素(Pixels)，而實際在空間中的物理單位則為mm或µm等，因此
需求取Scale Factor以利兩單位間的轉換。本實驗以精密三軸平移台，將圓形格點試件水平向
移動一距離SY mm，並以相機擷取其移動前後之影像。接著再分別求取N × N陣列中某一行的
格點在平移前後於影像平面上的平均移動距離 YS  pixels，即可求得水平方向之Scale Factor SF 
(mm/pixel)，本文亦將以類似的方法求取垂直方向的 Scale factor SFZ，初步的實驗結果顯示，
垂直方向的SFZ與水平方向的SFY非常接近。 
 
（三）結構光條紋視覺系統之校正步驟 
在求取Y軸向與Z軸向的Scale factor之後，本文以下列步驟進行結構光條紋視覺系統之校
正： 
(1) 將具有格點陣列之校正試件固定於高精度的三軸平移台上，並調校格點試件使其與相機
之主光軸垂直。 
(2) 開啟左邊雷射投影機之電源，使光條紋投射於試件上，如圖5所示。 
(3) 以相機擷取P × Q陣列的格點及雷射光條紋影像，求取各校正點在影像座標系統下的座標
位置(Un,Vn)。 
(4) 以P × Q格點陣列中心之格點為試件平面座標系統Y-Z之座標原點，經由座標轉換，即可
求得此P × Q陣列格點相對於 Y-Z 座標系統的座標位置，將此座標位置乘以比例係數
(scale factor)，以便將pixel單位轉換為mm的空間物理單位，即得世界座標系統下P × Q個
校正點的座標位置(0, Yn, Zn)以及其於影像平面上的相關影像點位置(Un,Vn)。同時也以
Luo [10]等人提出之缺陷排除最小平方法及角平線方程式，求取雷射光條紋中心線 0sL 方
程式。 
(5) 關閉左邊雷射投影機並開啟右邊雷射投影機之電源，使光條紋投射於試件上，如圖6所
示。以相機擷取格點及雷射光條紋影像，並求取雷射光條紋中心線 0sR 方程式。 
(6) 開啟左邊雷射投影機並關閉右邊雷射投影機之電源，使光條紋投射於試件上。 
(7) 移動平台將試件沿著X軸之正方向移動D mm之距離，並以CCD相機擷取影像，即可得(D, 
Yn, Zn)之世界座標點，以及上述各點於影像平面上的位置，同時也求取影像平面上的雷
射光條紋中心線 DsR
+
 方程式。 
8 
統的基本量測誤差。 
(6) 關閉左邊雷射投影機並開啟右邊雷射投影機之電源，並以CCD相機擷取其影像。重複步
驟(3)至(5)，以評估使用右邊雷射投影機時本系統的基本量測誤差。 
本文於X方向移動校正試件至X = 8 mm、5 mm、−5 mm以及−8 mm 等四個位置，以進行
基本量測誤差之評估。 
四、物體表面之3D量測 
在完成結構光條紋視覺系統之校正及誤差評估後，本文以如下所示之流程進行物體表面
之3D量測： 
(1) 將待測物固定於平移台上，並使待測物本身深度平均置於世界座標系統下Y-Z平面之兩
側。 
(2) 將平移台往+Y方向移動D mm的距離，直至無法再移動為止，以期能做最大範圍之檢測。 
(3) 調整待測物至離左邊雷射投影機所投射的雷射光條紋約1 mm左右之位置，此時光條紋並
未投影至待測物表面。 
(4) 開始設定程式所需之相機校正參數及每次平移台的移動距離d mm。 
(5) 開啟左邊雷射投影機以投射光條紋至待測物置放區域。 
(6) 以98年度核定計畫所發展的曲線結構光偵測法抽取光條紋曲線之次像素位置，即可由此
第一條結構光曲線上的2D影像點精確求出相對應的物體表面上的相關點的3D世界座標
(X, Y, Z)。 
(7) 由於平移台已先移動D mm之距離，所以上一步驟所求得之座標值需修正為(X, Y−D, Z)。 
(8) 之後平移台每往−Y方向移動一固定距離d mm，則使平移台停止並取像進行分析，所求
得之世界座標將為(X, Y−H+nd, Z)，n為移動次數。 
(9) 當掃瞄至物體表面深度的最高點時，關閉左邊雷射投影機並開啟右邊雷射投影機以投射
光條紋至待測物置放區域。 
(10) 重複(9)、(10)以及(11)等三個步驟，直至掃描完整個待測物表面並將所求得之3D資訊予
以儲存以利更進一步之分析。 
五、圓管尺寸量測 
以校正的結構光條紋視覺系統量測圓管，可得到在圓管表面上的光條紋的各特徵點的世
界座標 (X,Y,Z)，這些點將在雷射光條紋平面上形成一圓弧。圖 7為所求取之 3D資料點(理論
上應成一圓弧)以及試件座標系統 x-y-z 之示意圖。由於在完成結構光條紋視覺系統之校正
後，即可求得世界座標系統 X-Y-Z以及光條紋平面方程式 aX + bY + cZ + d = 0，因此光條紋
平面之單位法線向量 n可以下式表示 
2 2 2 1 2
( , , )n
( )
a b c
a b c
=
+ +
             (11) 
本文以第一個 3D 資料點的世界座標值 (X1,Y1,Z1) 以及最後一個資料點之世界座標值 
(Xn,Yn,Zn)，估計圓弧的圓心座標值 (X0,Y0,Z0)： 
1 n 1 n 1 n
0 0 0
X +X Y +Y Z +ZX = , Y = , Z =
2 2 2
         (12) 
以及 x軸向的單位向量 u： 
1 0 1 0 1 0
1 2 32 2 2
1 0 1 0 1 0
(X -X ,Y -Y ,Y -Y )u (u ,u ,u )
(X -X ) (Y -Y ) (Z -Z )
= =
+ +
        (13) 
由光條紋平面的單位法線向量 n以及此 x軸向之單位向量 u即可求 y軸向之向量 v 
10 
備以形成結構光條紋視覺系統。本文係以UTRON FV2020鏡頭搭配CCD相機係，所使用的雷
射投影機則搭配單線投影鏡頭且大約平掃(pan)25°，以產生單光條紋平面。 
本文採用上述步驟進行相機及雷射投影機之校正，表1顯示使用左邊雷射的結構光條紋視
覺系統在X軸向的基本量測誤差數據，由剛體平移的實驗結果發現平均深度量測誤差約在5 
µm以內。而表2則顯示使用右邊雷射的結構光條紋視覺系統時其平均深度量測誤差約在6 µm
以內。 
 
  
圖8 實驗設備 圖9 臉譜模型 
 
  
圖10 使用左邊雷射所得之雷射光條紋綜
合影像圖 
圖11 使用右邊雷射所得之雷射光條紋綜
合影像圖 
 
圖12 Orthographic臉譜視圖 
12 
 -20 -10 0 10 20x (mm)
-20
-10
0
10
20
y 
(m
m
)
Experiment data
Fitted circle
 
圖16 R17.5圓管表面的量測資料點與所求得的圓管斷面的圓弧 
肆、結論與建議 
本文係利用一特殊排列的格點陣列，使得相機校正與雷射投影機校正得以同步執行。本
文所擷取影像之解析度為1280 × 1024 pixels，因此可得到3000 個左右的位於雷射光條紋平面
上的非共線的校正控制點，以校正雷射投影平面。由於雷射投射角度之影響，當物體移動至
某一位置時將引起雷射平面與物體表面相切，造成雷射光條紋無法投射至位於此切面下的物
體表面，使得系統無法量測其表面輪廓，因此在相機的另一側多加裝一台雷射投影機，並調
整校正方法，以解決此問題。本文亦利用結構光條紋視覺系統量測圓管尺寸，實驗結果顯示
圓管半徑量測誤差約在70µm以內。本文目前所使用的細線化所求得的雷射光條紋曲線中心線
座標值只具有1 pixel的精度，未來如能求得具次像素精度的雷射光條紋中心，將可使本系統
於量測待測物表面時更加準確。 
 
14 
 
X 
(mm) 
MEAN 
(µm) 
VARIANCE 
(µm) 
STANDARD 
DEVIATION 
(µm) 
-8 5.147 0.0026 5.092 
-5 3.524 0.0016 4.026 
5 1.810 0.0083 2.083 
8 4.733 0.0020 1.401 
表 1 結構光條紋視覺系統深度方向的量測誤差（左邊雷射） 
 
X 
(mm) 
MEAN 
(µm) 
VARIANCE 
(µm) 
STANDARD 
DEVIATION 
(µm) 
-8 5.822 0.0018 1.085 
-5 3.568 0.0049 4.116 
5 2.930 0.0095 4.739 
8 4.733 0.0082 6.795 
表 2 結構光條紋視覺系統深度方向的量測誤差（右邊雷射） 
 
Position of 
Cross 
Section  
Laser  CMM  Error (mm)  
1  10.1298  10.06240  0.0674  
2  10.0974  10.05895  0.0385  
3  10.0601  10.05400  0.0610  
4  10.0867  10.05575  0.0310  
表 3 R10圓管試件於不同斷面位置的量測誤差評估 
 
Position of 
Cross 
Section  
Laser  CMM  Error (mm)  
1  17.5513 17.5270 0.0243 
2  17.6043 17.5307 0.0736 
3  17.5079 17.5340 0.0261 
4  17.5933 17.5370 0.0563 
表 4 R17.5圓管試件於不同斷面位置的量測誤差評估 
 
 
99 年度專題研究計畫研究成果彙整表 
計畫主持人：羅鵬飛 計畫編號：99-2221-E-216-035- 
計畫名稱：結構光條紋視覺系統表面量測與軟體開發之研究 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 1 1 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 1 1 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 0 1 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
