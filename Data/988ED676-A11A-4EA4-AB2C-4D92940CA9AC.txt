2 
 
訊息、抵抗重送攻擊、降低阻斷標籤服務攻擊的影響力。 
 
文獻探討 
2006 年 John Ayoade 提出一個區隔讀取器授權控制架構[6]，利用在資料庫建立讀取
器與電子標籤的權限表達到授權的效果，當讀取器要讀取某個電子標籤的資訊時，電子
標籤回應給讀取器電子標籤識別碼和加密的資料，讀取器再向資料庫請求解密的金鑰，
授權和所有權轉移的實際轉換可以利用委任(delegation) [2,9-11]或一次性暫時電子標籤
識別碼[7]的方法。透過資料庫給予讀取器密鑰，解開欲轉移所有權電子標籤傳出的加密
訊息，並藉由次數限制委任(Time-limited delegation)限制委任授權之讀取器讀取電子標
籤的次數門檻值，以限制被委任讀取器讀取電子標籤計數器的次數。或資料庫利用由欲
釋放所有權之讀取器給予的密鑰產生的所有權識別碼，資料庫藉由新的辨識碼來確認電
子標籤的所有權。 
然而執行所有權轉移過程中，可能會因為沒有滿足 Backward Security 造成所有權轉
移不完全的問題發生[2]，使得舊擁有者還可繼續讀取該電子標籤直至電子標籤計數器達
上限值。若沒有注意到 Forward Security 則會造成所有權轉移過程可被追蹤而侵犯新、
舊擁有者的隱私權，所以當舊擁有者將電子標籤所有權轉移給新擁有者之後，必須保證
舊擁有者已經沒有任何權限去讀取所有權轉移後的電子標籤，且新擁有者無法追蹤該標
籤之前的轉換過程及內容。因此 Fouladgar[9-11]等人提出利用委任的技巧來解決轉移所
有權不完全的問題，當新擁有者利用讀取器執行所有權轉移時，讀取器藉由雙方所信任
的 CA 確認新擁有者讀取器的電子憑證。當認證伺服器確認憑証為正確時，會產生當次
所有權轉換所需的對稱密鑰，並更新電子標籤舊有的對稱密鑰，使得電子標籤傳出的加
密訊息只有擁有者才可以解開。 
  為了在 Mobile RFID 環境下可以進行所有權轉移，我們於本計畫中提出一個適合
Mobile RFID 環境下，標籤與讀取器的雙向認證和所有權轉移方法，在 Mobile RFID 環
境中行動讀取器因具有移動性且可能為惡意攻擊者所使用來偽裝合法讀取器，以進行中
間人攻擊。因為行動讀取器不同於傳統 RFID 環境沒有假設其與資料庫溝通為安全通道
以及讀取器可能是惡意設備，所以我們所提的方法當讀取器讀取電子標籤時，讀取器和
電子標籤必須先進行雙向認證，互相確認身份之後再透過資料庫取得電子標籤相關資
料，也可透過變更電子標籤的金鑰達到所有權轉移的目的。我們所提之方法可降低電子
標籤計算成本外，可以讓讀取器不需儲存任何共享金鑰即可讀取電子標籤且可避免未經
授權讀取器取得電子標籤的資料。此外，我們所提出的方法可以確保傳輸的位置隱私、
資料隱私、向前安全，防止攻擊者可以追蹤標籤位置或標籤所有權轉移的歷史。此外，
還可避免惡意攻擊者竄改訊息、抵抗重送攻擊、降低阻斷標籤服務攻擊的影響力。 
 
研究方法 
  為了可以在可能為攻擊者的移動讀取器之 Mobile RFID 環境中進行所有權轉移，我
們於本計畫中提出一個可以應用在 Mobile RFID 環境下執行的雙向認證及所有權轉移的
方法 MACOT(Mobile Access Control and Ownership Transfer)，而 MACOT 不僅可以讓資
料庫和電子標籤驗證讀取器的合法性，使不同讀取器讀取相同電子標籤有不同權限的存
取控制，並可藉由更新金鑰達成所有權轉移的目的。 
 
Mobile RFID 環境及方法假設 
我們於 Mobile RFID 環境下提出具有驗證移動式讀取器身份使得惡意移動式讀取器
任意讀取電子標籤的安全雙向認證及所有權轉移方法。由於行動 RFID 讀取器具高度移
4 
 
電子標籤間之共享金鑰 Kx、Ky，以及一個為標籤擁有者讀取器與其標籤之共享金鑰 PIN，
和共享秘密值 C，而資料庫需要維持每個擁有者的金鑰 PIN 值及秘密 C 值，其資料庫、
讀取器、和標籤所擁有之密鑰如圖 3所示。 
 
圖 3 (a)資料庫(b)擁有者讀取器(c)電子標籤所共有之秘密值 
為了讓行動式讀取器可以在 Mobile RFID 環境下讀取電子標籤並執行標籤所有權轉移，
我們利用儲存在資料庫與電子標籤的資料表，過濾非授權的讀取器，使得授權讀取器根
據電子標籤允許讀取器層級可執行的動作，從資料庫取得標籤資料。並可透過更新電子
標籤金鑰，將標籤所有權轉移。我們提出的標籤所有權轉移方法分成三個階段，第一階
段為移動式雙向認證程序，第二階段為所有權轉移程序，第三階段為更新層級對應動作
資料表程序。 
 
移動式雙向認證程序 
讀取器要對電子標籤進行讀取時，讀取器必須先取得跟資料庫溝通之通訊金鑰
(session key) Kdr，用該金鑰加密資料庫和讀取器間之訊息，而安全交換通訊金鑰的演算
法可以利用現有的 Elliptic curve cryptosystems[3,8]或其它任何現有交換金鑰的方法。資
料庫完成認證讀取器並將通訊金鑰交予讀取器後，讀取器即可送出對電子標籤的讀取請
求，其讀取所需的四個認證步驟如下： 
步驟 1. 後端認證伺服器首先需認證電子標籤的合法性。當讀取器對電子標籤發出讀取
請求，電子標籤會產生隨機亂數 r1，且將 r1 與標籤辨識碼 TID 做 Exclusive OR 並透過
金鑰 Kx 執行金鑰雜湊函數運算產生一秘密值 S， 
)rTID(hS 1Kx   
讀取器收到 S 與 r1 之後會產生隨機亂數 r2，隨後把讀取器識別碼 RID、包含電子標籤身
分的 S、讀取器對電子標籤要求之指令 Command、r1、r2，以金鑰 Kdr 加密後，將
)Command,RID,r,r,S(E 21kdr 傳送到資料庫。資料庫可以利用 RID 對應的 Kdr 將訊息解開後，
利用 TID 對應的金鑰 Kx 進行金鑰雜湊運算搜尋符合 S 的 TID 值。以秘密值 S 內的 TID
驗證電子標籤身份，且加入 r1 和金鑰 Kx，避免攻擊者利用 TID 追蹤標籤電子標籤位置，
並藉由金鑰 Kx 降低攻擊者猜測出 TID。 
步驟 2. 讀取器和電子標籤利用資料庫產生之祕密值進行雙向認證。資料庫將所得到的
TID 和讀取器存取控制表比對，找出該讀取器之存取權限，產生隨機亂數 r3 並在讀取器
存取控制表找出該讀取器授權層級 RC。隨後資料庫將 TID、r1、r2、r3 做 Exclusive OR
並利用金鑰 Ky 將結果以金鑰雜湊函數運算產生驗證用 T 和 p 值如下： 
)Command,RC,rrrTID(hT 321Ky   
)TIDr(hp 3Ky   
資料庫將 T、p、r2 及 r3 以金鑰 Kdr 加密後得到 )r,r,p,T(E 32Kdr 並將其傳送至讀取器。而讀
取器利用金鑰 Kdr 解密訊息後，先比對解密後的 r2 值和本身所產生的隨機亂數 r2 值是否
相等，若兩個值一樣，代表資料庫傳送過來的訊息是完整且正確的，然後在將其中的 T、
r2 及 r3 傳送至電子標籤。由於資料庫成功認證讀取器才會傳送 T 和 r2、r3 至標籤，所以
當電子標籤收到T後即認定讀取器為合法讀取器。最後，電子標籤將 r3與TID做Exclusive 
OR 之後，利用金鑰 Ky和金鑰雜湊運算產生 p 值， 
6 
 
第一部份：  
資料庫驗證參與所有權轉移的新、舊擁有者以及電子標籤。首先新、舊擁有者必須
分別先利用現有方法如 PKI 之機制與資料庫交換通訊金鑰，舊擁有者取得 Kdr，新擁有
者取得 Kdr’。隨後新擁有者將自己的讀取器的識別碼 RIDnew 藉由通訊金鑰 Kdr’加密並傳
給舊擁有者，而舊擁有者最後藉由0章所提之移動式雙向認證程序如圖 6的第一部分訊
息 2 到訊息 7 認證讀取器和標籤，然後在訊息 8，舊擁有者將 EKdr’(RIDnew)、r3、G 值利
用金鑰 Kdr 加密後將 )r,G),RID(E(E 3new'KK drdr 傳給資料庫，使資料庫知道標籤擁有者要將標
籤所有權轉移給誰。資料庫利用 Kdr 及 Kdr’解密得到 RIDnew 且確定新擁有者的身份後，
會將新擁有者的讀取器存取控制表加入該電子標籤，並將新擁有者讀取器層級提升至
Owner 的權限。 
 
圖 6 所有權轉移程序第一部份 
第二部份：  
資料庫將 )RID(E new'Kdr 給新擁有者，讓新擁有者知道可以讀取標籤並執行所有權轉
移。而新擁有者利用Kdr’解開訊息，驗證RIDnew是否符合本身。然後如圖 7訊息2到訊息
8與0章所提之移動式雙向認證程序來認證標籤和讀取器，接著執行步驟5、6如下： 
步驟5. 資料庫更新電子標籤的金鑰PIN和C。當資料庫驗證過新、舊擁有者身份後會產
生Message=(UPIN||UC)，而UPIN和UC是資料庫產生的隨機亂數，目的是用來製造新的PIN
和新的C所需的值，接著利用舊擁有者的PIN、C和電子標籤產生的亂數r1’計算出一雜湊
值並與Message做Exclusive OR得到hPIN(r1’,C) Message，再利用Kdr加密後傳出，透過讀
取器解開加密訊息後轉送給電子標籤，電子標籤收到讀取器轉送的訊息後，會計算出
hPIN(r1’,C)並與hPIN(r1’,C) Message做Exclusive OR還原Message值，其中包含UPIN和UC，
電子標籤藉由UPIN和UC產生新的PIN值和C值如下： 
)KU(hPIN yPINK
'
x
  
)KU(hC yCK
'
x
  
步驟6. 為了讓資料庫確認電子標籤金鑰已更新完成。電子標籤會利用新的PIN、新的C
值和r3’計算出一雜湊值hPIN’(r3’,C’)，透過讀取器轉送給資料庫。資料庫收到電子標籤傳
來的雜湊值之後會先產生新的PIN值和新的C值，再計算hPIN’(r3’,C’)值是否和電子標籤傳
來的雜湊值相等，如果不相等，所有權轉移失敗；如果相等，資料庫會從讀取器存取控
制表將舊擁有者轉移後的電子標籤識別碼及其讀取器層級變更或刪除。隨後資料庫將新
的PIN值和新的C值給予新的擁有者。 
8 
 
 
圖 8 更新層級對應動作資料表程序 
擁有者可以任意更新層級對應資料表，在此我們利用一個例子敘述更新層級對應動
作資料表程序方法流程，初始化的說明如圖 9(a)所示。電子標籤 TID 為 730 且讀取器和
電子標籤產生的亂數分別為 35 和 24。 
   
圖 9 (a)標籤更新前與(b)標籤更新後的層級對應動作資料表 
 
當電子標籤擁有者想將所有資料讓有權限的使用者任意取得，可以更新層級應對應
資料表。首先擁有者產生並傳送亂數35給電子標籤，隨後電子標籤產生亂數24，利用24
計算出 )88,2435(h77  並與24傳給擁有者，擁有者驗證過 )88,2435(h77  之後會利用亂數24算
出 )88,24(h77 並傳給電子標籤驗證，待電子標籤驗證過後隨即將更新層級對應資料表依序
傳出 )88,241A(h77  、 )88,242B(h77  、 )88,242C(h77  給擁有者，擁有者依序計算且還原
更新層級對應資料表得知層級A對應動作1、層級B對應動作2、層級C對應動作2，最後
讀取器將新的層級對應資料表依序傳出 )88,352A(h77  、 )88,352B(h77  、 )88,352C(h77  ，
如此一來更新後層級對應動作資料表如圖 9(b)所示，使用者只要有權限讀取該電子標籤
必可隨意取得想要的資料。 
電子標籤擁有者可以藉由控制層級對應動作資料表，去掌控各個層級的授權讀取器
可取得的電子標籤資料，避免低權限的讀取器取得權限需求較高的電子標籤資料，相反
地，層級較高的授權讀取器可以任意取得自己想要的電子標籤資料。 
 
安全性分析 
我們證明我們的所有權轉移方法可以在合法讀取器被攻陷的情況仍可以達到雙向
認證、避免重送攻擊、防護標籤資料、位置的隱私及所有權轉移安全，來證明我們所能
達到的安全性。由於我們假設後端認證伺服器與讀取器間的通訊是安全的，所以只針對
讀取器與標籤作探討。 
 雙向認證 
 國科會出國報告書 
                                                報告日期：99/7/28 
                                                                                          
報 告 人  中文： 楊明豪 外文：Yang, Ming Hour 
服務單位及 
職稱 
中原大學 資訊工程系 
報告主題 
前往中國香港參加 International Conference on Intelligent User Interfaces 2010 
出國日期 自  99   年   2   月  6   日  至    99     年   2  月  11   日 
出國目的地   
(國、城市、  
單位名稱) 
 
1. 中國香港 Association for Computing Machinery (ACM) 
出國目標 
參加研討會 
成果報告 
夲次參與於中國香港於 99 年 2 月 7 日至 99 年 2 月 10 日由 Association for Computing Machinery 
(ACM)以及 AAAI 所共同主辦之 International Conference on Intelligent User Interfaces 2008，會議，
是為研究通訊、資訊系統及人機介面領域中之重要會議之一。本研討會歷年都收到數百個論文投
稿，且歷年論文接受率皆低於 30%，因此與會者所報告的論文皆相當具有水準，所有論文皆收錄
於 ACM Digital Library 中，具有相當高的曝光度與專業性。該會議之論文集並為 EI 所收錄。 
夲次研討會有六個 Workshops 和本研討會共同舉辦，共有含蓋 Social Recommender Systems、
Intelligent Visual Interfaces for Text Analysis、Multimodal Interfaces for Automotive Applications、 
Interoperability and Interaction on the Social and Semantic Web、Eye Gaze in Intelligent Human Machine 
Interaction、Semantic Models for Adaptive Interactive Systems 等六個領域的 60 篇論文和兩個分別由
Columbia University 的 Paul Sajda 和 Hitachi’s Advanced Research Laboratory 的 Kazuo Yano 之邀請
演講，其邀請演講內容相當精彩；技術論文報告涵蓋面很廣泛且多有深入的探討和完整的分析、更
具有未來之技術發展的介紹。因此本人可以於與會期間學習相當多關於網路技術、資訊系統以及人
機介面等最新之技術與學術發展狀況，並且有機會可以和與會者交流許多有關 Web Services 和無線
網路安全之最新技術和研究狀況。對於日後進行無線網路安全相關研究之發展有相當大的幫助。且
本研討會有多家國際廠商同時舉辦之 Demo Session，有以有機會對於目前人機介面、網路系統之實
際發展現況更進一步的了解。另外，與會期間與多名無線網路安全作者討論 Wireless Session 
Hijacking 的研究與計畫推動的進度，許多與會者對於我們無線網路安全研究和實驗成果也表示相
當有趣，對於我們於 Wireless Security 方面的研究進度有相當深刻的印象。 
無研發成果推廣資料 
