  2 
而增加最大功率點追蹤之精密度。本計畫詳
細探討輸入為 PV 電池或風力發電機且採用
電感二次側峰值電流控制[7]之SEPIC轉換器
之特性，推導其小信號模型並進而設計其相
關之控制器。太陽能及風力充電系統在過去
很少被討論到電力平衡[8]的議題，本計畫提
出一兼顧最大功率點追蹤、充電控制及負載
需求之電力平衡控制技術，除善用 PV 電池
及風力的發電能力外亦同時考慮充電技巧以
延長蓄電池壽命。 
本計畫實際製作二 80W 之太陽能與風
力充電之模擬系統並加以結合，最後透過一
些模擬及實驗結果來驗證所提方法之可行
性。 
 
三、所提混合型充電系統之工作原理 
本計畫所研製之風力與太陽能混合式充
電系統電路架構如圖 1 所示，風力與太陽能
發電之轉換器輸出為並聯，除提供負載電力
並同時對蓄電池充電。風力部分為利用整流
子將三相永磁同步發電機(PMSG)之輸出加
以整流，再利用昇降壓式 DC/DC 轉換器對
蓄電池充電，昇降壓式轉換器亦同時控制發
電機之轉速，使風車操作在最大功率點。太
陽能部分亦利用一昇降壓式 DC/DC 轉換器
對蓄電池充電，同時控制太陽能電池之電壓
使太陽能電池操作在最大功率點。 
 
 
 
 
 
 
 
 
圖 1、混合型充電系統電路架構 
 
    本計畫在電力之利用順序上以風力為優
先而後再太陽能，根據此原則系統可能之操
作模式有如圖 2 所示之六種模式：(1)模式一
如圖 2(a)所示，當負載電力需求超過風力與
太陽能發電之總合時，發電不足部分由蓄電
池放電補充，風力與太陽能二子系統均操作
在最大功率點。(2)模式二如圖 2(b)所示，當
風力與太陽能發電之總合超過負載電力需求
時，多餘之電力對蓄電池充電但仍未達最大
充電電流之情況，風力與太陽能二子系統亦
均操作在最大功率點。(3)模式三如圖 2(c)所
示，當風力與太陽能發電之總合超過負載電
力需求且多餘之電力亦超出蓄電池之充電電
力時，系統以風力為優先仍然操作在最大功
率點，但太陽能部份則偏離其最大功率點以
減少電力輸出，使系統之電力流通仍維持平
衡。(4)模式四如圖 2(d)所示，當風力發電操
作在最大功率點便已等於負載及電池充電二
電力需求時，太陽能部份則操作於開路電壓
停止輸出，使系統之電力流通仍維持平衡。
(5)模式五如圖 2(e)所示，風力發電不需操作
在最大功率點便已超過負載及電池充電二電
力需求時，風力部份偏離其最大功率點且太
陽能部份則操作於開路電壓停止輸出，使系
統之電力流通仍維持平衡。(6)模式六如圖 2(f)
所示，負載及蓄電池需求為零，風力及太陽
能均操作於開路電壓。除上述六模式外，實
際系統在風速過高下，風力發電機輸出之短
路開關會自動短接以降低風車轉速，保護風
車及發電機。 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
圖 2、混合型充電系統之工率分配情形 
 
四、利用電感二次側電流控制之 SEPIC 轉換
器設計 
   SEPIC 轉換器電路圖利用耦合電感二次
側電流來控制其輸入電壓值，[9]文獻中顯示
此方法可達到調整輸入電壓之控制目的。以
下之符號表示中，小寫為瞬時值，大寫為平
均值，小信號值則以大寫加上〝~〞符號來代
表。由圖 3 之 SEPIC 電路可得： 
 
 
 
 
 
 
圖 3、SEPIC 轉換器電路圖 
升降壓式
轉換器
DC/DC永磁同步
發電機
整流子
蓄電池
風車
升降壓式
轉換器
DC/DC太陽能
電池
短路開關
負載
Battery discharging power
PV
Wind
Total
Load
time
power
Battery charging power
PV
Wind
Total
Load
time
power
PV
Wind
Total
Load
time
Battery charging power
power
PV=0
Wind=Total
Load
time
power
Battery charging power
PV=0
Wind=Total
Load
time
power
Battery charging power
Wind=PV=Load =Total=0
time
power
(a) (b)
(c) (d)
(e) (f)
pi
1C
pV
1L
1i
2i
Di
Sv
SC
2L
SR
2C oV
V
eR
o
i
  4 
壓下電流迴路均能穩定，本論文採用在任何
條件下均使 ma/m1≥0.5之設定。結合(26)與(27)
可得電壓控制迴路之轉移函數為： 
2
2
1
])1([
))1(1()1(3
1
)()(
)(
L
DR
D
LDD
s
L
D
LMR
skH
sV
sV
p
s
ea
p
⋅
−
−+
+
−
+⋅
+
==  (28) 
由於(28)為一階低通濾波架構，本論文採用
一低通濾波之補償電路，其極點設定與(28)
之零點相消，亦即 R2Cv = CpRe。考慮(28)極
點會隨 PV 之工作點變化，誤差放大器之增
益 R2/R1 之設定需考慮各式工作條件下均能
維持穩定及足夠之頻寬。 
 
 
 
 
 
 
 
 
 
 
 
(a) 
 
 
 
 
 
 
 
 
 
 
 
(b) 
圖 4、(a) SEPIC 轉換器之控制電路圖；(b)工作波形 
 
風力發電部分之控制架構如圖 5 所示，
其中昇降壓式 DC/DC 轉換器乃利用電感二
次側電流控制之 SEPIC 轉換器，其利用
MPPT 控制器計算可以使風車產生最大功率
輸出之發電機整流電壓命令，再由電壓控制
器調整使整流器之電壓為所設定之電壓命
令。電壓控制器產生轉換器之輸出電流命
令，此電流命令與蓄電池充電電流及負載之
電流總合比較，由一最小值選擇電路決定最
後轉換器之電流命令。最後再經過電流控制
器與 PWM 得到轉換器開關之切換信號。藉
由此一最小值選擇，可以滿足在只有風力發
電下功率平衡之控制需求。 
太陽能發電部分之控制架構如圖 6 所
示，同樣地亦採用電感二次側電流控制之
SEPIC 轉換器，其利用MPPT 控制器計算產
生最大功率輸出之太陽能模組電壓命令，再
由電壓控制器調整使太陽能模組電壓為所設
定之電壓命令。電壓控制器產生一等於轉換
器輸出之電流命令，此電流命令與蓄電池充
電電流及負載之電流總合相較，由一最小值
選擇電路決定最後之轉換器電流命令。最終
再經過電流控制器與 PWM 得到轉換器開關
之切換信號。同理，藉由此一最小值選擇，
可以滿足在只有太陽能發電下功率平衡之控
制需求。 
本計畫結合上述圖 5 風力發電與圖 6 
太陽能發電之電力平衡架構如 7 所示，由於
SEPIC 電感二次側電流平均值與其輸出電
流相等，因此藉由調整其電流命令可控制
SEPIC 之輸出電流。利用此特性由風力發電
與太陽能發電部分所產生之電流命令相加後
(I1*)再與充電及負載電流之總合(I2*)比較，利
用二極體組成之最小值選擇電路可以獲得風
力與太陽能發電實際所需產生之輸出電流命
令(I*)，此電流命令減去由風力部分所產生之
電流命令經過一正向限制器得到太陽能部分
實際所需提供之電流命令(Ipv*)，最後實際所
需產生之輸出電流命令(I*)再減去太陽能部
分之電流命令(Ipv*)即可得風力部分所需之電
流命令(Ig*)。圖 7 方法可以使系統在上述六
種操作情況下瞬間功率均能維持平衡，在模
式三、四、五等操作情況下，系統優先由風
力發電部分提供電力，當風力發電部分已操
作於MPPT 下，多餘部分才由太陽能發電部
分提供。 
 
五、 具適應性最大功率點追蹤控制器設計 
圖 8 為 PV電池之 P-V特性曲線圖，本
計畫利用功率與電壓二者變化之斜率來調整
工作電壓移動的方向以追蹤最大功率點，當 
 
 
 
 
 
 
 
圖 5、風力充電系統控制方塊圖 
+
-
+
-
+
-
pI
eR
V
1L sC
3×
2L
*
pV
1pV
2R
vC
eav
dC
1R
2cR1cRfR
fC
S
R
Q
CLKV
+
-
Trigger of 
switch
rampV
From MPPT
controller
pC
CLK
Vea
Tg
ton
2LI
T
 
升降壓式
轉換器
DC/DCPMSG
Vg
PgIg
Vg
整流子
電壓
控制器
蓄電池
負載
+
Sw2
最小值
選擇器
電流
控制器
PWM
&
驅動
I *
I
風力發電機
MPPT
控制器
  6 
 
 
 
 
 
 
 
 
 
 
 
 
 
圖 11、輸出功率與風速之關係圖 
 
    本計畫採用之發電機形式為 PMSG，[10]
提出偵測整流子直流側功率並控制其電壓之
方式以達到MPPT 控制目的，其原理乃利用
整流後之直流電壓與發電機輸出電壓成正
比，且發電機端電壓與其速度電壓幾乎呈線
性關係之觀念，控制直流電壓即能控制轉
速，將直流電壓以如同 PV 之增量電導法
MPPT 方式根據直流功率變化遞迴調整電
壓，直至達到最大功率點。此種方法稱為爬
坡搜尋法(hill-climb search method)[10]，不需
得知風車之特性資料，然其缺點為使適用於
機械慣量較小系統，而且其響應速度較慢。 
本文所研製之 WTG 屬於小型系統，風車之
慣量非常小，因此可利用所提用於 PV 之
MPPT 方法其具備幾個優點：(1)MPPT 控制
不需要感測發電機轉速；(2)與 PV 模組之
MPPT 控制方法相同二者電路可以模組化設 
計；(3)具備適應控制特性可以兼顧 MPPT 的
調整速度與精確度。 
 
六、風力發電機與太陽能電池模擬系統 
    為發展此混合型之充電系統，免除因日
夜、季節及天候等所帶來實地測試(Field Test)
之限制，本計畫採用如圖 12 所示之電流控
制之半橋式轉換器發展一 PV 與 WTG 之模
擬系統(Emulator)，使所提之系統單獨亦或整
合測試可以隨時進行。針對 PV 模組之模
擬，本論文將 PV 模組之 I-V 曲線建於
SIMULINK 環境下如圖 13(a)所示，利用
MATLAB 的 Real-time control 的方式控制
半橋式轉換器，使其輸出之 I-V 以致於 P-V 
特性與 PV 模組相同。針對 WTG 模擬器，
過去實驗室都以馬達帶動發電機來實現
[11]，然此方式之成本高昂、吵雜、需要大空
間而且缺乏彈性，容量改變就必須更換新的
馬達及發電機，同樣的本文將風車及永磁同
步發電機的等效模型建構於 SIMULINK 環
境下如圖 13(b)所示，再利用 MATLAB 的
Real-time control 的方式控制半橋式轉換
器，使其輸出之 P-ω特性與實際之 WTG 相
同，以電路模擬方式取代機械模擬方式，提
高在實驗室進行實驗之便利性。 
 
 
 
 
 
 
 
圖 12、模擬系統之半橋電路 
 
 
 
 
 
 
(a) 
 
 
 
 
 
 
 
(b) 
圖 13、風力發電機及太陽能電池模擬器控制程式： 
(a)太陽能；(b)風力 
 
七、實驗模擬及結果 
    根據上述理論本計畫實際製作一 80W 
之混合型充電系統。混合型系統實作架構如
圖 14 所示，其中 PV 模組及 WTG 模擬器
特型曲線之計算以及二子系統 MPPT 控制
器均利用 MATLAB Real-time control 來實
現，PV 及 WTG 兩個子系統分別利用由半
橋式轉換器來加以製作，模擬器經由 A/D電
路將其信號送入 PC，經 MATLAB Real-time 
control 運算得到二半橋式轉換器之電壓
Vcon(PV)、Vcon(WTG)再經由 D/A 電路送回二
轉換器，MPPT 的部份則是利用將 SEPIC 轉
換器之電壓及電流信號送入 MATLAB 
Real-time control 運算得到電壓命令 Vp*及
Vg*。轉換器部份利用 UC 3846 做峰值電流控
制其它之最小值電路、電壓控制器、充電控
制電路等均使用類比的方式來實現。在實作
之前，本計畫先行以模擬來加以驗證。圖 15
P
tω
optλλ =
smU /  12=
smU /  8=
smU /  5=
L
dcV
+
−
DC source +
−
pI
C pV
LPF
current
controller
pI
*
pI
conpV
PWM Trigger
signals
P-V characteristic
Ip
Vp
Vp
風速
+
-
+
+Gain
Gain
D/A
converter
A/D
converter
P
characteristic
ω−P
∫
Mechanic
Dynamic
  8 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
圖 15、模擬電路圖 
 
 
 
 
 
 
