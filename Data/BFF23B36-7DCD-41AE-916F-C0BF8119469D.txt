1 
 
Quantitative structural analysis and template construction 
for brain magnetic resonance images 
 
Abstract—Magnetic resonance imaging (MRI) has been 
widely used for evaluation of clinical trials as well as 
structural and functional brain studies.  One unique 
characteristic of MR studies is its statistical power in 
inferring structural discrepancy between subject groups in 
a voxel-wise manner, as compared to the qualitative 
evaluation based on visual inspection.  Toward this goal, a 
standard stereotactic coordinate system defined by a brain 
template is indispensable to providing a common space for 
brain morphometrics and statistics.  In this work we have 
constructed brain templates for inter-/intra-subject 
comparison and diagnostics of abnormal anatomical 
variations as well as the coordinate mapping method from 
the constructed template to the Talairach coordinate 
system.  The structural templates were constructed from 
more than 200 T1/GM/WM/CSF/DTI MR images of 
normal subjects and were evaluated according to the 
average of structural deformation. 
Keywords- magnetic  resonance  imaging, brain template, 
structural analysis  
 
I. INTRODUCTION 
Magnetic resonance imaging (MRI) is a medical imaging 
technique which can visualize the inside structure of organisms 
without physical intrusion and commonly used for studying 
variation in human brain structures and brain tissues. It works 
with the effect of the interaction between static magnetic field 
and dynamic electromagnetic field on protons to display the 
inner structure of human body. The different pulse sequences 
generated distinct images. For instance, T1-weighted images 
provide appreciable contrasts  between different soft tissues, 
such as gray matter (GM), white matter (WM), and 
cerebrospinal fluid (CSF) in brains. It performs well at defining 
anatomy. T2-weighted scans are suited to the diagnosis of 
edema, since they are susceptible to water. Diffusion-weighted 
images (DWIs) are based on the diffusion effect of water 
molecules in biological tissues, and manifest the difference 
between molecular mobility in different gradient directions. 
Diffusion tensor magnetic resonance imaging can be 
derived from DWIs under the assumption that molecular 
diffusion in tissues acts in Brown motion. Moreover, in DT 
image, different voxels have different diffusion tensors, which 
contain the information of fiber directions. A 3×3 symmetric 
and positive-definite matrix D, called diffusion tensor (DT), 
can describe the main diffusivities λ1, λ2 , λ3 (with λ1 > λ2 
> λ3 ) and the corresponding directions V1, V2, V3 of water 
diffusion. Eigen-values ( λ1, λ2 , λ3 ) can be used to 
calculate several scalar indices, such as relative anisotropy 
(RA), fractional anisotropy (FA), and volume ratio (VR). FA is 
the most commonly used index to characterize diffusion 
anisotropy.  The FA is defined as the following equation.  
FA 
3 1 2   2  2  3 2 
2(12  2 2 32 )
 , where   1 23
3 .
 
 
Figure 1: One slice of Diffusion tensor image (right) generated by 
diffusion-weighted images (left) 
The structure of human brain is inherently different for 
each individual subjects. Different variables also affect the 
individual structure variability, such as age, gender, disease and 
ethnicity. To study the structure differences between each 
individual subjects from MRI, defining a standard information 
of human brain template space should be provided. 
Researchers can then normalize each subject images to this 
space for further analysis or comparison. 
MRI data of different subjects should be aligned to the 
same template space representing for this study group. A 
proper template space can facilitate the reduction of distortion 
in the spatial normalization procedure. Since large distortion 
may bias the analysis results, construction of an unbiased brain 
template space for the study group is an important issue.  
This study aims at two major goals: 1) Construction of a 
customized brain template representing the subject group; 2) A 
reliable registration process to construct a customized brain 
template. 
 
II. RELATED WORKS 
In 1988, Talairach atlas [1] was manually labeled based on 
a 60-year-old French female’s brain, transformed from the 
Brodmann map. Because the atlas was biased to a specific 
subject, it cannot well represent all the subjects as a brain 
template space. On the other hand, the Talairach atlas assumes 
that the brain structure is symmetric, which is generally not 
true in real cases. In 1992, Montreal Neurological Institute 
(MNI) created an average of 305 subjects mapping to the 
Talairach atlas, as shown in Figure 2. This template created by 
linearly mapping 305 brain images to the Talairach atlas with 9 
parameters and then averaging the transformed images [2][3].  
The template called average305 is obviously with low contrast 
and is blurred in fine structure. To improve this problem, a 
model was constructed with MRI images of an individual 
subject, Colin Holmes, who was scanned 27 times over a 
period of 3 months in 1998 [4]. The average image of these 27 
images normalized to average305 template is shown in Figure 
2(b). Even though Colin27 provides template image with high 
contrast, it is biased to this individual subject.  
3 
 
 
Figure 4: One slice in (a) MRI, (b) FA image (c) V1 image (where the 
colors red, green, and blue represent diffusion in the x, y, and z axes 
respectively). 
 
2) Registration of MRI 
  The image registration based on each voxel of subject 
images. The registration process includes two major parts: 
global affine normalization TA and nonlinear transformation 
TN. The effect of different registration method shows in Figure 
5. For each voxel transformation T: p→q, the following 
equation present the relation: 
 
q = TA(p) + TN (TA (p))      (1) 
 
Affine normalization aligns the global shape between the 
source image and target image, including rotation, scaling, 
shifting and shearing. The transformation could use a transform 
matrix M to present the mapping relation. The relation is 
shown in (2). Each voxel p of source image maps to the 
corresponding q in target image. In this study, FSL developed 
FMRIB’s Linear Image Registration Tool (FLIRT) [13] which 
be used in the procedure. 
 
q = TA(p) = M × p       (2) 
 
  Nonlinear registration solves the problem in inter-brain 
tissue alignment after we align the global shape of image. The 
spatial mapping is based on a set of Wendland’s radial basis 
functions (RBFs) with different levels of support extents [14]. 
The RBFs model the deformation field D of the brain image 
from source image to target image. The following equation (3) 
shows the relation of mapping. 
 
q = TN (TA(p)) = p + D(p)  (3) 
 
 
Figure 5: Registration result between two images: (a) Source image (b) 
Target image (c) Affine registration from source to target. (d) Affine 
and nonlinear registration from source to target. 
 
2-2)     Registration of DTI  
                Affine transformation is a preliminary registration. It 
aligns the global shape from source image to target image. We 
used FMRIB’s Linear Image Registration Tool (FLIRT).  
Non-rigid registration provides further alignment in local 
structure. Liu J.X et al., [14] proposed Brain Image 
Registration Tools (BIRT) is used. Besides, We modified the 
similarity criterion in BIRT and used a symmetric and 
diffeomorpic non-rigid registration algorithm to efficiently 
utilize the features selected from DTI and MRI. The new 
similarity evaluation function (eq-2.1) between the voxel u in 
the target image It and the voxel v in the source image Is can 
be expressed as: 
 
S It u , Is v    wi  simi At u , As (v) 
i
    (2.1) 
simi At u , As (v)   SCR at
i, as
i 
at
i u asi v 
, i  intensity, FA
, i V1
(2.2) 
        At(u) and As(v) are the attribute vectors at voxel u in 
target image and at voxel v in source image, respectively. 
When the attribute index (i) equals intensity or FA, we 
calculated a correlation ratio between target image and source 
image; else if  equals V1, we considered the modulus of inner 
product between two principal direction of voxel u and v.  
        The weight wi controls the influence of each attribute and 
decided by the number of each attribute. In addition, DTI 
features (FA and V1) are calculated only in white matter 
region(FA >= 0:3) so that we can improve the accuracy for 
MRI non-rigid registration in white matter and maintain the 
accuracy in other tissues. The similarity functions of each 
attribute in eq-2.2 have been normalized to the range of zero to 
one. Which means the larger value indicates higher image 
similarity.  
The correlation ratio (Figure 6) is an efficiency and 
accuracy measurement for image registration. It is robust to 
different intensity contrast, inhomogeneity and noise [13, 32]. 
We calculated the correlation ratio of image similarity in the 
following equation: 
              ܵ஼ோ൫ܽ௧௜ 	, ܽ௦௜ ൯ ൌ 1 െ ଵ௏௔௥ቀ௔ೞ೔ሺஐሻቁ ∑
ேೕ
ே
ேಳ௝ୀଵ ܸܽݎ ቀܽ௦௜ ൫ ௝ܺ൯ቁ 
 
The range of attribute (intensity or FA) in target image 
was divided into NB bins. Voxels in the same bin was gathered 
into a set Xj , which contains Nj voxels. We collected their 
corresponding voxels in source image at set Xj , and calculated 
the variance from attributes of these voxels. Let N be the 
number of voxels in the overlapping region Ω between source  
and target image. If the variance ratio of each set Xj to total 
volume  is small, the source image and target image are well 
aligned. 
5 
 
 
3-2)     Procedure of creating DTI template  
We modified the procedure of MRI template construction 
proposed by Lee [15] to construct new MRI and DTI 
templates. Figure 9 and 10 illustrates our procedures for 
MR/DT template construction. The construction of DTI 
template is similar to MRI and we utilized the affine matrix 
from MRI to co-register the initial DTI template into the same 
template space. Subsequently, preprocessed images and affine 
templates of MRI/DTI were organized to an attribute vector, 
which is a new similarity function for non-rigid registration.  
 
 
Figure 9: Brief flowchart of the proposed methods for MR/DT 
template construction 
 
Figure 10: Detailed flowchart of the proposed methods for MR/DT 
template construction. 
 
         However, diffusion tensor contains direction of water 
diffusion in tissues. In affine transformation, we only change 
position of voxels in DTI. Therefore, we have to apply DTI 
reorientation to maintain the consistency of anatomical 
structure. Alexander etal.,[16] developed a preservation of 
principal direction (PPD) method to estimate local rotation 
matrices from affine transformation or higher order 
transformations(non-rigid transformation). The aim of PPD is 
to preserve the principal direction and a plane spanned by the 
principal and second direction of a tensor after transformation. 
The following is the algorithm of PPD: 
 
  Step 1: Find the first eigenvector e1 and the second  
               eigenvector e2 of a diffusion tensor. 
  Step 2: Compute the unit vectors n1 and n2 from transformed  
              e1 and e2, which were applied by transformation  
              matrix, F, respectively. 
  Step 3: Rotate e1 to n1 with rotation matrix, R1, and rotate e2  
              with R1 as well. 
  Step 4: Find a projection, P(n2), of n2 onto a plane. The plane  
              is spanned by n1 and n2, and it is perpendicular to n1.  
              Besides, R1e2 (rotate e2 with R1) already lies in this  
              plane. 
  Step 5: Calculate the rotation matrix, R2, which maps R1e2     
              to P(n2). 
  Step 6: Set the local rotation matrix R = R2R1 and reorient a  
              tensor D by: D’=RDRT. 
 
        Constructing average template of DTI is calculated in 
Log-Euclidean space [17], which can avoid the defects of 
Euclidean calculus, such as tensor swelling effect and non-
positive eigenvalues. Moreover, tensors can be thought as 
vectors in this space. So the operations of vector can be used 
directly on tensors in Log-Euclidean space. In other words, 
calculating the logarithm of a tensor matrix means changing a 
tensor into Log-Euclidean space. We can efficiently obtain the 
logarithm of a tensor matrix from eq3-1 to eq3-3 and approach 
eq3-4 to construct the Average Template of DTI. 
        Where M is a diagonal matrix with eigenvalues and R 
represents the rotation matrix with eigenvectors. They were 
factored from spectral decomposition of tensor D. In contrast, 
changing a tensor back into Euclidean space, that is, 
calculating the matrix exponential of a tensor also can be 
obtained efficiently by using exponential substituted for 
logarithm at step 2. Besides, let N be the number of registered 
subjects and x be a voxel of tensor D in eq3-4. 
 
																																	ܦ ൌ 	ܴܶܯܴ																																																					ሺ݁ݍ3_1ሻ 
 
ܯ ൌ ൥
ߣଵ 0 0
0 ߣଶ 0
0 0 ߣଷ
൩ 		௟௢௚ሱሮ			ܯ෡ ൌ ቎
log௘ ߣଵ 0 0
0 log௘ ߣଶ 0
0 0 log௘ ߣଷ
቏ ሺ݁ݍ3_2ሻ   
 
																											logሺܦሻ ൌ ்ܴܯ෡ܴ																																									ሺ݁ݍ3_3ሻ			 
 
												ܦഥሺܺሻ ൌ ݁ݔ݌ ቈ∑ log൫ܦ௜ሺݔሻ൯
ே௜ୀଵ
ܰ ቉																											ሺ݁ݍ3_4ሻ		 
 
 
 
 
 
7 
 
 
6) Evaluation 
The template evaluation could be based on image 
intensity and the deform vector magnitude which is obtained 
from registration process. 
Considering the image intensity value, if the brain 
template is well-represent for the whole subject group, the 
close voxel coordinate between subject image in template 
space and representative image should have similar intensity 
value. This study uses standard deviation and correlation to 
evaluation the performance of our template.  
At first, the whole subject images transform into our 
creating template. For measure of standard deviation, compute 
standard deviation of intensity at location x in template space 
for all subject mapping to template space (As equation (9)). 
Small standard deviation represent all image transform to this 
template space in small difference. For measure of correlation, 
compute correlation between subject image in template space 
and template image (As equation (10), A and B are two images, 
k is the voxel number of image). If the correlation closer to 
one, the difference between this two images are smaller. In 
other words, the template image is representative as the subject 
image. 
)))(1()(1()( 2
11
2 


n
j
S
j
n
j
S
j xIn
xI
n
sqrtxSD     (9) 







k
i
i
k
i
i
i
k
i
i
AB
BBAA
BBAA
r
1
2
1
2
1
)()(
)()(     (10) 
Study of the displacement information stored in the 
deformation field is also another evaluation method. The 
deformation field was obtained by nonlinear registration from 
subject image to the template image. We could compute the 
average deform vector’s magnitude to observe the difference 
between subject image and template image. Lower value stands 
for well-present template. 
 
6-2) Evaluation Method of DTI  
        Basser and Pajevic [19] developed a measure of tensor 
overlap based on eigenvalue-eigenvector pairs. If two different 
tensors are perfect match, the value of OVL is close to one. 
Otherwise, the value is close to zero. The volume R in the 
average overlap equation (eq6-2) represents the region of white 
matter or brain region, and usually used to evaluate the 
accuracy of DTI registration [25, 29]. The OVL and averaged 
OVL are given by: 
 
												ܱܸܮ ൌ ∑ ߣ௜ሺݔሻߣ௜
ᇱሺݔሻ൫݁௜ሺݔሻ ∙ ݁௜ᇱሺݔሻ൯2ଷ௜ୀଵ
∑ ߣ௜ሺݔሻଷ௜ୀଵ ߣ௜ᇱሺݔሻ 													 ሺ݁ݍ6_1ሻ						 
ܣݒ݁ݎܽ݃݁	ܱܸܮ ൌ 	 1|ܴ|෍
∑ ߣ௜ሺݔሻߣ௜ᇱሺݔሻ൫݁௜ሺݔሻ ∙ ݁௜ᇱሺݔሻ൯ଶଷ௜ୀଵ
∑ ߣ௜ሺݔሻଷ௜ୀଵ ߣ௜ᇱሺݔሻ௫∈ோ
				 ሺ݁ݍ6_2ሻ			 
          Sanchez Castro et al., [20] utilized diffusion tensor 
images to evaluate MRI registration. They co-registered DTI 
with the transformation of MRI, and used the standard 
deviation, called error, to check the consistency of tensor after 
registration. They also performed operations on tensor in Log-
Euclidean framework. The error can be computed as followed: 
 
 
ܦഥ௅ைீ ൌ ݁ݔ݌ ൭1ܰ෍݈݋݃ሺܦ௜ሻ
ே
௜ୀଵ
൱ 
ܣ ൌ ݈݋݃ሺܦ௜ሻ െ log	ሺܦഥ௅ைீሻ 
ܧݎݎ݋ݎ ൌ ඩܶݎܽܿ݁ ൭1ܰ෍ܣܣ்
ே
௜ୀଵ
൱ 
        In our study, the error is computed for both MRI and DTI.  
ܦഥ௅ைீ  means the Average Template of DTI. Similarly, the 
registered subjects from MRI averaged on Euclidean 
framework create the Average Template of MRI. To sum up, 
the error not only represents the discrepancy between our 
Average Template and registered subjects, but also evaluates 
the registration method we proposed. 
 
IV. RESULTS 
 
1) Constructed template of MRI only 
The MRI scans are obtained from Integrated Brain 
Research Unit (IBRU) of Taipei Veterans General Hospital. 
The subject group includes 78 males and 138 females in total 
216 normal subjects of T1 images. Age range is 14 to 69. The 
whole procedure is created based on the T1 images from these 
data base. Figure 14 and 15 show representative image and 
template image in different brain tissues and different views. 
 
Figure 13: Representative image: Brain-only, grey matter, white 
matter and CSF (from left to right) in horizontal, coronal and sagittal 
view (up to down). 
 
Figure 14: Template image: Brain-only, grey matter, white matter and 
CSF (from left to right) in horizontal, coronal and sagittal view (up to 
down). 
Representative image is also the constructed template 
space. All subject images without outliers map to this template 
space and average to obtain the template image. Both images 
provide information for the subject groups. 
9 
 
 
 
 
 
 
 
 
 
 
 
Table 2: The average in deformation vector field (mean ± SD) in X, Y 
and Z dimension compare with different template. 
 
5) Evaluate the template performance of DTI and MRI 
In order to confirm the performance for our attribute 
vector, we considered the mean error of MRI feature (T1), DTI 
feature (FA) and the attribute vector (T1+FA) within the whole 
brain and white matter. 
In the whole brain region, the best reductions of DTI error 
(Table 3.1) is given by T1+FA feature with 6.65%_2.48%. The 
second one is FA feature and the worst case is T1 feature.  
Furthermore, Table 3.3 shows that T1+FA feature also obtains 
the best reduction of MRI error by 11.19%_12.9%,  and the 
second one is T1 feature by 10.62%_11.25% .  
 
Table 3.1: Mean DTI error in whole brain 
 
Table 3.2: Mean DTI error in white matter 
 
Table 3.3: Mean MRI error in whole brain 
 
Table 3.4: Mean MRI error in white matter 
 
Let us examine OVL and errors in detail shown in Figure 
21 and Figure 22. These evaluation methods were partitioned 
into ten part using FA image, which was derived from DTI 
Average Template. Figure 22(a) shows that FA feature provides 
the best error reduction in major divisions. However, T1+FA 
feature is better than FA feature when FA being the range of 
0~0.1 and 0.1~0.2. Figure 22(b) illustrates that T1 feature 
supplies the lowest MRI error in most partitions. Nevertheless, 
T1+FA feature offered lesser error than T1 feature when 
FA=0.1~0.2, 0.3~0.4, 0.5~0.6 and 0.6~0.7. Although T1+FA 
feature was not perfect in each detail segment, it provided an 
acceptable result. 
The results demonstrate that T1 and FA can give a 
excellent remedy for each other when they are simultaneously 
employed in non-rigid registration. Accordingly to this, we 
found out T1+FA feature supplies the best alignment for both 
MRI and DTI non-rigid registration. 
 
Figure 21: Mean OVL with different features 
 
Figure 22: (a) Mean DTI error (b) Mean MRI error 
 
 
V. DISCUSSIONS 
 
1) The Midterm Project Part 
The construction procedure includes two major parts of 
iterative registration: affine registration and nonlinear 
registration. Both iterations transform all subject images to a 
representative image and optimized this representative image 
rather than an average template image. The representative 
image provides higher contrast and local area information. This 
could let the transform value more accurate and also update the 
representative image precisely. But when researchers attempt 
to use the template space as a comparative standard coordinate, 
a representative image may not be the best choice rather than 
an average template image. An average template image 
includes more subject information than a representative image 
without bias to a specific brain image structure. In our result of 
Table 1, the subjects mapping to the representative image have 
higher average correlation. In our study, we have created both 
representative template space image and average template 
image just in case.  
In addition, the procedure provides outlier criteria in order 
to construct an unbiased template. As the creating template 
procedure is suitable for any given subject groups, the 
representative template image is easy being bias by an extreme 
Mean average in deformation vector field (mean ± SD)(mm) 
 Subject in group Subject out of group 
Our Constructed 
template 
X: 0.06 ± 1.71 
Y: -0.24 ± 1.73 
Z: 0.48 ± 2.28 
X: 0.60 ± 9.26 
  Y: -1.20 ± 10.96 
Z: 2.90 ± 8.70 
ICBM X: 37.42 ± 2.33 
Y: 14.28 ± 5.53 
Z: 21.09 ± 8.70 
X: 24.04 ± 9.44 
Y: 8.08 ± 5.63 
Z: 15.21 ± 7.66 
11 
 
 
VI. FUTURE WORKS 
  As the constructed template has defined in accurate 
procedure, studying on different subject groups in size or 
specific character will be the future work should be done. For 
example, males and females template, specific level of age 
templates are also could be constructed in our procedure. 
Comparison of different group of template may find some 
conclusions for the brain structure difference. 
The comparison between general template space and our 
constructed template space need to be evaluated more. Rather 
than intensity based and replacement base method, use more 
methods to evaluate our template space. 
 
VII. CONCLUSIONS 
  Constructing a proper template would be helpful in 
MRI brain images analysis. The human brain structure will be 
changed in different factors including disease. An accurate and 
precise creating procedure can help the brain template well-
representative. Researchers and doctors could simply compare 
the different in brain structure by the brain template image. The 
construct procedure algorithm in this study could be used on 
different specific subject groups creating customized template. 
The well-represent template space can be used for precise 
analysis on brain image variation.  In this study, we present a 
procedure to construct MRI and DTI template. Moreover, we 
improved the accuracy of non-rigid registration by using T1 
and DTI features simultaneously. 
 
REFERENCES 
[1] J. Talairach and P. Tournoux (1988). Co-Planar Stereotaxic Atlas of a 
Human Brain: 3-Dimensional Proprotional System: an Approach to Cerebral 
Imaging. Thieme Medical Publishers.  
[2] Evans, A.C., Collins, D.L., Mills, S.R., Brown, E.D., Kelly, R.L., Peters, 
T.M. (1993). 3D statistical neuroanatomical models from 305 MRI volumes. 
Proc. IEEE-Nucl. Sci. Symp. Med. Imaging Conf. 1813–1817. 
[3] Mazziotta, J.C., Toga, A.W., Evans, A., Fox, P., Lancaster, J. (1995). A 
probabilistic atlas of the human brain: theory and rationale for its 
development. The International Consortium for Brain Mapping (ICBM). 
NeuroImage 2(2):89-101. 
[4] C.J. Holmes, R. Hoge, L. Collins, R. Woods, A.W. Toga, and A.C. Evans 
(1998). Enhancement of MR images using registration for signal averaging. 
Journal of computer assisted tomography, 22(2):324–333. 
[5] John Mazziotta, Arthur Toga, and et al (2001). A probabilistic atlas and 
reference system for the human brain: International consortium for brain 
mapping (ICBM). Philosophical Transactions of the Royal Society B: 
Biological Sciences, 356(1412):1293–1322. 
[6] Good, C.D., Johnsrude, I., Ashburner, J., Henson, R.N., Friston, K.J., 
Frackowiak, R.S., (2001). Cerebral asymmetry and the effects of sex and 
handedness on brain structure: a voxel-based morphometric analysis of 465 
normal adult human brains. NeuroImage 14: 685-700. 
[7] K. Kazemi, H.A. Moghaddam, R. Grebe, C. Gondry-Jouet, F. Wallois. 
(2007) A neonatal atlas template for spatial normalization of whole-brain 
magnetic resonance images of newborns: Preliminary results. NeuroImage 
37(2): 463-473. 
[8] V. Fonova, A.C. Evansa, K. Botteronb, C.R. Almlic, R.C. McKinstrye, D.L. 
Collinsa, Brain Development Cooperative Group (2011). Unbiased average 
age-appropriate atlases for pediatric studies. NeuroImage 54(1): 313-327. 
[9] B.B. Avants, P. Yushkevich, J. Pluta, D. Minkof, M. Korczykowski, 
J.Detre, J. C. Gee. (2010) The optimal template effect in hippocampus studies 
of diseased populations. NeuroImage 49: 2457-2466. 
[10] F. Se´gonne, A.M. Dale, E. Busa, M. Glessner,D. Salat,H.K. Hahn and B. Fischl 
(2004). A hybrid approach to the skull stripping problem in MRI. NeuroImage 
22(3):1060-1075. 
[11] J. G. Sled, A. P. Zijdenbos, and A. C. Evans (1998). A nonparametric method for 
automatic correction of intensitynonuniformity in MRIi data. Medical Imaging, IEEE 
Transactions on, 17(1):87–97. 
[12] Y. Zhang, M. Brady, and S. Smith (2001). Segmentation of brain MR 
images through a hidden Markov random field model and the expectation 
maximization algorithm. IEEE Trans. on Medical Imaging, 20(1):45-57. 
[13] M. Jenkinson and S.M. Smith (2001). A global optimisation method for 
robust affine registration of brain images. Medical Image Analysis, 5(2):143-
156. 
[14] Liu, J.X. Chen, Y.S., Chen, L.F. (2009). Fast and Accurate Registration 
Techniques for Affine and Nonrigid Alignment of MR Brain Images. Annals 
of Biomedical Engineering 38(1):138-157. 
[15] 李國維. 磁振造影腦模板之客製化建構. Master’s thesis, 2011. 
[16] D.C. Alexander, C. Pierpaoli, P.J. Basser, and J.C. Gee.  Spatial transformations 
of diffusion tensor magnetic resonance images. Medical Imaging, IEEE Transactions on, 
20(11):1131–1139, 2001. 
[17] V. Arsigny, P. Fillard, X. Pennec, and N. Ayache. Log-euclidean  
   metrics for fast and simple calculus on diffusion tensors.  Magnetic  
  resonance in medicine, 56(2):411–421, 2006. 
[18] P.J. Basser, J. Mattiello, and D. LEBiHAN. Estimation of the    
  effective self-diffusion tensor from the nmr spin echo.  Journal of  
  Magnetic Resonance Series B, 103:247–247, 1994. 
[19] P.J. Basser and S. Pajevic. Statistical artifacts in diffusion tensor  
  mri (dtmri) caused by background noise. Magnetic resonance in medicine,  
[20] F. J. S. Castro, O. Clatz, J. Dauguet, N. Archip, J. Ph Thiran,  
  and S. K. Warfield. Evaluation of brain image nonrigid registration  
   algorithms based on log-euclidean mr-dti consistency measures.  In  
  Biomedical Imaging: From Nano to Macro, 2007.  
[21] D.L. Collins, P. Neelin, T.M. Peters, and A.C. Evans. Automatic 3d inter-
subject registration of MR volumetric data in standardized  talairach space. 
Journal of computer assisted tomography, 18(2):192,  1994. 
[22] A.C. Evans, D.L. Collins, SR Mills, ED Brown, RL Kelly, and TM Peters. 
3d statis- tical neuroanatomical models from 305 mri volumes. pages 1813–
1817 vol. 3. IEEE. 
[23] P. Fillard, X. Pennec, V. Arsigny, and N. Ayache. Clinical dt-mri 
estimation, smooth- ing, and fiber tracking with log-euclidean metrics. 
Medical Imaging, IEEE Transac- tions on, 26(11):1472–1482, 2007. 
[24] C. Goodlett, B. Davis, R. Jean, J. Gilmore, and G. Gerig. Improved 
correspondence for dti population studies via unbiased atlas building. 
Medical Image Computing and Computer-Assisted Intervention–MICCAI 
2006, pages 260–267, 2006. 
[25] M. Ingalhalikar, J. Yang, C. Davatzikos, and R. Verma.  Dtidroid: 
Diffusion tensor imagingdeformable registration using orientation and 
intensity descriptors. Interna- tional Journal of Imaging Systems and 
Technology, 20(2):99–107, 2010. 
[26] M. Jenkinson, P. Bannister, M. Brady, and S. Smith. Improved 
optimization for the robust and accurate linear registration and motion 
correction of brain images.  Neu- roImage, 17(2):825–841, 2002. 
[27] M. Jenkinson, C.F. Beckmann, T.E.J. Behrens, M.W. Woolrich, and S.M. 
Smith. Fsl. NeuroImage, 62(2):782–790, 2012. 
[28] M. Jenkinson, M. Pechaud, and S. Smith. Bet2: Mr-based estimation of 
brain, skull and scalp surfaces. pages 12–16. 
[29] Chiang Ming-Chang, A. D. Leow, A. D. Klunder, R. A. Dutton, M. Barysheva, S. 
E.Rose, K. L. McMahon, G. I. de Zubicaray, A. W. Toga, and P. M. Thompson. Fluid 
registration of diffusion tensor images using information theory.  Medical Imaging, 
IEEE Transactions on, 27(4):442–456, 2008. 
[30] S. Mori, K. Oishi, H. Jiang, L. Jiang, X. Li, K. Akhter, K. Hua, A.V. Faria, A. Mah- 
mood, and R. Woods. Stereotaxic white matter atlas based on diffusion 
tensor imaging in an icbm template. NeuroImage, 40(2):570–582, 2008. 
[31] D.E. Rex, J.Q. Ma, and A.W. Toga. The loni pipeline processing 
environment. Neu- roImage, 19(3):1033–1048, 2003. 
[32] A. Roche, G. Malandain, X. Pennec, and N. Ayache. The correlation 
ratio as a new similarity measure for multimodal image registration. 
Medical Image Computing and Computer-Assisted Interventation—
MICCAI’98, pages 1115–1124, 1998. 
[33] D.W. Shattuck, S.R. Sandor-Leahy, K.A. Schaper, D.A. Rottenberg, and 
R.M. Leahy.Magnetic resonance image tissue classification using a partial 
volume model.  Neu- roImage, 13(5):856–876, 2001. 
[34] S.M. Smith. Fast robust automated brain extraction. Human Brain 
Mapping,17(3):143–155, 2002. 
[35] H. Zhang, P.A. Yushkevich, D. Rueckert, and J.C. Gee. Unbiased white matter atlas 
construction using diffusion tensor images. pages 211–218. Springer-Verlag. 
[36] S. Zhang, H. Peng, R.J. Dawe, and K. Arfanakis.  Enhanced icbm diffusion 
tensor template of the human brain. NeuroImage, 54(2):974–984, 2011. 
[37] K. Zilles, R. Kawashima, A. Dabringhaus, H. Fukuda, and T. Schormann.  
Hemi- spheric shape of european and japanese brains: 3-d mri analysis of intersubject 
vari- ability, ethnical, and gender differences. NeuroImage, 13(2):262–271, 2001.
 
 2
用 NCS 模擬器來進行大範圍神經網路的模擬與分析有初步的認識，課程內容十分精彩。整體來說，
這些 Tutorials 由淺入深、包羅廣泛，十分精彩。Tutorials 過後接著便是一連五天的主會議與
Workshops，本次會議的重點圍繞在計算神經行為學（Computational Neuroethology）的探討，Keynote 
speech 是由英國愛丁堡大學的 Barbara Webb 教授進行有關神經元與行為的研究發表，對於昆蟲感
覺運動控制的計算與機器模型有很精闢的探討。另一場 Keynote Speech 則是由美國喬治亞州立大
學的 Donald Edwards 教授所進行有關神經機械模擬與混合系統的研究發表，對於姿勢與反覆運動
的再內導（reafference）有詳盡的說明。最後一場 Keynote speech 是由美國西北大學的 Malcolm 
Maciver 教授主講，內容是有關運動與體感之間的能量資訊平衡。整體來說本次會議議程非常豐
富、深入、與多元，收穫良多。 
 
圖：壁報論文發表 
 
三、建議 
本會議每次均包含豐富的教育訓練課程，精彩的 Keynote Speech，以及涵蓋 oscillation、感覺
系統、麻醉與睡眠、記憶、模型等等廣泛計算神經科學相關主題，非常值得國內相關領域研究人
員參與此會議。 
 
四、攜回資料名稱及內容 
攜回包含會議議程、論文列表、論文檔案之 USB Drive。 
Dysfunction of cross-frequency phase-phase coupling in primary 
dysmenorrhea: a resting magnetoencephalographic study 
Pin-Shiuan Lee1, Yong-Sheng Chen2, Jen-Chuen Hsieh3,4, Li-Fen Chen3,4 
1Institute of Biomedical Informatics, National Yang-Ming University, Taipei 112, Taiwan 
2Department of Computer Science, National Chiao Tung University, Hsinchu 300, Taiwan, 
3Institute of Brain Science, National Yang-Ming University, Taipei 112, Taiwan 
4Integrated Brain Research Laboratory, Department of Medical Research and Education, Taipei Veterans General 
Hospital, Taipei 112, Taiwan 
E-mail: pshiuan@gmail.com 
 
Cross-frequency synchronization between local or large-scale networks has been proposed recently, which is related 
to phase coupling between neuronal oscillations of different frequency content [1]. This study aimed at investigation 
of how cross-frequency coupling of local network during rest is modulated by pain experience. Ten primary 
dysmenorrhea (PDM) women, who suffer from lower abdominal pain during menstrual phase, and ten age-matched 
healthy subjects during menstrual phase were enrolled. Three-minute eye-open resting magnetoencephalographic 
(MEG) signals of each individual were recorded using a 306-channel magnetoencephalography system. For each 
channel, synchronization value of cross-frequency coupling was estimated by calculating phase-locking statistics of 
phase differences between two frequency bands, including 2, 4, 8, 12, 16, 24, 32, and 40 Hz, respectively. The 
results showed that the PDM group displayed oscillatory hyperconnectivity of low alpha-beta (8-16 Hz) coupling in 
the medial superior parietal area (Figure 1(a)) and hypoconnectivity of high alpha-beta (12-24 Hz) coupling in the 
frontal area (Figure 1(b)), where were functionally and structurally connected in previously reports of resting 
networks [2]. Two-way ANOVA results showed interaction between group and cross-frequency synchronization 
values at these regions.  
 
 
Conclusions 
Our findings implicate that pain 
experience may modulate phase-
phase coupling of alpha-beta 
oscillation, which might disrupt 
integration between nearby neural 
population in the human neocortex.  
 
 
 
 
 
 
 
 
Acknowledgements 
This study was supported in part by the National Science Council (NSC 100-2629-B-010-001) and Yen Tjing Ling 
Medical Foundation (CI-100-5). 
References 
1. Nikulin V, Brismar T: Phase synchronization between alpha and beta oscillations in the human 
electroencephalogram. Neuroscience 2006, 137(2):647-657. 
2. Van Den Heuvel M, Mandl R, Pol HH: Normalized cut group clustering of resting-state FMRI data. PLoS 
One 2008, 3(4):e2001. 
 
 
 
 
2
 
Person Identification using
Electroencephalographic Signals Evoked by
Visual Stimuli?
Jia-Ping Lin1, Yong-Sheng Chen1,2??, and Li-Fen Chen3
1 Inst. of Biomedical Engineering, National Chiao Tung University, Hsinchu, Taiwan
2 Dept. of Computer Science, National Chiao Tung University, Hsinchu, Taiwan
3 Inst. of Brain Science, National Yang-Ming University, Taipei, Taiwan
Abstract. In this work we utilize the inter-subject differences in the
electroencephalographic (EEG) signals evoked by visual stimuli for per-
son identification. The identification procedure is divided into classifica-
tion and verification phases. During the classification phase, we extract
the representative information from the EEG signals of each subject
and construct a many-to-one classifier. The best-matching candidate is
further confirmed in the verification phase by using a binary classifier
specialized to the targeted candidate. According to our experiments in
which 18 subjects were recruited, the proposed method can achieve 96.4%
accuracy of person identification.
1 Introduction
Conventional person identification methods include passwords, smart cards, and
a variety of biometric techniques. Passwords and smart cards are widely-used
because of the advantage of convenience. However, smart cards might be stolen,
simple passwords might be deciphered, and complicated passwords might be for-
gotten. Current biometric features such as iris, fingerprints, face, voice, palm, and
gait do not suffer the above-mentioned disadvantages, but they can be stolen,
duplicated, or even provided under violent threats. Brainwave is an emerging bio-
metric feature for person identification because of its uniqueness and consistency.
Moreover, brainwave is difficult to steal or duplicate and the characteristics em-
bedded in the brainwave when the subject is under threat are hardly the same
as those in normal situation. These advantages promote brainwaves as new keys
to safer person identification systems.
Among all the non-invasive brainwave acquisition modalities, electroencepha-
lography (EEG) has the advantages of portability, easy operation, high tempo-
ral resolution, and low costs. To evaluate the uniqueness and consistency of the
? This work was supported in part by the MOE ATU program, Taiwan National
Science Council under Grant Numbers: NSC-99-2628-E-009-088 and NSC-100-2220-
E-009-059, and the UST-UCSD International Center of Excellence in Advanced Bio-
engineering sponsored by the Taiwan National Science Council I-RiCE Program
under Grant Number: NSC-99-2911-I-009-101.
?? Corresponding author.
Person Identification using Electroencephalographic Signals 3
+
1 s 1 s
or
Fig. 1: Paradigm for data acquisition in this study. A trial consists of one-second
stimulus, an image containing either a small disk or a large one, and one-second
fixation.
the activities which are not induced by the events. The EEG data were recorded
with Scan 4.3 software and the sampling rate for data acquisition was 500Hz.
The earlobe electrodes A1 and A2 provided the reference. Signals were digitally
filtered within the 5-30 Hz band.
We used EEGLAB 9.0 [2] to perform the following signal preprocessing pro-
cedure. The EEG data were first segmented into epochs starting from one second
before the stimulus onset to one second after stimulus onset. The baseline cor-
rection was applied to remove the DC drift. Epochs with burst activities during
the post-stimulus period were rejected (with the threshold values -50µV and
50µV). The trials evoked by the large disk events were used in the following
person identification analysis.
3 Methods
3.1 Feature Extraction
For each of the EEG channels, we applied a series techniques to extract features.
These techniques, described in the following, include dimension reduction, mor-
phological operation, power spectrum, and stochastic modeling.
Dimension reduction Principal component analysis (PCA) is a method for
reducing feature dimension. Its main idea is to find a set of basis, usually with
a much smaller dimension, to represent the original data set while preserving
as much as information measured by the variance of data distribution. If there
is an embedded non-linear manifold lying in a high-dimensional space and the
dimension of the manifold is relatively low, this manifold can be well represented
in a low-dimensional space [8]. Therefore, we also applied the locally linear em-
bedding (LLE) method to transform the data to a low-dimensional space while
Person Identification using Electroencephalographic Signals 5
3.2 Classification
For classification, we employed the support vector machine (SVM) and the k-
nearest neighbor (kNN) search method (k=9) as the classifier. To fairly evaluate
the accuracy of classification, we apply the 8-fold cross validation that separate
EEG data into training and testing data to obtain the average classification
accuracy for person identification.
3.3 Verification
The purpose of the verification procedure is to reconfirm the best-matching re-
sult of classification. For each of the eighteen subjects, we trained a SVM binary
classifier by using two groups of training data including EEG data of the targeted
subject and those of all others. We evaluate the binary classifier for verification
in terms of the true acceptance rate (TAR) and the false acceptance rate (FAR).
The best-matching subject from the classification procedure is verified by the
corresponding binary classifier. In addition, we modified the false classified data
in classification phase through iterative verification. The probability estimate,
which is a confidence level of classification, determines an ordered list of can-
didates having confidence levels larger than 80% of that of the best-matching
candidate.
4 Results
4.1 Temporal characteristics in the acquired signals
We first verified whether the resting EEG or ERP is better for distinguishing
subjects’ identities. By applying the SVM classifier to categorize the pre-stimulus
(500 ms before onset) EEG signals among the eighteen subjects, the classification
accuracy was 12.2%. When the post-stimulus (500 ms after onset) ERP signals
were used for person identification, the classification accuracy achieved 25.3%.
Therefore the ERP contains more information for person identification than
resting EEG does.
4.2 Accuracy in the classification phase
Table 1 shows the classification accuracy comparison among seven features
extracted from the 1000ms post-stimulus EEG signals with respect to single trial,
average of two trials, SVM, and kNN. The average of two trials can achieve higher
classification accuracy compared to single trial data because of higher signal-to-
noise ratio. Regarding the classifier, SVM outperforms kNN with respect to
various features.
Among the seven kinds of features, power spectrum achieves the best clas-
sification accuracy while the latency and amplitude generally lead to poor re-
sults. Fig. 2 shows the power spectrum of different subjects with the frequency
band ranging from 5 Hz to 30 Hz. We can see that within-subject variation of
Person Identification using Electroencephalographic Signals 7
5 10 15 20 25 30
0
1
2
3
4
Subject1
Frequency (Hz)
P
ow
er
 S
pe
ct
ru
m
5 10 15 20 25 30
0
2
4
6
Subject2
Frequency (Hz)
P
ow
er
 S
pe
ct
ru
m
Fig. 2: The power spectrum of ten trials of two subjects (thick black lines rep-
resent the averages of ten trials). Each trial shows the average results of ten
channels.
Table 3: TAR, FAR, and results of iterative verification of data acquired from
different days.
Subject 3 5 8 12 13
TAR (%) 78.57 100 97.92 83.33 100
Accepted/False classified 0/1 4/6 0/0 0/0 11/12
FAR (%) 0 66.67 - - 91.67
that the the performance of our system slightly degrades over time. One possible
remedy is to retrain the classifier by adding the data acquired over time so that
the classifier can be adapted to each subject. By using the two sets of EEG
data acquired at different times, the average accuracy of the classification phase
is improved from 93.2% to 98.4%, TAR is increased from 90.6% to 97.7%, and
FAR is decreased from 79.0% to 0%. After iterative verification, the overall
identification accuracy of our system is improved from 85.7% to 96.8%.
5 Discussion and Conclusions
The major causes affecting the accuracy of person identification using EEG sig-
nals include both external and internal interferences. The external interferences
deteriorate the quality of acquired signal whereas the internal interferences re-
sult in signal instability over time. From the calculated correlation between EEG
trials of different subjects, the EEG data of subjects having high correlation to
those of other subjects have more classification errors. Compared with the inter-
subject correlation, the intra-subject correlation between EEG trials acquired
國科會補助計畫衍生研發成果推廣資料表
日期:2012/12/05
國科會補助計畫
計畫名稱: 腦部結構磁振造影影像量化分析與模板建立(2/2)
計畫主持人: 陳永昇
計畫編號: 100-2628-E-009-006- 學門領域: 醫學資訊
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
無。 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
