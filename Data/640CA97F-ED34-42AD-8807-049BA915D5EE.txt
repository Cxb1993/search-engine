 ii
 
 
中文摘要 
殘留振動的存在，影響了撓性機件傳輸運動之精度定位，增加達成工作目標所需要的
時間，並降低其工作效率。減少殘留振動的方法有閉迴路設計的回授控制以及開迴路設的
輸入修正法。回授控制具有抵抗干擾與提供系統強健性的能力，但往往需與系統妥協而影
響控制系統性能表現。而輸入修正法提供了一個有效且快速的減振方法，能有效地縮短安
定時間及抑制殘留振動，但輸入修正法屬於廣義的開迴路控制，對外界干擾無抵抗能力，
無法完全消除其造成的殘留振動。在本計畫執行中，我們建立了一雙自由度長距離移動系
統之模型，並分別利用輸入修正法與回授控制系統以抑制於移動過程中造成的殘留振動。
依系統本身的性能限制設計輸入修正法，模擬分析和實驗結果顯示，線性輸入修正法能有
效地抑制殘留振動，且可根據其所需求之條件選用不用的輸入修正模式，於加/減速過程所
殘留下的 Undershoot/Overshoot 最大為未修正前的二分之一。回授控制方面，我們分別設計
了頻率響應控制與全狀態回授控制，其結果顯示，全狀態回授能夠快速且有效地完全抑制
系統殘留振動。本計畫研究成果將有助於應用在需要快速且穩定的長距離移動之相關應用。 
本成果報告說明本研究計畫之動機與背景，整理本研究團隊早期與本計畫執行期間的
重要成果，並且為本計畫的未來走向做了一番延伸探討。透過本報告，我們希望能呈現本
計畫在輸入修正法理論、實驗、以及實務應用上所獲得之豐碩成果。就可量化成果而言，
在本計畫執行期間我們已產出數篇學位論文、國內研討會論文、與國際期刊論文，因此我
們有理由相信本計畫之執行可謂相當成功。 
 
 
關鍵詞：輸入修正、殘留振動、長距離移動系統、回授控制、頻率響應控制、全狀態回授 
 
 iv
 
目 錄 
 
摘要 ·································································································································· ii 
Abstract····························································································································iii 
目錄 ································································································································· iv 
表目錄 ····························································································································vii 
圖目錄 ···························································································································viii 
符號說明 ························································································································xii 
第一章 緒論                                                            1 
1.1 前言···················································································································· 1 
1.2 輸入修正法與回授控制之文獻研究································································· 2 
1.2.1 輸入修正法之文獻研究 ········································································· 2 
1.2.2 回授控制相關研究 ················································································· 4 
1.3 研究動機及目的 ································································································ 4 
1.4 全文架構············································································································ 5 
第二章 文獻回顧與背景介紹                                              6 
2.1 本章介紹············································································································ 6 
2.2 輸入修正法背景介紹 ························································································ 6 
2.2.1 輸入修正法之數學理論 ········································································· 7 
2.3 輸入修正法之應用 ·························································································· 10 
2.4 回饋控制·········································································································· 14 
2.4.1 頻率響應控制 ······················································································· 14 
2.4.2 全狀態回授控制 ··················································································· 15 
2.4.3 全狀態回授控制器設計 ········································································ 19 
2.5 本章結論··········································································································· 19 
第三章 實驗系統與方法介紹                                             20 
3.1 問題確定與研究規劃 ······················································································ 20 
3.2 實驗系統架構 ·································································································· 22 
3.3 系統建模·········································································································· 26 
3.4 系統參數量測 ·································································································· 27 
3.5 控制方法介紹 ·································································································· 28 
3.5.1 線性輸入修正法 ··················································································· 28 
3.5.2 頻率響應控制 ······················································································· 29 
3.5.3 狀態回授控制 ······················································································· 31 
3.6 本章結論·········································································································· 31 
第四章 輸入修正法模擬與實驗                                           32 
4.1 本章介紹·········································································································· 32 
4.2 線性輸入修正法設計 ······················································································ 33 
4.2.1  Two-pulse ZV 法 ················································································· 33 
4.2.2  Three-pulse ZV法 ················································································ 34 
4.2.3  ZVD 法······························································································· 35 
4.2.4  2x3 MIS ZVD法 ·················································································· 36 
4.3 線性輸入修正法之模擬與實驗結果······························································· 37 
4.3.1 2-pulse ZV法 ·························································································· 38 
4.3.2 3-pulse ZV法 ·························································································· 39 
4.3.3 ZVD法···································································································· 40 
4.3.4 2x3 MIS ZVD 法 ··················································································· 41 
 vi
參考文獻                                                           92 
附錄                                                               95 
 
 viii
 
圖目錄 
 
圖1.1 機械手臂 ···········································································································1 
圖1.2 運櫃天車 ···········································································································1 
圖1.3 wafer stepper ·····································································································1 
圖1.4 經過與未經過輸入修正之輸入/輸出關係圖 ···················································2 
圖1.5 機械手臂 ···········································································································2 
圖1.6 X-Y 循跡紀錄平台 ···························································································3 
圖1.7 德州儀器數位鏡片分解圖················································································3 
圖1.8 (a)梳形致動器 (b) 靜電致動平行板 (c) contact RF switch ···························3 
圖1.9 論文架構圖 ·······································································································5 
圖2.1 本章架構 ···········································································································6 
圖2.2 輸入修正法之研究過程與歷史········································································6 
圖2.3 輸入修正示意圖 (a) ZV shaper (b) ZVD shaper··············································8 
圖2.4 ZV shaper 與 ZVD shaper 之靈敏度曲線······················································8 
圖2.5 (a)二個 2-pulse ZV shaper 的褶積 
 (b) 2-pulse ZV shaper 與 3-pulse ZV shaper 的褶積·········································9 
圖2.6 機械手臂之軌跡控制 ····················································································· 10 
圖2.7 未使用輸入修正法(a) 旋轉角度 (b) 末端振動量 ······································· 10 
圖2.8 使用 ZV 輸入修正法(a) 旋轉角度 (b) 末端振動量 ···································· 11 
圖2.9 X-Y 循跡紀錄平台 ························································································· 11 
圖2.10 利用輸入修正法改善 X-Y 循跡紀錄平台循跡能力 ····································· 11 
圖2.11 Gantry crane model·························································································· 12 
圖2.12 系統末端 payload 響應 
 (a)未使用輸入修正法(b)使用輸入修正法 ····················································· 12 
圖2.13 Middeck Active Control Experiment (MACE) ················································ 12 
圖2.14 閉迴路之 STOS 控制系統示意圖 ·································································· 13 
圖2.15 壓電式光纖定位平台圖 ················································································· 13 
圖2.16 壓電式光纖對位精密平台 
 左圖：未使用演算法控制 右圖：使用演算法控制後 ································ 13 
圖2.17 方波軌跡追蹤之比較 
 (a)未使用演算法控制、(b)使用演算法控制後 ············································· 14 
圖2.18 離散控制系統流程圖 ····················································································· 15 
圖2.19 全階狀態估測器示意圖 ················································································· 16 
圖2.20 最小階狀態估測器示意圖·············································································· 17 
圖2.21 全狀態回授控制示意圖 ················································································· 19 
圖3.1 Genetic model 示意圖 (a)轉動運動，(b)直線運動······································· 20 
圖3.2 懸吊天車示意圖 ····························································································· 20 
圖3.3 wafer stepper 示意圖······················································································· 21 
圖3.4 wafer stepper 系統建模之自由體圖 ······························································· 21 
圖3.5 本章架構 ········································································································· 22 
圖3.6 系統示意圖與實體圖 ····················································································· 23 
 x
圖5.9 notch filter 實現圖··························································································· 55 
圖5.10 phase lead-lag controller 實現圖 ····································································· 55 
圖5.11 系統閉迴路控制之 simulink 等效模型 ·························································· 55 
圖5.12 利用頻率響應之控制結果·············································································· 56 
圖5.13 roll-off filter 實現圖 ························································································ 56 
圖5.14 系統加入了 roll-off  filter 之控制模擬結果 ················································ 57 
圖5.15 控制流程圖 ····································································································· 57 
圖5.16 notch filter 與 phase lead-lag control 之實驗結果 ·········································· 58 
圖5.17 馬達行走不同方向並利用 notch filter 與 phase lead-lag control 
 控制之實驗結果 ····························································································· 58 
圖5.18 包含 notch filter，phase lead-lag control 與 roll-off filter 之 
 控制器實驗結果 ····························································································· 59 
圖5.19 控制輸出電流 ································································································· 59 
圖6.1 本章架構 ········································································································· 61 
圖6.2 全階估測器 ····································································································· 64 
圖6.3 主極點設置之示意圖 ····················································································· 65 
圖6.4 利用[ x2]設計全階狀態估測器模擬誤差 ······················································· 66 
圖6.5 利用[ x2] 設計全階狀態估測器之實驗誤差 ················································· 66 
圖6.6 利用[ x2] 設計全階狀態估測器之參數妥協實驗結果 ································· 67 
圖6.7 利用[x1 x2]’ 設計全階狀態估測器之模擬結果············································· 68 
圖6.8 利用[x1 x2]’ 設計全階狀態估測器之實驗結果············································· 69 
圖6.9 利用[x2]設計最小階狀態估測器之實驗結果 ················································ 69 
圖6.10 利用[x1  x2]設計最小階狀態估測器之實驗結果 ·········································· 70 
圖6.11 全狀態回授控制器流程圖·············································································· 71 
圖6.12 操作點線性化之模擬結果·············································································· 72 
圖6.13 操作點線性化之實驗結果·············································································· 73 
圖6.14 電磁鐵回饋線性化之模擬結果······································································ 75 
圖6.15 電磁鐵回饋線性化之實驗結果······································································ 75 
圖7.1 本章架構 ········································································································· 77 
圖7.2 對上層掛勾質量 2m 變異之 overshoot 敏感度曲線 ······································· 80 
圖7.3 對上層掛勾質量 1m 變異之 residue vibration 敏感度曲線 ···························· 80 
圖7.4 對上層掛勾質量 1m 變異之 overshoot 敏感度曲線 ······································· 81 
圖7.5 對上層掛勾質量 1m 變異之 residue vibration 敏感度曲線 ···························· 81 
圖7.6 對上層擺長 1L 變異之 overshoot 敏感度曲線 ················································ 82 
圖7.7 對上層擺長 1L 變異之 residue vibration 敏感度曲線 ····································· 82 
圖7.8 對下層擺長 2L 變異之 overshoot 敏感度曲線················································ 83 
圖7.9 對下層擺長 2L 變異之 residue vibration 敏感度曲線····································· 83 
圖7.10 各種控制方法 overshoot 之模擬結果比較 ···················································· 84 
圖7.11 各種控制方法 overshoot 之實驗結果比較 ···················································· 84 
圖7.12 各種控制方法 overshoot 之結果比較 ···························································· 85 
圖7.13 各種控制方法安定時間之模擬結果比較 ······················································ 85 
圖7.14 各種控制方法安定時間之實驗結果比較 ······················································ 86 
 
符號說明 
 
x 系統位移 
ω 系統自然頻率 
ωd 系統有阻尼自然頻率 
ζ 阻尼比 
F(t) 外力輸入 
Ai  第 i 個脈衝輸入的強度 
Ti 第 i 個脈衝輸入的時間 
m 脈衝總數 
ωa 系統真實自然頻率 
ωm 設計輸入修正法所採用的頻率 
T 系統週期 
1T  系統第一模態週期 
K 全狀態回授控制增益矩陣 
x( )k  第 k 個取樣點之系統狀態向量 
x( )k  估測第 k 個取樣點之系統狀態向量 
u( )k  系統第 k 個取樣點之輸入向量 
y( )k  系統第 k 個取樣點之輸出向量 
G  離散空間系統矩陣 
H  離散空間系統輸入矩陣 
C  離散空間系統輸出矩陣 
Ke 估測器回饋增益矩陣 
( )ax k  系統可量測狀態 
( )bx k  系統不可量測狀態 
x  線性馬達加速度 
1θ  第一層角位移 
2θ  第二層角位移 
1x  第一層位移 
2x  第二層位移 
1L  第一層擺長 
2L  第二層擺長 
1m  第一層質量 
2m  第二層質量 
1ω  系統第一模態之自然頻率 
2ω  系統第二模態之自然頻率 
1nω  設計後系統閉迴路主頻率 
2nω  設計後系統閉迴路次頻率 
maxV  線性馬達之最大速度 
δ  線性馬達加速度作用的時間 
a  線性馬達加速度 
B 馬達等速度運動的時間 
sT  取樣時間 
1ζ  上層阻尼比 
2ζ  下層阻尼比 
1  
 
 
 
第一章 序論 
 
1.1 前言 
 
長距離移動系統常用於傳輸運送或精密定位等用途，常見的應用實例如機械手臂(圖
1.1) [1]，天車(圖 1.2) [2]與 wafer stepper(圖 1.3) [3]等，其由傳輸機構帶動載體轉動運動或
直線運動。而在運動過程中，系統主體會因加減速造成的慣性力而產生明顯的振動，對於
機械手臂而言，殘留振動會造成位置精度不良，天車在運送過程中的振動可能會危害到底
下工作人員的安全以及增加工作時間，而 wafer stepper 的殘留振動會降低晶圓廠的效率與
良率。對機械系統而言，移動過程中產生的振動或到達定位後的殘留振動除了降低系統在
時間或精度上的性能外，更會減少機件之疲勞壽命，故振動抑制不管是在機械設計或是力
學分析裡皆是一大重要的課題。 
振動抑制方法除了在結構上增加系統的阻尼外，還有線性或非線性的輸入修正法
[4-9]，以及線性或非線性的控制[10-12]。在結構上增加系統的阻尼，將會改變系統本身的
機械結構，在為了牽制工作性能的情況下，可能會造成系統主體結構過大或是其他的結構
問題產生，而對於一已完成或完工的機械系統而言，其能改善的程度有限。輸入修正法的
優點為低成本，不須外加感測器與回授控制之制動器，最典型的便是 ZV shaper 
(Zero-vibration shaper) [5]與 ZVD shaper (Zero-vibration and derivative shaper)，為根據系統的
特性與所須目的來改變系統之輸入形式，如圖 1.4 所示，利用波的破壞性干涉原理來降低
系統在移動過程中或到達定位後的振動情形，但對於外界的干擾並無抵抗能力。而回授控
制必須加入感測器與回授控制之制動器，成本與複雜性較高，一般業界最常用的如 PID 控
制等，可根據所須的響應條件做調整，對於外界干擾或是輸入誤差能夠立即的感應與制衡。 
 
圖 1.1 機械手臂[1] 圖 1.2 運櫃天車[2] 
  
    
圖 1.3 wafer stepper [3] 
 
3  
 
 
 
 
 
圖 1.6  X-Y 循跡紀錄平台[14] 
 
 
圖 1.7 德州儀器數位鏡片分解圖[21] 
 
      
 
 
 
 
圖 1.8 (a)梳形致動器 (b)靜電致動平行板 (c)contact RF switch[22] 
 
l = 600μm 
100μm 
h = 2μm
b = 10 μm 
G0 
(b) (c) 
(a) 
5  
 
 
移動系統模型，以線性馬達模擬傳輸機構，利用輸入修正法與回授控制以抑制系統主
體振動，並討論於參數不確定時強健性比較。 
 
1.4 全文架構 
 
本文內容共分八章，第一章為緒論，略敘本研究重點與目的，同時說明章節分配。
第二章為文獻回顧，介紹線性輸入修正法與回授控制的相關研究，與此二種方法於長
距離離移動系統中之相關應用。第三章為實驗系統與方法介紹，在這部份包括實驗系
統建立與系統動態部份，建立一雙單擺系統模擬長距離移動之雙自由度系統主體，利
用線性馬達模擬傳輸機構，並介紹將應用於此系統上之減振方法―輸入修正法與回授
控制之設計方式。 
第四章為輸入修正法模擬與實驗，首先根據系統特性設計輸入修正形式而後透過
模擬與實驗的方式來驗証，比較在各種輸入修正方式下，對系統振動抑制的能力與效
果。第五章為頻率響應控制與實驗，在此章節中，只針對雙單擺系統末端的振動量做
回授控制，利用一個雷射位移感測器與一組電磁鐵控制末端的振動以期達到減振的目
的。第六章為全狀態回授模擬與控制，對雙單擺系統設計了狀態估測器，分別估測上
層與下層的位置和速度狀態，利用全狀態回授控制對系統做振動控制，並討論使用操
作點線性化與回饋線性化之控制結果差異。 
第七章為研究結果討論，在此章節中，將討論在第四章與第六章中不同控制方法
之參數敏感度討論與其振動抑制效果。第八章為結論，並說明本研究計畫之貢獻與未
來努力方向。本文架構如圖 1.9 所示。 
 
 
圖 1.9 論文架構圖 
7 
 
圖2.2 輸入修正法之研究過程與歷史 
 
 
 
2.2.1 輸入修正法之數學理論 
 
首先，考慮一典型二階具阻尼系統，其動態方程式為: 
2 22 ( )x x x F tςω ω ω+ + =   (2.1)
其中 x 為系統位移，ω 為系統自然頻率，ς 為阻尼比 , ( )F t 則為外力輸入。當系統受
到一連串脈衝組成的步階輸入時，系統的響應為: 
1
- 2 2 2
1 1
[( cos( )) ( sin( )) ]m i i
m m
T T T
i d i i d i
i i
x e Ae T Ae Tςω ςω ςωω ω
= =
= +∑ ∑ (2.2)
其中 dω 為系統有阻尼之振動頻率，與 iA 與 iT 分別為第 i個脈衝輸入的強度與時間，m
為脈衝的總數。若要系統零殘留振動的最基本條件為: 
1
1
cos( ) 0
sin( ) 0
i
i
m
T
i d i
i
m
T
i d i
i
Ae T
Ae T
ςω
ςω
ω
ω
=
=
=
=
∑
∑
 (2.3)
取 2m = 時，可得 
1 1
2 2
1 0,
1
1 2
d
A T
k
TkA T
k
= =+
= =+
 (2.4)
其中 2( / 1 ) k e ςπ ς− −= ，此即為ZV shaper，示意圖如圖2.3(a)。 
由式(2.4)可看出，脈衝輸入與系統的有阻尼自然頻率有關，而 ZV shaper 對於參
數不確定性非常敏感，為了增加輸入修正法對實際系統之實用性，在推導式中除了零
振幅外可多加一條件:殘留振動對頻率比的偏微分也為零，稱為 ZVD shaper (Zero 
Vibration and Derivative shaper)，也可將 ZVD shaper 視為二個ZV shaper的褶積，其
推導出的結果為: 
9 
 
在式2.2中，取 3m = 時[13]，可得 
1 12
2 22
2
3 32
1 0,
1
,
1 3
2
1 3
d
d
A T
k k
TkA T
k k
TkA T
k k
= =+ +
= =+ +
= =+ +
 
其中 2(2 /3 1 )k e ςπ ς− −= ，此即為3-pulse ZV shaper。 
為了加以區別，將典型的 ZV shaper 稱為 2-pulse ZV shaper [13]，取 3m = 時的 
shaper 稱為3-pulse shaper。如前述，將2個2- pulse shaper做褶積可得到ZVD shaper，
如圖2.5(a)所示，若將2-pulse ZV shaper與3-pulse shaper 做褶積可得到新的輸入修正型
式，稱為2x3 MIS ZVD[13]，示意圖如2.5(b)所示。 
2-pulse ZV shaper 是將原輸入切成兩相同大的輸入，且兩輸入之間隔時間為T / 2 
(振動波之半週期)；根據線性疊加原理，整個系統的反應將因破壞性干涉，使得殘留
振動完全消除，只留下在加速時的overshoot。3-pulse ZV shaper 為將原輸入均分成三
個相同大小的輸入，且輸入之間隔時間皆為1/3 個系統週期。ZVD shaper 是將原輸
入切成三個輸入，兩兩間輸入之間隔時間為T / 2，可視為二個ZV 的褶積所得，雖然
其上升時間比ZV shaper 多了半週期，但擁有較佳的強健性。2x3 MIS ZVD shaper 為
將原輸入均分成六個輸入，分別在作動瞬間與系統週期的1/3，1/2，2/3，5/6，7/6 輸
入，為2-pulse ZV 與3-pulse ZV 褶積所得。 
 
 
 
 
圖2.5  (a) 二個2-pulse ZV shaper 的褶積  (b) 2-pulse ZV shaper 與3-pulse ZV shaper
的褶積 
 
 11
 
圖 2.8 使用 ZV 輸入修正法(a) 旋轉角度 (b) 末端振動量[13] 
 
 
 
 
圖 2.9  X-Y 循跡紀錄平台[14] 
 
 
 
 
圖 2.10 利用輸入修正法改善 X-Y 循跡紀錄平台循跡能力[14] 
Unshaped response to circular trajectory shaped response to circular trajectory 
 13
而在輸入修正結合回授控制方面，由 La-orpacharapan 與 Pao [45,46]為代表，他
們以輸入修正法結合回授控制，並以相平面作分析，設計時間最佳化控制[shaped 
time-optimal servomechanism (STOS) controllers]，可應用於磁碟讀寫頭，目的為有效
提高讀寫品質與作動效率，對於輸入修正結合最佳控制作完整的討論，已有相當不錯
的結果，如圖 2.14 所示，為閉迴路之 STOS 控制系統示意圖。另一個實際例子則為
由 Photonics Innovators 所發表的 Vibration Nullification Algorithm[47]，其應用輸入修
正於壓電式光纖對位精密平台，可達到最佳化的軌跡控制，如圖 2.15 與圖 2.16 [48]
所示，比較使用輸入修正控制前後的差別可看出利用輸入修正法與控制可得到良好波
型。圖 2.17 則為方波軌跡追蹤，經過該演算法控制，亦能達到不錯的切換作動，可
應用於微切換器，有效抑制殘留振動與縮短安定時間，進而提升機械工作效率。 
 
 
 
圖 2.14 閉迴路之 STOS 控制系統示意圖[46] 
 
 
 
圖 2.15 壓電式光纖定位平台圖[48] 
 
 
圖 2.16 壓電式光纖對位精密平台 左圖：未使用演算法控制 右圖：使用演算法控
制後[48] 
 15
時，系統對於正弦輸入的輸出行為，系統的任意輸入 ( )r t 可視為各種頻率正弦波的合
成，而對於線性系統其總輸出即為面對各種頻率下系統輸出的線性組合。在頻域的研
究中，大都利用開迴路頻率響應來預測其閉迴路特性，如共振峰值，共振頻率等系統
資訊。 
隨著數位信號的發展，在自動控制系統中，控制器於數位化中實現是非常廣泛
的，數化控制器或電腦在控制精度，速度與性能上的表現相對於類比控制器有著明顯
的優越性，且可快速地改變其控制參數。而對於一典型的離散控制系統 : 受控系統
為連續的，而受控系統的輸出訊號連接 A/D 卡，經過類比轉數位的過程，再利用電
腦加以運算，而後連接 D/A 卡，經過數位轉類比的過程傳送給系統致動器，即為系
統輸出，如圖 2.18 所示[50]，其控制器的設計方式通常為將連續的受控系統轉換成
數位離散系統，包含一 zero - order hold (ZOH)，再利用相似轉換轉到 w domain，在 w 
domain 中對系統設計控制器，再利用相似轉換至 z domain，於控制電腦中實現。 
 
2.4.2 全狀態回授控制 
 
對於一控制系統，於古典控制理論中為利用 Laplace’s transform 表示成轉移函
數，而在現代控制理論中，為利用矩陣與線性代數將系統表示成狀態空間表示法。隨
著科技快速發展，控制系統的精密度與複雜度不斷提高，常為多輸入多輸出和時變之
系統，而對於此類複雜度高的系統，狀態空間表示法扮演了相當重要的角色。 
於現代控制理論中，主要的控制器設計方式為利用系統狀態變數經過特定之增
益值後，使得閉迴路極點於到達所希望的位置。而在全狀態控制器中，所需的回授控
制參數為系統之位移與速度，在實際系統的應用上，位移可利用雷射位移感應器即可
獲得，速度方面可由光學速度感測器，雷射都卜勒速度計或粒子影像速度計加以量
測，但也許受限於成本或空間架設問題，並無法完全經由感測器量測系統狀態，則可
藉由狀態估測器的設計而獲得。接下來，將分別介紹全階估測器與最小階估測器之設
計方面[49,50]，而後為全狀態回授控制之設計方式。全階狀態估測器之示意圖如圖
2.19。 
 
圖 2.18 離散控制系統流程圖[50]    
 17
 
 
圖 2.20 最小階狀態估測器示意圖 
     
 
假設系統的狀態向量 x 為 n 向量，而可量測獲的輸出向量為 m 向量，則所須估測
的狀態向量為 n-m 個，而估測這 n-m 個狀態向量之估測器即稱為最小階狀態估測器。
首先，將矩陣分為可量測的狀態: x ( )a k 與待估測之狀態: x ( )b k ，即為: 
a
b
x ( )
x( )
x ( )
k
k
k
⎡ ⎤⎢ ⎥= ⎢ ⎥⎢ ⎥⎣ ⎦
""  (2.12)
系統之狀態方程式可改寫為: 
x ( 1) G G x ( ) H
u( )
x ( 1) G G x ( ) H
x ( )
y( ) [ 0]
x ( )
a aa ab a a
b ba bb b b
a
b
k k
k
k k
k
k I
k
+⎡ ⎤ ⎡ ⎤ ⎡ ⎤ ⎡ ⎤⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥= +⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥+⎣ ⎦ ⎣ ⎦ ⎣ ⎦ ⎣ ⎦
⎡ ⎤⎢ ⎥= ⎢ ⎥⎢ ⎥⎣ ⎦
#
""" """" "" "
#
# ""
(2.13)
其中 x ( )a k 為 m 個可量測之狀態， x ( )b k 為 (n-m) 個須估測之狀態，且 
aaG m m= × 矩陣 
( )abG m n m= × − 矩陣 
( )baG n m m= − × 矩陣 
 19
其中 eK 為估測器回饋增益矩陣( observer feedback gain matrix)，則最小階估測器的誤
差動態為:  
e
e( ) η( ) η( ) x ( ) x ( )
e( 1) (G K G )e( )
b b
bb ab
k k k k k
k k
= − = −
+ = −
 
 (2.23)
由式(2.23)可知，估測器之設計為選擇適當的 eK 使得誤差能夠快速收斂並趜於
0。則全狀態回授控制器為: 
u( ) Kx( )k k= −   (2.24)
 
2.4.3 全狀態回授控制器設計 
 
對於一開路為完全狀態可控制之系統，可設計一狀態回授控制，改變其閉迴路極
點位置至達到想要之性能。示意圖如圖 2.21 所示。 
對於一離散開迴路系統，其狀態方程式為: 
x( 1)=Gx( )+Hu( )k k k+  (2.25)
其中 x( )k 為第 k 個取樣之狀態向量，u( )k 為第 k 個取樣之控制訊號，若控制訊號選
擇為: 
u( ) Kx( )k k= −  (2.26)
則系統為一閉迴路控制系統，其狀態方程式為: 
x( 1)=(G-HK) x( )k k+  (2.27)
選擇適當之矩陣K 使得G-HK 之特性根為理想之極點 1 2... nμ μ μ， 。 
 
2.5 本章結論 
 
於本章中介紹了輸入修正法與回授控制之背景與應用。由參考文獻研究結果可知
對於一線性系統，輸入修正法能夠利用波形相消的原理，根據系統自然頻率修正其輸
入方式，降低系統響應之殘留振動，對於雙自由度系統，響應結果也有明顯的改善。
而回授控制加入了感測器與致動器，能夠對系統響應與目標位置之誤差做一立即修
正，且可根據其響應需求，選擇不同的控制方式。 
接下來，於第三章將介紹實驗系統，而後利用不同的輸入修正模式於回授控制以
抑制系統於運動過程中之殘留振動，將分別於第四章，第五章與第六章中利用模擬分
析與實驗驗証其效果。 
 
 
圖 2.21 全狀態回授控制示意圖 
 21
另一種典型的長距離移動系統為 wafer stepper，為由 chunk 固定 wafer，底部線
性馬達帶動 chunk 與 wafer 移動，示意圖如圖 3.3 所示。Wafer stepper 於半導體製程
中扮演重要的角色，其作動目標為快速移動且精密定位，而殘留振動的存在將造成微
影製程中無法精確對準(align)，降低晶片良率，甚至使得整片晶圓報銷，故其位置精
度與系統強健性之需求相當高。圖 3.4 為系統建模之自由體圖， 1M 為 chuck 質量， 1M
為 wafer 質量， 1K 與 2K 為系統剛性，a 為下層線性馬達移動之加速度，在馬達移動過
程中，系統結構上的等效剛性將使得上層 wafer 與 chunk 存在殘留振動。 
本研究所建立的實驗系統模型即為考慮系統主體為雙自由度運動之長距離移動
系統。以線性馬達模擬傳輸機構，考慮其單方向運動，而系統主體長度固定且剛性不
可忽略，建立縮小之等效雙單擺系統模擬在長距離移動情況下系統主體受力擺動情
形，並分別利用輸入修正法與回授控制以討論其對系統振動的抑制程度，下端負載相
對於載台的水平位移量為觀察目標。控制目標為: 快速到達目標位置，且降低系統殘
留振動。定義 overshoot 或 undershoot 為: 傳輸機構在加速或減速時下端負載之振動
量，殘留振動為: 傳輸機構在等速過程中下端負載的振動量。而在實際的應用方面，
輸入修正法可實現於如天車等致動器與感測器架設不易之系統，回授控制可應用於如
無塵室天車或 wafer stepper 等系統上。圖 3.5 為本章架構。 
 
 
 
 
圖 3.3 wafer stepper 示意圖 
 
 
 
圖 3.4 wafer stepper 系統建模之自由體圖 
 23
target 產生吸引之致動力，而電腦送出的電壓訊號需經過電壓轉電流之電源供應器來
獲得準確的電流送入電磁制動器中，圖 3.9 為電磁鐵實體圖，電源供應器之規格如表
3.2，實體圖如圖 3.10 所示。 
 
 
 
 
圖3.6 系統示意圖與實體圖 
 
 
 
圖3.7 馬達實體圖 
 
 25
表3.3  電源供應器重要規格 
電源供應器(控制上層電磁鐵) 電源供應器(控制下層電磁鐵) 
製造商 MOTECH 製造商 MOTECH 
型號 PPS-1005 型號 PPS-2018A 
最大輸出電流 1A 最大輸出電流 2A 
電壓轉電流比 1A/10V 電壓轉電流比 2A/10V 
輸出功率 60W 輸出功率 256W 
 
 
 
 
圖 3.9 電磁致動器實際成品 
 
 
 
 
圖 3.10 電壓轉電流放大器實體圖 
 27
1 2 1 1 1 2 1 1 2 2 2 2
2 2 2 1 1 2 2
( ) ( ) ( ) 0
0
m m l m m g m m x m l
m l l x m g
θ θ θ
θ θ θ
⎧ + + + + + + =⎪⎨ ⎡ ⎤+ + + =⎪ ⎣ ⎦⎩
 
   (3.1c)
其中式(3.1c)為系統運動方程式。系統之自然頻率為: 
2 2
1
1 2 1 2 1 2
2 2
2
1 2 1 2 1 2
g 1 1 1 1 1= [(1 )( ) (1 ) ( ) 4 ]
2
g 1 1 1 1 1= [(1 )( ) (1 ) ( ) 4 ]
2
RR R
L L L L L L
RR R
L L L L L L
ω
ω
⎛ ⎞++ + − + + − ⎜ ⎟⎝ ⎠
⎛ ⎞++ + + + + − ⎜ ⎟⎝ ⎠
 (3.2)
 
3.4 系統參數量測 
 
為了獲得系統之自然頻率，首先利用下層電磁致動器給予雙單擺系統主體一脈衝
輸入，雷射位移感測器量測系統自由振動之位移量，而後將振動位移資訊利用
matlab7.0 進行快速 Fourier 轉換(FFT)，根據模態分析我們可得到系統自然頻率: 系統
第一模態: f1 = 0.85Hz，系統第二模態: f2 = 2.35Hz，其頻譜分析圖如圖 3.12 所示。 
經由量測後可知，上層 target 質量 M1 = 0.28 kg，下層 target 質量 M2 =0.26 kg，上
層鐵條長度 L1 =0.265 m，下層鐵條長度 L2 =0.125 m，而第一組與第二組鐵條的直徑
為 4mm，量測後其重量分別為 0.05kg 與 0.017kg，相對於 target 質量重可忽略，故不
考慮鐵條重量影響。將系統參數代入(3.2)式中可得其理論上之系統自然頻率為: 
1 1
2 2
 5.38 / 0.86
 13.9 / 2.2
rad s f Hz
rad s f Hz
ω
ω
= → =
= → =  
由實際量測與理論推算的結果可知，系統於第一模態的參數準確度較高，系統的
第二模態存在部分誤差，誤差存在原因可能為鐵條重量之影響或擺長部分重心-重心
量測上的不準確所造成。而系統量測後發現仍具有些許摩擦力，將系統的運動方程式
改寫為(3.3)： 
1 2 1 1 1 1 1 1 2 1 1 2 2 2 2
2 2 2 1 1 2 2 2 2 2
( ) ( ) ( ) 0
0
m m l b l m m g m m x m l
m l l x b l m g
θ θ θ θ
θ θ θ θ
⎧ + + + + + + + =⎪⎨ ⎡ ⎤+ + + + =⎪ ⎣ ⎦⎩
  
     (3.3)
利用MATLAB7.0/SIMULINK模擬系統，於加入阻尼項後之系統響應與實際系統
響應加以比較，經過多式試誤後可獲得系統近似之阻尼比分別為  1 0.002ξ = ，
2 0.0003ξ = 。其中 1 1 1 1 2 22 , 2b bξ ω ξ ω= = 。於回授控制中，電磁致動器動要參數示於表
3.4。 
 
圖3.12 頻譜分析圖 
 29
 
圖 3.13 輸入修正法之實驗流程圖 
 
 
3.5.2 頻率響應控制 
 
於第五章中將加入控制手段，拓展系統上層結構至一電磁驅動系統，使其同時具
有長行程與短行程運動的特性。長行程方面為傳輸系統做長距離移動之定位，在本研
究中即為線性馬達；短行程方面為利用電磁致動器控制載體之減振，此時，由傳輸系
統所引發的慣性力即視為外界干擾。 
於實際的應用中，控制器的設計與實現包括感測器與致動器會大幅地增加成本與
系統總重量，或者在空間配置中不允許感測器與致動器的架設，在這些考量下，維持
控制目標: 抑制系統主體的振動，而對長距離移動系統而言，其主要考量對象為系統
末端之振動。故考慮在本研究所建立之雙單擺系統的末端架設一雷射位移感測器量測
其相對馬達移動之位移量，與電磁致動器對系統末端做回授控制，如圖 3.14 所示，
只抑制系統末端振動量，不考慮上層位移與控制，將系統視為單輸入單輸出系統。其
中，輸入為下層控制之電磁鐵輸入電流，而在電磁鐵致動器實現上，將設定同一層之
電磁鐵輸入電流不會同時驅動 target 二側之電磁致動器，根據輸入電流的正負判別驅
動之電磁鐵，當輸入電流為正時，則由正方向之電磁鐵吸引 target 往正方向移動，反
之輸入電流為負時，則由負方向之電磁鐵吸引 target 往負方向移動。  
將系統簡化並整理成單輸入單輸出系統，經 Laplace Transform 可得一四階之轉
移方程式，如式 3.4: 
2
0 1 2
4 3 2
1 2 3 4
( )( )
( )
b s b s aY sG s
U s s a s a s a s a
+ += = + + + +  (3.4)
其中 u(t)系統輸入，y(t)為系統輸出，U(s)與 Y(s)分別為 u(t)與 y(t)經 Laplace Transform
後的形式。 
 
 31
接著設計頻率響應控制，馬達之加速度與減速度視為外界干擾。其實驗流程如圖
3.15，PC 1 經由運動控制卡與驅動器控制馬達運動，PC 2 存取雙單擺末端雷射位移
感測器所讀取之位移資訊，並經由程式撰寫控制器法則，輸出之電壓再經由電壓轉電
流之 power supply 連接電磁鐵，以控制雙單擺末端之振動。 
 
3.5.3 狀態回授控制 
 
於第六章中，將根據雷射位移感測器與系統動態特性建立一狀態估測器，分別利
用全階估測器與最小階估測器來估測系統之狀態，並討論在獲得之狀態充足與否以及
其狀態估測之差別。再利用估測出的狀態設計全狀態回授控制器於電磁鐵上實現，而
因電磁鐵具非線性特性，將分別討論操作點線性化與回饋線性化實現上其振動抑制效
果的差異。其實驗流程圖如圖 3.15 所示，差異為將上層與下層位移回授，設計全狀
態回授控制器，同時控制上層與下層之振動。 
 
3.6 本章結論 
 
於本研究中，考慮長距離移動系統主體為二部分連桿連接或存在第二個模態時系
統主體之運動，並建立一縮小等效雙單擺系統以模擬實際系統運作，考慮在低阻尼情
況下面對傳輸機構運動時之振動情形，並分別利用開迴路與閉迴路控制來抑制系統振
動。於實驗中，以線性馬達模擬傳輸機構，控制目標為在馬達行進過程中，抑制雙單
擺末端之振動。於 3.4 節中，也介紹了三種用來抑制系統振動的方法。在振動抑制上，
可根據在成本或精度的上考量來選擇輸入修正法或閉迴路控制，在第四章，第五章，
第六章中，將分別使用三種方法來抑制系統的振動，在第七章中，將三種振動抑制方
法做一整合性討論，並就其對參數誤差做討論。 
 
 33
4.2 線性輸入修正法設計 
 
首先，訂定長距離行程目標:在最短的時間內到達目標位置，距離為 25cm。故設
計馬達移動的作動行程為 : 在時間 0 秒時，經歷 50ms 加速到 1.8cm/s，維持等速度
運動，最後經歷 50ms 時間減速，其作動行程為圖 4.2，總作動距離為 25cm，其中 50ms
為線性馬達所能加/減速的最短時間。 
系統運動方程式已由式(3.1c)表示，其中 x為馬達作用之加速度，即 x a= ，其輸
入命令為圖 4.3 所示。 
 
4.2.1  Two-pulse ZV 法 
 
首先設計2-pulse ZV法，由第二章可知2-pulse ZV之輸入修正模式為: 
 
 
 
 
圖 4.2 馬達速度切換圖 
 
 
 
圖 4.3 馬達輸入命令 
 35
接著，將馬達的輸入命令與 3 –pulse ZV shaper 做褶積，則可得新的馬達輸入命令，
如圖4.5所示。可知其線性馬達的加速度如式(4.2)所示: 
 1  1  1  1 
 1  1  1  1 
max
 1  1 
1 0   , /3   /3  , 2 /3    2 /3  
 2 /3        2 /3  2   ,            2   1 1 -
 4 /3       4 /3  2         3
0
t T t T T t T
T B t T B T B t T B
a V
T B t T B
others
δ δ δδ
δ δ δ δ
δ δδ
⎧ ≤ ≤ ≤ ≤ + ≤ ≤ +⎪
+ + ≤ ≤ + + + + ≤ ≤ + += ⋅⎨ + + ≤ ≤ + +
⎪⎪
⎪⎪⎪⎩
(4.2)
其中Vmax為馬達之最大速度，δ為加速度作用的時間，B為馬達等速度運動的時間， 1T /3
為懸臂樑結構第一個模態的1/3週期。3-pulse ZV shaper為將原本馬達的加速度大小分
為三等分，首先施予一個 impulse的加速度，在系統第一個模態的1/3週期給予第二個
impulse的加速度，在系統第一個模態的2/3個週期後再給予第三個impulse 的加速度，
每一個impulse的大小皆為原本加速度的1/3。 
 
4.2.3  ZVD 法 
 
接著設計ZVD法，由第二章我們可知ZVD shaper 之輸入修正模式為: 
 
接著，我們將馬達的輸入命令與 ZVD shaper 做褶積，則可得新的馬達輸入命令，如
圖4.6所示。可知其線性馬達的加速度如式(4.3)所示: 
 1  1 
 1 1
 1  1 max
1 1
1 1
1     0    ,    
2     / 2    / 2  
11 -            2   ,  
2
            2        2   2   
2-    3 / 2        3 / 2  2   
0        
t T t T
T t T
T B t T Ba V
T B t T B
T B t T B
othe
δ δδ
δδ
δ δδ
δ δ
δ δδ
≤ ≤ ≤ ≤ +
≤ ≤ +
+ + ≤ ≤ + +=
+ + ≤ ≤ + +
+ + ≤ ≤ + +
rs
⎧⎪⎪⎪⎪⎪⎪⎨⎪⎪⎪⎪⎪⎪⎩
(4.3)
其中 Vmax 為馬達之最大速度，δ為加速度作用的時間，B 為馬達等速度運動的時間，
 1 T 2為懸臂樑結構第一個模態的半週期。ZVD shaper 為將系統輸入分段為 1：2：1，
首先在馬達起始瞬間施予一個 impulse 的加速度，在系統第一個模態的半週期之後
給予第二個 impulse 的加速度，在系統第一個模態的第二個半週期之後再給予第三個
impulse 的加速度。 
 37
 
 
圖4.7 2x3 MIS ZVD shaper command 
 
 
4.3 線性輸入修正法之模擬與實驗結果 
 
    將圖 4.3 的馬達輸入命令，利用 MATLAB 7.0/SIMULINK 模擬，馬達行走總距離
為 25 公分，約經歷 13.8 秒到到達目標位置，其總行程圖如圖 4.8，從圖上可看出在
馬達起動與到達定位後系統有明顯的殘留振動存在，而為了便於觀察系統振動情形，
我們考慮雙單擺系統相對於平台的振動量，如圖 4.9 所示，為利於比較將模擬結果平
移 5mm，可知在未使用輸入修正法的情況下，一開始馬達加速度會使系統產生約 4mm
的振動量，而經由馬達實現後，實驗系統於馬達起動後的第一個振動振幅也約為
4mm。而經過 13.8 秒到達目標位置後，模擬與實驗結果皆有明顯的殘留振動存在，
接下來將利用輸入修正法修正後的馬達輸入命令經由馬達實現，其流程圖如圖 4.10。 
 
0 5 10 15 20
0
5
10
15
20
25
30
time(s)
di
sp
la
ce
m
en
t(c
m
)
 absolute displacement 
 
圖 4.8 系統振動絕對位移圖 
 39
經由MATLAB7.0/ SIMULINK模擬與實驗驗証後結果如圖4.12，因2-pulse ZV法
每一加速大小為修正前的1/2，故其修正後馬達加速/減速造成之overshoot/ undershoot
為未修正前系統振動的50%，在馬達等速的過程中與到達定位後，系統的存在的些
許振動量為系統第二模態所造成，而實驗的結果於模擬有相同的趨勢。 
 
4.3.2 3-pulse ZV法 
 
於4.2.2節經3-pulse ZV shaper修正過後的馬達輸入其輸入型式如圖4.13。將馬達
的加速/減速均分為三段，第一段經歷50 ms加速至0.6cm/s，間隔系統第一模態的1/3
個週期後，再經歷50 ms加速至1.2cm/s，再間隔系統第一模態的1/3個週期後，再經
歷50ms加速到1.8cm/s，接著等速，然後減速分成三段，第一段經歷50 ms減速至
1.2cm/s，間隔系統第一模態的1/3個週期後，再經歷50 ms減速至0.6cm/s，再間隔系
統第一模態的1/3個週期後，再經歷50ms減速到0cm/s，總行距為25cm。 
 
 
0 2 4 6 8 10 12 14 16
-4
-2
0
2
4
6
8
10
time(s)
di
sp
la
ce
m
en
t(m
m
)
2-pulse ZV
 
 
simulation
experiment
 
圖 4.12 系統經 2-pulse ZV 法後之模擬與實驗結果 
 
 
圖4.13 經3-pulse ZV shaper後的馬達輸入命令 
 41
0 2 4 6 8 10 12 14 16
-1.5
-1
-0.5
0
0.5
1
1.5
2
2.5
3
3.5
time(s)
di
sp
la
ce
m
en
t(m
m
)
ZVD
 
 
simulation
experiment
 
圖4.16 系統經ZVD法後之模擬與實驗結果 
 
 
 
圖4.17 經2x3 MIS ZVD shaper後的馬達輸入命令 
 
 
經由MATLAB7.0/ SIMULINK模擬與實驗驗証後，結果如圖4.16，ZVD法起始加
速大小為修正前的1/4，故修正後馬達加速/減速造成之overshoot/ undershoot約為未修
正前系統振動的20%，在馬達等速的過程中與到達定位後，系統的存在的些許振動量
為系統第二模態所造成，而實驗的結果於模擬有相同的趨勢。 
 
4.3.4 2x3 MIS ZVD 法 
 
於4.2.4節經2x3 MIS ZVD shaper修正過後的馬達輸入其輸入型式如圖4.17。將馬
達的加速/減速均分為六段，其加速/減速間隔依序為分別為系統第一模態的1/3，1/2，
2/3，5/6，與7/6，接著維持等速，然後減速，總行距為25cm。 
經由MATLAB7.0/ SIMULINK模擬與實驗驗証後，結果如圖4.18，2x3 MIS ZVD
法每一加速大小為修正前的1/6，故修正後馬達加速/減速造成之overshoot/ undershootx
約為未修正前系統振動的17%，在馬達等速的過程中與到達定位後，系統的存在的些
許振動量為系統第二模態所造成，而實驗的結果於模擬有相同的趨勢。 
 43
圖 4.19 與圖 4.20 分別為 2 pulse ZV 法與 3-pulse ZV 法對週期變異的敏感度曲線，
模軸為變異的系統週期 T*比上準確的系統週期 T，考慮其週期變異為 0.6~1.4 之間，
在 overshoot 的抑制上，2 pulse ZV 與 3 pulse ZV 在週期比例小時，overshoot 與殘留
振動的抑制效果皆較差，而週期比例大於 1 之後， overshoot 的振幅比例固定為修正
前的 50% 與 33%，符合輸入修正後之脈衝輸入所抑制之 overshoot 大小，而殘留振
動對於週期變異皆有明顯的變化，2- pulse ZV 法最大為 60%，而 3-pulse ZV 法最大
為 53%。 
圖 4.21 與圖 4.22 分別為 ZVD 與 2x3 MIS ZVD 法對週期變異的敏感度曲線，模
軸為變異的系統週期 T*比上準確的系統週期 T，在比例為 1 時，其 overshoot 與殘留
振動皆為最小，在參數變異小，其 overshoot 最大分別為 50% 與 41%。 
 
 
0.6 0.7 0.8 0.9 1 1.1 1.2 1.3 1.4
0
10
20
30
40
50
60
70
T*/T 
pe
rc
en
ta
ge
(%
)
2-pulse ZV period T sensitivity curve
 
 
x
2
 overshoot
x
2
 residue vibration
 
 
圖 4.19 2 pulse ZV 法週期變異之敏感度曲線 
 
0.6 0.7 0.8 0.9 1 1.1 1.2 1.3 1.4
0
10
20
30
40
50
60
70
T*/T 
pe
rc
en
ta
ge
(%
)
3-pulse ZV period T sensitivity curve
 
 
x
2
 overshoot
x
2
 residue vibration
 
 
圖 4.20 3 pulse ZV 法週期變異之敏感度曲線 
 45
0.6 0.7 0.8 0.9 1 1.1 1.2 1.3 1.4
0
10
20
30
40
50
60
70
T*/T 
p
er
ce
n
ta
g
e(
%
)
simulation
 
 
2-pulse ZV
3-pulse ZV
ZVD
2x3 MIS ZVD
 
 
圖 4.23 輸入修正法對頻率變異之強健性模擬比較 
 
 
0.6 0.7 0.8 0.9 1 1.1 1.2 1.3 1.4
0
10
20
30
40
50
60
70
T*/T 
p
er
ce
n
ta
g
e(
%
)
experiment
 
 
2-pulse ZV
3-pulse ZV
ZVD
2x3 MIS ZVD
 
 
圖 4.24 輸入修正法對頻率變異之強健性實驗比較 
 
 
4.5  實驗結果討論 
 
於本章中，依據系統特性設計輸入修正法以抑制長距離移動系統於運作過程中之
殘留振動。於本研究所建立的縮小模型中，根據系統自然頻率與線性馬達的限制，並
 47
 
第五章 頻率響應控制與實驗 
5.1 本章介紹 
 
於本章中將加入控制手段，拓展系統上層結構至一電磁驅動系統，維持控制目標
為:線性馬達於最短的時間內到達目標位置，且在馬達行進過程中，降低系統殘留振
動。使系統具有長行程與短行程運動的特性:長行程方面為傳輸系統做長距離移動之
定位，在本研究中即為線性馬達；短行程方面為利用電磁致動器控制載體之減振，此
時，由傳輸系統所引發的慣性力即視為外界干擾。 
在實際的應用中，控制器包括感測器與致動器的設計與實現，會大幅地增加成本
與系統總重量，或者在空間配置中不允許感測器與致動器的架設，對天車系統而言，
上層的掛勾處致動器架設不易，一般的設計例如在負載處設置水平移動的致動器，利
用懸掛點與負載重心的配置來達到減振的目的[51]，或對 wafer stepper 而言，其在意
的為 wafer 振動情形，在這些考量下，維持控制目標，在雙單擺系統的末端架設一雷
射位移感測器量測其相對馬達移動之位移量，與電磁致動器對系統末端做回授控制，
系統輸入為電磁鐵輸入電流，試著將系統簡化並整理成單輸入單輸出的形式，在簡化
後可得一四階之轉移方程式，在此將利用操作點線性化簡化電磁鐵非線性特性，系統
輸出為雙單擺末端的振動量，並設計數位頻率響應控制器，馬達之加速度與減速度視
為外界干擾。只考慮系統末端的振動量，利用一組電磁制動器進行回授控制，並討論
選擇的參數。5.2 節為加操作點線性化後之系統動態，5.3 節為頻率響應控制器的設
計，5.4 節為控制器實現之模擬分析與實驗驗証，5.5 節為實驗結果討論，5.6 為本章
結論。圖 5.1 為本章架構。 
 
5.1
5.2
5.3 
5.5
5.4
5.6
 
圖 5.1 本章架構
 49
1 2
1 2 1 1 1 1 1 2 2 2 1
1
2 2 2 2 3 1 4 2 1 2 2 2
( )( ) ( ) ( - ) 0
( - ) -
m m gm m x b x x m m x m x x
l
m x b x k x k x x B I m x
+⎧ + + + + + + =⎪⎨⎪ + + + =⎩
    
  
(5.5)
將 x視為外界突然出現的干擾，並將式(5.5)重新整理成轉移方程形式，可得: 
2 1 2
2 1 2
12
2 2 22 1 2
2 1 4 1 2 2 2 3 4
1
( )
( )( )
( ) ( ) ( - )
m mB m s b s g
lX sG s
I s m mm s b s k m s b s g m s b s k k
l
⎡ ⎤++ +⎢ ⎥⎣ ⎦= = ⎡ ⎤+⎡ ⎤+ + + + + +⎢ ⎥⎣ ⎦ ⎣ ⎦
 
將 3.3 節系統參數與表 3.4 代入後，可得: 
2 -5
2
4 3 2
2
( )   0.0006828   1.147 10    0.04815
( ) 0.07325  0.006976   16.12   0.4375   405.4
X s s s
I s s s s s
+ × += + + + + (5.6)
系統之 Bode diagram 如圖 5.2 所示，由圖上可知，系統之第一模態與第二模態相
當接近，這將使系統受到外界刺激時，容易激發二個模態的出現，使得系統行為變得
更加複雜，也增加了控制的困難度。於 5rad/s 處系統的相位邊限為 0゜，加入比例控
制器後無法改善系統之暫態性能，而系統為 type 0 system，其穩能響應性能不佳。接
下來，將利用控制的手段改善系統響應，於頻率響應下，逐步改善其性能。 
 
 
-140
-120
-100
-80
-60
-40
-20
M
ag
ni
tu
de
 (
dB
)
10
0
10
1
10
2
-180
-135
-90
-45
0
P
ha
se
 (
de
g)
Bode Diagram
Frequency  (rad/sec)  
 
圖 5.2 系統 Bode diagram 
 
 51
-140
-120
-100
-80
-60
-40
-20
M
ag
ni
tu
de
 (
dB
)
10
0
10
1
10
2
135
180
225
270
315
360
P
ha
se
 (
de
g)
Bode Diagram
Frequency  (rad/sec)  
圖 5.4 系統於 w domain 之 Bode diagram 
 
 
-200
-150
-100
-50
M
ag
ni
tu
de
 (
dB
)
10
0
10
1
10
2
10
3
10
4
90
180
270
360
P
ha
se
 (
de
g)
Bode Diagram
Frequency  (rad/sec)  
圖 5.5 系統於 w- domain 加入 notch filter 之 bode diagram 
 
 53
-200
-150
-100
-50
M
ag
ni
tu
de
 (
dB
)
10
-1
10
0
10
1
10
2
10
3
10
4
90
180
270
360
450
P
ha
se
 (
de
g)
 
 
Bode Diagram
Frequency  (rad/sec)
ω=10
ω=20
ω=5
 
圖 5.6 系統於 w domain 加入 notch filter 與相位領先控制器之 Bode diagram 
 
   
-200
-150
-100
-50
M
ag
ni
tu
de
 (
dB
)
10
-2
10
-1
10
0
10
1
10
2
10
3
10
4
90
180
270
360
450
P
ha
se
 (
de
g)
 
 
Bode Diagram
Frequency  (rad/sec)
p=-1
p=-3
p=-0.1
 
 
圖 5.7 系統於 w domain 加入 notch filter 與相位領先-落後控制器之 bode diagram 
 
 55
1
Out1
 -1
Z   
Integer Delay1
 -1
Z   
Integer Delay
0.177253
Gain4
-0.219688
Gain3
1.219688
Gain2
0.8198
Gain1
-1.784
Gain
1
In1
 
 
圖 5.9 notch filter 實現圖 
 
1
Out1
 -1
Z   
Integer Delay1
 -1
Z   
Integer Delay
0.045193
Gain4
-0.04596
Gain3
1.04596
Gain2
0.9465
Gain1
-1.946
Gain
1
In1
 
 
圖 5.10 phase lead-lag controller 實現圖 
 
x2
x1
-K-
total gain
In1 Out1
phase lead_lag controller 
In1 Out1
notch filter 
Out1
motor input
In1
x2
Out1
electromagnets
motor 
electromagnet
x1
x2
douple pendulun
Zero-Order
Hold1
0
Constant3
 
圖 5.11 系統閉迴路控制之 matlab7.0/simulink 等效模型 
controller 
 57
0 5 10 15 20
-5
-4
-3
-2
-1
0
1
2
3
4
5
time(s)
di
sp
la
ce
m
en
t(m
m
)
 
 
without roll off filter
with roll off filter
 
圖 5.14 系統加入了 roll – off  filter 之控制模擬結果 
 
 
 
圖 5.15 控制流程圖 
 
 
接下來，將設計好的控制器於第三章所介紹之實驗系統上實現，圖 5.15 為控制
之流程圖。PC 2 存取雙單擺末端雷射位移感測器所讀取之位移資訊，並經由程式撰
寫所設計之頻率響應控制器法則，輸出之電壓再經由電壓轉電流之電源供應器連接電
磁鐵，以控制雙單擺末端之振動，PC 1 經由運動控制卡與驅動器控制線性馬達運動。 
 59
 
-4
-2
0
2
4
6
8
0 5 10 15 20 25
time(s)
di
sp
la
ce
m
en
t(m
m
)
x1
x2
 
 
圖 5.18 包含 notch filter，phase lead-lag control 與 roll - off filter 之控制器實驗結果 
 
 
-0.25
-0.2
-0.15
-0.1
-0.05
0
0.05
0.1
0.15
0.2
0.25
0 5 10 15 20 25
cu
rr
en
t (
A
)
notch+lead lag controller
notch+lead lag controller+roll off filter
 
 
圖 5.19 控制輸出電流 
 
 
將其控制輸出電流加以比較，如圖 5.19，在實際的應用中因高頻雜訊的存在，使
得在等速時未加 roll - off filter 之控制輸出電流仍有 0.1A，而在加了 roll - off filter，能
夠有效的抑制高頻雜訊進入，也使得在實驗中，能夠提高控制之總增值，改善其振動
抑制能力。 
 61
 
第六章 全狀態回授控制 
 
6.1 本章介紹 
 
於第五章中，在只考慮系統末端之振動量情況下，將系統整理為 SISO 並利用頻
率響應控制器加以控制，由其模擬結果可知，上層結構之振動情形影響著系統末端之
殘留振動的存在。故於本章中，將同時考慮系統上層與下層之振動量與速度，利用全
狀態回授控制於電磁鐵上實現來抑制雙單擺系統末端的振動量。而於回授控制致動器
中，電磁鐵為非線性之致動器，通常利用操作點線性化來簡化其特性方程式，但在實
現上，其非線性特性並無法利用操作點線性化而忽略，故也將利用回饋線性化設計全
狀態回授控制器以抑制系統振動。而因可經由量測獲得的狀態有限，將分別設計 full 
order observer 與 minimum order observer，並討論其設計結果。接著，將估測出來的
狀態設計一全狀態回授控制器，以模擬與實驗討論其振動抑制結果。圖 6.1 為本章架
構。 
 
 
 
 
圖 6.1 本章架構 
 63
令 ( ) 2 21 1 2 2 1 11 1 1 1 2 01 023 3 2
1 01 02 01
1 2 2 2- -  , , ,
R C i C i C ik m g B C C G G
l G G G
+= = = =  
2 22 2
3  3 3  3 3  34  4 2 4  4
3 4 2 3 4 03 043 3 3 3 2
03 04 2 03 04 03
2 2 22 2- - ,    - -  , , ,
( ) ( ) ( ) ( )
C i C i C iC i m C ik k g B C C G G
G G l G G G
⎡ ⎤= = = = =⎢ ⎥⎣ ⎦
 
代入(6.3) 後整理後可得: 
1 2 1 1 1 1 1 1 1 1 2 2 2 1 1 1 2
2 2 2 2 2 2 2 1 1 3 1 1 4 2 2 2 3 2
( ) ( )
-
m m l b l k l m l B i m m x
m l b l m l k l k l B i m x
θ θ θ θ
θ θ θ θ θ
⎧ + + + + = − +⎪⎨⎪ + + + + =⎩
       
        
(6.4)
為了在實現上以及理解上較容易，將系統變數改成位移並重新整理後，如式(6.5)
所示: 
1 2
1 2 1 1 1 1 1 2 2 2 1 1 1
1
2 2 2 2 3 1 4 2 1 2 2 2
( )( ) ( ) ( - )
( - ) -
m m gm m x b x x m m x m x x B I
l
m x b x k x k x x B I m x
+⎧ + + + + + + =⎪⎨⎪ + + + =⎩
    
  
(6.5)
將(6.5)式整理成狀態空間方程式， 
31 4 1 2
1 1 1 2 1 2 4 2
1 1 1 1 2 1 2
2
2
              0                       1                 0              0
( - ) ( )
-   -   
             0                       0            
KK K b b
x L L L L L K b
x m m m L m L
x
x
+ +⎡ ⎤⎢ ⎥ × ×⎢ ⎥ =⎢ ⎥⎢ ⎥⎣ ⎦




[ ]
1
1
2
3 4 2
1 2 2 4 2
2 2 2 2 2 2 2
1
11 1
2
1
     0             1
( - )
-           -  -
 0       0
0 2 -
1
0 0     0
1 2 0    
x
x
x
K K x
L L b K b
m m L m L m L
B B
Im m
x
I
B
m
⎡ ⎤⎢ ⎥⎢ ⎥ ⎡ ⎤⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎣ ⎦⎢ ⎥⎢ ⎥⎢ ⎥× × ×⎣ ⎦
⎡ ⎤⎢ ⎥⎡ ⎤ ⎢ ⎥⎢ ⎥− ⎢ ⎥ ⎡ ⎤⎢ ⎥+ + ⎢ ⎥ ⎢⎢ ⎥ ⎣⎢ ⎥⎢ ⎥ ⎢ ⎥−⎣ ⎦ ⎢ ⎥⎣ ⎦


 ⎥⎦
(6.6.a)
1
1
2
2
1 0 0 0
0 0 1 0
x
x
y
x
x
⎡ ⎤⎢ ⎥⎡ ⎤ ⎢ ⎥= ⎢ ⎥ ⎢ ⎥⎣ ⎦ ⎢ ⎥⎣ ⎦


 (6.6.b)
其中(6.6.a)為狀態方程式，(6.6.b)為輸出方程式。 
 
6.3 電磁鐵操作點線性化之估測器設計 
 
受限於系統空間架設問題，故無法完全經由感測器量測而獲得系統速度狀態，接
下來，將分別設計全階狀態估測器與最小階狀態估測器，並討論利用單獨使用下層位
移進行狀態估測，與利用上層與下層位移進行狀態估測的情況下，其估測之誤差情形。  
 65
令系統的觀察性矩陣(observability matrix)為: 
2
3
C
CG
O
CG
CG
⎡ ⎤⎢ ⎥⎢ ⎥= ⎢ ⎥⎢ ⎥⎢ ⎥⎣ ⎦
 (6.9)
將(6.8.a) 與(6.8.b)中相對應之 G 與 C 矩陣代入後，系統的觀察性矩陣 O 之 rank
為: 
( ) 4rank O =  (6.10)
由式(6.10)可知，系統在獲得 2x 位移狀態的情況下，為完全狀態可觀察之系統，
故可對系統設計一狀態估測器來獲得系統之狀態資訊。設計全階估測器之誤差收斂特
性根於時域中之條件為: 
1 1 2 10.7,    2 ,   10n n nς ω ω ω ω= = =  (6.11)
其中ς 為設計後系統的 damping ratio， 1nω 與 2nω 分別為設計後系統的主頻率與次頻
率， 1w 為系統原本的主頻率，圖 6.3 為主極點設置示意圖。 
則在離散空間所選擇之特性根為: 
1 1
1 1
2 2
2 2
2 2
1 1 1
2 2
2 1 1
2 2
3 2 2
2
4 2
cos( 1 ) sin( 1 )
cos( 1 ) sin( 1 )
cos( 1 ) sin( 1 )
cos( 1 ) sin
n s n s
n s n s
n s n s
n s n s
w T w T
n s n s
w T w T
n s n s
w T w T
n s n s
w T w T
n s
z e w T ie w T
z e w T ie w T
z e w T ie w T
z e w T ie
ς ς
ς ς
ς ς
ς ς
ς ς
ς ς
ς ς
ς
− −
− −
− −
− −
= × × − + × × −
= × × − − × × −
= × × − + × × −
= × × − − × 22( 1 )n sw T ς× −
  (6.12)
 
 
-80 -60 -40 -20 0
-80
-60
-40
-20
0
20
40
60
80
Pole-Zero Map
Real Axis
Im
ag
in
ar
y 
A
xi
s
 
 
圖 6.3 主極點設置之示意圖 
 67
[x2]
-50
-40
-30
-20
-10
0
10
20
30
40
50
60
0 5 10 15 20
time(s)
er
ro
r p
er
ce
nt
ag
e 
(%
)
error x1
error x2
 
圖 6.6 利用[ x2] 設計全階狀態估測器之參數妥協實驗結果 
 
 
接著，利用 1x 與 2x 來估測系統狀態。由式(6.8.a)與式(6.8.b)可知系統之狀態方程
式為: 
  0.9997    0.0020    0.0001    0.0000
 -0.2830    0.9994    0.1420    0.0004
x(k+1) x(k)
  0.0002    0.0000    0.9998    0.0020
  0.1569    0.0005   -0.1569    0.9995
-0.000
-0.002
-0.000
-0.002
⎡ ⎤⎢ ⎥⎢ ⎥= ⎢ ⎥⎢ ⎥⎣ ⎦
+ 14
2
 0.0001   -0.0002
( ) 0.0984   -0.1687
10
0.0000    0.0002 ( )
 0.0000    0.1864
I k
x
I k
−
⎡ ⎤ ⎡ ⎤⎢ ⎥ ⎢ ⎥ ⎡ ⎤⎢ ⎥ ⎢ ⎥+ ⎢ ⎥⎢ ⎥ ⎢ ⎥ ⎣ ⎦⎢ ⎥ ⎢ ⎥⎣ ⎦ ⎣ ⎦

1 2G ( ) H H ( )x k x I k= + +  
(6.14.a)
1 0 0 0
y(k) x(k) x(k)
0 0 1 0
C⎡ ⎤= =⎢ ⎥⎣ ⎦  (6.14.b)
令系統的觀察性矩陣(observability matrix)為: 
2
3
C
CG
O
CG
CG
⎡ ⎤⎢ ⎥⎢ ⎥= ⎢ ⎥⎢ ⎥⎢ ⎥⎣ ⎦
 
將(6.14.a) 與(6.14.b)中相對應之 A 與 C 矩陣代入後，系統的觀察性矩陣 O 之 rank
為: 
 69
full order observer with [x1 x2]
-0.3
-0.25
-0.2
-0.15
-0.1
-0.05
0
0.05
0.1
0.15
0 0.1 0.2 0.3 0.4 0.5
time(s)
er
ro
r p
er
ce
nt
ag
e(
%
)
error x1
error x2
 
圖 6.8 利用[x1 x2]’ 設計全階狀態估測器之實驗結果 
 
 
minimum order observer [x2]
-6
-4
-2
0
2
4
6
8
10
12
14
16
0 5 10 15 20
time(s)
di
sp
la
ce
m
en
t (
m
m
)
observer x1
measure x1
measure x2
 
圖 6.9 利用[x2]設計最小階狀態估測器之實驗結果 
 
 
6.3.2 最小階狀態估測器 
 
於第二章介紹了最小階狀態估測器之設計方法，而在本實驗中，可經由雷射位移
感測器來獲得系統之位移狀態，須估測之狀態為雙單擺系統上層與下層之速度狀態。 
首先考慮只獲得 2 ( )x k 的情況下，則所須估測之狀態為: 1( )x k ， 1( )v k 與 2 ( )v k ，實
際上可由架設之上層雷射位移感測器來觀察其狀態估測 1( )x k 之誤差。設計全階估測
器之誤差收斂特性根於離散空間所選擇之特性根為:  
p=[0.986+0.014i;  0.986-0.014i; 0.86] .  
最小階離散狀態估測器實驗結果如圖 6.9，由圖上可知，利用 2x 所設計之最小階
狀態估測所估測出之上層位移 1x 與利用雷射位移感測器所獲得之狀態，其趨勢大致符
合，但由估測器所估測出之狀態有明顯的突波與雜訊存在，這在實際的應用上非常的
不利，在加入控制器之後，其突波會使得致動器施力不連續，造成系統不穩定。 
 71
 
 
圖 6.11 全狀態回授控制器流程圖 
 
 
6.4 電磁鐵操作點線性化之全狀態回授控制器設計 
 
利用全狀態回授控制器的設計電磁鐵的輸入電流，其實現流程圖如圖 6.11 所示。
由式(6.8.a)系統之狀態方程式中可知， x為馬達之加速度，在控制策略中，馬達之加/
減速為外界干擾，故先不考慮外界干擾的存在，將(6.8.a)式改寫為: 
4
  0.9997    0.0020    0.0001    0.0000  0.0001   -0.0002
 -0.2830    0.9994    0.1420    0.0004  0.
x(k+1) x(k) 10
  0.0002    0.0000    0.9998    0.0020
  0.1569    0.0005   -0.1569    0.9995
−
⎡ ⎤⎢ ⎥⎢ ⎥= +⎢ ⎥⎢ ⎥⎣ ⎦
1
2
( )0984   -0.1687
0.0000    0.0002 ( )
 0.0000    0.1864
I k
I k
⎡ ⎤⎢ ⎥ ⎡ ⎤⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎣ ⎦⎢ ⎥⎣ ⎦
 
[ ]( ) ( )Gx k H I k= +                                       (6.14.a) 
 輸出方程式為: 
1 1
1 1
2 2
2 2
x x
x x1 0 0 0
y
0 0 1 0 x x
x x
C
⎡ ⎤ ⎡ ⎤⎢ ⎥ ⎢ ⎥⎡ ⎤ ⎢ ⎥ ⎢ ⎥= =⎢ ⎥ ⎢ ⎥ ⎢ ⎥⎣ ⎦ ⎢ ⎥ ⎢ ⎥⎣ ⎦ ⎣ ⎦
 
 
                              (6.14.b) 
 系統的控制性矩陣(observability matrix)為: 
2 3C H GH G H G H⎡ ⎤= ⎣ ⎦  
將(6.14.a)中相對應之 G 與 H 矩陣代入後，系統的控制性矩陣 C 之 rank 為: 
( ) 4rank C =                                            (6.15) 
由式(6.15)可知，系統為完全狀態可控制之系統，故可對系統設計一全狀態回授
控制器來控制系統之狀態。而因未控制前之系統為低阻尼，且由自然頻道可知系統剛
性很低，故控制器選擇上希望能增加系統阻尼與剛性，設計控制增益值並選用與估測
器於時域相同的設計條件: 
n1 1 n2 n1=0.7,   =2 ,  =10ς ω ω ω ω  
於離散空間中之特性根為: 
 73
operation linearization
-2
-1
0
1
2
3
4
5
0 5 10 15
time(s)
di
sp
la
ce
m
en
t(m
m
)
measure x1
measure x2
 
 
圖 6.13 操作點線性化之實驗結果 
 
 
6.6 電磁鐵回饋線性化之估測器與控制器設計 
 
因電磁鐵之致動力為非線性，利用操作點線性化並無法精準地表現其作用特性，
若電磁致動器之模型可精確地掌握，經由位移回饋，並取得控制器輸入，則可得到準
確之電磁鐵輸入電流。故接下來，將利用回饋線性來減少其非線性特性的影響，回饋
線性化主要是利用狀態回授來計算當下該輸入之電流，而非如操作點線性將其狀態固
定，並減化為一階的輸入電流。將 (6.8) 式改寫為: 
31 4 1 2
1 1 1 2 1 2 4 2
1 1 1 1 2 1 2
2
2
              0                       1                 0              0
KK K b b( - + ) ( + )x L L L L L K b-  -      
x m m m L m L
x              0                        0         
x
⎡ ⎤⎢ ⎥ × ×⎢ ⎥ =⎢ ⎥⎢ ⎥⎣ ⎦




1
1
1
2
2
3 4 2
1 2 2 4 2
2 2 2 2 2 2 2
x   0     0     0
x   -1    1    -1
        0             1 x    0  0     0
K   -1    0     1K x( - )
L L b K b-             -   -
m m L m L m L
x
F
F
⎡ ⎤⎢ ⎥⎢ ⎥ ⎡ ⎤ ⎡ ⎤⎢ ⎥ ⎡⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥ ⎢ ⎥⎢ ⎥ +⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎣⎣ ⎦⎣ ⎦⎢ ⎥⎢ ⎥⎢ ⎥× × ×⎣ ⎦


⎤⎢ ⎥⎢ ⎥⎢ ⎥⎦
   
1
1 1
2 2
2
x
x x1 0 0 0
x 0 0 1 0 x
x
⎡ ⎤⎢ ⎥⎡ ⎤ ⎡ ⎤ ⎢ ⎥=⎢ ⎥ ⎢ ⎥ ⎢ ⎥⎣ ⎦⎣ ⎦ ⎢ ⎥⎣ ⎦


                                      (6.17) 
其中 1F 為上層電磁鐵所施之致動力， 2F 為下層電磁鐵所施之致動力，將系統參數代
入並轉至離散空間可得: 
 75
1/ 22
2 2 2
2
2
( )oG x Fi
C
⎛ ⎞−= ⎜ ⎟⎝ ⎠
                                          (6.20b) 
其中 2x 為經由下層雷射位移感測器所量測到之立即的位移資訊。 
 
6.7 電磁鐵回饋線性化之模擬分析與實驗驗証 
 
將計算過後之電磁鐵回饋線性化結果代入 MATLAB7.0/SIMULINK 模擬，其結
果如圖 6.14 所示，圖中為系統下層位移量，實驗結果如圖 6.15 所示，電磁鐵回饋線
性化已將電磁鐵輸入非線性特性消除，故系統有良好的響應行為。 
 
 
0 5 10 15 20
-1
-0.8
-0.6
-0.4
-0.2
0
0.2
0.4
0.6
0.8
1
time(s)
di
sp
la
ce
m
en
t(m
m
)
motor Vmax=1.8cm/s, ζ=0.7, ωn1=2w1, ωn2=10ωn1
 
 
with feedback linearization
 
圖 6.14 電磁鐵回饋線性化之模擬結果 
 
feedback linearization
-2
-1
0
1
2
3
4
5
0 5 10 15
time(s)
di
sp
la
ce
m
en
t(m
m
)
measure x1
measure x2
 
 
圖 6.15 電磁鐵回饋線性化之實驗結果 
 
 77
 
第七章  研究結果討論 
 
7.1 本章介紹 
 
本研究建立了一縮小模型以模擬長距離移動系統於傳輸的過程中振動情形，分別
利用輸入修正法與回授控制來抑制其殘留振動，控制目標為：快速到達目標位置，且
降低系統殘留振動。於第三章中，設計了一雙單擺系統以模擬實際之具有雙自由度的
長距離移動系統，於第四章與第六章中，利用模擬分析與實驗驗証其振動抑制的效
果。但實際的應用中，通常無法準確的獲得系統參數，而控制器面對存在參數變異情
況下，能否仍有效地抑制系統振動為控制器設計之重要課題。故在本章節中，將探討
輸入修正法與回授控制對參數變異之靈敏度曲線比較，包含了上層掛勾之質量 1m ，
下層負載質量 2m ，上層擺長 1L 與下層擺長 2L 。而輸入修正法與回授控制既然皆可抑
制系統振動，但其能抑制之 overshoot 與穩定時間都不一樣，所需的能量也不同，本
章也將分別從 overshoot，穩定時間及能量三個角度切入，探討其優缺。圖 7.1 為本章
架構。 
 
 
 
 
圖 7.1 本章架構       
 
 
 79
六章中，考慮系統上層與下層之振動量與速度，利用全狀態回授控制於電磁鐵上實現
來抑制雙單擺系統末端的振動量。而受限於系統空間架設問題，無法完全經由感測器
量測而獲得系統速度狀態，分別設計了全階狀態估測器與最小狀態階估測器，且於狀
態可觀察下，討論所獲得狀態的充裕程度與其估測狀態的誤差程度，由模擬與實驗結
果可知，可利用感測器獲得的狀態愈多，其所估測的狀態前準確，能夠快速衰退至 0。 
最後，設計一全狀態回授控制器，利用全階狀態估測器所估測出的系統狀態，抑
制系統於馬達干擾下之振動。於本研究所建立之縮小模型中，分別利用操作點線性化
與回饋線性化以簡化電磁致動器非線性特性以設計全階狀態估測器與全狀態回授控
制器，由模擬與實驗結果可知，因電磁致動器為強非線性之系統，利用操作點線性化
並無法完整的表現其特性，造成線性化後之結果與實際非線性系統於殘留振動抑制上
有明顯差異。而回饋線性化移除了電磁致動器之非線性特性，故於回授控制上有良好
的響應結果，且其振動抑制效果相較於操作點線性化有明顯的改善。 
由模擬與實驗結果可知，全狀態回授控制於回饋線性化情況下，相較於章頻率響
應控制，具有較佳之振動抑制能力，於控制過程中，上層結構之振動與下層振動無相
互影響的情形存在，且能夠有效抑制 overshoot，將殘留振動快速抑制為 0。 
 
7.4 參數敏感度比較 
 
對於實際之天車系統，常因下層負載之不同，選用不同強度之掛勾，不同強度之
掛勾其質量也不同，而移動過程中因障礙物的存在，會改變纜繩之擺長以順利傳輸作
動；對於 wafer stepper 而言，量測質量或系統剛性時可能會有誤差的存在。於此節中，
將討論輸入修正法與回授控制對參數變異之敏感度。固定於第四章中所設計之輸入修
正 shaper 之大小與時間，也固定於第六章中設計之全狀態回授控制之參數，改變系統
本身之參數: 1m ， 2m ， 1L 與 2L ，利用 MATLAB7.0/SIMULINK 模擬，討論其對雙單
擺系統末端位移 2x 的 overshoot 與殘留振動抑制程度，令敏感度曲線之橫軸為變異之
質量或長度比上輸入修正法/全狀態回授控制設計所採用之質量或長度，縱軸為其
overshoot percentage 或 residue vibration percentage。定義: 
  / (%) 100%
  /
   /  (%)
   /
overshoot under control shapingovershoot percentage
overshoot without control shaping
residue vibration under control shapingresidue vibration percentage
residue vibration without control s
= ×
= 100%
haping
×
 
7.4.1 下層掛勾質量 2m 之敏感度比較 
 
首先討論當下層負載不同時質量 2m 變化之敏感度，對天車系統而言，為下端負
載變異，對wafer stepper而言為wafer質量變異，圖7.2與圖7.3為對馬達加速時造成之
overshoot與系統殘留振動之敏感度曲線，橫軸為變異之質量 2 *m 比上輸入修正法/全
狀態回授控制設計所採用之質量 2m 。由圖7.2可看出，ZVD在面對 2m 變異時overshoot
變化最明顯，2x3 MIS ZVD法為變化最不明顯之曲線，而四種輸入修正法在面對 2m 變
異的情況下，overshoot皆隨著變異量增加而變小，全回授控制對系統參數 2m 變化之
敏感度範圍約為2%。圖7.3為輸入修正法面對上層掛勾質量 2m 變異時其殘留振動變化
 81
0.6 0.7 0.8 0.9 1 1.1 1.2 1.3 1.4
20
25
30
35
40
45
50
55
m
1
*/m
1
 
pe
rc
en
ta
ge
(%
)
x2 overshoot
 
 
2 pulse ZV
3 pulse ZV
ZVD
2x3 MIS ZVD
state feedback cotnrol
 
圖7.4 對上層掛勾質量 1m 變異之overshoot敏感度曲線 
 
0.6 0.7 0.8 0.9 1 1.1 1.2 1.3 1.4
0
1
2
3
4
5
6
7
8
9
m
1
*/m
1
 
pe
rc
en
ta
ge
(%
)
x
2
 residue vibraton
 
 
2 pulse ZV
3 pulse ZV
ZVD
2x3 MIS ZVD
 
圖7.5 對上層掛勾質量 1m 變異之residue vibration敏感度曲線  
 
 
7.4.3 上層擺長 1L 之敏感度比較 
 
對天車系統而言，移動過程中因障礙物的存在，常會改變纜繩之擺長以順利傳輸
作動，而對wafer steeper而言，可能為系統剛性估測不準確，故接著討論對上層擺長 1L
變化之敏感度，圖7.6與圖7.7為對馬達加速時造成之overshoot與系統殘留振動之敏感
度曲線，橫軸為變異之擺長 1 *L 比上輸入修正法/全狀態回授控制設計所採用之擺長
1L 。由圖7.6可看出，2 pulse ZV與3 pulse ZV為圖中變化最明顯之曲線，四種輸入修
正法在面對 2m 變異的情況下，overshoot皆隨著變異量增加而變大，回授控制對系統
參數 1L 變化之敏感度約為4%，為最小。圖7.7為輸入修正法面對上層擺長 1L 變異時其
殘留振動變化情形，呈現一對稱趨勢，於參數準確之情況下，殘留振動為最小，回授
控制於將系統殘留振動完全抑制至0。 
 83
0.6 0.7 0.8 0.9 1 1.1 1.2 1.3 1.4
15
20
25
30
35
40
45
50
55
L
2
*/L
2
 
pe
rc
en
ta
ge
(%
)
x
2
 overshoot
 
 
2 pulse ZV
3 pulse ZV
ZVD
2x3 MIS ZVD
state feedback cotnrol
 
圖7.8 對下層擺長 2L 變異之overshoot敏感度曲線 
 
0.6 0.7 0.8 0.9 1 1.1 1.2 1.3 1.4
0
2
4
6
8
10
12
14
L
2
*/L
2
 
pe
rc
en
ta
ge
(%
)
x
2
 residue vibraton
 
 
2 pulse ZV
3 pulse ZV
ZVD
2x3 MIS ZVD
 
圖7.9 對下層擺長 2L 變異之residue vibration敏感度曲線 
 
 
7.4.5 敏感度綜合討論 
 
由以上的討論結果可知，對於輸入修正法而言，在面對擺長變化時敏感度曲線變
化較質量變化時明顯，而於 1L 變異時，2 pulse ZV 法變化範圍 11%為最大，而於質量
變異時，2 pulse ZV 變化皆約為 4%， 
對全狀態回授而言，其變化最大為於上層擺長 1L 變化時，約為 4%，其次為下層
負載質量變化時，為 3%，而於下層擺長變異時，全狀態回授幾乎無變化。 
 
7.5 振動抑制能力討論 
 
由第四章與第五章之模擬與實驗結果可知，輸入修正法與回授控制皆可有效地抑
制系統振動，但其抑制之 overshoot 與穩定時間都不一樣，所需的能量也不同，故將
分別從 overshoot，安定時間及能量三個角度切入，比較其振動抑制結果。 
 
 85
0
10
20
30
40
50
60
2 pulse ZV 3 pulse ZV ZVD 2x3 MIS ZVD state feedback
control
pe
rc
en
ta
ge
(%
)
simulation
experiment
 
圖7.12  各種控制方法overshoot之結果比較 
 
0 0.5 1 1.5 2
-2
0
2
4
6
8
10
12
time(s)
di
sp
la
ce
m
en
t(m
m
)
 
 
2 pulse ZV
3 pulse ZV
ZVD
2X3 MIS ZVD
state feedback cotnrol
 
 
圖7.13 各種控制方法安定時間之模擬結果比較 
 
 
7.5.2  安定時間 
 
圖7.13為安定時間之模擬結果比較，圖7.14為安定時間之實驗結果比較，其安定
時間定義為到達振動之5%範圍內，以4mm之overshoot 計算為到達0.2mm振動之時
間。由圖上可知，於五種振動抑制方法中， 2x3 MIS ZVD為安定時間為最長，而回
授控制於模擬中，安定時間為最短，於實驗中，其安定時間僅次於2 pulse ZV。 
0.579s 
0.797s 
1.132s 
1.341s 
0.276s 
 87
energy (J)
0
0.02
0.04
0.06
0.08
0.1
0.12
0.14
2 pulse ZV 3 pulse ZV ZVD 2x3 MIS
ZVD
feedback
control
electromagnet
motor
 
圖 7.15 振動抑制所需能量之模擬結果比較 
 
 
對 ZVD 與 2x3 MIS ZVD 而言，其於線性馬達加速過程中所須的能量計算方式與
所求得的值與 2-pulse ZV 以及 3-pulse ZV 相同，在此不加贅述。  
而對回授控制而言，其所需之能量為馬達推動上層平台作動之加速度乘上馬達加
速過程所行走之距離，以及電磁致動器抑制系統振動所需之能量，包含上層電磁致動
器與下層電磁致動器所耗費之功率在取樣頻率 500Hz 下之總和: 
2 2
1 1 2 2
m EE E E
F s I R dt I R dt
= +
= × + +∫ ∫  
其中加入電磁致動器之上層平台質量為 5.25kg。經過運算後，馬達驅動上層平台利用
電磁致動器抑制雙單擺運動與馬達在行走的過程中所需能量為圖 7.15 為輸入修正法
與回授控制所需能量之比較圖，在計算方向，假設馬達之行走過程為理想的等加速度
運動，而回授控制之電磁致動器所需電流為 MATLAB7.0/ SIMULINK 模擬結果，於
500Hz 取樣結果下之功率總合。 
對輸入修正法而言，其控制方式為修正馬達命令輸入，改變其加速度型式，在不
同時間點加速至不同速度，馬達維持最大速度與行走距離，利用波形相消原理來達到
減振，對於不同之輸入修正法而言，其所花的能量皆相同。而回授控制除了馬達行走
所需之能量，以及電磁致動器抑制系統振動所需之能量，回授控制所需的能量甚至大
於馬達行走所需的能量。 
 
7.6 綜合討論 
 
於第一章中介紹了長距離移動系統，以及其於移動過程中殘留振動造成的不良影
響，並定義控制目標為：於最短的時間內到達目標位置，且在作動過程中抑制系統振
動量。而後，建立了一長距離移動系統之縮小模型，並分別利用輸入修正法與回授控
制以達成控制目標，而由模擬與實驗結果可知，不論輸入修正法或回授控制，皆能將
殘留振動抑制於一定的範圍內。 
對於輸入修正法，也利用了四種不同輸入修正模式於馬達上實現，而其各具不同
 89
 
第八章 結論與未來展望 
8.1 全文歸納 
 
對於長距離移動系統殘留振動的抑制，除了保有其長行程移動之特性，還須抑制其在
移動過程中產生的振動。面對此問題的存在，我們分別設計了輸入修正法與閉迴路控制，
也從模擬與實驗來驗証其對振動抑制之能力。 
 
 輸入修正法 
於開迴路控制方面，輸入修正法為一有效率且成本低廉的方法，而這於精密機械上之
應用是極為重要的。本研究利用了四種不同的輸入修正模式，從馬達運動軌跡著手，修正
其加減速模式與時間，利用波形相消原理來達成抑制振動的目的，四種輸入修正模式的不
同，分別改善其 overshoot 大小，或達到安定時間之不同與面對頻率變異下之強健性。而當
系統主體為雙自由度時，為系統第一模態所設計之輸入修正模式，也能夠有效地將系統之
振動降低至一定程度。 
 
 閉迴路控制 
於閉迴路控制方向，討論系統為 SISO 與 MIMO 的情況，分別設計頻率響應控制與全
狀態回授控制，在合適的設計下，皆能達成振動抑制之目的，但全狀態回授為針對多輸入
多輸出系統所設計，與頻率響應控制相較之下，其對振動抑制能力較佳。在全狀態回授控
制中，也針對電磁致動器之非線性特性，討論操作點線性化與回饋線性化情況下，對控制
器實現上之差異。 
最後，討論在系統參數變異下其敏感度曲線，並分別從 overshoot，安定時間與能量三
方面來討論輸入修正法與全狀態回授控制對振動抑制之能力。 
 
8.2 結論 
 
長距離移動系統常用於傳輸運送或精密定位等用途，如機械手臂，天車與wafer stepper
系統等，在運動過程中，其末端會因加減速造成的作用力而產生明顯的振動，而殘留振動
的存在將影響系統之精度與工作效率。鑑於殘留振動對長距離移動系統產生的不良影響，
本研究設計了一縮小的等效雙單擺系統以模擬實際之具有雙自由度的系統，利用線性馬達
模擬傳輸機構，從開迴路與閉迴路控制二方面來抑制系統振動，並從模擬分析與實驗驗証
了其振動抑制的效果。 
開迴路方面，根據系統本身自然頻率且依線性馬達本身的性能限制，設計輸入修正法
並利用線性馬達來實現，由模擬與結果可知，線性輸入修正法能夠不外加任何致動方式的
情況下有效地抑制殘留振動，且可根據系統所須的性能表現選用不同的輸入修正方式。閉
迴路控制方面，先將系統視為SISO，設計頻率響應控制並討論其控制效果，而後將系統整
理為MIMO並設計全狀態回授控制，與頻率響應控制相較之下，其對振動抑制能力較佳。
而我們也針對電磁致動器之非線性特性，利用回饋線性化使得控制結果更佳。 
最後，從系統參數變異之敏感度曲線，overshoot，安定時間與能量三方面來討論輸入
修正法與全狀態回授控制對振動抑制之特性。全狀態回授控制之效果皆有明顯之優勢，但
因其存在電磁致動器回授控制，所須枆費之能量相對也最多。 
 
8.3 本文貢獻 
 
本研究建立了一多自由度長距離移動系統之縮小模型，成功地將將四種不同型式且以
系統第一模態設計的輸入修正法應用於長距離移動系統減振上，並分別利用SISO與MIMO
來設設計電磁驅動之回授控制以抑制系統於運動過程中之振動，並從模擬分析與實驗驗証
來証明其可行性。對輸入修正法而言，其為有效率且成本低廉的方法，而回授控制能夠改
 91
 
2. 林莞慈、陳敬元、鄭坤銓、陳國聲、楊天祥 (2006) 以輸入修正法抑制長距離移動系統
之結構振動。發表於中國機械工程學會第二十三屆學術研討會（台南永康，2006 年 11 月
24–25）。 
 
3. 高憲堂、胡逸群、楊天祥、陳國聲 (2006) 參數誤差對彈簧質點系統循跡精度之影響。
發表於中華民國第三十屆全國力學會議（彰化，2006 年 12 月 15–16 日）。 
 
4. 胡逸群、楊天祥、陳國聲 (2006) 參數選擇及初始條件誤差對平面天車系統循跡精度之
影響。發表於中華民國第三十屆全國力學會議（彰化，2006 年 12 月 15–16 日）。 
 
5. 林莞慈 (2007) 輸入修正法與回授控制於多自由度長距離移動系統之應用與研究，國立
成功大學機械系碩士論文。 
 
6. 林莞慈、戴辰軒、陳國聲、楊天祥 (2007) 回受控制於多自由度長距離移動系統之應用
與研究。發表於中華民國第三十一屆全國力學會議（高雄，2006 年 12 月）。 
 
7. 高憲堂、胡逸群、楊天祥、陳國聲 (2007) 兩步輸入修正法之殘餘振動分析。發表於中
華民國第三十一屆全國力學會議（高雄，2006 年 12 月）。 
 
8. 戴辰軒、王維志、陳國聲、楊天祥 (2008) 輸入修正法於天車系統運動之應用研究。發
表於中國機械工程學會第二十五屆學術研討會（彰化，2008 年 11 月 21–22）。 
 
此外，我們也已產出三篇國際期刊論文：(這些論文附錄於本成果報告文末) 
 
1. Chen, K.-S., T.-S. Yang, and Yin, J.-F. (2006) Residual vibration suppression for Duffing 
nonlinear systems with electromagnetical actuation using nonlinear command shaping techniques. 
ASME J. Vib. Acoust. 128, 778–789. 
 
2. Chen, K.-S., T.-S. Yang, Ou, K.-S., and Yin, J.-F. (2008) Design of command shapers for 
residual vibration suppression in Duffing nonlinear systems. Mechatronics, in press. 
 
3. Yang, T.-S., Kao, S.-T., and Hu, I. (2008) Asymptotic analysis of a two-step input shaping 
scheme for suppressing motion-induced residual vibration of nonlinear mechanical systems. 
Submitted to J. Eng. Math.  
 
目前我們也正在積極整理其他成果中，以投稿至相關學術期刊。由以上具體討論和量化數
據，我們有理由相信本計畫之執行可謂至為成功。 
 93
Results for MACE" AIAA J. Guidence, Control, and Dynamics, Vol.22, pp.267-277, 1999. 
[19] T. D. Tuttle and W. P. Seering, “Vibration Reduction in 0-g Using Input Shaping on the 
MIT Middeck Active Control Experiment,” American Control Conf., pp. 919-923, Seattle, 
WA, 1995.   
[20] T. D. Tuttle and W. P. Seering, “A Zero-Placement Technique for Designing Shaped Inputs 
to Suppress Multiple-mode Vibration,” American Control Conf., pp. 2533-2537 Baltimore, 
MD, 1994. 
[21] P. Van Kessel, L. Hornbeck, R. Meier, M. Douglass, A MEMS-Based Projection Display, 
Proc. of the IEEE, Vol. 86, pp.1687-1704, 1998. 
[22] K-S Chen and K-S Ou, "COMMAND SHAPING TECHNIQUES FOR ELECTROSTATIC 
MEMS ACTUATION: ANALYSIS AND SIMULATION," IEEE J. Microelectromechanical 
Systems, (Accepted Jan. 23, 2007.) 
[23] S.-P. Su and T.-S. Yang, “Suppression of Nonlinear Forced Waves by Error-Insensitive Input 
Shaping,” J. Chinese Society of Mechanical Engineers, Vol. 23, pp. 507-516, 2002. 
[24] T.-S. Yang and W.-L. Liang,”Suppression of nonlinear forced waves by input shaping.” 
Wave Motion, Vol. 37, pp. 101~117, 2003. 
[25] 尹瑞豐，非線性輸入修正法之研究與其在機電系統減振上之應用，國立成功大學機械
系碩士論文，2004。 
[26] T.-S. Yang, K.-S. Chen, C.-C. Lee and I. Hu, "Effects of system payload on the suppression 
of motion-induced residual vibration by input shaping," J. Eng. Mathematics (In Process 
2006) 
[27] K.-S. Chen, T.-S. Yang, J.-F. Yin, “Residual Vibration Suppression for Duffing Nonlinear 
Systems With Electromagnetical Actuation Using Nonlinear Command Shaping 
Techniques.” Journal of Vibration and Acoustics, ASME, (in process ,2006).  
[28] 鄭坤銓, 陳敬元, 陳國聲, 楊天祥 “Residual Vibration Suppression of Cantilever Beam 
Using Command Shaping Method.” 中華民國第二十二屆機械會議，2005. 
[29] T.-S. Yang, K.-S. Chen, C.-C. Lee and I. Hu, “Suppression of motion induced vibration of an 
elastic rod by input shaping.” The 28th national conference on theoretical and applied 
mechanics, Taiwan, (2004) 
[30] 何正中，等效微機電致動器之控器設計與實驗驗證，國立成功大學機械系碩士論文，
2003。 
[31] 陳敬元，輸入修正法結合回授控制之研究與其在長距離移動之機電系統定位最佳化與
減振之應用，國立成功大學機械系碩士論文，2005。 
[32]  鄭坤銓，電磁致動之非線性撓性結構之控制系統分析及精密定位應用，國立成功大學
機械工程學系碩士論文，2006。 
[33] 胡逸群，”初始條件誤差對天車系統循跡精度之影響”，中華民國力學學會第 30 屆全國
力學會議，2006。 
[34] A. D. Hazlerigg, “Automatic control of crane operations,” in Proceedings of the IFAC 5th 
World Congress Vol. 1, Paris, France, Paper No 11.3, 1972. 
[35] A. Marttinen, “Pole-placement control of a pilot gantry,” in Proceedings of the American 
Control Conference Pittsburgh, PA, Vol. 3, pp.2824-2826,1989 
 95
 
附 錄 
 
已產出國際期刊論文： 
 
1. Chen, K.-S., T.-S. Yang, and Yin, J.-F. (2006) Residual vibration suppression for Duffing 
nonlinear systems with electromagnetical actuation using nonlinear command shaping techniques. 
ASME J. Vib. Acoust. 128, 778–789. 
 
2. Chen, K.-S., T.-S. Yang, Ou, K.-S., and Yin, J.-F. (2008) Design of command shapers for 
residual vibration suppression in Duffing nonlinear systems. Mechatronics, in press. 
 
3. Yang, T.-S., Kao, S.-T., and Hu, I. (2008) Asymptotic analysis of a two-step input shaping 
scheme for suppressing motion-induced residual vibration of nonlinear mechanical systems. 
Submitted to J. Eng. Math. 
 
t
s
s
n
D
w
c
s
2
f
e
h
H
i
s
s
i
p
t
r
e
r
w
l
l
l
a
s
c
c
p
s
c
i
s
c
i
t
e
w
s
t
actually represents the system dynamics of a mechanical structure
subject to either an electromagnetic or an electrostatic attractive
F
m
Jwo-step and ZVD or three-step shapers of Duffing nonlinear
ystems has been developed independently based on energy con-
ervation, static balance, and elliptical integrals, and its effective-
ess has been successfully demonstrated for cubic and general
uffing nonlinear systems subjected to step inputs. In this paper
e wish to extend the methodology in that work to handle a
onditionally stable nonlinear system containing both Duffing
tructural and electromagnetic forcing nonlinearities.
Background
2.1 Command Shaping. Consider a linear single degree of
reedom system with negligible damping and subject to a step
xcitation. Although it has the fastest response, this system would
ave a significant residual vibration and a very long settling time.
owever, if the step is modified by convolving with a series of
mpulses, the residual vibration as well as the settling time can be
ignificantly reduced with a slight increase in rising time. A pos-
ible choice, usually referred to as the zero-vibration ZV shaper
n the literature 10, splits the system command into two identical
artial commands separated in time by T /2 half period of vibra-
ion. Then, according to linear system theory, the total system
esponse is the sum of the two individual responses excited by
ach of the partial commands, resulting in completely suppressed
esidual vibration through destructive interference. This approach
orks well for linear or weakly nonlinear systems in which a
inearization scheme is usually performed to obtain the equivalent
inearized dynamics.
However, for strongly nonlinear systems, this approach is no
onger valid since the principle of superposition can no longer be
pplied. In certain applications, such as fixed-fixed beam structure
ubjected to electromagnetic or electrostatic forcing, the system
ould behave highly nonlinearly in both the stiffness and the ex-
itation. Recently, Kozak 19 and Yin 20 independently pro-
osed an alternative methodology for designing input shapers to
uppress residual vibration for single degree of freedom systems
ontaining spring nonlinearities. This approach is not only feasible
n theoretical analysis but also is useful for handling a realistic
ystem because an online tuning procedure has been devised for
ompensating possible parameter uncertainties or model complex-
ty.
2.2 Electromagnetic Pull-In Instabilities. Consider a struc-
ure shown schematically in Fig. 1 with a negligible damping. The
quation of motion can be expressed as
mex¨ + fx =
Ci2
G − x2
1
here me is the equivalent mass, fx represents the restoring
pring force, G, I, and C are the initial air gap, the applied elec-
rical current, and the force coefficient, respectively. Equation 1
ig. 1 Schematic plot of the system dynamics of an electro-
agnetically actuated system
ournal of Vibration and Acousticsforce i.e., by replacing electric current by an electric potential V
and the behavior of many microelectromechanical systems
MEMS or electromechanical systems can also be described by
Eq. 1.
One important characteristic associated with Eq. 1 is the
pull-in instability that sets in when the displacement x exceeds a
certain threshold. For example, if fx is linear, i.e., fx=kx, the
theoretical pull-in instability occurs at x=3/G and at x=0.6G if
fx=kx3. This phenomenon not only imposes a limitation on the
achievable motion range but also implies that the stability of such
a system is more sensitive to the presence of residual vibration
because the stability margin or the achievable displacement range
can be further reduced by the presence of residual vibration and
this could increase the difficulty of vibration control.
Although the linear command shaping techniques should be
able to deal with linear or slightly nonlinear structures with elec-
trostatic or electromagnetic actuation, it would be difficult for
them to handle a system containing both structural Duffing and
electromagnetic forcing nonlinearities. Nevertheless, it should be
possible to extend the command shaping method proposed by Yin
20 to this kind of system. In addition, it is also possible to
integrate the command-shaping scheme with a feedback control
loop to further enhance the performance of a particular mecha-
tronic system in the future. The next section would address the
proposed method in detail.
3 Non-Linear Shaper Design Using Energy Method
3.1 Problem Definition and Nondimensionalization. Con-
sider a forced Duffing equation
mx¨ + kx + k3x3 =
At
G − x2
2
where k N/mm k3 N/mm3 are the linear and nonlinear spring
constants, respectively. The nonlinear stiffness is common in
many structures, for example, a fixed-fixed beam or a clamped
plate subjected to excessive lateral motion 21. The applied force
on the right hand side of Eq. 2 can be realized in practice by
electrostatic 22 or electromagnetic 6 means. Note that in Eq.
2 At is proportional to I2t for electromagnetic actuators and
V2t for electrostatic actuators without saturation.
Suppose now that the mass initially is at rest at the force-free
equilibrium position and we wish to bring it to a new equilibrium
position x=xm. However, unless the system input At is properly
administered, residual vibration will generally be excited and, as
damping effects are not taken into account in Eq. 2, the mass
would never settle at the target position x=xm unless it reaches the
target position with zero velocity. Furthermore, to secure the mass
there, as soon as it reaches the target position, a static force of
constant magnitude
fm = kxm + k3xm3 3
must be applied on the mass to counteract the elastic restoring
force. In other words, once the mass reaches the target position
x=xm, the force strength function At must be maintained at the
corresponding steady state value Am= fmG−xm2.
In order to discuss the command-shaping design using a mini-
mal set of independent system parameters, here we shall nondi-
mensionalize Eq. 2 according to the following normalization
scheme:
t* = t/t0, x* = x/xm, A*t* = At/A0 4
where t0 and A0 are a characteristic time scale and a characteristic
scale for the force strength function to be specified later, respec-
tively. Note also that here the asterisks denote dimensionless vari-
ables. In terms of the normalized variables defined above, and
DECEMBER 2006, Vol. 128 / 779
H
a
fi
b
a
i
d
t
t
t
m
f
t
x
w

T
G
p
=
l
W
w
Jence, equating 1 and W0,1 ;A1 calculated from Eqs. 8
nd 9, respectively, we determine the required magnitude of the
rst step input to be
A1 =
G0
4G0 − 1
2 + kr
1 + kr
10
Also, as illustrated in Fig. 4 the actuating force then would not
e strong enough to secure the mass at x=1. The actuating force
nd the spring restoring force are related to the slope of the work
nput and potential curves. Thus, as soon as the mass reaches its
estination x=1, the second and final step input of unity magni-
ude A=1 should kick in to counteract the elastic restoring force.
It remains to be calculated when the mass would reach the
arget position, and the second step input should kick in to secure
he mass at its target position. To do so the kinetic energy of the
ass is calculated by subtracting the stored elastic potential x
rom the work input W0,x ;A1. Accordingly, the time it takes for
he mass to depart from its initial force-free equilibrium position
=0 and reach the target position x=1 is calculated to be
T1 =
0
1 dx
x˙
= I2kr,G0 11
here I2 is the elliptic integral of the first kind defined as follows
23:
I2kr,G0 =
0
1 	1 − 1G0 − sin2	/2 + kr2

 
1 + sin2 	2 + sin4 	2 
−
1
G0 − sin2	/2
−1/2d	 12
Note in particular that for linear systems, kr=0, and thus
1 /= I20,G0 only depends on the relative distance parameter
0. If, in addition, G0→ so that the actuating force becomes
osition independent, then it can be easily seen that T /
I20,=1. On the other hand, for systems of purely cubic non-
inearity, kr→, so that I2 ,G0→2kr−1/2JkG0 where
JkG0 =
0
1 	1 + sin2 	2 + sin4 	2  − 1G0 − sin2	/2−1/2d	
13
hen G0→, Jk→0.773.
It is also important to investigate how much residual vibration
ill be excited when the values of the system parameters actually
Fig. 4 Energetics of two-step input shaping
ournal of Vibration and Acousticsare in error. Such issues will be addressed more systematically in
subsequent sections using results of numerical simulations and
experimental verification. However, as demonstrated and ex-
plained in Yin 20, the robustness of input shaping schemes
against parametric uncertainties can be greatly enhanced at the
expense of a slight increase in the system’s settle time. One way
to perform that is to use a three-step shaped input, which we
discuss next.
3.4 Three-Step Command Shaping. The procedure to de-
sign the three-step shaper is also shown in Fig. 3 and it works like
this: First, by applying a system input of suitable constant strength
A1, we bring the mass to an intermediate position x= 0
1 with zero velocity. As soon as the mass reaches the interme-
diate position, the strength of the system input is switched to
another constant magnitude A2, so that the mass would then move
on to the target position x=1 with zero velocity. Of course, at the
very instant the mass finally is brought to the target position, a
third input force is exerted to adjust to the equilibrium strength
A=1 and secure the mass there.
The energetics of the three-step command shaping is illustrated
in Fig. 5. Comparing Figs. 4 and 5, it is clearly seen that the work
input curve corresponding to the three-step input stays closer to
the elastic potential curve than that corresponding to the two-step
input. Remember the slopes of the energetics represent forces.
Accordingly, when actuated by a three-step input, the mass would
always have a smaller kinetic energy and thus travel at a lower
velocity. This then implies a longer settling time of the system.
Meanwhile, as the work input and elastic potential curves are
closer to each other for the three-step input, parametric perturba-
tions generally would result in smaller excessive kinetic energy
that eventually leads to a smaller residual vibration of the mass.
This provides a qualitative explanation why the three-step input
shaping is more tolerant of parametric errors than the two-step
input shaping.
Quantitatively, by equating the work done by the first step force
of strength A1 and the stored elastic potential at x=, we calculate
that
A1 =

4
·
G0G0 − 
G0 − 12
·
2 + kr2
1 + kr
14
Furthermore, in order to bring the mass onto the target position
with zero kinetic energy, the work done by the second force step
over the remaining distance, W ,1 ;A2=A21−1+krG0
−1 / G0− as calculated from Eq. 10, must equal the discrep-
ancy between the elastic potential energies at x= and 1, which is
1−= 1−2 /2+kr1−4 /4. The magnitude of the sys-
tem input during the second step therefore is calculated to be
Fig. 5 Energetics of three-step input shaping
DECEMBER 2006, Vol. 128 / 781
B
s
a
t
e
m
i
a
T
v
e
h
e
s
t
p
s
i
4
s
n
s
i
s
t
s
F
=
m
F
u
JPR =
maximum vibration amplitude
2 * the moving range at steady state
.
y this definition, PR equals 100% for a linear undamped system
ubjected to a step input. In Fig. 7, it can be found that both two-
nd three-step shapers can effectively suppress the residual vibra-
ion. On the other hand, both the ZV and ZVD shapers based on
nd-point linearization can only partially reduce the vibration. A
ore detailed parametric study to cover a wide range of kr and G0
s shown in Fig. 8. For kr=0, the residual vibration of both ZV
nd ZVD methods asymptotically approach zero as G0 increases.
his is reasonable since the system becomes linear as G0 becomes
ery large. However, for nonzero kr, both ZV and ZVD shapers
xhibit significantly residual vibrations at any G0. On the other
and, theoretically, the proposed nonlinear shapers can perfectly
liminate possible residual vibration at the same situation. This
tudy indicates that the proposed nonlinear shaper is better than
he linear shapers for such nonlinear systems. Another important
erformance evaluation is the sensitivity of these nonlinear
hapers against the possible parameter variation. This is addressed
n the following section.
Sensitivity Studies
In this section, the performance and robustness of the nonlinear
hapers developed in Sec. 3 are examined by two case studies,
amely, a linear and a pure cubic structure and both of them are
ubjected to electromagnetic force excitation. Note that, although
n reality there are no pure cubic structures, this case is still worth
tudying because the cubic and the linear structure cases represent
wo extremes of a general Duffing structure and these two case
tudies represent the upper and lower performance bounds of the
ig. 7 The responses of a magnetically actuated Duffing „kr
1, G0=4… system subjected to different shaped step com-
ands „amplitude=1…
ig. 8 The residual vibration of linearized ZV and ZVD shapers
nder different kr and G0
ournal of Vibration and Acousticsproposed command shaping scheme when applied to a general
Duffing system. In addition, since the system dynamics is nondi-
mensionalized here, as a result, the study results can be applicable
universally once the scaling parameters are given.
4.1 Linear Structures. For a linear structure kr=0 with
damping, Eq. 7 can be rewritten as
1 + x¨ + bx˙ + x = 1 + 
A˜ t
G0 − x2
25
where A˜ =A shown in Eq. 7. The final destination xm is still 1
and , b, and  represent the uncertainty in mass, damping, and
force coefficients, respectively. For an ideal situation, all of them
are zero and the two-step and three-step input shapers can be
designed following the method outlined in Sec. 3. Here we are
interested in evaluating the robustness of the proposed shapers
with respect to the possible parameter uncertainties at different
G0. It is important to emphasize that the associated G0 must be
greater than 3 for stability consideration. For this reason, the
smallest G0 is decided as 3.5. A completed set of initial air gap
with G0 of 3.5, 5, 10, and 20 is used to obtain a detailed study.
Figure 9 shows the sensitivity curve of these shapers for mass
uncertainties  the other two uncertainties are set to be zero.
Fig. 9 Effect of mass parameter uncertainty for a linear struc-
ture under different initial air gaps. „a… Two-step shaped and „b…
three-step shaped responses.
DECEMBER 2006, Vol. 128 / 783
t
i
c
r
s
c
v
t
d
1
s
t
i
s
s
o
F
o
l
n
r
s
F
t
t
Jhe sensitivity curve of ZVD shapers, where the residual vibration
s extremely insensitive for a slight mass variation, the sensitivity
urve of three-step shapers is triangular and this indicates a less
obust performance.
The influence of damping is characterized in Fig. 13. For two-
tep shapers, the tendency is similar to that of the linear structure
ase shown in Fig. 9a but with a slight increase in peak residual
ibration from 19% to 25%. For three-step shapers, it is found
hat the peak residual vibration also increases with G0. This ten-
ency is different from the linear structure situation shown in Fig.
0b. The performance of both shapers approaches the results
hown in Yin 20 as G0 increases. In addition, it is also important
o observe that the performance of a three-step shaper is almost
ndependent of the initial air gaps for an extremely lightly damped
ystem and this also implies that the performance of the three-step
haping scheme is more robust against damping variations.
Finally, the variation of force coefficients  on the performance
f the input shaper is investigated and the results are shown in
ig. 14. Similar to the linear structure situation, pull-in instability
ccurs if the air gap is small for a positive . However, unlike the
inear situation, where the residual vibration is less sensitive to a
egative , the sensitivity curve now is more symmetrical and the
esidual vibration level is much higher for both two- and three-
tep shapers in comparison with the corresponded linear structure
ig. 11 Effect of force coefficient uncertainty for a linear struc-
ure under different initial air gaps. „a… Two-step shaped and „b…
hree-step shaped responses.
ournal of Vibration and Acousticscase.
In summary, the performance of both two- and three-step
shapers degrades with the structural Duffing or the electromag-
netic forcing nonlinearities and the applicability of input shapers
relies on the performance specs of operation and the accuracy of
system parameter identification during system dynamics modeling
and identification.
5 Experimental Verification
Finally, the nonlinear shaper design procedure shown in Sec. 3
is applied to and examined by an electromagnetic actuated Duff-
ing system shown in Fig. 15, which contains a fixed-fixed beam
with a center boss subjected to the attractive force of an electro-
magnet. By static and dynamics tests as well as actuator calibra-
tions, the associated mechanical and electromechanical param-
eters are obtained. They are: modal mass: 0.277 Kg; linear and
cubic spring constants: 1154 and 1.04
107 N/m3; damping co-
efficient: 0.1 Ns/m; force constant: 1.01
10−4 Nm2/A2; and ini-
tial air gap: 6.5 mm.
Following the procedure of the shaper design shown in Fig. 3, it
is possible to obtain the associated parameters for shapers and the
results are listed in Table 1. Based on the parameters shown in
Fig. 12 Effect of mass parameter uncertainty for a pure cubic
structure under different initial air gaps. „a… Two-step shaped
and „b… three-step shaped responses.
DECEMBER 2006, Vol. 128 / 785
r
f
r
t
n
c
e
v
F
s
ned
D
X
D
X
Jameters. It is believed that the presence of the electromagnetic
orce provides a softening effect on the spring and results in a
eduction of the equivalent natural frequency 24. Therefore, for
he same amount of system parameter variation, the electromag-
etically driven system has a larger percentage of parameter un-
ertainty and this results in a higher residual vibration. The soft-
ning effect becomes more predominant as G0 decreases.
Since this design method is based on force and energy conser-
ation, the introducing of damping force would dissipate me-
ig. 15 The electromagnetic actuated fixed-fixed beam „a…
chematic plot and „b… experimental apparatus
Table 1 Input shaper desig
isplacement Shapes
i1
amp
=1 mm
Two step theory 0.4528
Two step tuned 0.4571
Three step theory 0.3380
Three step tuned 0.3400
isplacement Shapes i1
amp
=2 mm
Two step theory 0.5831
Two step tuned 0.584
Three step theory 0.4589
Three step tuned 0.4625
ournal of Vibration and Acousticschanical energy and the fundamental assumptions for shaper de-
sign could be violated. However, as shown in Sec. 4, for system
with small damping, the generated residual vibration is small and
can be neglected in practical applications. This is important since
input shaping technique is usually applied in a system lacking
substantial dissipation mechanisms and the proposed method
proves to be effective under such a circumstance.
The uncertainty in actuator is a major problem for magnetically
actuated systems and numerous techniques and papers have been
reported for calibration of electromagnets. In addition, several ro-
bust control design schemes such as sliding control have also been
applied to overcome this problem. The effect of magnetic actuator
uncertainty shown in Sec. 4 indicates that the proposed shaping
scheme is more robust for a negative uncertainty. The system
could become unstable for a positive force coefficient uncertainty
at a smaller air gap. In addition, the steady state position will also
for the experiment system
i2
amp
i3
amp
T1
s
T2
s
0.5904 0.053
0.5904 0.0540
0.5350 0.5904 0.0507 0.1069
0.5422 0.5904 0.0505 0.1060
i2
amp
i3
amp
T1
s
T2
s
0.6922 0.060
0.6922 0.060
0.6601 0.6922 0.05325 0.1269
0.6573 0.6922 0.053 0.1260
Fig. 16 Two-step and linearized ZV shaped step response of
the experimental apparatus at different amplitudes „a… 1 mm
and „b… 2 mm
DECEMBER 2006, Vol. 128 / 787
and-derivative ZVD shapers, respectively. The robustness of
these nonlinear shapers is investigated numerically through two
case studies. The results show that the three-step shaper is suffi-
ciently robust to resist significant amounts of parameter variations
from their design values without exciting significant residual
vibration. Finally, an electromagnetically driven Duffing mechani-
cal system has been constructed and the performances of the non-
linear shapers in vibration suppression have been demonstrated. It
shows a significant improvement in vibration suppression and in
comparison with that shaped by traditional linearized ZV and
ZVD shapers.
Acknowledgment
This work was supported by the National Science Council of
Taiwan through Grant Nos. NSC91-2212-E-006-082, NSC91-
2218-E-006-016, and NSC92-2623-7-006-014. The assistance
from K.-S. Ou and K.-C. Cheng of NCKU is greatly appreciated.
References
1 Yeh, T.-J., Chung, Y.-J., and Wu, W.-C., 2001, “Sliding Control of Magnetic
Bearing Systems,” ASME J. Dyn. Syst., Meas., Control, 1233, pp. 353–362.
2 Williams, M. E., and Trumper, D. L., 1993, “Magnetic Bearing Stage for
Photolithography,” CIRP Ann., 42, pp. 607–610.
3 Chen, K.-S., Trumper, D. L., and Smith, S. T., 2002, “Design and Control of
an X-Y-	 Stage,” Precis. Eng., 264, pp. 355–369.
4 Stein, A. J., 2002, “A Metrological Atomic Force Microscope,” SM thesis,
Massachusetts Institute of Technology.
5 Holmes, M. L., and Trumper, D. L., 1996, “Magnetic/Fluid Bearing Stage for
Atomic-Scale Motion Control,” Precis. Eng., 181, pp. 38–49.
6 Subrahmanyan, P. K., Olson, S. M., and Trumper, D. L., 1997, “Linearizing
Control of Magnetic Suspension Systems,” IEEE Trans. Control Syst. Tech-
nol., 54, pp. 427–438.
7 Trumper, D. L., 1990, “Magnetic Suspension Techniques for Precision Motion
Control,” Ph.D. thesis, Massachusetts Institute of Technology.
8 Gutierrez, H. M., and Ro, P. I., 1998, “Sliding-Mode Control of a Nonlinear-
Input System: Application to a Magnetically Levitated Fast-Tool Servo,” IEEE
Trans. Ind. Electron., 45, pp. 921–927.
9 Mittal, S., and Menq, C.-H., 1997, “Precision Motion Control of a Magnetic
Suspension Actuator Using a Robust Nonlinear Compensation Scheme,”
IEEE/ASME Trans. Mechatron., 2, pp. 268–280.
10 Smith, O. J. M., 1957, “Posicast Control of Damped Oscillatory Systems,”
Proc. IRE, 45, pp. 1249–1255.
11 Jones, S., and Ulsoy, A. G., 1999, “An Approach to Control Input Shaping
With Application to Coordinate Measuring Machines,” ASME J. Dyn. Syst.,
Meas., Control, 121, pp. 242–247.
12 Mohamed, Z., and Tokhi, M. O., 2004, “Command Shaping Techniques for
Vibration Control of a Flexible Robot Manipulator,” Mechatronics, 14, pp.
69–90.
13 Yang, T.-S., and Liang, W.-L., 2003, “Suppression of Nonlinear Forced Waves
by Input Shaping,” Wave Motion, 37, pp. 101–117.
14 Su, S.-P., and Yang, T.-S., 2002, “Suppression of Nonlinear Forced Waves by
Error-Insensitive Input Shaping,” J. Chin. Soc. Mech. Eng., 236, pp. 507–
516.
15 Singer, N. C., and Seering, W. P., 1990, “Preshaping Command Inputs to
Reduce System Vibration,” ASME J. Dyn. Syst., Meas., Control, 112, pp.
76–82.
16 Pao, L. Y., and Lau, M. A., 2000, “Robust Input Shaper Control Design for
Parameter Variations in Flexible Structures,” ASME J. Dyn. Syst., Meas., Con-
trol, 122, pp. 63–70.
17 Miu, D. K., 1992, Mechatronics, Electromechanics and Contromechanics,
Springer, New York.
18 Singhose, W. E., 1997, “Command Generation for Flexible Systems,” Ph.D.
thesis, Department of Mechanical Engineering, Massachusetts Institute of
Technology, Cambridge, MA.
19 Kozak, K. C., 2003, “Robust Command Generation for Nonlinear Systems,”
Ph.D. thesis, Department of Mechanical Engineering, Georgia Institute of
Technol., Atlanta.
20 Yin, J.-F., 2004, “Development of Nonlinear Input Shaping Methods and Their
Application on Residual Vibration Suppression of Electro-mechanical Sys-
tems,” S.M. thesis, National Cheng-Kung University, Tainan, Taiwan.
21 Timoshenko, S. P., and Woinowsky-Krieger, S., 1959, Theory of Plates and
Shells, McGraw–Hill, International edition, New York.
22 Nemirovsky, Y., and Bochobza-Degani, O., 2001, “A Methodology and Model
for the Pull-In Parameters of Electrostatic Actuators,”J. Microelectromech.
Syst., 10, pp. 601–615.
23 Nyfeah, A. H., and Mook, D. T., 1979, Nonlinear Oscillations, Wiley.
24 Chen, K.-S., 1995, “Spring Dominated Regime Design of a High Load Capac-
ity, Electromagnetically Driven X-Y-	 Stage,” MS thesis, Massachusetts In-
stitute of Technology.
25 Senturia, S. D., 2000, Microsystem Design, Kluwer, Dordrecht.
26 Van Kessel, P., Hornbeck, L., Meier, R., and Douglass, M., 1998, “A MEMS-
Based Projection Display,” Proc. IEEE, 868, pp. 1687–1704.
27 Rebeiz, G. M., 2003, RF MEMS, Theory, Design, and Technology, Wiley.
Journal of Vibration and Acoustics DECEMBER 2006, Vol. 128 / 789
tron
ARTICLE IN PRESSIn the existed input shaping literature, most of the plant
dynamics were modeled in linear or linearized equivalent forms
[3,10–15]. The nonlinearities were either treated as the uncer-
tainties associated with the corresponding linear systems or sim-
ply are linearized with respect to certain operating conditions. In
such an approach, the standard linear system concepts and tools
can be directly applied. This treatment certainly is appropriate
for weakly nonlinear systems. However, for systems with strong
nonlinearities such as ﬁxed–ﬁxed beams subjected to large
amplitude movement [27], clamped plate vibrations [28], MEMS
subjected to large rotation [29] or deﬂection [30], and the related
problem of nonlinear forced waves [31–33], the linearized equiv-
alent models could deviate from the exact nonlinear models in
various signiﬁcant ways. As a result, shapers developed based
on linear system theory are no longer useful. This then presents
an obstacle for applying the input shaping techniques to sup-
press residual vibration or residual wave propagation in such
applications.
In comparison with linear shaper design, much less work has
been done in nonlinear shaper design by designing shapers di-
rectly from their nonlinear dynamics. Kinceler and Meckl [34]
compared an open-loop optimal command generation technique
to an inverse dynamics technique for obtaining zero-vibration
commands for a simple nonlinear vibratory system. Similar work
can be found elsewhere [20,35]. Gorinevsky and Vukovich [22]
developed an efﬁcient numerical method for computing optimal
feed-forward commands to minimize vibration of ﬂexible space-
craft. However, both methods are all difﬁcult to be implemented
and almost always require intensive numerical techniques [17].
The piecewise-minimal-vibration ZV shaper proposed by Crain et
al. [36] has been proven to be inadequate for strongly nonlinear
system (For example, see [37]). On the other hand, the concur-
rently-optimized ZV method proposed by Simth et al. [37] and Ko-
zak [17] showed that it is possible to completely eliminate all
residual vibrations for a single-degree-of-freedom nonlinear sys-
tem by an energy approach. However, several fundamental issues
remain unsolved. First, they did not develop an explicit expression
to determine all the shaper’s parameters. Second, the robustness of
the nonlinear ZV shaper was not discussed. Third, they did not de-
velop the nonlinear ZVD shaper, which should have better robust-
ness against parameter variations. Finally, they design the
nonlinear ZV shaper in dimensional form, which could increase
the physical sense of design. However, this also made it difﬁcult
to generate a universal expression of the input shaper design
scheme for similar nonlinear systems.
Theoretically, at any situations, the required command shaper
can always be found via a formal optimization process. By mini-
mizing a deﬁned cost function (usually the residual vibration) sub-
jected to some constraint equations; it is possible to ﬁnd the
required command sequence to yield the minimum residual vibra-
tion. However, for nonlinear systems, this process may be too com-
putational intensive and lack of physical or methodology-based
insight. As a result, an analytical approach for ﬁnding the required
command shapers should be very useful for real applications. The
motivation of this paper is therefore to develop such a methodol-
ogy to design equivalent ZV (two-step) and ZVD (three-step) shap-
ers for nonlinear systems by an energy approach similar to Smith
et al. and Kozak [17,37] and to address their robustness against
parameter uncertainties. Unlike Smith et al. and Kozak’s approach
[17,37], we address this problem by using dimensionless system
dynamics and this allows us to apply our ﬁnal results universally
for any dynamic analogous systems. In addition, through the
dimensional analysis, the relative importance of system nonlinear-
2 K.-S. Chen et al. /Mechaity can be qualitatively identiﬁed. Finally, the method proposed in
this paper automatically reduces to the corresponding linear sha-
per design ﬂow if the nonlinear effect can be neglected. This makes
Please cite this article in press as: Chen K-S et al., Design of command
tronics (2008), doi:10.1016/j.mechatronics.2008.08.005the approach more general than the existed linear or nonlinear
shaper designs.
The primary systemnonlinearity to be dealt with in this article is
the Dufﬁng nonlinearity, in which the elastic restorting force f con-
sists of two parts proportional to the ﬁrst and third powers of the
structural deﬂection x, respectively: f = kx + k3x3 [38]. The Dufﬁng
nonlinearity is ubiquitous in fully constrained structures such as
ﬁxed–ﬁxed beams and edge clamped circular plates. The control
of the residual vibration of such nonlinear systems is of great prac-
tical importance for ﬂexible mechanisms in precision engineering
or micro switches in MEMS. Fig. 1 shows the schematic diagram,
the corresponding real system, and the characteristics of a ﬁxed–
ﬁxed beam subject to an out of plane deﬂection in order to help
the readers to understand the Dufﬁng nonlinearity and to recognize
the goal of this work. For the purpose of providing physical feeling,
let us also consider a ﬁxed–ﬁxed steel beam (E = 200 GPa) subjected
to a concentrated loading at the center with a physical dimension of
200 mm, 10 mm, and 1 mm in length, width, and thickness, respec-
tively. The ratio in equivalent stiffness (deﬁned as the slope of the
load–deﬂection curve) between the equilibrium positions at nearly
zero deﬂection (i.e., linear regime) and at a 1 mm deﬂection is
approximately 1: 3.25 [25]. This implies an 80% variation in natural
frequency for an oscillationwith amerely 1 mmamplitude. Accord-
ing to the sensitivity curves established in previous linear shapes,
signiﬁcant residual vibration will exist no matter what kind shaper
is used.
In this article, both analytical analysis and numerical simula-
tions will be used to study single-degree-of-freedom (SDOF) sys-
tems with Dufﬁng nonlinearity. The rest of the article presents
the detail of the proposed method. In Section 2, the general com-
mand shaping formulation, as well as the development of linear
shaper, is brieﬂy introduced. The analysis for the development of
the command shaper is presented in Section 3. The correspondence
between the proposed method and the general optimization prob-
lem is then addressed in Section 4. The numerical studies and val-
idations for the proposed shaper are then conducted in Section 5,
followed by a discussion section (i.e., Section 6). Finally, Section
7 concludes this work.
2. Background
Consider a second-order harmonic system with system dynam-
ics given in Eq. (1)
€xþ 2x1 _xþx2x ¼ 1
m
FðtÞ ð1Þ
where x is the displacement, x, f, m, and F(t) are the natural fre-
quency, damping ratio, mass, and the controlled input, respectively.
The corresponding ringing frequencyxd and period Td can be calcu-
lated by xd ¼ x
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1 12
p
and Td = 2p/xd, respectively. A step com-
mand would achieve fast response but signiﬁcant residual
vibration would also be generated. As illustrated in Fig. 2a, instead
of the unit step force applied in Eq. (1), the residual vibration can be
reduced by a modiﬁed input by convolving the unit step function
with a series of impulse trains (i.e., the command shaping ap-
proach). For a rest-to-rest maneuver, the problem to ﬁnd the shaper
can be formulated as an optimization problem [18]. By consider the
position and velocity constraints imposed
xðtf Þ  xð0Þ ¼ xm: ð2Þ
and
_xðtf Þ ¼ _xð0Þ ¼ 0: ð3Þ
ics xxx (2008) xxx–xxxwhere tf is the ﬁnal time and xm is the desired displacement. The
cost function (residual vibration amplitude) to be minimized can
be expressed as (for a linear system) [18]
shapers for residual vibration suppression in Dufﬁng ..., Mecha-
can also be treated as uncertainty within the tolerance of a robust
shaper. Note that the ZV and ZVD shapers can also be developed
by linear superposition principle for linear systems. By summing
two responses with appropriate time delay, it is possible to achieve
the same results obtained by optimization process. This approach is
somewhat straightforward and easily to be implemented for linear
and linearized systems. However, this design methodology for ZV
and ZVD shapers breaks down if the systems are strongly nonlinear.
For systems with strong nonlinearity, the stiffness or inertia varies
with respect to inputs and/or positions, and the linear shaper design
rules are no longer useful since it cannot correctly deﬁne a natural
period, T, and the exact cancellation of two partial responses is no
longer possible.
Nevertheless, by the optimization process for minimizing the
residual vibration, it is always possible to ﬁnd appropriate impulse
trains to eliminate residual vibration. The problem is that the cost
robustness of the shaping scheme. It is also possible to use an on-
line tuning scheme to ﬁnd the exact shaper under imperfections.
Ultimately, it can be obtained by extensive numerical optimization
to ﬁnd the exact design. The energy dissipation issue resulted per-
formance degradation is presented in Section 4 and the on-line tun-
ing scheme and the optimization problem is shown in Section 6.
3. Energy analysis for nonlinear shaper design
3.1. Introduction
Consider a forced Dufﬁng equation,
m€xþ kxþ k3x3 ¼ f ðtÞ; ð9Þ
where k (N/mm) and k3 (N/mm3) are the linear and nonlinear spring
fm-
f
ap
T
4 K.-S. Chen et al. /Mechatronics xxx (2008) xxx–xxx
ARTICLE IN PRESSfunction (i.e., Eq. (4)) can no longer have a clear and universal
expression and the nonlinear optimization process could be com-
putational extensive and costly. In this paper, a new approach to
ﬁnd the ZV and ZVD equivalent shapers (refer to two- and
three-step shapers) in Dufﬁng nonlinear systems is proposed
and implemented. In this work, we shall limit our scope to sin-
gle-degree-of-freedom harmonic systems with cubic or Dufﬁng
springs. Nevertheless, this approach works well even if systems
contain other nonlinearities such as electromagnetically actuation
[24]. The only limitation is that the energy dissipation mechanism
cannot be considered or must be negligible. (For systems with
light damping, this would be a reasonable approximation.) As
we shall see, by shifting the physical interpretation of input shap-
ing from cancellation of two responses to an energy and force bal-
ance viewpoint, it is possible to use the energy analysis to design
command shapers for strongly nonlinear systems.
In Section 4, the development of the nonlinear shaper shown in
Section 3 would be re-stated by the optimization approach men-
tioned above. However, due to the extensive effort in numerical
optimization process, we shall not attempt to formally perform
the optimization, but rather by generating some performance
maps to show the relations between the cost function and the sha-
per parameters. It would be shown that for the nonlinear systems
discussed in this work, the two- and three-step shapers repre-
sented the global minimum of the cost function, while the linear
shaper, based on linearized system, represents the local minimum
of the cost function and this difference can be treated as the conse-
quence of a sub-domain optimization.
If the energy dissipation mechanisms cannot be neglected, the
performance may not be as well as that demonstrated. If the damp-
ing is small, the performance variation can be withstood by the
unshaped
step input
f1
f2=
fα
fβ
2-step sh
Tα
fm3-step sha
Fig. 3. Schematic plot to deﬁne the de
Please cite this article in press as: Chen K-S et al., Design of command
tronics (2008), doi:10.1016/j.mechatronics.2008.08.005constants, respectively. Eq. (9) actually represents the dynamic
behavior of many ﬂexible structures subjected to large deformation
as brieﬂy addressed in Section 1. The objective here is to perform a
rest-to-rest maneuver for ﬂexible structures in ﬁnite time. Of
course, in order for the mass to stay at the target position indeﬁ-
nitely, as soon as it is brought to x = xm with zero velocity, a static
force of constant magnitude
fm ¼ kxm þ k3x3m ð10Þ
must be applied on the mass to counteract the elastic restoring
force.
Consider a step input. At t = 0 the magnitude of the applied
force is instantly raised from zero to fm. When the mass reaches
the target position x = xm, the work input by the applied force is
greater than the elastic potential energy stored in the spring.
Therefore, the mass would possess a ﬁnite kinetic energy and the
mass would oscillate about the target position x = xm.
To simplify matters, here we shall consider the special cases
where the applied force f(t) consists only of two and three ﬁnite
constant-magnitude steps (i.e., two- and three-step shapers), each
(except the ﬁnal step) lasting a certain period of time. Of course, as
is clear from the discussion above, the ﬁnal step of f(t) must have a
magnitude of fm and last indeﬁnitely. It will be shown below that
by properly adjusting the magnitude and duration of each step,
the rest-to-rest maneuver can be achieved. Also, such magnitudes
and durations can be determined simply on the basis of energy
conservation arguments, without the need of solving the nonlinear
differential Eq. (9) explicitly.
In the following, we present the detail in development of two-
and three-step shapers. For the purpose of clarity, the design ﬂow
is shown in Fig. 4 before derivation with all shaper parameter
deﬁned in Fig. 3. One may use Fig. 4 as a standard procedure to
f1
m-fα-fβ
shaped
step input
er
Tβ
fm
fm
f1
fα
fβper
sign parameters of input shapers.
shapers for residual vibration suppression in Dufﬁng ..., Mecha-
secure the mass there. Note that the equilibrium force magnitude
fm can be calculated from Eq. (10).
The energetics for the particular nonlinear spring–mass system
modeled by the forced Dufﬁng Eq. (9), and driven by the three-step
force management described above, is illustrated in Fig. 7. By
equating the work input by the ﬁrst step force fa and the stored
elastic potential at x = axm, we calculate that
fa ¼ kaxm=2þ k3a3x3m=4: ð14Þ
Furthermore, in order to bring the mass on to the target position
with zero kinetic energy, the work done by the second force step
over the remaining distance, (1  a)fbxm, must equal the discrep-
ancy between the elastic potential energies at x = axm and xm, which
equals U(xm) U(axm). The magnitude of the second force step
therefore is calculated to be
fb ¼ kð1þ aÞxm=2þ k3ð1þ aþ a2 þ a3Þx3m=4: ð15Þ
tronics xxx (2008) xxx–xxx
ARTICLE IN PRESSperiod of the resulting linear spring–mass system and the magni-
tude of the ﬁrst force step is exactly one half of the equilibrium
force magnitude, i.e., f1 = fm/2. This is exactly identical to ZV shaper
in linear systems. This is in fact an expected result that can be read-
ily interpreted on physical grounds.
For nonlinear vibration systems (kr– 0), however, the nice prin-
ciple of superposition no longer applies. Nevertheless, even in such
cases the required magnitudes of the ﬁrst and second force steps
(f1 and fm) still can be easily calculated by Eqs. (10) and (11) derived
above based on energy conservation arguments. (In particular, for
highly nonlinear systems, kr?1, we ﬁnd f1  fm=4  k3x3m=4. This
interesting limit will be studied numerically in Section 4.)
With slightly more efforts, the settle time T can also be calcu-
lated from Eq. (13), or by using the corresponding value of I(kr) di-
rectly read off from Fig. 6. We believed that the energy approach
proposed here is a more transparent way to understand input
shaping, and provides a more robust methodology for input shap-
ing parameter design for both linear and nonlinear vibration
systems.
3.3. Parameter sensitivity considerations
In a realistic system, parameter uncertainties generally are
inevitable. Therefore, while we have presented a methodology for
system parameter design, it is also equally important to investigate
howmuch residual vibration will be excited when the values of the
system parameters are in error. In preparation for addressing such
issues, recall that the two curves in Fig. 5 represent, respectively,
the work input by the applied force (dashed line) and the elastic
potential energy stored in the spring (solid curve). Also, the differ-
ence between the two curves indicates the amount of kinetic en-
ergy of the mass at each position.
As a result, it would therefore be very useful if a more sophisti-
cated input shaping scheme can be devised, so that the residual
vibration resulting from the timing error discussed above can be
minimized to some extent. Referring again to Fig. 5, the key to
residual vibration minimization is to keep the work input curve
as close to the elastic potential curve as possible, especially in
the vicinity of the equilibrium position x = xm. This can be seen
more clearly by considering the limiting case where the work input
curve is tangent to the elastic potential curve at x = xm. Accordingly,
if the target position is slightly missed when the second force step
kicks in, the residual kinetic energy still would be extremely small,
resulting in an insigniﬁcant amount of residual vibration.
However, keeping the kinetic energy of the mass small also im-
plies a longer time for the mass to settle in the target position.
Therefore, there is a trade-off between the settle time of the system
and the sensitivity of residual vibration amplitude to the timing er-
ror. To ‘optimize’ overall system performance, it then seems rea-
sonable to apply the force in a limited number of constant steps,
so that the single-segment work input curve in Fig. 5 is replaced
by a number of straight line segments that approximate the elastic
potential curve more closely. As a particular example, let us now go
on to discuss the applied force management consisting of three
constant steps.
3.4. Three-step applied force
It works similar to the above procedure, too. First, by applying a
static force of suitable magnitude fa, we bring the mass to an inter-
mediate position x = axm (0 < a < 1) with zero velocity. As soon as
the mass reaches the intermediate position, a second static force
of appropriate magnitude fb kicks in, so that the mass would then
6 K.-S. Chen et al. /Mechamove on to the target position x = xm with zero velocity. Of course,
at the moment the mass ﬁnally is brought to the target position, a
third (and ﬁnal) force step of magnitude fm should be applied to
Please cite this article in press as: Chen K-S et al., Design of command
tronics (2008), doi:10.1016/j.mechatronics.2008.08.005Note that the parameter a characterizing the intermediate position
can be chosen arbitrarily, and the force magnitudes fa,b can be cal-
culated accordingly from Eqs. (14) and (15). There therefore are an
inﬁnite number of ways to bring the mass to the target position
x = xm, and then secure it there with the equilibrium force of mag-
nitude fm. An interesting and important question then arises: What
is the ‘best choice’ of the value of a? This question may not be easy
to answer, because there does not exist a universal criterion for
determining the best choice among all possible candidates. How-
ever, based upon the energy arguments we have been using so
far, here we shall propose a way to pick a reasonably good value
for the parameter a and the effect of choosing different a would
be numerically studied in Section 5.3.
First, recall that the three-step force management under consid-
eration is motivated by the objective of approximating as closely as
possible the elastic potential curve (solid curve) in Fig. 7 by straight
line segments that represent the work input by the applied force.
In particular, the sensitivity of residual vibration amplitude to tim-
ing errors would be greatly reduced by matching the slopes of the
straight-line segments and the elastic potential curve at the inter-
mediate point x = axm and the target point x = xm.
Now, the slopes of the two straight line segments in Fig. 7 are
just the step force magnitudes fa,b, while the slopes of the elastic
potential curve at x = axm and xm are the elastic restoring forces
there: kaxm þ k3a3x3m and kxm þ k3x3m, respectively. The difference
in the slopes of the work input and elastic potential curves there-
fore is just the resultant force acting on the mass at each point. In
particular, at the two force-magnitude switching points x = axm
and xm, the resultant forces areFig. 7. Schematic energetics of a nonlinear spring–mass vibration system driven by
three constant force steps.
shapers for residual vibration suppression in Dufﬁng ..., Mecha-
J3 : The kinetic energy of the system as the ﬁrst time it reaches
the destination (xm) normalized by the potential energy at
the destination i.e. KE at xm/PE at xm. A smaller J3 implies that
less available energy for the subsequent vibration.
As one can see, these three cost functions are strongly related
and they would actually result in the same conclusion. However,
for a more complicate system, different solutions are expected
with respected to different cost functions. In this section, a few cost
maps for J1 are generated to evaluate the relationship between the
cost functions and the parameters of command shapers. For the
purpose of illustration, only two-step shapers are discussed. This
is because that there are only two independent parameters for
two-step shapers (i.e. F1 and T since F1 + F2 = 1) and three-dimen-
sional plots can be generated. On the other hand, there are four
independent parameters for three-step shapers and it is difﬁcult
to use 3D plots for visualization here.
Consider a normalized cubic nonlinear systemwithout damping
€xþ x3 ¼ f ðtÞ, as shown in Fig. 9a, three cost maps are generated to
evaluate the variation of the parameters of command shapers. In
parallel, linear ZV shaper based on end point linearization is also
included. The minimum costs (J1 = 0%) in these ﬁgures occurs at
T = 3.434 and F1 = 0.25, corresponding to the parameters of the
two-step shaper. On the other hand, the cost for the linearized
ZV parameters is 42.4%.
Next, let us consider the same system with damping. That is,
€xþ 0:2 _xþ x3 ¼ f ðtÞ (equivalences to a damping ratio of 6% based
on end point linearization) for Eq. (24). The cost map is then re-gen-
erated and is shown in Fig. 9b. At this time, a (F1,T) = (0.324,3.32)
would yield the minimum J1 (= 0). The undamped solution
0.1
0.15
0.2
0.25
0.3
0.35
0.4
0.45
0.5
3.2
3.3
3.4
3.5
3.6
3.7
0
5
10
15
20
25
30
35
40
45
F1(Strength of the first impulse)T (Timing of the second impulse) 
J1
 (R
es
id
ua
l V
ib
ra
tio
n 
Pe
rc
en
ta
ge
 %
)
35
40
45
ta
ge
%
)
minimum 
8 K.-S. Chen et al. /Mechatronics xxx (2008) xxx–xxx
ARTICLE IN PRESS3.2
3.4
3.6
3.8
0
5
10
15
20
25
30
J1
(R
es
id
ua
l V
ib
ra
tio
n 
Pe
rc
en
minimum 0.23T (Timing of the second impulse)
Fig. 9. The cost functions and optimization for the cubic nonl
Please cite this article in press as: Chen K-S et al., Design of command
tronics (2008), doi:10.1016/j.mechatronics.2008.08.0050.25
0.3
0.35
0.4
0.45
0.5
0.55F1 (Strength of the first impulse)
inear system (a) without damped and (b) with damping.
shapers for residual vibration suppression in Dufﬁng ..., Mecha-
phenomena, such as aging of mechanical elements and stress
relaxation, etc. A successful shaper design therefore must be robust
enough to resist these possible parameter variations. As we shall
see, despite that the three-step shaper has an apparently longer
rise time; it is much less sensitive to parametric variations than
the two-step shaper. For this reason, the three-step shaper may
be a more recommendable engineering solution to residual vibra-
tion control.
To justify the above argument, next we study the sensitivities
of two-step and three-step shapers with respect to parametric
variations. As pointed out above, for the present case study, the
uncertainties and/or variations of system parameters can be conve-
niently lumped into the variation of the single parameter d in Eq.
(23). Meanwhile, the two-step and three-step shapers designed
on the basis of the ideal dynamic equation, Eq. (22), still are used
for the input function f(t) in Eq. (23). Therefore, once d differs from
zero, residual vibration generally occurs. Here, to be deﬁnitive, the
magnitude of residual vibration is deﬁned as the half of the maxi-
should be applied cannot be accurately determined, and thus resid-
ual vibration would be unavoidable.
Fig. 12 shows the effect of damping coefﬁcient on the amount of
residual vibration. For the purpose of obtaining feeling qualita-
tively, a damping coefﬁcient 0f 0.5 equals a damping ratio of 15%
based on the end-point linearization. It is seen that the perfor-
mances of both shapers degrade. However, the system incorpo-
rated with the three-step shaper is much more robust than that
by the two-step shaper, and the residual vibration can be limited
to be under 10%. On the other hand, the two-step shaper shows
much worse results. However, for extremely light damping, the
two-step shaper should still be applicable. It is also important to
note that the residual vibration ﬁrst increases with damping coef-
ﬁcient and then decreases when damping further increases. This is
because small damping effectively alters the exact shaping param-
eters, resulting in residual vibration. On the other hand, a further
increase in system damping would greatly enhance energy dissipa-
tion and eventually reduce the vibration.
5.3. The effect of a
The effect of choosing different a in three-step shaper design is
discussed by the cubic nonlinear example (shown in Section 5.2).
A typical moving history of the system subjected to three-step
shaped commands designed using various a is shown in Fig. 13b.
r
5
7.5
10
12.5
R
es
id
ua
l V
ib
ra
tio
n 
(%
) 
Two-Step Shaper
Three-Step Shaper
10 K.-S. Chen et al. /Mechatronics xxx (2008) xxx–xxx
ARTICLE IN PRESSmum peak-to-peak vibration amplitude divided by the target position.
Fig. 11 summarizes the relationships between the uncertainty
parameter (1 + d) and the residual vibration magnitude for the
two-step and three-step shapers. It is clearly seen that the three-
step shaper is more robust than the two-step shaper. In addition,
both the sensitivity curves exhibit asymmetric behavior in the
sense that positive equivalent mass variation induces less residual
vibration than that induced by negative mass variation. Note that
the traditional sensitivity curve represented by the uncertainty of
natural frequency vs. residual vibration (see Fig. 2 for example)
cannot be applied in highly nonlinear situations because natural
frequencies are now amplitude dependent and thus cannot be eas-
ily deﬁned. On the other hand, the sensitivity curves deﬁned in
Fig. 11 can actually be adapted to any linear systems, because
the variation of natural frequency can be attributed to the change
of physical parameters such as mass or stiffness, which is covered
by the dimensionless parameter d. It can be seen that the robust-
ness of the two-step shapers is essentially the same as that of
the ZV shapers but the three-step shapers are slightly inferior to
the corresponding ZV shapers in terms of the robustness.
In general, the incorporation of system damping imposes two
different effects on vibratory behavior. First, since damping dissi-
pates kinetic energy, the residual vibration should consequently
be reduced. Second, the nonlinear shapers are developed on the
basis of energy conservation. So, as damping is not negligible, the
results developed in Section 3 would contain errors. Consequently,
the magnitudes of the step forces and the exact times when they
0
10
20
30
40
50
60
70
80
0.4 0.6 0.8
R
es
id
ua
l V
ib
ra
tio
n 
(%
) 
Two-Step Shaper
Three-Step Shaper
ZVD ShapeEquivalen
Fig. 11. The sensitivity curves of the two-step and three-step shapers wit
Please cite this article in press as: Chen K-S et al., Design of command
tronics (2008), doi:10.1016/j.mechatronics.2008.08.0051 1.2 1.4 1.6
ZV Shaper
0 0.1 0.2 0.3 0.4 0.5
0
2.5
Normalized Damping Coefficient (b)
Fig. 12. The effect of damping coefﬁcient to the residual vibration of the cubic
nonlinear system.t Mass (1+δ)
h respect to equivalent mass variation of the cubic nonlinear system.
shapers for residual vibration suppression in Dufﬁng ..., Mecha-
tron
ARTICLE IN PRESS0.5  
1
1.5  
rm
a
liz
e
d 
Di
sp
la
ce
m
en
t 
ZV ZVD
2-step 
3-step 
12 K.-S. Chen et al. /Mechamization process can be replaced by some easier approaches. For
example, if the system is linear, by linear superposition principle
and the solution of linear ODEs, the linear command shapers can
be developed. On the other hand, the method proposed in this
work can be used to ﬁnd the corresponding shaper for cubic or
Dufﬁng nonlinear systems. In comparison with linearized shaper
design and direct optimization by Monte Carlo method, the en-
ergy-based method is more transparent and general than the tradi-
tional approach for linear shaper design. A general design ﬂow
(shown in Fig. 4) has also been provided to guide the design pro-
cess. It is also important to point out that by this approach, there
0 5
0N
o
Norma
0 0.5 1
0
0.5  
1
1.5  
Norma
N
or
m
a
liz
e
d 
Di
sp
la
ce
m
en
t
3-st
2-step 
ZV 
Fig. 14. The response of the Dufﬁng nonlinear system subjected to various sh
0.6  0.7  0.8  0.9
0
 
10  
20  
30  
40  
Norma
0.6  0.7  0.8  0.9
Norma
R
es
id
ua
l V
ib
ra
tio
n 
(%
) 
0
10
20
30
40
R
es
id
ua
l V
ib
ra
tio
n 
(%
) 
 
 
 
 
 
Fig. 15. The sensitivity curve of the two- and three-step shapers with respect to mass vari
Please cite this article in press as: Chen K-S et al., Design of command
tronics (2008), doi:10.1016/j.mechatronics.2008.08.00530.1 1.1 ( )x x x f t+ + =
 
ics xxx (2008) xxx–xxxis no concern on switching between linear and nonlinear shaper
design since the linear ZV and ZVD shapers are merely special cases
of the corresponding nonlinear two- and three-step shapers. It is
also interesting to point out that multiple solutions exist in design
nonlinear three-step shapers. In this paper, we proposed a criterion
to optimize design by minimizing the residual forces. Other possi-
ble optimization criteria may be further explored but it is beyond
the scope of this paper.
This method can also be further applied to dynamic systems
with other type of nonlinearities such as the 1/x2 nonlinearities
commonly existed in electromagnetically or electrostatically actu-
10 15
lized Time
1.5 2 2.5 3
lized Time
ep 
ZVD
310 11 ( )x x x f t+ + =
 
aped step inputs. (a): strongly nonlinear and (b) weakly nonlinear cases.
1 1.1 1.2 1.3  1.4
lized Mass
1 1.1 1.2 1.3  1.4
lized Mass
2-step 
3-step 
3-step 
2-step 
30.1 1.1 ( )x x x f t+ + =
 
310 11 ( )x x x f t+ + =
 
ation for the Dufﬁng nonlinear systemwith (a) strongly and (b) weakly nonlinearity.
shapers for residual vibration suppression in Dufﬁng ..., Mecha-
tron
ARTICLE IN PRESSto ﬁnd the corresponding solution. However, the major difﬁculty
for nonlinear optimization is that the cost function (usually the
2-norm of the residual vibrations) is difﬁcult to be written in an
analytical form (e.g., Eq. (4)) for nonlinear optimization problem.
As a result, it would be computational intensive and the solution
would be lack of physical meaning. The method we proposed, on
the other hand, is an analytical based solution. In together with a
possible modiﬁcation scheme to compensate the modeling error
and uncertainties (introduced in Section 6), should have signiﬁcant
physical insight and should be very useful for engineering applica-
tions. Nevertheless, important concepts in optimization such as the
change of cost function before and after introducing parameter
variations could be used as an alternative indicator for evaluating
the robustness of the speciﬁc shaper.
7. Summary and conclusion
0 1 2 3 4 5 6 7 8 9 10
0
0.5
1
1.5
Normalized Time
N
or
m
a
liz
e
d 
Di
sp
la
ce
m
en
t
step  
3- step  
ZVD  
Tuned 
2-step 
2- step 
ZV  
Fig. 17. A comparison in performance between the original and the online tuning
optimized two-step shapers.
14 K.-S. Chen et al. /MechaControl of residual vibration is crucial for numerous mechatron-
ics applications. In certain applications the controlled structures
are highly nonlinear and lightly damped. The traditional input
shaping technique, which utilizes destructive interference works
well for linear and weakly nonlinear systems, but shows little ef-
fect on systems with strong nonlinearity. In this paper, a robust in-
put shaper design methodology for single-degree-of-freedom
systems containing Dufﬁng nonlinearity is developed by an energy
approach. The linear zero-vibration (ZV) and zero-vibration-and-
derivative (ZVD) shapers are shown to be the special cases of the
general nonlinear shapers. By this approach, the two-step and
three-step shapers are developed, and the robustness of these
shapers is investigated by two case studies. The results show that
the three-step shaper is sufﬁciently robust to resist signiﬁcant
amounts of parameter variations. However, it is also found that
the presence of damping can effectively disturb the energy ﬂow
and thus induce residual vibration. For the three-step shaper the
inﬂuence of damping is contained to within 10% residual vibration,
and hence is not of signiﬁcant concern. On the other hand, the two-
step shaper is less robust. Nevertheless, its performance can be fur-
ther optimized by an online tuning scheme proposed in this paper.
Finally, the equivalence between the nonlinear shaper design and
the nonlinear optimization process is also discussed.
In summary, the contributions of this work are in several as-
pects. First, this work proposes an energy approach to handle the
motion induced vibration of systems with common Dufﬁng nonlin-
Please cite this article in press as: Chen K-S et al., Design of command
tronics (2008), doi:10.1016/j.mechatronics.2008.08.005earity and developed a methodology to ﬁnd the corresponding
nonlinear command shapers. This represents a more general devel-
opment of input shaping scheme. Second, the correlation between
vibration suppression and motion planning on an optimal motion
planning perspective is obtained. For systems with more compli-
cated dynamics, one could use numerical schemes such as Monte
Carlo method to obtain the corresponding command shapers.
Third, the although the scope of this work is limited in Dufﬁng sys-
tems, the proposed approach works well even if systems contain
other nonlinearities such as electromagnetically actuation. Finally,
an on line tuning scheme is proposed to provide a more practical
approach for engineers to optimize the performance of input
shapers.
Acknowledgement
This work was supported by the National Science Council of Tai-
wan through Grants NSC91-2212-E-006-082, and NSC92-2212-E-
006-116 and ITRI under contracts 95M001, 96C044, and 97C073.
References
[1] Jones S, Ulsoy AG. An approach to control input shaping with application to
coordinate measuring machines. ASME J Dyn Measure Control 1999;121:
242–7.
[2] Preumont A. Vibration control of active structures, an introduction. Kluwer
Academic Publication; 1997.
[3] Singhose W, Bohlke K, Seering W. Fuel-efﬁcient pulse command proﬁles for
ﬂexible spacecraft. AIAA J Guid Control Dyn 1996;19(4):954–60.
[4] Singh T, Vadali SR. Input-shaped control of three-dimensional maneuvers of
ﬂexible spacecraft. AIAA J Guid Control Dyn 1996;16:1061–8.
[5] Mohamed Z, Tokhi MO. Command shaping techniques for vibration control of a
ﬂexible robot manipulator. Mechatronics 2004;14:69–90.
[6] Marsh ER, Slocum AH. An integrated approach to structural damping. Precision
Eng 1996;18:103–9.
[7] Lee C-K, Chiang W-W, O’Sullivan T. Piezoelectric modal sensors and actuators
achieving critical damping on a cantilever plate, AIAA SDM conference AIAA
paper 89-1390-CP; 1989.
[8] Campbell ME, Crawley EF. Asymptotic linear quadratic control for lightly
damped structures. AIAA J Guid Control Dyn 1996;19:969–71.
[9] Smith OJM. Posicast control of damped oscillatory systems. Proc IRE
1957:1249–55.
[10] Pao LY, Lau MA. Robust input shaper control design for parameter variations in
ﬂexible structures. ASME J Dyn Syst Measure Control 2000;122:63–70.
[11] Miu DK. Mechatronics, electromechanics and contromechanics. New
York: Springer; 1992.
[12] Singer NC, Seering WP. Preshaping command inputs to reduce system
vibration. ASME J Dyn Syst Measure Control 1990:76–82.
[13] Tuttle T. Creating Time-optimal commands for linear systems, PhD thesis,
Massachusetts Institute of Technology, Cambridge, MA; 1997.
[14] Singhose WE. Command generation for ﬂexible systems, PhD thesis,
Department of Mechanical Engineering, Massachusetts Institute of
Technology, Cambridge, MA; 1997.
[15] Singh T, Vadali SR. Robust time-optimal control: frequency domain approach.
AIAA J Guid Control Dyn 1994;17:346–53.
[16] Shan J, Liu H, Sun D. Modiﬁed input shaping for a rotating single-link ﬂexible
manipulator. J Sound Vibrat 2005;285:187–207.
[17] Kozak K. Robust command generation for nonlinear systems, PhD thesis,
Georgia Institute of Technology; 2003.
[18] Singhose W, Pao L. Comparison of input shaping and time-optimal ﬂexible-
body control. Control Eng Prac 1997;5:459–67.
[19] Pao L, La-Orpacharapan C. Shaped time-optimal feedback controllers for
ﬂexible structures. ASME J Dyn Syst Measure Control 2004;126:173–86.
[20] Khorrami F, Jain S, Tzes A. Adaptive nonlinear control and input preshaping for
ﬂexible- link manipulators. In: American Control Conference, San Francisco,
CA; 1993.
[21] Stergiopolos J, Tzes A. Adaptive input shaping for nonlinear systems: a case
study. In: Proceedings of 13th mediterranean conference control and
automation; 2005. p. 188–93.
[22] Gorinevsky D, Vukovich G. Nonlinear input shaping control of ﬂexible
spacecraft reorientation maneuver. J Guid Control Dyn 1998;21:264–70.
[23] Choi C, Jong SK. Robust control of positioning systems with a multi-step bang-
bang actuator. Mechatronics 1996;6:867–80.
[24] Md Zain MZ, Tokhi MO, Mohamed Z. Hybrid learning control schemes with
input shaping of a ﬂexible manipulator system. Mechatronics 2006;16:
209–19.
ics xxx (2008) xxx–xxx[25] Borovic B, Liu AQ, Popa D, Cai H, Lewis FL. Open-loop versus closed-loop
control of mems devices: choices and issues. J Micromech Microeng 2005;15:
1917–24.
shapers for residual vibration suppression in Dufﬁng ..., Mecha-
                             Editorial Manager(tm) for Journal of Engineering Mathematics
                                  Manuscript Draft
Manuscript Number: 
Title: Asymptotic analysis of a two-step input shaping scheme for suppressing motion-induced 
residual vibration of nonlinear mechanical systems
Article Type: Manuscript
Section/Category: 
Keywords: Input shaping, Residual vibration suppression, Nonlinear spring--mass system, Energy 
method, Asymptotic analysis, Input force correction
Corresponding Author: Professor Tian-Shiang Yang, Ph.D.
Corresponding Author's Institution: National Cheng Kung University
First Author: Tian-Shiang Yang, Ph.D.
Order of Authors: Tian-Shiang Yang, Ph.D.; Hsien-Tang Kao, BS; Ian Hu, MS
Manuscript Region of Origin: 
Abstract: Here we consider a single-degree-of-freedom nonlinear spring--mass system, subjected 
to a particular shaped input force whose magnitude varies with time in a piecewise-constant 
manner.  The goal is to bring the point mass in the model system from initial rest to a prescribed 
new equilibrium position without exciting any residual vibration.  If, ideally, the potential energy 
associated with the elastic spring is known as a function of its elongation, the magnitude and 
execution time of each force step that serve the abovesaid purpose can be calculated by analyzing 
the mechanical energy flow.  However, in practice the potential function almost inevitably contains 
a small estimation error, and residual vibration would be excited by the input force so calculated.  
Using asymptotic techniques, here we calculate the residual vibration excited by a two-step input 
Asymptotic analysis of a two-step input shaping scheme
for suppressing motion-induced residual vibration of
nonlinear mechanical systems
Tian-Shiang Yang∗, Hsien-Tang Kao and Ian Hu
Department of Mechanical Engineering, National Cheng Kung University,
1 University Road, Tainan, Taiwan 701, R.O.C.
Abstract. Here we consider a single-degree-of-freedom nonlinear spring–mass sys-
tem, subjected to a particular shaped input force whose magnitude varies with time
in a piecewise-constant manner. The goal is to bring the point mass in the model
system from initial rest to a prescribed new equilibrium position without exciting
any residual vibration. If, ideally, the potential energy associated with the elastic
spring is known as a function of its elongation, the magnitude and execution time of
each force step that serve the abovesaid purpose can be calculated by analyzing the
mechanical energy flow. However, in practice the potential function almost inevitably
contains a small estimation error, and residual vibration would be excited by the
input force so calculated. Using asymptotic techniques, here we calculate the residual
vibration excited by a two-step input force with slightly incorrect task time and force
magnitudes. It is also demonstrated that, by comparing the closed-form results of
the asymptotic analysis with online measurements of the excited residual vibration,
the shape of the two-step input force (characterized by the task time and force
magnitudes) can be corrected iteratively, thereby suppressing the residual vibration.
Keywords: Input shaping, Residual vibration suppression, Nonlinear spring–mass
system, Energy method, Asymptotic analysis, Input force correction
1. Introduction
Residual vibrations generally are excited when flexible machine mem-
bers and mechanical structures move (in order to carry out a certain
task), and thus deteriorate the performance of such systems. Usually
the residual vibrations can be suppressed by passive and/or active
damping enhancement techniques [1, Chapters 3 and 6]. When it is
impractical to implement sufficient damping on the system in question,
one then has to resort to “input shaping” [2, 3]. Basically, the idea is
to shape the input command, which determines the actuating force or
movement applied on a certain control point, of the system in a suitable
way that suppresses the undesirable residual vibrations.
For linear systems, input shaping can be readily understood as a
decomposition of the input command of the system into a series of
∗ Author for correspondence; e-mail: tsyang@mail.ncku.edu.tw.
c© 2008 Kluwer Academic Publishers. Printed in the Netherlands.
jem-nonlshaping.tex; 30/06/2008; 1:58; p.1
Manuscript
Click here to download Manuscript: JEM-NonlShaping.tex Click here to view linked References
Asymptotic analysis of input shaping for residual vibration suppression 3
eralized, and used to design input shaping schemes for practically any
SDOF mechanical systems, provided that the elastic potential energy
is known as a function of a suitable generalized displacement describing
the instantaneous configuration of the system. For instance, the energy
approach has been successfully applied to design input shaping for an
electromagnetically actuated nonlinear structure [17]. Note, however,
that in practice the potential function of a mechanical system seldom
is known exactly, and can only be estimated with reasonable accuracy.
Sometimes it may even vary slowly with time due to system aging. In
other words, the potential function used to calculate the input force
usually contains a small estimation error. Using a shaped input force
so calculated on a practical system would then excite a certain amount
of residual vibration, which may be detrimental to the performance of
precision machines. The purpose of the present work therefore is to
calculate the residual vibration excited in such cases.
Briefly, here the simple SDOF model of Yang et al. [15, 17] is
generalized, so that the elastic potential energy takes an arbitrary
functional form (except for some physically relevant minor restrictions;
see Sect. 2). Moreover, the elastic potential function is explicitly de-
composed into a nominal (estimated) potential and a small estimation
error. Using the nominal potential, the magnitude and execution time
of each force step in a multi-step input force can be calculated following
the energy approach of Yang et al. [15, 17], and the detail is discussed
in Sect. 2. Then, in Sect. 3, the residual vibration excited by a two-step
input force with slightly incorrect task time and force magnitudes (due
to the potential function estimation error) is calculated using asymp-
totic techniques. It is also demonstrated in Sect. 4 that, by comparing
the closed-form results of the asymptotic analysis with online mea-
surements of the excited residual vibration (which are produced here
numerically, however), the shape (i.e., task time and force magnitudes)
of the two-step input force can be corrected using a simple iterative
procedure, so as to suppress the residual vibration. Also, some remarks
are given in Sect. 5 to conclude this paper.
2. Formulation and basics of input force design
2.1. The model problem
Consider a point mass m attached to an elastic spring, and acted upon
by an external force f(t) that varies with time in a certain manner.
The goal is to move the point mass from an initial equilibrium position,
which is assigned to be the origin of the spatial coordinate (x = 0), to a
jem-nonlshaping.tex; 30/06/2008; 1:58; p.3
Asymptotic analysis of input shaping for residual vibration suppression 5
Figure 1. Energetics of the model system with a two-step input force, for ǫ = 0.
in dimensionless form. But as explained above, a more suitable value
for φ0 sometimes may be needed.] Meanwhile, assuming that the point
mass initially is at rest, the initial conditions for (2) are
x(0) = x˙(0) = 0. (4)
The task here is to move the point mass from x = 0 to x = 1. In
preparation for the mechanical energy analysis below, let us multiply
(2) by x˙ and integrate the result to obtain
d
{
x˙2
2
+ φ(x) + ǫψ(x)
}
= f(t) dx, (5)
which simply states that the external work input f(t) dx is stored as
the kinetic energy x˙2/2 of the point mass and the potential energy
φ(x) + ǫψ(x) of the spring, without any loss of mechanical energy.
2.2. Input force design for the ideal case ǫ = 0
For now, let us assume that the potential function associated with the
elastic spring is known with infinite accuracy, i.e., ǫ = 0, and briefly dis-
cuss the technicalities of the mechanical energy analysis of Yang et al.
[15, 17]. As a specific example, consider the particular input force that
consists of two consecutively applied forces of constant magnitudes:
f(t) = f1 H(t) + (f2 − f1)H(t− T ), (6)
where H(t) is Heaviside’s step function. The magnitudes of the first
and second force steps, f1 and f2, and the duration of the first force
jem-nonlshaping.tex; 30/06/2008; 1:58; p.5
Asymptotic analysis of input shaping for residual vibration suppression 7
may think of it as consisting of two “partial forces” of the same (unit)
magnitude but separated application times. Note also that the sep-
aration time T = T0/2 is precisely what is needed for destructive
interaction between the responses of the system to the two partial
forces. In fact, as can be readily derived from (2) with ǫ = 0 and
φ(x) = x2, for a unit-magnitude input force f(t) = H(t), the response
of the system is x(t) = x0(t) = [1 − cos(2πt/T0)]/2 for t > 0. More-
over, when an additional unit-magnitude input force is applied at a
delayed instant t = τ , so that f(t) = H(t) + H(t − τ), the overall
system response for t > τ is calculated by linear superposition to be
x(t) = x0(t) + x0(t− τ) = 1− cos(πτ/T0) · cos[2π(t− τ/2)/T0]. It then
transpires that the residual vibration has an amplitude of cos(πτ/T0),
and therefore can be suppressed simply by choosing the time delay τ
to be T = T0/2.
The energy analysis and design methodology of input forces ex-
plained above are particularly useful for nonlinear systems, where the
principle of superposition is inapplicable. Application of input shaping
on such systems will be discussed in Sect. 4 using a specific example.
Note also that the above calculations can be readily adapted to design
a multi-step input force. For example, a three-step input force can be
composed by using f1 = φ(α)/α to bring the point mass from x = 0
to an intermediate position x = α (0 < α < 1) with zero velocity,
f2 = {φ(1)−φ(α)}/(1−α) to move the point mass onward to the target
position x = 1 (again with zero velocity), and finally f3 = φ
′(1) to
secure the point mass there. The execution times of the second and the
third force steps can be calculated accordingly, using (8) with similar
expressions for the kinetic energy. It is intuitively clear that an input
force having more steps requires a longer task time, but would excite
less residual vibration when the potential function used to determine
the input force contains an estimation error (see [14] for example).
The residual vibration excited by a two-step input force with slightly
incorrect force magnitudes and task time (due to the potential function
estimation error) is calculated in the next section.
3. Asymptotic calculation of residual vibration
Suppose now that the nominal potential function φ(x) contains a small
error (i.e., ǫ 6= 0); some residual vibration then would be excited when
the input force designed on the basis of φ(x) is applied on the system.
In order to calculate the residual vibration so excited, we find it useful
to analyze first the response of the system when the first force step
of magnitude f1 = φ(1) is applied indefinitely, i.e., f(t) = φ(1)H(t).
jem-nonlshaping.tex; 30/06/2008; 1:58; p.7
Asymptotic analysis of input shaping for residual vibration suppression 9
Substitution of (10) into (9) yields an identity at leading order. At the
next order, O(ǫ), we have φ(1) y1 = φ
′(1) y1 + ψ(1), and hence
y1 =
ψ(1)
φ(1)− φ′(1) . (11)
Similarly, at O(ǫ2), (9) gives φ(1) y2 = φ
′(1) y2 + φ
′′(1) y21/2 + ψ
′(1) y1,
from which it is obtained that
y2 =
ψ(1)ψ′(1)
[φ(1) − φ′(1)]2 +
φ′′(1)ψ(1)2
2[φ(1) − φ′(1)]3 . (12)
We have thus calculated the extreme distance y up to O(ǫ2) accuracy.
For constant f = f1 = φ(1) and ǫ 6= 0, the mechanical energy
equation (5) gives x˙2/2 + φ(x) + ǫψ(x) = φ(1)x. The exact expression
for the half-period Ty therefore is
Ty =
∫ y
0
dx
x˙
=
1√
2
∫ y
0
{φ(1)x − φ(x)− ǫψ(x)}−1/2dx. (13)
To expand Ty in powers of ǫ, let us write x = ηy. Accordingly, the
integrand in (13) is expanded as follows:
{φ(1)x − φ(x)− ǫψ(x)}−1/2
= {φ(1) η − φ(η) + ǫ{y1η [φ(1)− φ′(η)]− ψ(η)}
+ ǫ2{y2η [φ(1) − φ′(η)] − y1η ψ′(η)− y21η2φ′′(η)/2} + · · ·}−1/2
= g
−1/2
0 − ǫg1g−3/20 /2− ǫ2(g2g−3/20 /2− 3g21g−5/20 /8) + · · · ,
with g0(η) = φ(1) η − φ(η), g1(η) = y1η [φ(1) − φ′(η)] − ψ(η), and
g2(η) = y2η [φ(1)−φ′(η)]− y1η ψ′(η)− y21η2φ′′(η)/2. Upon substitution
of the expanded integrand into (13), one obtains
Ty = T + ǫT1 + ǫ
2T2 + · · · , (14)
with T given by (8) already, and
T1 =
1
2
√
2
∫ 1
0
g0(η)
−3/2 {2y1g0(η)− g1(η)} dη, (15)
T2 =
1
8
√
2
∫ 1
0
g0(η)
−5/2
{
8y2g0(η)
2 − 4y1g1(η) g0(η)
−4g2(η) g0(η) + 3g21(η)
}
dη. (16)
jem-nonlshaping.tex; 30/06/2008; 1:58; p.9
Asymptotic analysis of input shaping for residual vibration suppression 11
Upon substitution of the above result into (17), we deduce that (y −
z)1/2 = O(ǫ), i.e., the distance between the force magnitude switching
position x = z and the extreme position x = y is of O(ǫ2) only. To be
more precise, the leading-order terms of (17) are collected below:
√
2 [φ′(1)− φ(1)]−1/2(y − z)1/2 = ±ǫT1 +O(ǫ2),
which gives
y − z = ǫ2[φ′(1)− φ(1)]T 21 /2 +O(ǫ3) (18)
for both T > Ty and T < Ty. Combining then (18) with (10), we obtain
z = 1 + ǫy1 + ǫ
2
{
y2 − [φ′(1) − φ(1)]T 21 /2
}
+O(ǫ3). (19)
Now, for t > T , the second force step of magnitude f2 = φ
′(1) is
applied. As seen in Fig. 2, this would move the point mass further
forward to x = z+, where the work input is completely stored in the
spring as potential energy. The input force of magnitude f2, however,
is weaker than the restoring spring force there, so that as soon as the
point mass reaches x = z+ it starts to move backward. Also, as the
point mass moves backward, the restoring spring force decreases in
magnitude, and eventually becomes weaker than the input force. The
point mass then slows down, and goes as far backward as to x = z−; it
then moves back and forth between x = z− and x = z+.
In light of the above description, it is clear that the work input
equals the elastic potential energy stored in the spring at the extreme
positions x = z± of the residual vibration (see Fig. 2), so
φ(1) z + φ′(1) (z± − z) = φ(z±) + ǫψ(z±). (20)
To solve for z±, we expand them in powers of ǫ:
z± = z±0 + ǫz
±
1 + ǫ
2z±2 + · · · . (21)
Substituting then (21) into (20), and using (19) as well, it is found at
leading order, O(1), that φ(1) − φ′(1) = φ(z±0 )− φ′(1) z±0 , so both of
z±0 = 1. (22)
Next, at O(ǫ), we have [φ(1)−φ′(1)] y1 = ψ(1), which is an identity in-
deed because of (11), and hence no new information is gained. At O(ǫ2),
(20) gives [φ(1) − φ′(1)]{y2 − [φ′(1) − φ(1)]T 21 /2} = φ′′(1) (z±1 )2/2 +
ψ′(1) z±1 . This quadratic equation of z
±
1 has two roots; the greater one
is z+1 , and the other is z
−
1 :
z±1 = −
ψ′(1)
φ′′(1)
±
{[
ψ′(1)
φ′′(1)
]2
− 2y2[φ
′(1) − φ(1)]
φ′′(1)
+
T 21 [φ
′(1)− φ(1)]2
φ′′(1)
}1/2
. (23)
jem-nonlshaping.tex; 30/06/2008; 1:58; p.11
Asymptotic analysis of input shaping for residual vibration suppression 13
the spring by an additional unit length, is {fs(x) − fs(1)}/(x − 1) =
φ′′(1) +O(ǫ).]
This then completes our calculation of the residual vibration excited
by a slightly incorrectly designed two-step input force. Note, however,
that the estimation error ψ(x) generally is not known a priori. The
asymptotic results derived above therefore cannot be used directly, and
in the next section (Sect. 4) we shall discuss how they can assist in
correcting the two-step input force. As a summary of the asymptotic
results, however, let us discuss a simple example below.
3.3. A simple (linear) example
Consider for now that φ(x) = ψ(x) = x2, which corresponds to a linear
spring whose actual spring constant is k = 2(1 + ǫ). Without knowing
the exact functional form of the estimation error ψ(x), one may use (7)
and (8) to derive the two-step input force f(t) = H(t)+H(t−T ) with
T = T0/2 = π/
√
2, as discussed in Sect. 2.2. However, since the actual
free vibration period of the point mass is T0A = 2π/
√
k = T0(1+ ǫ)
−1/2
instead of T0, some residual vibration will be excited by the ideal input
force given above. For this simple linear system, the response of the
system actually can be readily calculated from the equation of motion
(2) subject to the initial conditions (4); we find that the exact system
response for t > T is
x(t) =
1
1 + ǫ
− cos(πT/T0A)
1 + ǫ
· cos 2π(t− T/2)
T0A
. (29)
Note that in addition to the residual vibration of amplitude
cos(πT/T0A)
1 + ǫ
=
1
1 + ǫ
cos
π
√
1 + ǫ
2
and period T0A, the mean position of the point mass x = 1/(1+ ǫ) also
deviates from the target position x = 1.
Now, the asymptotic result (28) gives TRV = T0 + O(ǫ), while the
exact residual vibration period can be expanded in powers of ǫ to give
the higher-order terms: T0A = T0 · (1− ǫ/2+3ǫ2/8+ · · ·). For nonlinear
problems, however, the residual vibration period TRV generally can
not be calculated in closed form, and the asymptotic result (28) would
provide a useful first estimate for TRV . Moreover, using (10), (11) and
(12), we find y = 1 − ǫ+ ǫ2 + O(ǫ3); the exact result is y = 1/(1 + ǫ),
as can be readily obtained by solving (9). From (14), (15) and (16),
it is calculated that the half-period of the system response to f(t) =
H(t) is Ty = (π/
√
2) · (1 − ǫ/2 + 3ǫ2/8) + O(ǫ3), while (13) gives the
exact expression Ty = T0A/2. The exact result simply is a reminder
jem-nonlshaping.tex; 30/06/2008; 1:58; p.13
Asymptotic analysis of input shaping for residual vibration suppression 15
Meanwhile, using (25), we estimate
ǫψ′(1) = φ′′(1) (1 − xRV ) +O(ǫ2), (32)
and hence update the magnitude of the second force step by
f2 ≈ φ′(1) + φ′′(1) (1 − xRV ), (33)
where xRV = (z
++z−)/2 is the mean position of the residual vibration.
It remains to correct the task time T . To that end, using (12), (30)
and (32), first we rewrite (24) as ARV = {(1−xRV )2+2 (1−xRV ) (z−
1) + (z − 1)2 + (ǫT1)2[φ′(1) − φ(1)]2/φ′′(1)}1/2 +O(ǫ2), which has two
roots for ǫT1 [correct to O(ǫ)]. Suppose that x˙ > 0 at t = T . The
point mass then would still be moving toward x = y when the force
magnitude switches from f1 to f2 (see Fig. 2). In that case, the force
magnitude switching really should be delayed, and the positive root for
ǫT1 is chosen; otherwise one chooses the negative root for ǫT1. With
the above decision rule, the task time T is updated by
Ty ≈ T ±
{
φ′′(1)
[
A2RV − (z − xRV )2
]}1/2
φ′(1)− φ(1) , (34)
where ARV = (z
+ − z−)/2 is the residual vibration amplitude. In the
expressions (31), (33) and (34) for correcting the input force param-
eters, φ(1) and φ′(1) are simply the current estimates for the force
magnitudes f1 and f2, while φ
′′(1) ≈ (2π/TRV )2 as given by (28).
Recall that at the mean position of the residual vibration x = xRV ,
the input force and restoring spring force have approximately the same
magnitude φ′(1). Meanwhile, the effective spring constant for x ≈ 1
is given approximately by φ′′(1). An interesting interpretation for (33)
therefore is as follows: By observing the distance 1− xRV between the
mean and target positions, one may estimate accordingly that the mag-
nitude of the second force step needs to be increased by φ′′(1) (1−xRV ),
in order to secure the point mass at the target position. Interpretations
for (31) and (34), however, perhaps are not as simple, and essentially
amount to carrying out the asymptotic calculations in Sect. 3. Note
also that, alternatively, one may calibrate the potential function by
static force and displacement measurements, and then recalculate the
input force parameters accordingly. The expressions (31), (33) and (34)
for correcting such parameters, however, involve only quantities that
can be measured online. This enables one to correct the input force
parameters without stopping the system, and therefore may be an
advantage from a practical perspective. And of course, the purpose
of the discussion here is to demonstrate at least one practical use of
jem-nonlshaping.tex; 30/06/2008; 1:58; p.15
Asymptotic analysis of input shaping for residual vibration suppression 17
Figure 3. Parameters of the two-step input force f(t) = f1 H(t)+(f2−f1)H(t−T )
that does not excite any residual vibration for the elastic potential function
Φ(x) = β−2 sinh2(βx).
Figure 3 plots the exact parameters of the two-step input force
as functions of the normalized travel distance β = xm/x0. It is seen
that as the value of β increases, the system becomes more nonlinear,
and the input force parameters deviate more substantially from the
corresponding linear estimates. In particular, the force magnitudes f1,2
increase, while the task time T decreases, with the nonlinearity strength
(characterized by the value of β). For example, with β = 1 (and hence
ǫ = 1 really is not small), we calculate
f
(e)
1 = 1.381, f
(e)
2 = 3.627, and T
(e) = 0.766π/
√
2.
With the grossly incorrect parameters f
(1)
1 = 1, f
(1)
2 = 2 and T
(1) =
π/
√
2, the input force will excite a certain amount of residual vibration
when applied on the system. Indeed, as shown in Fig. 4 (see also Table
I), when such an input force is used, not only is there a substantial
residual vibration (of amplitude 0.222, or 22.2% of the prescribed travel
distance of the point mass), the mean position x = xRV = 0.707 also
is off by about 30% of the prescribed travel distance of the point mass.
However, with the observed residual vibration features, we may use
(31), (33) and (34) to correct the force magnitudes f1,2 and task time
T of the two-step input force. In particular, it is calculated that f
(2)
1 =
1.284, f
(2)
2 = 3.299 and T
(2) = 0.790π/
√
2 (see Table I). With the
corrected parameters, the input force excites a much smaller residual
vibration (of amplitude 0.014) about a mean position x = 0.954 that is
jem-nonlshaping.tex; 30/06/2008; 1:58; p.17
Asymptotic analysis of input shaping for residual vibration suppression 19
5. Summary and concluding remarks
Using the SDOF nonlinear spring–mass system (2) as a simple model,
here we have explained the energetic interpretation and design method-
ology of input shaping, which were originally proposed by Yang et
al. [15, 17]. The analysis discussed in Sect. 2, however, allows the elastic
potential energy associated with the spring to take an arbitrary func-
tional form (except for some physically relevant minor restrictions), and
therefore slightly generalizes the previous work [15]. Moreover, while we
have assumed for simplicity that the input force consists of a series of
consecutively applied forces of constant magnitudes, the analysis can be
readily generalized to design multi-step input forces whose magnitude
depends on the position of a control point in the system (say, the
point mass in our simple model), such as the force produced by an
electromagnetic actuator [17].
The incremental progress we have made in this work is the asymp-
totic calculation of the residual vibration excited by a two-step input
force with slightly incorrect task time and force magnitudes (due to
the potential function estimation error). However, in practice the exact
functional form of the estimation error is not known, so that the asymp-
totic results cannot be used directly. To exploit such results, we have
proposed a simple way to correct the two-step input force based upon
a small number of residual vibration features that can be measured
online. As demonstrated by a specific case study, the simple iterative
procedure proposed here for correcting the input force is both highly
efficient and impressively effective. And we would like to reiterate that,
in addition to the input force correcting procedure proposed here, there
may be other even more interesting ways to use the asymptotic results.
Despite that we have only analyzed a simple model problem, it is
expected that similar asymptotic results and input force correction
procedures (or other practical applications of the asymptotic results)
can be derived for more complex nonlinear mechanical systems as well.
Meanwhile, it perhaps is obvious that the idea of input shaping also
can be applied to control the amplitude of nonlinear forced waves, as
demonstrated in our previous works [18, 19], where the model system
of the forced Korteweg–de Vries (fKdV) equation was studied.
Acknowledgements
The authors gratefully acknowledge the R.O.C. (Taiwan) National Sci-
ence Council for supporting this work through Grants NSC94-2212-
E006-052 and NSC95-2221-E006-045-MY2. They would also like to
jem-nonlshaping.tex; 30/06/2008; 1:58; p.19
Asymptotic analysis of input shaping for residual vibration suppression 21
17. Chen K-S, Yang T-S, Yin J-F, Chen J-Y (2006) Residual vibration suppression
for Duffing nonlinear systems with electromagnetic actuation using nonlinear
input shaping techniques. ASME J Vibr Acoust 128:778–789
18. Yang T-S, Liang W-L (2003) Suppression of nonlinear forced waves by input
shaping. Wave Motion 37:101–117
19. Su S-P, Yang T-S (2002) Suppression of nonlinear forced waves by error-
insensitive input shaping. J Chinese Soc Mech Eng 23:507–516
jem-nonlshaping.tex; 30/06/2008; 1:58; p.21
