  
 
2
 
結合故障樹理論與分封交換網路技術應用於可靠度分析之研究(II) 
計畫編號:    NSC 94-2213-E-002-120 
計畫主持人:    江昭皚   副教授           國立台灣大學  生物產業機電工程學系 
                                計畫共同主持人:    王永鐘   副教授        國立台北科技大學  電機工程系 
計畫執行期間:    94. 8 ~ 95. 7 
計畫參與人員:  莊欽龍(博士生) 、歐陽丞修(博士生)、吳宗修（碩士生）、勞業
興（大專生）      國立台灣大學  生物產業機電工程學系 
                                                               
摘要—台電公司目前正在為其超高壓輸電線系統建構以 GPS
為基礎之同步相量量測單元，作為監視系統狀態之用。未
來，更將配合增設即時狀態監測站，進行受監測輸電線故障
點之定位計算。以 GPS-PMU 為基礎之輸電線保護電驛演算
法已經被證實為相當可靠的保護技術。有鑑於即時監控必須
要有順暢的網路傳輸系統，以避免因為網路故障而延遲偵測
系統故障反應的速度。本年度，本計畫利用螞蟻演算法，進
行傳輸網路系統之設計，並且針對不同網路結構進行傳輸效
能的分析，並且評估在發生故障時的容錯性能。本系統以
Ad-hoc 網路架構進行通訊流量之平衡管理，並且針對傳統的
網路通訊路由演算法進行比較，進而提出適用於 GPS-PMU
保護系統的通訊網路架構以及路由演算法，以提升保護系統
之穩定性與可靠度。 
關鍵詞—測距電驛、故障樹、同步相位量測、保護電驛、失
能率。 
 
Abstract—For monitoring the system status based on GPS 
technique, Tai-Power Company (TPC) is trying to build 
synchronized phasor measurement units (PMU) for its extra high 
transmission line system. In future, it is to reinstall real time state 
monitoring station for locating the fault points of the monitored 
transmission lines. The protection relaying algorithm of the 
transmission line based on the GPS-PMU has been proven a 
relatively reliable protection technique. However, in order to 
maintain high response performance of the protection relaying 
algorithm, a smoothly operational communication network is 
required. In this year, the project develops an ad-hoc based 
computer network for GPS-PMU, and applies ant colony 
algorithm to develop a new load-balancing routing algorithm. 
This study also performs several heavy loading simulations 
subjected to different network topologies. Moreover, we also 
investigate the performance of the network while suffering 
sudden malfunction at one or more access points in the network. 
After comparison between the proposed routing algorithm and 
conventional ones, it is found that based on this study we can 
design a computer network with error-tolerance and load-
balancing feature, which can provide a stable and reliable 
operation platform for GPS-PMU based transmission line 
protection system. 
Keywords: Distance Relay, Routing, Phasor Measurement Unit, 
Protective Relay, Ant Colony Optimization. 
 
一、 前言 
輸電線遭受風災、地震、雷擊等天然因素破壞而
發生故障是難以避免的。基於實際的需求，加上科技
進步，結合電腦運算與通信技術來作電力系統保護與
監控是必然之趨勢。臺灣地區由於供電系統日益複
雜，負載隨工商業之進步與日俱增，用戶需求之電力
穩定與品質愈來愈高。在電力自由化趨勢下，民營電
廠相繼加入競爭，調度運轉控制將更為依賴現今科技
之網路化、自動化、電腦化技術。同時由於社會環境
之變遷，環保意識高漲，發、變電設備新建不易，北
中南三區用電、區域供電失衡，導致系統尖峰備轉容
量必須以南電北送之方式來平衡。因此，在電力系統
中，輸電線路佔有舉足輕重之重要性，尤其歷經 729
及 921 兩次大停電後，建構更安全可靠之輸電網路，
提供高品質、穩定電力為刻不容緩的課題。最近，台
電南北第三迴路輸電線已宣告完成，合宜之輸電線保
護系統方能提升輸電系統穩定度，發揮多重迴路之價
值。在當前政經環境下，產業要能順利轉型以提高競
爭力，激勵景氣發展，穩定可靠之電力能源供應為維
繫台灣經濟優勢的重要支柱。 
由於電力系統複雜程度與日俱增，輸電線系統的
保護研究也日趨困難。近年來，因微處理機技術的進
步，輸電線故障保護工作多已朝數位式保護電驛發展
[1]。特別是，利用 GPS 提供同步時脈基準，進行以同
步相量量測為基礎所發展的輸電線適應型保護電驛技
術已有豐碩之研究成果被發表[2-6]。此等以 GPS-PMU
為基礎的保護電驛技術可傳送雙端即時同步電壓、電
流數據資料，其兼俱準確計算故障位置，快速跳脫判
定等性能，可達到確實地隔離故障，防止故障區域擴
大，避免重大之損失優良特性。但是，就實際應用之
角度探討，利用以 GPS-PMU 為基礎之保護電驛執行現
有的輸電線系統保護任務時，可能面臨許多問題需加
以考量。近年來，全世界之工業科技快速進步，使得
資訊蒐集之電子通訊技術大幅提昇，各項運轉數據均
可作高精密之量測記錄，設備動作之時間亦可作精確
之記錄，大大提昇運轉之監控品質及機電事故後原因
分析精確性。因此，為確保資訊設備蒐集之資料在分
析時不致有過大之誤差，利用全球定位系統 (Global 
Positioning System, GPS)作幾近於即時(Real Time)之同
步量測技術應用益形普遍。同步相量量測單元以 GPS
所提供的時間訊號作為時脈基準，修正本身振盪器之
中心頻率，經由取樣訊號加入時間標籤(Time Tag)，並
由通信媒介傳送至中央控制中心供電驛演算程式作為
即時輸電線參數計算，藉以作故障判別及故障定位。
然而，既使是具有非常精確的時間標籤加入在數據資
料當中，穩定的通訊網路則進一步變成另外一個更重
要的研究議題。 
  
 
4
性。Φ(π)可以代表一個路徑在傳遞一個封包時，在該
路徑所造成的時間延遲，或是經過的節點數量 n(π)，
或是兩種特性的綜合函數。故當有兩個路徑 π1(s, d)與
π2(s, d)使其 Φ(π1) = Φ(π2)時，兩個路徑則可以說是具
有相同的路由成本(Φ-equivalent)。 
在本計畫中，網路連結被定義在一個 T = [ts,d]陣列
當中，其中 ts,d表示節點 s 與節點 d 之間是否有連線存
在。Bs代表節點 s 所能承受的最高網路資料流量負載，
另外存在一個 E = [es,d]陣列，其中 es,d代表節點 s 將資
料送往節點 d 的機率。ρ(s, d)則表示為另外一個成本函
數，其主要代表節點 s 與節點 d 之間可以被提供的頻寬
量，可以 ρ(s, d) = es,dBs計算。 
根據上面所有定義的變數與函數，我們可以定義
成本函數 Φ(π)如下式： 
( )
, | ( , )
1 ( , )
ll s d s d
s d
C π
π ρ
∈Π
Φ = ∑        (1) 
其中 Cl 代表線路 l 所能提供的總網路頻寬。本計畫所
提出的資料路由演算法，主要就是根據上述的公式，
以最小的成本進行資料的傳遞。詳細的路由方法可見
第四節。 
 
三、 螞蟻仿生演算法之理論 
螞蟻系統[7-10]相關演算方法的基本設計原理主要
是以虛擬螞蟻模擬自然界中真實螞蟻的覓食行為。一
般而言，其運作流程可概分為初始、建構以及回饋等
三個階段。 
此一類型演算方法在執行時首先會在初始階段中
設定系統相關參數之初始值。接著在建構階段中，根
據狀態轉移規則來決定虛擬螞蟻的下一個行進節點，
以逐步建立一個完整的問題解。之後，演算法會再根
據回饋階段所定義之費洛蒙更新機制進行所有節點間
的費洛蒙數量更新動作，藉此以引導下一次迭代的搜
尋求解方向。如此反覆執行直到滿足終止條件為止。
以下則是各個階段主要工作的相關說明： 
初始階段： 
此階段主要是針對演算法進行初始設定。例如：
決定演算法中所使用的螞蟻數目以及費洛蒙的初始
值。 
建構階段： 
此一階段最主要工作是定義虛擬螞蟻用以建構可
行解之建構方法。一般多以費洛蒙機率模型為主，採
用逐步建構的方式以產生一個完整的問題可行解。建
構方法中包含了路徑選擇機制與區域費洛蒙更新機制 
[11]。在傳統螞蟻的路徑選擇機制中有隨機式比例規則 
(Random Proportional Rule) 與虛擬隨機式比例規則
(Pseudo Random Proportional Rule) 這兩種狀態轉移規
則。路徑選擇機制主要是根據目前可行進路線上費洛
蒙的分佈濃度為指標，並以機率模型來計算螞蟻選擇
下一個可行進路線的機率，然後逐步建構出一個問題
的可行解。由於螞蟻的路徑選擇策略是以費洛蒙濃度
為判斷基準，而路徑上費洛蒙數量分佈情況乃是基於
舊有搜尋經驗之過程累積而得，故為避免因累積太多
相同資訊而產生一條影響力太大的路徑情況，則可藉
由區域費洛蒙更新機制的運作，根據系統費洛蒙分布
情況適時地對螞蟻所選取之下一個行經節點上的費洛
蒙數量進行修正。 
回饋階段： 
此階段最主要的工作是根據全域費洛蒙更新機制
來記錄舊有的最佳搜尋經驗，並將所記錄之資訊回饋
到下一迭代的建構階段，以導引下一次迭代往較佳解
之方向搜尋。 
螞蟻系統在初始階段的工作內容與基本架構相
同。接下來將針對螞蟻系統在建構階段與回饋階段的
設計方法進行詳細說明： 
建構階段： 
螞蟻系統係以隨機式比例規則為其狀態轉移規則 
(State Transition Rule)。隨機式比例規則的數學定義如
下： 
[ ] [ ]
if 
[ ] [ ]
0 otherwise
k
l
ij ij k
i
k il ilij
l N
j N
p
α β
α β
τ η
τ η
∈
⎧ × ∈⎪⎪ ×= ⎨⎪⎪⎩
∑       (2) 
在以上的定義中，當第 k 隻螞蟻位於節點 i 時， kijp 表
示由節點 i 選擇前往節點 j 的機率值；而 kiN  則是表示
現階段所有可選擇節點的集合。其中，τij 與ηij 分別表
示節點 i 與節點 j 之間的費洛蒙濃度與能見度。在求解
旅行推銷員問題中[12]，能見度可被設定為節點 i 與節
點 j 之間距離的倒數。由上述 kijp 的數學定義中可知：
當螞蟻位於節點 i 時，選擇前往節點 j 的機率值取決於
節點 i 到 j 上的費洛蒙數量以及啟發法權值 (Heuristic 
value)[13-15]的數值。當[τij]α × [ηij]β 的值愈大，則由節
點 i 前往節點 j 的機率就愈大，而費洛蒙濃度與能見度
之間的相關程度則依所取權重 α 與 β 的值而定。當 α 
＞ β，表示對於下一個行進節點的選擇與節點間的費洛
蒙濃度之相關度愈高，亦即愈偏好依據節點間費洛蒙
的濃度來作為選擇依據。反之，當 α ＜ β，則表示對於
下一個行進節點的選擇與能見度之相關度愈高，亦即
愈偏好依據能見度的權重來作為選擇依據。  
回饋階段： 
基於螞蟻會在經過的路徑中留下費洛蒙之行為模
式，以間接的方式告知其他螞蟻有關食物方向的資
訊，藉此溝通機制以達群體合作之目的。故在此階段
中必須制定各節點間費洛蒙數量的更新機制，並根據
問題特性來制定更新機制中的更新量。一般而言，更
新機制的執行時機可以分為兩種。一種是當螞蟻完成
選取下一個行進節點動作時，便立即增加所行進路徑
上的費洛蒙數量。另一種則是當所有螞蟻皆完成建構
  
 
6
Step 6. Check the stop criterion. 
If (ng < ngmax) or (not user stop) 
Then 
Clear the journey nodes list, and Goto Step 2. 
Else 
Stop. 
網路運作與適應性容錯 
  當路由表建立完成後，所有網路路由演算法中的
參數皆可視為被最佳化更新，並且是馬上可使用的一
個路由表。但是當網路系統在運作過程中，根據不同
的網路流量分佈，以及每個區域的網路節點的改變，
都會影響系統的最佳效能。所以本網路系統必須要適
應不斷改變的網路結構，並且避免產生任何網路結構
上的熱點。 
一個封包在網路上的最佳路徑有可能會不斷改
變，改變的原因可由下列因素所導致： 
1. 有更佳的路徑被找到時 
2. 熱點或是壅塞點出現時 
3. 某些網路節點突然自網路上斷線 
4. 因為節點的移動，故本來最佳化的路徑變為非
最佳化 
為了避免上面因素導致整個網路系統的崩潰，故根據
上面的改變因素，本演算法也必須適應這些網路拓樸
上的改變，且有下列幾項在運作過程中必須進行的網
路路由參數更新步驟： 
1. 當封包到達目的地節點時 
當網路封包經由通訊網路傳輸至目的地時，計算該
封包的傳輸成本函數 Φ(π)，並且建立一個回應封
包，將這個成本函數的資訊依原路傳遞回出發地節
點。 
2. 當封包回到出發地節點時 
當回應封包在回傳的過程中，平均地將成本函數
Φ(π)的值均勻分佈在個節點負責傳遞該封包至目的
地的 E 矩陣上的元素，在優劣比較之下，此更新結
果可增加或減少下次選擇該路由的機率。 
3. 費洛蒙的蒸發 
根據生物界螞蟻留在路徑上的費洛蒙會蒸發的特
性，在此演算法中，E 矩陣上的數值也會隨著時間
逐漸變小，這樣可以將一些較差的路徑給逐漸淘
汰，但又不會影響到尋找新的路徑的需求。 
4. 選擇路由節點 
對於每個節點每次要尋找一個節點進行封包的傳送
時，皆是根據該節點上儲存的費洛蒙 E 矩陣進行路
由安排的根據。當節點的一個連線被需要的連線突
然消失，或是某個節點突然故障失去回應時，則可
將 E 矩陣上對應於該故障節點或是連線的元素做歸
零的處理，直到該連線恢復後，該節點會從新送出
路由探勘封包重建與原網路之路由關係，而在這段
失聯的過程中，資料封包仍可透過其他網路節點進
行傳送。 
 
 
圖一 CAIRN 網路拓樸 
 
 
圖二 立方體拓樸 
 
五、模擬結果 I 
        本研究針對以 ACO 為基礎之網路路由演算法，套
用在兩組網路結構上，以測試本演算法的效能。所使
用的兩組網路拓樸如圖一與圖二所示[16-19]，分別是
CAIRN 拓樸與立方體拓樸。立方體拓樸是所有網路節
點皆與其周圍的節點建立三度空間的連線，而 CAIRN
拓樸則是一個真實的實驗性網路結構，其詳細的資
訊，可在網路上進行查詢(http://www.cairn.net)。 
        拓樸中每個網路所具有的節點都可被視為主動送
出封包的網路伺服機，而當資料封包送達目的地節點
時，該目的地節點也必須傳送產生一個回應封包，並
將之傳送回伺服機。在此路由演算法中，回應封包也
被視為是調整網路參數的根據之一。在此部分，為了
簡化網路模擬的複雜度，所有網路的連線與節點的位
置皆被固定，換句話說，就是所有網路中的連線都不
會出現連線中斷的問題，而網路上的一些基本特性設
定如下： 
連線速率 
每個網路連線都有其最高速限，根據這樣的最高
速限即可用來推估網路通訊封包在線路上造成的通訊
延遲時間。在本計畫中，第一種模擬網路的最高速設
定為 10 Mb/s。 
封包產生延遲 
所有資料在切割以及重新封裝為一個制式的網路
封包皆需要時間，而在本模擬中，這種封包封裝時間
設定為 10 µs。 
封包平均大小 
封包大小在本模擬中被一致設定為 1250 bytes，以
簡化推估傳輸延遲時間。 
  
 
8
擬。模擬結果如圖七所示。在圖七中，因為網路連線
被截斷的緣故，使得傳送到第 2 節點的資料封包出現
延遲劇烈增加的情況，但在過兩秒鐘後，網路的路由
延遲狀況即進入穩定，且並未造成任何節點的封包傳
遞失敗等問題，故本文所提出之以 ACO 為基礎之路由
演算法，確實可有效地處理網路連線中斷的問題。 
 
六、模擬結果 II 
影響資料傳輸延遲的因素很多，包括通信媒體的
種類、通信網路技術之不同、或通信處理界面功能
等。同步相量量測資料的傳輸格式在 IEEE 標準[20]中
已經作了詳盡的規範。在以 GPS-PMU 為基礎的輸電線
保護電驛系統中，其所需傳輸之每一筆資料框架內含
資訊量依 IEEE 標準規範[20]估算，即每一 PMU 量測
端各量取三相電壓與電流共計有六個量測變數相量，
搭配標頭資料檔(Head File)，CRC(Cyclic Redundancy 
Check)字元，與一個 GPS 時間標籤(Time Tag)等，以保
守方式估算約略需用 24 byte 來儲存上述資料。假設量
測取樣速率為每週期三十二次，即 PMU 需以每 1/1860 
秒量測一次方式，並同時需將量測資料傳送至主控電
腦來執行保護任務。因此，每一量測端的 PMU 所傳送
之資料量為 24 byte × 8/(1/1860) = 357,120 bps = 357.12 
kbps，則傳送的數據機將無法到達此項要求，必須使
用更高速的傳輸電路。本研究計畫以分封交換網路技
術(Packet Switch Network Technique)，如 ATM 網路及
IP 網路為傳輸電路來進行相關議題之研究。 
在上一節中進行隨機封包壓力測試後，本節進行
以假設某一個節點為所有 GPS-PMU 監視主機，其他各
節點皆以每秒 1920 個網路封包產生率，將 PMU 所量
得之各端點電流電壓資訊傳送回監看節點，每個封包
大小為 48 bytes (以雙迴路輸電線的 PMU 量測數據為基
準)。 
首先測試以 CAIRN 網路拓樸為測試對象，並以網
路速度為 10、100 與 1000 Mbps 進行各項壓力測試，
並以第十節點為配置於輸配電系統 PMU 之量測資料之
監測節點，測試結果如圖八所示。由圖可之三種網路
速度皆可使網路封包在小於 1.6 ms 的時間內傳送達監
視節點。 
Cube 拓樸亦在與 CAIRN 拓樸相同條件下進行壓力
測試，唯監視節點任意選為為第四節點，測試結果如
圖九所示。在這個測試中，所有網路資料封包皆在小
於 2 ms 的時間內將 PMU 量測數據送達監視節點。在
圖中可知，僅有距離第四節點最遠之第二、六與七節
點之封包的送達速度較晚，因為他們所需依賴的中間
節點皆非常忙碌，因為有多個節點的資料都需傳輸經
過這三個節點，但來自於這三個節點的封包仍能在 2 
ms 之內送達監視節點。 
最後本文隨機產生了一個具有二十個節點與四十
個連結之網路拓樸，並且以第十節點為監視節點，進
行網路壓力測試，測試結果如圖十所示。由圖十中， 
0 2 4 6 8 10 12
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
x 10-3
Source Nodes
A
ve
ra
ge
d 
D
el
ay
 T
im
e 
(s
)
10 Mbps
100 Mbps
1000 Mbps
 
圖八 CAIRN 拓樸之模擬結果(節點 10 為監視節點) 
 
1 2 3 4 5 6 7 8
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
x 10-3
Source Node
A
ve
ra
ge
d 
D
el
ay
 T
im
e 
(s
)
10 Mbps
100 Mbps
1000 Mbps
 
圖九 Cube 拓樸之模擬結果(節點 4 為監視節點) 
 
0 2 4 6 8 10 12 14 16 18 20
0
0.5
1
1.5
2
x 10-3
Source Node
A
ve
ra
ge
d 
D
el
ay
 T
im
e 
(s
)
10 Mbps
100 Mbps
1000 Mbps
 
圖十 Random拓樸之模擬結果(節點 10 為監視節點) 
 
我們可以發現既使以最慢的網路速度進行測試，所有
網路封包的傳輸皆能在約 1.5 ms 之時間內傳達監視節
點，利用更高速的網路連結則能得到更佳的測試結
