 1
 
行政院國家科學委員會補助專題研究計畫 □期中進度報告 
期末報告 
 
序率模擬技術研發及其在水文分析與預測之應用 
 
 
計畫類別：個別型計畫   □整合型計畫 
計畫編號：NSC 98-2221-E-002-111-MY3 
執行期間： 2009 年 8 月 1 日至 2012 年 9 月 30 日 
 
執行機構及系所：國立臺灣大學生物環境系統工程學系 
 
計畫主持人：鄭克聲 
共同主持人： 
計畫參與人員：吳宜珍、劉俊志、蘇元風、侯如真 
 
 
 
 
本計畫除繳交成果報告外，另含下列出國報告，共 ___ 份： 
□移地研究心得報告 
□出席國際學術會議心得報告 
□國際合作研究計畫國外研究報告 
 
 
 
處理方式：除列管計畫及下列情形者外，得立即公開查詢 
            □涉及專利或其他智慧財產權，一年□二年後可公開查詢 
 
中   華   民   國 102 年 2 月 25 日
 3
1. Introduction 
In the field of hydrology and water resources stochastic simulation has becoming more and 
more important and widely applied, mainly because issues related to hydrological forecasting 
and water resources planning often involve different sources of uncertainty. Recent 
developments in hydrological modeling, flood risk analysis, environmental impact assessment, 
etc. have demonstrated the usefulness of stochastic simulation (National Research Council 2000; 
Kim and Lee 2007). 
Many applications of stochastic simulation in hydrology and water resources deal with 
univariate simulation (Cowpertwait et al. 1996; Scholz 1997; Werner and Kadlec 2000; Cheng et 
al., 2007; Benke and Hamilton 2008). However, due to the dependent nature of hydrological 
variables, multivariate stochastic simulation is gaining more attention (Clark 1980; Loganathan 
et al. 1987; Singh and Singh 1991; Bacchi et al. 1994; Kelly and Krzysztofowicz 1997; Ashkar et 
al. 1998; Goel et al. 2000; Yue 1999, 2000, 2001a, 2001b; Loaiciga and Leipnik 2005; Khalili et 
al. 2009; Lee et al. 2010). For tractability, simulation modelers sometimes ignore the correlation 
between variables or assume marginal distributions such as the normal, for which correlated 
variates can be easily generated (Schmeiser and Lal 1982). However, the multivariate normal 
distribution is inappropriate for applications in many real world data which are essentially 
non-negative and asymmetric. In contrast, the bivariate gamma distribution has been found 
useful for modeling such data. For example, flood volume and storm duration were found to be 
correlated and could be characterized by a bivariate gamma distribution (Yue, et al. 2001). In 
addition, the exponential distribution is a special case of the gamma distribution, and the sum of 
a set of n independent and identically distributed exponential random variables has a gamma 
distribution. As a result, the waiting time until the n-th occurrence in a Poisson process can be 
characterized by the gamma distribution. Hydrologists often consider the duration and average 
intensity of storm events as two correlated gamma random variables. Nadarajah and Gupta (2006) 
showed that the product of two correlated gamma random variables also has a gamma 
distribution, and that the duration and the total depth (which is the product of duration and 
intensity) of storm events form a bivariate gamma distribution. Thus, stochastic simulation of 
bivariate gamma distributions may prove to be very useful for flood risk analysis, assessment of 
climate change effect on hydrological regimes, and environmental impact assessment. 
There have been a few models of bivariate gamma distribution in the literature (Cherian 1941; 
Kibble 1941; Izawa 1953; Moran 1969; D’este 1981; Schmeiser and Lal 1982; Loaiciga and 
Leipnik 2005; Nadarajah and Gupta 2006). Yue et al. (2001) reviewed several models of 
bivariate gamma distributions and demonstrated that these models may be useful for 
hydrological engineers to analyze joint statistical behavior of multivariate hydrological events 
such as floods and storms. In their study, a number of random sample-pairs (X, Y) from marginal 
distributions of pre-specified parameters were generated. The simulation was conducted with 
various combination scenarios and yielded sample-pairs with different correlation coefficients, 
instead of a pre-specified or desired correlation coefficient. However, for practical applications, 
one needs to simulate bivariate gamma random samples with the desired or pre-specified 
 5
where z is the standard normal deviate and Xγ  is the coefficient of skewness of X. Given 
Xµ , Xσ and Xγ , if we can generate a set of random numbers of K, say nkkk ,,, 21 K , then a 
random sample of X, say nxxx ,,, 21 K , can be obtained by 
XiXi kx σµ += . (3) 
Note that each ki, ,,,2,1 ni K= corresponds to its own exceedence probability 1/Ti. 
The gamma distribution is a special case of the Pearson type III distribution with a zero 
location parameter. Therefore, it seems plausible to generate random samples of a bivariate 
gamma distribution based on two jointly distributed frequency factors of Eq. (2). Details of such 
frequency-factor based bivariate gamma simulation are described below. 
Assume two random variables X and Y are jointly distributed, each with the following 
marginal gamma density: 
+∞<≤





=
−
−
xe
x
xf xX 0,)(
1),,;( )/(
1
α
β
αβαεβα Γ  (4) 
0>= β
σ
α , (5) 
02
2
>





=
γ
β , (6) 
0>== βσαβµ , (7) 
where µ ,σ , andγ are the mean, standard deviation, and coefficient of skewness of X (or Y), 
respectively, and α and β are respectively the scale and shape parameters of the gamma 
distribution. From Eq. (3), random variables X and Y are respectively associated with their 
frequency factors KX and KY. 
Equation (2) indicates that frequency factor KX of a gamma random variable X can be 
approximated by a function of the standard normal deviate and the coefficient of skewness Xγ  
of the gamma distribution. Therefore, simulation of the frequency factor KX can be achieved by 
generating a random sample of the standard normal deviate U, say nuuu ,,, 21 K , and then 
utilizing Eq. (2) to obtain 
nxxx
kkk ,,,
21
K
 from nuuu ,,, 21 K . However, for a bivariate gamma 
density ),( yxf XY , the two frequency factors KX and KY are correlated through two standard 
normal deviates U and V which have a correlation coefficient UVρ . Thus, random number 
generation of the second frequency factor KY must take into consideration the correlation 
between KX and KY which in turn stems from the correlation between U and V.  
Given a random number of U, say u, the conditional density of V is expressed by the 
following conditional normal density 
== )|(| uUvUVφ


















−
−
−⋅
−
2
22 12
1
exp
)1(2
1
UV
UV
UV
uv
ρ
ρ
ρpi
, (8) 
 7
3. Simulation and verification 
In order to assess the performance of the proposed BVG-FF simulation algorithm and to 
demonstrate how this approach can be implemented, we chose to base our simulation on real 
rainfall data observed at two raingauge stations (C1I020 and C1G690) in central Taiwan. 
Fourteen years (1993 – 2006) of hourly rainfall records are available at both stations 
(http://dbar.as.ntu.edu.tw/). In general, rainfalls in Taiwan are brought about by four 
season-specific dominant storm types: winter frontal rainfall (from November to April of the 
next year), Mei-Yu (from late April to end of June), convective rainfall and typhoons (both from 
July to October). Among these seasonal storms, typhoon rainfalls account for the highest 
percentage of annual total rainfall. Storms of different types exhibit different characteristics. For 
example, typhoons tend to have longer storm durations and larger amount of total rainfall than 
convective storms. In this study, we focus on the joint distribution of the duration and total 
rainfall depth of typhoon events.  
From historical rainfall records, a minimum inter-event time (the time span from the end of 
one storm event to the beginning of the next storm event) of 8 hours and a minimum storm 
duration of 12 hours were adopted for extraction of typhoon events. Table 1 summarizes 
statistical properties of the total rainfall depth and duration of typhoon events at the two 
exemplar raingauge sites. Total rainfall depth and duration of typhoon events were considered 
having marginal gamma distributions based on the results of the Kolmogorov- Smirnov 
goodness-of-fit tests (see Table 2). To demonstrate the BVG-FF simulation algorithm, we further 
assume the total depth and duration of typhoon events are bivariate-gamma distributed, although 
validity of such assumption requires further test. 
Let X and Y represent the duration and total rainfall depth of typhoon events respectively. 
Based on the statistical properties of historical rainfall data shown in Table 1, we assume 
83.26=Xµ hours, 19.105=Yµ mm, 45.1=Xγ , 63.1=Yγ , and 71.0=XYρ  for Station C1I020. 
For Station C1G690, corresponding parameters are 78.22=Xµ hours, 65.95=Yµ mm, 
66.1=Xγ , 27.2=Yγ , and 76.0=XYρ . Then, for a specific sample size n (n = 20, 40, 60, 100, 
150, 250, 500), a total of 10 000 random samples were generated using the proposed BVG-FF 
simulation algorithm. 
From each of the 10 000 generated random samples, the method of moments and maximum 
likelihood estimates of the mean and coefficient of skewness were calculated. Details of these 
estimators are given in Appendix 3. For the gamma distribution, both the method of moments 
and maximum likelihood estimators of the population mean are the same as the sample mean. In 
addition to the method of moment estimator ( MOMγˆ ) and the maximum likelihood estimator 
( MLEγˆ ), a commonly used estimator of the coefficient of skewness is as follows (Chow et al., 
1988): 
3
1
3
)2)(1(
)(
ˆ
n
n
i
ni
Snn
xxn
−−
−
=
∑
=γ . (11) 
Estimator of the above coefficient of skewness is very sensitive to sample size n and Bobee and 
Robitaille (1977) suggested using the following sample-size-adjusted coefficient of skewness for 
 9
four estimators of coefficient of skewness. 
In addition to verifying the marginal distributions and correlation, Schmeiser and Lal (1982) 
pointed out that the scatter plot of generated (X,Y) pairs must also be investigated. Schmeiser and 
Lal (1982) proposed a bivariate gamma simulation algorithm using a trivariate reduction 
technique which yields two dependent random variables from three independent random 
variables. Given the shape and scale parameters of two dependent gamma random variables and 
their correlation coefficient, the algorithm uses five variables to satisfy a set of three equality 
conditions, and thus the solutions are feasible solutions, rather than an optimal solution 
(Schmeiser and Lal, 1982). Substantial computation is required to determine whether or not the 
selected parameter values satisfy the required equality conditions. Such computation involves 
another numerical root finding algorithm and a numerical integration for calculation of expected 
value. Using the bivariate gamma simulation algorithm, Schmeiser and Lal (1982) demonstrated 
a case that generated random samples may have the desired marginal distributions and 
correlation; however, the scatter pattern of (X,Y) pairs is inappropriate in most applications. The 
pattern is that of many independent variates superimposed over many other variates lying on a 
well-behaved curve. Figure 5 illustrates an example of such inappropriate scatter plot of (X,Y) 
pairs. 
From the results of bivariate gamma simulation using the BVG-FF algorithm, two sets of 
random sample pairs of sample size 40 and 500 respectively were arbitrarily chosen for 
examination of their scatter plots. As can be observed in Figures 6 and 7, irrespective of the 
sample sizes, scatter plots of (X, Y) pairs exhibit appropriate linear patterns that are commonly 
observed in real world environmental or hydrological studies.  
Comparing to the algorithm proposed by Schmeiser and Lal (1982), the proposed BVG-FF 
algorithm is much less intensive in computation. It only requires simulation of bivariate standard 
normal random samples with a specific correlation coefficient, and bivariate gamma samples can 
be easily transformed from standard normal samples using the general equation of frequency 
analysis. Another important advantage of the BVG-FF algorithm is that it generates random 
samples of known bivariate gamma density, i.e. the Moran bivariate gamma model, (see details 
in section 4) whereas the joint density of the Schmeiser and Lal’s approach was not given. 
4. Further discussions on the feasible region of XYρ  and joint PDF 
In this section we further examine two important issues –feasible range of the correlation 
coefficient XYρ  and joint probability density function (PDF) of the bivariate gamma 
distribution, which are of important concerns to stochastic simulation of the proposed approach. 
A key element in stochastic simulation using the proposed approach is the conversion 
between the correlation coefficient XYρ of two gamma random variables X and Y and the 
corresponding correlation coefficient UVρ of two standard normal random variables U and V using 
Equation (10). Such conversion is a function of the coefficients of skewness Xγ  and Yγ  (or 
equivalently, shape factors Xβ  and Yβ ). It is worthy to note that, for given ranges of Xγ  and 
Yγ , the correlation coefficient XYρ  cannot assume all values between 1−  and 1 since the 
property of 11 ≤≤− UVρ  must be satisfied. With 3,0 ≤< YX γγ , Figures 8 and 9 respectively 
 11 
most superior. Although the adjusted sample coefficient of skewness can effectively reduce 
estimation bias for random samples with small to moderate sample sizes, its estimates are 
associated with higher standard deviations.  
(2) Scatter plots of simulated bivariate sample pairs exhibit appropriate linear patterns 
(dependence structure) that are commonly observed in environmental or hydrological 
applications. 
(3) The single-value relationship of XYρ  and UVρ  is dependent only on the coefficients of 
skewness of the two component random variables. For given ranges of Xγ  and Yγ  (or 
equivalently, shape factors Xβ and Yβ ) the correlation coefficient XYρ  will fall within a 
corresponding feasible range. 
(4) Random samples generated using the proposed approach are distributed with a joint 
probability density function of the Moran (1969) model. 
(5) The proposed approach can also be applied for stochastic simulation of the more general 
bivariate Pearson type III distribution. 
Acknowledgements 
This research was originally initiated from a project funded by the Council of Agriculture, 
R.O.C. We also thank the National Science Council for subsequent funding support. We are 
grateful to the Sinotech Engineering Consultants, Inc. for providing scholarship for the second 
author during this study. We also appreciate the constructive and insightful review comments of 
two anonymous referees which have made this article more informative and in depth. 
Appendix 1. Derivation of the relationship between XYρ  and UVρ  (Eq. (10)). 
Suppose that random variables X and Y form a bivariate gamma distribution. According to 
what described in Section 2, given the means ( Xµ and Yµ ) and standard deviations ( Xσ and Yσ ), 
X and Y can be respectively expressed in terms of their corresponding frequency factors KX and 
KY , i.e., 
XXX KX σµ +=  (A1) 
and 
YYY KY σµ += . (A2) 
Note that, with given means Xµ and Yµ and standard deviations Xσ and Yσ , the coefficients of 
skewness Xγ and Yγ can be readily determined by Eq. (9). 
From the above equations, it can be easily shown that frequency factors KX and KY are 
distributed with zero mean and unit standard deviation, and correlation coefficient of X and Y is 
equivalent to correlation coefficient of KX and KY, i.e.,  
0][][ == YX KEKE , (A3) 
1][][ == YX KVarKVar , (A4) 
and 
 13
above equation reduces to  
[ ]YX KKE  
( ) ( )( )
( ) ( )( ) 





+−−+−+
−−+−+
≈
YXYXYX
YXYXYX
DDVVUUCCVUUAC
VUBBVVUCAUVAA
E
666
116
333
223
. (A14) 
From Eq. (A9), 
( ) ( )[ ] XXXXXX DDUUCUBUAEKE =+−+−+≈ 61][ 32 . (A15) 
Since KX and KY are distributed with zero means, it follows that 
0≈= YX DD . (A16) 
Therefore, the correlation coefficient of KX and KY can be approximated by 
[ ]
( ) ( ) ( )
( ) ( ) ( ) 





−−+−+
−−+−+
≈
=
VVUUCCVUUAC
VUBBVVUCAUVAA
E
KKE
YXYX
YXYXYX
YXKK YX
666
116
333
223
ρ
 
( )[ ] ( )[ ]16 223 −+−+= VUEBBUVECAAA YXUVYXUVYX ρρ  
( )[ ] ( ) ( ) ( )[ ]UVYXUVYX VUEUVEVUECCVUEAC ρρ 36666 33333 +−−+−+ . (A17) 
Note that in the above derivations we have used the following properties 
( ) UVUVE ρ= , (A18) ( ) ( ) 122 == VEUE . (A19) 
It can also be shown that (Kendall and Stuart 1977; Kan 2008) 
( ) 12 222 += UVVUE ρ , (A20) 
( ) UVUVVUE ρρ 96 333 += , (A21) 
( ) ( ) UVUVEVUE ρ333 == . (A22) 
Thus,  
( ) 32 62933 UVYXUVYXUVYXYXYXYXKKXY CCBBCCACCAAAYX ρρρρρ +++−−≈= . (A23) 
Appendix 2. Proof of Eq. (10) as a single-value function. 
Let UVXYUVf ρρρ ∂∂=)( . From Eq. (10) we have 
( ) 2184933)( UVYXUVYXYXYXYXYXUV CCBBCCACCAAAf ρρρ +++−−= , (A24) 
( )( )YYXXYXYXYXYX CACACCACCAAA 33933 −−=+−− , (A25) 
0
6
1
666
13
22224
>





+








−





=





−





+=− XXXXXX CA
γγγγ
. (A26) 
 15
=
∂
∂
2
2
)( UV
f
ρ 04
22 >YXGG . (A37) 
Therefore, 0)( * >UVf ρ  is the minimum of the function UVXYUVf ρρρ ∂∂=)( . It follows that  
0)( >∂∂= UVXYUVf ρρρ  (A38) 
for all possible values of UVρ . The above equation indicates XYρ increases with increasing UVρ , 
and thus Eq. (10) is a single-value function. 
Appendix 3. Method of moments and maximum likelihood estimators of the mean and 
coefficient of skewness of the gamma distribution. 
Equations (4) – (7) give the density function of a gamma distribution and expressions of the 
distribution parameters ( βα , ) as functions of the mean, standard deviation and coefficient of 
skewness. Given a random sample of size n, i.e. ),,,( 1 nxx K we adopt the following conventional 
expressions of sample moments and central moments: 
nxm
n
i
r
ir ∑
=
=′
1
, nxxm
n
i
r
nir ∑
=
−=
1
)( .         
The method of moments estimator of the mean, variance and coefficient of skewness are 
respectively expressed as MOMµˆ , 2ˆMOMσ and MOMγˆ . Thus, 
n
n
i
iMOM xnxm ==′= ∑
=1
1µˆ , (A39) 
2
1
22
122
2 )1()(1)(ˆ n
n
i
niMOM S
n
n
xx
n
mmm
−
=−=′−′== ∑
=
σ , (A40) 






−
−
= ∑
=
n
i
nin xx
n
S
1
22 )(
1
1
 
3
1
3
2
32
1
3
2
3
2
3
)1()1(
)(
]/)1[(
)(1
)(
ˆ
n
n
i
ni
n
n
i
ni
MOM Snnn
xxn
nSn
xx
n
m
m
−−
−
=
−
−
==
∑∑
==γ . (A41) 
The maximum likelihood estimators of the distribution parameters ( βα , ) have been 
documented by Kite (1988) and Rao and Hamed (2000): 






≤≤
++
++
≤≤−+
=
175772.0)968477.117928.17(
9775373.005995.9898919.8
5772.00)054427.01648852.0500876.0(1
ˆ
2
2
2
U
UUU
UU
UUU
U
MLEβ , (A42) 
MLEnMLE x βα ˆˆ = , (A43) 
where GxU n lnln −=  and nnxxxG
1
21 )( K= . From the invariance property of maximum 
likelihood estimators, we have 
nMLEMLEMLE x== βαµ ˆˆˆ , (A44) 
 17
where )],;([1 xxX xFu βα−Φ=  and )],;([1 yyY yFv βα−Φ= .  
Notice that the correlation coefficient between X and Y, i.e. XYρ , does not explicitly appear in 
the above equation of bivariate gamma density. In this study we have derived the relationship 
between XYρ  and UVρ  (Eq. 10 and Eq. A23) with which XYρ  is implicitly included in the 
bivariate density function. 
References 
Ashkar F, El-Jabi N, Issa, M (1998) A bivariate analysis of the volume and duration of low-flow 
events. Stochastic Hydrology and Hydraulics 12:97-116. 
Bacchi B, Becciu G, Kottegoda NT (1994) Bivariate exponential model applied to intensities and 
durations of extreme rainfall. Journal of Hydrology 155:225-236. 
Benke KK, Hamilton AJ (2008) Quantitative microbial risk assessment: uncertainty and 
measures of central tendency for skewed distributions. Stochastic Environmental Research 
and Risk Assessment 22:533–539. 
Bobee B, Robitaille R (1977) The use of the Pearson type III and log Pearson type III 
distribution revisited. Water Resources Research 13(2):427–443. 
Cheng KS, Chiang JL, Hsu CW (2007) Simulation of probability distributions commonly used in 
hydrological frequency analysis. Hydrological Processes 21:51–60. 
Cherian KC (1941) A bi-variate correlated gamma-type distribution function. Journal of Indian 
Mathematical Society 5:133-144. 
Chow VT (1951) A general formula for hydrologic frequency analysis. Transactions, American 
Geophysical Union 32:231–237. 
Chow VT, Maidment DR, Mays LW (1988) Applied Hydrology. McGraw-Hill, New York. 
Clark RT (1980) Bivariate gamma distribution for extending annual streamflow records from 
precipitation: Some large sample results. Water Resources Research 16:863-870. 
Cowpertwait PSP, O’Connell PE, Metcalfe AV, Mawdsley JA (1996) Stochastic point process 
modelling of rainfall. I. Single-site fitting and validation. Journal of Hydrology 175:17-46. 
De Michele C, Salvadori G (2003) A generalized pareto intensityduration model of storm rainfall 
exploiting 2-copulas. Journal of Geophysical Research 108(D2):4067. 
D’este GM (1981) A Morgenstern-type bivariate gamma distribution. Biometrika 68(1):339-340. 
Favre AC, El Adlouni S, Perreault L, Thiémonge N, Bobée B (2004) Multivariate hydrological 
frequency analysis using copulas. Water Resources Research 40:W01101. 
Goel NK, Kurothe RS, Mathur BS, Vogel RM (2000) A derived flood frequency distribution for 
correlated rainfall intensity and duration. Journal of Hydrology 228:56-67. 
Grimaldia S, Serinaldi F (2006) Asymmetric copula in multivariate flood frequency analysis. 
Advances in Water Resources 29(8):1155-1167. 
Izawa T (1953) The bivariate gamma distribution. Climate and Statistics 4(1):9-15 (in Japanese). 
Kan R (2008) From moments of sum to moments of products. Journal of Multivariate Analysis 
99(3):542-554. 
Kelly KS, Krzysztofowicz R (1997) A bivariate meta-Gaussian density for use in hydrology. 
 19
represented by daily rainfalls. Hydrological Science Journal 45(2):315-326. 
Yue S (2001a) A statistical measure of severity of El Niño events. Stochastic Environmental 
Research and Risk Assessment 15:153–172. 
Yue S (2001b) A bivariate gamma distribution for use in multivariate flood frequency analysis. 
Hydrological Processes 15:1033-1045. 
Yue S, Ouarda TBMJ, Bobee B (2001) A review of bivariate gamma distributions for 
hydrological application. Journal of Hydrology 246:1-18. 
Zhang L, Singh VP (2007) Bivariate rainfall frequency distributions using Archimedean copulas. 
Journal of Hydrology 332(1-2):93-109. 
 
 21
 1 
Table 2. Results of the Kolmogorov-Smirnov goodness-of-fit tests for duration and total 2 
depth of stations C1I020 and C1G690. 3 
Station Variable 
Value of the 
test statistic 
p-value 
Critical value 
(α = 0.05) 
C11020 
(n=48) 
Duration 0.086 0.840 0.192 
Total depth 0.135 0.317 0.192 
C1G690 
(n=23) 
Duration 0.116 0.879 0.275 
Total depth 0.164 0.510 0.275 
Note: n and α represent the sample size and level of significance respectively. 4 
 5 
6 
 23
Table 4. Summary statistics of the estimators of distribution properties (mean, coefficient of 1 
skewness, and correlation coefficient) with respect to sample size n ranging from 20 to 500 2 
[Station C1G690, 78.22=Xµ , 65.95=Yµ , 66.1=Xγ , 27.2=Yγ , 76.0=XYρ , ,391.7=Xα  3 
,459.1=Xβ 778.0,869.122 == YY βα ]. 4 
Parameter
Estimator 
summary 
statistics 
sample size, n 
20 40 60 100 150 250 500 
nx  
mean 22.718 22.774 22.792 22.756 22.768 22.772 22.774 
std dev 2.005 1.418 1.163 0.884 0.729 0.570 0.400 
MOMX ,γˆ  
mean 1.117 1.326 1.426 1.526 1.576 1.620 1.651 
std dev 0.618 0.582 0.553 0.506 0.463 0.387 0.307 
MLEX ,γˆ  
mean 1.635 1.668 1.673 1.682 1.688 1.691 1.694 
std dev 0.275 0.194 0.162 0.124 0.102 0.080 0.056 
Xγˆ  
mean 1.210 1.378 1.462 1.549 1.592 1.630 1.656 
std dev 0.669 0.605 0.567 0.514 0.467 0.390 0.308 
Xγ ′ˆ  
mean 1.724 1.671 1.669 1.681 1.682 1.686 1.685 
std dev 0.953 0.734 0.647 0.558 0.494 0.403 0.314 
ny  
mean 95.134 95.459 95.609 95.101 95.311 95.409 95.385 
std dev 24.281 17.097 14.094 10.851 8.776 6.810 4.861 
MOMY ,γˆ  
mean 1.459 1.760 1.891 2.039 2.143 2.217 2.275 
std dev 0.668 0.701 0.664 0.650 0.638 0.561 0.457 
MLEY ,γˆ  
mean 2.306 2.346 2.355 2.368 2.371 2.375 2.379 
std dev 0.386 0.270 0.226 0.173 0.140 0.109 0.077 
Yγˆ  
mean 1.580 1.829 1.940 2.070 2.165 2.231 2.282 
std dev 0.723 0.729 0.682 0.660 0.645 0.564 0.458 
Yγ ′ˆ  
mean 2.252 2.218 2.215 2.246 2.288 2.307 2.321 
std dev 1.030 0.884 0.778 0.716 0.681 0.583 0.466 
XYr  
mean 0.758 0.762 0.762 0.763 0.762 0.763 0.763 
std dev 0.126 0.089 0.073 0.058 0.048 0.037 0.026 
 5 
 6 
7 
 25
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Generating a random 
sample nuuu ,,, 21 L of 
)1,0(~ NU
Generating a random 
sample nvvv ,,, 21 L of 
)1,0(~ NV
Calculating a random 
sample of KX 
(
nxxx
kkk ,,,
21
L ) 
Calculating a random 
sample of KY 
(
nyyy
kkk ,,,
21
L ) 
(Eq. 2) (Eq. 2) 
Given the means, standard deviations and coefficients of skewness of 
two correlated gamma random variables X and Y, i.e.,  
( Xµ , Xσ , Xγ ) and ( Yµ , Yσ , Yγ )  [Note: 2/µγσ = ] 
Also given the correlation coefficient of X and Y, i.e., XYρ  
Calculating a random 
sample of X
 
( nxxx ,,, 21 L ) 
Calculating a random 
sample of Y
 
( nyyy ,,, 21 L ) 
(Eq. 3) (Eq. 3) 
Figure 1. The BVG-FF algorithm for stochastic simulation 
of the bivariate gamma distribution. 
(Eq. 8) 
Converting the correlation coefficient XYρ  to UVρ  using Eq. (10) 
 27
 
 
 
 
Figure 3. Biases of different estimators of coefficient of skewness of duration (X) and total depth 
(Y) of stations C1I020 and C1G690. 
 
 29
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Figure 5. Illustration of a scatter plot of simulated random samples (X,Y) 
with an inappropriate pattern. 
X 
Y 
 31
 
Figure 7. ECDF (solid line), CDF (dashed line) and scatter plots of simulated bivariate gamma 
random samples (Station C1G690). Distribution parameters are shown in Table 4. 
 
 33
 
 
 
 
Figure 9. Feasible regions of XYρ  for two gamma random variables X and 
Y with 3,0 ≤< YX γγ and 6.0−=UVρ . 
 
 35 
ASSESSING THE EFFECT OF CLIMATE CHANGE ON DESIGN 
STORM DEPTH 
 
Ke-Sheng Cheng, Ju-Chen Hou 
 
Department of Bioenvironmental Systems Engineering, National Taiwan University, Taipei, 
Taiwan, R.O.C. 
phone: +886 2 33663465; fax: +886 2 23635854; e-mail: rslab@ntu.edu.tw 
 
ABSTRACT 
Many studies related to climate change focus on global, continental or regional scale effect 
in space and annual or seasonal scale effect in time. However, for practical planning and 
engineering design, it is necessary to deal with local (spatial) and event (temporal) scales. In 
this paper we present the development of a continuous stochastic storm-rainfall simulation 
model (SRSM) which can accommodate the aforementioned scales and provides quantitative 
assessment of the impact on design storm depth under given scenarios of climate change. 
Occurrences of storm events of a certain storm type can be modeled as a Poisson process and 
the inter-arrival time is modeled as a random variable with exponential distribution. A 
bivariate gamma distribution is adopted for joint distribution of storm duration and total 
rainfall depth. A random process is used for disaggregation of total rainfall. Under certain 
scenarios of climate change, i.e. the average number of typhoons events for the study site 
increases or decrease, we assess the impact on design storm depth. Changes in the number of 
typhoon events corresponds to changes in the inter-arrival time, and there-fore the SRSM can 
provide a quantitative assessment of climate change effect on design storm depth.  
 
Keywords: stochastic simulation, design storm, climate change 
 
1 INTRODUCTION 
Many studies related to climate change focus on assessing the climate change effect on 
earth surface processes in global, continental or regional scale in space and annual or seasonal 
scale in time. In comparison, climate change effects in local and daily (or hourly) scales, such 
as the effects on characteristics of rainfall events, have received much less attention, possibly 
due to less and incomplete observed data. However, for practical planning and engineering 
design adapting to possible climate changes, effects in local (spatial) and event (temporal) 
scales are of major concern.  
Properties of storm events (for example, duration, total depth, peak rainfall rate, etc.) 
exhibit high degree of variations which are random in nature, and can be represented as 
random variables (Restrepo-Posada and Eagleson, 1982; Koutsoyiannis and Pachakis, 1996; 
Koutsoyiannis and Mamassis, 2001). Some of these variables are mutually dependent with 
different probability distributions. As a result, it is generally difficult to derive their joint 
distribution. The complexity of such multivariate variations makes it very difficult to assess 
the effect of changes in certain variables on the rest of variables through their multivariate 
conditional density. Although GCM models have been used for assessing the impact of 
different climate change scenarios on precipitation and other variables of hydrological 
processes, they are limited in their ability to reproduce important aspects of the hydrological 
cycle (National Assessment Synthesis Team, 2000). Precipitation is a key climatic variable, 
but it is difficult to predict changes at the local level because they are affected by land surface 
features that are at smaller scales than the GCM outputs (Felzer and Heard, 1999). As a result, 
precipitation patterns are difficult for GCMs to reproduce. An alternative to alleviate such 
difficulties is by adopting stochastic simulation approaches (Koutsoyiannis and Pachakis, 1996; 
 37 
Let X and Y be two jointly distributed exponenttial random variables. The joint 
exponential distribution function of Marshall and Olkin model (MOBED) has the following 
form: 
[ ]
[ ]     0   ,   )(exp
0   ,   )(exp),(
2121
1221
,



≤≤−+−
≤≤+−−
=
xyyx
yxyx
yxF YX λλλ
λλλ
    (1) 
where λ1, λ2 and λ12 are parameters. The expected values of X and Y and the correlation 
coefficient ρ(X,Y) are expressed by 
121
1
λλµ +=X ,         (2) 
122
1
λλµ +=Y         (3) 
1221
12),( λλλ
λρ
++
=YX        (4) 
Simulation of the bivariate exponential distribution of Equation (1) is achieved by 
independently generating random numbers of three univariate exponential densities (Z1, Z2, 
and Z12) with parameters λ1, λ2 and λ12, respectively. Then a pair of random number of (X,Y) 
is obtained by setting x=min(z1, z12) and y=min(z2, z12).  
Using the MOBED model, the total rainfall depth (P) and duration (Dt) of a storm event 
can be generated. The interevent time (tint) of the generated storm event and the next event can 
then be generated by a univariate exponential simulation. The sequence of (total depth, 
duration), interevent time) simulation is depicted in Figure 2.  
 
Figure 2. Sequence of ((total depth, duration), interevent time) simulation. 
 
Incremental rainfall (e.g. hourly rainfall) varies within the duration of a storm event, and 
thus total rainfall depth of individual storm events must be disaggregated over storm durations. 
Based on the simple scaling property of incremental rainfall, Cheng et al. (2001) developed a 
dimensionless hyetograph model. The model disaggregates total depth of a storm event into a 
fixed number of incremental rainfall depths. Since storm duration varies with events, the time 
increment of incremental rainfall also varies with events. However, corresponding scaled 
dimensionless incremental rainfalls (i.e., incremental rainfall percentages) of different storm 
events are identically distributed, based on the simple scaling property.  
Let {Y(i), i=1,…,n} be the scaled dimensionless incremental rainfalls of a storm event. 
We consider the time variation of Y(i) as a nonstationary Gauss-Markov process. The expected 
value µi and standard deviation σi of Y(i), and the lag-one correlation ρ(i) of Y(i) and Y(i-1) 
can be estimated from observed rainfalls. The Gauss-Markov property provides a convenient 
expression of the conditional distribution of Y(i) given Y(i-1): 
⋅
−
=
− ))(1(2
1)|(
221 i
yyf
i
ii ρpiσ 















−
−−−
−
−−−
2
2
111
)(1
)(/)()(
2
1
exp
i
yiy
i
iiiiii
ρσ
µσσρµ
 (5) 
 39 
 
 
 
 
 
 
 
 
 
Figure 5. Comparison of the empirical CDF based on simulated rainfall data and theoretical 
CDF of storm duration of typhoon events. (♦empirical CDF,  theoretical CDF) 
 
 
 
 
 
 
 
 
Figure 6. Comparison of the empirical CDF based on simulated rainfall data and theoretical 
CDF of storm duration of typhoon events. (♦empirical CDF,  theoretical CDF) 
 
From the historical rainfall data, the average interevent time of typhoon events is 
approximately 480 hours, or equivalently 4.5 typhoons per year on average. In this study, the 
climate change scenarios are set to have 4 or 5 typhoon events per year on average. 
Correspondingly, in simulation of the interevent time of typhoon events under these climate 
change scenarios, interevent time of 432 and 540 hours were adopted, respectively. 
A total of 50 years of continuous storm rainfall simulation (including all storm types) 
using the method described in section 2 were conducted. From the simulated hourly rainfall 
data, annual maximum rainfalls of 1-hour and 24-hour design durations were extracted. The 
annual maximum rainfalls are considered having a Pearson type 3 distribution and 1-hr and 
24-hr design storm depths of 10, 25, 50, 100 and 200-year return periods were calculated. 
Table 1 lists the 1-hr and 24-hr design storm depths under certain climate change scenarios. 
The effect of climate changes on 1-hr and 24-hr design storm depths under different scenarios 
can be assessed by comparing the results of frequency analysis using simulated rainfall data. 
Figures 7 and 8 demonstrate the 1-hr and 24-hr design storm depths of various return periods 
with respect to different climate change scenarios. 
Under the scenario 1 condition (432 hours of average interevent time), the 1-hour design 
storm depth increases by 15%, 17%, and 25% for 50, 100, and 200-year return periods, 
respectively. In comparison, under scenario 2, the 1-hour design storm depth decreases by 30%, 
33%, and 35% for 50, 100, and 200-year return periods, respectively. The 24-hour design storm 
depth increases by 6%, 13%, and 22% respectively for 50, 100, and 200-year return periods, 
under the scenario 1 condition. For the scenario 2 condition, the 24-hour design storm depth 
decreases by approximately 24% for 50, 100, and 200-year return periods. 
 
Table 1. Design storm depths (in mm) under certain climate change scenarios. 
Duration (hours) 
Total depth (mm) 
 41 
 
5 CONCLUSIONS 
The stochastic storm rainfall simulation model provides a means for assessing the impact 
of climate change on design storm depths, although more detailed and rigorous validation of 
the simulation results is needed. Under scenario 1, the 1-hour design storm depth at raingauge 
5 increases by 15%, 17%, and 25% for 50, 100, and 200-year return periods, respectively. In 
comparison, under scenario 2, the 1-hour design storm depth decreases by 30%, 33%, and 
35% for 50, 100, and 200-year return periods, respectively. The 24-hour design storm depth at 
raingauge 5 increases by 6%, 13%, and 22% respectively for 50, 100, and 200-year return 
periods, under the scenario 1 condition. For the scenario 2 condition, the 24-hour design storm 
depth decreases by approximately 24% for 50, 100, and 200-year return periods. 
 
REFERENCES 
Cameron, D, Beven, K. & Tawn, J. (2000), An Evaluation of Three Stochastic Rainfall Models. 
Journal of Hydrology, 228, 130–149. 
Cheng, K.S., Hueter, I., Hsu, E.C. & Yeh, H.C. (2001), A Scale-invariant Gauss-Markov 
Model for Design Storm Hyetographs. Journal of the American Water Resources 
Association, Vol. 37, No. 3, 723-736. 
Felzer, B. & Heard, P. (1999), Precipitation Differences Amongst GCMs Used for the US 
National Assessment, Journal of the American Water Resources Association, Vol. 35, No. 
6,1327-1340. 
Koutsoyiannis, D. & Pachakis, D. (1996), Deterministic Chaos Versus Stochasticity in 
Analysis and Modeling of Point Rainfall Series. Journal of Geophysical Research, 110, D21, 
26441-26451. 
Koutsoyiannis, D. & Mamassis, N. (2001), On the Representation of Hyetograph 
Characteristics by Stochastic Rainfall Models. Journal of Hydrology, 251, 65 – 87. 
Marshall, A.W. & Olkin, I. (1967), A Generalized Bivariate Exponential Distribution. Journal 
of Applied Probability, Vol. 4, 291-302. 
National Assessment Synthesis Team (2000), Climate Change Impacts on the United States - 
The Potential Consequences of Climate Variability and Change: Overview Report. 
Cambridge University Press. 
Restrepo-Posada P.J. & Eagleson, P.S. (1982), Identification of Independent Rainstorms. 
Journal of Hydrology, 55, 303-319. 
Rulli, M.C. & Rosso, R. (2002), An Integrated Simulation Method for Flash-flood Risk 
Assessment. Hydrology and Earth System Sciences, Vol. 6, No. 2, 267-283. 
 43 
campaigns were conducted in a coastal area north to the tunnel outlet. Water samples were 
taken within 0 – 20 cm range below the sea surface at eight locations (see Figure 1) during 
each sampling campaign. Considering the west-to-east surface current direction of the season, 
the sampling area extends from a little northwest of the outlet to about 2 km to the east of the 
outlet. Sampling point 4 is located within an area known as the Yin-Yang Sea. The Yin-Yang 
Sea area, just offshore from an old metal mining township, constantly receives runoff 
containing high iron ion concentration, making the sea surface visually distinct. Secchi disk 
depth and turbidity were measured in situ and water samples were taken to lab for analyses of 
suspended solids and other properties.  
 
 
Fig. 1 Water sampling locations in coastal area near the YST tunnel outlet. 
 
2 ANALYSIS OF REMOTE SENSING IMAGES  
The rationale of using satellite images for environmental monitoring is that digital 
numbers (DN) of satellite images are reflective of variations in characteristics of terrestrial or 
water environment. Digital numbers, also known as grey levels, of satellite images are linearly 
related to radiances received at the sensor onboard the satellite. However, radiances received 
at the sensor may come from different sources, and the relationships between digital numbers 
and properties of environmental variables on earth surface are far from clear. To circumvent 
such problems, techniques of satellite image analysis described below are applied in this study. 
Considering radiances from different paths, the amount of solar radiance reaching the 
satellite sensor can be expressed as (Schott, 1997): 
),()(),(),( 2 dudrds LLL φθλτφθφθ λλλ +=     (1) 
where 
λsL = solar radiance reaching the sensor 
λrL = reflected solar irradiance 
λuL = upwelled solar radiance 
θ = the view angle in the sensor-target direction 
φd = the azimuth angle in the sensor-target direction 
)(2 λτ = atmospheric transmittance along the target-sensor path.  
λ = spectral wavelength of solar radiation. 
 
 45 














+












⋅














=
nnnnnn TSSTbSDD
TSSTbSDD
TSSTbSDD
IRRG
IRRG
IRRG
εεε
εεε
εεε
βββ
βββ
βββ
βββ
ρρρ
ρρρ
ρρρ
MMMMMM
222
111
222
111
332313
322212
312111
302010
1
1
1
1
  (5) 
where s'ijβ  represent regression coefficients, ρ and ε are respectively sea surface reflectance 
and random component with respect to the spectral band or water quality variable shown in 
their subscripts, and n is the number of water quality measurements. The above multivariate 
regression model can also be expressed as 
EXWY +=         (6) 
where Y, X and W are respectively matrices of the water quality measurements, surface 
reflectance, and regression coefficients, and E is the error matrix. The least squared estimator 
of the regression coefficients is (Dunteman, 1984) 
YXXXW 1 ′′= −)(        (7) 
Using a total of 25 samples of water quality measurements and their corresponding 
multispectral sea surface reflectances, the regression coefficient matrix W is estimated to be 
=W












332313
322212
312111
302010
βββ
βββ
βββ
βββ












−−
−
−
−−
=
36.026.025.0
79.405.199.3
97.032.054.0
58.093.042.10
   (8) 
Thus, water quality estimates of the multivariate model are obtained by the following 
equation: 
[ ] =TSSTbSDD [ ]












−−
−
−
−−
⋅
36.026.025.0
79.405.199.3
97.032.054.0
58.093.042.10
1 IRRG ρρρ   (9) 
Results of water quality estimation using the proposed multivariate model are shown in Figure 
2. 
 
 
Fig. 2 Water quality measurements versus estimates using the multivariate estimation model. 
 
 47 
effect of individual constituents on sea surface reflectance and yields more accurate water 
quality estimation results. 
 
AKNOWLEDGMENTS 
We are grateful to the 10th River Bureau of the Water Resources Agency, Taiwan for the 
financial support of this research project.  
 
REFERENCES 
Dunteman, G.H. (1984), Introduction to Multivariate Analysis. Sage Publications, 1984; 237p. 
Schott, J.R. (1997), Remote Sensing. Oxford University Press, 394p. 
Su et al. (2008), Coastal water quality mapping using satellite remote sensing images. Sensors, 
8, 6321-6339. 
 
 
 49 
一、前言 
水文頻率分析於水工設計或防洪排水計劃中，是不可或缺的分析工作，其原理主要
是由過去的水文實測記錄，歸納其特性，並依此推估未來最可能發生之水文情形。其分
析程序包括(1)水文觀測資料之選取(2)合適機率分布之選取(3)機率分布參數之推估(4)設
計水文量之決定。在水工設計中，諸如壩高、堤防高度、設計流量之決定，完全取決於
頻率分析之結果，由此可知其為設計時一個重要指標。 
然而，傳統降雨量頻率分析的程序，遭遇到兩個問題：其一是水文觀測資料選取為
針對指定的設計暴雨延時(design storm duration)選取該設計延時所對應之降雨量年最大
值序列(annual maximum series)，但該年最大值序列的降雨量與其對應延時均與真實暴雨
事件之降雨特性無關。因而造成該設計延時所獲得之年最大降雨量的真實降雨延時與設
計延時通常並不相等。可見依據設計延時所選取之年最大降雨量其實並未能代表真實降
雨事件之特性。傳統基於年最大值序列之水文頻率分析，只是一種工程設計上方便採用
之作法，與真實世界之狀況有所差異；其二是傳統頻率分析將特定設計延時之年最大降
雨量視為某個隨機變數之隨機樣本，並具以推估其機率分布特性。此種作法其實是在設
計延時給定之狀況下，探討降雨量之超越機率，是一種條件機率分布特性之研究。雖然
在傳統降雨量頻率分析中，幾種長短設計延時(如 1、2、24 及 48 小時)常被採用，但真
實暴雨事件之延時本身即為一個因地區而異的隨機變數。且真實降雨事件之總降雨量與
事件延時(非設計延時)具明顯相關特性，而可以雙變數聯合機率分布描述之 (Shiau, 2003, 
Shiau et al., 2006, Grimaldi and Serinaldi, 2006, Zhang and Singh, 2007)。其中(Cheng,2007)
發現真實暴雨事件之延時與總降雨量可以雙變數伽瑪分布描述之。故本研究將以雙變數
伽瑪分布之聯合機率密度函數，進行降雨量頻率分析，期能改善傳統降雨量頻率分析的
程序所遭遇的問題。 
二、研究方法 
2.1 降雨事件特性模擬 
由於降雨延時與總降雨量之間為正相關且具雙變數伽瑪分布之特性，故在模擬降雨
延時與總降雨量時，本研究採取雙變數伽瑪分布來模擬降雨事件發生時，其雙變數伽瑪
分布的模擬說明如下。 
2.1.1 雙變數伽瑪分布之模擬 
雙變數伽瑪分布序率模擬為利用水文頻率分析通用方程式之頻率因子逼近式推演，
而水文頻率分析之通用方程式如(1)所示： 
 
XTXT KX σµ +=
  (1) 
其中 Xµ 為水文變數 X 之期望值， Xσ 為水文變數 X 之標準偏差，XT 為超越機率為 1/T
之水文量， TK 為因機率分布類型而異且對應於重現期 T 之頻率因子。皮爾遜第三型分
布頻率因子如(2)所示： 
 51 
nuuu ,,, 21 L 之繁衍，再利用條件機率分布特性，進行單變數常態分布( iuUV =| )隨機樣本
nvvv ,,, 21 L 之繁衍。最後則利用頻率因子逼近式及頻率分析通用方程式，將 nuuu ,,, 21 L 與
nvvv ,,, 21 L 轉換成 nxxx ,,, 21 L 與 nyyy ,,, 21 L 。 
2.1.2 雙變數伽瑪分布聯合機率密度函數 
雙變數伽瑪分布機率密度函數之積分極為不易，故本研究擬從雙變數標準常態分布
與雙變數伽瑪分布之轉換關係著手。當偏態係數給定時，式(2)為頻率因子與標準常態變
數之一對一映射函數。利用此一對一映射關係，雙變數伽瑪分布之超越機率(或累積機率)
即等於對應之雙變數常態分布之超越機率，亦即 
),(),( vVuUPyYxXP ≥≥=≥≥        (8) 
其中 ))(()),(( 11 vFyuFx Φ=Φ= −− ，F 與Φ分別為伽瑪分布與標準常態分布之累積分布函
數。故我們僅先計算特定(x,y)之對應(u,v)，再計算雙變數標準常態分布之累積機率即可。
至於雙變數標準常態分布之累積機率可利用套裝軟體如 Matlab 輕易求得。 
2.2 降雨頻率分析 
本研究選取主要氣象站歷年之時雨量記錄，並整理所有降雨事件之事件延時與與總
降雨量，構成一組全取序列(complete series)並推估降雨事件延時與總降雨量伽瑪分布之
各參數。全取序列之任意暴雨事件之重現期可依據下式計算(Shiau, 2003)： 
),()()(1],[ yxFyFxFyYxXP XYYX +−−=>>              (9) 
),()()(1
)()(
yxFyFxF
LETE
XYYX
xy
+−−
=  (10) 
上式中 E(L)為全取序列中兩相鄰事件發生時間間距之期望值。 )( xyTE 為重現期距之期望
值。 
三、資料概述 
本研究中所採用的雨量資料為交通部中央氣象局所提供之台中站(467490)資料，其
資料長度為自 1954 至 2007 年連續時雨量資料。降雨事件的切割為將台灣整年的降雨類
型依發生時期分成鋒面雨(11 月~隔年 4 月)、梅雨(5 月~6 月)、對流雨(7 月~10 月)及颱風
(7 月~10 月)，接著在設定降雨事件為延時 1 小時及總降雨量 0.5mm 視為影響甚小之事
件並移除之。參照許恩菁、鄭克聲(1999)，降雨事件的間距採 4 小時，對於 7 月至 10 月
間對流雨及颱風類型之降雨分割，以延時 12 小時為基準，延時大於 12 小時者，視為颱
風。 
四、結果與討論 
4.1 雙變數伽瑪分布之模擬 
在模擬降雨延時與總降雨量時，本研究採取雙變數伽瑪分布，由於其所需的參數有
降雨延時之平均值、標準偏差、偏態係數、總降雨深度之平均值、標準偏差、偏態係數
及相關係數。且其統計參數會隨著降雨類型不同而有所差異，故在模擬前需先針對各降
雨類型進行參數的推估，其推估的統計參數如表 1 所示。 
由於在進行水文頻率分析時，常遭遇到歷史雨量資料不足，而導致分析結果有偏差，
為能減少此偏差，因此本研究利用雙變數伽瑪分布針對各降雨類型，包括鋒面雨、梅雨、
 53 
 
 
 
 
 
4.2 降雨量頻率分析 
根據(Shiau, 2003)全取序列之任意暴雨事件之重現期計算式(10)，若得全取序列中兩
 55 
 
 
五、結論 
1. 由雙變數伽傌模擬的結果可知，降雨量與降雨延時可以利用雙變數伽傌來進行模擬。 
2. 從降雨頻率分析的結果可知，造成最大降雨量的事件延時隨著不同的重現期距而有所
不同。 
3. 降雨類型包含峰面雨、梅雨、對流雨及颱風雨，而根據降雨頻率分析的結果可知，其
隨著降雨類型的不同所分析的結果亦有所差異。 
4. 由於設計延時和事件延時其定義不同，特別是在長延時或短延時的降雨事件，所以建
議以雙變量的頻率分析取代單變量的頻率分析。 
 
參考文獻 
 57 
國際研討會 
The Fourth Joint PI symposium of ALOS Data Nodes for ALOS 
Science Program in Tokyo 
11/14/2010 – 11/17/2010 
 發表口頭論文 
Comparing landcover patterns in Tokyo, Kyoto, and Taipei using A
LOS multispectral images 
 
 受邀擔任分組報告主持人(Session chair)。 
 
 
 59
序率模擬技術研發及其在水文分析與預測之應用(第三年) 
水文模式表現評估之研究 
Evaluation of hydrological model performance 
 
INTRODUCTION 
Like many other processes in the natural environment, the rainfall-runoff process is composed of 
many sub-processes which involve complicated and scale-dependent temporal and spatial 
variations. Although research in rainfall-runoff modeling has had significant progress in the last 
century, we are still not able to identify all sub-processes and variables that physically 
characterize the rainfall-runoff process. Very often, in hydrology, the problems are not clearly 
understood for a meaningful analysis using physically-based methods. It appears that even less 
complicated hydrological processes cannot be fully characterized using only physical models. 
For this reason, many conceptual models and physical models coupled with random components, 
also known as the hybrid models, have been proposed for rainfall-runoff modeling (Nash and 
Sutcliffe, 1970; Bergström and Forsman, 1973; Bergström, 1976; Rodŕiguez-Iturbe and Valdés, 
1979; Rodriguez-Iturbe, 1982; Lindström et al., 1997; Du et al., 2009). These models are 
established based on our understanding or conceptual perception about the mechanisms of the 
rainfall-runoff process. For example, the Nash linear reservoir model considers the watershed as 
a cascade series of linear reservoirs and the direct runoff at the watershed outlet is calculated as 
the convolutional sum of the watershed response to rainfall excesses. Such conceptual perception 
stems from our understanding of the bulk response of the watershed to rainfall inputs. Similarly, 
the kinematic wave model considers a watershed as a wide open channel, with inflow to the 
channel equal to the excess precipitation. The continuity equation and momentum equation are 
employed for overland flow calculation. 
In addition to pure physical and conceptual models, empirical data-driven models such as the 
artificial neural networks (ANN) models for runoff estimation or forecasting have also gained 
much attention in recent years. Empirical models treat the watershed as a black box and try to 
find a relationship between inputs (rainfall) and outputs (watershed runoff measured at a stream 
gauge) using historical data. These methods usually require long historical records and lack 
physical basis. As a result, they are not applicable for ungauged watersheds (ASCE Task 
Committee, 2000). In many respects, ANNs are similar to regression-based models in hydrology, 
except that they do not require specification of a mathematical form. The success of an ANN 
application depends both on the quality and the quantity of the available data. This requirement 
cannot be easily met, as many hydrologic records do not go back far enough (ASCE Task 
Committee, 2000). 
Regardless of which types of models are used, almost all models need to be calibrated using 
observed data. Model calibration is the task of identifying appropriate model structure and an 
appropriate parameter set within this structure. This task encounters a range of uncertainties 
which stem from different sources including data uncertainty, parameter uncertainty, and model 
structure uncertainty (Wagener et al., 2004). The uncertainties involved in model calibration will 
unavoidably propagate to the model outputs, resulting in uncertainties in model outputs. The 
 61
∑
=
−=
n
t
tt QQ
n
MAE
1
ˆ
1
 (2) 
n = number of data points. 
(3) Correlation coefficient (r) 
∑∑
∑
==
=
−−
−−
=
n
t
t
n
t
t
n
t
tt
QQQQ
QQQQ
r
1
2
1
2
1
)ˆˆ()(
)ˆˆ)((
 (3) 
Q = mean of observed Q, Qˆ = mean of predicted flow Qˆ . 
(4) Root-mean-squared error (RMSE) 
n
SSERMSE = , (4a) 
∑
=
−=
n
t
tt QQSSE
1
2)ˆ( . (4b) 
(5) Normalized Root-mean-squared error (NRMSE) (Corzo and Solomatine, 2007; Pebesma et 
al., 2007) 
obs
RMSENRMSE
σ
=
 (5a) 
obsσ = standard deviation of observed data Q.  
or 
Q
RMSENRMSE = . (5b) 
(6) Coefficient of efficiency (CE) (Nash and Sutcliffe, 1970) 
∑
∑
=
=
−
−
−=−=
n
t
t
n
t
tt
m QQ
QQ
SST
SSECE
1
2
1
2
)(
)ˆ(
11  (6) 
Q = mean of observed data Q. 
mSST = Total sum of squared errors with respect to the mean value. 
(7) Coefficient of persistence (CP) (Kitanidis and Bras, 1980) 
∑
∑
=
−
=
−
−
−=−=
n
t
ktt
n
t
tt
N QQ
QQ
SSE
SSECP
1
2
1
2
)(
)ˆ(
11  (7) 
NSSE  = Sum of squared errors of the naïve (or persistent) forecasting model ( ktt QQ −=ˆ ) 
(8) Error in peak flow (or stage) in percentages or absolute value (Ep) 
%100
ˆ
×
−
=
p
pp
Q
QQ
Ep  (8) 
 63
Qb,t = the value of the benchmark series Qb at time t. 
The bench coefficient provides a general form for measures of goodness-of-fit based on 
benchmark comparisons. The coefficient of efficiency and coefficient of persistence are bench 
coefficients with respect to benchmark series of the constant mean series and the naïve-forecast 
series, respectively. The bottom line, however, is what benchmark series should be used for the 
target application. 
Among the three most widely used MPE criteria (RMSE, CE, and MAE), RMSE and MAE 
provide goodness-of-fit measures of the model output without comparing with certain 
benchmark series. It is worthy to note that small values of RMSE and MAE do not necessarily 
guarantee recommendation for using the considered model. For hydrological processes with 
strong persistence, an autoregressive model may be able to achieve smaller values of RMSE and 
MAE than other complicated models. Thus, even if a complicated model is considered having an 
acceptable performance based on its values of RMSE and MAE, it may not be recommended if 
an autoregressive model (which is considered as the benchmark model) is shown to be more 
superior. In the subsequent sections, we first demonstrate presence of the parameter uncertainty 
and model structure uncertainty in model calibration stage using sample series generated by 
stochastic simulation. We then evaluate the uncertainties in three MPE criteria, namely RMSE, 
CE, and CP, using models with calibrated parameters. 
MODEL PERFORMANCE EVALUATION USING SIMULATED SERIES 
Flows at the watershed outlet exhibit significant persistence and time series of streamflows can 
be represented by the autoregressive model. Thus, we suggest using the AR(2) model as the 
benchmark series for flood forecasting model performance evaluation. In this section we 
demonstrate the parameter and model structure uncertainties using random samples of AR(2) 
models. 
Parameter and model structure uncertainties 
In order to demonstrate uncertainties involved in model calibration and to assess the effects of 
the parameter and model structure uncertainties on MPE criteria, sample series of the following 
AR(2) model were generated by stochastic simulation 
tttt XXX εφφ ++= −− 2211 , (10) 
),0(~ 2εσε Niidt , 12 <φ , 111 2
1 <
−
<− φ
φ
. 
It can be shown that AR(2) model has the following properties: 
2
1
1 1 φ
φρ
−
= , (11) 
2
2
2
1
2 1
φφ
φρ +
−
= ,  (12) 
and 
)1( 2211
2
2
ρφρφ
σ
σ ε
−−
=X  (13) 
where 1ρ and 2ρ are respectively lag-1, lag-2 autocorrelation coefficients of the random process 
 65
uncertainties, but not the model structure uncertainties since the sample series were modeled 
with a correct form. In order to assess the effect of model structure uncertainties, the same 
sample series were modeled by an AR(1) model through a similar process of Figure 1. Histogram 
of AR(1) parameter estimates ( 1ˆφ ) with respect to different values of εσ are shown in Figure 4. 
Averages of 1ˆφ with respect to various values of εσ are approximately 0.71 which is significantly 
different from the AR(2) model parameters ( 3.0,5.0 21 == φφ ) owing to the model specification 
error. Parameter uncertainties (
1
ˆφs ) of AR(1) modeling, which are about the same magnitude as 
that of AR(2) modeling, are independent of the noise variance. It shows that the model 
specification error does not affect the parameter uncertainties. However, the bias in parameter 
estimation of AR(1) modeling will result in a poorer forecasting performance and higher 
uncertainties in MPE criteria, as described in the next subsection. 
 
Uncertainties in MPE criteria 
Through the process of Figure 1, uncertainties in MPE criteria (RMSE, CE and CP) by AR(1) 
and AR(2) modeling and forecasting of the data series can be assessed. The RMSE is dependent 
on Xσ which in turn depends on εσ . Thus, we evaluate uncertainties of the root- mean-squared 
errors normalized by the sample standard deviation Xs , i.e. NRMSE (Eq. 8a). Figure 5 
demonstrates the uncertainties of NRMSE for the AR(1) and AR(2) modeling. AR(1) modeling 
of the sample series involves parameter uncertainties and model structure uncertainties, while 
AR(2) modeling involves only parameter uncertainties. Although the model specification error 
does not affect parameter uncertainties, it results in bias in parameter estimation, and thus 
increases the magnitude of NRMSE. Mean value of NRMSE by AR(2) modeling is about 95% of 
the mean NRMSE by AR(1) modeling. Standard deviation of NRMSE by AR(2) modeling is 
approximately 88% of the standard deviation of NRMSE by AR(1) modeling. Such results 
indicate that presence of the model specification error results in a poorer performance with 
higher mean and standard deviation of NRMSE. 
Histograms of CE and CP for AR(1) and AR(2) modeling of the data series are shown in 
Figures 6 and 7, respectively. On average, CE of AR(2) modeling (without model structure 
uncertainties) is about 10% higher than CE of AR(1) modeling. In contrast, the average CP of 
AR(2) modeling is approximately 55% higher than the average CP of AR(1) modeling. The 
difference in mean CP values of AR(1) and AR(2) modeling is much more significant than that of 
CE and NRMSE, suggesting that CP is a more sensitive MPE criterion with presence of model 
structure uncertainty. 
CONCLUSIONS 
In this study we evaluate a few criteria for hydrological model performance evaluation 
through stochastic simulation. A few concluding remarks are as follows: 
(1)  An important concern about the model performance evaluation is the uncertainty of the 
model performance itself. Due to the uncertainties in the model outputs, a specific MPE 
 67
goodness-of-fit in hydrologic and water quality modeling. Journal of Hydrology 337: 326– 
336. 
Kitanidis PK and Bras RL. 1980. Real-time forecasting with a conceptual hydrologic model, 2, 
applications and results. Water Resources Research 16 (6): 1034–1044. 
Kuczera G. 1997. Efficient subspace probabilistic parameter optimization for catchment models. 
Water Resources Research 33(1): 177-185. 
Kuczera G and Mroczkowski M. 1998. Assessment of hydrologic parameter uncertainty and the 
worth of multiresponse data. Water Resources Research 34(6): 1481-1489. 
Lauzon N, Anctil F, and Baxter CW. 2006. Clustering of heterogeneous precipitation fields for 
the assessment and possible improvement of lumped neural network models for streamflow 
forecasts. Hydrology and Earth System Sciences 10: 485-494. 
Legates DR, McCabe Jr. GJ. 1999. Evaluating the use of “goodness-of-fit’’ measures in 
hydrologic and hydroclimatic model validation. Water Resources Research 35(1): 233–241. 
Lin GF, Wu MC, Chen GR, and Tsai FY. 2009. An RBF-based model with an information 
processor for forecasting hourly reservoir inflow during typhoons. Hydrological Processes 23: 
3598–3609. 
Lindström G, Johansson B, Persson M, Gardelin M, and Bergström S. 1997. Development and 
test of the distributed HBV-96 hydrological model. Journal of Hydrology 201: 272-288. 
Markus M, Tsai CWS, and Demissie M. 2003. Uncertainty of weekly nitrate-nitrogen forecasts 
using artificial neural networks. Journal of Environmental Engineering 129(3): 267–274. 
Melone F, Barbetta S, Diomede T, Peruccacci S, Rossi M, Tessarolo A, and Verdecchia M. 2005. 
Review and selection of hydrological models –Integration of hydrological models and 
meteorological inputs. RISK-Advanced Weather forecast system to Advise on Risk Events 
and management. INTEREG IIIB CADSES Programme, European Union. 
www.smr.arpa.emr.it/riskaware/get.php?file=Report_WP1.13.doc, access date: August 21, 
2010. 
Michaud JD and Sorooshian S. 1994. Comparison of simple versus complex distributed runoff 
models on a midsized semiarid watershed. Water Resources Research 30(3): 593-605. 
Moriasi DN, Arnold JG, Liew MWV, Bingner RL, Harmel RD, and Veith TL. 2007. Model 
evaluation guidelines for systematic quantification of accuracy in watershed simulations. 
Transactions of the American Society of Agricultural and Biological Engineers 50(3): 
885-900. 
Nash JE and Sutcliffe JV. 1970. River flow forecasting through conceptual models. Part I. A 
discussion of principles. Journal of Hydrology 10: 282–290. 
Pebesma EJ, Switzer P, and Loague K. 2007. Error analysis for the evaluation of model 
performance: rainfall–runoff event summary variables. Hydrological Processes 21: 
3009–3024. 
Refsgaard JC. 1994. Model and data requirements for simulation of runoff and land surface 
processes in relation to global circulation model. Global Environmental Change and Land 
Surface Processes in Hydrology: The Trials and Tribulations of Modeling and Measuring. S. 
Sorooshian, H.V. Gupta, and S.C. Rodda, eds., NATO Advanced Science Institute on Global 
 69
 
 
Figure 1. Illustrative diagram showing the process of (1) parameter estimation, (2) 
forecasting, (3) MPE criteria calculation, and (4) uncertainty assessment of MPE criteria. 
 
 
 71
 
 
 
Figure 3. Scatter plots of ( 1ˆφ , 2ˆφ ) for AR(2) model with different values of εσ . Ellipses represent 
the 95% density contours, assuming bivariate normal distribution for 1ˆφ and 2ˆφ . [Theoretical data 
model: tttt XXX ε++= −− 21 3.05.0 .] 
 
 
 
Figure 4. Histograms of parameter estimates ( 1ˆφ ) using AR(1) model. Uncertainty in parameter 
estimation is independent of the noise variance 2εσ . [Theoretical data model: 
+=
−15.0 tt XX ttX ε+−23.0 .] 
1
ˆφ  
2
ˆφ
1
ˆφ  
2
ˆφ
1
ˆφ  
2
ˆφ
1
ˆφ  
2
ˆφ
0.68 
034.0
710.0ˆ
5
1
ˆ
1
=
=
=
φ
ε
φ
σ
s
033.0
712.0ˆ
1
1
ˆ
1
=
=
=
φ
ε
φ
σ
s 034.0
710.0ˆ
3
1
ˆ
1
=
=
=
φ
ε
φ
σ
s
034.0
710.0ˆ
7
1
ˆ
1
=
=
=
φ
ε
φ
σ
s
1
ˆφ  1ˆφ  
1
ˆφ  1ˆφ  
 73
 
    
 
    
 
    
 
    
 
Figure 6. Histograms of the coefficient of efficiency (CE) for AR(1) and AR(2) modeling with 
respect to various noise variance 2εσ . 
 
 
102.0
462.0
7
=
=
=
s
m
εσ
 
103.0
461.0
5
=
=
=
s
m
εσ
 
095.0
509.0
5
=
=
=
s
m
εσ
 
092.0
510.0
7
=
=
=
s
m
εσ
 
AR(1) AR(2) 
AR(1) AR(2) 
102.0
462.0
3
=
=
=
s
m
εσ
 
100.0
464.0
1
=
=
=
s
m
εσ
 
093.0
510.0
1
=
=
=
s
m
εσ
 
094.0
509.0
3
=
=
=
s
m
εσ
 
CE CE
AR(1) AR(2) 
AR(1) AR(2) 
CE CE
CE CE
CE CE
 75
國際研討會 
10th Internatinal Conference on Hydroinformatics 
July 14-18, 2012 
HIC 2012, Hamburg, Germany 
 發表口頭論文 
Model Performance Evaluation for Real-time Hydrological Forecasting 
 
 受邀擔任分組報告主持人(Session chair - Application of Data-driven 
Modelling in Water Sciences)。 
 
 
 
Model Performance Evaluation for  
Real-time Hydrological Forecasting 
 
 
Ke-Sheng Cheng1, Yii-Chen Wu1, Yuan-Fong Su1 
1Department of Bioenvironmental Systems Engineering, National Taiwan University, Taipei, Taiwan, ROC  
 
 
All hydrological processes involve certain degrees of randomness and thus hydrological modeling and 
forecasting inevitably yield results with errors that must be evaluated probabilistically. A few criteria for 
model performance evaluation such as root-mean-squared error (RMSE), coefficient of efficient (CE), 
coefficient of persistence (CP) and maximum absolute error (MAE) have been proposed. However, these 
criteria often are applied to a limited number of available events. The uncertainty and sensitivity of these 
criteria to variations in input data have mostly been overlooked. Additionally, the concept of choosing 
appropriate benchmark for model performance evaluation has not received wide recognition. Using 
constant mean and naïve forecasts as benchmark comparisons are not acceptable in most streamflow 
forecasting practices. In this study we demonstrate that a unique and important feature of the flow at 
 77
 
國科會補助專題研究計畫成果報告自評表 
請就研究內容與原計畫相符程度、達成預期目標情況、研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）、是否適
合在學術期刊發表或申請專利、主要發現或其他有關價值等，作一綜合評估。 
1. 請就研究內容與原計畫相符程度、達成預期目標情況作一綜合評估 
 達成目標 
□ 未達成目標（請說明，以 100 字為限） 
□ 實驗失敗 
□ 因故實驗中斷 
□ 其他原因 
說明： 
 
 
 
2. 研究成果在學術期刊發表或申請專利等情形： 
論文：已發表 □未發表之文稿 □撰寫中 □無(尚有部分成果撰寫論文中) 
專利：□已獲得 □申請中 □無 
技轉：□已技轉 □洽談中 □無 
其他：（以 100 字為限） 
 
 
 
3. 請依學術成就、技術創新、社會影響等方面，評估研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）（以
500 字為限） 
本計畫建立多變量序率水文模擬技術，並應用於水文模式表現評估。此技術
可廣泛應用於其他隨機現象之模擬與風險評估，尤其對防災領域而言有具體
之貢獻。 
 
 
 
 
 
 
 
 79
三、發表論文全文或摘要 
Model Performance Evaluation for Real-time Hydrological Forecasting 
Ke-Sheng Cheng1, Yii-Chen Wu1, Yuan-Fong Su1 
1Department of Bioenvironmental Systems Engineering, National Taiwan University, Taipei, Taiwan, ROC  
 
All hydrological processes involve certain degrees of randomness and thus hydrological modeling and 
forecasting inevitably yield results with errors that must be evaluated probabilistically. A few criteria for 
model performance evaluation such as root-mean-squared error (RMSE), coefficient of efficient (CE), 
coefficient of persistence (CP) and maximum absolute error (MAE) have been proposed. However, these 
criteria often are applied to a limited number of available events. The uncertainty and sensitivity of these 
criteria to variations in input data have mostly been overlooked. Additionally, the concept of choosing 
appropriate benchmark for model performance evaluation has not received wide recognition. Using 
constant mean and naïve forecasts as benchmark comparisons are not acceptable in most streamflow 
forecasting practices. In this study we demonstrate that a unique and important feature of the flow at 
watershed outlet is its persistence, particularly for the cases of large watersheds. Such persistence feature 
indicates that previous flow observations can provide valuable information for real-time flow forecasting. 
Thus, the autoregressive models are chosen as benchmarks for model performance evaluation. 
Specifically, we derive the asymptotic relationship between CE and CP for a given sample data series. We 
also derive the asymptotic CE-CP relationships for the AR(1) and AR(2) models which can be used to 
determine the minimum acceptable CE and CP values based on the value of sample lag-1 autocorrelation 
coefficient. In this study we propose to use the model-based bootstrap sampling techniques to generate 
bootstrap samples and to assess uncertainties of model performance evaluation using the asymptotic 
CE-CP relationships of AR models. Finally, we used several storm events occurred in Taiwan to evaluate 
the performance of real-time flow forecasting by ANN models. 
四、建議 
 無 
五、攜回資料名稱及內容 
會議議程及相關介紹資料 
六、其他 
無 
 
 2
indicates that previous flow observations can provide valuable information for real-time 
flow forecasting. Thus, the autoregressive models are chosen as benchmarks for model 
performance evaluation. Specifically, we derive the asymptotic relationship between CE 
and CP for a given sample data series. We also derive the asymptotic CE-CP 
relationships for the AR(1) and AR(2) models which can be used to determine the 
minimum acceptable CE and CP values based on the value of sample lag-1 
autocorrelation coefficient. In this study we propose to use the model-based bootstrap 
sampling techniques to generate bootstrap samples and to assess uncertainties of model 
performance evaluation using the asymptotic CE-CP relationships of AR models. Finally, 
we used several storm events occurred in Taiwan to evaluate the performance of real-time 
flow forecasting by ANN models. 
 
98年度專題研究計畫研究成果彙整表 
計畫主持人：鄭克聲 計畫編號：98-2221-E-002-111-MY3 
計畫名稱：序率模擬技術研發及其在水文分析與預測之應用 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 3 3 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
