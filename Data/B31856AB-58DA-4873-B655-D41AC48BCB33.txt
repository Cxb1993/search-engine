國科會補助提升產業技術及人才培育研究計畫成果精簡報告 
學門領域：生產自動化 
計畫名稱：光電式空油壓致動器行程量測器之研發 
計畫編號：NSC 94-2622-E-006-042 
執行期間：94 年 11 月 1 日至 95 年 10 月 31 日 
執行單位：國立成功大學機械工程學系(所) 
主 持 人：蔡明俊  教授 
參與學生： 
姓   名 年   級 
(大學部、碩
士班、博士
班) 
已發表論文或已申請之專利 
(含大學部專題研究論文、碩博
士論文) 
工作內容 
陳侑群 碩士班  設計製造程式撰寫與
測試 
    
    
合作企業簡介 
合作企業名稱：隆運空油壓股份有限公司 
計畫聯絡人：游新宏 
資本額：1460  萬元 
產品簡介：空油壓致動器、近接開關 
網址：              電話：(07)7886680 
研究摘要(500 字以內)： 
人才培育成果說明：隆運空油壓股份有限公司 
技術研發成果說明： 
我國的空油壓產業已經愈來愈成熟，特別是對於國外高級品牌的 OEM
代工已經是受全世界的肯定，但是國內自創品牌的廠商卻必需以較低的價位
來銷售自已的產品。主要的原因是國內廠商缺乏各種性能檢測技術，一來無
法進行產品最佳化的細部設計流程，產品改良緩慢；再者，在高價位產品市
場，國際大廠來採購時常常要求提出產品測試報告時無法交出確實的數據。 
本計畫乃接受隆運空油壓公司的委託，開發 PC 平台上之空油壓致動器
性能試驗平台，可量測在一定的氣壓條件下致動器行程的準確度，從而評估
致動器的穩定性。將實驗數據以程式分析檢視，除了供性能選用的參考外，
進而可據以改良設計，期能因而縮短相關產品的開發週期，提升我國油氣壓
幾何模型與進行運動狀態模擬，只需操作機台進行測試即可。 
4. 測試機價錢便宜彈性大，只要製作各式轉換接頭，即可適用於大小
不同之致動器。 
空油壓產業在我國已有相當的生產水準，國內接受國外知名廠商的代工
訂單數量很大。但是由於缺乏產品檢驗能力，無法有效率的研發及設計自有
品牌的產品，因此無法與先進的德、日相抗衡。測試機台的資料擷取與主控
板的應用很廣，其技術可應用於其他產業有關測試機台的開發，發展成各產
業的專業測試機。如此可提昇國內自動化工程系統的整合技術，帶動國內開
發各式專用機，減少進口機器設備之依賴程度，進而可輸出設備，對增進經
濟建設有正面的影響。免除事事依賴國外產品，而無法依自己需求而修改或
增加功能的窘境。本計畫初步開發產品檢驗技術，具有抛磚引玉的意義，相
信國內學者參與檢驗技術之開發風氣日盛後，我國技術將可與日、德相抗衡。 
 
※ 備註：精簡報告係可供國科會立即公開之資料，並以四至十頁為原則，如有
圖片或照片請以附加檔案上傳，若涉及智財權、技術移轉案及專利申
請而需保密之資料，請勿揭露。 
 
 2
的雷射感測模組及工研院機械工業研究所研
發的 EPCIO 運動控制卡來進行量測，最後再
以MFC[3]架構於Visual C++撰寫程式將量測
結果顯示出來。 
 
三、光學式線型氣壓缸行程量測系統設計 
 
3.1 元件選配 
光學量測以 CCD （ Charge Coupled 
Device ，感光耦合元件）為感測器的架構是
目前較為成熟的技術，因為光學式線型氣壓
缸行程量測系統主要是量測一維空間上的點
資料，而且線性 CCD 的單一方向的 pixel 數
目多（2048 到 12000 pixel 左右）, 所以我
們使用線性 CCD 來當作我們光學式氣壓缸
行程量測系統的感光元件。 
一台線性 CCD 能夠獲得一個維度的資
訊，雖然我們可以由一台線性 CCD 量測氣壓
缸開氣前後的位置再加上線性 CCD 行走的
位置來量得氣壓缸的行程，但是由於線性滑
軌帶動線性 CCD 量測模組的時間不夠快而
且為了要提升量測的速度，我們是採用兩組
CCD 量測模組來進行氣壓缸行程長度的量
測，其中第一組線性 CCD 是固定不動來量測
氣壓缸的初始位置，而第二組線性 CCD 先跑
到預定的位置，等氣缸伸長後就可以量得氣
壓缸的行程長度。 
在 CCD 的選用上，我們選擇的是線性
CCD 是 ILX751B，它的功能如下: 
1. 像素為 2048 pixels 
2. 具有快門的功能 
3. 最快的 Data Rate 為 5MHz 
4. 可見光的感應佳（450nm～700nm） 
在透鏡的選擇上，由於透鏡的主要目的
是為了要將LED投射出的點光源折射成平行
光，經過實驗發現經過凸透鏡所發散出來的
平行光會相當的不均勻，這對以後我們使用
線性 CCD 來抓取資料時會有相當大的影
響，所以我們選用柱狀透鏡來投射平行光。 
 
3.2 系統機構設計 
系統的機構主要分為二個模組來設
計:1.CCD 量測模組機構:其中又包含 CCD 夾
持機構、柱狀透鏡夾持機構以及可調式點光
源機構。2.氣壓缸夾持機構。 
 
3.2.1 柱狀透鏡夾持機構設計 
因為柱狀透鏡為長方形，因此夾持機構
也必須設計成長方形狀的凹槽將透鏡置入。
其設計圖如下圖 1 所示:  
 
圖 1 柱狀透鏡夾持機構設計圖 
 
3.2.2 可調式點光源機構 
 在本系統中相當要求經過柱狀透鏡投射
出去的光源必需是平行光，因為如果不是平
行光的話會造成量測上的誤差如下圖 2 所
示。 
 
圖 2 非平行光所造成的誤差示意圖 
 
我們可以看到如果經過柱狀透鏡投射出
來的光源如果不是平行光的話，以不同半徑
的氣壓缸軸桿但有同樣的長度來量測的話，
他們所量得的長度會不一樣，為了要調整出
平行光，所以我們要設計一個可調式點光源
機構，其設計圖如下圖 3 所示。 
 
 4
於這個系統而言運算上是夠用的。 
（3）兩組 PWM 輸出（12 個輸出）：此 DSP
內含兩組 Timer 可設定 PWM 的週期以及脈
波輸出的形式，可用來產生 CCD 取像時所需
的控制訊號，如此一來原本由 CPLD 所擔任
的訊號產生器就可由 DSP 的 PWM 來取代，
更進一步簡化電路。 
（4）高階語言開發環境：使用 TI 的 DSP 開
發軟體 CCS(Code Composer Studio)，可直接
進行偵錯、下載等功能。 
 
3-4 使用 Sobel 遮罩處理點資料 
在不開日光燈的情形下，我們將 CCD 量
測模組的線路接好後並將LED點光源調到焦
距位置後，並在經過透鏡投射出的平行光中
間加入一個遮蔽物，我們將 CCD 量測模組所
量得的值由 EXCEL 繪圖得到下圖 6 所示。
0
500
1000
1500
2000
2500
3000
3500
4000
4500
1 73 145 217 289 361 433 505 577 649 721 793 865 937 1009 1081 1153 1225 1297 1369 1441 1513 1585 1657 1729 1801 1873 1945 2017
CCD上的像素
Gray Value
 
圖 6 原始點資料 
我們從上圖看到被遮蔽的部分它的灰階
值是 0，但是未被遮蔽的部分仍有一段上升
的值如上圖 6 圈起來的部分，此時我們所要
取的值理論上是圖 6 上斜率變化最大的值，
而由 Sobel 遮罩的特性就能夠找到斜率變化
最大的值。其中我採用的一階 Sobel 的樣式
如圖 7 所示: 
 
 
圖 7 1 維 Sobel 遮罩 
 
圖 8 為我們將圖 6 的點資料進行 1×25 的
Sobel 遮罩處理後的值。經由 1×25 的 Sobel
遮罩處理後我們可以得到峰值的點是在第
996 個點。 
 
-80000
-60000
-40000
-20000
0
20000
40000
60000
80000
100000
120000
1 123 245 367 489 611 733 855 977 1099 1221 1343 1465 1587 1709 1831 1953
CCD上的像素
加
權
後
的
值
 
圖 8 1×25 的 Sobel 遮罩處理後的值 
 
3-5 三點求拋物線頂點法求出實際距離的次
像素 
為了要提升本系統的解析度，我們將經
過 Sobel 處理後的資料進行次像素演算法。
所謂次像素乃是利用數學的方法來進行影像
的擬合，接著將擬合出來的方程式進行一些
數學運算，如微分求最高灰階的位置，利用
這些數學的方式所計算出來像素位置多含有
小數，因此稱這些帶有小數的像素值為次像
素。關於次像素對於精確度的提升[8]有提出
比較數據。本次影像處理的最大目的是找出
影像峰值，不同的擬合方式所得到的峰值位
置也不盡相同，而我們使用的方式是三點求
拋物線頂點法：這是一個最簡單的計算方
式，首先搜尋出灰階值最大像素位置，接著
再選擇峰值左右各一點，再利用拋物線通式
求出拋物線頂點位置即為新的 peak 位置。 
由 3-4 節所得到峰值的點外，其餘兩點
需要利用實驗的測試。 
我們所做的實驗是將 3-4 節所取到的峰
值並取此峰值上下不同點數來做拋物線的擬
合。並求出此拋物線的極值。實驗結果如下
表 1: 
 
上下點數 0 1 2 3 4 5 6 7 
拋物線極值 996.000 995.835 996.021 995.753 995.332 994.683 994.222 993.977
表 1 另一筆點資料的值 
 
由我們求得的拋物線方程式(取上下第
二點)與我們之前由 Sobel 遮罩所得的點資料
做比較可以得到下圖 9: 
 6
4.2 電路規劃 
 在控制線性滑軌的移動、電磁閥開關、
A/D 的轉換及編碼器的擷取的控制電路我們
是使用工研院機械工業研究所研發的 EPCIO
運動控制卡來進行控制。接線方法則參考
EPCIO 運動控制卡 4000/5000 硬體使用手冊
[9]。 
 由於雷射模組的類比輸出、伺服馬達編
碼器的輸出及電磁閥的控制線路都要靠運動
控制卡的轉接板與運動控制卡做連接。為了
避免線路的紊亂，我們設計了一塊線路整合
板，如圖 13 所示，此電路板可方便使用者進
行線路的連接工作。 
 
LS1 LS2HS
Motor
EPCIO
110V IO
Power
LV
AD Out
 
圖 13 線路整合板 
 
4.3 實驗模式規劃 
 由於氣壓缸內部緩衝的設計，氣壓缸在
保壓下及洩壓後會有不同大小的行程，為了
滿足不同的需求，在實驗模式的規劃上我們
提供了保壓測試及洩壓測試兩種模式。保壓
測試是在量測氣壓缸開氣前後的位置時皆有
氣壓輸入，洩壓測試則是在量測氣壓缸開氣
前後的位置時皆等待氣壓缸將壓力排出後才
進行量測。 
  
五、控制程式與操作介面 
 
5.1 控制程式說明 
圖 14 為系統的運作流程，在開機後，使
用者必需進行歸零的動作，以取得兩組雷射
模組的相對位置。接下來使用者選擇氣壓缸
的行程、量測次數及量測模式後按下量測及
開始進行量測，在量測中途，使用者可以按
下停止按鈕來停止量測的動作，在停止後使
用者可以選擇要重新量測、繼續量測或是結
束量測，最後在電腦螢幕上顯示出量測結果。 
 
5.2 使用者介面說明 
 在軟體的開發部分，使用者介面主要功
能為參數輸入以及顯示量測結果。使用者的
介面配置如圖 15，將選擇氣壓缸的型號及行
程放置在最上方，將外部的環境參數放在第
二部分，第三部分則為命令機台動作的按
鈕，最下方的部分則為顯示量測後的結果。 
 
Start
Mode 1
With  pressure 
Mode 2
Air release
Pause?
Which mode?
N=Ns
Set Counts (Ns)
End
Measure
Wait for 
command
N+1
No
No
Yes
Restart
Continue
Yes
Zero Return
Laser 1, 2 sense?
Yes
Message Box No
Laser 1 sense?
Laser 2 sense?
Message Box
Message Box
Yes
Yes
No
No
Begin Test
Laser 2 moves
Finish
 
圖 14 系統運作流程圖 
 
六、雷射模組量測結果 
我們對隆運公司的氣壓缸 ( 型號為
STA150)分別使用保壓測試及洩壓測試來進
行 10 次的量測。量測的結果如表二。最大誤
差約為 0.020mm 大誤差約為 0.020mm，且洩
壓模式因位氣壓缸會回彈，故所量得的平均
行程比保壓模式的還小，這是合理的現象。 
