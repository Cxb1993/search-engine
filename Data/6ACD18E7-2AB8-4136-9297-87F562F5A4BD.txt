 2
究多忽略實務上車輛途程問題的動態
性，而是以靜態(static)的方式來求解。然
而事實上，不管是物流中心的車輛配送作
業或是貨運業者的收送貨服務，都常會面
臨若干不確定的情況。例如，路段的旅行
時間會隨著交通量的不同而有所差異，客
戶可能會因臨時需求而要求緊急出貨，對
宅配業者而言，更是隨時都會有顧客要求
收件；這一些狀況都不是靜態的 VRP 模
式所能完善處理的。 
近年來由於電腦硬體技術的進步，關
於動態車輛途程問題 (Dynamic Vehicle 
Routing Problem, 簡稱 DVRP)或隨機車輛
途 程 問 題 (Stochastic Vehicle Routing 
Problem, 簡稱 SVRP)的探討也日漸增多
(Gendreau, Laporte, & Seguin, 1996; 
Flatberg, Hasle, Kloster, Nilssen, & Riise, 
2005)。Flatberg et al.將 VRP 的動態性分
為 dynamic, stochastic, and time-dependent
等三種類型。其中 dynamic problem 是指
問題的若干部份會在求解過程中改變，需
要在解決問題的過程中重新修正原來的
求解計劃者；stochastic problem 是指問題
的若干特質具隨機性(其機率分配可為已
知或未知)；至於 time-dependent problem
則是指問題的若干特性値會隨著時間而
發生變化。 
上述的分類方式比較易另人混淆，若
參酌Flatberg et al. (2005)與Gendreau et al. 
(1996)的文章內容改以具有動態或隨機性
的標的來分類，則 DVRP/SVRP 則可較清
楚地分為車輛旅行時間的動態/隨機性、顧
客需求的動態/隨機性、以及顧客的動態/
隨機性三大類。本研究主要是同時探討顧
客的動態/隨機性以及顧客需求的動態/隨
機性這兩個部份，這樣的模式可以應用於
客戶常臨時插單的配送問題以及宅配服
務的車輛排程上。 
在 VRP 的啟發式解法上，近幾年來
標榜著可跳脫局部最佳解的演算法逐一
被嘗試應用在 VRP 上，如基因演算法
(Genetic Algorithm, 簡稱 GA)、禁忌搜尋
法(Tabu Search)、螞蟻演算法、模擬退火
法、以及大洪水法等。其中，基因演算法
有 著 相 當 良 好 的 績 效 表 現 (Berger, 
Barkaoui, & Brysy, 2003; Cordeau, 
Gendreau, Hertz, Laporte, & Sormany, 
2005)，吾人亦曾嘗試利用單性生殖基因
演算法求解具時窗限制之車輛途程問題
(Vehicle Routing Problem with Time 
Window, 簡稱 VRPTW)，並獲致良好的績
效(Chang & Yeh, in press)。因之本研究擬
針對上述單性生殖基因演算法加以改
良，提出一個二階段的演算法以求解
DVRPTW。第一階段的演算法主要是針對
已知的需求進行排程，第二階段的演算法
則在每個新需求產生或顧客需求量發生
改變時啟動，以重新安排車輛途程。此二
階段演算法的特色是它具備預估「決策時
間上限」的能力，可以求得容許的計算時
間。此種功能在實務上不僅可以避免因計
算時間過長導致違背顧客的時窗限制，也
可以檢測是否無任何車輛可即時滿足顧
客之需求，以作為是否接單或作為與客戶
協商取/卸貨時窗之參考。 
綜合上述，本研究的研究目的如下： 
1. 發展一適用於顧客與需求量具不
確定性的演算法，以便能處理此
種類型的 DVRPTW，並增進處理
績效。 
2. 針對臨時發生的新需求發展一預
估「決策時間上限」的子模式，
以作為是否接單或作為與客戶協
商取/卸貨時窗之參考。 
3. 建立一測試資料集，以便測試演
 4
(參見圖 2)以及「新需求排程」(參見圖 3)
與「服務時窗洽商」(參見圖 4)兩個子系統。
其中主控程序在新需求產生時會被觸發，
並計算出該新需求的服務時窗是否有可能
被滿足，如果系統無法在顧客要求的時窗
內到達，則會啟動「服務時窗洽商」子系
統，將目前最快可以服務該顧客的時間顯
示在螢幕上，此時間會隨著車輛的推進與
系統內的各項變化而動態修正。 
而當新需求的服務時窗可以被滿足
時，主控程序則會通知「新需求排程」子
系統，結束先前的尋優(如果上一個新需求
排程尚未完成的話)，以目前的最佳解作為
系統的排程；並啟動一個新的執行緒開始
執行目前新需求插入後的排程工作。接著
它會計算目前狀況下容許的「最長尋優時
間」，並將此時間以計時器事件的方式送至
訊息佇列中，計時器時間一到便會驅使「新
需求排程」子系統結束尋優。 
最早可以服務新顧客時間之計算係直
接嘗試將新顧客插入到現有車輛的排程計
畫中，從中選取不違反載重與時窗限制且
到達時間最小者，再將此時間與從場站新
發一部車前往服務該新顧客的到達時間相
比較，從中選取到達時間較小者。 
在新顧客產生的時點 t，最長尋優時間
MS
tT 可由式(2)求出。 
{ }kccRtkMSt TtbTMinT −−= ,         (2) 
其中， 
   RtkT ：時點 t 正在服務(或將服務)的車輛
中，剩餘服務時間加上預計至下一
顧客時早到時間之和最小者(假設
為 k 車)。 
   cb  :新顧客 c 的服務時窗結束時間。 
kcT  : 顧客 k 到顧客 c 之最短旅行時間。 
在「新需求排程」子系統中，主要是
先嘗試將新顧客插入到現有車輛的排程計
畫中，從中選取不違反載重與時窗限制且
旅行距離最小者，利用此解作為單性生殖
基因演算初始族群中的一員，以增進解的
品質，並保證當「新需求排程」子系統因
另有新需求產生或到達最長尋優時間限制
時，仍能有一個不錯的可行解。 
「服務時窗洽商」子系統主要是用於無
法滿足顧客之時窗限制時，提供客服人員
與顧客洽商更改時窗使用，當排程計畫有
所更動或是有貨車離開某顧客準備前往下
一顧客時，原先求出的最早可以服務新顧
客時間便有可能會變更，故需重新求算。
洽商若成功，便把此筆新顧客之需求資料
傳給主控程序處理。 
3.3 Solomon 標竿問題集之修改與模式驗證 
    本研究將採用 Solomon 標竿問題集來
進行演算法之測試與驗證，由於該問題集
係針對靜態的 VRPTW 問題所設計，因此
必 須 進 行 適 度 的 修 改 才 能 用 於
DVRPTW。本研究將採用 100 個需求點的
三種類型問題集(含 C 型、R 型、與 RC 
型)，來進行修改。修改的方式為將部分比
率的顧客視為動態顧客(本研究設為 0.2 與
0.5 兩種比率)，本研究將隨機選出這些動
態顧客，並設定其「插單」時間；以便能
檢測依動態程度設定的求解策略的效果，
並探討不同的策略所適用的情境。 
3.4 實證結果 
    本研究針對上述三種不同動態顧客比
例的問題集，利用動態顧客單性生殖基因
演算法予以求解。為了了解在不同動態顧
客比例下，在第一階段的尋優過程中，是
否需預留若干比例的車輛容量，以供動態
顧客與需求使用。本研究亦針對各不同的
預留容量狀況下來進行求解，其結果如表 1
所示，表中之求解績效是以式(3)作為衡量
之依據。 
 6
Problem. In A. Langevin & D. Riopel 
(Eds.), Logistics Systems:Design and 
Optimization (pp.270-297). 
Springer-Verlag. 
5. Dantzig, G. B., & Ramser, J. H. (1959). 
The Truck Dispatching Problem. 
Management Science, 6(1), 80-91. 
6. Flatberg, T., Hasle, G., Kloster, O., 
Nilssen, E., & Riise, A. (2005). Dynamic 
and Stochastic Aspects in Vehicle 
Routing - A Literature Survey. SINTEF 
Report STF90 A05413. 
7. Gendreau, M., Laporte G., & Seguin R. 
(1996). Stochastic Vehicle Routing. 
European Journal of Operational 
Research, 88, 3-12. 
8. Xie, B., An, S., & Li, J. (2006). 
Application of Genetic Algorithm in 
Vehicle Routing Problem with Stochastic 
Demands. Proseedings of 6th World 
Congress on Intelligent Control and 
Automation, Dalian, China. 
 
計畫成果自評 
本研究的主要目標係在單性生殖基因
演算法的基礎上發展一求解動態顧客/需
求之 DVRP 演算法，並建立測試問題集來驗
證與比較求解策略。經由實證研究的結果
發現，本研究所提演算法確實可以在動態
顧客與需求的情境下運作，並獲致不錯的
績效。本研究所建立的 DVRP 問題集與「求
解績效」指標，也可以提供後續研究作為
改進 DVRP 求解之比較與驗證之用，在實務
與學術研究上都有其價值。 
 
 
 
 8
 
 
從顧客集合 S中選取尚未服務且尚未排定為下一個要服務之顧客，令其為集合 S’ 
令目前車輛所成的集合為 V 
For Each v In V 
 嘗試將新顧客 c插入到車輛 v目前的排程計畫中 
 If 違反容量或時窗限制 Then 
  Loop 
 End If 
 計算新增距離 
End For 
If有車輛可以插入新顧客 c Then 
 選取新增距離最小的車輛，將新顧客 c插入到該車輛目前的排程計畫中 
Else 
 新增一部車服務此新顧客 c 
End If 
將此解作為基因演算法初始族群中的一員 
While 尚未接獲結束尋優通知 
利用單性生殖基因演算法搜尋更佳的排程計畫(僅針對集合 S’進行排程) 
End While 
輸出最佳解 
 
圖 3 動態顧客單性生殖基因演算法第二階段「新需求排程」子系統 
Wait For 事件 
Select 事件型態 
Case 排程計畫有所變更或有貨車正前往下一個顧客 
計算並顯示最早可以服務新顧客時間 
Case 洽商成功 
送出新需求事件給主控程序 
終止本執行序 
Case 洽商失敗 
終止本執行序 
End Select 
圖 4 動態顧客單性生殖基因演算法第二階段「服務時窗洽商」子系統 
