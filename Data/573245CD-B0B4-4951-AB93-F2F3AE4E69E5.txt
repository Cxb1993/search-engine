中文摘要 
 
為了提供在 M2M（Machine to Machine）架構中，能於不同平台與介面之間實現無線感
測網路的連接與控制，因此在本計畫中，提出一無線感測網路應用之異質性通訊協定轉換與
整合系統。其中，包含即插即用的異質性通訊協定之轉換硬體與軟體設計，並制訂多種轉換
異質性的串列埠，如 RS-232、RS-485、Can Bus、USB、Ethernet、ModBus/RTU 與 ModBus/TCP
等通訊協定的傳輸格式。 
而為了將這異質性通訊協定也能在不同的可攜式嵌入式平台上操作，因此，設計一個能
於嵌入式平台或一般主機之作業系統之通用驅動程式與應用程式。 
本計畫以一年為期，相關的工作項目分別為： 
 針對無線感測網路之初步建構，提供隨插即用型異質性通訊協定轉換模組連接與設
定。 
 開發適用於 M2M（Machine to Machine）通訊的異質性串列埠間之通訊協定轉換介
面閘道器。 
 可連接至嵌入式通訊平台或是可攜式的智慧型手機上，並設計一中介軟體來整合至
不同的作業系統之驅動程式與應用程式。 
透過此計畫的實現，將可提供了在 M2M 下之無線感測網路的異質串列介面間的連接功
能，並可實現在諸多控制平台或儀器介面的延伸控制。如此，更可加速無線感測網路的應用
利基，並提高相關產業的需求。 
 
 
關鍵詞：M2M、異質串列介面、無線感測網路、CAN bus、ModBus、USB 
 
 III
目錄 
中文摘要 ………………………………………………………………………………………… I 
英文摘要 ………………………………………………………………………………………… II 
一、前言 ………………………………………………………………………………………… 1 
二、研究目的 …………………………………………………………………………………… 2 
三、文獻探討 …………………………………………………………………………………… 3 
四、研究方法 …………………………………………………………………………………… 4 
五、結果與討論 ………………………………………………………………………………… 7 
六、參考文獻 …………………………………………………………………………………… 10 
七、附錄 ………………………………………………………………………………………… 10 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
或是 Ethernet[12]、ModBus RTU 與 ModBus TCP[13]等通訊協定傳輸格式。不同的無線感測
網路在連接時，不同串接的通訊協定轉換(Protocol Converter)與無線化(WireLess)，將是未來
評估此無線感測網路能否快速建置與規劃的考量與需求，特別是目前不同感測器產品很難完
全互通其相關訊號。因此，如何將過去多元種類繁雜的通信協定(RS-232、RS485、USB、CAN 
Bus 或是 Ethernet)與通用工業標準(ModBus)相互轉換，是本計劃提出與執行的重點。 
 
圖 1、M2M 系統執行架構示意圖 
此外，稍前所提及的 Mobile（另一個 M）的概念，主要還是建立在機器（M）之上。簡
單的說，就是在現有的機器、設備上來安裝 SIM 卡，而不論是固定式或移動式的機器設備，
都能透過本身的行動通訊功能進行彼此間的溝通，所以可以說是將機器（M）附加了 Mobile
（M）的價值，成為另一種新的「M2M」架構。 
而對於這樣的 M2M 概念[6]，日本電信商 NTT DoCoMo 曾表示，預計到 2010 年時，每
3 個 SIM 卡中，將有 2 個是應用在機械或設備上。也就是機機械設備將取代人為操作，成為
最大的行動通訊使用者。目前，M2M 相關概念與技術已經得到了 NEC、HP、CA、Intel、IBM、
AT&T、Ericsson、Nokia 和 OMRON 等多個國際廠商的支持。也已經有部分的商用計畫正在
進行中。 
因此，為了實現這種新的 M2M（Mobile to Machine）架構，就需將這異質性通訊協定也
能在不同的可攜式嵌入式平台上操作，因此亦需設計一個能於嵌入式平台或一般主機之作業
系統之通用驅動程式與應用程式的中介軟體。而這也是本計畫執行的另一重點。 
綜合上述的計畫背景，本計畫的執行重點，即根據力摩科技公司的技術導向與需求提出
一”應用於無線感測網路之異質性通訊協定轉換與整合系統＂計畫。 
二、研究目的 
從上述的計畫背景中，可以瞭解到本計畫的目的即是建立應用於無線感測網路之異質性
通訊協定轉換與整合系統。 
在本計畫中，將可透過 ZigBee 無線感測網路模組所建置出的異質性串列埠間通訊協定
轉換介面閘道器來實現多種串列介面的異質轉換與相關的通訊協定傳輸格式，如 RS-232、
RS-485、CAN Bus、USB、Ethernet、Mod Bus/RTU 與 Mod Bus/TCP 等。此閘道器是以 ARM 
7–LPC2388（NXP）微處理器為核心來實現各個串列介面的通訊協定傳輸格式轉換之用。不
僅可實現無線感測網路之初步建構，且提供隨插即用型異質性通訊協定轉換模組連接與設
定。此外，也開發出適用於 M2M（Machine to Machine）通訊之異質性串列埠通訊協定轉換
 2
 4
式碼。此外，CC2530 將完全整合的高效能 RF 收發器、8051 MCU、8 KB RAM、32/64/128/256 
KB 快閃記憶體，可以與其他威力強大的功能與週邊相整合。 
而 Jennic 公司則是選擇直接推出 ZigBee SoC 產品[16-17]。其中，型號 JN5121 內建一顆
32 bits RISC CPU、64KB ROM，以及 96KB 的 SRAM。本計畫即是以此 SoC 產品來切入，
並實現軌跡追蹤與定位服務的功能。另一個 JN5139 MCU 則為新推出一款針對無線感測網
路的低功率及低價位之無線微處理器，亦相容於 2.4GHz IEEE802.15.4 收發器功能。且其內
部 ROM 大小為 192k，且可以根據不同型號搭配相關 RAM 記憶體大小（8KB~96KB），可
依不同無線感測網路需求而支援相關數位及類比介面。此晶片組內部記憶體儲存資料主要為
系統相關軟體介面，如通訊協定堆疊、路徑表、應用程式碼與資料。主要包含有關硬體 MAC 
位址與 AES 加解密加速器，並且可透過其定義的省電與定時睡眠模式達到低功率的功能，
也含有 Check Sum 碼與程式碼加密機制。雖然此顆晶片組功能相當完整，且開發迅速，本實
驗是已具多年的研發能量，但因其單價過高，遂配合力摩科技公司選擇另一款 CC2430 晶片
組來作為本計畫的設計與應用的核心元件。 
四、研究方法 
如圖 2 所示，為本研究的整體系統架構示意圖。從圖 2 中，可以知道為了實現此應用於
無線感測網路之異質性通訊協定轉換與整合系統，其可依下列 3 部分來依序完成，並加以介
紹。 
4.1 無線網路感測節點模組之測試與研究 
本研究的執行上，將首先針對所採用的 Zigbe 無線感測網路的裝置模組（力摩科技公司）
來做初步測試與研究。為了建置出所需的無線感測網路，需包含 USB-ZigBee Dongle（應用
於協調者設計上）以及相關的 ZigBee 無線感測網路節點（應用於路由器與終端裝置設計上）。 
此 ZigBee 無線感測網路模組皆以 CC2430 晶片組為核心。其為 TI 公司推出的專門用來
實現嵌入式 ZigBee 應用的微處理器。此晶片組支援 2.4GHz IEEE 802.15.4/ZigBee 協定，並根
據晶片組內設定不同容量的 Flash 記憶體。 
為了方便維護，ZigBee 無線感測網路節點與 USB-ZigBee Dongle 都採用由 CC2430 所設
計的相同模組。而裝置模組皆包含擴充排座，且提供 UART 的 TX 與 RX 接腳的外接。因此。
透過這 UART 串列埠可以提供各種異質介面轉換的輸出入埠。針對無線感測網路的初步測
試，在此，使用力摩公司所推出的 ZMConfig 軟體。 
 
4.2 異質性串列埠間之通訊協定轉換介面閘道器 
有了稍前對 ZigBee 無線感測節點模組的開發硬體與軟體測試後，緊接著，即需實現適用
於 M2M (Machine To Machine)通訊的異質性串列埠間之通訊協定轉換介面閘道器，以增加整
個無線感測網路於各種後端儀器設備的連接與測試。 
其中，包含即插即用的異質性通訊協定之轉換硬體與軟體設計，制訂轉換異質性串列埠，
如 RS-232、RS-485、Can Bus、Ethernet、Mod Bus RTU 與 Mod Bus TCP 等通訊協定傳輸格
式。如此，我們所運用的無線感測節點可以很便利地連接至各種測試儀器或是控制機台上。
因此，我們需運用一顆功能強大的微處理器來作為此閘道器核心。在此，選擇具備 USB 
OTG/HOST/Slave 架構的 LPC2388（NXP）系列。LPC2388 微控制器是一顆以 16-bit/32-bit 
ARM7TDMI-S 為架構，且具備即時模擬功能的 CPU。其中，整合了 512 KB 嵌入式高速 Flash
 6
即可實現此異質介面設計與製作。 
 Ethernet 介面 
LPC2388 具備 Ethernet Media Access Controller (MAC)，因此，只要外接乙太網
(ETHERNET)收發器（DP83848）以及含隔離單元 RJ45 網路座-HR911105A 等兩個元件，即
可實現 Ethernet 網路，並以 TCP/IP 所延伸的 HTTP，SMTP，SNTP，DHCP，Telnet，BOOTP，
DNS，PPPoE 等協定做有線網路的通訊網路協定。 
 CAN Bus 
CAN Bus 是控制器區域網路，是目前應用最廣泛的現場匯流排之一。最初在開發設計時，
即作為汽車環境中的微控制器通訊，在車載各電子控制裝置 ECU 之間交換資訊，形成汽車電
子控制網路。基本設計規範要求有高的位元速率，高抗電磁干擾性，而且能夠檢測出產生的
任何錯誤。雖然之前是以車載通訊電子網路為主，但近年來已廣泛於各種工業控制與現場機
台的控制上。由於 LPC2388 微處理器具備 CAN 控制器，因此僅需連接上 CAN 收發器
（PCA82C251，NXP）即可實現此異質介面設計與製作。 
 USB 介面 
為了實現這 LPC2388 USB 控制器的設定，我們必須依循 USB 通訊中的裝置列舉的步驟。
裝置列舉是一種匯流排上的配置過程，且在 USB 裝置被插拔進出後或是匯流排啟始時，就會
被執行。 
由於 LPC2388 具備 4KB 端點記憶體的 USB 裝置/主機/OTG 功能，對於目前一般的 USB 
2.0 裝置的連接與裝置列舉的控制傳輸，以及中斷、巨量與等時傳輸需求已經是足夠使用的。
在此，運用 USB 主機或是 OTG 主裝置功能，即可讀取 USB 從裝置的裝置或是儀器。而針
對目前眾多的 USB 群組裝置，在此，我們先建置常用的 USB HID 群組裝置的驅動程式來實
現各種符合 USB HID 群組裝置的異質串列介面轉換的工作。 
 Modbus 
Modbus 是由 MODICON 公司在 1979 發展出來的一套通訊協定。它具有標準化、採開
放式架構的特性，而且廣泛地被工業自動化產所使用的通訊協定。透過 Modbus，SCADA 和 
HMI 軟體可以很容易地將許多串列設備整合在一起。Modbus TCP 是 Modbus 的一種變形擴
展規格。Modbus 在 1999 年被發展出來，讓  SCADA（ (Supervisor Control And Data 
Acquisition ）/HMI 也可以透過 Modbus TCP 存取網路上的設備。其中，最常見的 Modbus 
RTU 是架構在串列線，如 RS-485 或 RS -232 等雙絞線通訊方式，因此也被稱之為 Modbus 
ASCII。隨著目前透過 Ethernet 來切換 Modbus 的應用與需求越來越多，因此，亦延伸出 Modbus 
TCP 協定。其中的差異就是將 Modbus RTU 協定嵌入於 TCIP 封包中。如此，就可以很方便
地選擇連接至 Modbus 裝置至 SCADA 系統或 PLC 機台上。 
而Modbus RTU可以透過串列埠的程式設計來實現，只需著重在Modbus串列資料格式的規
格是否符合。而Modbus/TCP則可整合LPC2388 的乙太網路控制器來達到Mod Bus/RTU與Mod 
Bus/TCP異質介面轉換的設計功能。 
根據上述的異質串列介面轉換的特性與需求，即可透過 LPC2388 來建置出一個異質性串
列埠間之通訊協定轉換介面閘道器。如下圖 3 所示，為此閘道器硬體架構示意圖。透過上述
所提及的系統架構的閘道器，我們可以根據不同的需求，提供不同異質轉換的介面。 
轉換的輸出入埠。 
 
 
圖 4(a)、USB-ZigBee Dongle 實體圖 圖 4(b)、ZigBee 無線感測網路模組 
 
CC2430/CC2431是TI 公司第2代ZigBeeTM平台和真正的SoC解決方案，結合了領先技術的
射頻2.4GHz收發器和符合IEEE 802.15.4協議的CC2420，具有工業級，整合至小體積的8051微
處理器。為了提供系統整合與維修的便利性，首先利用CC2430晶片組單獨設計出一個ZigBee
無線感測網路的裝置模組。如圖5(a)與(b)所示，為本系統的使用者圖形化介面。其中，將力
摩科技公司所推出的AT Command依功能不同整理後，只需要點選想控制的介面並且輸入相對
應的資料即可進行介面的控制。 
     如圖5(a)所示，在中間的核心單板即為了實現適用於M2M (Machine To Machine)通訊的
異質性串列埠間之通訊協定轉換介面閘道器設計，我們使用具備多種介面控制的LPC2388晶
片來實現這項功能。LPC2388具備4個UART埠，不僅可以作為ZigBee無線模組的資料接收，
也可以作為RS-232和RS-485介面的控制。為了可以方便控制其他介面，因此制定了傳輸格式，
如表1所示。藉由自行訂製的格式，我們可以利用LPC2388自由的切換各種不同的介面傳輸。
其中，由開始位元與結束位元判斷是否為完整封包，再以選擇原決定位元為哪個介面，確認
位元會在一次確認是否為當權選擇介面，最後在加入資料為元控制介面。 
整體系統的操作相當簡單，不需要去熟讀各項通訊介面之協定便可以控制多種介面，更
可以解決ZigBee無線感測網路上環境感測節點的不足之處。 
另一無線端的操控裝置上，需開發 Windows CE 嵌入式系統應用程式設計。由於
USB-ZigBee Dongle 裝置具有兩種版本，HID 與虛擬 COM 埠等兩種。這兩種 USB 裝置的驅
動程式的開發相當簡易，也支援甚多的作業系統。因此，此嵌入式異質性通訊協定系統即快
速連接與安裝 USB-ZigBee Dongle 裝置。 
此嵌入式異質性通訊協定系統是採用 S3C2443XL-53，主頻 533MHz，16/32-bit ARM920T
核心的嵌入式平台。除了可安裝 Linux 2.6.16：支援高速 SDHC 卡（SD 2.0）並相容標準 SD 
1.1 以及 WinCE 6.0： 支援高速 SDHC 卡（SD 2.0），並相容標準 SD 1.1 開機。  
此外，其的具備 USB 介面包含 1 個 USB HOST（USB 1.1 規範）介面，支援全速(12Mbps)
或低速(1.5Mbps)傳輸，以及 1 個 USB DEVICE（USB2.0 規範）介面，最高支援 480Mbps
高速傳輸。因此，相當便利於我們開發以 USB 介面為主的嵌入式異質性通訊協定系統。 
而整個應用程式設計可透過 Embedded Visual C++(EVC)來開發，這與 PC 上開發應用程式相
當類似與方便。最後，再將應用程式透過 USB 介面下載至 S3C2443 為核心的嵌入式異質性
通訊協定系統上。此應用程式亦是實現如圖 5(a)與(b)功能。 
 
 8
 10
換功能。整合目前常見的儀表或是機台控制之串列介面，並可隨著應用需求，逐漸擴充所需
的異質串列介面。未來亦將增加檢查碼checksum的機制，讓通訊資料更正確，並於實際的異
質裝置上連接測試。此外，亦提供嵌入式系統或是可攜式裝置的連接，操作上具備極佳的人
性化介面。不僅可符合M2M 架構下之無線感測網路的連接使用，亦可彈性的建置方式，未
來可推展至各個無線產品應用的領域上。 
     根據上述的測試結果與實際的應用測試，證明了本計畫在執行上完成符合原先預定達到
的目標。 
六、參考文獻 
[1]. IEEE std 802.15.4-2006, IEEE 802.15.4 Wireless MAC and PHY Layer Specifications for Low-Rate 
WPANs,2006 
[2]. http://www.geoprotek.com/layout/zigbeeintroduce.pdf [ZigBee 無線網路介紹] 
[3]. http://www.digitimes.com.tw/n/article.asp?id=8D5182B620E658E148256FE40047E147 [ZigBee 將「趕盡殺絕」
紅外線遙控器] 
[4]. ZigBee Alliance, ZigBee Specification ZigBee Document 053474r13, 2006 
[5]. IEEE P802.15 Working Group, “Part15.4:Wireless Medium Access Control(MAC) and Physical Layer (PHY) 
Specifications for Low-Rate Wireless Personal Aera Networks(WPANs),” IEEE Computer Society, 2006.  
[6]. 杜念魯，M2M，DIGITIMES，2007   
[7]. “White paper Machine To Machine”， www.orange-business.com 
[8]. Machine to Machine，http://en.wikipedia.org/wiki/Machine_to_Machine 
[9]. EIA-485，http://en.wikipedia.org/wiki/EIA-485 
[10]. CAN Specification，BOSCH，http://www.semiconductors.bosch.de 
[11]. USB Specification ，http://www.usb.org 
[12]. IEEE 802.3，http://ieee802.org/3/ 
[13]. Modbus，http://www.modbus.org 
[14]. CC2430 datasheet，http://focus.ti.com/docs/prod/folders/print/cc2430/html. 
[15]. CC2530 datasheet，http://focus.ti.com/docs/prod/folders/print/cc2530/html. 
[16]. Jennic , “Data Sheet – JN513x”, Version 1.4,Jennic, 2007. 
[17]. Jennic , “JenNet Stack User Guide”, Revision 1.3 , Jennic, 2008. 
[18]. HID Usage Tables, Version 1.12, www.usb.org. 
[19]. Device Class Definition for Human Interface Devices (HID) Firmware Specification, Version 1.11, 
www.usb.org. 
[20]. http://www.usb.org/developers/tools/ 
七、附錄 
 論文與期刊成果 
 許永和等，＂ 應用於無線感測網路之嵌入式異質性通訊協定系統＂， 第五屆智慧生
活科技研討會(ILT 2010)，2010/6/4 
 許永和等＂太陽光能無線感測網路之嵌入式監測系統＂ 電子月刊電子雜誌(第 186 期
/2011 年 1 月號)  
 技轉：「微控制器型無線感測網路技術」，金額：160,000 元，力摩科技股份有限公司 
 專書：許永和，＂ZigBee 無線感測網路設計與應用實務＂，臺灣優奎士，ISBN：
978-986-85543-0-6 
98年度專題研究計畫研究成果彙整表 
計畫主持人：許永和 計畫編號：98-2622-E-150-085-CC3 
計畫名稱：應用於無線感測網路之異質性通訊協定轉換與整合系統 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備註（質化說明：
如數個計畫共同
成果、成果列為
該期刊之封面故
事...等） 
期刊論文 0 0 100%  
研究報告/技術報告 1 1 100% 
太陽光能無線感測
網路之嵌入式監測
系統,電子月刊電子
雜 誌 ( 第 186 期
/2011年 1 月號) 
研討會論文 1 1 100% 
篇 
 許永和、吳孟
錩，陳俊廷，洪世
恩，江呈崙，＇ 應
用於無線感測網路
之嵌入式異質性通
訊協定系統＇， 第
五屆智慧生活科技
研 討 會 (ILT 
2010)，2010/6/4 
論文著作 
專書 1 1 100%  
ZigBee 無線感測網
路設計與應用實務,
臺灣優奎士,ISBN：
978-986-85543-0-6
申請中件數 2 0 100%  專利 已獲得件數 0 0 100% 件  
件數 1 1 100% 件 
「微控制器型無線
感測網路技術」，金
額：160,000 元，技
轉公司：力摩科技股
份有限公司 
技術移轉 
權利金 160 160 100% 千元  
碩士生 2 1 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  
國外 
專利 已獲得件數 0 0 100% 件  
 
