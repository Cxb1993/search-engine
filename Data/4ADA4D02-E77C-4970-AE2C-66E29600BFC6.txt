  - 2 -
CAD 檔。(3)以虛擬實境軟體建構可視化，再
藉由網路跨平台，建構完整之 RE/RP 產品快
速開發網。 
 
三、 文獻探討 
 
本計畫以重建完整之 3D 模型並簡化其
3D 模型檔案，透過虛擬實境與網路平台達到
協同設計產品的功能性係本計畫最主要之目
標。在本計畫當中的文獻探討主要針對四個方
向作探討：(1)逆向工程 (2) ICP 演算法 (3) 基
因演算法 (4) 虛擬實境 
 
3-1 逆向工程 
近年來，逆向工程技術已被廣泛地運用於
各項產品開發以縮短開發時程，其中應用逆向
工程中的三次元量測技術可快速地取得這些
具有自由曲面的產品外型與數據資料並且建
立成 3D CAD 資料檔案。經由重整以及修改並
應用在快速原型技術上即可得產品原型。 
逆向工程中的三次元量測 (Coordianate 
Measuring Machine, CMM) 技術，可快速取得
具有自由曲面的產品外型與數據資料，並且建
立成 3D CAD 資料檔案。三次元量測系統大致
可分為二大類：接觸式量測以及非接觸式量
測；接觸式主要以探針式測頭為主，而非接觸
式則是利用光學式測頭與影像處理技術為
主。一般而言，接觸式量測的精確度較高，其
量測的範圍也較大，但是其缺點是量測得到的
資料須經過探頭半徑補正，才能得到正確資
料，所以量測時間需花費相當長的時間。至於
非接觸式量測，其優點則是量測速度快，大多
是應用於不規則曲面上的量測，但是它會因許
多外在環境因素而影響其結果。因此，兩個量
測系統皆有其優缺點，須針對量測物體需求，
決定適合的量測方法 [Gupta 1993]。 
而一般以雷射掃瞄儀所得到的點群資
料，其處理工件輪廓點群資料量均相當大，而
造成後續匯入快速原型機前，所轉出的標準
STL(STereo Lithography)三角網格檔，也相對
的龐大，而影響模型於快速原型機中成型速
度。在快速原型製造中，成型精度與成型速度
一直被視為最具影響的兩項重要因子，當要求
產品模型有較高的表面精度時，則需要有較慢
的堆疊速度，而如何在兩者間做一取捨，STL
格式將扮演相當重要的角色。STL 被視為正、
逆向工程設計轉換到快速原型的一種公認標
準，當模型由 CAD 或逆向軟體建構完成後，
藉由產生的 STL 格式，即可直接輸出於快速
原型機建構實體模型，如圖 1 所示。而快速原
型機之模型建構速度除受模型本身外型曲面
複雜度影響外，模型本身 STL 三角網格檔的
網格數，也將直接影響快速成型機的成型速
度。 
 
圖 1 正逆向設計與 STL 檔案格式之關係 
 
由於 STL 在格式上的缺點，其網格點資
料的重複性相當大，造成 STL 本身檔案的膨
漲，且 STL 是以三角網格面趨近實體表面，
其本身精度誤差即已存在；故欲改善現行快速
原型機製造成型上的困難點，直接進行 STL
網格的縮減與最佳化處理，應為最快速的方
式。Bertsch 等人（2000）利用微小 RP 快速
原型機，將小型 3D 物件成型出來，並且針對
於成型時所造成的破洞問題加以探討。Choi 
等人（1991）以實體運用 RP 的方法可以將其
物體作出展現，也可以讓設計者在設計的過程
中，可以知道在組裝上是否會發生問題，也利
中國文字和蜘蛛的呈現，作為驗證的方法。 
 
3-2 ICP 演算法 
將雷射掃描儀分次掃描得到的檔案，重建
完整的 3D 圖檔，是本計畫發展的重點之ㄧ，
在 3D 圖檔重建的過程中，係以 ICP 演算法作
為基礎，並利用 Visual Basic 程式語言軟體撰
寫出一套系統 
ICP演算法是一種可以適用於多種用途之
校準方法。把欲校準的兩組資料模型是以點、
線、曲線、三角形或曲面等各種幾何結構所組
組合而成，在縮小資料模型之間距的條件之
下，以尋找最適當的對應關係，再計算出一組
最小平方的幾何轉換矩陣，並逐次反覆計算以
得到最佳的結果，最後會得到一個旋轉矩陣和
一個轉置矩陣，而將這兩組資料模型可以藉著
計算出來的幾何轉換對齊在一起，而達到校準
的目的，ICP演算法僅能找到一個區域的最佳
值，而非最佳值，為了增加找到整體最佳值之
可能性，在計算過程中會加入多組不同的初始
旋轉矩陣，以改變Data shape的初始位置，與
Model shape 做許多次的校準，以期能夠找到
  - 4 -
將更新後的結果做為下一次 iteration的輸入資
料，在下一次 iteration 中尋找對應關係的 Data 
shape Dk+1 
TDRK +⋅=+ 01D  
ICP 演算法就是透過尋找距離最近的對
應關係（第 k 次 iteration Dk， p i, k 　z i,k），
以及依據此關係來計算幾何轉換（原始的 Data 
shape D0，（原始的 Data shape D0， d i, 0 　z 
i,k ）這兩種不同的方式，使得兩組資料模型
之間可以交互產生作用，以降低兩組資料模型
之間的平均距離（mean square distance） 
 
6. 計算 mean square error 值 
更新 Data shape 的座標位置後，對於原始
Data shape D0={di,0} 以及在第 k 次 iteration 
找出的對應關係 Q={zi,k}， Nd = Nq（兩組模型
有相同的點數目），計算出兩組模型的 mean 
square error： 
( ) ( )( ) 2
1
||||1, TiRi
N
i
k ZdZRq
Nd
TRfdms
d
+⋅−== ∑
=
 
7.停止條件 
將計算出的 dms 值與上一次 iteration 的
dms 相減做比較，觀察其誤差變化是否小於給
定的 threshold 值，如果誤差變化大於
threshold，則重覆步驟的執行，繼續下一次
iteration，把原始 Data shape 用幾何轉換更新
座標位置，當做下一次 iteration 中尋找對應關
係的 Data shape，重覆上述的步驟執行，若小
於 threshold 值，代表已經找到區域最佳值，
則停止執行並結束，最後一個 iteration 中計算
出的幾何轉換即為校準所求的最佳轉換，原始
Data shape 座標位置可以藉此轉換與 Model 
shape 對齊在一起。 
 
其相關計畫為Kapoutsis 等人（1999）則
從效率的觀點來改進ICP 演算法，在ICP 演算
法的過程中最耗時的就是要計算尋找對應關
係的這個步驟，如果要尋找最近的對應關係，
則表示對於Data shape 中每一個資料點，都要
找出在Model shape 中距離最近的對應點，因
此ICP 演算法在計算距離上需要花費相當多
的時間；Besl等人（1992）提出，是一種以幾
何結構為主的ICP 演算法，並計算出一個剛體
轉換，然後將兩組資料模型對齊組合的應用計
畫。Maurer等人（1996）將ICP演算法應用在
醫學影像的校準上，其將影像中擷取出模型的
幾何結構，然後在原本的ICP演算法又加上了
權重值的考量，所以影像的特徵部分會有比較
大的權重值，因為在校準的過程中，這些特徵
的幾何結構在目標函式中所佔的權重較大，所
以會優先將這些特徵夠對齊在一起，以縮小模
型之間的距離，最後的mean square error 會比
較低，使校準的結果傾向於對齊影像中的特徵
部分。Masuda等人（1995）使用ICP做為兩資
料間座標定位的方法，但與一般ICP方法不同
的是其收斂目標函數是以最小中值平方法
(least median squares, LMS)取代傳統的最小平
方法。文中提到以最小中值平方法可以減少資
料雜訊對定位結果的影響。 
 
3-3 基因演算法 
在開發設計的流程中，為了減少軟體運算
的時間，本計畫中以權重比刪除網格後再以基
因演算法重建三角網格，並利用 Visual Basic
程式語言撰寫一套系統，亦可得到最近似於原
形之 CAD 檔。在網格刪減及重建的過程中，
所利用的刪減方法為權重比例法(Weighting 
factor)，在進行刪減之前需先對網格作搜尋的
動作，搜尋所有網格中的頂點，尋找並標示出
網格中三頂點皆被共用的三角網格，且定義成
參考網格，及其包圍的網格。並計算包圍的網
格與參考網格之單位法向量的差值，再依所給
定刪減的差值權重比，將欲刪減的參考網格與
包圍網格刪除，最後以基因演算法重建，將所
刪減的三角網格最佳化重建新的網格，其刪減
及重建流程，如圖 3 所示。 
 
圖 3 STL 網格縮減及重建流程 
 
在網格刪減中，所利用的刪減方法為權重
比例法(Weighting Factor)，在進行刪減之前需
先對網格作搜尋的動作，搜尋所有網格中的頂
點，尋找並標示出網格中三頂點皆被共用的三
角網格，並定義成參考網格，其周圍所包含的
網格稱為包圍網格，首先，計算包圍網格與參
考網格之單位法向量的差值，再依所給定刪減
的差值權重比，將欲刪減的參考網格與包圍網
格給刪除，其刪減流程如圖 4 所示。 
 
  - 6 -
 
多邊形編碼成染色體時需考慮到下列幾
項幾何圖形的限制。如圖9所示。 
1.避免產生邊界線 (2-3) (5-6) 
2.重複點 (1-1) (5-5) 
3.外部線段 (1-4) (2-4) 
4.重複線段 (4-6) (4-6) 
5.交錯線 (2-5) (4-6)  
 
圖9 幾何圖形限制 
(2).交配運算 
初始族群中染色體決定後，先算出各染色
體的適應值，再以競爭法則選擇其中二對適應
值較高的染色體作交配運算，在本計畫中染色
體間交配方式是採用單點式交配法，如圖10
所示，C1、C2為隨機選取的二個染色體，以
單點交配法交換彼此染色體間的基因，而染色
體經過交配後會產生新的染色體C1’、C2’，再
利用突變運算，及適應值運算與估測，尋求最
佳適應值的染色體達到演化的目的。 
在交配的過程中，依然要考慮幾何圖形上
的限制，如：重複線段、交錯線，圖11所示。 
 
 
圖10 交配運算示意圖 
 
 
 
圖11 交配運算限制圖 
 
 
(3).突變運算 
利用基因產生突變，來增加族群中染色體
對生存環境產生極大變化的適應能力。然而在
自然界中，發生突變的機率是非常低的，因此
在基因演算法中突變率也是很低。雖然突變不
是最主要的運算，但是為一項必要的運算，其
主要的目的是能確保在尋解的過程中不會陷
入局部最佳解之中，而無法跳離，如圖12假設
交配完後所得到的網格圖形為(a)，經過突變運
算後的網格圖形(b)，由圖形可看出(b)的適應
值會比(a)來的高。 
 
 
(a)交配的原始網格  (b)突變運算後網格 
圖12 突變運算示意圖 
 
在基因演算法有許多相關文獻。Holland
等人（1975）所著作的 “Adaptation in Natural 
and Artificial System”一書，奠定了基因演算法
的主要基礎。Nakanishi 等人（2001）則提出
以異型同體方法(Homology groups)和基因演
算法的組合，以解決因編碼出現有限元素法
（FEM）會造成無法分析的問題。而在國內有
中央大學的游麗娟（2000）對於基因演算法的
運算子作敏感度分析，並結合 Powell 方法，
用於改善基因演算法收斂速度緩慢的缺點。張
明治（2000）提出運用基因演算法，配合梯度
遮罩運算子，來偵測超音波影像邊緣。並且和
一般的梯度遮罩作比較，在這兩種方法最主要
的差異在於基因演算法的適應函數的設定，其
中一個方法以梯度值來決定適應值，另一方法
則以代價函數來決定適應值。並運用基因演算
法所得到之曲線輪廓可以有效的減少雜點。賴
後權（2002）以權重法進行 STL 網格刪除，
再以基因演算法重建網格，以達成重建後的網
格，在要求的精度範圍下，可降低網格數量，
以利於網路傳輸；再加上重建後的 STL 網格，
基於形狀度、平滑度與連續度的適應函數運
算，而有較佳的新 STL 網格形狀，達成 STL
網格縮減的目的。Tian（2002）亦提出基因演
算法對於 STL 所刪除的超平面進行重建 STL
網格的觀念。 
 
3-4 虛擬實境 
目前虛擬實境已是一個被大眾廣泛重
視、討論與計畫的主題，虛擬實境已然成為具
有相當潛力的新興產業，因此這個名詞常被廣
泛的使用，它可說是整合 3D 電腦繪圖(3D 
Computer Graphics)、3D 音效與其它感知介
面，所造成的一個模擬環境，用來創造出一個
擬真的虛擬世界；一般對「虛擬實境的定義」
之闡述更是不勝枚舉。以下提出一些學者對虛
擬實境定義的看法：  (1)虛擬實境是物件
(Object)、屬性(Attributes)和關係調整成自然相
似或表面真實的內容（Santoso 2000）。 (2)虛
擬實境是由電腦所產生出高維度 (Multi 
  - 8 -
 
圖 16 匯入點群資料 
 
 
圖 17 選擇要結合之點群資料 
 
 
圖 18 選取點群對應參考點 
 
 
圖 19 結果顯示 
 
 
圖 20 定位結合完成輸出 
 
4-3 網格縮減 
由本計畫所撰寫之網格刪減重建程式，圖
21 並分別將雷射掃描鞋楦模型以 10%與 30%
的個數比例法與差值比例法作網格刪減與重
建新網格，且相互比較。鞋楦模型原始 STL
網格圖形及其彩現圖，如圖 22(a)所示。以 10%
與 30%差值比例法所得到的結果如圖 22 
(b)~(e)所示。由圖 22 顯示之彩現圖觀察可知，
無論以 10%或 30%差值比例法所得的圖形，均
已有相當程度的網格刪除，故選用 30%個數比
例法進行網格重建並顯示。圖 23 即為鞋楦之
原始 STL 網格模型與 30%個數比例縮減後再
行網格重建結果比較。 
依照權重比例法將做網格刪除後，即以基
因演算法網格重建，依網格刪除比例且重建新
的三角網格，並比較原始 STL 曲面與網格誤
差比較，如圖 24 所示。 
而對於完整重建模型之呈現有許多的方
式，透過 CAD 檔案互換軟體 Solid View 轉換
成*.STL 圖形，而其中 RP 快速原型是一種最
能對於實體原型呈現的方式。計畫中以本系現
有之逆向工程與快速原型使用之軟硬體機
台，以及使用本系現有 RP 軟體 Catalyst 軟體
將圖檔切層，並規劃工作路徑，如圖 25 所示，
並以 RP 快速原型機加工完成之鞋楦模型如，
如圖 26 所示。 
 
 
圖 21 網格刪減發展軟體 
 
  - 10 -
 
圖 26 以 RP 輸出鞋楦模型 
 
4-4 網路可視化 
本計畫藉由虛擬實境軟體結合網路平
台，達到協同設計產品快速開發網之架構，雖
然此種方式無法對於實體的真正的摸得到，但
是只要有電腦就可以將其展現出來，並且可以
對其作一個互動式的交談，例如：拉近、拉遠、
放大、縮小、旋轉等動作之交談。 
在建立可視化之虛擬環境中，本計畫所應
用的虛擬實套裝軟體為EON Studio軟體，在這
套軟體當中，可以運用其內建的節點(Nodes)
功能，完成預展示之鞋楦動作，如圖27及圖28 
所示，此套軟體的製作效果也相當的擬真，並
且可以接受許多圖檔之格式。在本計畫當中所
完成的重建檔案格式，可以直接匯入EON 
Studio軟體中，所以就不用再透過轉檔之步
驟，而可以直接在此運用。在此使用EON 
Studio軟體作為另一種可視化之運用，如圖29
所示，並且可發佈成網頁型態，以建立業界及
學術界間可以進行協同設計產品快速開發網
之架構。 
 
圖 27 EON Studio 內建各種節點  
 
圖 28 EON Studio 下各動作相對應節點 
 
 
圖 29 EON Studio 下建立之鞋楦 
 
計畫中提出以 EON 完成其功能性編輯
後，並發布為網頁以提供產業界協同設計使
用，而計畫中所提出的協同設計開發平台網路
架構，詳細說明如下： 
以下針對進入設計開發階段介面的協同
設計的流程步驟作詳細說明，如圖 30 所示： 
(1) 協同合作者登入此專屬協同開發代理
人介面，並根據本平台建議提供的流程作相關
文件及資源的共享。  
(2) 協同合作者利用本平台提供的即時通
訊會議系統功能，來進行商務行為洽談，確定
委託工作內容及其價格估算等等。 
(3) 合作者決定專案以後簽訂模型製作電
子合約，並將專案計畫資料登錄至資料庫與行
事曆中，以方便日後管理追蹤進度及查詢。 
(4) 開始進行設計開發程序，並在過程中可
透過公佈欄和即時通訊不斷進行會議討論以
修正造型與開發進度。 
(5) 設計公司-A 以線上模型預覽或 VRML
功能提交數位模型建構向委託企業公司-甲展
示及供製造廠商使用。 
(6) 製造廠商-1 從平台下載確定可行的數
位模型來使用，並即時通訊或 E-mail 機制適
時與設計公司或委託企業公司溝通。 
(7) 完成客戶所需要的最終 3D CAD 模型。
並將建構好的 3D CAD 模型檔案回覆給設計
公司-A 確認無誤後，生產實體模型。 
