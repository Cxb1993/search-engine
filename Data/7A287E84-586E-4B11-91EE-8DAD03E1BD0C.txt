前言 
 
 從早期學術論文中，我們可以發現同步電路(synchronous circuit)與非同步電
路(asynchronous circuit)其實是同一時期的研究課題，早在 1950 年代就有學者提
出非同步系統(asynchronous system)的設計概念[1][2]，相較於同步電路下非同步
電路具有低消耗功率(low power)、低電磁波干擾(electro magnetic interference, 
EMI)、高強健性(robustness)、易模組化(modularization)等優點，但因設計與實作
上較同步電路複雜許多，導致研究發展較為緩慢，所以自 60 年代起同步電路儼
然成為數位電路的設計主流。 
 目前發展多年的同步電路已具備完善的 EDA(electronic design automation)及
標準的元件與模組。此外現階段 VLSI 電路設計所需的系統功能及時序驗證，就
同步電路系統而言，可藉由現有 ASIC(application-specific integrated circuit)設計
流程及傳統 FPGA(field-programmable gate array)來完成，然而這一系列的設計及
驗證方法卻不適用於非同步電路設計。坊間雖有非同步 FPGA 平台上市，由於晶
片屬初步量產階段，導致設備及工具的不普及、晶片成本高昂，且尚無完整的設
計實例及流程。因此本計畫提出一基於同步 FPGA 的非同步數位系統設計方法，
希望藉此加速非同步電路設計的推廣，並降低非同步學習門檻以及實驗設備的需
求。 
 本計畫提出之基於同步 FPGA 的非同步數位系統設計方法，以微型自我時序
微處理機作為實際設計案例，並以現有同步 FPGA 平台進行驗證。設計方法主要
由演算法層級(algorithmic level)之高階描述，經通道層(channel level)行為模式描
述驗證，再轉譯為交握層級(handshake level)的非同步有限狀態機及自我時序資料
流路徑，並以可供 FPGA 燒入之硬體描述語言進行電路描述，載入至現有 FPGA
進行系統功能測詴，以實際案例來證明該非同步數位系統設計方法於教學訓練及
雛形驗證可用性。 
 
1.研究目的 
  
 推廣非同步電路一直以來是我們努力的目標，但實際上非同步電路的推廣並
不容易，主要原因在於非同步電路並沒有一套完整的設計方法，對於初學者而言
這是一大難題。因此我們必需整理出一套有系統的設計方法及可驗證的平台，還
需要足夠的實際例子，使用手冊做為訓練使用外，更重要的為它需要一個可供使
用者使用的元件庫及較成熟的開發環境。 
非同步電路於理論上已被證實，然而在實際應用上，由於工具不夠完善及工
具鏈的不完整，因此從事非同步電路開發上還需要很多相關的背景，然而以現在
非同步電路設計於台灣，就是欠缺該類的相關背景，導致目前於學界及業界設計
架構上還難以非同步電路進行設計，因此我們將朝向工具鏈銜接及非同步元件庫
建置等方面發展，並把低功率消耗以及節能的設計方式推廣至學界及業界。 
階段二、 
(1) 實現 FPGA 可合成的資料路徑。 
(2) 靜態時序分析(static timing analysis, STA)步驟(1)所實現的資料路徑。 
(3) 依步驟(2)的靜態時序分析結果合成適當的應對延遲(matched delays)。 
(4) 將步驟(1)所實現的資料路徑與步驟(3)的應對延遲合併成自我時序資料
路徑，並確認應對延遲是否能與資料路徑最差(worst case)延遲匹配。 
 
階段三、 
(1) 實現延伸爆發模式(extended burst-mode,XBM)非同步狀態機[3][4]。 
(2) 使用 3D[4]合成步驟(1)的 XBM 狀態機成無危障(hazard free)邏輯方程
式。 
(3) 將步驟(2)的無危障邏輯方程式轉譯成 FPGA 可合成的無危障非同步控
制器。 
(4) 實現步驟(3)非同步控制器並以行為模式的鏡像(mirrored)狀態機做狀態
移轉及無危障驗證。 
 
階段四、 
(1) 合併階段二的自我時序資料流路徑與階段三的無危障非同步控制器。 
(2) 以擺設與繞線後(post place and route)模擬做系统功能及時序驗證。 
(3) 載入合成的完整系统及輔助測詴電路到 FPGA 實驗板上進行最終測詴。 
 
4.設計實例  
 
在此部份我們將以非同步微控制器作為設計範例，並搭配非同步電路設計流
程，進行實際電路設計說明。我們將分為微控制器之設計構想、資料流路徑設計
分析、非同步狀態機設計及電路合併與驗證四大項，分別介紹設計實例。 
 
4.1微控制器設計構想 
 
微控制器設計構想部份首先我們要決定指令集[5]、指令格式[5]、硬體架構
[5]等等，接著我們將該設計構想依行為模式描述進行電路實際驗證。 
(一)指令集 
指令集部分我們依現有控制器中使用率較為頻繁的指令進行實做，指令格式
中我們分為算數邏輯運算指令、資料傳送指令及跳躍指令三種如圖 5 所示，算
數邏輯運算指令首先將暫存器 rt及 rd的值傳給 ALU進行運算，並將運算結果寫
回暫存器 rs 中，資料傳送指令主要負責內部暫存器的管理及外部記憶體的連接
及週邊 IO腳位設定，此功能不需使用 ALU 運算。跳躍指令可分為兩種跳躍方式，
直接跳躍及間接跳躍兩種，直接跳躍是在於程式記憶體中直接加入指標，在運算
結束後跳躍至所指的指標位址，間接跳躍則是以原本的指標位址為基準，做遞增
或遞減的動作，達到程式跳躍。於指令格式中還有一個特殊格式，於程式執行中
J-type  
Opcode [31-26]  Address [25-0]  
功能說明  
J  
000010  address  
PC←(PC+4)[31..28] , address , 0 , 0:PC 指標跳躍至下一個指標的[31:28]加上
address(16bit)再補兩個 0  
JAL  
000011  address  
$31←PC+4 ; PC←(PC+4)[31..28] , address , 0 , 0；下一個指標存放在暫存器 31 裡。PC
指標跳躍至下一個指標的[31:28]加上 address(16bit)再補兩個 0  
由於整數指令集過多，僅取少數各型態指令做為代表 
 
(二) 自我時序功能元件 
我們於這個章節介紹自我時序資料流路徑中，各個自我時序資料流路徑元件
的功能及實現。自我時序資料路徑元件實現部份，我們以應對延遲及資料包裹的
方式進設計元件。首先將資料流路徑所需之功能元件透過 FPGA 合成工具做電路
配置及繞線處裡，並進行模擬驗證，即可以萃取出元件運算所需的延遲時間，根
據電路運算延遲時間加入一相對應的延遲元件，最後將運算元件及延遲元件包裹
在一起，並確認延遲時間是否符合需求，假使延遲時間無法搭配，則重新加入一
應對延遲元件，直到時序正確為止，如圖 6所示。 
圖 2：自我時序資料路徑元件 
 
4.3非同步狀態機設計 
 
我們根據行為描述之非同步控制器[7]交握訊號描述，以硬體描述語言進行
自我時序資料流路徑之非同步微控制器，並與行為描述方式協同驗證直到符合設
計需求，接著我們將該描述方式轉為延伸爆發模式狀態機描述語法(圖 11)，經
由 Yun 博士開發的合成工具 3D，進行無危障的非同步控制器合成，電路經合成
後即可進行非同步控制器之硬體電路時序驗證，倘若時序驗證有誤則重複上述之
流程，直到非同步控制器時序功能正確為止。 
圖 4：管線化差異圖 
4.5 暫存器連鎖(register interlock)及分支預測 
暫存器連鎖是當該指令的下一個指令需要用到上一個指令的運算結果，由於
上一個指令尚未運算完畢導致下一級的結果運算錯誤。解決方法有 2 種一是將上
一級結果不經過暫存器直接拿給下一級做運算，這種方法稱作資料前潰
(data-forwarding)。或是插入 NOP 並等待上一個指令運算完後再繼續執行下一個
指令。 
分支預測則是當遇到指令為跳躍指令時發生的，等到跳躍指令運算結束後其
它指令也已經在運算了。解決方式有 2 種一是等待跳躍指令運算完畢後將其餘正
在運算的指令結果捨棄再重新讀取跳躍後的指令做運算，這種方法稱作管線排放
(pipleline flush)。二是判斷為跳躍指令時便插入 NOP 指令等待跳躍指令運算完後
再繼續運算。 
電路部份我們先以不考慮暫存器連鎖及分支預測的問題，目標以五階段管線
化為目標的前提來實作電路。對於微處理器會遇到的暫存器連鎖及分支預測的處
理方法我們以程式先在指令載入 ROM 前將會遇到問題的部份先插入 NOP 來解
決。 
 
圖 5：管線化前後指令差異 
5.非同步微控制器實現 
5.1 管線化非同步微控制器實作 
管線化是將整個微控制器大致分為五大區塊，各區塊完成自己的工作後便將
資料存入暫存器中供下一個區塊使用，然後反覆此動作。我們依照常見的區塊來
區分成截取、指令解碼/暫存器檔案存取、執行/位置運算、記憶體存取及寫回等
五個步驟依序將非同步控制器區分成相同的五個區塊控制對應的元件。 
Ctrl1
IF
Latch
Ctrl2
ID
Latch
Ctrl3
EX
Latch
Ctrl4
MEM
Latch
Ctrl5
WB
 
圖 6：管線化區塊分割意示圖 
繁瑣且沒有完整的設計導引而望之卻步。因此本計畫以傳統 FPGA 電路設計流程
為基礎，提出一套非同步電路設計流程，以現有的 FPGA 及其合成工具來學習非
同步電路，希望藉此來降低非同步電路設計的學習門檻。 
 本計畫捨棄一般論文中常見的理論推導，改以實作導引的方式來說明我們所
提出的設計流程，首先對非同步電路做概略性的介紹，並針對本計畫所使用的非
同步電路設計背景做重點式說明，如非同步電路通訊協定、延伸爆發模式狀態機
描述等，接著提出一套完整的設計流程，並詳述各實作階段中每一步驟的主要工
作項目。之後將所提出的設計流程套入一微型自我時序微處理機的設計及實作，
從指令集設計、行為模式功能驗證、自我時序資料路徑實現、非同步狀態機合成、
系统合併驗證，乃至 FPGA 實驗板功能測詴等步驟，搭配程式片段、區塊圖、模
擬結果、及實體照片，做循序漸進式的說明，並引導讀者深入了解本文所提出的
非同步電路設計流程。最後我們以該設計流程實現更多的實用範例，並將本文所
提出的非同步電路設計流程實現成電子設計自動化工具，以期在不久的將來能完
成一基於傳统 FPGA 的非同步電路設計教材。  
 
9.參考文獻 
[1] Scott Hauck, “Asynchronous design methodologies: An overview,” InProceedings 
of the IEEE, vol.83, no.1, Jan 1995, pp. 69 - 93.  
[2] Sparso J., and Furber S., “Principles of Asynchronous Circuit Design:A Systems 
Perspective,” Kluwer Academic Publishers, 2001.  
[3] Chris J. Myers., “Asynchronous Circuit Design.” John Wiley & Sons, 2001.  
[4] Yun K.Y., Dill D.L., “Automatic synthesis of 3D asynchronous state machines,” 
Computer-Aided Design, 1992. ICCAD-92. Digest of Technical Papers., Nov. 1992, 
pp.576 - 580.  
[5] MIPS Technologies, Inc., [Online], Avaliable: http://www.mips.com/  
[6] Advanced RISC Machine, [Online], Avaliable: http://www.arm.com/  
[7] A.J. Martin, A. Lines, R. Manohar, M. Nystrom, P. Penzes, R. Southworth, U. 
Cummings, and T.K. Lee, “The Design of an Asynchronous MIPS R3000 
Microprocessor,” Advanced Research in VLSI, 1997. Proceedings., 15 - 16 Sep. 1997, 
pp. 164 - 181.  
99 年度專題研究計畫研究成果彙整表 
計畫主持人：楊榮林 計畫編號：99-2221-E-218-041- 
計畫名稱：基於 FPGA 可客製化低功耗自我時序微控制器 IP 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 1 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 1 0 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 2 2 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 1 0 100% 
一篇已接受並發
表,另一篇則進入
第二階段有條件
接受的審查 
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
