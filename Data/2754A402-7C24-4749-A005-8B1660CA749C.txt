一種新的最佳演算法應用於動態經濟調度之求解 
計畫編號：NSC－96－2221－E－268－006 
執行期間：96 年 8 月 1 日 至 97 年 7 月 31 日 
計畫主持人：廖國清 
計畫參與人員： 林義福、趙鄭春 
執行單位：和春技術學院 電機系 
 
中文摘要 
在本計劃中提出一個新的最佳演算法-以隔離小生
境免疫遺傳演算法來求解電力系统之基於競價機制之動
態經濟調度問題。經濟調度問題乃在將經由機組排程决定
了那些機組應上機發電後，而來求解每部機組在滿足各項
限制條件下，應發出多少電力才能產生最低之發電成本。
在競爭性的電力市場環境下，為了獲得最大化的社會利
潤，提出了基於競價機制的動態經濟調度模型。該模型綜
合了考慮發電機組的爬坡約束條件、輸電線的容量約束與
汚染氣體排放量等之約束條件，針對該模型，提出了新的
求解方法-隔離小生境免疫遺傳演算法。在本計劃中小生
境(niche)技術的引入，提高了免疫遺傳算法在處理多峰函
數(multi-peak model function)優化問題的能力。本文提出基
於隔離(Isolation)機制的小生境。隔離小生境技術具有生物
學基礎，不僅能夠有效地保證群體中解的多樣性，而且具
有很強的引導進化能力。另外一方面，在使用之免疫遺傳
算法本身即是一個非常優越之解多峰值之一個創新方
法，在本計劃中並提出新的改良方法。在本計劃中將兩個
方法予以融合應用，使本計劃更具求解非線性規劃最佳解
之能力更加進化。在使用本方法對於所提出之初步模式作
一測試，得到相當不錯效果。如果將其擴大至實際(如台
電)模型，並與各種其它目前所使用模型及方法作一實際
比較，將更能實現本計劃之理想性及實用性，故而是一個
非常值得執行的一個計劃。 
 
關鍵詞:隔離小生境法，免疫遺傳演算法，動態經濟調度，
競價機制。 
 ABSTRACT 
This planning presents a new optimal algo-
rithm–Isolation Niche Immune Genetic Algorithm for solv-
ing Bid-Based Dynamic Economic Dispatch (INIGA-BDED) 
in a power system. Economic Dispatch determines the elec-
trical power to be generated by the committed generating 
units in a power system so that the generation cost minimized, 
while satisfying the load demand simultaneously. The devel-
oped Isolation Niche Immune Genetic Algorithm optimiza-
tion technique used the total generation cost as the objective 
function and represented as the affinity measure. Through 
Immune Genetic Algorithm evolution, the antibodies with 
high affinity measure are produced and become the solution. 
Here, we propose a bid-based dynamic economic dispatch 
nodded to maximize the social profit in a competitive elec-
tricity market. The model synthetically considers various 
constraints such as ramp rates, transmission line capacity and 
emission constraints to obtain a physically feasible resource 
scheduling. The adoption of niche concept improves the abil-
ity of Immune genetic algorithm in solving multi-model func-
tion optimization problems. Here, we present a new niche 
model which is based on the isolation mechanism. Isolation 
plays very important roles in diversity in population but also 
has the function of guidance for evolution. The method is ap-
plied to solve the problem. Numerical simulation results show 
that the proposed INIGA method is capable of obtaining 
higher quality dispatch efficiently, furthermore, the algorithm 
is versatile and robust.  
 
Keyword: Isolation Niche, Immune Genetic Algorithm, Dy-
namic Economic Dispatch, Bid-Based. 
 
(一) 、 前言 
 
動態經濟調度 (Dynamic Economic Dis-
patch，DED)在電力系統運行、即時控制中扮演
著十分重要的角色，對於提高電力系統運行的經
濟性和可靠性都具有重要的意義。隨著電力工業
體制的改革，傳統的電力系統經濟調度又被賦予
諸多新的意義。為了提高電力系統中各參與方的
競爭力，最優化資源配置，電力市場環境下的動
態經濟調度已經從傳統的以生產成本最小化的
目標轉化為基於競價機制、社會利潤最大化的目
標。在市場環境中，各參與方提交自己的提前一
日或提前一小時的競標曲線(包含各時段競標的
電量、電價及相應的運行參數)給獨立系统操作
者-ISO(Independent System Operator),ISO在滿
足系統的經濟性和安全性的前提下，以社會利益
最大化為目標進行各交易時段的動態經濟調度。 
電力市場中的競價函數， abc gigigi ,  , 為競價函
數的常係數; )( ,dB tji 為用戶 j 在電力市場
中的競價函數， abc djdjdj ,  , 為投標曲線的常係
數。  
 
(1.2). 約束條件  
1). 負荷與發電的平衡 
∑ ∑
= =
 +  = 
Lg
i
Ld
j
t
tjti Lossdg
1 1
,,                (4) 
t =1,2……,T 
式(4)中，Losst 為系統在時段 t 的配電網
路損失之功率值;由於下面考慮了支路潮流的
約束，Losst 乃採用潮流計算所獲得之值。  
 
2). 機組最大、最小競標發電功率 
ggg tititi max,,min,  ≤  ≤                  (5)     
 i =1,2,…, L g  
式(5)中， gg titi max,min, ,  分別為機組 i 在時
段 t 競標的最大、最小發電功率。 
 
3). 用戶最小、最大競標負荷 
ddd tjtjtj max,,min,  ≤  ≤                  (6)  
j =1,2,…, Ld  
式(6)中， dd tjtj max,min, ,  分別為用戶 j 在時段
t的最小、最大的競標負荷。  
 
4). 機組爬坡速度約束  
tt UggD RititiRi Δ⋅≤−≤Δ⋅− + )( ,1,       (7) 
式(7)中，U Ri 和DRi 分別為機組單位時問內
的最大上升和下降速率; tΔ 為每個時段所持續
的時間。  
 
5).支路潮流約束 
 FFF ltll max,min ≤≤−                 (8)   
   
式(8)中: F tl, 為時段 t，支路 l 傳輸的功率; 
F l max為支路傳輸的功率限值。 
6). 污染氣體排放量的限制 
APMHi
T
t
ti
Lg
i
g   ≤ ∑ ∑
= =
)(
1
,
1
                 (9) 
 
式(9)中， )( ,g tiHi 是發電機 i 的汚染氣體排放量
的線性函數，APM 是最大允許的汚染氣體排放量
的指標。 
 
2. 基於隔離小生境技術的免疫遺傳算法 
(2.1). 物種形成和小生境技術 
在自然界也 ”物以類聚，人以群分” 是一種
司空見慣的現象。生物總是傾向於與自己特性、
形狀相類似的生物生活在一起，一般總是與同類
交配繁殖後代，這種交配方式在生物進化過程中
是有積極意義的。生物學上，小生境是指特定環
境中的組織功能或角色而把有共同特性的組織
稱為物種(species)。自然界的小生境為新物科的
形成提供了可能性，是生物界保持近乎無限多樣
性的根本原因之一，為了使免疫遺傳算法能夠有
效地處理多峰值函數優化問題，許多學者將小生
境技術引入免疫遺傳算法。1970年，Cavicchio
率先在遺傳算法中引入了基於預選擇機制的小
生境技術。1975年De Jong 一般化了Cavicchio的
預選擇機制，提出了一種稱作排擠機制的小生境
技術。1987年 Goldberg 和Richardson提出了一
種基於共享機制的小生境技術。這三種小生境技
術對保證解的多樣性無疑是有效的，提高了免疫
遺傳算法進行多峰值函數優化時獲得最優解的
概率，對於多峰值函數優化問題除了維持解的多
樣性之外，更重要的是在進化過程也要具有擺脫
局部最優解，不斷開拓新的搜索空間的能力。這
就需要構造一種新的進化策略，只有在任何情況
下都具有進化潛力的算法，才能在理論上保證獲
得最優解。為此提出一種基於隔離機制的小生境
技術，隔離小生境技術不僅具有上述小生境技
術，保證解群多樣性的能力，還具有很強的搜索
能力從而為多峰函數優化搜索最優解提供了保
障。 
 
(2.2). 隔離在生物進化過程中的作用 
生物在進化過程中，之所以具有形成千變
萬化的物種的能力，主要是因為生物種群具有分
法，其遺傳因子之資料結構-抗體之编碼如圖一所
示，在圖中總共有 Z 個抗體，每一個抗體有 M
個遺傳因子，也即在一個演化世代內具有 Z 個抗
體，在每個抗體中之每個基因位被標示為 k1, 
k2,…, kt,…, ks。 
 
i
t
              
            
             圖一、 抗體之編碼 
 
2.4.2 多樣性及親和力計算: 
 
假設在抗體池內有 Z 個抗體，其每一個抗體
有 N 個遺傳因子，在此我們提出了「資訊熵」的
概念，我們表示為: 
1 2
, , , ,( ), , ,
nl
i t i t i t i tx x xX =  ...                 (10) 
在此 
 
,
l
i tX  表示為在抗體內之任一抗體， 
l   表示為抗體之數目 ( l  = 1, 2, …, u, v,…, Z)， 
i  表示為抗體 m 之基因數目( i=1, 2, …. , N)。 
 
此時以抗體 1 為例， 機組之狀態編碼表示可
化成以下圖(二)中所示，其可視為圖一之映射: 
 
1
,n tx11,tx 12,tx  
 
   圖二、 機組之狀態編碼表示 
 
此時 1
,i tX 可表示為抗體 1，也即等於
g ti, ( g ti, 可由公式(3)得知，也即為機組 i 在時
段 t 的輸出功率)。其它抗體也可由同樣方法產
生之。 
同理，另外一個值 d tj,  (d tj, 可由公式(2)
得知，乃為用戶在時段 t 的負荷)也可以同樣原
理予以編碼後計算之，且其與上述 g ti,  值之計
算乃平行進行之。 
假設在一個抗體內共含 i 部機組之輸出功
率，i 由發電廠內發電機組決定。 
 
 
, , ,
1
( ) logn
i i t i t i t
t
S
XIE P P
=
= −∑           (11) 
 
,( )i
n
i tIE X 在此代表第 n 個抗體之第 i 個「資
訊熵」， P ti , 為第 k t個遺傳因子來自第 i 個基因
之概率，而 P ti , 之測試值設定約在[0.1,0.9]之
間，其基因之特性計算乃使用第(12)式，而「平
均資訊熵」表示為 
 
,,
N
1
(
N
( )
1 )nn i ti t i
i
XXIE IE
=
 =  ∑             (12) 
 
在第(12)式中所示，其熵可示為抗體族群之多
樣性。 
在本計劃中使用兩個親和力之計算式，其第
一個表示為在兩個抗體之間之親和力計算: 
 
, ,
, ,( , )
1( , )u vi t i t
u v
i t i tIE X X
Ab X X  +1   
  =       (13) 
 
    在此 , ,( , )u vi t i tAb X X 表示為兩個抗體間之親
和力，
,
u
i tX  及 ,
v
i tX 僅表示為兩個抗體 v 及 u
之間的資訊熵。 
在第(13)式中所示當兩個抗體間有較小之親
和力，則代表有較大的多樣性。 
而第二個親和力之計算乃使用抗體與抗原
之間之關係，其表示式如(14)式所示: 
 ( ), ,1
1( )u ui t
X i tFs
Ag X
e
−       
= 
   +            (14) 
 
在此
,
( )u
i t
Fs X 為一個適應值，其乃用來表明
在抗體
,
u
i tX 與抗原間之相似關係。寫為 
 
,
min,
1( )
( ) /
u
i t
T Ti t
i t
s X
PF
F
F F  
=     + ∑∑      (15) 
)( ,,XC gntiΔ
)( ,,Xm gntiΔ)( ,,XFs gntiΔ
)( ,,XFs gntiΔ
)( 1,,XFs gnti −Δ)( 1,,XFs gnti −
)( ,,XFs gnti
 
圖四、 由模糊系統法調整免疫法中之交配率與突變率值
之大小 
)( ,,XFs gn tiΔ = )( ,,XFs gnti – )( 1,,XFs gn ti −     (19)  
 
)( ,,X gntiFsΔ ， )( 1,,X gn tiFs −Δ ， ,,( )i tn gC XΔ 及
,
,( )
n g
i tm XΔ 等之歸屬函數(membership functions)如
圖五至圖七所示: 
 
)(
)
1,
,
,
,(
XFs
XFs
gn
ti
gn
ti
and
−Δ
Δ
       
 
         
圖五、 )( ,,XFs gn tiΔ and )( 1,,XFs gn ti −Δ 之歸屬函數 
 
)( ,,XC gntiΔ
 
圖六、 
,
,( )
i t
n gC XΔ 之歸屬函數 
 
)( ,,Xm gntiΔ
     
       圖七、 ,,( )n gi tm XΔ 之歸屬函數. 
表一  ,,( )n gi tm XΔ  之模糊判別表 
)( 1,,XFs gnti −Δ   
)( ,,XFs gntiΔ NH NL NM NS ZE PS PM PL PH
     NH NH NH NL NM NS NS ZE ZE ZE
NL NH NL NM NM NS NS ZE ZE PS
NM NL NL NL NM NS NS ZE ZS PS
NS NM NM NM NS NS ZE ZE PS PM
ZE NM NM NS ZE ZE ZE PS PS PM
PS NM NS ZE PS PS PM PM PM PL
PM NS NS ZE ZE PS PM PM PL PL
PL ZE ZE ZE PS PM PM PL PL PH
 
PH ZE PS PS PS PM PL PL PH PH
 
它們的值變化量範圍為已經歸一化，其為
)( ,,X gn tiFsΔ 及 )( 1,,X gntiFs −Δ 之值為介於 
[-1.0,1.0]，  
,
,( )
i t
n gC XΔ 之值為介於  [-0.1,0.1]， 
,
,( )
n g
i tm XΔ 之值為介於 [-0.01,0.01]。由以上實驗之
推論所得之 ,,( )n gi tm XΔ 模糊決定表如表一所示，另
,
,( )
i t
n gC XΔ 推論所得之模糊決定表也可以相同方
法求得。在表一中所示， NH 代表 (Negative 
Huge)， NL 代表 (Negative Large)，NM 代表 
(Negative Medium)， NS 代表 (Negative Small)，
ZE 代表(Zero)， PS 代表 (Positive Small)， PM
代表  (Positive Medium)，  PL 代表  (Positive 
Large) and PH 代表 (Positive Huge)。 
 
步驟 7:交配之進行 
 
  在此我們乃使用 “選擇窗口＂之方式進行，其
方法乃將兩個父代解所選之窗口內之基因作交
换後產生兩個新的子代。其方法如圖八所示: 
 
1  1  0  0  1  0  1  1  0  1  1  0  0  1  1 1  0  1  1  1  1  0  0  0  1  0  1  1  1  0  
1  1  0  0  1  0  1  1  0  1  1  0  0  1  1 1  0  1  1  1  1  0  0  0  1  0  1  1  1  0
     
1 0 0  0  1  1   
P a r e n t  A P a r e n t  B
O f f s p r i n g  1 O f f s p r i n g  2
C r o s s o v e r  p a r t
A g r e e m e n t  a b o u t  b e tw e e n  tw o  a n t ib o d ie s
[ 1  0  1  1  0  1 ] = = [ 1  1  0  0  0  1 ]
       
 
圖八、交配使用 “選擇窗口＂之方式進行 
 
步驟 8: 突變之進行 
    表二、  發電商競標數據 
 
4.1 不考慮部份約束條件下的基於競價機制的動態經濟調度
模型 
 
    為了求得使用隔離小生境免疫遺傳算法(INIGA)於動
態經濟調度模型之有效性，並且使計算簡單化，首先我們
不考慮輸電線路的容量限制、機組爬坡率限制及污染氣體
的排放量限制，表三只使用了 INIGA 算法得到各發電商和
用户最終所得到之競標數量。 
               
表三、 發電商和用户競標的優化結果 
 
 
本文同時應用動態規劃法(DP)和遺傳演算法(GA)在以
同樣的條件下，對該系統進行優化調度，表四所得之結果
為 3 種算法的優化結果。從表中可看出 GA 及 INIGA 法顯
然比 DP 法要好，從計算時間可知，INIGA 算法所需之時
間是 11.35 秒，而 GA 算法所需之時間是 17.22 秒，而 DP
算法所需之時間是 21.89 秒，顯然 INIGA 之計算速度比 GA
及 DP 來得快。另一方面，從收斂的叠代數來看，INIGA
算法在第 18 代後就收斂至最佳解，而 GA 則在叠代 45 次
後才收斂至最佳解，所以 INIGA 算法收斂性要明顯優於
GA 法。 
 
表四、 不同計算法在同樣條件下的結果比較 
 
4.2 考慮機組爬坡率約束 
假設該系統發電商 2 的機組爬坡函數約束的上、下限
分別為 60 MW/h 及 20 MW/h，發電商 3、4 的機組爬坡函
數約束的上、下限均為 40 MW/h 及 10 MW/h，考慮各機組
約束條件，用 INIGA 法進行優化調度之發電商和用户的優
化結果如表五所示。由於增加了機組爬坡約束，總的社會
利潤從原來的 72115 降為 71256。 
 
表五、考慮機組爬坡率約束發電商和用户競標的優化結果 
 
 
4.3 考慮線路的容量约束和汚染氣體排放的約束 
     表六是發電商和用户最終優化結果，用計算結果可
知，最後的社會利潤值從 72115 降為 70889。 
 
表六、計及線路 7 約束條件的發電商和用户競標的優化結
果 
 
 
(五) 、 結論 
 
1). 本文提出了基于競價機制的動態經濟調度
模型。該模型能夠優化在市場環境下發電商
的經濟調度和用戶的最優負荷水準，使其在
滿足系統運行約束的前提下，能夠達到社會
利潤最大化，符合電力市場最大資源優化配
置的最終目標。 
2). 由於該經濟調度問題具有高維、非線性、約
束條件多的特點，本文提出了用隔離小生境
免疫遺傳算法進行了優化求解，將先以較小
系統進行計算，然後再以台電之實際系統計
算分析，並和動態規劃法和遺傳算法及其它
           cgi   bgi   agi      MW
Gmin     
MW
G max  
發電商 1   650  8.35  0.0017     100       780 
發電商 2   610  8.64  0.0033      80       620 
發電商 3   420  7.22  0.0038      50       540 
發電商 4   150  6.37  0.0052      10       410 
