 I
中文摘要 
 
本計畫為兩年期計畫，在第一年計畫中我們設計與評估正交分頻多工-分碼多重進接
(OFDM-CDMA)通訊系統在多路徑通道中下行鏈路之接收機架構與性能。正交分頻多工-分
碼多重進接系統的接收機中使用適應性等化器(Adaptive Equalizer)與渦輪解碼器(Turbo 
Decoder)。適應性等化器使用最小均平方誤差(Least Mean Square, LMS) 演算法作為適應性
等化器的適應性演算法。我們研究兩種接收機架構：第一種是傳統的方法，即等化器與渦
輪解碼器獨立運作的架構(Equalizer Disjointed with Turbo Decoder)。第二種架構為等化器與
渦輪解碼器聯合運作的架構(Equalizer Jointed with Turbo Decoder)。這兩種接收機的等化器
權重是每個訊符更新一次，此項設計有效地降低了演算法運算上的複雜性。第二種架構中
等化器使用來自渦輪解碼器的外部資訊，經過多次迭代之後，能更有效消除多用戶存取干
擾(Multiuser Access Inteference, MAI)與多路徑干擾(Multipath Interference)。 
 
在第二年度計畫中，首先將第一年度所設計的接收機推廣至非同調(Non-Coherent)正交
分頻多工-分碼多重進接(OFDM-CDMA)通訊系統，並利用渦輪解碼器所產出的外部資訊
(Extrinsic Information)設計出變化步階(Varying Stepsize)的適應性等化器。利用渦輪解碼器
所產出的外部資訊調節適應性等化器的步階，能有效降低錯誤的傳播(Error propagation)，
能大幅提升系統效能。其次針對所提出之等化器與渦輪解碼器聯合運作的 Turbo 
OFDM-CDMA 適應性接收機，使用 Verilog 硬體描述語言實現其硬體架構，並與理論上的
效能比較，以確認其可用性。 
 
 III
Contents 
 
中文摘要...........................................................................................................................................I 
Abstract .......................................................................................................................................... II 
Contents ........................................................................................................................................ III 
List of Figures ...............................................................................................................................IV 
1、Introduction .............................................................................................................................. 1 
2、Research .................................................................................................................................... 2 
2-1、The research in the first year........................................................................................... 2 
2-1-1、OFDM-CDMA .................................................................................................... 2 
2-1-2、Turbo Decoder..................................................................................................... 2 
2-1-3、Turbo Equalizer ................................................................................................... 3 
2-2、The research in the second year ...................................................................................... 3 
2-2-1、Non-coherent OFDM-CDMA ............................................................................. 3 
2-2-2、Varying Stepsize Adaptive Equalizer .................................................................. 3 
2-2-3、Verilog Design Implementation........................................................................... 3 
3、References ................................................................................................................................. 7 
4、Research Method...................................................................................................................... 9 
4-1、The research methods in the first year ............................................................................ 9 
4-1-1、System Model...................................................................................................... 9 
4-1-2、The De-spreading Equalizer .............................................................................. 10 
4-1-3、Turbo Decoder................................................................................................... 12 
4-1-4、The Adaptive Turbo Receivers .......................................................................... 16 
4-2、The research method in the second year....................................................................... 17 
4-2-1、Non-Coherent Adaptive Turbo Equalizer of OFDM-CDMA system................ 17 
4-2-2、Varying Stepsize Turbo Equalizer of OFDM-CDMA system ........................... 18 
4-2-3、Hardware Implementation ................................................................................. 19 
4-2-4、Implementation of De-spreading Equalizer....................................................... 19 
4-2-5、Implementation of Max-Log-MAP Decoder..................................................... 20 
4-2-6、Implementation of Turbo Decoder .................................................................... 23 
5、Simulation Results and Discussion ....................................................................................... 24 
5-1、Fixed Stepsize Adaptive Turbo Equalizer..................................................................... 24 
5-2、Varying Stepsize and Non-coherent Adaptive Turbo Equalizer ................................... 24 
5-3、Adaptive Turbo Receiver Implementation.................................................................... 28 
6、Conclusions ............................................................................................................................. 33 
 1
1、Introduction 
 
In the first year of this project, the receivers with adaptive equalizer and turbo decoder are 
investigated for orthogonal frequency division multiplexing-code division multiple access 
(OFDM-CDMA) systems in multipath channels. In our proposed receivers, the equalizer not only 
equalizes the distorted signal but also cancels the multiple access interference (MAI), hence 
called de-spreading equalizer. 
Error correcting code is a dispensable element is modern communication system to overcome 
channel impairments such as noise and multipath propagation. Turbo code has the characteristic 
of approaching Shannon limit, offer very low BER under lower SNR. 
The receivers with adaptive equalizer and turbo decoder are investigated for orthogonal 
frequency division multiplexing-code division multiple access (OFDM-CDMA) systems over 
multipath channels. The LMS algorithm is used as the adaptive algorithm for the de-spreading 
equalizer. Two receiver architectures are investigated: The first one is the traditional receiver 
called equalizer disjointed with turbo decoder. The second receiver architecture is equalizer 
jointed with turbo decoder. 
 In the second year, the adaptive turbo receivers developed in the first year are extended to 
non-coherent system and the receiver architectures for non-coherent OFDM-CDMA systems are 
derived and compared for several well known channel models. The extrinsic information from 
turbo decoder is also utilized to design a varying-stepsize equalizer. This type of varying-stepsize 
adaptive equalizer is shown to provide about 1~2dB performance improvement in most scenarios. 
Also the hardware architectures of the adaptive turbo OFDM-CDMA receivers are implemented 
by Verilog hardware description language and the performance of the implemented hardware 
model is compared with their theoretical performances.
 3
than the MAP algorithm and better performance than the SOVA algorithm. 
 
2-1-3、Turbo Equalizer 
Another impressive performance improvement can be gained from combining the processes 
of equalizer and turbo decoding. That is, turbo equalization is an iterative equalization and 
decoding technique that can achieve tremendous performance gains for communication 
systems that send digital data over channels that require equalization, i.e. those suffer from 
inter-symbol interference. But in original study of turbo equalization [6] , convolutional codes 
were the error correction code and the channel impulse response is usually claimed to be 
known. Since MAP algorithm is used in equalizer and convolutional code decoder, it has the 
drawback of very high complexity if the delay spread is very long. In [7][8][9], the equalizer 
has been replaced with linear equalizer to reduce the complexity, but the channel impulse 
response still needs to be estimated. Since turbo code has been specified in the standard of 
many next generation wireless communications systems, we investigate the turbo equalization 
receivers and their performance of turbo coded data transmission over ISI channels with 
adaptive equalizer [10].  
 
2-2、The research in the second year 
2-2-1、Non-coherent OFDM-CDMA 
Non-coherent communication systems which use differential encoding allow to 
significantly relax the carrier phase stability requirements—all needed is the stability of the 
observed signal phase over two successive signaling intervals [13]. This technique is 
applicable to a variety of linear modulation formats, such as amplitude and phase-shift keying. 
Therefore, non-coherent communication systems need not provide extra channel capacity to 
achieve carrier synchronization and usually have lower complexity when compared with 
coherent systems.  
 
2-2-2、Varying Stepsize Adaptive Equalizer 
The performance of traditional adaptive equalizer can be easily ruined by the error 
propagation when the equalizer operates in the decision-directed mode [11]. In the turbo 
equalization processing, the MAP decoder can provide extrinsic information of transmitted bit 
sequence to the equalizer. The extrinsic information carries the reliability information of the 
transmitted sequence. When incorporating the reliability information with the stepsize of the 
adaptive equalizer, the adaptive equalizer becomes a varying-stepsize equalizer which adjusts 
the stepsize according to the reliability information. Therefore, the error propagation problem 
can be alleviated. 
2-2-3、Verilog Design Implementation 
The architecture of the turbo equalizer developed in the first year is implemented and 
simulated using Verilog design suite [12]. The diagram (Fig. 2.1) below summarizes the high 
level design flow for an ASIC (i.e. gate array, standard cell) or FPGA. In a practical design 
 5
the coverage of these test cases. 
For today's large, complex designs, verification can be a real bottleneck. This provides 
another motivation for SystemVerilog - it has features for expediting test bench development. 
 
RTL verification 
The RTL Verilog is then simulated to validate the functionality against the specification. RTL 
simulation is usually one or two orders of magnitude faster than gate level simulation, and 
experience has shown that this speed-up is best exploited by doing more simulation, not 
spending less time on simulation. 
In practice it is common to spend 70-80% of the design cycle writing and simulating Verilog 
at and above the register transfer level, and 20-30% of the time synthesizing and verifying the 
gates. 
 
Look-ahead Synthesis 
Although some exploratory synthesis will be done early on in the design process, to provide 
accurate speed and area data to aid in the evaluation of architectural decisions and to check the 
engineer's understanding of how the Verilog will be synthesized, the main synthesis production 
run is deferred until functional simulation is complete. It is pointless to invest a lot of time and 
effort in synthesis until the functionality of the design is validated. 
 
Design process 
 Fig. 2.2 shows a very simplified view of the electronic system design process incorporating 
Verilog. The central portion of the diagram shows the parts of the design process which will be 
impacted by Verilog. 
 
System level 
Verilog is not ideally suited for abstracting system-level simulation, prior to the 
hardware-software split. This is to some extent addressed by System Verilog. Unlike VHDL, 
which has support for user-defined types and overloaded operators which allow the designer to 
abstract his work into the domain of the problem, Verilog restricts the designer to working with 
pre-defined system functions and tasks for stochastic simulation and can be used for modeling 
performance, throughput and queuing but only in so far as those built-in language features allow. 
Designers occasionally use the stochastic level of abstraction for this phase of the design 
process. 
 
Digital 
Verilog is suitable for use today in the digital hardware design process, from functional 
simulation, manual design and logic synthesis down to gate-level simulation. Verilog tools 
provide an integrated design environment in this area. 
Verilog is also suited for specialized implementation-level design verification tools such as 
fault simulation, switch level simulation and worst case timing simulation. Verilog can be used 
 7
3、References 
 
[1] Kaiser S., “OFDM code division multiplexing in fading channels,” IEEE Trans. on 
Comm., vol.50, pp.1266-1273, Aug. 2002. 
 
[2] Kaiser S. and Hagenauer J., “Multi-Carrier CDMA with Iterative Decoding and 
Soft-Interference Cancellation,” in Proc. IEEE Global Telecommunications Conference 
(GLOBECOM’97), Phoneix, USA, pp. 6-10, Nov. 1997. 
 
[3] C. Berrou, A. Glavieux, and P. Thitimajshima, “Near Shannon limit error-correcting 
coding and decoding: Turbo codes,” in Proc. IEEE Int. Conf. on Communications, Geneva, 
Switzerland, May 1993. 
 
[4] L. R. Bahl et al., “Optimal decoding of linear codes for minimizing symbol error rate,” 
IEEE Trans. Inform. Theory, vol. IT-20, pp. 284–287, Mar. 1974. 
 
[5] S. Lin and J. J. Costello, Error Control Coding. 2nd Ed., Upper Saddle River, NJ: Pearson 
Prentice-Hall, 2004 
 
[6] C. Douillard, M. Jezequel, C. Berrou, A. Picart, P. Didier, and A. Glavieux, "Iterative 
correction of intersymbol interference: Turbo equalization," European Trans. on 
Telecomm., vol. 6, pp. 507--511, Sep-Oct 1995. 
 
[7] X. Wang and H. Poor, "Iterative (turbo) soft interference cancellation and decoding for 
coded CDMA," IEEE Trans. on Comm., vol. 47, no. 7, pp. 1046--1061, 1999. 
 
[8] M. Tuchler, R. Koetter, and A. Singer, "Turbo equalization: principles and new results," 
IEEE Trans. on Comm., vol. 50, pp. 754--767, May 2002. 
 
[9] M. Tüchler, A. Singer, and R. Kötter, “Minimum mean squared error (MMSE) 
equalization using priors,” IEEE Trans. Signal Processing, vol. 50, pp. 673–683, Mar. 
4、Research Method 
 
4-1、The research methods in the first year 
4-1-1、System Model 
The downlink of OFDM-CDMA communication system is investigated. Fig. 4.1 shows 
the baseband structure for the OFDM-CDMA transmitter. The transmitter part is composed 
of source coding, channel coding, modulation, and multi-users access management, the 
high-frequency front-end with pulse-shaping, up-converting and amplifying. Here only the 
following parts are examined and implemented for several users each channel error control 
coding with Turbo-Codes, modulation with Quadrature Phase Shift Keying (QPSK). Then 
all users’ signals are added onto the channel. A usual assumption for wireless transmission 
channels is that Additive White Gaussian Noise (AWGN) occurs. Also Multiple Access 
Interference (MAI) can be noticed, originating from multiple paths scattering and delaying 
the signal. Signal fading, frequency and phase distortion are other observable effects, but 
this thesis will restrict itself to AWGN and MAI.  
 
Fig. 4.1 The structure of OFDM-CDMA transmitter 
Assume that there are K active users accessing this multi-carrier system simultaneously, 
and the source information sequence for the k-th user is { }( ) ( ) 0,1ku n ∈ . The coded bit 
stream is ( ) ( )kx n  with code rate equals to 1/3 after turbo coded with two component 
convolutional codes. After puncture and QPSK modulation, each symbol  is spread 
by a spreading code sequence . The spread signal is serial-to-parallel converted and 
OFDM modulated via IFFT operation. The samples after IFFT are parallel-to-serial 
converted and a cyclic prefix (CP) is added to the OFDM symbol to mitigate inter-symbol 
( )kd n
( )kc
 9
the desired user k will be dropped for the briefness of equation when there is no evidence of 
ambiguity. 
The de-spreading equalizer output signal  of the desired user can be formulated as 
follows 
( )q n
              (4.3) ( ) ( ) ( )Hq n n n= w z
The weights here will be computed using LMS algorithm based on Minimum Squared Error 
(MSE) criterion [11]. The error signal  thus can be denoted as the difference between 
the equalized data symbol  and the desired signal , and is represented as 
( )e n
( )q n ( )d n
          (4.4) ( ) ( ) ( ) ( ) ( ) ( )He n d n q n d n n n= − = −w z
The cost function of adaptive algorithm known as the complex LMS algorithm is the norm 
of signal error. So, the cost function can be represented as follows 
  
2[ ( ) ( ) ] [ ( ) ]J d n q n e n= − = 2          (4.5) 
To find the minimum of the cost function we need to take a step in the opposite direction of 
. The gradient vector of the cost function by the weight vector is manipulated as 
follows 
w∂∂ /J
  
2
2
*
( )
( ) ( ) ( )
2 ( ) ( )
H
J e n
d n n n
n e n
∂ ∂=∂ ∂
∂= −∂
= −
w w
w z
w
z
         (4.6) 
Therefore, the weight vector updates equation of the dispreading equalizer at the (n+1)-th 
sample can be given by the following equation 
   
*
( 1) ( )
( ) 2 ( ) ( )
LMSJn n
n n e
μ
μ
∂+ = − ∂
= +
w w
w
w z n
            (4.7) 
where μ  is the step size. In equation (4.6), the desired signal in non-training or 
decision directed period of data transmission is not available and usually replaced by 
estimated value from slicer or convolutional decoder. In this report, the extrinsic information 
of information bits and parity bits from turbo decoder is used as the desired information 
estimate. 
( )d n
 
 11
  0* '
0
0 , 
( )
 , K
s S
s
s S
β =⎧= ⎨−∞ ≠⎩            (4.12) 
Now we can use , , and *0 ( )sα * ' ( )K sβ *( ', )s sγ  to compute all the forward metric  
and backward metric  of every state and every time as 
*
1( )l sα +
*( ')l sβ
       (4.13) ( )* * *1 '( ) max ( ', ) ( ')  , 0,1, , 'll s l ls s s s lσα γ α+ ∈= + = … K
−      (4.14) ( )
1
* * *
' 1( ') max ( ', ) ( )  , ', ' 1, ,0ll s l ls s s s l K Kσβ γ β+∈ += + = …
Finally, we have the LLR  as follows ( )lL u
  
{ }
{ }
* * *
1( ', )
* * *
1( ', )
( ) max ( ) ( ', ) ( ')
max ( ) ( ', ) ( ')
l
l
l l ls s
l l ls s
L u s s s s
s s s s
β γ α
β γ α
+
−
+∈
+∈
= +∑
− +∑
l+
+       (4.15) 
to estimate the coded bit by expression (4.8) and (4.9). The extrinsic information of each 
coded bit is calculated via the following 
           (4.16) ( ) ( ) ( )e l l c l a lL u L u L r L u= − −
The extrinsic information will be sent to other component decoder and used as a prior 
information. 
4-1-3-2、Turbo Decoder with signal mapper and de-mapper 
The turbo decoder used in this work is a variant of original turbo decoder [5] which only 
provides the extrinsic information of information bit. The block diagram of turbo decoder 
with two component MAP decoders is shown in fig. 4.2. The equalized signal  is 
de-mapped as estimate of coded vector  which consists of information bit signal 
 and parity bit signal . Note that in each component decoder, the extrinsic 
information of both information and parity bits is generated.  In the generic 
Max-log-MAP described above, the component decoder needs only extrinsic information 
from the other component decoder as the a priori information for next iteration. However 
the de-spreading equalizer needs reliable estimates of all transmitted bits to adaptively 
adjust the weight vector. Another major difference between the generic MAP decoder and 
the proposed MAP decoder is that the proposed MAP decoder uses the equalized signal 
( )q n
( )nx
( )i nx ( )p nx
 13
reliability factor defined as 
   
0
4 s
c
EL
N
=              (4.21) 
where sE  is the energy per symbol and  is the spectrum density of additive white 
Gaussian noise. 
0N
The log-likelihood ratio of information and the second parity bits from decoder 2 is 
denoted as and  which are defined as 2 ( )
iL n 22 ( )
pL n
  2
[ ( ) 1| ( )]( ) log
[ ( ) 0 | ( )]
i i
i
p x n nL n
p x n n
== =
x
x

          (4.22) 
  22
2
2
[ ( ) 1| ( )
( ) log
[ ( ) 0 | ( )
pp
p
]
]
p x n n
L n
p x n n
== =
x
x

          (4.23) 
2 ( )
iL n  is hard decision detected as the source information estimate  after several 
decoding iterations. The extrinsic information for information and parity bits generated 
from decoder 2 is denoted as  and respectively and are calculated as 
follows, 
( )u n
2 ( )
i
eL n 2 ( )
p
eL n
           (4.24) 2 2 2( ) ( ) ( ) ( )
i i
e aL n L n L n L x n= − − c i
c p            (4.25) 2 22 2( ) ( ) ( )
pp
eL n L n L x n= − 
where  is the a priori information of information bit in the second component 
decoder, and is the extrinsic information of information bit  from the first 
component decoder after interleaving. 
2 ( )aL n
1( )
i
eL n
When adaptive equalizer is operating in decision directed mode, it will need reliable 
desired signal estimate to operate. In order to reduce error propagation, we feedback the 
extrinsic information for information bit  and parity bit  and  to 
the equalizer to generate  which will be used as the desired signal estimated for the 
de-spreading equalizer. The extrinsic information of information bit and parity bit from 
2 ( )
i
eL n 1( )
p
eL n 2 ( )
p
eL n
( )d n
 15
without sending extrinsic information to the equalizer. This architecture has the drawback 
that information embedded in the signal is not fully utilized. 
 
4-1-4-2、Adaptive Equalizer Jointed with Turbo Decoder 
 
Fig. 4.4 Equalizer with jointed turbo decoder for OFDM-CDMA system 
Fig. 4.4 shows the block diagram of adaptive equalizer jointed with turbo decoder. In 
this proposed architecture, the de-spreading equalizer relies on the extrinsic information 
from the turbo decoder used as the estimated desired information to generate the error 
signal and adaptively adjust its weight vector. The turbo decoder will iteratively decode 
the equalized and de-mapped signal by passing extrinsic information between component 
decoders and the dispreading equalizer. This architecture has the advantage that 
information embedded in the signal is explored in the turbo decoder and utilized in 
de-spreading equalizer. 
 
4-2、The research method in the second year 
4-2-1、Non-Coherent Adaptive Turbo Equalizer of OFDM-CDMA system 
Non-coherent turbo receiver with SOVA turbo decoding was proposed in [15] where 
perfect decision feedback was implicitly assumed. If error propagation is considered in the 
feedback loop, there will be no such advantages using multiple decision feedback. The 
receiver structure of non-coherent OFDM-CDMA system is shown in Fig. 4.5. The 
transmitted signal is differentially encoded using 4π -QPSK modulation in the 
transmitter. In the proposed receiver shown in Fig. 4.5, the receiver generate the estimated 
symbol  which is defined as ˆ( )d n
    ,          (4-28) *ˆ( ) ( ) ( 1)d n q n q n= −
 17
 
4-2-3、Hardware Implementation 
In the hardware implementation of the adaptive turbo equalizer for turbo coded 
OFDM-CDMA communications systems, the methodologies used in [16] is adopted. Fig. 
4.6 is the block diagram of the adaptive turbo receiver. That contains an I/O part, a main 
controller part, a memory part, and two modules of de-spreading equalizer and 
Max-Log-MAP based turbo decoder. The I/O part will synchronize with the outside 
test-bench block to carry signal in and out. The main controller part will coordinate all part 
to work. The memory part is in charge of recording every data in work. De-spreading 
equalizer module and turbo decoder module are the principal part to structure the adaptive 
turbo receiver. 
 
Fig. 4.6 Adaptive turbo receiver block diagram 
 
4-2-4、Implementation of De-spreading Equalizer 
Fig. 4.7 is the schematic diagram of de-spreading equalizer. The adopted LMS algorithm 
has been introduced in Section 4.1.2.  
 
Fig. 4.7 The circuit of de-spreading equalizer 
 19
)),'(max(),'(),'(' 111 kkkkkk SSSSSS −−− −= ααα  
)),'(max(),'(),'(' 111 kkkkkk SSSSSS −−− −= βββ  
where α and β is the branch metric values, and 'α  and 'β  are the normalized values by 
maximum values of  or . ' 1max{ ( , )}k kS Sα − ' 1max ,kS S−{ (β )}k
 
Fig. 4.9 Structure of the branch and state metric units 
 
 21
  
Fig. 4.11 The circuit diagram of Max-Log-MAP decoder 
 
4-2-6、Implementation of Turbo Decoder 
The block diagram of turbo decoder with two component MAP decoders is shown in Fig. 
4.2. And we have discussed how to work in Turbo Decoder in section 4.1. The implemented 
turbo decoder is shown in Fig. 4.12. 
 
 
 
Fig. 4.12 The circuit diagram of turbo decoder 
 
 23
 
 
1 2 3 4 5 6
1E-6
1E-5
1E-4
1E-3
0.01
0.1
7
Active user = 30
Active user = 15
Active user = 5
 1 iteration
 2 iteration
 5 iteration
Coherent
Disjoint
MaxLogMap
Fixed Step-Size
Channel: JTCOUHA
Spreading code: PN
Frame length: 1024
nTrain = 512
B
E
R
Eb/No (dB)  
Fig. 5.1 BER of adaptive equalizer disjointed with turbo decoding with 5, 15, and 30 
active users in JTC outdoor A channel 
 
 
1 2 3 4 5 6
1E-6
1E-5
1E-4
1E-3
0.01
0.1
7
Coherent
Disjointed
Fixed Step-Size
Channel: JTCOUHC
Spreading code: PN
Frame length: 256
nTrain = 512
Active users: 10
 1 iteration   LogMap
 2 iterations LogMap
 5 iterations LogMap
 1 iteration   MaxLogMap
 2 iterations MaxLogMap
 5 iterations MaxLogMap
B
E
R
Eb/No (dB)  
Fig. 5.2 BER of adaptive equalizer disjointed with turbo decoding with 10 active users in 
JTC outdoor C channel 
 25
 
 
1 2 3 4 5 6 7 8 9
1E-6
1E-5
1E-4
1E-3
0.01
0.1
10
 1 iteration
 2 iteration
 5 iteration
NoncoherentCoherent
Disjoint
MaxLogMap
Fixed Step-Size
Channel: JTCOUHA
Spreading code: PN
Frame length: 1024
nTrain = 512
Active users: 5
B
E
R
Eb/No (dB)  
Fig. 5.5 BER comparison of coherent and non-coherent adaptive receiver with jointed 
turbo decoding in JTC outdoor channel A model 
 
 
1 2 3 4 5 6 7 8 9
1E-6
1E-5
1E-4
1E-3
0.01
0.1
10
 1 iteration
 2 iteration
 5 iteration
NoncoherentCoherent
Disjoint
MaxLogMap
Fixed Step-Size
Channel: JTCOUHC
Spreading code: PN
Frame length: 1024
nTrain = 512
Active users: 5
BE
R
Eb/No (dB)  
Fig. 5.6 BER comparison of coherent and non-coherent adaptive receiver with jointed 
turbo decoding in JTC outdoor channel C model 
 
 27
 
Fig. 5.7 BER of de-spreading equalizer without turbo decoder 
 
 
 
Fig. 5.8 Simulation of de-spreading equalizer without turbo decoder 
 
(2) Implementation Results of Adaptive Equalizer Disjointed with Turbo Decoder 
 
Since the de-spreading equalizer woks correctly, we can incorporate the equalizer with turbo 
decoder. At first, we simply cascade the turbo decoder behind the equalizer without providing 
the extrinsic information as the desire signal to the adaptive equalizer. Fig. 5.9 shows the BER 
 29
 
(3) Implementation Results of Adaptive Equalizer Jointed with Turbo Decoder 
 
Now we use the extrinsic information from turbo decoder as the desired signal of de-spreading 
equalizer. Fig. 5.11 shows the BER of Adaptive Equalizer Jointed with Turbo Decoder by 
MATLAB and ModelSim. The stimulation results still are very close so that the hardware should 
be functional and useful. Fig. 5.12 is the simulation snapshot of equalizer jointed with turbo 
decoder by ModelSim. The input signals and data include the data after the FFT operation, 
interleaver codes, and the generation matrix. The output signals are the data generated by the 
adaptive equalizer jointed with turbo decoder. 
 
Fig. 5.11 BER of adaptive equalizer jointed with turbo decoder 
 
Fig. 5.12 ModelSim simulation of de-spreading equalizer jointed with turbo decoder 
 31
 33
6、Conclusions  
In this research, several de-spreading equalizer schemes with Max-Log-MAP turbo 
decoding algorithm have been presented and verified with computer simulations. When the 
equalizer is jointed with turbo decoder, the equalizer has more reliable reference from the 
turbo decoder to adaptively adjust the weight vector and can effectively cancel the ISI and 
MAI. In most scenarios, the conventional equalizer disjointed with turbo decoding performs 
about 0.5 dB worse than the equalizer jointed with turbo decoding at fifth iteration. However, 
utilizing the extrinsic information from turbo decoder to dynamically adjust the stepsize of 
adaptive equalizer, the varying step size receiver can have additional 0.5dB gain. The 
Max-Log-MAP algorithm is implemented in the MAP decoder to reduce the system 
complexity. In order to further reduce complexity, the soft extrinsic information from turbo 
decoder is hard decided and mapped as the reliable reference signal for the de-spreading 
equalizer. Finally, we have implemented the design of the adaptive turbo receiver by Verilog 
HDL, and simulated by ModelSim. The simulation results of MATLAB and ModelSim are 
in accordance and show the effectiveness of the proposed equalizer jointed with turbo 
decoder architecture. 
 
表 Y04 
報告內容包括下列各項： 
一、參加會議經過 
 
9 月 12 日 — 下午 14 點 50 分從桃園國際機場出發，於下午 19:10 到達東京。 
9 月 13 日 — 上午參加大會 Conference Opening。9:00~17:30 參加 Workshop，共
有三個 Workshop，主題分別為第一場 Wireless Distributed Networks，第二場主題
為 Inter-Mac Management and Multiple interfaces for Multi-Gigabit Wireless Systems 
及第三場 Wireless Super Broadband Systems-IEEE 802.15.3c Standardization 。 
9 月 14 日 — 上午 08:30 參加 Keynote Speech，題目為 The Wireless Revolution。
10:40 接著參加 Technical Session：PHY Design for Cognitive Radio Networks 。14:10
接著參加 Technical Session：Space-Time Coding。16:30 接著參加 Technical Session：
PHY Design for Broadband Access。 
9 月 15 日 — 上午 08:30 參加 Keynote Speech，題目為 Towards the Future Internet-
Research Activities in Europe。09:20 接著參加 Technical Session：MIMO Channels 。
10:40 接著參加 Technical Session：Modulation and Coding。14:10 接著參加 Technical 
Session：OFDM Systems I。16:30 接著參加 Technical Session：Estimation and 
Detection Algorithms。 
9 月 16 日 — 上午 08:30 參加 Keynote Speech，題目為 Emerging Wireless 
Technologies and the Future Internet。10:40 接著參加 Technical Session：MAC Design 
for Wireless Broadband Access 5 。14:10 接著參加 Technical Session：PHY Design for 
Cooperative Communications 2。下午 16:30 參加 Technical Session，並在此 Session
發表此次受貴會補助之論文「Optimal Step-Size Mechanism for Stochastic Gradient 
Algorithm Applied to CDMA Receiver in Multipath Fading Channels」。 
9 月 17 日 — 下午 14 點 15 分搭機，大約於 17:00 回到台灣。 
 
Optimal Step-Size Mechanism for Stochastic
Gradient Algorithm Applied to CDMA Receiver in
Multipath Fading Channels
Fang-Biau Ueng, Jui-Chi Chang, Hsuan-Fu Wang and Ming-Chang Chen
Department of Electrical Engineering, National Chung-Hsing University, Taichung, Taiwan
Abstract— This paper investigates the optimal step-size mech-
anism for a stochastic gradient (SG) based direct sequence
(DS-) code division multiple access (CDMA) receiver under the
influence of the multiple access interference (MAI) and inter-
symbol interference (ISI) in multi-path environments by utilizing
a simple stochastic model. The convergence of the derived optimal
step-size sequence is verified analytically. The learning curve
is applied to analyze and compare the speed of convergence
and residual mean-squared error (MSE) for the fixed and time-
varying step-size sequence methodologies. Simulations show that
the receiver utilizes the derived optimal step-size sequence not
only has faster convergent speed and smaller MSE, but also is
robustly to different multi-path channels.
I. INTRODUCTION
1The CDMA is amongst the most promising multiplexing
technologies for current and future communication systems.
It offers advantage over other multiple access methods like
frequency-division multiple-access (FDMA) and time-division
multiple-access (TDMA) in terms of multi-path resistance,
inherent frequency diversity, interference rejection, and the
potential utilization of advanced receiver technologies [1].
However, the capacity and performance of DS-CDMA system
are mainly limited by multiple access interference (MAI) and
inter-symbol interference (ISI). To mitigate MAI and ISI,
optimal and sub-optimal algorithms for single-user detection
(SUD) and multi-user detection (MUD) have been proposed
[2]. The excellent performance for suppressing MAI is the
advantage of the optimal MUD method, but its exponentially
computational complexity causes the difficulty of implemen-
tation for real applications [3]. The conventional SUD method
processes the received signal by a bank of the matched filters
attached in a Rake configuration, the disadvantage is the sys-
tem capacity is limited due to some cross correlations among
signals might still have high value result from difference path
delays even under well power control [3].
Utilizing stochastic gradient (SG) algorithms to implement
SUD or MUD has many benefits over the aforementioned
methods: not only received signal despread, interference re-
jection, and coherently combining multi-path signal are per-
formed, but also the near-far resistance is provided. Hence,
the power control requirements is less stringent. Furthermore,
their adaptive character makes it possible not only to deal with
1This work was supported in part by the National Science Council of
Taiwan under Contract NSC97-2221-E-005-006-MY2.
problems due to time-varying channel characteristics and the
change of a number of active users, but also achieving practi-
cable bit error rates (BER) performance and increasing system
capacity. The performance and stability, i.e., convergence and
steady steady-state behavior of a SG algorithm used within
a CDMA receiver are of great interest both in practice and
in theory since it determines the number of training symbols
required and the multi-path fading rate that can be handled
successfully. The performance of a SG method based CDMA
receiver is strongly dependent on the choice of the step-size
[4]-[5]. The use of fixed step-size (FSS) with standard SG
algorithms are not efficient with respect to convergence and
steady-state performance. The use of averaging methods (AV)
or adaptive step-size (ASS) mechanisms based SG algorithms
in previous works have shown improvement in performance
[6]-[7]. However, an additional number of computations is
required and the effect of multi-path distortion is neglected
in the derivation of the algorithm [7]. In reality, the muti-path
distortion should not be omitted when the high data rate is
required for information transmission.
This paper utilizes a simple stochastic model to model
the received random input signal vector to investigate the
optimal step-size mechanism for a symbol-rate adaptive DS-
CDMA receiver under the influence not only MAI, but also
ISI. The computational complexity of the symbol-rate adaptive
receiver is lower than that of the conventional chip-decision
methods due to the filter weights is updated only once in every
symbol interval. Hence, not only despread operation and MAI
elimination, but also channel equalization is performed by the
receiver.
This paper is organized as follows. Section II describes the
DS-CDMA system model. Section III introduces the update al-
gorithm. Section IV presents the analysis for optimal step-size
mechanism. The approximate optimal step-size sequence is
also derived in this section. Section V illustrates and discusses
the simulation results. Section VI draws the conclusions.
II. SYSTEM MODEL
Considering a synchronous K-user DS-CDMA communi-
cation system is depicted in Fig. 1 [2]. The kth user trans-
mits a data symbol sequence s(k) =
k
s
(k)
1 , s
(k)
2 , ..., s
(k)
J
lT
consisting of J elements at symbols interval Ts, where [·]T
denotes the vector or matrix transpose. Each data symbol of
tr[RA] = Nσ2x and
NS
n=1
pA [n] = 1 and Pr (X) is
the probability of X .
The accuracy of the i.i.d. assumption in A1) is investigated
in [9]. The arguments in [9] assume that the regression data are
generated by feeding a binary i.i.d. sequence {a (i)} through
an FIR filter of length P , i.e.,
r (i) =
P[
k=1
b (k)a (i− k) (12)
where {b (k)} indicates the impulse response sequence of the
filter. This model is adequate, for example, the {b (k)} denotes
the channel impulse response in the case of equalization
applications with binaryphased shift keying (BPSK) in multi-
path channel. With this model, the results in [9] show that for
tapped-delay-line implementations with such regression data,
using the i.i.d. assumption is a good approximation for the real
performance of the adaptive LMS/NLMS filter. This result was
later strengthened in [10]. In [10], {a (i)} is not restricted to
binary but could be any i.i.d. sequence. The simplified model
for the input signal vector z(n) in assumption A3) uses a
simplified distribution for the input signal vector by using
reduced and countable angular orientations for the excitation,
which is consistent with the first and second order statistics
of the input signal vector [11]-[12].
B. The Analysis of The Optimal Step-Size Mechanism
Based on the aforementioned assumptions, the desired re-
sponse s [n] and the error e [n] are given as
s [n] =
[z [n]−UT [n]wo]T c
M
+ o [n] , (13)
and
e [n] = −w
T [n]U [n] c
M
+ o [n] . (14)
According to Assumption 2, the learning curve J [n], i.e., the
expectation with respect to norm square of (14), is expressed
as
J [n] = E[wT [n]
U [n] c
M
cTUT [n]
M
w [n]] + ηo. (15)
Taking the trace of the expectation in (15), then interchanging
the operations of the expectation and trace yields
J [n] = tr

hTCov [w [n]]h

+ ηo, (16)
where h /U[n−1]cM . Substituting (14) into (7) and defining the
weight error vector w [n] as wo −w [n] (wo is the ideal tap-
weight vector of the transversal filter), then w [n] is given as
w [n] = [I− μ hh
T
nhn2
]w [n− 1]− μ
o [n− 1]hT
nhn2
. (17)
Based on Assumptions 2 and 3, i.e., the variance of the
o [n− 1] is equal to ηo and
U[n−1]cM

2
= tr
k
E
k
hhT
ll
=
tr[R] ∼ τ2 [n− 1], the covariance of the weight error vector
w [n] is given as
cov [w [n]] = E{[I− μhh
T
hTh
]Cov [w [n− 1]] [I− μhh
T
hTh
]}
+ μ2ηo R
tr [R]
E[
1
τ2 [n− 1] ]. (18)
Applying the Assumption 1, the diagonal elements of the
transformed covariance matrix XT cov [w [n]]X is given as
λi [n] =
λi
tr [R]
(1− μ)2λi [n− 1] + λi [n− 1]
N[
j=1, j 9=i
λj
tr [R]
+
μ2ηo
tr [R]
E[
1
τ2 [n− 1] ]. (19)
From (19), it is clear that the optimal step-size sequence
depends on the eigenvalue distribution of R. Using a time
varying step-size μ [n] to replace the step-size μ in (19); hence,
the λi [n] for the time varying step-size case is
λi [n] = [1 +
−2μ [n] + μ [n]2
N
]λi [n− 1] +
μ [n]2 ηo
N tr [R]
. (20)
Differentiating (20) with respect to μ [n] and set the result
equal to zero, the first order condition of λi [n] is obtained
λi [n− 1] = μ [n] (λi [n− 1] +
ηo
tr [R]
), (21)
where the μ [n] is given as
μ [n] = λi [n− 1]
λi [n− 1] + ξ
o
tr[R]
. (22)
Substituting (22) and (21) into (20), the λi [n] can be simplified
as the following recursive equation
λi [n] = [1−
μ [n]
N
]λi [n− 1] . (23)
Applying (23) to replace the λi [n− 1] in (22) and recursive
rearrangement (22), the infinite product equation for calculat-
ing the optimum step-size sequence μ [n] is obtained as
μ [n] = μ [0]
k−1\
n=0
1− μ[n]N
1− (μ[n])
2
N
. (24)
Initially, cov(w [n]) and J [n] are dominated by the mean of
w [n]; hence, a large step-size is required to reduce this mean
as fast as possible for increasing the convergence speed. On the
other hand, when the algorithm approaches the convergence,
the step-size should be scaled down to diminish the variance
of w [n], i.e., reduce the steady-state MSE. The μ [n] in (24)
meets aforementioned two criteria if μ [0] ∈ (0, 1). Use the
recursive rearrangement and binomial series expansion to (24),
the approximation of the optimized step-size sequence μ [n] is
given as
s(1)
s(2)
s(K)
c(1)
c(2)
h(1)
h(2)
c(K) h(K)
n
Adaptive
Filter 1
M
m=
∑
Despreader
c
Adaptive
Algorithm +
-
- +
User-specified 
spreading 
code
z
( )k
s
Desired 
signal
Fig. 1. The multi-user DS-CDMA system model.
0 100 200 300 400 500
-20
-18
-16
-14
-12
-10
-8
 μ = 1
 μ = 0.1
 μ[0] = 0.9
  ζ = 2
 ζ = 2
μ[0] = 0.9
μ = 0.1
μ = 1
ITU Vehicular A Channel 
OVSF Code
K = 16
S1R = 17.5dB
M
ea
n-
Sq
ua
re
 E
rr
or
(d
B
)
1umber of Iteration, n
Fig. 2. MSE performance for the fixed, optimal and approximated step-size
mechanisms in ITU Veihicular A channel.
0 100 200 300 400 500
-20
-18
-16
-14
-12
-10
-8
 μ = 1
 μ = 0.1
 μ[0] = 0.9
  ζ = 2
 ζ = 2
μ[0] = 0.9
μ = 0.1
μ = 1
ITU Pedestrian B Channel 
OVSF Code
K = 16
S1R = 17.5dB
M
ea
n-
Sq
ua
re
 E
rr
or
(d
B
)
1umber of Iteration, n
Fig. 3. MSE performance for the fixed, optimal and approximated step-size
mechanisms in ITU Pedestrian B channel.
國科會補助專題研究計畫成果報告自評表 
請就研究內容與原計畫相符程度、達成預期目標情況、研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）、是否適
合在學術期刊發表或申請專利、主要發現或其他有關價值等，作一綜合評估。
1. 請就研究內容與原計畫相符程度、達成預期目標情況作一綜合評估 
■達成目標 
□未達成目標（請說明，以 100字為限） 
□實驗失敗 
□因故實驗中斷 
□其他原因 
說明： 
2. 研究成果在學術期刊發表或申請專利等情形： 
論文：□已發表 □未發表之文稿 ■撰寫中 □無 
專利：□已獲得 ■申請中 □無 
技轉：□已技轉 □洽談中 ■無 
其他：（以 100字為限） 
3. 請依學術成就、技術創新、社會影響等方面，評估研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）（以
500字為限） 
在無線通訊中，正交分頻多工分碼多重進接通訊與通道編碼渦輪解碼器之結合為相當重要
的課題，低複雜度的非同調接收機更是工業界相當需要的技術。而在此無線通訊環境下，
系統的效能與複雜度相當的重要，本研究提出數種接收機架構：即等化器與渦輪解碼器獨
立運作的架構與等化器和渦輪解碼器聯合運作的架構。這幾種接收機的等化器權重是每個
訊符更新一次，此項設計有效地降低演算法運算上的複雜性。另外，又將所設計的接收機
推至非同調正交分頻多工分碼多重進接通訊系統，並利用渦輪解碼器所產出的外部資訊設
計出變化步階的適應性等化器。利用渦輪解碼器所產出的外部資訊調節適應性等化器的步
階，能有效降低錯誤的傳播，大幅提升系統效能。本研究成果頗具應用與學術價值。研究
成果可同時提供給學術界與工程界。在此計畫中，參與的研究生可學習到非同調 OFDM-CDMA 
系統、通道編碼、可調式接收機設計、可調式濾波器理論、偵測與預估及 FPGA 實務等多
方面的知識，對於他們的興趣、能力及未來投入通訊工業等都會有正面的影響 
