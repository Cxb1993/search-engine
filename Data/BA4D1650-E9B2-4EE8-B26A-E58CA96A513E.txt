 3
靈敏度。 
前饋控制法：此方式必須藉磁滯模型為基礎再進
行補償控制，通常設計方式有利用磁滯模型設計一與
其曲線相反的反磁滯模型，再將兩磁滯互相抵消的方
式達到目的反向磁滯驅動輸入[5,6]；另外還有應用磁
滯非線性模型置於壓電致動器輸入端，將所得到的磁
滯位移與理想位移作比較，再利用控制器補償其誤差
量[7]。 
迴授控制方式：Chen 等[8]將磁滯視為外部干
擾，設計強健控制器來做軌跡追蹤控制補償，其補償
效果良好。Hsu[9]設計提出一個強健輸出回授控制
器，使壓電能帶動探針於高取樣速率下取得物體表面
形貌。Stemmer[10,11]等人針對壓電致動器設計 ∞H
控制器，進一步將其模型套用至原子力顯微鏡之壓電
掃描器上，改善原子力顯微鏡掃描器的掃描速度。陳
保元[12]設計疊代式學習控制器控制，針對壓電平台
作定位控制，其系統可透過多次疊代學習，消除重複
性的干擾。陳俊生[13]提出一個新的磁滯近似模型，
以史密斯預測器為基礎設計強健性 ∞H 控制器，應用
於壓電致動器的磁滯補償。有鑒於一般磁滯模型建立
的複雜性與應用不易，林得耀[14]提出一種簡單的磁
滯模型建立方式，並在開迴路下設計前饋控制作補
償。鄭智豪[15]針對重複性和非重複性的干擾，設計
學習控制器和估測器應用於微定位平台上。 
(ii) 摩擦力模型 
古典摩擦力模型(靜摩擦+動摩擦模型)，最早是由
達文西(Leonardo da Vinci)所提出，他也描述了許多摩
擦力的性質，但隨著量測技術的進步，發現有許多摩
擦力造成的現象，是古典摩擦力模型所無法掌握的，
因此有許多的學者提出一些能夠更符合實際摩擦現
象的摩擦力模型[16]，而在文獻[17]中則對過去有關
的摩擦力研究，包括摩擦現象的解釋，摩擦力模型，
及摩擦力的補償等做了詳細的調查。在摩擦力補償方
面則分為model-based 的補償及non-model-based 的
補償。 
所謂model-based 的補償就是利用摩擦力模型計
算摩擦力進行補償。Canudas de Wit 等提出一動態摩
擦力模型來描述摩擦行為，並據以建立估測器來對摩
擦力進行補償。文獻[19]使用類神經網路透過學習過
程來鑑別摩擦力進行補償。文獻[20]使用模糊控制器
來推論摩擦力的大小，並透過基因演算法則來調整模
糊控制器的參數，然後以前饋的方式來補償摩擦力造
成的影響。文獻[18]使用適應性控制(Adaptive Control) 
線上鑑別摩擦力模型之參數、估算摩擦力進行補償。 
所謂non-model-based 的補償就是不使用摩擦力
模型，而將摩擦力的影響視為干擾(disturbance)，利
用回授控制的方法將干擾消除，或是直接使用擾動訊
號克服摩擦的非線性現象。例如工業界廣泛使用PID 
消除摩擦力干擾。文獻 [21,22]提出干擾觀測器
(disturbance observer)，將摩擦力、負載擾動及系統不
確定性等視為干擾，然後用以干擾觀測器進行估測補
償。而當受控體是在做一些重複性的工作時，其遭遇
的干擾是週期性的，因此有些學者[23]針對這樣的系
統提出了重複性控制(repetitive control)，經由幾個週
期的學習便可以有效的抑制摩擦力的影響。 
三、研究主題及內容  
(i) 非線性微觀動態摩擦力模型 
真實摩擦行為遠比古典的靜態摩擦力模型所描
述的還複雜很多，因此有許多的學者提出能夠描述這
些現象的數學模型，首先從最早的動態摩擦力模型 
Dahl’s Model，來說明摩擦力模型對系統之為行表
現，再由  Canudas de Wit等人在1995年對Dahl’s 
model做一修改後所提出之LuGre Model模型做一說
明，最後討探由Swevers等人 [24]在2002對LuGre 
Model做一修改，並提出了完整的Leuven Model，而
此模型也是目前最完整，最能表達非線性微觀動態摩
擦力之模型，其可完整描述系統在滑動、預滑動、黏
彈效應等非線性行為。 
(ii) LuGre Model： 
LuGre Model是由Dahl’s Model再修改而來，主要
是由於Dahl’s Model 雖然可以表現出預滑動之位移
現象及庫倫摩擦力，但其模型中並沒有包含史崔派克
效應，因此 Canudas de Wit 便提出了一個動態摩擦
力模型為LuGre Model，其最主要之貢獻便是此模
 5
因此可以決定是否讓摩擦力加入系統，再進而觀察摩
擦力對系統之影響。其有與基準面接觸之等效示意圖
如同圖 2-1 所示。 
 
圖 1 壓電精密定位平台 
由方程式(5)中可以發現有一磁滯項 hF ，此磁滯
項便是決定系統在預滑動之前的運動行為，在此將利
用 Bouc-Wen Model 來替代此磁滯項，因此 hF 可以
改寫為式(3-8)。  
hhh FzFzzF &&&& γβα −−=           (5)  
最後再將式代入式(3)、(4)式之中，便成為了一完整
的 Lueven Model。然而平台是藉由壓電致動器驅動，
因此假設在其連接部分存在一等效剛性 pk 與等效阻
尼 pc ，所以由平台之等效示意圖可得知，此系統之
運動方程式為： 
fInputpp FFxkxcxm −=++ &&&         (6) 
其中 fF 即為利用 Lueven Model 所求得之摩擦力動
態行為。 
因此由式(1)至(6)可得其狀態方程式： 
設狀態變數 ThFzxxtx ][)(~ && =  
)(~)(
),,,()(~)(
~
txCty
FzxtButxA
dt
txd
h
=
+=&
           
可得系統之狀態方程式為： 
⎥⎥
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢⎢
⎢
⎣
⎡
−++−−=
000
0010
10)(1
0010
21
α
σσpp cmm
k
A   (7) 
]1101[
1000
0100
0010
0000
=
⎥⎥
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢⎢
⎢
⎣
⎡
=
C
mB
  (8) 
[ ]0=D  
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎦
⎤
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎣
⎡
⎟⎟⎠
⎞
⎜⎜⎝
⎛ −−⎟⎟⎠
⎞
⎜⎜⎝
⎛
−−−
−
+−
=
n
h
hh
n
h
n
h
n
h
n
h
h
xs
FxFF
xs
Fx
xs
Fx
xs
Fx
xs
FxFF
u
)(
1
)(
1
)(
)(
)(
0
111
1
&&&&&&
&
&&
γβα
σ
得到系統之狀態方程式(7)、(8)後，便可使用MATLAB
來進行系統之模擬。模擬之初始條件為 0)0( =v 與
0)0( =z 。 
利用正弦波來觀察系統在不同區間之情形，也是
藉由輸入不同大小波形，進而了解系統之反應情形。
一開始先輸入一大小為 1N、100Hz 之正弦波可得知
系統在預滑動之行為如圖 2 所示。 
Capacitance 
measurement sensor 
Stage body 
Piezoelectric 
 7
在預滑動的範圍內時，其行為模式是一相位超前之
系統表現，在此將再重新模擬 Lueven Model，並把
最大靜摩擦力改為 3(N)，藉以突顯此一現象(如圖 5
所示)，由圖中可得知在微觀動態下系統之預滑動範
圍，其運動位移從零至數微米左右，所以預滑動之
特性便決定了系統之控制精度，在此本計畫中所設
計之微致動平台，對於其在預滑動時之特性表現，
主要是將其視為外界之干擾效應，進而產生作用於
預滑動範圍的不穩定相位超前表現。 
-2 -1.5 -1 -0.5 0 0.5 1 1.5 2
x 10-7
-3
-2
-1
0
1
2
3
 Displancement (m)
Fr
ic
tio
n 
Fo
rc
e
Phase Lead
Linear
 
        圖 6 摩擦力與位移之局部放大圖 
(IV)控制命令之分析： 
經由上述之分析我們已得知微定位系統所受之
外界干擾為何，但是若欲控制此系統，則須對整體系
統 進 行 分 析 ， 首 先 由 方 程 式  : 
fInputpp FFxkxcxm −=++ &&&           
由上式可得知系統之摩擦力會與輸入相減，因此
預期摩擦力之相位超前效應，應該會變成系統輸入之
相位落後，並藉由系統模擬來證實，其中 fF 為Lueven 
Model 所得之摩擦力，且輸入為一 10Hz 大小為 10N
之正弦波，其輸出之位移如圖 6 之藍色線段所示，可
得知系統之位移確實呈現相位落後效應。而系統將變
成含有一不穩定之相位落後輸入，因此本研究計畫便
可 以 把 系 統 之 模 形 改 寫 成 ： swTesG )(0 )(
− 。              
(9) 
其中 0G 為系統之正規化模型，並用一指數項來
表示系統之落後時間，而系統之落後時間 T 會與系統
之頻率w有關，此即為摩擦系統之中的 Frictional Lag
效應，同時摩擦力會使系統之輸入量減小，且因史崔
派克效應與庫倫摩擦力之影響，系統之摩擦力會隨操
作速度而改變，因此便加入可變比例增益項
1)(0 << vk ，再將上式(9)修改成： 
swTevksGsG )(0 )()()(
−=          (10) 
系統輸入之力為壓電致動器所產生，並已知壓電
致動器所產生之力與電壓關系為： 
l
tVAdEF PPinput
)(
11=               (11) 
其中 PE , 11d , pA 和 l 分別是壓電之楊氏系數、壓電
常數、壓電截面積、壓電長度，而 V(t)則是輸入之電
壓值，因此(11)式為一線性方程式，並由該式得知系
統之輸出力只隨輸入電壓所變化，且其它系數皆為常
數項，因此可得知系統之電壓與位移之關系式可利用
二階微分方程式來表示之，在此藉用實驗來求得系統
之真實轉移函數，實驗設備如圖 1 所示，利用
NI-6024E 之類比輸出入功能，對系統輸入大小為 1
之步階函數，再利用電容式位移器收集系統之位移資
料，重覆 10 次實驗結果再求其平均值。 
0 0.002 0.004 0.006 0.008 0.01 0.012 0.014 0.016 0.018 0.02
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Time (sec.)
D
is
pl
ac
em
en
t (
um
)
Real System Step Responce
Approximate Model Step Responce
 
圖 7 系統與近似模型(10 式)之步階響應圖 
所求得之系統參數如下式所示： 
 9
Control)，其特色為利用強健性控制系統，來確保當
系統有不確定性之非結構擾動，同時有外在干擾的情
況之下的仍具有強健的穩定性，而疊代式學習控制系
統的部份，則是用來消除系統的重覆性誤差，進而提
昇系統之追跡能力。並找出適合權重函數來分別滿足
其不確定性函數與靈敏度效能函數，其中不確定性函
數採定乘積性不確定度 GIG m )(
~ Δ+= 。 
其中G~ 為不確定度模型，並用 mW 來取代系統之
不確定性函數( mΔ )，必須滿足 ω∀< ,1mmTW ，靈敏
度 效 能 函 數 則 引 進 一 sW ， 並 使 其 滿 足
ω∀< ,1SWs (Tm 為互補靈敏度函數，S 為靈敏度函
數)，選定適當的權重函數 321 、W、WW 之後，再藉由
MATLAB 之 μ-Analysis and Synthesis Toolbox 來求
出適當之控制器 K，最後將所設計之權重函數代入
MATLAB 後 ， 利 用 其 功 能 解 出 二 個 Riccati 
equations，即可求得系統之 ∞H 控制器 )(sD  : 
2222221
318415512677
2424222
31941651268
1049.910593.910041.1
10301.310618.210015.110345.3
1086.510889.510824.2
10174.410643.210131.810325.3
×+×+×+
×+×+×+×+
×+×+×+
×+×+×+×
=
ss
sssss
ss
ssss
TF
  進而將求的系統之強健性控制器與 PD-Type 疊代
式學習控制器相結合，最後利用 SIMULINK 來做最
後之實現，由圖 11 所示可得知系統之干擾約為命令
的 20%，經過控制後可降至原來的 1/20 以下，並系
統經過學習之後，其輸出之誤差即可降至命令之
0.1%以下，由圖可得知控制器能有效的解決，系統在
有外界干擾及系統有不確定性之情況等問題，預期此
控制器將可以運用在各種精密運動的機械系統之上。 
0 0.05 0.1 0.15 0.2 0.25 0.3
-2
-1.5
-1
-0.5
0
0.5
1
1.5
2
Time (sec)
Am
pl
itu
de
 (u
m
)
Output
Command
 
圖 10 系統在 100Hz 限定頻寬之系統輸出 
 
圖  11 輸入 20%干擾雜訊之系統輸出位移表現 
(b) 可變結構系統系統控制設計 : 
在此之前由於我們的系統是進行一追蹤控制，因
此定義系統之誤差函數為： 
dxxe −=                          
則： )()()( nd
nn xxe −=  
並假設我們的系統為： utxbtxfx ),(),( +=&&  並
已知 ),(),(),( maxmin txftxftxf ≤≤ 、
),(),(),(0 maxmin txbtxbtxb ≤≤< ，且 ),( txf 與
),( txb 皆無法完全已知，然而假設其估測值為 fˆ ，
而 fff Δ+= ˆ ，並滿足： Ftxff ≤− ),(ˆ 因此：
),( txFf ≤Δ                          
其中 fΔ 為 f 的變動量可知其必須為一有界之函
數，且 ),( txF 為系統未確定量的邊界值。 
至於控制器之輸入，其表現也是一動態非線性行
為，在此選用一正規化之幾何平均值 bˆ，並滿足下列
之條件式： 2
1
maxmin )(ˆ bbb =   
 11
數，因此系統之各狀態變數必需皆可量測與得知，設
其有受到外界干擾與觀測雜訊之影響，同時系統只有
位置訊號可量測得知(但仍受到觀測雜訊之影響)，因
此系統將無法準確的得知各狀態變數大小，故此本計
畫便加上了一適應性卡門估測器來針對此一問題，適
應性卡門估測器能有效藉由系統之正規化模型，加上
對系統之誤差進行線上調控與學習，以求能達到最接
近之各狀態變數輸出，其與可變結構控制器結合之方
塊圖如圖12所示。 
 
圖 12 可變結構控制器結合適應性卡門估測器之方
塊圖 
利用MATLAB來建立一適應性卡門估測器，完
成後藉由輸入2 mμ 之正弦波，並加上大小為3 mμ 之
外界之干擾與觀測雜訊，其系統之輸出結果如圖13
所示，並且除了能測得系統之真實位置外，也能估算
出系統之其它狀態變數大小。 
0 10 20 30 40 50 60 70 80 90 100
-5
-4
-3
-2
-1
0
1
2
3
4
5
Data Numbers
D
is
pl
ac
em
en
t (
um
)
true response
measured response
filtered response
 
圖 13 真實位移、量測位移與適應性卡門估測器之輸
出位移 
藉由MATLAB之系統模擬功能，模擬系統未利
用控制器補償時其位移與速度之相平面圖，由此圖中
更能確定系統是非線性時變系統，並藉由可變結構控
制器進行控制後，得到系統之輸出位移如圖14所示，
由圖中可得知利用控制器來對系統進行補償，能在一
很短的時間內就使系統之誤差收斂。圖15為系統之控
制器輸出。 
-1 -0.5 0 0.5 1 1.5
-40
-30
-20
-10
0
10
20
30
Displacement Error
V
el
oc
ity
 E
rro
r
 
圖 14 系統未補償之輸出相平面圖 
0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.4 0.45
-1
-0.8
-0.6
-0.4
-0.2
0
0.2
0.4
0.6
0.8
1
Time (sec)
D
is
pl
ac
em
en
t (
um
)
Command
With Control
Without Control
 
圖 15  系統之輸出位移圖 
0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9
-1.5
-1
-0.5
0
0.5
1
1.5
Time (sec)
C
on
tro
lle
r O
ut
pu
t
 
圖 16 系統之控制器輸出圖形 
圖17為系統之外界干擾與輸出位移誤差之圖
形，正如圖所示系統在一開始就不受外界之干擾，主
