II
目 錄
摘 要 ............................................................................................................................I
Abstract .........................................................................................................................I
目 錄 .......................................................................................................................... II
圖目錄 ........................................................................................................................ III
表目錄 ........................................................................................................................ III
1. 前言 .......................................................................................................................... 1
2. TFT-LCD產業層級式多廠區生產鏈規劃模組 ..................................................... 2
3. 文獻回顧 .................................................................................................................. 4
3.1 多廠協同（Multi-plant Coordination）規劃問題 ........................................ 4
3.2 供應鏈規劃與排程方法分類 ........................................................................ 4
3.2.1 數學規劃法（Mathematical Programming） .................................... 4
3.2.2 模擬規劃法（Simulation Method） .................................................. 5
3.2.3 混合式規劃法（Hybrid Method） .................................................... 6
4. 多廠區供應網路規劃模式之研究 .......................................................................... 6
4.1 供應網路規劃（SNP）問題定義................................................................. 6
4.2 規劃模式 ........................................................................................................ 6
4.3 範例說明 ........................................................................................................ 9
4.4 決策分析與討論 .......................................................................................... 11
5. 陣列製造廠日投入生產計畫之研究 .................................................................... 12
5.1 陣列製造廠日投入生產計畫問題定義 ...................................................... 12
5.2 規劃模式 ...................................................................................................... 13
5.3 具動態慣性權重與突變機制之二位元粒子群最佳化方法 ...................... 15
5.4 方法論比較與討論 ...................................................................................... 16
6. 結論與建議 ............................................................................................................ 19
參考文獻 ..................................................................................................................... 19
11. 前言
隨著數位家庭概念的興起及行動通訊產業的建構已漸完成，數位電視及彩色高質化的中小尺寸影
音產品，將繼電腦資訊產品後，成為帶動平面顯示器（FPD）市場規模高峰的動力。在廣泛的電子產
品中薄膜電晶體液晶顯示器（Thin Film Transistor- Liquid Crystal Display, TFT-LCD）是關鍵的重要技術
或材料，根據全球著名的顯示器市場調查機構 DisplaySearch[2]，台灣在去年（2005）大尺寸面板出貨
量已達整體市場的 45%，目前的擴廠速度及規模領先全球，與韓國成為全球主要的 TFT-LCD面板供應
商。
圖 1.1為 TFT-LCD產業的上、中、下游之產業鏈概觀圖，上游包含了設備、材料與零組件供應商，
例如玻璃基板、彩色濾光片、偏光片等主材料；中游為面板製造商，例如韓國 Samsung及 LG. Philips、
台灣友達、奇美等；下游是產品應用層別，後段的組裝廠商將完成如筆記型電腦、液晶電視、桌上型
液晶螢幕等消費性產品。
上
游
( 設
備
、
材
料
、
零
組
件
)
中
游
( 面
板
製
造
)
下
游
( 產
品
應
用
)
成膜設備
曝光設備/光罩
蝕刻設備
Sputter設備
液晶灌注設備
Assembly設備
檢查測試設備
……
設備
擴散膜
配向膜
冷極陰管
……
光阻劑
蝕刻液
剝離液
液晶
Spacer
玻璃基板 (Glass)
彩色濾光片 (Color Filter)
偏光板 (Polarizer)
驅動IC (Source-IC, Gate-IC)
控制電路板 (PWB)
背光模組 (Black Light)
其他材料六大主材
材料及零組件
模組製程
(Module)
組立製程
(Cell)
陣列製程
(Array)
後段製程前段製程
TFT-LCD面板製造商
筆記型電腦 液晶顯示器 液晶電視 Mobile/AV 手機 其他
圖 1.1 TFT-LCD產業之產業供應鏈
本研究是以 TFT-LCD產業鏈中游面板製造商為對象，面板製造業是由三大生產階段所構成，分別
為陣列（Array）製程、組立（Cell）製程和模組（Module）製程，如圖 1.2 所示。每階段製程由多個
廠區所組成，有如一小型的供應鏈結構，而三大製程階段的規劃特性並不全相同，這是多廠區規劃環
境下常面臨的問題。
由於 TFT-LCD產業的諸多特性或限制，例如各世代數工廠造成不同製程技術所衍生的產品不同加
工路徑、薄膜電晶體基板與彩色濾光片基板的組立貼合形成供應網路流進流出量的不同、面板經濟切
割數影響投入產出量的規劃、陣列製造廠瓶頸機台與副資源光罩之搭配限制等等特性，增加在進行層
級式生產鏈規劃時的複雜度。
研究目的如下：
1. 回顧相關研究文獻，針對供應鏈多廠區的生產模式、各式生產鏈結構、相關規劃特性與限制
等進行探討，提出多廠區規劃問題之分析架構，並以 TFT-LCD面板製造產業為例說明先進規
劃與排程模組系統。
2. 本研究針對層級式多廠區生產規劃問題提出兩階段式規劃模式架構。首先為 TFT-LCD產業之
供應網路規劃問題，考量滿足最終產品需求數量與各產品族規劃的生產總量目標下，決定每
個廠區未來每個月所需生產的產品數量及物料採購計畫，在考量多限制式規劃模式下，利用
線性目標規劃方法求解供應網路規劃階段並進行分析探討，包含不同規劃決策模式之比較與
3圖 2.1 TFT-LCD層級式多廠區生產鏈規劃模組
以下將對每個規劃模組處理的問題目的、輸入資料來源與輸出結果，描述如下：
需求規劃（Demenad Planning）—目的為依據未來市場需求趨勢、歷史出貨量與顧客需求預測，
決定未來的中長期性各產品階層之需求預測；輸入包括了市場趨勢、歷史出貨量與顧客需求預
測；其輸出結果為各產品階層之需求預測，包括了產品族（product group）與最終產品（product
model）。
產能與產品組合規劃（Capacity/ Product Mix Planning）—目的為依據中長期需求規劃結果，決定
未來每個廠區生產的產品族組合與各產品族生產總量；輸入為需求規劃產出結果的產品族需求
預測量；其輸出結果為每個廠區之最佳產品組合規劃。
供應網路規劃（Supply Network Planning）—目的為依據中期需求規劃和產能與產品組合規劃結
果，決定未來每個廠區中期生產鏈計畫；輸入包括了每個廠區之產品組合規劃、最終產品需求
預測量與各物料進料計畫；其輸出結果為每個廠區之中期生產投入產出規劃。
關鍵物料規劃（Critical Material Planning）—目的為依據各廠區中期供應網路規劃，決定未來物
料需求與採購計畫；輸入為每個廠區之供應網路規劃；其輸出結果為各關鍵性物料需求與各供
應商未來採購計畫。
陣列製造與面板組立廠區短期日排程（Daily Scheduling）—目的為依據各廠區中期供應網路規
劃，決定陣列製造與面板組立製程中各廠區每日投入與產出計畫；輸入為每個廠區之供應網路
規劃；其輸出結果為每個陣列製造與面板組立廠區每日投入與產出計畫。
模組製造廠區短期最終組裝日排程（Final Assembly Scheduling）—目的為依據確定顧客訂單需
求，決定模組製程中各廠區每日投入與產出計畫；輸入包括了顧客確定訂單與每個面板組立廠
區每日投入與產出計畫；其輸出結果為每個模組製造廠區每日投入與產出計畫以及每個模組製
造廠區剩餘未允諾的物料與產能量。
訂單滿足規劃（Order Fulfillment）—目的為依據顧客詢問訂單，決定是否可以滿足訂單交期與
數量；輸入包括了最終產品需求預測、每個廠區之生產鏈規劃、顧客詢問訂單、每個面板組立
廠區每日投入與產出計畫與每個模組製造廠區剩餘的物料與產能；其輸出結果為顧客確定訂單
以及不可滿足的顧客詢問訂單量。
Array、Cell與Module現場作業排程（Operations Scheduling）—目的為依據 Arra/Cell/Module每
日投入與產出計畫，決定各生產製程之投料順序與派工決策；輸入為 Array/Cell/Module 製程中
各廠區每日投入與產出計畫；其輸出結果為 Array/Cell/Module現場投料計畫與機台派工法則。
5行規劃。
Module 3：利用線性規劃計算前段（Front-End）製程的產出是否能滿足模組二對於晶粒（die）
的需求，考量晶粒存貨、在製品、產能負載、物料供給、產品分級、等級分配等因素規劃晶粒
供給的問題。
Module 4：利用線性規劃計算後段（Back-End）製程的產出是否可以滿足最終產品的需求，考
量的因素除了與模組三相同外，並額外多考慮前段製程產出的晶粒庫之可使用數量限制。
Module 5：計算產品的可允諾數量（Available To Promise, ATP）。
圖 3.1 半導體產業供應鏈規劃流程[5]
Guinet[3]學者認為多廠區規劃問題可以模式化為流量問題（flow problem），受限於變動與固定成
本，或是相異平行機台的排程問題。作者將多廠問題分成兩個子問題，分別是廠區間的多廠規劃與廠
區內部的工作中心排程問題。首先依據訂單的交期進行廠區分派，不同的廠區有不同的專業生產能力，
並以最小化生產成本、持有成本、延遲成本、設置成本和運輸成本為目標，當各廠區獲得生產訂單後
再排定細部的廠內工作中心排程，排程目標是使訂單延遲最小化。作者主要利用 primal-dual技術來進
行求解此多廠區規劃問題。
Moon[7]等學者對於多廠供應鏈（MSC）提出一整合式的流程規劃與排程模組（Integrated Process
Planning and Scheduling, IPPS），主要是建構為一數學模式並考量替代機台、替代途程、設置序列相依
及交期等限制，決定最佳的加工作業順序、機台選擇與加工作業排程，以最小化延遲（tardiness）為目
標，模式是利用遺傳演算法（Genetic algorithm, GA）進行求解，規劃結果可以知道訂單分派到哪個廠
區生產，以及各訂單的投入與產出時間。
3.2.2 模擬規劃法（Simulation Method）
模擬規劃法主要的觀念是利用模擬事件時間推進機制的特性，根據生產製程環境與規劃策略，建
立模擬模式進行決策規劃。模擬規劃法的優點為模擬可以較真實地反應工廠內的產能消耗與物流狀
況，但是若要建構細緻度極高的模擬模式需花費極大的成本[16]。
Watson[14]學者提出一個以後推式模擬（Backward Simulation）為基礎的訂單發放規劃方法
（BACKSIM）。主要以離散模擬模式來代表實際生產現場狀況與產能，首先利用後推模擬求出各訂單
的最晚開始時間，再應用前推模擬整合考量在製品（即已開立訂單）與未來計畫開立訂單而獲得各訂
單的開立時間。此方法改進了傳統MRP的無限產能（infinite capacity）與概估生產前置時間（lead time）
之缺點，透過模擬模式進行規劃時，可以較真實地考量製造現場的生產資源之產能消耗情況，也能同
時決定適當的加工前置時間，但是此方法未考慮到物料供給限制，且所使用的派工法則為最簡單的
FIFO法則。
之後Watson[15]學者再修正此訂單發放規劃流程，包含下面兩個階段：第一階段，步驟（1）因製
造現場的作業存在變異性，需訂定一個寬裕值，而將每個作業的實際加工時間與移動時間之總和乘上
該寬裕值，可得到一個考量變異的生產處理時間。步驟（2）對於計畫訂單依據含有考量變異的生產處
理時間進行後推式模擬（Backward Simulation）規劃，找出每張訂單在每個作業的開始加工時間。步驟
（3）因為在後推模擬時並未考慮現場在製品的狀況，因此經由後推模擬結果產生的第一個作業之訂單
7g =產品族（product group）編號，g=1,2,…,G，G為產品族總數。
i, j =製造工廠編號，i, j=1,2,…,N，N代表工廠總數，此處工廠的編號是依照生產階段順序編號，
例如若陣列製造、面板組立與模組製程各有兩座廠區，則陣列製程的兩座廠區分別為編號 1與 2，
面板組立製程的兩座廠區分別為編號 3與 4，依此類推，總工廠數 N=6。
k =物料編號，k=1,2,…,K，K為物料種類總數。
g =代表屬於產品族 g的所有最終產品之集合。
A =陣列製程的所有製造廠區集合。
C =面板組立製程的所有製造廠區集合。
 CF =彩色濾光片製程的所有製造廠區集合。
 M =模組製程的所有製造廠區集合。
F(i),F(j) =工廠 i, j對應的上一生產階段之工廠集合。
L(i),L(j) =工廠 i, j對應的後一生產階段之工廠集合。
(2) 決策變數定義：
Qipt =時間 t工廠 i產品 p的投入生產量。
Bikt =時間 t工廠 i物料 k的採購數量。
Iipt =工廠 i產品 p在時間 t末的存貨數量。
Uipt =時間 t工廠 i產品 p的缺貨數量。
Mikt =工廠 i物料 k在時間 t末的存貨數量。
Tijpt =時間 t工廠 i,j間產品 p的運輸數量。
QFipt =代表工廠 i在時間 t-1投入產品 p生產而於時間 t產出的數量。
QPipt =代表工廠 i在時間 t投入產品 p生產而於時間 t產出的數量。

igt =工廠 i 在時間 t 將最終產品（ g ）彙總成各產品族 g 之總量與上層產能/產品組合規劃模
組所規劃的產品族目標總量之間的負差異量。

igt =工廠 i 在時間 t 將最終產品（ g ）彙總成各產品族 g 之總量與上層產能/產品組合規劃模
組所規劃的產品族目標總量之間的正差異量。
(3) 參數定義：
dipt =時間 t工廠 i最終產品（product model）p的預測需求量。
TQigt =時間 t工廠 i產品族（product group）g的目標彙總數量。
bomipk =工廠 i每生產一單位產品 p所需要的物料 k之數量。
ydit =時間 t工廠 i的製程良率（yield rate）。
cpipt =時間 t工廠 i產品 p的單位生產成本。
chipt =時間 t工廠 i產品 p的單位存貨持有成本。
csipt =時間 t工廠 i產品 p的單位缺貨成本。
cbkt =時間 t物料 k的單位採購成本。
cmkt =時間 t物料 k的單位儲存成本。
ctijt =時間 t工廠 i, j間的單位運輸成本。
capit =時間 t工廠 i的可用產能限制。
unitip =產品 p在工廠 i的生產轉換單位。
lti =工廠 i的生產前置時間。
btk =物料 k的採購前置時間。
dtt =在時間 t內包含的天數。

g , g =最終產品（ g ）彙總成各產品族 g 之總量與上層產能/產品組合規劃模組所規劃的產
品族目標總量之間的差異量所衍生的懲罰成本。
(4) 限制式：
限制式（4.1）與（4.2）描述了 TFT-LCD面板產業的製造流程特性。
9（4.14）式所示。
 
   
 
   

 
 
 










Mii
CFj
Ajj p t
ijptijt
i k t
iktktiktkt
Mi p t
iptipt
i p t
iptiptiptipt
i g t
igtgigtg
TctMcmBcb
UcsIchQcpMin
Min





, ,
2
1
（4.14）
透過供應網路規劃（SNP）後，將可獲得每座製造廠區未來六個月每個月的投入生產量，提供給
各廠區進行下一個月每日的日投入生產計畫；另外也可得知未來關鍵性物料的需求數量，由於 TFT-LCD
製程的部分相關物料是仰賴國外進口，例如驅動 IC、PCB等料件，供貨前置時間均相當長，可能長達
兩至三個月，因此可將此物料需求資訊提供給上游供應商作為備料上的參考，以避免因採購前置時間
長造成供貨不確定因素增加而缺料。
4.3 案例說明
由於多廠區供應網路規劃（SNP）問題位於圖 2.1層級式多廠區生產鏈規劃模組架構圖中的折衝模
組，必須考量產能與產品組合規劃模組所規劃的產品族生產總量之目標，來滿足需求規劃模組提供的
各最終產品之預測需求量，因此本小節透過具優先權式之目標規劃（preemptive goal programming）模
式來求解 SNP 問題。利用下式（4.15）優先滿足上層產能與產品組合規劃模組所規劃的產品族生產總
量。

tgiTQQ igtigtigt
gp
ipt ,, 

 

（4.15）
本研究以台灣某一 TFT-LCD產業面板製造商為例，假設目前該公司在每個生產階段（陣列製造、
面板組立與模組製程）各擁有兩座廠區，由於面板製程技術造成廠區間的世代數不同，因此產品在陣
列製造廠、彩色濾光片製造廠、面板組立廠之間必須同世代數才可進行運輸。考慮兩種產品族分別為
15吋 XG與 17吋 XA，兩種產品族之下各有兩種最終產品，分別為 15吋 XG01與 XG02機種；17吋
XA01與 XA02機種。計畫涵蓋時程為未來六個月。
供應網路規劃（SNP）模式的相關輸入資料如下：表 4.1為產能與產品組合規劃模組提供的各產品
族（product group）在每個廠區的月生產總量之目標。
表 4.1 各產品族在每個廠區的生產總量目標
Jan. Feb. Mar. Apr. May Jun.
15”XG 660 420 420 420 420 420Array #1
17”XA 900 600 600 600 600 600
15”XG 1200 500 800 700 500 500Array #2
17”XA 900 700 700 700 700 700
15”XG 550 420 400 420 420 420CF #1
17”XA 700 650 650 650 650 650
15”XG 1100 500 850 660 500 500CF #2
17”XA 800 700 700 700 700 700
15”XG 8400 7800 7800 7800 7800 7800Cell #1
17”XA 10000 9800 9800 9800 9800 9800
15”XG 14500 14200 12000 17000 9200 9200Cell #2
17”XA 11600 11000 11000 11000 11000 11000
15”XG 42000 39000 39000 39000 39000 39000Module #1
17”XA 50000 49000 49000 49000 49000 49000
15”XG 48000 46000 46000 46000 46000 46000Module #2
17”XA 58000 55000 55000 55000 55000 55000
表 4.2為需求規劃模組提供的各最終產品（product model）在每個廠區的未來六個月之預測需求量。
11
表 4.5 各廠區月投入生產計畫之決策
15”XG-01 15”XG-02
Jan. Feb. Mar. Apr. May Jun. Jan. Feb. Mar. Apr. May Jun.
Array #1 94 278 81 49 0 0 566 142 339 371 420 420
Array #2 604 448 388 700 306 0 596 52 412 0 194 500
CF #1 78 239 83 96 0 0 472 181 317 324 420 420
CF #2 526 466 374 660 348 2 574 34 476 0 152 498
Cell #1 1332 4115 2107 1819 311 0 7068 3685 5693 5981 7489 7800
Cell #2 8960 9200 7289 12267 7561 935 5540 5000 4711 4733 1639 8265
Module #1 16065 23671 17206 15631 13103 5438 25935 15329 21794 23369 25897 33562
Module #2 19282 18103 18187 18181 35152 0 28718 27897 27813 27819 10848 46000
17”XA-01 17”XA-02
Jan. Feb. Mar. Apr. May Jun. Jan. Feb. Mar. Apr. May Jun.
Array #1 448 230 340 285 420 122 452 370 260 315 180 478
Array #2 461 236 314 289 356 210 439 464 386 411 344 490
CF #1 354 285 300 296 381 184 346 365 350 354 269 466
CF #2 402 264 294 288 340 223 398 436 406 412 360 477
Cell #1 5805 5751 5764 5761 7123 4206 4195 4049 4036 4039 2677 5594
Cell #2 6874 5475 5619 5606 6463 4630 4726 5525 5381 5394 4537 6370
Module #1 26887 25136 25261 25252 32723 17248 23113 23864 23739 23748 16277 31752
Module #2 32234 30165 30313 30302 32506 27943 25766 24835 24687 24698 22494 27057
表 4.6 各廠區物料採購計畫之決策
4.4 決策分析與討論
本小節將針對 SNP規劃問題的三種決策模式進行討論。其比較結果如表 4.7所示。
(1) 同步式（Concurrent）最佳化規劃模式：
同步式規劃模式即為 4.2 小節的數學規劃模式，其針對在網路結構上企業所擁有的多個廠區進行
同步式的最佳化規劃，以公司的整體面進行供應網路規劃，在 4.5 節的範例中，總成本利用同步式最
佳化規劃為$2,640,484，各項成本所佔比例為生產成本 42.98%、產品存貨持有成本 1.21%、物料採購成
本 29.43%、物料存貨成本 4.13%、廠區間運輸成本 22.25%等。
(2) 序列式（Sequential）規劃模式：
序列式規劃模式目前普遍存在許多公司內，其大部分原因為企業組織單位分割所造成，以 TFT-LCD
產業而言，陣列製造、面板組立與模組製造等製程可能由不同部門的不同生管規劃人員負責，因此規
劃流程為從後段模組製造廠開始，根據銷售需求預測量決定模組製造廠的最佳投入計畫後，接著轉換
為面板組立廠區的產出需求計畫，規劃人員再根據此產出需求計畫規劃面板組立廠的最佳投入計畫，
同樣地，面板廠區的投入計畫即為陣列製造廠與彩色濾光片製造廠的產出需求計畫，此兩製程的規劃
人員再根據此資訊決定最佳的投入生產計畫。因此，序列式的規劃模式即是從後段製程往前推移規劃，
每段製程的生產計畫均是最佳的決策計畫。
Jan. Feb. Mar. Apr. May Jun.
Array #1 玻璃基板 540 1020
Array #2 玻璃基板 1050 1200 1200
CF #1 玻璃基板 410 1070
CF #2 玻璃基板 860 1200 1200
Cell #1 偏光片 30500 35200 35200 35200 35200
Cell #2 偏光片 45600 56000 40400 40400
Drive IC 1338278 1428446 1436339 1434039 1503314
Module #1 背光模組 25000 88000 88000 88000 88000
Drive IC 876711 1638488 1549231 1734114
Module #2
背光模組 100000 101000
13
並且由於品質問題的考量，並非每一片光罩均可於任一台掃描機上使用。在經過試產、驗證品質
合格後，光罩才可在指定的掃描機台群上使用。另外，黃光製程中的掃描作業因加工產品與層級的不
同，若作光罩切換需花費整備時間。在作光罩切換時，跨機台的光罩切換所耗費的時間可能從 20分鐘
至 2 小時不等，整備時間變異較大。因此，跨機台的換線動作應儘可能的減少，以避免發生機台利用
率及良率下降的問題。
文獻上對於處理產能限制下的多產品生產批量問題已被認為是複雜難解的 NP-Hard 問題
[1][9][11]，因此本研究發展具動態慣性權重與突變機制之二位元粒子群最佳化方法，並與遺傳演算法
比較後，本方法搜尋所花費的時間相較遺傳演算法來得迅速有效率，並且可較快速收斂到近似最佳解
處。
5.2 規劃模式
將符號說明與定義、限制式、目標函數描述如下：
(1) 下標定義：
t’=期間編號（單位：天），t’=1,2,…,dt(t=1)。
p =產品編號，p=1,2,..,P，P為產品別總數。
s =瓶頸作業層級，s=1,2,…,S，S為瓶頸作業層級總數。
c =瓶頸機台編號，c=1,2,…,C，C為瓶頸機台總數。
(2) 決策變數定義：
Xpt’=在期間 t’對於產品 p的生產數量。
Rpt’=每個期間 t’末產品 p的存貨數量。
Ypt’=binary variables，假如 Ypt’=1表示產品 p在期間 t’有生產；反之若 Ypt’=0表示在該期間沒有生
產。
Spt’= binary variables，假如 Spt’=1表示產品 p在期間 t’有 setup；反之若 Spt’=0，表示在該期間沒有
setup。
Apsc =在規劃排程幅度內，產品 p第 s個瓶頸層級作業分配到機台 c上的總加工數量。
Zpsc = binary variables，排程幅度內若配置產品 p第 s個瓶頸層級作業在機台 c上加工時，則 Zpsc =1；
反之，則 Zpsc =0。
Lc =機台 c 的產能負荷，為在規劃排程幅度內配置到的瓶頸作業量及其對應的加工時間之乘積總
合。   cPTAZL
p s
pspscpscc  , 。
AQps =在排程幅度內產品 p 的第 s 個瓶頸層級作業獲得配置的作業數量。此處的
spAAQ
C
c
pscps ,,
1


。
VQps =在排程幅度內產品 p 的第 s 個瓶頸層級作業的需求加工量與獲得配置量之差異。此處
spAQTDVQ pspsps ,, 。
(3) 參數定義：
ft’=期間 t’的工廠固定開工成本（fixed cost）。
scp =產品 p的整備成本（setup cost）。
hpt’=每個期間 t’產品 p的單位存貨持有成本。
yd(i=1)(t=1) =陣列製造廠(i=1)第一個月份(t=1)的生產良率。
unit(i=1)p=陣列製造廠(i=1)第一個月份(t=1)的生產轉換單位，亦即從批量(lot)投入單位轉換成大玻璃
基板(sheet)產出單位。
d’pt’=陣列製造廠在期間 t’對於產品 p的產出需求數量。
vpt’=期間 t’每製造一單位產品 p的產能消耗量。
stpt’=期間 t’每製造一單位產品 p的 setup time。
bt’=期間 t’陣列製造廠的可用產能時間。
SP=排程幅度（scheduling period）時間長度，此處定義為要預先配置瓶頸機台與光罩搭配限制問
15
(5) 目標函數：
此階段的目標函數（5.15）為最小化總相關成本，成本包含(1).每日存貨持有成本，為每期間末存
貨數量乘上每單位存貨持有持本。(2).產品生產的整備成本，整備次數乘上單次整備成本。(3).陣列廠
固定開工成本，為陣列製造廠該月生產的總日數乘上單次固定開工成本。(4).當配置產品的各瓶頸層級
作業在機台上加工時，由於切換光罩作跨機台的切換動作會浪費瓶頸產能，因此希望光罩所分配到的
使用機台數最少，計算方式為產品的各瓶頸層級作業分配到的機台數量乘上懲罰成本係數。(5).滿足需
求最大化是藉由產品的各瓶頸層級作業需求加工量與獲得配置量之差異來衡量，計算方式為此差異量
乘上懲罰成本係數。在上述(4)(5)兩部分中的懲罰成本係數為與產業界相關人員討論後決定。
   
p s
ps
p s c
psc
p t
pttptpptpt VQZYfSscRhMin 
'
''''' （5.15）
5.3 具動態慣性權重與突變機制之二位元粒子群最佳化方法
PSO演算法已成功應用到許多最佳化搜尋問題上，然而 PSO在搜尋演化過程後期，往往不會有太
大的最佳解變化，而與實際最佳解維持一定的差距無法跳脫出目前的搜尋範圍，而粒子屬性方面若個
體粒子之值為 0/1 二位元時，粒子的位置與速度更新法則必須做調整，因此本研究在顧及不犧牲 PSO
固有的求解速度之優勢下，提出具動態慣性權重與突變機制之二位元粒子群最佳化方法。
慣性權重的觀念最早是由 Shi與 Eberhart學者[13]提出，其認為慣性權重之值若能隨著演化過程改
變，逐步線性降低其值，搜尋過程應能比固定慣性權重之值更有效率，越大的慣性權重值其每次搜尋
跨步距離較大，越有能力搜尋新空間；
而越小的慣性權重值其每次搜尋跨步距離較小，能提供區域式的深度搜尋。因此一般建議慣性權重在
演化初期應給予較大的值以利做廣度搜尋，在演化後期逐步減少慣性權重值以利深度搜尋。
本研究提出的動態慣性權重值(w)可由下式決定：
 
n
iter
iter
wwww 



max
minmaxmax （5.16）
其中 wmax為設定的慣性權重最大值，wmin為慣性權重最小值，iter為目前演化代數，itermax為演化總代
數，n為演化過程中慣性權重降低調整控制參數，其演化代數與慣性權重關係圖如圖 5.2所示，當 n=1
時，為一般的線性降低慣性權重，根據本研究實驗結果得知，擬定 n=1.5，原因為在演化初期，其慣性
權重值較 n=1時大，可提供更有效率的廣度搜尋，而在演化後期，其慣性權重值較 n=1時更快速的遞
減，可加快其收斂速度。然而 n 之值也不能過大，因為太大的 n 值代表演化初期搜尋跨步太大會造成
粒子群過於發散而無法收斂的情況。
圖 5.2 演化代數與慣性權重關係圖
本研究的陣列製造廠日投入生產規劃模式階段主要是決定變數 Ypr（是否在該期投入生產）與 Zpsc
（是否有配置產品 p第 s個瓶頸層級作業在機台 c上加工），因此本研究利用 MATLAB撰寫二位元粒
17
表 5.1 產品、瓶頸機台與光罩搭配限制表
Gate層 SE層 Source/Drain層 Contact Hole層 Pixel構成層
M1 M2 M3 M1 M2 M3 M1 M2 M3 M1 M2 M3 M1 M2 M3
15吋 XG01 ⊙ ⊙ ⊙ ⊙ ⊙ ⊙ ⊙ ⊙
15吋 XG02 ⊙ ⊙ ⊙ ⊙ ⊙ ⊙ ⊙
表 5.2 產品在每一瓶頸作業層級的單位加工時間
Gate層 SE層 Source/Drain層 Contact Hole層 Pixel構成層
加工時間 0.50 0.65 0.85 0.9 0.55
利用最佳化軟體求解後獲得的最小成本為 29.144。陣列製造廠區第一個月之日投入生產計畫如表
5.3所示。產品的每一瓶頸作業層級與瓶頸機台搭配結果如表 5.4所示。每部掃瞄機台的產能負荷見表
5.5。
表 5.3 陣列製造廠區第一個月之日投入生產計畫最佳化決策
陣列製造一廠 (day) 1 3 6 8 9 12 14 15 18
15吋 XG01 8.81 6.88 7.88
15吋 XG02 9.94 14.06 14.38 14.06 14.06 14.25 14.06
表 5.4 產品每一瓶頸作業層級與瓶頸機台搭配結果
Gate層 SE層 Source/Drain層 Contact Hole層 Pixel構成層
M1 M2 M3 M1 M2 M3 M1 M2 M3 M1 M2 M3 M1 M2 M3
15吋 XG01     
15吋 XG02     
表 5.5 掃瞄機台產能負荷表
產能負荷
掃瞄機台M1 20.57
掃瞄機台M2 22.24
掃瞄機台M3 21.88
本問題的數學規劃模型，其整數個數有   csptp  '2 個，其中 p為產品個數、t’為規劃天數、
s為瓶頸作業層級數、c為瓶頸機台數，因此若以本例而言，整數個數為 2*(2*20)+2*5*3=110，當產品
種類增加時，問題的複雜度將隨之增加，利用數學規劃最佳化求解工具將不易獲得最佳解或需花費極
大時間成本，因此本研究發展啟發式方法以進行問題求解。
以本研究提出的具動態慣性權重與突變機制之二位元粒子群最佳化方法解得之最小化成本為
29.566，如圖 5.3所示。
19
6. 結論與建議
本研究針對 TFT-LCD產業層級式多廠區生產規劃問題提出兩階段規劃模式架構。首先為 TFT-LCD
產業之供應網路規劃問題，考量滿足最終產品需求數量與各產品族規劃的生產總量目標下，決定每個
廠區未來每個月所需生產的產品數量及物料採購計畫，在考量多限制式規劃模式下，利用線性目標規
劃方法求解供應網路規劃階段並進行分析探討，包含不同規劃決策模式之比較與相關成本之敏感度分
析等。經過比較分析後，得知同步式的規劃模式會獲得較佳的成本效益，及總成本因子中單位生產成
本對於總成本的影響較大。
另一子問題為陣列製造廠區日投入生產規劃階段，包含光罩資源和瓶頸機台配置問題，由於為複
雜之 NP-Hard 問題，本研究發展具動態慣性權重與突變機制之二位元粒子群最佳化方法，有別於一般
定值之慣性權重，本研究提出依演化代數之非線性慣性權重方法，與傳統標準的粒子群最佳化方法和
遺傳演算法比較後，可發現本方法搜尋所花費的時間相較其他方法來得迅速有效率，可快速收斂到近
似最佳解處。
參考文獻
[1] Berretta, R. and Rodrigues, L.F.,“A memetic algorithm for a multistage capacitated lot-sizing problem”,
International Journal of Production Economics 87, pp.67-81, 2004.
[2] DisplaySearch, http://www.displaysearch.com.
[3] Guinet, A.,“Multi-site planning: A transshipment problem”, International Journal of Production Economics 74,
pp.21-32, 2001.
[4]Leachman, R.C., “Modeling Techniques for Automated Production Planningin the Semiconductor Industry”, 
ESRC Report, 92-7/RAMP92-4, University of California, Berkeley, 1992.
[5]Leachman, R.C., Benson R.F., Liu C. and Raar D.J., “IMPReSS: An Automated Production-Planning and
Delivery-Quotation System at Harris Corporation－Semiconductor Sector,” Interfaces 26, pp.6-37, 1996.
[6] Lin, James T. and Chen Y.Y., “A Multi-site Supply Network Planning Problem Considering Variable Time Buckets-
A TFT-LCD Industry Case”, International Journal of Advanced Manufacturing Technology 33, pp.1031-1044,
2007.
[7] Moon, C., Kim, J. and Hur, S.,“Integrated process planning and scheduling with minimizing total tardiness in
multi-plants supply chain”, Computers & Industrial Engineering 43, pp.331-349, 2002.
[8] Murty, S.V. and Bienvenu, J.W.,“Global Planning at Harris Semiconductor”, 1995International Symposium on
Semiconductor Manufacturing, IEEE, 1995.
[9] Ozdamar, L. and Birbil, S.I.,“Hybrid heuristics for the capacitated lot sizing and loading problem with setup times
and overtime decisions”, European Journal of Operational Research 110, pp.525-547, 1998.
[10] Roux, W., Dauzere-Peres, S. and Lasserre, J.B., “Planning and scheduling in a multi-site environment”, Production
Planning & Control 10, pp.19-28, 1999.
[11] Sambasivan, M. and Yahya, S.,“A Lagrangean-based heuristic for multi-plant, multi-item, multi-period capacitated
lot-sizing problems with inter-plant transfers”, Computers & Operations Research 32, pp.537-555, 2005.
[12] Shanthikumar, J.G. and Sargent, R.G.,“A unifying view of hybrid simulation / analytic models and modeling”,
Operations Research 31, pp.1030-1052, 1983.
[13] Shi, Y. and Eberhart, R.C., “A modified particle swarm optimizer”, IEEE International Conference on Evolutionary
Programming, Alaska, May 4-9, 1998.
[14] Watson, E.F.,Medeiros, D.J. and Sadowski, R.P., “Generating Component Release Plans with Backward
Simulation”, Proceedings of the 1993 Winter Simulation Conference, pp.930-938, 1993.
[15]Watson, E.F., Medeiros, D.J. and Sadowski, R.P., “Order-release planning using variable lead times based on a
backward simulation model”, International Journal of Production Research 33, pp.2867-2888, 1995.
[16] Watson, E.F.,Medeiros, D.J. and Sadowski, R.P., “A simulation-based backward planning approach for
order-release”, Proceedings of the 1997 Winter Simulation Conference, pp.765-772, 1997.
2為了三天進行報告，本人在此研討會中第三天(3/19) ICINDE IX 進行口頭報告，
Session Chair 為 Dr. Markus Stopper。此外在此子會議 ICINDE 邀請 Dr. Alan Hoi-shou
Chan 進行 Keynote Speech，講題為 Designing User-friendly Safety Signs with
Considerations of Cognitive Features，其精闢的演講讓與會者獲益良多。
二、與會心得
很感謝國科會的經費補助，而有這次參加國際研討會會議的機會，此次會議中，
除了瞭解工業工程與管理領域各國學者的研究內容之外，也藉此場合與許多相關研
究領域的學者交流討論，獲悉工業工程與工業管理領域相關的發展趨勢與世界潮
流，讓本人收穫不少。
另外，除了在研討會場與相關領域學者交流之外，也藉著空餘時間參觀訪察了
香港理工大學與香港的民情景色，深覺香港是個多元化多種族交會的地方，無怪乎
成為世界上舉足輕重的地點。
三、攜回資料名稱及內容
此次研討會，大會所提供之資料為(1)會議 Program Schedule and Session Details
乙本、(2)發表文章論文集乙本、以及(3)論文集光碟片兩張。
2透過交流讓與會者都獲益良多。
二、與會心得
很感謝國科會的經費補助，而有這次參加國際研討會會議的機會，此次會議中，
除了瞭解工程管理領域各國學者的研究內容之外，也藉此場合與許多相關研究領域
的學者交流討論，獲悉創新、工程管理、科技等領域相關的發展趨勢與世界潮流，
讓本人收穫不少。
另外，除了在研討會場與相關領域學者交流之外，也藉著空餘時間參觀訪察了
日本東京的民情景色，東京地鐵的發達與便利、日本獨特文化的表現等都讓人留下
深刻印象，無怪乎東京成為世界上舉足輕重的地點。
三、攜回資料名稱及內容
此次研討會，大會所提供之資料為大會論文集(精簡版)以及論文集光碟片。
 
 
 
approach exploits a population of potential solutions to 
explore the search space.  
Compared with the GA method, there are no operators 
involved in the PSO; instead, natural evolution is applied to 
extract a new generation of candidate solutions. In contrast 
with the mutation mechanism, PSO rests on the exchange of 
information between individuals (named particles), and of 
the population (named swarm). Each particle adjusts its 
flying trajectory according to its own previous best position 
and the best previous position obtained by all members of its 
neighborhood. Furthermore in PSO, the whole swarm is 
considered as the neighborhood. Thus, there occurs global 
sharing of information and particles profit from the 
discoveries and previous experience of all other members 
during the searching process.  
Initially, assuming that the search space is D-dimensional, 
the i-th particle of the swarm is represented by a 
D-dimensional vector Xi = (xi1, xi2, …, xiD) and the position 
change (velocity) of the i-th particle is Vi = (vi1, vi2, …, viD). 
The best particle of the swarm, that is, the particle with the 
best objective function value, is denoted by gBest. The best 
previous position of the i-th particle in its own searching 
trajectory is recorded and represented as pBest. 
The velocities and positions of the particles are 
manipulated according to the following equations (the 
superscript k denotes the iteration): 
 
( )
( )kikki
k
i
k
i
k
i
k
i
k
i
XgBestrc
XpBestrc
VwV
−××+
−××+
×=+
22
11
1
 (1)
 
11 ++ += kikiki VXX  
 
(2)
 
where i = 1, 2, …, N, and N is the size of the population; w 
is the inertia weight which was developed to better control 
exploration and exploitation; c1 and c2 are two positive 
constants, called the cognitive and social parameters 
respectively; and ri1 and ri2 are random numbers uniformly 
distributed within the range [0, 1]. Eq.(1) is used to determine 
the i-th particle's new velocity, at each iteration, while Eq.(2) 
provides the new position of the i-th particle, adding its new 
velocity to its current position. The performance of each 
particle is measured according to a given fitness function, 
which is problem dependent. In the optimization problems in 
general, the fitness function is the objective function under 
consideration. 
The role of w is considered important for the PSO's 
convergence behavior. It is employed to control the impact of 
the previous history of velocities on the current velocity. 
Therefore, the parameter w regulates the trade-off between 
the global (wide-ranging) and the local (nearby) exploration 
abilities of the whole swarm. Usually, a larger inertia weight 
facilitates exploration for searching new regions; while a 
small one tends to facilitate exploitation; that is, it fine-tunes 
the current search space. An appropriate value for the inertia 
weight w thereby provides the balance between the global 
and local exploration ability of the swarm, resulting in better 
quality of solutions. Experimental results show that it is 
preferable to initially set the inertia to a large value in order to 
induce global exploration of the search space, and then 
gradually decrease it to obtain refined solutions. 
Therefore, it is even more difficult to solve the capacitated 
production allocation problem considering practical 
characteristics. In this paper, we involve the production 
planning problem in the TFT (thin film transistor) Array 
process. First, the TFT Array process is a re-entrant flow in 
which a similar sequence of processing step is repeated for 
five times. Further, the photolithography stage, the 
bottleneck in the TFT Array process, requires a second 
resource in addition to machines. Photo masks and scanners 
are both indispensable while executing exposure operation in 
the photolithography stage. Every product with a different 
re-entrant layer requires a unique mask, and consequently, 
each has a set of mask with five different pieces. Moreover, 
there is a tool eligibility issue between the masks and 
scanners. Masks are approved to be used in specific scanners 
for quality considerations. The TFT Array process is 
characterized as reentry and mask constraints, so it is 
regarded as a complicated scheduling problem and is more 
difficult to solve than the classical ones. 
 
II. A PRODUCTION PLANNING PROBLEM 
We formulate the programming model for the production 
planning problem in this paper. The symbols are defined as 
follows. 
Indexes: 
t = period index (day), t=1,2,…,T. 
p = product index, p=1,2,..,P. 
s = re-entrant layer index, s=1,2,…,S. 
c = bottleneck machine index, c=1,2,…,C. 
 
Parameters: 
ft = the fixed charge incurred whenever a product is 
produced in period t. 
scp = the setup cost for product p. 
hpt = unit cost of inventory for product p in period t. 
yd = the yield rate in the TFT Array process. 
unitp= the converted production unit for product p, 
transferring from a “lot” to large glass substrates (sheets). 
That is, the release production unit in the TFT Array process 
is a “cassette (or lot)” including about 20 glass substrates. 
Then, unitp equals 20 for a certain product p. 
dpt = the processing quantity demanded for product p in 
period t.  
vpt = the capacity consumed for making a unit of product p 
in period t. 
stpt = the setup time for product p in period t.  
bt = available capacity for production in period t. 
muc = the utilization rate for bottleneck machine c. 
PTps = the processing time for the s-th re-entrant layer of 
product p. 
epsc = the matching constraints for re-entrant layers, 
products, and machines. If the s-th re-entrant layer of product 
p can be processed in machine c, epsc=1; and otherwise, 
epsc=0.  
TDps = the processing quantity demanded for the s-th 
re-entrant layer of product p.  
 
 
 
III. A VARIANT OF PSO 
The PSO algorithm has been successfully applied to many 
kinds of optimization problems. However, though the 
approach has shown some important advantages by 
providing high-speed convergence in specific problems, 
studies are shown that the algorithm has a propensity for 
obstruction near the optimal solution regions and find it 
difficult to improve solution quality by fine tuning. In 
addition, the original updating process of positions and 
velocities must be modified when engaging in the binary 
decision variables. Consequently, this paper proposes a new 
variation of the PSO model. It is a binary PSO with the 
adaptable inertia weight and mutation mechanism. 
Meanwhile, we have kept the inherent property of the PSO, 
that is, the advantage of fast convergence. 
With the introduction of the concept of inertia weight, the 
aim is to balance and adjust the global search and local search. 
Furthermore, better performance would be obtained if the 
inertia weight were chosen a time varying, linearly 
decreasing quantity, rather than being a constant value. 
Consequently, a higher inertia weight implies larger 
incremental changes in velocity per iteration, and thus the 
exploration of new search areas for better solution. However, 
a smaller inertia weight signifies less variation in velocity, 
providing slower change in terms of fine tuning a local search. 
Therefore, it would be better that the searching process 
should start with a high inertia weight for global exploration, 
with the inertia weight linearly decreasing to facilitate finer 
local explorations in later iterations. 
A novel nonlinear function which regulates the inertia 
weight with variation in time is proposed in this study. This 
PSO version with adaptable inertia weight, as well as the 
mutation mechanism, improves the efficiency of 
performance once applied to problems with binary variables. 
The proposed inertia weight w is given as follows: 
( )
α
⎟⎟⎠
⎞
⎜⎜⎝
⎛×−−=
max
minmaxmax iter
iterwwww  (18)
 
where wmax is set as the maximum of inertia weight; wmin is 
set as the minimum of inertia weight; iter is the iteration 
number at the current time step; itermax is the maximum 
number of iterations in a given run; and α is the nonlinear 
adaptable coefficient during the iterations.  
With α=1, the changes become a special case of linearly 
regulative inertia weight with time, as proposed by Shi and 
Eberhart [14]. The searching process starts with a larger 
inertia weight (wmax), which facilitates aggressive exploration 
of new solution areas; this then gradually decreases 
according to Eq.(18). It will result in the different decreasing 
path for different values of α to reach wmin at the final 
iteration (itermax). After repetitive experiments, our model 
with α=1.5 has a higher value of w during the early iterations, 
which is more aggressive than Shi and Eberharts’ linear 
model (α=1). Also, in our model during the later iterations, w 
decreased more rapidly than the linear case, which is 
beneficial in accelerating the speed of convergence. However, 
if α is very large, then it may jump over the optimal areas 
during early iterations due to too large searching steps, and 
diverge or oscillate excessively during later iterations due to 
the rapid decrease in the value of w. 
Concerning the release production planning model in the 
TFT Array process as illustrated in Section 2, it is mainly to 
determine both binary decision variables, Ypt (whether 
product p is produced in period t.) and Zpsc (whether the s-th 
re-entrant layer of product p is processed in machine c). 
Therefore, this paper solves the problem by way of the binary 
PSO with the adaptable inertia weight and mutation 
mechanism, as well as techniques of constraints handling. Its 
steps are stated as follows: 
 
(1). Initialization 
The binary version of the PSO algorithm is employed in 
this study, so an initial population of particles is randomly 
constructed in that each particle’s position is either 0 or 1. 
Next, we set the maximum and minimum velocities of 
particles, which is limited to the boundary, V=[Vmin, 
Vmax]=[-4,4], and the initial velocity is generated by the 
following: 
V=Vmin + rand*(Vmax－Vmin), 
where rand means the random number. 
(19)
 
The fitness value is evaluated by both the objective and 
penalty functions due to violation of the constraints of the 
programming model.  
 
(2). Updating position and velocity 
During the repetitive iterations, the velocity of each 
particle is updated by Eq.(20), where c1 and c2 are social and 
cognitive parameters; rand1 and rand2 are random numbers 
between (0,1); pBest is the current best position of each 
particle in its own searching trajectory and gBest is the best 
value of the whole swarm. 
)(
)(
22
11
old
old
oldnew
XgBestrandc
XpBestrandc
VwV
−××+
−××+
×=
 (20)
 
Here, the inertia weight is nonlinearly regulated during 
iterations according to Eq.(21).  
( )
α
⎟⎟⎠
⎞
⎜⎜⎝
⎛×−−=
max
minmaxmax iter
iterwwww  (21)
 
If the particle’s velocity exceeds the maximum, Vmax, it has 
to be replaced by Vmax. Similarly, if the particle’s velocity is 
smaller than the minimum, it also has to be replaced by Vmin. 
Additionally, the sigmoid function [Eq.(22)] is used to scale 
the velocities between 0 and 1 because the sigmoid function 
value advances to 1 when ε approaches the positive infinity 
and to 0 when ε approaches the negative infinity. 
εε −+= eSigmoid 1
1)(  (22)
 
Finally, each particle’s position is updated according to 
Eq.(23). 
 
 
 
V. CONCLUSION 
Numerous researchers have referred to the capacitated 
production lot-sizing allocation problems as NP-Hard. 
Therefore, it is more difficult to solve the capacitated 
production allocation problem considering some practical 
characteristics, such as allocation problems among 
bottleneck machines, photo masks, and products with 
different re-entrant layers. This study proposed a novel 
variation of the PSO model, which is a binary PSO model 
with adaptable inertia weight and mutation mechanism. It can 
be converted to be able to solve the model of binary decision 
variables. Moreover, it improves some weaknesses as 
opposed to the original version of the PSO, including a 
propensity for obstruction near the optimal solution regions 
that hardly improve solution quality by fine tuning. 
Comparing effectiveness, the traditional PSO, genetic 
algorithm, and the proposed PSO in this paper are compared 
by the production planning problem in the TFT Array process. 
According to the results, it can be concluded that the 
proposed PSO is more effective than the other approaches in 
terms of superiority of solution and required CPU time.  
 
ACKNOWLEDGMENT 
The author gratefully acknowledge the National Science 
Council, Taiwan, R.O.C., for support under contract No. 
NSC 97-2221-E-150-080-MY2.  
 
REFERENCES 
[1] L. Ozdamar and M. A. Bozyel, “The capacitated lot sizing problem 
with overtime decisions and setup times,” IIE Transactions, vol. 32, pp. 
1043–1057, 2000. 
[2] R. Berretta and L. F. Rodrigues, “A memetic algorithm for a multistage 
capacitated lot-sizing problem,” International Journal of Production 
Economics, vol. 87, pp. 67–81, 2004. 
[3] Y. Song and G. H. Chan, “Single item lot-sizing problems with 
backlogging on a single machine at a finite production rate,” European 
Journal of Operational Research, vol. 161, pp. 191–202, 2005. 
[4] M. A. Al-Fawzan, “An algorithm for production planning in a flexible 
production system,” Computers & Industrial Engineering, vol. 48, pp. 
681–691, 2005. 
[5] L. Ozdamar and S. I. Birbil, “Hybrid heuristics for the capacitated lot 
sizing and loading problem with setup times and overtime decisions,” 
European Journal of Operational Research, vol. 110, pp. 525–547, 
1998. 
[6] M. Sambasivan and S. Yahya, “A Lagrangean-based heuristic for 
multi-plant, multi-item, multi-period capacitated lot-sizing problems 
with inter-plant transfers,” Computers & Operations Research, vol. 32, 
pp. 537–555, 2005. 
[7] R. Sridharan, “The capacitated plant location problem,” European 
Journal of Operational Research, vol. 87, pp. 203–213, 1995. 
[8] G. R. Bitran and H. H. Yanasse, “Computational complexity of the 
capacitated lot size problem,” Management Science, vol. 28(10), pp. 
74–86, 1982. 
[9] Y. J. Jang, S. Y. Jang, B. M. Chang, and J. Park, “A combined model of 
network design and production/ distribution planning for a supply 
network,” Computers & Industrial Engineering, vol. 43, pp. 263–281, 
2002. 
[10] Y. H. Lee, S. H. Kim, and C. Moon, “Production-distribution planning 
in supply chain using a hybrid approach,” Production Planning & 
Control, vol.13, pp. 35–46, 2002. 
[11] C. Moon, J. Kim, and S. Hur, “Integrated process planning and 
scheduling with minimizing total tardiness in multi-plants supply 
chain,” Computers & Industrial Engineering, vol. 43, pp. 331–349, 
2002. 
[12] W. C. Chiang and R. A. Russell, “Integrating purchasing and routing in 
a propane gas supply chain,” European Journal of Operational 
Research, vol. 154, pp. 710–729, 2004. 
[13] J. Kennedy and R. C. Eberhart, “Particle Swarm Optimization,” In: 
Proceedings of the IEEE International Conference on Neural Networks, 
Piscataway, NJ, 1995, pp. 1942–1948. 
[14] Y. Shi and R. C. Eberhart, “A modified particle swarm optimizer,” In: 
IEEE International Conference on Evolutionary Programming, 
Alaska1, 1998, pp. 69–73. 
[15] R. C. Eberhart and Y. Shi, “Comparison between genetic algorithms 
and particle swarm optimization,” In: Annual Conference on 
Evolutionary Programming, San Diego, 1998, pp. 611–616. 
  
multi-site production, the conceptual model includes warehouse 
positions, plant locations and transportation links between 
plants. Thus the conceptual model can clearly describe the 
practical multi-site production environment. 
 
 
Fig. 1 An analytical framework of multi-site production planning 
 
Buffer Item Operation LocationCalendar  
Fig. 2 Symbols of conception model 
 
In order to present the conceptual model, we develop some 
symbols based on supply chain key model definitions of i2 
software as shown in Fig. 2. The “calendar” symbol represents 
the usage limitation of finite resource buffers, and the “buffer” 
symbol stands for the resource buffers or temporal buffers in 
manufacturing processes. The “item” symbol describes 
materials, semi-finished goods or finished goods, and the SKU 
(stock keeping unit) is a mixture of combining the buffer and 
item. The “operation” symbol indicates an activity, for example, 
manufacturing or assembly. Finally, the “location” symbol 
describes the geographical positions. 
The multi-site conceptual model can be distinguished three 
classes: external (serial chain), dyadic (parallel chain) and 
network. Because there are so many multi-site models in the real 
world that this paper just interprets and analyzes the major 
multi-site conceptual structure, including the seven multi-site 
conceptual models called respectively from Type A to Type G. 
The examples of the external conceptual model are Type A 
and Type B. Type A is shown in Fig. 3. The plants in Type A are 
located in the same place. When the materials are delivered to 
the warehouse of upstream plants, the plant will start to produce 
the products. After finishing the semi-finished goods, the plants 
will deliver the semi-finished goods to the downstream plants. 
Because all of the plants in Type A are in the same place, the 
transportation between plants is not required. The transportation 
operation in our research represents the products or materials 
transported between different places geographically rather than 
the same location. 
 
   
Fig. 3 Multi site conceptual model of Type A 
The multi-site conceptual model of type B is as showed in 
Fig. 4. The mainly different point between Type A and Type B 
is that the upstream and downstream plants are located in 
different places geographically. 
  
Fig. 4 Multi site conceptual model of Type B 
 
Type B requires the transportation operation to transfer the 
semi-finished goods from upstream to downstream plants. Thus 
the multi-site planning in Type B needs to consider the 
transportation planning between sites. The transportation 
planning may consider some constraints, for example, whether 
the transportation planning will be influenced by the planning 
output time of upstream plants, and how to select transportation 
modes subject to the transportation calendar etc. 
 
  
Fig. 5 Multi site conceptual model of Type C 
 
 
Fig. 6 Multi site conceptual model of Type D 
 
The major types of the dyadic (parallel) model are showed in 
the Fig. 5 and Fig. 6, called Type C and Type D. The multiple 
plants are located in the same place in Type C. Thus there are 
not transportation operations in Type C. When the related 
materials are delivered to the warehouses of plants, the plants 
can start to produce the finished goods rather than the 
semi-finished goods. In Type C, the order allocation problem 
needs to be considered. That is, how to allocate the production 
quantities of customer orders to the appropriate plants for 
fulfilling the due dates of orders is the critical planning decision. 
The multi-site conceptual model of Type D is as showed in 
Fig. 6. The multiple manufacturing plants are located in 
different places geographically. Thus in Type D, the 
transportation operation planning needs to be considered. In 
other words, the materials are directly delivered to the local 
warehouses of different plants. The planners must to decide the 
allocation problem of related materials among multiple 
warehouses. 
The network models are showed in Fig. 7, Fig. 8 and Fig. 9, 
called Type E, Type F and Type G respectively. The network 
model is a mixture of the external (serial) and dyadic (parallel) 
World Academy of Science, Engineering and Technology 65 2010
936
  
We review the related literatures: 
 External (serial) multi-site, considering transportation 
planning 
Huang [4] addressed the external (serial) multi-site structure 
model and considered the transportation planning operations 
among plants. The multi-site environment focuses on the Array 
and Cell processes in the TFT-LCD industry. 
 External (serial) multi-site, not considering transportation 
planning 
Gnoni et al. [5] studied the external (serial) multi-site model 
in the automobile industry. This paper planed that how many 
quantity will be produced in every production period of each 
plant in the multi-site environment. The goal is to achieve the 
balance between supply and demand. 
 Dyadic (parallel) multi-site, considering transportation 
planning 
Timpe and Kallrath [6] discussed the dyadic (parallel) 
multi-site model in the chemical industry. The multi-site model 
considered the transportation planning. The plants have the 
same manufacturing processes so that they can produce the 
same products. And these plants have the complementary 
relationship. All plants can independently produce the products 
from raw materials to finished goods. These plants are located 
in Europe, the Unite States and Asia. The planners must decide 
which products or what quantities will be delivered to other 
sales regions to sell. 
 Dyadic (parallel) multi-site, not considering transportation 
planning 
Moon et al. [7] proposed the dyadic (parallel) multi-site 
model and this category don’t consider the transportation 
planning among plants. The transportation activity planning 
considered in this paper is the transmission of products between 
machines within a certain plant or plants for a quite short time.  
 Network multi-site, considering transportation planning 
Jang et al. [8] depicted the network multi-site model and the 
model incorporates transportation planning. The authors define 
the elements of the multi-site structure are plant (P), warehouse 
(W), distribution (D) and customer (C). They divided the 
network multi-site model into P-P-P model, P-P-W model and 
W-D-C model for discussion. For example, the P-P-W model 
decided the production quantity in each plant, stock quantity in 
each warehouse and transportation quantities between sites. 
 Network multi-site, not considering transportation planning 
Leachman et al. [9] addressed the network multi-site model in 
the semiconductor industry. This network multi-site structure 
includes five manufacturing processes: wafer fabrication, wafer 
probe, assembly, initial test and finial test. These five segments 
are located in different plants. And they have the sequential 
relationship. The authors employ the IMPReSS (Integrated 
Manufacturing Production Requirement Scheduling System) to 
plan the semiconductor multi-site planning problem. The 
IMPReSS divided five modules: test requirements planner, die 
requirements planner, front-end requirements planner 
(capacitated loading and allocation to back ends), back end 
capacitated loading, and availability calendar. 
E. Manufacturing capability and characteristics 
Every plant based on different products and production 
strategies has the different manufacturing facilities and 
production characteristics. The manufacturing process 
generally can be divided three types: flow shop manufacturing, 
job shop manufacturing and fixed site manufacturing. The 
multi-site production planning will be influenced by the 
above-mentioned manufacturing process and production 
strategy. 
Each product has the different production characteristics and 
manufacturing lead time. There will also have distinct qualities 
of the same products due to different machines whose functions 
are the same. Even though the plants have the same 
manufacturing process or machines, the qualities of products 
will be different. For example, two plants have the same 
production processes but they are located in different places 
geographically. They will produce the different qualities of 
products. Therefore, the planners need to understand the 
manufacturing capability and characteristics of each plant 
before engaging in the multi-site production planning problem. 
F. Production constraints 
The production constraint is one of the major factors to 
influence the multi-site planning. The production constraints 
can be classified as the hard constraints and soft constraints. The 
hard constraint is defined it can not be violated, for example, the 
arrival time of materials, capacity usage constraints etc. And the 
soft constraint is defined it can be released or violated flexibly if 
necessary, e.g., the due date of products. Thus the production 
planning constraints in the different industries are distinct. 
Every industry has own specific constraints. 
G. Performance indicators 
Performance indicators are the target of multi-site production 
planning problem. The performance indicators selected depend 
on the various industries and production environments. In the 
past literatures, the performance indicators can be divided four 
categories: Due Date, Flow Time, Work Center Utilization and 
Cost. 
The target pursued of the multi-site planning problem in the 
literatures is almost to minimize the total costs. The costs 
include the production cost, the set-up cost, the inventory 
holding cost, and the transportation cost etc. The researches 
whose targets are to maximize profits or to minimize the 
tardiness time are few. If the target is to minimize the total costs, 
most of the planning methods in the past researches are the 
mathematic programming or operations research. 
III. CASE: A TFT-LCD MANUFACTURER 
In this section, we take a practical example of a TFT-LCD 
(Thin Film Transistor-Liquid Crystal Display) manufacturer in 
Taiwan to illustrate our proposed analytical framework of the 
multi-site planning problem. First, we give the background 
description. And then, we explain sequentially the six elements 
of the framework by means of the TFT-LCD industry. 
World Academy of Science, Engineering and Technology 65 2010
938
  
D. The mathematical model  
Generally, the sales department receives the future monthly 
forecast demands (e.g., six months). The forecast demands of 
the different customers are aggregated according to the various 
TFT-LCD products. Then, the personnel in the production 
planning department allocate the forecast demands to the 
multiple plants by the respective months. 
Allocation decisions among multi-plant are made in terms of 
established decision criteria (i.e., the related costs), for 
example, production costs, products inventory costs, key 
materials purchase costs, and transportation costs between 
factories and distribution centers. Other decision considerations 
include the capacity constraints in each plant, key materials’ 
supplying constraints and the constraints of manufacturing 
process’s paths. 
 The multi-site planning model can be formulated by the 
mathematical programming considering multiple practical 
planning characteristics and constraints. Here, the linear 
programming (LP) model is illustrated, as follows: 
  Indices 
t = period index of monthly time-bucket (t=1,2,…,T). 
p = product index (p=1,2,…,P). 
i, j = production plant index (i, j=1,2,…,N. Here, N stands for 
the total numbers of plants). 
k = raw material index (k=1,2,…,K). 
A = set of plants in the first production stage. 
Z = set of plants in the final production stage. 
F(i),F(j) = set of plants in the previous production stage of plant 
i and j, respectively. 
L(i),L(j) = set of plants in the next production stage of plant i 
and j, respectively. 
 Parameters 
dipt= demand of product p at plant i in period t. 
bomipk= number of units of material k used to make a unit of 
product p at plant i. 
ydit= the yield rate at plant i in period t. 
cpipt= unit cost of production for product p at plant i in period t. 
chipt= unit cost of inventory for product p at plant i in period t. 
csipt= unit cost of shortage for product p at plant i in period t. 
cbkt= unit cost of purchase for raw material k in period t. 
cmkt= unit cost of inventory for raw material k in period t. 
ctijt= unit cost of transportation between plant i and j in period t. 
capit= available capacity for production at plant i in period t. 
unitip= the converted production unit for product p at plant i. 
LTi= the production lead time for making one unit at plant i. 
BTk= the purchase lead time for raw material k. 
DTt= number of days included in period t. 
 Decision variables 
Qipt= production amounts of product p at plant i in period t. 
Bikt= purchase amounts of raw material k at plant i in period t. 
Iipt= amounts of end of period inventory of product p at plant i in 
period t. 
Uipt= backorder amounts of product p at plant i in period t. 
Mikt= amounts of end of period inventory of material k at plant i 
in period t. 
Tijpt= amounts of product p transported between plant i and j in 
period t. 
QFipt= intermediate variables standing for the output in period t 
from the release production in period t-1. 
QPipt= intermediate variables standing for the output in period t 
from the release production in period t. 
 Objective function 
The total costs considered include as follows: the production 
cost of each plant, the storage cost of products, the shortage cost 
of unfulfilled demands, the purchase cost and storage cost of 
raw materials, and the delivery cost of transporting 
semi-products between plants. Then, the objective (1) is to 
minimize the above-mentioned total costs. 
 Constraints 
 
Constraints (2)–(3) indicate the production features in the 
TFT-LCD manufacturing process. Due to the lengthy 
manufacturing lead time, e.g., 5-7 days in the Array process, the 
release production quantities in the present time-bucket will 
output partially into the current time-bucket and subsequent 
time-bucket, respectively. Note that the term “unit” means the 
production unit. The production unit in the Array process is a 
“cassette (or lot)” that includes about 20 glass substrates. After 
entering the Cell process, a glass substrate is split into six or 
eight pieces through partition operation. They are split 
according to “economic cutting size” (that is, minimizing the 
percentage of discarding a useless part of one glass substrate), 
affected by the different sizes of substrates and various 
( ) ( )
( )
( )∑ ∑ ∑∑
∑∑∑
∑∑∑∑∑∑
∉ ∉
∈
+
++
++
Zii Ajj p t
ijptijt
i k t
iktktiktkt
Zi p t
iptipt
i p t
iptiptiptipt
Tct
McmBcb
UcsIchQcpMin
, ,  
 (1) 
tpiunitydQ
DT
LT
QF iptitip
t
i
ipt ,,1,1,
1
∀×××





= −−
−  
(2) 
tpiunitydQ
DT
LTDT
QP ipitipt
t
it
ipt ,,∀×××




 −
=
 
(3) 
( ) tpZiiTQPQFII
iLj
ijptiptipttipipt ,),(
)(
1, ∉∀−++= ∑
∈
−
 
(4) 
( ) dUUQPQFII ipttipiptiptipttipipt 1,1, −−+++= −−
 
(5) 
( ) tkiQbomBMM
p
iptipkbttiktikikt k
,,,1, ∀×−+= ∑−−
 
(6) 
tpAjjTQ
jFi
ijptjpt ,),(
)(
∉∀= ∑
∈  
(7) 
ticapQ it
p
ipt ,∀≤∑
 
(8) 
tpiUIQ iptiptipt ,,0,, ∀≥  (9) 
tkiMB iktikt ,,0, ∀≥  (10) 
tpjiTijpt ,,,0 ∀≥  (11) 
World Academy of Science, Engineering and Technology 65 2010
940
無研發成果推廣資料 
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
無 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
