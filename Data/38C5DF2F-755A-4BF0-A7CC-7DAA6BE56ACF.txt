 I
目 錄 
 
中文摘要:....................................................................................................................................... II 
英文摘要:....................................................................................................................................... II 
一、前言:......................................................................................................................................... 1 
二、研究目的:................................................................................................................................. 1 
三、研究方法:................................................................................................................................. 2 
3.1、FxLMS .................................................................................................................................... 3 
3.2、FxRLS ..................................................................................................................................... 4 
3.3、FuRLMS.................................................................................................................................. 5 
3.4、Lattice ANC (use LMS algorithm) ......................................................................................... 6 
四、結果與討論:............................................................................................................................. 7 
4.1、結果:........................................................................................................................................ 7 
4.1.1、FxLMS副程式 ..................................................................................................................... 7 
4.1.2、FxRLS副程式 ...................................................................................................................... 8 
4.1.3、FuRLMS副程式................................................................................................................... 8 
4.1.4、Lattice ANC(使用LMS演算法)副程式 .............................................................................. 8 
4.1.5、以圖形程式來設計模擬介面.............................................................................................. 9 
4.2、討論:....................................................................................................................................... 9 
計畫成果自評:................................................................................................................................. 9 
參考文獻:....................................................................................................................................... 10 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 1
一、前言: 
 噪音的干擾是無所不在的，無論是工廠的大型噪音、交通噪音或是吵雜的環境噪音（如
餐廳、公共場所等等）總是讓人覺得心裡不舒服，過去研究發現並提出討論，噪音的干擾
將導致生理或是心裡的疾病，特別是對聽覺造成難以彌補的聽力損失(BERGLUND et al., 
1996)。針對工廠大型噪音均有許多文獻提出相關的技術研究與方法，期望降低大型噪音增
進聽力品質並維持身心健康，或者是，一般認為遠離工廠噪音到音量較小的辦公室做事應
該可以抒解噪音的困擾，然而，噪音並不是音量越高就影響越大，低噪音干擾同樣不可忽
視。空調、電腦主機運轉、風扇、傳真機的嗡嗡聲及鍵盤聲等音量並不大，但多種聲音組
合起來對人體將會產生沒有規律的刺激，在有噪聲辦公室裏工作的人，時間長了會引發心
臟或其他心血管疾病(VIRGINIA , 2001)。一項實際研究更表示(EVANS and JOHNSON, 
2000)，在開放式的辦公室裡，微量的噪音就會導致工作壓力增加甚至危害健康。這項研究
成果中指出，研究人員對 40 名女文書人員進行了實驗，一組被派到真正安靜的辦公室工
作，一組被派到有辦公室噪音的地方工作。3 個小時後，研究人員採集她們的尿液進行分
析並發現-那些在辦公室噪音中工作的人體內腎上腺素水平相當高，證明他們感覺到了很大
的壓力。所以，腎上腺素水平過高，患心臟病的危險就會增大，也再次證明上段文章的論
點。Makley (MAKLEY, 1985)也提出研究，辦公室噪音將會導致工作生產力降低百分之 40，
並且在工作中對於數據的處理錯誤也將增加百分之 27。因此，在辦公室裏，人們往往只注
意他們的工作任務與工作的壓力，卻忽略掉了這個威脅上班族健康的隱形殺手-辦公室噪
音。所以，本計畫將針對辦公室噪音提出有效的噪音消除解決策略。 
 過去針對噪音消除的方法大部分分成兩大類，一種是被動式(PNC)與主動式噪音消除 
(ANC)。被動式的方法是用隔離或是吸收的材料阻絕噪音對外的影響，這種方法若要完全
阻絕噪音，需要花費相當昂貴的材料費用，並且一般對於中高頻的效果較好，低頻的效果
較差，這是因為低頻噪音有比較長的波長。然而，很多環境噪音與工廠噪音，其主要的頻
率分佈主要是座落在低頻的部分，因此，為了有效降低低頻噪音的干擾，另外一種被成為
主動噪音消除技術就被提出。主動噪音的基本原理是以控制系統驅動揚聲器，揚聲器產生
與噪音相位相反但振福相同的聲波聲音來抵消噪音的聲波，使聲場的聲波總和為零，這是
以改變聲場或抵消聲場而達到減低噪音的方法。過去主動噪音控制成功應用在侷限空間的
噪音控制，如管路(BURGESS, 1981;WANG et al., 1997; KAJIKAWA and NOMURA, 2001; 
ELLIOTT , 2006; JONES et al., 2007)、車子排氣管(SANO et al., 1994; LEE et al., 2000)、飛機
座椅(ELIOTT and NELSON, 1993)與耳機(WANG and TSE 1996; BRAMMER et al., 1997; 
GAN et al., 1999; RAFAELY, 2000; SONG et al.,2005; GAN et al.,2005; BAI and LIN, 2007)
等。這幾年來，主動式消除耳機是其中最廣泛的商品，其目的就是運用破壞性干涉的原理
來抵消低頻噪音，其主要應付的是工廠的大型噪音或是飛機艙的噪音，而佩戴者仍能聽見
人們的交談聲與工廠警報聲。 
二、研究目的: 
 主動噪音消除系統的發展如圖一，主要分成四大部分，前置參考麥克風(reference 
microphone)、主動噪音消除控制器(ANC controller)、反噪音消除喇叭(canceling speaker)、
誤差估測麥克風(error microphone)。參考麥克風主要收集接收噪音源的訊號，消除區的誤差
估測麥克風主要接收與觀測殘餘之噪音訊號，這兩者的訊號，經過 ANC 控制器內部演算法
調適後，驅動反噪音消除喇叭產生反噪音 
1997; KUO et al., 1997; WANG and REN, 1999; BOUCHARD； QUEDNAU, 2000; LEE et al., 
2000；VEENA and NARASIMHAN, 2004 and SONG and KUO, 2005)，主要的方法是 FxLMS，
FuRLMS，Lattice ANC 與 FxRLS，透過噪音辨識器可以選擇適合的噪音消除演算法，
以產生反噪音訊號 y(n)使得殘餘訊號 e(n)得以衰減，得到靜音狀態。 
∑
−
+( )P z( )x n ( )d n ( )e n
FxLMS
FxRLS
FuRLMS
Lattice ANC
Noise
identifier
Algorithm selector
( )y n
 
圖三、可適應性噪音消除平台示意圖 
 過去 LMS 演算法的對於噪音消除速度較慢(收斂速度)，但其計算量較小，穩定度也較
高，相對於其他標榜收斂速度快但計算量大的演算法來說，仍舊以 LMS 為基本的演算法最
常引用也比較實際，過去以不同的數位濾波器架構分成 FxLMS、FuRLMS、lattice-ANC 
systems，若 W(z)濾波器為 FIR 濾波器並且加入第二路徑的評估，則一般文獻稱為 FxLMS
演算法。 
 以下為我們在第一年計畫針對四種演算法的推導與整理，以提供後續程式開發之參考。 
3.1、FxLMS 
 3
( )y n
( )S z
∑
−
+
( )W z
LMS
( )P z
( )x n ( )d n ( )e n
( )
ˆ( )S z -1Iz
∑
×( )k n′
( )x n′
( )x n
( )y n( )w n
( 1)w n + +
+
( )S z
+- ( )e n
( )d n
Ｇain
Update
∑( )W z
( )y n′
( )P z
 
( )y n′
ˆ( )S z
x n′
圖四、FxLMS 於前饋式的架構圖         圖五、FxRLS 於前饋式的架構圖 
[ ] . )(  theof  valuesquare mean  theis )(E    where                    
10010 size, step                       
               length)filter  stimation pathe-secondary , taps(i.e.ofnumber                        
length)filter  adaptive , taps(i.e.ofnumber :
22 nxnxP
LP
.
μ
LP
.
M
 LParameter
x
xx
=
<<=
=
=•
μ
)( )()()1(
 vectorghtingfilter wei adaptive  the Upate3.
))P(()(-)P(            
)())P((1
))P(()()P(-)P(            
)())P((
))P(()()P(-)P(
)1P(
)()(P)(
)()(P
1)()(P)(
)()(P)(
Then
)Q()1 P(and )1Q()P(Let,
1)-)Q(()(-1)-Q()Q(
)()1(Q)(
)()1(Q
1)()1(Q)(
)()1(Q)(
)()(ˆ)()(ˆ)(
)()()()()(
)()()()(
signalerror   theCompute 2.
1.0 factor, forgettinga  is   theand
 -10 (n). sampledata input a  of  variance theis   where, where
I,  P(0)
)matrix P(0 ncorrelatio inverse and  0,n at time 0(0)filter  adaptiveSet  : 1.
:algorithm  FxRLS theofSummary 
1-1-
1-
1-
1-
1
1
1-1-
1
1
1
0
1
0
22
1-
nenkn wnw
nnxnkn
nxnnx
nnxnxnn
nxnnx
nnxnxnn
n
nxnnx
nxn
nxnnx
nxnnk
nnn-n
nnxnknn
nxnnx
nxn
nxnnx
nxnnk
n-kxnsnxnsnx
n-lxnwnxnwny
nyn-sndne
x σμσ
wtionInitializa
T
T
T
T
T
TT
T
TT
M-
k
k
L-
l
l
T
x
α
x
′+=+
′′=
′+
′=
⎟⎟⎠
⎞
⎜⎜⎝
⎛
′+
′′
=+
+′′
′=+′′
′=′
=+=
′′=
+′−′
′−=+′−′
′−=′
=∗≡′
==
∗=
<≤
≥>=
=
==
−
−
−
−
=
=
∑
∑
λλ
λ
λλ
λ
λ
λλ
λ
λλ
λλ
λ
λλ
αδ
δ
λ
 
3.3、FuRLMS 
( )S z
∑
LMS
( )x n
( )y n
ˆ( )S z
LMS
( )P z
B(z)
ˆ( )S z
∑
A(z) +
+
+
−
( )x n′
( )e n
( )y n′
(n)y′ˆ
( )d n
 
圖六、FuRLMS 於前饋式的架構圖 
               length)filter  stimation pathe-secondary , taps(i.e.ofnumber                        
length)filter  adaptive , taps(i.e. B(Z)ofnumber                       
length)filter  adaptive , taps(i.e.A(Z) ofnumber :
=
=
=•
M
I
 LParameter
 
 5
[ ]
         
110 . at time )(ˆfilter  stimation pathe-secondary oft coefficien  theis )(ˆ           
            110 at time )(filter  adaptive oft coefficien  theis)(            
 1-0,1,..., . at timet coefficien reflection  theis)(            
1-0,1,..., . at timeerror  prediction backward  theis)(            
1-0,1,..., .  at timeerror  prediction forward  theis )(            
. at time )(plant  wnoˆunkn of responsed desire )(           
)()()(                    
. at timeor input vect- tap1-by -)( Given  
 :
110
,M-,,mnzSns 
,L-,,n. lzWnw
Llnnk
Llnnb
Llnnf
nzPn d
nx,n, xnx
n Lnx
Data
m
l
l
l
l
T
L-
L
L
L
==
==
==
==
==
=
=
=
•
 
1,...,1,0),()( )()1(
1,...,2,1)],()()1()([)()1(
10 refactor whe smoothing  theis   theand ,
)(ˆ
)( where
1,...,2,1)],1()([)1(ˆ)1()(ˆ
 vectorghtingfilter wei adaptive  the Upate3.
1,...,2,1),()(ˆ)()(ˆ)(
)()()()()(
)()()()(
)()()(
1,...,2,1),()()1()(
1,...,2,1),1()()()(
signalerror   theCompute 2.
 and  0,n at time 0(0)filter  adaptiveSet  : 1.
:algorithm  LMS Lattice theofSummary 
11
1
2
1
2
1
0
1
0
00
11
11
−=′+=+
−=+−+=+
<<<=
−=−++−−=
−==∗≡′
==
∗=
==
−=−−=
−=−−=
==
−−
−−
=
=
−−
−−
∑
∑
Llnenbnwnw
Llnfnbnbnfunknk
nP
unu
LlnbnfnPnP
Lln-mbnsnbnsnb
nbnwnbnwny
nyn-sndne
nxnbnf
Llnfnknbnb
Llnbnknfnf
LwtionInitializa
lll
lllllll
l
l
llll
l
M-
m
mll
l
L-
l
l
T
llll
llll
μ
αα
αα
μ
 
四、結果與討論: 
4.1、結果: 
 我們以圖控程式開發上述四種演算法，這是因為該語言適合用來模擬與整合我們要的
平台，以下為我們各自做成四種演算法的副程式以提供未來系統測試使用。 
4.1.1、FxLMS 副程式 
 
圖九、 FxLMS 的程式圖 
 7
4.1.5、以圖形程式來設計模擬介面 
 
圖十三、演算法模擬整合程式圖 
4.2、討論: 
 第一年計畫主要的工作在於找尋四種演算法的推導方式，我們著重在於前饋式的方式
進行，主動噪音消除的架構有別於適應性噪音消除技術乃在於主動噪音消除在架構的設計
上必須考量第二路徑的濾波器的效應，即架構圖上的 S(z)，在一般適應性的演算法資料中，
是不需要考量與加入的，因此，我們的系統在演算法的整理過程花費較多時間。 
 從演算的方程式中可以看到 FxLMS 演算法是最簡單的一種，數位訊號處理器要實現是
相當容易，而 FxRLS 是演算法中使用矩陣運算較煩雜的一種，FuRLMS 事實上是另一種
LMS 演算法但是以 IIR 的架構來設計，主要在於彌補 FIR 在對於寬訊號所需的濾波器階數
較多的缺點，所以在實現性上面也較有機會，但是否穩定於未來我們將測試的訊號則有待
評估，另外，Lattice 的架構有別於 FIR 與 IIR，也是使用 LMS 演算法，但是從我們設計的程
式的過程，發現該演算法應當可以消除較多具 harmonic 的訊號，但付出的代價是需要更多
濾波器，因此，在實現我們認為負擔會較重。但整體來說，我們提出的是一種可以多種適
應辦公室噪音的平台，用最適合的演算法消除適合的噪音，因此，本年度主要開發演算法
的進度工作來說，一切進度都是符合跟合理的。 
 
計畫成果自評: 
 本計劃提出的目的之ㄧ是希望能夠在本人剛建立實驗室時，能夠具備完整的開發演算
的能力，雖然在開發新型演算法上能力與支援稍嫌不足，但是我們期望透過開發前人的演
算法以磨練自己在演算法的推導與實現，同時能夠找出更符合演算法應用的方向，事實上，
我們的確透過此次計畫，找到另一個題材，也協助本人在產學計畫找出一個方向，同時也
提出一個新型專利，我認為在該計畫執行面上，我們已經達到第一年度的工作預期，後續
第二、三年有幸能通過計畫時，我們將會透過各種實際模擬，找出該系統的應用極限度以
及使用面，相信在學術上或是在未來產學開發應用上，能有更大的助益，也感謝國科會給
與本人此次機會。 
 
 
 
 
 9
附件二 可供推廣之研發成果資料表 
□ 可申請專利  □ 可技術移轉                                    日期：2008 年 12 月 30 日 
國科會補助計畫 
計畫名稱：辦公室噪音之適應性主動噪音消除技術開發(I) 
計畫主持人：林俊宏         
計畫編號：辦公室噪音之適應性主動噪音消除技術開發(I)    
學門領域：醫用電子  
技術/創作名稱  
發明人/創作人  
中文： 
 
 
（100~500 字） 
技術說明 英文： 
可利用之產業 
及 
可開發之產品 
 
技術特點 
 
推廣及運用的價值 
 
 
 11
場聆聽。 
第三天 8/6(週三)：這是大會正式研討會活動的第二天，同樣在早上也是安排了一場大約
兩小時的 Keynote Presentation，換了第二位的主持人，同樣介紹了很多 NI 未來的新產品，由
其是有關(1)RF & Wireless Communication Summit (2)Robotics Summit (3)Sound & Vibration 
Summit (4) Vision Summit 等。晚上，大會更為來賓們安排了一場重金屬樂團的演唱會，讓大
家除了嚴肅的研討會活動外，也有放鬆的活動安排。 
第四天 8/7(週四)：這是大會的最後一天，早上照例有一場 Keynote Presentation，但這次
請了一位學者蒞臨演講，會後並安排來賓搭巴士到 NI 總公司參觀，之後，下午一直到 3:15
方結束大會所有議程。本團隊立即於下午 4:00 搭上往機場的九人巴士，愉快而疲倦踏上歸途。 
 
   本次大會議程共規劃有以下幾項主題(Program Contents)，茲整理如下：  
z Conference Highlights 
Letter from Dr. James Truchard 
Keynote Presentation 
Conference information 
Evening Activities 
Networking Activities 
Must-See and Hands-On sessions 
z Technical Summits 
RF & Wireless Communication Summit 
Robotics Summit 
Sound & Vibration Summit 
Vision Summit 
z Technical Tracks 
Embedded Design Track  
Industry and Automation Track 
Software Development Techniques Track 
Test and Data Acquisition Track 
z Special Events 
Medical Device Workshop 
Training and Certification 
IEEE Wireless Hive Networks Conference 
Graphical System Design Achievement Awards  
z Exhibition and Sponsors 
 
二、參觀商品展示會場 
    本次參展單位全部都是與 NI 軟硬體產品相關的廠商與研究機構，盛況空前，從書面資料
所統計的攤位數，超過 100 個以上，現場實品展示，參觀人數眾多。 (缺照片) 
 
三、攜回資料名稱及內容 
(1) 2008 NIWeek Worldwide Graphical System Design Conference Program 
(2) The related exhibitor’s data sheets and DM. (FIRST Competition) 
 
