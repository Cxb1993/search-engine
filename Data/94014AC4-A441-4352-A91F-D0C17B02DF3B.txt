 在同質多核心平台， ARM11 
MPCore 的效能測試與耗能推估的測
試計劃，將執行數個測試程式，並觀
察出程式效能與 CPU 耗能的關係，達
到順利進行測試工作之目的。而在異
質平台多核心平台，則是觀測RSIC與
DSP同時執行程式，及其個別核心上的
執行緒作的溝通所需的耗能及其效
能。 
 
2. 量測環境 
2.1  ARM MP Core 同質多核心平台 
 同質多核心平台ARM11 MP Core
上的作業系統為 Linux kernel 2.6.19 
with SMP，能與ARM11 MP Core在個人
電腦上利用超級終端機透過RS232與
其相連。另外，為了便於測試程式的
編譯及執行，ARM11 MP Core的檔案系
統是利用個人電腦架設虛擬機器上的
ubuntu Linux，從中開啟一個網路檔案
系統(NFS)，讓ARM11 MP Core上執行的
Linux kernel能掛到NFS，所以我們只需
要利用虛擬機器，在上面編譯完我們
需要的程式後，將可執行檔複製到NFS
內就可以透過超級終端機，讓ARM11 
MP Core執行我們的程式。 
 在ARM11 MP Core平台上量測的
工具，為本團隊自行開發的程式，主
要是利用patch Linux kernel，新增我們
需要的系統呼叫。透過這些系統呼叫
去抓去平台執行程式的若干資料再做
分析。 
 
2.2  TI DaVinci 異質多核心平台 
 在異質多核心方面，TI DaVinci是
採用TI公司所提供的SoC analyzer，能夠
追蹤ARM及DSP在執行程式時所發生
的事件，像是中斷(interrupt)，或是分
頁錯誤(page fault)，除此之外也能提供
ARM或是DSP在執行的時間或是閒置
的時間，能藉此了解各核心的總處理
時間。測量環境的設置上大致與
ARM11 MP Core相同，除了須安裝SoC 
analyzer在個人電腦上，還要在 TI 
DaVinci上執行web server，才能讓SoC 
analyzer在程式執行時進行的一些資訊
收集完後，傳回個人電腦上做分析。 
 
2.3  TI OMAP 異質多核心平台 
 TI OMAP其量測環境與TI DaVinci
大致相同，而其資料蒐集工具，也是
由本團隊自行開發。主要是觀測當
ARM與DSP的執行緒做溝通時，所需花
費的耗能與其效能的優劣。關於行程
通訊 (IPC)這個部份，本團隊是採用
Nokia公司所維護的軟體架構(Gateway)
來做IPC，為了評估此架構的效能及耗
電，本團隊對Gateway做了修改，能夠
在程式執行的時候，抓取到每個階段
所耗費的時間，並加以分析。 
 
3.  實作原理 
3.1  ARM MP Core 同質多核心平台 
 在同質多核心系統上，本團隊所
開發之工具，主要是依據過去對RISC
處理器，如ARM處理器，的觀測與分
析，得知在此種架構下每一道指令的
耗電量幾乎是一樣，也就是可以量出
一道指令的平均耗電，再計算出所要
執行的指令數目，將兩者相乘便可以
得到程式真正由硬體執行時所需的耗
電量。 
 此外，因執行緒並非在每個時間
點都是處於執行狀態，也就是有可能
因為其他的因素造成阻塞(Block)，如與
外界做I/O或不再擁有處理器時間(CPU 
Time)，都有可能會進入阻塞的狀態，
所以我們也必須將執行緒處於阻塞的
情況納入考量，量測出當執行緒被
block住時每單位時間的耗電量，就可
以效法執行緒在執行程式與其執行時
間相乘的方式，得到執行緒被block時
的耗電。 
 
3.2  TI OMAP 異質多核心平台 
 而在異質多核心系統如本團隊此
次 所 量 測 的 平 台 TI OMAP 與 TI 
DaVinci，皆由一顆ARM與一顆DSP所組
式區間的執行時間(1，2，4，5為ARM 
active period，3 為ARM idle period) 
AR M AP
L inux/DS P  
G ateway
DS P  G ateway
Driver
DS P  AP
DS P  
B IO S /DS P  
G ateway
IS R





 
圖 1 
 
表格 1 
 Current(mA) Power(mW) 
Active 
state 
135 216 
Idle state 95 152 
 
由最後所得的數據得知 Block 的
執行時間比 word 的執行時間長。故
Block 的總耗能值比的 word 總耗能值
大。由於資料量大的執行時間比資料
量小的執行時間長，故資料量大的總
耗能值比資料量小的總耗能值大。 
 
4.3  TI DaVinci 異質多核心平台 
主要是在 ARM 與 DSP 端之間，
比較 AAC與 H.264 兩種不同演算法。 
利用程式在各段區間所消耗時間與對
應的耗能值算出 ARM 處理器的耗能
多寡。 
下圖2為利用 SOC Analyzer記錄各
段程式區間的執行時間 (1 為 ARM 
active period  2， 3，4，5 為 ARM idle 
period) 
AR M AP
L ib
L inux/DS P  
L ink
DS P  AP
DS P  
B IO S /DS P  
L ink
IS R





 
圖 2 
 
表格 2 
 Current (mA) Power 
(mW) 
Active 
state 
135 216 
Idle state 95 152 
 
另外在 ARM與 DSP端之間傳輸各
種大小不同的資料，比較各段所需的
時間與 ARM處理器在測試過程中的耗
能(表格 2)。 
利用 SOC Analyzer 記錄各段程式
區間的執行時間 (1 為 ARM active 
period  2， 3，4，5 為 ARM idle period)  
因資料量大的執行時間比資料量
小的執行時間長，故資料量大的總耗
能值比的資料量小總耗能值大。 
 
5. 結果分析 
5.1 ARM11 MPCORE 的效能測試與耗
能推估 
下表3為ARM11 MPCore 上的MP11 
CPU 在各種模式下的耗能，接著我們
假設，執行一個執行緒時，CPU 處於 
run mode，而當一個執行緒被阻塞
時，CPU 處於 WFI mode。 
 
本實驗藉著改變在兩個處理器間
傳送的資料大小， 觀察各區段時間花
費的變化情形，如表觀察所得黃色區
塊在資料超過 128KB 以上有明顯增
加，這一部份是 ARM端將資料從 Linux 
的 user space 複製到 kernel space以及
執行 DSP Gateway的程式碼，而綠色區
塊也在超過 64KB 以上就有顯著的增
大，顯然傳送的過程在處理更大量資
料需要較長的時間，推估能量的消
耗，如最右一欄所示，當處理的資料
量越大，處理時間越長，耗能越多。
測試分析如表格 9。 
 
5.3 異質多核心平台 TI DaVinci的效能
測試與耗能推估 
5.3.1 AAC/H.264 Performance 
本實驗分別測試 AAC與 H.264兩
種不同的演算法，測試在 ARM與 DSP
之間傳送的各區段時間花費，結果如
表格 ，由於 AAC 與 H.264 演算法不
同，故花費的時間，耗能也有差異，
測試分析如表格 10。 
5.3.2 IPC Size VS. Perormance 
本實驗藉著改變在兩個處理器間
交換的資料大小， 觀察各區段時間花
費的變化情形，如表格 觀察所得綠 
色區塊在資料超過 64KB以上幾乎成倍
數增加，這一部份是 DSP從 ARM端將
資料收進來，準備進行處理，而藍色
區塊也在超過 64KB以上就有顯著的增
加，顯然處理更大量資料需要較長的
時間，推估能量的消耗如最右一欄所
示，當處理的資料量越大，處理時間
越長，耗能越多，測試分析如表格 11。 
 
6.  結論 
本計畫希望藉由團隊在耗電量測
與分析的經驗與環境建置，整合嵌入
式網路通訊裝置的耗電分析、測試之
環境與設備，並建立一套完整的自動
化耗電量測環境，能在開發初期就提
供對使用者設計之系統的耗電報告，
讓使用者對其所設計之系統針對耗電
較高的部分做改善而不需到後期才能
估算耗量，而需要耗費更高的成本去
做修改。 
本計畫第一年的重點在於學習與
了解不同種類的多核心平台並學習量
測程式在不同階段執行時所需的時
間，再透過處理器在不同狀態下所消
耗的能量，來達成耗能的推估。 
下一階段將以第一年的經驗與基
礎，更精確的以量測實際的電壓與電
流，逼近更真確的耗能數值。 
 
 
表格 8 Word/Block Data Transfer 效能與耗能表 
   
 
        Energy 
Word 0.029 5.1 4.8 5.2 5.6 4.170264 
Block 0.031 14.9 4.9 9.4 5.7 7.231496 
Unit ： 1~5 : millisecond  ; Energy :  mJ 
 
表格 10  AAC/H.264 效率與耗能表 
   
 
        Energy 
AAC 0.317 0.015 0.042 0.85 0.098 0.221232 
H.264 0.368 0.02 0.158 15.854 0.091 2.530184 
Unit ： 1~5 : millisecond  ; Energy :  mJ 
出席國際學術會議心得報告 
                                                             
計畫編號 96-2218-E-009-015 
計畫名稱 嵌入式網路通訊裝置測試中心：方法與工具之實驗、開發與推廣--子計畫
一：嵌入式網路通訊裝置耗電分析與評比工具之設計與開發 
出國人員姓名 
服務機關及職稱 
黃承威 交通大學 資訊科學與工程研究所 博士生 
會議時間地點 2008/9/8~2008/9/12 
會議名稱 ARTIST2 Summer School 2008 in Europe 
發表論文題目  
 
一、參加會議經過 
本次會議的主辦單位為 ARTIST2 NoE (Network of Excellence) on Embedded Systems 
Design.這是一個歐洲跨國性的大學及研究機構合作組織，希望能夠強化歐洲在嵌入式系
統設計領域的研究潛力，及促成多種可能出現的新興跨領域應用。在這個組織底下，規
畫了以下七個主要的研究議題: Modeling and Components, Hard Real-Time, Adaptive 
Real-Time, Compilers and Timing Analysis, Execution Platforms, Control for Embedded 
Systems, Testing and Verification. 每年，本組織皆會藉由舉辦多種會議及暑期學校，讓參
與計畫的學術機構的研究人員及學生，以及計畫外但有興趣了解的其他學術機構人員，
能夠在短期間內，聚集在一起，頻繁地交流，交換意見，了解不同領域的發展，探討可
能的合作機會，並且展示過去一段期間的研究成果。 
 希望能夠藉由這些手段，提升歐洲在此領域的研發創造實力，可以與美國先進研發
重鎮如 Berkeley, Stanford, MIT, Carnegie Mellon等著名學府，在知識的傳播、產業界的影
響力上，並駕齊驅。 
 
