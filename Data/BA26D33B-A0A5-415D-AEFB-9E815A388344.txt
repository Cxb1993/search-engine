to access a service provided by a host or 
server.  In an instance, some of the connected 
hosts might have an external connection to 
the Internet. Such nodes may announce this 
ability as a service to the participating ad hoc 
nodes. Using service discovery, members of 
the MANET are then able to use such a 
gateway service. 
Currently, several industry consortiums 
or organizations develop and standardize 
different service discovery protocols 
[2][5][12][15][16]. These systems were not 
designed for wireless mobile ad hoc net-
works and are, therefore, not suited for dy-
namic and infrastructure-less networks.  
The major challenges for a service dis-
covery system are listed in blown. 
 The topology of MANET is dynami-
cally deployed. The service discovery 
protocol is both minimizing the traffic 
generated by the discovery process and 
tolerating the intermittent connectivity 
of devices. 
 The mobile device suffers from limited 
capabilities, such as a smaller radio 
propagation range, bandwidth limita-
tions, battery power consumption and 
capacity of memory. The service dis-
covery protocol minimizes the resource 
consumption of mobile device. 
 Scalability of service discovery in 
MANETs is a challenge. MANET is 
applied to a public place, such as collo-
quium, zoo, downtown, great exhibition 
and metropolitan area, etc. It support the 
large class of applications envisioned 
for MANETs, in areas as diverse as 
military operations and rescue missions. 
三、研究方法及成果 
In this project, we present an efficient 
service discovery protocol in grid-based ar-
chitecture for ad hoc networks, here called 
SGrid. 
The geographic area of MANET is con-
sidered as a 2D logical grid [6][9]. In our ap-
proach, we present a hierarchical mechanism 
to identify the grid level. Each grid elects a 
node to act a directory that caches the avail-
able service descriptions. When a provider 
wants to share its service, it registers its ser-
vice into the directories. A node queries the 
directories to obtain the service information 
while a node desires to access a service. We 
propose a transmission trajectory to increase 
the efficiency of register and that of discov-
ery. The transmission trajectory orders the 
packets to transmit along a predefined direc-
tion. Our approach not only increases the 
success ratio of discovery but also reduce the 
number of directories and traffic overhead. In 
addition, we solve the interrupting of trans-
mission trajectory while there are void grids 
in the low-node-density network. Void grid 
often appears in low-node-density network 
and no node exists in a void grid. 
We present the detail of our proposed 
protocol that includes directory selection, 
service register and service discovery phase. 
(一)  Hierarchical Grid Architecture 
For service discovery, each node shares 
a common ontology to express the service 
types. To be location-aware, each mobile 
host equips a device such as a GPS receiver 
or other location-aware devices that can read 
its current location. The grid model has be 
presented in [6][9]. The geographic area of 
MANET is partitioned into 2D logical grids 
as illustrated in Fig. 1.  
 
Fig. 1：Logical grids to partition a physical 
Each grid is a square and its size is d×d. 
The area of network is constituted by N×N 
grids. We assume that grid(x, y) is the 
grid-coordinates. A node can transfer the 
physical-coordinates to the grid-coordinates 
via a predefined mapping while it acquires 
 2
The directory selection process is ad-
dressed in below. When no directory is in a 
grid, the node in the center of grid will be-
come the directory. Fig. 5 (a) illustrates an 
example for directory selection. When node 
A is in the center of grid and no directory 
exists in this grid, node A broadcasts Hello(A, 
x, y, D) to announce that it is a directory. 
Other nodes know that node A is the closest 
node to the center of grid, so they broadcast 
Hello(id, x, y, N). The dynamical is the very 
natural in MANETs. Nodes may enter or 
leave a grid at any time. To reduce the 
change frequency of directory, the selection 
is executed again while the original directory 
already left the grid or insufficient resources 
to support. In Fig. 5 (b), node A has already 
left the center of grid and it is still in the grid. 
Node A is still the directory because it has 
not left the grid. Node B has not announced 
that it is the new directory, because B knows 
that node A is still in the grid. If node A has 
left the grid, node B announces that it is the 
new directory. 
 
Fig. 5：An example of directory selection 
Our approach is based on the soft state 
principle. Service providers periodically reg-
ister the service type or types they offer. 
These registers are transmitted along the reg-
ister trajectory. Each directory stores recently 
received register. After a timeout, registers 
simply expire if they are not updated. When 
the original directory has left the grid or has 
not acted the directory, it still keeps the ser-
vice descriptions in its service table until the 
time is expired. 
(三)  Service Register Phase 
For not relying on the broadcasting 
method, we proposed a geographic transmis-
sion trajectory to register service. When a 
provider wants to share its service, it issues a 
register packet to advertise its service along a 
register trajectory periodically. When a di-
rectory receives the register packet, it caches 
the service descriptions in its service table. 
Finally, the service descriptions are regis-
tered to a group of directories that are in the 
center line of network. 
Two basic transmission directions are 
vertical (towards south and north) and hori-
zontal direction (towards east and west). The 
rules of register trajectory are that the trans-
mission direction is the same in the same grid 
level lv and that is changed while the trans-
mission enters the grid level lv+1. 
2
3
4
5
6
7
1
1 2 3 4 5 6 7
(a)
A
2
3
4
5
6
7
1
1 2 3 4 5 6 7
B
(b)
Geographic Point Grid Level 0 Grid Level 1 Register Trajectory
(c)
2
3
4
5
6
7
1
1 2 3 4 5 6 7
C
(d)
2
3
4
5
6
7
1
1 2 3 4 5 6 7
D
 
Fig. 6：The register trajectory of region (normal di-
rection) 
We separately discuss the register tra-
jectories that are issued by grid level 0 and 
other grid level. The register trajectory from 
grid level 0 has four types shown in Fig. 6. 
The initially transmission direction of region 
A of grid level 1 is horizontal. The provider 
first selects two geographic points as destina-
tions and delivers register packet to there by 
geographical routing. We illustrate an exam-
ple in Fig. 6 (a). We assume that Z = 3, L = 1 
and a provider in grid(2, 6). The provider se-
lects two geographic points that are on the 
left side of grid(1, 6) and the right side of 
grid(4, 6). In geographical routing, a node 
picks the node closest to the destination as 
relay node while it wants to deliver the 
packet to the geographic point. The detail of 
picking method is described later. 
The relay node forwards the packet to 
 4
location of delivery, rele is the relay node in 
the east, gpe is the east geographic point, w is 
the west, s is the south, n is the north. 
2
3
4
5
6
7
1
1 2 3 4 5 6 7
F1
Geographic Point
Grid Level 0
Register Trajectory
Grid Level 1
Node
Directory
Relay Node
Registered Directory 
Provider
P F2 F3
F4
F5
F6
F7
F8
F9
 
Fig. 9：An example for register 
When a node receives a register packet, 
it sets dlv as next node to pvd. This routing 
information is kept in routing table. If the 
received node is a directory, it keeps the in-
formation of P and service descriptions in its 
service table. When the received node is one 
of relay nodes, it checks if it is in the grid of 
geographic point. If no, it continues to de-
liver the register packet to the geographic 
point. While n is in the grid of geographic 
point, it checks if the transmission direction 
of n and pvd are the same. If yes, n broad-
casts the register packet to its neighbors. E.g. 
F1 in grid(1,6) receives the register packet and 
it is the relw, so the transmission directions of 
F1 and P are the same. If the transmission 
directions of n and P are not the same, n 
computes two new geographic points on the 
grid level and delivers register packet to 
there. 
If some providers share the same service 
type, the same service descriptions are regis-
tered to network. To reduce the overhead for 
registering the same service, a directory stops 
to deliver the register while it has the same 
service register within a predefined period. 
When a directory receives a register packet 
and it is the relay node, it first checks its ser-
vice table whether the same service type had 
been registered in the same trajectory or not. 
If yes, the directory caches the information of 
provider in its service table but it does not 
need to deliver the packet to the same trans-
mission direction. If no, the directory caches 
and delivers the register. 
(四)  Service Discovery Phase 
We assume that each node can obtain 
the size information of network from net-
work. So each node computes and knows the 
position of the highest level grid. A seeker 
delivers the discovery packet toward the 
highest level grid. The discovery trajectories 
are shown in Fig. 10. E.g. a requestor is at 
the region A of the highest level. The dis-
covery directions are toward the east and the 
south. The routing in discovery trajectory is 
the same as that in register trajectory. When 
the discovery arrives in the highest level grid, 
it will be stopped. The range of discovery is 
confined to a region of the highest grid level. 
If a directory receives the discovery packet 
and it has the available service description, it 
returns a reply packet to the requestor. The 
reply packet includes the provider informa-
tion. The reply packet is returned along the 
discovery path. 
2
3
4
5
6
7
1
1 2 3 4 5 6 7
(a)
A
2
3
4
5
6
7
1
1 2 3 4 5 6 7
B
(b)
2
3
4
5
6
7
1
1 2 3 4 5 6 7
D
(d)
2
3
4
5
6
7
1
1 2 3 4 5 6 7
C
(c)
Geographic Point
Grid Level 0
Discovery Trajectory
Grid Level 1
 
Fig. 10：the discovery trajectories in the different 
region 
A complete example for service discov-
ery is illustrated in Fig. 11. We assume that 
requestors Q and R desire to access a service 
that is provided by P. R is a directory and it 
has the available service description. So R 
requests P to provide the service immediately. 
The routing between requestor and provider 
can use any geographic routing protocol. 
Another requestor Q does not search out the 
available service information so it issues a 
packet to discover the service provider. The 
format of discovery packet is discovery<type, 
req, sdreq, locreq, dlv, locdlv, rele, gpe, relw, gpw, 
rels, gps, reln, gpn>. 
 6
23
4
5
6
7
1
1 2 3 4 5 6 7
(b)
2
3
4
5
6
7
1
1 2 3 4 5 6 7
(a)
Geographic Point
Grid Level 0
Register Trajectory
(Normal Direction)
Register Trajectory
(Reversely Direction)
Grid Level 1
Void Grid
 
Fig. 13：An example for the register and discovery in 
an empty region 
(六)  Simulation Results 
Our service discovery algorithm SGrid 
is compared with GCLP [14]. The simula-
tions use CMU’s wireless extensions [1] for 
the ns2 [4] simulator. Each radio's range is 
approximately a disc with a 250 meter radius. 
The simulations use 2 Megabit per second 
radios. Each simulation runs for 300 simu-
lated seconds. We vary the mobile nodes 
from 150 to 300 nodes. The square area is 
1200 m. We assume that grid level (L) is 1 
and the highest grid level in the center of 
network. In our scenario, we simulate 10 ser-
vice types and the each service type is pro-
vided by 3 providers. Any node may be a 
requestor except provider. Each requestor 
selects a random service at a random time. 
And then a requestor will not inquire the 
same service twice in a simulation run. We 
use the random waypoint model (RWP) [7] 
as the mobility model 
In geographic routing protocol, we em-
ploy the node nearest to destination to for-
ward the packet. When F wants to forward 
packet to destination D, it picks N to relay 
packet. N is one of F’s neighbors and it is the 
closest node to D. In this method, the routing 
is broken easily while the topology of net-
work changed. Therefore, we allow the re-
questor retransmits the request packet to the 
provider while the requestor has not received 
the reply from the provider. We called this 
method as shortest distance routing (SDR). 
Fig. 14 (a) shows the success ratio. The 
success ratio is the ratio of the total number 
of req_ack packets that received by request-
ors to the total number of service invocations. 
The curve of success ratio drops if the mobil-
ity is increased. The mobility affects the sta-
bility of routing, so the discovery in the high 
mobility environment may be to fail. Our ap-
proach has higher success ratio than GCLP, 
especially in the high mobility. The success 
ratio of SGrid in 30m/s is higher by 4.77% 
than that of GCLP. In Fig. 14 (b), the dis-
covery ratio of SGrid is lower than that of 
GCLP. In GCLP, nodes of neighboring the 
trajectory have to cache the service registers. 
In SGrid, only a directory has to cache the 
service registers in each grid. Therefore, 
SGrid saves more storage of nodes than 
GCLP. 
Fig. 14 (c) and (d) shows the overhead 
of service discovery protocols. The overhead 
of packet types are similar except that of 
discovery type. This is because that GCLP 
discovers the desired service along four tra-
jectories and the cached directories have to 
reply the provider information to the re-
questor when they received the discovery 
packet. The discovery of SGrid is confined in 
a region of the highest grid level, because the 
requestor discovers the service toward the 
highest grid level. A small number of dis-
covery packets are delivered in SGrid. In ad-
dition, the number of reply packets in SGrid 
is also less than that in GCLP. Therefore, 
SGrid saves more discovery overhead than 
GCLP. GCLP with high mobility increases 
the overhead in discovery process. The re-
questor has to rediscover the service even 
though it cached the registers. All cached 
registers are not refreshed by next register, so 
some data are out-of-data. If the requestor 
obtains the out-of-data information, it cannot 
access the provider successfully. In the rout-
ing of SDR, the requestor can rediscover the 
desired service 3 times while it has not ac-
cessed the service within 5 sec. Therefore, 
GCLP has to rediscover the desired service 
and it spends more time to discover service. 
We observe this result in Fig. 14 (e), espe-
cially in high mobility. 
We vary the number of nodes from 100 
to 300 nodes and assume that node velocity 
is 20m/s. Fig. 15 shows the results of varying 
the number of nodes. The curve of success 
 8
