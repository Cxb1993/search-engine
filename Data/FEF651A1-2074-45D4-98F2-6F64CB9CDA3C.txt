build monitoring system for the use of elderly  
anytime, anywhere. It can provide necessary 
information feedback to users as well as necessary 
assistance and emergency services. It can be used on 
the elderly and disabled persons to enhance the 
quality of human life. 
 
Along with the same design goals with the main 
project, in the first year, we emphasis ourselves on 
the zigbee network planning optimization in order to 
meet the long-term, real-time and reliable 
transmission goals.  
We used the evolutionary algorithms for network 
planning and optimization of wireless sensor networks. 
The main problem is divided into two parts, the first 
part is to minimize the number of active sensors under 
the constraint of full coverage , the second part is 
how to optimize their routing path. We use genetic 
algorithms to find the active sensors, and we use 
genetic programming method to find the optimal routing 
paths.  
 
On the second year, we continued our research on this 
subject, we proposed a scheme called the intelligent 
context aggregation agent (ICAA) mechanism to reduce 
unnecessary transmission costs and thus achieve the 
goal of power saving. In the third year we focused on 
the ECG signal acquisition and system platform 
development. The results is publised on the IEEE 
Intelligent Systems (SCI 2009 IF = 3.144, Rank 12/246 
(4.87%) in Engineering, Electrical &amp； Electronic), 
June 2011. 
In the third year, we emphasized on design of 
appropriate algorithms for the accuracy of ECG bio-
signal processing and performance analysis. In 
addition, our application moved from the desktop 
toward portable use. In this year we analyzed the 
biomedical signal processing algorithms, especially on 
the enhancement of the accuracy for ECG signals. In 
addition, the SW/HW integration of an portable ECG 
monitoring systems is also published on ISBB 2011 
conference.  
 1 
 
行政院國家科學委員會補助專題研究計畫 
□成果報告   
■結 案 報 告 
 
※※※※※※※※※※※※※※※※※※※※※※※※※※※                   
 互動式智慧型健康照護與晶片系統－ 
      子計畫三：智慧型異質通訊之互動式服務技術(3/3)                
※※※※※※※※※※※※※※※※※※※※※※※※※※※ 
 
計畫類別：■個別型計畫   □整合型計畫 
計畫編號：NSC99－2220－E－194－003- 
執行期間： 99 年 8 月 1 日  至   100 年 7 月 31 日 
 
執行機構及系所：國立中正大學 電機工程學系 
 
計畫主持人：陳  煥 副教授 
 
共同主持人：鄭伯炤 副教授 
 
計畫參與人員：葉錫勳、施弘佑、蕭惠陽、沈之中 
 
成果報告類型(依經費核定清單規定繳交)：□精簡報告  ■完整報告 
 
本計畫除繳交成果報告外，另頇繳交以下出國心得報告： 
□赴國外出差或研習心得報告 
□赴大陸地區出差或研習心得報告 
■出席國際學術會議心得報告 
□國際合作研究計畫國外研究報告 
 
處理方式：除列管計畫及下列情形者外，得立即公開查詢 
            □涉及專利或其他智慧財產權，□一年□二年後可公開查 
 
中 華 民 國    100 年 10 月 20 日 
 
 
附件一 
 3 
zigbee network planning optimization in order to meet 
the long-term, real-time and reliable transmission 
goals.  
We used the evolutionary algorithms for network 
planning and optimization of wireless sensor networks. 
The main problem is divided into two parts, the first 
part is to minimize the number of active sensors under 
the constraint of full coverage , the second part is how 
to optimize their routing path. We use genetic 
algorithms to find the active sensors, and we use 
genetic programming method to find the optimal 
routing paths.  
 
On the second year, we continued our research on 
this subject, we proposed a scheme called the 
intelligent context aggregation agent (ICAA) 
mechanism to reduce unnecessary transmission costs 
and thus achieve the goal of power saving. In the third 
year we focused on the ECG signal acquisition and 
system platform development. The results is publised 
on the IEEE Intelligent Systems (SCI 2009 IF = 3.144, 
Rank 12/246 (4.87%) in Engineering, Electrical & 
Electronic), June 2011. 
In the third year, we emphasized on design of 
appropriate algorithms for the accuracy of ECG 
bio-signal processing and performance analysis. In 
addition, our application moved from the desktop 
toward portable use. In this year we analyzed the 
biomedical signal processing algorithms, especially on 
the enhancement of the accuracy for ECG signals. In 
addition, the SW/HW integration of an portable ECG 
monitoring systems is also published on ISBB 2011 
conference.  
To sum up, we have fruitful outcomes from this 
3-year project, especially on publications and potential 
prototype products. We are expecting to develop a 
new product that can go onto "CLOUD" to provide 
users with more accessible services anytime. 
 
第三年成果報告分為下列三部分: 
 
壹、可攜性 ECG 訊號截取、處理平台與遠端
健康照護系統 
貳、生醫訊號處理演算法對於心率變異度之準
確度比較與效能分析 
參、ISBB 2011 論文發表原文 
 
------------------------------------------------------------ 
壹、 可攜性 ECG 訊號截取、處理平
台與遠端健康照護系統 
------------------------------------------------------------------- 
 
本計畫的目的在實現可攜式居家照護裝置
與健康管理系統，建立具可攜性與方便性的 
ECG 訊號收集儲存裝置與易於管理監護的軟體
系統。可攜式的實作平台我們採用德州儀器
(Texas Instruments, TI)16 位元的 MSP430 系列
微控制器，此系列控制器超低功耗的設計而且低
單價，模組化體積小，非常符合可攜特性。另外
其核心為 RISC 架構可大幅縮小程式長度，利
於開發。資料的儲存則是搭配 SD Card 模組來
實現，利用多媒體數位儲存卡的輕薄特性，便於
資料的擷取儲存。透過前端硬體所收集儲存的 
ECG 訊號資料，可匯入後端 PC 軟體系統，將
資料送往雲端資料庫儲存記錄，透過簡易操作的
系統軟體讓使用者可瀏覽了解自身身體狀況，並
提供護理人員做長期追蹤與治療的依據。 
綜合以上的討論，本計畫的研究需求在致力
可攜、長效(long-time)、可靠的 ECG 訊號擷取
與儲存平台的實作，並整合後端資訊儲存管理平
台。 
I. 硬體環境 
ECG 訊號擷取儲存系統的硬體主要為訊號
放大器與 TI 的 MSP430F149 為控制器的搭配，
最後微控制器藉由 SPI 介面與 SD 模組建立
溝通，將 ECG 訊號儲存至 SD 卡。 
 
MSP430F149 Module 
 
採用 TI 的 MSP430F149單晶片模組，此系
列晶片具超低功耗與低單價的特性，功耗分別為
1.6uA(待機模式)、0.1uA(關閉模式)、280uA (活
動模式)[3-1]，功能模組包含：中斷功能、基礎
時鐘、看門狗定時器、兩個計時器、8通道的12
位元 ADC、2個通用串列同步通訊介面(提供 
SPI/UART 模式)...等[3-2]。 
 
 5 
制傳輸(3)SD 卡資料格式設定與儲存，其各步驟
的處理與執行方法如下描述。 
1.1. 心電訊號擷取與儲存實現流程 
A. 取樣計時器的設定 
MSP430F149的取樣計時器有四種運作模式，
停止(stop)、上升(up)、連續(continuous)、上升/
下降(up/down)模式，運作模式可以由 MCx 位
元來選擇。本研究在此使用上升模式並且實現用 
PWM 產生固定週期來當 ADC 的取樣時脈源。
如果計數器週期頇要不同於0FFFFh 的計數，就
使用上升模式，計數器會重複往上計數，直到 
TACCR0比較器的值，所以此運作模式定義了週
期時間如圖7： 
 
 
  
 
 
在這個週期裡計數的臨界值是 TACCR0+1，
當計數的值大於 TACCR0，計數器就會從0從新
開始。PWM 信號是一種有固定週期但週期內的
信號比是可以程式規劃，如下圖8： 
 
 
 
 
B. ADC 取樣 
MSP430F149的類比轉數位訊號為 ADC12，
並支援有四種模式可以轉換，單通道轉換一次、
順序通道轉換一次、單通道多次轉換、順序通道
多次轉換，藉由 CONSEQx 位元可以選擇。本
論文使用重複單通道轉換來使類比轉數位訊號，
重複單通道轉換是單一通道做連續取樣和轉換，
並把轉換結果儲存到  CSTARTADD x定義的 
ADC12MEMx 記憶體，而且轉換完成後必頇馬
上 讀 出 轉 換 值 ， 因 為 只 有 使 用 一 個 
ADC12MEMx，不讀出會被下一次轉換的值覆蓋
過去。如果要停止 ADC12轉換是根據運作的不
同而不同，在單通道單次轉換的時候，重置
(RESET) ENC 可以立即停止轉換，但轉換結果
是不可預料的，為了得到正確結果，可以先判斷 
ADC 轉換訊號是否忙碌，再清除 ENC。在單通
道連續轉換的時候，重置(RESET) ENC 就可以
立即停止當前的轉換。在順序通道連續轉換的時
候，重置 ENC 就可以立即停止當前的轉換。 
C. SPI 設定與初始化 
使用 MSP430F149 SPI Bus 頇要先設定所
提供 USART 腳位，可以藉由 PUC(Power Up 
Clear)或 SWRST(Software Reset)位元來重新設
置。USART 在 PUC 之後，SWRST 位元就會
自動設置而且一直保持在一個重新設置的狀態，
清除 SWRST 才會釋放 USART 的運作。 
 
固定周期 
不同信號比 
TACCR0 
TACCR1 
PWM 
波形 
TACCR0 
0FFFFh 
0h 
圖 3.5 上升模式取樣 
圖 3.6 PWM 信號 
 
圖 3.7 TimerA 產生的 PWM 
 7 
 
FAT16格式有提供基本上層的函式功能，創
建檔案函式 CreateFile()、開啟檔案 OpenFile()、
讀寫檔案函式  Read/Write File()、刪除檔案 
Delete()等，這樣就可以進行  SD Card上的讀
寫。 
SD Card 的讀寫頇要先送出要讀寫的位址，
再分別傳送讀寫命令 CMD17和 CMD24，讀寫
前要先將 CS 腳位設為低電位，另外傳送資料
前面要加上 Read/Write Data Token，傳送的資料
後面要加 CRC 校正碼。讀寫後再將 CS 腳位
置為高電位。 
 
1.2. 實作結果 
 
上圖是使用 MSP430F149 MCU 已拉出腳
位的模組平台和 SD 卡轉接模組，實現擷取與
儲存功能。 
2. 軟硬體架構的整合實現 
2.1. 系統架構 
A. MSP430 訊號擷取與儲存(居家照護裝置) 
 
圖 3.12 實作架構圖 
如上圖示，本系統使用Lead I導程量測 ECG 
訊號，先將電極片貼置左(+)右(-)上肢，右腳接
地輔助穩定波形，接著ECG 生理訊號由感應節
點輸入至訊號放大模組做訊號的濾波與放大來
使訊號易於後續處理，放大後的訊號會經由電位
移板將訊號由正負電位轉至正電位，以便訊號進
行訊號的轉換。 
當訊號輸入至 TI的MSP430F149，內部計數
器固定產生 PWM 產生固定周期去觸發 ADC 
模組擷取 ECG 訊號，ADC 模組每次擷取到一
筆類比資料就轉換成數位 ECG 資料並觸發中
Start 
Block Address 
CMD24 
CS Low 
Data token 0xFE 
512bytes data 
CRC 2bytes 
CS High 
Boot Sector 引導磁區 
Master FAT 主要 FAT 表 
Slave FAT 次要 FAT 表 
File Directory Table 檔案目錄表 
Data 數據資料 
圖 3.9 FAT16 結構 
圖 3.10 SD 卡寫入命令運作流程 
圖 3.11 心電量測平台 
 9 
次測量的詳細記錄。最下方是該次使用者的 
ECG 圖表，中間左方有一個該次 SDNN 的和
平均 SDNN 的比較圖，中間右方是 LF 和 HF 
的比例圖，最上方的資料裡有提供該次判斷出來
的病症次數各種病症出現的次數。 
圖15則是歷史報表記錄中間部分我們提供
使用者的 SDNN 的變化曲線圖，下方部分則是
平均心跳圖。使用者或醫護人員可根據曲線圖的
變化來判斷是否有某種疾病的症狀。 
 
 
圖 3.15 照護端 Interface  
若照護者研判頇通知使用者至醫院檢查，可
以按下右上方寄送通知，會自動開啟郵件寄送畫
面，如圖16，系統會自動寄送郵件到受看護者註
冊時所填入的信箱。 
 
 
圖 3.16 e-mail 通知介面 
 
圖17為一般使用者操作的介面，每當使用者
需要將測量儲存的 ECG 訊號匯入系統時，需要
輸入一組帳號密碼登入自己的帳戶，之後便可在
左半部看到使用者資料之後按下左上方的輸入
圖樣即可將 ECG 訊號匯入系統，也可以點選介
面中報表的圖案觀看自己的歷次 ECG 生理訊
號建康報表。 
 
 
圖 3.17 Client Interface 
  
 11 
60Hz 部分被去除掉；其原始訊號為在 MIT-BIH
編號為 100 之時域訊號，並且只擷取 1 分鐘之訊
號來模擬。 
梳狀濾波器 [2]是用來濾除某個特定低頻整
數倍頻率，意即只讓特定頻率範圍的信號通過，
由於頻率間隔排列相同，所以在特性曲線中長得
像梳子；欲實作整係數濾波器[12]，必頇整合全
通濾波器與梳狀濾波器(Comb Filter)，其流程圖
如圖 3 所示，我們使用全通濾波器
1H 與梳型濾波
器
2H 相減，則得到消除基線漂移與工頻訊號的
整係數濾波輸出
21 HHH  ： 
_
梳狀濾波器(H2)
ECG訊號(S)
消除基線漂移
ECG訊號(H)
S
+
全通濾波器(H1)
 
圖 2、整係數濾波器去除基線漂移與工頻之流程圖 
工業頻率(通常稱為工頻)干擾，在台灣地區
為 60Hz；為了確保整係數濾波器在 60Hz 作用，
取樣頻率頇為 60 的整數倍。則由章節 3.2 所示，
於 MIT-BIH 擷取訊號之取樣頻率 sf 為 360Hz，
截止頻率
pf 為 60Hz，則 6
60
360

p
s
f
f
k  
由於欲設計二階濾波器則 m=2，令 krq / 為
整數倍則 60r ，而 106/60 q ，將公式
m
k
rmkr
z
z
q
zzH )
1
11
()( 2
)(




 代入以上值並經
過整理後，所設計之濾波器為：
2
6
60
54 )
1
1
10
1
()(






z
z
zzH 。 
其微分方程式為：
2])6[]60[]54[(
100
1
]54[][


nxnxnx
nxny
 
 
而在實際實作時頇將微分方程式分步計算
以避免 x[n+6]取不到值，第一步為
]6[]60[][][ 11  nynxnxny ；第二步為
]6[]60[][][ 2112  nynynyny ；最後取得之
輸出
100
][
]54[][ 2
ny
nxny  。 
模擬結果如圖 6- 1 所示，其中圖 4(a)為整係
數數字濾波器之輸入訊號，而 4(b)為整係數數字
濾波器之輸出訊號，360Hz 之整係數數字濾波器
延遲時間為 54。將其濾波結果於 Matlab 利用
DFT 得到頻域訊號，圖 4(c)為未通過整係數濾波
器之 DFT 結果，而如圖 4(d)所示通過整係數濾
波器之 DFT 其 60Hz 的雜訊被濾除掉。 
(a) 
 
(b) 
 
(c) 
 
(d) 
 
圖 3、去除工頻雜訊之傅立葉轉換比較 
 
5. 去除基線漂移濾波器之比較： 
在 ECG 訊號處理去除基線漂移通常為整係
數數字濾波器與中值數字濾波器；而比較是需要
一個無基線漂移並乾淨之訊號，故於 Matlab 模
擬利用 MIT-BIH 取 10 筆 1 分鐘記錄作整係數濾
波與 7 點平均濾波產生原始乾淨無雜訊的 ECG
訊號 x(n)，之後由 sine 與 cosine 函數產生人工基
線漂移，圖 5 為 MIT-BIH Record 100 人工雜訊
加上原始乾淨無雜訊資料；最後計算其之交越相
關係數(Cross Correlation Coefficient)。 
 
圖 4、加入人工基線漂移訊號 
中值濾波器(median filter)[3]在 ECG 生理訊
 13 
圖 6、模擬 7 點移動數字濾波器去除毛刺之效果 
 
 
7.QRS Detection 準確率驗證實驗: 
由於 QRS 偵測需要先去除基線漂移與濾除
毛刺訊號，本論文使用整係數數字濾波器去除基
線漂移與七點平均數字濾波器濾除毛刺訊號，再
使用 So-and-Chan 演算法去找 R 波，找到 R 波之
後往前與往後找最低點即為 Q 波與 S 波，故準
確的 R 波偵測是很重要的，而之後在 HRV 頻域
與時域分析中，是將 R-R 區間序列去做計算，
MIT-BIH 病症資料庫有些記錄有描述 R-R 區間
序列，為了驗證 So-and-Chan 在 R-R 序列之正確
性，故將10筆偵測並計算之R-R序列與MIT-BIH
病症資料庫去計算其誤差率，最後將這 10 筆誤
差率去計算平均誤差率，若其 R-R 區間誤差率
並不大(<100ms)的話，即代表 R 波都有擷取到。 
常見的 QRS 偵測有兩種，第一種 QRS 偵測
是由 JIAPU Pan與Willis J. Tompkin於 1985年發
表 Pan and Tompkins method[5]，第二種是 1997
年由 H. H. So 與 K. L. Chan 所提出的 So-and- 
Chan method [6]；而 K.L Tan 與 K.L. Choi 於 2000
年發表了 Pan and Tompkins method 與 So-and- 
Chan method 之比較[7]，Pan and Tompkins 
method 其 R 波準確率 88.96 %，而 So and Chan 
method 其 R 波準確率 95.60 %，由此可得知
So-and-Chan method 準確率是優於 Pan Tompkins 
method 的，故本論文採用 So-and-Chan 方法。 
本模擬跑了 10 筆 Record 則平均誤差率為
(R(1)+…+R(10))/10，最後得出的結果約為
99.945%的準確率。 
8.結論與未來展望 
本論文驗證了 ECG 的濾波部份較適合使用
整係數數字濾波器與中值數字濾波器來去除基
線漂移、工頻與毛刺現象。於本研究中分析並模
擬各濾波器、QRS 偵測法與 HR 分析，以這些理
論與技術為基礎，我提出了幾個接下來可以發展
研究的方向： 
a. QRS 複合波(QRS Complex)分類： 
本篇論文是在說明心率變異分析之演算法，
除了心率變異分析外 ECG 也可拿來作病症分析；
其中 QRS 複合波以波形來說在醫學上有許多種
分類；像是正常心搏、心室前收縮(Ventricular 
Beats)…等；現今有許多相關文獻是在即時偵測
並分類 QRS 複合波是哪一種型態來作更深入之
病症分析與判斷。 
REFERENCE 
[1] Task Force of the European Society of Cardiology the North 
American Society of Pacing and Electrophysiology, “Heart rate 
variability, Standards of Measurement, Physiological Interpretation, 
and Clinical Use”, European Heart Journal, no. 17, 1996, pp. 
354-381. 
[2] 鄒波、周遠，「一種濾除基線漂移和工頻干擾的數字濾波算法」， 
深圳職業技術學院學報，第 4 卷第 4 期，2005 年。 
[3] SK Mitra, “Digital Signal Processing A Computer-Based Approach, 
3/e”,  McGraw-Hill, 1998. 
[4] JIAPU Pan, Willis J. Tompkins, 1985, “A real-time QRS detection 
algorithm”, IEEE Transaction on Boimedical Enginnering, Vol. 32, 
No. 3, 1985,pp. 230-236. 
[5] H.H. So, K.L. Chan, “Development of QRS detection method for 
real-time ambulatory cardiac monitor” , Conference of the IEEE 
Engineering in Medicine and Biology Society., vol. 1, 1997, pp. 
289-292. 
[6] Tan, K F., Chan, K L., Choi, K. “Detection of QRS complex, P wave 
and T wave in electrocardiogram”, IEEE Conference Publication , 
No. 476, 2000, pp. 41-47. 
[7] Lagrange Interpolation, 
https://ccrma.stanford.edu/~jos/Interpolation/Lagrange_Interpolation.
html. 
[8] Sky McKinley, Megan Levine, “Cubic Spline Interpolation”, Ref: 
http://online.redwoods.cc.ca.us/instruct/darnold/laproj/Fall98/SkyMe
g/proj.pdf. 
[9] CJC Kruger, “Constrained Cubic Spline Interpolation”, for Chemical 
Engineering Applications, 2003. 
[10] Kupoi-Heart Rate Variability(HRV) Analysis Software, 
http://bsamig.uku.fi/bssoftware/hrv.shtml. 
[11] G. D. Clifford, “Signal processing methods for heart 
rate variability”, Ph.D. dissertation, University of Oxford, 2002. 
 
 
 
15 
 
 15 
summary of the research contributions. 
  
II. Health care platform 
As shown in Figure 1, this system includes three 
sub-system: (1) Bio-signal acquisition nodes, (2) Care-box 
system and (3) Monitoring Network and Management 
System. The details are described as below.  
 
A. ECG Bio-Signal Acqusition Node  
The bio-signal acquisition node is usually designed to be 
small and portable. As such, the sensor node can be carried 
by a patient. The acquisition node includes patches and ECG 
signal processing unit. Three electrode patches are put on the 
patients, and these patches detect ECG signals from the body. 
The leads placed on the right arm, left arm, and right leg. 
 
 Since the original ECG signal is too weak, (the 
amplitude of about 100uV to 4mV), the system used a power 
amplifier and the built-in 8bits ADC in the Zigbee module 
(FT-2650 Ding Technology development board), to amplify 
the signal and covert it to 0V to 5V digitally. The converted 
digital ECG signals are sent to the Zigbee transmitter for 
sending out. The hardware and firmware on the end-user 
device are put together to provide high quality bio-signal 
acquisition task.  
To make it an ASIC level device, in our previous work 
[4]-[5], a high common-mode rejection ratio (CMRR) 
instrumentation amplifier was developed.  In order to obtain 
a high CMRR, we chose an instrumentation amplifier as the 
preamplifier in the analog front-end system. In this case, an 
instrumentation amplifier with chip INA-128 was used. It not 
only provides a high CMRR (at least 120 dB), it is also 
characterized by high precision, low power consumption, and 
low current. Aside from these, the gain of this amplifier can 
be adjusted to an appropriate level in order to fit the 
operation condition of the chip. 
 
B. Care Box System 
 
After the bio-signals are pre-processed by the 
acquisition node (pre-amplified, noise filtered, and 
A/D converted), they are sent out via the Zigbee 
module to a device called the “Care-box” system. 
This system is usually bigger than sensor nodes but 
has more power and transmission capability. In our 
prototype, the ARM development system (Versatile 
B926EJ-S) was used. This Car-box can collect 
bio-signals in the personal area network (within the 
distance of 10m) and relay these signals to devices 
in a longer distance depending on the network 
technology used (Wired, WLAN; or 3G 
17 
 
 17 
 
2.4GHz
Radio
TX Queue
RX Queue
Analog
Signal
ADC
Data
compress
Hardware
Command/Interrupt
Event 
Queue
Controller
Transmitter
 
Figure 3. Zigbee firmware on the ECG transmitter 
 
  The BioZigbee firmware on ECG transmitter 
consists of the ADC controller and the ECG signal 
processor. The ADC controls the ADC module to 
convert the analog ECG signal to digital data. The 
ECG processor performs the resolution adjustment 
task to match the transmission rate of the data 
transmission. The detailed process flow is 
described below. As shown in Fig. 3, the analog 
ECG signals are first transformed into digital 
signals via ADC, and then stored in the input 
buffer until they are processed by the data 
compressor.  
 
B. Zigbee firmware on the ECG receiver 
 
 
Figure 4. BioZigbee Firmware on the ECG 
Receiver  
 
On the receiver side, we designed and 
implemented the firmware to coordinate the ECG 
communication to avoid collision. As shown in Fig. 
4, events (commends) generated from the hardware 
are queued in the TX queue for transmission. 
 
Data received on the ECG receiver are first 
queued in the RX queue and then forwarded to the 
output buffer for I/O (see the data path). The 
events are scheduled by the controller (the core of 
the ECG coordinator). The controller triggers 
appropriate circuits to perform the tasks in order to 
meet the requirements. In particular, it is 
responsible for the transmission of the ECG signal 
to avoid collision.  
V. Integration of the Care-box system and the 
health care services 
 
Figure 5. Snapshot of the Integrated System 
 
Figure 5 shows the integrated system inclduing  
the (1) Bio-signal acquisition nodes, (2) Care-box 
system and (3) Monitoring Network and 
Management System as shown in Figure 1. The 
Zigbee firmware is designed and implemented 
based on a commercial IP product – FT-6200 from 
Fontal Technology Inc. As shown in Figure 5, the 
bottom two components are a pair of Zigbee 
Transmitter/Receivers. Several modules are built 
on the transmitter and receiver modules 
respectively to realize the communication 
2.4GHz
Radio
TX Queue
RX Queue RS232Output
Receiver
Hardware
Command/Interupt
Evevt Queue
Controller
19 
 
 19 
health status, and allow the medical team to 
understand the patient's recovery status.  
 
In the scenario of home and hospital medical 
care center, we outline the operation interacted 
between the measurement system and monitoring 
system. After the patient put the electrode patches 
correctly on the body, the operation are initiated. 
Once the user starts the measurement of ECG and 
the monitoring system can monitor and record the 
patient’s health condition. Using video steams and 
maps could help system manager understand the 
overall condition of the patient.  
 
VI. Conclusion 
This paper presents a system that can provide a 
better caring service for the cardiac disease 
patients. A prototype comprising the bio-signal 
acquisition node, Care-box and management 
system is designed and implemented. The Zigbee 
wireless technology was used as a low power 
consumption solution and the designed functions 
and required system performance are evaluated. 
The design issue and consideration are introduced 
and discussed in this paper.  Results show the 
hardware and firmware on the end-user device can 
work together very well. In addition, we also 
introduced a PC-based GUI interface that aims to 
provide ECG signal processing task and health 
care video tracking and management functions.  
Acknowledgment 
This research was supported in part by the 
Industrial Technology Research Institute and 
National Science Council (NSC) in Taiwan under 
the grant numbers 100-2220-E-194-004. 
References 
[1] BioSenseTek, http://www.biosensetek.com/ 
[2] North-vision, http://www.north-vision.com/north-vision.htm 
[3]  IMEC Annual report 2010, 
http://www2.imec.be/content/user/File/jaarverslag/Annualreport2010.pdf 
[4] S. Y. Lee and C.J. Cheng,”Systematic design and modeling of a OTA-C 
filter for portable ECG detection,” IEEE Trans. On Biomedical Circuits 
Syst., vol.3, no.1, pp. 53-64, Feb. 2009. 
[5] S. Y. Lee, C. J. Cheng, C. P. Wang, and W. C. Kao, “Low-power 
signal processing devices for portable ECG detection,” IEEE 
Engineering in Medicine and Biology Society Conference, 20-25 Aug. 
2008,pp. 1683 – 1686. 
  
21 
 
 21 
3. 請依學術成就、技術創新、社會影響等方面，評估研究成果之學術或應用價值（簡要敘述
成果所代表之意義、價值、影響或進一步發展之可能性）（以 500 字為限） 
 
在學術方面: 三年產出 7 篇 SCI papers 與數篇會議論文, 針對如何優化自組態感測網路
(zigbee)規劃，以達到長時間(long‐ term)、及時(real‐ time)且可靠(Reliable)的傳輸提出解決方
法。另外針對如何讓網路整體的存活時間可以達到最長，以提供 ECG 的訊號長時間傳輸的問
題，利用演化式演算法進行網路規劃與優化無線感測網路。解決兩部分問題，第一開啟最小
成本的感測點以達到網路環境全覆蓋，第二開啟的感測點如何進行最佳化的路由。第一個問
題我們使用基因演算法來找出感測點開關的整體最佳解，第二個問題是使用基因規劃法來找
出路由路徑的最佳解。 
在技術創新方面 : 本計畫在三年內開發的智慧型健康監護系統（Smart Healthcare 
Surveillance System)，可隨時隨地監控與檢測病人之心電訊號系統，在整合原型產品上達到低
電壓與低耗電的結果。我們的居家照護設備，開始走向個人行動行的方向，因此發展出可攜
性 ECG 訊號截取與處理平台，同時加強遠端健康照護系統，使之與新一期的整合型計畫目
標一致，在這一年我們也更針對生醫訊號處理的演算法進行整合應用，特別加強心率變異度
之準確度比較與效能分析。最後將嵌入式系統整合展示發表在 ISBB 2011 的會議論文上面。 
在社會影響方面: 配合總計畫之系統應用的開發，相信隨著老年社會的來臨，我們的研
究計畫產出，必能造福更多老人、行動不便人士，提升人類生活品質。遠距醫療的照護，除
了科技面之外，更希望國家能多輔導學界如何與業界的需求結合，並引進企業型的產銷管道，
相信結合產官學界的力量，將研發、生產與銷售的多層面力量結合，必能對國家社會有更深
的影響，造福更多的國人，並能在世界發光，讓全世界都能看到，最後感謝委員的辛勞。 
 
 
  
23 
 
 23 
 
國科會補助專題研究計畫項下出席國際學術會議心得報告 
                              日期：2010 年 11 月 20 日 
                                 
一、 參加會議經過與心得報告 
    國際研討會 The 2010 International Symposium on Communications and Information 
Technologies ; ISCIT 2010）的舉行日期為 2010 年 10 月 26 日至 2010 年 10 月 29 日共
4 天。舉行地點為日本東京明治大學(Meiji University)。明治大學位於日本東京都千代
田區，為日本知名的私立大學。明治大學前身為明治法律學校是 1881 年岸本辰雄、
宮城浩蔵、矢代操設立的。1920 年改稱明治大學。1949 年的學制改革，該校隨之成
為新制大學。明治大學最有名的建築是綜合教學大樓自由之塔，它設有明治大學博物
館（考古司），有許多古文物，散發著濃濃的文藝氣息。 
 此國際研討會於 10/26 舉行會議註冊報到與歡迎會，27 號上午為會議開幕式，
當天有三場專題演講(Keynote Speech)，演講主題跟研究有關的有感測網路的挑戰與
機會 “Wireless Sensors Networks: Challenges and Opportunities”，而此次會議中發
表的眾多論文有涵蓋訊號處理與影像處理方面的研究，包含探討感測網路與 P2P 網路
計畫編號 NSC99－2220－E－194－003 
計畫名稱 互動式智慧型健康照護與晶片系統－ 
     子計畫三：智慧型異質通訊之互動式服務技術(3/3) 
出國人員
姓名 
陳  煥 
服務機構
及職稱 
國立中正大學電機所副教授 
會議時間 
2010年 10月 26日至 
 2010年 10月 29日 
會議地點 
日本東京都千代田區的明治大學 (Meiji 
University) 
會議名稱 
(英文) The 2010 International Symposium on Communications and Information 
Technologies (ISCIT 2010) 
發表論文
題目 
(英文) Building Intrusion Path Graphs for Security Incident Handling Procedures 
附件四 
25 
 
 25 
   
    
27 
 
 27 
 
國科會補助專題研究計畫項下赴國外(或大陸地區)出差或研習心得報告 
                                     日期：   年   
月   日 
                                 
一、國外(大陸)研究過程 
二、研究成果 
三、建議 
四、其他 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
計畫編號 NSC  －    －  －    －    － 
計畫名稱  
出國人員
姓名 
 
服務機構
及職稱 
 
出國時間 
 年 月 日至 
 年 月 日 
出國地點 
 
附件五 
      
International Symposium on Communications 
and Information Technologies 2010 ( ISCIT 2010 ) 
October 26-29, 2010 
Meiji University, Tokyo, Japan 
 
 
Organizing Committee 
Honorary Chair 
Masao Mukaidono 
Meiji University, Japan 
General Chair 
Kaoru Arakawa 
Meiji University, Japan 
General co-Chairs 
Eryk Dutkiewicz 
 Macquarie University, Australia  
Zheng Zhou 
Beijing University of Post & Telecom, 
China 
Kosin Chamnognthai 
KMUTT, Thailand 
Technical Program co-Chairs 
Tetsushi Ikegami 
Meiji University, Japan 
Xiaojing Huang  
CSIRO, Australia 
Zhifeng Zhao  
Zhejiang University, China 
Supavadee Aramvith 
Chulalongkorn University, Thailand 
Publicity co-Chairs 
Masakiyo Suzuki  
Kitami Institute of Technology, Japan 
Le Chung Tran 
University of Wollongong, Australia 
Honggang Zhang 
Zhejiang University, China 
Somkiat Lerkvaranyu 
KMITL, Thailand 
Special Session Chairs 
Akira Taguchi 
Tokyo City University, Japan 
Yoshio Itoh 
Tottori University, Japan 
Publication Chair 
Yoshikazu Miyanaga 
Hokkaido University, Japan 
Local Arrangement Chair 
Yukihiro Iguchi 
Meiji University, Japan 
Finance Chair 
Toshiyuki Tsutsumi 
Meiji University, Japan 
Audio Visual Chair 
Toshiyuki Miyahara 
Meiji University, Japan 
General Secretaries 
Takamichi Saito 
Meiji University, Japan 
Yuko Kawakami 
Meiji University, Japan 
International Steering Committee 
Yoshikazu Miyanaga (Chair), Japan 
Wanlop Surakampontorn, Thailand 
Pansak Siriruchatapong, Thailand 
Yoshio Ito, Japan 
Monai Kaririksh, Thailand 
Toshio Wakabayashi, Japan 
Kobchai Dejhan, Thailand 
Zhou Zheng, China 
Kosin Chamnognthai (Sec.), Thailand 
Honggang Zhang, China 
Shou-Yen Robert Li, Hong Kong 
Wang Xue, China 
David Tay, Australia 
Nobuo Hataoka, Japan 
Kyung-Sup Kwak, Korea 
Somsak Choomchuay, Thailand  
Masakiyo Suzuki, Japan 
Kazuhiko Hamamoto, Japan 
Eryk Dutkiewicz, Australia 
Y Jay Guo, Australia 
 
  Final Call for Papers  
 
The 2010 International Symposium on Communications and Information Technologies will be held 
in Meiji University, Tokyo, Japan. Meiji University is one of major old-established universities in 
Japan, being located in the center of Tokyo, the most exciting city in Asia. The ISCIT presents 
every possibility on new information technologies.  Prospective authors are invited to submit their 
papers reporting original work as well as tutorial overviews in all areas of information technologies 
and communications. The topics for regular sessions include, but are not limited to, the followings: 
 
 
 
Authors are invited to submit a full paper according to posted guidelines. Only electronic 
submissions will be accepted. Authors are expected to present their papers at the Symposium 
upon acceptance and presenting authors are required to register for the Symposium. Accepted 
papers will be included in the IEEE Xplore database and in the Elsevier EI Compendex. 
 
Author’s Schedule: 
Proposal for Special Sessions April 15, 2010 
Deadline for Submission of Full Paper: June 21, 2010 
Notification of Acceptance: August 5, 2010 
Deadline for Submission of Camera Ready Paper: September 1, 2010 
 
General Secretary could be contacted by: 
FAX: +81-44-934-7912   or  Email: iscit@isc.meiji.ac.jp 
Check the symposium website for up-to-date information: 
http://www.isc.meiji.ac.jp/~iscit 
 
                                      
1. Signal Processing 
1.1 Adaptive, Multimedia and Multirate Signal 
Processing  
1.2 Mixed Signal Processing 
1.3 Speech Processing and Coding 
1.4 Video Processing and Coding 
1.5 Digital Filters and Filter Banks 
1.6 Wavelets and Multirate Signal Processing 
1.7 Fast Computations for Signal Processing 
and Communication Systems 
1.8 Intelligent Signal Processing for 
Communications & Systems 
1.9 Security Signal Processing 
1.10 Optical Signal Processing 
1.11 Noise Control 
1.12 Video and Multimedia Technology & 
Communications 
1.13 Audio/Acoustic Signal Processing 
1.14 Others 
2. Communication Systems 
2.1 Communication Theory 
2.2 High Speed Networks 
2.3 Multimedia Services and Technologies 
2.4 Network Management and Design  
2.5 Intelligent Communication Systems and 
Network Protocols 
2.6 Signal Processing for Communications  
2.7 Wireless/Mobile Communications 
2.8 Wideband Communications 
2.9 Ubiquitous Sensor Networks/ Cooperative 
Networks/ Ad-hoc Networks 
2.10 Next-Generation Wireless Internet 
2.11 Others 
3. Computer and Information  
3.1 Artificial Intelligence and Applications 
3.2 Computer Networks 
3.3 Computer Systems and Applications 
3.4 Internet Technologies and Applications 
3.5 Modeling and Simulation  
3.6 Data/Network Security 
3.7 Storage Systems and Techniques 
3.8 System Software 
3.9 Others 
4. Circuits and Systems 
4.1 Analog Circuits, Filters and Data Conversion 
4.2 Analog and Mixed Signal Processing 
4.3 Numerical Methods and Circuit Simulation 
4.4 Circuits and Systems for Communications 
4.5 Neural Networks and Fuzzy Logic Processing 
4.6 Others 
5. VLSI 
5.1 Analog and Digital ICs for Communications 
5.2 Low Power Design & VLSI Physical Synthesis 
5.3 Modeling, Simulation and CAD Tools 
5.4 VLSI Architecture for Signal Processing 
5.6 Others 
6. Information Technologies 
6.1 Embedded Technology 
6.2 Software Development 
6.3 Human Interface 
6.4 Virtual Reality and Mixed Reality 
6.5 Education and E-learning 
6.6 Others 
7. Emerging Technologies in Communications 
and Information Technologies 
 
vulnerabilities in a multi-stage and multi-host model. In other 
words, they are not very useful for recognizing vulnerabilities 
that are most likely to be exploited or put a critical mission at 
risk. 
To prioritize vulnerability fixes, it is necessary to adopt 
Attack Graph (AG) technology [2][3][4][5][6][7], which 
emphasizes whether a set of initial weaknesses can eventually 
lead to penetration of the core network or critical system 
components. Based on the network connectivity and 
vulnerability information, each path in AG [8] is a potential 
attack route that allows the attacker running a series of 
exploits to form an attack scenario. This graph-based network 
vulnerability analysis approach can provide strong hints on 
the most important vulnerability that needs to be dealt with 
immediately. TVA [9] proposes a network topology entry 
method to analyze vulnerabilities in the entire network, 
improving the analysis results of the attack graphs, providing 
more complete information of possible attacks upon an entire 
network’s vulnerabilities. Here, the vulnerability information 
and basic information about the network is analyzed together 
to generate the attack graph. In this process, some isolated 
known vulnerabilities will be left and not drawn into the 
graph. Further, AG, ostensibly "precise" because it takes a 
conservative view of the observed vulnerabilities, may fail to 
reflect the real attack situation just as much as an "unduly" 
actual observation based on all collected alerts from IDS. 
Given such a security analysis result, even for a skilled 
information security officer, it will be hard for him to 
determine how an attacker combines these vulnerabilities to 
perform a successful intrusion. 
On another note, normally after the network intrusion 
detection system has been installed, excessive number of 
alerts would cause the system administrator to panic. In order 
to improve the reliability of alerts for a network intrusion 
detection system, apart from analyzing alerts from the same 
incidents to establish correlations and minimize the number of 
alerts, building associations between intrusion alerts and other 
security/vulnerability assessment information is the current 
research trend for improving network intrusion systems. If a 
network intrusion detection system is aware of the 
vulnerability assessment information for the protected 
network, it can then target the specific vulnerabilities to issue 
intrusion warnings, consequently generating a higher number 
of accurate instruction alerts. To reduce excessive alerts and 
false alert rates for network intrusion detection systems, 
Analysis Console for Intrusion Databases (ACID) [10] 
analyzes intrusion alerts with the same intrusion behavior 
characteristics to build correlations and minimize the number 
of alerts. Although ACID also adds vulnerability attack 
information to the intrusion alert information to minimize the 
false alert rate, it does not consider in a multi-stage and multi-
host fashion. 
The Evidence Graph, EG [11] can then be used to analyze 
the visual representation of the correlated intrusion alerts and 
vulnerabilities generated by the intrusion detection system. 
However, the amount that the detection rate can be increased 
by correlating intrusion alerts and vulnerabilities is limited. 
Therefore, GREENER uses the AG and EG, combined with 
the network topology to construct the intrusion path graph and 
help network administrators locate the real problem behind 
intrusion incidents. From Table 1, we can observe that, when 
comparing GREENER to AG, TVA, EG, it provides a more 
complete vulnerability assessment result, correlates intrusion 
alerts, includes the correlations between network topology 
vulnerability assessments and consequently, reduces the false 
alert rate and increases the intrusion detection rate. It utilizes 
correlations between intrusion detection alerts, complete 
vulnerability information relationships and constructs the 
intrusion path graph, targeting network intrusion incidents to 
provide administrators with information about key network 
problems and strengthening the core of the network. 
Table 1   Comparison table for approach attributes 
Approach 
Attribute GREENER AG[8] TVA[9] EG[11] 
Connectivity V V V  
Topology V  V  
Vulnerability V V V V 
Exploit V V V  
Alerts V   V 
III. GREENER 
GReat Evil ENcroachments ERadicator (GREENER) is an 
offline system which analyzes the vulnerability assessment 
results and intrusion alerts. GREENER’s architecture 
encompasses the Vulnerability Scanner, Network Topology 
repository, Network Information repository, Intrusion 
Detection System (IDS) and GREENER Processors 
(including Attack Graph Generator, Evidence Graph 
Generator and Intrusion Path Generator), and the Manager 
Interface to network managers (as shown in Fig. 1). 
 
Vulnerability Assessment Network
Topology
Network
Information
Vulnerability
Vulnerability Connectivity 
Matrix 
Attack Graph
Generator 
Evidence Graph
Generator 
+
Intrusion Detection System
Correlated Alerts
Intrusion Path
Generator 
Attack Graph (AG)
Evidence Graph (EG)
Network
Manager
GREENER
Manager Interface 
 
Fig. 1   GREENER architecture diagram 
The purpose of each component in this architecture is as 
follows: 
 Vulnerability Scanner: scans the entire network that 
is to be protected, gathers data about networks to be 
B. Evidence Graph Algorithm 
Every node in the Evidence Graph contains the intrusion 
alert detailing the attack characteristics, attack source and 
attack target, where intrusion alerts with the same attack 
target will be marked. First, analyze the intrusion alert 
detected by the network intrusion detection system, correlate 
alerts with the same attack characteristics to reduce the 
number of alerts and order each attack characteristics 
according to its severity rank. Then, order incidents with the 
same attack characteristics according to the effective time of 
the attack. Next, for every node and the analyzed correlated 
intrusion alerts in the Evidence Graph, compare each alert 
according to the attack source, target and effective attack time 
and add them to the Evidence Graph (as shown in Fig. 4). If 
no intrusion alert node exists within the Evidence Graph, then 
add the current alert into the Evidence Graph. If the attack 
source of the alert is the same as the attack target of the 
Evidence Graph node and the alert reported time is later than 
the time of occurrence for the node, then add the alert 
information into the next node. If the attack target of the alert 
is the same as the attack source of the Evidence Graph node 
and the alert reported time is earlier than the time of 
occurrence for the node, then add the alert information into 
the previous node. 
 
 
C. Intrusion Path Graph Algorithm 
Compare a node in the Evidence Graph with a node in the 
Attack Graph. If the two nodes are the same (i.e. the same 
attack target, attack characteristics and same attack method 
against a vulnerability), then add those nodes’ attack source, 
target, characteristics and vulnerability information into the 
Intrusion Path Graph. After the process of IPG = AG∩EG, 
there is no edges between two nodes in IPG. We add the 
edges for any two nodes in IPG if they have an edge in EG. 
Lastly, represent the intrusion paths visually via an Intrusion 
Path Graph, showing paths with correlated intrusion evidence 
and related vulnerabilities, as shown as the Intrusion Path in 
Figure 5. As the comparison is done in order of the Evidence 
node time, the intrusion path generated follows a reasonable 
time sequence. 
 
 
 
IV. EXPERIMENTS 
We use a small network infrastructure environment 
commonly seen in enterprises for our experiments, as shown 
in Fig. 2. This small network infrastructure’s network 
topology uses a 3-leg perimeter firewall network 
infrastructure, where the 3-legs are the internet, DMZ 
(Demilitarized Zone) and intranet. We can also observe the 
firewall settings as shown in Fig. 2. The individual system 
setup is as shown in Table 3: The attacker INTERNET’s 
operating system is Windows XP SP2, and he uses the attack 
software Metasploit 3.1 [12], which includes several 
vulnerability attack procedures. The FIREWALL is a 
software-based firewall, which is implemented using IPFW in 
FreeBSD 6.2; WEB uses the Apache 2.2 as the web server on 
FreeBSD 6.2 and has the PHPBB 2.0.15 vulnerability; POND 
uses Windows XP SP1 with vulnerabilities as the operating 
system; INTDB uses Windows 2000 SP4 with vulnerabilities 
as its operating system. The IDSs in DMZ and intranets use 
FreeBSD 6.2 as its operating system, where Snort 2.8.2 and 
ACID 0.9.6 are installed to detect network intrusions and 
analyze intrusion alert tables; NESSUS uses FreeBSD 6.2 as 
its operating system, with Nessus 2.2.9 installed to scan for 
vulnerabilities. 
Table 3   System setup 
System Operating system Software 
ATTACK Windows XP SP2 Metasploit 3.1 
FIREWALL FreeBSD 6.2 IPFW 
WEB FreeBSD 6.2 Apache 2.2 phpbb 2.0.15 
POND Windows XP SP1  
INTDB Windows 2000 SP4  
IDS (in DMZ 
and Internal 
Network) 
FreeBSD 6.2 Snort 2.8.2 ACID 0.9.6 
NESSUS FreeBSD 6.2 Nessus2.2.9 
 
The attack scenario can be broken down into the following 
steps: 
1. The attacker uses the INTERNET system to discover that 
there is a PHPBB vulnerability in the WEB server from 
the internet, and thus, after attacking PHPBB, leaves a 
backdoor procedure.  
1 Input: attack graph, evidence graph 
2 Output: intrusion path graph (IPG) 
3 Define AG, EG, IPG be graphs = (V, E) | V: set of vertex, E: set of edge  
4 Define ρ,ν: a vertex ∈V, associated with three attributes(Vuln,Src,Dst) 
5 Begin 
6 Let IPG = AG∩EG  
7 If (IPG != NULL) { 
8    For each vertex pair (ρ,ν) of IPG 
9      If (existEdgeEG(ρ,ν)) 
10         addEdge(ρ,ν) in IPG 
11 } 
12 End 
1 Input: a set of IDS correlated alerts C1 … Cn 
2 Output: Evidence Graph EG 
3 Let EG be a graph = (VEG, EEG) | V: set of vertex, E: set of edge 
4 Define ν: a vertex∈VAG, associated with three attributes (Vuln, Src, Dst) 
5 Define Ci as a normalized alert with four attributes (Vuln, Src, Dst, 
timestamp) 
6 Define addEdge(ρ,ν) add a direct edge from ρ to ν. 
7 Begin 
8 For i=1 to n do then 
9   If (!existInEG (Ci) ) // no existing node ν with ν.Vuln =Ci.Vuln and 
// ν.Src = Ci.Src and ν.Dst = Ci.Dst  
10      insertNode(Ci.Vuln, Ci.Src, Ci.Dst) into EG 
11  For i=1 to n 
12    For j=1 to n  
13      If Ci.Dst == Cj.Src and Ci.timestamp < Cj.timestamp { 
14        ρ= locateNode(Ci.Vuln, Ci.Src, Ci.Dst); 
15        ν= locateNode(Cj.Vuln, Cj.Src, Cj.Dst); 
16        addEdge (ρ, ν); 
17      } 
18  End 
Fig. 4   Evidence Graph algorithm 
Fig. 5   Intrusion Path Graph algorithm 
B. Constructing evidence graph 
After executing the attack steps experimentally set, we use 
Snort to detect 853 alerts and, through ACID correlation 
analysis, we find that there are 18 alerts that use attack 
characteristics as index, while there are 6 cases related to 
portscan and 12 cases with other characteristics. The analyzed 
results from ACIDS are then passed to GREENER for further 
correlation analysis to obtain 10 pieces of data (as shown in 
Fig. 7), where it is detected that intrusion alerts on WEB have 
portscan and the stored robots.txt file can restrict spider 
search of web content, web browsing directory and 
viewtopic.php file storing PHPBB. Alerts on POND have 
portscan and attacks on network neighborhood services, 
which can be identified by Snort as Microsoft security 
bulletin’s MS06-040, MS06-035 and MS02-045. Alerts on 
INTDB have portscan and attacks on network neighborhood 
services, which can be identified by Snort as MS06-040 on 
Microsoft security bulletin. 
 
Fig. 8   Intrusion Path Graph 
C. Constructing intrusion path graph 
After establishing procedures for the intrusion path, we 
have generated the Intrusion Path Graph. The nodes in the 
graph include intrusion alert and vulnerability information, as 
well as network topology information. A node in the graph 
represents an attack vulnerability, and if an alert is encounter 
for the same type of vulnerability, it is represented by a dotted 
circle. At the same time, the same attack target’s vulnerability 
and intrusion alert is boxed together, while the intrusion path 
is the connecting line between the nodes with alerts. From Fig. 
8, the intrusion paths are as follows: WEB’s viewforum.php 
file that stores PHPBB is attacked by PHPBB’s XSS(Cross-
Site Script) vulnerability and then WEB attacks POND’s 
network neighborhood services by targeting the MS06-040 
vulnerability. After it succeeds, it attacks INTDB 
neighborhood services from POND by targeting the MS06-
040 vulnerability. This shows the successful attacks on WEB, 
POND and INTDB. 
The intrusion path graph provides attack points and related 
vulnerability information for network intrusion incidents and, 
as such, helps system administrators understand intrusion 
incidents in detail and quickly locate the source problem for a 
network intrusion. Furthermore, the vulnerability information 
helps them derive security measures, rapidly deal with 
network intrusions, strengthen the network system, prevent 
the same intrusions from being successful again and achieve 
the goal of keeping the network strong and secure. 
V. CONCLUSION 
Identification of the root cause of an intrusion and 
eradication of the attack vulnerability are imperative but 
challenging tasks in the incident response life cycle. There is 
a need to develop a new approach of quantifying intrusion 
alerts, and a new methodology to integrate the vulnerability 
information into security incident handling procedures. In this 
paper, we have proposed GREENER to build associations 
between intrusion alerts and vulnerability information with 
network topology information, and construct the intrusion 
path graph to help network administrators make critical 
decisions concerning the allocation of resources to handle 
security incidents. The intrusion path graph provides critical 
attack information and related vulnerability information for 
network intrusion incidents, which helps locate attack 
vulnerabilities in order to repair them and strengthen the 
network. The experiment results obtained show the proposed 
GREENER can also effectively reduce the number of alerts, 
whilst pinpointing a quick recovery path after an attack. 
ACKNOWLEDGMENT 
This work was supported in part by Industrial Technology 
Research Institute (ITRI) and National Science Council (NSC) 
in Taiwan under the grant numbers: 98-2221-E-194-023 and 
99-2221-E-194-054. 
REFERENCES 
[1] H. Debar, M. Dacer, and A. Wespi, A revised taxonomy for intrusion-
detection systems, In IBM Research Report, 1999. 
[2] L. P. Swiler, C. Phillips, D. Ellis, and S. Chakerian, Computer-Attack 
Graph Generation Tool, In Proceedings of DARPA Information 
Survivability Conference & Exposition II, DISCEX '01, 2001. 
[3] NuSMV, A New Symbolic Model Checker, http://nusmv.irst.itc.it/  
[4] O. Sheyner, J. Haines, S. Jha, R. Lippmann, and J. M. Wing, Automated 
Generation and Analysis of Attack Graphs, In Proceedings of IEEE 
Symposium on Security and Privacy, Oakland, California, May 2002. 
[5] C. Phillips and L. P. Swiler, A Graph-Based System for Network 
Vulnerability Analysis, In Proceedings of ACM from the 1998 New 
Security Paradigms Workshop, pp. 71-79, 1998. 
[6] R. W. Ritchey and P. Ammann, Using Model Checking to Analyze 
Network Vulnerabilities, In Proceedings of the IEEE Symposium on 
Security and Privacy, 2001. 
[7] R. Gula, Correlating IDS Alerts with Vulnerability Information, Tenable 
Network Security, Inc, 2007. 
[8] S. Jha, O. Sheyner, and J. Wing, Two Formal Analyses of Attack 
Graphs, In Proceedings of the 15th IEEE Computer Security 
Foundations Workshop (CSFW’02), 2002. 
[9] S. Jajodia, S. Noel, and B. O'Berry, Topological Analysis of Network 
Attack Vulnerability, In Managing Cyber Threats: Issues, Approaches 
and Challenges, V. Kumar, J. Srivastava, A. Lazarevic (eds.), Kluwer 
Academic Publisher, 2003. 
[10] Analysis Console for Intrusion Databases 
(ACID), http://www.andrew.cmu.edu/user/rdanyliw/snort/snortacid.html  
[11] W. Wang and T. E. Daniels, Building Evidence Graphs for Network 
Forensics Analysis, In Proceedings of the 21st Annual Computer 
Security Applications Conference (ACSAC’05), 2005. 
[12] Metasploit, Penetration Testing Tool, http://www.metasploit.com/  
2 
 
外，也有不少台灣人前往參加，這真是一件好事情，台灣國際化的程度也越來越好了。
台灣學生的表現也非常不錯，我們指導的學生在報告中也增加了許多膽識，最後一行
人參訪了東京的一些建築，深深的感到日本人做事的嚴謹與生活上的自愛是我們要多
多學習的，最後於 29號下午搭機平安順利地回國。 
二、 感謝與建議 
    感謝國科會提供出國發表論文的補助款，這對老師在研究上學術論文的發表與國
際交流的幫助無疑是最大的，研究上的國際學術交流必須持之以恆，在學術上才能有
更大的影響力，非常有助於擴展視野與國際學術交流，非常感謝國科會。 
三、 攜回資料名稱及內容 
    本次會議後攜回 ISCIT2010會議之論文摘要集一本"Abstracts ISCIT 2010：2010 
10th International Symposium on Communications and Information Technologies, October 
26-29, 2010, Meiji University, Tokyo, Japan." 
   
4 
 
 
 
                          
Building Intrusion Path Graphs for Security Incident 
Handling Procedures 
Guo-Tan Liao1, Li-Ru Chen2, Bo-Chao Cheng3, Huan Chen4 and Ping-Hai Hsu5 
1234Department of Communications Engineering, National Chung-Cheng University, Taiwan 
E-mail: 1loboyoh@gmail.com, 2greener@comm.ccu.edu.tw, 3bcheng@ccu.edu.tw, 4huan@ee.ccu.edu.tw  
5Information and Communications Research Laboratories, ITRI, Taiwan 
E-mail: 5becker@itri.org.tw  
 
 
Abstract—Hardening network services and network 
architecture is the best defense and the easiest way to reduce 
security risks. However, there is no effective solution to correlate 
all weaknesses, network topology with connectivity, and 
intrusion alerts. As a result, it can be difficult for network 
administrators to determine the root cause of a security incident. 
In this paper, we propose “GReat Evil ENcroachments 
Eradicator (GREENER)”, which can analyze the above network 
information in-depth and establish an intrusion path graph to 
display comprehensive information of security breaches. With 
the help of GREENER, system administrators can discover 
detailed information about an incident and rapidly remove 
network intrusion issues associated with the hardening process 
to prevent the same type of intrusion from happening again. This 
study has demonstrated that GREENER meets the requirements 
for mitigating security threats and provides a practical security 
incident response solution.  
I. INTRODUCTION 
Ensuring network security is a long term effort and 
challenging task. The nature of network security is such that it 
is “easy to attack but hard to defense” and therefore, it is 
difficult to design a security mechanism that can proactively 
disrupt or defend all types of security attacks; these attacks 
are constantly changing their attacking behaviors to avoid 
being detected and prevented. In other words, it is impossible 
to ensure a 100 percent incident-free secure network. Hence, 
there is a need to deploy a new security management process, 
hardening network services and network architecture, which 
is the best defense and easiest way to reduce security risks. 
A vulnerability assessment determines whether there have 
been known weaknesses and gives system administrators in-
depth recommendations regarding how to fix and improve the 
security of their networks. However, current vulnerability 
assessment tools only present the weaknesses of the various 
host information and do not integrate this information with 
other information, such as network topology and intrusion 
alerts. This is an impediment for the tool as it prevents 
network managers from being fully aware of the real 
weaknesses of the entire network system associated with the 
relationship of weaknesses between individual hosts and the 
reality of intrusion situations. 
Network intrusion detection systems (NIDS) [1] monitor 
the network activity to identify possible network attacks and 
alert network administrators about suspicious intrusions. In 
practice, an intrusion is a highly prevalent infection that is 
associated with many adverse alerts. Nevertheless, NIDSs are 
usually criticized for triggering thousands of false positives 
per day. The challenge of dealing effectively with intrusion 
alerts is in eliminating false positive alerts and efficiently 
organizing bulks of raw alerts that may be correlated as a 
result of the root cause. 
In the two above solutions, there are no correlations drawn 
between vulnerability weaknesses, network topology with 
connectivity and intrusion alerts. As a result, it is extremely 
difficult for the network manager to determine the root cause 
of a security incident. In this paper, we propose a new root 
cause diagnosis system, GReat Evil ENcroachments 
Eradicator (GREENER), which constructs an intrusion path 
based on correlation analysis. By providing a graphical 
representation of the intrusion path, GREENER provides a 
cost-effective security incident handling process and risk 
mitigation strategies that allow upper-level managers to 
identify the origin of the intrusion which can then be traced 
back to a failure of the hardening procedures. It is necessary 
for network managers to either eliminate the vulnerability that 
causes the system to be compromised or to develop an 
approach to prevent the damage caused by the same attack in 
the future. 
The remainder of this paper is organized as follows. 
Section II presents the background and related works and 
Section III introduces the proposed GREENER architecture 
and algorithm. Experimental results are presented in Section 
IV and finally concluding remarks are made in Section V. 
II. RELATED WORKS 
When we are securing a practical network, it is important to 
consider multi-stage and multi-host attacks because the 
attacker will try to penetrate the compromised systems. Due 
to the potential interactions between multiple hosts and 
components, the security hardening process becomes much 
more difficult and requires knowledge of things such as 
vulnerability, security policy and network topology. Current 
vulnerability assessment (VA) tools are designed to scan the 
enterprise network automatically and locate the weaknesses, 
including applications and the operating system, of individual 
systems. However, if the vulnerabilities of the system are too 
many, it becomes impossible to fix all vulnerabilities due to 
limited resources and time during the hardening process. 
These VA tools are unable to obtain the relationships between 
protected within the entire network and system 
vulnerabilities. 
 Network Topology repository: provides network 
topology information about the entire network that is 
to be protected.  
 Network Information repository: provides network 
information about the entire network that is to be 
protected, such as firewall rules and network 
connectivity between the systems and network attack 
program information.  
 IDS: provides analyzed intrusion alerts, classified 
according to attack characteristics, attack source and 
attack target.  
 Manager Interface: provides a visual representation 
of the information, vulnerabilities and analyzed 
intrusion alert information for the network manager. 
 GREENER Processor: generates Attack Graph, 
Evidence Graph and Intrusion Path Graph (IPG). In 
this architecture, GREENER gathers information 
about network topology, network information and 
vulnerability information, and uses these three types 
of information accordingly with vulnerability 
information of the network to be protected to obtain 
the Attack Graph. It then uses the network intrusion 
detection system to gather and analyze network 
intrusion alerts and then uses the analyzed intrusion 
alerts to generate the Evidence Graph. Lastly, it 
compares the Attack Graph and Evidence Graph to 
generate the Intrusion Path Graph. In the following 
sections, we detail the algorithms used by GREENER 
to generate the Attack Graph, Evidence Graph and 
Intrusion Path Graph. 
A. Attack Graph Algorithm 
Suppose there is an example topology with firewall rules as 
shown in Fig. 2. A ruleset of the firewall rules enforce the 
firewall to perform the following actions: Rule 1 allows 
INTERNET users to connect to the WEB server, where the 
connection port is 80; Rule 2 allows WEB located in DMZ 
makes any connections to INTERNET; Rule 3 and 4 tell the 
firewall to allow WEB to connect to the POND machine, 
where the connection ports are 139 and 445; Rule 5 allows all 
INTERNAL machines (including POND and INTDB) make 
any connections to INTERNET; and Rule 6 denies all other 
inbound/outbound connections. 
Based on the example in Fig. 2, the algorithm analyzes the 
network topology, network connectivity [9] as well as 
vulnerability information and classifies them in the 
Vulnerability Connectivity Matrix (VCM), which lists all 
vulnerabilities for each pair of connectivity as shown in Table 
2. In the table, ANY represents any network service that can 
connect the attack source to the attack target and NONE 
represents any network service that cannot connect the attack 
source to the attack target, while all other entries represent the 
name of the vulnerability targeted when some source attacks a 
target. According to this table, we then put attack targets with 
some vulnerability and the attack source that can target an 
attack based on that vulnerability into the Attack Graph by the 
following method listed in Fig. 3. A node in the Attack Graph 
contains the vulnerability name, attack source, attack target 
and includes hidden information about the network topology 
and network connectivity. 
DMZ
Internal Network
FirewallWEB
INTERNET
PONDINTDBVA
IDS
VA: Vulnerability Assessment
IDS: Intrusion Detection System
Firewall Ruleset
DenyAnyAnyAnyAny6
AllowAnyINTERNETAnyINTERNAL5
Allow445PONDAnyWEB4
Allow139PONDAnyWEB3
AllowAnyINTERNETAnyWEB2
Allow80WEBAnyAny1
ActionDportDestinationSportSource
IDS
 
Fig. 2   An example topology with the firewall rules 
Table 2   Vulnerability Connectivity Matrix 
Dst 
Src 
INTERNET WEB POND INTDB 
INTERNET ANY 
PHPBB-SQL 
INJECTION, 
PHPBB-XSS 
NONE NONE 
WEB ANY ANY 
MS04-012, 
MS06-040, 
MS04-011, 
MS03-039, 
MS06-035, 
MS04-007, 
MS06-035, 
MS05-027, 
MS05-043, 
MS03-026, 
MS02-045, 
MS04-022, 
MS03-043 
NONE 
POND ANY ANY ANY 
MS06-040, 
MS04-011, 
MS05-047, 
MS04-007, 
MS06-035, 
MS05-027, 
MS05-039, 
MS05-043, 
SRVSVC-PIPE 
INTDB ANY ANY ANY ANY 
 
 
 
1 Input: Vulnerability Connectivity Matrix (VCM) 
2 Output: Attack Graph AG 
3 Let AG be a graph = (VAG, EAG) | V: set of vertex, E: set of edge  
4 Define ν: a vertex ∈VAG, associated with three attributes (Vuln,Src,Dst) 
5 Begin 
6 For each element Γ in VCM  
7    insertNode(Γ.Vuln, Γ.Src, Γ.Dst) into AG 
8 For each node ρ in AG 
9    For each node ν  in AG 
10      If ρ.Dst = ν.Src then 
11         addEdge(ρ,ν); 
12 End 
Fig. 3   Attack Graph algorithm 
2. Through WEB’s backdoor procedure, it logons to the 
WEB system, discovers that it can connect to the 
neighborhood service of POND in the intranet from WEB, 
and that the service has the vulnerability MS06-040. 
3. Thus, an attack procedure is uploaded from INTERNET 
to WEB and, from the attack on POND by WEB, system 
administrator privileges are obtained.  
4. Following this, a tunnel is built in WEB, allowing 
INTERNET to use WEB to connect to POND remotely.  
5. After connecting to POND and entering the intranet, it 
also discovers that the internal information repository 
INTDB’s network neighborhood service also has the 
vulnerability MS06-040. 
6. The same attack procedure on WEB is then uploaded. 
INTDB is attacked and system administrator privileges 
are obtained.  
A. Constructing attack graph 
The vulnerability scan results from using Nessus on WEB, 
POND and INTDB are as such: 17 severe vulnerabilities, 8 
major vulnerabilities, 11 mid-level vulnerabilities and 1 minor 
vulnerability. In the results, WEB has 2 severe and major 
vulnerabilities, POND has 13 severe and major vulnerabilities 
and INTDB has 8 severe and major vulnerabilities. The severe 
and major vulnerability detailed information is shown in 
Table 4. If attacks targeting severe vulnerabilities are 
successful, the attacker can obtain administration or execution 
privileges, while successful attacks against major 
vulnerabilities can impair the system or enable extraction of 
important system information. By using the Attack Graph 
algorithm, the Attack Graph can be drawn from the 
vulnerability information (as shown in Fig. 6). 
Table 4   Severe and major vulnerability information 
Machine Service Port Nessus ID Vulnerability Machine Service Port 
Nessus 
ID Vulnerability 
WEB http (80/tcp) PHPBB-SQL  15780 INJECTION POND 
netbios-ssn 
(139/tcp) MS02-045 11110 
WEB http (80/tcp) PHPBB-XSS 23968 POND cap (1026/tcp) MS04-022 13852 
POND epmap (135/tcp) MS04-012 21655 POND 
epmap 
(135/tcp) MS03-043 11890 
POND netbios-ssn (139/tcp) MS06-040 22194 INTDB 
netbios-ssn 
(139/tcp) MS06-040 22194 
POND netbios-ssn (139/tcp) MS04-011 12209 INTDB 
netbios-ssn 
(139/tcp) MS04-011 12209 
POND netbios-ssn (139/tcp) MS03-039 11835 INTDB 
netbios-ssn 
(139/tcp) MS05-047 21193 
POND netbios-ssn (139/tcp) MS06-025 21696 INTDB 
netbios-ssn 
(139/tcp) MS04-007 12054 
POND netbios-ssn (139/tcp) MS04-007 12054 INTDB 
netbios-ssn 
(139/tcp) MS06-035 22034 
POND netbios-ssn (139/tcp) MS06-035 22034 INTDB 
netbios-ssn 
(139/tcp) MS05-027 18502 
POND netbios-ssn (139/tcp) MS05-027 18502 INTDB 
netbios-ssn 
(139/tcp) MS05-039 19408 
POND netbios-ssn (139/tcp) MS05-043 19407 INTDB 
netbios-ssn 
(139/tcp) MS05-043 19407 
POND netbios-ssn (139/tcp) MS03-026 11808     
 
 
Fig. 6   Attack Graph 
 
Fig. 7   Evidence Graph 
 ::(POND, INTDB) 
 
國科會補助計畫衍生研發成果推廣資料表
日期:2011/11/03
國科會補助計畫
計畫名稱: 子計畫三：智慧型異質通訊之互動式服務技術(3/3)
計畫主持人: 陳煥
計畫編號: 99-2220-E-194-003- 學門領域: 晶片科技計畫--整合型學術研究
計畫
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
無 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
