 
中文摘要： 本計畫主要以跨層式設計的觀點來探討合作式通訊與網路技術
之間密切的關係。在合作式網路中，網路協定的設計優劣在整
體的網路效能當中扮演著至關重要的角色。一個低效率的網路
協定往往會耗費大量的通訊成本（例如：控制訊息的交換）才
能達成某一特定的通訊目的。如此不但浪費了頻寬、功率及時
間等寶貴資源，同時也將大幅降低合作式通訊本具的合作增
益。 
    著眼於此，為了達到高效率的通訊效能，並同時獲取最大
的合作增益，我們針對合作式網路提出一個跨層式設計的架
構，該架構涉及實體層（Physical Layer）、媒介存取控制層
（Medium Access Control Layer, MAC Layer）及網路層
（Network Layer）的運作，其設計的重點包括兩個重要的議
題：合作式路由技術（Cooperative Routing）和中繼節點選
擇（Relay Selection）。特別的是，我們所設計的路由方案
是以貪婪路由演算法（Greedy Routing Algorithm）為基礎所
發展出的 MAC-Network 跨層式設計，而中繼節點選擇方案則是
運用一個以最小化符碼錯誤率（Symbol Error Rate）法則所
實現的 MAC-Physical 跨層式設計。前者是以局部性選出最佳
路由節點為目的，而後者則是為了選出最佳的合作節點以加強
鏈路品質，其共同之處在於這兩個方案都是使用鄰近節點的地
理位置資訊（Location Information）作為選擇最佳路由節點
及最佳中繼節點的判斷準則；此外，這兩個方案也都利用媒介
存取控制層的計時競爭（Timer-Based Contention）機制來實
現一高效率的分散式架構，如此一來，相較於集中式選擇架構
而言，便可有效節省頻寬及功率的消耗。因此，透過多層有效
的整合，我們所提出的跨層式網路協定提供合作式網路一個切
實可行的方法。最後，我們亦針對此跨層架構進一步探討如何
介定中繼區域，藉此選出一組合適的候選中繼節點
（Candidate Relays）以改進中繼節點選擇的效率，進而提升
整體網路效能。 
 
英文摘要： This project is concerned with the close dependence of 
cooperative communications and networking from a 
cross-layer design perspective. In cooperative 
networks, it is vitally required to consider 
interactions at higher protocol layers, particularly 
the MAC (Medium Access Control) and network layers, 
due to the fact that an inefficient networking 
protocol tends to produce high overhead expenditure 
and, as a result, dramatically diminishes the 
cooperation gain.  
Table of Contents
Table of Contents i
摘要 iii
Abstract iv
1 Introduction 1
1.1 Context and Challenges . . . . . . . . . . . . . . . . . . . . . . . . . 1
1.2 Contributions of the Report . . . . . . . . . . . . . . . . . . . . . . . 7
1.3 The Rest of the Report . . . . . . . . . . . . . . . . . . . . . . . . . . 8
2 System Model 10
2.1 Signaling Strategies . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
2.1.1 Cooperative Transmission . . . . . . . . . . . . . . . . . . . . 10
2.1.2 Direct Transmission . . . . . . . . . . . . . . . . . . . . . . . . 11
2.2 Channel Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12
2.3 Theoretical Average SER Performance . . . . . . . . . . . . . . . . . 12
2.3.1 Average SER under Direct Transmission . . . . . . . . . . . . 12
2.3.2 Average SER under DF Cooperative Transmission . . . . . . . 13
2.4 Network Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
3 Geographic Relay Selection for Wireless Multihop Relay Networks 16
3.1 A Location-Based Relay Selection Scheme in a Single-Hop Scenario . 17
3.1.1 Proposed Relay Selection Criterion . . . . . . . . . . . . . . . 17
3.1.2 Best Relay Placement . . . . . . . . . . . . . . . . . . . . . . 20
3.1.3 A Practical Scheme with Imperfect Geographic Information . 21
3.2 An Eﬃcient Relay Selection Protocol for Cooperative Multihop Networks 23
3.2.1 A Cluser-Based Cooperation Scheme with Relay Selection . . 23
3.2.2 Proposed Relay Selection Protocol . . . . . . . . . . . . . . . 24
i
摘要
本計畫主要以跨層式設計的觀點來探討合作式通訊與網路技術之間密切的關係。在
合作式網路中，網路協定的設計優劣在整體的網路效能當中扮演著至關重要的角
色。一個低效率的網路協定往往會耗費大量的通訊成本（例如：控制訊息的交換）
才能達成某一特定的通訊目的。如此不但浪費了頻寬、功率及時間等寶貴資源，同
時也將大幅降低合作式通訊本具的合作增益。
著眼於此，為了達到高效率的通訊效能，並同時獲取最大的合作增益，我
們針對合作式網路提出一個跨層式設計的架構，該架構涉及實體層（Physical
Layer）、媒介存取控制層（Medium Access Control Layer, MAC Layer）及網路層
（Network Layer）的運作，其設計的重點包括兩個重要的議題：合作式路由技術
（Cooperative Routing）和中繼節點選擇（Relay Selection）。 特別的是，我們所
設計的路由方案是以貪婪路由演算法（Greedy Routing Algorithm）為基礎所發展
出的MAC-Network跨層式設計，而中繼節點選擇方案則是運用一個以最小化符碼
錯誤率（Symbol Error Rate）法則所實現的MAC-Physical跨層式設計。 前者是以
局部性選出最佳路由節點為目的，而後者則是為了選出最佳的合作節點以加強鏈
路品質，其共同之處在於這兩個方案都是使用鄰近節點的地理位置資訊（Location
Information）作為選擇最佳路由節點及最佳中繼節點的判斷準則；此外，這兩個方
案也都利用媒介存取控制層的計時競爭（Timer-Based Contention）機制來實現一
高效率的分散式架構，如此一來，相較於集中式選擇架構而言，便可有效節省頻寬
及功率的消耗。 因此，透過多層有效的整合，我們所提出的跨層式網路協定提供
合作式網路一個切實可行的方法。 最後，我們亦針對此跨層架構進一步探討如何
介定中繼區域，藉此選出一組合適的候選中繼節點（Candidate Relays）以改進中
繼節點選擇的效率，進而提升整體網路效能。
iii
Chapter 1
Introduction
1.1 Context and Challenges
Over the last decade, there has been a tremendous wave of interest in the study
of cooperative communications for wireless networks. The essential of cooperative
communications is the notion of cooperative relaying. Distinct from conventional
non-cooperative relaying for each transmission, cooperative relaying increases the
number of degrees of freedom [1] by taking advantage of the broadcast nature over
the wireless medium, enabling overhearing nodes to relay data to the receiver. As
a consequence, the receiver has several replicas of original data that experience dif-
ferent channels from the spatially distributed nodes and, hence, eﬀectively combats
the channel impairments. Such resource sharing (e.g., power, antennas, etc.) among
distributed nodes is a fundamental idea of cooperative communications. Most attrac-
tively, without a centralized antenna array, cooperative systems are able to provide
spatial diversity in a distributed fashion.
In wireless relay networks, cooperative diversity techniques play a critical role in
enabling node cooperation. A variety of cooperative signaling strategies have been
proposed to increase spatial diversity (or termed cooperative diversity in this context)
1
On the other hand, most existing work on cooperative techniques focuses on
physical-layer cooperative relaying schemes, with various diversity-oriented signaling
strategies proposed and demonstrated on the basis of information theory [2–5, 7, 12].
However, to achieve eﬃcient communications while gaining full beneﬁts from nodes
cooperation, more interactions at higher layers of the protocol stack, in particular the
MAC and network layers, are vitally required. Furthermore, an eﬃcient cooperation-
based MAC (or called cooperative MAC ) scheme should be not only payload-oriented
but also channel-adaptive to improve the network throughput and diversity gain si-
multaneously; otherwise, an ineﬃcient MAC scheme may even make cooperation gain
disappear [13].
Two major questions related to cooperative MAC design need to be answered: 1)
when to cooperate? 2) whom to cooperate with and how to do selection? For the ﬁrst
question, intuitively cooperation may not be a requisite for reliable transmission if the
direct link is of high quality. In addition, the use of cooperation inevitably introduces
somewhat ineﬃciency due to extra protocol overhead and limited payload length.
Therefore a cooperative MAC protocol should be carefully designed to prevent un-
necessary cooperation [13]. In [14], a cooperation metric related to the instantaneous
source-relay and relay-destination channel measurements was proposed to decide if
cooperation is needed. The use of automatic repeat request (ARQ) and hybrid-ARQ
schemes in cooperative networks has been discussed in [15,16]. In [4], an incremental
relaying protocol using limited feedback from the destination was proposed, which
can be viewed as an extension of ARQ in the relaying context. The second question
about cooperative MAC design addresses the typical relay selection problem. There
may exist a group of available relays around the source; however, some are beneﬁcial
3
a distributed relay selection protocol based on [18], with MAC-physical cross-layer
design.
Likewise, in view of the interaction between the MAC and network layers, we also
incorporate the routing issue into the design as a properly designed MAC protocol can
facilitate routing process at the network layer, especially the beaconless geographic
routing1 (BLGR) [32–38]. BLGR is one of the most eﬃcient and scalable routing
solutions for wireless ad hoc and sensor networks. The key advantage of BLGR
is that it needs neither prior knowledge of network topology for making a route
decision nor the periodic exchange of control messages (i.e., beacons) for acquiring
neighbors’ geographic locations. A current node can make its own routing decisions
by using local information. In general, a BLGR protocol comprises two operating
phases: forwarding phase and recovery phase. A forwarding node executes the greedy
mechanism in the forwarding phase, and, if failing, switches to recovery mode to
perform a face routing algorithm, ﬁnding another path to the destination.
It is noteworthy that BLGR at the network layer is usually coupled with MAC
protocols to oﬀer better network throughput and preserve advantageous properties
such as localized operation and high scalability. In [38], Sanchez et al. proposed a
cross-layered BLGR protocol called BOSS, using a three-way (DATA/RESPONSE/
SELECTION) handshake and an area-based timer-assignment function to reduce col-
lisions among responses during the forwarder selection phase. Yet, as operating in
the recovery mode, BOSS requires the exchange of complete neighborhood informa-
tion for face routing. To avoid this drawback, we present a fully beaconless protocol
1Geographic routing can be applied to the Selection Diversity Forwarding [30,31]—another way
of achieving spatial diversity via forwarder selection—exploiting CSI to select routes with favorable
channel conditions. However, we do not examine this channel-adaptive scheme in this project. The
diversity gain we discuss is only from relay selection in cooperative networks.
5
fading channels. Moreover, the use of our relaying area also provides better network
performance in terms of the delivery failure rate.
1.2 Contributions of the Report
This report investigates cooperative communications and networking techniques with
a focus on unique challenges including relay selection, cooperative routing, and cross-
layer protocol design. The use of geographic information, as a whole, brings cohesion
to the scope of our investigation, prompting an eﬃcient, scalable, and invulnerable-
to-dynamics scheme in cooperative networks. By contrast, non-geographic schemes
tend to suﬀer from a large amount of overhead for both message exchanges and link-
state updates due to the frequently varying topology, which lessens the eﬃciency and
scalability.
The main contributions of this report are addressed in the following aspects:
• We propose a simple geographic relay selection scheme for wireless ad hoc net-
works [18] and for multihop networks [39], in which the best relay can be eﬃ-
ciently determined based on the geographic information of nodes. The proposed
relay selection criterion is designed for minimum symbol error probability at the
destination, with the selected relay providing the most reliable cooperative link
than the other candidates. Moreover, the derived selection criterion is further
extended to formulate a relay placement problem, which serves as a cornerstone
of the follow-up studies on cross-layer protocol design.
• The intrinsic value of cooperative networks is built upon the fulﬁllment of node
cooperation, which requires not only a theory-approved signaling strategy but
also a properly designed network protocol to take real beneﬁts from cooperative
7
issue of cooperative communications, focusing on devising a relay selection scheme ap-
plicable for single-hop and multihop relay networks. Chapter 4 concerns the impacts
of physical-layer cooperation on the network-layer performance, with a cross-layer
design framework provided toward an eﬃcient, reliability-enhanced routing scheme.
Based on the cross-layer framework, Chapter 5 makes a further improvement at the
MAC layer by investigating how to optimally specify a relaying area before performing
relay selection. Finally, conclusions are drawn in Chapter 6.
9
symbol with unit average power, and both nS,D and nS,R are the noise terms. In the
second phase, R decodes the received symbol and then decides whether to relay it. We
assume that R correctly decodes the received symbol as long as the received signal-
to-noise ratio (SNR) is greater than a certain threshold. In this case, R performs
relaying; otherwise, it remains idle. Deﬁne the indicator function IR as follows:
IR =
{
1, if R decodes the transmitted symbol correctly,
0, otherwise.
(2.1.3)
The received symbol at the D in the second phase can be written as:
yR,D =
√
PC2 IRhR,Dx+ nR,D, (2.1.4)
where PC2 is the transmission power of R under the cooperative mode, hR,D is the
channel coeﬃcient from R to D, and nR,D is the noise term. Finally, D coherently
combines the received symbols from these two diﬀerent paths, i.e., yS,D and yR,D, by
using a maximum ratio combining (MRC) [43]:
yD =
√
PC1 h
∗
S,DyS,D +
√
PC2 IRh
∗
R,DyR,D. (2.1.5)
Consequently, the decoded symbol xˆ at the next hop is given by:
xˆ = arg min
x∈A
∣∣∣yD − (PC1 ∣∣hS,D∣∣2 + PC2 IR∣∣hR,D∣∣2) x∣∣∣2, (2.1.6)
where |A| = Θ denotes the cardinality of Θ-ary constellation.
2.1.2 Direct Transmission
For the direct transmission between S and D, the received symbol at D can be
expressed as:
yS,D =
√
PDhS,Dx+ nS,D, (2.1.7)
where PD is the transmission power of S under the direct mode.
11
following closed-form result:
PDSER(γ¯) = 2K(1− g(γ¯))
+K2
(
4
π
g(γ¯) tan−1
(
g−1(γ¯)
)− 1), (2.3.1)
where K = 1 − 1√
M
, g(γ¯) =
(
1 + 2(M−1)
3γ¯
)−2
, and γ¯ = P
Dσ2
N0
is the average received
SNR per symbol.
2.3.2 Average SER under DF Cooperative Transmission
The average SER performance under the DF signaling strategy with M -QAM mod-
ulation over frequency-ﬂat Rayleigh fading channels has been analyzed in [46], which
provides both the exact and approximate average SER expressions as follows. The
exact close-form SER is given by
PCSER(γ¯S,D, γ¯S,R, γ¯R,D) = F
(
1 +
bγ¯S,D
sin2 θ
)
F
(
1 +
bγ¯S,R
sin2 θ
)
+ F
((
1 +
bγ¯S,D
sin2 θ
)(
1 +
bγ¯R,D
sin2 θ
))(
1− F
(
1 +
bγ¯S,R
sin2 θ
))
,
(2.3.2)
where
F
(
x(θ)
)
=
4K
π
∫ π/2
0
x−1(θ)dθ − 4K
2
π
∫ π/4
0
x−1(θ) dθ, (2.3.3)
b = 3/2(M−1), and γ¯S,D = PC1 σ2S,D/N0 represents the average received SNR per sym-
bol at node D from node S; with the analogous notation, we have γ¯S,R = P
C
1 σ
2
S,R/N0
and γ¯R,D = P
C
2 σ
2
R,D/N0. Furthermore, for suﬃciently high SNR, (2.3.2) can be tightly
approximated as:
PCSER(γ¯S,D, γ¯S,R, γ¯R,D) ≈
1
b2γ¯S,D
(
A2
γ¯S,R
+
B
γ¯R,D
)
, (2.3.4)
where
A =
M − 1
2M
+
(1− 1/√M)2
π
;
B =
3(M − 1)
8M
+
(1− 1/√M)2
π
.
(2.3.5)
13
receiver [53].
2. The location information of a destination can be obtained by the source via
location service [54–56].
3. Every transmit node uses identical transmission power. The power allocation
across the sender and relay as well as the power adjustment of each node for
topology control may complicate the cooperative geographic routing problem.
For simplicity, we consider the case of using the equal power strategy.
15
state information (CSI) and coherent time intervals, drastically increasing the diﬃ-
culty in practical realizations, especially for large relay networks in which the fading
channels are suﬃciently fast-varying. In our scheme, the accuracy of the distance
information is the main factor resulting in non-best relay selection. An ideal scheme
(in which the distances between nodes are exact) and a practical scheme (in which
there exists distance estimation errors) will be discussed respectively.
3.1 A Location-Based Relay Selection Scheme in
a Single-Hop Scenario
3.1.1 Proposed Relay Selection Criterion
Fig. 3.1 depicts a single-hop relay network, which consists a single source-destination
pair and a group of available relays. We assume that the distances between any
two nodes in the network can be obtained by some well-known distance estimation
methods, such as [52], during the network initialization. For simplicity of description,
we start with an ideal case in which the distance information is assumed perfectly
known.
From the SER expression in (2.3.4), it gives an insight into the factors involving
the system performance, aiding in designing a relay selection criterion. Rewriting
(2.3.4)—with a relay index i introduced—in terms of coding gain and diversity order,
we have:
Ps = (Δ · γ)−d , (3.1.1)
where Δ denotes the coding gain of the scheme, given by
Δ =
√√√√b2σ2S,D
16
(
A2
σ2S,Ri
+
B
σ2Ri,D
)−1
, (3.1.2)
17
following criteria1:
i∗ = arg min
i∈{1,..,N}
mi = arg min
i∈{1,..,N}
A2dpS,Ri +Bd
p
Ri,F
. (3.1.5)
Our basic idea is to transfer the diﬃcult variance estimation problem to the
simple distance estimation problem. The reason behind this approach is the node-
distribution nature of relay networks, which implies the path losses and hence oﬀers
certain information on the channel qualities among nodes. In practical scenarios
for wireless sensor networks, the path loss exponent p and the distance information
can be obtained from some measured data during the network initialization. Such
geographic protocol has the following advantages: low overhead to be required and
minimum state to be maintained, which make it more robust to a fast-varying en-
vironment. Therefore, by utilizing only the distance information, the network can
eﬃciently perform relay selection without complicated channel estimations so that
the computational complexity can be reduced signiﬁcantly. However, there is no
denying that the proposed relay selection scheme can only achieve the diversity order
of 2. The reason is that the proposed scheme can be viewed as a relatively long-term
selection scheme, depending on the current nodes distribution (topology), which is
expected to improve the system performance via less information. In view of the
tradeoﬀ between the system complexity and the diversity order, our approach pro-
vides a simple and practical relay selection for those energy-concerned networks that
demand low-complexity schemes.
1 Eq. (2.3.4) is a bound given as an asymptotically tight approximation at high SNR. As the
SNR is suﬃciently high, the average SER as in (2.3.4) is the same with the exact SER. For low
SNRs, although (2.3.4) does not hold anymore, it does not aﬀect the correctness of the selection for
the best relay (or the second-best, third-best relays, and so on).
19
Taking derivatives, we see that the quadratic placement problem has the analytical
solution, given by:
x∗ =
A2xS +BxD
A2 +B
. (3.1.8)
Without loss of generality we normalize the distance between the source and the
destination to unit length while placing the source at the origin and the destination
(1, 0), then from (2.3.5) and (4.2.8) for QPSK modulation the best placement of the
relay is at (0.6359, 0). It means that in free space the best placement of the relay is
on the line segment between the source and the destination, and the relay is closer to
the destination than to the source (it also holds for general path loss exponent p).
Fig. 3.2 shows the general cases for the pth-order relay placement using QPSK.
It reveals the relationship between the best position of the relay in x-axis and the
path loss exponent p over the range from 1.6 to 8.0. We see that the best position of
relay is always closer to the destination than to the source, and it moves toward the
middle point (0.5, 0) as the path loss exponent increases.
3.1.3 A Practical Scheme with Imperfect Geographic Infor-
mation
In the previous sections, we have introduced the proposed relay selection scheme in
wireless ad hoc networks, where we assume that knowledge of the perfect distance
information has been known. However, due to the inherent estimation errors, the
imperfect distance information may aﬀect the performance based on the proposed
relay selection.
To evaluate the eﬀects of the distance estimation errors on the system performance,
we need to have an error model of distance measurements. However, the error models
depend on diﬀerent distance estimation methods. To simply represent it, we adopt
21
3.2 An Eﬃcient Relay Selection Protocol for Co-
operative Multihop Networks
3.2.1 A Cluser-Based Cooperation Scheme with Relay Selec-
tion
Consider the network model in which relay selection is applied in the cluster-based
cooperative wireless sensor network. As Fig. 3.3 depicts, the WSN is comprised of a
fusion center and a set of distributed homogeneous sensors grouped into cooperative
clusters, each of which elects a corresponding cluster head. The dash-dotted lines
reveal the boundaries of the clusters, and the black-colored nodes denote the cluster
heads. The transmission procedures that a sensor transmits its data to the fusion
center can be described as follows: First, a sensor shares the data to its cluster head.
Next, the cluster head selects an optimum cooperating sensor within its cluster to
collaboratively transmit the data to the neighboring cluster head. Finally, the cluster-
based multihop transmission is completed by concatenating this single-hop scheme,
and the fusion center is the ﬁnal destination.
We can simplify the above-mentioned network model to the cluster-to-cluster
scheme, where the transmission protocol is described as follows. In each cluster-
to-cluster transmission, such single-hop scheme forms the simpliﬁed cooperative relay
network, which consists of a single source (S)-destination (D) pair and N available
relays (Ri, i = 1, . . . , N), depicted in Fig. 3.4. With the relay selection mechanism,
the source cooperates with a selected relay Ri to transmit its data to the destination.
23
Table 3.1: Relays Deployment and the Corresponding Selection Metrics
Relay  (A) Geographic Location (B) Selection Metric m
R1 (-0.02, 0.19) 0.4045
R2 (-0.37, -0.01) 0.9384
R3 (0.12, -0.11) 0.2526
R4 (-0.21, -0.20) 0.6706
R5 (0.19, 0.12) 0.2005
metric.
Fig. 3.5 depicts the SER versus SNR performance of the above scenario, where
SNR is deﬁned as P/N0, and P is the total transmitted power ﬁxed in each case. In
Fig. 3.5, the performance of direct transmission from the source to the destination
is provided as a benchmark for a non-cooperation scheme. Fig. 3.5 shows that R5 is
the best relay since it contributes to the minimum SER at the destination. Moreover,
Fig. 3.5 also reveals that the worse relay (leading to the worse SEP performance)
corresponds to the larger selection metric in the column (B) of TABLE 3.1. In
other words, the simulation results are consistent with the proposed relay selection,
that is, the smaller the selection metrics, the better the resulting SER performance.
Thus, we have demonstrated that by utilizing the geographical information, nodes in
wireless sensor networks can eﬃciently perform relay selection to improve the SER
performance at the destination. In addition, we also compare the performance with a
possible relay selection protocol, named random relay selection protocol, which means
that the source randomly selects a cooperating relay without any information for each
transmission. We see, in Fig. 3.5, that the performance curve of the random selection
scheme lies between the best and the worst selection. This is because each relay has
the same opportunities to be selected so that the performance will be averaged over
25
and the destination, depicted in Fig. 3.7(a). Set the number of RSS samples as 100
and ﬁx the path loss exponent as 3. Then, the selection probability of each relay is
averaged over 100,000 trials of relay selection in diﬀerent shadowing levels.
In Fig. 3.7(a), the actual best relay determined in case of error-free distance
measurements is R3 and the second best R4. However, we see, in Fig. 3.7(b), that
due to the shadowing eﬀects, the imperfect distance information may cause the non-
best relay selection and lowers the selection probability of the actual best relay with
increasing the standard deviations of shadowing. It can be interpreted from (3.1.11)
and (4.2.4) as that the larger the shadowing eﬀects, the less reliable the measured
distances and the selection metrics. In particular, R4 always has the second highest
selection probability since its selection metric is much closer to R3 than to the others.
3.4 Summary
In this chapter, the issue of relay selection for cooperative wireless multihop networks
has been addressed. We have proposed a new and eﬃcient relay selection proto-
col based on the geographic information among nodes. Within our framework, the
best relay is determined with the aim of providing the most reliable source-relay-
destination link in a simple manner. Simulation results show that, after the network
initialization, the proposed relay selection protocol can eﬃciently improve the system
reliability without complicated channel estimations and is applicable in fast-varying
channels. Furthermore, the proposed protocol can achieve better SEP performance
as compared to the random relay selection method. Concerning with the practical
schemes in which the imperfect geographical information may lead to non-best relay
selection, we also study its eﬀects on selection probability by means of simulations.
27
Figure 3.3: Cluster-based cooperative WSN with relay selection.
Figure 3.4: Simpliﬁed cooperative relay network.
29
S D 
R1 R2 R3 R4 R5 
1 
0.167 
0.2098 0.1146 0.0709 0.0746 0.1213:im′  
(a)
1 2 3 4 5
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
Relay index
S
el
ec
tio
n 
pr
ob
ab
ili
ty
3 dB
5 dB
7 dB
9 dB
11 dB
(b)
Figure 3.7: (a) Linear network and each relay’s real selection metric. (b) Each relay’s
selection probability for diﬀerent standard deviations of shadowing.
31
optimization (such as the geographically greedy manner), whereas the second is to
reactively select the best relay to enhance the reliability of the current established
link. We then propose a cross-layer framework involving two levels of joint design—a
MAC-network cross-layer design for forwarder selection (or termed routing) and a
MAC-PHY for relay selection—over symbol-wise varying channels. Particularly, the
relay selection scheme is derived from the previously introduced selection criterion in
Chapter 3 that utilizes the source-relay and relay-destination distances as a symbol-
error-rate (SER) minimized selection criterion to select a long-term optimal relay. It
is designed as a distributed scheme through the mechanism of timer-based contention
at the MAC layer. Such a geographic relay selection scheme can be eﬀectively inte-
grated into the existing geographic routing protocols as a practical solution to enhance
the link reliability and to increase the throughput. Hence, the proposed framework
CoopGeo supports localized operation as well as high scalability, and provides an
eﬃcient, distributed routing approach for wireless multihop networks.
4.1 Problem Statement
Consider a wireless ad hoc network of k nodes randomly deployed in an area, expressed
as a dynamic graph G(V,E), where V = {v1, v2, . . . , vk} is a ﬁnite set of nodes
and E = {e1, e2, . . . , el} is a ﬁnite set of links between nodes. We denote a subset
N(vi) ⊂ V , i = 1, . . . , k, as the neighborhood of the node vi, i.e., those nodes within
the radio range of vi. In this chapter, we consider there is a single session in the
network, where data delivery may cross over multiple hops.
Fig. 4.1(a) depicts the wireless ad hoc network model, in which the source S sends
its data to the destination D in a multihop manner. In this ﬁgure the dashed circle
33
and beaconless recovery forwarding (BLRF) are applied in the PPA and NPA areas,
respectively.
The second question that this study addresses concerns the MAC-PHY cross-layer
relay selection design. The aim of relay selection in CoopGeo is to ﬁnd a subset of
optimal relay nodes PR = {vR1 , vR2 , . . . , vRm} ⊂ V \ PF to enhance the network
reliability, where each optimal relay vRi that minimizes the average point-to-point
SER for each cooperative hop is locally selected within a predeﬁned relaying area.
One design goal of CoopGeo is to develop a fully beaconless approach to geo-
graphic routing that does not rely on periodic exchange of beacons as well as complete
neighborhood information. Therefore, we consider that both the forwarder and re-
lay selections use a locally-operated contention process based on location information
and area-based timers. A speciﬁed interval of time Tmax is assigned to each selection
process. By tackling the above issues, we then contemplate a feasible cross-layer pro-
tocol that comprehensively integrates the network, MAC, and PHY layers to achieve
a highly-eﬃcient communication. In the following section we detail the framework of
the proposed cross-layer design.
4.2 Protocol Design in CoopGeo
CoopGeo, in general, performs two tasks in wireless cooperative ad hoc networks:
routing and relay selection. As described above, the routing process works in two
phases, i.e. BLGF and BLRF. Both phases share equally a time interval Tmax within
which the forwarder selection is executed. The ﬁrst half of the Tmax period is allocated
to the BLGF phase and the second half to the BLRF phase.
In the BLGF phase, a next hop that provides maximum progress toward the
35
to its timer expiration, it sends a clear-to-forward (CTF) message to S, then the
other candidates overhearing this message suppress their running timers and delete
the data received from S. Since some candidates situated at the forwarding area may
be unable to hear the CTF message, the hidden terminal problem could exist. To
avoid this problem, S broadcasts a conﬁrmation message (SELECT) to indicate a
forwarder’s winning state; those hidden candidates overhearing it, will suppress their
timers. As soon as receiving the SELECT message, the winning forwarder F sends
an acknowledgement (ACK) to S and, thereafter, it acts as the source and repeats
the process hop-by-hop until the data is delivered to the ﬁnal destination D.
Geographic contention-based forwarder selection (TCBF )
To carry out the BLGFmechanism, we base the timers settings on the metric proposed
in [38], applying an area-based assignment function. Fig. 4.2 depicts, as mentioned
above, that the radio coverage of a current source is divided into the two areas PPA
and NPA, both of which are further divided into sub-areas called Common Sub-Areas
(CSAs) in order to avoid collisions during the contention period. Those candidate
nodes situated at the same CSA oﬀer similar progress toward D, and, hence, they
have similar TCBF values. Note that unlike [38], we divide the NPA area by using
concentric coronas instead of slides as used at the PPA area. We will discuss the
reason in the BLRF section.
The timer setting for each candidate node is given as follows. First, each candidate
node situated in PPA identiﬁes which CSA group it belongs to by using the following
equation:
CSAPPA =
⌊
NSA× r − (dS,D − dFi,D)
2r
⌋
, (4.2.1)
where NSA is a predeﬁned even number of sub-areas to divide the coverage area,
37
receiving any CTF message from neighbors in PPA. Thus, CoopGeo switches auto-
matically from the BLGF mode to the BLRF mode, applying BFP during the second
half of Tmax. To accomplish this, the candidate nodes situated in the NPA determine
their CSAs and compute their contention timers (TCBF ) for being used in the BFP
algorithm. Once the planar subgraph is built, S sends a SELECT message to the
node that has been elected as a forwarder, which afterwards conﬁrms the reception
by sending back an ACK.
In [38], the CSAs of NPA are created according to the progress toward the des-
tination. CoopGeo, by contrast, adopts the distance with respect to the node that
is suﬀering the local minimum problem, and the slides are accordingly modiﬁed to
concentric coronas. Thus, The NPA area is divided into n = NSA/2 equally-sized
concentric coronas (as shown in Fig. 4.2), where the width of the i-th corona is
(
√
i −√i− 1)r1, and r1 is the radius of the ﬁrst corona calculated with r1 = r/
√
n.
To use the same terminology as the one used in the BLGF phase, in the following a
corona will be referred as a CSA. To set a contention timer, a candidate F in NPA
ﬁrst ﬁnds its CSANPA index by using the following equation:
CSANPA =
⌊(√n · dS,F
r
)2⌋
+
NSA
2
. (4.2.3)
With the CSANPA index, hereafter called CSA
1, each NPA forwarder candidate de-
termines its contention timer according to (4.2.2), and then BFP is applied.
n the recovery forwarding of CoopGeo, the contention timer setting based on the
use of concentric CSAs allows that:
1. Nodes located in the i-th CSA broadcast their CTF messages before the nodes
1A CSA value in the forwarding selection is a nonnegative integer that falls in [0, NSA − 1],
where 0 corresponds to the area closest to D and (NSA− 1) to the farthest one.
39
a combination of the source-relay and relay-destination distances.
mi = A
2dpS,Ri +Bd
p
Ri,F
, i = 1, 2, ..., N , (4.2.4)
wheremi is treated as our relay selection metric, which indicates the SER performance
at the forwarder—the smaller the metrics is, the better the resulting SER performance
will be. Therefore, the best relay can be determined according to the following criteria:
i∗ = arg min
i∈{1,..,N}
mi = arg min
i∈{1,..,N}
A2dpS,Ri +Bd
p
Ri,F
. (4.2.5)
We note that the best relay selected by the above criterion is the one that provides
the best source-relay-forwarder cooperative link in terms of average SER at F . The
relay selection process in [18], however, requires a central controller to make a best-
relay decision according to the responses from all candidate relays. To reduce the
required overhead while achieving a more eﬃcient relay selection process, we propose
a distributed relay selection protocol using MAC-PHY cross-layer design, as presented
in the following part.
Geographic contention-based relay selection
The selection process starts as soon as each candidate relay overhears the DATA/CTF
packets. Each candidate relay makes use of two relative distances dS,Ri and dRi,F to
calculate its own selection metric according to (4.2.4). Here the path loss exponent
is assumed as a known parameter. For the purpose of decentralization, the relay se-
lection metric mi is encoded in time diﬀerence inside a timer-based election scheme.
Once a candidate whose timer expiration occurs ﬁrst, it relays the data packet to
F , while the others candidates cancel their timers after receiving the packet. This
contention-based relay selection scheme provides a distributed and eﬃcient way to
41
Relay selection area
The CoopGeo relay selection process do not use control messages as in the forwarding
selection process so as to guarantee that only one node has been selected as relay, thus
avoiding message duplications or collisions. Once overhearing the relayed message
from the selected relay, other candidate relays suppress their contention timers. Since
the candidates should be located within a predeﬁned area for the execution of relay
selection, we consider the relaying area size as a way to control the corresponding
impact. The relaying area is formed by the positions of the current source and
forwarder. Fig. 4.4(a) and 4.4(b) illustrate two relaying areas. Firstly, let the set
C represent a relaying area formed by the intersection of the current source and
forwarder’s coverage areas. Secondly, we denote the set D as another relaying area
shaped in a Reuleaux triangular form, from the source’s point of view. In the ﬁrst
case, for any candidate relay xi ∈ C, its selection metric is mapped onto this set,
with M(f(xi)) ∈ [0, 1]. For the Reuleaux triangle, any candidate xi and any other
possible one xj have the following relationship: ‖xi − xj‖2 ≤ r, ∀xi,xj ∈ D, i 
= j,
where r is the transmission range of a node. Hence, from the relaying areas depicted
in the ﬁgure, the Reuleaux triangular area is the best suited to be used since all
candidate relays can hear each other, which, as a consequence, eﬀectively avoids the
hidden relay problem. It is obviously not this case for the intersection relaying area
as in Fig. 4.4(a).
4.2.4 Protocol Description of CoopGeo
In this subsection, we present the behavior of network nodes running CoopGeo, as
depicted in Fig. 4.5, for the data delivery from a source to a destination. When the
43
an ACK to S and continues the execution of CoopGeo toward D.
In addition to TCBF and TCBR timers, two more timers are used: TS1 at the source
and TF1 at the forwarder. The timer TS1 represents the maximum allowed time to
ﬁnd a forwarder toward D, given by
TS1 = TDATA + TCTF + Tmax , (4.2.11)
where TDATA and TCTF represent the data and CTF packet transmission times re-
spectively and Tmax denotes the maximum time interval allowed for the forwarder
selection process. For simplicity, in this equation we do not express the propagation
delay.
Next, the timer TS1 is updated for receiving an ACK from F . The setting of the
updated TS1, as given below, depends on whether relay cooperation is needed.
TS1 =
{
TSEL + TACK , if cooperation is not needed;
TSEL + Tmax + TDATA + TACK , otherwise,
(4.2.12)
where the ﬁrst statement includes the transmission time of the SELECT (from S to
F ) and ACK (from F to S) messages; the second statement includes the required
time of the ﬁrst statement plus the times Tmax and TDATA that correspond to the
maximum allowed time for the relay selection and the time for relaying the packet,
respectively.
As for TF1, the aﬀected value depends on whether the forwarder F correctly
decodes the received data from S, or whether relay cooperation is needed. For the
former, F listens to the channel and waits for a SELECT message from S, which
completes the direct communication mode; for the latter, F waits for the SELECT
message and relayed DATA from the source and the relay, respectively. The timer
45
and the fading channels are assumed suﬃciently fast-varying such that the channel
coeﬃcients keep constant only within every symbol interval. The number of network
topologies is 200.
For each realization of nodes distribution, we can determine the distances from
each relay to the source as well as destination, and then the corresponding selection
metric for each relay can be determined using (5.1.3). According to the selection
criterion as introduced in Sec. 4.2.3, the best relay is the one with the minimum
selection metric, while the second best relay has the second minimum selection metric
and so on.
Fig. 4.6 depicts the SER versus SNR performance of the above scenario, where
SNR is deﬁned as P/N0 and P is the total transmit power ﬁxed. In Fig. 4.6, the
performance of direct transmission from the source to the destination is provided as a
benchmark for a non-cooperation scheme. Fig. 4.6 shows that the selected best relay
contributes to the minimum SER at the destination as compared to other relays. In
addition, it also reveals that worse relays corresponds to larger selection metrics, that
is, the smaller the selection metrics, the better the resulting SER performances. Thus,
we have demonstrated that by using the geographical information, nodes in coopera-
tive networks can eﬃciently perform relay selection to improve the SER performance
at the destination. Moreover, we also compare the performance with a possible re-
lay selection approach, named random relay selection, which means that the source
randomly selects a cooperating relay without any information for each transmission.
We see, in Fig. 4.6, that the performance curve of the random selection scheme lies
in between the best and worst selections. This is because each relay has the same
opportunities to be selected such that the performance will be averaged over all the
47
Also, we see that the packet error rate performance curves of the two get closer with
increasing the number of nodes in the neighborhood. Moreover, in Fig. 4.7(b), we
show that CoopGeo improves signiﬁcantly the average error transmission probability
with increasing the number of contending nodes. This is due to the accurate selection
of the relay when more nodes are present in the neighborhood. It is noted that the
CoopGeo experiment oﬀers a very low transmission error rate, which can be used to
raise the constellation size of modulation to improve the bandwidth eﬃciency without
loss of end-to-end throughput.
4.3.2 Results with Varying Input Parameters
In this simulation, we assess the impact of the contention window size Tmax (that
controls the delay time of a contending node when it tries to forward/relay a packet)
on the CoopGeo performance. we ﬁrst simulate our protocol with diﬀerent values
of Tmax from 100μs to 1000μs. In Fig. 4.7(c), we see that the collisions, caused by
the contending nodes when they send their CTF packets or relayed messages, reduce
with increasing the Tmax size. The sizes varying from 500μs to 1000μs are the best
suited for CoopGeo, as they achieve much lower collision probability as compared
with the other cases. From the relationship between the normalized throughput with
cooperative communications and the CTF-relayed messages collision probability, we
observe that we may use a smaller Tmax size without aﬀecting the performance of the
protocol when fewer contending nodes are used for the case of Tmax = 300μs, as shown
in Fig. 4.7(d). By taking Tmax = 500μs from the previous result as a reference, it can
be seen that for a smaller saturated throughput rate with respect to Tmax = 300μs,
we may handle scenarios with higher densities.
49
(a)
(b)
Figure 4.1: (a) Cooperative multihop ad hoc network model. (b) Direct and cooper-
ative modes for each hop.
51
 
(a)
 
(b)
Figure 4.4: Mapping of the relay selection metric onto (a) the set C and (b) the set
D for a normalized distance between the current source (0, 0) and its next hop (1, 0).
Figure 4.5: CoopGeo in action.
53
          

#
#
#	
#
#$
#
#%
&!!!'!
(

)






*


&+,
(a)
          

#$
#
#$
#
#$
&!!!'!



-

!
"


!
(





*


&+,
(b)
          

#
#
#	
#
#$
#
#%
#
#/

&!!!'!
&



!
(





-":;
-":;
-":;	
-":;$
-":;
-":;
(c)
          
#$
#
#$
#
#$
#	
#	$
#
#$
#$
&!!!'!
&



!
+





!
!

"

<



='
+
=
&!+#>-":;	

='+=>-":;	
&!+#>-":;$

='+=>-":;$
(d)
Figure 4.7: (a) Packet error rate for Tmax = 500μs. (b) End-to-end transmission
error probability for Tmax = 500μs. (c) CTF-Relayed message collision probability
with changing Tmax from 100μs to 1000μs. (d) Normalized saturated throughput and
collision probability for Tmax = 300μs and Tmax = 500μs.
55
Chapter 5
Improved CoopGeo: A
Quantitative Study on
Relaying-Area Design
In the previous chapter, a contention-based geographic relay selection scheme has
been proposed to eﬃciently select the best relay within a geographic area. However,
the a priori choices for the relaying area cause diﬀerent eﬀects on the overall network
performance. In this chapter, we focus on the fundamental problem of predeﬁning the
relaying area and investigate its impact on the network performance. The previous
work CoopGeo, which is a cross-layer designed protocol including the relay and next
hop selections, suggested the Reuleaux triangle as the relaying area, so as to avoid the
hidden node problem in relay selection. Nevertheless, it also leads to a certain loss of
potential relays beneﬁcial to the cooperation. Following the framework of CoopGeo,
we develop a series of mathematical expressions for the relaying area, based on the
average symbol error rate (SER) performance requirement. Further, the relaying area
is derived and modeled as an ellipse-shaped region. Simulation results show that the
CoopGeo using the proposed relaying area improves the network performance in terms
of the delivery failure rate. The relaying area formulation and derivations provide a
57
For simplicity, we assume that PD = PT and P
C
1 = P
C
2 = P
D/2.
For the channel modeling, given any transmitter-receiver pair (i, j), the chan-
nel between i and j, denoted by hi,j, is modeled as a frequency-ﬂat fading channel,
whose channel coeﬃcient hi,j is a complex Gaussian random variable with zero-mean
and variance σ2i,j, written as hi,j ∼ CN(0, σ
2
i,j). Thus, the channel gain |hi,j| fol-
lows a Rayleigh distribution. Furthermore, the variance of hi,j is modeled by using a
σ2i,j ∝ d−αi,j log-distance path loss model [39,44], where α is the path loss exponent and
di,j is the distance between i and j. We assume that hi,j keeps constant over a symbol
duration and may change from a symbol to another as an identically independently
distributed (i.i.d.) random process. Additionally, denoting the additive noise term as
ni,j, we model ni,j as a zero-mean complex Gaussian random variable with variance
N0, expressed as ni,j ∼ CN(0, N0). We assume that the widely used M -QAM modu-
lation scheme is considered for both the transmission modes. Therefore, the average
symbol error rate (SER) under the direct mode can be expressed as the closed-form
result [45]
PDSER(γ¯) = 2K(1− g(γ¯)) +K2
(
4
π
g(γ¯) tan−1
(
g−1(γ¯)
)− 1), (5.1.1)
where γ¯ = P
Dσ2
N0
is the average received SNR per symbol, K = 1 − 1√
M
, and g(γ¯) =(
1 + 2(M−1)
3γ¯
)−2
; additionally, as analyzed in [46], the average SER under the S-R-F
cooperative mode can be tightly approximated by the following form in the high SNR
regime
PCSER(γ¯S,F , γ¯S,R, γ¯R,F ) ≈
1
b2γ¯S,F
(
A2
γ¯S,R
+
B
γ¯R,F
)
, (5.1.2)
where γ¯S,F = P
C
1 σ
2
S,F/N0, γ¯S,R = P
C
1 σ
2
S,R/N0, and γ¯R,F = P
C
2 σ
2
R,F/N0 represent the
average received SNR per symbol for the three links and b, A, and B are related
59
and F respectively. Each candidate relay then sets its contention timer related to a
predeﬁned relay selection metric [40]. The winning candidate will be the one whose
timer expires ﬁrst, and then it broadcasts a SELECT packet and the others cancel
their timers after receiving the packet.
We note that to avoid the hidden node problem during the relay selection process,
the CoopGeo protocol considered the Reuleaux triangle as the relaying area. However,
as depicted in Fig. 5.1, the use of the Reuleaux triangular relaying area, i.e., the region
SUV , may lead to a certain loss of potential relay nodes, especially in non-dense ad
hoc networks. For example, when no nodes can be found in the region SUV , the
CoopGeo protocol stops ﬁnding a relay even if there exist an appropriate one outside
this region. Motivated by this observation, we naturally raise a question: which
nodes should be the candidate relays? More speciﬁcally, how to specify a relaying
area within which nodes are useful for cooperation? We try to answer this question
in the next section.
5.2 SER-Based Relaying Areas
In this section, we ﬁrst formulate the relaying area based on the SER requirement, and
then we give derivations to explicitly identify the relaying area. Finally we suggest a
practical model for the relaying area.
5.2.1 Relaying-Area Formulation
We start with the SER-based radio coverage deﬁnition as follows.
Deﬁnition 1. Given a transmitter u located at xu ∈ R2, the SER-guaranteed radio
coverage R ⊂ R2 of u is deﬁned as a geographic area within which any receiver v can
meet certain SER requirement. Formally,
R = {xv ∈ R2|PDSER(xu,xv)  ζ0} , (5.2.1)
61
the SER-guaranteed relaying area is deﬁned as
K = {xR ∈ R2|PCSER(xS,xR,xF )  PDSER(xS,xF )} . (5.2.3)
It means that any relay located within the relaying area K provides better or the
same SER performance at the receiver as compared to the direct link without a relay.
5.2.2 Relaying-Area Derivations
Using the σ2i,j ∝ d−αi,j log-distance path loss model and setting the total transmission
power PT = 2P
C
1 = 2P
C
2 , we rewrite (5.1.2) as
PCSER(dS,F , dS,R, dR,F ) =
4N20d
α
S,F
b2P 2T
(
A2dαS,R +Bd
α
R,F
)
. (5.2.4)
Thus we have the average SER expression related to the relative location of S, R, and
F . We let dS,F = d and place S and F at (0, 0) and (d, 0) respectively. Let (x, y) be a
free point, which denotes the position of the relay R. By substituting the coordinates
of S, R, and F into (5.2.4), we have the following function
f(x, y) =
4N20
b2P 2T
dα
[
A2(x2 + y2)
α
2 +B((d− x)2 + y2)α2 ]− ζ0 . (5.2.5)
Let f(x, y) = 0 and solve the equation, then all points satisfying the equation form
the contour of the SER-based relaying area. It can be proved by experiment that the
contour of the relaying area follows an elliptical form and can be described by the
canonical implicit equation
(x− h)2
	22
+
(y − k)2
	21
= 1 , (5.2.6)
where (h, k) is the center of the ellipse, 	1 is the length of the semi-major axis, and 	2
is the length of the semi-minor axis. In particular, as α = 2, (5.2.5) can be expressed
63
R∩K—are the candidate relays.
5.3 Simulation Results
In this section, we give the computer simulation results to examine the impact of
diﬀerent relaying area choices on the cooperative networks using contention-based
geographic relay selection. Following the previous work CoopGeo, we call the Coop-
Geo using the proposed relaying area as Improved CoopGeo. The only diﬀerence is
that CoopGeo uses the Reuleaux triangle as the relaying area, as the region SUV
illustrates in Fig. 5.1, and Improved CoopGeo applies an ellipse-based relaying area,
i.e., the region PQF . In the simulations, we assume that the total transmission power
under the S-R-F cooperation scheme is PT = 12 dBm, the average noise power is
N0 = −70 dBm, the path loss exponent is α = 4, the required SER performance is
ζ0 = 10
−2, and the modulation scheme is 16-QAM. In addition, we ﬁx the S and
F at (0, 0) and (r, 0), respectively, and randomly deploy neighboring nodes around
S within the radio coverage K. For each transmission, the sender S generates one
packet consisting of 100 symbols.
We ﬁrst consider the ideal geographic relay selection, which means no collisions
occur during the relay selection process and the selected relay is always the best one.
Fig. 5.2(a) shows the performance of the average packet error rate versus the number
of neighboring nodes. The packet error is resulted from the channel fading. We
see that Improved CoopGeo is much better than CoopGeo. This is due to the fact
that the proposed relaying area is larger than that of CoopGeo and more potential
relays are considered, thereby increasing the possibility of performing the cooperative
relaying.
65
ellipse-shaped region. We named the previous work CoopGeo using the proposed re-
laying area for relay selection as Improved CoopGeo. Simulation results have shown
that, in comparison with CoopGeo, Improved CoopGeo signiﬁcantly improves the
SER performance over fading channels. Moreover, Improved CoopGeo also provides
better network performance in terms of the delivery failure rate.
67
         
	



?!'*!
#>!'
(

)






&+,
@"+A&+,
(a)
         
	



#>!'
&



!
(





&+,
@"+A&+,
(b)
Figure 5.2: (a) Packet error rate and (b) collision probability versus the number of
neighbors.
         



?!'C&!
#>!'
D

A


?
=




&+,
@"+A&+,
Figure 5.3: Delivery failure rate versus the number of neighbors.
69
and the length of the semi-minor axis 	2. In the following we take α = 2 for example:
4N20d
2
b2P 2T
[
(A2 +B)x2 − 2Bdx+Bd2]− ζ0 = 0 ,
4N20d
2(A2 +B)
b2P 2T
x2 − 8N
2
0d
3B
b2P 2T
x+
4N20d
4B
b2P 2T
− ζ0 = 0 ,
x1, x2 =
2N0d
2B ±√(A2 +B)ζ0b2P 2T − 4N20d4A2B
2N0d(A2 +B)
,
h =
x1 + x2
2
=
dB
A2 +B
,
	2 =
x1 − x2
2
=
√
(A2 +B)ζ0b2P 2T − 4N20d4A2B
2N0d(A2 +B)
.
Similarly, we can ﬁnd the extreme values of y-coordinates on the relaying area by
solving the equation
f(h, y) =
4N20
b2P 2T
dα
[
A2(
√
h2 + y2)α
+B(
√
y2 + (d− h)2)α
]
− ζ0 = 0 .
By using a numerical method to ﬁnd the roots y1 and y2, we can obtain the value k
and the length of the semi-major axis 	1. We take α = 2 for example:
4N20d
2
b2P 2T
[
A2(h2 + y2) + B(y2 + (d− h)2)]− ζ0 = 0 ,
y1, y2 = ± 1
2dN0
√
ζ0b2P 2T − 4d2N20 (A2h+B(d− h)2)
A2 +B
,
k =
y1 + y2
2
= 0 ,
	1 =
1
2dN0
√
ζ0b2P 2T − 4d2N20 (A2h+B(d− h)2)
A2 +B
.
Thus, the ellipse-shaped relaying area has been characterized.
71
region.
Simulation results have shown that the proposed relay selection scheme achieves
better SER performance as compared to the random relay selection method. In
addition, the CoopGeo operates well with diﬀerent node densities and achieves better
network performance than the existing protocol BOSS in terms of packet error rate,
transmission error probability, and saturated throughput. Due to the property of
beaconless and local operations, the CoopGeo is highly eﬃcient and scalable to any
changes in the network topology. By using the optimized relaying area for relay
selection, the CoopGeo has been demonstrated to achieve a further improvement on
the SER and delivery failure rate performance. These cooperation-based schemes
feature their high scalability and low overhead cost and, thus, are considered as
useful and practical solutions to the challenges of cooperative communications and
their applications. Most of these works have been published in major IEEE journals
or presented in major IEEE conferences, as shown in the attached publication list.
73
[7] A. K. Sadek, W. Su, and K. J. R. Liu, “Multinode cooperative communications
in wireless networks,” IEEE Trans. Signal Process., vol. 55, no. 1, pp. 341–355,
Jan. 2007.
[8] B. R. D. Mudumbai, U. Madhow, and H. V. Poor, “Distributed transmit beam-
forming: Challenges and recent progress,” IEEE Commun. Mag., vol. 47, no. 2,
pp. 102–110, Feb. 2009.
[9] M. Zorzi and R. R. Rao, “Geographic random forwarding (GeRaF) for ad hoc and
sensor networks: multihop performance,” IEEE Trans. Mobile Comput., vol. 2,
no. 4, pp. 337–348, Oct.-Dec. 2003.
[10] Y. Zhihang and K. Il-Min, “Diversity order analysis of the decode-and-forward
cooperative networks with relay selection,” IEEE Trans. Wireless Commun.,
vol. 7, no. 5, pp. 1792–1799, 2008.
[11] A. S. Ibrahim, A. K. Sadek, W. Su, and K. J. R. Liu, “Cooperative communi-
cations with relay selection: when to cooperate and whom to cooperate with?”
IEEE Trans. Wireless Commun., vol. 7, no. 7, pp. 2814–2827, July 2008.
[12] A. Nosratinia, T. E. Hunter, and A. Hedayat, “Cooperative communication in
wireless networks,” IEEE Commun. Mag., vol. 42, no. 10, pp. 74–80, Oct. 2004.
[13] H. Shan, W. Zhuang, and Z. Wang, “Distributed cooperative mac for multihop
wireless networks,” IEEE Commun. Mag., vol. 47, no. 2, pp. 126–133, Feb. 2009.
[14] A. Ibrahim, Z. Han, and K. Liu, “Distributed energy-eﬃcient cooperative routing
in wireless networks,” IEEE Trans. Wireless Commun., vol. 7, no. 10, pp. 3930–
3941, Oct. 2008.
[15] B. Zhao and M. C. Valenti, “Practical relay networks: A generalization of hybrid-
ARQ,” IEEE J. Sel. Areas Commun., vol. 23, no. 1, pp. 7–18, Jan. 2005.
75
[24] P. Liu, Z. Tao, and S. Panwar, “A cooperative mac protocol for wireless local
area networks,” in Proc. 2005 IEEE Int. Conf. Commun. (ICC 2005), Seoul,
Korea, May 2005, pp. 2962–2968.
[25] H. Zhu and G. Cao, “rDCF: A relay-enabled medium access control protocol
for wireless ad hoc networks,” IEEE Trans. Mobile Comput., vol. 5, no. 9, pp.
1201–1214, Sept. 2006.
[26] H.-S. Shan, W. Wang, W. Zhuang, and Z. Wang, “Cross-layer cooperative triple
busy tone multiple access for wireless networks,” in Proc. 2008 IEEE Global
Commun. Conf. (GLOBECOM 2008), New Orleans, LA, USA, Dec. 2008.
[27] M. S. Gokturk and O. Gurbuz, “Cooperative mac protocol with distributed re-
lay actuation,” in Proc. 2009 IEEE Wireless Commun. and Networking Conf.
(WCNC 2009), Budapest, Hungary, Apr. 2009, pp. 1–6.
[28] C.-H. Yu, O. Tirkkonen, and J. Hamalainen, “Opportunistic relay selection with
cooperative macro diversity,” EURASIP J. Wireless Commun. Netw., vol. 2010,
pp. 1–14, 2010.
[29] Y. Wei, F. R. Yu, and M. Song, “Distributed optimal relay selection in wire-
less cooperative networks with ﬁnite-state markov channels,” IEEE Trans. Veh.
Technol., vol. 59, no. 5, pp. 2149–2158, June 2010.
[30] P. Larsson, “Selection diversity forwarding in a multihop packet radio network
with fading channel and capture,” SIGMOBILE Mob. Comput. Commun. Rev.,
vol. 5, no. 4, pp. 47–54, 2001.
[31] M. R. Souryal, B. R. Vojcic, and R. L. Pickholtz, “Information eﬃciency of
multihop packet radio networks with channel-adaptive routing,” IEEE J. Sel.
Areas Commun., vol. 23, no. 1, pp. 40–50, Jan. 2005.
77
[39] C.-L. Wang and S.-J. Syue, “An eﬃcient relay selection protocol in cooperative
wireless sensor networks,” in Proc. 2009 IEEE Wireless Commun. and Network-
ing Conf. (WCNC 2009), Budapest, Hungary, April 2009.
[40] T. Aguilar, M. C. Ghedira, S.-J. Syue, V. Gauthier, H. Aﬁﬁ, and C.-L. Wang,
“A cross-layer design based on geographic information for cooperative wireless
networks,” in Proc. 2010 IEEE Vehic. Tech. Conf. (VTC 2010-Spring), Taipei,
Taiwan, May 2010.
[41] F. Malagoli, “A problem of minimum area for bodies with constrains on width
and curvature,” Rend. Istit. Mat. Univ. Trieste, pp. 407–420, 2007.
[42] T. Aguilar, S.-J. Syue, V. Gauthier, H. Aﬁﬁ, and C.-L. Wang, “CoopGeo: A
beaconless geographic cross-layer protocol for cooperative wireless ad hoc net-
works,” IEEE Trans. Wireless Commun., vol. 10, no. 8, pp. 2554–2565, Aug.
2011.
[43] D. Brennan, “Linear diversity combining techniques,” Proc. IEEE, vol. 91, no. 2,
pp. 331–356, Feb. 2003.
[44] F. Li, K. Wu, and A. Lippman, “Energy-eﬃcient cooperative routing in multi-hop
wireless ad hoc networks,” in Proc. IEEE International Performance, Comput-
ing, and Communications Conference (IPCCC 2006), April 2006, pp. 215–222.
[45] M. Simon and M. Alouini, “A uniﬁed approach to the performance analysis of
digital communication over generalized fading channels,” Proc. IEEE, vol. 86,
no. 9, pp. 1860–1877, Sept. 1998.
[46] A. K. Sadek, W. Su, and K. J. R. Liu, “Cooperative communication protocols in
wireless networks: performance analysis and optimum power allocation,” Wirel.
Pers. Commun., vol. 44, pp. 181–217, Jan. 2008.
79
Commun. and Networking Conf. (WCNC 2008), Las Vegas, NV, USA, Apr. 2008,
pp. 2111–2116.
[56] E. Kuiper and S. Nadjm-Tehrani, “Geographical routing with location service in
intermittently connected MANETs,” IEEE Trans. Veh. Technol., vol. 60, no. 2,
pp. 592–604, Feb. 2011.
[57] S. Boyd and L. Vandenberghe, Convex Optimization. Cambridge: Cambridge
University Press, 2004.
[58] S. Phaiboon, “An empirically based path loss model for indoor wireless channels
in laboratory building,” in Proc. 2002 IEEE Region Ten Conf. (TENCON 2002),
vol. 2, Beijing, China, Oct. 2002, pp. 1020–1023.
[59] H. Kalosha, A. Nayak, S. Ruhrup, and I. Stojmenovic, “Select-and-protest-based
beaconless georouting with guaranteed delivery in wireless sensor networks,” in
Proc. INFOCOM 2008, Phoenix, AZ, USA, Apr. 2008, pp. 346–350.
81
國科會補助專題研究計畫項下出席國際學術會議心得報告 
                               日期：100 年 4 月 25 日 
一、參加會議經過 
   2011 IEEE 無線通訊與網路會議 (2011 IEEE Wireless Communications and Networking 
Conference；簡稱 WCNC 2011) 於 3 月 28 日至 3 月 31 日期間在墨西哥金塔納羅奧州的坎
昆市舉行。本人於臺灣時間 3 月 26 日從新竹出發，途經美國洛杉磯轉機，然後於 3 月 27
日 (當地時間) 抵達坎昆市；在確認會場地點之後，本人便返回旅館休息以儘快調整時差
並消除長途飛行的疲勞。3 月 28 日一早本人與博士班學生赴會場領取會議相關資料，並進
一步確認論文發表的時間與地點；當日會議以 Tutorials 為主，包含 Beyond 4G Mobile 
Broadband 、 Cooperative Wireless Communications 、 IP-Based Mobility and Handover 
Optimization、Relay Enhanced LTE-Advanced Networks、Game Theory for Multiple Access and 
Resource Allocation in Wireless Networks、Wireless Network Coding 等六個主題。在參加完
Tutorial 之後，當天晚上本人與博士班學生參與大會安排的 Welcome Reception，和來自世
界各地的學者專家們進行交流。 
   WCNC 2011 自 3 月 29 日起進行為期三天的核心議程，包含 PHY (Physical Layer)、MAC 
(Medium Access Control)、Networking 及 Services and Applications 四大主軸（Tracks）之 81
個 Technical Sessions、3 個 Keynote Sessions 及 3 個 Panels。本次大會之 Keynote Sessions
被安排於 3 月 29 日至 31 日早上的九點舉行，分別由 Rafael Noel del Villar Alrich (Federal 
Telecommunication Commission, Mexico)、Lajos Hanzo (University of Southampton, UK) 及 
Omar Fernandez (Ericsson, Mexico) 擔任主講人，分別從法規、研究、產業面介紹無線通訊
與網路之發展近況，其中 3 月 30 日早上由 Prof. Lajos Hanzo 主講的 Dispensing with Channel 
Estimation: Near-Capacity Non-coherent Co-located and Distributed MIMO Architectures，探討
Distributed MIMO 系統之低複雜度非同調檢測技術及進一步改良作法，並提供一系列尚待
解決的問題(Open Problems)，值得日後研究參考。 
   在本次 WCNC 會議中，本人與博士班學生共發表二篇論文，名稱分別是 "A 
Low-Complexity SLM Based PAPR Reduction Scheme for SFBC MIMO-OFDM Systems"及
"On the Relaying Area of Contention-Based Geographic Relay Selection for Cooperative 
Wireless Networks"；這二篇論文分別被安排在 3 月 29 日下午之 PHY Track 的"MIMO I" 
Session 與 3 月 30 日下午之 MAC Track 的"Resource Management II" Session 以 Oral (口頭報
告方式) 發表；由於論文之內容具有創意，再加上我們事前有充分準備，發表過程相當順
計畫編號 NSC 97-2221-E-007-005-MY3 
計畫名稱 合作式無線通訊技術與應用之研究 
出國人員
姓名 王晉良 
服務機構
及職稱 國立清華大學通訊工程研究所 教授 
會議時間 100 年 3 月 28 日至 100 年 3 月 31 日 會議地點 墨西哥、坎昆市 
會議名稱 (中文) 2011 年 IEEE 無線通訊與網路會議 (英文) 2011 IEEE Wireless Communications and Networking Conference 
發表論文
題目 
1. A Low-Complexity SLM Based PAPR Reduction Scheme for SFBC 
MIMO- OFDM Systems 
2. On the Relaying Area of Contention-Based Geographic Relay Selection 
for Cooperative Wireless Networks 
1Chin-Liang Wang
寄件者: EDAS Conference Manager <help@edas-help.com> 代理 IEEE WCNC 2011 - PHY 
<cvargas@itesm.mx>
寄件日期: 2010年11月30日星期二 上午 10:31
收件者: Chin-Liang Wang
副本: Shun-Sheng Wang; Hsiao-Ling Chang
主旨: [IEEE WCNC 2011 - PHY] Your paper 'A Low-Complexity SLM Based PAPR Reduction Scheme for 
SFBC MIMO-OFDM Systems'  has been accepted
Dear Prof. Chin‐Liang Wang: 
 
We are pleased to inform you that your paper #1569368986, 'A Low‐Complexity SLM Based PAPR Reduction 
Scheme for SFBC MIMO‐OFDM Systems', has been accepted to the IEEE Wireless Communications and 
Networking Conference 
2011 (IEEE WCNC 2011 PHY) ‐‐ http://www.ieee‐wcnc.org/2011.   
 
A total of 832 papers were submitted to IEEE WCNC 2011. More than 95% of these papers had three or more 
reviews; no paper had less than two reviews. Your paper is among the 400 papers accepted after careful 
consideration ‐‐ congratulations!   
   
The reviews are given below; they can also be found at http://edas.info/showPaper.php?m=1569368986. We 
recommend that you revise your paper to address the reviewers      comments and suggestions. 
 
The Final Paper Submittal Instructions are posted at http://www.ieee‐wcnc.org/2011/submit.html     
 
For information about the Mexican Visa please see the conference web page. 
 
IMPORTANT INFORMATION FOR TECHNICAL PAPER AUTHORS 
 
To be published in the IEEE WCNC 2011 Conference Proceedings and IEEE XploreR, at least one Author of an 
accepted paper is required to register for the conference at the FULL Rate and the paper must be presented at 
the conference. Non refundable registration fees must be paid prior to uploading the final IEEE formatted, 
publication ready version of the paper. For authors with multiple accepted papers, one full registration is valid 
for up to three (3) papers Only accepted and presented papers will be published in the IEEE WCNC 2011 
Conference Proceedings and in IEEE XploreR. 
 
IEEE Policy:      IEEE reserves the right to exclude a paper from distribution after the conference (e.g., removal 
from IEEE Xplore) if the paper is not presented at the conference.     
 
Student, Life Member and One Day registration is not valid as an author registration. 
 
The deadline for Author registration is Monday, 10 January 2011.    If registering by Fax or Mail please allow 5 
business days for your registration to be processed.     
 
You must register with payment before you can upload your final paper.     
Please follow the instructions at http://www.ieee‐wcnc.org/2011/submit.html 
A Low-Complexity SLM Based PAPR Reduction 
Scheme for SFBC MIMO-OFDM Systems 
 
Chin-Liang Wang  
Department of Electrical Engineering and  
Institute of Communications Engineering  
National Tsing Hua University 
Hsinchu, Taiwan 30013, R.O.C. 
clwang@ee.nthu.edu.tw 
Shun-Sheng Wang† and Hsiao-Ling Chang‡ 
Institute of Communications Engineering 
National Tsing Hua University 
Hsinchu, Taiwan 30013, R.O.C. 
†d9564818@oz.nthu.edu.tw 
‡hsiouling.chang@gmail.com 
 
 
 
Abstract—A number of peak-to-average power ratio (PAPR) 
reduction techniques have been proposed for multiple-input 
multiple-output (MIMO) orthogonal frequency division 
multiplexing (OFDM) systems; however, most of them involve 
very high computational complexity and are not applicable to 
MIMO-OFDM systems with space frequency block coding 
(SFBC). In this paper, we propose a low-complexity PAPR 
reduction scheme for SFBC MIMO-OFDM systems, where the 
input sequence is multiplied by a set of phase rotation vectors 
respectively and then each resulting sequence is decomposed into 
several sub-sequences based on the linear property of SFBC. 
After computing the inverse fast Fourier transform (IFFT) to 
convert each frequency-domain sub-sequence into a time-domain 
signal, we perform equivalent SFBC encoding operations in the 
time domain for generating candidate signal sets, where the one 
with the lowest maximum PAPR is selected for transmission. 
With the proposed scheme, we can generate a large number of 
candidate signal sets by computing only a few IFFTs. As 
compared to previous related schemes, the proposed one achieves 
similar PAPR reduction performance with much lower 
computational complexity. 
Keywords-mutiple-input mutiple output (MIMO); orthogonal 
frequency division mutiplexing (OFDM); peak-to-average power 
ratio (PAPR) reduction; space frequency block coding (SFBC); 
selected mapping (SLM). 
I.  INTRODUCTION  
Recently, in rich multipath environments, multiple-input 
multiple-output (MIMO) orthogonal frequency division 
multiplexing (OFDM) systems [1] have attracted much 
attention due to their potential for providing more reliable 
reception performance and achieving higher data rates as 
compared to traditional OFDM systems. One principal 
drawback of MIMO-OFDM systems is the high peak-to-
average power ratio (PAPR) at the transmitter’s output. Due to 
the high PAPR feature, such systems may suffer from 
significant intermodulation distortion and undesired spectral 
spreading when an OFDM signal is passed through a high-
power amplifier [2]. Many low-complexity schemes have been 
proposed for reducing PAPR in OFDM systems, such as 
selected mapping (SLM) [3] and partial transmitted sequence 
(PTS) [4]. However, most of these schemes cannot be directly 
applied to space-frequency block code (SFBC) MIMO-OFDM 
systems [5]. 
Several algorithms have been proposed to reduce the PAPR 
in SFBC MIMO-OFDM systems [6]-[9]. Simplified SLM and 
PTS schemes were proposed in [6], but their performances are 
not satisfactory. In [7], the polyphase interleaving and inverse 
(PII) method was proposed for the reduction of PAPR for 
SFBC MIMO-OFDM. The extended version of PII was 
discussed in [8]. However, the computational complexity of PII 
is too high for practical implementation. In order to reduce the 
computational complexity, an inverse fast Fourier transform 
(IFFT) reduced method with some sacrifice of PAPR reduction 
performance was presented in [9]. Nevertheless, none of the 
existing schemes have both superior system performance and 
low computational complexity. In this paper, we propose a 
low-complexity PAPR reduction scheme that is based on SLM 
for SFBC MIMO-OFDM systems. 
The rest of this paper is organized as follows. Section II 
briefly defines and briefly describes PAPR and the system 
model. A new low-complexity PAPR reduction scheme for 
SFBC MIMO-OFDM system is then proposed in Section III. 
Simulation results, discussions, and comparisons of 
computational complexity with previous related works are 
provided in Section IV. Finally, some conclusions are given in 
Section V. 
II. BACKGROUND 
A. PAPR 
In an OFDM system, a block of N input symbols, 
0, 1, 1  ...,  
T
NX X X −⎡ ⎤= ⎣ ⎦X , where ( )T  denotes transpose 
operation, is formed with each symbol modulating the 
corresponding subcarrier from a set of N orthogonal 
frequencies. The resulting complex continuous-time baseband 
OFDM signal ( )x t  of a block can be expressed as 
( )
1
2
0
1 ,  0
N
j k ft
k
k
x t X e t T
N
π
−
Δ
=
= ≤ ≤∑  (1) 
This work was supported by the National Science Council of the Republic
of China under Grants NSC 96-2628-E-007-005-MY3 and NSC 99-2219-E-
007-006. 
IEEE WCNC 2011 - PHY978-1-61284-254-7/11/$26.00 ©2011 IEEE 1449
Proof:  After applying IFFT to (9), the corresponding time-
domain signal can be written as 
( )
( )
'
'
1 / 1
2 /2 /
,
0 0
1
' 2 /
'
0
1 1
1 1 , 0 1,
N N m
j mk n Nj kn N
k mkm n
k k
N
j kn N
k
k
x X e X e
N N
X e n N
m N
ππ
π
− −
⋅
⋅
= =
−
=
= =
⎛ ⎞⎜ ⎟= ≤ ≤ −⎜ ⎟⎝ ⎠
∑ ∑
∑
 (11) 
where ' /N N m=  and 'k m kX X ⋅= . Since 
( )( ) '
' '
22 Nk nknj j
N Ne e
ππ
=  
(12) 
where ( )( ) 'N  denotes the modulo 'N  operation, we thus 
conclude that ( ),m nx  is periodic with period /N m  and obtain 
the result presented in (10). 
Note that if we want to acquire the time-domain signal of q 
cyclic shifts of (9), instead of performing the IFFT directly, 
we make use of Property 1~3 to reduce computational 
complexity using the following formula 
( )
( ) { } ( ) ( )
( ) ( )
( ) ( )
( ) ( )
( ) ' '
( ) ( )( )
' '
(2), (2),
' '2
( ), ( ),
3
' '2
( ), ( ),
1 ,  ...,  
1 ,  ,                2
2
1 ,  ,
      , ,     4 
T
T Ti q
m m qmm
m
TT Tj q
cs cs
qjT T
m cs m cs
TqjT Tj q
m cs m cs
IFFT
m
e m
e
m
e e m
π
π
π
π
⎡ ⎤⎢ ⎥
= = ⎢ ⎥⎢ ⎥⎣ ⎦
⎧
⎡ ⎤
=⎢ ⎥⎣ ⎦
⎡⎢= ⎨ ⎢⎣
⎤⎥ ≥⎥⎦
x X x x W
x x
x x
x x
:	

⎪⎪⎪⎪⎪
⎪⎪⎪⎪⎪⎩
 (13) 
where 
2 1 /
' ' 2 / 2
(2), (2) 1,  ,  ...,  
TNj q N
j q N
cs e e
π
π
⎛ ⎞
−⎜ ⎟⎝ ⎠
⎡ ⎤⎢ ⎥= ⎢ ⎥⎣ ⎦
x x :  (14) 
and 
( ) ( )' ' '( ), ( ) ( )
/4
2 1 /
2 / 4
, ...,  
                         1,  , ...,  .
T
T T
m cs m m
m
TNj q N
j q Ne e
π
π
⎛ ⎞
−⎜ ⎟⎝ ⎠
⎡ ⎤⎢ ⎥
= ⎢ ⎥⎢ ⎥⎣ ⎦
⎡ ⎤⎢ ⎥⎢ ⎥⎣ ⎦
x x x	

:
 (15) 
Therefore, we need only perform N/K-point IFFT and N/2 
or N/4 complex multiplications to obtain ( )
( )i
mx  for a different 
value of m since 1j qe π = ±  and 3 /2j qe jπ = ± . 
 
Figure 1.  MIMO-OFDM system with TN  transmit antennas. (a) The 
conventional SF encoder. (b) The proposed SF encoder. 
B. Proposed Time-Domain Space Frequency Encoder 
Fig. 1(a) shows the conventional SF encoder for a MIMO-
OFDM system with TN K=  transmit antennas. The overall 
computational complexity is sizable due to it containing NT N-
point IFFT operations. Owing to the linearity of IFFT, we can 
divide the input sequence into K sub-sequences and then 
utilize (13) to achieve SFBC in the time domain. 
The proposed time-domain space frequency encoder is 
shown in Fig. 1(b). For easy comprehension, let us consider 
the 4-by-4-block code that was proposed in [12] and assume 
all kC  in Eq. (4) are the same. The m-th code matrix can be 
written as 
( ) ( ) ( ) ( )
( ) ( ) ( ) ( )
( ) ( ) ( ) ( )
( ) ( ) ( ) ( )
4 1 1 4 1 2 4 1 3 4 1
* * * *
1 4 1 4 1 3 4 1 2 4 1
* * * *
2 4 1 3 4 1 4 1 1 4 1
3 4 1 2 4 1 1 4 1 4 1
.
m m m m
m m m m
m
m m m m
m m m m
X X X X
X X X X
X X X X
X X X X
− + − + − + −
+ − − + − + −
+ − + − − + −
+ − + − + − −
⎡ ⎤⎢ ⎥⎢ ⎥
− −⎢ ⎥
= ⎢ ⎥
− −⎢ ⎥⎢ ⎥
− −⎢ ⎥⎣ ⎦
C  (16) 
According to the code matrix, we define K = 4 sub-sequences: 
1 3 5,  0,  0,  0,  ,  0,  ..., ,  0,  0,  0
T
i i i N iX X X− + + −= ⎡ ⎤⎣ ⎦S  (17) 
where 1 4i≤ ≤ .  
The time-domain signal of each transmit antenna can be 
obtained by utilizing these 4 sub-sequences. For instance, the 
transmitted signal of the first antenna can be expressed as 
{ } { } { }
4
1 1
2
IFFT IFFT IFFT .i i
i=
= +∑X S S W:  (18) 
According to (9) and (13), (18) can be further derived as 
(19) in the footnote on page 4 where 1451
 
Figure 3.  Comparison of PAPR reduction performance for the simplified 
SLM and the proposed scheme with a 4-by-4 space frequency block code. 
 
Figure 4.  Comparison of PAPR reduction performance for the PII scheme 
and the proposed scheme with Alamouti’s space frequency block code. 
TABLE I.  THE CCRRS OF THE PROPOSED SCHEME COMPARED TO THE 
SIMPLIFIED SLM AND PII SCHEME 
NT = 4 NT = 2 
Upro= UsSLM =4 Upro= UsSLM =16 V = M = 2 V = M = 4 
CCRR=79.38% CCRR=84.69% CCRR=22.47% CCRR=77.40% 
rotation vectors, the less the difference in PAPR reduction 
performance between the simplified SLM and the proposed 
scheme. Fig. 4 illustrates a similar trend of PAPR reduction 
performance in the case of the PII scheme and the proposed 
scheme using the Alamouti SF encoder. 
According to [13], for common hardware implementations, 
the overall computational complexity is mostly dominated by 
the number of multiplication operations. Hence, to analyze 
computational complexity in this paper, we only count real 
multiplication operations. It is noted that the implementation of 
a radix-2 LN-point IFFT needs 2LNlog2(LN) real 
multiplications [14]. The computational complexity reduction 
ratio (CCRR) is defined as 
complexity of the proposed schemeCCRR 1 .
complexity of the comparsion scheme
= −  (23) 
Table 1 gives CCRRs of the proposed scheme compared to 
the simplified SLM and PII scheme for the cases in Figs. 3 and 
4, respectively. 
V. CONCLUSIONS 
In this paper, we have proposed a low-complexity SLM 
based PAPR reduction scheme for SFBC MIMO-OFDM 
systems. Instead of using NT N-point IFFTs to generate the 
candidate signal sets, the proposed scheme utilizes the 
properties of SFBC and IFFT to reduce the computational 
complexity. In addition to the Alamouti SFBC scheme, this 
approach is applicable to MIMO-OFDM systems with a 
different number of antennas or a different SFBC structure. 
Simulation results have shown that, with lower computational 
complexity, the proposed scheme achieves comparable PAPR 
reduction performance to the simplified SLM and PII scheme. 
Finally, it is noted that the CCRRs of the proposed scheme 
compared to the simplified SLM and PII scheme are 
proportional to the number of transmit antennas and the 
number of candidate signal sets. 
REFERENCES 
[1] G. L. Stüber, J. R. Barry, S. W. Mclaughlin, Y. Li, M. A. Ingram, and T. 
G. Pratt, “Broadband MIMO-OFDM wireless communications,” Proc. 
IEEE, vol. 92, no. 2, pp. 271-294, Feb. 2004. 
[2] E. Costa, M. Midrio, and S. Pupolin, “Impact of amplifier nonlinearities 
on OFDM transmission system performance,” IEEE Commun. Lett., vol. 
3, no. 2, pp. 37-39, Feb. 1999. 
[3] C.-L. Wang and Y. Ouyang, “Low-complexity selected mapping 
schemes for peak-to-average power ratio reduction in OFDM systems,” 
IEEE Trans. Signal Process., vol. 53, no. 12, pp. 4652-4660, Dec. 2005. 
[4] Y. Xiao, X. Lei, Q. Wen, and S. Li, “A class of low complexity PTS 
techniques for PAPR reduction in OFDM systems,” IEEE Signal 
Process. Lett., vol. 14, no. 10, pp. 680-683, Oct. 2007. 
[5] K. F. Lee and D.B. Williams, “A space-frequency transmitter diversity 
technique for OFDM systems,” in Proc. IEEE GLOBECOM, vol. 3, San 
Francisco, CA, Nov. 2000, pp. 1473-1477. 
[6] R.F.H. Fischer and M. Hoch, “Peak-to-average power ratio reduction in 
MIMO OFDM,” in Proc. 2007 IEEE ICC, Glasgow, Scotland, June 
2007, pp. 762-767. 
[7] Z. Latinović and Y. Bar-Ness, “SFBC MIMO-OFDM peak-to-average 
power ratio reduction by polyphase interleaving and inversion,” IEEE 
Commun. Lett., vol. 10, no. 4, pp. 266-268, Apr. 2006. 
[8] Y. Ouyang, “Peak-to-average power ratio reduction by cross-antenna 
translation for SFBC MIMO-OFDM Systems,” in Proc. IEEE VTC 
Spring, Barcelona, Spain, May 2009, pp. 1-4. 
[9] S.-H. Wang and C.-P Li, “A low-complexity PAPR reduction scheme 
for SFBC MIMO-OFDM systems,” IEEE Signal Process. Lett., vol. 16, 
no. 11, pp. 941-944, Nov. 2009. 
[10] C. Tellambura, “Computation of the continuous-time PAR of an OFDM 
signal with BPSK sub-carriers,” IEEE commun. Lett., vol. 5, no. 5, pp. 
185-187,  May 2001. 
[11] S. M. Alamouti, “A simple transmit diversity technique for wireless 
communications,” IEEE J. Sel. Areas Commun., vol. 16, no. 8, pp. 1451-
1458, Oct. 1998. 
[12] H. Jafarkhani, “A quasi-orthogonal space-time block code,” IEEE Trans. 
Commun., vol. 49, no. 1, pp. 1-4, Jan. 2001. 
[13] A. Burg, “VLSI circuits for MIMO communication systems,” Ph.D. 
Dissertation, ETH Zurich, 2006. 
[14] A. V. Oppenheim, R. W. Schafer, and J. R. Buck, Discrete-Time Signal 
Processing. Prentice-Hall, Inc., Upper Saddle River, NJ, 1999. 
6 7 8 9 10 11 12 13
10-5
10-4
10-3
10-2
10-1
100
PAPRo
CC
DF
(P
AP
Ro
)
 
 
Original
Proposed V=2,UPro=4
Proposed V=4,UPro=16
Simplified SLM UsSLM=4
Simplified SLM UsSLM=16
6 7 8 9 10 11 12 13
10-5
10-4
10-3
10-2
10-1
100
PAPRo
CC
DF
(P
AP
Ro
)
 
 
Original
Proposed V=2,UPro=4
Proposed V=4,UPro=16
PII M=2,UPII=8
PII M=4,UPII=128 1453
2 
Congratulations once again for having your paper accepted to IEEE WCNC 2011, a flagship conference of the 
IEEE Communications Society. We look forward to seeing you in Cancun. 
 
Sincerely, 
                       
 
Technical Program Chairs 
David Munoz, 
Cesar Vargas. 
 
into a geographic plane so that each node can be characterized
by its geographic location. For a given node, say u, we denote
xu as the location of node u. The assumptions we make for
the network model include: (i) every node is aware of its own
geographic location and (ii) the location of the destination is
known at the source.
We consider a single unicast session in the network, where
for a given source-destination pair (s, d) the data delivery
from s to d may across over multiple hops. For each hop, the
transmission scheme can apply either a direct or a cooperative
mode, with total transmission power PT . However, in this
paper we only focus on the cooperative mode, while the direct
mode is only used for the formulations of radio coverage and
relaying areas as will be described later. The direct mode op-
erates by using the traditional point-to-point communication,
denoted as the S-F mode, where S and F represent the sender
and the next hop (or termed forwarder), respectively. The
cooperative mode under consideration, as described in [4], [9],
is based on a modified version of the three-node cooperation
scheme using the decode-and-forward (DF) strategy. We hence
denote it as the S-R-F mode, where R denotes the relay node.
Let PD be the transmission power of S under the direct mode,
and let PC1 and PC2 be the transmission power of S and R,
respectively, under the cooperative mode. For simplicity, we
assume that PD = PT and PC1 = PC2 = PD/2.
For the channel modeling, given any transmitter-receiver
pair (i, j), the channel between i and j, denoted by hi,j , is
modeled as a frequency-flat fading channel, whose channel
coefficient hi,j is a complex Gaussian random variable with
zero-mean and variance σ2i,j , written as hi,j ∼ CN(0, σ2i,j).
Thus, the channel gain |hi,j | follows a Rayleigh distribution.
Furthermore, the variance of hi,j is modeled by using a
σ2i,j ∝ d−αi,j log-distance path loss model [4], [11], where α is
the path loss exponent and di,j is the distance between i and
j. We assume that hi,j keeps constant over a symbol duration
and may change from a symbol to another as an identically
independently distributed (i.i.d.) random process. Additionally,
denoting the additive noise term as ni,j , we model ni,j as a
zero-mean complex Gaussian random variable with variance
N0, expressed as ni,j ∼ CN(0, N0). We assume that the
widely used M -QAM modulation scheme is considered for
both the transmission modes. Therefore, the average symbol
error rate (SER) under the direct mode can be expressed as
the closed-form result [12]
PDSER(γ¯) = 2K(1− g(γ¯))+K2
(
4
π
g(γ¯) tan−1
(
g−1(γ¯)
)− 1),
(1)
where γ¯ = P
Dσ2
N0
is the average received SNR per symbol,
K = 1 − 1√
M
, and g(γ¯) =
(
1 + 2(M−1)3γ¯
)−2
; additionally, as
analyzed in [13], the average SER under the S-R-F coopera-
tive mode can be tightly approximated by the following form
in the high SNR regime
PCSER(γ¯S,F , γ¯S,R, γ¯R,F ) ≈
1
b2γ¯S,F
(
A2
γ¯S,R
+
B
γ¯R,F
)
, (2)
S F
P
Q
U
V
Fig. 1. Relaying areas for contention-based geographic relay selection.
where γ¯S,F = PC1 σ2S,F/N0, γ¯S,R = PC1 σ2S,R/N0, and γ¯R,F =
PC2 σ
2
R,F/N0 represent the average received SNR per symbol
for the three links and b, A, and B are related to the constel-
lation size, given by b = 32(M−1) , A =
M−1
2M +
(1−1/√M)2
π ,
and B = 3(M−1)8M +
(1−1/
√
M)
2
π .
B. Contention-Based Geographic Relay Selection
In [4], we had addressed a geographic relay selection prob-
lem, in which based on the geographic location information
of nodes as well as the above SER expression (2), the best
relay is selected as the one that provides the best cooperative
link in terms of the average SER. As a result, [4] suggested a
relay selection criterion for each cooperative hop as follows,
i∗ = arg min
i∈{1,2,...,n}
mi = arg min
i∈{1,2,...,n}
A2dαS,Ri+Bd
α
Ri,F
(3)
where mi is defined as the relay selection metric of the i-
th candidate relay, given by mi = A2dαS,Ri + Bd
α
Ri,F
; dS,Ri
and dRi,F are the distances between the sender S and the i-th
candidate relay and between the i-th candidate relay and the
forwarder F , respectively. Furthermore, to reduce the required
overhead of collecting all the candidate relays’ location in-
formation, we further proposed a distributed contention-based
relay selection protocol based on MAC-physical cross-layer
design [9], which is called CoopGeo.
The CoopGeo is a contention-based geographic protocol,
which is composed of both the forwarder and relay selections
for each hop and therein the forwarder selection process is
followed by the relay selection process. In this paper, since
we only focus on the related issue regarding relay selection,
the forwarder selection is not further detailed. In CoopGeo,
the relay selection process starts as soon as candidate relays
overhear the DATA and Clear-to-Forward (CTF) packets,
which are sent by the sender S and forwarder F respectively
and enclose the location information of S and F respectively.
Each candidate relay then sets its contention timer related to
a predefined relay selection metric [9]. The winning candidate
will be the one whose timer expires first, and then it broadcasts
a SELECT packet and the others cancel their timers after
receiving the packet.
We note that to avoid the hidden node problem during the
relay selection process, the CoopGeo protocol considered the294
In this case, in contrast to the canonical implicit equation of an
ellipse, the center is ( dBA2+B , 0), which means that the center
is on the line segment between S and F . Moreover, since the
semi-major axis and the semi-minor axis have the same length,
the ellipse-shaped contour for α = 2 can be characterized as
a circle.
In Appendix A, we give how to characterize the elliptical
contour of the SER-based relaying area. Therefore, we can
model the SER-based relaying area as an elliptical region, as
depicted in Fig. 1, and it can be expressed as
K =
{
(x, y) ∈ R2 | (x− h)
2
22
+
(y − k)2
21
≤ 1
}
. (10)
Each node can check if it is inside the relaying area by
examining if its coordinates satisfy the condition in (10).
However, for practical considerations, we do not directly use
the elliptical region as our relaying area to choose appropriate
candidate relays. Instead, we restrict that only those nodes lo-
cated within the region PQF—the intersection of the sender’s
radio coverage and the elliptical region, written as R∩K—are
the candidate relays.
IV. SIMULATION RESULTS
In this section, we give the computer simulation results
to examine the impact of different relaying area choices on
the cooperative networks using contention-based geographic
relay selection. Following the previous work CoopGeo, we call
the CoopGeo using the proposed relaying area as Improved
CoopGeo. The only difference is that CoopGeo uses the
Reuleaux triangle as the relaying area, as the region SUV
illustrates in Fig. 1, and Improved CoopGeo applies an ellipse-
based relaying area, i.e., the region PQF . In the simulations,
we assume that the total transmission power under the S-
R-F cooperation scheme is PT = 12 dBm, the average
noise power is N0 = −70 dBm, the path loss exponent is
α = 4, the required SER performance is ζ0 = 10−2, and
the modulation scheme is 16-QAM. In addition, we fix the S
and F at (0, 0) and (r, 0), respectively, and randomly deploy
neighboring nodes around S within the radio coverage K.
For each transmission, the sender S generates one packet
consisting of 100 symbols.
We first consider the ideal geographic relay selection, which
means no collisions occur during the relay selection process
and the selected relay is always the best one. Fig. 2(a) shows
the performance of the average packet error rate versus the
number of neighboring nodes. The packet error is resulted
from the channel fading. We see that Improved CoopGeo is
much better than CoopGeo. This is due to the fact that the
proposed relaying area is larger than that of CoopGeo and
more potential relays are considered, thereby increasing the
possibility of performing the cooperative relaying.
In the next simulation, we compare the performance of
collision probability versus the number of neighbors during the
contention-based relay selection process. As depicted in Fig.
2(b), due to the relaying area expansion, Improved CoopGeo
has higher collision probabilities than CoopGeo when fewer
2 4 6 8 10 12 14 16 18 20
10−3
10−2
10−1
100
Fading Only
No. of neighbors
P
ac
ke
t E
rr
or
 R
at
e
CoopGeo
Improved CoopGeo
(a)
2 4 6 8 10 12 14 16 18 20
10−3
10−2
10−1
100
No. of neighbors
C
ol
lis
io
n 
P
ro
ba
bi
lit
y
CoopGeo
Improved CoopGeo
(b)
Fig. 2. (a) Packet error rate and (b) collision probability versus the number
of neighbors.
2 4 6 8 10 12 14 16 18 20
10−2
10−1
100
Fading + Collision
No. of neighbors
D
el
iv
er
y 
Fa
ilu
re
 R
at
e
CoopGeo
Improved CoopGeo
Fig. 3. Delivery failure rate versus the number of neighbors.
neighbors are available. Nevertheless, they achieve similar
performance levels with increasing the number of neighbors.
Finally we consider the realistic geographic relay selection
scheme based on the contention process. We give the delivery
failure rate comparison by considering the joint behavior of the
packet error rate and collision probability. During each packet
delivery toward the destination, two cases including that the
packet collision happens during the contention process and that
the destination fails to decode the packet correctly are taken
into account in the performance metric delivery failure rate.
Fig. 3 shows that Improved CoopGeo outperforms the previous
work CoopGeo for the given numbers of neighboring nodes.
Furthermore, it can be seen that the performance gap between
them becomes smaller and smaller. This is because that
CoopGeo and Improved CoopGeo, in essence, are contention-
based protocols—the more the competing nodes, the higher the
collision probabilities. As a consequence, the delivery failure
rate performance is dominated by the number of neighboring
nodes.
V. CONCLUSIONS
In this paper, we have addressed the relaying area problem
of the contention-based geographic relay selection scheme for
cooperative wireless ad hoc networks. We formulated and de-
rived the SER-based relaying area, and it was finally modeled296
國科會補助計畫衍生研發成果推廣資料表
日期:2011/10/31
國科會補助計畫
計畫名稱: 合作式無線通訊技術與應用之研究
計畫主持人: 王晉良
計畫編號: 97-2221-E-007-005-MY3 學門領域: 通訊
無研發成果推廣資料
博士生 0 0 100%  
博士後研究員 0 0 100%  
（外國籍） 
專任助理 0 0 100%  
其他成果 
(無法以量化表達之
成果如辦理學術活
動、獲得獎項、重要
國際合作、研究成果
國際影響力及其他
協助產業技術發展
之 具 體 效 益 事 項
等，請以文字敘述填
列。) 
無 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
