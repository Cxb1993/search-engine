due to the influence of multi-user interference 
(MUI). In addition, the previous OCDMA systems are 
limited in the code length selection. Hence, how to 
develop some code families with a good performance 
and a flexible code length will become a critical 
issue for the construction of the next-generation 
network. Moreover, a passive optical network (PON) 
has been a primary architecture for access networks 
because it can provide low-cost point-to-multipoint 
services. Thus, we also keep integrating OCDMA 
techniques with PON to enhance the development of 
future multi-media communications. 
On the other hand, the optical wireless communication 
(OWC) systems, which have the potential benefit of 
providing high-bandwidth transmission without a 
license from the government, have been fair suitable 
for urban communications. Therefore, we also studied 
the OWC systems, including system design, plan 
implementation, and measurement. 
According to the mentioned reasons, in this project 
we investigate two topics: (I) the study of the 
optical coding techniques and (II) the implementation 
of the OWC systems. 
First of all, we develop several newly code families, 
including the 1-D super perfect difference (SPD) 
codes, partition partial prime (PPP) codes, partial 
modified prime (PMP) codes, and extended perfect 
difference (EPD) codes, the 2-D EMS/EPD codes, hybrid 
codes, and diluted perfect difference (DPD) codes, 
and the 3-D perfect difference (PD) codes and the 
corresponding system architectures. Based on the 
numerical results, it is indicated that proposed 
systems can accommodate more simultaneous users when 
bit error rate (BER) is equal to 10-9. 
In the second part, we study and design the OWC 
systems. First of all, we have successfully 
demonstrated 16 10Gbps single channels OWC system 
over 2.16km. Subsequently, we have also implemented 
four 10Gbps bi-directional channels with 785 meters 
transmission distance. 
英文關鍵詞： Diluted perfect difference (DPD) code, extended 
15 
 
行政院國家科學委員會專題研究計畫成果報告 
前瞻光通信元件及系統技術研究與其在寬頻網路之應
用─子計劃一： 
光編碼技術研究及應用於接取網路 
結案報告 
計劃編號： 
 
 
NSC-97-2221-E-002-146-MY3 
 
 
執行期限：97 年 8 月 1 日至 100 年 7 月 31 日 
 
主持人：吳靜雄教授 國立臺灣大學 電機系暨電信所 
 
參與人員：邱建林、曾信賓、林柏戎、蕭堉霖、楊文昊、王智民、李
文璟、陳智弘、郭明學、陳彥蒼、王舜弘、黃仲瑋、王儷
芙、戴嘉瑩、陳亞欣及林婕 
 
一、 中文摘要 
光纖通信技術因有能力提供高速
率傳輸與適度的安全性，已被廣泛研
究。而在特有碼字的分配下，光分碼
多工接取技術應用於系統中可允許多
用戶使用者隨機存取光網路。不過，
由於多用戶使用者干擾的影響，早期
的系統效能並是不很好。此外，早先
的光分碼多工接取系統在碼長的選擇
性上也有所受限。因此，如何發展出
碼族具備好的效能與彈性的碼長儼然
變成一門次世代網路建置的重要課
題。再者，被動光網路因可提供低成
本特質與單點對多點服務，已經成為
【附件一】 
17 
 
studied the OWC systems, including 
system design, plan implementation, and 
measurement. 
According to the mentioned 
reasons, in this project we investigate 
two topics: (I) the study of the optical 
coding techniques and (II) the 
implementation of the OWC systems. 
First of all, we develop several 
newly code families, including the 1-D 
super perfect difference (SPD) codes, 
partition partial prime (PPP) codes, 
partial modified prime (PMP) codes, and 
extended perfect difference (EPD) codes, 
the 2-D EMS/EPD codes, hybrid codes, 
and diluted perfect difference (DPD) 
codes, and the 3-D perfect difference 
(PD) codes and the corresponding 
system architectures. Based on the 
numerical results, it is indicated that 
proposed systems can accommodate 
more simultaneous users when bit error 
rate (BER) is equal to 10-9. 
In the second part, we study and 
design the OWC systems. First of all, we 
have successfully demonstrated 16 
10Gbps single channels OWC system 
over 2.16km. Subsequently, we have 
also implemented four 10Gbps 
bi-directional channels with 785 meters 
transmission distance.  
Keywords: Diluted perfect difference 
(DPD) code, extended perfect difference 
(EPD) code, extended M-sequence/ 
extended perfect difference (EMS/EPD) 
code, hybrid codes, multi-user 
interference (MUI), optical code 
division multiple access (OCDMA), 
optical wireless communication (OWC) 
system, partial modified prime (PMP) 
codes, partitioned partial prime (PPP) 
code, passive optical network (PON), 
and super perfect difference (SPD) code. 
二、 研究內容與討論 
（I）光分碼技術之研究 
1. 2-D SS FO-CDMA PON with 
EMS/EPD code 
1-1 System Description 
Fig. 1 depicts the 2-D 
spatial/spectral Fiber-optic (SS 
FO)CDMA PON, which includes one 
optical line terminal (OLT) at the central 
office (CO), several splitters at the 
remote node (RN), and MN ONUs at 
end users. Totally there are N dispersion- 
compensating fibers (DCFs) used 
between the OLT and the RN to 
compensate the impact of the chromatic 
dispersion. 
Fig. 1. The 2-D SS FO-CDMA PON. 
A specific 2-D SS EPD/EMS code 
is assigned to each ONU as its codeword. 
Subsequently, the input ports of each 
ONU (optical network unit) are 
19 
 
EMS/EPD code of each user can be 
transmitted to the RN. 
Fig. 3. The structure of the proposed ONU(m,n). 
The structure of the proposed 
ONU(m,n) shown in Fig. 3 contains a 
v×1 coupler, a (v-1)2×1 coupler, two 
1×M thin-film filters (TFFs), two 
balanced photodiodes (PDs), a 
subtractor, and an attenuator with (v-1)/v 
ratio for eliminating the influence of the 
MUI. The upper v×1 coupler combines 
the receiving optical signals from the 
corresponding fibers matched to “1s” of 
the spatial code (Yk,l) and then sends the 
upper arm signals to the input port of the 
TFF1. Similarly, the lower (v-1)2×1 
coupler combines the transmitted optical 
signals from the corresponding fibers 
matched to “1s” of its complement code 
( ,Yk l ) and then sends the lower arm 
signals through a (v-1)/v attenuator to 
arrive at the input port of the TFF2. 
Subsequently, the signals of the upper 
and lower paths are demultiplexed by 
the TFF1 and TFF2 for the spectral 
decoding. For the upper path, the input 
port of the PD0 receives the spectra 
from the 1×M TFF1 output ports 
matched to “1s” of the spectral code 
(Xi,j), whi1e the input port of the PD1 
receives another spectra signal from the 
1×M TFF1 output ports matched to “1s” 
of its complement code ( ,X i j ). In other 
words, the wavelengths matched to “1s” 
of Xi,j are coupled to the PD0, whereas 
the wavelengths matched to “1s” of 
,X i j  are input to the PD1. Similarly, the 
input ports of the PD2 and PD3 receive 
the signals with wavelengths matched to 
“1s” of Xi,j and “1s” of ,X i j  from the 
output ports of the 1×M TFF2, 
respectively. Here the operation of the 
upper and lower paths is similar. The 
major difference is in the spatial 
decoding process. For example, if the 
codeword Cm,n is received at the receiver 
of the ONU#(0,0), the correlation results 
of [R(0)(m, n) － R(1)(m, n)]∕v and 
[R(2)(m, n) － R(3)(m, n)]∕v(v － 1) are 
obtained at the output ports of the 
balanced PDs of the upper and lower 
paths, respectively. Eventually, the 
influence of the MUI can be 
theoretically completely eliminated by 
subtraction. Consequently, we obtain the 
signal energy proportional to v(Lm+1)/2 
at the output port of the (0,0)-th ONU’s 
receiver while the codeword C0,0 is 
transmitted from the OLT. 
1-2 Performance Analysis 
We take the PIIN, shot noise, and 
thermal noise into consideration for 
performance analysis. The dark current 
noise is neglected. Hence, the 
photocurrent noise can be expressed as 
21 
 
2
ThermalI =4kBTnB/RL. 
Next, we use Gaussian approximation to 
evaluate the performance. Consequently, 
the bit error rate (BER) can be obtained 
as 
( )1BER SNR 82 erfc= , 
where erfc(． ) is the complementary 
error function. 
1-3 Numerical Results 
Table I lists the parameters used to 
estimate the performance of the 
proposed system. Note that B is half of 
the data rate (Rb), e.g. for 5.0Gbps data 
rate, the noise equivalent electrical 
bandwidth is 2500MHz. 
TABLE I 
THE PARAMETERS USED TO EVALUATE 
THE PERFORMANCE 
Name Unit 
Received power at input ports 
of each ONU 100μW 
PD responsivity for InGaAs at 
1550nm 0.93A/W 
Electron’s charge 1.6×10-19 C 
Average gain  15 
The InGaAs PD material 0.6 
Data rate 5Gbps 
Noise-equivalent electrical 
bandwidth 2500MHz 
Boltzmann’s constant 1.38×10-23J/°K
Absolute temperature 300°K 
Load resistance 1030Ω 
Optical bandwidth of BBS 6.25THz 
Fig. 4 depicts the number of 
simultaneous users versus BER with the 
received power at -10dBm when the 
data rate of each user is 5Gbps and the 
pin PD is used. We compare the 2-D 
m-matrices, 2-D PDCs, and 2-D 
EMS/EPD code with similar code length. 
For N=Lp×Np=63, we calculate the 
system performance with different Lp 
and Np combinations. It shows that the 
codes with Lp=3 and Np=21 yield the 
best result. Because the IPCC value of 
the 2-D SS EMS/EPD codes in the 
different spatial group is equal to one, 
otherwise equal to zero, the value of 
IPCC in spatial field approximates 1/Np 
and is lower than that of other spatial 
codes. And, the value of IPCC in spatial 
field relates to the effect of the PIIN. 
Furthermore, the system performance is 
limited by the influence of the PIIN. 
Specifically, it is of great help to 
alleviate the effect of the PIIN by 
increasing Np to substantially improve 
the system performance. From Fig. 4, 
we find that the 2-D SS EMS/EPD code 
with Lm=15, Nm=4 and Lp=3, Np=21 has 
almost 4 times the number of 
simultaneous users at BER=10-9 than the 
2-D PDCs with M=57 and N=57. 
Similarly, it is clear that the code with 
Lm=15, Nm=4 and Lp=3, Np=21 can 
accommodate almost 20 times the 
number of simultaneous users at 
BER=10-9 than the 2-D PDCs with 
M=63 and N=63. In addition, the value 
of Lp is the number of fibers between 
RN and each ONU. Consequently, for 
fixed N, the proposed 2-D PON with 
small Lp and large Np has not only better 
performance but also employs fewer 
fibers than other 2-D SS systems. 
23 
 
each ONU (Psr) at BER=10-9. 
2. The SAC OCDMA PON with 
super perfect difference code 
2-1 System Design 
First, the compact spectral 
amphtude code (SAC) OCDMA PON 
with the moderate security and the 
capability of removing the influence of 
the MUI is presented. Fig. 7 shows the 
compact SAC OCDMA PON, which 
includes a compact OLT, an RN, and N/2 
ONUs. Based on the property of the 
SPD code, each ONU is designated two 
SPD codes as its codeword, called the 
two code keying (TCK). The OLT 
includes a BBS, a 1×(w+1) splitter, N×N 
and (w+1)×(w+1) AWG routers, a 
(N/2+1)×1 coupler, a (w+1)×1 switch, 
and N/2 2×1 optical switch modulators 
(OSMs) to perform the E-O conversion. 
Note that the (w+1)×1 switch is to 
provide network with the degree of the 
distinct security by a set of secure data 
operating at the different variation in 
time and rate. Suppose that the BBS has 
the spectral width, Δv, centered at 
wavelength vc and the bandwidth of each 
channel of the AWG routers is Δv/N. 
First, the 1×(w+1) splitter distributes the 
output of the BBS to the input ports of 
the upper AWG router according to the 
cardinal of the weight of X0 and to the 
0-th input port of the lower AWG router. 
Subsequently, for the upper path the 
incident signals with the wavelengths 
are routed to diverse output ports of the 
N×N AWG router. 
           
Fig. 7. The compact SAC OCDMA PON using SPD code. 
 
 
Hence, the codeword of Xn which 
is corresponding to the wavelengths of 
that appears at the n-th output port of the 
AWG router. In other words, totally N 
SPD codewords are generated 
simultaneously at the different output 
ports of the AWG router. Next, the 
corresponding codeword is modulated 
by the OSMs of each user and then 
transmitted to the (N/2+1)×1 coupler. 
For the lower path, the signals with the 
wavelengths vq, v(w+1) ⊕ q,…, v(w-2)(w+1) ⊕ q 
simultaneously appear at the q-th output 
port of the (w+1)×(w+1) AWG router, 
which is corresponding to the secure 
codeword of Yq. Subsequently, the 
25 
 
approximation to analyze the BER. Note 
that Psr is equal to 2Pt/N at the input port 
of each ONU. Therefore, the average 
SNR of each ONU can be expressed as 
( )
( )
( )
( )
( )
SNR sig sr
sr
sr
b n L
P RP w N
K w ww w
w NBR P
N v K w ww
N N N
K ww weRP B
N w N
K T B R
σ= = ⎧ ⎫⎡ ⎤−+⎪ ⎪⎢ ⎥+ ×+ −⎪ ⎪⎢ ⎥⎣ ⎦⎪ ⎪⎨ ⎬Δ ⎡ ⎤⎛ ⎞−⎪ ⎪⎛ ⎞ ⎛ ⎞⎢ ⎥⎜ ⎟− +⎪ ⎪⎜ ⎟ ⎜ ⎟⎜ ⎟−⎢ ⎥⎝ ⎠ ⎝ ⎠⎪ ⎪⎝ ⎠⎣ ⎦⎩ ⎭
⎧ ⎫⎡ ⎤−+ −⎪ ⎪+ +⎨ ⎬⎢ ⎥−⎪ ⎪⎣ ⎦⎩ ⎭
+
2
2 22
2 2
2
2
3
2 1 22
12
2
2 11 2 22
2
4 /
, 
where Psig is the power of average 
photocurrent, R is the responsivity of the 
PD, and K is the number of 
simultaneous users. Due to the use of the 
TCK scheme, the corresponding BER 
becomes (1/2)×erfc(SNR/2)1/2. Table II 
lists the parameters intended to calculate 
the system performance. 
TABLE II 
THE PARAMETERS USED IN SIMULATION  
Responsivity for InGaAs PD (R) 0.95    
Electron’s charge (e) 1.6×10-19 C 
Noise-equivalent electrical 
bandwidth (B) 1.25GHz 
Boltzmann’s constant (Kb) 1.38×10-23 J/°K
Absolute temperature (Tn) 300°K 
Load resistor (RL) 1035Ω 
Spectral width of BBS (Δv) 110nm 
0 10 20 30 40 50 60 70
10-12
10-10
10-8
10-6
10-4
10-2
100
Number of simultaneous users
B
ER
 
 
MS code(N=255)
ML sequence(N=256)
MQC code(N=169)
EPDC (M=13,N=13)
SPD code(N=80)
SPD code(N=120)
SPD code(N=168)
Fig. 8. The BER versus the number of 
simultaneous users with similar code length and 
Psr =-10dBm when the data rate for each user is 
2.5Gbps. 
Fig. 8 shows that the BER versus the 
number of simultaneous users with 
similar code length and Psr =-10dBm 
when the data rate for each user is 
2.5Gbps. The results for the M-sequence 
(MS) code, modified legendre (ML) 
sequence, EPDC, MQC code, and our 
codes are shown for comparison. It 
clearly shows that the PON using our 
codes has a good performance than that 
using other codes at BER=10-9. In 
addition, the system performance can be 
improved by increasing the code length. 
Though the SPD code with TCK scheme 
raises an issue on the expenditure of 
cardinalities, it is fairly significant that 
the proposed PON using our code 
concurrently has the merits of a good 
data rate, a high number of simultaneous 
users, the moderate security, and a 
simple configuration. 
3. 2-D SS OCDMA system using 2-D 
hybrid codes 
3-1 System Description 
27 
 
)1/(1 2 −K
∫
Latticeskm
λ
Latticeskm
λ
Fig. 11. The structure of the receiver. 
The operation of the receiver is 
described below. These kPD optical 
switches matched to “1s” of the spatial 
code sequence Yh are received and 
combined by the upper optical combiner. 
These P–kPD optical switches matched to 
“1s” of the complementary spatial code 
sequence hY  are received and combined 
by the lower optical combiner. The 
interference caused by the other users 
with the different spatial code sequences 
can be removed. The upper and lower 
optical combiners connect to the FBGr1 
and FBGr2. These P optical switches 
and two optical combiners are used for 
the spatial decoding. When the receiver 
uses FBGr1 and FBGr2 for the spectral 
decoding, PD0 and PD1 covert the 
optical signals to electronic and then 
pass to the integrator.    
The output current of PD0 is 
proportional to R(0)(g,h). Moreover, the 
output current of PD1 is proportional to 
R(1)(g,h)/(kPD–1). Therefore the input 
current at the integrator is proportional 
on [R(0)(g,h)–R(1)(g,h)/(kPD–1)]. Finally, 
the output current of the integrator is 
proportional to kLatticekPD for g = h = 0 or 
zero otherwise. Therefore, the MUI is 
completely eliminated. 
3-2 Performance analysis 
The PIIN, the shot noise, and the 
thermal noise are considered in the 
analysis. The dark current noise is 
neglected. Gaussian approximation is 
used to estimate the BER. The 
photocurrent noise can be expressed as 
L
rnb
rtotalrrr
thermalshotPIINnoise
R
BTK
BeIBI
iiii
4
2           2
2222
++=
><+><+>>=<<
τ , 
where Ir and Itotal  are the average and 
total photocurrents. Br is the electrical 
bandwidth, τr is this coherence time of 
the light incident to the photodiode, e is 
the electron’s charge, Kb is the 
Boltzmann’s constant, Tn is the absolute 
noise temperature, and RL is the load 
resistance. The items at the right-hand 
side of the above equation are the 
variances of the PIIN, the shot noise, 
and the thermal noise currents, 
respectively. In order to simplify this 
analysis, we make the following 
assumptions. First, each spectral 
component has the same spectral width. 
Second, the output of the BBS is 
unpolarized and has the flat optical 
spectrum over the [fo – Δf/2, fo + Δf/2], 
where fo and ∆f denote the central 
frequency and the bandwidth of the 
source. Third, the received power of 
each user is the same. Fourth, the 
received bit streams from the different 
transmitters are synchronized. Under 
these assumptions, the PSD of the 
received optical pulses can be written by 
29 
 
spatial code length. 
0 20 40 60 80 100 120 140 160
10-10
10-8
10-6
10-4
10
-2
100
Number of Simultaneous Users
B
E
R
Psr = 0dBm, Data Transmission Rate = 10Gbps
 
 
2-D-MM(M=511,P=7)
2-D-PD(M=381,P=7)
2-D-S-BIBD(M=381,P=3*2)
2-D Hybrid Codes(ms=21,P=7)
Fig. 13. Number of simultaneous users versus 
BER with similar code lengths and the effective 
source power is 0 dBm at data transmission rate 
= 10Gbps. 
If we increase the data transmission rate 
to 10Gbps, Fig. 13 depicts the number of 
simultaneous users versus BER. For 
comparison, the numerical results of the 
other systems using the 2-D MM codes, 
the 2-D PD codes, or the 2-D S-BIBD 
codes are also presented. These 
numerical results show that the BER of 
the proposed system is also lower. The 
structure of the proposed system is 
designed according to the newly 
constructed 2-D hybrid codes, which 
feature the spectral orthogonality. The 
spectral orthogonality can be used to 
reduce the PIIN induced from the other 
simultaneous users, so as to lower the 
BER. The cardinality reduction implies 
the reduction of code size. However, in 
this manuscript, we can utilize all codes, 
the maximum number of simultaneous 
users is equal to the code size. For the 
systems using other codes, the 
maximum number of simultaneous users 
is less than the code size. So our system 
has good BER performance and large 
number of simultaneous users at high 
date rates. 
0 2 4 6 8 10 12
10-10
10-8
10-6
10-4
10-2
100
Data Transmission Rate of Each User (Gbps)
B
E
R
Psr = 0dBm,Number of Simultaneous Users:128
 
 
2-D-MM(M=511,P=7)
2-D-PD(M=381,P=7)
2-D-S-BIBD(M=381,P=3*2)
2-D Hybrid Codes(ms=21,P=7)
Fig. 14. Data rate versus BER with similar code 
lengths when the number of simultaneous users 
is 128 and the effective source power is 0 dBm. 
Fig. 14 depicts the data rate of 
each user versus BER for the systems 
using the codes with similar code 
lengths when the number of 
simultaneous users is 128 and the 
effective source power is 0 dBm. And, 
Fig. 14 indicates that the proposed 
system can provide a higher data 
transmission rate for each user. At the 
BER equal to 10-9, the data transmission 
rate for each user of the proposed system 
can reach about 10Gbps, which is larger 
than the data transmission rate provided 
by the other systems using the 2-D MM 
codes, the 2-D PD codes, or the 2-D 
S-BIBD codes. 
31 
 
FBGs of the (0, 0)-th spectral encoder is 
located at λ0, λ1,…, λN-1 within the 
spectral range of λ1N, and one 2×1 
optical switch is used to modulate the 
signal by the data. Therein, two sets of 
FBGs1 and FBGs2 are designed 
according to the sequences of the PPP 
codes and their complement codes in 
order to encode the modulated signal in 
the spectrum domain. It includes N 2  
optical switches at the same group to 
connect to a N 2 ×1 coupler. Next, the 
output ports of all couplers are 
connected to the corresponding input 
ports of the M×1 AWG MUX. 
Thus, the encoded downstream 
signals of diverse groups are recombined 
at the output port of the M×1 AWG 
MUX. Finally, the downstream signals R 
are multiplexed by the 2×1 AWG and 
sent to the input port of the RN. 
The proposed RN includes two 
optical fiber amplifier (OFA), two 2×1 
AWG, and a 1× MN 2  splitter for 
distributing downstream signals to all 
ONUs and or combining upstream 
signals to the OLT. The OFA is used for 
compensating the losses of components, 
losses of the splitter and coupler, the 
insertion losses of the AWG DEMUX 
and MUX, and so on. In RN, the 
downstream signals are sent to each 
ONU via the upper arm, whereas the 
upstream signals of each ONU are sent 
to the OLT via the lower arm.
33 
 
The APDs or pin PDs can be used for 
the balanced PD. The ordinal design of 
gratings in FBGs3 and FBGs4 are the 
same but contrary to that in FBGs2 and 
FBGs1 in order to compensate the 
different round-trip delays of the 
matched spectral components. In theory, 
the received downstream signals can be 
decoded by the specific spectral decoder 
corresponding to Ym,q and ,Y m q , and 
then MUI can be eliminated by 
correlation subtraction. Moreover, if the 
interferers and the desired users do not 
belong to the same group, the 
interference signals will not enter to the 
PDs of the desired receiver to affect 
performance. 
For the uplink, the super 
luminescent diode (SLD) light is 
modulated by the data bit. For data bit 
“1”, the SLD light passes to the 
circulator and only the corresponding 
chips are reflected by the set of the 
FBGs, and then appear at the output of 
the circulator. All the upstream signals 
are combined by the 1×( MN 2 ) splitter 
and via the 1×2 AWG, OFA#2, the 2×1 
AWG, and reach the OLT. At the OLT, 
the upstream signals are separated from 
the downstream signals by the 2×1 
AWG and via OFA#3, the 1×( MN 2 ) 
splitter and then appear at the input port 
of URx’s. The URx consists of two 
optical circulators, two sets of FBGs, a 
balanced PD, and a delay line, similar to 
each ONU Rx. Hence, the received 
upstream signals at the OLT can be 
decoded similarly to ONU’s processing 
by implementing correlation subtraction. 
4-2 Performance Analysis 
To have a fair and simple 
comparison with previous SAC codes, 
we only analyze the performance of the 
downstream transmission since the 
upstream and downstream transmissions 
in the different spectrum domains. The 
results can also be viewed as an analysis 
of the upstream transmission. The PIIN, 
shot noise, and thermal noise are 
considered in photocurrent estimation 
respectively. The effect of dark current 
in PD is neglected. We use Gaussian 
approximation to estimate the BER. In 
addition, we consider losses via a shared 
BBS to all ONUs. The variance of total 
noise photocurrent in the balanced PDs 
of each ONU can be written by 
PIIN Shot Thσ σ σi = + +2 2 2 2 , 
and 
( ) ( ) ( ) ( ) ( )( )PIINσ U Dd C CU DP R P P BGτ τ= − +2 2 2 2 2 21 , 
( ) ( )( ) ( )Shotσ U DqR P P BG F G= +2 22 , 
Thσ b n LK T B R=2 4 / , 
where Pd is the degree of polarization of 
light source, R is the responsivity of PD, 
P(U) and P(D) are the incident optical 
power at the upper and lower PDs, 
( )U
Cτ  and ( )DCτ  are the coherent times 
of received the lights at the upper and 
lower PDs, B is the noise-equivalent 
electrical bandwidth of a PD receiver, G 
is the avalanche gain of a PD, q is the 
electron’s charge, F(G) is the excess 
35 
 
Boltzmann’s constant (Kb) 1.38×10-23 J/°K
Absolute temperature (Tn) 300°K 
Load resistor (RL) 1035Ω 
Average gain for InGaAs 
APD (G) 10 
Average gain for pin PD 1 
Parameter β for InGaAs 
APD 0.65 
Central wavelength 1550nm 
Data rate of each user 1.25Gbps 
Spectral width of BBS (Δf) 80nm 
Fig. 17. BER versus number of simultaneous 
users with similar code length and Psr =-5dBm 
when the data rate of each user is 1.25Gbps and 
the pin PD is used. 
We compare the performance of 
our system using the PPP codes with 
various N, M, and p (the number of 
maximum users is MN/2) with that of 
other systems using MS codes, modified 
quadratic congruence (MQC) codes, and 
EMS codes. Fig. 17 illustrates that the 
BER versus the number of simultaneous 
users with similar code length and Psr 
=-5dBm when the data rate of each user 
is 1.25Gbps and the pin PD is employed. 
It is clear that the proposed system using 
the PPP codes and the TCK scheme can 
support more simultaneous users than 
that using the other SAC codes at 
BER=10-9. Because the correlation of 
the PPP codes in the different subgroups 
of the same group is λ=1, otherwise λ=0, 
the value of IPCC approximates 
(p2-p)/M(p2-3) and lower than that of 
other SAC codes. The value of IPCC 
relates to the effect of PIIN. And the 
system performance is dominated by 
influence of PIIN. That is, it will be of 
great help to further mitigate the effect 
of PIIN by increasing M to substantially 
improve the system performance. 
Fig. 18. BER versus number of simultaneous 
users with similar code length and Psr =-10dBm 
when the data rate of each user is 2.5Gbps and 
the average APD gain is 10. 
Fig. 18 shows the BER versus the 
number of simultaneous users with 
similar code length and Psr =-10dBm 
when the data rate of each user is 
2.5Gbps and the APD with the average 
gain=10 is used. Fig. 19 displays the 
BER versus the number of simultaneous 
users with similar code length and Psr 
=-7dBm when the data rate of each user 
is 10Gbps, the APD with the average 
gain=10 is used, and the spectral width 
of the BBS is 140nm. 
37 
 
compensate the losses of the 
transmission. Next, an AWG is used to 
de-multiplex the input optical signals to 
the specific channel and then the signals 
appeared at the output port of AWG are 
detected by using a pin photo-detector. 
Finally, we use one BER tester (BERT) 
to measure the quality of the 
transmission. 
1-2 Experimental Results 
Fig. 21 depicts the BER curves 
versus the received power at the 
difference scenarios. This figure clear 
reads that the BER performance of the 
bidirectional system is quite similar to 
that of unidirectional systems. In other 
words, the quality of the transmission 
seems not to be influenced by the 
directionality of the transmission. 
Fig. 21. The BER curves versus the received 
power at the difference scenarios. 
Fig. 22 depicts the BER versus the 
timestamp from 2010/04/15 19:00 to 
2010/04/16 10:00 at 10Gbps. We found 
that the BER is around 10-11 at a good 
weather condition, without raining or 
fog. In addition, when it is raining about 
2mm/hr from 23:00 to 01:00, the BER 
performance is degraded to about 10-9. 
Hence, the proposed bidirectional OWC 
system is immense reliable. 
Fig. 22. The BER versus timestamp from 
2010/04/15 19:00 to 2010/04/16 10:00 at 
10Gbps. 
 
三、計劃成果自評與結論 
In the first year of the three-year 
project, we design two new code 
families and apply them to construct the 
corresponding OCDMA networks 
[6]-[7]. And, the systems by the 
subtraction and the value of a fixed 
IPCC can relieve the impact of the MUI. 
According to the numerical results, it is 
clear that the proposed systems can yield 
good performance. In short, they have 
an opportunity to be applied to the 
next-generation access networks. 
In the second year of the project, 
we first establish and measure the OWC 
system, which is composed of four 
10Gbps bi-directional channels with 785 
meters and then the system has been 
implemented. Concurrently, we propose 
two diverse-dimensional code families 
39 
 
Kyoto, Japan, June 2011. 
[10] C. P. Wu, H. W. Tsao, and J. Wu, 
“A novel sigma-delta fractional-N 
synthesizer architecture with 
fractional spur and quantization 
noise cancellation,” IEEE ISCAS, 
Paris, France, May 2010. 
[11] P. L. Chen, S. T. Chang, S. T. Ji, S. 
C. Lin, H. H. Lin, H. L. Tsay, P. H. 
Huang, W. C. Chiang, W. C. Lin, S. 
L. Lee, H. W. Tsao, J. P. Wu, and J. 
Wu, “Demonstration of 16 channels 
10 Gb/s WDM free space 
transmission over 2.16km,” 
LEOSCONF, Acapulco, Mexico, 
July 2008. 
五、參考文獻 
[1] S. P. Tseng and J. Wu, “Extended 
M-sequence codes for SAC FO- 
CDMA PONs applications,” 
Electron. Lett., vol. 44, no. 7, pp. 
488-490, Mar. 2008. 
[2] C. Y. Chen, C. H. Chang, M. R. 
Perati, S. K. Shao, and J. Wu, 
“Performance analysis of WDM 
optical packet switches employing 
wavelength conversion under 
Markovian modeled self-similar 
traffic input,” 2007 Workshop on 
High Performance Switching and 
Routing, New York, USA, May 
2007. 
[3] C. H. Chang, M. R. Perati, S. K. 
Shao, and J. Wu, “An efficient 
approximate Markovian model for 
optical packet switches employing 
partial buffer sharing mechanism 
under self-similar traffic input,” 
2007 Workshop on High 
Performance Switching and 
Routing, New York, USA, May 
2007. 
[4] C. H. Chang, S. K. Shao, M. R. 
Perati, and J. Wu, “Performance 
study of various packet scheduling 
algorithms for variable-packet- 
length feedback type WDM optical 
packet switches,” 2007 Workshop 
on High Performance Switching 
and Routing, Poznan, Poland pp. 
209-213, June 2006. 
[5] S. K. Shao, C. H. Chang, P. 
Sreedevi, M. R. Perati, and J. Wu, 
“Partial buffer sharing strategies in 
feedback type WDM optical routers 
under asynchronous and variable 
packet length traffic,” Proceedings 
of the OECC 2005, Seoul, Korea, 
July 2005. 
[6] C. H. Lin and J. Wu, “Comments 
on “Novel combinatorial 
constructions of optical orthogonal 
code for incoherent optical CDMA 
systems”,” J. Lightw. Technol., vol. 
24, no. 2, pp. 1064, Feb. 2006. 
[7] C. H. Chang, M. C. Tsai, S. K. 
Shao, H. W. Tsao, M. R. Perati, and 
J. Wu, “An efficient void filling 
algorithm for WDM optical packet 
switches operating under variable- 
packet-length self-similar traffic,” 
IEICE Trans. Commun., vol. E88-B, 
no. 12, pp. 4659-4663, Dec. 2005. 
[8] C. H. Lin, J. Wu, and C. L. Yang, 
“Noncoherent spatial/spectral 
optical CDMA system with 
two-dimensional perfect difference 
codes,” J. Lightw. Technol., vol. 23, 
41 
 
19, no. 9, pp. 1274-1281, Sept. 
2001. 
[21] J. F. Huang and D. Z. Hsu, “Fiber- 
grating-based optical CDMA 
spectral coding with nearly 
orthogonal M-sequence codes,” 
IEEE Photon. Technol. Lett., vol. 
12, no. 9, pp. 1252-1254, Sept. 
2000. 
[22] X. Zhou, H.H.M. Shalaby, C. Lu, 
and T. Cheng, “Code for spectral 
amplitude coding optical CDMA 
systems,” Electron. Lett., vol. 36, 
no. 8, pp. 728-729, Apr. 2000. 
[23] E. D. J. Smith, R. J. Blaikie, and D. 
P. Taylor, “Performance 
enhancement of spectral-amplitude- 
coding optical CDMA using 
pulse-position modulation,” IEEE 
Trans. Commun., vol. 46, no. 9, pp. 
1176-1185, Sept. 1998. 
[24] M. Kavehrad and D. Zaccarin, 
“Optical code-division-multiplexed 
systems based on spectral encoding 
of noncoherent sources,” J. Lightw. 
Technol., vol. 13, no. 3, pp. 
534-545, Mar. 1995. 
[25] J. A. Salehi, “Code division 
multiple-access techniques in 
optical fiber networks-part I: 
fundamental principles,” IEEE 
Trans. Commun., vol. 37, no. 8, pp. 
824-833, Aug. 1989. 
[26] J. A. Salehi and C. A. Brackett, 
“Code division multiple-access 
techniques in optical fiber 
networks-part II: systems 
performance analysis,” IEEE Trans. 
Commun., vol. 37, no. 8, pp. 
834-842, Aug. 1989. 
[27] P. R. Prucnal, M. A. Santoro, and T. 
R. Fan, “Spread spectrum 
fiber-optic local area network using 
optical processing,” J. Lightw. 
Technol., vol. LT-4, no. 5, pp. 
547-554, May 1986. 
 2
參加Keynote Speech 
1.  DOCOMO’s Actions for New Growth---Ryuji Yamada 
2.  Future Networks and Services---Maurizio Decina 
 100/06/06 10:50~12:20 
發表獲接受之論文並參加相關議程 
SAC ASN-01: Access Systems and Networks 
於11: 44發表The SAC OCDMA PON with Super Perfect Difference Code 
 100/06/06 14:00~15:30 
參加相關之議程 
CTS-02 : Coded Modulation 
 100/06/06 15:50~17:20 
參加相關之議程 
WCS-12 : Coding I 
 
 100/06/07 09:00~9:40 
參加Keynote Speech 
ICT Paradigm Shift and the Trend of Communication Technology---Toshitaka 
Tasuda 
 100/06/07 10:50~12:20 
參加相關之議程 
ONS-04 : Optical Communications I 
 100/06/07 14:00~15:30 
參加相關之議程 
ONS-05 : Optical Communications II 
 100/06/07 15:50~17:20 
參加相關之議程 
WCS-22 : Network Coding I 
 
 100/06/08 09:00~10:30 
參加相關之議程 
CTS-10 : Theory of Communication Networks 
 100/06/08 10:50~12:20 
參加相關之議程 
CTS-12 : Network Information Theory and Secure Communications 
 100/06/08 14:00~15:30 
參加相關之議程 
WCS-35 : Coding II 
 100/06/08 15:50~17:20 
參加相關之議程 
AHSM-19 : Sensor Network Design 
 
 100/06/09 10:30 
離開下榻飯店Grand Prince Hotel Kyoto並完成Check-out 
 100/06/09 13:18~14:31 
 4
四、建議 
    此次在日本京都所舉行的2011年IEEE通訊會議可說相當盛大，與會人士來至世界各
地的學術界與工業界人士參與。因此，由衷建議政府或學術單位機構能積極爭取此會議
在台灣舉辦，不僅能對學術及工業上有著直接交流的互助，更能行銷台灣至國際上，以
促進國際產學合作的可能性，進而提昇國家在國際學術與產業上的水平。 
 
五、攜回資料名稱及內容 
 攜回大會議程與論文議程。 
 大會論文集隨身碟一隻。 
 Tutorial課程之投影片：Next Generation Broadband Access: Passive Optical 
Networks隨身碟一隻。 
 
六、其他 
   附件為本次參與會議所發表之全文論文影本。 
 
 
Figure 1.  The compact SAC OCDMA PON using SPD code. 
Table II shows the SPD codes for w=3 and N=8. 
TABLE I.  SOME EXAMPLES OF THE SPD SETS 
w N SPD Sets 
3 8 2 3 5           
5 24 2 3 5 13 22         
7 48 3 4 6 18 23 41 45       
9 80 1 2 15 37 49 53 56 58 64     
11 120 1 3 7 14 17 56 71 76 93 94 102   
13 168 2 10 37 39 46 61 71 87 91 92 104 110 167
TABLE II.  THE SPD CODES FOR W=3 AND N=8 
n SPD Sets Codeword Xn 
0 {2, 3, 5} 0011  0100 
1 {3, 4, 6} 0001  1010 
2 {4, 5, 7} 0000  1101 
3 {0, 5, 6} 1000  0110 
4 {1, 6, 7} 0100  0011 
5 {0, 2, 7} 1010  0001 
6 {0, 1, 3} 1101  0000 
7 {1, 2, 4} 0110  1000 
Moreover, the property of the corresponding λ values can be 
expressed as 
 ,  for 0                 
λ=X X  0 ,  for ( , 1)=0
1 ,  otherwise              
n n s
w s
rem s w+
=⎧⎪
= +⎨⎪⎩
: ,                   (3) 
where rem( i ) is the remainder function, : is the correlation 
between two codewords, and s = 0, 1,…, (N-1). To have the 
network in moderate security, we can find a manner of 
constructing the elements of the secure codeword Y0= (y0, 
y1,…, yN-1) in the same code length as follows. 
( ) ( )1 for 0, 1 , , ( 2) 1
0 otherwise                               
  ,  
  ,        i
i w w w
y
⎧ = + − +
= ⎨⎩
… .      (4) 
Then, q-th secure codeword Yq = TqY0 can be generated by 
cyclically shifting the codeword Y0 to the right by q times, 
where q = 0, 1,…, (w+1). Table III shows the secure codes for 
w=3 and N=8. 
TABLE III.  THE SECURE CODES FOR W=3 AND N=8 
q Secure Sets Codeword Yq
0 {0, 4} 1000  1000 
1 {1, 5} 0100  0100 
2 {2, 6} 0010  0010 
3 {3, 7} 0001  0001 
III. SYSTEM DESIGN 
In this section, we design the SAC OCDMA PON with the 
moderate security and the capability of removing the 
influence of the MUI in accordance with (3). Fig. 1 depicts 
the compact SAC OCDMA PON, which consists of a compact 
OLT, a remote node (RN), and N/2 ONUs. Based on the 
property of the SPD code, each ONU is designated two SPD 
codes as its codeword, called the two code keying (TCK) [9]. 
That is, if the data bit of the User n is “1”, Xn is transmitted; 
otherwise, Xn+N/2 is transmitted. The OLT includes a 
unpolarized broadband source (BBS), a 1×(w+1) splitter, N×N 
and (w+1)×(w+1) AWG routers, a (N/2+1)×1 coupler, a 
(w+1)×1 switch, and N/2 2×1 optical switch modulators 
(OSMs) to perform the electro-optic (E-O) conversion. Note 
that the (w+1)×1 switch is to provide network with the degree 
of the distinct security by a set of secure data operating at the 
different variation in time and rate. Suppose that the BBS has 
the spectral width, Δv, centered at wavelength vc and the 
bandwidth of each channel of the AWG routers is Δv/N. First, 
the 1×(w+1) splitter distributes the output of the BBS to the 
input ports of the upper AWG router according to the cardinal 
of the weight of X0 and to the 0-th input port of the lower 
AWG router. Subsequently, for the upper path the incident 
signals with the wavelengths are routed to diverse output ports 
of the N×N AWG router, which can be formulated as [6] 
#input port ⊕  #output port = #wavelength,               (5) 
Fig. 2 shows that the BER versus the number of 
simultaneous users with similar code length and Psr =-10dBm 
when the data rate for each user is 2.5Gbps. The results for the 
M-sequence (MS) code, modified legendre (ML) sequence, 
EPDC, MQC code, and our codes are shown for comparison. It 
clearly shows that the PON using our codes has a good 
performance than that using other codes at BER=10-9. In 
addition, the system performance can be improved by 
increasing the code length. Though the SPD code with TCK 
scheme raises an issue on the expenditure of cardinalities, it is 
fairly significant that the proposed PON using our code 
concurrently has the merits of a good data rate, a high number 
of simultaneous users, the moderate security, and a simple 
configuration. 
V. CONCLUSION 
This paper presents the SPD code family appropriate for 
SAC OCDMA PON applications. To design a compact OLT, 
we use N×N and (w+1)×(w+1) AWG routers to generate all the 
SPD and secure codes, respectively; besides, the corresponding 
ONUs are constructed using FBGs. Based on the numerical 
results, it shows that the proposed code has a better 
performance at Psr =-10dBm. As a result, the SPD code family 
is a candidate for the SAC OCDMA PON application. 
REFERENCES 
[1] M. Kavehrad and D. Zaccarin, “Optical code-division-multiplexed 
systems based on spectral encoding of noncoherent sources,” J. Lightw. 
Technol., vol. 13, no. 3, pp. 534–545, Mar. 1995. 
[2] J. F. Huang, C. C. Yang, and S. P. Tseng, “Complementary Walsh-
Hadamard coded optical CDMA coder/decoders structured over 
arrayed-waveguide grating routers,” Opt. Commun., vol. 229, no. 1-6, 
pp. 241–248, Jan. 2004. 
[3] C. C. Yang, “Modified legendre sequences for optical CDMA-based 
passive optical networks,” IEEE Commun. Lett., vol. 10, no. 5, pp. 393–
395, May 2006. 
[4] C. C. Yang, J. F. Huang, and S. P. Tseng, “Optical CDMA network 
codecs structured with M-sequence codes over waveguide-grating 
routers,” IEEE Photon. Technol. Lett., vol. 16, no. 2, pp. 641–643, Feb. 
2004. 
[5] Z. Wei, H. M. H. Shalaby, and H. Ghafouri-Shiraz, “Modified quadratic 
congruence codes for fiber Bragg-grating-based spectral-amplitude-
coding optical CDMA systems,” J. Lightw. Technol., vol. 19, no. 9, pp. 
1274–1281, Sept. 2001. 
[6] S. P. Tseng and J. Wu, “Extended perfect difference codes for SAC 
optical CDMA PONs,” IEEE Commun. Lett., vol. 12, no. 8, pp. 587–
589, Aug. 2008. 
[7] T. H. Shake, “Security performance of optical CDMA against 
eavesdropping,” J. Lightw. Technol., vol. 23, no. 2, pp. 655–670, Feb. 
2005. 
[8] C. S. Weng and J. Wu, “Perfect difference codes for synchronous fiber 
optical CDMA communication systems,” J. Lightw. Technol., vol. 19, 
pp. 186-194, Feb. 2001. 
[9] C. C. Yang, “Optical CDMA passive optical network using prime code 
with interference elimination,” IEEE Photon. Technol. Lett., vol. 7, no. 
19, pp. 516–518, Apr. 2007. 
[10] G. Keiser, “Optical fiber communications,” 3rd ed., McGraw-Hill, 2000. 
 
97 年度專題研究計畫研究成果彙整表 
計畫主持人：吳靜雄 計畫編號：97-2221-E-002-146-MY3 
計畫名稱：前瞻光通信元件及系統技術研究與其在寬頻網路之應用--子計畫一:光編碼技術研究及應用
於接取網路 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 3 0 100%  
博士生 1 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 8 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 3 0 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
