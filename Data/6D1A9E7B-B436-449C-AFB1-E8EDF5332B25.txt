流程如圖 2所示，經由核電廠的實驗資料驗證，其平均相對誤差均小於 30％、
平均絕對誤差均小於 130 克。 
 
輸入層 隱藏層 輸出層
(28個神經元)        (15個神經元)       (1個神經元)
xe
xf −+= 1
1)(
傅立葉轉換
撞擊訊號
頻率比值
(1)
頻譜重心
(1)
線性預估編
碼法係數
(26)
估測質量
類神經網路
 
圖 2. 質量估測流程圖[3] 
 
三、研究方法 
本研究發展演算法來分辨撞擊訊號與非撞擊訊號及估測鬆動元件的質量，除
使用包含頻譜特性的「頻率比值」作為質量估測的第一個特徵外，另外將語音辨
識技術取得的「梅爾倒頻譜係數」，利用「線性識別分析法」的降維方式取得第
二個特徵：「撞擊特徵」和「質量特徵」。利用頻率比值和撞擊特徵可將撞擊訊號
和泵啟動訊號辨別分開；利用頻率比值和質量特徵可以將撞擊訊號質量大致區分
成較輕(一磅以下)與較重(兩磅以上)兩類。 
 
（一）特徵選取 
○1 梅爾倒頻譜係數[4、5、6] 
    在語音辨識（Speech Recognition）和語者辨識（Speaker Recognition）方面，
最常用到的語音特徵就是「梅爾倒頻譜係數」（Mel-scale Frequency Cepstral 
Coefficients，簡稱 MFCC），此參數考慮到人耳在頻域上的感知，並非全頻域有
相同的敏感度，正常情形下對於低頻有較高的解析度，頻率越高，人耳所能分辨
的差異性越低，因此特別適合用在語音辨識，而我們將其應用於鬆動元件撞擊後
產生的聲音訊號分析，藉由此特徵的選取來增加質量估測的準確性，圖 3為梅爾
倒頻譜係數流程圖。 
 
 
圖 3. 梅爾倒頻譜係數流程圖 
 
首先，將訊號做快速傅立葉轉換，由於訊號在時域上的變化通常很難看出訊號的
特性，所以通常將它轉換成頻域上的能量分佈來觀察，不同的能量分佈，就能代
表不同語音的特性，接著將將能量頻譜乘以一組 20 個三角帶通濾波器，求得每
一個濾波器輸出的對數能量，最後將 20 個對數能量 P(m)帶入離散餘弦轉換求得
2 
 
可將投影量的平方和拆成兩部分： 
WddBddTdd TTT +=  
而最終目的是希望找到某個單位向量 d，使得投影後同類別間盡量集中，而不同
類別間盡量散開，所以可以很直覺的定義一個目標函數： 
Wdd
BdddJ T
T
=)(  
可以把線性識別分析歸納成三個步驟： 
1.尋找能得到最大 J 值的單位向量 。 1d
2.在符合 的條件下，尋找能得到最大 J 的單位向量 。 012 =Wdd T 2d
3.在符合 的條件下，尋找能得到最大 J 的單位向量 ，其中 1≦i<k。 0=iTk Wdd kd
將 稱為最能識別該組資料的識別向量(discriminant vectors)。 id
     
四、結果與討論 
分析的數據是由台電核三廠和核能研究所提供，其方法是於核三廠一號機大
修期間進行模擬敲擊數據收集[9]。 
 
（一）頻率比值分析 
    頻率比值的高、低頻區範圍要如何選取是首先研究的項目？其重點首先為質
量與頻率比值有質量愈大，頻率比值愈大的趨勢，其次為希望所得到的頻率比值
在相同質量下具有一致性，不同的質量間具有較大的差異性。所得的頻率比值的
平均值示於圖 5。其中，編號 1、2 的頻率比值有隨著質量增加而增加的趨勢，
編號 3、4、5則無此規則性，又編號 1的頻率比值較編號 2更接近線性，因此選
擇編號 1（低頻區：0.4K～4.6K，高頻區：5.8K～10K）的範圍作後續的分析。 
 
     圖 5. 頻率比值高頻區與低頻區範圍選擇圖 
 
將所有實驗訊號進行頻率比值的分析，如圖 1所示，可以由圖看出，當橫軸的質
量越大時，縱軸的頻率比值有越大的趨勢。 
 
（二）特徵粹取分析 
取得所有訊號的梅爾倒頻譜係數後，取其中四分之三的數據進行線性識別分
析法，並利用剩下四分之一的數據做測試，其結果如圖 6所示:  
 
4 
 
圖 8. 泵啟動訊號其頻率比值 
 
圖中顯示泵啟動訊號等效的質量大致都在 1.5 磅以下，因此在判斷是否為撞擊訊
號時，可以頻率比值為 1.1 做第一道區分，若頻率比值小於 1.1，視為可能的泵
啟動訊號，而泵啟動訊號和較輕質量（一磅以下）的撞擊訊號如何區分？接著利
用四分之三的數據做線性識別分析如圖 9(a)所示，由圖可將特徵 2的值為-0.42
做為分界點，大於-0.42 判為較輕質量的撞擊訊號，小於-0.42 判為泵啟動訊號，
並利用剩下四分之一的數據做測試，其結果如圖 9(b)所示，可以發現泵啟動訊
號均小於-0.42，而較輕質量的撞擊訊號均大於-0.42，因此泵啟動訊號和較輕質
量的撞擊訊號是可以辨別分開，將此特徵 2另命名為撞擊特徵（Impact Feature）。 
 
                   圖 9. 泵啟動訊號其梅爾倒頻譜係數利用線性識別分析法投影 
(a) 3/4 數據做線性識別分析法             (b) 1/4 數據做測試 
 
 
（三）程式設計 
    根據前述的分析，本研究將發展一個程式，當輸入訊號，可求出梅爾倒頻譜
係數，並經由快速傅立葉轉換求得頻率比值，若頻率比值小於 1.1，則結合第一
次線性識別分析法求出的撞擊特徵區分為撞擊訊號(較輕質量)或非撞擊訊號；若
頻率比值大於 1.1，在利用第二次線性識別分析法求出的質量特徵配合頻率比
值，可將質量分為較輕(一磅以下)與較重(兩磅以上)兩部分，其流程圖如圖 10
所示。 
 
6 
 
（四）蒸汽產生器 B、C 訊號之分析 
    上述過程均是對蒸汽產生器 A的訊號做分析，而在蒸汽產生器 B 和 C 方面，
僅有 0.5 磅敲擊鎚模擬敲擊的訊號，首先做頻率比值的分析，將結果繪於圖 12，
由圖可以看出在 0.5 磅敲擊時，蒸汽產生器 B和 C訊號的頻率比值會較蒸汽產生
器 A偏高且分佈的範圍較大，這是因為當初定義頻率比值的高、低頻區範圍是以
蒸汽產生器 A的訊號分析做決定，根據 Szappanos[10]等人提出的觀點，高、低
頻區範圍是會隨著不同的感測器而有所改變，所以應該另外決定蒸汽產生器 B
和 C頻率比值的高、低頻區範圍。 
 
 
圖 12. 蒸汽產生器 B、C訊號之頻率比值圖 
 
    因為蒸汽產生器 B和 C僅有 0.5 磅的敲擊訊號，所以無法做線性識別法的分
析，但經由蒸汽產生器 A訊號所得的識別向量可否用來分辨蒸汽產生器 B和 C
的訊號為較輕或較重質量？因此將蒸汽產生器B和C的訊號經由前述的識別過程
來測試，可以得到如圖 13 的結果。 
 
      
圖 13. 梅爾倒頻譜係數利用線性識別分析法投影至前兩維向量圖 
(a)蒸汽產生器 B               (b)蒸汽產生器 C 
 
由圖中可以看出，不論蒸汽產生器 B或 C，其 0.5 磅敲擊訊號經由蒸汽產生器 A
的識別向量分析後，無法辨別其質量為較輕或較重，因此較正確的作法是取得蒸
汽產生器 B和 C其他質量的敲擊訊號後個別做線性識別分析，求取個別的識別向
量，以達到分辨質量的目的。 
 
（五）結論與建議 
    由於撞擊訊號亦為一種語音訊號，於是利用語音辨識技術取一項重要的語音
特徵：梅爾倒頻譜係數，再利用線性識別分析法的降維方式粹取特徵，經由本論
文的研究，將 12 維的梅爾倒頻譜係數投影至 1 維，但只用此質量特徵在不同質
量還是會有重疊區域，所以此特徵只作為第一道區分，為了提高質量估測的正確
8 
參考文獻 
 
[1]. T. Tsunoda, T. Kato, K. Hirata, Y. Sendai, M. segawa, S. Yamatoku, T. Morioka,  
K. Sano, O. Tsuneoka, “Studies on the Loose Part Evaluation Technique”, Progress in 
Nuclear Energy, vol. 15,pp. 569-576, 1985. 
 
[2]. 李竹諭, “鬆動元件之質量與位置估測演算法研究”, 清華大學碩士論文, 2003. 
       
[3]. 核能研究所與核三廠 LPMS 訓練課程教材. 
 
[4]. Thomas F. Quatieri, Discrete-time speech signal processing, Prentice Hall, 2002. 
      
[5]. 王小川, “語音訊號處理”, 全華科技, 2004. 
       
[6]. 張智星, 音訊處理與辨識上課教材, 2006. 
       
[7]. J. Duchene, S. Leclercq, “An optimal transformation for discriminant and principal 
component analysis’’, IEEE Trans. PAMI, vol. 10,pp. 978-983, 1988. 
 
[8]. R.O. Duda, P.E. Hart, D.G. Stork, Pattern Classification, Wiley, 2001. 
 
[9]. “核三廠反應器金屬鬆動元件監測系統更新案：模擬敲擊測試計畫與測試報告’’,
核能研究所核能儀器組, 2003. 
 
[10]. G. Szappanos, J.J. Kiss, G. Por,  ” Analysis of measurements made by helps loose 
part detection system during installation and operation periods “, Progress in 
Nuclear Energy, vol. 34,pp. 185-193, 1999. 
 
 
 10
