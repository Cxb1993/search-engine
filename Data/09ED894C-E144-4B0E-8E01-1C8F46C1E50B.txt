 2 
中文摘要 
本計畫的目的在於將各不同領域先進科技研究成果技術整合，包含：大腦人機介面、主
動式影像監控追蹤與辨識、有線、無線通信技術、電力電子與馬達驅動控制技術、新型接觸
力感測裝置及適應性剛度控制…等先進科技研究。將以上不同領域先進技術整合應用於智慧
型居家照護系統。 
本計劃為三年期計劃，包含四個子計劃。第一子計劃將著重於大腦人機介面研究，試圖
建立即時量測系統、想像運動之訊號偵測技術開發、實驗進行之設計，找出與相關且具有意
義的腦波，設計能夠分出左手、右手以及兩手之想像運動的分類器以判別病人之意圖，以供
第四子計劃控制中心調整病床或呼叫看護服務。 
第二子計劃將著重於多功能智慧型病床之研究，試圖設計出本土性多功能病床，以適合
本國人體型之病床，並嘗試偵測病人與病床間之接觸力，進而由第四子計劃調整病床以滿足
病人之舒適感覺。 
第三子計劃主要著重於影像資料之監控與辨識功能建立 將監測的影像做為病床調整之
依據 並依影像辨識出病人的需求，以供第四子計劃控制中心調整病床或呼叫看護服務。本子
計畫與第一子計劃相輔，將判讀影像信號供第四子計劃控制中心調整病床或呼叫看護服務。 
第四子計劃將著重於系統控制，整合其餘三個子計畫處理後之有關病人之需求信號。若
為病床調整需求，此子計畫則直接驅動病床馬達以調整病床姿態。若為看護需求，則透過有
線及無線通信介面，通知看護前來服務。 
因此，本系統預計不但能夠提升居家照護系統之品質，降低照護人員之負荷，並減輕社
會成本的負擔，更能夠提高病人自我的滿意度，提昇病人的生活品質與人性尊嚴。 
 
關鍵詞：看護系統，居家照護，病床。 
 4 
研究動機 
台灣人口年齡分佈結構正朝著老齡化發展，老年人和成年人的比重開始增加。並非只有
台灣有此現象，全世界各國亦皆有此情況，只是老齡化社會形成的速度快或慢。探究其原因，
除了是由於醫學進步所造成的低死亡率外，另一個主要原因則為夫妻生育兒女的意願較以前
低落。老齡化社會的結構會產生一個最直接也是最主要的問題：老年人的醫療照護需求急遽
增加。除了老年人需要醫療的照護外，年輕人但是具有先天或後天所造成殘障也是一樣需要
看護人員照顧平時的生活起居。漸凍人 (Amyotrophic Lateral Sclerosis, ALS) 以及四肢麻痺或
癱瘓等病患皆是屬於無法自行照顧而需要照護人員協助的患者。有鑑於此，護理照護技術和
居家看護系統將會越來越顯重要。然而，目前的居家照顧大多仍是以聘用專門的照顧或看護
人員，以一對一方式，專責照顧。但是並非所有的人皆能負擔起聘請專門看護人員所需的費
用，而且如此亦會增加所謂的社會成本。 
因此本計畫主要目標為發展出一個全新的多功能智慧型看護系統。依照使用者（患者）
的需求，利用使用者本身的腦波或者手勢來完成控制病床的姿態調整動。並能完成控制按摩
墊和撥打電話等控制動作。本計畫所發展出的多功能智慧型型看護系統具有以下相關核心技
術：(1)、大腦人機介面 (Brain computer interface, BCI)，(2)、主動式視覺和圖形識別之病患
監看系統，(3)、有線與無線病患緊急通聯系統，(4)、電力電子和馬達驅動電路設計。 
大腦人機介面的部分是藉由辨識大腦的腦波訊號來控制外在周遭事物。此系統對於漸凍
人或四肢癱瘓的病人特別有幫助。因為這些病患雖然無法自主地控制四肢活動，但是他們的
意識和思考仍是清楚的。所以還是可以藉由偵測並辨識其腦電波訊號 (Electroencephalography, 
EEG) 來送出病床或其相他相關的控制訊號。一套大腦人機介面系統腦波訊號擷取、濾波和
放大電路，以及訊號的辨識轉換電路。 
在此計畫中，病床機構的部分亦是自行設計的，以符合台灣人的體型。病床機構上除了
安裝用來調整病床姿態的馬達外，也設置了病床作動限制開關，用來限制機械結構的動作範
圍。用來防止病床機構做出超過人體動作極限而造成病患的肢體傷害。 
本計畫的第三個部分為提出病人安全監督技術。利用擷取病人影像和圖形識別技術來辨
識出病患的需求，並下達病床等控制命令給病床中央控制中心。此影像控制技術可以針對那
些仍具有肢體控制能力的人做使用。 
最後，本計畫設計了一個中央控制中心，用來接收來自腦波訊號處理以及影像處理後的
病床等控制命令。並且根據收到的控制命令，控制並驅動對應的馬達來改變病床的姿態或相
 6 
子計畫一：以視覺誘發電位為基礎的大腦人機介面系統 
目前部分非侵入式的大腦人機界面系統 (Brain Computer Interface, BCI)，需花費較多的訓
練時間才能夠使用 [1-2]，但是以視覺誘發電位為基礎的大腦人機界面系統，就不需花費太多
的訓練時間即可使用，然而此系統又具備較高的資訊傳輸率 (Information Transfer Rate, ITR)，
所以本子計畫一決定使用以視覺誘發電位為基礎的大腦人機界面系統。視覺誘發電位為基礎
的大腦人機界面系統依照閃爍光源的規則，可以進一步區分成穩態視覺誘發電位 
(Steady-State Evoked Potential, SSVEP) [3-4] 與閃光視覺誘發電位  (Flash Visual Evoked 
Potential, FVEP) [5] 兩種。 
其中，穩態視覺誘發電位是產生出一組不同頻率的閃光序列，經由傅立葉轉換 (Fourier 
transform) 來進一步的偵測腦波；而閃光視覺誘發電位則是利用隨機編碼的方式產生閃光序
列，再利用視覺誘發電位與閃光時序之間的相關性，分析目前使用者所注視的閃光選項。上
述這兩種（穩態視覺誘發電位與閃光視覺誘發電位）皆互有優缺點，穩態視覺誘發電位是利
用頻率來對閃光做編碼，此種編碼需要考慮到一些人體的基本生理訊號（如：心電圖、alpha
腦波、beta 腦波等），導致穩態視覺誘發電位有閃光數目受到限制的問題；閃光視覺誘發電位
則利用隨機編碼程序製作出隨機閃爍的光源，如此的程序會因為閃光數目增加，而導致視覺
誘發訊號時間過長的問題。所以本子計畫一想利用多頻相位編碼來達成速度快又穩定的方
式，並且不會失去閃光的數量。 
 
視覺誘發電位 
視覺誘發電位 (Visual Evoked Potential, VEP) [6] 是指當人眼受到外界視覺刺激，在大腦
視覺區中所產生對應的生理訊號，這就是所謂的視覺誘發電位。外來的視覺刺激在大腦裡所
誘發的訊號，可在頭皮上或是腦皮層上測量到訊號 [7-9]，在此通常會選擇使用腦電波訊號
(Electroencephalogram, EEG) 在大腦視覺區的頭皮上記錄與觀測誘發的電位 [10]。視覺刺激
的材料可分為閃爍的光源或者是螢幕上圖形的顏色轉變，圖形的顏色轉變最常使用的是黑色
轉為白色的過程。視覺誘發電位的測試過程中，須要 3 個或更多的電極使用電極膠來附著於
受測者的頭皮上，電極放置位置要根據國際 10-20 系統 [11] 的 Oz 上，這個位置是最接近大
腦功能區中的主要視覺區，參考圖一左下方。緊接著要求受測者去盯著閃爍光源或者是螢幕
上圖形的顏色轉變，刺激產生後可在電極上記錄到特定的生理訊號，這是由大腦視覺神經系
 8 
 
(a) 
 
(b) 
圖二、(a)：視網膜所誘發的神經訊號。(b)：經過大腦視覺皮質的第二次放大。(a) 與 (b) 的
左上方是刺激的陣列、右上方為計算出的瞬間響應、下圖為 3 維的響應密度 [7] 
 10 
穩態視覺誘發電位的大腦人機界面系統 
穩態視覺誘發電位有著較高的辨識率、較少的訓練時間和非侵入性擷取訊號。它主要是
利用頻率編碼的視覺刺激來誘發腦電波，將誘發出的訊號經由快速傅立葉轉換 (Fast Fourier 
Transform, FFT) 來偵測頻率，如此可知道使用者所注視的選項 [3] [14-15]。在此作者提出瞬
間視覺誘發電位和穩態視覺誘發電位的差異，當刺激頻率低於 2Hz 的時候就是瞬間視覺誘發
電位，刺激頻率超過 6Hz 的時候就是作者所提的穩態視覺誘發電位。圖五為穩態視覺誘發電
位的系統架構圖，圖中可看到與受測者所連接的第一個方塊，它主要是利用腦電波訊號來獲
得訊號，並且遵照國際 10-20 系統 [11] 所定義的 O1 與 O2 來當做訊號來源，O1、O2 與 Oz
的位置可參考圖六。O1、O2 和 Oz 在圖中是彼此相鄰左右，它們所座落的地方皆為大腦皮質
的視覺區域，可看到圖六中的 Fz 處是國際 10-20 系統 [11] 的所有電極的參考點，這個參考
點的好壞是會影響到整個訊號的重要關鍵。 
 
圖五、以視覺撥電話的架構圖，是以穩態視覺誘發電位為基礎的大腦人機界面系統 [3] 
 
圖六、左圖為大腦橫剖面圖（圖上方為人的正面下方為枕骨），右圖為大腦的直剖面圖 [15] 
 12 
 
(b) 
圖八、穩態視覺誘發電位的大腦人機界面系統頻譜圖，刺激頻率 7Hz，峰值出現在 7Hz、14Hz
和 21Hz。(a)：單一片段訊號的傅利葉轉換。(b)：40 次平均的傅利葉轉換 [3] 
 
 
圖九、穩態視覺誘發電位在 2006 年提出的架構圖 [4] 
 14 
 
圖十一、閃爍光源的頻率對振幅響應 [4] 
 
 
圖十二、閃爍光源的訊號對雜訊的比例 [8] 
 16 
此系統閃光的方式是使用隨機編碼的程序，也就是螢幕上會有數個光源產生出隨機亮或
暗的變化，P.L. Lee 文獻中 [5] 提到閃光是隨機編碼產生的，但也要遵循圖十四規則來產生
閃爍光源的亮或滅，會有此規則是考慮到閃光彼此之間要有獨立性與視覺神經的反應時間。
所謂的獨立性是指同一時間不能同時有兩個閃光由暗到亮 (flash onset) 或亮到暗 (flash 
offset)，圖十四隨機產生的閃光區間中有一個固定時間 120ms，這是考慮視覺神經反應所需要
的時間，而後段的區間是隨機產生的變數區間，目的是要區隔出不同的閃光，如此一來就可
以構成圖十五隨機閃爍光源。 
 
 
圖十四、每個閃光序列規劃的隨機 ON（白）或 OFF（黑）區間 [5] 
 
 
圖十五、隨機編碼的閃爍光源 [5] 
 
接著要介紹的是訊號處理的方式，閃光視覺誘發電位與穩態視覺誘發電位在訊號的處理
上有很大的不同，穩態視覺誘發電位是直接對腦電波訊號取一個固定時間長度來做快速傅立
葉轉換並偵測頻率，但是閃光視覺誘發電位只選取閃爍光源由暗到亮的一瞬間所誘發的訊
號，參考圖十六。由於腦電波訊號的訊號本身就非常微弱，所以很容易被雜訊給干擾，因此
 18 
 
圖十七、閃光視覺誘發電位訊號處理流程的範例 [5] 
 20 
人機界面系統」。本系統的優勢在於能夠利用較少的閃光頻率達成多通道的目的、閃光順序不
凌亂的視野畫面、不受其他生理訊號的干擾、較穩定及快速的辨識時間和較少的測量電極數
目。圖十九為多頻相位編碼之閃光視覺誘發電位系統架構圖，本架構與一般以視覺誘發電位
為基礎的大腦人機界面系統大同小異。 
 
 
圖十九、多頻相位編碼之閃光視覺誘發電位的大腦人機界面系統架構圖 
 
首先看到大腦上的電極，其位置也是根據國際 10-20 系統的視覺區 Oz [11]，至於參考點
則置於耳後的 mastoid 處；會有第三個電極接點是因為使用抗雜訊好的儀表放大器，儀表放
大器本身就須要三個接點，分別是訊號的正源、負源和接地，本研究所使用的放大器是
PowerLab 提供的 ML135 Dual BioAmp，儀器中的正負源在圖十九上分別是 Oz 和耳後，接地
電極則置於前額。在 BioAmp 之後所連接的是類比到數位轉換器 (A/D)，目地是將類比資料
取樣量化後在電腦上做處理，A/D 卡的部份，選擇 National Instruments 的 NI-6259 儀器。微
處理器主要的功能是產生出多頻相位編碼序列，來提供視覺裝置上的 LED 閃爍（圖十九中有
數字的部份），並將這個編碼序列傳送到電腦上與腦電波訊號做關聯處理。由於相位編碼需要
較精準的控制方式，所以微處理器是一個最好的選擇。圖二十是一個閃爍光源的輸入裝置（與
圖十九左上方的區塊相同），它由 8 個多頻相位編碼的閃爍光源所構成，每個光源是白色圓形
 22 
子計畫二：多功能病床之床體模組 
子計畫二的多功能病床之完整結構如圖八所示，包括仰背、舉腿、病床整體上昇和床體
位置調整等機構，結合能減少壓瘡產生的健康氣墊床，希望能帶給病人更舒適的環境，並且
為了配合各個子計畫，且使多功能病床更加一體，因此在病床機構上，配合各子計畫所需設
計出相關的機構。 
 
圖二十一、多功能病床之完整結構 
其中仰背、舉腿、病床整體上昇這三種機構分別由三個 DC24V 的直流馬達來帶動並達成其動
作，仰背和舉腿機構能幫助病人調整到舒適的姿勢，而病床整體上昇下降則能幫助病人上下
床時更加便利，另外，為了病人的安全考量，在機構上利用所謂的拉線式光學譯碼器和極限
開關做為雙重確保，分別規劃出機構的上止點和下止點，當機構運作到上止點或下止點時，
就會送出訊號通知控制器自動停止馬達的運轉，圖二十一即為病人透過這三種機構調整多功
能病床之照片，比較圖二十一和圖二十三，可以明顯發現病床的調整和變化。 
 
圖二十二、拉線式光學譯碼器和極限開關 
 24 
此計畫為一整合型計畫，故需配合「子計畫一:腦波辨識人機介面系統之建立」，此子計
畫目的在於當病人為全身癱瘓、四肢無法行動時，只需以眼睛注視於腦波辨識人機介面系統
的圖示，就能透過腦波傳達訊號，不需旁人栛助就可自行控制多功能病床，而此機構則是配
合上述的要求，而設計出能安裝腦波辨識人機介面系統的龍門機構，如圖二十五所示，該龍
門採用鋁擠型組裝而成，龍門上面則裝有懸掛架，不但可以懸掛自製的螢幕系統，更可以懸
掛 LCD 螢幕等，具有三軸六向的免工具調整功能，可以方便調整到病人適合觀看的角度。 
 
圖二十五、安裝腦波辨識人機介面系統的龍門機構 
除了配合子計畫一，也需要配合「子計畫三：看護系統之監控與辨識功能建立」，此計畫
主要是以影像處理的方法來辨識病人的手指作為命令訊號，於是根據需求設計出攝影機的架
設機構，如圖二十六所示，此機構能依病人身材的不同，進而調整攝影機的位置和高度，使
攝影機能夠清楚拍攝到病人的手，並順利辨識出病人的手指動作。 
為了使多功能病床能在停電時也可以正常動作，我們加裝了二顆 12AH 的充電電池（圖
二十七），該充電電池固定在病床上，並能隨病床移動，每顆電池可提供 12V 的直流電，並
連兩顆就可以驅動多功能病床上的直流馬達，因此當無法正常供電下，備用電池的電力就能
被啓用，維持多功能病床的運作。 
 
 
 26 
床體上升和下降及病床移動等動作。在固定負荷下，直流馬達的旋轉速度和轉子的扭矩成正
比，扭矩愈大，轉速愈大。對永磁式直流馬達而言，定子的磁場強度固定不變，所以轉子的
扭矩完全由線圈的感應磁場強度決定，因而扭矩 Te 就正比於電樞電流 Ia: 
  (1) 
其中 Kv 為扭矩常數。由動力學的 Euler 公式可以得出轉速 的動態方程式為 
  (2) 
其中 J 為轉子的慣性矩，Bm 為動摩擦係數，TL 為負荷力矩。 
由以上的式子，可以看出直流馬達的速度控制可由控制電樞電流來達成，而電流的控制
也可以改為控制輸入電壓，因為線圈的電阻是固定的。因此直流馬達的控制有所謂的穩定電
流和穩定電壓。前者為輸入電流命令，控制輸出電流值等於輸入命令。後者則是控制輸出電
壓值等於輸入電壓命令。實現這二種控制方法的最簡單方式為使用脈寬調變 PWM 輸出。在
供應電源的電壓保持不變，利用電子開關元件，在極短的週期內控制開與關的時間比（又稱
工作週期 duty cycle），使得平均電壓隨該比值變化來達到控制電壓的目的 [24]。 
而一般在控制馬達執行某一特殊功能時，可將其控制法則以類比電路、微處理器 [17]、
數位訊號處理器與控制 IC 來實現，其優劣見表一。 
最後我們決定使用 VHDL 設計 FPGA 之硬體電路，進而以 FPGA 設計一多功能病床專用
IC 能驅動床體各軸馬達，並處理床體各軸編碼器回授訊號。加上現在新的 IC 設計技術，主
要是以 FPGA 晶片來模擬 IC 的功能，也具有高時效性，其設計流程圖如圖二十八。 
我們決定使用 Xilinx 的軟體處理器 (MicroBlaze) 所設計的硬體發展板，如圖二十九和圖
三十所示，其包含 SpartanII-XC2s100-PQ208-FPGA 與相關的週邊,所有的週邊均已連接到
FPGA 的接腳,所以可以以程式語言來驅動週邊的動作,這些週邊包含 8 LED, 4 Push Buttom,2
個 RS232,128x 64 LCD 等，板子的後面有 XC2S100-PQ208 等級的 FPGA，提供將 MicroBlaze
植入 SpartanII FPGA 的驗證平台。 
 
 
 
 
 28 
 
圖二十八、FPGA 晶片設計流程圖 
 
圖二十九、FPGA 硬體發展板正面 
 
 
 30 
而 FPGA 的程式是採用 VHDL 語言撰寫，分成速度控制程式和速度量測程式兩部份，其
中速度控制程式是利用 PWM 輸出來控制馬達的轉速，這部份程式，一開始我們是想利用除
頻來調整其 Duty cycle，先利用 ModelSim 軟體模擬可以動作，但實際上可能因為頻率沒處理
好卻無法順利控制馬達，最後改採產生一組遞減型鋸齒波來和參考電壓比較，產生一組後緣
對齊型的 PWM 訊號，另外再配合利用按鍵解彈跳電路等來完成全部的功能，其 RTL 模型圖
(Register Transfer Level)如圖三十二所示。而速度量測程式則是用來量測光學角度解碼器的
A/B 兩相訊號，分別加以上緣微分和下緣微分得到 A+/A-/B+/B-的四個微分訊號，整合成正轉
脈衝訊號，當光學角度解碼器每轉一個單位孔距就可得四個脈衝訊號輸出，稱之為乘四解碼
電路，其 RTL 模型圖(Register Transfer Level)如圖三十三所示。 
 
圖三十二、FPGA 之 PWM 控制的 RTL 模型圖 
 
圖三十三、FPGA 之乘四解碼電路的 RTL 模型圖 
 
 
 32 
的醫療問題 [25]，而壓力的強度及受壓的時間是形成壓瘡的重要因素，壓力愈大壓迫的時間
愈久愈容易形成壓瘡，此概念可以如此之式子表達：時間 x 壓力 = 閾值 (2hrs)；故壓力雖
小，但長時間的壓迫，仍然可以產生壓瘡，臨床上強調翻身，目的就是要舒解組織的壓力[26]。
因此，本計畫設計了一個預防壓瘡之壓力量測模組，希望能夠量測出病人施加在病床上的壓
力，並主動去提醒病人或家屬幫助翻身和按摩。 
我們是採用 PVDF 壓電感測器，用來量測接觸力之大小，因為 PVDF 薄膜型壓電感測器
相當薄（見圖圖三十七），隱藏在床墊上層的布底下，也不會給病人帶來不舒服的困擾，並且
將 PVDF 壓電感測器安裝在臨床研究上容易形成壓瘡的部位，如圖三十五所示。 
 
圖三十五、PVDF 壓電感測器安裝部位 
 因為 PVDF 壓電感測器量測到的訊號電壓很小，所以必須配合 LM358 這顆 IC 來驅動並
放大訊號，其電路圖如圖三十六所示，另外再配合所購買的 PVDF 驅動放大器（見圖三十七）
可以自由選擇放大的倍率為 10 倍或 100 倍，放大後的訊號經過研華數位類比資料擷取卡
(PCL-818H) 的 A/D 轉換儲存至電腦中。在電腦操作方面，主要是由 VB 程式語言撰寫成一人
機介面，此程式擷取經 A/D 轉換的壓力訊號的取樣頻率為 1KHZ，此程式並能將結果記錄到
資料庫 (EXCEL) 中，並可定時將資料做分析來判斷病人的臥床受壓情形，目前是使用每 90
分鐘的資料做平均並與以知受壓時擷取到的資料平均做比較，來判斷病人是否在 90 分鐘內未
改變該部位的姿勢，如果病人都未改變其姿勢，系統就會發出警告告知病人或在旁的看護、
家屬、護士等人，另外也可以配合啟動按摩床墊模組幫病人按摩或復健系統模組幫病人運動
以促進血液循環，降低得到壓瘡的風險。 
 
圖三十六、PVDF 壓電感測器之放大電路圖 
 34 
 
圖三十八、醫療保溫床墊之溫度控制電路正面圖（採用 FPGA 晶片） 
 
圖三十九、醫療保溫床墊之溫度控制電路背面圖 
 
復健系統模組 
本計畫也開發了「復健系統模組」，透過此模組就可以幫助病人在病床做簡易的復健動
作，圖四十和圖四十一為本模組的硬體架構圖，借由電腦來當控制器，並使用研華 PCL-726
卡做為控制輸出（見圖四十二），其功能如表二所示，我們透過研華 PCL-726 卡的 D/A 轉換
來控制兩顆馬達，首先需設定欲控制的馬達和強弱大小，之後由按下確認後，由 PCL-726 來
接收電腦下達的數位命令再經由 PCL-726 轉成類比的輸出給所架設的硬體電路，此硬體電路
是由 4 個電流放大器所構成，會將 1V 的電壓轉換成 0.5 安培的電流來輸出，經由電流大小的
改變就可以控制馬達的轉速變化進而控制復健動作的快慢，並使用 D/O 轉換來抓取極限開關
的訊號，作為馬達停止的條件。並使用 VB 撰寫出復建系統控制的人機介面，如圖四十三所
 36 
表二、PCL-726 卡規格 
Specifications 
    Bus                           ISA 
    Control                       A/D、D/A、digital input、digital output 
    Functions                     counter/timer 
    Digital                       16bits   
    D/A Output                   six output channel,12bits  
    Counter/Timer                 Intel 8254 
    Reference voltage              Internal : -5V(+/- 0.05V) 
                                             -10V(+/- 0.05V) 
                                 External : DC or AC +/- 10V max 
 
 
圖四十三、復建系統之人機介面 
 
 
 
 
 
 
 
 38 
我們嘗試抓取臉部的特徵來判斷人的表情，但是複雜度太高，而且不能達到及時的效果，所
以便以眉間的皺紋來判斷病人的痛苦表情。一旦偵測到痛苦的表情，系統便會發出警告聲通
知醫護人員。 
 
子計畫三：病人身高量測與病人追蹤 
當病人躺在病床上時，我們藉由影像處理的方法，量測出病人的身高以及與病床的相對
位置，再將此資訊利用 RS232 傳送給病床控制器，讓病床能自動調整，使病人躺在正確及舒
服的位置。若是病人下床時，也能加以追蹤，偵測是否有意外狀況發生。 
病人身高量測 
我們設計一個人機介面，當人站在某一固定位置或是躺在病床上，可以即時測得其身高，
隨量測結果調整病床高度、長度、或床板關節位置。為了從影像中取出我們的待測物體，我
們利用最直接也最有效的方法，就是背景相減。首先建立一張背景資訊 backI ，然後將擷取到
的人體影像 nowI 與背景資訊 backI 做相減的動作，如此便可取出人體的位置。經由攝影機擷取到
的影像可能包含些許的雜訊，其來源可能是訊號干擾、週遭環境的雜訊等因素所影響，而雜
訊多是屬於高頻資訊，空間上的平滑濾波器即是用於影像的糢糊化與抑制雜訊，在這我們使
用平滑濾波器來去除雜訊干擾。在建立背景影像的同時，我們也在背景中放入兩個紅色的標
記，並求出兩個紅色標記的距離為多少個 pixel 數。此標記是為了後續作身高量測及位置的判
斷依據。此背景也許是病床或牆壁，病人躺在床上或站在牆壁邊就可量到身高，如(3)式表示。
量測出病人的身高以及與病床的相對位置，再將此資訊利用 RS232 傳送給病床控制器，讓病
床能自動調整，使病人躺在正確及舒服的位置。 
 
(cm) 身高
數人體所佔的pixel
實際的距離(cm)
el數兩個標記之間的pix
=
 (3) 
病人追蹤 
 在病人追蹤方面，我們假設病人穿著病人服，而選擇的病人服顏色則是最常見的青綠色。
從攝影機擷取的影像，經由影像擷取卡傳送至電腦，其格式為 RGB 色彩空間的影像，代表每
個 pixel 都由三個位元所構成，分別為紅、綠、藍三種顏色。但是由於 RGB 色彩空間容易受
到光線變化的影響，例如，相似的顏色會因光源的干擾而有不同的 RGB 值，為了順利求得病
人服的範圍，本系統將 RGB 轉到較不易受到光線干擾的 HSI 色彩空間來做處理。HSI 色彩空
 40 
們是先經過背景相減的步驟，再對影像做膚色偵測後的二值化影像，此時的影像較為破碎，
為了避免影響後續演算法的處理。因此，我們採用形態學 (Morphology) 中的閉合 (Closing) 
運算。閉合運算包含了侵蝕 (Erosion) 與膨脹 (Dilation)。先做膨脹運算來修補主體中的細小
缺口，使得影像輪廓平滑，再做侵蝕運算來消除一些細小的雜訊。經過閉合 (Closing) 運算
後，仍會有一些較大的雜訊，如陰影之類且當手上帶有飾品時，影像資料將會變的不完全，
影響辨識結果，為了避免這些情況而影響後續的辨識流程，因此，我們採用了連通物件法（在
此是使用四連通），將影像中連續的點分成同一類，接著再去計算每一類的點數為何，以求
出最大的一類，視為主體（手部），並藉此去除主體以外的雜訊點。我們可由上述處理出來
的手勢二值影像求出手部重心的位置，以所求出的手部重心為圓心，以雷達掃描畫圓的方式
去掃描整張影像，半徑由 0 開始逐漸增加，當圓通過手部點時，則記錄此點的半徑及相對於
圓心的角度，當圓的大小超過手部範圍則停止掃描。根據角度及距離的關係，我們可將手的
二值影像轉換為一個角度距離關係圖來表示，如圖四十五為手部影像轉換角度距離關係示意
圖，橫軸代表角度 θ，縱軸代表手部重心至手部各點的距離 ρ。 
 
 
(a) (b) 
圖四十五、手勢的二值影像轉換為角度距離關係圖的顯示方式 [15] 
如圖四十五(b)，我們可將角度距離關係圖做邊緣偵測的動作，以獲得如圖四十六(b) 的
曲線圖形，相當於我們計算由重心點至每個手部輪廓點的距離。接著我們在手部輪廓曲線圖
中找出距離變化較平緩的範圍，將此範圍的中心點設為參考點，並假設此點為 wθ ，根據此
點 我 們 可 以 將 手 分 成 手 指 區 域 及 非 手 指 區 域 兩 部 分 ， 其 中 手 指 區 域 為
oo 9090 +<<− ww θθθ 。圖四十五(b)、圖四十六(b) 中每一個峰值代表一根手指，再由之前
所找出的手指區域來判斷峰值數，即可成功的辨識出手勢 [15]。當我們準確的抓取到手部的
正確區域後，再根據手的特性，來處理及辨識手的指數。 
 42 
不可能永遠是固定方向的，會有傾斜的情況下，必須計算出傾斜的角度，而臉部傾斜的角度 iθ
可以根據下面的式子求得， 
 ∑∑=
x y
i xN
x
1
 (5) 
 
∑∑=
x y
i yN
y 1
 (6) 
其中 x , y 為屬於臉部區域的座標， ix  , iy 為臉部區域的重心座標，N 為臉部區域的所有 pixel
數。 
 
)2(tan
2
1
2,00,2
1,11
µµ
µθ
−
=
−
i  (7) 
 
q
i
x y
p
iqp yyxx )()(, −−=∑∑µ  (8) 
其中 qp ,µ 為中心矩 (central moment)，根據上面所算出來的臉部傾斜角度 iθ ，將此角度帶入下
式 
 











−
=





2
1
2
1
cossin
sincos
x
x
y
y
ii
ii
θθ
θθ
 (9) 
 
圖四十七、座標轉換圖 
我們必須把所有點轉換到旋轉 iθ 的座標軸上，才能做後續的特徵擷取，因此將所有的點帶入
(9)式，得到新的座標軸 1y ， 2y 。 
[11] 提出一個複雜度低且穩定度高的方法來抓取眼睛特徵，先把 RGB 色彩空間轉到
rbCYC 色彩空間上，當我們把 bC 、Cr 的值以影像表現出來時可以發現，在眼睛的周圍會有特
別高的 bC 值以及很低Cr 值。又因為眼睛顏色與膚色的差異較大，我們把Y 值帶入下面的式
 44 
 
(a)                                        (b) 
圖四十八、(a)建立背景；(b)量測結果 
 
(a)                                        (b) 
圖四十九、追蹤 
 
手勢辨識 
    本系統的人機介面中，左邊為輸入的影像，右邊則為經過處理後，取出的手部輪廓。最
後的辨識結果則顯示於本系統介面的右上角。本系統可辨識五種手勢，下圖五十是測試各種
不同手勢的結果。 
 
(a)                                        (b) 
 
 46 
 
(c)                                        (d) 
圖五十一、手部方向及位置改變的辨識結果 
 
    在辨識手勢時，可能因為場地的關係，使得手與攝影機之間的距離不固定，造成手部大
小的改變，即使如此，我們依然能成功的辨識出來。圖五十二中，我們試著改變手與攝影機
之間的距離，使手的大小改變，經由實驗可看出，本論文的演算法依然能辨識出正確的手勢。 
 
(a)                                        (b) 
 
(c)                                        (d) 
圖五十二、手部大小改變辨識結果 
 
 48 
 
圖五十四、眼睛偵測（實驗 2） 
 
圖五十五、眼睛偵測（實驗 3） 
 
圖五十六、眼睛偵測（實驗 4） 
 
 
 50 
子計畫四：硬體設計 
本子計畫的整體硬體方塊圖如圖五十九所示。在此硬體方塊圖含有六大部分，分別為病
床控制命令接收單元、拉線式譯碼器、微動開關動作偵測器、馬達驅動電路、按摩墊驅動電
路和自動緊急撥號電路等。這些模組電路皆由一單晶片微電腦 (Microcontroller) 所控制，本
子計畫所使用的單晶片微電腦為美國 Microchip 公司所生產，型號為 PIC16F877 [32]。以下將
針對硬體各部分詳細說明。 
 
圖五十九、系統硬體方塊圖 
 
單晶片微電腦 
本子計畫所使用的單晶片微電腦 PIC16F877 屬於八位元並且以精簡指令 (Reduced 
Instruction Set Computer, RISC) 架構為運算核心，RISC 表示此單晶片僅使用少量指令即可完
成韌體程式的設計和開發，故單晶片可將指令執行過程改以管線式 (Pipeline) 架構作設計，
提高程式執行效率。以 PIC16F877 為例，一個指令僅需耗時 4 個時脈週期即可完成。亦即若
使用4 MHz的石英震盪器做為單晶片的外部震盪時脈，此時，此單晶片只需1微秒 (1 / [4 MHz 
/ 4]) 即可完成一個指令動作。PIC16F877 程式記憶體 (Program Memory) 容量為 8K × 14 
 52 
由於本子計畫為看護系統整合控制，故必須整合接收來自子計畫一和子計畫三的病床姿
態控制命令。經由協調討論後，決定各子計畫以 RS-232 串列通訊介面做為病床姿態調整等控
制命令的溝通方式。故我們必須設計兩個 RS-232 電壓轉換電路，用來接收來自子計畫一和子
計畫三的 RS-232 控制命令資料。圖六十一為由 RS-232 的外部接腳所量測到的電壓，可以看
到，RS-232 邏輯電壓和一般吾人所習慣的 TTL (Transistor-Transistor Logic) 邏輯電壓規範不一
樣。RS-232 邏輯 1 的電壓約為-12V，而邏輯 0 的電壓約為+12V。一般 TTL 邏輯 1 的電壓為
+5V，而邏輯 0 的電壓為 0V。但是由於單晶片的電源供應僅為+5V 和 0V，所以單晶片無法
產生或接收 RS-232 的邏輯電壓，若要真正由單晶片接收或傳送 RS-232 邏輯，則必須在單晶
片外再接一個電壓轉換 IC。 
 
圖六十一、RS-232 邏輯電壓 
一般常見的 RS-232 電壓轉換 IC 型號為 MAX-232 [33] 或 HIN-232，由於此類 IC 的需求
很多，所已以有多家 IC 設計公司出產此種 IC，並且皆是 pin-to-pin，也就是說接腳功能位置
完全一樣，可以相互替換使用。MAX-232 內部是採用 ChargePump 的方式將電壓由 0V-5V
升壓轉換至+12V-12V。圖六十二為 MAX-232 的接腳圖與接線圖。其中，TIN 代表由單晶片
所送出的 TTL 邏輯 RS-232 訊號，TOUT 代表標準的 RS-232 邏輯準位輸出端 (TXD)，RIN 代
表由 RS-232 邏輯準位輸入的 RS-232 訊號 (RXD)，ROUT 代表輸入至單晶片的 TTL 邏輯
 54 
HLS-S 系列的拉線式譯碼器基本規格如下： 
偵測系統：增量型 
輸出波形：方波 
量測行程：1000 mm 
最大解析度：0.04 mm/pulse 
精度：±1 count 
供應電源：DC 5V 
消耗電流：≦ 60 mA 
最大響應頻率：50 KHz 
 
微動開關動作偵測器 
微動開關 (Microswitch) 是用來限制病床的最大動作或姿態角度，以避免病床可動機構
轉動或移動超過最大可容忍角度或位置，進而保護使用者的安全。本計畫共使用六個微動開
關並可被分成三組，分別用來偵測上半身上升/下降、腳上升/下降以及整體病床上升/下降的
最大角度和位置。圖六十四為微動開關的實體圖和等效電路圖，微動開關屬於機械式作動，
其原理為利用東西直接壓觸其上方的開關連桿來做為開關的打開與關閉動作。假設微動開關
下方的三隻腳分別為腳 1(COM)、腳 2(NO)與腳 3(NC)，當平時開關連桿未壓下時，第 1 腳與
第 2 腳處於斷路的狀態，第 1 腳與第 3 腳處於直接導通。當平時開關連桿被壓下時，第 1 腳
與第 2 腳變成直接導通，而第 1 腳與第 3 腳則成為斷路的狀態。故吾人可利用第 1 腳與第 2
腳來做為偵測病床可動機構是否已達最大角度或位置。 
 
圖六十四、微動開關實體圖與等效電路圖 
 
 56 
頻訊號是用兩個特定的單音頻組合信號來代表數位信號以實現其功能的一種編碼技術。兩個
單音頻的頻率不同，代表的數位或實現的功能也不同。這種電話機中通常有 16 個按鍵，其中
有 10 個數位鍵 0∼ 9 和 6 個功能鍵*、#、A、B、C、D。代表 16 種不同的數位或功能鍵的
對應雙頻頻率如下表四所示，其中，正確的頻率就是上面跟左邊的頻率相加  (EX：
1=1209Hz+697Hz)。 
表四、電話中數位或功能鍵對應之複頻頻率表 
 
高頻群 (Hz) 
 1209 1336 1477 1633 
697 1 2 3 A 
770 4 5 6 B 
852 7 8 9 C 
低頻群 
(Hz) 
941 * 0 # D 
 
計畫中自動撥號電路所採用的複頻訊號產生 IC：HT-9200A 其基本特性如下： 
操作電壓：2.5V ~ 5.5V 
串列控制模式 
低待命電流消耗 
低總諧波失真 (Total Harmonic Distortion, THD) 
可使用 3.58 MHz 外接石英震盪器或陶瓷震盪器 (Ceramic resonator) 
8-pin DIP/SOP 包裝 
 
圖六十六為 HT-9200A 的接腳圖與內部方塊圖。 
  
圖六十六、HT9200A 接腳圖與其內部方塊圖 
HT-9200A 的控制時序圖如圖六十七所示。控制方式為首先必須將晶片致能 (/CE) 拉到
低電位，由資料串入腳 (DATA) 串入欲產生的複頻訊號數值，例如欲產生“1”的複頻撥號音，
 58 
電話號碼。並且電路具有自動判斷電話撥通與否，已決定是否續撥下一通預存的其他電話號
碼。直到電話被撥通。 
 
單晶片周邊相關電路 
單晶片周邊相關電路包含石英震盪電路、單晶片重置電路和線上串列燒錄電路 
(In-Circuit Serial Programming, ICSP™) 等。線上串列燒錄電路可允許對已經焊接在電路印刷
板上面的單晶片做程式燒錄或抹除等的動作。如此即可實現遠端韌體程式碼更新或修改。 
 
子計畫四：單晶片韌體設計 
雙組 RS-232 訊號接收 
由於會有兩個子計畫（子計畫一和子計畫三）藉由 RS-232 介面傳送病床等控制命令至本
子計畫四。但是單晶片 PIC16F877 僅有一個 RS-232 訊號接收/發送模組，所以我們必須自行
以韌體設計的方式實現兩組 RS-232 接收功能。 
標準的 RS-232 訊號格式如圖六十九所示，其中通道 1 (CH1) 為直接量測單晶片的 I/O 接
腳。通道 2 (CH2) 為量測 RS-232 Comm. Port 上的訊號，亦即已經由 MAX-232 進行電壓轉換
後的輸出訊號。我們可以根據 RS-232 訊號傳輸格式的特性，也就是當一筆八位元的資料要被
送出前，會先產生一個位元 0 的訊號作為起始位元 (Start bit)。故吾人可以利用韌體程式去先
找到這一個起始位元，即可以接連將後面的八位元資料接收進來。為了能夠穩定的接收
RS-232 串列資料，我們必須設計讓程式盡量在每一個位元的中心點去判定該位元資料為邏輯
1 還是邏輯 0。平時當 RS-232 沒有資料作傳輸時，其會保持在高電壓準位（邏輯 1），所以程
式將會不斷判斷是否訊號變成為邏輯 0，已決定是否有起始位元出現。 
 60 
U
p
p
e
r B
o
d
y
 D
o
w
n
 C
o
n
tro
l
F
o
o
t U
p
 C
o
n
tro
l
F
o
o
t D
o
w
n
 C
o
n
tro
l
B
e
d
 U
p
 C
o
n
tro
l
B
e
d
 D
o
w
n
 C
o
n
tro
l
M
a
s
s
a
g
in
g
 C
u
s
h
io
n
 O
n
M
a
s
s
a
g
in
g
 C
u
s
h
io
n
 O
ff
D
ia
l fo
r E
m
e
rg
e
n
c
y
 S
e
rv
ic
e
s
 
圖七十、韌體程式整體流程圖 
以接收到控制病床姿態的命令為例，控制馬達改變病床姿態時必須同時偵測拉線式譯碼
器的方波輸出量與微動開關是否被致能，以決定是否繼續驅動對應馬達做動。 
 
子計畫四：控制中心系統整合 
圖七十一為子計畫四最後完成的控制中心實體照片。其中，控制電路板以及馬達驅動電
路板皆被安裝到鋁質機箱內，並且各模組或子板間的電源與訊號線都以蛇管將其分別整理。
拉線式譯碼器和微動開關的迴授訊號皆是由圖中機箱左側進入。由子計畫一和子計畫三所連
接過來的 RS-232 訊號線則是由圖中的機箱右側輸入。用以進行單晶片程式碼更新或重新燒錄
的線上串列燒錄輸入端子亦被置於機箱的右側。馬達驅動電路板的馬達驅動訊號是由機箱下
板的上方連接至病床上的各馬達。 
最後控制中心系統的整合測試環境如圖七十二所示。圖中右方為子計畫一的腦波訊號處
理端，處理結果即會以 RS-232 送出控制命令至圖中正下方的控制中心。圖中左上方為子計畫
三的影像辨識 CCD。同樣的，影像辨識處理後的結果亦會透過另一個 RS-232 訊號線傳送至
控制中心。最後控制中心在分別依照命令控制對應的病床馬達作動。 
 
 62 
結論 
由於在居家看護中，看護技術變的越來越重要，所以本整合型計畫發展出一多功能智慧
型看護系統。本整合型計畫的主要目標為呈現出多功能智慧型看護病床高品質的研究成果。
此計畫已成功發展出多功能智慧型看護病床的多項核心技術，包含有：大腦人機介面 (Brain 
Computer Interface, BCI)、以主動視覺和圖形識別為基礎的監督與監視系統、有線或無線的病
患-看護緊急通訊系統、馬達驅動控制等。 
本 研 究 一 開 始 為 先 發 展 出 可 用 在 即 時 擷 取 、 偵 測 和 辨 識 病 患 的 腦 電 波 
(Electroencephalography, EEG) 訊號的大腦人機介面。辨識出的腦電波訊號命令將會送至子計
畫四所設計的整合控制中心，再由控制中心驅動病床馬達做動，或將相關病患需求以有線或
無線的方式傳送至醫護站。 
另外，本計畫針對病床部分做重新設計，病床可依病患的身高體型自動調整適合的長度。
並且，病患躺臥時，身體與病床接觸點的壓力偵測，亦在此計畫中有做考慮，做為病患身體
與病床間接處壓力的最佳化，以提供最舒適的躺臥方式。 
除了上述所提到的各項技術外，本計畫另實現以視覺辨識為基礎的病患監督與病患需求
判斷系統。利用圖形識別演算法等相關技術判斷病患的需求手勢以及表情狀態。經過影像處
理後，辨識出病患的需求後，相關命令亦會傳送至子計畫四所設計的整合控制中心做後續處
理。 
最後子計畫四負責建立整合控制中心，負責用來接收來自子計畫一和子計畫三的病床姿
態控制命令以及其他周邊裝置如控制按摩墊開和關等控制命令。並負責驅動子計畫二病床中
的馬達作動。除此之外，控制中心亦負責將病患的其他需求以有線或無線的方式傳送至護士
站。我們預期，本計畫所提的多功能智慧型居家看護系統除了可以減少看護人員的需求和負
擔，亦會增加病患的自主性以及增加其生活品質與自我尊嚴。 
 
 
 
 
 
