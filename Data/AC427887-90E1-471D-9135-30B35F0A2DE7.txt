 1
行政院國家科學委員會輔助專題研究計畫成果報告 
 
計畫名稱 ：微波管高壓電源之智慧型控制研究 
計畫編號 ： NSC 93-2213-E-155-038  NSC 94-2213-E-155-010  
 
 執行期限：93 年 8 月 1 日至 95 年 7 月 31 日 
 
     主   持   人：林志民                    元智大學 電機系 
     計畫參與人員：李明家、陳邱雄、洪堃能    元智大學 電機系 
 
中文摘要 
本計畫研究的重點在於耦腔式行波管
高壓電源供應器的設計，除了選用正確的電
路架構之外，同時發展智慧型控制方法以適
用於此類微波管的高壓電源穩壓控制。  
本計畫第一年完成了耦腔式行波管高
壓電源之特性分析與零電壓或零電流切換
研究。高壓電源採用脈波寬調制方式來進行
輸出穩壓調節，由於所採用的高壓變壓器通
常具有高的圈數比，其所產生的寄生元件電
容與漏電感無法被忽略。因此，吾人可利用
此寄生元件以產生共振效果達到零電壓或
零電流切換的效果，可減少作為開關的晶體
在進行高頻切換的損失。 
本計畫第二年首先完成高壓電源建模
以利進行控制器設計與模擬驗證。控制器設
計首先提出 PID 控制器、適應性控制器，
同時發展出以模糊控制與適應性小腦模型
控制器為基礎的智慧型控制器，經由模擬的
結果顯示，前饋式適應性模糊控制器的控制
性能，雖然比傳統 PID 控制器有較好的強
健控制特性，尤其是應用在高脈波重複率的
脈衝負載；然而其穩壓控制的性能反應還有
改善空間。因此，本研究繼續提出一適應性
小腦模型控制器，其中藉由最陡坡降法與離
散型的李亞普諾夫函數的方法來推導小腦
模型控制器參數的適應性調整法則，因此使
得系統的高壓電源穩壓控制性能可以被保
證。經由本計畫的研究成果發現，適應性小
腦模型控制器可以成功的應用在此類耦腔
式行波管高壓電源的設計當中，來提高高壓
電源輸出品質以及負載變動範圍，藉以提高
微波管輸出微波之特性，提升雷達系統性
能。 
關鍵詞：微波管、耦腔式行波管、高壓電源、
零電壓切換、零電流切換、PID 控制、適應
性控制、模糊控制、適應性模糊控制、小腦
模型控制器。 
Abstract 
This project focuses on the high voltage 
power supplier (HVPS) design. How to 
design a high performance HVPS is very 
important, because the output voltage of 
HVPS will affect the RF quality, such as 
rising time, falling time, noise figure, flatness, 
pulse drop etc.. The HVPS is controlled by 
pulse width modulation (PWM) to regulate 
the output voltage. The HVPS can operate in 
resonant mode due to the transformer 
parasitic capacitance and leakage inductance. 
In this mode, zero voltage crossing (ZVS) / 
zero current crossing (ZCS) effect can be 
reached to reduce the power loss of switch 
devices. 
In this project, the model of HVPS is 
developed for the control system simulations. 
The PID controller, adaptive controller and 
intelligent control methods based on fuzzy 
logic controller and cerebellar model 
articulation controller (CMAC) will be 
developed for HVPS controller design. From 
the simulation results, although the 
effectiveness of feed-forward adaptive fuzzy 
controller is suitable for microwave tube 
HVPS control. However it is still improvable 
for the tracking performance. Thus this 
project proposed an adaptive CMAC for 
HVPS. In this control system design, the 
gradient descent method and discrete 
Lyapunov theory are uesd to derive the 
adaptive tuning algorithms of CMAC, so that 
the stability of HVPS can be guaranteed. 
 3
集極電壓的變化對微波影響較小，因此切換
式電源供應器很適合運用在此類的裝置
上，以減經系統的重量及體積，但變動量仍
不可太大，必須控制在合理的範圍之內。行
波管在工作時，高壓電源便進入脈波負載模
式，將需隨著行波管負載變動進行穩壓控
制，因此高壓電源之動態響應非常重要，由
於高壓的穩定度將影響到微波的品質，進而
左右雷達的性能，如何縮短高壓電源之動態
響應與減少振盪，實為設計此類電源最重要
的重點之一。 
尤其因高壓變壓器其一、二次側之圈數
比高，產生無法忽略的寄生元件，致使其操
作頻率有其限制，當負載變動率需求愈來愈
高之時，高壓電源之切換頻率不再滿足需
求，如何設計一個良好的智慧型控制器以增
強或取代原有 PID 型控制器之性能，將是本
計畫主要研究的主題。 
 
三、高壓電源架構 
假設陸用系統電源為三相 208V/60Hz
之交流電源，屬於三線系統，可降低各電線
之電流承受力。傳統高壓電源系統架構如圖
二，包含第一級交流轉直流之輸入整流器、
第二級直流轉交流之電力轉換器（若為兩級
式則為直流轉直流與直流轉交流串接）、第
三級高壓升壓與整流濾波、以及輸出穩壓控
制器所組成，控制機制為將輸出電壓取回
授，經由運算放大器所組成的控制器將誤差
訊號處理後得到控制輸出，再透過 PWM 控
制 IC 控制第二級之電力轉換器，以得出高
壓輸出。 
 
 
 
 
 
 
 
 
 
圖二、高壓電源架構 
 
3.1. 三相全波整流 
首先第一級三相全波整流架構如圖
三，輸出直流電壓可由(1)式計算獲得： 
VinVA π
23=                 (1) 
其中 Vin 為交流輸入線對線電壓（簡稱線電
壓），其值約為 208V，而 VA 為三相全波整
流電路之輸出直流電壓，其值約為 280V，
將隨著系統電源變化而改變，此電壓作為下
一級之輸入直流電源。如果為海用系統，Vin
值約為 440V，亦可利用(1)式得出 VA 值約
為 600V。 
全波整流輸出可經由電感與電容所組
成的二階濾波器濾波後，以降低漣波電壓，
吾人利用 IsSpice 電路模擬分析軟體進行此
電路架構模擬，可以得出如圖四之相關波
形。因為三相交流電源其單相頻率 60Hz，
相序各依序相差 120°，正負電壓經整流後
頻率分別變為 180 HZ，最後合成之直流電
壓其漣波頻率則為 360Hz，因此利用上述的
濾波器將此頻率成分的漣波濾除。可以發現
三相電源作為輸入，其整流後漣波將遠小於
僅用單相的漣波，漣波也較容易壓抑，這也
是一般高功率通常使用三相電源的原因。 
 
2
VA
1
VB
3
VC
2 4
DA1
1 4
DB1
4
DC1
6
2
DA2
6
1
DB2
6
3
DC3
3
66
5 5
5
6
R6
10
12
R7
150
C5
0.47u
Δ
5
6
Vout
6
2 4 5
L1
3m
PHASE
120
PHASE
0
PHASE -120
NEUTRAL
1
2
3
Vp
6
Vn
5
6
C1
3.15m
6
Δ
4
6
VF
3
7
R8
150
C9
0.47u
9
R10
150
C11
0.47u
 
圖三、三相全波整流 
 
 
     
圖四、三相全波整流輸出 
 
 
AC/DC DC/AC AC/DC
CTRL 
input output
set 
 5
 
 
 
 
 
 
 
圖八、高壓電力轉換器模型 
 
同樣地，吾人利用 IsSpice 進行此電路
架構模擬，分為兩部分來說明，第一部分為
降壓轉換器段，其輸出穩壓在 200V，主要
控制方式藉由 PWM 來控制 Q1 的導通時
間。第二部分為全橋換流器，操作時序分下
面四個模式(如圖九): 
 
A. S1、S4 導通；S2、S3 關閉：此時變壓
器為穩態，能量由一次側傳至二次側。 
B. S1、S4 導通；S2、S3 導通：此時變壓
器被迫短路進入共振模式，藉ZCS與ZVS
進行電流換向，並可大幅降低功率晶體
因切換所產生的突波以及功率損失。 
C. S1、S4 關閉；S2、S3 導通：此時變壓
器完成換流並進入另一個為穩態，能量
由一次側傳至二次側。 
D. S1、S4 導通；S2、S3 導通：此時變壓
器再度進入共振模式，進行下一次換
向，接著再回到 A 模式，依序進行下一
個循環。 
 
 
 
圖九、全橋換流器操作模式 
 
行波管工作模式為脈波方式；我們選取
無載、低脈波重複率(PRF)之輕載、以及高
脈波重複率之滿載三種模式進行模擬，結果
分別如圖十、圖十一、圖十二。其中波形由
上而下分別為降壓開關輸出電壓、電流、全
橋換流器輸出電壓與電流，可以看出全橋換
流器在轉態時產生共振現象，具有導通時零
電壓切換（ZVS）與關閉時零電流切換
（ZCS）優點，降低晶體切換損失。利用此
操作模式，減少了功率晶體轉態的次數，因
為愈多轉態，除了增加操作困難度外，亦會
產生多組的突波，必須再處理突波的問題。 
 
 
圖十、高壓電力轉換器無載波形 
 
 
圖十一、高壓電力轉換器輕載波形 
 
 
圖十二、高壓電力轉換器滿載波形 
 
Cs Cs 
Cs Cs 
S4 
Ii 
Ls 
S1 S2 
S3 
Ii 
Ls 
S1 S2 
S3 S4 
Ii 
Ls
S1 S2
S3 S4
Ii 
Ls
S1 S2
S3 S4
Mode A Mode B
Mode C Mode D
Q1 
S1 S2 
S3 S4 
L1 
Ls 
CsVd 
 7
切換式電力轉換器根據功率晶體導通
與否會有兩個工作狀態，一個為導通狀態如
圖十六所示，另一個為關閉狀態如圖十七所
示。 
 
圖十六、降壓型電力轉換器導通狀態 
 
 
圖十七、降壓型電力轉換器關閉狀態 
 
因為兩個狀態都非常確定，可以求出其
狀態方程式: 
導通狀態方程式如(5)表示： 
 …    
 (5) 
  
關閉狀態方程式如(6)表示： 
              (6) 
因為要用單一狀態來表示兩個不同狀
態顯得非常困難且複雜，因此採用折衷的方
式即利用加權平均法來結合上述兩種狀
態，對一個週期而言，導通時間為 d×Ts，
而關閉時間為(1-d)×Ts，經由加權平均後可
得切換式電源供應器之狀態方程式如(7)
式，此種方式對於切換式電源供應器在實際
工作的現象亦能適切的表示。 
 (7)  
用(7)式來表示電源供應器在一個週期
內之平均模型，假設每一個週期之工作比皆
為一個固定值 D(穩態下直流工作比)，將上
述簡化為： 
              (8) 
其中 
)1(21 DADAA −+=  
)1(21 DBDBB −+=     
)1(CCC 21 DD −+=             (9)  
接著導入輸入干擾，因為(8)式為線性
系統藉由重疊原理可導入一個微量干擾
 ~dv 後得到  ~ddd vVv += ，其中  dV 為直流線
性輸入電壓，因此相對應地產生狀態向量的
微 量 干 擾 如   ~xXx += ， 同 理 可 得
 ~ooo vVv += ，據此(8)式改寫為 
dd vBxABVAXx ~~~ +++=  
xCCXvV oo ~~ +=+               (10)  
將上式直流與交流部份分開後，得到穩態模
式為 
0=+ dBVAX  
CXVo =                       (11)  
動態模式為 
dvBxAx ~~~ +=  
xCvo ~~ =                        (12)  
然後導入工作比干擾，利用小信號擾動
並將交流及直流成份分開，同樣地藉由重疊
原理可導入一個微量干擾  ~d 後得到
 ~dDd += ，其中D 為穩態之工作比，  ~d 為
擾動變數，因此相對應地產生其他變數的微
量干擾如  ~ddd vVv += ，   ~xXx += ，以及
 ~ooo vVv += ，據此(7)式改寫為 
dBVAXx +=~ (直流項) dvBxA ~~ ++ (線性變
數) dVBBXAA d
~])()[(( 2121 −+−+ (工作比
變數) dvBBXAA d
~]~)()[(( 2121 −+−+ (非線
性二階項) 
CXvV oo =+ ~          (直流項) 
       xC~+          (交流項) 
       dXCC ~)( 21 −+ (交流項) 
       dxCC ~~)( 21 −+ (非線性項) (13) 
透過線性化後以得出最終狀態空間平
均模型：使用小訊號近似法，也就是假設從
穩態變數分離之小訊號，其值遠小於穩態變
數即： 
1  
~
     1,  
~
      1,  
~
      <<<<<<
d
d
V
v
D
d
X
x
 (14)  
根據(14)式的近似並忽略所有非線性
項如(13)式中非線性項如二階項，可再度獲
得一個線性系統，但包含了工作比調制項
 ~ d 然後將線性化後的系統直流與交流部份
xCvo 1=
dvBxAx 11 +=
Cxvo =
dBvAxx +=
dvdBdBxdAdAx )]1([)]1([ 2121 −++−+=
xdCdCvo )]1([ 21 −+=
xCvo 2=
dvBxAx 22 +=
Vd 
Lp Rp 
Rs 
Cs 
Ro
i 
Vo
V 
Vo
Vd 
Lp Rp 
Rs 
Cs 
Ro
i 
V 
 9
⎥⎦
⎤⎢⎣
⎡=
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢
⎣
⎡
=
⎥⎥
⎥⎥
⎦
⎤
⎢⎢
⎢⎢
⎣
⎡
= 1
N
R
C1      
0
L
1
B1       
CR
1-
NC
1
NL
1-
L
R
-
A1 sp
sos
pp
p
                                  (28) 
 同理利用圖二十之迴路可得 
⎥⎦
⎤⎢⎣
⎡=⎥⎦
⎤⎢⎣
⎡=
⎥⎥
⎥⎥
⎦
⎤
⎢⎢
⎢⎢
⎣
⎡
= 1
N
R
C2      
0
0
B2       
CR
1-
NC
1
NL
1-
L
R
-
A2 s
sos
pp
p
 
                                  (29) 
  
將 A、B、C 矩陣帶入(21)式可得高壓
電源供應器無載下之轉移含數為 
3410616722ss
197330022.2s280
)(~
)(~)( 2 ++
+×==
sd
svsT op  
  (30)  
 
4.4 PWM 之轉移函數 
PWM 乃由控制電壓 )(c tv 與高壓電源
供應器轉換頻率之鋸齒波 )(r tv 做比較，以
調整工作比 d； )(c tv 可表為： 
    )(~)( tvVtv cCc +=  (31)  
)(~ tvc 為正弦波之小擾動量，且其頻率遠小
於高壓電源供應器轉換頻率， )(~ tvc 可以表
示為： 
    )sin()(~ φ−∗= wtatvc             (32)  
d(t)可亦表示為： 
⎩⎨
⎧
<
≥=
)()(0
)()(1
)(
tvtv
tvtv
td
rc
rc  (33)  
d(t)可以傅立葉級數表示為： 
+−∗+=
rr
c
V
wta
V
vtd ˆ
)sin(
ˆ)(
φ 其他高頻成分 
  (34)  
d(t)之其他高頻成分所造成輸出電壓之高頻
成分擾動可由輸出之低通濾波器加以消
除，所以 d(t)可以表示為 
)(~)( tdDtd +=                      (35)  
rV
vD cˆ= ，其中 
  
rV
wtatd ˆ
)sin()(~ φ−∗=   (36)  
最後得到 PWM 控制器之轉移函數為： 
rc
m Vsv
sdsT ˆ
1
)(~
)(~)( ==  (37) 
 五、控制器設計 
因為高壓元件需承受的電壓很高，所以
實際可忍受的突波電壓值不能超出設計值
太多，否則很容易造成毀損。因此控制器的
設計必須儘量減少突波的產生，同時利用回
授控制來穩定輸出的電壓。高壓電電源供應
器控制迴路可用圖二十一來表示，包含控
制、PWM 驅動、電能轉換與回授等完整之
架構。 
 
 
 
 
 
 
圖二十一、高壓電電源供應器控制迴路 
 
5.1 PID 控制器 
在本例我們採用切換式電源供應器 K
因子型態 3，再加一個低通濾波器來設計
PID 控制器[9]，依此方法設計出來的控制器
效果可以涵蓋一般切換式電源供應器的穩
壓需求，其結構如圖二十二。 
 
圖二十二、PID 控制器架構 
 
將圖二十二推導後可得轉移函數如下
式： 
)1)((
)
)(
1)(1(
1
)(~
)(~
33221
21
31321
31
31
2e
RC
s
RCC
CCss
RRC
s
RC
s
RR
RR
Csv
svc
+++
+++×+×−=
      
21
21
1
1
fff
ff
ff
RRC
RR
s
RC
++
××  (38)  
CTRL PWM HVPS cV~ d~ oV~
)(sTc )(~
)(~)(
scV
sdsTm =
)(~
)(~)(
sd
soVsTp =
FB
R2 C1 
C2 
R3 C3 
R1 
Vref
cv~
ev~
R4 
R5 C4
G 
B 
 11
 
 
圖二十六、控制輸出變數歸屬函數 
 
 
 
圖二十七、控制規則庫關係圖 
 
表一 控制規則庫 
e 
u 
NB NM NS ZE PS PM PB 
NB    NB NM   
NM    NM    
NS NM   NS PS  PM
ZE NB NM NS ZE PS PM PB 
PS   NS PS    
PM    PM    
e 
d 
o 
t 
PB   PM PB    
 
5.3 適應性控制器 
本例高壓電源供應器將應用於脈波雷
達系統之中，因此高壓電源供應器的負載不
是ㄧ直維持固定，而是配合雷達系統所需的
脈波波形進行工作。由於高壓電源供應器
PID 控制器採用平均控制方式進行，脈波負
載的頻率將受到限制，否則將造成控制器無
法跟上負載的變動而造成失控。一般而言，
脈波最高重複率不能高於高壓電源供應器
工作頻率的十分之ㄧ，以保持控制穩定性。
雖然如此，控制的機制為透過輸出電壓的誤
差再進行穩壓控制，在高速變動的負載之下
往往會有控制器跟不上輸出電壓的變化而
造成失控。 
透過適應性控制的方式可以達到更好
的穩壓效果[12]。如圖二十八所示，可以增
加一個控制迴路，藉由負載電流的波形來判
斷吃載的大小，然後利用查表方式選擇適當
的控制量以輔助 PID 控制器，此控制器稱
為回授式適應性控制。當負載波形變的更複
雜時，上述的方法就很難實現，就必須採用
前饋式適應性控制來控制，如圖二十九即是
利用雷達系統波形產生器的命令經由解碼
後可以立即預判並獲知負載的大小，並於負
載啟動同時送出正確的控制量，而不必等輸
出電壓產生誤差才進行修正，而達到真正的
穩壓控制。在本計畫中，適應性控制將先行
結合進入 PID 與模糊控制器的設計，並比
較加入適應性控制的穩壓效果。 
 
 
 
圖二十八、回授式適應性控制器架構 
 
 
 
圖二十九、前饋式適應性控制器架構 
 
5.4 適應性小腦模型控制器 
    CMAC，是於1975年由Albus提出一種
仿小腦功能之神經網路，它的特點在於不須
經由繁複的數學處理或分析來達成控制的
目標，利用事先以函數輸出/輸入關係所建
立起的記憶體表單，透過檢索方式取出數個
對應於某特定輸入的記憶體內容值，經簡單
的算術累加後得到對複雜系統的控制訊
號，因此，CMAC 可說是一種記憶體查表
技術，最早被Albus使用於機械手臂控制上
[13]。其相較於其他的類神經網路而言，
CMAC沒有牽涉到艱深的數學運算，構造簡
單且易於處理是它最大的特點，而且CMAC
具備快速的學習收斂速度、良好的區域類化
能力以及可學習許多非線性系統、容易以硬
CTRL PWM HVPS 
oV
~
FB 
ADPT 
CTRL PWM HVPS 
oV
~
FB 
ADPT SYS
 13
1 Variable s
A B
IHG
FED
C
a
i
h
g
f
e
d
c
b
7
1
1
2
2 3
3
4
4
6
5
65
2 Variable s
Layer 1
Layer 1 Layer 2
Layer 2
Layer 3
Ee
Bb
Gg
State (3,3)
7
Layer 3
J K L
l
k
j
8
9
8 9
Layer 4
Layer 4
Jj
 
圖三十一、二維小腦模型控制器 4=ρ   
            9=En  
 
5.42 學習法則 
    CMAC 學習法則主要著重於如何用所
設定的能量函數再加上遞迴式的梯度向量
學習法則，以得到控制系統的最佳參數。其
方法主要藉由鍊鎖率（chain rule）和最常使
用的倒傳遞學習法則（back-propagation）[19]
來完成。為了描述 CMAC 即時學習法則，
我們使監督式的最陡坡降法。首先定義能量
函數E 如下： 
 220 2
1)~(
2
1
md evvE =−=  (47)  
在上式中， me 表示高壓電源實際輸出值與
理想電源值的差。 
根據以上所定的能量函數E，誤差傳遞項如
以下： 
CMAC
m
CMAC
m
mCMAC
C
u
ve
u
v
v
e
e
E
u
E
∂
∂=
∂
∂
∂
∂
∂
∂−=∂
∂−=
0
0
0
~
                         
~ 
~δ
 (48)  
並根據倒傳遞學習法則， kw 的變化率如下: 
kCw
k
CMAC
CMAC
w
k
wk bw
u
u
E
w
Ew δβββ =∂
∂
∂
∂−=∂
∂−=Δ
 (49)  
式中 wβ 為 kw 的學習速率，所以連結權重值
可根據下列方程式來更新 
 )()()1( NwNwNw kkk Δ+=+  (50)  
其中 N 是學習的次數。接下來使用高斯
(Gaussian)函數來當容納場基底函數，其中
高斯的平均值跟變異數都可以用相同的方
式來調整，以增加系統的學習能力。 
  (5.6) 
2
1
1
1
)(
)(2
ik
iki
k
n
k
kCm
ik
ik
ik
k
n
k
k
CMAC
m
ik
ik
ik
k
n
k k
CMAC
CMAC
mik
v
msbw
m
bw
u
E
m
b
b
u
u
Em
R
R
R
−=
∂
∂
∂
∂
∂
∂−=
∂
∂
∂
∂
∂
∂
∂
∂−=
∑
∑
∑
=
=
=
δβ
φ
φβ
φ
φβΔ
 (51) 
∑
∑
∑
=
=
=
−=
∂
∂
∂
∂
∂
∂−=
∂
∂
∂
∂
∂
∂
∂
∂−=
R
R
R
n
k ik
iki
kkCv
n
k ik
ik
ik
k
kk
CMAC
v
n
k ik
ik
ik
k
k
CMAC
CMAC
vik
v
msbw
v
bbw
u
E
v
b
b
u
u
Ev
1
3
2
1
1
)(
)(2    
        
δβ
φ
φβ
φ
φβΔ
 (52)   
其中 mβ 和 vβ 分別是平均值和變異數的學
習速率。所以此高斯容納場基底函數的平均
值和變異數可以更新如下： 
 )()()1( NmNmNm ikikik Δ+=+  (53)  
 )()()1( NvNvNv ikikik Δ+=+  (54)  
由於所發展的適應性小腦模型控制器，是屬
於不需知道動態模型控制器，所以不能精確
的計算出系統的Jacobian項 CMACuv ∂∂ 0~ 。為
了解決這個問題和增加權重值的學習速
率，我們採用了適應性倒傳遞法則如下所示
[20]： 
 mmcddC eevvvv +=−+−≅ )~()~( 00δ  (55)  
式中 mce 表示實際高壓電源輸出值與參考目
標電壓值的誤差變化率。此適應性小腦模型
控制器系統方塊圖如圖三十二所示。
 
圖三十二、適應性小腦模型控制器系統 
            方塊圖 
 
5.43 收斂性分析 
    學習法則如(49), (51)和(52)所示，需要
一組適當的學習速率 wβ , mβ , vβ 。如果把學
習速率調小的話，雖然可以保證系統穩定，
可是收斂速度會比較慢。反之，選擇大的學
習速度，系統將會不穩定。為了讓CMAC
CMAC PWM HVPS 
oV
~
FB 
ADPT 
 15
⎟⎟⎠
⎞
⎜⎜⎝
⎛≤
⎥⎥⎦
⎤
⎢⎢⎣
⎡
⎟⎟⎠
⎞
⎜⎜⎝
⎛≤
⎥⎥⎦
⎤
⎢⎢⎣
⎡
⎥⎥⎦
⎤
⎢⎢⎣
⎡
⎟⎟⎠
⎞
⎜⎜⎝
⎛
⎟⎟⎠
⎞
⎜⎜⎝
⎛ −−⎟⎟⎠
⎞
⎜⎜⎝
⎛ −
⎟⎟⎠
⎞
⎜⎜⎝
⎛×
=
min
max
max
2
max
||
2||
2max||
exp2max  
||
ik
kB
ik
kB
ik
iki
ik
iki
ik
kB
v
wn
v
wn
v
mq
v
mq
v
wn
 
  (65)  
因此  
 )||2(||)( minmax ikkBRm vwnnNP < 進
而，誤差的差分可以表示成 
 
ik
T
ik
m
m
mmm
m
m
NeNe
NeNeNe
Δ
)()(                
)(Δ)()1(
⎥⎦
⎤⎢⎣
⎡+=
+=+
∂
∂  (66) 
其中 ikmΔ 表示高斯接受場基底函數的平均
值變化。利用(48)、(51)、(66)則 
 
)(
)(
              
)()(
NP
Ne
m
u
u
E
E
Ne
m
Ne
m
m
C
ik
CMAC
CMAC
m
ik
m
δ−=
∂
∂
∂
∂
∂
∂=∂
∂
 (67)  
)()(
)(
)()1( NPNP
Ne
NeNe mCm
T
m
m
C
mm δβδ ⎥⎦
⎤⎢⎣
⎡−=+
  (68) 
也可得到： 
 
)()(
)(
1)(
)()(
)(
1)(
)1(
2
2
NPNP
Ne
Ne
NPNP
Ne
Ne
Ne
m
T
m
m
C
mm
m
T
m
m
C
mm
m
⎟⎟⎠
⎞
⎜⎜⎝
⎛−≤
⎥⎥⎦
⎤
⎢⎢⎣
⎡
⎟⎟⎠
⎞
⎜⎜⎝
⎛−=
+
δβ
δβ  (5.26) 
  (69) 
如果  )(20 2maxmm Pλβ << ， 
 2maxmin )]||2(|)[|(2 kikBR wvnnλ=  
     ,)]||2(|[| 2maxmin kikBw wvnβ= 則 
||)()())((1|| 2 NPNPNe m
T
mmCm δβ− 將會小於
1。因此Lyapunov穩定性 0>V  及 0<ΔV
可以根據(58)、(59)獲得保證。HVPS高壓電
源電壓輸出與參考目標的誤差當 ∞→t 將
會趨近於零。 
 b) 根 據 輔 助 定 理 2: 
1|}])([exp{])([| 22 <−−− ikikiikiki vmqvmq 。
由於 
⎟⎟⎠
⎞
⎜⎜⎝
⎛≤⎥⎦
⎤⎢⎣
⎡
⎟⎟⎠
⎞
⎜⎜⎝
⎛≤
⎥⎥⎦
⎤
⎢⎢⎣
⎡
⎥⎥⎦
⎤
⎢⎢⎣
⎡
⎟⎟⎠
⎞
⎜⎜⎝
⎛
⎟⎟⎠
⎞
⎜⎜⎝
⎛ −−⎟⎟⎠
⎞
⎜⎜⎝
⎛ −
⎟⎟⎠
⎞
⎜⎜⎝
⎛=
⎥⎦
⎤⎢⎣
⎡
⎟⎟⎠
⎞
⎜⎜⎝
⎛
∂
∂≤⎥⎥⎦
⎤
⎢⎢⎣
⎡
⎟⎟⎠
⎞
⎜⎜⎝
⎛
∂
∂
∂
∂≤
⎟⎟⎠
⎞
⎜⎜⎝
⎛
∂
∂
∂
∂=∂
∂=
∑
∑
=
=
min
maxmax
22
max
max
1
1
||
2||2max||
exp2max||
max||max
)(
ik
kB
ik
kB
ik
iki
ik
iki
ik
kB
ik
ik
kB
ik
ik
ik
k
n
k
k
ik
ik
ik
k
n
k
k
ik
CMAC
v
v
wn
v
wn
v
mq
v
mq
v
wn
v
wn
v
bw
v
bw
v
uNP
R
R
φφ
φ
φ
φ
 
  (70) 
因此 
 
 )||2(||)( minmax ikkBRv vwnnNP < (71) 
進而，誤差的差分也可以表示成 
ik
T
ik
m
m
mmm
v
v
NeNe
NeNeNe
Δ
Δ
⎥⎦
⎤⎢⎣
⎡
∂
∂+=
+=+
)()(                
)()()1(
 (72) 
其中 ikvΔ 表示高斯接受場基底函數的平均
值變化。利用(48)、(52)、(72)則 
)(
)(
               
)()(
NP
Ne
v
u
u
E
E
Ne
v
Ne
v
m
C
ik
CMAC
CMAC
m
ik
m
δ−=
∂
∂
∂
∂
∂
∂=∂
∂
 (73) 
)()(
)(
)()1( NPNP
Ne
NeNe vCv
T
v
m
C
mm δβδ ⎥⎦
⎤⎢⎣
⎡−=+
 (74) 
也可得到： 
 
)()(
)(
1)(
)()(
)(
1)(
)1(
2
2
NPNP
Ne
Ne
NPNP
Ne
Ne
Ne
v
T
v
m
C
vm
v
T
v
m
C
vm
m
⎟⎟⎠
⎞
⎜⎜⎝
⎛−≤
⎥⎥⎦
⎤
⎢⎢⎣
⎡
⎟⎟⎠
⎞
⎜⎜⎝
⎛−=
+
δβ
δβ  
 (75) 
如果 
2
maxmin
2
max
)]||2(|[|)(2
)(20
kikBR
vv
wvnn
P
λ
λβ
=
<<
 
 17
 
圖三十五、低 PRF 回授式適應性 PID 與
Fuzzy 控制結果 
圖三十五中回授式適應性控制輸出為
3.5V，虛線為回授式適應性 PID 控制結果，
實線為 Fuzzy 控制結果。可以看出回授式適
應 PID 控制比 Fuzzy 控制方法為佳，顯示
加入回授式適應性控制之後，其控制效果明
顯改善許多。因此亦將回授式適應性控制加
入 Fuzzy 控制，模擬條件更改為負載脈波寬
2 秒，週期為 4 秒(高脈波重複率)，再來觀
察控制效果如何；模擬結果如圖三十六。 
 
 
 圖三十六、高 PRF 回授式適應性 PID 與
Fuzzy 控制結果 
圖三十六中回授式適應性控制輸出為
3.5V，虛線為回授式適應性 PID 控制結果，
實線為回授式適應性 Fuzzy 控制結果。可以
看出兩者都有明顯的控制效果，但以回授式
適應性 Fuzzy 控制比回授式適應性 PID 控
制為佳，比較沒有穩態誤差。 
接著我們將重點放在 Fuzzy 控制，將回
授式適應性控制與前饋式適應性控制加入
Fuzzy 控制，模擬條件為負載脈波寬 2 秒，
週期為 4 秒(高脈波重複率)，再來觀察控制
效果如何；模擬結果如圖三十七。 
 
圖三十七、高 PRF 回授式與前饋式適應性
Fuzzy 控制結果 
 
圖三十七中回授式與前饋式適應性控
制輸出皆為 3.5V 虛線為回授式適應性
Fuzzy 控制結果，實線為前饋式應性 Fuzzy
控制結果。因為回授式適應性 Fuzzy 控制有
延遲現象，故其反應時間比前饋式應性
Fuzzy 控制來得慢，所以控制效果差了一
些。 
由上述幾個控制器可以發現，即使加入適應
性控制，其穩壓控制的反應性能仍有待改
善，因此使用本研究所提出來的適應性小腦
模型控制器，來進一步觀察高壓電源供應器
的穩壓控制。 
在本模擬中，小腦模型控制器可以描述如
下:  
y 每個狀態元素的數量: 5=en (元素) 
y 區域類化: 4=τ (元素/區塊)  
y 狀態變數的區塊數量:  
  2=bn (區塊/層) 4× (層) 8= (區塊) 
y 容納場數量 2=dn  
  (容納場/層) 4× ( 層) 8= ( 容納場) 
y 容納場函數為: 
y  ]/)([ 22 ikikiik vmsexp −−=φ   
小腦模型網路控制器輸入為誤差 )(Nem 與
誤差的變化率 )(Δ Nem 且其輸入訊號正規化
在空間 ]}2,2[]2,2{[ −− 。高斯函數的初始值
中 心 值 均 勻 分 布 在
]8.2,2,1.2,4.0,4.0,1.2,2,8.2[
],,,,, ,,[ 87654321
−−−−=
iiiiiiii mmmmmmmm ，初始
變異量值設定為 1.6=ikv ，其中 2 1,=i  
and 8,,2,1 "=k 。學習速率為 ,01.0=wβ  
