P. 2 
目錄 
 
 
 報告內容 _______________________ P.3 
一、 前言 _____________________ P.3 
二、 研究目的 __________________ P.3 
三、 文獻探討 __________________ P.4 
四、 研究方法 __________________ P.6 
五、 結果與討論（含結論與建議） _____ P.7 
參考文獻 ______________________ P.9 
計畫成果自評 __________________ P.13 
可供推廣之研發成果資料表(1) ___ P.14 
可供推廣之研發成果資料表(2) ___ P.16 
可供推廣之研發成果資料表(3) ___ P.17 
附錄：執行本計劃所發表之論文___ P.18 
P. 4 
甚至是精神方面疾病的關係，近年來受到了廣泛的研究，因此第三年延伸第二年
之成果開發出(3)容錯式之心率變異(HRV)分析方法；(4)ZigBee/Internet 閘道
器；(5)以實機方式研究 ZigBee 之效能；(6)調查現有花東地區之遠距醫療
架構(Telemedicine Infrastructure)，以作為將來居家照護設備之通訊通
道。 
 
三、文獻探討 
根據本研究計畫目的重點(如上節所述)，本計劃在結果與討論一節中，對實作部份
之成果作一報告。但對 HRV 議題，仍有探討相關文獻之必要，如下所述： 
HRV 的量測 
由於 HRV 重要性，本計畫預期其將做為居家感測之重要參數，以下就其量測方
法與其應用作ㄧ背景介紹： 
在臨床上，心率變異性的量測，目前多以擷取心電圖的方式達成，如圖四(a)所示
為ㄧ次心跳的心電圖，並以 P-QRS-T 指定其特徵。連續性的心電圖紀錄，則會產生
所謂正常心跳間隔(N-N interval)，如圖四(b)中的多個正常心跳間隔。若只取 R
尖波的時間，則心電圖的特徵將被簡化至如圖四(c)所示，此時連續兩個 R 之間的
間隔(稱為 RR-Interval)等同於 NN-Interval，而其倒數即為當時的心率，如圖中
之τ1、τ2、…。 
 
 
(a) 
 
(b) 
 
                                                                                                                                                                  
率的增加是由交感神經所掌控，心率的減緩則是由副交感神經掌控，因此心率變異性反映了交感神經及副交
感神經(迷走神經)的角力結果。雖然心率變異性無法以簡單之模式予以描述或預測，但是藉助一些變化指標，
可以透露出一個人自主神經的活性及其健康狀況。一些研究結果顯示，血壓、呼吸、身體或心理壓力、甲狀
腺亢進、服用藥物等與自主神經有關的顯性因子，皆會改變心率變異性。而一些慢性病如高血壓、糖尿病也
會影響它。 
 
P. 6 
[10][11][12][13]。 
3. 環境壓力：不良的環境，不佳的居住氣氛皆會降低心率變異。心率變異可用
來做為這些因素的量化評估與控制[15]。 
4. 憂鬱症患者監控重點: 偏高的 LF/HF(交感/副交感平衡指標)表示患有憂鬱
症之程度[16][17][18]，配合心率變異、心律不整等指數，可診斷中長期憂
鬱症患者所受之影響及生理趨勢[8]。 
5. 自律神經失調患者監控重點:與同年齡、同性別之族羣相比，偏低心率變異及不
正常 LF/HF 值即表示自律神經失調[33]。 
6. 運動、物理治療與 HRV 關係：根據 HRV 選擇，運動型態，調整 HRV[32] 
[34][35][41]，HRV 亦可評估物理治療的成效[38][39][40]。 
7. 其他如：藥品[21][22][23][24]與飲食物監控[20][36][37]、中樞性自主神經
失調的趨勢(譬如帕金森氏症、慢性酒精中毒、四肢麻痺)、腸躁症(肚瀉或便
秘)[19]、失眠患者監控[28][29][30[31]等均可由 LF/HF 的比例得知其趨勢。 
由於 HRV 得以觀測諸多生理現象[45](甚至分析性格體質[44])，國內外均已有
少數公司將 HRV 分析的方法商業化。但這些研究成果尚未成功地普及化至照護機
構、運動中心、甚至是一般人。本計劃認為有以下幾點主要之挑戰尚未克服： 
(A) 價格：在準確度可接受的範圍內，感測系統造價格須非常低廉，並避
免使用耗材。 
(B) 使用方便性：需盡量減少受測者生活上受影響的程度，能夠進行正常
生活。 
(C) 低耗電量：電池更換頻率必須很低，以增加接受度。 
(D) 雜訊濾除：受測者活動時帶來之雜訊乃不可避免，因此必須有方法過
濾雜訊，以免無法判讀心率。 
(E) 即時性：可以及時分析 HRV 並監測心率。 
(F) 準確度：儘管 HRV 分析均使用 RR-interval，不去分析 P-QRS-T 特徵，
但傳統上認為心電訊號的取樣頻率須超過每秒 128 次，且經過多重之數位
訊號處理，才能獲得夠準確的 HRV。 
(G) HRV 分析結果判讀之專業知識，如何根據歷史之 HRV 判讀受測者現
行狀況，需有專業醫師指導配合。 
 
四、研究方法 
為有效運用研究資源，並配合總計畫及其他子計畫的進度，本子計畫工作重
點及其方法如下： 
(1) 容錯之心率量測方法：在不影響日常活動進行的情況下，較為可行之現行方法
為穿戴於胸部下方之心跳感測器。但目前此類產品在雜訊較多的情況下，無法
正確顯示心跳，因此本計劃擬研發容錯之方法，在雜訊存在的狀況，亦能產生
P. 8 
 
 
 
 
此電 路內含處理器
(下 圖)、Zigbee 收
發器、天線(上圖左側)、三軸加速計(上圖右下角)，以結合脈搏偵測器發送
心率資料至家庭閘道器或感測平台。 
(3) 以實機方式研究 ZigBee 之效能，初步結果顯示：使用 Nonbeacon 模式
時，CSMA/CD 機制在節點數較多時，有效資料率是以二次曲線級數降
低。因此應用 ZigBee 於 HRV 時，眾多參數之選擇須做更深入之探討與
模擬。此實驗結果發表於[46]。 
(4) 我們研發了一個 ZigBee/Internet 的閘道系統，Internet 上的任一點可以存
取 ZigBee 的任意一個節點，此部份之成果發表於[47]。 
(5)    我們延伸了第二年的成果，研究出容錯之心率變異量測方法：，並已發
表至國際會議[45]，又提出另一改良方法，並已發表至另ㄧ國際會議 [48]，
並將於 2008 年提出專利申請[49]。 
(6) 我們針對花東地區之遠距醫療實施方式，做了調查，發表於遠距醫療專書
[44]，此報告有助於了解居家照護可能實施之方式，即可用之架構及資源。 
P. 10 
and sudden death in heart failure. Heart Fail Rev 2002 Jul;7(3):229-42. 
[15] Ewing DJ, Martin CN, Young RJ, Clarke BF. The value of cardiovascular autonomic 
function tests. Diabetes Care. 1985;8:491-498. 
[16] Agelink MW, Boz C, Ullrich H, and Andrich J, Relationship between major depression 
and heart rate variability. Psychiatry Res 2002 Dec 15;113(1-2):139-49. 
[17] Agelink MW, Majewski T, Wurthmann C, et al. Autonomic Neurocardiac Function in 
Patients with Major Depression and Effects of Antidepressive Treatment with Nefazodone. 
J Affect Disord 2001 Feb;62(3):187-98. 
[18] Agelink MW, Boz C, Ullrich H, and Andrich J. Relationship between major depression 
and heart rate variability: Clinical consequences and implications  
for antidepressive treatment. Psychiatry Res 2002 Dec 15;113(1-2):139-49. 
[19] Elsenbruch S; Orr WC, Diarrhea- and constipation-predominant IBS patients differ in 
postprandial autonomic and cortisol responses. Am J Gastroenterol 2001 Feb;96(2):460-6. 
[20] Lu CL, Zou X, Orr WC, and Chen JD, Postprandial changes of sympatho- vagal balance 
measured by heart rate variability, Dig Dis Sci 1999 Apr., 44(4):857-61. 
[21] Ekholm EM, Salminen EK, Huikuri HV, et al. Impairment of heart rate variability during 
paclitaxel therapy. Cancer 2000 May 1;88(9):2149-53. 
[22] Syvanen K, Ekholm E, Anttila K, and Salminen E. Immediate effects of docetaxel alone or 
in combination with epirubicin on cardiac function in advanced breast cancer. Anticancer 
Res 2003 Mar-Apr;23(2C):1869-73. 
[23] Morrow GR, Andrews PL, Hickok JT, Stern R. Vagal changes following cancer 
chemotherapy: implications for the development of nausea. Psychophysiology 2000 
May;37(3):378-84. 
[24] Zahorska-Markiewicz B, Obuchowicz E, Waluga M, et al. Neuropeptide Y in obese 
women during treatment with adrenergic modulation drugs. Med Sci Monit 2001 
May-Jun;7(3):403-8. 
[25] Facchini M, Malfatto G, Sala L, et al. Changes of autonomic cardiac profile after a 3-week 
integrated body weight reduction program in severely obese patients. J Endocrinol Invest 
2003 Feb;26(2):138-42. 
[26] Shekelle PG, Hardy ML, Morton SC, et al. Efficacy and safety of ephedra and ephedrine 
for weight loss and athletic performance: a meta-analysis. JAMA 2003 Mar 
26;289(12):1537-45. 
[27] Haller C, and Schwartz JB. Pharmacologic agents for weight reduction. J Gend Specif 
Med 2002 Sep-Oct;5(5):16-21. 
[28] Bonnet MH; Arand DL. Situational insomnia: consistency, predictors, and outcomes. 
Sleep 2003 Dec 15;26(8):1029-36. 
P. 12 
[43] Cheng, Jen-Liang; Jeng, Jing-Ren; Chiang, Zhe-Wei, “Heart Rate Measurement in the Field”, 
Pervasive Health Conference and Workshops, 2006 , vol., no., pp.1-4, Nov. 29 2006-Dec. 1 
2006. 
URL: http://ieeexplore.ieee.org/iel5/4205139/4205140/04205142.pdf?isnumber=4205140&pr
od=STD&arnumber=4205142&arnumber=4205142&arSt=1&ared=4&arAuthor=Cheng%2C+
Jen-Liang%3B+Jeng%2C+Jing-Ren%3B+Chiang%2C+Zhe-Wei 
[44] Jen-Liang Cheng, Tzu-Kuei Chang, "Telemedicine in East of Taiwan", Advances in 
International Telemedicine and e-Health Around the World. Vol. I, pp.152-157, MediPage Ltd, 
Poland, ISBN 83-89769-22-0. 
[45] Jen-Liang Cheng and Zhu-Xuan Lin, " Heart Rate Variability Approximation in the Presence 
of Noises", Proceedings of 2007 CACS International Automatic Control Conference, 
November 9-11, 2007, Taichung, Taiwan. 
[46] Jen-Liang Cheng and Che-Wei Chiang, " Empirical Performance of Saturated Zigbee Network 
" Proceedings of 2007 CACS International Automatic Control Conference, November 9-11, 
2007, Taichung, Taiwan. 
[47] Jen-Liang Cheng, etc., " The Implementation of a Telecare Gateway ", Proceedings of 
International Medical Informatics Symposium in Taiwan 2007, Nov. 16-17 2007, pp.338-340. 
[48] Cheng, Jen-Liang, etc., "Approximating Heart Rate Variability", to appear in Pervasive Health 
Conference and Workshops, 2008, Tampere, Finland, Jan. 30 2008-Feb. 1 2008. 
[49] 鄭仁亮, "容錯式心率量測方法", 中華民國專利申請書第095141767號，中華民國九十五
年十一月十日。 
P. 14 
可供推廣之研發成果資料表(1) 
□ 可申請專利  □ 可技術移轉                                      日期：96 年 12 月 23 日 
國科會補助計畫 
計畫名稱：智慧型居家意外事件之評估與偵測-子計畫一： 
無線感測網路於居家照護應用之研究(3/3) 
計畫主持人：鄭仁亮 
計畫編號：NSC95－2218－E－320－002            
學門領域：控制學門 
技術/創作名稱 與雜訊共存之心率變異趨近方法 
發明人/創作人 鄭仁亮 
中文：目前之心率變異量測方法，均無法在運動中之個體上進行，
主要原因在於雜訊在此種情況下，無法濾除。因此本計劃研究出一
種投票與鏈結方法(Vote-And-Chain Algorithm)以求得近似之心
率變異，如 SDNN。評估此方法所需之資料，係以實際之心電圖，
再摻入雜訊獲得。結果顯示，在 27000 筆資料中，高達 97%的資料，
用 VACA 方法，可以得到(100±20)% 的準確率。結果顯示出，VACA
適用於長期、簡單、非靜態式的 HRV 監測。 
技術說明 
英文：Heart rate variability (HRV) measurement in the field has not been widely 
studied due to the presence of substantial noises in certain circumstances even after signal 
processing. To overcome such a difficulty, a method, called VACA (Vote-And-Chain 
Algorithm) is proposed to obtain an approximate HRV measurement. With VACA, the 
contaminated ECGs can be patched to obtain HRV metric, such as SDNN, even when the
arrival rate of noises has reached the same level of heart rate. The performance of this 
algorithm is evaluated with 27,000 contaminated ECGs which are synthesized by real 
ECGs in the Physio-Net and noises of Poisson process. The best parameters 
for VACA are explored so that it can reach an accuracy of (100±20)% for 97% of the 
27000 contaminated ECG data. The experiment results show that VACA is a robust 
method for HRV measurement in applications that long-term multi-lead ECG is not 
feasible. 
可利用之產業 
及 
可開發之產品 
居家照護、生理監測 
技術特點 
適用於長期、簡單、非靜態式的 HRV 監測 
ˇ ˇ
P. 16 
可供推廣之研發成果資料表(2) 
□ 可申請專利  □ 可技術移轉                                      日期：96 年 12 月 23 日 
國科會補助計畫 
計畫名稱：智慧型居家意外事件之評估與偵測-子計畫一： 
無線感測網路於居家照護應用之研究(3/3) 
計畫主持人：鄭仁亮 
計畫編號：NSC95－2218－E－320－002            
學門領域：控制學門 
技術/創作名稱 TCP/IP 與 Zigbee 間之閘道器 
發明人/創作人 鄭仁亮 
中文：整合TCP/IP和ZigBee，實現遠距控制或感測資料擷取。本技
術利用自行發展之點對點協定，透過序列埠連結ZigBee網路之協調
器與TCP/IP之主機，形成一閘道器。Internet上任何一點可透過此
閘道器存取ZigBee網路上之任何終端設備。 
技術說明 英文：This technique integrates TCP/IP and ZigBee networks, 
so that remote control or data sensing can be easily realized. 
With the proprietary point-to-point protocol, TCP/IP host 
and Zigbee coordinator can be connected to form a ZigBee 
gateway. Any host of Internet can then access ZigBee end 
devices through the gateway.   
可利用之產業 
及 
可開發之產品 
工業控制、居家照護、生理監測 
技術特點 
硬體方面，可利用既存之產品(個人電腦、Zigbee 節點)，以串列
埠連結達成，亦可重新設計電路，以 SoC 整合 ZigBee PHY 層達成。
軟體方面，遠端應用程式以目前 TCP 或 UDP Port 形式即可存取
ZigBee 網路。 
推廣及運用的價值 
工業電腦業者、家用閘道業者，可整合此技術，進入無線控制及家
庭自動化之市場，移動式醫療儀設備之資料傳輸亦可依此技術達
成。 
ˇ
P. 18 
附錄：執行本計劃所發表之論文 
 
z “A Robust Algorithm for Heart Rate Monitoring”, Proceedings of 3rd International Conference 
on e-Government e-Health, Milan, 6th-8th, July, 2006. 
 
z “Heart Rate Measurement in the Field”, Pervasive Health Conference and Workshops, 2006 , 
vol., no., pp.1-4, Nov. 29 2006-Dec. 1 2006. 
 
z “Telemedicine in East of Taiwan”, Advances in International Telemedicine and e-Health 
Around the World. Vol. I, pp.152-157, MediPage Ltd, Poland, ISBN 83-89769-22-0. 
 
z “Heart Rate Variability Approximation in the Presence of Noises”, Proceedings of 2007 CACS 
International Automatic Control Conference, November 9-11, 2007, Taichung, Taiwan. 
 
z “Empirical Performance of Saturated Zigbee Network”, Proceedings of 2007 CACS 
International Automatic Control Conference, November 9-11, 2007, Taichung, Taiwan. 
 
z “The Implementation of a Telecare Gateway ”, Proceedings of International Medical 
Informatics Symposium in Taiwan 2007, Nov. 16-17 2007, pp.338-340 
 
z “Approximating Heart Rate Variability”, to appear in Pervasive Health Conference and 
Workshops, 2008, Tampere, Finland, Jan. 30 2008-Feb. 1 2008. 
distributed density functions, a majority voting algorithm is 
presented to conquer above reliability problems. 
III. THE MAJORITY VOTING ALGORITHM FOR HEART RATE 
MONITORING 
The majority voting algorithm proposed in this paper is to 
capture signals within a predefined interval. The difficulty 
encountered by any pulse sensing unit is that there is no way 
to separate noise signals from heartbeat signals without 
sophisticated signal processing capability. For example, let 
nttt Λ,, 10  be the time that a signal(noise or pulse) is 
received, as shown in Figure 1. In Figure 1, a heartbeat is 
represented by a solid vertical bars whereas a noise is 
represented by a broken vertical bar. The signal collecting 
period is enclosed by two dotted lines. An intuitive majority 
voting on durations of any two consecutive signals cannot 
work. This is because, as can be shown in Figure 1, a real 
pulse duration may be cut by one or more noises if these is no 
way to recognize heartbeats from noises. Thus no regular 
intervals can be obtained. 
 
Figure 1: The signals received by the receiving unit. 
As mentioned, heartbeats and noises behavior differently. 
They have different distribution on signal duration length. In 
other words, R-R intervals of heartbeat may flock together 
while noises will not. 
To obtain the correct pulse duration, the duration between 
any two signals(heartbeats or noises) must be counted in for 
the majority vote. That is, the duration [tj, ti] of any two 
signals that received at ti and tj must be evaluated and stored 
for voting if it is within the reasonable R-R interval range. 
Thus the duration that are not within the range can be 
precluded. For example, entries of the following matrix must 
be evaluated and filtered with reasonable R-R interval range 
for signals shown in Figure 1: 
⎥⎥
⎥⎥
⎥⎥
⎦
⎤
⎢⎢
⎢⎢
⎢⎢
⎣
⎡
−
−−
−−−
−−−−
−−−−−
45
3534
252423
15141312
0504030201
tt
tttt
tttttt
tttttttt
tttttttttt
 
where the entries in brackets are precluded because they are 
not in reasonable R-R interval range, for example. 
The reasonable R-R intervals are divided into segments, 
one for every ten bpm(beats per minute) from forty bpm. 
Thus the segments of possible pulse duration are [1.5s  1.2s] 
for heart rates of [40 50], [1.2s+  1s] for heart rates of [51 60], 
and so on. The real heartbeats and noises collected within the 
collecting period distributed into these segments in different 
ways: real heart beat signals may be clustered while noises 
may not. At the end of signal collecting period, segment with 
highest number of votes are considered to be the real 
heartbeats. Then their mean are used to evaluate the heart rate 
and another voting process begins with voting number in each 
segment cleared. But when a highest number of votes can not 
be determined under certain situations, another signal 
collecting period continued with accumulated voting number 
in each segment. 
The algorithm is implemented on TI’s MSP430 
microprocessor. Each heartbeat or noise signal generates an 
interrupt. The duration since last signal is obtained in the 
interrupt service routine. The possible durations between any 
two signals are accumulated and vote the segment to which it 
belongs. This algorithm is power saving because the 
processor is active only when interrupt service routine and 
voting procedure are being executed. The time and space 
complexity is Θ(n2), where n is the number of signals 
received during each collecting period. 
IV. EXPERIMENT RESULTS 
 We use a heart rate monitor kit to test the proposed 
algorithm on five healthy college young adults(identified as A 
to E). The kit for the heart rate monitor includes a wrist 
displaying unit, a chest strap sensing unit, and a pulse signal 
receiving unit. The pulse receiving unit is connected to TI’s 
MSP430 microprocessor’s interrupt pin to measure the 
duration between consecutive signals. These young adults are 
requested to run for tens of seconds with limited horizontal 
movement. After running, they stopped and wait for the 
recovery  of the heart rate. 
Figure 2 to Figure 6 show the heart rate measured by 
majority voting algorithm (solid line)  and by the wrist 
displaying unit (broken line) on the college-men. As can be 
seen from Figure 2, 4, and 6, the wrist heart rate monitor can 
not estimate the heart rate when heart rate rise significantly or 
there are noises. In Figure 3 and Figure 5 , the wrist 
displaying unit can estimate heart rate in higher density right 
after those college-men stop exercising. That means the wrist 
heart rate monitor works better when less noises exist. 
The majority voting algorithm shows its robustness in that 
heart rates can always be estimated within 4, 8, or 12 seconds. 
Table 1 shows the number of heart rates obtained by majority 
voting algorithm and the wrist heart rate monitor. 
t0 t1 t2 t3 t4 
t 
t5 
Signal Collecting Period 
Figure 7: Resting heart rates measured. 
Figure 8: Heart rates measured right after exercise. 
 
V. CONCLUSION 
Up to date, it is still a challenge to measure heart rate of  
exercising people without interfering the activity. This is 
important in a pervasive computing environment and in 
applications of homecare. In these applications, the majority 
voting algorithm can be a good choice for robust and accurate 
heart rate monitoring. As experiments have shown, the 
accuracy and instantaneity for heart rate monitoring can be 
improved through this algorithm. 
REFERENCES 
[1]  Jouven, X., Empana, J-P, and Schwartz, P, et al. Heart-rate profile 
during exercise as a predictor of sudden death. N Engl J Med. 2005; 
352(19): 1951-58. 
[2]  Cole, CR, Blackstone, EH, and Paskow FJ, et al. Heart-rate recovery 
immediately after exercise as a predictor of mortality. N Engl J Med. 
1999; 341:13151-57. 
 
 2
The main step of proposed algorithm is that intervals 
between any two signals (pulse and noise) are calculated. In 
fact, there is no way to differentiate pulse and noise signals. For 
example, if the signal collecting is chosen as one depicted in 
Fig. 1, then the right upper entries of the following matrix are to 
be calculated: 
⎥⎥
⎥⎥
⎥⎥
⎦
⎤
⎢⎢
⎢⎢
⎢⎢
⎣
⎡
−
−−
−−−
−−−−
−−−−−
45
3534
252423
15141312
0504030201
tt
tttt
tttttt
tttttttt
tttttttttt
. 
The entries that are not within the reasonable R-R intervals are 
precluded for voting. In above example, the entries enclosed by 
angle brackets are not used for voting. 
The ballot boxes for voting is formed by partitioning the 
reasonable R-R interval range into divisions. Each division 
represents heart rate range of 5, for example. Therefore, the 
first interval division D1 represents heart rate range [40 44], the 
second interval division D2 represents heart rate range [45 49], 
and so on. Thus there are thirty-four divisions for heart range 
from 40 to 209. 
When i-th signal arrived, its arrival time, say ti, and the 
values of ti-t0, ti-t1, …, ti-ti-1 are calculated. The value that is 
within the reasonable range then votes to the interval division it 
belongs. 
At the end of the signal collecting period, the votes of every 
two neighboring divisions are added. That is, votes of Di and 
Di+1 are added for i=1,…,33 (if the number of R-R interval 
divisions is thirty four.) Two neighboring divisions with the 
majority of votes can then be determined among the thirty-three 
added votes The reason of adding votes of two neighboring 
divisions is that R-R intervals nearby the division boundary 
may vote to two neighboring divisions fairly and causes a 
situation of equal number of votes. This may caused the 
majority of votes can not be determined. With such an heuristic 
method, majority can always be generated normally. 
As described, the variability of R-R intervals is more limited 
that noise intervals do. This implies that the intervals that vote 
to the majority divisions are more likely to be the R-R intervals 
and the two signals that form the intervals are more likely to be 
the heartbeat(pulse) signals. Thus the heart rates can be 
recovered if their arrival times are stored. 
In the situation that too many noises are generated or pulse 
signals are lost, a majority may not be obtained within one 
signal collecting period. In this case, the next signal collecting 
period starts with the accumulated votes of each divisions. 
III. EXPERIMENT RESULTS 
Several experiments are conducted to evaluate the 
effectiveness of the voting algorithm. The algorithm is 
implemented on a microprocessor with a commercial heart rate 
monitor kit. The kit consists of a chest strap, a wrist displaying 
unit, and a receiving unit. Each heartbeat or noise signal 
generates an interrupt. This algorithm is power efficient 
because the processor is active only when interrupt service 
routine and voting procedure are being executed. The time and 
space complexity is Θ(n2), where n is the number of signals 
received during each signal collecting period. 
A. Comparison with an existing heart rate monitor 
It is worthy to note that all commercial heart rate monitors 
increased or decreased heart rate gradually to eliminate the 
heart rate variability and magnify the acceptance from 
consumers. In Our algorithm adopts the similar approach for 
heart rate measurement in this category of experiments. That is, 
for every signal collecting period, the average heart rate is 
evaluated. 
Five college-aged men have put on the chest strap to test the 
effectiveness of the algorithm. These men are request to run in a 
confined area such that noise and pulse signals can be received. 
Table I shows the number of heart rates generated by our 
algorithm and the existing product. As Table I has shown, the 
existing product performed better in experiments conducted on 
college-aged men B and D. These experiments show the 
robustness of the voting algorithm in the presence of noises. 
Fig.2 and Fig.3 shows the heart rate curves generated by voting 
TABLE I 
COMPARISON ON NUMBER OF HEART RATES GENERATED 
Id. Voting Algorithm Existing Product 
A 37 7 
B 54 43 
C 47 11 
D 53 31 
E 58 16 
 
Time (seconds) 
Fig. 2.  .Heart rate measured for college-man B. 
 
Time (seconds) 
Fig. 3.  .Heart rate measured for college-man D. 
 4
may become distinctive for the voting process. 
 
C. Comparison with 12-lead ECG equipment 
In this experiment, the voting algorithm is verified with  
hospital 12-lead ECG equipment (GE MARQUETTE MAC 
5000). The 12-lead ECG equipment samples the ECG of the 
experiment object for 10 seconds on each stage of the five 
exercise stages. As can be seen from Fig. 6, the heart rate 
increased since exercise stage 1 to exercise stage 5. In each 
sampling period, the heart rates measured by voting algorithm 
approximate to ones measured by the 12-lead ECG in a good 
accuracy. The figures of sampling periods of stage 2 to stage 5 
are magnified in Fig. 6 to show the accuracy of the voting 
algorithm. 
D. Versatile signal collecting period 
The duration of signal collecting period is an important 
parameter for the voting algorithm. The longer the period is, the 
easier a majority voting result can be obtained in the cost of 
space and computation time. On the other hand, the shorter the 
collecting period is, the harder the pulses can be the winner of 
the votes. But as heart rate was raised, the increased pulse 
number within the period was considered to be the winner still. 
 To verify this consideration, a versatile collecting period 
based on the heart rate is tested: 
⎡ ⎤HR/240 . 
Unfortunately, no better result is obtained. This is because 
higher number of noises are generated in the situation of higher 
heart rate, which is caused by physical activity. Therefore, as 
shown in Fig. 7, when the estimated heart rates are over 120 
bpm (beats per minute), the followed heart rate estimation 
began to scatter due to the shrunken signal collecting period (2 
seconds). However, when heart rate approximate 180 bpm, the 
pulse signals won back the voting again. This phenomenon 
implies that more deliberation is required on determining the 
length of signal collecting period. 
IV. CONCLUSION 
By exploring the different behaviors between R-R intervals 
and noises, it is possible to exact the heartbeat signals from a 
mixture of pulses and noises. The proposed voting algorithm is 
effective in recovering heart rates based on the inheritance of 
R-R intervals. 
However, there are limitations when using this algorithm 
with a low cost pulse sensing unit. First, it can not be accurate 
as an ECG equipment for each R-R interval measurement due 
to the circuit design. Therefore, the heart rate variability due to 
respiration sinus arrhythmia, for example, can not be measured. 
Secondly, more deliberation is required in defining signal 
collecting period, which is a very important parameter for the 
voting algorithm. It may depends on the environmental factors, 
the quantity of generated noises, and so on. 
When heart rate monitoring in the field is required, the 
voting algorithm can be a robust and reliable choice if no 
sophisticated signal processing capability is available. The 
experiment results have show that the accuracy and robustness 
of the proposed algorithm . 
REFERENCES 
[1] Jouven, X., Empana, J-P, and Schwartz, P, et al. Heart-rate profile during 
exercise as a predictor of sudden death. N Engl J Med. 2005; 352(19): 
1951-58. 
[2] Cole, CR, Blackstone, EH, and Paskow FJ, et al. Heart-rate recovery 
immediately after exercise as a predictor of mortality. N Engl J Med. 1999; 
341:13151-57. 
. 
 
Fig. 7.  Heart rates measured by voting algorithm with fixed 4-sec. signal collecting period (solid line) and versatile signal collecting period (dashed line). Note that 
the voted heart rates scattered when they are over 120 bpm. 
 3)  Beneficiary of NHI: only 1.41% in NHI’s Beneficiaries. The 
number can even be lower in rural area(no statistics is 
obtained.) 
4)  Payment by NHI: only 1.51% in the total payment. No 
specific statistics for aboriginal regions is obtained. 
5)  The medical resource distribution: The medical institute 
distribution is not proportional to population distribution. 
Instead, about 60% medical institutes located in metropolis 
(about 30% population) as indicated in Fig.2, whereas less 
than 40% medical institutes are distributed to 12 rural 
regions. 
Distribution of medical institutes
Metropolis
rural-1
rural-2
rural-3
rural-4
rural-5
rural-6
rural-7
rural-8
rural-9
rural-10
rural-11
rural-12
 
Fig. 2. Distribution of medical institutes. 
 
The unbalanced medical resource distribution causes most 
rural villages short of doctors. It takes several hours for rural 
inhabitants to approach a regional hospital. To conquer this 
problem, four regional hospitals have developed an unique 
“circuiting medical service” to deliver medical service. In this 
program, each regional hospital is responsible for some remote 
mountainous sites (each site is a rural clinic in mountainous or 
aboriginal village). Medical personnel in most demanded 
departments are requested to march into and stationed at these 
public clinics in scheduled periods. The vehicles for the 
circuiting service(called “mobile hospital”) are equipped with 
medical equipments (for example, X-ray and supersonic 
imaging machines) so that some medical images, samples can 
be obtained during the circuiting trip. 
Meanwhile, the EHR(electronic health record) and smart 
cards have been promoted and obtained a success among 
Taiwan’s metropolitan hospitals and the NHI. While many 
faults incurred by paper health record were resolved by the 
success of EHR in plain area, the circuiting medical service is 
not benefited with it. This is because most rural villages lack 
data communication channels. Consequently, following 
problems are incurred: 
1)  Registration of outpatients can not be done on-line. A 
separate off-line store-and-forward mechanism is 
required. The process of applying benefits from 
BHNI(Bureau of National Health Insurance) was thus 
complicated. 
2)  A large volume of paper health records must be carried 
along with the circuiting personnel. 
3)  If a consultations is required, the only way is the voice 
conferencing on existing PSTN (public switched 
telephone network) because no communication facility 
for video or image is available. 
Furthermore, since the EHR can not be used in these rural area, 
labor works required in: a) searching paper health record in 
rural clinics and; b) keying-in updated health record into 
hospitals’ information system after circuiting. 
II. THE M-TAIWAN PROJECT IN HUA-LIEN COUNTY 
In 2002, Taiwan government launched a wireless technology 
promotion project to help regional governments in developing 
their own Internet applications with wireless technology. As for 
Hua-Lien County, 1.14 million USD are spent in connecting 
rural clinics and regional hospitals with VPN(Virtual Private 
Network) to resolve problems mentioned, as shown in Fig.3[4]. 
 
Fig.3 Connecting rural clinics to hospitals. 
 
In Fig.3, when a “mobile hospital” arrived at a rural clinic, 
the VPN router on the vehicle get connected to hospital’s VPN 
with wireless channels. Threefold advantages are achieved with 
the connection. First of all, the outpatients registration for 
hospitals and BNHI can be done in real-time. Secondly, the 
patients’ EHR can be accessed via the VPN channel with the 
terminals in mobile hospitals. Thus labors in searching health 
record can be eliminated. Finally, if a consultation was required, 
the medical images can be transferred in advance. Fig. 4 shows 
the location of the rural sites in which wireless access points are 
installed. 
Router/GW 
Router/GW
Router/GW
HIS/PACS
IP WAN 
Telecommuter Rural Clinics 
Regional Hospitals
Regional Hospitals 
PSTN 
VPN Access 
DSL Access 
HomeCar
Mobile Hospital
 Evaluating true cost effectiveness remains difficult, as 
M-Taiwan project was funded by both Industrial Bureau and 
regional government. However, project planners made every 
effort in making equipment suitable for village setting. 
The availability of a subsidy for Internet connectivity to 
school and rural health centers make these locations become 
tenants for a carrier in a community, creating an incentive in 
widening the service. 
ACKNOWLEDGMENT 
The authors would like to thank Ta-Tung Company and 
Hua-Lien County Government for providing relevant 
information of the project. 
REFERENCES 
[1] “Statistical Yearbook of Taiwan Indigenous Peoples, 2002”, Council of 
Indigenous Peoples, Taiwan Executive Yuan, Nov, 2003. 
[2] http://www.nhi.gov.tw/english/index.asp 
[3] http://www.hl.gov.tw/static/population/pop_table/ab9409.xls. 
[4] “Final Report for 2003 M-Taiwan Project”, Hua-Lien County, 2003 
Proceedings of 2007 CACS International Automatic Control Conference 
National Chung Hsing University, Taichung, Taiwan, Nov. 9-11, 2007 
occurred in the time window W1 (with length of Tw). 
Without loss of generality, the starting of the W1 is on the 
time that E1 occurred. Of those events, E2 and E6 are 
noises. Then all intervals between any two events are 
calculated. That is, 
ij ),(-)( jjij >= EtEtI  
are evaluated, where t(Ei) is the time that Ei occurred. 
After precluding the intervals that cannot be a normal 
RR-interval, each interevent intervals is voted to the 
associated ballot box according to their length, as shown 
in Fig. 2. In the figure, each ballot box is labeled with the 
range to which its voters(the interevent intervals) belong. 
For simplicity, the range is an exponential number, say 
2B ms, where B is the exponent of the range of a ballot 
box. 
 
 
 
Finally, the two or three neighboring boxes with the 
maximal number of votes may contain the speculated 
RR-intervals. In Fig. 2, the speculated RR intervals are 
the three interevent intervals that voted to ballots with 
labels of 620-683 and 684-747. And events that formed 
these intervals are speculated as R-peak events. 
Though the algorithm provides an easy way to 
approximate HR, two problems exist if a series of 
R-peaks is to be obtained for further HRV analysis. First, 
if more than one interval groups have the highest number 
of votes, which group should be chosen? Second, since 
the contiguous windows are independent, how to chain 
them to form a series of R-peaks. The solution to these 
two problems is the overlapped window scheme. 
The overlapped window scheme requires that a new 
window begin its event collecting process before the 
previous window finishes the voting, as shown in Fig. 3. 
The overlapped time zone, depicted as Toverlap, is the 
period that time windows W1 and W2 may have the 
common events, which are E5 and E6 in this example. If 
two contiguous windows agree on R-peaks that reside in 
the overlapped zone, then all R-peaks of the two 
windows are chained to form a longer series. 
 
 
The chaining process not only forms a longer series, 
it helps in choosing the most probable R-peak group 
when an equivocal condition occurs. The reason is that 
the real R-peaks may form a longer series than noises do. 
Because noises do exist, there are chances that two 
windows do not agree on R-peaks in overlapped zone. In 
that case, the previous R-peak series are, unfortunately, 
fractured. A higher noise rate may generate more, shorter  
and fractured series as can be seen from the simulation 
results. 
III. SIMULATION RESULTS 
A. Simulation Data and Methods 
The database employed to evaluate VAC  is the 
normal sinus rhythm RR interval database of 
PhysioNet[], which consists of ECGs(recorded by Holter 
monitors) of 54 objectives without cardiovascular 
diseases. Of the 54 objectives, 24 are females, 30 are 
males. Of their ages, the mean is 61.36, the standard 
deviation is 11.63, the maximal is 76, and the smallest is 
28.5. 
Of each ECG of 24 hours, the part of the first thirty 
minutes are extracted and contaminated by the noise 
generator for later simulation. 
The noises generator is in fact a Poisson process 
which is characterized by randomness and memoryless. 
The performance of VACA is evaluated for different 
noise arrival rates (or noise rates) ranging from 0.01 to 
1.00 with step of 0.01. Because pseudo random number 
is employed to generate a noise event, the measurement 
of the same performance metric on a noise rate is iterated  
five times so that VACA's performance can be evaluated 
fair. Thus 500 iterations required for each 30-min ECG. 
Since a contaminated R-peak series could be fractured 
by VACA, a patchery process is required to piece 
together those fractured series so that approximate HRV 
metrics can be analyzed. The HRV metric used to 
evaluate the accuracy of VACA is SDNN for its 
popularity and simplicity. SDNN, stands for Standard 
Fig. 1. An example for HR Approximation algorithm. 
Fig. 2. How Interevent intervals vote to the different ballots. 
Fig. 3. An example of overlapped window scheme. 
Proceedings of 2007 CACS International Automatic Control Conference 
National Chung Hsing University, Taichung, Taiwan, Nov. 9-11, 2007 
ECGs. 
IV. CONCLUSIONS 
Since the significance of HRV measurement in clinic 
has been proved and well documented for the last two 
decades. The applications of HRV in homecare or 
telecare is foreseeable.  For these applications, an 
all-day-long or an in-the-field HRV monitor may be 
required. 
 
V. CONCLUSIONS 
Since the significance of HRV measurement in clinic 
has been proved and well documented for the last two 
decades. The applications of HRV in homecare or 
telecare is foreseeable.  For these applications, an 
all-day-long or an in-the-field HRV monitor may be 
required. 
 With VACA, alternative front end, e.g. a peak 
detector or contactless methods, is possible. And its 
performance and robustness have been shown with the 
data from PhysioNet. 
ACKNOWLEDGMENT(S) 
The author thanks to National Science Council for 
funding this project with grant number of 
NSC95-2218-E-320-002.  
REFERENCES 
[1] L. S. Dreifus, J. B. Agarwal, E. H. Botvinick, etc., "Heart rate 
variability for risk stratification of life-threatening arrhythmias," J 
Am Coll Cardiol. Vol.  22, pp. 948-950, 1993. [Medline] 
[2] Jen-Liang Cheng, etc., “Heart Rate Measurement in the Presence 
of Noises”, Proceedings of 1st International Conference on 
Pervasive Computing Technologies for Healthcare, Innsbruck, 
Austria, 2006. 
[3] Z. X. Lin “The Study of Two Level Qualitative Herat Rate 
Variability Estimation Algorithm,” Master Thesis of Tzu-Chi 
University, August, 2007. 
Fig.7. Tachogram of RR series of NSR024. 
SDNN = 138.55ms 
Proceedings of 2007 CACS International Automatic Control Conference 
National Chung Hsing University, Taichung, Taiwan, Nov. 9-11, 2007 
To saturate a Zigbee PAN, the value for these 
parameters are chosen as: the node number is one of 2, 4, 
8, or 16 while the arrival rate is one of 2, 4, or 8. The data 
length chosen for simulation is one of 20 bytes, 40 bytes, 
or 80 bytes. For each simulation session, each end-device 
sends three hundred data packets to coordinator. Each 
packet that had been successfully received is then 
acknowledged. 
As mentioned, the performance indices to be studied 
here are the latency and the delivery ratioo. The latency 
is defined as the time between  the invoke of transmitting 
function (MCPS-DATA.request() of MAC) and the 
notification on the reception of an acknowledgement 
packet (MCPS-DATA.comfirm() from PHY). The 
delivery ratio is the ratio of number of packets that had 
been successfully transmitted and acknowledged to the 
total number of packets generated for a simulation 
session. Please note that the latency of dropped packets 
(they are infinite) are not included in the calculation of 
the average latency. 
III. THE RESULTS 
A. The Result of Latency Analysis 
In Fig. 2, the average latency are plotted for data 
length  of 20 bytes, 40 bytes, and 80 bytes. For any 
specific case of a  data length, say 20 bytes, the arrival 
rate is in an inverse ratio of node number so that the data 
rate is kept on 640B/s. As can be seen, the latency is 
influenced by the node number most. The triangle 
marks(node number=16) are always higher than square 
marks (node number=8) and diamond marks(node 
number=4) for various data length. The effect of arrival 
rate is similar to the node number because that the 
end-device must try to transmit or en-queue a packet on 
its arrival. For scenario with less number of nodes, more 
arrived packets can be queued and less collisions or 
back-offs may occur. 
 Note that the latency increases only slightly with the 
total data rate because that  the overhead of headers and 
back-offs mechanism is quite similar for all simulation 
session, which depends only on the total arrival rate. In 
other words, each simulation session in Fig. 2 has the 
summed arrival rate of 32. So the change of latency is 
due to the waiting time of the increased packet length.  
The average latency are plotted Fig. 3 for data arrival 
rates of 2, 4, and 8. To keep total data rate constant for an 
arrival rate. The length of the data is in the inverse ratio 
to the node number.  
By comparing Fig. 3 to Fig. 2,  we can find that the 
slope of triangle-marked line in Fig. 3 is larger than that 
of Fig. 2. This is because the summed arrival rate is 
increased. For example, the arrival rates for the triangle 
marks are 32, 64, and 128 respectively while that for 
square marked line are 16, 32, and 64 respectively. Note 
that the latency in each Fig. 2 and Fig. 3 do not include 
the dropped packets. The linearity shown is in the price 
of dropped packets. 
 
 
 
 
B. Result of Delivery Ratio Analysis 
As we have shown, the latency seems to be increased 
linearly with arrival rate. Unfortunately, the linearity is in 
the price of dropped packets. The reason of that latency 
does not deteriorate dramatically is due to the regulation 
of macMaxCSMABackoffs in CSMA/CA. Packet that 
had been backed off for macMaxCSMABackoffs times 
will be dropped if it is to be backed-off again. For that 
reason, the delivery ratio must be investigated to explore 
the performance. 
 
  
Fig. 4 shows that data length still affect the delivery 
ratio almost linearly, but the slop of the line depends on 
the node number. Again, the summed arrival rate is kept 
constant, say 32, for all simulation session. But the 
session with node number of 16 dropped more packets 
than other sessions did. 
Fig. 5 may be the most interesting result of this study. 
In which, the delivery ratio deteriorates much faster for 
an increased arrival rate than that for an increased length. 
This situation can be blamed on the increased backoffs 
whose probability strongly depends on the node number 
Fig. 4. The plots of delivery ratio for various data length. 
Fig. 3. The plots of latency for various arrival rate. 
Fig. 2. The plots of latency for various data length. 
遠距照護閘道器之製作 
The Implementation of a Telecare Gateway 
a鄭仁亮  a李俊弘  a江哲瑋  a朱育正 
a慈濟大學醫學資訊研究所 
tomcheng@mail.tcu.edu.tw 
 摘要 
隨著社會的高齡化，如何克服醫護資源缺乏的問題，
是未來各國在衛生政策必須面對的課題。根據一些研
究指出，高齡者在家中或社區接受遠距照護的做法，
將是未來最能善用醫療資源的方式之ㄧ，惟此種架構
有賴於網路及生理監測技術的整合。本研究即以此架
構為基礎，提出一結合網際網路以及 Zigbee 網路的系
統，並製作遠距照護閘道器來連接網際網路及感測網
路，以實現遠距照護系統。最後並以心率量測做為本
架構的實作範例，結果顯示此種架構具有容易製作、
低成本、容易接取的優勢，適合作為遠距照護的架構。 
關鍵字：遠距照護、閘道器、Zigbee 
Abstract 
The shortage of caring resources is becoming an 
inconvenient issue in health policies of all aging societies. 
Telecare, which heavily relies on the vital sign sensing 
and device connectivity, is one of the methods that can 
effectively utilizes the medical resources, according to 
some researches. This paper presents the architecture 
and implementation of a telecare system which is based 
on an Internet/ZigBee gateway. The simplicity, low-cost, 
accessibility of the architecture is demonstrated with an 
application of grouped heart rate monitors. 
Keywords: Telecare, Gateway, ZigBee. 
1、前言 
根據內政部社會司於 2006 年的統計，我國 65 歲以上
老年人口佔總人口的 9.87%，已超過聯合國高齡化社會
的標準，其中又以老年人在醫療成本花費較高[1]，對
於罹患慢性病老人而言，若長期居於醫療院所，則不
僅生理心理難適應，其所需之醫療資源甚鉅，因此建
立遠距醫護是改善上述問題的方法之ㄧ。 
建立遠距醫療照護技術，一則有賴於成熟之生理感測
技術，另一方面則是要運用成熟之數據通訊或網路技
術。 
根據調查，顯示臺灣人使用網際網路人口達到六成之
多[2]，且人數正逐漸增加中。網際網路的便利性、
普及性，使得各類裝置與設備亦可以該技術連結，進
行資料傳送，而不限於人員與一般電腦。 
另一方面，微機電、感測與微波等技術的發展，促使
了無線感測網路的興起，2005 年提出之 IEEE802.15.4 
/ZigBee 標準即是一種短距離的無線通訊技術。低速率
資料傳輸、省電、低價位是它的最大訴求，而「個人
區域網路(PAN)」就是它最可能的應用之ㄧ。 
ZigBee 能掌控六萬多個 Sensors，介面傳輸只要二十
分之一秒 [5][6]。這項技術還可應用於門禁管理系
統、環境監測系統、燈光控制系統、即時訊息傳輸系
統，應用範疇非常廣。在遠距照護應用，受照護者的
生理資料就很適合使用 ZigBee 傳送。 
利用網際網路的普及性和 ZigBee 感測網路的特性，本
研究擬將此兩種異質網路結合，來實現遠距照護的理
想。 
2、系統架構 
為了連接網際網路以及 ZigBee，我們以一個人電腦(PC)
與ZigBee協調器製作了一個遠距照護閘道器來執行此
一工作。整個照護系統架構如圖一所示。 
 
圖一：系統架構圖 
其中終端裝置(Device)負責蒐集生理訊號，再將資料
以 ZigBee 的封包格式傳送給協調器(Coordinator)，
並進而傳給 PC 作為網際網路上一個 TCP Socket Port
的資料來源。 
但是 ZigBee 通訊係以短位址(short address)作為基
 
圖四：客戶端運作情形 
4.結論 
遠距照護是未來的趨勢，本研究所實作之閘道器連結
了網際網路和 Zigbee 兩個異質網路，為未來之照護技
術，開啟了一個可能的做法。其優勢在於低價位、容
意接取、使用既存之標準技術，易於移植至其他嵌入
式系統。但應用於生理監測時，其衍生之安全、隱私
等問題，有待更多之研究解決。 
經費來源 
NSC95-2218-E-320-002, 
NSC95-2815-C-320-001-E 
參考文獻 
[1] 吳凱勳,＂臺灣全民健康保險十年回顧與展望＂ 
[2] 創 市 際 市 場 研 究 顧 問 公 司 URL ：
http://www.insightxplorer.com/news/news_12_27_
06.html  
[3] Michael K. Jonson, Erick W. Troan “Linux 應用程
式發展手冊＂, 美商艾迪生衛斯里出版。 
[4] 徐千洋, ”Linux C”, 旗標出版社 2001 年 4 月. 
[5] Zigbee Alliance, “Zigbee specification”, June,2005 
[6] IEEE STANDARDS 802.15.4-2003.pdf New York, 
NY October 2003 
[7] Jen-Liang Cheng, etc.,”A Robust Heart Rate 
Measurement Algorithm” , Proceedings of 3rd 
International Conference on e-Government e-Health, 
Milan, 6-8, July, 2006. 
[8] Jen-Liang Cheng, etc., “Heart Rate Measurement in 
the Presence of Noises”, Proceedings of 1st 
International Conference on Pervasive Computing 
Technologies for Healthcare 2006, Innsbruck, Austria, 
29th Nov.-1st Dec 
 
 
to the associated box according to their length. For any healthy 
human, the length of consecutive RR intervals can vary only 
slightly. Thus, within a short period, the intervals that formed 
by the two consecutive R-peaks are more likely to be clustered 
together than intervals consists of a noise. The clustered 
intervals are then speculated as the real R-peaks. 
Fig. 1 shows an example for that HR approximation 
algorithm. As can be seen from Fig. 1, events E1-E6 occurred 
in the time window W1 (with length of Tw). 
Without the loss of generality, the starting of the W1 is on 
the time that E1 occurred. Of those events, E2 and E6 are noises. 
Then all intervals between any two events are calculated. That 
is, 
ij ),(-)( ijji, >= EtEtI  
are evaluated, where t(Ei) is the time that Ei occurred. 
After precluding the intervals that cannot be a normal RR-
interval, each inter-event intervals is voted to the associated 
ballot box according to their length, as shown in Fig. 2. In the 
figure, each ballot box is labeled with the range to which its 
voters(the inter-event intervals) belong. For simplicity, the 
range is an exponential number, say 2B ms, where B is the 
exponent of the range of a ballot box. Note that intervals that 
outrange the reasonable R-R interval are precluded for voting. 
For the example above, I1,2, I2,3, I5,6, and I6,7 are precluded and 
not voted to ballot boxes. 
 
 
Finally, every two neighboring boxes' votes are compared. 
The collaborated votes that wins the voting are then speculated 
to be the RR-intervals. In Fig. 2, the speculated RR intervals 
are the three inter-event intervals that voted to ballots with 
labels of 620-683 and 684-747. And events that formed these 
intervals are speculated as R-peak events. 
Two problem arise when the pulse train obtained by above 
algorithm is to be used for measuring HRV. First, if more than 
one interval groups have the highest number of votes, which 
group should be chosen? Second, since the contiguous 
windows are independent, how to chain them to form a series 
of R-peaks. The solution to these two problems is the 
overlapped window scheme. 
With the overlapped window scheme, a new window 
begins its event collecting process before the previous window 
finishes the voting, as shown in Fig. 3. The overlapped time 
zone, depicted as Toverlap, is the period that time windows W1 
and W2 may have the common events, which are E5 and E6 in 
this example. If two contiguous windows agree on R-peaks 
that reside in the overlapped zone, then all R-peaks of the two 
windows are chained to form a longer series. 
 
 
The chaining process not only forms a longer series, it 
helps in choosing the most probable R-peak group when an 
equivocal condition occurs. The reason is that the real R-peaks 
may form a longer series than noises do. 
Because noises do exist, there are chances that two 
windows do not agree on R-peaks in overlapped zone. In that 
case, the previous R-peak series are, unfortunately, fractured. 
A higher noise rate may generate more shorter and fractured 
series as can be seen from the simulation results. 
III. SIMULATION RESULTS 
A. Simulation Data and Methods 
The database employed to evaluate VACA  is the normal 
sinus rhythm RR interval database of PhysioNet[4], which 
consists of ECGs of 54 objectives without cardiovascular 
diseases. Of the 54 objectives, 24 are females, 30 are males. Of 
their ages, the mean is 61.36, the standard deviation is 11.63, 
the maximal is 76, and the smallest is 28.5. 
Of each ECG of 24 hours, first thirty minutes are extracted 
and contaminated by the noise generator for later simulation. 
The noises generator is in fact a Poisson process for the 
reason of its random and memory-less characteristics. The 
performance of VACA is evaluated for different noise arrival 
rates (or noise rates) ranging from 0.01 to 1.00 with step of 
0.01. Because pseudo random number is employed to generate 
a noise event, the measurement of the same performance metric 
on a noise rate is iterated  five times so that VACA's 
Fig. 3. An example of overlapped window scheme. 
Fig. 1. An example for HR Approximation algorithm. 
Fig. 2. How Interevent intervals vote to the different ballots. 
identified with its tachogram of RR intervals shown in  Fig. 7.  
In this case, the original SDNN is extraordinarily large, so 
that more than one majority groups are formed. Thus VACA 
may fail to choose the group with highest votes during the 
voting phase. The problem may be alleviated by clustering 3 
rather than 2 neighboring ballot boxes for majority. This 
alternative, however, affects the E-SDNN's accuracy associated 
with other ECGs. That means that VACA has faced a dilemma 
in tuning parameters between exceptional ECGs and ordinary 
ECGs 
 
IV. CONCLUSIONS 
Since the significance of HRV measurement in clinic has 
been proved and well documented for the last two decades. The 
applications of HRV in homecare or telecare is foreseeable.  
For these applications, an all-day-long or an in-the-field HRV 
monitor may be required 
With VACA, alternative front end, e.g. a peak detector or 
contactless methods, is possible. And its performance and 
robustness have been shown with the data from PhysioNet. 
 
[1] L. S. Dreifus, J. B. Agarwal, E. H. Botvinick, etc., "Heart rate variability 
for risk stratification of life-threatening arrhythmias," J Am Coll Cardiol. 
Vol.  22, pp. 948-950, 1993. 
[2] Jen-Liang Cheng, etc., “Heart Rate Measurement in the Presence of 
Noises”, Proceedings of 1st International Conference on Pervasive 
Computing Technologies for Healthcare, Innsbruck, Austria, 2006. 
[3] Z. X. Lin “The Study of Two Level Qualitative Herat Rate Variability 
Estimation Algorithm,” Master Thesis of Tzu-Chi University, August, 
2007. 
[4] Goldberger AL, Amaral LAN, Glass L, Hausdorff JM, Ivanov PCh, 
Mark RG, Mietus JE, Moody GB, Peng CK, Stanley HE. PhysioBank, 
PhysioToolkit, and PhysioNet: Components of a New Research 
Resource for Complex Physiologic Signals. Circulation 101(23):e215-
e220 [Circulation Electronic Pages; 
http://circ.ahajournals.org/cgi/content/full/101/23/e215]; 2000 (June 
13).
 
Fig.7. Tachogram of RR series of NSR024. 
SDNN = 138.55ms 
2969 2

Abstract—Heart rate profile related to exercise or other
physical activities can be a crucial indicator of individual health
according to recent researches. This makes heart rate
measurement without interfering ongoing activity plays an
important role in medical services and pervasive computing
applications. However, there are challenges for wearable
apparatuses to measure the heart rate in good accuracy and
reliability: the lack of sophisticated signal processing capability
and the generation of noises caused by physical activity. In this
paper, a robust heart rate measuring algorithm is proposed.
Several experiments are conducted to give evidence of the
robustness and accuracy of the proposed algorithm.
Index Terms—Wireless and wear-able devices for pervasive
healthcare, Sensing of vital signs and transmission.
I. INTRODUCTION
eart rate profile during exercise or ADL (activity of
daily living) is an important indicator of health [1][2].
Some researches concluded that an abnormal heart-rate
profile during exercise and recovery is a predictor of sudden
death [3][4][5]. Among the three components of the profile,
lower heart rate during exercise was the strongest risk factor for
sudden death. The other two components were also predictors:
the higher a person’s resting heart rate the higher risk they 
carried, and those whose heart rate recovered slowly after
exercise were at increased risk as well.
The best way to measure heart rate is to use a standard ECG
recorder and calculate instantaneous heart rate from R-R
intervals [6]. However, this is not feasible in the field. Several
types of wearable devices called “heart rate monitors”are
developed within decades for purpose of exercise training. All
heart rate monitors consist of the two parts: a pulse sensing unit
and a heart rate displaying unit. The pulse sensing unit consists
of electrodes (or transducers) and filtering circuit. Among the
pulse sensing techniques, methods that using the acoustic
Manuscript received Jun 30, 2006. This work was supported in part by the
Taiwan National Science Council under Grant NSC 94-2218-E-320-002.
J. L. Cheng is with the Department of Medical Informatics, Tzu-Chi
University. No.701, Sec.3 Chung-Yang Rd., Hua-Lien City 970, Taiwan
(e-mail: tomcheng@mail.tcu.edu.tw)
J. R. Jeng is with the Division of Cardiology, Buddhist Tzu-Chi General
Hospital. No.707, Sec.3 Chung-Yang Rd., Hua-Lien City 970, Taiwan (e-mail:
jrjeng@tzuchi.com.tw)
C.W. Chiang is with the Department of Medical Informatics, Tzu-Chi
University. No.701, Sec.3 Chung-Yang Rd., Hua-Lien City 970, Taiwan
(e-mail: 92316131@stmail.tcu.edu.tw)
arterial pulse or capillary blush techniques are much more
affected by artifact than ECG techniques.
To sense a pulse signal accurately, the contact between an
electrode and the skin must be steady. This heavily depends on
the user’s usageof the sensing. Unfortunately, noises are
generated when the sensing unit quakes during exercise in the
field.
Commercial sensing unit consists of a series of components
to sense and emit pulses: band pass filter, peak detector, and
radio frequency circuit. Due to the lack of sophisticated signal
processing capability, a noise may be treated as a pulse signal in
the pulse receiving unit. The unfiltered noise may cause the
receiving and displaying unit reveals error heart rate data.
In this paper, we have proposed a voting algorithm to recover
the R-R intervals within a certain period in which noise signals
and pulse signals are received and can not be differentiated.
II. THE VOTING ALGORITHM FOR R-R INTERVAL REBUILDING
Though pulse and unfiltered noise can not be differentiated
under certain conditions, they behave differently on the interval
of occurrence. For a short period, the variability of R-R
intervals is very limited. However, this is not the case for noises.
That is, R-R intervals may reveal more regularity than intervals
between two noises do. Based on the observation, the voting
algorithm is proposed as followed.
Let t0, t1, t2,…, tn be the time points that signals (noises or
pulses) are received within a defined period (called signal
collecting period) as shown in Fig. 1. A pulse (heartbeat) is
represented by a solid vertical bars and a noise is represented by
a dashed vertical bar in Fig. 1. Note that t0 is the last signal
received before the starting of current signal collecting period.
The intuitive majority voting that asks intervals formed by two
Heart Rate Measurement in the Presence of
Noises
Jen-Liang Cheng, Jing-Ren Jeng, and Zhe-Wei Chiang
H
t0 t1 t2 t3 t4 tt5
Signal Collecting Period
Fig. 1. An example of pulse and noise signals within the signal collecting
period.
2969 4
may happen when some middle heartbeat signals are lost.
Because intervals consist of two R-R intervals are also used to
vote, these intervals may become distinctive if the middle pulse
signals are lost. However, the voting algorithm recovered from
the error immediately after a more accurate heart rate is
obtained. A simple filtering method can prevent intervals
consist of dual R-R intervals winning the majority.
B. Comparison with 12-lead ECG equipment
In this experiment, the voting algorithm is verified with a
hospital’s 12-lead ECG equipment (GE MARQUETTE MAC
5000) with a treadmill. The 12-lead ECG equipment samples
the ECG of the experiment object for 10 seconds on each of the
five exercise stages on the treadmill. As can be seen from Fig. 4,
the heart rate increased from exercise stage 1 to exercise stage 5.
In each sampling period, the heart rates measured by voting
algorithm approximate to ones measured by the 12-lead ECG in
a good accuracy. The figures of sampling periods of stage 2 to
stage 5 are magnified in Fig. 4 to show the accuracy of the
voting algorithm.
C. Versatile signal collecting period
The duration of signal collecting period is an important
parameter for the voting algorithm. The longer the period is, the
more likely a voting majority can be obtained with the cost of
space and computation time. Intuitively, as heart rate increased,
the shorter signal collecting period might be used to improve
the instantaneity. To verify this thought, following versatile
Fig. 4. Heart rates measured by voting algorithm (solid line) and 12-lead ECG equipment (dashed line). Note that R-R intervals are sampled for 10 seconds every
three minutes by 12-lead ECG.
Fig. 5. Heart rates measured by voting algorithm with fixed 4-sec. signal collecting period (solid line) and versatile signal collecting period (dashed line). Note
that the voted heart rates scattered when they are over 120 bpm.
