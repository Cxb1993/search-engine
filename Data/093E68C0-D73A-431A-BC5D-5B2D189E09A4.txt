研究計畫之背景、動機及目的 
隨著通訊科技日益精進，國人對於通訊定位服務的要求更趨嚴格，
由於傳送至全球衛星導航系統接收機(Global Navigation Satellite System, 
GNSS)的訊號強度相當的微弱，造成在傳送訊號過程中很容易受到人為
或非人為的干擾進而影響其GNSS接收機的定位精度。目前對於GNSS頻
段內干擾消除的方法有三；第一類稱之為陣列天線模組，主要為利用
多組天線進行干擾方位估測以及調整天線組的相位與增益達到干擾
消除的目的。第二類型為相關運算前訊號處理 (pre-correlation 
processing)，其主要為將高頻訊號轉換為中頻數位或類比訊號後進行
訊號振幅(amplitude)、時域(time domain)或頻域(frequency domain)訊
號處理以減低干擾對GPS訊號的影響。最後一個類型為相關運算後訊
號處理 (post-correlation processing)，其方法主要利用軟體無線電
(software define radio)的方式將GPS與其他輔助導航裝置(device)整合
以提升導航定位之精度。就干擾抑制效果而言，陣列天線模組可取得
較高之干擾抑制能力，而相關運算前訊號處理技術其效果與成本均適
中，但得重新設計接收電路(circuit)，第三種處理方式雖然可利用一現成
的GNSS接收機外加慣性導航元件輔助定位，但效果畢竟有限。總而言
之，就干擾抑制性能而言，若能在接收機(receiver)射頻前端(RF front-end)
立即將干擾移除或加以抑制，其效果遠較於後端實施為佳。本研究以一
年的時間，研究上述三類干擾抑制技術，並提出相關性能改善辦法。計
矩陣和理想陣列追蹤向量的乘積，即可獲得經過補償後的有互耦影響的
追蹤向量，而利用適應性演算法也可將天線間互耦效應的問題解決。 
嵌入式設計概念目前已廣泛應用於系統測試以及驗證，此設計方式
可以快速將硬體系統以及軟體程式整合於一可程式規劃晶片中，節省許
多硬體成本支出，相當受到市場歡迎。而相關技術發展亦已趨成熟，因
此，本計劃建立一嵌入式系統來實現與評估天線互耦補償以及干擾抑制
技術。 
利用空間與時間訊號處理技術，在互耦矩陣已知的條件下，利用疊
代法(iterative method)去獲得最小均方解 (least square solution, LS)，再將
所估測到的互耦矩陣去補償該效應對干擾抑制的影響。在干擾抑制方
面，我們利用以最小變異量擾動之波束合成的方法來消除寬頻干擾，並
輔助快速QR分解運算使其能減低運算時間，並可實現於嵌入式發展板
上。 
研究成果及說明 
由於在進行GNSS定位的過程中，GPS訊號很容易受到干擾，有關於
干擾抑制分析的議題，本研究先行採用先前所述第二種處理方式：頻域
搭配時域濾波來進行同通道干擾訊號的消除。此方面的分析研究成果可
參考附件一「Performance Analysis of Narrowband Interference Mitigation 
and Near-Far Resistance Scheme for GNSS Receivers」發表於Signal 
計畫成果自評部份 
此計劃已完成預定進度，也已經發表 3 篇國際知名期刊(SCI/EI)，
兩篇國際會議論文，並有一件專利申請中。此計劃之衍生研究成果已登
錄於國科會網站衍生研發成果推廣資料表中。 
致 謝 
本計劃感謝國科會提供經費補助，另外，也特別感謝成功大學機電
整合實驗室提供相關貴重儀器，使本計劃在實驗方面得以順利進行，在
此致上十二萬分謝意。 
Author's personal copy
Performance analysis of narrowband interference mitigation and
near-far resistance scheme for GNSS receivers
Chung-Liang Chang a,, Jyh-Ching Juang b
a Department of Biomechatronics Engineering, National Pingtung University of Science and Technology, No. 1, Shuefu Road, Neipu, Pingtung County, Taiwan, ROC
b Department of Electrical Engineering, National Cheng Kung University, No.1, Ta-Hseuh Road, Tainan City 70101, Taiwan, ROC
a r t i c l e i n f o
Article history:
Received 21 June 2008
Received in revised form
3 February 2010
Accepted 9 March 2010
Available online 19 March 2010
Keywords:
GPS
Pseudolite
Near-far problem
Interference
a b s t r a c t
This paper presents a method to mitigate the interferences against pseudolite-type and
continuous-wave interferences in a global navigation satellite system (GNSS) environ-
ment. Ground-based pseudolites can transmit GPS-liked signals and augment GNSS
constellations to enhance the accuracy, integrity, and availability. Unfortunately, a
nearby pseudolite may induce a strong interference to GPS receivers. As a result, the
receiver may fail to acquire and track signals from satellites. In order to account for such
a problem, a mitigation scheme that combines the use of frequency domain excision
method and direct reconstruction method is proposed to effectively nullify continuous-
wave and pseudolite-type interferences, so that the GPS signals can still be tracked in
the presence of strong interferences. Experiment results show that with the removal of
interferences, the measured narrow-to-wide power ratio for all satellites can be
enhanced. A sensitivity analysis is then conducted to assess the performance of the
proposed algorithm in the presence of errors in the estimation of the signal power,
Doppler frequency and code delay. Finally, the problem of combined interferences of
pseudolites and continuous-wave sources is investigated both theoretically and
experimentally. It is shown that the method is applicable to mitigate narrowband
continuous-wave interferences and pseudolite-type interferences.
& 2010 Elsevier B.V. All rights reserved.
1. Introduction
An active research area pertaining to GNSS (global
navigation satellite system) is the service augmentation
for better accuracy, integrity, continuity of service, and
availability. A well-known method for the augmentation
of GNSS for enhanced accuracy and integrity is to employ
pseudosatellites or pseudolites (PLs), which are ground-
based transmitters that transmit GPS-like signals [1,2]. As
the frequency, modulation, and signal structure of
pseudosatellite (pseudolite) signals are compatible with
GPS satellite signals, receivers can simultaneously receive
and process both GPS signal and PL signal to improve
geometric dilution of precision and, therefore, accuracy
and integrity. Beneﬁts of pseudolite include provision of
ranging signal augmentation to the GPS, transmission of
differential correction and integrity monitoring informa-
tion to participating receivers, enhancement of integer
ambiguity resolution through rapid geometric changes,
and provision of data link capability. The use of pseudolite
is also deemed an important option in the ground-based
augmentation system (GBAS) to provide the required
positioning accuracy, integrity, continuity, and availability
for aircraft approach and landing. More recently, several
PL-based indoor navigation and integrated navigation
approaches for accuracy enhancement and coverage
enlargement have been investigated [3–7]. Unfortunately,
due to the notorious near-far problem, a pseudolite signal
Contents lists available at ScienceDirect
journal homepage: www.elsevier.com/locate/sigpro
Signal Processing
ARTICLE IN PRESS
0165-1684/$ - see front matter & 2010 Elsevier B.V. All rights reserved.
doi:10.1016/j.sigpro.2010.03.013
 Corresponding author. Tel.: +88687703202x7586;
fax: +88687740420.
E-mail addresses: chungliang@mail.npust.edu.tw, ngj567.liang@msa.
hinet.net (C.-L. Chang).
Signal Processing 90 (2010) 2676–2685
Author's personal copy
is considered. When the incoming signal is sampled and
assembled in blocks, the signal can be expressed as
rmk ¼ smd,kþsmJ,kþvmk ð4Þ
where the discrete-time sequences smd,k represents the k-th
sample of the m-th block. Likewise for smJ,k, and v
m
k . It is
assumed that the sequences smd,k, s
m
J,k, and v
m
k are mutually
independent. Generally speaking, the noise power is
stronger than the signal and the interference power may
be stronger than the noise.
With respect to narrowband CWI, many methods such
as adaptive transversal ﬁlters, fast Fourier transform (FFT)
methods, and neural networks, can be employed for
interference mitigation. In the current scheme, an FFT
based method is used because the received data is
grouped into blocks [26], which become suitable for FFT
processing. After utilizing discrete Fourier transform of
block with length NFFT, the output samples Xmn is given by
Xmn ¼
XNFFT
k ¼ 1
rmk e
-j2pnk=NFFT ð5Þ
In the frequency domain, each interference manifests
itself as a concentrated power, resulting in a peak in the
spectra. By comparing the magnitude of each frequency
cell to a threshold and limiting those cells within the
threshold, interferences can be excised. The effectiveness
of the FFT based method depends on the selection of the
threshold. The following method is used for the determi-
nation of the threshold. The mean value of frequency cells
and variance is computed, respectively, as [23]
Tmean ¼
XNFFT
n ¼ 1
10 log10 jXmn j
NFFT
ð6Þ
and
Tvar ¼
1
NFFT
XNFFT
n ¼ 1
ð10 log10ðjXmn jÞÞ2-
1
NFFT
 XNFFT
n ¼ 1
10 log10ðjXmn jÞ2
" #
ð7Þ
The threshold is determined according to the mean power
and variance of frequency cells and is given by
Texcision ¼ TmeanþaTvar ð8Þ
The scale factor a in the above equation is adjusted to
maintain the threshold at some value of the noise ﬂoor.
Each frequency cell is compared to the threshold and
if that exceeds the threshold, its value is held at the
threshold. Fig. 2 shows the processing result with the
above method. The top ﬁgure depicts the spectra after
the FFT. In the ﬁgure, the intermediate (center) frequency
is 15.42MHz. Several in-band interferences are clearly
observed. By removing these peaks, the spectra are
shown in the bottom ﬁgure. After IFFT (inverse FFT), the
signal is much less contaminated with narrowband
interferences.
In addition to narrowband interferences, a nearby non-
cooperative pseudolite may signiﬁcantly degrade the
performance of a GPS receiver. Indeed, a pseudolite may
broadcast a strong GPS-like signal, so that the tracking
system of a GPS receiver fails to acquire the desired
signals from GPS satellites. A reconstruction method is
used to suppress undesired pseudolite signals. To this end,
the amplitude, frequency, and code phase of the pseudo-
lite signal is estimated. Because this paper is under the
prerequisite of not inﬂuencing the continuity of tracking,
carrier phase can be ignored. In addition, when the
receiver receives the interference signal of pseudolite
near-ﬁeld, there is almost no carrier phase between
interference transmitter and receiver itself. The processed
signal ~rmk is then input into an estimated interference
correlator containing downconverters, dispreading and
accumulated process. The estimation of these parameters
is implemented using a software radio approach. The
interference parameters are then obtained from the
software acquisition program. Thus, the accumulator
output from correlator tracking pseudolite for I and Q
channel with estimated code delay error DtJ can be
ARTICLE IN PRESS
cos
sin
Accumulator I
Code NCO
C/A Code 
Generator
Accumulator
Carrier NCO
Narrowband 
interference 
removal (FDE) 
Dump i
Lock Detector and
         Estimator
Strong -PRN Interference
Re -constructionCode delay
Amplitude
Doppler freq.
∑
Lock status
Power
Tuner
Acquisition/Tracking 
Processing
Input Signal r 
τˆJ
ˆfJ
ˆPJ
+
_
Interference Cancellator
Gain 
Control
Parameter
Tuner
sˆk,PL
m
kr
ˆPJ /No
m
kr
~m
k
(⋅)Ci
Q
Fig. 1. GPS interference mitigation scheme.
C.-L. Chang, J.-C. Juang / Signal Processing 90 (2010) 2676–26852678
Author's personal copy
follows:
r^
0
kI ¼
ﬃﬃﬃﬃﬃ
P0
p
cosy0þ
XL
i ¼ 1
ﬃﬃﬃﬃ
Pi
p
LIiþx
00
k,I ð17Þ
r^
0
kQ ¼
ﬃﬃﬃﬃﬃ
P0
p
siny0þ
XL
i ¼ 1
ﬃﬃﬃﬃ
Pi
p
LQiþx
00
k,Q ð18Þ
P0 is the power for weak signal satellite, y0 is the
frequency phase, and L is deﬁned in (2). LIi and LQi are
the I-component and Q-component cross-correlation
function for desired satellite, x
00
k,I and x
00
k,Q are the noise
samples with the variances are s2x ¼N0=2T. If the
pseudolite interference is accurately estimated, the
inﬂuence due to the nearby pseudolite interference is
effectively removed, and the weak satellite signals can
then be tracked. Then the effective signal to noise ratio
ðP^=NÞ is determined as follows:
P^=N¼ P^0=N0-10 log10ðBÞ ðdBÞ ð19Þ
where B is the IF bandwidth and P^0=N0 is determined as
the same in (13).
3. Simulation and experiment results
In the section, simulation and experiment results are
described to verify the feasibility of the proposed scheme
for interference mitigation. Fig. 3 depicts the overall
experiment setup. A GPS antenna (model 600) is used to
receive signals from GPS satellites. The received signal is
indeed contaminated with two optional interferences
together with noises. A narrowband interference simu-
lator is adopted to generate continuous-wave interference
and a pseudolite is employed to generate pseudolite
interference (PLI). These signals are combined via two
combiners as shown in Fig. 3. For reference, a commercial
GPS receiver (NovAtel DL4) is employed to monitor the
GPS signals. The received signal is sent to a cPCI chassis
(National Instruments PXI 1000B) with an RF/down-
conversion module (NI PXI-5600) and digitization
modules (NI PXI-5620); see [27] for hardware descrip-
tion. The IF of front-end is 15.42MHz, analog to digital
converter (ADC) performs 14-bit quantization, and the
sampling rate is 7.11MHz. The reason for the choice of
this sampling rate is due to data reception of longer
duration and avoidance of aliasing effect. The data
samples from each antenna element are stored and,
afterwards, post-processed for FDE and DRC analysis.
Table 1 summarizes the comparison results of one
particular simulation. To demonstrate the difference of
interference mitigation performance between the
proposed method and other published methods, this
paper will be compared with literature reviews [22,25].
The number of delayed tap in adaptive transversal ﬁlter
[22] is 9 and the detailed parameter setup of neural
network can be found in [25]. In this simulation, GPS
satellite signals with the following PRNs are acquired: 1,
2, 3, 11, 15, and 23. The integration time is selected as
3ms. Two types of interferences are considered: one is PLI
and the other is a combined PLI and CWI. The strength of
the interference is 10dB above the thermal noise. The
execution time is measured using the tic and toc functions
in MATLAB. An average PC (Pentium Dual-Core 1.0GHz) is
used for 20 execution time measurements, with the mean
computed as well. When the system is subject to only PLI,
the effective P^=N (post-correlation process) ranges from
1.4dB (for SV#1) to 3.6 dB (for SV#11). After the
reconstruction method (DRC) is applied, the resulting
P^=N is greatly improved, giving values from 21.0 to
25.9 dB. The GPS signals can then be effectively tracked.
In the presence of both PLI and CWI, the post-correlation
P^=N is much lower when there is no anti-jam processing.
When DRC is used, the P^=N is enhanced. Moreover, when
both DRC and FFT-based methods (FDE) are utilized, the
P^=N is further improved and the GPS signals can be
tracked. In short, the proposed scheme can indeed be used
to mitigate both PLI and CWI so that GPS signals can be
successfully tracked. Table 2 presents that the operation
time of the proposed method is shorter than that of two
other methods.
Fig. 4 shows the acquisition plots for SV#2 of the above
simulation. On the left-hand side, when the PLI is not
removed, the correlation peak is difﬁcult to establish and
the tracking is very difﬁcult to maintain. The right-hand
side ﬁgure depicts the normalized correlation as a
function of code phase offset after the PLI is removed by
the DRC method. Clearly, the correlation peak can be
acquired and tracked.
In the following, experimental results will be dis-
cussed. Similar to the simulation analyses, two cases will
ARTICLE IN PRESS
GPSAntenna
Model 600
RF- 5600 
downconverter
5620 IF
Digitizer module
Monitor 
Interface
GPIB Interface
Monitor
RS 232 Interface
PXI-1000B
NovAtel DL -4 
Receiver
™
-GPS
PXI-8176
Industrial Computer
Coaxial 
wire
Coaxial
Wire
RS-232 
transmitting line  
(1)
(2)
CWI simulator
PLI simulator
Combiner
Combiner
Fig. 3. Experiment setup.
C.-L. Chang, J.-C. Juang / Signal Processing 90 (2010) 2676–26852680
Author's personal copy
10ms. In the experiment of Case 1, the PJ/N of the PLI is set
as 30dB. Again, the use of the DRC can enhance the
resulting P^=N, so that the GPS signals can be tracked in the
presence of PLI. In Case 2, the effectiveness with DRC
alone and with combined DRC and FDE is also presented
in Table 2. As expected, the use of DRC improves the P^=N
and the joint use of DRC and FDE results in further
improvement.
The acquisition plots for SV#4 in Case 1 without and
with DRC are shown in Figs. 5 and 6, respectively. It is
clear that when the DRC is not used as in Fig. 5, the
satellite signal is difﬁcult to acquire, let alone track. In
contrast, when the DRC is employed, the correlation peak
becomes signiﬁcant in both code and frequency
dimensions, and hence, the signal can be much more
easily acquired and tracked.
Although the DRC has been shown to be effective in
mitigating PLI, in practice, it is necessary to assess its
sensitivity with respect to parameter estimation errors.
Indeed, the success of the DRC relies on the correct
estimation of the amplitude, Doppler frequency, phase
shift, and code delay. When there are estimation and/or
implementation errors, the performance of the resulting
mitigation scheme may be degraded. In the following, the
sensitivity of the mitigation scheme is assessed. Fig. 7
shows the measured narrow-to-wide power ratio as a
function of the power of the reconstructed signal. In the
ﬁgure illustrating the estimated error of Doppler
frequency and code delay as zero, it is afﬁrmed that
when the estimated power of pseudolite-type
interference equals desired power, the measured
narrow-to-wide power ratio of desired signal is
enhanced. The ﬁgure also shows that through the use of
DRC to estimate interference power, the measured power
ratio of each satellite is enhanced by about 5dB when the
estimated error is zero. Similar analyses are conducted to
assess the sensitivity against Doppler frequency and code
delay. Fig. 8 shows the SNR results with respect to
estimation errors in Doppler frequency and code delay,
respectively. Fig. 8(a) demonstrates that the ratio does not
promote when the estimated frequency error exceeds
5Hz. On the contrary, the measured narrow-to-wide
power ratio of each satellite signal promotes by roughly
1.5 dB when the estimated frequency error is below 5Hz.
Fig. 8(b) depicts the effect of estimated error value of code
delay on the measured narrow-to-wide power ratio of
desired signal. The result reveals that the measured
narrow-to-wide power ratio of each satellite signal can
be enhanced to 1.5 dB in maximum when the estimated
error of code delay is below 5 chip. To sum up, the effect
of value with respect to the estimated power error on the
mitigation performance of each satellite signal is higher
than that of estimated Doppler frequency error and
estimated code delay error.
In the mitigation scheme, both FDE and DRC are used
at the same time with the aim to suppress both CWI and
PLI. The adoption of FDE, however, may affect the
performance of DRC. Indeed, when a pseudolite signal is
passed through a FFT/IFFT system, the amplitude and
frequency contents may be slightly varied. Fig. 9 shows
ARTICLE IN PRESS
Fig. 5. Correlation result before PLI removal.
Fig. 6. Correlation result after PLI removal.
Fig. 7. Effective P^=N as a function of pseudolite-type interference power
error.
C.-L. Chang, J.-C. Juang / Signal Processing 90 (2010) 2676–26852682
Author's personal copy
mitigation scheme may be sensitive to certain parameter
estimation errors. This, in turn, establishes the designed
speciﬁcations of the scheme to effectively suppress
undesired pseudolite and continuous-wave interferences.
Acknowledgment
The authors would like to thank the National Science
Council of Taiwan for their support of this work under
NSC 98-2218-E-020-003.
References
[1] D. Klein, B.W. Parkinson, The use of pseudo-satellite for improving
GPS performance, Global Positioning System, vol. III, Institute of
Navigation, 1984, pp. 135–146.
[2] B.D. Elrod, A.J. van Dierendonck, Pseudolites, in: B.W. Parkinson
et al. (Ed.), Global Positioning System: Theory and Applications,
American Institute of Aeronautics and Astronautics, Washington,
DC, 1996, pp. 51–79.
[3] C. Kee, H. Jun, D. Yun, B. Kim, Y. Kim, B.W. Parkinson, T. Langenstein,
S. Pullen, J. Lee, Development of indoor navigation system using
asynchronous pseudolites, in: Proceedings of 13th International
Technical Meeting of the Satellite Division of the US Institute of
Navigation, 2000, pp. 10381045.
[4] J. Wang, T. Tsujii, C. Rizos, L. Dai, M. Moore, GPS and pseudo-
satellites integration for precise positioning, Geomatics Research
Australasia 74 (2001) 103–117.
[5] J. Barnes, C. Rizos, J. Wang, D. Small, G. Voigt, N. Gambale, High
precision indoor and outdoor positioning using LocataNet, Journal
of Global Positioning Systems 2 (2) (2004) 73–82.
[6] J.C. Juang, K.Y. Cheng, C.L. Tseng, C. F. Lo, The design and test of a
dual-frequency GPS pseudo-satellite augmentation system, in:
Proceedings of 11th Saint Petersburg International Conference,
Saint Petersburg, 2004.
[7] J.C. Juang, Seamless handover of combined GPS/pseudolite naviga-
tion, in: Proceedings of ION GNSS-2004, Long Beach, September
2004, pp. 20592065.
[8] Volpe National Transportation Systems Center, Vulnerability as-
sessment of the transportation infrastructure relying on the global
positioning system, US Department of Transportation, 2001.
[9] J.J. Spilker Jr, F.D. Natali, Interference effects and mitigation
techniques, in: B.W. Parkinson et al. (Ed.), Global Positioning
System: Theory and Applications, American Institute of Aeronautics
and Astronautics, Washington, DC, USA, 1996, pp. 717–772.
ARTICLE IN PRESS
Fig. 10. Effective P^=N as a function of pseudolite frequency error without/with CWI mitigation: (a) without CWI mitigation; (b) with CWI mitigation.
Fig. 11. Effective P^=N as a function of pseudolite code delay error without/with CWI mitigation: (a) without CWI mitigation; (b) with CWI mitigation.
C.-L. Chang, J.-C. Juang / Signal Processing 90 (2010) 2676–26852684
Journal of the Chinese Institute of Engineers, Vol. 33, No. 3, pp. 367-378 (2010) 367
USING FUZZY LOGIC CONTROLLER WITH ADAPTIVE
DETECTION SCHEME FOR FAST ACQUISITION OF SATELLITE
NAVIGATION SIGNALS
Chung-Liang Chang
ABSTRACT
The paper presents a fuzzy logic controller (FLC) with adaptive threshold con-
trol scheme to regulate frequency search step size so as to enhance performance in
global navigation satellite system (GNSS) signal acquisition.  Conventional frequency
search can be achieved utilizing step-by-step frequency bin search or through fast
Fourier transform (FFT).  Nevertheless, too large a frequency search step size and
short length of FFT result in large loss of correlation, whereas too small frequency
search step size and long length of FFT increase signal acquisition time.  To shorten
signal acquisition time without influencing the accuracy of signal parameters, the FLC
is employed to regulate the frequency search step size in the frequency domain on the
basis of an input variable: code correlation value and its rate of change.  To enhance
the robustness of signal acquisition performance, the signal detection threshold is
adaptively adjusted and combined with FLC.  Besides, the basis value of membership
function in FLC is adjustable.  Hence, the input and output parameters of membership
functions (MFs) vary with the adjustment of the detection threshold.  Simulations and
experimental results demonstrate that the proposed method enhances acquisition per-
formance with regards to execution time and precision of parameters in GNSS signals.
Key Words: GNSS receivers, synchronization, fuzzy logic.
*Corresponding author. (Tel: 886-8-7703202, ext. 7586; Email:
chungliang@mail.npust.edu.tw)
C. L. Chang is with the Department of Biomechatronics Engineering,
National Pingtung University of Science and Technology, Pingtung
County 91201, Taiwan, R.O.C.
I. INTRODUCTION
There are two major objectives in the signal ac-
quisition of global navigation satellite system (GNSS)
receivers.  The first is to identify each satellite system
and to determine the visible satellites.  The second is
to acquire the coarse value of Doppler shift and code
phase of the satellite signals.  With the accomplish-
ment of these goals, these parameters can serve as the
initial values of signal tracking to proceed with code
tracking and carrier tracking.  Conventional signal
acquisition is conducted based on fixed step size of
frequency according to certain frequency search ranges
and meanwhile the code is searched 1023 times (Braasch
and Van Dierendonck, 1999; Kaplan and Hegarty, 2006).
Because this method is easy for hardware implementa-
tion, it is often utilized in receiver design nowadays.
Nevertheless, traditional signal acquisition methods are
gradually failing to meet the developing demands of
satellite systems, now and in the future (Hein et al.,
2006).  With the flourishing development of software-
defined-radio, signal acquisition on the basis of fast
Fourier transform (FFT) has become prevalent (van
Nee and Coenen, 1991; Lin and Tsui, 2000).  Two FFT
types are presented.  The first is to remove the fre-
quency component within the received signal and then
utilize circular convolution to conduct the estimate of
code phase.  The second type is to remove the code
component and then conduct FFT to find the coarse
Doppler shift.  In the first type, Doppler shift search
can be accomplished utilizing a step-by-step frequency
bin search.  Nevertheless, too large a step size results
in large correlation loss.  In the second type, the accu-
racy of Doppler shift depends on the length of FFT.
C. L. Chang: Using Fuzzy Logic Controller with Adaptive Detection Scheme for Fast Acquisition of GNSS Signals 369
are generated through multiplication with the received
signal at 0° and 90° phase-shifted version of the lo-
cal carrier signal, respectively.  The combination of
zIk and zQk signals forms a complex input signal zk(u)
= zIk + jzQk to the FFT operation.  u is the guessed
value of the Doppler shift.  The generated pseudo ran-
dom noise (PRN) code is transferred to the frequency
domain and the results are complex conjugated, the
product then multiplies the FFT of the input.  The
result of the multiplication is transferred to the time
domain by an inverse FFT (IFFT) operator, which can
be described by
yk(u, v) = |F –1{F(zk(u))F*[c(tk – v)]}|2, (2)
where F, F −1 and ‘*’ denote FFT, IFFT and the com-
plex conjugate operator, respectively.  The acquisi-
tion is to find maximum yk through search on the
2-dimensional grid of trial points u = umin, a1∆u, a2∆u,
..., an∆u..., aN∆u, umax and v = v0, v1, ..., vK –2 , vK – 1 is
the estimated code phase offset.  K is the FFT length
that equals GPS-C/A code one msec period samples.
un = an∆u is the frequency search value, where an is
gain of step size of the nth search.  ∆u is the step size
unit.  The limits umin and umax make up a priori knowl-
edge of the possible range of Doppler shifts.  Note
that if the decision variable z exceeds the threshold T
which is determined by the noise statistics, the deci-
sion logic chooses the corresponding z and the corre-
sponding delay as the estimated code phase.  Thus,
the acquisition algorithm terminates successfully.  It
is expected that code phase error and Doppler shift
error approximately approach zero, which saves time
in signal tracking.  Fig. 1 illustrates the variation of
estimate of Doppler shift with regards to correlation
magnitude with the prerequisite of code phase known.
It can be observed from the figure that the shape is
pretty close to sinc function.  The bulk of the signal
energy is concentrated in the main lobe, the width of
which relies on the duration of the coherent integra-
tion time TP.  As a matter of fact, the main lobe double-
sided width is given by 2/TP Hz.  Though the whole
sensitivity of signal acquisition can be enhanced by
increasing TP, the frequency search times also increase
as a result.  For instance, suppose TP = 1 ms, the main
lobe double side width is 2 KHz.  Within the frequency
search range of ±10 KHz, every 500 Hz is one bin,
which is equal to one-fourth of the main lobe double
side width and there are altogether 41 bins.  Regard-
ing the GPS signal, 41 frequency searches are required.
After finding the coarse Doppler shift, the state of
pull-in starts.  That is, after narrowing frequency range
down to roughly ±1 KHz, the 50 Hz search continues
(altogether 21 search times) until a more accurate
Doppler shift is acquired and then sent to the track-
ing loop.  In this way, redundant search times are
consumed (altogether 62 frequency searches) and the
accuracy maintains at ±50 Hz.  Suppose TP = 4 ms
for Galileo-CBOC signal, more frequency search times
are required.  To solve this problem, FLC is proposed,
which is capable of reducing acquisition times by a
factor of up to 1.6 times.
In addition, to ensure stability of the whole
system, the maximum likelihood method is utilized
to estimate the noise power of correlation so as to
adjust the threshold to maintain a fixed false alarm
rate.  By the adjustment of the threshold, the FLC is
adaptable and applicable to variable environment.
The proposed signal acquisition system is de-
picted as in Fig. 2, which is composed of a set of FLC,
carrier generator, circular correlation operator, and
decision logic.  The following illustrates the opera-
tion of FLC.
2. FLC
The FLC is constituted of a knowledge base that
consists of the information given by the process op-
erator in the characteristic of linguistic control rules.
A more detailed introduction to fuzzy systems can be
1.2
1
0.8
0.6
0.4
0.2
0
M
ag
ni
tu
de
GPS-C/A, B.W. = ∞ Hz
CBOC, B.W. = ∞ HzCorrelation peak
Fixed search step (bin) size
-2/Tp -1/Tp 0
Frequency (Hz)
1/4Tp-1/4Tp 1/Tp 2/Tp
Fig. 1  Effect of correlation attenuation versus Doppler shift
Digital IF
   kγ ZIK
ZQK
Circular cross-correlation
M-point
FFT
M-point
IFFT
PRN/BOC
Code Generator
M-point
FFT
Conj ( )
Carrier
Generator
Fuzzy Logic
Controller (FLC)
Decision Logic
sin(2   (fi + un))π
cos(2   (fi + un))π un
Dn
yk
Dn∆
Threshold T
|    |2
Fig. 2  GNSS signals acquisition procedure
C. L. Chang: Using Fuzzy Logic Controller with Adaptive Detection Scheme for Fast Acquisition of GNSS Signals 371
and Galileo signals are different.  Table 1 shows the
characteristics of the input and output of the MFs of
FLC.
4. Rule Table and Defuzzification Stage
The incremental change in the output variable
an is determined by rules of the form based on the
Mamdani algorithm (Lee, 1990):
if D is GiD and ∆D is Gi∆D, then Π is Giu, (6)
where D, ∆D, and Π are the linguistic variables; GiD,
Gi∆D and Giu are the corresponding linguistic labels
characterized by MFs.  The complete rule table for
computing Π is described in Table 2 which offers the
knowledge of the controller.
It depicts that the absolute gain value of the con-
troller output increases rapidly when the Dn and ∆Dn
become small, thus shortening the signal acquisition
time.  Consider that the Dn is large and ∆Dn is small,
the controller output diminishes rapidly, enhancing
the accuracy of the Doppler shift.  The rule surface is
shown in Fig. 4 with η = 1 and T = 18 dB.
These rules are the kernel of a fuzzy system,
reflecting as expert’s experience in interpreting the
input parameters and determining the output numbers.
Different experts may produce a different collection
of rules; nevertheless, owing to the tolerance of the
fuzzy systems with regards to approximation, the sys-
tems would finally produce similar results, if all the
experts have grasped the major points of interest.  The
controller’s output Π– is mapped into a crisp numeri-
cal value using the COA defuzzification formulated
as follows:
Π = an =
Πpµ(Πp)Σp = 1
q
µ(Πp)Σp = 1
q , (7)
where Πp is the numerical value of the pth output
membership function, q is the number of controller
output sets, and µ(Πp) denotes its membership value
at the pth quantization level.  The search step gain
value an at the nth time step is computed using Eq.
Table 2 Fuzzy rule-base for step size computation
Input Dn
VS S M B VB
NB NB NS ZE PS PB
NS NS ZE PS ZE PS
Input ∆Dn ZE PB PB PS PS ZE
PS PS ZE NS ZE NS
PB PB PS ZE NS NB
Table 1  Characteristics of the input and output of the MFs
Variable Linguistic labels Center γi Standard deviation ρi αi βi
VS − − –0.18T{ 0.6T{
S 0.63T{ 0.07T{
Input Dn M 0.75T
{ 0.02T{
B 0.87T{ 0.07T{
VB − − 0.18T{ 0.95T{
NB − − –1.6 –9
NS −4 1.5
Input ∆Dn ZE 0 0.35
PS 4 1.5
PB − − 1.6 9
NB − − –110/η –35/η
NS –35/η 26/η
Output an ZE 0 10/η
PS 35/η 26/η
PB − − 35/η 110/η
50
0
-50
15
10
5
0
-5
-10
-15 10
15
20
Input Gn
Input    Gn∆
O
ut
pu
t
Fig. 4  Control rule surface
C. L. Chang: Using Fuzzy Logic Controller with Adaptive Detection Scheme for Fast Acquisition of GNSS Signals 373
integration time.  Fig. 5 shows the signal detection
probability as a function of the SINR.  In comparing
the detection performance of with and without (w/o)
adaptive threshold control, the detection performance
of with adaptive outperforms without adaptive by roughly
1.02 dB when increasing M to 80, though with adap-
tive threshold, decreases roughly 0.31 dB in per-
formance as opposed to without adaptive threshold
control when M = 5.
Figure 6 depicts the performance analysis re-
garding execution time of two search methods (FLC
with and without adaptive threshold control) under
the scenario of various input SINR.  It is shown from
the figure that the two methods can successfully ac-
quire signals under various SINR cases.
2. Example 2
In this example, the method is applied to the
Galileo-CBOC signal acquisition process with the
analyzed performance.  The simulated model is pre-
sented from the E1-B channel (Galileo OS SIS ICD,
2008), which is used to generate Galileo E1-B chan-
nel and the type of modulation is CBOC.  The length
of the available data record is 40 ms, and the code
period of CBOC is 4 ms.  The initial detection thresh-
old is 22 dB and parameter η is set to 4 in the output
of MFs.  Fig. 7 illustrates the detection performance
with and without adaptive threshold control.  The deg-
radation in detection performance in between adap-
tive and without adaptive threshold selection is due
1
0.9
0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1
Pr
ob
ab
ili
ty
 o
f s
ig
na
l d
et
ec
tio
n
-15 -10 -5 0 5 10
Input SINR (dB)
FLC w/o adaptive threshold
control (TP = 1 ms)
FLC with adaptive threshold
control (TP = 1 ms; M = 5)
FLC with adaptive threshold
control (TP = 1 ms; M = 80)
Fig. 5 Probability of signal detection versus SINR (Example 1)
(TP = 1 ms, Pfa = 0.1%)
FLC w/o adaptive threshold
FLC with adaptive threshold
Without FLC (pull-In Included)
25
20
15
10
5
0
Ex
ec
u
tio
n 
tim
e 
(se
c)
-20 -15 -10 -5 0 5 10 15
SINR (dB)
Fig. 6  Execution time versus SINR (GPS-C/A)
1
0.9
0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1
To
ta
l p
ro
ba
bi
lit
y 
of
 d
et
ec
tio
n
-15 -10 -5
Input SINR (dB)
0 5 10
FLC w/o adaptive threshold
control method (TP = 4 ms)
FLC with adaptive threshold
control method 
(TP = 4 ms, M = 20)
FLC with adaptive threshold
control method 
(TP = 4 ms, M = 320)
50
45
40
35
30
25
20
15
10
5
Ex
ec
u
tio
n 
tim
e 
(se
c)
-20 -15 -10 -5
SINR (dB)
0 5 10 15
FLC w/o adaptive threshold
FLC with adaptive threshold
Without FLC (pull-in included)
Fig. 7 Probability of signal detection versus SINR (Example 2)
(TP = 4 ms, Pfa = 0.1%)
Fig. 8 Execution time versus SINR (Galileo E1-B channel no.
10 code)
C. L. Chang: Using Fuzzy Logic Controller with Adaptive Detection Scheme for Fast Acquisition of GNSS Signals 375
repetitions for each satellite is between 31 and 39.
In addition, Chang’s method from 2008 is also adopted
to conduct signal acquisition and number of frequency
search repetitions for each satellite is between 29 and
40.  However, this method can neither successfully
acquire weak PRN 20 signal in GPS nor GIOVE-A
signals in Galileo.
Figure 10 depicts the search for Doppler shift
by way of FLC with adaptive threshold control
method.  33 searches are required and the maximum
correlation value is 6.381 × 106.  The total execution
time of the fixed step size method along with the sub-
sequent procedure of pull-in takes 6.31 second, which
is longer than that of the proposed method by approxi-
mately 3.14 second.
Figure 11 depicts the search for Doppler shift
with the proposed method, 80 searches are needed and
the maximum correlation value is 15.9881 × 106.  Fig.
12 and Fig. 13 illustrate the experimental results of
signals acquisition from different methods for PRN
16 (see Fig. 12) and GIOVE-A (see Fig. 13) signals,
respectively.  The acquisition of GPS-C/A (PRN16)
and GIOVE-A signals using different acquisition
methods is also shown in Table 5.  The proposed
method estimates the Doppler shift of PRN 16 as
1.140 KHz, which is more accurate than the other
methods.  The code phase, however, is also more ac-
curate compared with the serial search as well as the
parallel frequency search method because it offers a
correlation value for each sampled code phase.  As
for GIOVE-A signal acquisition, on the other hand,
the proposed method has the same performance.
Nevertheless, because the code duration of GIOVE-
A signal is 4ms, the execution time is longer than for
GPS signal.
V. CONCLUSIONS
This paper has developed an FLC method with
adaptive threshold control for the fast acquisition of
GNSS signals.  This method modifies and refines the
previously proposed method to possess more robust
performance in signal acquisition.  Simulation results
show that the proposed method regarding GPS signal
Table 4  Experiment result of GNSS acquisition with proposed method.
PRN Frequency search repetitions Doppler shift (Hz) Code phase (in samples)
1 31 (29) 520 (525) 12236 (12234)
6 32 (33) 3520 (3520) 16013 (16013)
7 38 (40) 2885 (2885) 11313 (11313)
14 36 (34) 3410 (3415) 5147 (5145)
16 32 (32) 1140 (1140) 1812 (1812)
20 35 (Lose lock) 1015 (lose lock) 5894 (Lose lock)
31 35 (36) 1890 (1890) 2010 (2010)
GIOVE-A 80 (none) 1530 (none) 66475 (none)
Those in brackets are the results from Chang’s 2008 paper.
× 106
8
7
6
5
4
3
2
1
0
Co
rre
la
tio
n 
m
ag
ni
tu
de
5 10 15 20 25 30
Frequency search index n
Correlation peak
(Without proposed method)
Correlation
loss
Correlation peak
GPS-C/A PR/N16; FLC with adaptive
threshold control method (Resolution: 1 Hz)
× 107
2
1.8
1.6
1.4
1.2
1
0.8
0.6
0.4
0.2
0
Co
rre
la
tio
n 
m
ag
ni
tu
de
0 10 20 30 40 50 60 70 80
Frequency search index n
Correlation peak
(Without proposed method)
Correlation loss
Correlation peak
GIOVE-A; FLC with adaptive
threshold control method (Resolution: 1 Hz)
Fig. 10 Experimental result of frequency search for GPS-C/A
PRN16 (code phase: 1812 samples); FLC with adaptive
threshold control method (Resolution: 1 Hz)
Fig. 11 Experimental result of frequency search for GIOVE-A
signal.  (code phase: 66475 samples); FLC with adaptive
threshold control method (Resolution: 1 Hz)
C. L. Chang: Using Fuzzy Logic Controller with Adaptive Detection Scheme for Fast Acquisition of GNSS Signals 377
acquisition reduces acquisition time by a factor of
2.5 and the average estimate error of parameter is
within 3Hz.  Besides, with respect to Galileo-CBOC,
the proposed method saves almost half the times of
time and the average estimate error of parameter is
within 14 Hz.  The proposed method can estimate
Doppler shift rapidly and more accurately without the
procedure of pull-in, which is capable of reducing
signal tracking time.  Furthermore, the maximum like-
lihood method is used to estimate noise power and
adjust detection threshold.  It does enhance detection
probability and reduce false alarm in simulation
results.
This method also has been verified using real
data from the GNSS software development board.
The experimental results demonstrate that the method
is capable of faster acquisition and satisfies real-time
processing, which makes it a useful core for future
GNSS receivers in real-time applications.  In the
future, the generalization of the proposed method will
be addressed to assess the effect of interference miti-
gation in positioning and attitude determination
(Huang and Tsai, 2007).
NOMENCLATURE
Ai ith fuzzy set
an gain of step size of the nth search
c~l(.) filtered spreading code
cl(.) unfiltered spreading waveform
Dn signal acquisition margin
dmax, λ, αi, βi sigmoid membership functions pa-
rameter
E[.] the expectation operator
F fast Fourier transform operator
F –1 inverse fast Fourier transform opera-
tor
F* complex conjugate operator for FFT
fl intermediate frequency
GiD, Gi∆D, Giu the corresponding linguistic labels
K fast Fourier transfor length
k discrete index
L number of satellites
M number of the accumulated noise
samples
N0 single sideband power spectrum den-
sity of noise
O(.) computation load operator
Pfa probability of false alarm rate
Pl reception power of lth satellite sig-
nal
Pj reception power of jth satellite signal
q the number of controller output sets
rk the baseband signal
sd desired signal
sJ interference (co-channel interference
and noise term)
T detection threshold
T{ estimated threshold
TP coherent integration time
tk sampling time
u guessed value of the Doppler shift
umin minimum bound of Doppler shifts
search range
umax maximum bound of Doppler shifts
search range
w white Gaussian noise term
yk the acquisition value
z decision variable
zIk in-phase baseband signal
zQk Quadrature baseband signal
zk complex baseband signal
∆u step size unit
∆Dn increase/decrease gain value of Dn
τl propagation code phase
δl, f Doppler shift
Table 5 Performance comparison of experimental results of four acquisition methods with regard to
GPS-C/A (PRN 16) code and GIOVE-A signal
Signal Type GPS-C/A PRN 16 Galileo E1-B channel (GIOVE-A)
Acquisition Serial Parallel Parallel Proposed Serial Parallel Parallel Proposed
method frequency code method frequency code method
Execution
1120.57 16.62 2.67 2.31 16950.69 147.58 18.78 18.11Time (sec)
Repetitions
41 41 32 100 100 80
(W/o pull in) (500 Hz 1023 (500 Hz (10~1K Hz (200 Hz 4092 (200 Hz (10~300 Hz
unit step) unit step) unit step) unit step) unit step) unit step)
Doppler
1.0 KHz 1 KHz 1.0 KHz 1.140 KHz 1.5 KHz 2 KHz 1.6 KHz 1.530 KHz
shift
Code phase 94 94 1832 1812 3400 3400 66476 66475
chip chip samples samples chip chip samples samples
Hindawi Publishing Corporation
EURASIP Journal on Advances in Signal Processing
Volume 2010, Article ID 123625, 13 pages
doi:10.1155/2010/123625
Research Article
Self-Tuning Synthesis Filter against Mutual Coupling and
Interferences for GNSS and Its Implementation on
Embedded Board
Chung-Liang Chang
Department of Biomechatronics Engineering, National Pingtung University of Science and Technology, Pingtung 91201, Taiwan
Correspondence should be addressed to Chung-Liang Chang, chungliang@mail.npust.edu.tw
Received 10 January 2010; Revised 2 May 2010; Accepted 9 June 2010
Academic Editor: George Tombras
Copyright © 2010 Chung-Liang Chang. This is an open access article distributed under the Creative Commons Attribution
License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly
cited.
Traditional spatial-temporal adaptive signal processing techniques are often applied to conduct narrowband and wideband
interferences. However, its mitigation performance degrades greatly due to mutual coupling. To solve this problem, this paper
aims to utilize a spatial-temporal self-tuning synthesis filter capable of mutual coupling compensation and interference mitigation.
The spatial filter and temporal filter are to compensate for the eﬀect of mutual coupling and interference mitigation, respectively.
Self-tuning mechanism is to adopt least square (LS) and minimum variable distortionless response- (MVDR-) based method
to adjust spatial and temporal weights of antenna array. The experiment platform is established by the embedded development
board. Simulation and experiment results demonstrate that the proposed method can eﬀectively compensate for mutual coupling,
mitigate the cochannel interference up to 30 dB, and enhance the acquisition performance of receivers in global navigation satellite
system (GNSS).
1. Introduction
Satellites of global positioning system (GPS) operate on the
orbit 20200 kilometers high and the power of carrier for L1
band upon the ground is about −130 dBm. In general, the
power of thermal noise can reach−110 dBm. It indicates that
the power of GPS signal is lower than that of thermal noise.
Luckily, GPS adopts spread spectrum technique to acquire
suﬃcient gain for reception end to reconstruct signals.
However, if GPS is susceptible to unintentional or intentional
interference (jammer), it results in the diﬃculty in reception
and lock of GPS signals due to over strong magnitude of
interference, too wide bandwidth, and similarity in type of
modulation.
Typical interference mitigation techniques consist of
three types. The first is defined as antenna array model,
which utilizes multiple antennas to conduct the estimation
of interference direction and adjust the gain and phase of
antenna sets to null out interferences. The second is termed
precorrelation processing, which transfers high-frequency
to intermediate-frequency (IF) analog or digital signal and
then conducts signal processing regarding amplitude, time
domain, or frequency domain to decrease the impact of
interference [1, 2]. The last is called postcorrelation pro-
cessing, which adopts software-defined radio to integrate
GPS with other assisted navigation devices to enhance the
precision in navigation positioning. With regards to the
eﬀect of interference mitigation, antenna array model is
most eﬃcient. The precorrelation processing technique is
medium in eﬀect and cost, but the reception circuit has
to be redesigned. The third technique is limited in eﬀect
though it can employ available receivers in global navigation
satellite system (GNSS) and additional inertial navigation
components to aid positioning.
In a word, in terms of interference mitigation, the imme-
diate removal or mitigation of interferences upon the radio
frequency (RF) front-end of receiver yields a better result
than that upon rear-end of the receiver. Due to the specific
of geometric relations among each antenna component,
associated phase relation exists among received signals. The
use of spatial signal processing techniques can determine the
direction of interference source, and the adoption of adaptive
EURASIP Journal on Advances in Signal Processing 3
where x(k) = [xa(k) xb (k)]Hdepicts the incoming signal
samples on the taps of spatial-temporal filter. [·]H denotes
the Hermitian transpose operator. xa(k) = [xa1(k) · · ·
xaN (k)] and xb(k) = [xb1(k) xb2(k) · · · xbM(k)] are
the spatial and temporal signal
snapshots, respectively. xbm(k) = [x1m(k)
· · · xNm(k)] and s(k) = [s1(k)s2(k) · · · sM+1(k)]H
are both desired signals and essential modulated spread
codes subject to data modulation, time delay, Doppler
shift, and phase variation that uncorrelated with the
channel noise vector. Ps and Pj are the power of desired
signal and jth interference, respectively. i j(k) has the same
structure as s(k) , and J is the total number of interferences.
Each interference can be modeled as narrowband or
wideband signal. C(k) is zero-mean, temporally and spatially
white noise with variance σ2I. A = I(M+1)×(M+1) ⊗ aθs,φs
and B j = I(M+1)×(M+1) ⊗ aθj ,φj , where ⊗ denotes the
Kronecker product. aθs,φs = [ as1(k) as2(k) · · · asN (k)]H
and aθj ,φj = [a j1(k) a j2(k) · · · a jN (k)]H denote the N × 1
steering vector with respect to desired satellite and jth
interference source, respectively.
The array vector model depicted by (1) is valid only for
ideal arrays. For practical arrays, the simultaneous presence
of more than one sensor as well as objects adjacent to the
array accounts for the noted mutual coupling eﬀect. In a
more realistic scenario, the signal received by one sensor
can be expressed as a linear combination of the wave fields
incidents onto all the sensors rather than associated with the
wave field incident on that sensor only. To take the coupling
eﬀect into consideration, the array signal model in (1) has to
be modified by incorporating a matrix term called coupling
matrix. Therefore, the A and B j in the presence of mutual
coupling can be written as
A = I(M+1)×(M+1) ⊗Maθs,φs ,
B j = I(M+1)×(M+1) ⊗Maθj ,φj ,
(2)
where M is an N × N matrix that demonstrates the mutual
coupling eﬀect, introduces the distortion of amplitudes and
phases in elements of steering matrix, and depicts how the
individual antenna elements are coupled with one another.
Nevertheless, mutual coupling coeﬃcients between two far
apart elements can be approximated to zero. Thus, it is
adequate to consider the coupling model with just a few
nonzero coeﬃcients. The mutual coupling matrix (MCM)
can be given as follows:
[M]pq =
⎧⎪⎪⎪⎪⎨
⎪⎪⎪⎪⎩
δ,
∣∣p − q∣∣ = 1,
1, p = q,
0, other,
(3)
where [·]pq indicates the coupling contribution of the qth
antenna to pth antenna and δ is the intensity of the received
power of its immediate neighbors.
Thus, the array signal vector in the presence of mutual
coupling can be rewritten as
x˜(k) =
√
PsAs(k) +
J∑
j=1
√
PjB j i j(k) + C(k), (4)
where x˜ = [x˜a(k) x˜b(k)]H is the same structure as (1).
Finally, it is possible to write the spatial covariance matrix of
the array signal vector in the absence and presence of mutual
coupling as
R11  E
{
xH1 (k)x1(k)
}
,
R˜11  E
{
x˜H1 (k)x˜1(k)
}
,
(5)
where x˜m(k) = [x˜1m(k) · · · x˜Nm(k)] and E{·} denote
the expectation operator. Similarly, the temporal covariance
matrix of the array signal vector in the absence and presence
of mutual coupling is shown as follows:
Rbb  E
{
xHb (k)xb(k)
}
,
R˜bb  E
{
x˜Hb (k)x˜b(k)
}
.
(6)
2.2. Mutual Coupling Compensation and Interferences Mitiga-
tion. The rules in the design of adaptive antenna algorithm
can be applied in spatial and temporal domain. The structure
of an adaptive antenna is adapted through spatial filters
whose complex weights combine the signal from each
antenna element. Each antenna element is processed with
its own temporal filter, the outputs of which are joined
together to yield a single output signal. The weights are
selected to eﬀectively null out interference while intentionally
retaining the desired signal. The adaptive nulling of the
antenna array is demonstrated by the capability to steer
several nulls (minimum of the radiation pattern) to the
interferences while keeping a maximum of the radiation
pattern toward the desired signal. However, the above
process of adaptive array algorithm is undertaken without
considering mutual coupling eﬀect. To evaluate the eﬀect
of mutual coupling and compensate for its influence, an
adaptive spatial filter with LS method is utilized to make up
for mutual coupling eﬀect and a temporal filter with QR-
based MVDR beamformer is adopted to mitigate wideband
and narrowband interferences.
2.2.1. Mutual Coupling Compensation. It is shown from (2)
that when MCM is known, mutual coupling eﬀect can be
easily nulled out by premultiplying the input steering vector
aθ,φ by the inverse of MCM (assuming that it is invertible).
Assume that the weight vector wa is susceptible to mutual
coupling; the estimated one is expressed by
w˜a = Mwa + e, (7)
where e denotes the measurement error. The mutual cou-
pling M can be calculated by employing LS method as a
solution for the following optimization problem:
M˜ = argmin
M
∥∥w˜a −Mwa
∥∥2
2, (8)
EURASIP Journal on Advances in Signal Processing 5
(1) can be decomposed into three components: signal zs(k),
interference zr(k), and noise zv(k):
xn(k) = zs(k) + zr(k) + zv(k). (14)
Similarly, the vector y(k) in (12) consists of three com-
ponents: desired signal ys(k), interference yr(k), and noise
yv(k) after the linear combination operation (12):
y(k) = ys(k) + yr(k) + yv(k). (15)
The input signal-to-interference plus noise ratio (SINR) is
considered as the ratio (in dB) between the desired signal and
other components, or
SINRin = 10 log10
⎛
⎝ ‖zs‖2
E
{
‖zr‖2 + ‖zv‖2
}
⎞
⎠. (16)
The input interference-to-signal ratio (ISR) is defined as
ISR = 10 log10
(
‖zr‖2
‖zs‖2
)
. (17)
Use the superposition principle, and the SINR at the
beamformer output can be evaluated as
SINRout = 10 log10
⎛
⎝
∥∥wHzs
∥∥2
E
{
‖wHzr‖2 + ‖wHzv‖2
}
⎞
⎠. (18)
From (16) and (18), the improvement in SINR provided by
the beamformer can be defined as
SINRimp = SINRout − SINRin. (19)
This quality measure assesses the potential of the proposed
algorithm to eliminate the power of interference in the
incoming signal and meanwhile maintain the desired signal
power. Besides SINR improvement factor, the signal acqui-
sition margin (SAM) is utilized to determine the signal
acquisition threshold [3]. It is a measure of the signal and
noise peak values after correlation. Assume that As is the
peak value of the GPS signal in the acquisition diagram after
correlation and Av is the peak value in correspondence to
interference and noise. The SAM is defined as
SAM = 10 log10
(
As
E{Av}
)
. (20)
Thus, a high SAM indicates a successful rate in signal
acquisition.
3. Numerical Examples
In this section, computer simulations are made to evaluate
the performance of the proposed methods. The performance
of proposed method and typical adaptive array technique
[8, 16] is compared and evaluated. Three cases of simulations
are presented for a 2× 2 and 3× 3 uniform rectangular array
(URA). In the first scenario, the rectangular array operating
in nominal mode is demonstrated. The second depicts
a scenario where the interference is present and mutual
coupling is absent. The third indicates the array processing
under the condition of mutual coupling and interference.
The antenna locations (in meters) in half-wavelength (λ/2)
spacing with the array operate at IF 4.092MHz. Each antenna
has 5 taps delay and the direction of the desired signal is
known a priori. Let the desired signal-to-noise ratio (SNR)
in all simulations be −20 dB. The intensity of the received
power of its immediate neighbors δ is between 0.1 and 0.5.
The number of antenna elementsN is associated with the
number of broadband interferences that can be cancelled by
the spatial-temporal beamforming algorithm. In general, the
number of broadband interferences that can be eliminated
by the spatial-temporal filtering corresponds to N−1. Three
scenarios with the main parameters illustrated in Table 1 are
simulated. One desired signal at broadside (θ = 40◦, φ =
120◦) and two directional broadband interference sources at
[(θ = 40◦, φ = 15◦), (θ = 40◦, φ = 170◦) ] are generated
in the simulations where the desired signal and each of
the interference signals are uncorrelated. 100 Monte Carlo
simulations are conducted and the length of the available
data record is 40ms.
Figure 1(a) illustrates the use of URA (2× 2) array struc-
ture under ISR as 50 dB and shows the result of gain pattern
with/without the proposed algorithm. The gain pattern can
be illustrated when the spatial-temporal weight of proposed
method satisfies (13). The figure demonstrates that under
the eﬀect of mutual coupling, the interference cannot be
fully mitigated due to the decrease of gain in the DoA of
desired signal and wrong direction of interference mitiga-
tion. Through mutual coupling compensation, the gain of
interference direction can be eﬀectively mitigated and the
error between desired direction and simulated direction is
eliminated. On the other hand, the gain of desired direction
is enhanced. Figure 1(b) shows similar results in the use of
URA (3×3) array structure, but only diﬀerent in the increase
of space freedom regarding interference mitig- ation in
comparison with simulation results of URA (2×2) structure.
Figure 1 demonstrates that Sarkar’s method canmaintain the
direction gain of desired signal under mutual coupling eﬀect.
On the contrary, the mitigation of direction gain regarding
interference signal is not eﬀective. Figure 2 describes the plot
of SINR normalized to an asymptotic solution versus num-
ber of samples for 3×3 URA. In these arrays, the estimates of
the improvement in SINR are assessed as a function of the
ISR and plotted in Figure 3. The figure illustrates that the
more the increase of ISR, the more the improvement of SINR
after decoupling and interference mitigation. This is more
obvious under 3 × 3 URA structure. The conjugate gradient
method is demonstrated in literature review [8].
4. Test Hardware and Experiment Results
This session depicts how embedded system is implemented
in proposed method with regards to mutual coupling
compensation and interference mitigation and meanwhile
presents how to construct an embedded system as a platform
combination antenna array modules to receive GPS signal.
EURASIP Journal on Advances in Signal Processing 7
0 20 40 60 80 100
−40
−30
−20
−10
0
Snapshots
N
or
m
al
is
ed
SI
N
R
(d
B
)
Without couple eﬀect
Coupled array (δ = 0.5)
Coupled array (δ = 0.2)
Adaptive array (Karsar's method)
Decoupled array
Figure 2: Normalized SINR in the array output before and after
decoupling (URA 3× 3).
Table 4: C/No results with/without proposed method.
PRN
Without proposed algorithm With
proposed
algorithm
A1 A2 A3 A4
C/No (dB-Hz)
4 38.41 38.30 36.62 38.31 38.81
8 37.22 34.17 35.44 36.45 38.46
11 32.24 35.34 34.71 32.75 39.05
17 — — 33.43 — 36.87
20 36.28 37.14 36.64 35.75 38.52
25 32.76 36.82 37.70 38.11 39.30
27 — 35.22 — 35.23 39.56
28 36.80 36.49 — — 37.67
19 36.88 37.31 — 34.11 38.26
embedded system to provide acquisition and tracking for
satellite positioning. The function of each component in the
system structure is demonstrated as follows.
4.1.1. GPS Antenna. The experiment adopts four MK-76
GPS antennas [17], with each antenna gain as 26 dB and
noise figure as 2.0 dB.
4.1.2. RF Front-End. The RF front-end module consists of
RF front-end IC produced by merged Nemerix Inc., RF
low noise amplifier (LNA), mixer and 2-bit ADC module.
The ADC output is “SIGN” and “MAG” bit data output
which has to be transferred in order to correspond to
suitable voltage level in embedded development board.
The corresponding relation is illustrated in Table 2. The
experiment requires at least four RF front-end modules with
the sampling frequency as 16.368MHz and digital IF as
4.092MHz.
4.1.3. Digital Signal Processing Development Kit (DSP
DEVKIT-2S60). The DSP Development Kit, Stratix II
Edition, oﬀers engineers with a complete system-on-a-
programmable-chip (SoPC) solution. The kit is developed
and designed by Altera company, which adopts high-
performance FPGA DSP application and structured applica-
tion specific integrated circuit (ASIC) platform. The com-
plete Altera DSP Development Kit includes DSP develop-
ment board and Quartus II 6.0, SoPC Builder 6.0, and NiosII
6.0 in software. The major components in development
board consist of Nios II core processor, on-chip memory,
serial peripheral interface (SPI), universal asynchronous
receiver/transmitter (UART), direct memory access (DMA)
controller, parallel input/output (I/O) interface, avalon bus,
and Timer, which are integrated in an Altera’s Stratix II FPGA
device.
The Stratix II EP2S60 DSP development board is used in
this paper and this board provides a hardware platform that
designers can utilize to start developing DSP systems accord-
ing to Stratix II devices. Combined with DSP intellectual
property (IP) from Altera and Altera megafunction partners
program (AMPPSM) partners, users can quickly develop
powerful DSP systems. The development board includes
some memories and hardware transmission interface, such
as 32MB synchronous dynamic random access memory
(SDRAM) and 1MB static random access memory (SRAM),
joint test action group (JTAG), and RS232, which employs
SoPC Builder to configure the system on a chip and also
generates the Avalon switch fabric to connect all ports. More
detailed information can be found in [18].
4.2. Experiment System Establishment. With respect to
embedded system, the inbuilt Megafunction in Quartus
II [19] is employed to design spatial-temporal structure
and the inbuilt design tool SoPC builder in Quartus II is
adopted to construct Nios II CPU [20] for communication
with peripheral interface. The self-tuning synthesis filter
algorithm adopts C-language to write and implement in Nios
II integrated device electronics (IDE) [21]. The proposed
algorithm is to adjust weight, estimate mutual coupling
matrix, and have the value sent to the designed spatial-
temporal structure in Quartus II to allow mutual coupling
compensation towards GPS signal and mitigation towards
noise, interference.
The following context will describe how to apply
embedded development board to implement the proposed
algorithm and conduct signal acquisition analysis of the
processed signal using Matlab software.
Step 1. Four RF front-end modules are connected to four
antennas, respectively, on experiment platform. Then, the
self-designed circuit interface board is inserted to I/O inter-
face of embedded development board. Then, the Quartus
II software is utilized to construct transmission interface
EURASIP Journal on Advances in Signal Processing 9
Spatial-temporal
Synthesis filter output
Real weight
Image weight
GPS signal 5-tap
Antenna 1
Antenna 2
Antenna 3
Antenna 4
Figure 5: Self-tuning synthesis filter structure.
Interface to user logic
Quartus schematic file
Port setup
Figure 6: SoPC builder interface.
EURASIP Journal on Advances in Signal Processing 11
Figure 9: The waveforms of hardware output.
Desired
signal
PRN 11
Jammer
PRN 11
Code phase = 423.1875
1
0.5
0
5
0
−5 0
500
1000
Doppler shift = 4000Hz
(a)
Desired
signal
PRN 11
Jammer
PRN 11
Code phase = 423.1875
1
0.5
0
5
0
−5 0
500
1000
Doppler shift = 4000Hz
(b)
Desired
signal
PRN 11
Jammer
PRN 11
1
0.5
0
5
0
−5 0
500
1000
Code phase = 423.125 Doppler shift = 4000Hz
(c)
Desired
signal
PRN 11
Jammer
PRN 11
Code phase = 423.1875
1
0.5
0
5
0
−5 0
500
1000
Doppler shift = 4000Hz
(d)
Figure 10: Acquisition result for antenna 1 (a), antenna 2 (b), antenna 3 (c), and antenna 4 (d).
EURASIP Journal on Advances in Signal Processing 13
[5] S.-J. Kim and R. A. Iltis, “STAP for GPS receiver synchroniza-
tion,” IEEE Transactions on Aerospace and Electronic Systems,
vol. 40, no. 1, pp. 132–144, 2004.
[6] B. Allen and M. Ghavami, Adaptive Array Systems: Fundamen-
tals and Applications, John Wiley and Sons, New York, NY,
USA, 2005.
[7] C.-L. Chang and J.-C. Juang, “Eﬀect of array configurations
on the performance of GNSS interference suppression,”
International Journal of Control, Automation and Systems, vol.
6, no. 6, pp. 884–893, 2008.
[8] T. K. Sarkar and N. Sangruji, “Adaptive nulling system
for a narrow-band signal with a look-direction constraint
utilizing the conjugate gradient method,” IEEE Transactions on
Antennas and Propagation, vol. 37, no. 7, pp. 940–944, 1989.
[9] I. J. Gupta and A. A. Ksienski, “Eﬀect of mutual coupling
on performance of adaptive arrays,” IEEE Transactions on
Antennas and Propagation, vol. 32, no. 5, pp. 785–791, 1983.
[10] E. M. Friel and K. M. Pasala, “Eﬀects of mutual coupling on
the performance of STAP antenna arrays,” IEEE Transactions
on Aerospace and Electronic Systems, vol. 36, no. 2, pp. 518–
527, 2000.
[11] T. Svantesson, “Modeling and estimation of mutual coupling
in a uniform linear array of dipoles,” in Proceedings of the
IEEE International Conference on Acoustics, Speech, and Signal
Processing (ICASSP ’99), pp. 2961–2964, Phoenix, Ariz, USA,
March 1999.
[12] H. Steyskal and J. S. Herd, “Mutual coupling compensation
in small array antennas,” IEEE Transactions on Antennas and
Propagation, vol. 38, no. 12, pp. 1971–1975, 1990.
[13] F. Sellone and A. Serra, “A novel online mutual coupling
compensation algorithm for uniform and linear arrays,” IEEE
Transactions on Signal Processing, vol. 55, no. 2, pp. 560–573,
2007.
[14] Z. Huang, C. A. Balanis, and C. R. Birtcher, “Mutual coupling
compensation in UCAs: Simulations and experiment,” IEEE
Transactions on Antennas and Propagation, vol. 54, no. 11, pp.
3082–3086, 2006.
[15] C. L. Chang and J. C. Juang, “A new pre-processing approach
against array uncertainty for GNSS,” in Proceedings of the
IEEE/ION PLANS, pp. 892–897, Monterey, Calif, USA, May
2008.
[16] R. S. Adve and T. K. Sarkar, “Compensation for the eﬀects of
mutual coupling on direct data domain adaptive algorithms,”
IEEE Transactions on Antennas and Propagation, vol. 48, no. 1,
pp. 86–94, 2000.
[17] Sanav. San Jose Technology, Inc., http://www.sanav.com/.
[18] Altera Corporation, “Nios development board Stratix II
edition ref. manual,” 2006.
[19] Altera Corporation, “Quartus II development software ver.
5.1,” 2004.
[20] Altera Corporation, Nios II Processor Reference’s Handbook,
2004.
[21] Altera Corporation, Nios II Software Developer’s Handbook,
2004.
[22] Navigation Center, http://www.navcen.uscg.gov/?pageName=
gpsAlmanacs.
摘要 
本報告為說明張仲良博士赴美國加州聖地牙哥參與 2010 ION International 
Technical Meeting (ION ITM)的情形。會議時間為 2010 年 1 月 25 日至 27 日。本會議每一
年舉行一次，為國際導航協會(ION)所舉辦，為國際少數大型導航工業會議。會中並邀請
GNSS 工業大廠主任研究工程師主講關於未來室內定位相關技術、駕駛輔助技術以及未
來導航技術的發展，另外也將在研討會中頒發 2009 年 ION 年度榮譽獎。在會場更有廠
商參與展覽，主要展示目前最新導航產品、相關軍事應用、量測工具以及無線通訊產品。
本人在此會議第二天議程中口頭報告論文「Self-Tuning Synthesis Filter for GNSS Antenna 
Array with Mutual Coupling and Interference」，並且從其他研究者的報告中獲得新的想法與
觀念。 
 4
ㄧ、過程 
【出發】 
1 月 21 日中午搭乘台北飛往飛往美國洛杉磯的班機，約 10 小時 25 分後抵達，當地時
間與台灣時間相差約 16 小時，抵達時為當地時間 21 日中午 11 點 25 分左右，之後下榻
當地旅館休息調整時差。 
22 日至 24 日在當地參觀南加州大學與相關景點，認識美國當地人文及地理環境，24
日即開車前往聖地牙哥，之後隨即翻閱大會議程，為明天會議專題討論及國際大師演講
預做準備。 
 
【1 月 25 日】 
一大清早隨即至雙體船渡假飯店(The Catamaran Hotel)會議廳前往辦理報到手續，領
回大會配戴證及相關資料，在九時大會正式開始，首先邀請主席說明此次會議進行程序
及感謝各地來的學者熱情參予，接下來進行一連串的演講，由 Dr. Frank van Diggelen 演
說 “Are We There Yet? The State of the GNSS Market and Technology”，該學者說明目前全
球衛星導航的市場產值與相關技術發展，由於未來的導航系統將朝向整合各個國家所發
展的衛星系統，由於這各層面涉及相關政治因素及國家機密，如能有進一步的合作發展
空間，將會對整個導航經濟注入一股強心針，而對於無法利用 GNSS 來進行導航的場所，
目前也積極開發出不同的無線測距技術與 GNSS 本身相結合來進行定位，但許多大廠急
迫需要更優良的技術，能在不依賴其他輔助裝置前提下，也能夠於室內場所或其他接收
訊號較為微弱的地方進行定位。接下來的演講者 Dr. Craig Shankwitz 演說“Driver Assist 
System for Narrow Bus-only Shoulders”，主要利用一駕駛輔助系統應用於較狹隘的路肩公
車專用車道，以往的駕駛輔助技術皆利用導航裝置來進行車輛定位，在這一場演講中，
研究員利用不同的感測元件及影像感測器來整合 GNSS，來達到較為精準的定位控制。
Dr. Binghao Li所演說“Positioning in Environments Where GPS Fails”，也是類似的概念，
利用無線射頻及通訊技術來達到定位的目的。 
下午場次介紹關於慣性導航、航空應用、載波相位定位以及現代化的導航技術，傍晚
隨即至當地附近餐廳享用當地美食，晚上氣候稍涼，即在飯店內準備明日的口頭報告。 
 
 6
【1 月 27 日】 
今天早上選擇 Session A4: Urban & Navigation Technology I，內容主要報告關於室內定
位以及都市內定位的問題及相關技術，其利用慣性導航裝置以及電子羅盤並結合 GPS 來
進行室內、地下室及城市內的追蹤及定位，此種方式因小型且系統獨立，價格又低廉，
是目前導航產品中最常見到的。另外學者也利用射頻裝置進行 3D 定位系統測試，其利用
多載波訊號融合技術(multicarrier signal fusion algorithm)以及多組天線架設於消防車上階
梯，以便快速移動並在進行救災時安全進入建築物進行滅火工作。下午隨即前往會場聆
聽關於 GPS 訊號處理演算法則及訊號模擬軟體及測試方面的相關知識還有一些定位法則
演算及模擬。並利用休息時間索取一些 GPS 大廠商(NovAtel、SiRF 等)的產品宣傳單以
及美國軍方相關技術展示。 
 
 
【1 月 28 日】 
結束三天的議程，之後開車返回洛杉磯，並在當日晚上 11 點 25 分搭乘華航班機從洛
杉磯飛往台灣，抵達台灣已是當地時間 30 日早上 6 點 30 分，結束此次行程。 
 
二、心得 
從這三天會議的內容來看，目前的導航技術發展已經面臨一項挑戰，即各國開始有能
力獨立開發屬於自己的一套衛星系統，以往所專屬的 GPS 爾後已不再是全球獨步，未來
將朝向導航系統整合，但有礙於各國的政治考量與軍事安全，要各國達成一定共識需有
賴各方更進一步的協商與談判，而目前最具潛力的歐盟伽利略衛星系統目前的進度也尚
在落後之中，而北斗衛星系統也有一顆試射失敗，再加上有些國家退出歐盟衛星系統體
系，顯示未來導航系統的發展變數很多，而美方為了挽救這股不可擋的潮流，也積極開
發新的衛星系統技術，淘汰舊有的衛星，並嘗試回收利用(如 PRN49 號衛星)，以便在未
來能更有競爭價值，由此會議不難看出，各國積極在尋找額外相關定位技術以便因應未
來導航系統遭受破壞時的備用方案，目前我國為歐盟系統在亞洲區不可或缺的一角，其
計畫為測試伽利略系統的訊號性能，希望藉由此次平台的建立與測試，能增加我國導航
技術在國際間的認同。 
Self-Tuning Synthesis Filter for GNSS Antenna 
Array with Mutual Coupling and Interferences  
 
 
Chung-Liang Chang 
Department of Biomechatronics Engineering, 
National Pingtung University of Science and Technology, Taiwan 
 
 
 
BIOGRAPHY   
 
Chung-Liang Chang receives the B.S. degree in Industrial 
Education from National Taiwan Normal University, 
Taipei, Taiwan, in 1998. He has M.S. and the Ph.D. 
degrees in Electrical Engineering from the National 
Cheng Kung University, Taiwan, in 2004 and 2008, 
respectively. He teaches at Department of Electrical 
Engineering of National Tainan Industrial Vocational 
High School in Taiwan form 1998 to 2009. Meanwhile, 
he also works as part-time teacher in Department of 
Avionics Electronics Engineering of Air Force Institute of 
Technology in Taiwan, 2009. He currently serves as an 
assistant professor in Department of Biomechatronics 
Engineering at National Pingtung University of Science 
and Technology, Taiwan. He is a member of Institute of 
Navigation (ION), IEEE Signal Processing Society, 
IEICE Communications Society, and Phi-Tau-Phi 
Scholastic Honor Society. His main research interests 
include adaptive signal processing, anti-jam techniques, 
antenna array processing, and embedded system 
applications. 
 
ABSTRACT  
 
This paper aims to utilize a self-tuning synthesis filter 
capable of mutual coupling compensation and 
interference mitigation. The spatial filter and temporal 
filter are to compensate for the effect of mutual coupling 
and interference mitigation, respectively. Self-tuning 
mechanism is to adopt least square (LS) and minimum 
variable distortionless response (MVDR) based methods 
to adjust spatial and temporal weights of antenna array. 
The experiment platform is established by the embedded 
development board. Simulation and experiment results 
demonstrate that the proposed method can effectively 
compensate for mutual coupling, mitigate the co-channel 
interference up to 30 dB and enhance the acquisition 
performance of global navigation satellite system (GNSS) 
receivers.   
 
INTRODUCTION  
 
Global positioning system (GPS) satellites operate on the 
orbit 20200 kilometers high and the power of carrier for 
L1 band upon the ground is about -130 dBm. In general, 
the power of thermal noise can reach -110 dBm. It 
indicates that the power of GPS signal is lower than that 
of thermal noise. Luckily, GPS adopts spread spectrum 
technique to acquire sufficient gain for reception end to 
reconstruct signals. However, if GPS is susceptible to 
interference, it results in the difficulty in reception and 
lock of GPS signals due to the over strong magnitude of 
interference, too wide bandwidth, and close proximity in 
type of modulation.  
 
Typical interference mitigation techniques consist of three 
types. The first is defined as antenna array processing, 
which utilizes multiple antennas to conduct the estimation 
of interference direction and adjust the gain and phase of 
antenna array to null out interferences. The second is 
termed pre-correlation processing, which transfers signal 
form high frequency to intermediate frequency (IF) and 
then conducts signal processing in terms of amplitude, 
time domain or frequency domain to decrease the impact 
of interference [Spilker et al., 1996]. The last is called 
post-correlation processing, which adopts software define 
radio to integrate GPS with other assisted navigation 
devices to enhance the precision in navigation positioning. 
With regards to the effect of interference mitigation, 
antenna array processing is more efficient. The pre-
correlation processing technique is medium in effect and 
cost, but the reception circuit has to be redesigned. The 
third technique is limited in effect enough it can employ 
available global navigation satellite system (GNSS) 
receiver and additional inertial navigation components to 
aid positioning.  
 
In a word, in terms of interference mitigation, the 
immediate removal or mitigation of interferences upon 
the radio frequency (RF) front-end of receiver yields a 
better result than that upon rear-end of the receiver. Due 
to the specific of geometric relations among each antenna 
component, associated phase relation exists among 
916
ION 2010 International Technical Meeting
January 25-27, 2010, San Diego, CA
it is adequate to consider the coupling model with just a 
few nonzero coefficients. The mutual coupling matrix can 
be given as follows [Chang et al., 2008]: 
[ ]
, 1
1,
0, other
pq
p q
p q
⎧ − =⎪= =⎨⎪⎩
M
δ
   (4) 
where [ ]pq   indicates the coupling contribution of the 
-thq  antenna to -thp  antenna and δ  is the intensity of 
the received power of its immediate neighbors.  
 
Thus, the array signal vector in the presence of 
mutual coupling can be rewritten as 
1
( )= + +
J
s j j j
j
k P k P k k
=
∑x As( ) B i ( ) C( )%   (5) 
where Ha b[ ( ) ( )]k k=x x x% % % is the same structure as (1). 
Finally, it is possible to write the spatial covariance 
matrix of the array signal vector in the absence and 
presence of mutual coupling as 
H
11 1 1{ ( ) ( )}E k kR x x      (6) 
H
11 1 1{ ( ) ( )}E k kR x x% % %      (7) 
where 1( ) [ ( ) ( )]m m Nmk x k x k=x% % %L  and {}E ⋅  denotes the 
expectation operator. Similarly, the temporal 
covariance matrix of the array signal vector in the 
absence and presence of mutual coupling is shown 
as 
H
bb b b{ ( ) ( )}E k kR x x      (8) 
H
bb b b{ ( ) ( )}E k kR x x% % %      (9) 
 
METHODOLOGY 
 
The rules in the design of adaptive antenna algorithm can 
be applied in spatial and temporal domain. The structure 
of an adaptive antenna is adapted through spatial filters 
whose complex weights combine the signal from each 
antenna element. Each antenna element is processed with 
its own temporal filter, the outputs of which are joined 
together to yield a single output signal. The weights are 
selected to effectively null out interference while 
intentionally retaining the desired signal. The adaptive 
nulling of the antenna array is demonstrated by the 
capability to steer several nulls (minimum of the radiation 
pattern) to the interferences while keeping a maximum of 
the radiation pattern toward the desired signal. However, 
the above process of adaptive array algorithm is under 
taken without considering mutual coupling effect. To 
evaluate the effect of mutual coupling and compensate for 
its influence, an adaptive spatial filter with LS method is 
utilized to make up for mutual coupling effect and a 
temporal filter with QR-based MVDR beamformer is 
adopted to mitigate wideband and narrowband 
interferences.  
 
Mutual Coupling Compensation 
It is shown from (2) and (3) that when mutual coupling 
matrix (MCM) is known, mutual coupling effect can 
be easily nulled out by pre-multiplying the input 
steering vector ,aθ φ  by the inverse of MCM 
(assuming that it is invertible). Assume the weight 
vector aw  is susceptible to mutual coupling, the 
estimated is expressed by  
a a +w = Mw e%      (10) 
where e  denotes the measurement error. The mutual 
coupling M  can be calculated by employing LS method 
as a solution for the following optimization problem 
2
a a 2
arg min −
M
M = w Mw% %     (11) 
Where 2  indicates the Euclidean norm, and  
a ,s s
=w aθ φ denotes the receiver weight vector for non-
adaptive array, or  1a 11 ,s s
−=w R aθ φ means the receiver 
optimum weight vector for adaptive array. Thus, M%  
is given by  
H H 1
a a a a( )M = w w w w
−% %     (12) 
 
MVDR Beamformer 
 
In spatial-temporal processing, the MVDR beamforming 
can minimize the combined output form an antenna array, 
in a least square sense limited by independent linear 
equality constraints (constraint optimization), each of 
which relates to a selected look direction. Suppose the 
constraint is formulated in order to minimize the variance 
(the average power) of a beamformer output. Meanwhile, 
distortionless response is maintained in particular 
direction (target direction of interest). Such a solution is 
termed MVDR. The cost function is to minimize the 
output power of array system given by: 
H H H
b b b b b bb b
H
b ,
min [ ( ) ( )]
. . 1
E k k
s t
=
=
w
w x x w w R w
w dθ φ
  (13) 
where ,dθ φ  is 1NM×  desired spatial-temporal steering 
vector. Use the Lagrange multiplier operator, and the 
optimum weight vector is as follows: 
1
bb
MVDR H 1
bb
,
, ,
−
−=
R d
w
d R d
θ φ
θ φ θ φ
    (14) 
Many practical applications of MVDR beamformers 
require online calculation of the weights based on (14). It 
indicates that the covariance matrix in (8) should be 
estimated and inverted online. Nevertheless, this process 
918
ION 2010 International Technical Meeting
January 25-27, 2010, San Diego, CA
{ }
2H
out 10 2 2H H
SINR 10log ( )s
r vE
=
+
w x
w x w x
  (21) 
Form (19) and (21), the improvement in SINR  
provided by the beamformer can be defined as: 
imp out inSINR SINR SINR= −    (22) 
This quality measure assesses the potential of the 
proposed algorithm to eliminate the power of 
interference 
Table I Parameters setup of test scenarios 
 
Number of 
antenna 
element 
(URA) 
Mutual 
coupling 
exist? 
(Yes/No) 
ISR 
Interference 
direction 
( ,j jθ φ ) 
Desired GPS 
signal 
direction 
( ,s sθ φ ) 
Scenario 1 
4 ( 2 2× ) 
9 ( 3 3× ) No None None (40 ,120 )
o o  
4 ( 2 2× ) No 
Scenario 2 
9 ( 3 3× ) No 
10~80
dB 
( 40 ,15o o ) 
( 40 ,170o o ) (40 ,120 )
o o  
4 ( 2 2× ) Yes 
Scenario 3 
9 ( 3 3× ) Yes 
10~80
dB 
( 40 ,15o o ) 
( 40 ,170o o ) (40 ,120 )
o o  
 
in the incoming signal and meanwhile maintain the 
desired signal power. Besides SINR improvement 
factor, the signal acquisition margin (SAM) is utilized to 
determine the signal acquisition threshold [Juang et al., 
2005]. It is a measure of the signal and noise peak values 
after correlation. Assume sA  be the peak value of the 
GPS signal in the acquisition diagram after correlation 
and vA  be the peak value in correspondence to 
interference and noise. The SAM is defined as: 
10SAM=10log ( ){ }
s
v
A
E A
    (23) 
Thus, a high SAM indicates a successful rate in signal 
acquisition. 
 
SIMULATION RESULS 
 
In this section, computer simulations are made to evaluate 
the performance of the proposed methods. Three cases of 
simulations are presented for a 2 2× and 3 3×  uniform 
rectangular array (URA). In the first scenario, the URA 
operating in nominal mode is demonstrated. The second 
depicts a scenario where the interference is present and 
mutual coupling is absent. The third indicates the array 
processing under the condition of mutual coupling and 
interference. The antenna locations (in meters) in half-
wavelength ( 2/λ ) spacing with the array operate at IF 
4.092MHz. Each antenna has 5 taps delay and the 
direction of the desired signal is known a priori. Assume 
the desired signal-to-noise ratio (SNR) in all simulations 
to be −20 dB. The intensity of the received power of its 
immediate neighbors and is equal to 0 4.δ = . 
 
The number of antenna elements N is associated 
with the number of broadband interferences that can 
be cancelled by the spatial-temporal beamforming 
algorithm. In general, the number of broadband 
interferences that can be eliminated by the spatial-
temporal filtering corresponds to N−1. Three 
scenarios with the main parameters illustrated in 
Table I are simulated. One desired signal at broadside 
( 40 , 120 )= =o oθ φ  and two directional broadband 
 
(a) URA ( 2 2× )
 
 
(b) URA ( 3 3× ) 
Fig. 1 The beam pattern in different scenarios for ISR = 50dB 
 
 interference sources at [( 40 , 15 ), ( 40 ,= = = =o o oθ φ θ φ  
170 )]o  are generated in the simulations where the desired 
signal and each of the interference signals are 
uncorrelated. 100 Monte Carlo simulations are 
conducted and the length of the available data 
record is 40ms. 
 
Fig. 1(a) illustrates the use of URA( 2 2× ) array structure 
under ISR as 50 dB and shows the result of gain pattern 
with/without the proposed algorithm. The figure 
920
ION 2010 International Technical Meeting
January 25-27, 2010, San Diego, CA
signal using Matlab software. The following is the 
depiction of experiment procedure: 
 
Step 1: Four RF front-end modules are connected to four 
antennas, respectively, on experiment platform. Then, the 
self-designed circuit interface board is inserted to I/O 
interface of embedded development board. The Quartus II 
software is adopted to construct spatial-temporal module 
where each antenna is composed of 5-tap finite impulse 
response (FIR). Hence, four antenna sets make up 20 taps. 
The RF front-end modules transfer incoming signal to IF 
digital signal, which is sent to embedded development 
board for spatial-temporal signal processing. The signal 
has been digitalized as 2 bits sign/magnitude value, which 
has to be transferred in order to correspond to suitable 
voltage level in embedded board. The transferred data has 
to multiply the weight of real and image, respectively, 
after each delay time, the result of which is summed alto- 
 Fig. 5 SOPC builder interface 
 
 
Fig. 6 Photo of experiment location 
 
gether for output. 
 
Step 2: The spatial-temporal module constructed in 
Quartus II software is incoporated to user logic program 
and connected to Avalon. The accomplishment in setting 
up related parameter can yield CPU core designed by 
user. The translation starts to execute upon the 
incorporation of designed Nios CPU to the constructed 
spatial-temporal structure in Quartus II and the joint 
connection between them. If no error occurs in the 
transation, *.sof file generates and is written to FPGA 
board. 
 
Step 3: Select a spacious ground and employ the designed 
platform to receive GPS signal. Each data reception 
length about 3ms. Have the received data sent to spatial-
temporal processing module in Quartus II for signal 
processing shown in Fig. 5. Through the operation of 
dynamic memory access (DMA), store the 3ms received 
GPS signal to external SDRAM for Nios II to execute 
adaptive algorithm. The calculated weights will be 
delivered to spatial-temporal module in Quartus II 
through Nios II CPU by way of iteration. After several 
iterations, Quartus II perform to acquire the output data of 
spatial-temporal processing. 
 
Table II Experiment results (SAM detection threshold= 5dB) 
Without self-tuning 
synthesis algorithm 
With self-tuning 
synthesis algorithm 
 
SAM 
 
ISR λ  2/λ  4/λ  λ  2/λ  4/λ  
10 7.12 7.83 5.3 7.23 7.62 6.28 
20 5.81 6.44 － 7.19 7.44 6.32 
30 － 5.11 － 6.99 7.23 5.21 
40 － － － 6.95 7.19 － 
50 － － － 6.91 7.15 － 
 
 
Fig. 7 Sky plot of GPS satellites and near-field pseudolite interference 
 
Step 4: Conduct signal acquisition analysis of the process- 
sed data using Matlab software. 
 
Results 
 
The location of experiment test is selected at longitude 
22 9. o , latitude 120.2o , shown in Fig. 6. The observable 
GPS satellites are depicted in the sky plot of Fig. 7. The 
location of the interferer is at azimuth 312o , elevation 
53o  and ISR is about 30dB. Night GPS satellites are 
observed. The initial location of each satellites is stored in 
922
ION 2010 International Technical Meeting
January 25-27, 2010, San Diego, CA
20 36.28 37.14 36.64 35.75 38.52 
25 32.76 36.82 37.70 38.11 39.30 
27 - 35.22 - 35.23 39.56 
28 36.80 36.49 - - 37.67 
19 36.88 37.31 - 34.11 38.26 
 
simultaneously compensate for mutual coupling effect 
and mitigate interference. Simulation and experiment 
results are demonstrated to verify the feasibility of 
proposed method. In simulation, 2 2×  and 3 3×  URA 
structures are adopted to analyze the performance of 
proposed algorithm, respectively. The simulation result 
indicates that 2 2×  and 3 3×  can effectively compensate 
for mutual coupling effect ( 0 4.δ = ) and mitigate 
interference. The use of URA ( 3 3× ) structure 
outperforms URA ( 2 2× ). However, in consideration of 
cost, this paper utilizes 2 2×  structure to analyze the 
performance of proposed algorithm and employ an 
embedded system to develop this algorithm in 
experiment. Due to the limitation in hardware, the use of 
only five delay taps and four antennas lead to the 
confinement of performance in interference mitigation to 
30 dB. The experiment also analyzes the effect of 
different antenna spacing on the performance of proposed 
algorithm. The results reveal that the proposed method 
can efficiently compensate for mutual coupling caused by 
narrower antenna spacing even if it is 4λ / .  
 
ACKNOWLEDGMENTS 
 
The author would like to thank the mechatronics 
laboratory, National Cheng Kung University to provide 
the instruments to conduct experiment and National 
Science Council in Taiwan to support this research under 
grant NSC 98-2218-E-020-003. 
 
REFERENCES 
 
Adve, R. S. and T. K. Sarkar. 2002. Compensation for the 
effects of mutual coupling on direct data domain 
algorithm. IEEE Trans. Antennas Propag. 48(1): 86-
94. 
Allen, B. and M. Ghavami. 2005. Adaptive array systems: 
fundamentals and applications. John Wiley and 
Sons, Inc. 
Chang, C. L. and J. C. Juang. 2008. A new pre-processing 
approach against array uncertainty for GNSS,” 
IEEE/ION PLANS, 892-897, Monterey, California, 6-
8 May. 
Chang, C. L. and J. C. Juang. 2008. Effect of array 
configurations on the performance of GNSS 
interference suppression. International Journal of 
Control, Automation and Systems 6(6): 884-893. 
Gupta, I. J. and A. A. Ksienski. 1983. Effect of mutual 
coupling on performance of adaptive array IEEE 
Trans. AP. 32(5): 785-791. 
Huang, Z., C. A. Balanis, and C. R. Birtcher. 2006. 
Mutual coupling compensation in UCAS: Simulations 
and experiment. IEEE Trans. Antennas Propag. 
54(11): 3082–3086.  
Johnson, D. H. and D.E. Dudgeon. 1993. Array signal 
processing: concepts and techniques. Prentice Hall. 
Juang, J. C. and C. L. Chang. 2005. Performance analysis 
of GPS pseudolite interference mitigation using 
adaptive spatial beamforming. ION 61st Annual 
Meeting. 1171-1180. Cambridge, Massachusett, 27-29 
June. 
Kim, S. J. and R. A. Iltis. 2004. STAP for GPS receiver 
synchronization. IEEE Trans. Aerosp. Electron. 
Syst. 40(1):132-144.  
Pasala, K. M. and E. M. Friel. 2000. Effects of 
mutual coupling on the performance of STAP 
antenna arrays. IEEE Trans. Aerosp. Electron. 
Syst. 36(2): 518–527. 
Sellone, F. and A. Serra. 2007. A novel online mutual 
coupling compensation algorithm for uniform and 
linear arrays. IEEE Trans. Signal Process. 55(2): 560-
573.  
Spilker, J. J. and F. D. Natali. 1996. Interference effects 
and mitigation techniques. in global positioning 
system: theory and applications, edited by B. W. 
Parkinson and J. J. Spilker. Washington, DC: 
American Institute of Aeronautics and Astronautics, 
Inc. 
Steyskal, H. and J. Herd. 1990. Mutual coupling 
compensation in small array antennas. IEEE Trans. 
Antennas Propag. 38(12): 1971-1975.  
Svantesson, T. 1999. Modeling and estimation of 
mutual coupling in a uniform linear array of 
dipoles. ICASSP, Phoenix, AZ, 2961–2964. 15-
19 March. 
 
924
ION 2010 International Technical Meeting
January 25-27, 2010, San Diego, CA
國科會補助計畫
研發成果名稱
發明人
(創作人)
技術說明
技術移轉可行性及
預期效益
技術/產品應用範圍
產業別
計畫名稱:
計畫主持人:
計畫編號: 學門領域:
(中文)
(英文)
成果歸屬機構
(中文)
(英文)
具有互耦補償及干擾訊號抑制之衛星定位空時自調式混合濾波電路研究
張仲良
98 -2218-E -020 -003 - 訊號處理
利用模糊運算法之GNSS之訊號擷取方法
GNSS Signal Retrieving Method Using Fuzzy Calculations
國立屏東科技大學 張仲良
此技術提出一個可適性邏輯控制的方法來加快GNSS訊號搜尋的速度，在傳統的
訊號搜尋方法中，我們必須在載波頻移範圍內(+-10KHz)固定分為特定數量個督
普勒索引及電碼搜尋範圍內分為特定個電碼索引來找出訊號電碼粗略延遲量以
及粗略的督普勒頻移量以供後續進行鎖碼迴路(DLL)及鎖相迴路(PLL)找出精確
的電碼偏移量及載波相位，然而此種方式須消耗大量的搜尋時間，再者，如果
須求得較為精準的嘟普勒頻移量，勢必減少頻率搜尋步階值，在相同的搜尋範
圍前提下，無形中也大量的增加了搜尋的次數，也增加訊號擷取時間。本技術
利用訊號間相關運算所獲得的相關運算值即可適應性的調整出最佳的頻率搜尋
步階值，而得到更為精準的嘟普勒偏移量及電碼偏移量。從模擬結果可得知，
本文所提出的方法比其他訊號擷取方法有更快速的訊號搜尋時間及較佳的參數
精準度。
The report presents a fuzzy logic controller (FLC) with adaptive
threshold control scheme to regulate frequency search step size so as
to enhance performance in GNSS signal acquisition. Conventional
frequency search can be achieved utilizing step-by-step frequency bin
search or through fast Fourier transform (FFT). Nevertheless, too
large a frequency search step size and short length of FFT result in
large loss of correlation, whereas too small frequency search step
size and long length of FFT increase signal acquisition time. FLC is
employed to regulate the frequency search step size in the frequency
domain on the basis of an input variable: code correlation value and
its rate of change. To enhance the robustness of signal acquisition
performance, the signal detection threshold is adaptively adjusted
and combined with FLC. The results demonstrate that the method
enhances acquisition performance with regards to execution time and
航空運輸輔助業；電信業；研究發展服務業；其他專業、科學及技術服務業；電信工
程業
可利用之產業：通訊業以及消費電子
可開發之產品：
軍事與民用導航接收機，可嵌入至導航接收機晶片中，加速GNSS導航定位速度。
可推廣至軍用以及民用方面，目前已申請專利，並審查中。
註：本項研發成果若尚未申請專利，請勿揭露可申請專利之主要內容。
