 晶圓針測 
(Wafer probe)
黏晶圓 
(Wafer mount)
晶圓切割 
(Wafer saw) 
黏晶片 
(Die attach) 
打金線 
(Wire bond)
上蓋 
(Lid attach) 
印字 
(Marking) 
成品測試 
(Final test)
圖一 CLCC/OLCC 封裝技術之流程圖 
 
 
 
圖二 CLCC 封裝技術 CMOS 影像感
測器晶片切面圖 
圖三 OLCC 封裝技術 CMOS 影像感測器晶
片切面圖 
 
目前一般晶片的封裝良率已可達到 99％以上，但在影像感測晶片的組裝生
產，能有 90％或稍高一點的良率，就已經是達到高標準。其中重要的技術瓶頸，
除了高等級潔淨室外，另外一個關鍵性技術即是玻璃蓋片的問題。目前玻璃蓋片
之檢測乃是在封合的前一步進行，玻璃蓋片可能發生之瑕疵分為以下六種，茲列
於表一，目前業界多以人工進行抽檢，受限於人眼的最小可辨識能力，最小檢測
規格定為 20μm，目前人工抽檢有以下幾個主要的問題： 
1. 根據廠商的需求，玻璃蓋片上 5μm 的瑕疵即會對 CMOS 的成像造成影響；
但目前受限於人眼的最小可辨識能力，人工檢測僅以 20μm 做為最小檢測規
格，故人工檢測在精度上有所不足。 
2. 人工檢測費時，增加元件暴露在外的時間，使玻璃蓋片的品質易受環境落塵
影響。 
3. 人工檢測受限於成本及檢測速度，只能達到抽檢，無法達到全檢。 
4. 檢測人員認定變異性大，易受主觀影響。 
5. 由於瑕疵規格逼近人眼極限，且檢測人員必須長時間注視光源，容易因疲累
等因素產生誤判。 
 
2.2 光源系統架構 
光源環境的好壞直接影響到待測影像的品質，好的光源環境不但可以突顯物
體的對比，而且可以清楚的顯示被攝物體表面的紋路、特徵，也可以減少影像的
雜訊，簡化影像處理的時間；因此欲設計一個快速可靠的瑕疵檢測系統，一個合
適的光源是必備的。 
常見的光源系統設計或打光技巧有以下幾種[7]： 
1. 前照式( Front lighting )：光源與 CCD 攝影機在物體之同側，利用光線反射強
弱的不同，作為檢測物體表面特徵時之照明。 
2. 背照式( Back lighting )：光源與 CCD 在物體的不同側。利用背照式產生出對
比強烈的物體輪廓線，作為物體尺寸檢測之用。 
3. 側照式( Side lighting )：光源放在物體的側面，光源的照射方向與物體平面近
乎平行。利用側照光源的效果突顯待檢測物體之幾何性質。 
圖五為常見的打光方式示意圖，本計畫將參考這些打光技巧，以進行本計畫
的光源設計。 
環形光源
背光源
物件
物件
CCD CCD
物件
CCD
環形光源
側照式背照式前照式
圖五 常見的打光方式示意圖 
2.3 影像處理 
為了突顯瑕疵位置並消除影像處理過程所產生的雜訊或其背景，本計畫擬以
下述幾種基本的影像處理方法為基礎，來發展穩健快速的玻璃蓋片瑕疵演算法。 
2.3.1 Binarization and Auto-thresholding 
影像二值化方法乃將灰階或彩色的影像，透過選取的臨界值/閥值(Threshold 
Value)，將灰階或彩色的影像轉成只有 0 或 1 的二值化影像資料。影像二值化
的目的主要是將物體與背景進行區分，此一過程可明確區分出欲檢測物體之位
置，簡化後續影像處理的過程或時間，所以影像二值化為重要步驟。 
在灰階閥值之抉擇方面有許多學者提出不同的做法，如在自動選擇閥值方面
有 Ostu[5]提出用機率統計的原理，找出讓群組間變異數最大且群組內變異數最
本章的說明內容包括：(1)取像之光源、硬體架構、(2) AOI 檢測軟體演算法、
(3)軟、硬體整合。 
3.1 光源、取像系統的設置 
側照示光纖光源系統架構如圖七所示。其中，使用聚光鏡搭配鹵素光機與光
纖配合 CCD 同軸移動，產生集中之平行光源，由於玻璃蓋片之檢測標準相當小
(5μm)，需搭配高倍率鏡頭，因此單張影像所能涵蓋的檢測範圍相當小(約
2.976mm*2.381mm)，使用聚光鏡將光束集中在這塊小區域中，故能提供較側照
式 LED 光源高出數倍亮度之照明。 
 
圖七 側照式光纖光源系統架構圖 
 
側照式光纖光源特色在於可產生出對比強烈的物體輪廓線，有利於檢測物體
尺寸大小，在玻璃蓋片視覺檢測的應用上，對於瑕疵的大小的判斷上較為有利。
然而，由於光源角度的影響，在機構的建構與校正上較為複雜。一般而言，聚光
鏡與水平之夾角 θ 愈小對於玻璃靠近 CCD 攝影機這一側的瑕疵的突顯效果較
好；反之，θ愈大則對於玻璃遠離 CCD 攝影機這一側的瑕疵的突顯效果較好。
故本計畫設計以下之實驗找出適當的 θ 角，使能同時突顯不論玻璃靠近或遠離
CCD 攝影機之表面瑕疵。 
先將聚光鏡與玻璃之距離固定(實驗中固定為 7cm)，改變聚光鏡之角度，依
每 5∘之間隔分別取像。 
將取得之影像按照以下方法處理： 
Binarization (Threshold=20) Î Closing (iteration=1) Î Blob Analysis (Count the 
defect) 
比較處理後瑕疵之數目，表二為實驗之結果。 
40∘ 66 
45∘ 69 
50∘ 65 
55∘ 52 
 
從表二中可以發現在聚光鏡角度為 45∘時，最能同時突顯玻璃遠、近兩端
表面上的瑕疵，故本計畫選擇『45∘』作為側照式光纖光源之光源角度。 
3.2 影像處理方法 
使用 3.1 節所提出之取像機構，實際取得之待測影像如圖八所示，本節將分
析所取得之待測影像，發展出適合之影像處理演算法。 
 
 
0
50000
100000
150000
200000
250000
0 2 4 6 8 10 12 14 16 18 20 22 24 26
Intensity
Co
un
t Region 1
Region 2
Region 3
 
圖十一 待測影像切割示意圖 圖十二 分割後子塊影像之直方圖 
3.2.2 影像二值化 
在側照式光纖光源下，對玻璃蓋片的各種瑕疵的突顯效果不同，因此在二值
化閥值的選擇也應有所不同，才能正確地分析出各種瑕疵。若僅使用單一閥值，
在能突顯低對比瑕疵時，會高估高對比瑕疵之大小；而適合突顯高對比瑕疵之閥
值，會遺漏低對比瑕疵。解決此問題，本計畫將對不同種類瑕疵選取不同閥值之
二值化策略，側照式光纖光源下，我們可以將瑕疵粗分為二大類：低對比瑕疵與
高對比瑕疵，低對比瑕疵在二值化時，只需以切除背景為目標，處理較為單純；
而高對比瑕疵由於會在其周圍產生光暈造成瑕疵的放大現象，在二值化時閥值會
取的較大以切除光暈。然而光暈與低對比瑕疵的灰階值相近，因此這兩類瑕疵必
須使用不同之二值化閥值。 
首先定義二個名辭：「耀點」(Shine point)與「光暈」(Halo)，用以界定高對
比與低對比瑕疵。「耀點」為瑕疵影像中明顯之亮點，與背景之對比較好，可明
確地藉由二值化切割出來，對側照式光纖光源下突顯效果較好之瑕疵，如：粉塵
等，會形成耀點，而耀點大小即為適當的高對比瑕疵大小估計指標，而對側照式
光纖光源下突顯效果較差之瑕疵，如：刮痕、水痕等，則不會產生，在實際應用
上我們將灰階值大於一定值之點視為耀點，此值則定義為 High threshold (HT)；
而「光暈」則是伴隨耀點周圍，灰階值介於耀點與背景之間的部份，如圖十三(c)
部份即為光暈， 部份則為耀點。通常瑕疵產生耀點則常會伴隨著較嚴重的光
暈，反之則光暈不明顯。 
  
(a) Original image (b) Image after mapping (c) 耀點與光暈 
圖十三 耀點與光暈圖例 
H=  Let (  area)／(  area＋  area)
Then if then defect blob is a type II defect ratioThresholdH _≥
 Else defect blob is a type III defect 
  
(a)耀點周圍為光暈 (b)耀點周圍為低對比瑕疵 
圖十四 光暈與低對比瑕疵 
圖十五為本計畫所提出之瑕疵種類判斷流程圖，待測影像經過 Low 
Threshold Binarization(LTB)與 High Threshold Binarization(HTB)後，比對二者之結
果，對每個瑕疵 Blob，判斷 Blob 中是否有耀點存在，若瑕疵 Blob 中無耀點則判
定為 Type I defect；若瑕疵 Blob 中有耀點則藉面積檢定判斷耀點周圍是光暈或是
低對比瑕疵，若耀點周圍為低對比瑕疵，則判定瑕疵為 Type III defect 若耀點周
圍為光暈，則判定瑕疵為 Type II defect。 
Low threshold
binzrization
Does the defect
have shine point ?
High
threshold
binzrization
No
Yes
Does the defect
have halo?
No
Yes
Sample
image
Type I defect
Type III defect
Type II defect  
圖十五 瑕疵種類判斷流程圖 
在完成瑕疵的分類後，為達成對應不同瑕疵使用適當的強影像化處理之目
的，對應三種瑕疵使用不同的二值化方法，Type I defect 與 Type III defect 使用
LTB，而 Type II defect 則使用 HTB，得到適當的二值化強化影像以進行之後的
Blob analysis。以表三中的瑕疵影像為例，對 Type I defect 與 Type III defect 來說，
LTB 之結果(表二中實例影像綠色部份)為適當的強化影像，而對 Type II defect，
HTB 之結果(表三中實例影像紅色部份)才是適當的強化影像。 
二值化方法中的LT與HT均依(1)式推演產生，如(2)式與(3)式，其中α1與α2之值需
藉由實驗取得，將於 4.2.1 節中詳述。 
1α+= medianLT                             (2) 
2α+= medianHT                             (3) 
在實際應用上，參考 Nakagawa 與 Rosenfeld[4]所提出之想法，將待測影像
分割成三個子影像分別處理，以減少影像亮度不均之影響，再依照上述之概念切
割掉黑色背景，留下瑕疵部份的影像，此即是本計畫提出之可以反應實務環境變
化(背景部份較亮或暗)，動態調整閥值的 Auto-thresholding 方法。 
3.2.4 影像合併 
在先前的處理中，為了解決亮度不均的問題，而將影像分割成九塊子影像，
再針對各塊子影像分別計算其閥值，做二值化處理。在分割處理下，若有瑕疵位
於分割的邊界，將造成瑕疵被切割，影響計畫判斷瑕疵的準確度，因此提出先將
二值化後的三張子影像拼合成一大張，再進行接下來的瑕疵大小及位置的判斷，
不但能加快運算速度並能解決瑕疵位於邊界的問題。 
3.2.5 Blob analysis 
所謂 blob，是指一張影像上面，具備相同條件或屬性的像素，互相接觸或相
鄰所組成的區域或面積。 
然而，瑕疵常因其表面特徵而有深淺變化，在影像二值化時常會發生單一瑕
疵影像斷裂成數塊的現象，將同一瑕疵看成斷裂後的數個小瑕疵，如圖十八(b)，
造成瑕疵被忽略而遺漏、遺失瑕疵種類資訊。因此在進行 Blob analysis 之前，可
使用影像處理之方法強化瑕疵面積判斷的準確度，本計畫使用形態學中的「閉合」
(Closing)方法，將斷裂的瑕疵影像依所在位置資訊加以連接，如圖十八(c)。 
(a).原始影像 (b).二值化後影像 (c).Close 後影像 
  
圖十八 Closing method 之處理效果 
在使用形態學中的閉合方法連接位置相鄰的影像後，利用 Blob analysis 取得
瑕疵的大小及位置資訊。利用該資訊即可進行瑕疵判定，並偵測出瑕疵所在的位
置。 
3.2.6 檢測演算法流程圖 
綜合以上 5 節，圖十九為本計畫所開發之玻璃蓋片瑕疵檢測演算法流程圖。 
機構仍繼續移往下一個取像點以準備擷取下一張影像，詳細之演算法如下： 
1 Begin initialize i Å 0, n, Move(0) 
2  do i Å i+1 
3   WAIT until Move(i) return “OK” 
4   Grab_Image(i) 
5   WAIT until Grab_Image () has grabbed Image i 
6             Move(i+1) 
7   WAIT until Image_Processing(i-1) return “FREE” 
8   Image_Processing(i) 
9  until i=n 
10 End 
圖二十為單線處理與單線處理之處理時間示意圖，可發現多線平行處理於每
個 view 均較單線處理剩下一個影像處理的時間，因此在檢測完整片玻璃蓋片，
多線平行處理較單線處理約減少 1/3 的檢測時間。 
 
圖二十 單線處理與多線平行處理之處理時間示意圖 
3.3.2 連續移動取像 
本計畫之概念為 CCD 攝影機使用較短的快門，在移動機構仍在移動中即進
行取像，在快門時間夠短時，移動機構在快門時間內的移動距離，能保持在容忍
範圍下，此時移動中取像是可行的。此方法能減少移動機構停下來讓 CCD 攝影
機取像再起動所花費的加速、減速時間，配合連續的移動路徑，達成縮短取像時
間的目的。取像示意圖，如圖二十一所示，CCD 每次移動取 22 張影像，相鄰兩
張影像間有 5%的重疊，配合「弓」字型之移動方式，共移動 20 次，以 440 張影
像涵蓋一張影像。 
 
圖二十一 CCD 移動取像示意圖 
表五 有瑕疵影像與無瑕疵影像灰階值分佈比較表 
有瑕疵影像 無瑕疵影像 有瑕疵影像 無瑕疵影像 
灰階值 數量 灰階值 數量 灰階值 數量 灰階值 數量 
0 2048 0 2048 36 21 36 0 
1 0 1 0 37 15 37 0 
2 0 2 0 38 13 38 0 
3 0 3 1 39 10 39 0 
4 6 4 29 40 8 40 0 
5 11 5 36 41 15 41 0 
6 327 6 282 42 12 42 0 
7 488 7 395 43 6 43 0 
8 786 8 591 44 8 44 0 
9 1585 9 869 45 6 45 0 
10 173576 10 170207 46 10 46 0 
11 324499 11 318285 47 10 47 0 
12 442995 12 438505 48 16 48 0 
13 323999 13 332343 49 8 49 0 
14 36683 14 44578 50 0 50 0 
15 2394 15 2543 51 5 51 0 
16 314 16 7 52 4 52 0 
17 147 17 1 53 4 53 0 
18 99 18 0 54 7 54 0 
19 83 19 0 55 4 55 0 
20 70 20 0 56 4 56 0 
21 57 21 0 57 4 57 0 
22 36 22 0 58 8 58 0 
23 39 23 0 59 3 59 0 
24 28 24 0 60 0 60 0 
25 36 25 0 61 4 61 0 
26 30 26 0 62 4 62 0 
27 30 27 0 63 2 63 0 
28 18 28 0 64 2 64 0 
29 13 29 0 65 4 65 0 
30 23 30 0 66 0 66 0 
31 15 31 0 67 1 67 0 
32 26 32 0 68 1 68 0 
33 15 33 0 69 1 69 0 
34 10 34 0 70 0 70 0 
35 14 35 0     
 
圖二十四 含光暈之纖維瑕疵影像直方圖 
圖二十五(a)為粉塵之瑕疵影像，在經過 LTB 處理切除背影後，可得到如圖
二十五(b)之含光暈瑕疵影像，對圖二十五(b)做直方圖如圖二十六所示，觀察此
直方圖可得約在灰階值為 26 之處為適當的切割點，依照 3.2.3 提出之
Auto-threshold 方法，設定 HTB Auto-threshold α2 = 14，圖二十四(c)為將瑕疵影
像在設定 α2 = 14 時的自動二值化結果，圖中我們可以發現 α2 = 14 對粉塵瑕疵
的光暈切除效果良好。 
(a) Original image (b) Defect with halo(c) Defect without halo
   
圖二十五 粉塵瑕疵影像 
 
圖二十六 含光暈之粉塵瑕疵影像直方圖 
表七 檢測演算法對 Type I defect 驗證表 
NO. Type of defects Defect image Binary image Blob analysis 
Defect area
(pixels) 
檢
測
效
果
1 Scratch 
  
Label Area
4 973 
OK
2 Scratch 
  
Label Area
2 1346
7 85
10 161 
OK
3 Scratch 
  
Label Area
2 198
4 24
6 74
7 24
8 32 
OK
4 Scratch 
  
Label Area
2 88 
OK
5 Scratch 
  
Label Area
2 20
4 140
5 8  
OK
12 Water stain 
  
Label Area
3 112
7 377
9 71
15 42
16 1573 
OK
13 Particle 
  
Label Area
1 162 
OK
 
4.2.2.2  Type II defect 
使用 21 張 Type II defect 之瑕疵影像，其中包括 14 張粉塵影像及 7 張纖維影
像；為方便肉眼觀察，瑕疵影像經過反白處理且強化其對比，每張影像解析度為
150*150，對應之實際大小為 0.351mm*0.351mm，單一像素對應之實際大小為
2.34μm *2.34μm，用以驗證檢測演算法對 Type II defect 之檢測效果，結果如表八
所示，得知本計畫所使用之瑕疵檢測演算法對 Type II defect 的檢測效果良好。
6 Particle 
 
251 OK
7 Particle 
 
14 OK
8 Particle 
 
6 OK
9 Particle 
 
2 OK
10 Particle 
 
106 OK
11 Particle 
 
25 OK
18 Fiber 
 
1276 OK
19 Fiber 
 
366 OK
20 Fiber 
 
769 OK
21 Fiber 
 
1796 OK
 
4.2.2.3  Type III defect 
使用 6 張 Type III defect 之瑕疵影像，其中包括 2 張混合型瑕疵影像及 4 張
裂痕影像；為方便肉眼觀察，瑕疵影像經過反白處理且強化其對比，每張影像解
析度為 150*150，對應之實際大小為 0.351mm*0.351mm，單一像素對應之實際
大小為 2.34μm *2.34μm，用以驗證檢測演算法對 Type III defect 之檢測效果，結
果如表九所示，表中 Binary image 部份， 區為 HTB 之結果，即瑕疵中的耀點，
而 與 區為 LTB 之結果，得知本計畫所使用之瑕疵檢測驗算法對 Type III defect
的檢測效果良好。
由以上實驗得知本計畫所提出之檢測演算法，對三類瑕疵均能有效檢測出來。由於瑕
疵的認定相當主觀且玻璃蓋片之瑕疵主要來自外部環境之污染，玻璃蓋片經過愈多的手續
或處理，產生瑕疵之機率亦愈大，因此本計畫沒有以統計方法計算演算法之檢測正確率。
但在經由 4.2 節之實驗，調整出適當的參數設定後，所有可能發生之瑕疵，本計畫所發展
之檢測演算法均可穩定快速地檢測出。 
4.2.3 CMOS 玻璃蓋片瑕疵檢測實驗 
4.2.3.1  檢測程式 
 本計畫所開發之 CMOS 玻璃蓋片瑕疵檢測程式，分成二項主要功能：「通過／不通過
檢測」與「影像分析」。通過／不通過檢測模式為快速地判斷玻璃蓋片是否有瑕疵，並將結
果以報表方式輸出，適用於製程中 GFVI(Glass final visual inspection)中使用；而影像分析模
式則會以圖形介面方式，清楚地標示出瑕疵影像，用於分析單張影像中瑕疵位置、形狀及
大小，如圖二十七所示，適用於檢討瑕疵成因時使用。 
 
圖二十七 檢測程式的 Image analysis 模式 
4.2.3.2  檢測實驗 
 本節將以玻璃蓋片樣本，實際測試檢測系統之速度及效果。檢測樣品為
60mm*45mm*0.5mm 之玻璃蓋片。每張影像解析度為 1280*1024 pixel，FOV(Field of View)
為 3.0mm*2.4mm，共以 440 張影像涵蓋整片玻璃蓋片。 
本機台檢測此樣本所花費之時間約為 86 秒，檢測系統共找出 356 個瑕疵，表 4.6 為樣
本之檢測結果，報表中依序列出：瑕疵類型、瑕疵大小、瑕疵所在影像、及瑕疵在影像中
之相對位置(X,Y)，可依照所在影像與影像中相對位置推算瑕疵的實際發生位置。 
4.2.3.3  檢測時間 
經過實際檢測 10 片玻璃蓋片後，可發現總檢測時間(Initial setup time + Inspection time)
固定為 86 秒，約相當於機構取像時間(約 84 秒)，可得知機台之檢測速度相當穩定。 
瑕疵數目愈多則需要愈多之檢測計算時間，因此瑕疵總數會影響檢測時間；本實驗機
