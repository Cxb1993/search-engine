1 
 
1. 前言 
  隨著網路科技的快速發展，以及應用軟體使用界面的簡單化、人性化，網路
使用人口正迅速膨脹。另一方面因為電腦的普及化，為了因應各式的使用者及寬
頻的傳輸環境，使得網路上傳輸的檔案格式越來越多元化，並且有著各式的應用
程式以提供更多、更好的服務。此外，這幾年瀏覽器的興起，更帶動了電子商務
的熱潮，使得網路上所儲存或是在網路上傳輸的資訊越來越具有價值。再加上因
為網際網路的便利性，許多人會將重要資料放置在網路上，以方便檔案可以和他
人分享，或是自己可以在任意地點處理公事。然而，在如此多樣的應用程式協定
(Telnet，FTP，HTTP，SNMP，POP，NetBIOS…等)，以及各形各色網路使用者
的情況下，使得網路傳輸的管理和控制越來越困難。 
  在通訊軟體迅速且日益多元化發展之下，難免在開發過程中會產生許多的漏
洞。這些對一般管理者而言，要去知道每一個軟體的漏洞和缺陷是有其困難度。
首先，管理者必須在閱讀冗長的諮詢報告後，自行檢測系統或判斷所用程式的版
本資訊，再經由網路搜尋相關檢查程式，找出適合此系統弱點的修補程式(patch)。
更進一步地，管理者必須針對這些通訊軟體，不間斷地進行同樣的檢查和修補工
作。只要稍有延遲，惡意的攻擊者即可藉由此尚未修補之漏洞發動攻擊，進而取
得該電腦之大部分使用權限。雖然現在許多軟體開發商，均提供便利之系統弱點
修補機制，如可協助掃描弱點之 Nessus[16]，和入侵偵測系統(IDS/IPS)的日漸普
及，許多入侵偵測系統能夠在被保護端做出整體之防禦，例如 ISS[4]的 Real 
Secure 可整合防火牆、路由器之 ACL。但大部分的弱點防護系統和存取控制機
制，是針對有線網路環境之設備與網路架構，我們藉由 CSI/FBI 2006 的調查報
告[14]內容中發現，經過這麼多的努力，未經授權的存取等弱點攻擊已日益減少，
但是遭受無線網路相關攻擊之單位卻不減反增，更已躍居所有種類攻擊之第三
位。此外根據 GAO 於 2005 年針對聯邦政府所稽核之報告 GAO-05-383[8]，雖然
NIST 已經訂定關於無線網路之相關標準如 NIST SP800-48[15]，但是由於無線網
路之弱點難以快速檢測，以及大部分的人目前對使用無線網路之安全觀念尚未成
熟，導致 GAO 報告[8]中檢測出之問題不少，足以顯現無線網路之存取弱點控制
之重要性。 
雖然無線區域網路已發展安全防護機制，從 Wi-Fi 最早訂定之安全協定
Wired Equivalent Privacy(WEP)，以及為解決 WEP 之安全漏洞所訂定之過度期協
定 WiFi Protected Access(WPA)。然而這些安全防護協定已有國內外相關研究提出
具有安全問題，因此我們先對 WEP 及 WPA 之安全技術和存取控制以及其安全
問題進行探討。 
WEP 是定義在 802.11 無線區域網路(Wireless LAN)中的安全協定，目的是為
了提供與有線區域網路(Wired LAN)相等的安全[1]。有線區域網路因為實體傳輸
媒介之保護，天生就比無線區域網路要來得安全。相對於有線網路，無線區域網
路透過無線電波傳送，可穿透實質物體的遮蔽，很容易被人竊聽或竄改。因此，
WEP 依靠一個參與傳送資料雙方都有的秘密金鑰來確保傳送資料封包的安全，
3 
 
TrueMobile 1300 WLAN Mini-PCI Card 因為對特權帳號的管理設定有漏洞，使得
攻擊者可以利用 systray applet 的 Help 功能取得特權帳號權限。由於要發動這些
攻擊，攻擊者都必須要先取得無線設備之廠商和型號，然而無線網路的傳輸特性，
並不像有線網路要攔截竊聽資訊需和目標機器處在同一區網那般困難，因為無線
訊號在空氣中傳播的特性使得攻擊者可以利用隱密的竊聽，並在發動侵入性攻擊
前可以取得更多資訊，以便更容易躲避防守端的防禦機制。 
現今無線區域網路(WLAN)已經被普遍使用，包括許多商店、咖啡廳、公司
等，雖然在公開場合或會議現場利用無線網路上網比傳統的乙太網路(Ethernet)
更有便利性，然而因為無線網路天生通訊環境的限制，以及通訊設備本身計算能
力較小、儲存空間也較有線通訊設備更為不足，再加上無線網路頻寬明顯較有線
網路小，無線區域網路設計了幾種不同的認證機制對無線網路使用者進行認證，
從最開始的 Open Authentication，也就是以 SSID 來對存取進行管制，到 WEP 利
用“不可交換”之事先的分享金鑰和 IV 來對使用者進行認證，以及最後的 WPA 和
802.11i 中以可交換的金鑰和 IV 搭配 passphase 來認證使用者，另外也已在 AP
上設定特殊的 Mac 和 IP 來對無線區域網路使用權做存取控管，但是現行所有的
認證機制，從最早的 WEP 至最新於 802.11i 內所提供的認證方法，都仍存在弱點，
以至於仍有相當多的攻擊可以讓沒有經過授權的使用者，可以透過 AP 存取無線
網路。 
為驗證無線網路傳輸之安全性、研究無線區域網路上攻擊者可能利用現有無
線網路設定以及協定上的漏洞採取之攻擊行為，進而有機會研究相對應的無線網
路安全防禦機制和方法，本論文利用 Wisec 平台架設一個攻擊、封包分析網路實
驗平台，來分析使用者利用無線區域網路以 Access Point 連結網際網路之應用層
傳輸協定可能存在之漏洞，使用這利用應用層協定組合間可能產生之問題，甚至
進一步分析現有應用層網路安全傳輸機制(如 SSL)執行於無線區域網路平台可能
之漏洞、相對應可能造成對使用者之威脅與攻擊者可能利用該遂行之攻擊。使得
我們可以藉由該研究對於使用者利用無線區域網路傳輸資料可能衍生之漏洞、攻
擊行為有實際的體驗。 
 
2. 應用層無線攻擊實驗 
在這章中我們 Wisec 分析 Datalink 層、以及 TCP 連線之攻擊然後再進一步
分析執行於無線區域網路上應用層協定和現有無線區域網路 Datalink 層漏洞和
攻擊組合後所可能衍生的攻擊。 
 
2.1 系統環境 
5 
 
（2）中間人攻擊法 
在完成偽裝基地台後，因為現存的無線網路機制(802.11)並未提供一個強而
有力的資料完整性保護措施，所以主動性攻擊造成資料完整性受到破壞是有可能
的。資料完整性的攻擊手法通常聯合其他項攻擊所完成，例如：網路監聽、阻絕
服務攻擊等。主要的攻擊手法為中間人攻擊。 
中間人攻擊法是指攻擊者處於無線區域網路用戶端與無線網路基地台中間，
攔截雙方的訊號並同時偽裝用戶端與基地台的角色，使得通訊雙方在不知情的狀
況之下繼續原有的通訊。 
 
 
圖 2：登入 Pop3 伺服器範例 
 
攻擊者可利用之前完成偽裝合法之基地台，利用無線網路通訊協定的設計瑕
疵，使受害者被動的連上該基地台，攻擊者可以發動中間人攻擊。當用戶端嘗詴
連線時，攻擊者偽裝成原本要連線之基地台，並且同時對原有基地台偽裝成欲建
立連線之用戶端。此時攻擊者就可成功地成為中間代理者的角色，所有通訊皆會
經過此攻擊者，攻擊者可以更改這些通訊內容，同時對於網路上資料機密性與完
整性造成雙重威脅，並可據此攔截使用者和基地站之認證訊息，因而假裝原有之
使用者來使用網路。若是我們已經利用上述之 Hot spot，成功讓使用者連線到我
們的假 AP，我們可以再連線到一個正常 AP，並且幫連線到假 AP 的 Station 跟
真正的 AP 建立連線，當該使用者如圖 2 要利用該無線網路收信，我們可以利用
帳號密碼竊取程式，竊取該使用者目前登入 email 伺服器之帳號密碼，如圖 3 取
得被害者之帳號密碼，並且會顯示受害者所連線之伺服器服務類別和目的端之 IP
位置，因此攻擊者將來可以很容易的利用這些資料來進行後續的竊取動作。 
7 
 
Request 給 AP，將 AP 的 Association Table 填滿而造成沒有辦法再建立連線。且
攻擊者為了掩飾自己的身分通常會以假冒的 MAC 位置來發送攻擊封包。 
Deauthentication Flood 攻擊乃是用來中斷兩方之 Association 的封包，攻擊者
利用該封包本身沒有設計認證發送端之特性，發送偽造來源之 Deauthentication
封包來中斷 Station 和 AP 連線，目前已知發動 Deauthentication Flood 的工具，偽
裝自己來源 Mac 位置的方式主要有下列兩種，以避免攻擊者本身被追蹤： 
1) Attacker 產生 Random 來源 Mac 進行攻擊 
2) Attacker 偽造合法 AP 的 Mac 進行攻擊 
  雖然 Station 會重新建立連線，但會減緩其原有傳輸速度，因此若該攻擊者
持續發送 Deauthentication 封包來中斷 Station 連線，則最後會顯示該連線已中斷。 
Beacon Flood 主要為攻擊者發送大量之假造的 Beacon 訊息，使 Station 無法
聽到正常合法 AP 的 Beacon 訊息，因而無法和該 AP 建立連線。一般的無線 AP，
都會不斷的傳輸 Beacon 封包，Beacon 封包內會包含 SSID 訊息、支援的傳輸速
率、無線 AP 的 MAC 位址等資訊，目的是為了讓 User 清楚地知道附近有哪些無
線 AP 可使用。Attacker 就利用偽造的 Beacon 封包，其中 MAC、SSID 的欄位，
皆可以偽造成合法 AP，使 User 分辨不清，造成 User 連到此 FakeAP 而無法成功
使用無線網路。當 Attacker 傳送非常大量的 Beacon 封包 flood 區域網路時，會
造成正常合法之 AP 所發送之 Beacon 都因碰撞而無法被 Station 正確解讀，因而
造成 User 很難去搜尋合法的 AP 進行連線。 
由於這三種癱瘓服務攻擊手法，攻擊者並沒有要取得被攻擊者之資訊，因此
攻擊者並不需要提供正確的MAC位置，目前網路上可以取得之攻擊程式也皆能
發送假Mac，甚至攻擊程式會先竊聽附近合法AP之MAC位置，進而偽裝合法AP
的MAC去對目標攻擊，使AP跟Station誤以為是彼此間所傳送的資訊。在切斷被
害者電腦與AP間的連線後我們就可以進行連線劫持攻擊。 
（4）Session Hijacking 連線劫持 
Session Hijacking 攻擊首先利用阻絕服務攻擊使得用戶端連線中斷，當用戶
端再次嘗詴連線時攻擊者偽裝成基地台，並且同時對於原有基地台偽裝成用戶
端。我們發現 Windows 因為設定問題，當攻擊者將 SSID 設定成和欲攻擊的 SSID
ㄧ樣的情況下，Windows 會在完全沒有通知使用者的情況下將連線離開安全
Channel，並連線到沒有加密的攻擊者頻道。如執行攻擊程式[20]內建一些常用的
SSIDs，當我們利用工具觀察到的 SSID，若是連線到該 Station 是使用 Windows XP
作業系統，我們可以發送一個特殊的封包給正在連線到攻擊者內建含有該 ESSID
之 AP 的 Station。如此ㄧ來，該 Station 就會連線到我們的假 AP。也就是入侵者
在使用者登入主機並完成身份確認後，即進行 Session Hijacking，讓合法使用者
跟主機間的連線中斷，入侵者的電腦取代合法使用者與遠端主機進行連結，由於
已完成使用者身份確認，遠端主機視入侵者為合法使用者，如此一來入侵者不必
破解任何密碼，就可以登入主機，使用屬於這個合法使用者權限的任何資源。詳
細過程如下，其圖示如圖 4： 
9 
 
 
圖 6：受害者因連線劫持與頻道 3 攻擊者 Lab214a 進行連線 
 
由於該攻擊受害者端完全沒有感覺其連線對象之改變，所測詴之使用者利用
的 XP 作業系統工作環境也沒有任何提醒，視窗連線狀態也ㄧ直維持。因此，被
害者根本沒有機會察覺其連線已經被攻擊者攔截，所有訊息都可能遭竊取，更近
一步的，其身分遭到攻擊者利用而遭受更嚴重之損失。 
但是這個攻擊手法若是AP雙方使用任一加密機制或是利用任一伺服器端的
認證手法就可以使得該攻擊手法不容易達成。然而，若是我們只是使用目前最常
見到的應用層端認證方式，並且透過 SSL 來保護傳輸訊息的方式在現行的無線
網路是否可以改善安全的程度，我們的結果似乎不是很理想。 
由於使用應用層認證機制的無線網路已經相當普及，像是台北市的 Wi-Fly、
台灣ㄧ般大學校園以及麥當勞與星巴克等店家，都有提供這類型無線上網的服
務。同樣的，若有心人士架設了一個假的 AP，並將 AP 的名稱設定為跟使用者
連到的 AP 名稱相同，由前一段文章我們知道透過阻斷攻擊後，使用者將會自動
連到這個假的 AP 上，而且使用者會以為正常連上網路而不自知，由於使用者是
透過攻擊者連到外面的網路，所有的封包都需透過攻擊者才會出去，攻擊者也可
以在此監聽所有的封包，甚至竊取帳號密碼。然而，這類型的無線網路使用者傳
輸密碼時是透過 SSL 將帳號、密碼加密後再傳出。然而這架構忽略了一點，無
線網路使用者在進行連線時必須先透過 DHCP 取得網站 IP 和 DNS 位置，若攻擊
者趁機架設假的登入網站，並將使用者導到這些假網站，即可竊取帳號密碼等重
要資料，然而該攻擊是否可以在使用者沒有知覺的情況下完成，若可以，則會對
現行的無線網路使用環境造成一些影響，因此我們下面實驗即是使用此種手法，
測詴 Windows XP 的自動連線功能是否如此的不安全。 
 
圖 7：攔截 SSL 連線範例 
圖 7 為利用 Hijacking 來獲取知名速食店的付費無線網路使用者的帳號密碼
11 
 
以 WPA-PSK 認證之 AP 權利，但依據我們實驗的結果該項攻擊確實難度較高且
成功率有限。 
3. 偵測及防禦方法 
由於這種利用組合 IP Spoofing , DNS spoofing 及 Phising 複合性的攻擊模
式，主要是利用一般移動無線網路使用者的兩個主要特性，來完成該項攻擊： 
1. 移動無線使用者在 Visiting Network 使用無線網路時，必須信賴網路服務
提供者於當地所提供之所有伺服器。如發送動態 IP 的 DHCP 伺服器、提
供 Domain 名稱和 IP 位置轉換的 DNS 伺服器、無線存取點 Access Point，
以及用以認證移動無線網路使用者的 Authentication Server。 
2. 一般使用者大都不是資訊安全專家，因此大部分的使用者都會忽略作業
系統的安全提醒，甚至看不懂作業系統的安全提醒，因而沒有意識到正在
遭受攻擊。 
3.1 偵測攻擊 
由於該項攻擊會利用偽裝的控制封包來切斷連線，以及竊取其他使用者帳號
後，登入網路使用的特性，因此我們可以利用偵測下列現象，來判斷是否遭受攻
擊，以抓取較不小心的攻擊者。 
1. 同一帳號但 MAC 位置錯誤。 
2. 同時有兩個同帳號使用者，在不同地點使用無線網路服務。 
3. 偵測異常控制封包的流量。 
3.2 降低該攻擊成功率 
為了降低這類型的攻擊成功率，我們可以從下列方向著手： 
1. 支援 802.11i，如此一來，攻擊方之控制封包需要經過認證，因此駭客不容
易利用目前常用的 Deauthentication Flood 來切斷連線，必須另謀他法。 
2. 支援 DNSSet，如此一來，攻擊方在進行 DNS Spoofing 時必須花更多的功
夫，也較不容易進行 DNS 汙染攻擊，因此較不容易被導到錯誤的登入電腦。 
3. 利用動態登入頁面，如此一來攻擊者不容易利用網頁複製軟體來模仿合法登
入畫面，因此依賴攻擊者為了欺騙利用登入畫面，確認是否到達習慣的網
站，則必須付出更大的代價。 
4. 結論 
我們探討無線網路目前存在的存取安全漏洞，對無線區域網路的存取控管安
全議題進行研究，研究現有的無線區域網路存取控管安全機制弱點，如：WEP
利用“不可交換”之事先的分享金鑰和 IV 來對使用者進行認證，以及最後的 WPA
和 802.11i 中以可交換的金鑰和 IV 搭配 passphase，來認證使用者以及 MAC 和
IP 的存取控制。甚至我們發現並驗證無線網路中，具有相當嚴重之中間人攻擊
和連線劫持並行釣魚攻擊的嚴重問題，會造成使用者在不知情的情況下，其通訊
連線會被導由攻擊者電腦來進行連線，又因為 WEP 和 WPA 之加密機制均可被
破解，且即使無線網路服務應用層認證和 SSL 加密的技術，來對通訊內容做進
一步保護，無線網路使用者之通訊內容如帳號、密碼等重要資訊仍可能會遭駭客
13 
 
[18] Ping Ding, Joanne Holliday, Aslihan Celik. “Improving the Security of Wireless 
LANs by Managing 802.1X Disassociation”, In Proceedings of the IEEE 
Consumer Communications and Networking Conference, Las Vegas, NV, 
January 2004. 
[19] R. Sekar, A. Gupta, J. Frullo, T. Shanbhag, A. Tiwari, H. Yang, and Z.S. 
Specification-based anomaly detection: a new approach for detecting network in 
trusions. In V. Atluri, editor, ACM CCS,pages 265-274. ACM,2002. 
[20] Remote-Exploit.org, “Hotspotter-Automatic wireless client penetration,” 
（http://www.remote-exploit.org/codes_hotspotter.html） 
[21] Rupinder Gill, Jason Smith and Andrew Clark. “Specification-Based Intrusion 
Detection in WLANs”, Computer Security Applications Conference, 
2006.ACSAC’06. 22nd annual. 
[22] TakehiroTakahashi, “WPA Passive Dictionary Attack Overview”. 
[23] WI-FI Alliance, “Wi-Fi is everywhere”, 
（http://www.wifialliance.org/OpenSection/pdf/WPA_NI_2003-Pres.pdf）April 
2003. 
[24] Wireless NewsFactor, “Wireless 'Smart Glass' Knows When You Need a Drink”
（ http://www.wirelessnewsfactor.com/perl/story/17133.html） 2000. 
[25] WNN Wi-Fi Net News, “Weakness in Passphrase Choice in WPA Interface”, 
（http://wifinetnews.com/archives/002452.html）November 2003. 
 
與會者交流許多有關認證協定和無線網路安全之最新技術和研究狀況。對於日後進行無線網路安全
相關研究之發展有相當大的幫助。另外，與會期間與多名無線網路安全作者討論 Wireless Session 
Hijacking 的研究與計畫推動的進度，許多與會學者對於我們無線網路安全研究和實驗成果也相當
感興趣，對於我們在 Wireless Security 方面的研究進度有相當深刻的印象。 
 
99 年度專題研究計畫研究成果彙整表 
計畫主持人：楊明豪 計畫編號：99-2219-E-033-001- 
計畫名稱：利用 Wisec 平台研究與實做無線區域網路資料竊取弱點 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 1 1 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 6 3 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 3 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 2 0 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
 
