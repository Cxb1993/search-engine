出新穎的類神經網路模組。它具備有非對稱
之平行處理能力、網路元件全域互動特性和
連續時間之動態特性等等。除了在控制、語
音辨識、影像處理等等應用外，也有許多學
者致力於演算法的改進以及在硬體上的實
現。 
類神經網路起源於 1950 年代後期，由
Frank Rosenblatt 發 明 的 感 知 機 網 路
（Perceptron Network）和聯想式學習法則
（associated learning rule）是首先實際應用於
圖形辨認的系統[1]，同時由 Bernard Widrow 
和 Ted Hoff 引入一個新的學習演算法，使用
在適應性的線性類神經網路上（adaptive 
linear network）[2]。只是前兩種方法有共同
的限制，只能應用在線性可分離的問題上
[3]，因此類神經網路的研究遇到了瓶頸，直
到 1980 年代此一障礙才被克服，由 John 
Hopfiled 提出遞迴網路（recurrent network）
[4]，David Ramelhart 和 James MaClelland 提
出 的 倒 傳 遞 演 算 法 （ Backpropagation 
algorithm），解決了之前學者遇到的線性不
可分離的問題[5]。 
在同時，也有許多研究運用類神經網路
理論去探尋新的應用領域：例如不具學習能
力之數位影像處理便可藉由一種平行時空轉
換的多層神經網路來達成目標[6]。西元 1988 
年，美國加州大學蔡少堂教授 ( L. O. Chua ) 
等人所提出的細胞類神經網路 ( Cellular 
Neural Networks ) 就是一個成功的範例
[7]-[8]。因為它具有連續時間的動態特性和平
行處理的能力，所以非常適合應用在許多即
時影像處理的領域[9]-[12]。CNN 是一種能高
速並行處理的大規模非線性模擬網路，易於
VLSI 的實現，這些並行優點的運算研究得到
了人們越來越多的關注。 
CNN 是一個非線性動態陣列，它延伸的
版本 CNN universal machine (CNN-UM)被發
表在西元 1993 年[13]。CNN-UM 對於二維的
Spatio-temporal 動態與影像的問題可以被非
常有效地運算。細胞類神經網路的結構有規
則性、平行陣列化與區域連結等特性，適合
處理一些有區域規則性連接的特定演算，此
一特性適合於模組式硬體上實現。我們可以
把一些不含大量知識庫與記憶單元的影像處
理，透過細胞類神經網路作平行處理之電路
實現，以協助計算機進行後續的深入分析。 
Fuzzy cellular neural network 
(FCNN)[14]-[15]是一個由基本的 CNN 結合
模糊集合(Fuzzy set)[16]運算而產生出來的網
路架構。在[17]，FCNN 利用乘法器透過可調
整的權重(Template)與輸入的 and/or 輸出來
實現 Fuzzy 邏輯的”Sum of product”。並且可
以利用這個結構實現平面結構元素的數學型
態學(Mathematical morphology)[18]-[19]。 
在影像處理時，每張圖像都會有非常大
量的像素值必須被輸入到 FCNN 作相關地運
算處理，這般地動作若是在平行處理的硬體
上實現，必定可以大大地減少在軟體上運算
所消耗的時間，也能符合市場設計需求平行
處理的高度運算的效能，所以在本計劃中，
為了執行速度的考量以及成本上的降低，我
們選擇以硬體來實現 FCNN 的運算，並且應
用在影像處理中。 
在硬體實現方面而言，由於晶片設計的
工具發展成熟以及單一晶片所包含的邏輯閘
數目大幅增加，利用可程式邏輯元件 (如
FPGA、CPLD 等)[20]-[21]就可以在一個系統
單晶片上整合了 CPU、記憶體、I/O 裝置、
時脈管理等系統，並且進行大規模可重複配
置的邏輯設計。場效可程式化的閘陣列 
(Field Programmable Gate Array 簡稱 FPGA) 
是一種在研發現場可立即規劃的多功能元
件；其內部是由許多邏輯閘及正反器(Flip 
Flop)所組成，只要程式符合特定要求，經過
一定程序的規劃燒錄後，就可以完成一顆具
有該運算功能的 IC，一旦發現有瑕疵時可立
即修改程式，因此可以縮短產品開發時間。
我 們 可 以 把 FPGA 當 作 特 殊 應 用
IC(ASIC)[22]製作前的設計原型，提供 IC 設
計模擬與 debug 的機會，這些設計理念對於
從圖三的狀態圖可以得知，從 CNN 輸出
的回授效應主要是受到 template A 的影響，
所以 template A 稱之為回授運算因子
(feedback operator)。CNN 輸入的控制效應則
是受到 template B 的影響，因此 template B
稱作控制運算因子(control operator)。兩個
template 可以依照使用者對圖像所要求的目
的不同，而加以調整矩陣內的數值大小。 
圖三、CNN 的動態路線狀態圖 
為了讓類神經網路可以更適合在硬體
(FPGA)上實現，我們可以透過尤拉公式
(EULER)，將類神經網路複雜的狀態方程式
分解成兩個比較簡單並且運算模式相同的部
份分別地去完成。首先，以輸入變數 klu 、權
重、偏壓值 z 以及時間常數 h 來產生變數 G。 
∑ +′=
ijur
W
ijklkl hzuBG
               
(3)
 
接著透過相同的計算模組，則新的狀態
變數的新數值就可以被計算出來。 
∑ +′=+
ijxr
W
klklij GyAtx )1(
         
(4)
 
上述所描述的權重矩陣是加入時間上的
考量後所定義的， A′ 與 B′ 分別是代表
template A 與 template B 乘上時間常數 h。使
用這個 EULER 的方式修改我們的狀態方程
式就可以更簡易以及使用更少的硬體成本資
源來實現 CNN。 
 
3.2 模糊細胞類神經網路(Fuzzy Cellular 
Neural Networks)架構 
模糊細胞類神經網路 (fuzzy cellular 
neural networks, FCNN )是一種結合模糊邏輯
(Fuzzy logic)理念進入傳統細胞類神經網
路，並且保留它的局部互相連結 (local 
interconnectivity) 的特性。每一個細胞在
FCNN 中都含有模糊運算的能力，但是整體
網路是 CNN 運算法則所管理的。接著我們利
用此結構來完成平面結構元素的數學型態學
運算。 
一個基本的數學型態學的運算包含了有
腐蝕 (erosion)、擴張 (dilation)、斷開運算
(opening)、閉合運算(closing)等四種型態。在
圖像中為了取得目標物的輪廓、骨架以及消
除不必要的雜訊，我們會透過以上方法的四
種型態去達成。 
它們的數學定義為 f: X→E 與  s: 
S→E ，E 代表是代表灰階圖像的範圍，X 代
表是灰階圖像的像素值，S 代表是權重結構
元素。E 被正規化在 0 到 1 之間。 
對於灰階的圖像而言，它們的數學表示
式如下[23]: 
灰階侵蝕: 
XӨS = min{f(x+z)–s(z)}           (5) 
For all z∈S and x+z∈X. 
灰階擴張: 
X ♁ S = max{ f (x-z) + s(z)}       (6) 
For all z∈S and x-z∈X. 
灰階斷開: 
 X 。 S = ( X Ө S )♁ S            (7) 
灰階閉合: 
X ․ S = ( X ♁ S )Ө S            (8) 
 
接著我們將透過 FCNN 的運用來完成數
學型態學的 erosion、dilation : 
.1,1,
)),;,(()),;,((
),;,(),;,(1
),(
max
),(
min
),(),(
NjMi
ulkjiBulkjiB
ulkjiBylkjiAx
Rdt
dx
C
jiNC
klf
jiNC
klf
jiNC
kl
jiNC
klij
x
ij
rklrkl
rklrkl
≤≤≤≤
++++
++−=
∈∈
∈∈
∑∑
UI
～～
       (9) 
為了要達到 erosion 運算的結果，可以
將它的參數設定為 
SBRIBA fx −===== min,1,0,0,0   (10) 
在這個結構中，我們不需要用到權重值
圖五、FCNN 處理器核心架構 
 
五、範例說明 
在影像樣本中，如果有雜訊將會導致不
必要的連接或會切除掉字體的結構，但是增
強後續的修補是困難的，不過卻能使字體結
構更好識別。所以我們以 FCNN 細胞和細胞
之間的局部互相連結特性為目的，並且改進
處理器的速度並實現 FCNN 在硬體上。 
 
圖六、英文字"A" 
 
圖七、中文字"王" 
例子中為了移除雜訊我們使用兩張
64*64 像素值大小的樣本，包括英文字”A”和
中文字”王”。另外，FCNN 硬體實現區塊的
步驟如圖五所示，而參數Ｓ和前面章節是相
同的，添加的白高斯雜訊包括零平均和誤差
σ = 0.3。對於描述和設計數位電路來說
VHDL 是非常受歡迎的硬體描述語言。所以
我們使用VHDL硬體描述語言實現在 INTEL 
PENTIUM 4 1.6GHz 平台上，並使用 Xilinx 
ISE 6.2i 發展軟體來證實電路功能的正確
性，使用的晶片型號為 Virtex2 
xc2v8000-5ff1152，10bits 的精確度。 
原始影像英文字"A"和中文字"王"如圖
六和圖七所顯示。圖八(a)和(c)分別顯示
FCNN硬體實現英文字"A"和中文字"王"的結
果。圖八(b)和(d)分別顯示 FCNN 軟體實現英
文字"A"和中文字"王"的結果。其中軟體完成
所花費的時間成本為 2.7 秒，而硬體所花費
的時間成本為 10.6 毫秒。明顯地，硬體實現
的執行速度遠比軟體實現來的快。 
由最後結果所知，硬體實現移除雜訊的
速度不僅比軟體實現來的快，而且我們可以
調整參數Ｓ和準確度使得硬體更加有效的逼
近軟體。 
  
         (a)                   (b) 
   
(c) (d) 
圖八、(a)和(b)分別表示硬體實現和軟體實現英文字
"A"。(c)和(d) 分別表示硬體實現和軟體實現
中文字"王" 
 
七、結論 
數位積體電路使用 FPGA 發展使得硬體
設計處理更加的有靈活性和可程式化。因
此，我們在 FPGA 上實現了可以處理灰階數
學型態學的 FCNN 處理器陣列。經由兩個例
子的實驗結果可以得知，我們利用 FPGA 實
現型態學的運算器能夠得到適當的效能。除
此之外，我們能夠調整參數 S 和精確度來使
得硬體能夠更有效的逼近軟體，以及得到更
快的運算效率。 
