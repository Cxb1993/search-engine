  i
摘要 
即時結構健康監測系統(Structural Health Monitoring,SHM)應用在
土木結構上需要具備大量的感測器與無線節點，而這些感測器與無線
節點所組成的感測節點必須提供高可靠度以及佈署生命週期長的能
力。當無線感測元件的價錢變得低廉而包裝更加輕薄短小時，感測元
件微小化大幅縮小感測器的體積，進而提供電子感測器應用於土木結
構監測上的新契機，使用輕薄短小的感測器鑲嵌於土木結構中不易被
發現並且更加適用於監測每天的環境變化應用上。現今的無線感測網
路(Wireless Sensor Network,WSN)技術具備了高效率、實用性及高可
靠度等特性對於結構監測應用方面提供了一項解決方法，然而，在實
際的土木結構監測會產生大量的資料，如何可靠地做資料處理以及良
好的網路平台對於結構健康監測的應用是極為重要的課題與挑戰。結
構健康監測應用的主要技術為建構一可靠度高且性能優越的資訊中
介軟體以及無線感測網路系統平台，本計畫的重點在於發展整合無線
感測網路於土木工程應用的關鍵技術。 
在本計畫中，透過開發無線感測網路的網路架構與中介軟體，來
建構一套應用於異質網路平台的及時結構健康監測系統，設計及實現
感測器韌體與網路中介軟體技術於無線感測網路的智慧型系統平台
是我們主要的研究方向，系統中網路閘道器必須具備獨立且高度整合
異質網路的能力。針對實用性質的考量，本系統結合加速度感測器以
及全球衛星定位系統於本發展系統，中介軟體主要是過濾與預先處理
接收自 ZigBee 感測節點所傳送過來的資料，並且擷取出有效的資訊
轉存至系統資料庫中，此外，GPRS 模組可以大大提高資料傳輸距離，
GSM 模組的傳送簡訊工作讓警報功能更加完整。建構完整的無線感
測網路系統需要透過整合 ZigBee 感測網路、GPRS 與 GSM 模組。本
  iii
Abstract 
The real-time structural health monitoring (SHM) system of civil 
engineering requires the more reliable and more prolonged lifetime 
deployments for potentially a very large number of wireless sensor and 
actuator nodes. As the wireless sensing components become cheaper and 
smaller, these miniaturized nodes offer the opportunity for the electronic 
sensor to be embedded unobtrusively into the civil structure and everyday 
environments. At present, the wireless sensor network (WSN) provides 
the characteristics of an effective, feasible and fairly reliable monitoring 
system which gives the total solution for structural health monitoring 
applications. However, the monitoring of civil structures generates a large 
amount of sensor data that is used for structural abnormality detection so 
that the reliable data processing and fine networking platform are the 
important issues and challenges for SHM applications. Therefore, the key 
factor for SHM applications is to construct the integrated, reliable and 
high-performance information middleware and system platform of 
wireless sensor network. This paper is devoted to develop the key 
integration technologies of wireless sensor network in the civil 
engineering application. 
In this project, the networking architectures and information 
middleware of wireless sensor networks are developed to construct the 
heterogeneous information system platform for the real-time structural 
health monitoring application. The design and implementation of sensor 
firmware and networking middleware are the key study topics for 
WSN-based intelligent system platform. The networking gateway of 
system platform must be developed the independent and highly 
interoperability to integrate the heterogeneous networks. The application 
study combined with vibration sensing and GPS positioning is used to 
  v
目錄 
摘要............................................................................................................. i 
Abstract ..................................................................................................... iii 
目錄.............................................................................................................v 
表目錄...................................................................................................... vii 
圖目錄..................................................................................................... viii 
(一) 前言 ....................................................................................................1 
(二) 研究背景與目的................................................................................1 
(三) 文獻探討 ............................................................................................2 
(四) 系統概述 ............................................................................................4 
(五) 研究方法 ............................................................................................5 
5.1 ZigBee 無線網路系統..................................................................5 
5.1.1 ZigBee 無線網路系統之通訊協定 ..................................6 
5.1.2 ZigBee 無線網路系統之網路拓樸 ..................................9 
5.1.3 ZigBee 的應用層.............................................................10 
5.1.4 ZigBee 的應用.................................................................10 
5.2 MSP430 微處理器 .....................................................................10 
5.3 加速度計感測器 .......................................................................12 
5.4 GPS 全球衛星定位系統 ............................................................14 
5.4.1 GPS 誤差來源 .................................................................15 
5.4.2 GPS 接收儀輸出資訊 .....................................................16 
5.5 無線感測網路系統設計 ...........................................................19 
5.5.1 ZigBee Module ................................................................19 
5.5.2 GPRS Module ..................................................................21 
5.5.3 GSM Module ...................................................................22 
  vii
表目錄 
表 5.1  GPS 感測器規格表 ..........................................................17 
表 5.2  NMEA 資料格式.............................................................17 
表 5.3  GPRMC 資料格式 ...........................................................18 
表 5.4  IP-Link 2220 規格表 ........................................................20 
表 5.5  GPRS Module(MA8-6)規格表 ........................................22 
表 5.6  GSM Module 規格表 .......................................................23 
表 5.7  GPS 封包資訊 ..................................................................28 
表 5.8  3dB 頻寬時 CX、CY與 CZ容值對照表 ..........................29 
表 5.9  NADC與 g 值對應表 .........................................................32 
表 5.10  MSP430F449 韌體規劃功能設定表 ...............................37 
 
  ix
圖 5.25  韌體界面架構圖 ..............................................................35 
圖 5.26  韌體界面設計流程圖 ......................................................36 
圖 5.27  中介軟體界面 ..................................................................38 
圖 5.28  Middleware 資料處理流程圖 ..........................................40 
圖 5.29  傳送簡訊界面流程圖 ......................................................41 
圖 5.30  監控中心系統設計 ..........................................................42 
圖 6.1  ZigBee 無線網路架構......................................................43 
圖 6.2  節點 2 到節點 22 之路徑 ................................................44 
圖 6.3  節點 22 到節點 33 之路徑 ..............................................45 
圖 6.4  節點 22 到節點 33 之路徑 ..............................................45 
圖 6.5  無線感測網路節點電路示意圖 ......................................46 
圖 6.6  感測器與無線網路節點 ..................................................47 
圖 6.7  Middleware 接收 IP-Link 2220 的資料 ..........................48 
圖 6.8  Middleware 接收 IP-Link 5501 傳送的資料 ..................49 
圖 6.9  Middleware 接收 GPRS 傳送的資料 ..............................49 
圖 6.10  中介軟體界面 ..................................................................50 
圖 6.11  資料庫中三軸資料 ..........................................................51 
圖 6.12  資料庫之 GPS 資料 .........................................................51 
圖 6.13  系統監控中心界面 ..........................................................52 
圖 6.14  監控中心界面-GPS 感測資料.........................................53 
圖 6.15  UrMap 地圖定位資訊......................................................53 
圖 6.16  監控中心界面-ADXL330 感測資料...............................54 
圖 6.17  X 軸加速度值大於 2g .....................................................55 
圖 6.18  手機簡訊畫面 ..................................................................55 
圖 6.19  資料庫查詢界面 ..............................................................56 
  1
(一) 前言 
台灣的自然風光舉世聞名，然地理位置相當特殊，地處於太平洋
的菲律賓海板塊與歐亞大陸板塊交界之處，為現今世界上有感地震發
生最頻繁的地區之一，經常帶來人民無法預期的恐懼與災變，且由於
氣象緯度處於副熱帶季風區，每年 5～6 月間會梅雨季節，7～10 月
間則有颱風之侵襲，由於氣候特殊且無自然地形地物之屏障，經常帶
來豪雨，加上地形陡峻，河水喘急，以致常引發嚴重水災。然而，無
法預測的天災常常導致人民生命財產嚴重的傷害與損失。所以，社會
各界對於災害防治的問題一向耿耿於懷，近年來，政府與民間都積極
投入於防災救災的預防工作，雖然國內經濟發展突飛猛進，但是由於
社會與政治之變遷快速，使得目前的防災救災的工作勢單力薄，力量
有限。而隨著人民知識與生活水準的日益提昇，自我意識亦隨之提
昇，政府應積極強化對人民生命財產安全的保護，以符合世界局勢與
潮流。是以，政府應儘速研訂具體有效的防災救災對策，積極結合產
官學界之資源，以台灣目前之科技優勢，研究發展下一代智慧型防災
預防與警報系統，並有效加強與落實防災科技研究成果於防災救災之
預防工作，進而保障人民生命財產之安全。因此，整合先進科技的『智
慧型防災與預警系統』之研究與開發將是未來確保人民生命財產的重
要課題。 
(二) 研究背景與目的 
近年來天候異常現象日益加劇，地震、水災、風災、土石流等天
然災害頻傳，對人們的生命財產造成許多嚴重的傷害。因此在諸如地
震、颱風、土石流等災難發生前後，對大地、環境、建築結構、橋樑、
等進行健康之診斷與評估更是目前重要的研究工作之一，尤其是特定
  3
路在發展的初期一度受到阻礙，但，隨著製程改良、積體電路技術成
熟與微機電系統迅速發展，至今已可以將類比與數位電路、微處理
器、無線傳輸模組及感測器整合於一顆系統晶片上，也使得無線感測
器網路技術越來越受到矚目與重視。無線感測器網路主要是由數個到
數千個智慧型嵌入式感測器節點(Smart Sensor Node)簡稱感測器節點
(Sensor Node)以分散的方式搭配可移動式基地台所形成的無線網路
系統[6]。而建構成無線感測網路的最基本單元為感測器節點，此感
測器節點除了能夠感測本身週遭環境的狀態之外，亦能夠在該網路中
與其他感測器節點利用相互合作的方式增加系統整體監控的範圍以
及提高其精確度，甚至可做為離基地台較遠的感測器節點傳送資訊的
路由中繼站等。建構無線感測網路系統所需要的感測器節點各數非常
具有彈性，可視實際應用情況來適當的調整感測器節點個數，除了符
合低成本效益之外，亦具有偵測錯誤容忍的能力及網路部署容易等特
性。 
國外對無線感測應用於結構監測方面有不少相關研究，Lynch[7]
等提到無線感測的監測技術除了可以降低成本，並且可以使監測系統
更加的彈性化，將原本資料中心計算的工作平均分給各單元的感測器
做平行運算使得即時的監控系統得以實現，其中，Xu 等人(Xu et al.)
設計了一個名為 Wisden 的無線感測網路系統用來收集結構的狀態資
料，並且利用以小波為基礎的壓縮方法來克服低電源無線感測訊號頻
寬現制的問題。Kurata 與 Spencer 等人(Kurata et al.)以 Berkeley Mote 
platform 為平台應用於建築物之風險監測，並以兩層樓之鋼架來測試
其效能，在實驗中測試了加速度感測器與 Berkeley Mote platform 無線
傳輸之效能。在感測器的開發上，Lynch 等人(Lynch et al.)設計了一個
高性能平面壓阻式之加速度微感應器，利用此壓阻式微感應器可用來
  5
警報功能讓監控系統更加完善。再者，無線感測節點透過無線網路傳
送到監控端的資料，必須藉由中界軟體的介面設計達到整合異質網路
的功能，中界軟體還要負責把感測器的資料作適當的過慮以及處理，
才能轉存至系統資料庫中，並且提供正確的資料顯示在監控中心界面
上，讓使用者可以透過監控中心做遠端監控工作。完整的系統架構如
圖 5.1 所示： 
 
圖 5.1 系統架構圖 
(五) 研究方法 
5.1 ZigBee 無線網路系統 
早在 1998 年，類似 ZigBee 規範構想的雛型就已經被提出，之
後就有許多工程師企圖在 Wi-Fi 或 Bluetooth 架構上建立無線監控
的相關應用，但結果發現，不論低階或高階的通訊協定規格都不適
用，因此即以 Bluetooth 為藍本，修改為適合監控應用條件的規格，
並成立了 ZigBee 聯盟，共同討論與制定相關規格，企圖建立全球第
一個在監控應用的共通高階通訊標準。ZigBee 聯盟計畫訂定的網路
層 (Network) 、安全層 (Security) 與應用介面層 (API) 等高階通訊
  7
ZigBee 的實體層包括了所謂的 PHY 層和 MAC 層，在 PHY 層提
供了 PHY 的數據服務和 PHY 的管理服務。PHY 的數據服務能夠穿
過實體層的無線頻道來執行 PHY 協定數據單元的傳送和接收。PHY
的管理服務連結於實體層管理實體。 PHY 的特色包括無線傳送的啟
動和停止、能量檢波、連結品質指示、頻道的選擇、清除頻道的評價、
穿過實體層中傳送及接收封包。 
ZigBee 可以操作在三種許可的自由工業、科學、醫療的頻段
（ISM）。在 2.4GHz 的頻寬可適應 250kbps 的傳輸速率，在 915MHz
的頻寬可適應 40kbps 的傳輸速率，在 868MHz 的頻寬可適應 20kbps
的傳輸速率。共27個頻道分配在 802.15.4裡，包括 16個頻道在 2.4GHz
頻帶，10 個頻道在 915MHz 頻帶，和 1 個頻道在 868MHz 頻帶[12]，
其中 ZigBee 溝通的頻道結構展示在圖 5.3。 
 
圖 5.3 ZigBee 溝通的頻道結構(節錄自[12]) 
ZigBee 採直序展頻技術（DSSS），使一個位元的訊號，利用較高
碼率的展頻序列，在發射端將訊號擴展為較寬的頻譜，使得原來高功
率、佔較窄頻譜的訊號，變成低功率、寬頻譜的訊號，可使訊號在無
線傳輸中保持完整，並且確保同時在不同頻段傳輸的訊息不會互相干
  9
強，可通過網路連結做遠端的控制，具可靠性、網路化、保密性、全
球化應用、低傳輸速率、低耗電(電池可用十幾個月，甚至到三年)、
低成本、反應時間快等優勢，成為主流趨勢。 
5.1.2 ZigBee 無線網路系統之網路拓樸 
ZigBee 網路層協定的目的為提供可靠和安全的傳輸，在網路層中
ZigBee 提出三種網路拓樸，即星狀(Star topology)、樹狀(Tree topology)
以及網狀(Mesh topology)網路，一個 ZigBee 協調者(ZigBee coordinator)
負責初始、維持及控制網路。ZigBee 的星狀網路類似於 IEEE 802.15.4
之星狀拓樸，裝置能與一個網路協調者傳送以及接收資料。而對樹狀
和網狀網路來說，裝置彼此間用多點跳躍(Multihop)模式溝通(類似於
無線隨意網路)，樹狀以及網狀網路的骨幹(backbone)是由一個 ZigBee
協調者以及眾多 ZigBee 路由器(ZigBee router)所構成，RFD 可以透過
ZigBee 協調者或 ZigBee 路由器加入網路作為 ZigBee 末端設備
(ZigBee end device)[9]。ZigBee 網路拓樸概念圖如圖 5.4 所示。 
 
圖 5.4 ZigBee 網路拓樸[15] 
 
 
  11
¾ 8 個通道的 12-bit ADC，其轉換速率最高可達 200ksps。 
¾ 計時器 B 可做 8~16-bit 計時/計數器，包含 7 組抓取/比較暫
存器。 
¾ 內建獨立的硬體乘法器，提供高速的乘加運算以支援數位信 
號處理的需求。 
本計畫實現韌體所選用之微處理器為 MSP430 系列裡的
MSP430F449，它是 MSP430F44x 三個成員中規格最高的微控器，
MSP430F449 的功能方塊圖如圖 5.5 所示，以輸入/輸出埠而言，包含
了六組 I/O 埠(Port1~Port6)，足夠讓我們來使用，並都具有獨立設定
接腳輸入/輸出方向、輸出準位的功能。有兩組計時器(Timer A、Timer 
B)，十二位元多通道類比/數位轉換器以及兩組串列傳輸介面等。具
有高達 100 隻 I/O 埠接腳，圖 5.6 為 MSP430F449 之腳位圖。所撰寫
的程式可經由 MSP430F449 發展工具，在 PC 上處理後，經組譯、連
結、除錯後，PC 端經由 JTAG 下載程式至 MSP430F449 微處理器中
以進行控制。 
 
圖 5.5 MSP430F449 功能方塊圖(節錄自[16]) 
 
  13
介於 0.5Hz~550Hz 之間。 
 
圖 5.7 ADXL330 電路架構圖(節錄自[18]) 
我們使用的 EVAL-ADXL330Z 為 Three-Axis Accelerometer 
Evaluation Board，在此評估板上已經規劃好三軸的輸出頻寬，在
XOUT、YOUT與 ZOUT輸出腳位上都連接一顆 0.1uF 之電容至 COM 腳，
來降低頻寬為 50Hz[18]，其電路圖如圖 5.8 所示： 
 
圖 5.8 EVAL-ADXL330Z 電路圖(節錄自[18]) 
 
EVAL-ADXL330Z 評估板實際大小只有 20mm×20mm，有六支腳
位可供使用，如圖 5.9 所示。當它操作在 3.6V 時，output sensitivity
是 360mV/g，一般情況下 0g 值會等於操作電壓值的一半。 
  15
出衛星星曆、衛星時錶修正值及電離層修正係數等等，同時傳回
衛星，如此衛星便可將修正的導航訊息廣播給使用者。 
(3) 使用者接收儀：追蹤 GPS 衛星，並即時地計算出接收儀所在位置
的座標、移動速度及時間。接收儀可分單頻跟雙頻兩種，雙頻接
收機可消除大部分電離層效應，但較為昂貴，不普及。一般使用
者為單頻接收儀[20][21]。 
5.4.1 GPS 誤差來源 
GPS 誤差來源相當繁多，大致可分為衛星偏差、觀測偏差及觀測
相關之偏差等三類[22]： 
(1) 衛星偏差包含由衛星實際運行之軌道或瞬間位置與導航訊號中
廣播星曆之軌道預估資料間的星曆誤差，以及衛星上之時鐘與全
球定位系統時鐘的時表偏差。 
(2) 觀測偏差即為接收機時鐘與全球定位系統時鐘的時表偏差。 
(3) 觀測相關之偏差包括以下四種： 
(a) 多路徑效應(Multi-Path Effect) 
因 GPS 訊號在傳遞過程中，因接收器附近有障礙物，如：
高樓、樹木等等，使訊號產生多次折射，經過兩條以上的
不同路徑到達接收儀，而影響解算精度。 
(b) 遮蔽效應(Mask Effect) 
因接收儀所在環境或地形限制，而造成無法接收部分，甚
至全部衛星訊號，而無法定位。此時可能需要其他輔助設
備，來接替 GPS 定位。 
(c) 對流層與電離層傳播延遲 
衛星訊號在傳播過程中，經過大氣層時受到電離層與對流
層折射之影響而產生傳播延遲。延遲修正的大小與衛星的
  17
表 5.1 GPS 感測器規格表 
 
表 5.2 NMEA 資料格式 
NMEA 資料格式 說明 
GGA 位置資訊 
GLL 地理位置-經度及緯度 
GSA GNSS DOP 
GSV 當前 GPS 衛星狀態 
RMC 最簡特性 
VTG 對地方向及對地速度 
其發送到電腦的資料主要有封包頭，封包尾和封包內資料所組
成，依據資料封包的不同，封包頭也不相同，主要有$GPGGA、
$GPGSA、$GPGSV 以及$GPRMC 等，這些封包頭標識了後續封包內
  19
5.5 無線感測網路系統設計 
在無線感測網路系統的硬體架構上，我們選擇 Helicomm 科技公
司所開發的 ZigBee 模組、GPRS 模組及 GSM 模組來作為開發套件。 
5.5.1 ZigBee Module  
Helicomm 科技公司所提供的 IP-Link 2220 ZigBee Module 如圖
5.11 所示，在硬體上提供了工業標準的 RS-232/RS-485 介面，通訊部
份則使用標準 802.15.4 方式來傳遞，其工作頻率在 2.4GHz unlicensed 
ISM 頻段，提供 250kbps 的最大資料速率及範圍為-15dBm 至 10dBm
的可编程發射功率，硬體 MAC 提供 32、64、128 位元 AES 數據
加密和認證。同時透過 Mesh、Star、Cluster-tree 等彈性網路拓撲，更
提升網路的信賴度，在序列埠提供 2560byte 的 Buffer，每一筆資料的
封包大小為 100byte，充分滿足各種不同短距離無線應用的需求[23]，
其規格整理如表 5.4 所示。 
 
圖 5.11 IP-Link 2220 
 
  21
5.5.2 GPRS Module 
GPRS Module(MA8-6)如圖 5.13 所示，可透過 GPRS 網路來連結，
亦可藉由 GPRS 網路的特性來傳送資料或是將資料與 Internet 連接，
硬體亦提供標準 RS-232/RS-485 介面及 Digital Input/output 介面，可
以與各式設備結合，包含與 ZigBee Module 的 Master 節點連接，進
行與短距離無線資料傳輸搭配整合，其基本規格如表 5.5 所示。 
 
圖 5.13 GPRS Module(MA8-6) 
 
 
 
 
 
 
 
 
 
 
 
 
 
  23
 
圖 5.14 GSM Module 
表 5.6 GSM Module 規格表 
 
5.5.4 無線感測網路系統架構 
在無線網路系統架構中，基本的組成包含：ZigBee module、GPRS 
module、GSM module、Gateway 以及 Middleware 等，依據無線感測
網路佈建環境需求，我們考慮兩種無線網路的傳輸系統：第一種為單
純ZigBee網路架構的無線線網路系統；第二種為結合ZigBee與GPRS
網路架構的無線網路系統。由於 ZigBee 傳輸屬於短距離無線傳輸模
  25
ZigBee Module
ZigBee Module
ZigBee Module
GPRS Module
Internet
Database
RS-232
Gateway+Middleware
ZigBee Module
GSM Module
 
圖 5.16 ZigBee 結合 GPRS 無線網路架構 
感測器網路是由一大群數量的感測器節點所組成的，這些感測器
節點都密集地部署在區域裡面，它們可以應用於監控或觀察，感測器
節點它們本身由 4 種不同的元件所組成，分別為感測單元、處理單
元、電力供應單元以及傳輸單元。感測部份包括有紅外線、聲音、溫
度等等[24][25]，在本計畫中感測單元使用 GPS 感測器與三軸加速度
感測器，搭配 MSP430 做為處理單元，與 ZigBee module 連結為一組
感測器節點，結合無線網路即建構出完整的無線感測網路系統，最後
透過 ZigBee module 使用 RS-232 方式和電腦做資料傳輸，或者藉由
GPRS module 使用無線傳輸再透過 Internet 方式和電腦做資料傳輸，
完整的架構如圖 5.17 所示。 
MSP430
Three-Axis 
Accelerometer
GPS
ZigBee Module
ZigBee Module
ZigBee Module GPRS Module
Gateway+Middleware
ZigBee Module RS-232
 
圖 5.17 無線感測網路架構  
 
  27
(3) 電力供應單元(Power Unit)：電力供應單元負責供應感測器所需要
的電源的元件，若沒有電力供應單元，則感測器就無法工作，所
以電力供應是很重要的。 
(4) 處理單元(Processing Unit)：處理單元可以分成處理區塊(Processor)
和儲存區塊(Storage)這兩部份，處理區塊的功能就是像是電腦中
的中央處理器(CPU)，負責執行使用者下載到處理元件的程式
碼，去分配記憶體中存放感測器數據的空間位置，還有初步分析
數據以及處理數據的動作，把部分資訊進一步顯示於 LCD 顯示
螢幕上，並且要把記憶體內存放的資料傳送給 ZigBee module 然
後傳回電腦主機。儲存區塊的功能就像是一般個人電腦中硬碟等
儲存裝置，在微處理器內就是提供使用者可自行規劃的資料記憶
體(RAM)，主要是儲存經過 A/D 轉換過後的資料，以及儲存在處
理元件中一些需要暫時保留的資料。 
5.6.2 GPS 感測器設計 
GPS 感測器所傳送出來的資料是 ASCII 碼，所以使用電腦上的超
級終端機就可以看到 GPS 封包內之資訊，我們可以看到 GSA、GGA、
RMC、GSV 與 PSRF151 這五個封包資料，其中 PSRF151 封包是屬於
NMEA 所制定的輸入資訊封包，主要的功能是用來控制接收器，並
不具有定位資料，除了 PSRF151 封包之外，每個封包分別帶有不同
的定位資訊，如表 5.7 所示，會發現有些封包內的資訊是相同的，例
如：帶有時間資訊的封包包括 GGA、GLL 以及 RMC 三個封包，如
此設計是為了方便使用者在作定位功能時能更快速地達到定位功
能，不必等到同樣的封包出現，就可以從其他的封包取得同樣的資
訊。由於我們在感測網路節點端加上一個 LCD 模組來顯示所取得
GPS 定位資料，顯示的資料包含時間、經度與緯度，設計上選擇 GGA
  29
 
把不同電容值帶入上式，方可求得所對應的-3dB 頻寬，表 5.8 為
-3dB 頻寬時與 CX、CY與 CZ的對應表。 
 
表 5.8 3dB 頻寬時 CX、CY與 CZ容值對照表 
 
典型的 ADXL330 雜訊為： 
 ( ) ( 1.6)Noise rms Noise Density BW= × ×  
當頻寬 BW 設定在 50Hz 時，X、Y 軸的 Noise Density 為 280 ug/√
Hz rms，Z 軸的 Noise Density 為 350 ug/√Hz rms，帶入上述方程式，
可以求得加速度感測器的雜訊為： 
X,Y 軸：280 1.6g BW
Hz
µ × ×  2.504mg≅  
Z 軸：350 1.6g BW
Hz
µ× × ×  3.13mg≅  
實際使用示波器所量測 ADXL330 三軸之輸出波形，在 ADXL330
操作於 3.6V 的工作電壓下，X、Y、Z 三個軸的波型如圖 5.19、5.20、
5.21 所示，看似穩定的電壓輸出，其實包含了很多微量的脈波，波動
範圍大約在 40mV~100mV 之間，遠大於理想值的 noise 範圍，這樣的
現象會影響 ADC 轉換數據有較大幅變化的結果。 
  31
 
圖 5.21 Z 軸輸出波形 
以 3.13mg 的 noise，相較於系統解析度 2.4mg/scale，是會造成一
些數值上的波動，即使 MSP430F449 的 ADC 本身準確度有±1LSB 的
誤差範圍，MSP430F449 的 ADC 之解析度為 1 個 LSB，即△NADC=LSB
值－0＝1－0＝1。以滿刻度電壓(參考電壓)為 3.6V 來計算，代入下列
公式可求出轉換解析度電壓△VIN： 
33 .6 ( 4 0 9 5 ) 3 .6 (1 4 0 9 5 ) 0 .8 7 1 0 0 .9IN A D CV N m V
−∆ = × ∆ ÷ = × ÷ = × ≅  
只要 ADC 轉換迴路中任何一處發生≥0.9mV 的電壓變動便會造
成轉換數值的變動。要產生 0.9mV 電壓變動其實是很容易的，但是
考慮了 noise 進來後，這樣的誤差就沒有太大影響，因為 noise 的干
擾值大於 ADC 之解析度[26]。 
ADXL330 有三軸的類比訊號輸出，MSP430F449 的 ADC 必須規
劃三個通道來達成三軸的電壓轉換，MSP430F449 的 ADC 為 12bit 
SAR 電路，當類比輸入電壓等於參考電壓 VR+時，轉換值為 4095，
也等於轉換後加速度值+3g。類比輸入電壓等於 VR-時，轉換職為 0，
  33
 
圖 5.22 X 軸震動波形圖 
當加速度感測器 Y 軸平面感受到明顯變動時，其 Y 腳位輸出波
形如圖 5.23 所顯示，在中間方藍色的波形即為 Y 軸輸出波形變化，
上方為 X 軸與下方的 Z 軸輸出波形。從示波器的畫面中，我們分析
Y 軸上升波形時間大約為 120ms，下降波型時間最快大約為 100ms，
進一步推得頻率約等於 4.55Hz。 
 
圖 5.23 Y 軸震動波形圖 
 
  35
5.6.4 韌體界面設計 
MSP430F449 必須負責接收 GPS 感測器的資料、轉換加速度感測
器之電壓值、顯示感測器的資訊在 LCD 上、還需要把感測器存放於
資料記憶體內的資料傳送給 ZigBee module，韌體界面架構圖如圖
5.25 所示： 
 
 
圖 5.25 韌體界面架構圖 
 
本計畫規劃韌體工作內容為：MSP430F449 從 GPS 感測器讀取
500 筆資料儲存到資料記憶體裡，同時藉由 UART1 傳送給 ZigBee 
module，在開始傳送 GPS 資料前會先送出一筆資料”AA”來標示接下
來的資料為 GPS 感測器送出，接著處理這 500 筆資料，判斷裡面是
否有 GGA 封包，發現 GGA 封包即擷取岀時間以及經緯度資料顯示
於 LCD 模組上，然後開始轉換三軸加速度感測器 X、Y、Z 三軸的資
料，依序不斷地重複轉換並且儲存到資料記憶體當中，在儲存資料時
會先存入”1011”這筆資料，作為標示及區隔開每次轉換後三軸的資
料，同時藉由 UART1 依序把資料記憶體內的資料傳送給 ZigBee 
module，X、Y、Z 比較 30000 筆的數據後，顯示最大以及最小值。
韌體界面設計流程圖如圖 5.26 所示。 
UART0 
I/O port 
ADC12 
UART1 
GPS 
感測器 
加速度 
感測器 
LCD 
module 
ZigBee 
module 
MSP430F449 
  37
長時間，三通道順序轉換一次所需耗費的時間約為 0.469ms，其計算
方式如下： 
單通道轉換時間=轉換週期+取樣週期 
T(ADC 工作頻率)=0.2us；n(除頻) = 768 
轉換週期：13×T = 13×0.2us = 2.6us 
取樣週期：T×n = 0.2us×768 = 153.6us 
單通道轉換時間= 2.6＋153.6 = 156.2us 
三通道轉換時間=單通道轉換時間×3 = 0.469ms 
UART0 的轉換時間則是藉由 Timer_A 來規劃，Timer_A 設定大
約 10 秒鐘左右會中斷一次，在中斷程式內設定 UART0 的轉換致能與
ADC 轉換禁能，達到每 10 秒完成 GPS 與加速度感測器資料的收集、
處理、傳送與顯示動作。MSP430F449 韌體所規劃的功能及設定如表
5.10 所示： 
表 5.10 MSP430F449 韌體規劃功能設定表 
功能 設定 
ADC12 三通道順序轉換、轉換速率 0.469ms 
UART0 致能 RxD、資料長度 8-bit、baud rate=4800bps
UART1 致能 TxD、資料長度 8-bit、baud rate=4800bps
Timer A 上/下數模式、週期=10 秒 
I/O Port 3/Port5 數位 I/O 功能、輸入/輸出 
 
5.7 閘道器與中介軟體界面設計與實現 
軟體界面層主要是以系統韌體及中介軟體(Middleware)的技術來
開發 [27]。無線感測器網路研究實現方法均有賴於系統韌體及
Middleware 技術之研發與整合。Middleware 主要作為網路上各種應用
  39
module 利用 RS-232 界面與無線感測網路界面溝通，而 GPRS 
module 與 IP-Link 5501 實體雖為 Internet 以及 USB 界面溝通方
式，但最後都轉換成虛擬 COM Port 的形式，所以中介軟體要接
收無線感測網路的資料必須利用 COM Port 的方式，把彼此間的
橋樑先搭建起來，才能進一步的做通訊及控制動作。 
(2) 資料過濾及處理：接收進來的資料包括 GPS 感測器的數值與三軸
加速度感測器的數值，由於資料是連續傳送，必須正確有效地判
別出資料區段是屬於哪個感測器之數據，才能進一步做處理。如
果是 GPS 資料則從 500 筆數據中判斷是否有 RMC 封包，再從
RMC 封包資料裡擷取出時間、經緯度資料。三軸加速度感測器
的資料起始標識為”1011”，X、Y、Z 三軸資料接在”1011”之後，
再進一步處理三軸的數據，轉換為加速度值。 
(3) 資料處理界面：接收到感測節點所傳送過來的資料後，需要將資
料處理並傳送到遠端資料庫，因此這個界面主要工作即是把處理
好有效的資料正確無誤的儲存到資料庫裡。資料處理流程如圖
5.28 所示： 
  41
 
圖 5.29 傳送簡訊界面流程圖 
5.8 系統監控中心應用程式設計與實現 
系統監控中心是讓使用者在應用時上手容易增加方便性，監控中
心的設計是依據應用的需求來規劃與設計，本計畫主要應用於防災方
面，故設計監控中心界面讓使用者能更容易查看震動與全球定位感測
器來感測到週遭環境的加速度變化及精準定位資訊，讓遠端專業人員
更容易了解遠端傳輸的資料，進而加以分析及觀測，並能即時地採取
適當的因應動作，以預先對災變的發生發出警訊。 
在本計畫中，將中監控中心應用程式與 Middleware 軟體整合在
  43
(六) 系統整合與應用 
6.1 無線網路系統之整合 
在本計畫中，我們使用 ZigBee 無線網路系統，而 topology 部分
則採用了Mesh topology，因為Mesh topology 具備有Self-discovery(自
我發現)、Self-Healing(自我復原)等特性，即當 AP 或 coordinator 察覺
到有新設備或節點加入網路時，會自動更新 routing table。規劃一包
含五個節點之網路架構，如圖 6.1 所示，五個節點之 ID 分別為：0、
1、2、22、33，藉由 IP-Link 簡易配置工具可以驗證其 routing path。 
 
IP-Link 2220
ID:2
IP-Link 2220
ID:1
RS-232
IP-Link 2220
ID:0
IP-Link 2220
ID:33
IP-Link 2220
ID:22
 
圖 6.1 ZigBee 無線網路架構 
圖 6.2 中我們可以發現，Addr 紅色方框內之數字為目的節點，起
始節點為 22，Payload 紅色方框內之 AA 是擷取 routing path 的指令
[28]，程式回傳源節點至目的節點之 routing path 資料為左邊橘色方
框，”00 16”代表出發節點 ID 號碼之十六進位值，”00 00”代表 next 
hop，”00 02”代表目的節點，也就是我們設定之目的節點。得到 routing 
path(源節點到目的節點)為：ID 22→0→2。routing path(目的節點到源
節點)為：ID 2→0→22。 
  45
 
圖 6.3 節點 22 到節點 33 之路徑 
當我們把節點 1 從網路中移除後，在測試節點 22 到節點 33 之
routing path，結果如圖 6.4 中所示，得到 routing path(源節點到目的節
點)為：ID 22→0→33。routing path(目的節點到源節點)為：ID 33→0
→22。 
 
圖 6.4 節點 22 到節點 33 之路徑 
結果顯示在 Mesh topology 的網路架構下，Mesh 網路提供多條
  47
傳送過來的資料，在 RS-232 與 UART 之間必須透過一顆 MAX232 IC
來做電壓準位的轉換，才能確保 MSP430F449 判讀後的資料會是正確
無誤。而加速度感測器(ADXL330)與 MSP430F449 的溝通方式則是透
過 ADC 轉換腳位，能把 ADXL330 輸出的類比電壓訊號轉換成數位
資料，MSP430F449 才可以對轉換後的數位值加以處理。經過
MSP430F449 韌體處理後會把 GPS 感測器數據裡的 UTC 時間、經度
以及緯度資料顯示在 LCD 上，還有三軸的最大最小加速度值(g 值)。
暫存於 MSP430F449 記憶體內之感測器資料會經由 UART1 輸出至
ZigBee module，一樣必須透過 MAX232 IC 轉換電壓準位，如圖 6.6
所示，螢幕上顯示 X、Y、Z 軸之最大最小值：左邊為最大直，在“▼＂
符號右邊為最小值。 
 
圖 6.6 感測器與無線網路節點 
 
 
GPS 訊號輸出
三軸加速度最
大最小值顯示 
  49
 
圖 6.8 Middleware 接收 IP-Link 5501 傳送的資料 
如圖 6.9 所示，選擇 COM4 進行連結動作，即可正確開啟 COM 
Port 4，並且接收到無線感測網路藉由 GPRS module 所傳回來的資料。 
 
圖 6.9 Middleware 接收 GPRS 傳送的資料 
 
  51
 
圖 6.11 資料庫中三軸資料 
如圖 6.10 上所標示橘色長方框內之時間、經緯度資料依序存入
資料庫中，會有兩筆資料是因為，接收 500 筆 GPS 資料中有兩筆 RMC
封包，中介介面上顯示的為最後一筆資料，也就是第二筆封包的數
據，只要有幾筆 RMC 封包內有正確之經緯度值，就會存幾筆數具置
資料庫中。如圖 6.12 所示： 
 
圖 6.12 資料庫之 GPS 資料 
 
6.5 系統監控中心應用程式之界面整合 
系統監控中心應用程式介面提供了將感測器資料轉為易於使用
者了解的數值，如果讓使用者看原始資料可能根本搞不懂那些數字所
代表的涵義，也就會失去了監控中心界面的意義，所以我們初步將
  53
 
圖 6.14 監控中心界面-GPS 感測資料 
 
圖 6.15 UrMap 地圖定位資訊 
無線感測網路端不斷傳送資料至中介軟體，監控中心界面上顯示
接收到之原始資料，經過處理後取出感測器資料並且轉換成 g 值，分
  55
 
圖 6.17 X 軸加速度值大於 2g 
 
圖 6.18 手機簡訊畫面 
資料庫查詢介面是提供監控者查詢歷史資料的一個應用程式，如
  57
傳送至 Middleware。 
(2) 中介軟體：主要功能為資料處理，並把處理後的資料在監控中心
應用程式上呈現。還必須把處理後有效的資料轉存至系統資料
庫，控制 GSM module 發送簡訊功能也必須在處理資料過程中作
判斷與執行。 
(3) 系統資料庫：其功能為接收 Middleware 傳送的資料，並將資料儲
存在正確的資料欄位裡，且可管理與應用資料庫中儲存的所有資
料，因此有基本的資料查詢，以便給予使用者可以獲取資料庫中
之歷史資訊。 
(4) 監控中心應用程式與資料庫查詢應用程式：防災監控系統必須具
備一個監控中心應用程式，提供監控者觀測無線感測網路結點之
感測器資訊，需要感測節點之歷史資料時，資料庫查詢應用程式
便能讓監控者簡單的搜尋到歷史資料。 
(5) 感測節點消耗功率：GPS 感測器消耗功率約為 0.38W、加速度感
測器消耗功率約為 1.152mW(3.6V×320uA)、ZigBee module 消耗功
率 約 為 0.66W(55mA × 12V) 、 MSP430F449 消 耗 功 率 約 為
1.008Mw(3.6V×280uA)，估計感測節點總消耗功率約為 1.04W。 
經由上述系統之整合與測試，而在系統功能之測試皆有依其介面
設計之功能加以實現，完成驗證無線感測網路系統的功能。 
  59
(七) 結論與未來展望 
7.1 結論 
本計畫主要著重於結合感測測器於無線網路的研究與技術發
展，希望藉由無線網路的技術能在防災監測領域發光發熱，可以避免
有線傳輸之人力佈線的範圍限制，在人力不便到達的地域，無線網路
技術的應用解決了這些困擾，提供一個既安全又可靠的傳輸通訊選
擇，我們利用 MSP430F449 微處理器實現了無線感測網路系統，透過
韌體的設計與 Middleware 界面的整合，驗證本系統之可行性與實用
性。在無線網路系統整合了 ZigBee 與 GPRS 傳輸，ZigBee 設計為短
距離的無線通訊，GPRS 結合到 ZigBee 網路後，可以大大延伸傳送
資訊的距離，彌補 ZigBee 傳輸距離上的先天不良因素。如此一來，
更加提升整個無線感測網路的應用彈性。結合 GSM 傳送簡訊功能，
讓整個系統更貼近防災監測系統的需求，可以即時反應危險，輔助監
測人員作有效且快速的處理防範工作，降低人力不足或疏失的機率，
進一步確保人民的生命財產安全。 
7.2 未來展望 
無線網路日益蓬勃發展，為人們日常生活的通訊和資料傳輸帶來
了非常大的改變，提供更加便利的生活，而未來的生活，無線感測網
路應用在生活週遭的建物是有其發展的空間與適切性，在本計畫中，
只實現了單一無線感測網路節點的系統，將來在實際使用上必須是更
龐大的無線感測網路系統，感測器的選擇也必須依照監測物體的需求
來配合調整，才能達到有效的監測系統。再者我們實現之系統並無考
慮功率消耗的問題，這在實際應用上是非常大的一項因素，將會影響
到整個網路的運作，也是將來系統發展上的改良要素之ㄧ。 
  61
6. C.-C. Song, Y.-C. Hsu, Y.-K. Chen and C.-F. Feng, “Study and 
Implementation of Vibration Sensing and Information Middleware for 
Wireless Sensor Networkss,” accepted to 2008 International 
Automatic Control Conference (IACC 2008), NCKU, Tainan, Taiwan, 
21-23 November, 2008. 
7. 宋朝宗、唐浩然、王培鈞和廖德誠, “無線射頻辨識系統網路資訊
平台之研究與建構,” 2008 National Symposium on System Science 
and Engineering (NSSSE’08) (2008 中華民國系統科學與工程會議), 
Ilan, Taiwan, June 6-7, 2008, pp. 1-6. 
8. 宋朝宗、吳宸昱和許音傑, “TFT-LCD 系統視窗分割與亮度補償技
術之研究與實現,” 2008 National Symposium on System Science and 
Engineering (NSSSE’08) (2008 中華民國系統科學與工程會議), Ilan, 
Taiwan, June 6-7, 2008, pp. 1-6. 
9. 宋朝宗、陳世文、許音傑和廖德誠, “TFT-LCD 影像對比提昇技術
之 研 究 ,” 2008 National Symposium on System Science and 
Engineering (NSSSE’08) (2008 中華民國系統科學與工程會議), Ilan, 
Taiwan, June 6-7, 2008, pp. 1-6. 
10. C.-C. Song, H.-L. Ke, Y.-C. Hsu and D.-C. Liaw, “Study and 
Implementation of a Networking Information Platform for RFID 
System,” 2008 IEEE International Conference on Industrial 
Technology (ICIT2008), Sichuan University, Chengdu, China, 21-24 
April, 2008, pp. 1-6. (EI) 
11. C.-C. Song, Y.-C. Chang, Y.-S. Hung C.-Y. Cheng and C.-C. Chang, 
“Study and Demonstration of a Surveillance System Platform on 
RFID Network,” Proc. 2007 CACS International Automatic Control 
Conference, National Chung Hsing University, Taichung, Taiwan, 
Nov. 9-11, 2007, pp. 1-6. 
12. C.-C. Song, Hong-Lin Ke and D.-C. Liaw, “Study of Parameterized 
Nonlinear Dynamics for Buck Converters,” 2007 Taiwan Power 
Electronics Conference, Changhua, Taiwan, September 7, 2007, pp. 
226-231. 
13. C.-C. Song, D.-C. Liaw and S.-W. Chen, “Nonlinear Modeling and 
Bifurcation Analysis of Buck Converter Dynamics,” 15th IEEE 
International Workshop on Nonlinear Dynamics of Electronic Systems 
(NDES’07), Tokushima, Japan, July 23-26, 2007, pp. 285-288. (EI) 
 
未來將積極投稿於國際知名期刊，以促進國際學術交流，進而提
昇國內研究水準。本計畫規劃三年之執行進度，進行『智慧型系統平
  63
參考文獻 
[1] Dharma Prakash Agrawal and Qing-An Zeng, Introduction to 
WIRELESS and MOBILE SYSTEMS, Thomson, 2003. 
[2] Anna Hac, WIRELESS SENSOR NETWORK DESIGNS, John Wiley 
& Sons, Inc.,2003. 
[3] Alan Gatherer and Edgar Auslander, The Application of 
Programmable DSPs in Mobile Communications, John Wiley & Sons, 
Inc., 2002. 
[4] Alice Wang and Anantha Chandrakasan,“Energy-efficient DSPs for 
Wireless Sensor Networks,＂ IEEE Signal Processing Magazine, 
Volume 19, Issue 4, Jul 2002. 
[5] Gregory J. Pottie,“Wireless Sensor Networks,＂IEEE Information 
Theory, pp.139-140, 1998 
[6] 黃柏峰，省電型通訊協定之無線感測網路研究與雛形系統實現，
南台科技大學電子工程研究所碩士論文，2004 年 6 月。 
[7] Sangati Seth, Jerome P. Lynch, and Dawn M. Tilbury,“Wirelessly 
Networked Distributed Controllers for Real-Time Control of Civil 
Structures,＂IEEE American Control Conference, pp. 2946-2952, 
June 8-10 2005. 
[8] 嚴啟森，無線感測網路之感測器定位系統實作，國立中正大學通
訊工程系碩士論文，2005。 
[9] 林季平，淺談 IEEE 802.15 家族，通訊雜誌 124 期，2004。 
[10] M. Galeev，採用 Zigbee 建立家庭網路，摩托羅拉公司，2006。 
[11] ZigBee Standards Organization, ZIGBEE SPECIFICATION , 2006.  
[12] J.S. Lee,“An Experiment on Performance Study of IEEE 802.15.4 
Wireless Network,＂ IEEE Conference on Emerging Technologies 
