中文關鍵詞： 瑕疵檢測，異質性紋路，非等向性擴散，太陽能晶片，微裂
瑕疵 
英 文 摘 要 ： The surface defects of a solar wafer or a solar cell 
result in high recovery cost in the manufacturing 
process and reduction in production yield. They may 
also cause electrical failure or reduction in 
conversion efficiency. The surface of a 
polycrystalline solar wafer shows multiple grains of 
random shapes and sizes at random positions and 
orientations, and results in a heterogeneous texture 
in the image. It makes the automated visual 
inspection task extremely difficult. The manual 
inspection cannot reliably identify the hardly-
distinguishable defects from the heterogeneous 
background, and the currently available inspection 
techniques are mainly applied to non-textured or 
homogeneously-textured surfaces. 
 
 The research aims at the detection of ill-defined 
defects such as cracks, oil stains and contamination 
that cannot be quantitatively measured. The automated 
inspection algorithms developed in this research will 
be mainly based on anisotropic diffusion and mean-
shift techniques. They will be applied to both gray-
level images and color images of polycrystalline 
solar wafers and solar cells. This research has 
completed three phases, which are:  
 
1) Year 1: Develop vector-valued anisotropic 
diffusion models for inspecting local defects of 
polycrystalline solar wafers in color images. The 
anisotropic diffusion models can be considered as an 
adaptive smoothing process that smoothes (removes) 
the suspected defect area and preserves the color 
values of the multi-grain background based on local 
color and shape features. The difference image 
between the original image and the diffused image can 
then intensify the defects. 
2) Year 2: Analyze the lighting setup and spectral 
imaging that can eliminate (or alleviate) the multi-
grain surface of a solar wafer in the sensed image. 
 1
 
□期中進度報告 行政院國家科學委員會補助專題研究計畫
■期末報告 
 
自動視覺檢測技術於多晶矽太陽能板之表面瑕疵檢驗 
Automated surface inspection in heterogeneously textured solar wafers 
 and solar cells 
 
計畫類別：■個別型計畫   □整合型計畫 
計畫編號：NSC 98－2221－E－155－030－MY3 
執行期間：98 年 08 月 01 日至 101 年 07 月 31 日 
 
執行機構及系所：元智大學 工業工程與管理學系 
 
計畫主持人：蔡篤銘 教授 
共同主持人： 
計畫參與人員：碩士班研究生-兼任研究助理: 徐顥 
              博士班研究生-兼任研究助理: 邱威堯 
 
 
本計畫除繳交成果報告外，另須繳交以下出國報告： 
□赴國外移地研究心得報告 
□赴大陸地區移地研究心得報告 
■出席國際學術會議心得報告及發表之論文 
□國際合作研究計畫國外研究報告 
 
 
處理方式：除列管計畫及下列情形者外，得立即公開查詢 
            □涉及專利或其他智慧財產權，□一年□二年後可公開查詢 
 
中   華   民   國 101 年 10 月  01 日 
一、中文摘要 
近年來由於原油價格不斷的上升且全球暖化程度日趨嚴重，促使各國不斷尋
找替代能源，現階段直接可行的下一代替代能源便是太陽能，而現今太陽能電池
的瑕疵檢測判定皆在最後成品階段進行人工全面檢測，然而此檢測方式需要大量
人力成本，且太陽能晶片使用人工檢測時不僅費時且容易發生漏檢及誤判的情
形，製程上沒有立即修正及調整缺失，容易造成最後成品中大量不正常產生，不
僅浪費了大量的材料成本，且對於交貨品質及信用造成無法估算的影響。 
 
在第一階段(第一年)中，本計劃利用機器視覺的技術檢測多晶太陽能晶片
(Solar wafer)表面微裂(Macro-crack)瑕疵，由於多晶矽太陽能製程所生產之晶片表
面晶格分佈都不相同，造成每一片太陽能晶片表面影像具備獨一無二的晶格結
構，且微裂瑕疵與正常晶格之輪廓都呈現細長線條的形狀，使得檢測微裂瑕疵的
工作非常困難。本研究使用 LED 正向光源取得微裂瑕疵影像，在灰階影像中，
由於微裂瑕疵具備灰階值較週遭正常區域小(偏黑)且灰階梯度值較大的特性，因
此本研究根據瑕疵之特性建構一非線性擴散(Nonlinear diffusion)模式，針對多晶
太陽能晶片表面影像中梯度值較大且灰階值較小之瑕疵邊緣進行平滑處理，而對
梯度值較小或灰階值較大之背景紋路則抑制平滑處理，再將平滑處理後影像與原
始影像進行相減(Difference)運算以凸顯出瑕疵。 
 
在第二階段(第二年)中，本計劃開發去除多晶太陽能晶片的背景晶格技術以
及在去晶格之影像上偵測瑕疵，本研究提出兩種去除背景晶格的技術，分別為：
(1) 使用光源對焦取像架構直接取得背景晶格平滑之影像；(2) 利用傅立葉重建
技術使一張具複雜晶格的多晶太陽能影像成為一張無紋路影像。以上兩種方法皆
可有效去除複雜晶格紋路且保留表面瑕疵。本階段檢測項目為多晶太陽能晶片表
面髒污(stain)及鋸痕(saw-mark)瑕疵，這兩種瑕疵主要出現在太陽能晶片的切片
製程中，若未及早偵測出來則會影響太陽能電池良率及產量。 
 
 在第三階段(第三年)中，本計劃針對多晶太陽能晶片之表面特性，針對具異
質性紋路表面上之污漬瑕疵，本研究先藉由量測影像中邊緣點(Edge)之梯度
(Gradient)方向的亂度(Entropy，熵)將灰階影像轉為熵值影像，再利用 Mean-shift
平滑方法對此熵值影像進行處理以平滑背景點之熵值而保留瑕疵點之熵值，突顯
出正常之背景區域和瑕疵區域。 
 
關鍵詞：瑕疵檢測，異質性紋路，非等向性擴散，太陽能晶片，微裂瑕疵 
 II
二、計劃緣由與目的 
近年來由於原油價格不斷的上升且全球暖化程度日趨嚴重，促使各國不斷尋
找替代能源，目前可能實用化的替代能源主要有太陽能、風力、波力、地熱等，
其中後三者容易受地域性限制，而且也必須考量能源供給的穩定性；在沒有其它
特殊新能源提供之前，現階段看來較可行的下一代替代能源便是太陽能；在太陽
能電池製造過程中，常會因為製造過程的疏失造成太陽能晶片表面刮傷、汙點以
及微裂(Micro-crack)等瑕疵產生，如果忽視這些瑕疵，會造成太陽能晶片的轉換
效能降低，甚至喪失儲存電量的功能，因此太陽能電池的製程檢測是不可忽視的。 
 
而現今太陽能電池的瑕疵檢測判定皆在最後成品階段進行人工全面檢測，然
而此檢測方式需要大量人力成本，且太陽能晶片使用人工檢測時不僅費時且由於
太陽能板之表面晶格非常複雜容易發生漏檢及誤判的情形，若在一開始的製程中
沒有及時檢測出瑕疵，而只是在最後成品階段才進行檢測，將因為製程上沒有立
即修正及調整缺失，容易造成最後成品中大量不正常產生，不僅浪費了大量的材
料成本，且對於使用效能也會發生極大的損失；因此本研究針對太陽能晶片製程
中的在製品包含太陽能晶片（Solar wafers）與太陽能電池（Solar cells），導入機
器視覺的自動瑕疵檢測技術來取代傳統的人工檢測，期望在太陽能晶片製程中能
及時發現瑕疵，並即時提醒現場生產人員對於製程操作進行改善並立刻修正，以
避免後製程材料浪費或造成生產停線而影響產能。 
 
    太陽能電池（Solar cell）是一種能量轉換的光電元件，它主要經由太陽光照
射後，把光的能量轉換成電能，製造太陽能電池最主要的原料為矽，目前全球所
生產的太陽能電池90%以上是使用結晶矽(Crystalline silicon)，只有約10%是使用
薄膜技術。結晶矽依照製造材質的不同，又可區分為單晶矽、多晶矽與非晶矽，
現今消費市場的應用大多使用單晶矽與多晶矽兩大類，主要是因為單晶矽的轉換
電能效率高且性能穩定；而多晶矽則因製程簡單且無需封裝所以價格較便宜。 
 
依 JPMorgan 報告（Shah, 2008, pp. 255~256），在結晶矽太陽能製程中，
多晶矽佔約50%而單晶矽為40%。太陽能電池的轉換效率，除了隨著製造材質而
不同，也與太陽能電池的製造流程息息相關；多晶太陽能電池的製程主要可分成
鑄造多晶矽錠、切片、蝕刻及拋光、清洗、擴散與網印或蒸鍍，以下將分別簡單
介紹多晶太陽能電池的製造流程（林明獻, 2007）。 
 
1. 鑄造多晶矽錠（Ingots）：使用的原料為多晶矽，主要運用鑄錠法（Block casting）
將熔融的矽鑄造固化而成。鑄錠法之流程技術為將多晶矽原料在石英坩堝融
化後，再將矽熔湯倒入另一鍍有氮化矽之方形石英坩堝中，接著液態的矽會
自坩堝底部往上凝固，當坩堝底部結晶固化後，固液界面會垂直往上移，而
 1
非穿透式微裂的偵測。第二階段（第二年）由於多晶矽晶片具有極為複雜之異質
性紋路，在此階段先分析如何藉由特殊光源設計或高光譜影像（Spectral imaging）
消除矽晶表面之反射而創造一個不具晶格紋路之影像但同時能突顯局部瑕疵之
光源取像系統；接著針對無紋路，但具殘留背景之影像開發瑕疵偵測演算法。第
三階段（第三年）針對多晶矽太陽能晶片以及太陽能電池之彩色影像進行全域性
（Global grading）顏色分級以及晶格紋路分級。以 Mean-shift 技術先對彩色影
像進行色彩分割（Color image segmentation）之前處理，再同樣使用 Mean-shift
技術進行表面顏色及表面紋路之分群( Clustering），達到多晶矽太陽能板分級之
目的。 
 
三、研究方法 
 本節將分別介紹計畫中各階段針對多晶矽太陽能板所開發之演算法。3.1 節
將描述第一年提出以非線性擴散(Nonlinear diffusion)模式為基礎之表面微裂
(Macro-crack)瑕疵檢測方法；3.2 節則描述第二年為開發去除多晶太陽能晶片的
背景晶格技術以及在去晶格之影像上偵測瑕疵，本研究提出兩種去除背景晶格的
技術，分別為：(1)使用光源對焦取像架構直接取得背景晶格平滑之影像；(2)利
用傅立葉重建技術使一張具複雜晶格的多晶太陽能影像成為一張無紋路影像，並
開發霍夫轉換(Hough transform)為基之一維線段瑕疵偵測演算法；3.3 節說明第三
年以 Mean-shift 平滑技術進行色彩分割，達到區分多晶矽太陽能板正常背景和瑕
疵區域之檢測目的。 
 
3.1 非線性擴散之表面微裂檢測方法 
 
第一階段(第一年)計畫中，本研究主要是針對多晶太陽能電池表面微裂
(Micro-crack)瑕疵進行檢測，微裂瑕疵是指多晶太陽能晶片表面所出現的裂痕，
此種瑕疵通常發生在以下兩種製程情況中；第一種為多晶矽晶錠經過切片製程處
理時，因為線切割製程處理時會產生機械應力，當製程控制不當時，機械應力會
過大，造成多晶矽晶錠內部微裂(Micro-crack)瑕疵產生，而第二種情況則是在搬
運多晶矽晶片時，因為多晶矽晶片的厚度很薄，當搬運時受到外力撞擊，就會造
成晶片破裂。如果製程中沒有將微裂瑕疵檢測出來，則會降低多晶太陽能電池轉
換電能的效率，甚至喪失轉換電能的功能。 
 
圖 2 為一張含有微裂瑕疵(右上角之斜線)的多晶太陽能晶片影像，其中圖 2(a1)
為通過微裂瑕疵的水平掃描線(第 225 列)；(b1)為通過正常區域的水平掃描線(第
405 列)；圖(a2)與(b2)分別為圖(a1)與(b1)的一維灰階掃描線；圖(a3)與(b3)則為原
始測試影像使用索貝爾(Sobel)運算子處理後的結果；圖(a4)與(b4)分別為(a3)與
(b3)第 225 列與第 405 列一維梯度掃描線。觀察一維梯度掃描線發現太陽能晶片
影像的微裂瑕疵與正常區塊邊緣的梯度值都很大，且一維灰階掃描線顯示出微裂
瑕疵的灰階值較週遭正常區域小，由於微裂瑕疵在多晶太陽能晶片影像的特性為
 3
 
    我們可以將（3-1）式更明確的定義如下： 
 
))()(div(),(1 x,yx,ycyx ttt II               （3-2） 
 
（3-2）式中， 表示影像之強度，在此 代表影像的二維空間座標，在 )(x,ytI )(x,y
而 t 為處理過程的時序參數，在數位影像之應用上，可視為第 t 次之擴散疊代次
數。 )(x,yct 是代表控制擴散程度的擴散函數，此函數是依照影像強度之梯度而變
動，因此可表示成（3-3）式： 
                     ))(()(x,yct x,yg tI                       （3-3） 
 
中 必須為一個非負的單調遞減函數，且只要符合)(g 1)0( g其 及 之條
函數如 3-4）所示：
0)( g
件的數學函數都可以使用。而本研究中所用到的單調遞減 式（  
 
2)(1
1)(
K
g
I
I                         （3-4） 
 
（3-4）式中K 為一事先選定之常數值，我們稱其為擴散參數，K在 值的設定將
直接影響影像中處理該位置平滑程度的標準，因此K 值也可稱之為邊緣強度臨界
值。依照（3-4）式的特性，若影像中 )(x,y 所在位置之灰階梯度甚大（即 KI ）
時，整個擴散函數值 )( Ig 將趨近於
位置之灰階梯度甚小
0，而使擴散現象停止；若影像中 所在)(x,y
(即 K )時，整個擴散函數值則會趨近於1，並獲得最
大擴散量。 
 
I
K 值的選擇是根據參雜雜訊的程度和影像邊緣的灰階差異幅度變化而決
定，一般認為在可以平滑雜訊的情況下，採用的 K 值愈小愈好，以免因 K 值過
大而造成影像邊緣被模糊化的效果，但因為K 值愈小所需疊代的次數就愈多，其
處理時間會愈長。因此找到一個適當的K 值，才能在有限的時間下將瑕疵平滑並
保留正常區域。在本研究中K 值選擇為依照整張影像的平均梯度值 I ，所謂的
平均梯度是指原始待測影像 ),(0 yxI 之四個方向分別為北 ), yxN I 、南
),(0 yxS I 、西 ),(0 yxW I 與東 )
(0
,(0 xE I y 梯度值加總除以影像大 子如
示： 
 
小，詳細式
（3-5）所
)),(),(),(),((
4
11 00
1
0
1
0
00 yxyxyxyxNM EW
M-
x
N-
y
SN IIIII       (3-5) 
 
（3-5）式中， 為影像的大小，而NM  ),(0 yxN I 、 ),(0 yxS I在 、 與
算方法如（3-6）式。 
 
),(0 yxW I
),(0 yxE I 分別表示原始測試影像在北、南、西與東四個方法的灰階梯度值，計
 5
                            
255
)()( x,yIx,yf              (3-10) 
 
在（3-10）式中， I 示影像)(x,y 表 I 在 的
較 較大
二維空間座標 (x 灰階値，並假設
其以8位元的方式顯示，即灰階值的範圍從0至255。當太陽能晶片影像中的灰階
値 (x,yI 小時， (x,yf 因子的權重會變小；當影像中灰階値 (x,yI 時，
灰階因子 (x,yf 理權重會變大；本研究將灰階值因子加入傳統非線性擴散之
擴散函數中，則可將（3-4）式改寫為(3-11)式： 
),y
) )灰階 )
)的處
 
        
)
),(
(),(1
1),(
2 




yx
Kyxf
fg
I
I                (3-11) 
 
在（3-11）式中， )(x,yI 即代表影像在 位置的灰階梯度，而)(x,y K 為擴散參數。
為了使灰階較低且梯度較大之微裂瑕疵有較大的平滑效果，即較大的擴散係數值
，因此 必須與擴散函數),( fg I ),( yxf g 成反比，而 I 與 g 成正比。圖4為(3-11)
式中灰階因子 、梯度值f 2)(
I
K 與擴散係數值 )f,(g I 之關係圖，從圖中的擴散
係數函數 可以觀察出當影像中 座標的灰階梯度值 愈大且灰階
因子 愈小(接近0)時，則擴散函數值
)f,(g I )
f
,( yx
,(g I
I
f ) 將愈趨近於1，因此會有較大的擴
散平滑處理效果；若影像中 所在位置之灰階梯度值愈小且灰階因子
愈大(接近1)，則擴散處理的效果會較小並保留原始灰階值。 
),( yx ),( yxf
 
經由以上針對改善後非線性擴散介紹後，發現改善後的非線性擴散主要使用
灰階因子 與梯度因子),( yxf 2)(
I
K 判斷多晶太陽能晶片影像中  yx, 座標位置的
擴散程度，當影像中 座標位置的灰階因子 與梯度因子 yx,  ),( yxf 2)(
I
K 都很小
時，才會針對影像 座標位置做較大程度的擴散處理，即對於多晶太陽能晶
片微裂瑕疵做較大的擴散平滑處理，而其它正常紋路則抑制其擴散處理程度；接
著使用原始影像與擴散處理後影像相減，就可以得到差異影像 (Difference 
Image)。為了方便觀察差異影像中瑕疵區域，所以針對差異影像做正規化處理，
以下則為正規化方法的介紹。 
 y,x
 
令 原 始 影 像 與 擴 散 處 理 後 影 像 相 減 之 差 異 影 像 為 ， 即),( yxI
),(),(),( 0 yxIyxIyxI T ，其中 為原始影像， 為擴散影像(),(0 yxI ),( yxIT T 次
疊代)。 
 
在實際檢測上，為了凸顯差異影像中的瑕疵，本研究採用管制界線二值化將
瑕疵凸顯出來，而管制界線二值化的處理步驟，說明如下。首先針對原始影像與
經過非線性擴散處理後的影像相減，就可以得到差異影像 I ，由於瑕疵所對應
 7



yyyx
xyxxT
gg
gg
GG  
 
其中 
222
) ,() ,( ) ,( 













x
yxf
x
yxf
x
yxfg bgrxx  




























y
yxf
x
yxf
y
yxf
x
yxf
y
yxf
x
yxfgg bbggrryxxy
) ,() ,() ,() ,() ,() ,(
 
222
) ,() ,( ) ,( 













y
yxf
y
yxf
y
yxfg bgryy  
則 2×2 矩陣 的二個固有值（eigenvalues）則為 TGG 
  22 4)(
2
1
xyyyxxyyxx ggggg   
 
而彩色梯度則依此二固有值  與 - 可定義為  + - 或  - - 或僅以  為彩色梯
度。 
 
3.2 多晶太陽能晶片的晶格背景去除技術及瑕疵檢測方法 
 
太陽能晶片表面上常出現之瑕疵為鋸痕(saw-mark)及髒污(stain)瑕疵，主要原
因是在太陽能晶片切片製程中，線鋸之鈍化或是線鋸切割經過雜質造成之切割不
平整所致，而髒污則為切割液或清洗液之殘留所致。太陽能切片製程通常使用多
線鋸機(Multi-wire sawing machine) (Palathra, 2008、Goetzberger and Hebling, 
2000)，而多線鋸機是由數百公里長的單一鋼線纏繞成 500-700 匝，一次可同時
對矽晶碇進行多片切割以增加切片速度。切割太陽能晶片造成晶片表面的細微切
割損傷(saw damage)是不可避免的，可透過酸/鹼蝕刻液去除(Park et al., 2009)，但
鋸痕瑕疵為高度或深度超過 10-15μm (Markvart and Castaner, 2005)，因此無法以
蝕刻液去除，殘留之切割應力也使晶片破片機率大增，而鋸痕瑕疵與髒污瑕疵皆
會影響後續的太陽能電池製程良率，甚至影響發電效率，因此必須在此切片製程
後被檢測出來。圖 5(a)為一張正常多晶太陽能晶片影像，其(b)為一張具有黑色鋸
痕瑕疵晶片影像；(c) 為一張具有白色鋸痕瑕疵晶片影像；圖(d)為一張髒污瑕疵
影像。鋸痕瑕疵是利用紅外線(Infrared)背光取像，由於鋸痕厚度不均的特性，使
鋸痕瑕疵呈現黑色或白色灰階值之特徵，而髒污瑕疵則是利用環形正向 LED 取
像。 
 
本研究首先利用光源聚焦的取像方式以及傅立葉轉換重建技術，分別將多晶
太陽能晶片的晶格背景去除，使得具有髒污瑕疵影像呈現平滑晶格背景之影像，
而鋸痕瑕疵影像呈現低對比之無紋路背景影像，再利用本研究提出的一維掃瞄線
瑕疵檢測法，分別在垂直方向與水平方向進行掃描，便可將髒污瑕疵以及鋸痕瑕
疵分別檢測出來。詳細的瑕疵檢測演算法內容介紹如下。 
 9
 
為了使傅立葉能量可顯示於 8-bit 影像中便於分析與觀察，因此可將能量值改由
下式計算  
 
)),(1log(),( vuFvuP    (3-15)
 
太陽能晶片表面的多晶格紋路呈現較短且方向紊亂之邊界，而鋸痕瑕疵則呈現較
長且方向一致之邊界，使得水平鋸痕瑕疵以較高的能量分布於傅立葉頻譜之垂直
方向低頻帶。因此，透過去除低頻區域之圓形範圍，且保留垂直方向的低頻區域
達到去除晶格保留瑕疵之目的。圖 8(a1)為一張無瑕疵的太陽晶片影像；(b1)為一
張具有鋸痕瑕疵影像；圖 8(a2)為對應(a1)之傅立葉頻譜圖，其顯示晶格紋路以變
異且紊亂之方向分布於低頻帶，而圖 8(b2)為對應(b1)之傅立葉頻譜，可發現鋸痕
瑕疵之能量垂直分佈於傅立葉頻譜中，且跨越低頻及高頻區域。透過刪除頻譜中
的低頻帶保留高頻帶，使用反傅立葉技術(inverse Fourier transform)，則可得到圖
8(a3)與圖(b3)顯示之去晶格重建影像，圖 8(a3)為正常影像(a1)之去晶格影像，圖
8(b3)為鋸痕影像(b1)之去晶格影像，顯示複雜晶格紋路已被去除，而細微的鋸痕
瑕疵可被完整的保留。 
 
 為去除背景晶格紋路及保留鋸痕瑕疵，本研究設計一半徑為 r 之區域，將頻
譜中心此圓形範圍內之頻率去除，意即給予頻率值 為零，但保留寬度為 w
之中心垂直區域，以確保鋸痕瑕疵之能量不被刪除。圖 9(a)顯示傅立葉頻譜中去
除區域之示意圖；圖 9(b)為圖 5(b)之傅立葉頻譜；圖 9(c)為(b)去除指定區域之傅
立葉頻譜圖。上述去除操作可由下列數學式表示： 
),( vuF
 


 
otherwise ,  ),(
   )2or    2 (  and   if ,            0),(ˆ
222
vuF
wuwurvu
vuF    (3-16) 
 
其中 為去除中心之傅立葉頻譜。經過上述的傅立葉轉換以及頻譜區域去除
後，可對此傅立葉頻譜 進行傅立葉影像重建 (discrete inverse Fourier 
transform)，重建公式為： 
),(ˆ vuF
),(ˆ vuF
 
             
 

2
2
2
2
)](2exp[),(ˆ),(ˆ
M
Mu
N
Nv
NvyMuxjvuFyxf   
 
重建影像 即為一張無紋路影像。圖 10(a1)顯示圖 5(a)正常晶格之重建影
像; (b1)為圖 5(b)鋸痕瑕疵之重建影像，由此兩張重建影像可觀察到，銳利地晶
格背景已經被去除，且瑕疵部分被完整保留，但由於該無紋路影像呈現低對比且
灰階分布不均勻之特性，因此透過一維方向地垂直掃瞄線觀察重建影像中的灰階
值變化。圖 10(a2)曲線圖為(a1)中的灰階掃瞄線 1，雖然灰階值呈現不穩定的跳
動，但仍可觀察出一定的直線趨勢，而(b2)顯示通過鋸痕瑕疵之掃瞄線(圖 10(b1)
之掃瞄線 2)在瑕疵點的灰階抖動較其他正常區域點的灰階跳動大。因此本研究提
出以霍式轉換為基之一維 Hough-like 直線偵測演算法來偵測低對比且光源不均
影像上的瑕疵。 
),(ˆ yxf
 11
3.2.4 瑕疵偵測 
 
 本研究使用簡單的統計製程控制(SPC)計算出閥值將瑕疵自影像中分割出
來。以一維垂直掃瞄線X為例，當估計出最佳的直線參數 ，在參數空間
中的每一點 至估計直線之距離 則可計算出來，當某
一點 超出閥值 則對應於原始影像上的像素位置(X, y)將被視為是瑕
疵點，反之則為正常點，閥值 計算方式如下： 
)  ,( ** 
)*))( ,( yfy X
))(y
 , |)( ,( * yfyD X
 ,( fy X DT
DT
 
       
XXX
T DDD    
 
其中
XD
 與
XD
 分別為落在灰階掃瞄線 X 上每一點之距離 )* 的
平均值與標準差。本實驗中，控制係數項
 , |)( ,( * yfyD X
 被設為 1.5，當測試點超出管制界限
則設為 1(以黑色顯示)，否則以 0 表示(以白色顯示)，最後偵測結果則以二值化
影像 )y 表示： (X,B  
 
           
  otherwise
yfyDifyB DD
   0,
   ) ,|)( ,(   1,) (X, XX
**
X 
 
3.3 Mean-shift 平滑技術於多晶太陽能表面瑕疵檢測 
 
    第三階段(第三年) 觀察一張多晶矽太陽能晶片影像發現到，表面紋路上之
晶格大小不同，且晶格分佈之形狀任意並隨機呈現於晶片上，多晶矽太陽能電池
表面污染(Contamination)瑕疵，一般是指發生在多晶矽太陽能晶片表面上之污漬
瑕疵，或是多晶矽太陽能晶片在製造過程中所發生之異物殘留，再者也有可能是
作業員在檢測時手上的水氣所造成之瑕疵，通常此種瑕疵的形狀不規則，圖 11(a)
為多晶矽太陽能晶片之正常影像，圖(b)為多晶矽太陽能晶片之指觸瑕疵影像，
圖(b)中虛線黑框處為汙染瑕疵，從圖(a)和圖(b)中發現到因為晶格紋路為大小不
同且形狀任意之隨機紋路影像，因此在區分影像中正常背景點和瑕疵點變的非常
困難，圖(c)為通過正常區域之一條水平掃描線，而圖(d)為通過污染瑕疵區域之
一條水平掃描線。觀察正常區域和瑕疵區域的一維灰階掃描線，發現正常區域和
瑕疵區域的灰階值分佈並無顯著的差異性，所以無法從灰階資訊中輕易的找出瑕
疵所在的位置。 
 
本階段主要是探討 Mean-shift 平滑技術於表面瑕疵檢測的可行性，針對異質
性紋路之多晶矽太陽能晶片上之指觸及污漬瑕疵進行瑕疵檢測，在多晶矽太陽能
晶片上，正常區域之晶格邊界方向分佈較單純，因此正常區域邊緣點在梯度方向
的變化上較少，反之瑕疵區域之邊界一般而言較正常區域模糊或碎細，因此瑕疵
區域在邊界之梯度方向的變化上較多且複雜。 
 
 
 13

 




 
n
i
i
d h
k
nh
Cp
1
2
)( xxx                        (3-22) 
 
利用公式(3-22)推導機率密度函數 之梯度(最大變異方向)，其公式如下所示： )(xp
 


 


 
n
i
i
id h
k
nh
Cp
1
2
2 )(
2)( xxxxx                     (3-23) 
 
公式(3-23)中 為 之一階微分，下列定義方程式)(k )(k )(g ： 
 



 


  22
h
k
h
g ii xxxx                         (3-24) 
 
利用公式(3-23)和(3-24)推導出下列的公式： 






















 


  








 x
xxxxxxxx
xx
xx
n
i h
n
i hin
i
i
d
n
i
i
id
i
i
g
g
h
g
nh
C
h
g
nh
Cp
1
2
1
2
1
2
2
1
2
2
2)(2)(  (3-25) 
 
在此將 視為權重，上列公式(3-25)右邊第二項即是所謂的 Mean-shift 向量
，公式如下所示： 
)(g
)(xm
 
)(xm x
x
xx
xx













n
i h
n
i hi
i
i
g
g
1
2
1
2
                    (3-26) 
 
在此      ni hni hi ii gg 1 21 2 xxxxx 即是透過 kernel 權重所計算出來的加權平均
值(重心)，x則為目前之觀測點位置(中心)，計算中心和重心的差 ，則
所代表的就是x的移動量，也因此 Mean-shift 向量總是指向密度增加最大的方向。 
)(xm )(xm
 
3.3.2 異質性紋路表面檢測之 Mean-shift 技術 
 
針對多晶矽太陽能晶片上的影像特性，在一視窗中，正常區域之晶格邊界方
向較單純，因此邊界方向變化較小，反之瑕疵區域之邊界一般而言較為模糊或碎
 15
 
完成計算特徵值熵 值的方法後，本研究接下來將針對熵值影像進行
Mean-shift 平滑處理，令 為像素點 經 Mean-shift 位移之最終座標位
置，則將 之熵值 取代 之原始熵值
代的動作，如公式 3-29 所示。 
 
 
Mean-sh
測，針對檢測熵值 影像之管制界限公式如下所示：
 
               (3-30) 
四、實驗結果與討論 
4.1 多晶太陽能晶片微裂瑕疵檢測 
 
微裂 (偏黑)，且周遭的灰
階梯度值較大，所以本研究嘗試使用簡單二値化方法，在透過非線性擴散處理
後，將瑕疵與背景區域做分割，並觀察經過管制界限二值化後殘留雜訊的多寡。
圖 12(a)與圖 13(a)為多晶太陽能晶片微裂瑕庛影像樣本；
改善後的非線性擴散方法處理，再將處理後的結果與原始影像相減；因為管制界
也將雜訊凸顯出來，所以最後必須使用形態學消除雜訊
並填補瑕疵，就可以得到最後的檢測結果如圖 12(c)與 13(c)所示。 
   圖 14 與圖 15 分別使用改善後的非線性擴散偵測瑕疵與正常多晶太陽能晶
用
光，但微裂之瑕疵非常細微，幾乎肉眼無法觀測，但透過如圖(c2)之彩色擴散
結果
),( yxE
,( ** yx
,( ** yxE
)
)
),( yx
)y),( ** yx ,(x ),( yxE ，也就是做熵值取
),(( ** yxEE                               (3-29) 
接下來本研究將針對 ift 平滑處理後之熵值 ),( yxE 影像進行瑕疵檢
 (0), 瑕疵yxE
), yx 
),( yxE  


otherwise,)(255
)(),(if,)
( 正常點
點 EE CyxE 
    多晶太陽能晶片 瑕疵的特點為其瑕疵的灰階値較小
圖 12(b)與 13(b)則使用
限法二值化不僅凸顯瑕疵
  
 
片，且都沒有包含後處理的結果；其中圖 14(a)與圖 15(a)為太陽能晶片微裂瑕疵
與正常影像，圖 14(b)與圖 15(b)為太陽能晶片經過非線性擴散處理後影像，將經
過擴散處理後影像與原始影像(a)相減並做正規化處理，最後使用管制界限二值
化將瑕疵與雜訊分割出來可以得到圖 14(c)與圖 15(c)。從結果中可以觀察出，使
用本研究的方法可以找出太陽能晶片微裂瑕庛，且不會有誤判的情況發生。 
 
圖 16 為使用彩色非線性擴散於瑕疵與正常多晶太陽能彩色影像之結果。圖
a1)為一無瑕疵太陽能晶片，使用正向紅光取像之結果，因此有部分晶格會呈16(
現紅色的反應；(a2)顯示經過彩色非線性擴散的結果，晶格皆被消除，再透過管
制界限二值化後，(a3)顯示沒有誤判。圖 16(b1)與(c1)分別為髒污以及微裂瑕疵
之彩色影像。圖 16(b1)使用白光進行取像，使得彩色影像偏藍，且晶格與背景之
顏色對比更高，因此使用較多的疊代次數進行處理，如圖(b2)所示，經過彩色擴
散處理仍然可有效保留髒污瑕疵形狀且模糊多晶之背景，瑕疵偵測結果如圖(b3)
所示。圖 16(c1)為多晶太陽能板微裂瑕疵彩色影像，打光之顏色如圖 16(a1)使
紅
，微裂瑕疵以及下方的小髒污明顯有效被凸顯出來，因此透過管制界限二值
 17
影像重建法可有效地將複雜背景晶格去除，得到一張無紋路影像。圖 18 顯示六
張無瑕疵太陽能晶片影像之檢測結果，其中(a1)-(f1)為六張無瑕疵影像; (a2)-(f2)
為相對應的六張傅立葉頻譜; (a3)-(f3)為相對應的六張傅立葉重建影像; (a4)-(f4)
別的瑕疵檢測結果，檢測結果顯示並無誤判。對於所得有檢測結果，本實驗皆
去除雜訊。 
；(c)為圖(a)之傅立葉頻譜影
像； )傅立葉重建影像；(e)圖顯示只要透過調整
個
以 3×3 得結構元素進行型態學處理以
 
圖 19 顯示六張瑕疵太陽能晶片影像檢測結果，其中(a1)-(d1)為四張黑色鋸
痕瑕疵影像; (e1)-(f1)為兩張白色鋸痕瑕疵影像; (a2)-(f2) 相對應的六張傅立葉頻
譜; (a3)-(f3)相對應的六張傅立葉重建影像，顯示所有複雜的背景晶格紋路皆被去
除; (a4)-(f4)個別的瑕疵檢測結果，檢測結果顯示所有鋸痕瑕疵皆被正確的檢測出
來。為了評估本方法之成效，我們總共針對 50 張多晶矽太陽能晶片影像進行檢
測，其中包含 30 張無瑕疵得晶片影像，20 張具有鋸痕瑕疵影像，而誤判率為 5
％ (1/20)，唯一誤判之瑕疵如圖 20 顯示漏判瑕疵之影像，其中(a)顯示為一張擦
傷瑕疵影像，並非鋸痕瑕疵；(b)為圖(a)之強化影像
(d 1.0 則該擦傷瑕疵亦可被檢
測出
對各種 mura 樣本的檢測結果：圖 21 顯示五張液晶顯示器面板影像，
中(a1) 無瑕疵影像；(b1)為亮 mura 瑕疵影像；(c1)為暗 mura 瑕疵影像；(d1)
疵影像；(a2)-(e2)為個別的強化影像，
利瑕疵觀察；(a3)-(e3)為本研究方法在水平方向偵測結果; (a4)-(e4)為垂直方向
之檢測流程圖。 
 
考慮多個特徵
標於同一像素點，找尋其它能夠描述影像紋理之特徵向量，透過不同的特徵向
來。 
 
4.2.3 低對比且光源不均影像瑕疵檢測 
 
 為了驗證本研究提出的 Hough-like 直線偵測法對於低對比且光源不均影像
的適用性，本研究直接使用此檢測法對液晶顯示器面板(LCD)進行瑕疵檢測。液
晶顯示器面板影像的特性為低對比且光源不穩定，正符合本研究針對的影像特性
所開發之檢測方法，而液晶顯示器面板會出現的瑕疵稱為 mura (日譯為「斑」)，
該瑕疵在影像中的特性亦為瑕疵邊界模糊且與背景之對比低，因此適用於本研究
方法。以下為
其
為 gravity mura 瑕疵影像；(e1) 為弱線瑕
以
偵測結果; (a5)-(e5)水平及垂直方向偵測結果之聯集。結果顯示本研究方法亦可有
效的在液晶顯示器影像上進行瑕疵偵測。 
 
4.3 均值移動(Mean-shift)平滑技術於多晶矽太陽能表面瑕疵檢測 
 
    本研究針對異質性紋路之多晶矽太陽能晶片上之指觸或污漬瑕疵進行分
析，利用熵指標檢測異質性紋路影像，檢測結果如圖 22 所示。圖 22 為熵指標檢
測多晶矽太陽能正常和瑕疵影像調整 sh (空間頻寬)之管制界限結果圖。實驗結果
顯示透過 Mean-shift 平滑技術可有效達到區分正常背景和瑕疵區域之檢測目
的。圖 23 為熵指標檢測多晶矽太陽能晶片
 
 在未來研究之方向上，可針對不同瑕疵類型之測試樣本，同時
指
量組合，驗證 Mean-shift 平滑技術於多晶矽太陽能晶片上之不同瑕疵類型的檢
測。 
 19
六、參考文獻 
Acton, S. T., J. P. Havlicek and A. C. Bovik, 2001, “Oriented texture completion by 
AM-FM reaction-diffusion,” IEEE Trans. Image Processing, Vol. 10, pp. 885-896. 
 
Bodnarava, A., M. Bennamoun and S. J. Latham, 2000, “Constrained minimization 
approach to optimize Gabor filters for detecting flaws in woven textiles,” Proc. of the 
IEEE Int’l. Conf. of Acoustics, Speech and Signal Processing, Vol. 6, pp. 3606-3609. 
 
Carreira-Perpiñán, M. Á., 2007, “Gaussian mean-shift is an EM algorithm,” IEEE 
Trans. Pattern Analysis Mach. Intell., Vol. 29, pp. 767-776. 
 
Carreira-Perpiñán, M. Á., 2006, “Fast non-parametric clustering with Gaussian 
blurring mean-shift,” Proc. of the 23rd Int’l. Conf. on Machine Learning, Pittsburgh, 
PA, pp. 153-160. 
 
Chan, C. H. and K. H. Pang, 2000, “Fabric defect detection by Fourier analysis,” 
IEEE Trans. Industry Applications, Vol. 36, pp. 1267-1276. 
 
Chao, S. M., D. M. Tsai, W. C. Li and W. Y. Chiu, 2010, “A generalized anisotropic 
diffusion for defect detection in low-contrast surfaces,” 20th International Conference 
on Pattern Recognition(ICPR), Istanbul, Turkey. 
 
Chiu, W. Y. and D. M. Tsai, 2012, “ICA-based Action Recognition for 
Human-computer Interaction in Disturbed Backgrounds,”7th International Joint 
Conference on Computer Vision, Imaging and Computer Graphics Theory and 
Applications (VISIGRAPP 2012), Rome, Italy. 
 
Comaniciu D., P. Meer, 2002, “Mean shift: a robust approach toward feature space 
analysis,” IEEE Trans. Pattern Analysis and Machine Intelligence, Vol. 24, pp. 
603-619. 
 
Comaniciu, D., V. Ramesh and P. Meer, 2000, “Real-time tracking of non-rigid 
objects using mean shift,” Proc. of IEEE Conf. on Computer Vision and Pattern 
Recognition, Vol. 2, pp. 142-149. 
 
Conners, R. W., C. W. Mcmillin, K. Lin and R. E. Vasquez-Espinosa, 1983, 
“Identifying and locating surface defects in wood: part of an automated lumber 
processing system,” IEEE Trans. Pattern Anal. and Mach. Intell., Vol. PAMI-5, pp. 
573-583. 
 
Di Zenzo, S., 1986, “A note on the gradient of the gradient of a multi-image,” 
Computer Vision Graphics Image Processing, Vol. 23, pp. 116-125. 
 
Escofet, J., M. S. Millan, H. Abril and E. Torrecilla, 1998, “Inspection of fabric 
resistance to abrasion by Fourier analysis,” Proc. of SPIE, Vol. 3490, pp. 207-210. 
 
Fairchild, M. D, 1998, Color Appearance Models, Addison-Wesley, Reading, Mass. 
 
 21
 
Ordaz, M. A. and G. B. Lush, 2000, “Machine vision for solar cell characterization,” 
Proc. of SPIE, Vol. 3966, pp. 238-248. 
 
Palathra, T. C., “Process modeling of a wire saw operation,” in Faculty of the 
Graduate School of the University of Maryland, College Park. 2008. 
 
Park, H., S. Kwon, J. S. Lee, H. J. Lim, S. Yoon, D. Kim, 2009, “Improvement on 
surface texturing of single crystalline silicon for solar cells by saw-damage etching 
using an acidic solution,” Sol. Energy Mater. Sol. Cells, vol. 93, pp. 1773-1778. 
 
Paschos, G., 2000, “Fast color texture recognition using chromaticity moments,” 
Pattern Recognition Letters, Vol. 21, pp. 837-841. 
 
Perona, P. and J. Malik, 1990, “Scale space and edge detection using anisotropic 
diffusion,” IEEE Trans. Pattern Analysis and Machine Intelligence, Vol. 12, pp. 
629-639. 
 
Pilla, M., F. Galmiche, X. Maldague, 2002, “Thermographic inspection of cracked 
solar cells,” Proc. of SPIE, Vol. 4710, pp. 699-703. 
 
Polzleitner, W. and G. Schwingskakl, 1999, “Quality classification of wooden surfaces 
using Gabor filters and genetic feature optimization,” Proc. of SPIE, Vol. 3837, pp. 
200-231. 
 
Raghu, P. P. and B. Yegnanarayana, 1996, “Segmentation of Gabor-filtered textures 
using deterministic relaxation,” IEEE Trans. Image Processing, Vol. 5, pp. 1625-1634. 
 
Ramana, K. V. and B. Ramamoorthy, 1996, “Statistical methods to compare the 
texture features of machined surfaces,” Pattern Recognition, Vol. 29, pp. 1447-1459. 
 
Sapiro. G. and D. L. Ringach, 1996, “Anisotropic diffusion of multivalued images 
with applications to color filtering, ” IEEE Trans. Image Processing, Vol. 5, pp. 
1582-1586. 
 
Shah, B., 2008, “Solar cell supply chain,” Asia Pacific Equity Research, Available 
online: http://tinyurl.com/5hjtpw. 
 
Siew, L. H., R. M. Hodgson and E. J. Wood, 1988, “Texture measures for carpet wear 
assessment,” IEEE Trans. Pattern Analysis and Machine Intelligence, Vol. 10, pp. 
92-105. 
 
Su, M. S., C. Y. Chen and K. Y. Cheng, 2002, “Smoothing of 3D polygon meshes 
using non-linear diffusion equations,” Computer Graphics Workshop, Tainan, Taiwan, 
pp. 1-7. 
 
Sum, C. and W. G. Wee, 1982, “Neighboring gray level dependence matrix,” 
Computer Vision Graphics Image Processing, Vol. 23, pp. 341-352. 
 
Swain, M. J., and D. H. Ballard, 1991, “Color indexing,” International Journal of 
 23
 25
Tsuji, H., T. Sakatani, Y. Yashima and N. Kobayashi, 2002, “A nonlinear 
spatio-temporal diffusion and its application to prefiltering in MPEG-4video coding,” 
Image Processing Conf., New York, NY, Vol. 1, pp. 85-88. 
 
Weszka, J. S., C. R. Dyer and A. Rosenfeld, 1976, “A comparative study of texture 
measure for terrain classification,” IEEE Trans. System, Man and Cybern., Vol. 
SMC-6, pp. 269-285. 
 
Wiltschi, K., A. Pinz and T. Lindeberg, 2000, “Automatic assessment scheme for steel 
quality inspection,” Machine Vision and Applications, Vol. 12, pp. 113-128. 
 
林明獻，2007 年，「太陽電池技術入門」，全華圖書股份有限公司。 
 
   
(a1) 通過瑕疵區域的第225列掃描線 (b1) 通過正常區域的第405列掃描線 
  
(a2) 圖(a1)第225列灰階掃描線 (b2) 圖(b1)第405列灰階掃描線 
  
(a3) 圖(a1)的梯度影像 (b3) 圖(b1)的梯度影像 
  
(a4) 圖(a3)第225列梯度掃描線 (b4) 圖(b3)第405列梯度掃描線 
 
圖2 多晶太陽能晶片瑕疵與正常區域一維灰階值與梯度值掃描線 
 
   
(a) (b) 
  
(c) (d) 
圖 5. 太陽能晶片影像: (a) 正常太陽能晶片; (b) 黑色鋸痕瑕疵; (c) 白
色鋸痕瑕疵; (d) 髒污瑕疵；其中(a)-(c)為紅外線背光取得之影
像，(d)為正向光源取得之影像。 
 
 
 
圖 6. 模糊太陽能晶片晶格之取像架構 
 
 
 r
w
 
(a) 
  
(b) (c) 
圖 9. (a) 傅立葉頻譜去除區域之示意圖; (b) 圖 5(b)影像之傅立葉頻譜; (c) 
對(b)去除低頻帶之傅立葉頻譜。 
 
  
(a1)  (a2) 
 
   
(b1) (b2) 
圖 10. 太陽能晶片之傅立葉重建影像: (a1) 圖 1(a)之重建影像; (b1) 圖 1(b)
之重建影像; (a2)與(b2)個別為(a1)與(b1)中的灰階掃瞄線 1 與掃瞄線
2 之灰階曲線圖。 
Scan line 1 
Scan line 2 
0
50
100
150
200
250
100
150
200
250
    
(a) 原始影像 (b) 改善後之非線性擴散處理 
K =4  T =3 
(c) |(a)-(b)|消除雜訊並填補
瑕疵之結果 
 
圖13. 灰階非線性擴散模式檢測多晶太陽能晶片II之微裂瑕疵結果 
 
 
 
   
(a) 原始影像 
 
(b) 改善後之非線性擴散處理 
K =4  T =3 
(c) |(a)-(b)|閥值分割 4
 
圖14. 灰階非線性擴散模式檢測多晶太陽能晶片III之微裂瑕疵結果 
 
 
 
   
(a) 原始影像 (b) 改善後之非線性擴散處理 
K =4  T =3 
(c) |(a)-(b)|閥值分割  4  
 
圖15. 灰階非線性擴散模式檢測正常多晶太陽能晶片之結果 
 
    
(a1) (a2) (a3) (a4) (a5) 
   
(b1) (b2) (b3) (b4) (b5) 
   
(c1) (c2) (c3) (c4) (c5) 
   
(d1) (d2) (d3) (d4) (d5) 
圖 17. 去晶格影像的髒污瑕疵偵測: (a1) 無瑕疵影像; (b1)-(d1) 髒污瑕疵影像分別為絲
狀、帶狀與波浪狀瑕疵; (a2)-(d2) 個別的強化影像; (a3)-(d3) 水平方向偵測結果; 
(a4)-(d4) 垂直方向偵測結果; (a5)-(d5)水平及垂直方向偵測結果之聯集。 
 
  
(a1) (a2) (a3) (a4) 
  
(b1) (b2) (b3) (b4) 
  
(c1) (c2) (c3) (c4) 
  
(d1) (d2) (d3) (d4) 
  
(e1) (e2) (e3) (e4) 
  
(f1) (f2) (f3) (f4) 
圖 19. 瑕疵太陽能晶片影像檢測結果: (a1)-(d1)為四張黑色鋸痕瑕疵影
像; (e1)-(f1)為兩張白色鋸痕瑕疵影像; (a2)-(f2) 相對應的六張傅
立葉頻譜; (a3)-(f3)相對應的六張傅立葉重建影像; (a4)-(f4)個別的
瑕疵檢測結果，檢測結果顯示所有鋸痕瑕疵皆被正確的檢測出來。 
 
    
(a1) 正常影像 1 (a2) 15sh  (a3) 20sh  (a4) 25sh  
 
    
(b1) 正常影像 2 (b2) 15sh  (b3) 20sh  (b4) 
 
25sh  
    
(c1) 正常影像 3 (c2) 15sh  (c3) 20sh  (c4) 
 
25sh  
    
(d1) 正常影像 4 (d2) 15sh  (d3) 20sh  (d4) 
 
25sh  
    
(e1) 瑕疵影像 1 (e2) 15sh  (e3) 20sh  (e4) 
    
圖 22. 多晶矽太陽能正常和瑕疵影像調整視窗大小 之管制界限結果圖 
固定參數：
25sh  
sh
)4,100,109,00001.0,4(),,,,,( , CTwTh NGshiftr  A
輸入測試影像 ),( yxf  
設定檢測 質性紋路之參數： )、 灰階頻寬)、
) 控制管制界限之常數) 梯度閥值) 
sh rh (
GT
(空間頻寬異
shiftT (停止條件 、C ( (、
將影像中像素點之灰階值 ),( yxf 資訊，轉換為角度 ), yx( 資訊





 
),1(),1(
)1,()1,(tan),( 1
yxfyxf
yxfyxfyx  
 
圖 23.異質性紋路表面之瑕疵檢測流程圖 
像素點之 
Yes 
No
視為正常區域且不考慮
Mean-shift 平滑計算 
並令
梯度值是否大於梯度閥值
GTyxg ),(  0),( yxE  
在固定大小之視窗範圍內，計算出影像中每個邊緣點之熵值 
(將灰階影像 轉換為熵值影像
)(log)(),( i
i
i ppyxE     
),( yxf ),( yxE ) 
將計算出來之熵值影像 進行 Mean-shift 平滑處理 
為 經 Mean-shift 之收斂座標點 
),( yxE
),(),( ** yxEyxE   
),( ** yx ),( yx
以管制界限設定特徵指標的閥值 
        其中 ：Mean-shift 處理後之熵值影像平均值 
             

 
otherwise,)(255
)(),( if),(0
),( 正常點
瑕疵點 EE σCuyxEyxE  
Eu
E ：Mean-shift 處理後之熵值影像標準差 
區分出正常和瑕疵區域之像素點(參見公式 3-28) 
表 Y04 
行政院國家科學委員會補助國內專家學者出席國際學術會議報告 
                                                      2010 年  09 月  6  日 
報告人姓名  蔡篤銘 
 
服務機構
及職稱 
 
元智大學工業工程與管理系所 
 
     時間 
會議 
     地點 
 
2010/08/20 至 08/30 
土耳其、伊斯坦堡 
本會核定
補助文號
NSC 98-2221-E-155-030-MY3 
會議 
名稱 
20th International Conference on Pattern Recognition (ICPR 2010) 
發表 
論文 
題目 
A generalized anisotropic diffusion for defect detection in low-contrast surfaces 
報告內容應包括下列各項： 
一、參加會議經過 
第 20屆資料辨識模式國際研討會(ICPR2010)是資料模式辨識(Pattern Recognition)領域中
最盛大的國際研討會，是由 International Association for Pattern Recognition (IAPR)主辦，
議程包含資料辨識的各大研究領域，其中有電腦視覺、人機介面、資料模式辨識與機器
學習、生醫訊號分析等議程。本次參與 ICPR Poster Session中所發表之題目為A generalized 
anisotropic diffusion for defect detection in low-contrast surfaces，進行一整個下午的現場成果展
示，現場其他參觀學者提問亦十分踴躍，也藉此機會與許多國外學者交流，提供了相當
寶貴的經驗，而本屆會議正式於 08/26 下午六點圓滿結束。 
 
二、與會心得 
本次研討會為資料辨識領域中相當重要之國際研討會，在會中看到了許多新穎的概念及
想法，但在議程的安排上並不理想，議程同時舉行 9 個 Session，使參加的學者容易分散
或增加奔波兩邊會場的困擾，本屆研討會中，除了能夠在國際場合中推廣研究的成果，
也藉此吸引許多國外研究單位主動的接觸交流，瞭解資料辨識的市場與重要性，也期許
台灣能在這塊領域持續深耕。 
 
三、考察參觀活動(無是項活動者省略) 
無 
四、建議 
在此次規模如此龐大的研討會場中，安排議程與場次的策略並不理想，以工業工程的角
度而言，許多流程與作業有改善的空間，且議程的安排也不應與太多場次重疊，造成人
員的分散，可增加接觸國外專家學者的機會，且足夠的演講時間使得演講者可以完整詳
盡的報告研究成果，另外則是本次會議遠在土耳其，而會場的亞洲人大部分來自中國與
韓國，雖然演講報告水準仍不穩定，但可見其國家的經濟實力正逐漸提升，也大力支持
研究人員出席國際會議，期待未來台灣在國際會議場合也有更多發揮及表現的機會。 
 
五、攜回資料名稱及內容 
ICCV 2009 研討之會議論文全文光碟，光碟內容收錄與會之所有論文全文。 
 
LCD panels. A bivariate polynomial model was used 
to estimate the background surface. 
    In this paper, an anisotropic diffusion scheme is 
proposed to detect the subtle defects in low-contrast 
surface image. Anisotropic diffusion model was first 
introduced by Perona and Malik [4] in image 
processing for scale-space description and edge 
detection. The approach is basically a modification of 
the linear diffusion (or heat equation), and the 
continuous anisotropic diffusion is given by 
    )],(I  ),(c[ 
 
),(I yxyx
t
yx
tt
t ∇⋅=∂
∂ div               (1) 
where ),(I yxt  is the image at time t, div the 
divergence operator, ),(I yxt∇  the gradient of the 
image and ),(c yxt  the diffusion coefficient. The 
diffusion coefficient tc  is generally selected to be a 
nonnegative function of gradient magnitude so that 
small variations in intensity such as noise or shading 
can be well smoothed, and edges with large intensity 
transition are distinctly retained. The model can only 
smooth noise, but cannot intensify low-contrast edges. 
In this paper, we propose an anisotropic diffusion 
model with a generalized diffusion coefficient function 
to detect defects in low-contrast surface images. The 
proposed method can distinctly enhance low-contrast 
defects and uniformly smooth the background without 
intensifying textured patterns and uneven illumination 
so that a simple binary thresholding can be effectively 
applied to segment defects in the diffused image. 
2. Adaptive anisotropic diffusion model 
2.1. Perona-Malik anisotropic diffusion  
Let ),(I yxt  be the gray-level at coordinates ),( yx  
of a digital image at iteration t, and ),(I0 yx  the 
original input image. The continuous anisotropic 
diffusion in eq. (1) can be discretely implemented by 
using four nearest neighbors and the Laplacian 
operator [4]: 
    ∑
=
+ ∇⋅+=
4
1
ii
1 )],(I  ),(c[4
1),(I),(I
i
tttt yxyxyxyx        (2) 
where ),(Ii yxt∇ , i = 1, 2, 3 and 4, represent the 
gradients of four neighbors in the north, south, east and 
west directions, respectively. ),(ci yxt  is a function of 
the gradient ),(Ii yxt∇  in the Perona-Malik model, i.e.,  
)),(I(),( ii yxgyx tt ∇=c  
For the sake of simplicity, ),(Ii yxt∇  is subsequently 
denoted by I∇ . The function )I(∇g  should result in 
low coefficient values at image edges that have large 
gradients, and high coefficient values for pixels within 
an image region with low gradients.  In the Perona-
Malik anisotropic diffusion model, a possible diffusion 
coefficient function is given by 
])KI(1[1)I( 2∇+=∇g                       (3) 
where the parameter K is a constant, and must be fine-
tuned for a particular application. Parameter K in the 
diffusion coefficient function acts as an edge strength 
threshold. If the K value is too large, the diffusion 
process will over-smooth and result in a blurred image. 
In contrast, if the K value is too small, the diffusion 
process will stop the smoothing in early iterations and 
yield a restored image similar to the original one. 
 
    The classical Perona-Malik model only stops the 
smoothing process in image areas with large gradient 
magnitude. Therefore, it cannot effectively enhance the 
subtle defects in a low-contrast image. The parameter 
value of K must be manually and empirically 
determined for different surface patterns. 
2.2. Generalized diffusion coefficient function 
    In this paper, we propose a generalized diffusion 
coefficient function based on a linear-logarithmic 
function. It controls the function curve by changing the 
parameter values of the linear-logarithmic function so 
that different function curves can be flexibly used for 
different diffusion applications. The proposed 
generalized diffusion coefficient function )I(∇g  is 
given by 
                    γβα ++∇⋅=∇ )Iln()I(g                (4) 
 
where α , β  and γ  are curve parameters. Parameter 
α  is the slope of the linear-logarithmic function, 
which determines the increment (α >0) or decrement  
( α <0) of the function. A decreasing diffusion 
coefficient provides both smoothing and sharpening 
effects for the image and, therefore, the parameter 
value of α  is always negative in this study. A larger 
value of α  will result in a larger sharpening effect. 
Parameter γ  is the intercept of the linear-logarithmic 
function, which gives the starting diffusion coefficient 
value of )I(∇g  at 0I =∇ . A larger value of γ  will 
provide a strong smoothing effect, whereas a smaller 
value of γ  will give a weak smoothing effect. Offset 
Figures 3(a)-(c) demonstrate one faultless and two 
defect images of backlight panel surfaces. Figures 
3(d)-(f) present the enhanced images. The results from 
the proposed diffusion model are presented in Figures 
3(g)-(i), which show that all subtle defects are well 
enhanced in the diffused images. Figures 3(j)-(l) 
illustrate the thresholding results of the filtered images 
in Figures 3(g)-(i) as binary images (using the 3-sigma 
statistical control limits). In the faultless surface image 
of Figure 3(a), the resulting binary image is uniformly 
white and no defect is claimed. In the defective images  
   
(a) (d) (g) (j) 
   
(b) (e) (h) (k) 
   
(c) (f) (i) (l) 
Figure 3. Diffusion results of backlight panel surfaces: (a)-(c) 
a faultless and two defective test images; (d)-(f) contrast-
stretched images of (a)-(c), respectively; (g)-(i) respective 
diffusion results with 1) 1, (-0.9,),,( =γβα  for all samples; 
(j)-(l) thresholding results using the 3-sigma control limits.  
 
   
(a) (d) (g) (j) 
   
(b) (e) (h) (k) 
   
(c) (f) (i) (l) 
Figure 4. Diffusion results of LCD glass substrates: (a)-(c) a 
faultless and two defective test images; (d)-(f) contrast-
stretched images of (a)-(c), respectively; (g)-(i) respective 
diffusion results with 0.8) 1, (-0.6,),,( =γβα  for all 
samples; (j)-(l) thresholding results using the 3-sigma control 
limits.  
of Figures 3(b)-(c), all hardly-visible defects are well 
detected. 
    Figure 4 demonstrates further the detection results 
of LCD glass substrate images that contain horizontal 
structure patterns on the surfaces. Figure 4(a) is a clear 
glass substrate image, and Figures 4(b) and (c) are two 
defective glass substrate images. The enhanced images 
are shown in Figures 4(d)-(f). The results from the 
proposed diffusion model are illustrated in Figures 
4(g)-(i), which show that the defects are well enhanced 
and the structural background patterns are smoothed. 
Figures 4(j)-(l) demonstrate the detection results as 
binary images using the 3-sigma statistical control 
limits. The thresholding results also reveal that all local 
defects embedded in the low-contrast surface images 
can be effectively detected. 
5. Conclusion 
In this paper, an anisotropic diffusion model with a 
generalized diffusion coefficient function has been 
proposed to detect subtle defects in low-contrast, 
unevenly-illuminated images. The proposed model is 
flexible to implement for defect detection in various 
low-contrast surface images by controlling the curve 
parameter values of the diffusion coefficient function. 
All parameter values of the model can be automatically 
determined without human intervention. Experimental 
results have shown that the proposed diffusion model 
can be well applied to low-contrast images of backlight 
panels and LCD glass substrates. 
References 
[1] F. Saitoh, “Boundary extraction of brightness unevenness 
on LCD display using genetic algorithm based on perceptive 
grouping factors”, Proceedings of the International 
Conference on Image Processing, Kobe, Japan, Oct. 1999, pp. 
308-312. 
[2] W.S. Kim, D.M. Kwak, Y.C. Song, D.H. Choi and K.H. 
Park, “Detection of spot-type defects on liquid crystal 
display modules”, Key Engineering Materials 270-273, 2004, 
pp. 808-813. 
[3] J.Y. Lee, S.I. Yoo, “Automatic detection of region-mura 
defect in TFT-LCD”, IEICE Trans. Inf. and Syst., 2004, pp. 
2371-2378. 
[4] P. Perona, J. Malik, “Scale-space and edge detection 
using anisotropic diffusion”, IEEE Transactions on Pattern 
Analysis and Machine Intelligence, 1990, pp. 629-39. 
[5]  J. Kennedy, R. Eberhart, “Particle swarm optimization”,  
Proceedings of the IEEE International Conference on Neural 
Networks, Perth, Australia, 1995, pp. 1942-1948. 
 Automatic Saw-Mark Detection  
in Multicrystalline Solar Wafer Images 
 
Wei-Chen Li1 and Du-Ming Tsai† 2 
Department of Industrial Engineering and Management 
Yuan-Ze University, Chungli, Taoyuan, 32003, Taiwan. 
Email: s958909@mail.yzu.edu.tw1 
iedmtsai@saturn.yzu.edu.tw2 
 
 
Abstract. This paper presents a method of automatic defect inspection for the photovoltaic industry, with a 
special focus on multicrystalline solar wafers. It presents a machine vision-based scheme to automatically 
detect saw-mark defects in solar wafer surfaces. A saw-mark defect is a severe flaw that occurs when a silicon 
ingot is cut into wafers. Early detection of saw-mark defects in the wafer cutting process can reduce material 
waste and improve production yields. A multicrystalline solar wafer surface presents random shapes, sizes, 
and orientations of crystal grains in the surface, making the automatic detection of saw-mark defects 
extremely difficult. The proposed saw-mark detection scheme involves two main procedures: 1) Fourier image 
reconstruction to remove the multi-grain background of a solar wafer image, and 2) a line detection process 
in the reconstructed image to locate saw-marks. The Fourier transform (FT) is used to eliminate crystal grain 
patterns and results in a non-textured surface in the reconstructed image. Since a saw-mark is presented 
horizontally in the sliced wafer, vertical scan lines in the reconstructed image are individually evaluated by a 
line detection process. A pixel far away from the line sought can then be effectively identified as a defect point. 
Experimental results show that the proposed method can effectively detect various saw-mark defects, 
specifically black lines, white lines, and impurities in multicrystalline solar wafers. 
 
Keywords: Surface inspection; Defect detection; Multicrystalline silicon; Solar wafer; Saw mark; Fourier 
transform.  
 
 
1. INTRODUCTION 
 
Solar power is an attractive alternative source of 
electricity today. Silicon solar cells convert photons from 
the sun to electricity. Among the currently available solar 
cell technologies, multicrystalline solar cells dominate the 
market share and are more popular than monocrystalline 
solar cells owing to their lower manufacturing costs. A 
main category of defects found in silicon solar wafers is 
“saw-marks”. They occur when a silicon ingot is sliced into 
wafers. This paper presents a machine vision-based scheme 
to automatically detect saw-mark defects in multicrystalline 
solar wafers. 
 
Most solar cell production requires the cutting of 
silicon ingots into wafers. Multi-wire sawing is the 
dominant slicing technique in the photovoltaic (PV) 
industry. A multi-wire sawing machine consists of a single 
bronze coated stainless steel wire up to several hundreds of 
kilometers long [1, 2]. The wire is looped continuously and 
is wound on constant pitch grooves to create a web that 
generally consists of 500~700 parallel wires so that the 
ingot can be sliced into multiple wafers at the same time.  
 
Saw damage on the wafer surface is a micro defect 
produced by the wire sawing process. It induces the 
generation of non-uniform dislocation densities [3]. The 
high-density dislocations are difficult to passivate. They 
show high recombination rates to the detriment of the 
lifetime of minority charge carriers [4] and thus decrease 
the conversion efficiency of solar cells. Du et al. [5] 
investigated how foreign inclusions cause defective wafer 
surfaces and broken wires in the wafer sawing process. 
Generally, minor saw damage can be removed by alkali 
etching [6]. Saw marks, however, are a form of serious saw 
damage and cannot be effectively removed by the etching 
process. If the height/depth of a saw-mark exceeds 10~15 
μm in the slicing process, it becomes a noticeable defect in 
the wafer surface [7]. Saw-marks should be detected 
immediately after the slicing process so that the process 
________________________________________ 
† : Corresponding Author 
 to construct a feature extraction system for marble tile 
inspection. In that method, the average of the eight Gabor 
response values is calculated and three quantitative scores 
are used to assign the percentages of veins, spots, and 
swirls as the features for classification. Xie and Mirmehdi 
[19-21] presented an automatic defect detection method for 
random color-texture surfaces. It generates a set of texture 
exemplars by exploring a Gaussian mixture model from 
defect-free image patches, and uses them for defect 
detection in marble tiles. Liu and Pok [22] proposed a 
texture edge detection method that includes encoding and 
prediction modules for texture classification. The encoding 
module first projects multi-dimensional texture features 
onto a 1-dimensional feature map through an SOFM (Self-
Organizing Feature Map) algorithm to obtain scalar 
features, and then the prediction module computes the 
direction of scalar features with respect to their eight 
direction neighbors. They applied the method on micro-
texture images such as fabric and sand. The above-
mentioned methods focus only on marbles or granites in 
which the surfaces do not show sharp and clear edges 
between grains.  
 
The multicrystalline solar wafer shows multiple 
random grains in the surface. A local defect-detection 
approach that relies on the unique features in a small 
neighborhood window cannot be effectively used to detect 
saw-mark defects. A saw-mark in a small local region 
presents no gray-level or structural differences from any 
small regions in the grained background. The spatial 
domain methods that rely on local texture features in a 
small neighborhood window cannot be well applied to 
extract consistent feature values when the neighborhood 
window slides pixel by pixel over the image. This paper 
therefore proposes a global spectral-domain solution to 
detect saw-mark defects in multicrystalline solar wafers. 
Unlike the extraction of local texture features and filtering 
response of local convolution, the global image 
reconstruction eliminates the main background pattern and 
preserves local saw-mark defects in the reconstructed 
image by using the Fourier transform (FT). 
 
The proposed defect detection scheme involves two 
main procedures: Fourier image reconstruction to remove 
the multi-grain background of a solar wafer image, and 
then the Hough transform in the reconstructed image to 
detect saw-marks. The global multi-grain structure of a 
solar wafer surface displays clear grain boundaries with 
complex directions and various gray-levels in the sensed 
image. In the Fourier spectrum, the approximation (i.e., the 
smooth version) of any textured pattern in an image is 
concentrated around the low-frequency region, whereas the 
details of a saw-mark across the wafer surface in the image 
will appear in the high-frequency region. By eliminating 
the Fourier frequency components that describe the global 
multi-grain background of the solar wafer surface and then 
back-transforming the spectrum image using the inverse 
Fourier transform, the 2D Fourier reconstruction process 
can effectively smooth the global background pattern and 
well preserve local saw-mark defects. The reconstructed 
image results in a low-contrast surface, where the multi-
grain background is significantly smoothed as a non-
textured surface and the saw-mark is retained without 
showing sharp and clear edges from its surroundings. 
Simple segmentation techniques such as binary 
thresholding and gradient edge detection cannot be applied 
for detecting saw-mark defects in the low-contrast 
reconstructed image. 
 
Since the saw-mark appears horizontally in the sensed 
image, each vertical scan line of the gray-level profile in 
the reconstructed image is individually evaluated. A one-
dimensional line detection procedure is then proposed to 
identify the saw-mark defect in the Fourier reconstructed 
image, which has a low-contrast and uneven background. 
The 1D gray-level profile in the reconstructed image 
appears as a non-stationary line. Finding a line segment in a 
noisy non-stationary signal is a nontrivial problem. The 
Hough transform (HT) [23] is the most commonly used 
technique for straight-line detection in a noisy image. It has 
been popularly applied to straight line detection since Duda 
and Hart [24] proposed the parameter space transform 
method. The traditional HT for line detection in an image is 
based on a voting procedure that accumulates the number 
of points that lie on the same line of specific parameter 
values.  
 
The 1D gray-level signal in the Fourier reconstructed 
image shows the trend of a straight line with non-stationary 
variation, and the defect part does not show clear edges 
separating it from its surroundings in the gray-level profile. 
The standard HT requires a sufficient number of points 
lying exactly on the same straight line so that the 
accumulator will show a distinct peak in the parameter 
space to indicate the presence of a straight line. It fails to 
detect a line that has numerous points distributed around 
the vicinity of the line in a non-stationary signal. In the 
Hough transform-based scheme, a revised version of the 
HT is proposed for line detection in non-stationary gray-
level profiles in the Fourier reconstructed image. A pixel far 
away from the line sought can then be effectively identified 
as a defect point. By vertically scanning line-by-line 
throughout the whole reconstructed image, a saw-mark 
defect in the 2D image can be detected and located. 
 
The paper is organized as follows. In section II, the 
Fourier image reconstruction and the Hough-like line 
detection technique are proposed to detect saw-mark 
defects in multicrystalline solar wafer images. In section III, 
the effects of changes in parameter values and experimental 
 
 These frequency components correspond to the 
approximation of the multi-grain background of a solar 
wafer. The frequency components distributed along lines in 
the spectrum image represent the main directions of the 
grain edges in the solar wafer surface. The spectrum of the 
high frequency components falls off rapidly with increased 
distance from the DC. In Fig. 2(b2), the Fourier spectrum 
of the defective image shows not only a circular high-
energy region in the low-frequency band but also a distinct 
vertical line corresponding to the horizontal saw-mark. 
 
In order to smooth the multi-grain texture, the 
frequency components with high power magnitudes around 
the DC are set to zero so that the global representation of 
the multi-grain pattern will not appear in the reconstructed 
image. Figure 3 (a) depicts the band rejection region with 
 for all frequency components inside the circle 
of radius 
0),( vuF
r  except the vertical notch with width  in 
the spectrum image. The width  is an odd number. In 
this study,  is set to one to preserve the possible saw-
mark, and radius 
w
w
w
r  is set to 30 pixels to remove the global 
multi-grain background for a Fourier spectrum image of 
size 256×256. Figure 3(b) presents the Fourier domain 
image of the defective image in Fig. 1(b). Figure 3(c) 
shows the band-rejection region in the Fourier spectrum 
image, where the black region represents the low-frequency 
band with , and all the remaining frequency 
components remain unchanged. The band-rejection filtering 
is given as follows: 
0,v) (uF
 

  otherwise     ),(     )2or   2 (  and   if              0),(ˆ
222
vuF
wuwurvuvuF (4)
 
After scanning all frequency components   in the Fourier 
spectrum, the reconstructed image can be obtained using 
the discrete inverse Fourier transform (DIFT). That is, 
 
 
 

2
2
2
2
)](2exp[),(ˆ),(ˆ
M
Mu
N
Nv
NvyMuxjvuFyxf    
r
w
 
(a) (b) (c) 
Fig. 3. (a) Sketch of the band rejection region for background removal; (b) 
Fourier domain image of Fig. 1 (b); (c) band-rejection region of the 
spectrum in (b). 
 
  
(a1)  (a2) 
 
   
(b1) (b2) 
Fig. 4. Fourier reconstructed images of solar wafers: (a1) reconstructed 
image of the defect-free wafer in Fig. 1(a); (b1) reconstructed 
image of the defective wafer in Fig. 1(b); (a2) and (b2) 
corresponding gray-level profiles of scan lines in (a1) and (b1). 
0
50
100
150
200
250
100
150
200
250
Scan line 1 
Scan line 2 
 
images in Fig. 4(a1) and (b1), both the scan lines across the 
defect-free region (scan line 1) and the saw-mark defect 
(scan line 2) show non-stationary 1D signals, as seen in Fig. 
4(a2) and (b2), respectively. The 1D gray-level profile in 
the Fourier reconstructed image generally shows the trend 
of a straight line with high gray-level fluctuation. The 
defect part in the gray-level profile does not show clear 
edge changes from its surroundings. In order to detect the 
saw-mark location in a low-contrast, non-stationary 1D 
gray-level profile, we propose a Hough-like line detection 
process to detect the saw-mark points, which are evidently 
far away from the line sought. 
 
The restored image  will be approximately a non-
textured image with an uneven gray-level surface. 
),(ˆ yxf
 
The reconstructed image of the defect-free image in 
Fig. 1 (a) obviously presents a non-textured background 
with minor residuals of the multi-grain edges, as seen in 
Fig. 4(a1). Figure 4(b1) displays the Fourier reconstructed 
images of the saw-mark image in Fig. 1(b). The 
reconstructed image results in a low-contrast surface, where 
the multi-grain background is clearly removed and the 
horizontal saw-mark that crosses over the entire image is 
well retained. The crystal grain pattern in the reconstructed 
background forms an uneven gray-level surface even 
though the sharp grain edges have been removed. In the 
gray-level profiles of vertical scan lines in the reconstructed  
 
2.2 Hough-like line detection 
 
In the standard Hough transform algorithm for 
straight-line detection, the equation used to describe a line 
in two-dimensional space is given by the parameters 
   and   in the normal form: 
 
 sincos  yx   
 
where   is the perpendicular distance of the line to the 
origin, and   is the angle between the normal to the line 
and the positive x-axis. To apply the Hough transform with 
 
 ) ,(ˆ yxf
N
M
……
))( ,( X yfyO
1-N
) ,(ˆ vuF
) ,( yxf
X
1M
 
 
Fig. 6. Construction procedure for the column profile map. 
 
profile map. Figure 6 illustrates an image of size NM  . 
It therefore involves M column profiles. The column profile 
map in the  plane is defined as for 
given the column line image 
 
yfy -
1,- , N
1.- , M
)),(y ,( XfyO
2, 1, 0,y 
2, 1, 0,X 
 
2.3.1 Range of   
 
In the profile map, a point of gray-level profiles is 
marked by 0 (black intensity), and the remaining empty 
space is marked by 1 (white intensity). Once the maps of 
row and column gray-level profiles are separately 
constructed, we can easily find the ranges of   and   
from the maps. The transform representation in the map 
shows a principal direction of the gray-level profiles. Thus, 
we can easily restrict the search range of   within a small 
interval   once the principal direction p  in the 
profile map is determined.  
 
In the proposed search scheme of parameter ranges, 
the ranges of   will be separately estimated from the 
principal direction in profile maps. For the profile map 
, the morphological closing operation is first 
implemented to eliminate the noisy points first, i.e., 
))( ,( X yfyO
 
B)))( ,(())( ,(ˆ XX  yfyOyfyO Ө  B
 
here  and Ө denote, respectively the dilation and 
map sically 
he av our between the
w 
 operosion eration, and B is a 3×3 structuring element. The 
binary closing operation smoothes the contour and removes 
isolated (extreme) points in the profile map. Since the 
majority of the row gray profiles has similar trend of a line 
slop, the upper contour )(ˆU yO  and lower contour )(ˆL yO  
in the filtered profile ))( ,(ˆ X yfyO  are ba
identical in shape. The upper )(y  and lower 
contour )(ˆL yO  in the filtered profile m ))( ,(ˆ X yfyO  
are given by
 
contour ˆUO
a
))}y , 1, 0,y 
))} ,  1, 0,y 
 upper and lo
p 
2, 
2,
wer
  
{Max XX f
{Min XX f
erage cont
( ,(ˆ |)()(ˆ XU fyOyy 
 
O 1- , N  
1- , N  
 contours 
( ,(ˆ |)()(ˆ XL yfyOyy 
 
O
T
can be calculated by 
 
2 ,  1, 0,y 
t in the aver
)](ˆ)( LU yOyOO 
 
he defect-free line segmen  
ˆˆ [)(M y  1- , N  
e contour
2,
agT
)(ˆM yO  is generally longer than any of the defective 
ts. In the filtered profile map, the average contour 
)(ˆM yO  represents the main line slope in the profile map. 
ncipal direction p
segmen
The pri   of an inspection image can thus 
be estimated from the erage contour )(ˆM yO . We only 
need to apply the proposed Hough-like line detection once 
to identify the straight line in the average contour )(ˆM yO  
and use the slope angle of the detected line as the pr  
direction p
av
incipal
 . The possible   range for every gray-level 
profile in the reconstructed image can then be easily 
determined from the principal angle p . 
 
The saw-mark defect ge
in th
nerally appears
he Ho
 horizontally 
e gray-level image and also in the Fourier 
reconstructed image. The expected line sought in the 
yfy -  plane of the average contour )(ˆM yO  will have an 
ation around 0 degrees. In t ugh-like line 
detection process for the average contour )(ˆM yO , the 
possible search range of p
orient
  can thus be set b n -5° etwee
 
 of dista  ,|)( ,( **X yfyD or all points on the gray-
level profil the distance threshold is 
adaptively calculated for each individual gray-level profile. 
In the experiment, the control constant 
nce f)  
e X. Note that 
  is empirically 
given by 1.5 for all gray-level profiles in  test images. A 
defect point will be set to 1 (shown in black) if the distance 
is larger than the control limit, whereas a defect-free one 
will be set to 0 (shown in white) in the resulting binary 
image. The detection result from the column gray-level 
profiles then appears as a binary image ) (X, yB . That is, 
 
all
 ,* 
h tr
x
ple

  yfyB DD0
 )( ,  1) (X, XXX 
 
(a1) (a2) (a3) (a4) 
 
(b1) (b2) (b3) (b4) 
 
  )| *
Houg ansf
lts of e perim
 im ment
otherwise
yDif
   free)-(defect  
(          )(defective
ared with the standa
PERIMENT RESULT
ection presents the res
oposed algorithms
(11) 
 
omp rd orm, the 
prop
. EX S 
his s u ents on a 
num
The pr  were ed on an 
Intel
C
osed Hough transform scheme gives a better straight-
line detection for non-stationary profiles in low-contrast, 
uneven gray-level images. It can well detect a saw-mark 
segment that is evidently deviated from the fitting line. By 
restricting the search ranges of the two line parameters in 
very tight limits based on the common linear trend of gray-
level profiles in a Fourier reconstructed image, the 
proposed method can efficiently detect the best fitting line. 
The computational burden can also be reduced significantly. 
 
(c1) (c2) (c3) (c4) 
 
(d1) (d2) (d3) (d4) 
 3
 (e1) (e2) (e3) (e4) 
 
T
ber of solar wafer images containing various saw mark 
defects to evaluate the performance of the proposed defect 
detection scheme. The test images are 256×256 pixels wide 
with 8-bit gray-levels. A two-dimensional (2D) test image 
thus comprises 256 one-dimensional (1D) column line 
images, each with a length of 256 pixels, in the vertical 
scan direction. All the test images used in the experiment 
were captured from actual solar wafer surfaces. The Fourier 
transforms were adopted from the FFTW (Fastest Fourier 
Transform in the West) software tool [26, 27]. 
 
 Core 2, 3GHz CPU personal computer. The mean 
computation time of the proposed method was 0.26 seconds, 
including both the Fourier image reconstruction and the 
Hough voting process in a 256×256 image. The control 
constant   of the statistical control limit was set at 1.5 
for defect detection. The band-rejection radius r  was 
given by 30, and the width of the vertical notch w  was set 
at 1. All the parameter values of r , w ,   a
(f1) (f2) (f3) (f4) 
Fig. 8. ction results of t-free solar waf ages: (a1)-(f1) s
 
.1 Solar Wafer Defect Detection 
 5×5 average smoothing was first applied to denoise 
the b
 Dete  defec er im ix faultless 
samples; (a2)-(f2) corresponding power spectrum images of (a1)-(f1); 
(a3)-(f3) respective Fourier reconstructed images; (a4)-(f4) detection 
results of the proposed inspection scheme, where no defects are declared. 
3
 
A
ackground of the Fourier reconstructed image. In solar 
wafer manufacturing, all solar wafers are obtained from the 
same sawing orientation, and the possible saw-marks will 
only be created in the horizontal direction in the sensed 
images. Therefore, the defect detection procedure was 
applied only to the vertical direction in a solar wafer image 
in our experiment. Figures 8 and 9 show the detection 
results of the proposed method for defect-free and defective 
solar wafers, respectively. In Fig. 8, the first column ((a1)-
(f1)) presents the six defect-free images for testing, and the 
second column ((a2)-(f2)) shows the corresponding Fourier 
spectra of Fig. 8(a1)-(f1). The third column ((a3)-(f3)) 
presents the individual Fourier reconstructed images, and 
the last column ((a4)-(f4)) shows the detection results of 
the proposed inspection scheme. Any suspected defect 
nd   are 
the same for all test samples i  t e riments. The 
detection results of the test samples are discussed in section 
3.1. The use and potential importance of the saw-mark 
detection system is illustrated in section 3.2. 
 
n he xpe
 
 
      
(a) (b) (c) (d) (e) 
Fig. 10. The mis-detected sample: (a) a wear mark; (b) enhanced image of (a); (c) power spectrum image of (a); (d) Fourier 
reconstructed image; (e) detection result of the proposed inspection scheme with 1.0 . 
 
luminesces with a spectra halogen tube in Near Infrared 
(NIR) range of 1.3 μm wavelength. That wavelength range 
can easily pass through the silicon material and to the 
camera. 
 
The presence/absence of a saw-mark defect in the 
resulting binary image of an inspected wafer can 
be further identified by ontal projection of the binary 
image. Horizontal projection of a horizontal scan line Y in 
the binary image of size M×N is simply given by 
 
(12)
 
where is the accumulated black pixel points along 
horizo n line Y. Since a true saw-mark defect will 
horizo oss over the whole image, the corresponding 
 must contain a distinctly large number of 
black nts in the binary image. Random noise in the 
resulting mage generates only a few black points in 
a horizontal scan line. If is larger than the defect 
size of a use s prespecified hreshold, the inspected image 
evidently contains a saw-mark defect. 
 
The current multi-wire sawing machine can 
simultaneously process four silicon ingots, wherein each 
squared ingot of height 200 mm is sliced into 500 thin 
wafers. It takes around 10 hours to slice the four ingots into 
a total of 2,000 wafers, and an additional 2 hours are 
required for cleaning. The image size used in the 
experiment was 256×256 pixels. Given a spatial image 
resolution of 0.1 mm per pixel, a solar wafer of 156×156 
mm2 thus requires 36 images of size 256×256 pixels to 
complete the inspection of the whole wafer surface. The 
proposed algorithm currently takes 0.26 seconds to process 
a 256×256 image with a pure software implementation on a 
typical personal computer. Therefore, only 9.3 seconds are 
needed to inspect the entire wafer surface. The inspection 
time of the 2,000 sliced wafers is quite compatible with the 
machining time. 
 
In the sawing process, a wafer sliced from the ingot is 
arranged and placed in a storage cassette. Each solar wafer 
in the cassette is automatically transferred to the automatic 
visual inspection system by a conveyor belt. The cassette 
ensures that each solar wafer under testing is well aligned 
horizontally and vertically in the sensed image, and a 
potential saw-mark can thus be horizontally presented in 
the image. This inspection procedure can provide full 
inspection, rather than sampling inspection, and thus can 
effectively increase the yield in solar wafer manufacturing.  
 
The potential importance of the proposed study lies in 
two key areas: 1) inspection of solar wafer quality, and 2) 
process monitoring of multi-wire sawing machine. On-line 
inspection of sliced wafers ensures product quality and 
prevents unsatisfactory wafers from reaching the back-end 
processing, such as etching, texturing and anti-reflection 
coating. It prevents the downstream manufacturer from 
working on a flawed wafer and thus can decrease 
unnecessary operation costs and reworking. Process 
monitoring checks the condition of a machine and takes 
corrective actions for mechanical wear and failure. The 
inspection of currently sliced wafers allows the detection of 
a deteriorating slicing condition. It can shut down a multi-
wire sawing machine when saw-mark defects with 
assignable causes are detected. The silicon ingots in the 
queue will not be further processed until the machine is 
functioning properly. As a result, scrap and material waste 
can be minimized, and the production yield and 
manufacturing cost can be improved accordingly. 
 
CONCLUSION 
 
This paper has proposed a defect detection scheme 
based on Fourier image reconstruction and Hough-like 
nonstationary line detection to identify saw-mark defects in 
multicrystalline solar wafer images. The inhomogeneous 
background of multicrystalline grains in a solar wafer 
image can be effectively removed by properly selecting the 
band-rejection region in the Fourier spectrum. The restored 
image shows a trend of a straight line from each vertical 1D 
gray-level profile. The segment of a vertical scan line 
across the local defect region in the Fourier reconstructed 
image will distinctly deviate from the Hough-like fitting 
line. 
 
The proposed method constructs a profile map by 
overlapping the vertical gray-level profiles in an image to 
find the most likely ranges of the line parameters based on 
the inherited properties of saw-marks in the Fourier 
reconstructed image. The restricted ranges of line 
),( yxB  
 horiz



1
0
),()(
M
x
YxBYH , 1- ,2, 1, 0, NY   
)(YH  
ntal sca
ntally cr
horizontal line
pixel poi
binary i
r’
)(YH  
 t
 
  
search interests include 
utomated visual inspection, object recognition and texture 
address is  
<iedmtsai@saturn.yzu.edu.tw
 
AUTHOR BIOGRAPHIES 
Du-Ming Tsai received the B.S. degree in Industrial 
Engineering from the Tunghai University, Taiwan in 1981, 
and the M.S. and Ph.D. degrees in Industrial Engineering 
from Iowa State University, Ames, Iowa in 1984 and 1987, 
respectively. From 1988 to 1990, he was a Principal 
Engineer of Digital Equipment Corporation, Taiwan branch, 
where his work focused on process and automation 
research and development. Currently he is a Professor of 
Industrial Engineering and Management at the Yuan-Ze 
University, Taiwan. His re
a
analysis. His email 
> 
Wei
Engi
urre e Ph.D. degree in Industrial 
a
obje sis. His email address is  
s958909@mail.yzu.edu.tw
 
-Chen Li received the B.E. degree in Mechanical 
Engineering from the Chung-Hua University, Taiwan in 
2004 and the M.S. degrees in Mechanical and Aerospace 
neering from the Chung-Hua University in 2006. He is 
ntly pursuing thc
Engineering and Management at Yuan-Ze University. His 
rese rch interests include automated visual inspection, 
ct recognition and texture analy
< > 
 
 1
  
Abstract—Action recognition has become more important over 
the past years. The currently existing action recognition 
algorithms have proven successful at the recognition of sign 
language, aerobics, tennis sports, etc. However, most of the 
algorithms require a simple and steady background. They may fail 
when both foreground and background objects present in the 
video sequence are moving. 
In this paper, we propose an independent component analysis 
(ICA) based scheme for action recognition. It uses the exponential 
motion history image (EMHI) for spatiotemporal representation 
of an action, and the discriminant features are then automatically 
extracted from the EMHI by ICA basis image reconstruction. A 
complex action can be constructed with only a few training 
samples of a reference action. If the input video contains an action 
similar to the training sample, then the corresponding EMHI can 
be well reconstructed from the linear combination of the ICA basis 
images. The coefficients of the linear combination are thus used as 
the discriminant feature vector for action classification. 
The proposed method does not require the feature design or 
modeling process, and it is computationally very fast for real-time 
applications. Experimental results show that it is robust on 
disturbed backgrounds where both foreground and background 
objects are moving simultaneously in the scene. The experiments 
also reveal that the proposed method is very effective for 
human-computer interaction. 
 
Keywords—Human-computer interaction; Action recognition; 
Video surveillance; Spatiotemporal representation; Independent 
component analysis. 
 
1. INTRODUCTION 
Action recognition has become more important over the past 
years. There are many potential applications include video 
surveillance, human-computer interaction, gesture recognition, 
and video retrieval. In conventional action recognition 
algorithms, the first processing step is foreground segmentation. 
The foreground person can be segmented using background 
subtraction or temporal differencing. The second step is 
spatiotemporal representation from a chunk of video sequences. 
The third step is the extraction of discriminant features from the 
representation. A good spatiotemporal representation can 
produce distinct features for robust action classification. Finally, 
the last step is to classify the actions based on the extracted 
features.  
A comprehensive review of the research in action recognition 
has been presented in a number of survey papers [1-3]. The 
 
 
techniques for human action recognition can be categorized by 
model-based approach [4-7], optical-flow-based approach 
[8-10], volume-based approach [11-14], and global 
spatiotemporal approach [15-19]. 
Microsoft recently introduced the KINECT device, which 
captures a depth image of the human body by the Infrared 
technique with a distance range from 1 to 6 meters. The Kinect 
device has been well applied for human-computer interaction. 
However, KINECT is an indoor device. It fails in sunlight for 
outdoor applications, and cannot meet the requirements of 
surveillance applications due to the range limitation. 
The currently existing action recognition algorithms have 
proven successful for the recognition of movements in, for 
example, sign language, aerobics, and tennis. However, most of 
the algorithms require a simple and steady background. They 
may fail when both foreground and moving background objects 
are present in the observed scene. 
In this paper, we propose a scheme based on independent 
component analysis (ICA) for action recognition. It uses the 
exponential motion history image (EMHI) for spatiotemporal 
representation of an action, and the discriminant features are 
then automatically extracted from the EMHI by ICA basis 
image reconstruction. A complex action can be constructed with 
only a few training samples of a reference action. ICA is used to 
generate the basis of action templates from the training EMHI 
images. Each action to be recognized can be constructed by a 
linear combination of the ICA basis templates. If the input scene 
video contains an action similar to the training sample, then the 
corresponding EMHI can be well reconstructed from the linear 
combination of the basis templates. The coefficients of the 
linear combination are used as the discriminant feature vector 
for action classification. 
The Euclidean distance between training action data and 
testing data of feature vectors can be calculated. If the input 
scene currently under testing resembles a pre-trained reference 
action, the measured distance should be very small, and all other 
irrelevant actions should result in large distances. The proposed 
method does not require the feature designs or modeling 
processes of individual actions. It needs only a few action 
samples for the training and is robust on disturbed backgrounds 
with both moving foreground and background objects present 
simultaneously in the scene. The proposed method can be 
applied to a moving background environment, such as a street 
scene with moving vehicles. 
ICA-based action recognition for 
human-computer interaction in disturbed 
backgrounds 
Anonymous 
 3
EMHI is suitable for representing multiple foreground 
movements on a disturbed background. In a game-interaction 
scene, for example, the bystanders in the background generally 
stand still, with minor or abrupt movements, while the player 
executes more radical or repetitive movements. In a street scene, 
moving objects such as pedestrians and vehicles simply pass 
through the background scene, and the foreground object shows 
continuous or repetitive motions. The proposed EMHI will 
accumulate quickly the energy of foreground objects with 
continuous motions and increase slightly the energy of moving 
background objects with brief or abrupt motions.  
To compare the effectiveness of spatiotemporal 
representations from the proposed Exponential MHI (EMHI) 
and the conventional MHI, Figure 1 displays the resulting 
energy images for a set of various actions. Figure 1(a) shows the 
first frame of each action video sequence in the Weizmann 
dataset [11], that contains nine actions, of Bend, Jack, Jump, 
Jump-in-place, Run, Side-walk, Walk, One-hand-wave, and 
Two-hand wave, against a still background. Figure 1(b) shows 
the corresponding Motion History Image (MHI) of each action, 
in which the observed duration is set at 50 frames. Figure 1(c) 
displays the corresponding Exponential Motion History Image 
(EMHI) of each action, in which the update rate γ  is given by 
0.99. 
In Figure 1(a1), the foreground object bends only once, with 
slow motion. The conventional MHI yields a high intensity 
representation in Figure 1(b1), but the EMHI generates a lower 
intensity representation to describe the low motion strength. 
Figures 1(a2)~(a5) have simple repetitive movements in place. 
Figures 1(b2)~(b5) and Figures 1(c2)~(c5) present, respectively, 
the MHI representation and the EMHI representation. Both 
MHI and EMHI create similar energy images for body motions 
in place. Figures 1(a6)~(a9) involve repetitive actions with 
horizontal movements in the scene. The conventional MHI 
representations (Figure 1(b6)~(b9)) are too similar to 
distinguish the different actions of Jump, Run, Walk and 
Side-walk. EMHI, however, can generate distinguishable 
representations for the different repetitive actions. As seen in 
Figures 1(a7) and (a8) for the Run and Walk actions, the EMHI 
representations show two actions with different leg-motion 
patterns. Therefore, EMHI gives a discriminative 
spatiotemporal representation for describing various action 
patterns, especially for those that involve prolonged, repetitive 
motions. 
Figures 2(a1)~(a5) show the one-hand wave action on a 
disturbed background. The objects causing disturbance include 
many pedestrians, cars, and motorcycles passing through the 
background. Figures 2(b1)~(b5) present the conventional MHI 
image with great interference from the background objects. 
Figures 2(c1)~(c5) illustrate the proposed EMHI image with 
low energy noise from the moving background objects, wherein 
the waving motion is still distinctly intensified in the energy 
image. From the demonstrative samples in Figures 1 and 2, it is 
clear that the proposed EMHI can represent different activities 
that involve simple or complex motions on a disturbed 
background. 
2.2 ICA-based feature extraction 
The proposed EMHI gives the global spatiotemporal 
representation of an activity. To construct a classification 
system for action recognition, the classical approaches need 
first to design and extract discriminant features from the 
spatiotemporal representation and then to perform feature 
selection to find the best feature combination based on specific 
selection criterion, and finally to apply a classifier to identify 
individual actions. When a scene involves both foreground and 
background moving objects, the feature values extracted from 
the spatiotemporal representation can distinctly deviate from 
the training samples that contain no moving background objects. 
In this study, we would like to develop a robust action 
recognition that can be tolerant to moving background objects. 
In order to prevent the tiresome process of feature design and 
verification of individual actions, we perform an ICA-based 
method that finds a set of basis images from predetermined 
multiple reference actions represented by the proposed EMHIs. 
The basis images resulting from the independent component 
analysis are statistically independent of each other. Any given 
input action for recognition is also first represented by the 
EMHI. The corresponding EMHI is then reconstructed by the 
linear combination of the ICA basis images. The coefficients of 
the combination are used as the discriminant feature vector. The 
Euclidean distance between each training reference action and 
the input testing action is then calculated. The unknown action 
is subsequently assigned to the reference action that gives the 
minimum distance. 
 
In the basic ICA model [22, 23], the observed mixture signals 
X  can be expressed as  
ASX =  
where A is an unknown mixing matrix, and S represents the 
latent source signals, meaning that they cannot be directly 
   
(a1) t=125 (b1) (c1) 
   
(a2) t=184 (b2) (c2) 
   
(a3) t=207 (b3) (c3) 
   
(a4) t=322 (b4) (c4) 
   
(a5) t=374 (b5) (c5) 
Action video sequence MHI EMHI 
 
Figure 2. Repetitive one-hand waving on a disturbed background and 
corresponding representation: (a1)-(a5) single person activity; 
(b1)-(b5) MHI representation; (c1)-(c5) EMHI representation. (The 
symbol t represents the frame number in the video sequence with 
fps=15.) 
 
 5
simple distance threshold can be applied to exclude the 
unrecognizable action. 
 
3 EXPERIMENTAL RESULTS 
This section evaluates the effectiveness of the proposed 
action recognition scheme with the Public Weizmann action 
dataset [11]. The performance of the proposed method is also 
compared to those of other existing algorithms. The proposed 
method can be potentially applied to human-computer 
interaction, rehabilitation evaluation, and video retrieval. 
Therefore, the robustness on disturbed backgrounds, and the 
effects of changes in position and scale, are then evaluated with 
a game interaction scenario. The BEHAVE benchmark dataset 
[26] is also used, to evaluate the retrieval rate of a specific 
action for video retrieval applications. 
The proposed algorithms were implemented using the C++ 
language on a Core2 Duo, 2.53GHz personal computer. The test 
images in the experiments were 150200×  pixels wide with 
8-bit gray levels. The total computation time from foreground 
segmentation and spatiotemporal representation to ICA feature 
extraction and distance measure for an input image was only 
0.015 seconds. It achieved a mean of 67 fps (frames per second) 
for real-time action recognition. 
 
3.1 Weizmann dataset for action recognition 
In the Weizmann dataset, we compare the experimental results 
of the proposed method and several existing methods with the 
Weizmann dataset. 
The Weizmann dataset [11] contains 90 low-resolution 
(180×144) video sequences that show 9 different people, each 
performing 10 natural actions of Run, Walk, Skip, Jumping-jack, 
Jump forward on two legs, Jump in place on two legs, Gallop 
sideways, Wave two hands, wave one hand, and Bend. All the 
backgrounds are stationary. We use 9 training samples for each 
individual reference action, wherein each EMHI training 
sample is obtained from the last frame of each sequence. In the 
training stage, a total of 90 (10 actions × 9 people) video 
representation sequences are collected as the training data 
matrix.  
The proposed method gave the same detection results as those 
of the state-of-the-art methods (e.g., volume-based method [27], 
spatiotemporal methods [11, 28], model-based method [29] and 
optical flow-based method [30]), as seen in Table 4. The 
existing methods [11, 27-30] generally use shapes or silhouettes 
for the representation, highly rely on accurate segmentation of 
foreground shapes, and require high computation complexity. 
They may fail to recognize the actions of interest on a disturbed 
background. 
Running action 
 
  
(a1) center position (b1) EMHI (c1) Center(x=97) 
 
  
(a2) right-shift -9 
cm 
(b2) EMHI (c2) -11 pixels 
 
  
(a3) left-shift 
+30cm (b3) EMHI (c3) +37 pixels 
    
    
Right-hand 
waving 
 
  
(a4) center position (b4) EMHI (c4) Center(x=97) 
 
  
(a5) right-shift 
-10cm (b5) EMHI (c5) -13 pixels 
 
  
(a6) left-shift 
+23cm (b6) EMHI (c6) +28 pixels 
    
    
Left-hand 
waving 
 
  
(a7) center position (b7) EMHI (c7) Center (x=83) 
 
  
(a8) right-shift 
-22cm (b8) EMHI (c8) -27 pixels 
 
  
(a9) left-shift 
+30cm (b9) EMHI (c9) +36 pixels 
 
Figure 3. Effect of shift in positions in three actions: (a1)-(a3) people running 
in different positions; (a4)-(a6) right-hand waving in different positions; 
(a7)-(a9) left-hand waving in different positions; (b1)- (b9) corresponding 
EMHIs; (c1)-(c9) ground truth of the foreground person and the shift distance 
by pixels. (Image width, 200 pixels) 
 
Table 5. Distance measurement for each action with position shifts 
Test samples Shift pixel 
(and %) 
Reference action 
Running Right-hand 
waving 
Left-hand 
waving Action Figure 3 
Running 
(a1) +0 (0.0%) 28 61 68 
(a2) -11 (5.5%) 32 48 69 
(a3) +37 (18.5%) 36 64 55 
Right-han
d waving 
(a4) +0 (0.0%) 69 25 64 
(a5) -13 (6.5%) 64 28 66 
(a6) +28 (14.0%) 42 34 61 
Left-hand 
waving 
(a7) +0 (0.0%) 56 66 33 
(a8) -27 (13.5%) 54 68 28 
(a9) +36 (18.0%) 60 59 37 
 
Table 4. Performance comparison of different methods on the Weizmann 
dataset. 
 
Methods Accuracy 
Grundmann et al. 2008 [27] 94.6 % 
Hsiao et al. 2008 [28] 96.7 % 
Wang and Suter 2007 [29] 97.8 % 
Fathi and Mori 2008 [30] 100 % 
Gorelick et al. 2007 [11] 100 % 
Our proposed method 100 % 
 
 7
disturbances in the background. The ICA-based scheme 
requires only collecting a few EMHIs of each action and does 
not need to design discriminant features. It can be efficiently 
applied for real-time action recognition and achieves a very fast 
fps of 67 with an image of size 150200× . The proposed action 
recognition method can be applied to security surveillance, 
human-computer interaction, shopping window advertisement, 
and video retrieval. The proposed method has shown its 
robustness for various actions under scale and position changes 
on disturbed backgrounds. The experimental results have also 
demonstrated that the proposed method can retrieve specific 
events from a complex video sequence.  
The proposed ICA-based feature extraction and classification 
method has been well applied to the global spatiotemporal 
representation of EMHI for recognizing activities that can be 
observed from a global, macro viewpoint. It is worth further 
investigation to extend the ICA-based scheme for recognizing 
subtle activities with micro-observation representation that can 
be observed only from a local viewpoint of detailed body 
movements of individual foreground objects. 
 
REFERENCES 
[1] R. Poppe, “A survey on vision-based human action recognition,” Image 
and Vision Computing, vol. 28, pp. 976-990, 2010. 
[2] L. Wang, W. Hu, and T. Tan, “Recent developments in human motion 
analysis,” Pattern Recognition, vol. 36, no. 3, 585-601, 2003. 
[3] J. K. Aggarwal and Q. Cai, “Human motion analysis: A Review,” 
Computer Vision and Image Understanding, vol. 73, no.3, pp. 428-440, 
1999. 
[4] C.-C. Chen, J.-W. Hsieh, Y.-T. Hsu, C.-Y. Huang, “Segmentation of 
human body parts using deformable triangulation,” in: Proc. International 
Conference on Pattern Recognition, vol. 1, pp. 355-358, 2006. 
[5] Surer, E., Cereatti, A., Grosso, E., Croce, U.D. A markerless estimation of 
the ankle-foot complex 2D kinematics during stance, Gait and Posture, 33 
(4), pp. 532-537, 2011. 
[6] Sundaresan, A., Chellappa, R. “Model driven segmentation of 
articulating humans in Laplacian Eigenspace,” IEEE Transactions on 
Pattern Analysis and Machine Intelligence, vol. 30, no. 10, pp. 1771-1785, 
2008. 
[7] Sundaresan, A., Chellappa, R. Multicamera tracking of articulated human 
motion using shape and motion cues, IEEE Transactions on Image 
Processing, 18 (9), pp. 2114-2126, 2009. 
[8] Holte, M.B., Moeslund, T.B., Fihl, P. “View-invariant gesture 
recognition using 3D optical flow and harmonic motion context,” 
Computer Vision and Image Understanding, vol. 114, no. 12, pp. 
1353-1361, 2010. 
[9] T. Ogata, W. Christmas, J. Kittler, S. Ishikawa, “Improving human 
activity detection by combining multi-dimensional motion descriptors 
with boosting,” in: Proc. International Conference on Pattern Recognition, 
1, pp. 295-298, 2006. 
[10] X. Song, L. D. Seneviratne, K. Althoefer, “A Kalman filter-integrated 
optical flow method for velocity sensing of mobile robots,” IEEE Trans. 
Mechatronics, vol. 16, no. 3, pp. 551-563, 2011. 
[11] L. Gorelick, M. Blank, E. Shechtman, M. Irani, R. Basri, “Actions as 
Space-Time Shapes,” IEEE Trans. Pattern Analysis and Machine 
Intelligence, vol. 29, no. 12, pp. 2247-2253, 2007. 
[12] Y. Ke, R. Sukthankar, and M. Hebert, “Efficient Visual Event Detection 
Using Volumetric Features” in: Proc. International Conference on 
Computer Vision, vol. 1, pp. 166-173, 2005. 
[13] E. Shechtman and M. Irani, “Space-Time Behavior Based Correlation,” 
in: Proc. IEEE Conference on Computer Vision and Pattern Recognition, 
vol. 1, pp. 405-412, 2005. 
[14] Goodhart, T., Yan, P., Shah, M. “Action recognition using 
spatio-temporal regularity based features,” ICASSP, IEEE International 
Conference on Acoustics, Speech and Signal Processing - Proceedings, 
art. no. 4517717, pp. 745-748, 2008. 
[15] A. F. Bobick, J. W. Davis, “The recognition of human movement using 
temporal templates,” IEEE Trans. Pattern Analysis and Machine 
Intelligence, vol. 23, pp. 257-267, 2001. 
[16] G. R. Bradski, J. W. Davis, “Motion segmentation and pose recognition 
with motion history gradients,” Machine Vision and Applications, vol. 13, 
pp. 174-184, 2002. 
[17] S.-F. Wong, R. Cipolla, “Continuous gesture recognition using a sparse 
Bayesian classifier,” in: Proc. International Conference on Pattern 
Recognition, vol. 1, pp. 1084-1087, 2006. 
[18] D. Weinland, R. Ronfard, and E. Boyer, “Free View-Point Action 
Recognition Using Motion History Volumes,” Computer Vision and 
Image Understanding, vol. 104, no. 2, pp. 249-257, 2006. 
[19] W. Y. Chiu and D. M. Tsai, “A macro-observation scheme for abnormal 
event detection in daily-life video sequences,” EURASIP Journal on 
Advances in Signal Processing, Article ID 525026, 2010. 
[20] C. Stauffer, W. E. L. Grimson, “Adaptive background mixture models for 
real-time tracking,” In: Proc. IEEE Conference on Computer Vision and 
Pattern Recognition, vol. 2, pp. 246-252, 1999. 
[21] C. Stauffer, W. E. L. Grimson, “Learning patterns of activity using 
real-time tracking,” IEEE Trans. Pattern Analysis and Machine 
Intelligence, vol. 22, no. 8, pp.747-757, 2000. 
[22] A. Hyvarinen, J. Karhunen, E. Oja, “Independent Component Analysis,” 
John Wiley and Sons, New York, NY, 2001. 
[23] A. Hyvarinen, and E. Oja, “Independent component analysis: algorithms 
and applications,” Neural Networks, vol. 13, pp. 411-430, 2000. 
[24] A. Hyvarinen, and E. Oja, “A fast fixed-point algorithm for independent 
component analysis,” Neural Computation, vol. 9, pp. 1483-1492, 1997. 
[25] J. Hurri, H. Gavert, J. Sarela, and A. Hyvarinen, 2004, “FastICA 
Package,” Online Available: http://www.cis.hut.fi/projects/ica/fastica/. 
[26] BEHAVE Interactions Test Case Scenarios, Univ. of Edinburgh 2007, 
available online: http://groups.inf.ed.ac.uk/vision/behavedata/interactions 
[27] M. Grundmann, F. Meier, and I. Essa, “3D shape context and distance 
transform for action recognition,” in: Proc. IEEE Conference on 
Computer Vision and Pattern Recognition, pp. 1-4, 2008. 
[28] P. C. Hsiao, C. S. Chen, and L. W. Chang, “Human action recognition 
using temporal-state shape contexts,” in: Proc. IEEE Conference on 
Computer Vision and Pattern Recognition, pp. 1-4, 2008. 
[29] L. Wang and D. Suter, “Recognition human activities from silhouettes: 
Motion subspace and factorial discriminative graphical model,” in: Proc. 
IEEE Conference on Computer Vision and Pattern Recognition, pp. 1-8, 
2007. 
[30] A. Fathi and G. Mori., “Action Recognition by Learning Mid-level 
Motion Features,” in: Proc. IEEE Conference on Computer Vision and 
Pattern Recognition, pp. 1-8, 2008. 
 
     
(a1) two 
persons 
(a2) two 
persons 
(a3) three 
persons 
(a4) three 
persons 
(a5) four 
persons 
     
(b1) EMHI (b2) EMHI (b3) EMHI (b4) EMHI (b5) EMHI 
 
Figure 5. The experiment with a running action under varying background 
interference: (a1) one person with slow movement in the background; (a2) one 
person waving a hand in the background; (a3) two persons chatting in the 
background; (a4) two persons waving hands in the background; (a5) three 
persons chasing each other in the background. 
 
Table 7. Distance measurement for each action under disturbed backgrounds. 
 
Test action Figure 5 
Disturbed 
background 
Reference action 
Running Right-hand 
waving 
Left-hand 
waving 
Running 
(on disturbed 
backgrounds) 
(a1) One person 28 42 38 
(a2) One person 33 41 45 
(a3) Two persons 37 55 51 
(a4) Two persons 39 49 62 
(a5) Three persons 41 50 54 
 
inspection tasks such as wood inspection [5], carpet wear assess-
ment [6] and roughness measurement of machined surfaces [7].
In spectral-domain approaches, texture features are popularly de-
rived from the Fourier transform [8,9] for fabric defect detection
[10,11] and patterned wafer inspection [12] in semiconductor
manufacturing. Gabor transform [13–15] is also commonly used
to design a bank of convolution ﬁlters that represent the character-
istics of the textured patterns, and has been applied to the inspec-
tion of wooden surface [16], granite [17], steel surfaces [18] and
textile fabrics [19]. Wavelet transform [20,21] is a popular alterna-
tive in recent years for texture feature extraction. It has been ap-
plied to industrial inspection of LSI wafers [22], woven fabrics
[23] and homogeneously textured surfaces [24].
Instead of using the texture features for defect detection, image
reconstruction schemeshave been applied to eliminate the repetitive
background pattern and preserve defects of arbitrary types in the
reconstructed image byusing Fourier transforms [25,26] andwavelet
transforms [27,28]. Khalaj et al. [29] presented a self-reference tech-
nique to detect defects embedded in structurally textured surfaces
that comprise only horizontal and vertical structural patterns. The
repetitive periods are ﬁrst evaluated by a spectral estimation tech-
nique. A synthetic reference template was then generated from the
acquired image itself based on the pixel values in subsequent periods,
and was used for comparison with the inspection image. The image-
reconstruction and self-referencemethods do not require the tedious
process of texture feature design and extraction, but can only be
applied to the surface images with repetitive patterns.
The local feature extraction and global image reconstruction
methods described previously perform well for defect detection
in homogeneously textured surfaces. However, they fail to detect
local defects in heterogeneously textured surfaces that do not pres-
ent repetitive patterns. As seen in Fig. 1, the local texture patterns
in a small neighborhood window are distinctly different from each
other in the polycrystalline wafer surface. The resulting local fea-
ture values could vary in a wide range and make the quantitative
measures indistinguishable between defect-free and defective re-
gions. The global representation of the heterogeneous textures
cannot be abstractly described for background removal.
Only a few relevant papers in the literature discuss defect
detection in the surfaces of solar cells or solar modules. Fu et al.
[30] presented an image processing scheme for solar cell crack
inspection. The solar cell images they investigated contained only
simple structural patterns. They also assumed the cracks on the
edge of the cell and those on the surface of the cell had distinct
gray values with respect to the whole image. Simple image
enhancement processes were ﬁrst carried out to extract the con-
tours of potential defects. Then cracks were veriﬁed based on geo-
metrical criteria of the contour. Ordaz and Luch [31] discussed the
solar cell characterization of conversion efﬁciency based on the
intensity distribution of electroluminescence (EL) images. Pilla et
al. [32] proposed an infrared thermography method for crack
inspection in solar cells. The system had the thermal front propa-
gating along the surface. It took advantage of the large thermal
resistance at the interface created by the crack. Then surface cool-
ing was generated by blowing air temperature over the surface. An
infrared camera was used to capture the surface image. Simple
edge detection was ﬁnally carried out in the IR image to identify
the crack. The crack inspection methods discussed previously
mainly focus on the solar cells that contain non-texture or struc-
tural texture patterns. They cannot be applied to micro-crack
detection in polycrystalline solar wafers.
Since micro-cracks affect the structural integrity of solar wafers,
they should be detected in an early stage of the manufacturing pro-
cess so that the overall production yield can be greatly improved.
In this paper, an anisotropic diffusion scheme is proposed to detect
the subtle defects of micro-crack embedded in heterogeneous
textures of solar wafers. Anisotropic diffusion model was ﬁrst
introduced by Perona and Malik [33] in image processing for
scale-space description and edge detection. It has been used as
an adaptive edge-preserving smoothing process for image segmen-
tation [34,35] and texture segmentation [36].
The continuous anisotropic diffusion model is given by
@Itðx; yÞ
@t
¼ div½ctðx; yÞ  rItðx; yÞ ð1Þ
where It(x,y) refers to the image at time t, div the divergence oper-
ator, rIt(x,y) the gradient of the image, and ct(x,y) the diffusion
coefﬁcient at pixel coordinates (x,y). If ct(x,y) is a constant, Eq. (1)
is reduced to the isotropic diffusion model. It is then equivalent to
convolving the image with a Gaussian function, and only the
smoothing process is performed. In the anisotropic diffusion model,
the diffusion coefﬁcient ct(x,y) is adaptively determined based on
the local gradient magnitude of individual pixel at coordinates
(x,y) so that the intra-regions are effectively smoothed while edges
of the inter-regions are well preserved in the image. In our previous
study [37,38], we have proposed two modiﬁed versions of the Pero-
na–Malik anisotropic diffusion model to detect low-contrast defects
in non-textured surface images. The improved models can effec-
tively smooth the rough background and enhance the defective re-
gion in the diffused image. A simple statistical control limit based
on the gray-level mean and standard deviation of the diffused im-
age is then used as the threshold to locate the defective region.
The approach that smoothes the background as a uniform region
and enhances the intensity contrast of a defective region has
worked successfully for low-contrast, non-textured surface images.
Owing to the multi-grain patterns in the polycrystalline wafer sur-
face, the faultless background with multiple intensities in random
grain regions cannot be smoothed by using such an approach.
Fig. 1. Two sample images of polycrystalline solar wafers: (a) defect-free multi-grain wafer surface and (b) defective wafer containing a micro-crack on the upper right of the
image.
492 D.-M. Tsai et al. / Image and Vision Computing 28 (2010) 491–501
diffusion coefﬁcient function, depending upon the applications.
Since each feature may be of different scale, the ratio of R
i
ui=R
j
vj
may need an individual normalization parameter for each feature
so that the resulting ratio will not be solely determined by a dom-
inant feature with distinctly large magnitude. The product of fea-
ture values needs only one regularization K and is easier to
implement. The generalized procedure of diffusion-based defect
detection is as follows:
1. Identify the features u and v that can best represent the dis-
crimination characteristics between defective and defect-free
pixels.
2. Formulate the diffusion coefﬁcient function according to Eq. (5).
3. Diffuse the inspection image with a given number of iterations
T.
4. Subtract the original image from the diffused image to obtain a
difference image.
5. Segment the difference image using a simple statistical control
limit to obtain a binary image.
6. Postprocess the binary image to remove noise and ﬁll small
gaps.
2.3. Micro-crack properties in images
As mentioned previously, a micro-crack presents low gray-lev-
els and high gradient magnitude in the sensed image under front-
light illumination. Fig. 2(a) displays a partial solar wafer image that
contains a diagonal micro-crack on the upper right of the image,
which is the same as Fig. 1(b). There are two demonstrative hori-
zontal scan lines A and B across the image of size 640  480 pixels.
Scan line A (line 225) passes through both grain edges and the mi-
cro-crack, and scan line B (line 405) crosses only the faultless gain
region.
Fig. 2(b1) is the corresponding gradient image of Fig. 2(a1). It
can be observed from the gradient image that both the micro-crack
and the grain edges on the lower left of the image have high gradi-
ent magnitudes. The sole gradient information is not sufﬁcient to
distinguish the micro-cracks and grain edges. Fig. 2(a2) and (a3)
show, respectively, the gray-level proﬁles of scan line A (across
the micro-crack) and scan line B (across a faultless region).
Fig. 2(b2) and (b3) further depict the gradient proﬁles of scan lines
A and B, respectively. It can be observed from the gray-level and
gradient proﬁles that the micro-crack has both very low gray-lev-
els and high gradients, while the faultless grain edges show only
either low gray-levels or high gradients. Note that the gray-levels
in a faultless region could also be very low, as seen in the beginning
portion of the gray-level proﬁle in Fig. 2(a3).
2.4. Proposed diffusion model for micro-crack detection
The discussion above has indicated that a micro-crack presents
both low gray-levels and high gradient magnitude in the image.
The goal of the proposed anisotropic diffusion model is to smooth
the micro-crack (i.e. change the gray values in the original image)
and preserve the gray values of all pixels in the faultless grain re-
gions so that the subtraction between the diffused image and the
original image will signiﬁcantly intensify the micro-crack in the
difference image. Therefore, the proposed diffusion model should
carry out a strong smoothing process by assigning a large diffusion
coefﬁcient to the pixels with both low gray-levels and high gradi-
ents. Conversely, it has to inhibit the diffusion process by assigning
a low diffusion coefﬁcient to the pixels that do not present both
low gray-levels and high gradients. It then replaces the original
gray value of a micro-crack pixel with its smoothed gray value in
the surroundings and preserves the original gray values of faultless
regions.
Fig. 2. Gray-level and gradient properties in a polycrystalline wafer image: (a1) wafer surface containing a micro-crack, where scan line A crosses over the micro-crack and
scan line B passes through defect-free regions; (a2), (a3) gray-level proﬁles of scan lines A and B, respectively; (b1) gradient image of (a1) and (b2), (b3) gradient proﬁles of
scan lines A and B, respectively.
494 D.-M. Tsai et al. / Image and Vision Computing 28 (2010) 491–501
Fig. 4. Diffusion results of the two scan lines in Fig. 2:(a1), (b1) original gray-level proﬁles of scale lines A and B in Fig. 2(a1); (a2), (b2) respective diffusion coefﬁcients g(rI, f);
(a3), (b3) respective gray-level proﬁles in the diffused image; (a4) absolute difference of gray-level proﬁles between (a1) and (a3) and (b4) absolute difference between (b1)
and (b3).
496 D.-M. Tsai et al. / Image and Vision Computing 28 (2010) 491–501
Throughout the subsequent experiments, the regularization
value K is set at 4. The second experiment evaluates the effect of
changes in the number of diffusion iterations T with a given regu-
larization value of K = 4. The same test images used in Fig. 6 are
also used for the experiment. Fig. 7(a1)–(a3) show the original so-
lar wafer images for the test. Fig. 7(b1)–(b3) display the detection
results from a minimum number of diffusion iterations T = 1 (i.e.
the shortest processing time). Fig. 7(c1)–(c3) and (d1)–(d3) further
display the detection results from T = 3 and T = 9. The detection re-
sults indicate that an insufﬁcient number of diffusion iterations
cannot effectively identify the subtle micro-crack, as seen in
Fig. 7(b3). It causes the diffusion process to stop too early in the
micro-crack region. A larger number of diffusion iterations (T = 9)
can also well detect the micro-crack defects with more noisy
points. It does not improve the detection effectiveness due to
over-smoothness of the faultless grain edges, and requires more
computation time. Based on the experimental results described
above, the proposed anisotropic diffusion model with regulariza-
tion value K = 4 and number of diffusion iterations T = 3 gives the
best detection results.
3.2. Effect of control constant C
In this subsection, we evaluate the effect of changes in the value
of control constant C. The control constant C deﬁned in Eq. (7) is
used to set up the threshold to segment micro-cracks in the differ-
ence image. Too small the control constant gives a tight control and
may result in false rejection and, thus, generates noisy points. Too
large the control constant, however, gives a loose control and may
result in false acceptance and then causes discontinuous cracks.
According to Chebyshev’s inequality, the probability that any
random variable falls with C standard deviation of the mean is at
least 1  (1/C2). The possible defect size of a micro-crack with re-
spect to the whole image can be used as a guideline to ﬁnd the va-
lue of C. Fig. 8(a1) and (a2) demonstrate a defect-free and a
defective solar wafer images. Fig. 8(b1)–(d1) and (b2)–(d2) shows,
respectively, the detection results for the images in Fig. 8(a1) and
(a2) with control constant C = 3, 4 and 5. For the defect-free solar
wafer, the resulting images are uniformly white and no defects
are declared, regardless of the C values. For the defective image,
a relatively small constant value C = 3 results in some random
noisy points in the binarized image. A relatively large constant va-
lue C = 5 generates disconnected micro-crack in the segmented im-
age, but the defect can still be well detected. A ﬁnal postprocessing
can easily remove noise and ﬁll the small gaps of the detected mi-
cro-crack. The experiment reveals that the proposed defect detec-
tion method is not sensitive to the value of C.
3.3. Detection results
This subsection demonstrates the detection results of various
polycrystalline wafer images. The parameter values are set with
K = 4, T = 3 and C = 4 for all test samples. Fig. 9(a1) and (b1) are
two defect-free solar wafer images. They display very complicated
multi-grain patterns on the surface in Fig. 9(a1), and the elongated
grains similar to a micro-crack defect in Fig. 9(b1). The correspond-
ing detection results in Fig. 9(a2) and (b2) show that the resulting
binary images are uniformly white and no defects are detected.
Fig. 9(c1) and (d1) further demonstrate two defective solar wafer
images. The micro-crack in Fig. 9(d1) is relatively light and hardly
Fig. 6. Effect of changes in regularization valueK: (a1)–(a3) a defect-free and two defective wafer images, respectively; (b1)–(b3) respective detection results from K = 1; (c1)–
(c3) respective detection results from K = 4; (d1)–(d3) respective detection results fromK = 30. (The number of diffusion iterations T = 3 and control constant C = 4 for all test
images.)
498 D.-M. Tsai et al. / Image and Vision Computing 28 (2010) 491–501
method can identify the micro-cracks in all 50 defective images,
and declare no defects for all the 45 defect-free images.
4. Conclusions
In this paper, we have proposed an anisotropic diffusion scheme
for detecting micro-cracks in polycrystalline solar wafer surfaces
that involve heterogeneous texture patterns. The micro-crack to
be inspected must be visible on the wafer surface. It presents both
dark intensity and high contrast in the sensed image under front
light illumination. The diffusion process carries out a strong
smoothing for the suspected defect pixels that show both low
gray-levels and high gradient magnitude by assigning a large diffu-
sion coefﬁcient. It stops the diffusion process for the intra-grain
Fig. 9. Detection results of four demonstration wafer images: (a1), (b1) two defect-free wafer images; (c1), (d1) two defective wafer images, each containing a micro-crack;
(a2)–(d2) respective detection results.
500 D.-M. Tsai et al. / Image and Vision Computing 28 (2010) 491–501
Automatic saw-mark detection in multicrystalline solar wafer images
Wei-Chen Li, Du-Ming Tsai n
Department of Industrial Engineering and Management, Yuan-Ze University, 135 Yuan-Tung Road, Nei-Li, Tao-Yuan, Taiwan 32003, R.O.C.
a r t i c l e i n f o
Article history:
Received 23 June 2010
Received in revised form
11 March 2011
Accepted 16 March 2011
Available online 2 April 2011
Keywords:
Surface inspection
Defect detection
Multicrystalline silicon
Solar wafer
Saw-mark
Fourier transform
a b s t r a c t
This paper presents a method of automatic defect inspection for the photovoltaic industry, with a
special focus on multicrystalline solar wafers. It presents a machine vision-based scheme to
automatically detect saw-mark defects in solar wafer surfaces. A saw-mark defect is a severe ﬂaw
that occurs when a silicon ingot is cut into wafers. Early detection of saw-mark defects in the wafer
cutting process can reduce material waste and improve production yields. A multicrystalline solar
wafer surface presents random shapes, sizes, and orientations of crystal grains in the surface, making
the automatic detection of saw-mark defects extremely difﬁcult. The proposed saw-mark detection
scheme involves two main procedures: (1) Fourier image reconstruction to remove the multi-grain
background of a solar wafer image and (2) a line detection process in the reconstructed image to locate
saw-marks. The Fourier transform (FT) is used to eliminate crystal grain patterns and results in a
non-textured surface in the reconstructed image. Since a saw-mark is presented horizontally in the
sliced wafer, vertical scan lines in the reconstructed image are individually evaluated by a line
detection process. A pixel far away from the line sought can then be effectively identiﬁed as a defect
point. Experimental results show that the proposed method can effectively detect various saw-mark
defects, speciﬁcally black lines, white lines, and impurities in multicrystalline solar wafers.
& 2011 Elsevier B.V. All rights reserved.
1. Introduction
Solar power is an attractive alternative source of electricity
today. Silicon solar cells convert photons from the sun to
electricity. Among the currently available solar cell technologies,
multicrystalline solar cells dominate the market share and are
more popular than monocrystalline solar cells owing to their
lower manufacturing costs. A main category of defects found in
silicon solar wafers is ‘‘saw-marks’’. They occur when a silicon
ingot is sliced into wafers. This paper presents a machine vision-
based scheme to automatically detect saw-mark defects in multi-
crystalline solar wafers.
Most solar cell production requires the cutting of silicon ingots
into wafers. Multi-wire sawing is the dominant slicing technique
in the photovoltaic (PV) industry. A multi-wire sawing machine
consists of a single bronze coated stainless steel wire up to several
hundreds of kilometers long [1,2]. The wire is looped continu-
ously and is wound on constant pitch grooves to create a web that
generally consists of 500–700 parallel wires so that the ingot can
be sliced into multiple wafers at the same time.
Saw damage on the wafer surface is a micro defect prod-
uced by the wire sawing process. It induces the generation of
non-uniform dislocation densities [3]. The high-density disloca-
tions are difﬁcult to passivate. They show high recombination rates
to the detriment of the lifetime of minority charge carriers [4] and
thus decrease the conversion efﬁciency of solar cells. Du et al. [5]
investigated how foreign inclusions cause defective wafer surfaces
and broken wires in the wafer sawing process. Generally, minor
saw damage can be removed by alkali etching [6]. Saw-marks,
however, are a form of serious saw damage and cannot be
effectively removed by the etching process. If the height/depth of
a saw-mark exceeds 10–15 mm in the slicing process, it becomes a
noticeable defect in the wafer surface [7]. Saw-marks should be
detected immediately after the slicing process so that the process
errors of the multi-wire sawing machine can be corrected and
damage to subsequent ingots can be prevented. Inspection for
saw-mark defects also prevents inferior wafers from reaching later
processing steps in solar cell manufacturing, such as etching,
texturing, and anti-reﬂection coating.
The multi-wire sawing technique provides high throughput, ﬁne
surface quality, and small material losses, thereby allowing the
sliced wafers to be subsequently processed without any further
machining [8]. The current technique produces solar wafers of
156156mm2 that are as thin as 220 mm. The goal of the
PV-industry is to produce a larger wafer size of 210210 mm2,
while reducing the thickness even further, to 100 mm [9]. When the
silicon wafer becomes thinner, the surface quality will be more
critical in silicon ingot manufacturing. The saw-mark defect is a
Contents lists available at ScienceDirect
journal homepage: www.elsevier.com/locate/solmat
Solar Energy Materials & Solar Cells
0927-0248/$ - see front matter & 2011 Elsevier B.V. All rights reserved.
doi:10.1016/j.solmat.2011.03.025
n Corresponding author. Fax: þ886 3 4638907.
E-mail address: iedmtsai@saturn.yzu.edu.tw (D.-M. Tsai).
Solar Energy Materials & Solar Cells 95 (2011) 2206–2220
version) of any textured pattern in an image is concentrated around
the low-frequency region, whereas the details of a saw-mark across
the wafer surface in the image will appear in the high-frequency
region. By eliminating the Fourier frequency components that
describe the global multi-grain background of the solar wafer
surface and then back-transforming the spectrum image using the
inverse Fourier transform, the 2D Fourier reconstruction process can
effectively smooth the global background pattern and well preserve
local saw-mark defects. The reconstructed image results in a
low-contrast surface, where the multi-grain background is signiﬁ-
cantly smoothed as a non-textured surface and the saw-mark is
retained without showing sharp and clear edges from its surround-
ings. Simple segmentation techniques such as binary thresholding
and gradient edge detection cannot be applied for detecting saw-
mark defects in the low-contrast reconstructed image.
Since the saw-mark appears horizontally in the sensed image,
each vertical scan line of the gray-level proﬁle in the reconstructed
image is individually evaluated. A one-dimensional line detection
procedure is then proposed to identify the saw-mark defect in the
Fourier reconstructed image, which has a low-contrast and uneven
background. The 1D gray-level proﬁle in the reconstructed image
appears as a non-stationary line. Finding a line segment in a noisy
non-stationary signal is a non-trivial problem. The Hough transform
(HT) [23] is the most commonly used technique for straight-line
detection in a noisy image. It has been popularly applied to straight
line detection since Duda and Hart [24] proposed the parameter
space transform method. The traditional HT for line detection in an
image is based on a voting procedure that accumulates the number
of points that lie on the same line of speciﬁc parameter values.
The 1D gray-level signal in the Fourier reconstructed image shows
the trend of a straight line with non-stationary variation, and the
defect part does not show clear edges separating it from its
surroundings in the gray-level proﬁle. The standard HT requires a
sufﬁcient number of points lying exactly on the same straight line so
that the accumulator will show a distinct peak in the parameter space
to indicate the presence of a straight line. It fails to detect a line that
has numerous points distributed around the vicinity of the line in a
non-stationary signal. In the Hough transform-based scheme, a
revised version of the HT is proposed for line detection in
non-stationary gray-level proﬁles in the Fourier reconstructed image.
A pixel far away from the line sought can then be effectively
identiﬁed as a defect point. By vertically scanning line-by-line
throughout the whole reconstructed image, a saw-mark defect in
the 2D image can be detected and located.
The paper is organized as follows. In Section 2, the Fourier
image reconstruction and the Hough-like line detection technique
are proposed to detect saw-mark defects in multicrystalline solar
wafer images. In Section 3, the effects of changes in parameter
values and experimental results are presented individually.
Section 4 concludes this paper.
2. Saw-mark detection scheme
This section presents the machine vision scheme for saw-mark
detection in solar wafer images, which includes the Fourier image
reconstruction for multi-grain background removal and the Hough
transform process for line detection in non-stationary gray-level
proﬁles. The Fourier image reconstruction is ﬁrst introduced in
Section 2.1. The Hough transform process and defect segmentation
in 1D gray-level proﬁles are then described in Sections 2.2 and 2.3.
2.1. Fourier image reconstruction
In this paper, we use the Fourier transform (FT) to smooth the
multi-grain background of a solar wafer image. The FT characterizes
the textured image in terms of frequency components. Periodically
occurring features such as structural lines can be observed from the
magnitude of frequency components in the spectrum image. A line
with orientation y in the original gray-level image will show its
corresponding frequency components along the orientation yþ(p/2)
in the Fourier spectrum; i.e., a line in the spatial domain image and
its transformed counterpart in the Fourier domain image are
orthogonal to each other. Therefore, the transform of a horizontal
saw-mark in the spatial domain image appears as a vertical line in
the Fourier domain image. Periodical lines in the original image
present high-energy frequency components. The global representa-
tive pattern in the original image will have the corresponding
frequency components concentrated in the low-frequency region,
and an isolated, local anomaly will have its corresponding frequency
components in the high-frequency region.
Let f(x, y) be the gray level at (x, y) in the original solar wafer
image of size MN. The discrete 2D FT of f(x, y) is given by
Fðu,vÞ ¼ 1
MN
XM=2
x ¼ M=2
XN=2
y ¼ N=2
f ðx,yÞexp½j2pðux=Mþvy=NÞ ð1Þ
for frequency variables u¼M=2, M=2þ1,. . .,M=21, M=2,
v¼N=2,N=2þ1,. . .,N=21,N=2. The discrete 2D FT can be
expressed in the separable forms with two one-dimensional
(1D) FTs, and obtained efﬁciently using the fast FT algorithm
[25]. The FT is generally complex. That is
Fðu,vÞ ¼ Rðu,vÞþ jIðu,vÞ
where R(u, v) and I(u, v) are the real and imaginary components of
F(u, v), i.e.,
Rðu,vÞ ¼ 1
MUN
XM=2
x ¼ M=2
XN=2
y ¼ N=2
f ðx,yÞcos½2pðux=Mþvy=NÞ
Iðu,vÞ ¼ 1
MUN
XM=2
x ¼ M=2
XN=2
y ¼ N=2
f ðx,yÞsin½2pðux=Mþvy=NÞ
The power spectrum P(u, v) of image f(x, y) is deﬁned by
Pðu,vÞ ¼ Fðu,vÞ
 2 ¼ R2ðu,vÞþ I2ðu,vÞ ð2Þ
It is valuable to facilitate visual analysis of Fourier spectra. To
show the spectrum as an intensity function scaled to 8-bit gray-
levels, P(u, v) is converted by
Pðu,vÞ ¼ logð1þ Fðu,vÞ
 Þ ð3Þ
For a solar wafer surface, the edges of crystal grains present short
line segments with various directions. The corresponding frequency
components of these short line segments in the Fourier spectrum
give large power magnitudes and mainly distribute in the low-
frequency band. For a defective image, the saw-mark is horizontally
across the whole solar wafer surface; as a result, the corresponding
frequency components appear as a vertical line across the entire
spectrum image. By carefully selecting an appropriate radius that
deﬁnes the circular region of low-frequency band and setting the
frequency components within the circle to zero, the global solar
wafer pattern can be removed and the details of a saw-mark defect
can be preserved in the reconstructed image.
Fig. 2(a1) shows a defect-free solar wafer image, and Fig. 2(b1)
is a defective solar wafer image with a thin saw-mark on the
surface. Fig. 2(a2) presents the Fourier spectrum image of (a1). It
shows that the low frequency components are distributed around
the central DC point. These frequency components correspond to
the approximation of the multi-grain background of a solar wafer.
The frequency components distributed along lines in the spec-
trum image represent the main directions of the grain edges in
the solar wafer surface. The spectrum of the high frequency
W.-C. Li, D.-M. Tsai / Solar Energy Materials & Solar Cells 95 (2011) 2206–22202208
where r* and y* denote the most possible parameter values of the
straight line sought in the Cartesian space.
Fig. 5 gives examples to show that the standard HT may perform
poorly for non-stationary gray-level proﬁles in a low-contrast, uneven
gray-level image. Fig. 5(a) presents the detection result of the
standard HT for the defective gray-level proﬁle that contains part of
the saw-mark defect in Fig. 4(b1). Fig. 5(b) presents an ideal straight
line, which places the saw-mark segment far away from the
ﬁtting line.
In the proposed Hough transform, the points that contribute to
the line do not have to lie exactly on the line sought. Instead, the
distance from the point to the line is taken as the voting weight
and is added to the accumulator of given r and y parameter
values. A larger weight is assigned to the accumulator if the point
is very close to the line, whereas a small weight, one close to zero,
is given if the point is distantly apart from the line. At the end of
the voting process, the peak of the accumulator with the corre-
sponding r and y values indicates the best line sought.
Let the inspection image f(x, y) be of size MN. For a given
vertical scan line X, X¼0, 1, 2,y,M1, the one-dimensional
column gray-level proﬁle is denoted by fX(y)¼ f(X, y),
y¼0, 1, 2,y, N1. Since the saw-mark defect appears horizon-
tally in the solar wafer image, only the column gray-level proﬁles
need to be evaluated. The coordinates of a point on the gray-level
proﬁle X of length N are then given by (y, fX(y)), for
y¼0, 1, 2,y, N1. To simplify the notation, the gray-level fX(y)
at a column proﬁle X is represented by fy; i.e., the point on a gray-
level proﬁle is denoted by (y, fy), where y is the location and fy is
the gray-level at y. To calculate the distance between a point
(y, fy) and a straight line, we can rewrite r¼x cos yþy sin y from
the normal form to the slope–intercept form fy¼myþb. That is
fy ¼ðcosy=sinyÞyþðr=sinyÞ ð5Þ
where cosy=siny is the slope m, and r=siny is the intercept b.
Therefore, the distance from a point (y, fy) in the gray-level proﬁle
to the line with parameter values (r, y) is calculated by
Dðy,fy9r,yÞ ¼ ðmyþ fybÞ=
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
m2þ1
p  ð6Þ
The distance D (y, fy9r, y) of a point (y, fy) is used to derive the
voting weight in the accumulator, which is given by an inverse
cubic polynomial in this study, i.e.,
Wðy,fy9r,yÞ ¼ 1=½1þD3ðy,fy9r,yÞ ð7Þ
Note that the weight W(y, fy9r, y) is between 0 and 1. A point
lying exactly on the r–y line has a maximumweight of 1, whereas
the weight is quite close to 0, as the point is far away from the
line. The accumulator then adds the voting weight as
Aðr,yÞ’Aðr,yÞþWðy,fy9r,yÞ ð8Þ
At the end of the voting process, the ﬁnal line equation of the
gray-level proﬁle is given by the maximum value of A(r, y), i.e.,
ðr,yÞ ¼ argMax
ðr,yÞ
Aðr,yÞ
xcosyþysiny ¼ r is the line equation that best ﬁts the non-
stationary gray-level proﬁle fX(y). The Hough line search process
repeats for all vertical gray-level proﬁles fX(y), X¼0, 1, 2,y,M1.
2.3. Constraints on line parameters r and y
The Hough transform is computationally very expensive if we
have to explore all possible values of parameters r and y. This
subsection proposes a fast process to identify the most likely
ranges of r and y. Such tight restrictions on r and y allow for fast
line detection in a non-stationary proﬁle using the weighted
voting process. The gray-level proﬁles in the same scan direction
in the Fourier reconstructed image have approximately the same
line slope. We can therefore plot all gray-level proﬁles in the
vertical scan direction on a map that has the gray-level fy (from
0 to 255 for an 8-bit display) in the horizontal axis and the proﬁle
point number y (from 0 to N1) in the vertical axis. Each column
line image will be overlapped in the y–fy plane to form a proﬁle
map. Fig. 6 illustrates an image of size MN. It therefore involves
Fig. 5. (a) Straight line detected by the conventional HT for the scan line 2 in Fig. 4(b2); (b) expected straight line for the scan line 2.
0
50
100
150
200
250
100 150 200 250
Scan line 1 
Scan line 2 
0
50
100
150
200
250
100 150 200 250
Fig. 4. Fourier reconstructed images of solar wafers: (a1) reconstructed image of
the defect-free wafer in Figs. 1(a); (b1) reconstructed image of the defective wafer
in Figs. 1(b); (a2) and (b2) corresponding gray-level proﬁles of scan lines in (a1)
and (b1).
W.-C. Li, D.-M. Tsai / Solar Energy Materials & Solar Cells 95 (2011) 2206–22202210
from the average contour O^MðyÞ in the proﬁle map, we can further
tightly restrict the range of r values.
The width between the upper contour O^UðyÞ and the lower
contour O^LðyÞ at a location y should be consistently the same for
the defect-free segments in the proﬁle map. We can therefore ﬁnd
the representative width Dd from the mode of O^UðyÞO^LðyÞ
  for
y¼0, 1, 2,y, N1. That is
Dd¼Mode
y
O^UðyÞO^LðyÞ
 n o ð9Þ
The range of possible r values can be found from the principal
perpendicular rp by shifting it to the right (upward) along
the horizontal axis in the proﬁle map to ﬁnd the maximum
distance rmax, and then shifting rp to the left (downward) to ﬁnd
the minimum distance rmin. The maximum distance rmax should
be such that the distance between the upper contour O^UðyÞ and rp
is equal to half of the mode Dd for defect-free segments in the
proﬁle map, i.e.,
If f O^UðyÞr
 ¼Dd=2g, then aU(r)¼aU(r)þ1, for all y¼0, 1,
2,y, N1.
rmax ¼ arg Max aUðrÞ, for r¼ rp, rpþ1,. . .,MaxffXðyÞg
n o
where aU(r) is the accumulator to count the occurrence of
O^UðyÞr
 ¼Dd=2 for all locations y. Max{fX(y)} is the maximum
horizontal intercept in the y–fy plane. Likewise, the minimum
distance rmin is calculated from the lower contour O^LðyÞ.
If f9O^LðyÞr9¼Dd=2g, then aL(r)¼aL(r)þ1, for all
y¼0, 1, 2,y, N1.
rmin ¼ arg Max aLðrÞ, for r¼ rp, rp1,. . .,MinffXðyÞg
n o
The upper limit rmax and lower limit rmin can tightly limit the
search range of parameter r for each individual gray-level proﬁle.
Fig. 7 illustrates the proposed method to determine the search
range of perpendicular r in the proﬁle map. Once the search
ranges of r and y are determined, the voting weight W(x, fx9r, y)
in Eq. (7) can be efﬁciently calculated.
2.3.3. Defect detection
Let ðr, yÞ be the estimated line parameter values of a column
gray-level proﬁle X. A point (y, fX(y)) in the gray-level proﬁle X
will be distinguished as a defective or defect-free one by evaluat-
ing the distance Dðy,fXðyÞ9r,yÞ from point (y, fX(y)) to the ry
line using Eq. (6). If the distance D is signiﬁcantly larger than a
distance threshold TD, then the point (y, fX(y)), i.e., pixel (X, y) in
the original image, is classiﬁed as a defect point. Otherwise, it is
defect-free. The simple statistic process control (SPC) is applied to
set up the distance threshold TD. The control limit (i.e., threshold)
used to identify defect points is given by
TDX ¼ mDX þbsDX ð10Þ
where mDX is the mean and sDX is the standard deviation of
distance Dðy,fXðyÞ9r,yÞ for all points on the gray-level proﬁle X.
Note that the distance threshold is adaptively calculated for each
individual gray-level proﬁle. In the experiment, the control
constant b is empirically given by 1.5 for all gray-level proﬁles
in all test images. A defect point will be set to 1 (shown in black) if
the distance is larger than the control limit, whereas a defect-free
one will be set to 0 (shown in white) in the resulting binary
image. The detection result from the column gray-level proﬁles
then appears as a binary image B(X, y). That is
BðX,yÞ ¼ 1 ðdefectiveÞ if Dðy,fXðyÞ9r
,yÞ4mDX þbsDX
0 ðdefect-freeÞ otherwise
(
ð11Þ
The detailed procedure of the proposed Hough transform
scheme for defect detection in the Fourier reconstructed image
is summarized and algorithmically presented as follows.
2.3.4. Step (i) search for r and y ranges
1. Given an inspection image with corresponding Fourier recon-
structed image f^ ðx, yÞ of size MN, construct the proﬁle map
O(y, fX(y)).
2. Perform the morphological closing on O(y, fX(y)), and ﬁnd the
upper contour O^UðyÞ and the lower contour O^LðyÞ.
3. Find the principal angle yp and perpendicular rp by estimating
the dominant line segment of the average contour O^MðyÞ with
the proposed Hough-like voting process based on the search
ranges of r between 51 and 51, and y between Min{fX(y)} and
Max{fX(y)}.
4. Determine the search range of y between ypDy and ypþDy,
and the search range of r between rmin and rmax with
rmax ¼ arg Max aUðrÞ, r¼ rp, rpþ1,. . .,MaxffXðyÞg
n o
,
rmin ¼ arg Max aLðrÞ, r¼ rp, rp1,. . .,MinffXðyÞg
n o
2.3.5. Step (ii) line detection for each gray-level proﬁle
For each vertical gray-level proﬁle ffXðyÞ ¼ f ðX,yÞgN1y ¼ 0,
X¼0, 1, 2,y,M1:
5. Search y between ypþDy and ypDy with Dy¼ 13, and r
between rmin and rmax.
6. Calculate the voting weight, for y¼0, 1, 2,y, N1
Wðy,fXðyÞ9r,yÞ ¼ 1=½1þD3ðy,fXðyÞ9r,yÞ:
y
fX (y)
ˆOU (y)
ˆOL (y)
ˆOM (y)
Δd
Max {fX (y)}
Min {fX (y)}
max
min
Fig. 7. Illustration of the proposed search range of perpendicular r in the column
proﬁle map.
W.-C. Li, D.-M. Tsai / Solar Energy Materials & Solar Cells 95 (2011) 2206–22202212
256 one-dimensional (1D) column line images, each with a length
of 256 pixels, in the vertical scan direction. All the test images
used in the experiment were captured from actual solar wafer
surfaces. The Fourier transforms were adopted from the Fastest
Fourier Transform in the West (FFTW) software tool [26,27].
The proposed algorithms were implemented on an Intel Core 2,
3 GHz CPU personal computer. The mean computation time of the
proposed method was 0.26 s, including both the Fourier image
reconstruction and the Hough voting process in a 256256 image.
The control constant b of the statistical control limit was set at
1.5 for defect detection. The band-rejection radius rwas given by 30,
and the width of the vertical notch wwas set at 1. All the parameter
values of r, w, Dy and b are the same for all test samples in the
experiments. The effects of changes in parameter values of r, w and
b are ﬁrst presented in Section 3.1. The detection results of the test
samples are discussed in Section 3.2.
3.1. Effects of changes in parameter values of r, w, and b
There are three main parameters of the proposed defect
detection algorithms: the band-rejection radius r and the retain-
ing width of notch w for Fourier reconstruction, and the control
constant b of the control limit.
The band-rejection radius r for the low-frequency region was
used to remove the global crystal grain background. A large radius
r results in better smoothness of the background. However, an
excessively large radius r may also remove defects in the recon-
structed image. To evaluate the effect of varying radius r, the notch
width and the control constant were ﬁxed at w¼1 and b¼1.5. The
radius value of r was varied: 0, 10, 15, 25 and 30. Fig. 8 lists the
detection results of varying radius r. In the ﬁgure, the radius value
of zero (r¼0) corresponds to the original gray-level image. When
the radius is not sufﬁciently large, such as rr15, the multi-grain
background pattern cannot be effectively removed. A radius value
of 30 can well smooth all the residuals of the inhomogeneous
background and well preserve the saw-mark defect.
The vertical notch of width w in the Fourier spectrum pre-
serves the horizontal information in the original gray-level image
because the saw-mark appears horizontally in the sensed image.
The notch width should be larger than zero so that the saw-mark
feature can be preserved in the reconstruct image. A large notch
width can retain the main horizontal structure of the original
gray-level image. Using the defective solar wafer image in
Fig. 1(b) for testing, Fig. 9 presents the reconstructed images
and the detection results with notch widths w¼0, 1, 3 and 5,
given that the band-rejection radius r¼30 and control constant
b¼1.5. The results show that a notch width larger than one such
as w¼3 or w¼5 restores a rough approximation of the inhomo-
geneous background, and severe noise is detected in the resulting
binary image. A notch width of 1 (w¼1) can well serve the
purpose of background-removal and anomaly-preservation.
w = 0
w = 1
w = 3
w = 5
 Spectrum images Restoration images Detection results 
Fig. 9. Effect of changes in notch width with w¼0, 1, 3 and 5, given that the band-rejection radius r¼30 and the control constant b¼1.5.
W.-C. Li, D.-M. Tsai / Solar Energy Materials & Solar Cells 95 (2011) 2206–22202214
images. All the saw-mark defects are well detected, regardless of
the type of saw-mark.
In order to further verify the detection performance of the
proposed method, a total of 50 solar wafer images were eval-
uated, of which 30 were defect-free and 20 were defective. All the
parameter values were the same as those in the previous experi-
ment. The 20 defective images involved various saw-mark
defects, including black lines, white lines, white stripes, and
impurities. Nineteen out of the 20 defective solar wafer images
were correctly identiﬁed, and the false negative rate was 5%
(1/20). The mis-detected sample was a wear mark. It is hardly
observable in the image, as seen in Fig. 13(a). Fig. 13(b) is the
enhanced image of Fig. 13(a) obtained by linearly stretching
the gray-levels between 0 and 255 for an 8-bit display. The wear
saw-mark can now be better observed in the enhanced image,
but it is still not clearly distinguishable from its surrounding
background. Fig. 13(d) is the Fourier spectrum of Fig. 13(a), where
no strong vertical line corresponding to the horizontal saw-mark
can be visually observed. This subtle wear saw-mark can be well
identiﬁed in the binary image by reducing the control constant
b from 1.5 to 1, as shown in Fig. 13(e). No false alarms
were generated for the 30 defect-free solar wafer images, and
the false positive rate was zero for the test images in the
experiment.
Fig. 11. Detection results of defect-free solar wafer images: (a1)–(‘1) twelve faultless samples; (a2)–(‘2) corresponding power spectrum images of (a1)–(‘1); (a3)–(‘3)
respective Fourier reconstructed images; (a4)–ð‘4Þ detection results of the proposed inspection scheme, where no defects are declared.
W.-C. Li, D.-M. Tsai / Solar Energy Materials & Solar Cells 95 (2011) 2206–22202216
MN is simply given by
HðYÞ ¼
XM1
x ¼ 0
Bðx,YÞ, Y ¼ 0,1,2,. . .,N1 ð12Þ
where H(Y) is the accumulated black pixel points along horizontal
scan line Y. Since a true saw-mark defect will horizontally cross
over the whole image, the corresponding horizontal line must
contain a distinctly large number of black pixel points in the
binary image. Random noise in the resulting binary image gen-
erates only a few black points in a horizontal scan line. If H(Y) is
larger than the defect size of a user’s prespeciﬁed threshold, the
inspected image evidently contains a saw-mark defect.
The current multi-wire sawing machine can simultaneously
process four silicon ingots, wherein each squared ingot of height
200 mm is sliced into 500 thin wafers. It takes around 10 h to slice
Fig. 12. Detection results of defective solar wafer images: (a1)–(‘1) twelve defect samples; (a2)–(‘2) corresponding power spectrum images of (a1)–(‘1); (a3)–ð‘3Þ
respective Fourier reconstructed images; (a4)–ð‘4Þ detection results of the proposed inspection scheme, where various saw-marks are well detected.
W.-C. Li, D.-M. Tsai / Solar Energy Materials & Solar Cells 95 (2011) 2206–22202218
horizontally presented in the image. This inspection procedure can
provide full inspection, rather than sampling inspection, and thus
can effectively increase the yield in solar wafer manufacturing.
The potential importance of the proposed study lies in two key
areas: (1) inspection of solar wafer quality and (2) process monitoring
of multi-wire sawing machine. On-line inspection of sliced wafers
ensures product quality and prevents unsatisfactory wafers from
reaching the back-end processing, such as etching, texturing and anti-
reﬂection coating. It prevents the downstream manufacturer from
working on a ﬂawed wafer and thus can decrease unnecessary
operation costs and reworking. Process monitoring checks the condi-
tion of a machine and takes corrective actions for mechanical wear
and failure. The inspection of currently sliced wafers allows the
detection of a deteriorating slicing condition. It can shut down a
multi-wire sawing machine when saw-mark defects with assignable
causes are detected. The silicon ingots in the queue will not be further
processed until the machine is functioning properly. As a result, scrap
and material waste can be minimized, and the production yield and
manufacturing cost can be improved accordingly.
4. Conclusions
This paper has proposed a defect detection scheme based on
Fourier image reconstruction and Hough-like non-stationary line
detection to identify saw-mark defects in multicrystalline solar
wafer images. The inhomogeneous background of multicrystalline
grains in a solar wafer image can be effectively removed by
properly selecting the band-rejection region in the Fourier spec-
trum. The restored image shows a trend of a straight line from
each vertical 1D gray-level proﬁle. The segment of a vertical scan
line across the local defect region in the Fourier reconstructed
image will distinctly deviate from the Hough-like ﬁtting line.
The proposed method constructs a proﬁle map by overlapping
the vertical gray-level proﬁles in an image to ﬁnd the most likely
ranges of the line parameters based on the inherited properties of
saw-marks in the Fourier reconstructed image. The restricted ranges
of line parameter values can efﬁciently reduce the computational
complexity of the proposed Hough voting process. The experimental
results show that the proposed method can effectively detect
various saw-mark defects, including black lines, white lines, and
impurities in solar wafer surfaces. In this study, the proposed
method only concentrates on saw-mark defects that cross the entire
region of a solar wafer. It cannot be directly extended to detecting
small local defects embedded in the multicrystalline solar wafer.
However, the removal of the inhomogeneous texture by using the
Fourier reconstruction technique can be helpful to extend the
proposed method for the inspection of various defect types in solar
wafers. It is worthy of further investigation.
References
[1] A. Goetzberger, C. Hebling, Photovoltaic material, past, present, future, Sol.
Energy Mater. Sol. Cells 62 (2000) 1–19.
[2] T.C. Palathra, Process modeling of a wire saw operation, Ph.D. Thesis, Faculty
of the Graduate School of the University of Maryland, College Park, 2008.
[3] J.M. Kim, Y.K. Kim, Saw-damage-induces structural defects on the surface of
silicon crystals, J. Electrochem. Soc. 152 (2005) G189–G192.
[4] H.J. Mo¨ller, C. Funke, M. Rinio, S. Scholz, Multicystalline silicon for solar cells,
Thin Solid Films 487 (2005) 179–187.
[5] G. Du, L. Zhou, P. Rossetto, Y. Wan, Hard inclusions and their detrimental
effects on the wire sawing process of multicrystalline silicon, Sol. Energy
Mater. Sol. Cells 91 (2007) 1743–1748.
[6] H. Park, S. Kwon, J.S. Lee, H.J. Lim, S. Yoon, D. Kim, Improvement on surface
texturing of single crystalline silicon for solar cells by saw-damage etching
using an acidic solution, Sol. Energy Mater. Sol. Cells 93 (2009) 1773–1778.
[7] T. Markvart, L. Castaner, Solar Cells: Materials, Manufacture and Operation,
Elsevier, Oxford, UK, 2005 pp.72–73.
[8] P. Pauli, J.G. Beesley, U.P. Scho¨nholzer, U. Kerat, Swiss wafer slicing technol-
ogy for the global PV market from MeyerþBurger AG novel trends for the
future in photovoltaic wafer manufacturing, in: Proceedings of 6e Symposium
Photovoltaı¨que National SIG Geneve, Lignon, France, 2005.
[9] A. Maller, M. Reinecke, A. Bachmann, C. Seifert, T. Trammer, R. Schindler,
Towards larger and thinner wafers used in photovoltaic, in: Proceedings of
Photovoltaic Specialists Conference, Conference Record of the Thirty-ﬁrst
IEEE, 2005, pp. 1019–1022.
[10] Z. Fu, Y. Zhao, Y. Liu, Q. Cao, M. Chen, J. Zhang, J. Lee, Solar cell crack
inspection by image processing, in: Proceedings of International. Conference
on Business of Electronic Product Reliability and Liability, Shanghai, China,
2004, pp. 77–80.
[11] M.A. Ordaz, G.B. Lush, Machine vision for solar cell characterization, in:
Proceedings of SPIE, San Diego, CA, USA, 2000, pp. 238–248.
[12] M. Pilla, F. Galmiche, X. Maldague, Thermographic inspection of cracked solar
cells, in: Proceedings of SPIE, Seattle, WA, USA, 2002, pp. 699–703.
[13] D.M. Tsai, C.C. Chang, S.M. Chao, Micro-crack inspection in heterogeneously
textured solar wafers using anisotropic diffusion, Image Vision Comput. 28
(2010) 491–501.
[14] Y.T.N. Henry, G.K.H. Pang, Regularity analysis for patterned texture inspec-
tion, IEEE Trans. Autom. Sci. Eng. 6 (2009) 131–144.
[15] Y.T.N. Henry, G.K.H. Pang, N.H.C. Yuag, Performance evaluation for motif-
based patterned texture defect detection, IEEE Trans. Autom. Sci. Eng. 7
(2008) 58–72.
[16] Y.H. Tseng, D.M. Tsai, Defect detection of uneven brightness in low-contrast
images using basis image representation, Pattern Recognition 43 (2010)
1129–1141.
[17] D.M. Tsai, S.C. Lai, Defect detection in periodically patterned surfaces using
independent component analysis, Pattern Recognition 41 (2008) 2812–2832.
[18] I. Ar, Y.S. Akgul, A generic system for the classiﬁcation of marble tiles using
Gabor ﬁlters, in: Proceedings of International Symposium on Computer and
Information Sciences, Istanbul, 2008, pp. 1–6.
[19] X. Xie, M. Mirmehdi, Localising surface defects in random color textures
using multiscale texem analysis in image eigenchannels, in: Proceedings of
IEEE International. Conference on Image Processing, Genoa, Italy, 2005,
pp. III–1124–7.
[20] X. Xie, M. Mirmehdi, Texture exemplars for defect detection on random
textures, in: International Conference on Advances in Pattern Recognition,
Bath, UK, 2005, pp. 404–413.
[21] X. Xie, M. Mirmehdi, TEXEMS: texture exemplars for defect detection on
random textured surfaces, IEEE Trans. Pattern Anal. Mach. Intell. 29 (2007)
1454–1464.
[22] J.C. Liu, G. Pok, Texture edge detection by feature encoding and predictive
model, in: Proceedings of International Conference on Acoustics, Speech, and
Signal Processing, Phoenix, Arizona, 1999, pp. 1105–1108.
[23] V.P.C. Hough, A Method and Means for Recognizing Complex Patterns, U.S.
Patent 3069654, 1962.
[24] R.O. Duda, P.E. Hart, Use of the Hough transformation to detect lines and
curves in pictures, Commun. ACM 15 (1972) 11–15.
[25] R.C. Gonzalez, R.E. Woods, Digital Image Processing, Addison-Wesley, Read-
ing, MA, 1992.
[26] M. Frigo, S.G. Johnson, FFTW Web Page, 2004. Available online at: /http://
www.fftw.orgS.
[27] M. Frigo, S.G. Johnson, The design and implementation of FFTW3, Proceed-
ings of IEEE 93 (2005) 216–231.
Fig. 13. The mis-detected sample: (a) a wear mark; (b) enhanced image of (a); (c) power spectrum image of (a); (d) Fourier reconstructed image; (e) detection result of the
proposed inspection scheme with b¼1.0.
W.-C. Li, D.-M. Tsai / Solar Energy Materials & Solar Cells 95 (2011) 2206–22202220
126 IEEE TRANSACTIONS ON INDUSTRIAL INFORMATICS, VOL. 7, NO. 1, FEBRUARY 2011
Fig. 1. Two sample images of multicrystalline solar wafers. (a) Defect-free
multigrain wafer surface. (b) Defective wafer surface containing a fingerprint
defect.
previously only perform well for defect detection in uniform
and homogeneously textured surfaces. For heterogeneously tex-
tured surfaces, similar patterns will not repeatedly appear in the
image. It makes the discrimination between faultless and defec-
tive regions extremely difficult.
In semiconductor manufacturing, a wafer contains repeated
dies of the same electrical components and layout. The defect
detection algorithms for wafer die inspection utilize the prop-
erty that all dies in the wafer show identical patterns. Die-to-die
comparison [37] between adjacent dies in the wafer is a simple
method to detect the difference. A collection of defect-free dies
are used as the golden template [38], or are used as the training
samples in neural networks [39] for comparison or classifica-
tion. Self-reference methods [40]–[42] that generate the tem-
plate from the inspection wafer itself are also used for wafer die
inspection. The repetitive periods in both horizontal and ver-
tical directions are first evaluated. A synthetic template is then
created from the image itself based on the pixel values in sub-
sequent periods, and is used for comparison with the inspection
image. Shankar and Zhong [43] proposed alternatively a nonref-
erential method based on wavelet decomposition and morpho-
logical operations for wafer die inspection. It requires a spe-
cific design of structuring elements for individual defect types
and assumes that local defects and any parts of the background
are structurally different. Since each multicrystalline solar wafer
has a unique pattern and local defects could be structurally sim-
ilar to crystal grain edges, the currently available defect inspec-
tion algorithms for patterned wafers cannot be extended for de-
fect detection in multigrain solar wafers.
Solar power is an attractive alternative of electrical energy
due to growing environmental concern and oil shortage. Mul-
ticrystalline, instead of monocrystalline, material dominates
the production volume of silicon cells owing to lower man-
ufacturing costs. Fig. 1(a) shows the image of a defect-free
multicrystalline solar wafer surface. It contains multiple grains
of random shapes and sizes and, therefore, results in a hetero-
geneously textured pattern. There are no two solar wafers with
the same grain patterns. Fig. 1(b) displays a defective solar
wafer image that contains a fingerprint defect marked by a
dotted frame in the image. It can be seen from the figure that
the defect is very difficult to identify from the heterogeneous
background. The conventional defect detection methods for
uniform and homogeneous surfaces are not directly extensible
for defect detection in multicrystalline solar wafers that involve
heterogeneous surfaces.
Mean shift is a nonparametric feature space analysis tool that
finds the modes in multiple-dimensional data using kernel den-
sity estimators. The mean-shift algorithm was first introduced
by Fukunaga and Hostetler [44] for nonparametric clustering
of vector-valued data. It is extended to image processing by
Comaniciu and Meer [45]. It has been successfully applied to
edge-preserving smoothing [46], [47], image segmentation [48],
[49], and texture segmentation/ classification [50], [51].
In image processing applications, the mean-shift algo-
rithm shifts each pixel with pixel coordinates and pixel value
as the features to the mode. Since flat regions induce the
modes, it can be expected that a noisy background can be
effectively smoothed while the meaningful edges can be pre-
served. In this study, the defect detection scheme based on
mean-shift smoothing is proposed for multicrystalline solar
wafer inspection.
The fingerprint and contamination embedded in multicrys-
talline solar wafers are the main defect types evaluated in this
study. Detecting defects in the original gray-level image is im-
possible because both defects and the multigrain background
present similar gray-level distributions. Since the grain edges
enclosed in a small spatial window in the multicrystalline sil-
icon wafer show more consistent edge directions and a defec-
tive region presents a high variation of edge directions, the en-
tropy of gradient directions in the spatial window is first calcu-
lated to convert the gray-level image into an entropy image. The
mean-shift smoothing procedure is then performed to remove
noise and defect-free grain edges in the entropy image. The sus-
pected edge points in the filtered image are identified as defec-
tive ones by using a simple adaptive threshold. The goal of the
proposed algorithm is to detect the presence/absence of defects
in a solar wafer image. The detected defects will be presented in
a binary image to visualize the detection results. However, ac-
curate segmentation of defect positions, shapes, and sizes is out
of the scope of this study.
This paper is organized as follows. Section II first overviews
the mean-shift algorithm. The proposed defect detection scheme
for solar wafer images with heterogeneous textures is then pre-
sented. The section ends with the guidelines and automatic pa-
rameter setting for the choice of mean-shift kernel bandwidths.
Section III presents the experimental results on multicrystalline
solar wafers. The effect of changes in parameter values of the
mean-shift procedure is also evaluated in this section. This paper
is concluded in Section IV.
II. DEFECT DETECTION USING MEAN SHIFT
For the sake of completeness, this section starts with the
overview of the mean-shift algorithm proposed by Comaniciu
and Meer [45], followed by the proposed defect detection
scheme for solar wafer surfaces with heterogeneous textures.
A. Mean Shift Algorithm
Given a set of data points , , and ,
the probability density of can be obtained from the kernel
density estimator
(1)
128 IEEE TRANSACTIONS ON INDUSTRIAL INFORMATICS, VOL. 7, NO. 1, FEBRUARY 2011
Since the gray levels in the original wafer image do not provide
sufficient information for the discrimination between defective
and defect-free regions, the entropy of gradient directions of all
edge points in a small neighborhood window is first calculated
to convert the gray-level image into an entropy image. A de-
fect-free region presents more consistent edge directions and re-
sults in a small entropy value. A defective region shows a high
variation of edge directions and yields a large entropy value.
The mean-shift filtering is then proceeded in the entropy image
to remove noise and smooth defect-free grain edges. A simple
adaptive threshold can then be applied to distinguish defective
edge points from the background points in the filtered entropy
image.
1) Conversion of Direction Entropy: Let be an edge
point, which is detected by the Canny edge detector [52] in this
study. Fig. 2(b) shows the gradient image of the defective solar
wafer in Fig. 2(a). Fig. 2(c) and (d) display the detected edges
as binary images for Fig. 2(b) with a small gradient threshold
(a gradient magnitude of 10) and a large gradient threshold (a
gradient magnitude of 40), respectively. The results show that
the defect region cannot be simply identified from the gradient
image.
The gradient direction for an edge point with its orig-
inal gray-level is given by
(9)
where ;
. The gradient angle is further extended in
the range between 0 and 360 by considering the signs of
and .
Denote by the probability of gradient angle in interval
in a small neighborhood window. In this study, the histogram
of gradient angles is divided into 100 intervals and the neighbor-
hood window is of size 19 19 pixels. The entropy of gradient
directions for each edge point in a small neighborhood
window is defined as
(10)
The entropy of a non-edge point is set to zero. Now
the original gray-level image is converted to an entropy
image .
Fig. 3(a) shows the solar wafer image containing a fingerprint
defect, in which square A marks a defect-free region and square
B marks a portion of the fingerprint. Fig. 3(b) and (c) present,
respectively, the histograms of gradient angles for squares A and
B. Due to the horizontal grain edges in square A, the gradient
histogram of square A is more concentrated at 90 , whereas the
gradient angles are more uniformly distributed in all directions
for square B. These result in an entropy of 3.56 for the defect-
free region of square A, and 4.09 for the defective region of
square B. Fig. 3(d) and (e) further depict the gradient angles
of squares A and B in 3D perspective. A simple thresholding
cannot be directly applied to the entropy image to distinguish
the difference between defect-free and defective regions.
2) Mean-Shift Filtering for Grain Edge Removal: In order
to remove the noisy points generated from the grain edges in
Fig. 3. Distributions of gradient angles in defect-free and defective regions
of a solar wafer: (a) solar wafer image, where dotted frame A is defect-free
and dotted frame B contains a portion of the fingerprint; (b), (c) histograms of
gradient angles for defect-free region A and defective region B, respectively;
(d), (e) plots of gradient angles in 3D perspective for regions A and B,
respectively.
the entropy image, the mean-shift filtering is performed on the
entropy image. The mean-shift process assigns a background
value (i.e., the mode) to the normal grain edges, while pre-
serving the entropy values of defective edges. A simple adaptive
threshold based on the mean and standard deviation of entropy
values in the whole filtered image is then used for identifying
the defective points from the background in the image. In this
study, the simple uniform kernel is used in the mean-shift pro-
cedure. The Gaussian kernel generates similar detection results.
The proposed mean-shift scheme for defect detection in solar
wafer surfaces with heterogeneous textures is expressed in de-
tail as follows.
Algorithm:
Input: image of size to be inspected
spatial bandwidth
range (entropy) bandwidth
termination threshold of the mean-shift iterations
Step 1. Convert the gray-level image into the entropy
image , for and
using (9) and (10).
Step 2. Perform the mean-shift filtering on the entropy image
pixel by pixel, for and
. For each pixel , find the
converged location . Replace the entropy value
with . It iterates as follows.
130 IEEE TRANSACTIONS ON INDUSTRIAL INFORMATICS, VOL. 7, NO. 1, FEBRUARY 2011
The termination threshold of the mean-shift process is
based on the mean-shift magnitude in the feature space in two
consecutive iterations. That is
where and are related to the spatial bandwidth and
is associated with the range (entropy) bandwidth . The termi-
nation threshold is therefore adaptively expressed as a function
of and . Once the spatial bandwidth and the range band-
width are determined, it is given by
(11)
where is a percentage constant between 0% and 100%.
Among the three parameters , , and , the most critical
one is the range bandwidth for defect detection applications.
Rather than trial-and-error, a more systematic approach is re-
quired for automatic selection of a proper range bandwidth for
specific surfaces. In defect detection applications, an value
larger than the maximum difference of feature values will cause
no false positive points in a defect-free surface. Therefore, the
number of noisy points will decrease as the range bandwidth in-
creases. However, an excessively large value reduces the dis-
crimination power to identify the defect points. In this study, the
range bandwidth is automatically learned from a set of de-
fect-free test samples. The objective is to find a minimum range
bandwidth under the constraints that all defect-free test images
generate no noisy points. Let , , be a set of
defect-free test images. The optimization model for range band-
width selection is formulated as
(12)
where is the entropy of gradient directions for pixel
in test image .
Generally, the possible values of are limited in a very
small range. An exhaustive search with a given resolution can be
easily carried out to find the optimal value of . In this study,
the range bandwidth is associated with the entropy. A small res-
olution of 0.1 is used to find the best value. The selected
value from the optimization model achieves a best discrimina-
tion power for defect detection, while maintaining the stability
for defect-free samples.
III. EXPERIMENTAL RESULTS
In this section, we present experimental results on a number
of heterogeneous solar wafer surfaces. The proposed algo-
rithms are implemented on a Pentium Core2 Duo, 3.0 GHz
personal computer using the C++ language. The test images
are 256 256 pixels wide with 8-bit gray levels. The spatial
resolution of the image is 0.09 mm per pixel. The mean com-
putation time is 2.0 s for a 256 256 solar wafer image. In
order to demonstrate the effectiveness of the proposed methods,
no smoothing preprocessing is applied to the input gray-level
images and no morphological postprocessing is used to remove
Fig. 5. Effect of changes in spatial bandwidth   on solar wafer sur-
faces: (a1) defect-free solar wafer image; (b1) defective solar wafer image;
(a2)–(a4) detection results with     , 20 and 25 for the defect-free image in
(a1); (b2)–(b4) detection results with the respective   values for the defective
image in (b1). (a2)      (a3)      (a4)      (b2)      (b3)
     (b4)     .
noise and connect blobs in the resulting binary images. In
Sections III-A–III-E, the effects of changes in parameter values
of , , , and neighborhood window size are separately
evaluated.
A. Effect of Changes in Spatial Bandwidth
The spatial bandwidth determines the number of neigh-
boring pixels used in the kernel. A small spatial bandwidth
causes a fast convergence of the mean-shift process. The early
termination of mean-shift filtering with a small value may
not sufficiently smooth the background and results in noisy
points. A very large value may oversmooth the entropy
image and reduce the detected size of a defect.
Fig. 5(a1) and (b1) show a defect-free and a defective solar
wafer image, respectively. Given that (determined
by the automatic selection model), for the
termination threshold and for the control limit,
Fig. 5(a2)–(a4) and (b2)–(b4) present the detection results with
varying spatial bandwidth values of , 20, and 25.
132 IEEE TRANSACTIONS ON INDUSTRIAL INFORMATICS, VOL. 7, NO. 1, FEBRUARY 2011
Fig. 8. Effect of changes in windows size for the computation of direction en-
tropy: (a) fingerprint image for the test; (b)–(d) detected fingerprint regions with
window sizes of 15  15, 19  19 and 23  23, respectively; (e)–(g) defect re-
gions detected manually (solid-white lines for the ground truth region) and al-
gorithmically (dotted-black lines). (b) 15  15 (c) 19  19 (d) 23  23.
indicate that the proposed mean-shift defect detection scheme
are not sensitive to the changes of value for the termination
threshold . The values in the range between 1% and 0.01%
all generate similar detection results for solar wafer surfaces.
The proposed termination threshold as a small percentage of
can effectively determine the required convergence for
defect-free and defective pixels in the inspection image. A tight
value (e.g., ) generally results in less noise, but
induces more mean-shift iterations. A value of 0.1% has gen-
erally performed well for various test surfaces, and is recom-
mended for the mean shift-based defect detection scheme.
D. Effect of Changes in Window Sizes for Entropy Feature
In order to evaluate the effect of changes in the neighborhood
window for the computation of direction entropy, the fingerprint
image in Fig. 8(a) is used as the test sample, and the detection
results with window sizes 15 15, 19 19, and 23 23 are pre-
sented in Fig. 8(b)–(d), respectively. All three window sizes can
detect the fingerprint. A small neighborhood window tends to
reduce the detected defect size, whereas a large neighborhood
window enlarges the defect size and may generate noise. The
effect of changes in window size is also analyzed with receiver
operating characteristic curves in Section III-E.
To further verify the detected defect size with respect to the
ground truth region, Fig. 8(e)–(g) shows the defect regions de-
tected algorithmically and manually, where the solid-white lines
are the ground-truth regions and the dotted-black lines are the
detected regions. When the fingerprint is clear in the wafer sur-
face, it can be well identified and the detected contour is consis-
tent with the manually marked region. For the fingerprint lying
between multiple grains regions, the print is light and is hardly
visible. The proposed method thus misdetects this portion of the
fingerprint.
E. More Testing Results
The efficacy of the proposed defect detection methods with
the best parameter values found in the previous experiments
is demonstrated with more solar wafer images. Fig. 9 shows a
set of 8 multicrystalline solar wafers, where (a1)–(d1) are de-
fect-free images, and (e1)–(f1) contain fingerprint defects and
(g1)–(h1) present contamination defects. The detection result of
Fig. 9(a1)–(h1) are shown as binary images in Fig. 9(a2)–(h2),
respectively. The hardly identifiable defects in all defective test
images are well segmented. The resulting binary images of de-
fect-free test images are uniformly white and no defects are de-
clared. The proposed method can be well applied to defect de-
tection in solar wafer surfaces, where defects present high gra-
dient direction variation with respect to the crystal grain edges.
In order to further verify the detection performance of the pro-
posed method, a total of 130 test samples are evaluated. The
test set contains 10 fingerprint samples, 20 contamination sam-
ples of various sizes, and 100 defect-free wafer images with
random grain patterns. In the experiment, an image under test
is declared as defective if there are any black pixels in the re-
sulting binary image. Only the one with all white pixels in the
entire binary image is claimed to be defect-free. Morpholog-
ical operations could be carried out to eliminate noisy points in
the binary image. However, the postprocessing operations are
not applied in the experiment to show the robustness of the pro-
posed algorithm. With the same parameter setting of ,
, and , all the 30 defective im-
ages are correctly detected and the false negative rate is 0. Only
one of the 100 defect-free images is falsely identified and the
corresponding false positive rate is 1%. The receiver operating
characteristic (ROC) curves of the proposed method for the 130
test samples are also evaluated. The proposed algorithm aims at
the detection of presence/absence of defects in an image and,
thus, the ROC curve is analyzed at the image level. Since the
parameters and are insensitive to the detection results, we
present only the ROC curves for varying range bandwidth
of 3.9, 4.0, and 4.1 in Fig. 10(a). For a given range bandwidth
value, the ROC curve is constructed by varying the control con-
stant from a very small number (with a true positive rate of
1) to a very large number (with a false positive rate of zero). The
ROC curve rises swiftly upward with and indicates a
very good performance of the proposed method.
Fig. 10(b) further shows the ROC curves of the proposed
method for the 130 test images with varying window sizes of
15 15, 19 19, and 23 23. In the 30 defective images, the
defect sizes range from 543 pixels (0.8% of the whole image
area) to 13502 pixels (20% of the image). The window size of
19 19 gives the best performance. All the defects of varying
sizes can be detected with this setting. A larger window size of
23 23 tends to have better performance than a smaller window
size of 15 15.
134 IEEE TRANSACTIONS ON INDUSTRIAL INFORMATICS, VOL. 7, NO. 1, FEBRUARY 2011
direction variation. It cannot be directly extended to other de-
fect types such as cracks that show only line-shaped figures
and present a low variation in gradient directions. Different dis-
crimination features may be needed for different types of de-
fects to construct the vector-valued feature image. The proposed
mean-shift process can then be applied to smooth the feature
values in the background and retain the feature values of local
anomalies. It is worthy of further investigation.
REFERENCES
[1] T. S. Newman and A. K. Jain, “A survey of automated visual in-
spection,” Computer Vision and Image Understanding, vol. 61, pp.
231–262, Mar. 1995.
[2] J. Wilder, “Finding and evaluating defects in glass,” in Machine Vision
for Inspection and Measurement, H. Freeman, Ed. New York: Aca-
demic Press, 1989, pp. 237–237.
[3] J. Olsson and S. Gruber, “Web process inspection using neural clas-
sification of scattering light,” in Proc. IEEE Int. Conf. Ind. Electron.,
Control, Instrum. Autom., San Diego, CA, 1992, pp. 1443–1448.
[4] X. Xie, “A review of recent advances in surface defect detection using
texture analysis techniques,” Electron. Lett. Computer Vision and
Image Analysis, vol. 7, pp. 1–22, 2008.
[5] D. Brzakovic, H. Beck, and N. Sufi, “An approach to defect detection
in materials characterized by complex textures,” Pattern Recogn., vol.
23, pp. 99–107, 1990.
[6] F. S. Cohen, “Maximum likelihood unsupervised textured image seg-
mentation,” CVGIP: Graphical Models Image Process, vol. 54, pp.
239–251, 1992.
[7] M. M. Van Hulle and T. Tollenaere, “A modular artificial neural net-
works for texture processing,” Neural Networks, vol. 6, pp. 7–32, 1993.
[8] R. M. Haralick, K. Shanmugam, and I. Dinstein, “Texture features for
image classification,” IEEE Trans. Syst., Man, Cybernetics, vol. 3, pp.
610–621, 1973.
[9] R. W. Conners, C. W. McMillin, K. Lin, and R. E. Vasquez-Espinosa,
“Identifying and locating surface detects in wood,” IEEE Trans. Pattern
Anal. Mach. Intell., vol. PAMI-5, pp. 573–583, 1983.
[10] L. H. Siew and R. M. Hogdson, “Texture measures for carpet wear
assessment,” IEEE Trans. Pattern Anal. Mach. Intell., vol. 10, pp.
92–105, 1988.
[11] K. V. Ramana and B. Ramamoorthy, “Statistical methods to compare
the texture features of machined surfaces,” Pattern Recogn., vol. 29,
pp. 1447–1459, 1996.
[12] A. Bodnarova, J. Williams, M. Bennamoun, and K. Kubik, “Optimal
textural features for flaw detection in textile materials,” in Proc. IEEE
TENCON’97 Conf., Brisbane, Queensland, 1997, pp. 13–18.
[13] S. S. Liu and M. E. Jernigan, “Texture analysis and discrimination in
additive noise, computer vision,” Graphics, Image Process, vol. 49, pp.
52–67, 1990.
[14] R. Azencott, J. P. Wang, and L. Younes, “Texture classification using
windowed Fourier filters,” IEEE Trans. Pattern Anal. Mach. Intell., vol.
19, no. 2, pp. 148–153, Feb. 1997.
[15] J. Escofet, M. S. Millan, H. Abril, and E. Torrecilla, “Inspection
of fabric resistance to abrasion by Fourier analysis,” in Proc. SPIE,
Brugge, Belgium, 1998, vol. 3490, pp. 207–210.
[16] C.-H. Chan and K.-H. Pang, “Fabric defect detection by Fourier anal-
ysis,” IEEE Trans. Ind. Appl., vol. 36, no. 5, pp. 1267–1276, Sep./Oct.
2000.
[17] T. Ohshige, H. Tanaka, Y. Miyazaki, T. Kanda, H. Ichimura, N.
Kosaka, and T. Tomoda, “Defect inspection system for patterned
wafers based on the spatial-frequency filtering,” in Proc. IEEE/CHMT
Eur. Int. Electronic Manuf. Technol. Symp., New York, 1991, pp.
192–196.
[18] S. G. Mallat, “A theory for multiresolution signal decomposition: The
wavelet representation,” IEEE Trans. Pattern Anal. Mach. Intell., vol.
11, no. 7, pp. 674–693, Jul. 1989.
[19] T. Chen and C. C. J. Kuo, “Texture analysis and classification with
tree-structured wavelet transform,” IEEE Trans. Image Processing, vol.
2, no. 4, pp. 429–441, Oct. 1993.
[20] C. H. Chen and G. G. Lee, “On digital mammogram segmentation and
microcalcification detection using multiresolution wavelet analysis,”
Graphical Models Image Process, vol. 59, pp. 349–364, 1997.
[21] K. Maruo, T. Shibata, T. Yamaguchi, M. Ichikawa, and T. Ohmi, “Au-
tomatic defect pattern detection on LSI wafers using image processing
techniques,” IEICE Trans. Electronics, vol. E82-C, pp. 1003–1012,
1999.
[22] H. Sari-Sarraf and J. Goddard, “Vision systems for on-loom fabric
inspection,” IEEE Trans. Industry Applications, vol. 35, no. 6, pp.
1252–1259, Nov./Dec. 1999.
[23] J. Scharcanski, “Stochastic texture analysis for monitoring stochastic
processes in industry,” Pattern Recogn. Lett., vol. 26, pp. 1701–1709,
2005.
[24] X. Yang, G. Pang, and N. Yung, “Robust fabric defect detection and
classification using multiple adaptive wavelets,” IEE Proc. Vision,
Image Processing, vol. 152, pp. 715–723, 2005.
[25] G. Lambert and F. Bock, “Wavelet methods for texture defect detec-
tion,” in Proc. IEEE Int. Conf. Image Process., Washington, DC, 1997,
vol. 3, pp. 201–204.
[26] J. G. Daugman, “Uncertainty relation for resolution in space, spatial-
frequency, and orientation optimized by two-dimensional visual cor-
tical filters,” J. Opt. Soc. Amer., vol. 2, pp. 1160–1169, 1985.
[27] M. Clark and A. C. Bovik, “Texture segmentation using Gabor modu-
lation/demodulation,” Pattern Recogn. Lett., vol. 6, pp. 261–267, 1987.
[28] D. A. Clausi and M. E. Jernigan, “Designing Gabor filters for optimal
texture separability,” Pattern Recogn., vol. 33, pp. 1835–1849, 2000.
[29] W. Polzleitner and G. Schwingskakl, “Quality classification of wooden
surfaces using Gabor filters and genetic feature optimization,” in Proc.
SPIE, Boston, MA, 1999, vol. 3837, pp. 220–231.
[30] G. Paschos, “Fast color texture recognition using chromaticity mo-
ments,” Pattern Recogn. Lett., vol. 21, pp. 837–841, 2000.
[31] K. Wiltschi, A. Pinz, and T. Lindeberg, “Automatic assessment scheme
for steel quality inspection,” Mach. Vision Appl., vol. 12, pp. 113–128,
2000.
[32] A. Bodnarova, M. Bennamoun, and S. J. Latham, “Constrained min-
imization approach to optimize Gabor filters for detecting flaws in
woven textiles,” in Proc. IEEE Int. Conf. Acoustics, Speech and Signal
Processing, Istanbul, Turkey, 2000, vol. 6, pp. 3606–3609.
[33] A. Kumar and G. Pang, “Defect detection in textured materials using
Gabor filters,” IEEE Trans. Ind. Appl., vol. 38, no. 2, pp. 425–440,
Mar./Apr. 2002.
[34] A. Bodnarova, M. Bennamoun, and S. Latham, “Optimal Gabor fil-
ters for textile flaw detection,” Pattern Recog., vol. 35, pp. 2973–2991,
2002.
[35] A. Kumar and G. Pang, “Defect detection in textured materials using
optimized filters,” IEEE Trans. Syst., Man, Cyber.-Part B: Cybern., vol.
32, no. 5, pp. 553–570, Oct. 2002.
[36] X. Xie and M. Mirmehdi, “TEXEMS: Texture exemplars for defect de-
tection on random textured surfaces,” IEEE Trans. Pattern Anal. Mach.
Intell., vol. 29, no. 8, pp. 1454–1464, Aug. 2007.
[37] P. T. Bourgeat, F. Meriaudeau, K. W. Tobin, Jr, and P. Gorria, “Pat-
terned wafer segmentation,” in Proc. SPIE, 2003, vol. 5132, pp. 36–44.
[38] N. G. Shankar and Z. W. Zhong, “Defect detection on semiconductor
wafer surfaces,” Microelectron. Eng., vol. 77, pp. 337–346, 2005.
[39] C.-T. Su, T. Yang, and C.-M. Ke, “A neural network approach for semi-
conductor wafer post-sawing inspection,” IEEE Trans. Semiconductor
Manuf., vol. 15, no. 2, pp. 260–266, May 2002.
[40] B. H. Khalaj, H. K. Aghajan, and T. Kailath, “Patterned wafer inspec-
tion by high resolution spectral estimation techniques,” Mach. Vision
Appl., vol. 7, pp. 178–185, 1994.
[41] P. Xie and S.-U. Guan, “A golden-template self-generating method for
patterned wafer inspection,” Mach. Vision Appl., vol. 12, pp. 149–156,
2000.
[42] S.-U. Guan, P. Xie, and H. Li, “A golden-block-based self-refining
scheme for repetitive patterned wafer inspections,” Mach. Vision Appl.,
vol. 13, pp. 314–321, 2003.
[43] N. G. Shankar and Z. W. Zhong, “Improved segmentation of semicon-
ductor defects using area sieves,” Mach. Vision Appl., vol. 17, pp. 1–7,
2006.
[44] K. Fukunaga and L. D. Hostetler, “The estimation of the gradient of a
density function, with applications in pattern recognition,” IEEE Trans.
Inform. Theory, vol. 21, no. 1, pp. 32–40, Jan. 1975.
[45] D. Comaniciu and P. Meer, “Mean shift: A robust approach toward
feature space analysis,” IEEE Trans. Pattern Anal. Mach. Intell., vol.
24, no. 5, pp. 603–619, May 2002.
[46] G. Hu, Q. Peng, and A. R. Forrest, “Mean shift denoising of point-
sampled surfaces,” Visual Computer, vol. 22, pp. 147–157, 2006.
[47] W. Liu, Y. Duan, K. Shao, and L. Zhang, “Image smoothing based on
the mean shift algorithm,” in Proc. IEEE Int. Conf. Control Autom.,
Guangzhou, China, 2007, pp. 1349–1353.
表 Y04 
行政院國家科學委員會補助國內專家學者出席國際學術會議報告 
                                                      2012 年  03 月  02  日 
報告人姓名  蔡篤銘 
 
服務機構
及職稱 
 
元智大學工業工程與管理系所 
 
     時間 
會議 
     地點 
 
2012/02/24 至 02/26 
義大利、羅馬 
本會核定
補助文號
NSC 98-2221-E-155-030-MY3 
會議 
名稱 
7th International Joint Conference on Computer Vision, Imaging and Computer 
graphics Theory and Applications 
發表 
論文 
題目 
ICA-based action recognition for human-computer interaction in disturbed 
backgrounds 
報告內容應包括下列各項： 
一、參加會議經過 
第七屆 電腦視覺, 影像與電腦圖像理論及應用國際研討會是影像處理領域中極為重要
的國際聯合大型研討會，一共包含三個主要子研討會，錄取率約六成，屬於相當盛大的
會議，而議程包含影像處理的各大研究領域，其中有機器視覺、人機介面、資料模式辨
識與機器學習、電腦圖學等議程，全部議程皆屬於影像處理的範疇，因此能夠匯集各個
國家的專家學者互相討論。本次參與 Poster Session 中所發表之題目為 ICA-based action 
recognition for human-computer interaction in disturbed backgrounds，進行一整個下午的現場成果展
示，而本屆會議正式於 02/26 下午六點圓滿結束。 
 
二、與會心得 
本次研討會為機器視覺領域中相當重要之國際研討會，在會中看到了許多新穎的概念及
想法，本屆研討會中，除了能夠在國際場合中推廣研究的成果，也藉此吸引許多國外研
究單位主動的接觸交流，瞭解資料辨識的市場與重要性，也期許台灣能在這塊領域持續
深耕。 
 
三、考察參觀活動(無是項活動者省略) 
無 
四、建議 
本次會議遠在義大利，而會場的亞洲人大部分來自中國與韓國，雖然演講報告水準仍不
穩定，但可見其國家的經濟實力正逐漸提升，也大力支持研究人員出席國際會議，期待
未來台灣在國際會議場合也有更多發揮及表現的機會。 
 
五、攜回資料名稱及內容 
VISIGRAPP 研討之會議論文全文光碟，光碟內容收錄與會之所有論文全文。 
 
 2
2. ICA-BASED APPROACH FOR ACTION RECOGNITION 
This section discusses the ICA-based approach for action 
recognition that comprises the Exponential Motion History 
Image (EMHI) for spatiotemporal representation of motions, 
extraction of motion features by ICA, and the distance measure 
for classification. 
2.1 Spatiotemporal representation 
The proposed activity recognition scheme first constructs a 
global representation of motion that can describe the changes in 
both temporal and spatial dimensions. In this study, we focus on 
the recognition of specific activities that can be defined 
beforehand. We also use the exponential motion history image 
(EMHI) as the spatiotemporal representation of a video 
sequence and then apply the ICA basis images for classifying 
the pre-determined actions. For completeness, the construction 
of EMHI from a stream of video sequences is briefly described 
here, and the advantage of EMHI over the conventional MHI for 
the recognition of specific activities is also analyzed. 
The existing spatiotemporal representations of motions 
aforementioned generally describe the temporal context with a 
fixed duration in a video sequence. The motion representation 
from a fixed number of image frames may not sufficiently 
capture the salient and discriminative properties for a large 
variety of activities. A short observation duration cannot 
describe the full cycle of an activity. In contrast, an excessively 
long observation duration may mix two or more different 
activities or reduce the significance of a unique activity in the 
spatiotemporal representation. 
Let ( )yxf t ,  be the t-th time frame image in a video sequence. 
The exponential history image (EMHI) up to time frame t is 
defined as  
 
( ) ( ) ( ) γ⋅+= x, yEx, yMx, yE t-tt 1                           (1) 
 
where γ  is the energy update rate, 10 << γ , and 
 
( ) ( )


 ∈
=
otherwise0
if1
,  
foregroundx, y f,  
x, yM tt   
 
Any background subtraction techniques, such as mixture of 
Gaussians model [20, 21], can be directly applied to the 
foreground segmentation as long as it is computationally fast. 
Since the activity recognition scheme proposed in this study 
does not rely on the parts of the extracted human body, the 
accuracy of the segmented foreground region has no significant 
impact on the EMHI spatiotemporal representation. The initial 
value of energy is set to zero at time frame 0, i.e., 0),(0 =yxE , 
for all pixels. The energy of a pixel ( )x, yEt  will be increased if 
it remains as a foreground point up to time t. It is decayed only 
when it becomes a background point. In eq. (1), ( )x, yM t  is set 
to 1 if ( )yx,pixel  at time frame t is a detected foreground point. 
Otherwise, it is set to 0 for a background point. By detecting 
each individual pixel in the video sequence as a foreground or a 
background point, the energy of the pixel can be easily updated 
according to eq. (1) without knowing its associated moving 
parts of an object. 
The exponential energy updating of foreground pixels 
assigns larger weights to the most recent image frames. The 
energy update rate γ  gives an exponential decrement of the 
energy for background pixels. Therefore, EMHI can generate 
different energy magnitudes corresponding to different moving 
speeds and durations of an activity. A foreground action will 
generate higher energy values than a background action.  
If the motion of a foreground pixel continues, the energy of 
the pixel will be exponentially accumulated. Otherwise, the 
energy of the pixel (i.e., background point) will be decreased. A 
large γ  value gives a slow decrement of the energy, and the 
long-term history of the pixel is taken into account for 
spatiotemporal representation. In contrast, a small γ  value 
results in an accelerated decrement of energy, and only the 
short-term history of the pixel is used to represent the motion. 
The exponential decrement of energy allows flexible adjustment 
of the observed period for the historical status of each pixel. The 
proposed EMHI of motions prevents the explicit choice of a 
predetermined number of image frames for the construction of 
spatiotemporal representation. It can thus be effectively used to 
represent activities that last for various durations.  
 
  
(a1) Bend (b1) (c1) 
 
  
(a2) Jack (b2) (c2) 
 
  
(a3) Jump in place (b3) (c3) 
 
  
(a4) Wave1 (single arm) (b4) (c4) 
 
  
(a5) Wave2 (two arms) (b5) (c5) 
 
  
(a6) Jump (b6) (c6) 
 
  
(a7) Run (b7) (c7) 
 
  
(a8) Walk (b8) (c8) 
 
  
(a9) Side walk (b9) (c9) 
Action video sequence MHI EMHI 
 
Figure 1. Different activities in the Weizmann dataset and corresponding 
representations: (a1)-(a9) single person activity; (b1)-(b9) MHI representation; 
(c1)-(c9) EMHI representation. 
 4
observed from the mixture signals X . The source signals are 
assumed to be mutually statistically independent. Based on this 
assumption, the ICA solution is obtained in an unsupervised 
learning process that finds a de-mixing matrix W . The matrix 
W  is used to transform the observed mixture signals X  to 
yield the independent signals, i.e. WXY = . The components 
of Y, called independent components, must be as mutually 
independent as possible. 
 
The objective of the algorithm for an ICA model is to 
maximize the statistical independence (non-Gaussianity) of the 
ICs. The non-Gaussianity of the ICs can be measured by the 
negentropy [24], which is given by 
 
)()()( yyy HHJ gauss −=                          (2) 
 
where   gaussy is a Gaussian random vector of the same 
covariance matrix as y . H is the entropy of a random vector y . 
 
The negentropy is always non-negative, and it is zero if and 
only if y  has a Gaussian distribution. It is well justified as an 
estimator of the non-Gaussianity of the ICs. Since the problem 
in using negentropy is that it is computationally very difficult, 
an approximation of negentropy is proposed as follows: 
 
2})]([)]([{)( vGEyGEyJ −≈                          (3) 
 
where v is a Gaussian variable of zero mean and unit variance. G 
is a non-quadratic function, which is generally given by 
 )2(exp)( 2yyG −−=  or ( ) acosh log1)( 1
1
y
a
yG −=  with 
21 1 ≤≤ a . The FastICA algorithm [24, 25], one of the most 
popular optimization methods in ICA, is based on a fixed-point 
iteration scheme for finding a maximum of the negentropy. 
 
For action recognition, a set of training samples is 
collected from all reference actions, where each sample is 
represented by the EMHI. Let the training samples involve K 
specific actions and each reference action include more than one 
EMHI sample. To find the basis images of multiple reference 
actions using ICA, let { }iji NjKi ,,2,1;,,2,1, KK === xX  
be a set of training samples for K reference actions, each 
reference action i with iN  samples. Training sample 
j
ix  
indicates the j-th template sample of action i, and is represented 
by its EMHI ( )r, cE ji  of size CR× .  
The two-dimensional energy image ( )r, cE ji  of training 
sample jix  is first reshaped as a one-dimensional vector. 
Denote by ( )[ ]kztt =z  the reshaped one-dimensional vector of 
the training sample jix  with ,)(
1
i
i
NNjt −+= ∑
=l
l  
,,,2,1 Ki K=  and .,,2,1 iNj K= The k-th element of tz  is 
given by 
( )r, cEkz jit =)(  
where ,)1( Crck ⋅−+= for Rr ,,2,1 K=  and Cc ,,2,1 K= , 
given that the image is of size CR× . 
The de-mixing matrix obtained from the FastICA model is 
given by .W  Therefore, the source action templates can be 
estimated by  
 
T
1
ZW
u
u
U ⋅=










=
T
M  
where 
],,,[ 21 TzzzZ K= , and  
∑
=
=
K
i
iNT
1
 
 
The data matrices Z  and U  are of size )( CRT ⋅× , and the 
de-matrix W  is of size TT × . For a total of T training samples 
of the reference actions, we can obtain up to T basis images 
[ ]Tuuu ,,, 21 K  from the ICA. Any action x  represented by the 
EMHI ( )r, cE  can be constructed by a linear combination of 
the T basis images iu ’s, i.e.,  
 
∑
=
⋅=⋅=
T
i
iib
1
uUbx  
and 
+
⋅= Uxb  
where +U  is the pseudo inverse of the basis image matrix U, 
and   [ ] 1TT −+ ⋅= UUUU . The coefficient vector 
( )Tbbb ,,, 21 K=b  gives the discriminant features for 
describing the contents of the action x . 
For an unknown testing action testx  represented by its EMHI, 
the corresponding discriminant feature 
testx
b  is calculated by 
the trained ICA basis images, i.e.,  
+
⋅= Uxbx testtest . 
The distance measure between template sample jix  and the 
unknown testx  is defined as  
j
i
j
i bbbb x ∀−=∆ ,min test . 
where jib  is the coeeficient vector of training sample 
j
ix . 
Given that the best coefficient vector *
*
j
ib  achieves the 
minimum distance, i.e., 
 
test
minarg** x
b
bbb −= ji
j
i j
i
 
 
The proposed classification then assigns the unknown testx  to 
the reference action *i . In order to rule out a novel action (i.e., 
an action irrelevant to any of the reference actions of interest), a 
 6
3.2 Effect of disturbed backgrounds for game interaction 
applications 
In this experiment, we evaluate the effects of position shifts 
and scale changes of the foreground object and the effect of 
disturbed backgrounds. We collected three actions, including 
Running-in-position, Right-hand-wave, and Left-hand-wave. 
We conducted these three actions as the basic control motions 
of a video game. Running-in-position represented the forward 
walking action in a game, and right-hand and left-hand waves 
were used to control attack and defense actions. The energy 
update rate γ  was 0.9 for fast decrease of background energy in 
these experiments due to the rapid movement speed of game 
actions. 
To evaluate the effects of position shifts, the three 
representative actions at the central location of the image scene 
were collected as the reference actions in training, as seen in 
Figures 3(a1), (a4) and (a7). The foreground objects for the 
three actions used in the ICA training process were all in the 
center of the scene. Figures 3(a1)-(a3) show the running action 
with position shifts, where (a1) presents the foreground person 
in the center of the image scene, (a2) involves a right shift of -11 
pixels (5.5% of the image width, and 9 cm physical 
displacement) with respect to the image center, and (a3) gives a 
left shift of 37 pixels (18.5% of the image width, and 30 cm 
physical displacement).  
Likewise, Figures 3(a4)-(a6) show the right-hand waving 
actions with position shifts between -13 pixels (6.5% of the 
image width, and 10 cm displacement) and +28 pixels (14% of 
the image width, and 23 cm displacement). Figures 3(a7)-(a9) 
present the left-hand waving actions with position shifts 
between -27 pixels (13.5% of the image width, and 22 cm 
displacement) and +36 pixels (18% of the image width, and 30 
cm displacement). Figure 3(b1)-(b9) shows the corresponding 
EMHIs for Figure 3(a1)-(a9), respectively. The object shifts are 
visually displayed as binary images and are presented in Figure 
3(c1)-(c9).  
Table 5 summarizes the distance measures for the nine 
combinations of three actions with three position shifts. The 
resulting distance values indicate that the proposed method can 
correctly identify each specific action under varying position 
shifts. The same action patterns consistently give small distance 
values for moderate position shifts of a foreground object. 
In order to evaluate the effect of scale changes, Figures 
4(a1)-(a5) show a foreground person running very close to the 
camera and then moving gradually away from the camera. 
Figure 4(b1)-(b5) displays the EMHI representations for 
Figures 4(a1)-(a5), respectively. The scale of the foreground 
object in Figures 4(a1)-(a5) changes from enlarged sizes of 
135% and 115% to reduced sizes of 72% and 45%, as seen in 
Figures 4(c1)-(c5). Table 6 lists the distance measures for the 
running actions with varying foreground object scales and the 
three reference actions. The results show that the proposed 
method can still present minimum distance values for the 
running actions with varying object sizes among all three 
comparative actions. Reliable recognition can be expected when 
the foreground object size changes within %35±  of the 
original training object. 
To evaluate the effect of disturbed backgrounds, the three 
reference actions were collected from a still background that 
contained no moving background objects in the scene. Figure 5 
simulates a running action with multiple persons in the 
background, where the person in the center is the main target 
object. Figures 5(a1)-(a2) involve two persons in the same scene, 
and the interference person walks with tiny movements. Figures 
5(a3)-(a4) show three persons in the same scene, and the two 
interference persons also present hand-waving actions, or chat 
with each other. Figure 5(a5) includes four persons in the same 
scene. The three disturbers are chasing each other, presenting 
large movements in the background. Figures 5(b1)-(b5) show 
the respective EMHIs for Figures 5(a1)-(a5). The target object 
creates the running action in the center of the scene, and the 
disturbers generate only weak noise in the EMHIs. Table 7 lists 
the resulting distance measures for the running action on 
different disturbed backgrounds. It shows that the minimum 
distance values are also correctly assigned to the target running 
action, indicating that the proposed method can reliably 
recognize the action on varying disturbed backgrounds. 
4 CONCLUSION 
This paper has presented ICA-based basis images for motion 
feature extraction from the Exponential Motion History Image 
(EMHI) for action recognition in a video sequence. The EMHIs 
can be instantly updated for each incoming image with 
exponential weights without explicitly specifying the duration 
of each activity. The proposed ICA feature extraction and 
classification with EMHI representation is quite immune to 
   
(a1) very close (135%) (b1) EMHI (c1) Area=10766  
   
(a2) close (115%) (b2) EMHI (c2) Area=9165  
   
(a3) normal (100%) (b3) EMHI (c3) Area=7971  
   
(a4) far (72%) (b4) EMHI (c4) Area=5737  
   
(a5) very far (45%) (b5) EMHI (c5) Area=3598  
 
Figure 4. Effect of changes in object scale: (a1)-(a5) scale changes of the 
foreground object from 135%, 115%, 100%, 72% to 45%; (b1)-(b5) 
corresponding EMHIs; (c1)-(c5) ground truth of the foreground object and the 
measured scales in pixel area. 
 
Table 6. Distance measurement for each action with scale changes. 
Test 
Action 
Figure 
4 Scale 
Reference action 
Running Right-hand 
waving 
Left-hand 
waving 
Running 
(with 
scale 
changes) 
(a1) 135% 36 45 52 
(a2) 115% 29 47 40 
(a3) 100% 24 51 38 
(a4) 72% 26 39 42 
(a5) 45% 40 55 61 
 
國科會補助計畫衍生研發成果推廣資料表
日期:2012/09/29
國科會補助計畫
計畫名稱: 自動視覺檢測技術於多晶矽太陽能板之表面瑕疵檢驗
計畫主持人: 蔡篤銘
計畫編號: 98-2221-E-155-030-MY3 學門領域: 生產系統規劃與管制
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
本計劃提出之方法可廣泛應用於具異質性紋路特徵之多晶矽太陽能晶片及太陽
能電池，進行太陽能面板表面瑕疵檢測，提升太陽能產業之瑕疵檢測技術以及
提高製程良率，使得發電效率及品質亦隨之提升。本計劃部分成果也成功發表
於國際期刊 Image and Vision Computing (IF:1.723) (Tsai et al., 2010)、
Solar Energy Materials and Solar cells (IF:4.746) (Li and Tsai, 2011) 
以及 IEEE Transactions on Industrial Informatics (IF:2.990) (Tsai and 
Luo, 2011)，並且參加國際研討會現場發表本計劃所開發之各項研究成果(Chao 
et al., 2010、Li and Tsai, 2011、Chiu and Tsai, 2012)。 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
