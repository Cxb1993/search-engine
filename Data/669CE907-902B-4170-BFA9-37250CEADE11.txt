1. 前言 
隨著電子資訊化與網際網路應用的普及與方便性，以往的專屬系統(如，IBM大型主機系統)也慢慢地
轉向使用網際網路的技術(TCP/IP)，甚至連結上網際網路。也因此讓很多機關團體(政府機關、金融業、
公司行號、電子商務)的電腦主機或終端使用者機器，不斷遭受到駭客的入侵，這是因為 TCP/IP技術
的開放性帶來了便利，而其不安全性也帶來了資訊安全的隱憂。 
資訊安全正是目前最被重視的議題之一，所牽涉的範圍非常廣泛，絕大部分關係到管理與政策層次上
的問題(BS7799)，網路安全是資訊安全中很重要的一環，本計畫則希望藉由資訊科技的方式來加強網
路安全的議題。隨著網際網路科技運用的普及與電腦網路的方便性，幾乎每一台電腦都在網路上(網際
網路或區域網路)，更是不可避免地要與其他電腦進行資訊溝通，而各級單位、電子商務、甚至個人都
會架設網站對外(網際網路)公告事項、廣告、營業、提供服務...等等，暴露於網際網路中，極易成為
駭客攻擊的對象。一般網路安全防護的方法是在網際網路的出入口架設網路防火牆系統，以防堵外界
惡意或無害的攻擊。但是目前已證明防火牆無法完全阻擋駭客的攻擊，因為防火牆仍必須開放某些
TCPIP埠號(ports)以提供服務，駭客即可利用這些開放的埠號進行入侵的行為。此外，傳統上網路安
全系統都是以防護外來入侵為主要工作，對於網路內部(區域網路)資料的安全性則疏於防範，在區域
網路內重要的主機要防範重要或機密資料被竊取，不管竊取者來自網路內或網路外。因此，在網路或
主機上架設入侵偵測系統(Intrusion Detection System; IDS)或入侵防護系統(Intrusion Protection System; 
IPS)已是當務之急。 
駭客入侵網路或主機系統在目前的網路環境(包含網際網路、區域網路與無線網路)已是非常猖
獗，到了無處不”駭”的地步，因此入侵偵測系統的研製相對地更形重要。但是，目前商業化的入侵偵
測系統或入侵預防系統都是類似防毒系統採用特徵資料庫比對的方式來進行偵測網路封包， 如此對
於已知的入侵行為或特徵是有用的，但是對於新的、未知的或未納入特徵資料庫的入侵行為則毫無作
用。因此，使用者除了定期更新特徵資料庫外，如何讓系統能夠自行偵測出新的入侵行為就更加重要
了。本計畫可提供計畫研究所得的理論與技術，以提升網路使用的安全性，並減少被入侵的危險。 
 
 
2. 研究目的 
本研究計畫的目的為，研製一個結合資料探勘與基因演算法的理論與技術，以建構主動式、高偵測率、
低錯誤率並可自動分析找出新入侵行為且自動更新入侵規則(Rules)與特徵資料(Feature Data)的網路入
侵偵測系統。藉由理論建立與分析、準確性分析、偵測率分析與系統效能分析等，架構出本研究計畫
的立論基礎與成果，進而對入侵偵測相關的資訊安全理論與實務做出研究的貢獻。 
 
 
3. 相關研究 
之前發表過與基因-叢集演算法相關的論文，大多以 K-means 演算法當作第一回合的前置處理[8]，先
以 K-means演算法做出初步的叢集分類或是過濾掉一些雜訊資料，第二步再以基因演算法來加強叢集
分類的準確度，達到最佳化的目的。論文[9]，使用基因-叢集演算法來執行網路入侵偵測系統，是先
以 K-means演算法來過濾掉一些雜訊資料，再以基因演算法執行叢集分類的工作。它在建構基因演算
法的步驟上使用很繁複的數學架構與演算式，需要耗費系統大量的計算時間，如果資料量大的話，系
統執行的效率肯定不佳；另一方面如果資料量不夠多，則不容易測出系統真正的準確性與效率。 
 資料挖掘技術已有很多相關研究應用於入侵偵測系統，大致上可分為用於網路活動偵測資料挖掘
技術[3][4][5]，與主機系統稽核、記錄資料挖掘技術[1][2]。因為這二個資料的型態相差很多，所以所
使用的方法也不大相同，不過基本的概念是相同的，都是從大量的系統記錄資料中建構一個入侵偵測
的模型，來挖掘出特定的特徵值，以偵測系統是否有被入侵或攻擊。進而希望做到能夠偵測出新型態
 入侵、攻擊模擬 
 系統測試 
 完成系統建置 
 
                  DMGA-IDS I
Data preprocessing
KDD
Data set
Feature database
Feature data
DAPRA
data set
Snort
Capture data
Clustering event 
data
Association rule 
discovery
Event data
New feature data ?
Yes
System audit data
Sniffer
Capture data
Real time 
IDS I
Genetic Algorithm 
preprocessing
 
圖一 研究方法 
 
Real time IDS
Capture Network 
Packets
Internet
Network
Database
Intrusion
behavior No
Alert to manager & 
log the eventYes
Tracing packet data 
Not sure
DMGA-IDS
Feature data
Intranet
Network
Display to 
monitor
 
圖二 資料流程圖 
 
    圖二為系統的資料流程圖，即時入侵偵測系統利用 DMGA-IDS的特徵資料庫規則檢測網路行為，
如為入侵行為則發出警訊給管理者；如為正常行為，則不予理會；如為不確定的行為，則會加以追蹤
檢查，直到確認其為入侵行為或正常行為為止。     
    在衡量一個入侵偵測系統的準確度上，通常以表一[3]的方式來表示，即要計算系統的 FNR(False 
Negative Rate)、FPR(False Positive Rate)與 TPR(True Positive Rate)。 
z FNR(False Negative Rate)：入侵或攻擊事件卻通報為正常事件的比率(FN / (TP+FN)) 
z FPR(False Positive Rate)：正常事件卻通報為入侵或攻擊事件的比率(FP / (TN+FP)) 
 
 
4.3 系統架構 
圖三為系統架構圖，本系統架構藉由防火牆區分為三個部分，涵蓋 Internet、DMZ、Intranet。此區分
會因防火牆設置數量的不同而不同。各個主要組件的說明如下： 
z 網路偵測器：擷取該網路段的網路封包，並將資料送至網路偵測資料庫；同時即時偵測該網路封
包的行為，如偵測出是入侵或是攻擊行為，則發出警訊並送至管理主控台，通知管理者。 
z 主機偵測器：擷取主機的網路封包、程序執行與事件記錄，並將資料送至主機偵測資料庫；同時
即時偵測該網路封包、程序執行與事件記錄的行為，如偵測出是入侵或是攻擊行為，則發出警訊
並送至管理主控台，通知管理者。 
z 資料分析主機(DMGA-IDS)：執行 DMGA演算法，分析由偵測器送至資料庫之資料，如發現新的
入侵行為的特徵資料，則產生新的入侵特徵資料，儲存至特徵資料庫，提供網路偵測器與主機偵
測器使用。 
z 管理主控台：接收網路偵測器與主機偵測器送來的警訊資料，發出警訊，通知管理者，並記錄該
筆警訊資料。且提供圖形介面，供管理者進行資料分析與查詢及管理的工作。 
z 資料庫：記錄、儲存系統所收集與產生的資料，分為網路偵測資料庫：由 sniffer工具蒐集網路封
包資料；主機偵測資料庫：包含 sniffer工具針對該主機所蒐集的網路封包資料，與主機本身的系
統稽核資料；與特徵資料庫：存放入侵行為特徵資料，由 DMGA-IDS產生，提供即時入侵系統
使用。 
 
Internet
Network
防火牆
資料庫:
網路偵測資料
主機偵測資料
Feature資料
網路偵
測器 伺服器主機
主機偵測器
DMGA-IDS
伺服器主機
主機偵測器
Web Server
伺服器主機
主機偵測器
網路偵
測器
管理主控台
網路偵
測器
事件報告
警訊提醒
DMZ
Internet
Intranet
Alarm
Alarm
Alarm
Alarm
Alarm
Captured 
data
Captured 
data
Captured 
data
Captured 
data
Captured 
data
Captured 
data
New feature data
feature data
 
圖三 系統架構圖 
 
    本計劃將入侵偵測系統分為二大部分： 
z 即時入侵偵測系統：利用已知入侵行為資料庫與入侵資料分析系統所加入之入侵行為特徵規則，
可偵測出即時的入侵行為(包含網路入侵偵測系統與主機入侵偵測系統)，並對系統管理者提出警
訊。 
z 入侵資料分析系統(DMGA-IDS)：利用 Data Mining與 Genetic Algorithm的理論與技術對所蒐集的
Rate，NR)來決定各個叢集在今過訓練階段後被歸類為正常行為叢集或入侵行為叢集。如果在某個叢
集中的 NR值大於所設定的門檻值，則我們歸類這個叢集為正常行為叢集；否則我們將歸類這個叢集
為入侵行為叢集。 
GA-Clustering: NR=0.7, M=200
0%
10%
20%
30%
40%
50%
60%
70%
80%
90%
100%
2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30
cluster number(K)
rate
FNR(%)
FPR(%)
TPR(%)
DR(%)
GA-Clustering: NR=0.8, M=200
0%
10%
20%
30%
40%
50%
60%
70%
80%
90%
100%
2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30
cluster number(K)
rate
FNR(%)
FPR(%)
TPR(%)
DR(%)
GA-Clustering: NR=0.9, M=200
0%
10%
20%
30%
40%
50%
60%
70%
80%
90%
100%
2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30
cluster number(K)
rate
FNR(%)
FPR(%)
TPR(%)
DR(%)
GA-Clustering: NR=0.95, M=200
0%
10%
20%
30%
40%
50%
60%
70%
80%
90%
100%
2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30
cluster number(K)
rate
FNR(%)
FPR(%)
TPR(%)
DR(%)
 
圖六： FNR、FPR、TPR與DR 的實驗結果圖 
 
表三：當取Max(DR)時相對FNR值表 
NR K Max(DR) FNR 
0.7 30 95.82% 8.28% 
0.8 29 96.45% 3.82% 
0.9 30 95.91% 0 
0.95 25 94.82% 8.92% 
 
表四：當取Min(FNR)時相對DR值表 
NR K DR Min(FNR)
0.7 25 94.91% 0 
0.8 25 95.36% 0 
0.9 28 94.82% 0 
0.95 16 94.73% 0 
 
圖六示實驗的結果，分別比較當 NR=0.7、0.8、0.9 與 0.95 時，K=2 到 30 的 DR、FNR、FPR 與
TPR的結果。由圖六與表三、表四可以得到以下的結果： 
z 我們所使用的演算法的最佳解，可達到 DR=96.45%、FNR=3.82%、FPR=84.62%，這是在當
NR=0.8與 K=29時。 
z 當 DR值提高時，FNR會降低，但是相對的 FPR會增加。 
z 當我們不取Max(DR)值，而是取Min(FNR)值時，可獲得最低的 FNR，而對 DR的影響並不大，
也就是 DR值仍是很高。 
z K 值不可太低，因 K 值太低時得不到較佳的叢集分類，容易將正常行為與入侵行為紀錄包含
在相同的叢集中。 
