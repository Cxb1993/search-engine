  
行政院國家科學委員會專題研究計畫成果報告 
計畫名稱：電能處理系統之精緻化與加速壽命測試研究- 
子計畫二：太陽能直流供電系統-最大功率追蹤器之精緻化研究 
                  計畫編號：99-2221-E-150-077- 
 執行期限：99 年 08 月 01 日 至  100 年 07 月 31 日 
    主持人：陳裕愷  教授   國立虎尾科技大學飛機系航電組 
                       計畫參與人員：王韋勝、呂育政 
 
ㄧ、摘要 
    在本計畫中，為實作一部雙模組最大功率追
蹤器，藉由最大功率追蹤器使太陽光電池輸出最
大功率，提高太陽光電板的發電效益，並且與雙
向換流器結合，完成直流供電系統之基本架構。
此雙模組最大功率追蹤器可獨立或並聯運作，並
依照輸入電壓的高低可操作於升壓或降壓模式。
另外此電路擁有線上拔插功能，提高最大功率追
蹤 器 的 使 用 性 。 本 系 統 採 用 微 處 理 器
TMS320LF2406A來實現電路保護功能，並利用擾
動觀察法來實現最大功率追蹤控制。本最大功率
追蹤器經由測試轉換效率最高為99 %，追蹤準確
度最高可達98%，驗證最大功率追蹤器之可行性 
關鍵字︰擾動觀察法、雙模組 
 
Abstract- In this project, a set of multiple maximum 
power point trackers to track maximum power output 
and to increase power generation efficiency of solar 
panels were designed and implemented, and they are 
combined with a bi-directional inverter to form a DC 
microgrid distribution system. The multiple 
maximum power point trackers can be operated 
independently or in parallel, and can be operated in 
either boost or buck mode according to input voltage 
level. In addition, the trackers allow on-line plug and 
unplug, increasing application feasibility. The system 
uses a microprocessor of TMS320LF2406A to fulfill 
protection functions and perturb and observe 
algorithm to achieve maximum power point tracking. 
Finally, by combining the bi-directional inverter and 
the maximum power point trackers, and under load 
change and input power variation, hardware 
measurements were conducted. Measured results 
have shown that power conversion efficiency of the 
maximum power point trackers can reach 99%, and 
the overall system when combining the bi-directional 
inverter can achieve the highest efficiency of 96%. 
Keywords: P&O, multiple MPPT 
二、計畫緣由與目的 
 太陽光電池是將光能轉換成電能的一種裝
置，它是一種半導體元件。當太陽照射在太陽光
電池上，電子透過游離至 N-型半導體，而電洞則
至另一方向的 P-型半導體，整個程序稱為光伏效
應(photo voltaic effect)。目前市面上大多採用矽作
為太陽光電池材料，其轉換效率大約為 18~30%。
即使以目前最新技術，使用聚光型太陽能電池，
其效率也只有 40%左右。因為目前還無法發展出
高效率轉換的太陽光電池，所以如何利用轉換電
路將太陽光電池發揮出最大效用顯得相當重要。 
 太陽能光電板輸出的電能為直流電，所以依
據不同特性負載，就必須做不同的電能轉換，例
如:若負載為交流 AC 型式，則必須經過直流/交流
轉換器才能將能量供給負載或併入市電。若負載
為直流 DC 型式，則要經過直流/直流轉換器才能
供給負載額定之電壓。因為太陽光電板特性影
響，其輸出電壓與輸出電流並非線性關係，導致
電壓電流相乘的功率亦為非線性。由於輸出功率
為非線性，因此輸出的功率並不一定是最大功率
點，若直接將太陽光電板與直流負載連接，則供
給直流負載的功率多半並非最大功率，如此將造
成能量浪費。  
 綜合上述原因，為了有效利用太陽光電板的
發電能力，通常在太陽光電池輸出後端會接上最
大功率追蹤轉換器，來提高太陽光電池的發電效
益。目前，最大功率點追蹤的控制方法很多，例
如:擾動觀察法、增量電導法、三點權位法、直線
近似法..等，每一種方法都有其優缺點。  
三、研究方法 
3-1 太陽能光電系統架設方式 
目前太陽能發電系統建置數目逐年增加，其
供電系統架設方式主要可分為二類:第一類型為獨
立型系統。第二類型為與 AC 交流電力網連接的市
電併聯型系統。以下就針對上述二種系統做說明
與比較。 
(1) 獨立型(Stand Alone) 
獨立型太陽能供電 系統主要應用於高山、離
島、基地台..等市電不容易連接的地方，其系統架
構圖如圖 1 所示，此獨立型系統不與市電相連接，
所以只能供應電力給獨立負載。白天時除了供應
負載所需的電力之外，也同時對蓄電池充電。夜
  
流。其外部電路開路的狀況下，因有載子(Carrier)
流入關係，會使N層帶負電，且P層帶正電。而在
P-N兩端之費米能階(Fermi Level)，則會產生電位
差VOC，此VOC為太陽光照射時之開路電壓。如圖5
所示，為太陽能光電板內部等效電路圖。 
 
 
圖 5、太陽能光電板內部等效電路 
  當外部負載變為短路時，就會有與入射光量
成正比之短路電流Isc通過，太陽光電池相當於具有
與光面平行之極薄P-N接面的大面積等效二極
體。因此，可以假設太陽光電池有一個二極體，
與太陽光電流源所併聯之等效電路。 
其參數代表如下: 
Isc : 太陽能光電板所產生之短路電流 
Rj : P-N接面的非線性阻抗 
Rsh : 材料之等效並聯電阻 
Rs : 材料之等效串聯電阻 
Vpv : 太陽能光電板之輸出電壓 
Ipv : 太陽能光電板之輸出電流 
Ro : 外部負載 
 由圖5等效電路和P-N接面半導體特性我們得
知，太陽能光電板的輸出電流表示式用下列關係
式來表示: 
 
                                                        
(1) 
 
其參數代表如下: 
I：太陽能電池輸出電流  
Isc：太陽能電池所產生的短路電流 
Isat：太陽能電池逆向飽和電流  
np：太陽能電池並聯個數  
ns：太陽能電池串聯個數  
q：電子帶電量1.6×10-19 C  
K：波茲曼常數1.38×10-23 J/K  
A：太陽能電池理想因素  
 在(1)式中的Isat逆向飽電流及Isc短路電流和其
數學關係式可表示如下: 
                                                        
(2) 
 
                                                         
(3) 
 
其中: 
T：太陽能電池表面溫度k(絕對溫度)  
Tr：太陽能電池參考溫度k(絕對溫度)  
Iscr：太陽能電池在參考溫度下和1 KW/m2日照下的
短路電流  
Isatr：太陽能電池在參考溫度下和1 KW/m2日照下
的逆向飽和電流  
Ki：太陽能電池短路電流的溫度係數mA/k  
Si：太陽的日照強度KW/m2  
Egap：材料跨越能階所需能量。矽：Egap≒1.1eV  
 由上式可看出逆向飽和電流和電流Isat也受溫
度參數影響;而太陽能光電板所產生的電流，也跟
著日照強度和溫度變化而改變。其次太陽能電池
所產生的電流Isc也隨著日照強度和大氣溫度的變
化而改變。從以上的數學關係式可以清楚的了解
太陽光電池之物理特性，因此可利用(4)式計算輸
出功率P，其表示如下: 
]1)[exp( −×−=×=
sn
V
kTA
qVsatIpnVscIpnIVP
     (4) 
3-3 最大功率追蹤法 
太陽光電池的電壓與電流為非線性關係，而
且在不同的工作環境下，不同的環境溫度、日照
強度，有各自獨特的工作特性曲線，每一條曲線
皆有一個最大功率點(Pmax)。為了使太陽光電池能
充分運用，所以需要一種控制法則使太陽光電池
隨時隨地操作在最大功率點，此法則即是最大功
率追蹤法。 
 
圖 6、太陽能光電板輸出功率 Ppv與輸出電壓 Vpv之特性曲線 
太陽能光電板輸出功率 Ppv與輸出電壓 Vpv之
特性曲線如圖 6 所示。由此圖可以明顯看出太陽
光電板的輸出特性，當在特定的日照強度下，太
陽光電板工作電壓低於最大功率點之電壓(Vmpp)
時(A 區)，此時當太陽光電板輸出功率上升，其工
作電壓跟著上升。同理，當工作電壓高於最大功
率點之電壓時(B 區)，太陽能板的輸出功率隨著工
作電壓上升而變小。所以如果沒有最大功率追蹤
控制法則，要使太陽光電板操作在最大功率點是
十分困難。因此本章節將介紹幾種最大功率追蹤
⎥⎦
⎤⎢⎣
⎡ −⎟⎟⎠
⎞
⎜⎜⎝
⎛−= 1exp
KATn
qVInInI
s
satpscp
( ) iriscrsc STTKII ×⎥⎦
⎤⎢⎣
⎡ −+=
1000
⎥⎦
⎤⎢⎣
⎡
⎟⎟⎠
⎞
⎜⎜⎝
⎛ −⎥⎦
⎤⎢⎣
⎡=
TTKA
qE
T
TII
r
gap
r
rrsat
11exp
3
  
首先開關M1導通，開關M2導通，二極體D1因
逆偏而截止，如圖8(a)所示，此時電感LM開始儲存
能量，其電感兩端跨壓為Vpv，電感電流變化量
+Δ LMI 為: 
on
M
pv
LM tL
V
I =Δ +                    (5) 
其中ton = DTs，D為責任比率，Ts為切換週期。 
 接著M1持續導通，二極體D1因逆偏而截止，
開關M2截止時，電感電流連續使得二極體D2導
通，如圖8(b)所示，此時電感LM經由二極體將先前
儲存的能量釋放置輸出端電容Co，此時VL跨壓為
(Vpv -Vo)，使得電感電流逐漸下降，此時電感電流
變化量 −Δ LMI 為: 
off
M
OPV
LM tL
VVI −=Δ −               (6)                                            
其中toff  = (1-D)Ts，D為責任比率，Ts為切換
週期。 
 當穩態時，電感電流變化量相等，即
−+ Δ−=Δ LMLM II 。再以伏特一秒平衡法則來推導
出輸入電壓與輸出電壓的轉換比率，可得出輸入
電壓與輸出電壓之關係為: 
DV
V
PV
O
−= 1
1                    (7) 
(2)降壓型轉換器 
圖9所示為升降壓轉換器操作在降壓且連續
導通模式(CCM)時的等效電路圖，以下簡單說明其
動作原理。 
(a) 降壓型轉換器M1開關導通時之電路動作示意圖 
C1
D2
COVPV
LM
VO
C2
D1 M2
M1
D3
(b) 降壓型轉換器M1開關截止時之電路動作示意圖 
圖9、降壓型轉換器操作於CCM模式時之等效電路圖 
 
首先開關M1導通，二極體D1因逆偏而截止，
開關M2截止，如圖9(a)所示，此時電感LM開始儲
存能量，其電感兩端跨壓為(VPV - VO)，此時電感
電流變化量 +Δ LMI 為: 
on
M
OPV
LM tL
VV
I
−=Δ +                         (8) 
  
其中ton = DTS，D為責任比率，TS為切換週期。 
接著開關M1截止時，開關M2還是截止狀態，此時
電感電流連續使得D1導通，如圖9(b)所示，此時電
感將儲存的能量經由二極體D1、D2釋放至輸出電
容CO，此時電感兩端跨壓為-VO，使得電感電流逐
漸下降，此時電感電流變化量 −Δ LMI 為: 
off
M
o
LM tL
VI −=Δ −                   (9) 
其中toff  = (1-D)Ts，D為責任比率，Ts為切換
週期。 
 當穩態時，電感電流變化量相等，即
−+ Δ−=Δ LMLM II 。再以伏特一秒平衡法則來推導
出輸入電壓與輸出電壓的轉換比率，可得出輸入
電壓與輸出電壓之關係為: 
D
V
V
PV
O =                         (10)  
3-5 模擬太陽能光電板電路測試 
本節將介紹利用電源供應器輸出串聯電阻棒
的方式來模擬太陽能光電板輸出電路，如圖10所
示。 
 
 
圖 10、模擬太陽能光電板最大功率追蹤測試圖 
 我們根據最大功率轉移定理可以得知，當最
大功率追蹤器工作在最大功率點時，則電阻Rm所
消耗的功率與最大功率點的功率會相等，此時電
阻Rm上的跨壓Vm會等於最大功率追蹤器之最大功
率點的工作電壓Vin。即
2
ps
inm
V
VV == ，又因為
IVP ×= 所以最大功率點功率計算方式如(11)式: 
m
PS
m
m
iimpp R
V
R
VIVP
4
22
==×=          (11) 
 由(11)式可得知不同的輸入電壓與電阻Rm，
則最大功率點的功率也跟著改變。因此我們利用
(11)式在固定輸入電壓Vps來調整輸入串聯電阻Rm
做不同最大功率點的追蹤。 
  
 
(a) 
(b) 
圖 12、VOC=600 V 、PPV=797.7 W 之太陽光電板實測 
本計畫所研製之最大功率追蹤器為雙模組型
式，當其中一組工作中時突然另一組加入工作，
或是兩組同時工作時突然其中一組脫離工作，因
為在最大功率追蹤器在工作過程中使用者可能會
隨時加入另一組輸入電壓插入或是將其中一組輸
入電壓拔除，若沒有此項功能時最大功率追蹤器
可能會因為使用者操作不當而造成電路誤動作，
影響到整體系統的可靠度，基於此考量因此加入
這項功能，讓最大功率追蹤器使用起來更簡單、
更人性化，提高系統之整體價值。 
 本次線上拔插功能驗證是連接太陽光電板做
測試，並使用不同組輸入電源。如圖13所示為拔
插測式波形圖。一開始第二台先插上輸入電源，
當偵測到輸入電壓VOC2大於150 V時則開始做最大
功率追蹤功能，在時間t1時開啟第一台輸入電源，
此時偵測到第一台輸入電壓VOC1大於150 V則開始
做最大功率追蹤功能，在時間t1~t2之間兩台同時做
最大功率追蹤，時間等於t2時將第二台電源關閉，
此時第一台仍然繼續做最大功率追蹤不受第二台
脫離影響，當時間等於t3時又將第二台電源打開，
此時又偵測到輸入電壓大於150 V則開始做最大
功率追蹤，原先在工作的第一台不受第二台突然
加入所影響。接著當時間在t3~t4之間時兩台又同時
工作，最後在時間等於t4時將第一台電源關閉，這
時第二台依然持續做最大功率追蹤也不受第一台
脫離所影響。本次測試為兩台各接不同的輸入電
源做驗證。 
圖13、線上拔插功能波形圖 
四、計畫成果與自評 
    本計畫使用擾動觀察法準確的追蹤到最大功
率點，增加太陽能光電系統之發電效益。雖然追
蹤系統在某些狀態下仍有些許的誤差，但本計畫
利用多組追蹤證明多組模組機制能有效改善系統
遇遮蔽物的缺失，即使在照度劇烈變化下也能得
到同樣的結果，最後也驗證此方法之可行性。本
計畫為了增加系統多模組的動作與維修時，所造
成問題，本計畫加入線上拔插功能亦已改善。本
年度已將相關研究成果投稿於國際研討會論文及
國內研討會論文各 1 篇，並已申請中華民國及美
國發明專利各一件。 
 2
安排 6 場專題演講，邀請國際學者演說研究成果及相關技術，使會議增加許多豐富內容，
並且可吸取國際學者寶貴的經驗。專題演講後緊接著進行論文發表，會議的論文發表方
式分成兩種：「Oral」與「Poster」。於 4 月 17 日上午發表論文：”TRIAC Dimming Electronic 
Ballast for Compact Fluorescent Lamps＂，以「Poster」形式發表。 
二、與會心得 
本次研討會提供許多不同的學術單位與研究機構研究成果發表及技術交流的機
會，而且涵蓋議題多、投稿之論文多，讓各領域專家學者能互相討論與深入的論文發表。
本次出席研討會除了吸取與自身專長相關的專家學者寶貴的經驗，也接觸其他領域的研
究成果，收穫頗多。 
三、考察參觀活動(無是項活動者略) 
四、建議 
無 
五、攜回資料名稱及內容 
本研討會註冊相關資料與論文集(紙本)、論文集光碟。 
六、其他 
 
 
 
 
 
 
 
 
 
 
 
 
Design and Implementation of Simple AC Chopper 
with one PWM Driving Signal 
Yu-Kai Chen, and Yu-Cheng Lu 
Department of Aeronautical Engineering, National Formosa University 
Yunlin, Taiwan, R.O.C., Email：ykchen@nfu.edu.tw 
 
Abstract-This paper presents the design and implementation of a 
simple AC chopper with one driving signal for induction motor 
system. The new driving circuit of the proposed AC chopper is 
designed and implemented by Lenz’s law with one PWM signal and 
two transformers. Thus, the current of the motor is operated in 
continuous mode. The switching spike, switching loss and cost of the 
proposed AC chopper are better than the conventional PWM AC 
chopper. Finally, the measured results show the flexibility and 
accuracy of the proposed method with a 70W induction motor. 
Keywords: Induction Motor, AC Chopper, PWM. 
 
I. 前言 
现今用以单向感应马达上之应用是很多的，如：电风
扇、电冰箱、洗衣机、空调机、吊扇等，在此本文在此的
实验是以控制电风扇为例子，电风扇约在公元1880年由美
国发明，已经有130 年的历史，并没有遭到淘汰，且成为
现今每户家庭都以必备的电器产品，而每年在商场上还是
占有不错的利润。因此本文希望能够设计可以依据个人喜
爱来调整电风扇的风速，改善传统电风扇用以不同绕组来
做的三种调速或者是用串并联电容方式来调速。本文提出
一单组PWM交流截波器驱动电路其适用于不同功率之马
达。风扇之功能将可以做到无段调速，此将可以增加使用
者之舒适性。 
       截波器应用电路有许多，以Full-Bridge[1]-[3]、Buck –
Boost[4]最多，成本上需要两组开关之驱动电路，而且会
有dead time 的产生，必须加装上缓冲器。也有用以补偿变
压器之方式设计[5]，虽然电压稳定性好，却有以上述所提
缺点。若使用双向开关方式来做成截波器[6]-[8]，虽然没有
dead time问题，但在驱动电路上却需要使用到四组，使成
本不符合实际效益与电路复杂性提高。因此本文之设计概
念是用以单一主动开关组件来控制电路，开关驱动电路上
只需要使用一组，没有Dead Time 问题，马达连续导通驱
动方式是类似自激方式导通，无须再使用一组驱动电路来
控制。因此本文所提出的单组PWM交流截波器能够电路
简单化之外，同时能够降低成本，以及高效率目的。 
II. 系统架构与设计理论 
一、 系统架构 
本文单组 PWM 交流截波器应用于感应马达，是以
PWM 来控制马达转速，如图一所示。一开始 RENESAS
读取控制端电压值来调整 PWM 宽度提供给单组 PWM 交
流截波器，单组 PMW 交流截波器会根据 PWM 宽度大小
来改变供应给马达的输入电压有效值，进而实现马达调
速，电路图如图一所示。 
图一、单组 PWM交流截波器 
二、 双向开关 
        本文之所要使用双向开关电路，是由于输入的电压为
交流会有正负半周的情形，因此需要有双方向的路径。一
般常用的主动开关组件如 BJT、IGBT、SCR 都是单一方
向，虽然 MOSFET、TRAIC 是双方向性，但 MOSFET 逆
方向的电流是利用本体二极管(Body Diode)所构成，此路
径只能导通无法控制关闭。而 TRAIC 无法工作在高频，
因为导通和截止需要时间，所以这期间会有 Dead Time 问
题。 
 
三、 电路控制原理 
        以下是本文针对单组 PWM 交流截波器的电路原理探
讨，在纯电阻性分析上可以划分成 4 个操作模式，图二为
各个阶段的操作波形图。 
vDS
vGS
vCE3
vCE2
vOUT
vIN
 
图二、单组 PWM交流截波器之操作波形图 
五、 解决相位差造成影响 
        利用软件在相位差这段时间内 PWM 持续低准位或高
准位把 MOSFET 保持在截止或导通状态如图九所示，让
这段时间内不会让 BJT误导通而造成短路。 
         但是实际上输入的电压与电流波型在相位差位时，不
管 PWM 保持在导通或截止波形并不会如此之理想。在图
(a)是输入电流会有很大的突波，而图(b)则是电压会有很大
的突波。 
 
                          (a)                                            (b) 
      图九、为输入电压之波形(a)PWM保持在高准 
                 位波形，(b)PWM保持在低准位波形。 
六、 变压器匝数比设计 
        本设计两颗变压器视为对称型的，因此只需设计其中
一颗的数值即可。在此以 L2-1为 N1而 L2-2为 N2。 
        当 MOSFET 在 OFF 时，BJT 必须承受马达所流经电
流，因此可以推断 iO=iC。而反电动势产生之电流为推动
BJT导通之 iB，由以上之关系可以得到公式(1)。 
N
N
i
i
B
C
1
2
=
                                                                (1) 
        因为是把 BJT 当作开关使用，固只功做在饱和区以及
截止区，若不慎在线性区，则 BJT所消耗功率会变很大，
以至于 BJT热上升很快，会让 BJT承受耐压耐流下降之后
烧毁。因此必须使 BJT 确实能够在饱和区域。公式(2)为
BJT在饱和区内之条件。 
ii SatC )(B >β                                                         (2) 
公式(1)经由整理之后可得到公式(3)。 
N
Nii B
1
2
C =
                                                              (3) 
        把公式(3)带入公式(2)可以得到公式(4)，可得到本文
所要之公式。 
N
N
1
2>β
                                                                  (4) 
七、 风扇调速各系统 
        图十二是经过统整理评估目前市面上最常用的交
流截波器与本文电路的比较表。 
 
表一、不同电路架构之特性比较表(O=优、△=中、X=劣) 
 电容式 不同绕组 变频器 两组
PWM
驱动 
单组
PWM 
驱动 
成本 O O X X △ 
体积 O O X △ △ 
效率 △ O X X △ 
寿命 X O X △ △ 
EMI O O X X △ 
复杂性 △ O X X △ 
控制 
机制 
电容 
串并联 
改变绕组 两组
PWM 
两组
PWM 
一组
PWM 
特性 利用电
容分压 
使用机械开关
切换马达绕线
连接方式 
变频、
变压 
高频 
变压 
高频 
变压 
转速 
控制 
2至 
三段 
2至三段 可多
段、自
然风 
可多
段、自
然风 
可多
段、自
然风 
马达适
用范围 
固定 
马达 
固定 
马达 
适用 适用 适用 
 
III. 实验结果 
   本文使用东铭电机的单相感应马达电风扇，最高转速
为 1420RPM 与消耗功率为 70W。本实验将会以一个高转
速(1300RPM)以和低转速(230RPM)下作测量。 
        实验一的测试条件为 PWM 在 Duty=90%，转速为
1300RPM，如图十所示。(a)为 Q1承受电压 VDS，由波形
可知有效降低高频噪声所产生电压突波。(b)为 Q2承受电
压 VCE2，由波形可知在正半周时 BJT 完全导通。(c)为马
达上电流，由此图可知马达上的电流是连续，同时也证明
了在 MOSFET OFF，马达能够透过 BJT 所建立的路径达
到电流连续导通。 
 
(a)、(50V/div,2ms/div) 
 
(b)、(50V/div,2ms/div) 
种类项目
國科會補助計畫衍生研發成果推廣資料表
日期:2011/09/19
國科會補助計畫
計畫名稱: 太陽能直流供電系統-最大功率追蹤器之精緻化研究
計畫主持人: 陳裕愷
計畫編號: 99-2221-E-150-077- 學門領域: 電力電子
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
積極參予廠商的合作案,希望能增加產學合作之機會與相關實務經驗 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
