2 
 
三、研究計畫之背景及目的 
In recent years, many researchers have shown that 3D ICs can provide the 
powerful enhancement of system integration. However, the heat removal is a great 
challenge in 3D IC design due to the high power density and the low thermal 
conductivities of inter-layer dielectrics. Moreover, the high temperature induces 
serious impacts on the timing, power and reliability of circuit design [1]. Therefore, it 
is necessary to reduce the power consumption of circuits for mitigating the thermal 
problem of circuit.  
Among the existing power reduction techniques, the multiple supply voltage 
(MSV) [2-5] is an effective technique to reduce dynamic power and leakage power. 
Intuitively, any MSV techniques of 2D ICs can be extended to 3D ICs and the voltage 
scaling can be performed tier by tier. However, without simultaneously considering 
every tier in voltage assignment procedure might lead the power consumption 
distribution of each layer to be off-balance and cause the thermal problem. 
In this work, based on [6], a grid-based post-placement MSV method will be 
developed for reducing the 3D IC power consumption and will be extended to explore 
more possibilities. This developed technique will simultaneously consider the level 
shifter (LS) budget and the thermal effect. Compared with previous works ignoring 
the LS issue and using the thermal-unrelated models, the proposed approach is more 
flexible and practical.  
The report is organized as follows. First, the proposed power optimization 
methodology is presented in section、四. After that, experimental results are given in 
section、五. Finally, some conclusions are drawn in section、六. 
四、研究方法 
Fig. 1. Flowchart of the proposed power optimization for 3D ICs 
4 
 
A. 3D Electro-Thermal Analysis 
Generally, the dynamic power is independent of temperature but the leakage 
power is significantly affected by temperature. Based on the empirical 
model [7], the gate leakage current Igate is related to the oxide thickness, and 
the subthreshold current Isub is related to the channel length and temperature. 
Fixing the oxide thickness and the channel length, the subthreshold current 
model of gate can be built by utilizing the least square fitting method to the 
estimated results of HSPICE under the 90nm technology as follow. 
                            (1) 
                         (2) 
Here, s0 and s1 are fitting constants, and T is the operating temperature of 
gate/cell. 
Since the fitting constants and the supply voltage are dependent, a look-up 
table is set up to store them for different supply voltages, VDDL and VDDH. 
With (1) and (2), the gate tunneling leakage power and the subthreshold 
leakage power are 
                             (3) 
                                   (4) 
The 3D Electro-Thermal Analysis is performed with an electro-thermal 
iterative updating loop which is built by integrating (3)-(4), the 3D IC 
statistically thermal simulator [6] and the 3D IC analytical thermal 
simulator [8]. 
B. Thermal Aware Static Timing Analysis 
The thermal-aware static timing analysis (STA) is a conventional 
block-based STA. Each gate delay is thermal dependent and is built as a 
canonical first-order form by applying the least square fitting method to fit 
the Monte Carlo results of HSPICE under 90nm technology. The general 
delay expression form of a specific gate is 
                                              (5) 
Here, a0-a4 are VDD dependent fitting constants, and a look-up table is 
constructed to store these coefficients for VDDH and VDDL. CL is the load 
capacitance. 
C. Initial Voltage Assignment 
Given a timing satisfied circuit with the initial supply voltage being VDDH, 
an Initial Voltage Assignment procedure is performed to save the most 
power without considering the timing constraints. All gates are assigned to 
operate at VDDL’s, and this step might cause the timing violation. After the 
assignment, a Thermal Aware STA step is executed to calculate the slack of 
6 
 
2. Firstly, the weight of each grid is determined by considering three factors: 
1) sensitivity factor, 2) proximity factor, 3) LS budget factor. Then, the 
three dimensional structure is vertically compressed into a two dimensional 
planar illustrated in Fig. 2.(b), and the weight of each compressed grid is 
obtained by accumulating the weight of each grid of z-axis. After that, the 
compressed grid with the maximum accumulated weight is selected, and 
this grid-based decision step is finished. Finally, as shown in Fig. 2.(c), the 
selected compressed grid is restored back to the original three layer 
structure. This procedure helps us to decide which grid is firstly assigned 
for the next stage Voltage Re-Assignment. The weight of a grid i is defined 
as 
                            (6) 
where  i is the sensitivity factor and LS budget factor, and  i is the 
proximity factor. There are two main concerns for the definition of  i. The 
first concern (Ssite) is how to make an assignment decision can obtain the 
most rescue of timing and the least penalty of power saving. The second 
concern λi is how to make a assignment decision can lead to fewer LS 
overheads (# level shifters). The  i factor considers clustering. We hope 
more gates in clusters in a single grid, and all gates in a cluster operate at 
the same VDD. The sensitivity factor  i and proximity factor  i are defined 
as follows. 
   
      
                 
                 (7) 
   
     
 
  
 
  
 
  
                     (8) 
where        is the sum of site sensitivities Ssite’s in grid i, Ni is the number 
of all gates in grid i,   
  is the number of gates with VDDH,   
  is the 
number of gates with VDDL, and λi is the LS budget factor that indicates 
whether the estimated        is appropriate.  
As the operating voltages of all sites in the selected grid are determined, the 
needed number of level shifters is determined, and λi can be defined as 
         
  
   
 
 
   
                (9) 
Here,   
    is the needed number of level shifters if all sites are assigned to 
operate at VDDH in grid i, and   
    is the available number of level shifters 
in grid i that is estimated by the attainable white space of grid i. 
Finally, the grid sensitivity        and the site sensitivity        are defined 
as follows. 
8 
 
E. Timing and LS Budget Rescue 
E.1、 Timing Rescue 
The 3D IC Voltage Assignment result might lead the circuit timing to be 
violated because the LS budget is limited. Hence, we can not arbitrarily 
assign VDDH to the site. Therefore, a timing rescue is executed to rescue the 
timing of circuit. For example, the gates with red color are sites and the 
gates with blue color are operating at VDDL as shown in the circuit schematic 
of Fig. 4.(a). First, we compute the gain of each site and sort them. The gain 
is the delay difference between VDDH and VDDL. The site with the maximum 
gain is selected firstly and assigned to operate at VDDH. Then, the fan-in 
gates of the site are selected. For example, we firstly select the fan-in gate C 
with the maximum AT to operate at VDDH, and update its timing information. 
If the maximum AT is changed from gate C to gate D after gate C is 
assigned to operate at VDDH, we must assign VDDH to gate D again. In this 
way, all gates of fan-in of the site are checked until the dominant gate is 
found. Although the timing is rescued, the number of level shifters might be 
over the LS budget due to executing the timing rescue procedure without 
considering LS budget. Therefore, we have to sacrifice the power 
consumption by assigning more gates with VDDL to be VDDH for reducing the 
number of level shifters. In the following, we are going to perform our 
method for rescuing the level shifter usage to meet the LS budget. 
E.2、 LS Budget Rescue 
Intuitively, we can start with the fan-in gate of the LS, and assign VDDH to it. 
This way not only reduces the usage of level shifters but also maintains the 
correctness of circuit. In Fig. 4.(a), the gates with yellow color are level 
shifters, the red color gates operate at VDDH, and the blue color gates operate 
at VDDL. The LS budget rescue step finds out all level shifters, and checks 
whether their fan-in gates with VDDL can be changed to VDDH for reducing 
the number of level shifters. For example, Fig. 4.(a) shows that gate C is the 
fan-in of LS (No. 1 and No. 2), and gate D is the fan-in of LS (No. 3). The 
gain of gate C is equal to -2+1=-1, and the gain of gate D is equal to 
-1+2=1. Obviously, gate C reduces one LS but gate D increases one LS. 
Therefore, we should select gate C to operate at VDDH for reducing the usage 
of level shifters as shown in Fig. 4.(b). Similarly, the gains of gate A and D 
in Fig. 4.(b) are checked again. The rescue procedure stops until no gate can 
be assigned to operate at VDDH for reducing the usage of level shifters. 
 
 
10 
 
TABLE I. Results of the Proposed Voltage Assignment Method 
B. Power Reduction 
TABLE II summarizes the optimization results. TABLE I shows that three 
circuits are failed, and six circuits are successful after executing the 
proposed power reduction method. Therefore, the average of improvement 
is the average of the six circuit results. The initial power and average 
temperature of the circuit are listed in columns 2-4, and the power and 
average temperature of the circuits and the power of level shifters after 
optimization are listed in columns 5-8. The improvement percentages of the 
dynamic power, the leakage power and the total power are listed in columns 
9-11, respectively. The temperature decrement of each circuit is listed in 
column 11. The improvement columns indicate that the proposed 3D IC 
Voltage Assignment method can provide almost 33.50% total power saving 
and 26.34 degree decrement of temperature in average. It can be observed 
that the leakage power reduction is greatly improved because of the 
temperature decrement. 
TABLE III shows the leakage power and temperature estimation with the 
simulated temperature in columns 2-3 and without the simulated 
temperature in columns 4-5, and the percentage differences of leakage 
power in column 6. As shown in TABLE III, the full chip leakage power 
analysis without accurate temperature can lead to 53.88% error in average. 
If the leakage power is underestimated, the power reduction can be 
dominated by the dynamic power, which is quite impractical. 
TABLE II. Results of Power Optimization 
12 
 
[6] Pei-Yu Huang and Yu-Min Lee, “Statistical Hot-Spot Identification Using 
On-Chip Thermal Yield Profile,” VLSI Design/CAD Symposium 
(VLSI/CAD), 2011. 
[7] Pei-Yu Huang and Yu-Min Lee, “On-Chip Statistical Hot-Spot Estimation 
Using Mixed-Mesh Statistical Polynomial Expression Generating and 
Skew-Normal Based Moment Matching Techniques,” Accepted by Asia 
South Pacific Design Automation Conference (ASPDAC), 2012.  
 
八、參考文獻 
[1] V. Reddy and A. T. Krishnan. Impact of negative bias temperature 
instability on digital circuit reliability. Proceedings of IRPS, pages 248-254, 
2002. 
[2] S. H. Kulkarni and A. N. Srivastava. A new algorithm for improved VDD 
assignment in low power dual VDD systems. Proceedings of ISLPED, 
pages 200-205, 2004. 
[3] H. Wu and I. M. Liu. Post-placement voltage island generation under 
performance requirement. Proceedings of ICCAD, pages 309-316, 2005. 
[4] R. L. S. Ching and E. F. Y. Young, E.F.Y. Post-placement voltage island 
generation. Proceeding of ICCAD, pages 641-646, 2006. 
[5] H. Wu and M. D. F. Wong. Timing-constrained and voltage-island-aware 
voltage assignment. Proceedings of DAC, pages 432, 2006. 
[6] S. A. Yu and P. Y. Huang and Y. M. Lee. A multiple supply voltage based 
power reduction method in 3-D ICs considering process variations and 
thermal effects. Proceedings of ASPDAC, pages 55-60, 2009. 
[7] H. F. Dadgour and S. C. Lin. A statistical framework for estimation of 
full-chip leakage-power distribution under parameter variations. IEEE 
Transactions on Electron Devices, 54(11):2930-2945, 2007. 
[8] P. Y. Huang and Y. M. Lee. Full-chip thermal analysis for the early design 
stage via generalized integral transforms. IEEE Transactions on Very Large 
Scale Integration Systems, 17(4):613-626, 2009. 
[9] R. Hentschke and G. Flach. 3D-vias aware quadratic placement for 3D 
VLSI circuits. Proceedings of ISVLSI, pages 67-72, 2007. 
  
國科會補助專題研究計畫項下出席國際學術會議心得報告 
                                     日期：100年 3 月20日 
                                 
一、參加會議經過 
本次 2011年 ISQED的舉辦地點為美國的聖克拉拉，我們所發表的論文：
Redundant Via Insertion under Timing Constraints，很榮幸在 ISQED的論文甄選中，成
為被選中的論文之一。在這三天的會議中，將近有 14個 workshops在這段時間內進
行，也因為時間緊迫，很多 workshop都是同時進行。因此，在這段時間內可以自由
選擇自己有興趣的題目去參加會議，瞭解到現在電子設計自動化上的發展趨勢以及
一些相關應用成果，同時也可以知道其他學者所發表的論文成果。 
 到會場做完報到的手續之後，就是自行決定要去聽哪一個演說，雖然中間有一
計畫編號 NSC99－2220－E－009－035 
計畫名稱 針對 3D整合之電子設計自動化技術開發－子計畫一：三維度積體電路
的隨機電熱模擬及其對功率最佳化的應用(2/2) 
出國人員
姓名 
潘麒文 
服務機構
及職稱 
國立交通大學電信工程研究所 SOC組 
博士班三年級 
會議時間 
100年 3月 14日至
100年 3月 16日 
會議地點 美國 聖克拉拉( Santa Clara) 
會議名稱 
(中文) 電子設計品質會議 
(英文)11th International Symposium on Quality Electronic Design  
發表論文
題目 
(中文)在時序限制下的冗餘接點安插 
(英文) Redundant Via Insertion under Timing Constraints 
 打招呼，而華人通常都是一群一群的自成一個團體‧ 
在參與別的 session時，會去另外注意別人製作簡報的方式，研究如何使用簡
單明瞭的方法讓聽眾很快的吸收、理解。也因為這樣，一直到上台報告的前幾天，
我還是一直在調整自己的簡報，使用一些動畫的方式來強調重點，希望讓聽眾能夠
較易瞭解。可惜的是有部份 session是同時進行，無法聽完所有的演講，因此只能
從演講主題下去挑選要參加的研討會。 
 住在旅館時，旅館有提供無線網路的服務，可是在房間內使用常常會覺得訊號
差以及連線不穩定，無法從網路查資料，這也突顯了事先準備的重要性‧這趟行程
讓我見識到大型國際研討會的規模與水準，以及來自各地的研究人員，深感國際競
爭的壓力，我們必須各加倍專注於我們的學術研究‧ 
 
三、考察參觀活動(無是項活動者略) 
四、建議 
可以在國內多舉辦類似的大型國際研討會，並邀請一些國會知名學者出席演
講，以提升會議的規模與水準，與世界接軌‧ 
 
五、攜回資料名稱及內容 
11th ISQED 光碟x1 : 內含本次會議的所有論文資料 
 
六、其他 
 
 
Congratulations on your fine work.  If you have any additional questions, please feel 
free to get in touch. 
 
Best Regards, 
Ramalingam Sridhar and Norbert Schuhmann SOCC 2010 
 
free to get in touch. 
 
 
Best Regards, 
Kamesh Gadepally - ISQED2011 TPC Chair 
Keith Bowman , ISQED2011 TPC Co-Chair 
ISQED 2011 
TABLE I
ERROR COMPARISON OF Is AND Ig WITH THE RESULTS OF HSPICE UNDER 65nm TECHNOLOGY FOR AN NAND GATE.
fg Max Error Avg. Error Error > 3%
Without temperature Tox, T 2ox, Lch, L
2
ch [1] 6.48% 2.70% 4.37%
With temperature Our adopted model: a polynomial function constructed by Lch, T , Tox and T 2ox 1.55% 0.29% 0.00%
fs Max Error Avg. Error Error > 3%
Without Lch, L2ch, T
−1
ox , T
2
ox [1] 347.32% 70.65% 98.27%
temperature Lch, L2ch, T
−1
ox , Tox, T
2
ox, Tox/Lch, Lch/Tox, ToxLch [2] 314.13% 70.52% 100.00%
With Lch, T, Tox [8] 32.23% 8.73% 76.62%
temperature Our adopted model: a 3rd order polynomial function completely expanded by Lch, Tox and T 1.31% 0.19% 0.00%
Here, a cell-based leakage power ﬁtting model including the
process variation effect and temperature dependence is presented.
Firstly, for each cell, different input patterns, various physical pro-
cess parameter values and operating temperatures are combined
and put into HSPICE with industrial design kit under the BSIM4
model to generate its leakage current data. After that, the average
leakage currents of input patterns are ﬁtted by the least square
ﬁtting method. Finally, the ﬁtted coefﬁcients of different average
leakage current models such as the average subthreshold leakage
(Is) and the average gate tunneling leakage (Ig) can be obtained.
Since Is is the off-state leakage, and Ig occurs in both on and
off states of transistor, the cell leakage power can be written as
Pleakage = Vdd × (Ig + (1− Sw) Is) , (1)
where
Ig = a0 · efg(Tox,Lch,T ), (2)
Is = b0 · efs(Tox,Lch,T ). (3)
Here, a0 and b0 are ﬁtted constants, Lch and Tox are the channel
length and oxide thickness, respectively. T is the operating
temperature, Sw is the switching activity, Vdd is the supply
voltage, and fg(Tox, Lch, T ) and fs(Tox, Lch, T ) are speciﬁc
ﬁtting forms1. Ig is modeled as exponentially dependent on
temperature since it is exponentially affected by the threshold
voltage [9].
The accuracy of several existing leakage current models has
been investigated [1], [2], [8]. Because they do not present
enough accuracy, much more accurate leakage current models are
proposed in this work. The error comparison of existing leakage
current models and the proposed leakage current models for an
two-input NAND gate is shown in TABLE I.
As shown in TABLE I, different fg and fs lead to different
errors compared with the results of HSPICE. The drastic errors
of [1], [2], [8] are because of the ignorance of either temperature
or developing technology. The maximum error and average error
of proposed models are less than 1.55% and 0.29%, respectively.
Actually, for all cell types given by an industrial design kit,
the maximum error and average error of our developed leakage
current models are only 1.55% and 0.5%, respectively.
With the above demonstration, the leakage current (power)
model might be very complicated for achieving acceptable ac-
curacy. This fact indicates that the statistical power analyzer or
the statistical thermal analyzer should have the ability to handle
complicated leakage current (power) models.
1We consider the variations of the device channel length and the oxide thickness
since the leakage power is very sensitive to them [1]. It should be noted that
although only these two parameters are considered, our framework can be easily
extended to include the effects of any process variation parameters such as the
channel dopant variation, etc.
Fig. 1. Compact thermal model of physical design.
B. Problem Formulation
The compact thermal model of a chip for the physical design
stage is shown in Fig. 1 [10]. The primary heat ﬂow path is
composed of thermal interface material, heat spreader and heat
sink. The secondary heat ﬂow path involves interconnect layers,
I/O pads, and the print circuit board. The functional blocks are
modeled as many power sources attached to the thin layer close
to the top surface of die. The main heat sources consist of the
dynamic and leakage power consumed by devices. Because the
dynamic power is insensitive to process variations and operating
temperature [1], it is viewed to be deterministic. However, the
leakage power is strongly dependent on process parameters and
operating temperature. Hence, the leakage power is viewed as
random processes [1], and the thermal coupling effect needs to be
considered for the full-chip temperature distribution analysis. By
combining the compact thermal model and the statistical power
consumption considering the thermal coupling effect, the steady
state temperature distribution T (r, θ,) of die is determined by
the following statistical steady-state heat transfer equation.
∇·(κ(r, T )∇T (r, θ,))=−p(r, Lch(x, y, θ), Tox(x, y,), T ), (4)
subject to the following boundary condition
κ(rbs , T )
∂T (rbs , θ,)
∂nbs
+ hbsT (rbs , θ,) = fbs(rbs). (5)
Here, ∇ is the diverge operator, and κ(r, T ) is the thermal
conductivity of die. The p(r, Lch(x, y, θ), Tox(x, y,), T )
is the random process of power density proﬁle
which consists of the dynamic power density proﬁle
pd(r), the sub-threshold leakage power density proﬁle
ps(r, Lch(x, y, θ), Tox(x, y,), T ), and the gate leakage
power density proﬁle pg(r, Lch(x, y, θ), Tox(x, y,), T ). The
r = (x, y, z) ∈ D, D = (0, Lx) × (0, Ly) × (−Lz, 0) is the
domain of die, Lx and Ly are lateral sizes of die, and Lz
is the thickness of die. The θ and  are sampling values
of manufacturing outcomes ΩLch and ΩTox for the channel
length and oxide thickness, respectively. The Lch(x, y, θ) and
Tox(x, y,) are the random processes of the device channel
140
The high order interpolating approximation can be achieved with
a small number of samples [13].
According to the Smolyak sparse grid formulation [7], our
desired full-chip statistical temperature distribution T (r, ξ˜) rep-
resented by a set of KL expanded random variables ξ˜ can be
explicitly approximated as [15]
T˜ dq (r, ξ˜) =
∑
q−d+1≤|i|≤q
(−1)q−|i|
(
d− 1
q − |i|
)
(Qi1(T )⊗· · ·⊗Qid(T )), (10)
where d is the number of random variables in ξ˜, q is the level
of desired solution, Qin with the level in ≥ 1 is the one-
dimensional interpolating operator of T (r, ξ˜) with respect to the
n-th random variable in ξ˜, ⊗ is the functional cross product,
and |i| = i1 + · · · + in + · · · + id. The level in is the index
to decide the number of sampling values for the interpolating
polynomial Qin . As suggested in [16], the relation between the
number of sampling values min and the level in is m1 = 1 and
mijn = 2
in−1 + 1 for in > 1.
From (10), we only need to know the temperature on the
following small set of sampling values for ξ˜ [17]. The sparse
grid, the set of sampling values of ξ˜, in (10) is derived as
H (q, d) =
⋃
q−d+1≤|i|≤q
(
ϑi1 × · · · × ϑin × · · · × ϑid), (11)
where ϑin denotes the set of sampling points of ξ˜n, and ‘×’ is
the cross product of the points of set.
The number of sampling points from Smolyak sparse grid
formulation increases as O( d
q−d
(q−d)! ) that is less severe than that
of full tensor product formulation. The runtime complexity of
our proposed statistical electro-thermal analyzer can be analyzed
to be O(Cdet d
q−d
(q−d)! ). The Cdet is the runtime complexity for
executing a deterministic electro-thermal simulation.
The sampling values corresponding to ϑin must be properly
decided. Adopting the roots of H-PCs with its order being
corresponding to the level in can achieve the most accurate result
if ξ˜ is a set of normal random variables [14]. On the other hand,
adopting the extrema of the Chebyshev polynomial with its order
being corresponding to the level in can achieve the nested sparse
grid structure for any levels and acceptable accuracy [16]. In
this paper, we adopt the roots of H-PCs in our experimental
implementation because the results are shown to be very accurate
by using the low level approximation, and the nested sparse grid
structure is still preserved for q = d+ 14.
C. Calculation of Temperature Proﬁles on Sparse Grids
After the sparse grid H(q, d) being obtained, the samples of
channel length and oxide thickness corresponding to the m-
th sampling grid ξ˜m of H(q, d) can be obtained by using the
parameter modeling technique stated in section III-A. Hence, the
deterministic power density proﬁle corresponds to ξ˜m can be
obtained. With the deterministic power density proﬁle, we have
the following deterministic steady heat transfer equation.
∇ ·
(
κ(r, T )∇T (r, ξ˜m)
)
= −p(r, ξ˜m, T ), (12)
4If a highly order approximation is required for the accuracy, we suggest the
extrema of the Chebyshev polynomial because its nested sparse grid structure is
preserved for any levels; hence, it needs much less sampling points than that of
choosing the roots of the H-PCs for highly order approximation.
Algorithm Calculation of Temperature Proﬁles on Sparse Grid
Input:Sampling point ξ˜i, initial temperature T ini and pdyn(r)
Output: Stable temperature proﬁles T (r, ξ˜i) of ξ˜i
1 Begin
2 Obtain Tox(rxy , ξ˜i) and Lch(rxy , ξ˜i) according to ξ˜i;
3 T (r, ξ˜i) ← T ini;
4 T ′(r, ξ˜i) ← 0;
5 While (T (r, ξ˜i)− T ′(r, ξ˜i) ≤ Converging criterion)
6 T ′(r, ξ˜i) ← T (r, ξ˜i);
7 Update pleakage(r, ξ˜i, T ) by T (r, ξ˜i);
8 ptotal(r, ξ˜i, T ) ← pleakage(r, ξ˜i, T ) + pdyn(r);
9 † Solve deterministic thermal equations (12) and (13)
with ptotal(r, ξ˜i, T ) to obtain a new T (r, ξ˜i);
10 if (T (r, ξ˜i) = Inﬁnite) then Thermal runaway;
11 Return T (r, ξ˜i)
12 End
† The deterministic thermal analyzer [18] is used to obtain T ∗.
Any deterministic thermal analyzer can be used here.
Fig. 3. Deterministic electro-thermal analysis for each sampling point in sparse
grid. pleakage, pdyn and ptotal are the leakage, dynamic and total power density
proﬁles for each sampling point of sparse grid, respectively.
subject to the following boundary condition
κ(rbs , T )
∂T (rbs , ξ˜
m)
∂nbs
+ hbsT (rbs , ξ˜
m) = fbs(rbs). (13)
Here, p(r, ξ˜m, T ) and T (r, ξ˜m) are deterministic power density
and temperature proﬁles with respect to ξ˜m, respectively. Since
the power density proﬁle is temperature dependent in equa-
tion (12), the deterministic electro-thermal analysis is used to
get each T (r, ξ˜m) and is summarized in Fig. 3.
D. Polynomial Interpolation of Temperature Distribution
Instead of directly using equation (10) which requires to obtain
different Qi1(T )⊗· · ·⊗Qid(T ) for each different |i| = i1+· · ·+
id, we take the advantage of nested sparse grid structure and then
perform one time of Newton interpolating method [14] to globally
interpolate T (r, ξ˜) by the deterministic temperature proﬁles of all
sampling values in sparse grid. For the sparse grid that can not
preserve nested structure, the Newton interpolating method can
be applied to obtain each different Qi1(T )⊗· · ·⊗Qid(T ).
Based on the Newton interpolating formula, the temperature at
the speciﬁed die position r∗ can be approximated as
T (r∗, ξ˜) ≈
m=N∑
m=0
aˆm(r
∗)φm(ξ˜), (14)
where φm(ξ˜) is an interpolating polynomial with respect to the
m-th sampling value ξ˜m, and its form can be found in [14]. The
N = |H(q, d)| − 1, |H(q, d)| is the number of sampling values
in sparse grid, and aˆm(r∗)′s need to be determined.
Based on the basic idea of interpolation that the approximated
function must match each known data, the interpolated polyno-
mial in (14) must satisfy equation (15) for each ξ˜k.
m=N∑
m=0
aˆm(r
∗)φm(ξ˜k) = T (r∗, ξ˜k). (15)
Based on the property of φn(ξ˜) [14], the matrix equation (16)
142
TABLE II
ACCURACY AND EFFICIENCY COMPARED WITH THE MONTE CARLO METHOD.
Inter-die Intra-die Our Proposed Method† Monte Carlo‡ Speedup
/ Total / Total maximum mean maximum std. runtime (s) sampling runtime (s)‡ (X)
Variations Variations error error Phase 1 Phase 2 knots
40% 60% 0.31% 1.68% 3.23 1.16 6736 357.88 308.51
50% 50% 0.32% 1.84% 3.27 1.16 6465 347.82 299.84
60% 40% 0.34% 1.81% 3.40 1.16 6422 341.72 294.59
† Our proposed method is compared with the golden solution constructed by the Monte Carlo method using 105 samples.
‡ To show the efﬁciency, the Monte Carlo method is simulated till the standard deviation achieves the same accuracy as the proposed method.
The runtime does not include the time of input parser which is only performed once in the Monte Carlo simulation.
A A
(a) (b)
Fig. 7. Temperature proﬁle at the top surface of die. (a) The spatial standard
deviation distribution without including electro-thermal coupling. (b) The spatial
standard deviation distribution with including electro-thermal coupling.
full-chip temperature distribution are only 0.34% and 1.84%,
respectively. The execution time is only 3.27 seconds and 1.164
seconds in Phase 1 and Phase 2, respectively.
Since operations in Phase 1 are irrelevant to design patterns,
they only need to be pre-performed once while applying the
analyzer to thermal-aware design procedures. Hence, to show
the efﬁciency of proposed analyzer, the runtime of Phase 2 is
compared with the runtime through the Monte Carlo simulation
fulﬁlling the same accuracy of standard deviation as ours. TA-
BLE II shows that the developed analyzer is orders of magnitude
faster than the Monte Carlo method. Since each sampling point
is independent, the parallel programming technique can be used
to further enhance the speedup.
B. Without v.s. With Including Electro-Thermal Coupling Effect
Fig. 6 and Fig. 7 show the spatial mean distribution and spatial
standard deviation distribution of temperature distribution at the
top surface of test chip, respectively. Fig. 6(a) and Fig. 7(a) are the
results without considering the electro-thermal coupling effect.
Fig. 6(b) and Fig. 7(b) are the results with considering the electro-
thermal coupling effect. These two ﬁgures reveal the dramatic
differences of these two results. As we can see, the difference of
spatial mean proﬁle can reach 6.54%, and the difference of spatial
standard deviation proﬁle is over 25.01%. This impact shows that
it is necessary to consider the electro-thermal coupling effect for
the statistical thermal analysis, and the developed analyzer can
accurately and efﬁciently achieve this goal.
V. CONCLUSION
An efﬁcient statistical electro-thermal analyzer with high com-
patibility of power models has been presented. The analyzer can
efﬁciently provide the accuracy results and is high capability with
any leakage power models and the spatial correlation function.
The experimental results also indicated that it is not allowable
to ignore the electro-thermal coupling effect when considering
process variations in statistical thermal simulation.
ACKNOWLEDGMENT
This work was supported in part by the National Science
Council of Taiwan under Grant NSC 98-2220-E-009-058.
REFERENCES
[1] H. Chang and S. S. Sapatnekar. Prediction of leakage power under process
uncertainties. ACM TODAES, 12:1–27, April 2007.
[2] R. Shen, N. Mi., and S. Tan. Statistical modeling and analysis of chip-level
leakage power by spectral stochastic method. Proc. ASP-DAC, pages 31–6,
June 2009.
[3] S. Bhardwaj, S. Vrudhula, and A. Goel. A uniﬁed approach for full chip
statistical timing and leakage analysis of nanoscale circuits considering
intra-die process variations. IEEE TCAD, 27(10):1812–1825, 2008.
[4] Y. K. Cheng, P. Raha, C. C. Teng, E. Rosenbaum, and S. M. Kang.
ILLIADS-T: an electrothermal timing simulator fortemperature-sensitive
reliability diagnosis of CMOS VLSI chips. IEEE TCAD, 17(8):668–81,
1998.
[5] P. Y. Huang, J. H. Wu, and Y. M. Lee. Stochastic thermal simulation
considering spatial correlated within-die process variations. Proc. ASP-DAC,
pages 55–60, June 2009.
[6] J. Jaffari and M. Anis. Statistical thermal proﬁle considering process
variation: Analysis and appllications. IEEE TCAD, 27:1027–40, June 2008.
[7] S. A. Smolyak. Quadrature and interpolation formulas for tensor products
of certain classes of functions. Dokl. Akad. Nauk SSSR, pages 240–3, 1963.
[8] S. A. Yu, P. Y. Huang, and Y. M. Lee. A multiple supply voltage based power
reduction method in 3-d ics considering process variations and thermal
effects. Proc. ASP-DAC, pages 55–60, June 2009.
[9] K. M. Cao, W. C. Lee, W. Liu, X. Jin, P. Su, S. K. H. Fung, J. X. An, B. Yu,
and C. Hu. BSIM4 gate leakage model including source-drain partition.
pages 815–818, 2000.
[10] W. Huang, S. Ghosh, S. Velusamy, K. Sankaranarayanan, K. Skadron, and
M. R. Stan. Hotspot: A compact thermal modeling methodology for early-
stage vlsi design. IEEE TVLSI, 14:501–13, May 2006.
[11] S. Bhardwaj, S. Vrudhula, P. Ghanta, and Y. Cao. Modeling of intra-
die process variations for accurate analysis and optimization of nanoscale
circuits. Proc. DAC, pages 791–6, 2006.
[12] B. Cline, K. Chopra, D. Blaauw, and Y. Cao. Analysis and modeling of cd
variation for statistical static timing. Proc. ICCAD, pages 60–6, 2006.
[13] J. Taylor and F. Hover. High dimensional stochastic simulation and electric
ship models. Proc. ESTS, 21-3:402–7, May 2007.
[14] G. M. Phillips. Interpolation and Approximation by Polynomials. Springer,
2003.
[15] G. W. Wasilkowski and H. Wozniakowski. Explicit cost bounds of
algorithms for multivariate tensor product problems. J. Complexity, 11(1):1–
56, 1995.
[16] V. Barthelmann, E. Novak, and K. Ritter. High dimensional polynomial
interpolation on sparse grids. Advan. Comput. Math., 12(4):273–88, 2000.
[17] F. Nobile, R. Tempone, and C. G. Webster. A sparse grid stochastic
collocation method for partial differential equations with random input data.
SINUM, pages 2309–45, May 2008.
[18] P. Y. Huang and Y. M. Lee. Full-chip thermal analysis for the early design
stage via generalized integral transforms. IEEE TVLSI, 17:613–26, May
2009.
[19] F. Lallement, B. Duriee, A. Grouillet, F. Amaud, B. Tavel, F. Wacquant,
P. Stalk, M. Woo, Y. Erokhin, J. Scheuer, L. Gadet, J. Weeman, D. Distaso,
and D. Lenoble. Ultra-low cost and high performance 65nm cmos device
fabricated with plasma doping. Symp. VLSl Technol. Dig. Tech. Papers,
pages 178–9, 2004.
[20] J. Bienacel, D. Barge, M. Bidaud, N. Emonet, D. Roy, L. Vishnubhotla,
I. Pouilloux, and K. Barla. Anticipation of nitrided oxides electrical
thickness based on XPS measurement. Materials Science in Semiconductor
Processing, 7(4-6):181–3, 2004.
144
Fig. 1. A simple RC tree. (a) An original RC tree. (b) A locally modiﬁed RC
tree.
II. PROBLEM FORMULATION
Given a post-routing design, its routed netlist and each net tim-
ing constraint1, the RV insertion problem under timing constraints
is to simultaneously insert extra vias as many as possible to the
design and satisfy the given timing constraints. The problem can
be formulated as follows.
max
N∑
i
Mi∑
k
Rvik,
subject to
Dij ≤ Dij , ∀ (net i) & (sink j of net i)
Here,
Rvik =
{
1 if an RV is inserted to a single via k of net i
0 otherwise.
N is the number of nets in the given design, Mi is the number of
single vias on net i, Dij is the propagation delay from the source
of net i to its sink j, and Dij is the timing constraint of sink j
on net i.
III. INCREMENTAL TIMING ANALYSIS
A. Incremental Timing Formula
A simple RC tree shown in Fig. 1 is used to describe the closed
form of the incremental timing formula. Given an original RC
tree shown in Fig. 1.(a) and its locally modiﬁed RC tree shown
in Fig. 1.(b), their Elmore2 delay values from node 0 to node n
can be calculated as
t(a)n = R1
6∑
i=1
Ci +R2
6∑
j=2
C2 +R3
4∑
k=3
Ck +R4C4
t(b)n = t
(a)
n +tn.
Here, their timing difference tn can be derived as
tn = C2
2∑
i=1
Ri +C3
3∑
j=1
Rj +C5
2∑
k=1
Rk
+R2
6∑
i=2
Ci +R3
4∑
j=3
Cj
+R2
∑
i=2,3,5
Ci +R3C3. (1)
1In this work, the main issue is how to consider the timing effects during the
redundant via insertion procedure. Hence, we simplify the problem with the net
timing constraint; however, our developed method also works with the circuit
timing constraint.
2Although the Elmore delay [12] is used as the delay metric in this work, the
proposed incremental delay analysis method can be easily extended to any higher
order delay metrics.
Here, each ΔCi is the difference value of nodal capacitance
at node i after and before via insertion, and each ΔRj is the
difference value of branch resistance on branch j after and before
via insertion. The expression of (1) consists of three types. Each
term in the ﬁrst line is the product of a delta nodal capacitance
and its original upstream common path equivalent resistance.
The original upstream common path equivalent resistance is the
sum of original overlapped segment resistances between the paths
from source node 0 to the nodal-capacitance changed node and
from source node 0 to node n in Fig. 1.(a). Each term in the
second line is the product of a delta branch-resistance (on the
path from source node 0 to node n) and its original downstream
equivalent capacitance. Each term in the last line is an interactive
term that is the product of a delta branch-resistance (on the
path from source node 0 to node n) and its delta downstream
equivalent capacitance.
With (1), the timing difference tn for each node n after a RC
tree is locally modiﬁed can be generally formulated as follows.
Δtn =
∑
i
RniΔCi +
∑
j∈Pn
ΔRjCj∗ +
∑
j∈Pn
ΔRjΔCj∗ (2)
Here, Rni is the original upstream common path equivalent
resistance between Pn and Pi, and Pn/Pi is the routed path
from source node to node n/i. Cj∗ is the original equivalent
downstream capacitance seen from branch j, and ΔCj∗ is the
difference value of equivalent downstream capacitance seen from
branch j after and before via insertion.
By utilizing the timing difference formula of node n shown in
(2), it can be very efﬁcient to predict each speciﬁc net sink node
delay without recalculating all node delays of a speciﬁc net.
B. Redundant Via Shapes
According to the connection between wires and the single
via, the structures of redundant vias can be categorized into two
different shapes. If a single via only connects two wire segments,
it is called an L-shape since this structure looks like an alphabet
letter ‘L’. If a single via connects more than two wire segments,
it is called a T-shape since it looks like an alphabet letter ‘T’.
Moreover, according to the characteristic of redundant vias, they
can be divided into two types, on-track RV and off-track RV.
The on-track RV is placed on the original net and needs only
one extra wire segment, and an off-track RV is placed out of the
original net and needs to add two extra wire segments.
Since L-shape RVs and T-shape RVs are cyclic circuits, in
order to effectively calculate their Elmore delay values, several
fundamental circuit transformation techniques are utilized to
make them acyclic. The equivalent acyclic RC circuits of each
L-shape RV and each T-shape RV are derived as follows to
incrementally update the circuit timing efﬁciently.
B.1. L-shape
The L-shape RVs contain three templates that two types are
on-track RVs, and one type is off-track RV. These templates
and their corresponding RC trees are shown in Fig. 2. Fig. 3
shows the equivalent acyclic RC circuits of above three L-shape
RV templates, and their related ΔR values and ΔC values are
summarized in TABLE I.
B.2. T-shape
According to the transformation methods, T-shape RVs can
be divided into simple T-shape RVs and complicated T-shape
TABLE II
ΔR VALUES AND ΔC VALUES OF THE EQUIVALENT ACYCLIC RC CIRCUIT OF COMPLICATED T-SHAPE RV.
Complicated ΔR
T-Shape RV ΔR1 ΔR2 ΔR3 ΔR4 ΔR5 ΔR6
on-track type I −rw1x (rw2x+rvlv)rw1x(rw1+rw2)x+2rvlv
rvlvrw1x
(rw1+rw2)x+2rvlv
(rw2x+rvlv)rw1x
(rw1+rw2)x+2rvlv
− rvlv 0 0
on-track type II 0 rvlvrw3x
(rw2+rw3)x+2rvlv
(rw2x+rvlv)rw3x
(rw2+rw3)x+2rvlv
(rw2x+rvlv)rw1x
(rw2+rw3)x+2rvlv
− rvlv −rw3x 0
on-track type III 0 (rw1x+rvlv)rvlv
(rw1+rw2)x+2rvlv
− rvlv rvlvrw2x(rw1+rw2)x+2rvlv
(rw1x+rvlv)rw2x
(rw1+rw2)x+2rvlv
0 −rw2x
Complicated ΔC
T-Shape RV ΔC0 ΔC1 ΔC2 ΔC3 ΔC4 ΔC5 ΔC6
on-track type I −cw1x
2
cw2x+cvlv
2
−cvlv
2
cw1x+cvlv
2
cw2x+cvlv
2
0 0
on-track type II 0 cw3x+cvlv
2
−cvlv
2
cw2x+cvlv
2
cw2x+cvlv
2
−cw3x
2
0
on-track type III 0 cw1x+cvlv
2
−cvlv
2
cw2x+cvlv
2
cw1x+cvlv
2
0 −cw2x
2
Fig. 6. Complicated T-shape RV. (a) on-track type I. (b) on-track type II. (c)
on-track type III.
Fig. 7. The equivalent acyclic RC circuit of complicated T-shape RV.
delay effect is passed to the upstream and downstream
path, and the circuit delay is calculated and checked.
With this method, we can effectively update the circuit
timing, keep the slack being non-negative, and has no
any timing violation.
D. Runtime Complexity Analysis
The incremental timing analysis method can analyze the timing
difference in O(nsink) time if a relation topology table between
vias and sinks can be constructed in advance. Here, nsink is the
number of sink nodes on the net. Once the developed algorithm
decides a redundant via to be inserted, the timing inﬂuence can
Fig. 8. An example of look-up table. (a) A RC tree. (b) The related look-up
table.
be easily analyzed by using the look-up table. For example, after
a redundant via has been inserted to via v1 shown in Fig. 8, the
timing inﬂuence on each sink can be analyzed by ﬁnding the
common path between the via v1 and each sink node.
ncp(v1, S1) = v1 (3)
ncp(v1, S2) = v1 (4)
ncp(v1, S3) = n1 (5)
ncp(v1, S4) = S0 (6)
ncp(v1, S5) = S0 (7)
Here, ncp(v, S) is the node that its upstream path is the common
path of the via v and sink S. With the formulas (2) and (3)–(7),
the timing information can be efﬁciently predicted and updated.
The conventional timing analysis method reanalyzes the timing
values of all nodes on the net and needs to recalculate the
downstream capacitance of each node. The runtime complexity
of the conventional method is O(n), and n is the number of nodes
o the net. Therefore, compared with the conventional method, the
developed method is more efﬁciency.
IV. MBC GRAPH MATCHING PROBLEM
Lei et. al [8] proposed and deﬁned the MBC graph matching
problem with three essential deﬁnitions. The ﬁrst deﬁnition
constructs a via-candidate bipartite graph that includes the set
of single vias on one side and the set of corresponding RV
candidates on the other side. The second deﬁnition constructs a
candidate relative graph that shows the relationship between RV
candidates. The connection in graph means the conﬂict of two
candidates because of design rules; in other words, they ﬁght
for one RV position. The third deﬁnition integrates two graphs
Fig. 11. The individual phase ﬂowchart of the two phase t-MWM algorithm.
TABLE III
PARASITIC PARAMETER
Resistance Capacitance
Ω/ pF/μm2
Metal 1 0.101 1.12e-4
Metal 2 0.101 6.59e-5
Metal 3 0.101 5.97e-5
Metal 4 0.101 5.59e-5
Phase 1 is a pre-stage to increase the timing budget for other
candidates in Phase 2. Without any conﬂicts of RV candidates, the
candidates inserted in Phase 1 will not decrease the RV candidate
number in Phase 2. Furthermore, according to (9), each picked
RV can increase the timing-budget.
Phase 2 deals with the rest RV candidates excluding those in-
serted in Phase 1 and utilizes (8) for the edge weight assignment.
The rest steps in Phase 2 are the same as those of Phase 1 shown
in Fig. 11.
Remark: The concept of pre-increasing the timing budget in
Phase 1 has a signiﬁcant inﬂuence on the insertion
number of Phase 2. For example, the single via V7 in
Fig. 10 has only one RV candidate Rr7 that conﬂicts
to Rl6. The better choice is to pick up Rr6 and Rr7 to
match single vias V6 and V7 individually.
However, if we execute Phase 2 directly instead of
performing Phase 1 ﬁrstly, the ω(e) related to Rr7 will
be inﬁnity if the timing constraint is violated after Rr7
is chosen to be inserted. In other words, Rr7 cannot be a
candidate under timing constraints unless other inserted
RVs at the same net can provide extra enough timing
budget for Rr7.
As a result, if Phase 1 can enhance the timing budget,
it is helpful for improving the insertion rate in Phase 2.
VI. EXPERIMENTAL RESULTS
The developed RV insertion method under timing constraints
has been implemented in C++ programming language and tested
on an Intel Xeon 5160 quad core 3.0-GHz Linux based machine
with 32GB memory. The test designs are the routed MCNC
TABLE IV
NET SINK NODE TIMING DIFFERENCE RATIO AFTER RVI WITHOUT
CONSIDERING TIMING CONSTRAINTS
Circuit Timing Difference Ratio Interval (%)
Mcc1 −43.87 ∼ 7.40
Mcc2 −28.33 ∼ 7.13
Struct −44.51 ∼ 0.01
Primary1 −48.51 ∼ 9.81
Primary2 −48.45 ∼ 9.86
S5378 −48.64 ∼ 5.67
S9234 −48.61 ∼ 3.51
S13207 −48.62 ∼ 5.64
S15850 −48.62 ∼ 4.04
S38417 −48.61 ∼ 3.89
S38584 −48.62 ∼ 5.63
Fig. 12. Net sink node timing difference ratio probability graph of Primary1.
benchmarks that were built by the authors of [6] with 0.18μm
technology. The RC parasitic parameters are listed in TABLE III,
and the resistance of via is equal to 6.4Ω. The ﬁrst two cases
contain 4 metal layers and others have 3 metal layers. For the
edge weight assignment constants, we choose α = 3, β = 1 and
γ = 2 that are the same as those in [8] for the trade-off between
the RV insertion rate and the on-track RV insertion rate.
To investigate the timing impact of inserted redundant vias,
we calculate the net sink node timing difference ratios after per-
forming the conventional (without considering timing constraints)
redundant via insertion method on each test circuit [8]. TABLE IV
shows the difference ratio interval for each circuit. The ‘Timing
Difference Ratio Interval’ is the timing disturbance ratio interval
of net sink node delay differences after ﬁnishing the redundant
via insertion procedure. It can be found that the range of timing
difference ratio can be 35% ∼ 58%. Fig. 12 draws the sink node
timing difference ratio probability graph for Primary1, and it
reveals that the timing difference ratio interval can be very wide
with non-ignorable probabilities. Therefore, it is meaningful to
consider the timing effect while inserting redundant vias3.
The results of redundant via insertion are presented in TA-
BLE V. The “#Single Vias” is the total number of single vias in
the given design, “#Alive Vias” is the total number of alive vias
that a alive via is a single via having at least one RV candidate,
“#Ins. RVs” is the number of RVs inserted by executing the
insertion algorithms, and “#Ins. Rate” is the RV insertion rate.
The “#Ins. RVs w/o vio.” is equal to the total insertion number of
RVs minus the number of inserted RVs causing timing constraint
3The high ratio of positive timing difference is because the nets are short in
test circuit [8]; therefore, the insertion of redundant via may have high effect on
timing delay.
國科會補助計畫衍生研發成果推廣資料表
日期:2011/10/30
國科會補助計畫
計畫名稱: 子計畫一：三維度積體電路的隨機電熱模擬及其對功率最佳化的應用(2/2)
計畫主持人: 李育民
計畫編號: 99-2220-E-009-035- 學門領域: 晶片科技計畫--整合型學術研究
計畫
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
參加 2010 大學院校奈米元件電腦輔助模擬與設計軟體製作競賽榮獲奈米 CMOS
元件組佳作(頒獎單位:國家實驗研究院國家奈米元件實驗室) 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
