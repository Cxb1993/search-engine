1 
 
行政院國家科學委員會專題研究計畫期中報告
 
結合多媒體互動與生理回饋技術建立智慧型太極拳輔助學
習環境-太極拳輔助學習系統之多媒體互動技術研發 
 
Research on Multimedia Interaction Technology for Computer Aided 
Learning of Tai Chi Chuan 
 
計畫編號：95-2221-E-002-210-MY3 
執行期間： 96 年 8 月 1 日至 98 年 10 月 31 日 
計畫主持人：洪一平 
計畫參與人員：林士堯、余孟杰、賴韻芊 
 
 
 
1. 中英文摘要 
本子計畫之目標在於研究及設計智
慧型太極拳輔助學習環境中的多媒體互
動介面，包括「呈現介面」以及「操控介
面」兩大部分。在呈現介面部分，我們將
整合多部投影機，建置一個全方位的投影
系統，讓「虛擬教練」得以在環境中的不
同方位，引導學員演練太極拳動作。在操
控介面部分，我們的系統將可以讓學員使
用各種不同的互動介面，自由選擇教學內
容、調整教學進度以及虛擬教練的演練速
度等。本計畫三年開發成果包含系統學習
流程之規劃、虛擬按鈕、粒子系統與生理
訊息偵測、基於幾何模型之三維人體手勢
追蹤技術以及步行資訊偵測系統。 
整體而言，總計畫所完成的太極拳學
習資料庫，需要本子計畫提供各項人機互
動介面，才能將教學內容呈現在學員面
前，並提供個人化的學習情境以及互動學
習的功能；而其他子計畫的偵測分析結
果，亦須良好的多媒體視覺化呈現，才能
讓學員可以透過多媒體畫面，清楚了解自
己的學習狀態與生理狀態等訊息。 
 
關鍵詞：智慧型空間、太極拳、多媒體互
動、人機介面、電腦輔助學習 
 
The goal of this sub-project is to design and 
develop a multimedia interaction system 
for the intelligent environment of Tai-Chi 
Chuan learning. The research focus 
includes “display of multimedia content” 
and “interaction with the intelligent 
environment”. To display the multimedia 
content, we will investigate how to use 
multiple projectors to construct an 
environment that can display “virtual 
coach” in all the four directions centered at 
the practitioner, so that the practitioner can 
see the virtual coach no matter which 
direction he turns toward. As to interaction 
with the intelligent environment, we shall 
provide multiple ways for the user to give 
instructions to the system, in order to 
choose the lessons or to adjust the 
instruction speed.  
The goal of this sub-project in second year 
is to design the display interface within 
particle system, virtual button and 
bio-signal detection for the Tai-Chi Chuan 
intelligent environment. Another important 
 3 
 
(圖一)。使用者可以跟隨著虛擬教練的武
術姿態，並透過電腦視覺動態感測技術判
斷使用者的身體姿態是否正確，及時評估
及修正使用者的姿態，亦可透過遊戲的方
式達到武術學習的效果。此系統由Nike 
Motionworks 提供完整的運動流程指
導，將可充分鍛鍊玩家的體能、韻律與反
應，達成身心協調的效果。 
 
圖一 EyeToy Kinetic Combat學習系統 
 
近幾年投影機等影像顯示設備成本
逐漸降低，在大型空間中逐漸能夠使用多
部投影裝置，建置全方位的互動環境。透
過影像的偵測與同步技術，多部投影機的
畫面可以相互協調，並藉由使用者的動作
與行為，以不同的投影機根據環境的改變
呈現適當的影像，或以使用者的狀態為依
據給予相應的回饋。利用多台投影機接合
而成一個大型投影顯示系統是日益重要
的顯示技術，其中的幾何校正以及色彩校
正是在這系統之下最需克服的兩項問
題。而在目前技術上大多會利用相機作為
校正的輔助工具。 
如[4][5][6][7][8][9][10]，這些技術皆
是以相機作為量測工具，量測幾何上的扭
曲及色彩上的差異，進而利用影像處理與
電腦視覺的技術，對輸出的影像作幾何與
色彩上的補償，以達到無接縫的目的。 
在互動內容方面，特效系統一直是提
供豐富、華麗視覺效果的有效工具，而其
中又以粒子系統最能產生複雜多變的感
官經驗。1960年代，電子遊戲產業的萌芽
時期，就有遊戲嘗試使用粒子系統來模擬
爆炸效果。然而一直到1983年才有人提出
第一篇關於粒子系統的論文[13]。在那之
後，粒子系統便被廣泛地應用在遊戲，動
畫等數位內容產業。近年來，隨著繪圖處
理器(Graphic Process Unit : GPU)的進
步，許多研究開始將繪圖處理器應用在繪
圖之外的運算處理，而粒子系統正是其中
的一個應用。[15][16][17]利用新世代繪圖
處理器的可程式化(Programmable)能力，
將粒子系統的狀態更新以及繪圖流程完
全移植到繪圖處理器上處理，此舉不但提
升了系統能即時運算的粒子總數，也可將
中央處理器(Central Process Unit : CPU)
的運算資源留給系統的其他模組使用，大
幅提升系統整體效能。 
 
操控介面部分 
近幾年來，由於運算裝置的小型化與
效能的大幅提升，以及感測、顯示設備的
大幅進展，讓普及運算（ ubiquitous 
computing）的概念為數位環境的操作者
帶來更直覺的互動空間與情境。 
任天堂公司於2006年推出家用遊戲
主機  - Wii，特色是它的控制器 -Wii 
Remote[11]。Wii Remote具有指向定位及
動作感應之功能，指向定位功能需要配合
IR感應器位置校正後，即可當作光線槍或
滑鼠一般可以控制的游標，動作感應功能
可偵測三維空間當中的移動及旋轉。可同
時配合指向定位及動作感應之功能，偵測
使用者之手勢動作(圖二)。Wii Remote在
遊戲之中可以當作球棒、指揮棒、鼓棒、
釣魚桿、方向盤、劍、槍、手術刀、鉗子
等工具，使用者可以揮動、甩動、砍劈、
突刺、迴旋、射擊等各種方式來使用。 
 
 
圖二 Wii Remote 操控功能 
 
 
圖三 Wii Fit 使用畫面 
 5 
 
出來。透過粒子濾波器之技術追蹤手勢動
作。系統流程圖如下圖七所示。在圖七
中，我們先將拍攝到的影片透過立體攝影
機取出彩色影像和深度影像。而彩色影像
的部分主要是用來偵測人臉的位置，並將
幾何人體模型之臉移至於人臉的位置。取
出深度影像後，可以以人臉的深度為基
礎，將人臉後面的深度資訊拿掉，以得到
人體剪影的深度影像。另外彩色影像也可
以用於膚色偵測，得到膚色影像。並與前
景深度影像作＂和運算＂便可以得到手
部的深度資訊。最後透過粒子濾波器偵測
追蹤手肘以及手掌之位置。 
 
 
圖七 基於幾何模型之三維人體手勢追
蹤技術流程圖 
 
 
(a) 
 
(b) 
圖八 手勢追蹤之過程: (a) 為手掌放在
虛擬按鈕上面。 (b) 按下虛擬按鈕 
 
圖八為利用幾何模型之三維人體手勢追
蹤技術按下虛擬按鍵之過程，其中圖八(a)
的部分為當手掌擺在按鈕上時的追蹤結
果。圖八(b)的部分為按下按鈕後之過程。 
 
 虛擬按鈕 
在學習太極拳的過程中，以手持式裝
置來操作選單介面的設計顯然相當地不
方便。因此我們開發了以電腦視覺方法驅
動的虛擬按鈕來取代手持式裝置。操作
上，使用者無需配戴其他操控裝置，只要
透過攝影機揮手碰一下按鈕，就可直接在
三維的空間中，操控虛擬按鈕選單。 
觸發方式的實作上， 我們透過上述
之基於幾何模型手勢追蹤技術，所得到手
掌之三維空間位置來判斷是否有按下虛
擬 按 鈕 以 及 是 否 拖 曳 虛 擬 進 度 棒
(progress bar)。 
 
 生理訊息偵測系統 
本系統使用壓力感測器(pressure 
sensor)與生理感知儀器(ProComp)，分別
偵測使用者腳部的支撐力道與胸腹式呼
吸資訊。並依據將此資訊儲存於資料庫系
統之中，方便使用者於學習後的檢視及修
正。 
本子計畫在研究方法的部份，與其他
子計畫及總計畫的關聯性如下： 
 子計畫三會將學員目前練習的套路
完整資訊傳送至總計畫的多媒體資
料庫，本子計畫所開發的全方位投影
系統便可透過多媒體資料庫，得知學
員下一個動作面向的方位，以便適當
顯示虛擬教練與學員的畫面，  
 本計畫與子計畫三在評量學員狀態
時，會分別計算學員的生理動作狀態
與教練指標之差異量，並藉由本子計
畫透過多媒體回饋提示學員需要改
進的地方(例如以不同的色階顯示在
畫面中需要改進的身體部位上)。 
 總計畫建置的資料庫根據目前學員
的狀態，提供相對應的太極拳要訣、
「虛擬教練」的腳步以及生理資訊，
交由子計畫四呈現在適當的畫面。 
 本子計畫的操作介面可供學員控制
總計畫的多媒體資料庫，調整環境提
供的教學內容，並可以讓學員自由檢
視多媒體資料庫中的學習過程紀錄。 
 7 
 
做高斯模糊(Gaussian Blur)以及影像差
集(Image Difference)等前處理取得影
像的模糊外框。接著我們在前景影像取樣
一些點並放上斥力，避免粒子更新狀態時
跑進前景影像裡。而對影像的模糊外框，
我們以同樣的方法在上面取樣，當成發射
極產生粒子的位置，並且加上吸力，確保
粒子只在前景周邊運動。圖十三為系統在
前景跟模糊外框取樣後，放置吸力跟斥力
的位置。 
粒子系統每次接收到子計畫一處理
過後的前景影像，都會重新取樣出新的發
射極和力來取代掉原有的。新的發射極會
產生出新的粒子，但舊的粒子仍會存活在
場景上，繼續受到新取樣出來的力影響，
經過一段時間才漸漸淡化消失。 
 
圖十二 粒子系統流程圖 
 
 
圖十三 由前景跟模糊外框取樣出來的點 
紅點為斥力，綠點為吸力 
 
最後，我們利用OpenGL將粒子畫出
來，輸出成粒子影像，並以加色法
(additive blending)將原始影像，粒子
影像，以及模糊外框作混色，達到在使用
者身體周邊產生光暈，且有「氣」在流動
的視覺效果。圖十四為合成出來的最後結
果。 
系統實作部分 
在系統實作上，為了達到更好的效
能，我們使用新世代的繪圖處理器
(Graphic Process Unit : GPU)來加速粒
子系統的更新以及繪圖。現有的研究中，
[15]，[16]，[17]皆是以繪圖處理器實作
粒子系統的例子。 
 
 
圖十四 結果放大圖 
 
用繪圖處理器實作粒子系統的好處
有二：第一項好處是繪圖處理器的效能提
升，在近年來的發展遠遠快過中央處理器
(Central Process Unit : CPU)，現今繪
圖處理器能處理的運算量已經高過中央
處理器幾十倍。加上繪圖處理器的硬體架
構非常適合拿來作平行計算，正好符合粒
子系統每個粒子獨立更新狀態的運作方
式。 
第二項好處則是，照傳統作法，粒子
系統的更新是在中央處理器運算，要繪圖
時才將粒子系統的資料傳到繪圖處理器
輸出影像，從中央處理器到繪圖處理器中
間的傳輸頻寬，往往是造成系統效能下降
的主要瓶頸。而將粒子系統的更新以及繪
圖部分都放在繪圖處理器上處理，就省卻
了這中間的傳輸過程，頻寬不足的問題也
因此不復存在。 
另外，在影像上取樣，找出要放置發
射極跟力所在位置的方法，我們並非使用
一般的等距取樣(Uniform sampling)，而
是使用所謂的藍色雜訊取樣(Blue noise 
sampling)[12]。等距取樣的缺點在於它
 9 
 
 
圖十九 呼吸狀態顯示 
 
因為本系統採用呼吸感測器來偵測
呼吸情況，所以需要在使用之前先做校
正。校正的部分包括了呼吸感測器拉長長
度校正和使用者呼吸偵測量校正兩部分： 
 
呼吸感測器拉長長度校正： 
因為原始感測數值為電阻值變化，隨
著感測器伸長量越長，電阻值越大，所以
我們希望經由電阻值 /伸長量的校正之
後，能得知呼吸感測器的拉長長度資訊，
藉此瞭解使用者的胸腔或腹腔的呼吸擴
張長度（圖二十）。  
 
 
圖二十 呼吸感測器拉長長度校正 
 
本系統的校正流程如為：由呼吸帶拉長長
度為11cm開始，每格1cm讀取一個此長度
的電阻值，並記錄下來，依序讀到23cm
為止。之後再依照此電阻/伸長量表格，
將電阻數值轉換成伸長量長度。 
使用者呼吸偵測量校正: 
使用者穿戴此呼吸感測器的鬆緊程
度，會影響到偵測到的伸長量數值，所以
我們設計了一個呼吸偵測量校正的步
驟，方便使用者以最合適的穿戴緊度，讓
呼吸範圍值最大。此校正流程如下： 
 
1.使用者先以自己覺得適當的緊度穿戴
呼吸感測器 
 進行胸式呼吸帶的校正  
 系統偵測使用者此時的動態呼吸
範圍  
 使用者先以自己覺得舒適的
緊度穿著智慧衣  
 開始進行校正，動態記錄呼吸
範圍 
 先以目前的緊度偵測一次
呼吸範圍數值  
 若範圍太小，系統則顯示訊
息，要使用者緊度調緊一
格，偵測一次呼吸範圍。緊
度調緊兩格，並再偵測一次  
 若範圍在標準大小內 ，系
統則顯示訊息，要使用者緊
度調緊一格，偵測一次呼吸
範圍。緊度放鬆兩格，並再
偵測一次  
 取這三次的呼吸範圍最大
值，並要求使用者將緊度調整
至那一格  
2.進行腹式呼吸帶的校正 
 步驟如同胸式呼吸帶的校正  
 
3. 計畫成果自評 
在本計畫中的第三年度，我們整合了
前兩年所發展智慧型太極拳學習環境的
學習流程(包含了使用者辨識及登入機制)
與介面設計、虛擬按鈕、粒子系統與生理
訊息偵測系統，以及第三年所提出之三維
手勢辨識之技術使得使用者更方便的操
控本系統之課程選單和步行偵測之系
統。這些結果均可提供使用者一個有效且
便利之智慧型太極拳學習環境。 
本計劃的貢獻在於結合電腦視覺方
法與粒子系統作為太極拳學習環境的界
面呈現，並以虛擬按鈕作為學員的輸入方
式，以及在學習過程中接收與比對學員的
生理資訊，來輔助學員動作學習的正確
 11 
 
IEEE Intl. Wkshp. On Automatic Face 
and Gesture Recognition, pp. 179-183, 
1995. 
[21]K. Tollmar, D. Demirdjian, T. Darrell, 
“Navigating in virtual environments 
using a vision-based interface,” Nordic 
Conference on Human-Computer 
Interaction, Vol. 82, pp. 113-120, 2004. 
 
 
