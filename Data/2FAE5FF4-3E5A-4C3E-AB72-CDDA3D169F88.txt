與棋子的影像後，對該影像作基本影像處理，包括灰
階統計圖計算、最佳臨界值選擇及二值化處理。接下
來進行影像分割，影像分割乃是將棋盤影像中欲判讀
的象棋棋子的影像分割出來，分割後的棋子影像上的
字型再用細線化來處理，依每個棋子字型線條特徵的
不同，取得代表每個棋子的特徵。並運用倒傳遞類神
經網路所能接受之特徵向量模式的訊號來將棋子特
徵向量編碼，用以訓練倒傳遞類神經網路來辨識象棋
棋子。 
將影像處理得到的棋子類別與棋子位置，與機
械臂的運動控制結合，完成可以與人下象棋的機械
臂。本計畫的實驗系統；包括系統架構、影像視覺系
統與象棋棋子辨識的處理過程。關於應用影像視覺伺
服來控制機械臂的方法；包括攝影機座標與機械臂座
標轉換，及影像為基礎的視覺伺服系統、影像伺服控
制的求法及視覺伺服系統的架構。 
 2
 
三、機械臂影像伺服控制 
本研究的實驗系統如圖 1 所示，象棋棋盤經由
CCD 取像辨識後，結合電腦象棋程式，以象棋程式
輸出棋子走位為控制命令，配合影像視覺伺服控制機
械臂夾象棋走位。用到的設備包含了有 CCD 攝影
機、影像擷取卡、五軸的機械臂、個人電腦及介面卡。 
 
 
 
 
 
 
 
 
圖 1 系統架構示意圖 
 
機械臂的影像視覺伺服控制如圖 2 所示。將象棋
程式輸出棋子走位的命令轉成各軸馬達的控制命
令。機器臂的位置經 Encoder 及解碼器由 PC 讀取，
再與馬達的控制命令比較，得到的誤差訊號用 D/A
卡輸出，經馬達驅動電路控制馬達驅動機械臂移動到
命令的位置。 
 
影像視覺系統 
 由 CCD 攝影機擷取影時，設計可以判讀中
國象棋棋子類別及在棋盤上的位置的影像視覺系
統，會應用到的影像處理技術，可分為三個部份。
(一)將象棋棋盤影像由 CCD 攝影機取像輸入後，
以 灰 階 統 計 圖 (Histogram) 找 出 最 佳 臨 界 值
(Threshold)，將影像二值化(Image Binary)，並除去
雜訊做為影像判讀的前置處理；(二)影像分割
(Segmentation)；此部份是影像判讀處理中最重要
的部份，因影像分割除了可以知道棋子所在的位
置外，也會影響後面判讀的正確性，影像分割是
如何運用特徵偵測的方法，將象棋影像中的棋子
影像分割出來，以利後續的辨識。(三)棋子辨識處
理:為了增加棋子影像的特徵，將自動分割後欲判
讀的棋子影像進行細線化、Hough 轉換等處理，
來得到棋子影像的特徵，象棋棋子的 12 個中文
字，皆具有個別線條特徵，不致互相矛盾。再用
倒傳遞類神經網路來辨識棋子影像的特徵，因
此，可以達到判讀象棋棋子的種類及在棋盤上的
位置的目的，象棋棋子辨別的的處理流程如圖 3
所示。 
 
 
 
 
 
 
 
 
Encoder
Robot
影像卡PC讀取棋子辨識象棋程式
棋子走位轉
成各軸馬達
控制命令
D/A卡
解碼電路D/A轉換
馬達驅動
電路
CCD
各軸
馬達
圖 2 機械臂控制架構圖 
CCD
棋盤
Robot
影像擷取卡
pc
棋子辨識
象棋程式
影像視覺處理
馬達驅動器
控制機械臂馬達
運動控制訊號 影像訊號
D/A卡
機械臂運動控制 
 本研究所採用的機械臂為五軸旋轉型機械臂，
其外觀如圖 4 所示。機械臂每個轉軸皆由直流伺服
馬達所驅動，各轉軸有增量型編碼器，經由解碼電路
即可讀取各轉軸位置的資料。機械臂的機構是由數個
連桿(Link)透過連桿關節(Joint)，相互連接而成，最
後則是在最前面的連桿上連接一個末端夾子
(End-Effector) 
 
象棋棋盤影像輸入擷取
灰階統計圖
最佳臨界值之選擇及二值化
影像分割及細線化
Hough 轉換  樣板比對、  
類神經網路辨識系統
輸出判讀結果並解釋
         圖 3 象棋棋子辨識處理流圖 
圖 4 中機械臂各部名稱如下：h 為基座高度，S
為肩位置，E 為肘位置，W 為手腕位置，H 為夾子末
2
0
2
032221 )](2
cos[sin ZXll +=++−+ θθππθ (4) 
及      
))]((
2
[
2 324
θθππππθ +−−−−=
)()(
22 3232
θθπθθππππ +−=+−+−−= (5) 
由式(5)得： 
21
2
0
2
0322 sin)](2
cos[ θθθππ lZXl −+=++− (6) 
 
h
sY
0Z
1l
2l
3l
2θ
2θ
3θ
4θ
3lh −
2
0
2
0 ZX +
))((
2 32
θθππ +−−
)( 32 θθπ +−
棋子位置
[ ]Tzx 00 0  
圖 6 機械臂三軸連桿的側視分析圖 
 
由圖 7 的幾何關係得： 
213322 cos)](2
sin[ θθθππ llhl +−=++− (7) 
及 
2
321
2
21
2
0
2
0
2
2 )cos()sin( lhllZXl −++−+= θθ (8) 
將式(8)展開得： 
++−++= 2120202221202022 sin2sin θθ lZXlZXl
2132
22
1
2
3 cos)(2cos)( θθ llhllh −++− (9) 
整理式(9)得：
21
2
0
2
0213
2
3
2
1
2
0
2
0
2
2 sin2cos)(2)( θθ lZXllhlhlZXl +−−=−−−−− (10) 
可以將式(10)看成是 22 sincos θθ CBA −= 的組
合，利用疊代方法求得 2θ 。 2θ 求得後，由(5)式得知
3θ ，再分別由(6)式、(3)式得知 4θ 、 1θ 的值。因象
棋棋子為圓形，末端夾子 5θ 於任何方向均可以夾起
象棋棋子，故 5θ 可以設定成任一值，為了控制方便，
將 5θ 設定為零。 
路徑規劃 
玩象棋的機械臂的運動規劃如圖 8 所示。藉由攝
影機擷取棋子影像，分析棋子的位置，配合路徑規劃
資料庫，來控制機械臂移動棋子。若棋子所在位置辨
識錯誤，則棋子的移動路徑會超出路徑資料庫所規劃
的路徑，必須重新辨識，直到移動的路徑與路徑資料
庫的路徑相同，才輸出機械臂的控制命令，讓機械臂
移動棋盤上的棋子。 
現在以包吃仕為例來說明徑資料庫的規劃。為了
簡化控制計算，實際操作時將 4θ 設為 ，因此用式
(3)至式(10)求得包吃仕的路徑的各轉軸角度如表 1。
包吃仕的路徑配合圖 8 說明如下，對手棋子仕被判離
盤，機械臂由起始位置
A  
090
,0,0,0,0( 04
0
3
0
2
0
1 ==== θθθθ
)05 =θ 移動到仕的位置
B 夾起棋
子仕至棋子離盤後的歸位位置
C )，放下棋
子仕，再移動到包的位置
D ，將
包移到 B 的位置後回到起始位置 A。其他所有可能的
棋步的路徑規劃的方式大致相同，將所有可能的棋步
路徑規劃後存於資料庫中作為控制機械臂的基本資
料。 
)0,90,5.41,5.48,0( 05
0
4
0
3
0
2
0
1 ===== θθθθθ
0,90,40,50,90( 05
0
4
0
3
0
2
0
1 ===== θθθθθ
)0,90,5.66,5.23,0( 05
0
4
0
3
0
2
0
1 ===== θθθθθ
 
No
No
下棋開始
輸入影像
二值化、影像分割、
細線化等影像技術
Hough 轉換、樣板比
對與特徵向量抽取
輸出判讀結果
Robot
是否執行initial
驅動 Robot
Yes
Yes
電腦象棋
路徑規劃結束
依路徑規劃
棋子移動是否
符合路徑規劃
圖 8 路徑規劃執行流程圖 
 
四、實驗規劃 
 實驗系統的架構如及相關位置圖 1 所示。於棋盤
右下方設計＂棋子歸位＂作為被判離局的棋子的存放
處，實驗前先用馬達驅動電路的手動操作功能；移動
機械臂是否可以夾到棋盤上的任一棋子，藉手動操作
來設定機械臂各軸的起始位置。起始位置包含了棋子
的夾取點，棋子被夾取上升時機械臂各軸位置，棋盤
原點與機械臂的固定位置等。然後，將這些起始點建
立在路徑規劃的資料庫中。程式開始時先作 D/A 卡及
 4
