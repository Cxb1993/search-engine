2 
D-EWMA 控制器修正漂移現象，並且與
PCC和EWMA控制器的效能做比較。Wang
等人[6]探討在蝕刻製程中因為蝕刻率會隨
時間產生遞減的情況，利用遞迴最小平方
法(Recursive Least Square, RLS)估計製程
的參數，以調整蝕刻時間來達到所要的蝕
刻深度。Tseng 等人[7]針對具有漂移干擾
之 製 程 提 出 (Initial Intercept Iteratively 
Adjusted ,IIIA) 的 控 制 方 式 ， 其 結 合
D-EWMA 與 RLS 兩種方法估計製程參
數，並與 D-EWMA 控制器作比較，在 SISO
的製程中 IIIA 控制器能快速修正漂移干擾
所造成的製程變異。Good 和 Qin[8]分析
MIMO D-EWMA 控制方法在有量測延遲
與模型誤差時的穩定性，並提出在製程有
固定漂移干擾時控制參數的選擇方法。
Wang 和 Peter[9]提出(Bayesian enhanced 
EWMA ,B-EWMA) 的控制方法應用在
(Low Pressure Chemical Vapor Deposition, 
LPCVD)製程並與 EWMA 的控制方法作比
較，以提高製程良率。Chen 等人[10]針對
金屬濺鍍製程，利用控制器使得金屬薄膜
在製程中穩定的製作，並運用時間序列分
析(Time Series Analysis)與預測的方法，預
測下一個時間點的製程干擾，藉由調整輸
入項，使其沈積率都維持在製程沈積率的
目標上。Chen 等人[11] 針對金屬濺鍍製
程，將時間序列之製程模型轉換為狀態空
間形式，利用延伸卡曼濾波器(Extended 
Kalman Filter)同時估計沈積率與更新製程
模型參數，並解決非等間距量測資料時，
預測靶材沈積率的方法。由於上述所提出
的控制理論皆是對單一機台、單一產品的
批次即時監控的策略，Pasadyn 等人[12]提
出混貨製程的適應控制，區別製程干擾或
是混貨所造成的製程變異，藉以更新製程
的參數並補償製程的變異。Firth 等人[13]
提出在半導體製程中混貨的狀況下，提出
(Just-in-time Adaptive Disturbance 
Estimation, JADE)的控制方法估計分別因
為不同機台或產品所造成的製程干擾，快
速修正干擾所造成的製程變異，有效的降
低混貨製程中製程干擾所導致的影響。 
三、應用在混貨製程的批次控制方法 
3.1 Independent D-EWMA 控制方法 
在半導體製程中由於機器設備的磨
損、材料的消耗，通常會使製程輸出值隨
著批次增加，而慢慢偏離預設的目標值。 
D-EWMA [5]對於單一產品與單一機台製
程，能有效的將具有漂移干擾的製程輸出
控制在目標值。如要將 D-EWMA 應用於混
貨製程，可假設每一製程執行序為獨立製
程，如果混貨製程總共有 n 個執行序，則
每一執行序的製程模型可表示為:  
     , , 1, 2, , .i k i k i i,ky u k i nα β δ ε= + + × + = "  (1) 
其中 y 為製程輸出，u 為製程輸入，δ 為批
次飄移量，α 為截距項，β 為輸入靈敏度，
k 為批次，ε 為製程干擾，i 為執行序。控
制模型為:  
, . 1 , 1 ,ˆ         1, 2, ,i k i k i k i i ky a d b u i n− −= + + = "  (2) 
其中 a為α 的估計值，d 為δ 的估計值。每
當獲得一個輸出的量測值之後，使用指數
加權移動平均的方法來估計控制模型的截
距項 ka 與單位漂移量 kd ，其方法如下:  
( ) ( )( ), 1 , , ,1 , 1 , 11i k i k i i k i i k i ka w y b u w a d− −= − + − + (3) 
( ) ( ), ,2 , , , 1 ,2 , 11i k i i k i i k i k i i kd w y bu a w d− −= − − + −   (4) 
然後依據新的預測模型調整下一批次的輸
入值，使其預測值能達到目標值 T:  
, ,
, 1
i i k i k
i k
i
T a d
u
b+
− −=  (5) 
3.2 D-JADE 控制方法 
由於 independent D-EWMA 將混貨製
程每一執行序視為獨立製程，然而不同執
行序可能用到相同機台或生產相同產品，
因此將混貨製程每一執行序視為獨立製程
並不適合。Firth 等人[13]針對混貨製程的
問題，將各個可能造成製程變異的種類做
區分，分別估計因為不同產品或機台所造
成的干擾，並且依據其估計的干擾來補償
下一批次的製程干擾，但對具飄移特性的
混貨製程控制效果並不顯著，因此本計畫
改良其所發展的 JADE 控制器，增加一個
估計器來估計製程單位飄移量。假設真實
的製程模型為:  
k k k k ky u kβ= + + ⋅ +T TA α A δ ε  (6) 
其中 
[ ]1 2, , , Tma a a=α "  
[ ]1 2, , , Tmδ δ δ=δ "  
( ) ( ) ( )1 2 1[ , , , ]k m mA k A k A k ×=TA "  
α和δ 為個別項目如所有機台或產品所造
成的截距及單位飄移向量， ( )i kA  代表在
4 
改變，有逐漸增加或減少的情形。例如在
金屬濺鍍過程(Metal Sputter Deposition)金
屬鈀材的逐漸消耗，或化學機械研磨
(Chemical Mechanical Polishing, CMP)過程
機台的研磨墊磨損等，所造成沉澱或研磨
速度產生改變的現象。 
針對這種漂移干擾造成的變異，在模
擬的部份，在項目(A1)給予一單位漂移
量，大小為 0.0003，項目(A2)給予一單位
漂移量，大小為 0.0008，在 1β = , 1b = , 
0ku = , k∀ 時圖4選擇只包括A1項目的執
行序，圖 5 選擇只包括 A2 項目的執行序。 
圖 6 是四種估計方式在有小漂移干擾
之誤差平方和變化的情況。在針對不同漂
移量時四種估計方式之誤差平方和，漂移
量的大小由 0.005 到 0.05 如圖 7，由模擬結
果 得 知 在 漂 移 干 擾 的 混 貨 製 程 中
D-EWMA 的效能仍優於 EWMA。D-JADE
的估計效能更優於其他估計方式。 
4.2.3 控制器 
隨著不同的估計方法對製程干擾時所
預測的效能與其結果，在有位移或漂移干
擾的製程干擾下，可以明顯看出 D-JADE
和 JADE 的跳動比 D-EWMA 和 EWMA
小，在這是則只比較 D-JADE 及 D-EWMA
當有位移或漂移干擾的製程干擾下，加上
一控制器分別為運用 D-JADE 及 D-EWMA
這兩種製程方法來修正，使有製程干擾
時，能修正到初始(T=0)的最佳化製程控
制。 
4.2.3.1 位移修正 
針對這種製程變異，在模擬的部份選
擇其中一個項目(A1)，並在項目(A1)被使用
到第 250 次時給予位移量，大小為-0.05，
並與本文所提方法作一比較，在不考慮模
型誤差時，b β= 。在 1β = , 1b = , 0ku = , 
k∀ 時再加上一控制器使其修正，選擇只包
括 A1 項目的執行序，其中圖 8 為使用
D-JADE控制器修正，圖9為使用D-EWMA
控制器修正，橫軸為製程的批次數由 1 到
1000，縱軸為截距項，state 為製程模型的
截距項。 
並比較修正後有位移干擾之誤差平方
和的值如圖 10，而表 3 為兩種估計方式在
有位移干擾誤差平方和值。由模擬結果可
以比較出在含有控制器修正時隨著單位位
移量增加時，D-EWMA 的誤差平方和增加
速度比 D-JADE 還要明顯。 
4.2.3.2 漂移修正 
針對這種漂移干擾造成的變異，在模
擬的部份，在項目(A1)給予一單位漂移
量，大小為 0.0003，項目(A2)給予一單位
漂移量，大小為 0.0008，在 1β = , 1b = , 
0ku = , k∀ 時再加上一控制器使其修正，
圖 11 為選擇 A1 及 A2 項目執行序使用
D-JADE 控制器修正，圖 12 為選擇 A1 及
A2 項目執行序使用 D-EWMA 控制器修
正。圖 13 是兩種估計方式在有小漂移干擾
之誤差平方和變化的情況。表 4 為兩種估
計方式在有小漂移干擾之誤差平方和值。
由模擬結果得知在漂移干擾含有控制器修
正時的混貨製程中 D-JADE 的效能仍優於
D-EWMA。 
4.2.3.3 量測延遲 
量測延遲為每一批次機台的輸出值無
法在下一批次前得到量測結果，而延遲的
時間則取決在量測所需要時間的長短。 
針對漂移干擾模擬的部份，在 A1 項目
給予一單位漂移量大小為 0.0003，A2 項目
給予一單位漂移量大小為 0.0008 的干擾，
模擬量測資料落後製程 3 批次的控制結
果，圖 14 為只包含 A1 項目執行序的估計
值與批次的變化圖，圖 15 為只包含 A2 項
目執行序。圖 16 是兩種估計方式在有小漂
移干擾之誤差平方和變化的情況。圖 17 為
選擇A1及A2 項目執行序使用D-JADE控
制器修正。圖 18 為選擇 A1 及 A2 項目執
行序使用 D-EWMA 控制器修正。 
五、結論 
從前一章的推導及模擬結果，當混貨
製程有位移干擾時，D-JADE 與 JADE 因可
以將干擾分配到當批次所使用的機台或產
品，所以比 EWMA 與 D-EWMA 的預測績
效更好。當混貨製程有漂移干擾時，
D-EWMA 在較大的單位漂移量時，由於有
兩個演算法，一個用來估計截距，另一個
用來估計截距的漂移量，因此能有效估計
漂移干擾的影響。 
由模擬的結果可以歸納出以下結論: 
1.在相同條件下，面對漂移干擾的製程，
D-JADE 的估計方式能有效估計漂移干
擾對製程所造成的變異，因此比 JADE
更能有效的將製程控制在穩定的狀態。 
6 
 
表 1 製程模擬各個項目出現的機率[21] 
項
目 A1 A2 B1 B2 C1 C2 D1 D2
機
率 0.4 0.6 0.9 0.1 0.5 0.5 0.2 0.8
 
表 2 估計器的權重 
 
表 3 在位移干擾時有控制器修正之誤差平
方和 
 
表 4 在小漂移干擾時有控制器修正之誤差
平方和 
 
 
 
圖 1 位移干擾時估計值與批次的變化圖 
 
 
圖 2 位移干擾時誤差平方和與批次的變化
圖 
 
 
圖 3 誤差平方和與不同位移干擾時的變化
圖 
 
 
 
圖 4 小漂移干擾時估計值與批次的變化圖
(只包含 A1 項目的執行序) 
 
 
估計器 權重值 1 權重值 2 
EWMA 1 無 
D-EWMA 1 0.1 
JADE 1 無 
D-JADE 1 0.1 
估計器 D-JADE D-EWMA 
誤差平方和 0.00600 0.02066 
估計器 D-JADE D-EWMA 
誤差平方和 0.00362 0.08746 
8 
 
圖 11 漂移干擾修正後(D-JADE)與批次的
變化圖 
 
 
 
圖 12 漂移干擾修正後(D-EWMA)與批次
的變化圖 
 
 
 
圖 13 小漂移干擾時誤差平方和與批次的
變化 
 
 
 
圖 14 量測延遲小漂移干擾時估計值與批
次的變化圖(只包含 A1 項目的執行序) 
 
 
 
圖 15 量測延遲小漂移干擾時估計值與批
次的變化圖(只包含 A2 項目的執行序) 
 
 
 
圖 16 量測延遲小漂移干擾時誤差平方和
與批次的變化 
 
 
  
行政院國家科學委員會補助專題研究計畫 █ 成 果 報 告   □期中進度報告 
 
半導體混貨製程之製程干擾預測與控制(I) 
Disturbance Estimation and Process Control 
for Mix-product Semiconductor Processes (I) 
 
計畫類別：█ 個別型計畫  □ 整合型計畫 
計畫編號：NSC 96－2221－E－216－005 
執行期間： 96 年 8 月 1日至 97 年 7 月 31 日 
 
計畫主持人：陳俊宏 
 
計畫參與人員：張偉麒、蔡順安 
 
 
成果報告類型(依經費核定清單規定繳交)：█精簡報告  □完整報告 
 
 
處理方式：除產學合作研究計畫、提升產業技術及人才培育研究計畫、列
管計畫及下列情形者外，得立即公開查詢 
          □涉及專利或其他智慧財產權，□一年□二年後可公開查詢 
          
執行單位：中華大學機械工程學系 
 
 
 
 
中   華   民   國 97    年   10  月  24   日 
附件一 
