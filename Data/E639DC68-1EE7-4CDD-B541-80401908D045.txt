 半導體電鍍設備之上下料機電系統研究
 
Development of the Load/Unload System for Electro Plating of the 
Semiconductor Application 
 
計畫編號：NSC－94－2622－E－033－007－CC3 
執行期間：94年5月1日至95年4月30日 
主持人：丁鏞        中原大學機械系所 
計畫參與人員：查厚錦、陳志和、楊傑閔中原大學機械所 
 
一、 中文摘要 
本文主要研究為建立可運用於半導
體製程之電鍍段中同時具有速度追蹤及
定位精度的馬達系統。在速度迴路中使用
擾動觀測器對於馬達本身的參數不確定
性及外界對系統的擾動影響進行排除，並
於位置迴路中設計PD控制器建構一漸近
穩定的閉迴路回授系統，但由於擾動觀測
器(Disturbance observer)無法將馬達中高
頻的阻滯力(cogging force)完全排除而使
得系統產生顫震的現象，但此阻滯力可視
為一週期性的擾動，因此在位置迴路中再
加入重複性控制器(Repetitive Controller)
以抑制擾動帶來的影響。此外，為了提昇
高速與高精度的定位及軌跡追蹤性能，在
閉迴路外加入零相位誤差追蹤控制器
(zero phase error tracking controller, 
ZPETC 作為系統的前饋控制器。整體控
制架構由擾動觀測器及重複性控制器提
供對於外擾的強建性，再以 PD 控制器使
得系統得以成為一漸進穩定的系統，最後
再由前饋控制器提昇整體系統的軌跡追
蹤性能。經由實驗驗證，本系統能於馬達
轉速為 3000rmp 下，進行半徑為 50mm
的循圓實驗，能有效地抑制阻滯力的影響
及閉迴路相位落後的問題，且定位精度可
達到 10µm。 
 
二、 前言 
在運動控制中，XY平台是非常常見
的伺服機構，運用伺服馬達透過滾珠螺桿
來驅動負載，以達到精密定位之目的。其
中使用於馬達控制法則之發展十分蓬
勃，在一些使用上其負載、摩擦係數、驅
動馬達電阻等非為已知或恆定，系統須有
參數鑑別(system identification)來補償或
具有抗異特性；此類控制方法在伺服馬達
系統上使用甚多，諸如前饋軌跡規劃、參
考模式適應控制(model reference adaptive 
control, MRAC)、滑動控制(sliding mode 
control)、H2或H∞強健控制(robust control)
等。在運動控制中，兩個主要的系統不確
定性來源，為包括靜摩擦力、庫倫摩擦
力、及黏滯摩擦力等的摩擦力，與慣性質
量。尤其是靜摩擦力與庫倫摩擦力，此二
者為速度的函數，而一般的線性控制理論
無法有效地處理，因此必須對系統加入摩
擦力的補償，而對於需相當精度之系統的
摩擦力補償可由離線(off-line)的實驗中
得到。1995年，Ma等提出當joint的加速
度是可以量測時，可以使用適應控制
(adaptiv control)配合Lyapunov法消除終
端  (end-effector)的位置誤差及速度誤
差。而處理運動控制系統之擾動較好的方
法為擾動觀測器，且此擾動觀測器與摩擦
力補償並不互斥，因此可同時存在於系統
中。當擾動觀測器排除了主要的系統不確
行擾動因素的排除，並在位移回路中以
PD控制器(PD controller)建構一漸進穩定
的閉迴路回授控制系統。然而，由於馬達
具有的庫倫摩擦在運動方向改變之時，其
非線性的影響會非常的明顯，特別在循圓
時會產生「quadrant glitches」現象，此庫
倫摩擦力可視為一週期性的擾動，因此再
加入重複性控制器(repetitive controller)
以加強對擾動抑制的效能。另為提昇高
速、高精度的定位及軌跡追蹤的性能，在
閉迴路回授控制系統前加入零相位誤差
追蹤控制器 (zero phase error tracking 
controller,ZPETC)作為系統的前饋控制
器。故整體系統是經由擾動觀測器及重複
性控制器提供系統對擾動因素的強健
性，以 PD 回授控制器獲得一漸進穩定的
系統，再由 ZPETC 前饋控制器提昇整個
系統軌跡追蹤的性能。 
 
 速度迴路的擾動觀測器 
 
由於系統模型之不精確，系統參數估
測的誤差，及外界環境干擾等因素之使
然，造成系統模型無論是以何種方式取
得，均無法維持其精確性。雖然 ZPETC
於系統性能追蹤上表現優秀，但對於系統
的不確定性及外部干擾不具有強建性，故
常在控制系統之中增加一擾動觀測器以
抑制外部干擾 d ，使得u 對 q之轉移函數
近似於 ( )sPn ，ZPETC 即可依據 ( )sPn 來
設計。擾動觀測器之架構由 Umeno 及
Hori 提出。擾動觀測器之工作流程方塊
圖如圖 2 所示。其中 )(sP 為實際系統(控
制命令輸入相對於速度輸出)之轉移函
數， )(sPn 為估測之轉移函數 (nominal 
plant)，d 為進入系統之干擾源，dˆ 為 d 之
估測值，u 為系統之輸入控制命令，ξ 為
量測雜訊。為了解干擾觀測器之運作情
形，首先假設 ( ) 1=sQ ，則估測干擾 dˆ 可
由(1)式表示。 
( )
P
d
P
P
PP
Pd
P
Pdud
n
nnn
ζ
ζ
++





−=
++





+−−=
1
1ˆˆ
 (1) 
因此系統輸出值為 
( ) ζ−=+−= uPdduPq nˆ  (2) 
由式(2)得知，若能消除量測雜訊對系統
的影響，系統輸入值u 與輸出值 q之間的
關係即為 nominal plant 的轉移函數 nP 。
為了設計 ( )sQ 以清除量測雜訊ζ 對系統
之影響，故繪出圖 2 之等效方塊圖，如圖
3 所示。其中系統輸出值 q分別受到三個
輸入源：輸入命令 u 、外部干擾 d 、及量
測雜訊ζ 之影響，故先分別求得各個輸入
源至輸出值 q 之轉移函數，以做為設計
( )sQ 之依據。三個輸入源至輸出之轉移
函數分別如下。 
( ) ( ) ( )( ) ( ) ( )( ) ( )sQsPsPsP
sPsP
sG
nn
n
uq
−+
=   (3) 
( ) ( ) ( ) ( )( )( ) ( ) ( )( ) ( )sQsPsPsP
sQsPsP
sG
nn
n
dq
+−
−
=
1  (4) 
( ) ( ) ( )( ) ( ) ( )( ) ( )sQsPsPsP
sQsP
sG
nn
q
+−
=ξ  (5) 
故輸出值 q 可表示為 
( ) ( ) ( )ζζ sGdsGusGq qdquq ++=  (6) 
由圖 3 觀察可知，若將 ( )sQ 設計為 1，
則系統將無法實現，但若適當設計
( )sQ ，使 ( ) ( )sPsQ n 可以實現，亦即使得
( )sQ 之相對階數大於 ( )sPn 的相對階數，
則可達成擾動觀測器之需求，但除了上述
條件之外， ( )sQ 的設計尚須能夠消除量測
雜訊對系統的響應。若設計 ( ) 1≈sQ 時，
則 ( ) ( )sPsG nuq = ， ( ) 0≈sGdq ，
( ) 1−≈sG qξ ，亦即在低頻時選擇使 ( )sQ 之
增 益 值 為 1 ， 則 式 (6) 可 改 寫 為
ζ−= uPq n ，得由此可得知擾動觀測器可
以抑制外部干擾。此外，若 ( ) 0≈sQ 時，
期干擾。重複性控制器由 Tomizuka 提
出，可有效地降低特定頻率對於系統之影
響，增加系統增益。而為消除週期性的干
擾，必須產生一相同週期的週期訊號，此
為重複性控制器之基本原理。其中由
Francis 及 Wonham 提出之內部模型理論
可知，欲完成一重複性控制器，必須包含
一重複訊號產生器 (Repetitive signal 
generator)。對於己知週期之週期訊號，
可由時間延遲配合正回授方式產生。 
本系統的控制目的在於設計一個控
制命令 ( )ku 使得系統趨於漸近穩定，並使
系統的誤差收斂至零，即 ( ) 0lim =
∞→
ke
k
。當
誤差訊號收斂為零時，重複性控制器必須
能產生一個重複性的控制訊號，即代表此
重複性控制器中必須包含一重複訊號產
生器。故本重複性控制器採用內部模型理
論為基礎的重複性控制器。將重複性控制
器加入系統之中，系統方塊圖如圖 4 所
示。 ( )1−zGrep 可設計為式(10)所示。 
( ) ( ) ( )( ) ( ) ( )[ ]21
11
1
11 ucN
uN
r
rep
BzBz
zBzAzk
zG
−−
−−−
−
⋅−
⋅
=  (10) 
其中 rk 稱為重複控制增益， ( )1−zB c 閉迴
路系統中可對消的部份， ( )1−zB u 為不可
消的部份。 ( )1−zGrep 中 ( ) ( )( ) ( )[ ]21
11
1uc
u
BzB
zBzA
−
−−
部份
即為一零相位誤差追蹤控制器。 
 
 零相位誤差追蹤控制器 
 
回授控制器雖然能確保系統之穩定
度並改善暫態響應，但其運作的原理是根
據誤差訊號加以補償，所以會產生相位落
後的缺點，其中為了改善相位落後，提昇
高速、高精度的定位及軌跡追蹤的性能，
在閉迴路回授控制系統前加入零相位誤
差追蹤控制器(ZPETC)作為系統的前饋
控制器為一般最常見的手法，由於前饋控
制器是建立在閉迴路轉移函數之逆算基
礎之上，因此對於任何輸入均能得到極為
接近的輸出。 ZPETC 於 1987 年由
Tomizuka 提出，用以消除閉迴路系統相
位落後現象。其設計的理念是基於極零點
對消的觀點，對於具有不穩定零點的系統
時，零相位誤差追蹤控制器可以將這些零
點產生的相位移加以補償。其架構圖如圖
5 所示。在未加入前饋控制器時，閉回路
的輸入為 ( )kr ，輸出為 ( )ky ，其關係為式
(11)所示 
( ) ( ) ( )krzGky closed ⋅= −1   (11) 
若 ( )1−zBc 沒有不穩定的零點，則 ( )kr 可由
ZPETC 前饋控制器產生， ( )kr 設計為 
( ) ( )( ) ( )dkyzB
zA
kr b
c
c +⋅=
−
−
1
1
  (12) 
其中 ( )dkyb + 為期望輸出命令 ( )kyb 之 d 階
領先命令，將 ( )dkyb + 帶入離散後之閉迴
路轉移函數可得 
( ) ( )( ) ( ) ( )kykrzA
zBz
ky d
c
c
d
=⋅=
−
−−
1
1
 (13) 
由 上 式 之 推 導 可 得 控 制 器 輸 出
( ) ( )kyky d= ，系統之輸出與期望輸出完
全相同。 
若在離散後之閉迴路轉移函數之
中，含有不可對消的零點時，前饋控制器
不可直接消除零點，因為這會造成控制器
不穩定，因此必須將 ( )1−zBc 分解成
( ) ( ) ( )111 −−− = zBzBzB ucacc ，其中 ( )1−zB ac 為
可接受的部份，即為穩定的根，而 ( )1−zB uc
為不可被接受的部份，即根位在單位圓之
外。 
所以閉迴路轉移函數可改寫為 
( ) ( ) ( )( )1
11
1
−
−−−
−
=
zA
zBzBz
zG
c
u
c
a
c
d
closed  (14) 
其中前饋控制器之轉移函數為 
( ) ( )( ) ( ) ( )( ) ( )[ ]21
1
1
1uc
a
c
u
cc
d BzB
zBzA
ky
kr
zC
−
−
−
==   (15) 
故 ( )kyd 到 ( )ky 之轉移函數為 
( )1−zG
c
( )1−zG
s
Nz−
( )zD
( )zR ( )zE +
−
++ +
+
( )zY
圖 4 重複性控制系統 
( )kyb ( )kr ( )ky( )1−zC ( )( )1
1
−
−−
zA
zBz
c
c
d
圖 5 ZPETC 系統方塊圖 
0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
0
10
20
30
40
50
60
time(sec)
v
el
oc
ity
(m
m
/s
ec
)
 
 
no DO
add DO
圖 6 加入擾動觀測器之實驗結果 
0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
5
10
15
20
25
30
35
40
45
50
55
time(sec)
v
el
oc
ity
(m
m
/s
ec
)
 
 
add DO
add DO+RP
圖 7 加入重複性控制器及擾動觀測器之實驗結果 
0  0.02 0.04 0.06 0.08 0.1 0.12 0.14 0.16 0.18 0.2  
-60
-40
-20
0
20
40
60
time(sec)
di
sp
la
ce
m
en
t(m
m
)
 
 
command
add PD
add DO+RP
add PD+DO+RP
 
(a)加入重複性控制器、PD 控制器及擾動觀測器之弦波
輸入響應圖 
0  0.02 0.04 0.06 0.08 0.1 0.12 0.14 0.16 0.18 0.2
-0.2
-0.15
-0.1
-0.05
0
0.05
0.1
0.15
time(sec)
di
sp
la
ce
m
en
t(m
m
)
(b)閉迴路系統誤差圖 
圖 8 加入重複性控制器、PD 控制器及擾動觀測器之實
驗結果 
0  0.02 0.04 0.06 0.08 0.1  0.12 0.14 0.16 0.18 0.2  
-60
-40
-20
0
20
40
60
time(sec)
di
sp
la
ce
m
en
t(m
m
)
 
 
command
ZPETC+close loop
(b)加入 ZPETC 於閉迴路系統之弦波響應圖 
0
-0.015
-0.01
-0.005
0
0.005
0.01
0  0.02 0.04 0.06 0.08 0.1 0.12 0.14 0.16 0.18 0.2
time(sec)
er
ro
r(m
m
)
(b)加入 ZPETC 之閉迴路系統誤差圖 
圖 9 加入 ZPETC 於閉迴路系統之實驗結果 
