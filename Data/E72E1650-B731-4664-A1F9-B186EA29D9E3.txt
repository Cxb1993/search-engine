目 錄
目 錄 i
圖 目 錄 iii
表 目 錄 vi
1 計畫摘要 1
1.1 中文摘要 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1
1.2 英文摘要 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2
2 運算最大相似度演算法在Inveon MicroPET影像重建研究 3
2.1 統計模型的建立與疊代演算法 . . . . . . . . . . . . . . . . . . . . . 4
2.1.1 相似度函數 . . . . . . . . . . . . . . . . . . . . . . . . . . . 4
2.1.2 最大相似度與均值最大化演算法 . . . . . . . . . . . . . . . . 4
2.1.3 序列子集均值最大化演算法 . . . . . . . . . . . . . . . . . . 6
2.1.4 列運算最大相似度演算法 . . . . . . . . . . . . . . . . . . . 7
2.2 實驗結果與討論 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8
2.3 結論 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
3 幾何因素對統計影像重建之影響 17
3.1 非數學幾何模型 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
3.2 系統的幾何模型設計 . . . . . . . . . . . . . . . . . . . . . . . . . . 18
3.2.1 內插法模型(Interpolative Model, I) . . . . . . . . . . . . . 18
3.2.2 面積法模型(Area-based model, A) . . . . . . . . . . . . . . 19
3.2.3 立體角模型(Solid-angle model, S) . . . . . . . . . . . . . . 20
3.3 實驗結果與討論 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21
3.4 結語 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22
i
圖 目 錄
2.1 A schematic diagram of ordered-subsets partition. . . . . . . . . . 6
2.2 Fontal view of an Inveon MicroPET. . . . . . . . . . . . . . . . . 7
2.3 Plots of log-likelihood functions for three iterative reconstruction
algorithms using (a) direct sinogram and (b) oblique sinogramwith
ring difference one. The reconstruction parameters for three al-
gorithms are: 32 iterations for MLEM; 4 subsets and 8 iterations
for OSEM; relaxation parameter 1.5, 4 subsets and 8 iterations for
RAMLA. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
2.4 Image results reconstructed by three iterative algorithms. Top and
bottom rows are the image results from the direct sinogram and the
oblique sinogram with ring difference one, respectively. Left, mid-
dle and right columns are the image reconstructed by using 32 iter-
ations for MLEM; 4 subsets and 8 iterations for OSEM; relaxation
parameter 1.5, 4 subsets and 8 iterations for RAMLA, respectively. 11
2.5 Plots of log-likelihood functions of OSEM with 20 iterations and
subsets 2, 4, 8, 20, and 40 for (a) direct sinogram and (b) oblique
sinogram with ring difference one, respectively. . . . . . . . . . . 12
2.6 Image results of the direct sinogram generated by using OSEM
with 20 iterations and subsets (a) 2, (b) 4, (c) 8, (d) 20, and (e)
40, respectively. . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
2.7 Image results of the oblique sinogram with ring difference one gen-
erated by using OSEM with 20 iterations and subsets (a) 2, (b) 4,
(c) 8, (d) 20, and (e) 40, respectively. . . . . . . . . . . . . . . . . 13
iii
3.7 Log-likelihood curve of point source phantom with uniform back-
ground. Point source on (a)original point P1, (b)off-center position
P2, (c)off-center position P3. . . . . . . . . . . . . . . . . . . . . . 25
3.8 Log-likelihood curve is driven by GATE simulation. (a)original
point P1, (b)off-center position P2, (c)off-center position P3. . . . 26
4.1 三隔室模型示意圖。血液和組織中自由的FDG與組織中FDG-6-PO4
的濃度分別為C∗P、C∗F和C∗M，常數為k∗1、k∗2、k∗3和k∗4。血液和組織中
自由的葡萄糖與組織中glucose-6-PO4在此三個隔室的濃度則分別
為CP、CF和CM，其速率常數為k1、k2、k3和k4。 . . . . . . . . . . 28
4.2 輸入函數、輸出函數與系統參數(速率常數)之間關係的示意圖。根
據C∗T與C∗P間的關係，速率常數k∗1、k∗2、k∗3和k∗4便可以利用非線性迴歸
分析法來計算。 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30
4.3 C∗P (t)為血液的時間-活度曲線 (p-TAC)。血液中的FDG濃度會在t0內
達到最高值，接著以指數衰減的方式慢慢下降。 . . . . . . . . . . . . 31
4.4 組織活度曲線。(a)由連續造影程序得到影像後，(b)根據某一特定部位
(ROI或是像素)活度隨時間的變化作記錄，可以得到組織的時間活度曲
線(t-TAC)。 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32
4.5 高訊雜比之模擬。patient LS；使用WLM；mean SNR = 3.221 (SD
= 0.1)。 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38
4.6 高訊雜比之模擬。patient LS；使用LM；mean SNR = 3.220 (SD =
0.1)。 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38
4.7 低訊雜比之模擬。patient LS；使用WLM；mean SNR = 1.823 (SD
= 0.5)。 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40
4.8 高低訊雜比之模擬。patient LS；使用LM；mean SNR = 1.824 (SD
= 0.5)。 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40
v
Chapter 1
計畫摘要
1.1 中文摘要
利用正子標定之分子造影藥物，結合動物實驗用微型正子掃描儀，為當代活體生理功
能的利器，在基礎生命科學研究上扮演重要的角色。子計劃二『心血管分子影像之整
合動態影像分析系統研發』的研究目標，是以微型正子掃描儀（microPET）為基礎，
建構開發一套整合影像分析的系統平台，作為多種心血管分子影像分析之用。此系統
平台精確快速全三維正子影像重建，搭配生命體中各類生理循環代謝功能之時間與空
間的資訊。以分子影像結合功能性影像之相關分析研究，無論在基礎的藥物開發、動
物藥學動力模型，或是在臨床診斷、療效評估，日趨越顯其重要性。本子計劃之研究
目的，在於開發一整合型動態影像分析系統平台，結合：（1）小動物心血管三維動態
影像重建、（2）多模組影像融合、與（3）心血管動態影像統計分析，提供心血管生
理循環系統、和心臟代謝功能作用之整合分析平台。此影像分析的平台亦與其他子計
劃結合，輔助各類動物模型實驗所需之相關定量與定性數據。正子標定藥物，結合微
正子掃瞄儀，可提供心血管生理功能之資訊。子計畫（二）將建構一整合影像分析系
統平台，結合現有ECG測量心血管訊號裝置，提供3D心血管動態影像重建，和相關生
理功能定量與定性分析之用。所研發之平台將作為其他子計畫有關心血管相關之三維
影像重建及動態固力與流力分析、動物在心血管疾病基因表現、和動脈粥狀硬化之診
斷及基因治療評估；並結合超音波和光學影像可提供相關心臟疾病代謝量化評估。
關鍵詞: 微型正子掃描儀、心血管影像、3D影像重建、動態影像統計分析、多模組
影像融合。
1
Chapter 2
運算最大相似度演算法在Inveon
MicroPET影像重建研究
利用正子斷層掃描(Positron Emission Tomography, PET)資料之統計特性，相較於
傳統濾波反投影法(Filtered Back-Projection, FBP)，統計影像評估法重建PET影像
提供了較佳的影像品質，所以近年來各種統計影像重建法也持續地發展。最大相似度與
均值最大化演算法(Maximum Likelihood Expectation and Maximization, MLEM)
是最早提出的統計影像評估法，利用相似度函數進行均值化與最大化的步驟，得到良
好的重建影像品質，但因為電腦運算量龐大造成重建速度緩慢，在臨床使用上並不普
及[1]。
自序列子集均值與最佳化演算法(Ordered Subsets Expectation and Maximiza-
tion, OSEM)提出後，統計影像評估的收斂速度獲得大幅提升，在較少次的疊代次數
下，即可達到診斷的標準，因此廣泛的在臨床應用[2]。但由於光子數的限制及雜訊的
干擾，序列子集均值與最佳化演算法所使用的子集分割運算形式，將序列子集階層設
定過多，造成影像重建速度變緩且影像不收斂的發生。
Browne和De Pierro於1996年提出列運算最大相似度演算法(Row-action Maxi-
mum Likelihood Algorithm, RAMLA)可以說是應用子集分割的另一種模式[3]。列
運算即是以系統矩陣中每一列所相關的投影運算視為一個線性方程式，再進行線性求
解的疊代運算，並利用鬆弛係數於每一次疊代中控制運算，直到穩定收斂至最大相似
度的真實值。
本實驗利用Inveon microPET進行老鼠掃描後得到的正弦圖，進行三種影像法的
重建之效能評比。列運算最大相似度演算法的收斂速度快於最大相似度與均值最大化
演算法，且其收斂的穩定度優於序列子集均值與最佳化演算法，將疊代次數調高，仍
然可穩定的收斂。相較於其他兩種方法，列運算最大相似度演算法兼具著高速率與穩
定性，應可更適用在小動物正子斷層掃描。
3
均值化 (E-step):
利用相似度函數求出 的期望值
λnewb = E[nb|λoldb , Y ]
=
∑
d
E[nb,d|λoldb , Y ] =
∑
d
E[nb,d|λoldb , Yd]
=
∑
d
Ydλ
old
b,d∑
b′ λ
old
b′,d
= λoldb
∑
d
YdPb,d∑
b′ λ
old
b′,d
(2.4)
最大化 (M-step):
對於一個可微分函數，如果其一階導函數值為零，二階導函數為負，則此函數在此處
有極大值。在此基礎下，對對數相似度函數做一次微分：
∂l(λ)
∂λb0
= −1 +
∑
d
YdPb0,d∑
b′ λ
old
b′,d
(2.5)
做二次微分：
∂2l(λ)
∂λb0∂λb1
= −
∑
d
YdPb0,dPb1,d[∑
b′ λ
old
b′,d
]2 ≤ 0 (2.6)
相似度函數為凹函數，可證明會有最大值λ存在。
最大相似度與均值最大化演算法中疊代步驟:
步驟1. λkd =
∑
b
Pb,dλ
k
b
步驟2. Xd =
Yd
λkd
步驟3. f =
∑
d
Pb,dXd
步驟4. λk+1d = λkd × f (2.7)
重複均值化與最大化步驟，對重建的影像做乘法性修正，直到相似度函數達到最大
值，則此影像與原始的影像最相似，最有可能產生和接收到的正弦圖相同之影像。
最大相似度與均值最大化演算法在1982年被Shepp和Vardi提出後，並沒有被立即
應用在臨床上，主要的原因是相對於傳統濾波反投影法，其收斂而得到影像的速度太
慢。因為在每一次的疊代中，都必須進行依次正向與反向投影，大大的增加電腦運算
量，降低了其在臨床應用上的實用性。
5
2.1.4 列運算最大相似度演算法
1996年Browne和De Pierro提出列運算最大相似度演算法(Row-action Maximum
Likelihood Algorithm)[3]，其想法即是結合列運算與鬆弛法應用在梯度形疊代演算法
上，形成另一種期望值最大化求解法。將實際資料投影方向上的排列，視為多各獨立
的線性方程式進行疊代運算。在運算時，將每一列視為一個獨立的線性方程式，再利
用數值方法的理論，以求解線性聯立方程式的疊代法。
λk,m+1b = λ
k,m
b (1− αkCb,d) + λk,mb αk
∑
t∈Si
YtPb,t∑
b′ λ
old
b′,d
(2.9)
當αk = 1Cb,d) =
1∑
t∈Si Pb,t
時，列運算最大相似度演算法即為序列子集均值最大化演算
法。
列運算最大相似度演算法最大的特點就是利用鬆弛係數α，控制每一次疊代中的殘
存誤差(公式(2.9)之最後一項)。由於殘存誤差隨著疊代運算鬆弛係數決定了整理運算
的收斂速度，適當的控制鬆弛係數，即可造成鬆弛過度或鬆弛不足的效果，可以使疊
代運算加速收斂。另一方面，隨著疊代次數的增加，逐步的縮小鬆弛係數能使收斂更
加穩定。但如何決定適當的鬆弛係數初始值及其遞減序列以發揮疊代法的最大效能，
牽涉到許多因包括了資料收集的空間幾何關係、資料中的離訊特性、及疊代次數等
等，請參考[4]。
Figure 2.2: Fontal view of an Inveon MicroPET.
7
利用Inveon MicroPET進行小鼠掃描得到的一組正弦圖，進行影像的重建，使用
的演算法為前述之MLEM、OSEM、RAMLA。實驗分為四組：
1. 將正弦圖分別進行MLEM疊代次數 32次；OSEM序列子集階層4，疊代次數為8
次；RAMLA固定鬆弛係數為1.5，序列子集階層4，疊代次數為8次。目的為驗
證三種演算法重建時相似度函數上升的速度，和驗證OSEM及RAMLA是否能
達到與MLEM相同重建影像的品質。
2. 將正弦圖分別進行OSEM序列子集階層2、4、8、20、40，疊代次數固定為20
次。觀察改變序列子集階層對相似度函數上升的速度以及重建影像品質的影響。
3. 將正弦圖分別進行MELM疊代次數100次，OSEM序列子集階層40，疊代次數
為20次，與RAMLA鬆弛係數1.5，序列子集階層40，疊代次數為20次。比較設
定較大序列子集階層，對後兩種演算法的影響。
4. 將正弦圖分別進行RAMLA固定鬆弛係數為0.5、1、1.5，序列子集階層4，疊代
次數為8次。觀察鬆弛係數對相似度函數上升的速度以及影響。
四種實驗的結果皆會以相似度函數的曲線來對收斂速度進行比較分析。
結果與討論
圖2.3為三種演算法的對數相似度函數比較圖，從三條曲線可看出函數上升速度最快為
OSEM，RAMLA次之，而MLEM最慢。在曲線的最末端，三者都達到了相同的點，
由此評估在此設定下，三種演算法的有相近的影像品質。重建後的影像並列於圖2.4，
MLEM與OSEM重建的影像相似，RAMLA的重建影像較平滑，這與RAMLA的重建
特性有關，每次的疊代中影像的修正時皆有保留上一次疊代的評估值，對於雜訊的敏
感度小於MLEM與OSEM。
圖2.5為改變OSEM的序列子集階層之重建影像的相似度函數圖，理論上增加序列
子集階層數目，函數上升的速度會加快。由實驗觀察發現當序列子集階層為4時，上升
速度快於序列子集階層為2，但從序列子集階層增加為8後，速度反而變慢，再增加至
20後速度變緩且相似度函數的最高點也下降。代表由此組正弦圖重建的影像，將序列
子集階層高於某臨界值後(在此臨床小鼠實驗為4)，影像重建的速度並不會如預期的加
快，影像品質也跟著下降。圖2.6與2.7為OSEM不同序列子集階層重建後的影像，由
此比較可明顯看出差異，在此臨床小鼠實驗，當序列子集階層大於4後，影像開始有發
散的情形，階層越大，發散的越嚴重。
將OSEM與RAMAL序列子集階層40，疊代40次的相似度函數曲線置於圖2.8比
較，由實驗二的結果得知在此實驗，當OSEM序列子階層為40，其收斂的速度不
9
Figure 2.4: Image results reconstructed by three iterative algorithms. Top and
bottom rows are the image results from the direct sinogram and the oblique sino-
gram with ring difference one, respectively. Left, middle and right columns are
the image reconstructed by using 32 iterations for MLEM; 4 subsets and 8 itera-
tions for OSEM; relaxation parameter 1.5, 4 subsets and 8 iterations for RAMLA,
respectively.
失了收斂速度快的優點，影像品質也跟著下降。當使用序列子及均值與最佳化演算法
時，適中序列子階層與疊代次數可滿足臨床診斷的需求，但序列子集均值與最佳化演
算法的潛在不穩定性（不同序列子階層重建出的影像不相同），較不利於定量分析。
列運算最大相似度演算法利用鬆弛係數可調控重建中影像修正的速度，在保證收斂
下，又可以降低資料運算量，克服最大相似度與均值最大化演算法收斂緩慢的缺點。
且列運算最大相似度演算法在序列子集階層設定較高時，重建的影像仍較穩定收斂，
這是序列子及均值與最佳化演算法無法做到的。相較於其他兩種方法，列運算最大相
似度演算法兼具著高速率與穩定性，更適用在小動物正子斷層掃描。
未來列運算最大相似度演算法之鬆弛係數設計，能將收斂速度提升至與序列子及均
值與最佳化演算法的速度相近，將更是大幅增加臨床的實用性。
11
Figure 2.6: Image results of the direct sinogram generated by using OSEM with
20 iterations and subsets (a) 2, (b) 4, (c) 8, (d) 20, and (e) 40, respectively.
Figure 2.7: Image results of the oblique sinogram with ring difference one gener-
ated by using OSEM with 20 iterations and subsets (a) 2, (b) 4, (c) 8, (d) 20, and
(e) 40, respectively.
13
Figure 2.9: Image results reconstructed by three iterative algorithms. Top and
bottom rows are the image results from the direct sinogram and the oblique sino-
gram with ring difference one, respectively. Left, middle and right columns are
the image reconstructed by using 100 iterations for MLEM; 40 subsets and 20
iterations for OSEM; relaxation parameter 1.5, 40 subsets and 20 iterations for
RAMLA, respectively.
15
Chapter 3
幾何因素對統計影像重建之影響
正子斷層造影技術(Positron Emission Tomography, PET)利用疊代式影像重建法
(Iterative Image Reconstruction)，提供活體生理功能性的影像。疊代影像重建法
中，需要使用幾何模型(Geometric Model)來決定二維影像每個像素與偵檢對(Detec-
tor Pair)之間的關係。因此，幾何模型不但影響描述光子偵收過程的準確度，亦會對
疊代影像重建之收斂速度產生直接影響。
早期濾波反投影法(Filtered Back-Projection, FBP)，藉由像素與兩偵檢器中點
的連線(Line of response, LOR)的距離，提供一簡易的內差法(Interpolative)模型定
義幾何模型 [5]，計算每個像素中心點到LOR的距離反比，作為偵收的機率。1982
年Shepp和Vardi，在其以最大相似度與均值最大化演算法(Maximum Likelihood
Expectation and Maximization, MLEM)進行影像重建的論文中，則是使用面積法
(Area-based)模型[1]。與內插法不同的是，面積法利用像素和偵檢對的邊界交會出的
面積，來定義光子對被該偵檢對之偵收機率。
另一類型則使用立體角的概念描述幾何因素，和互毀光子的物理特性，稱為立體角
(Solid-angle)模型[6]。假設互毀光子都由像素中心發出，與一側偵檢器的邊界產生夾
角，即為該光子的偵收範圍，並以角度計算偵收機率。
3.1 非數學幾何模型
幾何模型根據掃描儀的結構，與像素位置設定不同的偵收機率。除此之外，還描述像
素在不同投影角度，對應到正弦圖空間的位置。Panin等學者在2006年利用點射源，
實際量測在偵檢環內的點散佈函數(Point Spread Function, PSF)，再搭配已知的幾
何資訊計算系統矩陣[7]。同年Alessio等人，則使用蒙地卡羅模擬方式(Monte Carlo
Simulation)，決定在掃描儀內的系統反應函數(System Response Function, SRF)
[8]，其作用等同Panin的點散佈函數；此兩種方式的正確性均優於僅使用數學模式的
17
比的計算假設。從光子與偵檢器反應的物理特性來看，如此並不能正確地描述像素被
LOR偵收的關係。距離反比僅能夠描述，像素離偵檢對中線愈遠愈不可能被偵收到的
概念，卻因過度簡化，而無法表達偵檢對實際會通過的像素，與其機率的大小。
3.2.2 面積法模型(Area-based model, A)
面積法模型(Fig. 3.2)利用像素被偵檢對包含的面積大小，作為被偵收的機率。為避
免計算不規則形的面積，可將像素分割成更小的像素，如4×4的小像素(Sub-pixel)影
像，再判斷每個小像素的中心點，是否落在偵檢對兩邊的邊界內。將落在兩邊界內的
小像素個數加總起來為n，並除以小像素總數N，則為此像素被該偵檢對偵收的機率
Pi,j =
n
N
，相鄰偵檢對的機率為Pi,j+1 = 1− nN。當像素被偵檢對覆蓋到的面積愈大，
則假設被偵收的機率愈大。每個像素分割成愈小的小像素，則機率值計算就愈精確
(Accuracy)，愈能呈現真實的面積，但同時也會增加Pi,j機率值計算的時間。
(a) (b)
Figure 3.2: Area-based model: (a) transaxial view, (b) single pixel view.
為滿足一個像素最多僅被兩條LOR通過假設，可限制像素的大小。限制像素大小
需從投影角度為45度來考量，也就是在投影軸恰位於影像的對角線上時，像素對角線
長，或兩像素邊界對投影軸形成的投影長度，不得超過一條LOR的寬度，藉此確保假
設在其他投影角度亦會成立。以動物正子造影掃描儀(microPET R4)的組態來說，偵
檢環半徑為7.4公分，影像大小為128×128，所以一個像素的大小為7.4×
√
2
128
≈ 0.0818公
分，而在對角線的長度約為0.1156公分，LOR的寬度要小於等於此長度，避免一個像
素有三條LOR通過。
19
Figure 3.4: Calculation of the angle between two vectors. The angle φ is viewed
as the detected probability for the detector pair in the solid-angle model and the
value is φ = cos−1 v1·v2|v1||v2| .
生位置對於偵收角度的變化。Fig.5 (b)、(c)分別代表發生位置，在偵檢對中心點與
在中心點上方 處。從幾何條件計算夾角的大小，φ = 2 tan−1 D
r
，變數r為發生互毀反
應位置到遠端偵檢器的距離，D為偵檢器寬度的一半。因正切函數值在0°到90°之間遞
增，且二分之一個夾角的大小不超過90°，還有我們不考慮發生位置非常接近偵檢器
(r ≈ 0)，所以可用來描述夾角與間距的變化。
3.3 實驗結果與討論
實驗目的與內容
為了單純探討幾何模型對於影像重建結果的影響，我們簡化一些重建過程的設定。系
統矩陣不包含其他的校正因素，如散射、隨機同符事件的校正，和偵檢器的硬體靈敏
度校正。且根據最大相似度與均值最大化演算法，利用其投影計數值保留的特性，與
演算法本身的收斂性，以其客觀公正地比較演算法收斂速度。
此實驗皆以小動物正子造影掃描儀R4的組態設定[9]。正弦圖的大小為96×192，影
像大小為128 × 128。像素大小為0.81mm。影像座標以左上方的像素為起始點(0,0)，
橫座標往右遞增，縱座標往下遞增。實驗前先由數位假體驗證各幾何模型，在正反向
投影的正確性。
實驗設計分成兩大部分︰針對三種不同的情況，理想環境、含雜訊、有背景活度，
觀察單一點射源影像經過重建後的結果，並評估各幾何模型造成的差異。第二部份則
21
快，且在面對特定雜訊的表現較穩定。
(a)
(b)
(c)
Figure 3.5: Log-likelihood curve of point source phantom in ideal condition. Point
source on (a) original point P1, (b)off-center position P2, (c)off-center position
P3. Three geometric models: Interpolative(I), Area-based(A), and Solid-angle
(S). Three point source position: P1 (0,0), P2(63,38), P3(63,13).
23
(a)
(b)
(c)
Figure 3.7: Log-likelihood curve of point source phantom with uniform back-
ground. Point source on (a)original point P1, (b)off-center position P2, (c)off-
center position P3.
25
Chapter 4
FDG-PET動態參數評估
正子放射性斷層掃描(Positron Emission Tomography，PET)利用可以發射正子的
放射性同位素(或其標定之化合物)反應體內生理、生化變化的情形，提供功能性影像作
為臨床診斷病灶的重要依據。由於惡性細胞的代謝與分裂會比正常細胞快，使用葡萄
糖的速率會高於正常組織，因此藉由觀察異常的葡萄糖代謝速率可判斷腫瘤的位置。
FDG為葡萄糖的類似物，是目前PET常用的放射性藥物之ㄧ。由18F核種標定的
FDG在體內的代謝機制與葡萄糖相似，但FDG轉變成FDG-6-PO4後便會沉積在細胞
內，當葡萄糖代謝速率異常時，便可經由觀察18F核種在不同部位累積的活度來診斷病
灶。為了能完整地描述組織中放射性核種分布與濃度變化的過程，可以利用動態式連
續造影程序，搭配數學運動模型做定量分析。
用來描述FDG在腦組織分布變化的數學模型為三隔室模型(3-Compartmental
Model)，由三個隔室與四個速率常數組成。不同的速率常數具有不同的生理或生化意
義，表現生理系統變化的趨勢。藉由定量分析計算各速率常數，比長時間靜態影像更
可以真實地反應異常代謝的變化過程。當細胞的狀態有異(如受到刺激、退化或凋零)或
是有惡性細胞出現而改變葡萄糖的代謝速率，則此四個速率常數將會是用來評估異常
現象的重要依據。比較速率常數的變化，可以讓我們深入了解影響組織異常代謝的環
節。
為了計算具有生理或生化意義的動態參數(Kinetic Parameters)，我們必須使用動
態模型擬合於組織的時間-活度曲線，以得到功能性資訊。由於本研究所使用的動態模
型為三隔室模型，屬於非線性模型，因此必須使用非線性迴歸分析法，以疊代的方式
計算四個速率常數，將三隔室模型擬合於FDG的時間-活度曲線。
Levenberg-Marquardt(LM)演算法[14]是常使用的非線性迴歸分析法之ㄧ，改善
高斯-牛頓法易發散的缺點，可以有效正確地計算計算非線性模型的參數值。然而，當
影像資訊雜訊過大時，加上三隔室模型的四個速率常數值之間固有的數量級差異，使用
LM會有發散或無法計算的現象。本研究以LM演算法為基礎，提出加權式(weighted)
27
4. FDG和FDG-6-PO4在隔室間的轉換、運輸，屬於一階運動(First-Order Ki-
netics)。
5. 組織從血管中吸收葡萄糖和FDG的比例非常小。換句話說，腦組織從血管中吸
收葡萄糖和FDG的能力不受血流速度的影響。
前三項假設是應用示蹤劑與隔室分析的基礎。而藉由第四項假設，可較容易得到
示蹤劑在隔室中濃度對時間的關係。第五項假設可以降低此模型的複雜度；根據此假
設，微血管中FDG和葡萄糖的濃度將會近似於動脈或靜脈的濃度。也就是說，在同一
時間，影像中任一位置，其血液中FDG的濃度(C∗P )皆是一樣的。
基於以上假設，可得到不同隔室濃度隨時間的變化情形，由下列常微分方程式
(Ordinary Differential Equations，ODEs)來表示：
C∗F (t)
dt
= k∗1C
∗
P (t)− (k∗2 + k∗3)C∗F (t) + k∗4C∗M(t) (4.1)
C∗M(t)
dt
= k∗3C
∗
F (t)− k∗4C∗M(t) (4.2)
C∗P (t)為輸入函數(Input Function)，在本研究中假設C∗P (t)是已知的。在實際的應用
上，可以在造影過程中同時收集不同時間的血液樣本，或是藉由對大量血液體積的部
份做造影(通常以左心室血液體積為主)，來計算C∗P (t)。
式(4.1)和(4.2)可經拉普拉斯轉換(Laplace Transform)求解，得到不同隔室濃度隨
時間的變化情形：
C∗F (t) =
k∗1
α2 − α1
[
(k∗4 − α1)e−α1t + (α2 − k∗4)e−α2t
]⊗ C∗P (t) (4.3)
C∗M(t) =
k∗1k
∗
3
α2 − α1
[
e−α1t − e−α2t]⊗ C∗P (t) (4.4)
上式中⊗表示連續時間捲積分(Continuous-Time Convolution)。
當時間t等於0時，C∗F和C∗M皆等於0(代表在時間為t = 0時，組織隔室中的自由
FDG和FDG-6-PO4的濃度等於0，也就是沒有放射性核種18F的存在)。α1和α2為運算
過程中簡化k∗2、k∗3和k∗4而得到的常數：
α1 =
k∗2 + k
∗
3 + k
∗
4 −
√
(k∗2 + k
∗
3 + k
∗
4)
2 − 4k∗2k∗4
2
(4.5)
α2 =
k∗2 + k
∗
3 + k
∗
4 +
√
(k∗2 + k
∗
3 + k
∗
4)
2 − 4k∗2k∗4
2
(4.6)
假設C∗T (t)為組織(tissue)內所有的18F核種的濃度，即等於組織內自由FDG與
FDG-6-PO4活度的總和，C∗T。因此血液中FDG的活度可被忽略，也就是：
C∗T (t) = C
∗
F (t) + C
∗
M(t) (4.7)
29
到接下來的運算不會對C∗P (t)的參數作微分，所以C∗P (t)的數學模型可表示成
C∗P (t) =
kt t ≤ t0,kt0e−b(t−t0) t > t0. (4.9)
輸入函數C∗P (t)為p-TAC (Plasma-TAC)，k為C∗P (t)到達峰值的斜率，b為C∗P (t)指數
衰減時的強度。
Figure 4.3: C∗P (t)為血液的時間-活度曲線 (p-TAC)。血液中的FDG濃度會在t0內達
到最高值，接著以指數衰減的方式慢慢下降。
C∗T (t)為t-TAC (Tissue-TAC)，為組織部位的活度變化(圖4.4)，可由式(4.8)中的
系統模型與C∗P (t)作連續時間捲積分得到以下形式︰
C∗T (t)
= Ak
{
B1e
−α1t (t0α1eα1t0 − eα1t0 + 1)
α21
+
B2e
−α2t (t0α2eα2t0 − eα2t0 + 1)
α22
}
+ Akt0
{
B1
(
eb(t0−t) − eα1(t0−t))
α1 − b +
B2
(
eb(t0−t) − eα2(t0−t))
α2 − b
}
(4.10)
其中
A =
k∗1
α2 − α1
B1 = k
∗
3 + k
∗
4 − α1 (4.11)
B2 = α2 − k∗3 − k∗4
C∗T (t)為非線性模型，使用最小平方擬合法會得到多重解，故不適用。
31
的速度就會變慢，較難找到真正的極小值。於是Levenberg-Marquardt(LM)演算法
[14]在增值向量βˆm(用來修正第m次疊代的結果：kˆ∗m+1 = kˆ∗m + βˆm)中，增加了一限制
項λmdiag(Z ′mZm)，限制Z ′mZm尋求極值的範圍，用以增加高斯-牛頓法的穩定性：
βˆm = (Z
′
mZm + λmdiag(Z ′mZm))−1Z ′m(y − fm) (4.15)
λ為拉格朗日乘數(Lagrange Multiplier)，會隨著疊代的計算過程而改變。由於λ會影
響梯度向量的步伐，因此λ可以稱為鬆弛係數(Relaxation Parameter)。一開始會設
定λ0為較大的值，使λmdiag(Z ′mZm)對βˆm的影響較為顯著，因而βˆm會有傾向梯度法的
特性，於開始幾次的疊代可以迅速落至極值附近。而後隨著疊代的次數增加，λ會慢慢
變小，發揮牛頓法尋找極值的特性。當λ等於0時，Levenberg-Marquardt演算法即為
高斯-牛頓法[16, 17]。
4.2.4 加權式Levenberg-Marquardt演算法
利用LM演算法計算參數時，鬆弛係數λ為一常數，對於對角矩陣diag(Z ′mZm)中每個
對角元素的影響是一樣的，可以使每個梯度向量的步伐一致：
λdiag(Z ′mZm) = (4.16)
λ

∑n
i=1
(
∂f(ti,k
∗)
∂k∗1
)2
0 0 0
0
∑n
i=1
(
∂f(ti,k
∗)
∂k∗2
)2
0 0
0 0
∑n
i=1
(
∂f(ti,k
∗)
∂k∗3
)2
0
0 0 0
∑n
i=1
(
∂f(ti,k
∗)
∂k∗4
)2

然而，計算三隔室模型的四個速率常數時，k∗1和式(4.8)有直接的比例關係，但在式
(4.8)中的k∗2、k∗3和k∗4關係錯綜複雜。且FDG被細胞代謝後，只有極少部分的FDG-6-
PO4會被反磷酸化，使得k∗4會比其他三個速率常數(尤其是k∗2)小1 ∼ 3個數量級(Order
of Magnitude)。當輸出函數無雜訊時，使用LM演算法可以迅速收斂至極值。但是當
輸出函數的雜訊過大，尋找四個速率常數極值的步伐若是一致，則一旦錯失某個速率
常數的極值時，其誤差將可能造成速率常數間的數量級差距更大。在接下來的疊代運
算中，如果無法及時將此誤差修正回來，則計算βˆm時，容易有無法繼續計算(如0/0)的
結果。
在疊代過程中，若是能增加計算四個速率常數極值的獨立性，依照各速率常數的
收斂狀況來調整梯度向量的步伐，則因誤差而被放大的數量級可以適時的被修正。因
此本研究建議使用加權式(Weighted)Levenberg-Marquardt演算法(WLM)，設λ為
一個4 × 4的對角矩陣，λj, j = 1,…, 4為λ的對角元素，作為diag(Z ′mZm)中各對角元
33
樣，做為定量分析的依據。達到t-TAC峰值後的短時間內，我們用每秒取樣一次的方
式，除了希望可以反應活度的劇烈變化，同時也避免錯失紀錄t-TAC(C∗T )的峰值，
以減少計算速率常數誤差的因素。之後取樣時間逐漸增加，直到每10分鐘取樣一次為
止。
4.3 驗證實驗與結果討論
實驗方法設計
將非線性迴歸分析法應用於真實參數評估前，先利用模擬的方法，驗證此分析法的
可行性，以提高分析真實資料的可信度。我們以實驗(A)無雜訊和實驗(B)各種雜
訊量之模擬，作為LM和WLM演算效能之驗證。實驗設定輸入函數的斜率k為1，
峰值時間t0為30秒，之後C∗P成指數衰減時的指數強度b為0.005，最佳初始計算條件
為λ0 = 0.1，k∗0 = 0.01。模擬實驗使用的速率常數，來源為Huang et al.[15]進行正常
腦部葡萄糖代謝實驗的結果 (表4.1)。我們分別參考LS、GB、SD2和TV四位受試者
的速率常數重繪t-TAC，利用LM與WLM作三隔室模型的擬合，進行定量分析，從計
算速率常數的誤差結果評估不同演算法的準確性。
Table 4.2: 取樣程序；41個取樣點。
Sampling Time Number of Samples Total Time
15 sec 12 3 min
1 min (60 sec) 7 7 min
5 min (300 sec) 22 110 min
Total 41 2 hr (7200 sec)
另外為了反映真實的取樣方式，不同時間的取樣分別為15sec×12, 1min×7, 5min×
22，共41個取樣點，總取樣時間為2個小時(如表4.2)。收斂或停止運算的條件如下：
1.
∣∣∣∣ kˆ∗j,m+1−kˆ∗j,mkˆ∗j,m
∣∣∣∣ < 1× 10−6
2. 無法繼續計算時。
進行實驗(B)各種雜訊量做模擬時，我們會加入平均值為0、標準差分別為0.1和
0.5高斯分佈的雜訊。四位受試者的速率參數，在兩個不同SD的條件下，各做100次
獨立實驗，並平均每次的計算誤差和標準差，與計算平均訊雜比(Signal-to-Noise
Ratio,SNR)：
SNR = log10
∑
S2i∑
iN
2
i
(4.18)
35
LM在無雜訊和低雜訊時都有良好收斂與準確計算參數的優點；而在高雜訊時，WLM
改善了LM有無法計算的現象。
人體或小動物各部位的腫瘤或癌症轉移的追蹤常以FDG作為示蹤劑，本研究雖以
FDG在腦部代謝的三隔室模型為基礎，但由於WLM為LM非線性擬合分析法的延伸。
因此其應用不僅僅限於FDG在腦部代謝的定量分析，對於不同目的的分子影像藥物與
其相關的數學運動模型，WLM仍具有實用價值。
Table 4.3: WLM：模擬的雜訊較低(高訊雜比) Noise SD=0.1。
Patient SNR(dB) Iter k∗1 k∗2 k∗3 k∗4
LS 3.221 42
% Err 0.477 2.008 4.236 7.182
SD 0.353 1.547 3.017 5.248
GB 2.285 29
% Err 2.104 6.697 7.948 11.653
SD 1.553 4.517 5.883 8.499
SD2 3.085 26
% Err 0.958 2.645 2.975 4.714
SD 0.649 1.893 2.022 8.499
TV 2.947 22
% Err 0.744 1.945 2.599 7.002
SD 0.586 1.371 2.108 5.249
Table 4.4: LM：模擬的雜訊較低(高訊雜比) Noise SD=0.1。
Patient SNR(dB) Iter k∗1 k∗2 k∗3 k∗4
LS 3.220 21
% Err 0.543 1.837 3.588 6.104
SD 0.437 1.609 2.782 4.571
GB 2.285 19
% Err 2.312 7.309 8.832 12.994
SD 1.779 5.758 6.805 10.156
SD2 3.086 18
% Err 0.910 2.467 2.848 4.967
SD 0.679 1.871 1.937 3.181
TV 2.946 17
% Err 0.774 2.041 2.633 6.724
SD 0.661 1.451 1.933 5.398
37
Table 4.5: WLM：模擬的雜訊較高(低訊雜比)，Noise SD=0.5。
Patient SNR(dB) Iter k∗1 k∗2 k∗3 k∗4
LS 1.823 41
% Err 2.288 9.240 19.615 36.009
SD 1.675 7.150 14.269 26.692
GB 0.887 35
% Err 13.049 52.687 59.773 74.014
SD 11.831 72.235 74.405 62.074
SD2 3.085 25
% Err 4.316 11.637 11.324 20.305
SD 3.370 10.001 9.172 16.547
TV 2.947 22
% Err 4.339 9.939 11.819 27.276
SD 3.877 8.486 10.691 22.531
Table 4.6: LM：模擬的雜訊較高(低訊雜比)，Noise SD=0.5。
Patient SNR(dB) Iter k∗1 k∗2 k∗3 k∗4
LS 1.824 24
% Err 3.311 10.205 23.215 240.560
SD 9.979 11.917 46.566 2099.001
GB 0.887 24
% Err 12.327 46.404 53.470 187.611
SD 15.278 88.179 77.983 1236.338
SD2 1.688 19
% Err 5.006 12.630 12.530 20.997
SD 3.562 9.339 10.688 16.022
TV 1.549 17
% Err 4.184 11.638 16.721 39.203
SD 3.199 9.621 13.653 31.110
39
Chapter 5
計畫成果自評
本專題研究計畫，在核定之期限內按時完成，相關研究成果同時應用至臨床研究，後
續業已展開。計畫成果分別在期刊和研討會發表[18–39] 。
41
[11] J. Llacer and E. Veklerov. Feasible images and practical stopping rules for iterative
algorithms in emission tomography. Medical Imaging, IEEE Transactions on, 8:
186–193, 1989.
[12] ErkanMumcuoglu, RichardM Leahy, and Simon R Cherry. Bayesian reconstruction
of pet images: methodology and performance analysis. Physics in Medicine and
Biology, 41(9):1777–1807, 1996.
[13] Jinyi Qi, R.M. Leahy, Chinghan Hsu, T.H. Farquhar, and S.R. Cherry. Fully 3D
Bayesian image reconstruction for the ECAT EXACTHR+. Nuclear Science, IEEE
Transactions on, 45(3):1096–1103, Jun 1998.
[14] D. Marquardt. An algorithm for least-squares estimation of nonlinear parameters.
SIAM J. Appl. Math, 11(2):431–441, 1963.
[15] S. C. Huang, M. E. Phelps, E. J. Hoffman, K. Sideris, C. J. Selin, and D. E. Kuhl.
Noninvasive determination of local cerebral metabolic rate of glucose in man. Am J
Physiol Endocrinol Metab, 238(1):E69–82, 1980.
[16] R.I. Shrager. Nonlinear Regression With Linear Constraints: An Extension of the
Magnified Diagonal Method. Journal of the Association for Computing Machinery,
17(3):446–452, 1970.
[17] William H. Press, Saul A. Teukolsky, William T. Vetterling, and Brian P. Flan-
nery. Numerical recipes in C (2nd ed.): the art of scientific computing. Cambridge
University Press, New York, NY, USA, 1992. ISBN 0-521-43108-5.
[18] Ching-Han Hsu and Po-Chia Huang. A geometric system model of finite aperture in
small animal pinhole spect imaging. Computerized Medical Imaging and Graphics,
30(3):181 – 185, 2006.
[19] Jo-Wei Hsu, Ching-Han Hsu, Ing-Tsung Hsiao, Kun-Ju Lin, and Kurt M. Lin. A
study of row-action reconstruction algorithm for small animal PET imaging using
Inveon microPET. Annals of Nuclear Medicine and Sciences, 21(3):131–139, 2008.
[20] Kurt Lin, Ching-Han Hsu, Wun-Shaing Chang, Chiung-Tong Chen, Te-Wei Lee,
and Chin-Tu Chen. Human breast tumor cells express multimodal imaging reporter
genes. Molecular Imaging and Biology, 10(5):253–263, September 2008.
[21] Kurt Ming-Chao Lin, Ching-Han Hsu, and Subbiah Rajasekaran. Angiogenic evalu-
ation of ginsenoside rg1 from panax ginseng in fluorescent transgenic mice. Vascular
Pharmacology, 49(1):37 – 43, 2008.
[22] Chih-Chieh Liu, Ching-Han Hsu, Ing-Tsung Hsiao, and Kurt M. Lin. An Investiga-
tion of Geometric Factor in Iterative PET Image Reconstruction. Annals of Nuclear
Medicine and Sciences, 21(2):89–97, 2008.
[23] Subbiah Rajasekaran, Mei-Ru Chen, Ching-Han Hsu, Chin-Tu Chen, and Kurt M.
Lin. Detection of experimentally induced pulmonary granuloma inflammation in
monocyte chemoattractant protein-1 green fluorescent reporter mouse. Clinical and
Experimental Allergy, xxx:xxx, 2009 (Submitted).
[24] Ching-Han Hsu, Chih-Chieh Liu, Ing-Tsung Hsiao, and Kurt M. Lin. Effect of ge-
ometric models on convergence rate in iterative pet image reconstructions. Nuclear
Instruments and Methods in Physics Research Section A: Accelerators, Spectrome-
ters, Detectors and Associated Equipment, xxx(2-3):xxx, 2009(Accepted).
43
