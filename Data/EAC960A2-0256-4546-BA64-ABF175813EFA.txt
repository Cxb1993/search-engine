報告內容
前言：
正子斷層掃描 PET 為目前醫學上診斷癌症、神經疾病及心臟病上具有相當重要性的診斷工
具。為了提供更好更豐富的醫療影像，傳統的影像從平面影像提升成立體影像。在使用三
維旋轉偵測器的正子造影技術中，因為重建的過程中需要花費大量資料的迭代運算以求得
精確的影像，所以需要花費很長的運算時間，故醫療平台之有效推廣端賴整體效能之提昇。
研究目的：
PET 早期的影像重建方式多以濾波反投影法 FBP 進行，但目前多以 OSEM 之序列子集影像重
建法(Ordered Subsets Expectation Maximization）來進行加速重建影像。然因三維影像
重建帶來之大量運算需求，必須使用平行處理來加速 OSEM 演算，平行處理因使用多處理器
系統，在實作時需克服工作的分配、工作的切割、資料獨立性考量等許多問題，所以本研
究著重探討如何利用迭代運算與迭代運算間的特性，並且對這些方法提出分析與實驗，以
期設計出一個利用平行處理加速三維影像重建之方式。
文獻探討：
PET 的影像重建方式早期多為濾波反投影法 FBP，此方法因其重建後的影像容易會有雜訊的
現象[1]，之後提出簡稱為 MLEM [2]之迭代式影像重建法，在濾波反投影法不能缺乏考量
之統計特性及造成重建影像品質下降的因素， MLEM 皆可將這些缺點加以改善，創造更加
精確之模型重建出更好之影像。但因其統計本質之估計過程不能避免大量運算，一些人提
出了以平行方式來加速需要大量運算的醫療影像[3][4][5]，這些方法主要是將資料切割成
資料區塊，再對每一個區塊內的資料以平行運算去加速，或是以不同作業系統的硬體對於
醫療影像作平行加速的探討。然這些方法缺乏將演算法特性及平行處理器一起合併考慮的
設計，這也是本次研究著重的方向。
研究方法：
在本次研究方法中，特別利用 OSEM 的 OS Level 的概念和配合所使用的共享記憶體多
處理系統特性上，提出利用 Intra-iteration OSEM 及 Inter-iteration OSEM 兩種平行運
算的方式來改進 OSEM。因為 OSEM 對於三維影像資料每個子集(subset)作 EM 運算時，期望
值會在做完一次迭代 EM 後，更新下一個子集作 EM 運算時所要用到的光子散射期望值，所
以在做平行運算時，不同迭代的光子散射期望值會有部分之資料相關性，因此在加速 OSEM
平行迭代演算法時，要把光子散射期望值資料間的相關性分析後，在不影響 OSEM 的演算法
正確性下，利用平行處理的特性去加速 OSEM 的運算。
原始版本的 OSEM 會依次對前後子集做連續的運算，當所有的子集做完運算時，就會開
Inter-iteration OSEM 改良方式
第二種改良方式分析使用 OSEM 前後的迭代運算中，迭代運算中的第一個 Ordered
subset 運算後所更新的影像估計值可以讓下一次的迭代運算先計算第一個 Ordered
subset。在圖 3 中，X[i]代表光子散射期望值的第 i 部分，X[i`]代表經過一次 Subset
iteration 更新後之期望值。P代表 OSEM 的投射步驟，B代表 OSEM 的反投射步驟。圖 3(a)
與圖 3(b)分別代表 OS level 為 2 的第 i 次 iteration 與第 i+1 次 iteration。圖 3(c)代表
OSEM 在 OS level 為 2 的第 i 次 iteration 與第 i+1 次 iteration。圖 3(d)與圖 3(e)代表
OS level 為 4 的第 i 次 iteration 與第 i+1 次 iteration。在圖 3(a)與圖 3(b)表示下，可
以發現能節省的時間為投射步驟時 X[1`]所花費的時間。而圖 3(d)與圖 3(e)表示下，加速
的時間為投射步驟時 X[1`]X[2`]X[3`]所花費的時間。
圖 3 Inter OSEM演算法運算花費之時間圖
結果與討論：
針對前述兩種改良方式的第一種 Intra-iteration OSEM，假設在投射步驟花費的時間
為 T，作了 i 次的迭代運算，排除平行程式選用的因素以及資料平行時所會花費時間影響，
OS level 數值能節省的時間預估如下：
Subset=4 節省的時間為 (1+2)×(T/4)i
Subset=6 節省的時間為 (1+2+3+4)×(T/6)i
Subset=8 節省的時間為 (1+2+3+4+5+6)×(T/8)i
Subset=n 節省的時間為 (1+2+…+(n-2))×(T/n)i
=(n-1)×(n-2)/2×T/n×i
所以當 OS Level 越大，或是迭代次數越多時，可以加速的時間就越多。加速的時間會
可供推廣之研發成果資料表
□ 可申請專利 █ 可技術移轉 日期：98 年 8月 31 日
國科會補助計畫
計畫名稱：正子斷層三維影像重建使用多處理器進行迭代間加速之
研究
計畫主持人：鄭為民
計畫編號：NSC 97－2221－E－031－004 學門領域：醫學工程
技術/創作名稱 正子斷層重建使用多處理器進行迭代間加速
發明人/創作人 鄭為民
中文：
醫療影像在現今疾病診斷上佔了很大的重要性，醫療影像能越快重
建完成就能加快所花費的診斷時間，減少因為等待檢驗報告的時
間，就能更提高收益及其推廣使用。OSEM 方式改善了 MLEM 運算所
花費的時間，而本研究提出的兩種加速方式，更大大降低 OSEM 運
算花費的時間。
技術說明
英文：
可利用之產業
及
可開發之產品
正子斷層電腦斷層掃瞄設備製造業
影像重建軟體模組
技術特點
使用標準商品化之多處理器進行影像重建之加速
合併考慮演算法及處理器特性於改良
推廣及運用的價值
藉由減少影像重建時間增加醫療院所單日掃描處理人數，提高醫療
院所收益。
※ 1.每項研發成果請填寫一式二份，一份隨成果報告送繳本會，一份送 貴單位
研發成果推廣單位（如技術移轉中心）。
附件二
