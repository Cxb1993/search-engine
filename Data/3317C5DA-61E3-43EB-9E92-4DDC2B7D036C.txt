2睡眠研究中鼾聲之聲學分析
Acoustic Analysis of Snoring Sounds in Sleep Studies
計畫編號：NSC 95-2221-E-004-012
執行期限：95 年 8 月 1 日至 96 年 7 月 31 日
主持人：廖文宏
計畫參與人員：林裕凱、紀煜豪
執行機構及單位名稱: 國立政治大學資訊科學系
一、中文摘要
本研究探討的內容主要關於人聲分類
研究。在第一個層次我們將家庭環境中的
聲音分為說話聲、人聲非說話聲以及環境
音三種。為了達到此目標，我們尋找了許
多特徵並找出合適的幾個做為判別的參
數。
在夜間睡眠研究的部分，我們希望可
以將整晚的睡眠資料分為鼾聲與非鼾聲兩
部分，針對鼾聲的部分再深入去探討是否
有呼吸中止症的情況產生。
最後，我們也結合視訊資料，自動判
斷睡姿與翻身狀況，並探討睡眠時姿勢與
鼾聲間的關係。
關鍵詞：音訊分類、鼾聲分析、睡眠呼吸
中止症。
Abstract
In this research, we describe the
classification of audio signals in a smart
home environment and in all-night sleep
studies. In a home environment, our objective
is different from most audio scene analysis
projects in that we are mainly concerned with
the distinction of human and non-human
sounds. Toward this goal, we identify
appropriate features to be extracted from
audio files and discuss the rationale behind
choosing a particular feature.
In all-night sleep recording, we describe
the classification of audio signals recorded in
all-night sleep studies. Our objective is to
separate the episodes into snoring sounds and
non-snoring sounds. We perform further
analysis of the extracted snoring sounds to
check if the testee has apnea.
Finally, we have also developed
algorithms to automatically process video
captured during sleep in an attempt to reveal
the relationship between posture and the
characteristics of snoring sounds.
Keywords: Audio classification, snoring
analysis, OSA.
二、緣由與目的
睡眠是人類生命歷程中重要的一環，
隨著現代工商社會生活型態的改變，睡眠
問題也日益嚴重，據統計，台灣地區約有
超過 20%的人口有程度不一的睡眠障礙
[1,2]，也因此近來有諸多醫療或研究機構
建立睡眠中心，進行睡眠品質的評估以及
睡眠問題的診斷與治療。
在出現睡眠問題的案例中，有若干比
例是為鼾聲所困擾，導致其本身以及同住
者之睡眠品質受到直接的影響。鼾聲的成
因主要有上呼吸道的阻塞、呼吸道某些地
方的肌肉鬆弛、咽喉黏膜出現異常、氣道
過於狹小等，而發生的時機大多是在睡覺
的時候，此時患者往往需要增強他們呼吸
的強度來獲得足夠的氧氣。當呼吸道完全
阻塞時，此人已經不再單純只是打鼾，阻
塞型睡眠呼吸中止症 (Obstructive Sleep
Apnea Syndrome, OSAS)的情況也會跟著
產生(見圖一)，患者常常會因為這樣的症狀
造成血氧濃度過低，以至於在睡眠的過程
中需要耗費更多的力氣呼吸，此時睡眠往
往會被打斷，患者在夜間會不斷的醒來目
前的治療或紓解方案，進而使得睡眠品質
低落，情況嚴重者白天的生活作息將嚴重
的受到影響，在工作上無法集中精神，更
4於鼾聲可能與上呼吸道的阻塞有關，與講
話時的發聲方式有顯著差異，因此對現有
的發聲模型做適度的修正，發展一個符合
鼾聲發聲原理之模型，有助於了解鼾聲聲
波之基本特性。
鼾聲的感測方式，大略可分為聲音，
震動及呼吸氣流三大類，其中聲音屬非接
觸式，而且儀器價格相對低廉，因此被多
數醫療院所採用，也有較多研究成果發
表。然而審視相關論文，多數侷限於時域
(time domain)方面的分析，有的針對振幅的
相對大小進行比較[7]，有的著重周期或間
隔的規律性[8]，少數觸及頻域(frequency
domain)的研究則僅統計主要頻率範圍
[9]，或顯示手術前後頻譜圖的差異[10]，
缺乏量化的分析，而且前述研究所取樣本
數量均極有限，亦甚少完整利用整夜監控
的資料。相較之下，近來在語音或音樂訊
號的處理、分析與比對技術上有甚多進
展，鼾聲的發聲原理雖然有所不同，但也
屬音訊的一種，應可利用數位訊號處理的
相關技術，擷取鼾聲之特徵，並比較不同
受測者間鼾聲之異同。
在錄音設備與收音方式(如麥克風之
規格、擺放位置)方面，目前並未制定通用
之標準，因此本計劃也針對不同規格與等
級之收音設備(如錄音筆、一般電腦用麥克
風、微型麥克風、監視型麥克風、麥克風
陣列等)，在不同環境(包含實驗室、一般住
家臥室)、方位、距離之收音效果，進行系
統化之測試，以確實評估收音品質對後續
信號處理階段之影響，並藉此建立一套通
用的收音準則(protocol)。同時我們也利用
多軌同步錄音裝置，研究貼在喉嚨部位的
震動感應器(vibration sensor)所得資訊與聲
波訊號之關聯度，以評估震動感應器之必
要性。
整晚睡眠的鼾聲分析，也是先前研究
中較少觸及的，由於訊號量龐大，因此有
賴於自動化處理，這個課題牽涉到以下步
驟:
(1) 前處理:雜訊之消除、聲音訊號之偵測
與自動切割(segmentation)。
(2) 訊號過濾:必須將不屬於鼾聲的聲響過
濾，以免干擾後續的分析。
(3) 鼾聲的分群:必須能辨識同一個段落
(episode)的鼾聲，加以分群，並尋求其
共通特性。
(4) 鼾聲型態之判別:必須能對整晚不同段
落 (episode)之鼾聲進行相似度之比
較，推測鼾聲特性是否因人而異，或
者與睡眠階段、睡姿、甚至其他生理
訊號之關係較為密切。
目前睡眠研究雖使用近紅外線攝影的
裝置，但極少對影像做後續的分析與處
理，因此目前這方面的文獻不多。2005 年
7 月，在加拿大醫學協會期刊(Canadian
Medical Association Journal, CMAJ)發
表的教學案例[11]中，運用了 PSG 以及攝影
機等儀器記錄下患有睡眠呼吸疾病
(Sleeping breathing disorders)病患睡
眠的影像與各項生理測量數據。在分析報
告中，諸多生理數據的分析都是有賴於 PSG
儀器的記錄，然而影像的分析，卻是透過
人工調閱的方法觀察病患是否有試圖在睡
眠中將氣道打開的舉動。假使能讓電腦自
動判斷出病患是否有這些舉動，勢必能降
低人工調閱的麻煩。除了 PSG 的記錄之
外，尚須有聲音及影像的全程記錄，配合
病患平常上床的時間，記錄病患整晚的睡
眠情況直到病患起床為止。研究人員再依
據 PSG、聲音與影像的記錄判斷病患的病
因，以找出治療之道。[12]
三、研究方法與結果
3.1 鼾聲的基本聲學分析
本期之研究主要在實驗室環境進行，
在此系統發展階段選取若干正常睡眠的受
試 者 以 及 若 干 有 睡 眠 呼 吸 異 常
(sleep-related breathing disorders)及週期性
肢體運動異常 (periodic limb movement
disorder)的病患至政大心理系睡眠研究室
進行整晚的睡眠記錄。除標準 PSG 記錄以
及臨床檢測所需的肢體活動、呼吸氣流、
胸部及腹部的呼吸運動、以及由指尖記錄
63.2 一般環境中之人聲分類
第一階段的工作主要在探討鼾聲的基
本聲學特性，通常在實驗室中進行，因此
有較理想的收音環境，或可以藉由人工方
式過濾不相干的雜訊，但如果要發展適用
於居家環境的自動化鼾聲辨識、監控與分
析系統，則須考量實際收音時存在許多可
能的干擾因素，例如磨牙(bruxism)、咳嗽
聲、說話聲、汽車聲、記錄儀器發出的聲
響、環境噪音等，因此首要的任務，就是
必須能在各種可能出現的聲音類型中區辨
出哪些是真正屬於鼾聲的段落，哪些是無
關的雜訊，為了達到這個目標，除了利用
第一階段研究中鼾聲的特徵外，還要針對
所有可能出現的干擾音源進行訊號特性的
分析，以找出足以分辨鼾聲與其他聲音的
特徵向量。
我們採用的是階層式的分類法則
(hierarchical classification)，先將聲音分為
人聲 (human sounds)與非人聲(non-human
sounds)，再從人聲的類別中區分語音
(speech)及非語音(non-speech)，最後在非
語音的類別中再篩選出鼾聲的段落，而每
個階層考慮使用不同組合的特徵向量，以
簡化計算的複雜度。選用的特徵包含基
頻、頻譜質心、音質等。在經過越零率等
參數分離出人聲與非人聲之後，可利用頻
譜質心及基頻等參數加以判斷是否為鼾
聲，由於鼾聲多集中在低頻，且發生部位
與說話時不同，因此頻譜質心與基頻可以
幫助分類人聲中鼾聲與非鼾聲，以下就採
用的特徵與其原因做簡短的說明。
基頻 (Fundamental frequency):基頻代
表著聲音發生共振時的最低頻率，亦可稱
為 F0。由於基頻的計算並不複雜，也是
MPEG-7 的 audio descriptor 之一，因此可
知，在某種程度上它對於聲音訊號具有一
定的代表性，不同類型的聲音檔案其基頻
必定也不相同。故本研究採用此特徵當作
分類的參數之一，將其運用在區分人聲與
非人聲這個層面。
越零率(Zero-crossing rate, ZCR):越零
率代表著聲音訊號通過零點的次數，在大
部分情況雜訊的越零率較非雜訊的越零率
高，因此有部分的研究是利用這個特徵來
切割出聲音訊號的起始與結束，本計劃則
擬使用這個特徵來輔助區辨人聲與非人
聲。
相關度(Autocorrelation):相關度主要是
度量訊號的前後一致性，因此當訊號的前
後一致性高時，相關度就會較高，反之則
否。家庭環境中的風扇聲或吹風機的聲
音，由於訊號的起伏變化極小，相較於人
的說話聲是較為前後一致的。本計畫嘗試
將人的說話聲與這類的聲音訊號做比較，
其方法是將算出的相關度繪出得一連續曲
線，當相關度高時訊號的變化不大，曲線
也較為緩和，反之曲線的高低起伏便會極
為明顯，因此可以預期的是，類似風扇聲
這類訊號的高低起伏應該較人聲的起伏緩
和，因此可以訂出一個公式，用以量測相
關度曲線的起伏明顯程度(peak 的明顯程
度)值越大表示起伏越明顯。
頻譜質心(Spectral centroid):訊號的頻
譜質心是用來描述聲音檔案在頻譜圖
(spectrogram)中頻率的質心，此特徵亦屬於
MPEG-7 的 audio descriptor 之一。在一般
家庭環境中，人聲除了說話聲之外，往往
還會夾雜著其他各種不同的聲音，例如：
哭聲、笑聲、叫聲和鼾聲，這些聲音與說
話聲的頻譜質心都不盡相同，由於笑聲與
叫聲是屬於較高頻的聲音檔案，因此計算
出來的質心應較說話聲的值為高，同理，
鼾聲多集中在低頻的地方，故其計算出來
的質心會較說話聲的值為低。
熵(Entropy):頻譜圖(spectrogram)是用
來描繪頻率強度的圖形(如圖五(a))，其橫軸
為時間，縱軸為頻率，深淺則代表強度，
紅色代表的強度最強，依次為橙、黃、綠、
藍、紫，強度代表能量的多寡。因此，不
8家庭環境中，可能就多了一些狗吠聲和車
聲，所以處理上面較為複雜。在這一階段
所牽涉的工作內容包含:聲音切割、鼾聲偵
測與分群。
鼾聲切割與偵測:屬於前處理的部份，
一開始必須將整晚的聲音檔案等分切割，
針對這些檔案，在去雜訊的處理之後，必
須找出有聲音的部份，也就是進行
segmentation 的步驟，所用到的方法，大致
上是利用能量的變化，找出音訊的起點與
終點，其結果如圖七所示。
圖七 切割過後的聲音檔案，紅線代表起點，綠線
代表終點
經過上述的步驟之後，還要深入去判
別這些音訊是否為鼾聲。在錄製整晚的聲
音檔中，經過前處理去雜訊的步驟之後，
留下來的大多為一開始入睡之前的說話
聲，而說話聲跟鼾聲有一個很大的區別，
就是說話聲是沒有週期性的，而鼾聲是較
具有週期規律的，也就是說，在每個鼾聲
之間至少要有一秒左右的間隔，並且每個
切割出來的鼾聲長度不會超過五秒，這樣
的規則可以濾掉大部分的說話聲，再加上
鼾聲大多集中在低頻的部份(如圖五(b))，
因此透過 spectrogram，我們可以很清楚的
分出哪些段落是屬於鼾聲。
鼾聲的分群: 這部分主要是想探討當
有打鼾的情況產生時，這樣的打鼾是屬於
一般型(simple snore)的或是阻塞型(OSA)
的，一般型的打鼾其信號前後的一致性較
高，而阻塞型的打鼾會伴隨呼吸中止的現
象，因此可能中間幾秒會完全沒有鼾聲，
或者會有幾個鼾聲音量特別大，這是因為
阻塞發生時，受試者需要用更大的力氣去
獲得足夠的氧氣所造成，藉由這樣的分類
方法便可以把鼾聲作簡單的分群。
分類的依據主要是照鼾聲信號中的差
異度，先將頻譜圖在時域和頻域上做切
割，時間軸切割成 n 等分、頻域切割成 m
等分，針對每等份算出頻譜圖中強度的總
和，由於頻譜圖中的數值為複數型態，所
以必須取絕對值以表示其大小。經過上述
步驟之後，便可得到 n*m 個數值(以 Aij 表
示)，將這些數值正規化，使得這 n*m 個
Aij 數值總和為 1，也就是 Aij=Aij/sum(A)，
如此便可將頻譜圖轉為一個機率分布
(p.d.f)，稱之為 p(x)。若要判斷兩個鼾聲訊
號的相似度，則可透過上述的方法，得到
兩個近似機率分布的函數 p1(x)、p2(x) ，
計算差異的方法擬採用 K-L distance，定義
如下:
dx
(x)p
(x)p
ln(x)p(x))p(x),(pD
2
1
121KL 
由於 DKL(P2(x),P2(x))與 DKL(P2(x),P1(x))並
非對稱，因此 p1(x)與 p2(x)的距離將取
(x))p(x),(pD 21KL 與 (x))p(x),(pD 12KL 兩者的
平均來計算。
至於要如何定出鼾聲之間的差異，主
要可以分為兩個層面：時域(time domain)
和頻域(frequency domain)。在時域上的作
法，主要是找出鼾聲是否有忽大忽小的情
況產生，一般的鼾聲其聲音較為規律(如圖
八(a))，大小較為一致，有呼吸中止症的病
人其鼾聲大小會有所差異(如圖八(b))，因
此在一開始的時候要先選定檔案中的第一
個鼾聲片段(snoring episode)作為基準，分
別算出後續的鼾聲與這個基準的音量相差
多少，若差異變化很大，便可得知這個時
段之內可能有呼吸中止症的產生。
10
當的角度為床頭(此實驗高畫質的拍攝
-160*120)。實驗中，我們以 PSG 監控各種
生理訊號，並使用近紅外線攝影機紀錄睡
眠活動。
3.4.1. 計算移動量和方向
將睡眠影片中每秒的畫面細分成數個
畫格(frame)，再利用時間(t-1)的 frame
和時間(t)的 frame 互相做影像相減，藉此
得到每個 frame 間的差異，累加出每秒的
差異量後，即可得知在每個時間點的移動
量。判斷出睡眠影片中移動的物件或是人
物之後，將最近發生移動的部份設定為最
高值，而相對於較早移動的部份則設為較
低值，直到超出我們所要找出最近移動的
時間範圍以後，其餘的階設為零，以此類
推，產生階層式的運動歷史圖像(Motion
History Image，MHI)如圖十：
圖十 左圖為方向預計向上的剪影，所產生的 MHI
為右圖。
得到運動歷史圖像之後，利用 Sobel
將移動的部分作邊緣化處理，而 Sobel 邊
緣偵測原理就是對於一張暗色背景下有亮
條紋的影像，由水平掃描線的灰階剖面圖
及其一階導數圖可發現一個邊緣。得知
Sx(x,y)、Sy(x,y)，再算出物件移動的方向
和大小(圖十一左)。
方向:
arctan(Sy(x,y)/Sx(x,y))
大小:
(Sx2(x,y) + Sy2(x,y))1/2
將具有方向和大小的部份整理出方向
的統計圖，計算方向之間的最小差異，最
後統計出結果，找出最多的方向，配合最
小差異，算出整體方向 global motion(圖十
一右) [13]。
圖十一 左圖算出大小方向、右圖算出整體運 動方
向
3.4.2. 門檻值與角度設定
由於處理影像的畫質不一，所以必須依
照 輸 入 影 片 的 不 同 解 析 度 來 調 整
threshold。睡眠影片中，就算是場景不
變，但每張 frame 多多少少會受雜訊的影
響而有差異，設定 threshold 的目的即是
過濾移差異較小的部份，省略不必要的計
算，找出真正有效的移動部份。此實驗為
例，所輸入資料分別為 640*480 和 160*120
的整晚睡眠影片，利用 openCV 之函式庫，
先對低畫質的影片調成與高畫質相同的大
小，再將高畫質的 threshold 調為 60，低
畫質調為 6。
此外，也注意判定翻身的角度，攝影機
架設位置會影響到我們所定義的左翻或右
翻。因此角度依照攝影機的架設位置判定
並由人工設定。此實驗的高畫質影片將正
負 45 度的方向定義為右翻，135 度至 225
度的方向定義為左翻；低畫質的影片由於
受試者所躺位置非水平，將 50 度至 140 度
定義為右翻，220 度至 320 度定義為左翻。
(圖十二)
圖十二 左圖為 640*480，右圖為 160*120
3.5 實驗結果
3.5.1. 一般環境中之人聲分類
12
表五 鼾聲的分類
3.4.3 睡姿和鼾聲的關係
解決影片大小不一和角度問題之後，
分別對高解析度和低解析度的影片執行運
算。實驗結果顯示利用高解析度的影片，
可以正確判斷大致上受試者移動的方向，
並可局部的動作分析。紅色圈出的地方代
表移動的部位，紅圈裡的半徑角度代表移
動的方向。由圖四可知，此位受試者試圖
向右翻身，但也有例外發生，如圖四右圖
的頭部移動方向為向上，但實際上影片中
的受試者頭部並沒有出現向上的移動，因
此可能為光線影響到計算移動量的程度
(圖十三)：
圖十三 左圖找出大致上方向後右圖仍有例外
圖十三 例外放大圖
低解析度的影片，所偵測出的移動部
分較少，降低 threshold 的目的就是更容
易找到細微變化的部份，實驗結果發現，
判定出連續的同方向中，偶爾會出現不同
方向的情況發生，扣除受試者本身的移
動，可能是雜訊的影響，因此可利用規則
判斷出左翻還是右翻。例如連續幾個左翻
身之中若有單一的右翻身出現，則自動忽
略此右翻，直接判斷此時段受試者為左翻
身。部分數據如圖十四：
圖十四：紅色標示角度為 91 度在低畫質中判定為
右翻身，可是其前後之角度均在左翻身的範圍內，
因此可直接省略。
四、結論
本研究著重於人聲的分類，首先我們
提出了新的方法去分類一般環境中的人
聲，目標希望將聲音訊號自動分類成語
音、非語音和環境聲音，我們正確地找出
合適的特徵值達成聲音訊號的分類，實驗
的結果明確的顯示出我們所提出的演算法
是有效的。
目前所收集的環境聲音侷限於機器所
產生的聲音，在未來我們將試著加入更多
類型的環境聲音，例如:將數種聲音混合在
一起，另外希望更進一步細分非語音人聲
部分，使其能分辨哭聲、笑聲、尖叫聲等
聲音。藉由合併基本的生理訊號例如:皮膚
電流反應(Galvanic skin response, GSR)、呼
吸率和心跳率，將有效提升分類的程度和
準確率。
在睡眠時期的鼾聲分類部分，我們著
重於鼾聲訊號的分析，目標希望可由整晚
的聲音訊號中自動分類出鼾聲和非鼾聲，
我們已經正確地找出合適的特徵值達成鼾
聲分類，實驗的結果也顯示我們所提出的
演算法是有效的。
在睡姿和鼾聲的關係的研究部分，目
前睡眠研究中的影像資料雖極少被用來做
後續的分析與處理，然而根據此資料仍可
提供有用的資訊提供專業人員參考。利用
自動化分析影像資訊，比起人工判讀不但
可以更省時省力，亦可增加精確度。由目
前的實驗數據，我們可推知睡眠處於睡或
14
行政院國家科學委員會補助專題研究計畫
■ 成 果 報 告
□期中進度報告
睡眠研究中鼾聲之聲學分析
Acoustic Analysis of Snoring Sounds in Sleep Studies
計畫類別：■個別型計畫 □ 整合型計畫
計畫編號：NSC 95－2221－E－004－012－
執行期間： 95 年 8 月 1 日至 96 年 7 月 31 日
計畫主持人：廖文宏
共同主持人：楊建銘
計畫參與人員：林裕凱、紀煜豪
成果報告類型(依經費核定清單規定繳交)：■精簡報告 □完整報告
本成果報告包括以下應繳交之附件：
□赴國外出差或研習心得報告一份
□赴大陸地區出差或研習心得報告一份
■出席國際學術會議心得報告及發表之論文各一份
□國際合作研究計畫國外研究報告書一份
處理方式：除產學合作研究計畫、提升產業技術及人才培育研究計畫、列
管計畫及下列情形者外，得立即公開查詢
□涉及專利或其他智慧財產權，□一年□二年後可公開查詢
執行單位：國立政治大學資訊科學系
中 華 民 國 96 年 10 月 31 日
附件一
16
※ 1.每項研發成果請填寫一式二份，一份隨成果報告送繳本會，一份送 貴單位研
發成果推廣單位（如技術移轉中心）。
※ 2.本項研發成果若尚未申請專利，請勿揭露可申請專利之主要內容。
※ 3.本表若不敷使用，請自行影印使用。
