1 
 
摘要 
 
關鍵詞：球形格狀陣列、切換雜訊、針腳安排、基因演算法、類神經網路、不連
續結構、損耗傳輸線、眼圖分析、眼圖補償、等化器、高阻抗反射增益。 
 
    數位系統中高速數位訊號切換時，驅動電流的急遽改變會在系統的電源及接
地環境中產生同步切換雜訊，針對使用球形格狀陣列的電子構裝，本計畫一套系
統化方法建立其等效電感矩陣，接著將整個問題做適當的簡化，使得目標函數的
計算時間能夠縮短，並利用基因演算法對信號、電源、接地接腳佈局作最佳化，
以求得最小切換雜訊對應之方式。研究結果中考慮了不同信號與接地接脚數比的
情形，顯示最佳設計時其接地接脚接近均勻擺置，這時各訊號的接地雜訊大小彼
此相近，相差在 5%以內。 
計畫的第二部份探討高速訊號傳輸時雜訊的快速分析及設計方法。目前高速
數位系統的資料傳輸量已達到幾個 Gbps，電子構裝內部之不連續結構比起訊號波
長也已不再微小到可以被忽略，利用全波模擬軟體針對其電氣特性進行設計時往
往需要花費大量的電腦資源與模擬時間，本計畫則透過類神經網路開發一新穎的
設計方法以達成不連續結構反射雜訊最小化的目標，利用此法可以得出經驗公式，
非常適用產業界考量有製程變異的設計，以得到最佳產品效能。 
同樣地，傳輸線的損耗效應也將隨著資料傳輸速率增加而越趨嚴重，進而破
壞系統接收端的眼圖性能，因此計畫的第三部份，則建立一套快速且準確的眼圖
分析方法，再針對補償眼圖所需之被動電路，如：等化器、高阻抗元件，導出達
成補償最佳化的設計流程。利用此一方法，計畫中得到有損匹配傳輸線的廣泛特
性圖，可以直接得到其眼寬及眼高。同時，所提出的方法雖然是被動元件，但可
以有效改良眼圖，最高眼高放大可達兩倍或以上。  
3 
 
advantageous and practical for the industry to yield the best product performance under 
the consideration of manufacturing uncertainty. 
Similarly, the higher the digital data rate is, the more seriously the lossy effect of 
transmission line will be on the signal transmission. Such lossy effect will result in 
significant inter-symbol interference, thereby degrading the eye-diagram performance 
at the receiving end. In this third part of the project, a fast and accurate methodology 
for the eye-diagram extraction is exploited first and then the design flow for the best 
eye-diagram compensation with passive circuit, such as equalizer or high-impedance 
element, is exploited as well. For lossy transmission lines with matched loads, the 
universal charts for the eye height and eye width of the high-speed interconnects are 
derived. The proposed compensation, though in terms of passive components only, can 
effectively upgrade the eye-height as much as more than two times.  
5 
 
4-4 補償電路的適用範圍 ............................................................................. 84 
4-5 實驗量測 ................................................................................................. 86 
4-5-1 量測環境建立 ............................................................................. 86 
4-5-2 單根傳輸線補償 ......................................................................... 88 
4-5-3 差模傳輸線補償 ......................................................................... 91 
第五章 損耗傳輸線轉換函數之理論推導 ......................................................... 93 
5-1 眼圖取得原理 ......................................................................................... 93 
5-2 問題描述 ................................................................................................. 95 
5-3 有損傳輸線轉換函數/脈衝響應之理論推導 ........................................ 96 
5-4 有損傳輸線完整脈衝響應 ................................................................... 102 
5-5 使用 K-K 關係式解決不符合因果律的問題 ...................................... 103 
5-6 有損傳輸線近似步級響應 ................................................................... 109 
第六章 有損傳輸線接收端眼圖的模擬分析 ................................................... 114 
6-1 利用正規化減少變數 ........................................................................... 114 
6-2 取得參數 An與 cn的方法 ..................................................................... 117 
6-3 使用 An與 cn兩參數預測眼圖 ............................................................ 122 
6-4 不匹配情形 ........................................................................................... 126 
6-5 應用 An-cn圖評估有損傳輸線之使用線長 ......................................... 128 
6-6 實驗設計與量測環境 ........................................................................... 132 
6-6-1 頻域量測 ................................................................................... 134 
6-6-1 時域量測 ................................................................................... 136 
第七章 結論........................................................................................................ 139 
參考文獻 ................................................................................................................... 141 
  
7 
 
逐層連接至模組(Module)，卡(Card)，以迄於基板(Board)或背板(Backplane)，其間
包函諸多連線，構成電源與訊號分佈系統。不論是模組、卡、或基板，主要都是
由電路板形成，整個電路板基本上則為多層結構，包含了信號層、電源層和接地
層。在高速數位電路系統中，隨著訊號上昇時間愈來愈短，訊號的傳送會受到傳
輸線的損耗以及阻抗不匹配的影響，結果會使得位元間的碼際干擾(Inter-Symbol 
Interference, ISI)相當嚴重；同時訊號在許多電路同時快速切換的結果，在晶片的
輸出接腳連通柱(Via)由於切換電流會產生可觀的電壓雜訊，會導致電源及參考零
電位不穩定而造成的接地彈跳雜訊(Ground Bounce Noise, GBN)或稱為同步切換
雜訊(Simultaneously Switching Noise, SSN)。隨著製程的進步與低耗電的訴求增加，
數位電路使用的電壓越來越小，這些低電壓擺幅的元件，將會越來越容易因訊號
或電源雜訊造成高低位準的誤判，使整個系統產生誤動作。而上述雜訊將因為積
體電路微小化呈指數方式成長[1][2]，成為高速數位系統設計時的重要電氣特性考
量。 
capacitor capacitorchip chip
power/ground plan
signal traces
vias
Printed Circuit Board
 
圖 1.2 構裝結構示意圖 
在電源分佈方面，同步切換雜訊在高速數位系統中是一項重要的問題，而不
同的晶片接腳設計也會引發不同程度的同步切換雜訊，截至目前為止已經有很多
篇國際期刊論文討論類似的問題，如[3]-[5]，適當的接腳排列設計往往能夠使雜
訊降低並使系統穩定。 
隨著晶片接腳數目增多，對較複雜的晶片常會使用球型格狀陣列(Ball Grid 
Array, BGA)的構裝結構，如圖 1.3 所示，其錫球(Solder balls)數量可由數百至上千
9 
 
結果。 
接著，為分析構裝連線的電氣特性，各種構裝結構的尺寸參數必須轉成為等
效電路參數，為了達到此目的，一般必須透過全波模擬軟體得到較準確的數值，
但是全波模擬的計算相當耗時，因此如果要把構裝結構可能出現的各種幾何尺寸
參數組成均考慮在內，就必須重複執行許多次的場論模擬，這就要花費很多計算
時間，設法從多次重複計算中得到較好的設計。 
為了得到較快速的設計流程，本計畫設法利用全波模擬軟體求得的資料推測
出其他新結構可能的結果，為達到此目的，本計畫將研究利用類神經網路的方法
來簡化此一計算。類神經網路(Artificial Neural Network, ANN)的特點就是具有學
習能力，也就是說它能將之前所輸入的因果關係記錄下來，並且透過不斷修正學
習，最終針對輸入端的刺激和輸出端的反應建立一個最適合的對應關係，即使以
後有新的刺激輸入，類神經網路也能經由先前所學習得到的經驗產生最適當的反
應。 
類神經網路的應用範圍相當的廣泛，有用於找出尺寸對於阻抗匹配的關係
[11]、微波電路設計與最佳化[12]-[14]，和接地連通柱(Grounding via)和螺線電感
(Spiral inductor)的等效電路建立[15]-[16]等。本計畫案將利用類神經網路來進行不
連續結構的電氣分析與設計，考慮的不連續結構包括耦合傳輸線與連通柱等等，
分析將從等效電路模型之建立開始：依據不連續結構的尺寸以及其物理性質，建
立對應的等效電路，其中等效電路各元件的擷取方法是網路合成 (Network 
synthesis)的方式，由全波模擬軟體如 HFSS 或者網路分析儀量測的資料(一般來說
是 S 參數)，以求得相對應的等效電路[17]-[18]，以建立不連續結構尺寸參數和等
效電路間的對應模型。 
從上述等效電路模型，可進一步利用類神經網路建立不連續結構的尺寸參數
和電氣特性的對應模型。以建立不連續接面的等效阻抗為例，當類神經網路成功
11 
 
造成不必要的資源浪費。本計畫為確保傳輸特性可以符合系統的需求，著重於傳
輸線損耗與阻抗匹配對傳輸波形的影響，並由理論推導與電路模擬兩方面進行，
以了解各種不同因素(包含直流損耗、集膚損耗、介質損耗、輸入輸出阻抗，趨動
端電阻)對傳輸波形的影響。此外，為避免以隨機訊號為輸入波形，而做非常多次
電路模擬，計畫中也從眼圖形成機制中，由傳輸線對傳輸波形的影響出發，推導
較簡單計算眼圖的方式。 
    除了系統接收端眼圖以外，接收信號的誤碼率(Bit Error Rate, BER)也是評估
數位系統性能之一個很重要的依據[27][28]，其定義為在傳輸信號位元中會發生位
元訊息判斷錯誤的機率，標準的規範大致都訂在 10-12 的等級。如圖 1.5 所示，在
實驗儀器上觀察到的眼圖時脈抖動其實應該是由好幾種不同原因引發的時脈抖動
所加總而成的，其主要包含兩大類：隨機性時脈抖動(Random Jitter, RJ)與決定性
時脈抖動(Deterministic Jitter, DJ)[28]，而損耗傳輸線引發的碼際干擾所導致的時
脈抖動即是決定性時脈抖動的其中一類。 
    在這個部份，吾人建立了一套完整的誤碼率計算方法，然後在其他時脈抖動
條件固定或是忽略的狀況之下，找出碼際干擾引發之眼圖時脈抖動與誤碼率的關
係，如此也可推算在一定的眼圖時脈抖動規範之下其相應的誤碼率値，最後也將
探討傳輸線金屬與介質損耗參數以及倘若加上被動式補償技術之後對於誤碼率的
影響程度。而吾人也藉由開發出的快速且準確之眼圖萃取方法能夠進一步找出傳
輸線金屬/介質損耗相對於眼圖參數的關係，未來只要取得傳輸線系統等效的金屬
以及介質損耗參數，即可馬上推得對應的眼圖效能，甚至在一定的眼圖規範之下
找出損耗傳輸線的最佳可使用線長。 
 
13 
 
不同的傳輸速率將會對應到不同的補償頻率點。此外，在單純損耗傳輸線的架構
中，本計畫也發展出一套能夠快速預測眼圖之方法，能夠在極短的時間內估計出
眼高與眼寬。 
    上述成果也發表一些期刊論文，謹列如下： 
1. K.-T. Hsu, W.-D. Guo, G.-H. Shiue, C.-M. Lin, T.-W. Huang, and R.-B. Wu, 
“Design of reflectionless vias ssing neural network-based approach,” IEEE Trans. 
Adv. Packag., vol. 31, no. 1, pp. 211-217, Feb. 2008. 
2. W.-D. Guo, F.-N. Tsai, G.-H. Shiue, and R.-B. Wu, “Reflection enhanced 
compensation of lossy traces for best eye-diagram improvement using 
high-impedance mismatch,” IEEE Trans. Adv. Packag., vol. 31, no. 3, pp. 619-626, 
Aug. 2008. 
3. W.-D. Guo, J.-H. Lin, C.-M. Lin, T.-W. Huang, and R.-B. Wu, “Fast methodology 
for determining eye diagram characteristics of lossy transmission lines,” IEEE 
Trans. Adv. Packag., vol. 32, no. 1, pp. 175-183, Feb. 2009 
    以及會議論文如下： 
1. J.-H. Lin, W.-D. Guo, G.-H. Shiue, C.-M. Lin, T.-W. Huang, and R.-B. Wu, “Fast 
Algorithm for determining eye-diagram characteristics of lossy transmission lines,” 
in Proc. IEEE 16th Topical Meeting Elect. Perform. Electro. Packag., Atlanta, GA, 
Oct. 29-31, 2007, pp. 119-122. 
2. Y.-S. Jeng, W.-D. Guo, G.-H. Shiue, C.-M. Lin, and R.-B. Wu, “Reflectionless 
design for differential-via transitions using neural network-based approach,” in Proc. 
IEEE 16th Topical Meeting Elect. Perform. Electro. Packag., Atlanta, GA, Oct. 
29-31, 2007, pp. 119-122. 
3. R.-B. Sun, C.-M. Lin, and R.-B. Wu, “Designs of signal-ground bump-patterns for 
minimizing the simultaneous switching noise in a ball grid array,” in Proc. IEEE 
17th Topical Meeting Elect. Perform. Electro. Packag., San Jose, CA, Oct. 27-27, 
2008, pp. 15-18. 
 
1-3 章節簡介 
在本計畫報告書中分為八章，第一章為簡介與相關文獻探討，從而引導出本
15 
 
第二章 凸塊矩陣最佳化 
 
2-1 凸塊矩陣簡介 
隨著電子構裝技術不斷的進步，其中的垂直互聯結構數量可能高達上百甚至
上千，並且均勻地排列在構裝的表面上。另一方面，由於數位訊號的時脈越來越
快，快速變化的暫態電流在流經垂直互聯結構時會產生同步切換雜訊。為了降低
同步切換雜訊，必須妥善地設計垂直互聯結構的接地位置，以降低電流回流路徑
上的寄生電感。由於垂直互聯結構的數量相當龐大，接地擺置問題的複雜度相當
高，因此吾人必須對整個輸出入緩衝器電路與構裝結構進行適當的簡化。 
由於同步切換雜訊主要受到寄生電感的影響，因此整個複雜的電路最後能夠
簡化為只包含電感與等效電流源的電路，利用這個簡化電路能夠快速地求得上千
根垂直互聯結構於某個接地擺置之下的同步切換雜訊峰值，再利用基因演算法，
能夠決定在某個訊號接地比例之下最佳的訊號接地擺置方式。吾人以如圖 2.1 所
示之多晶片模組(multi-chip module, MCM)中的凸塊陣列為例，開發了一套創新的
電路簡化方法、快速同步切換雜訊峰值計算法以及利用基因演算法以決定最佳接
地擺置的系統化方法。 
 
圖 2.1 分析同步切換雜訊的電路示意圖 
 
17 
 
輸線則等效為其特徵阻抗 Z0 串接一個等效雜訊電壓源 veq_new，電壓源的上升時間
為 Tr_eq。當 Ct與 Lt = Lsig + Lgnd - 2Lm的時間常數遠小於 Tr_eq時，Ct的效應能夠忽
略，並且可以將等效電壓源改變為等效電流源 ieq_new，而 ieq_new=veq_new/(Ron+ Z0)。
依照以上的簡化方法能夠將圖2.2的緩衝器電路簡化為如圖2.3只包含了寄生電感
效應與等效電流源的等效電路。 
為了驗證以上電路簡化方法的正確性，可以比較圖 2.2 節點 vgnd 與圖 2.3 節點
vgnd_app.的電壓波形。各項電路參數如下: Tr = 0.1 ns，Vdd = 1.8 V，Lsig = Lgnd = 22.3 
pH，Lm = 4.82 pH，Ct = 50 fF，τ = 0.2 ns，Z0 = 50 Ω，NMOS 與 PMOS 電晶體使
用台積電 0.18 μm 製程，閘極寬度分別為 24 μm 與 72 μm。圖 2-3 簡化等效電路
的各項參數為: Tr_eq = 59.0 ps，Ton = 35 ps，Ron = 80.2 Ω，ieq_new的峰值為 13.8 mA。
電壓波形比較結果如圖 2.4 所示，可以觀察到圖 2.3 之簡化等效電路與圖 2.2 之完
整緩衝器電路的同步切換雜訊峰值完全相同，因此驗證了簡化方法的正確性。此
外也觀察到有無考慮電容效應對於同步切換雜訊的峰值幾乎沒有影響。 
τ
dd
peak
on
VI
R Z0
= +
 
圖 2.3 只包含了寄生電感效應與等效雜訊電流源的簡化等效電路 
 
19 
 
 
圖 2.5 如圖 2.1 之完整緩衝器電路的簡化等效電路 
 
2-3 利用基因演算法的設計凸塊擺置 
2-3-1 基因演算法的公式化 
吾人利用典型的基因演算法來求得擁有最小同步切換雜訊的最佳凸塊擺置。
最佳化問題的假設如下，首先暫不考慮電源凸塊，只考慮訊號與接地凸塊的擺置，
使得訊號接地回流路徑上的同步切換雜訊峰值最小，因此最佳化問題可以定義為
當凸塊的總數固定時，找出接地凸塊的位置，使得最大的訊號接地路徑上的同步
切換雜訊峰值能夠最小。此外只考慮最差的情況，因此假設所有的電流源同時打
開。根據以上的假設，基因演算法能夠找出最佳的接地擺置。最佳化程式利用整
數編碼，亦即每一個基因代表一個接地凸塊的位置。 
 
2-3-2 最佳化凸塊擺置 
吾人利用以上所建立的最佳化方法來決定不同訊號接地比與不同大小之凸塊
陣列的最佳化凸塊擺置。首先考慮訊號接地比等於 2 與 3 的情況。凸塊陣列結構
如圖 2.6 所示，其中凸塊間距為 250 μm，凸塊高度為 110 μm，凸塊半徑為 65 μm，
介質的介電係數為 3.4。 
21 
 
1
6
2
3 4
54-by-4
6-by-6
1 2 3
4
5 6
1
2 3 4
5
6
8-by-8
10-by-10  
圖 2.8 訊號接地比為 3 之不同大小凸塊陣列的最佳訊號接地擺置 
凸塊陣列 
(S/G = 3) 
(VSSN)max. 
(mV) 
(VSSN)2nd. 
(mV) 
(VSSN)3rd.  
(mV) 
4-by-4 22.4 21.53 21.37 
6-by-6 23.27 23.26 23.14 
8-by-8 22.3 22.29 22.14 
10-by-10 22.55 22.54 22.53 
表 2.1 訊號接地比為 3 之不同大小凸塊陣列的同步切換雜訊比較表 
由圖2.7與圖2.8的最佳化訊號接地擺置結果可以觀察到均勻地分布接地位置
能夠使得同步切換雜訊最小，也使得各位訊號凸塊所觀察到的同步切換雜訊差異
並不是太大，以如表 2.1 之最佳化結果來說，彼此間的差異小於 5%。此外也可以
23 
 
第三章 連通柱結構與解空間分析 
 
3-1 連通柱等效電路 
在印刷電路板上，為了電路設計的需要，訊號線經常遇到必須穿過接地層或
是電源層的情形。而連通柱(Via)的目的，就是提供電路板上訊號線穿層傳輸的路
徑。連通柱的結構主要有三大部分，如示意圖 3.1： 
連通柱焊墊(Via pad)：提供連通柱和傳輸線的連接點。 
連通柱體(Via barrel)：提供訊號穿層傳輸路徑。 
清潔環(Clearance hole or Anti-pad)：避免連通柱體接觸到接地層(或是電源層)。 
 
圖 3.1 連通柱結構示意圖 
對於低速傳輸而言，由於連通柱的尺寸相對於傳輸訊號的波長相當微小，所
以阻抗不連續效應對於訊號的影響並不明顯，經常被忽略不計。然而，當傳輸速
率提升，訊號的高頻成分增加，對於高頻訊號而言，因為波長較短，連通柱結構
相較於訊號波長不再小到可以忽略。以傳輸路徑的觀點來看，原本均勻的傳輸線，
在中間存在一個和原來傳輸線特性不同的連通柱，由於結構不連續，會造成訊號
反射的效應，因此可以預期連通柱對於高頻傳輸訊號的影響將更加顯著。為了分
析連通柱對傳輸訊號的影響，常見的方式是利用全波模擬軟體計算 S 參數，並且
藉由觀察 S 參數，了解訊號反射和穿透的情況。然而這些作法都是從局部電路的
頻域觀點來分析，如果要觀察連通柱在時域上的影響或是考慮整體電路表現，普
遍作法是先求出等效電路模型，之後再將等效電路模型代入電路模擬軟體中，模
25 
 
 
圖 3.2 連通柱等效電路示意圖 
n n nV V V
+ −= +                           (3.7) 
n n nI I I
+ −= −                           (3.8) 
對於互易性網路(沒有主動元件、氧化體或是電漿體)，具有 Y12=Y21 的特性，
π等效電路可以用 Y 參數表示成圖 3.3(b)。由於考慮的頻率大約在 1GHz 到 8GHz
左右，在此頻率範圍內的電路的損耗還不是很嚴重，為了簡化電路，將忽略網路
的損耗。對於無損耗網路，Y 參數矩陣的元素均為純虛數；因此，π 等效電路可
 
傳輸線 傳輸線
傳輸線 傳輸線
傳輸線 傳輸線
傳輸線 傳輸線
1.忽略連通柱效應
2.一階等效電路
3.三階等效電路(π模型)
27 
 
 
圖 3.3 連通柱電路分析示意圖 (a)雙埠網路 (b) π等效電路  
(c)連通柱 π模型等效電路 
 
表 3.1 連通柱尺寸 
連通柱尺寸 柱體半徑(R1) 清潔環半徑(R2) 焊墊半徑(R3) 柱體長度(l) 
架構一 20 mil 30 mil 20 mil 48 mil 
架構二 20 mil 70 mil 20 mil 48 mil 
 
 
 
 
[Y ]
端埠 1 端 埠 2
V 1 + I1 +
V 1 - I1 -
V 2 + I2 +
V 2- I2 -
+
-
+
-
V 1 V 2
I1 I2
-Y 1 2
Y 1 1+ Y 1 2 Y 2 2+Y 1 2
(a)
(b )
L v
C v
(c)
C v
29 
 
 
圖 3.5 架構一(低阻抗連通柱)，S 參數相位模擬結果 
 
圖 3.6 架構二(高阻抗連通柱)，S 參數大小模擬結果 
 
圖 3.7 架構二(高阻抗連通柱)，S 參數相位模擬結果 
 
1 2 3 4 5 6 7 8 9
Frequency (GHz)
-140
-130
-120
-110
-100
-90
-80
-70
-60
-50
-40
-30
-20
-10
0
(S
 (d
eg
)  
Lumped     Model
Full Wave
S 1 2
S 1 1
π
 
1 2 3 4 5 6 7 8 9
Frequency (GHz)
-35
-30
-25
-20
-15
-10
-5
0
|S
| (
dB
)
Lumped     Model
Full Wave
π
S12
S11
 
1 2 3 4 5 6 7 8 9
Frequency (GHz)
-50
-40
-30
-20
-10
0
10
20
30
40
50
60
70
80
90
(S
 (d
eg
)
Lumped     Model
Full Wave
π
S11
S 12
31 
 
 
圖 3.8 清潔環結構對等效電路影響示意圖 (a)清潔環變大，焊墊和接地金屬層距離
增加 (b)清潔環變大，回流路徑增加 
根據表 3.2 算出架構一的連通柱阻抗約為 30 歐姆，對於 50 歐姆的傳輸線來
說是一個低阻抗結構。另外，架構二的阻抗約為 100 歐姆，是ㄧ個高阻抗結構。
由 3D FEM 模擬軟體計算的結果，架構ㄧ的連通柱預期會產生電容性反射，而架
構二的連通柱則會產生電感性的反射。為了驗證此一結果，這裡使用 3D FI(Finite 
Integration)時域模擬軟體來計算兩種結構下的反射和穿透波形，結果在圖 3.9。 
33 
 
生電容性反射。而從結構上分析，在連通柱長度固定的情形下，當清潔環的半徑
增加，會增加電感值並且減少電容值；而當柱體半徑或焊墊半徑增加，則會增加
電容值，電感值則會些微下降。因此，藉由適當調整連通柱幾何結構，理論上是
可以達到阻抗匹配。 
雖然利用全波模擬軟體能計算出各種連通柱結構的等效電路，並求出阻抗值，
但是卻相當花費時間。以先前的例子，計算每ㄧ種結構需要花費大約 20 分鐘，如
果要針對不同的焊墊、清潔環和柱體半徑都去執行全波模擬分析，是很艱難的工
作。因此，這裡將先利用類神經網路求出結構和阻抗間的關係。利用全波模擬軟
體求出的幾組結果來訓練類類神經網路，當訓練成功之後，類神經網路就可以取
代全波模擬軟體的分析工作，快速推算出各種連通柱結構的阻抗大小。 
由於連通柱的阻抗值與結構的比例有關，因此可以將連通柱的長度作為參考
的依據。考慮的結構參數分別是焊墊半徑、清潔環半徑及柱體半徑。參數的考量
範圍如表 3.3 所示，介質層的介電常數為 4.4。 
為了成功訓練類神經網路，本文在範圍內均勻選擇 54 組不同尺寸的連通柱，
利用全波模擬軟體計算出對應的阻抗值，並將這 54 組的資料代入類神經網路中作
為訓練資料。理論上，訓練資料越多，類神經網路誤差可以降低，然而卻必須花
費更多的時間利用全波模擬軟體萃取出這些資料，因此最普遍的作法是逐漸增加
訓練資料的數目，直到類神經網路產生的誤差到達可以忍受的誤差範圍內。為了
測試類神經網路是否訓練成功，另外隨機選擇 30 組不同尺寸的連通柱結構，同樣
利用全波模擬軟體計算對應的阻抗值，最後將 30 組資料作為網路測試資料。在本
研究中類神經網路訓練成功的定義是所有測試資料與類神經網路結果都在 5%的
誤差範圍內。 
表 3.3 連通柱尺寸考慮範圍 
 連通柱長度(l) 柱體半徑(R1) 清潔環半徑(R2) 焊墊半徑(R3) 
尺寸範圍 48mil 20mil~26mil 30mil~70mil 20mil~50mil 
正規化 l 0.42l ~ 0.54l 0.63l ~ 1.42l 0.42l ~ 1.04l 
35 
 
 
圖 3.10 不同數目的訓練資料下，網路測試結果 (a) 26 組訓練資料 
       (b) 34 組訓練資料 (c) 43 組訓練資料 (d) 54 組訓練資料 
一般情況下，三層類神經網路足以描述各種非線性關係。至於隱藏層的神經
元數目則是利用嘗試錯誤法，先從少量的類神經元數目開始，逐漸增加類神經元
的數目，直到網路的結果可以符合要求。隱藏層神經元的數目會影響類神經網路
產生對應關係的能力，當隱藏層的神經元數目太少，網路可以因為太簡單而無法
描述參數間的複雜關係；當隱藏層的神經元數目太多，可能造成過度吻合的情形，
也就是針對訓練資料過度調整，雖然網路的表現會更接近訓練資料的表現，然而
對其他結構的卻可能產生更大的誤差。表 3.5 是針對不同隱藏層神經元的數目的
 
0
10
20
30
40
50
60
70
80
90
100
0 10 20 30 40 50 60 70 80 90 100
類
神
經
網
路
阻
抗
結
果
(歐
姆
)
類
神
經
網
路
阻
抗
結
果
(歐
姆
)
類
神
經
網
路
阻
抗
結
果
(歐
姆
)
類
神
經
網
路
阻
抗
結
果
(歐
姆
)
全波模擬阻抗結果(歐姆)全波模擬阻抗結果(歐姆)
全波模擬阻抗結果(歐姆) 全波模擬阻抗結果(歐姆)
(a) (b)
(c) (d)
0
10
20
30
40
50
60
70
80
90
100
110
0 10 20 30 40 50 60 70 80 90 100
0
10
20
30
40
50
60
70
80
90
100
0 10 20 30 40 50 60 70 80 90 100
0
10
20
30
40
50
60
70
80
90
100
0 10 20 30 40 50 60 70 80 90 100
37 
 
 
圖 3.11 不同架構下，網路測試結果 (a) 3-2-1 網路架構 (b) 3-3-1 網路架構            
(c) 3-4-1 網路架構 (d) 3-6-1 網路架構 
其中 '3R 、 '2R 、 '1R 和 'cZ 都是經過正規化的值，所以在利用式(3.19)時，必須先將
結構參數分別除上考慮範圍的最大值，每個結構參數的考慮範圍如表 3.3 所示。
將結果乘上 120 歐姆後，即是連通柱的阻抗值。 
 
10
20
30
40
50
60
70
80
90
100
110
10 20 30 40 50 60 70 80 90 100 110
10
20
30
40
50
60
70
80
90
100
110
10 20 30 40 50 60 70 80 90 100 110
10
20
30
40
50
60
70
80
90
100
110
10 20 30 40 50 60 70 80 90 100 110
10
20
30
40
50
60
70
80
90
100
110
10 20 30 40 50 60 70 80 90 100 110
類
神
經
網
路
阻
抗
結
果
(歐
姆
)
類
神
經
網
路
阻
抗
結
果
(歐
姆
)
全波模擬阻抗結果(歐姆)全波模擬阻抗結果(歐姆)
(a) (b)
類
神
經
網
路
阻
抗
結
果
(歐
姆
)
類
神
經
網
路
阻
抗
結
果
(歐
姆
)
全波模擬阻抗結果(歐姆) 全波模擬阻抗結果(歐姆)
(c) (d)
訓練資料
測試資料
訓練資料
測試資料
訓練資料
測試資料
訓練資料
測試資料
39 
 
較於表 3.7 中。 
表 3.7 類神經網路與全波模擬軟體比較表 
 準確度 計算時間(次) 佔用電腦資源 結構限制 
全波模擬 最佳 20 分鐘 多 無限制 
類神經網路 稍差 1 秒內 少 在訓練範圍內
 
3-4 解空間 
在 3-3 節中，成功訓練出ㄧ個類神經網路，可以快速找出不同結構下，連通
柱的阻抗值。接下來就是希望應用訓練完成的類神經網路來分析處理連通柱由於
阻抗不連續而造成的反射現象。根據圖 3.9，連通柱在不同的結構比例下，可能產
生電容性反射或是電感性反射，而透過適當選取結構比例則可以達到和前後端傳
輸線阻抗匹配，使得反射量最小。然而，如何找到反射量最小的尺寸範圍?最簡單
的方式是在有興趣的尺寸範圍內，對於所有的尺寸都去計算出每個結構的阻抗值，
之後再根據算出的阻抗值過濾出符合匹配條件的結構大小。這樣的作法，如果是
單純利用全波模擬軟體分析，將會非常花費時間，甚至不可行；但是利用類神經
網路，就可以很快求出所有的結果。 
作法如圖 3.13，由於考慮的結構參數有三個，然而解空間在呈現時主要是考
慮兩個參數，因此這裡將以影響阻抗最為顯著的兩個結構參數：焊墊半徑和清潔
環半徑作為呈現解空間的兩個參數，柱體半徑則當作常數。 
根據表 3.3 所考慮的參數範圍內，分別對焊墊半徑 R3 和清潔環半徑 R2 各取
100 種尺寸結構，因此總共會產生 10000 筆資料。從這裡可以更明顯發現利用類
神經網路分析的好處，如果用全波模擬軟體產生 10000 筆資料，大約需要 138 天，
然而使用類神經網路產生 10000 筆資料，只需 2 秒左右，若是加上訓練和測試資
料(100 筆資料)產生的時間，也僅需要 33 小時左右，在分析的時間上可以減少 100
倍。有了 10000 筆資料後，接下來的工作就是針對這些資料做過濾的工作，作法
如圖 3.14 所示，最主要就是將符合阻抗匹配的尺寸結構篩選出來。 
41 
 
除了求出阻抗匹配的結構範圍，另外可以針對所有焊墊半徑 R3 和清潔環半徑
R2 的尺寸，觀察阻抗的分布情形，如圖 3.16。由圖中可以發現，當焊墊半徑增加，
阻抗會降低；當清潔環半徑增加，阻抗會增加。另外，如果焊墊半徑越大，連通
柱阻抗隨著清潔環半徑改變的變動幅度會越小；而當清潔環的半徑越小，阻抗隨
著焊墊半徑改變的變動幅度也會越小。以阻抗值的角度來看，低阻抗連通柱的阻
抗值越不容易隨著結構參數改變而產生變化；相反地，高阻抗連通柱的阻抗值則
是越容易受到結構參數影響，阻抗變化情形整理如表 3.8。 
 
圖 3.16 連通柱阻抗分布圖 
表 3.8 連通柱阻抗變化結果 
 清潔環半徑(R2) 焊墊半徑(R1) 高阻抗 
情形下 
低阻抗 
情形下 增加 減少 增加 減少 
連通柱阻抗
Zv (歐姆) 
上升 降低 降低 上升 
阻抗值 
變動較大 
阻抗值 
變動較小 
 
為了分析柱體半徑對於阻抗的影響，分別選取柱體半徑為長度的 0.4 倍、0.45
倍、0.5 倍及 0.54 倍等四種情形。求出四種情況下的解空間，如圖 3.17。當柱體
 
70~80 歐姆
80~100 歐姆
60~70 歐姆
50~60 歐姆
40~50 歐姆
30~40 歐姆
20~30 歐姆
43 
 
間的正確性，此處將利用時域模擬軟體來做驗證的工作。 
考慮介質層為厚度 24mil 的 FR4 板材，介電常數為 4.4。前後端的為線寬 44mil
的 50 歐姆微帶線。連通柱的結構分別在不同阻抗值的範圍內選取三個結構，詳細
結構尺寸如表 3.9，其中連通柱長度(I)固定為 48 mil，而柱體半經固定為 20 mil，
輸入波形是一個上升時間為 100 ps，振幅是 1V 的步階信號，模擬結構示意圖如
圖 3.18。 
表 3.9 不同阻抗值範圍下，選取的連通柱結構 
阻抗值(Zv) 清潔環半徑(R2) 焊電半徑(R3) 
20~30 
歐姆 
結構 1 35mil 45mil 
結構 2 40mil 45mil 
結構 3 45mil 50mil 
30~40 
歐姆 
結構 4 40mil 30mil 
結構 5 45mil 40mil 
結構 6 50mil 45mil 
45~55 
歐姆 
結構 7 55mil 35mil 
結構 8 60mil 40mil 
結構 9 65mil 45mil 
60~80 
歐姆 
結構 10 60mil 20mil 
結構 11 65mil 25mil 
結構 12 65mil 30mil 
80~100 
歐姆 
結構 13 68mil 20mil 
結構 14 68mil 22mil 
結構 15 70mil 20mil 
 
45 
 
的確會得到非常小的反射量。因此，得到結論，利用訓練成功的類神經網路，能
夠相當準確預測出符合阻抗匹配的連通柱尺寸範圍。如果將連通柱結構設計在解
空間的範圍內，就可以得到較小的反射效應。 
 
圖 3.19 連通柱阻抗值為 20~30 歐姆，時域反射及穿透波形 
 
圖 3.20 連通柱阻抗值為 30~40 歐姆，時域反射及穿透波形 
 
0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 2
-0.2
0
0.2
0.4
0.6
0.8
1
R2=35mil ; R3=45mil
R2=40mil ; R3=45mil
R2=45mil ; R3=50mil
*
*2 0~3 0  歐 姆
*
TD T
TD R
時間  (ns )
電
壓
 (
V)
 
0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 2
-0.2
0
0.2
0.4
0.6
0.8
1
R2=40mil ; R3=30mil
R2=45mil ; R3=40mil
R2=50mil ; R3=45mil
T D T
T D R
*
*
3 0 ~ 4 0 歐 姆 *
時 間  ( n s )
電
壓
 (
V)
47 
 
3-5 實驗量測 
3-5-1 頻域量測結果 
一般網路分析儀中，內建有 TRL 校正的功能。這裡將利用網路分析儀所提供
的功能，來做校正量測的工作。為了得到穿透、反射和傳輸線的量測數據，所以
除了主要電路之外，另外必須製作穿透電路、反射電路和傳輸線段等三種電路。
為了避免接頭前端同軸電纜的影響，第一步可以先利用儀器的校正元件將同軸電
纜的效應扣除，如此作法的好處就是在量測穿透電路、反射電路和傳輸線段時，
可以更容易觀察每個電路是否有表現異常的情形發生。因為在做 TRL 校正時，會
同時考慮三種電路的量測結果，所以如果其中一個電路表現異常，都可能使得校
正後的結果不是非常的理想。 
在利用TRL校正功能時，首先必須分別量測穿透電路、反射電路和傳輸線段。
量測儀器會將個別的量測結果記錄下來，之後再根據三種電路的量測結果直接調
整內部的參數，當參數調整完成後，就可以將主要電路接上量測儀器，此時量測
到的數據就是已經校正之後的結果。 
了解 TRL 校正技術，再來就是希望透過 TRL 校正技術來驗證連通柱等效電
路的正確性。為了得到連通柱實際電路的頻域表現，在量測時可以利用 TRL 將連
通柱前後兩端的傳輸線效應扣除，量到單純只有連通柱的效應，最後再將量測的
結果與等效電路的模擬結果做比較。由於連通柱可能是電容性或是電感性，因此
本研究將同時考慮兩種情況下，等效 π電路是否都能準確取代連通柱的表現。 
兩種架構的連通柱的尺寸如表 3.1 所示，前後端的傳輸線分別為長度 2 公分
的微帶線。由於最後要透過TRL校正技術將前後端的 2公分長的微帶線效應扣除，
因此穿透電路設計為 4 公分長的微帶線，反射電路為末端開路且長度為 2 公分的
微帶線結構，傳輸線段則是長度為 4.5 公分的微帶線結構，其電路結構示意圖如
圖 3.29。選擇 4.5 公分的原因是因為傳輸線段必須比穿透電路長，同時訊號在二
者的相位差距在 20~160 度的範圍內，可以得到較好的校正結果，因此選擇 0.5 公
分的長度差距可以確保頻率在 1~8GHz 都可以有不錯的校正效果。實際電路結構
如圖 3.30 所示，量測儀器為 Agilent technologies E5071B 網路分析儀，如圖 3.31。 
49 
 
圖 3.31 網路分析儀 
 
實驗量測與模擬結果如圖 3.32~圖 3.34。圖 3.32 是針對架構一(阻抗值較低的
連通柱結構)，所做的量測與模擬比較。其中圖 3.32(a)和 3.32(c)是沒有經過 TRL
校正的 S 參數大小和相位結果，相位會因為前後端傳輸線和端埠阻抗不匹配的影
響，產生週期性的變化。而圖 3.32(b)和 3.32(d)則是經過 TRL 校正後的量測結果，
經過校正後的量測結果和等效電路的模擬結果趨勢一致，同時 S 參數的大小和相
位都相當接近。因此，如果不考慮太高的頻率，對於阻抗值較低的連通柱結構，
採用 π模型等效電路是可行的。 
圖 3.33 是針對架構二(阻抗值較高的連通柱結構)所做的量測與模擬比較。其
中圖 3.33(a)和 3.33(c)是沒有 TRL 校正的 S 參數大小和相位結果，相位一樣有週
期性變化。而圖 3.33(b)和 3.33(d)則是經過 TRL 校正後的量測結果，經過校正後
的結果與等效電路的模擬同樣相當接近，所以 π模型等效電路對於阻抗值較高的
連通柱結構同樣可行。 
 
圖 3.32架構一(低阻抗連通柱)頻率量測結果 (a)|S|(無TRL校正) (b)|S|(TRL校正後) 
(c)∠S(無 TRL 校正) (d)∠S (TRL 校正後) 
 
 
S 
(d
B)
S 
(d
B
)
Frequency (GHz) Frequency (GHz)
Frequency (GHz) Frequency (GHz)
0 1 2 3 4 5 6 7 8
-40
-30
-20
-10
0
Lumped     Model
Measurement
0 1 2 3 4 5 6 7 8
-200
-100
0
100
200
Lumped     Model
Measurement
1 2 3 4 5 6 7 8
-40
-30
-20
-10
0
Lumped     Model
Measurement
∠
S 
(d
eg
)
∠
S 
(d
eg
)
(a) (b)
(c) (d)
S11
S11
S11
S11
S12
S12
S12
S12
π π
ππ
1 2 3 4 5 6 7 8
-160
-140
-120
-100
-80
-60
-40
-20
0
20
40
Lumped     Model
Measurement
51 
 
素，應該來自於接頭和焊錫的影響；儘管如此，整體反射量仍然小於-20dB，非常
微小。 
圖 3.34 (b) 和 3.34 (d) 則是經過 TRL 校正後的量測結果，經過 TRL 校正之
後，S12 的結果不論是大小和相位，量測與模擬的結果都相當一致；然而，S11 的
結果則是有相當大的誤差。由於傳輸線段的造成的反射非常小，所以接頭或焊錫
等因素所造成的 S11 反射量都可能比傳輸線段的效果還要大，如果 TRL 校正電路
間的接頭和焊錫所造成的效應不一致，則對於數值很小 S11 校正的效果就變得很
不理想。因此，傳輸線段再經過 TRL 校正後結果並不理想。 
 
 
 
圖 3.34  4.5 公分傳輸線段頻率量測結果 (a)|S|(無 TRL 校正) (b)|S|(TRL 校正後) (c)
∠S(無 TRL 校正) (d)∠S(TRL 校正後) 
由此可知，經過 TRL 校正之後會有誤差產生，誤差來源應該是來自於校正電
路間的接頭、焊錫和傳輸線特性的差異。對於效應較明顯的待測電路(如連通柱)，
經過 TRL 校正後受到誤差影響較小；然而對於效應較不明顯的待測電路(如傳輸
 
S 
(d
B
)
S 
(d
B
)
Frequency (GHz)
(d)
Frequency (GHz)
(c)
Frequency (GHz)
(b)
Frequency (GHz)
(a)
0 1 2 3 4 5 6 7 8
-80
-60
-40
-20
0
Lumped     Model
Measurement
0 1 2 3 4 5 6 7 8
-200
-100
0
100
200
Lumped     Model
Measurement
0 1 2 3 4 5 6 7 8
-200
-100
0
100
200
Lumped     Model
Measurement
0 1 2 3 4 5 6 7 8
-80
-60
-40
-20
0
Lumped     Model
Measurement
∠
S 
(d
eg
)
∠
S 
(d
eg
)
π
S12
S11
S12 S12
S12
S11
S11
S11
π
ππ
53 
 
 
圖 3.35 時域量測電路示意圖 
 
圖 3.36 時域量測電路實際結構 
 
 
圖 3.37 TDR 時域信號分析儀 
為了更清楚觀察反射量的大小，將 TDR 量測結果放大，同時加上 H-SPICE
 
55 
 
 
圖 3.39 TDR 量測與模擬結果 (a)低阻抗與匹配阻抗連通柱的 TDR 比較圖 (b)高阻
抗與匹配阻抗連通柱的 TDR 比較圖 
 
圖 3.40 頻率量測結果比較 
  
 
時 間 (n s )
電
壓
(V
)
0 0.5 1 1.5 2 2.5 3 3.5 4
-0.01
0
0.01
0.02
0.03
Measurement  (Inductive)
H-Spice (Inductive)
Measurement  (Matching)
H-Spice (Matching)
0 0.5 1 1.5 2 2.5 3 3.5 4
-0.025
-0.02
-0.015
-0.01
-0.005
0
0.005
Measurement (Capacitve)
H-Spice (Capacitve)
Measurement  (Matching)
H-Spice (Matching)
時 間 (n s )
電
壓
(V
)
( b )
( a )
接 頭 效 應
接 頭 效 應
連 通 柱 效 應
接 頭 效 應接 頭 效 應
連 通 柱 效 應
 
0 1 2 3 4 5 6 7 8
-50
-40
-30
-20
-10
0
Capactive via
Inductive via
Matching via
F r e q u e n c y  (G H z )
|S
| (
dB
)
S 1 2 S 1 1
1 2 d B
57 
 
得到一個包含負載(L、R)項的反射電壓公式： 
0
1
2
c
t i
c
j LV V
j L Z
ω
ω
⎛ ⎞= +⎜ ⎟+⎝ ⎠
      (4.2) 
從(4.2)式可得知，經由反射的電壓疊加會使得穿透電壓比入射電壓還大故 
吾人可定義電感反射增益為 ( ) ( )1cG ω ω= +Γ ，即穿透電壓與輸入電壓之比值    
( ) ( )( )20log 20log 20log 1tc
i
VG
V
ω ω= = +Γ            (4.3) 
(4.3)式的電感反射增益值最大可達到全反射時的 6dB。 
由上述可得知經由電感所產生的反射增益，現在將傳輸線損耗考慮進來，如
圖 4.1(b)所示，隨著頻率的增加傳輸線會產生嚴重的衰減，這時就可利用電感的
反射量來對損耗掉的能量做補償的動作，但其電感反射增益補償最大只有在全反
射時有 6dB 的補償效果。所以最後得到的頻率響應 ( )out inV V 為原來傳輸線所損耗
掉的能量再加上電感反射增益所補償的能量，因此，吾人就定義補償前與補償後
之轉移函數分別為 ( )0H ω 及 ( )cH ω ，則 
 ( ) ( ) ( )020log 20log 20log 20logc cout
in
H HV G
V
ω ω ω= = +       (4.4) 
50LZ = Ω
0 50Z = Ω
cL
 
(a) 
59 
 
0 2 4 6 8 10
(GHz)
-20
-16
-12
-8
-4
0
(d
B)
Ⅰ Ⅱ Ⅲ
()
c
H
ω
0 1 2 3 4 5
-16
-12
-8
-4
0
4
8
( )0H ω
( )cG ω
( )
1
cG ω
( ) ( )0
1
c
H
G
ω ω=
  (a)
        (b) 
圖 4.2 補償後的最佳化頻率響應分析(a)最佳化電感補償頻率響應； 
(b)傳輸線損耗曲線與補償函數曲線 
為什麼一定要補償到第二區段為持平的狀態才是好的呢？以下吾人會以四個
例子來分析說明為什麼，分別是在 case1 的未加電感補償時、case2 的電感補償不
足時、case3 的電感補償最佳化時、case4 的電感補償過大時，觀察在最後的不同
頻率響應下所產生的輸出波形和眼圖。分別如圖 4.3 所示，吾人使用如圖 4.3(a)
中所示之尺寸結構，但其中之補償電感 cL 取不同之值，吾人在輸入端輸入一長串
隨機信號，在 case1 中，一條未加補償電感的 30 英寸長傳輸線，來源信號 0.8V
先做分壓後為 0.4V 輸入，其中輸入波形為隨機脈衝輸入信號，如圖 4.3(b)所示，
然後再經由一段長度的傳輸線損耗，如圖 4.3(c)繪出在分別在加入不同補償電感
cL 情形下之輸出波形與眼圖。其中輸出波形因傳輸線損耗有 ISI (inter symbol 
interference)效應而使得輸出波形變得失真且有飄移的現象，進而使得眼高和 jitter
都變得不好；在 case2 中，加入的補償電感不夠大時，輸出波形也是會有被放大
的效果進而增加眼高，但還不是最好的眼圖表現；case3 中，加入的補償電感為最
佳化時，即最後的頻率響應會在低頻段有一持平狀態，觀察其輸出波形可以發現
會被放大到與輸入波形的初始位準(0 ~ 400mV)相近，這時的 jitter 會被縮減到最
小，而眼高可能還有些許的改善空間；case4 中，加入的補償電感過大時，可以發
現最後的頻率響應會在低頻處有突起的現象，此為高頻成份被過度補償，可以從
輸出波形觀察到這樣的現象，這樣過度補償的結果會造成 jitter 嚴重的變差，因為
61 
 
0 1 2 3 4 5
(GHz)
-16
-12
-8
-4
0
(d
B)
0 1 2 3 4 5
(GHz)
-10
-8
-6
-4
-2
0
(d
B)
0 1 2 3 4 5
(GHz)
-10
-8
-6
-4
-2
0
(d
B)
0 1 2 3 4 5
(GHz)
-10
-8
-6
-4
-2
0
(d
B)
0cL nH=
5cL nH=
7.96cL nH=
10cL nH=
()
(
)
c
H
dB
ω
()
(
)
c
H
dB
ω
()
(
)
c
H
dB
ω
()
(
)
c
H
dB
ω
105 15
-0
100
200
300
400
-100
500
time, nsec
V1
, m
V
V2
, m
V
105 15
-0
100
200
300
400
-100
500
time, nsec
V1
, m
V
V2
, m
V
105 15
-0
100
200
300
400
-100
500
time, nsec
V1
, m
V
V2
, m
V
105 15
-0
100
200
300
400
-100
500
time, nsec
V1
, m
V
V2
, m
V
50 100 150 200 250 300 3500 400
0.0
0.1
0.2
0.3
0.4
-0.1
0.5
time, psec
A
50 100 150 200 250 300 3500 400
0.0
0.1
0.2
0.3
0.4
-0.1
0.5
time, psec
A
50 100 150 200 250 300 3500 400
0.0
0.1
0.2
0.3
0.4
-0.1
0.5
time, psec
A
50 100 150 200 250 300 3500 400
0.0
0.1
0.2
0.3
0.4
-0.1
0.5
time, psec
A
(c) 
圖 4.3 四種不同程度的電感補償分析(a)結構示意圖；(b)輸入波形；(c)定性分析結
果 
 
4-1-2 最佳化電感設計流程 
吾人可從圖 4.4 所示的設計流程，一步接著一步的說明來設計出吾人所需的
最佳化電感。 
 
63 
 
否則 1W
H
> ， 0F =  
( ) ( )1 21 1 121 0.217 1
2 2
r r
eff r
H TF
W WH
ε εε ε
−+ − ⎛ ⎞= + + + − −⎜ ⎟⎝ ⎠   (4.6) 
0 0,μ ε
1 1,μ ε
電場
磁場
H
W
T
 
圖 4.5 微帶線結構和場型分佈示意圖 
步驟一，利用(4.5a)式所得到的是傳輸線傳播函數的近似公式(如圖 4.6 中所示
的虛線)，此近似公式不考慮表面粗糙所造成的影響而忽略金屬損耗所造成的影響，
因此，還需再利用實際量測結果來產生一個校正因數校正其傳輸線 S 參數的方程
式，這裡吾人以一條 40 英寸長傳輸線來做分析比較，利用修正因為金屬損耗所造
成的誤差項電阻 R，與介質損耗所造成的誤差項電導G，修正結果列於表 4.1 所
示，最後修正後的 ( )0H ω (如圖 4.6 中所示的點虛線)會近似於實際所量測(如圖 4.6
中所示的實線)，即交流電阻須再乘上 1.3 倍， tanδ 改為 0.022，如此修正完的方
程式就更接近實際情況了。 
0 2 4 6 8 10
frequency(GHz)
-40
-30
-20
-10
0
|S
21
 |(
dB
)
Measurement
Matlab             (2.9)
Matlab_Modify
4.4
tan 0.02
rε
δ
=
=
0 50Z = Ω
()
0H
ω
 
圖 4.6 單根傳輸線 ( )0H ω 的校正(其中，實線與虛線分別對應傳輸線之量測結果
與近似模擬結果，點虛線為校正後的近似模擬)。 
65 
 
射增益斜率的反曲點就不會與傳輸線 ( )0H ω 的斜率有相交，這也意味著傳輸線的
損耗還是都大於電感反射量的補償；相反地，如果加入的補償電感太大，那麼，
電感反射增益斜率的反曲點就會超過有損傳輸線 ( )0H ω 的斜率並有兩處的相交，
因此，經由(4.4)式所得到的最後頻率響應也就會有過大突起的現象。 
0 1 2 3 4 5
(GHz)
-10
-8
-6
-4
-2
0
(d
B)
0 1 2 3 4 5
frequency (GHz)
-1
-0.8
-0.6
-0.4
-0.2
0
Sl
op
e 
(d
B
/G
H
z)
0 1 2 3 4 5
frequency (GHz)
-1
-0.8
-0.6
-0.4
-0.2
0
S
lo
pe
 (d
B
/G
H
z)
0 1 2 3 4 5
(GHz)
-10
-8
-6
-4
-2
0
(d
B
)
0 1 2 3 4 5
(GHz)
-10
-8
-6
-4
-2
0
(d
B)
0 1 2 3 4 5
frequency (GHz)
-1.2
-1
-0.8
-0.6
-0.4
-0.2
0
S
lo
pe
 (d
B
/G
H
z)
frequency (GHz)
frequency (GHz)
frequency (GHz)
()
c
H
ω
(d
B
)
()
c
H
ω
()
c
H
ω
(d
B
)
(d
B
)
傳輸線長: 30"
Lc: 5nH
傳輸線長: 30"
Lc: 7.96nH
傳輸線長: 30"
L_opt: 10nH
( )20log cd Gd ωω ⎡ ⎤−⎣ ⎦
( )020logd Hd ωω ⎡ ⎤⎣ ⎦
補
償
不
足
最
佳
化
補
償
補
償
過
大
( )20log cd Gd ωω ⎡ ⎤−⎣ ⎦
( )020logd Hd ωω ⎡ ⎤⎣ ⎦
( )20log cd Gd ωω ⎡ ⎤−⎣ ⎦
( )020logd Hd ωω ⎡ ⎤⎣ ⎦
 
圖 4.7 傳輸線 ( )0H ω 的斜率與電感反射增益斜率的相對關係 
步驟三，經由上述吾人可以了解到，當其電感反射增益函數斜率(4.10)的反曲
點，也就是其最大斜率處如果剛好與傳輸線 ( )0H ω 的斜率相交時，那麼，此時所
67 
 
0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
-2
-1
0
1
2
3
4
5
6
7
()
2 2
20
lo
g
c
d
G
p
dp
⎡
⎤
⎣
⎦
p  
圖 4.8 電感反射增益在 0.77p = 時有反曲點 
步驟四，當吾人知道此一角頻率與補償電感為一定值的關係式時，就可將其
代回有損傳輸線 ( )0H ω 的斜率(4.9)式(如圖 4.9 中所示的實線)與電感反射增益斜
率(4.14)式在 0.77p = 時(如圖 4.9 中所示的虛線)的交點，即兩斜率在某一頻率時
為相同，如圖 4.9 所示，即為一條 30 英寸有損傳輸線 ( )0H ω 的斜率(4.9)式與電
感反射增益函數斜率(4.14)式在頻率為 0.77GHz 時有相同的斜率，如此，吾人就
可將此頻率再帶回(4.13)式來求得所需的最佳補償電感 cL 了，亦即再串聯一個
7.96nH 的電感就可達到輸出端眼圖有最好的改善效果，其中眼圖的分析會在下一
節中針對不同損耗的傳輸線加入最佳化電感補償後的分析探討。 
92 0.77 10 0.77 50cLπ × × × = ×   7.96cL∴ = (nH) 
69 
 
 
4-1-3 模擬分析 
利用 Agilent 公司所開發的 ADS(Advanced Design System)商用套裝軟體來做
電路的模擬分析，ADS 軟體可模擬分析在時域和頻域下的問題，且它可以考慮在
高頻時的特性，使得在做時域模擬時可更接近實際的情況，這樣出來的模擬結果
也會較為準確。 
這裡吾人就設計了三個例子來驗證上述的理論，分別在傳輸線線長為 20 英寸、
30 英寸和 40 英寸下，加入不同的電感並觀察其眼圖的表現，如圖 4.11 所示的結
構示意圖，FR4 板的設計參數為：介質常數為 4.4、損耗正切為 0.022、金屬的粗
糙表面為 0.4mil、板厚 0.6mm、傳輸線線寬為 1.1mm；來源端 PRBS(Pseudo-Random 
Binary Pulse)的輸入信號為 Vi=0.8V、rise time=50ps、bit rate=5Gbps。在傳輸線的
終端串聯一個電感，接收端的輸入信號在 V2。 
 
50sZ = Ω 50LZ = Ω0 50Z = Ω
( )200 5ps Gbpsτ =
cL
 
        (a) 
4.4
tan 0.022
rε
δ
=
=
 
(b) 
圖 4.11 單根傳輸線補償結構示意圖(a)正視圖；(b)側視圖 
由圖 4.12、圖 4.13、圖 4.14 可觀察到，在加入最佳化的補償電感補償時
(20inch/5.26nH、30inch/7.96nH、40inch/10.66nH)的眼寬(eye-width)為最寬(jitter 為
71 
 
0 1 2 3 4 5
(GHz)
-20
-16
-12
-8
-4
0
20
lo
g(
V
2/
V
1)
 [d
B
]
40"@10.91nH
40"@original
0 4 8 12 16 20
(nH)
60
80
100
120
140
160
180
200
220
240
Ey
e-
H
ei
gh
t (
m
V)
40
60
80
100
120
140
160
180
200
Ey
e-
W
id
th
 (p
s)
cL
()
(
)
c
H
dB
ω
 
(a)         (b) 
圖 4.14 單根傳輸線線長 40 inch 時，(a)不同電感補償後的眼高和眼寬； 
(b)加入補償電感 10.66nH(實線)與未補償時(虛線)的頻率響應圖 
經由上述的眼圖分析結果後，吾人可依據其信號最終進入傳輸線的輸入電壓
(400mV)與脈波寬度(200ps)，將其比上補償前與補償後輸出端的眼高與眼寬，且
觀察其改善百分比，損耗越大時傳輸線的眼高會維持在 20%~30%之間的改善，如
圖 4.15 所示，但眼寬在損耗越大時卻可以有大幅度的改善空間，補償之後的眼寬
會比未補償時的眼寬改善有 50%之多，如圖 4.16 所示，因此，損耗越嚴重時加入
最佳化補償電感後，其眼圖的改善效果也會越明顯。最後再依據 PCI Express2 的
規範，輸出端的最低眼高為 120mV 和眼寬為 80ps(0.4UI)時與輸入電壓比較的百
分比來做個分界，如此，就可判斷出何時需要加入電感來補償，何時不需要加入
電感補償，其輸出端的眼圖也會符合 PCI Express2 的眼圖規範。 
10 20 30 40 50 60
0
20
40
60
80
100
120
400
mV
mV
 
圖 4.15 單根傳輸線損耗加入最佳化電感補償後的眼高改善百分比 
73 
 
步驟一中，先利用 CAP 這套應用軟體工具來求得單位長度的奇模態電容
(pF/m)和電感(nH/m)， 如圖 4.18 所示為 CAP 的程式撰寫和輸出結果。 
4.4rε
x
y
(0.5,0.6) (1.56,0.6)
(1.56,0.6508)(0.5,0.6508)
(-0.5,0.6)(-1.56,0.6)
(-1.56,0.6508) (-0.5,0.6508)
#1 #2
CAP2
1   4.4   0.6                                
2   0   0                             
1                                      
4   1   10                              
-1.56  0.6     -0.5  0.6    -0.5  0.6508      -1.56  0.6508      -1.56  0.6
1                                       
0.5  0.6     1.56  0.6    1.56  0.6508      0.5  0.6508      0.5  0.6
 Matrix of Capacitance Coefficients : (pF/m)
   117.9488    -5.2853
-5.2853   117.9490
 Matrix of Inductance Coefficients : (nH/m)
   305.0706    36.1530
    36.1530   305.0706
 < Note >  Conductors #3-2 are grounded
 Modal Delay : (ns/m)
     5.7567     6.2003
 Modal Impedance : (ohm)
    46.7137    55.0335
 Voltage Transformation Matrix
     0.7071     0.7071
-0.7071     0.7071
 Line Impedance : (ohm)
    50.8736     4.1600
     4.1600    50.8736
 ** saturated NEN at j'th line is about Z (j,i)/2Z(i,i)
Codd=C11+C12
Lodd=L11-L12
Z0dd Zeven
Z0
 
圖 4.18 CAP 軟體說明(a)結構示意圖，單位 mm；(b)程式撰寫；(c)輸出結果 
吾人可以發現到，其設計方式和上述求取單根傳輸線最佳補償電感相似，只
有在一開始用來校正近似公式的 S 參數需為混合模態的 S 參數，因為在差模傳輸
線中會有奇模態和偶模態的存在，所以就需先將 S 參數轉換成混合模態，如圖 4.19
所示。S 參數轉換成混合模態的公式如下： 
11 1211 12
21 2221 22
11 12 11 12
21 22 21 22
11 13 31 33 12 14 32 34 11 13 31
21 23 41 43 22 24 42 441
2
DC DCDD DD
DC DCDD DD
CD CD CC CC
CD CD CC CC
S SS S
S SS S
S S S S
S S S S
S S S S S S S S S S S S
S S S S S S S S
⎧ ⎫⎡ ⎤⎡ ⎤⎪ ⎪⎢ ⎥⎢ ⎥⎣ ⎦⎪ ⎣ ⎦⎪⎨ ⎬⎡ ⎤ ⎡ ⎤⎪ ⎪⎢ ⎥ ⎢ ⎥⎪ ⎪⎣ ⎦ ⎣ ⎦⎩ ⎭
− − + − − + + − −⎡ ⎤⎢ ⎥− − + − − +⎣ ⎦=
33 12 14 32 34
21 23 41 43 22 24 42 44
11 13 31 33 12 14 32 34 11 13 31 33 12 14 32 34
21 23 41 43 22 24 42 44 21 23 41 43 22 24 42 44
S S S S
S S S S S S S S
S S S S S S S S S S S S S S S S
S S S S S S S S S S S S S S S S
⎧ ⎫+ − −⎡ ⎤⎪ ⎪⎢ ⎥+ − − + − −⎪ ⎣ ⎦⎪⎨ ⎬− + − − + − + + + + + +⎡ ⎤ ⎡ ⎤⎪ ⎪⎢ ⎥ ⎢ ⎥⎪ ⎪− + − − + − + + + + + +⎣ ⎦ ⎣ ⎦⎩ ⎭
(4.15) 
75 
 
0 2 4 6 8 10
frequency (GHz)
-40
-30
-20
-10
0
|S
D
D
21
 |(
dB
)
Measurement
Matlab
Matlab_Modify
()
0H
ω
4.4
tan 0.022
rε
δ
=
=
 
圖 4.20 差模傳輸線 ( )0H ω 的校正(實線與虛線分別是量測結果與 
近似模擬結果，點虛線為校正後的近似模擬)。 
最後，將此修正項再帶回(4.9)式與(4.14)式找出有損傳輸線 ( )0H ω 的斜率(如
圖 4.21 中所示的實線)與電感反射增益的斜率(如圖 4.21 中所示的虛線)交點，即兩
斜率在某一頻率時為相同，如圖 4.21 所示，即為一條 30 英寸有損傳輸線 ( )0H ω
的斜率(4.9)式與電感反射增益的斜率(4.14)式在頻率為 0.835GHz 時有相同的斜率，
如此，吾人就可將此頻率再帶回(4.13)式來求得所需的最佳補償電感了，亦即在差
模傳輸線終端再各別串聯一個 7.34nH 的電感就可達到眼圖有最好的改善效果，其
中眼圖的分析會在下一節中針對不同損耗的傳輸線加入最佳化電感補償後來做分
析探討。 
92 0.835 10 38.5cLπ × × × =    7.34cL∴ =  (nH) 
( )020 logd Hd ωω ⎡ ⎤⎣ ⎦
( )
0.77
20 log c
p
d G
d
ωω =
⎡ ⎤−⎣ ⎦
0 1 2 3 4 5
-4
-3
-2
-1
0
 
圖 4.21 30 英寸差模傳輸線長的最佳化電感補償工作頻率 
77 
 
0 1 2 3 4 5
(GHz)
-12
-10
-8
-6
-4
-2
0
20
lo
g(
V2
-V
4)
 [d
B]
Diff.-Line 30"@6.89nH
Diff.-Line30"@original
0 4 8 12 16 20
(nH)
320
360
400
440
480
520
560
Ey
e-
H
ei
gh
t (
m
V)
120
140
160
180
200
E
ye
-W
id
th
 (p
s)
cL
()
(
)
c
H
dB
ω
 
    (a)         (b) 
圖 4.24 差模傳輸線線長 30 inch 時，(a)不同電感補償後的眼高和眼寬；(b)加入補
償電感 7.34nH(實線)與未補償時(虛線)的頻率響應圖 
 
0 1 2 3 4 5
(GHz)
-16
-14
-12
-10
-8
-6
-4
-2
0
20
lo
g(
V2
-V
4)
 [d
B]
Diff.-Line 40"@9.35nH
Diff.-Line40"@original
0 4 8 12 16 20
(nH)
160
200
240
280
320
360
400
440
480
Ey
e-
H
ei
gh
t (
m
V)
120
130
140
150
160
170
180
E
ye
-W
id
th
 (p
s)
cL
()
(
)
c
H
dB
ω
 
    (a)         (b) 
圖 4.25 差模傳輸線線長 40 inch 時，(a)不同電感補償後的眼高和眼寬；(b)加入補
償電感 9.9nH(實線)與未補償時(虛線)的頻率響應圖 
相同地，經由上述的眼圖分析結果後，吾人可依據其信號最終進入傳輸線的
輸入電壓(800mV，-400mV~+400mV)與脈波寬度(200ps)，將其比上補償前與補償
後輸出端的眼高與眼寬，且觀察其改善百分比，損耗越大時傳輸線的眼高會維持
在 20%~30%之間的改善，如圖 4.26 所示，但眼寬在損耗越大時卻可以有大幅度
的改善空間，補償之後的眼寬會比未補償時的眼寬改善有 50%之多，如圖 4.27 所
示，因此，損耗越嚴重時加入最佳化補償電感後，其眼圖的改善效果也會越明顯。
最後再依據 PCI Express2 的規範，輸出端的最低眼高為 120mV 和眼寬為
80ps(0.4UI)時與輸入電壓比較的百分比來做個分界，如此，就可判斷出何時需要
79 
 
4-3 輸入信號與補償效果的關係 
4-3-1 不同速度的輸入信號分析 
在這節裡吾人要討論的是有關不同速度的輸入信號，分別在相同的損耗路徑
上傳送時的信號完整度探討。首先，從圖 4.28 所示可得知一個週期性梯形波的頻
譜分佈圖，分別在1 πτ 和1 Trπ  兩個轉折點後隨頻率增加開始有 20dB/decade 和
40dB/decade 的衰減。 
τ
T r
1
πτ
1
Trπ
A
m
pl
itu
de
 (d
B
)
1
T  
圖 4.28 數位信號能量隨頻率的分佈圖 
本文中輸入信號的衰減還需要考慮外部傳輸線所造成的嚴重損耗，此損耗是
造成輸出波形失真和眼圖變糟的主要原因，而當傳輸線損耗被考慮進去時，信號
在頻率為1 ~ 1 Trπτ π 之間的信號頻譜已經被衰減的相當嚴重，因此考慮頻率在
1 πτ 之前的信號頻譜就可以了，輸入信號的上升時間變化對輸出眼圖的影響相較
下就小得很多，也就是說可以不考慮輸入信號上升時間不同所造成的影響，因此，
吾人最主要是在補償有損傳輸線所造成的嚴重損耗。 
現在吾人就分別假設有三種不同速度的輸入信號(1Gbps、5Gbps、8Gbps)，如
圖 4.29(a)所示，其輸入信號的主要1 πτ 頻譜會分別分佈在補償後所得到的最佳化
頻率響應(即在低頻段時有一段頻率持平的現象)的三個區段內，如圖 4.29(b)，觀
察當輸入信號的速度越來越快時，接收端的信號是否利用此補償後所得到的最佳
化頻率響應也還有良好的信號完整度。 
81 
 
輸入信號的主要1 πτ 頻譜分佈在C區段內時，此時的輸入信號速度變得更快，
其信號的主要能量頻譜會擴展分佈至更高頻的範圍，越往高頻時信號的衰減也會
越趨嚴重，因此，加入額外的補償就顯得更為重要，但當頻率越高時，其補償效
果也將被限定在全反射時的最大 6dB 來做補償。 
0.2 0.4 0.6 0.8 1.0 1.2 1.4 1.6 1.80.0 2.0
0.0
0.1
0.2
0.3
0.4
-0.1
0.5
time, nsec
A
0.2 0.4 0.6 0.8 1.0 1.2 1.4 1.6 1.80.0 2.0
0.0
0.1
0.2
0.3
0.4
-0.1
0.5
time, nsec
A
50 100 150 200 250 300 3500 400
0.0
0.1
0.2
0.3
0.4
-0.1
0.5
time, psec
A
50 100 150 200 250 300 3500 400
0.0
0.1
0.2
0.3
0.4
-0.1
0.5
time, psec
A
50 100 150 2000 250
-0.0
0.1
0.2
0.3
0.4
-0.1
0.5
time, psec
A
50 100 150 2000 250
0.0
0.1
0.2
0.3
0.4
-0.1
0.5
time, psec
A
圖 4.30 頻率響應與不同速度的輸入訊號在補償後的眼圖分析 
針對圖 4.30 所示，在補償後的頻率響應下加入不同的輸入訊號速度(分別是
1Gbps、5Gbps、8Gbps)的眼圖分析結果，吾人將其眼高改善百分比整理成如圖 4.31
83 
 
的最佳化補償還好而形成一種 trade-off 的現象嗎?因此，吾人就針對這個問題做個
參數分析來分析此問題，以圖 4.32 中所示的三種補償情況，分別是 Case1，其補
償到在低頻處有一段持平的現象時；Case2，其過度的補償而使得某段頻段處會有
突起時；Case3，也是個過度補償，但其被補償到高過 0dB，也就是有增益(gain)
的產生時，分別對三種不同更快速度的輸入信號，5GHz、6.25GHz 和 8GHz 來做
其輸出眼圖的比較分析，分析結果可由圖 4.33 所示得知，結果並非吾人所猜測的
那樣，越快的輸入信號落在過大的補償 S 參數時，眼皮會越厚，也就是信號的衰
減會越大，jitter 也會增加，因此，由此參數分析的結果可得知，S 參數的補償還
是補償到有一段持平的現象其眼圖會是最好的改善。 
0 1 2 3 4 5
-10
-8
-6
-4
-2
0
2
5GHz
6.25GHz
8GHz
()
c
H
ω
 
圖 4.32 高速信號頻譜與過度補償的頻率響應 
85 
 
線寬為 5.5mil、線距為 10mil，差模傳輸線損耗(即 SDD21 值)若在頻率 ( )1 2 1 1 Tπτ +
處已衰減到-10.45dB( ( )20log 0.12 0.4  )，那麼眼圖就需要加入補償電路來達到 PC
I Express Gen2 的規範，但如果衰減超過了-16.45dB(-10.45dB+(-6dB))時，也就是
表示衰減已超過可以補償的最大全反射 6dB 範圍，那麼，此時吾人再加入多大的
電感補償都已無法達到 PCI Express2 規範的要求了，如圖 4.35 所示。 
 
圖 4.34 PCI Express 規格 
1 1 1 2.05
2
GHz
Tπτ
⎛ ⎞+ =⎜ ⎟⎝ ⎠
4.2
tan 0.025
rε
δ
=
=
△
0 1 2 3 4 5
(GHz)
-45
-40
-35
-30
-25
-20
-15
-10
-5
0
S
D
D
21
 (d
B
)
0.1220log
0.4
⎛ ⎞⎜ ⎟⎝ ⎠
1
πτ
1
T
 
圖 4.35 經驗法則得出補償電路的適用範圍 
 
 
87 
 
0 2 4 6 8 10
(GHz)
-10
-8
-6
-4
-2
0
S
21
 (d
B
)
Cable Loss
0 2 4 6 8 10
(GHz)
-10
-8
-6
-4
-2
0
S
21
 (d
B
)
Probe Cable Loss
DSO
PG
PROBE
 
圖 4.37 量測環境 
本章節的實驗因為所需量測的眼圖在高阻抗元件前端，因此，吾人使用了太
克(Tekronix)公司的探針來量測眼圖，如圖 4.3 所示的量測方法。 
 
圖 4.38 探針量測方式 
探針在使用量測時需注意其接地迴路要盡可能的短，這樣所量測到的結果也
會較準確，因為較大的接地迴路會產生一個較大的高阻抗不連續迴路，此迴路可
被看成是電感性，而且實際上量到的上升時間也會被影響改變，如圖 4.39 所示。 
89 
 
線的損耗利用相同的傳輸線損耗來近似，其近似出的傳輸線線長就需再加到原本
的模擬線長參數中，即原本的 40 英寸要再加上 3 英寸的同軸傳輸線所造成的損耗
來模擬。 
串聯補償電感是 Murata 公司的表面接著元件(SMD ，Surface Mount Device) 
10nH，因此，模擬的電感也需利用 Murata 所提供的元件模型來做模擬，如此可
將等效電阻和電容一並考慮進去以增加模擬時的非理想程度，如圖 4.42 所示。 
0 2 4 6 8 10
(GHz)
-10
-8
-6
-4
-2
0
S
21
 (d
B
)
Cable Loss
TX Line Loss=3inch
 
               (a)                            (b) 
圖 4.41 量測誤差因素 (a)進入待測物的上升時間；(b)同軸傳輸線所造成的損耗 
V1 V2
MLIN
TL17
L=43 in
W=1.1 mm
Subst="MSub1"
R
R15
R=50 Ohm
LQP03
L4
PartNumber=LQP03TN10NH04
VtBitSeq
SRC32
BitSeq=X
Fall=85 psec
Rise=85 psec
Rate=5 GHz
Vhigh=0 V
Vlow=0.8 V
t
R
R14
R=50 Ohm
 
圖 4.42  ADS 模擬結構 
首先，模擬和量測不加任何補償時 40 英寸長傳輸線的眼圖，如圖 4.43(a)所
示，為 ADS 模擬時的眼高 97mV 和眼寬 135ps；如圖 4.43(b)所示，為量測時的眼
高 94mV 和眼寬 121ps，可觀察到模擬與量測的結果相近。 
91 
 
表 4.3 40 英寸傳輸線眼圖模擬與量測比較表 
 補償前 補償後 改善百分比 
 眼高(mV) 眼寬(ps) 眼高(mV) 眼寬(ps) 眼高 眼寬 
理想模擬 97 145 198 165 103％ 13％ 
非理想模擬 97 135 188 160 94％ 18％ 
實際量測 94 121 180 158 92％ 30％ 
4-5-3 差模傳輸線補償 
相同的 FR4 板材(介質常數為 4.4、損耗正切為 0.021、板厚 0.6mm、傳輸線
線寬為 1.06mm、兩線間距為 1mm)，設計一對差模傳輸線長 40 英寸的損耗，需
要各別串聯一個電感為 9.35nH 來補償以達到最佳的眼圖，這裡吾人改以 10nH 來
做補償，現在就以實際量測來做驗證。實驗板材設計如圖 4.46 所示。 
 
圖 4.46 差模傳輸線補償待測物實體照片 
圖 4.47 所示為 40 英寸差模傳輸線長的眼圖，圖 4.47(a)為 ADS 模擬時的眼高
1205mV 和眼寬 150ps；圖 4.47(b)為量測時的眼高 205mV 和眼寬 150ps，可觀察
到模擬與量測的結果相近。 
50 100 150 200 250 300 3500 400
-0.2
0.0
0.2
-0.4
0.4
time, psec
E
ye
D
ia
gr
am
e
 (b) 
圖 4.47 40 英寸差模傳輸線模擬與量測眼圖(a)模擬結果；(b)量測結果 
93 
 
第五章 損耗傳輸線轉換函數之理論推導 
 
5-1 眼圖取得原理 
傳統上取得眼圖的方式是將準隨機二進位序列(PRBS)輸入所關心的幾條通
道，每一個通道的輸出波形都疊在一個信號的位元上，再將每一個通道疊好的圖
全部疊在一起，即可得到眼圖。以下將以一個實際的例子來說明。 
 
圖5.1 單一通道輸出波形疊成眼圖 
如圖 5.1 所示，為單一通道的眼圖疊法，圖中假定通道接收端邏輯閘是在時
脈信號(CLK)的上升邊緣才能讀取信號(DATA)，故一個完整位元需要三個上升邊
緣所讀取出的電壓才算完整。圖的下方兩排為邏輯閘讀出的第七、第十一、第八、
第十四個位元。將所有讀出的完整位元疊在一起如圖的右下方小圖所示，即為單
一一條通道的輸出眼圖。 
今考慮圖 5.2 由三條通道組成的電路，按照上述方式將各自的輸出眼圖疊在
一起可以得到完整的眼圖如圖 5.3 所示，其中最重要的兩個訊息為眼高與眼寬，
眼高需抓取在該系統時脈的上升邊緣。而圖中的信號抖動(Jitter)即為一個位元的
時間(另稱波寬)減去眼寬。 
95 
 
 
圖5.4 通道散射參數預測接收端眼圖的信號流程 
    本研究採用信號處理的方式如圖 5.4 所示，將經由量測或模擬得到的穿透損
耗(insertion loss, )(Slog20 2110⋅ ，「穿透損耗」、「轉換函數」兩者定義不完全一樣，
但在一般印刷電路板的傳輸線上，由於損耗不足以大到影響特徵阻抗，而使得兩
者可以混用(其原因將在第六章中詳細探討)，曲線回歸到轉換函數曲線上，使用
反傅立葉轉換將其轉換到時域上成為脈衝響應，再與輸入信號作線性旋積(linear 
convolution)得到輸出波形。輸出波形按照上述方式疊合之後即可得到眼圖。 
 
5-2 問題描述 
上一節提到取得眼圖需要輸入準隨機二進位序列，而關於準隨機二進位序列
的產生方式，是定為由(n+1)個位元所產生位元長度為 12 -n 的二進位位元序列，
其最短的為 12 -7 位元，最長的為 12 -31 。而實際上要將這麼長的信號代進信號
處理的流程不但相當耗費時間與記憶體，由於其也將因為模擬結果太大量、太過
隨機、複雜而無法觀察傳輸線損耗以何種物理機制對波形造成影響。因此，找出
能產生最差眼圖的位元組合來當作輸入信號就成為很重要的關鍵。 
Input Signal Impulse Response Output Signal
Scattering Parameters
From commercial software 
or from measurement
Inverse Fourier 
Transform
From transmission line 
model
enlCjGLjReH ⋅+⋅+−= )()()( ωωω
Transfer Function
Curvilinear 
Regression
97 
 
後以此等效模型推導傳輸線的理論轉換函數。 
由馬克士威方程式的前兩條公式(5.1)，法拉第定律與修正過的安培定律出發，
推導平面波在平行金屬板中的介質傳播的荷姆霍茲方程式(Helmholtz equation) 
(另稱波動方程式 wave equation)，藉此了解介質損耗的物理機制，結構如圖 5.1
所示。 
 
圖 5.1 平行金屬板結構 
- ;
;
  ;       ;
  ;       ' ";
E j B
H j D J
B H D E
J E j
ω
ω
μ ε
σ ε ε ε
∇× =⎧⎨∇× = +⎩
= =
= = +
                         (5.1) 
接著將介電常數的詳細定義與金屬表面電流、位移電流的定義代入安培定律
中得到 
' "
"       ( '- "- ) '(1- )
'
H j E E E
j j j E j j E
ωε ωε σ
σ ωε σω ε ε ωεω ωε
∇× = + +
+= =         (5.2) 
在此將介質中，位移電流的損耗與漏電流的損耗歸為同一項並將之定義為 
'
"tan ωε
σωεδ +=                            (5.3) 
將(5.3)代入(5.2)中，得到 
)Ejtan-(1'jH δωε=×∇                (5.4) 
再將(5.1)法拉第公式左右兩邊同時取旋度(curl ： ×∇ )，並將(5.4)代入，得到 
2(- ) '(1- tan )E j H j Eωμ ω με δ∇×∇× = ∇× =      (5.5) 
x
y z
σ
cσ
"'-jεεε = μ
99 
 
 
圖 5.2 傳輸線等效電路模型 
得到的傳輸線等效電路模型之後，再使用柯西何夫電壓定律與電流定律
(Kirchhoff’s voltage law、Kirchhoff’s current law , KVL、KCL)在一個等效的單元內
如圖 5.3 所示，可得到 
0t)z,i(z-
t 
t)z,v(z zC-t)z,zv(zG-t)i(z,
0t)z,v(z-
t 
t)i(z, zL-t)i(z,z R-t)v(z,
=Δ+∂
Δ+∂ΔΔ+Δ
=Δ+∂
∂ΔΔ
      (5.12) 
將 0z →Δ 即可化作此等效電路的電報方程式(Telegrapher equation) 
⎪⎪⎩
⎪⎪⎨
⎧
∂
∂=∂
∂
∂
∂=∂
∂
t 
t)v(z, C-t)-Gv(z,
z 
t)i(z, 
t 
t)i(z, L-t)i(z, -R
z 
t)v(z, 
             (5.13) 
弦波穩態(sinusoidal steady-state)時可以寫成相量(phasor)形式，即 
-
Vs
+
signal trace
ground plane
...
...
cell
Transmssion line model
R
CG
L
101 
 
s d
0
s d
j ;    
1 ;    tan
R R G G
R G C D
W
ω ω
μ
σ
= ⋅ = ⋅
= = ⋅
                      (5.18) 
若將傳輸線等效模型的傳播常數根號內的兩個括號乘開，就可以得到四項如 
RGRCjGLjLCj +++= ωωωγ 2)(           (5.19)  
而最後一項ＲＧ在一般的情形之下都會遠小於前三項，即滿足 1
)( 2
<<
LC
RG
ω 而可
以忽略，進而得到 
2 ( )( ) 1 GL RCj LC j GL j RC j LC
j LC
γ ω ω ω ω ω
+≈ + + = ⋅ +      (5.20) 
 若 1)( <<+
LCj
RCGL
ω 則可以使用只取前兩項的泰勒展開式來近似得到 
d
d
1 2 3
( ) ( )(1 )
2 2
)
2 2 2 2
2 2
s
s
GL RC GL RCj LC j LC
j LC LC
CR jRC GL LGj LC j LC
LC LC LC LC
R j C G Lj LC
L C
ω ωω
ω ωω ω
ω ωω γ γ γ
+ +≈ + = +⋅ ⋅
⋅= + + = + +⋅ ⋅ ⋅ ⋅
⋅= + + = + +
    (5.21) 
最後將傳播常數整理成三項，這三項分別代表著傳輸線的延遲，金屬損耗隨頻率
變化，介質損耗隨頻率變化。將此三者帶回原轉換函數的式子中得到 
1 2 3 31 2( )
1 2 3( ) ( ) ( ) ( )
l ll llH e e e e e H H Hγ γ γ γγ γγω ω ω ω− + + ⋅ − ⋅− ⋅ − ⋅− ⋅= = = ⋅ ⋅ = ⋅ ⋅  (5.22) 
其中，三個轉換函數為 
⎪⎪⎩
⎪⎪⎨
⎧
==
==
==
⋅⋅−⋅−
⋅−⋅−
⋅−⋅−
l
C
LG
l
1
l
L
CjR
l
1
lLCjl
1
d
s
ee)(H
ee)(H
ee)(H
2
2
2
1
0
ω
γ
ω
γ
ωγ
ω
ω
ω
               (5.23) 
 
103 
 
{ } { } d3
d
1 1 1 2
3 3
2
2 2
( ) ( )
1       lim ( )
2 ( )
G L ll C
G L l j tC
h t H e e
ce e d
c t
ω
γ
ωβ ω
ββ
ω
ωπ π
⋅− ⋅− ⋅− − −
⋅− ⋅
−→∞
⎧ ⎫⎪ ⎪= = = ⎨ ⎬⎪ ⎪⎩ ⎭
= = ⋅ +∫
F F F
          (5.27) 
上述三個部份的脈衝響應中設定的四個參數 
2 d
0 ,   ,   ,   2
4
sR l G Lt LCl A B A c l
CL
C
ππ
⋅= = = ⋅ = ⋅⋅⋅
        (5.28) 
 
5-5 使用 K-K 關係式解決不符合因果律的問題 
觀察(5.27)，可以發現函數 (t)h3 即使是在 0t < 時，其值不為零，這違反信號
符合因果律需滿足的條件。而任何物理機制都不能違反因果律，實際傳輸線上的
信號亦受限於光速而必須滿足因果律。 
在許多文獻上，都探討到傳輸線模型在時域上不符合因果律的問題。在[29]
中使用了一個相位的修正項，來使得傳輸線在時域的表現符合因果律；在[30]中
使用了與量測數據曲線近似(curve fitting)的介電常數公式，來解決不符合因果律
的問題。但這些方法都不能針對介質損耗所導致不符合因果律的問題，直接修正。
以下將使用物理上的 K-K relations 來修正前述介質損耗部份不符合因果律的問
題。 
Kramers-Kronig 關係式 [31] 最早被提出來解決材質電極化率 (electric 
susceptibility)不符合因果律的問題，由於物理上 impulse response 應該只有在時間
為正時才有值，其傅立葉轉換後在頻域量測到的實部及虛部必須滿足 
{ } { }
{ } { }dx
-x
)(ReP2-)(Im
dx
-x
)(ImxP2)(Re
0 22
e
e
0 22
e
e
∫
∫
∞
∞
=
⋅=
ω
ωχ
π
ωωχ
ω
ωχ
πωχ               (5.29) 
105 
 
{ } { }-1 1g
c
3
2
1( ) e lim ( )
2
1 1                   lim ( ) c h (t)
2 c (1 ( ) )
c
j t
tj
H e e d
e e d t
βξ ξ ω
ββ
β ξξ
ββ
ξ ωπ
ξπ π
−− − ⋅
−→∞
⋅−
−→∞
= =
= = = ⋅⋅ ⋅ +
∫
∫
F F
   
(5.34) 
若將時間 t 除以 c 視為新的正規化時間 z = t/c，即可得到一個與 c 無關的脈衝
響應函數 
)( 2z1
1(z)hg +⋅= π                     (5.35) 
將其所對應的時域脈衝響應 (z)h4 代入 K-K relation 的修正流程中，經由數值積分
得到 (z)h4c ，茲將修正時所積分出來的虛部與本來的實部繪出在圖 5.4 中。 
 
圖 5.4 K-K 關係式積分出來轉換函數的虛部及其原本的虛部 
經過數值上的比對可以發現 K-K relations 的修正其實是將負時間的能量修正
到正時間來，使正時間的函數值幾變為兩倍，其修正前後函數與時間軸所夾面積
不變。於是原本的介質損耗脈衝響應解析公式 (t)h3 可以使用近似式 
{ } u(t)
tc
c2Hth4 )(
)()( 223
1
+⋅
⋅=≈ − πωF                (5.36) 
以滿足因果律。茲將修正前 (z)h4 與修正後 (z)h4c 與近似公式曲線如圖 5.5(a)所示，
0 1 2 3 4 5
-0.5
0
0.5
1
K-K relations
ω*c
 F
re
qu
en
cy
 R
es
po
ns
e,
 H
3c
(d
B
)
ReH3c
ImH3c
107 
 
0 0
0
1 2 4
3 3
0( ) ( )3 3
0 0
2 2
0 ( )3
0
( ) ( ) ( ) ( )
      ( ) ( )
( ) ( )
2      ( - )
( ( ) )
( )
t
B B
t t t t
t
B
t t
h t h t h t h t
A Ah t h t d
t t e t e
c A u t d
c t
t e
τ
τ
τ
τ
τ τ
τ
τ τπ τ τ
=
=− −
=
= −
≈ ∗ ∗
= ∗ = − ⋅ ⋅
− −
⋅= ⋅ ⋅ ⋅⋅ + − −
∫
∫
  (5.37) 
由於這個積分式相當複雜而難以進行積分，若要再做近似將其勉強積分出來，可
能導致更多的誤差，不再往下推導，而將此式在應用時使用數值積分得到完整脈
衝響應。 
得到傳輸線在時域上的脈衝響應之後，便可以將其與輸入波形做線性旋積
(linear convolution)得到輸出波形。 
接著使用板厚 1 (mm)，Fr4 板材，配合先前所提出的輸入信號圖樣，使用 PCI 
Express II 的信號規格：高位電壓為 800 (mV)，波寬 200 (ps)，信號上升時間為 20 
(ps)，進行測試上述流程所產生之眼圖。此結構所得到的轉換函數如圖 5.6。 
在圖 5.6 中我們可以發現雖然在推討脈衝響應時做了兩次近似，但近似過後
的轉換函數仍與原本的轉換函數吻合。將尺寸參數代入上述的脈衝響應公式中可
以得到該微帶線的脈衝響應如圖 5.7(a)，與輸入信號旋積便可得到輸出波形如圖
5.7(b)與(c)，再將輸出波形疊成眼圖如圖 5.8(a)，為了觀察方便，將圖 5.8(a)往右
複製一份，得到圖 5.8(b)。 
 
圖 5.6 範例傳輸線的散射參數(藍實線)與兩次近似後的轉換函數 
0 2 4 6 8 10
-20
-15
-10
-5
0
S21
Frequency (GHz)
(d
B
)
Origin
Approx
109 
 
 
圖 5.8 輸出端眼圖 (a) 利用本文提出的輸入信號圖樣得到的眼圖 
(b) 將(a)往右複製一個位元 
 
5-6 有損傳輸線近似步級響應 
傳輸線的損耗來自於金屬與介質，若是金屬損耗遠大於介質損耗，在[11]中
已有推導出忽略介質損耗而只包含金屬損耗的步級響應，其結果為 
ττ d)
Bcerf(
t
1f(t) r0
r0
t-t
t-t-t
r
⋅= ∫                   (5.38) 
由於一般傳輸線的介質損耗在高頻比金屬損耗顯著，若忽略金屬損耗，則可
能有機會將傳輸線的轉換函數與具有上升時間的步級函數(step function)作理論的
旋積計算，進而得到步級響應(step response)的數學形式。只具有介質損耗的脈衝
響應與具有上升時間的步級函數如圖 5.9 所示。 
 
圖 5.9 (a)介質損耗所對應的脈衝響應 (b)具有上升時間的步級函數 
0 0.1 0.2 0.3 0.4
0
0.1
0.2
0.3
0.4
Eye Pattern
Time (ns)
V
ol
ta
ge
 (V
)
0 0.1 0.2
0
0.1
0.2
0.3
0.4
Eye Pattern
Time (ns)
V
ol
ta
ge
 (V
)
(a) (b)
u(t)
tc
c2h(t) 22 ⋅+⋅= π g(t)
(a) (b)
111 
 
1 2 2 2 20 0
2
2
2 20 0
2 1 2( ) -
2 sec 2 tan       - sec
sec sec
2 2 2       - ln sec ( - ln sec )
a a
t t
r r
r r
a a a a
r r r
ct ck t d d
t c t c
t c cd c d
ct ct
t c t c
t t t
θ θ
ττ τπ τ π τ
θ θθ θ θπ θ π θ
θ θ θ θπ π π
= + +
=
= =
∫ ∫
∫ ∫               (5.43) 
-
2 2 2 2 2 2 2- - 0
2 2-2
2 2 20
2 1 2 2 1( ) -
2 sec 2 tan 2 sec       - sec
sec sec sec
2 2 sec 2 2       ( - ) - ln -
sec
r
r r
a a r
b b
t t t t
t t t t
r r
t t
r r
a
a b b a
r r b r
ct c ck t d d d
t c t c c
t c c c cd c d d
ct ct
t c t
t t t
θ θ
θ θ
ττ τ τπ τ π τ π τ
θ θ θθ θ θ θπ θ π θ π θ
θθ θ θ θπ π θ π π
= ++ + +
= +
= + =
∫ ∫ ∫
∫ ∫ ∫
sec- ln
sec
r a
b
r r b
t t c
t t
θθ θ
⎛ ⎞−⎜ ⎟⎝ ⎠
  (5.44)
 
到此已經推導出傳輸線忽略金屬損耗時的步級響應了。若要使用此步級響應
來近似輸出波形，就必須先在頻域上把轉換函數近似為忽略金屬損耗的轉換函數，
如圖 5.11。以下使用一個例子來說明近似轉換函數的使用方法。 
 
圖 5.11 以斜直線近似原本損耗傳輸線之轉換函數示意圖 
由於介質損耗部分的轉換函數在取分貝值之後對頻率做圖，為一斜直線如圖
5.11 中的紅線，固取頻率為零和頻率為 PCI Express Gen2 基頻(6.5GHz)的兩點架
出斜直線，並藉由此斜直線的斜率去計算介質損耗需要放大多少倍才能彌補被忽
略的金屬損耗。圖 5.11 中的藍線為取分貝值過後的傳輸線完整轉換函數。圖中參
f)elog202-(c)(elog20y 110
f2-c
10 ⋅⋅⋅⋅⋅=⋅= ⋅⋅⋅ ππ
)e(log20H lCjGLjR10
⋅+⋅+−⋅= )()()( ωωω
113 
 
 
圖 5.13 (a)~(c) ㄧ正ㄧ負的步級響應合成邏輯壹 
(d)~(f) 邏輯壹與邏輯零重疊 
 
圖 5.14 利用脈衝響應與近似轉換函數得到之眼圖比較 
  
0 2 4 6 8
x 10
-10
0
0.2
0.4
0 2 4 6 8
x 10
-10
-0.4
-0.2
0
0 2 4 6 8
x 10
-10
0
0.2
0.4
0 2 4 6 8
x 10
-10
0
0.2
0.4
0 2 4 6 8
x 10
-10
0
0.2
0.4
0 2 4 6 8
x 10
-10
0
0.2
0.4
293.53 mVTotal impulseR
4.3 %306.35 mVthis work
ErrorEye Height
188 psTotal impulseR
1.1 %190.2 psthis work
ErrorEye Width
0 0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.4
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
Eye Pattern
Time (ns)
V
ol
ta
ge
 (V
)
115 
 
 
圖6.2 (a)當信號波寬變動時的眼高 (b)當信號波寬變動時的眼寬 
如圖6.3(a)所示為一般傳輸線的穿透損耗，若將其橫軸，即頻率軸取對數即可
得圖6.3(b)，再與輸入數位信號的頻譜包絡線如圖6.3(c)相乘，輸出信號頻譜在第
一個轉折點(即頻率等於 πτ
1 )之後的頻譜已經以超過-20 (dB/decade) 下降，更高頻
部份的信號成份勢必嚴重衰減，而由轉態時間(transition time) rt 所造成輸入頻譜的
第二個轉折點(即頻率等於
r
1
tπ )在輸出頻譜上將較無影響力。換句話說，信號通過
傳輸線後，大部分的能量都將聚集在低頻。故理論上信號的波寬τ 與信號轉態時
間 rt 相比，波寬將對眼圖有較大的影響。 
 
圖 6.3 (a)傳輸線穿透損耗 (b) (a)的橫軸座標取對數 (c)信號頻譜的包絡線 
 
在上一章中得到的傳輸線脈衝響應為如下形式 
200 400 600 800 1000 1200
50
60
70
80
90
100
Varying UI (tr=20ps)
UI (ps)
E
ye
 H
ei
gh
t (
%
)
H = 5mil
H=0.4mm
H=1.0mm
200 400 600 800 1000 1200
0.92
0.94
0.96
0.98
1
Varying UI (tr=20ps)
UI (ps)
E
ye
 W
id
th
 (%
)
H = 5mil
H=0.4mm
H=1.0mm
0 1 2 3 4 5 6 7 8 9 10
x 10
9
-18
-16
-14
-12
-10
-8
-6
-4
-2
0
Frequency Response Magnitude
Frequency (GHz)
M
ag
ni
tu
de
 (d
B
)
Another H
H
）（dBS 21
108 109 1010
-18
-16
-14
-12
-10
-8
-6
-4
-2
0
Frequency Response Magnitude
Frequency (GHz)
M
ag
ni
tu
de
 (d
B
)
Another H
H
）（dBS 21
f (log scale)
Input Signal 
Spectrum (dB)
πτ
1
tr⋅π
1
decadedB /0 
decadedB /40 −
decadedB /20 −
117 
 
  
(a)                                (b) 
圖 6.4 (a)眼寬 An-cn 圖 (b)眼寬 An-cn 圖 
 
6-2 取得參數 An與 cn的方法 
上一節中提到決定傳輸線接收端眼圖的兩個重要參數，若已萃取出傳輸線等
效模型的元件值，即可藉由理論公式(6.3)計算出An與cn。此外，也可以利用模擬
或量測得到的穿透損耗來取得該傳輸線的參數An與cn。 
但在定義上，穿透損耗、頻率響應、轉換函數三者有所出入。穿透損耗為散
射參數(Scattering Parameters)中的S21取分貝，而散射參數只定義在待測物(device 
under test, D.U.T.)各埠(port)入射波、反射波的比值上，埠端的不匹配將造成反射
進而對於波的傳遞有影響，故穿透損耗包含了不匹配效應；頻率響應，定義在匹
配系統中，只與待測物內部機制有關，其數學形式又可稱為轉換函數。 
前述方法的An與cn兩參數，來自傳輸線理論模型在兩埠匹配無反射波的前提
之下推導出來的轉換函數，但一般商用模擬軟體或者量測都只能得到散射參數，
故以下將使用信號流程圖(signal flow diagram) 的分析技巧來從HSPICE萃取出的
散射參數中去除不匹配效應來得到該傳輸線的轉換函數。 
如圖6.5(a)所示為包含兩端不匹配效應的信號流程圖，此圖中的散射參數為匹
配情形之下的散射參數，理論上此S21應同於先前所提到的轉換函數。故以下將設
法解出圖6.5中的S21。 
515
15
25
25
25
35
35
35
35
45
45
45
4555
55
55
65
65
65
75
75
85
95
Eye Height (%)
cn
A
n
0 0.1 0.2 0.3 0.4 0.5
0
0.05
0.1
5
15
25
35
35
45
45
55
55
55
65
65
65
65
75
75
75
75
85
85
85
85
95
95
Eye Width (%)
cn
A
n
0 0.1 0.2 0.3 0.4 0.5
0
0.05
0.1
119 
 
   
)
S-1
SS(S-1
S-1
SSS
F
22l
2112l
11s
22l
2112l
11
11
Γ
Γ+Γ
Γ
Γ+
=                    (6.5) 
由於傳輸線為對稱網路(symmetric network)，前後兩埠的阻抗也相同，故滿足 
12 21 11 22;     ;      l sS S S S= = Γ = Γ            (6.6) 
可將S12取代為S21，將S11取代為S22，將Γl取代為Γs，得到 
11
2 2
11 2121 11 21
21 112 2 2 2 2 2 2 2
11 11 21 11 11 21
-
;    
1 2 1- 2 -
s ss
s s s s s s
S S SS S SF F
S S S S S S
Γ + Γ− Γ= =− Γ + Γ − Γ Γ + Γ Γ      (6.7) 
可以發現式中仍有三個未知數，根據矩陣代數學中的克拉瑪法則(Cramer's Rule)，
n個未知數就需要n條獨立方程式才能解出未知數。以目前兩條獨立方程式是無法
解出三個未知數的。 
但根據理論傳輸線的轉換函數，線長變為兩倍時，轉換函數值變為原先的平
方。且線長的變化與傳輸線特徵阻抗無關，即不影響反射係數。故若另外萃取出
線長為兩倍的散射參數，即可聯立解出S21，此解決方法示意圖為圖6.6所示。 
 
圖6.6 利用兩倍關係線長的散射參數解決不匹配效應 
其中的A11、A21為與F11、F21相對應的HSPICE萃取出的兩倍線長散射參數。而L11、
L21為與S11、S21相對應的匹配時的兩倍線長散射參數。此聯立方程式中有五個未
知數：L11、L21、S11、S21與Γs ，五條方程式。 
l l
⎪⎪⎩
⎪⎪⎨
⎧
ΓΓ+Γ
Γ+Γ=
Γ−Γ+Γ−
Γ−=
2
21
2
s
2
11
2
s11s
2
21s
2
s11
11
2
21
2
s
2
11
2
s11s
s
21
S-SS2-1
SS-S
F
SSS2
SSSF
11
1
211121
⎪⎪⎩
⎪⎪⎨
⎧
ΓΓ+Γ
Γ+Γ=
Γ−Γ+Γ−
Γ−=
2
21
2
s
2
11
2
s11s
2
21s
2
s11
11
2
21
2
s
2
11
2
s11s
s
21
L-LL2-1
LL-L
A
LLL2
LLL
A
11
1
211121
121 
 
特徵阻抗很接近兩埠的阻抗值，也就是不匹配效應不顯著。 
 
圖6.8 信號流程方法解出兩種傳輸線的特徵阻抗值 
圖6.8中解出的兩種傳輸線特徵阻抗值經過比對與HSPICE計算傳輸線特徵阻
抗的軟體LineCalc更是完全吻合。故知以上方法確實能由萃取出的散射參數解出
傳輸線的轉換函數，且一般印刷電路板的阻抗由於容易設計得與兩埠端阻抗匹配，
致使其萃取出的散射參數能當作轉換函數來使用。 
經由模擬或量測得到的傳輸線穿透損耗若已經相當圓滑，即可根據理論傳輸
線頻率響應取分貝值後的公式 
- LC len 2 j 2
10 10 10
1 1
10 10
20 log ( H( ) ) 20 log ( e ) 20 log (e )
  ( 20 log (e )) (40 log (e ) )
A x cx A x cx
r r
y
c x A x c x A x
π πω
π
⋅ − − − −= ⋅ = ⋅ = ⋅
= − ⋅ ⋅ ⋅ − ⋅ ⋅ ⋅ = − ⋅ − ⋅
   (6.11) 
在該穿透損耗曲線上，任意取兩點解出聯立方程式 
⎩⎨
⎧
⋅−⋅−=
⋅−⋅−=
rr
rr
Axcxy
Axcxy
222
111                   (6.12) 
中的Ar與cr值。式中 1x , 2x 為角頻率(單位：rad/s)， 1y , 2y 為穿透損耗(單位：dB)。
得到Ar與cr後再算出參數A與c即可。而A與 rA 、c與 rc 的關係式如下 
e40
A
A r
10log⋅
= π ;    e
c
c r
10log20 ⋅
=           (6.13) 
若取得的傳輸線穿透損耗不圓滑如圖6.9(b)，亦可使用曲線回歸(curvilinear 
2 4 6 8 10
48
48.5
49
49.5
50
Freq. (GHz)
C
ha
ra
ct
er
is
tic
 Im
pe
da
nc
e 
( Ω
)
Thickness = 1 (mm)
Thickness = 5 (mil)
123 
 
 
圖 6.10 微帶線結構 
將此十五種組合的傳輸線使用HSPICE萃取出S21，並且利用前述的曲線回歸
技巧找出其(An , cn)數對，茲將第一組範例中的第一與六種傳輸線的穿透損耗與其
回歸得到的曲線繪出如圖6.11所示，而得到的第一組(An , cn)列於表6.1中，第二組
(An , cn)列於表6.2中。 
 
圖 6.11 第一組範例其中兩種情形的 S21 及其回歸後的曲線 
表 6.1 第一組範例的六組(An , cn)數對 
 
表 6.2 第二組範例的六組(An , cn)數對 
0 2 4 6 8 10
-20
-15
-10
-5
0
Freq. (GHz)
S
21
 (d
B
)
S21 of Case 1
Regressed Curve of Case 1
S21 of Case 6
Regressed Curve of Case 6
cn=0.169cn=0.112cn=0.054
An=0.005(8)
An=0.005(5)
An=0.005(2)σ=5.8*107
cn=0.169cn=0.112cn=0.054
An=0.033
(7)
An=0.033
(4)
An=0.033
(1)σ=2.0*106
Tanδ=0.03Tanδ=0.02Tanδ=0.01len(in)
125 
 
表 6.5 使用本文方法預測第一組範例的接收端眼高與眼寬 
 
表 6.6 使用本文方法預測第二組範例的接收端眼高與眼寬 
 
由表6.5及6.6可以看出使用An-cn圖預測接收端眼高與眼寬的誤差小於7.1％，
另將HSPICE模擬得到的與本方法得到的兩組範例中的兩個第一種傳輸線接收端
眼圖繪出如圖6.12與6.13所示，兩種方法得到的眼圖形狀亦相當吻合。 
 
圖 6.12 第一組範例第一種傳輸線 (a) HSPICE 模擬的接收端眼圖 
(b) 使用 An 與 cn 兩參數得到的眼圖 
 
0%190EW0.5%195EW0.5%198EW
-0.6%301.43EH
(6)
-0.1%331.44EH
(5)
-0.3%360.21EH
(4)
1.1%182EW0%189EW0%195EW
1.1%253.82EH
(3)
-0.7%287.88EH
(2)
0.6%315.23EH
(1)
Tanδ=0.03Tanδ=0.02Tanδ=0.01
-2.4%165EW3.4%120EW6.3%67EW
-3.2%212.29EH
(9)
3.7%107.50EH
(6)
7.1%41.14EH
(3)
-1.6%182EW1.2%168EW2.1%149EW
-0.4%266.58EH
(8)
4.1%201.48EH
(5)
3.6%148.34EH
(2)
-1.0%195EW0%192EW0%188EW
-0.9%329.60EH
(7)
-0.1%299.14EH
(4)
-2.0%272.64EH
(1)
H=40milH=10 milH=5mil
0 0.1 0.2 0.3 0.4
0
0.1
0.2
0.3
0.4
Eye Diagram by this Algorithm
Time (ns)
V
ol
ta
ge
 (V
)
0 0.1 0.2 0.3 0.4
0
0.1
0.2
0.3
0.4
Eye Pattern by HSPICE
Time (ns)
V
ol
ta
ge
 (V
)
127 
 
的影響再衰減後，到了電源端又因為阻抗不匹配而乘以反射係數 sΓ ，如此信號
將因兩端阻抗不匹配而在傳輸線上來來回回進行多重反射。 
在前述預測眼圖的方法中，只考慮傳輸線電源端阻抗不匹配時，只需將該端
的信號乘以分壓係數作為修正即可，到達負載端的信號因為阻抗匹配而不再反射；
若只考慮傳輸線接負載端抗不匹配時，需要在負載端乘上 )1( lΓ+ 作為修正，也
是因為信號反射回電源端時因為阻抗匹配而不再反射。 
故處理單端電阻性不匹配時，需將圖6.11匹配時的眼高的An-cn圖因匹配時的
分壓係數為0.5，為了還原回未分壓的狀態須先乘以兩倍，再乘以目前的分壓係數
)(
so
o
RZ
Z
+ 以及穿透係數 )1( lΓ+ ，同時縮放整個An-cn圖的值即可用來預測眼圖。
例如電源端的Rs越大，進入傳輸線的分壓電壓將越小，整個眼高的An-cn圖就同時
縮小。眼寬的An-cn圖則因為電阻性不匹配不影響輸出信號的相位，不需變動。 
但若考慮傳輸線兩端同時阻抗不匹配，因為前述推導的方式只考慮到一個波
寬，而實際上多重反射波將在第一個輸出波形到達接收端之後的偶數倍延遲時間
(time delay)陸續達到接收端，如此將超出前述方法所考慮的時間，以下將進行兩
端同時不匹配時，前述預測眼圖方法適用條件的探討。 
先將傳輸線兩端負載的與傳輸線特徵阻抗相對的可能情形分類為： 
(1) Rs < Z0 且 Rl < Z0，即 (-)   (-) ls :: ΓΓ 。 
(2) Rs < Z0 且 Rl > Z0，即 )(   (-) ls +ΓΓ :: 。 
(3) Rs > Z0 且 Rl < Z0，即 (-)   )( ls :: Γ+Γ 。 
(4) Rs > Z0 且 Rl > Z0，即 )(   )( ls +Γ+Γ :: 。 
此四種情形的(1)與(4)由於信號在傳輸線上兩次反射再到達接收端之後為建設性，
故第一個波形仍可疊出最差的眼圖，其後再達到的多重反射波都只能撐高眼圖，
在這兩種情形中前述的預測眼圖方法仍然適用。 
但(2)與(3)這兩種情形，因為第二次達到接收端的信號為破壞性，可能致使眼
圖惡化，但若此經由二次反射到達的信號強度遠低於第一次達到接收端的信號強
129 
 
因在設計傳輸線結構時，通常需要評估該傳輸線在信號傳輸規格的眼圖規範
之下，最長可以使用到多長而不致使接收端眼圖碰到所定義的眼圖遮罩。故接下
來，將應用本文所提出的An-cn圖來預測有損傳輸線可使用的線長。 
在(6.3)中可以看出An與線長成正比，cn也與線長成正比如 
;      n A n cA k len c k len= ⋅ = ⋅                   (6.16) 
式中的kA與kc兩係數則由金屬導電度σ、介質損耗tanδ、傳輸線結構中的線寬與等
效電容所控制。 
如圖6.16所示，若已得到某條傳輸線的An與cn值且找到其在眼高/眼寬An-cn圖
上的位置點，又由(6.16)可看出該點在線長變動時應向右上方沿45°斜直線移動。 
 
圖 6.16 An-cn 圖中線長改變時，點的移動示意圖 
而圖6.16中紅線所標示的是與信號傳輸規格所定的眼圖遮罩所對應的眼高或
眼寬邊界，只要接收端眼高或眼寬低於該邊界值就判斷為不符合規範。故前述當
線長變動時，座標點的移動亦不能超過該邊界，換句話說，紅線左下方為可讓眼
圖通過規範的區域，右上方為禁斷區域。 
有了以上的概念，只要根據信號傳輸規格中的眼圖遮罩，抓出對應An-cn圖上
的邊界等高線，再依據線長變動時，作標點的移動動行為，即可預知原先的傳輸
線可使用的極限線長。 
但由於An-cn圖上的等高線沒有數學解，只得先抓出眼高/眼寬邊界值附近的
131 
 
  
(a)                                  (b) 
圖 6.17 可通過規範的(An , cn)區域 (a) 眼高 An-cn 圖 (b)眼寬 An-cn 圖 
  
圖 6.18 (a)取較小倍率 (b) 將(a)的改成對數刻度 
表 6.7 使用圖 6.18 修正傳輸線線長使其符合眼圖規範 
 
  
30
30
30
35
35
35
35
40
40
40
40
45
45
45
45
50
50
50
50
55
55
55
60
60
60
65
65
65
70
70
75
75
80
80
859095
Eye Height / Vinmatch (percentage)
cn
A
n
0.1 0.2 0.3 0.4 0.5
0.02
0.04
0.06
0.08
0.1
0.12
0.14
40
40
42.5
42.5
45
45
47.5
47.5
50
50
50
52.5
52.5
52.5
55
55
55
57.5
57.5
57.5
60
60
60
62.5
62.5
62.5
65
65
65
65
67.5
67.5
67.5
67.5
70
70
70
70
72.5
72.5
72.5
72.5
75
75
75
75
77.5
77.5
77.5
77.5
80
80
80
80
82.5
82.5
82.5
85
85
85
85
87.5
87.5
87.5
90
90
90
92.5
92.5
92.5
95
95
97.5
97.5
Eye Width / UI (percentage)
cn
A
n
0.1 0.2 0.3 0.4 0.5
0.02
0.04
0.06
0.08
0.1
0.12
0.14
0.60.8
0.8
0.8
1
1
1
1
1.2
1.2
1.2
1.2
1.4
1.4
1.4
1.4
1.6
1.6
1.6
1.8
1.8
1.8
2
2
2
2.2
2.2
2.4
2.4
2.6
2.6
2.8
2.8
3
3
3.2
3.43.63.8
44.24.4.6855.24.65.86.2
6.46 .87.247.688.248.6.89.9.4.681010.2112
Multiplicant of length
cn
A
n
0.1 0.2 0.3 0.4 0.5
0.02
0.04
0.06
0.08
0.1
0.12
0.14
1
1
1
1
2
2
2
4
8
Multiplicant of length
cn
A
n
10
-3
10
-2
10
-1
10
-3
10-2
10-1
62.0%
30.0%
97%
82.4%
66.0%
30.3%
33.5%
10.3%
0.115
0.005
0.329
0.121
(7)
(3)’ (7)’
(3)
EH
len*4.4
EH
len * 0.8
EWEW
EHAnEHAn
EWcnEWcn
133 
 
端眼圖並且與An-cn圖上的眼高與眼寬進行比較。上述提到的實驗儀器如圖6.19及
6.20，驗證流程如圖6.21所示。 
 
圖 6.19 實驗儀器與設備 (a) 網路分析儀 Agilent E8364B PNA 
(b) 準隨機二位元序列信號產生器 Anritsu MP1763C Pulse Pattern Generator  
 
圖 6.20 實驗儀器與設備 (c) 數位示波器 Agilent 548855A DSO (6GHz/20GSa/s) 
(c) 低損耗同軸線 Agilent 11500E (0~26.5GHz) 
 
圖 6.21 驗證預測眼圖方法的流程 
135 
 
   
圖 6.24 利用曲線回歸技巧得到 An 與 cn  (a) 板厚 0.4 (mm)  (b) 板厚 1.0 (mm) 
曲線回歸找出的An與cn兩參數如表6.9所示。接著，產生包含表6.9中(An , cn)
數對的眼高與眼寬的An-cn圖如圖6.25，圖中的三個橘點與三個綠點為表6.9中的六
個數對所對應的座標點。查出相對應的眼高與眼寬百分比列於表6.10。 
表 6.9 利用曲線回歸找出的 An 與 cn 兩參數 
 
 
   
圖 6.25 產生包含實驗得到的(An , cn)數對之 (a)眼高 An-cn 圖 (b) 眼寬 An-cn 圖 
 
 
0 2 4 6 8 10
-40
-30
-20
-10
0
H=0.4 (mm) S21
Freq. (GHz)
(d
B
)
20 (in)
30 (in)
40 (in)
0 2 4 6 8 10
-40
-30
-20
-10
0
H=1.0 (mm) S21
Freq. (GHz)
(d
B
)
20 (in)
30 (in)
40 (in)
0.2991.50*10-40.3028.41*10-440 (in)
0.2298.42*10-50.2414.73*10-430 (in)
0.1483.74*10-50.1581.90*10-420 (in)
cnAncnAn
1.0 (mm)0.4 (mm)H
Len
20
25
25
30
30
30
35
35
35
40
40
40
45
45
45
50
50
50
55
55
55
60
60
60
65
65
7075
Eye Height / Vinmatch (percentage)
cn
A
n
0.1 0.15 0.2 0.25 0.3 0.35
1
2
3
4
5
6
7
8
9
x 10-4
45
50
50
55
55
60
60
60
65
65
65
70
70
70
75
75
75
80
80
80
85
85
8590
90
Eye Width / UI (percentage)
cn
A
n
0.1 0.15 0.2 0.25 0.3 0.35
1
2
3
4
5
6
7
8
9
x 10-4
137 
 
177.3 ps；5 Gb/s的波寬應為200 ps，相差22.7 ps。故表6.3中的眼高與眼寬百分比，
為了校準，在換算絕對眼高時需乘以339 mV，換算絕對眼寬時則乘以177.3 ps。 
 
圖 6.27 未接上待測物時的眼圖 
圖6.28為板厚0.4 mm傳輸線量測到的接收端眼圖。圖6.29為板厚1.0 mm傳輸
線量測到的接收端眼圖。將量測得到的眼高與眼寬與預測的眼高與眼寬列於表
6.11中進行比較，表中可以看出本文提出預測眼圖的方式在預測眼高時誤差不超
過9 %，預測眼寬方面，誤差不超過11 %。 
     
圖6.28 板厚0.4 mm傳輸線量測得到 (a) 20 in, (b) 30 in, (c) 40 in接收端眼圖 
     
圖 6.32 板厚 1.0 mm 傳輸線量測得到的 (a) 20 in, (b) 30in, (c) 40in 接收端眼圖 
 
139 
 
第七章 結論 
對於傳統的電路設計方法經常是在實際電路遇到問題之後，才開始著手分析
問題，並且修正電路設計，相當缺乏效率。本計畫研究針對多維構裝結構在 Gbps
的高速傳輸時所碰到的信號完整度問題，提出物理的說明，分析的模型，並提出
改良設計的方法。 
針對多接脚的構裝結構的切換雜訊問題，本報告所提出的方法可以把問題簡
化成電感矩陣問題，而且在分析時可以不需要進行完整的時域模擬，而只需進行
單一矩陣求解的問題，分析可以大輻簡化，因此可以利用基因演算法進行最佳排
列之設計。 
對對高速傳輸的訊號路徑造成訊號反射的問題，吾人提出利用類神經網路的
方法，以連通柱結構為例，透過幾組全波模擬軟體產生的數據，成功訓練出一個
可以產生尺寸結構和連通柱阻抗大小對應關係的類神經網路。並且藉由類神經網
路快速求出各種結構的連通柱阻抗值，克服了大量電腦資源和計算時間的問題，
可以成功替代全波模擬軟體的功能。 
當類神經網路建立後，各種結構的連通柱阻抗都可以輕易求出。接下來進行
最小反射量的分析，在時域希望得到最小的反射量，可以先從阻抗匹配的觀點著
手。理論上，當不連續結構與前後端的傳輸線阻抗越不匹配，造成反射的情形也
就越明顯。透過類神經網路，可以在有興趣的連通柱結構尺寸範圍內，快速找出
所有結構的阻抗值，再根據計算結果回推出阻抗匹配下的結構值，求出連通柱結
構最小反射量的解空間。經過時域模擬軟體和實驗的驗證，解空間內的連通柱結
構確實會造成相當小的反射情形。藉此，本文成功提出一個方法，可以從時域上
的表現，快速得到對應的結構尺寸。除了本文中提到的連通柱結構，常見於高速
數位電路的不連續結構，例如轉角(bend)和接腳(pin)等，可以利用相同的方式來
分析，有助於電路設計時，避免信號完整度相關問題的產生。 
由於高速傳輸中的頻率成份相當大，本研究亦特別重視傳輸的的損耗的影響。
此時輸入端的波形在經過傳輸路徑的衰減後，到達接收端的眼圖有可能已衰減到
無法符合國際標準的規範(例如：PCI Express、SATA、USB)，因此，吾人主要提
141 
 
參考文獻 
[1] C. W. Ho, D. A. Chance, C. H. Bajorek, abd R. E. Acosta, “The thin-film module 
as a high-performance semiconductor package,” IBM J. Res. Develop., vol. 26, 
pp. 286-296, May 1982. 
[2] G. A. Katopis, “Delta-I noise specification for a high-performance computing 
machine,” Proc. IEEE, vol. 73, pp. 1405-1415, Sep. 1985. 
[3] J. M. Williamson, M. S. Nakhla, Q. J. Zhang, and P. D. Puije, “Ground noise 
minimization in integrated circuit packages through pin assignment optimization,” 
IEEE Trans. Comp., Packag. Manuf. Technol., pp.361~371, May, 1996. 
[4] L. Zhang and Q. J. Zhang, “Optimal pin-assignment for ground noise 
minimization in IC packages and connectors,” IEEE ECTC, pp. 761-764, 1996. 
[5] C. T. Tsai, “Inductance and SSN performance comparison of a 225 plastic BGA 
and a 208 plastic QFP,” IEEE ECTC, pp. 918-924, 1996. 
[6] B. Young, “Measurement of package inductance and capacitance matrices,” 
IEEE Trans. Comp., Packag. Manuf. Techonol., pp. 225-229, Feb. 1996. 
[7] I. Ndip and H. Reichl, “Effects of discontinuities and technological fluctuations 
on the RF performance of BGA Package,” IEEE ECTC. pp. 1769-1775, 2005. 
[8] R. B. Wu, “Resistance Modeling of periodically perforated mesh planes in 
multilayer packaging structures,” IEEE Trans. Comp., Hybrids Manuf. Technol., 
pp. 365-372, Sept. 1989. 
[9] A. E. Ruehli, “Inductance calculations in a complex integrated circuit 
environment,” IBM J. Res. Develop., vol. 16, pp. 470-481, Sept. 1972. 
[10] R. B. Wu, C. N. Kuo, and K. K. Chang, “Inductance and resistance computations 
for three- dimensional multi-conductor interconnection structures,” IEEE Trans. 
Microw. Theory Tech., pp. 263-270, Feb. 1992. 
[11] M. Vai and S. Prasad, “Automatic impedance matching with a neural network,” 
IEEE Micro- wave Guided Wave Lett., vol. 3, no. 10, pp. 353-354, Oct. 1993. 
[12] T. Horng, C.Wang, and N. G. Alexopoulos, “Microstrip circuit design using 
neural networks,” in MTT-S Int. Microwave Symp. Dig.,1993, pp.413-416. 
[13] A. H. Zaabab, Q. J. Zhang, and M. Nakhla, “Analysis and optimization of 
microwave circuits and devices using neural network models,” in MTT-S Int. 
Microwave Symp. Dig., 1994, pp. 393-396. 
[14] A. H. Zaabab, Q. J. Zhang, and M. Nakhla, “A neural network modeling 
approach to circuit optimization and statistical design,” IEEE Trans. Microwave 
Theory Tech., vol. 43, pp.  1349- 1358, June 1995. 
[15] G. L. Creech, et aL, “Artificial neural networks for accurate microwave CAD 
applications,” in MTT-S Int. Microwave Symp. Dig., 1996, pp.733-736. 
143 
 
multidielectric transmission line systems,” IEEE Trans. Microw. Theory Tech., 
vol. 39, pp. 1090-1097, Jul. 1991. 
[30] T. Zhou, Z. Chen, W. D. Becker, S. L. Dvorak, and J. L. Prince, “Triangle 
impulse response (TIR) calculation for lossy transmission line simulation,” IEEE 
Trans .adv. Packag., vol. 25, pp. 311-319, May 2002. 
[31] J. D. Jackson, Classical electrodynamics, New York : Wiley, c1975, pp. 330-335. 
97 年度專題研究計畫研究成果彙整表 
計畫主持人：吳瑞北 計畫編號：97-2221-E-002-062-MY3 
計畫名稱：兆位元率構裝連線之電氣特性分析與補償設計 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 3 100%  
研究報告/技術報告 0 1 100%  
研討會論文 0 3 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 9 0 100%  
博士生 3 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 3 0 100%  
研究報告/技術報告 1 0 100%  
研討會論文 3 0 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
 
